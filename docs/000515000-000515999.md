# StackOverflow 问答 000515000-000515999

# copy-protection - 您使用什么复制保护技术？

> ID：515020
> 
> 赞同：38
> 
> 时间：2009-02-05T08:23:11.747
> 
> 标签：copy-protection

我正在考虑为我的一个工具添加某种复制保护。

*   你有这方面的经验吗？
*   您是否开发了自己的保护技术或购买了第 3 方软件？
*   您认为这是增加销售额的可行方法吗？（在私人和/或公司环境中）
*   您如何防止打扰付费客户？在大多数情况下，受到不良复制保护的是*付费*客户，我不希望这种情况发生在我的客户身上。（即使这意味着接受一些免费加载者）

我对允许您的软件的试用版或免费软件版本供私人使用但限制在公司环境中的有用性的技术特别感兴趣。

* * *

**相关问题**：[如何保护您的软件免受非法分发](https://stackoverflow.com/questions/109997/how-do-you-protect-your-software-from-illegal-distribution)
**相关问题**：[保护 .NET 代码免受逆向工程。](https://stackoverflow.com/questions/506282/protect-net-code-from-reverse-engineering/)
**相关问题**：[防止规避复制保护。](https://stackoverflow.com/questions/203229/preventing-the-circumvention-of-copy-protection)

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-02-05T08:36:17.183

无论您使用什么技术，您的软件都会被复制。复制保护的实际目的是防止诚实的客户受到不公平的诱惑。

最低限度的复制保护技术就足够了。最大的不值得花时间。

此外，我听说一些开发人员会为任何询问的用户提供用户支持，无论是否是客户。这个想法是快乐的用户可能会成为忠实的客户。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-05T08:42:30.103

在桌面应用程序上，我一直在使用 Clarion 模板（3rdParty，[http://www.capesoft.com/accessories/secwinsp.htm](http://www.capesoft.com/accessories/secwinsp.htm)）。

对于网络应用程序，几乎只是使用用户必须登录并跟踪活动的简单事实。如果他们有帐户，则表示他们已经付款。

桌面更难跟踪。如前所述，很容易破解。很多情况下：

**让黑客感到恼火，但对用户来说尽可能不引人注目**

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-05T08:45:01.440

“硬件就是加密狗”

在我以前的工作中，我们总是这么说，在某种程度上，在我现在的工作中也是如此。基本上，我们出售物理硬件来运行我们的软件，我们免费赠送这些硬件。这可能对所有企业都不可行，但知道您不必担心盗版是一种很好的感觉，因为人们投资的是硬件，而不是软件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-05T08:51:55.060

正如 mouviciel 所说，没有什么是完美的。旨在温和地鼓励可能购买您产品的用户购买它，而忘记那些永远不会购买的人。

一些一般提示：

1.  不要费心实施自己的保护，除非您有这样做的经验。在这个领域，向专长提供某种许可/保护的人付费可能是值得的（请记住，它并不完美）。
2.  选择难以注册的许可证密钥系统。同样，选择一个预先构建的许可系统可能就足够了。从头开始创建自己的可能不会。
3.  花时间正确集成您选择的任何许可系统。如果您只是“保护/包装”您的可执行文件，则保护将很快被删除。大多数许可/保护产品都提供了简单的集成工具/宏，这使得自动破解变得更加困难。

对于企业软件，您能做的最好的事情是让管理员轻松确保它们在许可范围内（实例/安装数等）。为他们提供一个中心位置来验证这一点，并在他们采取任何更激烈的行动之前轻轻提醒他们是否稍微过度。在大型网络环境中，软件许可对于 IT 部门来说可能会变得非常复杂。让他们的工作更轻松，他们会感谢你的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-01-19T15:33:18.830

“技术支持是加密狗”

这并不适用于所有应用程序，但对于价格较高且销量较低的复杂应用程序，为您的客户提供出色的支持是确保所有用户都付费的最佳方式。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-11-28T12:01:34.097

我知道这篇文章是很久以前提交的，但是当讨论这个话题时，每个人都显得很消极。出于显而易见的原因，我不想透露我在哪里工作，但我们使用[的是 Wibu-Systems US 的 CodeMeter](http://www.wibu.us/solutions/software-protection.html)。我们选择了这个，因为黑客在黑客竞赛中没有设法破解这个。

关于您提出的所有问题，它非常灵活，并且他们提供免费的 SDK，这是我们在购买之前进行测试的方式。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-05T08:36:31.270

对于某些产品，我们（必须）使用硬件加密狗。尽管它们提供了非常好的复制保护，但它们对我们的客户来说确实很麻烦。

所有其他软件均受软件密钥保护。是的，你可以复制这些。但是我们有很好的经验，客户不这样做。没有按键程序正常运行，只是不能计算模型，部分打印功能被禁用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-08-09T05:55:57.730

You do need to employ copy-protection for your software, but as others have said, make it as hassle-free as possible for your customers. Your aim should be to keep honest customers honest, and not make them go through hoops before they can finally use your software.

I would also advice against spending your time on coming up with your own licensing scheme, instead spend that time focusing on your actual product.

Consider using [CryptoLicensing](http://www.ssware.com/cryptolicensing/cryptolicensing_net.htm) - it provides licensing, copy-protection, activations, machine-locking, trials, and other features.

DISCLAIMER: I work for LogicNP Software, the developer of CryptoLicensing.

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-02-05T09:13:18.573

好的软件不需要保护。您的软件将永远被复制，无论您选择何种保护。

因此，避免非法复制的最佳方法是使您的软件易于使用，以便您的客户对您的产品感到满意和满意。

# .net - Unity中的Setter / property注入没有属性

> ID：515028
> 
> 赞同：24
> 
> 时间：2009-02-05T08:27:49.727
> 
> 标签：.net, inversion-of-control, unity-container

我正在开发一个将 Unity 框架用作 IoC 容器的项目。我的问题与使用属性或设置器注入将可选依赖项（在本例中为记录器）注入多个类有关。

我不想用这些可选的依赖项来混淆我所有类的构造函数，但是我找不到在 Unity 中处理这个问题的好方法。根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/cc440933.aspx)，您可以通过向属性添加属性来执行此操作：

```
private ILogger logger; 

[Dependency]
public ILogger Logger
{
get { return logger; }
  set { logger = value; }
} 
```

我觉得这很丑陋。在[StructureMap](http://structuremap.sourceforge.net)中，可以执行以下操作来设置给定类型的所有属性：

```
SetAllProperties(policy => policy.OfType<ILog>()); 
```

有谁知道是否可以在 Unity 中做类似的事情？

**编辑：**

Kim Major 建议使用[这种方法](http://aardvarkblogs.wordpress.com/unity-container-tutorials/10-setter-injection/)，也可以通过代码实现。

我会对如何为所有匹配属性自动执行此操作的示例感兴趣。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-11T12:37:39.667

我也不喜欢这些属性

您可以使用统一容器的**Configure方法完成所有操作：**

首先注册类型

```
unityContainer.RegisterType<MyInterface,MyImpl>(
                     new ContainerControlledLifetimeManager()); 
```

如果您有多个构造函数，则必须这样做，以便 Unity 调用无参数构造函数（如果没有设置 Unity 将选择最胖的构造函数）

```
unityContainer.Configure<InjectedMembers>()
                            .ConfigureInjectionFor<MyImpl>(
                                new InjectionConstructor()); 
```

设置属性依赖

```
unityContainer.Configure<InjectedMembers>()
                    .ConfigureInjectionFor<MyImpl>(
                         new InjectionProperty(
                             "SomePropertyName",
                                new ResolvedParameter<MyOtherInterface>())); 
```

配置方法依赖

```
unityContainer.Configure<InjectedMembers>()
                    .ConfigureInjectionFor<MyImpl>(
                        new InjectionMethod(
                            "SomeMethodName",
                            new ResolvedParameter<YetAnotherInterface>())); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-02-04T15:07:28.400

I am also not a big fan of using attributes but I also don't like the `.Configure<InjectedMembers>()` method because you're bound to a specific property name and specific value. The way I've found that gives you the most flexibility is to create your own builder strategy.

I created this simple class that iterates the properties of an object being built up and sets its property values if the type of that property has been registered with the unity container.

```
public class PropertyInjectionBuilderStrategy:BuilderStrategy
{
    private readonly IUnityContainer _unityContainer;

    public PropertyInjectionBuilderStrategy(IUnityContainer unityContainer)
    {
        _unityContainer = unityContainer;
    }

    public override void PreBuildUp(IBuilderContext context)
    {
        if(!context.BuildKey.Type.FullName.StartsWith("Microsoft.Practices"))
        {
            PropertyDescriptorCollection properties = TypeDescriptor.GetProperties(context.BuildKey.Type);

            foreach (PropertyDescriptor property in properties)
            {
                if(_unityContainer.IsRegistered(property.PropertyType)
                   && property.GetValue(context.Existing) == null)
                {
                    property.SetValue(context.Existing,_unityContainer.Resolve(property.PropertyType));
                }
            }
        }
    }
} 
```

You register your `BuilderStrategy` by creating a `UnityContainerExtension`. Here is an example:

```
public class TestAppUnityContainerExtension:UnityContainerExtension
{
    protected override void Initialize()
    {
        Context.Strategies.Add(new PropertyInjectionBuilderStrategy(Container), UnityBuildStage.Initialization);
    }
} 
```

That gets registered with the Unity container as such:

```
IUnityContainer container = new UnityContainer();
container.AddNewExtension<TestAppUnityContainerExtension>(); 
```

Hope this helps,
Matthew

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-11-26T22:59:16.630

您发布的原始示例看起来确实很麻烦，但是您可以使用这样的自动实现的属性来帮助清理该代码：

```
[Dependency]
public ILogger Logger { get; set; } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-03-26T18:41:09.830

使用 Unity 2.1 这也可以：

```
var container = new UnityContainer()
            .RegisterType<ILogger, Logger>()
            .RegisterType<ISomeInterface, SomeImplementaion>(
                                new InjectionProperty("Logger", new ResolvedParameter<ILogger>())); 
```

SomeImplementaion 类的注入属性只是

```
public ILogger Logger { get; set; } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-23T16:21:05.183

你可以试试这个：

MyClass 中的这段代码

```
[InjectionMethod]
public void Initialize(
                 [Dependency] ILogger logger 
```

然后通过以下方式调用它：

```
unitycontainer.BuildUp<MyClass>(new MyClass()); 
```

然后统一将使用容器中的依赖项调用 Initialize 方法，然后您可以将其保存在 MyClass 中的私有变量或其他东西中......

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-05T08:37:44.730

以下演练显示了通过配置完成此操作的一种方法。您当然也可以通过代码连接它。 [http://aardvarkblogs.wordpress.com/unity-container-tutorials/10-setter-injection/](http://aardvarkblogs.wordpress.com/unity-container-tutorials/10-setter-injection/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-25T06:37:47.803

查看基于约定的配置的[UnityConfiguration](https://github.com/thedersen/UnityConfiguration)项目。它工作得很好，虽然我在使用`ResolveAll<IType>()`. 看到[这个问题](https://stackoverflow.com/questions/16200711/resolving-multiple-implementations-with-property-injection-of-optional-dependenc)。

```
container.RegisterInstance(typeof (ILogger), LoggerService.GetLogger());
container.Configure(c => c.Scan(scan =>
                    {
                        scan.AssembliesInBaseDirectory(a => a.FullName.StartsWith("My.Company")); // Filter out everthing that are not from my assemblies
                        scan.InternalTypes();
                        scan.With<SetAllPropertiesConvention>().OfType<ILogger>();
                    })); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-24T12:24:02.750

您可以使用统一容器注入您的课程。

例如，如果您有一个类“MyClass”并且您依赖于两个接口“IExample1”和“IExample2”并且您不想在构造函数中为它们定义参数，请按照以下步骤操作

**步骤 1.**在统一容器中注册两个接口

```
IUnityContainer container = new UnityContainer();
container.RegisterType<IExample1,Impl1>();
container.RegisterType<IExample2,Impl2>();
//resolve class MyClass
var myClass = container.Resolve<MyClass>(); 
```

**第 2 步。**你的班级应该是这样的

```
public class MyClass
{
     IExample1 ex1;
     IExample2 ex2
     public MyClass(IUnityContainer container)
     {
        /* This unity container is same unity container that we used in step 
           1 to register and resolve classes. So you can use this container to resolve
           all the dependencies. */
       ex1= container.Resolve<IExample1>(); // will give you object of Impl1
       ex2= container.Resolve<IExample2>(); // will give you object of Impl2
     }
} 
```

**步骤 3**。通过这种方式，您可以解决任意数量的依赖关系，而无需在构造函数中定义它们。

# multithreading - Delphi 中更好的多线程调试

> ID：515036
> 
> 赞同：4
> 
> 时间：2009-02-05T08:33:25.613
> 
> 标签：multithreading, delphi, debugging, ide, delphi-2007

从另一个关于 Delphi IDE 中的错误的问题的答案开始，有谁知道是否有办法改进 IDE 的多线程调试功能，或者如果没有，至少为什么有时它会如此糟糕？

当您在一个程序中有多个线程时，使用 F7 或 F8 单步执行代码通常会导致很长时间的停顿，或者整个 IDE 只是锁定。当您离开或进入方法或程序时，这一点尤其明显。调试器似乎总是适合单线程应用程序。

PS。我使用的版本是2007

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T09:22:22.190

根据我的经验，多线程调试使用 Vista 和 Delphi 2009 比 XP 和 Delphi 2007 好得多。

首先，ide明显更稳定。

其次，在Vista 上的Delphi 2009 中，调试器可以向您显示发生死锁的位置。

如果您必须使用 Delphi 2007，我强烈建议您尽可能在单线程单元测试中调试您的代码，然后在主程序中使用您现在测试过的代码。;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T13:38:22.563

当应用程序本身没有死锁时，试着非常清楚你在哪个线程中。在调试器中保持线程列表，并考虑使用命名线程。

有时不可能交互式地调试本身死锁的应用程序。发生这种情况时，您可以使用 WinDbg 和 Adplus 等工具来处理内存转储。是的，这比使用交互式调试器要困难得多，但它胜过完全没有调试器。Tess Ferrandez 的博客上有示例应用程序、演示和说明。我将从[这个页面](http://blogs.msdn.com/tess/pages/net-debugging-demos-information-and-setup-instructions.aspx ".NET 调试演示 - 信息和设置说明")开始。实验室以 .NET 为中心，但不要让这让您望而却步；想法是一样的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T14:12:18.343

当我想调试多线程操作时，我经常使用日志文件（在应用程序运行后进行分析）而不是交互式调试器。

例如使用函数“OutputDebugString”。输出来自 Delphi 的事件日志。如果你在 Delphi 之外启动你的程序，你可以使用[SysInternals 的 DebugView](http://technet.microsoft.com/de-de/sysinternals/bb896647(en-us).aspx)来显示日志。注意将线程 ID 添加到每个输出 (GetCurrentThreadID)。请注意，在写入日志之前可能会有线程切换。但是在多个线程交互的地方，您可能会有一个关键会话（或另一个同步对象），因此它应该是一个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T08:41:40.103

是的，调试多线程应用程序很麻烦。因为您不断地从一个线程交换到另一个线程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T14:18:34.477

另一个我从未尝试过的想法，因为我刚刚考虑过：如果您对调试一个线程感兴趣并且只想避免被其他线程干扰，则可以暂时挂起一些线程。

[SysInternals 的 Process Explorer](http://technet.microsoft.com/de-de/sysinternals/bb896653.aspx)提供了暂停和恢复线程的可能性（在进程属性中称为“线程”的选项卡中）。但正如我所说，直到现在我才测试过它。

# sql - 使用 '=' 或 LIKE 比较 SQL 中的字符串？

> ID：515039
> 
> 赞同：198
> 
> 时间：2009-02-05T08:35:04.393
> 
> 标签：sql, comparison

如果您应该使用 LIKE 或 '=' 来比较 SQL 语句中的字符串，则存在（几乎是宗教性的）讨论。

*   有理由使用 LIKE 吗？
*   有理由使用'='吗？
*   表现？可读性？

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2009-02-05T08:39:06.070

`LIKE`和相等运算符有不同的目的，它们不做同样的事情：
`=`快得多，而`LIKE`可以解释通配符。`=`尽可能和`LIKE`必须使用的任何地方。

```
SELECT * FROM user WHERE login LIKE 'Test%'; 
```

样本匹配：

> TestUser1
> TestUser2
> TestU
> 测试

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2009-02-05T08:41:09.823

要查看性能差异，请尝试以下操作：

```
SELECT count(*)
FROM master..sysobjects as A
JOIN tempdb..sysobjects as B
on A.name = B.name

SELECT count(*)
FROM master..sysobjects as A
JOIN tempdb..sysobjects as B
on A.name LIKE B.name 
```

用 '=' 比较字符串要快得多。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2009-02-05T08:37:29.503

在我的小经验中：

“=”表示精确匹配。

部分匹配的“LIKE”。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-05T09:46:35.213

Postgres 还为字符串匹配提供了一些其他技巧（如果这恰好是您的数据库）：

ILIKE，这是一个不区分大小写的 LIKE 匹配：

```
select * from people where name ilike 'JOHN' 
```

火柴：

*   约翰
*   约翰
*   约翰

如果你真的很生气，你可以使用正则表达式：

```
select * from people where name ~ 'John.*' 
```

火柴：

*   约翰
*   乔纳森
*   约翰尼

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-04-23T15:59:16.397

请注意，'=' 运算符将在 Transact-SQL 中用空格填充字符串。所以`'abc' = 'abc '`会返回true；`'abc' LIKE 'abc '`将返回假。在大多数情况下，'=' 是正确的，但在我最近的一个案例中它不是。

因此，虽然 '=' 更快，但 LIKE 可能会更明确地说明您的意图。

[http://support.microsoft.com/kb/316626](http://support.microsoft.com/kb/316626)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-05T08:37:10.473

对于模式匹配，请使用 LIKE。对于完全匹配=。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-05T08:40:46.237

`LIKE`用于模式匹配并`=`用于相等性测试（由`COLLATION`使用中定义）。

`=`可以使用索引，而`LIKE`查询通常需要测试结果集中的每条记录以将其过滤掉（除非您使用的是全文搜索），因此`=`具有更好的性能。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-05T08:37:12.703

LIKE 在外壳 LIKE '%suffix' 上像通配符 char [*, ?] 一样匹配
- 给我以后缀结尾的所有内容。你不能用 = 来做到这一点，
实际上取决于具体情况。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-07-14T01:04:00.067

即使性能较慢，使用“like”还有另一个原因：比较时，字符值会隐式转换为整数，因此：

声明@transid varchar(15)

如果@transid != 0

会给你一个“varchar 值 '123456789012345' 的转换溢出一个 int 列”错误。

# html - 在我的网站上缓存图像的最佳方式是什么？

> ID：515053
> 
> 赞同：2
> 
> 时间：2009-02-05T08:40:00.373
> 
> 标签：html, apache, caching, http-headers

我有一个网站

www.somesite1.com 从 www.somesite2.com 获取其所有图像内容

在每次显示图像时，我们只需使用绝对 URL 来获取它，就像这样

```
<img src="http://www.somesite2.com/images/myimage.jpg" /> 
```

因此，每次用户访问 www.somesite1.com 获取内容时，www.somesite2.com 都会受到打击。

我正在寻找缓存图像的巧妙方法，可能使用 http 标头等。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T08:52:23.950

最简单的答案是设置一个 HTTP Expires 标头，该标头具有很远的未来值（例如 10 年）。这样（理论上）如果您有很多重复访问，浏览器不应该再次请求该图像以减轻服务器的巨大负载。当然，当您想要更新图像时，您需要想出一种更改图像 url 的机制。大多数人通过将内部版本号添加到某处的路径中（或通过将内部版本号附加到查询字符串）来解决此问题。

这里有一些关于性能的好信息（包括使用 Expires 标头）：

[http://developer.yahoo.com/performance/rules.html](http://developer.yahoo.com/performance/rules.html)

我个人不会担心在服务器端缓存这些（我认为它们不是动态生成的）。它们是直接从光盘提供的，因此开销应该很小。确保您有一台单独的机器来提供静态内容，并使用非常轻量级的 Web 服务器，例如 Lighttpd 或 nginx，这将有助于提高吞吐量。

[http://www.lighttpd.net/](http://www.lighttpd.net/)

[http://nginx.net/](http://nginx.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T16:04:15.497

除非您的网站非常受欢迎，否则您可能不需要第二台服务器来存储静态内容。

如果您使用的是 Apache HTTP，那么您可以安装 mod_cache。您还可以查看安装 Squid Cache。

不过，我同意 Andy Hume 的观点，如果您确实需要第二台服务器，请保持轻量并使用 lighttpd 和 Squid 之类的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T09:04:00.120

您的设置没有任何问题，它运行良好。要了解您需要做什么才能使其更好地工作，您必须了解浏览器的工作原理。

首先，它将从 www.somesite1.com 读取 HTML 文档。然后它会读取它，寻找任何 URL。当它找到任何东西时，它将开始下载它们。

所以从浏览器的角度来看，站点 1 和站点 2 之间没有任何关系。如果要改进站点 2 的缓存，可以完全忽略站点 1。

这意味着您必须告诉站点 2 上的 Web 服务器将正确的缓存信息发送到浏览器。例如，让它响应[HEAD 请求](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html) 和/或在标头字段[Cache-Control](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)中将图像的生命周期设置为某个较大的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T08:43:42.707

只为图像保留一个单独的网络服务器，因为图像是一个单独的 http 请求。

# jquery-ui - 如何让 JQuery UI 主题显示在 CakePHP 中？

> ID：515055
> 
> 赞同：1
> 
> 时间：2009-02-05T08:40:13.087
> 
> 标签：jquery-ui, cakephp

我在为我的 CakePHP 应用程序显示 JQuery UI 主题时遇到问题。我将主题放在 app/webroot/lib/jquery.ui/ 。现在在我的布局中，我使用以下方式导入了主题：

```
echo $html->css('/lib/jquery-ui/theme/ui.all'); 
```

我正在使用 DatePicker 小部件。在我的页面上，我可以看到我的文本框在聚焦时显示日期选择器，但主题未正确应用。我看不到背景图片。我知道主题（或 css）已被导入，因为我可以看到 DatePicker 中的一些变化（字体、间距等）。我只是看不到背景图片。

我不知道这是否与我的问题有关，但我也在使用 YUI。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T13:53:37.023

我认为您的 ui.all.css 文件位于 app/webroot/css/lib/jquery-ui/theme/ 中？

它引用的图像在哪里？

CSS 文件中背景图像的 URL 应与 CSS 文件本身相关 - 因此，如果图像位于 app/webroot/ **img** /lib/jquery-ui/theme/ 中，则 CSS 文件中的 URL 应为 ../.. /../../img/lib/jquery-ui/theme/ 或者，URL 可以是站点的 DocRoot 中的绝对 URL，例如 /img/lib/jquery-ui/theme/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-14T15:07:38.413

只是为了添加更多说明：

我一直在为几个项目使用 jquery ui datepicker，它总是很好用。然后我烤了一个新的蛋糕项目，掉进了datepicker，发现背景图片没有加载。我从我的应用程序中删除了 cake.generic.css，并且 datepicker 图像能够加载！重新添加它，它们就会消失！

只要您为您的应用程序使用自己的表单 css，就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-18T16:22:04.260

你说你在 app/webroot/lib/jquery.ui/ 有文件

所以你应该使用正确的路径：

```
echo $html->css('/lib/jquery.ui/theme/ui.all'); 
```

# visual-studio-2005 - 如何根据另一列获得一列的平均值？

> ID：515069
> 
> 赞同：0
> 
> 时间：2009-02-05T08:45:03.997
> 
> 标签：visual-studio-2005, crystal-reports

如何根据另一列获取一列的平均值并将该值放在第三列中，并且将为每个检索到的记录评估该值？

“如何对报表中的两列执行操作并将结果插入第三列？”

仅供参考：我正在使用嵌入 VisualStudio.NET 2005 的 CrystalReport 设计器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T09:31:03.023

首先，您需要创建公式（内容如“{table.commission}/{table.fare}*100”）。我希望下一个 MSDN 链接对您有所帮助（我个人从未使用过 CRD 的嵌入式变体）：

[Crystal Reports Basic for Visual Studio 公式概述](http://msdn.microsoft.com/en-us/library/ms225366.aspx)

# c++ - 将对象添加到 std::list 时调用对象的析构函数

> ID：515071
> 
> 赞同：9
> 
> 时间：2009-02-05T08:46:59.267
> 
> 标签：c++, constructor, stdlist

我有一个 Foo 对象和一个 std::list 保存它的实例。我的问题是，当我向列表中添加一个新实例时，它首先调用 ctor，然后调用 dtor。然后是另一个实例上的 dtor（根据 this 指针）。

单个实例被添加到列表中，但由于调用了它的 dtor（连同它的父级），因此无法按预期使用该对象。

下面是一些简化的代码来说明问题：

```
#include <iostream>
#include <list>

class Foo
{
public:
    Foo()
    { 
        int breakpoint = 0;
    }
    ~Foo()
    { 
        int breakpoint = 0;
    }
};

int main()
{
    std::list<Foo> li;
    li.push_back(Foo());
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-05T08:53:24.963

当您 push_back() 您的 Foo 对象时，该对象被**复制**到列表的内部数据结构中，因此调用了另一个实例的 Dtor 和 Ctor。

C++ 中的所有标准 STL 容器类型都按值获取它们的项，因此根据需要复制它们。例如，每当向量需要增长时，向量中的所有值都可能被复制。

也许您想在列表中存储**指针**而不是对象。通过这样做，只有指针而不是对象被复制。但是，通过这样做，您必须确保在完成后删除对象：

```
for (std::list<Foo*>::iterator it = list.begin(); it != list.end(); ++it) {
    delete *it;
}
list.clear(); 
```

或者，您可以尝试使用某种“智能指针”类，例如来自 Boost 库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T08:55:00.280

你在这里创建一个临时的 Foo ：

```
li.push_back( Foo() ) 
```

push_back 将该 Foo 复制到其内部数据结构中。临时 Foo 在 push_back 执行后被销毁，这将调用析构函数。

您将需要一个适当的复制构造函数来增加您不想提前销毁的类成员的一些引用计数 - 或者将其设为私有以强制自己使用指针解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T18:29:37.670

使用这个对象来理解：

```
class Foo
{
public:
    Foo(int x): m_x(x)
    { 
    std::cout << "Constructed Object: " << m_x << ")\n";
    }
    Foo(Foo const& c): m_x(c.m_x+100)
    {
    std::cout << "Copied Object: " << m_x << ")\n";
    }
    ~Foo()
    {  
    std::cout << "Destroyed Object: " << m_x << ")\n";
    }
}; 
```

第一主线

```
std::list<Foo*> li;
li.push_back(Foo(1)); 
```

这里我们创建一个临时的 Foo 对象并调用 push_back()。临时对象被复制到列表中并且函数返回。在此语句完成后，临时对象将被销毁（通过析构函数）。当列表被销毁时，它也会销毁它包含的所有对象（Foo 是一个带有析构函数的对象，因此销毁包括调用析构函数）。

所以你应该看到这样的东西：

```
Constructed Object: 1
Constructed Object: 101
DestroyedObject: 1
DestroyedObject: 101 
```

在第二个示例中，您有：

```
std::list<Foo*> li;
li.push_back(new Foo(1)); 
```

在这里，您在堆上动态创建一个对象。然后调用 push_back()。这里指针被复制到列表中（指针没有构造函数/析构函数），所以没有其他任何事情发生。该列表现在包含指向堆上对象的指针。当函数返回时，什么都不做。当列表被销毁时，它会销毁（注意destroy和delete之间的细微差别）它包含的对象（一个指针）但是一个指针没有析构函数，所以没有任何事情发生，你会泄漏内存。

所以你应该看到这样的东西：

```
Constructed Object: 1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T08:58:34.297

这里实际发生的是您将传递的对象的**副本**存储在列表中，因为您通过值而不是通过引用发送它。因此，调用的第一个 dtor 实际上是在您传递给 push_back 方法的对象上调用的，但此时已经创建了一个新实例，现在它存储在列表中。

如果您不想创建*Foo*对象的副本，请将指向*Foo*对象的指针存储在列表中，而不是对象本身。当然，这样做时，您必须在销毁列表时正确释放内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T08:53:53.900

使列表保存指针而不是实例可以解决调用析构函数的问题。但我仍然想了解它为什么会发生。

```
#include <iostream>
#include <list>

class Foo
{
public:
    Foo()
    { 
        int breakpoint = 0;
    }
    ~Foo()
    { 
        int breakpoint = 0;
    }
};

int main()
{
    std::list<Foo*> li;
    li.push_back(new Foo());
} 
```

# content-management - 完整电影的 DAM 解决方案

> ID：515080
> 
> 赞同：1
> 
> 时间：2009-02-05T08:52:11.627
> 
> 标签：content-management

市场上是否有任何 DAM（数字资产管理）解决方案可以处理全长电影（10 GB 及更大）的存储和分类。听说过 EMC Documentum、Artesia、Oracle UCM 等的解决方案，但不确定它们是否能处理这么大的文件？任何开源系统？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T02:44:05.123

我要走出去，说“不”。周围可能有一些自定义的，但我还没有看到任何可以处理这种大小的视频的东西。

就个人而言，我已经实现了 Oracle DAM 的图像部分（当时仍归 Stellent 所有）。我记得这项技术针对短视频进行了优化。

在澳大利亚，ABC 最近推出了流媒体服务； [http://www.abc.net.au/iview/](http://www.abc.net.au/iview/) 这和我见过的其他类似的一样，似乎仅限于 1/2 或单小时块的剧集或节目。

实际上，将 10gb 输入 CM 系统似乎是一个疯狂的大小。正如 CM 所暗示的，这些文件将被远程共享/可用。视频是未压缩的吗？您想通过网络流式传输/提供它们吗？我很想知道有关您所追求的系统的更多详细信息。

# asp.net - 监听事件：来自 .NET 的 HTML

> ID：515085
> 
> 赞同：1
> 
> 时间：2009-02-05T08:54:50.187
> 
> 标签：asp.net, javascript, ajax, events

假设在 HTML 中，在 UpdatePanel 的帮助下，当 ASP.NET 正在处理来自 Web 服务的数据时，我正在运行“加载”动画 gif。

我只是想知道是否有一种方法可以在 .NET 代码中实现一个可以从 HTML 代码中监听的事件，例如：

我正在从 WebService 中一一请求 Persons 数据，并且我想在 HTML 侧显示中加载文本。

```
Importing person 1
Importing Person 2
Importing Person 3
All Done! 
```

出来

有什么技巧可以做到这一点吗？

现在我的 HTML 代码中有这个

**头部**_ _

```
<script type="text/JavaScript" language="JavaScript">

    function pageLoad() {

        try {
            var manager = Sys.WebForms.PageRequestManager.getInstance();
            manager.add_endRequest(endRequest);
            manager.add_beginRequest(OnBeginRequest);
            manager
        }
        catch (err) {
        }
    }

    function OnBeginRequest(sender, args) {

        $("#loadingText").html("<img src='_assets/img/animated/parweb_loading.gif' alt='' />&nbsp;" + strLoadingText);
    }

    function endRequest(sender, args) {
    }  

</script> 
```

**BODY**部分有：

```
<asp:UpdateProgress AssociatedUpdatePanelID="pnlAllIn" runat="server" ID="pnlUpdating">
    <ProgressTemplate>
        <div id="loadingText" style="background-color: Red; position: absolute; width: 200px;
            top: 0px; right: 20px; padding: 5px; color: White; text-align: center; vertical-align: middle;
            font-size: 14px;">
        </div>
    </ProgressTemplate>
</asp:UpdateProgress> 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T09:14:26.467

Microsoft 的 AJAX.NET 是一个上层控件，所以它很容易使用，但你有点受限。

使用[Michael Schwarz 的 AJAX.NET 库](http://ajax.schwarz-interactive.de)，您可以这样做：

1.  编写一个方法来导入信息。此方法会将日志写入会话或其他地方。

2.  编写第二种方法来检查此日志并在操作继续时打印。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T09:13:34.313

你能不能不使用 AJAX 来做到这一点。在单独的线程上触发您对 Web 服务的查询。线程应该保留一个变量的实例（或对一个变量的引用），以跟踪 Web 服务的进度。然后，javascript 可以每 2 秒调用一次以获取状态，然后相应地更新您的 HTML。

# .net - LINQ to SQL 设计器不工作

> ID：515089
> 
> 赞同：1
> 
> 时间：2009-02-05T08:56:29.107
> 
> 标签：.net, linq-to-sql

安装 VS 2008 SP1 后，LINQ to SQL 设计器没有生成代码。我收到一条错误消息：

> 无法从程序集“System.Data.Linq，版本=3.5.0.0，文化=中性，PublicKeyToken=b77a5c561934e089”加载类型“r”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T08:58:53.220

如果您有一个数据上下文（等）的部分类，并且在命名空间之前有一个 using 语句，这通常会发生。怪异的，我知道。

所以如果你有（在你的部分课程中）：

```
using Foo;
namespace Bar {
    //...
} 
```

尝试重新排列：

```
namespace Bar {
    using Foo;
    //...
} 
```

我不知道为什么，但这通常可以解决它。请注意，您可能还需要重新启动 VS 以使其再次工作，甚至可能需要进入 dbml 设计器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T12:30:52.557

它已修复，问题是在安装 vs 2008 sp1 时，它没有自动安装 .net 3.5 sp1，我已经手动安装了 .net 3.5 sp1，它现在可以工作了！

# intersystems-cache - 如何在 CACHE 中获取 SMTP 响应

> ID：515092
> 
> 赞同：0
> 
> 时间：2009-02-05T08:58:01.647
> 
> 标签：intersystems-cache, intersystems

我想在发送邮件后检索 SMTP 响应。我需要获取发送邮件的响应（无论是否正确发送）

响应必须是这样的

* * *

回邮路径：信封收件人：ap@smartsnipe.com 交货日期：2008 年 12 月 12 日星期五 23:54:57 -0500 收件：来自 pool-98-109-89-94.nwrknj.fios.verizon.net ( [98.109.89.94] helo=Andy-PC) 来自 server.4wtech.com，esmtp (Exim 4.69) (envelope-from ) id 1LBMWn-0005BH-7u for ap@smartsnipe.com; 2008 年 12 月 12 日星期五 23:54:57 -0500 日期：2008 年 12 月 13 日星期六 04:55:09 UT 发件人：itgigs@4wtech.com 主题：Web Developer Internship (SoHo) (955259288) 收件人：ap@smartsnipe.com MIME 版本：1.0 内容类型：文本/html；charset="ISO-8859-1" 内容传输编码：引用打印

* * *

如何检索 SMTP 响应？请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T09:31:43.060

这在我看来不像 SMTP 响应，因为 SMTP 响应的格式为“XXX some message”。您在问题中复制的是邮件服务器在接受和传递邮件时写出的日志输出。

如果您在 Unix 系统上并且可以访问 /var/log，那么您可能会在其中找到一个名为 mail.log 或 maillog 的文件，其中包含您要查找的信息。

# c++ - 为什么 GCC 在匹配函数时会查看私有构造函数？

> ID：515100
> 
> 赞同：1
> 
> 时间：2009-02-05T09:01:26.397
> 
> 标签：c++, gcc

我现在正忙着编写调试一些代码，所以我无法编写一个完整的示例，但这基本上描述了我的问题

```
class Base{};
class MyX:public Base
{
  ...
};
class Derived:Base
{
  ...
};
template<class X>
class MyClass:Derived
{
private:
   MyClass(const MyClass& )
     :x()
   {}
public:
   MyClass(const X& value)
    :x(value)
   {}
};

....
MyX      x;
MyClass<MyX>(x); 
```

这给了我这样的错误：

```
error: there are two possible constrcutors MyClass<X>(const MyClass<X>&) and MyClass<X>(const X&) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T09:24:15.803

```
MyClass<MyX>(x); 
```

被解析为

```
MyClass<MyX> x; 
```

但`MyClass<MyX>`没有默认构造函数。试着给它一个名字：

```
MyClass<MyX> p(x); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T09:12:14.613

恐怕您将不得不给我们一个更完整的代码示例。例如，在构造函数 MyClass(const X&) 中，您是用“x”初始化“x”吗？

```
MyClass(const& X value)
  :x(x) 
```

# .net - 鼠标移动时如何检测shift键按下状态

> ID：515109
> 
> 赞同：14
> 
> 时间：2009-02-05T09:05:53.737
> 
> 标签：.net, winforms, mouse

当鼠标悬停并按下 shift 键时，我试图在图像上显示放大的叠加层。

问题是用户可能在窗口获得焦点之前就按下了 shift 键，因此 KeyDown 监控不是解决方案。

有没有办法在鼠标事件期间访问修饰键状态？例如，在 Java 中，鼠标事件包含修饰键的标志，而在 .NET 中则不然。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-05T09:12:23.270

尝试使用[Control.ModifierKeys](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.modifierkeys.aspx)属性：

```
if ((Control.ModifierKeys & Keys.Shift) != Keys.None)
{
    // do my stuff
} 
```

# mdx - 网上最好的 MDX 参考资料

> ID：515114
> 
> 赞同：15
> 
> 时间：2009-02-05T09:09:47.397
> 
> 标签：mdx, business-intelligence

MDX 语言的最佳参考/链接、备忘单是什么？以下是我收集的一些开胃菜。请分享你的:)

*   [http://www.gumper.com/mdx.html](http://www.gumper.com/mdx.html)
*   [http://www.sqlserveranalysisservices.com/OLAPPapers/InventoryManagement%20in%20AS2005v2.htm](http://www.sqlserveranalysisservices.com/OLAPPapers/InventoryManagement%20in%20AS2005v2.htm)
*   [http://www.ssas-info.com/ssas-cheat-sheets/72-cheat-sheets/880-time-mdx-cheat-sheets](http://www.ssas-info.com/ssas-cheat-sheets/72-cheat-sheets/880-time-mdx-cheat-sheets)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-20T11:23:09.977

我是唯一一个知道 MDX 并且在离开公司之前不得不为我可怜的同事写**[这些文件的人......](http://sites.google.com/site/merlinmags/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T14:47:42.220

如果您不知道要查找的内容，可能很难查看，但是 如果您知道函数的名称， [Microsoft MDX 参考](http://msdn.microsoft.com/en-us/library/ms145506.aspx "微软 MDX 参考")实际上非常好。

显然（或者可能不*那么明显*）MDX 实现在 OLAP 源之间有所不同，并且 Microsoft 参考是针对 Analysis Services 量身定制的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-25T12:10:38.683

您可以在以下网址找到一些 MDX 文档（介绍和参考）： http: [//www.iccube.com/support/documentation/mdx/index.html](http://www.iccube.com/support/documentation/mdx/index.html)

# java - Java：基本 OOP 问题

> ID：515133
> 
> 赞同：1
> 
> 时间：2009-02-05T09:18:03.323
> 
> 标签：java, oop

我编写了一个具有高级模式和初学者模式的程序，以允许用户在实际使用我的程序之前掌握它的窍门。高级模式几乎与初学者模式相同，除了一个或两个方法需要被另一个替换，所以我决定为高级模式和初学者模式类创建一个通用模式类，而不是仅仅使用应对代码：这里如果我的解释不是很清楚，是类结构：

*   图形界面类
*   一般模式类
    *   初学者模式
    *   高级模式

假设通用模式类具有以下代码：

```
public class GeneralMode {

    private int range;
    private String id;

    public GeneralMode() {

    }

    public int getRange() {
        return range;
    }

    public String getID() {
    return id;
    }

    public void doStuff() {

    }

} 
```

GeneralMode 类是为程序完成所有工作的地方。现在，我想让 Advanced Mode 类可以从 GUI 类获取输入，并以与 GeneralMode 类相同的方式使用它。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-05T09:24:04.963

使“GeneralMode”类成为一个抽象类，其抽象方法必须由具体的“高级”和“初学者”类实现。两种模式共有的功能可以在“GeneralMode”类中实现。

然后，在您的 GUI 类中，实例化正确的具体类，并将其放入“GeneralMode”变量中。然后，您可以使用它，而不必知道您的程序是在初学者模式还是在高级模式下运行。

伪代码：

```
GeneralMode mode = (UseAdvancedMode == true)? new AdvancedMode() : new BeginnerMode(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T10:22:03.223

制作`GeneralMode`一个抽象类绝对是直接获得多态行为的方法（正如 Frederik Gheysels 正确解释的那样）。

另一个重要的 OO 范式是

> 支持组合而不是继承（[第 14 条，Josh Bloch 的“Effective Java”](http://books.google.ch/books?id=ZZOiqZQIbRMC&pg=PA71)）

如果您的项目符号列表代表您当前的继承层次结构（如果不是，请忽略我的评论......），我强烈建议您更改它，以便您`GUI Class`由一个模式***组成***（而不是模式是它的扩展 - - 经典的*“是一个”*与*“有一个”的*问题）。将任何 GUI 设置提取到参数对象中，然后将其传递给模式以完成它们的工作，这将进一步减少耦合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T10:21:51.053

只是为了补充 Frederik 的答案，GeneralMode 也可以是一个接口，BeginnerMode 和 AdvancedMode 实现了这个接口。

如果您想在所有子类之间共享逻辑，如果所有类都具有相同的 getId 实现以及任何其他相同的方法，请使用抽象类。

如果您想将这些方法的实现留给实现类，请使用接口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T10:45:34.593

另一种可能性是使用策略模式。在您的情况下，我更喜欢那个，因为我看到了更大的灵活性，例如在运行时更改模式时。在这种情况下，您不需要更改整个模型实例（模式对象），而只需通过加载不同的策略来更改它的行为。因此，您不会通过切换模式而丢失上下文的状态。

```
public class GeneralContext //was GeneralMode in your Code-Example
{
 ...
 public void doStuff()
 {
   myMode.doStuff()
 }

 public void changeStrategy(int mode)
 {
   switch(mode)
   {
      case EXPERT_MODE: myMode= new ExpertMode(); break;
       ....    
      default: throw NoSuchMode();
   }
 }

  ....
 private interface Mode
 {
   void doStuff();
 }

 private class ExpertMode implements Mode
 {
   void doStuff()
   {
     ....
   }
 }
 private class BeginnerMode implements Mode
 {
   void doStuff()
   {
     ....
   }
 }

} 
```

进一步阅读：GoF-Book（[参见维基百科](http://en.wikipedia.org/wiki/Design_Patterns)），第 315 页 ff。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T10:31:53.530

你走对了。您只需要修改`doStuff()`方法以从 GUI 获取所需的输入参数。然后 GUI 可以在`mode`它拥有的对象上调用此方法，并将适当的参数传递给它。

# javascript - 在 ExtJS 中处理来自 HTML 锚标记的事件

> ID：515141
> 
> 赞同：0
> 
> 时间：2009-02-05T09:23:30.250
> 
> 标签：javascript, html, dom, event-handling, extjs

我有一个用 ExtJS 构建的大型应用程序，并且正在寻找从应用程序中的任何位置处理自定义事件的最佳方法。例如，我可能想在应用程序的某些文本中放置一个锚标记，这将在我的应用程序中打开一个自定义组件。目前我会听到身体上的点击，如果目标有一个以某种格式应用到它的 css 类，我会使用它来执行一个动作。

例如我可能有：

```
<a class="ACTION-View-Customers">View Customers</a> 
```

我的事件处理程序会将类名分开并执行操作。这种方法的问题是很难将许多参数传递给处理程序。我建议在锚的 class 或 href 标记中使用 JSON，如下所示：

```
<a href="#" class="{ action: 'View', options: { name: 'Customers', type: 'All' } }">View Customers</a> 
```

你能想到这种方法的任何问题并提出任何替代方案吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T18:56:15.057

如果有帮助的话，我个人不会在 HTML 本身中使用额外的元数据。我会将特定 ID 应用于特定目的的链接，并将点击事件绑定到该对象。我还发现 DomQuery 对象（需要查找和引用锚点）很有趣。由于我通常将 JQuery 适配器与 Ext JS 一起使用，因此我将使用 JQuery 的选择器来定位特定的 DOM 元素，并使用 JQuery 的绑定函数 [.click(fn)]，同时在函数本身内部使用 Ext。JQuery 和 Ext JS 是一个很好的组合，尤其是新的 JQuery 1.3.1，它确实加快了速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T16:59:45.273

我建议使用 HTML5 的[`data-`属性](http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#embedding-custom-non-visible-data)。例如：

```
<a href="#" data-event="{ action: 'View', options: { name: 'Customers', type: 'All' } }">View Customers</a>

var eventsource = link.getAttribute("data-event"); 
```

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T06:58:30.130

您可能知道，HTML 标签接受任何命名属性。因此，您可以创建一些专门调用的属性并将任何值传递给它们（fe `my-bogus-param="something"`），这样您就可以开发任何复杂的参数传递系统。然后您可以在事件处理程序中解析这些属性。

# django - 如何为 Django 相关对象集实现通用接口？

> ID：515145
> 
> 赞同：4
> 
> 时间：2009-02-05T09:24:37.113
> 
> 标签：django, django-models, interface, dry

这是交易：

我有两个 db 模型，比如说`ShoppingCart`和`Order`. 遵循 DRY 原则，我想将一些常见的道具/方法提取到共享接口`ItemContainer`中。

一切都很顺利，直到我遇到`_flush()`主要对相关对象集执行删除的方法。

```
class Order(models.Model, interface.ItemContainer):

# ...

def _flush(self):
    # ...
    self.orderitem_set.all().delete() 
```

所以问题是：我如何动态地知道它是`orderitem_set`还是`shoppingcartitem_set`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T10:26:58.953

首先，这里有两个 Django 片段，它们应该正是您正在寻找的：

*   [具有内容类型和继承感知管理器的模型继承](http://www.djangosnippets.org/snippets/1034/)
*   [模型继承的 ParentModel 和 ChildManager](http://www.djangosnippets.org/snippets/1037/)

其次，您可能需要重新考虑您的设计并切换到具有简单方法的 django.contrib[内容类型框架。](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#module-django.contrib.contenttypes)[`.model_class()`](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#django.contrib.contenttypes.models.ContentType.model_class)（上面发布的第一个片段也使用了内容类型框架）。

第三，您*可能*不想在模型类中使用多重继承。它不应该是必需的，如果有一些模糊的副作用，我不会感到惊讶。只是`interface.ItemContainer`继承自`models.Model`，然后`Order`仅继承自`interface.ItemContainer`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T17:31:21.123

您可以设置 ForeignKey 的 related_name 参数，因此如果您想对设计进行最小的更改，您可以让 ShoppingCartItem 和 OrderItem 分别在其 ForeignKeys 上将相同的 related_name 设置为 ShoppingCart 和 Order（类似于“item_set”）：

```
order = models.ForeignKey(Order, related_name='item_set') 
```

和

```
cart = models.ForeignKey(ShoppingCart, related_name='item_set') 
```

# c# - c# 列表操作

> ID：515148
> 
> 赞同：3
> 
> 时间：2009-02-05T09:26:53.117
> 
> 标签：c#, list, list-manipulation

如果我有

```
List<String> text 
```

如何创建特定范围内所有连续元素的子列表，例如

```
List<String> subList = /* all elements within text bar the first 2*/ 
```

还有其他有用的列表操作提示和技巧可能有用吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-05T09:30:22.483

即使没有 LINQ，这也可以工作：

```
List<String> subList = text.GetRange(2, text.Count - 2); 
```

**编辑：**修正了一个错字。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-05T09:28:35.530

```
subList = text.Skip(2).ToList() 
```

Skip(n) 返回一个 IEnumerable<>，其中包含除第一个 n 之外的所有元素。

之后，当您确实需要一个列表时， ToList() 会将其转换回来。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T09:32:24.213

如果您使用的是 3.5，那么 List 上有很多新的有趣的方法可用。只需在此处查看“扩展方法”部分：http: [//msdn.microsoft.com/en-us/library/d9hw1as6.aspx](http://msdn.microsoft.com/en-us/library/d9hw1as6.aspx)

# c++ - 在 Linux 上尝试/捕获分段错误

> ID：515149
> 
> 赞同：11
> 
> 时间：2009-02-05T09:27:07.437
> 
> 标签：c++, linux, pointers, segmentation-fault

我有一个 Linux C++ 应用程序，我想在取消引用之前测试一个对象指针的有效性。但是由于分段错误，try/catch 在 Linux 上对此不起作用。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-05T09:34:25.767

分段错误不是异常（如 Java 的 NullPointerException）；它是从操作系统发送到进程的信号。查看[sigaction 的联机帮助页，](http://www.manpagez.com/man/2/sigaction/)了解如何为分段错误 (SIGSEGV) 安装处理程序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-05T11:03:21.783

如果您的应用程序中的许多指针引用相同的有限生命周期对象的情况，一种流行的解决方案是使用[boost 智能指针](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/smart_ptr.htm)。 **编辑：在 C++11 中，这两种类型都在标准库中可用**

您可能希望使用[`shared_ptr`](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/shared_ptr.htm)负责对象生命周期的[`weak_ptr`](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/weak_ptr.htm)指针和其他可能变得无效的指针。您会看到它`weak_ptr`具有您要求的内置有效性检查。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-05T09:33:09.157

您可以为此事件启用 SIGSEGV 的信号处理程序。有关详细信息，请参见手册页“信号”。另一种选择是使用保证有效的引用。当然，这取决于您的应用程序。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-05T09:32:01.297

将指针初始化为 NULL。如果经过一些处理它仍然是 NULL 它是无效的，否则它是有效的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T11:02:13.297

原始 C++ 指针没有自然、通用的方法。C++ 假定您将跟踪该信息。

在大多数情况下，您可以通过记住在指针无效时将指针设置为 NULL 来处理此问题。最初不指向的新指针应设置为 NULL，新删除的对象应将其指针设置为 NULL。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-05T09:34:57.483

你如何测试指针的有效性？与NULL比较？

你做的最好的事情是在[Valgrind](http://valgrind.org/)下运行你的程序。一个错误可能在一个完全不同的地方。

更新：在 Win32 平台上有类似 __try __except 的东西，它允许捕获一些异常。据我所知，该 Win32 功能没有 Linux 等价物。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-05T09:48:19.373

如果您将处理程序附加到 SIGSEGV，除了记录错误发生并正常失败的事实之外，您无能为力。发生这种违规时，您的程序处于未定义状态，因此继续正常操作可能不安全。

除了检查 NULL 我不相信有一种方法可以检查指针在您所描述的意义上是否“有效”。在正常操作期间，不应发生此类错误，因为它们代表错误，因此您应该希望程序失败，尽管是优雅的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-05T10:08:29.287

指针存储在对象中。它们在构造函数中初始化，可能为 0 (NULL)。它们在析构函数中被删除，可能是在赋值中，很少在其他函数中。当在除析构函数之外的成员中删除时，它们会立即被分配一个新值或 0。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T14:40:26.343

一般来说，关于“检查非 NULL 指针的有效性”这个非常奇怪的想法，看看这篇文章：http: [//blogs.msdn.com/oldnewthing/archive/2006/09/27/773741.aspx](http://blogs.msdn.com/oldnewthing/archive/2006/09/27/773741.aspx)（ “IsBadXxxPtr 真的应该被称为 CrashProgramRandomly”）

# testing - 从开发机器运行与安装时，VB6 应用程序测试结果有何差异？

> ID：515157
> 
> 赞同：1
> 
> 时间：2009-02-05T09:31:21.843
> 
> 标签：testing, vb6, system-dependent

我是 VB6 的新手，但我目前负责维护一个可怕的编辑器，比如工具，它有大量的表单、类、模块和 3rd 方工具，它们都像德克萨斯电锯大屠杀中那个人的皮肤一样块在一起。 .

我不明白为什么当我在调试模式下运行应用程序时得到不同的结果，而不是当我编译它并在我的开发电脑上运行它与我将它安装在不同的电脑上时。

是的，我知道我很笨，所以请指导我到哪里可以找到更多关于此的信息。我希望找到一些我现在根本没有得到的不同链接、注册表相关等连接，即像打蜡、打蜡这样的东西：P

脖子上的主要痛苦是当我试图从我的 QA 中调试一些错误时，我需要找到一台备用电脑来测试它，而且我无法直接调试，因为我不知道代码在哪里如果我那样做。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T13:34:54.957

> 我在调试模式下运行应用程序，而不是在我编译它并在我的开发电脑上运行它时

编译时，您可以选择编译为本机代码或 pcode。调试器仅使用 pcode 运行。在极少数情况下，当您编译为本机代码时，行为会发生变化。这种特殊情况真的很少见。我使用 VB6 自从它发布以来，我可能每年得到一两次。我的应用程序是一个复杂的 CAD/CAM 创建形状和运行金属切割机，并且有两打 DLL。不是典型的情况。在家里用我的爱好软件我从来没有遇到过这个问题。

还有另一类错误是由事件排序问题引起的。虽然 VB6 并不是真正的多任务处理，但它能够跳出当前代码块来处理事件。如果它为新事件重新进入相​​同的块，则可能会产生有趣的事情（至少可以说）。我认为这可能是您的问题的根源，因为您的软件是一个高度交互的软件类型的编辑器。

一般来说，问题是通过重新排序受影响的区域来解决的。您可以通过插入 MsgBox 或写入文本文件来记录您所在的位置来找到受影响的区域。我建议记录到文本文件，因为 MsgBox 倾向于改变与时间或多任务相关的行为。

请记住，如果在 VB6 在代码块中间触发事件并且有一个 DoEvents 浮动，那么它将离开代码块处理事件并返回到原始代码块。如果它重新输入相同的代码块，而您并不是故意要发生这种情况，那么您将遇到问题。而且你会在不同的计算机上遇到不同的问题，因为每台计算机的时间都不同。

处理此类问题的最简单方法是创建一些标志变量。在多任务用语中，它们被称为信号量或互斥量。当您输入代码的关键部分时，您将其设置为 true。当您离开例程时，您将其设置为 false。如果当你输入那段代码时它已经是真的，你就不会执行它。

> 当我将它安装在另一台电脑上时。

这些通常是安装了错误的 DLL 的结果。很可能你有一个旧版本，而目标有一个新版本。我会下载免费的 Virtual PC 并创建一个干净的 Window XP 安装来仔细检查这一点。

如果您的问题是事件计时，这在不同的计算机上也可能不同。这是通过记录（不是 MsgBox）可疑区域来发现的。

如果您可以显示屏幕截图或特定错误的文本，那么我可以提供更好的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T10:12:55.597

首先要检查的是您的应用程序所依赖的所有 dll 的版本 - 包括 VB6 dll 的服务包版本。

您是否有任何关于行为不同的更具体细节？

# tfs - 在 TFS 中，当用户名不同时，如何将用户从一个域移动到另一个域？

> ID：515162
> 
> 赞同：2
> 
> 时间：2009-02-05T09:33:26.737
> 
> 标签：tfs

我正在将用户从“旧”Windows 域转移到“新”域，并且需要在 TFS 权限中反映这些更改。

我已经成功地遵循了这篇 MSDN 文章中的说明：http: [//msdn.microsoft.com/en-us/library/ms404883.aspx](http://msdn.microsoft.com/en-us/library/ms404883.aspx)

但是我偶然发现了本文未涵盖的最终情况。对于某些用户，旧域中的用户名与新域中的用户名不同，并且该`TfsAdmin.exe Sid`命令似乎不知道如何解决此问题。

有人知道如何将 TFS sid 从 domainA\usernameA 重新分配到 domainB\usernameB？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T22:05:10.853

我不是 IT 人员，但问我们的常驻上帝说，如果您将旧 SID 添加到新用户的 SID 历史属性中，那么权限应该向后解析。我知道这不是 TFS 特定的，但我希望它能给你一些解决问题的线索。

他还说，您还需要确保域之间的信任关系。

# crystal-reports - 什么是中型运营（开放和商业）的最佳报告工具

> ID：515167
> 
> 赞同：6
> 
> 时间：2009-02-05T09:35:53.347
> 
> 标签：crystal-reports, report

如果企业需要连接到各种数据库并主要生成 PDF 报告，有什么好的工具。商业或开源。非技术用户还应该能够通过报表设计器工具生成具有美观图表和表格数据的各种报表。同样，我们应该能够在 Web 上部署这些图表并生成 HTML 或 PDF。

我们查看了 Adob​​e LiveCycle 等各种工具，但没有查看 Crystal Reports。

我更多的是技术人员，而不是真正的业务人员，我会介意像 Eclipse 的 BIRT（业务报告工具）这样的技术人员。Birt 的一切看起来都很好，并且完全符合我们的需要，但图表看起来并不那么令人印象深刻。

使用 Crystal Reports，一旦你引入了这些供应商，他们就会出售一堆你通常不需要的东西，而且这些东西是不可能完成的。但我可能是错的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T09:40:49.313

商业和大型应用：

[BI 出版商](http://www.oracle.com/technology/products/xml-publisher/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T09:49:48.700

[Telerik 报告](http://www.telerik.com/products/reporting.aspx)看起来很棒。主要优点是您可以创建报表，并将它们存储在 dll 程序集中，可以在 Web 和桌面查看器上使用。同时，需要所有出口。

缺点是报表设计器仍在 Visual Studio 中。仅限点网。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T09:52:00.273

我使用[webSuperGoo](http://www.websupergoo.com/abcpdf-1.htm)产品的[abcPDF](http://www.websupergoo.com/default.htm)。对于快速开发来说，它既好又简单。

我大约 5 年前使用过它，所以现在应该更新一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-22T20:07:19.663

[Livecycle Forms](http://www.adobe.com/products/livecycle/forms/)是一个不错的选择。整个事情是关于从您设计的模板开始构建 PDF 文档，然后以 XML 的形式将数据注入到模板中。最终结果是平面或交互式 PDF。Livecycle Forms 设计用于生成交互式 PDF，但在渲染完成后将文档展平非常简单。

您可能需要编写大量自定义代码来构建 XML 文档，但 PDF 构建功能令人印象深刻。如果您有一个复杂的工作流程，Livecycle 包也有一个您可以使用的工作流程设计器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-03T15:54:58.587

有关Java 解决方案，请参阅[此问题...](https://stackoverflow.com/questions/238527/what-is-the-best-report-engine-for-java)

这是我从那里复制的诚实（但有偏见）的答案：

**[i-net 晶莹剔透](http://www.inetsoftware.de/products/crystalclear)**

*   [报表引擎和Java 报表查看器](http://www.inetsoftware.de/products/crystalclear/guides/Guide_Viewer_Programming.pdf)的简单易用的 API 。
*   可以导出为任何主要格式，如 PDF、HTML、SVG、XLS 等，以及 Java 小程序查看器。（见[样品](http://www.inetsoftware.de/products/crystalclear/samples/applications/default.asp)）
*   带有免费且功能强大的图形化报表模板设计器。（见[视频指南](http://www.inetsoftware.de/products/crystalclear/guides/video/GettingStarted/GettingStarted.html)）
*   作为 WAR 文件安装在您的应用程序服务器上，或者可以用作您自己的应用程序中的库。
*   出色的技术支持（您通常会在几分钟或几小时内得到答复，而不是几天或几周）
*   基于[JFreeChart](http://www.jfree.org/jfreechart/)的图表（包括股票图表）。
*   **可以阅读 Crystal Reports 模板。**（对于很多客户来说，这是杀手级功能，因为您不必重新创建所有旧的 Crystal Reports 模板）
*   伟大而有竞争力的定价——如果你算上支持成本，实际上成本“[低于开源](http://www.inetsoftware.de/support/news/why-i-net-crystal-clear-costs-less-than-open-source)”——你绝对应该这样做。
*   [90 天](http://www.inetsoftware.de/products/crystalclear/download_update.asp)免费试用。

[完全披露：是的，我为生产这个的公司工作。但这仍然是我对这个问题的诚实（尽管主观和有偏见）的回答。;)]

# web-applications - 将您的 Web 应用程序发布到野外

> ID：515168
> 
> 赞同：3
> 
> 时间：2009-02-05T09:35:59.213
> 
> 标签：web-applications, deployment

假设您编写了下一个社交网络现象（或任何其他网络应用程序）。您选择了 Java、Tomcat、Apache 和 Oracle（或任何您喜欢的设置）。您知道想要在网络上发布它并让人们注册并开始使用它。

你在家里写的东西想把它带到野外，下一步是什么？

**编辑：**很抱歉造成混乱，我实际上是在出发前急于发布这篇文章，所以我实际上指的是商业部署。不仅把它放在某个地方的网络服务器上，而且这样做涉及到哪些细节。如果您有来自 ISP 的专用服务器，那么在使用您需要的架构设置您想要的数据库以及您可以获得什么样的访问权限来做您想做的事情时会涉及什么。如果它仍然听起来有点古怪，我很抱歉，但我以前从来没有做过这样的事情，只是想知道是否有任何棘手的问题。它可能就像注册并将您的 Web 应用程序存档弹出到服务器一样简单，仅此而已。我只是想知道它是否还有更多内容，以及是否有任何需要注意的事情或任何陷阱。我也很欣赏有关营销的回应，因为它们也非常有用。所以感谢那些谈论这个的人！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T09:45:54.467

我讨厌指出明显的，但把它放在一个网络服务器上，让人们使用它。

您可能还想阅读 37Signal 的*[Getting Real](http://gettingreal.37signals.com/)*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T09:46:51.920

营销！关于如何营销网站的问题没有固定的答案，但如果你想让人们使用它，那么你需要人们了解它。这可能意味着确保它在谷歌（和其他搜索引擎）中的相关关键词得到高度评价，或者可能意味着支付广告费用，或者可能意味着将您网站上的页面提交给 reddit、stackoverflow 等。更有可能的是，您想从您的朋友和家人开始并让他们使用它，以确保您可以应对真实的用户，然后通过口耳相传来传播。如果网站足够好，他们就会来。

编辑：我不确定这是否真的是你要问的，所以这可能是一个完全不相关的答案，在这种情况下我道歉！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T09:49:30.543

要做的前两件事是注册您的域名，.com 每年的费用约为 24 美元。您可以在[whoIs](http://www.whois.sc/)上查看可用的内容。接下来选择一个 ISP 来托管您的应用程序，费用从每月 5 美元以上不等。在市场的低端，您将拥有自己的虚拟 Web 服务器，它是大型机器的一小部分。应该给你免费的 Java、Tomcat、MySQL 等。如果你真的需要 Oracle（或 MSSQL），你的选择范围会更小，更贵。从那里开始的下一个跳跃是拥有自己的带有 ISP 的专用服务器，这种服务每月需要 100 美元。

请注意，为网络托管支付很多费用是可能的——如果您刚刚开始，很容易得到一些东西来尝试一下。您从 ISP 的管理工具获得的质量和访问权限非常重要，而且您支付的金额似乎与您获得的访问权限级别无关。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-05T09:56:09.843

除了明显的技术内容：

写博客并告诉其他博主。如果你的产品很好，他们会传播这个词。

也试试推特。搜索与您的产品相关的“关键字”。这确实是走出去的最快方式之一。我同意“Toytown Mafia”：看看[37signals](http://gettingreal.37signals.com/)真的很值得一读。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T10:02:14.043

我同意本。我认为您所说的“野外”是指实际营销而不是部署问题。

1）考虑你的目标受众是谁。– 你会在哪里找到它们？你的目标是最前沿的极客和早期采用者吗？还是你的目标是奶奶？你将如何联系他们？

2）你的产品帮助解决了什么问题？

3）关于它的博客。建立一个“产品”博客，解释你的设计决策、你的产品有多棒以及它如何帮助 X。例如：“Facebook 帮助我与所有朋友保持联系......”

4) 论坛。是否有适合您特定市场的论坛？不要去垃圾论坛，但可以考虑在您的论坛签名中添加指向您产品的链接。

5) 是否有针对您目标的利基市场的新闻网站？他们愿意链接到你吗？

6) 付费广告。– 谷歌广告要花钱，但更有针对性。也可以考虑在博客上投放广告，尤其是如果他们在博客上介绍您产品的市场领域。

7）不要忘记离线世界。是否也有杂志或活动可以宣传您的网站？

8) 这些事情需要时间。不要马上放弃。

# c - 如何使用 C 文件打开函数打开 .ttcn 文件？

> ID：515171
> 
> 赞同：0
> 
> 时间：2009-02-05T09:37:14.217
> 
> 标签：c, file, scripting, ttcn

我正在研究 TTCN-3（测试和测试控制符号）脚本语言。我想为此代码文件准备指南检查器。

为此，我想将 TTCN-3 脚本文件（诸如 file.ttcn 之类的东西）的行一一读取到缓冲区中。但对我来说 fopen / sopen / open / fgetc / fscanf 无法正常工作并且无法正确读取文件。它给出了NULL。有什么办法可以将它的字符读入缓冲区。我认为 C 不能读取超过三个扩展字符的文件（如 .ttcn）。如果我的假设是错误的，请原谅我。

我的环境是 Windows 上的 Turbo C。

**编辑**：

是的，我也检查了这些错误，但它们给出了 read() 的未知错误，并且不存在这样的文件或目录。

我的代码如下

```
#include <errno.h>
 #include <io.h>
 #include <fcntl.h>
 #include <sys\stat.h>
 #include <process.h>
 #include <share.h>
 #include <stdio.h>

 int main(void)
 {
    int handle;
    int status;
    int i=0;
    char ch;

    FILE *fp;
    char *buffer;
    char *buf;
    clrscr();
    handle = sopen("c:\\tc\\bin\\hi.ttcn", O_BINARY, SH_DENYNONE, S_IREAD); 
```

/*这里甚至我使用了 O_TEXT 和其他*/

```
 if (!handle)
    {
       printf("sopen failed\n");
   //    exit(1);
    }

   printf("\nObtained string %s @",buf);

    close(handle);

    fp=fopen("c:\\tc\\bin\\hi.ttcn","r");  \\sorry for the old version of one slash
   if(fp==NULL)                            \\I was doing it with argv[1] for opening 
   {                                       \\user given file name 
     printf("\nCannot open file");
   }
    ch=fgetc(fp);
   i=0;
   while(i<10)
   {
     printf("\ncharacter is %c  %d",ch,ch);
     i++;                                    //Here I wanted to take characters into 
     ch=fgetc(fp);                           //buffer   
   }
   getch();
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T09:39:37.863

您对扩展的假设是错误的。如果 fopen 返回 NULL，则应输出 strerror(errno) 的结果或使用 perror() 函数查看失败的原因。

**编辑**：问题可能是因为你有“c:\tc\bin\hi.ttcn”。例如，在 C 中，“\t”被解释为制表符。

你可以做

```
"c:\\tc\\bin\\hi.ttcn" 
```

但这非常难看，您的系统应该接受：

```
"c:/tc/bin/hi.ttcn" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T10:02:19.753

最可能的罪魁祸首是你的 Turbo C，一个古老的编译器。它在技术上是一个 DOS 编译器，而不是 Windows。这会将它的 RunTme 库限制为 8.3 文件名。升级到更新的东西——Turbo C++ 似乎是一个合乎逻辑的继任者，但微软的 VC++ Express 也可以。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T13:23:33.370

MS-DOS 不知道长文件名，包括扩展名超过 3 个字符的文件。因此，Turbo C 提供的 CRT 很可能不会查找您提供的名称，而是查找截断的名称 - 或其他名称。

Windows 方便地为这些文件提供了一个简短的（即匹配 8.3 格式，大多数情况下以 ~1 结尾，除非您使用具有相同 8 个字符前缀的文件）文件名；发现它的一种方法是打开控制台窗口并在存储文件的文件夹中运行“dir /x”。

找到与您的文件关联的短名称并将其修补到您的 C 源文件中。

编辑：该死，下次我会阅读评论。j_random_hacker 的所有学分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T10:57:29.517

既然您已经发布了代码，另一个问题就暴露出来了。

以下行：

```
fp=fopen("c:\tc\bin\hi.ttcn","r"); 
```

应该改为：

```
fp=fopen("c:\\tc\\bin\\hi.ttcn","r"); 
```

在 C 字符串中，反斜杠 ( `\`) 是一个*转义字符*，用于编码特殊字符（例如`\n`，表示换行符、`\t`制表符）。要实际使用文字反斜杠，您需要将其加倍。就目前而言，编译器实际上是在尝试打开一个名为`"C:<tab>c<backspace>in\hi.ttcn"`-- 不用说，不存在这样的文件！

# php - 分页递增问题

> ID：515176
> 
> 赞同：0
> 
> 时间：2009-02-05T09:41:45.863
> 
> 标签：php

我有以下代码，这是大型应用程序中分页的基础。但是，它不起作用，因为虽然我应该从 url 获取 pg 的值，但 pg 永远不会高于 2。出于某种原因，next = pg+1; 无论 url 上传递了什么，似乎总是将 pg 视为 1。与 last 类似的问题。我假设我正在覆盖从 GET 获得的值，但我不确定在哪里。

问题似乎在于我如何计算 $max 和限制，而不是通过 0、10、-10、10。此外，$max 之前的 ifcode 似乎无法成功阻止 pg 为 0。

```
<?php
if (isset($_GET["pg"])) {
    $pg = $_GET["pg"];
} else $pg = 1;
$con = mysql_connect("localhost","","");
if(!$con) {
    die('Connection failed because of' .mysql_error());
}
mysql_select_db("ebay",$con);

if ($pg < 1) {
    $pg = 1;
} elseif ($pg > $last) {
    $pg = $last;
}
$table = 'AUCTIONS';
$page_rows = 10;
$max = ' limit ' .($pg - 1) * $page_rows .', ' .$page_rows;
$rows = getRowsByArticleSearch($query, $table, $max);
$rowcount = count($rows);
echo $rowcount;
$last = ceil($rowcount/$page_rows);
$page_rows = 10;
$rowcount = 2;
// Would normally obtain the number of rows returned, but database stuff is snipped for brevity
$last = ceil($rowcount/$page_rows);
if ($pg < 1) {
    $pg = 1;
} elseif ($pg > $last) {
    $pg = $last;
}
$self = htmlspecialchars($_SERVER['PHP_SELF'],ENT_QUOTES,'utf-8');
echo " <a href='$self?pg=1'> <<-First</a> ";
$previous = $pg-1;
echo " <a href='$self?pg=$previous'> <-Previous</a> ";
echo "---------------------------";
$next = $pg+1;
echo " <a href='$self?pg=$next'>Next -></a> ";
echo " <a href='$self?pg=$last'>Last ->></a> "; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T09:43:39.650

这是你的问题：

```
$last = ceil($rowcount/$page_rows); 
```

这将 $last 设置为 1，然后你有：

```
if ($pg > $last) {
  $pg = $last;
} 
```

编辑：我想知道你是不是这个意思，而不是：

```
$last = ceil($page_rows/$rowcount); 
```

再次编辑：根据 Cassy 的回答，您可能真的只需要为这些变量设置正确的值：

```
$page_rows = 10;
$rowcount = 2; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T09:48:15.990

代码是正确的，但是数据是错误的。

当你有

```
$page_rows = 10;
$rowcount = 2; 
```

这实际上意味着，您在页面上显示了 2 行，每行将显示 10 行。这使它总共有 1 页。

将其更改为

```
$page_rows = 10;
$rowcount = 200; 
```

瞧，你会得到你的分页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T10:25:26.930

基于现在修订的问题：

```
$rowcount = count($rows); 
```

自然总是返回 10，因为你限制了结果

```
... LIMIT 10; 
```

但这可能会有所帮助：

[SQL CALC FOUND ROWS](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows) 示例：

```
mysql> SELECT SQL_CALC_FOUND_ROWS * FROM tbl_name
    -> WHERE id > 100 LIMIT 10;
mysql> SELECT FOUND_ROWS(); 
```

第一个查询仍将返回您的文章，而第二个查询将返回前一个选择如果不使用 LIMIT 子句将拥有的行数。

希望有帮助。

# visual-studio-2008 - 如何在 Visual Studio 2008 中获取 Windows 工作流模板？

> ID：515179
> 
> 赞同：2
> 
> 时间：2009-02-05T09:43:05.220
> 
> 标签：visual-studio-2008, workflow-foundation

我正在阅读[.NET 3.5 中的 Pro WF Windows Workflow](http://www.apress.com/book/view/1430209755)一书，第 5 页显示他们在 Visual Studio 2008 中打开了一个新项目，选择了“Visual C#/Workflow”并显示了 8 个模板：

*   空工作流项目
*   顺序工作流库
*   SharePoint 2007 状态机...
*   状态机工作流库
*   顺序工作流控制台应用程序
*   SharePoint 2007 顺序工作流
*   状态机工作流控制台应用程序
*   工作流活动库

然而，在我的（德语）Visual Studio 2008 中，即使在安装 SP1 之后，在工作流下我也只有：

*   Sequenzieller SharePoint 2007-工作流
*   SharePoint 2007 - 状态计算机工作流

在 WCF 下我发现：

*   顺序工作流服务库
*   状态机工作流服务库

但是如何获得书中提到的 Visual Studio 2008 工作流模板呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T09:55:22.823

你用的是哪个版本的VS？我正在运行 VS2008 Team Suite (SP1)，我得到了提到的所有 8 个模板。也许尝试在虚拟机上重新安装，看看是否是安装失败？

# maven-2 - 硒网格 + Maven 2

> ID：515180
> 
> 赞同：6
> 
> 时间：2009-02-05T09:43:19.337
> 
> 标签：maven-2, selenium-grid

有没有好的教程或者有没有人有设置它的经验？我有一个 Testsuite.html，它在一个浏览器 atm 中启动我的测试。这是由 maven selenium 插件在集成测试生命周期中完成的。我想在多个浏览器上运行我的测试。我找不到任何关于 selenium grid + maven 的文档。我希望有人能帮助我。

在此先感谢，库库达斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-05T09:49:16.020

Selenium Grid 和 maven 与 Selenium 和 maven 并没有太大区别。

Grid 基本上是 selenium-rc 的替代品。在我们当前的设置中，我们让自动构建系统使用 Grid。它通过简单地将 selenium-rc url（通常是 localhost:4444）更改为网格的 url 来实现。

此外，我们在 mvn 命令行上将浏览器字符串（*firefox、*iexplore、*opera 或其他）指定为系统属性，当我们在代码中初始化 selenium 客户端库时会使用它。

所以我们完成它的方式基本上设置了 4 个不同的构建项目，使用不同的浏览器字符串。

# asp.net - 在 MasterPage ASP.Net 中查找所有 ContentPlaceHolders

> ID：515184
> 
> 赞同：1
> 
> 时间：2009-02-05T09:45:29.677
> 
> 标签：asp.net, master-pages

我必须在 MasterPage 中找到所有 contentPlaceHolders 的 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T09:49:05.863

遍历所有控件并递归地遍历它们的子控件并检查类型，如果它们是内容占位符，则您有 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T10:13:09.713

只需查询`ContentPlaceHolders`返回包含给定母版页中所有 CPH 名称的 IList 的属性。

VB代码：（对不起！）

```
'In the Master Page.
For Each cphID As String In Me.ContentPlaceHolders
  Debug.WriteLine(cphID)
Next 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T10:53:24.297

尝试：

```
for (string cphID in ((MasterPageType)this.MasterPage).ContentPlaceHolders)
{
   Debug.WriteLine(cphID);
} 
```

在页面后面的代码中，将 MasterPageType 替换为母版页的类型

# open-source - 需要在用户网站上给予信用的开源许可证

> ID：515200
> 
> 赞同：10
> 
> 时间：2009-02-05T09:49:53.117
> 
> 标签：open-source, licensing

我有这个小代码库，我正在考虑将其发布到开源中。我想在类似于 MIT 许可证的情况下发布它，即没有重大限制，但是我想要求如果您在您的服务器上使用我的库，您必须在您的网站上给我信用。

基本上，我想要一个 MIT 许可证的许可证，就像 AGPL 是 GPL 一样。

这样的东西是否存在，还是我必须自己写？

或者这只是一个非常糟糕的主意？

**编辑**：我想我应该省略“写我自己的”部分。我不是律师，我也不想付钱。我只是认为能够通过简单的谷歌搜索来判断是否有人在使用我的库会很好。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-05T09:55:46.100

看这里 ：

[http://www.opensource.org/licenses/category](http://www.opensource.org/licenses/category)

并且 pleeeeeeeeeeeease 不要自己写！

来自 Aaron Digulla 的评论（谢谢 Aaron）：

*律师要花很长时间才能写出一份在法庭上实际持有的许可证（为什么你会想要一份不持有的许可证？）全世界有数百人在 GPL v3 上工作了几个月！——亚伦·迪古拉*

另一方面 ：

当您在公司工作并且您将使用开源时，您通常可以在公司“批准”的许可证中进行选择:-)。

新许可证通常是不行的 :-(

**注意**Kodisha：来自 cc 站点：

*不得将知识共享许可用于软件。我们强烈建议您使用已经可用的非常好的软件许可证之一。*

PS：[看看选择什么开源许可证？](https://stackoverflow.com/questions/236699/what-open-source-license-to-choose)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-05T10:19:31.683

事实证明，CC 对于软件来说并不是那么好:(

CPAL 是不错的选择，因为它对“源代码”有更好的定义（CC 没有）

它基于 Mozilla Public License，但它具有 Attribution 。许可证于 2007 年获得 OSI 批准。

[http://opensource.org/licenses/cpal_1.0](http://opensource.org/licenses/cpal_1.0)

这是 facebook 用于 FBOpen 平台的许可证示例。

[http://developers.facebook.com/fbopen/cpal.html](http://developers.facebook.com/fbopen/cpal.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T09:55:14.853

也许是知识共享署名许可？

> 此许可允许其他人分发、混音、调整和构建您的作品，甚至商业化，只要他们将原创作品归功于您。就其他人可以对您在署名下获得许可的作品执行的操作而言，这是提供的最宽松的许可。

[http://creativecommons.org/about/licenses/](http://creativecommons.org/about/licenses/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T13:16:53.557

*请记住：MIT 和 BSD 从其许可证中删除*署名要求是有充分理由的。

# eclipse - Eclipse 的备忘单存储库/目录

> ID：515208
> 
> 赞同：5
> 
> 时间：2009-02-05T09:53:49.380
> 
> 标签：eclipse

如果存在，我在哪里可以找到 Eclipse 备忘单存储库？

我的意思是，Eclipse 有这个“备忘单”功能（Help -> Cheat Sheets），但是虽然它是一个简单而强大的功能，但我还没有看到有人使用它，例如教程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T10:12:23.243

正如[马克在他的回答中提到的那样](https://stackoverflow.com/questions/515208#515227)，如果您安装了插件，它们很可能会附带备忘单。

正如这篇 IBM 文章[在 Eclipse V3.2 中构建备忘单中](http://www.ibm.com/developerworks/opensource/library/os-ecl-cheatsheets/)提到的，您可以：

*   对“插件”一词进行帮助搜索：它将返回与您的查询匹配的备忘单以及其他内容。
    但是通过在查询中添加“备忘单”来优化您的搜索可能会过度缩小结果并排除有用的内容。
*   **如果您使用类别按钮**在类别中显示搜索结果，则显式显示备忘单结果。****

 **![小纸条](https://i.stack.imgur.com/sTlVo.jpg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T10:03:07.753

看看[Dzone 的](http://refcardz.dzone.com/refcardz/getting-started-eclipse?oid=hom7187)。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-20T14:34:29.040

[VonC 回答](https://stackoverflow.com/questions/515208/eclipses-cheat-sheet-repository-directory/515261#515261)的内容越接近您的回答。在互联网上进行研究后，我找不到可以下载备忘单并将其用作教程的中心位置。

对于那些科技企业家来说，这可能是一个市场利基。:D

# data-structures - 树数据结构中的节点总数？

> ID：515214
> 
> 赞同：18
> 
> 时间：2009-02-05T09:55:36.723
> 
> 标签：data-structures, tree

我有一个深度为 L 级的树数据结构，每个节点**大约**有N 个节点。我想计算出树中节点的总数。要做到这一点（我认为），我需要知道将有孩子的节点的百分比。

N 中叶节点与非叶节点的比例的正确术语是什么？

计算三个节点总数的公式是什么？

**更新**有人在其中一个答案中提到了**分支因素**，但随后消失了。我想这是我一直在寻找的术语。那么公式不应该考虑分支因素吗？

**更新**我应该对假设的数据结构进行估计，而不是确切的数字！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-05T10:17:31.220

好的，每个节点都有大约 N 个子节点，树的深度为 L 级。

```
With 1 level, the tree has 1 node.
With 2 levels, the tree has 1 + N nodes.
With 3 levels, the tree has 1 + N + N^2 nodes.
With L levels, the tree has 1 + N + N^2 + ... + N^(L-1) nodes. 
```

节点总数为 (N^L-1) / (N-1)。

好的，只是一个小例子，为什么它是指数的：

```
 [NODE]
                      |
                     /|\
                    / | \
                   /  |  \
                  /   |   \
            [NODE]  [NODE] [NODE]
              |
             /|\
            / | \ 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-01T01:44:05.137

只是为了纠正第一个答案中的错字：深度为 L 的树的节点总数为 (N^(L+1)-1) / (N-1)...（即幂 L +1 而不仅仅是 L）。

这可以如下所示。首先，我们的定理：

1 + N^1 + N^2 + ... + N^L = (N^(L+1)-1)/(N-1)

两边乘以 (N-1)：

(N-1)(1 + N^1 + N^2 + ... + N^L) = N^(L+1)-1。

展开左侧：

N^1 + N^2 + N^3 + ... + N^(L+1) - 1 - N^1 - N^2 - ... - N^L。

所有项 N^1 到 N^L 都被取消，剩下 N^(L+1) - 1。这是我们的右手边，所以初始等式是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T10:00:29.210

深度L的节点数计算公式为：（假设有N个根节点）

NL ^_

要计算所有节点的数量，需要对每一层执行此操作：

```
for depth in (1..L)
    nodeCount += N ** depth 
```

如果只有 1 个根节点，则从 L 中减去 1 并将总节点数加 1。

请注意，如果在一个节点中的叶子数量与平均情况不同，这可能会对您的数量产生很大影响。树的位置越高，影响越大。

```
     * * * N ** 1
    *** *** *** N ** 2
*** *** *** *** *** *** *** *** *** N ** 3

```

这是社区 wiki，所以请随意更改我令人震惊的代数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T10:20:27.593

如果您的树大约是*完整*的，即除了最后两个之外，每个级别都有其完整的子节点，那么您的叶子节点介于 N^(L-2) 和 N^(L-1) 之间，并且介于 N^(L -1) 和 N^L 个节点总数。

如果你的树没有满，那么知道叶节点的数量并没有帮助，因为一棵完全不平衡的树将有一个叶节点，但有任意多个父节点。

我想知道你的陈述“每个节点大约有 N 个节点”有多精确——如果你知道平均分支因子，也许你可以计算出树的预期大小。

如果您能够找到叶子与内部节点的比率，并且您知道平均子节点数，则可以将其近似为 (n*ratio)^N = n。这不会给你答案，但我想知道数学比我更好的人是否能想出一种方法将 L 插入这个方程并给你一些可解的东西。

尽管如此，如果您想准确地知道，您必须遍历树的结构并随时计算节点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-14T04:08:05.510

Knuth 的估计器 [1],[2] 是一个[点估计](https://en.wikipedia.org/wiki/Point_estimation)，它以任意有限树中的节点数为目标，无需遍历所有节点，即使树不平衡。Knuth 的估计器是无偏估计器的一个例子；Knuth 估计器的期望值将是树中的节点数。话虽如此，如果所讨论的树不平衡，Knuth 的估计量可能会有很大的差异，但在你的情况下，由于每个节点都会有大约 N 个子节点，我认为 Knuth 的估计量的方差应该不会太大。当人们试图测量执行蛮力搜索所需的时间时，这个估计器特别有用。

对于以下函数，我们将假设所有树都表示为列表的列表。例如，`[]`表示具有单个节点的树，`[[],[[],[]]]`将表示具有 5 个节点和 3 个叶子的树（树中的节点与左括号一一对应）。以下函数是用 GAP 语言编写的。

该函数`simpleestimate`给出了树中节点数的估计值`tree`。背后的想法`simpleestimate`是我们随机选择从树的根 x_0 到叶子 x_n 的路径 x_0,x_1,...,x_n。假设 x_i 有 a_i 个后继者。然后`simpleestimate`将返回 1+a_1+a_1*a_2+...+a_1*a_2*...*a_n。

```
point:=tree; prod:=1; count:=1; list:=[]; 
while Length(point)>0 do prod:=prod*Length(point); count:=count+prod; point:=Random(point); od;
return count; end; 
```

该函数`estimate`将简单地给出通过`simpleestimate(tree)` `samplesize`多次应用该函数给出的估计值的算术平均值。

```
estimate:=function(samplesize,tree) local count,i; 
count:=0; 
for i in [1..samplesize] do count:=count+simpleestimate(tree); od; 
return Float(count/samplesize); end; 
```

**示例：** `simpleestimate([[[],[[],[]]],[[[],[]],[]]]);`在返回`15`时 `estimate(10000,[[[],[[],[]]],[[[],[]],[]]]);`返回`10.9608`（树实际上确实有 11 个节点）。

1.  估计搜索树大小。 [http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.129.5569&rep=rep1&type=pdf](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.129.5569&rep=rep1&type=pdf)

2.  估计回溯程序的效率。Donald E. Knuth [http://www.ams.org/journals/mcom/1975-29-129/S0025-5718-1975-0373371-6/S0025-5718-1975-0373371-6.pdf](http://www.ams.org/journals/mcom/1975-29-129/S0025-5718-1975-0373371-6/S0025-5718-1975-0373371-6.pdf)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T09:59:56.857

如果您只知道树的深度，那么您计算总大小的唯一选择就是遍历并计算它们。

# asp.net - 打开 MVC 视图时 Visual Studio 2008 SP1 崩溃

> ID：515217
> 
> 赞同：2
> 
> 时间：2009-02-05T09:56:32.633
> 
> 标签：asp.net, asp.net-mvc, visual-studio-2008

我在装有 .NET Framework 3.5 SP1 的 XP SP2 机器上安装了 Visual Studio 2008 SP1 和 ASP.NET MVC RC。（一句话就是一大堆SP！）

我有一个 ASP.NET MVC 项目，我可以用 Visual Web Developer Express 很好地编辑它。但是在 Visual Studio 2008 SP1 中打开视图页面会使 Visual Studio 崩溃并消失，甚至没有给出错误消息。

现在，一些博主提出，TFS Power Tools 或 Visual Studio Power Tools 都可能导致此问题。但是，我都没有安装。

Visual Studio 可以使用 /SafeMode 选项启动，该选项解决了该问题。但我想知道是否有更优雅的解决方案可用？

绒球

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T07:11:45.963

Microsoft 现已发布修补程序来解决此问题。

请参阅[https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=16827&wa=wsignin1.0](https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=16827&wa=wsignin1.0)

Phil Haack 在这里详细说明 - [http://haacked.com/archive/2009/03/06/hotfix-for-installing-aspnetmvc.aspx](http://haacked.com/archive/2009/03/06/hotfix-for-installing-aspnetmvc.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T03:20:02.567

为我解决的问题是清除本机图像缓存。

转到 %windir%\assembly 并删除以 NativeImages 开头的文件夹。我有两个... NativeImages_v2.0.50727_32 和 NativeImages_v2.0.50727_64 因为我运行的是 64 位 Vista。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T10:10:52.950

几天前我遇到了同样的问题，我删除了 Microsoft.VisualStudio.QualityTools.UnitTesting.Silverlight.dll 的所有示例。我在谷歌上找到了解决方案，和你一样，我没有运行 PowerTools。我猜你在看

.NET 运行时版本 2.0.50727.3053 - 致命的执行引擎错误 (7A035E00) (80131506)？

我重命名了该 DLL 的所有示例并重新启动，现在我可以再次工作，但不知道当我必须再次对 SilverLight 进行单元测试时我会做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T10:08:10.323

在这里回答自己：

我最终删除了名为 Ora 的 Visual Studio 插件。这似乎阻止了与 MVC View 相关的 Visual Studio 崩溃。

# fluent-nhibernate - 与nhibernate的映射对象化关系无法初始化集合

> ID：515242
> 
> 赞同：1
> 
> 时间：2009-02-05T10:04:47.377
> 
> 标签：fluent-nhibernate

我正在按照[本](http://baley.codebetter.com/blogs/kyle.baley/archive/2008/12/24/many-to-many-relationships-with-data-attached-in-nhibernate.aspx)指南映射一个对象化的关系（many->many 映射表包含属性）。

生成的 SQL（见异常）正在工作并返回我想要的（严格来说它应该是一个内部连接？）。但我得到一个`GenericADOException`说法：

> 无法初始化集合：[Questionnaires.Core.Questionnaire.Questions＃CBDEDAFC183B4CD7AF1422423A91F589] [SQL：SELECT questions0_.ida_questionnaire_id为ida4_2_，questions0_.ida_questionnaire_question_id为ida1_2_，questions0_.ida_questionnaire_question_id为ida1_5_1_，questions0_.question_no为question2_5_1_，questions0_.ida_question_id为ida3_5_1_ ，questions0_.ida_questionnaire_id如ida4_5_1_，question1_.ida_question_id如ida1_3_0_，question1_.ida_question_type_id如ida2_3_0_，question1_.description如descript3_3_0_，question1_.validate_max如validate4_3_0_，question1_.validate_min如validate5_3_0_ FROM ida_questionnaire_question questions0_左外连接ida_question question1_上questions0_.ida_question_id = question1_ .ida_question_id WHERE questions0_.ida_questionnaire_id=?]

我猜这是因为`Questionnaire`它真的映射到`QuestionnaireQuestion`不`Question`（`Questionnaire`-> `hasMany`-> `QuestionnaireQuestion`<- `hasMany`<- `Question`）。但我似乎无法找到解决这个问题的方法。

问题：

```
public class Question : PersistentObjectWithTypedId<string>
{
    #region Constructors

    public Question()
    {
        Alternatives = new List<Alternative>();
        Questionnaires = new List<Questionnaire>();
    }
    public Question(string description)
        : this()
    {
        Check.Require(!string.IsNullOrEmpty(description) && description.Trim() != string.Empty);
        Description = description;
    }

    #endregion

    #region Properties

    public virtual string Type { get; set; }
    public virtual string Description { get; set; }
    public virtual int Order { get; set; }
    public virtual IList<Questionnaire> Questionnaires { get; set; }
    public virtual IList<Alternative> Alternatives { get; set; }
    public virtual Validator MyValidator { get; set; }
}

public class QuestionMap : ClassMap<Question>
{
    public QuestionMap()
    {
        WithTable("ida_question");
        Id(x => x.ID, "ida_question_id").WithUnsavedValue(0).GeneratedBy.UuidHex("");
        Map(x => x.Description, "description").AsReadOnly();
        Map(x => x.Type, "ida_question_type_id").AsReadOnly();

        Component<Core.Validator>(x => x.MyValidator, m =>
            {
                m.Map(x => x.Type, "ida_question_type_id");
                m.Map(x => x.RangeMin, "validate_min");
                m.Map(x => x.RangeMax, "validate_max");
            });

        HasMany<QuestionnaireQuestion>(x => x.Questionnaires)
            .Cascade.AllDeleteOrphan()
            .WithKeyColumn("ida_question_id");

        HasMany<Alternative>(x => x.Alternatives)
            .IsInverse()
            .WithKeyColumn("ida_question_id")
            .AsBag().SetAttribute("cascade", "all");
    }
} 
```

问卷问题：

```
public class QuestionnaireQuestion : PersistentObjectWithTypedId<string>
{
    protected QuestionnaireQuestion()
    {
    }

    public virtual int QuestionOrder { get; set; }
    public virtual Question Question {get;set;}
    public virtual Questionnaire Questionnaire { get; set; }
}

public class QuestionnaireQuestionMap : ClassMap<QuestionnaireQuestion>
{
    public QuestionnaireQuestionMap()
    {
        WithTable("ida_questionnaire_question");
        SetAttribute("lazy", "false");
        Id(x => x.ID, "ida_questionnaire_question_id")
            .WithUnsavedValue(0)
            .GeneratedBy.UuidHex("");

        References(x => x.Question, "ida_question_id")
            .WithForeignKey("ida_question_id")
            .FetchType.Join();

        References(x => x.Questionnaire, "ida_questionnaire_id")
            .WithForeignKey("ida_questionnaire_id")
            .FetchType.Join();

        Map(x => x.QuestionOrder, "question_no");
    }
} 
```

问卷：

```
public class Questionnaire : PersistentObjectWithTypedId<string>
{
    #region Constructors

    public Questionnaire()
    {
        Questions = new List<Question>();
    }
    public Questionnaire(string description) : this()
    {
        Check.Require(!string.IsNullOrEmpty(description) && description.Trim() != string.Empty);
        Description = description;
    }

    #endregion

    #region Properties

    public virtual string Description { get; set; }
    public virtual IList<Question> Questions { get; set; }

    #endregion
}

public class QuestionnaireMap : ClassMap<Questionnaire>
{
    public QuestionnaireMap(){
        WithTable("ida_questionnaire");
        SetAttribute("lazy", "false");
        Id(x => x.ID, "ida_questionnaire_id")
            .WithUnsavedValue(0)
            .GeneratedBy.UuidHex("");

        Map(x => x.Description);

        HasMany<QuestionnaireQuestion>(x => x.Questions)
            .Cascade.AllDeleteOrphan()
            .WithKeyColumn("ida_questionnaire_id");
    }
} 
```

* * *

在数据库中的异常中运行 SQL 的结果是 6 行（预期数量），其中包含：

*   IDA4_2_：指南
*   IDA1_2_：指南
*   IDA1_5_1_：指南
*   QUESTION2_5_1：编号（订单属性）
*   IDA3_5_1_：指南
*   IDA4_5_1：指南
*   IDA1_3_0_：指南
*   IDA2_3_0_：手机（类型属性）
*   DESCRIPT3_3_0_：mobiletelefon（描述属性）
*   VALIDATE4_3_0_：（RangeMin 属性）
*   VALIDATE5_3_0_：（RangeMax 属性）

完整的例外是：

> [InvalidCastException：不能使用对象类型 Questionnaires.Core.QuestionnaireQuestion 作为 Questionnaires.Core.Question。] NHibernate.Collection.Generic.PersistentGenericBag`1.ReadFrom（IDataReader 阅读器，ICollectionPersister 持久化器，ICollectionAliases 描述符，对象所有者）+160 NHibernate.Loader。 Loader.ReadCollectionElement（对象 optionalOwner，对象 optionalKey，ICollectionPersister 持久化器，ICollectionAliases 描述符，IDataReader rs，ISessionImplementor 会话）+407 NHibernate.Loader.Loader.ReadCollectionElements（Object[] 行，IDataReader 结果集，ISessionImplementor 会话）+412 NHibernate.Loader.Loader .GetRowFromResultSet(IDataReader resultSet, ISessionImplementor session, QueryParameters queryParameters, LockMode[] lockModeArray, EntityKey optionalObjectKey, IList hydradObjects, EntityKey[] 键,Boolean returnProxies) +472 NHibernate.Loader.Loader.DoQuery(ISessionImplementor session, QueryParameters queryParameters, Boolean returnProxies) +1010 NHibernate.Loader.Loader.DoQueryAndInitializeNonLazyCollections(ISessionImplementor session, QueryParameters queryParameters, Boolean returnProxies) +114 NHibernate.Loader.Loader.LoadCollection （ISessionImplementor 会话，对象 id，IType 类型）+362
> 
> [GenericADOException：无法初始化集合：[Questionnaires.Core.Questionnaire.Questions＃CBDEDAFC183B4CD7AF1422423A91F589] [SQL：SELECT questions0_.ida_questionnaire_id为ida4_2_，questions0_.ida_questionnaire_question_id为ida1_2_，questions0_.ida_questionnaire_question_id为ida1_5_1_，questions0_.question_no为question2_5_1_，questions0_。 ida_question_id为ida3_5_1_，questions0_.ida_questionnaire_id为ida4_5_1_，question1_.ida_question_id为ida1_3_0_，question1_.ida_question_type_id为ida2_3_0_，question1_.description为descript3_3_0_，question1_.validate_max为validate4_3_0_，question1_.validate_min作为validate5_3_0_ FROM ida_questionnaire_question questions0_留在questions0_外连接ida_question question1_。 ida_question_id=question1_.ida_question_id WHERE questions0_.ida_questionnaire_id=?]] NHibernate.Loader。Loader.LoadCollection(ISessionImplementor session, Object id, IType type) +528 NHibernate.Loader.Collection.CollectionLoader.Initialize(Object id, ISessionImplementor session) +74 NHibernate.Persister.Collection.AbstractCollectionPersister.Initialize(Object key, ISessionImplementor session) + 59 NHibernate.Event.Default.DefaultInitializeCollectionEventListener.OnInitializeCollection(InitializeCollectionEvent 事件) +573 NHibernate.Impl.SessionImpl.InitializeCollection(IPersistentCollection 集合，布尔写法) +150 NHibernate.Collection.AbstractPersistentCollection.ForceInitialization() +287 NHibernate.Engine.StateonfulsLatestCollection () +213 NHibernate.Loader.Loader.DoQueryAndInitializeNonLazyCollections(ISessionImplementor session, QueryParameters queryParameters,Boolean returnProxies) +171 NHibernate.Loader.Loader.LoadEntity(ISessionImplementor session, Object id, IType identifierType, Object optionalObject, String optionalEntityName, Object optionalIdentifier, IEntityPersister persister) +493 NHibernate.Loader.Entity.AbstractEntityLoader.Load(ISessionImplementor session, Object id, Object optionalObject, Object optionalId) +82 NHibernate.Loader.Entity.AbstractEntityLoader.Load(Object id, Object optionalObject, ISessionImplementor session) +54 NHibernate.Persister.Entity.AbstractEntityPersister.Load(Object id, Object optionalObject, LockMode lockMode, ISessionImplementor 会话）+206 NHibernate.Event.Default.DefaultLoadEventListener.LoadFromDatasource（LoadEvent 事件，IEntityPersister 持久化，EntityKey keyToLoad，LoadType 选项）+133 NHibernate.Event.Default。DefaultLoadEventListener.DoLoad（LoadEvent 事件，IEntityPersister 持久化，EntityKey keyToLoad，LoadType 选项）+948 NHibernate.Event.Default.DefaultLoadEventListener.Load（LoadEvent 事件，IEntityPersister 持久化，EntityKey keyToLoad，LoadType 选项）+436 NHibernate.Event.Default.DefaultLoadEventListener。 ProxyOrLoad(LoadEvent event, IEntityPersister persister, EntityKey keyToLoad, LoadType options) +236 NHibernate.Event.Default.DefaultLoadEventListener.OnLoad(LoadEvent event, LoadType loadType) +1303 NHibernate.Impl.SessionImpl.FireLoad(LoadEvent event, LoadType loadType) +125 NHibernate.Impl.SessionImpl.Get(String entityName, Object id) +145 NHibernate.Impl.SessionImpl.Get(Type entityClass, Object id) +66 NHibernate.Impl.SessionImpl.Get(Object id) +91 SharpArch.Data.NHibernate .RepositoryWithTypedId`2.Get(IdT id) +152 Questionnaires.Controllers.QuestionnaireController.Create(String username, String id) in C:\Documents and Settings\berbor\Mine dokumenter\Visual Studio 2008\Projects\Questionnaires\Questionnaires.Controllers\ QuestionnaireController.cs:40 lambda_method(ExecutionScope, ControllerBase, Object[]) +205 System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase 控制器, Object[] 参数) +17 System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 个参数）+178 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod（ControllerContext controllerContext，ActionDescriptor actionDescriptor，IDictionary`2 个参数）+24 System.Web.Mvc.<>c__DisplayClassa.b__7() +52 System.Web.Mvc .ControllerActionInvoker。InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +254 System.Web.Mvc.<>c__DisplayClassc.b__9() +19 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 过滤器, ActionDescriptor actionDescriptor , IDictionary`2 参数) +192 System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +350 System.Web.Mvc.Controller.ExecuteCore() +110 System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext）+27 System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute（RequestContext requestContext）+7 System.Web.Mvc.MvcHandler.ProcessRequest（HttpContextBase httpContext）+119 System.Web.Mvc.MvcHandler。ProcessRequest(HttpContext httpContext) +41 System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext) +7 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +181 System.Web .HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75

* * *

至于我这样做的原因：

一个问卷可能有很多问题，一个问题可能有很多问卷。我希望能够`Questions`根据上下文（`Questionnaire`在其中）给出一些属性，一个问题可能需要在一个调查问卷中，而不是另一个问题等。这不仅仅是顺序，这只是一个试图保持简单的例子。

尝试将数据加载到`Questionnaire.IList<Question>`. 在我修改我`IList<Questionnaire>`的 to`IList<QuestionnaireQuestion>`和相应的映射后，它仍然被抛出。

那么问题将`Questionnaire.Questions`是映射为包含`QuestionnaireQuestion`但类型为`Question`。但是，如果我尝试将其映射为包含`QuestionnaireQuestion`我的 SQL，则根本不加入，它仍然会失败。这是我应该做的，只是我做错了吗？在我读到的示例中，他就像我所看到的那样做，唯一的区别是现在使用泛型的 FluentNhibernate 的较新版本。所以我需要指定正确的类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T10:44:48.560

然后，您的 Question 类中不应该有一个 List of Questionnaires，而是一个 List of QuestionnaireQuestion 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T10:12:35.677

您确定收到 ADO.NET Exception 吗？你可以对你的数据库执行生成的查询吗？

但是我不明白你的情况，这个 QuestionairreQuestion 类是什么？您没有在 Question 课程中使用它吗？我了解您希望有一个您的问题应该出现的顺序。
所以，如果你有额外的属性，我认为你应该在 Question 类中使用 QuestionairreQuestion 类。但是，如果您只有这个 QuestionairreQuestion 类来强制执行“订单”（并且没有其他属性），那么您可以使用另一个 Collection-Type 而不是 IList。
NHibernate 中有一些集合允许您拥有有序集合（例如 map ）。因此，您可以在 Question 类中使用此集合来保存 Questionairre 对象。

（ps：nhibernate 生成一个外连接，因为您没有在映射中指定集合不应为空。因此，使用外连接是因为在某些情况下，您可能有一个没有 Questionaires 的 Question，就 nhibernate 而言）。

# linux - 为什么我的 apache 进程不能写入我的世界可写文件？

> ID：515243
> 
> 赞同：2
> 
> 时间：2009-02-05T10:05:12.617
> 
> 标签：linux, apache, permissions, cgi

我遇到了这个问题并且我陷入了僵局，我会尝试任何我已经陷入僵局的事情。我的问题是这样的：

我在运行 apache2 的 Fedora 9 机器上安装了一个 Perl/CGI 脚本，这个脚本有一个配置文件放在同一目录中，这个配置文件有 777 权限。

脚本无法写入文件。它可以读取，但我绝对无法让它写入。该文件由运行 apache 的同一用户拥有。我写了一个小的 PHP 脚本来测试并将它放在同一个文件夹中。PHP 脚本可以读取但不能写入。

我在这里很绝望，我不知道从哪里开始解决问题，所以任何帮助我走上正确道路的帮助都将不胜感激。

编辑：我可以从命令行打开文件进行编辑；是apache无法访问

EDIT2：文件夹层次结构 /var/www/cgi-bin/script
权限是这样的
**/var root 755
www root 755
cgi-bin root 755
script apache 755**

编辑：**问题出在 selinux 中。我禁用了它，脚本可以访问该文件感谢每个人的贡献**

提前致谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-05T10:45:26.873

apache 是否使用一些 selinux 配置文件或类似的配置文件运行，从而阻止它在该目录中写入？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T10:12:56.953

用户 apache 可能没有对父目录之一的权限。它至少需要在所有目录中具有执行权限，包括包含您的文件的目录。

编辑：是的，考虑到这是一个编程站点，一些代码可能是有序的。

1.  使用文件的绝对路径进行测试，而不是使用相对路径来确保您位于正确的目录中。

2.  美元！如果是权限，应该打印出“权限被拒绝”错误，你能打印出问题吗：

    打开（文件，">/path/to/file/config.ini"）|| die "无法打开：$!"; ...关闭（文件）；

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T10:08:31.953

也许其他一些进程对文件有写锁？尝试**lsof**看看是谁在打开它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-05T10:13:48.667

该目录是否允许网络服务器在其中写入文件？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T21:02:05.537

我知道之前的一篇文章谈到了这一点，但我认为值得重复：在讨论这种性质的问题时，包含相关代码和异常的输出是有帮助的。如果 I/O 操作失败，$! 应该包含系统错误消息，这将解释操作失败的原因。说“它没有用”并没有真正给我们任何继续下去的机会。

# .net - 可以压缩 ClickOnce 部署的应用程序设置吗？

> ID：515254
> 
> 赞同：6
> 
> 时间：2009-02-05T10:08:58.367
> 
> 标签：.net, iis, deployment, compression, clickonce

我使用 ClickOnce 发布 Windows 窗体应用程序。考虑到这个应用程序的整体大小，安装是相当大的。它超过 15 MB。如果我压缩本地构建的应用程序，它会被压缩到 2.5 MB。

可以以某种方式压缩 ClickOnce 部署吗？

如果没有，是否有人使用 IIS 压缩来加快传输速度？那会有帮助吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-05T14:45:21.570

据我所知，您无法真正手动压缩程序集。但是，您*绝对*可以使用 IIS 压缩。从我对带宽监视器的测试来看，它有很大的不同。一旦设置好，您就不必考虑它，它会自动发生。

我很惊讶这不是经常被谈论的。几年前当我想这样做时，我几乎找不到关于它的信息。但是，如果您正在运行 IIS 6.0，[本文](http://geekswithblogs.net/juang/archive/2005/11/30/61660.aspx)应该详细说明您需要进行的所有更改。我不确定这些指令对于更高版本的 IIS 会有多大不同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-02-23T06:59:53.137

ClickOnce 没有任何内置的压缩​​支持。但是您可以在 Web 服务器级别使用 HTTP 压缩。

按照以下步骤在**IIS7**下启用压缩：

%windir%\system32\inetsrv\config\applicationHost.config （见我的评论，其他行是默认的）

```
<httpCompression directory="%SystemDrive%\inetpub\temp\IIS Temporary Compressed Files">
    <scheme name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll" />
    <dynamicTypes>
        <add mimeType="text/*" enabled="true" />
        <add mimeType="message/*" enabled="true" />
        <add mimeType="application/x-javascript" enabled="true" />
        <add mimeType="*/*" enabled="false" />
    </dynamicTypes>
    <staticTypes>
        <add mimeType="text/*" enabled="true" />
        <add mimeType="message/*" enabled="true" />
        <add mimeType="application/x-javascript" enabled="true" />
        <add mimeType="application/atom+xml" enabled="true" />
        <add mimeType="application/xaml+xml" enabled="true" />
        <!--HERE! deploy files-->
        <add mimeType="application/octet-stream" enabled="true" />
        <!--HERE! application files-->
        <add mimeType="application/x-ms-application" enabled="true" />
        <!--HERE! manifest files-->
        <add mimeType="application/x-ms-manifest" enabled="true" />
        <add mimeType="*/*" enabled="false" />
    </staticTypes>
</httpCompression> 
```

还是行不通？？将此添加到同一个文件中（默认情况下，IIS 7.0 不会压缩文件，除非它们是“经常请求的”）

```
<serverRuntime frequentHitTimePeriod="00:00:59" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-30T07:32:39.213

这些说明与更高版本的 IIS 相同。这种压缩工作非常快（它在后台完成，只有一次，直到文件被更改）

# c# - XPath 版本搜索

> ID：515256
> 
> 赞同：3
> 
> 时间：2009-02-05T10:09:54.590
> 
> 标签：c#, .net, xml, xpath

如何从以下文档中找到具有最大版本的节点：

```
<GateKeeperFiles>
  <File>
    <Name>GateKeeper.exe</Name>
    <Major>2</Major>
    <Minor>1</Minor>
    <Build>1</Build>
    <Revision>6</Revision>
  </File>
  <File>
    <Name>GateKeeper.exe</Name>
    <Major>1</Major>
    <Minor>1</Minor>
    <Build>1</Build>
    <Revision>9</Revision>
  </File>
</GateKeeperFiles> 
```

理想情况下，这将通过单个 XPath 函数来实现。我目前有两个功能可以让我获得最大的主要价值，但我似乎无法从那里取得进展。

```
/GateKeeperFiles/File[not (Major <= preceding-sibling::File/Major) and not(Major <= following-sibling::File/Major)] 
```

或者

```
/GateKeeperFiles/File[not(/GateKeeperFiles/File/Major > Major)] 
```

干杯，史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T10:18:56.287

如果您使用的是 C#，它必须是 xpath 吗？例如（编辑以支持具有相同版本的多个文件 - 帖子提到复数）：

```
 XDocument doc = XDocument.Parse(xml);
        var nodes =
            from file in doc.Document
                .Element("GateKeeperFiles")
                .Elements("File")
            select new {
                   Node = file,
                   Version = new Version(
                     (int) file.Element("Major"),
                     (int) file.Element("Minor"),
                     (int) file.Element("Build"),
                     (int) file.Element("Revision"))
                   } into tmp
                orderby tmp.Version descending
                select tmp;

        var mostRecentVersion = nodes.Select(x => x.Version).FirstOrDefault();
        var files = nodes.TakeWhile(x => x.Version == mostRecentVersion);

        foreach(var file in files) {
            Console.WriteLine("{0}: {1}",
                file.Version,
                (string)file.Node.Element("Name"));
        } 
```

* * *

或使用 2.0（来自 OP 评论）：

```
 static int GetVersion(XmlNode element, string xpath) {
        return int.Parse(element.SelectSingleNode(xpath).InnerText);
    }
    static void Main() {
        XmlDocument doc = new XmlDocument();
        doc.LoadXml(xml);

        Version bestVersion = null;
        List<XmlElement> files = new List<XmlElement>();
        foreach (XmlElement file in doc.SelectNodes(
                 "/GateKeeperFiles/File")) {
            Version version = new Version(
                GetVersion(file, "Major"), GetVersion(file, "Minor"),
                GetVersion(file, "Build"), GetVersion(file, "Revision"));
            if (bestVersion == null || version > bestVersion) {
                bestVersion = version;
                files.Clear();
                files.Add(file);
            } else if (version == bestVersion) {
                files.Add(file);
            }
        }
        Console.WriteLine("Version: " + bestVersion);
        foreach (XmlElement file in files) {
            Console.WriteLine(file.SelectSingleNode("Name").InnerText);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T10:26:25.943

我已经使用 xsl:sort 来实现类似的东西。不记得确切的语法，但试试这个

在此之后选择第一个或最后一个元素。我忘记了升序或降序排序的默认行为是什么，但您可以使用 xsl:sort 覆盖它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T10:41:44.713

该代码应该能够在 .Net 2.0 上运行，因此 LINQ 解决方案虽然正确但不适合 scinario。

我正在处理代码中的 XML 并且不执行转换，因此 XSLT 也不适合。

干杯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T12:30:27.817

我有一个与您的 .Net 2.0 类似的解决方案，我只是希望有一个干净整洁的 XPath 版本。看起来这是 XPath 没有答案的另一个领域（如位运算符）。

干杯

# elisp - 在 Emacs 中将行号设置为变量

> ID：515259
> 
> 赞同：9
> 
> 时间：2009-02-05T10:11:44.147
> 
> 标签：elisp

我正在尝试将当前行号设置为 Elisp 中的变量，但不断收到 void-variable 错误！

代码是：

(setq x what-line)

我还想将缓冲区中的总行数设置为一个变量，但得到同样的错误？！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-05T11:34:38.177

```
(setq x (line-number-at-pos)
      y (line-number-at-pos (point-max))) 
```

如何了解这种情况？尝试`M-x` `find-function` `RET` `what-line` `RET`查看源代码`what-line`。阅读`simple.el`（其中`what-line`定义的文件）是熟悉基本 Elisp 编程的好方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T10:18:38.410

```
(setq x (what-line)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-08T18:24:15.233

上一个答案中提到的 line-number-at-pos 函数仅考虑缓冲区的可访问部分。如果缓冲区“变窄”，它不会计算隐藏线，所以这可能会相当混乱。

如果您阅读 what-line 函数的代码，您可以看到它如何处理缩小的缓冲区（实际上 what-line 通过调用 line-number-at-pos 起作用）。

# asp.net - AJAX.NET 请求处理程序 - 设置隐藏字段

> ID：515260
> 
> 赞同：2
> 
> 时间：2009-02-05T10:12:01.167
> 
> 标签：asp.net, ajax

我正在尝试在 AJAX 初始化请求处理程序中设置隐藏字段控件的值。但是，在服务器上，隐藏字段控件始终包含上一个回发的值。我假设在初始化请求处理程序中设置隐藏字段之前正在准备/发送视图状态。有没有办法设置隐藏字段，以便将新值传递给服务器，或者通过另一种机制将值传递给服务器。

这是我正在使用的代码：

```
var prm = Sys.WebForms.PageRequestManager.getInstance();
prm.add_initializeRequest(MyPage_initializeRequestHandler);

function MyPage_initializeRequestHandler(sender, args)
{
    var hiddenField1= $get('hiddenField1');

    if (hiddenField1 != null)
    {
        hiddenField1.value = 'test';
    }
} 
```

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T15:01:51.393

你在使用更新面板吗？

如果是，则需要确保隐藏字段位于正在刷新的更新面板内，否则新值将不会发送到浏览器。

此外，您如何创建隐藏字段，如果它是更新面板回发的一部分，您应该使用 ScriptManager.RegisterHiddenField。

HTH

# c# - C#中的工厂模式：如何确保对象实例只能由工厂类创建？

> ID：515269
> 
> 赞同：97
> 
> 时间：2009-02-05T10:13:39.590
> 
> 标签：c#, design-patterns, oop, factory

最近我一直在考虑保护我的一些代码。我很好奇如何确保永远不能直接创建对象，而只能通过工厂类的某种方法。假设我有一些“业务对象”类，我想确保此类的任何实例都具有有效的内部状态。为了实现这一点，我需要在创建对象之前执行一些检查，可能在其构造函数中。在我决定让这个检查成为业务逻辑的一部分之前，这一切都很好。那么，我怎样才能安排一个业务对象只能通过我的业务逻辑类中的某些方法而不是直接创建呢？使用 C++ 的好老“朋友”关键字的第一个自然愿望将在 C# 中失败。所以我们需要其他选择...

让我们尝试一些例子：

```
public MyBusinessObjectClass
{
    public string MyProperty { get; private set; }

    public MyBusinessObjectClass (string myProperty)
    {
        MyProperty = myProperty;
    }
}

public MyBusinessLogicClass
{
    public MyBusinessObjectClass CreateBusinessObject (string myProperty)
    {
        // Perform some check on myProperty

        if (true /* check is okay */)
            return new MyBusinessObjectClass (myProperty);

        return null;
    }
} 
```

没关系，直到您记得您仍然可以直接创建 MyBusinessObjectClass 实例，而无需检查输入。我想完全排除这种技术可能性。

那么，社区对此有何看法？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-02-05T10:18:28.253

您可以将构造函数设为私有，并将工厂设为嵌套类型：

```
public class BusinessObject
{
    private BusinessObject(string property)
    {
    }

    public class Factory
    {
        public static BusinessObject CreateBusinessObject(string property)
        {
            return new BusinessObject(property);
        }
    }
} 
```

这是因为嵌套类型可以访问其封闭类型的私有成员。我知道这有点限制，但希望它会有所帮助......

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-02-05T14:06:02.397

看起来您只是想在创建对象之前运行一些业务逻辑 - 那么为什么不在“BusinessClass”中创建一个静态方法来完成所有肮脏的“myProperty”检查工作，并使构造函数私有？

```
public BusinessClass
{
    public string MyProperty { get; private set; }

    private BusinessClass()
    {
    }

    private BusinessClass(string myProperty)
    {
        MyProperty = myProperty;
    }

    public static BusinessClass CreateObject(string myProperty)
    {
        // Perform some check on myProperty

        if (/* all ok */)
            return new BusinessClass(myProperty);

        return null;
    }
} 
```

调用它会非常简单：

```
BusinessClass objBusiness = BusinessClass.CreateObject(someProperty); 
```

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2009-02-05T10:37:52.550

或者，如果你想要真正花哨，反转控制：让类返回工厂，并使用可以创建类的委托来检测工厂。

```
public class BusinessObject
{
  public static BusinessObjectFactory GetFactory()
  {
    return new BusinessObjectFactory (p => new BusinessObject (p));
  }

  private BusinessObject(string property)
  {
  }
}

public class BusinessObjectFactory
{
  private Func<string, BusinessObject> _ctorCaller;

  public BusinessObjectFactory (Func<string, BusinessObject> ctorCaller)
  {
    _ctorCaller = ctorCaller;
  }

  public BusinessObject CreateBusinessObject(string myProperty)
  {
    if (...)
      return _ctorCaller (myProperty);
    else
      return null;
  }
} 
```

:)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-02-05T10:17:19.783

您可以在 MyBusinessObjectClass 类内部创建构造函数，并将其和工厂移动到它们自己的程序集中。现在只有工厂应该能够构造类的实例。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-05T10:29:57.107

除了 Jon 的建议之外，您还可以首先让工厂方法（包括检查）成为 BusinessObject 的静态方法。然后，将构造函数设为私有，其他人将被迫使用静态方法。

```
public class BusinessObject
{
  public static Create (string myProperty)
  {
    if (...)
      return new BusinessObject (myProperty);
    else
      return null;
  }
} 
```

但真正的问题是——你为什么有这个要求？将工厂或工厂方法移动到类中是否可以接受？

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-05-19T05:15:03.307

经过这么多年，有人问这个问题，不幸的是，我看到的所有答案都在告诉您应该如何编写代码，而不是给出直接的答案。您正在寻找的实际答案是让您的类具有私有构造函数但公共实例化器，这意味着您只能从其他现有实例创建新实例......仅在工厂中可用：

您的课程的界面：

```
public interface FactoryObject
{
    FactoryObject Instantiate();
} 
```

你的班：

```
public class YourClass : FactoryObject
{
    static YourClass()
    {
        Factory.RegisterType(new YourClass());
    }

    private YourClass() {}

    FactoryObject FactoryObject.Instantiate()
    {
        return new YourClass();
    }
} 
```

最后，工厂：

```
public static class Factory
{
    private static List<FactoryObject> knownObjects = new List<FactoryObject>();

    public static void RegisterType(FactoryObject obj)
    {
        knownObjects.Add(obj);
    }

    public static T Instantiate<T>() where T : FactoryObject
    {
        var knownObject = knownObjects.Where(x => x.GetType() == typeof(T));
        return (T)knownObject.Instantiate();
    }
} 
```

然后，如果您需要额外的实例化参数或预处理您创建的实例，您可以轻松修改此代码。并且此代码将允许您通过工厂强制实例化，因为类构造函数是私有的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-05T10:31:47.977

另一个（轻量级）选项是在 BusinessObject 类中创建静态工厂方法并保持构造函数私有。

```
public class BusinessObject
{
    public static BusinessObject NewBusinessObject(string property)
    {
        return new BusinessObject();
    }

    private BusinessObject()
    {
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-05T11:10:41.690

所以，看起来我想要的东西不能以“纯粹”的方式完成。它总是对逻辑类进行某种“回调”。

也许我可以用一种简单的方法来做，只需在对象类中创建一个构造方法，首先调用逻辑类来检查输入？

```
public MyBusinessObjectClass
{
    public string MyProperty { get; private set; }

    private MyBusinessObjectClass (string myProperty)
    {
        MyProperty  = myProperty;
    }

    pubilc static MyBusinessObjectClass CreateInstance (string myProperty)
    {
        if (MyBusinessLogicClass.ValidateBusinessObject (myProperty)) return new MyBusinessObjectClass (myProperty);

        return null;
    }
}

public MyBusinessLogicClass
{
    public static bool ValidateBusinessObject (string myProperty)
    {
        // Perform some check on myProperty

        return CheckResult;
    }
} 
```

这样，业务对象就不能直接创建，业务逻辑中的公共检查方法也不会造成伤害。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-11-08T09:41:42.390

在接口和实现之间良好分离的情况下，
protected-constructor-public-initializer 模式提供了一个非常简洁的解决方案。

给定一个业务对象：

```
public interface IBusinessObject { }

class BusinessObject : IBusinessObject
{
    public static IBusinessObject New() 
    {
        return new BusinessObject();
    }

    protected BusinessObject() 
    { ... }
} 
```

和商业工厂：

```
public interface IBusinessFactory { }

class BusinessFactory : IBusinessFactory
{
    public static IBusinessFactory New() 
    {
        return new BusinessFactory();
    }

    protected BusinessFactory() 
    { ... }
} 
```

以下对`BusinessObject.New()`初始化程序的更改提供了解决方案：

```
class BusinessObject : IBusinessObject
{
    public static IBusinessObject New(BusinessFactory factory) 
    { ... }

    ...
} 
```

这里需要引用具体的业务工厂来调用`BusinessObject.New()`初始化程序。但唯一有必要参考的是商业工厂本身。

我们得到了我们想要的：唯一可以创造`BusinessObject`的是`BusinessFactory`.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-04-23T00:32:35.267

```
 public class HandlerFactory: Handler
    {
        public IHandler GetHandler()
        {
            return base.CreateMe();
        }
    }

    public interface IHandler
    {
        void DoWork();
    }

    public class Handler : IHandler
    {
        public void DoWork()
        {
            Console.WriteLine("hander doing work");
        }

        protected IHandler CreateMe()
        {
            return new Handler();
        }

        protected Handler(){}
    }

    public static void Main(string[] args)
    {
        // Handler handler = new Handler();         - this will error out!
        var factory = new HandlerFactory();
        var handler = factory.GetHandler();

        handler.DoWork();           // this works!
    } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-05T13:08:46.567

我将工厂放在与域类相同的程序集中，并将域类的构造函数标记为内部。这样，您域中的任何类都可以创建实例，但您相信自己不会这样做，对吧？任何在领域层之外编写代码的人都必须使用您的工厂。

```
public class Person
{
  internal Person()
  {
  }
}

public class PersonFactory
{
  public Person Create()
  {
    return new Person();
  }  
} 
```

但是，我必须质疑您的方法:-)

我认为，如果您希望您的 Person 类在创建时有效，您必须将代码放入构造函数中。

```
public class Person
{
  public Person(string firstName, string lastName)
  {
    FirstName = firstName;
    LastName = lastName;
    Validate();
  }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-05-04T07:43:05.810

该解决方案基于在构造函数中使用令牌的[丰富想法。](https://stackoverflow.com/users/9457/munificent)在这个答案中完成[确保对象仅由工厂创建（C#）](https://stackoverflow.com/questions/3671331/make-sure-object-only-created-by-factory-c#)

```
 public class BusinessObject
    {
        public BusinessObject(object instantiator)
        {
            if (instantiator.GetType() != typeof(Factory))
                throw new ArgumentException("Instantiator class must be Factory");
        }

    }

    public class Factory
    {
        public BusinessObject CreateBusinessObject()
        {
            return new BusinessObject(this);
        }
    } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-04-22T02:32:51.577

已经提到了具有不同权衡的多种方法。

*   将工厂类嵌套在私有构造的类中只允许工厂构造1个类。那时，您最好使用`Create`方法和私有 ctor。
*   使用继承和受保护的 ctor 有同样的问题。

我想将工厂提议为一个部分类，其中包含带有公共构造函数的私有嵌套类。您将 100% 隐藏您的工厂正在构建的对象，并且仅通过一个或多个接口公开您选择的对象。

我听到的用例是当您想要跟踪工厂中 100% 的实例时。这种设计保证除了工厂之外没有人可以创建“工厂”中定义的“化学品”实例，并且不需要单独的组件来实现这一点。

```
== ChemicalFactory.cs ==
partial class ChemicalFactory {
    private  ChemicalFactory() {}

    public interface IChemical {
        int AtomicNumber { get; }
    }

    public static IChemical CreateOxygen() {
        return new Oxygen();
    }
}

== Oxygen.cs ==
partial class ChemicalFactory {
    private class Oxygen : IChemical {
        public Oxygen() {
            AtomicNumber = 8;
        }
        public int AtomicNumber { get; }
    }
}

== Program.cs ==
class Program {
    static void Main(string[] args) {
        var ox = ChemicalFactory.CreateOxygen();
        Console.WriteLine(ox.AtomicNumber);
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-05T12:22:50.500

我不明白您为什么要将“业务逻辑”与“业务对象”分开。这听起来像是对对象方向的扭曲，而你最终会因为采用这种方法而陷入困境。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-12-11T07:59:37.077

我认为没有比问题更糟糕的解决方案，他上面的所有内容都需要一个公共静态工厂，恕我直言这是一个更糟糕的问题，并且不会阻止人们只是调用工厂来使用你的对象 - 它不会隐藏任何东西。如果可以的话，最好公开一个接口和/或将构造函数保持在内部，这是最好的保护，因为程序集是受信任的代码。

一种选择是拥有一个静态构造函数，该构造函数在某处使用 IOC 容器之类的东西注册工厂。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-07-09T09:02:04.843

这是“仅仅因为你可以并不意味着你应该”的另一种解决方案......

它确实满足了保持业务对象构造函数私有并将工厂逻辑放在另一个类中的要求。之后它变得有点粗略。

工厂类有一个用于创建业务对象的静态方法。它派生自业务对象类，以便访问调用私有构造函数的静态受保护构造方法。

工厂是抽象的，因此您实际上无法创建它的实例（因为它也是一个业务对象，所以这很奇怪），并且它有一个私有构造函数，因此客户端代码不能从中派生。

没有阻止的是客户端代码*也*源自业务对象类并调用受保护（但未验证）的静态构造方法。或者更糟糕的是，调用我们必须添加的受保护的默认构造函数以首先编译工厂类。（顺便说一句，这很可能是任何将工厂类与业务对象类分开的模式的问题。）

我并不是要建议任何头脑正常的人都应该做这样的事情，但这是一个有趣的练习。FWIW，我首选的解决方案是使用内部构造函数和程序集边界作为保护。

```
using System;

public class MyBusinessObjectClass
{
    public string MyProperty { get; private set; }

    private MyBusinessObjectClass(string myProperty)
    {
        MyProperty = myProperty;
    }

    // Need accesible default constructor, or else MyBusinessObjectFactory declaration will generate:
    // error CS0122: 'MyBusinessObjectClass.MyBusinessObjectClass(string)' is inaccessible due to its protection level
    protected MyBusinessObjectClass()
    {
    }

    protected static MyBusinessObjectClass Construct(string myProperty)
    {
        return new MyBusinessObjectClass(myProperty);
    }
}

public abstract class MyBusinessObjectFactory : MyBusinessObjectClass
{
    public static MyBusinessObjectClass CreateBusinessObject(string myProperty)
    {
        // Perform some check on myProperty

        if (true /* check is okay */)
            return Construct(myProperty);

        return null;
    }

    private MyBusinessObjectFactory()
    {
    }
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-10-23T13:50:29.520

希望听到有关此解决方案的一些想法。唯一能够创建“MyClassPrivilegeKey”的是工厂。并且“MyClass”在构造函数中需要它。从而避免对私人承包商/工厂“注册”的反思。

```
public static class Runnable
{
    public static void Run()
    {
        MyClass myClass = MyClassPrivilegeKey.MyClassFactory.GetInstance();
    }
}

public abstract class MyClass
{
    public MyClass(MyClassPrivilegeKey key) { }
}

public class MyClassA : MyClass
{
    public MyClassA(MyClassPrivilegeKey key) : base(key) { }
}

public class MyClassB : MyClass
{
    public MyClassB(MyClassPrivilegeKey key) : base(key) { }
}

public class MyClassPrivilegeKey
{
    private MyClassPrivilegeKey()
    {
    }

    public static class MyClassFactory
    {
        private static MyClassPrivilegeKey key = new MyClassPrivilegeKey();

        public static MyClass GetInstance()
        {
            if (/* some things == */true)
            {
                return new MyClassA(key);
            }
            else
            {
                return new MyClassB(key);
            }
        }
    }
} 
```

# reporting-services - 报告服务：每行的总数和百分比

> ID：515273
> 
> 赞同：3
> 
> 时间：2009-02-05T10:13:54.987
> 
> 标签：reporting-services

我希望结果看起来像这样（从 Excel 中的解决方案转换为报告服务）：

```
Campaigns      Success      Not Success      Total      Success %     Not sucess %
Campaign 1     1            4                5          20%           80%
Campaign 2     4            4                8          50%           50% 
```

我如何完成这项任务？我可以添加`Total`列，没有任何问题 - 但我不知道如何添加`Success %`和`Not success %`列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T10:38:23.550

我认为要添加新列，您只需要右键单击并添加一个新列吗？

对于`"=Details"`Success % 列的字段，右键单击并选择“表达式”以进入表达式编辑器。然后输入以下表达式

```
=(Fields!Success.Value/Fields!Total.Value) * 100 
```

对于 Not success 列做类似的事情，除了你的表达式是

```
=(Fields!NotSuccess.Value/Fields!Total.Value) * 100 
```

（显然，实际数据库字段的名称在您的情况下可能会有所不同）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T12:25:16.360

To add to Calanus's answer, you can format the cell to show a percent via its Right-Click Properties or by using the FORMAT function.

```
=FORMAT((Fields!Success.Value/Fields!Total.Value), "P")
=FORMAT((Fields!NotSuccess.Value/Fields!Total.Vlaue), "P") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-24T16:18:53.433

如果您使用的是矩阵，那么您可以使用该组除以列或行，即

```
=round((Fields!count.Value/sum(Fields!count.Value,"matrix1_RowGroup1") * 100,2) & " %" 
```

字段计数将是任何给定类别的总数

记录集示例

```
CAMPAIGN COUNT TYPE
Campaing1 1 Success
Campaing1 4 Not Success
Campaing2 4 Success
Campaing2 4 Not Success 
```

# php - 有没有办法从 XML 文件中检索评论？

> ID：515275
> 
> 赞同：2
> 
> 时间：2009-02-05T10:14:51.303
> 
> 标签：php, xml, simplexml

有没有办法从 XML 文件中检索评论？

我有一个 XML 文件，其中包含注释，我必须基于此文件中的每个节点以及相关的注释构建一个用户界面。

我似乎无法找到获得这些评论的方法。我能够使用simpleXML获得其中的“一些”，但它不适用于根节点，并且表现得很奇怪......一些评论被放在他们自己的节点中，其他一些被留下作为孩子，所有评论被放在同一个节点中......不确定这是否有意义:) 关键是 simpleXML 破坏了评论的结构，这对我的需求不利。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T16:14:00.547

您可以使用 XMLReader 读取所有节点并提取注释。我已经包含了一些示例代码来帮助您入门，因为它只是拉出节点，并且没有考虑注释*在*内部、任何 xml 节点之下或之上的位置。

```
$comments = '';
$xml =<<<EOX
<xml>
    <!--data here -->
    <data>
        <!-- more here -->
        <more />
    </data>
</xml>
EOX;

$reader = new XMLReader();
$reader->XML($xml);

while ($reader->read()) {
  if ($reader->nodeType == XMLReader::COMMENT) {
      $comments .= "\n".$reader->value;
  }
}

$reader->close();

echo "all comments below:\n-------------------".$comments 
```

预期的输出是：

```
all comments below:
-------------------
 data here
 more here 
```

因此，将仅采用注释的值（而不是`<!-- -->`）以及空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T10:48:43.170

simpleXml 非常适合快速抓取某些东西，但它有局限性。请改用 DOM 解析器。或者在这种情况下，可能是基于事件的（SAX 或 XmlReader）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T18:54:00.240

如果您使用 XPath，这很简单。该`comment()`函数匹配注释。所以图案

```
//comment() 
```

查找文档中的所有注释。

在 XSLT 中，对于注释位于要转换的元素之前的一般模式，例如：

```
<!-- This is the comment -->
<element>... 
```

你会使用这样的模板：

```
<xsl:template match="*[.::preceding-sibling()/comment()]">
   <xsl:variable name="comment" select=".::preceding-sibling()/comment()"/>
   <!-- xsl:value-of $comment will now give you the text of the comment -->
   ... 
```

# java - 以编程方式插入行（父和子）

> ID：515278
> 
> 赞同：4
> 
> 时间：2009-02-05T10:15:22.877
> 
> 标签：java, sql, oracle, spring

我正在使用 Spring 和 JDBCTemplate。

该场景是一个 CUSTOMER 表和 ORDERS 表 - 父子关系。

我想做一个插入（例如 1 个客户和 5 个订单） - 但我不确定您如何以编程方式在 CUSTOMER 表中插入一行（一些如何获取 Oracle 生成的唯一 ID），然后插入相应的 5 行在子表 ORDERS 中，具有由客户插入创建的唯一 ID。这个唯一的 id 显然维护了客户和他们的订单之间的关系。

非常感谢任何帮助。

PS - 带有示例 SQL 的代码说明如何在 Spring Framework 中完成这将是非常棒的 - 一些相当粗糙的东西只是为了给我基本的想法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T10:36:42.490

检查JDBCTemplate 中采用 KeyHolder 对象的[更新方法。](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/jdbc/core/JdbcTemplate.html#update%28org.springframework.jdbc.core.PreparedStatementCreator,%20org.springframework.jdbc.support.KeyHolder%29)执行后 Keyholder 对象包含生成的密钥。

[Spring 文档在此处](http://static.springsource.org/spring/docs/2.0.8/reference/jdbc.html#jdbc-updates)提供了一个使用示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T10:26:02.637

```
DECLARE
  newid INTEGER;
BEGIN

  INSERT
    INTO customer (name)
  VALUES ('John Doe')
  RETURNING id
  INTO newid;

  INSERT
    INTO orders (customer, order)
  VALUES (newid, 'Order1');

  INSERT
    INTO orders (customer, order)
  VALUES (newid, 'Order2');

  INSERT
    INTO orders (customer, order)
  VALUES (newid, 'Order3');

END; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T17:15:45.057

我对 JDBC 或 Spring 一无所知，但 Quassnoi 为您提供了一种 Oracle 方式。

但是，如果您的框架不知道如何使用 RETURNING 子句……您可以使用序列的 currval 属性。

SEQUENCE.Currval 是一个会话本地“变量”，它包含会话从序列中获得的最后一个值。

```
BEGIN

  INSERT
    INTO customer (ID, name)
  VALUES (cust_seq.nextval, 'John Doe');

  INSERT
    INTO orders (customer, order)
  VALUES (cust_seq.currval, 'Order1');

  INSERT
    INTO orders (customer, order)
  VALUES (cust_seq.currval, 'Order2');

  INSERT
    INTO orders (customer, order)
  VALUES (cust_seq.currval, 'Order3');

END; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T21:02:43.790

另一种方法是使用序列来生成 ID ：

SELECT seq.nextval FROM DUAL -> 进入变量

然后将此编号用作您的唯一 ID，而不是让数据库自动创建它。

与上面的建议类似，除了如果有人在您插入所有订单之前插入了另一个客户，那么您最终会在错误的客户下获得这些订单。

# .net - NHibernate 的 SimpleDB 方言

> ID：515279
> 
> 赞同：3
> 
> 时间：2009-02-05T10:16:15.013
> 
> 标签：.net, nhibernate, amazon, amazon-simpledb

您知道是否可以将 Amazon SimpleDB 与 NHibernate 结合使用？[LightSpeed 似乎是兼容](http://www.mindscape.co.nz/blog/index.php/2009/01/13/object-relational-mapping-over-amazon-simpledb-using-lightspeed/)的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T11:32:09.820

NHibernate 更面向传统的 SQL 数据库，所以没有。但是您可能想改用[Linq To SimpleDB 。](http://www.codeplex.com/LinqToSimpleDB)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-13T15:06:26.383

您可能想查看[Simple Savant](http://simplesavant.codeplex.com/)，这是一个专为 SimpleDB 设计的开源 .NET 持久性库（我是创建者）。SimpleDB 与关系数据库如此不同，以至于很难与 NHibernate 一起使用。但是 Simple Savant 会给你很多类似的功能。

# php - 您如何将网站部署到您的网络服务器？

> ID：515280
> 
> 赞同：14
> 
> 时间：2009-02-05T10:16:33.373
> 
> 标签：php, svn, deployment, webserver

在我的公司，我们的商业网站有 8 名 Web 开发人员（完全用 PHP 编写，但这无关紧要）。小组中的每个人都在同时从事不同的项目，每当他们完成任务时，他们就会立即部署它（因为这些天业务发展迅速）。

目前，开发发生在一个共享服务器上，所有开发人员都在同一个代码库上工作（使用 RCS 将文件“锁定”远离其他人）。当部署到期时，更改的文件被复制到“暂存”服务器，然后同步脚本将文件上传到我们的主网络服务器，从那里它被分发到其他 9 个服务器。

非常高兴的是，Web 开发团队向我们寻求帮助以改进流程（在我们抱怨了一段时间之后），现在我们设置他们的开发环境的想法如下：

*   具有虚拟目录的开发服务器，因此每个人都有自己的代码库，
*   SVN（或任何其他 VCS）跟踪更改
*   用于测试保存最新签入代码的中央服务器

现在的问题是：我们如何设法将更改的文件部署到服务器上，而不会意外上传其他项目的错误？我的第一个想法是简单地从存储库中导出最新版本，但这不会完全控制文件。

你如何处理这样的情况？你有什么样的部署脚本在行动？

（作为一项特殊挑战：该网站在过去 10 年中不断发展壮大，因此项目并没有被分成小块，而是一个特定功能的文件分布在整个目录树中。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-05T10:35:09.453

Cassy - 在您完全按顺序进行源代码管理之前，您显然还有很长的路要走，但听起来您正在路上！

拥有单独的沙箱肯定会有所帮助。接下来确保该网站始终只是对特定修订版、标签或 subversion 分支的干净签出。

我们使用 git，但我们有类似的设置。我们用版本号标记特定版本（在 git 中，我们还可以向标签添加描述；对发布说明很有用！）然后我们有一个脚本，任何有权“发布”的人都可以运行它需要两个参数——将要更新哪个系统（数据中心以及我们要更新测试服务器还是生产服务器），然后是版本号（标签）。

该脚本使用 sudo 然后在共享帐户中运行发布脚本。它会检查相关版本，最小化 javascript 和 CSS [1](http://www.yellowbot.com/)，将代码推送到环境的相关服务器，然后重新启动需要重新启动的内容。发布脚本的最后一行连接到其中一个网络服务器并跟踪错误日志。

在[我们的](http://www.yellowbot.com/) [网站上](http://www.weblocal.ca/)，我们在每个页面的底部都包含一个带有当前服务器名称和版本的 html 注释——便于查看“现在正在运行什么？”

[1](http://www.yellowbot.com/)和一堆其他类似的家政任务......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T10:37:00.493

如果它们对共享代码库进行了巨大更改，您应该考虑对单个项目（在同一代码库上）使用分支和合并。

我们通常有一个用于测试的本地开发环境（意思是本地网络服务器）来测试未提交的代码（你根本不想提交非功能代码），但该开发环境甚至可以使用共享文件夹在单独的服务器上。

但是，提交的代码应该在投入生产之前部署到登台服务器进行测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T10:35:58.687

您可能可以使用 Capistrano，尽管它更多地用于 ruby​​，有一些[文章](http://www.simplisticcomplexity.com/2006/08/16/automated-php-deployment-with-capistrano/)描述了如何将它用于 PHP

我认为 Phing 可以与 CVS 一起使用，但不能与 SVN 一起使用（至少我上次读到的）

还有一些模仿 Capistrano 但用 PHP 编写的项目。

否则还有一个定制的解决方案：

1.  您要部署的标记文件。
2.  使用特定目录中的标签签出文件
3.  将目录符号链接到当前文档根目录（容易回滚到以前的版本）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T13:53:07.570

自然地检查存储库的[SVN](http://subversion.tigris.org/) ，跟踪事物的[Trac](http://trac.edgewall.org/)和部署的[Apache Ant 。](http://ant.apache.org/)

基本过程是在 Subversion 中进行管理，在 Trac 中跟踪存储库和开发人员，并使用 Ant 部署脚本将您的站点推出所需的设置。Ant 允许您轻松地将项目部署到特定位置。（开发/测试/产品）等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T10:21:24.113

你需要看看：

*   持续集成
*   在签入代码时运行单元测试以检查它是否没有错误
*   如果代码包含错误，则可能会拒绝代码
*   每晚构建
*   仅发布最后一个没有错误的构建

您可能无法找到完美的解决方案，尤其是刚开始时不会，但是您使用所选解决方案的次数越多，每个人都会变得越自在，并且能够就改进它提出建议。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T10:23:29.303

我们每天晚上用[ant](http://ant.apache.org/)检查稳定性。并使用ant脚本进行部署。它非常易于配置和使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-05T11:14:22.820

我昨天对另一个问题给出了[类似的答案。](https://stackoverflow.com/questions/3667/what-is-your-favorite-web-app-deployment-workflow-with-svn/511240#511240)基本上你可以在分支机构工作并在上线之前进行整合。

您必须弄清楚的最重要的事情是您正在处理文件的**更改**，而不是单个文件。一旦有了分支，就没有真正的当前版本，只有具有不同更改的版本。

# filter - MDX：按度量的表值过滤成员集

> ID：515284
> 
> 赞同：4
> 
> 时间：2009-02-05T10:17:28.490
> 
> 标签：filter, mdx, pentaho

我在事实表中有一些数字，并生成了一个使用 SUM 聚合器来汇总数字的度量。但问题是我只想对高于 10 的数字求和。我尝试在度量定义中使用通用表达式，这当然有效，但问题是我需要能够动态设置该值，因为它并不总是 10，这意味着用户应该能够自己选择它。

更具体地说，我当前的 MDX 如下所示：

```
和
SET [Email measure] AS '{[Measures].[Number of Answered Cases],
[Measures].[Max Expedition Time First In Case], [Measures].[Avg Expedition Times First In Case],
[措施].[收到的电子邮件请求数]，[措施].[案例中的平均电子邮件数量]，
[Measures].[Avg Expedition Times Total],[Measures].[已回复的传入电子邮件数]}'

将 [组织] 设置为 '{[Organization.Id].[860]}'
SET [Operators] AS '{[Operator.Id].[3379],[Operator.Id].[3181]}'
将 [电子邮件帐户] 设置为 '{[电子邮件帐户.Id].[6]}'
成员 [Time.Date].[Date Period] AS 聚合（{[Time.Date].[2008].[11].[11] :[Time.Date].[2009].[1].[2] })
成员 [Email.Type].[Email Types] 作为聚合 ({[Email.Type].[0]})
SELECT {[Email measure]} ON 列，
[运算符] ON 行
来自 [Email_Fact]
WHERE（[时间.日期].[日期期间]）

```

现在，有问题的成员是计算出的成员 [Avg Expedition Times Total]。该成员采取两项措施；[Sum Expedition Times] 和 [Nr of Expedition Times] 并在另一个上拆分以获得平均值，所有这些目前都有效。但是，我希望 [Sum Expedition Times] 仅汇总我/用户希望的参数之上或之下的值。

如何过滤 [Sum Expedition Times] 迭代的数字，而不是过滤该度量最终给我的总和？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T06:49:47.673

您可以将成员移动到 MDX 查询中，而不是将其放入多维数据集中。然后你会得到类似的东西......

```
WITH
MEMBER [Avg Expedition Times Total] AS
SUM(
    FILTER([Your Dimension],
        [Measure you want to filter] > 10),
    [Measure you want to sum]) 
```

我不确定您要过滤和求和的确切维度和度量，但我认为这是朝着正确方向迈出的一步。如果您的用户无法修改 MDX（或不想！），那么创建多个度量也是一个非常可靠的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-30T18:27:34.897

您需要有一个具有此度量的不同值的维度（如果不同值的数量太高，那么可能是某种范围）。然后你把这个维度加入到事实中。连接应该很简单。Measure 列也将成为关键列。现在你只需要引用维度成员。

# java - Java Locking 有多贵？

> ID：515296
> 
> 赞同：1
> 
> 时间：2009-02-05T10:20:15.660
> 
> 标签：java, performance, locking

一般来说，Java 中的锁定成本有多高？

特别是在我的情况下：我有一个多线程应用程序，其中有一个主循环将对象从延迟队列中取出并处理它们（使用 poll()）。在某些时候，不同的线程将不得不从队列中删除错误的元素（使用 remove()）。

鉴于 remove() 相对不常见，我担心锁定每个 poll() 会导致代码变慢。我的担心有道理吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-05T10:23:33.813

除非您分析您的应用程序并发现这是一个瓶颈，否则它们是不合理的。

一般来说，在 Java 5 和 Java 6 中进行一些更改后，无竞争锁定（即大多数时间不必等待某人释放的锁）已经变得更便宜了。

如果速度足够快，可以安全简单地实施它并进行配置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T10:36:37.170

你有没有测量过，发现锁定太慢了？不？然后不是。

不过，老实说：太多人担心太多无关紧要的事情。在你担心“++i”是否比“i++”或类似的东西快之前让你的代码工作。

# c# - 如何在第三方 SDK 中对多个不相关的类型应用通用的扩展方法？

> ID：515305
> 
> 赞同：9
> 
> 时间：2009-02-05T10:23:40.740
> 
> 标签：c#, extension-methods

我开始爱上扩展方法，但我只是不知道如何仅为确定的 Object 类型创建 EM。

我有例如：

```
public static void AddPhoneNumberToContact(this Contact contact, PhoneType type, String number)
{
    lock (contact)
    {
        PhoneRow pr = PhoneRow.CreateNew();
        pr.SetDefaults();
        pr.PtypeIdx = type;
        pr.PhoneNumber = number;
        contact.Phones.Add(pr);
        pr = null;
    }
} 
```

我的问题是我想在 Person 对象中也有这个方法，这就是我命名的原因

```
AddPhoneNumberToContact
AddPhoneNumberToPerson 
```

有没有办法让 AddPhoneNumber 处理提供的对象？

或者解决方案是

```
public static void AddPhoneNumber(this object contact, ...
{
   ...

   if(typeof(Contact) == contact)
      ((Contact)contact).Phones.Add(pr);
   else if(typeof(Person) == contact)
      ((Person)contact).Phones.Add(pr);
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-05T10:31:20.537

写两个扩展方法怎么样：

```
public static void AddPhoneNumber(this Contact contact, PhoneType type); 
```

和

```
public static void AddPhoneNumber(this Person person, PhoneType type); 
```

对我来说看起来更干净。

如果两者之间有一些共同的代码，请将其提取到单独的方法中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-05T10:27:31.637

制作`Contact`并`Person`实现通用接口 - 比如说`IContactWithPhoneNumbers`- 然后为“这个接口”编写一个扩展方法。

```
public interface IContactWithPhoneNumbers {}
public class Contact : IContactWithPhoneNumbers {}
public class Person : IContactWithPhoneNumbers {}
public static void AddPhoneNumber(this IContactWithPhoneNumbers obj) {} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T10:37:32.600

阅读您的评论（对象来自 SDK，不可编辑）。我可能会做这样的事情：

```
public class Util
{
    //common util method
    public static void AddPhoneNumber(object obj, string phoneNumber)
    {
         if(obj is Contact)
             ((Contact)contact).Phones.Add(phoneNumber);
         else if(obj is Person)
             ((Person)contact).Phones.Add(phoneNumber);
    }

    //extension method for Person
    public static void AddPhoneNumber(this Person p, string phoneNumber)
    {
        AddPhoneNumber((object)p, phoneNumber);
    }

    //extension method for Contact
    public static void AddPhoneNumber(this Contact c, string phoneNumber)
    {
        AddPhoneNumber((object)c, phoneNumber);
    }
} 
```

我确实认为，当您控制底层对象时，最好的做法是实现一个通用接口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-02T16:44:13.823

您可以使您的扩展方法通用，例如：

```
public static void AddPhoneNumberToContact<T>(
    this T contact,
    PhoneType type,
    String number
)
{
    PhoneRow pr = PhoneRow.CreateNew();
    pr.SetDefaults();
    pr.PtypeIdx = type;
    pr.PhoneNumber = number;
    ((T)contact).Phones.Add(pr);
    pr = null;
} 
```

您将无法使用`lock`，因为“'T' 不是 lock 语句所需的引用类型”，因此您可能必须返回一些值。

如果它抱怨无法解析 T 类型的 Phones 方法，您可以：

传入一些[函数委托](http://msdn.microsoft.com/en-us/library/bb549151.aspx)，该委托将采用 T 类型，不返回任何内容，然后执行操作`((T)contact).Phones.Add(pr);`。

或者您可以创建如下界面：

```
public interface IPhoneable
{
    IList<Phone> Phones();
} 
```

然后，一旦有了该接口，就可以将以下内容添加到通用扩展方法中：

```
public static void AddPhoneNumberToContact<T>(
    this T contact,
    PhoneType type,
    String number
) where T : IPhoneable {...} 
```

在这里，`T`它仍然是一个泛型类型，但现在您的 AddPhoneNumberToContact 方法要求`T`它继承自您刚刚定义为具有 Phones() 方法的 IPhoneable 接口。

另请参阅[通用集合的 C# 扩展方法](http://metadeveloper.blogspot.com/2008/05/c-extension-method-for-generic.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-08T09:49:41.010

如果您无法更改 Person 和 Contact ，您可以创建它们的子类并让它们实现公共接口。

在扩展方法中，您将公共接口声明为参数：

```
using System;
using System.Collections.Generic;

public class Program
{
    public static void Main()
    {
        var p = new MyPerson();
        p.Name = "test";
        p.AddPhonenumber("555-2356");
        Console.WriteLine(string.Join(", ", p.Phonenumber));

        var c = new MyContact();
        c.Name = "contact";
        c.AddPhonenumber("222-235");
        Console.WriteLine(string.Join(", ", c.Phonenumber));
    }
}

public class Contact
{
    public Contact() {
        this.Phonenumber = new List<string>();
    }
    public string Name { get; set; }
    public List<string> Phonenumber { get; set; }
    public string Foo { get; set; }
}
public class Person
{
    public Person() {
        this.Phonenumber = new List<string>();
    }
    public string Name { get; set; }
    public List<string> Phonenumber { get; set; }
    public string Bar { get; set; }
}

public class MyContact: Contact, IType {
}

public class MyPerson: Person, IType {
}

public static class Extensions {
    public static void AddPhonenumber(this IType type, string number){
        type.Phonenumber.Add(number);
    }
}

public interface IType {
    string Name {get; set; }
    List<string> Phonenumber {get; set;}
} 
```

# delphi - Delphi 接口是否在子类中继承

> ID：515307
> 
> 赞同：4
> 
> 时间：2009-02-05T10:23:50.910
> 
> 标签：delphi, oop, delphi-2007

如果我在基类上实现一个接口，它将被它的子类继承，我知道函数/过程将是，但我更感兴趣的是我是否能够将子类转换为接口，然后再转换回它的接口原班。

我希望我能做的是将不同基类的对象传递给一个函数，然后在函数中确定类型并酌情使用它们。

这可能吗？这是正确的方法吗？

**更新**

为了帮助消除任何混乱（或创造更多），这是我想做的（精简到其核心）。

界面

```
 IMyInterFace = interface
   ['{B7203E50-F5CB-4755-9DB1-FB41B7B192C5}'] 
     function MyFunction: Boolean;
   end; 
```

基类

```
 type TMyObject = class(TInterfacedObject,IMyInterFace) 
```

子类

```
 type TSubMyObject = class(TMyObject) 
```

另一个班级

```
 type TMyOtherObject = class(TInterfacedObject,IMyInterFace) 
```

然后使用

```
 procedure foo();
   var obj:TSubMyObject;
 begin
      obj := TSubMyObject.Create();
      SendInterfaceObject(obj);
 end;

 procedure bar();
   var obj:TMyOtherObject;
 begin
      obj := TMyOtherObject.Create();
      SendInterfaceObject(obj);
 end;

 procedure SendInterfaceObject(iobj:IMyInterFace);
 begin
     if (iobj is TSubMyObject) then
     begin
        //code here
     end
     else if (iobj is TMyOtherObject) then
     begin
       //code here
     end;
 end; 
```

**更新 2**

我已经更新了代码，所以更好地展示我所追求的。

*//这里*的代码部分与传递给它的对象几乎没有关系，例如，如果这个类是 TAccounts 并且它被传递了一个 TEmployee 对象，它可能会在那里支付每周工资，但如果它是一个 TInvoice 那么它会检查看看是否需要付款，并且仅在截止日期前 2 天付款。

TEmployee/TInvoice 甚至可能来自要求付款的外部班级。

这只是一个例子。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-05T10:32:22.360

是的，接口是由子类继承的。

从子类转换到接口是完全可以接受的。

但是，如果我读错了你的问题，但如果“然后回到原来的班级”意味着 . . .

你有接口 I，A 类和 B 类。A 实现 I，B 继承 A，你可能可以，但真的不应该从 A 转换为 B。

**编辑：**

你想从 B 到 I 再回到 B 。. . 但是您已经有了对 B 的引用，如果 B 是您传递给函数的内容，那么您不需要从 I 转换为 B（除非正在谈论不同的对象，否则不，不要这样做）

从 I 到 B 与从 A 到 B 相同，您正在尝试构建继承链，这确实是您不应该做的事情。需要这样做是一种代码味道，它告诉您应该尝试以不同的方式解决此问题（可能通过重新设计您的类（例如向 I 添加更多属性/方法），或者只是决定该功能只能工作使用子类 - 使用子类“B”将使您能够访问 A 和 I 的所有方法）。

您可以编辑您的问题并添加一些您正在尝试做的示例代码吗？

**编辑 2**

```
 procedure SendInterfaceObject(iobj:IMyInterFace);
 begin
     if (iobj is TSubMyObject) then
     begin
        //code here
     end;
 end; 
```

那里的“If”语句是一个坏主意，并且违反了 OO 原则。如果你需要这样做，那么要么

*   接口定义不足，您可能希望向接口添加一个 Type 属性，允许您 (如果 iObj.SomeProperty = 1) then 。. .)
*   该接口根本不是解决此问题的正确方法，您应该将引用作为 TSubMyObject 传递。

**编辑 3：**

@mghie：我同意你的观点，我没有很好地解释的是 SomeProperty 有一些数据允许函数在那里分支，消除了类型检查的依赖性。SomeProperty 不应该“简单地”替换类型检查（例如，通过将类名放在属性中，然后检查类名）这确实是完全相同的问题。

继承接口的子类之间有一些本质的区别。这种差异应由以下任一方式表示

*   暴露一些可以在分支中使用的数据项

例如

```
if(item.Color = Red) then 
   item.ContrastColor := Blue;
else
   item.ContrastColor := Red; 
```

*   或通过多态性，例如

IEmployee 定义了CalculatePay 方法，TManager 和TWorker 实现了IEmployee，各自在CalculatePay 方法中具有不同的逻辑。

如果意图是做类似于第一种情况的事情，多态性*可能*是矫枉过正（多态性并不能解决所有问题）。

**编辑 4**

你说*“这里的 //code 部分与传递给它的对象几乎没有关系......”* 很抱歉，该声明不正确，如果您需要向员工付款，您需要知道他们的 1) EmployeeCode 2) 他们的工资详细信息 3) 他们的银行详细信息等，如果您要收取发票，则需要 1) InvoiceNumber 2）发票金额 3）客户代码收取等。. . **这是多态性的理想场所**。

假设使用接口的函数检查“帐户”是否需要对对象执行某些操作（例如，向员工付款、收取发票等）。所以我们可以调用函数 AccountsCheck。在 Accounts 检查中，您将有一个特定于每个子类的逻辑（支付员工，收取发票......）这是多态性的理想候选者。

在您的接口上（或在另一个接口上，或作为子类上的虚拟方法）定义一个“AccountsCheck”方法。然后每个派生类都有自己的 Accounts 检查实现。

代码从庞大的单个 AccountsCheck 函数中移出，并移到每个子类上的较小函数中。这使得代码

*   意图更明显（每个类都包含一些用于 AccountsCheck 的逻辑）
*   在 AccountsCheck for C 中修复某些内容时，您不太可能破坏 SubClass B 的逻辑
*   更容易弄清楚 SubClass B 的 AccountsCheck 逻辑是什么，您只需检查小型 AccountsCheck 中的 20 行代码，而不是 General AccountsCheck 中的 200 行）

这还有更多“充分的理由”，如果有人想编辑/发表评论，请这样做。

如果您发现需要在 AccountsCheck 的实现之间共享一些逻辑，请创建一些实用程序函数，不要在每个函数中重新实现相同的轮子。

多态性是您问题的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T21:33:05.943

我在这里的建议是不要对类进行强制转换，而是对另一个接口进行强制转换。将您的 TMyOtherObject 更改为：

```
type
  IOtherObjectIntf = interface
    ['{FD86EE29-ABCA-4D50-B32A-24A7E71486A7}']
  end;

type 
  TMyOtherObject = class(TInterfacedObject,IMyInterFace,IOtherObjectIntf) 
```

然后将您的其他例程更改为：

```
procedure SendInterfaceObject(iobj:IMyInterFace);
begin
  if Supports(iObj,IOtherObjectIntf) then
    begin
      //code here for TMyOtherObject
    end
  else 
    begin
      //code here for other standard implementations
    end;
end; 
```

这样，您的 TMyOtherObject 的“自定义”代码也将应用于任何 ITS 后代，而无需任何进一步的自定义代码。IOtherObjectIntf 接口仅用作“是的，我是其中之一”的指示器，它允许您的代码正确分支。当然，它浪费了另一个Guid......但是他们有这么多，谁会注意到？:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T12:19:34.343

接口由子类继承，您可以将对象转换为接口，但将接口转换为类是不安全的（或不推荐）。如果您需要这样做，您可能以错误的方式使用接口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T12:56:19.527

似乎对如何理解您的问题存在一些疑问，实际上，在您对[这个答案](https://stackoverflow.com/questions/515307/are-delphi-interfaces-inherited-in-subclasses/515333#515333)的评论中，您说您想“从 B 到 I 到 B”。

这确实是不推荐的，只能通过使用有关如何在类上实现接口的信息来支持。

如果我理解正确，那么您要做的是将接口传递给某个方法，并在该方法中根据实现接口的具体类执行不同的操作。但是，一旦您开始使用接口，最好继续使用它们。你**可以**让接口有一个方法来返回实现类，但是你不应该对接口在哪个类中实现做任何假设——它会让你失去一些针对接口编程的好处。

相反，您可以做的是创建不同的接口，并仅在（某些）后代类中实现其中的一些。然后您可以在传递的接口指针上使用*QueryInterface()*或*Supports() 。*对于您的基类，这将返回*nil*，但对于实现该接口的所有后代类，它将返回一个指针，该指针仅允许您调用它们拥有的方法。

**编辑：**例如在 OmniThreadLibrary 你会发现：

```
IOmniWorker = interface
  ['{CA63E8C2-9B0E-4BFA-A527-31B2FCD8F413}']
  function  GetImplementor: TObject;
  ...
end; 
```

您可以将其添加到您的界面中。但同样，恕我直言，使用不同的接口要好得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T13:39:19.127

您不能直接将接口转换为对象（这不是接口的用途），但有时这样做非常实用，以至于您无法抗拒......

如果你真的想这样做，你可以直接在 IMyInterFace 中使用 mghie 给出的示例“IOmniWorker”：

```
IMyInterFace = interface
['{B7203E50-F5CB-4755-9DB1-FB41B7B192C5}'] 
  function MyFunction: Boolean;
  function GetImplementor: TObject;
end; 
```

函数实现如下所示：

```
function TMyObject.GetImplementor: TObject;
begin
  Result := Self;
end;
function TMyOtherObject.GetImplementor: TObject;
begin
  Result := Self;
end; 
```

SendInterfaceObject 看起来像这样：

```
procedure SendInterfaceObject(const iobj:IMyInterFace);
begin
  if (iobj.GetImplementor is TSubMyObject) then
  begin
     //code here
  end
  else if (iobj.GetImplementor is TMyOtherObject) then
  begin
    //code here
  end;
end; 
```

顺便说一句，我添加了一个（非常）小的优化：通过将 iobj 作为“const”传递给函数，您可以避免不必要的引用计数。

# command-line - cmd /C 是什么意思？

> ID：515309
> 
> 赞同：268
> 
> 时间：2009-02-05T10:24:17.430
> 
> 标签：command-line, cmd

我能理解`cmd`但不能`cmd /c`。我试图从我使用的当前调用一个 java 程序，这`Runtime.getRuntime().exec("cmd /C java helloworld");`引起了我的怀疑。

* * *

## 回答 #1

> 赞同：303
> 
> 时间：2009-02-05T10:44:00.137

您应该感兴趣的`/?`部分是应该解决您使用该工具遇到的大多数其他问题的部分。

```
Microsoft Windows XP [版本 5.1.2600]
(C) 版权所有 1985-2001 Microsoft Corp.

C:\>cmd /?
启动 Windows XP 命令解释器的新实例

命令[/A | /U] [/Q] [/D] [/E:ON | /E:OFF] [/F:ON | /F:OFF] [/V:ON | /V:关]
    [[/S] [/C | /K] 字符串]

/C 执行字符串指定的命令，然后终止
/K 执行字符串指定的命令，但保持不变
/S 修改 /C 或 /K 之后的字符串处理（见下文）
/Q 关闭回声
/D 禁止从注册表执行自动运行命令（见下文）
/A 使内部命令到管道或文件的输出为 ANSI
/U 使内部命令输出到管道或文件
        统一码
/T:fg 设置前景色/背景色（参见 COLOR /? 了解更多信息）
/E:ON 启用命令扩展（见下文）
/E:OFF 禁用命令扩展（见下文）
/F:ON 启用文件和目录名称完成字符（见下文）
/F:OFF 禁用文件和目录名称完成字符（见下文）
/V:ON 使用 ! 启用延迟的环境变量扩展 作为
        分隔符。例如，/V:ON 将允许 !var! 扩大
        变量 var 在执行时。var 语法扩展变量
        在输入时，这在 FOR 内部时完全不同
        环形。
/V:OFF 禁用延迟的环境扩展。

```

* * *

## 回答 #2

> 赞同：129
> 
> 时间：2009-02-05T10:26:34.180

`/C`执行字符串指定的命令，然后终止。

您可以通过键入获取所有 cmd 命令行开关`cmd /?`。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-02-05T10:28:24.693

```
CMD.exe

Start a new CMD shell

Syntax
      CMD [charset] [options] [My_Command] 

Options       

**/C     Carries out My_Command and then
terminates** 
```

从帮助。

# iphone - navigationItem.title 没有被刷新

> ID：515314
> 
> 赞同：0
> 
> 时间：2009-02-05T10:26:03.260
> 
> 标签：iphone, objective-c, cocoa-touch

我有一个 RootViewController 和一个 SubViewController。我在任一方向遍历视图。RootViewController 是一个 UITableView 子类。根据选择的行，我想使用更改子视图的标题`self.navigationItem.title = [chunks objectAtIndex:1];`

它在第一次加载子视图时起作用。但是当我返回 RootViewController 并再次加载子视图时，之前的标题仍然存在。任何想法我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T14:56:55.460

在您的特定情况下，您可能希望在 viewWillAppear: 中设置标题，以便每次视图出现在屏幕上时都会设置标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T10:58:13.273

我只是在我的一个应用程序中尝试过。当我使用设置标题时

```
self.navigationItem.title = @"Foo" 
```

导航栏中的名称会立即更改。我认为您在其他地方有一个错误，您的代码仅在您第一次调用 SubViewController 时才被调用。在该行上放置一个断点，看看它是否真的被第二次调用。或者也许 [chunks objectAtIndex:1] 总是返回相同的字符串。

或者我不理解你的问题。据我所知，它确实像您期望的那样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T09:35:16.937

我猜您正在尝试更改 viewDidLoad 方法中的标题。viewDidLoad 仅在第一次加载视图时调用。如果你重用同一个 viewcontroller 的实例，viewDidLoad 只会被调用一次。

而是尝试在 viewWillAppear 方法中设置标题。每次要显示视图时都会调用此方法。那应该行得通。

# deployment - 通过 ClickOnce 部署后，dll 存储在客户端计算机的什么位置？

> ID：515317
> 
> 赞同：15
> 
> 时间：2009-02-05T10:26:43.900
> 
> 标签：deployment, clickonce

我在某处读到配置数据存储在用户帐户->本地设置->应用程序数据下，但找不到 dll、exe 和资源文件的去向。

我知道 ClickOnce 使用应用程序商店和数据目录来存储其应用程序数据，但是客户端可以访问这些数据吗？它们可以浏览吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-05T10:32:38.600

dll exe等都存储在同一个文件夹中。在我的机器上，每个应用程序的根目录是：

C:\Users\Robin\AppData\Local\Apps...

您当然可以使用资源管理器浏览这些...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T04:01:02.767

在 XP 上是

c:\Documents and Settings\UserName（有时称为“所有者”）\Local Settings\Apps\2.0\

# windows - 测试套接字连接的好工具？

> ID：515328
> 
> 赞同：67
> 
> 时间：2009-02-05T10:30:21.833
> 
> 标签：windows, sockets, networking, utility

我正在编写一个 tcp/ip 客户端，我需要一个“测试服务器”才能轻松测试。它应该监听一个可配置的端口，显示客户端何时连接以及客户端发送了什么，允许我手动输入要发送给客户端的文本。它应该可以在 Windows 上运行。

通常我会使用简单但功能强大的[nc.exe（在 Unix 和 Windows 上都可以使用别名“Netcat”）](http://en.wikipedia.org/wiki/Netcat)，但防病毒软件会将其检测为“黑客工具”，因此我的系统管理员不希望我使用它在上班。

有没有人使用其他工具来测试套接字连接并对此感到满意？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-02-05T21:44:59.443

[赫拉克勒斯](http://www.hw-group.com/products/hercules/index_en.html)太棒了。它是一个功能齐全的 tcp/udp 客户端/服务器，非常适合调试套接字。更多细节在网站上。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-05T10:39:12.033

`netcat`( `nc.exe`) 是正确的工具。我有一种感觉，任何能做你想做的事情的工具都会与你的防病毒软件有完全相同的问题。只需在您的防病毒软件中将此程序标记为“OK”（您如何执行此操作将取决于您使用的防病毒软件类型）。

当然，您还需要*配置*您的系统管理员以接受您没有尝试做任何非法的事情......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-05T10:36:37.763

尝试[Wireshark](http://www.wireshark.org/)或[WebScarab](http://www.owasp.org/index.php/Category:OWASP_WebScarab_Project)第二个更好地将数据插入到交换中（不确定 Wireshark 甚至可以）。无论如何，其中一个应该能够帮助您。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-05T11:22:22.213

我也会使用 netcat，但是由于您不能使用它，所以这里有一个替代方法：**netcat** :)。您可以找到用三种语言 (python/ruby/perl) 实现的 netcat。您需要做的就是为您选择的语言安装解释器。当然，这不会被视为一种黑客工具。

以下是链接：

[Perl 实现](http://4thmouse.com/index.php/category/programming/perl/)

[Python 实现](http://4thmouse.com/index.php/2008/02/22/netcat-clone-in-three-languages-part-ii-python/)

[红宝石实现](http://4thmouse.com/index.php/2008/02/20/netcat-clone-in-three-languages-part-i-ruby/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-09T09:25:16.953

另一个工具是[tcpmon](https://tcpmon.dev.java.net/)。这是一个用于监控 TCP 连接的 java 开源工具。它不是直接的测试服务器。它位于客户端和服务器之间，但允许查看正在通过“管”的内容并更改正在经历的内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-05T21:48:12.230

在这种情况下，为什么不自己写呢？如果您知道自己在做什么，可以在几分钟内完成一个简单的服务器应用程序来测试连接，并且您可以让它准确地响应您的需要，并针对特定场景。

# javascript - 用jQuery设计表格行交替块的更有效方法？

> ID：515338
> 
> 赞同：0
> 
> 时间：2009-02-05T10:33:50.017
> 
> 标签：javascript, jquery, jquery-1.3

用 jQuery 做奇数/偶数样式非常简单：

```
$(function() {
  $(".oddeven tbody tr:odd").addClass("odd");
  $(".oddeven tbody tr:even").addClass("even");
}); 
```

现在我今天遇到了一个有趣的问题。如果你想为交替的元素**组设置样式怎么办？**例如，交替的 3 块。可以通过以下方式完成常规操作：

```
$(function() {
  $(".oddeven3 tbody tr:nth-child(3n+1)").addClass("odd");
  $(".oddeven3 tbody tr:nth-child(3n+2)").addClass("odd");
  $(".oddeven3 tbody tr:nth-child(3n+3)").addClass("odd");
  $(".oddeven3 tbody tr:nth-child(3n+4)").addClass("even");
  $(".oddeven3 tbody tr:nth-child(3n+5)").addClass("even");
  $(".oddeven3 tbody tr:nth-child(3n+6)").addClass("even");
}); 
```

不过好像有点啰嗦。现在它可以稍微简化并像这样通用：

```
function oddEvenGroupStyle(groupSize) {
  for (var i=1; i<=groupSize; i++) {
    $(".oddeven" + groupSize + " tbody tr:nth-child(" + groupSize + "n+" + i + ")").addClass("odd");
    $(".oddeven" + groupSize + " tbody tr:nth-child(" + groupSize + "n+" + (groupSize+i) " + ")").addClass("even");
  }
} 
```

和：

```
$(function() {
  oddEvenGroupStyle(3);
}); 
```

不过，对我来说似乎有点骇人听闻。是否有更多 jQuery 风格的方式来选择正确的行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T12:24:34.053

```
function oddEvenGroupStyle(groupSize) {
    var even = false;
    $('tr').each( 
        function(i){ 
            if(!(i % groupSize)) even = !even;
            $(this).attr('class', (even ? 'groupEven':'groupOdd') ); 
    })
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T12:34:32.690

cletus，如果您想完成 101% jQuery-ish 的工作，请考虑：

1.  使用`each`而不是经典的 for 循环
2.  [扩展 jQuery 选择器行为](http://james.padolsey.com/javascript/extending-jquerys-selector-capabilities/)？（只是一个提示）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T13:13:29.493

我会在组中的第一个 TR 添加一个类：

```
<tr class="group"><td>Group 1</td></tr>
<tr class="grouppart"><td>Part of group 1</td></tr>
<tr class="grouppart"><td>Part of group 1</td></tr>
<tr class="group"><td>Group 2</td></tr>
... 
```

这样，您可以随时更改组的大小，而无需对 javascript 进行任何修改。

```
// Format the groups:
$("tr.group:even").addClass("even");
$("tr.group:odd").addClass("odd");

// Then apply to groupparts:
$("tr.grouppart").each(function(){
    var oGroup = $(this).prevAll("tr.group:first");
    if(oGroup.hasClass("even")){$(this).addClass("even");}
    if(oGroup.hasClass("odd")){$(this).addClass("odd");}
}); 
```

注意：我是凭记忆写的，所以里面可能有一些小故障。如果是这种情况，请发表评论，我会解决它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T13:18:44.363

1）为什么有一个奇数和一个偶数类，如果你有一个默认样式然后有一个压倒一切的奇数，它可能会更快

2）你不能用已经应用的样式渲染出html吗？说如果您在 PHP 或 ASP.net 中执行此操作。事后这样做会更慢，特别是如果你有很多行。

# xslt - 使用 XSLT 进行字母排序

> ID：515339
> 
> 赞同：0
> 
> 时间：2009-02-05T10:34:35.147
> 
> 标签：xslt, sorting

示例 XML：

```
 <term>
  <name>facies</name> 
  <translation language="en">facies</translation> 
  <definition><num>1.</num> cara <num>2.</num> superficie externa, superficie anterior</definition> 
  </term>
  <term>
  <name>factores angiógenos</name> 
  <translation language="en">angiogenic factors</translation> 
  <definition>descripción de sustancias que favorecen el desarrollo o la formación nueva de vasos sanguíneos</definition> 
  </term>
  <term>
  <name>factores de la coagulación</name> 
  <translation language="en">coagulation factors</translation> 
  <definition>la cascada de la coagulación de la sangre consta de 12 factores en total, todos ellos necesarios para que funcione bien</definition> 
  </term> 
```

我有一个 XSLT 文件，它制作了一个映射到名称的名称列表，以及一个翻译（如果存在）。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output omit-xml-declaration="yes"/>

  <xsl:template match="terms">

    var allwords = [

    <xsl:for-each select="letter">
      <xsl:for-each select="term">
        <xsl:call-template name="term"></xsl:call-template>
      </xsl:for-each>
    </xsl:for-each>
  ['','']
    ];

  </xsl:template>

  <xsl:template name="term">
    ['<xsl:value-of select="name"/>', '<xsl:value-of select="name"/>'],

    <xsl:if test="name!=translation">
      ['<xsl:value-of select="translation"/>', '<xsl:value-of select="name"/>'],
    </xsl:if>
  </xsl:template>

</xsl:stylesheet> 
```

这很好，产生以下

```
var allwords = 
[ ['facies', 'facies'], 
['factores angiógenos', 'factores angiógenos'],  
['angiogenic factors', factores angiógeno],
['factores de la coagulació', 'factores de la coagulació'] 
etc... 
```

但是，正如您所见，由于添加了英文单词，数组中的第一部分不再按字母顺序排列。

它需要按字母顺序排列，因此在这种情况下，“血管生成因子”将是数组中的第一个元素

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T10:38:05.483

```
Definition and Usage
The <xsl:sort> element is used to sort the output.
Note: <xsl:sort> is always within <xsl:for-each> or <xsl:apply-templates>. 
```

[<xsl:排序>](http://www.w3schools.com/xsl/el_sort.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T19:19:16.570

我认为就是这么简单：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output encoding="windows-1252" omit-xml-declaration="yes"/>

  <xsl:template match="/*">
    var allwords = [
    <xsl:apply-templates select="term">
      <!-- key to success -->
      <xsl:sort select="name"/>
    </xsl:apply-templates>
    ];
  </xsl:template>

  <xsl:template match="term">
    ['<xsl:value-of select="name" />', 
    '<xsl:value-of select="translation[@language='en']" />']
    <xsl:if test="position() != last()">,</xsl:if>
  </xsl:template>
</xsl:stylesheet> 
```

输出（抱歉，必须从测试输入中删除“有趣”字符）

```
var allwords = [
  ['facies', 'facies'],
  ['factores angiogenos', 'angiogenic factors'],
  ['factores de la coagulacio', 'coagulation factors']
]; 
```

（换行和缩进在原始输出中有点不同。我改变了它们，所以看起来不错。）

我认为您不知道 XSL 样式表中的`<xsl:sort/>`, 标记为`<!-- key to success -->`。;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T17:42:02.710

这是我对您要做什么的最佳猜测。给定以下示例 XML：

```
<terms>
<letter name="f">
    <term>
        <name>facies</name>
        <translation language="en">facies</translation>
        <definition>
            <num>1.</num> cara <num>2.</num> superficie externa, superficie anterior
        </definition>
    </term>
    <term>
        <name>factores angiógenos</name>
        <translation language="en">angiogenic factors</translation>
        <definition>descripción de sustancias que favorecen el desarrollo o la formación nueva de vasos sanguíneos</definition>
    </term>
    <term>
        <name>factores de la coagulación</name>
        <translation language="en">coagulation factors</translation>
        <definition>la cascada de la coagulación de la sangre consta de 12 factores en total, todos ellos necesarios para que funcione bien</definition>
    </term>
</letter> 
```

对每个字母的翻译进行排序：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output omit-xml-declaration="yes"/>

<xsl:template match="terms">
    var allwords = [
        <xsl:apply-templates select="letter">
            <xsl:sort select="name"/>
        </xsl:apply-templates>
    ];
</xsl:template>

<xsl:template match="letter">
    <xsl:apply-templates select="term">
        <xsl:sort select="translation"/>
    </xsl:apply-templates>
</xsl:template>

<xsl:template match="term">
    ['<xsl:value-of select="translation"/>', '<xsl:value-of select="name"/>']
    <xsl:if test="not(position() = last())">
        <xsl:text>, </xsl:text>
    </xsl:if>
</xsl:template> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T11:16:10.587

是的，需要更多的想法，只是排序：p

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output omit-xml-declaration="yes"/>

  <xsl:template match="terms">

    var allwords = [

      <xsl:for-each select="letter/term/name | letter/term/translation">
        <xsl:sort order="ascending" select="."/>
        <xsl:call-template name="term"></xsl:call-template>
      </xsl:for-each>
  ['','']
    ];

  </xsl:template>

  <xsl:template name="term">
    ['<xsl:value-of select="."/>', '<xsl:value-of select="./../name"/>'],
  </xsl:template>

</xsl:stylesheet> 
```

基本上，您需要能够同时选择名称和翻译，然后按两者排序。然后必须对模板进行一些编辑，因为它现在接收的是子元素而不是父元素。

# bash - 如何在 crontab 中委托以使用另一个文件作为 crontab？又名 SVN/CVS 中的 Crontab？

> ID：515341
> 
> 赞同：3
> 
> 时间：2009-02-05T10:34:58.953
> 
> 标签：bash, version-control, cron, crontab

也许还有另一种解决方案。我构建了一个 Web 应用程序，需要 5-10 个 cron 来保持它的维护和不同的时间间隔。我想将 crontab 签入到版本控制中，以便可以轻松地将其部署到其他服务器。

我希望能够在 /etc/crontab 文件中添加一行，告诉它查看 /myapp/app.crontab 文件并将该文件中的所有行视为 crontab 条目......即：

```
0 1 * * *    root   /bin/sh /do/something.sh 
```

为什么不直接签入 /etc/crontab？因为在从服务器部署到服务器时，某些服务器的 crontab 中可能有我不想干扰的不同条目。

有任何想法吗？其他人在 rev ctrl 中存储一堆 crontab 条目是做什么的？
谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T10:37:25.797

将您的 crontab 文件放入 /etc/cron.d/ - 作为签出文件或指向签出文件的符号链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T03:49:33.230

在我正在进行的项目中，我们对这个问题采取了非常不同的方法。

我们有一个 Perl 脚本`crontab.pl`，所有服务器都在它们的 crontab 中调用它。这样做意味着 crontab 永远不必在连续的应用程序部署中更改，并且`crontab.pl`脚本可以愉快地与其他应用程序源文件一起存在于源代码控制中。

我们可以使用命令行参数为该脚本指定不同的时间间隔。crontab 如下所示：

```
*/5 * * * * /usr/local/apache/crontab.pl 5    > /var/log/crontab.log 2>&1 # 5 minute interval
1   * * * * /usr/local/apache/crontab.pl 60   > /var/log/crontab.log 2>&1 # 1 hour interval
1   1 * * * /usr/local/apache/crontab.pl 3600 > /var/log/crontab.log 2>&1 # 1 day interval 
```

然后只需读取该命令行时间间隔并运行给定时间间隔所需的任务即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T19:09:40.967

只需将一个（或很少）条目添加到 crontab，并让该条目成为调用其他条目的受修订控制的脚本：

0 * * * * /path/to/app/hourly.sh 0 0 * * * /path/to/app/daily.sh 0 1 * * 5 /path/to/app/weekly.sh

然后，hourly.sh 将调用所有需要按小时完成的操作，daily.sh 将调用所有需要每天完成的操作，依此类推。

我发现在为单个应用程序管理大量 cron 作业时，最好不要让所有作业都挂在 crontab 中，因为这会鼓励您忽略它们之间的依赖关系，即在过去 14 分钟运行的一项任务小时取决于一个在该小时后 12 分钟运行的任务，但每隔一段时间，该任务需要 2.1 分钟才能完成，而另一个脚本失败，给你一个 Heisenbug。

另一种方法是编写自己的守护进程来管理这些任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T02:42:38.667

我这样做的方法是将我的 crontab 文件放在源代码控制中，然后在我的部署脚本中，将 crontab 文件替换为正在部署的文件。

你可以这样做：

`crontab filename`

或者对于特定用户（必须对此具有超级用户访问权限）：

`crontab -u my_web_user filename`

一个**重要的警告**是，它假设每个用户只有一个 crontab 条目，并且它存储在 SCM 中。如果其他人在服务器上编辑 crontab，这些编辑将在下一次部署时丢失。所以请注意这一点。

# .net - .Net winform 按钮错误？

> ID：515343
> 
> 赞同：0
> 
> 时间：2009-02-05T10:35:33.523
> 
> 标签：.net, winforms

.Net winform 的按钮似乎有一个错误。如果您在winform按钮上单击并按住它，然后右键单击（按住左键单击），然后释放右键单击，然后将按钮拖到按钮外部，然后释放左键单击，似乎您的按钮将被“卡住” - 它不会回到按下状态。这只是我的鼠标有问题吗？如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T10:44:45.797

我觉得这很有趣，所以我试了一下，它在我的 VS 中没有。所以我认为这只是一个视觉工作室图形错误......尝试在代码中制作并调用按钮，然后尝试用鼠标移动它，看看问题是否仍然存在。

# excel-formula - 我可以在两列上使用 COUNTIF 来比较值吗？

> ID：515344
> 
> 赞同：10
> 
> 时间：2009-02-05T10:35:39.437
> 
> 标签：excel-formula

我在 Excel 中有两列，如下所示：

```
 A   B
0.5  0.4
0.6  0.59
0.1  0.2
0.3  0.29 
```

我想计算 B 中的值有多少小于它们在 A 中的对应值。在这种情况下，答案是 3。

我可以通过添加一个额外的列`B-A`然后执行此操作`COUNTIF(RANGE, "<0")`，但我想知道是否有一种方法可以在不添加额外列的情况下做到这一点。

我意识到这是人们可能会考虑编程的边缘，但希望它只是在正确的一边，而不是错误的一边。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-05T11:48:35.920

这可以使用 Excel 数组公式来完成。尝试做这样的事情：

```
=SUM(IF(A1:A5 > B1:B5, 1, 0)) 
```

非常*非常* **重要的**部分，是在您输入完公式后按`CTRL-SHIFT-ENTER`而不是按。`ENTER`否则它将无法理解您要将数据视为数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-05-21T12:34:49.220

Shalom 的 Arrayformula 解决方案非常好，但我无法使其与嵌入 IF 的 AND 函数一起使用，所以我不得不寻找另一个解决方案，终于找到了！

```
=ROWS(FILTER(A1:B4, A1:A4 > B1:B4)) 
```

这解决了问题中的原始问题。另一方面，您可以使用多个条件，如有必要，在其他函数中使用过滤范围本身。

（这是一个 Google Sheet 解决方案，没有在 Excel 中尝试过）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T11:15:39.213

有一个解决方案，但它仍然涉及 2 个额外的单元格：DCOUNT。

以下是一个示例（在指定单元格中插入冒号后的确切文本）：

A1：条件

A2:=B4>A4

A3:A

B3:B

A4:700

B4:5000

A5:700

B5:600

A6:7000

B6:6000

A7:700

B7:701

具有计数公式的单元格：=DCOUNT(A3:B7,"B",A1:A2)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T11:16:23.783

实际上，这是我**会**用程序做的事情。

创建一个宏来：

*   插入 C 列。
*   将所有 N 的 range("cN").value 设置为 "=bN-aN"，其中 range("aN").value <> ""。
*   做你的 countif 计算并将其推入一个单元格（**不是**C 列）。
*   删除 C 列。

可能有一种更简单的非编程方式，但我不知道（然后你的问题无论如何都会被关闭）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T12:07:23.527

scraimer 解决方案是好的。但为了好玩，

您还可以编写如下宏并分配

```
=myOwnFunction(A1:A5,B1:B5) 
```

这种方法可以扩展到任何其他逻辑函数，例如 A *​​ B + C < C + D * E 等......

```
Function myOwnFunction(R1 As Range, S1 As Range)

   Dim J As Integer

   Dim Size As Integer

   Dim myCount As Integer

   Size = R1.Cells.Count

   myCount = 0

       For J = 1 To Size

           If (R1.Cells(J) > S1.Cells(J)) Then

            myCount = myCount + 1

           End If

       Next J

    myOwnFunction = myCount

End Function 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-12T11:22:39.243

我会使用 sumproduct。

```
=sumproduct(--(B:B>A:A)) 
```

给出正确答案 3

# c# - 如何在不实际调整大小的情况下触发 Control.Resize 事件？

> ID：515346
> 
> 赞同：8
> 
> 时间：2009-02-05T10:36:34.847
> 
> 标签：c#, winforms, events, resize, controls

我没有对控件进行子类化。尝试通过`Control.Size = Control.Size`失败触发事件，因为即使新大小实际上不同，它也不会触发。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-05T10:42:59.373

如果是子类化`Control`，可以`OnResize`直接调用，或者暴露在 API 上：

```
 public void OnResize() {
     this.OnResize(EventArgs.Empty);
 } 
```

但是，您不能对任意控件执行此操作。你可以改变`Size`来回？或者，您可以使用反射，但这是 hacky：

```
 typeof (Control).GetMethod("OnResize",
     BindingFlags.Instance | BindingFlags.NonPublic)
     .Invoke(myControl, new object[] {EventArgs.Empty}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-18T15:07:07.337

我总是通过调用控件的 Resize 事件处理程序来做到这一点：

```
control_Resize(null, null); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T10:42:09.000

只需使用以下命令更改控件的大小： Control.Size = new Size(x,y);

更改控件的大小将为该控件发出一个调整大小事件，并且该控件应调整大小。

或者，如果您只想重绘控件，请执行以下操作： Control.Invalidate();

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T10:46:48.603

为什么要这样做，在什么情况下？例如，当您在控件本身（即在您的派生控件类中）时，您可以调用 OnResize。（或者通过反射，当你在外面时。）

除此之外，您可能必须更改控件的大小，因为这就是 Resize 事件的用途:)

# c - 如何根据扩展名动态获取文件名？

> ID：515351
> 
> 赞同：0
> 
> 时间：2009-02-05T10:37:10.400
> 
> 标签：c, file, winapi, ttcn

[作为这个问题](https://stackoverflow.com/questions/515171/how-to-open-ttcn-file-using-c-file-open-functions)的后续行动......

现在，我通过用户 j_random_hacker 的评论找到了该问题的答案。这里 Windows 遵循 8.3 文件命名标准意味着 turbo c 只能读取名称长度为 8 个字符且扩展名为 3 个字符的文件。因此，Windows 将为任何不遵循 8.3 命名标准的文件赋予另一个名称。就像在我的情况下，Windows 为HI.TTCN的实际文件名提供了**HIBDS~** **1.TTC**。

现在我的问题是我想在运行时将该文件名作为参数，如下所示

> `glc hi.ttcn`
> 
> 这里 glc 是我的 .exe 文件，它将检查编码准则违规，hi.ttcn 是要检查的实际 TTCN 文件。所以这里的问题是上面所说的windows给hi.ttcn提供了一些其他的名字所以我的程序无法打开那个文件说“文件名不存在”，因为我给了相同的参数字符串“hi.ttcn”打开。那么如何在运行时为给定的参数字符串获取 Windows 分配的文件名（意味着我想在给出“HI.TTCN”时获取字符串“HIBDS~1.TTC”。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T11:16:56.823

好的，这是描述您需要调用的 Win32 函数的页面：

[GetShortPathName 函数](http://msdn.microsoft.com/en-us/library/aa364989(VS.85).aspx)

你需要`#include <windows.h>`在你的程序的顶部，并且可能跳过更多的箍来让它在这样一个旧的编译器上编译（也许 Turbo C 甚至没有附带 Windows 头文件？）祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T10:51:06.283

我相信这是可以做到的，但这很棘手，因为它需要深入研究毛茸茸的 Win32 API 调用。使用现代编译器简单地重新编译会容易*得多*——有什么理由不能这样做吗？

以下是两个免费的高质量 C/C++ 编译器的链接，它们在处理长文件名时不会遇到任何问题：[Microsoft Visual C++ Express Edition](http://www.microsoft.com/express/vc/)；[明威](http://www.mingw.org/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T13:12:30.790

您还可以使用`dir /x`从命令行获取短文件名

# asp.net - VS 2008“无法连接到 ASP.NET 开发服务器”

> ID：515354
> 
> 赞同：2
> 
> 时间：2009-02-05T10:37:28.777
> 
> 标签：asp.net, visual-studio-2008

我并排安装了 VS 2005 和 VS 2008。有趣的是，我可以在 VS 2005 下使用开发服务器。但是当我在 VS 2008 中尝试时，它给了我一个错误“无法连接到 ASP.NET 开发服务器”。

任何的想法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T10:41:34.073

试试看VS 2008的端口配置？如果它没有设置为自动，它可能正在使用正在使用的端口？
如果它设置为自动分配，那么请尝试指定一个端口并选择一个您知道空闲的端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-04T06:33:06.220

只需 `WebDev.WebServer.exe.manifest`使用位于以下位置的新工作副本或良好工作副本更改文件：

```
C:\Program Files\Common Files\Microsoft Shared\DevServer\9.0\ 
```

然后重新启动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T08:33:54.157

如果您的项目是网站而不是 Web 项目，那么您可以从属性窗口设置端口属性。
从解决方案资源管理器中选择项目，然后按 (ctrl+w 然后 p) 以显示属性窗口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T14:33:26.657

最后我通过重新安装 VS 2008 让它工作了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-28T08:43:00.953

您可以编辑将直接在您的解决方案文件中使用的端口开发服务器。只需在 Web 项目条目的 ProjectSection 中编辑 VWDPort 属性。首先在命令行中调用 netstat 以检查当前端口是否已在使用中。那是为我做的。

# javascript - 查找与 HTML 文档中的模式匹配的所有类？

> ID：515356
> 
> 赞同：4
> 
> 时间：2009-02-05T10:37:39.103
> 
> 标签：javascript, jquery, html, css, jquery-1.3

我今天开始思考：获取文档中使用的（最好）匹配模式（正则表达式）模式或（或者）以某个字符序列开头的不同（即不重复）类列表的最佳方法是什么？JQuery 可用于此或直接使用 Javascript。

现在它显然应该满足所有合法类的用法，例如：

```
<div class="class1 class2 class3">
</div> 
```

而且我不想用正则表达式解析文档。这太容易出错了。我感兴趣的是一个遍历 DOM 或使用 jQuery 之类的东西来执行此操作的 Jaavascript 解决方案。

哦，这还应该包括通过以前的 Javascript 代码动态添加/删除的任何类。

建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T10:53:04.487

```
function gatherClasses() {
    var tags = document.getElementsByTagName('*');
    var cls, clct = {}, i, j, l = tags.length;
    for( i = 0; i < l; i++ ) {
        cls = tags[i].className.split(' ');
        for( j = 0; j < cls.length; j++ ) {
            if( !cls[j] ) continue;
            clct[cls[j]] = 'dummy'; //so we only get a class once
        }
    }
    cls = [];
    for( i in clct ) {
        cls.push( i );
    }
    return cls;
} 
alert(gatherClasses()) 
```

这是一个带有正则表达式匹配的版本

```
function gatherClasses( matchString ) {
    if( matchString ) {
        var rxp = new RegExp( matchString );
    } else {
        var rxp = /.*/;
    }
    var tags = document.getElementsByTagName('*');
    var cls, clct = {}, i, j, l = tags.length;
    for( i = 0; i < l; i++ ) {
        cls = tags[i].className.split(' ');
        for( j = 0; j < cls.length; j++ ) {
            if( !cls[j] || !rxp.test( cls[j] ) ) {
                continue;
            }
            clct[cls[j]] = 'dummy'; //so we only get a class once
        }
    }
    cls = [];
    for( i in clct ) {
        cls.push( i );
    }
    return cls;
}
//find classes that match 'stack'
alert(gatherClasses('stack')) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T10:47:49.490

这可以帮助你吗？

[http://httpcode.com/blogs/PermaLink,guid,77f17d9c-cdc0-4fcb-a392-3cc70ef6ac23.aspx](http://httpcode.com/blogs/PermaLink,guid,77f17d9c-cdc0-4fcb-a392-3cc70ef6ac23.aspx)

```
<input type="radio" class="star star_id_45 star_group_5" />

$("input[class*='star_id_45']") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T11:42:25.917

使用 jQuery：

```
var listClasses = function( pattern ){
    var allClassesTmp = {}, allClasses = []; 
    var rx = pattern ? (new RegExp(pattern)) : (new RegExp(".*"));

    $('*[class]').each( function(){ 
        var cn = this.className.split(/\s+/); 
        for(var i=cn.length;--i>-1;){ 
            if(rx.test(cn[i]))allClassesTmp[ cn[i] ] = 1 
        } 
    }); 
    for(var i in allClassesTmp)allClasses.push(i); 
    return allClasses;
} 
```

# c# - DependancyProperty 附加到属性的属性

> ID：515360
> 
> 赞同：0
> 
> 时间：2009-02-05T10:38:17.183
> 
> 标签：c#, workflow, workflow-foundation, dependency-properties

我有一个带有属性的工作流，声明如下：

```
public Person userAccount {get;set;} 
```

Person 是一个具有它自己的属性（如 Person.Name）的类，并且使用 WF 我可以很好地绑定到 userAccount 属性，但我似乎无法绑定到 userAccount.Name。

是否有可能做到这一点？如果是这样，我需要改变什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T16:21:40.890

不

我认为不可能直接绑定到工作流程中的变量成员

您将必须绑定到实体类，即 userAccount

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T11:13:12.627

这是可能的，而且逻辑上只是 Visual Studio 编辑器有一些问题。您的路径属性只需要正确设置即可。
示例（从上面看我的场景）：
`Activity=BusinessProcess, Path=userAccount.Name`

# unit-testing - 其他目录中的 NUnit 引用二进制文件

> ID：515362
> 
> 赞同：0
> 
> 时间：2009-02-05T10:38:25.203
> 
> 标签：unit-testing, nunit

我正在运行 NUnit 测试，只要所需的 dll 与测试位于同一目录中，一切都很好。否则我会收到错误“无法加载文件或程序集”。NUnit 控制台似乎没有任何开关来包含默认路径，也没有在查找程序集时使用系统 PATH 变量。

问题是如何引用目录中的二进制文件，然后测试自身。我不想避免在一个目录中混合测试和传送二进制文件。当然，我可以复制所有内容/删除测试 dll，但感觉很笨拙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T17:53:24.570

在有问题的机器上，创建一个环境变量“DEVPATH”并将值设置为程序集的路径。然后，在 nunit.exe.config 中，在 \configuration\runtime\ 部分中添加以下内容：

`<developmentMode developerInstallation="true" />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T10:57:20.750

在引用所有其他项目的单独项目中编写测试。

你在使用 Visual Studio .Net 吗？然后，您可以选择在进行发布构建时不包含此项目。

**测试代码永远不应该投入生产。**

# windows - 非程序员最简单的 xml 编辑器

> ID：515371
> 
> 赞同：2
> 
> 时间：2009-02-05T10:41:39.970
> 
> 标签：windows, xml, utf-8, editor

我需要最简单**的支持 utf-8**的编辑器来在 windows 中编辑 xml 文件；像写字板这样的东西是完美的。它是为非程序员编辑现有文件的（直到现在他使用写字板，但现在我用 utf-8 编码的文件翻译了很多意大利口音显然不可读）。有什么建议吗？

谢谢，这真的会帮助我

问候

尼古拉

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T10:47:46.260

使用[Notpead++](http://notepad-plus.sourceforge.net/)它应该是无痛的。再见 ;）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T10:59:17.593

XML Notepad 2007 为浏览和编辑 XML 文档提供了一个简单直观的用户界面。

[Xml记事本](http://www.microsoft.com/downloads/details.aspx?familyid=72d6aa49-787d-4118-ba5f-4f30fe913628&displaylang=en)

简单、轻松、免费、小巧

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T10:49:15.727

我正在使用[Ultraedit](http://www.ultraedit.com)来处理这些事情。不是免费的，但它非常稳定，并具有许多其他有用的功能，例如通过 FTP 访问进行远程编辑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T10:56:01.330

我自己的 Notepad++ 替代品是[SciTE](http://www.scintilla.org/SciTE.html)。他们都使用SCIntilla引擎，所以差别不是很大。我喜欢 SciTE 更具可配置性的事实，您可以删除许多与非编程用户无关的菜单条目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T11:07:01.230

支持 UTF-8的*最简单*的编辑器是 Windows 的内置记事本。总的来说还好；唯一可能出错的是它只支持 Windows 样式的 CR/LF 行结尾，这使得编辑裸 LF 文件变得很痛苦。

记事本在所有情况下都比可怕的写字板更可取，它可能会弄乱您的文件。曾经使用写字板的唯一原因是它可以在 Windows 9x 中编辑超过 64kB 的文件。但是记事本在WinNT系列中处理长文件没有问题。

有很多很多的编辑器比记事本更先进。它们都会为您提供语法高亮，使 XML 编辑更加清晰。Notepad++ 尤其是免费的。通常，尽管语法突出显示不足以检测格式正确的错误，所以您仍然需要一些东西来测试它，例如将文件加载到 Firefox，或者对于 Notepad++，[XML 工具](https://sourceforge.net/project/showfiles.php?group_id=189927&package_id=264094)。我将 EmEditor 与有效的 XML 检查器插件一起使用；EmEditor 是一个不错的小编辑器，但它不是免费的。

然后是专用的 XML 编辑器，例如 XMLNotepad。这些总是会生成格式良好的 XML，但界面可能有点吓人。当然，它们比文档样式标记更适合数据驱动的 XML。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T11:21:49.827

谢谢大家的回复！

我和这个非程序员的人一起尝试了notepad++，他说它很完美。我不知道旧记事本是否兼容 utf-8，我没有花时间检查，但无论如何 notepad++ 更适合我们的目的，因为它的颜色突出显示。

再次感谢

尼古拉

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-13T08:53:28.360

尽管您已经接受了答案，但[Notepad2](http://www.flos-freeware.ch/notepad2.html)可能是 Notepad++ 的更简单替代品。它支持 UTF-8 和语法高亮，看起来最像 Windows 记事本。
有些人甚至写了关于用 Notepad2 替换 Windows 记事本的文章（可以在链接的网站上找到）。

# xcode - 编译结束后如何让它发出哔哔声？

> ID：515372
> 
> 赞同：10
> 
> 时间：2009-02-05T10:41:40.563
> 
> 标签：xcode

题目说明了一切……

我只是想让 Xcode 在编译过程结束后发出哔哔声或任何其他噪音。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-06T16:02:13.383

在 Xcode 4 中，您只需在 Preferences 中打开“Behaviors”选项卡，选择 Build Succeeds 事件并选中“Play sound”或“Speak notice”选项。失败的构建和其他重要事件也是如此：

![Xcode 行为](https://i.stack.imgur.com/GEWU5.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-05T11:04:23.217

在您的项目菜单中选择“New Build Phase”，然后选择“New Run Script Build Phase”。

然后，您可以将 shell 命令添加到该脚本，即

```
/usr/bin/say "Build completed" 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-06T05:04:28.433

更好的是，阅读[http://developer.apple.com/documentation/DeveloperTools/Reference/XcodeUserDefaultRef/100-Xcode_User_Defaults/chapter_2_section_7.html](http://developer.apple.com/documentation/DeveloperTools/Reference/XcodeUserDefaultRef/100-Xcode_User_Defaults/chapter_2_section_7.html)

```
defaults write com.apple.Xcode PBXBuildSuccessSound /path/to/sound.aiff 
```

# ruby-on-rails - 在按钮的 onclick 事件中使用 RJS 代码

> ID：515376
> 
> 赞同：0
> 
> 时间：2009-02-05T10:42:55.350
> 
> 标签：ruby-on-rails, ajax

我知道如何将 javascript 代码添加到按钮的 onclick 事件中，例如：

“this.disabled=true,this.form.submit();” %>

我想知道我是否可以在 onclick 中使用 rjs。我想用它来渲染一个部分。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T13:27:01.697

检查*remote_form_for*和*submit_to_remote*的文档。*您的 JS 代码禁用您可以作为:loading 选项*传递的表单。您还可以传递代码以将表单激活为*:complete option*。

上述函数生成使用 onsubmit 事件的 JS 代码，但行为是相同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T15:23:50.367

如果您确实需要使用提交按钮从 rjs 生成 java 脚本。您可以像这样直接将 rjs 添加到 .html.erb 文件中

```
<%= submit_tag 'Enter', 
  :onclick => render(:update) { |page| 
      page[:enter].disable
    }, 
  :id => 'enter' %> 
```

但如果你只需要渲染部分。Greg Dan 的回答更好。

# c# - 如何使用 log4net 记录跟踪消息？

> ID：515381
> 
> 赞同：75
> 
> 时间：2009-02-05T10:44:01.383
> 
> 标签：c#, .net, log4net

我正在使用 log4net 将写入日志消息记录到滚动日志文件中。

现在，我还将所有跟踪消息重定向`System.Diagnostics.Trace`到该日志文件。我该如何配置？我试图在 log4net 文档中找到有关此的任何内容，但没有成功。有可能吗？

我想这样做的原因是因为我对 3rd 方库的 Trace 消息感兴趣。

```
<log4net>
    <appender name="R1" type="log4net.Appender.RollingFileAppender">
      <file value="C:\Logs\MyService.log" />
      <appendToFile value="true" />
      <rollingStyle value="Date" />
      <maxSizeRollBackups value="10" />
      <datePattern value="yyyyMMdd" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
      </layout>
    </appender>
</log4net> 
```

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-05T11:39:44.360

根据 Rune 的建议，我实现了一个基本的 TraceListener，它输出到 log4net：

```
public class Log4netTraceListener : System.Diagnostics.TraceListener
{
    private readonly log4net.ILog _log;

    public Log4netTraceListener()
    {
        _log = log4net.LogManager.GetLogger("System.Diagnostics.Redirection");
    }

    public Log4netTraceListener(log4net.ILog log)
    {
        _log = log;
    }

    public override void Write(string message)
    {
        if (_log != null)
        {
            _log.Debug(message);
        }
    }

    public override void WriteLine(string message)
    {
        if (_log != null)
        {
            _log.Debug(message);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-05T10:49:54.650

我不知道 log4net 是否支持这一点，但您可以实现自己的跟踪侦听器来执行此操作。

TraceListener 没有太多需要实现的方法，您所要做的就是将值转发到 log4net，所以这应该很容易做到。

要添加自定义跟踪侦听器，您可以修改 app.config/web.config 或者将其添加到代码中`Trace.Listeners.Add(new Log4NetTraceListener());`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-08T10:07:44.730

根据上面的答案，这里有一个实现（这个链接很不稳定，但我确实找到了源代码）：

[https://code.google.com/archive/p/cavity/](https://code.google.com/archive/p/cavity/)

为了粗略地处理从 LogLog 类发出的内部 log4net 跟踪的问题（在对先前答案的评论中描述），我通过检查堆栈帧（这个实现已经这样做）来检查这个类是否是跟踪的来源，并且忽略那些跟踪消息：

```
 public override void WriteLine(object o, string category)
    {
        // hack to prevent log4nets own diagnostic trace getting fed back
        var method = GetTracingStackFrame(new StackTrace()).GetMethod();
        var declaringType = method.DeclaringType;
        if (declaringType == typeof(LogLog))
        {
            return;
        }
        /* rest of method writes to log4net */
    } 
```

使用 TraceAppender 仍然会产生上面评论中描述的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-02-03T10:40:22.083

谢谢，

我选择了德克的答案，稍微精简了一点。

```
public class Log4netTraceListener : System.Diagnostics.TraceListener
{
    private readonly log4net.ILog _log;

    public Log4netTraceListener()
        : this(log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType))
    {

    }

    public Log4netTraceListener(log4net.ILog log)
    {
        _log = log;
    }

    public override void Write(string message) => _log?.Debug(message);

    public override void WriteLine(string message) => _log?.Debug(message);
} 
```

# java - Netbeans、Ant 和 RMIC（Java RMIC 编译器）（帮助）

> ID：515391
> 
> 赞同：1
> 
> 时间：2009-02-05T10:47:37.757
> 
> 标签：java, netbeans, ant, rmi

我现在很生气/困惑。

我有一个 Netbeans 项目，编译得很好。我编辑了 build.xml 文件以创建一个“-post-compile”目标，它执行 rmic ant 任务。

所以现在，当我“清理和构建”时，它会编译我的主要代码，然后为我生成 rmic 存根。

然而，当我选择“运行”我的 netbeans 项目时，使用 netbean 的对话框，我的存根文件*神奇地*消失了。（但编译的类仍然存在）然后它尝试运行我的应用程序，这当然失败了，因为现在缺少所需的存根文件。

这是在 netbeans 托管项目中（不是自由格式的 ant 应用程序）。我已经指定了我想“运行”的课程。这基本上是我得到的唯一选择。

我试过了：

```
<target name="-post-compile">
<rmic classname="RTIController.Lane_Assignment_Strategy.Impl_Lane_Assignment_Strategy_Dist_FirstFlow" base="${build.classes.dir}"/>
<rmic classname="MappingModel.Impl_SimObjectPackage.Impl_Road" base="${build.classes.dir}"/>
<rmic classname="MappingModel.Impl_SimObjectPackage.Impl_Lane" base="${build.classes.dir}"/>
<rmic classname="MappingModel.Impl_SimObjectPackage.Impl_Veh_Source" base="${build.classes.dir}"/>
<rmic classname="MappingModel.Impl_SimObjectPackage.Impl_Veh_Sink" base="${build.classes.dir}"/>
<rmic classname="RTIController.Timing_Event.Adapter_Timing_Event_Source" base="${build.classes.dir}"/>
<rmic classname="MappingModel.Impl_SimObjectPackage.Impl_Vehicle.Impl_Vehicle_Car" base="${build.classes.dir}"/>
<rmic classname="MappingModel.Impl_SimObjectPackage.Impl_Vehicle.Impl_Vehicle_Truck" base="${build.classes.dir}"/>
</target>
<target name="run" depends="init,compile,graphicalMapper-impl.run"/> 
```

在 build.xml 中（覆盖 build-impl.xml）。

任何人都可以对这个主题有所了解吗？另一方面，当我通过 ('ant run') 之类的命令运行 Ant 时，它工作正常。（是否初始化、编译、后编译和运行。）

在尝试让 Ne​​tbeans“运行”应用程序时检查 Ant 调试日志时，它似乎只执行任务“运行”。（这显然不是我提供的覆盖的“运行”。

我将非常感谢有关此主题的任何帮助，因为单独编译和运行会适得其反。（目前在 netbeans 中开发并使用 cmdline ant 来构建和运行。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T10:46:03.440

只是一个疯狂的猜测（因为我有一段时间没有使用 RMI），因为不再需要 Java 1.5 RMI Stub 类。它们是自动生成的。这可能是 netbeans 删除它们的原因。

您可以尝试从 build.xml 中删除 rmic ant 任务引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T04:53:19.233

我有完全相同的问题。我解决它的方法是从我的项目中覆盖 build.xml 中的“运行”目标。

```
<target name="run" depends="PrOJECT-impl.jar">
    <java classpath="${run.classpath}" jar="${dist.jar}">
        <sysproperty value="codebase_url" key="java.rmi.server.codebase"></sysproperty>
        <sysproperty value="policy" key="java.security.policy"></sysproperty>
    </java>
</target> 
```

但是，问题仍未完全解决，因为使用上下文菜单或 F6 仍会删除存根和骨架文件。您需要直接从 build.xml 文件运行“运行”目标。

# java - 寻找 .NET 3.5 / J2EE 架构概念比较文章/图表

> ID：515397
> 
> 赞同：7
> 
> 时间：2009-02-05T10:49:19.907
> 
> 标签：java, .net, .net-3.5, jakarta-ee

我们正在考虑将 .NET 技术与 Java 技术（WCF、JBoss/ESB、MOM、WPF、WF）结合起来，我需要对 .NET 3.5 和 Java 世界中的苹果和橘子有一个高层次的了解。

有谁知道一篇好的、清晰的文章，或者更好的是一个简单的图表来回答以下问题：

*   Java 世界中的 WCF 是______
*   Java 世界中 WPF 的等价物是 _____
*   在 .NET 世界中，JBoss 最接近的事情是 _____
*   JVM 和 CLR 本质上是相同的，除了这些差异： ....
*   在 Java 世界中，您没有 WF/WCF/WPF 的概念，而是...。
*   Java 世界中还没有“LINQ”，但您可以使用 ___
*   在 Java 世界中，您最接近 ADO.NET 数据服务的是......

我不想辩论这个，所以我不是在寻找“战斗点”，我只需要一个中性的什么是什么图表来比较两个世界。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T15:13:32.900

我不知道一个好的、清晰的图表，但我会冒险回答你的问题。（警告——我是一名 J2EE 开发人员，我上次在 Microsoft 编程时使用的是经典的 ASP 和 VB 6。我无法评估 MS 技术，但我确实对很多东西有很好的了解Java 等价物。）

*   **WCF**：WCF 似乎是关于简化 Web 服务。J2EE 等价物是 Apache CXF，它使用 JAX-WS 2.0 规范中可用的注释来简化 Web 服务的创建。
*   **WPF**：这个很简单。微软的技术看起来像是对 JavaServer Faces 的直接翻版。我不能告诉你哪一个*更好*，但它们非常相似。**编辑：**我对这个太快了——JSF 不能在桌面上工作，就像 WPF 应该的那样。底层技术相似，但 JavaFX 可能是更好的比较。
*   **.NET 中的 JBoss**： 其他人可能想直截了当地告诉我，但我觉得说这不存在是相当安全的。想想看。您需要一个免费的开源产品来运行专有的、非免费的规范。如果你选择微软，你就会被 IIS 困住，就像你被 Windows 困住一样。
*   **JVM vs. CLR**：我发现了一篇论文，可[在此处](http://portal.acm.org/citation.cfm?id=957341)获得，这表明两者之间几乎没有区别。我看到的两者之间的很多争论都集中在 Windows 作为服务器技术的弱点（真实的或感知的）上。
*   **Java 世界有什么而不​​是 WF/WPF/WCF**：现在，在我看来，Java 世界比 MS 有真正的好处。那里有无数的框架，所以你一定会找到适合你需要的东西（免费！）。您可以使用 Spring MVC 或 Struts 2.0 或 Wicket。对于您的数据库层，您可以选择 Hibernate 或 Ibatis。查看[此](http://en.wikipedia.org/wiki/List_of_Web_service_Frameworks)Web 服务框架列表。Java 总共列出了九个框架。微软有一个：WCF。
*   **LINQ 的 Java 等价物**：同样，有人可以纠正我，但我不确定是否有等价物。优势微软。
*   **ADO.NET 数据服务**：这在 Java 中通过 JPA 和 RESTful Web 服务是可行的，但我想在 MS 世界中实现起来要容易一些。

在另一个领域，我认为微软正在超越 Java 社区：他们正在对函数式编程进行一些明智的投资，而 Java 人员则在毫无意义地争论向 Java 添加闭包的最佳方式。同样，还有一些新兴技术——OSGi，即——来处理大量 Java 框架所涉及的压倒性复杂性。由于 MS 对其领域有更严格的控制，因此他们更容易处理各种组件。

然后是人为因素：你可以找到谁来工作什么技术以及招聘 X 的成本与招聘 Y 的成本相比。但无论你选择什么，这都是事实。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T13:49:48.997

很难找到关于这方面的好信息，更难找到最新的信息。其中大部分是关于 .NET 1.1 或 2.0。

无论如何，我将在这里提供一些您可能感兴趣的链接：

*   [http://www.artima.com/intv/anders.html](http://www.artima.com/intv/anders.html) - 采访 C# 编程语言的首席设计师 Anders Hejlsberg
*   [http://www.25hoursaday.com/CsharpVsJava.html](http://www.25hoursaday.com/CsharpVsJava.html) - Dare Obasanjo 的“从 Java 开发人员的角度看 C#”
*   [http://benpryor.com/blog/2006/05/04/jvm-vs-clr-memory-allocation/](http://benpryor.com/blog/2006/05/04/jvm-vs-clr-memory-allocation/) - JVM vs CLR 内存分配
*   [http://sharptoolbox.com/categories](http://sharptoolbox.com/categories) - .NET 的工具、库和框架列表
*   [http://javatoolbox.com/categories](http://javatoolbox.com/categories) - J2EE 的工具、库和框架列表
*   [http://en.wikipedia.org/wiki/Comparison_of_the_Java_and_.NET_platforms](http://en.wikipedia.org/wiki/Comparison_of_the_Java_and_.NET_platforms) - 维基百科对 Java (JVM) 和 .NET 的比较
*   [http://en.wikipedia.org/wiki/Comparison_of_Java_and_C_Sharp](http://en.wikipedia.org/wiki/Comparison_of_Java_and_C_Sharp) - 维基百科对 Java 和 C# 的比较

希望能帮助到你！每当我停下来一些有用的信息时，我都会不断更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-14T03:01:40.983

我是一名做过 C++、Java 和现在 C# 开发的程序员。

这是我对最初问题的回答：

WCF = EJBS/J2EE 服务器（例如 JBoss）

WPF = Swing (JavaFX)

JBoss = 我认为 WCF 不需要服务器，只需在 .net 运行时中运行。虽然不确定，但仍在学习中。JVM vs CLR：CLR 可以做 JVM 可以做的所有事情，但 CLR 还可以：运行非托管代码，将一个进程分成多个逻辑进程（AppDomains）。与 java 相比具有非常好的 C++ 集成，CLR 更好。语言 c# 也比 java 更好（Lambda、delegates、表达式树、引用、结构、扩展方法、部分类、没有装箱的泛型。他们在这里做得很好！）但只能在 Windows 上运行。

WF=不知道是否存在，可能

Linq = 目前无法在 Java 中实现，因为您需要：Lambda、表达式树和扩展方法

ADO.net dataservices：我不知道java中有什么类似的东西，但这很容易实现。可能存在于一些开源项目中。

完成这两项工作后，我得出了关于它们之间关系的结论：

.net 更容易学习，非常容易学习，但同样强大。这样做的原因是因为 api 中方法的命名更加一致，解决方案更好地集成，并且一些 api 的设计更好（WPF 就是一个例子，不能对其他 api 这么说，仍在学习中）。因此，.net 程序员的成本会更低。

使用 c# 开发应用程序将比使用 Java 快 1.5 到 2 倍。有IDE（视觉工作室）感觉更好。您可以在 20 分钟内延长它，不废话！试图理解 eclypse 扩展机制并不是一件容易的事！Eclipse 代码重构功能占了上风。Visual Studio 胜过许多其他人。（商业插件可能可用？）

使用 .Net 时，您可能需要为操作系统和 IIS 支付许可证费用。对于数据库，您可以使用 MySQL。

对于java，您不必支付许可证。但实际上你可能仍然必须这样做。严肃的应用程序运行 Redhad 或其他一些非免费操作系统。Web 服务器可能是完全免费的。此外，这些系统更难管理，因此您的管理员可能会花费更多。

我是一名经过 Java 认证的开发人员（92%），也是经过 Web 服务认证（JSP、servlet，87%）和 Web 组件开发人员认证（EJB，82%）的。我也是微软认证开发人员 (90%) 和认证 WPF 开发人员 (90%)。Java考试比微软考试难。这是因为java考试会问很多幼稚的无关问题。比如持久化对象的正确方法名称是什么：SaveChanges()、PersistChanges()、EmitChanges() 或 SendChangesToDatabase()。任何人都知道知道方法名称是没有用的。您的 IDE 将为您提供正确的名称。而且，如果您真的拥有彼此如此相似的方法名，那么您的 api 就会非常糟糕且令人困惑！重要的是你知道你为什么叫它！微软考试更多地关注为什么、如何。在我看来，微软考试真的可以帮助你成为一个更好的程序员。Java 考试也很有用，但更像是研究电话簿；这很难但没用。

总而言之，我相信 C# 在技术上是超凡的（这是合乎逻辑的，因为他们从 Java 中学到了很多东西，并请来了世界上最聪明的人来编写它）。您将在许可证上支付更多费用，但在人员上可能会更少。

时间不早了，累了，不想再读了。我应该，我知道。但不会。我这里没有拼写检查器，所以可能有很多错字。我的第一个是语言是荷兰语，我的第二个是法语，我的第三个是英语（我住在比利时，我们很复杂），所以我想我可以输入一些错字，对吧？:)

希望这可以为您提供一些清晰的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T22:42:00.227

在 rtperson 的帖子上：

.NET 有 NHibernate 和 iBatis.NET。看起来不如他们的 Java 同行，但已经足够好了。

事实上，在 .NET 方面有很多开源项目：Castle Project（MVC、IoC）、NUnit、Spring.NET……别忘了 Mono 作为核心 .NET 框架的开源实现.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T16:06:41.717

IMO 有太多的 Java 框架。几十个 Linux 发行版也有同样的问题......

当然可以对 .NET 说同样的话，但它更清楚。那是我的 .02

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-23T23:41:37.250

你见过这些吗？

[http://en.wikipedia.org/wiki/.NET%5FFramework#.NET%5Fvs.%5FJava%5Fand%5FJava%5FEE](http://en.wikipedia.org/wiki/.NET%5FFramework#.NET%5Fvs.%5FJava%5Fand%5FJava%5FEE)

[http://en.wikipedia.org/wiki/Comparison%5Fof%5Fthe%5FJava%5Fand%5F.NET%5Fplatforms](http://en.wikipedia.org/wiki/Comparison%5Fof%5Fthe%5FJava%5Fand%5F.NET%5Fplatforms)

[http://en.wikipedia.org/wiki/Comparison%5Fof%5FC%5FSharp%5Fand%5FJava](http://en.wikipedia.org/wiki/Comparison%5Fof%5FC%5FSharp%5Fand%5FJava)

# css - 相同的样式表会在不同的页面上多次加载吗？

> ID：515400
> 
> 赞同：0
> 
> 时间：2009-02-05T10:50:49.000
> 
> 标签：css, browser

我在一个大型 Intranet 系统上工作——因为它是一个十多年前开始的进化系统，不幸的是它的设计不是很好，需要完全重写，因为它目前通过使用框架来工作。

基于框架的布局的问题在于，有一个“主要”部分包含样式表。这是一个非常简单的问题，但我从未找到任何证据。同一个样式表是否因为位于不同的网页上而被多次加载？或者浏览器是否缓存它并与同名样式表进行比较检查。JavaScript 库也是这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T10:54:46.153

是的，浏览器将从缓存中为每一帧加载外部脚本和样式表，除非您故意通过发送带有这些文件的无缓存标头来破坏它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T10:55:12.610

AFAIK 浏览器应始终在发出 http 请求（GET）之前查询其缓存。
“总是”是一个有效的词，因为我们都知道浏览器应该做什么和不应该做什么的问题！
此规则应适用于浏览器请求的任何文件类型。

# nhibernate - NHibernate - 无映射加入

> ID：515406
> 
> 赞同：3
> 
> 时间：2009-02-05T10:51:29.247
> 
> 标签：nhibernate, join, reference, mapping

是否可以在没有指定映射的情况下加入两个类（使用 Criteria API）？

我必须加入两个类并从两者中检索数据，但我无法映射它们。我只知道第一类中的外键*SomeID*和第二类中的主键*ID*。

如何创建加入他们的标准？没有映射可以吗？

请帮助，我真的需要它，但我被卡住了。：/

附言

*我知道“任何”映射，但我有 10 个字段，例如 SomeID。只为创建连接创建 10 个字段的任何映射是多余的。如果没有其他解决方案，我会这样做，但我不想这样做。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T11:36:27.440

我不知道标准版本，但在 HQL 中你可以这样做：

```
select customer, order from Customer customer, Order order 
    where order.CustomerID = customer.Id
    and customer.Id = 42 
```

然后，结果集将是一个 object[] 列表，其中客户将重复多次他下的订单数（当然假设有一个客户对多个订单）。

请注意，如果没有任何订单，结果将为空。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:08:39.120

如果您不想或无法在实体中定义关联属性（例如在支持插件动态加载的模块化应用程序中），您仍然可以使用 Fluent api 创建“假”关联。

请参阅 Orchard 源代码，“ContentItemAlteration”类。在 Orchard 中，希望将 ContentItem 实体与存储在不同表中的 ContentPart 记录连接起来。每个 ContentPart 类型都由模块提供，这意味着很难（并且可能不是首选）更改 ContentItem 的源并为每个新部分记录添加关联。

这是我从 Orchard 来源获得的确切代码：

```
/// <summary>
    /// Add a "fake" column to the automapping record so that the column can be
    /// referenced when building joins accross content item record tables.
    /// <typeparam name="TItemRecord">Either ContentItemRecord or ContentItemVersionRecord</typeparam>
    /// <typeparam name="TPartRecord">A part record (deriving from TItemRecord)</typeparam>
    /// </summary>
    class Alteration<TItemRecord, TPartRecord> : IAlteration<TItemRecord> {
        public void Override(AutoMapping<TItemRecord> mapping) {

            // public TPartRecord TPartRecord {get;set;}
            var name = typeof(TPartRecord).Name;
            var dynamicMethod = new DynamicMethod(name, typeof(TPartRecord), null, typeof(TItemRecord));
            var syntheticMethod = new SyntheticMethodInfo(dynamicMethod, typeof(TItemRecord));
            var syntheticProperty = new SyntheticPropertyInfo(syntheticMethod);

            // record => record.TPartRecord
            var parameter = Expression.Parameter(typeof(TItemRecord), "record");
            var syntheticExpression = (Expression<Func<TItemRecord, TPartRecord>>)Expression.Lambda(
                typeof(Func<TItemRecord, TPartRecord>),
                Expression.Property(parameter, syntheticProperty),
                parameter);

            mapping.References(syntheticExpression)
                .Access.NoOp()
                .Column("Id")
                .ForeignKey("none") // prevent foreign key constraint from ContentItem(Version)Record to TPartRecord
                .Unique()
                .Not.Insert()
                .Not.Update()
                .Cascade.All();
        }
    } 
```

此代码只是向 ContentItem 添加了一个“部分”关联，使您能够在您的条件中使用连接。例如，如果您有一个名为“ProductPart”的部件存储在一个名为“ProductPartRecord”的表中，那么您可以在假属性“ProductPartRecord”上加入您的 ContentItem。

By the way, it seems this tactic can also be applied to HasMany side of the fake relation but you have to customize the Fluent sources I suppose.

# lambda-calculus - 有哪些学习 Lambda 演算的资源？

> ID：515413
> 
> 赞同：57
> 
> 时间：2009-02-05T10:54:21.567
> 
> 标签：lambda-calculus

所以关于[Lambda Calculus](http://en.wikipedia.org/wiki/Lambda_calculus)的维基百科条目很有趣，但我已经完成了。我希望深入一点，更好地理解 Lambda 演算。

任何人都可以推荐他们认为是 Lambda 微积分最好的书或入门书吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-05T11:02:13.860

如果您已完成 Wikipedia 条目，请按照其链接访问[计算机程序的在线结构和解释](http://mitpress.mit.edu/sicp/)，完成作业或阅读[本书](http://web.mit.edu/alexmv/6.037/sicp.pdf)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-05T11:42:56.070

好吧，总有[Lambda 演算简介](http://web.archive.org/web/20170809103332if_/http://gpl.internetconnection.net/mirror-lambda-calculus.pdf)。我已经尝试阅读它几次，但总是卡住。我有一种挥之不去的感觉，我已经知道大部分这些东西，如果它是用 Lisp/Scheme 而不是数学来呈现的，可能会更容易理解它。不过，你可能会有更好的运气:)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-05T11:30:54.363

我发现Chris Hankin 的“[计算机科学家的 Lambda Calculi 简介](https://rads.stackoverflow.com/amzn/click/com/0954300653)”非常好，但我只将它用于一门课程 - 并没有在现实世界中使用它 :)

[![替代文字](https://i.stack.imgur.com/9ZJY6.jpg)](https://i.stack.imgur.com/9ZJY6.jpg)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-05T12:15:34.693

我认为关于 lambda 演算本身的参考仍然是[Barendregt 的书](https://rads.stackoverflow.com/amzn/click/com/0444875085)。

[![替代文字](https://i.stack.imgur.com/LqpEM.jpg)](https://i.stack.imgur.com/LqpEM.jpg)

除此之外，它几乎取决于您对 lambda 演算的哪个“部分”感兴趣：打字？证明理论？术语重写？函数式编程？

每一个本身就是一个领域，我不知道有什么书能涵盖这一切。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-05T16:38:01.700

尝试编写一个 lambda 演算解释器，最好是使用语言的内置语法而不是通过解析器使用函数式语言。这是一种非常简单的方法，也是改善您对它的感觉的好方法。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-09-27T11:14:49.110

我最近从 Amazon 买了一本 Greg Michaelson 的书，名为[“An Introduction to Functional Programming Through Lambda Calculus”](https://rads.stackoverflow.com/amzn/click/com/0486478831)。它更多的是对函数式编程的介绍，还介绍了 lambda 演算。第一印象相当不错。一本独立且易于阅读的书。[在这里](http://www.macs.hw.ac.uk/~greg/books/)，您可以下载 PostScript 中没有索引的免费版本。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-03-15T15:21:33.727

真正让我开始使用和理解 lambda 演算的书是 Blackburn 和 Bos 的《自然语言的表示和推理》。这是一本关于使用 Prolog 进行自然语言处理的书。您可能会考虑的另一本书是艾伦的“自然语言理解”。最后，如果你喜欢 lambda 演算，你可能也会喜欢组合逻辑，因为组合子可以定义为 lambda 表达式。为此，我强烈推荐 Smullyan 的谜题书“To Mock A Mockingbird”。最后，他使用组合器构建了一种基本的编程语言。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-12-17T01:00:50.633

这是一个很好的解释（使用方案）：[http ://www.cs.brown.edu/courses/cs173/2002/Lectures/2002-10-28-lc.pdf](http://www.cs.brown.edu/courses/cs173/2002/Lectures/2002-10-28-lc.pdf)

这是一个漂亮的位（来自我的博客），将递归阶乘减少为纯 lambda：http: [//blogs.msdn.com/b/ashleyf/archive/2008/12/03/the-lambda-calculus.aspx](http://blogs.msdn.com/b/ashleyf/archive/2008/12/03/the-lambda-calculus.aspx)

玩得开心！

# javascript - 如何从 Java 小程序访问 JavaScript 中定义的对象/数组

> ID：515417
> 
> 赞同：1
> 
> 时间：2009-02-05T10:56:27.367
> 
> 标签：javascript, java, applet

使用窗口 JSObject 的 LiveConnect getMember(String) 方法，返回“Object”类型的 Java 对象，但我没有找到在其上定义的预期成员。我也不能将其转换为 JSObject 以继续使用 getMember()。

访问 DOM 节点和元素（DOM 对象）按预期工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T14:37:11.600

我被这条线弄糊涂了`got2 = win.getMember("obj");`。似乎您希望该行能够获取`foo`对象。据我了解，`win.getMember("obj")`将为您`obj`提供 DOM`window`节点上不存在的属性。例如，从此[页面](http://java.sun.com/j2se/1.4.2/docs/guide/plugin/developer_guide/java_js.html#how)：

```
JSObject win = JSObject.getWindow(this);
JSObject doc = (JSObject) win.getMember("document");
JSObject loc = (JSObject) doc.getMember("location"); 
```

如果您想获取该`foo`对象，我知道的最好方法是创建一个可以从 Java 小程序调用的 JavaScript 方法。

**JavaScript：**

```
<script type="text/javascript">
var foo = {"one":1, "two":2};

function getFoo() { return foo; }
</script> 
```

**小程序：**

```
import netscape.javascript.*;
JSObject win;
JSObject foo;

void setup(){
  size(400,200,P2D);
  background(255);
  win  = JSObject.getWindow(this); //gets the root JSObject
  foo = (JSObject)win.call("getFoo", null);
}

void draw(){
  if (mousePressed == true){
    println(foo.getMember("one"));
  }
} 
```

# java - 组合多个罐子的清洁方法？最好使用 Ant

> ID：515428
> 
> 赞同：62
> 
> 时间：2009-02-05T11:01:13.643
> 
> 标签：java, ant, jar

我对一些外部 jar 有运行时依赖项，我想将它们“重新压缩”到单个 jar 中。这些外部依赖项存储在 external_jars 目录中，我希望不必将它们全部列出（即，如果我的依赖项发生更改，则无需更改构建脚本）。有什么想法吗？

谷歌给了我一个关于如何做到这一点的好答案——如果你不介意将每个 jar 列为依赖项：

[http://markmail.org/message/zijbwm46maxzzoo5](http://markmail.org/message/zijbwm46maxzzoo5)

粗略地说，我想要以下内容，它将 lib 目录中的所有 jar 合并到 out.jar 中（带有一些理智的覆盖规则）。

```
jar -combine -out out.jar -in lib/*.jar 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-10-24T21:14:27.143

弗拉基米尔的回答是正确的，但我觉得他的建议意味着将所有罐子重新包装在一个大的 out.jar 中，然后将其作为单个`<zipfileset>`或类似的东西提供给 Ant Jar 任务。这种两步法是不必要的。我不确定这是否与 Ant 版本有关，但我有 Ant 1.7.1，它的`<jar>`任务理解`<zipgroupfileset>`，它允许直接提供第三方 jar 的所有内容。

```
<jar destfile="MyApplication.jar">
  <zipgroupfileset dir="lib" includes="*.jar" /> 
  <!-- other options -->
  <manifest>
    <attribute name="Main-Class" value="Main.MainClass" />
  </manifest>
</jar> 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-02-05T21:38:14.403

只需`zipgroupfileset`与 Ant [Zip 任务一起使用](http://ant.apache.org/manual/Tasks/zip.html)

```
<zip destfile="out.jar">
    <zipgroupfileset dir="lib" includes="*.jar"/>
</zip> 
```

这将展平所有包含的 jar 库的内容。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-02-05T11:03:41.593

你可以查看jarjar：

[http://code.google.com/p/jarjar/](http://code.google.com/p/jarjar/)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-05T12:55:14.677

尝试先将您的 JAR 提取到编组目录：

```
<target name="combine-jars">
    <mkdir dir="${marshall.dir}"/>
    <unzip dest="${marshall.dir}">
        <fileset dir="${external.jar.dir}">
            <include name="**/*.jar"/>
        </fileset>
    </unzip>
    <jar destfile="${combined.jar}" basedir="${marshall.dir"}>
    <delete dir="${marshall.dir}"/>
</target> 
```

where`${marshall.dir}`是一个临时目录，`${external.jar.dir}`是您保存 JAR 的位置，并且`${combined.jar}`是目标 JAR。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-01-31T15:15:34.007

如果使用maven，你为什么不呢？:) 只需使用 maven-shade-plugin，就像一个魅力！

```
 <project>
  ...
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-shade-plugin</artifactId>
        <version>1.5</version>
        <executions>
          <execution>
            <phase>package</phase>
            <goals>
              <goal>shade</goal>
            </goals>
            <configuration>
              <transformers>
                <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                  <mainClass>com.YOUR_COMPANY.YOUR_MAIN_CLASS</mainClass>
                </transformer>
              </transformers>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
  ...
</project> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-01-14T13:40:38.933

这是我的解决方案：

```
<target name="-post-jar">
    <echo>Packaging ${application.title} into a single JAR</echo>

    <jar destfile="${basedir}${file.separator}${dist.dir}${file.separator}_${ant.project.name}_.jar">
        <zipgroupfileset dir="${basedir}${file.separator}${dist.dir}" includes="${ant.project.name}.jar"/>
        <zipgroupfileset dir="${basedir}${file.separator}${dist.dir}${file.separator}lib" includes="*.jar"/>
        <manifest>
            <attribute name="Main-Class" value="${main.class}"/>
        </manifest>
    </jar>
</target> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-03-14T05:11:59.400

这个问题很好回答。我想提一个我觉得有用的工具 - [One-Jar](http://one-jar.sourceforge.net)。One-Jar 更干净地处理资源（通过保留所有资源）。如果代码需要[处理 MANIFEST 文件，这将更加有用。](http://one-jar.sourceforge.net/index.php?page=details&file=resources)

从网站复制的示例 XML..

```
<import file="one-jar-ant-task.xml"/>   

    <target name="hello" depends="init">
        <!-- Build lib.jar -->   
        <javac destdir="${classes.dir}/lib">
            <src path="${lib.dir}" />
        </javac>
        <jar destfile="${build.dir}/lib.jar" >
            <fileset dir="${classes.dir}/lib"/>
        </jar>   
        <!-- Build classes for main.jar -->   
        <javac destdir="${classes.dir}/src">
            <src path="${src.dir}" />
            <classpath path="${build.dir}/lib.jar"/>   
        </javac>
        <!-- Construct the One-JAR file -->   
        <one-jar destfile="hello.jar" manifest="hello.mf">
            <main>
                <!-- Construct main.jar from classes and source code -->
                <fileset dir="${classes.dir}/src"/>
            </main>
            <lib>
                <fileset file="${build.dir}/lib.jar" />
            </lib>
        </one-jar>
        <echo>
          Now you can run the Hello One-JAR example using 
          $ java -jar hello.jar
        </echo>   

    </target> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-25T18:41:33.940

如果您正在使用 ant 构建（我正在使用来自 eclipse 的 ant），您可以通过告诉 ant 添加额外的 jar 文件来添加它们......如果您有一个由多人维护的项目，这不一定是最好的方法，但它可以工作对于一个人的项目，很容易。

例如，我构建 .jar 文件的目标是：

```
<jar destfile="${plugin.jar}" basedir="${plugin.build.dir}">
    <manifest>
        <attribute name="Author" value="ntg"/>
        ................................
        <attribute name="Plugin-Version" value="${version.entry.commit.revision}"/>
    </manifest>
</jar> 
```

我只是添加了一行来实现它：

```
<jar ....">
    <zipgroupfileset dir="${external-lib-dir}" includes="*.jar"/>
    <manifest>
        ................................
    </manifest>
</jar> 
```

在哪里

```
<property name="external-lib-dir" value="C:\...\eclipseWorkspace\Filter\external\...\lib" /> 
```

是带有外部罐子的目录。就是这样……您也可以添加多个 zipgroupfileset 标签。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-05T18:50:32.883

您是否考虑过使用[Maven](http://maven.apache.org/)或其他自动管理依赖项的系统？然后，您无需指定每个库的位置、它们的名称以及您的直接依赖项具有哪些传递依赖项。您只需在一处说明依赖项及其版本是什么，系统将负责下载库、配置类路径和构建项目。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-18T03:57:26.060

好吧，我不太喜欢编程 - 但更简单的东西对我有用......如果问题意味着 - 将 jar 文件合并为一个。当然，这是手动的、肮脏的解决方案。我只是解压缩了所有的 tar 文件……然后……创建了一个新的 tar 文件，方法是将 untarring- 形成的所有目录添加到新的 tar 文件中。有效。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-04-15T08:56:47.987

Maven 或其他构建工具无法“管理”多个版本的类文件的解析。事实上，Maven 首先通过传递包含项目未明确要求的所有下游 jar 文件来导致这些问题。

假设在一个项目的传递闭包中（项目所需的所有库和模块，以及所有它的依赖项目，递归地）有两个版本的类文件。Maven 怎么可能知道哪一个是“正确的”？程序员想要的是哪一个？

不能，因为当显式依赖被丢弃以支持传递依赖（以节省 XML 类型）时，此信息丢失了。

# sql - 如何在 SQL Server 2005 中的 INSERT 和 UPDATE 上舍入定义为浮点数的列

> ID：515429
> 
> 赞同：0
> 
> 时间：2009-02-05T11:01:21.443
> 
> 标签：sql, sql-server, triggers, rounding, insert-update

我正在研究一个使用*浮点*数据类型来存储应该只有两位小数（美元和美分）的值的数据库。

只要更新 float 列的人执行 ROUND，使用 float 似乎可以正常工作。当然，这并不总是发生，然后当 SUM 完成时，它总是与显示的内容相差几美分，因为显示被格式化为仅显示两个小数位。该数据库有数百个使用浮点数的表，能够自动对浮点数列进行舍入会很有帮助。

这可以做到吗？

可以在 INSERT 和 UPDATE 上使用 TRIGGER 在列上执行 ROUND 吗？

如果可以，您能否展示如何编写 TRIGGER 代码并推荐它？

还有其他想法吗？

我们正在使用[SQL Server 2005](https://en.wikipedia.org/wiki/History_of_Microsoft_SQL_Server#SQL_Server_2005)。

这是一篇提出问题的帖子，*[会计应用程序美元金额使用浮点数还是小数？](https://stackoverflow.com/questions/61872/use-float-or-decimal-for-accounting-application-dollar-amount)*，我喜欢这样的一个回应

> “您真的应该考虑使用某种类型的定点/任意精度数字包（例如，Java BigNum、python 十进制模块），否则您将陷入**痛苦的世界**”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T11:05:12.917

你可以做触发器，这根本不是不合理的使用它们。预插入和预更新触发器应该可以正常工作。

此外，您可以进行一次性修复，例如：

```
update tbl set column = round(column * 100) / 100 
```

语法可能并不完美，但你应该明白。

但我不确定我是否理解您的“差了几分钱”的话。**您必须将相当多**的浮点数相加才能使错误累积到 0.01。您使用的列定义是什么？

当然，货币类型的十进制列定义之一会更好地获得完美的准确性，但您可能会失去 DBMS 之间的可移植性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T11:15:45.500

如果您可以控制系统，是否可以使用 DECIMAL /MONEY/NUMERIC 数据类型而不是 FLOAT？

毕竟，这是您提到的问题的重点。

如果不是这样，并且像我们许多人一样，您被迫生活在那个痛苦的世界中，那么您的触发建议会起作用。但是，我更愿意以不同的方式控制它...
- 不允许应用程序或用户直接对表进行写访问
- 通过 SP 强制访问

我还看到了一个系统，其中对一个（输入/保持）表进行了写访问。然后，该表上有一个触发器，可以将数据复制（并格式化/验证）到真实表中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T13:16:16.257

我不认为你可以通过四舍五入得到你想要的。对浮点数进行四舍五入将无法准确可靠地工作：无论您做什么，您都将尝试对二进制数应用十进制四舍五入，而除了 2 的幂之外，这对任何东西都不准确。

您只能通过使用专门为此目的设计的十进制数据类型来获得任意子整数数量的准确数据库存储的十进制表示。这些数据类型通常使用某种形式的压缩十进制存储（效率低于二进制），例如 2009 存储为`0x2009`.

如果使用[CONVERT](http://msdn.microsoft.com/en-us/library/ms187928.aspx)函数会发生什么？您是否尝试过使用类似的查询？

```
CONVERT(money, your_float_column) 
```

从长远来看，我想我会考虑在我的表中添加一个具有所需类型的列，并通过插入后/更新触发器维护其值，然后随着时间的推移切换我的所有代码以使用该列。

然后我会追捕并惩罚那些认为将金额存储在浮动中是个好主意的人......

# c# - 如何获得*互联网* IP？

> ID：515436
> 
> 赞同：15
> 
> 时间：2009-02-05T11:02:49.303
> 
> 标签：c#, networking

想象一个情况，我有两张网卡的电脑，一张连接到互联网，另一张连接到本地网络，我如何检测使用 C# 连接到互联网的 IP？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-05T11:59:56.643

试试这个：

```
static IPAddress getInternetIPAddress()
{
    try
    {
        IPAddress[] addresses = Dns.GetHostAddresses(Dns.GetHostName());
        IPAddress gateway = IPAddress.Parse(getInternetGateway());
        return findMatch(addresses, gateway);
    }
    catch (FormatException e) { return null; }
}

static string getInternetGateway()
{
    using (Process tracert = new Process())
    {
        ProcessStartInfo startInfo = tracert.StartInfo;
        startInfo.FileName = "tracert.exe";
        startInfo.Arguments = "-h 1 208.77.188.166"; // www.example.com
        startInfo.UseShellExecute = false;
        startInfo.RedirectStandardOutput = true;
        tracert.Start();

        using (StreamReader reader = tracert.StandardOutput)
        {
            string line = "";
            for (int i = 0; i < 9; ++i)
                line = reader.ReadLine();
            line = line.Trim();
            return line.Substring(line.LastIndexOf(' ') + 1);
        }
    }
}

static IPAddress findMatch(IPAddress[] addresses, IPAddress gateway)
{
    byte[] gatewayBytes = gateway.GetAddressBytes();
    foreach (IPAddress ip in addresses)
    {
        byte[] ipBytes = ip.GetAddressBytes();
        if (ipBytes[0] == gatewayBytes[0]
            && ipBytes[1] == gatewayBytes[1]
            && ipBytes[2] == gatewayBytes[2])
        {
            return ip;
        }
    }
    return null;
} 
```

请注意，此实现`findMatch()`依赖于 C 类匹配。如果要支持 B 类匹配，只需省略对`ipBytes[2] == gatewayBytes[2]`.

**编辑历史：**

*   更新使用`www.example.com`。
*   更新为 include `getInternetIPAddress()`，以显示如何使用其他方法。
*   更新以捕获`FormatException`无法`getInternetGateway()`解析网关 IP。（如果网关路由器配置为不响应[跟踪路由](http://en.wikipedia.org/wiki/Traceroute)请求，则可能发生这种情况。）
*   引用了 Brian Rasmussen 的评论。
*   更新为使用 www.example.com 的 IP，这样即使 DNS 服务器关闭，它也能正常工作。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-11-18T16:36:49.103

我建议使用这个简单的代码，因为`tracert`它并不总是有效的，而且 whatsmyip.com 也不是专门为此目的设计的：

```
private void GetIP()
{
    WebClient wc = new WebClient();
    string strIP = wc.DownloadString("http://checkip.dyndns.org");
    strIP = (new Regex(@"\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b")).Match(strIP).Value;
    wc.Dispose();
    return strIP;
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-05T11:06:14.350

互联网连接必须与默认网关位于同一 IP 网络上。

没有办法从 IP 地址判断您是否可以访问“互联网”，这确实是万无一失的。基本上，您可以与自己的 IP 网络进行通信。其他一切都必须通过网关。因此，如果您看不到网关，您将被限制在本地 IP 网络中。

但是，网关依赖于其他网关，因此即使您可以访问网关，您也可能无法访问其他网络。这可能是由于例如过滤或缺少到所需网络的路由。

实际上，从这个意义上谈论互联网是没有意义的，因为您可能永远无法在任何特定时刻访问整个互联网。因此，找出您需要能够到达并验证该网络的连接性。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-12-07T11:49:13.403

这是我尝试获取默认 IPv4 地址，而无需求助于 DNS 或外部进程调用诸如 ipconfig 和 route 之类的命令。希望 .Net 的下一个版本将提供对 Windows 路由表的访问。

```
public static IPAddress GetDefaultIPv4Address()
{
    var adapters = from adapter in NetworkInterface.GetAllNetworkInterfaces()
                   where adapter.OperationalStatus == OperationalStatus.Up &&
                    adapter.Supports(NetworkInterfaceComponent.IPv4)
                    && adapter.GetIPProperties().GatewayAddresses.Count > 0 &&
                    adapter.GetIPProperties().GatewayAddresses[0].Address.ToString() != "0.0.0.0"
                   select adapter;

     if (adapters.Count() > 1)
     {
          throw new ApplicationException("The default IPv4 address could not be determined as there are two interfaces with gateways.");
     }
     else
     {
         UnicastIPAddressInformationCollection localIPs = adapters.First().GetIPProperties().UnicastAddresses;
         foreach (UnicastIPAddressInformation localIP in localIPs)
         {
            if (localIP.Address.AddressFamily == AddressFamily.InterNetwork &&
                !localIP.Address.ToString().StartsWith(LINK_LOCAL_BLOCK_PREFIX) &&
                !IPAddress.IsLoopback(localIP.Address))
            {
                return localIP.Address;
            }
        }
    }

    return null;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T11:05:33.167

一种骇人听闻的方法是获取和抓取众多“我的 IP 是什么”类型的网站之一。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-05T11:07:10.713

不是 100% 准确（某些 ISP 不给您公共 IP 地址），但您可以检查 IP 地址是否在为私有地址保留的范围之一。见[http://en.wikipedia.org/wiki/Classful_network](http://en.wikipedia.org/wiki/Classful_network)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-05T11:18:59.690

这是一篇可能会有所帮助的文章：

[如何在 C# 中检索“网络接口”](http://www.codeguru.com/csharp/csharp/cs_network/internetweb/article.php/c6023/)

> 以下代码用于检索 C# 中的“网络接口”。您可能会将“网络接口”识别为“网络和拨号连接”：您可以使用“开始 > 设置 > 网络和拨号连接”来访问它们。C# 不提供检索此列表的简单方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-05T12:07:54.833

我找到了一个解决方案：

```
IPGlobalProperties ipProperties = IPGlobalProperties.GetIPGlobalProperties();
Console.WriteLine(ipProperties.HostName);

        foreach (NetworkInterface networkCard in NetworkInterface.GetAllNetworkInterfaces())
        {
            foreach (GatewayIPAddressInformation gatewayAddr in networkCard.GetIPProperties().GatewayAddresses)
            {
                Console.WriteLine("Information: ");
                Console.WriteLine("Interface type: {0}", networkCard.NetworkInterfaceType.ToString());
                Console.WriteLine("Name: {0}", networkCard.Name);
                Console.WriteLine("Id: {0}", networkCard.Id);
                Console.WriteLine("Description: {0}", networkCard.Description);
                Console.WriteLine("Gateway address: {0}", gatewayAddr.Address.ToString());
                Console.WriteLine("IP: {0}", System.Net.Dns.GetHostByName(System.Net.Dns.GetHostName()).AddressList[0].ToString());
                Console.WriteLine("Speed: {0}", networkCard.Speed);
                Console.WriteLine("MAC: {0}", networkCard.GetPhysicalAddress().ToString());
            }
        } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-05T11:06:12.353

我已经搜索过了，我在这个 codeplex 项目[http://www.codeplex.com/xedus](http://www.codeplex.com/xedus)中找到了它。它是一个无法正常工作的 P2P 免费软件，但有一个类使用正确的 API 来获取具有互联网 IP 的网卡女巫

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-05T11:09:18.603

为了快速破解（这肯定会被复杂的 LAN 配置或 IPv6 破坏），获取当前机器拥有的所有 IP 的列表，并删除与以下任何匹配的所有 IP：

```
10.*
127.* // <- 感谢 Brian 发现错误
172.[16-31].*
192.168.*

```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-12-07T12:03:40.667

使用跟踪器。第一个跃点应始终与您的 Internet NIC 位于同一子网中。

命令提示符下的示例。

```
tracert google.com 
```

第一行是 10.0.0.254，我的网卡的 ip 是 10.0.2.48。然后是解析来自tracert的输出的简单练习。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-12-11T11:25:17.437

另一种解决方案（可能更准确）是使用 Windows`route`命令。下面是一些适用于 Windows Vista 的代码：

```
static string getInternetConnectionIP()
{
    using (Process route = new Process())
    {
        ProcessStartInfo startInfo = route.StartInfo;
        startInfo.FileName = "route.exe";
        startInfo.Arguments = "print 0.0.0.0";
        startInfo.UseShellExecute = false;
        startInfo.RedirectStandardOutput = true;
        route.Start();

        using (StreamReader reader = route.StandardOutput)
        {
            string line;
            do
            {
                line = reader.ReadLine();
            } while (!line.StartsWith("          0.0.0.0"));

            // the interface is the fourth entry in the line
            return line.Split(new char[] { ' ' },
                              StringSplitOptions.RemoveEmptyEntries)[3];
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-02-02T22:47:12.480

与我和我的朋友 Lukas Šalkauskas 的方向相同，我编写了以下代码：

```
 /* digged, built and (here and there) copied "as is" from web, without paying attention to style.
    Please, do not shot us for this. 
   */
public static void DisplayIPAddresses() 
    { 

        Console.WriteLine("\r\n****************************"); 
        Console.WriteLine("     IPAddresses"); 
        Console.WriteLine("****************************"); 

        StringBuilder sb = new StringBuilder(); 
        // Get a list of all network interfaces (usually one per network card, dialup, and VPN connection)      
        NetworkInterface[] networkInterfaces = NetworkInterface.GetAllNetworkInterfaces(); 

        foreach (NetworkInterface network in networkInterfaces) 
        { 

            if (network.OperationalStatus == OperationalStatus.Up ) 
            { 
                if (network.NetworkInterfaceType == NetworkInterfaceType.Tunnel) continue; 
                if (network.NetworkInterfaceType == NetworkInterfaceType.Tunnel) continue; 
                //GatewayIPAddressInformationCollection GATE = network.GetIPProperties().GatewayAddresses; 
                // Read the IP configuration for each network    

                IPInterfaceProperties properties = network.GetIPProperties(); 
                //discard those who do not have a real gateaway  
                if (properties.GatewayAddresses.Count > 0) 
                { 
                    bool good = false; 
                    foreach  (GatewayIPAddressInformation gInfo in properties.GatewayAddresses) 
                    { 
                        //not a true gateaway (VmWare Lan) 
                        if (!gInfo.Address.ToString().Equals("0.0.0.0")) 
                        { 
                            sb.AppendLine(" GATEAWAY "+ gInfo.Address.ToString()); 
                            good = true; 
                            break; 
                        } 
                    } 
                    if (!good) 
                    { 
                        continue; 
                    } 
                } 
                else { 
                    continue; 
                } 
                // Each network interface may have multiple IP addresses        
                foreach (IPAddressInformation address in properties.UnicastAddresses) 
                { 
                    // We're only interested in IPv4 addresses for now        
                    if (address.Address.AddressFamily != AddressFamily.InterNetwork) continue; 

                    // Ignore loopback addresses (e.g., 127.0.0.1)     
                    if (IPAddress.IsLoopback(address.Address)) continue; 

                    if (!address.IsDnsEligible) continue; 
                    if (address.IsTransient) continue;  

                    sb.AppendLine(address.Address.ToString() + " (" + network.Name + ") nType:" + network.NetworkInterfaceType.ToString()     ); 
                } 
            } 
        } 
        Console.WriteLine(sb.ToString()); 
    } 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-02-05T11:10:16.777

尝试在两个界面上 ping www.google.com。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-03-08T15:20:41.457

您可以简单地阅读[http://myip.dnsomatic.com/](http://myip.dnsomatic.com/)

这是 OpenDNS 提供的可靠服务，我一直使用它来获取外部 IP。

# language-agnostic - Web 应用程序中常用的键盘快捷键

> ID：515441
> 
> 赞同：5
> 
> 时间：2009-02-05T11:04:16.257
> 
> 标签：language-agnostic, web-applications, keyboard-shortcuts

我正在为 Web 应用程序设置键盘快捷键，我想知道： **什么是最常用的键盘快捷键（在 Web 应用程序中）？**

比如谷歌的gmail和reader使用

> j / k ：上一个/下一个
> o / Enter：打开/展开

这似乎卡住了，但他们也使用

> p/n：上一条/下一条消息

...这对我来说似乎有点尴尬。

您是否在 Web 应用程序中使用键盘快捷键？如果是这样，它们是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T20:14:59.983

我认为最大的关键是不要创建会与常见操作系统或 Web 浏览器的默认行为发生冲突的热键。

这不是一个网络应用程序，但我用于 Visual Studio 的插件具有热键`Alt`+`3`来打开一个特殊窗口。不幸的是，这应该默认打开“监视”窗口。

这些事情会让你的观众发疯......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T20:04:09.227

我认为空格键对于开始/停止有点直观。许多视频播放器（如 Youtube 和 Vimeo）都使用它。任何曾经使用过音频或视频编辑应用程序的人都会习惯这一点。您还可以考虑音频内容的空格键（如音乐播放器）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T20:12:50.393

GMail 使用的是从相对较旧的编辑器继承而来的快捷方式 - vi / 或者它的新变体 - vim (www.vim.org)。这些快捷方式来自旧的键盘设计，这些键上还有箭头键，左，下，上，右......见这里： [http ://en.wikipedia.org/wiki/File:KB_Terminal_ADM3A.svg](http://en.wikipedia.org/wiki/File:KB_Terminal_ADM3A.svg)

在 GMail 中，您可以通过按“？”获得所有快捷方式的列表。

提供更多信息有点困难，因为您没有提及您正在考虑开发哪种网络应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T11:08:46.030

我知道 facebook 有用于在相册中导航图片的键盘快捷键。它的左右箭头键

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T08:49:39.477

`Ctrl`+ `Alt`+`Del`当一些怪胎程序员/设计师创建了另一个“酷”的 Flash 动画，导致 100% 的 CPU 使用率导致浏览器和操作系统几乎没有响应。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T12:00:50.730

除了`Ctrl`+ `X`，`Ctrl`+ `V`，我认为如果你依赖其他任何东西，你会失去大部分观众。

因此，要回答您的问题，操作系统不会解释任何问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-06T08:14:17.150

这个问题很老，但仍然......

你可能想看看这篇关于这个主题的文章：
[https ://medium.com/design-ux/a7c3b7b408ee](https://medium.com/design-ux/a7c3b7b408ee)

而这个：[http ://www.hanselman.com/blog/TheWebIsTheNewTerminalAreYouUsingTheWebsKeyboardShortcutsAndHotkeys.aspx](http://www.hanselman.com/blog/TheWebIsTheNewTerminalAreYouUsingTheWebsKeyboardShortcutsAndHotkeys.aspx)

# wpf - 如何使用 TextWrapping (WPF) 获取 ListView（或 DataGrid）

> ID：515454
> 
> 赞同：2
> 
> 时间：2009-02-05T11:07:46.267
> 
> 标签：wpf, listview, datagrid, word-wrap

我的意思是，我在其中一个列中有一个这样的控件和文本。通常如果用户更改列大小，它只是剪切文本。如果我尝试使用带有文本块或文本框的模板并在模板内设置 TextWrapping="Wrap" - 它真的不会改变任何东西。出路是什么？

*是的，我在询问之前进行了搜索，并在此站点上发现了类似的问题。但没有答案 ((( *

* * *

安迪，谢谢回答，虽然我自己在想它应该那样做。我检查了你的简单变体，它可以工作。虽然我有一个类似的例子，但它没有奏效。唯一的区别是在模板中我使用了我的 UserControl，它在 StackPanel 的 Content 属性中包含 TextBlock 和其他控件。在我理解的代码的不同部分中尝试了 Width、Horizo​​ntalAlignment 等数小时后，我无能为力。然后 - 我刚刚用 Grid 更改了 StackPanel。还有——中提琴！- 有用。我不知道这是一个错误还是只是 StackPanel 的一些特定反应（实际上我在运行时检查了它的参数 - 这很奇怪：ActualWidth 大于面板的 DesiredSize 和实际宽度）。所以，如果有人能告诉我——为什么会这样？- 这会很有趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T23:51:29.907

以下对我有用：

```
<ListView ItemsSource="{Binding Source={StaticResource MyItems}}">
    <ListView.View>
        <GridView>
            <GridViewColumn Width="50" Header="Column 1">
                <GridViewColumn.CellTemplate>
                    <DataTemplate x:Name="col1Template">
                        <TextBlock TextWrapping="WrapWithOverflow" Text="{Binding Path=Column1Text}" />
                    </DataTemplate>
                </GridViewColumn.CellTemplate>
            </GridViewColumn>
            ...
        </GridView>
    </ListView.View>
</ListView> 
```

如果第一列的宽度不足以显示所有文本，这会导致第一列中的文本换行成多行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-28T15:39:33.967

确保您没有定义 datagrid RowHeight，否则它将在文本块被文本包装后覆盖文本块的“真实”高度。

# .net - 如何检查（TCP）套接字是否在 C# 中（断开）连接？

> ID：515458
> 
> 赞同：35
> 
> 时间：2009-02-05T11:09:15.560
> 
> 标签：.net, sockets

我应该如何检查（TCP）套接字以确定它是否已连接？

我已经阅读了[MSDN](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.connected.aspx)`Socket.Connected`中的属性，但它说它只根据最后一次 I/O 显示状态。这对我没有用，因为我想在尝试从套接字读取*之前执行此操作。*备注部分还指出：

 *> 如果您需要确定连接的当前状态，请进行非阻塞、零字节的发送调用。如果调用成功返回或抛出 WAEWOULDBLOCK 错误代码（10035），则套接字仍处于连接状态；否则，套接字不再连接。

同一页面上的示例显示了如何执行此操作。^((1))但是[Ian Griffiths 的一篇文章](http://bytes.com/groups/net-c/258127-how-use-socket-connected-property-properly#post1039238)说我应该从套接字*读取*，而不是通过它*发送。*

[Pete Duniho 的另一篇文章](http://www.eggheadcafe.com/software/aspnet/33035784/cs-socketconnect-retur.aspx#ctl00_MiddleContent_NewsGroupPosts)说：

> ...在您调用 后，一直`Shutdown()`调用`Receive()`直到它返回`0` （假设远程端点实际上不会向您发送任何内容，这将在远程端点收到您的所有数据后立即发生）。除非您这样做，否则您无法保证远程端点实际上已收到您发送的所有数据，即使使用延迟套接字也是如此。

我不太明白他关于调用`Receive()`以确保远程端点确实收到了我*发送*的所有数据的说法。（在发送缓冲区为空之前，套接字是否会阻塞接收？）

我对提出的不同方法感到困惑。你能解释一下吗？

* * *

(1) 我想知道为什么该属性的[示例](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.connected.aspx)`Socket.Connected`分配一个 1 字节数组，即使它`Send`以 0 长度调用？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-05T11:37:17.423

套接字的死亡会以多种方式改变其行为，因此这些方法都是有效的 :)

使用这两种方法，您实际上可以检查在断开连接后发生变化的套接字行为的那些部分。

> 我不太明白他关于调用 Receive() 以确保远程端点实际接收到我发送的所有数据的说法。（在发送缓冲区为空之前，套接字是否会阻塞接收？）

`TCP`是可靠的协议，这意味着您发送的每个数据包都必须得到确认。确认意味着发送`ACK`设置了位的数据包。这些数据包可能包含也可能不包含附加（有效负载）数据。

当套接字连接时，`Receive()`将阻塞直到套接字接收到一个非空有效载荷的数据包。但是当套接字断开时，`Receive()`会在最后一个`ACK`数据包到达时立即返回。

调用`Receive()`可确保您从远程端点*接收*最后一个`ACK`数据包或发生断开连接超时，并且您将无法在此套接字上*接收更多信息。*

> 同一页面上的示例显示了如何执行此操作。（我想知道为什么它分配一个 1 字节数组，即使它以 0 长度调用 Send？）但是 Ian Griffiths 的一篇文章说我应该从套接字读取，而不是通过它发送。

当`send()`ing 到一个套接字时，您实际上是在尝试将一些数据附加到套接字队列的末尾。缓冲区中是否还有一些地方，然后您`Send()`立即返回，如果没有，则`Send()`阻塞直到有某个地方。

当套接字处于断开状态时，`TCP/IP`堆栈会阻止对缓冲区的所有进一步操作，这就是`Send()`返回错误的原因。

`Send()`实现基本的指针检查，这意味着当`NULL`指针传递给它时它会失败。您可能将任何非空常量作为指针传递，但您最好分配 1 个字节而不是创建常量 — 以防万一。

* * *

您可以使用任何您喜欢的方法，因为它们都不消耗资源。只要它们用于套接字连接检查，它们是相同的。

至于我，我更喜欢`Receive()`，因为这是您通常在循环中运行并等待的内容。你得到一个非零`Receive()`，你处理数据；你得到一个零，你处理断开连接。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-08-30T05:41:15.107

"如果需要判断连接的当前状态，进行非阻塞、零字节的Send调用。如果调用成功返回或者抛出WAEWOULDBLOCK错误码（10035），那么socket仍然是连接的；否则，socket是不再连接。” ——不幸的是，它甚至不起作用！

```
mySocket.Blocking = false;
byte[] buffer = new byte[1];
int iSent = mySocket.Send(buffer, 0, SocketFlags.None);
bConnected = mySocket.Connected; 
```

bConnected 总是以 true 结束，并且调用总是成功返回，即使以太网电缆已被拔出。

此外，不幸的是 == 发送任何实际数据也不会检测到断开的连接。

```
buffer[0] = 0xff ;
int iSent = mySocket.Send(buffer, 1, SocketFlags.None); 
```

反复返回 1，就好像真的发送了什么一样。虽然有问题的设备甚至不再连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T11:45:55.503

通常人们会使用 Socket.Select 方法来确定一组套接字的状态（Socket.Poll 用于单个套接字）。

这两种方法都允许您查询套接字的状态。现在，假设您首先跟踪到套接字连接，那么您通常会在尝试读取之前调用套接字上的 Select/Poll。如果 Select/Poll 表明套接字是可读的，这会告诉您：

*   要么套接字具有可用的最高读取数据，在这种情况下，Receive 将返回可读取的数据。
*   套接字套接字已关闭，在这种情况下，当您调用 Receive 时，将立即返回 0 个字节（即，如果 Select/Poll 指示套接字是可读的并且您调用 Receive 但它立即返回 0 个字节，那么您知道连接已已关闭、重置或终止。

就我个人而言，我从未使用过 Poll - 我一直使用 Select，但 MSDN 似乎暗示 Poll 与 Select 几乎相同，只是针对单个套接字。

我还要补充一点，在大多数情况下，使用 Select 是处理 Socket 连接的最有效和最好的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T00:08:30.137

> 我不太明白他关于调用 Receive() 以确保远程端点实际接收到我发送的所有数据的说法。

@PeteDuniho 的帖子不是关于建立连接的状态，而是关于以您知道对等方何时收到您的所有数据的方式终止连接。

> （在发送缓冲区为空之前，套接字是否会阻塞接收？）

不，但是如果您关闭套接字然后读取直到 EOS，您正在等待对等方读取所有数据，直到*他*获得 EOS 然后关闭套接字。因此，您可以保证所有数据都已进入对等应用程序。

# c# - 如何绑定列表 到gridview？

> ID：515464
> 
> 赞同：8
> 
> 时间：2009-02-05T11:10:25.903
> 
> 标签：c#, asp.net, list, gridview

这可能是一个非常奇怪的问题，因为通常人们只将复杂类型绑定到网格视图。但我需要绑定一个 Int 列表（字符串也是如此）。通常，由于要绑定的属性使用对象的属性名称，但是当使用 Int 或 String 时，值正是对象本身，而不是属性。

获取对象值的“名称”是什么？我尝试了“Value”、“”（空）、“this”、“item”，但没有运气。

我指的是网络表单中的网格视图。

**更新**

有一个相关的 Stack Overflow 问题，*[如何将 List 绑定到 GridView](https://stackoverflow.com/questions/5720349/how-to-bind-a-listdatetime-to-a-gridview)*。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-05T12:03:26.590

`<BoundField DataField="!" />`可以解决问题（因为`BoundField.ThisExpression`等于“！”）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-05T11:17:05.263

```
<asp:TemplateField>
   <ItemTemplate>
       <%# Container.DataItem.ToString() %>
   </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T11:15:53.113

我希望您可能必须将数据放入包装类中 - 例如：

```
public class Wrapper<T> {
    public T Value {get;set;}
    public Wrapper() {}
    public Wrapper(T value) {Value = value;}
} 
```

然后绑定到 a`List<Wrapper<T>>`而不是 (as `Value`) - 例如使用 (C# 3.0) 之类的东西：

```
var wrapped = ints.ConvertAll(
            i => new Wrapper<int>(i)); 
```

或 C# 2.0：

```
List<Wrapper<int>> wrapped = ints.ConvertAll<Wrapper<int>>(
    delegate(int i) { return new Wrapper<int>(i); } ); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-05T11:48:37.400

这与 Marc 的想法基本相同，但更简单。

它创建一个匿名包装类，您可以将其用作网格的数据源，然后将该列绑定到“Value”成员：

```
List<int> list = new List<int> { 1,2,3,4};
var wrapped = (from i in list select new { Value = i }).ToArray();
grid.DataSource = wrapped; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-05T11:34:07.773

如果您必须编写要呈现的属性名称，则必须将整数（或字符串）值封装在具有返回值的属性的类中。在网格中你只需要写`<%# Eval("PropertyName") %>`.

# c# - 如何在 excel 的公式自动完成中显示 .net 自动化加载项功能

> ID：515467
> 
> 赞同：1
> 
> 时间：2009-02-05T11:12:18.317
> 
> 标签：c#, .net, automation, add-in, excel-2007

我有一个用 c# 编写的自动化插件，它公开了一些要在 Excel 中用作公式的函数。

这些公式可以在 Excel 工作表中成功使用，但它们不会出现在 Excel2007 的公式自动完成列表中。

即，如果我想在 Excel 工作表中使用函数 AddNums(x,y)，那么我必须知道该函数被称为什么，或者我可以在函数向导中找到该函数。能够开始输入 Add.. 然后看到以 Add 开头的公式会很好。

Excel 是否支持自动化加载项？（我知道它适用于 xlls）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T01:12:53.407

这来自[Microsoft 支持](http://support.microsoft.com/kb/285337)：

> 自动化插件和函数向导 每个自动化插件在 Excel 函数向导中都有自己的类别。类别名称是插件的 ProgID；您不能为自动化插件功能指定不同的类别名称。此外，无法在函数向导中为自动化加载项函数指定函数描述、参数描述或帮助。

本文还提到其他插件类型在公式列表中优先。

我首选的方法是编写一个 VBA 插件，将您在当前插件中公开的功能包装起来。我通过在 COM DLL 中实现我的代码（支持 IDTExtensibility2，因此它作为 COM 插件加载）来做到这一点，然后通过非常薄的 vba 包装器访问该对象上的其他方法：

```
Public Function AddinInMethod ( param As String ) As Variant
    Dim oAdd As Object
    On Error GoTo Err
    Set oAdd = Application.COMAddIns.item("MyProgID").Object
    AddInMethod = oAdd.AddInMethod(param)
    Exit Function
Err:
    AddinMethod = "#" & Err.Description
End Function 
```

这对我很有效，因为我所有的代码都是 C++。

由于您正在编写 C# 代码，因此最好将插件实现为 C# VSTO 插件。我没有亲自做过，但看起来有很多不错的框架功能可以作为这种类型的插件加以利用（尽管您仅限于较新版本的 Office）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-18T11:39:23.883

我认为即使在 Excel 2007 中，也会列出这些功能。这就是我在使用我的 UDF 时经常看到的。这是一个示例，您可能想尝试一下。我确定它可以在我的电脑上运行。

[http://book.greenwich2greenwich.com/Examples/](http://book.greenwich2greenwich.com/Examples/)

# javascript - IE 输入类型文本奇怪的行为

> ID：515476
> 
> 赞同：0
> 
> 时间：2009-02-05T11:15:53.317
> 
> 标签：javascript, html, internet-explorer

我的页面上有一个 google 建议之类的实用程序。它会自动在输入类型文本框中填充一个值。在 IE 中，在填充值之后。它不允许鼠标在两者之间单击，并且光标总是跳到最后。同样用左右键，光标跳到开头。是什么原因。

谢谢

```
<div id='input-div' class='inputblock'>
<form action="javascript:void(0);" name="GetVal">
<table>
<tr>
<td>
<div>
<input id="starttextbox" class="big" onclick="textboxClick(this)"   onblur="textboxBlur(this)" onkeyup="javascript:check_place(this)" type="text" name="start" autocomplete="off"/>
</div>
<div id='suggestdividstart' class='suggestDivClass'></div>
</td>
<td style='cursor:pointer' ><img style='display:none;' id='swaptd' style='cursor:pointer' src='images/swap.png' width='20' height='20' onclick='swaproute();return false;' title='click for reverse route'/>
</td>
<td>
<div>
<input id="endtextbox" class="smallhidden" onclick="textboxClick(this)"  onblur="textboxBlur(this)" onkeyup="javascript:check_place(this)" type="text" name="end" autocomplete="off" />
</div>
<div id='suggestdividend' class='suggestDivClass'></div>
</td><td>
<img  name="GoVid" id="GoVid" onclick="alert('Loading plz. wait')" src='images/locate.gif' tabindex='0' style='cursor:pointer' class="vidteq" value="Locate"  href="javascript:void(0);"/>
</td></tr>
</table>
<div class="help" id="helpdiv"></div>
</form>
</div> 
```

javascript 的作用是：

```
if(whichBox=='start') {
//clearSuggestDiv('start');
document.GetVal.start.value=place_selected_name;
}
else {
//clearSuggestDiv('end');
document.GetVal.end.value=place_selected_name;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T11:57:17.057

> 是什么原因。

textboxClick() 在每次点击时写入 input.value。您写入该值，您将丢失光标位置。因此，尽可能少地写入 .value ，除非您能够正确处理跨浏览器光标，从本页其余脚本的质量来看，我对此表示怀疑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T11:22:45.160

您的 HTML 页面是什么样的？听起来 javascript 做错了什么。

# ruby - 在ruby中将二进制数据转换为字符串

> ID：515478
> 
> 赞同：10
> 
> 时间：2009-02-05T11:16:20.553
> 
> 标签：ruby

我有一个包含字节数据的字符串。
如何执行到 ascii 字符串的就地转换？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-05T11:36:47.580

另一种处理二进制数据的方法是[String#unpack](http://ruby-doc.org/core-2.4.1/String.html#method-i-unpack)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-05T11:19:50.377

您可以通过使用 base64 来做到这一点，这是一种相当普遍的方式。

```
require 'base64'

str = Base64.encode64(data) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-01T07:03:39.310

**如果你有一个二进制字符串，可以这样说：**

> s = "01001101011011110111000101110101011001010110010101110100"

**你想将它转换回 Ruby 中的 ascii 文本，你可以这样做：**

```
s = "01001101011011110111000101110101011001010110010101110100"

(0..s.length-8).step(8) do |i|
    print s[i,8].to_i(base=2).chr
end 
```

***希望这会对某人有所帮助:)***

# c++ - 如何为 Linux 开发设置头文件和库

> ID：515480
> 
> 赞同：6
> 
> 时间：2009-02-05T11:16:29.260
> 
> 标签：c++, linux, eclipse, ubuntu, kde

我最近设置了一个带有 KDE 4.2 的 Ubuntu 桌面 PC，作为学习练习，安装了 Eclipse 并开始寻找有关如何为 KDE 开发的信息。我知道有 KDevelop，并且可能会在将来的某个时间看看它。但是，现在，我没有正确的头文件和库来使用 Eclipse 在 C/C++ 中创建 KDE 应用程序。如果我有以下情况：

```
#include <kapplication.h> 
```

它无法编译，因为存在对我的硬盘上不存在的其他头文件或未在任何地方声明的引用类的依赖关系。

所以，问题是，我需要安装哪些软件包才能获得正确的标头集以允许我为 KDE 4.2 编写应用程序？有什么我不应该有的包裹吗？或者，如果没有包，那么我在哪里可以获得适当的文件？

作为推论，有没有关于 KDE 开发的好教程，比如 Petzold Windows 书？

编辑：澄清我真正想要的是：我在哪里可以下载正确的头文件/库集以构建 KDE 应用程序？用于编译代码的 IDE 并不是真正的问题，而且很容易获得，就像为包含搜索路径等设置编译器选项一样。KDevelop 包是否具有所有正确的包含和库文件，或者它们是分开的吗？我想它们是分开的，因为 KDevelop 是一个也可以做其他语言的 IDE，但我可能错了。那么，我拥有的 KDE/Qt 头文件不起作用，我在哪里可以获得正确的头文件？

斯基兹

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T13:28:42.330

确保您已安装*build-essential*软件包。要从命令行获得更多文档，请安装 glibc-doc、manpages-dev、gcc-*-doc、libstdc++*-doc（将 '*' 替换为适合您系统的版本号）

[Getting Started/Build/KDE4/Kubuntu 和 Debian](https://techbase.kde.org/Getting_Started/Build/KDE4/Kubuntu_and_Debian)有一对`sudo aptitude install`我用来获取所需软件包的命令。我还获得了 KDevelop 和 QDevelop 应用程序，尽管我不确定它们是否是必需的。我还需要另一个包（kdelibs5-dev），这个包似乎是关键包。在得到那个之后，一切最终都奏效了。设置好编译器设置后，Eclipse 和 KDevelop 都乐于构建一个简单的应用程序。Eclipse 需要设置搜索路径和库文件名。

从第一印象来看，Eclipse 似乎比 KDevelop 更好，原因很简单，Eclipse 中的工具窗口可以从主窗口分离并浮动——在双显示器设置中很有用。我无论如何都看不到在KDevelop中这样做（我相信有人会评论如何做到这一点）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T11:29:28.453

如果您查看并检查用于为 KDE4.2 开发应用程序的[**CMake**](http://techbase.kde.org/Development/Tutorials/CMake)[的内容，](http://techbase.kde.org/Development/Tutorials/CMake)您可能会对您的`.classpath`和`.project`文件中包含的内容有所了解[](http://techbase.kde.org/Development/Tutorials/CMake)

 **我相信他们的 KDE 网站的开发部分在解释他们的开发环境时是相当完整的。[（来源：][[kde.org](http://techbase.kde.org/images/thumb/2/25/Action_configure.svg/40px-Action_configure.svg.png)][）] 尤其是他们的[编程教程](http://techbase.kde.org/Development/Tutorials)部分。
[![替代文字](https://i.stack.imgur.com/JKBZN.png)](https://i.stack.imgur.com/JKBZN.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T06:11:37.953

要获得在 Debian（可能是 Ubuntu）上构建应用程序所需的所有依赖项，请使用“apt-get build-dep”。所以选择一个随机的 KDE 应用程序——kasteroids？-- 并运行：

```
apt-get build-dep kasteroids 
```

无需猜测构建 KDE 应用程序需要哪些工具和库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T12:42:35.780

如果 Eclipse 没有为您提供 KDE 程序的一些向导/初始项目设置，我建议您安装 kdevelop 并在那里启动这样的项目（只需编写一点 Hello World）。然后，您可以查看创建的文件并遵循构建过程以更好地理解并可能将它们迁移到 Eclipse。

即使您去掉了正确包含目录等的编译器标志，它也可以工作——您应该考虑使用一种常见的、已建立的方法来构建您的软件（例如用于 QT 的 qmake、用于 KDE 的 cmake？...）。如果您现在开始使用这些，部署/分发您的软件将变得轻而易举。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T20:05:20.377

查看 pkg 配置。

例如，您可以通过提示查看安装的库：

```
pkg-config --list-all 
```

例如查找 gdk 库的编译标志：

```
~$ pkg-config --cflags gdk
-I/usr/include/gtk-1.2 -I/usr/include/glib-1.2 -I/usr/lib/glib/include
~$ 
```

最终，您将与库链接，您还需要库：

```
~$ pkg-config --libs gdk
-lgdk -lXi -lXext -lX11 -lm -lglib  
~$ 
```

注意：您需要安装开发库才能做到这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T13:03:02.237

如果您发现缺少文件并想找出提供该文件的软件包，我可以添加一个有用的提示。安装*apt-file*，然后你可以运行*apt-file search filename*来找出包含该文件的包。请注意，您必须先运行*apt-file update*才能获取最新信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-19T11:24:38.513

Eclipse 比 Kdevelop 好得多，但是 Eclipse 不支持开发 Kde 应用程序。如果你想为 KDE 开发应用程序，那么你应该去 Kdevelop。如果您使用 Qt 而不是 kde 库而不是使用 Qt Eclipse QtCreator 是开发 Qt 应用程序的另一个不错的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T05:44:43.133

我已经使用 KDevelop4 有一段时间了，它很棒。KDevelop3 很重，并且有 bitrot 的迹象（一个 50k 行项目使用 300MB RAM）。我有 KDevelop4（从测试版开始，我最近一直在运行trunk），它需要大约 100MB 的 RAM（同一个项目），上下文突出显示、出色的完成和其他好东西让我很难回到“无聊”的旧语法突出显示。我不知道experimental 是否有任何可用的版本，但是有多少软件包，如果没有人为Debian 提供它们，我几乎会感到惊讶。此外，所有 KDE4 应用程序中的所有工具栏都可以分离，因此 KDevelop4 也有。

# .net - .NET Reflector 错误：没有反汇编代码

> ID：515481
> 
> 赞同：0
> 
> 时间：2009-02-05T11:16:53.703
> 
> 标签：.net, reflector

我使用 .NET Reflector 已经有一段时间了，但我最近刚换了机器，并重新安装了。但是，当我现在尝试反汇编代码时，反汇编程序窗口只是显示为空白。

这是我试图反汇编 TimeSpan 成员的屏幕截图：

[替代文字 http://img17.imageshack.us/img17/1678/36689859iz7.png](http://img17.imageshack.us/img17/1678/36689859iz7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T12:00:32.290

好的，不知道发生了什么，但它似乎已经修复了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T01:45:34.653

我有这个问题。好像是我安装Internet Explorer 7的时候引起的，重启电脑后就消失了。

# sql - 存储过程间歇性超时！

> ID：515484
> 
> 赞同：8
> 
> 时间：2009-02-05T11:17:06.560
> 
> 标签：sql, sql-server, stored-procedures, timeout, sql-server-2000

我有许多从代码调用的存储过程`ExecuteNonQuery`。

一切都很好，但是我的两个存储过程今天开始间歇性超时：

> 超时已过。在操作完成之前超时时间已过或服务器没有响应。该语句已终止。

如果我从管理工作室手动执行 sp 它仍然很好。

我的数据库中最近没有任何变化 - 我的命令超时是默认值。

有什么线索吗？

**编辑**

反对 SP 的桌子正在运行它是巨大的 --> 15 Gigs。重新启动盒子 - 同样的问题，但这次也无法让 sp 从 Management Studio 运行。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-05T11:19:59.067

Management Studio 对其运行的查询/命令设置无限超时。您的代码数据库连接将有一个默认超时，您可以在[命令对象](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx)上更改该超时。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-05T11:26:30.457

尝试重新编译这些程序。我有几次这样的问题并没有找到问题的原因，但重新编译总是有帮助的。

编辑：

要重新编译 proc，你去管理工作室，打开程序修改并按 F5 或执行：EXEC sp_recompile 'proc_name'

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-05T11:22:11.883

这通常与：

*   由于过度急切的计划重用（[参数嗅探](https://stackoverflow.com/questions/211355/parameter-sniffing-or-spoofing-in-sql-server)）导致的错误查询计划
*   不同的 SET 选项 - 特别是 ANSI_NULLS 和 CONCAT_NULL_YIELDS_NULL
*   锁定（您可能有更高的隔离级别）
*   需要重建索引/更新统计信息/等

SET 选项可能导致某些索引类型不可用（例如，持久计算列上的索引 - 包括“提升”xml/udf 查询）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-05T11:19:36.523

您是否设置了命令超时？您的数据库中的某些内容最近是否发生更改导致此过程需要更长的时间？

如果您必须诊断锁定问题，则需要使用 sp_lock 之类的东西。

你能分享你的一个过程的来源吗？

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T21:57:40.963

好的 - 这就是我最终修复它的方式。

具有 4500 万条记录的表上的聚集索引正在杀死我的 SQL 服务器 - 代码中的每次插入都会导致答案中描述的令人讨厌的超时。增加超时容限并不能解决我的可伸缩性问题，所以我玩弄索引并使主键上的聚集索引**非聚集**解除了这种情况。

我很感激对此发表评论，以更好地了解这是如何解决问题的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-05T15:53:14.927

您可能需要更新数据库的统计信息。最近表上的索引是否也发生了变化？

检查sp的执行计划，看能不能找到瓶颈。即使它之前运行正常，它也可能被调整为更有效地运行。

您还返回多少数据？过去我们遇到过设计不佳的 SQL 问题，直到累积报告开始在结果集中包含更多数据时才会出现。不知道你的 sps 做了什么，很难说这是否可能，但值得一提的是你要调查一下。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T11:51:23.103

SQL Server 在返回给用户之前将无限期地等待。很可能设置了客户端超时属性。例如，您可以[为 ADO 命令对象设置超时属性](http://msdn.microsoft.com/en-us/library/ms678265(VS.85).aspx)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-19T15:58:18.337

在其上获取 SQL 分析器，比较在 Management Studio 中和通过您的应用程序运行它的结果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-02T15:38:17.157

就我而言，我只是重新组织了操作表的集群索引，超时问题解决了。查询时间也`select * from table`减少到 2 秒，在重组索引之前几乎是 30 秒 +

# validation - struts 2中的action-validation.xml

> ID：515499
> 
> 赞同：0
> 
> 时间：2009-02-05T11:23:35.063
> 
> 标签：validation, struts2

我已经使用 struts 2 启动了一个 Web 应用程序。Apache tomcat 6.0 是我的 Web 服务器。我很清楚，我们可以使用 action-validation.xml 验证数据，因为我的 login-validation.xml 是——

**`<validators> <field name="username"> <field-validator type="requiredstring"> <message>Login name is required</message> </field-validator> </field> </validators>`**

但它只适用于预定义类型，如 requiredstring、int、email 等。如果我希望该用户名必须有一个字符，例如“*”，那么我们如何在 struts 2 中实现这种类型的验证。

还告诉我我上面解释的是服务器端验证或客户端验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T02:48:44.370

对于您的情况，我认为正则表达式验证器适用于您的问题：

```
<validators> 

   <field name="username"> 
    <field-validator type="requiredstring"> 
    <message>Login name is required</message> 
    </field-validator> 

        <field-validator type="regex">
           <param name="expression"><![CDATA[(.*\*.*)]]></param>
       <message>Login name must contain a *</message> 
      </field-validator>
    </field>

</validators> 
```

如果内置验证器不能满足您的要求，您也可以编写自定义验证器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T16:24:11.727

对于用户名，有几种方法可以处理它。

您可以使用[fieldexpression](http://struts.apache.org/2.0.14/docs/fieldexpression-validator.html)内置验证器并为其提供正则表达式以匹配所需的用户名字符。

您可以在操作中验证传入的用户名，并在验证失败时添加字段错误。

以上是服务器端验证。对于像在用户名中需要特殊字符这样简单的事情，客户端 JavaScript 验证可能是最简单的。

# ncover - NCover 是否为我的 XSL 输出正确的 XML 版本？

> ID：515508
> 
> 赞同：0
> 
> 时间：2009-02-05T11:28:35.757
> 
> 标签：ncover

我使用以下命令生成了一个coverage.xml 输出文件。

```
"C:\Program Files\NCover\NCover.Console.exe" //reg //w "D:\BuildServer\MyCoolWebsite\Working\MyCoolWebsite.Helpers.Tests\bin\Debug" //l "Coverage.log" //a MyCoolWebsite.Helpers //x "D:\BuildServer\MyCoolWebsite\Artifacts\buildlogs\coverage.xml" "C:\Program Files\NUnit 2.4.8\bin\nunit-console.exe" "D:\BuildServer\MyCoolWebsite\Working\MyCoolWebsite.Helpers.Tests\MyCoolWebsite.Helpers.Tests.nunit" 
```

然后我尝试使用 C:\Program Files\NCover\CC.Net 文件夹中的 xsls 解析 xml。结果是一个几乎为空的 html 文件。

这样做的原因是 xsl 需要以下内容：

```
coverage -> module -> method -> seqpnt -> @visitcount 
```

虽然 xml 的结构看起来像这样

```
coverage -> module -> class -> method -> seqpnt -> @vc 
```

NCover 是否为我的 XSL 输出正确的 XML 版本？有没有我缺少的设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:44:01.653

您可能没有错过任何设置。xsl 看起来像是用于 NCover v1.5.8 及更早版本，而 xml 可能来自 v2.1 或更高版本。我知道在早期版本的 NCover 中有一些混淆，但如果您使用 2.1.2 或更高版本，xsl 应该匹配。最快的补救方法是下载最新版本的 NCover 并从中获取 xsl。

# model-view-controller - MVC 命名空间组织

> ID：515509
> 
> 赞同：2
> 
> 时间：2009-02-05T11:28:51.340
> 
> 标签：model-view-controller, coding-style, namespace-organisation

希望 SO 社区可以帮助解决办公室中的辩论。目前我们的结论是“视情况而定”！

在 MVC 中，如何组织命名空间？

**选项 A**

您是否遵循拥有模型、控制器和视图命名空间的 MS ASP.NET MVC 路线？

**选项 B**

或者你是否将每个 MVC 三元组分成它的逻辑“功能”，例如：

特征 A

*   特征模型
*   特征控制器
*   类型
    *   IFeatureAView（接口 - 使控制器不引用具体视图）
*   看法
    *   FeatureAView（具体）

我们可以看到两者的重点。我喜欢选项 B，因为它更好地构建了我在工作室中的项目 - 一眼我就可以看到所有内容都在哪里，因为它是按功能分组的。但是，例如，如果我们希望将来将所有模型移到服务层中，选项 A 为我们提供了一个更容易扩展的选项。

欢迎所有想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T11:34:29.003

我更喜欢在层次结构中结合两者。您的选项 A 是我的最高级别，并且在该功能内是明智的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T21:53:25.587

我个人倾向于将所有控制器保持在同一个命名空间中的想法，这仅仅是因为默认情况下路由不支持命名空间。

这意味着如果我尝试将我的控制器命名为相同的名称，我会得到一个编译器时间错误，而不是关于路由的奇怪的运行时错误。

无论如何，已经有很多博客文章，您可以在 google 上搜索有关此的更多信息。

所以我会说

**选项 A**

# python - 如何最好地将数据库对象传递给 turbogears WidgetList？

> ID：515522
> 
> 赞同：1
> 
> 时间：2009-02-05T11:35:01.423
> 
> 标签：python, turbogears

我正在尝试设置表单小部件以将一些对象添加到数据库中，但我遇到了困难，因为似乎无法将任何参数传递给 WidgetList 中包含的小部件。为了澄清这一点，这是我的 WidgetList：

```
class ClientFields(forms.WidgetsList):
    """Form to create a client"""

    name = forms.TextField(validator=validators.NotEmpty())
    abbreviated = forms.TextField(validator=validators.NotEmpty(), attrs={'size':2})
    address = forms.TextArea(validator=validators.NotEmpty())
    country = forms.TextField(validator=validators.NotEmpty())
    vat_number = forms.TextField(validator=validators.NotEmpty())
    email_address = forms.TextField(validator=validators.Email(not_empty=True))
    client_group = forms.SingleSelectField(validator=validators.NotEmpty(),
                                       options=[(g.id, g.name) for g in ClientGroup.all_client_groups().all()]) 
```

你看我不得不求助于从 WidgetList 中从数据库中获取对象，这意味着它与数据库代码的耦合相当紧密（即使它在模型中使用了类方法）。

问题是，一旦创建了 WidgetList 实例，您就无法访问这些字段（否则我只能从控制器调用 client_fields.client_group.options=[(key,value)]） - 这些字段已从类中删除并且添加到列表中，因此要再次找到它们，我必须遍历该列表以找到我想要更改的 Field 类 - 不干净。这是我查看 WidgetsList 时 ipython 的输出：

```
在 [8] 中：mad.declared_widgets
输出[8]：
[TextField(name='name', attrs={}, field_class='textfield', css_classes=[], convert=True),
 TextField(name='abbreveated', attrs={'size': 2}, field_class='textfield', css_classes=[], convert=True),
 TextArea(name='address', rows=7, cols=50, attrs={}, field_class='textarea', css_classes=[], convert=True),
 TextField(name='country', attrs={}, field_class='textfield', css_classes=[], convert=True),
 TextField(name='vat_number', attrs={}, field_class='textfield', css_classes=[], convert=True),
 TextField(name='email_address', attrs={}, field_class='textfield', css_classes=[], convert=True),
 SingleSelectField(name='client_group', attrs={}, options=[(1, u"Proporta's Clients")], field_class='singleselectfield', css_classes=[], convert=False)]
```

那么......在不将它们与数据库过于紧密耦合的情况下，设置这些 Widget 和 WidgetList 的正确方法是什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-02-05T12:26:02.660

A [page in the TurboGears documentation](http://docs.turbogears.org/1.0/SimpleWidgetForm) may help.

# perl - 为什么 exec-ing gtar 会挂起我的 Perl 程序？

> ID：515531
> 
> 赞同：1
> 
> 时间：2009-02-05T11:37:25.193
> 
> 标签：perl, unix, gzip

使用 gtar 将额外文件添加到现有存档时，循环会提前终止或挂起。它也会在创建初始 tar.gz 文件后终止。

但是，如果我从循环中删除 gtar 调用并将打印语句放在它们的位置，则循环将按预期执行。有人知道为什么是这样吗？下面是循环中包含的代码。

```
if (-e "flex_$yearA"."_"."$monthA.tar.gz")
{ print"accessing Flex tar \n";
 exec "gtar --append --file=flex_$yearA"."_"."$monthA.tar.gz $FILE";
}
else
{ print "creating Flex Tar \n ";
 exec "gtar -cvsf flex_$yearA"."_"."$monthA.tar.gz $FILE"; 
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T11:50:14.510

你想要“系统”，而不是“执行”。这是一个更清洁的版本：

```
my $tarball = "flex_${yearA}_${monthA}.tar.gz";

if ( -e $tarball ) { 
    print"accessing Flex tar \n";

    my $command = "gtar --append --file=$tarball $FILE";
    system($command) == 0
      or die "Could not ($command): $?";
}
else{ 
    print "creating Flex Tar \n ";
    my $command =  "gtar -cvsf $tarball $FILE";
    system($command) == 0
      or die "Could not ($command): $?";
} 
```

但是，我想知道所有这些变量来自哪里。你可以在这里暴露一个严重的安全漏洞。阅读“perldoc -f system”以获取有关将列表传递给系统的更多信息（更安全）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T11:40:31.100

```
* exec LIST

* exec PROGRAM LIST 
```

exec 函数执行系统命令并且从不返回——如果您希望它返回，请使用 system 而不是 exec。仅当命令不存在并且直接执行而不是通过系统的命令 shell 执行时，它才会失败并返回 false（见下文）。

所以，总而言之，使用系统或反引号`。Exec 将脚本的执行替换为另一个脚本。

这应该可以按需要工作。

```
 if (-e "flex_$yearA"."_"."$monthA.tar.gz")
{ print"accessing Flex tar \n";
 system "gtar --append --file=flex_$yearA"."_"."$monthA.tar.gz $FILE";
}
else
{ print "creating Flex Tar \n ";
 system "gtar -cvsf flex_$yearA"."_"."$monthA.tar.gz $FILE"; 
} 

```

# oracle - 将应用程序从 Oracle 9 移植到 Oracle 11 - 明白了吗？

> ID：515532
> 
> 赞同：3
> 
> 时间：2009-02-05T11:37:57.140
> 
> 标签：oracle, migration

我们有一个使用 Oracle 9i 的应用程序（嗯，3），但是它很快就会报废，我们需要转移到另一个平台——Oracle 11 或 Postgress 是显而易见的。

我听说过从 9i 移植到 11 不是直截了当的评论，但这里没有人可以确认一种或另一种方式。我不太关心“哦，查询计划引擎改变了”，我更关心“这个功能不再存在”。

没有一个应用程序是复杂的——它要么是客户端 SQL 中的基本杂乱无章的东西（以及一个大型的多表搜索例程，但无论如何我们将使用 Lucene 重写它），或者在 PL/SQL 中相同。

Postgress 只是作为一个可能更容易和更便宜的目标移植到的，但许可成本被我们 DBA 的培训成本所抵消。

任何经验意见表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T14:10:42.917

以下是 Oracle 提供的一份有用的白皮书，内容涉及 9i 和 10g 之间的一些变化，可以帮助您入门：[http ://www.oracle.com/technology/products/bi/db/10g/pdf/twp_bidw_optimizer_10gr2_0208.pdf](http://www.oracle.com/technology/products/bi/db/10g/pdf/twp_bidw_optimizer_10gr2_0208.pdf)

10g 和 11g 的文档集将为您提供一个非常完整的新功能和已弃用功能以及修改的默认行为的列表。例如。[http://download.oracle.com/docs/cd/B28359_01/readmes.111/b28280/toc.htm#BABGIGDC](http://download.oracle.com/docs/cd/B28359_01/readmes.111/b28280/toc.htm#BABGIGDC)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T12:33:05.517

需要注意的一些事项：

*   CREATE VIEW 特权是 9i 中 CONNECT 角色的一部分。但不是10g。可能也在11G中。您可能希望向安装脚本添加授权。
*   11G 有区分大小写的密码。因此，如果您发现自己无法连接，这可能是问题所在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T08:34:18.103

打动我们的东西：

在 9i 和 10g 之间，DISTINCT 的排序行为发生了变化。

在 9i 中，你可以写

```
SELECT DISTINCT X
FROM   Y; 
```

并且行将按 X 排序返回（显然您应该包含“ORDER BY X”子句，但有时人们会忘记，因为它没有工作）。

在 10g 中情况并非如此...... DISTINCT 的实现已经改变，现在行通常会以无序的方式返回。

（一旦你找到了有问题的代码，就很容易修复。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T12:11:34.017

好吧，规则库优化器已经消失或几乎消失了，因此查询计划确实发生了变化。

但是缺少功能...我不知道。您应该询问那些告诉您缺少功能的帅哥和帅哥来支持该声明。**问他们缺少哪些功能？**

如果他们不能举出例子，我不会感到惊讶。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T21:42:40.523

对 UTL_HTTP 等增强安全性所需的权限进行了一些更改。但实际上，没有什么东西会损坏，而且不能很容易地修复。Oracle 想做的最后一件事是破坏已经在其数据库上运行的应用程序。

如果您已经为 Oracle 许可付费，那么已经产生了巨大的成本。Postgres 的维护和支持成本可能较低，但当数据库出现故障并且从备份恢复未按预期进行时，您仍然希望支付支持费用。

PS。您是否看过与 Lucene 相对的内置 Oracle Text 功能？

# sharepoint - SharePoint MOSS 上的备份/还原共享服务提供程序

> ID：515540
> 
> 赞同：0
> 
> 时间：2009-02-05T11:41:00.067
> 
> 标签：sharepoint, moss, backup, restore, sharedservicesprovider

我在备份和恢复共享服务提供商时遇到了严重问题。

使用管理中心备份，我将备份运行到 s:\

这完成得很好。

然后我从另一个 SharePoint Server 选择还原备份并将其指向 UNC 路径 \machineipaddress\s$\spbr00DF

我已授予每个人对源服务器上 s:\ 的完全访问权限。

我从 SharePoint 得到的只是：

目录 \machineipaddress\s$\spbr00DF 不存在或 SQL Server 服务帐户和 BI_WEB\Administrator 服务帐户没有读取或写入备份文件夹的权限。指定不同的目录。

将不胜感激任何人对此的想法。

参考：[http ://technet.microsoft.com/en-us/library/cc896556.aspx](http://technet.microsoft.com/en-us/library/cc896556.aspx)

祝一切顺利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-27T13:10:28.633

嘿，我是新来的，但只想加两分钱。

我遇到了同样的问题，发现上述用户之一是正确的，错误是因为系统帐户无权访问共享而生成的。

在我们的服务器上，我们遇到了同样的错误。当我们创建我们的 Sharepoint 站点时，我们选择了网络服务帐户来运行该站点。我去了共享并添加了具有完全控制权的网络服务帐户，现在恢复工作。

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-11T19:57:51.697

首先备份所有数据库。以下是必须的.​​. 1\. 场配置数据库 2\. 所有内容数据库（适用于所有 Web 应用程序） 3\. 中央管理数据库。

如果需要，您还可以备份共享服务和搜索数据库。

一旦您在不同的数据库服务器上恢复了所有这些数据库的副本，请执行以下操作。

1.  在新场上运行 PSConfig 向导并连接到恢复的配置数据库。
2.  配置中央管理员（使用配置向导或命令行）
3.  使用临时数据库创建新的 Web 应用程序（您不能使用预先存在的数据库创建 Web 应用程序）为每个 Web 应用程序执行此操作。
4.  从中央管理员从 Web 应用程序中删除临时数据库，并为每个 Web 应用程序附加恢复的数据库（如果从 GUI 失败，请通过 stsadm -o attachcontentdb 执行此操作）。
5.  在场中启动和配置 WSS 搜索和 Office 搜索。
6.  转到共享服务> 恢复共享服务为 SSP 和 mysites 选择 Web 应用程序，然后输入共享服务的数据库名称，搜索等并点击确定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-03T01:23:33.463

您的 unc 路径不正确，应该是::

```
\\machineipaddress\spbr00DF 
```

您不需要该`s$`部分，也确保您的“spbr00DF”已共享并验证“spbr00DF”是其共享名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T18:04:35.130

当您将 \\machineipaddress\s$ 指定为还原文件夹时会发生什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T18:23:32.767

我遇到了类似的问题，问题源于 SharePoint 使用指定的系统帐户进行​​还原，即使它说系统帐户或当前用户必须具有访问权限。

我们最近将 SharePoint 迁移到了一个全新的环境，我厌倦了包含的备份/恢复系统，以至于我最终只备份了相关数据库，在新环境中创建新的 Web 应用程序，并将数据库附加到它们。您可以通过 Central Admin 从站点中删除内容数据库，但您需要使用 stsadm 重新附加。这对我来说完美无缺，并且可能适合您的需求。

# parsing - 如何遍历ascii文件中的每一行

> ID：515541
> 
> 赞同：-1
> 
> 时间：2009-02-05T11:41:36.480
> 
> 标签：parsing, shell

在 shell 脚本中，如何遍历 ASCII 文件中的每一行并对其值执行操作

这是我拥有的 ASCII 文件的示例

```
23 3.4e-09 55.90 5.7e-07
24 12.5 79.90 7.9e-09
25 67.9 78.9 3.4e-09
26 98.8 89.67 9.7e-09

```

暨它将采取第一行和迭代...

WAT DO U 是什么意思

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T11:47:16.937

在 Linux 上使用 bash，您可以使用 read。这可能取决于您要使用的外壳和版本。

"<" 是重定向操作，它告诉 shell 从文件 test.txt 重定向标准输入

有关详细信息，请参阅 bash 手册页中 SHELL BUILTIN COMMANDS 下的读取命令。

```
#!/bin/sh

while read line
do
  echo "[" $line "]"
done < test.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T11:50:10.627

一种方法（至少在 bash 和 ksh 中，也可以在普通 sh 中工作）是使用类似的东西：

```
而读线
做
  ...
完毕

```

但是，这将修改每一行的空格。如果您在行上有“足够固定”的格式（例如每行是 ValA ValB ValC），您可以修改读取行以读取 vala valb valc

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T11:52:39.157

**在 Windows 中，**

解析文本字符串：文本字符串将被视为文件中的单行输入，该字符串必须用双引号括起来（或使用 usebackq 的单引号）。

仅回显以下字符串中的日期

```
FOR /F "tokens=4 delims=," %%G IN ("deposit,$45.50,23.7,12-AUG-07") DO @echo Date paid %%G 
```

从这里开始：[for /f 循环文本](http://www.ss64.com/nt/for_f.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T11:53:49.263

我怀疑即使您正确设置了循环并且间距始终相同，您也会在对这些值进行数学运算时遇到麻烦，因为其中有一些科学数字，例如 3.4e-09。我怀疑脚本是否设置为将其转换为实际值，并且它必须是双精度而不是整数。

不知道您的编程技能是什么样的，但我个人会在程序中进行。

# perl - 如何像 tar 在 UNIX 中一样在 Perl 中归档目录？

> ID：515553
> 
> 赞同：7
> 
> 时间：2009-02-05T11:46:33.973
> 
> 标签：perl, tar

我想归档一个目录（我不知道我是否可以调用“我想 tar 一个目录”）。我想在解压缩时保留另一端的访问权限。我应该在 perl 中解决这个问题。

感谢您的回复，但为什么我要求这样做 Perl 是我希望它独立于平台。我想将一个大文件传输到多台机器上。这些机器可以是任何平台。我应该能够正确解压这个 tar 文件，对吗？所以我想编写自己的 tar 和 untar 程序。为什么我使用 Perl 是为了让它独立于平台。所以我不能通过在脚本和类似的东西中打开 shell 来使用 tar 命令。[Archive::Tar](http://search.cpan.org/dist/Archive-Tar)模块只处理 tarred 文件，但它没有归档文件的选项。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-05T17:35:40.460

这是一个简单的例子：

```
#!/usr/bin/perl -w

use strict;
use warnings 'all';
use Archive::Tar;

# Create a new tar object:
my $tar = Archive::Tar->new();

# Add some files:
$tar->add_files( </path/to/files/*.html> );
# */ fix syntax highlighing in stackoverflow.com

# Finished:
$tar->write( 'file.tar' );

# Now extract:
my $tar = Archive::Tar->new();
$tar->read( 'file.tar' );
$tar->extract(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-05T11:51:03.823

您可能想查看 CPAN 上的[Archive::Tar](http://search.cpan.org/~kane/Archive-Tar-1.44/lib/Archive/Tar.pm)。（我只是猜测，我自己从未使用过它。）你为什么坚持在 Perl 中这样做？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-12-16T16:25:22.307

两个参数；压缩的 tar 文件的名称和 tar 文件中所需的目录名称。例如

```
tarcvf test.tar.gz mydir

```

```
#!/usr/bin/perl -w 

use strict;
use warnings 'all';
use Archive::Tar;
use File::Find;

my $archive=$ARGV[0];
my $dir=$ARGV[1];

if ($#ARGV != 1) {
    print "usage: tarcvf test.tar.gz directory\n";
    exit;
}

# Create inventory of files & directories
my @inventory = ();
find (sub { push @inventory, $File::Find::name }, $dir);

# Create a new tar object
my $tar = Archive::Tar->new();

$tar->add_files( @inventory );

# Write compressed tar file
$tar->write( $archive, 9 ); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-05T11:52:35.490

您可以使用 Archive::Tar Perl 模块，也可以直接执行 tar。

如果您使用从命令行使用 tar 的选项运行，请使用 -p 标志来保留权限。

如果您实际上只是想压缩目录，我只需直接运行命令，您不需要使用 Perl。如果你之后需要做一些花哨的处理，也许你应该这样做。这取决于。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-07T00:17:52.817

在我看来， rsync 可能是一个更好的解决方案，但你没有说太多关于你有什么其他限制。

# sql - t-sql 为学年分配日期

> ID：515557
> 
> 赞同：2
> 
> 时间：2009-02-05T11:48:29.337
> 
> 标签：sql

我正在尝试将缺勤日期分配给一个学年，该学年是 8 月 1 日至 7 月 31 日。

所以我想要的是：
31/07/2007 = 2006/2007
02/10/2007 = 2007/2008
08/01/2008 = 2007/2008

在 sql 2000 服务器中是否有一种简单的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-05T12:11:01.553

字符串处理较少的变体

```
SELECT
  AbsenceDate,
  CASE WHEN MONTH(AbsenceDate) <= 7 
    THEN 
      CONVERT(VARCHAR(4), YEAR(AbsenceDate) - 1) + '/' + 
      CONVERT(VARCHAR(4), YEAR(AbsenceDate))
    ELSE 
      CONVERT(VARCHAR(4), YEAR(AbsenceDate)) + '/' + 
      CONVERT(VARCHAR(4), YEAR(AbsenceDate) + 1)
  END AcademicYear
FROM
  AbsenceTable 
```

结果：

```
2007-07-31 => '2006/2007' 
2007-10-02 => '2007/2008' 
2008-01-08 => '2007/2008' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T11:58:10.017

应该这样工作：

```
select case 
    when month(AbsenceDate) <= 7 then 
        ltrim(str(year(AbsenceDate) - 1)) + '/' 
               + ltrim(str(year(AbsenceDate)))
        else 
        ltrim(str(year(AbsenceDate))) + '/' 
               + ltrim(str(year(AbsenceDate) + 1))
        end 
```

例子：

```
set dateformat ymd
declare @AbsenceDate datetime
set @AbsenceDate = '2008-03-01'
select case 
    when month(@AbsenceDate) <= 7 then 
        ltrim(str(year(@AbsenceDate) - 1)) + '/' 
               + ltrim(str(year(@AbsenceDate)))
        else 
        ltrim(str(year(@AbsenceDate))) + '/' 
               + ltrim(str(year(@AbsenceDate) + 1))
        end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T12:13:11.190

您可以按如下方式创建函数：

```
CREATE FUNCTION dbo.GetAcademicYear(@in DATETIME)
RETURNS VARCHAR(10) AS
BEGIN
    DECLARE @out VARCHAR(10)

    IF (MONTH(@in) > 7)
        SET @out = CAST(YEAR(@in) AS VARCHAR) + '/' + CAST((YEAR(@in) + 1) AS VARCHAR)
    ELSE
        SET @out = CAST((YEAR(@in) - 1) AS VARCHAR) + '/' + CAST(YEAR(@in) AS VARCHAR)

    RETURN(@out)
END 
```

然后只需调用它：

```
SELECT dbo.GetAcademicYear('31 July 2007') 
```

或者

```
SELECT col1, col2, dbo.GetAcademicYear(date_col) AS academic_year, col3, etc
FROM my_table 
```

ETC

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T12:38:03.823

也许您可以考虑创建一个 AcademicYear 表，如下所示：

```
CREATE TABLE AcademicYear (
    AcYear   VARCHAR(9)
,   FromDate DATE,
,   ToDate   DATE) 
```

并相应地填充它。那么您的查询可能会变成

```
SELECT
  AbsenceDate,
  AcYear
FROM
  AbsenceTable JOIN AcademicYear ON AbsenceDate BETWEEN FromDate AND ToDate 
```

作为附带的好处，如果一年的开始和结束发生变化，那是数据变化，而不是一些可怕的扩展 UDF。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T12:39:11.870

我建议创建一个日历表。它将包括可预见的未来（和过去）的所有日期以及您需要的这些日期的任何信息 - 例如它所属的学年。然后，您还可以添加诸如是否是假期、周末等内容。

每当您需要任何类型的查询时，只需加入您的日历表即可。

# c# - 如何动态更改 C# 组合框或文本框中的自动完成条目？

> ID：515561
> 
> 赞同：50
> 
> 时间：2009-02-05T11:49:10.537
> 
> 标签：c#, winforms, autocomplete, combobox, textbox

我在 C# 中有一个组合框，我想使用自动完成建议，但是我希望能够在用户键入时更改自动完成条目，因为可能的有效条目太多而无法`AutoCompleteStringCollection`在启动时填充。

例如，假设我让用户输入名称。我有一个可能的名字列表（“Joe”、“John”）和一个姓氏列表（“Bloggs”、“Smith”），但如果我每个都有一千个，那么这将是一百万个可能的字符串 -太多，无法放入自动完成条目。因此，最初我只想将名字作为建议 ("Joe", "John") ，然后一旦用户输入了名字 ("Joe")，我想删除现有的自动完成条目并替换他们有一个新的集合，包括选择的名字和可能的姓氏（“Joe Bloggs”、“Joe Smith”）。为了做到这一点，我尝试了以下代码：

```
void InitializeComboBox()
{
    ComboName.AutoCompleteMode = AutoCompleteMode.SuggestAppend;
    ComboName.AutoCompleteSource = AutoCompleteSource.CustomSource;
    ComboName.AutoCompleteCustomSource = new AutoCompleteStringCollection();
    ComboName.TextChanged += new EventHandler( ComboName_TextChanged );
}

void ComboName_TextChanged( object sender, EventArgs e )
{
    string text = this.ComboName.Text;
    string[] suggestions = GetNameSuggestions( text );

    this.ComboQuery.AutoCompleteCustomSource.Clear();
    this.ComboQuery.AutoCompleteCustomSource.AddRange( suggestions );
} 
```

但是，这不能正常工作。似乎对 Clear() 的调用会导致自动完成机制“关闭”，直到下一个字符出现在组合框中，但是当然当下一个字符出现时，上面的代码再次调用 Clear()，所以用户永远不会实际上看到了自动完成功能。它还会导致组合框的全部内容被选中，因此在每次按键之间您必须取消选择现有文本，这使其无法使用。如果我删除对 Clear() 的调用，则自动完成工作，但似乎`AddRange()`调用无效，因为我添加的新建议不会出现在自动完成下拉列表中。

我一直在寻找解决方案，并看到了各种建议，但我无法让它们中的任何一个工作 - 自动完成功能似乎被禁用，或者没有出现新字符串。这是我尝试过的事情的清单：

*   `BeginUpdate()`在更改字符串之前和`EndUpdate()`之后调用。
*   调用`Remove()`所有现有字符串而不是 Clear()。
*   在我更新字符串时从组合框中清除文本，然后将其添加回来。
*   在我更改字符串时将其设置`AutoCompleteMode`为“None”，然后将其设置回“SuggestAppend”。
*   挂钩 `TextUpdate`or`KeyPress`事件而不是`TextChanged`.
*   每次都`AutoCompleteCustomSource`用新的替换现有的。`AutoCompleteStringCollection`

这些都没有帮助，即使是各种组合。 [Spence](https://stackoverflow.com/users/53771/spence)建议我尝试覆盖`ComboBox`获取要在自动完成中使用的字符串列表的函数。使用反射器，我在`ComboBox`类中发现了一些看起来很有希望的方法 -`GetStringsForAutoComplete()`和`SetAutoComplete()`，但它们都是私有的，因此我无法从派生类访问它们。我不能再进一步了。

我尝试用 替换`ComboBox`，`TextBox`因为自动完成界面是相同的，我发现行为略有不同。它似乎工作得更好，因为`TextBox`自动完成的附加部分工作正常，但建议部分没有 - 建议框短暂地闪烁，然后立即消失。

所以我想“好吧，我会在没有 Suggest 功能的情况下生活，而只使用 Append”，但是当我将其设置`AutoCompleteMode`为 Append 时，我得到了访问冲突异常。Suggest 也会发生同样的事情 - 唯一不会引发异常的模式是`SuggestAppend`，即使 Suggest 部分的行为不正确。

我认为使用 C# 托管代码时应该不可能出现访问冲突异常。 [Avram](https://stackoverflow.com/users/61883/avram)建议我使用“锁定”来解决此问题，但我不知道我应该锁定什么 - 唯一具有 SyncRoot 成员的是`AutoCompleteStringCollection`, 并且锁定不会阻止访问冲突异常。我也尝试锁定`ComboBox`or `TextBox`，但这也无济于事。据我了解， lock 只会阻止其他锁，所以如果底层代码没有使用 lock 那么我使用它不会有任何区别。

所有这一切的结果是我目前无法使用动态自动完成的 a`TextBox`或 a 。`ComboBox`有人对我如何实现这一目标有任何见解吗？

### 更新：

我还没有得到这个工作，但我发现了更多。也许其中一些会激发其他人提出解决方案。

我尝试用 替换`ComboBox`，`TextBox`因为自动完成界面是相同的，我发现行为略有不同。它似乎工作得更好，因为`TextBox`自动完成的附加部分工作正常，但建议部分没有 - 建议框短暂地闪烁，然后立即消失。

所以我想“好吧，我会在没有 Suggest 功能的情况下生活，而只是使用 Append”，但是当我将其设置`AutoCompleteMode`为 Append 时，我得到了访问冲突异常。Suggest 也会发生同样的事情 - 唯一不会引发异常的模式是`SuggestAppend`，即使 Suggest 部分的行为不正确。

我认为在使用 C# 托管代码时应该不可能获得访问冲突异常，但无论如何，结果是我目前无法使用 a`TextBox`或 a`ComboBox`任何类型的动态自动完成。有人对我如何实现这一目标有任何见解吗？

### 更新 2：

在尝试了各种其他事情（例如更改工作线程中的自动完成功能，并`BeginInvoke()`用于模拟 PostMessage() 类型的行为之后，我终于放弃了，只是使用列表框实现了我自己的自动完成下拉菜单。它比内置的响应速度更快，而且我花在这方面的时间比我试图让内置的工作的时间少，所以任何想要这种行为的人的教训是 - 你可能会更好自己实施。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-12-06T06:38:26.747

我遇到了同样的问题，并找到了一个非常简单的解决方法。和这里的其他人一样，我找不到任何方法来控制组件的行为，所以我不得不接受它。

自然的行为是：您不能在每次用户在文本框中输入内容时动态填充列表。您必须填充一次，然后自动完成机制获得控制权。结论是：您应该使用数据库中的每个可能条目填充 AutoCompleteCustomSource 以使其按我们的意愿工作。

当然，如果您有数百万条记录要填充列表，那么这是不可行的。数据传输中的性能问题和自动完成机制本身不允许您这样做。

我找到的折衷解决方案是：每次文本长度恰好达到 N 个字符（在我的情况下为 3 个）时动态填充 AutoCompleteCustomSource。这很有效，因为复杂性大大降低了。从数据库中提取的与这 3 个初始字符匹配的记录数量足够小，可以避免任何性能问题。

主要缺点是：用户在输入第 N 个字符之前不会看到自动完成列表。但在输入 3 个字符之前，用户似乎并不真正期望有一个有意义的自动完成列表。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-29T09:14:12.467

这对我有用，你不`addRange`一样`AutoCompleteStringCollection`，而是每次都创建一个新的。

```
form.fileComboBox.TextChanged += (sender, e) => {
    var autoComplete = new AutoCompleteStringCollection();
    string[] items = CustomUtil.GetFileNames();
    autoComplete.AddRange(items);
    form.fileComboBox.AutoCompleteCustomSource = autoComplete;
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T18:01:05.060

我没有对此进行测试，但可能值得一试。

通过保留两个实例，而不是清除 AutoCompleteCustomSource，双缓冲区。当文本更改时，调用 GetNameSuggestions() 并为当前未使用的字符串构建字符串，然后将 ComboName.AutoCompleteCustomSource 设置为您刚刚设置的字符串。

我认为它应该看起来像这样。

```
AutoCompleteCustomSource accs_a;
AutoCompleteCustomSource accs_b;
bool accs_check = true; //true for accs_a, false for accs_b
void InitializeComboBox()
{
    ComboName.AutoCompleteMode = AutoCompleteMode.SuggestAppend;
    ComboName.AutoCompleteSource = AutoCompleteSource.CustomSource;

    accs_a = new AutoCompleteStringCollection();
    accs_b = new AutoCompleteStringCollection();

    ComboName.AutoCompleteCustomSource = accs_a;
    ComboName.TextChanged += new EventHandler( ComboName_TextChanged );
}

void ComboName_TextChanged( object sender, EventArgs e )
{
    string text = this.ComboName.Text;

    if(accs_check)
    {
       accs_b.Clear();
       accs_b.AddRange(GetNameSuggestions( text ));
       accs_check = false;
    }
    else
    {
       accs_a.Clear();
       accs_a.AddRange(GetNameSuggestions( text ));
       accs_check = true;
    }

    this.ComboQuery.AutoCompleteCustomSource = accs_check? accs_a : accs_b;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T11:51:34.883

我认为您可能想要摆脱反射器并查看覆盖组合框本身的自动完成行为。我确定自动完成会调用一个访问自动完成列表的函数。如果你能找到这个函数并覆盖它，你可以使用任何你想要的行为。

查看您可以在组合框类本身上找到哪些文档。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T21:54:25.400

update: main reason to put the lock on this place is

its working :) most of "mysterious exception" that i ever have, after this trick **disappear**

* * *

1.  the lock like in this code, can help with your exception
2.  as you mention before, there is less problem with using textbox
3.  in this code, SuggestAppend working fine

```
 private void Form1_Load(object sender, EventArgs e)
    {
        textBox1.AutoCompleteMode = AutoCompleteMode.SuggestAppend;
        textBox1.AutoCompleteSource = AutoCompleteSource.CustomSource;

        textBox1.TextChanged+=new EventHandler(textBox1_TextChanged);

        col1.AddRange(new string[] { "avi avi", "avram avram" });
        col2.AddRange(new string[] { "boria boria", "boris boris" });

        textBox1.AutoCompleteCustomSource = col1;
        textBox1.AutoCompleteMode = AutoCompleteMode.SuggestAppend;
    }
    AutoCompleteStringCollection col1 = new AutoCompleteStringCollection();
    AutoCompleteStringCollection col2 = new AutoCompleteStringCollection();

    object locker = new object();
    private void textBox1_TextChanged(object sender, EventArgs e)
    {
        lock (locker)
        {
            if (textBox1.Text.StartsWith("a") && textBox1.AutoCompleteCustomSource != col1)
            {
                textBox1.AutoCompleteCustomSource = col1;
            }
            if (textBox1.Text.StartsWith("b") && textBox1.AutoCompleteCustomSource != col2)
            {
                textBox1.AutoCompleteCustomSource = col2;
            }
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-07T08:23:28.377

最好的解决方案是使用组合框的事件处理程序。通过使用 **textUpdate KeyDown DropDown**和**ChangeCommit**，您可以模仿自动完成模式，您可以自定义要搜索的内容以及出现在下拉列表中的内容。

我发现[这个](https://stackoverflow.com/questions/27559900/customized-autosearch-of-toolstripcombobox-in-visual-c)答案很有用，但它是用 Visual C++ 编码的，它是工具条组合框，但**概念是相同**的。无论如何，.net 中的 c# 和 c++ 有很大的相似性，理解解决方案应该不是问题。

[Visual C++ 中 ToolStripCombobox 的自定义自动搜索](https://stackoverflow.com/questions/27559900/customized-autosearch-of-toolstripcombobox-in-visual-c)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T19:12:44.377

```
if(!textBox3.AutoCompleteCustomSource.Contains(textBox3.Text))
   textBox3.AutoCompleteCustomSource.Add(textBox3.Text); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-26T18:39:54.057

山姆，你搞清楚了吗？我遇到了同样的情况。Clear() 似乎导致异常。我删除了清除呼叫，尽管收藏不断增长，但我得到了正确的建议事件......

此外，关于私有成员：您可以使用反射访问它们：

```
PropertyInfo[] props = [object].GetType().GetProperties({flags go here});
props[0].SetValue(this, new object[] { 0 }); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-18T17:10:15.783

我最初来这里是为了寻找解决方案，但现在找到了自己的解决方案。

诀窍不是在 AutoCompleteCustomSource 上调用 Clear()，而是在 for 循环中删除所有项目，然后用新数据重建列表。就我而言（一个图书收藏应用程序），我正在从具有特定首字母的数据库中检索作者姓名，而不是全部。请注意，这仅在组合框的文本框部分为空或已变为空时才有效。

```
 private void cboAuthor_KeyDown(object sender, KeyEventArgs e)
    {
        if (cboAuthor.Text.Length == 0)
        {
            // Next two lines simple load data from the database in the
            // into a collection (var gateway), base on first letter in
            // the combobox. This is specific to my app.
            var gateway = new AuthorTableGateway();
            gateway.LoadByFirstLetter(Char.ConvertFromUtf32(e.KeyValue)[0]);

            // Clear current source without calling Clear()
            for (int i = 0; i < authorsAutoComplete.Count; i++)
                authorsAutoComplete.RemoveAt(0);

            // Rebuild with new data
            foreach (var author in gateway)
                authorsAutoComplete.Add(author.AuthorName);
        }
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-21T20:41:23.283

对我来说，秘密是使用 TextChanged 事件，而没有使用 KeyDown/Up/Press 等。

**更新：**在动态更改 AutoCompleteCustomSource 遇到其他问题后，我最终放弃了使用内置的自动完成功能，并在比我最初浪费的时间更短的时间内实现了我自己的功能。在实现 ComboBox 控件的非托管代码中似乎存在一些问题。具体来说，我在应该触发 TextChanged 事件处理程序时遇到了问题。我决定在我的自定义实现中只使用 OnKeyDown/Press/Up 处理程序，这似乎更可靠。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-02-27T15:25:56.600

没有尝试过，但对于您的具体情况，您可以编写如下代码：

```
 private void txtAutoComplete_KeyUp(object sender, KeyEventArgs e)
    {

        String text = txtAutoComplete.Text;

        if (text.EndsWith(" "))
        {

            string[] suggestions = GetNameSuggestions( text ); //put [text + " "] at the begin of each array element
            txtAutoComplete.AutoCompleteCustomSource.Clear();
            txtAutoComplete.AutoCompleteCustomSource.AddRange( suggestions );

        }

    } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-04-23T14:00:45.527

我知道这是一个非常古老的问题，但它今天仍然存在。我的解决方法是将自动完成模式和源属性设置为“无”并手动更新 KeyUp 事件中的项目。

我确信它很老套，但无论输入数据的速度如何，它在很长一段时间内都能完美地为我工作，而且我的头发开始重新长出来。

您还可以选择只是建议，还是建议并附加。我希望它可以帮助某人。

```
private void comboBox1_KeyUp(object sender, KeyEventArgs e)
    {

        if (string.IsNullOrWhiteSpace(comboBox1.Text))
        {
            e.Handled = true;
            return;
        }
        if (comboBox1.Text.Length < 3)
        {
            e.Handled = true;
            return;
        }

        if (e.KeyCode == Keys.Down || e.KeyCode == Keys.Up)
        {
            e.Handled = true;
            return;
        }
        else if (e.KeyCode == Keys.Back)
        {
            e.Handled = true;
            return;
        }

        string text = comboBox1.Text;

        if (e.KeyCode == Keys.Enter)
        {
            comboBox1.DroppedDown = false;
            comboBox1.SelectionStart = text.Length;
            e.Handled = true;
            return;
        }

        List<string> LS = Suggestions(comboBox1.Text);

        comboBox1.Items.Clear();
        comboBox1.Items.AddRange(LS.ToArray());

        //If you do not want to Suggest and Append
        //comment the following line to only Suggest
        comboBox1.Focus();

        comboBox1.DroppedDown = true;
        comboBox1.SelectionStart = text.Length;

        //Prevent cursor from getting hidden
        Cursor.Current = Cursors.Default;
        e.Handled = true;
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-11-29T12:58:05.393

在尝试了这里提供的所有解决方案（没有成功）之后，我发现了一些对我有用的东西：

```
private void CellBox_TextChanged(object sender, EventArgs e)
{
    ((TextBox)sender).TextChanged -= CellBox_TextChanged;
    ((TextBox)dataGridView1.EditingControl).AutoCompleteMode = AutoCompleteMode.None;
    ((TextBox)dataGridView1.EditingControl).AutoCompleteCustomSource = null;                
    aCSC.Clear();
    foreach (string value in Autocompletevalues())
    {
        aCSC.Add(value);
    }
    ((TextBox)dataGridView1.EditingControl).AutoCompleteCustomSource = aCSC;
    ((TextBox)dataGridView1.EditingControl).AutoCompleteMode = AutoCompleteMode.Suggest;
    ((TextBox)sender).TextChanged += CellBox_TextChanged;
} 
```

脚步：

*   禁用事件处理程序
*   禁用自动完成模式
*   将源设置为空
*   更新 AutoCompleteStringCollection (aCSC)
*   将 Source 设置为更新的 AutoCompleteStringCollection
*   激活自动完成模式
*   启用事件处理程序

我希望它可以帮助某人..

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2013-12-13T10:50:25.017

使用此代码

```
private void dataGridView1_EditingControlShowing(object sender,DataGridViewEditingControlShowingEventArgs e)
    {

        if (e.Control is DataGridViewComboBoxEditingControl)
        {
            ((ComboBox)e.Control).DropDownStyle = ComboBoxStyle.DropDown;
            ((ComboBox)e.Control).AutoCompleteSource = AutoCompleteSource.ListItems;
            ((ComboBox)e.Control).AutoCompleteMode = System.Windows.Forms.AutoCompleteMode.Suggest;
        }

} 
```

# java - 使用 for 语句和 while 语句向前移动迭代器的区别

> ID：515562
> 
> 赞同：15
> 
> 时间：2009-02-05T11:49:23.530
> 
> 标签：java, iterator, for-loop, while-loop

当我使用对象的迭代器时，我使用了一个*while 循环*（如每本学习 Java 的书中所写，如Bruce Eckel 的**Thinking in Java ）：**

```
Iterator it=...

while(it.hasNext()){
    //...
} 
```

但有时我看到有人使用*for 循环*：

```
Iterator it=...
for (Iterator it=...; it.hasNext();){
    //...
} 
```

我不明白这个选择：

*   当我有一个带有序数序列（作为数组）的集合或具有用于步骤的特殊规则（通常声明为简单增量）的集合时，我使用*for 循环*`counter++`。
*   当循环结束时我使用*while循环*，我没有这个约束，但只有一个退出的逻辑条件。

这是一个没有其他原因的样式编码问题，还是存在一些我不知道的其他逻辑（例如性能）？

感谢您的每一个反馈

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-05T11:54:20.230

for 循环的正确语法是：

```
for (Iterator it = ...; it.hasNext(); ){
    //...
} 
```

（代码中的前面声明是多余的，for 循环标题中的额外分号也是如此。）

无论您是使用这种语法还是`while`循环，都取决于您的喜好，两者都转换为完全相同的内容。for 循环的通用语法是：

```
for (<init stmt>; <loop cond>; <iterate stmt>) { <body>; } 
```

这相当于：

```
<init stmt>;
while (<loop cond>) { <body>; <iterate stmt>; } 
```

**编辑：**实际上，上述两种形式并不完全等价，*如果*（如问题）变量是用 init 语句声明的。在这种情况下，迭代器变量的范围会有所不同。对于 for 循环，范围仅限于循环本身，但是在 while 循环的情况下，范围会扩展到封闭块的末尾（不足为奇，因为声明在循环之外）。

此外，正如其他人指出的那样，在较新版本的 Java 中，for 循环有一个简写符号：

```
for (Iterator<Foo> it = myIterable.iterator(); it.hasNext(); ) {
    Foo foo = it.next();
    //...
} 
```

可以写成：

```
for (Foo foo : myIterable) {
    //...
} 
```

使用这种形式，您当然会失去对迭代器的直接引用，这是必要的，例如，如果您想在迭代时从集合中删除项目。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-05T11:54:19.790

这只是一种风格，和你一样，在使用带有索引的东西时，我更喜欢 for 循环。如果您使用的是 Java 5，那么您当然应该在集合上使用 foreach 循环：

```
Collection<String> someCollection = someCollectionOfString();
for (String element : someCollection) {
....
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-05T14:40:34.700

`Iterator`在 for 循环内声明的目的是*最小化变量的范围*，这是一个很好的做法。

当您声明`Iterator`循环外部时，循环完成后引用仍然有效/有效。99.99% 的情况下，您不需要`Iterator`在循环完成后继续使用，因此这种样式可能会导致如下错误：

```
//iterate over first collection
Iterator it1 = collection1.iterator();
while(it1.hasNext()) {
   //blah blah
}

//iterate over second collection
Iterator it2 = collection2.iterator();
while(it1.hasNext()) {
   //oops copy and paste error! it1 has no more elements at this point
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-05T11:57:19.550

这两种方法没有太大区别，除了第一个记住`it`循环后的值。第二种方法可能会引发错误，因为您在循环内重新声明了变量。

实际上还有第三种方法。而不是写例如

```
for (Iterator<SomeObject> it = foo.iterator(); it.hasNext();) {
  SomeObject so = foo.next();
} 
```

你最常写

```
for (SomeObject so: foo) {...} 
```

这两个等于同一个东西...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T11:56:57.447

人们可能会使用显式（'旧样式'）for循环，只是因为他们觉得它更干净，也许他们还没有适应新语法（我个人认为它更干净）。

较长的 for 循环构造的一个实际特定优势是您可以引用迭代器，因此可以在其上调用其他方法 then `next()`。特别是，`hasNext()`调用通常很有用 - 想象一下，如果你想打印出一个以逗号分隔的字符串列表：

```
StringBuilder sb = new StringBuilder();
for (Iterator it=...; it.hasNext();){
   sb.append(it.next());
   if (it.hasNext())
      sb.append(", ");
}
```

如果您使用更详细的 for 循环，它只是为了区分像这样的“这是最后一个”情况。

# .net - 如何在 .net 网站中创建一个始终在后台运行的线程？

> ID：515565
> 
> 赞同：5
> 
> 时间：2009-02-05T11:50:04.027
> 
> 标签：.net, asp.net, multithreading

我打算建立一个小型网站，它将轮询第三方网络服务，比如每 15 分钟一次，将收集到的数据存储在数据库中并通过网页显示结果。

我希望投票每天 24 小时运行，无论是否有人访问该网站。

我知道我可以创建一个可以在服务器上运行的独立应用程序来执行此操作，但是是否有一种干净的方法可以将其合并到网站代码中。我需要一些易于在便宜的第 3 方托管网站上部署的东西。

欢迎任何指向正确方向的指示。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T11:53:53.130

将 global.asax 文件添加到您的网站项目中。

这将为您提供四个事件处理程序，其中一个在您的应用程序加载时使用。

你可以在这里关闭你的线程。

此外，我建议您将线程设置为后台，以便您可以在关闭 Web 应用程序时让它们消失。

```
System.Threading.Thread.CurrentThread.IsBackground = true; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T12:29:27.473

理想情况下，您需要创建一个 Windows 服务来执行此操作。从应用程序启动创建线程的另一个建议很好，直到您的 Web 服务器重新启动。

此时，您的后台任务将在下一个人访问该站点之前启动。使用 Windows 服务，后台任务将在服务器启动后立即重新开始运行。

使用 .net 创建 Windows 服务相当简单，当然比使用 .net 之前要容易得多：

[http://www.codeproject.com/KB/system/WindowsService.aspx](http://www.codeproject.com/KB/system/WindowsService.aspx)

您当然可以通过在服务器启动后运行某些东西来访问您的网站来欺骗其他解决方案，但这很麻烦，“正确”的方式是 Windows 服务。

编辑：

这将教我正确阅读问题，没有发现在廉价共享主机上工作的要求。在这种情况下，另一种解决方案可能是您所希望的最好的解决方案，因为几乎可以肯定 Windows 服务方法是不可能的。

# artificial-intelligence - 训练单层感知器时的激活函数

> ID：515568
> 
> 赞同：2
> 
> 时间：2009-02-05T11:50:30.783
> 
> 标签：artificial-intelligence, neural-network

在训练多层神经网络时，需要使用 sigmoidal 激活函数才能有效地学习。

*在训练单层*感知器时使用 sigmoidal 激活函数有什么好处，或者一个简单的 step（heaviside）函数是否足够（甚至更可取）？

我正在慢慢了解神经网络，但对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T12:18:35.453

是的，有一个优势。结果可以介于 0 和 1 之间，不必是 YES 或 NO，也可以是 MAYBE。即使对于单神经元模型，最好有一个非步进激活函数。

如果你需要它取决于你的输出是如何被读出的。您需要二进制（是，否）值还是介于两者之间的值？

如果您不想使用 sigmoidal 函数，我认为您也可以使用线性函数。

# .net - .Net 中的多播支持

> ID：515572
> 
> 赞同：7
> 
> 时间：2009-02-05T11:51:33.463
> 
> 标签：.net, multicast

为了实现一个使用多播向网络中的其他进程发送小的周期性消息的网络应用程序，对于在 .Net 框架中使用 API，我有哪些选择？除了我当前明显的选择 System.net.sockets API 之外，WCF 是否提供了一种更简单的方法？还是 WCF 纯粹是一种基于 SOA 的点对点 IPC 机制？

**注意**：我非常熟悉多播编程的实现细节。我感兴趣的是 .Net 框架提供的其他选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T12:14:06.927

I was going to suggest that use callback channels (i.e. a pub/sub type system) implemented in WCF, but that would require your clients to register with the 'server'.

I was then going to mention enterprise class messaging solutions like Tibco EMS (a JMS implementation).

Then I hit google and found this link: [WCF Multicasting](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/3afba67f-56fa-4595-b96d-b1cf06e14a19/). There are lots of ideas on there which I've not yet come across in my own inital look at WCF.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T11:54:11.023

您只需创建一个`UDPClient`并将数据发送到一个多播地址（`224/4`，即来自`224.0.0.0`to的任何地址`239.255.255.255`）。

您的客户只需照常收听此地址即可。

[有关更多详细信息，请参阅我的](https://stackoverflow.com/questions/506879/question-about-ip-multicasting/506894#506894)答案。

PS 虽然`WCF`对于这样一个简单的任务来说有点过头了，但使用`WCF`. 那里有不同`Message Exchange Patterns`的地方，即通信流动的方式。

您需要的是`IOutputChannel`发送者和`IInputChannel`侦听器，这些都是面向数据报的模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-05T15:07:02.900

FWIW，您最初的问题是专门询问 WCF 是否可以实现您的目标。正如 Quassnoi 之前指出的，您当然可以使用 WCF 执行此操作。虽然大多数关于 WCF 的文献都集中在您如何使用它的合同模型上，但仅使用通道模型和绑定结构是可能且合理的。

如果您实现 IOutputChannel 和 IInputChannel，您可以创建自己的基于数据报的通道。这是作为框架的一部分提供的吗（我认为这也是您问题的核心）。但是，Microsoft 确实提供了一个 UDP 传输示例（他们声称支持多播）。您可以在以下 URL 找到他们的示例：

[http://msdn.microsoft.com/en-us/library/ms751494.aspx](http://msdn.microsoft.com/en-us/library/ms751494.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T11:57:27.290

WCF 对于你想做的事情来说真的很重。

您最好的选择确实是在套接字 api 中使用数据报。一旦你了解了 API，它们就不会太可怕，但它肯定不是最友好的。

如果您的 ISP / 网络管理员允许多播数据，则多播是通过发送到的地址实现的。WCF本质上不允许多个目标AFAIK，当您创建代理时，您必须将其指向一个IP（可能是多播地址）

# java - 限制映射键和值类型 - 更复杂

> ID：515575
> 
> 赞同：3
> 
> 时间：2009-02-05T11:52:01.857
> 
> 标签：java, generics

我有一个更复杂的问题（比问题'Java map with values limited by key's type parameter'问题）用于在 Map 中映射键和值类型。这里是：

```
interface AnnotatedFieldValidator<A extends Annotation> {
  void validate(Field f, A annotation, Object target);
  Class<A> getSupportedAnnotationClass();
} 
```

现在，我想将验证器存储在地图中，这样我就可以编写以下方法：

```
validate(Object o) {
  Field[] fields = getAllFields(o.getClass());
  for (Field field: fields) {
    for (Annotation a: field.getAnnotations()) {
      AnnotatedFieldValidator validator = validators.get(a);
      if (validator != null) {
        validator.validate(field, a, target);
      }
    }
  }
} 
```

（这里省略了类型参数，因为我没有解决方案）。我还希望能够注册我的验证器：

```
public void addValidator(AnnotatedFieldValidator<? extends Annotation> v) {
  validators.put(v.getSupportedAnnotatedClass(), v);
} 
```

使用这个（唯一的）公共修饰符方法，我可以确保映射包含其键（注释类）与验证器支持的注释类匹配的条目。

这是一个尝试：

我像这样声明验证器 Map：

```
private Map<Class<? extends Annotation>, AnnotatedFieldValidator<? extends Annotation>> validators; 
```

我知道我无法正确链接键和值（由于只能通过 访问，因此假定链接正常`addValidator()`），所以我尝试了一个演员表：

```
for (Annotation a: field.getAnnotations()) {
  AnnotatedFieldValidator<? extends Annotation> validator = validators.get(a);
  if (validator != null) {
    validator.validate(field, validator.getSupportedAnnotationClass().cast(a), target);
  }
} 
```

但这不起作用：`The method validate(Field, capture#8-of ?, Object) in the type AnnotatedFieldValidator<capture#8-of ?> is not applicable for the arguments (Field, capture#9-of ?, Object)`.

我不知道为什么这不起作用：`AnnotatedFieldValidator`有一个类型参数 (A)，它既用作 的返回类型，`getSupportedAnnotationClass()`也用作 ; 的参数`validate()`。因此，当将注释转换为supportedAnnotationClass时，我应该能够将其作为参数传递给`validate()`. 为什么`getSupportedAnnotationClass()`考虑的结果与参数的类型不同`validate()`？

我可以`validate()`通过删除验证器声明和`validate()`方法中的通配符来解决该方法，但是当然`addValidator()`不能编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T12:38:47.283

您可以提取一种方法来获取验证器。所有对`validators`Map 的访问都是通过类型检查方法进行的，因此是类型安全的。

```
 protected <A extends Annotation> AnnotatedFieldValidator<A> getValidator(A a) {
        // unchecked cast, but isolated in method
        return (AnnotatedFieldValidator<A>) validators.get(a);
    }

    public void validate(Object o) {
        Object target = null;
        Field[] fields = getAllFields(o.getClass());
        for (Field field : fields) {
            for (Annotation a : field.getAnnotations()) {
                AnnotatedFieldValidator<Annotation> validator = getValidator(a);
                if (validator != null) {
                    validator.validate(field, a, target);
                }
            }
        }
    }

    // Generic map
    private Map<Class<? extends Annotation>, AnnotatedFieldValidator<? extends Annotation>> validators; 
```

（将第二个建议删除为重复。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T12:58:33.720

泛型提供仅在编译时存在的信息；在运行时，所有信息都会丢失。使用泛型编译代码时，编译器将删除所有泛型类型信息并根据需要插入强制转换。例如，

```
List<String> list = new ArrayList<String>();
list.add("test");
String s = list.get(0); 
```

最终将被编译为

```
List list = new ArrayList();
list.add("test");
String s = (String) list.get(0); 
```

编译器会自动在第三行添加强制转换。

在我看来，您正在尝试使用泛型来实现运行时类型安全。这是不可能的。在行

```
validator.validate(field, a, target); 
```

编译器无法知道`Annotation`验证器期望的子类型。

我认为最好的办法是删除类型变量`A`并声明您的接口，如下所示：

```
interface AnnotatedFieldValidator {
  void validate(Field f, Annotation annotation, Object target);
  Class<? extends Annotation> getSupportedAnnotationClass();
} 
```

`addValidator`然后也会失去它的参数化类型，即

```
public void addValidator(AnnotatedFieldValidator v) {
  validators.put(v.getSupportedAnnotationClass(), v);
} 
```

这样做的缺点是您必须检查您的验证器是否正在传递他们可以验证的类的注释。这在调用验证器的代码中最容易做到，例如

```
if (validator.getSupportedAnnotationClass().isInstance(a)) {
  validator.validate(field, a, target);
}
else {
  // wrong type of annotation, throw some exception.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T13:13:57.853

哈..我想我想通了:)

```
for (Annotation a: field.getAnnotations()) {
  AnnotatedFieldValidator<? extends Annotation> validator = validators.get(a);
  if (validator != null) {
    validator.validate(field, validator.getSupportedAnnotationClass().cast(a), target);
  }
} 
```

**编辑：（**改变了我的观点）

当您从运行时的角度而不是从**COMPILE TIME**的角度来看时，这种语义是正确的。

在这里，**编译器**假设`validator.getSupportedAnnotationClass().cast()`会给你一个`Class<? extends Annotation>`.

当你打电话时：

```
validator.validate(field, validator.getSupportedAnnotationClass().cast(a), target); 
```

**编译器**需要一个as`Class<? extends Annotation>`参数。

这就是问题所在。从编译器的角度来看，这些类型在运行时可能是 2 种不同的类型，尽管在这种情况下语义不允许这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T13:25:27.190

好的，我会试一试，因为泛型是棘手的材料，我可能会从反应中学到一些东西。所以，*如果我错了，请纠正我*。

首先，让我将您的源代码放在一个块中。（为简洁起见改名`AnnotatedFieldValidator`为）`AFV`

```
interface AFV<A extends Annotation>
{
  void validate(Field f, A annotation, Object target);
  Class<A> getSupportedAnnotationClass();
}

private Map<Class<? extends Annotation>, AFV<? extends Annotation>> validators;

public void validate(Object o) {
  Field[] fields = o.getClass().getDeclaredFields();
  for (Field field: fields) {
    for (Annotation a: field.getAnnotations()) {
      AFV<? extends Annotation> validator = validators.get(a.getClass());
      if (validator != null) {
        validator.validate(field, a, o);
      }
    }
  }
}

public void addValidator(AFV<? extends Annotation> v) {
  validators.put(v.getSupportedAnnotationClass(), v);
} 
```

问题在于，当您遍历字段的注释时，编译器可以推断出的唯一类型是`Annotation`，而不是它的特化。如果您现在从 中提取正确`AFV`的`Map`，并尝试调用`validate`它，则第二个参数存在类型冲突，因为`AFV`希望看到`Annotation`它的特定子类被参数化，但只获取`Annotation`，这太弱了。

正如您自己已经说过的，如果添加验证器的唯一方法是通过`addValidator`方法，那么您可以通过它在内部确保类型安全，并重写如下：

```
interface AFV<A extends Annotation>
{
    void validate(Field f, A annotation, Object target);
    Class<A> getSupportedAnnotationClass();
}

private Map<Class<?>, AFV<?>> validators;

public void validate(Object o)
{
    Field[] fields = o.getClass().getDeclaredFields();
    for (Field field : fields)
    {
        for (Annotation a : field.getAnnotations())
        {
            // raw type to keep compiler happy
            AFV validator = validators.get(a.getClass());
            if (validator != null)
            {
                validator.validate(field, a, o); // statically unsafe
            }
        }
    }
}

public void addValidator(AFV<?> v)
{
    validators.put(v.getSupportedAnnotationClass(), v);
} 
```

请注意，该调用`validator.validate`现在是静态不安全的，编译器将发出警告。但如果你能忍受这一点，这可能会。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T14:19:15.520

谢谢大家的回答，它确实帮助我找到了以下解决方案。

flicken 的回答向我展示了方法：我必须将一些代码提取到参数化方法中。`validators.get()`但我可以提取整个验证过程，而不是提取方法。这样做，我可以使用程序化强制转换（我认为这没问题，因为我控制了键值映射的连贯性）：

```
public void validate(Object o) {
  Field[] fields = getFields(o.getClass());
  for (Field field : fields) {
    Annotation[] annotations = field.getAnnotations();
    for (Annotation annotation : annotations) {
      AnnotatedFieldValidator<? extends Annotation> validator = 
          validators.get(annotation.annotationType());
      if (validator != null) {
        doValidate(field, validator, annotation, o);
      }
    }
  }
} 
```

然后，doValidate() 方法如下：

```
private <A extends Annotation> void doValidate(Field field, 
      AnnotatedFieldValidator<A> validator, Annotation a, Object o) {
    // I assume this is correct following only access to validators Map
    // through addValidator()
    A annotation = validator.getSupportedAnnotationClass().cast(a);
    try {
        validator.validate(field, annotation, bean, beanName);
    } catch (IllegalAccessException e) {
    }
} 
```

没有演员表（好的，除了 Class.cast()...），没有未经检查的警告，没有原始类型，我很高兴。

# git - Git 每隔一段时间就会饿死文件

> ID：515578
> 
> 赞同：4
> 
> 时间：2009-02-05T11:52:37.453
> 
> 标签：git

我的 Git 存储库经常出现问题。我在 Windows 中开发，我的生产站点在 Linux 下。有好几次，git 将所有跟踪的文件显示为已修改。我以为这是因为 Windows 和 Linux 之间的 conf 问题或冲突，但是今天早上，当我检查 Linux 存储库时，它显示所有文件都已修改。

雪上加霜的是，我使用的两个 Linux 存储库（1 个用于生产，1 个用于测试）显示相同。我别无选择，只能提交所有文件，因为硬重置或签出不会对工作目录进行任何更改（是的，我对此非常糟糕）。这是提交的结果：

```
Created commit #######: Git, you are so mean...
1521 files changed, 302856 insertions(+), 302856 deletions(-) 
```

关于下次发生这种情况时如何解决的任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-05T17:54:49.283

正如 Bombe 所说，这听起来像是一个行尾问题。我见过的最简单的讨论是Github 上的[这个指南](http://github.com/guides/dealing-with-newlines-in-git)。

您想`core.autocrlf`在 Windows 系统上进行设置，以便当您从 repo 签出到工作目录时 Git 会自动将行尾更改为 CRLF，而当您将文件提交到 repo 时，相反地将所有 CRLF 更改为 LF：

```
$ git config --global core.autocrlf true 
```

然后，您可以通过从 Linux 存储库克隆或通过 来确保您的存储库具有一致的行结尾`git reset`，这会检查出一个新的工作副本，该副本将新的 autocrlf 设置应用于所有 LF：

```
$ git reset --hard HEAD 
```

编辑——如果 Git 不能将文件识别为二进制文件，`autocrlf`则可以通过更改它认为是 CRLF 或 LF 的内容来破坏文件。如果您的 repo 包含不寻常的二进制格式文件类型，请在 中明确声明它们的转换类型`.gitattributes`，如[手册页](http://git-scm.com/docs/gitattributes)中所述。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-05T12:06:39.970

Sounds like a line-ending issue. Check [man git-config](http://git-scm.com/docs/git-config) for `core.autocrlf`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T22:40:02.203

我认为您需要解决的真正问题是文件有何不同以及您期望看到的差异是什么？

传统的默认设置是 git 根本不会更改`git add`存储库上的文件内容。最新的 Windows`git`安装程序启用`core.autocrlf`，它在结帐时将 unix 转换为 Windows 行尾，而在添加到存储库时则相反。

`git add`出于这个原因，如果您有更多预期的未跟踪更改，那么对所有待处理文件（例如通过 a ）通常是一个好主意`git add -u`。

在这个阶段，任何清洁/涂抹过滤器都将被应用，并且`git diff --cached`应该给出合理的差异。

如果您暂存了 git 认为不同的文件，但差异不可见，您可能需要查看原始字节以查看不可见字符是否有任何差异。

您可以使用诸如此类的工具`hexdump`。

假设`myfile.txt`有不可见的差异，您可能想尝试这样的事情。

```
# Extract raw versions of the differing files and hexdump to some temporary files
git cat-file blob :myfile.txt | hexdump -C >myfile-stagetmp.bytes
git cat-file blob HEAD:myfile.txt | hexdump -C >myfile-headtmp.bytes

# Diff them. (Yes, you don't have to use git diff!)
git diff --no-index myfile-stagetmp.bytes myfile-headtmp.bytes 
```

# java-me - 如何对齐标签的 textPosition？

> ID：515580
> 
> 赞同：1
> 
> 时间：2009-02-05T11:53:20.713
> 
> 标签：java-me, label, midlet, lwuit

我想知道是否可以为`textPosition()`包含`Label`一个`Image`和一个文本部分的 a 进行设置，以便文本既是顶部又是左侧。The problem I have now is that I need the text to be TOP but when that is selected the text is centered over the image. 我的愿望是文本在图像上方，但在左侧而不是居中。我想知道是否有办法做到这一点？

我试图将文本添加到一个`Label`，将图像添加到另一个`Label`，然后将它们包含在一个容器中，但问题是所有项目（图像上的文本）和项目上的项目的对齐方式都是相同的。因此，无法查看第二张图像上的文本是第一张图像的一部分还是第二张图像的一部分。

谢谢。

* * *

好的，这就是我的意思。这是当前的行为：

```
Label item = new Label();
item.setIcon(icon);
item.setText("House:");
item.setTextPosition(TOP); 
```

结果：

```
House:

 /\ 
```

想要的行为是：

```
Label item = new Label();
item.setIcon(icon);
item.setText("House:");
item.setTextPosition(TOP);
item.setTextPosition(LEFT); 
```

房子：

```
/\ 
```

我需要将 TextPosition 设置为 Top 和 left，这可能吗？或者有没有其他方法可以让我得到这种行为。如果我使用容器，结果将是：

房子：

```
/\ 
```

房子：

```
/\ 
```

我想要的是“House：”和 /\ 之间的对齐方式与“House：”和上面的 /\ 是分开的。

我希望这有任何意义。很难用好的方式解释它。感谢你给与我的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-10-27T05:15:48.273

在一个容器中使用两个标签来实现这一点，一个用于图标，另一个用于文本。这样的配置有无数种，我们添加的支持越多，标签渲染就越复杂和缓慢，它的 API 也变得更加复杂。

# c++ - 我是否需要在 push_back pop_front 场景中使用互斥锁锁定 STL 列表？

> ID：515587
> 
> 赞同：8
> 
> 时间：2009-02-05T11:54:16.953
> 
> 标签：c++, multithreading, stl

我有一个线程推送到 STL 列表，另一个线程从列表中弹出。在这种情况下，我需要用互斥锁锁定列表吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-05T12:02:19.057

来自[SGI 关于线程安全的 STL](http://www.sgi.com/tech/stl/thread_safety.html)：

> 如果多个线程访问单个容器，并且至少一个线程可能写入，则用户负责确保容器访问期间线程之间的互斥。

由于您的两个线程都修改了列表，我想您必须锁定它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T12:33:48.573

大多数 STL 实现都是线程安全的，因为您可以从*多个线程*访问列表类型的*多个实例*而无需锁定。但是当您访问列表的同一实例时，您必须锁定。

 *查看更多信息：[thread safty in sgi stl](http://www.sgi.com/tech/stl/thread_safety.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T12:00:11.527

大概。这些操作不够简单，不足以成为原子操作，因此只有在实现显式执行必要的锁定时，它们才会是线程安全的。

但是，C++ 标准并没有指定这些操作是否应该是线程安全的，因此由各个实现来决定。检查文档。（或者让我们知道您正在使用哪个实现）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T12:00:41.400

不能保证 STL 实现是线程安全的，而且由于它会牺牲性能，我猜大多数都不是。您绝对应该使用互斥锁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T12:01:27.110

由于 stl pop / push 操作是 AFAIK 非原子操作，因此您必须使用互斥锁。

# java - 在防火墙上使用 JDBC 以外的其他东西

> ID：515590
> 
> 赞同：2
> 
> 时间：2009-02-05T11:54:26.437
> 
> 标签：java, jdbc, firewall

我有一个简单的服务器-客户端应用程序，它使用 JDBC 连接到数据库，一切正常。应用程序使用 JDBC 连接做一些简单的事情（获取数据、插入新行和其他一些事情）。

现在，我想保留相同的应用程序，但在防火墙之外使用它 - 所以，我会在一些主机上放置其他东西：端口（并将该端口开放给外界） - 而不是 JDBC 直接打开数据库访问。

我想这个问题已经多次面临，并且肯定有很多方法。
一种方法是在一侧执行 servlet，在客户端访问它。
我想，我还没有接触过 Spring，也许另一个是做 POJO Java 类并使用 Spring 将其配置为 http 服务。我还听说 Jetty 在这种情况下可以提供帮助的“谣言”（以最小化服务器和客户端的编码）

我更喜欢这样的东西：
- 不复杂（简单的学习路径）
- 重用已经完成的东西。

你会推荐什么方法？

谢谢你和问候，
伊戈尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T12:00:17.627

正常的方法是实现一个 Web 服务，现在使用 Axis 等非常容易。

您真的不想通过 HTTP 隧道向防火墙外的客户端打开直接 JDBC ......服务器应该*严格*控制与数据库发生的交互类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T12:02:37.140

我建议使用 SSH 隧道之类的东西来通过防火墙传输 JDBC 连接。在 DMZ 机器上的任何公共开放端口上设置隧道，并将隧道的另一端连接到数据库服务器上的适当端口。

然后只需更改您的 JDBC 连接设置以连接到隧道机器的公共端口，它将像往常一样透明地与数据库通信，同时通过接受的端口通过防火墙。

如果这是一个 IT 政策问题，因为他们不允许您直接访问数据库，那么您需要弄清楚您*可以*做什么并尽可能地使用它。在这种情况下，IT 策略不太可能接受将 JDBC 更改为另一种访问方法。

**编辑**：阅读乔恩的回答后，他可能是对的。我假设问题是您的服务器/webapp 和数据库服务器之间的连接。如果您谈论的是客户端创建与数据库的直接 JDBC 连接，那么是 - 防火墙或否，这是非常糟糕的做法。客户端应该与您的服务器交谈以询问它想要什么，并且您的服务器应该根据需要执行数据库查询以获取信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T12:40:03.833

我认为这只是一个不必要的并发症。您的 DBMS（通常）会带来访问控制和传输层安全性。如果您引入自己的层，您确定可以使其比直接连接到数据库更安全吗？

我明白你的理由，但如果没有框架可以做到这一点，请避免构建自己的！例如，PostgreSQL 提供了一堆漂亮的选项来约束事情。例如，*需要*在传输级别基于 SSL 证书的身份验证（客户端必须提供服务器检查的证书），或基于 IP 的访问。

当然，您仍然必须信任您的 DBMS 实现才能获得访问控制权（=“不可破解”）等基本细节，但是在黑帽入侵您的网络代理后，您仍然需要依赖它；）

@dtsazza：也许编辑您的答案以包含关键字“VPN”？ssh 隧道在私有设置之外可能会严重扩展。

沃尔克

# php - 是否有一段公共代码可用于使用 PHP 创建页面索引？

> ID：515591
> 
> 赞同：1
> 
> 时间：2009-02-05T11:54:31.883
> 
> 标签：php, indexing, pagination

我有一个 MySQL 表，里面有很多我想让用户访问的记录。我不想将整个表转储到页面，所以我需要一次将它分成 25 条记录，所以我需要一个页面索引。您可能已经在其他页面上看到过这些，它们在页面底部看起来像这样：

< 1 2 3 4 **5** 6 7 8 9 >

例如，当用户单击“4”链接时，页面会刷新并且偏移量会继续移动（第 4 页 x 25 条记录）。这是我已经拥有的：

```
function CreatePageIndex($ItemsPerPage, $TotalNumberOfItems, $CurrentOffset, $URL, $URLArguments = array())
{
    foreach($URLArguments as $Key => $Value)
    {
        if($FirstIndexDone == false)
        {
            $URL .= sprintf("?%s=%s", $Key, $Value);
            $FirstIndexDone = true;
        }
        else
        {
            $URL .= sprintf("&%s=%s", $Key, $Value);
        }
    }

    Print("<div id=\"ResultsNavigation\">");
        Print("Page: ");
        Print("<span class=\"Links\">");
            $NumberOfPages = ceil($TotalNumberOfItems / $ItemsPerPage);
            for($x = 0; $x < $NumberOfPages; $x++)
            {
                if($x == $CurrentOffset / $ItemsPerPage)
                {
                    Print("<span class=\"Selected\">".($x + 1)." </span>");
                }
                else
                {
                    if(empty($URLArguments))
                    {
                        Print("<a href=\"".$URL."?Offset=".$x * $ItemsPerPage."\">".($x + 1)."</a> ");
                    }
                    else
                    {
                        Print("<a href=\"".$URL."&Offset=".$x * $ItemsPerPage."\">".($x + 1)."</a> ");
                    }
                }
            }
            Print("</span>");
            Print(" (".$TotalNumberOfItems." results)");
    Print("</div>");
} 
```

显然，这段代码不会创建动态索引，它只是将整个索引转储到每个可用页面的页面底部。我需要的是一个动态的解决方案，它只显示前 5 页和后 5 页（如果存在）以及 >> 或向前移动 5 页左右的内​​容。

任何人都看到了一种优雅且可重复使用的实现方式，因为我觉得我正在重新发明轮子？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T12:16:35.440

[Zend Framework](http://framework.zend.com/)正在成为一个有用的集合，并包含一个[Zend_Paginator](http://framework.zend.com/manual/en/zend.paginator.html)类，这可能值得一看。有点学习曲线，如果您想花时间使用框架中的其他类，这可能是值得的。

不过，自己动手并不难。使用 COUNT(*) 查询获取总记录数，然后使用 LIMIT 子句获取一页结果。

例如，如果您希望每页 20 个项目，则第 1 页的 LIMIT 0,20 而第 2 页的 LIMIT 20,20，例如

```
$count=getTotalItemCount();
$pagesize=20;

$totalpages=ceil($count/$pagesize);

$currentpage=isset($_GET['pg'])?intval($_GET['pg']):1;
$currentpage=min(max($currentpage, 1),$totalpages);

$offset=($currentpage-1)*$pagesize;

$limit="LIMIT $offset,$pagesize"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T12:26:44.500

它被称为分页：

几个例子：

1.  [一个不错的没有 SQL 的](https://stackoverflow.com/questions/207223/php-dynamic-pagination-without-sql)
2.  [很长的教程](http://www.sitepoint.com/article/perfect-php-pagination/)
3.  [另一个教程](http://www.tonymarston.net/php-mysql/pagination.html)
4.  [还有一个](http://php.about.com/od/phpwithmysql/ss/php_pagination.htm)
5.  当然..[谷歌](http://www.google.com.ar/search?q=php+pagination)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T12:05:53.043

这个 jQuery 插件怎么样？所以所有的工作都是在客户端完成的。

[http://plugins.jquery.com/project/pagination](http://plugins.jquery.com/project/pagination)

演示：[http ://d-scribe.de/webtools/jquery-pagination/demo/demo_options.htm](http://d-scribe.de/webtools/jquery-pagination/demo/demo_options.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T13:47:05.413

这是我挖出的一个旧类，我曾经在 PHP 中使用过。现在我用 Javascript 处理大部分内容。该对象接受一个数组（用于将堆栈拆分为页面）并返回当前视图。这在巨大的桌子上可能会变得乏味，所以请记住这一点。我通常用它来翻阅少于 1000 个项目的小型数据集。它还可以选择为您生成跳转菜单。

```
class pagination {

function pageTotal($resultCount, $splitCount) {
    if (is_numeric($resultCount) && is_numeric($splitCount)) {
        if ($resultCount > $splitCount) {
            $pageAverage = (integer)$resultCount / $splitCount;
            $pageTotal = ceil($pageAverage);
            return $pageTotal;
        } else {
            return 1;
        }
    } else {
        return false;
    }
}

function pageTotalFromStack($resultArray, $splitCount) {
    if (is_numeric($splitCount) && is_array($resultStack)) {
        if (count($resultStack) > $splitCount) {
            $resultCount = count($resultStack);
            $pageAverage = (integer)$resultCount / $splitCount;
            $pageTotal = ceil($pageAverage);
            return $pageTotal;
        } else {
            return 1;
        }
    } else {
        return false;
    }
}

function makePaginationURL($preURL, $pageTotal, $selected=0, $linkAttr=0, $selectedAttr=0) {
    if (!empty($preURL) && $pageTotal >= 1) {
        $pageSeed = 1;
        $passFlag = 0;
        $regLink = '<a href="{url}&p={page}"';
            if (is_array($linkAttr)) $regLink .=  $this->setAttributes($linkAttr); //set attributes
        $regLink .= '>{page}</a>';

        $selLink = '<a href="{url}&p={page}"';
            if (is_array($selectedAttr)) $selLink .=  $this->setAttributes($selectedAttr); //set attributes
        $selLink .= '>{page}</a>';

        while($pageSeed <= $pageTotal) {
            if ($pageSeed == $selected) {
                $newPageLink = str_replace('{url}', $preURL, $selLink);
                $newPageLink = str_replace('{page}', $pageSeed, $newPageLink);
            } else {
                $newPageLink = str_replace('{url}', $preURL, $regLink);
                $newPageLink = str_replace('{page}', $pageSeed, $newPageLink);
            }
            if ($passFlag == 0) {
                $passFlag = 1;
                $linkStack = $newPageLink;
            } else {
                $linkStack .= ', ' . $newPageLink;
            }
            $pageSeed++;
        }
        return $linkStack;
    } else {
        return false;
    }
}

function splitPageArrayStack($stackArray, $chunkSize) {
    if (is_array($stackArray) && is_numeric($chunkSize)) {
        return $multiArray = array_chunk($stackArray, $chunkSize);
    } else {
        return false;
    }
} 
```

}

# javascript - rc6 中的 jQuery UI 选项卡是否损坏？

> ID：515604
> 
> 赞同：0
> 
> 时间：2009-02-05T11:59:06.943
> 
> 标签：javascript, jquery

我使用 jQuery UI v1.6rc2 已经有一段时间了，想升级到 1.6rc6 看看他们没有做出任何重大改变。似乎他们有；每当我切换到 rc6 时，我的所有选项卡都会停止工作。

好像有两点不对。首先，手册提倡使用以下内容：

```
$('#container').tabs(); 
```

但是，对于 rc2，我总是不得不这样做：

```
$('#container > ul').tabs(); 
```

所以当 rc6 生效时，这些方法都不起作用。

此外，安装 rc6 时 Firebug 报告以下错误：

```
$.Event is not a function.
this.namespace+'-state-disabled').attr("...event[prop]=event.originalEvent[prop];}} 
```

在调用 .tabs() 之前执行的所有 Javascript/jQuery 都可以正常工作。它在 Firefox 和 Chrome 中都中断了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T12:18:41.740

您需要升级到 jQuery 核心版本 1.3.1
UI 1.6rc6 仅适用于 1.3.1

# oop - 封装通用逻辑（领域驱动设计、最佳实践）

> ID：515608
> 
> 赞同：2
> 
> 时间：2009-02-05T11:59:59.983
> 
> 标签：oop, domain-driven-design, theory, encapsulation

**更新：** 09/02/2009 - 修订问题，提供更好的示例，增加赏金。

* * *

嗨，
我正在使用数据库和实体（域对象）之间的数据映射器模式构建一个 PHP 应用程序。我的问题是：

*封装通常执行的任务的最佳方法是什么？*

例如，一项常见任务是从站点映射器检索一个或多个站点实体，并从页面映射器检索它们的关联（主页）页面实体。目前，我会这样做：

```
$siteMapper = new Site_Mapper();
$site = $siteMapper->findByid(1);

$pageMapper = new Page_Mapper();
$site->addPage($pageMapper->findHome($site->getId())); 
```

现在这是一个相当微不足道的例子，但实际上它变得更加复杂，因为每个站点也有一个关联的语言环境，并且页面实际上有多个修订版（尽管出于本任务的目的，我只对最近的一个感兴趣）。

我将需要在我的应用程序中的多个位置执行此操作（获取站点和关联的主页、区域设置等），并且我想不出封装此任务的最佳方式/位置，所以我不会必须到处重复。理想情况下，我希望得到这样的结果：

```
$someObject = new SomeClass();
$site = $someObject->someMethod(1); // or
$sites = $someObject->someOtherMethod(); 
```

生成的站点实体已创建关联实体并可供使用。

保存这些对象时也会出现同样的问题。假设我有一个站点实体和关联的主页实体，并且它们都已被修改，我必须执行以下操作：

```
$siteMapper->save($site);
$pageMapper->save($site->getHomePage()); 
```

同样，微不足道，但这个例子被简化了。重复代码仍然适用。

在我看来，拥有某种可以处理的中心对象是有意义的：

*   检索一个（或多个）站点和所有必要的关联实体
*   使用新的关联实体创建新的站点实体
*   获取一个（或多个站点）并保存它和所有关联实体（如果它们已更改）

所以回到我的问题，这个对象应该是什么？

*   现有的映射器对象？
*   基于存储库模式的东西？*
*   基于工作模式的东西？*
*   还有什么？

*正如您可能猜到的那样，我不*完全理解其中任何一个。*

有没有解决这个问题的标准方法，有人可以提供他们如何实现它的简短描述吗？我不是在寻找任何人来提供一个完全有效的实现，只是理论。

谢谢，
杰克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T19:55:13.057

使用存储库/服务模式，您的存储库类将为您的每个实体提供一个简单的 CRUD 接口，然后服务类将是一个附加层，它执行附加逻辑，如附加实体依赖项。然后，您的应用程序的其余部分仅使用服务。您的示例可能如下所示：

```
$site = $siteService->getSiteById(1); // or
$sites = $siteService->getAllSites(); 
```

然后在 SiteService 类中，您将拥有如下内容：

```
function getSiteById($id) {
  $site = $siteRepository->getSiteById($id);
  foreach ($pageRepository->getPagesBySiteId($site->id) as $page)
  {
    $site->pages[] = $page;
  }
  return $site;
} 
```

我不太了解PHP，所以如果语法上有问题，请原谅。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T00:39:12.803

**[编辑：此条目试图解决这样一个事实，即编写自定义代码来直接处理情况通常比尝试将问题融入模式更容易。]**

模式在概念上很好，但它们并不总是“映射”。经过多年的高端 PHP 开发，我们已经确定了一种非常直接的方式来处理此类问题。考虑一下：

文件：Site.php

```
class Site
{
   public static function Select($ID)
   {
      //Ensure current user has access to ID
      //Lookup and return data
   }

   public static function Insert($aData)
   {
      //Validate $aData
      //In the event of errors, raise a ValidationError($ErrorList)

      //Do whatever it is you are doing

      //Return new ID
   }

   public static function Update($ID, $aData)
   {
      //Validate $aData
      //In the event of errors, raise a ValidationError($ErrorList)

      //Update necessary fields
   } 
```

然后，为了（从任何地方）调用它，只需运行：

```
$aData = Site::Select(123);

Site::Update(123, array('FirstName' => 'New First Name'));

$ID = Site::Insert(array(...)) 
```

关于 OO 编程和 PHP 要记住的一件事...... PHP 不会在请求之间保持“状态”，因此创建一个对象实例只是为了立即销毁它通常没有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T07:05:22.137

我可能会首先将常见任务提取到某个辅助方法中，然后等待查看设计要求的内容。感觉现在说还为时过早。

你会给这个方法起什么名字？该名称通常暗示方法所属的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T01:19:03.723

```
class Page {

  public $id, $title, $url;

  public function __construct($id=false) {
    $this->id = $id;
  }

  public function save() {
    // ...
  }

}

class Site {

  public $id = '';
  public $pages = array();

  function __construct($id) {
     $this->id = $id;
     foreach ($this->getPages() as $page_id) {
       $this->pages[] = new Page($page_id);
     }
  }

  private function getPages() {
    // ...
  }

  public function addPage($url) {
    $page = ($this->pages[] = new Page());
    $page->url = $url;
    return $page;
  }

  public function save() {
    foreach ($this->pages as $page) {
      $page->save();
    } 
    // ..
  }

}

$site = new Site($id);
$page = $site->addPage('/');
$page->title = 'Home';
$site->save(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T01:04:31.363

使您的 Site 对象成为[Aggregate Root](http://domaindrivendesign.org/discussion/messageboardarchive/Aggregates.html)以封装复杂的关联并确保一致性。

然后创建一个[SiteRepository](http://domaindrivendesign.org/discussion/messageboardarchive/Repositories.html)，负责检索站点聚合并填充其子项（包括所有页面）。

您将不需要单独的 PageRepository（假设您不将 Page 设为单独的聚合根），并且您的 SiteRepository 也应该负责检索 Page 对象（在您的情况下，使用现有的映射器）。

所以：

```
$siteRepository = new SiteRepository($myDbConfig);
$site = $siteRepository->findById(1); // will have Page children attached 
```

然后该`findById`方法还负责查找站点的所有页面子项。这将具有与 CodeMonkey1 给出的答案类似的结构，但是我相信您将通过使用聚合和存储库模式受益更多，而不是为此任务创建特定的服务。站点聚合的任何其他检索/查询/更新，包括其任何子对象，都将通过相同的 SiteRepository 完成。

编辑：[这是一个简短的 DDD 指南](http://www.infoq.com/minibooks/domain-driven-design-quickly)，可以帮助您了解术语，但如果您想要了解全貌，我真的建议您阅读[Evans 。](http://domaindrivendesign.org/books/index.html#DDD)

# c - 将整数转换为数组

> ID：515612
> 
> 赞同：10
> 
> 时间：2009-02-05T12:00:34.413
> 
> 标签：c, arrays

我正在尝试将 C 中的整数转换为包含该数字的每个数字的数组

即如果我有

```
int number = 5400 
```

我怎么去

```
int numberArray[4] 
```

在哪里

```
numberArray[0] = 0;
numberArray[1] = 0;
numberArray[2] = 4;
numberArray[3] = 5; 
```

任何建议都非常感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-05T12:02:41.617

提示：看一看这个较早的问题“ [C# 中的数字总和](https://stackoverflow.com/questions/478968/sum-of-digits-in-c)”。它解释了如何使用几种方法提取数字中的数字，其中一些与 C 相关。

来自[Greg Hewgill 的回答](https://stackoverflow.com/questions/478968/sum-of-digits-in-c/478974#478974)：

```
/* count number of digits */
int c = 0; /* digit position */
int n = number;

while (n != 0)
{
    n /= 10;
    c++;
}

int numberArray[c];

c = 0;    
n = number;

/* extract each digit */
while (n != 0)
{
    numberArray[c] = n % 10;
    n /= 10;
    c++;
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-05T12:15:32.853

这适用于数字 >= 0

```
#include <math.h>

char * convertNumberIntoArray(unsigned int number) {
    int length = (int)floor(log10((float)number)) + 1;
    char * arr = new char[length];
    int i = 0;
    do {
        arr[i] = number % 10;
        number /= 10;
        i++;
    } while (number != 0);
    return arr;
} 
```

编辑：只是多一点 C 风格，但更神秘。

```
#include <math.h>

char * convertNumberIntoArray(unsigned int number) {
    unsigned int length = (int)(log10((float)number)) + 1;
    char * arr = (char *) malloc(length * sizeof(char)), * curr = arr;
    do {
        *curr++ = number % 10;
        number /= 10;
    } while (number != 0);
    return arr;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-05T14:06:02.910

You could calculate the number of digits in an integer with logarithm rather than a loop. Thus,

```
int * toArray(int number)
{
    int n = log10(number) + 1;
    int i;
    int *numberArray = calloc(n, sizeof(int));
    for ( i = 0; i < n; ++i, number /= 10 )
    {
        numberArray[i] = number % 10;
    }
    return numberArray;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-04T14:16:42.000

Try this,

```
void initialise_array(int *a, int size, int num) {
    for (int i = 0; i < size; ++i, num /= 10)
        a[(size - 1) - i] = num % 10;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T12:46:11.747

If you need to take negative numbers into account, you might need some extra logic. In fact, when playing around with arrays you don't know the size of upfront, you may want to do some more safety checking, and adding an API for handling the structure of the data is quite handy too.

```
// returns the number of digits converted
// stores the digits in reverse order (smalles digit first)
// precondition: outputdigits is big enough to store all digits.
//
int convert( int number, int* outputdigits, int* signdigit ) {

  int* workingdigits = outputdigits;

  int sign = 1;
  if( number < 0 ) { *signdigit = -1; number *= -1; }
  ++workingdigits;

  for ( ; number > 0; ++ workingdigits ) {
    *workingdigits = number % 10;
    number = number / 10;
  }

  return workingdigits - outputdigits;
}

void printdigits( int* digits, int size, int signdigit ) {
  if( signdigit < 0 ) printf( "-" );

  for( int* digit = digits+size-1; digit >= digits; --digit ){
    printf( "%d", *digit );
  }
}

int main() {
   int digits[10];
   int signdigit;
   printdigits( digits, convert( 10, digits, &signdigit ), signdigit );
   printdigits( digits, convert( -10, digits, &signdigit ), signdigit );
   printdigits( digits, convert( 1005, digits, &signdigit ), signdigit );

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-09T11:51:18.733

```
#include <stdio.h>
#include <string.h>

int main(void)
{
  int i, inputNumber;
  char* charArray;

  printf("\nEnter number: ");
  scanf("%d", &inputNumber);

  /* converts int to print buffer which is char array */
  sprintf(charArray, "%d", inputNumber); 
  int size = strlen(charArray);

  int intArray[size];

  for (i = 0; i < size; i++)
  {
    intArray[i] = charArray[i] - '0';
  }

  return 0;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-05T12:24:56.267

C代码：

```
/* one decimal digit takes a few more than 3 bits. (2^3=8, 2^4=16) */
int digits[(sizeof (int) * CHAR_BIT) / 3 + 1], 
    *digitsp = digits;
do {
    *digitsp++ = number % 10;
    number /= 10;
} while(number > 0); 
```

您将看到通过取差值转换了多少位

```
digitsp - digits 
```

如果要将其放入函数中：

```
#define MIN_DIGITS_IN_INT ((sizeof (int) * CHAR_BIT) / 3 + 1)

int to_array(int number, int *digits) {
    int *digitsp = digits;
    do {
        *digitsp++ = number % 10;
        number /= 10;
    } while(number > 0);
    return digitsp - digits;
}

int main() {
    int number = rand();
    int digits[MIN_DIGITS_IN_INT];
    int n = to_array(number, digits);

    /* test whether we're right */
    while(n-- > 0) 
        printf("%d", digits[n]);
    }
    printf(" = %d\n", number);
} 
```

在这种情况下，我更喜欢自动数组而不是动态内存分配，因为它更容易正确执行并且不会意外泄漏。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-05T15:38:26.673

using vadim's code, I came up with this test program:

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

char * convertNumberIntoArray(unsigned int number) {
    unsigned int length = (int)(log10((float)number)) + 1;
    char * arr = (char *) malloc(length * sizeof(char)), * curr = arr;
    do {
        *curr++ = number % 10;
        number /= 10;
    } while (number != 0);
    return arr;
}

int main(void)
{
    int InputNumber;
    int arr[5];

    printf("enter number: \n");
    scanf("%d", &InputNumber);

    convertNumberIntoArray(InputNumber);

    printf("The number components are: %d %d %d\n", arr[0],arr[1],arr[2]);

    system("PAUSE");    
    return 0;
} 
```

but the output is garbage. Can anyone advise if I have done something stupid here?

```
/***** output *****/
enter number:
501
The number components are: 2009291924 2009145456 -1
Press any key to continue . . . 
```

--dave

# shell - #的首选方式！在 shell 脚本中

> ID：515620
> 
> 赞同：5
> 
> 时间：2009-02-05T12:02:06.813
> 
> 标签：shell

我搜索了谷歌，但找不到这个相当简单的问题的答案。我有一个 python 脚本，第一行有 hash-bang (#!)：

```
#!/usr/bin/python 
```

但是，如果这是在 /bin/python 或 /usr/local/bin/python 或其他地方的带有 python 的计算机上运行呢？必须有更好的方法来为 shell 脚本设置解释器。应该可以通过 $PATH 设置它，因为如果它安装在系统上，它将知道在哪里可以找到 python。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-05T12:03:58.883

使用环境。

```
#!/usr/bin/env python 
```

它不是万无一失的，但它涵盖的情况比 /usr/bin/python 更多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T12:04:14.343

采用

```
#!/usr/bin/env python 
```

`env`几乎总是在 中`/usr/bin`，并将执行 中的任何程序`PATH`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T12:04:50.567

有些人喜欢从以下开始：

```
#!/usr/bin/env python 
```

Not sure that this is a vast improvement as you're now assuming that python is in the path and that it's the right version, but it's an option.

# java - Speed: Java serialization or csv?

> ID：515631
> 
> 赞同：0
> 
> 时间：2009-02-05T12:04:51.127
> 
> 标签：java, serialization, csv, performance

I have a large array of Java simple structs (consists of just primitive members) and I need to save and load them from and to a file

What would be faster,

*   implementing *java.io.Serializable* and using *read/writeObject* **or**
*   overriding *toString()* / *toCSV()*, adding a new constructor and reading/writing to text file?

I want to avoid binary stream at this stage.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T12:08:34.380

Serialization is usually faster. You save time parsing the file manually when reading it back in. However, the CSV approach would be more flexible over time and different implementations of your program.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T12:09:51.210

I would suggest you to write a sample test and see which one is faster.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T12:45:12.060

这里有很多选择。您可能需要考虑使用[协议缓冲区](http://code.google.com/p/protobuf/)——它们*非常*快，并且独立于平台。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T12:19:42.847

Depending on the final application, you could also consider using XStream (or similar library) to export/import XML.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T12:31:57.110

Java 序列化在后台做了很多事情，这可能会使实际的反序列化步骤比从文件中读取和手动实例化对象更快。但是，有很多微妙的问题需要考虑，如果您打算将序列化用于“严肃”的工作，您可能应该首先参考 Josh Bloch 的“Effective Java”，因为他用一整章的时间来讨论这个主题。

但是，如果您一次性执行此操作，并且不希望序列化类的格式在执行之间发生变化（例如，不添加方法或字段），您可能会没事。

不过，我可能误解了你的问题。“什么会更快”也可能意味着您想知道哪种方法*实施起来*更快。可能是您已经最熟悉的那个。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-05T13:06:46.760

可能没关系。如果数组小到足以保存在内存中，它可能会很快被写入。如果应用程序只写入一次数据，那么我只会写最简单的东西。

另一方面，如果应用程序寿命很长并且不断地读写数据，那么您将需要进行优化。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-05T22:47:30.923

我在序列化方面做了很多我可以用 CSV 文件完成的工作。

序列化的好处是速度、类型安全和互操作性（RMI、EHcache 等）。缺点是必须对对象进行版本化并且必须编写查看器（以启用检查）。

CSV 速度较慢，并且可以更大。好处是您可以在文本编辑器、Excel 等中查看它们。

除非速度或大小是问题，否则我会选择 CSV。

您还可以使用 XStream 并将它们编写为 XML 或 JSON。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-13T17:17:41.673

为什么要限制自己做这些选择？明显的候选者是 JSON，使用与[Jackson](http://jackson.codehaus.org)或[Google-GSON 的](http://code.google.com/p/google-gson/)简单数据绑定。可读性强，比手写 CSV 更快；plus 处理 CSV 不能处理的情况。可能也比 JDK 序列化更快，并且更灵活（如果/当类以最小的方式更改时，序列化很棘手）。

# ruby - Ruby 在 Windows 上找不到 sqlite3 驱动程序

> ID：515639
> 
> 赞同：10
> 
> 时间：2009-02-05T12:07:08.127
> 
> 标签：ruby, sqlite

我正在尝试在 Windows 上设置 Ruby on Rails。我正在使用看起来不错的 Flash Rails 发行版，但是 sqlite3 存在问题。我发现线程告诉我安装 1.2.3 版，它安装得很好。我正在使用 ruby​​ 1.9.0，每次尝试运行使用数据库的脚本（例如 rake db:create）时，我都会收到一条错误消息“找不到 sqlite3 的驱动程序”。

这显然是缺少 sqlite3.dll，但我的 %PATH% 中有 dll，我还尝试将其复制到我从中运行脚本的目录中，即 sqlite3 ruby​​ 代码所在的目录。

有没有人有任何想法？如果可能的话，我希望所有的红宝石东西都是独立的，这样我就可以从笔式驱动器中使用它。

编辑：澄清一下，我已经使用 gem install 来安装 ruby​​-sqlite3 gem - 它只是不起作用，因为它找不到 sqlite3.dll（即使它实际上存在于我的 %PATH% 上的目录中）

编辑第 2 部分：在进行了更多挖掘之后，出现 ruby​​ 不会加载 sqlite3_api.dll 的问题。我已经将它复制到我的文件系统中，我只是无法读取文件。同一目录中的其他 dll 库（例如 zlib.dll）工作正常！我尝试将dll安装到system32中，但这也不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-21T02:27:00.730

简单来说问题是 sqlite3-ruby 1.2.3 与 ruby​​ 1.9 不兼容。这是因为 ruby​​ 1.9 没有将 .dll 文件用于 c 库，而是使用 .so 文件。此外，由于 sqlite3_api.dll 是针对 msvcrt-ruby18.dll 编写的。这意味着它只支持 ruby​​ 1.8.*。

好消息是有一个胖二进制版本将同时支持 ruby​​ 1.8 和 ruby​​ 1.9。卸载所有以前版本的 sqlite3-ruby，然后安装这个。（您可能必须在卸载后手动删除 gem 的某些版本。）为了安装它，请使用

```
install sqlite3-ruby --source http://gems.rubyinstaller.org 
```

欲了解更多信息，请参阅[本](http://blog.mmediasys.com/2009/07/06/getting-started-with-rails-and-sqlite3/)网站

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T12:20:06.620

尝试安装 sqlite3-ruby gem：

```
gem install sqlite3-ruby 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-14T01:52:22.513

最近发生了类似的事情，所以我想我会更新我的答案。

作为参考，在 gem 的 lib 目录中有一个 sqlite3_api.dll 文件。sqlite3.dll 文件也需要在路径上可访问。它们是不同的文件，gem 需要第一个文件来将 Ruby 与 C 代码接口，而第二个文件包含实际的 Sqlite 实现。

最好从 sqlite 网站获取第二个文件并将其解压缩到 Ruby\bin 目录（因为您不应再手动将 DLL 放入 windows 或 windows\system 目录）。

所以作为参考“sqlite3_api.dll”需要在：

```
Ruby\lib\ruby\gems\1.8\gems\sqlite3-ruby-1.2.3-x86-mswin32\lib 
```

并且“sqlite3.dll”需要在路径上，可能在：

```
Ruby\bin 
```

至于“找不到驱动程序”问题，我建议先尝试简单的事情，并确保 gems 安装正确、最新，并且 RUBYLIB 和 PATH 环境变量设置正确。（可能需要重新启动系统才能完全传播更改。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-01-13T22:01:22.330

[重新链接此链接](http://accidentaltechnologist.com/ruby/ruby-on-rails/setting-up-sqlite3-for-ruby-on-rails-development/) 下载 sqlitedll-3_6_10.zip 并解压到 ruby​​/bin 中！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T17:42:58.620

尝试去[sqlite.org](http://sqlite.org/download.html)下载页面并获取压缩的 dll。然后把它放在你的`c:\windows\system32`文件夹中，这应该允许 Ruby 找到它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-18T07:54:54.300

运行 install sqlite3-ruby 后重启机器

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T13:48:16.240

澄清一下，您使用的是哪种宝石？`sqlite-ruby`还是`sqlite3-ruby`？

它们属于同一个项目，但版本不同。关键是`sqlite3`似乎包含驱动程序代码。

我假设您正在尝试使用第一个，因为它给了我同样的错误。如果是这样，请尝试切换。

* * *

另外..你的意思是什么意思？

> 但我的 %PATH% 中有 dll

1.  **`PATH=...;C:\sqlite\sqlite3.dll`**
2.  **`PATH=...;C:\sqlite`**

第一个将尝试查找**`C:\sqlite\sqlite3.dll\sqlite3.dll`**AFAIK。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-02T00:15:54.383

我使用 Ruby 1.8.7（也适用于 1.9.1）操作系统是 WindowsXP SP3

1.  转到 [http://www.sqlite.org/download.html](http://www.sqlite.org/download.html) 并下载文件 sqlitedll-3_7_0_1.zip (265.19 KiB) 并解压缩然后我们将得到 sqlite3.dll

2.  将 sqlite3.dll 作为 C:\Ruby191\bin 或 C:\Ruby187\bin 复制到您的 bin 文件夹然后它可以工作

# asp.net - 整理 ASP.NET javascript

> ID：515641
> 
> 赞同：1
> 
> 时间：2009-02-05T12:07:44.943
> 
> 标签：asp.net, javascript

我刚刚进入 ASP.NET 多年来一直在避免它，因为我是桌面应用程序的倡导者。

无论如何，我想知道是否有办法阻止生成的 html 被 javascript 弄得如此混乱。有没有办法让生成的脚本进入引用的 js 文件，而不是与页面内联。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T12:10:13.583

看看[ASP.NET MVC](http://www.asp.net/mvc/) - 它是 WebForms 的替代品，而且杂乱无章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T13:11:41.447

你确定你正在使用代码隐藏？

添加新页面时，请确保选中“将代码放在单独的文件中”，否则所有服务器端代码都将在页面上（即使很难，最终用户也不会显示）

如果您使用的是代码隐藏，但页面中仍然有很多 javascript 代码（也许您正在使用 ajax？）我建议您不要使用 .NET ajax 控件，只需通过以下方式完成所有 ajax手，使用 jQuery 或 Prototype。它速度很快，而且会尽可能轻巧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T14:35:16.520

查看[ClientScriptManager.RegisterClientScriptInclude](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerclientscriptinclude.aspx)。

# c# - C# 中的 if 运算符 (?:) 可能的缺点是什么？

> ID：515645
> 
> 赞同：3
> 
> 时间：2009-02-05T12:09:26.593
> 
> 标签：c#, .net

我似乎记得在 C# 中避免使用立即 If 运算符 ( [?:](http://msdn.microsoft.com/en-us/library/ty67wk28(VS.80).aspx) )，但我不知道我在哪里读到它以及它是什么。我认为这与在决定条件结果之前执行真假部分的事实有关。它是否正确？还是在 VB.Net 中是这样的？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-05T12:14:29.220

它实际上称为条件运算符，在 MSDN 中称为“？：”。它基本上是一个简写符号，`if-else`除了这实际上是表达式，而不是语句。因为它是等价的，`if`所以这个运算符没有任何警告。

您所阅读的内容可能`Iif`与 VB.NET 中的函数有关。作为一个函数，它在被调用之前评估它的所有参数，所以

```
Dim s As String = Iif(person Is Nothing, String.Empty, person.FirstName) 
```

将导致`NullReferenceException`被抛出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T13:10:42.507

仅将其用于简单的事情，例如

```
Console.WriteLine(MyBool ? "It's true!" : "Nope"); 
```

如果您尝试在内部添加逻辑，那么代码看起来非常糟糕。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T12:21:09.097

我在使用 ?: 时看到的主要缺点是关于可读性和可维护性，而不是“常规” if-else 块；大多数评论家认为 if-else 比？使用 if-else 重写它，从而使 if-else 从一开始就成为更好的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T12:20:47.350

继 Anton 的回复后，请注意，这也是在 lambda 表达式中指定此类事物的唯一方法（对于 LINQ-to-[some db] 等）。

不利的一面是，如果您要测试多个事物，它可能会让人感到困惑。有关带/不带谓词的类型测试的示例，请参见[此处的讨论。](https://stackoverflow.com/questions/156467/switch-pattern-matching-idea)

# asp.net - 动态加载的 ListButton 和 PostBack 事件

> ID：515658
> 
> 赞同：1
> 
> 时间：2009-02-05T12:14:17.740
> 
> 标签：asp.net, dynamic, controls, postback

我正在尝试动态加载`LinkButton`以触发回发事件，然后我会处理该事件。

我有[`Command`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.command.aspx),[`CommandName`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.commandname.aspx)和[`CommandArgument`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx)- 这看起来真的很有用.. 所以我开始搞砸了，但目前无法按要求工作。

链接在动态创建的表中呈现，这是生成它们的代码：

```
 // The links are stored in Session since I was told that the objects need to remain intact across requests.
    LinkButton GetEditCardLink(string card)
    {
        if (!IsPostBack)
        {
            TW("Creating Link for Card '" + card + "' and Placing in Session.", true);
            LinkButton link = CreateEditLink(card);
            Business.Session.Set<LinkButton>("LinkedCards_EditLink_" + card, link);
        }
        return Business.Session.Get<LinkButton>("LinkedCards_EditLink_" + card);
    }

    // Here the link itself is created, note the ID and Command details are set.
    LinkButton CreateEditLink(string forCard)
    {
        TW("Setting Up Link for Card: " + forCard, true);
        LinkButton rtn = new LinkButton();
        rtn.ID = "Edit_" + forCard;
        rtn.Text = Resources.Header("EditDetails");
        rtn.CommandName = "Edit";
        rtn.CommandArgument = forCard;
        rtn.Command += new CommandEventHandler(RedirectToEdit);
        rtn.Attributes["style"] = "display: block; text-align:center;";
        return rtn;
    }

    // ... And the delegate I want called on PostBack..
    void RedirectToEdit(object sender, CommandEventArgs e)
    {
        TW("RedirectToEdit Called:\r\nName: " + e.CommandName + "\r\nArgument: " + e.CommandArgument);
    } 
```

Trace确认LinkBut​​tons被正确加载，并且只创建一次，所以理论上它们应该没问题，但是当我点击链接时，执行了一个PostBack，但`RedirectToEdit`没有调用该方法？

感谢所有帮助！:)

## 笔记

哦，我想我应该提到`TW`的只是一个实用方法`Trace.Write/Warn`:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T12:33:51.427

当您创建需要事件处理的控件时，您必须在处理过程中尽早完成，以使事件处理程序连接起来。覆盖您正在创建表的页面的 OnInit 并将表创建代码移到那里。正如@ScarletGarden 建议的那样，您还需要添加控件，无论它是否是 PostBack。我相信在 Page_Load 中执行此操作为时已晚，如果您在其中添加控件，则无法检测到事件。

[参考](http://blog.krisvandermast.com/AddingADynamicControlToAPlaceholderControlAndWireUpTheEvent.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T12:29:51.373

这是我的试验，它奏效了：

```
protected void Page_Load(object sender, EventArgs e)
{
    //if (!IsPostBack)
    //{
        placeHolderAtPage.Controls.Add(CreateEditLink("forCard1"));
    //}
}

LinkButton CreateEditLink(string forCard)
{
    LinkButton rtn = new LinkButton();
    rtn.ID = "Edit_" + forCard;
    rtn.Text = "EditDetails";
    rtn.CommandName = "Edit";
    rtn.CommandArgument = forCard;
    rtn.Command += new CommandEventHandler(RedirectToEdit);
    rtn.Attributes["style"] = "display: block; text-align:center;";
    return rtn;
}

void RedirectToEdit(object sender, CommandEventArgs e)
{
    Response.Write("RedirectToEdit Called:\r\nName: " + e.CommandName + "\r\nArgument: " + e.CommandArgument);
} 
```

如果您取消 IsPostBack 行，RedirectToEdit 将毫无用处。只有绑定代码可以在**IsPostBack**控制之下。

# algorithm - Generate sequence of integers in random order without constructing the whole list upfront

> ID：515665
> 
> 赞同：2
> 
> 时间：2009-02-05T12:16:58.530
> 
> 标签：algorithm, random

How can I generate the list of integers from 1 to N but in a random order, without ever constructing the whole list in memory?

(To be clear: Each number in the generated list must only appear once, so it must be the equivalent to creating the whole list in memory first, then shuffling.)

This has been determined to be a duplicate of [this question](https://stackoverflow.com/questions/464476/generating-shuffled-range-using-a-prng-rather-than-shuffling).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T12:29:20.640

very simple random is 1+((power(r,x)-1) mod p) will be from 1 to p for values of x from 1 to p and will be random where r and p are prime numbers and r <> p.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T12:32:40.103

从技术上讲，不是整个列表，但您可以使用位掩码来确定是否已经选择了一个数字。这比数字列表本身的存储空间少得多。

将所有 N 位设置为 0，然后对于每个所需的数字：

*   使用一种正常的线性全等方法从 1 到 N 中选择一个数。
*   如果该数字已被使用，则使用换行查找下一个最高未使用（0 位）。
*   将该数字位设置为 1 并返回它。

这样，您就可以保证每个数字只使用一次，并且结果相对随机。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-05T12:25:18.903

You will need at least half of the total list's memory, just to remember what you did already.

If you are in tough memory conditions, you may try so:

1.  Keep the results generated so far in a tree, randomize the data, and insert it into the tree. If you cannot insert then generate another number and try again, etc, until the tree fills halfway.

2.  When the tree fills halfway, you inverse it: you construct a tree holding numbers that you haven't used already, then pick them in random order.

It has some overhead for keeping the tree structure, but it may help when your pointers are considerably smaller in size than your data is.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-05T12:27:53.780

It might help to specify a language you are searching a solution for.

You could use a dynamic list where you store your generated numbers, since you will need a reference which numbers you already created. Every time you create a new number you could check if the number is contained in the list and throw it away if it is contained and try again.

The only possible way without such a list would be to use a number size where it is unlikely to generate a duplicate like a [UUID](http://en.wikipedia.org/wiki/Uuid#Random_UUID_probability_of_duplicates) if the algorithm is working correctly - but this doesn't guarantee that no duplicate is generated - it is just highly unlikely.

# c# - Getting nothing while parsing XML response from the .aspx page of VS 2005 in JQuery

> ID：515682
> 
> 赞同：1
> 
> 时间：2009-02-05T12:24:17.873
> 
> 标签：c#, jquery

I am not able to get xml response data from .aspx page of VS 2005\. Following is the function which writes xml response on the client end:

```
protected void GetMailContents(double pdblMessageID)
{
    string lstrMailContents = "";
    DataSet lobjDs = new DataSet();
    StringBuilder stringBuilder = new StringBuilder("<MailContents>");
    lobjDs = mobjCProfileAndMail.GetMailContents(pdblMessageID);

    if (lobjDs != null)
    {
         stringBuilder.Append("<Contents><From>");
         stringBuilder.Append(lobjDs.Tables[0].Rows[0]["From"].ToString());
         stringBuilder.Append("</From><To>");
         stringBuilder.Append(lobjDs.Tables[0].Rows[0]["To"].ToString());
         stringBuilder.Append("</To><Subject>");
         stringBuilder.Append(lobjDs.Tables[0].Rows[0]["Subject"].ToString());
         stringBuilder.Append("</Subject><Message>");
         stringBuilder.Append(lobjDs.Tables[0].Rows[0]["Message"].ToString());
         stringBuilder.Append("</Message></Contents>");
    }

    stringBuilder.Append("</MailContents>");

    lstrMailContents = "<?xml version=\"1.0\" encoding=\"utf-8\"?> \n ";
    lstrMailContents += stringBuilder.ToString();
    Response.ContentEncoding = Encoding.UTF8;
    Response.Write(lstrMailContents);
    Response.End();
} 
```

**Code on the client end:**

```
 $(document).ready(function()
    {
        var varURL = document.URL;
        var varArr = varURL.split('=');
        var varMessageID = varArr[1];

        $.get("AjaxData.aspx?Mode=MODALDIALOG."+varMessageID, function(data)
        {
              $(data).find('Contents').each(function()
              {  
                 var varFrom = $(this).find('From').text();  
                 var varTo = $(this).find('To').text();  
                 var varSubject = $(this).find('Subject').text();
                 var varMessage = $(this).find('Message').text(); 
                 alert(varFrom);
             });  

        });
    }); 
```

I have written a alert for the data coming from the callback but getting nothing. If I am parsing any fixed xml then its working fine but in case getting response from the .aspx page got nothing. Is there any one who can help me out for this problem.

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T12:27:14.717

First - writing xml through concatenation is really flakey - consider using `XmlWriter` / `XDocument` / `XmlDocument` instead, which will automatically escape any necessary symbols (`<`, `&`, etc) rather than result in invalid xml.

Did you clear the response buffer before writing to it? In reality, it would be a lot simpler to do this from a raw handler (`ashx`) than from within the aspx page life-cycle. Or switch to MVC, which works similarly to the ashx result.

Also - from within the jquery, you should probably speficy the `type` as `xml` - see [here](http://docs.jquery.com/Ajax/jQuery.get).

Here's an example of a suitable handler:

```
 public void ProcessRequest(HttpContext context)
    {
        context.Response.ContentType = "text/xml";
        XmlDocument doc = new XmlDocument();
        XmlElement root = (XmlElement) doc.AppendChild(doc.CreateElement("Contents"));
        root.AppendChild(doc.CreateElement("From")).InnerText = "some text";
        root.AppendChild(doc.CreateElement("To")).InnerText = "some more text";
        root.AppendChild(doc.CreateElement("Subject")).InnerText = "this & that";
        root.AppendChild(doc.CreateElement("Message")).InnerText = "a < b > c";
        doc.Save(context.Response.Output);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T12:27:47.150

First off, no need for `aspx` here - plain `IHttpHandler` will do and will also be a more natural solution.

As for the question, make sure you clear the output stream before writing out XML and ensure that HTTP headers (specifically `Content-Type`) are correct. Use Fiddler to see what's going on under the hood.

# php - 如何在 Jquery 中使用 JSON？

> ID：515684
> 
> 赞同：7
> 
> 时间：2009-02-05T12:24:48.263
> 
> 标签：php, javascript, jquery, json

我正在开发一个应用程序，该应用程序会向我的服务器上的 PHP 脚本发出 POST ajax 请求。该脚本将查询数据库并以数组的形式返回一行记录。（每行一个数组，包含 id、title 等元素）。然后我想用它`json_encode()`来编码这个数组，并将它传递回将使用它来显示记录的 javascript。

1) 如何将 JSON 编码的字符串返回给 javascript？2) javascript 将如何遍历行并访问它们的字段？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-05T12:27:29.820

要使用 jQuery 获取 JSON，只需使用[jQuery.getJSON()](http://docs.jquery.com/Ajax/jQuery.getJSON)。或者，您可以使用任何其他 AJAX 工具，然后只需 eval() json 即可获取 javascript 对象。

要遍历一个数组，我通常使用[jQuery.each()](http://docs.jquery.com/Utilities/jQuery.each)：

```
var recordList = yourMethodToGetRecordListWithAjax();

jQuery.each(recordList, function()
{
    alert(this.Name); // For example
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T19:41:12.860

1）在php脚本中：

```
$return["foo"]  = "bar";
$return["blah"] = "bleg";
print json_encode($return); 
```

2）在javascript中：

```
$.ajax({
  type: "POST",
  url: URL,
  cache: false,
  data: values,
  dataType: 'json',
  success: function(json) {
    var foo = json.foo;
    if (json.blah == "bleg") {
      // do stuff 
    }
  } // end success function
}); // end ajax call 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T12:29:18.083

您可以通过使用 application/json 的 Content-Type 将 JSON 编码的字符串回显给 JS。

其余的请参见上面的答案。

# sql - SQL query to select unreferenced rows

> ID：515690
> 
> 赞同：5
> 
> 时间：2009-02-05T12:26:27.463
> 
> 标签：sql, mysql

I'm having a brain-dead moment... I have two tables described by:

```
CREATE TABLE table_a (
    id             INTEGER          PRIMARY KEY AUTO_INCREMENT,
    name           VARCHAR(255)     NOT NULL
    UNIQUE (name))

CREATE TABLE table_b (
    id             INTEGER          PRIMARY KEY AUTO_INCREMENT,
    a_key          INTEGER          NOT NULL,
    other_stuff    VARCHAR(255)     NOT NULL,
    FOREIGN KEY(a_key)  REFERENCES table_a(id)
         ON DELETE CASCADE) 
```

How can I select all rows from table_a that do not have an entry in table_b.a_key?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-05T12:31:17.253

```
SELECT table_a.*
FROM table_a
    LEFT JOIN table_b
        ON table_a.id = table_b.a_key
WHERE table_b.id IS NULL 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T12:28:57.880

Naively, you can use a NOT EXISTS subquery:

```
SELECT A.*
FROM table_a A
WHERE NOT EXISTS (
  SELECT 1
  FROM table_b B
  WHERE B.a_key = A.id
) 
```

You can also try an outer join. But they'll usually optimize to the same query internally.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-05T12:29:40.813

```
SELECT 
table_a.* 
FROM table_a 
LEFT JOIN table_b 
ON table_a.id = table_b.a_key 
WHERE b.id IS NULL; 
```

This does a JOIN on table_a and table_b and where the JOIN finds no join result for table_b, it prints the corresponding row entry for table_a.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T12:31:05.567

如果是 SQL server 2005+，你可以试试 EXCEPT

```
SELECT id
FROM table_a
EXCEPT
SELECT a_key
FROM table_b; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T12:32:05.910

```
select a.*
from table_a a
where a.id not in (select b.a_key from table_b b where b.a_key = a.id) 
```

# c# - 我的软阴影代码有什么问题？

> ID：515693
> 
> 赞同：3
> 
> 时间：2009-02-05T12:27:09.443
> 
> 标签：c#, algorithm, raytracing, shadow

我正在尝试编写一个简单的光线追踪器作为一个爱好项目，现在一切正常，除了我根本无法使用软阴影。我对软阴影的想法是，光源被认为具有位置和半径。为了对这盏灯进行阴影测试，我将主光线照射到场景中的对象处，然后向光源投射 n 条光线，其中每条新光线在每个轴上都有一个随机分量，其中随机分量会发生变化在 -radius 和半径之间。

如果这样的射线击中场景中的对象，我会增加一个 hitcounter（如果射线击中多个对象，它仍然只会增加一个）。如果它在没有碰撞的情况下到达光源，我将主光线的交点到光源中心的距离添加到一个变量中。

当采集了 n 个样本时，我计算碰撞的光线的比率，并将光的颜色乘以该比率（因此颜色为 1000,1000,1000 的光将以 0.5 的比率变为 500,500,500，其中一半的光线发生了碰撞）。然后我通过将较早的距离变量除以非碰撞光线的数量来计算到光源的平均距离。我返回那个变量并且函数退出。

问题是：它不起作用。至少不完全是。[在这里](http://img16.imageshack.us/img16/5376/719sv8.png)可以看到它的样子。你可以看到它有点像软阴影，如果你用力眯眼的话。

我不明白，我是在这里制造了某种根本性的缺陷，还是很小的东西？我相当肯定问题出在这种方法上，因为当我计算这种方法直接产生的部分点亮像素的数量时，只有大约 250 个，而应该有更多。当您仔细查看图片时，您会看到一些部分点亮的像素，这表明其余代码处理部分点亮的像素就好了。

这是软阴影类的实际光线：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace MyFirstRayTracer
{
  public class AreaLight : ILight
  {
    private const int _radius = 5;
    private const int _samples = 16;
    public Color Color { get; set; }
    public Vector Location { get; set; }
    #region ILight Members

    public float GetLightingInformation(Vector point, ISceneObject[] scene, out Color color)
    {
      int intersectCount = 0;
      float distance = -1;
      for(int i = 0; i < _samples; i++)
      {
    bool intersects = false;
    float rand = 0;
    rand = _radius - (float)(new Random().NextDouble()*(2*_radius));
    foreach (ISceneObject obj in scene)
    {
      Vector iPoint;

      Vector loc = new Vector(Location.X + rand, Location.Y + rand, Location.Z + rand);

      if (!obj.Intersect(new Ray(point, loc), out iPoint))
      {
        distance += (Location - point).SqLength;

      }
      else
      {
        intersects = true;
        distance -= (Location - point).SqLength;
      }
    }
    if (intersects)
      intersectCount++;
      }
      float factor = 1-((float)intersectCount/_samples);

      color = new Color(factor*Color.R, factor*Color.G, factor*Color.B);

      return (float)Math.Sqrt(distance / (_samples - intersectCount));
    }

    #endregion
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T12:32:49.980

次要问题，但这是随机类的最佳用途吗？

```
 for(int i = 0; i < _samples; i++)
      {
        bool intersects = false;
        float rand = 0;
        rand = _radius - (float)(new Random().NextDouble()*(2*_radius)); 
```

这不应该是..

```
 var rnd = new Random()    
    for(int i = 0; i < _samples; i++)
              {
                bool intersects = false;
                float rand = 0;
                rand = _radius - (float)(rnd.NextDouble()*(2*_radius)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T12:35:16.213

尝试为“loc”的每个组件生成不同的“rand”。照原样，您的抖动点都在一条线上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T12:36:46.680

您实际上在具有方向 (1, 1, 1) 的线上生成点。光源真的是线性的吗？

另外，在你的例子中我几乎看不到任何东西。你能让你的相机更接近未来的阴影而不是从光的方向指向吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T12:45:41.887

看，这就是我来这个网站的原因:)

现在每个轴都有自己的随机数，而且看起来好多了。它看起来仍然有点奇怪，但增加样本数量会有所帮助。现在看起来像[这样](http://img3.imageshack.us/my.php?image=205pe1.png)。

您知道减少打版的更有效方法吗？

但最大的帮助是：不为每个样本实例化 Random 。它用柔和的阴影严重地提高了我的渲染速度三倍！我从来不知道 Random 实例化的成本如此之高。哇。

非常感谢。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T13:27:34.940

在您的回复中，您要求改进制作柔和阴影的方法。一个改进可能是，而不是将来自同一点的所有光线随机化，而是在所有轴上给每条光线一个不同的偏移量，以有效地给它们一个单独的小窗口来随机化。这应该会导致更均匀的分布。我不知道这是否清楚，但另一种描述它的方式是垂直于阴影射线的网格。网格中的每个图块都包含 n 条阴影射线之一，但网格中的位置是随机的。[在这里](http://www.devmaster.net/articles/raytracing_series/part5.php)您可以找到教程的一部分，该教程描述了如何将其用于软阴影。

# java - 我自己的类加载器？

> ID：515702
> 
> 赞同：2
> 
> 时间：2009-02-05T12:29:05.917
> 
> 标签：java, classloader

这是我遇到的问题。有一个巨大的遗留应用程序在 java 1.3 上运行并使用外部 API，例如 MyAPI v1.0。MyAPI 1.0 的确切实现位于应用程序使用的类路径中的某个位置。还有一种机制允许该应用程序使用外部代码（某种插件机制）。现在我有另一个使用 MyAPI v2.0（与 v1.0 不是 100% 向后兼容）的 java 库 (MyLib.jar)，我必须使用该插件机制从原始应用程序中使用它。所以我必须以某种方式让同一个 API 的两个（不兼容！）版本一起工作。具体来说，我想在从 MyLib.jar 类调用 API 类时使用 MyAPI v2.0，而在所有其他情况下使用 MyAPI 1.0。

MyAPI 1.0 在类路径中，所以默认使用它，没关系。我可以创建自己的类加载器版本来从 MyAPI 2.0 加载类 - 没问题。但是我如何将它们组合在一起呢？问题：

1.  MyLib.jar 对象从 MyAPI 2.0 实例化了很多（！）类的实例。这是否意味着我必须通过反射来完成所有这些实例化（指定我自己的类加载器）？这真是一个地狱般的工作！

2.  如果某些 MyAPI 2.0 对象被实例化并且它在内部从 MyAPI 实例化另一个对象，它将使用什么类加载器？它会使用我的类加载器还是默认的类加载器？

3.  总的来说，我的方法听起来合理吗？有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T12:48:56.420

让我们从回答您的第二个问题开始：当从某个类引用另一个类时，它将由加载原始类的同一个类加载器加载（当然，除非类加载器没有成功找到该类，然后它将委托给它的父类加载器）。

说了这么多，为什么你的整个 MyLib.jar 不会被一个自定义的类加载器加载，然后它可以以常规方式引用更新版本的 API。否则你会遇到问题，因为你将不得不一直使用 Object 类型和反射。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T12:41:32.363

您需要小心使用类加载器。如果您按照您的建议进行操作，即使使用 MyAPI 2.0 的类加载器，您几乎总是会以 MyAPI 1.0 结束。原因是如何使用类加载器加载类。类总是首先从父类加载器加载。

“ClassLoader 类使用委托模型来搜索类和资源。ClassLoader 的每个实例都有一个关联的父类加载器。当请求查找类或资源时，ClassLoader 实例会将对该类或资源的搜索委托给其父级在尝试查找类或资源本身之前的类加载器。虚拟机的内置类加载器，称为“引导类加载器”，它本身没有父级，但可以作为 ClassLoader 实例的父级。“（[http： //java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html](http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html) )

为了正确地提供两个 API 之间的隔离，您需要 2 个类加载器（或者除了主应用程序之外还有 2 个）。

```
Parent - System classloader
  |- Classloader1 - Used to load MyAPI 1.0
  |- Classloader2 - Used to load MyAPI 2.0 
```

现在回答你的问题。您可能想要做的是将使用 API 的大部分逻辑移到类加载器中。除了 MyAPI 1.0/2.0 之外，您还应该加载使用它们的应用程序部分。然后父应用程序只需调用一个使用 API 的方法。这样，您可以进行一次反射调用来启动应用程序，并且该应用程序内的所有内容都只使用标准引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T12:43:07.353

你可以用一个花哨的 ClassLoader 来做到这一点，而无需反射。

基本上，类加载器必须说“如果加载类来自这个 jar，则从类路径 B 加载，否则使用主 ClassLoader”。

它比这更复杂一些，但如果你从这个想法开始，你就会得到解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T12:43:47.367

这听起来很合理。在 [API javadoc for loadClass][1] 中它说：

"加载具有指定二进制名称的类。此方法的默认实现按以下顺序搜索类：调用 findLoadedClass(String) 以检查该类是否已加载。

在父类加载器上调用 loadClass 方法。如果 parent 为 null，则使用虚拟机内置的类加载器。

调用 findClass(String) 方法来查找类。”

如果 CL1 用于 MyAPI1，CL2 用于 MyAPI2，CL3 用于 MyLib，听起来您希望按以下顺序检查它们：CL3、CL2、CL1。从上面的引用中（首先检查父母）建议您希望 CL1 具有父 CL2，而 CL2 具有父 CL3。由于具有父类加载器的构造函数受到保护，因此您必须使用正确设置父类的 URL 类加载器。

就像是

```
URLCLassLoader cl3 = new URLClassLoader(new URL[]{ path to MyLib});
URLCLassLoader cl2 = new URLClassLoader(new URL[]{ path to API2}, cl3);
URLCLassLoader cl1 = new URLClassLoader(new URL[]{ path to API1}, cl2); 
```

然后到处使用 cl1 。

[1]： http: [//java.sun.com/j2se/1.5.0/docs/api/java/lang/ClassLoader.html#loadClass](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ClassLoader.html#loadClass(java.lang.String) (java.lang.String , boolean)

# vb.net - VB.Net 中的换行符？

> ID：515722
> 
> 赞同：30
> 
> 时间：2009-02-05T12:33:55.063
> 
> 标签：vb.net, string

我正在尝试在 vb.net 的网页上打印一条消息。我正在尝试以新行获取消息。我尝试使用“\r\n”和换行符。但这会打印在页面中，而不是打印到下一行。请让我知道是否有任何替代方案。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-02-05T12:36:54.573

退房`Environment.NewLine`。至于网页，用`<br>`或`<p></p>`标记换行。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-02-05T12:51:47.197

[`Environment.NewLine`](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)是获取字符的最“.NET”方式，它还会在 Windows 上发出回车和换行，如果这对您来说是一个问题，则在 Unix 中只是一个回车。

但是，您也可以使用 VB6 样式[`vbCrLf`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.constants.vbcrlf.aspx)or [`vbCr`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.constants.vbcr.aspx)，分别给出回车和换行或只是回车。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-05T14:28:25.377

在 VB 中执行此操作的正确方法是将 VB 常量中的一个用于换行符。主要的三个是

*   vbCrLf = "\r\n"
*   vbCr = "\r"
*   vbLf = "\n"

默认情况下，VB 不允许在字符串中使用任何字符转义码，这与 C# 和 C++ 等语言不同。这样做的原因之一是在处理文件路径时易于使用。

*   C++ 文件路径字符串：“c:\\foo\\bar.txt”
*   VB文件路径字符串：“c:\foo\bar.txt”
*   C#文件路径字符串：C++方式或@"c:\foo\bar.txt"

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-05T12:37:48.737

您需要在网页上使用 HTML 来获取换行符。例如“<br/>”会给你一个换行符。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-02-05T14:07:19.243

如果你正在使用这样的东西。

```
Response.Write("Hello \r\n")
Response.Write("World \r\n") 
```

输出是

```
Hello\r\nWorld\r\n 
```

那么你基本上是在寻找这样的东西

```
Response.Write("Hello <br/>")
Response.Write("World <br/>") 
```

这将输出

```
Hello 
World 
```

您也可以将“<br />”定义为常量并重用它

例如。

```
Public Const HtmlNewLine as string ="<br />"
Response.Write("Hello " &  HtmlNewLine) 
Response.Write("World " &  HtmlNewLine) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-05T12:41:16.500

它的 ：

`vbnewline`

例如

`Msgbox ("Fst line" & vbnewline & "second line")`

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-05T12:36:39.270

尝试[Environment.NewLine](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-05T12:41:58.417

您需要使用[html/xhtml 中断字符](http://www.w3schools.com/TAGS/tag_br.asp)：

```
<br /> 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-09-26T02:57:44.647

您可以在 Visual Basic .net 中解决该问题而无需连接文本，您可以将其用作重载 Tostring 的返回类型：

```
System.Text.RegularExpressions.Regex.Unescape(String.format("FirstName:{0} \r\n LastName: {1}", "Nordanne", "Isahac")) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-10-22T17:44:44.667

在 asp.net 中用于在字符串中给出换行符时，您应该使用`<br>`.

对于窗口基础应用程序`Environment.NewLine`将正常工作。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-05T12:40:01.430

```
VbCr 
```

试试看。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-03-07T03:10:48.120

在这种情况下，我可以使用`vbNewLine`,`vbCrLf`或`"\r\n"`.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-05-11T17:22:44.873

`vbCrLf`是 Visual Basic 6 天的遗物。虽然它的工作原理与 .NET 完全相同`Environment.NewLine`，但它只是为了让 .NET api 对 VB6 开发人员切换更加熟悉而保留。

您可以调用 String.Replace() 函数来避免连接多个单个字符串值。

MsgBox("第一行\n第二行。".Replace("\n", Environment.NewLine))

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-03-16T15:28:57.630

`Environment.NewLine`或`vbCrLf`或`Constants.vbCrLf`

有关 VB.NET 新行的更多信息：

[http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-06-29T21:11:14.437

我需要将换行符存储在 SQL 表中的字符串中，并将它们显示在 vb.NET 中。我的解决方案是在我的数据库中包含这样的字符串：

```
"This is the first line{0}This is the second{0}This is the third" 
```

在 vb.NET 中，我在使用它之前处理了这样的字符串：

```
Label2.Text = String.Format(stringFromSQLquery, vbCrLf) 
```

这会用 vbCrLf 替换每次出现的 {0}

# .net - 为什么 .net 配置设置被编译成程序集？

> ID：515723
> 
> 赞同：3
> 
> 时间：2009-02-05T12:34:01.723
> 
> 标签：.net, configuration, settings

我一直在尝试了解如何在 .net 中正确进行配置，并且遇到了一些我觉得有点奇怪的事情，那就是配置设置通过 Settings 类编译到程序集中。删除 app.config 并运行应用程序不会像我预期的那样导致配置错误，而是现在我无法替换配置值。

在我的应用程序中，我有一个 web 服务 url 的配置设置，我需要能够以编程方式获取和设置。我是否应该在我的应用程序的配置中创建自定义部分，我将通过 ConfigurationManager.GetSection(..) 来触发读取配置文件，或者是否有其他方法可以解决这个问题，因为我绝对不想要 web 服务 url用于将 ws 代理生成为可能泄漏到生产环境中的 url。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T13:26:20.870

看看[用户模式 ​​.NET 设置存储在哪里？](https://stackoverflow.com/questions/469742/where-are-user-mode-net-settings-stored)

.NET 设置不在程序集中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T12:59:12.297

尝试将应用程序配置文件而不是设置文件添加到您的项目中。应用程序配置文件不会编译到程序集中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T12:38:39.500

如果你点击属性上的加号，然后点击设置，你会发现一个名为 settings.designer.cs 的文件

此文件包含您在定义应用程序设置时创建的默认值，这就是您的应用程序在没有配置文件的情况下工作的原因。

但是，您始终可以覆盖此值。

对此进行测试的唯一方法是创建一个可供公众安全使用的默认值，并在测试期间对其进行更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T12:40:08.593

当您添加对 webservice 的引用时，您可以设置属性以使 webservice url 动态（即从配置文件中读取）。

单击“Web 参考”。单击您的网络服务并将属性“URL 行为”从“静态”设置为“动态”。

进行更改后，将 Web 服务指向正确的 URL 所需要做的就是在应用程序运行之前更改配置文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T13:17:16.473

据我记得（我有待纠正），.Net 创建了一个配置文件，该文件存储在您的 Windows 应用程序数据文件夹中，如果您正在部署应用程序，则尤其如此。

在应用数据（C:\Documents and settings\yourusername\Local Setting\Application Data\your app name）中搜索，看看是否可以在其中找到应用配置。如果可以，您应该可以在那里进行更改。

另外我不确定您正在创建什么类型的 Web 服务，但您不应该使用 web.config（我使用的）来存储设置吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T13:18:50.790

据我所知，webservice 引用逻辑指出，如果 app.config（或 web.config）中有某个键，它将选择...如果没有...它将使用用于创建网络服务参考。在框架 1.1 中，可能是 2.0。

框架 3.0 中的 Settings.settings 文件...至少用作默认值。如果您没有在 web.config 中提供覆盖 Settings.settings 中的键的键，它将使用默认值......这就是您看不到配置错误的原因。对于 Web 服务引用，该文件中存储了您为创建引用而提供的值。

正如我所看到的...... Settings.settings 允许您以编程方式更新密钥，以保存首选项以及一些持久化的方式。

[更多信息：](http://msdn.microsoft.com/en-us/library/cftf714c.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-05T13:19:45.080

我想我明白你在说什么，乔乔。假设您从 www.productionurl.com 添加一个 web 服务，生成的代理类将生产 url 保留在源代码中。在运行时，如果在配置文件中找不到 url 的值（假设您已将服务设置为动态），它将使用此默认值。

如果您不喜欢这种行为，您有 2 个选择：

*   更改 Reference.cs 文件（每次刷新服务代理时都必须继续这样做）
*   为代理创建部分类并覆盖 URL 设置

或者您可以检查 Web 服务是否有开发站点。如果是，请从该站点而不是生产站点创建 Web 引用。

# unix - 发送者和接收者根据请求通过 ssh 传输文件？

> ID：515726
> 
> 赞同：10
> 
> 时间：2009-02-05T12:35:06.760
> 
> 标签：unix, shell, ssh, sysadmin, file-transfer

我创建了一个程序，它遍历一堆文件并为其中一些文件调用：

```
scp <file> user@host:<remotefile> 
```

但是，就我而言，可能有数千个小文件需要传输，并且 scp 正在为每个文件打开一个新的 ssh 连接，这会产生相当大的开销。

我想知道是否没有解决方案让我保持一个进程运行以维护连接，并且我可以向它发送“请求”以复制单个文件。

理想情况下，我正在寻找一些发送者和接收者程序的组合，这样我就可以在开始时启动一个进程 (1)：

```
ssh user@host receiverprogram 
```

对于每个文件，我调用一个命令 (2)：

```
senderprogram <file> <remotefile> 
```

并将 (2) 的输出通过管道传输到 (1) 的输入，这将导致文件被传输。最后，我可以发送进程 (1) 一些信号来终止。

优选地，发送者和接收者程序是用于Unix的开源C程序。他们可以使用套接字而不是管道或任何其他创造性的解决方案进行通信。

然而，每个文件在我迭代它的那一刻被传输是一个**重要的限制**`scp`：收集文件列表然后调用一个实例来一次传输所有文件是不可接受的。此外，我对接收主机只有简单的 shell 访问权限。

**更新：**我找到了使用 ssh 的多路复用功能解决连接开销问题的方法，请参阅下面我自己的答案。然而，我开始赏金，因为我很想知道是否存在我在这里描述的发送者/接收者程序。似乎应该存在可以使用的东西，例如xmodem/ymodem/zmodem？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-06T07:20:46.987

我从另一个角度找到了解决方案。从[3.9 版本](http://marc.info/?l=openbsd-announce&m=109284742930930&w=2)开始，OpenSSH 支持**会话多路复用**：单个连接可以承载多个登录或文件传输会话。这避免了每个连接的设置成本。

对于问题的情况，我可以首先打开一个连接，在特定位置设置一个`-M`带有套接字 () 的控制主机 () 。`-S`我不需要会话 ( `-N`)。

```
ssh user@host -M -S /tmp/%r@%h:%p -N 
```

接下来，我可以`scp`为每个文件调用并指示它使用相同的套接字：

```
scp -o 'ControlPath /tmp/%r@%h:%p' <file> user@host:<remotefile> 
```

此命令几乎立即开始复制！

您还可以将控制套接字用于正常的 ssh 连接，然后立即打开：

```
ssh user@host -S /tmp/%r@%h:%p 
```

如果控制套接字不再可用（例如，因为您杀死了主控），这将回退到正常连接。[本文](http://www.debian-administration.org/articles/290)提供了更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T12:38:37.487

使用 sftp 而不是 scp 并将其置于批处理模式可能会起作用。使批处理命令文件成为管道或 UNIX 域套接字，并在您希望它们执行时将命令提供给它。

客户端的安全性可能有点棘手。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-15T22:51:59.643

你试过[`sshfs`](http://fuse.sourceforge.net/sshfs.html)吗？你可以：

```
sshfs remote_user@remote_host:/remote_dir /mnt/local_dir 
```

在哪里

*   `/remote_dir`是您要发送文件到您正在进入的系统上的目录
*   `/mnt/local_dir`是本地安装位置

使用此设置，您只需`cp`将文件放入其中`local_dir`，然后将其发送`sftp`到`remote_host``remote_dir`

请注意，只有一个连接，因此开销很小

您可能需要使用该标志`-o ServerAliveInterval=15`来维持[无限期的连接](http://apps.sourceforge.net/mediawiki/fuse/index.php?title=SshfsFaq#sshfs_hangs_after_a_while)

您将需要在[`fuse`](http://fuse.sourceforge.net/)本地安装和支持（并配置）的 SSH 服务器`sftp`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-15T23:35:41.503

这种方式可行，对于其他事情，这种通用方法或多或少是正确的。

```
(
iterate over file list
  for each matching file
   echo filename
) | cpio -H newc -o | ssh remotehost cd location \&\& | cpio -H newc -imud 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-12T22:54:00.207

也许你正在寻找这个： [ZSSH](http://zssh.sourceforge.net/)

> zssh (Zmodem SSH) 是一个程序，用于在使用安全外壳 (ssh) 时以交互方式将文件传输到远程机器。它旨在成为 scp 的便捷替代方案，允许传输文件而无需打开另一个会话并重新验证自己。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-05T16:38:50.623

如果您可以收集所有文件以在单个目录（或目录层次结构）中发送，请使用 rsync over ssh。

如果您没有将所有文件放在一个地方，请提供更多信息，说明您想要实现的目标以及为什么不能将所有文件打包到存档中并将其发送出去。为什么立即发送每个文件如此重要？如果文件的发送延迟很短（比如累积了 4K 的数据），是否可以？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-12T04:14:25.700

这是一个不错的小问题。我不知道预打包的解决方案，但您可以使用简单的 shell 脚本做很多事情。我会在接收器上试试这个：

```
#!/bin/ksh
# this is receiverprogram

while true
do
  typeset -i length
  read filename  # read filename sent by sender below
  read size      # read size of file sent
  read -N $size contents  # read all the bytes of the file
  print -n "$contents" > "$filename"
done 
```

在发送方，我将创建一个命名管道并从管道中读取，例如，

```
mkfifo $HOME/my-connection
ssh remotehost receiver-script < $HOME/my-connection 
```

然后发送文件我会尝试这个脚本

```
#!/bin/ksh
# this is senderprogram

FIFO=$HOME/my-connection

localname="$1"
remotename="$2"
print "$remotename" > $FIFO
size=$(stat -c %s "$localname")
print "$size" > $FIFO
cat "$localname" > $FIFO 
```

如果文件很大，你可能不想一口气读完，所以大约是

```
BUFSIZ=8192

rm -f "$filename"
while ((size >= BUFSIZ)); do
  read -N $BUFSIZE buffer
  print -n "$buffer" >> "$filename"
  size=$((size - BUFSIZ))
done
read -N $size buffer
print -n "$contents" >> "$filename" 
```

最终你会想要扩展脚本，这样你就可以通过`chmod`和`chgrp`命令。由于您信任发送代码，因此构造事物可能是最简单的，以便接收者只需`eval`在每一行上调用 shell，然后发送类似

```
print filename='"'"$remotename"'"' > $FIFO
print "read_and_copy_bytes " '$filename' "$size" > $FIFO 
```

然后定义一个局部函数`read_and_copy_bytes`。获得正确的报价是一件难事，但否则它应该是直截了当的。

当然，这些都没有经过测试！但我希望它能给你一些有用的想法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-05T12:37:55.413

似乎是 tar 的工作？将其输出通过管道传输到 ssh，在另一侧将 ssh 输出通过管道传输回 tar。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-11T10:39:43.477

我认为 GNOME 桌面在通过 SFTP (SSH) 访问共享时使用单个 SSH 连接。我猜这是正在发生的事情，因为当我以这种方式访问​​远程共享时，我看到了一个 SSH 进程。因此，如果这是真的，您应该能够为此目的使用相同的程序。

新版本的 GNOME 通过[GIO](http://library.gnome.org/devel/gio/2.18/)使用 GVFS ，以便通过不同的后端执行各种 I/O。Ubuntu 软件包 gvfs-bin 提供了各种命令行实用程序，可让您从命令行操作后端。

首先，您需要挂载 SSH 文件夹：

gvfs-mount sftp://user@host/

然后你可以使用 gvfs-copy 来复制你的文件。我认为所有文件传输都将通过单个 SSH 进程执行。您甚至可以使用 ps 查看正在使用的进程。

如果您觉得更有冒险精神，您甚至可以用 C 或其他为 GIO 提供 API 的高级语言编写自己的程序。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-14T14:23:15.830

一种选择是[Conch](http://twistedmatrix.com/trac/wiki/TwistedConch)是使用[Twsited](http://twistedmatrix.com/trac/)框架用 Python 编写的 SSH 客户端和服务器实现。您可以使用它编写一个工具，该工具通过其他协议（HTTP 或 Unix 域套接字、FTP、SSH 或其他）接受请求，并通过长时间运行的 SSH 连接触发文件传输。事实上，我在生产中有几个程序使用这种技术来避免多个 SSH 连接设置。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-16T19:59:42.483

几周前这里有[一个非常相似的问题。](https://stackoverflow.com/questions/440524/ssh-a-way-to-transfer-files-without-opening-a-separate-sftp-session)接受的[答案](https://stackoverflow.com/questions/440524/ssh-a-way-to-transfer-files-without-opening-a-separate-sftp-session/440546#440546)建议在 ssh'ing 到远程机器时打开一个隧道，并使用该隧道进行 scp 传输。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-17T06:22:44.153

[也许 CurlFTPFS](http://curlftpfs.sourceforge.net/)可能是您的有效解决方案。

看起来它只是通过 SFTP 将外部计算机的文件夹安装到您的计算机上。完成后，您应该能够使用常规`cp`命令，并且一切都将安全地完成。

不幸的是，我无法自己测试它，但让我知道它是否适合你！

**编辑1：** 我已经能够下载并测试它。正如我担心的那样，它确实需要客户端有一个 FTP 服务器。 **但是**，我发现另一个程序与您正在寻找的概念完全相同。 `sshfs`允许您连接到您的客户端计算机，而无需任何特殊的服务器。安装其中一个文件夹后，您可以使用常规`cp`命令将所需的任何文件移动到更多位置。一旦你完成了，它应该是一个微笑的问题`umount /path/to/mounted/folder`。让我知道这是怎么回事！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-12T04:17:29.500

```
rsync -avlzp user@remotemachine:/path/to/files /path/to/this/folder 
```

这将使用 SSH 以非慢速方式传输文件

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-12T20:35:32.457

保持简单，写一个小包装脚本来做这样的事情。

1.  tar 文件
2.  发送 tar 文件
3.  在另一边解压

像这样的东西：

1.  tar -cvzf test.tgz 文件....
2.  scp test.tgz user@other.site.com:。
3.  ssh user@other.site.com tar -xzvf test.tgz

/约翰

# resharper - 充分利用 Resharper - 好的教程/截屏视频

> ID：515730
> 
> 赞同：33
> 
> 时间：2009-02-05T12:35:44.810
> 
> 标签：resharper

我刚刚安装了 Resharper，我真的不知道如何“正确”使用它。我注意到他们的网站上有一些演示和文档，但我想知道..

..您是如何学会有效使用它的？还有其他好的资源（演示/教程）吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-05T12:55:08.547

[Dime Casts](http://dimecasts.net/)网站上有[一系列截屏视频](http://dimecasts.net/Casts/ByTag/ReSharper)，作为介绍非常不错。

还有[31 天的 Resharper](http://blog.excastle.com/2007/01/31/blog-event-the-31-days-of-resharper/)，[官方演示](http://www.jetbrains.com/resharper/documentation/index.html)让您了解可能发生的事情，以便您了解深入了解菜单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-04T17:56:25.477

JetBrains 现在向许可证持有者提供一个月的 Pluralsight 上 ReSharper 基础课程的免费访问权限。有关详细信息，请参阅[Pluralsight 和 JetBrains 协议](http://blogs.jetbrains.com/dotnet/2011/08/pluralsight-and-jetbrains-agreement/)。

> 这不仅仅是任何课件，它是一个完整的 3 小时课程，内容涉及如何更好地掌握 ReSharper，由 JetBrains Academy 董事会成员和 ReSharper 的长期用户 James Kovacs 创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-22T09:23:50.163

GitHub 上有一个[ReSharper 研讨会。](https://github.com/JetBrains/resharper-workshop)

它是一个 Visual Studio 项目，可引导您了解 ReSharper 的许多功能。

# wpf - 适合初学者的 wcf 和 wpf 应用程序源代码

> ID：515742
> 
> 赞同：2
> 
> 时间：2009-02-05T12:38:43.727
> 
> 标签：wpf, wcf, .net-3.5

我是 .net 3.5 的初学者，必须在需要为选定模块（如报告）构建桌面版本和 Web 版本的应用程序上工作。我认为 WCF 将帮助我创建一个基础，我可以在其中调用函数（桌面和网络）

让我知道要完成的任何可用源代码示例项目。如果它们遵循像 MVC 这样的任何设计模式，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T12:42:16.637

[这](http://msdn.microsoft.com/en-us/library/ms735119.aspx)是开始使用 WCF 的好地方

[这](http://msdn.microsoft.com/en-us/library/ms754130.aspx)是 WPF 的良好开端。

玩得开心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T13:13:36.730

您可以查看~~[DinnerNow.net](http://www.dinnernow.net/)~~示例应用程序。设置它有很多工作要做，但我认为如果你准备好同时处理这两种技术，那将有很大帮助。

# sql - 如何在sql中对链表进行排序？

> ID：515749
> 
> 赞同：19
> 
> 时间：2009-02-05T12:40:10.307
> 
> 标签：sql, sql-server, linked-list

我已经将链表实现为自引用数据库表：

```
CREATE TABLE LinkedList(
    Id bigint NOT NULL,
    ParentId bigint NULL,
    SomeData nvarchar(50) NOT NULL) 
```

其中 Id 是主键，ParentId 是列表中上一个节点的 Id。第一个节点的 ParentId = NULL。

我现在想从表中选择，按照它们应该出现的相同顺序对行进行排序，作为列表上的节点。

例如：如果表包含行

```
Id      ParentId  SomeData
24971   NULL      0
38324   24971     1
60088   60089     3
60089   38324     2
61039   61497     5
61497   60088     4
109397  109831    7
109831  61039     6 
```

然后使用标准对其进行排序，结果应该是：

```
Id      ParentId  SomeData
24971   NULL      0
38324   24971     1
60089   38324     2
60088   60089     3
61497   60088     4
61039   61497     5
109831  61039     6
109397  109831    7 
```

您应该使用*SomeData*列作为控件，所以请不要欺骗 *通过 SomeData 进行 ORDER* :-)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-05T13:05:57.387

我找到了 SQLServer 的解决方案，但看起来比 Quassnoi 的大而且优雅得多

```
WITH SortedList (Id, ParentId, SomeData, Level)
AS
(
  SELECT Id, ParentId, SomeData, 0 as Level
    FROM LinkedList
   WHERE ParentId IS NULL
  UNION ALL
  SELECT ll.Id, ll.ParentId, ll.SomeData, Level+1 as Level
    FROM LinkedList ll
   INNER JOIN SortedList as s
      ON ll.ParentId = s.Id
)

SELECT Id, ParentId, SomeData
  FROM SortedList
 ORDER BY Level 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-05T12:43:30.440

在甲骨文中：

```
SELECT Id, ParentId, SomeData
FROM (
  SELECT ll.*, level AS lvl
  FROM LinkedList ll
  START WITH
    ParentID IS NULL
  CONNECT BY
    ParentId = PRIOR Id
)
ORDER BY
  lvl 
```

PS 使用`NULL`as是一种不好的做法`ParentID`，因为它不能通过索引进行搜索。`0`插入一个 id 为or的代理根`-1`，然后使用`START WITH ParentID = 0`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-05T13:10:31.243

（编辑：d'oh！当我调试时你也发现了它！）

在 SQL Server 中：

```
;WITH cte (Id, ParentId, SomeData, [Level]) AS (
    SELECT Id, ParentId, SomeData, 0
    FROM LinkedList
    WHERE ParentId IS NULL
    UNION ALL
    SELECT ll.Id, ll.ParentId, ll.SomeData, cte.[Level] + 1
    FROM LinkedList ll
    INNER JOIN cte ON ll.ParentID = cte.ID
)
SELECT * FROM cte
ORDER BY [Level] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-09-25T12:40:54.303

PostgreSQL 版本。

创建表、索引和数据：

```
DROP TABLE IF EXISTS LinkedList;

CREATE TABLE LinkedList (
    Id BIGINT NOT NULL,
    ParentId BIGINT NULL,
    SomeData VARCHAR(50)
);

CREATE INDEX LinkedList_Id_idx on LinkedList (Id);
CREATE index LinkedList_ParentId_idx on LinkedList (ParentId);

INSERT INTO LinkedList
    (Id, ParentId, SomeData)
VALUES 
    (24971,   NULL,      0),
    (38324,   24971,     1),
    (60088,   60089,     3),
    (60089,   38324,     2),
    (61039,   61497,     5),
    (61497,   60088,     4),
    (109397,  109831,    7),
    (109831,  61039,     6); 
```

实际查询：

```
WITH RECURSIVE SortedList AS (
    SELECT
        *,
        0 AS SortKey
    FROM LinkedList
    WHERE ParentId IS NULL
    UNION ALL (
        SELECT
            LinkedList.*,
            SortedList.SortKey + 1 AS SortKey
        FROM LinkedList
        INNER JOIN SortedList
            ON (LinkedList.ParentId = SortedList.Id)
    )
)
SELECT
    *
FROM SortedList
ORDER BY SortKey; 
```

结果：

```
 id   | parentid | somedata | sortkey
--------+----------+----------+---------
  24971 |          | 0        |       0
  38324 |    24971 | 1        |       1
  60089 |    38324 | 2        |       2
  60088 |    60089 | 3        |       3
  61497 |    60088 | 4        |       4
  61039 |    61497 | 5        |       5
 109831 |    61039 | 6        |       6
 109397 |   109831 | 7        |       7 
```

还做了一些基准测试：

```
\set N 10000

DELETE FROM LinkedList;
INSERT INTO LinkedList VALUES (1, NULL, 1);
INSERT INTO LinkedList (
    SELECT
        generate_series AS Id,
        (generate_series - 1) AS ParentId,
        generate_series AS SomeData
    FROM GENERATE_SERIES(2, :N)
);

EXPLAIN ANALYZE
WITH RECURSIVE SortedList AS (
    SELECT
        *,
        0 AS SortKey
    FROM LinkedList
    WHERE ParentId IS NULL
    UNION ALL (
        SELECT
            LinkedList.*,
            SortedList.SortKey + 1 AS SortKey
        FROM LinkedList
        INNER JOIN SortedList
            ON (LinkedList.ParentId = SortedList.Id)
    )
)
SELECT
    *
FROM SortedList
ORDER BY SortKey; 
```

结果：

```
Sort  (cost=6236.12..6300.16 rows=25616 width=138) (actual time=17857.640..17858.207 rows=10000 loops=1)
  Sort Key: sortedlist.sortkey
  Sort Method: quicksort  Memory: 1166kB
  CTE sortedlist
    ->  Recursive Union  (cost=4.40..2007.10 rows=25616 width=138) (actual time=0.032..17844.139 rows=10000 loops=1)
          ->  Bitmap Heap Scan on linkedlist  (cost=4.40..42.78 rows=16 width=138) (actual time=0.031..0.032 rows=1 loops=1)
                Recheck Cond: (parentid IS NULL)
                Heap Blocks: exact=1
                ->  Bitmap Index Scan on linkedlist_parentid_idx  (cost=0.00..4.40 rows=16 width=0) (actual time=0.006..0.006 rows=2 loops=1)
                      Index Cond: (parentid IS NULL)
          ->  Hash Join  (cost=5.20..145.20 rows=2560 width=138) (actual time=0.896..1.780 rows=1 loops=10000)
                Hash Cond: (linkedlist_1.parentid = sortedlist_1.id)
                ->  Seq Scan on linkedlist linkedlist_1  (cost=0.00..96.00 rows=3200 width=134) (actual time=0.002..0.784 rows=10000 loops=10000)
                ->  Hash  (cost=3.20..3.20 rows=160 width=12) (actual time=0.001..0.001 rows=1 loops=10000)
                      Buckets: 1024  Batches: 1  Memory Usage: 9kB
                      ->  WorkTable Scan on sortedlist sortedlist_1  (cost=0.00..3.20 rows=160 width=12) (actual time=0.000..0.001 rows=1 loops=10000)
  ->  CTE Scan on sortedlist  (cost=0.00..512.32 rows=25616 width=138) (actual time=0.034..17851.344 rows=10000 loops=1)
Planning Time: 0.163 ms
Execution Time: 17858.957 ms 
```

所以这个查询很慢。

# c++ - 派生类如何从基类继承静态函数？

> ID：515763
> 
> 赞同：27
> 
> 时间：2009-02-05T12:44:59.517
> 
> 标签：c++, inheritance, static

```
struct TimerEvent
{
   event Event;
   timeval TimeOut;
   static void HandleTimer(int Fd, short Event, void *Arg);
}; 
```

HandleTimer 需要是静态的，因为我将它传递给 C 库（libevent）。

我想从这个类继承。如何才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-05T12:49:59.087

您可以轻松地从该类继承：

```
class Derived: public TimerEvent {
    ...
}; 
```

但是，您不能在子类中覆盖 HandleTimer 并期望它可以工作：

```
TimerEvent *e = new Derived();
e->HandleTimer(); 
```

这是因为静态方法在 vtable 中没有条目，因此不能是虚拟的。但是，您可以使用“void * Arg”将指针传递给您的实例......类似于：

```
struct TimerEvent {
    virtual void handle(int fd, short event) = 0;

    static void HandleTimer(int fd, short event, void *arg) {
        ((TimerEvent *) arg)->handle(fd, event);
    }
};

class Derived: public TimerEvent {
    virtual void handle(int fd, short event) {
        // whatever
    }
}; 
```

这样，HandleTimer 仍然可以从 C 函数中使用，只需确保始终将“真实”对象作为“void* Arg”传递。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-06-12T07:11:58.257

在某种程度上，特征模式允许您继承和重新定义静态方法。

首先从一个基类开始：

```
struct base {
  static void talk()  { std::cout << "hello" << std::endl; }
  static void shout() { std::cout << "HELLO !!" << std::endl; }
}; 
```

然后推导它并重新定义一些方法：

```
struct derived: public base {
  static void talk()  { std::cout << "goodbye" << std::endl; }
}; 
```

现在通过特征类调用方法：

```
template < class T >
struct talker_traits {
  static void talk() { T::talk(); }
  static void shout() { T::shout(); }
};

talker_traits<base>::talk()     // prints "hello"
talker_traits<base>::shout()    // prints "HELLO !!"

talker_traits<derived>::talk()  // prints "goodbye"
talker_traits<derived>::shout() // prints "HELLO !!" 
```

[ideone演示](http://ideone.com/hnGGmf)

`base::shout`特征类允许您在“覆盖”`base::talk`的同时重用静态方法`derived::talk`。尽管如此，实际继承还是有几个不同之处：

*   调用的函数在编译时解析
*   子方法不需要与父方法具有相同的签名

它也适用于静态字段和 typedef，最好的例子是[std::iterator_traits](http://en.cppreference.com/w/cpp/iterator/iterator_traits)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T09:58:09.247

你的问题在这里有点冲突。当您传递`&TimerEvent::TimerHandler`给 C 库时，您就是这样做的。如果你愿意，你也可以通过`&DerivedTimerEvent::TimerHandler`。但是您不能通过`&TimerEvent::TimerHandler`并期望*C 库*（！）弄清楚您的实际意思是`&DerivedTimerEvent::TimerHandler`.

# apache-flex - Adobe AIR 和 FLEX 的区别？

> ID：515774
> 
> 赞同：33
> 
> 时间：2009-02-05T12:51:16.853
> 
> 标签：apache-flex, air

Adobe AIR 和 FLEX 有什么区别？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-05T13:02:06.193

> “Flex 框架”是用于开发 RIA 的 AS3 类和组件的集合。
> 
> “Flex Builder”是用于开发“Flex 应用程序”的 IDE。
> 
> 与 HTML 是用于开发网页的标签集合的方式非常相似，Dreamweaver 是用于开发网页的 IDE。但是您不需要 Dreamweaver，您也可以使用记事本、BBEdit 等。
> 
> 如果您使用 Flex Builder 以外的其他工具在 Flex 中进行开发，则需要下载 Flex SDK 进行编译。编译后的 Flex 应用程序的最终结果是一个 SWF 文件（与 Flash 相同）。
> 
> 使用已编译的 SWF 文件，用户只需安装 Flash Player 即可运行应用程序。
> 
> 大多数 Flex 应用程序都经过开发、部署到服务器，然后使用 Web 浏览器将应用程序提供给用户使用。
> 
> 我还没有使用过 AIR，所以我不知道编译后的 AIR 应用程序的最终产品是什么，但 AIR 是 Fl​​ex 应用程序的替代交付系统，可以说取代了 Web 服务器和浏览器。它的主要目的是将 RIA 部署到用户的桌面，独立于 Internet 连接。
> 
> AIR，还允许使用 HTML、AJAX 等。所以一个 AIR 应用程序可以是所有这些东西的集合，一起编译。
> 
> 要运行 AIR 应用程序，您需要在计算机上安装 AIR Runtime。

[来源](http://www.ultrashock.com/forums/flex/difference-between-air-and-flex-90544.html)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-05T14:26:38.580

AIR 不是 Flex 的超集。

Adobe AIR 本质上是 Webkit、Flash、Javascript、Flex、XHTML、CSS、sqlLite。

空气的应用主要是在 ECMA 中开发的。（动作脚本/Javascript）。目前世界上大多数 AIR 应用程序都由 Javascript、xhtml、图像和 sqllite 组成。

Actionscript 引擎已针对 AIR 进行了扩展，以支持磁盘 IO 和其他“本地”系统功能。这使您的应用程序可以像正常的系统应用程序一样运行。尽管大多数人将他们的数据存储在 sqlLite 中，并且除了日志记录之外很少写入磁盘。（根据我注意到/阅读的内容）

无论如何，在 AIR 或 AIR 社区中并没有大量的 Flex。据我所知，很多 Javascript/Flash/XHTML 人员通过 AIR 运行时制作在多操作系统上运行的小型应用程序。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-05T14:04:42.743

我会通过说这取决于你的要求来补充加里（优秀！）的答案。存在概念差异和具体差异。加里的回答详细说明了一些细节。

但是，从概念上讲，AIR 是 Fl​​ex 的超集，而 Flex 是 Fl​​ash 的超集。

Flash 创作的 SWF 通常（虽然不总是 -- 但大多数时候）在 Web 浏览器中运行，并且由 ActionScript 代码组成。Flex 创作的 SWF 也可以在 Web 浏览器（或者类似的容器）中运行，并且由 ActionScript 代码组成，但通常也利用 Flex 框架，该框架本质上是 Adob​​e 提供的一组 ActionScript 类以帮助开发人员在构建功能更丰富的基于 Flash 的应用程序方面。最后，AIR 是在桌面上运行的 Flex——它是 Flash-plus-Flex，加上一些额外的面向桌面的工具，允许以 Flash 或 Flex 创作的 SWF 被安装并作为桌面应用程序运行。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-16T06:09:09.903

优秀的职位。作为旁注，我想补充一点，与 Flex/Flash SWF 不同，AIR SWF 不能，我再说一遍，不能在浏览器中播放。AIR SWF 需要它们自己的小沙箱来运行（运行时提供）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-01-20T16:59:15.583

有两种运行时 Flash 平台，一种是 Flash Player，另一种是 Adob​​e AIR（Adobe Integrated Runtime）。Adobe Flash Player 是一个极具表现力的跨平台运行时，适用于所有具有 Flay Player 插件的浏览器。Flash Player 提供在浏览器中运行的 SWF 文件，而 AIR 提供在浏览器之外的桌面上运行的 .air 独立应用程序。您可以从此处找到有关 AIR 和 Flash 的更多详细信息：[http ://readymadeflash.com/blogs/what-is-the-difference-between-adobe-AIR-and-flash.html](http://readymadeflash.com/blogs/what-is-the-difference-between-adobe-AIR-and-flash.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-11-22T03:46:18.303

我的印象是将 flex 移植到空中很简单 => [http://forums.adobe.com/message/2887004](http://forums.adobe.com/message/2887004)

我的理解是，理论上你的应用程序应该只需要一个真正的改变就可以工作。当然，现在我必须测试这个理论......

如果我能保留 flex 的所有功能，然后获得 HTML 控件和更新框架，我会非常兴奋，因为这就是所有 flex 真正缺少的强大功能。

去实验。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-04-19T06:33:51.480

要了解 Flex 和 Air，您需要了解整个 Adob​​e Flash Platform。Flash 重载意味着很多东西，Flash 平台、运行时、运行时 API 和 IDE。

[Adobe Flash Platform](https://www.adobe.com/platform/) - 一个广泛的术语，包括其他所有内容

运行时：
[Adob​​e Flash Player](https://www.adobe.com/products/flashplayer.html) - 您安装在 Web 浏览器上的插件，支持 Flash API
[Adob​​e Air Runtime](https://www.adobe.com/products/air.html) - 您安装的另一个插件作为桌面应用程序运行，支持 Air API（Flash API 的超集）

API：
[ActionScript - 带有](https://www.adobe.com/devnet/actionscript.html)[Flash API 或 Air API](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/index.html)的后端，您可以选择使用哪个 API 来编译您的应用程序，它将在各自的运行时运行。AS 适用于 Flash UI 或 Flex UI
UI - [Flash 组件](https://www.adobe.com/devnet/flash/components.html)（专有 fla 格式）或[Flex 框架](https://www.adobe.com/products/flex.html)（基于 XML）

IDE：
[Adobe Flash Pro](https://www.adobe.com/products/flash.html) (CS4/5/6/CC) - 处理 Flash 项目
[Flash Builder](https://www.adobe.com/products/flash-builder.html) - 处理 Flex 项目

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-25T21:26:08.613

Flex 是一个框架，用于在 Flash 播放器上呈现内容，主要用于企业应用程序。AIR 是一个运行时，它将 flex、flash 和/或 html 包装在一个包中，可以在不使用浏览器的情况下在桌面上访问，以便用户可以获得桌面（如访问目录、与系统 chrome 交互等... ) 除了给用户带来 web 的感觉（访问 http 请求、渲染 html、调用 web 服务等...）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-29T17:00:00.340

这是一个很好的比较线程！我刚刚为几个博物馆安装构建了一系列 AIR 应用程序。AIR 应用程序就是这样......独立的、已编译和优化的应用程序，包含在它自己的安装程序中。这是一个相当多才多艺的包装器，如果你玩得好，它会编译一堆代码。您基本上可以构建一个网站，然后将其全部压缩成一个桌面应用程序。因为它在本地运行，所以它还能够绕过 Flash 的安全协议（我不确定 Flex 是否能够做到）。当涉及到无缝链接应用程序、显示器、输入/输出等时，这使您可以访问完全不同级别的功能。

因此，您可以将 FLEX 构建封装在 AIR 应用程序中...... Adob​​es AIR 开发中心非常彻底地分解了所有内容，并且一定要通读 adobe livedocs！

[http://www.adobe.com/devnet/air.html](http://www.adobe.com/devnet/air.html)

[http://livedocs.adobe.com/flex/3/html/help.html?content=Part5_AIR_1.html](http://livedocs.adobe.com/flex/3/html/help.html?content=Part5_AIR_1.html)

# cocoa - 根据表格列的 isEnabled 出价自定义 NSTextFieldCell

> ID：515776
> 
> 赞同：0
> 
> 时间：2009-02-05T12:51:48.397
> 
> 标签：cocoa, macos

我基本上试图实现的是更改表格中单元格的格式以在未启用单元格时将其空白。

要定义是否启用表格列中的单元格，我已使用启用的绑定进行绑定，这工作正常，在表格的某些行中启用单元格，而在其他行中不启用。我已经定义了一个 NSTextFieldCell 的子类，我用它来更改单元格的格式。这似乎也可以正常工作，但我无法根据表格中的单元格是否启用来触发更改。最初我试图通过在单元格上调用 [self isEnabled] 来激活开关。这有效，但开关从未激活，我认为这是因为定义是否启用单元格的原始绑定是针对表格列而不是单元格。

有没有人有办法轻松实现这一点。我注意到的唯一方法是将 NSTableColumn 子类化并编写 dataCellForRow 的自定义版本：但这似乎不是解决此问题的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T14:26:52.043

我使用表格视图的委托方法在显示单元格之前设置文本颜色。您可以将单元格颜色设置为背景颜色，以便在禁用单元格时使其不可见。

```
- (void)tableView:(NSTableView *)aTableView willDisplayCell:(id)aCell forTableColumn:(NSTableColumn *)aTableColumn row:(int)rowIndex
{
    NSColor* theColor = [NSColor blackColor];
    布尔启用 = 是；
    if(![self tableView:aTableView shouldSelectRow:rowIndex])
    {
            theColor = [aCell 背景颜色];
            启用=否；
    }

    [aCell setTextColor:theColor];
    [aCell setEnabled：启用]；
}

```

我简单地测试了这段代码并且它有效。我没有使用绑定，但只要表的委托设置正确，这无关紧要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T08:17:54.580

谢谢你的回答马克。它似乎对我不起作用，但它确实为我指明了正确的方向。我不能完全做我想做的所有事情，因为用背景颜色填充单元格的方形边缘有点刺眼，但它工作得相当稳健，所以我现在就使用它。我使用的实际代码是：

```
- (void)tableView:(NSTableView *)aTableView 
  willDisplayCell:(id)aCell 
  forTableColumn:(NSTableColumn *)aTableColumn 
          row:(int)rowIndex
{
    NSColor *cellColor = [NSColor lightGrayColor];
    if([aCell isEnabled])
    {
        cellColor = [NSColor whiteColor];
    }
    if([aCell isKindOfClass:[NSTextFieldCell class]])
    {
        [aCell setDrawsBackground:YES];
    }
    [aCell setBackgroundColor:cellColor];
} 
```

# java - AJAX 框架实现的最佳实践

> ID：515777
> 
> 赞同：6
> 
> 时间：2009-02-05T12:52:12.747
> 
> 标签：java, ajax

实施 AJAX 框架和处理“特殊”情况的最佳实践是：

*   AJAX 调用的会话超时（重定向到登录页面、错误、忽略...）
*   AJAX 请求中的服务器异常
*   以下多个 AJAX 调用中的服务器会话状态
*   已进行 AJAX 调用的页面的浏览器重新加载
*   浏览器返回进行 AJAX 调用的页面
*   延迟的 AJAX 请求
*   ...

任何文章、书籍、通知……都会有所帮助。通用 AJAX 或专门用于某些服务器端实现。

（我的案例是 java，基于组件的状态完整 UI 框架，AJAH 类似于 AJAX（异步 java 脚本和 HTML）

注意：我已经在谷歌上搜索了一段时间，我发现的所有文章都是关于 AJAX 有多酷或如何在某些框架的帮助下实现它的文章。没有关于如何编写这样的框架，做它时的一般问题是什么等等......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T16:08:11.307

我不知道有所有这些答案的网站或书籍，但也许有一些线索。

我已经遇到了会话问题，这就是我的想法：

*   我认为处理会话超时的最佳方法是在超时前几分钟向用户显示一条消息，说会话即将到期，这意味着他将失去他所做的一切。该消息应包含一个 ajax 链接，该链接将向服务器发送请求以清除会话超时并关闭该消息。
*   如果用户不在屏幕前且会话超时，您可以显示关闭上一条消息并显示另一条表示会话已过期，并建议通过保存用户输入数据重新加载页面任何（或者至少，告诉他他将丢失他最终输入的内容）。

为了在您使用 Ajax 时处理浏览器“返回”或“重新加载”操作，我认为您应该看一下[真正简单](http://code.google.com/p/reallysimplehistory/)的历史项目，它允许您设置有关一段 URL 的状态。

另外，我阅读了[Ajax Patterns and Best Practices](http://ajaxian.com/archives/book-review-ajax-patterns-and-best-practices)一书，它为我提供了一些关于特定 Ajax 问题的建议。也许这对你也有帮助。

# java - 可视化调试数据结构

> ID：515783
> 
> 赞同：3
> 
> 时间：2009-02-05T12:55:52.990
> 
> 标签：java, data-structures, visualization

我有一些 Java 代码可以从一些文件中的数据构建一个数据结构（大约 500 个相互关联的小对象），我真的很想可视化生成的结构。我希望看到它能让我优化，不是代码，而是数据本身。

我想知道是否有一个调试器可以做到这一点，或者我可以转储数据并让一个工具为我构建一个漂亮的数据结构图。

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T13:09:17.533

我之前通过将我的所有对象转储为点格式来解决这个问题，对于[GraphViz](http://www.graphviz.org/)，然后使用 GraphViz 来可视化数据，但不是实时的。我有一个命令可以启动一个可以遍历结构的转储访问者。无论如何，当使用大约 3000 个节点时，转储大约需要一秒钟，而平衡图形需要更多时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T13:10:34.677

在 C++ 中，我用来做类似事情的工具是 GNU Data Display Debugger [DDD](http://www.gnu.org/software/ddd/)。根据手册，您可以使用 JDB 作为调试后端。我从未尝试过，但它可能值得一试——我在使用 DDD 创建复杂数据结构图方面取得了巨大成功。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T13:40:18.407

在重量级方面，有一个名为 Moose 的软件再工程集合。它拥有你需要的一切。但它是一大套单独的工具（主要由学生开发），具有不同程度的成熟度和易用性。

[http://moose.unibe.ch/](http://moose.unibe.ch/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T13:43:14.673

在 Java 中可视化数据的其他工具：[prefuse](http://prefuse.org/)和[Processing](http://processing.org/)。

# c++-cli - 我可以阻止 C++/CLI 将 IDisposable 添加到我的 ref 类吗？

> ID：515785
> 
> 赞同：7
> 
> 时间：2009-02-05T12:56:52.053
> 
> 标签：c++-cli, idisposable

`IDisposable`当您在 ref 类上实现析构函数时，C++/CLI 会为您生成脚手架。此外，如果您没有实现析构函数，但您的类有一个成员变量 implements `IDisposable`，那么`IDisposable`它会再次在您的类上自动实现。`IDisposable`它非常有用，并且比C# 中的处理方式要好得多。

在实现一个持有`msclr::com::ptr`（包含 RCW 的智能指针）的 ref 类时，我遇到了这种行为。

```
ref class Test /* : IDisposable added by the compiler */
{
  msclr::com::ptr<IWhatever> _aComObject;
} 
```

在*我的特定情况下*，我的类引用的 COM 对象不会“锁定”某些非托管资源，它实际上只是占用了 CLR 看不到的一些非托管内存。因此，我想通过不实现`IDisposable`该类来避免混淆我的 ref 类的用户。相反，我想通过使用 GC API 添加适当的内存压力，让 CLR 知道 COM 对象的存在。

所以，问题是：有没有办法抑制`IDisposable`在不实现析构函数但持有`IDisposable`成员变量的 ref 类上的实现？

**注意：**这通常是错误的做法，因为它会阻止该类的用户确定性地处理底层 COM 对象，但考虑到特定情况，暴露`IDisposable`可能会混淆我的 ref 类的用户，因为它确实不需要 Dispose 有问题的 ref 类。

我想一种选择是在没有析构函数的情况下实现 msclr::com::ptr 的变体。

任何其他抑制自动添加 IDisposable 的方法将不胜感激。谢谢。

* * *

## 回答

声明`_aComObject`为 msclr::com::ptr ( `msclr::com::ptr<IWhatever>^`) 的句柄。编译器不会将其`Test`视为 comptr 对象的“所有者”，并且不会在删除 Test 时释放它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T15:09:26.777

我认为答案是持有 msclr::com::ptr 的*句柄*，而不是“按值”持有它（它仍然将它作为“幕后”的句柄，除了 C++CLI 编译器处理它作为一个值 - 当所有者对象被删除（Disposed）时“删除”它（调用 Dispose））。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T01:32:34.087

我不确定我是否同意避免 IDispose 实现的理由——但为什么不在你的类中存储一个 IWhatever*。然后编译器不应生成 IDisposable 实现。

如果您不想要析构函数行为，那么 com::ptr 包装器购买您有什么好处？如果你真的需要它，你总是可以在堆栈上声明一个 com::ptr 并在任何给定的方法中将你的成员指针分配给它。

# c# - Webrequest 禁止自动重定向

> ID：515787
> 
> 赞同：2
> 
> 时间：2009-02-05T12:56:54.050
> 
> 标签：c#, .net-2.0, webrequest

在 .Net 2.0 中，如何在使用 WebRequest 时禁止自动重定向？我发现一些源代码在那里使用了 AllowAutoRedirect 属性，但是在我的 WebRequest 上没有这样的属性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T13:10:21.620

您需要将其转换为`HttpWebRequest`

```
HttpWebRequest WebRequest =
(HttpWebRequest)System.Net.WebRequest.Create("http://www.mySite.com");
WebRequest.AllowAutoRedirect = false; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T13:11:36.483

`WebRequest`本身没有这样的属性，但是`HttpWebRequest`有。如果你投到`HttpWebRequest`，你可以设置`AllowAutoRedirect`为假。

如果您的网络请求确实*不是*，`HttpWebRequest`请说明它是什么类型的请求。

# c++ - 模板函数中引用类型的推导

> ID：515788
> 
> 赞同：3
> 
> 时间：2009-02-05T12:57:08.980
> 
> 标签：c++, templates

在引用类型推导方面，我是否必须显式实例化函数模板的类型。如果是这样的话，歧义在哪里？让我们比较以下 2 个代码片段：

第一个：[代码链接](http://codepad.org/2H5QY3sW)

```
template <typename T> 
void foo(T& var, void(*func)(T&)) // T must be instantiated with int and it does .
{
 ++var;
} 
void ret(int & var){}
int main()
{int k =7; 
foo(k, &ret);
cout<<k;//prints 8
} 
```

现在让我们删除 foo() 的 decleration 中的 &'s，我们有一个错误。

第二：[代码链接](http://codepad.org/jz6qJoAG)

```
template <typename T> 
void foo(T var, void(*func)(T)) // T must be instantiated with int& but it doesn't.
{
 ++var;
} 

void ret(int & var){}

int main()
{int k =7; 

foo(k, &ret); //error: no matching function for call to 'foo(int&, void (*)(int&))'
cout<<k;
} 
```

`<int&>`但是，如果我通过使用“ ”显式实例化来调用 foo `foo<int&>(k,&ret);`，则代码会给出与前一个相同的输出。这个错误的原因是什么？歧义在哪里？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T16:47:42.367

正如 Fionn 的[回答](https://stackoverflow.com/questions/515788/deduction-of-reference-types-in-template-functions/515805#515805)中强调的那样，问题在于编译器为*T*、*int*和*int&*推导出了两种不同的类型。18.8.2.4/2 有以下内容：

> In some cases, the deduction is done using a single set of types P and A, in other cases, there will be a set of corresponding types P and A. Type deduction is done independently for each P/A pair, and the deduced template argument values are then combined. If type deduction cannot be done for any P/A pair, or **if for any pair the deduction leads to more than one possible set of deduced values**, or if different pairs yield different deduced values, or if any template argument remains neither deduced nor explicitly specified, template argument deduction fails.

The highlighted text I believe covers your example. You didn't ask, but one option you potentially have is to use two template parameters in your example. Both of these cases can be deduced, so you could then use some other template trickery possibly via enable if to create a new type which represents the version you want, ie. with reference or without.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T13:04:21.117

答案的第二个版本，只是误解了这个问题：

第二个版本的问题是编译器不知道你是想通过引用传递还是通过值传递。

两者的调用语法完全相同，但您显然希望通过引用传递 - 否则增量没有任何意义。

这里有一个例子来说明如何调用一个通过引用传递的函数和一个通过值传递参数的函数没有区别：

```
void Incr1(int &value) { value++; }
void Incr2(int value) { value++ } //Completely useless but for demonstration

//Now the calling of both functions
int x = 1;
Incr1(x);
Incr2(x); 
```

如果您使用指针而不是引用，编译器知道该怎么做，因为您明确告诉它您将指针传递给 int。

```
#include <iostream>

template <typename T> 
void foo(T var, void(*func)(T))
{
    ++(*var);
} 

void ret(int *var){}

int main()
{
    int k =7; 

    foo(&k, &ret); 
    std::cout<<k;
} 
```

* * *

这将使它编译，但它没有多大意义：

错误是您的函数仍然需要 T& 而不是 T。

所以你只需要这个小小的修改：

```
template <typename T> 
void foo(T var, void(*func)(T&))
{
 ++var;
} 

void ret(int & var){}

int main()
{
    int k =7; 

    foo(k, &ret);
    std::cout<<k;
} 
```

# asp.net - 如何在 ASP.Net 中的不同应用程序之间发送用户 ID？

> ID：515795
> 
> 赞同：1
> 
> 时间：2009-02-05T13:00:02.967
> 
> 标签：asp.net, session

我有两个 Web 应用程序，并且都是在 ASP.NET 中开发的。现在我想提供一项功能，使用户能够从应用程序站点（IIS 的一个虚拟目录）A 中的一个 URL 单击到应用程序站点 B（IIS 的另一个虚拟目录）中的另一个 URL。

我有两个想法来实现它们，但是它们都有问题。我想知道什么解决方案应该是最佳解决方案？

解决方案1：使用cookie，所以从两个应用程序站点，我们可以通过读取cookie来检索用户ID信息，但是如果cookie在浏览器中被禁用，这个“跳转”功能恐怕永远不会起作用。

解决方案 2：当用户重定向到另一个站点中的 URL 时，我可以在 URL 之后附加用户 ID，我可以重定向到另一个站点中的这个 URL [http://www.anotherapplicationsite.com/somesuburl?userID=foo](http://www.anotherapplicationsite.com/somesuburl?userID=foo)，但是我我担心这样用户ID会很容易暴露，从而引发安全问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T13:57:44.630

我经常处理这类事情。您正在寻找的内容听起来像是候选单点登录解决方案或联合安全性。

您可以尝试执行类似于以下的操作：

1.  使用“nonce”和“username”两列创建一个简单的数据库或其他类型的表存储

2.  当您构建到另一个站点的链接时，创建一个 GUID 或其他唯一标识符以用作一次性随机数，并将其作为查询字符串传递？id=。使用当前经过身份验证的用户名和您创建的唯一标识符在表中插入一个条目。

3.  当您到达链接的目的地时，传递唯一标识符以调用 Web 服务，该服务将在跳转到第二个站点之前将标识符与您插入的数据库中的用户名匹配（使用 ssl 保护）。

4.  如果 nonce 使用有效的用户名签出，则一切就绪。Web 服务应该删除已使用的条目，并且只要您不在事务中，表格应该或多或少地保持为空。

在您的 nonce/username 表中包含一个日期时间并在 60 秒或更短的时间内将其过期以最大程度地降低重放攻击的风险也是很好的。我们还需要外部应用程序的客户端证书来调用 Web 服务，以验证调用者的身份。内部应用程序实际上并不需要使用客户端证书。

这样做的好处是它可以很好地扩展到您想使用的任意数量的站点

不完美的安全性，但我们从来没有对这样的系统做出重大妥协。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T13:09:18.453

只要您在第二个网站上有一个良好的身份验证系统，我认为解决方案 2 适合您，当然考虑到 Andrew 关于敏感 ID 的评论。

有关加密的更多信息：查看[FormsAuthentication.Encrypt Method](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.encrypt.aspx)的文档。我认为他们甚至在该示例中通过在 cookie 中写入值来做一些事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T13:11:36.983

如果您将用户 ID 放在查询字符串中，而这就是第二个应用程序用来允许登录的全部内容，那么是什么阻止我手动输入其他用户 ID？您仍然需要在新站点上提示输入密码。

我会使用数据库来保存登录信息，并让两个站点都引用同一个数据库。像使用会话一样使用它。

D

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-05T13:03:19.620

我不认为 1) 由于浏览器的安全性（来自一个域的 cookie 不能被另一个域读取）而起作用。我会选择 2)，但我会加密查询字符串值。

[编辑：有关 cookie 隐私/安全问题的更多信息，请查看此处](http://en.wikipedia.org/wiki/HTTP_cookie)的“隐私和第三方 cookie”部分。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-05T13:05:31.817

您使用什么作为用户的ID？如果您使用他们的社会安全号码或电子邮件（敏感的东西），那么您将需要在将值放入查询字符串之前对其进行加密。否则（如果用户的 id 是不明确的，例如整数或 GUID），将 id 放在查询字符串上应该没问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-05T13:10:45.940

使用跨域，你不能共享会话，所以我在考虑 POST

**想法1**

如果害怕在地址中“显示”用户名，为什么不发送 POST 呢？

```
<form name="myForm" action="http://www.mydomain.com/myLandingPage.aspx">
  <input type="hidden" id="userid" value="myUsername" />
  <a href="javascript:myForm.Submit();">click here</a>
</form> 
```

但是然后...当然，“查看源代码”会显示它

**想法 2**

然后..我记得我也是这样做的，但是发送了一个加密字符串，例如：

```
 http://www.anotherapplicationsite.com/somesuburl?userID=HhN01vcEEtMmwdNFliM8QYg+Y89xzBOJJG+BH/ARC7g= 
```

您可以使用 Rijndael 算法来执行此操作，下面的链接有 VB 和 C# 代码：

[http://www.obviex.com/samples/EncryptionWithSalt.aspx](http://www.obviex.com/samples/EncryptionWithSalt.aspx)

**然后**在站点 2 中，只需解密并检查用户是否存在......如果存在，请继续，如果不是说用户试图调整查询字符串:)

# delphi - Synapse 库中的 WSAETIMEDOUT 消息

> ID：515796
> 
> 赞同：0
> 
> 时间：2009-02-05T13:00:30.487
> 
> 标签：delphi, udp, synapse

为什么我总是在这段代码中得到 WSAETIMEDOUT 错误：

```
var fUDPBuf: array [1..UdpPacketSize] of byte;
{...}
UDPSocket := TUDPBlockSocket.Create;
UDPSocket.Bind(UDPIP, UDPPort);
if UDPSocket.LastError = 0 then
  Raise EDevFail.Create(Format(SPortFailed, [UDPPort]));

while not Terminated do begin
  BytesRead := UDPSocket.RecvBufferEx(@fUDPBuf[1], UdpPacketSize, 1000);
  if BytesRead <= 0 then
    case UDPSocket.LastError of
      0, WSAETIMEDOUT: Continue;
      WSAECONNRESET, WSAENETRESET,
      WSAENOTCONN, WSAECONNABORTED,
      WSAENETDOWN: begin
                     Raise EDevFail.Create(UDPSocket.GetErrorDesc(UDPSocket.LastError));
                     UDPSocket.CloseSocket;
                   end;
      else begin
        Raise EDevFail.Create(UDPSocket.GetErrorDesc(UDPSocket.LastError));
        UDPSocket.CloseSocket;
      end;
    end;

  //Sleep(1);
  ProcessData(@fUDPBuf[1]);
  inc(PacketCount);
end; 
```

我确信我从 e 网络设备接收的 UDP 数据与 UdpPacketSize 一样多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T13:33:19.593

在调用“UDPSocket.RecvBufferEx(@fUDPBuf[1], UdpPacketSize, 1000);” 我假设最后一个数字是超时时间。这样做是为了它不会永远等待，而是定期检查线程是否已使用 while 循环条件终止。所以超时是这类代码的正常情况，可以忽略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T11:30:00.090

我解决了我的问题:)

```
UDPSocket.Bind(UDPIP, UDPPort); 
```

一定是

```
UDPSocket.Bind('0.0.0.0', UDPPort); 
```

和

```
if UDPSocket.LastError = 0 then 
```

一定是

```
if UDPSocket.LastError <> 0 then 
```

用于检查数据来自的 IP 地址

```
if UDPSocket.GetRemoteSinIP<>UDPIP then .... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T16:21:18.957

我找到。错误在

```
if UDPSocket.LastError = 0 then 
```

LastError 为 10049=此时无法分配请求的地址。那么为什么我不能绑定UDPIP地址。我检查了IP和端口。这些都是正确的。并且没有其他软件监听这个端口。

# python - 用Python检测Linux中的按键组合？

> ID：515801
> 
> 赞同：5
> 
> 时间：2009-02-05T13:03:36.673
> 
> 标签：python, linux, keylogger

我正在尝试捕获按键，以便在按下给定组合时触发事件。

我四处寻找有关如何开始的提示，我能找到的最简单的代码片段是 Python - 我从[这里](http://www.daniweb.com/forums/thread112975.html)获取了下面的代码。但是，当我从终端运行它并按一些键时，在“按一个键...”语句之后没有任何反应。

我是不是很傻？谁能解释为什么什么都没发生，或者建议在 Linux 上实现这一目标的更好方法（考虑任何语言！）？

```
import Tkinter as tk

def key(event):
    if event.keysym == 'Escape':
        root.destroy()
    print event.char

root = tk.Tk()
print "Press a key (Escape key to exit):"
root.bind_all('<Key>', key)
# don't show the tk window
root.withdraw()
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T13:12:09.947

如果您不显示窗口，Tk 似乎无法获得它。尝试：

```
import Tkinter as tk

def key(event):
    if event.keysym == 'Escape':
        root.destroy()
    print event.char

root = tk.Tk()
print "Press a key (Escape key to exit):"
root.bind_all('<Key>', key)
# don't show the tk window
# root.withdraw()
root.mainloop() 
```

为我工作...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T13:26:15.783

您正在做的是以`/dev/tty`“原始”模式阅读。

正常的 Linux 输入是“熟的”——退格和换行符已经为您处理好了。

要以“原始”模式读取像键盘这样的设备，您需要直接对 IOCTL 进行 Linux API 调用。

查看[http://code.activestate.com/recipes/68397/](http://code.activestate.com/recipes/68397/)以获取有关这方面的一些指导。是的，配方在 tcl 中，但它会提示您如何进行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T14:16:27.353

好吧，事实证明，使用 GNOME 时有一个更简单的答案，它根本不涉及任何编程......

[http://www.captain.at/howto-gnome-custom-hotkey-keyboard-shortcut.php](http://www.captain.at/howto-gnome-custom-hotkey-keyboard-shortcut.php)

[存档于 Wayback](https://web.archive.org/web/20070802112319/http://www.captain.at/howto-gnome-custom-hotkey-keyboard-shortcut.php)

只需创建要由组合键触发的脚本/可执行文件，并将您在 gconf-editor 中创建的“keybinding_commands”条目指向它。

为什么我没有早点想到呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-12T11:14:22.083

或者（非 Python 选项）使用[XBindKeys](http://www.nongnu.org/xbindkeys/xbindkeys.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-22T11:39:19.357

tkinter 'bind' 方法仅在 tkinter 窗口处于活动状态时才有效。

如果您想要在所有桌面上工作的绑定击键组合（全局键/鼠标绑定），您可以使用[bindglobal](https://github.com/segalion/bindglobal)（安装`pip install bindglobal`）。它的工作原理与标准 tkinter 'bind' 完全一样。

示例代码：

```
import bindglobal
def callback(e):
    print("CALLBACK event=" + str(e))

bg = bindglobal.BindGlobal()
bg.gbind("<Menu-1>",callback)
bg.start() 
```

# c - 我应该禁用 C 编译器有符号/无符号不匹配警告吗？

> ID：515803
> 
> 赞同：15
> 
> 时间：2009-02-05T13:03:53.037
> 
> 标签：c, compiler-construction, warnings

当您尝试比较两个变量时，Microsoft C 编译器会发出警告，一个是有符号的，另一个是无符号的。例如：

```
int a;    
unsigned b;

if ( a < b ) { // warning C4018: '&lt;' : signed/unsigned mismatch

} 
```

在世界历史上，这个警告有没有发现过真正的错误？为什么它在那里？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-05T13:08:06.930

永远不要忽略编译器警告。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-05T13:07:03.250

哦，它有。但反过来。有一天，*无视这个警告让我非常头疼。*我正在编写一个绘制图形并混合有符号和无符号变量的函数。在一个地方，我将一个负数与一个无符号数进行了比较：

```
int32_t t; ...
uint32_t ut; ...

if(t < ut) { 
    ...
} 
```

猜猜发生了什么？有符号数被提升为无符号数，因此最终*更大*，即使它最初低于 0。我花了几个小时才找到错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T03:37:09.560

如果你要问这个问题，你对禁用它是否安全知之甚少，所以答案是否定的。

我不会禁用它——我不认为我总是比编译器更了解（尤其是因为我经常不这样做），尤其是因为我有时会在编译器不知道的情况下因疏忽而犯错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-05T13:06:01.783

您*应该*更改`a`and`b`都使用有符号类型，或者都使用无符号类型。但这可能不切实际（例如，它可能超出您的控制范围）。

警告用于捕获带负值的有符号整数和无符号整数之间的比较——如果两个数字的大小都很小，则前者将（错误地）被视为大于后者。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T13:06:23.623

二元运算符通常在进行比较之前将两种类型转换为相同的类型，因为其中一种是无符号的，它也会将 int 转换为无符号的。通常这不会造成太大的麻烦，但如果你的 int 是一个负数，这会导致比较错误。

例如，从有符号转换为无符号时，-1 等于 4294967295，现在将其与 100（无符号）进行比较

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-05T13:16:55.677

警告是有目的的......它们会让你认真思考你的代码！

就个人而言，如果可能的话，我总是会显式地强制转换有符号的 --> 无符号和无符号的 --> 有符号的。通过这样做，您可以确保您拥有交易的所有权并且您知道会发生什么。我意识到这可能并不总是可能的，具体取决于执行此操作的项目，但始终以 0 个编译器警告为目标……它只能提供帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-07T03:53:46.093

我写代码的时间比我愿意承认的要长。根据个人经验，忽略看似迂腐的编译器警告有时会产生非常令人不快的结果。

如果他们惹恼了你并且你接受/理解了这种情况，那么设置一个演员并继续前进。

最终，在设计新代码时，这些事情会从被忽视的细微差别转变为有意识的决定。结果为 mickmouse 角落案例留下了更少的空间来破坏您或您的客户的一天和整体质量更好的软件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-07T08:08:09.873

我什至配置了编译器以使该警告成为编译错误。由于所有其他人已经提到的原因。

如果我遇到有符号/无符号不匹配，我会问自己为什么选择不同的“签名”。这通常是设计错误。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-07T08:15:51.587

@gimel关于拍摄整个链接背后的整个腿的解释对于这个问题非常有用。

> ——“回避简单问题的人可能只是朝着不那么简单的问题前进。”

当您在不同类型之间进行转换并且您不检查那些可能伤害您的值时，这实际上总是正确的。

/约翰

更新：从 uint 转换为 int 的正确方法是对照 limits.h 或类似的东西检查值。（但我很少这样做，即使你知道我应该...... :-)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-02T20:14:01.707

我认为最好将您的无符号数转换为有符号数（在比较之前）。而不是反过来。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-02-05T13:36:34.093

**这只是C**允许你[*在脚上射击自己*](https://stackoverflow.com/questions/58640/great-programming-quotes/292009#292009)的众多方式之一 ——你最好知道自己在做什么。**C**的引用归功于**C++**的创建者[Bjarne Stroustrup](http://www.research.att.com/~bs/bs_faq.html#really-say-that)。

 **# asp.net - TinyMCE 和 ASP.NET 数据绑定问题

> ID：515813
> 
> 赞同：1
> 
> 时间：2009-02-05T13:07:45.477
> 
> 标签：asp.net, data-binding, tinymce

我有一个连接到存储过程的数据源，它将返回适用于特定页面的一条记录，对于另一种类似情况（填充标题信息），我在标题 html 周围包裹了一个转发器，并使用 <%$ Eval () %> 绑定表达式以将数据放入标题中。但是，我现在有另一个问题，它不起作用。

我的页面的一部分使用来自与标题相同的数据源的数据，它是一个注释部分。从数据源有一个注释字段，它是一个包含 HTML 的 varchar(max)。

我使用 TinyMCE 为注释创建了一个丰富的编辑器，但我希望编辑器填充数据源返回的 Notes 字段内容。因此，如果 TextAreas 能够在中继器中，我将被设置，因为我认为我可以将 html 填充到文本区域中，TinyMCE 会修复它（我在一些测试文本周围使用粗体标签进行了测试，它是正确的处理）。

是否有另一种方法可以使用 Databinding Eval 表达式来填充文本区域或 TinyMCE 可以理解的其他内容，以便在加载页面时填充富文本编辑器？

我的尝试看起来像：

```
<asp:Repeater ID="NotesRepeater" runat="server" DataSourceID="SheetParams">
<textarea style="clear:both; font-size:large" name="notes">
<%# Eval("Notes") %>
</textarea>
</asp:Repeater> 
```

我有 TinyMCE 设置

```
tinyMCE.init({
    theme: "advanced",
    mode: "textareas",
    width: "95%",
    theme_advanced_buttons1: "bold, italic, underline, strikethrough,|, justifyleft, justifycenter, justifyright, justifyfull,|,formatselect,fontsizeselect",
    theme_advanced_buttons2: "cut, copy, paste,|,bullist, numlist,|,outdent, indent,|,undo,redo",
    theme_advanced_buttons3: ""
}); 
```

但是我当然得到错误 Textarea can't be nested in repeater。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T13:10:55.783

您需要将 textarea 包装在 ItemTemplate 标记中才能使其工作：

```
<asp:Repeater ID="NotesRepeater" runat="server" DataSourceID="SheetParams">
   <ItemTemplate>
      <textarea style="clear:both; font-size:large" name="notes">          
         <%# Eval("Notes") %>
      </textarea>
   <ItemTemplate>
</asp:Repeater> 
```

# java - 覆盖 JTextPane 中 TAB 的默认行为

> ID：515819
> 
> 赞同：5
> 
> 时间：2009-02-05T13:09:24.757
> 
> 标签：java, swing

我正在实现一个基于 JTextPane 的文本编辑器。目前，当我有一段选定的文本时，按 TAB 键会删除选定的文本。我想更改此行为，以便 TAB 缩进所选文本。

怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T13:13:54.810

类似的东西：

```
public void keyPressed ( KeyEvent event ) {
        switch ( event.getKeyCode ()) {
            case KeyEvent.VK_TAB :
                insertTabChar ( event.isShiftDown ());
                event.consume ();
                break;
            case KeyEvent.VK_ENTER :
                snapshot ();
                insertNewLine ();
                event.consume ();
                break;
        }
    } 
```

你有一些课程可以做到这一点，比如[这个](http://www.koders.com/java/fid111B2AEDC5B123210487BE5E4260AD37FE5E6ACF.aspx?s=JTextPane+indent+tab#L70)。

特别是，函数

```
 /**
     * manage keyboard tabbing, implementing blockindent.
     * @param isUnindent
     */
    private void insertTabChar ( boolean isUnindent ) {

        snapshot (); // snapshot current setup

        if ( isSelection ) { // blockindent 
```

可能会做你需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T07:52:16.477

另一种方法是重新定义与 TAB 键关联的 JTextArea 组件的操作。看看 ActionMap。

# asp.net - 如何在 aspx 文件中创建区域？

> ID：515833
> 
> 赞同：11
> 
> 时间：2009-02-05T13:11:53.520
> 
> 标签：asp.net

我想知道有什么方法可以在 aspx 页面中创建区域，就像我们在 cs 页面中创建它一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T13:13:38.103

不幸的是，没有（至少在 Visual Studio 中没有）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T13:17:44.430

不是可扩展的，但在 HTML 中，通常使用注释来创建代码块

```
<!-- Start: Login access form -->

... Code ...

<!-- End: Login access form --> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-22T17:05:19.673

您可以选择评论部分，然后右键单击，折叠标签。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-05T13:17:44.490

我不认为有办法做到这一点。

但是，我建议如果您因为 .aspx 页面非常大而感到有必要这样做，您可能应该考虑重新设计它，或将其分解为用户控件 (.ascx) 或找出更有效的用途母版页。

不确定这是否是您提出问题的原因，但如果是，那只是一个想法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-27T22:21:00.567

如果您使用的是 Visual Studio（可能是 Web Essentials 插件，我不记得它是否为原生插件），以下代码片段将可在 HTML 文件（包括 CSHTML）中展开。不幸的是，这些在 ASPX 或 ASCX 文件中是不可扩展的。

```
<!--#region Example -->

...code...

<!--#endregion Example --> 
```

在 ASPX 或 ASCX 文件中，您可能更愿意这样做：

```
<%-- START Example --%>

...code...

<%-- END Example --%> 
```

它们仍然不可扩展，但它们不会被渲染出来，因此在右键单击页面并查看源代码时不可见。您只会在开发文件中看到它们。

PS直到我输入完答案，我才意识到这个问题有多老。所以我还是要继续把它放在这里，因为它看起来可以使用更新。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-05T13:24:52.120

Visual Studio 在识别具有大量内容的元素以使其可动态折叠方面做得非常好，但这是最接近的。

您可能会想到将一系列元素同级放在 DIV 中，以便 div 可以在 Visual Studio 中折叠。那很诱人，但我建议不要这样做。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-05T13:40:12.107

区域是一种 IDE 便利，允许您命名可能跨越多个函数或过程的代码段，并能够将整个段折叠/展开。Visual Studio 仅为代码提供此功能，**而不**为文件的 HTML/ASPX/CSS 部分提供此功能。例如，您可以在 ASPX 文件的 <script runat="server"> 部分中创建区域。

* * *

## 回答 #8

> 赞同：-7
> 
> 时间：2010-02-11T15:31:31.860

您可以使用 div 并将所有内容放入其中

# iphone - 当我输入时，带有 3 行的 UITextView 会自动向上滚动

> ID：515842
> 
> 赞同：0
> 
> 时间：2009-02-05T13:14:22.267
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我有一个 UITextView 用于输入一些文本（我已经使用 Interface builder 添加了它）

我已经将高度设置为 3 行高（所以在我的情况下，框架高度是 47）所以我可以有 3 行文本

我想要它做的是输入直到第 3 行，如果我转到第 4 行，它会上升，但它所做的是每当我输入时它会自动上升，所以我一直在我的 uitextview 顶部输入

我在网上放了一个捕获，显示它更清晰..即使我点击一条线，它也会到顶部！

[单击此处获取屏幕截图](http://andyj.be/iphone/iphoneTextView.swf)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T11:06:01.763

写`[textview setContentInset:UIEdgeInsetsZero]`在`textviewbeginediting`委托方法或在`ViewDidLoad`方法中

希望对你有帮助.....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T13:24:22.793

看起来诀窍是使字体大小更大

```
txtView.font = [UIFont systemFontOfSize:14]; 
```

当我将字体大小设置为大 2 点时，它只是正常输入，而不是每行都向上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-29T20:21:40.913

我为此苦苦挣扎了几个星期，最后发现我所要做的就是将 UITextView 的高度设置为两倍（或任何你想要的），将其背景颜色设置为 ClearColor，然后一切就绪。你只需要玩高度，你就会得到它。在我的情况下，UITextView 在一个表格单元中..首先当我增加它开始显示在当前单元格下方的单元格顶部的高度时。那是 ClearColor 为我创造奇迹的时候。

# linux - Bash 命令 :(){ :|:& };: 将产生进程导致内核死亡。你能解释一下语法吗？

> ID：515844
> 
> 赞同：40
> 
> 时间：2009-02-05T13:15:59.237
> 
> 标签：linux, bash

我查看了[此页面](http://www.commandlinefu.com/commands/view/58/jaromils-forkbomb-do-not-use)，无法理解这是如何工作的。

此命令“以指数方式生成子进程，直到您的盒子锁定”。

但为什么？我不太了解的是冒号。

`user@host$ :(){ :|:& };:`

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-02-05T13:41:50.153

```
:(){ :|:& };: 
```

.. 定义了一个名为 的函数`:`，该函数生成自身（两次，一个管道进入另一个），并为自身设置背景。

带换行符：

```
:()
{
    :|:&
};
: 
```

`:`将函数重命名为`forkbomb`：

```
forkbomb()
{
    forkbomb | forkbomb &
};
forkbomb 
```

您可以通过`ulimit`限制每个用户的进程数来防止此类攻击：

```
$ ulimit -u 50
$ :(){ :|:& };:
-bash: fork: Resource temporarily unavailable
$ 
```

更永久地，您可以使用`/etc/security/limits.conf`（至少在 Debian 和其他平台上），例如：

```
* hard nproc 50 
```

当然，这意味着您只能运行 50 个进程，您可能需要根据机器的运行情况来增加它！

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-02-05T13:17:47.237

这定义了一个 `:`调用自身两次的函数（代码：）`: | :`。它在后台执行此操作 ( `&`)。完成`;`函数定义并`:`启动函数后。

所以 : 的每个实例都会启动两个新的 : 等等......就像一棵进程的二叉树......

用纯 C 编写，即：

```
fork();
fork(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-18T09:11:08.297

只是补充一下上面的答案，管道的行为`|`是一次创建两个进程并将它们连接起来`pipe`（管道是操作系统自己实现的），所以当我们使用管道时，每个父进程都会产生另外两个进程，这导致以指数方式利用系统资源，从而更快地用完资源。

也`&`用于后台进程，在这种情况下提示立即返回，以便下一次调用执行得更快。**结论**：：更快地使用系统资源（以指数增长）：后台进程以更快地启动进程

[![指数增长](https://i.stack.imgur.com/i23x8.png)](https://i.stack.imgur.com/i23x8.png)
 **`|`
`&`**

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-31T17:46:40.140

这定义了一个名为`:`( `:()`) 的函数。在函数 ( `{...}`) 中，有一个`:|:&`是这样的：

*   `:`再次调用此`:`函数。
*   `|`表示通过管道将输出传递给命令。
*   `:`after`|`表示函数的管道`:`。
*   `&`，在这种情况下，意味着在后台运行前面的。

然后有一个`;`称为命令分隔符的。

最后，`:`开始了这个“连锁反应”，激活了[叉子炸弹](https://en.wikipedia.org/wiki/Fork_bomb)。

C 等效项是：

```
#include <sys/types.h>
#include <unistd.h>
int main()
{
    fork();
    fork();
} 
```

# c# - Silverlight：获取图像（来自 OpenFileDialog）的宽度/高度

> ID：515860
> 
> 赞同：2
> 
> 时间：2009-02-05T13:18:34.723
> 
> 标签：c#, silverlight, image

在从 URI 创建位图时，我一直在使用 BitmapImage.DownloadProgress 事件等到加载图像。那就是我可以在下载完成后使用事件处理程序来检查 Image.ActualWidth/ActualHeight。这工作正常。

但是当我加载用户从他们的计算机中选择的图像时，DownloadProgress 是无用的。

这适用于 URI 位图：

```
private void LoadImage(Uri uri)
{
    this.ResetProgressImage();
    BitmapImage image = new BitmapImage();            
    image.DownloadProgress += new EventHandler<DownloadProgressEventArgs>(LoadImageDownloadProgress);
    image.UriSource = uri;
    this.ImageFull.Source = image;
}

private void LoadImageDownloadProgress(object sender, DownloadProgressEventArgs e)
{
    this.Dispatcher.BeginInvoke(delegate
    {
        this.ProgressImage.Value = e.Progress;
        if (e.Progress == 100)
        {
            ImageHelper.Current.Width = Math.Round(this.ImageFull.ActualWidth);
            ImageHelper.Current.Height = Math.Round(this.ImageFull.ActualHeight);
        }
    });
} 
```

但这在从流中获取 BitmapImage 时不起作用：

```
private void LoadImage(Stream stream)
{
    this.ResetProgressImage();
    BitmapImage image = new BitmapImage();            
    image.DownloadProgress += new EventHandler<DownloadProgressEventArgs>(LoadImageDownloadProgress);            
    image.SetSource(stream);
    this.ImageFull.Source = image;
} 
```

使用 SetSource(stream) 时，有谁知道 DownloadProgress 的替代方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T20:33:55.297

BitmapImage 中没有使用流监控加载进度的事件。

但是，如果您只需要图像尺寸，则可以将图像添加到层次结构中并等待“Loaded”或“LayoutUpdated”事件。

# phpdoc - 如何在 phpdoc 注释中转义 phpdoc 注释？

> ID：515870
> 
> 赞同：6
> 
> 时间：2009-02-05T13:22:33.530
> 
> 标签：phpdoc

我想知道如何在 phpdoc 评论中转义 phpdoc 评论。

例如，我将如何写这个：

```
/**
 * Some documentation...
 *
 * <code>
 * /**
 *  * Example example phpdoc.
 *  */
 * </code>
 */ 
```

显然上面的例子是行不通的。

我尝试用 * 替换星号，但它会很好地打印“*”...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-09-17T14:49:01.593

根据[DocBlock Description details](http://manual.phpdoc.org/HTMLframesConverter/default/phpDocumentor/tutorial_phpDocumentor.howto.pkg.html#basics.desc)，您可以从 1.2.0rc1 开始，写 {@*} 来写 */。

例如：

```
/**
 * Simple DocBlock with a code example containing a docblock
 *
 * <code>
 *  /**
 *   * My sample DocBlock in code
 *   {@*} 
 * </code>
 */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-30T11:49:14.493

你需要使用`@example`. 在标记后添加以下行`</code>`

```
 @example /path/to/example.php How to use this function
 @example anotherexample.inc This example is in the "examples" subdirectory 
```

[你可以在这里](http://manual.phpdoc.org/HTMLSmartyConverter/HandS/phpDocumentor/tutorial_tags.example.pkg.html)找到更多信息。因此，您显然也需要将示例代码放在单独的文件中。

# c# - C#：创建抽象类的实例而不定义新类

> ID：515876
> 
> 赞同：24
> 
> 时间：2009-02-05T13:25:36.300
> 
> 标签：c#, abstract-class, abstract, anonymous-class

我知道它可以在 Java 中完成，因为我过去曾广泛使用过这种技术。下面将显示 Java 中的示例。（附加问题。这种技术叫什么？很难找到没有名字的例子。）

```
public abstract class Example {
   public abstract void doStuff();
}

public class StartHere{
   public static void main(string[] args){
      Example x = new Example(){
         public void doStuff(){
            System.out.println("Did stuff");
         }            
      };
      x.doStuff();
   }
} 
```

现在，我的主要问题是，这也可以在 C# 中完成，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-05T13:29:08.087

Java 技术被称为“[匿名内部类](http://java.sun.com/docs/books/tutorial/java/javaOO/innerclasses.html)”，在 C# 中没有等价物。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-05T13:46:38.253

使用 Lamba 表达式和类初始化器，您可以通过一些努力获得相同的行为。

```
public class Example {
    public Action DoStuff;
    public Action<int> DoStuffWithParameter;
    public Func<int> DoStuffWithReturnValue;
}

class Program {
    static void Main(string[] args) {
        var x = new Example() {
            DoStuff = () => {
                Console.WriteLine("Did Stuff");
            },
            DoStuffWithParameter = (p) => {
                Console.WriteLine("Did Stuff with parameter " + p);
            },
            DoStuffWithReturnValue = () => { return 99; }

        };

        x.DoStuff();
        x.DoStuffWithParameter(10);
        int value = x.DoStuffWithReturnValue();
        Console.WriteLine("Return value " + value);
        Console.ReadLine();
    }
} 
```

我刚刚意识到的这个解决方案的一个问题是，如果您要在 Example 类中创建字段，则 lambda 表达式将无法访问这些字段。

但是，没有理由不能将 Example 的实例传递给 lambda 表达式，这将使它们能够访问该示例可能持有的任何公共状态。AFAIK 在功能上等同于 Java 匿名内部类。

PS如果您要否决答案，请帮我们一个忙，并就您不同意的原因添加评论:-)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-05T13:51:47.777

通常，使用 Java 中的匿名内部类解决的问题可以使用 .Net 中的委托以更简洁的方式解决。您的示例有点过于简单，无法确定您的意图。如果您使用抽象类的意图是传递“行为”，请考虑只使用`Action`委托。

```
public class StartHere{
   public static void main(string[] args){
      Action doStuff = () => Console.WriteLine("Did stuff");
      executeSomething(doStuff);
   }

   public static void executeSomething(Action action)
   {
      action();
   }
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-05T13:29:56.370

这在 C# 中是做不到的；你需要声明一个新的类类型。您可以在 C# 中获得的最接近的可能是命名嵌套类：

```
public class StartHere{
    private class Foo : Example {
        public override void  doStuff()
        {
            Console.WriteLine("did stuff");
        }
    }
   public static void Main(string[] args){
      Example x = new Foo();
      x.doStuff();
   }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T13:36:46.513

这在 C# 中不受支持，如果由我决定，也不应该如此。

Java 中内部类的激增主要是由于缺少 C# 所具有的委托或 lambda。因此，虽然这种类型的功能目前在 java 中是“您唯一的希望”，但您通常可以使用 C# 中的其他机制来实现相同的目的。在这方面，Java 感觉就像用一只手弹钢琴。

（诚​​然，我们中的很多人都非常擅长这种单手游戏；现在看来我们至少要等到 java 8 才能关闭......）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T08:52:06.180

虽然所有好的答案，但建议的大多数解决方法都依赖于 C# 3.0

因此，为了完整起见，我将添加另一个既不使用 lambda 也不使用 Func 类型的解决方案（当然，正如 Matt Olenik 在评论中提到的那样，可以概括以下代表以同样的方式工作。）。对于像我这样可能仍在使用 C# 2.0 的人。也许不是最好的解决方案，但它确实有效。

```
public class Example
{
    public delegate void DoStuffDelecate();
    public DoStuffDelecate DoStuff;
    public delegate void DoStuffWithDelecate(int n);
    public DoStuffWithDelecate DoStuffWithParameter;
    public delegate int DoStuffWithReturnDelecate();
    public DoStuffWithReturnDelecate DoStuffWithReturnValue;
}

class Program
{
    static int MethodWithReturnValue()
    {
        return 99;
    }
    static void MethodForDelecate()
    {
        Console.WriteLine("Did Stuff");
    }
    static void MethodForDelecate(int n)
    {
        Console.WriteLine("Did Stuff with parameter " + n);
    }

    static void Main(string[] args)
    {
        var x = new Example();
        x.DoStuff = MethodForDelecate;
        x.DoStuffWithParameter = MethodForDelecate;
        x.DoStuffWithReturnValue = MethodWithReturnValue;

        x.DoStuff();
        x.DoStuffWithParameter(10);
        int value = x.DoStuffWithReturnValue();
        Console.WriteLine("Return value " + value);
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-09T10:07:15.637

由于您的类仅代表一个动作，因此您可以在您的情况下使用委托，存在一个现有委托：

```
public delegate void Action(); 
```

这与您的课程完全相同。

你的匿名类的声明更加清晰：

```
Action action = () => Console.WriteLine("Hello world");
action(); // invoke 
```

你甚至可以使用闭包：

```
public void Hello(string name)
{
  Action action = () => Console.WriteLine("Hello " + name);
  action(); // will call the above lambda !
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-05T13:30:19.613

简而言之，不，您必须将其定义为单独的子类。我认为这个功能即将推出 C# 4.0 吗？

**编辑：**不，它不会出现 C# 4.0 我编造的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-05T13:30:38.257

您可以使用 .NET 中的 Mocking 来完成此操作。但是，没有对该功能的语言支持，我认为它将在 C# 4.0 中可用。有许多用于 Mocking 的库，包括：

*   [起订量](http://code.google.com/p/moq)
*   [RhinoMock](http://ayende.com/projects/rhino-mocks.aspx)

# c# - 如何将 C# 转换为 DLL 以隐藏源代码？

> ID：515884
> 
> 赞同：1
> 
> 时间：2009-02-05T13:28:47.010
> 
> 标签：c#, visual-studio, dll, source-code-protection

如何以 DLL 用户无法查看我的源代码的方式将我的 C# 代码转换为 DLL 文件？

当我以我一贯的方式制作 DLL 时，通过制作类库项目、导入我的类并编译它，仍然可以查看源代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-05T14:24:38.647

我相信你正在寻找一个混淆器。这是一个工具，它将获取已编译的 DLL 并重写代码，以防止其他用户对它进行有意义的反编译。Visual Studio 附带一个免费的[Dotfuscator](http://msdn.microsoft.com/en-us/library/ms227240(VS.80).aspx)

请注意，这实际上不会阻止人们查看您的代码。相反，他们将查看您的代码的非常奇怪的翻译。没有办法阻止人们使用 C# 或任何其他 .Net 语言查看代码的反编译版本。

这不是 C# 独有的东西。事实上，这是存在的每种语言的缺陷。完全可以反编译 C 代码。但不同之处在于，在反编译托管语言（例如 .Net 和 Java）时，维护大量原始代码结构要容易得多，因为元数据会维护原始结构。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T13:32:26.473

混淆是您要搜索的内容。

Visual Studio 中有一个免费的（有限的）叫做 Dotfuscator。

使用花哨的方法重命名您的代码并更改流路以使其模糊。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T13:32:13.963

考虑使用[混淆](http://en.wikipedia.org/wiki/Obfuscator)器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T13:47:47.940

如果您正在开发桌面应用程序，将您的代码转换为 Dll 不会隐藏它（有许多工具可以反编译 dll 或 exe 文件）。

但是如果您使用的是 Asp.Net，那么您可以将您的网站编译为 Dll，并且代码在 aspx 页面中将不可见，它将被编译为 Dll，您可以在解决方案资源管理器中右键单击您的项目，然后选择发布网站

但在所有情况下，.Net Exe 文件和 DLL 都很容易反编译并再次提取源代码，除非您使用工具来混淆您的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T13:33:53.880

如果您的意思是，最终用户可以通过反编译来查看您的源代码，那么您可以使用混淆器来保护自己。

Visual Studio 中有内置的标准混淆器。在菜单中选择*工具/Dotfuscator 社区版。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T15:14:40.073

我认为[我](https://stackoverflow.com/questions/272342/free-javascript-obfuscators/272356#272356)对有关 JavaScript 混淆的类似问题的回答也适用于此处：简而言之，为什么要打扰？您的问题已在此处得到解答（“使用混淆器”），但我认为找出您的动机并没有什么坏处。一般来说，你给别人的代码是“在敌人手中”——如果有人想使用它/弄清楚它是如何工作得不够糟糕的，他们会的。

# objective-c - 带有 cocos2d 的 UITableView

> ID：515885
> 
> 赞同：4
> 
> 时间：2009-02-05T13:28:51.787
> 
> 标签：objective-c, uitableview, cocos2d-iphone

我是Objective-C领域的学习者。我正在尝试用 cocos2d 构建一个 iPhone 应用程序。现在我想使用 UITableView 来显示 XML 文件中的数据。

是否可以将 UITableView 与 cocos2d 一起使用，是否也可以从 XML 文件中检索数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-09T02:02:07.537

您可以通过使用某人制作并发布在[cocos2d 论坛](http://www.cocos2d-iphone.org/forum/topic/6889)上的类来非常轻松地`UIViews`与 cocos2d 场景集成。我已经使用过它，使用论坛上的所有内容非常简单。`CCUIViewWrapper`

对于 XML 解析，最好使用 iOS 提供的解析器，因为 Jonathan 说 cocos2d 是一个游戏引擎，它不提供任何解析 XML 文件的机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T17:22:46.120

绝对地！XML 文件甚至不必在您的应用程序中是本地的。

我建议使用[TouchXML](http://code.google.com/p/touchcode/wiki/TouchXML)之类的东西来解析 XML 。唯一内置的 iPhone XML 解析库是一个基于事件的解析库，除非您的数据具有正确的结构，否则很难使用。

然后在用数据填充表格的表格视图方法中，从您从数据文件中解析出来的变量中选择项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T03:05:45.080

还有可能使用 cocos2d 扩展。这些几乎是一些`UIKit`用 cocos2d 重写的类。

这是我找到的带有滚动和表格视图的[链接。](https://github.com/porumbes/Cocos2D-Extensions)`UIScrollView`关于如何使用它没有太多解释，但它与and并没有太大区别`UITableView`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-24T03:11:49.187

是的，Squeegy 是对的。不过，我确实想纠正您似乎存在的概念性误解。您编写的任何 iPhone 应用程序都将始终基于核心 iPhone API。因此，您使用 Cocos2d 与您使用 UITableView 无关。至于XML解析，当然不是Cocos2d做的。Cocos2d 是 OpenGL 的高级抽象，用于相对容易的游戏开发；XML 解析不在其权限范围内。因此，同样，您对 Cocos2d 的使用与您对 XML 解析库的使用无关。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-10T22:02:38.607

可以在 Cocos2D 应用程序旁边使用 UITableView 对象、UINavigationViewControllers 等。

只需在其中创建一个 UIViewController`applicationDidFinishLaunching`并将其视图添加到窗口中。

抓住 EAGLView* Cocos2D 使用，并在此 OpenGL 视图和您的视图控制器之间切换（使用它的表格视图、按钮和您拥有的东西）。

如果你想同时显示一个表格和你的 Cocos2d 内容，最好使用它们提供的 UI 元素。

# c# - 在 C# 中，是否有开箱即用的方式来构建 3 路查找表？

> ID：515887
> 
> 赞同：3
> 
> 时间：2009-02-05T13:29:33.827
> 
> 标签：c#, lookup

我有一个内存中的“表”，可能看起来像这样：

```
Favorite#  Name        Profession
---------  ----------  ------------------
3          Names.Adam  Profession.Baker
9          Names.Bob   Profession.Teacher
7          Names.Carl  Profession.Coder
7          Names.Dave  Profession.Miner
5          Names.Fred  Profession.Teacher 
```

而我想要做的是使用 3 个字段中的任何一个进行快速有效的查找。换句话说，我想要：

*   `myTable[3]`并且`myTable[Names.Adam]`全部`myTable[Professions.Baker]`返回`{3,Names.Adam,Profession.Baker}`
*   `myTable[Profession.Teacher]`同时返回`{9,Names.Bob,Profession.Teacher}`和`{5,Names.Fred,Profession.Teacher}`。

该表是在运行时根据用户的操作构建的，并且不能存储在数据库中，因为它用于无法保证数据库连接性的部分。

现在，我“简单地”（哈哈！）使用 3 个 uber-Dictionaries 存储它，每个使用列（FavoriteNumber，Name，Profession）之一键控，并且 uber-Dictionaries 中的每个值都包含 2 个本身键控的字典剩余的每一列（因此“名称”超级词典中的值属于类型`Dictionary<FavoriteNumber,Profession[]>`和`Dictionary<Profession, FavoriteNumber[]>`

这需要在 2 个字典中进行 2 次查找，以及另一个数组遍历（通常包含 1 或 2 个元素。）

谁能建议一个更好的方法来做到这一点？我不介意花费额外的内存，因为该表可能很小（不超过 20 个条目），但我愿意牺牲一点 CPU 以使其更易于维护代码......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-05T13:38:46.290

但是不是真的使用字典，但是如果您创建这样的类的集合

```
class Person {
    public int FavoriteNumber;
    public string Name;
    public string Profession;
} 
```

您可以使用 LINQ 搜索集合。

```
IList<Person> people = /* my collection */;
var selectedPeople = people.Where(p => p.FavoriteNumber = 3);
var selectedPeople2 = people.Where(p => p.Name == "Bob");
var selectedPeople3 = people.Where(p => p.Profession = "Teacher"); 
```

或者如果您更喜欢普通的 LINQ 语法

```
var selectedPeople4 = from p in people
                      where p.Name == "Bob"
                      select p; 
```

这些`selectedPeople`变量中的每一个都将被键入`IEnumerable<Person>`，您可以使用循环来搜索它们。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-05T13:46:58.487

对于 20 行，只需使用[线性扫描](https://stackoverflow.com/questions/515887/in-c-is-there-out-of-the-box-way-to-build-a-3-way-lookup-table/515921#515921)- 它在各个方面都是最有效的。

对于较大的套装；hzere 是一种使用 LINQ`ToLookup`和延迟索引的方法：

```
public enum Profession {
    Baker, Teacher, Coder, Miner
}
public class Record {
    public int FavoriteNumber {get;set;}
    public string Name {get;set;}
    public Profession Profession {get;set;}
}
class Table : Collection<Record>
{
    protected void Rebuild()
    {
        indexName = null;
        indexNumber = null;
        indexProfession = null;
    }
    protected override void ClearItems()
    {
        base.ClearItems();
        Rebuild();
    }
    protected override void InsertItem(int index, Record item)
    {
        base.InsertItem(index, item);
        Rebuild();
    }
    protected override void RemoveItem(int index)
    {
        base.RemoveItem(index);
        Rebuild();
    }
    protected override void SetItem(int index, Record item)
    {
        base.SetItem(index, item);
        Rebuild();
    }
    ILookup<int, Record> indexNumber;
    ILookup<string, Record> indexName;
    ILookup<Profession, Record> indexProfession;
    protected ILookup<int, Record> IndexNumber {
        get {
            if (indexNumber == null) indexNumber = this.ToLookup(x=>x.FavoriteNumber);
            return indexNumber;
        }
    }
    protected ILookup<string, Record> IndexName {
        get {
            if (indexName == null) indexName = this.ToLookup(x=>x.Name);
            return indexName;
        }
    }
    protected ILookup<Profession, Record> IndexProfession {
        get {
            if (indexProfession == null) indexProfession = this.ToLookup(x=>x.Profession);
            return indexProfession;
        }
    }
    public IEnumerable<Record> Find(int favoriteNumber) { return IndexNumber[favoriteNumber]; }
    public IEnumerable<Record> Find(string name) { return IndexName[name]; }
    public IEnumerable<Record> Find(Profession profession) { return IndexProfession[profession]; }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-05T13:40:36.193

我认为这样做的方法是编写自己的对象

```
public ICollection<Record> this[int] { get; }
public ICollection<Record> this[Profession] { get; }
public ICollection<Record> this[Names] { get; } 
```

其中记录是一个包含您的元素的类。

在内部，您保留一个 List 并且每个索引器都会执行 List.FindAll() 来获取您需要的内容。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-05T13:44:04.000

没有开箱即用的东西（可能是 DataTable 除外）。然而，它可以通过一种更简单的方式来完成，你所拥有的：

创建一个类来保存数据：

```
class PersonData {
   public int FavoriteNumber;
   public string Name;
   public string Profession;
} 
```

然后保留 3 个指向相同参考的字典：

```
PersonData personData = new PersonData();
Dictionary<int, PersonData> ...;
Dictionary<string, PersonData> ...;
Dictionary<string, PersonData> ...; 
```

我建议将所有这些封装到一个隐藏实现细节的外观类中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T13:40:49.873

您可以使用[sqlite](http://sqlite.phxsoftware.com/)数据库作为支持吗？使用 sqlite，您甚至可以选择构建内存数据库。

# php - 准备好的语句导致while循环错误

> ID：515893
> 
> 赞同：0
> 
> 时间：2009-02-05T13:31:18.927
> 
> 标签：php, mysql, ajax, mysqli

我有以下简单的 mysqli php 应用程序，它应该可以正常工作。$pk 被完美地接受并且是一个有效的 ARTICLE_NO，并且当直接由 mysql 执行时，查询可以完美地工作。我在每个事件之后都放置了输出语句，除了测试时执行之外的所有语句。永远不会进入 while 循环，我不确定为什么。

编辑：我已将问题缩小到返回 0 行的事实，但我不知道为什么 phpmyadmin 中的相同查询会给出正确的结果。

编辑2：如果我摆脱了while循环并且只有

```
 if (!$getRecords->fetch()) {
    printf("<p>ErrorNumber: %d\n", $getRecords->errno);
} 
```

说明 errno 为 0。因此没有获取记录，也没有错误，但它是一个有效的查询。

```
<?php
ini_set('display_errors', '1');
error_reporting(E_ALL);
$pk = $_GET["pk"];
$con = mysqli_connect("localhost", "", "", "");
if (!$con) {
    echo "Can't connect to MySQL Server. Errorcode: %s\n". mysqli_connect_error();
    exit;
}
$con->set_charset("utf8");
echo "test outside loop";
if(1 < 2) {
    echo "test inside loop";
    $query1 = 'SELECT ARTICLE_NO FROM AUCTIONS WHERE ARTICLE_NO = ?';
    if ($getRecords = $con->prepare($query1)) {
echo "inside second loop";
        $getRecords->bind_param("i", $pk);
echo "test after bind param";
        $getRecords->execute();
echo "test after bind execute";
        $getRecords->bind_result($ARTICLE_NO);
echo "test after bind result";
        while ($getRecords->fetch()) {
            echo "test inside while";
            echo "<h1>".$ARTICLE_NO."</h1>";
        }
    }
} 
```

编辑：

我试过这段代码：

```
<?php
$mysqli = new mysqli("localhost", "", "", "");
$pk = $_GET["pk"];
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}
/* prepare statement */
if ($stmt = $mysqli->prepare("SELECT ARTICLE_NAME, WATCH FROM AUCTIONS WHERE ARTICLE_NO = ? LIMIT 5")) {
    $stmt->bind_param("i", $pk);
    $stmt->execute();
    /* bind variables to prepared statement */
    $stmt->bind_result($col1, $col2);
    /* fetch values */
    while ($stmt->fetch()) {
        printf("%s %s\n", $col1, $col2);
    }
    /* close statement */
    $stmt->close();
}
/* close connection */
$mysqli->close();
?> 
```

这在没有 $pk 的情况下工作，如果我去掉参数它工作正常。通过 GET 获取 pk 不是问题，因为如果我指定 $pk = 1; 相反，它仍然失败。1 是有效的 ARTICLE_NO，SELECT ARTICLE_NAME, WATCH FROM AUCTIONS WHERE ARTICLE_NO = 1 LIMIT 5 在 phmyadmin 中工作正常。

编辑：问题是 mysqli 无法处理 bigint，我现在使用 k 作为字符串，它工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T13:57:26.377

检查以下值：

```
$getRecords->num_rows 
```

这应该有助于揭示早期`SELECT`是否实际返回任何数据

您可能还需要添加：

```
$getRecords->store_result() 
```

在询问结果集中的行数之前，首先确保您已经完成了整个查询。

另外-确保您`$pk`转换为整数！传入的值可能会被破坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T13:42:52.130

我不确定您是否修改了该代码，但您似乎没有选择要连接到那里的数据库。

如果这是问题，请使用 mysqli_select_db(...) 。

编辑：看起来你也在使用大写的列、表名等。

正确区分大小写，可能是您假设不区分大小写，因为它可以从命令行工作。据我所知，PHP 中的 mysqlI 驱动程序至少对列名区分大小写。

# iphone - 您将全局应用程序数据放在 iPhone 应用程序中的什么位置？

> ID：515917
> 
> 赞同：6
> 
> 时间：2009-02-05T13:38:26.617
> 
> 标签：iphone

我有一个应用程序，允许用户查看、操作和管理 Schedule 对象的集合。应用程序的不同部分需要访问这些数据。我已经尝试过让这个集合成为一个单例，但我发现它不是很干净。

我最近更改为将全局数据存储在 AppDelegate 类中并使用：

```
MyAppDelegate *delegate = [[UIApplication sharedApplication] delegate];
[delegate.myGlobalData doSomething]; 
```

这消除了我的全局数据成为单例的需要，但实际上只是利用了 UIApplication 单例。

在我的案例中，确实不只有一个主视图控制器可以存储它。所以我想知道人们使用什么不同的策略来解决这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T18:20:57.547

如果您有一个需要多个控制器访问的中央数据模型，那么使用单例来管理数据并没有错——“sharedManager”正是场景所需要的。这基本上就是 Apple 使用他们的地址簿 API 来操作联系人所做的事情。他们使用 C 风格的 API，但它涉及获取对共享地址簿数据库的引用，然后在以后的调用中使用它。

使用应用程序委托也可以，但正如您所注意到的，这实际上是一回事。您将应用程序委托单例指定为数据模型的所有者，这也可以。

NSUserDefaults 可以以这种方式被滥用，但这并不是它的目的。除了有点难看之外，它还限制了您可以存储的数据类型。你自己的模型可以存储你喜欢的任何数据，但是 NSUserDefaults 不是那么灵活。

使用 SQLite 或属性列表或其他任何东西将数据存储到文件实际上与如何管理它的问题是正交的。根据您的描述，单例方法听起来很合理，并且单例可以以对您正在使用的数据有意义的任何方式写入文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T14:02:37.037

许多人将所有内容存储在 AppDelegate 中，并通过 [[UIApplication sharedApplication] delegate] 访问数据。

如果数据应该被持久化，你也可以使用 NSUserDefaults 单例。

如果数据很大，也许你需要 SQLite。

正如您所要求的，这是针对“全局”数据的。

如果您的视图控制器以树的形式组织，则更好的方法是将所需数据从父 UIViewController 传递到子 UIViewController。

# c# - 带有 C# 插件的系统

> ID：515925
> 
> 赞同：9
> 
> 时间：2009-02-05T13:42:26.687
> 
> 标签：c#, plugins

我必须开发一个系统来监控传感器信息，但将来可能会添加许多传感器。

也就是说，这个想法是开发一个由应用程序框架组成的系统。传感器（因为每个传感器都有其通信和数据呈现特性）将作为插件添加到系统中。

我将如何在 C# 上编写代码？是组件驱动开发的案例吗？我应该使用动态库吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-05T13:55:20.717

有大量用于 C# 的 ad-hoc 插件系统。一种在*[使用 C# 的插件架构中进行](http://www.codeproject.com/KB/cs/c__plugin_architecture.aspx)*了描述（在[代码项目](http://en.wikipedia.org/wiki/The_Code_Project)中）。一般的方法是宿主应用程序发布带有接口的程序集。它枚举文件夹并找到定义了实现其接口的类的程序集并加载它们并实例化这些类。

在实践中，你想做更多。最好主机应用程序定义两个接口，一个 IHost 和一个 IPlugIn。IHost 接口提供插件可以订阅的服务。IPlugIn 采用 IHost 构建。

要加载插件，您应该做的不仅仅是获取插件。您应该枚举所有可加载的插件。分别构建它们。问他们能不能跑。要求他们将 API 导出到主机中。要求他们从主机导入 API。插件应该可以询问其他插件的存在。

这样，插件可以通过提供更多 API 来扩展应用程序。

插件应该包括事件。这样插件就可以监控插件加载和卸载的过程。

在世界末日，您应该警告插件它们将要消失。然后把它们拿出来。

这将为您留下一个应用程序，该应用程序可以在一个微小的框架中编写，如果您愿意，可以完全在插件中实现。

作为额外的奖励，您还应该在插件文件夹中解析插件的快捷方式。这使您可以编写应用程序并将其交付给其他人。他们可以在他们的开发环境中编写插件，在应用程序的插件文件夹中创建一个快捷方式，而不必担心每次编译后的部署。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-05T13:48:03.087

[托管可扩展性框架](http://en.wikipedia.org/wiki/Managed_Extensibility_Framework)(MEF) 正是您所需要的。您也可以使用[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)容器，但这有点出乎您的意料，尽管它本身就是一个完全可行的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T13:54:37.537

每个传感器都应该实现一个标准接口，以便处理传感器列表的例程可以以标准方式处理它们。在界面中包含一个 ID 字段，该字段对于每种类型的传感器也是唯一的，以便您可以处理特殊情况。

查看反射 API 以了解如何扫描 .NET 程序集的目录并查看它们的内部。

每个组件都应该有一个工厂类，它的工作是返回该组件中的传感器列表。我建议您将其设为子例程而不是函数，并将其传递给它也附加的列表。SensorDLL1 将 4 个传感器附加到空列表中，SensorDLL2 将 8 个传感器附加到现在有 12 个传感器的列表中，依此类推。从长远来看，这种方法是最灵活的。

您要么必须制定命名约定来查找工厂类，要么使用属性。请注意，我不建议只扫描组件以查找实现传感器接口的所有内容，因为您可以在工厂内拥有控制哪些传感器可用的代码。这对于许可很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T13:59:23.627

根据传感器本身，这听起来像是您需要定义一个所有传感器都将实现的接口。然后，您的主要“应用程序框架”将针对 ISensor 接口工作，无需关注每个传感器类/对象/组件的具体实现。

每个传感器是否只是同一个项目中的一个类，还是一个单独的程序集取决于您，尽管如果它们是单独的程序集，您需要一种动态加载这些程序集的方法。

一些可能对这里有所帮助的参考资料是：

命令模式设计模式：- [http://en.wikipedia.org/wiki/Command_pattern](http://en.wikipedia.org/wiki/Command_pattern)

观察者模式设计模式：- [http://en.wikipedia.org/wiki/Observer_pattern](http://en.wikipedia.org/wiki/Observer_pattern)

动态加载程序集：- [http://www.divil.co.uk/net/articles/plugins/plugins.asp](http://www.divil.co.uk/net/articles/plugins/plugins.asp)

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T14:17:40.843

我们曾在 2006 年的一个学校项目 Socio 中制作了一个插件系统。您可以在[此处](http://socio.svn.sourceforge.net/viewvc/socio/pluginmanager/)和[此处](http://socio.svn.sourceforge.net/viewvc/socio/plugin/)找到代码。

学到的基本经验是在 C# 中动态加载代码*非常简单。*如果您只有一个插件 DLL 和一个应用程序，它遵循您的接口并链接到存在该接口的通用 DLL，它就可以工作™。

本质上，这就是[plinth 在他的回答中所描述的](https://stackoverflow.com/questions/515925/system-with-plugins-in-c/515972#515972)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T16:49:47.840

看一眼：

[复合 UI 应用程序块](http://msdn.microsoft.com/en-us/library/aa480450.aspx) 和[智能客户端软件工厂](http://msdn.microsoft.com/en-us/library/aa480482.aspx)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-11-06T00:07:21.450

这是一个非常古老的帖子，但我仍然认为它对 appPress.in 的人很有用，我们已经开发了一个具有插件功能的框架。在这里，我们允许插件水平和垂直修改核心应用程序的 UI，添加自己的页面，挂钩 Init、OnClick 和 OnChange 等事件。

# database - 为什么应用程序开发人员可以做数据库的事情，而数据库开发人员却试图远离应用程序的事情？

> ID：515932
> 
> 赞同：4
> 
> 时间：2009-02-05T13:45:39.363
> 
> 标签：database, database-design, oop

以我的经验，这一直是“后端”（数据库开发人员）和“前端”人员（应用程序开发人员、客户端和服务器端）之间有争议的问题。

关于这个主题已经有很多*激烈*的酒吧讨论。

我只是想知道是人们有不同的心态，还是懒得学习更多，对他们所知道的东西感到舒服，或者其他什么。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-05T13:52:17.853

我可能会重新表述这个问题：为什么（一些）应用程序开发人员**认为**他们可以做“数据库的东西”而无需真正去正确理解它？而数据库开发人员（通常）不认为他们可以在没有一些培训和经验的情况下编写一个好的应用程序！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-05T13:50:30.557

它是关于抽象层次的。数据库是典型业务应用程序（软件方面）中最低级别的抽象。从事抽象外层工作的开发人员更可能了解内层，而不是内层开发人员了解外层。

这是因为当内部抽象层不知道依赖它们的外部层时，它们的性能最好。

因此，网站表示层的设计人员可能对他们所依赖的服务器端代码有所了解，因为他们与之交互。但是在服务器上工作的开发人员根本不需要了解任何有关设计的知识。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-05T13:53:46.057

我会说这是在需要知道的基础上。应用程序开发人员通常需要知道如何连接到数据库、添加记录、删除记录等......这在 LINQ 等新技术中得到了进一步发展，开发人员可以在他们的实际代码中编写数据库查询。

另一方面，数据库开发人员只需要知道如何编写数据库查询，因为这是他们的工作，并且可能不需要担心应用程序级别的代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-05T13:48:54.473

因为程序员经常必须了解数据库并与数据库交互才能完成他们的工作，但 DBA 通常不需要进行任何编程（在 DBMS 之外）来完成他们的工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T13:48:17.020

我相信这源于用sql编程看起来很容易，并且要开始你必须有少量的知识（对于程序员来说真的`SELECT * FROM Table`很容易学习）。应用程序编程的方式不同。它在很短的时间内变得非常复杂，这让很多人望而却步。现在我并不是说数据库人员没有那么聪明，只是他们所做的事情看起来比构建应用程序更容易。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-05T13:49:09.903

如果您开发应用程序，那么迟早您必须将应用程序连接到后端。

反之则不然。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-05T13:50:57.200

我认为它源于必要性。如果你考虑每个人的角色，程序员需要做的数据库相关的东西远远超过数据库工作者需要做的编程任务。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-05T13:55:21.373

根据我的经验，开发了“数据库”和“应用程序”（按照您的命名法......），我想状态管理有很大的不同。

设计合理的数据库始终处于“干净”状态，并且每个事务都保持这种一致性。因此，在开发数据库时，您必须非常清楚地将数据抽象指定到表中以及哪些更新是合法的等等。

我发现大多数应用程序开发人员（包括我自己 :)）在保持应用程序中的这种一致状态方面做得非常草率。任何非平凡的接口都比普通的数据库要管理更多的可能状态，而且要确保它始终处于干净状态并不容易。分析用户将执行的每一个可能的步骤序列也更加困难。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-05T13:57:15.207

根据我的经验，应用程序开发人员不会做*所有*的数据库工作。考虑与数据库、备份、复制等相关的所有管理。

一个典型的 DBA（至少在我参与过的大多数项目中）会关心与项目数据库相关的一切——所有的管理，与应用程序开发人员合作进行性能调整，就应用程序使用的 SQL 提供建议，确实一些存储过程编码，创建（或至少审查和咨询）物理数据库设计等。

那么，仅仅从应用程序开发人员的角度来看，数据库人员难道不是“懒惰”或“对他们已经知道的东西很好”吗？我自己是一名应用程序开发人员，关于我们在项目中使用的数据库，我有很多事情我不知道。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-05T14:02:19.923

我的部分教育确保我对数据库的工作方式有一个很好的理解。我进入这个领域，期望做数据库工作，而且很多。我是一个网络应用程序的人；我猜它带有领土。

作为一名开发人员，我的两份工作是在两家最好被描述为小型（包括我自己，然后只有我）和小型（3 名开发人员，短暂地有第四名）的商店。我没有观察到直接的业务需求，也没有在任何有资源雇用专门的数据库人员的地方工作。我可以设想一些情况会改变（包括新工作：P）。

至于其余的，我同意抽象也是一个因素，作为开发人员，我们在顶部/外部寻找。我无法想象没有数据库技能的 Web 应用程序开发，我认为 Sql/DB 管理是既是重要的工具，也是我需要保持敏锐的领域。

我要补充一点，我将数据库端视为自己的字段。两者之间有相互转化的技能，但是我需要获得很多专业知识才能变得更好，而且成为一名优秀的程序员并不一定意味着我在后端也做得很好（幸运的是，我不是一个好的程序员；））。另外，我很确定她是这么说的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-05T14:10:22.700

2个原因：

*   数据库供应商助长了糟糕的 SQL，并且
*   SQL 在视图中隐藏，而应用程序 UI 位于前面和中心。

大多数天真的开发人员认为 SQL 是一种过程语言并这样编写它是因为供应商确保这些工具存在以便他们可以这样做。DBA 知道好的 SQL 是面向集合的，并且具有与应用程序编程中涉及的完全不同的优化原则。

可见性方面使得应用程序开发人员可以针对数据库编写糟糕的 SQL 并让它以边缘方式执行，而且没有人知道它有多糟糕。当 DBA 编写应用程序时，会立即对其外观和行为提出批评，因为最终用户可以直接看到它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-05T14:19:28.033

好问题。实际上，为什么开发人员会做 Database Stuff，因为没有专门的数据库人员，那么开发人员就必须这样做。但是一家公司有数据库人员也有开发人员。

：） 你有什么想法 ？

# c# - C#序列化扩展方法的问题

> ID：515940
> 
> 赞同：0
> 
> 时间：2009-02-05T13:47:50.920
> 
> 标签：c#, serialization, extension-methods

我真的很喜欢 TWith2Sugars 在[这里](https://stackoverflow.com/questions/271398/post-your-extension-goodies-for-c-net-codeplexcomextensionoverflow#271423)发布的扩展方法。我遇到了一个奇怪的问题。当我将它放入共享类库并调用序列化函数时，出现以下错误：

> MyType 类型不是预期的。使用 XmlInclude 或 SoapInclude 属性指定静态未知的类型。

我环顾了一下，发现 XmlSerializer 只能序列化它知道的类型。我将其解释为类库中的类，而不是我基于该库构建的项目。

有没有解决的办法？这个函数可以放在类库中还是需要在每个使用它的项目中？

**更新：**

我弄清楚是什么导致了这个问题。我有以下代码：

```
object o = new MyClass();
o.Serialize(); 
```

这是导致错误的原因。当我将代码更改为：

```
MyClass c = new MyClass();
c.Serialize(); 
```

一切运行良好。所以，吸取教训 - 不要尝试（反）序列化通用对象。我最喜欢我引用的链接的一点是我不必在我的类上放置任何 XML 属性标签。扩展方法刚刚奏效。

出于结束问题的目的，我将通过说明 [XmlInclude] 使用的代码示例将答案授予扩展[Marc 的答案（包括 Marc）的任何人。](https://stackoverflow.com/questions/515940/problem-with-c-serialization-extension-methods/515986#515986)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T13:51:27.123

你的理解是错误的。此错误的含义基本上如下：除非您明确告诉它在所述层次结构中有哪些类，否则 XML 序列化程序无法对类层次结构进行操作。只需将`XmlInclude`每个派生类的类型的属性添加到您的基类即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T13:57:43.973

您可以在此源中通过添加对第二个程序集的引用并使用来执行此操作`[XmlInclude]`- 但这可能会很快让您陷入混乱的项目中。您还可以在运行时将这些选项指定到序列化程序的构造函数中：

```
using System;
using System.Xml.Serialization;
[Serializable] public class Foo { }
[Serializable] public class Bar : Foo {}

static class Program {
    static void Main()
    {
        XmlSerializer ser = new XmlSerializer(typeof(Foo),
            new Type[] { typeof(Bar) });
        ser.Serialize(Console.Out, new Bar());
    }
} 
```

重新扩展方法；您可以添加一个`params Type[] extraTypes`, 并传入`extraTypes`-`XmlSerializer`然后您可以像现在一样使用它，也可以像`.Serialize(typeof(Bar))`.

# emacs - 新版本中的 Emacs 导航就像记事本一样

> ID：515946
> 
> 赞同：8
> 
> 时间：2009-02-05T13:49:09.467
> 
> 标签：emacs, dot-emacs, emacs23

这有点难以解释，所以请多多包涵。

我正在运行 emacs 23.0.60.2（来自 CVS）以获得 truetype 支持。（以防有人想知道我为什么要走在最前沿）。我在使用此版本的文档中导航时遇到了一些奇怪的问题，我想停止。

当一个窗口足够窄以至于一条长线换行时，过去在文本中向下导航一行会将光标移动到文件中的下一个文字行，与该行的偏移量相同。然而，现在光标移动到窗口中的下一个逻辑行——它是当前行的延续——与窗口边缘的相对偏移量相同。基本上，以前它是类似 emacs 的，现在它是类似记事本的。我不想要类似记事本的行为。

有谁知道如何关闭这个？如果您知道如何在 .emacs 中将其关闭以使我的 .emacs 也可以继续与 emacs 21-22 一起使用，则可以加分 :)

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-05T13:58:29.713

尝试将 (setq line-move-visual nil) 放入 .emacs 文件中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-05T14:47:57.833

我无法回答主要问题，但奖金问题很简单：

```
(if (>= emacs-major-version 23) 
    ... ) 
```

不幸的是，如果你想比这更具体（例如，你想要确切的版本 23.0.60.2）你将不得不 parse `emacs-version`，这可能看起来像

```
"GNU Emacs 23.0.60.1 (i486-pc-linux-gnu, GTK+ Version 2.14.3) of 2008-10-13 on rothera, modified by Debian" 
```

此外，如果您正在运行基于 Debian 的发行版，请查看`emacs-snapshot-gtk`软件包 - 边缘可能会少一些。

# xhtml - HTML 属性 accesskey 无法正常工作

> ID：515951
> 
> 赞同：5
> 
> 时间：2009-02-05T13:50:38.527
> 
> 标签：xhtml, accessibility

因此，我正在测试所有不同的 HTML 标记和属性，稍微更新一下，但由于某种原因，accesskey 似乎无法正常工作。

accesskey 属性用于将键分配给元素。根据您的操作系统，按 Alt+那个键 (Windows) 或 Cmd+那个键 (Mac) 会将焦点放在该元素上。

这里有一点：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us">
<head>
    <title>Title</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
        a:focus{
            color:red
        }
    </style>
</head>
<body>
    <a accesskey="x" target="new" href="#">Hello</a>
</body>
</html> 
```

所以我正在使用 Windows 机器。因此，当我按下 Alt+x 时，我希望锚点变红。然而事实并非如此。代码有问题，还是我期望发生错误的事情？

在 Firefox 上，什么也没有发生。谷歌浏览器打开一个新选项卡（应该，目标属性说“新”，这意味着在新选项卡/窗口中打开）并且 IE 跳转到锚点，但没有做任何进一步的事情。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-05T13:59:40.570

Firefox 的 accesskey 修饰符是 Shift+Alt。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-08T10:58:21.617

**Alt + [访问键]**

```
 Internet Explorer for Windows
    Chrome for Windows (not that Shift is required in some circumstances
    Safari for Windows 
```

**Shift + Alt + [访问键]**

```
 Firefox for Windows 
```

**Ctrl + Option + [访问键]**

```
Safari for Mac
Chrome for Mac
Firefox for Mac 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T22:39:10.717

如果您决定分配 accesskeys（并且可能有一些充分的理由来使用这个非常实施的功能），您应该查看[WebAIM 的 accesskeys 页面，](http://www.webaim.org/techniques/keyboard/accesskey.php)其中概述了您将面临的一些障碍。

一件事，在 Mac 上，大多数支持 accesskeys 的浏览器——除了 Opera——使用 Control 而不是 Command。Opera 显然使用 Shift-Esc ......谁知道呢？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T17:30:41.583

当链接在 IE 中获得焦点时，您必须按 Enter 键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T20:21:39.300

在 Firefox 中，您需要按 shift+alt。在 IE 中，点击修改键只会将焦点设置到该元素，这是设计使然。这是我的屏幕阅读器可访问的仅有的两个浏览器，因此无法为您提供有关其他浏览器的更多信息。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-08-15T09:36:07.907

如果您在 mac 上使用 firefox，则应按 ctrl + 'your access key'。

# xml - 在 xslt 2.0 中将多个元素值加入新字符串的最佳方法是什么

> ID：515967
> 
> 赞同：5
> 
> 时间：2009-02-05T13:54:19.003
> 
> 标签：xml, xslt, xslt-2.0

我需要将多个元素值加入一个用空格分隔的新字符串中，最好的方法是什么？我正在使用 xslt 2.0。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T14:04:01.247

查看[字符串连接](http://www.w3.org/TR/xpath-functions/#func-string-join)函数。

```
<xsl:value-of select="string-join(/path/to[1]/nodes/text(), ' ')" /> 
```

# java - 在 Java 中关闭流

> ID：515975
> 
> 赞同：51
> 
> 时间：2009-02-05T13:55:45.320
> 
> 标签：java, stream

为什么我们需要在离开程序之前关闭 FileInputStream（以及一般的流*）*？否则会发生什么？如果程序在程序中显式关闭输入流之前停止，那么流不也会自动关闭吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-02-05T13:58:42.130

文件句柄是稀缺的、有限的资源。如果您没有正确清理它们，您可能会用完它们，就像数据库连接一样。

如果你编写了一个只有一个用户的小程序，你可以摆脱马虎而不是在 finally 块中关闭。

但是，如果您最终在具有许多用户和文件句柄的应用程序中使用该惯用语，您可能会遇到问题。

“首先我们养成习惯，然后习惯塑造我们。” 即使没有必要，我也会尝试应用最佳实践。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-02-05T13:57:17.390

是的，当进程终止时，非托管资源将被释放。对于 InputStreams 这很好。对于 OutputStreams，您可能会丢失缓冲数据，因此您*至少应该在*退出程序之前刷新流。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-02-05T14:04:31.447

老兄。如果您不关闭流，您的单元测试将失败。或者至少，它应该。所以，这就是为什么你需要关闭它。;)

虽然如果您只是退出，操作系统几乎肯定会清理干净，但如果您明确关闭它们，它们通常会更快地释放出来。此外，如果您的代码在某个时间出现在一个长时间运行的程序中怎么办？然后他们就会有问题并诅咒你。:(

所以，这就像上完厕所后洗手一样。如果你不这样做，最终会有人付出代价。你可以暂时摆脱它，但这仍然是一个很好的做法。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-05T13:58:10.680

除了乔恩的回答之外，关闭任何资源通常是一个好主意。

想想数据库连接。您的数据库不能打开无限连接，在这种情况下，当您不需要它时，最好在完成后立即关闭它。

养成这个习惯也很好。“终于”块是你的朋友。在 C++ 的情况下，您还可以使用[RAII 自动管理它](https://stackoverflow.com/questions/395123/raii-and-smart-pointers-in-c)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-05T13:58:22.537

有点。该流由“真实”操作系统文件描述符支持，当进程终止时，操作系统将清除所有打开的文件描述符。

无论如何，完成后总是关闭资源是一个好习惯，所以关闭流:)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-02-05T13:58:51.897

如果您不关闭流，则再次打开它们可能会遇到问题。如果它们挂在插座的末端，则尤其如此。

如果还有任何数据要发送，关闭流还可以确保通过流刷新数据。

# xml - 支持 XPath 2.0 的 Java XSLT 处理器

> ID：515979
> 
> 赞同：25
> 
> 时间：2009-02-05T13:57:02.337
> 
> 标签：xml, xpath, xsd, xslt-2.0, xslt

当前可用的支持 XPath 2.0 标准的 XSLT 处理器有哪些？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-05T14:15:06.420

# XSLT 2.0 处理器

有多种[XSLT 2.0 处理器](http://en.wikipedia.org/wiki/XSLT#Processor_implementations)可用于各种语言。

## 爪哇

[为Java](http://www.oracle.com/technetwork/java/)编写，或报告有 Java 接口：

*   [迈克尔·凯](http://www.saxonica.com)的[撒克逊 9.x](http://www.sf.net/projects/saxon)
*   [IBM](http://www.ibm.com/)的[WebSphere 7 XML 功能包](http://www.infoq.com/news/2009/12/was7xmlfp)
*   [Altova](http://www.altova.com/xmlspy.html)的[AltovaXML2009.exe](http://www.altova.com/altovaxml.html)

## 。网

[为.NET 框架](http://en.wikipedia.org/wiki/.NET_Framework)编写：

*   Clinical & Biomedical Computing Ltd. 的[XQSharp 2.0](http://www.xqsharp.com/xqsharp/beta.htm)

## 埃菲尔

写在[埃菲尔](http://en.wikipedia.org/wiki/Eiffel_%28programming_language%29)：

*   [科林-保罗·亚当斯的](http://colina.demon.co.uk/?q=node/20)格式[塔](http://sourceforge.net/projects/gestalt)

## 其他

*   [英特尔](http://www.mashery.com/)的[SOA Expressway](http://software.intel.com/en-us/articles/intel-soa-expressway-xslt-20-processor/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-21T13:23:38.423

[Oracle 的 XDK](http://www.oracle.com/technology/tech/xml/xdkhome.html)声称支持 XSL 和 XPath 2.0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-17T21:53:29.200

[IBM WebSphere Application Server Feature Pack for XML](http://www-01.ibm.com/software/webservers/appserv/was/featurepacks/xml/)还包含一个基于 Java 的 XSLT 2.0 处理器。

# .net - 如何使用带有变量或动态表名的 Nhibernate，如 Jan08Tran、Feb08Tran、Mar08Tran

> ID：515985
> 
> 赞同：9
> 
> 时间：2009-02-05T13:57:39.683
> 
> 标签：.net, nhibernate

我有遗留数据库，其中交易表按月名存储。

例如。

```
 Jan08Tran
     Feb08Tran 
```

我如何使用 NHibernate 来处理这些表？

阅读一些关于实体名称属性、子类等的信息。但找不到具体的解决方案。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-23T20:23:29.627

我遇到过类似的情况，我必须在购买的应用程序之间提供一个接口，这些应用程序正在生产中并被大量不同的系统使用。这个系统在 dev、test 和 prod 中都有不同的表名（荒谬......）我的解决方案是在 NHibernate 配置中为表号保留一个占位符，如下所示：

```
<class name="MyClass" table="MyTable[tableNumber]"> 
```

然后实现 INamingStrategy 类似于：

```
public class MyCustomNamingStrategy : INamingStrategy
{
    public string ClassToTableName(string className)
    {
        return DefaultNamingStrategy.Instance.ClassToTableName(className);
    }

    public string PropertyToColumnName(string propertyName)
    {
        return DefaultNamingStrategy.Instance.PropertyToColumnName(propertyName);
    }

    public string TableName(string tableName)
    {
        tableName = tableName.Replace("[tableNumber]", LocalSettings.TableNumber);
        return DefaultNamingStrategy.Instance.TableName(tableName);
    }

    public string ColumnName(string columnName)
    {
        return DefaultNamingStrategy.Instance.ColumnName(columnName);
    }

    public string PropertyToTableName(string className, string propertyName)
    {
        return DefaultNamingStrategy.Instance.PropertyToTableName(className, propertyName);
    }

    public string LogicalColumnName(string columnName, string propertyName)
    {
        return DefaultNamingStrategy.Instance.LogicalColumnName(columnName, propertyName);
    }
} 
```

然后在配置中设置命名策略：

```
myConfiguration.SetNamingStrategy(new MyCustomNamingStrategy()); 
```

这样，表号可以存储在 App.config 中，并且应用程序可以通过仅更改 App.config 中的值来跨环境移动。我相信你可以找到一种方法来使用它来将表名更改为你需要的任何日期......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T01:05:37.950

我遇到了完全相同的问题，我的方法是在运行时更新 NHibernate 的配置值。通过这种方式，我可以决定要与我的许多同名表中的哪一个进行交谈。该技术的基础是：-

```
private static void SetTableMapping(Configuration config, 
     Type persistentClass, string newTableName)
{
    PersistentClass classMapping = config.GetClassMapping(persistentClass);
    Table physicalTable = classMapping.RootTable;
    physicalTable.Name = newTableName;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T11:57:09.003

搜索了很多，但没有任何具体的可用最终通过 NHibernate 源逐行逐行并找到以下解决方案。这并不容易，但仍有解决办法。

1.  创建一个**`SqlInterceptor`**实现的新类**`IInterceptor`**
2.  在该**`OnPrepareStatement`**方法中，您可以根据需要更改 Sql
3.  然后将此 SqlInterceptor 添加到会话中**`configuration.SetInterceptor(new SqlInterceptor());`**

以下是 SqlInterceptor 的代码

```
using System;
using System.Collections;
using NHibernate.SqlCommand;
using NHibernate.Type;

namespace NHibernate
{
    [Serializable]
    public class SqlInterceptor : IInterceptor
    {
        public virtual void OnDelete(object entity, object id, object[] state, string[] propertyNames, IType[] types)
        {
        }

        public void OnCollectionRecreate(object collection, object key)
        {
        }

        public void OnCollectionRemove(object collection, object key)
        {
        }

        public void OnCollectionUpdate(object collection, object key)
        {
        }

        public virtual bool OnFlushDirty(object entity, object id, object[] currentState, object[] previousState,
                                         string[] propertyNames, IType[] types)
        {
            return false;
        }

        public virtual bool OnLoad(object entity, object id, object[] state, string[] propertyNames, IType[] types)
        {
            return false;
        }

        public virtual bool OnSave(object entity, object id, object[] state, string[] propertyNames, IType[] types)
        {
            return false;
        }

        public virtual void PostFlush(ICollection entities)
        {
        }

        public virtual void PreFlush(ICollection entitites)
        {
        }

        public virtual bool? IsTransient(object entity)
        {
            return null;
        }

        public virtual object Instantiate(string clazz, EntityMode entityMode, object id)
        {
            return null;
        }

        public string GetEntityName(object entity)
        {
            return null;
        }

        public object GetEntity(string entityName, object id)
        {
            return null;
        }

        public virtual int[] FindDirty(object entity, object id, object[] currentState, object[] previousState,
                                       string[] propertyNames, IType[] types)
        {
            return null;
        }

        public virtual void AfterTransactionBegin(ITransaction tx)
        {
        }

        public virtual void BeforeTransactionCompletion(ITransaction tx)
        {
        }

        public virtual void AfterTransactionCompletion(ITransaction tx)
        {
        }

        public virtual void SetSession(ISession session)
        {
        }

        public SqlString OnPrepareStatement(SqlString sql)
        {
            ///Do something fancy here like  
            ///sql.Replace("_MonTranTable_", MonthName + "Tran");
            return sql;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-01T08:40:59.663

```
public class NHibernateHelper
{       
    private static ISessionFactory _sessionFactory;

    private static ISessionFactory SessionFactory
    {
        get
        {
            if (_sessionFactory == null)
            {
                Configuration configuration = new Configuration();
                configuration.Configure();

             //   configuration.AddAssembly(typeof(clsDocumentMaster).Assembly);
                configuration.SetNamingStrategy(new MyClass());
                configuration.AddFile("clsDocumentMaster.hbm.xml");
                //configuration.AddFile("Level15.hbm.xml");

                _sessionFactory = configuration.BuildSessionFactory();
            }
            return _sessionFactory;
        }
    }
    public static ISession OpenSession()
    {
        return SessionFactory.OpenSession();
    }
}

public class MyClass : INamingStrategy
{
    #region INamingStrategy Members

    public string ClassToTableName(string className)
    {
        return DefaultNamingStrategy.Instance.ClassToTableName(className);
    }

    public string ColumnName(string columnName)
    {
        return DefaultNamingStrategy.Instance.ColumnName(columnName);
    }

    public string LogicalColumnName(string columnName, string propertyName)
    {
        return DefaultNamingStrategy.Instance.LogicalColumnName(columnName, propertyName);
    }

    public string PropertyToColumnName(string propertyName)
    {
        return DefaultNamingStrategy.Instance.PropertyToColumnName(propertyName);
    }

    public string PropertyToTableName(string className, string propertyName)
    {
        return DefaultNamingStrategy.Instance.PropertyToTableName(className, propertyName);
    }

    public string TableName(string tableName)
    {
        if (tableName.IndexOf("[TagtableName]") > -1)
            tableName = tableName.Replace("[TagtableName]", "TAG1");
        else
            tableName = DefaultNamingStrategy.Instance.TableName(tableName);

        return DefaultNamingStrategy.Instance.TableName(tableName);

    }

    #endregion
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T14:05:51.273

神圣的#$%^！=)

我认为这可以通过 custom 来实现`IEntityPersister`，但这绝非易事。

我不确定，但有任何帮助的可更新视图吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T14:08:41.970

另一种选择是使用自定义 SQL 进行持久性或编写存储过程来处理不断变化的表名。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-07T12:13:26.710

这不是您问题的直接答案，但也许它毕竟是一个解决方案。

也许您可以向数据库添加一两个视图，这将使所有这些动态表看起来像一个？

# java - 为 Eclipse RCP 应用程序添加关闭挂钩的正确方法是什么？

> ID：515993
> 
> 赞同：8
> 
> 时间：2009-02-05T13:58:49.430
> 
> 标签：java, eclipse, application-shutdown

我有一个 RCP 应用程序，它使用与内存数据库的连接。有一种情况是，当关闭 Windows 时，应用程序在没有机会关闭与数据库的连接的情况下被杀死。

我进行了一些研究，似乎添加一个 Shutdown 挂钩是检测此事件并在 Java 应用程序中进行清理的最佳方法。但是，如果您有一个 RCP 应用程序，并且可能打开了多个编辑器，那么正确的处理方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-17T06:54:02.250

注意：此[博客条目](http://richclientplatform.blogspot.com/2007/09/sigue-sigue-sigterm_12.html)建议关闭挂钩的以下实现：

> 关闭代码必须在 UI 线程中运行，如果工作台正在通过其他方式关闭，则不应运行。所有脏编辑器都会自动保存。这样可以避免在计算机关机时提示可能在家睡觉的用户。最后关闭工作台。

（所以不*完全是*你的场景，但实现仍然很有趣，因为它展示了如何在 UI 线程中运行它）

```
private class ShutdownHook extends Thread {
  @Override
  public void run() {
    try {
      final IWorkbench workbench = PlatformUI.getWorkbench();
      final Display display = PlatformUI.getWorkbench()
                                        .getDisplay();
      if (workbench != null && !workbench.isClosing()) {
        display.syncExec(new Runnable() {
          public void run() {
            IWorkbenchWindow [] workbenchWindows = 
                            workbench.getWorkbenchWindows();
            for(int i = 0;i < workbenchWindows.length;i++) {
              IWorkbenchWindow workbenchWindow =
                                        workbenchWindows[i];
              if (workbenchWindow == null) {
                // SIGTERM shutdown code must access
                // workbench using UI thread!!
              } else {
                IWorkbenchPage[] pages = workbenchWindow
                                           .getPages();
                for (int j = 0; j < pages.length; j++) {
                  IEditorPart[] dirtyEditors = pages[j]
                                           .getDirtyEditors();
                  for (int k = 0; k < dirtyEditors.length; k++) {
                    dirtyEditors[k]
                             .doSave(new NullProgressMonitor());
                  }
                }
              }
            }
          }
        });
        display.syncExec(new Runnable() {
          public void run() {
            workbench.close();
          }
        });
      }
    } catch (IllegalStateException e) {
      // ignore
    }
  }
} 
```

正如您所说，它在 IApplication 中设置：

```
public class IPEApplication implements IApplication {
  public Object start(IApplicationContext context) throws Exception {
    final Display display = PlatformUI.createDisplay();
    Runtime.getRuntime().addShutdownHook(new ShutdownHook());  }
    // start workbench...
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-22T19:53:59.967

您应该覆盖扩展 WorkbenachAdvisor 的类上的 preShutdown 方法。返回 false 以停止关闭过程或返回 true 以继续。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T14:00:22.113

在实际启动 RCP 应用程序之前，我尝试了从 IApplication 实现者 start() 方法执行的以下代码：

```
Runtime.getRuntime().addShutdownHook(new Thread() {
    public void run() {
        if (PlatformUI.isWorkbenchRunning()) {
            PlatformUI.getWorkbench().close();
        }
        logger.info("Shutdown request received");
        cleanup();
    }
}); 
```

其中 cleanup() 关闭与数据库的连接。如果有任何文档打开，关闭应该要求用户保存。

# java - 面向中级 .NET 开发人员的 Java

> ID：515996
> 
> 赞同：8
> 
> 时间：2009-02-05T13:59:25.797
> 
> 标签：java, .net

我是一名 .NET 开发人员，拥有大约 5 年使用 Microsoft 技术的 Web 开发经验，从经典 ASP 到 ASP .NET 3.5。

我也有一点 Java 的背景，可以很容易地编写/理解 Java 代码。我正在寻找与我的 .NET 经验兼容的资源（在线、书籍）。我只对 Java 中的 Web 开发感兴趣，并且想从中级开始，即使它可能需要我查找一些细节。

您会为中级 .NET Web 开发人员推荐哪些途径或资源来获得同等的 Java Web 开发工具熟练度？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-05T14:04:28.750

*   获取 IDE：IntelliJ（我的偏好）、Eclipse、Netbeans；
*   获取应用服务器：Glassfish（我的偏好；v2 或 v3 Prelude）、JBoss 或者，如果您喜欢冒险，可以使用 SpringSource dm 服务器；
*   获取 JDK，例如 6u11；
*   获取 Spring 2.5.6 的副本（或 3.0M2，如果您喜欢冒险的话）；
*   获取 Spring 参考文档的副本；

把碎片放在一起。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T14:03:46.737

给自己一份 eclipse，然后开始阅读其他人的代码，并阅读一些 java 文档。Java 网站上有所有在线文档，它们是我见过的最好的语言规范之一。

真的，如果你非常了解 C#，Java 应该是小菜一碟。这些语言非常相似，因此您只需要了解不同的框架即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T04:28:28.927

关于学习 Java 的 Web 开发框架，Java Server Faces 可能是最有用的书：

[Core JSF](https://rads.stackoverflow.com/amzn/click/com/0131463055) - 关于使用 JSF 框架的整个过程的优秀示例和解释。

当然，对于 Java 新手，我会推荐：

[Effective Java](http://java.sun.com/docs/books/effective/) - 涵盖各种设计模式和实践。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T14:09:08.583

以我的经验，官方 Java 考试比 .Net 考试要好，所以从那里开始可能值得吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T14:16:45.167

搜索 servlet/JSP 教程（很好，虽然有点旧，[这里](http://www.apl.jhu.edu/~hall/java/Servlet-Tutorial/)有示例）。您将获得 Java Web 应用程序开发的基本知识。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T15:09:18.807

无论您的水平如何，[JSF for Nonbelievers](http://www.ibm.com/developerworks/library/j-jsf1/)都是对 JSP/JSF 的最佳介绍。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-05T23:02:14.297

我会看看[Bitter Java](http://www.manning.com/tate/)。

这是一本书，它向你展示了做事的错误方式、错误的原因，然后它向你展示了正确的方式。

它几乎符合 j2ee 框架的演变。从 servlet 开始，然后进入 jsps，然后是命令模式等。**********