# StackOverflow 问答 10076000-10076999

# sql - 使用 VBA 设置查询的参数

> ID：10076006
> 
> 赞同：1
> 
> 时间：2012-04-09T16:04:06.530
> 
> 标签：sql, ms-access, vba

所以我有一个查询，如下所示，它在一个参数上运行。

我想知道是否有办法使用 VBA 来设置查询参数。我目前有大约 40 个查询，除了产品 ID 之外都完全相同，因此我也有 40 个报告……如果我有一个查询，我仍然需要在 VBA 中写出 productid 的代码，但我可以使用一份报告而不是那么多。

只需一个查询和一份报告并让 VBA 设置参数，生活会轻松得多，因为用户不知道产品 ID

```
SELECT TblTotalSale.ProductID, TblProduct.Description, TblTotalSale.Size, TblTotalSale.SalePrice, TblTotalSale.Day
FROM TblProduct INNER JOIN TblTotalSale ON TblProduct.ProductID = TblTotalSale.ProductID
WHERE (((TblTotalSale.ProductID)=[])); 
```

VBA

```
Private Sub IPA_Click()

DoCmd.OpenReport "RptProduct", acViewReport, , [TblTotalSale.ProductID="5"]

End Sub 
```

我也尝试过 tblTotalSale.ProductID = "5" 我知道我正在使用 SQL，而我应该使用 VBA ......

谢谢

山姆

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T16:08:36.533

不要为报表和表单的 sql 语句包含参数。使用 DoCmd 对象的 OpenForm 或 OpenReport 方法的 Where 参数。

[DoCmd.OpenReport 方法](http://msdn.microsoft.com/en-us/library/bb238032(v=office.12).aspx)

# actionscript-3 - AS3 触发事件，对象仅在顶部

> ID：10076009
> 
> 赞同：0
> 
> 时间：2012-04-09T16:04:26.523
> 
> 标签：actionscript-3, events, movieclip

我有一堆层叠在一起的 MovieClip（大小相同），每个都有一个与之关联的 MouseEvent.CLICK 事件。我只希望顶部的一个（我将在列表中添加更多）触发，其余的什么都不做（除非顶部被删除，然后新的“顶部”获得点击事件）。

我将如何完成这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:11:53.957

有不同的方法可以尝试这个。在我看来，最好的办法是按顺序跟踪其中的按钮，例如使用数组。停用阵列中除第一个之外的所有按钮，并且在任何时候移除一个按钮时，将其从阵列中移除，然后激活仍在阵列中的第一个按钮。

# extjs - Ext.container.Viewport 中的可拖动 Extjs Ext.grid.Panel

> ID：10076010
> 
> 赞同：0
> 
> 时间：2012-04-09T16:04:29.307
> 
> 标签：extjs, extjs4, extjs4.1

我正在尝试在视口内创建一个可拖动的网格，其中网格 dd 仅被限制在视口容器内。（最终网格将位于选项卡面板内，但如果我可以让这个更简单的示例工作并理解我可以从那里获取它。）我可以将以下网格面板放入一个窗口中，从框，然后将此窗口添加到视口，但 Extjs4 布局文档似乎对此提出警告：

*"**过度嵌套是一个常见问题。**一个过度嵌套的例子发生在通过将 GridPanel 添加到 TabPanel 时，通过将 GridPanel 包裹在包裹面板（没有指定布局）中，然后将该包裹面板添加到 TabPanel。要实现的要点是GridPanel 是一个可以直接添加到容器中的组件。”*

-- 注意：数据和示例代码大量来自 sencha 文档 --

```
 Ext.create('Ext.data.Store', {
      storeId:'simpsonsStore',
      fields:['name', 'email', 'phone'],
      data:{'items':[
          { 'name': 'Lisa',  "email":"lisa@simpsons.com",  "phone":"555-111-1224"  },
          { 'name': 'Bart',  "email":"bart@simpsons.com",  "phone":"555-222-1234" },
          { 'name': 'Homer', "email":"home@simpsons.com",  "phone":"555-222-1244"  },
          { 'name': 'Marge', "email":"marge@simpsons.com", "phone":"555-222-1254"  }
      ]},
      proxy: {
          type: 'memory',
          reader: {
              type: 'json',
              root: 'items'
          }
      }
  });

  Ext.create('Ext.container.Viewport', {
    items: [
      { xtype: 'gridpanel',
        title: 'Simpsons',
        closable: true,
        collapsible: true,
        animCollapse: true,
        draggable: true,
        resizable: true,
        constrain: true,
        maximizable: true,
        headerPosition: 'top',
        store: Ext.data.StoreManager.lookup('simpsonsStore'),
        columns: [
            { header: 'Name',  dataIndex: 'name' },
            { header: 'Email', dataIndex: 'email', flex: 1 },
            { header: 'Phone', dataIndex: 'phone' }
        ],
        viewConfig: {
          plugins: {
            ptype: 'gridviewdragdrop',
            dragText: 'Drag and drop to reorganize'
            }
        },
        height: 200,
        width: 400
      }
    ]
  }); 
```

此代码生成一个可拖动（可单击和可拖动）的网格，但在放下（未单击）时会弹回原始位置。

从代码到工作以及最佳实践（如果我正在阅读上面引用的 Extjs 警告），最好的前进方式是什么？

看一下 Window 源代码，我可以将下面的代码添加到 DD，但这在这里似乎不合适（即我正在创建一个默认的 Grid 类来继承我的组件）：

```
initDraggable: function() {

  var me = this;
  var ddConfig;

  if (!me.header) {
    me.updateHeader(true);
  }

  if (me.header) {
    ddConfig = Ext.applyIf({
      el: me.el,
      delegate: '#' + me.header.id
    }, me.draggable);

    // Add extra configs if Window is specified to be constrained
    if (me.constrain || me.constrainHeader) {
      ddConfig.constrain = me.constrain;
      ddConfig.constrainDelegate = me.constrainHeader;
      ddConfig.constrainTo = me.constrainTo || me.container;
    }

    me.dd = Ext.create('Ext.util.ComponentDragger', this, ddConfig);
    me.relayEvents(me.dd, ['dragstart', 'drag', 'dragend']);
  }

}//initDraggable 
```

是否有一个我不知道的 mixin，或者如果没有，从上面的代码创建一个 mixin 是否合适？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T15:49:24.997

我放弃了，决定将网格面板放在 windows 对象上，然后通过选项卡面板上的激活/停用事件管理它们的可见性。这是向我建议的解决方案，除了上面的警告之外，它比我发现的任何其他方法都更容易实施。

# c++ - 计算 a*a mod n 而不溢出

> ID：10076011
> 
> 赞同：8
> 
> 时间：2012-04-09T16:04:30.460
> 
> 标签：c++, biginteger, modulo

我需要计算`a*a`mod`n`但`a`相当大，当我平方它时导致溢出。这样做`((a % n)*(a % n)) % n`不起作用，因为 (n-1) ²可能溢出。这是在 C++ 中，我正在使用`int64_t`

# 编辑：

示例值：a = 821037907258 和 n = 800000000000，如果平方会溢出。

我正在使用 DevCPP，我已经尝试过让大整数库无济于事。

# 编辑2：

不，这些数字没有规律。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-09T16:09:21.800

如果您不能使用大整数库，并且您没有本机`uint128_t`（或类似）库，则需要手动执行此操作。

一种选择是表示`a`为两个 32 位量的总和，即*a* = 2 ^(32) *b* + *c*，其中*b*包含 32 msb，*c*包含 32 lsb。平方是一组四个交叉乘法；每个结果都保证适合 64 位类型。然后，您在重新组合各个术语时执行模运算（仔细考虑重新调整所有内容所需的转变）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T17:30:18.333

我知道你不再需要这个，并且有一个替代解决方案，但我想添加一个替代方法来实现它。它提供了两种不同的技术：[双加算法](http://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication#Double-and-add)，以及处理`mod(a + b, n)`溢出检测的方法。

双加算法通常用于无法进行乘法运算或直接计算成本太高的领域（例如椭圆曲线），但我们可以在我们的情况下采用它来处理它来处理溢出。

以下代码可能比公认的解决方案慢（即使您对其进行了优化），但如果速度不是关键，您可能更喜欢它以使其清晰。

```
unsigned addmod(unsigned x, unsigned y, unsigned n)
{
    // Precondition: x<n, y<n
    // If it will overflow, use alternative calculation
    if (x + y <= x) x = x - (n - y);
    else x = (x + y) % n;
    return x;
}

unsigned sqrmod(unsigned a, unsigned n)
{
    unsigned b;
    unsigned sum = 0;

    // Make sure original number is less than n
    a = a % n;

    // Use double and add algorithm to calculate a*a mod n
    for (b = a; b != 0; b >>= 1) {
        if (b & 1) {
            sum = addmod(sum, a, n);
        }
        a = addmod(a, a, n);
    }
    return sum;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-29T06:05:05.053

这是一个乘法的双加实现`a * b % m`，没有溢出，无论 a、b 和 m 的大小如何。

（请注意，`res -= m`and`temp_b -= m`行依赖于 64 位无符号整数溢出来给出预期的结果。这应该没问题，因为无符号整数溢出在 C 和 C++ 中是明确定义的。因此[，使用*无符号*整数类型](https://stackoverflow.com/q/18195715/60075)很重要。 )

```
uint64_t mulmod(uint64_t a, uint64_t b, uint64_t m) {
    uint64_t res = 0;
    uint64_t temp_b;

    /* Only needed if b may be >= m */
    if (b >= m) {
        if (m > UINT64_MAX / 2u)
            b -= m;
        else
            b %= m;
    }

    while (a != 0) {
        if (a & 1) {
            /* Add b to res, modulo m, without overflow */
            if (b >= m - res) /* Equiv to if (res + b >= m), without overflow */
                res -= m;
            res += b;
        }
        a >>= 1;

        /* Double b, modulo m */
        temp_b = b;
        if (b >= m - b)       /* Equiv to if (2 * b >= m), without overflow */
            temp_b -= m;
        b += temp_b;
    }
    return res;
} 
```

这是[我](https://stackoverflow.com/a/18680280/60075)对另一个类似问题的[另一个答案的](https://stackoverflow.com/a/12171020/60075)修改。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-04-09T16:06:55.187

您可以自己实现乘法，每次运行时添加*n ，然后立即修改结果。*

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2012-04-09T16:25:13.657

我真的认为这`((a % n)*(a % n)) % n`应该适用于正整数。为什么你认为它不起作用？你有反例吗？如果 n 可能为负数，则`%`运算符未定义。

# isolation-level - 隔离级别可以防止重复插入吗？

> ID：10076014
> 
> 赞同：1
> 
> 时间：2012-04-09T16:04:52.030
> 
> 标签：isolation-level, duplicates

我有一张这样的桌子

```
UserPageId (Primary Key) int
UserId (user Foreign Key) int
PageId (page Foreign Key) int 
```

整个场景是为了防止用户多次添加一个页面，根据每个用户可以和几个人一起使用，我们可能有并发用户

首先我想通过隔离级别 Serializable 来解决这个问题，但它以死锁结束

我的职能是：

```
public void Add(int PageId,int UserId)
{

        using (TransactionScope scope = newTransactionScope(TransactionScopeOption.RequiresNew,
            new TransactionOptions { IsolationLevel = IsolationLevel.Serializable }))
        {
            using (entities EFmodel = new entities())
            {
                EFmodel.Connection.Open();
                EFmodel._UserId = UserId;

                if (!Pages.Exists(EFmodel, PageId))
                    Pages.Add(EFmodel, PageId);
                else
                    ERModel.AddModelError("", "you have already added this page");
                EFmodel.SaveChanges();
            }
            scope.Complete();
        }
        return ERModel;
} 
```

页面。存在：

```
public bool Exists(entities EFmodel, int PageId)
{
        int ctn = EFmodel.UserPages.Count(x => x.PageId == PageId && x.UserId == EFmodel._UserId);
        if(ctn!=0)
        return true;
        return false;
} 
```

页面。添加：

```
public static void Add(entities EFmodel,int PageId)
{
        UserPage userpage = new UserPage()
        {
            UserId = EFmodel._UserId,
            PageId = PageId,
            UserPageId = 0
        };
        EFmodel.UserPages.AddObject(userpage);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:33:19.327

没有办法在防止更新异常和避免序列化失败的同时允许共享数据的并发更新。死锁是序列化失败的一种。诀窍是通过一个层路由数据库请求，该层将以通用方式捕获序列化失败并重试受影响的事务。

# django - Django 计数对象调用

> ID：10076017
> 
> 赞同：0
> 
> 时间：2012-04-09T16:05:05.837
> 
> 标签：django

如何计算对象的调用次数。例如：我有一个图像应用程序，我想向用户展示一张图片被调用的频率。喜欢 youtube 上的 videoviews

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:34:15.710

您需要在表中存储一个计数，并在每次使用图像时递增它。

首先，如果您还没有一个字段来存储计数，请向您的模型添加一个字段：

```
class MyImageClass(models.Model):
    ...
    views = models.PositiveIntegerField(default=0) 
```

然后，您需要创建一个视图，该视图将返回图像数据并增加视图计数。

```
def my_image_view(request, id):
    instance = get_object_or_404(MyImageClass, id=id)

    filename, ext = os.path.splitext(instance.image_field.name)
    ext = ext[1:].lower() # remove period and normalize to lowercase

    instance.views += 1
    instance.save()

    response = HttpResponse(instance.image_field.read(), mimetype='image/%s' % ext)
    response['Content-Disposition'] = 'inline;filename=%s.%s' % (filename, ext)
    return response 
```

将视图挂钩到 urlpattern，然后在您的模板中调用图像：

```
<img src="{% url my_image_view_name id=my_image.id %}"> 
```

您肯定需要对此进行一些优化，并且需要考虑线程安全问题，但这足以让您顺利进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:31:01.497

没有任何内置方法允许这样做。您必须将信息存储到数据库中

# ruby-on-rails - 按字母顺序排列并按组显示

> ID：10076026
> 
> 赞同：4
> 
> 时间：2012-04-09T16:06:06.460
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在尝试按字母顺序和块显示我的数据库中的标题列表。

我想输出这封信，然后包括所有以该信开头的标题。例如：

*   一种
    *   苹果
    *   另一件事
*   乙
    *   鲍勃

我知道我可以使用 .order('title') 对结果进行排序，但我不确定编写显示代码的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T16:16:47.187

```
titles.group_by {|word| word[0].upcase } 
```

那么，如果：

```
titles = ['Apple', 'anothersomething', 'Bob'] 
```

然后：

```
grouped_titles = titles.group_by {|word| word[0].upcase }
 => {"A"=>["Apple", "anothersomething"], "B"=>["Bob"]} 
```

为了确定排序，您可以对生成的 Hash 进行排序，将其转换为数组：

```
grouped_titles = grouped_titles.sort_by{|k, v| k}
 => [["A", ["Apple", "anothersomething"]], ["B", ["Bob"]]] 
```

然后，您可以遍历生成的数组。

```
<% grouped_titles.each do |initial_letter, titles| %>
 -display stuff here-
<% end %> 
```

请注意，这是在 Ruby 中进行分组，而不是在数据库中进行分组（这将通过使用`.group`关系上的方法来完成），但如果您已经在页面中显示了所有数据，则此方法应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:55:32.223

我认为@MrTheWalrus 提出的解决方案将起作用，只要您正确地遍历列表以维持秩序，但如果您的列表变长，我会提出一个更快的替代方案。首先确保您的列表是有序的，因为您似乎已经完成了：

```
@titles = Title.order(:title) 
```

然后视图中的迭代将如下所示：

```
<% cur_letter = nil %>
<% @titles.each do |t| %>
  <% title_letter = t.name[0].capitalize.match(/[A-Z]/) ? t.name[0].capitalize : "#" %> 
  <% if title_letter != cur_letter %>
    <% cur_letter = title_letter %>
    <%= cur_letter %>
  <% end %>
  <%= t.name %>
<% end %> 
```

我承认它作为视图代码有点难看，但它允许您遍历列表一次，保持顺序，并避免`group_by`这不是一个简单的操作。

# mysql - mysql 匹配通配符

> ID：10076027
> 
> 赞同：1
> 
> 时间：2012-04-09T16:06:09.713
> 
> 标签：mysql, sql, full-text-search

我有一个搜索工具，但希望能够允许搜索任何内容，而不是简单地列出项目类别。很标准的东西。

因此，当用户不输入任何搜索词并简单地选择一个类别时，我希望我的搜索能够找到例如“cat_id = 1”的所有内容。

我正在尝试以下方法，并且尝试了几种不同的方法，但没有任何乐趣，并且如果我能提供帮助，我真的不想诉诸为不同的情况编写不同的查询。

我正在搜索的表在名为“title”的列上有一个全文索引，我正在尝试：

```
select col_name from tablename where (MATCH(title) AGAINST ('*' IN BOOLEAN MODE)) 
```

但是根本没有结果，这个通配符是否允许？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:19:10.737

使用 * 不会有帮助。查看 MySQLs 站点的用法：

*MATCH() 采用逗号分隔的列表来命名要搜索的列。AGAINST 接受一个要搜索的字符串和一个可选的修饰符，指示要执行的搜索类型。搜索字符串必须是文字字符串，而不是变量或列名。*

如果用户没有输入搜索词，你不应该忽略那个特定的 WHERE 条件吗？

# windows - 如何在 Windows 上安装 PLV8？

> ID：10076030
> 
> 赞同：4
> 
> 时间：2012-04-09T16:06:26.367
> 
> 标签：windows, postgresql

我正在尝试在我的 PostgreSQL 服务器
[http://code.google.com/p/plv8js/wiki/PLV8](http://code.google.com/p/plv8js/wiki/PLV8)上安装它， 文档看起来不错，但问题是它们适用于 linux，而我的公司只能访问 Windows Server .
有人可以告诉我如何在 Windows 上安装 PLV8 吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-11-07T23:33:45.863

Postgres Online Journal 的好心人已经为 Windows 的 PLV8 预编译了二进制文件

9.6：[http ://www.postgresonline.com/journal/archives/367-PLV8-binaries-for-PostgreSQL-9.6-windows-both-32-bit-and-64-bit.html](http://www.postgresonline.com/journal/archives/367-PLV8-binaries-for-PostgreSQL-9.6-windows-both-32-bit-and-64-bit.html)

9.5：[http ://www.postgresonline.com/journal/archives/360-PLV8-binaries-for-PostgreSQL-9.5-windows-both-32-bit-and-64-bit.html](http://www.postgresonline.com/journal/archives/360-PLV8-binaries-for-PostgreSQL-9.5-windows-both-32-bit-and-64-bit.html)

9.4：[http ://www.postgresonline.com/journal/archives/341-PLV8-binaries-for-PostgreSQL-9.4-windows-both-32-bit-and-64-bit.html](http://www.postgresonline.com/journal/archives/341-PLV8-binaries-for-PostgreSQL-9.4-windows-both-32-bit-and-64-bit.html)

9.3：[http ://www.postgresonline.com/journal/archives/305-PostgreSQL-9.3-extension-treats-for-windows-users-plV8.html](http://www.postgresonline.com/journal/archives/305-PostgreSQL-9.3-extension-treats-for-windows-users-plV8.html)

9.2：[http ://www.postgresonline.com/journal/archives/280-PLV8-1.3-windows-binaries-for-PostgreSQL-9.2.html](http://www.postgresonline.com/journal/archives/280-PLV8-1.3-windows-binaries-for-PostgreSQL-9.2.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:26:52.550

我们设法在 Windows 上构建它，现在正在测试它。一旦我们可以确定我们可以追溯我们的步骤，我们将为它提供二进制文件。

我们在 Mingw64 链下构建（并且为了编译 v8，必须使用 scons 而不是推荐的字形（或任何其他字形），并且必须更改脚本中的一些内容以使其也能正常工作。我只有 32 位windows（乍一看似乎在我的 PostgreSQL EnterpriseDb 安装上运行良好 - 加载和示例存储 proc 似乎运行良好）。接下来我将尝试 64 位 windows。

其他问题是压缩文件不起作用。你必须直接去 git one。

让您的眼睛专注于我们的网站:) 更新：如果您想尝试 [http://www.postgresonline.com/journal/archives/260-Building-on-MingW-and-deploying-on ，我们会提供说明和二进制文件-VC-compiled-PostgreSQL-Why-and-Why-not.html](http://www.postgresonline.com/journal/archives/260-Building-on-MingW-and-deploying-on-VC-compiled-PostgreSQL-Why-and-Why-not.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T22:19:10.147

如果你不习惯在 Windows 上从源代码构建 PostgreSQL 本身，然后构建这个扩展，那么我就会忘记它。这是一个仍处于早期阶段的扩展，可能会定期更改，并且没有在现实世界中测试到接近 PostgreSQL 本身水平的任何地方，甚至是大多数可选扩展。不过这很有趣，不是吗？

# javascript - naturalHeight 和 naturalWidth 属性是新的还是弃用的？

> ID：10076031
> 
> 赞同：6
> 
> 时间：2012-04-09T16:06:31.880
> 
> 标签：javascript, dom

`naturalHeight`[Mozilla网站链接](https://developer.mozilla.org/en/HTML/Element/img)中未提及对象的`naturalWidth`属性`HTMLImageElement`

虽然这两个属性在 Firefox 中都可以正常工作，但我在文档中没有看到这一点。

它是 HTML5 中已弃用的属性还是新属性？

有人可以给我一个链接，这些属性是在标准中定义的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T16:10:07.683

绝对不会被弃用。检查[`img`元素](https://www.w3.org/TR/html5/embedded-content-0.html#the-img-element)的 HTML5 规范，我们可以看到：

> IDL 属性 naturalWidth 和 naturalHeight 必须返回图像的固有宽度和高度，如果图像可用，则以 CSS 像素为单位，否则为 0。 [CSS]

# perl - Perl - 在另一个文件中搜索和替换哈希值

> ID：10076032
> 
> 赞同：0
> 
> 时间：2012-04-09T16:06:33.633
> 
> 标签：perl, hash, replace

我正在创建一个小程序来查找特定的哈希键并替换其源，但为此我需要找到整个哈希并将其替换为用户输入的值的新哈希。

我的代码示例。

```
print "Please input the smile you would like to edit: ";
$EditSmile = <STDIN>;
print "Please input the text you want to change: ";
$EditText = <STDIN>;

open (IN, "< info.pl") || die("Can not open file: $!");

while (<IN>){
    $var1 =~ s/\'$EditSmile\' => "$smileinfo{"$EditSmile"}"/\'$EditSmile\' => "$EditText"/g;
    print $var1;    
} 
```

哈希值在文件中的位置`info.pl`，该文​​件包含在程序中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:10:19.693

可能你的时间应该读

```
while ($var1 = <IN>) {
   ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:43:14.343

正如 Ether 上面建议的那样，另一种选择是“执行”您的 pl 文件并直接更改哈希值。

```
my $hash = do "info.pl";
if (exists($hash->{$EditSmile})) {
    $hash->{$EditSmile} = $EditText;
}
use Data::Dumper;
print Dumper($hash); 
```

# ruby-on-rails-3.2 - 为什么评论在页面末尾时会出现 html_safe 错误？

> ID：10076034
> 
> 赞同：0
> 
> 时间：2012-04-09T16:06:37.537
> 
> 标签：ruby-on-rails-3.2

我有两段（大）相同的代码，唯一的区别是，一段以

```
<% end %> 
```

作为最后一行，另一行以

```
<% end # finish loop_x %> 
```

第二个产生了错误：

```
ActionView::Template::Error (undefined method `html_safe' for nil:NilClass):
    13:       <% flash.each do |key, value| %>
    14:         <div class="alert alert-<%= key %>"><%= value %></div>
    15:       <% end %>
    16:       <%= yield %>
    17:       <%= render 'layouts/footer' %>
    18:       <%= debug(params) if Rails.env.development? %>
    19:     </div>
  app/views/layouts/application.html.erb:16:in '.. 
```

但奇怪的是，这个错误只有在 <% end # %> 是页面的最后一行时才会发生。如果我将评论放在页面中途的 end 语句中，则没有错误。并以 <% end %> 结尾可以正常工作。

我正在使用 rails 3.2.3，但这也发生在 3.2.2

# git - 索引文件小于预期

> ID：10076036
> 
> 赞同：92
> 
> 时间：2012-04-09T16:06:42.053
> 
> 标签：git

今天早上，我开始从 git 收到这个错误：

> 致命：索引文件小于预期
> 
> 致命：git status --porcelain 失败

知道发生了什么以及如何解决它吗？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-04-09T20:57:43.297

索引文件已损坏，但很容易重新创建。只需删除它...

```
rm .git/index 
```

然后您可以重新添加您尝试暂存的文件。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2013-01-30T00:28:39.413

If you want to keep local changes, use the following:

```
$ rm .git/index
$ git reset HEAD .

> Unstaged changes after reset:
  modified foo.txt
  modified bar.txt 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-03-26T04:50:52.443

对于那些即使在删除索引后也有问题并且无法重置的人。如果您想保留更改，请执行以下操作（不是解决方案，而是丑陋的解决方法！）。

1.  备份你的文件，我要说的*应该*可以，但以防万一。
2.  删除 .git 文件夹
3.  克隆你的存储库（不管在哪里）我是在当前目录中完成的
4.  将克隆的 .git 目录中创建的复制到您的当前目录中
5.  删除克隆的目录 *6\. 可选，如果您再次使用分支签出到它*
6.  Git 状态现在应该按预期跟踪更改，并且您的所有 git 命令都应该工作

我的情况如上所述，git 弄乱了它的引用......`Git log`显示“你的分支似乎被破坏了”，并`git fsck`警告我有关错误引用的警告。想我是否可以修复它，但我会花很多时间去做，所以我选择了丑陋的解决方法。

# html - 移动设备上的 IFRAME 存在问题

> ID：10076040
> 
> 赞同：3
> 
> 时间：2012-04-09T16:06:55.297
> 
> 标签：html, iframe

长话短说，我的一个客户希望我为他构建一个 ios 模拟器，并将其放在网站上。这样，当他的客户访问例如 xyz.com 时，他们会看到一个 ios 外壳（一张中间切出 ios 手机的图片）以及他们在该外壳内的网站。他真的不想要任何真正的功能，他想要的只是能够向他的客户展示他们的网站在移动设备上的样子

也就是说，我认为这应该很容易，我将 iframe 大小调整为 ios 模拟屏幕大小（320 x 480 等），将源指向他已经构建的移动站点，就是这样。由于他的移动网站已经有灵活的宽度，它应该很适合......

问题是，在 iphone(4s/3gs) 和 IPAD 上，iframe 的内容不能正常工作，如果有的话。宽度在 ipad/iphone 上超出窗口。它的行为就像我从来没有为它设置宽度......并且点击......在那个 iframe 中不存在。如果有的话，它们几乎不能被点击……几乎不能滚动等等。

当我进行更多测试时，（在朋友的机器人手机上）和我的 Sammy galaxytab 8.9 和 7.1 上，它们在视觉上显示得很好，但是，点击里面是不存在的。

我用谷歌搜索了“ios 的 iframe 问题”和各种查询，但没有具体的，所以我来找专业人士。

以防你想明白我的意思。这是我所做的一个工作示例......如果你看一下代码，没什么特别的。从字面上看，一个 iframe 及其来源。

哦，以防万一，为了测试，我从他已经从其他人那里获得的移动网站更改了源代码，并将其更改为我的端口网站，同样的事情。

这是链接[http://somdowprod.net/4testing/411/index2](http://somdowprod.net/4testing/411/index2)

我的问题是，IFRAME 和移动设备有什么关系？似乎我无法让它们中的任何一个显示我想要它在标准电脑上的行为方式。

我已经在许多不同的设备/机器上进行了测试，所有桌面都很好，表现得应该是这样。在几乎所有移动设备上，它都是一个 nogo。

**编辑 - 问题似乎是在IOS上，它不接受宽度/高度......过了一会儿，我决定将iframe包装在另一个div中，给出iframes属性，并强制溢出滚动...... ...现在看起来更好，我可以单击按钮，但现在 div 不会滚动大声笑。**

任何提示，链接等，我很感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:01:08.527

看来您正在使用 html5，查看 iframe 的“无缝”属性（指定 iframe 应该看起来像是包含文档的一部分）

[http://www.w3schools.com/tags/tag_iframe.asp](http://www.w3schools.com/tags/tag_iframe.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-27T02:13:52.657

我认为有办法解决这个问题。看这里：[https ://discussions.apple.com/message/19780023#19780023](https://discussions.apple.com/message/19780023#19780023)

您可能还需要为 iframe 添加宽度和高度，因为有时它不适用于桌面。

# json - 不要在 JSON 响应中发送空值

> ID：10076042
> 
> 赞同：3
> 
> 时间：2012-04-09T16:06:58.847
> 
> 标签：json, wcf, web-services, rest

我正在使用 WCF 开发一个 Rest web 服务。

我有以下合同：

```
 namespace ADM.Contracts
    {
        [DataContract]
        public class FormContract
        {
            [DataMember]
            public int FormId { get; set; }

            [DataMember]
            public string FormName { get; set; }

            [DataMember]
            public List<BlockContract> blocks { get; set; }
        }

} 
```

有时，块为空，我发送此 JSON：

```
[
    {
        "FormId": 1,
        "FormName": "Formulario 1",
        "blocks": null
    },
    {
        "FormId": 2,
        "FormName": "Formulario 2",
        "blocks": null
    },
    {
        "FormId": 3,
        "FormName": "Formulario 3",
        "blocks": null
    }
] 
```

我可以避免发送`"blocks": null`吗？

我正在开发一个 Android 客户端来解析 JSON 数据。我该如何处理`null`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T16:12:24.593

您应该能够`null`通过添加到 DataMember 属性来避免发送列表成员的默认值（即 ）。

```
[DataMember(Name = "blocks", IsRequired=false, EmitDefaultValue=false)]
public List<BlockContract> blocks { get; set; } 
```

但是，请记住，这`null`是 JSON 中的有效值，当您的实体可能没有附加数据时，应该处理它。在您的 javascript 中设置 if 条件可能会更容易，例如：

```
for(var i = 0; i < data.length; ++i) {
   if (data[i].blocks != null) {
      //do stuff
   } else {
      //no blocks. do other stuff
   }
} 
```

*编辑：我想指出，如果您需要检查相关数据成员是否定义了块列表，您很可能必须使用后一种检查块成员是否为空的选项。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:12:30.240

我看到你有几个选择。

1.  继续在 JSON 中发送空值并在客户端检查空值，并在那里处理它。

2.  检查资源类中的无效性并发送其他内容（空对象、具有空字段的新对象、具有占位符字段的对象）。

3.  只是不要包含为空的对象。（即发送一个带有 FormId 和 FormName 字段但没有 blocks 字段的对象）。

无论您选择什么，重要的是在您的 API 中传达如果某些东西不存在会发生什么。并保持一致。

# c# - 插入List后做一些操作

> ID：10076043
> 
> 赞同：2
> 
> 时间：2012-04-09T16:07:02.177
> 
> 标签：c#

我有以下课程：

```
public class FirstClass 
{
   public FirstClass()
   {
       list = new List<SomeType>();
   }

   public List<SomeType> list;
} 
```

在有人将元素放入该列表之后，是否可以执行一些操作，例如触发不同的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:10:49.880

您应该使用 a[`ObservableCollection<SomeType>`](http://msdn.microsoft.com/en-us/library/ms668604.aspx)来代替。

`ObservableCollection<T>`提供`CollectionChanged`您可以订阅的[`CollectionChanged`](http://msdn.microsoft.com/en-us/library/ms653375.aspx)事件 - 当添加、删除、更改、移动项目或刷新整个列表时触发该事件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T16:11:39.147

也许你应该使用`ObservableCollection<T>`. 它在添加或删除项目或其他几个事件时触发事件。

这是文档：http: [//msdn.microsoft.com/en-us/library/ms668604.aspx](http://msdn.microsoft.com/en-us/library/ms668604.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T16:11:22.833

`List`不会为此公开任何事件。您应该考虑[`ObservableCollection`](http://msdn.microsoft.com/en-us/library/ms653375.aspx)改用。它具有`CollectionChanged`在添加、删除、更改、移动或刷新整个列表时发生的事件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T16:14:51.550

你可以做类似的事情

```
 private List<SomeType> _list;

        public void AddToList(SomeType item)
    {
        _list.Add(item);
        SomeOtherMethod();
    }

      public ReadOnlyCollection<SomeType> MyList
    {
       get { return _list.AsReadOnly(); }
} 
```

但 ObservableCollection 最好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T16:47:45.713

如果您创建自己的 IList 实现，则可以在将项目添加到列表时调用方法（或执行任何其他操作）。创建一个继承自 IList 的类，并将 T 类型的列表作为私有成员。使用您的私有成员实现每个接口方法，并将 Add(T item) 调用修改为您需要执行的任何操作

代码：

```
public class MyList<T> : IList<T>
{
    private List<T> _myList = new List<T>();

        public IEnumerator<T> GetEnumerator() { return _myList.GetEnumerator(); }
        public void Clear() { _myList.Clear(); }
        public bool Contains(T item) { return _myList.Contains(item); }

        public void Add(T item) 
        { 
            _myList.Add(item);
            // Call your methods here
        }

         // ...implement the rest of the IList<T> interface using _myList
   } 
```

# jquery - 使用 JQuery RemoveClass 时浏览器重绘错误的解决方法

> ID：10076044
> 
> 赞同：3
> 
> 时间：2012-04-09T16:07:42.997
> 
> 标签：jquery, google-chrome

我的 Web 应用程序中有一个表格，并且我实现了一个事件处理程序，以允许用户通过单击表格中的一行来选择数据元素。为了在视觉上突出显示所选元素，我给它一个边框。选择新的行时，我会从旧元素中删除选定的类（边框），然后将其添加到新元素中。

我的事件侦听器代码似乎工作正常。我已经使用 chrome 的开发人员工具验证了该类已从旧元素中删除并添加到新选择的元素中。然而，在调用 removeClass() 之后，浏览器没有正确删除边框。

在 chrome (18.0.1025.151) 中测试时，新选择的元素显示有边框，之前选择的元素仍显示部分边框（边框的底部和右侧部分仍被绘制）。当我在 FF 11 中测试时，会出现类似的绘图错误。在 Firefox 中，新选择的行仅绘制顶部不显示的边框的左/右/底部部分。导致重绘的事件（例如调整浏览器窗口的大小）修复了边框绘制问题。

有没有人有问题原因的信息/链接。更重要的是，在用户选择新行后我可以实施一种解决方法吗？

正在添加/删除的 CSS 类

```
.uiSelectedLHPlanRow { border: 1px solid purple; } 
```

HTML

```
<table id='lhPlansTable' class='uiLHPlansTable'>
</table> 
```

（表格行是动态添加的）TR 格式：

```
'<tr id=\'' + GENERATED ID + '\' class=\'uiLHPlanTableRow\'><td class=\'uiLHPlanDriverTableCell\'>' + GENERATED DATA1  + '</td><td>' + GENERATED DATA2 + '</td></tr>' 
```

事件处理程序

```
$('#lhPlansTable').on('click', 'tr.uiLHPlanTableRow', function () {

    ... flow control ...

    $('.uiSelectedLHPlanRow').removeClass('uiSelectedLHPlanRow');
    $(this).addClass('uiSelectedLHPlanRow');

    // TODO: WORKAROUND FOR DRAWING BUG ??
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:42:48.663

看起来像一个问题`border-collapse;`。如果您明确设置`border-collapse:separate;`它似乎效果更好（尽管您可能需要调整样式）。设置为`border-collapse:collapse;`会导致问题再次出现。

示例：http: [//jsfiddle.net/T2saA/3/](http://jsfiddle.net/T2saA/3/)

CSS

```
tr.uiSelectedLHPlanRow > td { 
    border-top: 1px solid purple; 
    border-bottom: 1px solid purple; 
}

table.uiLHPlansTable{
    border-collapse:separate;
}​ 
```

# android - 地图不断强制关闭

> ID：10076050
> 
> 赞同：-1
> 
> 时间：2012-04-09T16:08:01.247
> 
> 标签：android, maps, forceclose

我想在我的应用程序中实现地图。但是如果我运行应用程序并尝试使用地图，它会被强制关闭。这是我的代码。我尝试了所有其他帖子 bt cudnt 解决了问题。请帮助我

```
package com.org;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONObject;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.Paint.Style;
import android.graphics.Path;
import android.graphics.Path.Direction;
import android.graphics.Point;
import android.graphics.drawable.Drawable;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.util.Log;
import android.view.KeyEvent;
import android.widget.Toast;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import com.google.android.maps.MyLocationOverlay;
import com.google.android.maps.Overlay;
import com.google.android.maps.Projection;

public class Maps extends MapActivity {

    MapView MapView = null;

    MapController myMC = null;

    GeoPoint geoPoint = null;
    MyLocationOverlay myLocationOverlay = null;
    private List<Overlay> mapOverlays;
    String FR="";
    String FR1="";
    String FRname = "";
    private Projection projection; 
    private static final String NOTIFY_KEYWORD="Maps";
    public static final int NOTIFICATION_ID=1337;
    //double            latitude        = 19.188888, longitude = 72.908333;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.map);

        MapView = (MapView) findViewById(R.id.myGMap);
        //geoPoint = new GeoPoint((int) (latitude * 1000000), (int) (longitude * 1000000));
        MapView.setSatellite(false);

        myMC = MapView.getController();
    //  myMC.setCenter(geoPoint);
        //myMC.setZoom(15);

        /*myMapView.setBuiltInZoomControls(true);
        myMapView.displayZoomControls(true);*/
        //myMC = MapView.getController();
        myMC.setZoom(MapView.getMaxZoomLevel()-13);

        Drawable marker=getResources().getDrawable(android.R.drawable.star_big_on);
        int markerWidth = marker.getIntrinsicWidth();
        int markerHeight = marker.getIntrinsicHeight();
        marker.setBounds(0, markerHeight, markerWidth, 0);

        MyItemizedOverlay myItemizedOverlay
            = new MyItemizedOverlay(marker, Maps.this);
        MapView.getOverlays().add(myItemizedOverlay);

        getLocation();
        FR = FR.replace("[", "");
        FR = FR.replace("]", "");
        FR = FR.replace("\"", "");
        String lat_arr[] = FR.split(",");
        FR1 = FR1.replace("[", "");
        FR1 = FR1.replace("]", "");
        FR1 = FR1.replace("\"", "");
        String long_arr[] = FR1.split(",");
        FRname = FRname.replace("[", "");
        FRname = FRname.replace("]", "");
        FRname = FRname.replace("\"", "");
        String name_arr[] = FRname.split(",");

        for (int i=0; i<long_arr.length; i++)
        {
            //GeoPoint myPoint1 = new GeoPoint(Integer.parseInt(lat_arr[i]), Integer.parseInt(long_arr[i]));
             myItemizedOverlay.addItem(new GeoPoint(Integer.parseInt(lat_arr[i]), Integer.parseInt(long_arr[i])) , name_arr[i].toString() , name_arr[i].toString());
        }

        myLocationOverlay = new MyLocationOverlay(this, MapView);
        MapView.getOverlays().add(myLocationOverlay);
        MapView.postInvalidate();

        double distance;

        Location locationA = new Location("point A");
        locationA.setLatitude(19188888);
        locationA.setLongitude(72908333);

        Location locationB = new Location("point B");
        locationB.setLatitude(17188888);
        locationB.setLongitude(80908333);

        distance = locationA.distanceTo(locationB);

  /*    paint.setColor(android.R.color.black);
        paint.setTextSize(20);
        canvas.drawText(Double.toString(distance), 10, 25, paint);*/

        Toast toast = Toast.makeText(this, Double.toString(distance/1000)+" Km" ,    Toast.LENGTH_LONG);
        toast.show();

        LocationManager mlocManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
        LocationListener mlocListener = new MyLocationListener();
        mlocManager.requestLocationUpdates( LocationManager.GPS_PROVIDER, 0, 0, mlocListener);

        //Bitmap bmp = BitmapFactory.decodeResource(getResources(), R.drawable.marker);
        //canvas.drawBitmap(bmp, myScreenCoords.x, myScreenCoords.y, paint);
    }
    @Override
    protected boolean isLocationDisplayed() {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
        myLocationOverlay.enableMyLocation();
        myLocationOverlay.enableCompass();
    }

    @Override
    protected void onPause() {
        // TODO Auto-generated method stub
        super.onPause();
        myLocationOverlay.disableMyLocation();
        myLocationOverlay.disableCompass();
    }

    public boolean onKeyDown(int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_I) {
            MapView.getController().setZoom(MapView.getZoomLevel() + 1);
            return true;
        } else if (keyCode == KeyEvent.KEYCODE_O) {
            MapView.getController().setZoom(MapView.getZoomLevel() - 1);
            return true;
        } else if (keyCode == KeyEvent.KEYCODE_S) {
            MapView.setSatellite(true);
            return true;
        } else if (keyCode == KeyEvent.KEYCODE_M) {
            MapView.setSatellite(false);
            return true;
        }
        return super.onKeyDown(keyCode, event);
    }

    public class MyLocationListener implements LocationListener
    {
        @Override
        public void onLocationChanged(Location loc)
        {
            loc.getLatitude();
            loc.getLongitude();

            String Text = "My current location is: " +
                          "Latitude = " + loc.getLatitude() +
                          "Longitude = " + loc.getLongitude();

            Toast.makeText( getApplicationContext(), Text, Toast.LENGTH_SHORT).show();
        }

        @Override
        public void onProviderDisabled(String provider)
        {
            Toast.makeText( getApplicationContext(), "Gps Disabled", Toast.LENGTH_SHORT ).show();
        }

        @Override
        public void onProviderEnabled(String provider)
        {
            Toast.makeText( getApplicationContext(), "Gps Enabled", Toast.LENGTH_SHORT).show();
        }

        @Override
        public void onStatusChanged(String provider, int status, Bundle extras)
        {
        }

    }/* End of Class MyLocationListener */

    private void getLocation() {
        SharedPreferences myPrefs = this.getSharedPreferences("myPrefs", MODE_WORLD_READABLE);
        String prefName = myPrefs.getString("user", null);
        String gid = myPrefs.getString("gid", null);

        try {
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://182.237.186.79:8080/ubi/getlocation.php");
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(5);
            nameValuePairs.add(new BasicNameValuePair("gid", gid.toString()));

            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            // Execute HTTP Post Request
            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();
            InputStream instream = entity.getContent();
            String result = convertStreamToString(instream);

            JSONObject jsonResponse = new JSONObject(result);
            JSONObject object = jsonResponse.getJSONObject("lat");

            FR = object.getString("latv");
            JSONObject object1 = jsonResponse.getJSONObject("long");
            FR1 = object1.getString("longv");

            JSONObject object2 = jsonResponse.getJSONObject("name");
            FRname = object2.getString("namev");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    public static String convertStreamToString(InputStream is) {
        BufferedReader reader = new BufferedReader(new InputStreamReader(is));
        StringBuilder sb = new StringBuilder();

        String line = null;
        try {
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                is.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return sb.toString();
    }
} 
```

这是我的日志猫

```
04-09 21:11:27.576: W/KeyCharacterMap(323): No keyboard for id 0
04-09 21:11:27.576: W/KeyCharacterMap(323): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
04-09 21:11:44.126: D/dalvikvm(323): GC_FOR_MALLOC freed 3561 objects / 204176 bytes in 66ms
04-09 21:11:44.356: I/global(323): Default buffer size used in BufferedReader    constructor. It would be better to be explicit if an 8k-char buffer is required.
04-09 21:11:46.656: I/global(323): Default buffer size used in BufferedReader constructor. It would be better to be explicit if an 8k-char buffer is required.
04-09 21:11:48.706: D/dalvikvm(323): GC_FOR_MALLOC freed 1887 objects / 137264 bytes in 216ms
04-09 21:11:48.848: I/global(323): Default buffer size used in BufferedReader constructor. It would be better to be explicit if an 8k-char buffer is required.
04-09 21:11:49.291: I/global(323): Default buffer size used in BufferedReader constructor. It would be better to be explicit if an 8k-char buffer is required.
04-09 21:11:49.351: W/System.err(323): org.json.JSONException: Value <br of type java.lang.String cannot be converted to JSONObject
04-09 21:11:49.533: W/System.err(323):  at org.json.JSON.typeMismatch(JSON.java:107)
04-09 21:11:49.533: W/System.err(323):  at org.json.JSONObject.<init>(JSONObject.java:158)
04-09 21:11:49.536: W/System.err(323):  at org.json.JSONObject.<init>(JSONObject.java:171)
04-09 21:11:49.536: W/System.err(323):  at com.org.groupmain.getmsg(groupmain.java:229)
04-09 21:11:49.536: W/System.err(323):  at com.org.groupmain.onCreate(groupmain.java:82)
04-09 21:11:49.536: W/System.err(323):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-09 21:11:49.536: W/System.err(323):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-09 21:11:49.536: W/System.err(323):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-09 21:11:49.536: W/System.err(323):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-09 21:11:49.536: W/System.err(323):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-09 21:11:49.536: W/System.err(323):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-09 21:11:49.536: W/System.err(323):  at android.os.Looper.loop(Looper.java:123)
04-09 21:11:49.536: W/System.err(323):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-09 21:11:49.536: W/System.err(323):  at java.lang.reflect.Method.invokeNative(Native Method)
04-09 21:11:49.536: W/System.err(323):  at java.lang.reflect.Method.invoke(Method.java:521)
04-09 21:11:49.546: W/System.err(323):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-09 21:11:49.546: W/System.err(323):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-09 21:11:49.546: W/System.err(323):  at dalvik.system.NativeStart.main(Native Method)
04-09 21:11:52.328: W/KeyCharacterMap(323): No keyboard for id 0
04-09 21:11:52.328: W/KeyCharacterMap(323): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
04-09 21:11:54.346: D/dalvikvm(323): GC_FOR_MALLOC freed 2919 objects / 604944 bytes in 61ms
04-09 21:11:54.596: D/dalvikvm(323): GC_FOR_MALLOC freed 5593 objects / 685600 bytes in 63ms
04-09 21:11:54.856: D/dalvikvm(323): GC_FOR_MALLOC freed 6413 objects / 440352 bytes in 63ms
04-09 21:11:55.067: D/dalvikvm(323): GC_FOR_MALLOC freed 5745 objects / 372104 bytes in 68ms
04-09 21:11:55.266: D/dalvikvm(323): GC_FOR_MALLOC freed 2279 objects / 138864 bytes in 126ms
04-09 21:11:55.516: D/dalvikvm(323): GC_FOR_MALLOC freed 7914 objects / 618728 bytes in 71ms
04-09 21:11:55.746: D/dalvikvm(323): GC_FOR_MALLOC freed 6116 objects / 370120 bytes in 78ms
04-09 21:11:56.026: D/dalvikvm(323): GC_FOR_MALLOC freed 5880 objects / 446808 bytes in 68ms
04-09 21:11:56.026: I/dalvikvm-heap(323): Grow heap (frag case) to 3.313MB for 87396-byte allocation
04-09 21:11:56.166: D/dalvikvm(323): GC_FOR_MALLOC freed 30 objects / 1800 bytes in 134ms
04-09 21:11:56.296: D/dalvikvm(323): GC_FOR_MALLOC freed 0 objects / 0 bytes in 131ms
04-09 21:11:56.296: I/dalvikvm-heap(323): Grow heap (frag case) to 3.395MB for 87396-byte allocation
04-09 21:11:56.426: D/dalvikvm(323): GC_FOR_MALLOC freed 0 objects / 0 bytes in 127ms
04-09 21:11:56.576: I/global(323): Default buffer size used in BufferedReader constructor. It would be better to be explicit if an 8k-char buffer is required.
04-09 21:11:56.576: W/System.err(323): org.json.JSONException: Value <br of type java.lang.String cannot be converted to JSONObject
04-09 21:11:56.586: W/System.err(323):  at org.json.JSON.typeMismatch(JSON.java:107)
04-09 21:11:56.586: W/System.err(323):  at org.json.JSONObject.<init>(JSONObject.java:158)
04-09 21:11:56.586: W/System.err(323):  at org.json.JSONObject.<init>(JSONObject.java:171)
04-09 21:11:56.586: W/System.err(323):  at com.org.Maps.getLocation(Maps.java:272)
04-09 21:11:56.586: W/System.err(323):  at com.org.Maps.onCreate(Maps.java:101)
04-09 21:11:56.586: W/System.err(323):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-09 21:11:56.586: W/System.err(323):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-09 21:11:56.586: W/System.err(323):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-09 21:11:56.586: W/System.err(323):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-09 21:11:56.597: W/System.err(323):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-09 21:11:56.597: W/System.err(323):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-09 21:11:56.597: W/System.err(323):  at android.os.Looper.loop(Looper.java:123)
04-09 21:11:56.597: W/System.err(323):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-09 21:11:56.597: W/System.err(323):  at java.lang.reflect.Method.invokeNative(Native Method)
04-09 21:11:56.597: W/System.err(323):  at java.lang.reflect.Method.invoke(Method.java:521)
04-09 21:11:56.597: W/System.err(323):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-09 21:11:56.597: W/System.err(323):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-09 21:11:56.597: W/System.err(323):  at dalvik.system.NativeStart.main(Native Method)
04-09 21:11:56.606: D/AndroidRuntime(323): Shutting down VM
04-09 21:11:56.606: W/dalvikvm(323): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
04-09 21:11:56.616: E/AndroidRuntime(323): FATAL EXCEPTION: main
04-09 21:11:56.616: E/AndroidRuntime(323): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.org/com.org.Maps}: java.lang.NumberFormatException: unable to parse '' as integer
04-09 21:11:56.616: E/AndroidRuntime(323):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
04-09 21:11:56.616: E/AndroidRuntime(323):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-09 21:11:56.616: E/AndroidRuntime(323):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-09 21:11:56.616: E/AndroidRuntime(323):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-09 21:11:56.616: E/AndroidRuntime(323):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-09 21:11:56.616: E/AndroidRuntime(323):  at android.os.Looper.loop(Looper.java:123)
04-09 21:11:56.616: E/AndroidRuntime(323):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-09 21:11:56.616: E/AndroidRuntime(323):  at java.lang.reflect.Method.invokeNative(Native Method)
04-09 21:11:56.616: E/AndroidRuntime(323):  at java.lang.reflect.Method.invoke(Method.java:521)
04-09 21:11:56.616: E/AndroidRuntime(323):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-09 21:11:56.616: E/AndroidRuntime(323):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-09 21:11:56.616: E/AndroidRuntime(323):  at dalvik.system.NativeStart.main(Native Method)
04-09 21:11:56.616: E/AndroidRuntime(323): Caused by: java.lang.NumberFormatException: unable to parse '' as integer
04-09 21:11:56.616: E/AndroidRuntime(323):  at java.lang.Integer.parseInt(Integer.java:412)
04-09 21:11:56.616: E/AndroidRuntime(323):  at java.lang.Integer.parseInt(Integer.java:382)
04-09 21:11:56.616: E/AndroidRuntime(323):  at com.org.Maps.onCreate(Maps.java:118)
04-09 21:11:56.616: E/AndroidRuntime(323):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-09 21:11:56.616: E/AndroidRuntime(323):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-09 21:11:56.616: E/AndroidRuntime(323):  ... 11 more
04-09 21:12:02.626: I/Process(323): Sending signal. PID: 323 SIG: 9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:22:29.400

你试过什么？

```
04-09 21:11:56.616: E/AndroidRuntime(323): Caused by: java.lang.NumberFormatException: unable to parse '' as integer
04-09 21:11:56.616: E/AndroidRuntime(323):  at java.lang.Integer.parseInt(Integer.java:412)
04-09 21:11:56.616: E/AndroidRuntime(323):  at java.lang.Integer.parseInt(Integer.java:382)
04-09 21:11:56.616: E/AndroidRuntime(323):  at com.org.Maps.onCreate(Maps.java:118) 
```

应该非常清楚地表明正在发生的事情。我不知道您的 Maps.java 类中的第 118 行是什么，但您正在解析不是 int 的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T17:03:24.973

```
Caused by: java.lang.NumberFormatException: unable to parse '' as integer

at com.org.Maps.onCreate(Maps.java:118) 
```

从这些行中可以清楚地看出，您尝试解析的值在第 118 行不可用

我认为这里的值之一是空的

```
 Integer.parseInt(lat_arr[i]), Integer.parseInt(long_arr[i]) 
```

只需打印这些值并查看它们是否为空或不可用

```
System.out.Println(lat_arr[i]);
System.out.Println(long_arr[i]); 
```

# asp.net-mvc-3 - ASP MVC3 设计模式，用于在视图中保留项目集合，同时从另一个视图向其中添加新项目

> ID：10076057
> 
> 赞同：1
> 
> 时间：2012-04-09T16:08:17.687
> 
> 标签：asp.net-mvc-3, entity-framework, design-patterns

是否有一个很好的设计模式来解决应用场景，当一个现有的项目集合，显示在一个“ListItem”视图中，需要添加一个新项目，进入另一个“NewItem”视图？

例如，一个带有 EF4.1 Code First 的 ASP.NET MVC3 应用程序管理一个产品列表，每个产品都包含一个部件列表。EF 模型包括具有几个基本类型属性的 Product 对象和 Part 对象的集合。

用户可以将新产品添加到列表中，打开 NewProductView 并输入一般产品信息，然后输入该新产品的部件集合。零件信息收集在另一个新零件视图中，需要包含在新产品的现有零件集合中。主要挑战是，在 NewProduct 视图和 NewPart 视图之间来回切换时，持久保存此 Parts 临时集合的最佳实践是什么？

一种选择是将新的 Part 记录立即保存到数据库中，但尚未构建父 Product 对象，并且需要多次数据库调用。理想情况下，应在一次调用中保存完整的新产品对象及其部件集合。另一种选择是将会话用于临时部件集合存储，但我确信这是否是一个好方法。目前我对不使用 Ajax 或其他客户端站点技术的设计模式很感兴趣，只是从视图中获取/发布到服务器的标准获取/发布。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:47:11.627

“理想情况下，应该在一次调用中保存完整的新产品对象及其部件集合。” 就我个人而言，我会使用 ajax 来做到这一点，当与 Steve Sanderson 的[BeginCollectionItem](http://nuget.org/packages/BeginCollectionItem)和 jquery UI 对话框结合使用时，这完全有可能而且并不困难。但是，要在不使用 ajax 的情况下完成此操作，您可以执行以下操作：

用户从产品表单开始。在产品表单上，有一个（空的）当前部件列表以及一个新部件按钮。

当用户单击 New Part 按钮时，向操作方法提交完整的回发（因此 New Part 按钮类似于`<input type="submit" name="TakeAction" value="New Part" />`.

action 方法检查请求以确定单击了哪个按钮。如果单击 New Part 按钮，则操作方法将返回 Part 表单视图。

但是，Part 表单视图应该为所有可以在 Product 表单中输入的标量字段隐藏字段。此外，它会有一个这样的提交按钮：`<input type="submit" name="TakeAction" value="Add Part" />`

当您提交 Part 表单时，action 方法将返回 Product 表单视图。但是，当前零件列表现在包含已添加的零件，以及在先前零件表单中输入的该零件的所有标量的隐藏字段。（有关在 MVC2+ 中通过 HTTP POST 提交项目列表的更多信息，请参阅[此链接](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)和[此链接](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)。）

这本质上就是 viewstate 在 web 表单中所做的，以跨多个用户点击来维护状态。在幕后，以前表单提交的所有数据都通过一系列回发而不使用会话或持久存储。在 MVC 中，由于没有视图状态，因此您必须更加明确并实际写出“其他表单的”隐藏字段，以便通过一系列回发将它们从一个表单视图传递到另一个表单视图。

但是，一旦您的产品表单获得更多“集合”属性，这很快就会失控。

您可以做的另一件事是强制用户进入渐进式披露/类似向导的工作流程以创建产品和部件。您可以要求用户首先输入所有必需的产品信息。然后，当保存该产品时，将它们推送到另一个屏幕以循环将新部件添加到产品中。这使您摆脱了相互依赖的主体和依赖表单视图的纠结，这些视图相互推送数据。

# java - 在软键盘上添加自定义表情符号

> ID：10076058
> 
> 赞同：0
> 
> 时间：2012-04-09T16:08:30.267
> 
> 标签：java, android, android-softkeyboard

我对应用程序开发非常陌生，我已经从现有来源开发了一个软键盘，我已经提到过，`SDK softkeyboard sample`但在添加表情符号方面没有任何帮助。

我想将自己的表情符号添加到软键盘中，我该如何实现呢？根据我的研究，我只发现了如何创建实际的软键盘本身，但我没有发现如何创建自定义软键盘（添加您自己的表情符号）。任何有关如何将自定义表情符号添加到软键盘的建议、博文或参考资料将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T03:23:25.000

Add a keyboard layout in XML, similar to `qwerty.xml`, `symbols.xml`, etc., replacing the keys with keys that use your emoticon icons (`android:keyIcon="@drawable/smiley_icon"`, for example) and that output that text for the emoticon (`android:keyOutputText=":-)"`, for example). Then add a keyboard, named something like mEmoticonKeyboard, to your SoftKeyboard class and instantiate it in the same way that `mQwertyKeyboad`, `mSymbolsKeyboard`, etc. are created.

To show this keyboard, add it to the keyboard rotation cycle on `handleShift()`.

# ios - 在来自 nib 的视图加载并显示在屏幕上后立即调用方法

> ID：10076060
> 
> 赞同：1
> 
> 时间：2012-04-09T16:08:32.163
> 
> 标签：ios

当视图刚刚加载到屏幕上时，我想更新我的核心数据数据库，我知道默认方法：

```
- (void)viewDidLoad
{
[super viewDidLoad];

}

- (void)viewDidUnload
{
[super viewDidUnload];
// Release any retained subviews of the main view.
// e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
[super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
[super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
[super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
[super viewDidDisappear:animated];
} 
```

在视图加载或消失时调用，但我的问题是，是否存在类似上述方法的默认方法，或者存在一种在视图加载到屏幕上之后调用方法的方法，并且我看到了我的图形？不是当显示器仍然是黑色的时候，因为它正在加载......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:13:33.030

```
- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    // Here is the place where you should call your function.
} 
```

但请注意：当您在主线程中更新 coredata 时，您的界面将在更新期间被阻塞。

# javascript - Javascript 类的成员在定义后未定义

> ID：10076065
> 
> 赞同：1
> 
> 时间：2012-04-09T16:08:46.840
> 
> 标签：javascript, javascript-events

我正在尝试在 HTML 文档中留出余地。旁白应该像内联脚注。当读者将鼠标悬停在项目符号上时，将显示旁白的全文。当阅读器鼠标移出时，文本再次被隐藏。我正在尝试尽量减少完成这项工作所需的 HTML 数量，所以我使用`<span class="aside"...`而不是`<span onmousover="showAside();"...`

无论如何，我对 Javascript 还是很陌生，而且我遇到了一个我似乎无法弄清楚的真正新手错误。当我在浏览器中加载下面的测试用例时，旁边的文本按预期替换为项目符号。但是当我将鼠标悬停在项目符号上或离开项目符号时，我收到错误“this.element is undefined”。但它是在类原型中定义的！是什么赋予了？

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <script type="text/ecmascript">
<!--
var asides = [];

// object prototype
function Aside(aside_element)
{
  this.element = aside_element;
  this.text = this.element.innerHTML;
  this.element.onmouseover = this.show;
  this.element.onmouseout = this.hide;
  this.hide();
}
Aside.prototype.hide = function()
{
  this.element.innerHTML = "•";
}
Aside.prototype.show = function()
{
  this.element.innerHTML = this.text;
}

// get all <span> elements of class "aside"
function make_asides()
{
  span_elements = document.getElementsByTagName("span");
  for ( var i = 0, len = span_elements.length; i < len, span_element = span_elements[i]; ++i )
  {
    if ( span_element.className == "aside" )
      asides.push(new Aside(span_element));
  }
  return asides;
}

// initialize script
window.onload = function()
{
  make_asides();
}
-->
  </script>
  <title>Test Case</title>
</head>
<body>
  <p>Hover over the bullet and see the magic text! <span class="aside">This is the magic text.</span></p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:14:24.733

因为范围是错误的，你需要使用闭包

```
var that = this;
this.element.onmouseover = function(){ that.show(); };
this.element.onmouseout = function(){ that.hide(); }; 
```

# android - 许可 Adob e AIR 应用程序 - 如何

> ID：10076066
> 
> 赞同：0
> 
> 时间：2012-04-09T16:08:59.327
> 
> 标签：android, air, licensing, copy-protection, air-native-extension

以前我构建了两个应用程序。免费应用程序已截断功能并推广付费应用程序。付费应用程序受到 Android Market 的复制保护的保护。

现在我安装了本机扩展。如果我在付费应用程序中获得 status == LicenseStatus.LICENSED，我授权访问全部功能，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T13:19:20.077

看看[扎尔昆](http://zarqon.net/)。另请阅读此[页面](http://zarqon.net/learn-more.html)上 Cliff Hall 的文章“克服 FUD” 。

# windows-server-2008 - 将 iSCSI 目标连接到我的 vSphere 客户端

> ID：10076068
> 
> 赞同：-1
> 
> 时间：2012-04-09T16:09:18.113
> 
> 标签：windows-server-2008, vmware, virtualization, esxi, iscsi

我使用了新的 Microsoft iSCSI 软件目标 3.3 并设法附加虚拟磁盘并创建 iSCSI 目标启动器。现在，当我尝试在 vSphere 客户端的 iSCSI 软件适配器下添加它并扫描 HBA 后，它显示没有任何设备。我尝试过 Starwind 管理控制台、iSCSI cake 等等，但一直没能找到。请帮助我，因为我正在尝试为 vcp 模拟实验室环境。

我正在使用什么

Windows 服务器 2008 r2 Esxi 4.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T18:10:34.567

用 StarWind 替换您的目标。只需确保您在连接之前已创建设备。

-尼斯莫

# java - 如何使用 iText 从 pdf 文件中提取数据

> ID：10076070
> 
> 赞同：0
> 
> 时间：2012-04-09T16:09:21.973
> 
> 标签：java, itext

我正在开发一个从 PDF 文件中提取数据的程序，并且我使用 iText 作为 java 库。当我尝试使用此方法打开文件时：

```
public static void main(String[] args) {
    try {
        // TODO code application logic here

        PdfReader pr=new FdfReader("C:\\Users\\saviour\\Desktop\\doc308-999.pdf");

        String str=PdfTextExtractor.getTextFromPage(pr, 2); 
        System.out.println(str);

    } catch (IOException ex) {
        Logger.getLogger(PDFTests.class.getName()).log(Level.SEVERE, null, ex);
    }

} 
```

我有这个错误：

```
com.itextpdf.text.exceptions.InvalidPdfException: FDF header signature not found.
    at com.itextpdf.text.pdf.PRTokeniser.checkFdfHeader(PRTokeniser.java:215)
    at com.itextpdf.text.pdf.FdfReader.readPdf(FdfReader.java:95)
    at com.itextpdf.text.pdf.PdfReader.<init>(PdfReader.java:169)
    at com.itextpdf.text.pdf.PdfReader.<init>(PdfReader.java:158)
    at com.itextpdf.text.pdf.FdfReader.<init>(FdfReader.java:63)
    at pdftests.PDFTests.main(PDFTests.java:39) 
```

所以我在问这个例外的目的:) 谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:08:10.067

您尝试加载的 pdf 文件有可能不是 pdf 文件。或者它不包含 FDF 表格。请阅读有关[InvalidPdfException](http://api.itextpdf.com/itext/com/itextpdf/text/exceptions/InvalidPdfException.html)的 javadoc 。

您可以尝试以下代码更改并获得预期结果。
更改`PdfReader pr=new FdfReader("C:\\Users\\saviour\\Desktop\\doc308-999.pdf");`
为`PdfReader pr=new PdfReader("C:\\Users\\saviour\\Desktop\\doc308-999.pdf");`

参考：

*   [PDF阅读器](http://api.itextpdf.com/itext/com/itextpdf/text/pdf/PdfReader.html)
*   [FDF阅读器](http://api.itextpdf.com/itext/com/itextpdf/text/pdf/FdfReader.html)
*   [无效的 PDF 异常](http://api.itextpdf.com/itext/com/itextpdf/text/exceptions/InvalidPdfException.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T06:27:29.850

尝试更改文件位置。有时操作系统不允许其他应用程序从某些系统驱动器读取文件。放在某处 D: 等。

还要确保 PDF 中有足够的页面。（至少 2 页，因为您正在阅读第 2 页）或尝试使用`parser.getTextFromPage(1)`etc. 从其他页面获取内容。

你可以多看[这里](https://stackoverflow.com/questions/1637505/read-pdf-using-itext)。

# jquery - 如何将 jquery 返回的值转换/格式化为剃刀？

> ID：10076072
> 
> 赞同：0
> 
> 时间：2012-04-09T16:09:30.570
> 
> 标签：jquery, html, asp.net-mvc, telerik

我的视图中有这条线

```
<h1 > Reply to: @Model.dialogueEntity[index].DialogueSubject</h1> 
```

我正在尝试获取单击的按钮的值以更改索引的值（我有一个 for 循环，为每个按钮分配一个值）。我能够使用以下行将其打印为文本

```
<h1 id="lastClicked">test</h1> 
```

如何将 jquery 返回的值放在代码的 [index] 部分中？

这是我的 jquery 点击部分

```
 $(".reply-button")
          .click(function(e) 
            {
                var target = $(e.target);
                e.preventDefault();
                $('#lastClicked').text( target.attr('value')  );
                $('#index').val( target.attr('value')  );
                $('#Window').data('tWindow').center().open();

            } 
```

在此先感谢，如果这是一个简单的 jquery 问题，我很抱歉。我刚开始了解它。

编辑：这是我的按钮代码的代码。记住：它在 for 循环中

```
 <button id="Reply-open-button-@i" class="t-button t-state-default reply-button" value = "@i">Reply</button> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:13:31.393

您无法获得 C# 在客户端 javascript 中使用的任何代码。

但是，您可以使用该`data-*`属性将索引存储在元素本身中，然后在需要时检索它。尝试这个：

```
<h1 data-index="@index">Reply to: @Model.dialogueEntity[index].DialogueSubject</h1> 
```

```
 $element.click(function(e) {
      var index = $(this).data("index");
      // the rest of your code...
 } 
```

# c# - 无法将资源文本文件的内容导入 StreamReader

> ID：10076073
> 
> 赞同：1
> 
> 时间：2012-04-09T16:09:33.147
> 
> 标签：c#, embedded-resource, streamreader

我想要一个为用户提供两个选项的 GUI：

1.  读入用户通过 openFileDialog 加载的密钥文件。
2.  读入一个预加载的密钥文件（用户可以使用单选按钮选择一个）。

这将很有帮助，因为用户不需要随身携带我们所有的密钥文件，但如果需要添加新的密钥文件，它仍然可以提供灵活性。

我的代码目前适用于选项#1。我用：

```
readFile = new StreamReader(KeyFileFullPath); 
```

其中 KeyFileFullPath 是 openFileDialog 定义的密钥文件的文件路径。

我想对选项 #2 使用相同的 streamReader，但我无法将阅读器指向资源文件。

从[这个问题](https://stackoverflow.com/questions/3314140/how-to-read-embedded-resource-text-file)，我尝试了以下内容：

```
_assembly = Assembly.GetExecutingAssembly();
readFile = new StreamReader(_assembly.GetManifestResourceStream(TM_Decoder.Properties.Resources._7p1_HOB_Key)); 
```

我使用 C# 的自动完成导航到 ..."_7p1_HOB_Key"，所以我希望它指向我实际存在的东西。但是，当我尝试运行代码时，出现此错误：

“值不能为空。参数名称：流”

基于[此](https://stackoverflow.com/questions/8033386/value-cannot-be-null-parameter-name-stream-error-while-reading-the-contents-of)，我尝试查找 ManifestResourceNames，但它只有：“TM_Decoder.Form1.resources”和“TM_Decoder.Properties.Resources.resources”

这些实际上都没有指向我已加载到项目资源中的关键文件。

提前感谢您在让 streamReader 指向资源文本文件方面提供的任何帮助！

编辑（响应 SLaks 的建议）：

1.  除非我误解了“根命名空间”的含义，否则我认为它是正确的。该项目的名称是“TM Decoder”，所以我认为“TM_Decoder”是根命名空间。这不对吗？
2.  谢谢，我将构建操作更改为“嵌入式资源”。它以前设置为“无”（我不知道）。不幸的是，这还不足以解决问题（调试尝试的结果没有改变）。
3.  我不确定资源文件夹中的项目。它们位于项目文件夹中名为“资源”的文件夹中，即 TM 解码器 --> 资源，而不是 TM 解码器 --> 属性 --> 资源 这是 Visual Studio 在我通过资源选项卡添加资源时自动执行的操作在项目属性中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:14:33.980

`TM_Decoder.Properties.Resources._7p1_HOB_Key`是一个包含实际内容的字符串，而不是资源名称。
`"TM_Decoder.Resources._7p1_HOB_Key"`是资源名称。

# c++ - Luabind：派生类作为参数

> ID：10076074
> 
> 赞同：1
> 
> 时间：2012-04-09T16:09:36.143
> 
> 标签：c++, lua, factory, luabind

我最近一直在学习 Luabind，打算集成到我们的软件中。我遇到了几个问题，我一直在查看 Luabind 的 Rasterbar Software 文档，但无法解决。基本上，我公开了一个将字符串和抽象基类作为参数的函数。首先，我不确定我是否以正确的方式进行此操作，或者在 lua 中可能需要一些特殊处理才能使其正常工作。无论如何，这是代码

```
class UIFactory
{
    void addComponentFactory(std::string name, BaseFactory* factory);
} 
```

BaseFactory 是一个抽象基类，它返回一个 UIComponent（按钮、文本等），我们派生了一个名为 TemplateFactory 的工厂，它基本上可以像这样实例化。

```
TemplateFactory<Button> buttonFactory = new TemplateFactory<Button>(); 
```

然后我们会像这样将这些传递给 c++ 中的 UIFactory ...

```
uiFactory.addComponentFactory("Buttons", buttonFactory); 
```

在卢宾德...

```
module(state)
[
    class_<UIFactory>("UIFactory")
    .def(constructor<>())
    .def("AddFactory", &UIFactory::addComponentFactory)
]; 
```

并在 lua...

```
uiFactory = UIFactory()

buttonFactory = ButtonFactory()

uiFactory:AddFactory("Button", buttonFactory) 
```

最后一行没有执行，我检查了按钮工厂和 ui 工厂是否正在创建并且它们是。有什么我想念的吗？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T08:20:37.993

原来我需要将基类公开给 lua 并指出 buttonFactory 是派生的

```
luabind::module(state)
[
    luabind::class_<BaseFactory>("BaseFactory")
];

luabind::module(state)
[ 
    luabind::class<TemplateFactory<Button>, BaseFactory>("ButtonFactory")
    .def(constructor<>())
] 
```

# python - 对 python 列表的并发、网络访问

> ID：10076075
> 
> 赞同：0
> 
> 时间：2012-04-09T16:09:37.597
> 
> 标签：python

我有一个这样的数据结构：

```
{
    'key1':[
        [1,1,'Some text'],
        [2,0,''],
        ...
    ],
    ...
    'key99':[
        [1,1,'Some text'],
        [2,1,'More text'],
        ...
    ],
} 
```

它的大小只有 100 个键和每个键中的 100 个列表。

我喜欢存储它并根据密钥检索它（整个列表）。这是在流量不是很高的网络服务器中使用的。但是，后端必须处理并发读取和写入。

如何以安全的方式做到这一点，而无需编写太多代码？

我想将[腌制](http://docs.python.org/library/pickle)对象存储在 SQLite 中是一种可能的解决方案。

有没有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:18:19.163

答案是取决于瓶颈在哪里。如果您的进程受 I/O 限制（即它不会消耗大量 CPU 时间来处理您的所有请求），您应该研究像[Twisted](http://twistedmatrix.com/trac/)这样的事件驱动框架。在这种情况下，您可以将数据存储在普通字典中，因为在给定时间只有一个线程会访问它。

如果你的进程是 CPU 密集型的并且你想利用多核，你需要使用多个 Python 进程，因为每个 Python 进程都会持有一个 GIL（全局解释器锁）并且多个线程不能在同一个进程中执行 Python 代码同时。在这种情况下，一个非常简单的选择是使用共享存储，例如[memcached](http://www.tummy.com/Community/software/python-memcached/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:21:14.083

Python 泡菜不是为并发访问而制作的。如果您可以创建单个长寿命进程，则可以简单地使用内存结构进行操作，并使用单个 pickle 文件进行持久化。您需要确保捕获信号以确保写入泡菜文件！

更灵活的解决方案是 sqlite。sqlite 网页[吹嘘](http://www.sqlite.org/faq.html#q5)说：“我们知道没有其他嵌入式 SQL 数据库引擎支持与 SQLite 一样多的并发性。” 这里的问题是您很可能会错误地进行数据库设计（无意冒犯）。我将创建一个“键”表和一个“列表”表（建议使用更有意义的名称！），外键从列表指向键。确保键有索引！

如果列表*不是*固定长度的，您应该创建第三个表来保存这些值，外键指向列表。

# javascript - 有人用Coldbox Coldfusion 试试knockoutJS 吗？甚至可能吗？

> ID：10076080
> 
> 赞同：0
> 
> 时间：2012-04-09T16:10:03.777
> 
> 标签：javascript, frameworks, coldfusion

我是 ColdFusion 开发人员，已经开始使用 jQuery 和 jQuery Mobile 进行开发，并且希望进入 cf 框架 ColdBox 和 js 框架 KockoutJS。现在，如果可以的话，我正试图绕开我的脑袋，以及它们如何一起工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T18:10:33.273

是的，它会工作得很好。

我将 Backbone.js 与运行 ColdBox 框架的 ColdFusion 后端一起使用。

您可以像这样直接从事件处理程序返回 JSON：

```
Event.renderData(data={'key'=value,'key2'=[1,2,3,4,'A','B','c']},type='JSON'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:29:58.273

这是另一种看待它的方式。因为 Knockout 是一个 Javascript 框架，所以很容易使用 HTML 和 Javascript 构建一个工作示例。您使用 htm 或 html 扩展名命名您的文件，服务器端技术变得无关紧要。这适用于任何 Javascript 库或框架。

现在，您获取相同的 HTML 文件（例如 mypage.html），将其放入您的 Coldbox 视图文件夹，使用 .cfm 扩展名重命名它，它仍然执行相同的操作。您可以使用 CF 标记和脚本进一步增强它以输出您的数据模型，但最终您只是生成 HTML 和 Javascript 以发送到浏览器。

# wpf - 如何在同一行上更改另一列时更新 DataGrid 的列

> ID：10076082
> 
> 赞同：4
> 
> 时间：2012-04-09T16:10:10.360
> 
> 标签：wpf

我有一个 wpf DataGrid，其中有一列 ComboBox 和另一列 TextBox。当我在 ComboBox 上选择值时，我希望所选值显示在同一行的 TextBox 列中。我怎样才能做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T18:34:11.393

在 ViewModel 中进行所有操作。创建一个属性来绑定组合框的 selectedItem，您可以在下一列中绑定到该属性。

```
<DataGrid ItemsSource="{Binding ViewModel.Rows}" >
    <DataGrid.Columns>
        <DataGridTemplateColumn>
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <ComboBox ItemsSource="{Binding ViewModel.ComboBoxItems}" SelectedItem="{Binding ViewModel.ComboBoxSelectedItem}"/>
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>

        <DataGridTextColumn Binding="{Binding ViewModel.ComboBoxSelectedItem.Name}" /> 
```

# javascript - JQuery 可以在新类出现时检测到它们吗？EG 刚刚发布的新评论

> ID：10076086
> 
> 赞同：0
> 
> 时间：2012-04-09T16:10:20.643
> 
> 标签：javascript, ajax, jquery

我有一个微博/评论系统，每次提交新的微博或评论时，页面都会刷新以显示它。

因为我已经在我的表单上设置了 ajax，所以我现在希望在不刷新页面的情况下添加或添加微博。

到目前为止，我有：

```
if @micropost.save
  format.js   { render :post_on_wall }
else
  format.js   { render :form_errors }
end 
```

您无需成为 ruby​​ on rails 专家即可了解此代码段中发生的情况。如果表单通过了所有验证并且用户在单击发布之前实际上输入了有效的内容，那么“如果@micropost.save”将为真，它将在我命名为“post_on_wall”的文件中执行 js。如果 "@micropost.save" 将执行 "form_errors" 中的代码。

在 form_errors 中，我添加了一个警报，只是为了检查当用户不输入任何内容并点击帖子时微博不会被发布。它工作正常。

在“post_on_wall”文件中，我有这个：

```
$('.microposts').prepend('<%= j render("users/partials/microposts") %>'); 
```

**这样做的问题是它基本上抓取了正在呈现“users/partials/ microposts** ”的文件中循环的所有微帖子，然后将它们放在“.microposts”div中的所有内容之上。即使是位于“.microposts”顶部的发布微博的实际表单也被推到刚刚添加到页面的内容下方。

这是我的html结构。

```
<div class='cf' id='content'>
    <div id='leftColumn'>
    </div>
    <div class='microposts'>
    </div>
    <div id='rightColumn'>
  </div>
</div> 
```

每个微博及其相关评论都存储在一个名为“.postHolder”的类中。

我觉得我的做法是错误的。这个文件：“users/partials/microposts”指向的文件基本上有代码，可以帮助一次显示 10 个微博。这用于与我正在尝试做的完全不同的事情（分页+无限滚动）。

无论如何，我觉得我应该处理的方法是如何检测刚刚发布的新帖子。它应该被检测为一个新的“.postHolder”类，然后在发现它之后应该将它添加到“postHolder”列表的顶部，而不是替换它上面的微帖子表单。

我正在考虑创建一个单独的 div 来保存所有微帖子，然后将此 div 放在微帖子表单下方。这样我就不必担心表单被推下，因为它不会在 div 里面包含实际上将是我将要准备的所有微博。

无论如何，我真的很想要一个可以帮助我实现此功能的示例或一些好的建议。

感谢您的时间亲切的问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:10:27.937

基于您的假设

1.  想要按时间降序排列的帖子
2.  希望尽量减少您必须返回以进行更新的数据量

我建议您在成功提交帖子后，向服务器发起 AJAX 调用以获取比上次显示的帖子更新的所有帖子。假设您的后置 HTML 可以这样总结

```
<div id='microposts'>
    <form id='new_post'></form>
    <div class='postholder' id='some-id-number'></div>
    <div class='postholder' id='some-older-id-number'></div>
    ...
</div> 
```

我会从服务调用中获取新帖子作为返回的 html

```
function getNewPosts(){
    $.ajax({
        url: 'Your-New-Posts-Url',
        data: {lastId: $('.postholder:first').attr('id')},
        success: function(newPosts){
            if(newPosts && newPosts.length > 0){
                $('.postholder:first').before(newPosts);
            }
        }
    });
} 
```

您还可以使用 setTimeout 作为心跳来每隔一段时间调用 getNewposts。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:50:34.943

要回答标题问题“JQuery 可以在新类出现时检测它们吗？”：不能。

将新元素添加到页面 ( `DOMNodeInsertedIntoDocument`) 时会触发一些事件，但这绝对是低效的（并且已弃用）。

[`.trigger()`](http://api.jquery.com/trigger/)更好地在添加新元素的代码中使用 jQuery 方法触发自定义事件。有了它，您可以通知独立模块有新元素。

但是当您在寻找新元素的事件处理程序注册时，您可能应该看看 jQuery 的[`.live()`](http://api.jquery.com/live/)方法。

# asp.net - 如何在 aspx 页面上从 ListView 检索值到 ASP 代码

> ID：10076093
> 
> 赞同：0
> 
> 时间：2012-04-09T16:10:35.060
> 
> 标签：asp.net, listview

```
<asp:ListView ID="ListView1" runat="server" DataKeyNames="orderID" DataSourceID="SqlDataSource1">
<ItemTemplate>
<tr>
<td>
  <asp:Label ID="statusLabel" runat="server" Text='<%# Eval("status") %>' Visible="false"  />
</td>
<% 
  Label s = (Label)ListView1.FindControl("statusLabel");
  string status = s.Text;
  if (status == "0") {  //code here }
%>
</tr>
</ItemTemplate>
</asp:ListView> 
```

如何在首页获取 statusLabel 文本？不是后面的代码。每行数据都会有不同的状态，所以我想根据状态显示按钮。任何解决方案都可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:37:54.673

看起来您不需要获得标签；您只需要获取标签设置的值，您可以使用该`Eval`函数执行此操作。

如果有一定数量的按钮，您可以根据状态切换可见性：

```
<ItemTemplate>
    <asp:Label ID="statusLabel" runat="server" Text='<%# Eval("status") %>' Visible="false"  />
    <asp:Button ID="Button1" runat="server" Text="Test" Visible='<%# Eval("status") == "Open" ? true : false %>' />
    <asp:Button ID="Button2" runat="server" Text="Test Again" Visible='<%# Eval("status") == "Closed" ? true : false %>' />
</ItemTemplate> 
```

如果情况比这更复杂，您可以使用`PlaceHolder`控件按状态对按钮进行分组：

```
<ItemTemplate>
    <asp:Label ID="statusLabel" runat="server" Text='<%# Eval("status") %>' Visible="false"  />
    <asp:PlaceHolder ID="plcOpenStatus" runat="server" Visible='<%# Eval("status") == "Open" ? true : false %>'>
        <!-- buttons for open status -->
    </asp:PlaceHolder>
    <asp:PlaceHolder ID="plcClosedStatus" runat="server" Visible='<%# Eval("status") == "Closed" ? true : false %>'>
        <!-- buttons for closed status -->
    </asp:PlaceHolder>
</ItemTemplate> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:18:06.393

您可以附加到 ItemDataBound 或 ItemCreated 事件，然后在那里执行代码。

有关示例，请参见此帖子 - [http://www.toars.com/2010/11/listview-events-01/](http://www.toars.com/2010/11/listview-events-01/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T16:14:39.467

内联执行业务逻辑通常是一个坏主意。但是，对于您的情况，您不需要访问 statusLabel 控件本身。您只需要在 if 语句中调用 Eval("status") 即可。

所以

```
string status = (string) Eval("status");
if (status == "0") { // etc } 
```

# debugging - Symfony2 / Doctrine2：捕获 QueryException 并输出查询

> ID：10076095
> 
> 赞同：1
> 
> 时间：2012-04-09T16:10:45.607
> 
> 标签：debugging, symfony, doctrine-orm

当我的查询出现错误时，Symfony2 抛出的异常在大多数情况下并不是很有帮助，因为它缺少上下文，即：触发错误的查询：

> [语法错误] 第 0 行，第 74 列：错误：预期 =、<、<=、<>、>、>=、！=，得到 'd'

有没有办法做这样的事情：

```
... catch(\Exception $exception){
if(get_class($exception) == 'Doctrine\ORM\Query\QueryException'){
    /* var $exception \Doctrine\ORM\Query\QueryException */
    var_dump($exception->getSqlQuery());
}
... 
```

这将大大改善调试！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T12:44:16.563

这现在应该是内置的学说，因为这个提交[https://github.com/doctrine/doctrine2/commit/d05ad996c4c3acfd3a0c8659719dd4752cb84531](https://github.com/doctrine/doctrine2/commit/d05ad996c4c3acfd3a0c8659719dd4752cb84531)（在 master 中提交）。我想它可能会在学说 2.3 中发布

# wordpress - NGINX - 重写某些 URL 以服务于 Wordpress

> ID：10076101
> 
> 赞同：0
> 
> 时间：2012-04-09T16:11:18.480
> 
> 标签：wordpress, nginx

我正在慢慢地将在 NGINX 服务器上运行的现有 Drupal 站点迁移到 Wordpress。这意味着，目前，我希望一些 URL 为 Wordpress 提供服务，而另一些为 Drupal 提供服务。

我现有的 NGINX 服务器配置可以完美地为 Drupal 页面提供服务，如下所示：

```
 server {

    limit_conn   gulag 10;
    listen       80;
    server_name  www.mysite.com;
    root         /home/mysite/public_html;
    index        index.php index.html;

    include /etc/nginx/configs/drupal.conf;

} # end of server 
```

如何修改它，例如，如果我尝试访问[http://www.mysite.com/pageX.html](http://www.mysite.com/pageX.html)，NGINX 将使用该 URI 提供*Wordpress*页面（并包含一个 Wordpress.conf 文件而不是Drupal.conf 文件）？但是所有其他 URL 将继续由 Drupal 使用上述配置提供服务。

我相信它涉及在位置块内设置一个新的*根*变量，但尚未取得任何成功。

我的 Wordpress 安装在 /home/mysite/wordpress/

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T13:40:21.900

只需将您的`include`指令放入一个位置，然后重置根：

```
server {
    limit_conn   gulag 10;
    listen       80;
    server_name  www.mysite.com;
    root         /home/mysite/public_html;
    index        index.php index.html;

    location /pageX.html {
        root /home/mysite/wordpress/;
        include /etc/nginx/configs/wordpress.conf;
    }

} # end of server 
```

虽然我认为重置根不是这里的最佳选择。

当然，您可以为该位置使用匹配的正则表达式。

# java - Java Swing - 在 Mac 上，监听 Quit 事件

> ID：10076104
> 
> 赞同：0
> 
> 时间：2012-04-09T16:11:25.490
> 
> 标签：java, macos

在 Mac 上的 Java 应用程序中，您可以单击顶部栏并选择退出以退出程序。如何向我的 JFrame 添加一个监听器来收听这个？

我对此进行了搜索并找到了 ApplicationListener，但是 Eclipse 在其中放置了一个“叉号”，并且似乎认为它已被弃用。

具体来说，我发现使用 com.apple.eawt.ApplicationListener，但我该怎么做呢？我需要下载这个 com.apple.eawt 包吗？我似乎找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-11T10:00:24.740

对于 Java 7，QuitHandler 是要实现的接口。

```
import com.apple.eawt.QuitHandler;
import com.apple.eawt.Application; 
```

在某处，执行以下操作：

```
Application macApp = Application.getApplication();
macApp.setQuitHandler(this); 
```

接着 ，

```
@Override
public void handleQuitRequestWith(AppEvent.QuitEvent qe,final QuitResponse qr) {
    System.out.println("quit clicked");
    qr.performQuit();

} 
```

我从 CodeGuy 和以下网址得到提示 [http://cr.openjdk.java.net/~michaelm/7113349/jdk8/webrev.4/jdk/raw_files/new/src/macosx/classes/com/apple/eawt/应用程序.java](http://cr.openjdk.java.net/~michaelm/7113349/jdk8/webrev.4/jdk/raw_files/new/src/macosx/classes/com/apple/eawt/Application.java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:28:19.993

答案是使用更新版本的 QuitHandler，可从 Apple Java 扩展中获得

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T16:15:53.737

你需要注册一个ApplicationListener：

Apple 提供了一个示例应用程序：

[http://developer.apple.com/library/mac/#samplecode/OSXAdapter/Introduction/Intro.html](http://developer.apple.com/library/mac/#samplecode/OSXAdapter/Introduction/Intro.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T16:28:41.207

当像这样单击划掉按钮时，您可以捕捉到

```
frame.addWindowListener(new ExitListener());
```

然后你可以像这样覆盖它

```
 public class ExitListener extends WindowAdapter{
        public void windowClosing(WindowEvent e){
            //some codes
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-30T15:08:40.937

为了不破坏与 Windows 和其他操作系统的兼容性，这里采用另一种方法：

[http://javadots.blogspot.com/2010/09/making-your-swing-app-macosx-compliant.html](http://javadots.blogspot.com/2010/09/making-your-swing-app-macosx-compliant.html)

Maven依赖：

```
<dependency>
    <groupId>org.simplericity.macify</groupId>
    <artifactId>macify</artifactId>
    <version>1.6</version>
</dependency> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-03T20:01:06.810

在 Java 9 中，您应该使用跨平台的桌面 API，因为 Mac EAWT API 已被弃用：

```
if (Desktop.isDesktopSupported()) {
    Desktop desktop = Desktop.getDesktop();
    desktop.setQuitHandler(new QuitHandler()
    {
        @Override
        public void handleQuitRequestWith(QuitEvent evt, QuitResponse res)
        {
            // TODO: Handle the quit request
            // res.cancelQuit();  // Cancel the quit request
        }
    });
} 
```

# iphone - 如何在 appDelegate.m 中实现 applicationWillTerminate

> ID：10076106
> 
> 赞同：0
> 
> 时间：2012-04-09T16:11:30.090
> 
> 标签：iphone, object, delegates, persistence, nscoding

我正在尝试将一些数据保存在一个名为 MyPos.h 的类中，该类使用 NSCoding 方法：

*   `(void)encodeWithCoder:(NSCoder *)aCoder`
*   `(id)initWithCoder:(NSCoder *)aDecoder`

这两种方法已在 MyPos.m 文件中实现。

现在我希望应用程序在它终止时保存数据并在它完成启动时加载数据。我想在 AppDelegate.m 文件中实现 to 方法，但我不知道如何保存保存数据的 MyPos 类的实例。

这是 AppDelegate.m 文件中的两种方法之一......到目前为止：

```
- (void)applicationWillTerminate:(UIApplication *)application {

NSMutableData *data = [[NSMutableData alloc] init];
NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:data];

[archiver encodeObject: **HELP_HERE!** forKey:@"myPos"];
[archiver finishEncoding];

[data writeToFile:[self dataFilePath] atomically:YES];} 
```

我该如何解决这个问题？提前非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:48:48.900

两件事情：

1.  但是对于`**HELP_HERE!**`，您的保存方法看起来不错。将该占位符替换为对`MyPos`包含数据的实例的引用。您如何引用该实例取决于您的应用程序委托中如何引用它。它是属性还是 ivar？用那个。它是否属于您程序中的其他对象（例如，视图控制器）？见下文。

2.  请注意，在大多数情况下* 在 iOS 4+ 上，您的应用程序永远不会看到**willTerminate**事件——您会看到**willResignActive**和**didEnterBackground**，但是当操作系统因为需要更多 RAM 而终止您的应用程序时，您的应用程序将已经暂停所以你将没有机会对此事件做出反应。您可能想要进行保存以响应**didEnterBackground**事件。（尽管您也可以考虑在数据更改后立即保存。）

我提到的这些“事件”中的每一个都是您可以[通过应用程序委托消息](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIApplicationDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/TP40006786-CH3-SW5)或[订阅通知](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006728-CH3-DontLinkElementID_4)来响应的东西——使用适合您情况的任何一个。如果需要保存的数据由应用程序委托以外的对象（例如视图控制器）维护，则让该对象执行保存以响应通知可能更有意义。

有关更多详细信息，[这里是 iOS 4+ 中应用程序生命周期事件的一个很好的概述](http://www.cocoanetics.com/2010/07/understanding-ios-4-backgrounding-and-delegate-messaging/)。

* * *

(*) 请注意，如果**a** ) 您正在使用一种受支持的后台执行模式，例如播放音频或 VoIP 服务，b) 您的应用程序是为 4.0 之前的 SDK 编译的，或者 c) 您已经在您的 Info.plist 中设置`UIApplicationExitsOnSuspend`密钥。`YES`但是，最后一个选项意味着您放弃了暂停/恢复功能的好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:34:49.563

我认为您应该在“applicationWillEnterBackground”方法中编写这些代码，因为当应用程序在后台并且用户将其杀死时，您在 applicationWillTerminate 中的代码可能无法正常工作。

# .net - 如何对集合的多层进行数据绑定？

> ID：10076114
> 
> 赞同：0
> 
> 时间：2012-04-09T16:12:31.540
> 
> 标签：.net, wpf, windows-phone-7, data-binding, wpftoolkit

认为：

```
<manufacturer name="A">
  <phone>1</phone>
  <phone>2</phone>
</manufacturer>
<manufacturer name="B">
  <phone>3</phone>
  <phone>4</phone>
</manufacturer> 
```

是否有一种巧妙的方法将其数据绑定到 ItemsSource，以便将所有电话显示为 1、2、3、4？如果我只是使用 Expression Blend 生成它，它会给出

```
DataContext="{Binding manufacturerCollection[0].phoneCollection}" 
```

它只给出 1、2。更好的是，有没有办法在 WP7 Silverlight Toolkit 的 ListPicker 中对它们进行分组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:17:06.057

您可以创建一个新属性并使用 Linq 来“扁平化”您的集合，而不是绑定到制造商集合：

```
public IEnumerable<Phone> Phones { get { return manufacturerCollection.SelectMany(m => m.phoneCollection); }} 
```

（用 phoneCollection 中存储的对象类型替换“Phone”）

# sql-server-2008 - 如何显示使用 .bat 安装 SQL 2008 时出现的错误？

> ID：10076115
> 
> 赞同：0
> 
> 时间：2012-04-09T16:12:44.963
> 
> 标签：sql-server-2008, error-handling, batch-file, command

我正在尝试使用基于此处列出的命令安装 SQL Server 2008 Express 的 .bat：http: [//msdn.microsoft.com/en-us/library/ms144259.aspx](http://msdn.microsoft.com/en-us/library/ms144259.aspx)

我遇到的问题是，无论它安装成功还是安装失败，无论哪种方式，它都会关闭命令提示符框而根本没有任何信息。我必须检查服务列表以查找我刚刚运行的安装的活动实例，以验证它是否有效。我在 .bat 脚本的末尾添加了一个“暂停”命令，至少让它保持命令提示符窗口打开，但如果它出错或成功，它不会给我任何信息。

有没有办法让它打印到日志，或者在出现错误时打印到命令提示符屏幕（如果是这样，或者在安装的哪个部分），或者如果它安装成功？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:53:14.457

您应该检查错误级别。如果出现问题，我认为 SQL Server 将返回错误级别：[http ://www.robvanderwoude.com/errorlevel.php](http://www.robvanderwoude.com/errorlevel.php)

# c# - 如何在 C# 中使用 OnPaint 事件？

> ID：10076116
> 
> 赞同：5
> 
> 时间：2012-04-09T16:12:50.940
> 
> 标签：c#, events, onpaint

我在网站上看到了一些类似的问题，但没有一个真的对我有帮助。

我有一个函数，当单击一个按钮时，它会在表单上绘制几行，这些行的形状取决于用户在某些文本框中输入的值。

我的问题是，当我最小化表单时，线条消失了，我明白这可以通过使用 OnPaint 事件来解决，但我真的不明白如何。

谁能给我一个简单的例子，使用 OnPaint 事件按下按钮，使用函数绘制一些东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T16:14:45.060

[给你](http://msdn.microsoft.com/en-us/library/b818z6z6%28v=vs.71%29.aspx)，简单的关于用户绘制控件的 MSDN 教程

您必须继承`Button`类并覆盖 OnPaint 方法。

代码示例：

```
protected override void OnPaint(PaintEventArgs pe)
{
   // Call the OnPaint method of the base class.
   base.OnPaint(pe);

   // Declare and instantiate a new pen.
   System.Drawing.Pen myPen = new System.Drawing.Pen(Color.Aqua);

   // Draw an aqua rectangle in the rectangle represented by the control.
   pe.Graphics.DrawRectangle(myPen, new Rectangle(this.Location, 
      this.Size));
} 
```

**编辑：**

将属性添加到您的类并喜欢并在您的方法`public Color MyFancyTextColor {get;set;}`中使用它。`OnPaint`此外，它还会出现在 Visual Studio 表单设计器的控件属性编辑器中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T16:22:28.687

您可以将负责（重新）绘制场景的所有代码编写到`Paint`事件发生时调用的方法中。

因此，您可以注册要在 Paint 发生时调用的方法，如下所示：

```
this.Paint += new PaintEventHandler(YourMethod); 
```

然后，每当需要重绘表单时，就会调用 YourMethod。

还要记住，您的方法必须具有与委托相同的参数，在这种情况下：

```
void YourMethod(object sender, PaintEventArgs pea)
{
   // Draw nice Sun and detailed grass
   pea.Graphics.DrawLine(/* here you go */);
} 
```

## 编辑

或者，如另一个答案中所述，您可以覆盖`OnPaint`方法。然后你不必关心用你自己的方法添加事件处理程序。

# wordpress - 无法在 wordpress 中的 functions.php 中调用 $wpdb

> ID：10076120
> 
> 赞同：6
> 
> 时间：2012-04-09T16:12:59.340
> 
> 标签：wordpress

我试图在我的主题的functions.php中查询数据库，但它显示

> 致命错误：在 .../functions.php 中的非对象上调用成员函数 get_results()

我想知道我做错了什么。任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-09T16:20:27.960

`global $wpdb;`在您的查询之前尝试

# java - 针对 XSD java 验证 XML

> ID：10076121
> 
> 赞同：0
> 
> 时间：2012-04-09T16:13:02.417
> 
> 标签：java, xml, xsd

使用 Xerces，我收到以下错误：

```
Parsing error:  Document is invalid: no grammar found.
Parsing error:  Document root element "TXLife", must match DOCTYPE root "null". 
```

我已经通过设置解决了这个问题

```
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://ACORD.org/Standards/Life/2 file:///C:/Users/Himanshuy/workspace/XMLUnit/TXLife2.26.00.xsd" xmlns="http://ACORD.org/Standards/Life/2" 
```

但是现在当我将 SAXParser 与 XMLSpy 验证错误进行比较时，它给出了不正确的验证错误。SAXParser 给我：

```
Invalid content was found starting with element <element> 
```

XMLSpy 告诉我：

```
<element> is not allowed at this location under element <some_parent_element> 
```

这里 XMLSpy 是正确的。

如何从 Java Validation 获得相同的结果？

# jquery - jQuery - css 活动

> ID：10076123
> 
> 赞同：1
> 
> 时间：2012-04-09T16:13:13.300
> 
> 标签：jquery, css, menu

`enter code here`我对 jquery 有很大的问题。当我单击菜单中的一个链接时，它应该处于活动状态（例如黄色），其他链接应该与原始链接相同（例如：黑色）。下面是我的 css：

```
.graphite .menuBar {font: bold 12px Arial, sans-serif; border-top: 1px solid #111; border-right: 0px solid #111; border-left: 1px solid #111; display:table-cell;}
.graphite .menuBar a {padding: 8px 15px 8px 15px; background: #0C0C0C url(images/bg_black.png) repeat-x 0 -1px; text-decoration:none; display: block; color: #ddd; border-bottom: 1px solid #222; border-top: 1px solid #777; position: relative;}
.graphite .menuBar div {background: #0078AE;}
.graphite .menuBar a:hover {background: #006599; color: #fff;}
.graphite .menuBar .highlight { background:#006599; color: #fff; } 
```

在jquery方面：

```
$('div.menuBar > a').click().addClass(""); //To the original tabs
$('a[id="Clients"]').each(function () { //when click in tab Clients
    $(this).addClass("highlight");
});
$('a[id="supplier"]').each(function () { //when click in tab supplier
    $(this).addClass("highlight");
}); 
```

我的意思是当我单击客户端选项卡时，它应该与类 (.Highlight)

如果您单击选项卡供应商应该与类（.Highlight 活动）和原始类的其他选项卡。可能吗？:...升级：菜单在这个页面上：Header.cshtml

```
@model MWA.ViewModels.HeaderViewModel
@if (Request.IsAuthenticated && (Model.message == "" || Model.message == null)){
using (Html.BeginForm("updateLanguage", "Header", FormMethod.Post, new { id = "headerForm" })){
<input type="hidden" id="hdOrga" name="hdOrga" value="@Model.Orga.orgaID" />
<input type="hidden" id="hdUtzID" name="hdUtzID" value="@Model.User.userID" />
<div class="div-table-header"> 
    <div class="div-table-header-row">
        <div class="div-table-header-col" style="width:5%; padding-left:10px">@MWA.Resources.Shared._Header.Orga:  </div>
        <div class="div-table-header-col" style="width:40%"><strong>@Model.Orga.orgaName</strong></div>
        <div class="div-table-header-col-right" style="width:55%">@MWA.Resources.Shared._LogOnPartial.Heading, <strong>@Html.ActionLink(@User.Identity.Name, "SignOut", "Account") </strong></div>
        <!--div class="div-table-header-col-right" style="width:10%;">@Html.ActionLink("SignOut", "SignOut", "Account")</div-->      
    </div>
    <div class="div-table-header-row">
        <div class="div-table-header-col" style="padding-left:10px">@MWA.Resources.Shared._Header.Comp:  </div>
@{  if (Model.Companies.Count() == 1)
    { 
        <div class="div-table-header-col"><strong>@Model.Companies.FirstOrDefault().companyName</strong></div>
    }
else
    {
        <div class="div-table-header-col"> @Html.DropDownListFor(x => x.selectedCompany, new SelectList(Model.Companies, "companyID", "companyName"))  </div>
    } 
}
        <div class="div-table-header-col-right">@MWA.Resources.Shared._LogOnPartial.Lang: @Html.DropDownListFor(x => x.selectedLanguage, new SelectList(Model.Languages, "lang", "langName", Model.selectedLanguage))</div>
    </div>
</div>
<div class="div-table-header"> 
    <div class="div-table-header-row-menu">
        <div class="div-table-header-col-menu">
            <div class="graphite">
                @foreach (var app in Model.Appl)
    {
                <div class="menuBar">@Html.ActionLink((string)app.applicationName, "Index", (string)app.controler, new { app = app.applicationID }, new { id = (string)app.applicationName })</div>
    }
            </div>
        </div>
    </div>
</div>
}   <!--Html.BeginForm-->
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:21:47.110

这应该这样做

```
$('div.menuBar').on('click','.menuBar > a', function(){
  $(this).addClass('highlight').siblings('a').removeClass('highlight');
}) 
```

演示在[http://jsfiddle.net/gaby/KCN5K/](http://jsfiddle.net/gaby/KCN5K/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:30:47.380

**jQuery：**

```
$('div.menuBar > a').click(function(){
   $('.highlight').each(function(){ $(this).removeClass('highlight') });
   $(this).addClass('highlight');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T16:15:44.207

每个锚的 ID 应该是唯一的。我建议根据您的 html 选择它。

例如

```
$('.menubar a').click(function (e) { //when click in tab Clients
    e.preventDefault();
    $('.menubar a').removeClass("highlight");
    $(this).toggleClass("highlight");    
}); 
```

# android - 如何在android中打开链接？

> ID：10076129
> 
> 赞同：1
> 
> 时间：2012-04-09T16:13:47.960
> 
> 标签：android, url

您好我正在写这个应用程序，我需要打开一个 URL。如何在android中完成？是像打开一个 HttpClient 还是什么的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T18:25:51.353

好的，所以基本上我假设你将一些参数发送到一个特定的 URL，在那里它们被处理并返回结果。在这种情况下，最好的方法是使用 DefaultHttpClient 以 json 格式将数据发布到 URL。[这个](http://fahmirahman.wordpress.com/2011/04/21/connection-between-php-server-and-android-client-using-http-and-json/)例子是你应该看的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:18:05.230

关于从链接 textview 打开 url 的示例

```
private void setAsLink(TextView view, String url){
    Pattern pattern = Pattern.compile(url);
    Linkify.addLinks(view, pattern, "http://");
    view.setText(Html.fromHtml("<a href='http://"+url+"'>http://"+url+"</a>"));
} 
```

# vb.net - VB.net DataTable 选择语句

> ID：10076132
> 
> 赞同：0
> 
> 时间：2012-04-09T16:14:17.340
> 
> 标签：vb.net

我有一个数据表，我想从此表中获取 MAX 数，其中术语号（第一列）是某个值。如果我的数据表被声明为 dtMyTable，我假设我需要使用 dtMyTable.Select()，但我不确定这是否是最好的方法。任何帮助将不胜感激。

问候，

马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:33:31.093

`dtMyTable.Select()`看起来你正在使用 Linq，所以为什么不`dtMyTable.Where(<term number is a certain value>).Max(<column you want max value of>)`

Linq 有一个内置的[Max()](http://msdn.microsoft.com/en-us/library/bb535031.aspx)函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:32:07.807

一种选择是使用 LINQ：

```
'Assumes integer and a default of 0.
Dim intMax As Integer = 0

'Filter the list by the "Certain Value" of the first column.
Dim lstFilteredRows As List(Of DataRow) = (From dr As DataRow In dtMyTable _
                                           Where dr.Item(0) = "CertainValue").ToList()

'Get the max value by looping through the filtered list.
lstFilteredRows.ForEach(Sub(dr As DataRow)
                            If CInt(dr.Item("ColumnNameWithMaxValue")) > intMax Then
                                intMax = CInt(dr.Item("ColumnNameWithMaxValue"))
                            End If
                        End Sub) 
```

# ajax - 运行通过 ajax 加载的谷歌可视化（javascript）

> ID：10076133
> 
> 赞同：1
> 
> 时间：2012-04-09T16:14:20.687
> 
> 标签：ajax, jquery, google-visualization

长期聆听者，第一次来电者。不太擅长ajax。大概我在这里做一些非常密集的事情：

尝试运行从 ajax 响应返回的 html 的 google 可视化，但即使我可以在 firebug 的 xhr 响应中看到代码，从 ajax 页面加载时它也不会运行。

直接访问 response2.php?var=X ，它工作得很好，所以大概输出的代码本身没有问题。

（我已经在 ajax 页面的标题和 response2.php 之间移动了 jsapi 和 google.load(visualization)，但都没有成功）

**ajax 调用**

```
$.ajaxSetup ({
    cache: false
});

$.ajax ({
    type: "GET",
    url: "return2.php",
    data: "council=Leeds City Council",
    dataType: "html",
    success: function (responseText) { 
      document.getElementById('result').innerHTML = responseText;
    }
}); 
```

**返回2.php**

```
<?php
$docKey = "0Aqk6sC3LBlfjdHUxRDIycjlSM3NvX0JCWnhxUjRUbFE";
$docQuery = $_GET['council'];
?>
<script type="text/javascript">
function drawVisualization() {
google.visualization.drawChart({
   "containerId": "councilViz",
   "dataSourceUrl": "http://spreadsheets.google.com/a/google.com/tq?key=<?php echo   $docKey; ?>",
   "query":"SELECT A,B,C WHERE A CONTAINS '<?php echo $docQuery; ?>'",
   "chartType": "Table",
   "options": {
      "width": 560,
      "height" : 200
   }
 });
}
google.setOnLoadCallback(drawVisualization);
</script>
<div id="councilViz">
<?php echo $docQuery; ?>
</div> 
```

response2.php 获取 GET 变量，运行 google 电子表格 api 查询并返回以下代码：

**阿贾克斯响应**

```
<script type="text/javascript">
  function drawVisualization() {
    google.visualization.drawChart({
   "containerId": "councilViz",
   "dataSourceUrl": "http://spreadsheets.google.com/a/google.com/tq?key=0Aqk6sC3LBlfjdHUxRDIycjlSM3NvX0JCWnhxUjRUbFE",
   "query":"SELECT A,B,C WHERE A CONTAINS 'Leeds City Council'",
   "chartType": "Table",
   "options": {
      "width": 560,
      "height" : 200
   }
 });
  }
  google.setOnLoadCallback(drawVisualization);
</script>
<div id="councilViz">
Leeds City Council</div> 
```

尽我所能，当代码被ajax调用时，我无法绘制表格。我可以看到结果，但可视化脚本中什么也没有。

非常感谢，

一个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:21:37.333

您需要创建 div 以将返回的 html 插入其中，使用 .innerHTML 将您的 html 插入该 div。

然后使用 .appendChild 将 div 附加到 dom 中的目标。

通过设置元素的 innerHTML 属性添加的脚本不会被执行。

```
函数 addScript(responseText)

    {
        var newdiv = document.createElement('div');
        newdiv.innerHTML = 响应文本；
        document.getElementById('target').appendChild(newdiv);
    }

```

# iphone - 是否可以在 iOS 上自定义推送通知

> ID：10076139
> 
> 赞同：0
> 
> 时间：2012-04-09T16:14:39.537
> 
> 标签：iphone, objective-c, ios, ipad, push-notification

我在很多地方读到无法自定义推送通知警报...但是想知道，NDTV，“会说话的汤姆”等应用程序如何能够使用自定义通知...

我不是推送通知方面的专家，所以如果我的问题是错误的，请原谅...

由于我是该组的新成员，因此我不允许上传图像...我提到的通知类似于以下内容： [http://cdn.imore.com/images/stories//2011/10/ios_5_iphone_notification_center_lock_screen_single。 PNG](http://cdn.imore.com/images/stories//2011/10/ios_5_iphone_notification_center_lock_screen_single.png)

谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T12:48:09.583

您提供的图片是 iOS 5 中的标准通知。像这样的通知将显示为警报，如您所示，或在通知中心。您不需要做任何特别的事情来让您的应用程序的图标包含在推送中。这里唯一的“自定义”是通知中提供的内容（在你的图片的情况下，谁发了推文以及推文是什么）。

此外，从状态栏中的“ROGERS”来看，这可能是越狱设备，在这种情况下，标准规则不一定适用。

# mysql - EC2 中的 MySQL、Glassfish 和 JPA 在 localhost 中有效，但在生产环境中无效

> ID：10076144
> 
> 赞同：0
> 
> 时间：2012-04-09T16:15:21.463
> 
> 标签：mysql, jpa, amazon-ec2, glassfish

我在 EC2 中有一个微型实例，所以我在那里安装了 MySQL 服务器和 Glassfish 3 开源版本，然后我`users`在 MySQL 中创建，这样我就可以进行选择、插入、删除等操作。

正如您在此处看到的（我正在使用 MySQL Workbench 来执行此操作）： ![在此处输入图像描述](../Images/7ba25934fa0ffd66223802fc3d4d9be4.png) ![在此处输入图像描述](../Images/275dc6c9759db194ba5351f212d1e06d.png) ![在此处输入图像描述](../Images/55e53778861b36b5a855970828f97d97.png) ![在此处输入图像描述](../Images/4b7c2ed679a2366f82a7eefd33f4e4e9.png) ![在此处输入图像描述](../Images/b96744a22b1b216a559e54bf087c7d55.png)

我在 Glassfish 中创建了一个 DataSourcePool：

![在此处输入图像描述](../Images/b00eb97960d2ffa2245bf72366fbafe2.png) ![在此处输入图像描述](../Images/7b0cab98d2baba0e4b75b7e981fd76e3.png)

这个ConnectionPool在'localhost'中使用用户'root'，奇怪的是：在localhost中一切正常但是当我进行部署并尝试执行它时，没有任何反应，甚至没有一个异常，`server.log`从`glassfish`为空白。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T17:15:35.920

当您在连接池设置屏幕上收到 Ping Succeeded 消息并且在日志文件中没有收到任何内容时，这表明问题不在于您的数据源设置。我可以想到以下事情：

1.  可能是应用程序未正确部署。您在部署时是否看到任何错误？
2.  任何一个应用程序都没有收到任何请求？
3.  如果应用程序正在获取请求，则持久性单元不会收到任何负载请求。
4.  可能是您的日志文件的处理被搞砸了，这就是为什么您没有看到当前日志文件中的任何内容。您是否看到与任何其他活动相对应的日志语句？如果没有，请尝试重新启动服务器一次。

毫无疑问，您可能已经检查了上述许多内容。如果没有，那就试试看。

我看到您正在做正确的 MySQL 设置，但您可以按照我在以下帖子中的建议重新确认几件事： [Connect to mysql on Amazon EC2 from a remote server](https://stackoverflow.com/questions/9766014/connect-to-mysql-on-amazon-ec2-from-a-remote-server/9794879#9794879)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:55:10.503

您没有显示屏幕截图，但我会检查 JDBC 资源部分。IIRC，您需要有从持久性单元到池的 JNDI 映射，否则无法访问池。

奇怪的是，我仍然希望 JNDI 查找失败或其他一些 JPA 异常会出现某种异常。您在部署时遇到任何错误吗？

我唯一的另一个问题是你是如何确定什么都没有发生的？我假设您的 UI 是某种网页。当您尝试加载页面时会发生什么？

# sql-server - 将另一个表中的字段添加到复杂查询

> ID：10076147
> 
> 赞同：0
> 
> 时间：2012-04-09T16:15:30.693
> 
> 标签：sql-server, sql-server-2005

我有以下查询，它返回一个结果集，其中包含问题、这些问题的可能答案以及用户选择每个答案的次数：

```
SELECT  sq.question_id, sq.question_text, qo.question_option_id, qo.option_text, G.Total
FROM    dbo.survey_question sq
LEFT OUTER JOIN dbo.question_option qo 
ON sq.question_id = qo.question_id
LEFT OUTER JOIN
(SELECT ra.question_id, ra.question_option_id, count(*) AS Total
 FROM dbo.form_response_answers ra
 GROUP BY ra.question_option_id, ra.question_id ) G
    ON G.question_id = sq.question_id AND G.question_option_id = qo.question_option_id
ORDER BY
sq.question_id 
```

在这些记录中的每一个上，我都需要为 form_id 添加一个列，该列位于名为 form_question 的表中。form_question 表还包含一个 question_id 字段，该字段应与上面查询中显示的 question_id 字段匹配。但是，我在尝试添加它时遇到了很多麻烦，因为我仍在为我的查询而苦苦挣扎。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:28:35.020

更改在评论中。

```
SELECT  
    sq.question_id
    , sq.question_text
    , qo.question_option_id
    , qo.option_text
    , G.Total
-- ==================================================
    , fq.form_id
-- ==================================================
FROM dbo.survey_question sq
LEFT OUTER JOIN dbo.question_option qo 
    ON sq.question_id = qo.question_id
LEFT OUTER JOIN
(
    SELECT 
        ra.question_id
        , ra.question_option_id
        , count(*) AS Total
    FROM dbo.form_response_answers ra
    GROUP BY ra.question_option_id
        , ra.question_id 
) G
    ON G.question_id = sq.question_id 
    AND G.question_option_id = qo.question_option_id
-- ==================================================
-- Switch this to LEFT JOIN if there is a chance that
-- there won't be a form_question result for your
-- survey_question record.
-- Also, if there are multiple form_question records
-- for a survey_question, you might get more rows than
-- you're looking for.
INNER JOIN dbo.form_question fq
    ON fq.question_id = sq.question_id
-- ==================================================
ORDER BY sq.question_id 
```

# android - PhoneGap：有没有办法阻止键盘调整视图大小？

> ID：10076148
> 
> 赞同：13
> 
> 时间：2012-04-09T16:15:33.113
> 
> 标签：android, cordova, keyboard

我目前正在将 PhoneGap 用于我正在开发的移动应用程序。在我的登录屏幕中，当我选择一个文本字段时，当键盘向上滑动时，视图会水平缩小。这只发生在安卓而不是iOS上。

这让我很担心，因为我有一个底部工具栏，`position:absolute; bottom:0;`当键盘出现时，这个工具栏会在 Android 中向上推。在 iOS 中，键盘只是简单地覆盖它。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-31T12:40:18.490

在`AndroidManifest.xml`您的主要活动中添加以下内容：

```
android:windowSoftInputMode="adjustPan" 
```

和

```
android:configChanges="orientation|keyboardHidden" 
```

添加外伤`index.html`指出的内容：

```
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, target-densityDpi=device-dpi" /> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-11-01T08:15:14.073

在[Eu Vid 的回答](https://stackoverflow.com/a/11740286/1471258)之上，我想指出 Cordova 6.4.0 及更高版本支持[`<edit-config />`](http://cordova.apache.org/docs/en/latest/plugin_ref/spec.html#edit-config)我们可以用来修改`AndroidManifest.xml`。

首先，您需要添加 android 命名空间属性。在您的`config.xml`中，添加一个新属性`xmlns:android="http://schemas.android.com/apk/res/android"`到`<widget />`. 您的小部件块应如下所示：

```
<widget
    id="com.my.app"
    version="0.0.1"
    xmlns="http://www.w3.org/ns/widgets"
    xmlns:cdv="http://cordova.apache.org/ns/1.0"
    xmlns:android="http://schemas.android.com/apk/res/android"> 
```

*现在在里面* 添加以下代码`<widget />`：

```
<edit-config file="AndroidManifest.xml" mode="merge" target="/manifest/application/activity">
    <activity android:configChanges="orientation|keyboardHidden" android:windowSoftInputMode="adjustPan" />
</edit-config> 
```

现在，当您调用 时`cordova platform add android`，`AndroidManifest.xml`将使用上述设置生成 。

笔记：

*   上面的代码不会覆盖`<activity>`块而是与之合并；它只会替换指定的 xml 属性。
*   如果您之前已经调用`cordova platform add android`过，您可以先输入删除它，`cordova platform rm android`然后再添加它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T17:49:08.090

添加

```
 <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, target-densityDpi=device-dpi" /> 
```

到你的头牌

# fitnesse - 健身 csv 文件

> ID：10076150
> 
> 赞同：0
> 
> 时间：2012-04-09T16:15:34.240
> 
> 标签：fitnesse

我正在尝试在一个执行 csv 文件验证的模块上进行 Fitnesse，例如检查文件是否具有读取权限、格式正确以及是否具有列和数据。我见过通常与特定数据输入一起使用的fitnesse，例如用户名/密码或数学方程式。只是想知道，使用 Fitnesse 进行 csv 文件验证仍然是一个好主意吗？我认为您可以使用查询将 csv 文件加载到 Fitnesse，但不确定 Fitnesse 将如何适应权限检查等。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:09:40.467

这里的大部分工作将是构建夹具。像这样的东西

```
class CSVFileValidatorFixture {
  CSVFileValidatorFixture(String filename) {
  bool fileExists()
  bool fileIsValid()
  string readCell(int row, int column)
  // ...
} 
```

适用于苗条风格的测试

# android - 安卓的实时交通信息

> ID：10076151
> 
> 赞同：0
> 
> 时间：2012-04-09T16:15:35.193
> 
> 标签：android, api, rss, feed, traffic

我想知道是否存在任何可以离线使用的瑞典实时交通 rss 提要或 api？就像我们有一个本地 xml 并且每次我们上网时 xml 文件都会更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:36:32.187

简单地通过google我找到了这个网站：[http](http://www.trafiklab.se/) ://www.trafiklab.se/ 一些API的支持XML和JSON格式的数据下载。

# winforms - 从两个组合框中选择特定的访问表单

> ID：10076155
> 
> 赞同：2
> 
> 时间：2012-04-09T16:16:01.040
> 
> 标签：winforms, forms, ms-access, ms-access-2007

我有一张包含许多列的机械物品表。为了让用户输入特定信息时不会混淆，我根据表格中的类型和子类型字段将列分成了一些表格。例如 type1 和 subtype1 有特定的列，它们以 type1-subtype1 形式保存，type2 和 sub-type2 以 type2-subtype2 形式保存，依此类推。**我一共有5种类型和5种亚型，所以我一共有25种形式。**如图所示，我在新表单中使用了两个组合框作为类型和子类型，**我想从类型组合中选择类型，从子类型组合中选择子类型，当我单击打开表单按钮时，它应该显示相应的表单**.![在此处输入图像描述](../Images/8b461ef1782614dedf2a357206def03c.png) 例如，如果用户从 type combo 中选择 type5，从 subtype combo 中选择 subtype3，则应该显示 type5-subtype3 表单，以此类推所有 25 个表单。我尝试围绕打开表单按钮的 [on click] 嵌入宏进行操作，但徒劳无功。是否有可能在访问中以这种方法执行此操作，或者请建议一种方法。这对我很有帮助。非常感谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:32:49.053

*EDIT*将组合框属性从**Selected**更改为**Value**

有时会受到限制，不会让您将属性设置为字符串。看起来这可能是其中一种情况。如果是这样，您始终可以使用 Visual Basic（“代码生成器”）而不是嵌入的宏。在 Click 处理程序中，如下所示：

```
Dim formName As String
formName = type.Value & "-" & subtype.Value
DoCmd.OpenForm formName 
```

# spotify - Spotify - 跳到下一首/上一首歌曲按钮是灰色的

> ID：10076156
> 
> 赞同：1
> 
> 时间：2012-04-09T16:16:10.993
> 
> 标签：spotify

有没有一种方法可以在 Spotify 界面中以编程方式启用/禁用跳到下一个/上一个按钮？

现在，它们都显示为灰色。我希望让用户能够移动到下一首歌曲。

任何信息，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:46:44.267

*按钮显示为灰色的原因是*因为没有下一首歌曲 - 当您告诉客户端在 Apps API 中播放单曲时，它实际上意味着只有单曲。

无法直接从 Apps API 控制播放控制按钮的状态 - 当有更多曲目要播放时，这些按钮将被启用。

# event-handling - EXTJS 火灾事件

> ID：10076157
> 
> 赞同：2
> 
> 时间：2012-04-09T16:16:16.400
> 
> 标签：event-handling, extjs3

在 Ext.panel 组件中，有一个名为 expand(Ext.panel p) 的事件。

现在我有 2 个面板，A 和 B。要求它们都应该一起展开和折叠。因此，当我扩展 A 时，我还需要为 B 触发“扩展”事件。这应该反过来触发 B 的事件处理程序。所以语法（请帮助我）：

```
A.on('expand', userPanelExpand)//event handler for A that performs some logic 
```

现在如何为 B 添加一个 fireEvent('expand')？它应该是：

```
A.on('expand', userPanelExpand);
function userPanelExpand(){
//some logic
this.fireEvent('expand', this.B);
} 
```

这里有些不对劲。我在最后一行收到 Stackvoerflow 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:36:43.073

```
A.on('expand', userPanelExpand, this);
B.on('expand', userPanelExpand, this);

// this will not go into recursion because if panel is already expanded then expand event will not be fired if we call panel.expand()
function userPanelExpand(panel) {
   if(panel === A) {
      B.expand();
   } else {
      A.expand();
   }
} 
```

# python - Python：从 optparse 切换到 argparse

> ID：10076159
> 
> 赞同：7
> 
> 时间：2012-04-09T16:16:20.497
> 
> 标签：python, shell, command-line-arguments, argparse, optparse

从 optparse 切换到 argparse 后 - 我遇到了奇怪的错误。argparse 仅在不留空格的情况下解析 args：

```
myScript.py -oOpt 
```

或放一个等号：

```
myScript.py -o=Opt 
```

它不能正常工作：

```
myScript.py -o Opt 
```

这是我的 argparse 初始化：

```
#!/usr/bin/env python
# to get description use the -h flag

import argparse, os, sys

# ======================
# Python2.7 is expected:

if sys.version_info[0] != 2 or sys.version_info[1] < 7:
    sys.exit('This program needs Python2.7+')

# ==========
# preambule:

desc = """Enter dirs in the current dir and makes gro out of state.cpt there."""
# parser = argparse.ArgumentParser()
parser = argparse.ArgumentParser(description=desc, version='2.3', formatter_class=argparse.ArgumentDefaultsHelpFormatter)
parser.add_argument('-w', '--workWith',
                    help = 'to specify a Gromacs exec suffix', 
                    dest = 'wW',
                    action = 'store',
                    default = '-4.5.5-single',
                    )
parser.add_argument('-g', '--gro',
                    help = '.gro postfix: <nameOfTheDir><postfix>.gro', 
                    dest = 'myGroPostfix',
                    action = 'store',
                    default = "_membrane",
                    )
parser.add_argument('-H', '--here',
                    help = 'toggles - single (current) dir behaviour (the output will be state.gro)', 
                    dest = 'Here',
                    action = 'store_true',
                    )
parser.add_argument('-D', '--dirs',
                    help = 'include these dirs (python\'s rgxp in SINGLE quotes), defaults to \'\'', 
                    dest = 'inclDirs',
                    action = 'store',
                    default = '',
                    )

args = parser.parse_args()

print args.wW 
```

**编辑**：

更：

```
 gmx_bk-simulate-mems.py -j bk-runs-mpi.bash -p 1 -w="-4.5.5-double_non-parallel_gcc" 2&> ../`date +%Y-%b-%d-%H%M%S`.log & 
```

给出：

```
 gmx_bk-simulate-mems.py: error: unrecognized arguments: 2 
```

它看起来像`argparse`对待`2&>`选项（或`2&>`选项`../date +%Y-%b-%d-%H%M%S.log`）！

**编辑 2**：

所以总结一下：

*   For `argparse`-`"-4.5.5-double_non-parallel_gcc"`是一个错误的选项名称 - 这就是为什么它需要写为 as `-w="-4.5.5-double_non-parallel_gcc"`。对于`optparse`和`bash`（！）这很好。`bash`甚至给出错误`-w="-4.5.5-double_non-parallel_gcc"`- 它认为 arg 是`="-4.5.5-double_non-parallel_gcc"`(!);

*   没有这样的事情`2&>`。`2>`应该可以使用并且它没有给出错误；

*   这是`shell`谁将行拆分为 args，而不是`python`;

*   `argparse`比`optparse`。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T14:36:05.573

首先，有必要做一个小的区分。该`argparse`模块不会解析您的命令行参数，而 shell 会。shell 负责将您在 shell 中键入的行转换为标记，然后将其传递给`sys.argv`python 数组/命令行参数序列。该`argparse`模块简单地理解出现在`sys.argv`.

这种区别将澄清您注意到的两个“错误”。首先，考虑`-w "-4.5.5-double_non-parallel_gcc"`（注意缺少等号）。shell 将这两个标记解析为`-w`和`-4.5.5-double_non-parallel_gcc`，并将这两个字符串传递给 sys.argv。没有等号，这似乎是两个选项：（`-w`没有参数）和`-4`作为`.5.5-double_non-parallel_gcc`参数。您需要等号，以便将所有内容都解析为单个标记。

**编辑部分**

至于`2&>`， argparse 无法控制给定标记是否被视为参数。如果 sys.argv 中出现某些内容，则意味着您的*shell*将其视为参数。

这里的标志是错误消息。请注意，消息不是`unrecognized arguments: 2&>`，而是`unrecognized arguments: 2`。您的 shell 将“&>”识别为输出重定向，并相应地解析该行的其余部分（包括日志文件）。唯一传递的参数是“2”，因为`2&>`它不是真正的重定向类型。（`&>`已经涵盖了 stderr 和 stdout，那么要`2`添加什么？）

在评论中，您声称`optparse`可以“处理”“2&>”。实际上并非如此。该`optparse`模块确实做了什么`argparse`，但`optparse`没有像`argparse`做的那样验证位置参数。事实上，`optparse`是让一个真正的编程错误（在这种情况下，`2&>`用作一种 shell 重定向）在未被检测到的情况下溜走！您应该发布原始 optparse 代码，但我怀疑您按如下方式解析了参数：

```
opt, args = parser.parse_args() 
```

你的脚本没有位置参数，所以我想你之后什么也没做`args`。但是，如果您要检查`args`，您会发现这`2`被认为是位置参数！

一般来说，如果脚本不接受位置参数并且您使用`optparse`，最好验证您是否收到位置参数，如下所示：

```
opt, args = parser.parse_args()
if args:
    parser.error("script takes no positional arguments") 
```

该`argparse`模块为您完成了这项工作，这使它领先了几英里`optparse`（除其他原因外）。

# database - Preventing deadlock in a mock banking database

> ID：10076160
> 
> 赞同：2
> 
> 时间：2012-04-09T16:16:23.560
> 
> 标签：database, multithreading, deadlock, semaphore

This is a mock bank database problem involving deadlock. I already have what I think is the answer, but I'm curious if this is a good solution. The question posed is the following:

How do you prevent deadlock in the following code?:

```
void transaction(Account from, Account to, double amount)
{
    Semaphore lock1, lock2;
    lock1 = getLock(from);
    lock2 = getLock(to);

    wait(lock1);
       wait(lock2);

          withdraw(from, amount);
          deposit(to, amount);

       signal(lock2);
    signal(lock1);
 } 
```

The way this can become deadlocked is via two threads (or processes?) calling the transaction() method at the same time with opposing accounts, i.e.:

transaction(savings, checking, 1); in thread 1 and

transaction(checking, savings, 2); in thread 2.

From my poor understanding, I think what is going on and why it is getting deadlocked is because the lock ordering is not obeyed since both threads are trying to get a lock (from each other?).

My quick and dirty solution would be to move the locks outside of the function transaction() to where it would look like this when called:

```
 //somewhere in main
    Semaphore lock1, lock2;
    lock1 = getLock(from);
    lock2 = getLock(to);

    wait(lock1);
       wait(lock2);

       transaction(checking, savings, 2);

       signal(lock2);
    signal(lock1);
    //..... 
```

with transaction looking like this:

```
void transaction(Account from, Account to, double amount)
{
   withdraw(from, amount);
   deposit(to, amount);
} 
```

That way they can never be executed at the same time, since transaction is technically the critical section. If this were a java program, could you also use monitors by putting the word synchronized after void in the function declaration? Would that work? That seems like a smarter way to do it.

I also may not be understanding this at all, so feel free to school me, especially if my explanations are not accurate. Thanks.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:23:58.223

> I think what is going on and why it is getting deadlocked is because the lock ordering is not obeyed since both threads are trying to get a lock

The problem here is as you mention that one thread like do:

```
wait(fromLock);
   wait(toLock); 
```

while another might do:

```
wait(toLock);
   wait(fromLock); 
```

which might cause deadlock.

What you need to do is insure that they always lock in the same order. You could use the id of the account somehow to figure out the order of the locks:

```
if (from.id < to.id) {
   wait(fromLock)
     wait(toLock)
       transaction(checking, savings, 2);
     signal(toLock);
   signal(fromLock);
} else {
   wait(toLock)
     wait(FromLock)
       transaction(checking, savings, 2);
     signal(FromLock);
   signal(toLock);
} 
```

I believe that will resolve any deadlocks. You might also want to put a check for the `from` and `to` being the same entity.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T16:21:01.363

Separating this critical section into two sections:

```
void transaction(Account from, Account to, double amount)
{
    Semaphore lock1, lock2;
    lock1 = getLock(from);
    lock2 = getLock(to);

    wait(lock1);
          withdraw(from, amount);
    signal(lock1);

    wait(lock2);      
          deposit(to, amount);
    signal(lock2);
} 
```

will be the best solution in the real world, because **separating this critical section doesn't lead to any unwanted state** between them (that is, there will never be a situation, where there is more money withdrawn, than it is possible).

The simple solution to leave the critical section in one piece, is to **ensure that lock order is the same in all transactions**. In this case you can sort the locks and choose the smaller one for locking first.

For more detailed information about deadlock preventing in these situations see my question - [Multiple mutex locking strategies and why libraries don't use address comparison](https://stackoverflow.com/q/9814008/13767)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T16:42:55.390

No transaction should ever hold on to one lock while waiting for another. If it cannot obtain one of the locks that it needs, then it should release all the ones that it has acquired.

# database - 将 Split Access 2010 数据库发布到 Sharepoint

> ID：10076162
> 
> 赞同：0
> 
> 时间：2012-04-09T16:16:34.980
> 
> 标签：database, sharepoint, ms-access, database-design, sharepoint-2010

我的组织分配了一项任务，即获取当前拆分的 Access 数据库并将其发布到 Sharepoint 服务器。该数据库当前与驻留在网络共享上的后端（表、数据等）和前端进行拆分（表单、查询、报告等）分发给最终用户。

但是，由于网络问题，这变得低效，我们现在正在探索 Sharepoint 和 Access 服务。我最初的想法是将后端转换为与 Web 兼容的表格，并将后端单独发布到 Sharepoint 服务器。由于为前端创建的客户端对象不容易转换（如果有的话），我想我会将前端对象链接到我通过发布后端创建的 Sharepoint 列表。但是，我很难找到有关如何执行此链接的任何类型的文档。

以前有没有人处理过这个问题，或者有任何关于我将如何执行这个链接的信息，或者我是不是走错了路？

我选择这条路径是因为我认为考虑到当前的数据库设置，这将是最简单的，但我也考虑了其他路径，例如结合前端和后端或简单地创建新的 Web 兼容对象。我只是觉得简单地抛弃当前的前端并开始创建所有新的 Web 兼容表单、查询和报告是很浪费的。

任何帮助或反馈将不胜感激！

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:14:06.700

链接过程与链接到后端，甚至链接到 MySQL 的链接过程非常相似，这在 Access 中很常见。

如果您想/需要使用关系数据，那么您必须正确“连接”表。不幸的是，这意味着您经常必须重新创建与父表相关的 FK 列，并使用关系和查找向导替换该列，但这并不难。

在下面的视频中，我将逐步连接表以供关系使用，在此视频中，我还将采用基于标准客户端的应用程序并链接到已发布的表。那个视频在这里：

[http://www.youtube.com/playlist?list=PL27E956A1537FE1C5](http://www.youtube.com/playlist?list=PL27E956A1537FE1C5)

所以上面应该让您了解表链接的样子

编辑：编辑：

再补充一点，将 SharePoint 用于后端表与使用托管 SQL 服务器有一些优点和缺点。使用 SharePoint 的真正优势在于，连接和技术针对 Wi-Fi 进行了优化，甚至针对可能间歇性或中断的连接进行了优化。

我已经转换了一些应用程序，在这些应用程序中我保留了长时间的 VBA 代码和投资，但随后只是将后端数据上移到了 SharePoint。事实上，我使用 office 365 美元，而 p1 计划的起价为每月 6 美元，您可以这样做。将 5 台笔记本电脑送出办公室并让它们共享相同的后端数据的绝佳设置和低成本方式。

因此，您不必重新编写前端应用程序，但只要这些笔记本电脑中的任何一台具有互联网连接，您就可以随时随地共享数据。此外，如果您失去连接，应用程序将继续在断开模式下运行，直到您使用 Wi-Fi 到达该咖啡店或回到办公室并插入网络。

# facebook - 如何使用图形 API 从 Facebook 群组中检索照片？

> ID：10076163
> 
> 赞同：5
> 
> 时间：2012-04-09T16:16:35.377
> 
> 标签：facebook, facebook-graph-api

当我尝试从 Facebook 上的一个开放组中检索照片时，我得到一个空列表。

这个 URL [http://graph.facebook.com/275206825900621/photos](http://graph.facebook.com/275206825900621/photos)给了我一个空列表。我期待看到一个包含我上传到我的测试组的照片的列表。

```
{
   "data": [      
   ]
} 
```

问题可能与安全有关，但我没有收到任何访问错误。如果我从 URL 的末尾删除 /photos，我可以访问基本的公共信息[http://graph.facebook.com/275206825900621](http://graph.facebook.com/275206825900621)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-05T19:35:21.237

奇怪的是，如果您执行 /group_id/albums，它会检索组内的所有专辑，包括专辑 ID、名称、网址，甚至是该组专辑中的图像数量。但是，如果您随后使用该 album_id 并调用 /album_id/photos ，则它会返回空数据数组。

如果你可以做 /group_id/albums，那么组相册是有效的相册，因此调用 /photos 应该检索它的照片，就像它发生在普通相册中一样。

你想通了吗？

我刚刚尝试使用 FQL，我可以设法检索到有关团体专辑的大量信息，因此这意味着团体专辑只是一张普通专辑。

```
SELECT description, owner, photo_count, type, like_info, cover_pid, comment_info FROM album WHERE object_id = '1382173765340875'

{
  "data": [
    {
      "description": "10 Desafio Outros!!!", 
      "owner": 1455136613, 
      "photo_count": 8, 
      "type": "normal", 
      "like_info": {
        "can_like": true, 
        "like_count": 1, 
        "user_likes": true
      }, 
      "cover_pid": "6249764165120950711", 
      "comment_info": {
        "can_comment": true, 
        "comment_count": 0, 
        "comment_order": "chronological"
      }
    }
  ]
} 
```

2014 年编辑：我向 facebook 提交了一份错误报告，6 个月后我得到了回复：

他们说要检查图形 api 文档，我在那里我可以看到“组”对象和“专辑”或“照片”对象之间没有任何联系，所以我目前从查询中获得的任何额外信息都只是考虑漏洞..

啊! 我认为这只是一个错误，他们没有将群组链接到专辑，但无论如何......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:39:59.880

根据（https://developers.facebook.com/docs/reference/api/group/）上的文档，对象上没有“照片”连接`group`。但是，有一个`picture`联系。也许有一天 Facebook 会扩展他们的 API，为一个群组对象提供照片连接。

# c - 通过 poll select 或 epoll 了解 udp 数据包大小

> ID：10076165
> 
> 赞同：0
> 
> 时间：2012-04-09T16:16:45.263
> 
> 标签：c, linux, network-programming

我知道要在阅读之前找出 udp 数据包的大小，可以向内核发出这个系统调用：

```
ioctl(s,FIONREAD,&num_bytes); 
```

但是，我可以通过以下系统调用之一找到相同的结果吗？

```
poll()
select()
epoll() 
```

关键是在读取数据报之前知道它的大小，为缓冲区分配空间。这仅适用于 linux，在 C 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:33:15.360

多路复用系统调用喜欢[`poll`](http://linux.die.net/man/2/poll)或`select`期望观察一组条件（如输入在 fd #5 上可用，输出在 fd #7 上可用）并告诉您哪些文件描述符是可读的（哪些是可写的，等等）。一旦知道可以读取哪个文件描述符，就可以`ioctl(fd, FIONREAD, &numbytes)`在该可读文件描述符上使用您的`fd`。所以你应该同时使用`poll`，然后`FIONREAD` ......

# android - 编码（不解码）二维码的库

> ID：10076168
> 
> 赞同：-1
> 
> 时间：2012-04-09T16:16:47.793
> 
> 标签：android, qr-code

我了解 zxing 并且知道如何将其用作 jar，因此我不必使用意图方法。但...：

1.  Sean Owen，zxing 背后的开发者，显然[并不喜欢人们将它嵌入到他们的应用程序中](http://damianflannery.wordpress.com/2011/06/13/integrate-zxing-barcode-scanner-into-your-android-app-natively-using-eclipse/)，而是希望他们使用 Intent apporach，这在我看来真的会扼杀用户体验。
2.  我只需要编码部分。粗鲁地说：我想为 QR 码更改一些数据。无需扫描、解码等。
3.  它几乎使我的应用程序的大小增加了一倍，但这是最不重要的问题。

我用谷歌搜索了很长时间，但 zxing 似乎是迄今为止最受欢迎的解决方案，因为我没有发现其他任何东西。您是否知道其他一些库或只是一些准备使用的算法？我不想重新发明轮子...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:29:31.933

您可以使用此处提供的库： [http](http://www.swetake.com/qr/index-e.html) ://www.swetake.com/qr/index-e.html 最后一个链接会将您带到一个日本站点，您可以在其中下载 Java 库。它很旧，但它有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:22:08.990

如果您总是有互联网，一个选项是使用 Google 的 API 生成 QR 码。 [http://createqrcode.appspot.com/](http://createqrcode.appspot.com/)

示例（返回 png 图像）：[http ://chart.apis.google.com/chart?cht=qr&chs=300x300&chl=MESSAGE&chld=H|0](http://chart.apis.google.com/chart?cht=qr&chs=300x300&chl=MESSAGE&chld=H|0)

# c++ - 调用 ResetEvent() 时是否需要互斥或锁定？

> ID：10076169
> 
> 赞同：4
> 
> 时间：2012-04-09T16:16:49.103
> 
> 标签：c++, windows, multithreading

我继承了一些这样的代码：

```
m_mutex.Lock();
ResetEvent( m_hSyncObject );
m_mutex.Unlock(); 
```

相同的`SetEvent()`

在这种情况下，这些互斥锁是必需的吗？这些调用是否会表现自己，或者我可以摆脱锁吗？这个函数已经有一些我之前原子化的值 inc/decs，现在这些事件都在锁中，所以如果可能的话，摆脱它们将是一个巨大的胜利。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:19:54.250

这个额外的互斥锁几乎肯定是不需要的。和函数本身可以安全地从多个线程`ResetEvent`调用`SetEvent`

鉴于此代码确实存在，编写该代码的开发人员很可能不理解他们创建的线程语义。我会将任何取决于该逻辑的代码视为高度可疑的。从长远来看，它可能会为您节省一些时间来继续预先审核该代码以解决线程问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-06T17:30:06.517

警告程序员！

手动重置事件很难使用，并且可能需要您锁定设置和重置事件（自动重置事件可以更轻松地避免这些问题）。

考虑这段代码：

```
Worker() {
    WaitForSingleObject(hEvent);
    DoWork();
    ResetEvent(hEvent);
}

EventThread() {
    QueueWork();
    SetEvent(hEvent);
} 
```

*在 EventThread 发出信号后*，worker 可能会通过 racy interleaving 重置事件，这将导致 worker 在等待时挂起。要在这种情况下正确使用手动重置事件，您需要获取重置事件周围的锁，并通过重置事件原子地检查队列的状态。

自动重置事件让您自动唤醒并重置避免这场比赛的事件（如果您在工作进入时已经排空队列，您可能会额外唤醒一次，但您不会错过任何唤醒）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T16:19:40.767

Events are atomic, so there's no need to use a mutex around a `SetEvent` or `ResetEvent`, *unless* there's something else along with it and the two have to be done atomically (e.g., if you set one event and reset another).

# http - 在 cpanel 中自动将 http 站点 url 重定向到 https

> ID：10076170
> 
> 赞同：8
> 
> 时间：2012-04-09T16:16:51.667
> 
> 标签：http, ssl, https, ssl-certificate, cpanel

将站点 url http 重定向到 https ..为此，我在我的 cpanl public_html 根目录中上传 .htaccess 文件。文件的代码为

```
RewriteEngine On  
RewriteCond %{SERVER_PORT} 80
RewriteRule ^(.*)$ https://sitename.in/$1 [R,L] 
```

在我托管此文件后，它也没有将我的网站重定向到 https 协议

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2017-02-01T18:19:38.727

我写这个答案太晚了，但目前它工作正常。因此，请尝试在您的根目录 .htaccess 文件中执行此操作。

```
# Force SSL
<IfModule mod_rewrite.c>
RewriteEngine on
RewriteCond %{HTTPS} !=on [NC]
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
</IfModule> 
```

**注意：**只有`mod_rewrite`在 cpanel 服务器上安装了它才能工作，否则使用基于 php 的 SSL 重定向。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-01T22:57:13.890

我刚刚修改了答案的第一部分中的 .htaccess 文件，以便我的 Wordpress 网站将 http:// 重定向到 https://。我不需要修改索引页面，没有它对我来说效果很好。感谢作者，因为它完成了我对安全证书迁移的追求。

我的完整文件 .htaccess 文件对我来说看起来像这样。我建议制作一个本地副本，因为在我在这里找到适合我的正确答案之前，我破坏了我的网站几次：

```
#RewriteCond %{HTTP_HOST} ^yoursite\.com [NC]
#RewriteRule (.*) http://www.yoursite.com/$1 [R=301,L]

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress

Options +FollowSymlinks

RewriteCond %{SERVER_PORT} 80
RewriteRule ^(.*)$ https://www.yoursite.com/$1 [R,L] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-10T10:09:50.170

我在网站的索引页面中添加了以下代码行

```
if($_SERVER["HTTPS"] != "on")
{
header("Location: https://" . $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"]);
exit();
} 
```

然后将站点 url 重定向到 https 链接

# asp.net - Web.config 和 global.asax 有什么区别？

> ID：10076173
> 
> 赞同：2
> 
> 时间：2012-04-09T16:17:02.607
> 
> 标签：asp.net

Web.config 和 global.asax 有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T16:18:55.603

Global.asax 包含执行的代码。Web.config 包含 Web 应用程序的配置设置，例如连接字符串、包含的库、命名空间、用户和组对虚拟目录的访问权限等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T16:18:55.723

Web.config 是……一个配置文件。Global.asax 是一个放置全局事件处理程序的地方，例如 Application_Start、Application_End 等（对您的应用程序来说是全局的）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-09T16:20:39.977

web.config 文件指定 .NET 应用程序的配置数据。global.asax 文件处理应用程序级和会话级事件

# .net - 如何从访问 Exchange Web 服务的 .net 应用程序设置会议的组织者

> ID：10076175
> 
> 赞同：1
> 
> 时间：2012-04-09T16:17:12.397
> 
> 标签：.net, exchangewebservices

在部署在 Intranet 上的 .net 应用程序中 - 我正在尝试获取它，以便在某个页面上，用户可以在页面上列出的各种人员的 Outlook 日历中设置约会。

要创建一个 ExchangeService 我正在这样做......

```
ExchangeService myService = new ExchangeService(ExchangeVersion.Exchange2010);
myService.Credentials = new WebCredentials("myName", "myPassword");
myService.AutodiscoverUrl("myEmailAdddress@myCompany.com"); 
```

...然后使用...创建约会

```
Appointment a = new Appointment(myService); 
```

等等。当我运行它时，它可以正常工作并将我设置为会议的组织者。但是当我部署站点时 - 大概我需要输入用户的用户名和密码，以便他们成为会议的组织者，因为 Appointment.Organiser 是只读的。但我不知道也无法访问他们的用户名和密码。那么，在一个 .net Web 应用程序中，不同的用户如何访问 Exchange Web 服务，从而使他们显示为会议的组织者呢？

在测试时，我输入了用于登录 Windows 的用户名和密码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T06:23:41.630

您必须模拟该用户才能让该用户成为组织者。1\. 使用具有 Impersonation 权限的服务帐户初始化 Exchange 服务。2\. 使用他们的电子邮件地址冒充用户。3\. 创建约会。

这样，服务帐户就可以模拟用户并创建约会，就像用户自己创建约会一样。

# android - Android 4.0.3（MIUI ROM）下未加载本机库

> ID：10076176
> 
> 赞同：3
> 
> 时间：2012-04-09T16:17:13.087
> 
> 标签：android, android-ndk, android-4.0-ice-cream-sandwich, abi

一位客户联系了我——我的一个 Android 应用程序在他将他的 Android ROM 更新到相当于 Android 4.0.3 的 MIUI 后就崩溃了。LogCat 中的相关行是：

```
04-09 10:37:09.326 17789 17789 E AndroidRuntime: java.lang.UnsatisfiedLinkError: Couldn't load mylib: findLibrary returned null 
```

不用说，该应用程序在升级之前就可以运行。所以原生库并没有神奇地消失。任何想法为什么Android 4.0.3会拒绝加载早期版本的本机库？该库是为 x86 和`armeabi`（`armeabi-v7a`虽然不是）而构建的。崩溃报告包含以下几行：

```
[ro.product.cpu.abi2]: [armeabi]
[ro.product.cpu.abi]: [armeabi-v7a] 
```

所以`armeabi`应该支持吧？

可能的相关信息：[这里](https://groups.google.com/forum/#!msg/android-ndk/N8FLjvM81pg/2rYeClQZcckJ)。但是错误中的情况与我在这里得到的相反。

# jquery - 选择同位素容器中的项目时内容闪烁

> ID：10076177
> 
> 赞同：0
> 
> 时间：2012-04-09T16:17:21.303
> 
> 标签：jquery, asp.net-mvc, jquery-isotope

我正在开发一个小型演示/原型应用程序，并且正在使用同位素对一组 div 进行动画过滤。div 是带有一些文本的彩色块，它们使用 .ajax 函数自动更新以获取 JSON 数据。

该应用程序是一组 ASP.NET MVC 完整视图和一些部分视图。瓷砖位于一个视图中。单击磁贴会将用户带到该磁贴的“内容”的新视图页面。视图之间有动画淡出/淡入。（制作这个的开发人员最初有部分视图，但添加了后退按钮工作的要求。这就是为什么所有内容都更改为完整视图......不幸的是，为什么过渡更不稳定。）

我的问题是，点击瓷砖时，同位素 div 在淡出之前会闪烁。

为了清楚起见，这里有一个小图。:)

![同位素淡出闪光](../Images/4b9f6ca263d36cb81ac2d012172b0e5a.png)

jQuery click 事件中没有处理会导致这种闪烁的淡入淡出。click 事件淡出当前的 innerContent 并在内容淡出后使用 window.location.href 重新加载下一个视图。主 MVC 布局处理下一个视图的淡入。当我单步执行或进行一些警报框调试时（在单击功能的每个点插入警报（“我在这一点”）时，我没有得到闪光。

这是处理磁贴点击的函数：

```
var theTileId = $("#" + divId).attr("data-tile-id"); 
```

var appName = "应用程序 > " + $("#" + divId).attr("data-tile-appName"); localStorage.setItem("面包屑", appName);

$("#innercontainer").fadeOut(250, function () { window.location.href = '@Url.Action("Application360", "Larry")?an=' + appName; });

这是处理所有视图的淡入的主要布局功能：

```
 $(document).ready(function () {
        $("#innercontainer").animate({ opacity: '0' }, 0, function () {
            $("#innercontainer").delay(400).animate({ opacity: '1' }, { duration: 'slow', easing: 'swing' });
        });
    }); 
```

关于可能发生的事情的任何想法？我很抱歉没有发布 jsfiddle，但该应用程序有点大并且被认为是敏感的（你知道，通常）。如果真的有必要，我可以稍后再尝试。对于原型来说，解决这个问题并不是很关键，但让它看起来尽可能平滑会很好。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:30:55.757

我遇到了同样的问题，我的解决方案是强制它使用 jquery。Isotope 为动画引擎提供了 3 个选项：“best-available”、“css”和“jquery”。然后设置你的动画选项。有关更多详细信息，请参见[此处](http://isotope.metafizzy.co/docs/options.html#animationengine)。

注意：任何额外的 .animate() 都可能导致设置了 'jquery' 选项的闪烁，因为它将运行动画两次。

# javascript - jQuery | 同一功能内的功能。这是不好的做法？

> ID：10076178
> 
> 赞同：3
> 
> 时间：2012-04-09T16:17:39.210
> 
> 标签：javascript, jquery

我使用这个函数是为了方便，因为我会经常使用fadeTo：

```
function fade_to(div, speed, opacity, after_fade) {
    $(div).fadeTo(speed, opacity, after_fade);
} 
```

然后我为 after_fade 参数调用相同的函数：

```
fade_to('#div', 3000, 1, function() { fade_to('#another_div', 3000, 1)}); 
```

这是一件坏事吗？我会有速度/流畅度问题吗？只使用jQuery的默认fadeTo函数会更好吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:25:59.907

这是一种不好的做法，因为如果不将它们应用于调用函数的每个实例，就不能再使用任何修饰符。由于您可以在 jQuery 中链接修饰符，并且大多数人都同意这样做是一个有用的功能，因此您正在为自己或其他任何处理此代码体的人禁用该有用的功能。

如果您想添加任何额外的动画或样式，这次您必须通过常规 jQuery 再次选择对象。额外的工作，额外的电话，没有真正的好处。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T16:29:59.270

用你的方法没有任何收获。另外，您正在使用 jQuery fadeTo 函数。你所做的并没有错，只是没有收获。例如，如果您的自定义函数中的参数较少，您可以使用这种技术节省工作：

```
function fade_to(div, after_fade) {
    $(div).fadeTo(3000, 1, after_fade);
}

fade_to('#div', function(){ fade_to('#another_div', $.noop); }); 
```

这实际上可以通过防止您输入速度和不透明度参数来节省您的工作量。你也可以这样咖喱

```
function Fade_to(speed, opacity){
     return function(div, callback){
           $(div).fadeTo(speed, opacity, callback);
     }
} 
```

然后你可以像

```
var fade_to_foo = Fade_to(3000, 1);
fade_to_foo('#div', function(){ fade_to_foo('#another_div'); }); 
```

否则没有理由不只是用 jQuery 方式编写它

```
$('#div').fadeTo(3000, 1, function(){ $('#another_div').fadeTo(3000, 1); }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T16:25:18.580

你的方法很方便。我怀疑它会减慢褪色效果。在我看来，这种方法没有错。如果你决定你的淡入淡出效果应该在淡入淡出之前脉冲或闪烁，你只需将你的函数修改为脉冲/闪烁，然后淡出所有对淡入淡出的调用，然后运行新的例程。在这种情况下，它是有意义的，因为它减少了代码并提高了可维护性。Ericosg 确实提出了一个有效的观点，但如果它们是相同的，为什么不减少参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T16:30:25.527

这种做法与将 jQuery 用作可链接的、短语法库的目标背道而驰。但是，如果此特定功能对项目有用，则可能会有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T16:31:52.587

麦克风，

我不知道这一定是一件“坏”的事情，因为它可能会提供更容易的可用性或某些东西（不确定，因为我不知道你的例子的上下文）使用给出的标准函数否则 API 不会。

实际上，有一个函数调用本身就是在使用 CS 中一个叫做“递归”的想法，这对于遍历树很有用（你可以用谷歌搜索递归和树来更好地了解我在这里指的是什么），或者执行某种数学运算（即欧几里得算法）。

我想说，如果你这样做，问“为什么”是个好主意。由于您将参数传递了额外的时间，因此您不会在速度方面获得任何收益，并且与 API 的实现相比，您的函数没有完成任何额外的事情（至少我所看到的）。如果您要养成这种习惯...假设使用计算量更大的功能...您可能会注意到速度变慢。

我希望不仅在这里回答您的问题，还希望让您进一步了解为什么这样做通常是一个坏主意。我同意 dunsmoreb 和 Thomasdotnet 的观点。好点！

-sf

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-09T16:45:59.980

最好只使用jQuery 的默认fadeTo 函数。只是这个。

# java - Method to recursively delete any directory that has no files, my solution seems to work but trying to find ways it can break

> ID：10076184
> 
> 赞同：0
> 
> 时间：2012-04-09T16:18:03.530
> 
> 标签：java

This method will delete any files and empty directories provided in the fileList. It seems to be working. I use recursion to delete the empty directories and i'm worried about cases that will create an infinite loop. Any thoughts or things to consider with this approach?

```
public static void deleteFilesAndEmptyDirs(List<File> fileList) {
            boolean result = true;
            List<File> returnList = new LinkedList<File>();
            for (File file : fileList) {
                result = file.delete();
                if(result == false && file.isDirectory()) {
                    returnList.add(file);
                }
            }

            if(returnList.size() >= 1) {
                deleteFilesAndEmptyDirs(returnList);
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:29:19.670

In linux, you can create a recursive link between two directories.

E.g, I made these two dirs:

```
$ ls -Rla
.:
total 24
drwxr-xr-x   4 dave dave  4096 2012-04-09 17:26 .
drwxr-xr-x 111 dave dave 12288 2012-04-09 17:25 ..
drwxr-xr-x   2 dave dave  4096 2012-04-09 17:27 dir1
drwxr-xr-x   2 dave dave  4096 2012-04-09 17:27 dir2

./dir1:
total 8
drwxr-xr-x 2 dave dave 4096 2012-04-09 17:27 .
drwxr-xr-x 4 dave dave 4096 2012-04-09 17:26 ..
lrwxrwxrwx 1 dave dave    8 2012-04-09 17:27 dir2 -> ../dir2/

./dir2:
total 8
drwxr-xr-x 2 dave dave 4096 2012-04-09 17:27 .
drwxr-xr-x 4 dave dave 4096 2012-04-09 17:26 ..
lrwxrwxrwx 1 dave dave    8 2012-04-09 17:27 dir1 -> ../dir1/ 
```

then I can do this:

```
 $ cd dir1/dir2/dir1/dir2/dir1/dir2/dir1/ 
```

Which if not checked for would cause a stack overflow.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:42:20.133

Your method will recurse infinitely if it encounters a non empty directory. You have to add the contents of the nonempty directory to the list of files to delete.

I believe (but have not tested) that the below code is robust to [recursive symbolic links](https://stackoverflow.com/a/10076335/348975).

```
public static void deleteFilesAndEmptyDirs(List<File> fileList) {
            boolean result = true;
            List<File> returnList = new LinkedList<File>();
            for (File file : fileList) {
                result = file.delete();
                if(result == false && file.isDirectory()) {
                  for ( File f : file . listFiles ( ) ) {
                    returnList.add(f);
                  }
                  returnList . add ( file ) ;
                }
            }

            if(returnList.size() >= 1) {
                deleteFilesAndEmptyDirs(returnList);
            }
        } 
```

# python - 在 web.py 中获取自定义 HTTP 请求标头？

> ID：10076187
> 
> 赞同：2
> 
> 时间：2012-04-09T16:18:13.867
> 
> 标签：python, http-headers, web.py, custom-headers

我知道，使用 web.ctx.env，我可以从标头中获得[很多信息](http://www.mail-archive.com/webpy@googlegroups.com/msg01133.html)——但只有标准标头。是否可以从 web.py 的 GET 或 POST 方法中获取所有 HTTP 请求标头？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T07:26:31.160

你确定它只有标准标题吗？因为我正在使用它来检查`web.ctx.env.get('HTTP_X_REQUESTED_WITH') == 'XMLHttpRequest'`哪个不在该页面的列表中。我还得到了我在 xhr 中设置的值`HTTP_X_FILE_NAME`和`HTTP_X_FILE_TYPE`标题，如下所示`xhr.setRequestHeader( "X-File-Type", file.type );`：

# iphone - iPhone/OS X：转换 UTC 格式日期和时间值日历所需格式

> ID：10076188
> 
> 赞同：0
> 
> 时间：2012-04-09T16:18:17.953
> 
> 标签：iphone, macos

我正在努力将 UTC 时间转换为我想要的日期格式。

```
2012-03-10T09:30:00Z 
```

需要转换成以下格式

```
3:00:00pm April 19, 2012 
```

你能帮我解决这个问题吗？

我试过如下，

```
 NSString *formatted;
    NSDateFormatter *formatter = [[NSDateFormatter alloc] init] ;
    [formatter setTimeStyle:NSDateFormatterShortStyle];
    [formatter setDateFormat:@"HH:mm:ss EEEE, MMM d"];
// Here datetime= 2012-03-10T09:30:00Z
    NSDate *date = [NSDate dateWithTimeIntervalSince1970: [datetime intValue]]; 
    NSString *dateString = [formatter stringFromDate:date];
    NSLog(@"dateString: %@", dateString); 
```

但是，它的打印日期错误，例如“1 月 1 日星期四 06:03:32”。请纠正我。

**更新：** 我遇到了另一个问题，它没有给我正确的时间，但它给出了正确的日期。我的代码如下。

```
NSString *formatted;
NSDateFormatter *formatter = [[NSDateFormatter alloc] init] ;
[formatter setTimeStyle:NSDateFormatterShortStyle];
[formatter setDateFormat:@"HH:mm:ss EEEE, MMM d"];

NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setTimeZone:[NSTimeZone timeZoneWithName:@"UTC"]];
[df setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss'Z'"];
NSDate *date = [df dateFromString:datetime];
NSString *dateString = [formatter stringFromDate:date];
NSLog(@"dateString: %@", dateString); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:25:07.660

要将 ISO 日期字符串转换为`NSDate`：

```
NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setTimeZone:[NSTimeZone timeZoneWithName:@"UTC"]];
[df setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss'Z'"];
NSDate *date = [df dateFromString:date_str]; 
```

然后，您可以将其转换为您当地的时区：

```
[df setTimeZone:[NSTimeZone localTimeZone]];
[df setDateFormat:@"HH:mm:ss EEEE, MMM d"]; 
```

在您的代码中，您`[datetime intValue]`的可能不正确。

# ruby - Nokogiri递归获取所有孩子

> ID：10076190
> 
> 赞同：12
> 
> 时间：2012-04-09T16:18:26.940
> 
> 标签：ruby, search, xhtml, nokogiri

## 问题

我正在针对各种 URL 运行一些统计数据。我想找到孩子数量最集中的顶级元素。我想遵循的方法是识别所有顶级元素，然后确定页面上所有元素的百分比属于它。

## 目标

*   递归获取给定元素的所有子元素。

输入：Nokogiri 元素

输出：Nokogiri 元素数组或子项总数

## 设置

*   红宝石 1.9.2
*   Nokogiri宝石

## 我最终想出了什么（这可行，但不如我在下面选择的答案那么漂亮）

```
getChildCount(elem)
    children = elem.children
    return 0 unless children and children.count > 0
    child_count = children.count
    children.each do |child|
        child_count += getChildCount(child)
    end
    child_count
end 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-09T18:19:52.757

[traverse 方法](http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Node#traverse-instance_method)递归地将当前节点和所有子节点生成到一个块中。

```
# if you would like it to be returned as an array, rather than each node being yielded to a block, you can do this
result = []
doc.traverse {|node| result << node }
result

# or, 
require 'enumerator'
result = doc.enum_for(:traverse).map 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-09T17:44:16.227

```
# Non-recursive
class Nokogiri::XML::Node
  def descendant_elements
    xpath('.//*')
  end
end

# Recursive 1
class Nokogiri::XML::Node
  def descendant_elements
    element_children.map{ |kid|
      [kid, kid.descendant_elements]
    }.flatten
  end
end

# Recursive 2
class Nokogiri::XML::Node
  def descendant_elements
    kids = element_children.to_a
    kids.concat(kids.map(&:descendant_elements)).flatten
  end
end 
```

# php - Socket_read 返回 '1' ..？

> ID：10076191
> 
> 赞同：2
> 
> 时间：2012-04-09T16:18:43.617
> 
> 标签：php, sockets

我最近开始在 PHP 上练习套接字，但遇到了一个我找不到文档的问题。我在 C++ 中看到过类似的情况，但对此没有明确的答案。编码：

```
do {
    $input = socket_read($client, 12,PHP_BINARY_READ);
    echo $input;
} while(TRUE); 
```

应该在套接字上阻塞（不包括用于创建、绑定等的代码）并获取 12 个字节或从另一端可用的任何信息。

奇怪的是，如果读取了 12 个字节，我只会在变量 $input 中得到一个“1”。如果我从客户端发送超过 12 个字节，那么我会在 $input 的值中收到 '1[REST_OF_DATA]'。

知道为什么会这样吗？

如果我将其更改为更多数据和 PHP_NORMAL_READ，那么我将正确接收数据。

PHP手册在线没有说任何关于socket_read返回'1'的信息。

**编辑：好的，感谢您的早期回答:)。我正在保存到文件并读取（不回显到浏览器）期望任何字符。如果有 C++ 套接字知识的人可以验证，我想我可能刚刚发现了一些可能很好的东西。无论如何，我的阅读代码实际上是这样的（不是我上面发布的）：

```
do {
    $input = ($seq_id == 0) ? socket_read($client, 12,PHP_BINARY_READ) : socket_read($client,1024,PHP_BINARY_READ);
    echo $input;
} while(TRUE); 
```

我期待第一次读取时有 12 个字节，然后是 1024 块，这是条件检查的原因。奇怪的'1'来自于此。如果我用我在上面发布的行替换它，则可以正常读取数据。事实上，即使是这样阅读：

```
$input = ($seq_ID == 0) ? socket_read($client,12,PHP_BINARY_READ) : socket_read($client, 12,PHP_BINARY_READ); 
```

结果：第一次读取 = '1' 第二次读取 = 正确数据，第三次读取 = 正确数据..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:24:09.947

您指定的`12`是要读取的最大长度，因此`12`可以表示大小为 0-12 个字符的返回字符串（PHP 中的二进制字符串，1 char = 1 字节）。

此外，由于它可以是二进制的，我建议您使用`var_dump`返回字符串值的 hexdump 来实际找出返回了多少字节，echo 可能会隐藏一些控制字符，您的浏览器可能会隐藏空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T22:41:46.613

对于上面的评论，是的 $seq_id 应该增加。我只是想缩短代码。所以现在，答案对我来说不再重要，但仍然是一个谜，在本月升级我的 Ubuntu 版本后，我无法使用相同的脚本复制错误：

```
<?php
set_time_limit(0);
$address = "192.168.1.1";
$port = 3320;
$server_users = 3; 
$mysock = socket_create(AF_INET, SOCK_STREAM, SOL_TCP) or die("Could not create socket\n");
$bind_result = socket_bind($mysock,$address, $port) or die("Could not bind to address\n"); 
$listen_result = socket_listen($mysock, $server_users)  or die("Could not set up socket   listener\n");
$client = socket_accept($mysock) or die("Could not accept the connection to socket\n");

$seq_id =0;
do {
$input = ($seq_id == 0) ? socket_read($client, 12,PHP_BINARY_READ) : socket_read($client,1024,PHP_BINARY_READ);
echo $input;
} while(TRUE);
?> 
```

我在终端执行它：

```
$php -q myscript.php 
```

并使用 netcat 对其进行测试：

```
$netcat 192.168.1.1 3320 
```

请注意，问题是关于 socket_read 返回 1 作为结果，这在任何地方都没有记录

# regex - sed 正则表达式替换为引号

> ID：10076193
> 
> 赞同：3
> 
> 时间：2012-04-09T16:18:55.773
> 
> 标签：regex, sed

假设我有一个包含多行的文本文件，其中之一是：

```
 <property name="HTTP_PORT" value="8080"></property> 
```

我想用 sed 把它改成这样：

```
 <property name="HTTP_PORT" value="80"></property> 
```

我该怎么做呢？我尝试了很多方法，包括：

```
sed 's/^\(.+\)value=\"8080\"\(.+\)$/\1value=\"80\"\2/g' config.xml
sed 's/^\(.+\)value="8080"\(.+\)$/\1value="80"\2/g' config.xml
sed 's/^\(.+\)8080(.+\)$/\180\2/g' config.xml
sed 's/^\(.+\)\"8080\"\(.+\)$/\1\"80\"\2/g' config.xml
sed 's/^\(.+\)"8080"\(.+\)$/\1"80"\2/g' config.xml 
```

但一切都无济于事。输入和输出始终相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:58:11.743

直接翻译你想要的怎么样：

```
sed 's|<property name="HTTP_PORT" value="8080"></property>|<property name="HTTP_PORT" value="80"></property>|g' 
```

它不像您或我能找到的那样“聪明”的解决方案，但它就像它们一样简单，并且当您正在寻找静态字符串时，这就是您所需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:47:39.390

根据@Kevin 的更正（谢谢！）

```
echo $'<property name="HTTP_PORT" value="8080"></property>'\
| sed 's/^\(.\+\)value=\"8080\"\(.\+\)$/\1value=\"80\"\2/g' 
```

正确的解决方法是转义“.+”加号以实现“1 或更多”。

**编辑后的原始答案（显示了问题的替代解决方案）** **因此鉴于您使用的上下文，传统的`.*`（零个或多个）*有什么问题*

```
echo $'<property name="HTTP_PORT" value="8080"></property>'\
| sed 's/^\(.*\)value=\"8080\"\(.*\)$/\1value=\"80\"\2/g' 
```

** 输出 **

```
<property name="HTTP_PORT" value="80"></property> 
```

此外，+1 用于使用“^”和“$”锚定搜索目标。我见过一些案例（类似于您正在做的事情），没有锚点会大大增加运行时间。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T16:22:55.643

```
$> cat text
<property name="HTTP_PORT" value="8080"></property>

$> sed --regexp-extended 's/(value=\")[0-9]*/\180/' text
<property name="HTTP_PORT" value="80"></property> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T23:41:58.253

这可能对您有用：

```
sed -i '\|<property name="HTTP_PORT" value="8080"></property>|s/80//' config.xml 
```

也许：

```
sed -i 's/"8080"/"80"/' config.xml 
```

# ios - iOS 和 twitter 集成 - 获取多个用户的状态

> ID：10076198
> 
> 赞同：0
> 
> 时间：2012-04-09T16:19:07.517
> 
> 标签：ios, xcode, twitter

我有兴趣在我的 iOS 应用程序中添加 twitter 提要，但我有一个快速的问题：我想从大约 10 个不同的用户组中流式传输最新更新 - 有没有办法直接使用 twitter 来做到这一点api？（澄清一下——我正在尝试为一个运动队制作一个应用程序，并且像一个用户可以查看所有运动员最新推文的部分一样）

我一直在环顾四周，但找不到直接执行此操作的方法。我宁愿不单独搜索每个帐户，而是必须汇总结果。关于如何处理这个问题的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:31:15.520

看这里：[https](https://dev.twitter.com/discussions/3941) ://dev.twitter.com/discussions/3941似乎让我觉得它不能直接完成。他们建议创建一个列表并简单地提取该提要。另一个想法是创建一个仅关注您感兴趣的用户并提取该提要的帐户。不确定这有多合适。

# java - vs Just out of curiosity, between <applet>vs for a Java applet, which one should I use? I know that <applet>is deprecated, however Sun still recommends 问问题 问问题 2012-04-09T16:19:10.167 5455 次 This question shows research effort; it is useful and clear 5 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. Just out of curiosity, between <applet>vs for a Java applet, which one should I use? I know that <applet>is deprecated, however Sun still recommends the use of <applet>. Is there any drawback between the two tags? Because when I use for Mac in Safari, it causes a problem saying that the page can't load, even though the page loaded properly, and when I check the activity window it said that the class was not found/cancelled. For example: Request Object becomes null in Jetty Handler I have created a jetty server where in handler class, i am passing entire request to the Thread and submitting the thread to Threadpool for later execution. The Result is as :- For first request it is working correctly as per expectation. From second request onwards, the request object becomes null in run() method but not in the constructor. In the handler method, if i am doing the Thread.sleep() with any non negative time value then it is working correctly. even with time = 0 milisecond until the load becomes too high. Is there any reason related to multithreaded execution environment ?? javahtmlsafariapplet 4 4 回答 4 This answer is useful 6 applet如果您发现它更频繁地工作，请使用。该object元素是作为一种理论统一引入的，它将成为任何嵌入外部数据的包罗万象的东西。它从来没有很好地工作，现代 HTML 开发已经有效地放弃了统一的想法。HTML5 引入了audioand video，例如并保留img（逻辑统一肯定会弃用img，因为图像可以嵌入object）。 于 2012-04-09T16:47:52.507 回答 This answer is useful 4 deployJava.js按照小程序信息中的说明使用。页.. ..为避免浏览器兼容性问题，Deployment Toolkit 脚本提供了 JavaScript 函数，可自动生成部署 RIA 所需的 HTML。开发人员应该调用这些函数以在各种浏览器中以一致的方式部署他们的解决方案。 然后你就不用担心脚本是否写了applet,object或embed元素。 作为旁白。从活动窗口复制/粘贴文本将比屏幕截图有用得多。现在我（眯着眼睛）看它，似乎只有两行以任何方式相关的输出是： http://admin.file-lift.com/css/none未找到 http://admin.file-lift.com/com.pspinc.util.FileUploaderApplet.class 取消 css/none不是类或 Jar，它们都不存在于服务器上。因此，该小程序存在的问题超出了用于部署它的 HTML 元素。 于 2012-04-09T16:47:02.757 回答 This answer is useful 0 我认为孙有道理。HTML5 说： 小程序元素现在已过时，因此所有扩展框架（Java、.NET、Flash 等）都以一致的方式处理。 换句话说，由于理论上的纯粹性而不是因为任何实际问题，它不再有效。坦率地说，我发现<applet>在现实世界中使用起来更简单、更可靠，并继续使用它。 虽然可能会隐藏血腥的细节，但现实情况是，在某些情况下deployJava.js，它仍然在使用。 <applet>于 2012-04-09T16:57:01.540 回答 This answer is useful 0 使用. 在 HTML 4.01<applet>中已弃用。 除非您的目标是石器时代的环境，否则没有理由承认小程序标签的存在。 于 2012-04-09T16:22:33.197 回答 Related 2 excel - 使用 vba 在 powerpoint 中调整 excel 粘贴对象的大小 1 python - 为什么导入对我不起作用？- Python 2 css - How to anchor a dynamic div to the screen? 3 javascript - 在活动时向链接添加样式 1 php - 警告：无法修改标头信息 - 标头已由（输出）发送 2 android - 将包含 2500 个文件的 12MB 文件夹从资产快速复制到 SD 卡 0 ubuntu - 如何压缩 mysqldump 命令的输出？ 1 events - 离开文本框时 MS-Access 丢失事件 1 html - 如何将css精灵定位为另一个类的背景 2 android - Android：将变量从 Activity 传递到 BroadcastReceiver Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10076200
> 
> 赞同：5
> 
> 时间：
> 
> 标签：java, html, safari, applet

Just out of curiosity, between `<applet>` vs `<object>` for a Java applet, which one should I use? I know that `<applet>` is deprecated, however Sun still recommends the use of `<applet>`.

Is there any drawback between the two tags? Because when I use `<object>` for Mac in Safari, it causes a problem saying that the page can't load, even though the page loaded properly, and when I check the activity window it said that the class was not found/cancelled. For example:

[![enter image description here](../Images/37db80a66595eaf1980bd55e7595630b.png)](https://i.stack.imgur.com/D3v3M.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T16:47:52.507

`applet`如果您发现它更频繁地工作，请使用。该`object`元素是作为一种理论统一引入的，它将成为任何嵌入外部数据的包罗万象的东西。它从来没有很好地工作，现代 HTML 开发已经有效地放弃了统一的想法。HTML5 引入了`audio`and `video`，例如并保留`img`（逻辑统一肯定会弃用`img`，因为图像可以嵌入`object`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T16:47:02.757

[`deployJava.js`](http://docs.oracle.com/javase/6/docs/technotes/guides/jweb/deployment_advice.html#deplToolkit)按照[小程序信息](https://stackoverflow.com/tags/applet/info)中的说明使用。[页](https://stackoverflow.com/tags/applet/info)..

> ..为避免浏览器兼容性问题，Deployment Toolkit 脚本提供了 JavaScript 函数，可自动生成部署 RIA 所需的 HTML。开发人员应该调用这些函数以在各种浏览器中以一致的方式部署他们的解决方案。

然后你就不用担心脚本是否写了`applet`,`object`或`embed`元素。

* * *

作为旁白。从活动窗口复制/粘贴文本将比屏幕截图有用得多。现在我（眯着眼睛）看它，似乎只有两行以任何方式相关的输出是：

*   [http://admin.file-lift.com/css/none](http://admin.file-lift.com/css/none)未找到
*   [http://admin.file-lift.com/com.pspinc.util.FileUploaderApplet.class](http://admin.file-lift.com/com.pspinc.util.FileUploaderApplet.class) **取消**

`css/none`不是类或 Jar，它们都不存在于服务器上。因此，该小程序存在的问题超出了用于部署它的 HTML 元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T16:57:01.540

我认为孙有道理。[HTML5 说：](http://dev.w3.org/html5/spec/obsolete.html#the-applet-element)

> 小程序元素现在已过时，因此所有扩展框架（Java、.NET、Flash 等）都以一致的方式处理。

换句话说，由于理论上的纯粹性而不是因为任何实际问题，它不再有效。坦率地说，我发现`<applet>`在现实世界中使用起来更简单、更可靠，并继续使用它。

虽然可能会隐藏血腥的细节，但现实情况是，在某些情况下`deployJava.js`，它仍然在使用。`<applet>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T16:22:33.197

使用`<object>`. 在 HTML 4.01`<applet>`中已[弃用。](http://www.w3.org/TR/html401/struct/objects.html#h-13.4)

除非您的目标是石器时代的环境，否则没有理由承认小程序标签的存在。</applet></applet></applet></applet></applet></applet></applet></applet>

# c# - Keeping the parent DialogButton open after the child DialogButton is closed

> ID：10076202
> 
> 赞同：0
> 
> 时间：2012-04-09T16:19:29.413
> 
> 标签：c#, winforms, visual-studio-2010, showdialog, dialogresult

I'm having a problem in keeping the Parent Form to be opened till I close after using ShowDialog() .

I've been trying regarding this but couldn't get. I think there is something simple that I might have been missing. Can you please help me reg this?

The problem is, I have Form 1, on pressing one button, Form 2 opens. I do some validations in Form 2, and check for the validations. If the validation doesn't pass, I open a DialogBox form, with Retry and Cancel. If I press Retry, The control should go back to the Form 2 and form 2 should not close. If the press Cancel, both the DialogBox form and the Form 2 should close. Right now, regardless of what I press, both the forms close.

I have looked online and couldn't find any solution. Went through this solution, but both the forms are still closing for me. [Why does closing a nested child dialog also close the parent dialog?](https://stackoverflow.com/questions/9792251/why-does-closing-a-nested-child-dialog-also-close-the-parent-dialog)

My code:(Sample example scenario)

Form 1:

```
private void button1_Click(object sender, EventArgs e)
{
    Form2 testForm = new Form2();
    DialogResult dialogResult = new DialogResult();
    dialogResult = testForm.ShowDialog(this);
    if(dialogResult == DialogResult.OK)
    {
        //Do something
    }
} 
```

Form 2:

```
private void button1_Click(object sender, EventArgs e)
{

    DialogResult validDataResult = MessageBox.Show("Invalid Data Entered. Please provide the correct data."
            , "Data Management"
            , MessageBoxButtons.RetryCancel);

    if (validDataResult == DialogResult.Cancel)
    {
        this.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:58:06.277

in Form2.cs do your validation and then
(assuming validationOK is the true/false result of your checks)

```
if(validationOK == false)
{
    // Ask retry or cancel to the user
    if(DialogResult.Cancel == MessageBox.Show("Validation Fail", "Validation failed, press retry to do it againg", MessageBoxButtons.RetryCancel))
        this.DialogResult.Cancel; // Set the dialog result on form2\. This will close the form.

    // if you have the validation done in a button_click event and that button has its
    // property DialogResult set to something different than DialogResult.None, we need
    // to block the form2 from closing itself.

    // uncomment this code if the above comment is true
    // else
    //    this.DialogResult = DialogResult.None;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:27:20.233

You have to set the `DialogResult` of `Form2` before you can call `this.Close()`. Otherwise, it remains the default. (The below code is only a guess of the actual double close logic since you did not specify that)

Form2.cs:

```
if (validDataResult == DialogResult.Cancel)
    DialogResult = DialogResult.Cancel;
else
    DialogResult = DialogResult.OK;
Close(); 
```

Form1.cs:

```
if(dialogResult == DialogResult.OK)
{
    Close();
}
else
{
    //Do something
} 
```

# java - 请求对象在 Jetty 处理程序中变为空

> ID：10076204
> 
> 赞同：0
> 
> 时间：2012-04-09T16:19:40.490
> 
> 标签：java, multithreading, jetty, application-server

我创建了一个码头服务器，在处理程序类中，我将整个请求传递给线程并将线程提交给线程池以供以后执行。结果如下： - 对于第一个请求，它按预期正常工作。

从第二个请求开始，请求对象在 run() 方法中变为空，但在构造函数中不变为空。

在处理程序方法中，如果我使用任何非负时间值执行 Thread.sleep()，那么它工作正常。即使时间 = 0 毫秒，直到负载变得太高。

有什么与多线程执行环境有关的原因吗？

# c# - 防止 Simple Injector 在解析未注册的服务时抛出异常

> ID：10076206
> 
> 赞同：5
> 
> 时间：2012-04-09T16:19:41.713
> 
> 标签：c#, .net, dependency-injection, ioc-container, simple-injector

`GetInstance(Of TService)`我想知道 Simple Injector 是否可以选择在返回时停止抛出异常`Nothing`？它现在似乎正在抛出它们，因为我有两个请求来获取一个实例，它不存在，并且它抛出了异常。

有没有办法阻止默认行为、某处的设置或其他什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-09T16:43:04.917

绝对有一种简单的方法可以做到这一点。`SimpleInjector.Container`实现System.IServiceProvider ，它定义了一个[对象](http://msdn.microsoft.com/en-us/library/system.iserviceprovider.aspx)[GetService(Type)](http://msdn.microsoft.com/en-us/library/system.iserviceprovider.getservice.aspx)方法。此方法`null`在未注册类型时返回。但是, 是显式实现的`IServiceProvider`，这意味着它在正常使用下不会显示，因此您必须将 to 强制`Container`转换为`IServiceProvider`，如下所示：

```
IServiceProvider provider = container;
object instance = provider.GetService(typeof(MyClass)); 
```

或者您可以在此之上定义扩展方法：

```
public static bool TryGetInstance<TService>(
    this Container container, out TService instance)
    where TService : class
{
    IServiceProvider provider = container;
    instance = (TService)provider.GetService(typeof(TService));
    return instance != null;
} 
```

我必须承认这个功能有点隐藏。目前唯一解释[此方法](https://simpleinjector.org/ReferenceLibrary/?topic=html/M_SimpleInjector_Container_System_IServiceProvider_GetService.htm)的地方是参考库。

[请注意，通常注册空对象模式](https://en.wikipedia.org/wiki/Null_Object_pattern)实现（没有任何行为的空实现）比调用方法要好得多`TryGetInstance`。注入 Null 对象使应用程序不必担心 null 引用，这使您的应用程序代码更易于理解和测试。

# android - Android：以编程方式关闭手机

> ID：10076212
> 
> 赞同：0
> 
> 时间：2012-04-09T16:20:13.023
> 
> 标签：android, shutdown

是否可以通过应用程序关闭整个手机？如何？我需要root手机吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:24:43.797

您需要 DEVICE_POWER 权限才能完全关闭手机，这需要设备被植根。

您可以使用 PowerManager 让它进入睡眠状态或重新启动。

[http://developer.android.com/reference/android/os/PowerManager.html#reboot(java.lang.String](http://developer.android.com/reference/android/os/PowerManager.html#reboot(java.lang.String) )

重启也需要权限：

[http://developer.android.com/reference/android/Manifest.permission.html#REBOOT](http://developer.android.com/reference/android/Manifest.permission.html#REBOOT)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-17T09:57:28.323

### 1、你的设备需要root

### 2、这样的代码

```
private void powerOff() {
    try {
        Process proc = Runtime.getRuntime()
                .exec(new String[]{ "su", "-c", "reboot -p" });
        proc.waitFor();
    } catch (Exception ex) {
        ex.printStackTrace();
    }
}

private void reboot() {
    try {
        Process proc = Runtime.getRuntime().exec(new String[]{ "su", "-c", "reboot" });
        proc.waitFor();
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

# c# - 无效的托管/非托管类型组合与嵌入式动态分配数组

> ID：10076214
> 
> 赞同：2
> 
> 时间：2012-04-09T16:20:16.347
> 
> 标签：c#, arrays, dynamic, pinvoke, marshalling

我在非托管 Win32 C++ DLL 中有一个通用构造：

```
// FirstElemPtrContainer.h
#include "stdafx.h"

typedef unsigned char elem_type; // a byte

typedef struct FirstElemPtrContainer {
    unsigned char num_elems;
    void *allocd_ary;
} FirstElemPtrContainer; 
```

结构中的 void* 旨在包含指向已分配字节数组的第一个元素的指针。

然后，使用此定义的 DLL 导出函数来分配、填充和解除分配结构：

```
// The exported allocator function.
extern "C" _declspec(dllexport) 
    FirstElemPtrContainer *BuildStruct(int elem_count)
{
    FirstElemPtrContainer *fepc_ptr = new FirstElemPtrContainer;
    fepc_ptr->num_elems = elem_count;
    elem_type *ary = new elem_type[fepc_ptr->num_elems];
    for (int i = 0; i < fepc_ptr->num_elems; i++)
    {
        ary[i] = ((i + 1) * 5); // multiples of 5
    }
    fepc_ptr->allocd_ary = ary;

    return fepc_ptr;
}

// The exported deallocator function.
extern "C" _declspec(dllexport) void 
    DestroyStruct(FirstElemPtrContainer *fepc_ptr)
{
    delete[] fepc_ptr->allocd_ary;
    delete fepc_ptr;
} 
```

这些对于本地调用者来说工作得很好。

在 C# 中，我尝试通过 PInvoke 描述相同的结构：

```
[StructLayout(LayoutKind.Sequential)]
public struct FirstElemPtrContainer
{
    public byte num_elems;
    [MarshalAs(UnmanagedType.LPArray, 
        ArraySubType = UnmanagedType.U1, SizeConst = 4)]
    public IntPtr allocd_ary;
} 
```

...并像这样描述调用接口：

```
public static class Imports
{
    [DllImport("MyLib", CallingConvention = CallingConvention.Winapi)]
    public static extern IntPtr BuildStruct(int elem_count);

    [DllImport("MyLib", CallingConvention = CallingConvention.Winapi)]
    public static extern void DestroyStruct(IntPtr fepc_ptr);
} 
```

现在我尝试调用我的界面：

```
class Program
{
    const int NUM_ELEMS = 4;
    static void Main(string[] args)
    {
        IntPtr fepc_ptr = Imports.BuildStruct(NUM_ELEMS);
        if ( fepc_ptr == IntPtr.Zero ) 
        {
            Console.WriteLine("Error getting struct from PInvoke.");
            return;
        }

        FirstElemPtrContainer fepc =
            (FirstElemPtrContainer)Marshal.PtrToStructure(fepc_ptr, 
        typeof(FirstElemPtrContainer));
        //...
    }
} 
```

PtrToStructure() 调用给出了错误“无法封送 'MyLibInvoke.FirstElemPtrContainer' 类型的字段 'allocd_ary'：托管/非托管类型组合无效（Int/UInt 必须与 SysInt 或 SysUInt 配对）。”

您可以看到我已经硬编码了特定数量的元素，我们假设调用者遵守这些元素。我还添加了一个 ArraySubType 子句，尽管它似乎没有什么区别。为什么类型不匹配投诉？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T18:06:18.727

你的结构应该这样声明：

```
[StructLayout(LayoutKind.Sequential)]
public struct FirstElemPtrContainer
{
    public byte num_elems;
    public IntPtr allocd_ary;
} 
```

它必须以这种方式完成，因为`allocd_ary`它是指向非托管内存的指针，并且不能由 p/invoke 编组器编组。

为了阅读`allocd_ary`你可以使用的内容[`Marshal.Copy`](http://msdn.microsoft.com/en-us/library/ms146631.aspx)。

```
FirstElemPtrContainer fepc = (FirstElemPtrContainer)Marshal.
    PtrToStructure(fepc_ptr, typeof(FirstElemPtrContainer));
byte[] ary = new byte[fepc.num_elems];
Marshal.Copy(fepc.allocd_ary, ary, 0, ary.Length); 
```

我怀疑这`CallingConvention.Winapi`是错误的，您应该使用`CallingConvention.Cdecl`.

# php - 需要检查整个域而不是单个 url

> ID：10076217
> 
> 赞同：0
> 
> 时间：2012-04-09T16:20:37.240
> 
> 标签：php, mysql, variables

我有这种和平的代码来验证提交：

```
 // Check to see if the URL is banned.
         $array=parse_url($contenturl2);
          $domaincheck = $array['host'];
          $domaincheck1 = str_replace("www.", "", $domaincheck);
          $domaincheck2 = "http://".trim($domaincheck1);
          $domaincheck3 = "http://www.".$domaincheck2;

          $query = "select id from banned where (url = '$contenturl' || url = '$contenturl2' || url = '$domaincheck' || url = '$domaincheck1' || url = '$domaincheck2' || url = '$domaincheck3') && url != ''";
          $result = mysql_query($query);
            if (mysql_num_rows($result)>0)
            {
            $_SESSION['submitstatus'] = "<div class=success><b>Sorry! This domain is banned from our network</div>";
            header('Location: '.$frompage.'');
            exit;
            } 
```

在某些时候它可以工作，但不是像预期的那样，因为如果我将“domain.com/content.html”添加到禁止列表中，当我添加域“domain. com”到禁止列表我希望此代码禁止此域下的所有 url。

我不会在这里发布整个文件，因为它真的很大，但是如果你们要求，我可以发布它。

我发布的摘录中引用的变量 $contenturl2 具有以下相关变量：

$contenturl = clean_string($_POST['contenturl']);

$contenturl2 = strtolower($contenturl);

Whis $contenturl 抓取被 sql 禁止的域。

我真的希望有人能给我一个关于如何完成这个的线索。

真诚的丹妮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:33:16.720

像下面这样的东西应该可以工作：

```
// Check to see if the URL is banned.
$array=parse_url($contenturl2);
$domaincheck = $array['host'];

$query = "select id from banned where url LIKE '%" . $domaincheck . "%'";
$result = mysql_query($query);
if (mysql_num_rows($result)>0)
{
    $_SESSION['submitstatus'] = "<div class=success><b>Sorry! This domain is banned from our network</div>";
    header('Location: '.$frompage.'');
    exit;
} 
```

这应该匹配域名的所有变体。注意：您必须在要匹配的字符周围加上百分号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:45:37.680

您的方案有很大的错误，用于分解您收到的网址并将其与数据库中的内容进行比较。

我会使用[parse_url](http://php.net/manual/en/function.parse-url.php)，它允许您只从收到的 URL 中取出您关心的部分 - 将其重建为您想要的任何内容，然后检查数据库。

您当前的方案缺少许多重要的逻辑。例如，如果给定域被阻止，是否应该阻止所有子域？IE。如果 mydomain.com 被阻止，应该阻止 www.mydomain.com 吗？

# bash - 算术展开阶

> ID：10076220
> 
> 赞同：1
> 
> 时间：2012-04-09T16:20:45.987
> 
> 标签：bash, shell, ksh, zsh, sh

考虑以下：

```
for i in 1 2 3; do echo $(( j += 1 ))& done 
```

根据（我对[sh 语言规范](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_03)的阅读）第 2.3 节第 5 段，算术扩展`j += 1`应该发生在令牌识别期间，因此应该在 shell 读取`&`. 所以似乎执行上面的行应该增加`j`3 并且每次调用 echo 应该得到一个不同的参数。（如果 '&' 被 ';' 替换，这是什么行为）。在 bash 3.2.25 中，`j`未修改。这是bash中的错误，还是我误解了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T11:11:50.153

整个令牌识别部分处理*解析*，而不是*扩展*或任何类型的命令评估。看一下上下文的“介绍” - 解析基本上是所有事情之前，而算术表达式的评估通常是最后的评估步骤之一。这在这里并不重要。

您实际上可能想知道扩展是否发生在异步列表的子shell fork 之前。他们没有。

```
 $ ksh93 -c 'typeset -i n; while ((++j%10)); do { n+=1; printf "$n "; } & done; while ((++j%10)); do : $((n++)) ${ printf "$n " >&2;} & done 2>&1; echo'
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 $
 $ bash -c 'f() { printf "#%d %s, %s\n" "$@"; }; f 1 $BASHPID $$; f 2 $BASHPID $$ & sleep 1'      
#1 12275, 12275
#2 12276, 12275
 $ 
```

至于展开的顺序，算术展开与参数展开和命令替换同时进行，从左到右（也如上图第二个循环所示）。

我认为您不是唯一一个误读了该部分的人，我已经提交了一些与之相关的错误，这些错误要么是我的错误，要么是由于与非 POSIX shell 扩展的一些不幸交互。恕我直言，该部分太简洁了。

如果您认为规范语言或实现存在问题，您可能会在其中一个邮件列表中找到更好的答案。[ast-users](http://www2.research.att.com/~gsf/download/mailgroups.html)，[help-bash](https://lists.gnu.org/mailman/listinfo/help-bash)，[austin 组列表](http://www.opengroup.org/austin/lists.html)

# python - scipy：spearmanr返回值的意义（相关性）

> ID：10076222
> 
> 赞同：2
> 
> 时间：2012-04-09T16:20:54.353
> 
> 标签：python, statistics, scipy, correlation

X,Y 的 spearmanr（Spearman 相关性）的输出给了我以下信息：

相关性：0.54542821980327882

P值：2.3569040685361066e-65

其中 len(X)=len(Y)=800。

我的问题如下：

0）这里的置信度（alpha？）是多少？

1）如果相关系数> alpha，则拒绝相关是巧合的假设，因此存在相关。这是真的 ？

提前致谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T16:26:31.963

您可以选择显着性水平 (alpha)。为了保持连贯性，您应该在运行测试之前选择它。该函数将返回您可以选择的最低 alpha，您拒绝零假设 (H0) [当 p-value < alpha 或等效地 -p-value>-alpha 时拒绝 H0]。

因此，您知道拒绝原假设 (H0) 的最低值是 p 值 (2.3569040685361066e-65)。因此，对于任何相关的 alpha 水平（通常 alpha = 0.05），您的零假设都被拒绝为非常小的 p 值。

# android - XML 文件中的子菜单错误

> ID：10076223
> 
> 赞同：0
> 
> 时间：2012-04-09T16:21:01.197
> 
> 标签：android, xml, menuitem

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
<item >
<item 
    android:id="@+id/item1"
    android:title="Main Menu"
    />

     <item 
    android:id="@+id/takesurvey"
    android:title="Take Survey"
    />

<item 
    android:id="@+id/viewstats"
    android:title="View Statistics"
    />

<item 
    android:id="@+id/changesort"
    android:title="Change Sorting Order "
   <menu>
     <item 
        android:id="@+id/create_new"                  
             android:title="@string/create_new" />    
          <item 
             android:id="@+id/open"                
             android:title="@string/open" />
   </menu>

     />

<item 
    android:id="@+id/menuexit"
    android:title="Exit from program "
    /> 
</item> 
```

您好，这似乎是一个简单的问题。我正在尝试在我的 Android 的 XML 文件中创建一个子菜单（用于更改排序选项）。但是，我收到一个错误：元素类型“item”必须后跟属性规范“>”或“/>”。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:50:50.420

你的 XML 是一团糟

你有这个开放标签，没有结束标签：

```
<item > 
```

然后你有这个，这是一个部分标签：

```
<item 
android:id="@+id/changesort"
android:title="Change Sorting Order " 
```

我建议您重新格式化 XML 以缩进每个子标记，并确保每个标记都以 /> 或结束标记对结尾。

# django - 按照递归外键排序

> ID：10076228
> 
> 赞同：0
> 
> 时间：2012-04-09T16:21:31.610
> 
> 标签：django, django-models

在 django flatpages 上工作，我发现了这个资源： [Bending django flatpages to your will](http://linfiniti.com/2011/01/bending-django-flatpages-to-your-will/)

发现它很有用，但我不知道如何订购 ExtendedFlatPages。换句话说，我无法理解：

```
flatPages = ExtendedFlatPage.objects.filter(child_of__isnull=True).order_by('-show_after') 
```

模型定义如下：

```
from django.db import models
from django.contrib.flatpages.models import FlatPage
class ExtendedFlatPage(FlatPage):
    show_after = models.ForeignKey('ExtendedFlatPage', null=True, blank=True, default=None )
    child_of = models.ForeignKey('ExtendedFlatPage', null=True, blank=True, default=None ) 
```

我发现这种做法很优雅，因为您不需要使用专用字段来订购 ExtendedFlatPage，但找不到下面的逻辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:26:57.317

您拥有的订单并不是特别有用。您最终将按 show_after.id 排序，这只是一个自动增量 int。

# android - 使用静态而不是可打包/序列化——这很糟糕吗？

> ID：10076230
> 
> 赞同：2
> 
> 时间：2012-04-09T16:21:40.517
> 
> 标签：android

我需要在不同活动之间保留对对象的引用。这两个提到似乎从一个活动到另一个活动创建了新的对象。这是一个问题，因为一旦父活动获得焦点，对“子”活动中对象的更改就不会持续存在。我对此的解决方案只是在子活动调用和使用的最父活动中创建一个静态吸气剂。这是不正确的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:27:52.793

如果你想在活动之间共享一个对象的单个实例，你可以创建一个单例类。使用最父活动类来实现单例的唯一错误可能是它可能违反[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:29:11.467

你可以让你的对象在整个应用程序生命周期中持久化，方法是让它成为你的`Application`派生类中的一个字段。

```
public class MyAppication extends Application {

private Object mMyData; 

public setData(Object data) {
    mMyData = data;
}

public Object getData() {
      return mMyData;
} 
```

}

然后`((MyApplication)getAppllication()).setData`或`getData()`

这样您就可以在应用程序内交换数据，因为`MyApplication`将始终存在。

您还必须添加`MyApplcation`到清单

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T16:29:15.013

您应该创建一个 Singleton，每当您与之交谈时，它都有一个实例。（就像你的描述一样）。

这是我之前做的一个：[https ://stackoverflow.com/a/6539080/413127](https://stackoverflow.com/a/6539080/413127)

# c# - ASP：GridView BoundField 与自定义对象？

> ID：10076231
> 
> 赞同：2
> 
> 时间：2012-04-09T16:21:44.520
> 
> 标签：c#, asp.net, gridview

所以我向我的 GridView 传递了一个 List<> 自定义对象。每个对象都包含其他对象。

这有效：

```
 <asp:TemplateField ItemStyle-CssClass="TableContent" ItemStyle-Width="100" ItemStyle-HorizontalAlign="Center"
                    ItemStyle-VerticalAlign="Middle" HeaderText="Clicks" HeaderStyle-CssClass="OrangeTableHeaders">
                    <ItemTemplate>
                        <%# string.Format("{0:n0}",((MyProject.AppCode.AdGroup)Container.DataItem).AdStatistics.Clicks)%></ItemTemplate>
                </asp:TemplateField> 
```

但是有没有办法用 BoundField 而不是 TemplateField 来实现这一点？

IE，这不起作用-我只是错误地格式化了呼叫吗？谢谢！

```
<asp:BoundField DataField="AdStatistics.Clicks" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:26:29.937

只需`AdStatisticsClicks`在您的自定义对象中添加一个公共属性，例如：

```
public string AdStatisticsClicks
{
   return string.Format("{0:n0}", AdStatistics.Clicks);
} 
```

并使用：

```
<asp:BoundField DataField="AdStatisticsClicks" HeaderText="Clicks" /> 
```

# ruby-on-rails - 在 Rails 的多个视图中重用同一个表

> ID：10076233
> 
> 赞同：0
> 
> 时间：2012-04-09T16:21:52.630
> 
> 标签：ruby-on-rails, ruby-on-rails-3

只是学习 Rails 并寻找最佳实践帮助。我有相同的数据表，可在我的控制器的多个不同视图（索引、搜索结果）中重复使用。为了让它保持干燥，我在一个辅助方法中使用了 html<< 用于表格 HTML 的表格代码。

我意识到现在我已经将一大块 HTML 提取到了我不是很喜欢的控制器中。如何最好地处理您计划在多个视图中重用一大块 HTML 的情况？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:26:09.647

你想要的是部分。您将部分与视图放在同一个文件夹中，但部分以下划线开头（例如：）`app/views/user/_my_partial.html.erb`。在此部分中，您可以放置​​共享的 HTML 代码，并从视图中访问它：

```
<%= render "my_partial" %> 
```

是的，当您访问部分内容时，您会跳过下划线。

有关部分的更多信息，请参阅[rails 指南](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)。

# jsf - 预填充 p:inputText 组件

> ID：10076235
> 
> 赞同：0
> 
> 时间：2012-04-09T16:21:57.300
> 
> 标签：jsf, primefaces

我无法显示组件的`p:dialog`预填充值`p:inputText`：

```
<p:dialog modal="true" widgetVar="editPersonDlg" header="Edit Person" width="350">
    <h:form id="editPersonForm">
        <h:panelGrid columns="2">
            <h:outputLabel for="editFirstName" value="First Name:" />
            <p:inputText id="editFirstName" value="#{personBean.selectedPerson.firstName}" />
            <p:commandButton value="Save" type="Button" actionListener="#{personBean.edit}" 
                                 oncomplete="editPersonDlg.hide()"/>
            <p:commandButton value="Cancel" type="Button" oncomplete="editPersonDlg.hide()"/>
        </h:panelGrid>
    </h:form>
</p:dialog> 
```

在调试时，我发现它`personBean#selectedPerson`实际上返回了一个非空的人，其名称不为空。`Person#getFirstName`有效地返回一个非空名称。但是 FirstName 和 LastName 不会出现在对话框的 inputText 框中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T18:37:26.863

这可能是因为您在打开对话框之前没有更新它。例如：您通过在 p:dataTable 中选择 personBean.selectedPerson 来初始化它，然后您想通过单击打开“编辑”对话框的 p:commandButton 来编辑它。您必须更新此对话框，以便组件可以获取实际数据。为打开对话框的按钮尝试这样的操作：

```
<p:commandButton value="Edit" oncolmplete="editPersonDlg.show()" update=":formInWhichIsDialog:dialogID" /> 
```

让我知道它是否有效，问题可能出在其他地方，但这是最常见的事情。希望它有所帮助！

# java - 如何根据访问页面的设备生成不同的 HTML？

> ID：10076240
> 
> 赞同：1
> 
> 时间：2012-04-09T16:22:52.073
> 
> 标签：java, jsf, jakarta-ee

我正在使用带有所有参考实现的 Java EE 6，我想知道如何根据访问页面的设备生成不同的响应？在我开发 JSF 页面时，我的目标是在 PC 上运行的浏览器。但是，当用户使用智能手机浏览页面时，我想生成另一个 HTML 结构（即使用另一个 JSF 页面）。

现在您想知道，“为什么不使用 CSS 媒体查询？”。是的，我可以，但这只会对布局提供有限的控制。有人可以给我一些提示，让我知道从哪里开始阅读关于这样做的内容和内容吗？

我不想使用 Spring，我知道他们有这样的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T01:21:00.333

> *我不想使用 Spring，我知道他们有这样的东西。*

然后重新发明它（*咳嗽*）。

[让我们看看他们是如何做到的](https://www.google.com/search?q=spring%20mobile%20device%20detection)。根据下面引用的[Spring Mobile 文档](http://static.springsource.org/spring-mobile/docs/1.0.x/reference/htmlsingle/)，

> ### LiteDeviceResolver
> 
> 默认`DeviceResolver`实现基于作为[Wordpress Mobile Pack的一部分实现的“lite”](http://wordpress.org/extend/plugins/wordpress-mobile-pack)[检测算法](http://plugins.trac.wordpress.org/browser/wordpress-mobile-pack/trunk/plugins/wpmp_switcher/lite_detection.php)。此解析器仅检测移动设备的存在，不检测特定功能。启用此解析器不需要特殊配置，只需配置默认的 DeviceResolverHandlerInterceptor 即可为您启用。

似乎他们已经将[这段 PHP 代码](http://plugins.trac.wordpress.org/browser/wordpress-mobile-pack/trunk/plugins/wpmp_switcher/lite_detection.php)移植到了[这段 Java 代码](http://git.springsource.org/spring-mobile/spring-mobile/blobs/a4054d3c6c460edc1019a9ee5b35251ba446f448/spring-mobile-device/src/main/java/org/springframework/mobile/device/lite/LiteDeviceResolver.java)中。您也可以这样做（注意许可规则！）。最明智的做法是使用[servlet 过滤器](https://stackoverflow.com/tags/servlet-filters/info)，然后根据检测结果发送重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:26:57.947

我认为您需要查看 HTTP_USER_AGENT。

没有使用 Java 的经验，但请查看 System.getEnv("HTTP_USER_AGENT")。

它应该为用户代理返回一个字符串名称。您应该在常见用户代理的 Web 列表中找到，因此您可以轻松地将它们分类为移动或非移动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T17:12:13.960

检查 HTTP 标头

用户代理

您可以使用 Servlet API 检索它：http: [//docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getHeader%28java.lang.String%29](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getHeader%28java.lang.String%29)

# java - 如何在春季创建一个新会话？

> ID：10076243
> 
> 赞同：7
> 
> 时间：2012-04-09T16:23:04.613
> 
> 标签：java, spring, session

我正在使用带有 jsf 的 spring 3（注释），并且我知道如何创建会话以及之后如何使其无效......

所以当我登录并在最后使用注销按钮时，一切都很好。但问题是，如果我不单击注销按钮，会话仍然存在。如果我现在使用不同的用户登录，那么旧的会话数据仍然存在——因为旧的会话没有失效。

那么如果旧会话没有失效，我如何强制系统创建新会话？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-09T16:42:16.767

您应该在用户登录时清除会话。这样，无论他们是否已注销，您都可以重新开始：

```
@RequestMapping("login")
public String login(LoginForm form, HttpServletRequest request, HttpSession session) {

    session.invalidate();
    HttpSession newSession = request.getSession(); // create session

    // log the user in

    return "successPage";
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T17:30:44.213

史蒂夫的回答很好。只是为了添加更多上下文，您应该*始终*在用户身份验证事件之后使会话无效并创建一个新会话，作为对抗会话固定攻击的最佳实践。

完成您想要做的事情的另一种方法是使用 Spring Security。我不确定您是否考虑过它，但默认情况下，它会在每个用户登录时为您处理无效和生成新会话。此外，它还具有您可能会或可能不会觉得有用的其他功能。此链接可能会有所帮助：[http](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/ns-config.html) ://static.springsource.org/spring-security/site/docs/3.1.x/reference/ns-config.html 。滚动到“3.3.3/会话固定攻击保护”部分以获取与您的问题相关的信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-03T09:12:49.697

**如果会话旧**，则在注销后创建新会话检查`session.isNew()`条件，然后调用。将注销方法重定向到**/login**映射。它检查会话，并**在您调用**方法时创建新会话。**`invalidate()` ****`invalidate()`******

 ********注销代码：**

```
@RequestMapping("/logout")
public String logout() {
    return "redirect:/login";
} 
```

**登录代码：**

```
@RequestMapping(value = "/login")
public String login(HttpServletRequest request, HttpSession session) {
    /*
     * create new session if session is not new
     */
    if (!session.isNew()) {
        session.invalidate();
    }
    return "login";
} 
```******

# php - php分组表排序1

> ID：10076244
> 
> 赞同：0
> 
> 时间：2012-04-09T16:23:04.690
> 
> 标签：php, mysql, while-loop, grouping

我正在尝试通过 php 从 mysql 表中使用节分隔符来实现排序列表，但是遇到了一些麻烦。我没有像我想要的那样把汤放在汤头里，而是把它放在下面的头里（就像我不想要的那样）！

这是视觉输出：

```
2-Soup
3-Salad
    2   Soup     Demo: Tom KaKai
4-Entree
    3   Salad    Demo: Spinach Salad
    4   Entree   Demo: Pork Chop
    4   Entree   Demo: Spicy Topped Shrimp 
```

这是我的代码：

```
 $cat = null;
while($row = mysql_fetch_array($result))
{
    if( $row['catnum'] != $cat )
    {
        echo '<h1>' . $row['catnum'] . '-' . $row['ctgry'] . '</h1>';
        $cat = $row['catnum'];
    }
   echo "<table><tr><td>" . $row['catnum'] . " </td><td>" . $row['ctgry'] . "</td><td> " . $row['Shrt_Desc'] . "</td></tr>";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:28:20.903

您没有关闭`<table>`标签，而是为检索到的每个 DB 行创建一个新表，因此从结构上讲，您的 HTML 页面完全是一团糟。

你想要这样的东西：

```
$first = true;
while ($row = mysql_fetch_array($result)) {
    if ($row['catnum'] != $cat) {
       if (!$first) {
           echo '</table>'; // close the table if we're NOT the first row being output.
       }

       $first = false; // no longer the first table, so disable this check.
       echo '<h1> etc...';
       echo '<table>'; // start new table
       $cat = $row['catnum'];
    }
    echo '<tr><td>' etc.... // output a table row
} 
```

当您更改类别时，此代码只会输出`<table>`and `<h1`> 的东西。

# asp.net-mvc - 分离具有集合的对象

> ID：10076245
> 
> 赞同：0
> 
> 时间：2012-04-09T16:23:05.947
> 
> 标签：asp.net-mvc, wcf, entity-framework-4

我的 DAL 中有以下代码：

```
public List<User> Getuser(int userId)
        {
            using (var context = this.GetDataContext())
            {
                var user = (from u in context.Users.Include("UserRoles")
                            where u.UserId == userId
                            select u).FirstOrDefault();

                context.Detach(user);

                return user;
            }
        } 
```

当调用分离时，我丢失了我试图通过 WCF 发送回客户端的 UserRole 集合。如果我不将对象从上下文中分离出来，我会得到“底层连接已关闭：连接已意外关闭。”。这样做的最佳方法是什么，我可以保留集合而不必再次重新查询它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:31:48.473

关闭此操作的延迟加载。您的实体很可能包含其他关系，WCF 也尝试序列化它们。

# wcf - 如何正确实现具有两个接口的策略模式？

> ID：10076250
> 
> 赞同：0
> 
> 时间：2012-04-09T16:23:46.657
> 
> 标签：wcf, asp.net-4.0, strategy-pattern

我创建了一个服务数据访问层，其中有多个数据需要来自的数据库。

我对一个数据库做得很好，我在其中定义了`memberRepository`包含成员详细信息的数据库。但是，现在我必须获取存储在另一个数据库中的与会话相关的详细信息。

运营合同：

*   `IMemberServices`包含`GetLoggedInBuddies(int profileID);`
*   `ISessionServices`包含`GetProfileIDFromSessionID(string sessionID);`

我的服务等级：

```
public class MemberService : IMemberService, ISessionServices
{
    #region Strategy pattern configuration

    //
    // Member repo
    // 
    private MemberRepository memberRepository;
    public MemberService()
        : this(new MemberRepository())
    { }
    public MemberService(MemberRepository memberRepository)
    {
        this.memberRepository = memberRepository;
    }

    //
    // Session repo
    //
    private SessionRepository sessionRepository;
    public MemberService() : this(new SessionRepository()){}
    public MemberService(SessionRepository sessionRepository)
    {
        this.sessionRepository = sessionRepository;
    }

    #endregion

    /// <summary>
    /// Session-related details are maintained in the Secondary database
    /// </summary>
    /// <param name="sessionID"></param>
    /// <returns></returns>
    public int GetProfileIDFromSessionID(string sessionID)
    {
        int sessionProfileID = sessionRepository.GetProfileDetailsFromSessionID(sessionRepository);

        return sessionProfileID;
    }

    /// <summary>
    /// Try profileID = 1150526
    /// </summary>
    /// <param name="profileID"></param>
    public void  GetLoggedInBuddies(int profileID)
    {
        memberRepository.GetLoggedInBuddies(profileID);
        //return memberRepository.GetLoggedInBuddies(profileID);
    } 
```

问题是在该`// Session Repo`部分中，因为我已经定义了一个构造函数。我明白了。

所以基本上在每种方法中我都想做类似的事情

```
MemberService useSessionRepo = new MemberService(SessionRepository);
useSessionRepo.GetProfileDetailsFromSessionID(...);

MemberService useMemberRepo = new MemberService(MemberRepository);
useMemberRepo.GetLoggedInBuddies(...); 
```

只需要一只手把它放在一起。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:36:49.163

我不确定您的问题，但是您可以使用不带参数的 ctor，并为每个 repo 使用参数。

```
public MemberService()
{
   this.memberRepository = new MemberRepository();
   this.sessionRepository = new SessionRepository();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:55:23.997

我创建了一个中央存储库，它接受我要连接的数据库的连接字符串的名称。

```
public abstract class DatabaseRepository : BaseRepository
{
    static IDbConnection connection;

    /// <summary>
    /// Handles db connectivity as Dapper assumes an existing connection for all functions
    /// Since this app uses three databases, pass in the connection string for the required db.
    /// </summary>
    /// <returns></returns>
    protected static IDbConnection OpenConnection(string connectionStringName)
    {
        try
        {
            connection = new SqlConnection(WebConfigurationManager.ConnectionStrings[connectionStringName].ConnectionString);
            //connection = SqlMapperUtil.GetOpenConnection(connectionStringName);       // if we want to use the Dapper utility methods
            connection.Open();
            return connection;
        }
        catch (Exception ex)
        {
            ErrorLogging.Instance.Fatal(ex);        // uses singleton for logging
            return null;
        }
    }
.
.
. 
```

然后在我的服务库中，我连接到适当的数据库并执行我需要的任何查询：

```
using (IDbConnection connection = OpenConnection("FirstDBConnectionString")) { ... 
```

# xml - SAX、XML 文件解析错误

> ID：10076254
> 
> 赞同：0
> 
> 时间：2012-04-09T16:24:14.970
> 
> 标签：xml, sax

当我尝试使用 SAX 解析我的 xml 时，我遇到了一个问题：

> 04-09 18:19:02.690: WARN/System.err(518): org.apache.harmony.xml.ExpatParser$ParseException: 在第 1 行，第 0 列：格式不正确（无效令牌）

我的 xml 的开头是：

```
<?xml version="1.0" encoding="utf-8"?>
<map>
    <line>
        <item> 
```

谢谢你。

PS：我使用的是安卓 SDK

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T18:22:36.087

我的猜测是，出于某种原因，这不是您提供给解析器的 XML。

# c++ - 可变长度数组 C++ 包装容器

> ID：10076256
> 
> 赞同：1
> 
> 时间：2012-04-09T16:24:22.723
> 
> 标签：c++, arrays, memory-management, boost, containers

是否有*动态*变体在可用时（GCC）在内部`boost::array`使用 C99 的*可变长度数组*（VLA），否则*使用基于堆的？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:56:01.510

`boost::array`基于模板参数工作。模板参数不能是运行时值。所以不行。

此外，VLA 仅适用于在堆栈 ( `ObjType val[someInteger];`) 上声明的数组。它们不适用于*在*对象 (中声明的数组`struct ObjType { int val[someInteger]; };`。因此，即使模板参数可以是运行时值，它也无济于事。

如果您负担不起堆分配，只需将 a`std::vector`与从预分配内存的“堆栈”中提取的分配器一起使用。

# php - PHP - 克隆一个包含对自身的引用的对象？

> ID：10076258
> 
> 赞同：3
> 
> 时间：2012-04-09T16:24:35.523
> 
> 标签：php, oop, drupal, cloning, self-reference

创建包含许多对自身的引用的复杂 PHP 对象的克隆的最佳方法是什么，以便新对象的引用指向它自己的方法和属性，而不是原始对象的方法和属性？

我[从手册中了解到，该手册](http://php.net/manual/en/language.oop5.cloning.php)创建`$new_object = clone $old_object;`了一个浅层副本，将引用保存在它们所在的位置。那么大概 $new_object 的引用将指向旧对象上的方法？

该手册页上的评论表明这`$new_object = unserialize(serialize($old_object));`是一种创建深层副本的方法。听起来很有希望，我不确定这种方法对我的情况意味着什么：引用是否被转换为指向克隆，或者是绝对的，或者其他什么，如果确实做了我想要的，是否是最好的方法。

我想知道是否有一种既定的标准方法可以做到这一点。

*（注意：有问题的对象是 Drupal Views 对象，但这个问题一般是关于 PHP 对象的：这个对象的唯一重要特征是，它很大，并且包含许多对自身的引用，如果您尝试导航，这些引用会递归整棵树。）*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:29:53.030

一个简单的测试将揭示发生了什么：

```
$old = new stdClass();
$old->foo = 'bar';
$old->baz = &$old;

print_r($old);

$new = unserialize(serialize($old));

$new->foo = 'new';

print_r($new);
print_r($new->baz->foo); 
```

此代码显示 self-ref 现在指向克隆。[http://codepad.org/dSnZ5I10](http://codepad.org/dSnZ5I10)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T16:31:15.897

这是一些基本的测试和结果。不是一个完整的答案，但希望有用。如果我的方法有误，也请纠正我。假设 $view 是一个已经包含大量自引用和大量数据的对象：

```
 $view->somedata = "This is the default";
      $view->selfreference =& $view->somedata;

      $new = clone $view;
      $new2 = unserialize(serialize($view));

      $view->somedata = "This is view";
      $new->somedata = "This is new";
      $new2->somedata = "This is new2";

      echo("$view: ".$view->selfreference);
      echo("$new: ".$new->selfreference);
      echo("$new2: ".$new2->selfreference); 
```

结果：

```
'$view: This is new'
'$new: This is new'
'$new2: This is new2' 
```

因此，在最初的调查中，它看起来像是将`clone`自引用指向原始对象的浅克隆，并且该`unserialize(serialize())`方法保持引用并将其指向新对象。

所以它看起来很`unserialize(serialize())`有效，不会因为无限循环或过度递归而崩溃。我想听听人们对这是否是最佳、标准和/或可接受的方法的看法。

# google-maps - 如何确定一个点是否在 kml 或形状内

> ID：10076260
> 
> 赞同：3
> 
> 时间：2012-04-09T16:24:44.953
> 
> 标签：google-maps, kml, point, google-fusion-tables

我有一些形状数据（融合表和/或数据库列中的一系列 kml 文件），我想将它与另一个包含纬度经度点的表合并。基本上我想要某种方法来确定给定的纬度点是否包含在 kml 形状中，如果是，则保存对该行的引用。我虽然也许有一种方法可以从融合表中做到这一点，但如果没有，也许有一种方法可以遍历每个 kml 并测试 lat lon 点是否包含在其中。我理解这不是非常有效。任何帮助、算法、服务等都会​​很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T18:15:26.960

Fusion Tables SQL API 有一个 ST_INTERSECTS 运算符，但只能在 CIRCLE 或 RECTANGLE 中查找点。GMap V3 有一个几何库，它有一个 poly.containsLocation() 方法，我认为它适用于任意多边形。请参阅：[GoogleMap 几何/多边形库](https://developers.google.com/maps/documentation/javascript/reference#poly)

PS我意识到这不适用于KML文件，但它们确实包含可以变成GMAP多边形的多边形点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-27T01:19:14.573

这可能早就解决了，但是由于我遇到了类似的问题，我想我会发布我的解决方案。

我有两个 Fusion 表 i）地址和数据以及 ii）多边形和数据。我希望能够轻松查询以查找一个或多个多边形内的所有地址。我可以通过我的地图网页实时完成这项工作，但我决定最好提前查找一次相关的多边形，然后使用这些数据进行地图查询（在 Web 界面中更快、更容易地指定多个多边形）。

因此，我将带有地址的表格 i) 导出到了 google 表格，并创建了一个简短的简单脚本，用于检查地址所在的多边形并将其写回 google 表格。然后我更新了我的融合表 i)。

我有一个包含近 3000 个地址和 2000 个多边形的数据集，所以它超时了几次，并且有几个地址错误，但这很容易修复，我只是将脚本设置为从没有的第一行运行已更新。请注意，如果多边形相互重叠，这将不起作用，但我的没有，因为它们是地理边界;-)

我使用的代码在下面，也是在[这里](https://gist.github.com/anonymous/b059242c9aa5e131567c105c6681c19c)的要点。您显然需要更新表 ID，并且可能需要使用 OAuth 做一些事情（我不太明白，但按照谷歌的说明完成了它）。

```
// replace with your fusion table's id (from File > About this table)
var TABLE_ID = 'xxxxxxxxxx';

// first row that has data, as opposed to header information
var FIRST_DATA_ROW = 2;
var FIRST_DATA_COLUMN = 11;
var LAT_COLUMN = 1;
var LNG_COLUMN = 2;
var SA2_COLUMN = 6;
var SA3_COLUMN = 7;

/**
 * Uses a lat and lng data in google sheets to check if an address is within a kml polygon 
 * in a list of KML polygons in fusion (in this case ABS/ASGC SA2 and SA3 regions, but could be any polygon) 
 * the function then stores the ID/name of the relevant polygon in google sheets 
 * I could check this data in realtime as I render maps, but as it doesn't changed, figure its better to just record
 * which polygon each address pertains to so its quicker and easier to search (in particular it mades it easier to write a query
 * which identifies all the address within multiple polygons)
 * in this case I had 3000 rows so it exceeded maximum execution times, so I just updated the first data row a couple of times
 * when the execution time exceeded.
 */
function updateSA2ID() {
  var tasks = FusionTables.Task.list(TABLE_ID);  
  var sqlResponse = '';

  // Only run if there are no outstanding deletions or schema changes.
  if (tasks.totalItems === 0) {
    var sheet = SpreadsheetApp.getActiveSheet();
    var latLngData = sheet.getRange(FIRST_DATA_ROW, FIRST_DATA_COLUMN, sheet.getLastRow(), sheet.getLastColumn());

      i = 1;
    // Loop through the current current sheet
    for (i = 1; i <= latLngData.getNumRows(); i++) {      

      // cross reference to Fusion table
      lat = latLngData.getCell(i,LAT_COLUMN).getValue();
      lng = latLngData.getCell(i,LNG_COLUMN).getValue();

      sqlString = "SELECT 'SA2 Code', 'SA3 Code'  FROM " + TABLE_ID + " WHERE ST_INTERSECTS(geometry, CIRCLE(LATLNG(" + lat + ", " + lng + "),1)) ";      
      //Browser.msgBox('Lat ' + lat + ' Lng ' + lng + '; ' + sqlString, Browser.Buttons.OK);
      sqlResponse = FusionTables.Query.sql(sqlString);
      //Browser.msgBox('SQL Response ' + sqlResponse, Browser.Buttons.OK);

      latLngData.getCell(i,SA2_COLUMN).setValue(sqlResponse.rows[0][0]); // set SA2
      latLngData.getCell(i,SA3_COLUMN).setValue(sqlResponse.rows[0][1]); // set SA3     

    }

  } 
  else {
    Logger.log('Skipping row replacement because of ' + tasks.totalItems + ' active background task(s)');
  }
};
```

# c - C - 构建动态分配的指针数组，指向填充来自文件的输入的结构

> ID：10076261
> 
> 赞同：1
> 
> 时间：2012-04-09T16:24:47.853
> 
> 标签：c, pointers, memory-management, data-structures

我需要构建一个指向动态分配结构（DBrecord）的指针数组，并用另一个文件的输入填充该数组。不知道如何解决这个问题。

数据文件将首先具有条目数，然后是特定顺序的条目。

条目数

lastName firstName studentID year gpa expGradYear

例子：

1

能源部约翰 12345678 高级 3.14159 2015

这是我到目前为止的代码：

类.h

```
typedef enum {firstYear, sophomore, junior, senior, grad} class; 
```

主程序

```
#include <stdio.h>
#include <stdlib.h>
#include "class.h"

int main(){

//DBrecord is name for structure
struct DBrecord{
int DBrecordID;     //ID for each entry, range 0-319
char *last;         //student last name
char *first;        //student first name
char studentID[8];  //student ID
int age;            //student age
class year;         //year in school
float gpa;          //GPA
int expGradYear;    //expected graduation year
};
int numEntries;     //total number of entries, first num in data file
struct DBrecord **ptrToDB;

//scan first int in data file and assign to numEntries
scanf("%d", &numEntries);

//allocate memory for structures, each is 36 bytes
*ptrToDB = malloc (sizeof(struct DBrecord) * numEntries);

//free allocated memory
free(ptrToDB);

//build an array of pointers to dynamically allocated structures
//fill that array with input from data file

//build 7 arrays of pointers to DBrecords, one for each field except DB ID
//sort each a different way
//note the 7 arrays are pointers, no copying

//print each of the 7 sorted arrays

return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:07:04.583

我可以给你一些关于如何看待这个问题的片段。

首先 - 我会避免`class`对任何变量使用名称，因为在许多面向对象的编程语言（包括 C++）中，它是一个关键字，不能是变量的名称。

## 结构 DBrecord

使用 typedef 可能是个好主意。然后你可以声明一个结构变量而不使用“struct DBrecord”，只使用“DBrecord”。但这是可选的。这是它的样子：

```
typedef struct {
   int DBrecordID; // ID for each entry
   char *lastName;
   char *firstName;
   char studentID[8];
   ...
} DBrecord; 
```

## 从文件加载

在这个作业中，您在文件开头有记录数，因此您无需“额外”关心它。只需加载它。

假设文件是​​这样的：

```
2
Doe John 12345678 senior 3.14159 2015
Carl Boss 32315484 junior 2.71 2013 
```

因此，您对文件所做的第一件事就是打开它。

处理文件的可移植方式是使用 FILE 指针。让我展示一下（`stdio.h`必须包括在内）：

```
FILE *filePtr; // Define pointer to file
if((filePtr = fopen("records.txt", "r")) == NULL) // If couldn't open the file
{
   printf("Error: Couldn't open records.txt file.\n"); // Printf error message
   exit(1);  // Exit the program
} 
```

然后，您可以使用 fgets() 逐行读取或 fgetc() 逐行读取文件，以逐行读取文件。这是您可以读取记录数的方式（请记住，它在第一行，我们刚刚打开了文件 - 我们在文件的开头）：

```
char buffer[100]; // Define the buffer
fgets(buffer, 100 /* size of buffer */, filePtr); 
```

现在缓冲区包含第一行（没有 \n 字符） - 记录数。继续将 num 的字符转换为整数（这里`stdlib.h`也必须包括在内）：

```
int numOfRecords = atoi(buffer); 
```

## 分配足够的 DBrecords

现在您知道了记录的数量，您可以为它们分配足够的空间。我们将使用指针数组。

```
DBrecord **recs;
recs = (DBrecord **) malloc(sizeof(DBrecord *) * numOfRecords); 
```

现在我们已经创建了指针数组，所以现在我们需要将每个单独的指针分配为一个 DBrecord。使用周期：

```
int i;
for(i = 0; i < numOfRecords; i++)
{
   recs[i] = (DBRecord *) malloc(sizeof(DBrecord));
} 
```

现在您可以像这样访问数组元素（= 单个记录）：

```
recs[0]->lastname /* two possibilities */
*(recs[0]).lastname 
```

依此类推。

## 用文件中的值填充数组

现在你知道了完成作业的一切。这样你填充数组：

```
int i;
for(i = 0; i < numOfRecords; i++)
{
   // Content of cycle reads one line of a file and parses the values into recs[i]->type...
   /* I give you small advice - you can use fgetc(filePtr); to obtain character by character from the file. As a 'deliminer' character you use space, when you hit newline, then the for cycle continues.
   You know the order of stored values in the file, so it shouldn't be hard for you.
   If you don't get it, let me now in comments */
} 
```

现在是不是更清楚了？

## 编辑：文件名作为主要参数

通常有两种方法可以将参数（值）“传递”给程序。他们是：

```
./program < records.txt   // Here the file's name is passed to program on stdin
./program records.txt    // Here the file's name is passed as value in `argv`. 
```

如果你可以选择，我强烈推荐你第二个。因此，您需要将 main 定义为：

```
int main(int argc, char *argv[])  // this is important!
{
   // code

   return 0;
} 
```

`argc`是整数，表示传递给程序的参数数量。`argv`是存储它们的数组。请记住，第一个参数是程序的名称。因此，如果您需要检查它，请执行以下操作：

```
if(argc != 2)
{
  printf("Number of arguments is invalid\n");
  exit(1); // exit program
} 
```

然后你只`argv[1]`输入`fopen`函数，而不是字符串“records.txt”。

## 编辑 2：从标准输入读取文件名

如果记录文件的名称通过 传递给程序，则必须采用另一种方法`./program < records.txt`，这意味着“records.txt”（不带引号）将被传递（重定向）到程序的标准输入。

因此，要处理这个问题，您可以这样做：

```
char filename[50]; // buffer for file's name
scanf("%s", &filename); // reads standard input into 'filename' string until white character appears (new line, blank, tabulator). 
```

`filename`然后你在字符串中有你想要的文件名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:31:25.913

从哪里开始，从哪里开始......

```
//allocate memory for structures, each is 36 bytes
mem = (double *)malloc(36*numEntries); 
```

1.  malloc 应该是`malloc (sizeof (struct DBRecord) * numEntries);`
2.  不要转换 malloc
    2a 的结果。你忘了`stdlib.h`
3.  为什么包括`class.h`？
4.  你的指针数组不是`double`，而是

    ```
    struct DBRecord **ptrToDB;
    *ptrToDB = malloc (sizeof (struct DBRecord) * numEntries); 
    ```

这应该让你开始。

接下来，`free()`应该是您在离开函数之前做的最后一件事（是的，main 是一个函数）

你必须为下一部分插入一些代码，我不能为你做作业。

# c# - 获取指向字节数组的指针的不安全方法

> ID：10076262
> 
> 赞同：4
> 
> 时间：2012-04-09T16:24:49.337
> 
> 标签：c#, pointers, unsafe

这种行为在 C# 中是否有效

```
public class MyClass
{
    private byte[] data;
    public MyClass()
    {
        this.data = new byte[1024];
    }
    public unsafe byte* getData()
    {
        byte* result = null;
        fixed (byte* dataPtr = data)
        {
            result = dataPtr;
        }
        return result;
    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-09T17:14:29.997

如果您要关闭安全系统，那么**您有责任确保程序的内存安全**。一旦您这样做，**您就需要在没有安全系统帮助的情况下安全地做所有事情**。这就是“不安全”的意思。

正如 C# 规范明确指出的那样：

> 可移动变量的地址只能使用固定语句获得，并且该地址仅在该固定语句的持续时间内保持有效。

您正在获取可移动变量的地址，然后在固定语句的持续时间之后使用它，因此该地址不再*有效*。因此，您被特别要求*不要精确地做您正在做的事情*。

在您对必须遵循的规则有透彻和深入的了解之前，您不应该编写任何不安全的代码。首先阅读规范的所有第 18 章。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-09T16:28:05.307

此代码可以正常编译，但会导致运行时问题。该代码本质上是偷运出指向堆中未固定对象的指针。下一次移动类型的 GC`MyClass`也会移动`data`引用，并且任何先前返回的值`getData`现在都将指向不正确的位置。

```
var obj = new MyClass();
unsafe byte* pValue = obj.getData();
// Assuming no GC has happened (bad assumption) then this works fine
*pValue = 42;

// Assume a GC has now happened and `obj` moved around in the heap.  The 
// following code is now over writing memory it simply doesn't own
*pValue = 42; 
```

最后一行是否导致应用程序崩溃、覆盖`string`另一个类型的值或只是将一个值插入一个未初始化的数组中，然后在其他地方搞砸了一个数学问题？你不知道。最好的结果是代码很快就崩溃了，但很可能它会做一些更微妙和邪恶的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-14T15:05:42.673

您可以使用该`Marshal.StructureToPtr()`方法而不是不安全的魔法:)

> `StructureToPtr`将结构的内容复制到 ptr 参数指向的预分配内存块。

[Marshal.StructureToPtr 方法（对象、IntPtr、布尔值）](http://msdn.microsoft.com/en-us/library/2zhzfk83%28v=vs.110%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T16:28:21.450

此代码将不起作用（它会编译但在运行时会导致问题）。一旦[固定](http://msdn.microsoft.com/en-us/library/f58wzh21.aspx)区域结束，数据就不再固定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T16:30:10.060

不，一旦您离开该`fixed`块， 的值`result`就不再有效（如果 GC 没有运行，它可能巧合地有效）。

执行此类操作的正确方法是引用`byte[]`通过 C# 代码访问的非托管内存中的 a，或者将托管数组复制到非托管内存中。

# java - 使用 java 套接字实现简单的对称加密

> ID：10076266
> 
> 赞同：1
> 
> 时间：2012-04-09T16:25:03.723
> 
> 标签：java, sockets, encryption, encryption-symmetric

我正在编写一个点对点应用程序，我想实现简单的对称加密。

我正在寻找如何做到这一点的一个很好的例子，只要它是免费的，我不介意它使用哪个库。

最好所有加密都发生在套接字层，所以我根本不需要更改我的代码。

有人可以提供这样的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:58:56.410

Java 已经带有[SSL 套接字](http://docs.oracle.com/javase/1.4.2/docs/api/javax/net/ssl/SSLSocket.html)。无需手动实施加密。套接字自己处理一切。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:46:46.387

Java没有内置密码学... Java密码术体系结构（JCA）和Java密码术扩展（JCE）？

[http://docs.oracle.com/javase/1.4.2/docs/guide/security/CryptoSpec.html#ProviderArch](http://docs.oracle.com/javase/1.4.2/docs/guide/security/CryptoSpec.html#ProviderArch)

> Java Cryptography Extension (JCE) 扩展了 JCA API 以包括用于加密、密钥交换和消息验证代码 (MAC) 的 API。JCE 和 SDK 的加密方面一起提供了一个完整的、独立于平台的加密 API。

这是一个如何在 Java 中使用 AES 的示例：

[http://java.sun.com/developer/technicalArticles/Security/AES/AES_v1.html](http://java.sun.com/developer/technicalArticles/Security/AES/AES_v1.html)

> JCE 框架是一个非常强大且灵活的框架，用于使用不同的加密算法。它基于提供程序架构，使相同的框架能够用于更新的加密算法。从开发人员的角度来看，这意味着更高级别的抽象，以及用于更新和不同加密算法的通用 API 集——无需担心算法的内部工作原理。
> 
> 其他一些 Java 安全 API（例如 JSSE）是在 JCE 之上实现的，并对其进行补充以使不同的加密算法（密码、消息验证码 (MAC) 和密钥交换算法）可用于更多开发人员友好的方式。

此外，正如[Kristian Antonsen 提到](https://stackoverflow.com/a/10076761/196921)的，请查看[SSLSocket](http://docs.oracle.com/javase/1.4.2/docs/api/javax/net/ssl/SSLSocket.html)。

* * *

无论如何，这是另一个 Java 密码库：

[http://bouncycastle.org/java.html](http://bouncycastle.org/java.html)

# ios - iOS 不兼容的块指针类型问题

> ID：10076272
> 
> 赞同：14
> 
> 时间：2012-04-09T16:25:14.283
> 
> 标签：ios, objective-c, in-app-purchase, uialertview, mkstorekit

我在使用[MKStoreKit](http://blog.mugunthkumar.com/coding/using-mkstorekit-in-your-apps/)的项目中遇到了实施问题。我正在尝试`UIAlertView`使用各种购买选项来实现。

这是我做各种事情并调用的代码`UIAlertView`：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch 
{    
    if(FALSE == payWallFlag)
    {        
        // Display Alert Dialog
        UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"Subscription Options"
                                                          message:@"You do not have an active subscription. Please purchase one of the options below."
                                                         delegate:self
                                                cancelButtonTitle:@"Cancel"
                                                otherButtonTitles:nil];

        [message addButtonWithTitle:@"7 Day Subscription $0.99"];

        [message show];

        return FALSE;
    } else if(TRUE == payWallFlag)
    {
        // Load content
    }
} 
```

`alertView`这是我试图调用的代码的物理：

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    NSString *title = [alertView buttonTitleAtIndex:buttonIndex];

    if([title isEqualToString:@"Cancel"])
    {
        NSLog(@"Cancel Button was selected.");
    }
    else if([title isEqualToString:@"7 Day Subscription $0.99"])
    {
        NSLog(@"7 Day Subscription button pressed.");
        //Buy a 7 day subscription
        if([SKPaymentQueue canMakePayments]) {
            [[MKStoreManager sharedManager] buyFeature:kFeatureAId onComplete:^(NSString* purchasedFeature)
             {
                 NSLog(@"Purchased: %@", purchasedFeature);
                 // Send an alert to the user
                 UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Purchase Successful"
                                                                 message:@"Thank you. You have successfully purchased a 7 Day Subscription."
                                                                delegate:nil
                                                       cancelButtonTitle:@"OK"
                                                       otherButtonTitles:nil];
                 [alert autorelease];
                 [alert show];

                 // Show the user the content now
                 payWallFlag = TRUE;
                 return TRUE;
             }
                                           onCancelled:^
             {
                 // Send an alert to the user
                 UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Purchase Failed"
                                                                 message:@"Unfortunately you have cancelled your purchase of a 7 Day Subscription. Please try again."
                                                                delegate:nil
                                                       cancelButtonTitle:@"OK"
                                                       otherButtonTitles:nil];
                 [alert autorelease];
                 [alert show];

                 // Block the content again
                 payWallFlag = FALSE;
             }];
        }
        else 
        {
            NSLog(@"Parental control enabled");
            // Send an alert to the user
            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Purchase Failed"
                                                            message:@"Unfortunately Parental Controls are preventing you from purchasing a subscription. Please try again."
                                                           delegate:nil
                                                  cancelButtonTitle:@"OK"
                                                  otherButtonTitles:nil];
            [alert autorelease];
            [alert show];

            // Block the content again
            payWallFlag = FALSE;
        }
    }
} 
```

问题是我收到以下 Xcode 错误消息`UIAlertView`：

> 不兼容的块指针类型将“int (^)(NSString *)”发送到“void (^)(NSString *)”类型的参数

看来问题是：`onComplete:^(NSString* purchasedFeature)`但`onCancelled:^`我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-09T16:29:34.153

你不应该`return TRUE;`从那个块开始，因为编译器假设块返回一个`int`，而它应该返回`void`（因此不兼容的块类型）。

```
...onComplete:^(NSString* purchasedFeature) {
  NSLog(@"Purchased: %@", purchasedFeature);
  // Send an alert to the user
  UIAlertView *alert = [[UIAlertView alloc] ...];
  [alert autorelease];
  [alert show];

  // Show the user the content now
  payWallFlag = TRUE;
  return TRUE; // <--- Remove this line.
}... 
```

对于第二个块（那个`onCancelled`），您可能错过了`NSString*`参数，或者它所期望的任何参数。

# javascript - 谷歌图表：摆脱线偏移？

> ID：10076276
> 
> 赞同：2
> 
> 时间：2012-04-09T16:25:27.097
> 
> 标签：javascript, html, google-visualization

我正在为我的图表使用 Google Visualization API，但我不知道如何格式化折线图。

我的图表看起来像这样：

[http://jsfiddle.net/Pw7Dz/](http://jsfiddle.net/Pw7Dz/)

如何使曲线从轴旁边开始，而不是像现在这样有偏移？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:53:23.960

这是[你](http://jsfiddle.net/L39Gb/1/)需要的吗？

补充：`hAxis: {viewWindow: {min: 0.5, max: 2.5}}`反对`options`。

[此处](https://developers.google.com/chart/interactive/docs/gallery/linechart#Configuration_Options)提供了完整的选项列表。

# iphone - 在 iPhone 上分析 Web 应用程序

> ID：10076279
> 
> 赞同：1
> 
> 时间：2012-04-09T16:25:40.980
> 
> 标签：iphone, profiling

有没有工具可以在 iPhone 上分析 Web 应用程序？

我正在寻找类似 Google 的 Speed Tracer 或 Chrome 开发者工具上的网络选项卡之类的东西。我倒要看看：

*   向服务器发出哪些请求
*   给出了什么 HTTP 响应
*   从缓存中提取哪些项目，以及
*   所有请求的时间表。

理想情况下，这将分析网页以及在本机应用程序中发出的 Web 服务请求。

有什么工具可以做到这一点吗？有没有人有很好的方法来获取这些信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:28:20.513

我认为[weinre](https://github.com/apache/incubator-cordova-weinre)可能正是您想要的。它是一个远程 FireBug 克隆；你在 HTML 中加入一行代码，在桌面上运行服务器，然后在桌面上使用类似 FireBug 的工具；你甚至可以从控制台运行东西，在你的 iPhone 上显示的网页上执行。

不幸的是，这仅适用于网页（或网络应用程序）；我不知道您如何为本机应用程序做到这一点。

**编辑：**要查看所有流量，您可以考虑调试 HTTP 代理，例如[Fiddler](http://www.fiddler2.com/fiddler2/)。在设置 -> WiFi -> [您的接入点] -> DHCP -> HTTP 代理 -> 手动设置您的 iPhone，然后坐下来让 Fiddler 为您计算事情。

# google-maps-api-3 - 如何处理多个信息窗口？

> ID：10076283
> 
> 赞同：0
> 
> 时间：2012-04-09T16:25:52.340
> 
> 标签：google-maps-api-3

每次鼠标在标记上移动时，我都会显示一个信息窗口：

```
var optionMarker = {position:point, map:map,icon:image,shadow:ombre};
  var marker = new g.Marker(optionMarker);
  var infowindow = new g.InfoWindow({content: texte}); 
  g.event.addListener(marker, 'mouseover', function()
  {
      infowindow.open(map,marker);   
  }); 
```

如果我点击几个标记，那么我有几个打开的信息窗口。这些信息窗口是叠加的。从 infowindow 移动到另一个 infowindow 的更好方法是什么？- 通过单击选定的信息窗口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:56:20.847

InfoWindows 似乎没有任何与它们相关的事件（单击、鼠标悬停等），所以我认为下一个最好的事情是操纵标记。我设置了标记，以便当鼠标悬停在它们上方时，链接的 InfoWindow 会上升到顶部。

[http://jsfiddle.net/XCCSL/](http://jsfiddle.net/XCCSL/)

# c++ - C++中的赋值运算符重载

> ID：10076285
> 
> 赞同：37
> 
> 时间：2012-04-09T16:26:04.053
> 
> 标签：c++, operator-overloading

我使用以下代码进行赋值运算符重载：

```
SimpleCircle SimpleCircle::operator=(const SimpleCircle & rhs)
{
     if(this == &rhs)
        return *this;
     itsRadius = rhs.getRadius();
     return *this;
} 
```

我的复制构造函数是这样的：

```
SimpleCircle::SimpleCircle(const SimpleCircle & rhs)
{
    itsRadius = rhs.getRadius();
} 
```

在上面的运算符重载代码中，复制构造函数被调用，因为正在创建一个新对象；因此我使用了以下代码：

```
SimpleCircle & SimpleCircle::operator=(const SimpleCircle & rhs)
{
    if(this == &rhs)
       return *this;
    itsRadius = rhs.getRadius();
    return *this;
} 
```

它工作得很好并且避免了复制构造函数问题，但是（对我来说）有任何未知问题吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-09T16:30:24.940

赋值运算符的第二个版本没有问题。事实上，这是赋值运算符的标准方式。

**编辑**：请注意，我指的是赋值运算符的返回类型，而不是实现本身。正如评论中所指出的，实施本身是另一个问题。见[这里](http://en.wikibooks.org/wiki/More_C++_Idioms/Copy-and-swap)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-09T16:30:51.060

第二个很标准。您通常更喜欢从赋值运算符返回引用，以便像`a = b = c;`预期的那样解析语句。我想不出任何我想从作业中返回副本的情况。

需要注意的一件事是，如果您不需要深度复制，有时认为最好使用编译器生成的隐式复制构造函数和赋值运算符，而不是自己滚动。真的取决于你...

**编辑：**

以下是一些基本调用：

```
SimpleCircle x; // default constructor
SimpleCircle y(x); // copy constructor
x = y; // assignment operator 
```

现在假设我们有您的赋值运算符的第一个版本：

```
SimpleCircle SimpleCircle::operator=(const SimpleCircle & rhs)
{
     if(this == &rhs)
        return *this; // calls copy constructor SimpleCircle(*this)
     itsRadius = rhs.getRadius(); // copy member
     return *this; // calls copy constructor
} 
```

它调用复制构造函数并传递一个引用以`this`构造要返回的副本。现在在第二个例子中，我们通过返回一个引用来避免复制`this`

```
SimpleCircle & SimpleCircle::operator=(const SimpleCircle & rhs)
{
    if(this == &rhs)
       return *this; // return reference to this (no copy)
    itsRadius = rhs.getRadius(); // copy member
    return *this; // return reference to this (no copy)
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-09T16:34:32.023

在这种情况下，您几乎肯定最好跳过检查自分配 - 当您只分配一个似乎是简单类型（可能是双精度）的成员时，执行该分配通常比避免分配更快它，所以你最终会得到：

```
SimpleCircle & SimpleCircle::operator=(const SimpleCircle & rhs)
{
    itsRadius = rhs.getRadius(); // or just `itsRadius = rhs.itsRadius;`
    return *this;
} 
```

我意识到许多较旧和/或质量较低的书籍建议检查自我分配。但是，至少根据我的经验，没有它会更好的情况非常罕见（如果操作员依赖它来确保正确性，那么它几乎肯定不是异常安全的）。

顺便说一句，我注意到要定义一个圆，您通常需要一个中心和一个半径，当您复制或分配时，您希望同时复制/分配两者。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-06-01T15:52:45.567

```
#include<iostream>

using namespace std;

class employee
{
    int idnum;
    double salary;
    public:
        employee(){}

        employee(int a,int b)
        {
            idnum=a;
            salary=b;
        }

        void dis()
        {
            cout<<"1st emp:"<<endl<<"idnum="<<idnum<<endl<<"salary="<<salary<<endl<<endl;
        }

        void operator=(employee &emp)
        {
            idnum=emp.idnum;
            salary=emp.salary;
        }

        void show()
        {
            cout<<"2nd emp:"<<endl<<"idnum="<<idnum<<endl<<"salary="<<salary<<endl;
        }
};

main()
{
    int a;
    double b;

    cout<<"enter id num and salary"<<endl;
    cin>>a>>b;
    employee e1(a,b);
    e1.dis();
    employee e2;
    e2=e1;
    e2.show();  
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T16:34:43.453

这是使用运算符重载的正确方法，现在您可以通过引用避免值复制来获取对象。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-09-24T14:19:21.767

这可能会有所帮助：

```
// Operator overloading in C++
//assignment operator overloading
#include<iostream>
using namespace std;

class Employee
{
private:
int idNum;
double salary;
public:
Employee ( ) {
    idNum = 0, salary = 0.0;
}

void setValues (int a, int b);
void operator= (Employee &emp );

};

void Employee::setValues ( int idN , int sal )
{

salary = sal; idNum = idN;

}

void Employee::operator = (Employee &emp)  // Assignment operator overloading function
{
salary = emp.salary;
}

int main ( )
{

Employee emp1;
emp1.setValues(10,33);
Employee emp2;
emp2 = emp1; // emp2 is calling object using assignment operator

} 
```

# c++ - 在地图向量中查找对

> ID：10076288
> 
> 赞同：0
> 
> 时间：2012-04-09T16:26:10.513
> 
> 标签：c++, stl, map, vector

我正在使用以下函数来尝试在地图向量中查找地图元素的键。

```
Entry* SymTab::lookup(const char* name)
{
for (int i=0;i<table.size();i++) //table is the vector
 {
  map<const char*, Entry, ltstr>::iterator its= table.at(i).find(name); 
    if (its != cur.end())
    {
    Entry* obj = &its->second;
    cout<<(*its).first<<endl;
    return obj;
    }

  }
} 
```

该函数正确返回第一个向量索引 (at(0)) 内的任何项目的值。但是每当我尝试访问第二个索引（at（1））中的元素时，它就会出现段错误。我确信地图已正确插入并填充在第二个索引处。

有人在这里看到这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:32:59.907

> 有人在这里看到这个问题吗？

是的。`cur`不跟踪当前地图。

尝试将`if`行替换为：

```
if (its != table.at(i).end()) 
```

# xcode - 确定 GUI 程序在空闲时消耗 CPU 周期的原因

> ID：10076291
> 
> 赞同：0
> 
> 时间：2012-04-09T16:26:16.487
> 
> 标签：xcode, debugging, user-interface

我的程序包含一个小部件类的孩子，并且为孩子重新定义了 paint() 函数。

即使在空闲时，该程序也会消耗大量 CPU 周期。我的paint() 函数中的 printf() 显示仅在我希望调用它时才调用paint()。

我还能尝试什么来定位消费的来源？

**添加**

让我回到一些真正基本的东西。在 XCode 3 中曾经有一个构建设置可以在“调试”和“发布”构建之间进行选择，但我在 XCode 4 中不再看到这样的设置。如何生成调试构建？也许我最初的问题的答案就像在程序处于空闲循环时按“暂停”（另一个消失的按钮）一样简单。（我应该补充一点，循环本身属于工具包，而不是我的代码。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:37:06.843

假设这是 MacOS Xcode 开发，你可以使用 Xcode 自带的[profiler](http://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/Introduction/Introduction.html)。

如果没有，请使用任何可用的分析器。

如果没有可用的分析器，请开始慢慢地从应用程序中剥离功能。或者也许不是很慢，而是进行二分搜索（即去掉一半的功能）。什么都容易。

根据您的应用程序做第三件事（即删除而不是使用分析器）实际上可能是最快的胜利途径，但值得花一些时间学习使用分析器。

# ruby-on-rails - Ruby - 编写一个基本的控制器

> ID：10076296
> 
> 赞同：2
> 
> 时间：2012-04-09T16:26:57.207
> 
> 标签：ruby-on-rails, ruby

我正在尝试学习 Ruby on Rails 并尝试手动编写一些代码，以便了解它是如何工作的。

我做了这个小控制器：

```
class TestsController < ApplicationController
  def test

      def show
        render :text => "Hi from TestsController!"
      end  

  end
end 
```

这就是我的观点：

```
<h3> Hello test </h3> 
```

这是我的 routes.rb 片段：

```
resource :test 
```

但它给出了一个错误：`The action 'show' could not be found for TestsController`

谢谢！

这是 rake 路由的输出：

```
home_index GET    /home/index(.:format) home#index
      root        /                     home#index
      test POST   /test(.:format)       tests#create
  new_test GET    /test/new(.:format)   tests#new
 edit_test GET    /test/edit(.:format)  tests#edit
           GET    /test(.:format)       tests#show
           PUT    /test(.:format)       tests#update
           DELETE /test(.:format)       tests#destroy 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:33:47.347

一个基本的控制器如下所示：

```
class TestsController < ApplicationController
  def show
  end
end 
```

`respond_to`如果您只想渲染默认视图（在本例中为：），则不需要该块`app/views/tests/show.html.erb`。障碍是当`respond_to`您有一些更高级的需求时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T17:30:27.773

@klump 说的是正确的。尝试运行一个基本的脚手架。这将为您生成控制器、模型和视图。当您学习 Rails 时，这个生成器非常棒。

```
 rails g scaffold Test 
```

还可以查看[http://www.railsforzombies.com](http://www.railsforzombies.com)，因为它是学习 Rails 的好方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T16:43:30.200

`respond_to`当您希望您的操作响应多种格式时使用。客户端在 HTTP Accept 标头中设置所需的格式。

然后，您可以为每种格式指定不同的操作。

### 例子

```
def show
    respond_to do |format|
       format.html { Rails.logger.debug "rendering show.html" }
       format.xml { Rails.logger.debug "rendering show.xml" }
       format.js { Rails.logger.debug "rendering show.js" }
    end
end 
```

有关更多示例，请参阅[API](http://apidock.com/rails/ActionController/MimeResponds/InstanceMethods/respond_to)。

# python - Python：使用 sympy.sympify 对数学函数执行安全 eval()

> ID：10076300
> 
> 赞同：4
> 
> 时间：2012-04-09T16:27:07.127
> 
> 标签：python, parsing, eval, sympy

我正在编写一个程序，用户需要能够使用自写的数学函数，其中包含来自 numpy 和 scipy 的函数，例如。**scipy.special.wofz()**。

这些函数将存储在文件中，并由程序作为字符串导入。我环顾四周，发现**eval()**或**exec()**不是一种安全的方法。例如。[在这里](https://stackoverflow.com/questions/3513292/python-make-eval-safe)。

安全问题是好用户从可以访问好用户系统的坏用户那里加载文件。

我正在考虑做这样的事情：

```
#!/bin/python
from scipy.special import *
from numpy import *
import sympy

# Define variable a
vars = {"a":1}
# This is the string I get from a file
string = "wofz(a)"

parsed_string = sympy.sympify(string)
parsed_string.evalf(subs=vars) 
```

但是，这不起作用。它只返回：

```
wofz(a) 
```

wofz(a) 不被评估。这甚至应该这样工作吗？

我有另一个想法：所以我想，一旦这个数学函数通过 sympify，它应该是安全的。我可以简单地做这样的事情：

```
globals = {wofz:wofz}
eval(str(parsed_string), vars, globals) 
```

工作正常并返回：

```
(0.36787944117144233+0.60715770584139372j) 
```

那安全吗？我知道这不好。

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T16:32:00.313

使用 sympy，这是一种更安全的选择。

```
import sympy
from sympy.core.function import Function
from sympy.core import S
from sympy import sympify
from sympy.functions import im
from scipy.special import wofz

class Wofz(Function):
    is_real = True
    @classmethod
    def _should_evalf(csl,arg):
        return True
    def as_base_exp(cls):
        return cls,S.One

    def _eval_evalf(cls, prec):
        return sympy.numbers.Number(im(wofz(float(cls.args[0]))))

print sympify("Wofz(2)",{'Wofz':Wofz}).evalf() 
```

输出（你必须以某种方式处理虚部）：

```
0.340026217066065 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-24T12:10:31.167

如果字符串是唯一不受信任的信息，我认为以下内容应该是安全的：

要使用`eval()`受限制的词汇表，请将第二个参数传递给它，这是一个允许名称的字典，其中`__builtins__`定义为无害的东西（请参阅[http://docs.python.org/library/functions.html#eval](http://docs.python.org/library/functions.html#eval)）。

```
>>> import numpy as np
>>> d = dict(linspace=np.linspace, range=range, __builtins__=None)
>>> eval("str(1), 2+2")
('1', 4)
>>> eval("str(1)", d)
Traceback (most recent call last)
NameError: name 'str' is not defined

>>> eval("{'a': linspace(0, 0.5, 6)}, range(2)", d)
({'a': array([ 0\. ,  0.1,  0.2,  0.3,  0.4,  0.5])}, [0, 1])
>>> eval("linspace.__dict__", d)
Traceback (most recent call last)
RuntimeError: function attributes not accessible in restricted mode 
```

# jquery - 计算字符串中的字符数但想跳过注释

> ID：10076302
> 
> 赞同：1
> 
> 时间：2012-04-09T16:27:10.337
> 
> 标签：jquery

我想计算从 div 标签中提取的字符串中的字符数，如下所示：

```
$(".welcome-msg").html().length; 
```

但是，它将 HTML 注释计为标记内的字符。因此，当我希望结果为 0 时，由于这些评论，我得到 99，而且我无法判断评论是否是动态的。有没有一种简单的方法可以确保评论不被计算在内？还是我必须为此编写正则表达式？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T16:41:28.857

您可以过滤掉评论，但这并不容易。我将向您展示如何在第一级过滤它们，这很容易，但如果它们嵌套在其他标签中，那么您需要执行额外的逻辑。

关键是要`.contents()`得到所有的节点。这包括评论节点。[然后，您可以通过对nodeType](http://reference.sitepoint.com/javascript/Node/nodeType)进行比较来过滤掉注释节点。

所以它会是这样的：

```
$(".welcome-msg").contents().filter(function() { 
  return this.nodeType != 8;
}).appendTo("<div>").parent().html(); 
```

这将适用于

```
<div class=".welcome-msg">
   <!--Comment --><span>hello</span>
</div> 
```

但不是为了

```
<div class=".welcome-msg">
    <span><!--Comment -->hello </span> world 
</div> 
```

您需要递归地遍历所有标签，然后它将适用于所有内容。

使用正则表达式，您需要注意`<script>`标签和`<style>`标签。

这是[jsfiddle](http://jsfiddle.net/xYR5p/)

## 更新（递归过滤器）

递归地执行它实际上很容易：

[http://jsfiddle.net/xYR5p/3/](http://jsfiddle.net/xYR5p/3/)

为它制作了一个完整的插件：

```
$.fn.removeComments = function() {
    this.contents().filter(function() {
        return this.nodeType == 8;  
    }).remove();

    this.children().each(function() {
       $(this).removeComments(); 
    });

    return this;
};

console.log($(".welcome-msg").clone().removeComments().html());​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T16:34:02.467

```
var myhtml = $(".welcome-msg").html();
myhtml = myhtml.replace(/<!--.*?-->/sg, ""); 
myhtml.length(); 
```

regex from here [StackOverflow: Remove HTML comments with Regex, in Javascript](https://stackoverflow.com/questions/5653207/remove-html-comments-with-regex-in-javascript)

# iphone - 我们可以使用核心数据来存储房地产吗？

> ID：10076304
> 
> 赞同：1
> 
> 时间：2012-04-09T16:27:21.330
> 
> 标签：iphone, ios, sqlite, core-data

我需要知道我应该用什么来存储财产？
我仍然很困惑。我应该使用 SQLit 还是核心数据？
我会有很多数据，用户数据和房地产数据。它也会出现在地图中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:05:26.620

Core Data 包含 sqlite 作为存储工具。它不是一个实际的数据库，而是一个[图形数据库](http://en.wikipedia.org/wiki/Graph_database)。

另一方面，SQLite 是一个数据库。不同的方法，可以有效地用于小块数据（我广泛使用它），并且主要用于实现纯 RDBMS 系统（使用主/外键、联合和类似的东西，由 SQL 驱动）。

对于 Core Data，您使用图关系（这意味着对象通过引用连接到其他对象）。

结果是相同的，但编程不同，具体取决于您希望在应用程序中拥有（或实际设计）的复杂性，因此请制定计划，看看哪一个适合您。对于 SQLite，我推荐 FMDB 包装器，因为它更容易而不是对每个 SQL 语句进行 2 到 3 次检查。

你的应用看起来很有趣，因为它是基于房地产的，你可能想稍后用一种叫做“增强现实”的小技术来为它增添趣味:)

# asp.net - RegisterExpandoAttribute - 抛出错误

> ID：10076306
> 
> 赞同：1
> 
> 时间：2012-04-09T16:27:34.083
> 
> 标签：asp.net, custom-attributes, clientscriptmanager

最近，我发现使用： someControl.Attributes.Add("customAttr", "customVal") 并不兼容所有的网络浏览器。自定义属性的推荐注册是：

```
Page.ClientScript.RegisterExpandoAttribute(someControl.ClientID, "customAttr", "customVal") 
```

好的，这就是问题所在。我正在使用 ListView 生成自定义控件。在某些情况下，必须刷新/重新创建 ListView。发生这种情况时，ListView 项尝试注册（在本例中为重新注册）expando 属性，页面将引发以下错误：

已存在具有相同键的条目。

显然 RegisterExpandoAttribute() 的行为不像 Page.Cache 对象，如果键已经存在，则覆盖当前值。我可以轻松解决这个问题，但我想知道是否有更优雅的解决方案。例如，没有类似的方法： Page.ClientScript.IsExpandoAttributeRegistered(...)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T13:50:02.720

如果您正在创建自定义控件，请尝试在`RegisterExpandoAttribute`控件期间进行调用`PreRender`。如果控件已被删除并且这样做解决了我的问题，我仍然在注册属性时遇到问题。我想如果你调用控件`RegisterExpandoAttribute`，`PreRender`那么每个页面加载不应该多次调用它。

# java - 如何在 Android 画布上绘制数学函数图

> ID：10076307
> 
> 赞同：0
> 
> 时间：2012-04-09T16:27:45.193
> 
> 标签：java, android, render, android-canvas

如何在 Android 应用程序的[Canvas](http://developer.android.com/reference/android/graphics/Canvas.html)`y = x^2`上绘制函数图（例如，或 y = (x +1)/(2*x +3)） ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-15T00:40:56.303

这里有一个示例代码；D（绘制 f(x)=x^3 函数）

绘制函数的示例线程。

```
public class MainThread extends Thread {
private static final String TAG = MainThread.class.getSimpleName();
private SurfaceHolder surfaceHolder;
private MainGamePanel gamePanel;
private Paint paintRed;
private Paint paintBlue;
private boolean running;

public void setRunning(boolean running) {
    this.running = running;
}

public MainThread(SurfaceHolder surfaceHolder, MainGamePanel gamePanel) {
    super();

    this.paintRed = new Paint();
    this.paintRed.setColor(Color.RED);
    this.paintRed.setStrokeWidth(1);

    this.paintBlue = new Paint();
    this.paintBlue.setColor(Color.BLUE);
    this.paintBlue.setStrokeWidth(1);

    this.surfaceHolder = surfaceHolder;
    this.gamePanel = gamePanel;
}

class MeasuredAxis {
    public static final int X_GAP = 1;
    public static final int Y_GAP = 1;

    int _realHeight;
    int _realWidth;

    public MeasuredAxis(int width, int height) {
        _realWidth = width;
        _realHeight = height;
    }

    public int getXAxisNegLimit() {
        return (_realWidth / 2)*(-1);
    }

    public int getXAxisLimit() {
        return (_realWidth / 2);
    }

    public float getXMeasured(int x) {
        return ((_realWidth / 2) + x);
    }

    public float getYMeasured(float y) {
        return ((_realHeight / 2) - y);
    }
}

private float function(float x) {
    return new Double(Math.pow(x, 3)).floatValue();
}

@Override
public void run() {
    long fps = 0L;
    Log.d(TAG, "Starting game loop");
    Canvas canvas = surfaceHolder.lockCanvas();

    MeasuredAxis measured = new MeasuredAxis(canvas.getWidth(), canvas.getHeight());

    synchronized (canvas) {
        int x = measured.getXAxisNegLimit();
        //from -x to +x evaluate and plot the function
        while (x++ < measured.getXAxisLimit()) {
            canvas.drawLine(
                    measured.getXMeasured(x),
                    measured.getYMeasured(function(x)),
                    measured.getXMeasured(x+MeasuredAxis.X_GAP),
                    measured.getYMeasured(function(x+MeasuredAxis.Y_GAP)),
                    paintRed);
        }
        canvas.save();
        canvas.translate(0, 0);
        canvas.scale(canvas.getWidth(), canvas.getHeight());
        canvas.restore();

    }
    surfaceHolder.unlockCanvasAndPost(canvas);

}
    } 
```

绘制函数的示例表面视图。

```
 public class MainGamePanel extends SurfaceView implements
    SurfaceHolder.Callback {
private MainThread thread;

public MainGamePanel(Context context) {
    super(context);
    getHolder().addCallback(this);
    // create the game loop thread
    thread = new MainThread(getHolder(), this);
    setFocusable(true);
}

@Override
public void surfaceChanged(SurfaceHolder holder, int format, int width,
        int height) {
}

@Override
public void surfaceCreated(SurfaceHolder holder) {
    thread.setRunning(true);
    thread.start();
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    boolean retry = true;
    while (retry) {
        try {
            thread.join();
            retry = false;
        } catch (InterruptedException e) {
            // try again shutting down the thread
        }
    }
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    return super.onTouchEvent(event);
}

@Override
protected void onDraw(Canvas canvas) {

}
    } 
```

还有一个示例活动

```
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(new MainGamePanel(this));
}
} 
```

希望这对你有帮助！

# model-view-controller - MVC 模式：视图是否应该引用模型

> ID：10076309
> 
> 赞同：0
> 
> 时间：2012-04-09T16:27:53.327
> 
> 标签：model-view-controller, design-patterns

在 MVC 模式中：当用户键入内容时，Control 会将用户输入“翻译”到 Model 以处理数据。

但是，在其他场景中，例如我的表单有一个列表框，并在加载时从数据库加载数据。所以，加载方法我应该放在 View 中，或者我应该通过 Control 调用它。

例如： 查看：

```
public void Loading(){
   //some init here
   //load data from database
}
public void Loading(){
   //some init here
   //control.loadDatabase();
} 
```

在这个模式中哪个是最好的。请给我一个建议。

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:34:43.927

模型和视图之间的关系由称为[观察者](http://en.wikipedia.org/wiki/Observer_pattern)的设计模式描述，其中模型是主体，视图是观察者。这意味着当有新数据可用时，模型会通知视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T17:32:18.070

列表框是视图的一部分，因此您应该使用控制器加载它！在 mvc 中，视图对模型一无所知。因此您可以在不更改视图的情况下更改模型，反之亦然。

# haskell - 条件中的意外分号

> ID：10076318
> 
> 赞同：6
> 
> 时间：2012-04-09T16:28:22.987
> 
> 标签：haskell, cabal

我有以下代码行，当使用 GHC 编译时，它会顺利进行：

```
addRDF c (Just (FILE))  = do
  (_:file:_) <- getArgs
  check <- doesFileExist file
  if check then do rdfG <- TLI.readFile file >>= (return . parseN3fromText)
                   case rdfG of (Left s)  -> putStrLn s
                                (Right g) -> storeRDF c g
  else do putStrLn "Specified files does not exist" 
```

但是当我通过 cabal 构建过程运行它时，它会输出以下错误。

```
Repository/Adder.hs:46:35:
    Unexpected semi-colons in conditional:
    if check then do { rdfG <- TLI.readFile file
                             >>=
                               (return . parseN3fromText);
                       case rdfG of {
                         (Left s) -> putStrLn s
                         (Right g) -> storeRDF c g } }; else do { putStrLn
                                                                    "Specified files does not exist" }
Perhaps you meant to use -XDoAndIfThenElse? 
```

我可以在错误中看到额外的分号，但我不明白它来自哪里。

这是我的 cabal 配置文件：

```
cabal-version: >= 1.2
build-type: Simple

library
  build-depends:
    base,
    containers,
    HTTP >= 4000.2.2,
    directory >= 1.1.0.0,
    text >= 0.11.1.13,
    swish >= 0.6.5.2
  exposed-modules: Repository.Adder, Repository.Configuration
  ghc-options: -Wall

executable repository-add
  main-is: repository-add.hs
  build-depends:
    MissingH,
    swish >= 0.6.5.2,
    split >= 0.1.4.2
  ghc-options: -Wall 
```

**更新**

使用正确的缩进`if`：

```
addRDF c (Just (FILE))  = do (_:file:_) <- getArgs
  check <- doesFileExist file
  if check
  then do rdfG <- TLI.readFile file >>= (return . parseN3fromText)
          case rdfG of (Left s)  -> putStrLn s
                       (Right g) -> storeRDF c g
  else do putStrLn "Specified files does not exist" 
```

我现在也得到一个分号`check`：

```
Repository/Adder.hs:46:35:
    Unexpected semi-colons in conditional:
        if check; then do { rdfG <- TLI.readFile file
                                  >>=
                                    (return . parseN3fromText);
                            case rdfG of {
                              (Left s) -> putStrLn s
                              (Right g) -> storeRDF c g } }; else do { putStrLn
                                                                         "Specified files does not exist" }
    Perhaps you meant to use -XDoAndIfThenElse? 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-09T16:41:29.690

您的缩进不正确，但是当您使用原始 GHC 编译器时它可以工作，因为它会自动打开错误消息 ( `DoAndIfThenElse`) 中提到的语法扩展。

在 Cabal 中，您必须在代码文件的顶部或在 Cabal 文件中手动指定您使用的语言扩展；否则，编译器将不会启用它们。

if 子句缩进的一个正确版本是这样的：

```
if check
  then do
    rdfG <- TLI.readFile file >>= (return . parseN3fromText)
    case rdfG of
      (Left s)  -> putStrLn s
      (Right g) -> storeRDF c g
  else putStrLn "Specified files does not exist" 
```

您必须将`then`零件和`else`零件保持在比它们所属的块更深的缩进级别。

# python - 如何从类中声明全局变量？

> ID：10076320
> 
> 赞同：10
> 
> 时间：2012-04-09T16:28:23.113
> 
> 标签：python, class

我试图从一个类中声明一个全局变量，如下所示：

```
class myclass:
    global myvar = 'something' 
```

我需要在类之外访问它，但我不想在类文件之外声明它。我的问题是，这可能吗？如果是这样，语法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-09T16:33:40.723

在您的问题中，您指定“在主文件之外”。如果您的意思不是“在类之外”，那么这将用于定义模块级变量：

```
myvar = 'something'

class myclass:
    pass 
```

然后你可以这样做，假设类和变量定义在一个名为的模块中`mymodule`：

```
import mymodule

myinstance = myclass()
print mymodule.myvar 
```

此外，为了回应您对@phihag 回答的评论，您可以访问 myvar unqualified ，如下所示：

```
from mymodule import myvar

print myvar 
```

如果您只想从另一个文件中访问它的简写，同时仍在类中定义它：

```
class myclass:
    myvar = 'something' 
```

然后，在您需要访问它的文件中，在本地命名空间中分配一个引用：

```
myvar = myclass.myvar

print myvar 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T16:37:47.437

你真的应该重新考虑这是否真的有必要，这似乎是一种奇怪的方式来构建你的程序，你应该使用更正确的 phihag 方法。

如果您决定仍要这样做，您可以这样做：

```
>>> class myclass(object):
...     global myvar
...     myvar = 'something'
...
>>> myvar
'something' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-09T16:43:48.370

你可以这样做

```
# I don't like this hackish way :-S
# Want to declare hackish_global_var = 'something' as global
global_var = globals()
global_var['hackish_global_var'] = 'something' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T16:30:19.390

您可以简单地为类分配一个属性：

```
class myclass(object):
   myvar = 'something'

# alternatively
myclass.myvar = 'else'

# somewhere else ...
print(myclass.myvar) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-09T16:38:43.567

回答你的问题

```
global s
s = 5 
```

会做的。不过，您会遇到问题，具体取决于您在课堂上的哪个位置执行此操作。远离函数以获得你想要的行为。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-29T11:17:51.753

类中的全局变量也可以定义为：

```
 class Classname:
       name = 'Myname'

    # To access the variable name in a function inside this class:
    def myfunc(self):
        print(Classname.name) 
```

# sql - 使用嵌套回复对评论进行排序

> ID：10076321
> 
> 赞同：1
> 
> 时间：2012-04-09T16:28:26.520
> 
> 标签：sql, tsql

我正在尝试提出一个查询，该查询将在他们的回复及其回复之后返回评论。

就像是

```
comment 1
reply 1.1
reply 1.1.1
reply 1.2
comment 2
comment 3
comment 3.1 
```

ETC

到目前为止我有这个

```
SELECT [CommentID]
  ,[ParentID]
  ,[Message]
  , ROW_NUMBER() over(partition by ParentID order by CommentID ) as rn
  ,[CreatedBy]
  ,[CreatedDate]
  FROM [DBNAME].[dbo].[Commenttable] 
  GROUP BY [CommentID],[ParentID],[CreatedDate],[Message],[CreatedBy] 
```

但我得到的是

```
comment 1
comment 2
comment 3
reply 1.1
reply 1.2
reply 3.1
reply 1.1.1 
```

基本结构只是一个包含评论 ID、父 ID 和消息的表。评论和回复只是为了帮助解释我想要实现的目标

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:57:51.030

试试这个：

```
declare @CommentTable as Table ( CommentId Int Identity, ParentId Int Null, Message VarChar(16) )
insert into @CommentTable ( ParentId, Message ) values
  ( null, '1' ),
  ( null, '2' ), ( 1, '1.1' ),
  ( null, '3' ), ( 4, '3.1' ), ( 3, '1.1.1' ), ( 1, '1.2' )
select * from @CommentTable

; with Cindy as (
  -- Start with the base comments.
  select CommentId, ParentId, Message, Row_Number() over ( order by CommentId ) as Number,
    Cast( Row_Number() over ( order by CommentId ) as VarChar(1000) ) as Path,
    Cast( Right( '0000' + Cast( Row_Number() over ( order by CommentId ) as VarChar(4) ), 5 ) as VarChar(1000) ) as OrderPath
    from @CommentTable
    where ParentId is NULL
  union all
  -- Add replies on layer at a time.
  select CT.CommentId, CT.ParentId, CT.Message, Row_Number() over ( order by CT.CommentId ),
    Cast( C.Path + '.' + Cast( Row_Number() over ( order by CT.CommentId ) as VarChar(4) ) as VarChar(1000) ),
    Cast( C.OrderPath + Right( '0000' + Cast( Row_Number() over ( order by CT.CommentId ) as VarChar(4) ), 5 ) as VarChar(1000) )
    from @CommentTable as CT inner join
      Cindy as C on C.CommentId = CT.ParentId
  )
  select *
    from Cindy
    order by OrderPath 
```

# android - 是否有 jQuery Mobile 相当于 Android 的 ViewPager？

> ID：10076329
> 
> 赞同：2
> 
> 时间：2012-04-09T16:29:11.560
> 
> 标签：android, jquery, jquery-mobile, horizontal-scrolling

我想使用 jQuery Mobile 创建一个水平滑动效果。在做了一些研究后，我发现[`ViewPager`](http://android-developers.blogspot.com/2011/08/horizontal-view-swiping-with-viewpager.html)通常在 Android Market 的应用程序详细信息页面中找到的 ，可以满足我的需求。在指定的页面中，作者描述了它以及Android中的代码，但我想知道jQM中是否有等效的插件或功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:44:22.960

我喜欢[SwipeJS](http://swipejs.com/)，它是轻量级的，我喜欢它使用的一对一滑动因子（当你的手指在元素上滑动时，它以相同的速度移动）。

还有一个运行良好的[iScroll 4](http://cubiq.org/iscroll-4)（它似乎比 SwipeJS 更难设置）。

但是，您可以使用 jQuery Mobile 中的内置`swipe`事件。您可以绑定到元素的`swipeleft`or`swiperight`事件，`data-role="page"`并根据当前页面将用户导航到正确的页面：

```
$(document).delegate('#page-two', 'swipeleft', function () {
    //next page
    $.mobile.changePage($('#page-three'));
}).delegate('#page-two', 'swiperight', function () {
    //prev page
    $.mobile.changePage($('#page-one'), { reverse : true });
}); 
```

这是一个演示：http: [//jsfiddle.net/fFGvD/](http://jsfiddle.net/fFGvD/)

注意`{ reverse : true }`作为选项对象传递给`changePage()`函数的对象，因此动画将反向播放。

# xml - XSLT - 选择没有属性的节点

> ID：10076331
> 
> 赞同：3
> 
> 时间：2012-04-09T16:29:13.303
> 
> 标签：xml, xslt, logic

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:03:35.473

我会定义一个键来将具有该属性的元素映射到要插入它们的前一个兄弟：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:cci="urn:schemas-ccieurope.com"
    xmlns:ccit="http://www.ccieurope.com/xmlns/ccimltables" xmlns:ccix="http://www.ccieurope.com/xmlns/ccimlextensions"
    exclude-result-prefixes="xsl cci ccit ccix">

    <xsl:key name="k1" match="cci:p[@ccix:annotation = 'insertion']"
      use="generate-id(preceding-sibling::cci:p[not(@ccix:annotation)][1])"/>

    <xsl:strip-space elements="*" />
    <xsl:output method="html" encoding="UTF-8" />

    <xsl:template match="/">
        <html>
            <xsl:apply-templates />
        </html>
    </xsl:template>

    <xsl:template match="cci:p[not(@ccix:annotation)]">
      <p>
        <xsl:apply-templates select="node() | key('k1', generate-id())/node()"/>
      </p>
    </xsl:template>

    <xsl:template match="cci:p[@ccix:annotation = 'insertion']"/>

    <xsl:template match="cci:italic">
        <em>
            <xsl:apply-templates />
        </em>
    </xsl:template>

    <xsl:template match="cci:endnote_contrib">
        <em>
            <xsl:apply-templates />
        </em>
    </xsl:template>

    <xsl:template match="cci:extra_leading">
    </xsl:template>

    <xsl:template match="cci:bold">
        <strong>
            <xsl:apply-templates />
        </strong>
    </xsl:template>

    <xsl:template match="cci:subhead">
        <h2 class="cci-subhead">
            <xsl:value-of select="." />
        </h2>
    </xsl:template>

    <xsl:template match="ccit:table">
        <table class="cci-table">
            <xsl:apply-templates />
        </table>
    </xsl:template>

    <xsl:template match="ccit:tr">
        <tr>
            <xsl:apply-templates />
        </tr>
    </xsl:template>

    <xsl:template match="ccit:td">
        <td>
            <xsl:value-of select="." />
        </td>
    </xsl:template>

    <xsl:template match="cci:l_category">
        <h2 class="cci-category">
            <xsl:value-of select="." />
        </h2>
    </xsl:template>

    <xsl:template match="cci:l_category_sub">
        <h2 class="cci-category-sub">
            <xsl:value-of select="." />
        </h2>
    </xsl:template>

    <xsl:template match="cci:l_region">
        <h2 class="cci-region">
            <xsl:value-of select="." />
        </h2>
    </xsl:template>

    <xsl:template match="cci:l_region_location">
        <h2 class="cci-region-location">
            <xsl:value-of select="." />
        </h2>
    </xsl:template>

    <xsl:template match="cci:l_region_sub">
        <h2 class="cci-region-sub">
            <xsl:value-of select="." />
        </h2>
    </xsl:template>

    <xsl:template match="factbox_bold">
        <strong>
            <xsl:apply-templates />
        </strong>
    </xsl:template>

    <xsl:template match="cci:factbox_head">
        <strong>
            <xsl:value-of select="." />
        </strong>
    </xsl:template>

    <xsl:template match="cci:z_sym_round_bullet">
        &#8226;
        <xsl:value-of select="." />
    </xsl:template>

    <xsl:template match="cci:z_sym_triangle_bullet">
        &#8226;
        <xsl:value-of select="." />
    </xsl:template>

    <xsl:template match="text()">
        <xsl:value-of select="." />
    </xsl:template>
</xsl:stylesheet> 
```

使用该样式表 Saxon 6.5.5 输出结果

```
<html>
   <p>OAKLAND, Calif. &#8212; A former student suspected of opening fire at a small Christian college in California, killing seven people
      and wounding three, was targeting a school administrator and former classmates who he felt had treated him unfairly, police
      said yesterday.
   </p>
   <p>Oakland Police Chief Howard Jordan said at a news conference that One Goh, 43, who had been expelled from Oikos University,
      had been cooperative with investigators after being taken into custody but &#8220;not particularly remorseful.&#8221;
   </p>
   <p>&#8220;We know that he came here with the intent of locating an administrator, and she was not here,&#8221; Jordan said. &#8220;He then went
      through the entire building systematically and randomly shooting victims.&#8221;
   </p>
   <p>The midmorning attack at Oikos, a small Oakland college that has links to the Korean-American Christian community, was the
      deadliest shooting rampage on a U.S. college campus since 
   </p>
</html> 
```

对于输入

```
<cci:body class="element" displayname="body" name="body" xmlns:cci="urn:schemas-ccieurope.com" xmlns:ccix="http://www.ccieurope.com/xmlns/ccimlextensions">
    <cci:p>OAKLAND, Calif. — A former student suspected of opening fire at a small Christian college in California, killing seven people and wounding three, was targeting a school administrator and former classmates who he felt had treated him unfairly, police said yesterday.</cci:p>
    <cci:p>Oakland Police Chief Howard Jordan said at a news conference that One Goh, 43, who had been expelled from Oikos University, had been cooperative with investigators </cci:p>
    <cci:p ccix:annotation="insertion">after being taken into custody but “not particularly remorseful.”&lt;/cci:p>
    <cci:p>“We know that he came here with the intent of locating an administrator, and she was not here,” Jordan said. “He then went through the entire building systematically and randomly shooting victims.”&lt;/cci:p>
    <cci:p>The midmorning attack at Oikos, a small Oakland college that has links to the Korean-American Christian community, was the deadliest shooting rampage on a U.S. college campus since </cci:p>
</cci:body> 
```

# ruby-on-rails - 单击使用 Watir-webdriver 动态生成的元素

> ID：10076338
> 
> 赞同：1
> 
> 时间：2012-04-09T16:29:32.803
> 
> 标签：ruby-on-rails, watir-webdriver

我有以下 HTML 代码：

```
<table class="report" width="100%">
<thead>
</thead>
<tbody>
<tr class="alt">
<td>
<a onclick="window.open(this.href);return false;" href="/search/searches/1563/reports/946">56175-746-45619568-noor.fli.zip</a>
</td>
<td class="_"> Report </td>
<td class="_"> 09 Apr 2012</td>
<td class="_"> Noor</td>
<td class="_"> 2.8 MB</td>
<td class="_">Ready</td>
</tr> 
```

我想点击`href="/search/searches/1563/reports/946">56175-746-45619568-noor.fli.zip`但我不想使用 XPATH。我尝试了很多东西但都失败了，有没有办法在不使用 XPATH 的情况下单击此 href。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:10:40.280

你可以使用href

```
br.link(:href => '/search/searches/1563/reports/946').click 
```

或文字

```
br.link(:text => '56175-746-45619568-noor.fli.zip').click 
```

或者您可以使用正则表达式匹配的变体

```
br.link(:href => /reports/).click 
```

或者

```
br.link(:text => /noor.fli.zip/).click 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T07:53:43.793

它是该表中唯一的链接吗？还是总是该表中的第一个链接？

```
browser.table(:class => 'report').a.click 
```

如果有多个表，那么你必须弄清楚如何找到你想要的那个。也许是表格内的文字。如果在您的示例中，文本 Noor 对于该表是唯一的，那么您可以尝试这样的事情

```
browser.table(:class => 'report', :text => /Noor/).a.click 
```

或者如果您知道上面的结构将在链接和有关报告的信息位于单个表格行的情况下持续存在）

```
browser.row(:text => /Noor/).a.click 
```

您必须尝试决定哪个最坚固或最不脆弱

# ruby - 安装 RMagick 的问题

> ID：10076343
> 
> 赞同：0
> 
> 时间：2012-04-09T16:29:38.187
> 
> 标签：ruby, windows, installation, rubygems, rmagick

我知道已经有一些关于 RMagick for Ruby 1.9.x 的问题和广泛的答案，但我在安装它时仍然遇到问题。

我正在使用 Eclipse 的 Ruby-Aptana 插件，并且我已经安装了 DevKit。我尝试按如下方式安装 RMagick：

1.  [我已经在 C:/ImageMagick6.7.6-5-Q16-windows-dll.exe 中从这里](https://www.imagemagick.org/script/download.php#windows)下载并安装了 ImageMagick 6.7.6-5-Q16-windows- dll.exe 希望这是带有标题的那个？

2.  然后我设置了环境变量，但我不知道该怎么做。我已经在 Windows 控制面板 --> 系统 --> 高级设置 --> 环境变量 --> 系统变量中尝试过。我在那里设置：

PATH --> 值：C:\Ruby192\bin 和 C:\ImageMagick-6.7.6-Q16

CPATH --> C:\ImageMagick-6.7.6-Q16\include

LIBRARY_PATH --> C:\ImageMagick-6.7.6-Q16\lib

3.  我安装了 rmagick gem： gem install rmagick

不幸的是，我仍然收到错误：

```
 Temporarily enhancing PATH to include DevKit...
  Buidling native extensions. This could take a while...
  ERROR: Error installing rmagick:
     ERROR: Error installing rmagick:

     c:/Ruby192/bin/ruby.exe  extconf.rb
  checking for Ruby version >= 1.8.5... yes
  checking for stdint.h...*** extconf.rb failed***
  Could not create Makefile due to some reason, probably lack of necessary 
  libraries and/or headers. Check the mkmf.log file for more details. 
```

我是一名 Ruby-Starter，希望您在回答我的（也许是愚蠢的）问题时尊重这一点。谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:55:54.640

我会完全放弃 RMagick。

RMagick 会占用大量内存。ImageMagick 还有其他的 ruby​​ 包装器，我可以更轻松地使用它们。

[https://github.com/probablycorey/mini_magick](https://github.com/probablycorey/mini_magick)

MiniMagick 非常简单。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T20:04:50.603

尝试

```
gem install win32-service --platform=mswin32
gem install rmagick --platform=mswin32 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T21:38:32.493

另请检查[Ruby 1.9.2 如何在 Windows 上安装 RMagick？](https://stackoverflow.com/questions/4451213/ruby-1-9-2-how-to-install-rmagick-on-windows)

在你的第 2 步中，你适应了`LIBRARY_PATH`。过去这对我不起作用（即使在许多手册中都推荐）。rmagick [-FAQ](http://rmagick.rubyforge.org/install-faq.html#loaderror)建议设置`LD_LIBRARY_PATH`not `LIBRARY_PATH`。对`LD_LIBRARY_PATH`我来说效果很好。

# dependencies - YUM 抱怨 CentOS 5.8 中的 PyYAML 和 libyaml

> ID：10076344
> 
> 赞同：3
> 
> 时间：2012-04-09T16:29:41.090
> 
> 标签：dependencies, centos, yum, pyyaml

每次我尝试#sudo yum update 时，我都会收到 PyYAML-3.08-4.el5.x86_64 缺少依赖项 libyaml-0.so.1()(64bit) 的警告。

所以我做了一些检查，似乎确实安装了 libyaml，所以我想知道我的 PyYAML 和 libyaml 安装有什么问题。libyaml 是由 PyYAML 自动提取的，这让我认为 repo 发生了一些奇怪的事情。YUM 的输出如下：

```
[root@am-web-1 ~]# yum update
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirror01.th.ifl.net
 * epel: mirror01.th.ifl.net
 * extras: mirror01.th.ifl.net
 * rpmforge: fr2.rpmfind.net
 * updates: mirror01.th.ifl.net
Excluding Packages from CentOS-5 - Base
Finished
Reducing CentOS-5 Testing to included packages only
Finished
Excluding Packages from CentOS-5 - Updates
Finished
Setting up Update Process
Resolving Dependencies
--> Running transaction check
---> Package git.x86_64 0:1.7.10-1.el5.rf set to be updated
--> Processing Dependency: libyaml-0.so.1()(64bit) for package: PyYAML
---> Package libyaml.x86_64 0:0.1.4-1.el5.rf set to be updated
---> Package perl-Git.x86_64 0:1.7.10-1.el5.rf set to be updated
--> Finished Dependency Resolution
PyYAML-3.08-4.el5.x86_64 from installed has depsolving problems
  --> Missing Dependency: libyaml-0.so.1()(64bit) is needed by package PyYAML-3.08-4.el5.x86_64 (installed)
Error: Missing Dependency: libyaml-0.so.1()(64bit) is needed by package PyYAML-3.08-4.el5.x86_64 (installed)
 You could try using --skip-broken to work around the problem
 You could try running: package-cleanup --problems
                        package-cleanup --dupes
                        rpm -Va --nofiles --nodigest 
```

所以我们知道我们有问题，那么这个 libyaml 到底在哪里？

```
[alexander@am-web-1 ~]$ yum whatprovides "*/libyaml-0.so.1"          
Loaded plugins: fastestmirror
Excluding Packages from CentOS-5 - Base
Finished
Reducing CentOS-5 Testing to included packages only
Finished
Excluding Packages from CentOS-5 - Updates
Finished
libyaml-0.1.2-3.el5.i386 : YAML 1.1 parser and emitter written in C
Repo        : epel
Matched from:
Filename    : /usr/lib/libyaml-0.so.1

libyaml-0.1.2-3.el5.x86_64 : YAML 1.1 parser and emitter written in C
Repo        : epel
Matched from:
Filename    : /usr/lib64/libyaml-0.so.1

libyaml-0.1.2-3.el5.x86_64 : YAML 1.1 parser and emitter written in C
Repo        : installed
Matched from:
Filename    : /usr/lib64/libyaml-0.so.1

libyaml-0.1.2-3.el5.i386 : YAML 1.1 parser and emitter written in C
Repo        : installed
Matched from:
Filename    : /usr/lib/libyaml-0.so.1 
```

那么图书馆存在吗？

```
[alexander@am-web-1 ~]$ ls /usr/lib64/libyaml-0.so.1*
/usr/lib64/libyaml-0.so.1  /usr/lib64/libyaml-0.so.1.1.0 
```

64位的可以，32位的可以吗？

```
[alexander@am-web-1 ~]$ ls /usr/lib/libyaml-0.so.1*
/usr/lib/libyaml-0.so.1  /usr/lib/libyaml-0.so.1.1.0 
```

它们都存在，那有什么问题？！？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T04:36:06.340

这更像是一个[ServerFault](https://serverfault.com/)问题，但我在更新/安装 Cobbler 时看到了同样的问题。这是您此时启用的多个存储库的问题。同时永久启用两个存储库通常是不好的做法。`libyaml`来自[RPMForge](http://repoforge.org/)的包和通过[EPEL](http://fedoraproject.org/wiki/EPEL)存储库提供的包之间存在轻微冲突。

要修复，请通过 删除 RPMForge 包`yum erase libyaml`，然后使用 继续更新`yum update --disablerepo=rpmforge`。您还可以通过从 RPMForge 存储库配置文件中永久排除该特定包来采取额外的步骤...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-19T06:53:50.047

受@ewwhite 的回答启发，我发现这样做效果很好

```
yum erase libyaml
yum install --disablerepo=rpmforge libyaml-devel 
```

# html - HTML5 Canvas 在 Google Chrome 中旋转 - 糟糕的渲染

> ID：10076348
> 
> 赞同：2
> 
> 时间：2012-04-09T16:29:56.740
> 
> 标签：html, canvas, rotation, angle

当照片显示在 HTML5 画布元素上并旋转时，结果在 FireFox 中看起来不错，但在 Chrome 中却很糟糕。似乎谷歌浏览器不知道如何平滑旋转的边缘。

例如，请查看[http://www.ernestdelgado.com/public-tests/canvasphoto/demo/canvas.html](http://www.ernestdelgado.com/public-tests/canvasphoto/demo/canvas.html) 将其中一张照片放大并使其围绕其中心略微旋转。打开“简单模式”，使照片获得最大对比度的白色边框。您现在会看到照片的边缘一点也不光滑。在 Firefox 中，结果要好得多！

有谁知道这个问题是否可以解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:45:46.233

一年半以来，Chrome 团队一直在不断打破 Canvas 不同部分的抗锯齿。

许多错误出现了同样的问题：[http ://code.google.com/p/chromium/issues/detail?id=7508](http://code.google.com/p/chromium/issues/detail?id=7508)

不幸的是，等待是您唯一的选择，除非您想自己制作抗锯齿效果，这是可能的，但是对于“应该”看起来一致的东西需要做很多工作

# delphi - 如何防止程序被复制，使用Delphi

> ID：10076349
> 
> 赞同：0
> 
> 时间：2012-04-09T16:29:57.983
> 
> 标签：delphi, delphi-xe2, piracy-prevention

我想知道，假设我开发了一个程序，可以访问客户的计算机，有没有办法开发程序只能在该机器上运行，通过写入计算机唯一标识符（如果有的话像那样）进入代码并编译程序。我正在使用德尔福 XE2

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T20:30:48.433

是的，您可以通过将可执行文件绑定到机器特性来防止某种程度的未经授权的使用。您可以自己做（有问题），也可以购买现成的解决方案来为您做（免责声明——我在为此类问题提供解决方案的公司之一工作：[Wibu-Systems](http://www.wibu.us)）。机器绑定有两个问题；我们可以帮助其中之一：

1.  误报：机器特性可能会因用户升级或奇怪的驱动程序行为而改变。这可能会导致您的许可系统报告用户试图滥用许可证（误报）。这是这些系统中的一个地方性问题。（无耻的自我推销：我们刚刚发布了一种新的绑定方法来减少或消除这些错误。我们称之为[SmartBind](http://www.wibu.us/solutions/codemeter-smartbind.html)（tm）。

2.  可破解性：由于任何机器绑定都必须使用操作系统调用来获取硬件“指纹”信息以进行验证，因此破解者可以修补用于始终返回已知“良好”值的 dll，从而允许破解软件。这类裂缝在 bittorrent 网站上十分猖獗。不幸的是，没有很好的解决方法，尽管我们的方法使用了一些加密魔力来使它更难做。为了最终的反盗版，你必须使用像[CmStick](http://www.wibu.us/products/codemeter.html)、HASP 或 KeyLok 这样的加密设备。NSA 可以破解任何东西，当然，但是破解像 CodeMeter 这样的一流硬件解决方案的难度使得它不太可能，除非回报真的是巨大的。

我强烈建议您研究商业解决方案以仔细研究可用的选项。这个领域有很多供应商和几个好的产品可供选择（当然，我认为我们的产品是最好的）。当您尝试处理各种配置问题和可能不满意的用户时，滚动您自己的解决方案会给下游带来很多麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T18:33:32.217

简短的回答是没有可靠的方法来防止复制程序。当然，有一些技术可以识别程序的特定实例、识别机器硬件等，但是对于这些技术中的每一种，都有一种对抗技术可以绕过它，让那些真正想去麻烦的用户绕过它。无论是破解你的程序并改变它寻找的东西（或完全禁用检查），虚拟化你正在寻找的硬件等等。总有办法。有人愿意投入只是时间和精力的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T12:25:10.477

如果您想要一些简单的东西，这将为您提供硬盘卷 ID 作为每个机器栏黑客应该唯一的数字。

```
function GetHDSerialNumber: Dword;
var dw:DWord; mc, fl : dword; c:string;
begin
  c:=extractfiledrive(application.exename)+'\';
  GetVolumeInformation(Pchar(c),nil,0,@dw,mc,fl,nil,0);
  Result := dw;
end; 
```

这适用于 Delphi 2007，高于 unicode 的版本，你自己解决这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T19:01:42.540

虽然没有防黑客硬件之类的东西，但提到的 Wibu 系统还没有被黑客入侵，并且它具有强大的反黑客功能，包括物理设计功能，这使得最复杂的黑客攻击几乎是不可能的。

i-Lock 等其他解决方案已被黑客入侵，但到目前为止，Wibu 是一个很好的答案。我刚买了他们的入门包。

# solr - Solr在索引表记录后不显示结果

> ID：10076355
> 
> 赞同：1
> 
> 时间：2012-04-09T16:30:17.570
> 
> 标签：solr

dataimporthandler 状态显示它已编入索引并添加了 10 个文档，但当我搜索属于添加文档的单词时未显示任何结果。如果我给出*：*在搜索中它会显示所有记录

Clob 记录示例：

```
<?xml version="1.0" encoding="UTF-8" ?> 
<message xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="someurl" xmlns:csp="someurl.xsd" xsi:schemaLocation="somelocation jar: id="002" message-type="create">
<content>
     <dsp:row>
      <dsp:channel>100</dsp:channel>  
      <dsp:role>115</dsp:role>    
      </dsp:row>
     <![CDATA[ <ol><li>java</li></ol><li>ASP</li>]]>
 </body></content></message> 
```

数据配置.xml

```
 <document name="doc">
            <entity name="MYCONTENT" transformer="ClobTransformer" 
                      query="SELECT CID,XML FROM MYCONTENT">

                <field column="CID" name="CID"/>
                <field column="XML" clob="true" name="XML"/>            
            </entity>
        </document> 
```

架构.xml

```
<field name="CID" type="string" indexed="true" stored="true" required="true"/>
    <field name="XML" type="string" indexed="true" stored="true" required="true"/>  
    <dynamicField name="*" type="ignored" />
     <uniqueKey>CID</uniqueKey>
     <defaultSearchField>XML</defaultSearchField> 
```

solrconfig.xml

```
<requestHandler name="/dataimport" class="org.apache.solr.handler.dataimport.DataImportHandler">
         <lst name="defaults">
           <str name="config">/data-config.xml</str>
          <str name="rows">10</str>      
         </lst>
        </requestHandler> 
```

我不知道为什么当我搜索“Java”“ASP”时它没有显示结果。任何帮助是极大的赞赏。

在此先
感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:45:50.023

你有两件事要解决。

首先，“字符串”字段类型将整个文档视为单个标记。您需要一个文本字段类型。

其次，Solr 不会解析您的 CLOB 中的 XML，它会将其索引为原始文本，根据您为该字段选择的标记器指定的拆分标记。例如，如果您使用空格标记器，它会将“115”视为单个标记，并且搜索“115”将不匹配。

为了进行测试，我会尝试在标记器之前的该字段定义中使用 HTMLStripCharFilterFactory。请参阅：[http ://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.HTMLStripCharFilterFactory](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.HTMLStripCharFilterFactory)

这应该剥离相当数量的 XML。如果您想以特定方式处理它，您可能想了解 XPathEntityProcessor，它可以提取部分 XML 用于索引。请参阅：[http ://wiki.apache.org/solr/DataImportHandler#XPathEntityProcessor](http://wiki.apache.org/solr/DataImportHandler#XPathEntityProcessor)

# java - 使用存储在堆栈中的对象的方法（javafx）

> ID：10076373
> 
> 赞同：1
> 
> 时间：2012-04-09T16:31:39.753
> 
> 标签：java, javafx-2

我对java比较陌生...

我有一个矩形数组和一个堆栈，里面装满了列表的一些矩形

```
int listNr;

Rectangle[] list = new Rectangle[100];
LinkedList stack = new LinkedList();

public void fillList(){
    for (int i = 0; i < list.length; i++){
        list[i] = new Rectangle(10,10);    
    }     
}

public void fillStuff(){
    stack.add(list[listNr]);
} 
```

要从列表中访问 Rectangle 的坐标，我会调用“getX()”方法

```
list[listNr].getX(); 
```

这将返回 x 值。

但现在我想通过堆栈访问 Rectangle 的 x 坐标，**我该怎么做？**

我不明白为什么这不起作用：

```
stack.peek().getX(); 
```

我一直认为在我的情况下 stack[i] 和 array[i] 会引用同一个对象，因为......

```
 System.out.println("stack "+stack.peek());
 System.out.println("list "+list[listNr]); 
```

会给我同样的输出：“list Rectangle@863d22”和“stack Rectangle@863d22”

如果我指的是同一个对象，我不应该能够使用对象的方法（如getter和setter）吗？还是我在这里犯了一个逻辑错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:34:36.460

您需要使用泛型：

```
LinkedList<Rectangle> stack = new LinkedList<Rectangle>(); 
```

这告诉 Java LinkedList 将包含矩形。如果您尝试插入不是 Rectangle 的任何内容，您将收到编译时错误。由于 Java 可以（在编译时）告诉`stack`它只包含s，它知道（在编译时）`Rectangle`您可以调用`getX()`.`stack.peek()`

# tags - 试图弄清楚 {s: ;} 标签的含义以及它们的来源

> ID：10076377
> 
> 赞同：0
> 
> 时间：2012-04-09T16:31:49.183
> 
> 标签：tags, rightnow-crm

我正在将帖子从 RightNow 基础架构迁移到另一个名为 ZenDesk 的服务。我注意到，每当用户添加文件甚至 URL 链接时，当我从 RightNow 提取 xml 数据时，它会给我很多奇怪的代码，如下所示：

`{s:3:""url"";s:45:""/files/56f5be6c1/MUG_presso.pdf"";s:4:""name"";s:27:""MUG presso.pdf"";s:4:""size"";s:5:""2.1MB"";}`

编写解析它们并生成正常 url 和链接的东西并不难，但我只是想知道这是否是 RightNow 服务特有的东西，或者它是否是使用的标签系统。我尝试对此进行谷歌搜索，但得到了一些奇怪的结果，因此认为堆栈溢出可能有人遇到了这个问题。

那么，任何人都知道这些 {s ;} 标签被称为什么以及是否有任何特定的工具可以用来读取它们？

任何答案表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:02:11.977

这类似于`serialize()`调用返回的部分 PHP 序列化数据。看起来有人可能将每个都`"`变成了`""`，这可能会阻止它正确解析。如果它在该`{s:`部分之前用这样的文本包裹，那几乎肯定是 PHP。

`a:6:{i:1;a:10:{s:`

这些字母/数字表示“后面跟着一个包含六个元素的数组”、“后面跟着一个长度为 20 的字符串”等。

您可以使用任何 PHP 实例[`unserialize()`](http://www.php.net/manual/en/function.unserialize.php)来处理数据。如果 API 确实返回了这些双引号，则您可能需要在解析之前替换`:""`和`"";`with 。`"`

[其他语言（如Python](http://php.net/manual/en/function.serialize.php) ）也存在解析模块。[您可以在此答案](https://stackoverflow.com/a/1197478/293352)中找到更多信息。

# macos - 将多个 NSViewController 连接到一个 nib

> ID：10076378
> 
> 赞同：3
> 
> 时间：2012-04-09T16:31:51.967
> 
> 标签：macos, cocoa, user-interface, appkit

我有一个包含几个相当复杂的视图的窗口。现在，我使用单个 NSWindowController 来控制窗口和所有视图的 UI。它正在成为一个非常庞大的类，因为它处理每个视图的细节。

尽管视图行为是相互独立的，所以我看到了将每个视图的 UI 逻辑放入单独的控制器中的机会。

根据[Mac App Programming Guide](http://developer.apple.com/library/mac/#documentation/General/Conceptual/MOSXAppProgrammingGuide/CoreAppDesign/CoreAppDesign.html)，这正是视图控制器的用途：

> 使用视图控制器来划分工作以管理更复杂的窗口布局。您的视图控制器（与窗口控制器）一起工作以呈现窗口内容。

但是，我找不到任何关于这个想法在实践中如何运作的文档或示例。除了窗口控制器之外，我可以将多个视图控制器添加到 nib 文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:17:17.590

如果您将视图控制器添加到 nib，那就是它们将被实例化的地方，并且您将`IBOutlet`s 添加到窗口控制器（假设这是 nib 的文件所有者）以连接它们。

然而，就内存而言，该方案可能会变得昂贵，尤其是您拥有的视图控制器越多。您可能想要考虑在窗口控制器中懒惰地实例化它们（即，仅在需要时这样做），假设这不会在第一次呈现视图之前导致令人反感的延迟。

不要害怕尝试这两种方法。其中之一可能最适合您。

无论如何，我为您决定将所有代码分解到单独的控制器中而喝彩。非常好。祝你在你的努力中好运。

# spring - 带有 Spring 控制器的 Extjs4 RESTful CRUD 网格

> ID：10076387
> 
> 赞同：0
> 
> 时间：2012-04-09T16:32:34.310
> 
> 标签：spring, rest, datagrid, extjs4

我是 Extjs4 和一般的 javascript 世界的新手。我查看了文档和示例，并尝试使用我的 spring 后端启动并运行基本的 CRUD 网格。

我对 extjs 中的代理感到困惑，根据 MVC 范式，它们是在商店中还是在模型中？

我定义了一个controller.js，它将这些包装在一起。我原以为 REST 调用将根据指定的 url 进行，现在是这样，但创建调用仍在发送整个列表。我在后端使用 jackson 自动转换为 java 对象，但不知何故这不起作用（仅用于添加和更新）。

我如何将这些链接起来？

a）添加一个用户..我是创建一个新的UserModel然后像这样调用一个rest调用还是模型中指定的代理自动支持它？

```
var record = new App.model.UserModel();
     store = Ext.getStore('UsersStore');
     store.insert(0, record);
     store.save();  // .. this invokes the /createUser method 
                    //   .. what about /update ? 
```

b）我正在使用 RowEditing 插件 .. 我如何在我的 controller.js 中获取 roweditor，其中视图的引用可用

提前致谢

相关代码清单...

//用户控制器.js

```
Ext.define('App.controller.UsersController', {
extend : 'Ext.app.Controller',
init: function() {
    this.control({
        'userList button[action=add]' : {
                click : this.editUser
            }         });    },
views : ['user.List','user.Edit'],
stores : ['UsersStore'] ,
models : ['UserModel'],
editUser : function(grid,record)
{
    // empty record
     var record = new App.model.UserModel();
     // created new record

//How to get a reference to the roweditor here and then save that to the backend ?

 //store = Ext.getStore('UsersStore');
     //store.insert(0, record);
     //store.save();
    // this.getView('user.List').getP('rowEditor').startEdit(0, 0);

}}); 
```

//List.js

```
var rowEditor = Ext.create('Ext.grid.plugin.RowEditing', {
clicksToEdit: 2
 }
Ext.define('App.view.user.List' ,{
extend: 'Ext.grid.Panel',
alias : 'widget.userList',
title : 'All Users',
store : 'UsersStore',
selType: 'rowmodel',
plugins: rowEditor,
initComponent: function() {
    this.columns = [
        {header: 'SNo',  dataIndex: 'userID', width:50},
        {header: 'UID',  dataIndex: 'userUID',  flex: 1, editor: 'textfield', allowBlank:false},
        {header: 'Name',  dataIndex: 'userName',  flex: 1, editor:'textfield',allowBlank:false},
        {   header: 'Level',  dataIndex: 'userLevel',  flex: 1,
            editor: {xtype: 'combobox', typeAhead: true, triggerAction: 'all', selectionOnTab:true,
                     store : [
                              ['Level 1','Level 1'],
                              ['Level 2','Level 2'],
                              ['Level 3','Level 3']

                            ]
                }
        },
        {header: 'Email', dataIndex: 'emailID', flex: 1, editor: 'textfield'}
    ];
    this.callParent(arguments);
},
dockedItems : [{
    xtype : 'toolbar',
    items : [{
         text: 'Add',
         iconCls: 'icon-add',
         action: 'add'

    }]
}]}); 
```

//模型.js

```
Ext.define('App.model.UserModel', {
extend: 'Ext.data.Model',
fields: ['userID','userUID','userName', 'userLevel' ,'emailID'],
proxy : {
    type: 'ajax',
    api :
        {
            read : 'rest/user/fetchAll',
            update:'rest/user/updateUser',
            create :'rest/user/createUser',
            destroy : 'rest/user/deleteUser'
        },

    reader :
        {
        type : 'json',
        root : 'users',
        successProperty : 'success'
        },

    writer :
        {
        type : 'json',
        allowSingle : 'true'
        }
}}); 
```

//用户存储

```
Ext.define('App.store.UsersStore', {
extend: 'Ext.data.Store',
model: 'App.model.UserModel',
autoLoad : true}); 
```

//示例Java控制器

```
@Controller
@RequestMapping("/rest/user")
public class UserController {

@RequestMapping(value = "/fetchAll" ,  method= RequestMethod.GET)
public @ResponseBody Map<String,? extends Object> 
    fetchUsers()            {
    Map<String,Object> responseMap = new HashMap<String,Object>();
    responseMap.put("success",true);
    responseMap.put("users",userService.getUserRepository().findAll());
    return responseMap;  }

    // was expecting a single object here ?

@RequestMapping(value = "/createUser")
public @ResponseBody Map<String,? extends Object> 
                         createUser(@RequestBody    List<User> users) 
 {  ...   }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:57:47.863

1.  我会将代理放在商店对象中，而不是模型中。但这只是个人喜好。

2.  当您将记录添加到存储对象时，如果它的 autoSync 属性设置为 true，它将自动生成创建请求。您的创建请求到底发生了什么？正在发送什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T13:17:38.450

在尝试了上面沙的评论之后，我终于能够解决这个问题。问题出在json阅读器上

```
reader :
    {
    type : 'json',
    root : 'users',
    successProperty : 'success'
    //added
    idProperty : 'userID'
    }, 
```

我必须添加 idProperty 以使 Json 识别脏记录，否则它将所有内容视为新记录并发回整个列表

# javascript - 使用jquery从chrome中的xml节点获取内部xml

> ID：10076392
> 
> 赞同：1
> 
> 时间：2012-04-09T16:32:52.323
> 
> 标签：javascript, jquery, android, xml, google-chrome

我需要从 xml 节点获取内部 xml 我让这段代码在 IE 中完美运行，但使用 chrome 我无法获取内部 xml

```
var result_xml = UXmlHelper.text2xml(result.d); // create xml document
    var xmlStr = $(result_xml).text();//i need to get the inner xml but in chrome it   //return the text. 
```

在 IE 中返回：`<NewDataSet> <Screens> <TName>Screens</TName> <AppId>1</AppId> <AppName>MyStore_1</AppName> <AppType>4</AppType> <ScreenName>ScrHome</ScreenName> <ScrId>9</ScrId> <ScrPosition>1</ScrPosition> <TemplateId>1</TemplateId> <Xml> <Screen id="ScrHome" position="1" type="Scr"> <Properties> <Id>ScrHome</Id> <Name>Home</Name> </Properties> <Style /> ......`

在 Chrome 中返回：

```
Screens1MyStore_14ScrHome911ScrHomeHomeCont_MainContainerurl(../Images/iphone-4_RealSize-2.JPG)no-repeat#DCE6F7265507Cont_InnerMainContainer8365Yellow338relativeImgScrollUpImgScrollUp../icons/UpArrow-3-Small.PNG1515scrollStartUpPhScrContImgScrollUpscrollEndImgScrollUpabsolute-7402PhScrContrtltruexxxjustTestrtl#DCE6F7hidden9986relative13ArialrtlImgScrollDownImgScroll.... 
```

**我所拥有的：**

```
var result_xml = UXmlHelper.text2xml(result.d); $(result_xml).find('NewDataSet').find("Screens").each(function () { 
var parentScrNode = $(this).find("Xml"); 
}); 
```

**在手表表达式中：**

```
 parentScrNode:
 e.fn.e.init[1] 0: Element 
context: Element 
length: 1 
prevObject: e.fn.e.init[1] 
selector: "Xml" proto: Object[0] – 
```

**观看1：** $（parentScrNode）.html（）：[异常：TypeError：无法调用未定义的“替换”方法]**观看2：**

```
parentScrNode.html(): [Exception: TypeError: Cannot call method 'replace' of undefined] **Watch 3 :** 
```

parentScrNode.text(): "ScrHomeHomeCont_MainContainerurl(../Images/iphone-4_RealSize-2.JPG)......

任何想法？？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:18:11.137

在 jQuery 中，您应该能够像对待 HTML 一样对待 XML。这样你就可以直接查询你想要的。

示例：http: [//jsfiddle.net/enqBg/](http://jsfiddle.net/enqBg/)

JS

```
alert($('<NewDataSet>  <Screens>    <TName>Screens</TName>    <AppId>1</AppId>    <AppName>MyStore_1</AppName>    <AppType>4</AppType>    <ScreenName>ScrHome</ScreenName>    <ScrId>9</ScrId>    <ScrPosition>1</ScrPosition>    <TemplateId>1</TemplateId>    <Xml>      <Screen id="ScrHome" position="1" type="Scr">        <Properties>          <Id>ScrHome</Id>          <Name>Home</Name>        </Properties>  </Screen>  </Xml>  </Screens>  </NewDataSet>').find('Screens').html()); 
```

**编辑 1**

如果您想要 NewDataSet 的直接子内容，则必须将整个内容包装在另一个父元素中，否则 jQuery 将返回`null`。类似的东西`var YourWrappedXML = '<top><NewDataSet>...</NewDataSet></top>'`。然后就可以调用`$(YourWrappedXML).find('NewDataSet').html()`获取内容了`NewDataSet`

示例：http: [//jsfiddle.net/enqBg/1/](http://jsfiddle.net/enqBg/1/)

**编辑 2**

这是一个将您的 XML 附加到页面的示例。

示例：http: [//jsfiddle.net/enqBg/2/](http://jsfiddle.net/enqBg/2/)

**编辑 3**

在我给你的例子中，我`<NewDataSet>...</NewDataSet>`用`<top></top>`结果包裹起来`'<top><NewDataSet>...</NewDataSet></top>'`。通过包装它，我们现在可以在 find 方法中搜索 NewDataSet。否则 NewDataSet 是第一个元素。

如果你不包装它，那么你将不得不使用`$(result_xml).find('Screens')`，因为`$(result_xml)`是`<NewDataSet>`

示例：http: [//jsfiddle.net/enqBg/3/](http://jsfiddle.net/enqBg/3/)

另外我不确定`result_xml`是字符串还是对象。据我所知，这只适用于字符串（尽管我可能是错的）。

# iphone - 使用数组填充表视图的正确方法？

> ID：10076394
> 
> 赞同：0
> 
> 时间：2012-04-09T16:32:57.957
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我目前正在尝试在我的 iPhone 应用程序上实现一个表视图，它从一个表视图/类中获取一个数组，并使用这个数组在另一个单独的视图中填充一个表。这是我使用的方法，如果单击/点击，则将练习添加到数组中：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    NSString *str = cell.textLabel.text;
    NSUInteger *index = 0;

    NSMutableArray *array = [[NSMutableArray alloc] init];
    [array insertObject:str atIndex:index];

    self.workout = array;

    [array release];
} 
```

按下保存按钮后，该数组将存储在我想在另一个视图中填充的锻炼数组（数组）中。我采取了正确的方法吗？

这是我的 cellForRowAtIndexPath 方法：

```
- (UITableViewCell *)tableView:(UITableView *)tableView 
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSUInteger section = [indexPath section];
    NSUInteger row = [indexPath row];

    NSString *key = [keys objectAtIndex:section];
    NSArray *nameSection = [names objectForKey:key];

    static NSString *SectionsTableIdentifier = @"SectionsTableIdentifier";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:
                             SectionsTableIdentifier ];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault 
                                       reuseIdentifier: SectionsTableIdentifier ] autorelease];
    }

    cell.textLabel.text = [nameSection objectAtIndex:row];
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:46:28.490

您可能不想`self.workout`每次都使用新数组重新初始化。

```
-(void) viewDidLoad
{
  self.workout = [[NSMutableArray alloc] init];
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    NSString *str = cell.textLabel.text;
    [self.workout insertObject:str atIndex:0];
} 
```

# c# - 是否有任何工具可以返回操作中调用的每个方法的响应时间？

> ID：10076395
> 
> 赞同：0
> 
> 时间：2012-04-09T16:32:59.653
> 
> 标签：c#, asp.net, .net, stack-trace

> **可能重复：**
> [有哪些好的 .NET Profiler？](https://stackoverflow.com/questions/3927/what-are-some-good-net-profilers)
> [有没有像样的 C# 分析器？](https://stackoverflow.com/questions/10644/any-decent-c-sharp-profilers-out-there)

我正在做一些速度优化，想知道是否有任何可用的工具可以返回在该操作链中调用的每个方法/行为完成所需的时间。就像方法 LoadLists(); 启动一系列方法来构建和加载这些列表，我希望看到类似以下内容的报告：

```
LoadLists Total Process Time: 10s
FindDirectReports: 1s
FindManager: .035s
FindGroups: 1s
LoadPhotos: 5.234s 
```

等等...

有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:38:15.137

Redgate 做 Ants 分析器，非常棒。Jetbrains 做 DotTrace 很好，但在我个人看来不如 Ants 好。不过蚂蚁更贵。

Visual Studio Ultimate 内置了一些性能工具。我使用这些工具的结果好坏参半。

据我所知，没有免费的解决方案来分析应用程序，尤其是网络应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:48:11.737

你可以花几个小时使用 Stopwatch 添加一些分析代码，但我建议使用 Redgate Ants，它可以获得免费试用版。

# mysql - 如何从我的数据库 Mysql 将数据显示到我的 Jtextarea

> ID：10076397
> 
> 赞同：1
> 
> 时间：2012-04-09T16:33:08.627
> 
> 标签：mysql, jtextarea

当我尝试将数据（查询结果）从我的数据库 mysql 显示到我的 jTextarea 时出现问题，当我编译时出现错误异常，例如：

```
SQL Exception: java.sql.SQLException: Can not issue SELECT via executeUpdate() 
```

我从我的表中使用了一个“选择”查询，其中名称是我的 jTextFieldNom 中写的名称，这是我的代码，我希望有人能帮助我，因为我不知道如何解决这个问题，我确定我的查询是正确的，但我不知道问题出在哪里。

```
String pilote = "com.mysql.jdbc.Driver";
jComboBoxType.addItemListener(new ItemState());
jComboBoxMenaces.addItemListener(new ItemState());
try {
    Class.forName(pilote); 
    Connection connexion = DriverManager.getConnection("jdbc:mysql://localhost:3306/test","root"," "); 

    Statement instruction = connexion.createStatement(); 
    String a=jTextFieldNom.getText();

    String SQL = "select description from table where nomcol="+a+";"; 
    ResultSet rs = instruction.executeQuery(SQL);
    instruction = connexion.createStatement();

    int rowsEffected = instruction.executeUpdate(SQL);
    jTextArea1.append(rs.getString("description"));                                     
}
...... //bloc catch 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:31:27.827

此行正在执行引发错误的 Select 语句。

```
int rowsEffected = instruction.executeUpdate(SQL); 
```

您不需要此行，因为您没有更新数据库。

还将附加更改为 setText

```
jTextArea1.setText(rs.getString("description")); 
```

尝试这个：

```
String pilote = "com.mysql.jdbc.Driver";
jComboBoxType.addItemListener(new ItemState());
jComboBoxMenaces.addItemListener(new ItemState());
try {
    Class.forName(pilote); 
    Connection connexion = DriverManager.getConnection(
        "jdbc:mysql://localhost:3306/test","root"," "); 

    Statement instruction = connexion.createStatement(); 
    String a=jTextFieldNom.getText();

    String SQL = "select description from table where nomcol="+a+";"; 
    ResultSet rs = instruction.executeQuery(SQL);

    jTextArea1.setText(rs.getString("description"));                                     
} 
```

# css - 用 CSS 固定背景？

> ID：10076398
> 
> 赞同：1
> 
> 时间：2012-04-09T16:33:11.320
> 
> 标签：css

我想将我的背景修复为身体的 100% 高度，即使页面的其余部分滚动时也将其保留在那里。

我如何实现这一目标？现在我只有`background:url(bg.png);`. 图像的高度为 1200 像素，宽度为 20 像素，如果这很重要的话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T16:35:14.463

在 CSS 中，使用这个：

```
background-attachment: fixed; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T16:35:00.293

根据您希望背景图像执行的操作，有几个选项。ALA 上有一篇很棒的文章，关于全屏 BG 图像，它解释了缩放：

[http://www.alistapart.com/articles/supersize-that-background-please/](http://www.alistapart.com/articles/supersize-that-background-please/)

如果您只是想在浏览器中定位图像，您可以：

```
background:url(bg.png) no-repeat top left;
background-attachment:fixed; 
```

或者您想分别定位它（右上角等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T16:44:19.543

一些浏览器仍然无法支持背景图像的拉伸，所以这里有一个[解决方法](http://webdesign.about.com/od/css3/f/blfaqbgsize.htm)。

[CSS3 示例和支持](http://www.w3schools.com/css3/css3_backgrounds.asp)

由于它已经是 1200 像素，因此您可以`background-attachment:fixed;`在背景上使用以使其在滚动时跟随。[w3schools](http://www.w3schools.com/cssref/tryit.asp?filename=trycss_background-position)的示例。您可以使图像看起来像是要在底部流入纯色并带有漂亮的渐变等。

# z3 - 如何在 SMT 2.0 中定义返回 4 个参数的最小值的函数

> ID：10076402
> 
> 赞同：0
> 
> 时间：2012-04-09T16:33:25.617
> 
> 标签：z3, smt

我想在 SMT 2.0 中定义一个函数，它返回 4 个整数值中的最小值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:28:14.643

该`min4`函数（4 个整数值的最小值）可以在 SMT 2.0 语言中定义为：

```
(define-fun min2 ((a Int) (b Int)) Int
    (ite (<= a b) a b))

(define-fun min3 ((a Int) (b Int) (c Int)) Int
    (min2 a (min2 b c)))

(define-fun min4 ((a Int) (b Int) (c Int) (d Int)) Int
    (min2 a (min3 b c d))) 
```

以下链接包含使用此功能的示例： [http ://rise4fun.com/Z3/wuyU](http://rise4fun.com/Z3/wuyU)

在 SMT 2.0 中，`define-fun`本质上是一个宏定义。SMT 2.0 语言不支持期望任意数量参数的函数的定义。您可以考虑为 SMT 求解器使用编程 API，例如[Scala^Z3](http://lara.epfl.ch/~psuter/ScalaZ3/)、[SBV](http://hackage.haskell.org/package/sbv)和[Z3Py](http://rise4fun.com/Z3Py/tutorial/guide)。它们比 SMT 2.0 更方便使用。这是 Z3Py 中的相同示例：[http: //rise4fun.com/Z3Py/2vy](http://rise4fun.com/Z3Py/2vy)

# javascript - javascript中的非阻塞IO是如何工作的

> ID：10076403
> 
> 赞同：2
> 
> 时间：2012-04-09T16:33:31.097
> 
> 标签：javascript, nonblocking

我读到 javascript 语言具有有助于实现非阻塞 IO 的特性，这有助于[node.js](http://nodejs.org/)等项目的成功。我的问题是这些特征是什么，为什么非阻塞 IO 在其他语言中实现起来更棘手？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T16:41:55.873

JavaScript 本身不提供非阻塞 IO。node.js 使用的底层系统调用执行非阻塞 IO。JavaScript 的一流函数意味着当 IO 完成时很容易传递回调。

其他语言可以做非阻塞 IO 就好了。node.js 只是认为回调使推理和处理非阻塞操作变得超级容易。

Ruby 有 EventMachine，它传递块而不是函数。C 可以使用函数指针进行非阻塞 IO，但是你不会得到闭包，所以这有点痛苦。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T17:54:52.160

javascript 有时被标记为非阻塞 IO 的原因是因为匿名定义（基于事件）函数的概念。Node.js 专门将此标记为他们为什么 javascript 是一种良好的服务器端语言的原因。然而，这只是一半的事实，因为它在技术上不是非阻塞的，但它会在等待来自匿名回调/ajax 函数的回调时继续执行代码。我不确定这是否是您阅读的内容，但一个 Node 教程中提供的解释是：

“另一种方法，Node 和一些极快的现代服务器（如 Nginx 和 Thin）采用的方法是使用带有事件循环的单个非阻塞线程。这是使用 JavaScript 的决定真正闪耀的地方，因为 JavaScript 是设计用于单线程基于事件循环的环境：浏览器。JavaScript 传递闭包的能力使基于事件的编程变得非常简单。您基本上只需调用一个函数来执行某种类型的 I/O 并传递一个回调函数和 JavaScript 会自动创建一个闭包，确保即使在调用函数早已超出范围之后也能保留正确的状态。”

来源： http: [//net.tutsplus.com/tutorials/javascript-ajax/this-time-youll-learn-node-js/](http://net.tutsplus.com/tutorials/javascript-ajax/this-time-youll-learn-node-js/)

参考您的多线程标签，Node.js 和 Javascript**不是**多线程的，它们使用闭包系统在等待回调时保留状态。因此，它们**不是**完全非阻塞的。有很多情况会发生阻塞，但对于大多数小型实现，开发人员永远不会遇到阻塞情况。

有关 node.js 为何不好的可能信息，请参见此处：http: [//teddziuba.com/2011/10/node-js-is-cancer.html](http://teddziuba.com/2011/10/node-js-is-cancer.html)（链接已损坏）

[在这里反驳： http:](http://rhyolight.posterous.com/nodejs-is-not-cancer) //rhyolight.posterous.com/nodejs-is-not-cancer （链接断开）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T16:38:18.863

异步函数在 JavaScript 中通常是基于事件的，这意味着注册回调处理程序。您的代码在注册后继续运行，但不等待事件 - 必须从处理程序调用事件之后要做的所有事情。我希望这说明了一切。

当然也有例外，比如浏览器中的`window.alert`// 。`confirm``prompt`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-24T22:04:48.733

[https://youtu.be/dFnkZ15-_0o?t=2125](https://youtu.be/dFnkZ15-_0o?t=2125) This excerpt from Andrew Mead's node.js course does a great job of visually explaining the differences between non-blocking and blocking I/O operations in JS. The clip is from 35:25 - 47:16.

# facebook - 使用 Graph API 创建时不显示 Facebook 页面状态

> ID：10076412
> 
> 赞同：1
> 
> 时间：2012-04-09T16:34:10.587
> 
> 标签：facebook, facebook-graph-api, facebook-c#-sdk

我有一个 Facebook 应用程序，它通过 Graph API 成功检索提要，并且还发布了没有任何明显错误的内容。该应用程序是用于更新 Facebook 页面的内部基于 Intranet 的客户端。

我遇到的问题是，当我发布图片或链接类型的消息时，它们在页面的公共墙上完全符合预期。但是，通过我的应用程序发布的简单状态消息表现得很奇怪。

API 响应中存在状态`me/feed`，当我以页面的管理员用户身份登录时，我可以在 Facebook 网站上看到它们。但是，当以任何其他帐户登录时，提要中缺少状态。

该应用程序未处于沙盒模式。访问令牌是为具有权限的主页管理员用户获取的`manage_pages`，`publish_stream`默认隐私设置为公开。

有谁知道为什么这些状态消息没有公开显示？

# javascript - 我应该在页面的哪里包含 javascript？

> ID：10076427
> 
> 赞同：1
> 
> 时间：2012-04-09T16:35:11.663
> 
> 标签：javascript, ruby-on-rails

我正在构建一个 Rails 应用程序，似乎常见的做法是在页面顶部列出 javascript_include_tags。

是否会使浏览器在加载文档之前加载 javascript，从而使可见元素的加载时间更长？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:38:32.280

据我在网上阅读，最佳实践在 body 标记的底部加载 javascript 文件。这可以让几乎所有内容在执行 javascript 之前加载，如果您在顶部加载脚本，这通常可以防止访问可能不存在的项目时出现问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T16:39:47.233

一篇关于网页性能的 Yahoo 帖子建议将它们包含在页面底部（[Source](http://developer.yahoo.com/performance/rules.html#js_bottom "雅虎：网站性能的最佳实践")），因为如果它们位于顶部，它们可以阻止其他依赖项的并行下载。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T16:51:13.703

看起来有些答案是正确的，但没有一个能概括一切：

*   如何防止javascript加载加载其他元素？很简单，把它放在结束`</body>`标签之前。这通常意味着 HTML 页面结束前的几个字符。
*   将所有 javascript 放入外部 .js 文件中。为什么？这样即使 HTML 页面发生变化，浏览器也可以缓存这些文件。
*   将所有 javascript 文件聚合并缩小为一个。为什么？因为客户端发出的 HTTP 请求越少，页面加载速度就越快。

此外，您不必关心`$(document).ready()`or `window.onload`，因为您的所有 HTML 元素都将在 javascript 文件之前加载（也就是说，如果您将 JS 文件放在结束`</body>`标记之前）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T16:41:42.353

使用外部 JS 文件并缩小其内容是个好主意。

*   [http://www.quirksmode.org/js/placejs.html](http://www.quirksmode.org/js/placejs.html)

页面底部也是 John Fisher 所说的选项。

如果使用 ie jQuery，您无论如何都要使用`$()`或`$(document).ready(function()`确保在您尝试使用 JS 函数之前加载页面 DOM。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T16:43:55.810

与其将行为嵌入其标记中，不如尝试通过将脚本移动到页面部分中的脚本块（在文档正文范围之外）来隔离脚本，如下所示：

```
<script type="text/javascript">
window.onload = function() {
document.getElementById('testButton').onclick = function() {
document.getElementById('xyz').style.color = 'red';
};
};
</script> 
```

出于性能原因，也可以将脚本块放置在文档正文的底部，尽管现代浏览器使性能差异变得毫无意义。重要的概念是避免在结构元素中嵌入行为元素。

# objective-c - 使用 NSNumberFormatter 循环中的 Objective C 自动释放

> ID：10076432
> 
> 赞同：1
> 
> 时间：2012-04-09T16:35:42.060
> 
> 标签：objective-c, loops, autorelease, nsnumberformatter

我正在尝试格式化一个数字数组以显示在循环中的 CCLabelTTF 数组中。NSNumberFormatter 返回一个自动释放对象。我不太确定我应该如何处理这里的内存管理。任何建议将不胜感激。

这是我要解决的问题：

```
NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
NSString *tempString;

for(int i = 0; i<10; i++){
    tempString = [formatter stringFromNumber:[NSNumber numberWithInteger:NumberArray[i]]];
    CCLabelTTFArray[i] = [[CCLabelTTF alloc] initWithString: tempString fontName:@"Arial" fontSize:10.0f];
    [tempString release];
}

[formatter release]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:46:20.540

您不需要调用：运行循环会在您的方法完成*后*`[tempString release];`的一段时间内为您“自动释放”对象。对于短时间运行的循环（比如你的，只有十次迭代），没有什么可担心的。对于具有数千次迭代的循环，您可以考虑添加[Autorelease Pool](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmAutoreleasePools.html)。

 *> 我认为这可能会导致内存泄漏，因为函数结束时它会自动释放 tempString 但不是所有以前的 tempString 分配

该方法的每次调用都会`stringFromNumber:`将其返回值添加到自动释放池中，因此无论您循环执行多少次，所有返回的字符串都会被自动释放。*

# php - redis 与本机会话

> ID：10076433
> 
> 赞同：24
> 
> 时间：2012-04-09T16:35:49.937
> 
> 标签：php, session, authentication, redis

我在 PHP 中使用会话来跟踪用户是否登录。我不使用它来存储有关用户的任何其他数据；本质上，这就像检查哈希表以查看用户是否已通过身份验证。

使用 redis 代替原生 PHP 会话会有一些优势吗？

我对性能、可扩展性和安全性（并不真正关心代码复杂性）感到好奇。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2014-11-02T18:05:22.313

使用 Redis 之类的东西来存储会话是从负载平衡服务器中获得更多性能的好方法。

例如，在 Amazon Web Services 上，负载均衡器具有所谓的“粘性会话”。这意味着当用户首次连接到您的 Web 应用程序时，例如登录时，负载均衡器将选择您的应用程序服务器之一，并且该用户将继续从该服务器获得服务，直到他们退出您的应用程序。这是因为 PHP 使用的会话，例如，将存储在他们第一次开始使用的应用服务器上。

现在，如果您在单独的服务器上使用 Redis，然后在每个应用服务器上配置 PHP 以将其会话存储在 Redis 中，您可以关闭此“粘性会话”。这意味着您的任何服务器都可以访问会话，因此，对于您的应用程序的每个请求，都会从不同的服务器为用户提供服务。这最终可以更有效地使用您的负载平衡设置。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-03-17T23:22:36.123

您希望会话保存处理程序快速。这是因为 PHP 会话将阻止来自同一用户的所有其他并发请求，直到第一个请求完成。

有多种处理程序可用于跨多个服务器的 PHP 会话：带 NFS 的文件、MySQL 数据库、Memcache 和 Redis。

在我的经验中，数据库方法（使用 InnoDB）是最慢的，其次是带有 NFS 的文件。锁定和写竞争是主要因素。Memcache 和 Redis 提供类似的性能，并且是迄今为止更好的选择，因为所有操作都在 RAM 中。Redis 是我的选择，因为您可以启用磁盘持久性，而 Memcache 仅基于内存。

如果您想了解更多详细信息，我会用 Kohana 解释[PHP 中的 Redis 会话。](http://blog.jamieisaacs.com/2014/03/17/redis-sessions-in-php-with-kohana/)这是我们用于管理 Redis 密钥的仪表板：

![Redis 仪表板](../Images/b4f74f1972582bd78cb499f9ab5645ef.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T17:09:59.280

我真的不认为你需要担心会话，除非你有大量的流量，PHP 很好地处理会话，如果你只存储很少的数据，即使有很多请求也应该没问题，关于性能应该很接近，因为 redis 不是 PHP 原生的。

10k 用户，如果每个用户使用 1kb 的 session 数据，消耗 10,000kb 或 10~mb，不算多；PHP 足够聪明，可以使用足够好的数据结构来保存和快速写入和读取这些值。问题是会话数据是否太大，或者由于某种原因服务器在读取会话数据时消耗了太多资源，但通常是数据太大。

# facebook - 访问令牌 Facebook 图形 api？

> ID：10076434
> 
> 赞同：0
> 
> 时间：2012-04-09T16:35:50.703
> 
> 标签：facebook, facebook-graph-api, facebook-access-token

在 FB 上创建应用后，我得到一个访问令牌 XXX

当我打开[https://graph.facebook.com/me/likes?access_token=XXX](https://graph.facebook.com/me/likes?access_token=XXX)时，它确实显示了我喜欢的所有信息。

但是当我打开从另一个用户那里看到（谁公开了这些信息，比如[https://graph.facebook.com/4/likes?access_token=XXX](https://graph.facebook.com/4/likes?access_token=XXX)）我什么都没有

```
 {
   "data": [

   ]
} 
```

有人可以向我扩展为什么和任何想法可以解决吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T16:19:18.153

您无法查看公开个人资料的喜欢，您必须从应用程序请求许可（user_likes）才能查看此信息。

* * *

[权限](http://developers.facebook.com/docs/authentication/permissions/#basic_info)信息[`user_likes`](http://developers.facebook.com/docs/authentication/permissions/#basic_info)

> user_likes：提供对用户喜欢的所有页面列表的访问作为喜欢连接

* * *

公开资料示例（*对不起，btaylor，但您的名字在文档上* ）

[https://graph.facebook.com/btaylor/likes?access_token=xxx](https://graph.facebook.com/btaylor/likes?access_token=xxx)

您将看到一个空数据集。

* * *

从用户文档中，谈论[喜欢](http://developers.facebook.com/docs/reference/api/user/#likes)连接：

> 读
> 
> 您可以通过使用 user_likes 或 friends_likes 权限向 /PROFILE_ID/likes 发出 HTTP GET 来阅读用户喜欢的页面。例如：
> 
> [https://graph.facebook.com/me/likes](https://graph.facebook.com/me/likes)

# c - Haskell外部函数接口中的'#type'是什么意思？

> ID：10076436
> 
> 赞同：5
> 
> 时间：2012-04-09T16:35:59.343
> 
> 标签：c, haskell, types, ffi, preprocessor-directive

`sendfile`我在 Haskell包中找到了这段代码：

[http://patch-tag.com/r/mae/sendfile/snapshot/current/content/pretty/src/Network/Socket/SendFile/Linux.hsc](http://patch-tag.com/r/mae/sendfile/snapshot/current/content/pretty/src/Network/Socket/SendFile/Linux.hsc)

```
-- sendfile64 gives LFS support
foreign import ccall unsafe "sendfile64" c_sendfile
  :: Fd -> Fd -> Ptr (#type off64_t) -> (#type size_t) -> IO (#type ssize_t) 
```

1) 是什么`#type`意思和 2) 为什么我会收到这个错误，

```
[1 of 1] Compiling Linux.Splice     ( splice.hs, splice.o )

splice.hs:40:12: parse error on input `type' 
```

当我自己尝试如下使用它时？：

```
ghc --make splice.hs 
```

拼接.hs：

```
{-# LANGUAGE ForeignFunctionInterface #-}

module Linux.Splice where

import Data.Word
import System.Posix.Types

-- SPLICE

 -- fcntl.h
 -- ssize_t splice(
 --   int          fd_in,
 --   loff_t*      off_in,
 --   int          fd_out,
 --   loff_t*      off_out,
 --   size_t       len,
 --   unsigned int flags
 -- );

foreign import ccall unsafe "fnctl.h splice" c_splice
  :: Fd
  -> Ptr (#type {- < parse error -} loff_t)
  -> Fd
  -> Ptr (#type loff_t)
  -> (#type size_t)
  -> Word
  -> IO (#type ssize_t) 
```

（使用 GHC 7.4.x）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:39:21.453

正如 scdvvc 所指出的，这使用了[hsc2hs](http://www.haskell.org/ghc/docs/latest/html/users_guide/hsc2hs.html)定义的 C 预处理宏来专门针对正在编译的系统定制代码。您需要使用`hsc2hs`来获取为您的代码定义的适当宏。

# actionscript-3 - 自动调整文本大小以适合按钮的宽度

> ID：10076442
> 
> 赞同：0
> 
> 时间：2012-04-09T16:36:43.757
> 
> 标签：actionscript-3, flash, flash-cs5

我环顾四周，但找不到任何可以直接解决我的问题的东西。有几个帖子是正确的，但我无法解决这个问题。

我需要自动调整文本大小，使其不超过按钮的宽度。我的大小文本的最大长度似乎是 13 个字符，然后才会变得太大。

--

该程序首先动态创建几个按钮，用 XML 文档中设置的标题和描述填充它们。

要添加文本，我有以下代码：

```
var tform:TextFormat = new TextFormat();
tform.size = 20;
tform.font = "Arial";
tform.align = TextFormatAlign.CENTER;
tform.color = 0xFFFFFF;
tform.bold = true;

var tfield:TextField = new TextField();
tfield.text = texttitle;
tfield.width = button.width;
tfield.x = 0;
tfield.y = 30;

tfield.setTextFormat(tform);
addChild(tfield); 
```

这会将文本直接定位在距离顶部 30 像素的按钮中心。因此，我面临的问题是如何修改字体大小以将文本保留在框中。

--

现在，因为我将宽度设置为面板的大小，所以我看不到任何明显的循环方式来根据允许的最大宽度设置字体大小。

我相信这一切都是有道理的，我欢迎任何修改以使代码更高效，因为我对 AS3 和 Flash 相对较新，因此仍在学习曲线上。

问候，乔恩。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:59:50.850

我遇到了这个问题并通过循环文本设置直到它适合它来解决它

类似的东西

```
while (tf.textwidth > button.width){
   myTextFormat.size = myTextFormat.size - 1;
   tf.setTextFormat(myTextFormat);
   tf.autoSize = "left";
} 
```

# ios - 它是否存在具有本机显示值的 UISlider？

> ID：10076443
> 
> 赞同：-2
> 
> 时间：2012-04-09T16:36:50.133
> 
> 标签：ios, uislider

我可以在滑块值更改后立即显示标签文本，但是有更聪明的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:52:25.203

`UISlider`as part of`UIKit`没有`UILabel`类型的子视图。

如果您需要大量此类视觉控件，您可以考虑子类化`UISlider`。

否则只需使用单独`UISlider`的 and `UILabel`。

此功能有更多可能的方法：

您可能至少熟悉第一个：针对`valueChanged`事件的定位。

更优雅的方法（可参考）将是键值观察。

[键值观察编程指南](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueObserving/KeyValueObserving.html#//apple_ref/doc/uid/10000177-BCICJDHA)

# c# - 在 PHP 和 C# 之间解码 base64 文件内容

> ID：10076447
> 
> 赞同：0
> 
> 时间：2012-04-09T16:37:13.307
> 
> 标签：c#, php, stream, base64

我需要将 AES 加密的 base64 编码文件从 PHP 提供给 C# 客户端（Mono，在各种平台上）。我已经成功地让 AES 加密/解密工作正常，但是一旦我尝试 base64 编码/解码，我就会遇到麻烦。下面的两个示例都禁用了 AES，因此这不应该是一个因素。

我最简单的测试用例 Hello World 字符串可以正常工作：

PHP服务输出-

```
// Save encoded data to file
$data = base64_encode("Hello encryption world!!");
$file = fopen($targetPath, 'w');
fwrite($file, $data);
fclose($file);

// Later on, serve the file
header("Pragma: public");
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: private",false);
header("Content-Type: application/octet-stream");
header("Content-Disposition: attachment; filename=".basename($product->PackageFilename($packageId)));
header("Content-Transfer-Encoding: binary");
header("Content-Length: ".filesize($targetPath));
ob_clean();
flush();
$handle = fopen($targetPath, "r");
fpassthru($handle);
fclose($handle); 
```

C#解码和使用-

```
StreamReader reader = new StreamReader(stream);
char[] buffer = DecodeBuffer;
string decoded = "";
int read = 0;
while (0 < (read = reader.Read(buffer, 0, DecodeBufferSize)))
{
    byte[] decodedBytes = Convert.FromBase64CharArray(buffer, 0, read);
    decoded += System.Text.Encoding.UTF8.GetString(decodedBytes);
}
Log(decoded); // Correctly logs "Hello encryption world!!" 
```

但是，一旦我开始尝试对文件的内容执行相同的操作，Convert.FromBase64CharArray 就会抛出*FormatException: Invalid character found ：*

PHP服务输出-

```
// Save encoded data to file
$data = base64_encode(file_get_contents($targetPath));
$file = fopen($targetPath, 'w');
fwrite($file, $data);
fclose($file);

// Later on, serve the file
// Same as above 
```

C#解码和使用-

```
using (Stream file = File.Open(zipPath, FileMode.Create))
{
using (StreamReader reader = new StreamReader(stream))
{
    char[] buffer = DecodeBuffer;
    byte[] decodedBytes;
    int read = 0;
    while (0 < (read = reader.Read(buffer, 0, DecodeBufferSize)))
    {
        // Throws FormatException: Invalid character found
                    decodedBytes = Convert.FromBase64CharArray(buffer, 0, read);
        file.Write(decodedBytes, 0, decodedBytes.Length);
    }
}
} 
```

是否应该对更大的数据进行某种额外的处理才能使 base64 有效？对大型二进制数据执行此操作是否不合适？如果是，您将如何防止传输不安全字符的潜在问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:02:02.640

您阅读的 Base64 文本代码不正确。

*   Base64 是文本，因此请考虑改用文本阅读器
*   Base64 可能包含新行/空格。即，习惯将整个 Base64 编码值拆分为 70-80 个字符长的字符串。

要验证文件中的数据是否正确，将整个文件读取为字符串（[StreamReader.ReadToEnd](http://msdn.microsoft.com/en-us/library/system.io.streamreader.readtoend%28v=vs.100%29.aspx)）并转换为字节数组（[Convert.FromBase64String](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx)）。

如果文件包含有效的 Base64 数据并且您无法将其作为单个字符串读取，则应实现自己的 Base64 解码或手动读取正确数量的非空白字符（4 的倍数）并解码此类块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:03:00.333

Base64 编码将 3 个八位字节转换为 4 个编码字符。因此，您提供用于解码的数据长度需要是 4 的倍数。

首先，确保它`DecodeBufferSize`是 4 的倍数。接下来，由于`StreamReader.Read`不能保证将读取所有请求的字节，因此您应该继续读取，`buffer`直到它被填充或到达流的末尾。

# javascript - 将一些复选框值从一个 JSP 传递到另一个

> ID：10076448
> 
> 赞同：1
> 
> 时间：2012-04-09T16:37:20.713
> 
> 标签：javascript, jquery, jsp

我在将参数从一个 .jsp 传递到另一个时遇到问题。

我有两个 .jsp（1 和 2）。在 1 我从数据库中获取一些数据并向用户显示一堆复选框（取决于我之前获得的数据）。用户必须选中一个或多个复选框，选中的复选框将在 2 中从我的数据库中删除。（类似于“选择要删除的数字”）。

我不知道如何传递选定的复选框和从 1 到 2 的值。我尝试使用 javascript/jQuery，试图知道是否选中了复选框及其值，将值添加到隐藏字段并使用请求2 得到它。

**1.jsp**

```
<%
    HttpSession sesion = request.getSession();

    Company company = (Company) sesion.getAttribute("company");
    List<Phone> phones = company.getTelefonos();
%>
<form id="formulario" method="POST" action="desMul_Final.jsp">
<fieldset>
    <legend>Numbers</legend>
    <%
        Iterator<Phone> it1 = phones.iterator();
        while(it1.hasNext()){
            Phone t = it1.next();
            String number = t.getNumero();
    %>
    <p>
        <input name=check id="t_<%=number%>" type=checkbox value="<%=number%>" /> <%=number%>.
    </p>
    <%
        }
    %>
</fieldset>
<p class="buttons">
    <button type=submit onclick="javascript: pick();">Continue</button>
</p>
</form> 
```

**Javascript/jQuery**

```
function pick(){
var counter = 0;
$("#formulario fieldset p").each(function(index){
    var field;
    $(this).children("input").each(function() {
        if($this.is(':checked')){
            field = $(this).val();
        }
    });
    index = index + 1;

    texto = "<input type=hidden name=phone_"+index+" value="+field+" />";
    $("#formulario").append(texto);

    counter = index;
});
cant = "<input type=hidden name=amount id=amount value="+counter+" />";
$("#formulario").append(cant);
} 
```

**2.jsp**（这里我只是想知道我有没有信息）

```
<%
    int amount = Integer.valueOf(request.getParameter("amount"));
    System.out.println(amount);

    for(int i = 1; i <= amount; i++){
            String s = request.getParameter("phone_"+i);
        System.out.println(s);
    }
%> 
```

当我尝试访问时，`request.getParameter("amount")`我得到了一个`java.lang.NumberFormatException: null`，所以我认为我的 Javascript/jQuery 是错误的。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:02:04.363

您是否熟悉以客户端方式调试 Web 应用程序？您能否插入 console.log("$("#formulario")) 然后在 $("#formulario").append(cant); 之后插入一个断点，以查看表单的内容如何更改，以及隐藏的输入是否为添加 ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:06:38.190

使用`int[] amount= Integer.ValueOf(request.getParameterValues("amount"));`而不是`request.getParameter("amount");`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T14:16:22.810

好吧，我终于找到了解决方案，我不需要任何 Javascript。在 API 中搜索，我找到了一个调用的请求方法，该方法`getParameterNames()`返回*一个字符串对象的枚举，其中包含此请求中包含的参数的名称*。

而且我知道，当您提交表单时，如果选中控件，则会发送复选框值。否则，不会发送任何内容。所以有了这些信息和方法，我改变了复选框的构造方式，并使用枚举来获取值。

```
BEFORE  
<input name=check id="t_<%=number%>" type=checkbox value="<%=number%>" /> <%=number%>.

NOW  
<input name="<%=number%>" type=checkbox /> <%=number%>. 
```

因此，在我的第二个 .jsp 中，我得到一个带有所选复选框名称的枚举，这些复选框是电话号码。

```
java.util.Enumeration enu = request.getParameterNames();
java.util.List<String> numbers = new java.util.ArrayList<String>();
while(enu.hasMoreElements()){
   String s = (String)(enu.nextElement());
   System.out.println(s);
   numbers.add(s);
} 
```

# c# - 字符串生成器与列表

> ID：10076454
> 
> 赞同：0
> 
> 时间：2012-04-09T16:37:49.827
> 
> 标签：c#, string, visual-studio-2010, list, stringbuilder

我正在阅读数百万行的多个文件，并且正在创建一个包含特定问题的所有行号的列表。例如，如果特定字段留空或包含无效值。

所以我的问题是什么是最有效的日期类型来跟踪可能超过一百万行的数字列表。使用字符串生成器、列表或其他东西会更有效吗？

我的最终目标是发出一条消息，例如“特定字段在 1-32、40、45、47、49-51 等处为空白。因此，对于字符串生成器，我将检查先前的值，如果它is 只是多了 1 我会将其从 1 更改为 1-2 如果超过一个将用逗号分隔它使用列表，我只需将每个数字添加到列表中，然后在文件具有已完全阅读。但是在这种情况下，我可以有多个包含数百万个数字的列表。

这是我使用 String Builder 组合数字列表的当前代码：

```
string currentLine = sbCurrentLineNumbers.ToString();
string currentLineSub;

StringBuilder subCurrentLine = new StringBuilder();
StringBuilder subCurrentLineSub = new StringBuilder();

int indexLastSpace = currentLine.LastIndexOf(' ');
int indexLastDash = currentLine.LastIndexOf('-');

int currentStringInt = 0;

if (sbCurrentLineNumbers.Length == 0)
{
    sbCurrentLineNumbers.Append(lineCount);
}
else if (indexLastSpace == -1 && indexLastDash == -1)
{
    currentStringInt = Convert.ToInt32(currentLine);

    if (currentStringInt == lineCount - 1)
        sbCurrentLineNumbers.Append("-" + lineCount);
    else
    {
        sbCurrentLineNumbers.Append(", " + lineCount);
        commaCounter++;
    }
}
else if (indexLastSpace > indexLastDash)
{
    currentLineSub = currentLine.Substring(indexLastSpace);
    currentStringInt = Convert.ToInt32(currentLineSub);

    if (currentStringInt == lineCount - 1)
        sbCurrentLineNumbers.Append("-" + lineCount);
    else
    {
        sbCurrentLineNumbers.Append(", " + lineCount);
        commaCounter++;
    }
}
else if (indexLastSpace < indexLastDash)
{
    currentLineSub = currentLine.Substring(indexLastDash + 1);
    currentStringInt = Convert.ToInt32(currentLineSub);

    string charOld = currentLineSub;
    string charNew = lineCount.ToString();

    if (currentStringInt == lineCount - 1)
        sbCurrentLineNumbers.Replace(charOld, charNew);
    else
    {
        sbCurrentLineNumbers.Append(", " + lineCount);
        commaCounter++;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:40:20.293

> 我的最终目标是发出一条消息，例如“1-32、40、45、47、49-51 上的特定字段为空白

如果这是最终目标，那么通过诸如 a 之类的中间表示毫无意义`List<int>`- 只需使用`StringBuilder`. 这样可以节省内存和 CPU。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T16:43:43.093

StringBuilder 服务于您的目的，所以坚持下去，如果您需要行号，您可以轻松更改代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T16:51:38.097

取决于您如何/想要分解代码。

鉴于您正在按行顺序阅读它，因此不确定您是否需要一个列表。您当前所需的输出意味着在完全扫描文件之前您无法输出任何内容。文件的大小表明，一次性分析阶段也是一个好主意，因为您将使用缓冲输入而不是将整个内容读入内存。

我很想用枚举来描述这个问题，例如字段？？？是空白的，然后将其用作字符串构建器字典的键。

无论如何，作为第一个想法

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T17:09:27.810

你的输出应该是人类可读的吗？如果是这样，那么在您的数据结构出现任何性能/内存问题之前*，*您就会达到合理阅读的极限。使用对您来说最容易使用的东西。

如果输出应该是机器可读的，那么该输出可能会建议适当的数据结构。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-09T17:14:26.517

正如其他人指出的那样，我可能会使用`StringBuilder`. 列表可能需要多次***调整大小；***的新实现`StringBuilder`不必调整大小。

# forms - Symfony2：如何隐藏我的日期时间表单输入中的秒数？

> ID：10076458
> 
> 赞同：1
> 
> 时间：2012-04-09T16:37:59.617
> 
> 标签：forms, symfony

我的 FormType 中有以下字段配置：

```
$builder
            ->add('startDate','datetime',array(
                'required' => false,
                'date_widget' => 'single_text',
                'time_widget' => 'single_text',
                'with_seconds' => false,
            )) 
```

表单仍然向我显示带有秒数的时间小部件：

> 08:15:00

有人能告诉我为什么吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-10T09:53:23.867

设置[date_format](http://symfony.com/doc/current/reference/forms/types/datetime.html#date-format)属性。

# c - C语言的语义分析

> ID：10076469
> 
> 赞同：1
> 
> 时间：2012-04-09T16:38:57.710
> 
> 标签：c, parsing, compiler-construction, semantic-analysis

我最近一直在寻找`C`语言的语义分析器，但找不到。我找到了生成解析器的语言文件`flex`。`yacc` `C`我已经设法修改它们并生成一个解析器。但现在我需要执行下一步。`C`如果有人能指出一些语义分析和构建树的示例，我将不胜感激。任何有关语义分析的信息都会有所帮助。我找到了一些小型`C`编译器，但它们使用自己的解析器，所以它们不适合我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:03:15.607

我们的[DMS 软件再造工具包](http://wwww.semanticdesigns.com/Products/DMS/DMSToolkit.html)及其[C 前端](http://www.semanticdesigns.com/Products/FrontEnds/CFreontEnd)可能提供您所需要的。

DMS 提供通用解析、树构建和程序分析机制。C 前端专门用于 C 语言。它处理 C 的许多常见方言/变体（GCC、Microsoft、Green Hills）及其暗角、解析和构建 ASTS、构建控制和数据流图、指向分析以及占间接函数指针的全局调用图。

您可以尝试自己完成所有这些工作，但您会发现要完成所有这些工作需要数年时间。

# c++ - 是否可以使用用户定义的 I/O 操纵器来操纵某些文本？

> ID：10076471
> 
> 赞同：3
> 
> 时间：2012-04-09T16:39:13.333
> 
> 标签：c++

在将 std::cin 中的某些文本插入 a 之前，是否有一种（干净的）方法来操作它`std::string`，以便以下操作：

```
cin >> setw(80) >> Uppercase >> mystring; 
```

mystring 在哪里`std::string`（我不想对字符串使用任何包装器）。 `Uppercase`是一个操纵者。我认为它需要直接作用于缓冲区中的字符（无论现在认为是大写而不是小写）。这样的操纵器似乎很难以干净的方式实现，因为据我所知，用户定义的操纵器用于轻松更改或混合一些预先确定的格式标志。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:57:10.630

您可能想查看 boost iostreams。它的框架允许定义可以操纵流的过滤器。 [http://www.boost.org/doc/libs/1_49_0/libs/iostreams/doc/index.html](http://www.boost.org/doc/libs/1_49_0/libs/iostreams/doc/index.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T17:09:18.563

（非扩展）操纵器通常只设置提取器随后读取并做出反应的标志和数据。（这就是`xalloc`,`iword`和`pword`的用途。）显然，您可以做的是编写类似于 的内容`std::get_money`：

```
struct uppercasify {
  uppercasify(std::string &s) : ref(s) {}
  uppercasify(const uppercasify &other) : ref(other.ref) {}
  std::string &ref;
}
std::istream &operator>>(std::istream &is, uppercasify uc) { // or &&uc in C++11
  is >> uc.ref;
  boost::to_upper(uc.ref);
  return is;
}

cin >> setw(80) >> uppercasify(mystring); 
```

或者，`cin >> uppercase`可以返回的不是对 的引用`cin`，而是某个（模板）包装类的实例化`uppercase_istream`，并带有对应的重载`operator>>`。我不认为让操纵器修改底层流缓冲区的内容是一个好主意。

If you're desperate enough, I guess you could also `imbue` a hand-crafted locale resulting in uppercasing strings. I don't think I'd let anything like that go through a code review, though – it's simply just waiting to surprise and bite the next person working on the code.

# asp.net-mvc - 在将 DropDownList 设置为之前检查 ViewData 是否为空

> ID：10076472
> 
> 赞同：5
> 
> 时间：2012-04-09T16:39:19.643
> 
> 标签：asp.net-mvc

我有这个：

```
<% if (ViewData["roots"] != null) {%>
       <%Html.DropDownList("roots"); %>
<%}%> 
```

但它不起作用。如何检查 ViewData 是否存在？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-09T16:46:38.923

尝试

```
ViewData.ContainsKey("roots") 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-10T05:56:46.160

您没有输出任何内容，并且错误地使用了 DropDownList 帮助程序。试试这样：

```
<% if (ViewData["roots"] != null) { %>
       <%= Html.DropDownList("roots") %>
<% } %> 
```

# iphone - 暂停 CCAction cocos2d

> ID：10076476
> 
> 赞同：0
> 
> 时间：2012-04-09T16:39:32.530
> 
> 标签：iphone, ios, cocos2d-iphone

```
self.boxesOnLift = [NSMutableArray array];
        [self init];
        [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"Animation.plist"];
        NSMutableArray *walkAnimFrames = [NSMutableArray array];
        for(int i = 1; i <= 9; ++i) 
        {
            [walkAnimFrames addObject:[[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:
              [NSString stringWithFormat:@"lift%d.png", i]]];
        }
        self.animation = [CCAnimation animationWithFrames:walkAnimFrames delay:0.1f];
        self.lift = [CCSprite spriteWithSpriteFrameName:@"lift1.png"];        
        self.lift.position = ccp(0, 0);
        self.walkAction = [CCRepeatForever actionWithAction: [CCAnimate actionWithAnimation:walkAnim restoreOriginalFrame:NO]];
        [self.lift runAction:_walkAction];
        [self addChild:self. lift]; 
```

我可以在当前位置暂停动画吗？我可以在这个位置恢复我的行动吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:59:03.663

您需要调用`-(void) pauseSchedulerAndActions`或`-(void) onExit`在要暂停的 CCNode 上。请注意，尽管此方法在您添加/删除节点时可能会产生副作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T13:41:52.787

您还可以使用 -(void) resumeSchedulerAndActions 来恢复调度程序及其操作。

# java - 用于将集合划分为组的 OO 模式

> ID：10076478
> 
> 赞同：1
> 
> 时间：2012-04-09T16:39:34.120
> 
> 标签：java, oop, design-patterns

我有一个 MyObjects 列表，我需要将其分为三组：

1.  已知良好（保留）
2.  已知不良（拒绝）
3.  无法识别（提高警报）

MyObject 包含各种属性，必须检查这些属性以确定将对象放入 3 个组中的哪一个。

我的初始实现（Java）只是在其构造函数中使用一个 List 并在那里进行分类。伪代码：

```
class MyObjectFilterer {
  public MyObjectFilterer(List<MyObject> list) {
    // triage items here
  }
  public List<MyObject> getGood() {
    // return sub-list of good items
  }
  public List<MyObject> getBad() {
    // return sub-list of bad items
  }
  public List<MyObject> getUnrecognized() {
    // return sub-list of unrecognized items
  }
} 
```

这个实现有什么问题吗？有没有更好的OO选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:42:18.417

我可能更喜欢静态工厂方法来进行过滤，然后调用一个私有构造函数，该构造函数采用三个过滤后的列表，遵循从不在构造函数中做任何严肃工作的良好代码实践。除此之外，这看起来不错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:46:15.263

可能有多种方法。如果问题足够普遍/重复，您可以定义一个带有分类对象的方法的接口。

```
interface Selector {
  public boolean isGood(MyObject myObject);
  public boolean isBad(MyObject myObject);
  public boolean isUnknown(MyObject myObject); 
```

}

这样您就可以轻松更改逻辑实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T17:03:09.943

另一个想法是使用责任链。

您的**MyObjectFilterer**包含对三个对象**GoodFilterer**、**BadFilterer**和**UnrecognizedFilterer**的引用。它们中的每一个都包含以下方法：**addMethod(MyObject object)**、**getObjects()**和**addFilter()**。当然，他们必须实现一个接口**Filterer**。

使用**addFilter**方法，您可以构建链。这样**GoodFilterer**包含对 BadFilterer 的引用，**而**这个包含对**UnrecognizedFilterer的引用**

现在您浏览您的**MyObjects**列表并调用**GoodFilterer**（此链中的第一个）上的 add 方法。在 add 方法中，您决定这是否好，而不是保留它并完成工作，如果不将其传递给**BadFilterer**。

您保留用于获取好/坏和无法识别的三种方法，但您会将其传递给相应过滤器的**getObjects** **()**方法

 **好处是，如果这是一个好/坏或无法识别的逻辑，现在是分开的。

缺点是您需要 3 个新类和 1 个接口。

但就像我说的，这只是你可以做的另一个想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T17:14:03.393

您应该尽可能简化。只需在 MyObjectFilter 中使用以下签名创建静态方法：

public static List filterMyObjects(List data, Group group)。

Group 是具有三个值的枚举，它可以用作 MyObject 类的属性

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T17:39:51.020

我可能会尝试类似：

```
enum MyObjectStatus {
   GOOD, BAD, UNRECOGNIZED;
}

class MyObjectFilterer {
  private MyObjectStatus getStatus(MyObject obj) {
    // classify logic here, returns appropriate enum value
  }

  // ListMultimap return type below is from Google Guava
  public ListMultimap<MyObjectStatus, MyObject> classify(List<MyObject> objects) {
     ListMultimap<MyObjectStatus, MyObject> map = ArrayListMultimap.create();
     for(MyObject obj: objects) {
        map.put(getStatus(obj), obj);
     }
  }
} 
```

调用classify() 获取Multimap，并根据需要提取每个类别，例如：

```
List<MyObject> good = map.get(GOOD);
List<MyObject> bad = map.get(BAD);
List<MyObject> unknown = map.get(UNRECOGNIZED); 
```

这个解决方案的一个好处是您不必为每个类别创建/发布访问器方法（除非您愿意），并且如果创建了新类别，您也不需要添加新的访问器——只需新的枚举和附加的分类器逻辑。**

# c# - 用 ok/cancel 确认对话框

> ID：10076479
> 
> 赞同：1
> 
> 时间：2012-04-09T16:39:37.517
> 
> 标签：c#, asp.net, webforms

我正在使用 WebForms GridView 控件。当用户单击一行上的“更新”时，我想检查他们输入的值与其他一些记录。

从那以后，如果我返回 true，我想显示一个确认对话框，询问用户是否愿意继续更新。

javascript 确认对话框可能不起作用，因为我并不总是想显示此对话框，只有当输入的值满足特定条件时。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:12:23.360

我建议使用该`RowDataBound`事件来检查这些条件并在需要时添加确认对话框。

**编辑：**比较日期并在它们不同时显示确认

请参阅此[jsFiddle](http://jsfiddle.net/XjypN/4/)进行演示。

```
<script type="text/javascript">        
   validateInput = function(inputDate, compareDate, confirmButtonID) {           
       var confirmButton = document.getElementById(confirmButtonID);       
       if (confirmButton) {               
           $(confirmButton).one("click", function() {
               var result = dates.compare(inputDate, compareDate);
               if (result != 0){ //change to suit your needs
                   return confirm("Are you sure you want to save these changes?");        
               }
               return true;
           });                                                                                 
       }
    }             
</script> 
```

这是`dates`用于比较的类的代码（[链接](https://stackoverflow.com/questions/497790)）：

```
<script type="text/javascript">
    var dates = {
        convert:function(d) {
            return (
                d.constructor === Date ? d :
                d.constructor === Array ? new Date(d[0],d[1],d[2]) :
                d.constructor === Number ? new Date(d) :
                d.constructor === String ? new Date(d) :
                typeof d === "object" ? new Date(d.year,d.month,d.date) :
                NaN
            );
        },
        compare:function(a,b) {
            return (
                isFinite(a=this.convert(a).valueOf()) &&
                isFinite(b=this.convert(b).valueOf()) ?
                (a>b)-(a<b) :
                NaN
            );
        },
        inRange:function(d,start,end) {
           return (
                isFinite(d=this.convert(d).valueOf()) &&
                isFinite(start=this.convert(start).valueOf()) &&
                isFinite(end=this.convert(end).valueOf()) ?
                start <= d && d <= end :
                NaN
            );
        }
    }
</script> 
```

在 的`RowDataBound`情况下，为每一行`GridView`分配函数：`onchange`

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    var inputCtrl = e.Row.FindControl("txtEnteredDate") as TextBox;
    if (inputCtrl != null)
    {
        var updateButtonCtrl = e.Row.FindControl("btnUpdate") as Button;
        if (updateButtonCtrl != null)
        {
            inputCtrl.Attributes["onchange"] = string.Format("return validateInput(this.value, '{0}', '{1}');", DataBinder.Eval("DateToCompare"), updateButtonCtrl.ClientID);
        }
    }
} 
```

**jQuery 确认对话框**

如果您需要比常规 JavaScript 确认对话框更灵活的内容，您可以更改上述内容以使用[jQuery UI 对话框](http://jqueryui.com/demos/dialog/modal-confirmation.html)作为确认。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:44:05.000

如果您使用的是 WebForms (?)，则需要向 GridView 模板添加一些验证控件。

这是[MSDN](http://msdn.microsoft.com/en-us/library/bb426882.aspx)中使用的示例`CompareValidator`：

```
<EditItemTemplate>
    <asp:TextBox ID="EditUnitPrice" runat="server"
      Text='<%# Bind("UnitPrice", "{0:c}") %>'
      Columns="6"></asp:TextBox>
    <asp:CompareValidator ID="CompareValidator1" runat="server"
        ControlToValidate="EditUnitPrice"
        ErrorMessage="The price must be greater than or equal to zero and
                       cannot include the currency symbol"
        Operator="GreaterThanEqual" Type="Currency"
        ValueToCompare="0">*</asp:CompareValidator>
</EditItemTemplate> 
```

# jquery - 如何定位 SimpleModal 弹出帖子的元素

> ID：10076482
> 
> 赞同：4
> 
> 时间：2012-04-09T16:39:47.247
> 
> 标签：jquery, resize, simplemodal

我正在使用[simplemodal 插件](http://www.ericmmartin.com/projects/simplemodal/)和本[教程](http://wordpressthemescollection.com/ajax-wordpress-post-popup-with-simplemodal-and-jquery-488.html)从主页上的拇指弹出我的 wordpress 网站上的帖子。我一遍又一遍地阅读教程，无法弄清楚如何定位叠加层来设置它的样式。我还需要针对 simplemodal-container 来设置样式。本教程提供了此功能来调用弹出帖子。

```
jQuery(document).ready(function() {
    jQuery('a.postpopup').click(function(){
        id = jQuery(this).attr('rel');
        jQuery('<div id="ajax-popup"></div>').hide().appendTo('body').load('http://urlofyoursite.com/ajax-handler/?id='+id).modal();
        return false;
    });
}); 
```

simplemodal 插件说您可以使用 更改覆盖的样式，`overlayCss [Object:{}]`并使用 更改 simplemodal-container 的样式`containerCss [Object:{}]`。但是，我尝试将其放在此函数中的任何地方都会导致问题。我尝试在上面的函数下添加它，但它没有做任何事情。

```
jQuery("#ajax-popup").modal({
    opacity:80,
    overlayCss: {backgroundColor:"#000"},
    containerCss: {margin: "0 auto",top:0}
}); 
```

我做错了什么，我需要在哪里添加这个？

更新：好的，我到了某个地方，但容器 css 出于某种原因不会覆盖默认设置。

```
jQuery(document).ready(function() {
    jQuery('a.postpopup').live('click', function(){
        var id = jQuery(this).attr('rel');
        jQuery('<div id="ajax-popup"></div>').hide().appendTo('body').load('http://fameordie.com/ajax-handler/?id='+id).modal({
           opacity:90,
           containerCss:{
               top:0
           },
           overlayClose:true
        });
        return false;
    }); 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T11:49:01.640

弄清楚了。这是解决方案：

```
jQuery(document).ready(function() {
    jQuery('a.postpopup').live('click', function(){
        var id = jQuery(this).attr('rel');
        jQuery('<div id="ajax-popup"></div>').hide().appendTo('body').load('http://fameordie.com/ajax-handler/?id='+id).modal({
           opacity:90,
           position: ["0%"],
           overlayClose:true
        });
        return false;
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T17:19:17.900

试试下面的：

```
.modalWrapper{
    margin: 0 auto;
    display:block;
    position:relative;
} 
```

# objective-c - 复制属性和 Block_copy(myBlock) / [myBlock 复制]

> ID：10076483
> 
> 赞同：7
> 
> 时间：2012-04-09T16:39:49.883
> 
> 标签：objective-c, ios, automatic-ref-counting, block

考虑：

```
typedef void (^select_block_t)(UIView *) ;

(1) @property (copy, nonatomic) select_block_t        myBlockProperty ;
(2) @property (strong, nonatomic) select_block_t      myBlockProperty ;
(3) @property (assign, nonatomic) select_block_t      myBlockProperty ; 
```

和：

```
(A) self.myBlockProperty = ^(UIView *) {NSLog(@"Hi");} ;
(B) self.myBlockProperty = [^(UIView *) {NSLog(@"Hi");} copy] ; 
```

我试图了解将哪个属性声明与哪个块复制语义映射的正确方法是什么

我在这里看到了一些有[利于](https://stackoverflow.com/questions/9859719/xcode-property-attributes-nonatomic-copy-strong-weak)[[](https://stackoverflow.com/questions/7111541/exc-bad-access-when-copying-or-retaining-block) 1:B]的例子

但是后来我对“复制”操作的冗余程度感到困惑。我有限的理解是 [1:A] 应该是正确的，因为我希望在分配属性时复制一次块，而不是在创建块时复制一次，然后在分配属性时再复制一次。

[3:B] 根据我的理由也是有意义的。那么，我误会了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T17:43:18.543

[1:A] 是正确的，是的。[3:B] 不正确，因为：

1.  不清楚该类是否拥有该属性，因此应该在 dealloc 中释放它（但应该）
2.  setter (B) 看起来像一个泄漏，静态分析器可能会这样标记它，因为块被复制，交给一个属性，然后离开范围，保留计数 +1。
3.  using (3) 意味着它仅在您设置保留计数为 1 的堆块（复制块）时才有效。这在使用该属性时为错误留下了很大的余地。(1) 适用于堆栈块和堆块，并且还将正确保留自动释放的块。

编辑：我看到你正在使用 ARC。在这种情况下，根本不可能使用 [3:B]。一旦超出范围，编译器将释放一个对象（即使是`copy`ed），并且此属性设置器不会保留它。因此该属性将包含一个坏指针，它是一个等待发生的 EXC_BAD_ACCESS。

# c++ - 使用 case switch 语句加载函数

> ID：10076485
> 
> 赞同：1
> 
> 时间：2012-04-09T16:39:59.130
> 
> 标签：c++, visual-studio, switch-statement

我正在用 C++ 编写一个程序，并且我已经能够让它编译并开始运行，但是当我选择一个选项时，应该由 switch-case 语句调用的对应函数不会被调用。我的代码中是否缺少某些内容？

```
//The following program framework is given.
//Add the programming logic to complete the assignment.
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
using namespace std;
//function prototypes should be placed here
//Main must be the first function in the program. Write other functions after it.
int main()
{
char cInput;
string strFileName;
vector<string> vecStudent;
cout<<"Please enter the data file name (with location): ";
cin >> strFileName;
//call a function to read the content of the input file into
//the vector vecStudent
while (true)
{
cout<<"----------------------------------------"<<endl;
cout<<" Student Record - Main Menu "<<endl;
cout<<"----------------------------------------"<<endl;
cout<<" Enter 1 to display ALL students"<<endl;
cout<<" Enter 2 to add a student name"<<endl;
cout<<" Enter 3 to delete a student name"<<endl;
cout<<" Enter 4 to SAVE and quit the program"<<endl;
cout<<"----------------------------------------"<<endl;
cout<<"Enter menu option: ";
cin>>cInput;
switch (cInput)
{
case '1':
//call function display names
   void displaynames();
break;
case '2':
   void addname();
//call a function add name
break;
case '3':
    void deletename();
//call function delete names
break;
case '4':
   void  saveandquit();
//call function save and quit
return 0;

if( cInput != 1,2,3,4)
cout<<"invalid input"<<endl;
break;
}
}
return 0;
}

int displaynames()
{
    ifstream inFile;
    ofstream outFile;
    string strFileName;
    string strFName,strLName;
    vector<string> vecStudent;
    char line[80];

    // open input file
    inFile.open(strFileName.c_str());
    if (inFile.fail())
    {
        cout << " Input file error!" << endl;
            return -1;
    }
    while (inFile>>strFName>>strLName)
        vecStudent.push_back(strFName+ " "+strLName);
    inFile.close();

    //display the content of the vector
    for(int i =0; i< vecStudent.size();i++)
        cout<<vecStudent[i]<<endl;
return 0;
}

int addname()
{
    ifstream inFile;
    ofstream outFile;
    string strFileName;
    string strFName,strLName;
    vector<string> vecStudent;
    char line[80];
    //add a new name
    cout << endl<< " Enter a new name( First and Last Name):";
    cin>>strFName>>strLName;
    vecStudent.push_back(strFName+ " "+strLName);

    // open output file for writing
    outFile.open(strFileName.c_str());
    if ( outFile.fail())
    {
        cout<<" Output file error! Student was not added"<<endl;
        return -1;
    }

    //display the content of the vector
    for(int i=0; i<vecStudent.size(); i++)
        cout<< vecStudent[i]<<endl;

    for(int i=0; i<vecStudent.size();i++)
        outFile<<vecStudent[i]<<endl;
    outFile.close();
return 0;
}

int saveandquit()
{
    ifstream inFile;
    ofstream outFile;
    string strFileName;
    string strFName,strLName;
    vector<string> vecStudent;
    int i=0;
    char line[80];
    //     open output file for writing
    outFile.open(strFileName.c_str());
    if ( outFile.fail())
    {
        cout<<" Output file error!"<<endl;
        return -1;
    }

    //display the content of the vector
    for(int i=0; i<vecStudent.size(); i++)
        cout<< vecStudent[i]<<endl;

    for(int i=0; i<vecStudent.size();i++)
        outFile<<vecStudent[i]<<endl;
    outFile.close();
    cout << " file saved. enter -1 to quit";
    cin>> i;
    if( i=-1)

    return 0;
}

 int deletename()
{
    ifstream inFile;
    ofstream outFile;
    string strFileName;
    string strFName,strLName;
    vector<string> vecStudent;
    int namepos = 0;
    char line[80];

    inFile.open(strFileName.c_str());
    if (inFile.fail())
        cout <<"Input file error!"<<endl;

    //read the names from the file into the vector
    while (inFile >> strFName >> strLName)
        vecStudent.push_back(strFName+" "+strLName);
    inFile.close();

    cout <<"\nEnter the name to be deleted (First name and Last name): ";
    cin >>strFName >>strLName;

    int i=0, pos=-1;
    int size = vecStudent.size();
    bool found=false;
    // use a linear search to find the name in the vecotor of names

    while (i < size && !found)
    {
        if (vecStudent [i] == strFName+" "+strLName)
        {
            found = true;

    cout <<"\nthat name is in the "<<(pos + 1) <<" position in the list\n";
    cout <<"Please enter the position in list\n";
    cin>> pos;
    // use an iterator to delete name from vecStudent. vector.erase requires an iterator. used a while loop to find the name and make sure it was in the
    // vector of strings. then the loop displays the position in the vector that the string is. the program asks the user to enter the number position of the name
    // from there the user enters the name and the program uses a for loop to find the position and the built in vector.erase to remove the name from the list.
    for(int i=0; i ==pos; i++)
    {
        if(i == pos)
        {
            vecStudent.erase (vecStudent.begin());
        }
    }
    }
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:45:00.567

您实际上只是在***声明***函数而不是***调用***它们。

```
void displaynames(); 
```

**声明**一个函数。

```
displaynames(); 
```

**调用**一个函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T16:42:40.947

你调用的函数是错误的。它应该是

```
case '1':
//call function display names
   displaynames();
break;
case '2':
   addname();
//call a function add name
break;
case '3':
    deletename();
//call function delete names
break;
case '4':
   saveandquit(); 
```

要调用一个函数，你只需要函数名和函数参数（在这种情况下，似乎没有。你目前拥有它的方式是声明一个函数而不是调用一个函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T16:46:06.620

在您的代码块（开关）中，您没有调用任何函数，而只是声明它们。

```
...
case '1':
//call function display names
   void displaynames();
break;
... 
```

将（前向）声明 ( `void displaynames();`) 移动到源文件的顶层（因为您在使用它们之后定义函数），然后使用正常的函数应用程序语法 ( `displaynames();`) 调用它们。

从网上的[某个地方：](http://www.linuxquestions.org/questions/programming-9/declare-vs-define-669556/)

> “函数的声明也称为原型，它通知编译器您定义和使用它的意图。函数的定义是与原型相关联的主体（代码）。”

# linux - Linux：如何将目录大小输出为不包括目录路径的数字

> ID：10076489
> 
> 赞同：0
> 
> 时间：2012-04-09T16:40:39.533
> 
> 标签：linux

如何在 Linux 中输出目录大小？

我目前正在使用“du /root/test”，但得到以下结果：

第754章

我只需要输出如下数字：

754

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:44:50.520

```
du /root/test | awk '{print $1}' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:47:27.743

由于您的目录可能有子目录，因此使用 -s 作为摘要：

```
du -s /root/test |awk '{print $1}' 
```

# visual-c++ - 无法在 XP 上运行我的程序，因为它说无法加载 dll（由我编写），但在 Windows 7 上它运行

> ID：10076492
> 
> 赞同：0
> 
> 时间：2012-04-09T16:40:57.173
> 
> 标签：visual-c++, dll, .net-4.0

我已经看过一些关于我的问题的帖子，但没有解决方案......我的应用程序需要加载我编写的 dll，当我尝试在 Windows 7 上运行它时它会运行，但在 XP 上它会崩溃。所以我尝试在 XP 上安装 VS2010 并在那里编译，它编译正确，但是当我调试它时抛出 System.IO.FileNotFoundException，因为它“无法”加载我的 dll（无法加载文件或程序集 'Graphic.dll' )，所以好像找不到我的dll，怎么可能呢？

ps：dll（托管类库）和exe都是用c++写的，使用.net framework 4

> Fusion 日志 1：Assembly Binder 日志条目（09/04/2012 @ 11.52.42）
> 
> 手术成功。绑定结果：hr = 0x0。操作成功完成。
> 
> 程序集管理器从以下位置加载：C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\clr.dll 在可执行文件 C:\Documents and Settings\Administrator\My Documents\Visual Studio 2010\Projects\MyProgram\Debug\MyProgram 下运行。 exe 下面是详细的错误日志。
> 
> LOG：EXE 显式绑定。文件路径：C:\Documents and Settings\Administrator\My Documents\Visual Studio 2010\Projects\MyProgram\Debug\MyProgram.exe。
> 
> 融合日志 2：
> 
> 程序集活页夹日志条目 (09/04/2012 @ 11.52.42) 操作成功。绑定结果：hr = 0x0。操作成功完成。
> 
> 程序集管理器从以下位置加载：C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\clr.dll 在可执行文件 C:\Documents and Settings\Administrator\My Documents\Visual Studio 2010\Projects\MyProgram\Debug\MyProgram 下运行。 exe 下面是详细的错误日志。
> 
> 预绑定状态信息 LOG: User = CASH-F32CDFF50A\Administrator LOG: DisplayName = System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 (Fully-specified) LOG: Appbase = file:// /C:/Documents and Settings/Administrator/My Documents/Visual Studio 2010/Projects/MyProgram/Debug/ LOG: Initial PrivatePath = NULL LOG: Dynamic Base = NULL LOG: Cache Base = NULL LOG: AppName = MyProgram.exe 调用程序集：我的程序，版本=1.0.4482.18830，文化=中性，PublicKeyToken=null。
> 
> LOG：此绑定在默认加载上下文中开始。LOG：未找到应用程序配置文件。LOG：使用主机配置文件：LOG：使用来自 C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\config\machine.config 的机器配置文件。LOG：后策略参考：System.Windows.Forms，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089 LOG：重用之前加载的程序集实例 (C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\ System.Windows.Forms\v4.0_4.0.0.0__b77a5c561934e089\System.Windows.Forms.dll）。

# objective-c - 使用 NSUrlRequest 上传文件会导致零字节文件大小

> ID：10076493
> 
> 赞同：4
> 
> 时间：2012-04-09T16:41:01.247
> 
> 标签：objective-c, file-upload, http-post

我正在尝试使用目标 c 和 NSUrlRequest 进行简单的文件上传。

我当前的（或多或少用谷歌搜索并放在一起）代码：

```
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
[request setURL:[NSURL URLWithString:@"http://127.0.0.1:8000/api/upload/"]];
[request setHTTPMethod:@"POST"];

NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
[request addValue:contentType forHTTPHeaderField: @"Content-Type"];

NSMutableData *postData = [NSMutableData data]; 
[postData appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];

// Append the Usertoken
[postData appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"token\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[postData appendData:[[NSString stringWithString:@"Content-Type: application/json\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[postData appendData:[[NSString stringWithFormat:@"%@", token] dataUsingEncoding:NSUTF8StringEncoding]];

// Append the file
[postData appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];    
[postData appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"fileupload\"; filename=\"%@\"\r\n", file]dataUsingEncoding:NSUTF8StringEncoding]];
[postData appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];

// Close
[postData appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];

// Append
[request setHTTPBody:postData]; 
```

所有上传的文件都具有零字节文件大小。服务器端部分工作正常。用 cURL 测试。

我忘了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T07:33:26.233

发现我的错误。是一个非常简单的问题，因为我对 http 缺乏了解而发生的。

我忘了在八位字节流之后附加文件数据

```
NSData *photo = [[NSFileManager defaultManager] contentsAtPath:file];

// Append the file
[postData appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];    
[postData appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"fileupload\"; filename=\"%@\"\r\n", file]dataUsingEncoding:NSUTF8StringEncoding]];
[postData appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[postData appendData:[NSData dataWithData:photo]]; 
```

# php - 将下面的变量更改为什么？

> ID：10076494
> 
> 赞同：-2
> 
> 时间：2012-04-09T16:41:03.257
> 
> 标签：php

我有一个目标变量，当我上传文件时它会转到这个目标：

```
<?php
   // Edit upload location here
   $destination_path = getcwd().DIRECTORY_SEPARATOR;

   $result = 0;

   $target_path = $destination_path . basename( $_FILES['fileImage']['name']);

   if(@move_uploaded_file($_FILES['fileImage']['tmp_name'], $target_path)) {
      $result = 1;
   }

   sleep(1);
?> 
```

我想知道的是如何编辑上传目的地？假设我希望将文件上传到目的地以转到 portal.hud.ac.uk/Upload_App/Files/ 那么我该如何更改呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:45:08.113

只需更改`$destination_path`为您想要的任何内容。现在的方式（`getcwd().DIRECTORY_SEPARATOR`），它将保存到当前工作文件夹（除非更改，否则它是包含脚本的文件夹）。这是非常不安全的，因为我可以上传一个名为的文件`index.php`，任何访问您网站的人都会运行我选择插入的任何恶意代码。

将它保存在 webroot 之外更安全，因为它不能通过 HTTP 直接访问。例子：

```
$destination_path = $_SERVER['DOCUMENT_ROOT']."/../uploads/"; 
```

这将保存到`uploads`包含 Web 根目录（可能是`public_html`）的文件夹中找到的文件夹。

# wpf - 为什么 WPF 边框的“边框”在设计模式下可见，但在应用程序中不可见？

> ID：10076497
> 
> 赞同：3
> 
> 时间：2012-04-09T16:41:23.897
> 
> 标签：wpf

                ![在此处输入图像描述](../Images/cb0c5beafdd133811c8cb54ec3205844.png)

设计器在红色背景周围显示黑色边框，但实际应用中只显示红色背景。是什么赋予了？如何强制黑色边框可见？

这是此窗口的 XAML：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        MinWidth="400" MinHeight="300"
        TextOptions.TextFormattingMode="Display">
    <DockPanel Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
        <Button DockPanel.Dock="Top" Content="A button"
                Padding="8,2" Margin="8" />
        <Border DockPanel.Dock="Top" Height="10" BorderBrush="Black"
                SnapsToDevicePixels="True" Background="Red" />
        <Button DockPanel.Dock="Top" Content="A button"
                Padding="8,2" Margin="8" />
    </DockPanel>
</Window> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:45:49.590

我不确定为什么边框会在设计模式下显示，但您可以通过添加显式厚度使其显示在应用程序中

```
<Border DockPanel.Dock="Top" Height="10" BorderBrush="Black"
        SnapsToDevicePixels="True" Background="Red" BorderThickness="1" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T16:45:27.233

我的猜测是运行时边框的默认厚度为 0 - 可能是因为应用程序资源字典中的继承样式。从全局资源字典继承的默认样式通常不会在设计时出现。

尝试明确设置`BorderThickness="1"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-04T01:57:15.020

```
 <Border.BorderBrush>
            <SolidColorBrush Color="{DynamicResource Gray4}"/>
        </Border.BorderBrush> 
```

使用十六进制替换属性“颜色”的值：

```
 <Border.BorderBrush>
            <SolidColorBrush Color="#FFD33B3B"/>
        </Border.BorderBrush> 
```

# php - WSDL UNKNOWN 用于输入/输出

> ID：10076498
> 
> 赞同：0
> 
> 时间：2012-04-09T16:41:27.933
> 
> 标签：php, web-services, soap, wsdl

我最近开始开发 SOAP Web 服务，但遇到了一些我无法解决的问题。因此，我构建了一个 PHP 客户端来测试该服务。当我通过我的 php 脚本使用 soapclient 调用 __getFunctions 时，我收到以下信息

```
array(1) { [0]=> string(31) "UNKNOWN doOrder(UNKNOWN $order)" } 
```

为什么我的输入和输出数据类型未知？

WSDL：

```
<?xml version="1.0"?>
<definitions name="PlaceOrders"
         targetNamespace="urn:PlaceOrders"
         xmlns:tns="urn:PlaceOrders"
         xmlns:xsd="http://www.w3.org/2001/XMLSchema"
         xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
         xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/"
         xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
         xmlns="http://schemas.xmlsoap.org/wsdl/">
<types>
<xsd:schema xmlns="http://www.w3.org/2001/XMLSchema" targetNamespace="urn:Orders">
  <xsd:element name="orderXML" type="xsd:base64Binary" />
  <xsd:element name="orderResponse" type="xsd:string" />
</xsd:schema>
</types>

<message name="doOrder">
<part name="order" type="tns:orderXML" />
</message>

<message name="doOrderResponse">
<part name="return" type="tns:orderResponse" />
</message>

<portType name="OrderPort">
  <operation name="doOrder">
    <input message="tns:doOrder" />
    <output message="tns:doOrderResponse" />
  </operation>
</portType>

<binding name="OrderBinding" type="tns:OrderPort">
  <soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http" />
<operation name="doOrder">
  <soap:operation soapAction="urn:OrderAction" />
  <input>
    <soap:body use="encoded" namespace="urn:Orders" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" />
  </input>
  <output>
    <soap:body use="literal" namespace="urn:Orders" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" />
  </output>
</operation>
</binding>

<service name="OrderService">
<port name="OrderPort" binding="tns:OrderBinding">
  <soap:address location="[MYLINK]" />
</port>
</service>

</definitions> 
```

SOAP 客户端：

```
ini_set('display_errors',1);
ini_set('soap.wsdl_cache_enabled', 0);                                                                                                                                                                                     
$client = new SoapClient([MYLINK]);
var_dump($client->__getFunctions()); 
```

# c++ - GCC 模板错误

> ID：10076502
> 
> 赞同：0
> 
> 时间：2012-04-09T16:41:32.517
> 
> 标签：c++, templates, gcc

我正在尝试将 C++ 项目移植到 iOS。它在 Linux 和 Windows 以及 MSVC 上的 QtCreator 中编译得很好。现在在 Xcode/GCC 上，使用某个模板类我得到以下错误：“错误：模板参数列表太少”。

导致此错误的代码如下所示：

```
template <typename TA, typename TB, int Type>
class MyClassImpl
{
public:
   MyClassImpl();
   virtual int GetType() const
   {
       return type;
   }
};    

typedef MyClassImpl<float, int, 12> MyFloatIntClass;

MyFloatIntClass::MyFloatIntClass()
{
...
}

int MyFloatIntClass::GetType() const
{
   return 22;
} 
```

我猜想关于 typedef 语法的某些东西是非法的，而 GCC 对标准的要求更严格。谁能告诉我到底是什么问题以及如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T16:52:22.260

当您定义相应类的方法的完整特化时，您仍然需要在定义前加上`template <>`，这是您缺少的“模板参数列表”。此外，构造函数必须按类命名，因此`MyFloatIntClass::MyFloatIntClass()`是非法`MyFloatIntClass`的（因为只是别名，而不是类名）。以下对我来说编译得很好（g ++ 4.5.3）：

```
template <typename TA, typename TB, int Type>
class MyClassImpl
{
public:
   MyClassImpl();
   virtual int GetType() const
   {
       return Type;
   }
};    

typedef MyClassImpl<float, int, 12> MyFloatIntClass;

template <>
MyFloatIntClass::MyClassImpl()
{
}

template <>
int MyFloatIntClass::GetType() const
{
   return 22;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T16:47:24.980

这只是一个猜测，但是您需要添加模板<>吗？

既然是模板专业化，我相信还是需要模板的。

前任。

```
template<>
MyFloatIntClass::MyClassImpl() {}

template<>
int MyFloatIntClass::GetType() const {
    return 22;
} 
```

编辑：从modelnine的回答中发现它需要ctor的未定义名称。

EDIT2：以下代码对我来说很好：

```
template <typename TA, typename TB, int Type>
class MyClassImpl
{
public:
   MyClassImpl();
   MyClassImpl(const MyClassImpl<TA, TB, Type>&);
   virtual int GetType() const
   {
       return Type;
   }
   const MyClassImpl<TA, TB, Type>& operator=(const MyClassImpl<TA, TB, Type>&);
};    

typedef MyClassImpl<float, int, 12> MyFloatIntClass;

template<>
MyFloatIntClass::MyClassImpl()
{
 //
}

template<>
MyFloatIntClass::MyClassImpl( const MyFloatIntClass& rhs )
{
 //
}

template<>
const MyFloatIntClass& MyFloatIntClass::operator=( const MyFloatIntClass& rhs )
{
  return *this;
}

template<>
int MyFloatIntClass::GetType() const
{
   return 22;
} 
```

# sitecore - sitecore 中项目和文件夹的默认语言

> ID：10076505
> 
> 赞同：0
> 
> 时间：2012-04-09T16:41:51.777
> 
> 标签：sitecore, sitecore6, multilingual

我在一个多站点、多语言的站点核心项目中工作，不时有人在某些子站点上添加大量内容，与发布斗争数小时，无法看到更新的内容，最终实现几个小时后，所有输入都以错误的语言用于子站点。

所以我想知道sitecore是否有办法支持以下内容：

*   一个文件夹（用于子站点），支持在单击其下方的现有项目后，语言自动更改为站点文件夹的默认语言
*   由于语言会自动更改，因此在该文件夹下创建的新项目将以默认的子站点语言创建，除非用户明确将其更改为其他语言

如果上述方法不可能或不受支持，一个很好的解决方法是能够更改项目语言版本的语言（例如，我为西班牙语网站上的页面创建了一个英语版本，其中所有内容都是西班牙语，所以我想告诉 sitecore 我想让这个版本实际上是西班牙语版本，而不是在翻译 ui 中手动复制字段

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T09:48:05.273

另一种方法是为您的内容贡献者使用语言读取和语言写入安全设置。

如果您的西班牙语站点的贡献者应该只添加西班牙语项目，那么配置他们的访问设置，以便他们不能创建其他语言的内容。

如果您有很多以错误的语言输入的内容，那么您可以使用全球化 - 导出语言工具（从开始菜单）将其导出到 XML 文件，手动替换语言标签（这就像例如，在“en>”->“es-ES>”上进行搜索和替换），然后使用全球化 - 导入语言工具以新语言重新导入它。但警告：这将覆盖任何现有版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T18:47:12.660

听起来您可能需要考虑以下几点：

1.  [语言回退提供程序](http://trac.sitecore.net/LanguageFallback)- 如果它不存在，这允许您将内容从一种语言回退到另一种语言。
2.  Sitecore的自定义扩展（可能是`item:creating`或的事件处理程序`item:created`），用于根据编辑器创建项目的位置切换上下文语言。

只是现在的想法...

# string - 从字符串中删除转义符，或者，“我怎样才能让 \ 不碍事？”

> ID：10076507
> 
> 赞同：14
> 
> 时间：2012-04-09T16:42:08.957
> 
> 标签：string, r, escaping

转义字符在 R 中会引起很多麻烦，前面的问题证明了这一点：

1.  [更改列中的值](https://stackoverflow.com/questions/10046357/change-the-values-in-a-column/10046412#10046412)
2.  [R paste() 可以输出“\”吗？](https://stackoverflow.com/questions/4379681/can-r-paste-output)
3.  [用R中的双引号替换转义的双引号](https://stackoverflow.com/questions/4697247/replacing-escaped-double-quotes-by-double-quotes-in-r)
4.  [如何 gsub('%', '\%', ... 在 R 中？](https://stackoverflow.com/questions/5031999/how-to-gsub-in-r)

许多以前的问题可以简化为“我怎样才能摆脱我的方式？”的特殊情况。

有没有一种简单的方法可以做到这一点？

例如，我找不到任何参数`gsub`将删除以下所有转义：

```
 test <- c('\01', '\\001') 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-09T17:12:03.540

这里的困难在于`"\1"`，尽管它打印了两个字形，但在 R 看来，它实际上是一个字符。事实上，它`"\001"`和 and是同一个字符`"\01"`：

```
nchar("\1")
# [1] 1
nchar("\001")
# [1] 1
identical("\1", "\001")
# [1] TRUE 
```

因此，您通常*可以*使用以下方式删除所有反斜杠：

```
(test <- c("\\hi\\", "\n", "\t", "\\1", "\1", "\01", "\001"))
# [1] "\\hi\\" "\n"     "\t"      "\\1"    "\001"   "\001"   "\001"  
eval(parse(text=gsub("\\", "", deparse(test), fixed=TRUE)))
# [1] "hi"  "n"   "t"   "1"   "001" "001" "001" 
```

但是，如您所见，`"\1"`,`"\01"`和`\001"`都将呈现为`001`, （因为对于 R 它们都是 的不同名称`"\001"`）。

* * *

**编辑**：有关`"\"`在转义序列中使用的更多信息，以及可以使用它们表示的各种字符（包括 Joshua Ulrich 在上面的评论中提到的不允许的 nul 字符串），请参阅R 语言定义的[这一部分](http://cran.r-project.org/doc/manuals/R-lang.html#Literal-constants)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-22T21:06:26.180

我刚刚遇到了同样的问题 - 如果你想要任何 x 是字符的 \x ，那么我不知道如何，我希望我知道，但要针对特定​​的转义序列修复它。说 \n 然后你可以做

```
new = gsub("\n","",old,fixed=T) 
```

就我而言，我只有 \n

# twitter - 在网站上显示 Twitter 关注者数量？

> ID：10076521
> 
> 赞同：2
> 
> 时间：2012-04-09T16:42:59.900
> 
> 标签：twitter

我知道你可以使用 API (https://dev.twitter.com/docs/api/1/get/users/show)，但我怎样才能让它出现在我的网站上？例如，“用户名”具有“关注者数量”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:55:40.760

干得好：

```
<?php

$url = "http://api.twitter.com/1/users/show.json?screen_name=jjmpsp&include_entities=true";

$feed = file_get_contents($url);

$twitter_decoded = json_decode($feed);

echo $twitter_decoded->followers_count;

?> 
```

# java - Java 小程序项目“java.security.AccessControlException：访问被拒绝”错误

> ID：10076522
> 
> 赞同：1
> 
> 时间：2012-04-09T16:43:00.117
> 
> 标签：java, applet

这是我的第一个小程序项目，由于某种原因，当我尝试运行小程序时出现此错误。

```
Warning: Can't read AppletViewer properties file: 
    C:\Users\students\.hotjava\properties Using defaults.
java.security.AccessControlException: access denied (
    "java.lang.RuntimePermission" "exitVM.0") 
```

但除此之外，代码工作得很好。我不确定是什么导致了这个错误。我在这项任务中迟到了 2 天，需要有人帮助我。几个小时以来，我一直把头撞在桌子上。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.util.Random;
import javax.swing.JApplet;

/** rock paper scissors class */
public class JRockPaperScissors extends JApplet{
    // Variables declaration
    private JLabel titleLbl;
private JLabel selectionLbl;
private JLabel resultsLbl;
private JTextArea resultTextArea;
private JButton rockBn;
private JButton paperBn;
private JButton scissorBn;
private Container contentPane;
    private int cpu = 0;
    private int wins = 0;
    private int loses = 0;
    private int ties = 0;
    private final int CHOICE_MAX = 3;
    private final int ROCK = 0;
    private final int PAPER = 1;
    private final int SCISSORS = 2;
    private Random rand = new Random();
// End of variables declaration

public JRockPaperScissors(){
    initializeComponent();
}

    /** initializing componets */
private void initializeComponent()
{
    titleLbl = new JLabel();
    selectionLbl = new JLabel();
    resultsLbl = new JLabel();
    resultTextArea = new JTextArea();
    rockBn = new JButton();
    paperBn = new JButton();
    scissorBn = new JButton();
    contentPane = getContentPane();

    //
    // titleLbl
    //
    titleLbl.setText("Rock, Paper, Scissors");
            titleLbl.setFont(new Font("Garrmond", Font.BOLD, 30));
    //
    // selectionLbl
    //
    selectionLbl.setText("Choose one");
            selectionLbl.setFont(new Font("Arial",Font.BOLD,14));
    //
    // resultsLbl
    //
    resultsLbl.setText("*****Results*****");
            selectionLbl.setFont(new Font("Arial",Font.BOLD,14));
    //
    // resultTextArea
    //
    resultTextArea.setOpaque(false);
    resultTextArea.setBackground(new Color(236, 233, 216));

    //
    // rockBn
    //
    rockBn.setText("Rock");
    rockBn.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e)
        {
            rockBn_actionPerformed(e);
        }

    });
    //
    // paperBn
    //
    paperBn.setText("Paper");
    paperBn.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e)
        {
            paperBn_actionPerformed(e);
        }

    });
    //
    // scissorBn
    //
    scissorBn.setText("Scissors");               
    scissorBn.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e)
        {
            scissorBn_actionPerformed(e);
        }

    });
    //
    // contentPane
    //
    contentPane.setLayout(null);
    addComponent(contentPane, titleLbl, 5,9,370,47);
    addComponent(contentPane, selectionLbl, 9,54,150,35);
    addComponent(contentPane, resultsLbl, 9,93,144,38);
    addComponent(contentPane, resultTextArea, 5,132,398,111);
    addComponent(contentPane, rockBn, 162,58,78,31);
    addComponent(contentPane, paperBn, 247,58,81,31);
    addComponent(contentPane, scissorBn, 334,58,87,31);
    contentPane.setSize(new Dimension(435, 290));
    //
    // JRockPaperScissors
    //      
    setTitle("Paper Rock Scissors");
    setSize(435, 290);
    setVisible(true);
}

/** Add Component Without a Layout Manager (Absolute Positioning) */
private void addComponent(Container container,Component c,int x,int y,int width,int height)
{
    c.setBounds(x,y,width,height);
    container.add(c);
}

/** action event methods */
private void rockBn_actionPerformed(ActionEvent e)
{
        //play the game choosing rock
        play(ROCK);
}

private void paperBn_actionPerformed(ActionEvent e)
{
        //play the game choosing paper
        play(PAPER);
}

private void scissorBn_actionPerformed(ActionEvent e)
{
        //play the game choosing scissors
        play(SCISSORS);
}
    //method to play the game
    private void play(int pick){
         String resultStr = "";                   
         //random computer choice
         cpu = rand.nextInt(CHOICE_MAX);
         //nested if statments to determine winner loser or tie
         if(pick == cpu){
             ties++;
             resultStr = "You picked " + selection(pick) + " ---- Computer picked " + selection(cpu);
             resultStr += "\nWinner: Tie";
             resultStr += "\nYou: " + Integer.toString(wins) + "  " + "Computer: " + Integer.toString(loses) + " Ties: " + Integer.toString(ties);
             resultTextArea.setText(resultStr);
         }
         else if( (pick == ROCK) && (cpu == SCISSORS) ){
             wins++;
             resultStr = "You picked " + selection(pick) + " ---- Computer picked " + selection(cpu);
             resultStr += "\nWinner: You";
             resultStr += "\nYou: " + Integer.toString(wins) + "  " + "Computer: " + Integer.toString(loses) + " Ties: " + Integer.toString(ties);
             resultTextArea.setText(resultStr);
         }
         else if( (pick == PAPER) && (cpu == ROCK) ){
             wins++;
             resultStr = "You picked " + selection(pick) + " ---- Computer picked " + selection(cpu);
             resultStr += "\nWinner: You";
             resultStr += "\nYou: " + Integer.toString(wins) + "  " + "Computer: " + Integer.toString(loses) + " Ties: " + Integer.toString(ties);
             resultTextArea.setText(resultStr);                 
         }
         else if( (pick == SCISSORS) && (cpu == PAPER) ){
             wins++;
             resultStr = "You picked " + selection(pick) + " ---- Computer picked " + selection(cpu);
             resultStr += "\nWinner: You";
             resultStr += "\nYou: " + Integer.toString(wins) + "  " + "Computer: " + Integer.toString(loses) + " Ties: " + Integer.toString(ties);
             resultTextArea.setText(resultStr);
         }
         else{
             loses++;
             resultStr = "You picked " + selection(pick) + " ---- Computer picked " + selection(cpu);
             resultStr += "\nWinner: Computer";
             resultStr += "\nYou: " + Integer.toString(wins) + "  " + "Computer: " + Integer.toString(loses) + " Ties: " + Integer.toString(ties);
             resultTextArea.setText(resultStr);                 
         }

    }
        //function returns paper rock or scissors as a string
         public String selection(int choice){
             String tempStr;
             switch(choice){
               case 0:
                     tempStr = "rock";
                     break;
               case 1:
                     tempStr = "paper";
                     break;
               case 2:
                     tempStr = "scissors";
                     break;
               default:
                     tempStr = "invalid";
              }
              return tempStr;
         }

} 
```

代码

```
<html>
<head><title>Rock Paper Scissors</title></head>
<body bgcolor="black">
<font color="yellow"><center><h1>Welcome!! Ready to play?</h1></center>
<p><b><object code = “JRockPaperScissors.class” width = “435” height = “290”&gt;</object>
</font>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:53:45.137

为安全起见，小程序访问本地磁盘的优先级有限。

要获得访问权限，您应该在发布（或在本地运行）之前签署您的小程序。无法描述细节，请参阅[本教程](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/signed.html)了解如何操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:05:15.757

实际上，1997 年发布的 JDK 1.1 需要签署小程序。我强烈不建议深入研究小程序签名，这是一大堆蠕虫。当前的 JVM 具有基于权限的安全策略。如果这是一个快速破解，我建议您在 JAVA_HOME/jre/lib/secirity/java.policy 文件中添加一行代码：

```
permission java.lang.RuntimePermission "exitVM"; 
```

确保将其添加到***默认域***。这是我的整个文件的示例，配置了退出 JVM 的权限：

```
grant codeBase "file:/home/igor/programs/jdk1.6.0_24/jre/lib/ext/*" {
  permission java.security.AllPermission;
};

grant codeBase "file:/usr/java/packages/lib/ext/*" {
  permission java.security.AllPermission;
};

grant {
  permission java.lang.RuntimePermission "stopThread";
  permission java.net.SocketPermission "localhost:1024-", "listen";
  permission java.util.PropertyPermission "java.version", "read";
  permission java.util.PropertyPermission "java.vendor", "read";
  permission java.util.PropertyPermission "java.vendor.url", "read";
  permission java.util.PropertyPermission "java.class.version", "read";
  permission java.util.PropertyPermission "os.name", "read";
  permission java.util.PropertyPermission "os.version", "read";
  permission java.util.PropertyPermission "os.arch", "read";
  permission java.util.PropertyPermission "file.separator", "read";
  permission java.util.PropertyPermission "path.separator", "read";
  permission java.util.PropertyPermission "line.separator", "read";
  permission java.util.PropertyPermission "java.specification.version", "read";
  permission java.util.PropertyPermission "java.specification.vendor", "read";
  permission java.util.PropertyPermission "java.specification.name", "read";
  permission java.util.PropertyPermission "java.vm.specification.version", "read";
  permission java.util.PropertyPermission "java.vm.specification.vendor", "read";
  permission java.util.PropertyPermission "java.vm.specification.name", "read";
  permission java.util.PropertyPermission "java.vm.version", "read";
  permission java.util.PropertyPermission "java.vm.vendor", "read";
  permission java.util.PropertyPermission "java.vm.name", "read";
  permission java.lang.RuntimePermission "exitVM";
}; 
```

如果需要，可以通过添加以下行来添加所有权限：

```
permission java.security.AllPermission; 
```

在这种情况下，您的小程序将作为 Java 应用程序运行，没有任何限制

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T17:30:00.427

对我来说，这似乎是一个损坏的小程序查看器安装。该代码在此处的小程序查看器中运行而没有错误（在我注释了未编译的行之后，这意味着源**不是**您正在使用的）。当您在支持 Java 的浏览器中尝试它时会发生什么？

## HTML

我认为 HTML 与问题无关，但既然你提到了它：

```
<object code = “JRockPaperScissors.class” width = “435” height = “290”&gt;</object> 
```

在测试期间我有 3 条建议。

1.  换成`object`_`applet`
2.  删除`.class`code 属性的扩展名 - 它是完全限定的类名，而不是文件名。虽然通常可以容忍第二个，但第一个是正确的。
3.  将“智能引号”更改为标准 " 样式引号。看起来 HTML 是在文字处理器中准备的。或者更好的是，完全删除引号。

### 例如

```
 <applet code=JRockPaperScissors width=435 height=290></applet> 
```

# regex - 正则表达式搜索 - 查找 typedef 值的原始类/结构名称

> ID：10076525
> 
> 赞同：0
> 
> 时间：2012-04-09T16:43:12.103
> 
> 标签：regex

我创建了一个 hpp 文件，我需要转发声明类，因为我不能假设它们当时被包含在内。

我有一个 typedef 的类，我想在文件中查找以找到这是 typedef 的行，以便我可以获得原始类或结构名称。

我怎样才能做到这一点？我要搜索： typedef "AnythingInBetween" 名称

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:52:35.297

试试下面的。

```
^\s*typedef\s+[a-z:<>.]+\s+thename 
```

这将适用于它是与“名称”匹配的单个名称的 typedef 并且所有内容都发生在单行上的情况。这并不完全对应于 typedefs 的 C++ 语法（一个正则表达式根本不可能），但会捕获 90% 的情况

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:51:10.030

你需要什么风格的正则表达式？我猜这就是你需要的？

```
typedef\s"(.*?)"\sname 
```

`\s"(.*?)"\s`表示匹配一个空格字符后跟一个双引号，然后匹配任何内容，直到下一个双引号后跟一个空格

# java - 将对象持久化到应用引擎时出现“没有为此线程注册 API 环境”错误

> ID：10076527
> 
> 赞同：2
> 
> 时间：2012-04-09T16:43:15.873
> 
> 标签：java, google-app-engine, gwt, objectify

我在使用 Objectify 进行对象持久性的 GWT-App 引擎项目中持久化对象时遇到了一些问题。但是我收到此错误：

> 原因：java.lang.NullPointerException：没有为此线程注册 API 环境。

根据堆栈跟踪，错误源自 Objectify 的`put`方法。我检查了要持久化的应用程序的对象不是 NULL。

什么可能导致此错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T00:03:13.757

您需要为要保留的每个实体类调用[ObjectifyFactory.register(Class clazz)](http://code.google.com/p/objectify-appengine/source/browse/trunk/src/com/googlecode/objectify/ObjectifyFactory.java)。这应该执行一次（每个 JVM 实例）。

# c# - 循环通过中继器控件中的嵌套集合

> ID：10076529
> 
> 赞同：1
> 
> 时间：2012-04-09T16:43:24.020
> 
> 标签：c#, asp.net, webforms

我有一个列表对象

```
List<Documents> 
```

，在其中我有另一个帐户列表。

```
List<Accounts> 
```

从我的代码隐藏中，我将 List 连接到中继器控件

```
rptDocumentListings.DataSource = List<Documents>;
rptDocumentListings.DataBind(); 
```

虽然中继器循环遍历 List 中的每个项目，但我希望它也循环遍历每个嵌套的帐户列表，然后使用
标签呈现。这是我迄今为止尝试过的：

```
//in the dataRepeater
<%# parseAccountNumbers(Eval("Accounts"))%>

//method in codebehind
public string parseAccountNumbers(List<Account> accounts)
    {
        string allAccounts = string.Empty;

        foreach (var item in accounts)
        {
            allAccounts += string.Format("{0}<br />", item.AccountNumber);
        }

        return allAccounts;
    } 
```

我得到的错误是'无法从'对象'转换为'System.Collections.List'有人可以指出我正确的方向吗？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T16:45:48.320

改变

```
<%# parseAccountNumbers(Eval("Accounts"))%> 
```

至

```
<%# parseAccountNumbers((List<Account>)Eval("Accounts"))%> 
```

[DataBinder.Eval](http://msdn.microsoft.com/en-us/library/4hx47hfe.aspx)返回一个`Object`并且您的方法需要一个`List<Account>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:50:27.667

另一个想法：而不是`parseAccountNumbers(...)`在类中创建公共属性（如果可能），`Documents`例如：

```
public string AccountNumbers
{
    return Accounts.Aggregate("", (current, account) => current + (account.AccountNumber + "<br/>"));       
} 
```

并将其用作数据字段，例如：

```
<asp:Boundfield DataField="AccountNumbers" HeaderText="Account#" /> 
```

# java - 使用 min-heap 实现 Dijkstra 算法但失败

> ID：10076532
> 
> 赞同：6
> 
> 时间：2012-04-09T16:43:30.960
> 
> 标签：java, algorithm, graph, shortest-path, dijkstra

我正在尝试`Dijkstra's Algorithm`在 java 中使用 min-heap 来实现，但每次都得到错误的输出。[在这里](https://stackoverflow.com/a/2657086/1175065)，我在 C++ 中找到了相同的主题。下面是我的图表。绿色的节点 A 是源，红色的节点 F 是目标。我的目标是找出从 A 到 F 的最短路径长度。

![这是我的图表](../Images/4da6eca3f05e2a3714d72b2e35d13307.png)

下面是我的代码

```
public class Dijkstra {
    private static Heap heap = new Heap();
    private static int[][] graph;

    public Dijkstra() {
        graph = new int[6][6];
        /*
         * The graph value assignment is just for checking the code. node A is
         * referred as node 0, node B is referred as node 1 and so on. finally
         * node F is referred as node 5.
         */
        graph[0][0] = graph[0][1] = graph[0][3] = graph[0][4] = graph[0][5] = graph[1][0] = graph[1][1] = graph[1][4] = graph[1][5] = graph[2][2] = graph[2][5] = graph[3][0] = graph[3][3] = graph[4][0] = graph[4][1] = graph[4][4] = graph[5][0] = graph[5][1] = graph[5][2] = graph[5][5] = 0;
        graph[1][2] = graph[2][1] = graph[2][3] = graph[3][2] = graph[3][4] = graph[4][3] = graph[4][5] = graph[5][4] = 1;
        graph[1][3] = graph[3][1] = 3;
        graph[0][2] = graph[2][0] = 4;
        graph[2][4] = graph[4][2] = 5;
        graph[3][5] = graph[5][3] = 8;
    }

    public static void main(String[] args) {
        Dijkstra dij = new Dijkstra();
        // Source is node A (node 0) and destination is node F (node 5)
        System.out.println(dij.solve(6, 0, 5));
    }

    public int solve(int numOfNodes, int source, int dest) {
        heap.push(source, 0);
        while (!heap.isEmpty()) {
            int u = heap.pop();
            if (u == dest)
                return heap.cost[dest];
            for (int i = 0; i < numOfNodes; i++) {
                if (graph[u][i] >= 0)
                    heap.push(i, heap.cost[u] + graph[u][i]);
            }
        }
        return -1;
    }
}

class Heap {
    private int[] data;
    private int[] index;
    public int[] cost;
    private int size;

    public Heap() {
        data = new int[6];
        index = new int[6];
        cost = new int[6];

        for (int i = 0; i < 6; i++) {
            index[i] = -1;
            cost[i] = -1;
        }

        size = 0;
    }

    public boolean isEmpty() {
        return (size == 0);
    }

    private void shiftUp(int i) {
        int j;
        while (i > 0) {
            j = (i - 1) / 2;
            if (cost[data[i]] < cost[data[j]]) {
                // swap here
                int temp = index[data[i]];
                index[data[i]] = index[data[j]];
                index[data[j]] = temp;
                // swap here
                temp = data[i];
                data[i] = data[j];
                data[j] = temp;
                i = j;
            } else
                break;
        }
    }

    private void shiftDown(int i) {
        int j, k;
        while (2 * i + 1 < size) {
            j = 2 * i + 1;
            k = j + 1;
            if (k < size && cost[data[k]] < cost[data[j]]
                    && cost[data[k]] < cost[data[i]]) {
                // swap here
                int temp = index[data[k]];
                index[data[k]] = index[data[i]];
                index[data[i]] = temp;
                // swap here
                temp = data[k];
                data[k] = data[i];
                data[i] = temp;

                i = k;
            } else if (cost[data[j]] < cost[data[i]]) {
                // swap here
                int temp = index[data[j]];
                index[data[j]] = index[data[i]];
                index[data[i]] = temp;
                // swap here
                temp = data[j];
                data[j] = data[i];
                data[i] = temp;

                i = j;
            } else
                break;
        }
    }

    public int pop() {
        int res = data[0];
        data[0] = data[size - 1];
        index[data[0]] = 0;
        size--;
        shiftDown(0);
        return res;
    }

    public void push(int x, int c) {
        if (index[x] == -1) {
            cost[x] = c;
            data[size] = x;
            index[x] = size;
            size++;
            shiftUp(index[x]);
        } else {
            if (c < cost[x]) {
                cost[x] = c;
                shiftUp(index[x]);
                shiftDown(index[x]);
            }
        }
    }
} 
```

在运行整个代码时，我得到 0 作为输出，但可以清楚地知道从节点 A 到节点 F 的成本是 7 (4+1+1+1 = ACDEF)。错误在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T16:50:52.360

您使用 测试现有边缘`graph[u][i] >= 0`。但是您的图表被定义为没有零值的边缘。所以你应该把它改成

```
if (graph[u][i] > 0) ... 
```

里面的方法`solve`。另一种可能性是用`-1`矩阵中的值标记不存在的边。这也将允许零成本边缘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-27T12:05:22.413

在堆中，您有两个值：标识节点的索引和标识节点距离的成本。您弹出成本，即距离，但您像索引一样使用它来识别节点。

```
public int pop() {
        int res = data[0];
        ...
        return res;
    } 
```

在求解（）中：

```
 int u = heap.pop();
  if (u == dest)
  ... 
```

# spring - 如何使用 ac:set 赋值变量

> ID：10076535
> 
> 赞同：0
> 
> 时间：2012-04-09T16:43:46.130
> 
> 标签：spring, java-ee-6

在我的 .jsp 文件中，我有以下代码。如何将`environment`变量与字符串进行比较？Netbeans 不喜欢这个……我试过添加`scope="request"`，但`c:set`没有运气。

```
<c:set var="environment" value="<%=(request.getRequestURL().indexOf("localhost") > 0) ? "dev" : "uat"%>"/>
<% if (environment.equals("live")) { %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:06:39.933

有什么特别的原因您不会完全在 scriptlet 中执行此操作吗？如果它是在 scriptlet 中定义的，您仍然可以在 JSTL 中访问该变量

```
<% String environment = (request.getRequestURL().indexOf("localhost") > 0) ? "dev" : "uat"; %>
<% if (environment.equals("live")) { %>
<c:out value="${environment}"/> 
```

看看这里： http: [//melandri.net/2009/09/16/scriptlet-and-jstl-variable-sharing/](http://melandri.net/2009/09/16/scriptlet-and-jstl-variable-sharing/)

您也可以完全在 JSTL 中执行以下操作：

```
<c:set var="environment" value="${(fn:indexOf(request.requestURL, 'localhost') gt 0) ? 'dev' : 'uat'}"/> 
```

# swing - 从 Tomcat 运行 Swing 应用程序；无法使用 DISPLAY=:0:0 连接到 X11

> ID：10076539
> 
> 赞同：1
> 
> 时间：2012-04-09T16:44:00.520
> 
> 标签：swing, tomcat

我有一个想要在 Tomcat 6 JVM 中运行的小型 Swing 监控应用程序。该应用程序通过从运行在 Tomcat 下的 Web 服务动态加载监控类来启动。这适用于 Windows，但在 Linux（Ubuntu 10.4）上我遇到了一些错误。

我的第一个错误是我得到了 HeadlessException。我没有明确使用无头模式，在四处搜索后我更改了 Tomcat 的库路径（通过 catalina.sh 中的 -Djava.library.path）指向客户端库（即.../java-6-sun-1.6 .0.26/jre/lib/i386/client) 而不是服务器库。我还在 catalina.sh 中设置了 DISPLAY=:0:0。这摆脱了无头异常，但现在我得到：

```
java.lang.InternalError: Can't connect to X11 window server using ':0:0' as the value of the DISPLAY variable.
sun.awt.X11GraphicsEnvironment.initDisplay(Native Method)
sun.awt.X11GraphicsEnvironment.access$100(X11GraphicsEnvironment.java:52)
sun.awt.X11GraphicsEnvironment$1.run(X11GraphicsEnvironment.java:155)
java.security.AccessController.doPrivileged(Native Method)
sun.awt.X11GraphicsEnvironment.<clinit>(X11GraphicsEnvironment.java:131)
java.lang.Class.forName0(Native Method)
java.lang.Class.forName(Class.java:169)
java.awt.GraphicsEnvironment.getLocalGraphicsEnvironment(GraphicsEnvironment.java:68)
java.awt.Window.init(Window.java:380)
java.awt.Window.<init>(Window.java:433)
java.awt.Frame.<init>(Frame.java:403)
java.awt.Frame.<init>(Frame.java:368)
javax.swing.JFrame.<init>(JFrame.java:158)
com.quinsoft.zeidon.objectbrowser.ObjectBrowser.startup(ObjectBrowser.java:60) 
```

在这一点上，我被困住了。我尝试了很多不同的事情（比如明确设置“headless = false”并为 DISPLAY 使用不同的值）并且没有任何变化。有人有什么想法吗？

版本信息：

*   雄猫 6.0.28
*   Java 1.6
*   Ubuntu 10.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T06:41:33.883

如果您还没有尝试过，请尝试设置“-Djava.awt.headless=true”。

# mysql - 如何在特定日期和时间触发 Mysql 触发器

> ID：10076541
> 
> 赞同：0
> 
> 时间：2012-04-09T16:44:07.337
> 
> 标签：mysql, date, stored-procedures, triggers

我必须在每个月底调用一个存储过程，我只需要知道如何在特定日期和时间触发触发器来调用我的存储过程。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:47:29.007

MySQL 无法做到这一点。相反，您应该使用[cronjob](http://www.adminschoice.com/crontab-quick-reference)。如果您使用的是 Linux 系统，则可以创建一个脚本或程序来运行您的存储过程并使用该`crontab`命令安排它的执行。

在命令行中，编写`crontab -e`将允许您编辑您的 cronjobs。在这里，您可以添加

```
0 5 L * ? * /path/to/script.pl 
```

这将`/path/to/script.pl`在每个月的最后一天凌晨 5 点运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:47:35.903

MySQL 触发器是对查询事件的响应——时钟滴答声不是其中之一。如果您需要在特定日期/时间执行某些操作，请使用外部作业调度程序（例如 cron）来触发该作业。

如[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)中所述：

```
MySQL triggers are activated by SQL statements only. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-03T15:13:15.027

您可以做的是创建一个事件。

```
CREATE EVENT event_name
    ON SCHEDULE
      period_of_time
    DO
      your_code_here 
```

# android - Eclipse Logcat 过滤器加号不可见

> ID：10076543
> 
> 赞同：6
> 
> 时间：2012-04-09T16:44:18.813
> 
> 标签：android, eclipse, logcat

我在 Android 上使用 eclipse 已经有一段时间了，突然之间，我看不到按标签过滤日志的过滤器（加“+”号）。我看到了所有按钮，但仍然无法恢复 + 号。你们有没有人遇到过同样的问题。请让我知道修复。谢谢你。呸..！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-02T07:44:59.510

在 Logcat 的右侧，单击名为**Display Saved Filters View**的图标（靠近 Scroll Lock 图标）。

# sencha-touch-2 - Sencha touch 2/ 带有导航视图的应用工作流程

> ID：10076548
> 
> 赞同：1
> 
> 时间：2012-04-09T16:44:36.627
> 
> 标签：sencha-touch-2

sencha touch 2 有问题。

我试图了解如何实现在 sencha touch 2 中提供导航视图的相同功能，但是....“Ext.NavigationView”组件的每个项目都应该有自己独特的“navigationBar”元素集。例如，我的意思是一组按钮。

我知道我可以做这样的事情：

```
this.getMain().getNavigationBar().rightBox.removeAll();
this.getMain().getNavigationBar().rightBox.add(this.getSettingButton());
        //where 'getSettingButton' predefined by me a button 
```

并在每次“推送”事件发生时执行此操作（清除“导航栏”并添加适当的按钮集）

当然，我什至可以在“items”属性中使用“layout:card”和“Ext.panel”元素集来实现“Ext.Panel”，每个元素都有唯一的“工具栏”。要控制行为，我可以使用“setActiveItem”方法。

但是，我认为这些方法中的每一个都有点奇怪，不是吗？

我预计这将是实现它的更自然的方法。

很可能我不知道我需要什么。证实我的怀疑。最好的方法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T05:23:12.777

目前，**Ext.NavigationView**倾向于在“简单”视图之间执行导航。这里的“简单”意味着您的视图只是带有 innerHTML 的面板，而不是带有功能按钮、工具栏等的“复杂”视图。

据我所知，有两种方法可以尝试：

1.  如果您仍想使用 Ext.NavigationView，您可以通过**navigationBar**配置、getter 和 setter 将带有标题、项目（按钮、间隔符等）的 NavigationBar 自定义为普通组件。

2.  （推荐）如果您的视图彼此**完全不同**，您应该使用多个 Ext.Container 和您选择的不同项目（例如，第一个容器带有简单的 HTML 公告，第二个带有一些额外的 Ext.Button，等等） . 简单`animateActiveItem()`用于动画导航。我想这种方式要灵活得多。

# jquery-validate - jQuery 验证表单 - onsubmit 触发 fancybox 窗口

> ID：10076549
> 
> 赞同：0
> 
> 时间：2012-04-09T16:44:39.677
> 
> 标签：jquery-validate, fancybox, onsubmit

Onsubmit 我想触发 fancybox 弹出窗口

一旦表单被验证（使用JQUERY验证），我只需要显示fancybox弹出窗口

似乎只有在表格填写不正确时才会弹出fancybox弹出窗口！

[http://gloss-hair.com/old/owl/OWLFORM.html](http://gloss-hair.com/old/owl/OWLFORM.html)

我不确定如何仅在验证表单后才加载 popup fancybox 函数：

```
 <script type="text/javascript">
$().ready(function() {
    // validate the competition form when it is submitted
    $("#ie9_competition").validate({
        errorPlacement: function (error, element) {   
            if ( element.is(":checkbox") ) {
                error.appendTo( element.closest('div') );
               }
            else { 
                error.insertAfter(element.parent().find("label"));           
                 }
            },
        rules: {            
            sEmail: {
                required: true,
                email: true
            },

        }
    });         
}); 
```

```
<script type="text/javascript">
    $(document).ready(function() {
        $(".fancybox4").fancybox({
            'hideOnContentClick': true
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T16:55:44.597

jQuery Validation 插件让你定义 submitHandler 如果表单有效则执行：

```
submitHandler: function(form){
  form.submit(); // submit the form
  // code to show your fancybox here
} 
```

您的 validate() 代码将如下所示：

```
$("#ie9_competition").validate({
 errorPlacement: function (error, element) {   
  if ( element.is(":checkbox") ) {
   error.appendTo( element.closest('div') );
  } else { 
   error.insertAfter(element.parent().find("label"));           
  }
 },
 rules: {            
  sEmail: {
   required: true,
   email: true
  }
 },
 submitHandler: function(form){
  form.submit(); // submit the form
  // code to show your fancybox here
 }
}); 
```

您可以在此处查看 validate() 方法的所有可用选项：http: [//docs.jquery.com/Plugins/Validation/validate#toptions](http://docs.jquery.com/Plugins/Validation/validate#toptions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T03:25:16.143

像这样试试

```
$().ready(function() {
        // validate the competition form when it is submitted
        $("#ie9_competition").validate({
            errorPlacement: function (error, element) {   
                if ( element.is(":checkbox") ) {
                    error.appendTo( element.closest('div') );
                   }
                else { 
                    error.insertAfter(element.parent().find("label"));           
                     }
                },
            rules: {            
                sEmail: {
                    required: true,
                    email: true
                },

            },          
            submitHandler: function(form){

                jQuery('.fancybox4').trigger('click');

            }
        });         
    }); 
```

然后`onsubmit`从表单标签中删除事件。所以你的表单标签就像

```
<form id="ie9_competition" method="post"> 
```

# java - 可以通过禁止 import 语句和 java.* 字符串来阻止对标准 java 库的访问吗？

> ID：10076551
> 
> 赞同：2
> 
> 时间：2012-04-09T16:44:56.080
> 
> 标签：java, code-analysis, static-code-analysis

假设我想允许人们在我的服务器上运行简单的控制台 java 程序，而无法访问文件系统、网络或其他 IO，除非通过我自己的高度受限的 API。但是，我不想深入了解操作系统级别的限制，因此为了当前的讨论，我想考虑代码级别的清理方法。

因此，假设我尝试按如下方式实现此限制。我将禁止所有“import”语句，除了那些明确列入白名单的语句（假设“import SanitizedSystemIO. *”是允许的，而“import java.io.* ”是不允许的），我将禁止在代码中的任何地方使用字符串“java.*”。因此，这样用户将能够编写引用来自 SanitizedSystemIO 的 File 类的代码，但他将无法引用 java.io.File。这样，用户被迫使用我的净化包装 api，而我自己的框架代码（它将与用户的代码一起编译和运行，例如为了提供 IO 功能）可以访问所有常规的 java api。

这种方法会奏效吗？或者有没有办法破解它来访问标准的java api？

ETA：好的，首先，它当然应该是 java.* 字符串而不是 system.*。我认为在 C# 中，基本上......

其次，好的，人们说，“使用安全管理器”或“使用类加载器”方法。但是，如果有的话，代码分析方法有什么问题？在我看来，它的一个好处是纯粹的 KISS 简单性——而不是找出所有要在 SecurityManager 中检查和清理的东西，我们只允许一个小的功能白名单并阻止其他所有内容。在实现方面，这对于对 java 知识很少的人来说是一个微不足道的练习。

并重申我最初的问题，那么这可以被黑客入侵吗？尽管有这样的代码限制，是否有一些 Java 语言结构允许访问底层 api？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T16:50:59.023

在你的鞋子里，我宁愿在 custom 中运行加载的应用程序`ClassLoader`。

也许我弄错了，但是如果他想通过自己的功能允许对 IO 的有限访问，难道也不会`SecurityManager`阻止这些吗？有了一个习惯`ClassLoader`，他可以提供他的`SanitizedSystemIO`同时拒绝加载他不希望人们加载的东西。

但是，检查代码中的字符串绝对*不是*要走的路。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T16:48:08.567

您需要检查`SecurityManager`. 许多 JVM 类调用它来检查它们是否具有所需的权限，然后再执行它们的工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T16:48:18.843

您可以实现自己的[`SecurityManager`](http://docs.oracle.com/javase/7/docs/api/java/lang/SecurityManager.html). [教程](http://docs.oracle.com/javase/tutorial/essential/environment/security.html)。

# jquery-plugins - jquery + instagram + 图像蒙太奇

> ID：10076556
> 
> 赞同：1
> 
> 时间：2012-04-09T16:45:08.693
> 
> 标签：jquery-plugins, instagram

我无法集成到 jquery 插件。 [http://potomak.github.com/jquery-instagram/](http://potomak.github.com/jquery-instagram/)和[http://tympanus.net/codrops/2011/08/30/automatic-image-montage/](http://tympanus.net/codrops/2011/08/30/automatic-image-montage/)

我可以让图像蒙太奇正常工作或加载 instagram 照片，但我无法将 instagram 照片制作成图像蒙太奇。我为这两个函数调用相同的 div 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T10:23:38.010

您是否检查过它们是否覆盖了诸如 window.onLoad() 之类的函数或设置了另一个也使用的计时器？

我有一种在 www.pixomundo.com 上运行的 instagram 图像加载器，您可以随意查看那里的代码。

# installshield-le - 您如何告诉 InstallShield LE 安装解决方案中的哪个项目？

> ID：10076560
> 
> 赞同：0
> 
> 时间：2012-04-09T16:45:34.003
> 
> 标签：installshield-le

您如何告诉 InstallShield LE 安装解决方案中的哪个项目？我已将安装程序项目添加到我的解决方案中，但我看不到在哪里告诉它哪个项目需要包含在安装中。目前它只安装一个空白文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:28:23.120

编写安装程序就是开发。InstallShield LE 不会自动查看您的解决方案并自行决定如何部署您的项目。

查看[InstallShield Limited Edition for Visual Studio 2010 演练](http://codesmartnothard.com/InstallShieldLimitedEditionForVisualStudio2010Walkthrough.aspx)以获得高级演练。

# python - python：在键上对字典的字典进行排序

> ID：10076568
> 
> 赞同：3
> 
> 时间：2012-04-09T16:45:54.950
> 
> 标签：python

像这样的数据结构。

```
{
  'ford': {'count': 3},
  'mazda': {'count': 0},
  'toyota': {'count': 1}
 } 
```

`count`在顶级dict的值中排序的最佳方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-09T16:48:03.953

```
d = {'ford': {'count': 3},
     'mazda': {'count': 0},
     'toyota': {'count': 1}}

>>> sorted(d.items(), key=lambda (k, v): v['count'])
[('mazda', {'count': 0}), ('toyota', {'count': 1}), ('ford', {'count': 3})] 
```

要将结果保存为字典，您可以使用[`collections.OrderedDict`](http://docs.python.org/library/collections.html#collections.OrderedDict)：

```
>>> from collections import OrderedDict
>>> ordered = OrderedDict(sorted(d.items(), key=lambda (k, v): v['count']))
>>> ordered
OrderedDict([('mazda', {'count': 0}), ('toyota', {'count': 1}), ('ford', {'count': 3})])
>>> ordered.keys()          # this is guaranteed to come back in the sorted order
['mazda', 'toyota', 'ford']
>>> ordered['mazda']        # still a dictionary
{'count': 0} 
```

版本问题：

*   在 Python 2.x 上，您可以使用`d.iteritems()`而不是`d.items()`提高内存效率
*   `collections.OrderedDict`仅适用于 Python 2.7 和 Python 3.2（及更高版本）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T16:48:10.883

字典是无序的数据结构，因此无法排序。`OrderedDict`你可以从你的字典中创建一个排序列表（或者，在 Python 2.7 中，一个） `d`：

```
sorted(d.iteritems(), key=lambda item: item[1]["count"]) 
```

此列表可用作 a 的构造函数参数`collections.OrderedDict`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T16:59:11.880

如果要按值中的某个项目对字典进行排序，则不能将结果保留为 dict，因为在 dict 中不保留元素添加的顺序。你必须使用 OrderedDict。一种解决方案是，一旦排序，从 (key,value) 元组列表中生成一个 OrderedDict。

```
>>> collections.OrderedDict(sorted(d.iteritems(),key=lambda x:x[1]["count"],reverse=True))
OrderedDict([('ford', {'count': 3}), ('toyota', {'count': 1}), ('mazda', {'count': 0})])
>>> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-28T23:09:11.327

我认为**dict**是一个**哈希表**，因此实际上无法对其进行排序。尝试将排序后的值存储到*可以*排序的列表中：

```
l = []
for x in sorted(dictionary.keys()):
    l.append([dictionary[x]]) 
```

如果您真的想保留密钥，也可以将它们添加到列表中。只需确保在访问列表时，偶数索引 (0,2,4,...) 是键，奇数索引是值 (1,3,5,...)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T16:53:56.840

一种更简洁的方法是使用 itemgetter，然后使用该值来构建一个有序的字典，就像另一个建议的那样。

```
>>> from operator import itemgetter
>>> sorted(s,key=itemgetter,reverse=True)
['ford', 'toyota', 'mazda'] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-17T18:51:02.600

如果您拥有的字典名为 x，那么您可以获得键列表： sorted_x = sorted(x, key=lambda a: x[a]['count']) 其中 sorted_x 是： ['mazda', '丰田'，'福特']

然后你可以打印： for i in sorted_x: print x[i]

结果：{'count': 0} {'count': 1} {'count': 3}

# ruby - Ruby 中的字符串连接与插值

> ID：10076579
> 
> 赞同：81
> 
> 时间：2012-04-09T16:46:39.290
> 
> 标签：ruby, string-concatenation, string-interpolation

我刚刚开始学习 Ruby（第一次编程），并且有一个关于变量的基本句法问题，以及各种编写代码的方式。

Chris Pine 的“学习编程”教我编写这样的基本程序......

```
num_cars_again= 2
puts 'I own ' + num_cars_again.to_s + ' cars.' 
```

这很好，但后来我偶然发现了 ruby​​.learncodethehardway.com 上的教程，并被教导编写与这样完全相同的程序......

```
num_cars= 2
puts "I own #{num_cars} cars." 
```

它们都输出相同的东西，但显然选项 2 是一种更短的方法。

我应该使用一种格式而不是另一种格式有什么特别的原因吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-04-09T16:49:55.227

每当 TIMTOWTDI（有不止一种方法可以做到这一点）时，您应该寻找利弊。使用“字符串插值”（第二个）而不是“字符串连接”（第一个）：

**优点：**

*   打字少
*   自动呼叫`to_s`您
*   在 Ruby 社区中更惯用
*   在运行时更快地完成

**缺点：**

*   自动调用`to_s`你（也许你认为你有一个字符串，并且`to_s`表示不是你想要的，并且隐藏了它不是字符串的事实）
*   要求您使用`"`来分隔您的字符串而不是`'`（也许您有使用的习惯`'`，或者您之前使用它输入了一个字符串，只是后来才需要使用字符串插值）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-04-11T11:32:17.913

插值和连接都有自己的优点和缺点。下面我给出了一个基准，它清楚地展示了在哪里使用连接以及在哪里使用插值。

```
require 'benchmark'

iterations = 1_00_000
firstname = 'soundarapandian'
middlename = 'rathinasamy'
lastname = 'arumugam'

puts 'With dynamic new strings'
puts '===================================================='
5.times do
  Benchmark.bm(10) do |benchmark|
    benchmark.report('concatination') do
      iterations.times do
        'Mr. ' + firstname + middlename + lastname + ' aka soundar'
      end
    end

    benchmark.report('interpolaton') do
      iterations.times do
        "Mr. #{firstname} #{middlename} #{lastname} aka soundar"
      end
    end
  end
  puts '--------------------------------------------------'
end

puts 'With predefined strings'
puts '===================================================='
5.times do
  Benchmark.bm(10) do |benchmark|
    benchmark.report('concatination') do
      iterations.times do
        firstname + middlename + lastname
      end
    end

    benchmark.report('interpolaton') do
      iterations.times do
        "#{firstname} #{middlename} #{lastname}"
      end
    end
  end
  puts '--------------------------------------------------'
end 
```

以下是基准测试结果

```
Without predefined strings
====================================================
                 user     system      total        real
concatination  0.170000   0.000000   0.170000 (  0.165821)
interpolaton  0.130000   0.010000   0.140000 (  0.133665)
--------------------------------------------------
                 user     system      total        real
concatination  0.180000   0.000000   0.180000 (  0.180410)
interpolaton  0.120000   0.000000   0.120000 (  0.125051)
--------------------------------------------------
                 user     system      total        real
concatination  0.140000   0.000000   0.140000 (  0.134256)
interpolaton  0.110000   0.000000   0.110000 (  0.111427)
--------------------------------------------------
                 user     system      total        real
concatination  0.130000   0.000000   0.130000 (  0.132047)
interpolaton  0.120000   0.000000   0.120000 (  0.120443)
--------------------------------------------------
                 user     system      total        real
concatination  0.170000   0.000000   0.170000 (  0.170394)
interpolaton  0.150000   0.000000   0.150000 (  0.149601)
--------------------------------------------------
With predefined strings
====================================================
                 user     system      total        real
concatination  0.070000   0.000000   0.070000 (  0.067735)
interpolaton  0.100000   0.000000   0.100000 (  0.099335)
--------------------------------------------------
                 user     system      total        real
concatination  0.060000   0.000000   0.060000 (  0.061955)
interpolaton  0.130000   0.000000   0.130000 (  0.127011)
--------------------------------------------------
                 user     system      total        real
concatination  0.090000   0.000000   0.090000 (  0.092136)
interpolaton  0.110000   0.000000   0.110000 (  0.110224)
--------------------------------------------------
                 user     system      total        real
concatination  0.080000   0.000000   0.080000 (  0.077587)
interpolaton  0.110000   0.000000   0.110000 (  0.112975)
--------------------------------------------------
                 user     system      total        real
concatination  0.090000   0.000000   0.090000 (  0.088154)
interpolaton  0.140000   0.000000   0.140000 (  0.135349)
-------------------------------------------------- 
```

**结论**

如果字符串已经定义并且确定它们永远不会为零，则使用连接，否则使用插值。使用适当的字符串，这将比易于缩进的字符串带来更好的性能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-09T17:01:21.853

@ user1181898 - 恕我直言，这是因为更容易看到正在发生的事情。就@Phrogz 而言，字符串插值会自动为您调用 to_s。作为初学者，您需要了解“幕后”发生的事情，以便您学习概念，而不是仅仅死记硬背。

把它想象成学习数学。您学习“漫长”的方式是为了理解这些概念，这样一旦您真正知道自己在做什么，就可以走捷径。我从经验 b/c 说我在 Ruby 方面还没有那么先进，但是我犯了足够多的错误来建议人们不要做什么。希望这可以帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-15T02:08:02.690

如果您使用字符串作为缓冲区，我发现使用连接 ( `String#concat`) 会更快。

```
require 'benchmark/ips'

puts "Ruby #{RUBY_VERSION} at #{Time.now}"
puts

firstname = 'soundarapandian'
middlename = 'rathinasamy'
lastname = 'arumugam'

Benchmark.ips do |x|
    x.report("String\#<<") do |i|
        buffer = String.new

        while (i -= 1) > 0
            buffer << 'Mr. ' << firstname << middlename << lastname << ' aka soundar'
        end
    end

    x.report("String interpolate") do |i|
        buffer = String.new

        while (i -= 1) > 0
            buffer << "Mr. #{firstname} #{middlename} #{lastname} aka soundar"
        end
    end

    x.compare!
end 
```

结果：

```
Ruby 2.3.1 at 2016-11-15 15:03:57 +1300

Warming up --------------------------------------
           String#<<   230.615k i/100ms
  String interpolate   234.274k i/100ms
Calculating -------------------------------------
           String#<<      2.345M (± 7.2%) i/s -     11.761M in   5.041164s
  String interpolate      1.242M (± 5.4%) i/s -      6.325M in   5.108324s

Comparison:
           String#<<:  2344530.4 i/s
  String interpolate:  1241784.9 i/s - 1.89x  slower 
```

猜测一下，我会说插值会生成一个临时字符串，这就是它变慢的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-06T11:34:00.860

这是一个完整的基准，它也进行比较`Kernel#format`，`String#+`因为它是我知道的在 ruby​​ 中构建动态字符串的所有方法

```
require 'benchmark/ips'

firstname = 'soundarapandian'
middlename = 'rathinasamy'
lastname = 'arumugam'

FORMAT_STR = 'Mr. %<firstname>s %<middlename>s %<lastname>s aka soundar'
Benchmark.ips do |x|
  x.report("String\#<<") do |i|
    str = String.new
    str << 'Mr. ' << firstname << ' ' << middlename << ' ' << lastname << ' aka soundar'
  end

  x.report "String\#+" do
    'Mr. ' + firstname + ' ' + middlename + ' ' + lastname + ' aka soundar'
  end

  x.report "format" do
    format(FORMAT_STR, firstname: firstname, middlename: middlename, lastname: lastname)
  end

  x.report("String interpolate") do |i|
    "Mr. #{firstname} #{middlename} #{lastname} aka soundar"
  end

  x.compare!
end 
```

ruby 2.6.5 的结果

```
Warming up --------------------------------------
           String#<<
    94.597k i/100ms
            String#+    75.512k i/100ms
              format    73.269k i/100ms
  String interpolate   164.005k i/100ms
Calculating -------------------------------------
           String#<<     91.385B (±16.9%) i/s -    315.981B
            String#+    905.389k (± 4.2%) i/s -      4.531M in   5.013725s
              format    865.746k (± 4.5%) i/s -      4.323M in   5.004103s
  String interpolate    161.694B (±11.3%) i/s -    503.542B

Comparison:
  String interpolate: 161693621120.0 i/s
           String#<<: 91385051886.2 i/s - 1.77x  slower
            String#+:   905388.7 i/s - 178590.27x  slower
              format:   865745.8 i/s - 186768.00x  slower 
```

# r - 隐藏在文本中的变量

> ID：10076587
> 
> 赞同：1
> 
> 时间：2012-04-09T16:46:52.150
> 
> 标签：r

我想问一下是否有办法查看隐藏在文本中的变量。

如果我跑

```
k <- eval(expression(v <- 1)) 
```

然后我得到 v 等于 1。

但是如果我有它是如何工作的

```
k <- "v <- 1" 
```

先感谢您

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T17:13:01.153

用于`parse(text=k)`创建表达式，然后对其求值：

```
eval(parse(text=k))
v
# [1] 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:59:34.527

如果您想评估代码，请查看`eval`and命令。`evalq`

如果您只想在`<-`运算符之前找到任何字符串，我想您可以使用以下内容：

```
regexpr("(.*)[\\s]*<-", "a <- 1", perl=TRUE) 
```

这将返回变量名称的起始索引，如果没有，则返回 -1。`substr`如果您只想要变量名，可以使用命令提取它。

# javascript - 使用 RaphaelJS；在全球范围内创建“论文” - 我可以创建多篇论文，但不能删除它们

> ID：10076589
> 
> 赞同：0
> 
> 时间：2012-04-09T16:47:03.503
> 
> 标签：javascript, raphael

我创建了这个[例子](http://jsfiddle.net/andrewgehring/BjMzH/2/embedded/result/)

删除功能不起作用，我无法弄清楚我做错了什么......

任何和所有的帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:52:53.390

[这行得通](http://jsfiddle.net/e5Lkk/)。

简而言之，你错过了一个`return`声明，你错误地使用了你的变量。

# android - 在 sqlite/android 中创建两个表并显示它们的内容

> ID：10076590
> 
> 赞同：1
> 
> 时间：2012-04-09T16:47:11.537
> 
> 标签：android, sqlite, database-table

我创建了一个表，但我想创建两个，当我点击“显示”按钮时，我希望能够从两个表中选择内容并显示它们......这是我的代码......创建时遇到问题两张表并展示它们：

```
public class Entername extends Activity {

        private Button showButton;
        private Button insertButton;
        private TextView nameEditText;
        private TextView addTextView;
        private Button doneButton;
        public DatabaseHelper dbHelper = new DatabaseHelper(Entername.this,"pubgolfdatabase",2);
        /** Called when the activity is first created. */
        @Override
        public void onCreate(Bundle savedInstanceState) 
        {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.entername); 
            addTextView = (TextView)findViewById(R.id.textView1);
            doneButton= (Button)findViewById(R.id.doneButton);
            insertButton = (Button)findViewById(R.id.addButton);
            nameEditText = (EditText)findViewById(R.id.name);  
            showButton =(Button)findViewById(R.id.button1);
            showButton.setOnClickListener(new showButtonListener());
            insertButton.setOnClickListener(new InsertButtonListener());
            doneButton.setOnClickListener(new DoneButtonListener());

            /** create the database if it dosen't exist  **/
            SQLiteDatabase db = dbHelper.getWritableDatabase();
            try
            {
                db.execSQL("create table user_name(ID integer, name varchar(90));");                                    
            }
            catch(Exception e)
            {
                e.printStackTrace();
            }           
        }

        class InsertButtonListener implements OnClickListener, android.view.View.OnClickListener
        {
            public void onClick(View v) 
            {                   
                if("".equals(nameEditText.getText().toString())) 
                {
                    Toast toast = Toast.makeText(Entername.this, "Sorry, you must input both the name and the address!", Toast.LENGTH_LONG); 
                    toast.show();
                }
                else
                {
                    long flag = 0;
                    int id = 1;
                    SQLiteDatabase db = dbHelper.getWritableDatabase();
                    Cursor cursor = db.query("user_name", new String[]{"count(*) ID"}, null, null, null, null, null);
                    while(cursor.moveToNext())
                    {
                        int idFromDatabase = cursor.getInt(cursor.getColumnIndex("ID"));
                        if(idFromDatabase != 0)
                        {
                            id = 1 + idFromDatabase;
                        }
                    }
                    ContentValues values = new ContentValues();
                    values.put("ID", id);
                    values.put("name", nameEditText.getText().toString().trim());

                    flag = db.insert("user_name", null, values);
                    if(flag != -1)
                    {
                        Toast toast = Toast.makeText(Entername.this, "You have successful inserted this record into database! ", Toast.LENGTH_LONG); 
                        toast.show();
                        db.close();

                        //clear fields              //clearing edittexts
                           nameEditText.setText("");

                        return;
                    }
                    else
                    {
                        Toast toast = Toast.makeText(Entername.this, "An error occured when insert this record into database!", Toast.LENGTH_LONG); 
                        toast.show();
                        db.close();

                        //clear fields
                        //clearing edittexts
                           nameEditText.setText("");
                        return;
                    }
                }
            }

            public void onClick(DialogInterface dialog, int which) 
            {
                // TODO Auto-generated method stub
            }
        }

        class DoneButtonListener implements OnClickListener, android.view.View.OnClickListener
        {
            public void onClick(View v) 
            {   
                Intent myIntent = new Intent(v.getContext(), Pickholespubs.class);
                 startActivityForResult(myIntent, 0);
            }

            public void onClick(DialogInterface dialog, int which) 
            {
                // TODO Auto-generated method stub  
            }
        }

        class showButtonListener implements OnClickListener, android.view.View.OnClickListener
        {
            public void onClick(View v) 
            {
                String display = "";
                SQLiteDatabase db = dbHelper.getWritableDatabase();
                /** the result will be loaded in cursor **/
                Cursor cursor = db.query("user_name", new String[]{"ID","name"}, null, null, null, null, null);
                /** check if the table is empty **/
                if (!cursor.moveToNext())
                {
                    addTextView.setText("No data to display, please make sure you have already inserted data!");
                    db.close();
                    return;
                }
                cursor.moveToPrevious();
                /** if the table is not empty, read the result into a string named display **/
                while(cursor.moveToNext())
                {
                    int ID = cursor.getInt(cursor.getColumnIndex("ID"));
                    String name = cursor.getString(cursor.getColumnIndex("name"));

                    display = display + "\n"+"Player"+ID+", Name: "+name;
                }
                /** display the result on the phone **/
                addTextView.setText(display);
                db.close();
            }

            public void onClick(DialogInterface dialog, int which) 
            {
                // TODO Auto-generated method stub  
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T05:23:44.847

像这样试试

```
@Override
    public void onCreate(SQLiteDatabase db) {
        String CREATE_CONTACTS_TABLE = "CREATE TABLE " + TABLE_DETAILS + "("
                + KEY_ID + " INTEGER PRIMARY KEY," + KEY_NAME + " TEXT," 
                + KEY_NUMBER + " TEXT,"  + KEY_MAIL + " TEXT" + ")";
        db.execSQL(CREATE_CONTACTS_TABLE);
        String CREATE_ONLINE_TABLE = "CREATE TABLE " + TABLE_ONLINE_DETAILS + "("
                + KEY_ID + " INTEGER PRIMARY KEY," + KEY_NAME + " TEXT,"
                + KEY_MAIL + " TEXT,"  + KEY_PHONE + " TEXT"+ ")";
        db.execSQL(CREATE_ONLINE_TABLE);

    }
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_DETAILS);
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_ONLINE_DETAILS);
        onCreate(db);
        } 
```

你可以在你的java类中调用方法，比如

```
db.add(String, String, String); 
```

# actionscript-3 - 影片剪辑宽度改变而不是高度

> ID：10076592
> 
> 赞同：0
> 
> 时间：2012-04-09T16:47:17.727
> 
> 标签：actionscript-3

我正在使用纯 Actionscript 3.0 中的 Flash Builder 4.5

我有一个movieclip (swc)，我正在执行以下操作：

```
_visualItem.bgMiddle.height     = 200; 
```

bgMiddle 是一个独立的剪辑，其中只有一个形状。在调试时，高度保持不变（2.2），但宽度变为 5111。无法追踪到它。

我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T10:43:36.403

应用到显示树中较高的任何 DisplayObjectContainers 的某些转换可能会影响您尝试更改的项目？

# c++ - 将对象推送到向量时没有输出

> ID：10076594
> 
> 赞同：0
> 
> 时间：2012-04-09T16:47:20.973
> 
> 标签：c++, pointers, vector

我的模型非常简单，但我使用的向量存在一些问题。

基本上，我有一个 Song 类，它有一个播放列表，一个 Playlist 可以有多个轨道（在一个向量内）。

```
Song* song = new Song("Rien de rien", "Biggy", 120);
Playlist* playlist;
Track* synthTrack;

playlist->addTrack(synthTrack); // without this line everything works fine
song->setPlaylist(playlist);

cout << "Title " + song->getTitle() << endl; 
```

控制台没有给我任何错误，但`cout`没有出现。一旦我将曲目添加到我的播放列表，就会发生这种情况。

这是我的播放列表类的样子：

```
class Playlist {
private:

    vector<Track*> tracklist;

public:
    void addTrack(Track* track){
        this->tracklist.push_back(track);
    }
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T16:51:19.360

您正在调用**undefined behavior**，这意味着任何事情都可能发生，通过访问一个无效的指针：

```
Playlist* playlist;
Track* synthTrack;

playlist->addTrack(synthTrack); // using uninitialized pointer 
```

应该

```
Playlist* playlist = new Playlist; //initialize playlist here
Track* synthTrack = new Track; //also initialize synthTrack

playlist->addTrack(synthTrack); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T16:57:53.777

@Lucian 已经为解决您所看到的问题给出了一个合理的开始，但我会提倡一条稍微不同的路线。我将首先摆脱相关代码中的所有指针：

```
Song song("Rien de rien", "Biggy", 120);
Playlist playlist;
Track synthTrack;

playlist.addTrack(synthTrack);
song.setPlaylist(playlist);

cout << "Title " << song.getTitle() << "\n"; 
```

...和：

```
class Playlist {   
    vector<Track> tracklist;    
public:
    void addTrack(Track const &track){
        tracklist.push_back(track);
    }
}; 
```

一开始就需要指针是相当不寻常的，当您确实需要它们时，您几乎肯定希望将它们包装在某种智能指针类中。在这种情况下，我看不到后者是必要的或什至可能有用的暗示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T16:58:27.263

```
class Playlist
{
private:
    vector<Track> tracklist;

public:
    void addTrack(const Track& track){
        tracklist.push_back(track);
    }
};

Song song("Rien de rien", "Biggy", 120);
Playlist playlist;
Track synthTrack;

playlist.addTrack(synthTrack);
song.setPlaylist(playlist);

cout << "Title " + song.getTitle() << endl; 
```

或者如果你想避免复制使用 std::unique_ptr 或 std::shared_ptr

# android - 如何修复间歇性/生涩的 android 绘画更新

> ID：10076595
> 
> 赞同：0
> 
> 时间：2012-04-09T16:47:21.563
> 
> 标签：android, graphics, invalidation, rate

（我试图用关键字填充问题，以防其他人遇到这个问题 - 我找不到太多帮助。）

我在 Android 中有一个自定义视图，其中包含一个 LED 条形图，显示通过套接字通信接收到的级别。它基本上只是一个剪辑的图像。级别越高，图像被剪裁的越少。

当我更新关卡然后使视图无效时，某些设备似乎会“收集”多个更新并以块的形式呈现它们。屏幕明显犹豫了 1/10 秒，然后快速绘制多个帧，然后再次犹豫。看起来它不堪重负并掉帧。

但是，当更改屏幕上的另一个 UI 控件时，LED 条形图的绘制更加频繁和流畅。我在想 Android 试图通过“收集”多个失效然后一次完成所有这些来帮助我。也许通过操纵控件，我只是通过给它“更多工作”来“增加”我的帧速率，因此它在实际绘画之间的延迟更少。

与动画（平滑过渡）不同，我想尽快显示绝对最新值。无论如何，我的数据样本不超过 10-20fps。

是否有一种简单的方法可以在某些点“强制”绘制，或者这是视图如何工作的限制？我应该在 SurfaceView 中实现这个吗？（我还没有玩过......首先需要建议。）提前感谢您的建议。

*（当天晚些时候……）*

更新：我在文档中找到了一个页面，它确实建议将我的小部件实现为 SurfaceView 是要走的路：

[http://developer.android.com/guide/topics/graphics/2d-graphics.html](http://developer.android.com/guide/topics/graphics/2d-graphics.html)

*（在那之后的一个小时……）*

SurfaceView 对于我想做的事情来说似乎有点矫枉过正。最佳实践方法是“拥有”整个画布，但我已经开发了其余的控件和布局，并且它们运行良好。必须有可能用我所拥有的东西获得更好的性能，特别是因为与 UI 交互使重绘速度令人满意*。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T14:45:54.537

事实证明这`SurfaceView`是要走的路。我在一部没有帮助的旧手机上进行基准测试。（使用标准的帧速率`View`在华硕 eeePad 上很好）。我不得不扔掉一些代码，但最终的结果是使用`SurfaceView`. 此外，我能够重用比我预期更多的代码，并且实际上大大简化了我的多点触控处理代码（因为我想要触摸的所有内容都在同一`SurfaceView.`

仅供参考：我仍然只能在 Droid X 上获得大约 15fps，但 CPU 负载的一半似乎是数据包处理。eeePad 现在的速度几乎为 40fps——而我的数据速率仅为 20 个样本/秒。

所以......我猜是一场胜利。我希望 Droid X 运行得更好，但它可以在真正的平板电脑上运行。

# haskell - 在 Haskell 中实现简单的业务模型

> ID：10076596
> 
> 赞同：4
> 
> 时间：2012-04-09T16:47:23.547
> 
> 标签：haskell, data-modeling

假设我们有一个非常简单的模型：

`Station`至少有一个至少`Train`
`Train`有两个`Station`

该模型必须允许检查任何给定的火车访问了哪些车站，并检查哪些火车访问了特定的车站。

如何在 Haskell 中建模？

我是 Haskell 新手，所以请纠正我：创建对象后，您无法修改它 - 您只能基于该对象创建一个新对象（~不变性）。我对吗？如果是这样，我将不得不使用半初始化对象创建大量临时变量（在反序列化期间甚至在单元测试中）。

基本上我需要的是在 Haskell 中建模域类的示例 - 在阅读“Learn you a haskell..”之后，我仍然不知道如何使用这种语言。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T17:25:46.397

这是一个天真的方法：

```
data Station = Station Train [Train]
data Train = Train Station Station [Station] 
```

您永远不必创建未初始化的对象。例如，这里有几个示例值：

```
grandCentral = Station regional [national]
bestWestern  = Station regional [national]
regional = Train grandCentral bestWestern []
national = Train grandCentral bestWestern [] 
```

但是，这种方法有很多缺点。从 Haskell 的纯子集中观察堆内循环是不可能的，因此更新或使用这些数据很棘手。通常的解决方法是显式地为您的指针建模。

```
type TrainMap   = Map TrainId Train
type StationMap = Map StationId Station
type TrainId    = Int -- use newtype for more compiler checks at
type StationId  = Int -- the cost of more programmer annoyance
data Train   = Train StationId StationId [StationId]
data Station = Station TrainId [TrainId] 
```

# linux - Linux Eclipse CDT 分析器

> ID：10076602
> 
> 赞同：16
> 
> 时间：2012-04-09T16:47:36.463
> 
> 标签：linux, eclipse, profiling, profiler, eclipse-cdt

我在 Linux 下使用 Eclipse CDT，任何人都可以在那个环境下推荐一个好的分析器。

我也是 C++ 和多线程编程的新手，任何人都可以提供一些关于如何为多线程应用程序运行分析的建议，例如，寻找性能瓶颈等。

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-09T19:52:24.113

我不知道这是否是最佳选择，但它绝对是显而易见的：gprof。您只需要正确设置编译开关（在项目属性 -> c/c++ 构建 -> 设置 -> 调试中为该项目启用 gprof (-pg)）。当您使用此选项编译程序后，您需要运行它（直到正常退出）。这会生成配置文件 (gmon.out)。您可以在 eclipse 中安装其他插件，它可以可视化 gmon.out 的内容（转到帮助 -> 安装 -> Linux 工具 -> GProf 集成）。安装该插件后，只需像打开任何其他文件一样打开生成的 gmon.out 文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-04T16:14:19.070

正如 dbrank0 所提到的，您需要为该项目设置编译选项 (-pg)。转到项目属性 -> c/c++ 构建 -> 设置 -> C++ 编译器 -> 调试并检查***生成 gpof 信息***。当你编译程序（test_prof.c）时，你会得到一个 exe 文件（在我们的例子中是 test_prof）。

```
$ ls
test_gprof  test_gprof.c 
```

当你运行它时，会在同一目录中生成一个 gmon.out 文件。

```
$ ls
gmon.out  test_gprof  test_gprof.c 
```

**gprof**工具使用可执行文件名和上面生成的“gmon.out”作为参数运行。这将生成一个分析文件，其中包含所有所需的分析信息。

```
$  gprof test_gprof gmon.out > analysis.txt 
```

将生成一个名为“analysis.txt”的文件，其中包含所有配置文件信息，可以轻松读取。有关详细信息，请查看[http://www.thegeekstuff.com/2012/08/gprof-tutorial/](http://www.thegeekstuff.com/2012/08/gprof-tutorial/)

# php - 将数组从控制器传递到模型 - codeigniter

> ID：10076603
> 
> 赞同：0
> 
> 时间：2012-04-09T16:47:38.133
> 
> 标签：php, mysql, codeigniter

知道为什么这不起作用吗？我正在获取用户设置的标签，并希望获取具有相同标签的其他用户的 ID。

控制器：

```
$this->load->model('tag_model');
            $data['usr_tags'] = $this->tag_model->get_home_tags($user_id);
            $tags = $this->tag_model->get_home_tags($user_id);
            $tag_array = $tags;
            $data['tag_users'] = $this->tag_model->get_tag_users($tag_array); 
```

模型：

```
function get_tag_users($tag_array)
    {
            //$tag = array('item1','item2','item3');
            $tag = $tag_array;
            $query_str = 'SELECT DISTINCT user_id FROM tags WHERE tag IN ("'. implode('","', $tag) .'")';

            $query = $this->db->query($query_str);

            if($query->num_rows() > 0) {
                    foreach($query->result_array() as $tag_users) {
                            $data[] = $tag_users;
                    }
                    return $data;
            }else{
                    return false;
            }
    } 
```

错误：

```
A PHP Error was encountered
Severity: Notice
Message: Array to string conversion
Filename: models/tag_model.php
Line Number: 20 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:31:21.523

**控制器**

```
$this->load->model('tag_model');
$data['usr_tags'] = $this->tag_model->get_home_tags($user_id);
$data['tag_users'] = $this->tag_model->get_tag_users($data['usr_tags']); 
```

**模型**

```
function get_tag_users($tag_array)
{
    $tags=array();
    foreach($tag_array as $tag)
    {
        $tags[]= $tag['tag'];
    }
    $query_str = 'SELECT DISTINCT user_id FROM tags WHERE tag IN ('.implode(",", $tags).')';
    $query = $this->db->query($query_str);
    if($query->num_rows() > 0)
    {
        return $query->results();
    }
    else
    {
        return false;
    }
} 
```

**注意：** 您`$data['tag_users']`将包含另一个用户 ID 数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T18:24:41.993

你`$tag_array`看起来像这样：

```
array(4){
    [0]=> array(1){
        ["tag"]=> string(3) "lol"
    }
    [1]=> array(1){
        ["tag"]=> string(4) "here"
    }
    [2]=> array(1){
        ["tag"]=> string(3) "php"
    }
    [3]=> array(1){
        ["tag"]=> string(5) "mysql"
    }
} 
```

它实际上是一个数组数组，你不能`implode`在它上面使用。发生“数组到字符串”的转换是因为数组的每个元素都是一个数组，PHP 需要将其转换为字符串才能“内爆”它们。

您可以使用`array_map`从数组中获取每个标签。

```
function get_tag_users($tag_array)
{
    $tag = array_map(function($a){
        return $a['tag'];
    }, $tag_array);
    $query_str = 'SELECT DISTINCT user_id FROM tags WHERE tag IN ("'. implode('","', $tag) .'")'; 
```

如果你没有 PHP 5.3，你可以这样做：

```
function get_tag_users($tag_array)
{
    $tag = array_map(create_function('$a', 'return $a["tag"];'), $tag_array);
    $query_str = 'SELECT DISTINCT user_id FROM tags WHERE tag IN ("'. implode('","', $tag) .'")'; 
```

# javascript - Javascript 同步 XMLHttpRequest 的替代方案（在 Safari 中超时）

> ID：10076614
> 
> 赞同：4
> 
> 时间：2012-04-09T16:48:12.587
> 
> 标签：javascript, safari, timeout, xmlhttprequest

简短版本：寻找等待异步 XHR 请求的方法或让同步 XHR 在 Safari 中工作的方法。

更长的版本：我正在开发一个使用混合在一起的各种外部数据源的 Web 服务。我正在使用 Javacript 前端，它可以对我的 PHP 服务器代码进行 AJAX/XHR 调用。没有跨站点问题，因为客户端只从我的服务器请求数据（服务器发出外部数据请求）。

我正在使用同步 XHR 请求，因为在数据显示在屏幕上之前，我需要对数据进行一些加载后处理（排序、过滤等）。

这一切在 IE、FF 和 Opera 上都可以正常工作，但对 Safari 来说似乎是个问题（我还没有尝试过 Chrome）。

在我的 Windows 机器上使用 Firebug for Safari，我可以看到服务器调用 beng，然后在 10 秒以上的时间后失败。在我的 iPad 上，消息稍微好一些，因为它说：NETWORK_ERR: XMLHttpRequest Exception 101: A network error occurred in synchronous mode。

一些研究表明 Safari 在同步模式下会在 10 秒后超时。似乎有一个超时功能，您可以使用该超时功能来扩展它（Safari 的最大限制为 60 秒）。不幸的是，我无法让它工作。

我现在想知道人们会建议通过更改客户端 Javacript 代码来解决此问题的最佳方法。

我正在考虑的两个选项是（i）找到一个 Safari 浏览器将遵守的同步 XHR 超时的工作示例；或者 (ii) 在异步 XHR 调用周围有某种包装器，以便加载后处理首先等待加载。

我不是一个特别有经验的 Javascript 黑客，但我已经在这个项目上设置了相当数量。我没有使用过 JQuery 或任何其他框架，我更愿意使用原始 JS，以避免学习额外的语法。[您可能从我之前的帖子中看到，我过去曾尝试使用 JQM 和 Spry，但事实证明两者都是错误的选择，至少在现阶段，并且现在已经被抛弃了]。

我觉得回调可能是正确的等待异步选项，但我不确定它是如何工作的或者你将如何编码。

这只是现阶段的原型，因此可以接受肮脏的黑客攻击。一旦我证明了它的功能，一个完整的重写已经在卡片上。

感谢人们对此的想法和建议。

问候，皮特。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:04:15.473

通常，您会希望坚持异步请求，因为它们是非阻塞的。对于它们，您将需要使用回调——或者，简单地说，是一个设置为稍后调用的函数。

您可以使用以下[`onreadystatechange`属性](https://developer.mozilla.org/en/XMLHttpRequest#Properties)设置回调`XMLHttpRequest`：

```
xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {   // DONE
        if (xhr.status === 200) { // OK
            handleSuccess(xhr);
        } else {
            handleError(xhr);
        }
    }
}; 
```

正如属性名称所暗示的，它将被称为`readyState`更改的值，其中的值`4`表示请求已完成（成功与否）。

然后，您将在另一个函数中处理排序、过滤等 - 在本例中，`handleSuccess`.

您还可以从使用许多现有库中的任何一个中受益——例如，[jQuery](http://jquery.com)（此代码段为 1.6 或更高版本）：

```
$.get('/web/service/request')
    .done(function (result) {
        // sorting, filtering, etc
    })
    .fail(function (xhr) {
        // error notification, etc.
    }); 
```

# java - XPath 查找包含 CSS 类的祖先节点

> ID：10076618
> 
> 赞同：10
> 
> 时间：2012-04-09T16:48:37.243
> 
> 标签：java, xpath, selenium

我正在编写一些 Selenium 测试，我需要能够找到`WebElement`我已经找到的 a 的祖先。

这是我正在尝试但没有返回任何结果

```
// checkbox is also a WebElement
WebElement container = checkbox.findElement(By.xpath(
    "current()/ancestor-or-self::div[contains(@class, 'x-grid-view')]") ); 
```

下图显示了我选择的 div 以深蓝色突出显示，以及我想要找到的带有箭头指向的 div。

![在此处输入图像描述](../Images/c98fde106c11d88ecde9356aa749fc34.png)

**更新** 尝试了 prestomanifesto 的建议并得到以下错误

```
[cucumber]       org.openqa.selenium.InvalidSelectorException: The given selector ./ancestor::div[contains(@class, 'x-grid-view']) is either invalid or does not result in a WebElement. The following error occurred:
[cucumber]       [InvalidSelectorError] Unable to locate an element with the xpath expression ./ancestor::div[contains(@class, 'x-grid-view']) because of the following error:
[cucumber]       [Exception... "The expression is not a legal expression."  code: "51" nsresult: "0x805b0033 (NS_ERROR_DOM_INVALID_EXPRESSION_ERR)"  location: "file:///C:/Users/JUAN~1.MEN/AppData/Local/Temp/anonymous849245187842385828webdriver-profile/extensions/fxdriv 
```

**更新 2** 真的很奇怪，即使通过 ID 也不行

```
[cucumber]       org.openqa.selenium.NoSuchElementException: Unable to locate element:{"method":"xpath","selector":"./ancestor::div[@id='gridview-1252']"} 
```

**更新 3**

以下 XPATH 有效，但很脆弱

```
../../../../../../../* 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-09T16:55:25.843

这*应该*选择你想要的元素

```
./ancestor::div[contains(concat(' ', @class, ' '), ' x-grid-view ')][1] 
```

简而言之：在其类中的所有祖先`div`元素中`' x-grid-view '`，选择第一个（最接近的）元素。

笔记：

*   我将空格作为一种防御措施来防止部分匹配。
*   `current()`是 XSLT 函数，而不是 XPath 函数。它在 XSLT 之外没有任何意义。当前节点用`.`XPath 表示。

# ffmpeg - 如何使用 H264 文件的 MPEG4 更改比特率模式：VBR 到 CBR？

> ID：10076620
> 
> 赞同：1
> 
> 时间：2012-04-09T16:48:46.070
> 
> 标签：ffmpeg, mpeg-4, bitrate

我尝试使用 FFMPEG 库将比特率模式从 VBR 转换为 CBR，但比特率模式无法改变。我的命令行：

`ffmpeg -i <in file> -f mpegts -acodec libmp3lame -ar 48000 -ab 64k -s 320×240 -vcodec libx264 -b 96k -flags +loop -cmp +chroma -partitions +parti4x4+partp8x8+partb8x8 -subq 5 -trellis 1 -refs 1 -coder 0 -me_range 16 -keyint_min 25 -sc_threshold 40 -i_qfactor 0.71 -bt 200k -maxrate 96k -bufsize 96k -rc_eq 'blurCplx^(1-qComp)' -qcomp 0.6 -qmin 10 -qmax 51 -qdiff 4 -level 30 -aspect 320:240 -g 30 -async 2 <output file>`

我找到了一些应用程序，但没有任何可以更改比特率模式的应用程序。谁能指出我为什么我的 cmd 无法更改模式或应用程序可以这样做？我认为 CBR 是一种比特率始终相同的模式，是真的吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T18:08:39.327

如果我理解正确，您只是想获得恒定比特率？如果是这样，添加`-minrate 96k`可能会成功

# javascript - jQuery 1.7.1 滑块在主页上不起作用

> ID：10076627
> 
> 赞同：0
> 
> 时间：2012-04-09T16:49:31.890
> 
> 标签：javascript, jquery, wordpress, slider

我试图将滑块放在该网站的每个页面上：http: [//atripathi.com](http://atripathi.com)

它适用于主页，但不适用于任何其他页面（关于、服务等）

我知道这可能很容易解决，但我现在无法得到它。

感谢您的任何帮助或建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:58:55.537

看起来上面的原始建议是正确的。我在您的主页顶部看到滑块 javascript 包含不在其他页面上。

一般来说，解决问题的一个好方法是复制两个页面，可能是 index-c.php 和 about-c.php，然后开始删除与您遇到的问题无关的所有内容（其他 HTML、css 包括等），直到您只找到页面上的滑块。完成此操作后，您可能会注意到一页与另一页略有不同，因此可以正常工作。您可以来回复制，直到完成为止。

另一种可能性是某处存在相对路径问题，因为您的一个页面位于文件夹内（尽管我猜您有一个 .htaccess 重定向到根文件夹页面）？因此，如果所有其他方法都失败了，请将缩减后的 about-c.php 移动到根文件夹，然后查看是否有效。如果是这样，你知道这是一个路径问题。

希望这些建议有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T17:19:21.797

我看到您的所有页面都包含 jQuery，但循环插件仅包含在主页上。您应该能够更新您的模板来解决这个问题。

# java - 将大量数据从内存写入文件的最快方法是什么？

> ID：10076628
> 
> 赞同：7
> 
> 时间：2012-04-09T16:49:34.907
> 
> 标签：java, file, io

我有一个程序可以生成大量数据并将其放入队列中以进行写入，但问题是它生成数据的速度比我当前正在写入的速度快（导致它达到最大内存并开始变慢）。顺序无关紧要，因为我打算稍后解析文件。

我环顾四周，发现了一些帮助我设计当前流程的问题（但我仍然觉得它很慢）。到目前为止，这是我的代码：

```
//...background multi-threaded process keeps building the queue..
FileWriter writer = new FileWriter("foo.txt",true);
        BufferedWriter bufferWritter = new BufferedWriter(writer);
        while(!queue_of_stuff_to_write.isEmpty()) {
            String data = solutions.poll().data;
            bufferWritter.newLine();
            bufferWritter.write(data);
        }
        bufferWritter.close(); 
```

我对编程很陌生，所以我可能会评估这个错误（可能是我使用 EC2 时的硬件问题），但是是否可以非常快速地将队列结果转储到文件中，或者如果我的方法还可以，我可以改进它吗不知何故？由于顺序无关紧要，写入多个驱动器上的多个文件是否更有意义？线程会使它更快吗？等等。我不确定最好的方法，任何建议都会很棒。我的目标是保存队列的结果（抱歉没有输出到 /dev/null :-) 并让我的应用程序的内存消耗尽可能低（我不是 100% 确定，但队列填满了 15gig，所以我'我假设它将是一个 15gig+ 文件）。

[在文本文件 Java 中写入大量数据的最快方法](https://stackoverflow.com/questions/1062113/fastest-way-to-write-huge-data-in-text-file-java)（意识到我应该使用缓冲写入器） [在 Windows 上用 Java 并发文件写入](https://stackoverflow.com/questions/713550/concurrent-file-write-in-java-on-windows)（让我看到多线程写入可能不是一个好主意）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:17:44.737

看着那段代码，我想到的一件事是字符编码。您正在编写字符串，但最终，它是流向流的字节。引擎盖下的写入器字符到字节编码，它在处理写入的同一线程中进行。这可能意味着有时间用于延迟写入的编码，这可能会降低写入数据的速率。

一个简单的更改是使用队列`byte[]`而不是`String`，在推送到队列的线程中进行编码，并让 IO 代码使用 a`BufferedOutputStream`而不是 a `BufferedWriter`。

如果编码文本平均每个字符占用少于两个字节，这也可以减少内存消耗。对于拉丁文本和 UTF-8 编码，这通常是正确的。

但是，我怀疑您生成数据的速度可能比您的 IO 子系统处理它的速度更快。您将需要使您的 IO 子系统更快 - 通过使用更快的子系统（如果您在 EC2 上，可能租用更快的实例，或者写入不同的后端 - SQS、EBS 和本地磁盘等），或者通过组合几个 IO 子系统以某种方式并行在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:40:54.700

是的，在多个驱动器上写入多个文件应该会有所帮助，如果没有其他东西同时写入这些驱动器，性能应该随着驱动器数量线性扩展，直到 I/O 不再是瓶颈。您还可以尝试其他一些优化来进一步提高性能。

如果您正在生成巨大的文件并且磁盘根本跟不上，您可以使用 GZIPOutputStream 来缩小输出——这反过来又会减少磁盘 I/O 的数量。对于非随机文本，您通常可以期望压缩比至少为 2x-10x。

```
 //...background multi-threaded process keeps building the queue..
    OutputStream out = new FileOutputStream("foo.txt",true);
    OutputStreamWriter writer = new OutputStreamWriter(new GZIPOutputStream(out));
    BufferedWriter bufferWriter = new BufferedWriter(writer);
    while(!queue_of_stuff_to_write.isEmpty()) {
        String data = solutions.poll().data;
        bufferWriter.newLine();
        bufferWriter.write(data);
    }
    bufferWriter.close(); 
```

如果您正在输出常规（即重复）数据，您可能还需要考虑切换到不同的输出格式——例如，数据的二进制编码。根据数据的结构，将其存储在数据库中可能更有效。如果您正在输出 XML 并且真的想坚持使用 XML，那么您应该研究[二进制 XML](http://en.wikipedia.org/wiki/Binary_XML)格式，例如 EXI 或 Fast InfoSet。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T17:04:44.210

我想只要您从计算中生成数据并且不从另一个数据源加载数据，写入总是比生成数据慢。

您可以尝试在多个线程中将数据写入多个文件（不在同一个文件中->由于同步问题）（但我想这不会解决您的问题）。

您是否可以等待应用程序的编写部分完成其操作并继续计算？

另一种方法是：你清空你的队列吗？Solutions.poll() 是否会减少您的解决方案队列？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T17:11:23.817

使用多个线程写入不同的文件是一个好主意。此外，您应该考虑设置 BufferedWriters 缓冲区大小，您可以从构造函数中执行此操作。尝试使用 10 Mb 缓冲区进行初始化，看看是否有帮助

# java - '.class' 属性如何工作？

> ID：10076629
> 
> 赞同：23
> 
> 时间：2012-04-09T16:49:36.617
> 
> 标签：java, android, class

第一次用Java开发，第一次用Android开发，所以这是一个新手问题。

我目前有这个代码：

```
public void onBtnClicked(View v){
    /** Handles button navigation */

    @SuppressWarnings("rawtypes")
    Class c;
    int viewId = v.getId();

    switch (viewId) {

    case R.id.btnNewTourny :
        c = NewTourny.class;
        break;
    case R.id.btnTeamEditor :
        c = EditTeam.class;
        break;
    case R.id.btnCatEditor :
        c = EditCat.class;
        break;
    case R.id.btnLoadTourny :
        c = EditCat.class;
        break;
    case R.id.btnNewCategory :
        c = NewCat.class;
        break;
    default :
        c = Main.class;
    }

    Intent myIntent = new Intent(v.getContext(), c);
    startActivityForResult(myIntent, 0);
} 
```

**简短的问题：**

*.class*属性有什么作用，f.ex 。在' *c = NewTourny* **.class** '？

为什么我不能将 c 转换为 Tourny （这是所有这些类的父级）？

**长问题：**

这目前处理我的应用程序中的所有按钮导航，并且工作正常。但是，如您所见，我抑制了“原始类型”警告，当我将 c 转换为 Class 时会出现这种警告。现在，我真的想要一个没有警告的代码，所以我想'好吧，所有这些类都是'Tourny'的孩子'，所以我认为它可以工作，将 c 转换为 Tourny - 但这不起作用。然后我意识到，我真的不知道代码“NewTourny.class”实际上做了什么，这可能就是为什么我不能将 c 转换为 Tourny 的线索。那么，.class 有什么作用呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-09T16:54:53.123

它真的*没有*多大作用。 `NewTourney.class`更多的是一种语言特定的方式来编写“作为类的对象`NewTourney`”。这个速记允许人们引用a的*类*`NewTourney`，而不是处理特定的*已经存在的*实例`NewTourney`。

在您的具体情况下，我会冒险猜测最终会创建一个*类*`Activity`的实例来处理操作，或者至少保存操作的上下文敏感数据。

 ** * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T16:58:02.037

类是表示类的类。:)

它不是“对象”。它不是超类，甚至不是您的“NewTourny”层次结构。这就是为什么您不能从 NewTourney 转换为 Class 的原因。

.class 属性是表示类型信息的 Class 实例。

您可以使用它进行反射样式调用，以实例化您在编译时不知道其类型的内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-17T16:16:32.907

类的实例，其中**Class**表示正在运行的 Java 应用程序中的类和接口。这是 java 反射 API 的一部分。来自 Oracle[教程](https://docs.oracle.com/javase/tutorial/reflect/class/classNew.html)：

> 如果类型可用但没有实例，则可以通过将“.class”附加到类型名称来获得类。这也是获取原始类型的 Class 的最简单方法。

以下是一些参考资料：

1.  [https://docs.oracle.com/javase/tutorial/reflect/class/classNew.html](https://docs.oracle.com/javase/tutorial/reflect/class/classNew.html)
2.  [https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html](https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T17:01:13.890

要摆脱警告，您可以更改`Class c`为`Class<? extends Tourny>`. 这意味着 c 不是一个对象，它代表所有可能的类之一，但更具体地代表一个由`Tourny`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-05T20:47:16.817

.class 方法是所有对象都有的方法，它允许您在有机会初始化它之前引用该对象的原始性质。它不是父级，它是其自身的原始纯粹模板。它被称为“.class”，因为它是类的直接表示，只有类定义可以影响。它使您不必为了获取该类的所有成员最初共有的信息而创建一个新对象。*

# web-services - 如何为使用 Perl 构建的 Web 服务显示 WSDL

> ID：10076630
> 
> 赞同：0
> 
> 时间：2012-04-09T16:49:42.590
> 
> 标签：web-services, perl, wsdl, soaplite

我之前在 PHP 中创建了一个 Web 服务，当我转到 Web 服务的服务器链接时，它会构建并向我显示它的 WSDL。我不得不在 perl 中重新创建 web 服务（作为 .cgi 文件），但是现在当我转到 web 服务的链接时，我没有得到它的 wsdl。为了为基于 perl 的 Web 服务构建 wsdl，我需要做什么？我正在为我的网络服务使用 SOAP::Lite 库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:25:02.877

引用[SOAP::Schema](http://p3rl.org/SOAP%3a%3aSchema#SOAP%3a%3aSchema%3a%3aWSDL)：

> 目前，SOAP::Lite 工具包仅支持以 WSDL 语法加载服务描述。

使用不同的模块（例如[XML::Compile::WSDL11](http://p3rl.org/XML%3a%3aCompile%3a%3aWSDL11)）来构建 WSDL 资源。

# python - 使用存储在 virtualenv 中的 pip 下载的文件在哪里？

> ID：10076631
> 
> 赞同：17
> 
> 时间：2012-04-09T16:49:43.693
> 
> 标签：python, django, virtualenv, pip

我在 linux mint 12 上。我创建了一个名为`userena`. 然后我在那个 virtualenv 中使用 pip安装了[django-userena 。](http://django-userena.org/)我需要编辑一些 django-usrena 文件。它们位于哪里？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-09T17:24:42.310

要查看您的 virtualenv 文件在哪里，请启用它并发出以下 bash 命令：

```
$ echo $VIRTUAL_ENV 
```

与系统的 Python 安装类似，包存储在`lib/python2.*/site-packages/`目录中。在那里找到你的包并编辑必要的文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-09T16:54:53.563

首先，您需要知道 env userena 的路径。然后安装的应用程序通常在`path_to_userena/lib/python2.x/site-packages/`. Django 应用程序通常不包含 prefix `django-`，因此`userena`在这里。

或者你可以在 Python 中找到它

```
import os.path, userena
os.path.dirname(userena.__file__) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-05T17:53:39.830

你会在`home/.virtualenvs`. 在`.virtualenvs`目录中，您将找到您的 virtualenv

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-23T18:49:46.233

如果您使用的是 virtualenvwrapper（我推荐）：

假设我已经在使用`foo`virtualenv 并且我安装了 virtualenvwrapper：

```
$ cdvirtualenv 
```

如果这个命令我会去`$VIRTUAL_ENV`路径，在这种情况下是：

```
$ pwd
/home/bernardo/.virtualenvs/foo
$ ls
bin  build  include  lib  local 
```

就我而言，要查看我的 virtualenv 包，我会去`lib/python2.7/site-packages`或：

```
$ lssitepackages
figleaf  figleaf-0.6.1-py2.7.egg-info  initools  INITools-0.3.1-py2.7.egg-info 
```

命令来自“virtualenvwrapper `cdvirtualenv`”`lssitepackages`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-06T17:43:41.050

您在虚拟环境中使用 pip 或任何其他方法下载的包存储在虚拟环境文件夹中，即

假设你创建了一个虚拟环境 ENV，所以下载的包会在 ENV/lib/python2.7/site-packages 里面

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-03T02:03:18.547

**证明 pipenv 安装包的正位置推导：**

*使用'% pipenv --venv'*获取安装基础**

 *第二次运行 install 命令，pipenv 会泄露包的位置！

% pipenv 安装 django djangorestframework pygments

1.  安装 django... 要求已经满足：django 在 /usr/local/lib/python3.7/site-packages/Django-2.1.1-py3.7.egg (2.1.1)
2.  已满足要求：/usr/local/lib/python3.7/site-packages/pytz-2018.5-py3.7.egg 中的 pytz（来自 django）（2018.5）
3.  将 django 添加到 Pipfile 的 [packages] ... 安装 djangorestframework ... 已满足要求：/Users/sww/.local/share/virtualenvs/env-YuUv1EZG/lib/python3.7/site-packages 中的 djangorestframework (3.8.2 )
4.  将 djangorestframework 添加到 Pipfile 的 [packages]... 安装 pygments... 已满足要求：/Users/sww/.local/share/virtualenvs/env-YuUv1EZG/lib/python3.7/site-packages 中的 pygments (2.2.0 )*

# android - 关闭组时Android ExpandableListView获取组号

> ID：10076638
> 
> 赞同：0
> 
> 时间：2012-04-09T16:50:23.870
> 
> 标签：android, expandablelistview

我想处理自定义 ExpandableListView 组的 onclick。使用此代码，我在单击它时会获得组数：

```
exList.setOnGroupClickListener(new OnGroupClickListener() {

    @Override
    public boolean onGroupClick(ExpandableListView parent, View v, int groupPosition, long id) {

        Log.i("group position", groupPosition + "");
        return false;
    }
}); 
```

我正在添加简化代码。我希望你能弄清楚问题可能是什么：

```
public class ProductLists extends Activity {
    private static final String G_TEXT = "G_TEXT";
    private static final String C_TITLE = "C_TITLE";
    private static final String C_TEXT = "C_TEXT";
    private static final String C_CB = "C_CB";

    List<Map<String, String>> groupData = new ArrayList<Map<String, String>>();    
    List<List<Map<String, String>>> childData = new ArrayList<List<Map<String, String>>>();

    List<Map<String, Boolean>> groupCheckBox = new ArrayList<Map<String,Boolean>>();
    List<List<Map<String, Boolean>>> childCheckBox = new ArrayList<List<Map<String,Boolean>>>();
    String loadedexpanded;
    String upperString;
    int number, k_num, k_num2;

    String etext_newitem;
    EditText et_newitem;

    String CheckedItem;
    String CheckedItems;
    ExpandBaseAdapter adapter;
    ExpandableListView exList;

    HotOrNot info;
    ArrayList<String> grpsfav = new ArrayList<String>();

    ArrayList<String> OftenUsedAll = new ArrayList<String>();
    ArrayList<String> OftenUsedID = new ArrayList<String>();
    ArrayList<String> OftenUsedName = new ArrayList<String>();
    ArrayList<String> OftenUsedNumber = new ArrayList<String>();

    Button sqlExp, sqlAdd;
    ArrayList<String> PRLists = new ArrayList<String>();
    ArrayList<String> PRListsR = new ArrayList<String>();
    ArrayList<String> PRListsID = new ArrayList<String>();
    ArrayList<String> PRLists2 = new ArrayList<String>();
    ArrayList<String> todoItems = new ArrayList<String>();
    ArrayList<String> todoItemsID = new ArrayList<String>();
    ArrayList<String> todoItemsNAME = new ArrayList<String>();
    List<String> usable_chars = Arrays.asList(";", "'", "/", "\"", "%", "'\'", "$", "+", "-", "=", ":", "_");
    ArrayList<String> todoItemsTEMP = new ArrayList<String>();
    ArrayList<String> todoItemsIDTEMP = new ArrayList<String>();
    ArrayList<String> todoItemsNAMETEMP = new ArrayList<String>();

    ArrayList<String> inners = new ArrayList<String>();
    ArrayList result2;
    Button sqlView, sqlValami;
    Cursor c, c2;
    String newlistname, modifiedlistname;
    String loadedCapital, loadedshowhints;
    SharedPreferences sharedPreferences;

    ExpandableListView expandlist;
    DisplayMetrics metrics;
    int width;

    List<String> selectionList = Arrays.asList("Rename", "Delete");
    List<String> selectionListA = Arrays.asList("Add item", "Rename group", "Delete group");
    CharSequence[] selectionList2, selectionList2A;
    String rowIdtobemodified, rowIDtobedeleted;
    int groupPosition;
    int childPosition;
    AlertDialog.Builder builder;

    Dialog dialog_newitem, dialog_newgroup;

    Dialog dialog_renamelist, dialog_deletelist;
    EditText et_renamelist, et_deletelist;
    //String etext_renamelist, etext_deletelist;
    String renamelist_name, deletelist_name;
    Spinner SPProductLists3, SPProductLists32;
    Button btn_rename_save, btn_rename_cancel, btn_delete_save, btn_delete_cancel;
    String allerrors_newproductlistdialog;
    ArrayList<String> errors_addgroup = new ArrayList<String>();
    String selected_item_from_lists_torename, selected_item_from_lists_torename2;
    List<String> nonusable_chars = Arrays.asList(";", "'", "/", "\"", "%", "'\'", "$", "+", "-", "=", ":", "_");

    int max;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.layout_productlists3);

        exList = (ExpandableListView) findViewById(R.id.layoutExListView);

        info = new HotOrNot(this);
        info.open();
        //----------------------------query tables--------------------------------
        c = info.showAllTables();
        if (c.moveToFirst())
        {
            do{
                PRLists.add(c.getString(0));

            }while (c.moveToNext());
         }
         if (PRLists.size() >= 0)
         {
             for (int i=0; i<PRLists.size(); i++)
             {
                Log.d("PRLists(" + i + ")", PRLists.get(i) + "");
             }
         }

        //Declare base adapter
        max = 0;
        for (int i = 0; i < PRLists.size(); i++) 
        {
            Map<String, String> curGroupMap = new HashMap<String, String>();
            groupData.add(curGroupMap);
            curGroupMap.put(G_TEXT, PRLists.get(i).replaceAll("_", " ").substring(2, PRLists.get(i).replaceAll("_", " ").length()));

            List<Map<String, String>> children = new ArrayList<Map<String, String>>();

            if (!PRLists.get(i).equals("PR_Often_Used"))
            {
                Log.i("tabla", PRLists.get(i) + "");
                c2 = info.getAllTitlesPRtables(PRLists.get(i));
                if (c2.moveToFirst())
                {
                    do{
                        Map<String, String> curChildMap = new HashMap<String, String>();
                        children.add(curChildMap);
                        curChildMap.put(C_TITLE, c2.getString(1).replaceAll("_", " "));
                        curChildMap.put(C_TEXT, "Child ");
                    }while (c2.moveToNext());
                }
            }
            else
            {
                Log.i("tabla", "PR_OFTEN_USED");
                c2 = info.getAllTitlesOftenUsed("PR_Often_Used");
                if (c2.moveToFirst())
                {
                    do{
                        Map<String, String> curChildMap = new HashMap<String, String>();
                        children.add(curChildMap);
                        curChildMap.put(C_TITLE, c2.getString(1).replaceAll("_", " "));
                        curChildMap.put(C_TEXT, "Child ");
                    }while (c2.moveToNext());
                }
            }

            if (children.size() > max)
            {
                max = children.size();
            }
            childData.add(children);
        }
        info.close();

        for ( int i = 0; i < PRLists.size(); i++) {
            List<Map<String, Boolean>> childCB = new ArrayList<Map<String,Boolean>>();
            for (int j = 0; j < max; j++) { //leghosszabb belso lista merete
                Map<String, Boolean> curCB = new HashMap<String, Boolean>();
                childCB.add(curCB);
                curCB.put(C_CB, false);
            }
            childCheckBox.add(childCB);
        }

        adapter = new ExpandBaseAdapter(ProductLists.this,
        groupData, childData, groupCheckBox, childCheckBox);
        exList  = (ExpandableListView) findViewById(R.id.layoutExListView);
        exList.setAdapter(adapter);
        exList.setGroupIndicator(null);
        exList.setDivider(null);

        int groupCount = adapter.getGroupCount();
        for (int i = 0; i < groupCount; i++) {
            exList.collapseGroup(i);
        }

        exList.setOnChildClickListener(new OnChildClickListener() {
            public boolean onChildClick(ExpandableListView parent, View v,
                    int groupPosition, int childPosition, long id) {

                CheckBox checkBox = (CheckBox) v.findViewById(R.id.multiple_checkbox);
                checkBox.toggle();
                if (childCheckBox.get(groupPosition).get(childPosition).get(C_CB)) //ha itt hiba akkor azert van m az adapterben akkor allitok cb statuszt ha van children, es mivel ha nincs akkor ez ertelmezhetetlen
                {
                    childCheckBox.get(groupPosition).get(childPosition).put(C_CB, false);
                }
                else {
                    childCheckBox.get(groupPosition).get(childPosition).put(C_CB, true);
                }

                return false;
            }
        });

        exList.setOnGroupClickListener(new OnGroupClickListener() {

            @Override
            public boolean onGroupClick(ExpandableListView parent, View v, int groupPosition, long id) {

                //Log.i("group position", groupPosition + "");
                Toast.makeText(ProductLists.this, "group position" + groupPosition, Toast.LENGTH_SHORT).show();
                Log.i("PRLists.get(groupPosition)", PRLists.get(groupPosition));
                if (PRLists.get(groupPosition).equals("PR_Often_Used"))
                {

                }
                return false;
            }
        });

        exList.setOnItemLongClickListener(new OnItemLongClickListener() {
            @Override
            public boolean onItemLongClick(AdapterView<?> parent, View view, int position, long id) {
                if (ExpandableListView.getPackedPositionType(id) == ExpandableListView.PACKED_POSITION_TYPE_CHILD) {
                    groupPosition = ExpandableListView.getPackedPositionGroup(id);
                    childPosition = ExpandableListView.getPackedPositionChild(id);

                    selectionList2 = selectionList.toArray(new CharSequence[selectionList.size()]);
                    builder = new AlertDialog.Builder(ProductLists.this);
                    builder.setItems(selectionList2, new DialogInterface.OnClickListener()
                    {
                        public void onClick(DialogInterface dialog, final int item) 
                        {
                            if (selectionList2[item].equals("Rename"))
                            {
                            }
                            if (selectionList2[item].equals("Delete"))
                            {
                            }
                        }
                    });
                    builder.show();
                    return true;
                }
                else if (ExpandableListView.getPackedPositionType(id) == ExpandableListView.PACKED_POSITION_TYPE_GROUP) {
                    groupPosition = ExpandableListView.getPackedPositionGroup(id);
                    Log.i("tablagrp", PRLists.get(groupPosition) + "-" + groupPosition);

                    selectionList2A = selectionListA.toArray(new CharSequence[selectionListA.size()]);
                    builder = new AlertDialog.Builder(ProductLists.this);
                    builder.setItems(selectionList2A, new DialogInterface.OnClickListener()
                    {
                        public void onClick(DialogInterface dialog, final int item) 
                        {
                            if (selectionList2A[item].equals("Add item"))
                            {
                            }
                            else if (selectionList2A[item].equals("Rename group"))
                            {
                            }
                            else if (selectionList2A[item].equals("Delete group"))
                            {
                            }
                        }
                    });
                    builder.show();
                    return true;
                }
                return false;
            }
        });
    }

    public void refreshList() {
        if (PRLists.size() >= 0)  {
            PRLists.clear();
            PRListsID.clear();
        }
        groupData.clear();
        childData.clear();
        groupCheckBox.clear();
        childCheckBox.clear();

        info = new HotOrNot(this);
        info.open();
        //----------------------------query tables--------------------------------
        c = info.showAllTables();
        if (c.moveToFirst())
        {
            do{
                PRLists.add(c.getString(0));
            }while (c.moveToNext());
        }
        if (PRLists.size() >= 0)
        {
            for (int i=0; i<PRLists.size(); i++)
            {
                Log.d("PRLists(" + i + ")", PRLists.get(i) + "");
            }
        }
        ExpandBaseAdapter adapter = new ExpandBaseAdapter(ProductLists.this, groupData, childData, groupCheckBox, childCheckBox);
        ExpandableListView exList  = (ExpandableListView) findViewById(R.id.layoutExListView);
        exList.setAdapter(adapter);
        max = 0;
        for (int i = 0; i < PRLists.size(); i++) 
        {
            Map<String, String> curGroupMap = new HashMap<String, String>();
            groupData.add(curGroupMap);
            curGroupMap.put(G_TEXT, PRLists.get(i).replaceAll("_", " ").substring(2, PRLists.get(i).replaceAll("_", " ").length()));
            ArrayList parent = new ArrayList();
            List<Map<String, String>> children = new ArrayList<Map<String, String>>();
            ArrayList child = new ArrayList();
            c2 = info.getAllTitlesPRtables(PRLists.get(i));
            if (c2.moveToFirst())
            {
                do{
                    Map<String, String> curChildMap = new HashMap<String, String>();
                    children.add(curChildMap);
                    curChildMap.put(C_TITLE, c2.getString(1).replaceAll("_", " "));
                    curChildMap.put(C_TEXT, "Child ");
                }while (c2.moveToNext());
            }
            if (children.size() > max) {
                max = children.size();
            }
            childData.add(children);
        }
        info.close();
        for ( int i = 0; i < PRLists.size(); i++) {
            List<Map<String, Boolean>> childCB = new ArrayList<Map<String,Boolean>>();
            for (int j = 0; j < max; j++) {
                Map<String, Boolean> curCB = new HashMap<String, Boolean>();
                childCB.add(curCB);
                curCB.put(C_CB, false);
            }
            childCheckBox.add(childCB);
        }

        adapter.notifyDataSetChanged();
        //expand only those groups that was expanded by the user
        for (int i = 0; i < grpsfav.size(); i++) {
            Log.i("grpsfav items", grpsfav.get(i));
            exList.expandGroup(Integer.valueOf(grpsfav.get(i)));
        }
    }
    //the Holder class-------------------------------------------------------------------

    static class ViewHolder {
        TextView cTitle;
        // TextView cText;
        CheckBox checkBox;
    }

    public class ExpandBaseAdapter extends BaseExpandableListAdapter {

        String loadedFontSize, loadedFontType, loadedConfDel, loadedshowhints; 
        SharedPreferences sharedPreferences;

        Context mContext;
        private static final String G_TEXT = "G_TEXT";
        //private static final String G_CB = "G_CB";
        private static final String C_TITLE = "C_TITLE";
        private static final String C_TEXT = "C_TEXT";
        private static final String C_CB = "C_CB";

        List<Map<String, String>> groupData = new ArrayList<Map<String, String>>();
        List<List<Map<String, String>>> childData = new ArrayList<List<Map<String, String>>>();

        List<Map<String, Boolean>> groupCheckBox = new ArrayList<Map<String,Boolean>>();
        List<List<Map<String, Boolean>>> childCheckBox = new ArrayList<List<Map<String,Boolean>>>();

        private Context context;

        ViewHolder holder;

        public ExpandBaseAdapter(Context context,
                List<Map<String, String>> groupData, List<List<Map<String, String>>> childData,
                List<Map<String, Boolean>> groupCheckBox, List<List<Map<String, Boolean>>> childCheckBox) {
            this.groupData = groupData;
            this.childData = childData;
            this.groupCheckBox = groupCheckBox;
            this.childCheckBox = childCheckBox;
            this.context = context;
            mContext = context;
        }

        public View getGroupView(int groupPosition, boolean isExpanded,
                View convertView, ViewGroup parent) {
            View view = convertView;
            if (view == null) {
                LayoutInflater inflater = (LayoutInflater) 
                    context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                view = inflater.inflate(R.layout.groupitem, null);
            }
            TextView title = (TextView) view.findViewById(R.id.groupText);
            title.setText(getGroup(groupPosition).toString());
            ImageView image = (ImageView) view.findViewById(R.id.groupBox);
            if (isExpanded) {
                image.setBackgroundResource(R.drawable.expander_ic_maximized);
            }
            else {
                image.setBackgroundResource(R.drawable.expander_ic_minimized);
            }
            return view;
        }

        public long getGroupId(int groupPosition) {
            return groupPosition;
        }

        public Object getGroup(int groupPosition) {
            return groupData.get(groupPosition).get(G_TEXT).toString();
        }

        public int getGroupCount() {
            return groupData.size();
        }

        // **************************************
        public View getChildView(int groupPosition, int childPosition, boolean isLastChild, View convertView, ViewGroup parent) {
            if (convertView == null) 
            {
                LayoutInflater inflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                convertView = inflater.inflate(R.layout.childitem, null);
                holder = new ViewHolder();
                holder.cTitle = (TextView) convertView.findViewById(R.id.child_title);
                holder.checkBox = (CheckBox) convertView.findViewById(R.id.multiple_checkbox);
                convertView.setTag(holder);
            }
            else
            {
                holder = (ViewHolder) convertView.getTag();
            }
            holder.cTitle.setText(childData.get(groupPosition).get(childPosition).get(C_TITLE).toString());
            if (getChildrenCount(groupPosition) > 0) {
                Log.i("chlrden", getChildrenCount(groupPosition) + "");
                holder.checkBox.setChecked(childCheckBox.get(groupPosition).get(childPosition).get(C_CB));
            }
            return convertView;
        }

        public long getChildId(int groupPosition, int childPosition) {
            return childPosition;
        }

        public Object getChild(int groupPosition, int childPosition) {
            return childData.get(groupPosition).get(childPosition).get(C_TITLE).toString();
        }

        public int getChildrenCount(int groupPosition) {
            return childData.get(groupPosition).size();
        }

        // **************************************
        public boolean hasStableIds() {
            return true;
        }

        public boolean isChildSelectable(int groupPosition, int childPosition) {
            return true;
        }
    }

    public void SaveExpanded(String key, String value){
        sharedPreferences = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
        SharedPreferences.Editor editor = sharedPreferences.edit();
        editor.putString(key, value);
        editor.commit();
       }
    public void LoadExpanded(){
        sharedPreferences = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
        loadedexpanded = sharedPreferences.getString("expand", "false");
    }
} 
```

但是，当我再次单击它时，该组关闭，但我没有得到组号。我只有在开群时才知道。

如果我使用

```
exList.setOnGroupClickListener(new OnGroupClickListener() {

    @Override
    public boolean onGroupClick(ExpandableListView parent, View v, int groupPosition, long id) {

        if (groupPosition > 0){
            return true;
        }
         return false;
    }

}); 
```

我两次都得到了组号，但是这些组都没有打开。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T21:02:38.827

但是 onGroupClickListener 无法正常工作，我找到了另一个解决方案。我用过`setOnGroupExpandListener`，`setOnGroupCollapseListener`而且他们的工作很神奇！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T21:44:00.893

在`onCreate()`您设置您的 ExpListView（`findViewById`、适配器、组/子侦听器等）时。但是在`refresh()`您设置 ExpListView 而不设置侦听器时……您只需调用`findViewById`并设置适配器。你必须像你在`onCreate()`.

但是，我认为您没有必要在其中“重新初始化”您的 ExpListView，`refresh()`您可能应该查看您的代码。如果您愿意，我建议您将 ExpListView 定义为成员变量，然后`refresh`删除该行

```
ExpandableListView exList  = (ExpandableListView) findViewById(R.id.layoutExListView); 
```

在你的`refresh`方法中

# php - 符号输出为问号“？”

> ID：10076640
> 
> 赞同：0
> 
> 时间：2012-04-09T16:50:28.317
> 
> 标签：php, twitter

我正在尝试制作一个 twitter 大喊工具。该工具将搜索 Twitter API 以查看谁转发了状态/推文，然后它会向每个用户发送推文。

它将通过遍历此 JSON 提要中的每个屏幕名称来做到这一点： [https](https://api.twitter.com/1/statuses/) : //api.twitter.com/1/statuses/{status_id}/retweeted_by.json

我希望推文的文本如下所示：

![在此处输入图像描述](../Images/c44308b29a3326d4be13d83643414cda.png)

这是我想在推文中出现的文字：

★┏━━┓▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂ ★┃┏━┛╲▂▂▂▂▂▂▂▂▂▂▂▂┈▕└└┗┓▕└└┗┓▕ ━┳┓┏┓┏┓▕▏▕ ★┃┏┫┃┃┃┃┃┃┃┃┃┃┃┃┃▕▏▕ ★┃┃┃┃┃┗┃┫┗┛┃／┃┃┗┃┃┃┃┃┃┃┃┃┃▕▏▕ ★┗┛┗━┻━┻━┻━┻━━━━

然而，这就是它在 twitter 上的显示方式（一堆问号。）： ![在此处输入图像描述](../Images/a92d91c6135679e93d2955019b8fbbf7.png)

有谁知道这里有什么问题？这是什么原因造成的？我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T18:21:01.540

将此添加到文件的最开头（确保在此之前没有空格或行，否则会出现`headers already sent`错误）：

```
<?php header('Content-type: text/html; charset=utf-8');
//Your PHP code
?> 
```

当您执行 时`echo`，将其放在`<pre>`标签内以保留换行符：

```
echo '<pre>' . $yourTweet . '</pre>'; 
```

# java - 无法通过 JQuery 进行身份验证

> ID：10076643
> 
> 赞同：0
> 
> 时间：2012-04-09T16:50:41.697
> 
> 标签：java, javascript, jquery, ajax

当我通过 jquery（跨域）发送 post 请求时，它没有经过身份验证，并且在我通过使用 burp 套件或 http live 标头发送相同的请求时将出现 null，然后它正在工作并且能够进行身份验证，请建议我解决该问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:53:52.030

JavaScript 具有[同源策略](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)。您不能使用 XMLHttpRequest 对象向其他域发出请求。

大多数现代浏览器都支持 CORS，或者如果您可以发出 GET 请求，则可以使用 JSONP。如果您不能使用[CORS](https://developer.mozilla.org/en/http_access_control)或[JSONP](http://en.wikipedia.org/wiki/JSONP)，则需要在服务器上使用代理来发送/检索内容。

# c# - 在 ASP.NET 中放置身份验证检查的位置

> ID：10076644
> 
> 赞同：3
> 
> 时间：2012-04-09T16:50:44.137
> 
> 标签：c#, asp.net, aop

我有一些代码用于确定用户是否已登录，我想将其放在 ASP.NET 网站的每个页面上，以便只有登录的用户才能查看它。问题是该站点被分成多个项目/解决方案，因此维护单个代码可能很困难。

我在想我可以创建一个继承 for`System.Web.UI.Page`和 overrides的类`Page_Init`，但这需要更改所有页面，以便它们从新的新类继承。此外，我认为这不适用于跨项目。

所以我想从另一个方面解决问题：使用 AOP。我以前从未使用过 Aspect，但看起来我可以使用 PostSharp 编写一个在每个`Page_Init`（或者可能`Page_Load`？）之前注入代码的 Aspect。这可能是一个快速的解决方案，但如果我需要一个页面来不执行身份验证检查（每个人都可用），我可能会遇到问题。

澄清一下，我已经有了一个登录解决方案；我只是在寻找每个页面上的登录信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:55:22.743

查看 HttpModules。asp.net 框架已经被编程，因此每个页面请求都会运行一个模块，您只需编写它并将其添加到 web.config 中。

[http://msdn.microsoft.com/en-us/library/zec9k340(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/zec9k340(v=vs.71).aspx)

编辑：这是一个更好的链接，演示处理 BeginRequest 事件 [http://msdn.microsoft.com/en-us/library/ms227673(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms227673(v=vs.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:58:29.587

正如@jrummell 提到的，[`MembershipProvider`](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.aspx)这是一个很好的选择，但是如果您正在创建自定义登录 solition，请查看这个[链接](http://support.microsoft.com/kb/301240)，它有一个非常简单的逐步登录实现

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T17:20:31.257

由于您似乎已经处理了您的登录解决方案并且可以正常工作，因此创建一个覆盖 page_init 的类听起来是您的最佳选择。这可以通过简单地在一个单独的项目中创建该类来跨其他项目工作，您可以将其包含在您的其他解决方案中......老实说，这是跨越多个项目的逻辑的最简单方法......这也将是易于维护，因为您只需要更新一个位置。

如果您使用 MasterPages，则不必点击所有页面，您只需将其包含在特定的 MasterPage(s) 中，然后设置您想要验证的所有页面以使用该 MasterPage。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T16:59:50.653

Windows Identity Foundation 可以为您解决这个问题。有关 WIF 的详细信息，请参阅[http://msdn.microsoft.com/en-us/security/aa570351](http://msdn.microsoft.com/en-us/security/aa570351)。无需重新发明轮子。如果您只有一个 Web 应用程序，Forms 身份验证就足够了。

# android - 前台服务与 PARTIAL_WAKE_LOCK 的关系

> ID：10076653
> 
> 赞同：4
> 
> 时间：2012-04-09T16:51:19.127
> 
> 标签：android, service, power-management

我知道前台服务有“不太可能杀死”的行为。根据Android文档：

> 理论上，在当前前台应用程序的极端内存压力下，服务仍然可能被杀死，但实际上这不应该是一个问题。

我认为这解决了大多数情况下内存不足的问题。但是我找不到任何关于在前台服务运行时 CPU 是否进入睡眠状态的文档。

1.  前台服务会自动获取**PARTIAL_WAKE_LOCK**还是必须在需要时显式调用它？

2.  有什么方法可以检查/记录哪些应用程序/服务正在使用 PARTIAL_WAKE_LOCK？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T00:48:34.233

Android**前台**服务和**PARTIAL_WAKE_LOCK**没有任何关系。

前台服务 -> 它告诉操作系统将您的服务放在最高优先级队列中。如果操作系统出于任何原因需要内存，它将在最后终止您的服务，并且它将以最低优先级的队列开始（我相信有 5 个优先级队列，前景是最高的）。

PARTIAL_WAKE_LOCK -> 它告诉操作系统在设备进入睡眠状态时不要让 CPU 进入睡眠状态（无论何时发生这种情况）。

因此，即使您有前台服务，如果设备进入睡眠状态，cpu 也可能进入睡眠状态（如果其他应用程序获得了 PARTIAL_WAKE_LOCK，则可能不会）。我认为没有办法以编程方式检查哪些应用程序获得了唤醒锁，但您可以将设备插入 DDMS，当有人获得唤醒锁时，您会看到 PowerManager 日志。

希望能帮助到你 ！

# c# - 如何为 Windows Phone 模拟器配置网络访问？

> ID：10076657
> 
> 赞同：1
> 
> 时间：2012-04-09T16:51:39.693
> 
> 标签：c#, windows-phone-7, fiddler, windows-phone-7-emulator

我正在尝试调试正在`WebRequest`同步制作的应用程序，即：

```
HttpWebRequest req = WebRequest.Create(new Uri("http://www.stackoverflow.com/")) as HttpWebRequest;

IAsyncResult res = req.BeginGetResponse(callback => { }, req);
while (!res.IsCompleted)
{
    System.Threading.Thread.Sleep(100);
}
// Doesn't matter what's here, as `res.IsCompleted` never returns true 
```

这只是为了检查一些应用程序逻辑是否“正确”，但它被卡住了，`IAsyncResult`永远不会报告自己是完整的。

为了检查，我尝试在模拟器上使用 Internet Explorer，但发现无法找到*任何*网页（包括内置的收藏夹），这让我认为模拟器试图在我的笔记本电脑上使用特定的网络接口，但是好像没有什么办法可以配置，或者使用哪个接口？我怀疑它可能正在尝试使用 VPN 接口，或者像 VirtualBox 那样的虚拟适配器。那么，我该如何配置呢？此外，您是否希望模拟器发出的请求会出现在 Fiddler 中？

作为记录，`NetworkInterface.GetIsNetworkAvailable()`返回`true`；

**更新：**

看来更新我的图形驱动程序（以及相关的重新启动）允许模拟器访问真实网络（或至少猜测正确的适配器）；但是，`res.IsCompleted`仍然没有报告真实（并且 Fiddler 显示请求已完成），所以我有点困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:22:39.020

您是否使用了代理？Windows Phone 模拟器与当前活动的 Internet 连接以及代理设置相关联。确保这些设置正确。此外，可能有防火墙阻止了 XDE 的 Internet 访问 - 也请检查设置。

我建议让[Fiddler](http://www.fiddler2.com/fiddler2/)。尝试将其[配置](http://blogs.msdn.com/b/fiddler/archive/2010/10/15/fiddler-and-the-windows-phone-emulator.aspx)为捕获模拟器流量并查看您可以从那里获得哪些信息。

# c# - C# 中服务器客户端应用程序的 UDP 数据报代码

> ID：10076658
> 
> 赞同：2
> 
> 时间：2012-04-09T16:51:42.900
> 
> 标签：c#, winforms, sockets, udp, udpclient

当我尝试从客户端发送消息时，服务器无法接收并打印该消息。谁能告诉我以下服务器客户端应用程序中的错误。

我创建了两个 WinForm 项目，一个是 UDP 服务器，另一个是 UDP 客户端。

在 UDP 服务器项目中，我创建了一个表单，其中包含一个名为richTextBox1 的 RichTextBox 来显示消息和一个名为 btStart 的按钮来启动/停止监听。这是代码片段：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.Net.Sockets;
using System.Threading;

namespace UDPServer
{
public partial class Form1 : Form
{
    delegate void ShowMessageMethod(string msg);

    UdpClient _server = null;
    IPEndPoint _client = null;
    Thread _listenThread = null;
    private bool _isServerStarted = false;

    public Form1()
    {
        InitializeComponent();
    }
    private void serverMsgBox_Load(object sender, EventArgs e)
    {
        this.btStart.Text = "StartServer";
    } 

    private void Form1_Load(object sender, EventArgs e)
    {

    }

    private void btStart_Click(object sender, EventArgs e)
    {
        if (_isServerStarted)
        {
            Stop();
            btStart.Text = "StartServer";
        }
        else
        {
            Start();
            btStart.Text = "StopServer";
        }

    }
    private void Start()
    {
        //Create the server.
        IPEndPoint serverEnd = new IPEndPoint(IPAddress.Any, 1234);
        _server = new UdpClient(serverEnd);
        ShowMsg("Waiting for a client...");
        //Create the client end.
        _client = new IPEndPoint(IPAddress.Any, 0);

        //Start listening.
        Thread listenThread = new Thread(new ThreadStart(Listening));
        listenThread.Start();
        //Change state to indicate the server starts.
        _isServerStarted = true;
    }

    private void Stop()
    {
        try
        {
            //Stop listening.
            listenThread.Join();
            ShowMsg("Server stops.");
            _server.Close();
            //Changet state to indicate the server stops.
            _isServerStarted = false;
        }
        catch (Exception excp)
        { }
    }

    private void Listening()
    {
        byte[] data;
        //Listening loop.
        while (true)
        {
            //receieve a message form a client.
            data = _server.Receive(ref _client);
            string receivedMsg = Encoding.ASCII.GetString(data, 0, data.Length);
            //Show the message.
            this.Invoke(new ShowMessageMethod(ShowMsg), new object[] { "Client:" + receivedMsg });
            //Send a response message.
            data = Encoding.ASCII.GetBytes("Server:" + receivedMsg);
            _server.Send(data, data.Length, _client);
            //Sleep for UI to work.
            Thread.Sleep(500);
        }
    }
    private void ShowMsg(string msg)
    {
        this.richTextBox1.Text += msg + "\r\n";
    }
}
} 
```

在 UDP 客户端项目中，我还创建了一个表单，其中包含一个名为 RichTextBox1 的 RichTextBox 用于输入或显示消息，一个名为 btSend 的按钮用于发送输入消息。您可以运行该项目的多个实例。服务器将处理所有正在运行的客户端。这是代码片段：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net.Sockets;
using System.Net;
using System.Threading;

namespace UDPClient
{
public partial class Form1 : Form
{
    UdpClient _server = null;
    IPEndPoint _client = null;

    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }
   private void serverMsgBox_Load(object sender, EventArgs e)
    {
        //Get the server.
        _server = new UdpClient("127.0.0.1", 16000);
        //Create a client.
        _client = new IPEndPoint(IPAddress.Any, 0);
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        try
        {
            _server.Close();
        }
        catch (Exception s)
        { 
        }
    }

    private void btSend_Click(object sender, EventArgs e)
    {
        try
        {
            //Send the input message.
            string text = this.richTextBox1.Text;
            _server.Send(Encoding.ASCII.GetBytes(text), text.Length);
            //Receive the response message.
            byte[] data = _server.Receive(ref _client);
            string msg = Encoding.ASCII.GetString(data, 0, data.Length);
            //Show the response message.
            this.richTextBox1.Text = msg;
        }
        catch (Exception exp)
        { 

        }
    }

}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T18:46:18.670

你没有设置你的目的地。您需要在使用[UdpClient.Send](http://msdn.microsoft.com/en-us/library/c4w4cta7.aspx) [(Byte[], Int32)](http://msdn.microsoft.com/en-us/library/08h8s12k.aspx)之前使用 UdpClient.Connect或使用[UdpClient.Send(Byte[], Int32, IPEndPoint)](http://msdn.microsoft.com/en-us/library/82dxxas0.aspx)。

# php - pdo 中的 DSN 设置不起作用

> ID：10076660
> 
> 赞同：1
> 
> 时间：2012-04-09T16:51:47.947
> 
> 标签：php, mysql, ubuntu, pdo

尝试在 pdo 的 dsn 中设置主机，如下所示：

```
<?php
/* Connect to an ODBC database using driver invocation */
$dsn = 'mysql:dbname=xxx_online;host=192.168.1.105;';
$user = 'username';
$password = 'password';

try {
        $dbh = new PDO($dsn, $user, $password);
} catch (PDOException $e) {
        echo 'Connection failed: ' . $e->getMessage();
}
?> 
```

现在可以了。我误解了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:59:28.300

该错误意味着您的用户名和/或密码不正确，（或实际上并未在您的服务器上设置）。它在您的其他服务器上工作的原因是因为该用户存在于那里。

您需要检查您的 PHP 文件中设置了正确的用户名和密码，或者您需要创建一个新的 MySQL 用户，并使用该服务器的新用户名和密码进行连接。

[http://dev.mysql.com/doc/refman/5.1/en/adding-users.html](http://dev.mysql.com/doc/refman/5.1/en/adding-users.html)

如果您不习惯从命令行执行此操作，您可以通过安装phpMyAdmin[并](http://www.phpmyadmin.net/home_page/index.php)`apt-get`通过 Web 界面执行此操作。

# entity-framework-4.1 - EF Fluent 定义外部主键

> ID：10076661
> 
> 赞同：2
> 
> 时间：2012-04-09T16:51:52.373
> 
> 标签：entity-framework-4.1, fluent

我已经定义了一组 Code First 实体，如下所示：

```
public class User
{
    public int UserId { get; set; }
    public string username { get; set; }
}
public abstract class UserType
{
    public virtual User User { get; set; }
    public int UserId { get; set; }
}
public class RoleUser : UserType
{
    public string role { get; set; }
}
public class SiteUser : UserType
{
    public string site { get; set; }
}

public class Testctx:DbContext
{
    static Testctx()
    {
        Database.SetInitializer(new DropCreateDatabaseAlways<Testctx>());
    }

    public DbSet<User> Users { get; set; }
    public DbSet<SiteUser> SiteUsers { get; set; }
    public DbSet<RoleUser> RoleUsers { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<User>().HasKey(u=>u.UserId).ToTable("User");
        modelBuilder.Entity<RoleUser>().HasKey(u => u.UserId).ToTable("RoleUser");
        modelBuilder.Entity<SiteUser>().HasKey(u => u.UserId).ToTable("SiteUser");
    }

} 
```

如果我希望 User、RoleUser、SiteUser 每个都有一个名为“ID”的 ID 列，我该如何实现这一点，同时在 Usertype 中保持与用户的外主键关系。

例如，如果我声明 public class Entity{ public int ID {get;set;}} 并且都从 Entity 继承，我会在 RoleUser 和 SiteUser 中留下一个 UserId 和一个 ID 字段。

# asp.net-mvc-3 - 网格设计的编辑弹出框

> ID：10076664
> 
> 赞同：0
> 
> 时间：2012-04-09T16:52:11.147
> 
> 标签：asp.net-mvc-3, asp.net-mvc-partialview

我正在编写一个 MVC3 项目。现在我有一个表，其中包含 Data as actionLinks 列：

```
<td style="color: Black; background-color: Bisque; text-align: center; width: 410px">
   @Html.ActionLink(@item.LookUp_NameString, "EditPartial", "Capitation", new { id = item.CAPITATION_RATE_ID }, new { @class = "actionLink" })
</td> 
```

EditPartial 顾名思义是一个局部视图，我需要将其作为弹出菜单打开，以便用户可以编辑对象的详细信息，保存它，然后我们可以返回原始页面。

我已经尝试过渲染部分，但无法让它动态传递 id 值。

这是为了我的网格的编辑功能。实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:06:46.690

如果要在模型弹出窗口中打开 EditPartial Action 方法的结果，则需要一些模型弹出代码。

jQuery UI 是一种选择。[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

**1)**在您的页面中包含 jQuery UI 参考，

**2）**将以下脚本添加到您的页面，这会将您的正常链接转换为模型弹出窗口

```
<script type="text/javascript">
    $(function(){
        $(".actionLink").click(function (e) {
            var url = this.href;
            var dialog = $("#dialog");
            if ($("#dialog").length == 0) {
                dialog = $('<div id="dialog" style="display:hidden"></div>').appendTo('body');
            }
            dialog.load(
                url,
                {}, // omit this param object to issue a GET request instead a POST request, otherwise you may provide post parameters within the object
                function (responseText, textStatus, XMLHttpRequest) {
                    dialog.dialog({                       
                        close: function (event, ui) {                            
                            dialog.remove();
                        },
                        modal: true,
                        width: 460, resizable: false
                    });
                }
            );           
            return false;           
        });
    });
    </script> 
```

从您的操作结果中，您可以返回要在模型弹出窗口中显示的任何标记。大多数情况下，您将返回一个视图。如果要显示部分视图，如果是 ajax 请求，如果是正常请求则显示正常视图，您可以检查 Request.IsAjaxRequest 方法来做到这一点。

```
public ActionResult EditPartial(int id)
{
  CustomerViewModel objCustomer=GetCustomer(id);
  if(Request.IsAjaxRequest())
  {
     return View("Partial/Edit",objCustomer);
  }
  return View(objCustomer);

} 
```

假设您有 2 个视图来显示您的正常页面和部分页面（用于模型弹出窗口）

我更喜欢将我的操作方法命名为，`Edit`而不是`EditPartial`，因为它同时处理请求（ajax 和普通）

# nicedit - 触发，甚至当 nicedit 工具栏按钮已完成执行或已被单击时

> ID：10076667
> 
> 赞同：1
> 
> 时间：2012-04-09T16:52:25.653
> 
> 标签：nicedit

我正在尝试为使用“nicedit”编辑器输入的某些内容创建和自动预览机制。当单击“粗体”等按钮以更新预览面板时，我需要绑定或收到警报。如何使用此功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:48:20.233

我最终使用 Google Mutations 库来收听对预览页面所做的更改，而不是收听按钮事件。最终成为我更好的选择。

# objective-c - 在项目中全局声明 UIColor

> ID：10076670
> 
> 赞同：4
> 
> 时间：2012-04-09T16:52:44.187
> 
> 标签：objective-c, ios, xcode, uicolor

> **可能重复：**
> [Objective C 定义 UIColor 常量](https://stackoverflow.com/questions/2824187/objective-c-defining-uicolor-constants)

我想在我的应用程序中使用几种颜色。除了在每个实例或每个 viewController 中创建 UIColor 之外，还有一种方法可以让我在整个应用程序中使用它。

或者使用 ColourConstants.h 头文件是明智的，我在其中 #define 我想使用的每种颜色

IE

```
#define SCARLET [UIColor colorWithRed:207.0/255.0 green:47.0/255.0 blue:40.0/255.0 alpha:1]; 
```

提前致谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-09T17:12:46.207

我会在 UIColor 上使用一个类别。例如：

```
// In UIColor+ScarletColor.h

@interface UIColor (ScarletColor)

+ (UIColor*)scarletColor;

@end

// In UIColor+ScarletColor.m

@implementation UIColor (ScarletColor)

+ (UIColor*)scarletColor {
    return [UIColor colorWithRed:207.0/255.0 green:47.0/255.0 blue:40.0/255.0 alpha:1];
}

@end 
```

当你想使用颜色时，你只需要这样做：

```
#import "UIColor+ScarletColor.h"

....

UIColor *scarlet = [UIColor scarletColor]; 
```

希望能帮助到你！！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T17:00:41.617

宏更方便，因为它只在一个地方定义。

但它仍然会在每次使用时创建一个新实例，因为宏只是预处理器的文本替换。

如果你想拥有一个唯一的实例，你必须使用`FOUNDATION_EXPORT`（这意味着`extern`）。

在公共 .h 文件中，声明以下内容：

```
FOUNDATION_EXPORT UIColor * scarlet; 
```

这将告诉编译器该`scarlet`变量（类型`UIColor`）将存在于某个点（当程序链接时）。
因此，它将允许您使用它。

然后您需要在 .m 文件中创建该变量。
您不能直接分配它的值，因为它是运行时值，所以只需将其设置为 nil：

```
UIColor * scarlet = nil; 
```

然后，在您的程序中的某个点（可能在您的应用程序的委托中），设置它的值：

```
scarlet = [ [ UIColor ... ] retain ]; 
```

不要忘记保留它，因为它是一个全局变量，需要在程序的整个生命周期中都存在。

这样，您只有一个实例，可以从任何地方访问。

# ruby-on-rails - rails app root 中的“th-ruby-include=”目录是什么？

> ID：10076671
> 
> 赞同：0
> 
> 时间：2012-04-09T16:52:44.563
> 
> 标签：ruby-on-rails

`th-ruby-include= directory`Rails 应用程序根目录中有什么？

我没有碰它。

我正在考虑将此目录添加到`.gitigore`或每次看到它时将其删除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:00:04.100

如果这是您项目中的一个目录，那么它是在 Rails 之外创建的。您的编辑可能在您没有完全理解的情况下保存了文件。

我通常会说你可以删除它，但不知道内容很难说。您始终可以移动目录，运行测试，如果一切顺利，则删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T11:38:52.713

I also had this directory in my application root. In my case it contained a tree of files that looked related to rvm. I was bold and just deleted it. Everything appears to be fine afterwards.

If I find that it reappears then I will work out what I did to make that happen and I will post an update here.

# css - 覆盖孙元素的父 .resizable 属性，也许使用 css？

> ID：10076672
> 
> 赞同：0
> 
> 时间：2012-04-09T16:52:48.417
> 
> 标签：css, jquery-ui

我有一个 .resizable() 的主要父 div。其中一个是子 div，比如 bottomChild 有很多其他子 div，它们也会调整大小。但是，它们有文本，并且该文本不会调整大小，因此与其他同级 div 内容重叠。我想要的是让他们不调整大小，而是让滚动条出现，以便用户可以滚动bottomChild并查看内容。我在另一个子 Div 中有一个 GridView，比如 topChild，这会自动发生在 GridView 上。我也想为 bottomChild 模拟这个。有谁知道怎么做？

这是一个正在运行的示例 - [http://jsfiddle.net/xgCDy/33/](http://jsfiddle.net/xgCDy/33/) 尝试调整黑色父 div 的大小并查看内容重叠。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:01:50.193

我已经解决了你的问题：http: [//jsfiddle.net/WGknf/embedded/result/](http://jsfiddle.net/WGknf/embedded/result/)

只需删除一些额外的代码：D

[http://jsfiddle.net/WGknf/](http://jsfiddle.net/WGknf/)

不要使用相对（％）高度。当您使用可拖动的 div 时！！！！

# linux - 更改文本文件中的行（如果存在）

> ID：10076675
> 
> 赞同：1
> 
> 时间：2012-04-09T16:53:07.870
> 
> 标签：linux, bash, replace, sed, line

我知道您可以在 bash 中使用 sed 更改文本文件中的一行，显示类似的内容；

name="applicationname" //这不是问题（它会有所不同，这就是我使用 var 的原因）

描述： http: [//google.com](http://google.com) 或描述：http: [//yahoo.com](http://yahoo.com) //有时描述中的“价值”会有所不同

至

描述：[http](http://mysite.com/depiction.php?package=applicationname) ://mysite.com/depiction.php?package=applicationname //这是我想要实现的格式

通过使用 sed，但我不完全确定如何实现 sed。 [http://www.gnu.org/software/sed/](http://www.gnu.org/software/sed/)

编辑：这就是我刚刚想出的

```
sed -i "s!Depiction:.*!Depiction: http://mysite.com/depiction.php?package=$name!" ./inputfile 
```

如果在这个特定的文本文件中没有“描述：”怎么办？我如何插入一行：描述：[http](http://mysite.com/depiction.php?package=applicationname) ://mysite.com/depiction.php?package=applicationname ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:44:01.977

我已经设法通过许多试验和错误找到了答案......所以只是为了分享。:)

```
if grep -Fq "Depiction:" ./file
then
sed -i "s!Depiction:.*!Depiction: http://mysite.com/depiction.php?package=$name" ./file
else
sed -i 1i"Depiction: http://mysite.com/depiction.php?package=$name" ./file
fi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:10:25.650

您可以这样尝试：删除“描述：”的所有实例，然后附加您想要的行

```
{
  grep -v "Depiction:" filename
  echo "Depiction: ..."
} > newfile && mv newfile filename 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T16:59:06.530

sed 对于简单的替换最有价值。一旦你有了“如果没有找到，就做 X”这样的逻辑，你应该转向更通用的语言。我喜欢[Python](http://docs.python.org/tutorial/introduction.html)：

```
from sys import argv, stdout

filename = argv[1]
depiction_found = False
for line in open(filename):
    line.replace('foo', 'bar') #I'm not too sure what you're really trying to do
    if line.startswith("Depiction: "):
        depiction_found = True
    stdout.write(line)

if not depiction_found:
    stdout.write("Depiction: <correct value here>\n") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T20:35:48.550

This might work for you:

```
sed -i '/Depiction:.*/{h;s||Depiction: http://mysite.com/depiction.php?package='"$name"'|};$!b;x;/./{x;q};x;a\Depiction: http://mysite.com/depiction.php?package='"$name" ./inputfile 
```

or perhaps as the barebones:

```
sed -i '/foo/{h;s//FOO/};$!b;x;/./{x;q};x;a\FOO' file 
```

In essence:

*   If `foo` exists, make a copy in the hold space (HS) and carry out substitution.
*   At end of file (`$`) check the hold space for evidence or previous substitution and if none append a line.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T17:01:02.367

如果您不关心订单，请删除它，然后添加。或者使用 awk：

```
awk 'BEGIN{replacement="Depiction: http://mysite.com/depiction.php?package=applicationname"}/^Depiction:/{print replacement;found=1}!/^Depiction:/{print}END{if(!found)print replacement}' < file 
```

或任何其他高阶语言。

# c# - 从数据库自动完成

> ID：10076676
> 
> 赞同：0
> 
> 时间：2012-04-09T16:53:11.613
> 
> 标签：c#, javascript, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-3-areas

大家好，我的显示所有游戏视图中有以下 JavaScript 代码：

```
<script>
    $('#SearchBox').autocomplete({ source: '/Controller/ShowAllGames' });
</script> 
```

和以下代码在我的 ShowAllGames 控制器中运行我的自动完成功能：

```
public ActionResult AutoCompleteGames(string term)
    {
        var db = new gamezoneDBEntities();
        return Json(db.tblGames.Where(games => games.GameName.StartsWith(term)).Select(games => games.GameName), JsonRequestBehavior.AllowGet);

    } 
```

我不知道为什么我的自动完成功能不起作用，因为我在我的数据库中键入我的信息或单词没有出现。脚本引用的搜索框也如下：

```
@using (Html.BeginForm())
{
    <div id="SearchBorder">
    <div id="TopSearch">

        @Html.TextBox("DisplaySearchResults", "", new { style = "width:420px;" }) 
        <input id="SearchBox" type="submit" value="Search news archives"/>
        </div>
         </div>
} 
```

我有一个搜索框并启用了分页功能一切正常只是想知道为什么我的自动完成功能不起作用

谢谢

如果您需要其他信息，请询问我，我将提供谢谢

编辑：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using PagedList;
using GamesTest.Models;

namespace GamesTest.Controllers
{
    public class ShowAllGamesController : Controller
    {
        //
        // GET: /ShowAllGames/

        public ActionResult Index(string Ordering, string WordFilter, string DisplaySearchResults, int? CounterForPage)
        {
            using (var db = new gamezoneDBEntities())
            {

                ViewBag.Message = TempData["message"];
                ViewBag.CurrentSort = Ordering;
                ViewBag.NameSortParm = String.IsNullOrEmpty(Ordering) ? "GameName" : "";
                ViewBag.DateSortParm = Ordering == "ReleaseYearOfGame" ? "DiscriptionOfGame" : "Date";

                {
                    TempData["DisplaySearchResult"] = DisplaySearchResults;

                    {
                        ViewBag.search = DisplaySearchResults;
                    }
                    if (Request.HttpMethod == "GET")
                    {
                        DisplaySearchResults = WordFilter;
                    }
                    else if (DisplaySearchResults == "")
                    {
                        ViewData["MyMessage"] = "Nothing Has Been Entered.";

                    }

                    else
                    {
                        CounterForPage = 1;
                    }

                    ViewBag.CurrentFilter = DisplaySearchResults;

                    var FullDatabaseItem = from b in db.tblGames
                                           select b;
                    if (!String.IsNullOrEmpty(DisplaySearchResults))
                    {
                        FullDatabaseItem = FullDatabaseItem.Where(b => b.GameName.ToUpper().Contains(DisplaySearchResults.ToUpper()));

                    }
                    switch (Ordering)
                    {
                        case "HeadlineName":
                            FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.GameName);
                            break;
                        case "DatePosted":
                            FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.ReleaseYear);
                            break;
                        case "DiscriptionDate":
                            FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.ReleaseYear);
                            break;
                        default:
                            FullDatabaseItem = FullDatabaseItem.OrderByDescending(b => b.ReleaseYear);
                            break;
                    }

                    int pageSize = 3;
                    int pageNumber = (CounterForPage ?? 1);
                    var PageNumberResults = FullDatabaseItem.ToPagedList(pageNumber, pageSize);
                    ViewBag.PageNumberResults = FullDatabaseItem.Count();
                    if (PageNumberResults.Any())
                    {

                        return View(PageNumberResults);
                    }

                    return View("ErrorView");
                }
            }
        }

        public ActionResult AutoCompleteGames()
        {
            var db = new gamezoneDBEntities();
            string term = this.Request.Params["term"].ToString();
            return Json(db.tblGames.Where(games => games.GameName.StartsWith(term)).Select(games => games.GameName), JsonRequestBehavior.AllowGet);

        } 

        //
        // GET: /ShowAllGames/Details/5

        public ViewResult Details(int id)
        {
            using (var db = new gamezoneDBEntities())
            {
                tblGame tblgame = db.tblGames.Find(id);
                return View(tblgame);
            }
        }

        //
        // GET: /ShowAllGames/Create

        public ActionResult Create()
        {
            return View();
        } 

        //
        // POST: /ShowAllGames/Create

        [HttpPost]
        public ActionResult Create(FormCollection collection)
        {
            try
            {
                // TODO: Add insert logic here

                return RedirectToAction("Index");
            }
            catch
            {
                return View();
            }
        }

        //
        // GET: /ShowAllGames/Edit/5

        public ActionResult Edit(int id)
        {
            return View();
        }

        //
        // POST: /ShowAllGames/Edit/5

        [HttpPost]
        public ActionResult Edit(int id, FormCollection collection)
        {
            try
            {
                // TODO: Add update logic here

                return RedirectToAction("Index");
            }
            catch
            {
                return View();
            }
        }

        //
        // GET: /ShowAllGames/Delete/5

        public ActionResult Delete(int id)
        {
            return View();
        }

        //
        // POST: /ShowAllGames/Delete/5

        [HttpPost]
        public ActionResult Delete(int id, FormCollection collection)
        {
            try
            {
                // TODO: Add delete logic here

                return RedirectToAction("Index");
            }
            catch
            {
                return View();
            }
        }
    }
} 
```

我的观点：

```
@model PagedList.IPagedList<GamesTest.tblGame>

@{
    ViewBag.Title = "Index";
}

@*<h2>Index</h2>*@

@using (Html.BeginForm())
{
    <div id="SearchBorder">
    <div id="TopSearch">

        @Html.TextBox("DisplaySearchResults", "", new { style = "width:420px;" }) 
        <input id="SearchBox" type="submit" value="Search news archives"/>
        </div>
         </div>
}

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
<script src="../../Scripts/jquery-1.5.1.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.ui.autocomplete.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.ui.position.js" type="text/javascript"></script>
<script src="../../Scripts/jquery-ui-1.8.11.min.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.ui.core.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.ui.widget.js" type="text/javascript"></script>

<p>
@*    @Html.ActionLink("Create New", "Create")*@
</p>
<table id = "OverAll">
@*    <tr>
        <th>
            GameID
        </th>
        <th>
            GameName
        </th>
        <th>
            ReleaseYear
        </th>
        <th>
            Cost
        </th>
        <th>
            Description
        </th>
        <th>
            Downloads
        </th>
        <th>
            Image
        </th>
        <th>
            Console
        </th>
        <th>
            UserName
        </th>
        <th></th>
    </tr>*@

@foreach (var item in Model) {
    <tr>
     @*   <td>
            @Html.HiddenFor(modelItem => item.GameID)
        </td>*@

        <td id = "TableLayout1">
            <img width="100" height="100"alt="ImageFromDatabase" src='@item.Image' />
        </td>
        <td id = "TableLayout2">
            @*@Html.DisplayFor(modelItem => item.GameName)*@
             @Html.ActionLink(item.GameName, "Details", new { id = item.GameID })
        </td>

         <td id = "TableLayout3">
            @Html.DisplayFor(modelItem => item.ReleaseYear)
        </td>
        <td id = "TableLayout4">
          @Html.Raw(item.Description.Substring(0, item.Description.IndexOf(".") + 1))
           @* @Html.DisplayFor(modelItem => item.Description)*@
        </td>
        <td id = "TableLayout5">
            @Html.DisplayFor(modelItem => item.Cost)
        </td>

        <td id = "TableLayout6">
            @Html.DisplayFor(modelItem => item.Downloads) @*want this as a link so I can then click on it and show the game downloads*@

        </td>

        <td id = "TableLayout7">
            @Html.DisplayFor(modelItem => item.ConsoleNameIDFK)
        </td>
        @*<td>
            @Html.HiddenFor(modelItem => item.UserName)
        </td>*@
     @*   <td>
            @Html.ActionLink("Edit", "Edit", new { /* id=item.PrimaryKey */ }) |
            @Html.ActionLink("Details", "Details", new { /* id=item.PrimaryKey */ }) |
            @Html.ActionLink("Delete", "Delete", new { /* id=item.PrimaryKey */ })
        </td>*@
    </tr>
}

</table>
@*Below is coding for the page count and the number of results found with the serach result displayed*@

 <div class="PageCounter">
    Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber)
    of @Model.PageCount
    &nbsp;
    @if (Model.HasPreviousPage)
    {

        @Html.ActionLink("<<", "Index", new { CounterForPage = 1, Ordering = ViewBag.CurrentSort, WordFilter = ViewBag.WordFilter })
        @Html.Raw("&nbsp;");
        @Html.ActionLink("< Previous Page", "Index", new { CounterForPage = Model.PageNumber - 1, Ordering = ViewBag.CurrentSort, WordFilter = ViewBag.WordFilter })
    }
    else
    {
        @:<<
        @Html.Raw("&nbsp;");
        @:< Prev
    }
    &nbsp;
    @if (Model.HasNextPage)
    {
        @Html.ActionLink("Next Page >", "Index", new { CounterForPage = Model.PageNumber + 1, Ordering = ViewBag.CurrentSort, WordFilter = ViewBag.CurrentFilter })
        @Html.Raw("&nbsp;");
        @Html.ActionLink(">>", "Index", new { CounterForPage = Model.PageCount, Ordering = ViewBag.CurrentSort, WordFilter = ViewBag.CurrentFilter })
    }
    else
    {
        @:Next>
        @Html.Raw("&nbsp;")
        @:>>
    }

    @String.Format("Total of {0} results", ViewBag.PageNumberResults)
    (For @ViewBag.Search)

@*    @if(ViewBag.Message != null)
{
   <p>@ViewBag.Message</p>
}
*@

</div>

<script type="text/javascript">
    var uvOptions = {};
    (function () {
        var uv = document.createElement('script'); uv.type = 'text/javascript'; uv.async = true;
        uv.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'widget.uservoice.com/ZRhsC1RL1m4gK5megTxxlw.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(uv, s);
    })();
</script>

<script type="text/javascript">
    $('#DisplaySearchResults').autocomplete({ source: '/Controller/ShowAllGames' });
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:57:18.877

一个问题是你让你的按钮自动完成而不是你的文本框。将您的自动完成初始化更改为以下内容：

```
$('#DisplaySearchResults').autocomplete({ source: '/Controller/ShowAllGames' }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:26:48.357

除了 jrummell 指出的问题外，您的 source 参数与您的操作名称不匹配。

```
<script>
    $('#SearchBox').autocomplete({ source: '/ShowAllGames/AutoCompleteGames' });
</script> 
```

我怀疑您在搜索框中输入时遇到 404 错误。

**编辑**

好吧，你没有得到 404 对我来说没有意义，但试试这个；从您的操作中删除参数`string term`并使用

```
string term = this.Request.Params["term"].ToString(); 
```

在你的职能范围内。如果我没记错的话，模型绑定器不会按预期设置该参数。

# qt - Qt 中的卸载插件

> ID：10076677
> 
> 赞同：3
> 
> 时间：2012-04-09T16:53:20.973
> 
> 标签：qt, plugins, qt4

当我尝试卸载已加载的插件并加载新插件时出现问题。所以两个插件都正确加载了，但是在切换它们时（第一个加载，第二个卸载，反之亦然）我的应用程序崩溃了。可能是什么问题？

首先我在做什么我尝试卸载存储到 QPluginLoader 的 QList 中的插件，然后我检查（取决于从用于加载插件的特殊菜单传递的 id（整数））要加载的插件。第一次加载很好（第一个插件已加载，此时没有要卸载的内容），第二次加载（卸载第一个插件，第二个已加载），在第三次加载时我崩溃了

```
void MainWindow::loadPluginUsingId (int plugin_id) {

        foreach (QPluginLoader* pluginLoader, plugins) {        
                 pluginLoader->unload();
                 delete pluginLoader;
               }

         switch (plugin_id) {

           case 0 : {

            foreach (QString fileName, pluginDir.entryList(QDir::Files)) {
               if (fileName == fullNameOfPlugins.value(plugin_id)) {
                     QPluginLoader* pluginLoader = new QPluginLoader(pluginDir.absoluteFilePath(fileName));
                     QObject *plugin = pluginLoader->instance();

                     IndicatorInterface *indicator = qobject_cast<IndicatorInterface*>(plugin);
                     indicator->initIndicator();
                     plugins.append(pluginLoader);
                 }
             }
         }

         break;
          case 1 : {

             foreach (QString fileName, pluginDir.entryList(QDir::Files)) {

                 if (fileName == fullNameOfPlugins.value(plugin_id)) {

                       QPluginLoader* pluginLoader = new          QPluginLoader(pluginDir.absoluteFilePath(fileName));
                       QObject* plugin = pluginLoader->instance();
                       PlotterInterface *plotter = qobject_cast<PlotterInterface*>(plugin);
                       plotter->initPlotter();
                       plugins.append(pluginLoader);
                     }
                 }
            }
         break;
           default :
               break;
           }
 } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T17:37:40.577

```
 foreach (QPluginLoader* pluginLoader, plugins) {        
             pluginLoader->unload();
             delete pluginLoader; // this could be your problem
           } 
```

您需要从插件列表中删除悬空指针。不这样做会导致你所描述的。

尝试这个：

```
while (!plugins.isEmpty()) {        
   QPluginLoader* pluginLoader = plugins.takeFirst();
   pluginLoader->unload();
   delete pluginLoader;
} 
```

# php - 艺术家 wp 主题元数据（日期、类别）丢失

> ID：10076681
> 
> 赞同：1
> 
> 时间：2012-04-09T16:53:39.700
> 
> 标签：php, wordpress

我对 wordpress 和 Artisteer 发疯了。我正在尝试一些以前非常简单的方法——在我的博客页面上为我的帖子打开和关闭日期和帖子类别的显示。

我在 content.php 中找到了这个

```
global $post;
theme_post_wrapper(
    array(
        'id' => theme_get_post_id(), 
        'class' => theme_get_post_class(),
        'title' => theme_get_meta_option($post->ID, 'theme_show_page_title') ? get_the_title() : '', 
        'heading' => theme_get_option('theme_single_article_title_tag'), 
        'before' => theme_get_metadata_icons('date', 'header'),
        'content' => theme_get_content()
    )
); 
```

并且该指令说您所要做的就是在“之前”行中插入或删除“日期”。我已经用我的内容文件来回完成了，输出没有任何变化。

我找不到打印所有内容的实际代码，wordpress 在一切都被挖掘到 10 个深度之前非常简单，现在你必须查看数百万个不同的函数才能找到最简单的东西......

正如您可能知道的那样，我通常不使用 WP =) 但这现在在我的桌子上，而且我已经有几年没有与 WP 保持同步了......

任何关于我在哪里可以找到变量的输入表示赞赏......

我曾期望在某个时候找到

'发布于'.echo($date)。' 在类别 '.echo($category)

或者至少有点相似的东西......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:30:43.563

啊哈！弄清楚了！before 函数需要在`h2`标签之后：

```
<div class="post-inner article">
    <?php echo $thumbnail;
      if (!art_is_empty_html($title)){
          echo '<h2 class="postheader">'.$title.'</h2>';
      }
      echo $before;
    ?>
<div class="postcontent">
<!-- article-content --> 
```

把这个留在这里，以防其他人来找它！:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T05:25:30.457

所以我遇到了在我的 Artisteer 主题中没有任何帖子元数据（发布日期、类别等）的问题。我在艺术家设计程序中禁用了它们，因为我不希望我的整个页面看起来像一个博客，而是一个专业页面。

然而，后来我意识到我确实想要我的新闻部分（实际上只是一个博客页面）的发布日期、帖子类别等数据。

我该如何取回它？

事实证明这比你想象的要难一些......在早期版本的 WP 和 Artisteer 中，你可以找到处理输出的文件，即索引、页面等，但现在它们都包含在相互调用的函数中=)

它是这样的： WP 中的每个页面都有一个模板文件（可以在创建页面时指定），请阅读 WP Codex 中有关页面模板的更多信息。您的博客页面从 home.php 或 archive.php 运行（取决于您是查看帖子存档还是只是常规的“主页”项目，我称我的“新闻”为“新闻”，因为博客只是一个小新闻我网站的部分）。

打印出帖子的循环如下所示：

```
/* Start the Loop */ 
while (have_posts()) {
    the_post();
    get_template_part('content', '');
} 
```

因此，在此页面模板文件中控制的所有内容与帖子输出有关的是使用哪个内容过滤器模板。在您的 Artisteer 3.1 主题中，您将有许多 content.php 文件，上面的函数将调用 content.php 但您可以为您的页面设置一个 content-page.php 等。让我们看看我的 content.php 然后...

```
global $post;
theme_post_wrapper(
    array(
            'id' => theme_get_post_id(), 
            'class' => theme_get_post_class(),
            'thumbnail' => theme_get_post_thumbnail(),
            'title' => theme_get_meta_option($post->ID, 'theme_show_page_title') ? get_the_title() : '', 
            'heading' => theme_get_option('theme_'.(is_single()?'single':'posts').'_article_title_tag'),
            'before' => theme_get_metadata_icons('date,category', 'header' ),

            'content' => theme_get_excerpt(), 
            'after' => theme_get_metadata_icons( '', 'footer' )
    )
); 
```

所以这个文件真正做的就是确定哪些部分的数据要包含在这个模板中。当我在这里深入研究时，我开始感到恼火......打印我的 html 元素的实际代码在哪里？我可以从哪里开始“破解”我的主题？如您所见，上面的“之前”行包含项目“数据、类别”和样式的附加值“标题”。所以让我们看看我们的主题functions.php中的那个函数......

```
function theme_get_metadata_icons($icons = '', $class=''){
        global $post;
        if (!is_string($icons) || theme_strlen($icons) == 0) return;
        $icons = explode(",", str_replace(' ', '', $icons));
        if (!is_array($icons) || count($icons) == 0) return;
        $result = array();
        for($i = 0; $i < count($icons); $i++){
            $icon = $icons[$i];
            switch($icon){
                case 'date':
                    $result[] = '<span class="art-postdateicon">' . sprintf( __('<span class="%1$s">Published</span> %2$s', THEME_NS),
                                    'date',
                                    sprintf( '<span class="entry-date" title="%1$s">%2$s</span>',
                                        esc_attr( get_the_time() ),
                                        get_the_date()
                                    )
                                ) . '</span>';
                break;
                case 'category':
                    $categories = get_the_category_list(', ');
                    if(theme_strlen($categories) == 0) break;
                    $result[] = '<span class="art-postcategoryicon">' . sprintf(__('<span class="%1$s">Posted in</span> %2$s', THEME_NS), 'categories', get_the_category_list(', ')) . '</span>';
                break;
//other options such as author etc. are included here by default, I took them out for the sake of this example...
            }
        }
        $result = implode(theme_get_option('theme_metadata_separator'), $result);
        if (theme_is_empty_html($result)) return;
        return "<div class=\"art-post{$class}icons art-metadata-icons\">{$result}</div>";
    } 
```

所以该函数只提取一些数据，并将其包装在一些主题样式中，但我仍然没有找到可以注释掉包含“发布者”等信息的实际 html 元素的地方。记住我丢失了日期戳，所以我认为它在某处被注释掉了。

最后要看的地方是函数theme_post_wrapper()，如果你退一步，你会看到theme_post_wrapper()是这个函数，它反过来调用上面的函数，提取数据并将其包装在一些样式元素中. 你会认为这个函数会在functions.php中的某个地方，对吧？但是没有...函数 theme_post_wrapper( 的目录搜索显示它在主题文件 library/wrappers.php 中。它看起来像这样：

```
function theme_post_wrapper($args = '') {
    $args = wp_parse_args($args, 
        array(
            'id' => '',
            'class' => '',
            'title' => '',
            'heading' => 'h2',
            'thumbnail' => '',
            'before' => '',
            'content' => '',
            'after' => ''
        )
    );

    /*
        var_dump($args);
        die;
    */

    extract($args);
    if (theme_is_empty_html($title) && theme_is_empty_html($content)) return;
    if ($id) {
        $id = ' id="' . $id . '"';
    }
    if ($class) {
        $class = ' ' . $class; 
    }
    ?>
<div class="art-box art-post<?php echo $class; ?>"<?php echo $id; ?>>
        <div class="art-box-body art-post-body">
                <div class="art-post-inner art-article">
                <?php
                    if (!theme_is_empty_html($title)){
                        echo '<'.$heading.' class="art-postheader">'$before.': '.$title.' <span class="published_date">('.$after.')</span></'.$heading.'>';
                    //original:   echo '<'.$heading.' class="art-postheader">'.$title.'</'.$heading.'>';
                    }
                     echo $thumbnail;
                    ?>
                    <div class="art-postcontent">
                        <!-- article-content -->
                        <?php echo $content; ?>
                        <!-- /article-content -->
                    </div>
                    <div class="cleared"></div>
                    <?php
                ?>
                </div>
            <div class="cleared"></div>
        </div>
    </div> 
```

这是我的元数据元素最终打印出来的地方，现在我有宾至如归的感觉，世界又一切正常了。我再一次感谢 Artisteer，虽然它有点混乱，而且很费时间来了解这个的具体细节。

请注意我的问题的解决方案：Artisteer 的工作方式如下：当您选择不在主题中包含日期或作者元数据时，artisteer 不仅关闭选项或注释掉打印这些元素的代码，它实际上根本不会生成该代码。所以我不得不手动把它放回那里。很公平 - 我想艺术家主题不是为了以这种方式被黑客攻击和调整的，但我仍然比那些 21 和 211 主题的逻辑更喜欢它们=p

# android - 启动后应用程序崩溃（在智能手机和模拟器上）

> ID：10076682
> 
> 赞同：0
> 
> 时间：2012-04-09T16:53:43.327
> 
> 标签：android, crash, acra

我的应用程序在启动后立即崩溃，我不知道为什么（我是初学者）。我想这个问题是Android SDK库。早些时候（在我使用 SDK Manager 下载新的 Androidk SDK 之前，一切正常，并且 Elcipse 导出良好的 *.apk 没有任何错误）。我还尝试在我的第二台笔记本电脑上安装带有新 Android SDK 和 ADT 插件的新 eclipse，但问题是一样的。这是模拟器的截图： http: [//speedy.sh/DypGB/error.jpg](http://speedy.sh/DypGB/error.jpg)

这是来自 logcat 的日志：[http ://speedy.sh/h6DFm/log.txt](http://speedy.sh/h6DFm/log.txt)

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:13:36.087

acra jar 文件在您的 java 构建路径中吗？

1.  将 acra jar 复制到您的项目文件夹中
2.  右键单击项目，选择构建路径-> 配置构建路径
3.  单击库选项卡
4.  单击“添加外部 jar”并选择复制的 jar

# algorithm - 求解行列式的计算机算法

> ID：10076688
> 
> 赞同：2
> 
> 时间：2012-04-09T16:54:14.563
> 
> 标签：algorithm, equations, determinants

我想要一种可以解决 nxn 行列式并返回值的计算机算法。最推荐使用 C++ 语言，其中输入是 2D 数组，N，输出是值。

数学中有一种详尽的方法可以解决大小超过 3 x 3 的行列式。如果有人能找到解决行列式的代码片段，那将很有帮助。

考虑到“n”个线性方程组的系数，主要目的是求解“n”个变量。一旦 'n' 超过 4，这件事在纸上就会变得一团糟。有一种求解此类方程的“行列式”方法。虽然一旦'n'超过3，它在纸上也会变得凌乱，但如果我能找到计算机如何解决它，它是可行的。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T16:58:20.530

如[数值配方](http://www.amazon.co.uk/Numerical-Recipes-3rd-Edition-Scientific/dp/0521880688/)中所述，行列式只是 LU 分解后对角元素的乘积。（这本书可以在线获得，并且有用于计算 LU 分解的代码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:57:28.927

许多语言都内置了此功能。

例如，如果你创建一个 C# 程序，你可以使用[Matrix.Determinant](http://msdn.microsoft.com/en-us/library/system.windows.media.matrix.determinant.aspx)属性来立即得到它：

```
private Double determinantExample()
{
    Matrix myMatrix = new Matrix(5, 10, 15, 20, 25, 30);

    // Get the determinant, which is equal to -50.
    Double determinant = myMatrix.Determinant;

    return determinant;

} 
```

如果这是一个教育练习，维基百科会在文章顶部向您展示如何解决行列式：[http ://en.wikipedia.org/wiki/Determinant](http://en.wikipedia.org/wiki/Determinant)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T16:58:31.643

维基百科有[一个](http://en.wikipedia.org/wiki/Determinant#Calculation)算法列表。LAPACK 和它的表兄弟是标准工具，看起来有一个[C++ 版本](http://math.nist.gov/lapack++/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T17:18:05.870

更简单的方法是通过应用 laplae 公式（http://en.wikipedia.org/wiki/Determinant#Laplace.27s_formula_and_the_adjugate_matrix）使用递归方法

在这里，您有一个实现 det() 函数的类 Matrix 看看。 [http://www.dreamincode.net/forums/topic/55772-determinant-of-matrix-in-c/](http://www.dreamincode.net/forums/topic/55772-determinant-of-matrix-in-c/)

这里给出了两种解决方案：http: [//cboard.cprogramming.com/cplusplus-programming/30001-determinant-calculation.html](http://cboard.cprogramming.com/cplusplus-programming/30001-determinant-calculation.html)

第一个不是递归的，第二个和第一个链接的解法基本相同。非递归方法基本上将您的矩阵转换为三角矩阵。三角矩阵的行列式是对角元素的乘法。见这里：[http](http://en.wikipedia.org/wiki/Determinant#Properties_of_the_determinant) ://en.wikipedia.org/wiki/Determinant#Properties_of_the_determinant （规则6）

# c++ - c ++ styleguide：为什么左侧有非左值？

> ID：10076689
> 
> 赞同：9
> 
> 时间：2012-04-09T16:54:27.183
> 
> 标签：c++, coding-style

在一份[C++ 编码风格指南](http://www.appinf.com/download/CppCodingStyleGuide.pdf)中，我发现了一项特别的建议（第 41 页，建议编号 53）：

> 左侧总是有非左值（`0 == i`而不是`i == 0`）。

而且我不明白这有什么用？是否要坚持这种做法？

我不是，我不知道为什么他的做法很好。我能想到的唯一优点是可以避免将无意的赋值误认为是比较（`if (foo = 0){}`与`if (foo == 0){}`）

你有什么其他想法我为什么要使用它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-09T16:55:46.683

是的，你猜对了。这是好的，旧的**[尤达条件](http://www.dodgycoder.net/2011/11/yoda-conditions-pokemon-exception.html)**！

![在此处输入图像描述](../Images/ad3c4a156b56f00b0c3aebfa400a2466.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T17:09:57.123

正如您所说，有些人使用它的原因是偶尔避免`=`在他们的意思时打字`==`。

由于它只捕获某些情况，即您将*左值*与常量或*右值*进行比较，并且我所知道的每个编译器都会在您犯此错误时警告您，因此这样做没有什么意义。

至少对于以英语为母语的人来说，它使代码读起来就像是倒着写的一样；所以有人称之为“尤达条件”。就像企业风格指南中的许多规则一样，它可以追溯到处理无情的编译器比编写可读代码更重要的时代。

# ruby - 自上次检查以来 Ruby IMAP “更改”

> ID：10076690
> 
> 赞同：4
> 
> 时间：2012-04-09T16:54:51.520
> 
> 标签：ruby, ruby-on-rails-3, imap, uid

我正在使用 Ruby 和 Rails 开发 IMAP 客户端。我可以成功导入邮件、邮箱等... 但是，在初始导入之后，如何检测自上次同步以来发生的任何更改？

目前，我将 UID 和 UID 有效性值存储在数据库中，比较它们并进行适当的搜索。这可行，但它不会检测到已删除的消息或对消息标志的更改等。

我是否必须每次都提取所有消息才能检测到这些更改？其他 IMAP 客户端是如何做到这么快的（即 Apple Mail 和 Postbox）。我的脚本每个帐户已经花费了 10 多秒，而电子邮件地址很少：

```
# select ourself as the current mailbox
@imap_connection.examine(self.location)

# grab all new messages and update them in the database
# if the uid's are still valid, we will just fetch the newest UIDs
# otherwise, we need to search when we last synced, which is slower :(
if self.uid_validity.nil? || uid_validity == self.uid_validity
  # for some IMAP servers, if a mailbox is empty, a uid_fetch will fail, so then
  begin
    messages = @imap_connection.uid_fetch(uid_range, ['UID', 'RFC822', 'FLAGS'])
  rescue
    # gmail cries if the folder is empty
    uids = @imap_connection.uid_search(['ALL'])
    messages = @imap_connection.uid_fetch(uids, ['UID', 'RFC822', 'FLAGS']) unless uids.empty?
  end

  messages.each do |imap_message|
    Message.create_from_imap!(imap_message, self.id)
  end unless messages.nil?
else
  query = self.last_synced.nil? ? ['All'] : ['SINCE', Net::IMAP.format_datetime(self.last_synced)]
  @imap_connection.search(query).each do |message_id|
    imap_message = @imap_connection.fetch(message_id, ['RFC822', 'FLAGS', 'UID'])[0]

    # don't mark the messages as read
    #@imap_connection.store(message_id, '-FLAGS', [:Seen])

    Message.create_from_imap!(imap_message, self.id)
  end
end

# now assume all UIDs are valid
self.uid_validity = uid_validity

# now remember that we just fetched all those messages
self.last_synced = Time.now
self.save! 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T17:36:35.763

**快速标志更改重新同步**( [RFC-4551](https://www.rfc-editor.org/rfc/rfc4551) )有一个 IMAP 扩展。使用此扩展，可以搜索自上次同步以来已更改的所有消息（基于某种时间戳）。但是，据我所知，此扩展并未得到广泛支持。

有一个信息 RFC 描述了 IMAP 客户端应该如何进行同步（[RFC-4549](https://www.rfc-editor.org/rfc/rfc4549)，第 4.3 节）。文中建议发出以下两条命令：

```
tag1 UID FETCH <lastseenuid+1>:* <descriptors>
tag2 UID FETCH 1:<lastseenuid> FLAGS 
```

第一个命令用于获取所有未知邮件的所需信息（不知道有多少邮件）。第二个命令用于同步已看到邮件的标志。

AFAIK 这种方法被广泛使用。因此，许多 IMAP 服务器包含优化以快速提供此信息。通常，网络带宽是限制因素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T03:56:50.683

不幸的是，IMAP 协议以这种方式脑死亡。例如，IDLE 确实应该能够在连接时返回这种东西。上面的 FETCH FLAGS 建议是唯一的方法。

然而，需要注意的一件事是，根据规范，UID 仅对给定会话有效。您不应该存储它们，即使某些服务器会保留它们。

# php - Composer.phar 无法安装依赖项

> ID：10076696
> 
> 赞同：0
> 
> 时间：2012-04-09T16:55:16.017
> 
> 标签：php, symfony

我一直在尝试使用 phar 安装所有依赖项，但它总是给我一个错误

```
[ErrorException]                                       
  rtrim() expects parameter 1 to be string, array given 
```

我已经为此苦苦挣扎了一段时间，希望能得到任何帮助。

我的 PHP 版本（来自 phpinfo()）是 PHP 版本 5.3.6-13ubuntu3.6

错误的附加信息：pastebin.com/V2w6Cg69

与 --verbose ： http: [//www.pastebin.com/qL0RHA2a](http://www.pastebin.com/qL0RHA2a)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T20:30:06.473

据我所知，这是在我介绍 Config 类时发生的，并在不久后得到修复。更新到最新的作曲家版本应该可以解决它。

# java - java中线程间的数据通信

> ID：10076697
> 
> 赞同：0
> 
> 时间：2012-04-09T16:55:19.910
> 
> 标签：java, multithreading

我在java中编写了一个小程序，使用两个线程发送和接收数据文件。我希望这两个线程在同一个类中。一个线程发送文件，另一个线程接收文件。我已经为它编写了代码，但几乎没有错误。你能帮我找出代码中的错误吗？我是Java的学生和初学者，如果有任何愚蠢的错误，请原谅我。

```
import java.lang.Thread.*;
import java.io.*;
public class sendques implements Runnable
{
    int i=0,c;
    static Thread[] t= new Thread[2];
    FileInputStream fis=new FileInputStream("ip.jpg");
    FileOutputStream fos=new FileOutputStream("output.jpg");
    sendques() {
        for(i=0;i<2;i++){
            t[i]=new Thread(this);
            t[i].start();
            System.out.println("Threads "+i);
        }
    }
    void run() {
        while(true) {
            wait();
            send();
        }
    }
    void send() {
        while((c=fis.read())!=-1) {
            t[2].receive(c);
            wait();
        }
    }
    void receive(int d) {
        while(c!=-1) {
            fos.write(d);
            t[1].notify();
        }
    }
    public static void main(String arg[]) {
        sendques sq=new sendques();
        t[1].send();
        System.out.println("Quiting..");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T23:24:32.147

不要使用`notify`，最好使用`notifyAll`，因为可能会发生活性故障，命名为：**missing signals**。纠正您的代码会很困难，以下是具有不同类的生产者/消费者实现的代码：

*   [BaseBoundedBuffer.java](https://github.com/platzhirsch/java-concurrency-profiler/blob/master/src/java/de/fu/profiler/examples/BaseBoundedBuffer.java)
*   [有界缓冲区.java](https://github.com/platzhirsch/java-concurrency-profiler/blob/master/src/java/de/fu/profiler/examples/BoundedBuffer.java)
*   [生产者.java](https://github.com/platzhirsch/java-concurrency-profiler/blob/master/src/java/de/fu/profiler/examples/Producer.java)
*   [消费者.java](https://github.com/platzhirsch/java-concurrency-profiler/blob/master/src/java/de/fu/profiler/examples/Consumer.java)

Buffer 类用于存储生产者和消费者之间共享的数据。他们有自己的类和一个示例，您可以在`BoundedBuffer.java`. 它们不涉及繁重的计算任务，只是在两者之间传递消息。这是一个干净的实现，请尝试完成它。

# javascript - 使用 Javascript 实时打印字段输入数据

> ID：10076701
> 
> 赞同：0
> 
> 时间：2012-04-09T16:55:27.250
> 
> 标签：javascript, jquery, user-input

有一个问题要问你 javascript 大师。我正在创建一个由几个不同的文本输入字段组成的侧边栏工具。此工具的目的是在模板上编辑副本。我试图将输入的数据传递到 onchange 字段中，但是在将数据转储到我的 js 对象中时遇到了问题。这有点像我的想法：

```
$('myInputField').(function(){
      $(this).onChange(){
          // write to variable X
}
}); 
```

本质上，我想让我在输入中输入的内容被实时模仿，然后我可以解析对我的数据库的更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:58:32.613

```
$('#myInputField').(function(){
      $(this).onkeyup(){
          x = this.value;
      }
}); 
```

或更简洁地说：

```
$('#myInputField').onkeyup(){
    x = this.value;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:01:03.550

您只是在寻找`myInputField`该事件处理程序中的值吗？像这样的东西？：

```
$('myInputField').(function(){
  $(this).onChange(){
      x = $(this).val();
  }
}); 
```

`this`如果已经是 jQuery 对象，我不记得了。如果是，那么这应该可以工作，并且可能会跳过一些开销：

```
x = this.val(); 
```

`this`此外，如果曾经被不同的上下文覆盖，或者如果您还想引用其他字段等，您可以使用普通的 jQuery 选择器显式引用该字段：

```
x = $('myInputField').val(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T17:54:53.660

问题是，在 IE 上，该`onchange`事件不适用于 INPUT 元素。因此，您必须根据要执行`onkeypress`的操作来使用 或事件。`onblur`

JS方式：

```
document.getElementById('myInputField').onblur = function() {
    var x = this.value
} 
```

jQuery方式：

```
$('#myInputField').blur(function() {
    var x = this.value
}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T17:05:05.470

输入字段上的简单 keyup 事件是否就足够了？

jQuery：

```
$('textarea').keyup(function() {
    $('#foo').html($(this).val());
});​ 
```

HTML：

```
<textarea></textarea>
<div id="foo"></div> 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/T4mX6/1/)**。

# c++ - 在 C++ 中创建对象的副本

> ID：10076714
> 
> 赞同：2
> 
> 时间：2012-04-09T16:56:10.670
> 
> 标签：c++, copy-constructor

我有一个类 SimpleCircle。其声明如下：

```
class SimpleCircle
{
  public:
SimpleCircle();
SimpleCircle(int rad);
SimpleCircle(const SimpleCircle&);
~SimpleCircle();

   SimpleCircle operator++(int);
} 
```

关于我使用的定义：

```
SimpleCircle SimpleCircle::operator++(int)
{
    SimpleCircle temp(*this);
    ++itsRadius;
    return temp;
} 
```

当我使用

> SimpleCircle temp(*this)

，是调用了复制构造函数还是什么？那里发生了什么？我没有像这样的构造函数

> SimpleCircle(SimpleCircle newCircle)

或其他东西（除了复制构造函数）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T16:58:38.943

这确实调用了复制构造函数。虽然您没有`SimpleCircle(SimpleCircle other)`定义构造函数，但您已经`SimpleCircle(const SimpleCircle&)`定义了。该表达式`*this`可以很容易地映射到该构造函数，因此它就是这里正在执行的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:59:59.947

当然你有一个复制构造函数：就是这样`SimpleCircle(const SimpleCircle&);`。

它可能不接受 a`SimpleCircle`作为参数，但它接受一个常量引用，这是复制构造函数所需要的。该`*this`参数返回一个指向调用对象的指针，复制构造函数使用该指针进行 make `temp`。

# javascript - jqgrid使用afterSubmit事件获取新增记录的ID

> ID：10076727
> 
> 赞同：1
> 
> 时间：2012-04-09T16:57:11.193
> 
> 标签：javascript, jquery, jqgrid

我正在使用以下代码添加新记录。

```
jQuery("#list").jqGrid('editGridRow',"new",{height:545, width:425,recreateForm:true,reloadAfterSubmit:false,addedrow:'first',closeAfterAdd:true,top:110,left:350,modal:true}); 
```

我正在使用 reloadAfterSubmit:false 这意味着当新记录添加到网格时，我拥有的 ID 字段为空白。

有人可以非常简单地解释如何获取新记录的 ID 并将其放入我网格中的 ID 字段中。

我在[这里](https://stackoverflow.com/questions/6954736/how-to-supply-a-row-id-when-using-jqgrid-editgridrow-to-create-a-new-row-and-n)找到了一个先前的答案，这似乎是我正在寻找的，但我不明白如何让它工作。文档说`afterSubmit: function (response,postdata) {return [true, '', new_id];}`，但我没有如何实现这一点。

我是新手，所以我需要它说得很简单。

谢谢你的帮助。

更新：服务器响应：response.responseText

(!) 注意：未定义的偏移量：D:\wamp\www\EstimateTracker\UpdateEstimates.php 中的 1 第*32*行 调用堆栈#TimeMemoryFunctionLocation 10.0036402872{main}()..\UpdateEstimates.php **：** 0
( ! ) 注意：未定义的偏移量：D:\wamp\www\EstimateTracker\UpdateEstimates.php 中的 2 第*32*行 调用堆栈#TimeMemoryFunctionLocation 10.0036402872{main}( )..\UpdateEstimates.php **:** 0 String

更新 2：

```
$(function () {
    $("#list").jqGrid({
        url:'GetEstimates.php',
        datatype: 'xml',
        mtype: 'GET',
        colNames:['ID','Campaign Name','ClientsID','Client Name','Buyer Name','Client Ref','Description','Sales','Estimator', 'Date Received', 'Date Required','Status','Product Type','Date Submitted','Price (&pound)', 'Keren No.','Reason Lost','Won Price (&pound)','Notes'],
        colModel :[ {name:'ID', key:true,index:'ID', width:45,align:'center',editable:true,editoptions:{readonly:true,size:10, height:5}, {name:'CampaignName', index:'CampaignName', width:175, align:'left',editrules:{required:true},editable:true,editoptions:{size:35}}, {name:'ClientsID', index:'ClientsID', width:120, align:'left',editable:true,hidden:true}, {name:'ClientName', index:'ClientName', width:120, align:'left',editrules: required:true,custom_func:notEmpty,custom:true},editable:true,edittype:'select', editoptions:{dataUrl:'ClientDropDownGrid.php',dataInit: function () {
        var thisval = $("#ClientsID").val();
        $.get('GetBuyersGrid.php?id='+thisval, function(data) {
            var res = $(data).html();
            $("select#BuyerName").html(res);
        }); // end get
    }//end func
    ,dataEvents:[{type:'change',fn: function(e) {
        var thisval = $(e.target).val();
        $.get('GetBuyersGrid.php?id='+thisval, function(data){
            var res = $(data).html();
            $("select#BuyerName").html(res);
        }); // end get
    }//end func
    } // end type
    ] // dataevents
    }}, 
    {name:'BuyerName', index:'BuyerName', width:100, align:'left',editable:true,edittype:'select',editoptions:{dataUrl:'BuyerDropDownGrid.php'}},
    {name:'ClientEstimateRef', index:'ClientEstimateRef', width:125, align:'left', align:'left',editable:true,editoptions:{size:25}},
    {name:'Description', index:'Description', width:125, align:'left', align:'left',editable:true,editoptions:{size:25}},
    {name:'SalesName', index:'SalesName', width:100, align:'left',editrules:{required:true,custom_func:notEmpty,custom:true},editable: true,edittype:'select',editoptions:{dataUrl:'SalesDropDownGrid.php'},formoptions:{elmsuffix: '<a id="AddSales" href="AddSales.php">Add Sales</a>' }},
    {name:'EstimatorName', index:'EstimatorName', width:100, align:'left',editrules:{required:true,custom_func:notEmpty,custom:true},editable: true,edittype:'select',editoptions:{dataUrl:'EstimatorDropDownGrid.php'} },
    {name:'DateReceived', index:'DateReceived', width:80, align:'center',editrules:{required:true,custom_func:isValidDateRec,custom:true},editable:true,editoptions: {size: 15, maxlength: 10,dataInit: function(element) {$(element).datepicker({dateFormat: 'dd/mm/yy'}) } }}, 
    {name:'DateRequired', index:'DateRequired', width:80, align:'center',editrules:{required:true},editable:true,editoptions: {size: 15, maxlength: 10,dataInit: function(element) {$(element).datepicker({dateFormat: 'dd/mm/yy'}) } }}, 
    {name:'Status', index:'Status', width:100, align:'left',editable: true,edittype:'select',editoptions:{dataUrl:'StatusDropDownGrid.php', defaultValue:'4'} },
    {name:'ProductType', index:'ProductType', width:100, align:'left',editrules:{required:true,custom_func:notEmpty,custom:true},editable: true,edittype:'select',editoptions:{dataUrl:'ProductTypeDropDownGrid.php'} },
    {name:'DateSubmitted', index:'DateSubmitted', width:80, hidden:false, align:'center',editable:true,editoptions: {size: 15, maxlength: 10,dataInit: function(element) {$(element).datepicker({dateFormat: 'dd/mm/yy'}) } }},
    {name:'Price', index:'Price', width:60, align:'right',editrules:{required:true,custom_func:isCurrency,custom:true},editable:true, formatter:currencyFmatter, unformat:unformatCurrency,editoptions:{size:15,defaultValue:'0.00'}, formoptions:{elmsuffix: 'GBP'}},
    {name:'KerenNo', index:'KerenNo', width:80, align:'left',editable:true,editoptions:{size:20}},
    {name:'ReasonLost', index:'ReasonLost', width:120, align:'left',editable: true,edittype:'select',editoptions:{dataUrl:'ReasonLostDropDownGrid.php'} },
    {name:'WonPrice', index:'WonPrice', width:60, align:'right',editrules:{required:true,custom_func:isCurrency,custom:true},editable:true, formatter:currencyFmatter, unformat:unformatCurrency, editoptions:{size:15,defaultValue:'0.00'}, formoptions:{elmsuffix:'GBP'}},
    {name:'Notes', index:'Notes', width:125, align:'left', align:'left',editable:true,edittype:'textarea',editoptions:{dataInit: function(elem){$(elem).width(200); $(elem).height(45);}}}
    //{name:'total', index:'total', width:80, align:'right'}, 
    //{name:'note', index:'note', width:150, sortable:false} 
    ],
        pager: '#pager',
        rowNum:20,
        rowList:[10,20,30],
        sortname: 'ID',
        sortorder: 'asc',
        viewrecords: true,
        gridview: true,
        caption: 'Estimates',
        width:880,
        height:400,
        multiselect:true,
        editurl:'UpdateEstimates.php',
        shrinkToFit:false
    });
    //edit row
    $("#editButton").click(function(){
        var gr = jQuery("#list").jqGrid('getGridParam','selrow');    
        if( gr != null ) jQuery("#list").jqGrid('editGridRow',gr,{height:545, width:425,recreateForm:true,reloadAfterSubmit:false,closeAfterEdit:true,top:110,left:350,viewPagerButtons:false,modal:true,beforeShowForm: function(form) { $('#tr_DateSubmitted', form).show();}});
        else alert("Please Select Row");
    });

    //add row
    $("#addButton").click(function(){
        //var gr = jQuery("#list").jqGrid('getGridParam','selrow');
        jQuery("#list").jqGrid('editGridRow',"new",{height:545, width:425,recreateForm:true,reloadAfterSubmit:false,afterSubmit: function(response){return [true,'','45765'];},addedrow:'first',closeAfterAdd:true,top:110,left:350,modal:true});
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:31:18.330

[答案](https://stackoverflow.com/questions/6954736/how-to-supply-a-row-id-when-using-jqgrid-editgridrow-to-create-a-new-row-and-n)不包含您包含的代码。它只是描述了`afterSubmit`应该*以某种方式从服务器响应中*获取新添加行的 id ，然后返回新行的 id`[true, '', new_id]`在哪里。`new_id`

在最简单的形式中，您可以在服务器响应的正文中返回新添加行的 id。所以 id 的值可能在`response.responseText`. 在这种情况下你应该使用

```
afterSubmit: function (response) {
    return [true, '', response.responseText];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T17:29:53.130

你可以试试这个新的记录功能：

```
jQuery("#list").jqGrid('editGridRow',"new",{
    height:545,
    width:425,
    recreateForm:true, 
    addedrow:'first',
    closeAfterAdd:true,
    top:110, 
    left:350,
    modal:true,
    afterComplete: function(response, postdata, formid) {
        //force update of row data @ row 0 and column = ID, change the name of ID if your column name is different.  
        //We are using row 0 because we are assuming your new data is not in the first row
        $('#list').jqGrid('setCell', 0, 'ID','','','',true);
    }
}); 
```

这应该在您提交后重新加载网格，如果您的提交成功并且您的更改已保存到您的数据源，那么当网格重新加载时，它将填充新保存的数据，包括新的 ID。

要使新 ID 显示为第一条记录，您需要`sortname: 'ID'`在网格中设置选项，并且`sortorder: 'desc'`. 然后当你重新加载网格时，最高的 ID 将首先出现。

** 编辑 **

看起来您可以使用该`setCell`方法，并将`forceup`属性设置为 true。在这里查看： [http ://www.trirand.com/jqgridwiki/doku.php?id=wiki:methods](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:methods)

# jsf - Richfaces 组件可以插入到rich:editor 组件中吗？

> ID：10076730
> 
> 赞同：0
> 
> 时间：2012-04-09T16:57:19.167
> 
> 标签：jsf, richfaces, seam

我有另一个 Richfaces 问题，这可能看起来很奇怪。我正在开发一个基于 Web 的应用程序，使用 Richfaces 作为前端，它允许用户为某些文档创建模板。例如：向用户展示了一个rich:editor 组件，该组件可能已经输入了某些文本，但它也有一个日期或特定文本的输入。日期可以在rich:calendar 中输入，文本可以在rich:inplaceInput 中输入，但主要思想是能够将这些组件放置在rich:editor 中。我试图找到一个使用它但不能使用的例子。所以，我的问题是：这甚至可能吗？你能把 RichFaces 组件（也许还有 Seam 组件）放到rich:editor 中吗？如果没有，是否有类似的东西允许用户这样做？西姆能做到吗？我的原因

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T21:52:31.950

本质上是您询问是否可以将 HTML 元素添加到 textarea 标记，并让它们工作。不幸的是，不，你不能。

我过去为这些事情所做的就是编织样板文本、inplaceInput 和自由格式文本区域，或者只是在编辑器上方/旁边/下方提供所需的字段。

# wpf - DisplayStateBehavior 最初未在列表框项模板中应用状态转换

> ID：10076732
> 
> 赞同：0
> 
> 时间：2012-04-09T16:57:23.047
> 
> 标签：wpf, mvvm, datatemplate, expression-blend, visualstatemanager

我有一个包含视觉状态的列表框项目模板。我有 DisplayStateBehaviors 将状态设置为开/关状态。我的实现只有 1/2 有效。在初始显示时，无论 DataContext 中的值如何，基本状态都是活动的。当 DataContext 中的数据发生变化时，就会激活适当的状态。

如何在列表框的初始显示上显示正确的状态。

出于安全原因，我无法复制/粘贴 XAML 或 View-Model 代码。

**编辑**：虽然我无法复制/粘贴真实代码，但下面的骨架有望重现该问题。

在全局可见的资源文件中：

```
<DataTemplate x:Key="MyObjectItemTemplate">
  <Grid>
    <VisualStateManager.VisualStateGroups>
      ... blend goodness ...
    </VisualStateManager.VisualStateGroups>   
  </Grid>
</DataTemplate> 
```

通过将数据上下文与主 UI 中列表框的 ItemsTemplate 属性相关联，将数据上下文传递到数据模板中。

```
<ListBox ... ItemTemplate="{DynamicResource MyObjectItemTemplate}" .../> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:16:11.623

我发现了我的问题。如果它可以帮助其他人，我所做的就是将 DataTemplate 的内容提取到 UserControl 中。这使一切都按我的预期工作。DataTemplate 仍然存在并且仍然涉及，但它只有一个元素 - 用户控件。视觉状态都是用户控件的一部分。

在全局可见的资源文件中：

```
<DataTemplate x:Key="MyObjectItemTemplate">
     <MyNamespace:MyUserControl/>
</DataTemplate> 
```

在单独的文件 MyUserControl.cs

```
<UserControl ... x.Class="MyNamespace.MyUserControl" ...>
  <Grid>
    <VisualStateManager.VisualStateGroups>
      ... blend goodness ...
    </VisualStateManager.VisualStateGroups>   
  </Grid>
</UserControl> 
```

通过将数据上下文与主 UI 中列表框的 ItemsTemplate 属性相关联，将数据上下文传递到数据模板中。

```
<ListBox ... ItemTemplate="{DynamicResource MyObjectItemTemplate}" .../> 
```

# php - 设置服务器端解释器

> ID：10076738
> 
> 赞同：4
> 
> 时间：2012-04-09T16:57:36.817
> 
> 标签：php, interpreter, server-side

好的。所以，让我们以 PHP 为例。

*   我在浏览器中输入一个 URL，请求一个 php 脚本。（例如`http://www.somedomain.com/index.php`）
*   浏览器*将该请求发送*到适当的服务器。
*   服务器通过其扩展名 ( )*识别出*`.php`它是一个 PHP 文件。
*   PHP 解释器*处理文件*并输出结果。
*   服务器*发回输出*。

现在，假设我们正在处理一个......自制解释器 XYZ（及其二进制文件等），例如处理`.xyz`文件。

我应该怎么做，所以上述所有内容对我的 XYZ 解释器都有效？

**我应该如何设置整个事情，以便它正常工作？**

* * *

***提示：***我不是在请求关于如何编写解释器的帮助，而是关于如何使其以上述方式运行的帮助......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:41:03.707

您的选择是使用现有的标准接口并编写您的软件以符合它，或者为服务器编写一个新模块。

对于前者，[CGI](http://www.ietf.org/rfc/rfc3875)简单但效率低下，而[FastCGI](http://www.fastcgi.com/devkit/doc/fcgi-spec.html)更现代但相对复杂。

If you want to write a new module, then the specifics will depend on the server you are dealing with.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:33:25.020

这完全取决于您使用的 Web 服务器。但是，如果那是 Apache，您应该考虑`apxs`构建和安装您自己的 apache 模块。Google 将帮助您查找有关`apxs`.

要为特定文件结尾添加处理程序，您应该在 apache 配置中执行以下操作（在构建 iterpreter/apache 模块之后）：

```
AddHandler my_handler .end 
```

# bash - 如何使用 Bash 重定向标准输入和输出

> ID：10076741
> 
> 赞同：7
> 
> 时间：2012-04-09T16:57:44.393
> 
> 标签：bash, io

```
#!/bin/bash
./program < input.txt > output.txt 
```

该`> output.txt`部分被忽略，因此 output.txt 最终为空。

这适用于`sort`命令，所以我希望也适用于其他程序。

有什么理由这不起作用？我应该如何实现这一目标？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T17:01:32.073

最可能的解释是您看到的输出来自`stderr`，而不是`stdout`。要将它们都重定向到文件，请执行以下操作：

```
./program < input.txt > output.txt 2>&1 
```

或者

```
./program < input.txt &> output.txt 
```

# .net - NUnit 不会释放自定义类库 dll 上的锁定...运行 NUnit 后无法编译类库

> ID：10076745
> 
> 赞同：4
> 
> 时间：2012-04-09T16:57:51.723
> 
> 标签：.net, visual-studio-2008, compilation, nunit, filelock

我为 NUnit 单元测试编写了一个自定义类库。它在 {project root}\bin\Debug\ 文件夹中创建了一个包含我的 .NET IL 代码的 dll 文件。在这个类库中运行 NUnit 单元测试工作正常，但是如果我尝试再次编译我的类库，我会收到这个错误。NUnit 没有释放锁。这是什么原因造成的？我怎样才能防止这种情况发生？

NUnit 首次运行后编译时出现 Visual Studio 错误：

错误 {error #} {class library project name} 无法将文件 {class library project root folder} +“\bin\Debug\Tests.dll”复制到“bin\Debug\Tests.dll”。该进程无法访问文件“bin\Debug\Tests.dll”，因为它正被另一个进程使用。

所以我可以更改代码的唯一方法是关闭 NUnit 并重新打开 NUnit。我正在使用 NUnit 2.6。这很烦人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:00:14.167

我发现解决这个问题的唯一方法是重新启动 NUnit。这会释放锁定，但是下次运行测试时可能会遇到同样的问题。

但是，您可以查看可能有帮助的信息：

[根据这个 google groups 线程](http://groups.google.com/group/nunit-discuss/browse_thread/thread/6e2103bd37d30c3a/a92b858882bac6b9?fwc=1)，这可能是一个重新加载设置

[请参阅装配隔离部分](http://www.nunit.org/index.php?p=settingsDialog&r=2.5)

**或者最后：**

[它可能是您的代码库的位置？](https://stackoverflow.com/questions/5182841/nunit-locking-dll)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:14:38.593

我找到了原因。也许 NUnit 开发人员可以解决这个问题。现在，我有下面描述的解决方法。

如果您没有 *.nunit、*.VisualState.xml（自动生成的 NUnit 文件）和 *.config（使用 System.Configuration 而不是 NUnit 的配置文件设置从 Visual Studio 类库中引用的 NUnit 配置文件）在类库根文件夹中，就会发生这种情况。（并且我的 *.config 文件与 *.nunit 文件的名称相同，所以我有 Tests.config 和 Test.nunit，它们都共享名称“Tests”）

因此，例如，当我收到此错误时，我有以下设置：

我的类库称为“Tests.csproj”。并假设 Tests.csproj 在“C:\Source\Tests\”中。这将使“C:\Source\Tests\”成为我项目文件夹的根目录。我的 dll 位于“C:\Source\Tests\bin\Debug\Tests.dll”中。并且上述 NUnit 文件位于“C:\Source\Tests\NUnit\”中。

当我将 NUnit 文件移动到“C:\Source\Tests\”（类库项目根文件夹）时，我在尝试编译 Visual Studio 类库项目时没有遇到这个问题。这种导致这种情况的文件夹结构一定会混淆 NUnit 程序。

我有一个单独的文件夹的原因是为了将所有 NUnit 文件分开。修复此问题后，我在所有 *.nunit、*.xml 和 *.config 文件前加上“nunit_”，因此它们都组合在一起。

# tomcat - Tomcat是如何定位webapps目录的？

> ID：10076754
> 
> 赞同：47
> 
> 时间：2012-04-09T16:58:29.967
> 
> 标签：tomcat

Tomcat 是如何定位 webapps 目录的？这个位置设置在哪里？是相对目录吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-04-09T17:24:00.800

它可以在 中`$CATALINA_BASE/conf/server.xml`更改`<Host />`。请参阅 Tomcat 文档，特别是有关主机容器的部分：

[Tomcat 6 配置](http://tomcat.apache.org/tomcat-6.0-doc/config/host.html)

[Tomcat 7 配置](http://tomcat.apache.org/tomcat-7.0-doc/config/host.html)

默认值是`webapps`相对于`$CATALINA_BASE`. 可以使用绝对路径名。

希望有帮助。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-05-31T07:53:12.173

在以下位置找到 server.xml`$CATALINA_BASE/conf/server.xml`

在元素中查找`appBase`属性`<Host>`

默认情况下，它将类似于： `<Host name="localhost" appBase="webapps ...>`

将 appBase 更改为您所需的路径。人们有不同的说法，但我用

```
/c:/myfolder/newwebapps 
```

请记住，末尾没有斜线，但在开头。还要注意它的方向。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-31T07:57:37.087

变化`appBase`_`server.xml`

如果你想保留以前的 webapps 和一个新的 webapps，你可以使用另一个 Host 实例和在 tomcat 中定义的另一个端口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-26T23:18:46.700

我正在通过 XAMPP 使用 Tomcat，这可能是导致此问题的原因。`appBase="C:/Java Project/"`例如，当我更改时，我不断进入`"This localhost page can't be found"`浏览器。

我必须在 Java Project 文件夹中添加一个名为 ROOT 的文件夹，然后它才能工作。您正在处理的任何文件都必须在此 ROOT 文件夹中，但您需要离开`appBase="C:/Java Project/"`，因为将其更改为`appBase="C:/Java Project/ROOT"`将导致`"This localhost page can't be found"`再次显示。

对于更有经验的 Java 开发人员来说，可能需要 ROOT 文件夹是显而易见的，但它不适合我，所以希望这可以帮助遇到同样问题的其他人。

# javascript - 重新加载 JQuery 和 CSS

> ID：10076759
> 
> 赞同：2
> 
> 时间：2012-04-09T16:58:50.810
> 
> 标签：javascript, jquery, jquery-ui

我有一个`<tr>`使用 JQuery 动态添加的链接，但我`<tr>`包含一些`<td>`包含 JQuery 的链接（第一个是 datepicker，最后一个删除 current `<tr>`）。当我添加这个`<tr>`JQuery 并且它的 CSS 不起作用：\

> 这是一个屏幕截图（最后一个`<tr>`是`<tr>`动态添加的）： ![在此处输入图像描述](../Images/1b26079febcce1bfeee336125b2ec040.png)
> 
> 这是动态添加的jquery代码：

```
<script>
          $('.AddResults').click(function(){

            // All the cols
            var jourVar = $('<td class="jr_td"><p><input type="text" class="datepicker" /></p><p class="ou">ou</p><p><input type="text" class="datepicker" /></p></td>') ;
            var creneauVar = $('<td class="cr_td"><select><option value="h1">10h30</option><option value="h2">11h30</option></select><select class="cr_td_s2"><option value="h3">10h30</option><option value="h4">11h30</option></select></td>') ;
            var repassageVar = $('<td class="rp_td"><select><option value="h5" SELECTED>2h00</option><option value="h6">3h00</option></select></td>') ;
            var menageVar = $('<td class="mn_td"><select><option value="h7" SELECTED>2h00</option><option value="h8">3h00</option></select></td>') ;
            var totalVar = $('<td class="tt_td"><strong>4h.</strong></td>') ;
            var pttcVar = $('<td class="pttc_td"><strong>88 &#8364;</strong></td>') ;
            var corVar = $('<td class="cor_td"><a href="#"><img src="img/ico/corbeille.png" alt="" width="13" height="13" /></a></td>') ;      

            //Create 2 new rows
            var newTitreRow = $('<tr><td class="bar_td" colspan=7><strong>PRESTATION ' + rowNumber + '</strong></td></tr>') ;
            var newContentRow = $('<tr class="ligne_suppr">').append(jourVar).append(creneauVar).append(repassageVar).append(menageVar).append(totalVar).append(pttcVar).append(corVar).append('<\/tr>') ;

            //Append the new row to the body of the #table_prest table
            $('#table_prest tbody').append(newTitreRow);
            $('#table_prest tbody').append(newContentRow);

            $('<style type="text/css">@import url("' + myStylesLocation + '")</style>').appendTo("#table_prest tbody");

            //Iterate row number
            rowNumber++;
          });
        </script> 
```

> 这是日期选择器代码：

```
<script>
          $(function() {
            $( ".datepicker" ).datepicker({
              showOn: "button",
              buttonImage: "img/ico/jour_presta.png",
              buttonImageOnly: true
            });
          });
        </script> 
```

> 这是删除代码：

```
<script>
          $('.ligne_suppr a').click(function(e) {
            e.preventDefault();
            var parent = $(this).parent().parent();  // parent <tr> of the anchor tag
            var previous = parent.prev();        // <tr> before the parent <tr>

            parent.remove();
            previous.remove();

            rowNumber -- ;
          });
        </script> 
```

你对这个问题有什么想法吗？谢谢 ：-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:10:59.520

你需要明白 datepicker 不仅仅是 CSS。它是一个 jQuery UI 插件，添加了功能和新的 DOM 元素。

因此，您的问题不是没有应用 CSS，而是没有将 jQuery 功能应用于动态创建的元素。

您需要为新元素重新运行 datepicker 代码。

所以

日期选择器代码

```
function applyDatepicker(context){
   context = context || document;
   $( ".datepicker", context ).datepicker({
        showOn: "button",
        buttonImage: "img/ico/jour_presta.png",
        buttonImageOnly: true
   });
}
$(function() {
    applyDatepicker();
}); 
```

删除代码

```
$('#table_prest').on('click','.ligne_suppr a',function(e) {
    e.preventDefault();
    var parent = $(this).parent().parent();  // parent <tr> of the anchor tag
    var previous = parent.prev();        // <tr> before the parent <tr>

    parent.remove();
    previous.remove();

    rowNumber-- ;
}); 
```

用于动态添加代码的 jQuery

```
 $('.AddResults').click(function(){

        // All the cols
        var jourVar = $('<td class="jr_td"><p><input type="text" class="datepicker" /></p><p class="ou">ou</p><p><input type="text" class="datepicker" /></p></td>') ;
        var creneauVar = $('<td class="cr_td"><select><option value="h1">10h30</option><option value="h2">11h30</option></select><select class="cr_td_s2"><option value="h3">10h30</option><option value="h4">11h30</option></select></td>') ;
        var repassageVar = $('<td class="rp_td"><select><option value="h5" SELECTED>2h00</option><option value="h6">3h00</option></select></td>') ;
        var menageVar = $('<td class="mn_td"><select><option value="h7" SELECTED>2h00</option><option value="h8">3h00</option></select></td>') ;
        var totalVar = $('<td class="tt_td"><strong>4h.</strong></td>') ;
        var pttcVar = $('<td class="pttc_td"><strong>88 &#8364;</strong></td>') ;
        var corVar = $('<td class="cor_td"><a href="#"><img src="img/ico/corbeille.png" alt="" width="13" height="13" /></a></td>') ;      

        //Create 2 new rows
        var newTitreRow = $('<tr><td class="bar_td" colspan=7><strong>PRESTATION ' + rowNumber + '</strong></td></tr>') ;
        var newContentRow = $('<tr class="ligne_suppr">').append(jourVar).append(creneauVar).append(repassageVar).append(menageVar).append(totalVar).append(pttcVar).append(corVar).append('<\/tr>') ;

        //Append the new row to the body of the #table_prest table
        $('#table_prest tbody').append(newTitreRow);
        $('#table_prest tbody').append(newContentRow);

        applyDatepicker(newContentRow); // ADDED THIS LINE

        // removed line that re-added stylesheet.. not needed

        //Iterate row number
        rowNumber++;
      }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:00:55.760

用于[`.on()`](http://api.jquery.com/on/)将事件绑定到动态添加的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T17:03:52.780

要在 jquery 中复制，请使用：

```
$('#div-you-can-copy-it').clone().insertAfter('#last-div'); 
```

# ios - iOS - 更改 NSDate 格式使所有日期为一月

> ID：10076763
> 
> 赞同：0
> 
> 时间：2012-04-09T16:59:04.713
> 
> 标签：ios, nsdate, nsdateformatter

我正在尝试将从我的网络服务获得的日期格式更改为更友好的格式，这就是我所做的：

```
NSDateFormatter *currentFormat = [[NSDateFormatter alloc] init];
currentFormat.dateFormat = @"yyyy-mm-dd HH:mm:ss";
NSDate *date = [currentFormat dateFromString:[voicenote valueForKeyPath:@"Voicenote.created"]];
NSLog(@"%@", [currentFormat stringFromDate:date]);
NSDateFormatter *friendlyFormat = [[NSDateFormatter alloc] init];
friendlyFormat.dateFormat = @"EE, d LLL yyyy HH:mm"; 
```

但是当我去打印它时，最初的日期很好，但是当我将它更改为友好格式时，它们都是一月。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:10:27.893

检查您的日期格式字符串，尤其是 m 的大小写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:11:46.750

它是 yyyy-MM-dd，而不是 yyyy-mm-dd。一个常见的陷阱。

# javascript - 创建一个数组并输出其代码定义以进行预加载

> ID：10076766
> 
> 赞同：0
> 
> 时间：2012-04-09T16:59:08.267
> 
> 标签：javascript, arrays, html

我想创建一个代表我的 2d 画布的 2d 数组。对于每个像素，我将查找值，然后将整数 {0, 1, 2, 3, 4} 保存为数组的每个元素。不幸的是，每次我加载游戏时都需要很长时间才能运行。

如何编写一个脚本来为我创建这个数组并输出数组代码，这样我就可以将它粘贴到一个 js 文件中并预加载它？（我正在制作一个游戏的原型，所以我只需要为我的一两个测试地图运行它。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:09:53.527

您的 canvas('2d') 上下文包含一个方法 getImageData() ，它将返回一个一维数组，其中包含有关所有像素的信息。该数组包含每个像素的四个值，分别表示：R、G、B、A。

因此，您可以执行以下操作：

```
var context = canvas.context('2d');
var imageData = context.getImageData();
console.log(imageData): 
```

从控制台复制日志并将其粘贴到文件中的变量中...

```
var imageData = [.......];
var context = canvas.context('2d');
context.setImageData(imageData); 
```

[http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#2dcontext](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#2dcontext)

# objective-c - 如何确定 UIPickerView 旋转的方向？

> ID：10076769
> 
> 赞同：0
> 
> 时间：2012-04-09T16:59:25.717
> 
> 标签：objective-c, ios, uipickerview

在我的代码中，我需要知道此时我的 UIPickerView 旋转的方向。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:20:17.617

您需要子类化 UIPickerView 并添加标准的触摸处理事件。UIPickerView 由九个子视图组成，其中一个是 UIScrollView。使用[手势识别 api](https://stackoverflow.com/questions/8855145/ios-recognizing-gestures-simultaneously-with-object-handling)来处理事件。

[这里](https://stackoverflow.com/questions/567805/responding-to-touchesbegan-in-uipickerview-instead-of-uiview/6591975#6591975)的子类化示例。

# javascript - Javascript：使用 window.opener 表单弹出窗口将字符串添加到 iframe

> ID：10076770
> 
> 赞同：1
> 
> 时间：2012-04-09T16:59:27.933
> 
> 标签：javascript

我使用此代码将字符串添加到父窗口表单弹出窗口的元素：

```
window.opener.document.getElementById('myid').innerHTML += 'string'; 
```

现在我想将字符串添加到 iframe 表单 popup 的元素中。iframe 和父级都在同一个域中。我尝试此代码但不起作用：

```
parent.myframename.window.opener.document.getElementById('iframeelementid').innerHTML +=  'string'; 
```

怎么了？有没有办法做到这一点？

谢谢你的帮助。

*****更新*******

 **这是我的完整代码。主页：

```
<html>
<head>
<script>
function myPopup() {
  window.open( "pop.htm", "myWindow", "status = 1, height = 180px, width = 330px)
}
</script>
</head>
<body>
<textarea id="input"><iframe src="frame.html" name="myframe"></iframe> </textarea>

<a href="" onclick="myPopup()">Popup</a>
</body>
</html> 
```

和pop.htm：

```
<html>
<head>
<script>
function insert() {
  parent.myframe.window.opener.document.getElementById('inframe').innerHTML += 'asasasas';
  window.close();
  return false;
}
</script>
</head>
<body>
            <input type="button" id="insert" onclick="insert()" value="insert" />
</body>
</html> 
```

和 iframe.html：

```
<html>
<head>
</head>
<body>
       <span id="inframe"></span>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T10:06:26.783

使用此代码：

```
window.opener.document.getElementById('iframeelementid').innerHTML +=  'string'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T09:55:19.293

您可以使用`window.opener`

看[这里](http://www.w3schools.com/jsref/prop_win_opener.asp)

```
window.opener.document.getElementById('ID').innerHTML +=  'Yor STR'; 
```**

# php - 从 Android 发布 XML 数据并返回 PHP

> ID：10076779
> 
> 赞同：1
> 
> 时间：2012-04-09T16:59:54.573
> 
> 标签：php, android, xml, http-post

### 我正在做一个与 android 手机通信的 php 网络服务器。而安卓手机主要是收集位置信息并在位置更新时发送到网络服务器。

下面的代码是在线研究的，我不能很好地理解它们。

**我不确定如何阅读 PHP 中的 XML 格式数据。**

大多数示例使用**Parser**和**SimpleXML**，但他们大多**知道 xml 文件名**，但是我的代码似乎没有 xml 文件的命名。而且我不知道该怎么做。

连接 php webservice、生成 xml 文件并发送的代码。

```
private String postLocation(double lat, double lng){
    HttpPost httpPost = new HttpPost(url);
    try {
        StringBuilder sb = new StringBuilder();

        sb.append("<Location>");
        sb.append("<lat>");
        sb.append(lat);
        sb.append("</lat>");
        sb.append("<lng>");
        sb.append(lng);
        sb.append("</lng>");
        sb.append("</Location>");

        StringEntity entity = new StringEntity(sb.toString(), "UTF-8");
        httpPost.setEntity(entity);  
        httpPost.addHeader("Accept", "application/xml");
        httpPost.addHeader("Content-Type", "application/xml");

        HttpClient httpclient = new DefaultHttpClient();
        HttpResponse httpResponse = 
            (HttpResponse) httpclient.execute(httpPost);

        if (httpResponse.getStatusLine().getStatusCode() == 200) {
            String strResult = EntityUtils.toString(httpResponse
                    .getEntity());
            //return entity.toString();
            return strResult;
        }
    catch(exception.........){}
} 
```

# android - 如何在listview android中显示数据库

> ID：10076789
> 
> 赞同：0
> 
> 时间：2012-04-09T17:00:40.280
> 
> 标签：android, database, listview

这个问题很有名，但每个人都说去看看这个[记事本教程](http://developer.android.com/resources/tutorials/notepad/notepad-ex1.html)。

这会有所帮助，但是当您被卡住时，它并没有太大帮助。

所以我有我在 Android 上创建的这个数据库，我想在列表视图中显示它，我做了教程，但我仍然不明白为什么我不能让它在我的项目上工作，所以如果有人谁能帮忙，请展示自己！

* * *

这是我的代码

```
public class MyFridge extends ListActivity {

private DBAdapter db;
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.notepad_list);
    db = new DBAdapter(this);
    db.open();
    fillData();   

}@Override
public boolean onCreateOptionsMenu (Menu menu)
{

    super.onCreateOptionsMenu(menu);
    CreateMenu(menu);
    return true;
}

@Override
public boolean onOptionsItemSelected (MenuItem item)
{

    switch(item.getItemId())
    {
    case 0:

        Intent f = new Intent(MyFridge.this, Addform.class);
        startActivity(f);

            return true;

    case 1:

        Intent r = new Intent(MyFridge.this, MyRecipes.class);
        startActivity(r);

        return true;

    default:
        return super.onOptionsItemSelected(item);

        }
    }

private void CreateMenu(Menu menu) 
{
    MenuItem mnu1 = menu.add(0, 0, 0, "Add ingredient");
    {
        mnu1.setAlphabeticShortcut('a');//Change the alphabetic shortcut associated with this item.
        mnu1.setIcon(R.drawable.ic_launcher);

    }

    MenuItem mnu2 = menu.add(0, 1, 1, "Delete ingredient");
    {
        mnu2.setAlphabeticShortcut('b');//Change the alphabetic shortcut associated with this item.
        mnu2.setIcon(R.drawable.ic_launcher);
    }
    }

    private void fillData() {
        // Get all of the notes from the database and create the item list
        Cursor c = db.getAllCars();
        startManagingCursor(c);

        String[] from = new String[] { DBAdapter.KEY_TYPE };
        int[] to = new int[] { R.id.text1 };

        // Now create an array adapter and set it to display using our row
        SimpleCursorAdapter notes =
            new SimpleCursorAdapter(this, R.layout.notes_row, c, from, to);
        setListAdapter(notes);
    } 
```

* * *

这是我的数据库：

```
 public class DBAdapter {
    public static final String KEY_ROWID = "_id";
    public static final String KEY_TYPE = "type";
    public static final String KEY_WEIGHT = "weight";
    public static final String KEY_EXP = "expiration day";

    private static final String TAG = "DBAdapter";

    private static final String DATABASE_NAME = "MyDB";
    private static final String DATABASE_TABLE = "Fridge";
    private static final int DATABASE_VERSION = 2;

    private static final String DATABASE_CREATE =
        "create table Fridge (_id integer primary key autoincrement, "
        + "type text not null, weight integer not null, exp integer not null);";
    //CHECK (P_Id>0)

    private final Context context;    

    private DatabaseHelper DBHelper;
    private SQLiteDatabase db;

    public DBAdapter(Context ctx) 
    {
        this.context = ctx;  
        //It lets newly created objects understand what has been going on.
        //Typically you call it to get information regarding another part of your program
        DBHelper = new DatabaseHelper(context);
    }

    private static class DatabaseHelper extends SQLiteOpenHelper 
    {
        DatabaseHelper(Context context) 
        {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);//calls the context in the parent class
        }

        @Override
        public void onCreate(SQLiteDatabase db) 
        {
            try {
                db.execSQL(DATABASE_CREATE);    
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) // this method is used if the OS or the version App is changed
        {
            Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
                    + newVersion + ", which will destroy all old data");
            db.execSQL("DROP TABLE IF EXISTS cars");
            onCreate(db);
        }
    }    

    //---opens the database---
    public DBAdapter open() throws SQLException 
    {
        db = DBHelper.getWritableDatabase();
        return this;
    }

    //---closes the database---    
    public void close() 
    {
        DBHelper.close();
    }

    //---insert a contact into the database---
    public long insertCar(String type, int weight, int exp) 
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put(KEY_TYPE, type);
        initialValues.put(KEY_WEIGHT, weight);
        initialValues.put(KEY_EXP, exp);

        return db.insert(DATABASE_TABLE, null, initialValues);
    }

    //---deletes a particular contact---
    public boolean deleteCar(long rowId) 
    {
        return db.delete(DATABASE_TABLE, KEY_ROWID + "=" + rowId, null) > 0;
    }

    //---retrieves all the contacts---
    public Cursor getAllCars() 
    {
        return db.query(DATABASE_TABLE, new String[] {KEY_ROWID, KEY_TYPE,
                KEY_WEIGHT, KEY_EXP}, null, null, null, null, null);
    }

    /*
     * retrieves a particular car
     * 
     */
    public Cursor getCar(String searchString) //throws SQLException 
    {
        Cursor mCursor =
                db.query(true, DATABASE_TABLE, new String[] {KEY_ROWID,
                KEY_TYPE, KEY_WEIGHT,KEY_EXP},KEY_TYPE +"="+"'"+searchString+"'" +" OR "+ KEY_ROWID  + "=" + "'"+searchString +"'"+" OR "+ KEY_EXP + "=" + "'"+searchString +"'"+" OR " + KEY_WEIGHT + "=" + "'" + searchString +"'", null,
                null, null, null, null);

        return mCursor;
    }

    //---updates a contact---
    public boolean updateCar(long rowId, String type, int weight, int exp) 
    {
        ContentValues args = new ContentValues();
        args.put(KEY_TYPE, type);
        args.put(KEY_WEIGHT, weight);
        args.put(KEY_EXP, exp);

        return db.update(DATABASE_TABLE, args, KEY_ROWID + "=" + rowId, null) > 0;
    }
} 
```

* * *

日志信息。

```
04-09 18:14:47.128: D/TextLayoutCache(23297): Using debug level: 0 - Debug Enabled: 0
04-09 18:14:47.173: D/CLIPBOARD(23297): Hide Clipboard dialog at Starting input: finished by someone else... !
04-09 18:14:49.113: I/SqliteDatabaseCpp(23297): sqlite returned: error code = 1, msg = no such table: Fridge, db=xxx
04-09 18:14:49.113: D/AndroidRuntime(23297): Shutting down VM
04-09 18:14:49.118: W/dalvikvm(23297): threadid=1: thread exiting with uncaught exception (group=0x40c281f8)
04-09 18:14:49.123: E/AndroidRuntime(23297): FATAL EXCEPTION: main
04-09 18:14:49.123: E/AndroidRuntime(23297): java.lang.RuntimeException: Unable to start activity ComponentInfo{wijayaratnam.sutharsun.mobilefridge/wijayaratnam.sutharsun.mobilefridge.MyFridge}: android.database.sqlite.SQLiteException: no such table: Fridge: , while compiling: SELECT _id, type, weight, expiration day FROM Fridge
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1968)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1993)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.app.ActivityThread.access$600(ActivityThread.java:127)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1159)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.os.Looper.loop(Looper.java:137)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.app.ActivityThread.main(ActivityThread.java:4507)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at java.lang.reflect.Method.invokeNative(Native Method)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at java.lang.reflect.Method.invoke(Method.java:511)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at dalvik.system.NativeStart.main(Native Method)
04-09 18:14:49.123: E/AndroidRuntime(23297): Caused by: android.database.sqlite.SQLiteException: no such table: Fridge: , while compiling: SELECT _id, type, weight, expiration day FROM Fridge
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:68)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteProgram.compileSql(SQLiteProgram.java:143)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteProgram.compileAndbindAllArgs(SQLiteProgram.java:361)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:127)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:94)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:53)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:47)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1690)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1575)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1531)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1611)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at wijayaratnam.sutharsun.mobilefridge.DBAdapter.getAllCars(DBAdapter.java:101)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at wijayaratnam.sutharsun.mobilefridge.MyFridge.fillData(MyFridge.java:146)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at wijayaratnam.sutharsun.mobilefridge.MyFridge.onCreate(MyFridge.java:29)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.app.Activity.performCreate(Activity.java:4465)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052)
04-09 18:14:49.123: E/AndroidRuntime(23297):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1932)
04-09 18:14:49.123: E/AndroidRuntime(23297):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:14:34.800

`create table`如果您的错误是 sql“未找到列”，则将您的语句重写为：

```
private static final String DATABASE_CREATE =
    "create table " + DATABASE_TABLE + " ("
    + KEY_ROWID + " integer primary key autoincrement, "
    + KEY_TYPE + " text not null, "
    + KEY_WEIGHT + " integer not null, "
    + KEY_EXP + " integer not null);"; 
```

您会注意到您定义`KEY_EXP = "expiration day"`了但在您的创建语句中手动调用了该列`exp`；即未找到列。尝试尽可能多地使用您创建的那些变量来限制这些类型的拼写错误。祝你好运！

# iphone - iOS 4.3 上的图像负畸变

> ID：10076790
> 
> 赞同：0
> 
> 时间：2012-04-09T17:00:40.810
> 
> 标签：iphone, ios, image, ipad

我想，当我在 iPad 模拟器和设备上使用 iOS 4.3 时，为什么我的应用程序会出现图像失真。看截图。在 iOS 5.1 模拟器和设备上正常显示相同的图像。看第二张截图......我应该如何管理这个？是否可以在显示 JPEG 之前编写一些代码？ ![在 iOS 4.3 上失真](../Images/7670bd3c10a7d316608a9659715837a0.png) ![iOS 5.1 正常](../Images/d26baffedd93acc1575b05d7b7bc26fb.png) 不幸的是，我必须修复它，因为我的应用程序必须以某种方式在 iOS 4.3 上运行。

这是一种用于生成拇指的方法：

```
- (UIImage*)imageByScalingAndCroppingForSize:(CGSize)targetSize
{
UIImage *sourceImage = self;
UIImage *newImage = nil;        
CGSize imageSize = sourceImage.size;
CGFloat width = imageSize.width;
CGFloat height = imageSize.height;
CGFloat targetWidth = targetSize.width;
CGFloat targetHeight = targetSize.height;
CGFloat scaleFactor = 0.0;
CGFloat scaledWidth = targetWidth;
CGFloat scaledHeight = targetHeight;
CGPoint thumbnailPoint = CGPointMake(0.0,0.0);

if (CGSizeEqualToSize(imageSize, targetSize) == NO) 
{
    CGFloat widthFactor = targetWidth / width;
    CGFloat heightFactor = targetHeight / height;

    if (widthFactor > heightFactor) 
        scaleFactor = widthFactor; // scale to fit height
    else
        scaleFactor = heightFactor; // scale to fit width
    scaledWidth  = width * scaleFactor;
    scaledHeight = height * scaleFactor;

    // center the image
    if (widthFactor > heightFactor)
    {
        thumbnailPoint.y = (targetHeight - scaledHeight) * 0.5; 
    }
    else 
        if (widthFactor < heightFactor)
        {
            thumbnailPoint.x = (targetWidth - scaledWidth) * 0.5;
        }
}       

UIGraphicsBeginImageContext(targetSize); // this will crop

CGRect thumbnailRect = CGRectZero;
thumbnailRect.origin = thumbnailPoint;
thumbnailRect.size.width  = scaledWidth;
thumbnailRect.size.height = scaledHeight;

[sourceImage drawInRect:thumbnailRect];

newImage = UIGraphicsGetImageFromCurrentImageContext();
if(newImage == nil) 
    NSLog(@"could not scale image");

//pop the context to get back to the default
UIGraphicsEndImageContext();
return newImage;
} 
```

但是，如果我不使用它来准备我的图像，它仍然是负面的，但工作更慢，因为图像会自动调整大小。

此方法用于显示图像：

```
-(void) setImage:(UIImage*)image forState:(UIControlState) state
{
[self.buttonView setImage:image forState:state];
} 
```

这边走：

```
[current setImage:thumb forState:UIControlStateNormal]; 
```

是的，我忘了提，这些家伙只是视图控制器的自定义按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T23:24:32.260

我在 4.3 上遇到了同样的问题 - 原来图像是用 CMYK 颜色保存的。切换到 RGB 并重新保存图像使问题消失。

# backbone.js - 错误：必须指定 url 属性或函数

> ID：10076793
> 
> 赞同：10
> 
> 时间：2012-04-09T17:00:55.453
> 
> 标签：backbone.js, underscore.js, backbone-routing, backbone-model

这是我在 BackBone.js 上工作的最初几天。我实际上被路由器部分卡住了，因为我在控制台中收到错误“错误：必须指定 url 属性或函数”。这是我的场景；我有一个动态形成 REST URL 的点击函数，并相应地从服务器获取数据。

这是点击功能代码

```
function onUserClick(obj){
     var userID=$(obj).attr('id');
     window.location.href="#"+userID+"/";
     var userRouter = new UserRouter;
} 
```

我在路由器中有以下代码

```
var userModel;
var UserRouter = Backbone.Router.extend({
    routes:{
        ":userid/":"getUsers"
    },
    getUsers:function(userid){
        var url="http://myserver.com/users/"+userid;
        userModel = new UserModel({urlRoot:url});
        var userView = new UserView({el:$(#"container")});
    }
});
var UserModel = Backbobe.Model.extend({});
var UserView = Backbone.View.extend({
    model:userModel,
    initialize:function(){
        _.templateSettings = {
            interpolate: /\{\{\=(.+?)\}\}/g,
            evaluate: /\{\{(.+?)\}\}/g
        };
        this.model.fetch();
        this.model.bind("change",this.render,this);
    },
    render:function(){
        var data=this.model.toJSON();
        var userTemplate=_.template($("#userTemplate").text());
        var htmlData=userTemplate({
            "userData":data
        });
        $(this.el).html(htmlData);
    }
}); 
```

有人可以帮我解决这里的问题吗？我知道我在这里做错了什么，并就此寻求专家建议。非常感谢这种情况下的工作示例。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-09T18:01:49.940

您正在调用`fetch`您的模型：

```
var UserView = Backbone.View.extend({
    model: userModel,
    initialize: function() {
        // ...
        this.model.fetch(); 
```

但是你没有给你的模型一个`url`属性：

```
var UserModel = Backbone.Model.extend({}); 
```

该[`fetch`](http://backbonejs.org/#Model-fetch)方法与服务器对话，它用于`url`这样做：

> **网址** `model.url()`
> 
> 返回模型资源在服务器上的相对 URL。如果您的模型位于其他地方，请使用正确的逻辑覆盖此方法。生成表单的 URL: ，如果模型不是集合的一部分，则`"/[collection.url]/[id]"`回退到。`"/[urlRoot]/id"`

模型的[默认实现`url`](https://github.com/jashkenas/backbone/blob/1.0.0/backbone.js#L532)如下所示：

```
url: function() {
  var base = _.result(this, 'urlRoot') || _.result(this.collection, 'url') || urlError();
  if (this.isNew()) return base;
  return base + (base.charAt(base.length - 1) === '/' ? '' : '/') + encodeURIComponent(this.id);
}, 
```

您没有[`urlRoot`](http://backbonejs.org/#Model-urlRoot)，您没有将 URL 生成委托给的集合，并且您没有覆盖`url`所以`urlError()`被调用，这就是您的错误消息的来源。

您`UserModel`需要一个 RESTful`url`属性或函数，以便您可以`fetch`从服务器实例化。或者，您可以从客户端环境中已经可用的数据创建模型（当然，只要您不打算通过 Backbone 保存任何内容）。

# android - Android 仅第一次显示“新”图像

> ID：10076802
> 
> 赞同：1
> 
> 时间：2012-04-09T17:01:22.143
> 
> 标签：android

我已经部署了我的应用程序并且它正在使用中。每个月左右我都会更新它并添加新功能。我只想在用户第一次使用更新的应用程序时显示“新”图像。我怎样才能只显示一次？我应该从哪里开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:41:24.393

Maybe something like this may help to solve your problem:

```
public class mActivity extends Activity {
  @Overrride
  public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      this.setContentView(R.id.layout);

      // Get current version of the app
      PackageInfo packageInfo = this.getPackageManager()
          .getPackageInfo(getPackageName(), 0);
      int version = packageInfo.versionCode;

      SharedPreferences sharedPreferences = this.getPreferences(MODE_PRIVATE);
      boolean shown = sharedPreferences.getBoolean("shown_" + version, false);

      ImageView imageView = (ImageView) this.findViewById(R.id.newFeature);
      if(!shown) {
          imageView.setVisibility(View.VISIBLE);

          // "New feature" has been shown, then store the value in preferences
          SharedPreferences.Editor editor = sharedPreferences.edit();
          editor.put("shown_" + version, true);
          editor.commit();
      } else
          imageView.setVisibility(View.GONE);
  } 
```

The next time you run the application, the image will not show.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T17:06:51.967

如果您有可用于存储图像的服务器，请将其放在那里并在更新时下载。

简单的方法是使用 sharedprefernece 来保存当前的应用程序版本，然后在它打开时对其进行检查。如果它返回版本与存储的版本不同，请运行您的图像下载器并以所需的方式显示它。:)

这是我在我的一个应用程序中使用的一个示例，将 ImageView 声明放在你的 oncreate 中，并在其中的某个地方给方法他们自己的位置，你的好:)

要记住的另一件事是，您可以使用图像托管程序（例如 imgur）为您的客户托管“应用程序更新”图像，并且由于您会定期更新，因此您不必担心图像仍然存在时会被删除使用（如果您保持应用程序更新）

```
 private final static String URL = "http://hookupcellular.com/wp-content/images/android-app-update.png";

    ImageView imageView = new ImageView(this);
    imageView.setImageBitmap(downloadImage(URL));

private Bitmap downloadImage(String IMG_URL)
{
    Bitmap bitmap = null;
    InputStream in = null;        
    try {
        in = OpenHttpConnection(IMG_URL);
        bitmap = BitmapFactory.decodeStream(in);
       in.close();
 } catch (IOException e1) {
   e1.printStackTrace();
 }
 return bitmap;                
 }

private static InputStream OpenHttpConnection(String urlString) throws IOException
{
    InputStream in = null;
    int response = -1;

    URL url = new URL(urlString); 
    URLConnection conn = url.openConnection();

    if (!(conn instanceof HttpURLConnection))                     
        throw new IOException("Not an HTTP connection");

    try
    {
        HttpURLConnection httpConn = (HttpURLConnection) conn;
        httpConn.setAllowUserInteraction(false);
        httpConn.setInstanceFollowRedirects(true);
        httpConn.setRequestMethod("GET");
        httpConn.connect(); 

        response = httpConn.getResponseCode();                 
        if (response == HttpURLConnection.HTTP_OK) {
            in = httpConn.getInputStream();                                 
        }                     
    }
    catch (Exception ex)
    {
        throw new IOException("Error connecting to " + URL);
    }
    return in;     
} 
```

希望这会有所帮助：D

# ios - 使用低级 Web 服务将文档上传到 Sharepoint 库

> ID：10076804
> 
> 赞同：2
> 
> 时间：2012-04-09T17:01:25.017
> 
> 标签：ios, sharepoint, soap

我正在尝试将文档上传到 iOS 中 Sharepoint 的文档库，但成功有限。

我已经使用[Copy.CopyIntoItems](http://msdn.microsoft.com/en-us/library/copy.copy.copyintoitems%28v=office.12%29.aspx)至少让我的文档出现在目标文档库中，使用这个肥皂请求：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <CopyIntoItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">
      <SourceUrl>[server url]</SourceUrl>
      <DestinationUrls><string>[server url]</string></DestinationUrls>
      <Fields></Fields>
      <Stream>[base 64 encoded string]</Stream>
    </CopyIntoItems>
  </soap:Body>
</soap:Envelope> 
```

这让我至少可以让我的文档出现在我的图书馆中。但是，响应没有给我任何关于它们的元数据（如 GUID 等），这使得我更难管理。此外，在浏览器中查看项目时，我还有其他操作选项，例如“查看源项目”，以及删除额外提示时指出“该项目是从另一个位置复制的......”。由于使用 SharePoint 的主要是 Bob，这只会使他们感到困惑。理想情况下，文档的操作看起来与直接通过浏览器中的文档库上传时的操作相同。透明度越高越好。

我在网上看到的另一个常见解决方案是结合使用[Lists.UpdateListItems](http://msdn.microsoft.com/en-us/library/lists.lists.updatelistitems%28v=office.12%29.aspx)和 Lists.AddAttachment。我已经让 Lists.UpdateListItems 正常工作并创建了一个新条目（这很好，因为它可以像 GUID 一样返回元数据，并且至少乍一看*看起来*与表单上传的文档相同）。但是， Lists.AddAttachment 对我不起作用。对 AddAttachment 使用此 SOAP 请求（GUID 是带有 UpdateListItems 的新添加项目的 GUID）：

```
<?xml version="1.0" ?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <soap:Body>
    <AddAttachment xmlns="http://schemas.microsoft.com/sharepoint/soap/">
      <listName>Test</listName>
      <listItemID>{1F214D95-B92B-4E10-8B96-4B04DC6DA9B6}</listItemID>
      <fileName>screenshot.png</fileName>
      <attachment>[base 64 string]</attachment>
    </AddAttachment>
  </soap:Body>
</soap:Envelope> 
```

我得到以下回复：

```
<?xml version="1.0" ?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <soap:Body>
    <soap:Fault>
      <faultcode>
        soap:Server
      </faultcode>
      <faultstring>
        Exception of type 'Microsoft.SharePoint.SoapServer.SoapServerException' was thrown.
      </faultstring>
      <detail>
        <errorstring xmlns="http://schemas.microsoft.com/sharepoint/soap/">
          Input string was not in a correct format.
        </errorstring>
      </detail>
    </soap:Fault>
  </soap:Body>
</soap:Envelope> 
```

有任何想法吗？我确定我在某个地方走错了路，我只是不确定在哪里。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T12:47:14.717

今天早上开始工作了。我最终采用了最简单的方法，老实说，我从未想过它会与 Microsoft API 一起使用。

```
NSString *fullPath = @"https://site/library/folders/document.txt";
NSURL *url = [NSURL URLWithString: fullPath];
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
request.HTTPMethod = @"PUT";
request.HTTPBody = [NSData {documentData}];

//this is the authentication Cookie acquired in a previous request.
[request addValue:cookie forHTTPHeaderField:@"Cookie"];
[NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil]; 
```

关键似乎是使用 PUT 作为方法。

重要的是要注意，不幸的是，这会受到上述返回的元数据有限的问题的影响，但由于这种行为与直接通过 SharePoint 网站上传非常相似，所以我认为这没问题。我可能只是要重新设计我决定是否下载/更新现有文档的逻辑。

# c++ - 使用全局变量编写程序更安全吗？

> ID：10076807
> 
> 赞同：2
> 
> 时间：2012-04-09T17:01:36.220
> 
> 标签：c++, c, overflow

我正在阅读有关缓冲区、堆栈和堆溢出的信息。我也读了这篇[文章](http://www.h-online.com/security/features/A-Heap-of-Risk-747161.html)。我的问题是这样的：如果我在代码中只使用全局变量，我可以说它可以防止所有溢出漏洞吗？

假设我在全局范围内声明的代码中有这个缓冲区：

```
char buf1[10];
char buf2[100]; 
```

如果我`buf1`作为缓冲区发送到`recv(int s, char *buf, int len,int flags);`

1.  我会覆盖数据段，可能会破坏`buf2`内容，对吗？
2.  我是否能够从中运行代码，因为我知道它不是代码段并且数据段不可执行。

我们可以得出结论，使用 Globals 是最安全的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T17:03:51.337

一点都不。虽然直接修改堆栈上的返回地址等更难，但仍然有可能破坏或恶意攻击这样的程序（如果它不注意缓冲区溢出）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T17:04:32.443

> 我可以说它可以防止所有溢出漏洞吗？

不，全局变量会溢出。

> 如果假设我将其作为缓冲区发送到 recv(int s, char *buf, int len,int flags); 我将覆盖数据段并可能破坏 buf2 内容，但我无法从中运行代码。我对吗？使用 Globals 是最安全的方法吗？

不，变量的存储时长对它是否可以溢出没有影响。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T17:08:55.117

避免缓冲区溢出的最佳方法是避免使用静态缓冲区，并为任何需要内存分配的对象使用 STL、boost 等库，例如使用 STL 向量代替数组。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T17:09:30.917

由于堆栈上的缓冲区与沿堆栈更远的返回地址位于同一位置，因此存在缓冲区溢出漏洞。最终，函数必须返回并使用该地址继续执行。通过故意覆盖缓冲区，可以存放一个不同的返回地址，也许是利用者存放的代码。

当然，使用全局缓冲区可以减少这种特定类型的漏洞利用的机会。但是，它不会降低由于当前操作范围之外的数据损坏而导致应用程序失败的可能性。

全球数据也有其缺点，它不是一个全面的解决方案。因此，最好的方法是防御性地设计您的代码，以便根本不会发生缓冲区溢出，无论缓冲区位于何处。

C 和 C++ 都提供安全版本的缓冲区函数，这些应该与良好的设计一起使用，作为防止安全漏洞的主要防护措施。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-09T17:12:16.330

您的数据在哪里并不重要。如果你足够努力，你可以在外面写。是否可以使用任何堆栈缓冲区溢出来覆盖返回地址并导致缓冲区中的代码被执行，这取决于体系结构。恕我直言，堆栈段中的数据不应该是可执行的，并且尝试执行它应该会导致内存管理中断。

除了琐碎的应用程序之外，使用“全局变量”而不是堆栈变量无论如何都不是一个明智的解决方案。

我只将数据加载到缓冲区类中动态分配的缓冲区中，因此堆栈缓冲区溢出在我的应用程序中从来都不是问题，（此外，我只是不会溢出缓冲区！）。

# java - 用于保持集合中数据索引一致的 Java 模式

> ID：10076811
> 
> 赞同：5
> 
> 时间：2012-04-09T17:02:34.753
> 
> 标签：java, collections

假设我有一个`List<Person> all`数据结构，其中`Person`定义为：

```
class Person {
   String firstName;
   String secondName;
   boolean hasValidDrivingLicense;
} 
```

我想保留一个`List<Person> drivers`仅包含拥有有效驾驶执照的人的冗余。我认为它也可以被视为一个索引（一个索引将包含所有项目，但目的非常相似）。
这是为了避免每次我需要这些数据时都需要遍历整个列表。
（每次循环的优点是我对我的 hasValidDrivingLicense 信息有一个单一的权威表示；放弃这条路需要：a）有效的原因 b）经过测试的替代方案。原因取决于具体问题；另一种方法是我在这里开发的:-)） 我可能有这样
**的问题：** 

```
void add(Person p) {
   all.add(p);
   if (p.hasValidDrivingLicense()) {
       drivers.add(p);
   }
} 
```

这通常有效。

```
Person p = new Person(); //then set fields, of course.
add(p);
p.setHasValidDrivingLicense(true); 
```

这里没有。 *所以问题是：冗余信息可能会错位。索引可能会“损坏”。*

**解决方案**

1.  Person 的 hasValidDrivingLicense 属性实现 Observable 设计模式（或发布-订阅者，摇摆中的内容基于 Listener 接口） index-mantainer 对象已更改相关属性。Observable 似乎是一个明确的解决方案。没有任何问题。
2.  人是不可变的

**问题**

不变性似乎是一个可行的解决方案，但是，从集合维护者的角度来看，这是编写代码的人：

```
public void add(Person p) {
     ...
} 
```

必须确保 p 是不可变的或更好的，至少 hasValidDrivingLicense 是最终的。

a）这可以通过反射来完成（http://stackoverflow.com/questions/203475/how-do-i-identify-immutable-objects-in-java）但这不需要新的性能评估吗？反思不是有代价的吗？

b）可能在设计模式或语言的新特性（例如注释）中是否有解决这个问题的其他解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T10:12:17.933

我猜你想要的是你*所有*收藏的“实时”*过滤*视图。

 *这可以通过 Google Guava 和 Predicate 很好地完成：

[http://docs.guava-libraries.googlecode.com/git-history/v11.0.2/javadoc/com/google/common/collect/Collections2.html#filter%28java.util.Collection,%20com.google.common .base.Predicate%29](http://docs.guava-libraries.googlecode.com/git-history/v11.0.2/javadoc/com/google/common/collect/Collections2.html#filter%28java.util.Collection,%20com.google.common.base.Predicate%29)

另一方面，仅实现 List peopleWithDriversLicens() {...} 也很容易，因此 Guava 可能是矫枉过正 - 取决于您的需求，包括性能特征。*

# java - 在 Java 中创建动画 gif

> ID：10076814
> 
> 赞同：0
> 
> 时间：2012-04-09T17:02:45.227
> 
> 标签：java, image, animated-gif

我需要使用 Java 中的帧创建动画 GIF。例如，我将创建一个函数的图形，它会随着一些参数而改变。将创建很多帧，我需要用这些帧创建 GIF。我应该从哪里开始？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:25:26.413

也许这可能会有所帮助：

[http://www.javakb.com/Uwe/Forum.aspx/java-programmer/32892/Help-with-GIF-writer-in-imageio#art5](http://www.javakb.com/Uwe/Forum.aspx/java-programmer/32892/Help-with-GIF-writer-in-imageio#art5)

@ax 的道具。对于链接

# java - 在 Java 应用程序中处理大量输入数据

> ID：10076816
> 
> 赞同：-2
> 
> 时间：2012-04-09T17:03:04.950
> 
> 标签：java, import-from-excel

我有一个 Web 应用程序，我需要从 Excel 格式的文件中输入大量数据——比如 10,000 行和 200 列。然后我需要处理这些数据，然后从数据库中插入/更新/删除。

我已经尝试通过将所有内容都放在 java 代码应用程序中来做到这一点，但结果太慢了。

有人可以提出更好的方法吗？注意我没有将这些数据放入某些类或对象中。我只是在处理和更新数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:19:09.463

我建议你使用流技术。使用 Apache Commons FileUpload： [http ://commons.apache.org/fileupload/streaming.html](http://commons.apache.org/fileupload/streaming.html)

然后一一处理记录，这样你就不会分配内存。需要考虑的事项：如果您的流程在中间中断，会发生什么？如果这对您很重要，请使用事务。不幸的是，我无法为您提供阅读 XLS 格式的提示，但如果您可以使用 CSV，事情会变得更简单 - 用于此的库很少。

您可以微调 FileUpload 以将数据存储在内存、磁盘或组合中。或者您可以相信它会做正确的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T18:08:45.187

目前还不清楚您的应用程序中发生了什么：您是在与用户输入（上传）交互还是只是在初始化应用程序？如果是后者，数据更新当然可以在安装应用程序时完成一次，而不是在请求阶段。如果是前者，则取决于很多因素：如何读取数据？文件 IO 可能很慢；你如何更新数据库？- 使用存储过程？或者只是简单的 JDBC SQL 子句。如果整个过程似乎太慢而无法完成，那么某种后台线程可能会更好。

# c# - 对 Func 进行单元测试 Rhino Mocks 通过第二次 Expect() 调用抛出 InvalidCastException

> ID：10076819
> 
> 赞同：0
> 
> 时间：2012-04-09T17:03:14.760
> 
> 标签：c#, rhino-mocks

我正在对一个获取 Autofac 注入的一些参数的类进行单元测试。

一些参数是`Func<Delegate>`. 这允许我创建多个代表来使用。如果您需要更好的描述，请参阅[此 Autofac Wiki 页面。](http://code.google.com/p/autofac/wiki/RelationshipTypes)

这是课程的一部分。

```
public class CreateProductCommand : TransactionalDBCommandBase<ProductImpl>
{
    public delegate CreateProductCommand Factory(ProductInfo info, IAppSecurityContext context);

    private ProductInfo _info;
    private Func<SaveTextMasterCommand.Factory> _saveTextMasterCommandFactory;
    private Func<SaveTextValueCommand.Factory> _saveTextValueCommandFactory;
    private SaveProductCommand.Factory _saveProductCommand;

    public CreateProductCommand(ProductInfo info, Func<SaveTextMasterCommand.Factory> saveTextMasterCommandFactory, 
        Func<SaveTextValueCommand.Factory> saveTextValueCommandFactory, SaveProductCommand.Factory saveProductCommand, IAppSecurityContext context)
    {
        this._info = info;
        this._saveTextMasterCommandFactory = saveTextMasterCommandFactory;
        this._saveTextValueCommandFactory = saveTextValueCommandFactory;
        this._saveProductCommand = saveProductCommand;
        this.CurrentContext = context;
    }

    public override ProductImpl Execute(IDataTransaction dataTrans)
    {
         //More code here
         this._saveTextMasterCommandFactory().Invoke(SomeParam,SomeParam2).Execute(dataTrans);

        //Some time later
        this._saveTextMasterCommandFactory().Invoke(SomeDiffParam,SomeDiffParam2).Execute(dataTrans);
    }
} 
```

测试类看起来像这样。设置是巨大的。我将在问题所在的代码块的左侧对齐。

```
[TestFixture]
    public class CreateProductCommandTests
    {
        private IDataTransaction _dtMock;
        private IDataAccessAdapter _daaMock;

        private Func<SaveTextMasterCommand.Factory> stmfMock;
        private Func<SaveTextValueCommand.Factory> stvfMock;
        private SaveProductCommand.Factory saveProductDelMock;
        private ProductInfo info;
        private IAppSecurityContext context;

        [SetUp]
        public void SetUp()
        {
            this._dtMock = MockRepository.GenerateMock<IDataTransaction>();
            this._daaMock = MockRepository.GenerateMock<IDataAccessAdapter>();
            this._dtMock.Expect(m => m.DataAccessAdapter).Repeat.Any().Return(this._daaMock);
            stvfMock = MockRepository.GenerateMock<Func<SaveTextValueCommand.Factory>>();
            stmfMock = MockRepository.GenerateMock<Func<SaveTextMasterCommand.Factory>>();
            context = new AppSecurityContext() { LanguageID = 1 };

            info = new ProductInfo()
            {
                CatalogNumber = "CatalogNumber",
                BrandID = 1,
                ProductDescription = "ProductDescription",
                ProductName = "ProductName"
            };

            //Mock the command
            var nameTextMaster = new TextMasterImpl() { AltTextMasterID = new Guid().ToString("N"), IsCoreAppText = false, TextMasterID = 1 };
            var nameTextMasterMock = MockRepository.GenerateMock<SaveTextMasterCommand>(null, null);
            nameTextMasterMock.Expect(m => m.Execute(Arg<IDataTransaction>.Is.Equal(this._dtMock))).Return(nameTextMaster);

            //Mock the Delegate that creates it.
            var nameTextMasterFactoryMock = MockRepository.GenerateMock<SaveTextMasterCommand.Factory>();
            nameTextMasterFactoryMock.Expect(m => m(Arg<TextMasterImpl>.Is.Anything, Arg<IAppSecurityContext>.Is.Anything)).Return(nameTextMasterMock);

//This call here is fine.  Passes with no problem.
            stmfMock.Expect(m => m()).Return(nameTextMasterFactoryMock);

            //NameTextValue Mocking.
            var nameTextValue = new TextValueImpl() { LanguageID = 1, ContentText = "NameTextValue", TextMasterID = 1, TranslationStatus = 0, TextValueID = 1 };
            var nameTextValueMock = MockRepository.GenerateMock<SaveTextValueCommand>(null, null);
            nameTextValueMock.Expect(m => m.Execute(Arg<IDataTransaction>.Is.Equal(this._dtMock))).Return(nameTextValue);

            var nameTextValueFactoryMock = MockRepository.GenerateMock<SaveTextValueCommand.Factory>();
            nameTextValueFactoryMock.Expect(m => m(Arg<TextValueImpl>.Matches(n => n.TextMasterID == nameTextMaster.TextMasterID && n.ContentText == info.ProductName),
                Arg<IAppSecurityContext>.Is.Anything)).Return(nameTextValueMock);

            stvfMock.Expect(m => m()).Repeat.Once().Return(nameTextValueFactoryMock);

            //DescriptionTextMaster Mocking
            var descTextMaster = new TextMasterImpl() { AltTextMasterID = new Guid().ToString("N"), IsCoreAppText = false, TextMasterID = 2 };
            var descTextMasterMock = MockRepository.GenerateMock<SaveTextMasterCommand>(null, null);
            descTextMasterMock.Expect(m => m.Execute(Arg<IDataTransaction>.Is.Equal(this._dtMock))).Return(descTextMaster);

            //Delegate mock
            var descTextMasterFactoryMock = MockRepository.GenerateMock<SaveTextMasterCommand.Factory>();
            descTextMasterFactoryMock.Expect(m => m(Arg<TextMasterImpl>.Is.Anything, Arg<IAppSecurityContext>.Is.Anything)).Return(descTextMasterMock);

//THIS call fails with an InvalidCastException
            stmfMock.Expect(m => m()).Return(descTextMasterFactoryMock);

            var descTextValue = new TextValueImpl() { LanguageID = 1, ContentText = "DescTextValue", TextValueID = 2, TextMasterID = 2, TranslationStatus = 0 };
            var descTextValueMock = MockRepository.GenerateMock<SaveTextValueCommand>(null, null);
            descTextValueMock.Expect(m => m.Execute(Arg<IDataTransaction>.Is.Equal(this._dtMock))).Return(descTextValue);

            var descTextValueFactoryMock = MockRepository.GenerateMock<SaveTextValueCommand.Factory>();
            descTextValueFactoryMock.Expect(m => m(Arg<TextValueImpl>.Matches(n => n.TextMasterID == descTextMaster.TextMasterID && n.ContentText == info.ProductDescription), 
                Arg<IAppSecurityContext>.Is.Anything)).Return(descTextValueMock);

            stvfMock.Expect(m => m()).Repeat.Once().Return(descTextValueFactoryMock);

            var product = new ProductImpl() { ProductNameTextID = nameTextMaster.TextMasterID, DescriptionTextID = descTextMaster.TextMasterID, CatalogNumber = info.CatalogNumber, ProductID = 1 };
            var saveProductCommandMock = MockRepository.GenerateMock<SaveProductCommand>(null, null);
            saveProductCommandMock.Expect(m => m.Execute(Arg<IDataTransaction>.Is.Equal(this._dtMock))).Return(product);

            saveProductDelMock = MockRepository.GenerateMock<SaveProductCommand.Factory>();
            saveProductDelMock.Expect(m => m(Arg<ProductImpl>.Is.Equal(product), Arg<IAppSecurityContext>.Is.Anything)).Return(saveProductCommandMock);
        }
} 
```

例外情况是：无法将“ProxyDelegate_Factory_3Proxyef78e79dacee4c759351a5ffaa933f85”类型的对象转换为“Factory”类型。

我不确定如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:35:08.143

这个建议并不是特别受到您收到的异常消息的启发，因此它可能无济于事。在我看来，您没有向模拟存储库提供足够的信息，但是：

```
stmfMock.Expect(m => m()).Return(nameTextMasterFactoryMock);
//...
stmfMock.Expect(m => m()).Return(descTextMasterFactoryMock); 
```

您有相同的模拟，期望调用相同的方法（即，`Invoke`），并且您告诉它返回两个不同的东西。这个怎么样：

```
stmfMock.Expect(m => m()).Repeat.Once().Return(nameTextMasterFactoryMock);
//...
stmfMock.Expect(m => m()).Repeat.Once().Return(descTextMasterFactoryMock); 
```

# linker - CMake Pkg-Config 库链接路径

> ID：10076820
> 
> 赞同：7
> 
> 时间：2012-04-09T17:03:22.253
> 
> 标签：linker, cmake, pkg-config

因此，我正在编译 libgstreamermm-0.10 的示例，并且遇到了 CMake 的问题。

使用我的系统上默认安装的 libgstreamermm-0.10 版本，示例段错误。好的，所以我获得了最新的源并将它们安装到 /usr/local 并获得了新示例。一切看起来都很好。

```
g++ main.cc player_window.cc -o test `pkg-config --cflags --libs gtkmm-3.0` `pkg-config --cflags --libs gstreamermm-0.10` 
```

工作正常，符合预期。太好了，现在尝试让它与 CMake 很好地配合使用。我制作了一个快速的 CMakeLists.txt 文件。我使用 pkg-config，因为它工作得很好，我真的不想添加一个 find 模块。所以我的文件看起来像这样：

```
cmake_minimum_required(VERSION 2.6.2)
project(media_player_gtkmm)

INCLUDE(FindPkgConfig)

set(SOURCES main.cc player_window.cc)

add_executable(media_player_gtkmm ${SOURCES})

#dependencies
pkg_check_modules(GSTMM REQUIRED gstreamermm-0.10)
pkg_check_modules(GTKMM REQUIRED gtkmm-3.0)
include_directories(${GTKMM_INCLUDE_DIRS} ${GSTMM_INCLUDE_DIRS})
link_directories(${GTKMM_LIBRARY_DIRS} ${GSTMM_LIBRARY_DIRS})
target_link_libraries(media_player_gtkmm ${GTKMM_LIBRARIES} ${GSTMM_LIBRARIES}) 
```

一切都编译到链接阶段，我得到未定义的符号错误。然后我看到`pkg-config --libs gstreamermm-0.10`以 -L/usr/local/lib 开头的输出。我查看了`make VERBOSE=1`CMake 的输出并且没有将 -L 添加到链接命令中，即使我有 link_directories 行。因此，即使我在 /usr/local/include 中使用新版本 gstreamer 的标头，当我希望使用 /usr/local/lib 中的版本时，也会使用 /usr/lib 中的库. Pkg-Config 似乎接受了这一点，并进行了相应的调整，但是 CMake，即使我在内部使用 pkg-config，也不会接受链接标志。

我现在可以手动设置链接标志，但这似乎有点小技巧。我确信有更好的方法来指定这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T17:08:09.443

`link_directories`只影响它[之后](http://www.cmake.org/pipermail/cmake/2008-April/021283.html)的目标。因此，您需要`add_executable`在`link_directories`通话后移动您的位置。

# powershell - 将多张表合并为一张表

> ID：10076822
> 
> 赞同：0
> 
> 时间：2012-04-09T17:03:26.540
> 
> 标签：powershell

运行此 powershell 命令时

```
Get-ChildItem -Recurse -Include *.txt 
```

您在输出中获得多个表，每个目录一个表。

我可以使用什么方法将多个表合并为一个表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:41:24.633

您将需要选择所需的属性。否则，您将获得每个子文件夹的单独列表。你可以尝试这样的事情：

PS C:>dir c:\scripts -recurse -include *.txt | 选择模式、上次写入时间、长度、全名 | 格式表-自动

# python - 打印压缩生成器结果

> ID：10076825
> 
> 赞同：0
> 
> 时间：2012-04-09T17:03:36.323
> 
> 标签：python

任何想法如何打印

```
(([0.2, 0.6], [0.5, 0.8]), "10 11 {'chocolate': 10}")
(([0.0, 0.6], [0.8, 0.5]), "10 12 {'chocolate': 10}") 
```

作为..

```
0.2  0.6  0.5  0.8  10  11 chocolate 10
0.0  0.6  0.8  0.5  10  12 chocolate 10 
```

我还设法强迫它（暂时忽略巧克力）：

```
(([0.2, 0.6], [0.5, 0.8]), '10 11 10')
(([0.0, 0.6], [0.8, 0.5]), '10 12 10') 
```

如果这更容易变成

```
0.2  0.6  0.5  0.8  10  11  10
0.0  0.6  0.8  0.5  10  12  10 
```

尝试了我在这里发现的其他问题，但例如

```
 print  '\n'.join('\t'.join(map(str,tuple(chain(*i)))) for i in s) 
```

这会导致单词和最后一个元素看起来像

```
 c        h      o       c        o        l      a      t    e 
```

我还在努力......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T17:10:52.797

如果您的数据是

```
>>> spam=(([0.2, 0.6], [0.5, 0.8]), "10 11 {'chocolate': 10}") 
```

你可以简单地做

```
>>> print str(spam).translate(None,"([]){},\"'")
0.2 0.6 0.5 0.8 10 11 chocolate: 10 
```

如果你想制表你的数据

```
>>> print str(spam).translate(None,"([]){},\"'").replace(' ','\t')
0.2 0.6 0.5 0.8 10  11  chocolate:  10
>>> 
```

如果您对最终输出中的大括号 '{' 和冒号 ':' 感到满意，您也可以这样做

```
>>> ''.join(map(str,list(itertools.chain(*list(itertools.chain(*spam))))))
"0.20.60.50.810 11 {'chocolate': 10}" 
```

或者你目前在做什么

```
>>> print ''.join(map(str,list(itertools.chain(*list(itertools.chain(*spam))))))
0.20.60.50.810 11 {'chocolate': 10}
>>> 
```

这类似于您的表达试图实现的目标，但是添加`tab`并破坏了它`newline`。`join`

但是我觉得在简单性和可读性方面，前一种方法会更好

# c# - 为什么在文本框中显示我的 DateTime 结果与直接在 html 中显示不同？

> ID：10076826
> 
> 赞同：1
> 
> 时间：2012-04-09T17:03:39.303
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

在我看来，我有以下代码：

```
@using (Html.BeginForm()) {
  @Html.TextBox("Date2", Model.Date2)
  <br/>
  @Model.Date2
  <input type="submit" value="Create" />
} 
```

在我的控制器中，我有：

```
 [HttpPost]
    public ActionResult Index(Home home){
        ViewBag.Message = "Welcome to ASP.NET MVC! (after a submit)";
        home.Date2 = home.Date2.AddDays(1);
        return View("Index", home);
    } 
```

型号为：

```
public class Home {
    public DateTime Date2 { get; set; }
} 
```

我的问题是：为什么当我点击提交按钮时，文本框显示的日期不是多一天的日期，而我直接输出的 html 日期是？

## 编辑：

如果我进入 MVC3 源代码，我可以看到`private static MvcHtmlString InputHelper(...)`获取具有良好日期的 value 参数，但后来代码从`attemptedValue`...获取旧值您可以在此处查看调试[http://i.stack.imgur.com/x2mTI .png](http://i.stack.imgur.com/x2mTI.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:58:07.263

我遇到了同样的问题......它与传递给 Action 的属性有关，该属性与从 Action 返回的属性同名，但具有不同的值。

我无法回答为什么会发生这种情况，但我可以提供有关如何修复它的解决方案（好吧，可能不是您的情况，因为您接受并返回相同的模型）。

```
public Action(IncomingViewModel incomingViewModel)
{
    var viewModel = new ViewModel();
    //incoming Date has different name than outgoing date
    viewModel.Date2 = incomingViewModel.OldDate2;
    return viewModel;
} 
```

就像我说的，这在你的情况下是一种黑客攻击（在我的情况下并没有那么大）。同样，它不能解决您的问题，但可能会让您更接近解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T18:06:11.507

这是因为当从发布操作返回视图时，所有 MVC 辅助方法（Html.Textbox、Html.DropdownList 等）都使用发布的值而不是实际对象的值来呈现元素。

这使得返回带有验证错误的视图，例如，准确呈现用户的输入，而不是可以在操作中更改的其他值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T18:07:45.723

`ModelState`将输入值的副本保存到表单字段中。通常，如果您在`POST`操作中显示表单，那是因为验证失败，因此您希望重新显示“尝试”值输入而不是新值（这是输入 HTML 帮助程序默认执行的操作）。

为了防止它使用尝试的值，您可以将其从 ModelState 中删除，例如：

```
 [HttpPost]
    public ActionResult Index(Home home)
    {
        ViewBag.Message = "Welcome to ASP.NET MVC! (after a submit)";
        ModelState.Remove("Date2");
        home.Date2 = home.Date2.AddDays(1);
        return View("Index", home);
    } 
```

# asp.net - 通过 ASP.NET 运行应用程序

> ID：10076827
> 
> 赞同：1
> 
> 时间：2012-04-09T17:03:42.017
> 
> 标签：asp.net, sql

我的女朋友拥有一个晒黑沙龙。下面是她把人放在床上时看到的图像：

![在此处输入图像描述](../Images/3ce5bdab7954fe202196b1392267df87.png)

此图像是从名为 Tan Track 的软件应用程序中提取的。无论如何，是否可以使用 Web 应用程序以某种方式调用或引用该软件？其目的是让其他客户可以在家中查看信息并查看有哪些床位可用，或许还可以查看排队客户的队列。如果没有从 Tan Track 获取源代码，使用 ASP.NET 可以做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:06:25.033

只有两种可能的选择：

1.  应用程序本身公开了一个您可以利用的 API。（不大可能）
2.  如果您对用于存储基础数据的数据库具有管理权限，则可以针对该数据库编写任何您喜欢的旧 Web 应用程序。但是，这可能是非法使用他们的软件和违反许可条款。

最有可能的是，提供服务的唯一合乎道德/合法的方法是联系软件的制造商，看看他们是否为客户提供插件接口，或者是否合法允许您自己编写一个。

**这样做的法律/道德方式是：（** 请记住，这不是法律建议。我没有资格提供法律建议。您可能还想与律师交谈。）

**具体**询问他们是否允许您使用他们数据库中的数据编写自己的应用程序，并解释您想要这样做的原因。

***如果他们说允许：***

试着写下来。

您需要弄清楚他们正在使用什么数据库，并相应地编写代码，但如果您对数据库有合法访问权限，那么可以，您可以编写任何类型的应用程序来读取和显示数据。

听起来您可能是开发新手，所以我只是提醒您确保您知道如何安全地编码（访问[OWASP 站点](https://www.owasp.org/index.php/Category%3aOWASP_Top_Ten_Project)，[从他们的站点熟悉 Microsoft SDL](http://www.microsoft.com/security/sdl/default.aspx)，并让您自己熟悉[这个旧的，但对于构建安全的 ASP.NET 网站](http://msdn.microsoft.com/en-us/library/ff649100.aspx) ***和*** [这个](http://msdn.microsoft.com/en-us/library/ff649874.aspx)[网站仍然非常相关和有用的指南](http://msdn.microsoft.com/en-us/library/ff649100.aspx)。）并且您了解什么是敏感数据。例如，如果没有使用姓名，则显示排队的客户队列是可以的，但显示客户的姓名可能不是一个好主意 - 他们可能不希望在您的网站上宣传他们正在晒黑，或者可能不希望他们虐待的前男友知道什么时候可以在那里找到他们，等等。

认真思考“如果我的网站遭到入侵，可能发生的最糟糕的情况是什么——有人可以用这些数据做什么？” 如果您要存储客户的家庭住址，则要翻四倍；如果要存储任何类型的付款信息，则要翻 100 倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:06:42.640

除非 Tan Track 公开允许您访问其数据的[Web 服务（或类似的东西），否则可能没有（道德）方法来检索此信息。](https://developer.mozilla.org/en/XML_Web_Services)您需要联系供应商以查看他们是否允许客户访问其应用程序数据以供自定义使用。

看起来那是一个桌面应用程序，所以似乎不太可能存在这样的 API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T17:07:04.927

如果应用程序是使用将业务逻辑与表示逻辑分离的良好模式编写的，并且它是用 C# 编写的，那么应该可以编写自己的 ASP.net Web 前端来模拟您所看到的。

可悲的是，这种情况很少发生，而且发现这一点的工作量将超过其价值。

从好的方面来说，这个应用程序，乍一看，并没有太复杂，从头开始编写应该比逆向工程 dll 以及它们如何与表示层一起工作所花费的时间更少。

编辑：对不起，我做了一些错误的假设，我以为你可以访问代码。如果您想通过 Web 访问此应用程序，有一种解决方法...

您可以将远程桌面设置为在工作桌面上运行，以便您可以通过 Internet 访问。

# java - 在测验应用程序中制作 3 个难度级别

> ID：10076829
> 
> 赞同：3
> 
> 时间：2012-04-09T17:03:51.673
> 
> 标签：java, android, algorithm

我正在 Android 上开发一个简单的测验应用程序。随着测验的推进，测验中的问题应该变得更加困难。现在，我正在尝试实现一个静态方法，该方法采用`Question`对象列表并根据难度生成（选择）适当问题的子列表，并且应该对其进行排序（列表中的第一个问题是最简单的问题）。该应用程序有 3 个难度级别（模式）。

这是方法片段：

```
public static List<Question> getQuestions(List<Question> availableQuestions,
                                       int quizDifficulty, int numberOfQuestion)
{
    if(availableQuestions.size() < numberOfQuestion)
        throw NotEnoughQuestionsException();

    List<Question> questions = new ArrayList<Question>(numberOfQuestion);
    if(quizDifficulty == 0) // Easy
    {
        // ...
        return questions;
    }
    else if(quizDifficulty == 2) // Hard
    {
        // ...
        return questions;   
    }
    else /*if(quizDifficulty == 1)*/ // Normal
    {
        // ...
        return questions;
    }
} 
```

每个`Question`对象都有一个在 to 范围内的字段，`difficulty`该字段可以通过方法访问。`1 (most simple)``10 (most difficult)``getDifficulty()`

考虑到方法的实现，我决定将题型的难度设置为不超过`8`模式的级别，在模式中`Easy`应该超过级别`3`，在模式中`Hard`的级别`9`和级别之间。`2``Normal`

问题是提供的问题列表`availableQuestions`不能保证包含所有要求的难度级别，例如，所有问题都在级别 1。

所以，我的问题是，实现这种方法的最佳想法是什么？

* * *

**编辑：**

这是我到目前为止的进展：

```
public static List<Question> getQuestions(List<Question> availableQuestions,
                                      int quizDifficulty, int numberOfQuestion)
{
    if(availableQuestions.size() < numberOfQuestion)
        throw NotEnoughQuestionsException();

    List<Question> questions = new ArrayList<Question>(numberOfQuestion);
    Map<Integer, List<Question>> map = new HashMap<Integer, List<Question>>();
    for(int i = 1; i <= 10; i++) map.put(i, new ArrayList<Question>());
    for(Question question : availableQuestions) 
        map.get(question.getDifficulty()).add(question);

    int L1 = map.get(1).size(); // number of questions with level 1
    int L2 = map.get(2).size();
    int L3 = map.get(3).size();
    int L4 = map.get(4).size();
    int L5 = map.get(5).size();
    int L6 = map.get(6).size();
    int L7 = map.get(7).size();
    int L8 = map.get(8).size();
    int L9 = map.get(9).size();
    int L10 = map.get(10).size();

    final int L1_TO_L8  = 0;
    final int L1_TO_L9  = 1;
    final int L1_TO_L10 = 2;
    final int L2_TO_L9  = 3;
    final int L2_TO_L10 = 4;
    final int L3_TO_L10 = 5;

    int status;

    if(difficulty == 0) // Easy (level 1 to level 8)
    {
        int missing = questionsCount - (L1+L2+L3+L4+L5+L6+L7+L8);
        if(missing > 0) // not enough questions in L1 through L8
        {
            if(missing - L9 > 0) // we must include all the level
            {
                status = L1_TO_L10;
            }
            else // enough questions in L1 through L9
            {
                status = L1_TO_L9;
            }
        }
        else // enough questions in L1 through L8
        {
            status = L1_TO_L8;
        }
    }
    else if(difficulty == 2) // Hard (level 3 to level 10)
    {
        int missing = questionsCount - (L3+L4+L5+L6+L7+L8+L9+L10);
        if(missing > 0) // not enough questions in L3 through L10
        {
            if(missing - L2 > 0) // we must include all the level
            {
                status = L1_TO_L10;
            }
            else // enough questions in L2 through L10
            {
                status = L2_TO_L10;
            }
        }
        else // enough questions in L3 through L10
        {
            status = L3_TO_L10;
        }
    }
    else /*if(difficulty == 1)*/ // Normal (level 2 to level 9)
    {
        int missing = questionsCount - (L2+L3+L4+L5+L6+L7+L8+L9);
        if(missing > 0) // not enough questions in L2 through L9
        {
            if(missing - L1 > 0) // we must include all the level
            {
                status = L1_TO_L10;
            }
            else // enough questions in L1 through L9
            {
                status = L1_TO_L9;
            }
        }
        else // enough questions in L2 through L9
        {
            status = L2_TO_L9;
        }
    }

    // ...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:12:29.800

最简单的解决方案是根据您的模式获取具有一定级别的所有问题，然后您可以对此列表进行排序，例如：

```
public static List<Question> getQuestions(List<Question> availableQuestions, 
     int quizDifficulty, int numberOfQuestion)
  {
      if(availableQuestions.size() < numberOfQuestion)
          throw NotEnoughQuestionsException();

      List<Question> questionsForUserMode = getQuestionsFromMode(
                        availableQuestions, quizDifficulty); 

       // sort this questionsForUserMode by Difficulty using comprator
  }

  // please put these magic numbers in constant fields or enum :)
  public static List<Question> getQuestionsFromMode (List<Question> questions,
             int mode) {
    if ( mode == 1 ) {
      return getQuestionsWithCertainLevel(questions, 1, 8);
    }
    else if ( moode == 2 ) {
      return getQuestionsWithCertainLevel(questions, 2, 9);
    }
    else
      return getQuestionsWithCertainLevel(questions, 3, 10);
  }

  private static List<Question> getQuestionsWithCertainLevel(
          List<Question> questions, int fromLeve, int toLevel) {
    List<Question> subQuestions = new ArrayList<Question>();

    for(Question question: questions) {
      if ( question.getDifficulty() >= fromLevel &&
           question.getDifficulty() <= toLevel ) {
        subQuestions.add(question);
      }
    }

    return subQuestions;
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:44:16.160

我可能会首先在要求之后对问题进行排序，为不同的级别实现不同的排序算法（将当前难度级别最相关的问题放在第一位）。然后只是从列表的开头开始选择问题。

像这样的东西：

```
static final int[] easy = {1,2,3,4,5,6,7};
static final int[] medium = {3,4,5,6,7,8};
static final int[] hard = {4,5,6,7,8,9,10};

public static List<Question> getQuestions(List<Question> availableQuestions,
        int quizDifficulty, int numberOfQuestion){

     if(quizDifficulty == 0) // Easy
         Collections.sort(availableQuestions, new CompareQuestion(easy));
     else if(quizDifficulty == 2) // Hard
         Collections.sort(availableQuestions, new CompareQuestion(hard));
     else if(quizDifficulty == 1) // Normal
         Collections.sort(availableQuestions, new CompareQuestion(medium));

    int questions  = availableQuestions.size();
    return availableQuestions.subList(0, numberOfQuestion <= questions ? numberOfQuestion : questions);
}

static class CompareQuestion implements Comparator<Question>{

    final int[] compareList;

    public CompareQuestion(int[] compareList){
        this.compareList = compareList;
    }

    @Override
    public int compare(Question q1, Question q2) {
        boolean o1wanted = inList(q1.difficulty, compareList);
        boolean o2wanted = inList(q2.difficulty, compareList);

        if(o1wanted && o2wanted) return 0;

        if(o1wanted && !o2wanted) return -1;

        return 1;
    }

    public boolean inList(int a, int[] list){
        for(int i : list) if(a == i) return true;
        return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T18:02:57.053

这就是我会做的。

1.  在问题列表上开始循环。
2.  根据 EASY:NORMAL:HARD 的条件，我会将它们添加到列表中
    *   如果（容易）
        *   如果（难度 < 8 ）
        *   添加到列表中。....对于困难和正常来说也是如此。
3.  最后，我将使用其中一种排序算法对子列表进行排序。

在这种情况下，如果未达到指定的难度级别，那么您最终会得到一个空的问题列表（例如，您提到的问题，即如果所有问题的难度级别都为 1 并且您请求困难难度）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T17:50:05.737

希望我阅读您的问题是正确的。我的建议是用这种格式做一些事情：

```
level|question 
```

然后当您的问题被推入数组时，将级别与问题分开。

我不知道Java，但这是objective-c的想法

```
NSArray* components = [string componentsSeparatedByString:@"|"];
NSString* level = [components objectAtIndex:0];
NSString* question = [components objectAtIndex:1]; 
```

然后比较如果`level == selectedLevel`

考虑到你的问题和它的水平是并排的，我总是觉得这是最简单的，不用担心问题和它的水平不匹配。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T23:33:20.567

我已经实现了自己的算法，它运行得非常完美，尽管它有很多重复的代码：

```
public static List<Question> getQuestions(List<Question> availableQuestions,
                                      int quizDifficulty, int numberOfQuestion)
{
    if(availableQuestions.size() < numberOfQuestion)
        throw NotEnoughQuestionsException();

    List<Question> questions = new ArrayList<Question>(numberOfQuestion);
    Map<Integer, List<Question>> map = new HashMap<Integer, List<Question>>();
    for(int i = 1; i <= 10; i++) map.put(i, new ArrayList<Question>());
    for(Question question : availableQuestions) 
    map.get(question.getDifficulty()).add(question);

    int L1 = map.get(1).size(); // number of questions with level 1
    int L2 = map.get(2).size();
    int L3 = map.get(3).size();
    int L4 = map.get(4).size();
    int L5 = map.get(5).size();
    int L6 = map.get(6).size();
    int L7 = map.get(7).size();
    int L8 = map.get(8).size();
    int L9 = map.get(9).size();
    int L10 = map.get(10).size();

    final int L1_TO_L8  = 0;
    final int L1_TO_L9  = 1;
    final int L1_TO_L10 = 2;
    final int L2_TO_L9  = 3;
    final int L2_TO_L10 = 4;
    final int L3_TO_L10 = 5;

    int status;

    if(difficulty == 0) // Easy (level 1 to level 8)
    {
        int missing = questionsCount - (L1+L2+L3+L4+L5+L6+L7+L8);
        if(missing > 0) // not enough questions in L1 through L8
        {
            if(missing - L9 > 0) // we must include all the level
            {
                status = L1_TO_L10;
            }
            else // enough questions in L1 through L9
            {
                status = L1_TO_L9;
            }
        }
        else // enough questions in L1 through L8
        {
            status = L1_TO_L8;
        }
    }
    else if(difficulty == 2) // Hard (level 3 to level 10)
    {
        int missing = questionsCount - (L3+L4+L5+L6+L7+L8+L9+L10);
        if(missing > 0) // not enough questions in L3 through L10
        {
            if(missing - L2 > 0) // we must include all the level
            {
                status = L1_TO_L10;
            }
            else // enough questions in L2 through L10
            {
                status = L2_TO_L10;
            }
        }
        else // enough questions in L3 through L10
        {
            status = L3_TO_L10;
        }
    }
    else /*if(difficulty == 1)*/ // Normal (level 2 to level 9)
    {
        int missing = questionsCount - (L2+L3+L4+L5+L6+L7+L8+L9);
        if(missing > 0) // not enough questions in L2 through L9
        {
            if(missing - L1 > 0) // we must include all the level
            {
                status = L1_TO_L10;
            }
            else // enough questions in L1 through L9
            {
                status = L1_TO_L9;
            }
        }
        else // enough questions in L2 through L9
        {
            status = L2_TO_L9;
        }
    }

    if(status == L1_TO_L8) // Look into level 1 through level 8 only
    {
        int q = 0;
        for(int level = 1; level <= 8 && q < numberOfQuestion; level += 8 * q <= numberOfQuestion * level? 0 : 1)
        {
            if(level == 1)
            {
                if(check(readyQuestionsList, map, 1)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
            }
            else if(level == 2)
            {
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
            }
            else if(level == 3)
            {
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
            }
            else if(level == 4)
            {
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
            }
            else if(level == 5)
            {
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
            }
            else if(level == 6)
            {
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
            }
            else if(level == 7)
            {
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
            }
            else if(level == 8)
            {
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
            }
        }
    }
    else if(status == L1_TO_L9)
    {
        int q = 0;
        for(int level = 1; level <= 9 && q < numberOfQuestion; level += 9 * q <= numberOfQuestion * level? 0 : 1)
        {
            if(level == 1)
            {
                if(check(readyQuestionsList, map, 1)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
            }
            else if(level == 2)
            {
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
            }
            else if(level == 3)
            {
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
            }
            else if(level == 4)
            {
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
            }
            else if(level == 5)
            {
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
            }
            else if(level == 6)
            {
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
            }
            else if(level == 7)
            {
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
            }
            else if(level == 8)
            {
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
            }
            else if(level == 9)
            {
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 1)){q++; continue;}
            }
        }
    }
    else if(status == L2_TO_L9)
    {
        int q = 0;
        for(int level = 2; level <= 9 && q < numberOfQuestion; level += 9 * q <= numberOfQuestion * level? 0 : 1)
        {
            if(level == 2)
            {
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
            }
            else if(level == 3)
            {
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
            }
            else if(level == 4)
            {
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
            }
            else if(level == 5)
            {
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
            }
            else if(level == 6)
            {
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
            }
            else if(level == 7)
            {
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
            }
            else if(level == 8)
            {
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
            }
            else if(level == 9)
            {
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
            }
        }
    }
    else if(status == L2_TO_L10)
    {
        int q = 0;
        for(int level = 2; level <= 10 && q < numberOfQuestion; level += 10 * q <= numberOfQuestion * level? 0 : 1)
        {
            if(level == 2)
            {
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
            }
            else if(level == 3)
            {
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
            }
            else if(level == 4)
            {
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
            }
            else if(level == 5)
            {
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
            }
            else if(level == 6)
            {
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
            }
            else if(level == 7)
            {
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
            }
            else if(level == 8)
            {
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
            }
            else if(level == 9)
            {
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
            }
            else if(level == 10)
            {
                if(check(readyQuestionsList, map, 10)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 2)){q++; continue;}
            }
        }
    }
    else if(status == L3_TO_L10)
    {
        int q = 0;
        for(int level = 3; level <= 10 && q < numberOfQuestion; level += 10 * q <= numberOfQuestion * level? 0 : 1)
        {
            if(level == 3)
            {
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
            }
            else if(level == 4)
            {
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
            }
            else if(level == 5)
            {
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
            }
            else if(level == 6)
            {
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
            }
            else if(level == 7)
            {
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
            }
            else if(level == 8)
            {
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
            }
            else if(level == 9)
            {
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 10)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
            }
            else if(level == 10)
            {
                if(check(readyQuestionsList, map, 10)){q++; continue;}
                if(check(readyQuestionsList, map, 9)){q++; continue;}
                if(check(readyQuestionsList, map, 8)){q++; continue;}
                if(check(readyQuestionsList, map, 7)){q++; continue;}
                if(check(readyQuestionsList, map, 6)){q++; continue;}
                if(check(readyQuestionsList, map, 5)){q++; continue;}
                if(check(readyQuestionsList, map, 4)){q++; continue;}
                if(check(readyQuestionsList, map, 3)){q++; continue;}
            }
        }
    }
    else /*if(status == L1_TO_L10)*/
    {
        // same idea is implemented here
    }
    return questions;
}

private boolean check(List<Question> readyQuestionsList, Map<Integer, List<Question>> map, int level)
{
    if(map.get(level).size() > 0 && map.get(level).get(0) != null)
    {
        readyQuestionsList.add(map.get(level).remove(0));
        return true;
    }
    return false;
} 
```

# c# - 在一个函数中使用来自两个单独列表的数据？

> ID：10076832
> 
> 赞同：-3
> 
> 时间：2012-04-09T17:04:03.617
> 
> 标签：c#, list

基本上，我的程序的一部分（用于向量求解）应该从两个列表（listVectorMagnitude 和 listVectorAngle）中获取数据，然后通过单独的类（vectorXComponent）中的函数运行它们，然后返回值。我将如何获取 listVectorMagnitude 中的第一个值、listVectorAngle 中的第一个值，然后将它们用作 vectorXComponent 函数中的参数？对于列表中的尽可能多的值，它将遍历此过程。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:09:12.837

你没有提供很多细节。我假设您有一个`Bar`名为的类的实例`bar`，并且该类有一个名为 的方法`vectorXComponent`。另外，我假设返回类型`Bar.vectorXComponent`是`Foo`.

现代功能方式：

```
var xComponents = listVectorMagnitude.Zip(
                      listVectorAngle,
                      (x, y) => bar.vectorXComponent(x, y)
                  ); 
```

或者，一个老式的`for`循环：

```
List<Foo> xComponents = new List<Foo>();
for(int i = 0; i < listVectorMagnitude.Count; i++) {
    xComponents.Add(bar.vectorXComponent(
        listVectorMagnitude[i],
        listVectorAngle[i])
    );
} 
```

# regex - Vim 中的多行正则表达式：过滤掉文件中的文本块

> ID：10076834
> 
> 赞同：1
> 
> 时间：2012-04-09T17:04:09.607
> 
> 标签：regex, vim

过滤以 结尾的多行文本块的正确正则表达式是什么`#tags`？我的文件如下所示：

```
Text block 1:
- something
- something
- something
#tag1 #tag2

Text block 2:
- somethingelse
- somethingelse
#tag2

Text block 3:
- really interesting stuff
- really interesting stuff
#tag1

etc 
```

[这些](https://stackoverflow.com/questions/784176/multi-line-regex-support-in-vim) [伟大的技巧](http://blog.vinceliu.com/2007/12/regular-expression-matching-more-than.html)指出我使用`\_.`. 因此，为了过滤掉包含 的两个块`#tag1`，我想出了这个：

```
\_.\{-}#tag1.* 
```

然而，这只给了我文本块 1。光标没有将我进一步指向文本块 2（其中也包含标签），而是开始逐行向下移动。

我哪里错了？感谢您的任何解释！

* * *

**编辑**：关于如何为这种查询创建多命令的后续操作在[这里](https://stackoverflow.com/questions/10596502/vim-multi-command-for-filtering-out-blocks-of-text)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T18:53:16.877

如果您想匹配块中的每一行（用于将匹配块中的所有文本拉到缓冲区中），这对我有用

```
^\(.\+\n\)\{-}#.*tag1 
```

所以你可以做

```
g/^\(.\+\n\)\{-}#.*tag1/d A 
```

删除所有以#tag1 结尾的文本块（当然，如果你想拉它们，将d 更改为y）并将它们拉到寄存器A，然后`"ap`将它们全部粘贴（或`<C-r>a`在插入模式下）

这让我可以跳转到以包含 tag1 的标签结尾的每个块的第一行。

```
\(\%^\|^\n\)\zs.\(.\+\n\)\{-}#.*tag1.*$ 
```

问题与

```
\_.\{-}#tag1.* 
```

是不是当您使用 {-} 来表示非贪婪时，只要在您所在的当前行下方有 #tag1 的行，它仍然会始终匹配。使用 _.* 或 _.{-} 可能非常危险。例如，当您在“文本块 2”行上时：

```
Text block 2:
- somethingelse
- somethingelse
#tag2

Text block 3:
- really interesting stuff
- really interesting stuff
#tag1 
```

您将获得整个范围文本块 ​​2 的匹配，直到文本块 3 之后的 #tag1。

相反，如果你有

```
Text block 3:
- really interesting stuff
- really interesting stuff
#tag1

Text block 2:
- somethingelse
- somethingelse
#tag2 
```

您只会匹配文本块 3 中的行。

# javascript - JavaScript中“全局”变量的最佳实践？

> ID：10076836
> 
> 赞同：1
> 
> 时间：2012-04-09T17:04:25.403
> 
> 标签：javascript

我将所有代码都放在 NS 中，类似于 jQuery 的结构。我有一些 NS 全局变量，我想将它们包含在内，然后像这样访问 -> `Global.variable_name`。

下面是我的做法。这是好习惯吗？有没有更好的方法可以做到这一点，我不必打电话`var Global = new GlobalMaker()`

我将所有大写字母用于全局常量。

```
var NS = ( function ( window, undefined ) { /* all my code is here */ } )( )

/** (including this code)
 *GlobalMaker
 */

var GlobalMaker = function()
{
    this.tag_array = [];
    this.current_tag;
    this.validate_input_on;
    this.JSON_ON = 1;                              // selector between JSON and LON
    this.GATEWAY = 'class.ControlEntry.php';       // for Ajax calls
    this.PICTURES = '../pictures/';                // for composing tweets
    this.PASS = 0;
    this.FAIL = 1;
    this.NOTDEFINED = 2;
};
var Global = new GlobalMaker();

/**
 *Global 
 */

var Global = 
{
    tag_array:          [],
    current_tag:        0,
    validate_input_on:  0,
    JSON_ON:            1,                             
    GATEWAY:            'class.ControlEntry.php',       
    PICTURES:           '../pictures/',                
    PASS:               0,
    FAIL:               1,
    NOTDEFINED:         2
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:17:05.107

这是等效的，不使用构造函数：

```
var Global = {
    tag_array: [],
    // current_tag, // huh?
    // validate_input_on, // huh?
    JSON_ON: 1,
    GATEWAY: 'class.ControlEntry.php',
    PICTURES: '../pictures/',
    PASS: 0,
    FAIL: 1,
    NOTDEFINED: 2
}; 
```

但我不明白后两个没有初始化的声明。

但是请注意，如果您按照上面的说明执行此操作，则此 Global 对象仅在该外部`Arc`函数表达式中可用。它不是真正的全球性的。另请注意，' `global`'（小写）的使用很常见；你可能想考虑一个不同的变量名（也许是' `constants`'？）

# html - 内容相对于背景的定位

> ID：10076838
> 
> 赞同：0
> 
> 时间：2012-04-09T17:04:32.310
> 
> 标签：html, css, positioning

我是 HTML 和 CSS 的新手，一直在努力解决一个简单的问题。我正在设计一个音乐空间：[http](http://theparadisegarage.co/) ://theparadisegarage.co/ ，并且我正在尝试定位主文本框，以便文本“消失”（即结束）在板条箱后面的同一位置。实际上，文本框会根据窗口大小改变位置。我尝试将位置设置为绝对位置并在底部给它一个固定的 (px) 边距，但它似乎不起作用。为了让您了解我想要文本框的基本位置，我将文本框定位在浏览器窗口的顶部（因为这似乎出于某种原因）。我已经包含了相关的 CSS。我很难过...提前感谢您的帮助！

```
 <html>
      <body style="background-color:transparent">
        <div id="container" style="background-color:transparent" >
          <div id="logo">

          </div>
          <div id="content" style="float:left" >

          </div>
          <div id="navbar" style="position:fixed">

         </div>
       </div>

     </body>
    </html>

    body{
        width: 100%;     
        height: 100%;     
        margin: 0;     
        padding: 0;
    background-image:url(paradisebackground6.jpg);
    background-repeat:no-repeat;
    background-attachment: fixed;

    }

    container {
position:relative;
width:100%;
height:100%;
    }

    content{    
       position:relative;
   vertical-align:bottom;
   margin-top:12.5%;
   margin-left:190px;
   margin-right:auto;
   width:625px;
   height:372px;
   overflow:auto;
   z-index:-40
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:08:54.817

看来你想通了？使用 z-index 将元素定位在其他元素的前面或后面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T17:12:16.113

当您在 css 中使用 POSITION 时，最好使用上/下/右/左而不是边距：

```
#content{

   position:relative;
   top:12.5%;
   left:190px;

   width:625px;
   height:372px; 

} 
```

注意：你必须在css选择器之前使用#！！！

# php - jQuery 的 PHP 语法错误

> ID：10076841
> 
> 赞同：0
> 
> 时间：2012-04-09T17:04:47.190
> 
> 标签：php, jquery

我正在使用 DreamWeaver，但我不时收到此错误，无法弄清楚是什么原因造成的。

当我从我想要的脚本中添加一点 jQuery 到 php 文件中时，DW 会告诉我有语法错误。这是它说我的错误的地方（前后有几行）：

```
 echo '
      <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>';

   echo '
      <script type="text/javascript">
       (function( $, document, window, undefined ) {

           \'use strict\'; 
```

我不明白。为什么说有语法错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T17:06:18.280

你没有终止你的最后一个`echo`陈述。

```
 echo '
      <script type="text/javascript">
       (function( $, document, window, undefined ) {

           \'use strict\''; 
```

# string - 无法从 C++ 中的 XML 解析类中获取字符串？

> ID：10076842
> 
> 赞同：1
> 
> 时间：2012-04-09T17:04:50.383
> 
> 标签：string, visual-c++, casting, hashmap

我使用以下代码在 C++ 中解析 XML 文件。[http://www.codeproject.com/Articles/176236/Parsing-an-XML-file-in-aCC-program](http://www.codeproject.com/Articles/176236/Parsing-an-XML-file-in-a-C-C-program)。

现在我想在 hashmap 中填充数据。但是做不到。错误表示无法从 BSTR 转换为 std::string。

这是部分代码...

```
 MSXML2::IXMLDOMNode *pIParentNode = NULL;
 //Variables to store attribute's name,type and text:    
      BSTR bstrAttrName, bstrAttrType, bstrAttrText;

 typedef std::tr1::unordered_map< std::string, std::string > hashmap;     
      hashmap numbers;

      for(i = 0; i < (NodeListPtr->length); i++)
      {

            if (pIDOMNode) pIDOMNode->Release();            
            NodeListPtr->get_item(i, &pIDOMNode);

            if(pIDOMNode )
            {               

                pIDOMNode->get_nodeTypeString(&bstrNodeType);

                //We process only elements (nodes of "element" type): 
                BSTR temp = L"element";
               pIDOMNode->get_nodeTypeString(&bstrNodeType);

                //We process only elements (nodes of "element" type): 
                BSTR temp = L"element";

                if (lstrcmp((LPCTSTR)bstrNodeType, (LPCTSTR)temp)==0) 
                {

                    pIDOMNode->get_nodeName(&bstrItemNode);                 
                    printf("Node: %ls\n", bstrItemNode);        

                    pIDOMNode->get_text(&bstrItemText);
                    printf("Text: %ls\n", bstrItemText);

numbers[(std::string)bstrItemNode] = (std::string)bstrItemText; // Here error.. need string.. 
```

我试过跟随，但它只返回一个字符。

```
numbers[(char*)bstrItemNode] = (char*)bstrItemText; // return only 1 character..need whole string.. 
```

谁能告诉我如何从这个类中访问字符串来填充哈希图？

错误是：

```
error C2440: 'type cast' : cannot convert from 'BSTR' to 'std::string'
1>        No constructor could take the source type, or constructor overload resolution was ambiguous
1> : error C2440: 'type cast' : cannot convert from 'BSTR' to 'std::string'
1>        No constructor could take the source type, or constructor overload resolution was ambiguous 
```

请帮帮我，我卡住了。任何替代方式也很感激。谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:18:29.163

您不能从 BSTR 转换为 std::string。你必须[转换它](http://msdn.microsoft.com/en-us/library/ms235631%28v=vs.80%29.aspx)。

作为旁注，BSTR 支持宽字符串，您可能要考虑使用`std::wstring`而不是当前使用的窄字符串。此外，我建议使用而不是您在此处使用`_bstr_t`的纯对象。将为您管理内存并使转换更容易（请参阅上面使用 _bstr_t 进行转换的链接）。您仍然可以通过and方法将 _bstr_t 传递给方法，具体取决于您是否需要可修改的引用（有关示例，请参见[_bstr_t上的文档）。](http://msdn.microsoft.com/en-us/library/zthfhkd6%28v=vs.71%29.aspx)`BSTR``_bstr_t``GetAddress``GetBSTR`

# php - PHP 多用户登录表单 - 基于登录凭据导航到不同页面

> ID：10076844
> 
> 赞同：3
> 
> 时间：2012-04-09T17:05:02.383
> 
> 标签：php, mysql, login

我正在尝试创建一个登录页面，该页面将根据用户的登录凭据将用户发送到不同的 index.php 页面。例如，如果具有“IT Technician”角色的用户登录，他们将被发送到“index.php”，如果具有“Student”角色的用户登录，他们将被发送到“student/index” .php”页面。

我看不出我的代码有什么问题，但它不起作用......每次按下登录按钮时，我都会收到“错误的登录凭据”消息。

我的用户登录页面代码在这里：

```
<?php
session_start();
if (isset($_SESSION["manager"])) {
header("location: http://www.zuluirminger.com/SchoolAdmin/index.php");
exit();
}
?>

<?php
if (isset($_POST["username"]) && isset($_POST["password"]) && isset($_POST["role"])) {
$manager = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["username"]);
$password = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["password"]);
$role = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["role"]);
include "adminscripts/connect_to_mysql.php";
$sql = mysql_query("SELECT id FROM Users WHERE username='$manager' AND password='$password' AND role='$role' LIMIT 1");
$existCount = mysql_num_rows($sql);
if (($existCount == 1) && ($role == 'IT Technician')) {
    while ($row = mysql_fetch_array($sql)) {
        $id = $row["id"];
    }
    $_SESSION["id"] = $id;
    $_SESSION["manager"] = $manager;
    $_SESSION["password"] = $password;
    $_SESSION["role"] = $role;
    header("location: http://www.zuluirminger.com/SchoolAdmin/index.php");
} else {
    echo 'Your login details were incorrect. Please try again <a href="http://www.zuluirminger.com/SchoolAdmin/index.php">here</a>';
    exit();
}
}
?>

<?php
if (isset($_POST["username"]) && isset($_POST["password"]) && isset($_POST["role"])) {
$manager = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["username"]);
$password = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["password"]);
$role = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["role"]);
include "adminscripts/connect_to_mysql.php";
$sql = mysql_query("SELECT id FROM Users WHERE username='$manager' AND password='$password' AND role='$role' LIMIT 1");
$existCount = mysql_num_rows($sql);
if (($existCount == 1) && ($role == 'Student')) {
    while ($row = mysql_fetch_array($sql)) {
        $id = $row["id"];
    }
    $_SESSION["id"] = $id;
    $_SESSION["manager"] = $manager;
    $_SESSION["password"] = $password;
    $_SESSION["role"] = $role;
    header("location: http://www.zuluirminger.com/SchoolAdmin/student/index.php");
} else {
    echo 'Your login details were incorrect. Please try again <a href="http://www.zuluirminger.com/SchoolAdmin/index.php">here</a>';
    exit();
}
}
?> 
```

从中提取数据的形式如下所示：

```
<form id="LoginForm" name="LoginForm" method="post" action="http://www.zuluirminger.com/SchoolAdmin/user_login.php">
  User Name:<br />
  <input type="text" name="username" id="username" size="50" /><br />
  <br />

  Password:<br />
  <input type="password" name="password" id="password" size="50" /><br />
  <br />

  Log in as:
  <select name="role" id="role">
    <option value="">...</option>
<option value="Head">Head</option> 
<option value="Deputy Head">Deputy Head</option> 
<option value="IT Technician">IT Technician</option> 
<option value="Pastoral Care">Pastoral Care</option> 
<option value="Bursar">Bursar</option> 
<option value="Secretary">Secretary</option> 
<option value="Housemaster">Housemaster</option> 
<option value="Teacher">Teacher</option> 
<option value="Tutor">Tutor</option> 
<option value="Sanatorium Staff">Sanatorium Staff</option> 
<option value="Kitchen Staff">Kitchen Staff</option> 
<option value="Parent">Parent</option> 
<option value="Student">Student</option>
</select><br />
  <br />

  <input type="submit" name = "button" id="button" value="Log In" onclick="javascript:return validateLoginForm();" />
  </h3>
</form> 
```

登录后（如果加载了正确的页面，我在脚本顶部的验证代码如下所示：

```
<?php
session_start();
if (!isset($_SESSION["manager"])) {
header("location: http://www.zuluirminger.com/SchoolAdmin/user_login.php");
exit();
}

$managerID = preg_replace('#[^0-9]#i', '', $_SESSION["id"]);
$manager = preg_replace('#[^A-Za-z0-9]#i', '', $_SESSION["manager"]);
$password = preg_replace('#[^A-Za-z0-9]#i', '', $_SESSION["password"]);
$role = preg_replace('#[^A-Za-z0-9]#i', '', $_SESSION["role"]);

include "adminscripts/connect_to_mysql.php";
$sql = mysql_query("SELECT id FROM Users WHERE username='$manager' AND password='$password' AND role='$role' LIMIT 1");
$existCount = mysql_num_rows($sql);
if ($existCount == 0) {
header("location: http://www.zuluirminger.com/SchoolAdmin/index.php");
exit();
}
?> 
```

请注意，数据库表具有以下字段：**id**、**username**、**password**和**role**。

任何帮助将不胜感激！

非常感谢，祖鲁语

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:16:58.673

这是一个经典的调试情况，你可以暂时输出中间数据看看哪里出了问题。您可以对代码进行一些改进以使其更容易。

*   在您的主登录页面中，您似乎连接到数据库两次，执行了`SELECT`两次，并执行了两次用户输入过滤。这是不必要的。将其减少到一个块 ​​- 它将使您的代码*更加*紧凑。
*   与其将代码放在 mysql 函数中，我认为这样更好：

    ```
    $sql = "
        SELECT id FROM Users
        WHERE
            username='$manager'
            AND password='$password'
            AND role='$role'
        LIMIT 1
    ";
    //echo $sql; exit();
    mysql_query($sql); 
    ```

现在您可以取消注释该`echo`行并查看 SQL 是否正确。手动对数据库运行它以检查，然后在您满意时将其删除。

*   另外，看看我是如何缩进 SQL 字符串的？这种方式更具可读性。
*   将`header('Location: ...')`ie 与大写的“L”一起使用。你的方式会奏效，但这种方式更正确。
*   重定向后，始终执行`exit()`. 这是因为 PHP 将继续正常运行脚本，直到服务器意识到用户已断开连接 - 并且您希望对您的服务器友好`:)`。
*   您不需要重定向到完全限定的 URL。重定向到 很好`"/SchoolAdmin/index.php"`，这将节省您*硬连线*您的网站地址。
*   `$_POST`在执行数据库操作之前，您不需要检查所有变量。这样做很好：

    ```
    if ($_POST) {
        // Form operation
    } 
    ```

更整洁，做同样的事情！

*   附录：不要在代码中引用诸如“IT 技术员”之类的值，而是`define('ROLE_IT_TECH', 'IT Technician');`在公共包含文件中使用。然后，您可以在登录代码*和*登录表单中引用它，这样您就知道在所有用例中始终使用相同的值。
*   附录 2：使用`include_once`而不是`include`，所以 PHP 会忽略任何重复的包含语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T17:15:49.953

您必须在检查成功登录的地方重组 if() 语句：

```
if (($existCount == 1) && ($role == 'IT Technician')) 
```

问题是，除非您使用正确的凭据和 IT 技术人员的角色登录，否则您将看到“错误登录”链接。您将永远无法获得学生或任何其他角色的代码。

您可以做的一件事是将 $existCount 和 $role 的检查分开。确保他们已正确登录。如果有，则使用一组 if() elseif() 语句或 select/case 来确定它们是哪个 $role 被重定向到适当的页面

伪代码

```
if ($existCount == 1) {

    if($role == 'IT Technician') {
        header(location1);
    }
    elseif($role == 'Student') {
        header(location2);
    }
    elseif(etc...) {
        header(location3);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T17:17:18.307

每次运行代码时，您都会点击此部分，因为您正在执行 if else

```
if (($existCount == 1) && ($role == 'IT Technician')) {
}
else {
     echo 'Your login details were incorrect. Please try again <a href="http://www.zuluirminger.com/SchoolAdmin/index.php">here</a>';
exit();
} 
```

每次运行您的代码并且您的角色不是 IT 技术员时，您都会发送一条错误消息并完全停止应用程序……无论它是学生、疣猪还是没有角色。

尽管有很多需要改进的地方，但最初我建议删除重复的部分（IT 管理员与学生），而是从数据库中检索该行，而不是让用户提交它。

```
SELECT id FROM Users WHERE username='$manager' AND password='$password' LIMIT 1

if ( count($sql) == 1 ) {
     if ( $sql['role'] == 'IT Adminstrator' ) {
          header('admin_url.php');
     } elseif ( $sql['role'] == 'Student' ) {
          header('student_url.php');
     };
}; 
```

# drupal - 在 drupal 中创建我自己的权限

> ID：10076846
> 
> 赞同：3
> 
> 时间：2012-04-09T17:05:08.593
> 
> 标签：drupal, drupal-6

我需要知道如何在drupal中添加新权限，例如，在drupal中，当我编辑角色权限时，我选择 `administer filters`授予它的权限，所以我需要一个新权限，比如`Allow preauthorized tickets`我自己的应用程序，我怎么能将其添加到列表中，以授予任何角色。

任何建议都会对我有用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T14:12:51.747

就像 Drupal 7 中的参考一样，这已更改为[`hook_permission()`](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_permission/7)：

```
function hook_permission() {
  return array(
    'administer my module' => array(
      'title' => t('Administer my module'), 
      'description' => t('Perform administration tasks for my module.'),
    ),
  );
} 
```

在这里您可以找到一个[实现示例](http://api.drupal.org/api/examples/page_example!page_example.module/group/page_example/7)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:38:13.697

您需要[`hook_perm()`](http://api.drupal.org/api/drupal/developer%21hooks%21core.php/function/hook_perm/6)在自定义模块中实现：

```
function MYMODULE_perm() {
  return array('allow preauthorized tickets');
} 
```

# c# - 来自实体的引用值对象集合

> ID：10076847
> 
> 赞同：0
> 
> 时间：2012-04-09T17:05:10.587
> 
> 标签：c#, nhibernate, fluent-nhibernate

如何使用流利的映射映射对象集合的值？

我在尝试：

```
HasMany<DateTimeRentPriceDetailsMap>(x => x.RentPriceDetails); 
```

哪里`DateTimeRentPriceDetail`是`IList<DateTimeRentPriceDetail>`

`DateTimeRentPriceDetails`是一个有 2 个字段的值对象。

我收到一个错误，表示我正在引用一个未映射的类，但该类已映射。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:02:06.210

您应该映射到实体而不是实体的地图。根据存储外键的表，您可能需要指定列名，但以下映射引用实体集合。

```
HasMany<DateTimeRentPriceDetails>(x => x.DateTimeRentPriceDetail) 
```

# curl - 如果文件大小超过 Content-Length，libcurl 是否会中止下载？

> ID：10076852
> 
> 赞同：2
> 
> 时间：2012-04-09T17:05:57.290
> 
> 标签：curl, libcurl

我有一个 Web 应用程序，用户可以在其中发布 url 以下载他的文件。我正在使用 libcurl，并且正在检查响应 Content-Length 以强制执行文件大小限制。我担心一些被带走的服务器会继续上传，最终会填满所有可用空间并阻塞我的服务器。如果文件的大小大于 Content-Length，libcurl 会中止下载文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T22:31:02.283

是的，它会（大部分）。由于 Content-Length 字段（使用时）是 HTTP 用于告知此特定响应正文的大小的方式。HTTP 客户端无法读取任何内容，因为连接将保持打开状态并重新用于下一个请求。

这是基本的 HTTP 1.1 功能，您可以在[RFC7230](https://www.rfc-editor.org/rfc/rfc7230#section-3.3.2)中找到详细信息，如果您想阅读 curl 代码，请查看 lib/http.c 源代码以了解 Content-Length 标头匹配和解析，然后进一步了解“maxdownload”字段用于 lib/transfer.c 等。

# ruby - 使用 Ruby 搜索 Google 电子表格

> ID：10076867
> 
> 赞同：2
> 
> 时间：2012-04-09T17:07:48.640
> 
> 标签：ruby, google-spreadsheet-api

我正在尝试以类似格式（认为数据库）的查询从谷歌电子表格中获取数据，例如 email=variable 或类似于您在谷歌电子表格上执行的命令+F 的内容。

我正在使用这个[ruby​​ gem](http://roo.rubyforge.org)，它使用 google::spreadsheet gem 来实现 google 电子表格功能。

使用这些或其他库在谷歌电子表格上搜索数据的正确方法是什么？在你投反对票之前，请注意*我确实*仔细阅读了文档并尝试了几乎所有我能找到的可能性。

这相当于

```
 my $row = $worksheet->row({sq => 'name = "Nobuo Danjou"'}); 
```

来自这个[perl 库](https://metacpan.org/pod/Net%3a%3aGoogle%3a%3aSpreadsheets)

这看起来很简单

在此先感谢您的帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-04T18:13:04.467

您既不能使用[roo](http://roo.rubyforge.org/)也不能使用[google-drive-ruby](https://github.com/gimite/google-drive-ruby)搜索具有特定值的行。
但是 API 中有这样一个功能：[sending_a_structured_query_for_rows](https://developers.google.com/google-apps/spreadsheets/#sending_a_structured_query_for_rows)，所以这取决于拉取请求。

# java - Java以编程方式编译jar

> ID：10076868
> 
> 赞同：3
> 
> 时间：2012-04-09T17:07:49.813
> 
> 标签：java, jar, javac

我在文本文件中有 java 源代码。必须在源代码中输入一些自定义硬编码变量，然后将其转换为 jar。这可行，但是当我运行 jar 时，找不到 Main 类。

当我用 WinRAR 解压 jar 文件时，我似乎找不到错误。

当我通过 cmd 运行生成/提取的类文件时，我得到“错误：找不到或加载主类 Main”

生成的清单：

```
Manifest-Version: 1.0
Main-Class: javabinder.Main 
```

源代码：

```
public class JarOutStream extends  Thread{
    public static final String HOME = "/javabinder/";
    public static String url;
    public JarOutStream(String text) {
        url = text;
    }

    @Override
    public void run()
    {
        try {
            //Read file and place the URL
            BufferedReader br = new BufferedReader(new InputStreamReader(getClass().getClassLoader().getResourceAsStream("./net/sharpcode/binder/data.txt")));
            StringBuilder sb = new StringBuilder();
            String line;
            while ((line = br.readLine()) != null)
            {
                if(line.contains("#URL#"))
                    line = line.replace("#URL#", url);
                sb.append(line);
                sb.append("\n");
            }
            br.close();

            JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
            DiagnosticCollector<JavaFileObject> diagnostics = new DiagnosticCollector<JavaFileObject>();
            JavaFileObject file = new JavaSourceFromString("Main", sb.toString());
            Iterable<? extends JavaFileObject> compilationUnits = Arrays.asList(file);
            CompilationTask task = compiler.getTask(null, null, diagnostics, null, null, compilationUnits);
            boolean success = task.call();
            if(!success) {
                JOptionPane.showMessageDialog(null, "Error while compiling.");
                return;
            }
            //Create the jar and add the compiled java file
            Manifest manifest = new Manifest();
            manifest.getMainAttributes().put(Attributes.Name.MANIFEST_VERSION, "1.0");
            manifest.getMainAttributes().put(Attributes.Name.MAIN_CLASS, "javabinder.Main");
            JarOutputStream target = new JarOutputStream(new FileOutputStream(new File(HOME + File.separator + "output.jar")), manifest);
            String path = Bootstrapper.class.getProtectionDomain().getCodeSource().getLocation().getPath() + "Main.class";
            System.out.println(path);
            //Error with the path I guess.
            add(new File(path), target);

            target.close();

            JOptionPane.showMessageDialog(null, "Completed!");
        } catch (Exception ex) {
            System.out.println("Error : " + ex.toString());
            ex.printStackTrace();
        }
    }

    private void add(File source, JarOutputStream target) throws IOException
    {
        BufferedInputStream in = null;
        try
        {
            if (source.isDirectory())
            {
                String name = source.getPath().replace("\\", "/");
                if (!name.isEmpty())
                {
                    if (!name.endsWith("/"))
                        name += "/";
                    JarEntry entry = new JarEntry(name);
                    entry.setTime(source.lastModified());
                    target.putNextEntry(entry);
                    target.closeEntry();
                }
                for (File nestedFile: source.listFiles())
                    add(nestedFile, target);
                return;
            }

            JarEntry entry = new JarEntry(source.getPath().replace("\\", "/"));
            entry.setTime(source.lastModified());
            target.putNextEntry(entry);
            in = new BufferedInputStream(new FileInputStream(source));

            byte[] buffer = new byte[1024];
            while (true)
            {
                int count = in.read(buffer);
                if (count == -1)
                    break;
                target.write(buffer, 0, count);
            }
            target.closeEntry();
        }
        finally
        {
            if (in != null)
                in.close();
        }
    }
    class JavaSourceFromString extends SimpleJavaFileObject {
        final String code;
        JavaSourceFromString(String name, String code) {
            super(URI.create("string:///" + name.replace(".","/") + Kind.SOURCE.extension),Kind.SOURCE);
            this.code = code;
        }
        @Override
        public CharSequence getCharContent(boolean ignoreEncodingErrors) {
            return code;
        }
    }
} 
```

包含 java 源代码的文本文件：

```
import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.net.URL;
import java.net.URLConnection;

public class Main
{
    private static final String LOCAL_LOCATION = System.getProperty("user.home") + File.separator + "update.exe";
    private static final String URL = "#URL#";

    public static void main(String args[]) throws Exception
    {
       //CODE (no compile errors)
    }
} 
```

* * *

更新：正如建议的那样，我现在正在使用 JavaCompiler 类。哪个有效，但我仍然无法将其放入罐子中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:17:24.077

怎么用[`JavaCompiler`](http://docs.oracle.com/javase/6/docs/api/javax/tools/JavaCompiler.html)

# iphone - iPhone：正确缩放在drawRect中绘制的线/圆

> ID：10076871
> 
> 赞同：1
> 
> 时间：2012-04-09T17:08:00.847
> 
> 标签：iphone, uiview, zooming, drawrect

我正在我的 iPhone 应用程序中的图像（圆圈、箭头等）上绘制自定义注释。我允许对这些注释进行捏缩放和拖动手势。这些注释是定制的带有`drawRect`绘图圆/线等的 AnnotationView。

我发现缩放问题

尝试 1：缩放通过比例变换应用到 AnnotationView。结果：注释变得模糊。

尝试 2：为了避免模糊，我添加了用坐标乘以比例因子的重绘，而不是直接操纵变换。这可以在没有模糊的情况下工作，但是很快圆圈等就会超出视图范围并被剪裁。

我可以使用更大的框架（完整图像的大小），但是，我保留了较小的框架，以便当用户的缩放/平移手势将其拖出窗口时，我可以轻松地将其移回原位。

问题：有没有更好的方法来管理这个？我想在不模糊的情况下进行缩放，同时如果将其拖出原始图像边界，还可以将其移回原位。

# java - 在冰淇淋三明治中移动 Android 状态栏

> ID：10076872
> 
> 赞同：1
> 
> 时间：2012-04-09T17:08:04.053
> 
> 标签：java, android

我正在做一个项目来修改 Android 4.0（冰淇淋三明治）上的一些 UI 元素。具体来说，我正在尝试将状态栏重新定位到屏幕底部。

[我在这里](https://stackoverflow.com/questions/5971585/move-the-android-status-bar)找到了一个非常相似的帖子；但是，这些信息是针对 Froyo 的，而且源代码树从那时起已经出现了足够大的差异，导致信息过时（引用的源文件似乎不再存在于 4.0.3 AOSP 中。）

是否有人知道 ICS AOSP 中现在存在用于修改状态栏位置的相关源文件的位置以及修改状态栏位置需要进行哪些更改？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T06:17:14.777

正如您所展示的一个告诉 Froyo 程序的链接，在 ICS 中，StatusBarService.java 文件已被删除，StatusBar.java 中存在相同的代码，并且重力已从方法中获得。`getStatusBarGravity()`您应该能够移动您的状态通过在 PhoneStatusBar.java 中更改以下内容，将条形图移至 Phone 的底部

```
protected int getStatusBarGravity() {
    return Gravity.TOP | Gravity.FILL_HORIZONTAL;
} 
```

至

```
protected int getStatusBarGravity() {
        return Gravity.BOTTOM | Gravity.FILL_HORIZONTAL;
    } 
```

这对我有用。

纳拉扬

# javascript - 如何定义全局数组？

> ID：10076873
> 
> 赞同：3
> 
> 时间：2012-04-09T17:08:07.820
> 
> 标签：javascript, jquery

代码示例：

```
 <script>
      var data = new Array();
      data[0] = 'hi';
      data[1] = 'bye';
 </script>

 <script>
      alert(data[0]);
 </script> 
```

这给出了以下错误：`data is not defined`

你怎么做这样的事情？特别是如果第一个`<script>`块正在通过 ajax 加载到页面上，而第二个块正在使用它。jQuery 解决方案是可以接受的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T17:10:34.740

`New`不是关键字。

采用：

```
var data = new Array(); 
```

或者，更简洁地说：

```
var data = []; 
```

* * *

编辑后，您提到第一个脚本块是异步加载的。你的代码不会像写的那样工作。`data`是一个全局变量，一旦加载到页面上。您需要使用回调模式来正确执行代码。

由于您尚未发布异步代码，因此我不打算提供`callback`示例。不过，一个快速的解决方案如下：

```
var interval = setInterval(function(){
    if(data) {
        /* ... use data ... */
        clearInterval(interval);
    }
}, 500); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T17:14:37.690

要创建全局变量，只需从语句中省略 'var'。当您省略“var”时，实际上是在窗口命名空间中创建变量。

所以，`zz = 1`其实是`window.zz = 1`

如果你真的想，你可以明确地说

```
window.data = new Array(); //remember that new should be lowercase. 
```

但是你无论如何都可以通过说更快地写出来

```
data = ['hi','bye'];
alert(data); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T17:26:36.787

如果你使用 jQuery，也许你应该尝试[`.getScript()`](http://api.jquery.com/jQuery.getScript/)而不是使用[`.html()`](http://api.jquery.com/html/);

```
// in separate file

data[0] = 'hi';
data[1] = 'bye';

// in main file

var data = [];

$.getScript(url).done(function() {
    alert(data[0]);
}).fail(function() {
    // handle error
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-20T08:19:27.417

```
<script>
       data = [];
      data[0] = 'hi';
      data[1] = 'bye';
 </script>

 <script>
      alert(data[0]);
 </script> 
```

使用它，删除 var 使变量成为全局变量

# forms - 尝试使用表单更新或插入 Symfony2 控制器

> ID：10076876
> 
> 赞同：0
> 
> 时间：2012-04-09T17:08:21.743
> 
> 标签：forms, symfony, doctrine, controller, insert-update

我的代码有什么问题？我想`Moteur`根据 url 更新或插入一个对象。
提前谢谢。

```
/**
* @Route("/moteur/{moteurid}", name="moteur", requirements={"moteurid" = "\d+"}, defaults={"moteurid" = null})
* @Template()
*
* Cette page permet d'enregistrer de nouveaux moteurs (et de les éditer).
*/
public function moteurAction($moteurid)
{
    $args=array();
    $avertissement = null;
    if (!$this->get('security.context')->isGranted('ROLE_ADMIN'))
    {
        $avertissement = "Vous n'avez pas le droit d'accéder à cet espace.";
        return $this->redirect($this->generateUrl('index', array('avertissement' => $avertissement)));
    }

    $args['menu']['admin'] = 'selected';
    $obj = null;
    if ($moteurid == null)
    {
        $obj = new Moteur();
    }
    else
    {
        $obj = $this->getDoctrine()->getRepository('CreasixtineAFBundle:Moteur')->find($moteurid);
    }
    $form = $this->createForm(new FormMoteur(), $obj);
    $args['form'] = $form->createView();

    if ($this->getRequest()->getMethod() == 'POST')
    {
        $form->bindRequest($this->getRequest());

        if ($form->isValid())
        {
            $obj = $form->getData(); // Type Moteur()
            $pn = $obj->getPnid();

            $em = $this->getDoctrine()->getEntityManager();
            if ($moteurid == null)
            {
                $em->persist($obj);
                $avertissement = "Moteur créé !";
            }
            else 
            {
                // Rien, le moteur sera mis à jour avec flush()
                $avertissement = "Moteur mis à jour !";
            }
            foreach ($pn as $my_pn){$em->persist($my_pn);}
            $em->flush();

            return $this->redirect($this->generateUrl('admin', array('avertissement' => $avertissement)));
        }
        else
        {
            throw new Exception("Le formulaire n'est pas valide.");
        }
    }

    $contenu = $this->rendu($args, "formulaire_moteur.html.twig");
    return $contenu;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T09:22:13.950

首先，您不需要这一行，因为 PHP5 本身通过引用传递对象：

```
$obj = $form->getData(); // Type Moteur() 
```

然后，您在 Moteur 和 Pn 之间的关系有点混乱。你用 getPnid() 得到一个 Pn 但你得到一个你想要坚持的对象？

无论如何，这些 Pn 对象应该在 Moteur 之前持久化，所以这是我要写的：

```
if ($form->isValid())
{
    $em = $this->getDoctrine()->getEntityManager();

    $pn = $obj->getPnid();

    //Persist these related objects BEFORE Moteur
    foreach ($pn as $my_pn)
    {
        $em->persist($my_pn);
    }

    if ($moteurid == null)
    {
        $em->persist($obj);
        $avertissement = "Moteur créé !";
    }
    else 
    {
        // Rien, le moteur sera mis à jour avec flush()
        $avertissement = "Moteur mis à jour !";
    }
    $em->flush();

    return $this->redirect($this->generateUrl('admin', array('avertissement' => $avertissement)));
}
else
{
    throw new Exception("Le formulaire n'est pas valide.");
} 
```

# iphone - 使用 iOS5 使用自定义请求方法

> ID：10076883
> 
> 赞同：1
> 
> 时间：2012-04-09T17:09:02.357
> 
> 标签：iphone, rest, ios5, nsurlconnection, asihttprequest

我最初关于[使用 Android 使用自定义请求方法的](https://stackoverflow.com/questions/9742273/consuming-custom-request-methods)问题似乎很少引起注意——*我已将其转换为 Android 特定问题*

那么，很简单，在 iOS5 开发中，是否可以使用自定义请求方法？

如果是这样，如何。

根据[RFC-2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html) ，“标准”请求方法集是：

*   得到
*   放
*   邮政
*   删除
*   痕迹
*   连接

我想添加另一个，称为`SEARCH`. 在 API 上，使用 PHP 或 Java，这在 PHP 中很容易实现。事实证明，使用这种新的请求方法对 iOS 开发人员来说是一个挑战。

是否有人对支持自定义请求方法的工作示例或框架有任何参考，例如`SEARCH`，或`FOOBAR`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T21:30:32.563

ASIHTTPRequest 允许它：[http ://allseeing-i.com/ASIHTTPRequest/How-to-use](http://allseeing-i.com/ASIHTTPRequest/How-to-use)

查看“PUT 请求和自定义 POST”部分。

```
[request setRequestMethod:@"SOME_REQUEST_METHOD"]; 
```

# api - FB Php-SDK api("/me") 返回数组“发生未知错误”

> ID：10076884
> 
> 赞同：1
> 
> 时间：2012-04-09T17:09:04.387
> 
> 标签：api, facebook-graph-api, facebook-php-sdk

当我请求用户信息时出现此错误：

```
$user_info      =       array(
   "error_code" => 1,
   "error_msg" => "An unknown error occurred" 
```

)

可以是什么？它只发生在我的应用程序的一些用户身上，而不是所有用户。

# c - 带参数的函数调用后的堆栈结构

> ID：10076891
> 
> 赞同：1
> 
> 时间：2012-04-09T17:09:30.340
> 
> 标签：c, memory-management

我只是在查看`C`. 我知道所有全局变量和静态变量都存储在堆中。此外，堆栈存储所有函数调用。不过，我确实有一个疑问。假设我正在调用以下函数：

```
int ret;
int num = 10;
int arr[3] = {1,2,3};
int *ptr = &arr[0];
ret = giveNumber(num, ptr); 
```

在这里，我读到函数调用的参数`giveNumer()`也将存储在同一个堆栈中。但它们将按什么顺序存储？如果我弹出堆栈的顶部，哪个参数将首先弹出，`num`或者`ptr`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T17:13:01.293

**我知道所有全局变量和静态变量都存储在堆中**。
不，那不是真的。
根据标准，它们存储在实现定义的内存区域中，通常是数据段和 BSS。

**如果我弹出堆栈的顶部，将首先弹出哪个参数，`num`或者`ptr`**
函数参数的评估顺序是**Unspecified**。
所以这取决于你的编译器实现。编译器可能会评估以下参数：

*   从左到右或
*   从右到左或
*   任何其他随机顺序

因此，您看到的行为和顺序将取决于此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T17:18:36.967

除了@Als 已经提到的内容之外，*x86 上的大多数编译器*都遵循`_cdecl`从右到左评估参数的调用约定。在这里了解更多

[http://en.wikibooks.org/wiki/X86_Disassembly/Calling_Conventions#Standard_C_Calling_Conventions](http://en.wikibooks.org/wiki/X86_Disassembly/Calling_Conventions#Standard_C_Calling_Conventions)

# ios - 企业 iOS 配置文件续订错误：“Xcode 无法确定配置文件的团队”

> ID：10076893
> 
> 赞同：2
> 
> 时间：2012-04-09T17:09:41.417
> 
> 标签：ios, enterprise, provisioning-profile

*这是我在这里的第一篇文章，所以我提前为任何违反礼节的行为道歉。*

我在 iOS 领域工作了大约一年，专门为我的雇主处理企业应用程序。我们的主要配置文件即将到期，当我尝试通过 Xcode 的 Organizer 更新它时，我无法弄清楚为什么会收到此错误消息。

> **Xcode 无法确定配置文件的团队。**
> 
> Xcode 无法确定生成“配置文件名称”的团队。

我们最近在项目组织方面没有发生任何变化，也没有增加或拆分团队，而且我过去更新了这个配置文件，没有发生任何事故。出于某种原因，我确实有两个团队出现在 Organizer 中：正确的一个，以及一个名称是我们的一个应用程序的 10 个字符的字母数字捆绑 ID 前缀的团队。我无法弄清楚团队名称的来源或如何摆脱导致歧义的名称。

我无法在其他地方找到此错误消息的任何记录，因此我怀疑这是新包装中的一个老旧错误。对于解决此问题的任何指导，我将不胜感激。

# sql - 计算子表单总计

> ID：10076898
> 
> 赞同：1
> 
> 时间：2012-04-09T17:10:00.507
> 
> 标签：sql, ms-access, vba

我有一个看起来像数据表视图的子表单。它从我所做的查询中返回价格。本质上，我想使用 vba 计算这些价格的总和。我只是不知道如何获取所有价格并将它们放入数组中。

这是一张图片以获得更好的主意： ![在此处输入图像描述](../Images/2a24b285e39818d82c43c87983085c5e.png)

我希望 Compute Total 来计算总数。

子表单的记录源为：

```
SELECT [Rental Query].[CopyNo], [Rental Query].[RentalNo], [Rental Query].[Title], [Rental Query].[Format], [Rental Query].[DaysRented], [Rental Query].[Price] FROM [Rental Query]; 
```

我对价格感兴趣。查询使用特定公式来创建该字段。

我想要的是能够得到所有的价格并将它们相加。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:14:04.677

您可以将文本框添加到表单页脚并将其设置为：

```
=Sum(MyField) 
```

您将无法在数据表视图中看到该控件，但您可以在文本框中的主窗体上引用它：

```
=MySubformControl.Form.MySumControl 
```

# javascript - 如何在标签中获取值

> ID：10076900
> 
> 赞同：3
> 
> 时间：2012-04-09T17:10:02.120
> 
> 标签：javascript, html

```
<td id="hello"> OPD </td> 
```

在我的 html 页面上，这就是我在 tr 中获取 td 标记的方式。

我想在 java 脚本变量中获取值“OPD”。

```
var td1 = document.getElementById("hello"); 
```

我可以通过对 td1 执行任何操作来获取此值吗？

有没有其他方法可以做到这一点。请帮忙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T17:11:11.557

```
td1.innerHTML 
```

应该管用。[内部HTML](https://developer.mozilla.org/en/DOM:element.innerHTML)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T17:12:41.120

```
var td1 = (document.getElementById("hello")).innerHTML; 
```

或者

```
var td1 = ((document.getElementById("hello")).innerHTML).trim(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T17:26:03.183

做这件事有很多种方法：

*   您要么使用[DOM-Shim](https://github.com/Raynos/DOM-shim)，要么使用以下内容：

    ```
    var td1 = document.getElementById('hello').textContent 
    ```

*   或者您不想使用垫片，那么您必须使用以下内容（感谢 IE）：

    ```
    var hello = document.getElementById('hello'),
        td1
    if ('textContent' in hello) {
        td1 = hello.textContent // Standard way
    }
    else {
        td1 = hello.innerText // IE way
    } 
    ```

*   或者你使用 jQuery：

    ```
    var td1 = $('#hello').text() 
    ```

但是，不要使用innerHTML。由于许多原因，这很糟糕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T17:13:46.703

如果您对 jQuery 答案感兴趣...

```
var tdText = $('#hello').text(); 
```

或者

```
var tdTextTrimmed = $.trim($('#hello').text()); 
```

# javascript - jQuery 验证 - 两个必填字段和一个错误消息

> ID：10076903
> 
> 赞同：3
> 
> 时间：2012-04-09T17:10:17.040
> 
> 标签：javascript, jquery, jquery-validate

我一直在尝试使用[jQuery validate 插件](http://docs.jquery.com/Plugins/Validation)的 'group' 选项来验证两个选择框，这两个选择框都是必需的，但应该只显示一条错误消息：

JavaScript：

```
$('form').validate({
    groups: {
        cardExpiration: 'card_expirationMonth card_expirationYear'
    },
    rules: {
        card_expirationMonth: 'required',
        card_expirationYear: 'required'
    },
    errorPlacement: function (error, element) {
        if (element[0].name === 'card_expirationMonth' || element[0].name === 'card_expirationYear') {
            error.prependTo('form');
        }
    }
}); 
```

加价：

```
<form method="post" action="/wherever">
    <div class="-field field-expirationMonth">
        <select name="card_expirationMonth" id="card_expirationMonth">
            <option value="">MM</option>
            <option value="01">01</option>
            <option value="02">02</option>
            <option value="03">03</option>
            <option value="04">04</option>
            <option value="etc">Etc</option>
        </select>
    </div>
    <div class="-field field-expirationYear">
        <select name="card_expirationYear" id="card_expirationYear">
            <option value="">YY</option>
            <option value="2012">12</option>
            <option value="2013">13</option>
            <option value="2014">14</option>
            <option value="2015">15</option>
            <option value="etc">Etc</option>
        </select>
    </div>
</form> 
```

这似乎对错误消息进行了分组，因此只有一个可见，但似乎采取了只需要组中的一个字段的方法......有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:22:14.227

[http://docs.jquery.com/Plugins/Validation/validate#options](http://docs.jquery.com/Plugins/Validation/validate#options)上的演示显示了以下代码：

```
$("#myform").validate({
  groups: {
    username: "fname lname"
  },
  errorPlacement: function(error, element) {
     if (element.attr("name") == "fname" 
                 || element.attr("name") == "lname" )
       error.insertAfter("#lastname");
     else
       error.insertAfter(element);
   },
   debug:true
 }) 
```

请注意，没有“规则”。如果您从代码中删除它，也许事情会有所改善。

# javascript - 移动盒子插件回调函数

> ID：10076906
> 
> 赞同：0
> 
> 时间：2012-04-09T17:10:26.243
> 
> 标签：javascript, jquery

这种紧急情况，求各位大神帮帮我……

我正在为幻灯片使用movingboxes插件（这是原始插件：http://css-tricks.com/moving-boxes/）我需要帮助设置回调函数添加到动画的末尾。我需要添加淡入淡出效果，当`currentSlidecomplete`滑动时，它应该开始淡入同一图像的另一个视图，例如，`surrentSlide`src 是`images/dr1.jpg`，我需要它淡入`images/dr1b.jpg`并返回到 images/dr1.jpg。循环遍历每个当前幻灯片

类似完成的东西：

```
function(e, slider, tar){

    //fading for each currentSlide goes here;//
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:20:20.240

像你描述的东西已经在文档中

请参阅此处的文档 [1]，更具体地说，请参阅此处的文档 [2]。

编辑：在这里检查 jsfiddle，我使用了一个 jquery 插件[http://jsfiddle.net/r6yWC/157/](http://jsfiddle.net/r6yWC/157/) 插件在这里[http://jqueryfordesigners.com/image-cross-fade-transition/](http://jqueryfordesigners.com/image-cross-fade-transition/) 我还编辑了下面的代码部分。我在 img 标签中添加了“fade”类，如下所示：

```
<img class="fade" src="http://chriscoyier.github.com/MovingBoxes/demo/4.jpg" alt="picture" style="background: url(http://chriscoyier.github.com/MovingBoxes/demo/2.jpg);"/> 
```

在第二个链接中，您将找到一个带有已完成回调的movingBoxes 示例。

```
(function ($) {
    $.fn.cross = function (options) {
        return this.each(function (i) { 
            // cache the copy of jQuery(this) - the start image
            var $$ = $(this);

            // get the target from the backgroundImage + regexp
            var target = $$.css('backgroundImage').replace(/^url|[\(\)'"]/g, '');

            // nice long chain: wrap img element in span
            $$.wrap('<span style="position: relative;"></span>')
                // change selector to parent - i.e. newly created span
                .parent()
                // prepend a new image inside the span
                .prepend('<img>')
                // change the selector to the newly created image
                .find(':first-child')
                // set the image to the target
                .attr('src', target);

            // the CSS styling of the start image needs to be handled
            // differently for different browsers
            if ($.browser.msie || $.browser.mozilla) {
                $$.css({
                    'position' : 'absolute', 
                    'left' : 0,
                    'background' : '',
                    'top' : this.offsetTop
                });
            } else if ($.browser.opera && $.browser.version < 9.5) {
                // Browser sniffing is bad - however opera < 9.5 has a render bug 
                // so this is required to get around it we can't apply the 'top' : 0 
                // separately because Mozilla strips the style set originally somehow...                    
                $$.css({
                    'position' : 'absolute', 
                    'left' : 0,
                    'background' : '',
                    'top' : "0"
                });
            } else { // Safari
                $$.css({
                    'position' : 'absolute', 
                    'left' : 0,
                    'background' : ''
                });
            }

            // similar effect as single image technique, except using .animate 
            // which will handle the fading up from the right opacity for us
            $$.hover(function () {
                $$.stop().animate({
                    opacity: 0
                }, 250);
            }, function () {
                $$.stop().animate({
                    opacity: 1
                }, 250);
            });
        });
    };

})(jQuery);

$('#slider').movingBoxes({
// **** Appearance ****
// start with this panel
 ...
 ...

//-----> here is your callback
// callback after animation completes
completed: function(e, slider, tar){
    var img = slider.$panels.eq(tar).find('img');
    img.cross();
img.stop().animate({opacity: 0}, 1250).delay(500).animate({opacity: 1}, 2550);
}

});​ 
```

[1] [https://github.com/chriscoyier/MovingBoxes/wiki](https://github.com/chriscoyier/MovingBoxes/wiki)

[2] [http://jsfiddle.net/Mottie/r6yWC/2/](http://jsfiddle.net/Mottie/r6yWC/2/)

# android - 如何以编程方式检查接收到的消息是地址，数字还是android中的简单文本

> ID：10076910
> 
> 赞同：0
> 
> 时间：2012-04-09T17:10:45.313
> 
> 标签：android

我正在制作一个消息传递应用程序，用户可以在其中通过我的应用程序发送或接收消息，但我想要一个功能，如果用户通过 SMS 收到地址，那么他可以点击该地址并转移到谷歌地图，如果用户收到手机号码或电话号码，然后他就可以拨打该号码。我实现了与消息传递相关的所有功能，但未能代表上述信息进行检查。请向我建议有关该主题的正确解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:40:09.490

如果使用 a来显示消息，则可以在布局 XML的元素上`TextView`使用该属性。当检测到街道地址、电话号码和电子邮件地址时，这将自动创建链接。您的控制力较弱，但您可以免费获得很多！[`autoLink`](https://developer.android.com/reference/android/widget/TextView.html#attr_android:autoLink)`TextView`

从文档中：

```
android:autoLink

Controls whether links such as urls and email addresses are automatically found and converted to clickable links. The default value is "none", disabling this feature. 
```

**更新**

如果您想要所有支持的类型，`autoLinked`您可以使用`android:autoLink="all"`. `email`为、`phone`和`map`（由`|`字符分隔）创建自动链接的具体示例：

```
<TextView
    android:id="@+id/textView"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:autoLink="email|phone|map" >
</TextView> 
```

重要的是要注意`autoLink`for`map`并不完美。有关更多详细信息，请参见[此处](https://stackoverflow.com/questions/2624649/autolink-for-map-not-working)和[此处](https://stackoverflow.com/questions/8767721/android-autolink-attribute-in-textview-behaving-strangely)。

# asp.net-mvc-3 - MVC3 Telerik 批量编辑更新更新客户端但不是数据库表

> ID：10076919
> 
> 赞同：-1
> 
> 时间：2012-04-09T17:11:34.697
> 
> 标签：asp.net-mvc-3, batch-file, grid, telerik

我已经从 ASP.NET MVC 的 Telerik Extensions ( [Telerik Sample](http://demos.telerik.com/aspnet-mvc/grid/editingbatch) ) 中的编辑批处理示例中实现了 MVC3/Razor 网格控件，并且在大多数情况下，我认为它正在工作，但是我注意到虽然更新似乎是在客户端上工作，基础数据库表不会更新。

我认为我可能错过了执行此操作的某些步骤，但是在我使用 Northwind 数据库下载的 Telerik 示例中的产品名称的批量编辑示例中进行更新后，基础数据表也没有更改。

看法：

```
@model IEnumerable<MarketingWebsiteTools.Models.EditableCallout>

@using MarketingWebsiteTools.Extensions;
@using MarketingWebsiteTools.Models;

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Marketing Messages</h2>

@(Html.Telerik().Grid<MarketingWebsiteTools.Models.EditableCallout>()
    .Name("Grid")
            .DataKeys(keys =>
            {
                keys.Add(p => p.id);
            })
        .ToolBar(commands =>
        {
            commands.Insert();
            commands.SubmitChanges();
        })
    .Columns(columns =>
    {

        columns.Bound(o => o.ProductIdentifier).Width(125);
        columns.Bound(o => o.DateStart).Width(75);
        columns.Bound(o => o.DateEnd).Width(75);
        columns.Bound(o => o.Value).Width(75);
        columns.Bound(o => o.IsActive).Width(75);
        columns.Command(commands => commands.Delete()).Width(125).Title("Delete");
    })
                .ClientEvents(events => events.OnDataBinding("Grid_onDataBinding").OnError("Grid_onError"))
                .Editable(editing => editing.Mode(GridEditMode.InCell).DefaultDataItem(new EditableCallout
                {
                    DateStart = DateTime.Today

                }))
            .DataBinding(dataBinding => dataBinding.Ajax()
            .Select("_Index", "Callouts")
            .Update("_SaveBatchEditing", "Callouts")
            )

            .Pageable()
            .Scrollable()
            .Sortable()
            .Groupable()
            .Filterable()
)

<script type="text/javascript">
    function Grid_onError(args) {
        if (args.textStatus == "modelstateerror" && args.modelState) {
            var message = "Errors:\n";
            $.each(args.modelState, function (key, value) {
                if ('errors' in value) {
                    $.each(value.errors, function () {
                        message += this + "\n";
                    });
                }
            });
            args.preventDefault();
            alert(message);
        }
    }
    function Grid_onDataBinding(e) {
        var grid = $(this).data('tGrid');
        if (grid.hasChanges()) {
            if (!confirm('You are going to lose any unsaved changes. Are you sure?')) {
                e.preventDefault();
            }
        }
    }
</script>

@section HeadContent {
<style type="text/css">
    .field-validation-error
    {
        position: absolute;
        display: block;
    }

    * html .field-validation-error { position: relative; }
    *+html .field-validation-error { position: relative; }

    .field-validation-error span
    {
        position: absolute;
        white-space: nowrap;
        color: red;
        padding: 17px 5px 3px;
        background: transparent url('@Url.Content("~/Content/Common/validation-error-message.png") ') no-repeat 0 0;
    }

    /* in-form editing */
    .t-edit-form-container
    {
        width: 350px;
        margin: 1em;
    }

    .t-edit-form-container .editor-label,
    .t-edit-form-container .editor-field
    {
        padding-bottom: 1em;
        float: left;
    }

    .t-edit-form-container .editor-label
    {
        width: 30%;
        text-align: right;
        padding-right: 3%;
        clear: left;
    }

    .t-edit-form-container .editor-field
    {
        width: 60%;
    }
</style>
} 
```

控制器：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Entity;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using PagedList;
using Telerik.Web.Mvc;
using MarketingWebsiteTools.Models;
using MarketingWebsiteTools.ViewModels;
//using MarketingWebsiteTools.Services;
using MarketingWebsiteTools.Filters;

namespace MarketingWebsiteTools.Controllers
{ 
    public partial class CalloutsController : Controller
    {
        [SourceCodeFile("EditableCallout", "~/Models/EditableCallout.cs", Order=1 )]
        [SourceCodeFile("SessionCalloutRepository", "~/Models/SessionCalloutRepository.cs", Order = 2)]
        [SourceCodeFile("SessionCalloutRepository", "~/Models/SessionCalloutRepository.cs", Order = 3)]

        public ActionResult Index()
        {
            return View();
        }

        [GridAction]
        public ActionResult _Index()
        {
            return View(new GridModel(SessionCalloutRepository.All()));
        }

        [AcceptVerbs(HttpVerbs.Post)]
        [CultureAwareAction]
        [GridAction]
        public ActionResult _SaveBatchEditing([Bind(Prefix =
            "inserted")]IEnumerable<EditableCallout> insertedCallouts,
            [Bind(Prefix = "updated")]IEnumerable<EditableCallout> updatedCallouts,
            [Bind(Prefix = "deleted")]IEnumerable<EditableCallout> deletedCallouts)
        {
            if (insertedCallouts != null)
            {
                foreach (var callouts in insertedCallouts)
                {
                    SessionCalloutRepository.Insert(callouts);
                }
            }
            if (updatedCallouts != null)
            {
                foreach (var callouts in updatedCallouts)
                {

                    var target = SessionCalloutRepository.One(p => p.id == callouts.id);
                    if (target != null)
                    {
                        target.DateStart = callouts.DateStart;
                        target.DateEnd = callouts.DateEnd;
                        target.Value = callouts.Value;
                        target.IsActive = callouts.IsActive;
                        SessionCalloutRepository.Update(target);
                    }
                }
            }
            if (deletedCallouts != null)
            {
                foreach (var product in deletedCallouts)
                {
                    SessionCalloutRepository.Delete(product);
                }
            }
            return View(new GridModel(SessionCalloutRepository.All()));
        }
    }
} 
```

模型：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using System.Runtime.Serialization;

namespace MarketingWebsiteTools.Models
{
    //[KnownType(typeof(EditableCallout))]
    public class EditableCallout
    {
        //[ScaffoldColumn(false)]
        [DisplayName("id")]
        public int id { get; set; }
        [Required]
        [DisplayName("ProductIdentifier")]
        public string ProductIdentifier { get; set; }

        [DisplayName("DateStart")]
        public DateTime? DateStart { get; set; }

        [DisplayName("DateEnd")]
        public DateTime? DateEnd { get; set; }

        [DisplayName("IsActive")]
        public int? IsActive { get; set; }

        [DisplayName("Value")]
        public string Value { get; set; }
    }
} 
```

存储库：

```
namespace MarketingWebsiteTools.Models
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Web;
    using MarketingWebsiteTools.ViewModels;
    using MarketingWebsiteTools.Models;

    public static class SessionCalloutRepository
    {
        public static IList<EditableCallout> All()
        {
            WebsiteDataContext wdc = new WebsiteDataContext();
            //CalloutContext db = new CalloutContext();
            IList<EditableCallout> result = (IList<EditableCallout>)HttpContext.Current.Session["Callouts"];

            if (result == null)
            {
                HttpContext.Current.Session["Callouts"] = result =
                   (from c in wdc.CalloutToProducts
                    join cv in wdc.CalloutValues on c.CalloutID equals cv.CalloutID
                    select new EditableCallout
                    {
                        id = c.id,
                        ProductIdentifier = c.ProductIdentifier,
                        DateStart = c.DateStart,
                        DateEnd = c.DateEnd,
                        Value = cv.Value,
                        IsActive = c.IsActive
                    }).ToList();
            }

            return result;
        }

        public static EditableCallout One(Func<EditableCallout, bool> predicate)
        {
            return All().Where(predicate).FirstOrDefault();
        }
        public static void Insert(EditableCallout callout)
        {
            callout.id = All().OrderByDescending(c => c.id).First().id+ 1;
            All().Insert(0, callout);
        }

        public static void Update(EditableCallout callout)
        {
            EditableCallout target = One(c => c.id == callout.id);
            if (target != null)
            {
                target.ProductIdentifier = callout.ProductIdentifier;
                target.DateEnd = callout.DateEnd;
                target.DateStart = callout.DateStart;
                target.Value = callout.Value;
                target.IsActive = callout.IsActive;

            }
        }
        public static void Delete(EditableCallout callout)
        {
            EditableCallout target = One(c => c.id== callout.id);
            if (target != null)
            {
                All().Remove(target);
            }
        }
    }
} 
```

谢谢

道格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T08:37:34.810

Telerik 演示故意不更新底层数据库。所有更改都保存在内存中（在会话中）。您需要添加将更新数据库所需的代码。

# mysql - 无法创建外键约束

> ID：10076921
> 
> 赞同：1
> 
> 时间：2012-04-09T17:11:43.090
> 
> 标签：mysql, foreign-keys

```
CREATE TABLE share(
    `User_1` VARCHAR(50) NOT NULL,
    `User_2` VARCHAR(50) NOT NULL,
    PRIMARY KEY(`User_1`,`User_2`),
     CONSTRAINT `fk_1` FOREIGN KEY (`User_1`) REFERENCES user(`Dev_ID`)  ON DELETE RESTRICT ON UPDATE CASCADE ,
     CONSTRAINT `fk_2` FOREIGN KEY (`User_2`) REFERENCES user(`Dev_ID`)  ON DELETE RESTRICT ON UPDATE CASCADE 
); 
```

我收到此错误：

> {外键约束格式不正确}

我想在 user1 和 user2 之间建立一个链接。

# ruby - 在字符串中输出变量的“正确”方式

> ID：10076930
> 
> 赞同：4
> 
> 时间：2012-04-09T17:12:33.707
> 
> 标签：ruby

我见过很多输出变量的方法。这些方法中哪个“更好”？

```
my_name = 'Jeff Hall'
my_height = 74 
puts "Let's talk about %s." % my_name
puts "He's %d inches tall." % my_height 
```

对比

```
puts "Let's talk about #{my_name}."
puts "He's #{my_height} inches tall." 
```

另外，`s`和`d`之后代表`%`什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T17:22:30.253

除非我需要格式化字符串，否则我更喜欢第二种方式。有关样式的更多问题，请查看[GitHub Styleguide for Ruby](https://github.com/styleguide/ruby)。

关于`%s`和`%d`。它们是格式化程序，它们的列表在[Ruby Kernel::sprintf doc page 上](http://ruby-doc.org/core-2.3.1/Kernel.html#method-i-sprintf)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T17:21:42.097

请参阅该[`String#%`](http://ruby-doc.org/core-1.9.3/String.html#method-i-25)方法的文档，其中引用[`Kernel#sprintf`](http://ruby-doc.org/core-1.9.3/Kernel.html#method-i-sprintf)了描述内容`%s`和`%d`含义的参考资料。

字符串插值适用于简单的自记录字符串。但是，使用占位符可以使您的代码更短，并且还可以为您提供格式化功能，而不仅仅是字符串插值：

```
values = { average:12.3, max:15.34734112, min:9.2314311 }
values.each do |name,value|
  puts "%7s: %5.2f" % [ name, value ]
end

#=> average: 12.30
#=>     max: 15.35
#=>     min:  9.23 
```

这些`printf`代码非常令人讨厌，并且它们[与其他语言有着悠久的历史](http://en.wikipedia.org/wiki/Printf_format_string)（这就是它们看起来不像 Ruby 的原因），但它们功能强大且简洁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-16T19:02:15.857

我最近才偶然发现 % 称为嵌入。似乎它替代了您在 % 之后放置的内容。

> 例如

```
name = "harry"
puts "My name is %s" %name 
```

%s 和 %d 的简单答案是 %s 用于字符串，而 %d 用于小数。继续前面的例子。

```
age = 35
puts "My name is %s and I am %d years old" %[name, age] 
```

# json - d3 - 读取 JSON 数据而不是 CSV 文件

> ID：10076940
> 
> 赞同：23
> 
> 时间：2012-04-09T17:13:33.300
> 
> 标签：json, csv, d3.js

我正在尝试使用 JSON 将数据读入我的日历可视化。目前使用 CSV 文件效果很好：

```
d3.csv("RSAtest.csv", function(csv) {
  var data = d3.nest()
    .key(function(d) { return d.date; })
    .rollup(function(d) { return d[0].total; })
    .map(csv);

 rect.filter(function(d) { return d in data; })
      .attr("class", function(d) { return "day q" + color(data[d]) +
"-9"; })
      .select("title")
      .text(function(d) { return d + ": " + data[d]; });

}); 
```

它读取以下 CSV 数据：

```
date,total
2000-01-01,11
2000-01-02,13
.
.
.etc 
```

关于如何读取以下 JSON 数据的任何指示： `{"2000-01-01":19,"2000-01-02":11......etc}`

我尝试了以下方法，但它对我不起作用（datareadCal.php 为我吐出 JSON）：

```
d3.json("datareadCal.php", function(json) {
  var data = d3.nest()
    .key(function(d) { return d.Key; })
    .rollup(function(d) { return d[0].Value; })
    .map(json); 
```

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-09T17:50:21.410

您可以使用[d3.entries()](https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_entries)将对象文字转换为键/值对数组：

```
var countsByDate = {'2000-01-01': 10, ...};
var dateCounts = d3.entries(countsByDate);
console.log(JSON.stringify(dateCounts[0])); // {"key": "2000-01-01", "value": 10} 
```

但是，您会注意到的一件事是生成的数组没有正确排序。您可以通过键升序对它们进行排序，如下所示：

```
dateCounts = dateCounts.sort(function(a, b) {
    return d3.ascending(a.key, b.key);
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-12T14:49:33.893

将您的 .json 文件转换为包含在 html 文件中的 .js 文件。在您的 .js 文件中有：

```
var countsByDate = {'2000-01-01':10,...}; 
```

然后你可以引用countsByDate ....不需要从文件本身读取。

你可以阅读它：

```
var data = d3.nest()
.key(function(d) { return d.Key; })          
.entries(json); 
```

顺便说一句....d3.js 说最好将您的 json 设置为：

```
var countsByDate = [
  {Date: '2000-01-01', Total: '10'},
  {Date: '2000-01-02', Total: '11'},
]; 
```

# android - 恢复到以前的 ADT 插件

> ID：10076943
> 
> 赞同：0
> 
> 时间：2012-04-09T17:13:55.143
> 
> 标签：android, jar, adt

现在我想知道是否有人能够完成恢复到以前的 ADT 插件。

这样做的原因是因为我使用的是开源 jar，并且在我的 LogCat 上出现以下错误，例如：

1.  无法解析虚方法
2.  找不到签名中引用的类
3.  无法解决新实例

这会导致在调试器上运行我的 android 应用程序时出错。

我之前使用的是 android ADT 15，现在我更新到了 17。

请帮助找到解决问题的解决方案。

编辑*忘记添加错误“java.lang.NoClassDefFoundError”。简单来说，即使它允许，它也无法找到附加 jar 的类或方法。

编辑* Logcat 添加

```
04-09 17:22:56.488: E/AndroidRuntime(4057): FATAL EXCEPTION: main
04-09 17:22:56.488: E/AndroidRuntime(4057): java.lang.NoClassDefFoundError: nl.siegmann.epublib.epub.EpubReader
04-09 17:22:56.488: E/AndroidRuntime(4057):     at ebook.holder.ReadWholeBook.amBook(ReadWholeBook.java:796)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at ebook.holder.ReadWholeBook.firstPartBook(ReadWholeBook.java:720)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at ebook.holder.ReadWholeBook.initializeLoading(ReadWholeBook.java:159)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at ebook.holder.ReadWholeBook.onCreate(ReadWholeBook.java:109)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at android.os.Looper.loop(Looper.java:123)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at android.app.ActivityThread.main(ActivityThread.java:3683)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at java.lang.reflect.Method.invokeNative(Native Method)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at java.lang.reflect.Method.invoke(Method.java:507)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-09 17:22:56.488: E/AndroidRuntime(4057):     at dalvik.system.NativeStart.main(Native Method) 
```

这些是给出的警告：

```
04-09 17:22:56.158: W/dalvikvm(4057): VFY: unable to resolve new-instance 144 (Lnl/siegmann/epublib/epub/EpubReader;) in Lebook/holder/ReadWholeBook;
04-09 17:22:56.177: W/dalvikvm(4057): VFY: unable to find class referenced in signature (Lnl/siegmann/epublib/domain/Book;)
04-09 17:22:56.217: W/dalvikvm(4057): VFY: unable to find class referenced in signature (Lnl/siegmann/epublib/domain/Book;)
04-09 17:22:56.233: W/dalvikvm(4057): VFY: unable to resolve virtual method 433: Lnl/siegmann/epublib/domain/Book;.getSpine ()Lnl/siegmann/epublib/domain/Spine;
04-09 17:22:56.277: W/dalvikvm(4057): VFY: unable to find class referenced in signature (Lnl/siegmann/epublib/domain/Book;)
04-09 17:22:56.277: W/dalvikvm(4057): VFY: unable to resolve virtual method 433: Lnl/siegmann/epublib/domain/Book;.getSpine ()Lnl/siegmann/epublib/domain/Spine; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T07:33:06.333

您可以通过以下步骤恢复到以前版本的 ADT 插件：

1.  下载以前版本的 ADT（zip 存档）。官方更改日志，其中包含来自 Google 的历史 ADT 版本号列表：http: [//developer.android.com/tools/sdk/eclipse-adt.html](http://developer.android.com/tools/sdk/eclipse-adt.html)。下载旧版本时使用的确切文件名和格式：( [http: //dl.google.com/android/ADT-16.0.1.zip](http://dl.google.com/android/ADT-16.0.1.zip) , [http://dl.google.com/android/ADT-21.0.0.zip](http://dl.google.com/android/ADT-21.0.0.zip)等），请参阅如何在 Eclipse中[安装旧的 ADT13](https://stackoverflow.com/questions/7877361/how-install-old-adt13-in-eclipse)有关该过程的更多详细信息。选择要还原到的版本。

2.  在 Eclipse 菜单中，转到 Window -> Preferences -> Install/Update -> Available Software Sites 并通过单击“Archive”按钮将最近下载的存档添加到列表中。

3.  在 Eclipse 菜单中，转到帮助 -> 关于 Eclipse -> 安装详细信息 -> 安装历史并在列表中选择适当的项目。然后单击“还原”按钮。

4.  成功还原并重新启动 Eclipse 后，您将获得以前版本的 ADT，但此旧版本的 ADT 可能与您计算机上安装的 Android SDK 不兼容。[您可以使用“此版本的 ADT 需要版本 17 或更高版本的 Android SDK 工具](https://stackoverflow.com/questions/10183362/this-verison-of-adt-requires-android-sdk-tools-in-revision-17-or-above-i-can)”来“破解”Android SDK 中的 ADT 版本检查。[我不能让这个错误消失。](https://stackoverflow.com/questions/10183362/this-verison-of-adt-requires-android-sdk-tools-in-revision-17-or-above-i-can)

5.  完成上述所有步骤后，您可以使用 ADT 的还原版本，但如果您的项目的某些部分始终依赖于较新版本的 ADT 或 SDK，您必须手动解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T09:50:13.467

回答您的问题：不，不可能恢复到以前版本的 ADT 插件。即使 Eclipse 可以恢复配置，所需的旧版本插件在 Google 存储库中根本不可用。

不幸的是，没有关于您的问题的提示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T17:18:04.703

我要做的第一件事是删除所有输出（gen、target、out）并完全重建项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-17T03:12:54.860

我遇到了问题并在一周前解决了它。

你一定在用adt22，对吧？

当您使用adt22时，如果您有一个名为libs的文件夹（其中包含一些第三方jar），则会显示一个名为Android Private Libraries的库。不幸的是，在编译项目时，这个带有jar的lib没有导出到apk，早期的插件可以做的很好。

所以你需要手动导出罐子。

Project->Build path->找到Order and Export选项卡，选择Android Private Libraries。然后删除bin文件夹（使项目编译干净），你会得到一个更大的apk，里面有
jar。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T13:46:22.233

没有选择没有可能的方式让一切恢复原状。唯一的解决方案是系统还原。

# c++ - c++ char 数组：a[i] = b[i] 失败

> ID：10076948
> 
> 赞同：1
> 
> 时间：2012-04-09T17:14:10.247
> 
> 标签：c++, char

我在尝试将 char 复制到 char 时遇到了一些麻烦...

这是 args[] 定义：

```
char* args[6];
if (1 == ParseQuery(request, &args[0])) ....

#note : args[ARG_DATE] = "201204090600" 
```

这是 d 定义：

```
struct date {
  char a[4];
  char m[2];
  char j[2];
  char h[4];
};

date d; 
```

这就是我想要做的：

```
int TileServe::ParseQuery(FastCGIRequest& request, char** args) {

for (int i=0; i<4; i++) {
  d.a[i] = args[ARG_DATE][i];
  d.h[i] = args[ARG_DATE][i+8];
}
for (int i=0; i<2; i++) {
  d.m[i] = args[ARG_DATE][i+4];
  d.j[i] = args[ARG_DATE][i+6];
}

strcat(filename, "/");
strcat(filename, d.a);
strcat(filename, "/");
strcat(filename, d.m);
...
printf("%s\n", filename); 
```

我得到：

```
./data/alpes/201204090600/04090600/090600/0600/alpes_201204090600.nc 
```

我期待着 ：

```
./data/alpes/2012/04/09/06/alpes_201204090600.nc 
```

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T17:15:55.177

大多数 C 函数都需要以 null 结尾的字符串。您的子字符串 (da, dm, ...) 不是以空值结尾的。因此`strcat`，将所有内容追加到它在您的子字符串之后在内存中找到的第一个空字符。

一种解决方法是将 char 数组加长 1 并将`'\0'`字符放在子字符串的末尾。

另一个解决方法是使用`strncat`而不是`strcat`附加指定数量的字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T17:17:48.310

尝试类似：

```
strncat(filename, "/", 1);
strncat(filename, d.a, 4);
strncat(filename, "/", 1);
strncat(filename, d.m, 2);
... 
```

另外， -`NUL`终止你的字符串。

# gis - 开源地图

> ID：10076953
> 
> 赞同：2
> 
> 时间：2012-04-09T17:14:29.780
> 
> 标签：gis

任何人都可以建议我应该使用什么程序/方法？我需要一个像谷歌地图这样的地图，我可以在其中显示地图，添加标记多边形等。但我不能依赖这样的在线服务，因为客户担心这样的服务会消失，我们的系统就会消失......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:01:00.290

在 GIS.SE 上查看这些问题的答案中指出的大量资源：

[**网络地理信息系统**](https://gis.stackexchange.com/questions/21452/gis-for-the-web)

[**开始 Web 制图的步骤**](https://gis.stackexchange.com/questions/8113/steps-to-start-web-mapping)

您可能想查看[Google Fusion Tables](http://www.google.com/fusiontables/Home/)或[MapBox](http://mapbox.com/)或[CartoDB](http://cartodb.com/)等解决方案，以获得快速的托管解决方案。

愿意投入更多时间（取决于您的技能和语言偏好），您可以使用[OpenLayers](http://openlayers.org) / [Leaflet](http://leaflet.cloudmade.com/)（或任何[其他库](https://gis.stackexchange.com/questions/8032/comparison-of-javascript-mapping-libraries)）的前端深入研究[PostGIS](http://postgis.refractions.net/) & [GeoServer](http://geoserver.org) / [Mapserver 。](http://mapserver.org/)[OSGeo-Live DVD](http://live.osgeo.org/en/overview/overview.html)可能会派上用场，以便对大多数这些选项进行快速而肮脏的审查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T11:51:59.160

这里是纯粹的基于开源的 web 地图和地理位置数据库资源。谷歌地图或必应地图很棒，但它们需要商业合同才能用于商业用途。据说 Foursquare 最近将他们的地图工具从谷歌地图切换到了基于开源的 Leaflet API，如下图所示。这个地图工具非常棒，值得推荐。

![在此处输入图像描述](../Images/a652d291d6200d3a8a58988d91e2ea49.png)

*   地图的网络 API：http: [//leafletjs.com/](http://leafletjs.com/)

开始的好地方。下面的两个资源并没有真正用于开发人员，因为它们已经包含在传单 JavaScript API 中。

*   地图样式：[http ://cloudmade.com/](http://cloudmade.com/)

*   地图数据：[http ://www.openstreetmap.org/](http://www.openstreetmap.org/)

*   基于 IP 地址的地理位置：http: [//dev.maxmind.com/geoip/geolite](http://dev.maxmind.com/geoip/geolite)

可免费下载IP地址&城市映射文件，可用于自定义映射代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T12:52:10.603

我推荐[http://mapserver.org/](http://mapserver.org/)

您可以在服务器中创建地图文件......您可以连接到 PostGIS 等开源数据库

# solr - 如何使用 Tika 解析阿拉伯文 pdf

> ID：10076959
> 
> 赞同：1
> 
> 时间：2012-04-09T17:14:46.130
> 
> 标签：solr, arabic, apache-tika

我已经用 solr 安装了 tika ，它适用于阿拉伯语 pdf ，是否有任何教程可以实现这一点，我看到了一个类似的问题，解决方案是包含 ICU4J.jar ，但我现在没有这是什么意思

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:42:20.317

ICU4J 可以在这里下载：http: [//site.icu-project.org/download](http://site.icu-project.org/download)

# html - IE 9 中的 CSS 问题 - 框从左到右折叠

> ID：10076960
> 
> 赞同：1
> 
> 时间：2012-04-09T17:14:51.650
> 
> 标签：html, css

我首先要说这不是我的工作，但我仍在努力弄清楚如何解决它......这是有问题的页面：

[http://www.getredwood.com/pro/](http://www.getredwood.com/pro/)

底部的三个内容区域是有问题的部分。当我在 Firefox 或 Chrome 中查看它时，它看起来不错，但在 IE 9 中，所有内容从左到右折叠，并且这些框实际上彼此重叠了一点。那里的 CSS 现在看起来有点乱，我不知道从哪里开始。将不胜感激任何想法。谢谢！

我不确定是否需要在此处发布 CSS 代码...它应该可以通过 FF 中的“检查元素”看到，但如果有人看不到它，请告诉我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:19:51.090

这在浏览器的兼容性范围内，您需要做的是使用 javascript 来确定正在使用的浏览器，然后为每个浏览器创建自定义样式，从而允许您使其在任何和所有浏览器上工作

这里有一些链接可以帮助你

[http://www.quirksmode.org/js/detect.html](http://www.quirksmode.org/js/detect.html)

[http://www.w3schools.com/js/js_browser.asp](http://www.w3schools.com/js/js_browser.asp)

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:21:44.970

这是非常糟糕的 CSS 和 HTML 编码......

尝试减少每 3 个 div 的宽度，应该可以解决您的问题。

# java - 如何确保用户在控制器级别登录系统？

> ID：10076965
> 
> 赞同：1
> 
> 时间：2012-04-09T17:15:42.927
> 
> 标签：java, spring, spring-mvc

我正在使用 spring MVC，并且我有一个必须构建的自定义身份验证/安全系统。

```
NOTE:  I know of spring security, but my requirements were to do this in a custom way so please not looking for suggestions about using spring's security modules. 
```

当用户登录系统时，它会创建一个会话 cookie。当用户访问页面时，拦截器会查找该 cookie 的存在，并在 mysql 中查找会话 guid，如果存在，它会加载一些数据并将其存储在请求的属性中。

现在对于用户必须登录的页面，如何在控制器级别限制访问？

我可以在拦截器中做到这一点：

```
if url.contains("projects/") ... 
```

如果我想限制对 ProjectController 中的登录用户的访问，但这并不是我真正想做的事情。

但是我正在寻找一个可以在控制器级别添加的注释，或者可能以某种方式创建一个 BaseController ，所有需要登录用户的控制器都将从该控制器继承。

对于这样的事情，我有什么选择？

在 ASP.NET 中，我创建了一个 baseController，并且该控制器有一个事件循环，并且在操作前触发的事件中我检查了用户是否已登录。

那么寻找有关spring mvc的建议吗？

**更新**

例如，在 ASP.NET 中，您有 2 种方法，一种在控制器的操作方法之前触发，另一种在之后触发：

```
Controller.OnActionExecuting 
Controller.OnActionExecuted 
```

[http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.onactionexecuting.aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.onactionexecuting.aspx)

**所以在 OnActionExecuting 中，我实际上可以确切地看到我在哪个控制器中，以及哪个动作将以编程方式被调用，而不是通过查看请求 URL 然后进行字符串比较以查看它是否是特定控制器等.**

所以在这种情况下，我可以简单地检查 cookie 或我的请求属性等中的内容。

这是一种更稳定的方法，spring有类似的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T18:47:47.957

如果您在控制器级别需要此功能，您可以：

1）在控制器方法签名中声明一个[java.security.Principal](http://docs.oracle.com/javase/6/docs/api/java/security/Principal.html)参数，Spring会用一个`Principal`对象来填充，或者

2) 实现一个[PermissionEvaluator](http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/access/PermissionEvaluator.html)，它可以使用[@PreAuthorize](http://org.springframework.security.access.prepost.PreAuthorize)注释在控制器方法上调用，并且可以访问[Authentication](http://static.springsource.org/spring-security/site/apidocs/org/springframework/security/core/Authentication.html)对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T18:08:34.763

与您在 ASP.NET 中所做的类似，您可以利用[`OncePerRequestFilter`](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/filter/OncePerRequestFilter.html)它并将其链接到您拥有的过滤器链`web.xml`或 Spring 应用程序上下文中。这个过滤器的好处是它独立于您采用的 MVC 方法，并且不需要“基本控制器”。

另一方面，如果您还使用 Spring 安全模块，则可以使用[自定义过滤器](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/appendix-namespace.html#d0e7939)配置并将其放置在应有[的](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#ns-custom-filters)[正确位置](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/security-filter-chain.html#d0e2952)。

如果检查失败，那么您可能希望引发异常或将用户重定向到正确的导航。

根据最后一条评论，您还可以使用[映射拦截器](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-config)：

```
<mvc:interceptors>
    <mvc:interceptor>
        <mapping path="/myFirstPath/*"/>
        <mapping path="/mySecondPath/*"/>
        <bean class="org.example.SomeInteceptor" />
    </mvc:interceptor>
    <mvc:interceptor>another one</mvc:interceptor>
</mvc:interceptors> 
```

# c# - 使用引用其依赖项的构造函数创建动态类型

> ID：10076969
> 
> 赞同：9
> 
> 时间：2012-04-09T17:16:04.810
> 
> 标签：c#, dynamic, reflection, reflection.emit

我有以下课程：

```
public class Entity<T> where T : Entity<T> {
    public Factory<T> Factory { get; private set; }
    public Entity(Factory<T> factory) {
        Factory = factory;
    }
}
public class Factory<T> { }

public class MyEntity : Entity<MyEntity> {
    public MyEntity(Factory<MyEntity> factory) : base(factory) { }
} 
```

我正在尝试使用指定的构造函数动态创建类 MyEntity 。到目前为止，我有以下代码：

```
class Program {
    static ModuleBuilder _moduleBuilder;
    public static ModuleBuilder ModuleBuilder {
        get {
            if (_moduleBuilder == null) {
                AssemblyBuilder asmBuilder = System.Threading.Thread.GetDomain().DefineDynamicAssembly(new AssemblyName("Dynamic"), AssemblyBuilderAccess.Run);
                _moduleBuilder = asmBuilder.DefineDynamicModule("MainModule");
            }
            return _moduleBuilder;
        }
    }

    static void Main(string[] args) {
        TypeBuilder typeBuilder = ModuleBuilder.DefineType("MyEntity", TypeAttributes.Public);
        Type baseType = typeof(Entity<>).MakeGenericType(typeBuilder);
        typeBuilder.SetParent(baseType);

        Type factoryType = typeof(Factory<>).MakeGenericType(typeBuilder);

        ConstructorBuilder cBuilder = typeBuilder.DefineConstructor(MethodAttributes.Public, CallingConventions.Standard, new Type[] { factoryType });
        ILGenerator ctorIL = cBuilder.GetILGenerator();
        ctorIL.Emit(OpCodes.Ldarg_0);
        ctorIL.Emit(OpCodes.Ldarg_1);
        ConstructorInfo c = baseType.GetConstructor(new Type[] { factoryType });
        ctorIL.Emit(OpCodes.Call, c);
        ctorIL.Emit(OpCodes.Ret);

        Type syType = typeBuilder.CreateType();
        Console.ReadLine();
    }
} 
```

代码失败 @ `ConstructorInfo c = baseType.GetConstructor(new Type[] { factoryType })`。我得到了一个 NotSupportedException。

有什么办法可以做到这一点？我已经被这件事困扰了三天。任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T18:30:43.487

您需要使用静态[`TypeBuilder.GetConstructor`](http://msdn.microsoft.com/en-us/library/ms145822.aspx)方法。我认为这应该有效（未经测试）：

```
ConstructorInfo genCtor = typeof(Entity<>).GetConstructor(new Type[] { typeof(Factory<>).MakeGenericType(typeof(Entity<>).GetGenericArguments()) }); 
ConstructorInfo c = TypeBuilder.GetConstructor(baseType, genCtor); 
```

# php - 将 XML 导入 MySQL，无法获取所有子标签

> ID：10076970
> 
> 赞同：2
> 
> 时间：2012-04-09T17:16:13.980
> 
> 标签：php, mysql, xml, arrays, csv

首先让我从我们在这里所做的事情开始：我们从一台服务器中提取一个 XML 文件并将其放入另一个服务器中，该服务器也是 php 代码所在的位置。然后需要将一些 XML 数据导入到本地 MySQL 数据库中。XML 是在线商店订单的副本。有些订单包含该人订购的多件商品，有些订单则不包含该人订购的一件商​​品。

因此，对于 XML 示例，我们有：

```
<?xml version="1.0" encoding="UTF-8"?>
<xmldata>
  <Orders>
    <OrderID>2119</OrderID>
    <AddressValidated>Y</AddressValidated>
    <Affiliate_Commissionable_Value>2.0000</Affiliate_Commissionable_Value>
    <AuthHash>d995fd9424fb99e80f58841a0ff2340f</AuthHash>
    <AVS />
    <BillingAddress1>122 27th West</BillingAddress1>
    <BillingAddress2>Floor 11</BillingAddress2>
    <BillingCity>New York</BillingCity>
    <BillingCompanyName />
    <BillingCountry>United States</BillingCountry>
    <BillingFaxNumber />
    <BillingFirstName>Dan</BillingFirstName>
    <BillingLastName>Test</BillingLastName>
    <BillingPhoneNumber>646456777</BillingPhoneNumber>
    <BillingPostalCode>10001</BillingPostalCode>
    <BillingState>NY</BillingState>
    <CardHoldersName />
    <CC_Last4 />
    <CreditCardAuthorizationDate>3/30/2012 11:52:00 AM</CreditCardAuthorizationDate>
    <CreditCardAuthorizationNumber>MANUAL</CreditCardAuthorizationNumber>
    <CreditCardTransactionID />
    <Customer_IPAddress>184.56.49.45</Customer_IPAddress>
    <CustomerID>19</CustomerID>
    <CVV2_Response />
    <GiftWrapNote />
    <IsAGift>N</IsAGift>
    <LastModBy>7</LastModBy>
    <LastModified>3/30/2012 1:39:00 PM</LastModified>
    <Locked>Y</Locked>
    <Order_Comments>Test sale - Don't process
Ignore statuses on this order</Order_Comments>
    <Order_Entry_System>PHONE</Order_Entry_System>
    <OrderDate>3/30/2012 11:01:00 AM</OrderDate>
    <OrderNotes />
    <OrderStatus>Ready to Ship</OrderStatus>
    <PaymentAmount>8.1600</PaymentAmount>
    <PaymentMethodID>17</PaymentMethodID>
    <PONum />
    <Processed_AutoEvents>Y</Processed_AutoEvents>
    <SalesRep_CustomerID>7</SalesRep_CustomerID>
    <SalesTax1>0.1700</SalesTax1>
    <SalesTax2>0.0000</SalesTax2>
    <SalesTax3>0.0000</SalesTax3>
    <SalesTaxRate>0</SalesTaxRate>
    <SalesTaxRate1>0.08375</SalesTaxRate1>
    <SalesTaxRate2>0</SalesTaxRate2>
    <SalesTaxRate3>0</SalesTaxRate3>
    <ShipAddress1>123 27th West</ShipAddress1>
    <ShipAddress2>Floor 1</ShipAddress2>
    <ShipCity>New York</ShipCity>
    <ShipCompanyName />
    <ShipCountry>United States</ShipCountry>
    <ShipFaxNumber />
    <ShipFirstName>Dan</ShipFirstName>
    <ShipLastName>Test</ShipLastName>
    <ShipPhoneNumber>646782342</ShipPhoneNumber>
    <Shipping_Locked>Y</Shipping_Locked>
    <ShippingMethodID>1</ShippingMethodID>
    <ShipPostalCode>10001</ShipPostalCode>
    <ShipResidential>Y</ShipResidential>
    <ShipState>NY</ShipState>
    <Stock_Priority>3</Stock_Priority>
    <Tax1_IgnoreNoTaxRules />
    <Tax1_Title>Tax (8.375%)</Tax1_Title>
    <Tax2_IgnoreNoTaxRules />
    <Tax2_IncludePrevious>0</Tax2_IncludePrevious>
    <Tax2_Title />
    <Tax3_IgnoreNoTaxRules />
    <Tax3_IncludePrevious>0</Tax3_IncludePrevious>
    <Tax3_Title />
    <Total_Payment_Authorized>0.0000</Total_Payment_Authorized>
    <Total_Payment_Received>7.0700</Total_Payment_Received>
    <TotalShippingCost>5.9900</TotalShippingCost>
    <VendorID>0</VendorID>
    <OrderDetails>
      <OrderDetailID>3374</OrderDetailID>
      <AutoDropShip>Y</AutoDropShip>
      <FreeShippingItem>Y</FreeShippingItem>
      <GiftTrakNumber>0</GiftTrakNumber>
      <GiftWrap />
      <GiftWrapCost>0.0000</GiftWrapCost>
      <GiftWrapNote />
      <IsKitID />
      <KitID />
      <Locked>Y</Locked>
      <OnOrder_Qty>0</OnOrder_Qty>
      <OptionIDs />
      <Options />
      <OrderID>2119</OrderID>
      <ProductCode>test-product</ProductCode>
      <ProductID>39200</ProductID>
      <ProductName>Test Product 1</ProductName>
      <ProductNote />
      <ProductPrice>1.0000</ProductPrice>
      <ProductWeight>1</ProductWeight>
      <QtyOnBackOrder>0</QtyOnBackOrder>
      <QtyOnHold>1</QtyOnHold>
      <QtyShipped>0</QtyShipped>
      <Quantity>1</Quantity>
      <TaxableProduct>Y</TaxableProduct>
      <TotalPrice>1.0000</TotalPrice>
      <Vendor_Price>0.0000</Vendor_Price>
      <Warehouses />
    </OrderDetails>
    <OrderDetails>
      <OrderDetailID>3386</OrderDetailID>
      <AutoDropShip />
      <FreeShippingItem>Y</FreeShippingItem>
      <GiftTrakNumber>0</GiftTrakNumber>
      <GiftWrap />
      <GiftWrapCost>0.0000</GiftWrapCost>
      <GiftWrapNote />
      <Locked>Y</Locked>
      <OnOrder_Qty>0</OnOrder_Qty>
      <Options />
      <OrderID>2119</OrderID>
      <ProductCode>test-product</ProductCode>
      <ProductID>39200</ProductID>
      <ProductName>Test Product 2</ProductName>
      <ProductNote />
      <ProductPrice>1.0000</ProductPrice>
      <ProductWeight>1</ProductWeight>
      <QtyOnBackOrder>0</QtyOnBackOrder>
      <QtyOnHold>1</QtyOnHold>
      <QtyShipped>0</QtyShipped>
      <Quantity>1</Quantity>
      <TaxableProduct>Y</TaxableProduct>
      <TotalPrice>1.0000</TotalPrice>
    </OrderDetails>
  </Orders>
  <Orders>
    <OrderID>2141</OrderID>
    <AddressValidated>Y</AddressValidated>
    <Affiliate_Commissionable_Value>1.0000</Affiliate_Commissionable_Value>
    <AuthHash>14cca8be8db44ca9943f0a6cbf592c83</AuthHash>
    <AVS />
    <BillingAddress1>122 27th West2</BillingAddress1>
    <BillingAddress2 />
    <BillingCity>New York2</BillingCity>
    <BillingCompanyName />
    <BillingCountry>United States</BillingCountry>
    <BillingFaxNumber />
    <BillingFirstName>Dan2</BillingFirstName>
    <BillingLastName>Test2</BillingLastName>
    <BillingPhoneNumber>646346322</BillingPhoneNumber>
    <BillingPostalCode>10002</BillingPostalCode>
    <BillingState>NY</BillingState>
    <CardHoldersName />
    <CC_Last4 />
    <CreditCardAuthorizationDate>3/30/2012 3:33:00 PM</CreditCardAuthorizationDate>
    <CreditCardAuthorizationNumber>MANUAL</CreditCardAuthorizationNumber>
    <CreditCardTransactionID />
    <Customer_IPAddress>56.75.23.34</Customer_IPAddress>
    <CustomerID>19</CustomerID>
    <CVV2_Response />
    <GiftWrapNote />
    <IsAGift>N</IsAGift>
    <LastModBy>7</LastModBy>
    <LastModified>3/30/2012 3:33:00 PM</LastModified>
    <Locked>Y</Locked>
    <Order_Comments>Test sale #2, don't process, ignore status.</Order_Comments>
    <Order_Entry_System>PHONE</Order_Entry_System>
    <OrderDate>3/30/2012 3:32:00 PM</OrderDate>
    <OrderNotes />
    <OrderStatus>Ready to Ship</OrderStatus>
    <PaymentAmount>7.0700</PaymentAmount>
    <PaymentMethodID>17</PaymentMethodID>
    <PONum />
    <Processed_AutoEvents>Y</Processed_AutoEvents>
    <SalesRep_CustomerID>7</SalesRep_CustomerID>
    <SalesTax1>0.0800</SalesTax1>
    <SalesTax2>0.0000</SalesTax2>
    <SalesTax3>0.0000</SalesTax3>
    <SalesTaxRate>0</SalesTaxRate>
    <SalesTaxRate1>0.08375</SalesTaxRate1>
    <SalesTaxRate2>0</SalesTaxRate2>
    <SalesTaxRate3>0</SalesTaxRate3>
    <ShipAddress1>123 27th West2</ShipAddress1>
    <ShipAddress2 />
    <ShipCity>New York2</ShipCity>
    <ShipCompanyName />
    <ShipCountry>United States</ShipCountry>
    <ShipFaxNumber />
    <ShipFirstName>Dan2</ShipFirstName>
    <ShipLastName>Test2</ShipLastName>
    <ShipPhoneNumber>6461234789</ShipPhoneNumber>
    <Shipping_Locked>Y</Shipping_Locked>
    <ShippingMethodID>1</ShippingMethodID>
    <ShipPostalCode>10002</ShipPostalCode>
    <ShipResidential>Y</ShipResidential>
    <ShipState>NY</ShipState>
    <Stock_Priority>3</Stock_Priority>
    <Tax1_IgnoreNoTaxRules />
    <Tax1_Title>Tax (8.375%)</Tax1_Title>
    <Tax2_IgnoreNoTaxRules />
    <Tax2_IncludePrevious>0</Tax2_IncludePrevious>
    <Tax2_Title />
    <Tax3_IgnoreNoTaxRules />
    <Tax3_IncludePrevious>0</Tax3_IncludePrevious>
    <Tax3_Title />
    <Total_Payment_Authorized>0.0000</Total_Payment_Authorized>
    <Total_Payment_Received>7.0700</Total_Payment_Received>
    <TotalShippingCost>5.9900</TotalShippingCost>
    <VendorID>0</VendorID>
    <OrderDetails>
      <OrderDetailID>3404</OrderDetailID>
      <AutoDropShip>Y</AutoDropShip>
      <FreeShippingItem>Y</FreeShippingItem>
      <GiftTrakNumber>0</GiftTrakNumber>
      <GiftWrap />
      <GiftWrapCost>0.0000</GiftWrapCost>
      <GiftWrapNote />
      <IsKitID />
      <KitID />
      <Locked>Y</Locked>
      <OnOrder_Qty>0</OnOrder_Qty>
      <OptionIDs />
      <Options />
      <OrderID>2141</OrderID>
      <ProductCode>test-product</ProductCode>
      <ProductID>39200</ProductID>
      <ProductName>Test Product</ProductName>
      <ProductNote />
      <ProductPrice>1.0000</ProductPrice>
      <ProductWeight>1</ProductWeight>
      <QtyOnBackOrder>0</QtyOnBackOrder>
      <QtyOnHold>1</QtyOnHold>
      <QtyShipped>0</QtyShipped>
      <Quantity>1</Quantity>
      <TaxableProduct>Y</TaxableProduct>
      <TotalPrice>1.0000</TotalPrice>
      <Vendor_Price>0.0000</Vendor_Price>
      <Warehouses />
    </OrderDetails>
  </Orders>
</xmldata> 
```

如您所见，第一个订单包含两个`<OrderDetails>`，而第二个仅包含一个。

到目前为止，我已经创建了四个让我非常接近的函数。

```
processxml();
processxmldetails();
vl_readytoship_download();
csvimport(); 
```

第一个从其他服务器导入 .xml 文件，这样我们就可以开始工作了。

```
function vl_readytoship_download() {
echo "Downloading Ready To Ship Orders...<br>";
$ch = curl_init("http://www.link.to/vl_rts.xml");
$fh = fopen("vl_rts.xml", "w");
curl_setopt($ch, CURLOPT_FILE, $fh);
curl_exec($ch);
curl_close($ch);
} 
```

第二个函数将 XML 转换为 CSV，以便我们可以更好地读取它以进行导入（此步骤可能不是必需的或最好的方法，这就是我在这里的原因，但是它确实有效。）

```
function processxml() {
vl_readytoship_download();
echo "Processing Ready To Ship Orders...<br>";
$filexml='vl_rts.xml';
if (file_exists($filexml)) {
    $xml = simplexml_load_file($filexml);
$f = fopen('vl_rts.csv', 'w');
foreach ($xml->Orders as $Orders) {
    fputcsv($f, get_object_vars($Orders),',','"');
}
fclose($f);
}
} 
```

现在我一开始并没有注意到 CSV 不包含来自任何`<OrderDetails>`标签的数据。我只是在开始导入 MySQL 功能时才意识到这一点。

因此，我没有倒退，而是继续努力`<Order>`至少导入数据：

```
function csvimport() { 
if(!file_exists("vl_rts.csv")) { echo "WARNING! CSV Not Found!<br>"; exit; }
$row = 0;
$mycsvfile = array();
if (($handle = fopen("vl_rts.csv", "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        $num = count($data);
        $row++;
        for ($c=0; $c < $num; $c++) {
        }
        $mycsvfile[] = $data; //add the row to the main array.
    }
    fclose($handle);
}
echo "<br>Reading Rows:<br>";
//[row][column] so [1][$csvrow] = 2nd row, first column since 0=1
$csvrow = 0;
while ($mycsvfile[$csvrow][0] != $null) {
$query = mysql_query("SELECT * from vtiger_purchaseorder WHERE orderid=" . $mycsvfile[$csvrow][0]) or die(mysql_error());
if(mysql_num_rows($query)!=0)
{
//if row exists
$csvrow++;
echo "Row exists, changing rows...<br>";
echo "DO SOMETHING HERE, ANYTHING BUT THIS<br>"; //This is a "todo" spot for later
}
else //if row doesn't exist
{

$currentdate = date('Y-m-d');
$orderid = $mycsvfile[$csvrow][0];
$subject = "Uploading..."; //This is set to Uploading... now, in another function we'll come back change the subject to the name of the item sold.
$quoteid = $mycsvfile[$csvrow][0];
if ($mycsvfile[$csvrow][72] == 0) {
$vendorid = "1500"; //right now, new orders go into a temp vendor of 1500, then we'll change it based on the product ordered to see which vendor it should be assigned to.
echo "Vendor is " . $vendorid . "<br>";
$shipcity = "Shipcity"; This info is in <OrderDetails> which we don't have yet.

//This other database is vtiger, which has a lot of different area where it needs to store data, so here we insert it in a way vtiger can accept it.
$query1 = "SELECT * from vtiger_crmentity";
$query2 = "INSERT INTO vtiger_crmentity (smcreatorid,smownerid,modifiedby,setype,orderid) VALUES('1','1','1','PurchaseOrder','" . $orderid . "')";

$result1 = mysql_query($query1);
echo mysql_error() . "<br>";
$result2 = mysql_query($query2);
$crmid = mysql_insert_id();

$query3 = "SELECT * from vtiger_purchaseorder";
$query4 = "INSERT INTO vtiger_purchaseorder (purchaseorderid,subject,quoteid,vendorid,duedate,orderid) VALUES(" . $crmid . ",'" . $subject . "','" . $quoteid . "','" . $vendorid . "','" . $currentdate . "','" . $orderid . "')";

$query5 = "SELECT * from vtiger_poshipads";
$query6 = "INSERT INTO vtiger_poshipads (poshipaddressid,ship_city,orderid) VALUES(" . $crmid . ",'" . $shipcity . "','" . $orderid . "')";

echo mysql_error() . "<br>";
$result3 = mysql_query($query3);
echo mysql_error() . "<br>";
$result4 = mysql_query($query4);
echo mysql_error() . "<br>";
$result5 = mysql_query($query5);
echo mysql_error() . "<br>";
$result6 = mysql_query($query6);
echo mysql_error() . "<br>";
echo "CRMID " . $crmid . "<br>";

$csvrow++;
echo "Order doesn't exist, inserting order number " . $orderid . " from CSV row " . $csvrow . "<br>";
//CHANGE ORDER FROM READY TO SHIP TO PENDING SHIPMENT ON OTHER SITE (to do)

}
} 
}
echo "Import Complete.<br>";

} 
```

现在快速回顾一下。所以我们从另一台服务器中提取了 .XML 文件。我们已经把所有的东西（除了所有的孩子）`<Orders>`插入到一个 CSV 中，现在我们已经把 CSV 数据插入到 MySQL 数据库中以创建一个新的采购订单。

新的采购订单在那里，但`<OrderDetails>`标签中缺少数据。

我试图将所有`<OrderDetails>`数据放入一个数组中，但我只得到了第一个中的前两个标签`<Order>`。

理想情况下，我很想提取所有`<OrderDetails>`标签并将它们插入另一个 CSV 文件。从那里我将使用与上述相同的方法将其拉出并插入。我已经尝试过了，但是 CSV 已关闭，行没有对齐，我仍然只得到前 2 个标签，而不是全部。

我对任何事情都持开放态度，所以请告诉我...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:19:05.853

You should process the XML directly. You are losing the hierarchy of the data by trying to convert it to a CSV file.

You can use SimpleXML to read all the data. It will look like this:

```
$xml = new SimpleXMLElement($content);
foreach ($xml->Orders as $order) {
  $order_id = $order->OrderId;
  $order_status = $order->OrderStatus;

  // Here we have a single order
  // You can insert this order into the database

  foreach ($order->OrderDetails as $order_details) {
    $order_detail_id = $order_details->OrderDetailID;
    $product_id = $order_details->ProductID;

    // Here we have a single order detail that belongs to $order_id
    // You can insert this order detail into the database
  }
} 
```

# django - 默认选项的 Django 模型管理器

> ID：10076971
> 
> 赞同：0
> 
> 时间：2012-04-09T17:16:15.903
> 
> 标签：django, django-models

我有一个 Django 模型，它有一个可选的外键。我以这种方式设置它，以便表包含不同的默认选项，`service_types`但可以通过指定`controller`外键来覆盖此选项。

现在在我看来，我有一堆看起来像这样的代码：

```
try:
    modeService = RegressionServices.objects.get(controller=controller, service_type=SERVICE_TYPE_CONTROLLER_MODE)
except RegressionServices.DoesNotExist:
    modeService = RegressionServices.objects.get(service_type=SERVICE_TYPE_CONTROLLER_MODE) 
```

我想把它减少到一个电话，我认为 Django 模型`Manager`应该是这样做的方式。本质上，它会检查控制器`**kwargs`，如果存在，它基本上会执行上面的代码。我正在查看文档，只发现该`get_query_set`方法通常被覆盖。重写`get()`方法可以吗？我什至可以`RegressionServices`在模型管理器`get()`方法中访问模型吗？

除了模型经理之外，任何人都可以想到这样做的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T18:22:57.593

只需使用[`Q`objects](https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)进行逻辑 OR 即可。

# c# - 将exe部署到服务器

> ID：10076973
> 
> 赞同：0
> 
> 时间：2012-04-09T17:16:44.097
> 
> 标签：c#, sql-server-2008, ssis

我创建了一个控制台应用程序，我想在 SSIS 的计划包中使用它。在应用程序中，我连接到数据库以获取电子邮件地址并将电子邮件发送到该列表。当我将 .exe 放在服务器上时，它不起作用，但是当我把整个文件夹放在上面时，它工作正常。我假设它需要app.config。

将exe部署到服务器的最佳方法是什么？我应该先发布控制台应用程序，还是只构建它并获取 exe 和 app.config（不确定是否可能）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:20:25.887

如果您的 .exe 需要 app.config 或者将 app.config 复制过来，或者更改程序，以便依赖于 app.config 的任何内容...不需要...所以您*不需要*复制应用程序配置。第二个可能是也可能不是一个可行的选项，因为我们不知道您的程序中的哪些内容使用了 app.config。

对我来说似乎是一个相当简单的选择。你还期待听到什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T17:23:26.997

复制整个 Bin 文件夹是部署文件的完全有效方式（有时称为 x-copy 部署）。

Bin 文件夹中可能还有其他文件（即您在项目中标记为“副本”的引用程序集）。

您可以构建更正式的安装包，但对于简单的场景来说，它很可能会矫枉过正。

# java - 不能在另一个类的摆动组件中设置值

> ID：10076977
> 
> 赞同：3
> 
> 时间：2012-04-09T17:16:59.070
> 
> 标签：java, swing, oop

我的 UI 有这个类

```
public class MyFrame extends JFrame{
   JTextArea textArea;
  public MyFrame(){
   setSize(100,100);
   textArea = new JTextArea(50,50);
   Container content = getContentPane(); 
   content.add(textArea);
  }
 public static void main(String[] args){
          JFrame frame = new MyFrame();  
          frame.show();
          UpdateText u = new UpdateText();
          u.settext("Helloworld");
      }
} 
```

我还有另一个类将设置 的文本`textArea`，在其中我扩展了 MyFrame 以访问另一个类中的 textArea。

```
public class UpdateText extends MyFrame{
    public void settext(String msg){
     textArea.setText(msg);
    }
} 
```

然后我实例化 UpdateText 并调用函数 settext。但文本似乎没有出现在 GUI 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T18:05:26.207

首先，`setText()`除非您想要不同的行为，否则不要覆盖该方法。其次，你不必扩展任何东西。你所要做的就是按照这些简单的步骤，你会被设置！

1.  在`UpdateText`课堂上，将这些行放在其中的某个位置：

    ```
    MyFrame gui;

    public UpdateText(MyFrame in) {
        gui = in;
    } 
    ```

2.  在“MyFrame”类中，将此行放在开头：

    ```
    UpdateText ut = new UpdateText(this); 
    ```

现在，您可以通过在要更改的内容前面加上来引用`MyFrame`类中的所有内容。例如，假设您想更改 textarea 的文本。代码如下：`UpdateText``gui`

```
gui.textArea.setText("Works!"); 
```

快乐编码！:)

# java - 对 Java 多维数组进行排序

> ID：10076982
> 
> 赞同：3
> 
> 时间：2012-04-09T17:17:10.617
> 
> 标签：java, sorting, multidimensional-array, comparator

我正在尝试对数组的内容进行排序，虽然它似乎正在工作（没有运行时错误；正在执行排序任务），但前 10 行在排序时与其余行不按顺序排列。

**类 coordSort.java**

```
import java.io.*;
import java.util.Arrays;
import java.util.Scanner;

public class coordSort {
@SuppressWarnings({ "unchecked", "unused" })
public static void main (String args[]) throws IOException {

    String xCoord, yCoord;
    int coordSum;
    Scanner input = new Scanner(System.in);

    //Get x coordinate from user
    System.out.print("Enter x coordinate: ");
    xCoord = input.next();

    //Get x coordinate from user
    System.out.print("Enter y coordinate: ");
    yCoord = input.next();

    boolean sort = false;

    char[] a = xCoord.toCharArray();
    char[] b = yCoord.toCharArray();

    //validate user input is a digit 
    if ( (Character.isDigit(a[0]))  ) {     
        if(Character.isDigit(b[0]) ){
            //digits entered - begin processing all coordinate values
            sort = true;
        }
    }

    //If validation failed, inform user
    if(!sort){
        System.out.println("Please enter a positive numeric value.");
    }

    if(sort){       
        //determine SUM of user entered coordinates
        coordSum = Integer.parseInt(xCoord) + Integer.parseInt(yCoord);

        //define coordinate array
        String[][] coordUnsortedArray = new String[26][3];
        int counter;
        int commaCount;
        String xCoordIn, yCoordIn;
        int intXCoordIn, intYCoordIn, sumCoordIn, coordDiff;

        //define input file
        FileInputStream fileIn = new FileInputStream("coords.txt");
        BufferedReader reader = new BufferedReader(new InputStreamReader(fileIn)); 

        for (int j = 0; j < coordUnsortedArray.length; j++){
            counter = 0;
            commaCount = 0;
            //line from file to variable
            String coordSet = reader.readLine();     

            //look for the second "," to determine end of x coordinate
            for(int k = 0; k < coordSet.length(); k++){
                if (coordSet.charAt(k) == ',') {
                    commaCount++;
                    counter++;
                    if (commaCount == 2){
                        break;
                    }
                }else{
                    counter++;
                }
            }

            //define x coordinate
            xCoordIn = (coordSet.substring(2,(counter - 1)));
            intXCoordIn = Integer.parseInt(xCoordIn);

            //define y coordinate
            yCoordIn = (coordSet.substring((counter),coordSet.length()));
            intYCoordIn = Integer.parseInt(yCoordIn);

            //coordinate calculations
            sumCoordIn = Integer.parseInt(xCoordIn) + Integer.parseInt(yCoordIn);
            coordDiff = sumCoordIn - coordSum;

            //load results to array
            coordUnsortedArray[j][0] = xCoordIn;
            coordUnsortedArray[j][1] = yCoordIn;
            coordUnsortedArray[j][2] = Integer.toString(coordDiff);

            //Output Array (BEFORE SORTING)
            //System.out.println((j + 1) + ") " + coordUnsortedArray[j][0] + " : " + coordUnsortedArray[j][1] + " : " + coordUnsortedArray[j][2]);                  
        }             

        System.out.println("\n");

        fileIn.close();

        String[][] coordsSorted = new String[26][3];

        //Sort array coordDiff, column 3
        Arrays.sort(coordUnsortedArray, new ColumnComparator(2));

        //Print the sorted array
        for(int i = 0; i < coordUnsortedArray.length; i++){
            String[] row = coordUnsortedArray[i];
            System.out.print((i + 1) + ") ");
            for(int j = 0; j < row.length; j++) {
                //System.out.print(row[j] + " | ");
                coordsSorted[i][j] = row[j];
                System.out.print(coordsSorted[i][j] + " : ");
            }
            System.out.print("\n");
        }
    }
}
} 
```

**类 sortCoords.java --**

```
import java.util.Comparator;

@SuppressWarnings("rawtypes")
class ColumnComparator implements Comparator {
    int columnToSort;
    ColumnComparator(int columnToSort) {
        this.columnToSort = columnToSort;
    }
    //overriding compare method
    public int compare(Object o1, Object o2) {
        String[] row1 = (String[]) o1;
        String[] row2 = (String[]) o2;
        //compare the columns to sort
        return row1[columnToSort].compareTo(row2[columnToSort]);
    }

    //overriding compare method
    public int compare1(Object o1, Object o2) {
        String[] row1 = (String[]) o1;
        String[] row2 = (String[]) o2;
        //compare the columns to sort
        return row1[columnToSort].compareTo(row2[columnToSort]);
    }
} 
```

我正在尝试按第三列按数字顺序对数组进行排序。未排序的数组由包含以下内容的文本文件填充：

一,44,67

b,31,49

c,93,6

与用户输入相比，我正在对数组执行计算并按如下方式填充数组：

44,67,101

31,49,70

93,6,89

我希望 sortedArray 输出以下内容：

31,49,70

93,6,89

44,67,101

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T17:29:31.080

这里有一种可能的混淆：

```
 return row1[columnToSort].compareTo(row2[columnToSort]) 
```

这是字符串比较，而不是数字比较。如果您根据字符串排序，您将获得与按数字排序不同的结果 - 即“1”、“10”、“100”、“9”与 1,9,10,100

查看[Integer.parseInt](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Integer.html)如果您无法弄清楚其余部分，请随时提出更多问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T17:55:34.607

正如 spin_plate 所说。您需要比较它们的 int 值，即您需要在那里进行转换

```
 int num1 = Integer.parseInt(row1[columnToSort]);
    int num2 = Integer.parseInt(row2[columnToSort]);
    if(num1 > num2)
            return 1;
    else 
            return 0; 
```

将此代码放在 compareTo 方法中并检查。交换返回语句以反向排序。

此外，在方法中添加一些错误检查`compareTo`将使代码更有效率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T04:17:18.010

好的，所以在此处提供帮助之后，以下是我们找到的解决方案。再次感谢大家的帮助！希望下面的代码可以帮助其他人。

类 1 的代码——

```
import java.io.*;
import java.util.Arrays;
import java.util.Scanner;

public class coordSort {
    @SuppressWarnings({ "unchecked" })
    public static void main (String args[]) throws IOException {

        String xCoordChar, yCoordChar;
        int xCoord, yCoord, coordSum;
        Scanner input = new Scanner(System.in);

        //Get x coordinate from user
        System.out.print("Enter x coordinate: ");
        xCoordChar = input.next();

        //Get x coordinate from user
        System.out.print("Enter y coordinate: ");
        yCoordChar = input.next();

        boolean sort = false;

        char[] a = xCoordChar.toCharArray();
        char[] b = yCoordChar.toCharArray();

        //validate user input is a digit 
        if ( (Character.isDigit(a[0]))  ) {     
            if(Character.isDigit(b[0]) ){
                //digits entered - begin processing all coordinate values
                sort = true;
            }
        }

        //If validation failed, inform user
        if(!sort){
            System.out.println("Please enter a positive numeric value.");
        }

        if(sort){       
            //Parse user input characters to Integers
            xCoord = Integer.parseInt(xCoordChar);
            yCoord = Integer.parseInt(yCoordChar);

            //determine SUM of user entered coordinates
            coordSum = xCoord + yCoord;

            //define coordinate array
            int[][] coordUnsortedArray = new int[26][3];
            int counter;
            int commaCount;
            String xCoordIn, yCoordIn;
            int intXCoordIn, intYCoordIn, sumCoordIn, coordDiff;

            //define input file
            FileInputStream fileIn = new FileInputStream("coords.txt");
            BufferedReader reader = new BufferedReader(new InputStreamReader    (fileIn)); 

            for (int j = 0; j < coordUnsortedArray.length; j++){
                counter = 0;
                commaCount = 0;
                //line from file to variable
                String coordSet = reader.readLine();     

                //look for the second "," to determine end of x coordinate
                for(int k = 0; k < coordSet.length(); k++){
                    if (coordSet.charAt(k) == ',') {
                        commaCount++;
                        counter++;
                        if (commaCount == 2){
                            break;
                        }
                    }else{
                        counter++;
                    }
                }

                //define x coordinate
                xCoordIn = (coordSet.substring(2,(counter - 1)));
                intXCoordIn = Integer.parseInt(xCoordIn);

                //define y coordinate
                yCoordIn = (coordSet.substring((counter),coordSet.length()));
                intYCoordIn = Integer.parseInt(yCoordIn);

                //coordinate calculations
                sumCoordIn = Integer.parseInt(xCoordIn) + Integer.parseInt    (yCoordIn);
                coordDiff = sumCoordIn - coordSum;

                if (coordDiff < 0){
                    coordDiff = coordDiff * (-1);
                }

                //load results to array
                coordUnsortedArray[j][0] = intXCoordIn;
                coordUnsortedArray[j][1] = intYCoordIn;
                coordUnsortedArray[j][2] = coordDiff;                           
            }             

            fileIn.close();
            System.out.print("\n");
            System.out.println("Array Before Sorting:");
            System.out.println("=====================");

            //Array Before Sorting
            for(int i = 0; i < coordUnsortedArray.length; i++){
                int[] row = coordUnsortedArray[i];
                System.out.print((i + 1) + ") ");
                for(int j = 0; j < (row.length - 1); j++) {
                    coordUnsortedArray[i][j] = row[j];
                    if(j < 1){
                        System.out.print(coordUnsortedArray    [i]    [j] + ",");   
                    }else{
                        System.out.println(coordUnsortedArray    [i]    [j]);
                    }
                }
            }

            System.out.print("\n");
            System.out.print("\n");

            //Sort array coordDiff, column 3
            Arrays.sort(coordUnsortedArray, new ColumnComparator(2));

            System.out.println("Array After Sorting:");
            System.out.println("====================");

            //Original Array After Sorting
            for(int i = 0; i < coordUnsortedArray.length; i++){
                int[] row = coordUnsortedArray[i];
                System.out.print((i + 1) + ") ");
                for(int j = 0; j < (row.length - 1); j++) {
                    coordUnsortedArray[i][j] = row[j];
                    if(j < 1){
                        System.out.print(coordUnsortedArray[i][j] + ",");   
                    }else{
                        System.out.println(coordUnsortedArray    [i]    [j]);
                    }
                }
            }
            }
        }
} 
```

类 2 的代码——

```
import java.util.Comparator;

@SuppressWarnings("rawtypes")
class ColumnComparator implements Comparator {
int columnToSort;
ColumnComparator(int columnToSort) {
this.columnToSort = columnToSort;
}

//Compare method
public int compare(Object o1, Object o2) {
    int[] row1 = (int[]) o1;
    int[] row2 = (int[]) o2;

    int intRow1 = (row1[columnToSort]);
    int intRow2 = (row2[columnToSort]);

    return new Integer(intRow1).compareTo(new Integer(intRow2));
}
} 
```

# facebook - 要求用户使用 Facebook 登录网站的利弊

> ID：10076984
> 
> 赞同：-1
> 
> 时间：2012-04-09T17:17:14.687
> 
> 标签：facebook, facebook-graph-api

当 Spotify（下面的链接）要求用户使用他们的 FB 帐户登录时（可能只是因为他们是付费客户？），用户似乎对此表示强烈反对。用户通常对此感到反感吗？你有什么经验吗？

[http://www.pcworld.com/article/240646/spotify_adds_facebook_requirement_angering_users.html](http://www.pcworld.com/article/240646/spotify_adds_facebook_requirement_angering_users.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T17:24:45.913

这取决于网站。人们并不特别信任 facebook，尽管他们使用它的方式都是一样的。

# javascript - 带有图像的两列文本块

> ID：10076988
> 
> 赞同：0
> 
> 时间：2012-04-09T17:17:22.693
> 
> 标签：javascript, html, css, web, markup

我需要一些帮助...我应该如何使用两个图像和一个文本块标记布局，该文本块分为 2 列不同宽度，其中由于其中一个图像，第二列开始低于第一列？这是我的布局草图：

[![](../Images/5a771df45e2ccfcb2963447e1d9e4c57.png)](https://i.imgur.com/jlevb.png "链接到布局草图。")

我希望我足够明确地描述了我的问题。

PS：真的可以吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T18:15:07.293

CSS3 有一个解决方案，但它还不是标准的，并且在旧版浏览器中不起作用这里是一个链接[http://www.css3.info/preview/multi-column-layout/](http://www.css3.info/preview/multi-column-layout/)。

可能最好的主意是以某种方式使用 javascript。将所有文本放在第一列并测试高度，然后将部分文本移动到下一列，直到您有相等的列或直到第一列处于所需的高度。

另一种方法是具有预定义的比例，例如（第一列中的 2/3 和第二列中的 1/3）。然后使用字符数根据比例拆分文本。这并不准确，您可以使用类似于上述方法的方法根据溢出属性找到确切的宽度，但字符应该平均为正确的长度。

这种方法非常简单，看起来像

```
var txt='Column text...';
var len=txt.length;
var chars=Math.floor(len*.67);
//Assuming you want 2/3 of the text in the first column
document.getElementById('col1').innerHTML=txt.substring(0,chars);
document.getElementById('col2').innerHTML=txt.substring(chars);
//Notice that this could split in the middle of a word so you would need to do
//some checking for the nearest space and the change the break to there.
//Also you could then use the previous method to adjust it if you want something really accurate 
```

# iphone - 创建记分牌的最佳方法

> ID：10076994
> 
> 赞同：0
> 
> 时间：2012-04-09T17:18:00.887
> 
> 标签：iphone, objective-c, ipad, plist

我想知道创建记分牌的最佳方法是什么。该应用程序是一个拼图游戏，完成后会停止正在运行的秒表。记分牌将只包含一个名称和一个时间。时间为`NSString`格式，`m.ss`.

我正在考虑创建一个 plist 并将名称和时间发送到这个 plist。然后我会按时间升序对 plist 进行排序。然后我会将前 5 或 10 个对象打印到记分牌上。这可能吗？这听起来像是解决这个问题的最佳方法吗？

如果此问题格式不适合 stackoverflow，请提前道歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:29:14.920

这在 Core Data 中会容易得多。每次拉出所有 plist 数据然后对其进行排序似乎很痛苦，只是为了显示前 5 或 10 个对象。一段时间后，当有一堆结果时，性能可能会变慢。我想您可以在每次保存 plist 时对其进行排序，但 Core Data 更好......

使用核心数据，您可以轻松地`NSPredicate`使用`NSSortDescriptor`. 如果您不熟悉，请阅读有关 Core Data 的教程。这并不难，您只需要了解所有组件如何交互即可。编码本身非常简单。

# php - 使用 phpize 安装 xdebug 时出错

> ID：10076995
> 
> 赞同：2
> 
> 时间：2012-04-09T17:18:01.207
> 
> 标签：php, xdebug

我正在尝试安装 xdebug，所以我使用了网站上的自定义安装选项，当涉及到“phpize”时，我得到了错误：

找不到 config.m4。确保在模块的顶级源目录中运行“/usr/bin/phpize”

即使我使用 phpize 的完整路径，我也会得到同样的错误。

我正在使用 OS X Lion

谢谢

里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T12:13:16.523

我也遇到了这个错误。您应该做的是在 xdebug 2.2.1 目录内的 xdebug 2.2.1 目录中运行它。第二个目录有很多文件，当您更改到该目录时运行命令是有意义的。这让我越过了那一步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T18:06:20.497

在这里修复了类似的问题：http: [//kmaiti.blogspot.co.uk/2010/08/cannot-find-configm4-phpize-resolved.html](http://kmaiti.blogspot.co.uk/2010/08/cannot-find-configm4-phpize-resolved.html) 这里也有一个类似的 PHP Bug 页面：[https://bugs。 php.net/bug.php?id=58650](https://bugs.php.net/bug.php?id=58650)

命令运行的位置似乎有问题，请尝试在 xdebug 的实际源目录中运行它。