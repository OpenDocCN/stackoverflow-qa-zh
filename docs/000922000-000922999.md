# StackOverflow 问答 000922000-000922999

# c# - 使用 Moq 在函数内模拟与数据源的连接？

> ID：922013
> 
> 赞同：2
> 
> 时间：2009-05-28T16:58:15.443
> 
> 标签：c#, unit-testing, moq

我开始使用 Moq，但我无法弄清楚如何在下面的代码中测试**Execute方法：**

我有以下课程：

```
public class MyObject {
    private IDataReaderPlugin m_source;
    private IDataWriterPlugin m_dest;
    private string[] m_dummyTags = new string[] { "tag1", "tag2", "tag3"};

    public void Execute(DateTime time)
    {
        DataCollection tags = m_source.SnapshotUtc(m_dummyTags, time);

        //Doing some treatment on the values in tags    

        m_dest.Write(tags); 
    } 
```

}

另一种方法负责根据配置文件中的信息创建和初始化 IDataReaderPlugin 和 IDataWriterPlugin。

我想测试 Execute 方法。所以，我需要模拟**m_source**和**m_dest**，然后我想测试发送到**m_dest**的结果。

我如何通过 Moq 实现这一目标？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T17:23:04.987

```
[Test]
public void ShouldWriteToMDest()
{
   // Arrange
   var mockDest = new Mock<IDataWriterPlugin>();
   var mockSource = new Mock<IDataReaderPlugin>();
   string[] m_dummyTags = new string[] { "tag1", "tag2", "tag3"};

   mockSource.Setup(source => source.SnapshotUtc(m_dummyTags, It.IsAny<DateTime>()).Returns(/*whatever you need*/);

   var myObj = new MyObject(mockSource.Object, mockDest.Object);

   // Act
   myObj.Execute(DateTime.Now);

   // Assert
   Assert.That(mockSource.Object.WhateverPropertyContainsOutput == /*Whatever you need */);

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T17:21:09.233

*“另一种方法是负责任的”* - 这是关键的信息。如果您使用的是 IoC 或 DI 框架，那么您需要插入一些接口的 Moq 模拟`IDataReaderPlugin`和`IDataWriterPlugin`. 然后该`Execute`方法将使用 IoC/DI 框架提供的这些模拟。

如果它们只是由设置器或属性设置，那么它很简单：

```
// Arrange
var mo = new MyObject();
var srcMock = new Mock<IDataReaderPlugin>();
src.Setup(src => src.SnapshotUtc(It.IsAny<string[]>(), It.IsAny<DateTime>()))
   .Returns(new DataCollection() /* or whatever */);
mo.SetSource(srcMock.Object);
// ... same for m_dest
// Act
mo.Execute(DateTime.Now);
// Assert
// assert something... srcMock.Verify() or whatever 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T17:23:04.113

这应该让你开始：

```
DateTime myDate = DateTime.Now;

DataCollection tags = new DataCollection();

Mock<IDataReaderPlugin> dataReaderPlugin = new Mock<IDataWriterPlugin>();
dataReaderPlugin.Setup(drp => drp.SnapshotUtc(It.IsAny<string[]>(), myDate)).Returns(tags);

Mock<IDataWriterPlugin> dataWriterPlugin = new Mock<IDataWriterPlugin>();
dataWriterPlugin.Setup(dwp => dwp.Write(tags);    

MyObject mo = new MyObject();
mo.Execute();

mock.Verify(foo => foo.Write(tags)); 
```

# php - 如何在装饰器中修改 Zend_Form_Element 的属性

> ID：922017
> 
> 赞同：0
> 
> 时间：2009-05-28T16:58:46.363
> 
> 标签：php, zend-framework

是否可以在之前添加的装饰器中更改 Zend_Form_Element 的 html 属性？

假设我有一个名为 RichTextArea 的装饰器。当我将它添加到 Zend_Form_Element_Textarea 时，我希望装饰器将“丰富”类添加到 textarea。

最终输出应如下所示：

`<textarea name="content" id="content" class="rich" />`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T17:44:43.430

这是可能的，但语法在一定程度上取决于您构建表单的方式。最简单的方法是在添加元素时对元素本身执行此操作：

```
$element = new Zend_Form_Element_Text('something');
$element->class = 'rich';
$form->addElement($element); 
```

或者如果您批量分配了装饰器，例如：

```
$element = new Zend_Form_Element_Text('something');
$element->setDecorators(array(
   'Errors',
   'Label',
   array(array('row' => 'HtmlTag'), array('tag' => 'div'))
));

[...]

$decorator = $element->getDecorator('row');
$decorator->setOption('class', 'rich'); 
```

如果您使用的是 TinyMCE 或类似的富文本编辑器，另一种选择可能是创建一个扩展 Zend_Form_Element_Textarea 的自定义表单元素，并始终将您的类添加到其中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T08:01:09.633

可以添加任何 HTML 属性

```
// @var Zend_Form_Element $element
$element->setAttribute($key, $value); 
```

但是您也可以将属性作为属性访问，例如

```
$element->key = $value; 
```

有关更多信息，请阅读 Zend 文档中的本节：http: [//framework.zend.com/manual/1.12/en/zend.form.elements.html#zend.form.elements.metadata](http://framework.zend.com/manual/1.12/en/zend.form.elements.html#zend.form.elements.metadata)

# .net - 隐藏由 ColorPickerExtender 定位的文本框

> ID：922026
> 
> 赞同：1
> 
> 时间：2009-05-28T17:00:22.257
> 
> 标签：.net, asp.net, asp.net-ajax, ajaxcontroltoolkit

有没有办法在最新版本的 ajax 控件工具包中隐藏 colorpickerextender 所针对的文本框？

如果你添加

```
样式=“显示：无”
```

到文本框，然后颜色选择器显示在浏览器窗口的左上角。我希望它显示在扩展程序 popupbuttonid 中引用的按钮附近。

我想隐藏文本框，因为我不希望用户看到颜色代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:43:53.777

虽然我没有隐藏它，但我确实找到了另一种方法来获得我想要的东西。选择颜色后，我调用一个 javascript 函数，该函数从文本框中获取颜色代码并将其存储在隐藏字段中，然后清除文本框的文本，最后将文本框的背景颜色设置为所选颜色。

这是aspx代码：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="color.aspx.cs" Inherits="color" %>

<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="cc1" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title></title>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>

<script type="text/javascript">
    function ColorSelectionChanged() {
        var txtColorPickerSelector = '#' + txtColorPickerID;
        var ColorCodeSelector = '#' + ColorCodeID;
        var colorCode = '#' + $(txtColorPickerSelector).val();
        $(txtColorPickerSelector).val('').css('background-color', colorCode);
        $(ColorCodeSelector).val(colorCode);
    }        
</script>

</head>
<body>
<form id="form1" runat="server">

<asp:HiddenField ID="ColorCode" runat="server" />

<asp:ScriptManager ID="ScriptManager1" runat="server" />

<asp:TextBox ID="txtColorPicker" runat="server" Width="2em"></asp:TextBox>

<cc1:ColorPickerExtender ID="txtColor_ColorPickerExtender" runat="server" 
    TargetControlID="txtColorPicker"
    OnClientColorSelectionChanged="ColorSelectionChanged" />

&nbsp;<asp:Button ID="btnSubmit" runat="server" OnClick="btnSubmit_Click" Text="Submit" />

<asp:Label ID="lblColorCode" runat="server"></asp:Label>
</form>
</body>
</html>

<script type="text/javascript">
    var txtColorPickerID = '<%=txtColorPicker.ClientID %>';
    var ColorCodeID = '<%=ColorCode.ClientID %>';    
</script> 
```

以及背后的代码：

```
using System;
using System.Drawing;

public partial class color : System.Web.UI.Page
{
    protected void btnSubmit_Click(object sender, EventArgs e)
    {
        lblColorCode.Text = ColorCode.Value;
        txtColorPicker.BackColor = ColorTranslator.FromHtml(ColorCode.Value);
    }
} 
```

我只是将代码分配给标签以证明正在提交颜色代码。对不起 aspx 格式。在 Chrome、IE 6、IE 7、Firefox 3、Opera 9 和 Safari 4 中测试和工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-14T01:33:36.547

前面的代码有点乱。我把它改了一点，让它更清楚。

```
function ColorSelectionChanged() {
   $get('<%=ColorCode.ClientID %>').value = '#' + $get('<%=txtColorPicker.ClientID %>').value
   $get('<%=txtColorPicker.ClientID %>').value=''
   $get('<%=txtMessage.ClientID %>').style.color = $get('<%=ColorCode.ClientID %>').value
} 
```

和html部分

```
<asp:ImageButton ID="ImageColor" runat="server" ImageUrl="~/_Images/cp_button.png" />
                       <asp:TextBox ID="txtColorPicker" runat="server" width="0" style="border:0;" />
                       <asp:HiddenField ID="ColorCode" runat="server" />
                       <ajaxToolkit:ColorPickerExtender 
                            ID="ColorPickerExtender1"
                            PopupButtonID="ImageColor"
                            TargetControlID="txtColorPicker"
                            PopupPosition="Right"
                            OnClientColorSelectionChanged="ColorSelectionChanged"
                            runat="server"
                            /> 
```

其中 txtMessage 是他们要写的文本框（想象一个聊天文本框）。如果不需要，可以评论该行

形成**后面的代码，**只需使用**ColorCode.value**来检索所选的颜色代码。

# asp.net - 从孩子填写父母版页

> ID：922033
> 
> 赞同：4
> 
> 时间：2009-05-28T17:02:32.033
> 
> 标签：asp.net, master-pages

我想要一个使用子母版页的页面，填写父级的内容占位符，但我无法让它工作。每当我尝试时，我都会收到错误“无法在母版页 '/templates/info.master' 中找到 ContentPlaceHolder 'customHead'，请在内容页面中验证内容控件的 ContentPlaceHolderID 属性。”

我有一个这样定义的母版页（/templates/main.master）：

```
&lt;%@ Master Language="C#" %>
<head runat="server">
    <title>foo</title>
    <asp:contentplaceholder runat="server" id="customHead" />
</head>
<body>
    <div id="content">
        <asp:contentplaceholder runat="server" id="masterContent" />
    </div> 
```

然后我有一个这样定义的子母版（/templates/info.master）：

```
<%@ Master Language="C#" MasterPageFile="/templates/main.master" %>
<asp:content id="homeContent" contentPlaceHolderId="masterContent" Runat="server">
<div id="info-container">
    <div id="info-content">
        <asp:contentplaceholder runat="server" id="infoContent"/>
    </div>
</div>
</asp:content> 
```

最后我的页面定义如下：

```
&lt;%@ Page Language="C#" MasterPageFile="/templates/info.master" %>
<asp:Content ID="head" ContentPlaceHolderID="customHead" runat="server">
    <!-- Custom header area -->
    <link rel="stylesheet" type="text/css" href="foo.css"/>
</asp:Content>
<asp:Content ID="content" ContentPlaceHolderID="childContent" runat="server">
    This is my child content
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T17:28:04.667

您没有在子母版页中定义“customeHead”。如果要公开根母版页内容区域，则需要在子母版页中公开它。

```
<%@ Master Language="C#" MasterPageFile="/templates/main.master" %>
<asp:contentplaceholder runat="server" id="customHead" />
<asp:content id="homeContent" contentPlaceHolderId="masterContent" Runat="server">
    <div id="info-container">
        <div id="info-content">
            <asp:contentplaceholder runat="server" id="infoContent"/>       
        </div>
    </div>
</asp:content> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:06:35.223

你设置它使用`this.Page.Master`？

# c# - 哪个 ORM 会给我经过编译测试的查询？

> ID：922036
> 
> 赞同：4
> 
> 时间：2009-05-28T17:02:42.203
> 
> 标签：c#, .net, orm

哪个 ORM 会给我经过编译测试的查询？

linqtosql 编译时间是否经过测试？

* * *

### 编辑：

假设我编写了一个引用名为“TotalSales”的列的查询。然后，我将数据库中的列重命名为`TotalSales2`（以及任何其他配置文件，例如：nHibernate 中的 Employee.cfg.xml）。
当我编译项目时，我希望 Visual Studio 告诉我“totalSales”列不存在，然后我会去更改它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T17:11:28.490

据我所知，没有。例如，它们通常会让您创建无法转换为 SQL 的 LINQ 查询。另外，我不知道有任何编译时间检查您的映射是否正确映射到您的数据库。

在我看来，您可以并且应该在测试中执行所有这些检查。大多数 ORM 使这很容易做到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T17:20:16.133

我使用[LLBLGen](http://www.llblgen.com)，但在进行数据模型更改时必须“刷新”它。我不认为你会得到一个在编译时检查数据库修改的 ORM。你在那里要求很多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T17:30:20.993

在 DataObjects.Net 中，由 [Field] 属性标记的属性始终绑定到数据库中的字段，因此您可以确定查询将被翻译。如果您使用非持久字段或其他不受支持的语句，查询翻译器将在运行时失败或对获取的对象（在客户端）执行此类操作。

通常编译时验证是不可能的，或者理论上可以通过特殊的构建后任务执行，这将扫描编译的代码，查找所有查询并验证它们。但是这样的检查会严重减慢编译过程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-15T15:00:21.910

也许不完全是您要查找的内容，但是如果使用**实体框架**并从设计器中选择“从数据库更新模型”，您将收到消息说如果您更改名称，字段将不再被映射。

当您构建项目时，这不会自动发生。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-21T17:22:33.170

基本上，您需要两个功能：

*   编译时检查查询（= 具有 LINQ 实现的 ORM）。这通常不是问题——至少有一些工具支持这一点。
*   基于数据库模式更新实体的预构建步骤。AFAIK 很少以这种方式实现 - 通常您必须通过模式显式更新模型。请注意，这部分通常相当昂贵。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T17:28:46.020

如果您将代码生成步骤作为预构建事件包括在内，SubSonic 可以做到这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T17:46:40.230

我使用了一个名为 DODS 的 Java 工具，它是在 ca 开发的。2000 带有 Enhydra 应用程序服务器。DODS 还在这里： [http ://www.enhydra.org/tech/dods/](http://www.enhydra.org/tech/dods/)

DODS 的工作方式以及满足您的编译时验证目标的方式是它是一个代码生成工具。它生成与数据库中的表相对应的 Java 类。这些类的对象实例对表中的每一列都有 getter 和 setter。当然，如果您更改数据库结构，您必须使用 DODS 重新生成 Java 代码。

只要您使生成的代码与数据库的结构保持同步，它就会提供编译时验证，即任何使用这些类的应用程序代码都在查询有效的表和列。

无论如何，我意识到你用 C# 和 ASP.NET 标记了你的问题。生成 Java 代码的工具不会对您有那么大的帮助。但是可能还有另一种更专门用于 .NET 的工具，它的工作原理与生成映射到数据库结构的代码的原理相同。因此，我建议将您的[搜索](http://en.wikipedia.org/wiki/List_of_object-relational_mapping_software#.NET)范围缩小到说明代码生成的 .NET ORM 工具。

# linq - 使用 LINQ 自动删除子记录

> ID：922039
> 
> 赞同：1
> 
> 时间：2009-05-28T17:02:54.840
> 
> 标签：linq, linq-to-sql

我对 LINQ 有点陌生，并且有一个关于删除的快速问题。

比如说，我有 2 个表，Orders 和 OrderItems。使用 LINQ，我可以通过使用轻松地创建新的子记录

```
order.Items.Add(new OrderItem()); 
```

这将在数​​据库中创建子记录并将其外键更新为 orderId。这个很棒，我喜欢！但是，当我想删除子记录时

```
order.Items.Remove(orderItem); 
```

汇总更改时出现错误（因为它实际上并未删除子行（订单项），只是删除了外键 ID）。是否可以按照我想要的方式做到这一点？我不想创建一大堆存储库，也不想创建梯子来删除大型数据库的所有子行。

提前致谢。

乙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:08:45.827

您可以通过配置外键关系在删除父键时删除子记录来在数据库本身中实现这一点。

请注意，这对 Linq2SQL 是透明的，它不会意识到这一点，因此最好确保在此之后不要保留数据上下文，因为 OrderItem 对象仍然存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T17:16:13.440

为有问题的表设置 ON DELETE CASCADE，这将让 SQL Server 为您处理这个问题。

# c# - 商店字典 在应用程序设置中

> ID：922047
> 
> 赞同：37
> 
> 时间：2009-05-28T17:03:38.427
> 
> 标签：c#, .net-3.5, dictionary, settings

我有一个字符串字典，我希望用户能够从中添加/删除信息，然后为他们存储它，以便他们可以在下次程序重新启动时访问它

我不清楚如何将字典存储为设置。我看到在 system.collections.special 下有一个叫做 stringdictionary 的东西，但我读到 SD 已经过时并且不应该使用。

同样在将来我可能需要存储一个不仅仅是字符串的字典（int string）

您将如何将字典存储在 .net 应用程序的设置文件中？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2011-05-31T23:50:24.940

您可以使用从 StringDictionary 派生的此类。为了对应用程序设置有用，它实现了 IXmlSerializable。或者您可以使用类似的方法来实现您自己的 XmlSerializable 类。

```
public class SerializableStringDictionary : System.Collections.Specialized.StringDictionary, System.Xml.Serialization.IXmlSerializable
{
    public System.Xml.Schema.XmlSchema GetSchema()
    {
        return null;
    }

    public void ReadXml(System.Xml.XmlReader reader)
    {
        while (reader.Read() &&
            !(reader.NodeType == System.Xml.XmlNodeType.EndElement && reader.LocalName == this.GetType().Name))
        {
            var name = reader["Name"];
            if (name == null)
                throw new FormatException();

            var value = reader["Value"];
            this[name] = value;
        }
    }

    public void WriteXml(System.Xml.XmlWriter writer)
    {
        foreach (System.Collections.DictionaryEntry entry in this)
        {
            writer.WriteStartElement("Pair");
            writer.WriteAttributeString("Name", (string)entry.Key);
            writer.WriteAttributeString("Value", (string)entry.Value);
            writer.WriteEndElement();
        }
    }
} 
```

生成的 XML 片段将类似于：

```
...
<setting name="PluginSettings" serializeAs="Xml">
    <value>
        <SerializableStringDictionary>
            <Pair Name="property1" Value="True" />
            <Pair Name="property2" Value="05/01/2011 0:00:00" />
        </SerializableStringDictionary>
    </value>
</setting>
... 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-28T17:08:34.893

最简单的答案是使用行和列分隔符将您的字典转换为单个字符串。然后你只需要在设置文件中存储 1 个字符串。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-09T20:11:21.827

如果您不需要使用设置设计器或使用文本编辑器编辑设置，您可以创建一个派生自***ApplicationSettingsBase***的简单类：

```
namespace MyNamespace
{
    using System.Collections.Generic;
    using System.Configuration;

    /// <summary>
    /// Persistent store for my parameters.
    /// </summary>
    public class MySettings : ApplicationSettingsBase
    {
        /// <summary>
        /// The instance lock.
        /// </summary>
        private static readonly object InstanceLock = new object();

        /// <summary>
        /// The instance.
        /// </summary>
        private static MySettings instance;

        /// <summary>
        /// Prevents a default instance of the <see cref="MySettings"/> class 
        /// from being created.
        /// </summary>
        private MySettings()
        {
            // don't need to do anything
        }

        /// <summary>
        /// Gets the singleton.
        /// </summary>
        public static MySettings Instance
        {
            get
            {
                lock (InstanceLock)
                {
                    if (instance == null)
                    {
                        instance = new MySettings();
                    }
                }

                return instance;
            }
        }

        /// <summary>
        /// Gets or sets the parameters.
        /// </summary>
        [UserScopedSetting]
        [SettingsSerializeAs(SettingsSerializeAs.Binary)]
        public Dictionary<string, string> Parameters
        {
            get
            {
                return (Dictionary<string, string>)this["Parameters"];
            }

            set
            {
                this["Parameters"] = value;
            }
        }
    }
} 
```

真正的技巧是**[SettingsSerializeAs(SettingsSerializeAs.Binary)]**属性。大多数（全部？）类都可以通过这种方式序列化，而*SettingsSerializeAs.String*或*SettingsSerializeAs.Xml*不适用于字典。

像正常设置一样在代码中使用它：

```
// this code untested...
MySettings.Instance.Parameters["foo"] = "bar";
MySettings.Instance.Parameters.Save();
MySettings.Instance.Parameters.Reload();
string bar;
if (!MySettings.Instance.Parameters.TryGetValue("foo", out bar))
{
    throw new Exception("Foobar");
} 
```

如果您希望 Dictionary 序列化为用户可编辑的内容，则必须从 Dictionary 派生并使用 TypeConverter（请参阅[Using Custom Classes with Application Settings](http://www.blackwasp.co.uk/CustomAppSettings.aspx)）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T17:12:25.743

除了做[大卫建议的](https://stackoverflow.com/questions/922047/store-dictionarystring-string-in-application-settings/922070#922070)事情之外，我会研究字典的替代存储。最终，设置对象序列化到磁盘。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-28T17:28:54.727

您是否考虑过使用 XML 来存储您的字典？如果将来您决定希望能够存储其他类型的字典，这将提供一定程度的可扩展性。您可能会执行以下操作：

```
<dictionary>
   <entry key="myKey">
      [whatever data you like]
   </entry>
</dictionary> 
```

可能有点矫枉过正，但如果您想要存储更复杂的数据（例如自定义对象），您也应该做好准备。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-03T13:02:30.573

您还可以通过将键放在偶数索引上并将值放在奇数索引上来使用 System.Collections.Specialized.StringCollection。

```
/// <summary>
/// Emulate a Dictionary (Serialization pb)
/// </summary>
private static string getValue(System.Collections.Specialized.StringCollection list, string key)
{
    for (int i = 0; i * 2 < list.Count; i++)
    {
        if (list[i] == key)
        {
            return list[i + 1];
        }
    }
    return null;
}

/// <summary>
/// Emulate a Dictionary (Serialization pb)
/// </summary>      
private static void setValue(System.Collections.Specialized.StringCollection list, string key, string value)
{
    for (int i = 0; i * 2 < list.Count; i++)
    {
        if (list[i] == key)
        {
            list[i + 1] = value;
            return;
        }
    }
    list.Add(key);
    list.Add(value);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T17:12:45.400

您可以创建一个自定义类，将 Dictionary 公开为公共属性。然后，您可以将此自定义类型指定为您的设置的类型。

编辑：

我刚刚读到，由于某种原因，通用字典不能被 XML 序列化，所以我的解决方案可能不起作用（虽然我还没有测试过......）。这很奇怪，因为通用列表可以毫无问题地被序列化。

您仍然可以创建一个可以设置为用户设置的自定义类，但您需要将列表作为属性而不是字典公开。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-10-21T20:34:40.727

编辑：这将返回一个哈希表（无论出于何种原因，尽管是一个'DictionarySectionHandler'）。然而，由于 Hashtables 和 Dictionaries 非常相似，这应该不是一个大问题（尽管我意识到字典是更新的、参数化的等；我自己更喜欢字典，但这是 .NET 给我们的）。

* * *

我刚刚为此找到的最佳答案是[here](https://stackoverflow.com/questions/338242/how-do-i-store-a-dictionary-object-in-my-web-config-file/338310#338310)。它返回一个类型安全的集合，没有任何混乱的代码来转换它，并且您在 .config 文件中创建一个明显（且简单）的集合。我正在使用它，它对于任何未来的程序员（包括你自己）来说都是非常简单的。它允许更强的打字和更大的灵活性，没有任何过于复杂和不必要的解析。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-10-21T21:59:26.843

您可以存储一个`StringCollection`. 它类似于[此解决方案](https://stackoverflow.com/questions/2890271/how-to-save-a-liststring-on-settings-default)。

我做了 2 种扩展方法来在 和 之间进行`StringCollection`转换`Dictionary`。这是我能想到的最简单的方法。

```
public static class Extender
{
    public static Dictionary<string, string> ToDictionary(this StringCollection sc)
    {
        if (sc.Count % 2 != 0) throw new InvalidDataException("Broken dictionary");

        var dic = new Dictionary<string, string>();
        for (var i = 0; i < sc.Count; i += 2)
        {
            dic.Add(sc[i], sc[i + 1]);
        }
        return dic;
    }

    public static StringCollection ToStringCollection(this Dictionary<string, string> dic)
    {
        var sc = new StringCollection();
        foreach (var d in dic)
        {
            sc.Add(d.Key);
            sc.Add(d.Value);
        }
        return sc;
    }
}

class Program
{
    static void Main(string[] args)
    {
        //var sc = new StringCollection();
        //sc.Add("Key01");
        //sc.Add("Val01");
        //sc.Add("Key02");
        //sc.Add("Val02");

        var sc = Settings.Default.SC;

        var dic = sc.ToDictionary();
        var sc2 = dic.ToStringCollection();

        Settings.Default.SC = sc2;
        Settings.Default.Save();
    }
} 
```

# sql-server - 在 SQl Server 2005 中对多个表进行全文搜索

> ID：922050
> 
> 赞同：0
> 
> 时间：2009-05-28T17:03:57.133
> 
> 标签：sql-server, sql-server-2005, full-text-search

我需要跨表实现全文搜索。

有什么不同的选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T17:11:41.890

您也许可以对表格进行全文索引和索引视图

# java - 在 Java 中测试字体是否为等宽字体

> ID：922052
> 
> 赞同：15
> 
> 时间：2009-05-28T17:04:23.370
> 
> 标签：java, swing, fonts

我正在尝试列出用户机器上所有可用的等宽字体。我可以通过以下方式获得 Swing 中的所有字体系列：

```
String[] fonts = GraphicsEnvironment.getLocalGraphicsEnvironment()
                                    .getAvailableFontFamilyNames(); 
```

有没有办法找出其中哪些是等宽的？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-20T14:09:36.857

一种更简单的方法，不需要制作 BufferedImage 来获取 Graphics 对象等：

```
 Font fonts[] = GraphicsEnvironment.getLocalGraphicsEnvironment().getAllFonts();
    List<Font> monoFonts1 = new ArrayList<>();

    FontRenderContext frc = new FontRenderContext(null, RenderingHints.VALUE_TEXT_ANTIALIAS_DEFAULT, RenderingHints.VALUE_FRACTIONALMETRICS_DEFAULT);
    for (Font font : fonts) {
        Rectangle2D iBounds = font.getStringBounds("i", frc);
        Rectangle2D mBounds = font.getStringBounds("m", frc);
        if (iBounds.getWidth() == mBounds.getWidth()) {
            monoFonts1.add(font);
        }
    } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T17:45:02.213

~~您可以使用[FontMetrics](http://java.sun.com/javase/6/docs/api/java/awt/FontMetrics.html)类的[getWidths()](http://java.sun.com/javase/6/docs/api/java/awt/FontMetrics.html#getWidths())方法。根据JavaDoc：~~

> ~~获取字体中前 256 个字符的前进宽度。前进是从角色基线上最左边的点到最右边的点的距离。请注意，字符串的前进不一定是其字符前进的总和。~~

您可以使用[FontMetrics](http://java.sun.com/javase/6/docs/api/java/awt/FontMetrics.html)类的`charWidth(char)`方法。例如：

```
Set<String> monospaceFontFamilyNames = new HashSet<String>();

GraphicsEnvironment graphicsEnvironment = GraphicsEnvironment.getLocalGraphicsEnvironment();
String[] fontFamilyNames = graphicsEnvironment.getAvailableFontFamilyNames();

BufferedImage bufferedImage = new BufferedImage(1, 1, BufferedImage.TYPE_INT_ARGB);
Graphics graphics = bufferedImage.createGraphics();

for (String fontFamilyName : fontFamilyNames) {
    boolean isMonospaced = true;

    int fontStyle = Font.PLAIN;
    int fontSize = 12;
    Font font = new Font(fontFamilyName, fontStyle, fontSize);
    FontMetrics fontMetrics = graphics.getFontMetrics(font);

    int firstCharacterWidth = 0;
    boolean hasFirstCharacterWidth = false;
    for (int codePoint = 0; codePoint < 128; codePoint++) { 
        if (Character.isValidCodePoint(codePoint) && (Character.isLetter(codePoint) || Character.isDigit(codePoint))) {
            char character = (char) codePoint;
            int characterWidth = fontMetrics.charWidth(character);
            if (hasFirstCharacterWidth) {
                if (characterWidth != firstCharacterWidth) {
                    isMonospaced = false;
                    break;
                }
            } else {
                firstCharacterWidth = characterWidth;
                hasFirstCharacterWidth = true;
            }
        }
    }

    if (isMonospaced) {
        monospaceFontFamilyNames.add(fontFamilyName);
    }
}

graphics.dispose(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T17:34:41.783

比较几个字符的绘制长度（m, i, 1, . 应该是一个很好的集合）。

对于等宽字体，它们都是相等的，对于可变宽度字体，它们不会。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T19:04:33.957

可能不适用于您的情况，但如果您只想将字体设置为等宽字体，请使用逻辑字体名称：

```
Font mono = new Font("Monospaced", Font.PLAIN, 12); 
```

这将是您系统上保证的等宽字体。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T17:35:51.310

根据[此响应](https://stackoverflow.com/questions/221568/swt-os-agnostic-way-to-get-monospaced-font)，Java 对底层字体细节了解不多，因此您必须对字体的尺寸进行一些比较。

# javascript - 是否可以在通过表单上传之前预览本地图像？

> ID：922057
> 
> 赞同：23
> 
> 时间：2009-05-28T17:06:15.210
> 
> 标签：javascript, image, upload, preview

更具体地说，我想使用一个带有一个或多个用于图像的文件输入字段的表单。当这些字段发生更改时，我想在将数据发送到服务器之前显示相关图像的预览。

我尝试了许多 javascript 方法，但我总是遇到安全错误。我不介意使用 java 或 flash，只要解决方案对于那些没有它们的用户可以优雅地降级。（他们不会得到预览，也不会得到恼人的“安装这个东西”。）

有没有人以一种简单、可重复使用的方式做到这一点？

PS我知道有一个沙箱，但沙箱必须在一个黑暗的、上锁的房间里，所有的窗户都涂黑了吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2011-10-03T16:17:46.473

不需要花哨的东西。您所需要的只是该`createObjectURL`函数，它创建一个可以用作图像的 URL `src`，并且可以直接来自本地文件。

假设您使用文件输入元素 ( `<input type="file" />`) 从用户计算机中选择了几张图像。以下是为它创建图像文件预览的方法：

```
function createObjectURL(object) {
    return (window.URL) ? window.URL.createObjectURL(object) : window.webkitURL.createObjectURL(object);
}

function revokeObjectURL(url) {
    return (window.URL) ? window.URL.revokeObjectURL(url) : window.webkitURL.revokeObjectURL(url);
}

function myUploadOnChangeFunction() {
    if(this.files.length) {
        for(var i in this.files) {
            var src = createObjectURL(this.files[i]);
            var image = new Image();
            image.src = src;
            // Do whatever you want with your image, it's just like any other image
            // but it displays directly from the user machine, not the server!
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T18:43:40.630

第一步是找出图像路径。允许 JavaScript 询问文件名/路径的上传控件，但是（出于安全原因）各种浏览器向 JS 引擎显示的内容与向用户显示的内容不同 - 它们倾向于保持文件名完整，因此您至少可以验证它的扩展名，但您可能会`c:\fake_path\`在文件名前面加上一些类似的混淆的东西。在各种浏览器上尝试此操作将使您了解哪些内容作为真实路径返回，哪些内容被伪造，以及在哪里。

第二步是显示图像。如果您知道它们的路径，则可以通过带有源 URL 的`img`标签显示本地图像，如果用户的浏览器允许该方案。（默认情况下，Firefox 不会。）因此，如果您可以让用户告诉您图像的完整路径是什么，您至少可以尝试加载它。`file://``file://`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:33:46.063

出于安全目的，JavaScript 无法访问本地文件系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T18:47:50.527

我只见过这样做的 Java 小程序，例如 Facebook 上的图像上传小程序。Java 方法的缺点是在运行之前会提示用户信任小程序，这是一种烦恼，但这允许小程序呈现带有图像预览的文件浏览器或做更多有趣的事情，例如允许用户上传整个目录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T17:39:33.143

这是一个用于上传图像并进行预览[的 jQuery + PHP 脚本。](http://www.webmotionuk.co.uk/php-jquery-image-upload-and-crop/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-16T09:27:27.713

您可以尝试这种方法，尽管它似乎不适用于 IE。

[http://saravani.wordpress.com/2012/03/14/preview-of-an-image-before-it-is-uploaded/](http://saravani.wordpress.com/2012/03/14/preview-of-an-image-before-it-is-uploaded/)

编码简单快捷。

我将代码放在这里以防源代码死亡：

脚本：

```
 <!-- Assume jQuery is loaded -->
    <script>
      function readURL(input) {
        if (input.files && input.files[0]) {
          var reader = new FileReader();

          reader.onload = function (e) {
            $('#img_prev')
              .attr('src', e.target.result)
              .width(150)
              .height(200);
          };

          reader.readAsDataURL(input.files[0]);
        }
      }
    </script> 
```

在 HTML 中：

```
 <!--[if IE]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    </head>
    <body>
      <input type='file' onchange="readURL(this);" />
      <img id="img_prev" src="#" alt="your image" />
    </body> 
```

# php - 最简单的 PHP 身份验证解决方案？

> ID：922064
> 
> 赞同：9
> 
> 时间：2009-05-28T17:07:34.520
> 
> 标签：php, authentication

如果已经有人问过这个问题，请原谅我（并随时提供参考并关闭它）。

最终目标是将一些数据与每个用户（显然）相关联，并根据用户的角色以不同的方式向用户显示这些数据。

我已经广泛寻找一个简单的、插入式的解决方案，用于在 PHP 中对用户进行身份验证。

我不是在寻找：

*   具有身份验证的 CMS
*   一个 PHP MVC 框架

这个项目对双方来说都太简单了，虽然它最终应该投入生产，但将由新手程序员执行。我想教他们 PHP，而不是 CMS 或框架的细节。我并不完全反对框架的想法，但我看过的所有框架都强制执行 MVC，在这一点上这是一个太高级的概念。

我正在寻找可以让我轻松注册用户、登录用户和将用户分配到角色的东西。理想情况下，这意味着拥有一个库来处理数据库和加密逻辑，并为我提供一个简单的 API 来执行上述操作。我更喜欢为库提供一个数据库，让它在没有我任何交互的情况下完成它的工作——在会话中存储数据也是可取的，但不是必需的。

我知道我自己可以轻松做到这一点，但我想让我教的人变得简单。我想要一个库/组件/等。我一直在 PEAR，那里的模块似乎过于复杂。PHP5 文档中给出的两个身份验证提供程序对我来说似乎不清楚。那些在行动的例子，如果他们按照我所描述的那样去做，就会奏效。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T17:34:25.200

[登录会话](http://www.evolt.org/node/60384)

它有点过时了，但仍然带有很棒的概念。

# javascript - 使用 javascript / jquery 删除表格行

> ID：922066
> 
> 赞同：2
> 
> 时间：2009-05-28T17:07:55.003
> 
> 标签：javascript, jquery

这是行不通的。Firebug 没有抛出任何错误。

HTML：

```
<table>
       <tr><td>BookA</td><td><a href="javascript:deleteRow($(this));" class="red">Delete</a></td></tr>
       <tr><td>BookB</td><td><a href="javascript:deleteRow($(this));" class="red">Delete</a></td></tr>
        <tr><td>BookC</td><td><a href="javascript:deleteRow($(this));" class="red">Delete</a></td></tr>
        <tr><td>BookD</td><td><a href="javascript:deleteRow($(this));" class="red">Delete</a></td></tr>
</table> 
```

Javascript：

```
function deleteRow(ref) {   
    $(ref).parent().parent().remove(); 
 } 
```

**如果可能的话，我想使用内联 javascript 的解决方案**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T17:16:38.323

首先，内联 JavaScript（`href="javascript:x"`或`onclick="x"`）通常不好。使用内联 JavaScript，您将无法访问事件对象，并且您无法确定`this`引用的是什么。

jQuery（以及几乎所有其他 JavaScript 库/框架）都有内置的事件处理。因此，带有事件处理程序的代码将如下所示：

```
$('a.red').click(function(e) {
  e.preventDefault(); // don't follow the link
  $(this).closest('tr').remove(); // credits goes to MrKurt for use of closest()
}); 
```

这是一个演示：http: [//jsbin.com/okaxu](http://jsbin.com/okaxu)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T17:14:23.883

试试这个：

```
// Bind all the td element a click event
$('table td.deleteRow').click(function(){
    $(this).parent().remove();
}); 
```

顺便说一句，它会从您的 html 代码中删除 javascript。使用此 html 代码

```
<table>
    <tr>
        <td>BookA</td>
        <td class="red deleteRow">Delete</td>
    </tr>
    <tr>
        <td>BookB</td>
        <td class="red deleteRow">Delete</td>
    </tr>
    <tr>
        <td>BookC</td>
        <td class="red deleteRow">Delete</td>
    </tr>
    <tr>
        <td>BookD</td>
        <td class="red deleteRow">Delete</td>
    </tr>
</table> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T17:15:52.117

这不起作用，因为 $(this) 没有像您想象的那样引用 a-tag（我认为它指的是窗口对象或其他东西）

而不是在 href-attribute 中使用内联javascript

而是这样做

```
<script type="text/javascript">
 $("table a").click( function() {
  $(this).parent().parent().remove();
 });
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T17:18:05.963

删除内联脚本

```
<script>
    $(function(){
        $('table td a').live('click', function(){
            $(this).parents('tr').remove();
            return false;
        });
    });
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T17:13:44.727

我相信您的 deleteRow 函数中有一个错误。应该这样写：

```
function deleteRow(ref) {   
    ref.parent().parent().remove(); 
} 
```

您传递给 deleteRow 的 ref 已经是一个 jQuery 对象。你不应该使用 $(ref)，只使用 ref，因为 ref 已经是一个 jQuery 对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T17:55:33.190

我不得不同意应该避免使用内联 javascript，但如果有其他原因需要使用它或有益于使用它，这里是方法。

```
<table>
   <tr><td>BookA</td><td><a href='#' onclick="$(this).parents('tr').remove(); return false;" class="red">Delete</a></td></tr>
   <tr><td>BookB</td><td><a href='#' onclick="$(this).parents('tr').remove(); return false;" class="red">Delete</a></td></tr>
   <tr><td>BookC</td><td><a href='#' onclick="$(this).parents('tr').remove(); return false;" class="red">Delete</a></td></tr>
   <tr><td>BookD</td><td><a href='#' onclick="$(this).parents('tr').remove(); return false;" class="red">Delete</a></td></tr>
</table> 
```

# c++ - C++ 中的图像算术函数

> ID：922068
> 
> 赞同：0
> 
> 时间：2009-05-28T17:08:11.133
> 
> 标签：c++, image, matlab, math

我正在尝试查找/编写一个与[imlincomb](http://www.mathworks.com/access/helpdesk/help/toolbox/images/index.html?/access/helpdesk/help/toolbox/images/imlincomb.html) () 执行相同操作的函数。但是，如果不使用英特尔 Performance Primitiives 库以外的任何 Matlab API 函数，我很难在 C++ 中找到此类函数，并且我真的不想购买它的许可证，除非我的应用程序真的必须利用它。有什么简单的方法可以实现它，或者是否有任何标准功能可以使工作变得更容易？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:17:25.530

在任何标准的 C++ 包中肯定没有这种东西。您也许可以在[LAPACK](http://www.netlib.org/lapack/)中使用某些东西，但我认为您最好自己编写。这是一个相当简单的函数：每个输出像素都是独立的，并且只依赖于相同坐标处的输入像素。在伪代码中：

```
for each row y in [0, height-1]
    for each column x in [0, width-1]
        for each color channel c in (R, G, B)
            output[y][x][c] = 0
            for each input i
                output[y][x][c] += weight[i] * input[i][y][x][c] 
```

当然，确切的公式取决于图像的存储方式（3D 数组、2D 数组或 1D 数组，并注意尺寸的顺序！）。

# .net - 如何在委托函数中使用变量

> ID：922077
> 
> 赞同：0
> 
> 时间：2009-05-28T17:09:51.863
> 
> 标签：.net, callback, delegates

我正在为 USB 相机使用 SDK。SDK 规定，对于抓取的每一帧，都会调用一个回调函数。回调函数在 SDK 内部定义，它获取指向图像的数据指针和用于解释数据的结构。

所有这些都正常工作。

为了制作一个有用的应用程序，我需要从我的应用程序中访问一些变量。现在因为委托函数是静态的，所以我只能访问静态成员。我想用它们制作一个单例，因为它是静态的，但是有没有“常规方式”来访问委托函数中的其他数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T17:30:38.670

为什么不只使用非静态委托？在这种情况下，您可以访问类实例成员。是否有什么东西迫使您进入静态委托，而不是您的数据和逻辑所在的类之一的实例上的委托？

如果是这样，那么有没有办法将数据传递给回调？如果可以的话，你可以传递一个类的引用，并在你的委托中使用它来获取你的应用程序数据。

如果没有，那么您可能会被迫拥有一些静态数据，或者对保存数据的类的静态引用。在这种情况下，单例或类似构造可能是最佳选择......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T17:31:14.550

你为什么让代表成为静态的？如果做的时候痛，就停止做。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:33:07.247

委托可以是静态的（尽管我不清楚为什么需要这样）。该功能不需要。

将委托解引用到方法调用中并不关心被调用的函数是实例方法还是静态方法。

# delphi - 我的程序如何判断 Delphi 是否正在运行？

> ID：922080
> 
> 赞同：9
> 
> 时间：2009-05-28T17:10:12.360
> 
> 标签：delphi

我听说一些自定义组件作者使用 RTL 例程检查 Delphi 是否正在运行，以设置共享软件限制。有谁知道这个程序是什么？检查诸如“DelphiRunning”或“IsDelphiRunning”之类的明显名称并没有发现任何有用的信息。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-28T18:54:31.183

这里有**2 个不同的想法**：
- Delphi 已启动并正在运行
- 应用程序正在调试器下运行

**测试Delphi 是否正在运行**的常用方法是检查是否存在具有特定类名（如 TAppBuilder 或 TPropertyInspector）的已知 IDE Windows。
这两个适用于所有版本的 Delphi IIRC。

如果您想知道您的应用程序是否**在调试器下运行**，即使用“运行”(F9) 从 IDE 正常启动或在已经运行时附加到调试器，您只需测试 DebugHook 全局变量。
请注意，“从程序中分离”不会删除 DebugHook 值，但“附加到进程”会设置它。

```
function IsDelphiRunning: Boolean;
begin
  Result := (FindWindow('TAppBuilder', nil) > 0) and
    (FindWindow('TPropertyInspector', 'Object Inspector') > 0);
end;

function IsOrWasUnderDebugger: Boolean;
begin
  Result := DebugHook <> 0;
end; 
```

如果目标是将组件**的试用版限制在**开发应用程序时使用，那么**两者都有缺陷**：
- 应用程序中可以包含具有正确类名/标题的隐藏窗口
- 可以在应用程序中手动设置 DebugHook代码

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T17:16:05.640

您可以在组件代码中使用 DebugHook <> 0。DebugHook 是一个由 Delphi/RAD Studio IDE 设置的全局变量（IIRC，它位于系统单元中），无法从其他任何地方设置。

还有其他技术（例如，用于 TAppBuilder 的 FindWindow()），但 DebugHook 可以完成所有工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T17:15:55.110

[这是来自www.delphitricks.com/source-code/misc/check_if_delphi_is_running.html](http://www.delphitricks.com/source-code/misc/check_if_delphi_is_running.html)的代码片段。

```
function WindowExists(AppWindowName, AppClassName: string): Boolean; 
var 
  hwd: LongWord; 
begin 
  hwd    := 0; 
  hwd    := FindWindow(PChar(AppWindowName), PChar(AppClassName)); 
  Result := False; 
  if not (Hwd = 0) then {window was found if not nil} 
    Result := True; 
end; 

function DelphiLoaded: Boolean; 
begin 
  DelphiLoaded := False; 
  if WindowExists('TPropertyInspector', 'Object Inspector') then 
    if WindowExists('TMenuBuilder', 'Menu Designer') then 
      if WindowExists('TAppBuilder', '(AnyName)') then 
        if WindowExists('TApplication', 'Delphi') then 
          if WindowExists('TAlignPalette', 'Align') then 
            DelphiLoaded := True; 
end; 

procedure TForm1.Button1Click(Sender: TObject); 
begin 
  if DelphiLoaded then 
  begin 
    ShowMessage('Delphi is running'); 
  end; 
end; 

function DelphiIsRunning: Boolean; 
begin 
  Result := DebugHook <> 0; 
end; 
```

# java - Java 映像框架

> ID：922084
> 
> 赞同：1
> 
> 时间：2009-05-28T17:11:26.073
> 
> 标签：java, image-processing, frameworks

是否有任何开源或商业 Java 框架用于执行图像操作，例如将图像从一种格式转换为另一种格式以及缩放图像等。

应该没有安装。类路径中的一组罐子可以完成这项工作。

我查看了**java-image-scaling**库，但它有问题。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:13:05.227

[您可以使用JAI](http://java.sun.com/javase/technologies/desktop/media/)在 Java 中本地执行大多数这些操作。您还可以使用 Swing Graphics2D 进行所需的任何操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:31:42.920

ImageMagick 是做你正在做的事情的最佳框架，你可以使用 JMagick 或 Im4java 来包装它的用法，但它确实需要安装 ImageMagick。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-05T17:28:11.603

尝试使用[Catalano 框架](http://code.google.com/p/catalano-framework/)。这很容易。您也可以在 Android 中运行相同的代码。有很多并行算法。示例：调整图像大小。

```
FastBitmap fb = new FastBitmap(pathname);

//You can choose interpolation algorithm too.
Resize r = new Resize();
r.applyInPlace(fb); 
```

# javascript - 基于 Poedit 正则表达式的解析器？

> ID：922095
> 
> 赞同：1
> 
> 时间：2009-05-28T17:13:28.143
> 
> 标签：javascript, localization, poedit, xgettext

在我们的 JS 文件中，我们使用以下格式进行 Gettext 翻译：

```
var str1 = '!t[The text that should be translated]';
var str2 = '!t[Some more text]'; 
```

此 JS 文件将使用 PHP 进行解析，解析后的字符串将通过 Zend Framework Zend_Translate 进行翻译。生成的 JS 如下所示：

```
var str1 = 'The text that should be translated';
var str2 = 'Some more text'; 
```

为了提取要翻译的字符串和翻译我们使用 Poedit 的 PHP 文件，它工作得非常好。
有没有办法`'!t[...]'`使用 Poedit 解析要翻译的字符串？

解决这个问题的是某种基于正则表达式的 Poedit 解析器。有没有这样的解析器？

作为替代方案，我们可以定义一个基于 xgettext 的源代码解析器，使用语言 PHP 作为参数（您必须这样做，因为 xgettext 不知道 .js 文件，它会将它们视为 C 文件）。然后我们在我们的 JS 文件中使用以下格式：

```
var str1 = '<?=_t("The text that should be translated")?>';
var str2 = '<?=_t("Some more text")?>'; 
```

不用说，为了能够用 Poedit 解析字符串而到处使用看起来像 php 的代码真的很不酷。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T18:46:43.617

与您的字符串匹配的正则表达式

```
 $translated = preg_replace('/[\'"]\!t\[(.+)\][\'"]/e', 'translate_function('\\2')', $str); 
```

我不知道 \2 是否应该替换为 \1 或 \3，您的解决方案是 PCRE 正则表达式引擎提供的“e”修饰符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-14T19:05:48.580

Poedit 和 xgettext 现在确实支持 JavaScript（老实说，我不知道 2009 年是否是这种情况，但我认为不是），但它们不支持带有自定义标记的字符串文字。所以你仍然无法从中提取

```
var str1 = '!t[The text that should be translated]'; 
```

但您可以使用辅助函数轻松提取：

```
var str1 = t('The text that should be translated'); 
```

如果您只是`t`在 Poedit 中添加为关键字。

# .net - 用户范围应用程序设置始终重置为默认值

> ID：922098
> 
> 赞同：1
> 
> 时间：2009-05-28T17:13:59.250
> 
> 标签：.net, winforms, configuration

我有一个使用 .NET 2 的设置功能的 WinForms 应用程序，但保存在应用程序中的用户范围设置值通常被存储在设置类中的默认值替换。很久以前，我在某处找到了将其归因于自动递增内部版本号的指导，我怀疑这是真的。但是，上述指导建议了以下代码，但不知何故，我的设置仍然不断被重置。

目前我正在解决太多其他问题，无法深入探讨这个问题，但我想我会解决这个问题，看看是否有人可以帮助我，以及其他有这个问题的人。

```
 private void Form1_Load(object sender, EventArgs e)
    {
        UpgradeSettings();
        GetSettings();
    }

    private void UpgradeSettings()
    {
        if (Properties.Settings.Default.CallUpgrade)
        {
            Properties.Settings.Default.Upgrade();
            Properties.Settings.Default.CallUpgrade = false;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-01T16:07:48.603

您必须按如下方式修改 UpgradeSettings。CallUpgrade 的初始值应为 true（在用户设置中）。

```
private void Form1_Load(object sender, EventArgs e)
{
    UpgradeSettings();
    GetSettings();
}

private void UpgradeSettings()
{
    if (Properties.Settings.Default.CallUpgrade)
    {
        Properties.Settings.Default.Upgrade();
        Properties.Settings.Default.Reload(); // to activate the settings
        Properties.Settings.Default.CallUpgrade = false;
        Properties.Settings.Default.Save();// to save the new value of CallUpgrade            
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T02:59:27.647

CallUpgrade 默认为 true 吗？对 Upgrade() 的调用应该跨内部版本号迁移设置。

另一种方法是使用固定的内部版本号。您可以根据需要手动修改您的 AssemblyInfo.cs。

# java - 在 JBoss 中启用 SSI（服务器端包含）？

> ID：922100
> 
> 赞同：3
> 
> 时间：2009-05-28T17:14:19.310
> 
> 标签：java, jboss, ssi

你们中有人在 JBoss 中启用了 SSI（ServerSide Includes）吗？我想这应该不难，因为它是建立在 Tomcat 实例之上的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T17:56:09.867

Tomcat 已经在 catalina.jar 中包含了*org.apache.catalina.ssi.SSIServlet*，所以只需声明 servlet 并将其附加到映射 URL，方法是在应用程序*web.xml中设置它*

```
<servlet>
    <servlet-name>ssi</servlet-name>
    <servlet-class>
        org.apache.catalina.ssi.SSIServlet
    </servlet-class>
    <init-param>
        <param-name>buffered</param-name>
        <param-value>1</param-value>
    </init-param>
    <init-param>
        <param-name>debug</param-name>
        <param-value>0</param-value>
    </init-param>
    <init-param>
        <param-name>expires</param-name>
        <param-value>60</param-value>
    </init-param>
    <init-param>
        <param-name>isVirtualWebappRelative</param-name>
        <param-value>1</param-value>
    </init-param>
    <load-on-startup>4</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>ssi</servlet-name>
    <url-pattern>*.shtml</url-pattern>
</servlet-mapping> 
```

[我把所有的参数都放好了，你可以在这个Tomcat SSI](http://www.mbaworld.com/docs/ssi-howto.html)参考中看到它们的定义。

正如文档所说，SSI 可以绕过安全策略，因此它必须是特权的，这样做会更改部署文件夹内jboss *-web.deploy中的**context.xml 。*只需将*privileged="true"*添加到根元素即可。

 **```
<Context ... privileged="true"> 
```

servlet 将充当与其映射的 URL 匹配的文件的代理。

# javascript - 预加载 javascript 一个嵌入式播放器

> ID：922104
> 
> 赞同：2
> 
> 时间：2009-05-28T17:16:02.553
> 
> 标签：javascript, embedded-resource, preloader

如果我有带有嵌入代码的 HTML——例如，YouTube 的嵌入式播放器——我可以在 JavaScript、AJAX 等中构建这个播放器的预加载器吗？

我问是因为如果我只嵌入了播放器，加载时页面是白色的，然后播放器就会显示出来......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T12:49:08.690

如果您无法修改 Flash 文件以满足您的需要（如使用 YouTube 剪辑时的情况），您可以在嵌入对象后面放置一个 div。嵌入对象在加载时会掩盖您的“飞溅” div - 假设它没有透明度。

```
.wrapper {
  width: 425px;
  margin: 0 auto;
}

.splash {
  position: absolute;
  width: 425px;
  height: 344px;
  background-color: red;
  z-index: -1;
}

<div class="wrapper">
  <div class="splash"></div>
  <object width="425" height="344">
        <param name="movie" value="http://www.youtube.com/"/>
        <param name="allowFullScreen" value="true"/>
        <param name="allowscriptaccess" value="always"/>
        <embed width="425" height="344" src="http://www.youtube.com/" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true"/>
  </object>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:35:23.083

也许我理解错了，但如果嵌入式组件可以发出 DOM 事件信号，您可以用 javascript 捕获它并用实际加载的播放器替换一些启动图像。它特定于您嵌入的内容。

# ms-access - 有没有办法在 VBA（MS Access 2002 或 2003）中调用任何控件的更新前事件过程？

> ID：922111
> 
> 赞同：3
> 
> 时间：2009-05-28T17:16:39.417
> 
> 标签：ms-access, validation, events, forms

在 VBA 中，我正在更改 Access 表单中一些控件的值。我喜欢在这样做之后运行这些控件的 BeforeUpdate 事件，因为它会检查字段之间的一致性：

```
Private Sub ExampleProc1()
  Dim intCancel as Integer

  intCancel = False

  Me.Controls("Date1").Value=Null
  Me.Controls("Textfield1").Value=Null

  Call Date1_BeforeUpdate(intCancel)
  Call Textfield1_BeforeUpdate(intCancel)
End Sub 
```

我想让它通用，但我找不到运行事件过程的方法。我想要这样的东西：

```
Private Sub ExampleProc2(ParamArray Fields())
  Dim intCancel as Integer, varV as Variant

  For Each varV in Fields
    Me.Controls(varV).value=Null
    intCancel = False
    Call Me.Controls(varV).BeforeUpdate(intCancel)
  Next
End Sub 
```

这甚至可能吗？也许 DoCmd.RunMacro 是要走的路？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T17:46:28.747

实际上你可以使用 CallByName

```
CallByName Me, Me.Controls(varV).Name & "_BeforeUpdate", VbMethod, intCancel 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:48:13.347

您可能会考虑 Run ( [http://msdn.microsoft.com/en-us/library/aa199108(office.10).aspx](http://msdn.microsoft.com/en-us/library/aa199108(office.10).aspx) ) 和 Eval Function：

```
Debug.Print Eval("ShowNames()")    
Debug.Print Eval("StrComp(""Joe"",""joe"", 1)")
Debug.Print Eval("Date()") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T03:52:52.313

您可能想研究创建自定义集合，然后将它们传递给您的函数。我在表单中广泛使用它们来验证控件。在表单的模块级别说您定义了这个集合：

```
 Dim mcolDateFields As New Collection 
```

然后在表单的 OnLoad 事件中，您可以这样做：

```
 mcolDateFields.Add Me!txtDateEntered, "txtDateEntered"
  mcolDateFields.Add Me!txtDatePrinted, "txtDatePrinted"
  mcolDateFields.Add Me!txtDateArchived, "txtDateArchived" 
```

要浏览该集合，您需要执行以下操作：

```
 Dim varItem As Variant
  Dim ctl As Control

  For Each varItem In mcolDateFields
    Set ctl = varItem
    Debug.Print ctl.Name & ": " & ctl.Value
  Next varItem
  Set ctl = Nothing 
```

...您可以将 Debug.Print 替换为实际有用的东西。

然后，您还可以将控件传递给其他将集合作为参数并对其执行某些操作的代码例程：

```
 Public Sub (mcolCollection As Collection)
    Dim varItem As Variant
    Dim ctl As Control

    For Each varItem In mcolCollection 
      Set ctl = varItem
      Debug.Print ctl.Name & ": " & ctl.Value
    Next varItem
    Set ctl = Nothing
  End Sub 
```

这可能允许您传递要验证的控件集合。由于您将控件引用存储在集合中，而不是控件名称或控件值，因此无需传递父表单名称。如果你需要它，你可以用这个得到它：

```
 Dim varItem As Variant
  Dim ctl As Control

  For Each varItem In mcolCollection 
    Set ctl = varItem
    Debug.Print ctl.Parent.Name & "!" & ctl.Name & ": " & ctl.Value
  Next varItem
  Set ctl = Nothing 
```

同样，如果您想以与在表单自己的模块中使用 Me 关键字相同的方式使用表单，只需使用 ctl.Parent，如果控件位于表单本身（而不是，比如说，在选项卡控件上）。

对您的代码示例的一些评论——您的第一个看起来像这样：

```
 Private Sub ExampleProc1()
    Dim intCancel as Integer

    intCancel = False

    Me.Controls("Date1").Value=Null
    Me.Controls("Textfield1").Value=Null

    Call Date1_BeforeUpdate(intCancel)
    Call Textfield1_BeforeUpdate(intCancel)
  End Sub 
```

虽然在创建可取消事件时它被定义为整数，但它实际上根本不是 - 它是一个布尔值，要取消事件，您必须将其设置为 True (-1)。我认为这实际上是 Access VBA 在 VBA 之前的 Access 时代的保留，当时 Access Basic 缺少布尔数据类型。通常，我只对与 Cancel 参数一起使用的变量使用布尔值。

```
 Me.Controls("Date1").Value=Null 
```

我不知道你为什么要这样做。我会这样编码：

```
 Me!Date1 = Null 
```

您的代码过于冗长，因为您两次指定了默认值：Controls 集合是表单的默认集合。实际上，默认集合是 Controls 和 Fields 集合的串联，因此指定您要使用控件可能有充分的理由，例如，如果您正在使用相应字段缺少的控件属性。但是对于操作值，如果有一个与字段同名的控件，则使用哪个值并不重要，因为它们将是相同的，除非在极不可能的情况下，控件实际上并未绑定到该字段同名。

同样，.Value 是控件的默认属性，因此没有理由指定它。您可能想要这样做的唯一情况是，如果您将它用作调用另一个例程的参数，其中参数是 ByRef 而不是 ByVal。但一般来说，仅仅为控件分配一个值，就是浪费打字。

为了做你想要完成的事情，控制引用的集合在我看来是一个很好的解决方案。不过，我不知道这些控件的事件是否需要公开。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T17:34:59.237

显然可以在 Access 中执行 CallByName，但您也可以将所有控件的 BeforeUpdate 逻辑放在一个集中的子中，根据您传递的参数改变其行为。然后，您在 BeforeUpdate 事件处理程序中所拥有的只是对集中子例程的调用。

# c# - 在 WCF 中缓存？

> ID：922116
> 
> 赞同：42
> 
> 时间：2009-05-28T17:18:41.003
> 
> 标签：c#, .net, wcf

我正在构建 WCF 服务。我需要将参考数据存储在缓存中，每次我收到来自该方法的输入时都会查找这些数据……正确的方法是什么？我还想为缓存定义一个过期策略，该策略将在一定时间间隔后使其失效。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2011-08-10T14:30:40.367

如果您使用的是 .NET 4，推荐的方法是使用[MemoryCache](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2011-11-25T21:43:16.007

任何缓存解决方案都应该解决两个基本问题

**1）缓存项的存储和检索**

**2) 缓存失效**

由于 Http 缓存是众所周知的，我不打算详细解释它。您可以将 asp 兼容性属性单独与一些 Web 配置一起使用，您将在其中通过魅力获得缓存。

```
[AspNetCacheProfile("MyProfile")]
        public Customer GetName(string id)
        {
             // ...
        } 
```

网络配置就像

```
<system.serviceModel>
        <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />    
</system.serviceModel>
<system.web>
   <caching>
      <outputCacheSettings>
         <outputCacheProfiles>
            <add name=" MyProfile" duration="600" varyByParam="none" sqlDependency="MyTestDatabase:MyTable"/>
         </outputCacheProfiles>
      </outputCacheSettings>
   </caching>
</system.web> 
```

但这不适用于大多数场景，尤其是当您有大型复杂对象要缓存时。例如我有一种情况，我想缓存一个系统生成的图像（操作合约的输出是一个系统生成的图像，它依赖于输入）。在这种情况下，您必须实现自己的缓存。我使用了 Microsoft 企业库缓存块来满足我所有的缓存存储需求。但是，您仍然需要进行管道以将 Microsoft 企业库缓存块与您的 WCF 服务集成。首先你必须拦截 WCF 通信通道来实现缓存。有关如何拦截 WCF 通信通道的详细讨论，请访问[http://msdn.microsoft.com/en-us/magazine/cc163302.aspx](http://msdn.microsoft.com/en-us/magazine/cc163302.aspx). 这就是你为 WCF 缓存做管道的方式

![基本管道架构](https://i.stack.imgur.com/wZTLK.png)

**步骤 0** 假设您有一个如下操作合约，并且您想缓存该方法返回的项目。

```
[OperationContract]
MyCompositeClass Rotate(int angle) 
```

**步骤 1** 首先，您必须在 WCF 管道中注册您的自定义缓存器。为此，我将使用一个属性，以便我可以根据面向方面的编程原则很好地装饰我的 WCF 调用。

```
using System;
using System.ServiceModel.Description;
using System.ServiceModel.Channels;
using System.ServiceModel.Dispatcher;
using System.Reflection;

    [AttributeUsage(AttributeTargets.Method)]
    public class MyCacheRegister : Attribute, IOperationBehavior
    {
        ConstructorInfo _chacherImplementation;
        public ImageCache(Type provider)
        {
            if (provider == null)
            {
                throw new ArgumentNullException("Provider can't be null");
            }
            else if (provider.IsAssignableFrom(typeof(IOperationInvoker)))
            {
                throw new ArgumentException("The type " + provider.AssemblyQualifiedName + " does not implements the interface " + typeof(IOperationInvoker).AssemblyQualifiedName);
            }
            else
            {
                try
                {
                    Type[] constructorSignatureTypes = new Type[1];
                    constructorSignatureTypes[0] = typeof(IOperationInvoker);
                    _chacherImplementation = provider.GetConstructor(constructorSignatureTypes);

                }
                catch
                {
                    throw new ArgumentException("There is no constructor in " + provider.AssemblyQualifiedName + " that accept " + typeof(IOperationInvoker).AssemblyQualifiedName + " as a parameter");
                }

            }

        }

        public void AddBindingParameters(OperationDescription operationDescription, BindingParameterCollection bindingParameters)
        {
            return;
        }

        public void ApplyClientBehavior(OperationDescription operationDescription, ClientOperation clientOperation)
        {
            return;
        }

        /// <summary>
        /// Decorate the method call with the cacher
        /// </summary>
        public void ApplyDispatchBehavior(OperationDescription operationDescription, DispatchOperation dispatchOperation)
        {
            //decorator pattern, decorate with a  cacher
            object[] constructorParam = new object[1];
            constructorParam[0] = dispatchOperation.Invoker;
            dispatchOperation.Invoker = (IOperationInvoker)_chacherImplementation.Invoke(constructorParam);
        }

        public void Validate(OperationDescription operationDescription)
        {
            return;
        }
    } 
```

**第2步**

然后您必须实现将检索缓存对象的点。

```
using System;
using System.ServiceModel.Dispatcher;
using Microsoft.Practices.EnterpriseLibrary.Caching;
using Microsoft.Practices.EnterpriseLibrary.Common;
using System.IO;

    class RotateCacher : IOperationInvoker
    {

        private IOperationInvoker _innerOperationInvoker;
        public RotateImageCacher(IOperationInvoker innerInvoker)
        {
            _innerOperationInvoker = innerInvoker;
        }
        public object[] AllocateInputs()
        {
            Object[] result = _innerOperationInvoker.AllocateInputs();
            return result;
        }

        public object Invoke(object instance, object[] inputs, out object[] outputs)
        {
            object result=null;

///TODO: You will have more object in the input if you have more ///parameters in your method

            string angle = inputs[1].ToString();

            ///TODO: create a unique key from the inputs
            string key = angle;

            string provider = System.Configuration.ConfigurationManager.AppSettings["CacheProviderName"];
            ///Important Provider will be DiskCache or MemoryCache for the moment
provider =”DiskCache”;
///TODO: call enterprise library cache manager, You can have your own 
/// custom cache like Hashtable

    ICacheManager manager = CacheFactory.GetCacheManager(provider);

            if (manager.Contains(key))
            {

                result =(MyCompositeClass) manager[key];

            }
            else
            {
                result =(MyCompositeClass) _innerOperationInvoker.Invoke(instance, inputs, out outputs);
                manager.Add(key, result);
            }
            return result;
        }

        public IAsyncResult InvokeBegin(object instance, object[] inputs, AsyncCallback callback, object state)
        {
            IAsyncResult result = _innerOperationInvoker.InvokeBegin(instance, inputs, callback, state);
            return result;
        }

        public object InvokeEnd(object instance, out object[] outputs, IAsyncResult asyncResult)
        {
            object result = _innerOperationInvoker.InvokeEnd(instance, out outputs, asyncResult);
            return result;
        }

        public bool IsSynchronous
        {
            get { return _innerOperationInvoker.IsSynchronous; }
        }
    } 
```

**第 3 步**

最后在您的服务调用上方添加您的属性

```
[OperationContract]
[MyCacheRegister(typeof(RotateCacher)]
MyCompositeClass Rotate(int angle) 
```

企业库缓存块的配置超出了这个答案的范围。您可以使用以下链接来学习它。企业库的好处是您可以使用现成的方法来扩展缓存策略。它内置了缓存到期和存储的方法。您还可以编写自己的缓存过期和存储策略。 [http://www.codeproject.com/KB/web-cache/CachingApplicationBlock.aspx](http://www.codeproject.com/KB/web-cache/CachingApplicationBlock.aspx)

最后一件事，为了让您的企业库缓存正常工作，您需要添加以下配置详细信息。您还需要将相关的 dll 添加到您的项目参考中。

```
<configSections>
    <section name="cachingConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Caching.Configuration.CacheManagerSettings, Microsoft.Practices.EnterpriseLibrary.Caching, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="true" />
  </configSections>

  <cachingConfiguration defaultCacheManager="Cache Manager">
    <cacheManagers>
      <add name="MemoryCache" type="Microsoft.Practices.EnterpriseLibrary.Caching.CacheManager, Microsoft.Practices.EnterpriseLibrary.Caching, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
        expirationPollFrequencyInSeconds="60" maximumElementsInCacheBeforeScavenging="1000"
        numberToRemoveWhenScavenging="10" backingStoreName="NullBackingStore" />
      <add name="DiskCache" type="Microsoft.Practices.EnterpriseLibrary.Caching.CacheManager, Microsoft.Practices.EnterpriseLibrary.Caching, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
        expirationPollFrequencyInSeconds="60" maximumElementsInCacheBeforeScavenging="1000"
        numberToRemoveWhenScavenging="10" backingStoreName="IsolatedStorageCacheStore" />
    </cacheManagers>
    <backingStores>
      <add type="Microsoft.Practices.EnterpriseLibrary.Caching.BackingStoreImplementations.NullBackingStore, Microsoft.Practices.EnterpriseLibrary.Caching, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
        name="NullBackingStore" />
      <add name="IsolatedStorageCacheStore" type="Microsoft.Practices.EnterpriseLibrary.Caching.BackingStoreImplementations.IsolatedStorageBackingStore, Microsoft.Practices.EnterpriseLibrary.Caching, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
        encryptionProviderName="" partitionName="MyCachePartition" />
    </backingStores>
  </cachingConfiguration> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-07T21:04:03.663

如果您要在负载平衡的无状态系统中向外扩展至多台服务器，您需要[设计使用分布式缓存](http://fryerblog.com/post/63388702380/distributed-caching-strategy)。这里要做的主要事情是：

1.  同时使用本地和分布式缓存。仅将会话或短期内容放在分布式缓存中，其他内容在本地缓存。

2.  为项目设置适当的超时。这将根据信息的类型以及与信息源的距离而有所不同。

3.  当你知道它会失禁时从缓存中删除它（如更新、删除等）。

4.  注意设计唯一的缓存键。构建您计划缓存的信息类型的模型，并将其用作构建密钥的模板。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T17:29:10.543

你可以看看[Velocity](http://www.microsoft.com/downloads/details.aspx?FamilyId=B24C3708-EEFF-4055-A867-19B5851E7CD2&displaylang=en)。这是微软的分布式内存[缓存框架](http://msdn.microsoft.com/en-us/data/cc655792.aspx)。但这可能有点太beta了......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-09T09:28:03.300

这是一篇好文章：[http ://cascadeofinsights.com/post/1410736927/introducing-attribute-based-caching](http://cascadeofinsights.com/post/1410736927/introducing-attribute-based-caching)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-16T01:11:11.323

实际上，您可以确保在缓存的基础数据发生更改时使缓存失效，而不是每隔一段时间就使缓存数据过期。

请参阅 info Q [http://www.infoq.com/news/2011/04/Attribute-Caching中的此示例](http://www.infoq.com/news/2011/04/Attribute-Caching)

```
[Cache.Cacheable("UserTransactionCache")]
public DataTable GetAllTransactionsForUser(int userId)
{
    return new DataProvider().GetAllTransactionsForUser(userId);
}

[Cache.TriggerInvalidation("UserTransactionCache")]
public void DeleteAllTransactionsForUser(int userId)
{
 ...
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T17:33:06.857

您可以使用 System.Web.Cache（即使您不在网络环境中），这就是我要做的。它基本上是一个很大的内存哈希表，带有一些用于过期内容的细节。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T17:34:36.977

有很多方法可以做到这一点。一种相当简单的方法是自己托管 System.Web.Cache 对象并使用它来存储引用数据。这里有一个很好的例子：http: [//kjellsj.blogspot.com/2007/11/wcf-caching-claims-using.html](http://kjellsj.blogspot.com/2007/11/wcf-caching-claims-using.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T17:35:34.963

WCF REST Starter Kit 具有缓存功能，这里有一篇关于使用它的文章...带有示例代码。

[http://weblogs.asp.net/gsusx/archive/2008/10/29/adding-caching-to-wcf-restful-services-using-the-rest-starter-kit.aspx](http://weblogs.asp.net/gsusx/archive/2008/10/29/adding-caching-to-wcf-restful-services-using-the-rest-starter-kit.aspx)

# web - 如何查看我的网站使用了多少带宽？

> ID：922122
> 
> 赞同：2
> 
> 时间：2009-05-28T17:20:01.170
> 
> 标签：web, firefox-addon, bandwidth

我正在寻找一个 Firefox 插件，它可以跟踪页面使用的带宽量。这可以是一个普通的 HTML 页面或带有使用 Javascript 的聊天功能的 GMail。有什么可以帮助我像这样优化我的页面吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T17:22:19.060

也许[YSlow](http://developer.yahoo.com/yslow/)是您正在寻找的东西？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T17:23:26.080

FireBug 具有允许您查看某些脚本、页面、图像等需要多少带宽以及加载多长时间的功能

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:29:34.880

1.  [安装萤火虫](http://getfirebug.com/)
2.  [下载 YSlow](https://addons.mozilla.org/en-US/firefox/addon/5369)
3.  [查看 YSlow 用户指南](http://developer.yahoo.com/yslow/help/index.html)

# cocoa - 添加复合属性以绑定到现有类的最佳方法是什么

> ID：922128
> 
> 赞同：0
> 
> 时间：2009-05-28T17:21:16.160
> 
> 标签：cocoa, properties, cocoa-bindings

假设我有一个具有高度和宽度属性的 Size 类（实际上该类比这更复杂，但 Size 是一个很好的例子）。

我想在我的 UI 中将其显示为 $width x $height。

显而易见的方法是绑定到一个依赖于宽度和高度的尺寸属性。

我的问题是添加这个新属性的最佳位置在哪里？

我可以将它添加到模态中的 Size 类本身，但是如果另一个控制器想要显示不同的字符串，我会卡住创建另一个属性。我也有点不愿意这样做，因为在我的情况下， Size 类位于一个框架中，该框架将在几个不同的地方使用（尽管可能全部来自我可以控制的代码）。

我可以将它添加到包含视图/控制器的项目内的 Size 类的类别中，因此它仅在我知道将使用它的地方可用，但在不同的地方我已经看到有关类别倾向于被过度使用的建议，并且不得不怀疑这是否是其中一种情况。

在单个 Size 实例的情况下，我可以在包含它的控制器类中创建属性，但是当您有一个 Sizes 数组时，这变得更加困难。

我可以绑定到整个大小对象并使用转换器将它们转换为字符串，但是绑定到大小数组会导致您必须将数组的每个元素转换为转换器中的新数组，这似乎有点丑陋。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T18:26:41.957

如果要将此复合值显示为字符串，则将文本字段的“显示模式 1”绑定到`width`属性，并将“显示模式 2”（在绑定显示模式 1 时显示）绑定到`height`属性。在 Display Pattern 1 绑定中，将“Display Pattern”设置为`%{value1}@ x %{value2}@`（是的，语法有点不直观）。这将提供一个显示“[width] x [height]”的文本字段，并将更新任一属性的更改。

您可以对 an 执行相同的操作`NSTextFieldCell`，例如作为 an 中的单元格`NSTableColumn`。此方法的缺点是文本字段将无法编辑绑定`width`和`height`值。如果您需要能够编辑它们，则必须编写 NSValueTransformer。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:56:32.917

正如 Barry 建议的那样，通过显示模式使用多个绑定听起来是最好的方法，至少在不了解您的 UI 的情况下是这样。我过去使用过同样的东西，我为一组图像构建了一个检查器，并将尺寸绑定到单个文本字段。

一般来说，如果可以的话，最好使用值转换器或格式化程序，但在万不得已的情况下，使用类别并没有错。过去，当我无法绑定到日期时，我已经这样做了，但是将其分解为单独的时间和日期部分。类别是一种很好的方法，因为它可以让你保持与模型的分离，但你不需要做任何疯狂的事情，比如直接绑定到控制器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:46:47.217

> 我想在我的 UI 中将其显示为 $width x $height。

为什么不是两个字段？然后你可以让它们可编辑。

> （实际上这个类比这个复杂一点，但是 Size 是一个很好的例子）

假设上述方法在您的实际情况下不可行，您可以尝试创建 NSFormatter 的自定义子类，并将其设置为单元格上的格式化程序（我假设这是在表格视图中，因为您不会将单个控件绑定到数组）。然后，您将绑定到整个 Size 对象。

# linux - CSV 到 XLS linux 脚本

> ID：922129
> 
> 赞同：6
> 
> 时间：2009-05-28T17:21:40.483
> 
> 标签：linux, excel, csv, xls

我需要一个脚本来将逗号分隔的 csv 文件转换为 excel xls 文件。我在网上尝试了一个 python 脚本，但我无法安装正确版本的 python 来安装脚本所需的 mod/dependency。什么是最好的解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T17:51:50.703

作弊：重命名`data.csv`为`data.xls`. excel打开它，你永远不会注意到区别

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T21:54:17.790

在这里寻找`examples/csv2xls`：[http ://search.cpan.org/~hmbrand/Text-CSV_XS/MANIFEST](http://search.cpan.org/~hmbrand/Text-CSV_XS/MANIFEST)

（我不直接链接到脚本本身，因为这应该始终引导您到最新版本。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:25:41.957

Perl ExcelWriter 模块将允许您创建 Excel 电子表格。

# c# - 使用 C# 与 Windows 更新交互

> ID：922132
> 
> 赞同：17
> 
> 时间：2009-05-28T17:22:25.333
> 
> 标签：c#, windows-update

是否有任何 API 用于编写可以与 Windows 更新交互的 C# 程序，并使用它来选择性地安装某些更新？

我正在考虑将列表存储在已批准更新的中央存储库中。然后客户端应用程序（必须安装一次）将与 Windows Update 交互以确定哪些更新可用，然后安装批准列表中的更新。这样，更新仍然会从客户端的角度自动应用，但我可以选择正在应用哪些更新。

顺便说一句，这不是我在公司中的角色，我真的只是想知道是否有用于 Windows 更新的 API 以及如何使用它。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2011-09-07T10:48:39.377

将 WUApiLib 的引用添加到您的 C# 项目中。

```
using WUApiLib;
protected override void OnLoad(EventArgs e){
    base.OnLoad(e);
    UpdateSession uSession = new UpdateSession();
    IUpdateSearcher uSearcher = uSession.CreateUpdateSearcher();
    uSearcher.Online = false;
    try {
        ISearchResult sResult = uSearcher.Search("IsInstalled=1 And IsHidden=0");
        textBox1.Text = "Found " + sResult.Updates.Count + " updates" + Environment.NewLine;
        foreach (IUpdate update in sResult.Updates) {
                textBox1.AppendText(update.Title + Environment.NewLine);
        }
    }
    catch (Exception ex) {
        Console.WriteLine("Something went wrong: " + ex.Message);
    }
} 
```

假设您有一个带有 TextBox 的表单，这将为您提供当前安装的更新列表。有关更多文档，请参阅[http://msdn.microsoft.com/en-us/library/aa387102(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa387102(VS.85).aspx)。

但是，这将不允许您找到不是通过 Windows 更新分发的 KB 修补程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T17:25:33.767

做你想做的最简单的方法是使用[WSUS](http://technet.microsoft.com/en-us/wsus/default.aspx)。它是免费的，基本上可以让您设置自己的本地 Windows 更新服务器，您可以在其中决定哪些更新已为您的计算机“批准”。WSUS 服务器和客户端都不需要位于域中，但如果它们位于域中，则可以更轻松地配置客户端。如果您有不同的机器需要批准不同的更新集，那么这也是受支持的。

这不仅实现了您的既定目标，而且通过仅从 WSUS 服务器下载一次更新来节省您的整体网络带宽。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-03-31T21:19:24.353

如果在您的上下文中您被允许使用 Windows Server Update Service ( [WSUS](http://technet.microsoft.com/en-us/wsus/default.aspx) )，它将允许您访问[Microsoft.UpdateServices.Administration 命名空间](http://msdn.microsoft.com/en-us/library/microsoft.updateservices.administration.aspx)。

从那里，你应该能够做一些好事:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-04T12:56:55.740

PL 对。我首先尝试了 Christoph Grimmer-Die 方法，但在某些情况下，它不起作用。我猜这是由于不同版本的 .net 或操作系统架构（32 位或 64 位）。然后，为了确保我的程序始终获得每个计算机域的 Windows 更新等待列表，我执行了以下操作：

*   使用 WSUS 安装服务器（可以节省一些互联网带宽）：[http ://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=5216](http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=5216)
*   将所有工作站和服务器添加到 WSUS 服务器

*   获取 SimpleImpersonation Lib 以使用不同的管理员权限运行此程序（可选）

*   仅在您的开发工作站上安装管理控制台组件并运行以下程序：

它将在控制台中使用 UpdateInstallationStates.Downloaded 打印所有 Windows 更新

```
using System;
using Microsoft.UpdateServices.Administration;
using SimpleImpersonation;

namespace MAJSRS_CalendarChecker
{
    class WSUS
    {
        public WSUS()
        {
            // I use impersonation to use other logon than mine. Remove the following "using" if not needed
            using (Impersonation.LogonUser("mydomain.local", "admin_account_wsus", "Password", LogonType.Batch))
            {
                ComputerTargetScope scope = new ComputerTargetScope();
                IUpdateServer server = AdminProxy.GetUpdateServer("wsus_server.mydomain.local", false, 80);
                ComputerTargetCollection targets = server.GetComputerTargets(scope);
                // Search
                targets = server.SearchComputerTargets("any_server_name_or_ip");

                // To get only on server FindTarget method
                IComputerTarget target = FindTarget(targets, "any_server_name_or_ip");
                Console.WriteLine(target.FullDomainName); 
                IUpdateSummary summary = target.GetUpdateInstallationSummary();
                UpdateScope _updateScope = new UpdateScope();
                // See in UpdateInstallationStates all other properties criteria
                _updateScope.IncludedInstallationStates = UpdateInstallationStates.Downloaded;
                UpdateInstallationInfoCollection updatesInfo = target.GetUpdateInstallationInfoPerUpdate(_updateScope);

                int updateCount = updatesInfo.Count;

                foreach (IUpdateInstallationInfo updateInfo in updatesInfo)
                {
                    Console.WriteLine(updateInfo.GetUpdate().Title);
                }
            }
        }
        public IComputerTarget FindTarget(ComputerTargetCollection coll, string computername)
        {
            foreach (IComputerTarget target in coll)
            {
                if (target.FullDomainName.Contains(computername.ToLower()))
                    return target;
            }
            return null;
        }
    }
} 
```

# loops - 需要帮助将结果从 ldap 解析为 csv

> ID：922137
> 
> 赞同：2
> 
> 时间：2009-05-28T17:23:36.343
> 
> 标签：loops, csv, perl, ldap, control-flow

我正在尝试创建一个脚本来使用 Net::LDAP 使用一些 ldap 查询的结果生成一个 csv 文件，但是如果 @attributes 数组的一个元素为空白，我将无法跳过不完整的行。

```
my @attributes  = ('cn', 'mail', 'telephoneNumber'); 
```

因此，例如，如果用户没有列出邮件或没有列出电话号码，那么它应该跳过保留字段而不是返回：

```
"Foo Bar",, # this line should be skipped since there is no mail nor telephone
"Bar Foo","bar@foo.com", # this line should be skipped too, no number listed
"John Dever","john_dever@google.com","12345657" # this one is fine, has all values 
```

我的循环现在看起来像这样：

```
# Now dump all found entries
while (my $entry = $mesg->shift_entry()){
    # Retrieve each fields value and print it
    # if attr is multivalued, separate each value
    my $current_line = ""; # prepare fresh line
    foreach my $a (@attributes) {
        if ($entry->exists($a)) {
            my $attr = $entry->get_value($a, 'asref' => 1);
            my @values  = @$attr;
            my $val_str = "";
            if (!$singleval) {
                # retrieve all values and separate them via $mvsep
                foreach my $val (@values) {
                    if ($val eq "") { print "empty"; }
                    $val_str = "$val_str$val$mvsep"; # add all values to field
                }
                $val_str =~ s/\Q$mvsep\E$//; # eat last MV-Separator
            } else {
                $val_str = shift(@values); # user wants only the first value
            }

            $current_line .= $fieldquot.$val_str.$fieldquot; # add field data to current line

        }
        $current_line .= $fieldsep; # close field and add to current line
    }
    $current_line =~ s/\Q$fieldsep\E$//; # eat last $fieldsep
    print "$current_line\n"; # print line
} 
```

我试过这样的代码：

```
if ($attr == "") { next; }
if (length($attr) == 0) { next; } 
```

和其他几个没有任何运气。我也尝试过简单的 if () { print "isempty"; 调试测试和它不工作。我不确定我该怎么做。

我很感激你能给我的任何帮助或指示我做错了什么。

非常感谢您的帮助。

**更新：**
每个混乱请求：

```
my $singleval = 0; 
```

此程序的示例运行将返回：

```
Jonathan Hill,Johnathan_Hill@example.com,7883                  
John Williams,John_Williams@example.com,3453                     
Template OAP,,                                            
Test Account,,                                                
Template Contracts,, 
```

所以我想做的是跳过所有缺少字段的行，无论是电子邮件还是分机号码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:28:26.553

标记你的`while`循环：

```
Record: while (my $entry = $mesg->shift_entry()){ 
```

并使用：

```
next Record; 
```

您的问题是您`next`与您的`foreach`. 使用标签可以避免这种情况。

顺便说一句，`$attr == ''`虽然在这种情况下它会起作用，但它的逻辑很糟糕；在 perl 中，`==`是一个数字比较。字符串比较将是`$attr eq ''`. 虽然我只是使用`next Record unless $attr`.

# java - 带有 WTP 的多模块 Maven2 项目

> ID：922138
> 
> 赞同：6
> 
> 时间：2009-05-28T17:23:40.713
> 
> 标签：java, eclipse, maven-2, eclipse-wtp

我很难让具有深层项目结构的 Maven2 多模块项目显示为要部署在我的 JBOSS 5 服务器中的单耳（及其依赖项 - 包括 1 个战争、2 个 ejb 和 1 个 jar）在我的 Eclipse Ganymede（选项卡服务器）中。

我一直在尝试使用 Maven Eclipse 插件将我的项目变成 WTP 项目，但没有成功。因此，它们似乎部署在服务器中，它们显示为单独的项目。

我的项目有 1 个 war、2 个 ejb 和 1 个 jar，必须打包在一个耳朵里，每个“子项目”都是一个单独的模块。

项目的 pom.xml（类型 pom）：

...

```
<modules>
   <module>ejb1</module>
   <module>ejb2</module>
   <module>war</module>
   <module>jar</module>
   <module>ear</module>
</modules> 
```

...

耳机模块只负责将其他模块打包在一起。

有没有办法告诉eclipse（ganymede）所有这些项目（ejbs，war和jar）都在ear模块内，所以我可以在服务器中部署ear？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T19:14:28.350

您想要做的是让 Maven 通过 mvn eclipse:eclipse 创建 Eclipse 项目，[这](http://maven.apache.org/plugins/maven-eclipse-plugin/examples/multi-module-projects.html)可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T19:32:19.610

尝试m2eclipse（google it）并安装WTP集成工具，使用maven向导创建一个项目，在pom xml编辑器中将类型更改为pom，从pom创建一个子模块并将其添加为子模块，如果它是一个网络项目它获得 WTP 行为，即它可以部署到 j2ee 容器（jboss / tomcat），在 web pom 等中为 ejb 模块的 web 模块添加一个 dep，将 web 应用程序部署到容器

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-26T21:06:01.123

使用可选的 WTP 配置安装 m2eclipse 对我有用。我还在我的父 pom 中添加了以下内容，以确保 eclipse 文件中的正确性质和构建器

这会产生准备好用于 m2eclipse 的 eclipse .project 文件。然后我可以使用 m2eclipse 更新项目文件，允许热部署 webapp 及其依赖项

```
<build>
  ...
        <plugin>
    <artifactId>maven-eclipse-plugin</artifactId>
    <version>2.5.1</version>
      <!--
      Eclipse project natures: http: //vikashazrati.wordpress.com/2007/12/22/adding-project-nature-to-your-maven-pomxml/
      Maven-eclipse-plugin: http: //maven.apache.org/plugins/maven-eclipse-plugin/
      -->
      <configuration>
      <additionalProjectnatures>
      <projectnature>org.springframework.ide.eclipse.core.springnature</projectnature>
      <projectnature>org.eclipse.jem.workbench.JavaEMFNature</projectnature>
      <projectnature>org.eclipse.wst.common.modulecore.ModuleCoreNature</projectnature>
      <projectnature>org.eclipse.wst.common.project.facet.core.nature</projectnature>
      <projectnature>org.eclipse.jdt.core.javanature</projectnature>
      <projectnature>org.eclipse.wst.jsdt.core.jsNature</projectnature>
      <projectnature>org.maven.ide.eclipse.maven2Nature</projectnature>
      </additionalProjectnatures>
      <buildcommands>
       <buildcommand>org.eclipse.wst.jsdt.core.javascriptValidator</buildcommand>
       <buildcommand>org.eclipse.jdt.core.javabuilder</buildcommand>
       <buildcommand>org.eclipse.wst.common.project.facet.core.builder</buildcommand>
       <buildcommand>org.eclipse.wst.validation.validationbuilder</buildcommand>
       <buildcommand>org.springframework.ide.eclipse.core.springbuilder</buildcommand>
          <buildcommand>org.maven.ide.eclipse.maven2Builder</buildcommand>

      </buildcommands>
      </configuration>

  </plugin> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-17T11:02:09.653

在超级 pom 项目中使用 maven 或命令行 mvn -Dwtpversion=2.0 的 -Dwtpversion=2.0 参数。我使用 m2eclipse 插件，但在多模块项目中遇到了一些问题。我使用 m2eclipse 插件进行依赖管理。如果我想用超级 pom 清理、安装等所有项目，我会在命令行上进行。项目属性也必须在 eclipse 中检查。项目方面，Java EE 模块依赖项必须检查。你也可以导出到ear项目，但是要小心检查maven模块是否在更改后编译。

# iphone - 将 UITextView 添加为 UIView 中的子视图，然后添加到 UIScrollView

> ID：922140
> 
> 赞同：0
> 
> 时间：2009-05-28T17:23:54.800
> 
> 标签：iphone, cocoa-touch, uiview, uiscrollview, uitextview

我有一个`UIViewController`( `ContentViewController`) 连接到 View xib。我将 a`TextView`放在IB 上`UIView`，它显示为 IB 层次结构中的子视图。
`ContentViewController`有一个标签作为插座，连接到`ContentView.xib`. 当下面的代码执行时，第一个视图显示文本视图，但滚动其他视图/页面仅显示标签。

```
for(int i=0; i< 5; i++){
  ContentViewController *contentView = [[ContentViewController alloc] initWithNibName:@"ContentView" bundle:[NSBundle mainBundle]]; 
  [contentView loadView];
  contentView.theLabel.text =[NSString stringWithFormat:@"hello again..%d", i];
  [self.scrollView addSubview:contentView.view];
} 
```

我可以将按钮或文本字段拖到 IB 中的视图上，当我滚动页面时它们都在那里。上面的文字也设置在标签上。textview 在第一页后消失。我也无法设置它的文本。我已经将一个新的 textview 拖到 上`UIView`，它在第一页之后也消失了。我需要为 textview 做些什么不同的事情吗？

* * *

我发现`UIScrollView`每一页都有。如果我在滚动视图所在的位置垂直滑动，则会出现文本。但是我必须对第一个之后的所有滚动视图都这样做。

但是，一旦我滑动它们，文本仍然可见，直到应用程序重新启动。如果没有足够的文本导致滚动，则 textview 将永远不会出现。对这种行为有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T18:09:31.807

尝试 ：

[textView setNeedsDisplay];

* * *

原始答案

您不必以不同的方式处理 textview。

我首先担心您对“loadview”的调用。你永远不应该直接调用它。它在需要时自动调用。

此外，您应该在循环之前声明 contentview 并且您正在泄漏内存。

您的另一个问题是您永远不会在循环期间更改每个视图的框架。它们的原点都是 {0,0}。据我从您的代码中可以看出。这可能就是您的视图被隐藏的原因。

最后，在风格说明上，我不会称我为视图控制器 XXXXXview，它们应该有控制器这个词。

```
 CGRect frame;
    ContentViewController *myContentViewController = nil;

    for(int i=0; i< 5; i++){
      myContentViewController = [[myContentViewController alloc] initWithNibName:@"ContentView" bundle:[NSBundle mainBundle]];

      frame = myContentViewController.view.frame;
      frame.origin.x=(frame.size.width*i);
      myContentViewController.view.frame=frame; 

      myContentViewController.theLabel.text =[NSString stringWithFormat:@"hello again..%d", i];
      [self.scrollView addSubview: myContentViewController.view];
      [myContentViewController release];
    } 
```

* * *

要添加：还要检查滚动视图 contentView 框架属性：

```
scrollView.contentSize = CGSizeMake(numberOfContentViews*contentViewWidth, contentViewHeight); 
```

* * *

要添加更多：

尝试以编程方式在 viewDidload 或 viewDidAppear 中添加 textView 以查看是否有效。

在您发表评论之后，如果我不得不再次猜测，我会说您可能在添加 textView 后在代码中的其他地方操作它。开始注释掉任何影响 textView 的行，看看会发生什么。

# python - 如何使用此页面上的表格使机械化不失败？

> ID：922148
> 
> 赞同：4
> 
> 时间：2009-05-28T17:25:21.333
> 
> 标签：python, automation, screen-scraping, mechanize

```
import mechanize

url = 'http://steamcommunity.com'

br=mechanize.Browser(factory=mechanize.RobustFactory())

br.open(url)
print br.request
print br.form
for each in br.forms():
    print each
    print 
```

上面的代码导致：

```
Traceback (most recent call last):
  File "./mech_test.py", line 12, in <module>
    for each in br.forms():
  File "build/bdist.linux-i686/egg/mechanize/_mechanize.py", line 426, in forms
  File "build/bdist.linux-i686/egg/mechanize/_html.py", line 559, in forms
  File "build/bdist.linux-i686/egg/mechanize/_html.py", line 228, in forms
mechanize._html.ParseError 
```

我的具体目标是使用登录表单，但我什至无法机械化来识别有任何表单。*即使使用我认为是选择任何* 形式的最基本方法，也会`br.select_form(nr=0)`导致相同的回溯。表单的 enctype 是 multipart/form-data 如果有区别的话。

我想这一切都归结为一个两部分的问题：我怎样才能让机械化来处理这个页面，或者如果不可能，在维护 cookie 的同时还有什么方法？

编辑：如下所述，这将重定向到“ [https://steamcommunity.com](https://steamcommunity.com) ”。

Mechanize 可以成功检索 HTML，如下代码所示：

```
url = 'https://steamcommunity.com'

hh = mechanize.HTTPSHandler()  # you might want HTTPSHandler, too
hh.set_http_debuglevel(1)
opener = mechanize.build_opener(hh)
response = opener.open(url)
contents = response.readlines()

print contents 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-05-07T12:11:30.647

使用这个秘密，我相信这对你有用；）

```
br = mechanize.Browser(factory=mechanize.DefaultFactory(i_want_broken_xhtml_support=True)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T17:38:11.137

您是否提到该网站正在重定向到 https (ssl) 服务器？

好吧，尝试像这样设置一个新的 HTTPS 处理程序：

```
mechanize.HTTPSHandler() 
```

# ruby - 如何在 Ruby 中将整行输入转换为整数？

> ID：922151
> 
> 赞同：0
> 
> 时间：2009-05-28T17:25:31.457
> 
> 标签：ruby

我想像这样给 Ruby 提供整数输入：

```
12 343 12312 12312 123123 231
12 343 12312 12312 123123 243
12 343 12312 12312 123123 2123 
```

这整件事应该被当作一个数字，这样我就可以对它们进行排序，如果有任何重复的数字，我想打印它们。整行应被视为整数，以便与其他行进行比较。我无法将输入转换为一个整数，对于这些行中的每一行它都给了我 12。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T17:35:42.997

如果您希望全部作为一个数字，只需使用：

```
input.gsub(/\s/,'').to_i 
```

如果你想要一个整数数组，请使用

```
input.split.map{|i| i.to_i} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:41:50.270

这将继续接受输入行，删除所有空格，将其转换为数字，并将它们添加到数组中：

```
numbers = []
STDIN.each_line do |line|
  numbers << line.gsub(/\s+/, '').to_i
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:41:43.693

以下代码段将分别获取每个数字并打印出任何重复项。要检查每一行而不是单个数字，请取消注释多余的行。

```
str = <<STRING
12 343 12312 12312 123123 231
12 343 12312 12312 123123 243
12 343 12312 12312 123123 2123
STRING

nums = str.split(/\s/m).collect {|i| i.to_i}
#nums = str.gsub(/ /,'').collect {|i| i.to_i}

uniq_nums = nums.uniq.sort

uniq_nums.each do |uniq|
  puts uniq if nums.find_all {|num| uniq == num}.length > 1
end 
```

回报：

```
12
343
12312
123123 
```

# java - Hibernate 从 createCriteria() 结果获取 Id

> ID：922154
> 
> 赞同：2
> 
> 时间：2009-05-28T17:25:47.040
> 
> 标签：java, hibernate

我有一个方法，它需要一个实体列表（`Class`es）并进行一些计算。在这里描述我的需求是方法的最简单的概述（伪代码）：

```
public void do(List<Class<?> entities) {
    for (Class<?> entity : entities) {
        List<?> list = session.createCriteria(entity).list();
        for (Object o : list) {
            System.out.println(o.getClass().getSimpleName() + " " + o.getId());
        }
    }
} 
```

有没有办法可以访问/获取的 ID **`o`**？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T17:59:07.863

```
session.getIdentifier(o) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:52:26.817

好吧，也许它会受到很多批评，但你所有的实体类都可能实现这个接口：

```
public interface EntityWithId {
    Integer getId();
    void setId(Integer id);
} 
```

如果您的 id 不是整数，则接口可能是：

```
public interface EntityWithId<T> {
    T getId();
    setId(T id);
}

public class Entity implements EntityWithId<String> {
    private String id;

    public String getId() {
        return id;
    }
    public void setId(String id) {
        this.id = id;
    }
    .
    .
    .
} 
```

无论如何，我不明白您为什么要获取所有实体的 ID，对于一个奇怪的要求，这是一个奇怪的解决方案，呵呵。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:34:31.937

除非您在所有实体上都具有相同名称的属性，否则您可以使用反射来调用该属性的 getter。如果它们都被命名为不同的东西，那么你会得到一个`NoSuchMethodException`

# asp.net - 对 Web 服务的 Jquery Ajax 调用失败

> ID：922160
> 
> 赞同：2
> 
> 时间：2009-05-28T17:28:07.303
> 
> 标签：asp.net, jquery, ajax, web-services

任何人都可以帮忙吗？我从 jquery 调用 asp.net webservice 时遇到问题。实际上我认为它可能是 jquery ......因为我有一个断点并且它没有到达 webservice..

这是我的 jquery，webservice 方法接受 2 个参数...

因此，我设置了一个简单的测试以通过 7 和 7 .. 我也尝试用“测试”一词替换它，但它不起作用..

基本上落在显示“抱歉错误发生”但错误未定义的错误函数中。

```
jQuery.ajax({
            type: 'POST'
            , url: 'CallService.asmx/TempCanMakeCall'
            , contentType: 'application/json; charset=utf-8'
            , dataType: "json"
            , data: "{'reservationNum':'7','completedReservationNum':'7'}"
            , success: function(data, status) {
                alert(data);
            }
            , error: function(xmlHttpRequest, status, err) {
                alert('Sorry! Error happens.' + err);
            }
    }
        ); 
```

这是 asp.net 网络服务

```
[WebMethod()]
    public bool TempCanMakeCall(string reservationNum, string completedReservationNum )
    {

            return true;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T19:53:08.617

在处理 jQuery AJAX 错误时，xmlHttpRequest.responseText 一直是我的首选。

尝试使您的 ASP.NET 函数静态：

```
[WebMethod()]
public static bool TempCanMakeCall(string reservationNum, string completedReservationNum )
{

        return true;
} 
```

另请注意，返回的 JSON 值封装在名为“d”（特定于 ASP.NET）的对象中。要在成功时显示返回值，您需要执行以下操作：

```
success: function(data, status) {
            alert(data.d);
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:34:28.053

jquery ajax 调用看起来不错。我认为您需要确保“CallService.asmx”的路径正确。现在的方式是，只有在进行 jQuery 调用的文件与 ASMX 位于同一虚拟目录中时，我才会工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:42:05.107

在您的错误回调函数中，您可以检查“xmlHttpRequest.status”以获取从服务器返回的 http 代码。这可能会给你另一个线索。如果上面的 ichiban 是正确的，它应该是 404。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T17:45:52.023

你可以查一下`xmlHttpRequest.responseText`楼盘。响应文本很可能是服务器返回的包含错误原因的 html 文档。

如果您使用的是 Visual Studio，您还可以在 Internet Explorer 中启用脚本调试，并在错误函数中输入以下关键字：`debugger`. 浏览器将此视为断点，并将调用调试器（应该是 Visual Studio）。现在您可以检查`xmlHttpRequest`实例的全部内容。

为清楚起见，您的错误函数将如下所示：

```
function(xmlHttpRequest, status, err)
{
    debugger;
    ...rest of your function...
} 
```

# entity-framework - 是否可以在实体框架中的表和视图之间建立关联？

> ID：922180
> 
> 赞同：0
> 
> 时间：2009-05-28T17:31:22.927
> 
> 标签：entity-framework

我的系统中有 2 个数据库（sql server 2005），一个用于配置数据，另一个用于应用程序数据，但是两个数据库中都需要一些表。我们已经使用同义词解决了这个问题，但问题是当我们在实体框架中映射表时。我们在配置数据库中有一个语言表，用于本地化目的。但在应用程序中，我们有一个名为“Countries”的表，它有一个子表来包含已翻译的国家/地区字段。我的实体框架上下文映射应用程序数据库中的表，从其他数据库映射语言表的唯一方法是包括在应用程序数据库中创建的视图。一切正常，但是当我尝试在 CountryTranslation 实体和 Language 实体之间建立关联时，我得到了这个异常：

```
Problem in Mapping Fragments starting at lines 733, 855: Non-Primary-Key column(s) [pai_codlan] are being mapped in both fragments to different conceptual side properties - data inconsistency is possible because the corresponding conceptual side properties can be independently modified. 
```

你知道这是否是一种可能的情况吗？我该如何解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T17:48:56.683

解决了！我所要做的就是删除映射为实体属性的列，只保留导航属性..

# ruby-on-rails - 为什么在多态关联中不能有外键？

> ID：922184
> 
> 赞同：84
> 
> 时间：2009-05-28T17:32:39.180
> 
> 标签：ruby-on-rails, database, foreign-key-relationship, polymorphic-associations

为什么在多态关联中不能有外键，比如下面的 Rails 模型？

```
class Comment < ActiveRecord::Base
  belongs_to :commentable, :polymorphic => true
end

class Article < ActiveRecord::Base
  has_many :comments, :as => :commentable
end

class Photo < ActiveRecord::Base
  has_many :comments, :as => :commentable
  #...
end

class Event < ActiveRecord::Base
  has_many :comments, :as => :commentable
end 
```

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2009-05-28T17:59:42.730

外键只能引用一个父表。这是 SQL 语法和关系理论的基础。

多态关联是指给定列可以引用两个或多个父表中的任何一个。您无法在 SQL 中声明该约束。

多态关联设计打破了关系数据库设计的规则。我不建议使用它。

有几种选择：

*   **独占弧：** 创建多个外键列，每个都引用一个父项。强制这些外键中的一个可以是非空的。

*   **反转关系：** 使用三个多对多表，每个表引用 Comments 和各自的父级。

*   **具体** 超表：创建每个父表引用的真实表，而不是隐含的“可注释”超类。然后将您的评论链接到该超级表。伪 Rails 代码类似于以下内容（我不是 Rails 用户，因此将其视为指南，而不是文字代码）：

    ```
    class Commentable < ActiveRecord::Base
      has_many :comments
    end

    class Comment < ActiveRecord::Base
      belongs_to :commentable
    end

    class Article < ActiveRecord::Base
      belongs_to :commentable
    end

    class Photo < ActiveRecord::Base
      belongs_to :commentable
    end

    class Event < ActiveRecord::Base
      belongs_to :commentable
    end 
    ```

我还在我的演讲[Practical Object-Oriented Models in SQL](http://www.slideshare.net/billkarwin/practical-object-oriented-models-in-sql)和我的书[SQL Antipatterns: Avoiding the Pitfalls of Database Programming](http://pragprog.com/book/bksqla/sql-antipatterns)中介绍了多态关联。

* * *

回复您的评论：是的，我知道还有另一列记录了外键应该指向的表的名称。SQL 中的外键不支持这种设计。

例如，如果您插入评论并将“视频”命名为父表的名称，会发生`Comment`什么？不存在名为“视频”的表。插入是否应该因错误而中止？违反了什么约束？RDBMS 如何知道该列应该命名现有表？它如何处理不区分大小写的表名？

同样，如果您删除`Events`表，但其中的行将`Comments`事件指示为其父级，那么结果应该是什么？丢弃表应该被中止吗？应该`Comments`孤立行吗？他们是否应该更改以引用另一个现有表，例如`Articles`？在指向 时，曾经指向的 id 值是否`Events`有意义`Articles`？

这些困境都是因为多态关联依赖于使用数据（即字符串值）来引用元数据（表名）。SQL 不支持此功能。数据和元数据是分开的。

* * *

> 我很难理解你的“混凝土超级表”提案。

*   定义`Commentable`为真正的 SQL 表，而不仅仅是 Rails 模型定义中的形容词。不需要其他列。

    ```
    CREATE TABLE Commentable (
      id INT AUTO_INCREMENT PRIMARY KEY
    ) TYPE=InnoDB; 
    ```

*   将表`Articles`、`Photos`和定义`Events`为 的“子类” `Commentable`，方法是使它们的主键也是引用的外键`Commentable`。

    ```
    CREATE TABLE Articles (
      id INT PRIMARY KEY, -- not auto-increment
      FOREIGN KEY (id) REFERENCES Commentable(id)
    ) TYPE=InnoDB;

    -- similar for Photos and Events. 
    ```

*   `Comments`用外键定义表`Commentable`。

    ```
    CREATE TABLE Comments (
      id INT PRIMARY KEY AUTO_INCREMENT,
      commentable_id INT NOT NULL,
      FOREIGN KEY (commentable_id) REFERENCES Commentable(id)
    ) TYPE=InnoDB; 
    ```

*   当您想创建一个`Article`（例如）时，您也必须在其中创建一个新行`Commentable`。对于`Photos`和也是如此`Events`。

    ```
    INSERT INTO Commentable (id) VALUES (DEFAULT); -- generate a new id 1
    INSERT INTO Articles (id, ...) VALUES ( LAST_INSERT_ID(), ... );

    INSERT INTO Commentable (id) VALUES (DEFAULT); -- generate a new id 2
    INSERT INTO Photos (id, ...) VALUES ( LAST_INSERT_ID(), ... );

    INSERT INTO Commentable (id) VALUES (DEFAULT); -- generate a new id 3
    INSERT INTO Events (id, ...) VALUES ( LAST_INSERT_ID(), ... ); 
    ```

*   当您要创建 时`Comment`，请使用 中存在的值`Commentable`。

    ```
    INSERT INTO Comments (id, commentable_id, ...)
    VALUES (DEFAULT, 2, ...); 
    ```

*   当你想查询给定的评论时`Photo`，做一些连接：

    ```
    SELECT * FROM Photos p JOIN Commentable t ON (p.id = t.id)
    LEFT OUTER JOIN Comments c ON (t.id = c.commentable_id)
    WHERE p.id = 2; 
    ```

*   当您只有评论的 id 并且您想找到它是评论的可评论资源时。为此，您可能会发现 Commentable 表指定它引用的资源很有帮助。

    ```
    SELECT commentable_id, commentable_type FROM Commentable t
    JOIN Comments c ON (t.id = c.commentable_id)
    WHERE c.id = 42; 
    ```

    `commentable_type`然后，在发现要加入哪个表之后，您需要运行第二个查询以从相应的资源表（照片、文章等）中获取数据。您不能在同一个查询中执行此操作，因为 SQL 要求显式命名表；您无法加入由同一查询中的数据结果确定的表。

诚然，其中一些步骤打破了 Rails 使用的约定。但是在正确的关系数据库设计方面，Rails 约定是错误的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-11-08T15:22:36.653

Bill Karwin 是正确的，外键不能与多态关系一起使用，因为 SQL 没有真正的原生概念多态关系。但是，如果您拥有外键的目标是强制引用完整性，您可以通过触发器来模拟它。这得到了特定的数据库，但下面是我最近创建的一些触发器，用于模拟多态关系上外键的级联删除行为：

```
CREATE FUNCTION delete_related_brokerage_subscribers() RETURNS trigger AS $$
  BEGIN
    DELETE FROM subscribers
    WHERE referrer_type = 'Brokerage' AND referrer_id = OLD.id;
    RETURN NULL;
  END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER cascade_brokerage_subscriber_delete
AFTER DELETE ON brokerages
FOR EACH ROW EXECUTE PROCEDURE delete_related_brokerage_subscribers();

CREATE FUNCTION delete_related_agent_subscribers() RETURNS trigger AS $$
  BEGIN
    DELETE FROM subscribers
    WHERE referrer_type = 'Agent' AND referrer_id = OLD.id;
    RETURN NULL;
  END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER cascade_agent_subscriber_delete
AFTER DELETE ON agents
FOR EACH ROW EXECUTE PROCEDURE delete_related_agent_subscribers(); 
```

在我的代码中，`brokerages`表中的记录或表中的记录`agents`可以与表中的记录相关`subscribers`。

# c# - 等待事件时阻塞

> ID：922190
> 
> 赞同：1
> 
> 时间：2009-05-28T17:34:19.613
> 
> 标签：c#, multithreading, events

我有一个外部 COM 对象，它连接到服务器，然后在服务器准备好时触发一个事件。connect() 调用因此是异步的。

我的代码看起来（有点……）像

```
ManualResetEvent waitConnection;

//This is the event that is triggered when server is ready
public void onConnection_event(bool success)
{
    if(success)
        waitConnection.Set();
}

private string getItem(string itemName)
{
    //MYDBCom is a win32 com if that makes any difference
    MYDBCom myDBobject = new MYDBCom();
    waitConnection = new ManualResetEvent(false);
    myDBobject.connect();              //asynchron call.

    //wait until server triggers the onConnection_event
    waitConnection.WaitOne();
    //server is now ready. Get the data from the server.
    return myDBobject.getItem(itemName);
} 
```

问题是该事件没有被触发 - 它似乎在 WaitOne 中等待时被阻止。如果我不使用 waitOne 使用

```
 while(!connected)
    {
        Sleep(100);
        DoEvents();
    } 
```

事件被触发。

任何想法为什么 WaitOne 阻塞？还有其他建议如何等待事件触发吗？

//弗雷德里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:39:00.183

因为事件的消息泵与您的 WaitOne 调用位于同一线程上。该线程正在等待，因此不会在您的消息周围抽水。

### 更新

我应该补充一点，使用`DoEvents()`通常不是一个可取的解决方案。通常有更好的方法来处理这种情况，例如从当前线程的消息泵之外的不同线程触发事件，这样您的当前线程就不需要为触发事件处理程序而运行。

# asp.net - 在办公室自动化纸质表格和流程

> ID：922197
> 
> 赞同：2
> 
> 时间：2009-05-28T17:34:55.277
> 
> 标签：asp.net, forms, workflow, infopath

我的任务是自动化 HR 中的一些纸质表格。这最终可能会变成“自动化所有形式”，所以我想以一种最适合长期的方式来解决这个问题，并且随着项目的发展，这将是一个很好的框架。

首先想到的是：

-InfoPath/SharePoint（我们目前不使用 SharePoint，未来两年也不会选择。）

-Workflow Foundation（我已经对此进行了研究，但似乎不太吸引人或不合适）

我现在正在考虑的选项：

- 自定义 ASP.NET (VB.NET) 和 SQL Server，这是我的团队编写应用程序时最常使用的。- 利用 Infopath 以电子方式创建表单。想知道是否有一种将其与自定义构建的 ASP.NET 应用程序集成的好方法。-考虑将应用程序创建为 MVC Web 应用程序。

我的问题是这样的：

-还有其他我可能想要考虑的选择吗？- 那里是否有任何入门工具包或基于 VB.NET 的开源项目可以作为起点或可以用作很好的参考。这里我主要关心的是工作流处理。- 那些走这条路的人有什么意见吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T17:39:54.487

这听起来真的很愚蠢，但在我多年来帮助公司自动化基于纸质表单的流程的过程中，首先要了解该流程。你很可能会发现没有一个人能理解整个事情。您将需要通过角色扮演许多路径来了解它。一旦你展示你的发现，每个人都会感到震惊，因为他们不知道它是如此复杂。以此为契机进行精简。

自动化一个破碎的过程只会让它更快地搞砸并告诉很多人。

就工具而言，我的经验与我约会，但尝试使用具有这些属性的东西：

*   容易改变。你会改变它。所以不要硬编码任何东西。
*   可能的修订控制 - 对流程的更改可能会或可能不会影响已经在路由中的文档？
*   可视化工作流程编辑。每个人都想要这个，但他们都会要求你驾驶它。不过，不错的工具。

不确定这是否有帮助 - 但自动化流程中 80% 的成功都不是技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:05:30.490

正如 n8owl 提醒我们的那样，**自动化混乱会产生自动化混乱**——这并不是一种改进。许多纸质表格系统已经发展了*几十年*，并且可能非常多余和不守规矩。有些人可能会认为“弄乱表格”是对他们个人领地的侵犯，所以要小心；-)

1.  根据谁在什么角色出于什么目的使用的形式对工作流程进行建模；这将当前流程记录为基线。估计每个步骤需要多长时间，包括工时和日历时间
2.  *从收集、生成和传输*的信息方面了解工作流程
**   将表格上的信息整合到一组新的表格中，以实现最小的工作流程*   准备好被告知“这是我们一直这样做的方式，我们不会改变”，并温和地（a）验证他们的感受，（b）解释更少的工作如何更有效率，以及（c ) 显示具体的好处 [与步骤 1 的基线相比]*   尽可能的软代码；尽可能使用处理规则；如果您有 Intranet，Web 服务和 html 表单（尤其是 w/jquery）将大有帮助*   谨防罐装包（包括 sharepoint），除非您绝对确定它们包含您组织当前和未来的需求*

 *祝你好运！

--S

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T17:52:12.450

这有点离题，但相关 - 缺陷跟踪系统通常具有工作流引擎/状态。（事实上​​，我认为 Joel 或其他一些 FC 员工发布了一些关于使用 FB 管理初始电子邮件和简历流程的内容）

在进行任何编码或技术选择之前，我支持关于建模工作流的其他建议。您还希望这是灵活的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-06T20:24:00.510

对于基于工作流的方法，我在这里发现了一种普遍的谨慎态度，并且必须同意。请[注意大多数工作流技术的注意事项，这些技术会牺牲可用性以换取灵活性](http://it.toolbox.com/blogs/future-of-work/the-procrustean-bed-of-workflow-32091)。

# python - 哪个进程负责由 inotify 发出的事件信号？

> ID：922200
> 
> 赞同：3
> 
> 时间：2009-05-28T17:35:09.317
> 
> 标签：python, inotify, pyinotify

我`pyinotify`用来检测给定目录中文件的访问、更改等。有没有一种更简单的方法可以找出是哪个进程造成的——而不必打[补丁`inotify`](http://lkml.indiana.edu/hypermail/linux/kernel/0603.1/0166.html)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-22T07:08:21.293

假设您在 Linux 上（pyinotify 倾向于表明这一点），您可以使用 SELinux（当然以许可模式运行）来包装一个进程并记录其所有文件访问/创建/删除/等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-20T11:05:19.210

不，您不能，该信息不在`struct inotify_event`内核发送的范围内。

实际上，当您收到事件时，并不能保证负责的进程仍在运行。

# asp.net - 具有自定义角色的 ASP.NET Windows 身份验证

> ID：922202
> 
> 赞同：4
> 
> 时间：2009-05-28T17:35:33.230
> 
> 标签：asp.net

如果我在 ASP.NET 应用程序中使用 Windows 身份验证，并且我想使用自定义角色而不是使用 Windows 安全组作为角色，我是否需要编写自定义角色提供程序？该解决方案需要能够将 Windows 用户和组映射到应用程序特定角色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:45:53.723

如果我理解您的问题 - 不，您不需要使用 Active Directory 安全组中的角色作为 ASP.NET 应用程序的角色。而且您不需要实现自定义角色提供程序。默认的只是从 ASP.NET 应用程序数据库中检索角色。

您可以简单地在此数据库中使用应用程序定义的角色，使用`aspnet_regsql.exe`实用程序创建（在 .NET 2.0 框架文件夹中）。

可能是关于这个主题的最大资源/信息集合： [http ://weblogs.asp.net/scottgu/archive/2006/02/24/ASP.NET-2.0-Membership_2C00_-Roles_2C00_-Forms-Authentication_2C00_-and-Security-资源-.aspx](http://weblogs.asp.net/scottgu/archive/2006/02/24/ASP.NET-2.0-Membership_2C00_-Roles_2C00_-Forms-Authentication_2C00_-and-Security-Resources-.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T17:18:44.237

实际上，您可以使用内置的`ASP.NET`安全配置网站。您必须暂时切换到互联网模式，然后您可以添加用户`DOMAIN\username`作为用户名，输入一些密码（切换回来后将不再使用），然后您可以将这些分配给角色。一旦您切换回 Windows 模式，这些用户将被自动使用。

# c++ - 更改过滤器时 GetOpenFileName() 不刷新

> ID：922204
> 
> 赞同：0
> 
> 时间：2009-05-28T17:35:36.973
> 
> 标签：c++, c, winapi, dialog

我[`GetOpenFilename()`](http://msdn.microsoft.com/en-us/library/ms646927(VS.85).aspx)用来让用户选择一个文件。这是代码：

```
 wchar_t buffer[MAX_PATH] = { 0 };

  OPENFILENAMEW open_filename = { sizeof (OPENFILENAMEW) };

  open_filename.hwndOwner   = handle_;
  open_filename.lpstrFilter = L"Video Files\0*.avi;*.mpg;*.wmv;*.asf\0"
                              L"All Files\0*.*\0";
  open_filename.lpstrFile   = buffer;
  open_filename.nMaxFile    = MAX_PATH; 
  open_filename.lpstrTitle  = L"Open media file...";
  open_filename.Flags       = OFN_FILEMUSTEXIST | OFN_HIDEREADONLY;

  ::GetOpenFileNameW(&open_filename); 
```

文件对话框出现了，但是当我

*   更改过滤器或
*   点击“*我的电脑*”

文件列表变为空。按下`[F5]`没有帮助，但如果我切换到父文件夹并返回到原始文件夹（在过滤器更改的情况下），过滤工作正常并且文件显示在列表中。

**编辑：**我的系统是 Windows XP (SP3) 32 位 - 没什么特别的。它也发生在具有相同配置的其他机器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T07:49:30.747

您尚未完成的可能导致问题的一件事是完全初始化 OPENFILENAMEW 结构，尤其是 lStructSize 元素。我以前见过这会引起奇怪的影响。我建议有类似的东西

```
 OPENFILENAMEW open_filename = { sizeof (OPENFILENAMEW) };
  ZeroMemory(&open_filename, sizeof (OPENFILENAMEW));
  open_filename.lStructSize = sizeof (OPENFILENAMEW); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T20:48:20.027

好的，我已经解决了问题，或者至少，我有一个适合我的解决方案。

在代码的前面，我有以下调用来初始化 COM...

```
::CoInitializeEx(NULL, COINIT_MULTITHREADED); 
```

嗯，把这个改成...

```
::CoInitializeEx(NULL, COINIT_APARTMENTTHREADED); 
```

...为我解决了问题！现在文件对话框再次过滤。

我在网上搜索了这个，似乎很少有人面临同样的问题，但没有人发布上述解决方案。谁能验证我的发现？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-02T04:29:01.797

谢谢你，beef2k。有用。但我的问题有一点不同。在我添加 SHBrowseForFolder 调用之前，一切正常。从那一刻起，我得到了同样的效果。但是添加 CoInitializeEx(NULL, COINIT_APARTMENTTHREADED); 解决了这个问题。

# c# - 如何制作一个在 Windows 中不可能被杀死的程序？

> ID：922207
> 
> 赞同：7
> 
> 时间：2009-05-28T17:36:19.703
> 
> 标签：c#, .net, windows, process

我们正在为我们公司的内部使用制作一个 Jabber 客户端，并且我们需要以某种方式捕捉用户试图杀死程序以实际重新启动它的时刻，或者只是让用户无法杀死客户端。

这可能吗？

我们的 Jabber 客户端将使用 C# 编写。

我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-28T17:46:14.800

你所要求的意义远远超出你被要求完成的。比如进程不能被杀死，Windows如何正常关机？

我不认识你的老板，所以你必须自己衡量他们的理解程度。如果用户/经理问我这个问题，我将不得不更深入地了解他们的真正含义。我怀疑您的用户希望默认关闭行为最小化到系统托盘而不是退出程序，类似于大多数即时消息客户端，而不是根本无法关闭程序。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-05-28T17:41:12.657

首先让我说，这是一个可怕的想法。

但是......如果你必须这样做，我看到恶意软件和垃圾邮件猎犬这样做的方式是创建 3 个正在运行的进程，一个是主进程，另外两个将监视并重新启动任何被杀死的进程。普通用户很难同时杀死 3 个进程。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-05-28T17:41:24.233

听起来像病毒。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-28T17:41:52.407

由于这是内部的，您可以创建一个单独的 Windows 服务来监视活动进程。如果您的 jabber 客户端的进程不存在，您可以重新启动它。

然后使用权限来阻止他们访问 Windows 服务来禁用它。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-28T17:57:17.790

我认为你应该去问需求设计师他们所说的无法“杀死”的应用程序是什么意思。他们在用“杀”这个词做什么？

*   不允许用户关闭他们的程序
    *   防止在窗口中标准使用 X 按钮？
    *   最小化到任务托盘？
    *   不允许他们在任务管理器中关闭应用程序？
*   不允许操作系统关闭他们的程序

这个需求很模糊，我会去和需求设计师/老板谈谈，以更好地了解他们想要什么。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-28T17:38:35.300

这不仅听起来是个坏主意（这对您的用户来说是虐待），而且您将无法阻止用户终止进程本身。

您必须运行两个单独的进程 - 一个运行应用程序，第二个监控第一个进程并在必要时重新启动它。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-28T17:41:28.897

你不能。你可以让它变得更难，但并非不可能。请参阅[程序和用户之间的军备竞赛](http://blogs.msdn.com/oldnewthing/archive/2004/02/16/73780.aspx)。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-28T17:39:43.770

您必须减少他们的用户权限，直到他们无法杀死进程。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-28T17:39:44.813

使用 Windows 服务对其进行控制。在 C# 中很容易做到。锁定权限以停止服务。

注意：我认为“这是不可能/可怕/邪恶”的答案可能没有抓住你的意思。服务是专门设计的“继续前进”，这就是您要问的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-28T18:59:41.580

更重要的是，你为什么要重写一个 jabber 客户端，而像 Miranda 和 Pidgin 这样的好客户端已经存在？如果它用于日志记录，您可以轻松地在 Jabber 服务器上执行该服务器端，而不依赖于客户端。

如果是为了阻止其他 IM 服务，强大的防火墙规则将有助于阻止这种情况（但它不会阻止超级天才通过 https 将 AIM+Gtalk 代理到他们的家庭服务器）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-28T17:42:34.277

您可以使用处理程序捕获大多数信号，SIGKILL 除外。

您可以创建一个监视程序窗口进程，以在应用程序终止时重新生成应用程序。

如果您愿意，您可以将此过程命名为听起来像“sysmon”的非常无害的名称，这样它看起来就不会那么粗略。

我确实希望这是对工作的要求，而不是你导致人类垮台的方式。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-28T17:45:57.017

听起来您可以访问 jabber 客户端。你能用它的状态和启动时间让它轮询到一个单独的位置吗？您并没有禁用杀死它的能力……但至少您可以跟踪它并从那里做出响应。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-28T18:15:05.537

这不应该由您的桌面组控制吗？我们在一些信息亭中安装了 PC，允许员工检查个人电子邮件和资料（Gmail、Yahoo、Hotmail 等），并且这些 PC 上的用户权限不允许用户终止进程。

如果 IE 锁定有点烦人，但我可以理解其中的原因。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-28T18:19:08.057

听起来像这样的一个[案例](http://blogs.msdn.com/oldnewthing/archive/2003/09/03/54760.aspx)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-06-23T01:26:01.167

承诺暂停杀死您的~~流量记录器~~Jabber 客户端的用户？

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-28T17:47:34.517

我同意这是一个**糟糕的主意**。

话虽如此，您将创建**两个程序**（可能是**windows services**）。这两个程序将相互监视并充当客户端。您将需要两个进程都可以访问的**共享内存**来同步哪些客户端处理传入的请求。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-03-07T05:38:00.620

1.  您可以阻止用户通过 GPO 运行 TaskManager。
2.  您可以将应用程序创建为 Windows 服务并防止用户手动终止任务（只能从 services.msc 中终止）
3.  试着绑住他们的手:-)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-02-25T17:32:02.160

转到操作并进行表单关闭事件并在 c# 中键入 e.cancel = true;

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2016-04-14T15:26:28.210

除非您真的在编写病毒，否则您应该能够阻止他们使用权限杀死进程的能力。假设他们都是域用户，而您是管理员。

我想在某些情况下您会想要这样做。您不希望用户制造安全漏洞。我无法在我的工作计算机上退出或更改诺顿端点的任何设置，它还没有打扰我。

但是，如果所有用户都是他们机器上的管理员，并且您想让它无法关闭，并且可能无法从安全制作和删除中开始……那么您会问：“我如何编写恶意软件？”

# git - 无法将 master 推送到 Github -“origin”似乎不是 git 存储库/权限被拒绝

> ID：922210
> 
> 赞同：84
> 
> 时间：2009-05-28T17:36:45.367
> 
> 标签：git, version-control, push

这个问题与我在[理解 rebase, branch 和 merge](https://stackoverflow.com/questions/904353/unable-to-understand-git-branch-merge-and-rebase/907799#907799)方面的问题有关，并且与问题有关

> 当您的远程列表中有一个 teamMate 时，您如何提交到您的 github 帐户？

我发现[其他人](http://ubuntuforums.org/showthread.php?t=850161)也有同样的问题。该问题似乎与 /etc/xinet.d/ 有关。

**问题：**无法将我的本地分支推送到我在 Github 的主分支

我跑

```
git push origin master 
```

我明白了

```
fatal: 'origin' does not appear to be a git repository
fatal: The remote end hung up unexpectedly 
```

错误消息提示我分支 'origin' 不在我的本地 git 存储库中。这样，Git 就会停止连接到 Github。

这很奇怪，因为我没有删除分支“原点”。

我的 git 树是

```
 dev
* master
  ticgit
  remotes/Math/Math
  remotes/Math/master
  remotes/origin/master
  remotes/Masi/master 
```

**当您在本地 Git 中有一个 teamMate 的分支时，**如何将您的本地分支推送到 Github ？****

 *** * *

VonC 的回答解决了主要问题。我给我的 ssh 密钥设置了密码。

我跑

```
$git push github master 
```

我明白了

```
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

看来我需要以某种方式为 Git 提供密码。

**你如何让 Github 询问你的密码而不是依赖 ssh 密钥？**

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-05-28T18:27:27.213

做什么

```
$ git config --get-regexp '^(remote|branch)\.' 
```

返回（在您的 git 存储库中执行）？

Origin 只是引用远程 Git 存储库的默认命名约定。

如果它不引用 GitHub（而是指向您的队友存储库的路径，该路径可能不再有效或可用），只需添加另一个来源，就像在这个[Bloggitation 条目中一样](http://blog.zhekov.net/2008/2/21/second-git-origin/)

```
$ git remote add origin2 git@github.com:myLogin/myProject.git
$ git push origin2 master 
```

（我实际上会使用名称“github”而不是“origin”或“origin2”）

* * *

> 权限被拒绝（公钥）。
> 致命：远端意外挂断

检查您的 gitHub 身份是否在您的本地 Git 存储库中正确声明，如[GitHub 帮助指南中所述](http://github.com/guides/tell-git-your-user-name-and-email-address)。（user.name 和 github.name -- 和 github.token）

然后，[stonean 博客](http://blog.stonean.com/2008/04/17/github-and-public-key/)建议（就像[Marcio Garcia](http://blog.mangar.com.br/?p=67)一样）：

```
$ cd ~/.ssh
$ ssh-add id_rsa 
```

[Aral Balkan](http://aralbalkan.com/1778)补充说：**创建一个配置文件**

> 解决方案是在 ~/.ssh/ 下创建一个配置文件，如[本页 OS X 部分底部所述](http://github.com/guides/providing-your-ssh-key#macosx)。
> 
> 这是我根据页面上的说明添加的文件，我的推送再次开始工作：

```
Host github.com
User git
Port 22
Hostname github.com
IdentityFile ~/.ssh/id_rsa
TCPKeepAlive yes
IdentitiesOnly yes 
```

您也可以发布结果

```
ssh -v git@github.com 
```

了解有关 GitHub ssh 连接拒绝您的原因的更多信息。

还要检查您是否正确输入了您的公钥（它需要以 ' `==`' 结尾）。
不要粘贴您的私钥，而是您的公共密钥。公钥看起来像：

```
ssh-rsa AAAAB3<big string here>== tek...@gmail.com 
```

（注意：您是否为您的 ssh 密钥使用了密码？没有密码会更容易）

还要检查推送时使用的 url ( `git@github.com/...`, not `git://github.com/...`)

检查您是否有 SSH 代理来使用和缓存您的密钥。

试试这个：

```
 $ ssh -i path/to/public/key git@github.com 
```

如果可行，则意味着您的 ssh 客户端未将您的密钥发送到 GitHub。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-28T18:53:09.160

这是你的遥控器的问题。当你这样做时`git push origin master`，`origin`是遥控器并且`master`是你正在推送的分支。

当你这样做时：

```
git remote 
```

我敢打赌，这份清单不包括`origin`. 要重新添加源远程：

```
git remote add origin git@github.com:your_github_username/your_github_app.git 
```

或者，如果它存在但格式不正确：

```
git remote rm origin
git remote add origin git@github.com:your_github_username/your_github_app.git 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-04-06T00:34:54.973

VonC 的答案是最好的，但对我有用的部分非常简单，并且隐藏在许多其他可能的答案中。如果您像我一样，在运行“rails 入门”教程时遇到了这个问题，并且您没有设置公共/私有 SSH 密钥。

如果是这样，试试这个：

1.  `$>cd ~/.ssh`

2.  `$>ls`

3.  如果 ls 的输出`known_hosts`没有其他内容，请访问：[http](http://help.github.com/mac-key-setup/) ://help.github.com/mac-key-setup/并开始按照“生成密钥”部分的说明进行操作。

运行这些指令后，我的“git push origin master”命令起作用了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-02-25T02:36:12.273

我有同样的问题，我认为防火墙阻止了 git 协议。所以最后我不得不求助于使用 https:// 来获取和推送。但是，这将始终提示用户输入密码...

这是对我有用的示例（只是与那些不能使用 git:// 协议的人分享：）

```
git fetch https://[user-name]@github.com/[user-name]/[project].git 
```

如果上述方法有效，您可以删除原点并替换为

```
git remote rm origin  
git remote add origin https://[user-name]@github.com/[user-name]/[project].git 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T17:40:55.000

我认为这是 git 错误消息被误导的另一种情况。通常，当我看到该错误时，它是由于 ssh 问题造成的。您是否将您的公共 ssh 密钥添加到您的 github 帐户？

编辑：此外，xinet.d 论坛帖子是指将 git-daemon 作为服务运行，以便人们可以从您的系统中提取。无需运行 git-daemon 即可推送到 github。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-06T22:32:55.027

我遇到了同样的问题，我只是将 ~/.ssh/id_rsa.pub 的内容添加到我在 GitHub 的帐户中。之后再试一次`git push origin master`，它应该可以工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-21T21:24:37.757

他们要记住的关键是'origin'不是你可能需要使用的值......当我用repo的名称替换'origin'时它对我有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-12-02T12:52:46.457

上述答案未解决的一种可能性是您可能没有从 shell 访问 ssh 的权限。也就是说，您可能处于 ssh 服务被阻止的网络（一些大学网络会这样做）。在这种情况下，您不仅可以获得 github 服务，还可以获得任何其他 ssh 服务。您可以通过尝试使用任何其他 ssh 服务来测试这是否是问题。我就是这种情况。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-08T21:13:40.743

我遇到了这个问题并尝试了各种解决方案来解决它，包括上面列出的许多解决方案（配置文件、调试 ssh 等）。最后，我通过在 git push 中包含**-u**开关来解决它，根据 github 说明在现场创建新存储库时 - [Github new Repository](https://github.com/repositories/new)

# .net - 无法在具有关系的表中插入数据（实体框架）

> ID：922218
> 
> 赞同：0
> 
> 时间：2009-05-28T17:38:35.517
> 
> 标签：.net, entity-framework

我正在使用实体框架，但遇到了问题：

当我尝试在表中插入一些数据时，它告诉我它违反了引用的完整性，但另一个表通常已填充并且具有我要插入的值。

```
Pedido pedido = new Pedido();
pedido.Data = DateTime.Now;

db.AddToPedido(pedido);
db.SaveChanges();

EntityKey chave = db.CreateEntityKey("Pedido", pedido);
Itens_Pedido item = new Itens_Pedido();

item.Pedido_Id = Convert.ToInt32(chave.EntityKeyValues.First().Value);
item.Carta_Id = Convert.ToInt32(Request.QueryString["Id"].ToString());                    
item.Quantidade = 1;
item.Foil = "N";

db.AddToItens_Pedido(item);
db.SaveChanges(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T18:04:33.530

我想我知道发生了什么。

`Pedido`如果您在和之间有识别关系`Iten_Pedido`

即主键`Iten_Pedido`是一个化合物，由两个字段组成，在您的情况下，其中一个是返回到 Pedido 的 FK（即`Pedido_Id`），不幸的是，您无法使用`Pedido_Id`必须使用`Pedido`导航的属性来建立这种关系而是财产。

如果您`Pedido`已经在上下文中，您需要做的就是正常建立关系。但是，如果它不是我怀疑的上下文，并且您所知道的只是关键，那么您有两个选择：1）查询它 2）制造一个替代实体并附加它（这类似于查询，因为它将 ObjectContext 中的实体置于未更改状态）。

所以模式是：

```
//assuming the key of the Pedido is Id change as appropriate
Pedido pedido = ctx.Pedido.First( p => p.Id == XXX); 
item.Pedido = pedido;
...
ctx.AddToItens_Pedido(item);
ctx.SaveChanges(); 
```

或者

```
Pedido pedido = new Pedido {Id = XXX};
ctx.AttachTo("Pedido", pedido);
item.Pedido = pedido;
...
ctx.AddToItens_Pedido(item);
ctx.SaveChanges(); 
```

有关更多信息，请参阅[我的技巧系列，特别是](http://blogs.msdn.com/alexj/archive/2009/03/26/index-of-tips.aspx)[技巧 9](http://blogs.msdn.com/alexj/archive/2009/03/27/tip-9-deleting-an-object-without-retrieving-it.aspx)

希望这可以帮助

亚历克斯

# .net - 如何检测 .NET 中的跨线程访问（强制线程关联）？

> ID：922219
> 
> 赞同：7
> 
> 时间：2009-05-28T17:38:49.027
> 
> 标签：.net, multithreading

我正在编写一个特殊的数据结构，该结构将在 .NET 库中可用，并且该数据结构的一个特性是线程安全的，前提是只有一个线程向其写入数据，并且只有一个线程从中读取数据它（读取线程和写入线程可以不同）。

问题是如何强制所有读取操作都由同一个线程执行？

我的解决方案是捕获 System.Threading.Thread.ManagedThreadID 并在第一次读取时将其存储在私有成员中。然后，在后续读取中检查 ManagedThreadID 与保存的 ID，如果它们不同则抛出异常。

这是否足够，或者是否有不同的更可靠的机制来做到这一点。

*注意：这个库需要在没有 Windows.Forms 上下文的情况下可用。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T17:50:34.137

当我遇到这种情况时，我使用我编写的一个名为 ThreadAffinity 的类。它的全部目的是记录当前线程并抛出来自不同线程的无效访问。您必须手动进行检查，但它为您封装了少量工作。

```
class Foo {
  ThreadAffinity affinity = new ThreadAffinity();

  public string SomeProperty {
    get { affinity.Check(); return "Somevalue"; }
  }
} 
```

班级

```
[Immutable]
public sealed class ThreadAffinity
{
    private readonly int m_threadId;

    public ThreadAffinity()
    {
        m_threadId = Thread.CurrentThread.ManagedThreadId;
    }

    public void Check()
    {
        if (Thread.CurrentThread.ManagedThreadId != m_threadId)
        {
            var msg = String.Format(
                "Call to class with affinity to thread {0} detected from thread {1}.",
                m_threadId,
                Thread.CurrentThread.ManagedThreadId);
            throw new InvalidOperationException(msg);
        }
    }
} 
```

关于该主题的博客文章：

*   [http://blogs.msdn.com/jaredpar/archive/2008/02/22/thread-affinity.aspx](http://blogs.msdn.com/jaredpar/archive/2008/02/22/thread-affinity.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:41:05.980

你能不要求 Read 和 Write 方法采用线程或线程 ID 吗？然后，您可以与第一个调用它的那个进行比较，如果不匹配，则抛出异常或返回错误代码，或者忽略该请求。

否则，您的建议也应该有效。您只需比较线程 ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T17:46:18.343

而不是比较线程 ID，您应该在构造期间将[环境线程](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentthread.aspx)存储在您的类中。

```
class SingleThreadedClass
{
    private Thread ownerThread;

    public SingleThreadedClass()
    {
        this.ownerThread = Thread.CurrentThread;
    }

    public void Read(...)
    {
        if (Thread.CurrentThread != this.ownerThread)
            throw new InvalidOperationException();
    }

    public void TakeOwnership()
    {
        this.ownerThread = Thread.CurrentThread;
    }
} 
```

# perl - Perl getcwd 结束正斜杠

> ID：922221
> 
> 赞同：2
> 
> 时间：2009-05-28T17:39:09.090
> 
> 标签：perl, cwd

我正在做一个 Perl 脚本来将另一个变量附加到当前工作目录的末尾，但是我在使用该模块时遇到了问题。

1.  如果我从 运行 getcwd `D:\`，则返回的值为

    ```
    D:/ (with forward slash) 
    ```

    如果我从 运行 getcwd `D:\Temp\`，则返回的值为

    ```
    D:/temp (without forward slash) 
    ```

    这使情况变得非常棘手，因为如果我只是这样做：

    ```
    use Cwd;
    $ProjectName = "Project"; # This is a variable supplied by the user
    $directory = getcwd().$ProjectName."\/";
    print $directory."\n"; 
    ```

    我最终会得到

    ```
    D:/Project (correct) 
    ```

    或者

    ```
    D:/TempProject (instead of D:/Temp/Project) 
    ```

    这是 中的一个功能`Cwd`吗？它似乎不在文档中。

2.  我想出了以下代码来解决这个问题。它需要 3 行来完成。你们中的任何人都可以看到更简洁的方法吗？

    ```
    use Cwd;
    $ProjectName = "Project"; # This is a variable supplied by the user

    $directory = getcwd();
    $directory =~ s/(.+?)([^\\\/])$/$1$2\//g;  # Append "/" if not terminating with forward/back slash
    $directory .= $ProjectName."\/";

    print $directory."\n"; 
    ```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T17:54:33.067

使用[File::Spec](http://perldoc.perl.org/File/Spec.html)而不是制作自己的路径操作例程。

```
use Cwd;
use File::Spec;

$ProjectName = "Project";

$cwd = getcwd();
$directory = File::Spec->catdir($cwd, $ProjectName);

print "$directory\n"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T17:58:17.677

第一种情况包括尾部斜杠，因为“D:”是音量说明符。它不是有效的目录名称。"D:/" 类似于 Unix/Linux 中的根目录。

快速而肮脏的解决方案：

```
$directory .= '/' unless $directory =~ m|/$|; 
```

对于健壮且可移植的解决方案，如果您更喜欢非面向对象的接口，请使用[File::Spec](http://perldoc.perl.org/File/Spec.html)或[File::Spec::Functions ：](http://perldoc.perl.org/File/Spec/Functions.html)

```
use Cwd;
use File::Spec::Functions qw(catdir);

my $directory = catdir(getcwd(), $ProjectName); 
```

请注意，*不*`catdir`包括尾部斜杠，并且 File::Spec 使用主机操作系统的目录分隔符构建路径。（例如 Windows 上的反斜杠）。

 *# eclipse-plugin - 如何强制解压缩 Eclipse 插件？

> ID：922230
> 
> 赞同：11
> 
> 时间：2009-05-28T17:40:32.473
> 
> 标签：eclipse-plugin

我的eclipse插件必须解压。

如何强制安装程序解压它？

如果只是将jar文件放入`plugins`文件夹中，它会被解包吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T07:36:41.723

这可以在配置包括插件的功能时选择。转到插件列表，选择您的插件并选中“安装后解压插件存档”。

可以说，这个属性应该由插件本身定义。有一个关于[https://bugs.eclipse.org/bugs/show_bug.cgi?id=157562的错误报告](https://bugs.eclipse.org/bugs/show_bug.cgi?id=157562)

问候，弗拉德

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-22T14:27:09.213

您可以将 MANIFEST.MF 文件中的 Eclipse-BundleShape 值设置为 jar（默认值）或 dir。如果设置为 dir，则将其部署为解包。

```
Eclipse-BundleShape: dir 
```

[http://eclipsesource.com/blogs/2009/01/20/tip-eclipse-bundleshape](http://eclipsesource.com/blogs/2009/01/20/tip-eclipse-bundleshape)

# windows - 如何在 Windows 中监控失败的登录尝试？

> ID：922231
> 
> 赞同：0
> 
> 时间：2009-05-28T17:40:45.077
> 
> 标签：windows, security, login, winlogon, gina

是否有任何可靠的方法可以在 Windows XP 中即时监控失败的登录尝试？（好吧，Vista 也是如此）。我需要以编程方式监视失败的登录尝试，目前这是通过一个简单的[GINA Stub](http://msdn.microsoft.com/en-us/library/aa375198(VS.85).aspx)通过从 MSGINA 继承登录对话框来完成的。

但是，如果链中还有其他 GINA，我目前的解决方案是不防水的。

**所以我的问题是**：我可以依赖任何（其他）API吗？还是我必须推出整个 GINA 替换 DLL？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T17:46:55.877

我会查看 Windows 事件日志 - 安全或系统日志应该有这些事件。

您可以使用事件查看器管理工具手动或以编程方式监控事件日志。

# c# - 标准输入和标准输出上的 C# 双向 IPC

> ID：922233
> 
> 赞同：8
> 
> 时间：2009-05-28T17:40:56.060
> 
> 标签：c#, ipc, stdout, stdin

如何连接两个 C# 进程，以便它们可以通过标准输入和标准输出相互通信？

像这样：

进程 A --> 标准输出 A --> 标准输入 B ---> 进程 B

进程 A <-- 标准输入 A <-- 标准输出 B <--- 进程 B

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T18:08:09.937

```
using System;
using System.Diagnostics;

class Program
{
  static void Main(string[] args)
  {
    string name;
    if (args.Length > 0 && args[0] == "slave")
    {
      name = "slave";
    }
    else
    {
      name = "master";
      var info = new ProcessStartInfo();
      info.FileName = "BidirConsole.exe";
      info.Arguments = "slave";
      info.RedirectStandardInput = true;
      info.RedirectStandardOutput = true;
      info.UseShellExecute = false;
      var other = Process.Start(info);
      Console.SetIn(other.StandardOutput);
      Console.SetOut(other.StandardInput);
    }
    Console.WriteLine(name + " started.");
    while (true)
    {
      var incoming = Console.ReadLine();
      var outgoing = name + " got : " + incoming;
      Console.WriteLine(outgoing);
      System.Threading.Thread.Sleep(100);
    }
  }
} 
```

# iis - 配置 IIS 6.0 以执行 cgi(.exe)

> ID：922234
> 
> 赞同：5
> 
> 时间：2009-05-28T17:41:05.077
> 
> 标签：iis, iis-6, cgi

我已经创建了一个具有权限的虚拟目录（cgi-bin）：脚本和可执行文件...当我测试时：[http://localhost/cgi-bin/mapserv.exe](http://localhost/cgi-bin/mapserv.exe)，我收到 404 错误，找不到页面

我应该向 .exe 文件添加 EXTENSION 映射吗？哪个可执行文件？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-29T16:31:36.020

我解决了这个问题：

转到 IIS 服务管理器中的 Web 服务扩展 选择添加新的 Web 服务扩展。在所需文件选项卡上，添加 C:\YourMapserverInstalldir\mapserv.exe 将其设置为允许

不管怎么说，还是要谢谢你...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:49:58.117

是的，您必须在脚本的文件扩展名和脚本解释器之间创建应用程序映射。看看这个链接。

[在 IIS 6.0 中安装 CGI 应用程序](http://technet.microsoft.com/en-us/library/cc738130(WS.10).aspx)

# .net - 从 .net 输出到一个简单的电子项目

> ID：922238
> 
> 赞同：0
> 
> 时间：2009-05-28T17:41:13.127
> 
> 标签：.net, hardware

我正在寻找构建一个简单的电子项目（在一些帮助下，我不是硬件方面的人），我想使用 .net (C#) 来完成它的编码方面。

我需要知道的是我在哪里可以获得一个便宜的控制器，我可以通过 USB 或串行连接以及合适的库来与之交谈（因为大多数 System.IO.Serial 文档似乎假设我正在与另一台计算机交谈，而不是由几个芯片和一些 LED 组成的东西）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-05-17T12:29:28.680

您是否考虑过使用 Arduino？[https://www.arduino.cc/](https://www.arduino.cc/)

您可以将 Arduino UNO 用于您的目的。您将找到大量示例如何使用 C# 进行接口。

此页面有很多示例：[https](https://playground.arduino.cc/Interfacing/Csharp) ://playground.arduino.cc/Interfacing/Csharp 特别是，这个调光器示例可以是一个好的开始：[https ://github.com/StanislavUshakov/ArduinoCSharpDimmer](https://github.com/StanislavUshakov/ArduinoCSharpDimmer)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-29T12:19:59.970

这在很大程度上取决于您想要做什么！例如，使用串行接口非常简单，但速度有限。

请稍微准确一点。

此外：FTDI 制造了一些很好的芯片，可以进行 USB-RS232 转换。一些这样做的预制板可能非常有用。它们为您提供低电流 3.3V 输出和 3.3V 逻辑电平的“RS232”线。对于低速的东西，这可能就是你所需要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:46:35.080

对于我的机器人项目，我使用 Serializer .NET 机器人控制器，你可以在这里得到它：

[http://www.roboticsconnection.com/p-16-serializer-net-robot-controller.aspx](http://www.roboticsconnection.com/p-16-serializer-net-robot-controller.aspx)

# c++ - 从 C++ STL 容器派生是否有任何真正的风险？

> ID：922248
> 
> 赞同：30
> 
> 时间：2009-05-28T17:42:33.543
> 
> 标签：c++, inheritance, stl

声称使用标准 C++ 容器作为基类是错误的，这让我感到惊讶。

如果不是滥用语言来声明...

```
// Example A
typedef std::vector<double> Rates;
typedef std::vector<double> Charges; 
```

...那么，究竟是什么，是在宣布...的危险

```
// Example B
class Rates : public std::vector<double> { 
    // ...
} ;
class Charges: public std::vector<double> { 
    // ...
} ; 
```

B 的积极优势包括：

*   启用函数重载，因为 f(Rates &) 和 f(Charges &) 是不同的签名
*   允许专门化其他模板，因为 X<Rates> 和 X<Charges> 是不同的类型
*   前向声明是微不足道的
*   调试器可能会告诉您对象是 Rates 还是 Charges
*   如果随着时间的推移，Rates 和 Charges 发展出个性—— Rates 的 Singleton，Charges 的输出格式——那么该功能的实现范围就很明显了。

A 的积极优势包括：

*   不必提供构造函数等的琐碎实现
*   十五岁的预标准编译器是唯一可以编译你的遗产的东西不会窒息
*   由于无法进行特化，模板 X<Rates> 和模板 X<Charges> 将使用相同的代码，因此不会出现无意义的膨胀。

这两种方法都优于使用原始容器，因为如果实现从 vector<double> 更改为 vector<float>，则只有一个地方可以用 B 改变，*也许*只有一个地方可以用 A 改变（可能更多，因为有人可能在多个地方放置了相同的 typedef 语句）。

我的目标是这是一个具体的、可回答的问题，而不是讨论更好或更坏的做法。显示由于从标准容器派生而可能发生的最糟糕的事情，而这本来可以通过使用 typedef 来防止。

编辑：

毫无疑问，向 Rates 类或 Charges 类添加析构函数是有风险的，因为 std::vector 没有将其析构函数声明为虚拟的。示例中没有析构函数，也不需要析构函数。销毁 Rates 或 Charges 对象将调用基类析构函数。这里也不需要多态性。挑战在于显示由于使用派生而不是 typedef 而发生了一些不好的事情。

编辑：

考虑这个用例：

```
#include <vector>
#include <iostream>

void kill_it(std::vector<double> *victim) { 
    // user code, knows nothing of Rates or Charges

    // invokes non-virtual ~std::vector<double>(), then frees the 
    // memory allocated at address victim
    delete victim ; 

}

typedef std::vector<double> Rates;
class Charges: public std::vector<double> { };

int main(int, char **) {
  std::vector<double> *p1, *p2;
  p1 = new Rates;
  p2 = new Charges;
  // ???  
  kill_it(p2);
  kill_it(p1);
  return 0;
} 
```

是否有任何可能的错误，即使是任意倒霉的用户也可以在 ??? 哪个部分会导致 Charges（派生类）出现问题，但不会导致 Rates（typedef）出现问题？

在 Microsoft 实现中，vector<T> 本身是通过继承实现的。vector<T,A> 是公开派生自 _Vector_Val<T,A> 是否应该首选包含？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-28T17:53:43.553

标准容器没有虚拟析构函数，因此您不能多态地处理它们。如果您不这样做，并且每个使用您的代码的人都没有这样做，那么这本身并不是“错误的”。但是，为了清楚起见，无论如何你最好还是使用合成。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-28T17:53:25.707

因为您需要一个虚拟析构函数而 std 容器没有它。std 容器并非设计为用作基类。

有关更多信息，请阅读文章[“为什么我们不应该从 STL 类继承一个类？”](http://www.codeguru.com/Cpp/Cpp/cpp_mfc/stl/article.php/c4143)

**准则**

基类必须具有：

*   公共虚拟析构函数
*   或受保护的非虚拟析构函数

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-28T18:10:59.947

在我看来，一个强有力的反驳观点是，您将接口**和**实现强加到您的类型上。当您发现向量内存分配策略不符合您的需求时会发生什么？你会从`std:deque`? 那些已经使用你的类的 128K 行代码呢？每个人都需要重新编译所有内容吗？它甚至会编译吗？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-28T18:02:28.370

这个问题不是哲学问题，而是实施问题。标准容器的析构函数不是虚拟的，这意味着无法在它们上使用运行时多态来获得正确的析构函数。

我在实践中发现，仅使用我的代码需要定义的方法（以及“父”类的私有成员）创建自己的自定义列表类并没有那么痛苦。事实上，它通常会导致设计更好的类。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-28T17:58:14.497

此外，在大多数情况下，如果可能，您应该更喜欢组合或聚合而不是继承。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-28T21:48:18.180

除了基类需要虚拟析构函数或受保护的非虚拟析构函数这一事实之外，您还在设计中做出以下断言：

费率和费用与上述示例中的双精度向量*相同。**通过您自己的断言“......随着时间的推移，费率和收费会发展个性......”那么在这一点上，费率仍然*与双打向量相同的断言是吗？例如，双精度向量不是单例，因此如果我使用您的 Rates 为小部件声明我的双精度向量，我可能会因您的代码而感到头疼。房价和收费还有哪些可能发生变化？如果基类更改以基本方式发生更改，是否有任何基类更改与您的设计客户安全隔离？

关键是类是 C++ 中的许多元素，用于表达设计意图。说出你的意思，说出你的意思是反对以这种方式使用继承的原因。

...或者在我回复之前更简洁地发布：替换。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T18:55:53.613

一个词：[可替代性](http://en.wikipedia.org/wiki/Substitutability)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-08T04:19:48.377

> 是否有任何可能的错误，即使是任意倒霉的用户也可以在 ??? 哪个部分会导致 Charges（派生类）出现问题，但不会导致 Rates（typedef）出现问题？

首先，Mankarse 的优点是：

> 里面的评论`kill_it`是错误的。如果受害者的动态类型不是`std::vector`，则`delete`简单地调用未定义的行为。调用会`kill_it(p2)`导致这种情况发生，因此不需要向该`//???`部分添加任何内容以使其具有未定义的行为。– [Mankarse 2011年](https://stackoverflow.com/users/485561/mankarse) [9 月 3 日在 10:53](https://stackoverflow.com/questions/922248/is-there-any-real-risk-to-deriving-from-the-c-stl-containers#comment8784484_922248)

其次，假设他们调用`f(*p1);`where `f`is special for `std::vector<double>`：`vector`找不到该专业化-您最终可能会以不同的方式匹配模板专业化-通常运行（较慢或效率较低）通用代码，或者如果未专业化则出现链接器错误版本实际上没有定义。 *通常不是一个重要的问题。*

就个人而言，我认为通过指向 base 的指针进行破坏是越界 - 考虑到您当前的编译器、编译器标志、程序、操作系统版本等，它*可能*只是一个“假设”问题（据你所知） - 但它随时可能因为没有“好”理由而中断。

如果您确信可以通过基类指针避免删除，那就去做吧。

也就是说，关于您的评估的几点说明：

*   “提供构造函数的简单实现” - 这很麻烦，但对于 C++03 的一个提示：`template <typename A> Classname(const A& a) : Base(a) { } template <typename A, typename B> Classname(const A& a, const B& b) : Base(a, b) { } ...`有时可能比枚举所有重载更容易，但不处理非`const`参数、默认值、显式与非显式构造函数，也不能扩展到大量参数。C++11 提供了更好的通用解决方案。

> 毫无疑问，向`class Rates`or中添加析构函数`class Charges`是有风险的，因为`std::vector`不会将其析构函数声明为虚拟的。示例中没有析构函数，也不需要析构函数。销毁 Rates 或 Charges 对象将调用基类析构函数。这里也不需要多态性。

*   *如果*对象没有被多态删除，则派生类析构函数不会带来风险；无论您的派生类是否具有用户定义的析构函数，是否存在未定义的行为。也就是说，当您使用执行清理的析构函数（内存释放、互斥解锁、文件手柄关闭等）

*   说“将调用基类析构函数”听起来像是直接完成的，不涉及隐式定义的派生类析构函数或进行调用——所有的优化细节都没有由标准指定。

# c# - 如何使用中继器以编程方式添加未知数量的列，其中一些列在运行时在 SQL 字符串中声明？

> ID：922250
> 
> 赞同：2
> 
> 时间：2009-05-28T17:42:58.193
> 
> 标签：c#, asp.net, repeater

我正在声明一个类似于以下内容的 SQL 字符串：

```
string SQL = "SELECT Column1, Column2, Column3, Date1, Date2 FROM Somewhere"; 
```

列数可能因情况而异，日期可以称为不同的名称，例如 StartDate、InterestDate 等。

我想做的是将它绑定到 ASP.NET 中继器并为上面的示例创建如下表：

```
<table>
  <tr>
    <th>Column1</th>
    <th>Column2</th>
    <th>Column3</th>
    <th>Date1</th>
    <th>Date2</th>
  </tr>
  <tr>
    Rows of values...
  </tr>
</table> 
```

我可以将数据绑定到Repeater并使用Eval，但这取决于固定数量的列和列名。这可以以编程方式完成吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T17:45:22.337

如果您使用 GridView，您可以将 AutoGenerate columns 属性设置为 true（默认为 true），然后将 GridView 绑定到您的数据。

制作非常简单，您可能需要使用[SQLDataSource](http://www.asp.net/LEARN/data-access/tutorial-47-cs.aspx)控件。

[asp.net 站点](http://www.asp.net/LEARN/data-access/tutorial-04-cs.aspx)对asp.net中的数据绑定进行了概述（使用 ObjectDataSource，但概念完全相同）。本页还介绍了一些自定义 GridView 的方法。

更新：这是如何处理 rowdatabound 事件以格式化日期列的示例（根据其他答案的评论）。这可能会做得更好，但这应该让你开始。

```
protected void gv_RowDataBound(object sender, GridViewRowEventArgs e)
{
    DataRowView rowView = (DataRowView)e.Row.DataItem;

    for (int i = 0; i < rowView.Row.ItemArray.Length; i++)
    {
        DateTime? tmpDate = rowView[i] as DateTime?;

        if (tmpDate.HasValue)
        {
            if (tmpDate.Value.Second > 0)
                e.Row.Cells[i].Text = tmpDate.Value.ToShortTimeString();
            else
                e.Row.Cells[i].Text = tmpDate.Value.ToShortDateString();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:53:41.027

这是一个在运行时动态创建转发器的示例的链接。唯一的要求是 ASP:Panel 在您的表单上以便注入它。

[http://programming.top54u.com/post/ASP-Net-Repeater-dynamically-using-C-sharp-code.aspx](http://programming.top54u.com/post/ASP-Net-Repeater-dynamically-using-C-sharp-code.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T17:45:21.933

您可以使用根据数据源[自动生成列](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.autogeneratecolumns.aspx)[`GridView`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.aspx)的a 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T17:48:02.473

如果您使用[DataReader](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.aspx)来检索数据，则可以使用它们的索引而不是它们的名称来访问列。即使它们的数量不是恒定的，您也应该能够遍历它们。

```
<% while(myRepeaterWithData.Read()) {
       for (int i = 0; i < myReaderWithData.FieldCount; i++) { %>
           The data on this row in column number <%= i%> is 
           <%= myRepeaterWithData[i] %>.
<%     }
    } %> 
```

# c++ - C++ 数组随机播放

> ID：922256
> 
> 赞同：1
> 
> 时间：2009-05-28T17:44:17.393
> 
> 标签：c++, arrays, pointers

我对 C++ 相当陌生，不太了解带有指针和引用的函数参数。我有一系列卡片，我想使用 Fisher-Yates 洗牌来洗牌。甲板被宣布为

```
Card *deck[deckSize]; 
```

其中deckSize 已声明为24。然后初始化数组。然后我调用 shuffle 函数：

```
void shuffle (Card * deck[]) {
    int deckSize = 24;
    while (deckSize > 1) {
       long int k = lrand48();
       k = k %24;
       deckSize--;
       Card * temp = deck[deckSize];
       deck[deckSize] = deck[k];
       deck[k] = temp;
    }
} 
```

如果我在调用 shuffle 函数后尝试打印卡片的值，则会出现 seg 错误。有关如何正确执行此操作的任何指示？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-28T19:32:39.297

只需使用`std::random_shuffle`found in `<algorithm>`，如下所示：

```
std::random_shuffle(deck, deck + deckSize); 
```

并且你的牌组被洗牌。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T17:49:23.703

我的 C/C++ 生锈了，但我认为您的声明：

```
Card *deck[deckSize]; 
```

正在声明一个指向卡片的指针数组。你不想要这个吗？

```
Card deck[deckSize]; 
```

然后声明洗牌：

```
void shuffle (Card deck[]) 
```

请记住，数组是 0 索引的。不确定您是否曾经访问过第 24 个元素，但这将是一个嘘声。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-27T02:46:54.520

你也可以使用

`std::random_shuffle(deck, deck + deckSize)`

Fisher-Yates 为您服务。

但是，标准随机库中可能没有足够的位来真正从所有可能的随机卡片排列中进行选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T18:05:24.060

看起来您的问题不是来自发布的代码，乍一看还不错，而是来自它周围的代码。

使用标准的卡片容器怎么样？一定要填好，先打印看看好不好，洗牌，然后再打印。

```
#include <vector>
std::vector<Card> deck; // Empty for now. Must be filled with cards.

void shuffle (std::vector<Card> & deck)
{
    int deckSize = 24;
    while (deckSize > 1) 
    {
       long int k = lrand48();
       k = k %24;
       deckSize--;
       Card temp = deck[deckSize];
       deck[deckSize] = deck[k];
       deck[k] = temp;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T17:48:35.607

您将 deck 声明为指针数组，但没有为它分配任何空间。如果你在不分配空间的情况下取消引用它，你会得到一个段错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T17:49:29.397

一个直接的挑剔，您应该始终使用随机数的上半部分，因为大多数随机数的实现在下半部分具有较差的随机性。因此，如果 long 是 32 位，您可以使用：`k = (k >> 24) % 24`以获得更好的随机性。

其次，这里的问题是你没有设置温度。您的代码应该有一行：`temp = deck[deckSize];`.

希望这可以帮助。

*编辑*：

更挑剔的是，无论使用高位还是低位，您的随机数生成器也不足以充分洗牌。它只有 48 位长序列，但要洗牌，你至少需要一个 226 位长的序列（52！，洗牌的方法数，是一个 226 位长的数字）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T17:50:14.090

```
 Card *deck[deckSize]; 
```

我想你想要：

```
Card *deck = new Card[deckSize]; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T19:07:48.083

我认为查看调用代码可能会有所帮助。

```
类卡{
上市：
    Card(int number):number_(number){}
    int getNumber(){返回号码_;}
 // ...
私人的：
    整数_;
};

无效洗牌（卡*甲板[]）{
    int 甲板大小 = 24;
    而（甲板大小> 1）{
       长整数 k = lrand48();
       k = k %24;
       甲板尺寸——；
       卡 * 温度 = 甲板[甲板尺寸];
       甲板[甲板尺寸] = 甲板[k];
       甲板[k] = 温度；
    }
}

int main(int argc, char* argv[]){
{

  常量 int 甲板大小=24；
  卡片* 甲板[deckSize];
  for(int i = 0 ; i getNumber()
```

那应该工作得很好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T18:06:14.637

如上所述，不能使用作为大小传递的变量来定义基本数组。

并在那里小心。最后一个元素

`typename array[SIZE];`

是`array[SIZE-1]`，不是`array[SIZE]`。这可能是您遇到段错误的地方。

你真的应该至少尝试使用 STL 容器。STL 也有洗牌算法（：

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T19:10:53.570

人们抱怨您没有使用容器并且没有声明数组的大小。别担心，这不是问题。有人还说你要越过数组边界，但事实并非如此。没有声明大小的数组是可以的。有一个指向 Card 的指针数组也是可以的。但我不明白为什么它会崩溃。这是我根据您的代码编写的一些示例代码：

```
#include <stdio.h>
#include <stdlib.h>
#define DECK_SIZE 24
void shuffle(int deck[]) {
    int n = DECK_SIZE, t;
    while (n > 1) {
        long k = lrand48() % DECK_SIZE;
        n--;
        t = deck[n];
        deck[n] = deck[k];
        deck[k] = t;
    }
}
int main(int argc, char **argv) {
    int deck[DECK_SIZE], i;
    for (i = 0; i < DECK_SIZE; ++i)
        deck[i] = i + 1;
    shuffle(deck);
    for (i = 0; i < DECK_SIZE; ++i)
        printf("%i\n", deck[i]);
    return 0;
} 
```

运行它，它工作得非常好。这意味着还有其他事情发生。在你调用 shuffle 之前尝试打印你的牌组中所有卡片的值，看看它是否也有段错误，我怀疑它会。

但是，您的代码中存在错误。您的函数未正确随机播放。正确的洗牌方法不是将每张牌与从整副牌中选出的牌交换，而是将位置 N 的每张牌与从 0..N 范围内选出的牌交换。如果您将每张卡片与随机卡片交换，您将获得 N^N 种可能的结果，如果您将卡片交换回原来的位置，其中一些结果会重叠。使用 3 张牌很明显这是错误的，因为您最终会得到 27 次不同的洗牌，其中一些是相同的，即使 3 张牌有 3!=6 次排列。问题在于，由于 6 不是 27 的因数，因此某些排列比其他排列更有可能。为避免这种情况，请尝试这样做：

```
void shuffle_correctly(int deck[]) {
    int i, t, k;
    for (i = 2; i < DECK_SIZE; ++i) {
        k = lrand48() % i;
        t = deck[i-1];
        deck[i-1] = deck[k];
        deck[k] = t;
    }
} 
```

# reporting-services - 在 SSRS 图表中显示总计

> ID：922261
> 
> 赞同：1
> 
> 时间：2009-05-28T17:45:39.730
> 
> 标签：reporting-services, charts, ssas

我正在从 Analysis Services 多维数据集创建折线图，其中包含日期类别、计数数据字段和状态系列。这是一个屏幕截图来解释：

picasaweb.google.com/lh/photo/fP16V4sB18O1xSTrdDV-_A?authkey=Gv1sRgCLHRmcjwtI2mzAE

我想添加蓝色的总行，它将所有状态加在一起。

我不想在 Status 维度中添加“Total”成员，因为那没有意义。我已经尝试添加另一个数据字段并将其范围限定为汇总所有内容，但我无法弄清楚如何使系列字段仅适用于单个数据字段 - 所以这最终会复制所有状态并获得 8 行而不是5.

这应该是可能的......我不想诉诸于针对底层数据库编写 SQL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T04:31:44.067

好吧，所以我在 MDX 中找到了一个合理的解决方案。我认为在 SSRS 中会更好地解决，但我还没有弄清楚。

诀窍是将 [Total] 成员添加到结果集中，而不是将其添加到实际 Dimension。简化的 MDX 在这里：

```
WITH 
MEMBER [Execution Status].[Execution Status].[Total] AS 
    AGGREGATE([Execution Status].[Execution Status].[Pass].Siblings)

SELECT 
    {[Measures].[Count]} ON COLUMNS,
    {[Execution Status].[Execution Status].Children,
     [Execution Status].[Execution Status].[Total] } ON ROWS

FROM [CUBE] 
```

这为汇总所有状态的 Total 定义了一个附加成员。然后返回所有状态成员以及总计。SSRS 不在乎——它仍然按新集合分组。

我确实在让聚合工作时遇到了一些问题，这就是我使用 [Pass].Siblings 的原因。[Execution Status].Children 总是返回 (null)，而 [Execution Status].[All] 返回 2x 正确答案，大概是因为 [All] 成员。我也可以手动枚举所有状态。仍然不确定是什么问题......

# ruby - 如何在 Ruby 中获取特定数量的输入行？

> ID：922271
> 
> 赞同：0
> 
> 时间：2009-05-28T17:46:45.517
> 
> 标签：ruby

我在 Ruby 中接受这样的输入：

```
lines = STDIN.readlines.map{|x| x.strip.to_i}.sort 
```

这需要从命令提示符输入，但我想输入特定次数。假设我的测试用例数是 3，如何在 3 行输入后停止它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T17:51:28.627

```
lines = []
3.times do
  lines << STDIN.readline.strip.to_i
end
lines.sort 
```

* * *

## 编辑：

如果你说你希望它接受*任意*数量的输入，你有几个选择：最简单的是首先输入你有多少行输入，像这样：

```
num_lines = STDIN.readline.strip.to_i
lines = []
num_lines.times do
  lines << STDIN.readline.strip.to_i
end
lines.sort 
```

或者，如果您不知道预期有多少行，您必须有某种方式来表示数据是完整的。例如，如果您想要一个空行表示数据的结尾：

```
lines = []
STDIN.each_line do |line|
  line.strip!
  break if line == ''
  lines << line.to_i
end
lines.sort 
```

顺便说一句，当程序在等待输入时暂停时，这不称为“无限循环”。它是“阻塞”或只是“等待输入”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T18:55:50.137

一行代码...

这将只需要您想要使用的行数 - 所需的计数在变量 @requested_count 中：

```
lines = STDIN.readlines.values_at(0..@requested_count - 1).map{|x| x.strip.to_i}.sort 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T10:53:21.110

为什么不使用`gets`？

```
lines = []
1.upto(3) do
  lines << gets.to_i
end

puts lines.sort 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T00:28:56.127

先前答案的变体：

```
lines = []
1.upto(3) do
  lines << STDIN.readline.strip.to_i
end
puts lines.sort 
```

# sql - 如何克服 OpenXML 的 8000 个字符限制？

> ID：922273
> 
> 赞同：2
> 
> 时间：2009-05-28T17:46:53.520
> 
> 标签：sql, sql-server, openxml, sqlxml

我正在使用 OpenXML 在 SQL 中加载 XML，同时声明我可以达到的最大值为 8000 个字符：

```
DECLARE @xml_text varchar(8000) 
```

由于 text，ntext 不允许与 openXML 一起使用，我还必须使用哪些其他替代方法在 SQL 中加载整个 XML（超过 20000 个字符）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T17:59:50.763

您应该能够使用 varchar(max) （SQL 2005 及更高版本）

```
DECLARE @idoc int
DECLARE @doc varchar(max)
SET @doc = '
<myxml>
<node nodeid="1" nodevalue="value 1">

</node>

</myxml>'
EXEC sp_xml_preparedocument @idoc OUTPUT, @doc
SELECT
    *
FROM
    OPENXML (@idoc, '/myxml/node',1) WITH ( nodeid varchar(10), nodevalue varchar(20) ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T18:20:39.583

如果您使用的是 SQL 2005 或更高版本，则可以使用 XML 数据类型本身。这样您就可以避免使用 OPENXML：

```
DECLARE @XDoc XML
SET @XDoc = '<Customer>
                 <FirstName>Fred</FirstName>
                 <LastName>Flinstone</LastName>
             </Customer>
             <Customer>
                 <FirstName>Barney</FirstName>
                 <LastName>Rubble</LastName>
             </Customer>'

SELECT 
    Tbl.Col.value('FirstName[1]', 'VARCHAR(MAX)'),
    Tbl.Col.value('LastName[1]', 'VARCHAR(MAX)')
FROM @XDoc.nodes('/Customer') Tbl(Col) 
```

# sifr - sIFR 服务器请求

> ID：922277
> 
> 赞同：0
> 
> 时间：2009-05-28T17:47:44.267
> 
> 标签：sifr

有没有办法减少 sIFR 3 从服务器请求 sifr.swf 文件的次数？我尝试使用 prefetch() 没有成功。有没有办法缓存 .swf 文件？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T20:28:14.157

预取的最佳解释是在[sifr3 - 预取不起作用？](https://stackoverflow.com/questions/759398/sifr3-prefetch-not-working/764104#764104). 所以基本上，答案是肯定的，但它可能并不总是有效。

（`prefetch()`顺便说一句，已在“最近”的夜间活动中删除。）

# c# - 创建文本文件并将其保存到服务器

> ID：922282
> 
> 赞同：0
> 
> 时间：2009-05-28T17:48:19.803
> 
> 标签：c#, asp.net

在 C# ASP.Net 中，我想创建一个文本文件并将其保存到服务器。这将每天发生（通过用户操作，未安排）。

我希望该位置不在应用程序路径中，而是在单独的文件夹中（对于这个问题，假设该文件夹不在根目录下）。

我是这个网站的新手，如果这个问题太“开放”，请随时告诉我。

感谢你的协助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T20:57:56.317

我同意[丹赫伯特](https://stackoverflow.com/a/922464/4251431)的观点。将路径放入 web.config 并确保文件夹的权限正确。

另外，请确保该路径不在 C 驱动器上。这样，如果出现问题，或者如果站点受到攻击，c 驱动器将不会填满并使服务器崩溃。

注意权限；如果黑客能够以某种方式破坏路径，那么即使是简单的文本文件也可能很危险。例如，想想有人覆盖了服务器的主机文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T18:29:29.097

一种好的做法是使用`web.config`应用程序设置键来定义应用程序的输出路径。

您将使用`ConfigurationManager.AppSettings`该类从`web.config`. 您可以在此处阅读如何执行此操作：

[http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.appsettings.aspx](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.appsettings.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T17:50:41.033

这是一个例子：

```
// Pass a path and filename to the StreamWriter's
// constructor.  The path must already exist but the
// file will be created if it does not already exist.
using (TextWriter tw = new StreamWriter("c:\\foo\\bar.txt"))
{
    tw.WriteLine("hello world");
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T17:52:17.613

您可以使用 System.IO 类保存到本地文件系统上的文件。

```
using(var w = new StreamWriter(filename))
{
    w.WriteLine("Hello world!");
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T18:00:21.263

只是补充一下其他人所说的，在多线程应用程序中写入文件时，您需要同步对该资源的访问。您可以使用[ReaderWriterLockSlim](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)来实现这一点：

```
// Make this a static field
ReaderWriterLockSlim _lock = new ReaderWriterLockSlim();

_lock.EnterWriteLock();
try
{
    File.WriteAllText(@"c:\test.txt", "some info to write");
}
finally
{
    _lock.ExitWriteLock();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T17:52:08.797

我没有看到这样做的任何具体问题。您只需要确保运行 ASP.NET 的用户被授予写入输出文件夹所需的权限。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T17:57:43.560

您需要使用 Server.MapPath 来访问文件夹的物理路径。

```
 using (TextWriter tw = new StreamWriter(Server.MapPath("Folder1")))
    {
        tw.WriteLine("hello world"); 
    } 
```

# asp.net-mvc - 如何对使用 AutoMockContainer 调用 Url.Action 的控制器进行单元测试？

> ID：922285
> 
> 赞同：2
> 
> 时间：2009-05-28T17:48:51.770
> 
> 标签：asp.net-mvc, unit-testing, moq

[这个问题与674458](https://stackoverflow.com/questions/674458/asp-net-mvc-unit-testing-controllers-that-use-urlhelper)非常相似，但我真的很想在我的单元测试中使用 AutoMockContainer。我无法弄清楚如何设置我的上下文。

有没有人能够对使用 AutoMockContainer 调用 Url.Action 的控制器进行单元测试？

# java - Java 等效于 .NET System.Net.ServicePointManager

> ID：922292
> 
> 赞同：0
> 
> 时间：2009-05-28T17:50:27.460
> 
> 标签：java, web-services

我想告诉 java 客户端请求不要关心远程服务器自己创建的 SSL 证书。在 .NET 中，我可以通过操作 ServicePointManager 来做到这一点。我怎样才能在 Java 中做同样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T19:45:02.377

我们需要知道您正在使用的 SOAP/WS 堆栈，因为它的底层实现会影响 SSL 的处理方式。在大多数情况下，堆栈将使用 JVM 范围内的 JSSE 设置，但您对 JSSE 配置的控制程度会有所不同。

如果这是生产环境，您真的应该考虑设置适当的 PKI 并信任客户端 JVM 中的 CA。如果这是为了测试，您应该对您的测试环境执行相同的操作，并且仍然使用您信任的 CA 配置 JVM。

要在 JVM 中配置信任，请参阅您的 Java 版本的[JSSE 文档](http://java.sun.com/javase/technologies/security/)。

要创建 JKS 文件以与 JSSE 设置一起使用，请参阅您的 Java 版本的[keytool 文档](http://www.google.com/#hl=en&q=java+keytool+documentation&fp=jdOYMfF-0fs)。

如果 keytool 让您望而生畏，Google 上有免费的 GUI。

如果您不能或不想正确设置信任，则可以配置 JSSE 类的自定义实现以忽略信任。有关不执行任何操作的 TrustManager 的代码示例，请参阅[本文。](http://javaswamy.blogspot.com/2004/12/jsse-how-to-ignore-certificateexceptio.html)您需要将此 TrustManager 配置为 JVM 的默认信任管理器，因为您的 SOAP/WS 堆栈可能不允许您对每个连接进行控制。

# apache - 使用 RewriteCond，我可以改变向世界不同地区的用户提供内容的速度吗？

> ID：922306
> 
> 赞同：0
> 
> 时间：2009-05-28T17:52:21.933
> 
> 标签：apache, web-applications, web-hosting

在 apache 上使用 RewriteCond 或类似机制，我可以改变向世界不同地区的用户提供内容的速度吗？

因为它看起来像这样：我在位于多伦多的 netfirms.com 上托管一个站点，并在位于加利福尼亚的 dreamhost.com 上托管另一个站点。两个站点几乎都是空的。所以我只是将相同的文件上传给他们，以测试下载速度。

netfirms 上的网站，下载一个 38MB 的文件需要 3 分钟。Dreamhost.com 上的网站，耗时 45 秒。（我也在加利福尼亚）。

然后我请了一些朋友测试了速度，结果看起来很奇怪：

一个住在离我 15 分钟路程的朋友：netfirms.com 上的那个是 4.5 分钟，dreamhost.com 上的那个是 8 分钟

密歇根的朋友：netfirms.com 20 分钟，dreamhost.com 7 分钟

台湾朋友：netfirms.com 12 分钟，dreamhost.com 42 分钟

我所有的朋友都有宽带......所以看起来通过在 apache 中使用 RewriteCond 或其他一些机制，他们改变了世界不同地区用户的下载速度？当我运行一个网络应用程序时，可能很难决定使用哪个应用程序，因为它们对世界不同地区的响应快慢完全不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T17:56:33.923

我怀疑主机是否根据全球位置进行任何主动节流。也许让你的朋友对两台服务器进行跟踪，看看有多少跳，正在使用哪些骨干供应商，他们有什么类型的延迟等等？

# mysql - 是否可以有一个允许重复的 AUTO_INCREMENT 列？

> ID：922308
> 
> 赞同：2
> 
> 时间：2009-05-28T17:52:28.783
> 
> 标签：mysql, sql, auto-increment, mysql-error-1075

我有一个有`AUTO_INCREMENT`字段的表。目前，它也是一个 PRIMARY KEY。

但是，在某些情况下，我需要此`AUTO_INCREMENT`列来允许重复。换句话说 - 两个不同的行可以在`AUTO_INCREMENT`列内具有相同的值。这意味着有一个不是 PRIMARY KEY 的 AUTO_INCREMENT 字段。

这可能吗？

我猜不是，因为每当我尝试这样做时，都会收到此错误：

`ERROR 1075 (42000) at line 130: Incorrect table definition; there can be only one auto column and it must be defined as a key`

我喜欢使用 AUTO_INCREMENT 字段，因为它使我不必手动存储/递增数据库中其他地方的单独计数器。我可以插入表格并获取插入的值。但是，如果我不能有重复项，我似乎将无法使用单独的表来跟踪和手动增加该字段。

更新：作为一个快速澄清，我已经熟悉将 AUTO_INCREMENT 字段与另一个键分组，[如此处所述](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)。让我们假设这个解决方案由于数据库中的其他约束而无法工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T18:07:24.133

MySQL 中的自增字段必须是*键*（即索引）的一部分，但不一定是主键或唯一键的一部分。

```
CREATE TABLE mytable (
  id   INT PRIMARY KEY,
  otto INT AUTO_INCREMENT,
  KEY (otto)
);

-- allow the auto-increment to generate a value

INSERT INTO mytable (id, otto) VALUES (123, DEFAULT);

SELECT * FROM mytable;

> 123, 1

-- specify a duplicate value, overriding the auto-increment mechanism

INSERT INTO mytable (id, otto) VALUES (456, 1); 

SELECT * FROM mytable;

> 123, 1
> 456, 1

-- allow the auto-increment to generate another value

INSERT INTO mytable (id, otto) VALUES (789, DEFAULT);

SELECT * FROM mytable;

> 123, 1
> 456, 1
> 789, 2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T18:02:19.497

听起来像“子任务”是一个表，“任务”有一个 FK 引用。也就是说，如果子任务被重用。

OTOH，如果一个任务可以有许多子任务，并且一个子任务可以链接到多个任务，那么您将在单独的表中查看多对多。

在任何一种情况下，我都不认为您希望数据库自动生成这些“链接 ID”。

# javascript - 使用 javascript 预加载图像时遇到问题

> ID：922309
> 
> 赞同：0
> 
> 时间：2009-05-28T17:52:52.743
> 
> 标签：javascript, image, image-preloader

我正在尝试预加载大约 150 张图像，并且我希望能够做两件事......

1) 正在使用文件名列表预加载图像。并非列表中的每个文件名都有与之匹配的文件。

例如）pic04.jpg 可能不存在，即使它在列表中。

所以当我预加载时，如果可能的话，我希望能够弄清楚图像是否存在。

2) 现在该函数只是使用 Pictures[i] = new Image(); 预加载所有 150 张图像。图片[i].src = "路径/到/my/images/" + imageName[i] + ".jpg";

该函数执行得非常快，但图像似乎没有被预加载。我是否需要做一些事情让网站等到图像加载完毕后再继续？

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T17:59:41.140

> 该函数执行得非常快，但图像似乎没有被预加载。

图像正在异步加载。该函数完成执行，但浏览器继续在后台加载图像

> 所以当我预加载时，如果可能的话，我希望能够弄清楚图像是否存在。

是的，有可能。您可以在 Image 对象上使用 onerror 事件处理程序

```
var img = new Image();
img.onerror=function(){alert('error: '+this.src);}
img.onload=function(){alert('image loaded: '+this.src);}
img.src='path/to/image.jpg'; 
```

# java - 为什么 Java 的 Method 类不是泛型的？

> ID：922314
> 
> 赞同：2
> 
> 时间：2009-05-28T17:53:51.477
> 
> 标签：java, generics, reflection

这将允许调用方法具有正确的返回类型。例如：

```
class Method<T> {
    T invoke(Object obj, Object... args);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T18:00:15.130

在 Java 中，泛型仅在编译时可用。您无法在运行时确定通用类型。这允许泛型实现与旧版本的 JVM 向后兼容。

由于泛型仅在编译时可用，如果您知道类的类型，则不需要使用反射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:12:00.807

对擦除的返回类型进行`Method`泛型并不是不合理的。但是，这将是很多努力而收效甚微。反射的本质是您在编译时不知道类型 - 否则您可以静态链接。

我想在某些情况下你甚至可以添加新的 API 以便返回泛型类型。信息仍在方法上，尽管不是来自您传递给它的实例。

# php - 将部分 HTML 页面下载为文本 (PHP)

> ID：922318
> 
> 赞同：0
> 
> 时间：2009-05-28T17:55:33.330
> 
> 标签：php

所以我有一个“导出”应用程序，它将用户带到一个带有大量文本的文本区域的结束页面。现在的工作流程是将文本从 textarea 复制并粘贴到文件中。

导出的代码越来越大，我们希望鼓励用户更频繁地这样做，因此不再需要复制/粘贴路线。（更不用说我的 xterm->ssh->screen->vi 链不能很好地粘贴 250K 字符）

**所以问题是这样的：我有一个在其中导出代码的文本区域，我想提供一个按钮，即“将此代码下载到文件”**

我很确定我将不得不再次访问服务器，但我只想检查我所有的基地。我能想到的方法（将生成的 textarea 值作为文件发送到浏览器）

*   创建一个脚本，将所述文本作为 POST 接收，并将其与正确的内容标题一起发送回。这是不可取的，因为我们将发布 250k，这将比：

*   创建一个重新生成文本区域的脚本，并提供一个按钮来访问脚本并下载文件的原始页面。*这是我倾向于的选项*

*   以某种方式使用 Javascript，也许能够一起跳过服务器，只需将 $('.exported').val() 发送到带有正确标题的浏览器？不知道如何做到这一点。

因此，如果有人有很棒的建议，也许我忽略了一些东西。谢谢！

编辑：[仅使用 Javascript 将 textarea 内容下载为文件（无服务器端）](https://stackoverflow.com/questions/609530/download-textarea-contents-as-a-file-using-only-javascript-no-server-side)

这个问题说JS路线是不可能的（可能）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T18:11:48.960

我建议如下：让您的按钮用您的文本替换页面的整个 DOM。之后，用户将能够简单地按`Ctrl`+`S`或 ⌘S。不完全是你想要的，但仍然是一个捷径。

我想您可以使用以下（jQuery）来做到这一点：

```
$ (document.body).html ($ ('#textarea-id').html) 
```

（未测试）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T18:16:31.853

我会选择选项 2。最简单，最快。其他的有点做作。

如果您选择选项 2，为什么还要离开 textarea？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:05:59.877

在您的第二个选项之后，您可以使用关键字触发脚本以将数据作为附件发送。

这是它的外观示例：

```
if (isset($_GET['download'])) {
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment;filename="dump.data"');
    echo $data;
    exit;
} else {
    echo '<textarea>', htmlspecialchars($data), '</textarea>';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T18:06:08.927

选项：

*   文本已经在服务器中：

    *   制作一个 GETFILE.PHP 来响应文件中的文本。
*   客户端中的文本

    *   将文本发布到 GETFILE.PHP 并响应文件。
    *   将文本发布到 GETFILE.PHP，存储文件并提供下载链接（然后您可以删除或不删除文件，具体取决于您的需要）

这是此 [http://www.osix.net/modules/article/?id=773的一些示例](http://www.osix.net/modules/article/?id=773)

# python - 使用 python 导出 zope 文件夹

> ID：922319
> 
> 赞同：5
> 
> 时间：2009-05-28T17:55:41.973
> 
> 标签：python, zope

我们有两台 zope 服务器运行我们公司的内部站点。一个是现场站点，一个是开发站点。我正在编写一个 python 脚本，将所有内容从开发服务器移动到实时服务器。现在，该过程涉及在 zope 管理界面中完成的一系列步骤。我需要使所有这些自动化，以便运行一个脚本来处理这一切。我需要做的一件事是从实时服务器导出一个文件夹，以便在更新后将其重新导入实时站点。如何从 python 脚本执行此操作？

我们使用的是 Zope 2.8 和 python 2.3.4

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-06T16:03:14.710

您可以尝试使用位于文件中`manage_exportObject`的函数`manage_importObject``$ZOPE_HOME/lib/python/OFS/ObjectManager.py`

假设我们安装了两个 Zope 2.8 实例，位于：

*   `/tmp/instance/dev`用于开发服务器（端口 8080）
*   `/tmp/instance/prod`用于生产服务器（端口 9090）

在开发服务器的 ZMI 中，我创建了两个文件夹`/MyFolder1`并`/MyFolder2`包含一些页面模板。以下 Python 脚本将每个文件夹导出为 .zexp 文件，并将它们导入生产实例的 ZMI：

```
#!/usr/bin/python
import urllib
import shutil

ids_to_transfer = ['MyFolder1', 'MyFolder2']

for id in ids_to_transfer:
    urllib.urlopen('http://admin:password_dev@localhost:8080/manage_exportObject?id=' + id)

    shutil.move('/tmp/instance/dev/var/' + id + '.zexp', '/tmp/instance/prod/import/' + id + '.zexp')

    urllib.urlopen('http://admin:password_prod@localhost:9090/manage_delObjects?ids=' + id)
    urllib.urlopen('http://admin:password_prod@localhost:9090/manage_importObject?file=' + id + '.zexp') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-15T17:17:57.570

为了使其更通用并允许复制不在根目录中的文件夹，我将执行以下操作：

```
#!/usr/bin/python
import urllib
import shutil

username_dev = 'admin'
username_prod = 'admin'
password_dev = 'password_dev'
password_prod = 'password_prod'
url_dev = 'localhost:8080'
url_prod = 'localhost:9090'

paths_and_ids_to_transfer = [('level1/level2/','MyFolder1'), ('level1/','MyFolder2')]

for path, id in ids_to_transfer:
    urllib.urlopen('http://%s:%s@%s/%smanage_exportObject?id=%s' % (username_dev, password_dev, url_dev, path, id))

    shutil.move('/tmp/instance/dev/var/' + id + '.zexp', '/tmp/instance/prod/import/' + id + '.zexp')

    urllib.urlopen('http://%s:%s@%s/%smanage_delObjects?ids=%s' % (username_prod, password_prod, url_prod, path, id))
    urllib.urlopen('http://%s:%s@%s/%smanage_importObject?file=%s.zexp' % (username_prod, password_prod, url_prod, path, id)) 
```

如果我有代表，我会将其添加到另一个答案中，但是唉……如果有人想合并它们，请继续。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T17:21:05.353

如果你真的移动*所有东西*，你可能只是移动 Data.fs 。但除此之外，上面的导入/导出是一个好方法。

# python - 如何停用鸡蛋？

> ID：922323
> 
> 赞同：3
> 
> 时间：2009-05-28T17:55:56.497
> 
> 标签：python, uninstallation, egg

我已经（重复）安装了 cx_Oracle，但我无法让它在我的 Intel Mac 上运行。如何停用/卸载它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T18:07:33.230

您只需删除`.egg`文件

在 OS X 上，它们被安装到`/Library/Python/2.5/site-packages/`- 在该文件夹中，您应该找到一个名为`cx_Oracle.egg`或类似的文件。您可以简单地删除此文件，它就会消失。

查找文件的一种方法是，如果您可以导入模块，只需显示`repr()`模块的：

```
>>> import urllib
>>> urllib
<module 'urllib' from '/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/urllib.pyc'>
>>> import BeautifulSoup
>>> BeautifulSoup
<module 'BeautifulSoup' from '/Library/Python/2.5/site-packages/BeautifulSoup-3.0.6-py2.5.egg/BeautifulSoup.py'> 
```

如果导入失败，回溯也应该显示模块的位置。

需要注意的一点是，如果模块安装了任何命令行工具，您还必须手动删除这些工具。在 OS X 上，它们安装在`/usr/local/bin/`- 您可以找到`cx_Oracle`使用 grep 的任何工具：

```
cd /usr/local/bin/
grep EASY-INSTALL * | grep cx_Oracle 
```

或者干脆..

```
cd /usr/local/bin/
grep cx_Oracle * 
```

# continuous-integration - 将 rake 与 Teamcity 一起使用会产生 RegexError

> ID：922325
> 
> 赞同：1
> 
> 时间：2009-05-28T17:56:32.847
> 
> 标签：continuous-integration, teamcity, rake

每次我尝试使用团队城市使用 rake 构建 .NET 解决方案时，我都会收到相同的

```
"Format_exception_msg : Invalid escape character syntax: /path to rakefile/ (RegexError) 
```

我的自然假设是我的 rake 代码中实际上有一个无效的转义字符，我承认我以前从未使用过 ruby​​ 或 rake，但是脚本本身执行没有问题，并且在执行命令时表现得应该没有使用teamcity的线。

此外，我通过我的代码慢慢地注释掉了行，以试图缩小无效字符的范围，即使使用完全注释掉的 rake 文件，团队城市进程仍然会失败。

感谢您的帮助，如果需要更多信息，请告诉我。

# c# - 如何在我的 Compact Framework 应用程序中使用 OpenStreetMap？

> ID：922333
> 
> 赞同：5
> 
> 时间：2009-05-28T17:58:47.303
> 
> 标签：c#, .net, windows-mobile, compact-framework, openstreetmap

有谁知道，我如何在我的 Compact Framework 应用程序中使用 OpenStreetMap？有框架之类的吗？我只能在他们的 wiki 中找到如何为他们的项目做出贡献以及如何使用他们的软件来映射数据。但我想使用他们的地图在我自己的应用程序中显示用户位置。我找不到任何关于使用他们的网络服务或任何我必须用来在我的应用程序中显示他们的地图的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T19:40:36.740

Google Code 上有一个项目想要为 OpenStreetMap API 创建一个 .NET 库。该网站声明当前有一个 alpha 版本，因此可能值得一试：[code.google.com/p/openstreetmapnet](http://code.google.com/p/openstreetmapnet)

CodePlex 上也有两个类似的项目： [osmscout.codeplex.com](http://osmscout.codeplex.com) [gmap4dotnet.codeplex.com](http://gmap4dotnet.codeplex.com)

也许这些也可以在 Compact Framework 中使用，或者您可以要求项目团队添加该功能（或者自己参与，毕竟它是开源的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-21T16:01:42.793

CloudMade 提供 API 用于以多种语言嵌入 OpenStreetMap 地图，但在撰写本文时还没有 .NET。您可以从 .NET 程序中调用用于地图图块的普通 HTTP API，但这当然是相当低级的。

CloudMade API 是为希望在项目中嵌入 OSM 输出的开发人员设计的，而不是面向地图创建的 OSM API，所以我认为您可能对 CloudMade 的东西感兴趣。

有关更多信息，请参见[http://developers.cloudmade.com/projects](http://developers.cloudmade.com/projects)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:35:08.747

他们似乎没有任何 CF 库，但[API 规范有据可查](http://wiki.openstreetmap.org/wiki/API)，因此您没有理由不与它集成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-21T20:05:47.867

我开发了一个 CF 组件，可以下载 OpenStreetMap 瓦片，还可以绘制兴趣点和基本路线。根据您的要求以及允许您使用的许可证的任何限制，那么它可能对您有用吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-05T16:42:15.260

[Brutile](http://brutile.codeplex.com/)看起来很有前途。它是一个为 C# 设计的库，用于连接到 OpenStreetMap 源。[（此处](http://brutiledemo.appspot.com/)提供 Silverlight 演示。

该 wiki 还[列出了所有 .NET 相关页面](http://wiki.openstreetmap.org/wiki/Category:Microsoft.NET)。在记录的项目中，[OpenStreetMapViewer](http://wiki.openstreetmap.org/wiki/OpenStreetMapViewer)看起来最适合您的需求。它旨在在 .NET 应用程序中显示 OpenStreetMap 的一部分。我确信其中至少有一个适用于 windows mobile。

# asp.net - 将 Html 元素传递给控制器

> ID：922334
> 
> 赞同：0
> 
> 时间：2009-05-28T17:59:01.843
> 
> 标签：asp.net, asp.net-mvc

如何将 HTML 元素传递给控制器​​操作。假设我有以下元素：

```
<table id="list"></table> 
```

如何将此表传递给控制器​​操作？它还会自动转换为 HtmlTable 对象吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T18:00:23.243

您只能将其作为字符串传递，它不会被转换为 HtmlTable 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T21:09:38.180

您不应该将任何 UI 元素从控制器传递到视图。如果您可以详细说明您的场景，也许我可以提供帮助

# visual-studio - 在不使用源代码控制绑定的情况下将 Visual Source Safe 与 Visual Studio 集成

> ID：922344
> 
> 赞同：2
> 
> 时间：2009-05-28T18:00:04.553
> 
> 标签：visual-studio, version-control, visual-sourcesafe

有没有办法在不进行源代码控制绑定的情况下将 Visual Studio 与 VSS 集成？

我遇到的问题是我的团队反对将源代码控制绑定添加到解决方案和项目文件中，因为他们声称这为他们增加了更多问题（限制）。

另一方面，我真的很喜欢从 Visual Studio 执行大多数源代码控制操作。

有没有办法让解决方案文件和所有项目文件保持原样（没有添加到 VSS 的绑定）并且仍然具有 VSS 和 VS 集成，而无需强制其他团队成员使用该集成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-23T13:58:58.607

我看不到每个项目都有办法做到这一点。

但是，您可以为 IDE 执行此操作（已加载所有项目）。它位于 Tools\Options\Source Control 下

然后将绑定设置为无。

我在 VS 2005 和 2008 中看到了它。我在一个我想从 VS2005 转换到 2008 的项目中尝试了它，并且似乎可以工作（我不想签入/签出文件进行转换）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-28T17:14:51.323

你的问题的答案是“不”。绑定和 VS 集成与 SourceSafe 是一回事。我什至不确定集成但不受约束的解决方案意味着什么，反之亦然。你的队友到底在寻找什么？

您可以在 File -> Source Control -> Change Source Control 对话框中调整每个项目的绑定。您还可以通过从源代码管理中排除 *scc 文件来为每个用户调整它们（有效地；不支持的配置）。但是，如果您尝试自己管理这些文件，而不是使用“将解决方案添加到 SCC”向导，则可能会遇到问题。更多信息：

*   [http://alinconstantin.dtdns.net/WebDocs/Scc/_Bindings.htm](http://alinconstantin.dtdns.net/WebDocs/Scc/_Bindings.htm)
*   [http://alinconstantin.dtdns.net/WebDocs/Scc/_WebEnlist.htm](http://alinconstantin.dtdns.net/WebDocs/Scc/_WebEnlist.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-25T11:51:18.727

绑定存储在 .vssscc、.vspscc 和 MSSCCPRJ.SCC 文件中。如果您不将这些文件添加到 Visual Source Safe，则每个开发人员都可以按照自己的意愿配置绑定。

由于我们使用 Perforce，我不能 100% 确定这是否适用于 VSS。

# wpf - 如何让 wpf 窗口刷新？

> ID：922350
> 
> 赞同：1
> 
> 时间：2009-05-28T18:01:50.917
> 
> 标签：wpf, refresh

我正在构建一个简单的轮盘赌应用程序。玩家 (UI) 将下注列表放在一起并将它们提交给要评估和支付的表对象。我的代码可以工作了，游戏过程也很顺利。问题是，一回合后我无法更新玩家余额（文本块）或投注列表（列表视图）。我是否缺少某种全局窗口刷新命令，或者我是否必须手动设置每个命令才能以某种方式更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T19:11:42.257

WPF 可以自动为您更新这些值，但您必须在事情发生变化时通知它。通常，这是通过在模型对象上使用 DependencyProperties 来完成的，但也可以通过实现 INotifyPropertyChanged 来完成。在任何一种情况下，当您更新属性的值时，都会调用 PropertyChanged 事件；WPF 在绑定到值时会自动订阅此事件，并在发生更改时更新 UI。如果没有此通知，WPF 将不会检查对象中的值是否已更改，并且您不会看到更改反映在屏幕上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T19:12:57.713

如何实现 INotifyPropertyChanged，并将余额和投注列表绑定到您正在使用的控件？

就像是：

```
public class Player : INotifyPropertyChanged
    {
        private int _balance;

        #region Properties

        public int Balance
        {
            get { return this._balance; }
            set
            {
                if (this._balance != value)
                {
                    this._balance = value;
                    NotifyPropertyChanged("Balance");
                }
            }
        }

        public BindingList<Bet> BetList { get; set; }

        #endregion // Properties

        private void NotifyPropertyChanged(string propertyName)
        {
            if (this.PropertyChanged != null)
                this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }

        #region INotifyPropertyChanged Members

        public event PropertyChangedEventHandler PropertyChanged;

        #endregion
    }

    public class Bet
    {
        // some code
    } 
```

对于绑定列表，您不需要实现任何东西，因为它实现了一个接口，该接口通知对绑定的任何内容的更改（IRaiseItemChangedEvents）。但是话又说回来，您可能会使用不同的方法。

# python - 是否可以使用预先导入的一些模块启动 Paster shell？

> ID：922351
> 
> 赞同：5
> 
> 时间：2009-05-28T18:01:54.677
> 
> 标签：python, pylons, paster

是否可以运行“paster shell blah.ini”（或其变体）并让它自动加载某些库？

我讨厌必须总是在每个 paste shell 中输入“from foo.bar import mystuff”作为第一个命令，并且希望计算机为我做这件事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T17:26:46.563

一个尝试的选项是创建一个 sitecustomize.py 脚本。如果你把它和你的 paste shell 放在同一个文件夹中，python 解释器应该在启动时加载它。

让我澄清一下，如果找到 sitecustomize.py，它 *总是*在解释器启动时加载。所以如果你把它放在可以找到的地方，理想情况下只有在 paste shell 启动时才能找到，那么你应该能够将你的导入添加到它并准备好它们。

这可能是你最好的选择。如果 paste shell 是一个打包的应用程序（la py2exe），它应该仍然可以工作。

也可以看看：

[http://www.rexx.com/~dkuhlman/pylons_quick_site.html#using-an-ipython-embedded-shell](http://www.rexx.com/~dkuhlman/pylons_quick_site.html#using-an-ipython-embedded-shell) [http://pylonshq.com/project/pylonshq/ticket/428](http://pylonshq.com/project/pylonshq/ticket/428)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T12:53:00.650

如果将环境变量 PYTHONSTARTUP 设置为文件名，它将在打开交互式提示时执行该文件。

我对粘贴外壳一无所知，但我认为它的工作原理类似。

或者，您可以查看 iPython，它具有更强大的功能（尤其是与 readline 库一起安装时）。例如 %run 允许您在当前命名空间中运行脚本，或者您可以使用历史完成。

编辑：

好的。仔细研究了一下，我相当肯定 paster shell 只是做了一组有用的导入，并且可以用一个简短的脚本和 ipython 轻松复制，然后`%run myscript.py`

编辑：

查看源代码后，这将很难做到（我错了默认导入。它也会解析您的配置文件），但是如果您同时安装了 Pylons 和 iPython，那么 paste shell 应该自动使用 iPython。仔细检查两者是否正确安装，并仔细检查 paste shell 是否已经没有使用 iPython（它可能看起来像普通的 python 提示符）。

# c# - C# 编译器的泛型、继承和失败的方法解析

> ID：922352
> 
> 赞同：6
> 
> 时间：2009-05-28T18:01:59.840
> 
> 标签：c#, generics, compilation

我今天遇到了一个让我困惑的编译问题。考虑这两个容器类。

```
public class BaseContainer<T> : IEnumerable<T>
{
    public void DoStuff(T item) { throw new NotImplementedException(); }

    public IEnumerator<T> GetEnumerator() { }
    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator() { }
}
public class Container<T> : BaseContainer<T>
{
    public void DoStuff(IEnumerable<T> collection) { }

    public void DoStuff <Tother>(IEnumerable<Tother> collection)
        where Tother: T
    {
    }
} 
```

前者定义`DoStuff(T item)`，后者重载它，`DoStuff <Tother>(IEnumerable<Tother>)`专门解决 C# 没有[协变/逆变](https://stackoverflow.com/questions/6557/in-c-why-cant-a-liststring-object-be-stored-in-a-listobject-variable/6574#6574)的问题（直到我听到 4）。

这段代码

```
Container<string> c = new Container<string>();
c.DoStuff("Hello World"); 
```

遇到一个相当奇怪的编译错误。注意`<char>`方法调用中没有。

> 类型“char”不能用作泛型类型或方法“Container.DoStuff(System.Collections.Generic.IEnumerable)”中的类型参数“Tother”。没有从 'char' 到 'string' 的装箱转换。

从本质上讲，编译器试图将我的调用阻塞`DoStuff(string)`到`Container.DoStuff<char>(IEnumerable<char>)`因为`string`implements`IEnumerable<char>`而不是 use `BaseContainer.DoStuff(string)`。

我发现进行此编译的唯一方法是添加`DoStuff(T)`到派生类

```
public class Container<T> : BaseContainer<T>
{
    public new void DoStuff(T item) { base.DoStuff(item); }

    public void DoStuff(IEnumerable<T> collection) { }

    public void DoStuff <Tother>(IEnumerable<Tother> collection)
        where Tother: T
    {
    }
} 
```

**为什么编译器试图堵塞一个字符串，因为`IEnumerable<char>`1）它知道它不能（考虑到编译错误的存在）和 2）它在基类中有一个可以正常编译的方法？** 我是否误解了 C# 中关于泛型或虚拟方法的东西？`new DoStuff(T item)`除了添加to之外，还有其他解决方法`Container`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T18:17:55.750

**编辑**

好的......我想我现在看到了你的困惑。您可能希望 DoStuff(string) 将参数保留为字符串，并首先遍历 BaseClass 方法列表以寻找合适的签名，然后尝试将参数转换为其他类型而失败。

但它发生了相反的情况......相反`Container.DoStuff(string)`，meh “那里有一个适合该法案的基类方法，但我将转换为 IEnumerable 并且对当前类中可用的内容感到心脏病发作。 ..

嗯...我确信 Jon 或 Marc 能够在这一点上加入特定的 C# Spec 段落，涵盖这个特殊的极端情况

**原来的**

两种方法都需要一个 IEnumerable 集合

您正在传递一个单独的字符串。

编译器正在获取该字符串并继续运行，

> 好的，我有一个字符串，两种方法都需要一个`IEnumerable<T>`，所以我会把这个字符串变成一个 `IEnumerable<char>`... 完成
> 
> 对，检查第一种方法……嗯……这个类是一个 `Container<string>` ，但我有一个 `IEnumerable<char>`，所以这是不对的。
> 
> 检查第二种方法，嗯....我有一个`IEnumerable<char>`但是 char 没有实现字符串，所以这也不对。

**编译器错误**

那么修复方法是什么，这完全取决于您要实现的目标...以下两项都是有效的，本质上，您的类型使用在您的化身中是不正确的。

```
 Container<char> c1 = new Container<char>();
        c1.DoStuff("Hello World");

        Container<string> c2 = new Container<string>();
        c2.DoStuff(new List<string>() { "Hello", "World" }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T19:03:21.727

正如 Eric Lippert 解释的那样，编译器选择`DoStuff<Tother>(IEnumerable<Tother>) where Tother : T {}`方法是因为它在检查约束之前选择方法。由于 string 可以`IEnumerable<>`，编译器将其与该子类方法匹配。编译器按照 C# 规范中的描述**正常工作。**

[您可以通过将 DoStuff 实现为扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)来强制实现您想要的方法解析顺序。扩展方法在基类方法*之后*检查，因此它不会尝试与 's 匹配`string`，`DoStuff`直到*它*`IEnumerable<Tother>`尝试将其与.*`DoStuff<T>`*

 *以下代码演示了所需的方法解析顺序、协方差和继承。请将其复制/粘贴到新项目中。

到目前为止我能想到的最大**缺点**`base`是你不能在覆盖方法中使用，但我认为有办法解决这个问题（询问你是否感兴趣）。

```
using System;
using System.Collections.Generic;

namespace MethodResolutionExploit
{
    public class BaseContainer<T> : IEnumerable<T>
    {
        public void DoStuff(T item) { Console.WriteLine("\tbase"); }
        public IEnumerator<T> GetEnumerator() { return null; }
        System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator() { return null; }
    }        
    public class Container<T> : BaseContainer<T> { }
    public class ContainerChild<T> : Container<T> { }
    public class ContainerChildWithOverride<T> : Container<T> { }
    public static class ContainerExtension
    {
        public static void DoStuff<T, Tother>(this Container<T> container, IEnumerable<Tother> collection) where Tother : T
        {
            Console.WriteLine("\tContainer.DoStuff<Tother>()");
        }
        public static void DoStuff<T, Tother>(this ContainerChildWithOverride<T> container, IEnumerable<Tother> collection) where Tother : T
        {
            Console.WriteLine("\tContainerChildWithOverride.DoStuff<Tother>()");
        }
    }

    class someBase { }
    class someChild : someBase { }
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("BaseContainer:");
            var baseContainer = new BaseContainer<string>();
            baseContainer.DoStuff("");

            Console.WriteLine("Container:");
            var container = new Container<string>();
            container.DoStuff("");
            container.DoStuff(new List<string>());

            Console.WriteLine("ContainerChild:");
            var child = new ContainerChild<string>();
            child.DoStuff("");
            child.DoStuff(new List<string>());

            Console.WriteLine("ContainerChildWithOverride:");
            var childWithOverride = new ContainerChildWithOverride<string>();
            childWithOverride.DoStuff("");
            childWithOverride.DoStuff(new List<string>());

            //note covariance
            Console.WriteLine("Covariance Example:");
            var covariantExample = new Container<someBase>();
            var covariantParameter = new Container<someChild>();
            covariantExample.DoStuff(covariantParameter);

            // this won't work though :(
            // var covariantExample = new Container<Container<someBase>>();
            // var covariantParameter = new Container<Container<someChild>>();
            // covariantExample.DoStuff(covariantParameter);

            Console.ReadKey();
        }
    }
} 
```

这是输出：

```
BaseContainer:
        base
Container:
        base
        Container.DoStuff<Tother>()
ContainerChild:
        base
        Container.DoStuff<Tother>()
ContainerChildWithOverride:
        base
        ContainerChildWithOverride.DoStuff<Tother>()
Covariance Example:
        Container.DoStuff<Tother>() 
```

**你能看出这项工作有什么问题吗？**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T18:12:19.227

编译器将尝试将参数与 IEnumerable 匹配`<T>`。String 类型实现 IEnumerable `<char>`，因此它假定 T 是“char”。

之后，编译器检查另一个条件“where OtherT : T”，但该条件不满足。因此编译器错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T18:12:35.620

我的猜测，这是一个猜测，因为我真的不知道，是它首先在派生类中查找以解析方法调用（因为您的对象是派生类型的对象）。当且仅当它不能时，它才会继续查看基类方法来解决它。在您的情况下，因为它可以使用

```
DoStuff <Tother>(IEnumerable<Tother> collection) 
```

过载，它试图将其塞入其中。因此，就参数而言，它可以解决它，但随后它遇到了约束问题。那时，它已经解决了你的过载问题，所以它不会再看下去，只是抛出一个错误。有道理？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T18:08:08.237

我认为这与 char 是值类型而 string 是引用类型这一事实有关。看起来你正在定义

```
TOther : T 
```

并且 char 不是从字符串派生的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T19:30:46.320

我不太清楚你想要完成什么，是什么阻止你只使用两种方法，`DoStuff(T item) and DoStuff(IEnumerable<T> collection)?`

# php - 关于加拿大 SMS 网关提供商的建议

> ID：922356
> 
> 赞同：6
> 
> 时间：2009-05-28T18:03:04.720
> 
> 标签：php, scripting, mobile, sms, gateway

我很好奇如果能够将传入的文本消息接收到一个号码对我来说会有多少麻烦/金钱，然后我会将其传递给 PHP 中的服务器端应用程序。我最终会通过电子邮件地址发回 SMS 消息。

有谁知道任何好的加拿大提供商可以接受传入的 SMS 消息？这些一般要多少钱？个人项目的成本和努力值得吗？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T20:38:47.933

我正在寻找同样的东西。找到 www 。短信网关。到目前为止。与他们交谈，他们听起来不错，价格合理。不过还没试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T20:32:48.397

Clickatell 似乎在加拿大提供传入短信支持： [www.clickatell.com](http://www.clickatell.com/pricing/standard_mo_coverage.php?country=45)

编辑：对不起，我认为我可能误读了该页面。看起来它显示的是从加拿大发送的邮件的费用，但可能的号码范围是 +44（英国）、+61（澳大利亚）、+45（丹麦）和 +46（瑞典）。因此，发件人将支付国际短信费率发送到您的号码。

对于个人项目，可能更容易获得便宜的电话和预付费 SIM 卡并将其插入某处的计算机上并编写脚本来提取 SMS，通常通过将 AT 命令发送到虚拟 COM 端口。

对于托管解决方案，通常每月需要支付租用号码的费用（“短代码”号码的费用更高）。然后是每条传入消息的费用。

编辑：Clickatell 似乎确实在加拿大提供简码服务。1000 美元的设置和 1200 美元的月租。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-19T20:25:09.727

回答这个问题是否值得取决于你到底想做什么。您还可以设置一些 GSM 调制解调器或 SIM 数据库以接收传入的短信。请注意，如果您收到几千条短信，1 个调制解调器是不够的，因为它们真的很慢。对我来说最好的短信解决方案来自 canadianms.com

# c++ - 跨平台一致的伪随机数

> ID：922358
> 
> 赞同：31
> 
> 时间：2009-05-28T18:03:45.700
> 
> 标签：c++, c, random

我正在寻找一种生成伪随机数序列的方法，该序列将为给定种子在任何平台上产生相同的序列结果。我假设`rand()`/`srand()`不会是一致的（我很容易对这个假设出错）。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-28T18:08:13.023

像[Mersenne Twister（来自 Boost.Random）](http://www.boost.org/doc/libs/1_39_0/libs/random/random-generators.html#mt19937)这样的东西是确定性的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-28T18:12:52.080

Knuth 已将*《计算机编程艺术》*第 3.6 节中描述的伪随机数生成器的[C（和 FORTRAN）源代码发布到公共领域](http://www-cs-faculty.stanford.edu/~knuth/news02.html#rng)。

 ** * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-19T13:26:03.140

我意识到这是一个旧线程，但现在使用 C++11 有一大堆[新选项可用](http://en.cppreference.com/w/cpp/numeric/random)。这是页面中的一个提炼示例，默认使用`Mersenne Twister`引擎和`Normal`分发：

```
#include <iostream>
#include <iomanip>
#include <string>
#include <map>
#include <random>

int main()
{
    std::random_device rd;

    //
    // Engines 
    //
    std::mt19937 e2(rd());
    //std::knuth_b e2(rd());
    //std::default_random_engine e2(rd()) ;

    //
    // Distribtuions
    //
    std::normal_distribution<> dist(2, 2);
    //std::student_t_distribution<> dist(5);
    //std::poisson_distribution<> dist(2);
    //std::extreme_value_distribution<> dist(0,2);

    std::map<int, int> hist;
    for (int n = 0; n < 10000; ++n) {
        ++hist[std::round(dist(e2))];
    }

    for (auto p : hist) {
        std::cout << std::fixed << std::setprecision(1) << std::setw(2)
                  << p.first << ' ' << std::string(p.second/200, '*') << '\n';
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-08T00:56:03.487

我一直在[`simplerandom`](https://github.com/cmcqueen/simplerandom)为此开发一个图书馆。它应该是跨平台的，我的目标也是针对多种语言。目前它支持 C 和[Python](https://pypi.python.org/pypi/simplerandom)（两种语言生成相同的数字）。我计划很快在 C++ 中实现相同的生成器，遵循 Boost 和 C++11 随机 API。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T18:10:51.007

一个快速的谷歌[参考](http://www.cplusplus.com/reference/clibrary/cstdlib/srand/)说：

> 具有相同种子的两个不同初始化指示伪随机生成器在两种情况下为随后对 rand 的调用生成相同的连续结果。

但问题仍然存在。我假设上述规范仅适用于同一流程中的 RNG。它很可能没有指定有关跨平台或跨编译器的任何内容。您最好的选择可能是找到一个可用于所有所需平台的库。那么你应该相当安全，如果以相同的值作为种子，它们会返回相同的数字序列。

# windows - CreateFile API 的性能下降

> ID：922359
> 
> 赞同：2
> 
> 时间：2009-05-28T18:04:09.727
> 
> 标签：windows, windows-server-2003

我有一个应用程序正在从库中恢复大量数据。我们使用的是 Windows server 2003。随着进程的进展，我们看到性能下降。我为我的 4 个主要任务添加了一些性能计数器，创建文件、从库中读取、WriteData、关闭文件。我们正在恢复数百万个文件。我观察到的是 createfile API 的性能随着过程的进行而下降。其他操作一致。

有什么想法可能导致这种情况吗？

提前感谢所有答案/建议。

问候， 布山

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-09T19:42:55.973

文件系统是NTFS吗？数百万个文件是否进入同一个目录，它们的名称是否相似？来自[关于 NTFS 内部的 technet 文章](http://technet.microsoft.com/en-us/library/cc781134%28WS.10%29.aspx)：

> 如果文件夹中有大量文件（300,000 或更多），并且这些文件的文件名较长且首字母相同，则创建文件所需的时间会增加。增加的原因是 NTFS 将短文件名基于长文件名的前六个字符。在包含超过 300,000 个文件的文件夹中，在 NTFS 使用与长文件名相似的所有 8.3 名称后，短文件名开始发生冲突。生成的短文件名和现有的短文件名之间的重复冲突导致 NTFS 重新生成短文件名 6 到 8 次。

您可以使用命令行实用程序“fsutil”查询此行为：

```
fsutil behavior query disable8dot3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T02:03:27.747

您能否提供一些有关库数据存储位置以及文件创建位置的信息？

例如，如果您将所有输出文件创建到同一目录中，您可能会发现`CreateFile`速度变慢，因为它需要检查越来越多的文件名是否存在冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:10:23.427

可能与系统缓存作斗争？您可以查看[CreateFile](http://msdn.microsoft.com/en-us/library/aa363858.aspx)文档中的缓存行为部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T05:18:00.187

我的通灵调试器说你正在泄漏句柄。您是否正在关闭处理所有您正在创建文件的调用？

# c++ - 为什么我不能制作参考向量？

> ID：922360
> 
> 赞同：411
> 
> 时间：2009-05-28T18:04:09.757
> 
> 标签：c++, vector, reference, stl, container-data-type

当我这样做时：

```
std::vector<int> hello; 
```

一切都很好。但是，当我将其设为引用向量时：

```
std::vector<int &> hello; 
```

我得到可怕的错误，比如

> 错误 C2528：“指针”：指向引用的指针非法

我想将一堆对结构的引用放入一个向量中，这样我就不必干预指针了。为什么vector会为此发脾气？我唯一的选择是使用指针向量吗？

* * *

## 回答 #1

> 赞同：387
> 
> 时间：2009-05-28T18:25:59.823

像向量这样的容器的组件类型必须是[*可赋值*](https://en.cppreference.com/w/cpp/named_req/CopyAssignable)的。引用是不可分配的（您只能在声明它们时初始化它们一次，并且以后不能让它们引用其他东西）。其他不可分配的类型也不允许作为容器的组件，例如`vector<const int>`不允许。

* * *

## 回答 #2

> 赞同：144
> 
> 时间：2012-11-20T05:08:00.897

是的，你可以，寻找[`std::reference_wrapper`](http://en.cppreference.com/w/cpp/utility/functional/reference_wrapper)，模仿参考，但可分配，也可以“重新安装”

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-05-28T18:21:58.440

就其本质而言，引用只能在创建时设置；即，以下两行具有非常不同的效果：

```
int & A = B;   // makes A an alias for B
A = C;         // assigns value of C to B. 
```

此外，这是非法的：

```
int & D;       // must be set to a int variable. 
```

但是，当您创建向量时，无法在创建时为其项目分配值。您实际上只是在制作最后一个示例。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2015-05-29T03:35:30.550

Ion Todirel 已经提到了一个答案**YES** using `std::reference_wrapper`。**从 C++11**开始，我们有一种机制来检索对象`std::vector` 并使用`std::remove_reference`. 下面给出了一个使用`g++`and`clang`选项编译
`-std=c++11`并成功执行的示例。

```
#include <iostream>
#include <vector>
#include<functional>

class MyClass {
public:
    void func() {
        std::cout << "I am func \n";
    }

    MyClass(int y) : x(y) {}

    int getval()
    {
        return x;
    }

private: 
        int x;
};

int main() {
    std::vector<std::reference_wrapper<MyClass>> vec;

    MyClass obj1(2);
    MyClass obj2(3);

    MyClass& obj_ref1 = std::ref(obj1);
    MyClass& obj_ref2 = obj2;

    vec.push_back(obj_ref1);
    vec.push_back(obj_ref2);

    for (auto obj3 : vec)
    {
        std::remove_reference<MyClass&>::type(obj3).func();      
        std::cout << std::remove_reference<MyClass&>::type(obj3).getval() << "\n";
    }             
} 
```

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2019-03-22T13:58:09.177

## TL; 博士

像这样使用[`std::reference_wrapper`](https://en.cppreference.com/w/cpp/utility/functional/reference_wrapper)：

```
#include <functional>
#include <string>
#include <vector>
#include <iostream>

int main()
{
    std::string hello = "Hello, ";
    std::string world = "everyone!";
    typedef std::vector<std::reference_wrapper<std::string>> vec_t;
    vec_t vec = {hello, world};
    vec[1].get() = "world!";
    std::cout << hello << world << std::endl;
    return 0;
} 
```

[`Demo`](http://coliru.stacked-crooked.com/a/921852b054e47dff)

## 长答案

正如[标准所暗示](http://eel.is/c++draft/container.requirements#tab:containers.container.requirements)`X`的，对于包含对象类型的标准容器`T`，`T`必须`Erasable`来自`X`。

`Erasable`表示以下表达式是格式良好的：

```
allocator_traits<A>::destroy(m, p) 
```

`A`是容器的分配器类型，`m`是分配器实例并且`p`是类型的指针`*T`。请参阅[此处](http://eel.is/c++draft/container.requirements#general-15.6)了解`Erasable`定义。

默认情况下，`std::allocator<T>`用作向量的分配器。使用默认分配器，要求等效于`p->~T()`（注意`T`是引用类型并且`p`是指向引用的指针）的有效性。但是，[指向引用的指针是非法](https://stackoverflow.com/questions/4632762/why-are-pointers-to-a-reference-illegal-in-c)的，因此表达式的格式不正确。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2009-05-28T18:07:06.223

这是 C++ 语言的一个缺陷。您不能获取引用的地址，因为尝试这样做会导致引用对象的地址，因此您永远无法获得指向引用的指针。 `std::vector`使用指向其元素的指针，因此需要能够指向存储的值。您将不得不使用指针。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2009-05-28T18:27:16.137

[`boost::ptr_vector<int>`](http://www.boost.org/doc/libs/1_39_0/libs/ptr_container/doc/ptr_vector.html)将工作。

**编辑：**是一个使用的建议`std::vector< boost::ref<int> >`，它不会起作用，因为你不能默认构造一个`boost::ref`.

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-28T18:30:07.333

正如其他人所提到的，您最终可能会改用指针向量。

但是，您可能需要考虑使用[ptr_vector](http://www.boost.org/doc/libs/1_39_0/libs/ptr_container/doc/ptr_vector.html)代替！

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-05-24T10:20:56.417

正如其他评论所暗示的那样，您仅限于使用指针。但如果它有帮助，这里有一种避免直接面对指针的技术。

您可以执行以下操作：

```
vector<int*> iarray;
int default_item = 0; // for handling out-of-range exception

int& get_item_as_ref(unsigned int idx) {
   // handling out-of-range exception
   if(idx >= iarray.size()) 
      return default_item;
   return reinterpret_cast<int&>(*iarray[idx]);
} 
```

# svn - 安装 TortoiseSVN 后命令提示符不起作用

> ID：922365
> 
> 赞同：2
> 
> 时间：2009-05-28T18:04:59.413
> 
> 标签：svn, tortoisesvn, windows-server-2003

我刚刚在 Windows Server 2003 上安装了 TortoiseSVN 的最新稳定版本并重新启动了服务器。我可以使用 Windows 资源管理器中的右键菜单创建一个新的存储库，但使用“svn”命令提示符返回的任何内容

'svn' 不是公认的内部或外部命令

当我之前在 XP 或 Vista 中安装 TortoiseSVN 时，它运行良好。我在这里想念什么？！

**编辑：** 我需要运行的具体命令是

svnadmin 加载存储库名称 < 存储库名称.dmp

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T18:06:53.370

TortoiseSVN 不为 SVN 安装命令行工具。你有没有机会也在你的另一台机器上安装了 VisualSVN？（其中确实包括命令行工具）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T17:27:28.423

我已经为基于 GUI 的工具安装了 TortoiseSVN。但是，我的自动构建脚本需要类似工具的命令，在该脚本中会发生自动签出和构建。我尝试了**Slik-Subversion-1.7.4-x64**，它让我可以访问 svn 命令的命令提示符。

# sql - 如何使用 VBScript（或 VB6）从字节/整数数组中插入原始/二进制字段值？

> ID：922366
> 
> 赞同：4
> 
> 时间：2009-05-28T18:05:14.700
> 
> 标签：sql, vb6, vbscript, binary, ado

有谁知道如何使用 SQL 将几个字节传递给二进制（或 varbinary）字段，最好是在 ADO（经典）和 VBScript（或 Visual Basic 6）中？

我希望编码 10-20（也许更多）字节的数据并将这些数据存储在 SQL db 字段中。（它不是 MS-SQLSVR，但我希望标准 SQL 支持的格式可以工作！）

这些字节可以作为通过 AscB/ChrB 获得的字节字符串，或者是“字节”数组（实际上是通过“cbyte”获得的字节类型的变体）并存储在数组中。

**第一个选项：使用字符串格式** ，我在创建 SQL 插入时取得了一些（有限）成功：

```
x = ".>?hD-&91k[="    '<psuedo string of chars, some unprintable
Insert Into rawtest (byt) Values (CAST('" & x & "' as SQL_BINARY(12))) 
```

但我担心字符串空值会截断字段中的数据，并且其他非打印控制字符会妨碍处理数据。有没有办法避免这种情况？

**第二个选项：字节数组** 我可以很容易地将数据放入数组中，但看不到如何传递给 SQL 插入语句。如果我尝试传入 12 个字节，则由于 CAST 尝试将数据存储到整数（4 字节）中，因此插入失败。如果我传入一个字节，它就可以工作，例如：

```
x = a(0) 
```

并继续工作 4 个字节，但在 Integer 溢出时失败。此外，它对数据进行重新排序

我尝试使用各种解决方法：

```
Insert Into rawtest (byt) Values (CAST('12,34,45' as SQL_BINARY(12)))
Insert Into rawtest (byt) Values (CAST(&h12&h34 as SQL_BINARY(12)))
Insert Into rawtest (byt) Values (CAST(0x123456789012 as SQL_BINARY(12))) 
```

我也尝试过类似的组合：

```
Insert Into rawtest (byt) Values (CONVERT('" & x & "', SQL_BINARY) 
```

但这些都失败了！

理想情况下，我想要一个方法，任何方法，它需要一个最多 20 个字节的小型二进制数组（理想情况下是完整的字节范围 0-255，但可能需要更少）并将它们传递给一个普通的、原始的、二进制 SQL 字段。

理想情况下，我需要在 VBScript/ADO 中执行此操作，但如果可用，可以采用基于 VB6 的解决方案。我希望这是“原始”二进制文件，我不想使用 ascii 编码，比如 Base64。

我已经用谷歌搜索了，直到我麻木了，并且没有发现太多与 SQL 中的二进制字段相关的东西。

你能帮我吗？任何答案表示赞赏。很多谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-29T02:06:58.190

经典 ADO 可以直接操作非常大 (>8000) 的 varbinary 和图像 (blob) 字段，而无需分块。下面是一个针对 MS SQL Server 的示例，该示例将二进制数据插入到具有 INT ID 字段和 varbinary(100) 字段的表中。在此示例中，参数化 SQL 查询正在插入来自 Variant 的二进制数据。Variant 只需要填充二进制数据。

```
Dim vntBlobData As Variant
vntBlobData = "ReplaceThisWithBinaryData - A byte array will work"

Dim cn As ADODB.Connection
Set cn = New ADODB.Connection
cn.ConnectionString = "Provider = sqloledb; Data Source = DBServerName; Initial Catalog = DBName; User ID = UserID; Password = Password; Persist Security Info = False"
cn.Open

Dim strQry As String
strQry = "INSERT INTO TestBinaryTable (ID, BlobData) VALUES (?, ?)"

Dim cm As ADODB.Command
Set cm = New ADODB.Command
cm.ActiveConnection = cn
cm.CommandText = strQry
cm.Parameters.Append cm.CreateParameter("@ID", adInteger, adParamInput, , 1)
cm.Parameters.Append cm.CreateParameter("@BlobData", adVarBinary, adParamInput, 100, vntBlobData)
cm.CommandType = adCmdText
cm.Execute 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:49:07.003

VB6 可以使用 ADO 字段类的 GetChunk 和 AppendChunk 方法访问二进制列。请参阅此[知识库文章](http://support.microsoft.com/kb/258038)。

此[博客文章](http://blogs.msdn.com/rextang/archive/2008/01/13/7091118.aspx)具有将十六进制字符串转换为 varbinary 的功能：

```
CREATE FUNCTION dbo.HexStrToVarBinary(@hexstr varchar(8000))
RETURNS varbinary(8000)
AS
BEGIN 
    DECLARE @hex char(1), @i int, @place bigint, @a bigint
    SET @i = LEN(@hexstr) 

    set @place = convert(bigint,1)
    SET @a = convert(bigint, 0)

    WHILE (@i > 0 AND (substring(@hexstr, @i, 1) like '[0-9A-Fa-f]')) 
     BEGIN 
        SET @hex = SUBSTRING(@hexstr, @i, 1) 
        SET @a = @a + 
    convert(bigint, CASE WHEN @hex LIKE '[0-9]' 
         THEN CAST(@hex as int) 
         ELSE CAST(ASCII(UPPER(@hex))-55 as int) end * @place)
    set @place = @place * convert(bigint,16)
        SET @i = @i - 1

     END 

    RETURN convert(varbinary(8000),@a)
END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T20:39:12.257

Matt 给了我一个解决方案的引子：虽然目标不是 blob 字段，并且大部分代码指示如何通过 ADO 将字符串传递到数据库中，但我需要的一点是如何创建要输入的字节变量'vntBlobData'，通过使用charb/ascb从源字节创建一个VBS'字节字符串'，我得到了我的解决方案。我现在有一个 VBS 解决方案（并且使用了适当的字节数组，还有一个 VB6 解决方案！）非常感谢马特。

'VBS $2Bin:

```
Function a2b(x)
    For i = 1 To Len(x)+1 Step 2
        d = Mid(x, i, 2)
        a2b = a2b & chrb(CByte(d))
    Next
End Function 
```

'VBS Bin2$

```
Function eb2s(c)
    If IsNull(c) Then
        eb2s = ""
    else
        For i = 1 To lenb(c)
        eb2s = eb2s & ascb(Midb(c, i, 1))
        Next
    End if
End Function 
```

# c++ - 按值删除地图元素

> ID：922368
> 
> 赞同：5
> 
> 时间：2009-05-28T18:05:41.267
> 
> 标签：c++, stl, map

我会保持简短。

我试图在字符串和对象指针之间保留一个映射，因此，我使用 std::map。我有一个管理器，它是一个跟踪地图的全局类，每当调用对象的析构函数时，它都会告诉管理器它已被删除。

我能想到的唯一方法是在地图中搜索对象。有没有有效的 STL 解决方案来解决这个问题？是否也存在通过键进行有效搜索的地图？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T18:08:52.913

不，除了通过比较值进行迭代之外，没有使用 std::map 执行此操作的有效方法。

然而，大多数情况下，值的键是可以从值本身计算出来的。例如，使用 Person 对象的 Name 属性作为键。经理是否可以存储键/值对列表而不是值本身。这将解决您的问题，而无需重写新算法。

或者，您可以在经理类上保留反向地图。本质上是关键的价值。这样您就可以使用它来计算稍后要删除的密钥。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T18:17:55.813

查看[SGI 的 STL 文档](http://www.sgi.com/tech/stl/Map.html)，

> Map 有一个重要的属性，即在 map 中插入一个新元素不会使指向现有元素的迭代器失效。从映射中擦除元素也不会使任何迭代器无效，当然，除了实际指向正在被擦除的元素的迭代器。

因此，您可以将迭代器存储到对象内的映射中，并在需要删除其条目时将其用作常量时间查找键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T18:16:20.933

看看[Boost Multi-Index Containers](http://www.boost.org/doc/libs/1_39_0/libs/multi_index/doc/index.html)库。

# asp.net-mvc - Windows 身份验证可用的角色

> ID：922378
> 
> 赞同：12
> 
> 时间：2009-05-28T18:07:04.057
> 
> 标签：asp.net-mvc, windows-authentication

我正在尝试将角色身份验证添加到 ASP.NET MVC 应用程序的控制器中的操作。代码看起来像这样：

```
[Authorize(Roles = "SomeRoleName")]
public ActionResult Index()
{
    bool inRole = User.IsInRole("Admin"); 
```

如果我删除 Authorize 属性并在该代码示例的最后一行放置一个断点，有没有一种方法可以检查对象并找出可用的角色？

例如，我在“即时”窗口中调用 User.IsInRole("Admin)，它会给我一个真/假值。如何访问可用角色的集合？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-28T22:22:53.307

如果您不需要以编程方式执行此操作，但您正在尝试确定需要指定的正确 Windows 组/角色，则可以从命令行使用它：

```
C:\> net group /domain  (lists all Roles in the domain)
C:\> net user <username> /domain (lists info, including roles for a user) 
```

否则，您将需要查询 Active Directory 的 LDAP 部分，或使用 DirectoryServices 下的内容。

查看这些网站以通过 C# 访问 Active Directory：

*   [Howto：（几乎）通过 C# 在 Active Directory 中的所有内容 - Codeproject](http://en.csharp-online.net/User_Management_with_Active_Directory)
*   [使用 Active Directory 进行用户管理](http://www.codeproject.com/KB/system/everythingInAD.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-03-16T10:19:22.957

将此添加到 system.web 下的 web.config 中：

```
<roleManager enabled="true" defaultProvider="AspNetWindowsTokenRoleProvider"/> 
```

然后你可以使用：

```
string[] arr = Roles.GetRolesForUser(User.Identity.Name); 
```

或者：

```
string[] arr = Roles.GetRolesForUser(); 
```

[![在此处输入图像描述](https://i.stack.imgur.com/HuVBk.png)](https://i.stack.imgur.com/HuVBk.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T18:26:21.227

您可以使用 System.Web.Security.Roles.Provider 中 RoleProvider 类的各种方法。

有关更多信息，请参见：[角色提供者](http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T20:58:09.250

我猜您这里没有使用角色提供程序，而是使用 WindowsPrincipal 的底层功能，其中角色映射到用户组。无论如何，我认为除了枚举该机器/该域中可用的 Windows 组之外，别无他法。不确定这是否有帮助，但这就是我能说的所有内容，但不知道您要对所述角色列表做什么。

# sql-server-2005 - 安装 SQL 2005 Management Studio（非速成版）

> ID：922386
> 
> 赞同：0
> 
> 时间：2009-05-28T18:08:38.563
> 
> 标签：sql-server-2005

我有 SQL Server 2005 开发人员版 DVD。

我已经尝试安装 SQL 2005 Management Studio 几个小时，但它不起作用。

在这个问题上是否有任何已知的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T18:57:12.630

您是否在“功能”屏幕中选择了该功能？有时您需要明确选择它。尝试再次运行安装程序并选择该功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T06:55:28.050

您可能在系统上安装了 Express 版本。要安装 Full Editoin SQL server，您需要简单地卸载它，只需在安装 Sql server 2005 之前重命名程序文件中的 sql server 文件夹，

# asp.net - 当通过javascript在客户端更改值时，ASP.NET文本框在回发后丢失值

> ID：922387
> 
> 赞同：6
> 
> 时间：2009-05-28T18:08:46.987
> 
> 标签：asp.net, javascript

我正在通过 javascript 客户端设置文本框的值。当我刷新页面时，值会丢失。

文本框未禁用或设置为只读。

我已经阅读了将值放在隐藏字段中的建议，我不想这样做。这似乎是一个黑客。

文本框位于用户控件中，如下所示：

```
<div id="Row" class="RaidRow" runat="server">
    <asp:Button ID="RaidRowButton" runat="server" CssClass="RaidRowButton" OnClick="RaidRowButton_Click" />
    <asp:TextBox ID="CharacterNameTextBox" runat="server" CssClass="RaidRowControl SlotTextBox" MaxLength="12" />
    <asp:Label ID="ClassNameLabel" runat="server" CssClass="RaidRowControl ClassLabel" />
</div> 
```

此控件位于 .aspx 页上。

当用户双击文本框、在文本框获得焦点时按 Enter 或更改文本时，将调用以下 javascript 函数：

```
function VerifyCharacter(slotNumber, event)
{
    var enterWasPressed = false;

    if (event && event.which == 13)
    {
        enterWasPressed = true;
    }
    else if (window.event && window.event.keyCode == 13)
    {
        enterWasPressed = true;
    }

    if (event == null || enterWasPressed)
    {
        var realmName = 'Lightninghoof';

        var characterNameTextBox = GetCharacterNameTextBox(slotNumber);
        characterNameTextBox.style.color = '#CCCCCC';

        var classLabel = GetClassNameLabel(slotNumber);
        classLabel.style.color = '#CCCCCC';
        classLabel.innerHTML = 'Unknown';

        WoW_Stats.CharacterInformation.GetCharacterInformation(realmName, characterNameTextBox.value, slotNumber, GetCharacterInformation_Success, GetCharacterInformation_Failed);
    }
} 
```

网络服务调用完成后，将调用以下 javascript 函数：

```
function GetCharacterInformation_Success(characterInformationResult)
{
    var characterInfo = Sys.Serialization.JavaScriptSerializer.deserialize(characterInformationResult, true);

    var classLabel = GetClassNameLabel(characterInfo.SlotNumber);
    classLabel.style.color = characterInfo.ClassColor;
    classLabel.innerHTML = characterInfo.ClassName;

    var characterNameTextBox = GetCharacterNameTextBox(characterInfo.SlotNumber);
    characterNameTextBox.style.color = characterInfo.ClassColor;
} 
```

唯一的问题是，当我刷新页面时，通过 javascript 在客户端设置的 CharacterNameTextBox 和 ClassNameLabel 中的文本丢失了。

如何确保控件在回发之间保持其价值？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-29T16:44:00.953

刷新页面（按 F5）与回发不同。我不相信您的文本框中的值会在刷新时被发回服务器。文本框中的值将在回发时回发到服务器（只要 TextBox 的 ReadOnly 属性未设置为 true，但这是另一回事）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-08-28T09:39:48.760

我认为如果文本框不可编辑：Enabled = False 或 ReadOnly= false。
Asp.net“出于安全原因”从其 ViewState 中获取此文本框中的值。
这就是为什么当您使用 HiddenField 或 Input 之类的东西时，您可以获得值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-30T23:13:23.583

在页面 preinit 事件中，尝试访问如下值：

请求["字符名文本框"]

我遇到了同样的问题（通过 javascript 设置的值永远不会回传，但输入的值会），一位同事建议这样做。死了，就像一个魅力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T14:44:22.343

> 唯一的问题是，当我**刷新页面时，****通过 javascript 在客户端设置**的 CharacterNameTextBox 和 ClassNameLabel 中的文本丢失了。

由于您是在客户端设置值，我建议使用 cookie 存储该数据并在客户端检查该 cookie，因为如果您只是在客户端设置值，无论 CodeBehind 会做什么，ViewState 都无济于事将其设置为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T18:18:36.933

在隐藏字段中存储值并不比 .NET Web 窗体本身更难。许多应用程序数据被传递/存储在隐藏的 __VIEWSTATE 字段中。

话虽如此，你能澄清发生了什么吗？您是在页面加载时设置值，还是对某些用户操作做出反应？您能否提供一些代码，以便我们更清楚地了解您在做什么？

*编辑*

您是否在页面加载/回发代码隐藏中明确设置文本框或标签的值？这将覆盖客户端脚本设置的任何值。我想不出这些价值观不会持续存在的任何其他原因。如果你真的很绝望，你可以在你的 javascript 函数结束时通过 AJAX 调用将信息发送回服务器，这样你就可以将它保存在服务器内存中的某个地方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T18:32:06.313

你什么时候设置值？只要您使用文本框的clientId，您就可以在javascript中设置页面的值onload。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-29T14:53:11.157

问题可能是两件事之一。刷新可以清除然后字段。另外，如果您要回帖，是否在页面加载（或卸载）事件上设置文本框的值？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-03T18:50:22.037

另一种解决方案是会话，您可以在第一次加载或从外部页面分配会话，然后检查会话是否不为空，然后将值设置为文本框。这是示例：在外部页面中：

```
 if (id == "txtDD")
        {
          Session["DD"] = calendar.SelectedDate.ToShortDateString();
        }
and in code behind check it:

protected void Page_Load(object sender, EventArgs e)
   {
    if(Session["DD"]!= null)
       txtDD.Text =Session["DD"].ToString();
   } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-15T09:04:54.413

你可以试试这个，而不是只读一个文本框

```
onKeyPress = "javascript: return false;" onPaste = "javascript: return false;" 
```

它不会失去它的价值。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-10-20T20:04:35.213

你必须记住，亲吻。

只需将您现有的字段视为本质上的表现形式，并使用 runat="server" 属性添加隐藏的输入字段，并在同一客户端事件中使用 JavaScript 设置这些字段。

这些是您在代码隐藏方法中想要的真正价值，您将能够毫无问题地抓住这些价值。由于文本框对象是 .NET 抽象，因此我建议在使用在服务器上运行的 HTML 输入进行客户端工作时。当我深陷网络表单BS时，这似乎让我头疼。

我认为这里有很多解决方案，但如果可以的话，我完全赞成折断手腕并走开。

# asp.net - 验证器 - 一次显示一个错误

> ID：922391
> 
> 赞同：4
> 
> 时间：2009-05-28T18:09:33.553
> 
> 标签：asp.net, validation

有没有简单的方法来做到这一点？

我有 2 个文本框，用于电子邮件输入，带有正则表达式和比较验证器。如果用户在第二个文本框中输入了无效的电子邮件和不同的电子邮件，则会显示两条错误消息。但我想一次只显示一条错误消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T18:23:49.063

在这种情况下，您可以尝试编写一个自定义验证器来首先执行正则表达式，并且仅在条目通过正则表达式验证时才进行比较验证（或者相反，但是您想这样做）。可能有一个更简单的解决方案，但这是我能想到的最好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T19:53:15.497

也许使用[ValidationSummary 控件](http://msdn.microsoft.com/en-us/library/f9h59855(VS.80).aspx)可能会帮助您以不同的方式解决问题。好的，它不会只产生一条错误消息，但会将它们放在页面中您想要的位置。只需将验证控件的文本属性设置为 * end place a validationsummary 控件。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:25:04.847

很好的问题，但找不到这个问题的解决方案。但我不会推荐它。显示所有必填字段错误消息总是更好。想想一个有很多输入字段的表单，直到我向下滚动并单击提交按钮之前我不会知道错误。

通过限制显示的错误消息的数量，您将达到什么目的？

# asp.net - C# (ASP.net) 中 RSS 提要的最佳实现

> ID：922393
> 
> 赞同：7
> 
> 时间：2009-05-28T18:10:42.397
> 
> 标签：asp.net, performance, architecture, rss, syndication

我有一个需要提要的网络应用程序（asp.net）。所以我使用`System.ServiceModel.Syndication`命名空间来创建创建“新闻”的函数。问题是每次有人调用它时它都会执行，我是否应该使用它来创建一个 xml 文件并使我的 rss url 指向该文件？

最好的方法是什么？

编辑：也许这就是我错的地方。我没有使用处理程序...我只是使用返回带有数据的 Rss20FeedFormatter 的 WCF 服务。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T18:30:49.517

过去，当我实现 RSS 时，我将 RSS 数据缓存在 HttpContext.Current.Cache 中。

RSS 数据通常不需要经常更新（例如，每分钟一次就足够了），因此您只需每分钟实际访问一次数据库，而不是每次有人请求您的 RSS 数据时。

以下是如何使用缓存的示例：

```
// To save to the cache
HttpContext.Current.Cache.Insert("YourCachedName", pObjectToCache, null, DateTime.UtcNow.AddMinutes(1), System.Web.Caching.Cache.NoSlidingExpiration);
// To fetch from the cache
YourRssObject pObject = HttpContext.Current.Cache[("YourCachedName"] as YourRssObject : null; 
```

您还可以在 ashx 中设置以下内容：

```
context.Response.Cache.SetExpires(DateTime.Now.AddMinutes(1)); 
```

这将使您的 RSS 页面提供一个缓存版本，直到它过期。这需要更少的资源，但是如果您有其他使用您的 RSS 数据访问层调用的东西，那么这将不会缓存该数据。

您还可以根据 RSS 可能收到的查询参数对其进行缓存，方法是设置：

```
context.Response.Cache.VaryByParams["YourQueryParamName"] = true; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T18:19:18.790

ASP.Net 内置了一些非常好的服务器端缓存。假设您将这些类用作普通 aspx 页面或 http 处理程序 (ashx) 的一部分，您可以告诉 ASP.Net 积极缓存它而不是重新构建您的满足每个请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-08T01:51:54.413

在您的 .aspx 页面中，您不能只使用：

```
<%@ OutputCache Duration="60" VaryByParam="none" %> 
```

我有一篇博客文章，其中我将存储过程的结果作为 RSS 提要发送到我的手机[。](http://blog.digitaltools.com/post/2010/12/14/Having-the-Result-Set-of-a-Stored-Proc-Sent-to-You-by-RSS-Feed.aspx)

# php - 成功的 MySQL DELETE 会返回什么？如何检查 DELETE 是否成功？

> ID：922398
> 
> 赞同：59
> 
> 时间：2009-05-28T18:11:18.977
> 
> 标签：php, mysql

使用 PHP，我试图删除一条记录，但我想检查它是否成功。有什么从一个成功的返回`DELETE FROM foo where bar = 'stuff'`？

或者，您是否知道其他检查 DELETE 是否成功的方法？还是我最好在删除之前确保该行存在？如果可能的话，我试图避免另一个查询。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-05-28T18:13:16.027

假设您正在使用[mysql_query](http://www.php.net/mysql_query)：

> 对于其他类型的 SQL 语句，INSERT、UPDATE、**DELETE**、DROP 等，mysql_query() 在成功时返回 TRUE，在错误时返回 FALSE。

如果您使用的是[PDO::exec](http://www.php.net/manual/en/pdo.exec.php)，那么手册会这样说：

> PDO::exec() 返回由您发出的 SQL 语句修改或删除的行数。如果没有行受到影响，PDO::exec() 返回 0。

不想回答狙击，但由于选择了这个作为答案，我应该注意`TRUE`即使查询实际上没有删除任何内容，mysql_query 也会返回。你应该用它[`mysql_affected_rows`](http://www.php.net/mysql_affected_rows)来检查。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-05-28T18:18:03.957

此外，如果您关心受影响的行数：

> [使用] [mysql_affected_rows()](http://us.php.net/manual/en/function.mysql-affected-rows.php)找出受 DELETE、INSERT、REPLACE 或 UPDATE 语句影响的行数。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2010-09-07T01:57:40.197

你可以在你的查询运行之后为你的 php 代码试试这个：

```
if (mysql_affected_rows() > 0) {
    echo "You have successfully updated your data.<br><br>";
}
else {
    echo "The data you submitted matched the current data so nothing was changed.<br><br>";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-14T03:56:15.563

对于其他类型的**SQL**语句，`INSERT`、`UPDATE`、`DELETE`、`DROP`等，成功时`mysql_query()`返回**TRUE ，错误时返回****FALSE**。

# mod-rewrite - 如何在 Apache 上对 RewriteCond 使用“AND”、“OR”？

> ID：922399
> 
> 赞同：123
> 
> 时间：2009-05-28T18:11:23.703
> 
> 标签：mod-rewrite, apache-config

这是如何`RewriteCond`在 Apache 上使用 AND，OR for？

```
rewritecond A [or]
rewritecond B
rewritecond C [or]
rewritecond D
RewriteRule ... something 
```

变成`if ( (A or B) and (C or D) ) rewrite_it`.

所以看起来“OR”的优先级高于“AND”？有没有办法像 `(A or B) and (C or D)`语法一样轻松分辨？

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2015-07-22T19:11:46.607

这是一个有趣的问题，由于文档中没有非常明确地解释它，我将通过查看[mod_rewrite 的源代码来](https://github.com/apache/httpd/blob/trunk/modules/mappers/mod_rewrite.c)回答这个问题；***展示了开源的*****一大好处***。*

 *在顶部，您将快速发现[用于命名这些标志的定义](https://github.com/apache/httpd/blob/trunk/modules/mappers/mod_rewrite.c#L149)：

```
#define CONDFLAG_NONE               1<<0
#define CONDFLAG_NOCASE             1<<1
#define CONDFLAG_NOTMATCH           1<<2
#define CONDFLAG_ORNEXT             1<<3
#define CONDFLAG_NOVARY             1<<4 
```

并搜索 CONDFLAG_ORNEXT 确认它是[基于 [OR] 标志的存在使用的](https://github.com/apache/httpd/blob/trunk/modules/mappers/mod_rewrite.c#L3267)：

```
else if (   strcasecmp(key, "ornext") == 0
         || strcasecmp(key, "OR") == 0    ) {
    cfg->flags |= CONDFLAG_ORNEXT;
} 
```

标志的下一次出现是[实际实现](https://github.com/apache/httpd/blob/trunk/modules/mappers/mod_rewrite.c#L4108)，您将在其中找到遍历 RewriteRule 具有的所有 RewriteConditions 的循环，它的基本作用是（剥离，为清楚起见添加注释）：

```
# loop through all Conditions that precede this Rule
for (i = 0; i < rewriteconds->nelts; ++i) {
    rewritecond_entry *c = &conds[i];

    # execute the current Condition, see if it matches
    rc = apply_rewrite_cond(c, ctx);

    # does this Condition have an 'OR' flag?
    if (c->flags & CONDFLAG_ORNEXT) {
        if (!rc) {
            /* One condition is false, but another can be still true. */
            continue;
        }
        else {
            /* skip the rest of the chained OR conditions */
            while (   i < rewriteconds->nelts
                   && c->flags & CONDFLAG_ORNEXT) {
                c = &conds[++i];
            }
        }
    }
    else if (!rc) {
        return 0;
    }
} 
```

您应该能够解释这一点；这意味着 OR 具有更高的优先级，并且您的示例确实导致`if ( (A OR B) AND (C OR D) )`. 例如，如果您有以下条件：

```
RewriteCond A [or]
RewriteCond B [or]
RewriteCond C
RewriteCond D 
```

它会被解释为`if ( (A OR B OR C) and D )`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-10-13T16:19:12.843

经过多次努力并获得一个通用、灵活和更具可读性的解决方案，在我的情况下，我最终将**OR**的结果保存到*ENV*变量中，并对这些变量进行**AND**。

```
# RESULT_ONE = A OR B
RewriteRule ^ - [E=RESULT_ONE:False]
RewriteCond ...A... [OR]
RewriteCond ...B...
RewriteRule ^ - [E=RESULT_ONE:True]

# RESULT_TWO = C OR D
RewriteRule ^ - [E=RESULT_TWO:False]
RewriteCond ...C... [OR]
RewriteCond ...D...
RewriteRule ^ - [E=RESULT_TWO:True]

# if ( RESULT_ONE AND RESULT_TWO ) then ( RewriteRule ...something... )
RewriteCond %{ENV:RESULT_ONE} =True
RewriteCond %{ENV:RESULT_TWO} =True
RewriteRule ...something... 
```

**要求**：

*   Apache [mod_env](https://httpd.apache.org/docs/2.4/mod/mod_env.html)启用

# asp.net-mvc - 具有 ADO.NET 实体框架的强类型 ASP.NET MVC

> ID：922402
> 
> 赞同：13
> 
> 时间：2009-05-28T18:12:03.970
> 
> 标签：asp.net-mvc, entity-framework, ado.net

经过几天的努力，我终于完成了这项工作。

我有一个简单的人员和部门数据库：

[ADO.NET 实体框架实体数据模型图与部门和人员对象 http://img39.imageshack.us/img39/1368/edmxdepartmentperson.gif](http://img39.imageshack.us/img39/1368/edmxdepartmentperson.gif)

我可以将强类型的 ASP.NET MVC 视图用于引用/导航属性！查看部门列表...

[带有 DropDownList 的 ASP.NET MVC http://img11.imageshack.us/img11/7619/dropdownlistdepartment.gif](http://img11.imageshack.us/img11/7619/dropdownlistdepartment.gif)

我的人/编辑视图的一部分：

```
<% using (Html.BeginForm()) {%>
    <%= Html.Hidden("Id", Model.Id) %>
    <fieldset>
        <legend>Fields</legend>
        <p>
            <label for="Name">Name:</label>
            <%= Html.TextBox("Name", Model.Name) %>
        </p>
        <p>
            <label for="DepartmentId">Department:</label>
            <%= Html.DropDownList("DepartmentId", new SelectList((IEnumerable)ViewData["Departments"], "Id", "Name"))%>
        </p>
        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
<% } %> 
```

我的个人控制器的一部分：

```
//
// GET: /Person/Edit/5

public ActionResult Edit(Guid id)
{
    ViewData["Departments"] = ctx.Department;
    Person model = (from Person p in ctx.Person
                    where p.Id == id
                    select p).FirstOrDefault();
    return View(model);
}

//
// POST: /Person/Edit

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Person model)
{
    ctx.AttachUpdated(model);  //extension
    ctx.SaveChanges();
    return RedirectToAction("Index");
} 
```

为了让它工作，我用一个新的 DepartmentId 属性扩展了 Person EntityObject。

```
using System;
using System.Data;
using System.Data.Objects.DataClasses;

namespace ProjectName.Models
{
    public partial class Person : EntityObject
    {
        public Guid DepartmentId
        {
            get
            {
                try
                {
                    return (Guid)this.DepartmentReference.EntityKey.EntityKeyValues[0].Value;
                }
                catch
                {
                    return Guid.Empty;
                }
            }
            set
            {
                this.DepartmentReference.EntityKey = new EntityKey("JunkEntities.Department", "Id", value);
            }
        }
    }
} 
```

我使用新的 AttachUpdated 和 ApplyReferencePropertyChanges 方法扩展了实体框架 ObjectContext：

```
using System;
using System.Data;
using System.Data.Objects;
using System.Data.Objects.DataClasses;

public static class EntityFrameworkExtensionMethods
{

    public static void AttachUpdated(this ObjectContext ctx, EntityObject objectDetached)
    {
        if (objectDetached.EntityKey == null)
        {
            String entitySetName = ctx.DefaultContainerName + "." + objectDetached.GetType().Name;
            Guid objectId = (Guid)objectDetached.GetType().GetProperty("Id").GetValue(objectDetached, null);
            objectDetached.EntityKey = new System.Data.EntityKey(entitySetName, "Id", objectId);
        }
        if (objectDetached.EntityState == EntityState.Detached)
        {
            object currentEntityInDb = null;
            if (ctx.TryGetObjectByKey(objectDetached.EntityKey, out currentEntityInDb))
            {
                ctx.ApplyPropertyChanges(objectDetached.EntityKey.EntitySetName, objectDetached);
                ctx.ApplyReferencePropertyChanges((IEntityWithRelationships)objectDetached,
                                                  (IEntityWithRelationships)currentEntityInDb);  //extension
            }
            else
            {
                throw new ObjectNotFoundException();
            }
        }
    }

    public static void ApplyReferencePropertyChanges(this ObjectContext ctx, IEntityWithRelationships newEntity, IEntityWithRelationships oldEntity)
    {
        foreach (var relatedEnd in oldEntity.RelationshipManager.GetAllRelatedEnds())
        {
            var oldRef = relatedEnd as EntityReference;
            if (oldRef != null)
            {
                var newRef = newEntity.RelationshipManager.GetRelatedEnd(oldRef.RelationshipName, oldRef.TargetRoleName) as EntityReference;
                oldRef.EntityKey = newRef.EntityKey;
            }
        }
    }

} 
```

我只是想在这里记录我的进步。请提出改进​​建议。

* * *

谢谢：

*   [亚历克斯·詹姆斯](http://blogs.msdn.com/alexj/archive/2009/03/25/tip-7-faking-foreign-key-properties-in-net-3-5-sp1.aspx)
*   [塞萨尔·德拉托雷](http://blogs.msdn.com/cesardelatorre/archive/2008/09/04/updating-data-using-entity-framework-in-n-tier-and-n-layer-applications-short-lived-ef-contexts.aspx)
*   [格里夫汤森](http://grifftownsend.blogspot.com/2008/08/small-extension-to-entity-framework.html)
*   [史蒂夫·威尔科克](https://stackoverflow.com/questions/898260/entitykey-and-applypropertychanges/898367#898367)
*   [吉斯塔](https://stackoverflow.com/questions/899734/strongly-typed-asp-net-mvc-with-entity-framework/902202#902202)
*   [托马斯·莱肯](https://stackoverflow.com/questions/895564/entity-framework-with-asp-net-mvc/895688#895688)
*   [托马斯·莱维斯克](https://stackoverflow.com/questions/921106/how-to-create-ado-net-entity-framework-objectcontext-extensions/921303#921303)
*   [丹尼·西蒙斯](http://blogs.msdn.com/dsimmons/archive/2008/01/16/ef-extension-method-extravaganza-part-i-objectstateentry.aspx)
*   [斯蒂芬·克鲁斯伯格](http://www.scip.be/index.php?Page=ArticlesNET26&Lang=NL)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-09-22T02:22:21.867

我已经开始使用 ASP.NET MVC，这就是我遇到这个线程的原因，所以我不确定你是否还在检查改进。

我不喜欢将新属性添加到实体框架上的部分类的想法，因为它不允许进行太多更改。尝试像这样标记您的部门下拉菜单“Department.Id”

```
<p>
    <label for="Department.Id">Department:</label>
<%= Html.DropDownList("Department.Id", new SelectList((IEnumerable)ViewData["Departments"], "Id", "Name"))%>
</p> 
```

MVC 框架的 ModelBinding 将获取该值并将其应用于“部门”导航属性的“Id”属性。我发现 Department 的其他值都是空的，但这并不重要。现在您可以检索正确的部门实体并将其应用于在模型中创建的新人员实体的部门导航属性绑定到您的操作参数，例如：

```
newPerson.Department = ctx.Department.First(d => d.DepartmentId == newPerson.Department.Id); 
```

通过这种方式，您根本不需要为它应该具有的属性更新您的实体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T18:58:19.273

改进您的编辑控件，以便它处理引发的异常并重新显示用户迄今为止输入的输入。我确定您将要这样做；）

更新您的视图以拥有验证器：

```
<label for="Name">Name:</label>
<%= Html.TextBox("Name", Model.Name) %>
<%= Html.ValidationMessage("Name", "*") %> 
```

然后在您的编辑中使用它们：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Person Model)
{
    try
    {
       ctx.AttachUpdated(Model);  //extension
       ctx.SaveChanges();
       return RedirectToAction("Index");
    }
    catch
    {
        foreach (var err in Model.Errors)
          ModelState.AddModelError(err.PropertyName, err.ErrorMessage)

        return View(Model);
    }
} 
```

# php - 在从 SVN 部署期间维护开发环境和实际环境之间的配置差异

> ID：922411
> 
> 赞同：4
> 
> 时间：2009-05-28T18:14:48.300
> 
> 标签：php, svn, configuration, makefile, release-management

我们使用 ExpressionEngine CMS (php) 创建网站。对于每个站点，我们设置一个 subversion 存储库并提交 EE 安装以及使用的任何自定义模板、图像、javascript 等。存储库中包含包含所有环境变量的文件和 .htaccess 文件。

我们有一个开发服务器，其中包含通过我们用于开发的提交后更新的存储库的工作副本。当我们准备好发布时，我们在 subversion 中创建一个分支，进行生产环境所需的任何更改，标记发布号，导出存储库，将其上传到实时服务器上的新目录，并将文件符号链接到位。回滚就像符号链接回以前的版本一样简单。

问题是我们必须修改开发服务器和生产服务器需要不同的环境变量的那一步。这就像（取消）注释会重定向到错误位置的 htaccess 规则，因为域不同而换出 google map API 密钥，运行脚本将 javascript 最小化为一个混淆文件以保持大小和 http 连接减少等.

问题是如何才能更加自动化？我们希望将发布程序降到最低限度。我熟悉 Capistrano 和 Make 等工具的存在，但我不确定如何让它们修改所有必要的文件......你将如何组织这样的事情？当它每两周发生一次时，这值得花时间自动化吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T03:47:01.020

通过打开 $_SERVER['HTTP_HOST'] 可以处理很多配置选项。

例如

```
switch ($_SERVER['HTTP_HOST']) {
    case 'developement.domain.com':
        $api_key = "dev environment api key";
        break;
    default:
        $api_key = "live environment api key";
} 
```

然后对于 .htaccess 问题，您可以使用 AccessFileName 指令在虚拟主机定义中设置备用 .htaccess 文件：

```
<VirtualHost *:80>
    ServerName sitename
    AccessFileName .htaccess-dev
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T18:32:19.527

**我通过将配置文件添加到Subversion 忽略列表**来处理这个问题。它已经在 Stackoverflow 上得到解决：[参见问题 #149485](https://stackoverflow.com/questions/149485/how-to-store-configuration-parameters-in-svn/149590#149590)

基本上，我只保留`setup.default.php`在 SVN 中，并且在每次安装中我手动将其复制到`setup.php`忽略列表中。这可以防止将文件重新签入到存储库中。此文件很少有更改，可以在需要时进行处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T04:13:04.463

另一种选择是将配置文件分支一次，进入发布分支，然后在目标上将它们标记为已编辑，然后使用合并脚本来记住如何进行三向合并。如果源上的配置发生更改，那么很可能会产生冲突，这是一件好事，因为您可能需要在目标上进行类似的更改。

因此，您在项目的生命周期中保持两棵树：开发和发布。随着事物在开发中的成熟，您将它们整合到发布中。如果您有更多涉及的发布过程，您也可以拥有第三个 QA 树。

当你拉一个新版本时，你从工作区域复制到“发布”区域（作为合并/集成），而不是拉一个全新的分支。如果您当时还想要发布树的即时快照，请创建一个单独的分支/副本/标签，仅用于存档目的。

顺便说一句：这是 Perforce 的亮点之一——它会记住你已经合并的内容，并且永远不会尝试合并两次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T10:16:48.797

我们通过维护一个特定于配置的目​​录来处理这个问题。

因此，例如，如果您在开发和生产之间有不同的 .htaccess 和 config.php 文件，它们将被维护在 /trunk/config/{environment}/

我们使用 ant/nant 脚本来创建发布包，这些脚本对每个环境都有一个构建任务。这些任务获取配置特定的文件。

--

另一位评论者建议打开 HTTP_POST。不幸的是，我不能直接发表评论（没有足够高的代表）。使用 HTTP_POST 来确定环境配置存在潜在的安全问题，因为它的值来自客户端。

# apache - 如何关闭使用 APXS 构建的 apache 模块的优化 (-02)

> ID：922420
> 
> 赞同：2
> 
> 时间：2009-05-28T18:17:51.990
> 
> 标签：apache

我正在尝试在 RHEL 上调试 apache 模块，并且优化正在阻碍。我尝试从 ut 中删除“-O2”，`EXTRA_CFLAGS`但`apache_2.2.4/build/config_vars.mk, b`没有帮助。APXS 非常复杂（而且我的 perl 非常差），以至于我不知道如何弄清楚这个标志是如何设置的。

由于发生了奇怪的事情，我想关闭所有 apache 的优化，而不仅仅是我们添加的模块（是的，几个）。

有人知道如何关闭优化器吗？（所以调试器可以很好地工作）。

TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-01T12:01:19.347

Marko 的答案很接近，但 -g 仅提供调试符号，并不会禁用优化器（有时是用于调试的[PITA ）。](http://de.urbandictionary.com/define.php?term=pita)

当我调试我的 mod_epp 模块时，我使用：

使用以下命令构建 apache：./configure --enable-maintainer-mode --prefix=/usr/local/apache2 使用以下命令构建/安装模块：/usr/local/apache2/bin/apxs -Wc,-O0 -c -i mod_epp.c

这导致将 -O2 和 -O0 都赋予 gcc，其中 -O0 获胜。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-25T03:55:09.837

再次查看您的 config_var.mk 文件

apxs 程序将所有这些条目整理为 CFLAGS

SHLTCFLAGS CFLAGS NOTEST_CPPFLAGS EXTRA_CPPFLAGS EXTRA_CFLAGS

你的 -O2 必须在其中之一。

另外，我的 config_var.mk 在我知道的 RHEL5 机器上的 /usr/lib/httpd/build/config_vars.mk 中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-30T22:25:25.090

```
mod_auth_foo.c：
        ${APXS} "-Wc,${AM_CFLAGS} ${DEFAULT_INCLUDES} ${CFLAGS}" -c mod_auth_foo.c ${AM_LDFLAGS} ${mod_auth_foo_LDFLAGS} ${mod_auth_foo_LIBADD}

```

是我`Makefile.am`用于 apache 模块的内容，这确实可以正确传播`-O0 -ggdb3`我通过`configure CFLAGS="-O0 -ggdb3"`. 生成的 make 输出将是

`/usr/lib64/apr-1/build/libtool --silent --mode=compile gcc -prefer-pic -fmessage-length=0 -O2 -Wall -D_FORTIFY_SOURCE=2 -fstack-protector -funwind-tables -fasynchronous-unwind-tables -g -fPIC -Wall -fno-strict-aliasing -DLDAP_DEPRECATED -DLINUX=2 -D_REENTRANT -D_GNU_SOURCE -pthread -I/usr/include/apache2 -I/usr/include/apr-1 -I/usr/include/apr-1 -D_FILE_OFFSET_BITS=64 -D_REENTRANT -Wall -Waggregate-return -Wmissing-declarations -Wmissing-prototypes -Wredundant-decls -Wshadow -Wstrict-prototypes -Winline -Wformat=2 -pipe -I.. -I.. -O0 -ggdb3 -c -o mod_auth_foo.lo mod_auth_foo.c && touch mod_auth_foo.slo`，看起来差不多。

不需要修改 Apache 文件。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-12-14T15:35:17.083

如果您添加'-Wc，-g'参数，它应该足以用于调试。

# image-processing - 如何使用 GDI+ 居中旋转图像？

> ID：922429
> 
> 赞同：7
> 
> 时间：2009-05-28T18:19:21.847
> 
> 标签：image-processing, gdi+, c++-cli

我正在尝试使用 GDI+ 将旋转图像居中到目标缓冲区。源缓冲区和目标缓冲区的大小不同。

源缓冲区是图像数据的大小：*(width, height)*。
目标缓冲区是适合**整个**旋转图像所需的矩形大小：*(rotatedWidth, rotateHeight)*。

这是我正在尝试的代码：

```
// Calculate the size needed for the image to be rotated into   
int width = /* some width */;
int height = /* some height */;
System::Windows::Size destSize 
  = IPMathUtilities::CalculateRotatedImageSize(rotateAreaBoundingPoints, 
    rotationDegree, width, height);

//
// Create source bitmap object
Bitmap^ sourceBitmap = gcnew Bitmap(width, height, width * 2, 
  PixelFormat::Format16bppRgb555, ptrSourceBuffer);

//
// Create destination bitmap object
int destBufferSize = destSize.Width * destSize.Height * 2;
BYTE* pDestBuffer = new BYTE[destBufferSize];
memset(pDestBuffer, 0, destBufferSize);
Bitmap^ destBitmap = gcnew Bitmap(destSize.Width, destSize.Height, 
  destSize.Width * 2, PixelFormat::Format16bppRgb555, (IntPtr)pDestBuffer);

//
// Draw rotated source image in destination image
Graphics^ g = Graphics::FromImage(destBitmap);
g->TranslateTransform(-width/2, -height/2);
g->RotateTransform(rotationDegree, MatrixOrder::Append);
g->TranslateTransform(destSize.Width / 2.0, destSize.Height / 2.0, 
  MatrixOrder::Append);
g->DrawImage(sourceBitmap, 0, 0, width, height); 
```

这**几乎**可以工作。它很接近 - 我发现如果*height*大于*width*，则旋转图像的左侧位置不正确。同样，如果*width*大于*height*，则旋转图像的顶部位置不正确。

一些注意事项：

*   `IPMathUtilities`是我写的一个实用类。
*   我 100% 肯定`IPMathUtilities::CalculateRotatedImageSize()`会计算出适合整个旋转图像所需的矩形的正确大小。100%确定。我已经对其进行了彻底的测试，并且可以正常工作。
*   我最近问了一个类似的问题：[为什么`iplRotate()`没有给我正确的结果？](https://stackoverflow.com/questions/870878/why-is-iplrotate-not-giving-me-correct-results). 我最终放弃了 IPL/IPP 并尝试了 GDI+。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T19:20:27.280

旋转后，首先将图像移回原来的位置，然后再增加一半的差异，新的画布更大。如果您在 CalculateRotatedImageSize 中的计算确实正确，那么它应该完全适合。刚刚测试了这段代码，它似乎工作：

```
g.TranslateTransform((float)(org.Width / -2), (float)(org.Height / -2));
g.RotateTransform(45, System.Drawing.Drawing2D.MatrixOrder.Append );
g.TranslateTransform((float)(org.Width / 2), (float)(org.Height / 2), System.Drawing.Drawing2D.MatrixOrder.Append);
g.TranslateTransform((float)((rotated.Width - org.Width) / 2), (float)((rotated.Height - org.Height) / 2), System.Drawing.Drawing2D.MatrixOrder.Append); 
```

编辑：对不起，当然

```
g.TranslateTransform((float)(org.Width / 2), (float)(org.Height / 2), System.Drawing.Drawing2D.MatrixOrder.Append);
g.TranslateTransform((float)((rotated.Width - org.Width) / 2), (float)((rotated.Height - org.Height) / 2), System.Drawing.Drawing2D.MatrixOrder.Append); 
```

真的和

```
g.TranslateTransform((float)(rotated.Width / 2), (float)(rotated.Height / 2), System.Drawing.Drawing2D.MatrixOrder.Append); 
```

这只是您发布的代码。似乎对我来说工作正常。

EDIT2：也许错误只是

```
g->DrawImage(sourceBitmap, 0, 0, width, height); 
```

尝试

```
g->DrawImage(sourceBitmap, 0, 0); 
```

反而

# flash - 来自闪存的 Amazon S3 安全访问

> ID：922431
> 
> 赞同：2
> 
> 时间：2009-05-28T18:19:37.120
> 
> 标签：flash, actionscript-3, ssl, amazon-s3, ssl-certificate

我正在尝试使用带有 ActionScript3 的 SSL 访问 Amazon S3 存储桶中的文件。

当我使用这种格式...

```
https://s3.amazonaws.com/bucket.name/filename 
```

我收到安全沙盒错误。“错误 #2048：违反安全沙箱：”

当我切换到这种格式时......

```
https://bucket.name.s3.amazonaws.com/filename 
```

它就像一个魅力（直到我在 Firefox 以外的浏览器上尝试它）。它会为其他浏览器生成证书错误（主机名不匹配）。一旦我添加异常，它就可以正常工作。但这不切实际。

第三个选项将是理想的版本...

```
https://www.myowndomain.com/filename 
```

...为所有浏览器生成相同的安全违规。不用说，域映射到存储桶。

存储桶有自己的 crossdomain.xml。

这些文件是自定义二进制文件。

```
<cross-domain-policy>
<allow-access-from domain="*" secure="false"/>
<site-control permitted-cross-domain-policies="all"/>
</cross-domain-policy> 
```

我浏览了 Flash Player 10 的安全白皮书和新规则。到目前为止还没有运气。

有任何想法吗？

* * *

好的，它变得更有趣了，我怀疑这是导致问题的原因。在清理我的存储桶的名称时，我过于简单化了。我的存储桶名称中有一个点，显然这不是一件好事。

[http://faindu.wordpress.com/2008/12/18/amazon-s3-flash-crossdomainxml-ie7-certifacte-error/](http://faindu.wordpress.com/2008/12/18/amazon-s3-flash-crossdomainxml-ie7-certifacte-error/)

因此，如果有替代方案，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T18:24:05.363

这是由于浏览器限制。此外，如果您尝试从 AS3 访问 S3，那么您可能会觉得[AS3 API](http://code.google.com/p/as3awss3lib/)非常有用，尽管这也遇到了浏览器限制：

> 这是一个用于访问 Amazon 的 S3 服务的 AS3 库。由于浏览器播放器的限制，它仅适用于 Apollo。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T22:18:40.117

在您的故障排除过程中，您是否启用了 Flash Player 的策略文件日志记录功能？您可以获得沙盒违规错误背后的更多具体信息。阅读以下内容以了解如何设置策略文件日志记录：[Flash Player 9 和 Flash Player 10 中的策略文件更改](http://www.adobe.com/devnet/flashplayer/articles/fplayer9_security_05.html)

就个人而言，我怀疑您至少应该能够使您的第三个选项起作用，因为您可以在[https://www.myowndomain.com/crossdomain.xml](https://www.myowndomain.com/crossdomain.xml)的根位置托管 crossdomain.xml - - 但让我们看看您的 crossdomain.xml 中有什么。我建议您在此处发布一份副本，必要时进行消毒。而且，告诉我们，您要在播放器中加载什么样的文件？

# linux - 自动切换同一项目的SVN分支

> ID：922432
> 
> 赞同：2
> 
> 时间：2009-05-28T18:20:10.847
> 
> 标签：linux, svn, environment-variables

开发人员在同一项目的不同 SVN 分支上工作时如何设置他们的环境路径，这样他们每次从一个分支切换到另一个分支时都不需要设置他们的路径？

我是一名 Python 开发人员，我发现自己在同一个项目的不同分支上工作，当我从一个分支切换到另一个分支时，每次导出 PYTHONPATH 都非常难看。

也就是说，如果您的 IDE 没有自动为您执行此操作（我正在使用 vim）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T21:39:59.027

对于另一种选择，您可以使用符号链接，然后让您的环境变量指向它。像：

```
branch1/
branch2/
current -> branch1/ 
```

然后，如果您想在 branch2 上工作，只需将“当前”指向它。您的环境变量将指向“当前”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T21:18:45.853

所以你的工作流程是将单独的分支保存在单独的工作目录中？很好，这是一个非常合理的 Subversion 工作流程。

就我个人而言，我会更改源代码控制中的任何 Python 程序，以查找它们自己的库并`sys.path`在导入任何内容之前进行修改；这样，无论他们搬到哪里，他们都可以工作。

```
#!/usr/bin/env python
import os, sys
basedir = os.path.dirname(os.path.realpath(__file__))
sys.path.insert(0, os.path.join(basedir, 'lib')) 
```

如果你不这样做，你可以在你的`~/bin`或其他任何地方放置一个包装器可执行文件`$PATH`，

```
#!/bin/bash
dir=$(pwd)
while [[ $dir != / ]]; do
    if [[ -d "$dir/lib" ]]; then
        export PYTHONPATH="$dir/lib${PYTHONPATH:+:$PYTHONPATH}"
        break
    fi
    dir="${dir%/*}"
done
if (($# > 0)); then exec "$@"; fi 
```

它只是在运行您想要的任何内容之前四处寻找要添加的`lib`目录`$PYTHONPATH`。也许将其命名为“ `py`”。

```
$ cd dir1 # dir1/lib 存在
$ py ./我的程序
$ cd ../dir2 # dir2/lib 存在
$ py ./我的程序

```

也可以有一个工作流，您可以将其留在单个工作目录中，[`svn sw`](http://svnbook.red-bean.com/en/1.1/ch04s05.html)用于更改分支。由于您的路径永远不会改变，`PYTHONPATH`即使分支更改，设置一次也将保持有效。

（这是[git](http://git-scm.com/docs/git-checkout)、 monotone 、 hg 等常用的工作流程）

# java - ANT - 运行单个目标但没有依赖项

> ID：922436
> 
> 赞同：9
> 
> 时间：2009-05-28T18:20:45.043
> 
> 标签：java, ant, build

我知道如何在 ANT 中运行单个目标，但它也会检查“depends”属性并在目标之前运行这些属性。有没有办法防止这种情况发生，或者有办法构造我的 ANT 文件以便我可以更轻松地做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T19:33:26.097

创建目标的“withoutdeps”版本。如果你有

```
<target name="A" depends="B">
   ...
</target> 
```

改成

```
<target name="A" depends="B,AwithoutDeps"/>

<target name="AwithoutDeps">
    ...
</target> 
```

现在您可以正常调用 A（这将触发 B，然后触发 AwithoutDeps），或者直接调用 AwithoutDeps 并且不触发任何依赖。[注意“depends”按顺序调用依赖项]

当然，选择一些比这些更好的名字；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T18:25:33.113

我认为您在这里唯一的简单选择就是复制相关目标并使其不具有依赖关系。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T19:38:25.043

一种可能性是在依赖目标上使用`if`or属性。`unless`例如：

```
<target name="dependency1" unless="dependency1.disabled">
  <echo>Hello from dependency 1!</echo>
</target>

<target name="dependency2" unless="dependency2.disabled">
  <echo>Hello from dependency 2!</echo>
</target>

<target name="main-target" depends="dependency1, dependency2">
  <echo>Hello from the main target!</echo>
</target> 
```

现在您可以运行 Ant`-Ddependency1.disabled=true`和/或`-Ddependency2.disabled=true`忽略您不想要的依赖项，但默认情况下仍会包含它们。

当然，`dependencies.disabled`如果这对您来说更容易，您可以简单地拥有一个“全局”属性。

如果您想与此行为*相反*（默认情况下排除依赖项），只需使用`if`而不是`unless`（并使用“dependency1.enabled”等属性名称而不是“禁用”）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T19:35:48.527

我会做这样的事情：

```
<target name="doSomethingNoDeps">
   ...
</target>

<target name="doSomething" depends="doSomeOther">
  <antcall target="doSomethingNoDeps"/>
</target> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-12-06T13:27:08.420

我用一段代码制作了我想要的宏。然后制作了 2 个目标，1 个使用“arg1”调用宏，第二个使用“arg2”调用宏。您也可以在不接受参数的情况下制作宏。

```
<macrodef name="macro-jar">
    <attribute name="dir" />
    <sequential>
        <jar destfile="${jar.name}">
            <fileset dir="@{dir}" .../>
            ...
            ...
        </jar>
    </sequential>
</macrodef> 
```

从代码中的 2 个位置调用它：
第一个：

```
<macro-jar dir="${dir.build}" /> 
```

第二：

```
<macro-jar dir="${dir.temp}" /> 
```

# vba - 让 Excel 2003 在 Word 文档中进行查找并返回出现次数

> ID：922437
> 
> 赞同：0
> 
> 时间：2009-05-28T18:21:34.153
> 
> 标签：vba, ms-word, find, excel-2003

我有一个包含单列字符串（大约 400 行）的 Excel 文档。我还有一个 Word 文档，它的 Excel 文档中可能有也可能没有这些字符串。如何让 Excel 在该 Word 文档中为该单列中的每一行进行查找并检索给定字符串出现的次数？我只有Office 2003。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T08:07:36.017

这是一个示例 Excel 宏，它计算匹配的数量并将其写在所需的字符串旁边。我在 Office 2007 上试过，但它也应该在 2003 上工作。该宏使用正则表达式，因此您需要将“Microsoft VBScript 正则表达式”库的引用添加到您的 VBA 项目（Visual Basic 编辑器 -> 工具 -> 引用）。

```
Sub GetMatchCount()
  Dim Text, i, re

  ' Replace with your Word document name
  Const WordFileName = "C:\Test.doc"

  With CreateObject("Word.Application")
    .Documents.Open (WordFileName)
    Text = .ActiveDocument.Range.Text
    .Quit
  End With

  Set re = New RegExp
  re.Global = True

  With ActiveSheet.UsedRange
    For i = 1 To .Rows.Count
      re.Pattern = .Cells(i, 1).Value
      .Cells(i, 2).Value = re.Execute(Text).Count
    Next
  End With
End Sub 
```

# c# - 我如何将参数传递给 .net ccr 中的 EnqueueTimer

> ID：922440
> 
> 赞同：0
> 
> 时间：2009-05-28T18:22:18.270
> 
> 标签：c#, .net, ccr

不清楚这里是否有 ccr 大师，但我们还是试试吧。

我的代码中有这个功能：

dq.EnqueueTimer(TimeSpan.FromMilliseconds(TIMEOUT), timeOutFn);

这将在超时后调用我的函数。但是，由于我在很多打开的套接字上都需要这个计时器，所以我想将一个参数（或 ID）传递给计时器函数。

你怎么做到这一点？

谢谢

R

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T08:52:42.057

像这样的事情应该这样做。

```
var timerPort = new Port<DateTime>();
dq.EnqueueTimer(TimeSpan.FromMilliseconds(TIMEOUT), timerPort);
timerPort.Receive(ignored => MyFunc(myParam)); 
```

# java - 提高 BufferedReader 速度

> ID：922441
> 
> 赞同：4
> 
> 时间：2009-05-28T18:22:55.053
> 
> 标签：java, performance

我正在处理许多 GB 的文本数据，我想知道是否有办法提高性能。例如，当处理 10 GB 的数据时，根本不处理它，只是逐行迭代，大约需要 3 分钟。

基本上我有一个包含 BufferedReader 的 dataIterator 包装器。我不断地调用这个迭代器，它返回下一行。

问题是正在创建的字符串数量吗？或者可能是函数调用的数量。我真的不知道如何分析这个应用程序，因为它被编译为 jar 并用作 STAF 服务。

任何和所有的想法表示赞赏？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T18:41:29.883

让我们从基础开始：**您的应用程序是 I/O-bound**。您不会因为对象分配、内存或 CPU 限制而遭受糟糕的性能。由于磁盘访问，您的应用程序运行缓慢。

如果您认为可以改进文件访问，则可能需要使用 JNI 进行较低级别的编程。如果您自己更有效地处理文件访问，则可以改进文件访问，这需要在较低级别上完成。

我不确定 using`java.nio`是否会为您提供您正在寻找的更好的性能，尽管它可能会给您在 I/O 运行时执行 CPU/内存密集型操作的更多自由。

原因是基本上，`java.nio`使用选择器包装文件读取，让您在读取缓冲区以供使用时收到通知，确实为您提供了异步行为，这可能有助于您的性能。但是*读取文件本身*是您的瓶颈，并且`java.nio`不会在该区域为您提供任何东西。

所以先尝试一下，但我不会对它抱太大希望。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T18:33:16.093

我认为[Java 的 NIO 包](http://java.sun.com/javase/6/docs/api/java/nio/package-summary.html)对您的需求非常有用。

[这篇 Wikipedia 文章](http://en.wikipedia.org/wiki/New_I/O)有一些关于“旧”Java I/O 的特定改进的重要背景信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T22:34:44.797

使用 NIO、通道、字节缓冲区和内存映射文件将为您提供最佳性能。它与您将要获得的硬件一样接近。我有一个类似的问题，我必须解析超过 600 万行分隔的文本（265MB 文件），然后在行中的分隔列周围移动，然后将其写回。使用 NIO 和 2002 硬件需要 33 秒才能完成此操作。诀窍是将数据保留为字节。您有一个线程读取数据以提取该行，另一个线程来操作该行，以及第三个线程将其写回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T18:40:26.423

如果程序是通过常规的“java -options...ClassName args...”命令行启动的，您可以对其进行分析。我最熟悉 NetBeans Profiler。它有一种方法可以单独启动 java 应用程序（[在启动时添加 java 选项](http://blogs.oracle.com/nbprofiler/entry/understanding_profiler_agent_parameters)）然后附加分析器。

如果您尝试优化而不衡量需要改进的地方，那么您就是在黑暗中工作。你可能会很幸运，或者你可能会花很多时间做不相关的工作。

# c++ - 安全且跨越库边界的唯一类类型 ID

> ID：922442
> 
> 赞同：14
> 
> 时间：2009-05-28T18:22:58.113
> 
> 标签：c++, class, templates, unique

我会很感激任何帮助，因为 C++ 不是我的主要语言。

我有一个在多个库中派生的模板类。我试图找出一种方法来为每个派生类唯一地分配一个 id int。不过，我需要能够通过静态方法来做到这一点，即。

```
 template < class DERIVED >
class Foo
{
public:
    static int s_id()
    {
        // return id unique for DERIVED
    }
    // ...
}; 
```

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-10-07T19:44:03.710

这可以用很少的代码来完成：

```
template < class DERIVED >
class Foo
{
public:
    static int s_id()
    {
        return reinterpret_cast<int>(&s_id);
    }
}; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-28T22:26:42.893

**在现代 C++（03 - 假设您使用的是像 gcc 这样的最新编译器）中，您可以使用[typeid](http://en.wikipedia.org/wiki/Typeid)关键字来获取至少在运行时提供基本类型信息的 type_info 对象 - 这是一个标准（然后是跨平台）功能**.

我从 wikipedia 中获取了这个例子并添加了一个模板/继承检查，它似乎运行良好，但我不确定 int 版本（这是一个黑客利用编译器将在某个地方具有类型名称的假设）只读内存空间......这可能是一个错误的假设）。

字符串标识符对于跨平台识别似乎要好得多，如果您可以在您的情况下使用它。它不是交叉编译器兼容的，因为它给您的名称是标准的“实现定义” - 正如评论中所建议的那样。

完整的测试应用代码：

```
#include <iostream>
#include <typeinfo>  //for 'typeid' to work

class Person 
{
public:
   // ... Person members ...
   virtual ~Person() {}
};

class Employee : public Person 
{
   // ... Employee members ...
};

template< typename DERIVED >
class Test
{
public:
    static int s_id()
    {
        // return id unique for DERIVED
        // NOT SURE IT WILL BE REALLY UNIQUE FOR EACH CLASS!!
        static const int id = reinterpret_cast<int>(typeid( DERIVED ).name());
        return id;
    }

    static const char* s_name()
    {
        // return id unique for DERIVED
        // ALWAYS VALID BUT STRING, NOT INT - BUT VALID AND CROSS-PLATFORM/CROSS-VERSION COMPATBLE
        // AS FAR AS YOU KEEP THE CLASS NAME
        return typeid( DERIVED ).name();
    }
};

int wmain () 
{
    Person person;
    Employee employee;
    Person *ptr = &employee;

    std::cout << typeid(person).name() << std::endl;   // Person (statically known at compile-time)
    std::cout << typeid(employee).name() << std::endl; // Employee (statically known at compile-time)
    std::cout << typeid(ptr).name() << std::endl;      // Person * (statically known at compile-time)
    std::cout << typeid(*ptr).name() << std::endl;     // Employee (looked up dynamically at run-time
                                                    // because it is the dereference of a pointer to a polymorphic class)

    Test<int> test;
    std::cout << typeid(test).name() << std::endl;    
    std::cout << test.s_id() << std::endl;    
    std::cout << test.s_id() << std::endl;    
    std::cout << test.s_id() << std::endl;    
    std::cout << test.s_name() << std::endl;    

    Test< Person > test_person;
    std::cout << test_person.s_name() << std::endl;    
    std::cout << test_person.s_id() << std::endl;    

    Test< Employee > test_employee;
    std::cout << test_employee.s_name() << std::endl;    
    std::cout << test_employee.s_id() << std::endl;    

    Test< float > test_float;
    std::cout << test_float.s_name() << std::endl;    
    std::cout << test_float.s_id() << std::endl;    

    std::cin.ignore();
    return 0;
} 
```

输出：

```
class Person
class Employee
class Person *
class Employee
class Test<int>
3462688
3462688
3462688
int
class Person
3421584
class Employee
3462504
float
3462872 
```

这至少适用于 VC10Beta1 和 VC9，应该适用于 GCC。顺便说一句，要使用 typeid（和 dynamic_cast），您必须在编译器上允许运行时类型信息。它应该默认开启。在某些平台/编译器（我正在考虑一些嵌入式硬件）上，RTTI 没有打开，因为它有成本，所以在某些极端情况下，您必须找到更好的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T18:41:47.667

在我以前的公司中，我们通过创建一个宏来做到这一点，该宏将类名作为参数，创建一个具有唯一 id（基于类名）的本地静态，然后创建一个在基类中声明的虚函数的覆盖返回静态成员。这样，您可以在运行时从对象层次结构的任何实例中获取 ID，类似于 java 对象中的“getClass()”方法，但更原始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-01-10T17:06:47.420

```
#include <stdint.h>
#include <stdio.h>

#define DEFINE_CLASS(class_name) \
    class class_name { \
    public: \
        virtual uint32_t getID() { return hash(#class_name); } \

// djb2 hashing algorithm
uint32_t hash(const char *str)
{
    unsigned long hash = 5381;
    int c;

    while ((c = *str++))
        hash = ((hash << 5) + hash) + c; /* hash * 33 + c */

    return hash;
}

DEFINE_CLASS(parentClass)

    parentClass() {};
    ~parentClass() {};
};

DEFINE_CLASS(derivedClass : public parentClass)

    derivedClass() : parentClass() {};
    ~derivedClass() {};
};

int main() {
    parentClass parent;
    derivedClass derived;
    printf("parent id: %x\nderived id: %x\n", parent.getID(), derived.getID());
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-14T09:28:38.813

到目前为止，我对答案并不是 100% 满意，我已经为我制定了一种解决方案。这个想法是使用 typeinfo 计算类型名称的散列。加载应用程序时一切都完成一次，因此没有运行时过载。该解决方案也可以使用共享库作为类型名称，并且它的哈希值将是一致的。

这是我使用的代码。这对我很有用。

```
#include <string>
#include <typeinfo>
#include <stdint.h>

//###########################################################################
// Hash
//###########################################################################
#if __SIZEOF_POINTER__==8
inline uint64_t hash(const char *data, uint64_t len) {
    uint64_t result = 14695981039346656037ul;
    for (uint64_t index = 0; index < len; ++index)
    {
        result ^= (uint64_t)data[index];
        result *= 1099511628211ul;
    }
    return result;
}
#else
inline uint32_t hash(const char *data, uint32_t len) {
    uint32_t result = 2166136261u;
    for (uint32_t index = 0; index < len; ++index)
    {
        result ^= (uint32_t)data[index];
        result *= 16777619u;
    }
    return result;
}
#endif
inline size_t hash(const std::string & str) { return hash(str.c_str(), str.length()); }

//###########################################################################
// TypeId
//###########################################################################
typedef size_t TypeId;

template<typename T>
static const std::string & typeName() {
    static const std::string tName( typeid(T).name() );
    return tName;
}
template<typename T>
static TypeId typeId() {
    static const TypeId tId = hash( typeName<T>() );
    return tId;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T20:45:16.983

什么样的身份证？你在寻找一个原子增加的 int 吗？如果字符串没问题，那又如何：

```
static string s_id()
{
   return typeid(Foo<DERIVED>).name();
} 
```

如果它需要是一个 int，但不是自动增加，您可以将其散列为一个不太可能发生冲突的 128 位整数（尽管可能比您需要的数字更大）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-29T19:04:34.983

这就是我最终做的事情。如果您有任何反馈（优点，缺点），请告诉我。

```
 template < class DERIVED >
class Foo
{
public:
    static const char* name(); // Derived classes will implement, simply

                               // returning their class name
    static int s_id()
    {
        static const int id = Id_factory::get_instance()->get_id(name());
        return id;
    }
    // ...
}; 
```

本质上，将在进行字符串比较而不是指针比较之后分配 id。这在速度方面并不理想，但我将 id 设为静态 const，因此它只需要为每个 DERIVED 计算一次。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-03-31T06:13:05.857

下面的代码片段适用于 VS(2015) 和 Release 版本：

```
template <typename T>
struct TypeId
{
  static size_t Get()
  {
    return reinterpret_cast<size_t>(&sDummy);
  }

private:
  static char sDummy;
};

template <typename T>
char TypeId<T>::sDummy; // don't care about value 
```

还在 GCC v7.3 (Ubuntu 16.04) 和 LLVM v10.0.0 (Mac OS High Sierra) 上进行了尝试和测试。

它是如何工作的：`TypeId<>`模板的每个实例化都有它自己的、唯一的 sDummy 实例和它自己的、唯一的地址。老实说，我不完全确定为什么函数静态版本在发布时不起作用——我怀疑相同的 comdat 折叠和优化。

读者练习：至少 const 和 ref 类型应该获得与原始类型相同的类型 ID。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T18:35:14.717

没有什么标准化的。此外，我发现没有任何破解方法是万无一失的。

我能想到的最好的：

```
template < class DERIVED, int sid >
class Foo
{
    public:    
      static int s_id()    
      {        
          return sid;
      }    
};

Foo<MyClass, 123456>   derivedObject; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T18:38:06.973

您可以执行以下操作：

```
#include <iostream>

template <int id = 5>
class blah
{
public:
    static const int cid = id; 
};

int main(int argc, char *argv[])
{
    std::cout << blah<>::cid << " " << blah<10>::cid << std::endl;

} 
```

我不知道这是否是个好主意。这`blah<>`部分也有点不直观。也许你最好手动为它们分配 id，或者你可以创建一个基本类型，给它一个带有你的类 id 的模板参数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-07-16T14:48:04.143

正如[Paul Houx在](https://stackoverflow.com/users/858219/paul-houx)[这里](https://stackoverflow.com/questions/922442/unique-class-type-id-that-is-safe-and-holds-across-library-boundaries#comment56494414_7692147)指出的那样，由于编译器优化，返回静态方法地址的技巧可能不起作用。但是我们可以使用`__FILE__`and `__LINE__`macros +`volatile`关键字来解决问题。

最终解决方案将如下所示：

```
#define GET_TYPE_ID static size_t GetTypeId()   \
{                                               \
    volatile const char* file = __FILE__;       \
    volatile uint32_t line = __LINE__;          \
    return (size_t)&GetTypeId;                  \
}

class ClassA
{
public:
    GET_TYPE_ID
};

class ClassB
{
public:
    GET_TYPE_ID
}; 
```

# c# - 如何安排 C# Windows 服务每天运行一个方法？

> ID：922444
> 
> 赞同：2
> 
> 时间：2009-05-28T18:23:06.723
> 
> 标签：c#, windows, windows-services, scheduling

> **可能重复：**
> [我如何安排 C# Windows 服务每天执行任务？](https://stackoverflow.com/questions/503564/how-might-i-schedule-a-c-windows-service-to-perform-a-task-daily)

我正在创建一个 C# Windows 服务，但我没有找到让计时器在 App.Config 文件中指定的特定时间每天触发一个方法的最佳方法（例如，每天早上 6:00，我的方法被执行）。

你怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T18:28:32.843

这段代码应该这样做：

```
Trigger tg = new DailyTrigger();
ScheduledTasks st = new ScheduledTasks();
Task t = st.OpenTask("foo");
t.Triggers.Add(tg);
t.Save(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T18:31:00.327

创建计划任务。这是迄今为止最简单的方法。如果您有足够的权限来安装服务，那么您应该有足够的权限来设置计划任务。

# regex - 如何在bash中用一个空行替换多个空行？

> ID：922449
> 
> 赞同：51
> 
> 时间：2009-05-28T18:24:16.940
> 
> 标签：regex, bash

我有一个文件，其中包含：

```
something

something else

something else again 
```

我需要一个 bash 命令 sed/grep 我们将产生以下输出

```
something

something else

something else again 
```

换句话说，我需要用一个空行替换多个空行。grep/sed 是基于行的。我从未找到适用于多行正则表达式模式的 BASH 解决方案。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-06-01T11:32:01.560

对于 BSD 衍生系统（包括 GNU）：

您只需要`cat`使用`-s`导致它从其输出中删除重复的空行的选项：

```
cat -s 
```

从手册页：`-s --squeeze-blank: suppress repeated empty output lines.`

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2016-07-22T07:06:08.160

我刚刚解决了这个问题`sed`。即使这是一个 7 年前的问题，有人可能会觉得这很有帮助，所以我在`sed`这里写下我的解决方案：

```
sed 'N;/^\n$/D;P;D;' 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-28T18:45:38.283

```
grep -A1 . <yourfile> | grep -v "^--$" 
```

假设您需要以下内容，则此 grep 解决方案有效：

**输入**

```
line1

line2
line3

line4

line5
```

**输出**

```
line1

line2
line3

line4

line5
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-28T18:37:27.427

实际上，如果你用一个换行符替换多个换行符，输出将是：

```
something
something else
something else again 
```

您可以通过以下方式实现：

```
sed /^$/d FILE 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-28T18:41:38.013

一个解决方案`awk`，用一个空行替换几个空行：

```
awk 'BEGIN{bl=0}/^$/{bl++;if(bl==1)print;else next}/^..*$/{bl=0;print}' myfile 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-28T18:42:21.457

通常，如果我发现 sed 不能做我需要的事情，我会转向 awk：

```
awk '
BEGIN {
    blank = 0;
}

/^[[:blank:]]*$/ {
     if (!blank) {
          print;
     }
     blank = 1;
     next;
}

{
     print;
     blank = 0;
}' file 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-05-27T17:18:30.160

如果有人想使用 perl

```
perl -00pe0 < file 
```

会做同样的事情，因为`cat -s`:)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-12-05T08:19:52.067

使用 awk：

```
awk '{ /^\s*$/?b++:b=0; if (b<=1) print }' file 
```

分解：

```
/^\s*$/?b++:b=0
    - ? :       the ternary operator
    - /^\s*$/   matches a blank line
    - b         variable that counts consecutive blank lines (b++).
                however, if the current line is non-blank, b is reset to 0.

if (b<=1) print
    print if the current line is non-blank (b==0)
          or if there is only one blank line (b==1). 
```

通过调整正则表达式，您可以将其推广到其他场景，例如在电子邮件中挤压多个空行 (">")： [https ://stackoverflow.com/a/59189823/12483961](https://stackoverflow.com/a/59189823/12483961)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-07-26T16:54:52.210

这在多个文件上使用了[marco 的解决方案：](https://stackoverflow.com/a/934451/879121)

```
for i in *; do FILE=$(cat -s "$i"); echo "$FILE" > "$i"; done 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-28T18:30:43.150

使用蟒蛇：

```
s = file("filename.txt").read()
while "\n\n\n" in s: s = s.replace("\n\n\n", "\n\n")
import sys
sys.stdout.write(s) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-07-22T18:24:13.653

Python，带有正则表达式：

```
import re
import sys
sys.stdout.write(re.sub('\n{2,}','\n\n', sys.stdin.read())) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-28T18:35:54.170

用 vim 做起来超级简单。只需打开文件并键入以下内容：

```
:%s/\n\n\n*/\r\r/ 
```

这会将超过 2 个新行的所有块减少到 2 个新行。希望这可以帮助！

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2009-05-28T18:41:00.353

我认为您可能想要删除只有空格的行。

这可以通过以下方式完成：

```
sed /^[:space:]*$/d FILE 
```

* * *

## 回答 #14

> 赞同：-6
> 
> 时间：2009-05-31T14:57:12.370

流水线到 | *uniq*可能是解决方案（如果不是空行不重复）

# php - 运行 Cron 作业

> ID：922466
> 
> 赞同：9
> 
> 时间：2009-05-28T18:29:35.587
> 
> 标签：php, cron

如果我有一个每 10 分钟运行一次的 cron 作业，并且由于某种原因，这一次需要 12 分钟才能运行该作业，那么 cron 会在前一个仍在运行时启动我的代码的另一个实例吗？如果是这样，你怎么能在linux上防止这种情况？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T18:33:57.620

是的，它会。

您应该让您的程序创建一个 .pid 文件（例如在 /var/run/ 中）。当它启动时，它应该检查这样的文件是否已经存在，如果存在则退出。

您正在运行哪个程序/脚本？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T20:15:29.257

是的。无论前一个进程是否完成，Cron 都会在预定的时间间隔内启动一个进程。

您可以`touch`创建一个文件，如另一个答案中所述，并在参与您的流程之前检查其是否存在。

或者您可以检查进程列表以查看“实例”是否已在运行：

```
ps -ef | grep *your_script_name* | grep -v grep | wc -l 
```

# iis-6 - 以编程方式从元数据库 IIS6 中删除 etag 后缀（更改编号）

> ID：922472
> 
> 赞同：3
> 
> 时间：2009-05-28T18:30:47.253
> 
> 标签：iis-6, wmi, adsi, etag, metabase

IIS 6.0 以“hash:changenumber”的格式生成 eTag 值。每次 IIS 重置时，changenumber 都会增加，因此您的 eTag 仅在 IIS 进程的生命周期内有效。重启，数字上升，hash:changenumber != hash:changenumber+1。

[解决此问题的方法是对 changenumber 进行硬编码](http://support.microsoft.com/kb/922703/)，这可以使用元数据库资源管理器（一种用于编辑元数据库的 .NET 实用程序）或通过在 IIS 服务停止时编辑 XML 文件来实现。

我想在服务器运行的情况下以编程方式执行此操作，就像我可以使用 ADSI 或 WMI 设置所有其他元数据库属性一样。对于这个似乎不可能，因为该属性（仅在内部称为 MD_ETAG_CHANGENUMBER）似乎没有匹配的属性名称。

以下是 VBScript 中的问题示例：

```
set obj=GetObject("IIS://localhost/W3svc")
WScript.Echo "Log type: " & obj.LogType
WScript.Echo "Change number: " & obj.MD_ETAG_CHANGENUMBER 
```

输出：

> ```
> Log type: 1
> etag.vbs(3, 1) Microsoft VBScript runtime error: Object doesn't support this property or method: 'obj.MD_ETAG_CHANGENUMBER' 
> ```

我希望能够在 C# 中设置这个值。除了停止 IIS、在 XML 中设置值并重新启动它之外，是否有一种以编程方式设置此值的方法？

我最好的想法是（ab）使用 Metabase Explorer 附带的 ISMbLib.dll，所以如果有人有使用它的经验，我很想听听。

参考：

*   [MD_ETAG_CHANGENUMBER 元数据库属性 (IIS 6.0)](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/ef7f9d58-2a96-4bd8-8ac1-2a67b43284f1.mspx?mfr=true)
*   [IIS 论坛线程讨论问题，没有解决方案](http://forums.iis.net/p/1147600/1861998.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T06:13:36.037

crb，感谢出色的解决方案，我无法找到替代方案（尽管我之前通过一些棘手的 ADSI 脚本将我自己的自定义元数据库属性添加到 IIS 6 架构中，这些脚本由自定义 ISAPI 使用）

这是您的解决方案的 powershell 版本。它假定 MB Explorer 程序集在本地复制到它。

```
$myPath = [System.IO.Path]::GetDirectoryName($MyInvocation.MyCommand.Path)

Import-Module "$myPath\IISMbLib.dll"

$etagValue = 12345
$metabase = New-Object IISConfig.Metabase
$metabase.OpenLocalMachine()

$key = $metabase.GetKeyFromPath("/LM/W3SVC")

if ($key.ContainsRecord(2039) -eq [IISConfig.ValueExistOptions]::Explicit)
{
    $record = $key.GetRecord(2039)
    Write-Host "Existing ETag value found:", $record.Data.ToString()
}
else
{
    Write-Host "Creating new value..."
    $record = New-Object IISConfig.Record
    $record.DataType = [IISConfig.Record+DataTypes]::DWORD
    $record.Identifier = 2039
    $record.ChangeAttribute([IISConfig.Record+AttributeList]::Inherit, $true)
}
$record.Data = [System.Convert]::ToUInt32($etagValue)
Write-Host "New ETag value:", $record.Data.ToString()
$key.SetRecord($record) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:57:38.343

我最好的想法是非常好的。这是一个解决方案，它依赖于 IIS 6.0 Resource Kit 中 Metabase Explorer 中的 ISMbLib.dll。

```
 Metabase metabase = new Metabase();
        metabase.OpenLocalMachine();

        IKey key = metabase.GetKeyFromPath("/LM/W3SVC/");
        if (key.ContainsRecord(2039) == IISConfig.ValueExistOptions.Explicit) {
            Record r = key.GetRecord(2039);
            r.Data = Convert.ToUInt32(0);
            key.SetRecord(r);
        } else {
            Record r = new Record();
            r.Data = Convert.ToUInt32(0);
            r.DataType = Record.DataTypes.DWORD;
            r.Identifier = 2039;
            r.ChangeAttribute(Record.AttributeList.Inherit, true);
            key.SetRecord(r);
        } 
```

# multithreading - 将 gprof 与 pthread 一起使用

> ID：922475
> 
> 赞同：4
> 
> 时间：2009-05-28T18:31:14.040
> 
> 标签：multithreading, profiling, pthreads, gprof

gprof 可以用来分析使用 pthread 的多线程程序吗？也就是说，它的输出是否包括所有线程中使用的时间？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T18:32:06.703

是的，可以借助[此处](http://sam.zoy.org/writings/programming/gprof.html)描述的解决方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-03T15:34:59.647

你考虑过[**pstack**](https://stackoverflow.com/questions/1834103/ways-to-corner-a-stickiness-bug/1834447#1834447)吗？它适用于多个线程，并且非常适合通过 stackshot 方法查找性能问题。 [**gprof**](https://stackoverflow.com/questions/1777556/alternatives-to-gprof/1779343#1779343)就是这样，但您可能会做得更好。

# javascript - 如何从浏览器中读取客户端的机器/计算机名称？

> ID：922476
> 
> 赞同：58
> 
> 时间：2009-05-28T18:31:53.727
> 
> 标签：javascript, asp.net, computer-name

如何从浏览器中读取客户端的机器/计算机名称？
是否可以使用 JavaScript 和/或 ASP.NET？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-28T18:43:19.287

您可以“有时”使用 IE 来执行此操作，因为我已经为仅 IE 的 Intranet 上的内部应用程序执行此操作。尝试以下操作：

```
function GetComputerName() {
    try {
        var network = new ActiveXObject('WScript.Network');
        // Show a pop up if it works
        alert(network.computerName);
    }
    catch (e) { }
} 
```

它可能需要也可能不需要在 IE 中进行一些特定的安全设置设置，以允许浏览器访问 ActiveX 对象。

以下是有关 WScript 的更多信息的链接：[更多信息](http://www.pctools.com/guides/scripting/id/3/?act=reference)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-28T18:46:07.050

浏览器、操作系统、屏幕颜色、屏幕分辨率、Flash 版本和 Java 支持都应该可以从 JavaScript 中检测到（可能还有更多）。但是，计算机名称是不可能的。

编辑：至少在所有浏览器中都不可能。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-28T19:01:05.133

好吧，您可以使用 asp.net 获取 ip 地址，然后对 ip 进行反向 DNS 查找以获取主机名。

来自 ASP.NET Developer's cookbook ... [Performing a Reverse-DNS Lookup](https://web.archive.org/web/20160704023427/http://aspalliance.com/cookbook/ViewSource.aspx?Filename=Recipe2110cs.aspx&RecipeType=ASPX)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-28T18:35:16.667

无法使用 Javascript 获取用户计算机名称。您可以获得有关浏览器和网络的所有详细信息。但不止于此。

就像今天有人在上一个问题中回答的那样。

我已经帮了您的忙，可能会返回或推荐其他朋友.. 我还告诉过您我在哪里以及我使用的操作系统、浏览器和屏幕分辨率您为什么想知道我的内衣颜色？;-)

你也不能使用 asp.net 来做到这一点。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-03-08T05:33:21.767

尝试使用下面给出的代码在 Mozilla Firefox 中获取客户端计算机名称。

```
netscape.security.PrivilegeManager.enablePrivilege( 'UniversalXPConnect' ); 

var dnsComp = Components.classes["@mozilla.org/network/dns-service;1"]; 
var dnsSvc = dnsComp.getService(Components.interfaces.nsIDNSService);
var compName = dnsSvc.myHostName; 
```

此外，可以将同一段代码作为扩展，并且可以从您的网页调用。

请在下面找到示例代码。

扩展代码：

```
var myExtension = {
  myListener: function(evt) {

//netscape.security.PrivilegeManager.enablePrivilege( 'UniversalXPConnect' ); 
var dnsComp = Components.classes["@mozilla.org/network/dns-service;1"]; 
var dnsSvc = dnsComp.getService(Components.interfaces.nsIDNSService);
var compName = dnsSvc.myHostName;
content.document.getElementById("compname").value = compName ;    
  }
}
document.addEventListener("MyExtensionEvent", function(e) { myExtension.myListener(e); }, false, true); //this event will raised from the webpage 
```

网页代码：

```
<html>
<body onload = "load()">
<script>
function showcomp()
{
alert("your computer name is " + document.getElementById("compname").value);
}
function load()
{ 
//var element = document.createElement("MyExtensionDataElement");
//element.setAttribute("attribute1", "foobar");
//element.setAttribute("attribute2", "hello world");
//document.documentElement.appendChild(element);
var evt = document.createEvent("Events");
evt.initEvent("MyExtensionEvent", true, false);
//element.dispatchEvent(evt);
document.getElementById("compname").dispatchEvent(evt); //this raises the MyExtensionEvent event , which assigns the client computer name to the hidden variable.
}
</script>
<form name="login_form" id="login_form">
<input type = "text" name = "txtname" id = "txtnamee" tabindex = "1"/>
<input type="hidden" name="compname" value="" id = "compname" />
<input type = "button" onclick = "showcomp()" tabindex = "2"/>

</form>
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T18:35:52.970

不，此数据未公开。唯一可用的数据是通过 HTTP 请求公开的数据，其中可能包括其操作系统和其他此类信息。但肯定不是机器名。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-06-07T19:41:16.470

没有办法这样做，因为 JavaScript 无法访问计算机名称、文件系统和其他本地信息。安全是主要目的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-03T16:58:57.557

有一些信息可以解析到 webRTC 标头中。

```
var p = new window.RTCPeerConnection();
p.createDataChannel(null);
p.createOffer().then((d) => p.setLocalDescription(d))
p.onicecandidate = (e) => console.log(p.localDescription)
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-01-30T11:07:02.173

```
<html>
<body onload = "load()">
<script>
  function load(){ 

     try {
       var ax = new ActiveXObject("WScript.Network");
       alert('User: ' + ax.UserName );
       alert('Computer: ' + ax.ComputerName);
     }
     catch (e) {
       document.write('Permission to access computer name is denied' + '<br />');
     } 
  }
</script>
</body>
</html> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-08-15T10:46:53.937

来自 Kelsey 的更新版本：

```
$(function GetInfo() {
    var network = new ActiveXObject('WScript.Network');
        alert('User ID : ' + network.UserName + '\nComputer Name : ' + network.ComputerName + '\nDomain Name : ' + network.UserDomain);
        document.getElementById('<%= currUserID.ClientID %>').value = network.UserName;
        document.getElementById('<%= currMachineName.ClientID %>').value = network.ComputerName;
        document.getElementById('<%= currMachineDOmain.ClientID %>').value = network.UserDomain;
}); 
```

要存储值，请添加以下控件：

```
<asp:HiddenField ID="currUserID" runat="server" /> <asp:HiddenField ID="currMachineName" runat="server" /> <asp:HiddenField ID="currMachineDOmain" runat="server" /> 
```

你也可以像这样从后面调用它：

```
Page.ClientScript.RegisterStartupScript(this.GetType(), "MachineInfo", "GetInfo();", true); 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-05-29T00:31:14.500

Erm有什么理由不能只使用HttpRequest吗？这将在服务器端，但如果需要，您可以将其传递给 javascript？

```
Page.Request.UserHostName 
```

[HttpRequest.UserHostName](http://msdn.microsoft.com/en-us/library/system.web.httprequest.userhostname.aspx)

这样做的一个问题是它只能在 Intranet 环境中真正工作，否则它最终只会获取用户路由器或代理地址......

# user-interface - 在 GUI 应用程序中播放视频的多媒体框架？

> ID：922479
> 
> 赞同：0
> 
> 时间：2009-05-28T18:32:11.150
> 
> 标签：user-interface, video, playback, multimedia

前段时间我开始了一个项目，我需要做以下事情：

*   播放视频：
    *   以任何常见格式（avi、mpeg、xvid 等）
    *   能够以编程方式暂停和重新定位流。
    *   能够设置播放速度（不是强制性的，但可取的）
*   让我在播放组件上绘制自定义图形（与视频保持同步）。
*   允许以光栅图像的形式访问当前帧（这不是强制性的，但可取）。

并且易于使用（例如面向视觉组件，我不想过多处理多媒体流内部）。

因为我已经有一些用 Java 编写的相关代码，所以我尝试使用我找到的所有 Java 库（JMF、FMJ、JVLC、Jffmpeg、gstreamer-java），但没有人满足我所有的硬性要求（例如，那些允许我画在框架上不能暂停或倒带，那些功能齐全的已经过时了，等等），所以我搁置了这个项目。

现在我正准备卷土重来，我不介意用其他语言重写代码（等于或高于 Java 的级别，但请不要使用 C 或 C++，我变得太懒了:-p）它具有良好的 GUI 框架或免费提供的富客户端平台。多平台是一个好点，因为我喜欢在 Linux 中进行开发和测试，但我想接触更多的受众，所以能够以 Windows 为目标是必须的。

那么你会推荐我什么语言和框架呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T19:50:25.813

[Qt 的声子](http://doc.trolltech.com/4.5/phonon-overview.html)。Qt 也可用于 Java，如[Qt Jambi](http://doc.trolltech.com/qtjambi-4.4/html/com/trolltech/qt/qtjambi-index.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-08T10:59:59.400

如果您不完全害怕只使用 Windows，WPF 应该响应几乎所有（如果不是全部）您的需求。

您可以将它与 C# 和所有 .net 语言一起使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T16:34:20.260

我会使用 OpenCV 库。您需要的所有功能：格式支持、任何帧获取、帧修改等。查看此[安装指南](http://ubaa.net/shared/processing/opencv/)和一些示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-04T16:44:21.287

您可能会考虑的另一个框架是 mlt 框架：[http ://mltframework.org/](http://mltframework.org/)

它的设计很棒，用 C 语言编写，并使用 SWIG 进行语言绑定（java、perl、php、python、ruby、tcl）。我知道人们已经在大多数主要平台上运行它。

要了解它的功能，请查看令人敬畏的 NLE kdenlive，它是最活跃的用户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T22:00:34.410

你说你试过gstreamer-java。也许它的绑定不是那么好？我很确定 Gstreamer 可以满足您的所有要求。也许您应该改为查看 Python 绑定。Python 是 Gstreamer 开发人员的一等公民，因此绑定应该始终是完整的和最新的。

Python 也有多个可用的跨平台 GUI 框架。我个人喜欢使用 libglade 的 GTK，因为使用 glade 构建 GUI 非常容易，而且它是 XML 文件（GTK 也可以在 Windows 上运行，所以没有问题）。如果您更喜欢其他东西，那么还有 Qt、wxWidgets 和 Tk，它们都可以在 Linux 和 Windows 上运行（我假设也是 MacOSX）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-07T18:25:37.870

嵌入式网络浏览器将处理您声明的要求：

*   视频播放（使用 mplayer 或 vlc 插件）
*   控制播放的高级语言（javascript）
*   覆盖/GUI（HTML + CSS + PNG/SVG）

要光栅化当前帧会更难，您可能需要一些自定义 ffmpeg 将帧转储到磁盘然后将其作为 < img > 读回

# version-control - 我如何向我的团队提供有关构建中包含的更改及其对风险的影响的反馈？

> ID：922482
> 
> 赞同：3
> 
> 时间：2009-05-28T18:32:44.927
> 
> 标签：version-control, static-analysis, clover

这是你已经做过的事情还是你知道一个好的工具？

**目标：**帮助团队了解最近的源更改如何影响风险，以便他们知道将测试工作集中在哪里。随着时间的推移提供数据并将其反馈到开发周期的规划和范围界定阶段。

**计划：** 将 svn 更改数据与 clover 复杂性数据结合在一份报告中，显示更改对复杂性或更改风险的影响（行数 x 复杂性 = 风险？）。它并不完美，但它可以帮助团队更好地理解变化。

有人试试这个吗？如果是这样，您使用了哪些工具，以及如何为团队提供这种提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T19:59:25.313

我的经验是，当添加新功能或修复缺陷时，会识别测试和风险。这在我所有的工作中都是“手动”完成的。

你的想法很有趣——基本上是一种 CI 服务器类型的插件/组件，用于根据先前缺陷的统计数据和更改文件的复杂性分析来集中测试。

您显然需要一个代码/文件映射来测试用例，如果您有相反的情况（失败的测试用例和为进行修复而更改的文件），您将有一些自动生成一些信息的方式。

我怀疑“风险”也可能包含“开发人员”组件。即，某些开发人员在签入时比其他开发人员具有更高的“风险”——这也可能是某些功能的本地因素……在某些情况下，“开发人员”将是最重要的组件——要么完全降低风险，要么确定风险.

# c - 使用clock_getres - 新手Linux C

> ID：922492
> 
> 赞同：8
> 
> 时间：2009-05-28T18:35:22.953
> 
> 标签：c, linux

我正在尝试确定我的 Linux 机器上计时器的粒度。根据clock_getres的手册页，我应该可以使用这个片段：

```
#include <time.h>
#include <stdio.h>

int main( int argc, char** argv )
{
  clockid_t types[] = { CLOCK_REALTIME, CLOCK_MONOTONIC, CLOCK_PROCESS_CPUTIME_ID, CLOCK_THREAD_CPUTIME_ID, (clockid_t) - 1 };

  struct timespec spec;
  int i = 0;
  for ( i; types[i] != (clockid_t) - 1; i++ )
  {
    if ( clock_getres( types[i], &spec ) != 0 )
    {
      printf( "Timer %d not supported.\n", types[i] );
    }
    else
    {
      printf( "Timer: %d, Seconds: %ld Nanos: %ld\n", i, spec.tv_sec, spec.tv_nsec );
    }
  }
} 
```

我正在尝试这样构建： gcc -o timertest timertest.c

这在 Solaris 上效果很好，但在 Linux 上我得到了错误：

```
/tmp/ccuqfrCK.o：在函数“主”中：
timertest.c:(.text+0x49): undefined reference to `clock_getres'
collect2: ld 返回 1 个退出状态

```

我尝试将 -lc 传递给 gcc，显然 clock_getres 是在 libc 中定义的，但这没有区别。我必须在这里遗漏一些简单的东西 - 有什么想法吗？

谢谢，

拉斯

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-28T18:40:30.073

您需要与 RT 库 ( `-lrt`)链接

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-23T19:28:21.647

不幸的是，`clock_getres()`POSIX 功能（可选的“实时”部分 - 注意POSIX 页面[http://pubs.opengroup.org/onlinepubs/009695399/functions/clock_getres.html上的](http://pubs.opengroup.org/onlinepubs/009695399/functions/clock_getres.html)**REALTIME**标记）不报告 Linux 中的计时器粒度。它只能返回两个预定义的结果：1/HZ 用于低分辨率时钟（其中 HZ 是配置 linux 内核时使用的 CONFIG_HZ 宏的值，典型值为 100 300 1000）或 1 ns 用于高分辨率时钟（hrtimers）。

内核中的文件`linux/include/linux/hrtimer.h`有关于这种粒度和`clock_getres()`结果 含义的注释[http://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/include/linux/hrtimer.h](http://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/include/linux/hrtimer.h)

```
269 /*
270  * The resolution of the clocks. The resolution value is returned in
271  * the clock_getres() system call to give application programmers an
272  * idea of the (in)accuracy of timers. Timer values are rounded up to
273  * this resolution values.
274  */ 
```

因此，即使定时器源注册为“hrtimer”（高分辨率定时器），它也可能不是每纳秒 (ns) 计时一次。并且从返回的值`clock_getres()`只会说这个计时器没有四舍五入（因为`timespec`struct 具有纳秒精度）。

在 Linux 中，POSIX API 通常由 glibc（或其衍生物，如 eglibc）实现，默认情况下链接到所有程序（`-lc`链接器选项）。低于 2.17 版本的 Glibc 将 POSIX 的一些可选部分分离到额外的库中，例如，`-lpthread`或`-lrt`. `clock_getres()`中定义`-lrt`。

`-lrt`glibc 2.17 和更新版本不需要选项，根据 Linux 手册页`clock_getres()`和`clock_gettime()`功能， http: [//man7.org/linux/man-pages/man2/clock_gettime.2.html](http://man7.org/linux/man-pages/man2/clock_gettime.2.html)

> 与 -lrt 链接（仅适用于 2.17 之前的 glibc 版本）。

该更改也在兼容性跟踪器中注册：http: [//upstream.rosalinux.ru/compat_reports/glibc/2.16.0_to_2.17/abi_compat_report.html](http://upstream.rosalinux.ru/compat_reports/glibc/2.16.0_to_2.17/abi_compat_report.html)

> 添加符号 ... libc-2.17.so ... clock_getres

# c# - 使用 Crystal Reports 打印条形码

> ID：922496
> 
> 赞同：4
> 
> 时间：2009-05-28T18:36:17.540
> 
> 标签：c#, .net, asp.net, crystal-reports

我有一个水晶报告，我必须添加一个条形码。我从各种来源下载了一些免费和演示 TrueType 字体 Code 39、Code 128 和 UPC。当我打印出报告时，我可以看到条形码，但它不会用我的扫描仪进行扫描（扫描仪工作正常，因为我已经在多个其他条形码上对其进行了测试）。我是否需要在 Crystal Reports 中使用特殊的东西来创建扫描仪可以读取的条形码？

（我尝试在专为打印标签而设计的标签打印机上打印它，所以我认为这不是纸张/分辨率的问题）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T18:38:48.547

条形码中嵌入了校验位，除了使用字体外，您还需要复制它。我相信 Crystal 的第三方库可以正确格式化条形码，以便它们可以扫描。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T19:10:26.783

事实上，大多数条形码都有校验和和/或前导和尾随字符。

最简单的是 Code 3 of 9。要使用它，您需要以 * 开头和结尾代码。

例子：

*   要打印**ABCD**，您需要使用***ABCD***

一些字符也需要转义：

*   打印**#123**！你需要使用***/C123/A***

[有关代码 3 of 9 的](http://en.wikipedia.org/wiki/Code_39)更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-11T07:43:31.937

您可以使用“打印机字体”为您的代码条打印机设计 RPT。但是您需要使用一些特殊的代码进行打印。您可以在以下网址找到它：[https ://stackoverflow.com/a/19312690/192389](https://stackoverflow.com/a/19312690/192389)

# visual-studio - 使用 AzMan 实现授权场景的自动化测试

> ID：922501
> 
> 赞同：0
> 
> 时间：2009-05-28T18:38:31.293
> 
> 标签：visual-studio, unit-testing, tfs, authorization, azman

我有一个使用 AzMan 授权向不同用户授予不同功能的 Web 应用程序。我刚刚开始使用 WatiN 来实现一些在 Visual Studio Team System/TFS 下运行的自动化 Web UI 测试。我希望能够使用它来验证不同的授权场景。要做到这一点，我需要能够作为通过 AzMan 授予不同权限的不同用户运行不同的测试（使用虚拟测试帐户）。

有没有人有自动化测试 AzMan 授权的经验？

在 TFS 下以不同用户身份运行 VS“单元”测试怎么样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:27:49.437

您用于身份验证的方法将影响您执行此操作的方式。

如果您使用的是集成安全性（Windows 身份验证），那么一种方法可能是使用模拟的其他 Windows 用户运行您的 WatiN 测试。

如果您使用的是表单身份验证，那么您可以只使用 WatiN 以不同用户身份登录，因为它只是“纯网络”POST/GET。

# .net - 框架中是否有通用的交换方法？

> ID：922505
> 
> 赞同：15
> 
> 时间：2009-05-28T18:39:02.527
> 
> 标签：.net

框架中的任何地方都存在这样的方法吗？

```
public static void Swap<T>(ref T left, ref T right) {
    T temp;
    temp = left;
    left = right;
    right = temp;
} 
```

如果不是，有什么理由吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T18:41:29.603

有[Interlocked.Exchange](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.exchange.aspx)。这是在线程安全的原子调用中完成的。

* * *

评论后编辑：

只是为了阐明使用 Interlocked.Exchange 的工作原理，您可以：

```
left = Interlocked.Exchange(ref right, left); 
```

这将等效于（实际上）执行以下操作：

```
Swap(ref left, ref right); 
```

但是，Interlocked.Exchange 将其作为原子操作执行，因此它是线程安全的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T18:43:39.363

不，框架没有这样的方法。可能原因是内置它并没有太多好处，您可以很容易地（就像您所做的那样）自己添加它。这也需要使用`ref`as 参数，这将极大地限制用例。例如，您不能这样做：

```
List<int> test; 
// ...
Swap(ref test[0], ref test[1]); // won't work, it's an indexer, not an array 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-02T17:43:38.253

原因是 C# 没有对槽的引用，所以实现这样的方法需要表达式参数，这是一些高级的东西：

```
 static void Swap < Model, Value > (
         Func < Model, Value > getter,
         Action < Model, Value > setter,
         Model m1, Model m2
     ) {
         Value v = getter (
             m1
         ); setter (
             m1, getter (
                 m2
             )
         ); setter (
             m2, v
         );
     } 
```

当然，一个高质量的实现会首先检查事情是否不平等。你甚至可以取消一个单独的 setter：

```
 static void Swap < Model, Value > (
         Expression < Func < Model, Value > > getter
         , Model m1, Model m2

     )
      {
         var valueParam = Expression .Parameter (
             typeof (
                 Value
             )
         ); Swap (
             getter .Compile (), Expression .Lambda < Action < Model, Value > > (
                 Expression .Assign (
                     getter .Body, valueParam
                 ), new [] {
                     getter .Parameters [
                         0X0
                     ], valueParam
                 }
             ) .Compile (), m1, m2
         );
     } 
```

# reporting-services - Reporting Services [SSRS] 表达式的有效样式格式字符串是什么？

> ID：922506
> 
> 赞同：40
> 
> 时间：2009-05-28T18:39:21.793
> 
> 标签：reporting-services, formatting

我试图找出 Reporting Services 表达式中 Format(Expression as Object, Style as String) 函数的样式字符串。

我找不到这些样式格式字符串的记录位置！

具体来说，我正在尝试将价格字段格式化为始终保留 2 位小数。

即 1.5 格式到 $1.50

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-28T20:45:55.950

使用*货币*格式字符串格式化

```
=Format(Fields!Price.Value, "C") 
```

它将为您提供 2 个小数位，并以“$”为前缀。

您可以在 MSDN 上找到其他格式字符串：[向 ReportViewer 报告添加样式和格式](http://msdn.microsoft.com/en-us/library/ms252080(VS.80).aspx)

***注意***：MSDN 文章已归档到“VS2005_General”文档，网上不再直接访问。以下是引用的格式化字符串的摘录：

> **格式化数字**
> 
> 下表列出了常见的 .NET Framework 数字格式字符串。
> 
> **格式字符串，名称**
> 
> C 或 c 货币
> 
> D 或 d 十进制
> 
> 电子或电子科学
> 
> F 或 f 定点
> 
> G 或 g 一般
> 
> N 或 n 号
> 
> P 或 p 百分比
> 
> R 或 r 往返
> 
> X 或 x 十六进制
> 
> 您可以修改许多格式字符串以包含一个精度说明符，该说明符定义了右侧的位数
> 
> 小数点。例如，格式化字符串 D0 格式化数字，使其小数点后没有数字。你
> 
> 也可以使用自定义格式字符串，例如#,###。
> 
> **格式化日期**
> 
> 下表列出了常见的 .NET Framework 日期格式字符串。
> 
> **格式字符串，名称**
> 
> d 短日期
> 
> D 长日期
> 
> t 短时间
> 
> 很久很久
> 
> f 完整日期/时间（短时间）
> 
> F 完整日期/时间（长时间）
> 
> g 一般日期/时间（短时间）
> 
> G 一般日期/时间（长时间）
> 
> M 或 m 月日
> 
> R 或 r RFC1123 模式
> 
> Y 或 y 年月
> 
> 您还可以使用自定义格式字符串；例如，日/月/年。有关 .NET Framework 格式化字符串的详细信息，请参阅格式化类型。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-06-04T06:24:17.637

如前所述，您可以使用：

```
=Format(Fields!Price.Value, "C") 
```

“C”之后的数字将指定精度：

```
=Format(Fields!Price.Value, "C0")
=Format(Fields!Price.Value, "C1") 
```

您还可以像这样使用[Excel 样式的掩码](https://support.office.com/en-us/article/Create-or-delete-a-custom-number-format-78f2a361-936b-4c03-8772-09fab54be7f4)：

```
=Format(Fields!Price.Value, "#,##0.00") 
```

没有测试过最后一个，但有这个想法。也适用于日期：

```
=Format(Fields!Date.Value, "yyyy-MM-dd") 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-10-02T18:43:18.773

您可以设置 TextBox 属性以设置负数显示和小数位设置。

1.  右键单击单元格，然后单击文本框属性。
2.  选择数字，然后在类别字段中，单击货币。

[![在此处输入图像描述](https://i.stack.imgur.com/Wj4gl.png)](https://i.stack.imgur.com/Wj4gl.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T18:43:30.270

[您可以在http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition/ReportDefinition.xsd](http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition/ReportDefinition.xsd)检查架构

搜索 xsd:complexType name="StyleType"

这将列出您可以使用的所有可能的样式。

但是，针对您的问题，您可以使用格式样式。

> 格式
> 
> ```
> Specify the data format to use for values that appear in the textbox. 
> ```
> 
> 有效值包括默认值、数字、日期、时间、百分比和货币。

链接到 MSDN： http: [//msdn.microsoft.com/en-us/library/ms251684 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms251684(VS.80).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-18T00:58:07.313

为值的属性提供 C2 的格式字符串值，如下图所示。

![在此处输入图像描述](https://i.stack.imgur.com/ChIJf.png)

# sql - 被困在一个小组中

> ID：922507
> 
> 赞同：0
> 
> 时间：2009-05-28T18:39:38.203
> 
> 标签：sql, tsql

```
table 1 - 
pid cid
901 101
901 102
901 103
902 102
902 105
903 105

table 2 -
cid
101
102
105 
```

我需要 table1 中的 Pid 仅在所有 CID 与表 2 中的 CID 匹配时才显示。这意味着对于具有 CID 101,102 和 103 的 901 不应显示在 select 语句中，因为表 2 中不存在 103。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T19:27:43.770

我假设您只需要一个 PID 并且 CID 不是负数。然后

**解决方案：（**没有 COUNT(..) 和 EXIST(..) 的版本）

```
SELECT      table1.pid
FROM        table1
LEFT JOIN   table2 ON table1.cid = table2.cid
GROUP BY    table1.pid
HAVING      MIN(COALESCE(table2.cid, -1)) <> -1 
```

返回：

```
pid
-----------
902
903 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T18:48:33.553

试试下面的方法，也许这会让你朝着正确的方向前进。

这将为您提供表 1 中的所有 PID，其所有 CID 都位于表 2 中

从问题中收集到的信息来看，表 1 中的 PID 不一定必须具有表 2 中的所有 CID，它只需要具有位于表 2 中的 CID，并且如果其中一个 CID 不在表中2 则 PID 无效。

```
DECLARE @table1 TABLE   (
                        pid INT,
                        cid INT
                        )

DECLARE @table2 TABLE   (
                        cid INT
                        )

INSERT  @table1
SELECT  901, 101 UNION ALL
SELECT  901, 102 UNION ALL
SELECT  901, 103 UNION ALL
SELECT  902, 102 UNION ALL
SELECT  902, 105 UNION ALL
SELECT  903, 105

INSERT  @table2
SELECT  101 UNION ALL
SELECT  102 UNION ALL
SELECT  105

DECLARE @temp TABLE (
                    pid     INT,
                    cid     INT,
                    test    INT
                    )

INSERT      @temp
SELECT      a.pid,
            a.cid,
            b.pid
FROM        @table1 a
LEFT JOIN   (
            SELECT      t1.pid,
                        t1.cid
            FROM        @table1 t1
            LEFT JOIN   @table2 t2
                    ON  t1.cid = t2.cid
            WHERE       t2.cid IS NULL
            ) b
        ON  a.pid = b.pid
        AND a.cid = b.cid

-- Compare the counts of nulls
SELECT      a.pid
FROM        (
            SELECT      pid,
                        COUNT(1) AS cnt
            FROM        @temp
            GROUP BY    pid
            ) a
INNER JOIN  (
            SELECT      pid,
                        COUNT(1) AS cnt
            FROM        @temp
            WHERE       test IS NULL
            GROUP BY    pid
            ) b
        ON  a.pid = b.pid
        AND a.cnt = b.cnt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:10:24.303

因此，您需要 table1 中的 PID，其中 table1 中没有对 (PID, CID)，因此 PID 不在 table2 中。?

```
select pid from (select distinct pid from table1) table1_pids
where not exists (select 1 from table1 where table1.pid = table1_pids.pid
            and not exists (select 1 from table2 where table2.cid = table1.cid)); 
```

另一种方式：

```
select pid from table1 left join table2 on table1.cid = table2.cid
group by pid
having sum(case when table2.cid is null then 1 else 0 end) = 0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T18:48:54.813

尝试这个：

```
DECLARE @table1 table (pid int, cid int)
DECLARE @table2 table (cid int)

INSERT INTO @table1 VALUES (901,101)
INSERT INTO @table1 VALUES (901,102)
INSERT INTO @table1 VALUES (901,103)
INSERT INTO @table1 VALUES (902,102)
INSERT INTO @table1 VALUES (902,105)
INSERT INTO @table1 VALUES (903,105)

INSERT INTO @Table2 VALUES (101)
INSERT INTO @Table2 VALUES (102)
INSERT INTO @Table2 VALUES (105)

SELECT
    dt.pid
    FROM (SELECT
              t1.pid, t2.cid
              FROM @table1                 t1
                  LEFT OUTER JOIN @table2  t2 ON t1.cid=t2.cid
         ) dt
    GROUP BY dt.pid
    HAVING COUNT(dt.pid)=COUNT(dt.cid) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T18:49:55.123

我将您的问题解释为您想要一个`pid`s列表，`Table1`其中**每个** `cid`from`Table2`都匹配。换句话说，在以下示例中，901 匹配，但 902、903 和 904 不匹配：

```
 Table1             Table2
pid | cid          cid
---------          ----
901 | 100          100
901 | 101          101
902 | 101
903 | 100
903 | 105
904 | 100
904 | 101
904 | 105 
```

这是查询：

```
DECLARE @NUM_CIDS INT
SELECT @NUM_CIDS = COUNT(1) FROM Table2

SELECT Table1.pid
FROM Table1
INNER JOIN Table2
ON Table1.cid = Table2.cid
GROUP BY Table1.pid
HAVING COUNT(Table2.cid) = @NUM_CIDS 
```

它通过连接两个表来工作，然后只返回`pid`具有正确数量的`cid`s。它保证可以工作，因为如果记录`Table1`不匹配，它将不会参与加入。如果`pid`不完整，它将被该`HAVING`子句拒绝。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T18:50:32.643

怎么样

```
SELECT DISTINCT PID --Get all the other PIDS
FROM Table1
WHERE PID NOT IN
(
    SELECT PID --Get the PIDS From Table 1 That Have a CID NOT IN Table2
    FROM Table1 
    WHERE CID NOT IN (
        SELECT CID    --Get All The Table 2 CIDs
        FROM Table2 
    )
) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T18:50:55.823

我相信你正在寻找这样的东西：

```
Select distinct pid
from table1 t1
  join table2 on t1.cid = table2.cid
group by pid
having count(t1.cid) = (select count(cid) from table1 where pid = t1.pid) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T18:55:19.777

无需使用嵌套查询，更快地进行自然连接。不确定您使用的是哪种类型的数据库，但它应该仍然可以工作。如果您只想返回每个正确的 pid 一次，则只需要 distinct。

```
SELECT DISTINCT t1.pid
FROM   table1 t1, table2 t2
WHERE  t1.cid = t2.cid 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T19:16:04.807

如果我理解正确，您的目标是只获取没有任何不匹配 cid 的行 - 也就是说，如果甚至有一行具有相同的 pid 和不存在的 cid，则不要显示任何行那个pid。如果是这种情况，最直接的编码方法是在同一张表上使用 an ，如下所示：

```
SELECT * 
  FROM 
    [table 1] T1A 
  WHERE 
    /* there are no rows in my same table ... */
    NOT EXISTS (
        SELECT * 
          FROM 
            [table 1] T1B 
          WHERE 
            T1A.pid = T1B.pid 
            /* ... that do not have a matching cid in table 2 */
            AND T1B.cid NOT IN (SELECT cid FROM [table 2])
    ) 
```

这将返回 pid=902 的 3 行，而没有 pid=901 的行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T19:31:03.123

我没有专门使用 sql/tsql，但我认为 mysql 中的解决方案如下，也许有人可以将其翻译成 sql/tsql，因为我认为这是解决问题的简单方法。

```
SELECT
    count(t2.cid IS NULL) AS noMatch
        ,pid
    FROM table1       t1
    LEFT JOIN table2  t2 ON t2.cid = t1.cid
    HAVING noMatch = 0; 
```

# iframe - 由于 iframe，URL 不会发生太大变化，这是一个问题吗？

> ID：922513
> 
> 赞同：0
> 
> 时间：2009-05-28T18:40:32.040
> 
> 标签：iframe

我们正在用 ASP.NET 开发一个应用程序。例如，出于讨论目的，假设我们在左侧有一个菜单，其中一个菜单项表示部门。我们点击那个。它在菜单右侧的 iframe 中显示部门列表。顶部的网址不会改变。然后我们单击其中一个部门，该部门的详细信息将显示在列表下方的另一个 iframe 中。

最终结果是，从用户的角度来看，导航正在发生，但 URL 没有改变。这是一个问题吗？会不会有我们没有意识到的影响？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T18:44:11.783

为什么不应该使用框架？

*   打破前进和后退按钮。
*   当有人通过搜索引擎直接进入时布局丢失
*   对搜索引擎不友好
*   导航链接更复杂
*   文本浏览器不支持
*   会使分析复杂化

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T18:42:50.723

是的，您主要是破坏了后退和前进按钮的使用。

此外，根据您的 html/js 的情况，搜索引擎和较旧的/嵌入式/文本浏览器可能无法查看您的 iframe。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:54:52.930

同意其他人的观点，即使用框架（在某些情况下和/或 AJAX）可能会破坏浏览器后退/前进按钮的使用。

但是，这也取决于您正在创建的应用程序的类型。例如，雅虎邮件使用 AJAX 处理所有导航，并且 URL 永远不会更改，并且后退/前进按钮会让您远离邮件客户端。

我建议您看看在 ASP.Net 中使用母版页。您仍然可以拥有从不同页面加载的内容的单个导航区域，但它可以正确使用后退/前进按钮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T18:55:00.700

尝试通过更改 location.href 将参数添加到您的 URL 以使后退按钮起作用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T19:11:32.193

如果您的用户尝试为页面添加书签，使用框架也会导致问题。

# java - 如何在 Java 中按键对 Map 值进行排序？

> ID：922528
> 
> 赞同：416
> 
> 时间：2009-05-28T18:43:06.277
> 
> 标签：java, dictionary, hashmap

我有一个包含键和值的字符串的 Map。

数据如下：

> “问题 1”、“1”
> 、“问题 9”、“1”
> 、“问题 2”、“4”
> 、“问题 5”、“2”

我想根据它的键对地图进行排序。所以，最后，我会有`question1, question2, question3`……等等。

最终，我试图从这张地图中取出两个字符串。

*   第一个字符串：问题（按 1 ..10 顺序）
*   第二个字符串：答案（与问题的顺序相同）

现在我有以下内容：

```
Iterator it = paramMap.entrySet().iterator();
while (it.hasNext()) {
    Map.Entry pairs = (Map.Entry) it.next();
    questionAnswers += pairs.getKey() + ",";
} 
```

这让我得到了一个字符串中的问题，但它们不是按顺序排列的。

* * *

## 回答 #1

> 赞同：677
> 
> 时间：2009-05-28T18:43:59.257

## 简短的回答

使用[`TreeMap`](http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html). 这正是它的用途。

如果将此映射传递给您并且您无法确定类型，那么您可以执行以下操作：

```
SortedSet<String> keys = new TreeSet<>(map.keySet());
for (String key : keys) { 
   String value = map.get(key);
   // do something
} 
```

这将以键的自然顺序遍历地图。

* * *

## 更长的答案

从技术上讲，您可以使用任何实现`SortedMap`，但除了极少数情况外，这相当于`TreeMap`，就像使用`Map`实现通常相当于`HashMap`。

对于您的键是不实现 Comparable 的复杂类型，或者您不想使用自然顺序`TreeMap`并且`TreeSet`有额外的构造函数允许您传入 a 的情况`Comparator`：

```
// placed inline for the demonstration, but doesn't have to be a lambda expression
Comparator<Foo> comparator = (Foo o1, Foo o2) -> {
        ...
    }

SortedSet<Foo> keys = new TreeSet<>(comparator);
keys.addAll(map.keySet()); 
```

请记住，当使用`TreeMap`or时`TreeSet`，它将具有与`HashMap`or不同的性能特征`HashSet`。粗略地说，查找或插入元素的操作将从**O(1)**变为**O(Log(N))**。

在 a`HashMap`中，从 1000 个项目移动到 10,000 个并不会真正影响您查找元素的时间，但是对于 a 来说`TreeMap`，查找时间会慢 3 倍左右（假设 Log [2]）。对于每个元素查找，从 1000 移动到 100,000 将慢大约 6 倍。

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2009-05-28T19:03:21.807

假设 TreeMap 对您不利（并假设您不能使用泛型）：

```
List sortedKeys=new ArrayList(yourMap.keySet());
Collections.sort(sortedKeys);
// Do what you need with sortedKeys. 
```

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2011-11-07T11:51:32.767

使用`TreeMap`您可以对地图进行排序。

```
Map<String, String> map = new HashMap<>();        
Map<String, String> treeMap = new TreeMap<>(map);
for (String str : treeMap.keySet()) {
    System.out.println(str);
} 
```

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2015-02-18T14:37:16.483

只需使用 TreeMap

```
new TreeMap<String, String>(unsortMap); 
```

请注意，TreeMap 是根据其“键”的自然顺序排序的

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2009-05-28T18:44:43.187

使用[树图](http://java.sun.com/j2se/1.5.0/docs/api/java/util/TreeMap.html)！

* * *

## 回答 #6

> 赞同：39
> 
> 时间：2013-08-21T05:58:53.813

如果您已经有一张地图并想按键对其进行排序，只需使用：

```
Map<String, String> treeMap = new TreeMap<String, String>(yourMap); 
```

一个完整的工作示例：

```
import java.util.HashMap;
import java.util.Set;
import java.util.Map;
import java.util.TreeMap;
import java.util.Iterator;

class SortOnKey {

public static void main(String[] args) {
   HashMap<String,String> hm = new HashMap<String,String>();
   hm.put("3","three");
   hm.put("1","one");
   hm.put("4","four");
   hm.put("2","two");
   printMap(hm);
   Map<String, String> treeMap = new TreeMap<String, String>(hm);
   printMap(treeMap);
}//main

public static void printMap(Map<String,String> map) {
    Set s = map.entrySet();
    Iterator it = s.iterator();
    while ( it.hasNext() ) {
       Map.Entry entry = (Map.Entry) it.next();
       String key = (String) entry.getKey();
       String value = (String) entry.getValue();
       System.out.println(key + " => " + value);
    }//while
    System.out.println("========================");
}//printMap

}//class 
```

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2016-11-17T08:21:07.343

如果你不能使用`TreeMap`，在**Java 8**中我们可以使用[toMap()](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collectors.html#toMap-java.util.function.Function-java.util.function.Function-java.util.function.BinaryOperator-java.util.function.Supplier-)方法，`Collectors`该方法接受以下参数：

*   **keymapper** : 生成键的映射函数
*   **valuemapper** : 生成值的映射函数
*   **mergeFunction**：一个合并函数，用于解决与同一键关联的值之间的冲突
*   **mapSupplier**：一个函数，它返回一个新的、空的 Map ，结果将被插入其中。

**Java 8 示例**

```
Map<String,String> sample = new HashMap<>();  // push some values to map  
Map<String, String> newMapSortedByKey = sample.entrySet().stream()
                    .sorted(Map.Entry.<String,String>comparingByKey().reversed())
                    .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue, (e1, e2) -> e1, LinkedHashMap::new));
Map<String, String> newMapSortedByValue = sample.entrySet().stream()
                        .sorted(Map.Entry.<String,String>comparingByValue().reversed())
                        .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue, (e1,e2) -> e1, LinkedHashMap::new)); 
```

我们可以修改示例以使用自定义比较器并根据键进行排序，如下所示：

```
Map<String, String> newMapSortedByKey = sample.entrySet().stream()
                .sorted((e1,e2) -> e1.getKey().compareTo(e2.getKey()))
                .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue, (e1,e2) -> e1, LinkedHashMap::new)); 
```

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2018-05-01T17:52:56.313

使用**Java 8：**

```
Map<String, Integer> sortedMap = unsortMap.entrySet().stream()
            .sorted(Map.Entry.comparingByKey())
            .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue,
                    (oldValue, newValue) -> oldValue, LinkedHashMap::new)); 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2018-04-14T16:22:52.820

## 在 Java 8 中

要按键排序 a `Map<K, V>`，将键放入 a `List<K>`：

```
List<K> result = map.keySet().stream().sorted().collect(Collectors.toList()); 
```

要按键排序 a `Map<K, V>`，将条目放入 a `List<Map.Entry<K, V>>`：

```
List<Map.Entry<K, V>> result =
    map.entrySet()
       .stream()
       .sorted(Map.Entry.comparingByKey())
       .collect(Collectors.toList()); 
```

最后但同样重要的是：以区域设置敏感的方式对**字符串**进行排序- 使用[Collat​​or](https://docs.oracle.com/javase/8/docs/api/java/text/Collator.html)（比较器）类：

```
Collator collator = Collator.getInstance(Locale.US);
collator.setStrength(Collator.PRIMARY); // case insensitive collator

List<Map.Entry<String, String>> result =
    map.entrySet()
       .stream()
       .sorted(Map.Entry.comparingByKey(collator))
       .collect(Collectors.toList()); 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2015-11-24T20:56:21.740

此代码可以按升序和降序两种顺序对键值映射进行排序。

```
<K, V extends Comparable<V>> Map<K, V> sortByValues
     (final Map<K, V> map, int ascending)
{
     Comparator<K> valueComparator =  new Comparator<K>() {         
        private int ascending;
        public int compare(K k1, K k2) {
            int compare = map.get(k2).compareTo(map.get(k1));
            if (compare == 0) return 1;
            else return ascending*compare;
        }
        public Comparator<K> setParam(int ascending)
        {
            this.ascending = ascending;
            return this;
        }
    }.setParam(ascending);

    Map<K, V> sortedByValues = new TreeMap<K, V>(valueComparator);
    sortedByValues.putAll(map);
    return sortedByValues;
} 
```

举个例子：

```
Map<Integer,Double> recommWarrVals = new HashMap<Integer,Double>();
recommWarrVals = sortByValues(recommWarrVals, 1);  // Ascending order
recommWarrVals = sortByValues(recommWarrVals,-1);  // Descending order 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-11-07T11:34:21.320

```
List<String> list = new ArrayList<String>();
Map<String, String> map = new HashMap<String, String>();
for (String str : map.keySet()) {
 list.add(str);
}
Collections.sort(list);
for (String str : list) {
 System.out.println(str);
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-02-06T16:26:41.123

在 Java 8 中，您还可以使用 .stream().sorted()：

```
myMap.keySet().stream().sorted().forEach(key -> {
        String value = myMap.get(key);

        System.out.println("key: " + key);
        System.out.println("value: " + value);
    }
); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-03-10T11:26:54.937

使用`LinkedHashMap`，它提供密钥排序。它也提供与`HashMap`. 它们都实现了`Map`接口，因此您只需将初始化对象替换`HashMap`为`LinkedHashMap`.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-11-21T16:22:51.130

以防万一你不想使用`TreeMap`

```
public static Map<Integer, Integer> sortByKey(Map<Integer, Integer> map) {
        List<Map.Entry<Integer, Integer>> list = new ArrayList<>(map.entrySet());
        list.sort(Comparator.comparingInt(Map.Entry::getKey));
        Map<Integer, Integer> sortedMap = new LinkedHashMap<>();
        list.forEach(e -> sortedMap.put(e.getKey(), e.getValue()));
        return sortedMap;
    } 
```

此外，如果您想在`values`更改`Map.Entry::getKey`为的基础上对地图进行排序`Map.Entry::getValue`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-11-07T11:37:36.467

我们还可以使用 Arrays.sort 方法对键进行排序。

```
Map<String, String> map = new HashMap<String, String>();
Object[] objArr = new Object[map.size()];
for (int i = 0; i < map.size(); i++) {
objArr[i] = map.get(i);
}
Arrays.sort(objArr);
for (Object str : objArr) {
System.out.println(str);
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-09-08T16:30:04.630

[这里](https://www.geeksforgeeks.org/sorting-hashmap-according-key-value-java/)提供了一个很好的解决方案。我们有一个`HashMap`以未指定顺序存储值的方法。我们定义了一个辅助`TreeMap`，我们使用该方法将 HashMap 中的所有数据复制到 TreeMap 中`putAll`。TreeMap 中的结果条目按键顺序排列。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-05-06T19:06:23.013

下面的树图怎么样：

```
Map<String, String> sortedMap = new TreeMap<>(Comparator.comparingInt(String::length)
.thenComparing(Function.identity())); 
```

无论你在这个 sortedMap 中放入什么，它都会自动排序。首先是接口`TreeMap`的排序实现。`Map`有一个但是因为它在 [自然顺序时尚] [https://docs.oracle.com/javase/tutorial/collections/interfaces/order.html] 上对键进行排序。正如 Java 文档所说，`String`类型是字典自然顺序类型。想象一下下面的字符串类型的数字列表。意味着下面的列表将按预期排序。

`List<String> notSortedList = List.of("78","0", "24", "39", "4","53","32");`

如果您只是像下面这样的默认`TreeMap`构造函数，并像下面这样一个接一个地推送每个元素：

```
 Map<String, String> map = new TreeMap<>();
    for (String s : notSortedList) {
        map.put(s, s);
    }

    System.out.println(map); 
```

输出是：`{0=0, 14=14, 24=24, 32=32, 39=39, 4=4, 48=48, 53=53, 54=54, 78=78}`

如您所见，例如数字*4位于“39”之后。*这是字典数据类型（如字符串）的本质。如果那个是整数数据类型，那也没关系。

要修复此使用参数，首先检查字符串的长度，然后比较它们。在 java 8 中是这样完成的：

```
Map<String, String> sortedMap = new TreeMap<>(Comparator.comparingInt(String::length)
.thenComparing(Function.identity())); 
```

它首先按长度比较每个元素，然后应用 check by`compareTo`作为与要比较的元素相同的输入。

如果您更喜欢使用更易于理解的方法，上面的代码将等同于下面的代码：

```
 Map<String, String> sortedMap = new TreeMap<>(
             new Comparator<String>() {
                @Override
                public int compare(String o1, String o2) {
                    int lengthDifference = o1.length() - o2.length();
                    if (lengthDifference != 0) return lengthDifference;
                    return o1.compareTo(o2);
                }
            }
    ); 
```

因为`TreeMap`构造函数接受比较器接口，所以您可以构建任何更复杂的复合类实现。

这也是另一种形式更加简化的版本。

```
 Map<String,String> sortedMap = new TreeMap<>(
           (Comparator<String>) (o1, o2) ->
            {
                int lengthDifference = o1.length() - o2.length();
                if (lengthDifference != 0) return lengthDifference;
                return o1.compareTo(o2);
            }
    ); 
```

# svn - 同步 webapps 和 svn 的提示？

> ID：922534
> 
> 赞同：0
> 
> 时间：2009-05-28T18:44:03.093
> 
> 标签：svn, web-applications

我很想从遇到此问题的其他人那里获得一些提示。我正在对基于 java 的应用程序进行前端开发。

我在一个目录/usr/src 中有我的源代码。我的项目在 /usr/tomcat/webapps 中构建并部署到 Tomcat。由于我所做的工作都是前端的，所以我必须在 /usr/tomcat/webapps 中编辑已部署的文件，以便我可以立即看到我的更改。

我绝对希望有一个系统可以自动将我对特定文件（例如 css、js 或 jsp）的更改同步回同一个文件源控制。

我一直在考虑创建一个对文件进行 1-1 映射的后台进程，但这很快就会变得很麻烦。

有没有人有他们使用的现有系统，或者关于我能做什么的一些建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T19:27:23.677

我已将应用程序的 exploaded 目录添加到 IDE (Idea) 中的项目中。当我需要尝试“热门”的东西时 - 只需更改已加载的文件即可。当我有一个好的结果时 - 只需将更改复制到源的工作副本。

可能这不是最好的解决方案，但对我有用。唯一的 - 当我需要更改许多文件时，它并不方便。但几乎所有的工作都可以分成小部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:52:16.780

您应该配置您的系统，以便您的 Web 服务器直接从您的 svn 工作树中提供文件。也许是从 /usr/tomcat/webapps/some-static-directory 到 svn 树中适当位置的符号链接？

# javascript - 使用变量键访问 JavaScript 对象中的值

> ID：922544
> 
> 赞同：73
> 
> 时间：2009-05-28T18:46:57.017
> 
> 标签：javascript, language-design

编码：

```
function updateDashboardData() {
    $.getJSON("includes/system/ajaxDataInterface.php", {recordcount:1}, function(data) {
        $('.stationContainer').each(function(data) {
            var bsID = $(this).attr("id");
            var bsStatus = $(this).children('.stationStatus');
            alert(data[bsID][0].time);
            bsStatus.find('.bs_maxHandsets').text(data[bsID][0].maxHandsets);
            bsStatus.find('.bs_time').text(data[bsID][0].time);
        });
    });
} 
```

对象数据：

```
{
    "A5A50000": [{
        "bsid": "A5A50000",
        "chanCount": 17,
        "time": "2009-05-27 16:36:45",
        "avgInterference": 1.711765,
        "maxInterference": 4.97,
        "avgHandsets": 205.1176,
        "maxHandsets": 315,
        "avgCalls": 6.4118,
        "maxCalls": 13,
        "avgCBA": 3868.98059,
        "maxCBA": 7463,
        "sumSuccessCBA": 197318,
        "sumTimeoutHandoff": 133,
        "sumAttemptHandoff": 1028,
        "sumDeniedHandoff": 216,
        "sumConfirmHandoff": 679,
        "sumHandoffNetwork": 61873,
        "sumJoinNetwork": 96888,
        "sumLeaveNetwork": 93754,
        "sumRcvdKeepalive": 98773,
        "sumTimeoutKeepalive": 19748,
        "sumAttemptUplink": 93689,
        "sumBlockedUplink": 62453
    }]
} 
```

问题：

`alert(data.A5A50000[0].time);`正确显示“2009-05-27 16:36:45”。

`alert(bsID);`正确显示“A5A50000”。

`alert(data.bsID[0].time);`报告“data.bsID 未定义”。

`alert(data[bsID][0].time);`报告“数据 [bsID] 未定义”。

我有点不清楚何时评估/不评估变量。也许我忽略了一些愚蠢的事情，但我无法在这里找出我的问题。

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2009-05-28T18:55:05.910

您可以通过点表示法或括号表示法访问对象属性。

```
var x = {'test': 'hi'};
alert(x.test); // alerts hi
alert(x['test']); // alerts hi 
```

当你有一个动态值时，你必须使用后者：

```
var property = 'test';
alert(x.property); // looks for x.property, undefined if it doesn't exist
alert(x[property]); // looks for x['test'], alerts hi 
```

所以你真正想要的是：

```
alert(data[bsID][0].time); 
```

**编辑**：

不知道你做错了什么，但这在 Firebug 的控制台上对我有用：

```
var data = {"A5A50000":[{"bsid":"A5A50000","chanCount":17,"time":"2009-05-27 16:36:45","avgInterference":1.711765,"maxInterference":4.97,"avgHandsets":205.1176,"maxHandsets":315,"avgCalls":6.4118,"maxCalls":13,"avgCBA":3868.98059,"maxCBA":7463,"sumSuccessCBA":197318,"sumTimeoutHandoff":133,"sumAttemptHandoff":1028,"sumDeniedHandoff":216,"sumConfirmHandoff":679,"sumHandoffNetwork":61873,"sumJoinNetwork":96888,"sumLeaveNetwork":93754,"sumRcvdKeepalive":98773,"sumTimeoutKeepalive":19748,"sumAttemptUplink":93689,"sumBlockedUplink":62453}]};
var bsID = 'A5A50000';
alert(data[bsID][0].time); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T18:56:26.423

在 Javascript 中，您可以使用对象或数组样式的表示法来查找属性。以下是等价的：

```
data.A5A50000
data['A5A50000'] 
```

使用第二种语法，您可以使用变量代替对象字符串：

```
data[bsID][0] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-08T10:45:21.923

我在嵌套的 JSON API 响应中遇到了同样的问题：

```
[
    {
        "bj_code": "2019",
        "BJ_PERIODE": [
            {
                "nummer": 1
            },
            {
                "nummer": 2
            }
        ]
    }
] 
```

我可以评价：

```
pm.expect(pm.response.json()[0].BJ_PERIODE[1].nummer).to.eql(2); 
```

但是使用`BJ_PERIODE`和`nummer`通过变量不起作用。使用括号方法编写它确实有效，即使在这个嵌套的 JSON 中，如下所示：

```
const periode = "BJ_PERIODE";
const nr = "nummer"; 
pm.expect(pm.response.json()[0][periode][1][nr]).to.eql(2); 
```

# c++ - 如何允许模板功能有朋友（-like）访问？

> ID：922545
> 
> 赞同：13
> 
> 时间：2009-05-28T18:47:15.957
> 
> 标签：c++, function, templates, friend

如何修改以下代码以允许模板函数`ask_runUI()`在`s_EOF`不`s_EOF`公开的情况下使用？

```
#include <string>
#include <iostream>
#include <sstream>
#include <vector>
class AskBase {
protected:
    std::string m_prompt;
    std::string m_answer; 
    virtual bool validate(std::string a_response) = 0;
public:
    AskBase(std::string a_prompt):m_prompt(a_prompt){}
    std::string prompt(){return m_prompt;}
    std::string answer(){return m_answer;}
    static int const s_EOF = -99;
    static int const s_BACKUP = -1;
    static int const s_OK = 1;
    int ask_user();
};
template<typename T> class Ask : public AskBase{
public:
    Ask(std::string a_prompt):AskBase(a_prompt){}
    bool validate(std::string a_response);
};
template<> bool Ask<std::string>::validate(std::string a_response){return true;}
template<> bool Ask<int>::validate(std::string a_response){int intAnswer;
    return (std::stringstream(a_response) >> intAnswer);}
int AskBase::ask_user(){
    for(;;){
        std::cout << "Enter " << m_prompt;
        std::string response;
        getline(std::cin, response);
        if (std::cin.eof())
            return s_EOF;
        else if (response == "^")
            return s_BACKUP;
        else if (validate(response)){
            m_answer = response;
            return s_OK;
        }
    }
    return s_EOF;
}
template<typename T> int ask_runUI(T& a_ui){
    int status = AskBase::s_OK;
    for (typename T::iterator ii=a_ui.begin();
            status!=AskBase::s_EOF && ii!=a_ui.end();
            ii+=((status==AskBase::s_BACKUP)?((ii==a_ui.begin())?0:-1):1)
        status = (*ii)->ask_user();
    return (status == AskBase::s_OK);
}
int main(){
    std::vector<AskBase*> ui;
    ui.push_back(new Ask<std::string>("your name: "));
    ui.push_back(new Ask<int>("your age: "));
    if (ask_runUI(ui))
        for (std::vector<AskBase*>::iterator ii=ui.begin(); ii!=ui.end(); ++ii)
            std::cout << (*ii)->prompt() << (*ii)->answer() << std::endl;
    else
        std::cout << "\nEOF\n";
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-28T18:54:13.680

如果你想让模板函数成为朋友，你必须在类声明中这样说。将声明朋友函数的行更改为：

```
template <typename T> 
friend int ask_runUI(T& a_ui); 
```

现在，如果你的类本身就是一个模板，事情就会变得复杂得多。模板朋友要正确地做并非易事。为此，我将向您推荐[C++ FAQ Lite](https://isocpp.org/wiki/faq/templates#template-friends)关于该主题的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T19:01:51.090

这对我有用！

```
class AskBase {
public:
    AskBase(){}
    template<typename T> 
    friend int ask_runUI(T& a_ui);
private:
    static int const    s_EOF = -99;
    static int const    s_BACKUP = -1;
    static int const    s_NULL = 0;
    static int const    s_OK = 1;
};
//int ask_runUI()
template<typename T> 
int ask_runUI(T& a_ui)
{
    return AskBase::s_NULL;
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-05-28T18:59:23.310

最简单的可能是用枚举替换`static int const`成员而不是乱用`friend`s：

```
 class AskBase {
public:
    enum { Eof = -99, Null = 0, Ok = 1, Backup = -1 };
    ...
}; 
```

# c# - c#截屏虚拟桌面

> ID：922546
> 
> 赞同：2
> 
> 时间：2009-05-28T18:47:17.610
> 
> 标签：c#, desktop, virtual, screen, capture

我找到了一种使用 c# 创建虚拟桌面的方法。现在我想知道我们是否可以截取特定桌面的屏幕截图，如果可以，如何？

提前致谢

暴风雪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T18:56:01.383

您是否尝试过`CopyFromScreen`GFX 对象中的方法

```
 Graphics g = new Graphics();
        g.CopyFromScreen(  ....params.... ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:32:16.493

我还没有尝试过，但我要尝试的第一件事是：

*   创建一个新线程
*   通过调用 SetThreadDesktop 将线程切换到新桌面
*   截屏
*   切换线程

可能只是工作。

# blowfish - 将 TurboPower Blowfish 移植到 .Net

> ID：922547
> 
> 赞同：2
> 
> 时间：2009-05-28T18:47:24.177
> 
> 标签：blowfish, turbopower

我有一个应用程序，它最初是用 Borland C++ 编写的，并使用了在 TurboPower LockBox 组件中实现的 Blowfish 算法。

此应用程序现已移植到 C#。目前我调用了一个使用该算法的 Borland C++ dll。但是，在 64 位操作系统上运行应用程序时，每当尝试使用此 dll 时都会出错。如果我将应用程序编译为 32 位，一切正常，但我们希望让此应用程序作为 64 位应用程序工作。据我所知，这意味着我需要一个像 C++ 一样工作的 .Net Blowfish 算法。

我找到了 Blowfish.Net，它看起来很有希望。但是，当我使用相同的密钥和文本时，加密的结果不匹配。我确实发现 C++ dll 使用 BlowfishECB 算法。它还将结果转换为 Base 64，我也这样做了。

对此的任何帮助将不胜感激。这是 C# 中的一些测试代码。

```
//Convert the key to a byte array.  In C++ the key was 16 bytes long
byte[] _key = new byte[16];
Array.Clear(_key, 0, _key.Length);
var pwdBytes = System.Text.Encoding.Default.GetBytes(LicEncryptKey);
int max = Math.Min(16, pwdBytes.Length);
Array.Copy(pwdBytes, _key, max);

//Convert the string to a byte[] and pad it to to the 8 byte block size
var decrypted = System.Text.Encoding.ASCII.GetBytes(originalString);
var blowfish = new BlowfishECB();
blowfish.Initialize(_key, 0, _key.Length);
int arraySize = decrypted.Length;
int diff = arraySize%BlowfishECB.BLOCK_SIZE;
if (diff != 0)
{
    arraySize += (BlowfishECB.BLOCK_SIZE - diff);
}        
var decryptedBytes = new Byte[arraySize];
Array.Clear(decryptedBytes, 0, decryptedBytes.Length);            
Array.Copy(decrypted, decryptedBytes, decrypted.Length);    
//Prepare the byte array for the encrypted string
var encryptedBytes = new Byte[decryptedBytes.Length];
Array.Clear(encryptedBytes, 0, encryptedBytes.Length);
blowfish.Encrypt(decryptedBytes, 0, encryptedBytes, 0, decryptedBytes.Length);
//Convert to Base64
string result = Convert.ToBase64String(encryptedBytes); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T21:05:41.263

It won't compatible with your TurboPower LockBox data.

I'd suggest that you provide a utility to do the data migration by decoding using LockBox in C++ (32-bit), outputting to temp files/tables and re-encoding using Blowfish.Net and C# (64-bit).

This data migration is done once before any upgrade to the .NET version, then it's all compatible with it.

*Since you're changing the format: you could also change the format and omit the Base64 conversion by storing binary files/BLOBs, other ideas may also be useful like applying multiple encryptions, or replacing Blowfish by something else.*

# asp.net-mvc - 如何使用 MVC 将 User.Identity 添加到会话（或其他东西）

> ID：922549
> 
> 赞同：1
> 
> 时间：2009-05-28T18:47:51.527
> 
> 标签：asp.net-mvc, windows-authentication

我正在通过以前的 webforms 应用程序将其转换为 MVC，并且有一个大问题，我似乎找不到任何好的资源。我希望能够捕获用户的身份（在 web.config 中设置的 windows auth），但在 global.asax 中我似乎无法访问会话（但我可以获得身份信息）。或者当我在控制器的基类中工作时，我无法访问构造函数中的 httpContext（但我可以访问会话）

有人对这个问题有很好的解决方案吗？以前在网络表单中，我有一个母版页，它进行了一些验证并根据您的 id/etc 设置了一些会话变量

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T18:53:52.807

使用这行代码，您始终可以访问会话或任何其他基于 httpContext 的实体，只要它们已经被实例化

```
HttpContext.Current.Session
HttpContext.Current.Request
HttpContext.Current.Server
...etc 
```

而且，除非您对身份进行修改并单独存储这些修改，否则您应该始终可以访问用户和身份信息，而无需将其保存到会话中。

```
HttpContext.Current.User.Identity 
```

# python - 如何在 Python 中将全局标记为已弃用？

> ID：922550
> 
> 赞同：12
> 
> 时间：2009-05-28T18:48:00.433
> 
> 标签：python, hook, decorator, global, deprecated

[我见过装饰器](http://wiki.python.org/moin/PythonDecoratorLibrary#Smartdeprecationwarnings.28withvalidfilenames.2Clinenumbers.2Cetc..29)可以让您将函数标记为已弃用，以便在使用该函数时发出警告。我想对全局变量做同样的事情，但我想不出一种检测全局变量访问的方法。我知道 globals() 函数，我可以检查它的内容，但这只会告诉我是否定义了全局（如果该函数已被弃用而不是全部删除，它仍然会是）而不是如果它实际上被使用. 我能想到的最好的选择是这样的：

```
# myglobal = 3
myglobal = DEPRECATED(3) 
```

但除了如何让 DEPRECATED 完全像“3”一样的问题之外，我不确定 DEPRECATED 可以做什么来让您在每次访问它时都能检测到。我认为它可以做的最好的事情是遍历所有全局方法（因为 Python 中的所有内容都是一个对象，所以即使“3”也有方法，用于转换为字符串等）并将它们“装饰”以使其全部被弃用。但这并不理想。

有任何想法吗？有没有其他人解决过这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-28T19:16:29.253

您不能直接执行此操作，因为无法拦截模块访问。但是，您可以将该模块替换为您选择的充当代理的对象，以查找对某些属性的访问：

```
import sys, warnings

def WrapMod(mod, deprecated):
    """Return a wrapped object that warns about deprecated accesses"""
    deprecated = set(deprecated)
    class Wrapper(object):
        def __getattr__(self, attr):
            if attr in deprecated:
                warnings.warn("Property %s is deprecated" % attr)

            return getattr(mod, attr)

        def __setattr__(self, attr, value):
            if attr in deprecated:
                warnings.warn("Property %s is deprecated" % attr)
            return setattr(mod, attr, value)
    return Wrapper()

oldVal = 6*9
newVal = 42

sys.modules[__name__] = WrapMod(sys.modules[__name__], 
                         deprecated = ['oldVal']) 
```

现在，您可以将其用作：

```
>>> import mod1
>>> mod1.newVal
42
>>> mod1.oldVal
mod1.py:11: UserWarning: Property oldVal is deprecated
  warnings.warn("Property %s is deprecated" % attr)
54 
```

缺点是您现在在访问模块时执行了两次查找，因此对性能有轻微影响。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-29T03:51:55.353

看哪：

### 代码

```
from types import *

def wrapper(f, warning):
    def new(*args, **kwargs):
        if not args[0].warned:
            print "Deprecated Warning: %s" % warning
            args[0].warned = True
        return f(*args, **kwargs)
    return new

class Deprecated(object):
    def __new__(self, o, warning):
        print "Creating Deprecated Object"
        class temp(o.__class__): pass
        temp.__name__ = "Deprecated_%s" % o.__class__.__name__
        output = temp.__new__(temp, o)

        output.warned = True
        wrappable_types = (type(int.__add__), type(zip), FunctionType)
        unwrappable_names = ("__str__", "__unicode__", "__repr__", "__getattribute__", "__setattr__")

        for method_name in dir(temp):
            if not type(getattr(temp, method_name)) in wrappable_types: continue
            if method_name in unwrappable_names: continue

            setattr(temp, method_name, wrapper(getattr(temp, method_name), warning))

        output.warned = False

        return output 
```

### 输出

```
>>> a=Deprecated(1, "Don't use 1")
Creating Deprecated Object
>>> a+9
Deprecated Warning: Don't use 1
10
>>> a*4
4
>>> 2*a
2 
```

这显然可以改进，但要点就在那里。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-28T19:08:02.250

您可以将您的模块变成一个类（参见例如[这个 SO question](https://stackoverflow.com/questions/880530/can-python-modules-have-properties-the-same-way-that-objects-can)）并将已弃用的全局变成一个属性，这样您就可以在访问它时执行一些代码并提供您想要的警告。然而，这似乎有点矫枉过正。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-03-12T10:13:21.553

[这是PEP 562](https://www.python.org/dev/peps/pep-0562/)（在 Python 3.7 中实现）的主要理由之一：

> 典型的解决方法是将`__class__`模块对象分配给自定义子类`types.ModuleType`或用`sys.modules`自定义包装器实例替换该项目。通过识别`__getattr__`直接在模块中定义的方式来简化此过程将很方便，该模块的作用类似于普通`__getattr__`方法，除了它将在模块实例上定义。例如：
> 
> ```
> # lib.py
> 
> from warnings import warn
> 
> deprecated_names = ["old_function", ...]
> 
> def _deprecated_old_function(arg, other):
>     ...
> 
> def __getattr__(name):
>     if name in deprecated_names:
>         warn(f"{name} is deprecated", DeprecationWarning)
>         return globals()[f"_deprecated_{name}"]
>     raise AttributeError(f"module {__name__} has no attribute {name}")
> 
> # main.py
> 
> from lib import old_function  # Works, but emits the warning 
> ```

# button - 原型按钮 onClick

> ID：922552
> 
> 赞同：3
> 
> 时间：2009-05-28T18:48:48.903
> 
> 标签：button, prototypejs

如何使用prototype.js 让html 页面上的每个按钮执行相同的功能？我使用了 someElement.observe() 方法，它适用于一个按钮。但是如何在不为每个按钮单独编码的情况下为页面上的每个按钮执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T18:49:52.520

使用 css 选择器选择多个元素：

```
$$('input[type="button"]').observe(...) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-11T05:17:49.257

您还可以使用事件委托在包含您的按钮的元素（例如文档正文）上注册一个事件处理程序，并利用事件在 DOM 中冒泡这一事实。

这将确保为每个按钮调用事件处理程序，即使您将新按钮动态添加到页面。

例如

```
document.observe( 'click', function( event )
{
  var elem = event.element();
  if ( elem.match( 'input[type="button"]' ) )
  {
    // Do your event handler
  }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-26T20:02:15.483

You can use this also:

```
Event.observe(window, 'load', function(){
$('idForm').getInputs('radio', 'nameRadio').each(function(el){
el.onclick  = function(){
//Actions<br>

});
}); 
```

# sharepoint - 在 SharePoint 中更改编辑控制块 (ECB) 链接 URL

> ID：922554
> 
> 赞同：0
> 
> 时间：2009-05-28T18:49:34.440
> 
> 标签：sharepoint, wss-3.0

有没有办法在 WSS 3.0 中动态更改与 ECB 菜单关联的超链接？例如，我有一个包含 2 个字段的列表。一个字段是隐藏的并且是一个链接，另一个是具有 ECB 菜单的标题字段。标题字段当前链接到项目的查看页面 - 但我们希望它链接到链接字段的 url。那可能吗？

* * *

更新 - 2009 年 5 月 29 日上午 9 点到目前为止我有这个。请参阅此[TechNet 帖子](http://social.msdn.microsoft.com/Forums/en-US/sharepointcustomization/thread/0bdf6234-718a-4498-9b4c-6b309a2e5003)。

```
<script type="text/javascript">
var url = 'GoTo.aspx?ListTitle='+ctx.ListTitle;
url += '&ListName='+ctx.listName;
url += '&ListTemplate='+ctx.listTemplate;
url += '&listBaseType='+ctx.listBaseType;
url += '&view='+ctx.view;
url += '&';

var a = document.getElementsByTagName('a');
for(i=0;i<=a.length -1;i++)
{
   a[i].href=a[i].href.replace('DispForm.aspx?',url);
}
</script> 
```

这给了我一个这样的链接（格式化以便更容易看到）：

```
GoTo.aspx
?ListTitle=MyList
&ListName={082BB11C-1941-4906-AAE9-5F2EBFBF052B}
&ListTemplate=100
&listBaseType=0
&view={9ABE2B07-2B47-4390-9969-258F00E0812C}
&ID=1 
```

我现在的问题是网格中的行为每个项目提供了上面的 ID 属性，但是如果我更改视图或进行任何过滤，您可以看到 ID 实际上只是行号。我可以在这里获取实际项目的 GUID 吗？

如果我可以获取项目的 ID，我可以将其与列表 ID 一起发送到应用程序页面，该页面将从列表中的字段获取正确的 URL 并将用户转发到正确的站点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T06:57:29.287

编辑菜单的标题/链接是一个计算字段 - 基本上是标题和项目 ID 的组合。如果您查看该字段的定义（我认为它在 fields.xml 中），您应该能够在您的 schema.xml 中创建一个修改版本，该版本使用其 RenderPattern 中的 url 字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T07:08:43.820

按照 Tom 的回答，您可以使用 VseWss 1.3 中的 SharePoint 解决方案生成器来生成可以重新创建列表的 Visual Studio 解决方案。当您看到视图在 schema.xml 文件中使用的大量 XML 时，您会感到头晕目眩，但您会看到 Tom 提到的渲染模式，您应该能够大致了解如何修改它以适应您的需求需要。

一定会喜欢 SharePoint。小的定制意味着“拿走我给你的东西或从头开始重写”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T21:36:25.727

我认为最简单的解决方案也是我经常用来修改默认共享点功能而无需安装服务器端代码的解决方案是在页面上注入一些 javascript 以进行必要的修改。

如果您不想编辑页面源本身，则内容编辑器 Web 部件非常适合。与 IE Developer Toolbar 或 Firebug 一起检查您想要编辑的元素，您应该能够通过几行 javascript 来实现您所需要的。

如果您需要有关完成这项工作的更多详细信息，请告诉我。

# project-management - 我应该如何开始这样的项目？

> ID：922559
> 
> 赞同：-3
> 
> 时间：2009-05-28T18:50:48.727
> 
> 标签：project-management, project-planning

为了了解其他人如何解决项目问题，我提出了这个项目公式：

*   该项目涉及几个不同的客户数据库，应在其中读取数据并将其上传到项目的数据库服务器。

*   当新客户到达时，除了一些关于客户业务类型的一般知识之外，通常几乎没有关于客户数据库的任何信息。

*   它需要一个程序来读取客户的数据。

*   它需要一个具有不同客户数据横截面的网站，试图以通用的方式为不同的客户做一些事情。

*   它需要处理几个 GB 的数据库。并与客户的数据库同步数百万行。

*   网站的视觉外观和功能应该令人眼花缭乱，包括图表、类似报告服务器的功能以及电子邮件和短信报告。

*   不同的客户可能也会有不同的要求，因此应该以某种方式对系统进行参数化。

*   不同的用户可能还希望有一些个性化的页面。

*   可能还需要项目、文档和手册的一些广告页面。

*   网页的加载速度应超过 0.1 秒，并同时为数百名用户提供服务。

您将如何处理这样的要求？

最初你会带多少人参与这个项目？

您预计需要哪些不同的专业/专业知识？

你会多么仔细地计划这样一个项目？

* * *

编辑：好的，这听起来可能不切实际，但第一步应该是什么，什么样的组织能够适当地处理这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T18:59:46.027

除以下内容外，此问题中没有列出任何要求：

*   大型未知数据文件将被上传并处理到数据库中。
*   这些大数据将显示在网站上。
*   该网站应该令人眼花缭乱。
*   即使有数百名用户，该网站也应该很快。

我建议您雇用某人以获得更好的要求。如果您需要技术建议，您可以在这里获得：

*   C 速度很快。（但许多其他事情也是如此）
*   Flash 网站令人眼花缭乱。:(
*   Apache 或 IIS 与 MySQL/PostgreSQL/MSSQL 相结合都能够处理大型服务器负载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T19:02:19.373

`<troll>`

> 您将如何处理这样的要求？

吓坏了

> 最初你会带多少人参与这个项目？

第一天？一个——我。第二天？可能更多。

> 您预计需要哪些不同的专业/专业知识？

首先：数据库人员、后端人员、字体端人员和猜测未知数据库结构的通灵者

> 你会多么仔细地计划这样一个项目？

不是特别的。实际上，如果没有更好的规格，我不会接受这个项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T20:49:01.220

通过思维导图响应
[http://itprojectguide.org/files/projectx.png - 直接链接到图像](http://itprojectguide.org/files/projectx.png) [替代文本 http://itprojectguide.org/files/projectx.png](http://itprojectguide.org/files/projectx.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T13:23:32.727

如果我正确理解您的问题，对我来说这似乎是一个数据仓库项目。

**从技术角度：**

您需要为每个客户数据库设置一个“暂存区”，将要加载的相关数据放置在您的中央系统中。

然后，您的工作将是从每个暂存区域加载数据，将其转换为通用格式并将其存储在您的数据库中。

然后，在您的数据库上使用报告工具来构建漂亮的报告、数据挖掘等。

您可以使用专门的 ETL 工具（它们可能非常昂贵）或使用简单的 SQL 结合一些过程语言和脚本来进行数据转换和加载。

您可以使用专门的报告工具（例如 Business Objects）在已构建的数据仓库上构建您的报告。他们的特点之一是他们被认为允许最终用户自定义和构建他们自己的报告。

**从人员配置上看：**

你需要在数据仓库工作的人。我不能说团队的规模，因为它取决于数据源的数量和复杂性。

**规划：**

我建议采取以下步骤：

1.  使用第一批客户来识别仓库的通用数据模型。
2.  实现通用数据仓库功能（通用模型、元数据、ETL 转换的基本框架、报表的基本支持）。这将建立“基础设施”。这里还需要硬件设置和调整大小。
3.  使用迭代来设置客户。在每次迭代中，分析源数据，开发数据过滤器以仅选择要加载到数据仓库中的相关数据，设计和实施数据转换，如有必要，设计和实施新报告。

一旦数据仓库模型和结构（基础设施）到位，您可以将每个新客户视为一个单独的迭代来处理，并在并行迭代中处理多个客户。

# refactoring - 将条件展平为重构

> ID：922561
> 
> 赞同：2
> 
> 时间：2009-05-28T18:51:02.207
> 
> 标签：refactoring, coderush

考虑：

```
if (something) {
    // Code...
} 
```

安装 CodeRush 后，建议执行以下操作：

```
if (!something) {
    return;
}
// Code... 
```

有人可以解释一下这更好吗？当然，从来没有什么好处。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T19:04:22.740

孤立，正如您所介绍的那样 - 没有任何好处。但是 mark4o 是正确的：它的嵌套更少，如果你看一下，这会变得非常清楚，比如 4 级嵌套：

```
public void foo() {
    if (a)
        if (b)
            if (c)
                if (d)
                    doSomething();
} 
```

相对

```
public void foo() {
    if (!a)
        return;
    if (!b)
        return;
    if (!c)
        return;
    if (!d)
        return;
    doSomething();
} 
```

像这样的早期返回提高了可读性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T18:58:37.323

在某些情况下，在方法开始时验证所有输入并在任何不正确的情况下退出会更干净。您可以进行一系列单级 if 检查，依次检查越来越具体的事物，直到您确信自己的输入是好的。然后，该方法的其余部分将更容易编写，并且往往具有更少的嵌套条件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T18:55:59.527

少一层嵌套。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T19:13:11.553

这是为了可维护性而进行的传统重构。看：

[http://www.refactoring.com/catalog/replaceNestedConditionalWithGuardClauses.html](http://www.refactoring.com/catalog/replaceNestedConditionalWithGuardClauses.html)

在一个条件下，这并不是一个很大的改进。但它遵循“快速失败”的原则，当你有很多条件时，你才真正开始注意到它的好处。如果您在“结构化编程”中长大，通常建议函数具有单个退出点，这可能看起来不自然，但如果您曾经尝试调试具有三层或更多嵌套条件的代码，您将开始欣赏它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T19:01:58.453

它可用于使代码更具可读性（通过减少嵌套）。请参阅[此处](https://stackoverflow.com/questions/355670/is-returning-early-from-a-function-more-elegant-than-an-if-statement)以获取一个很好的示例，并[在此处](https://stackoverflow.com/questions/137115/are-multiple-return-points-from-a-method-good-or-bad)对优点进行很好的讨论。

这种模式通常用于替换：

```
void SomeMethod()
{
    if (condition_1)
    {
        if (condition_2)
        {
            if (condition_3)
            {
                // code
            }
        }
    }
} 
```

和：

```
void SomeMethod()
{
    if (!condition_1) { return; }
    if (!condition_2) { return; }
    if (!condition_3) { return; }

    // code
} 
```

这对眼睛来说更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T19:04:28.323

好吧，这样看（我以php为例）：

您填写表格并转到此页面：validate.php

示例 1：

```
<?php

if (valid_data($_POST['username'])) {

    if (valid_data($_POST['password'])) {

        login();

    } else {
        die();
    }

} else {
    die();
}

?> 
```

对比

```
<?php

if (!valid_data($_POST['username'])) {
    die();
}

if (!valid_data($_POST['password'])) {
    die();  
}

login();

?> 
```

哪一个更好更容易维护？请记住，这只是验证两件事。想象一下这是一个注册页面或其他东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T18:56:10.433

我不认为 CodeRush 推荐它 --- 而只是提供它作为一个选项。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T19:01:05.913

IMO，这取决于是否`something`是`!something`例外情况。如果发生大量代码`something`，那么使用`!something`条件对于易读性和潜在的嵌套减少更有意义。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-11T08:40:39.770

我清楚地记得在一项大学作业中失分，因为我和

```
if (!something) {
    return;
}
// Code... 
```

格式。我的讲师断言，在一个函数中有多个退出点是不好的做法。我认为那太疯狂了，经过 20 多年的计算机编程，我仍然如此。

公平地说，他生活在一个通用语言是 C 的时代，函数通常是一页长的页面，并且充满了嵌套条件，因此很难跟踪正在发生的事情。

然而，过去和现在，简单才是王道：让函数保持小规模并对其进行良好的注释是使事物可读和可维护的最佳方式。

# python - PyObjC 中的 Unicode 问题

> ID：922562
> 
> 赞同：3
> 
> 时间：2009-05-28T18:51:32.873
> 
> 标签：python, macos, unicode, pyobjc

我正在尝试在 Mac OS X 上找出 PyObjC，并且我编写了一个简单的程序来打印出地址簿中的名称。但是，我在输出编码方面遇到了一些问题。

```
#! /usr/bin/env python
# -*- coding: UTF-8 -*-

from AddressBook import *

ab = ABAddressBook.sharedAddressBook()
people = ab.people()

for person in people:
    name = person.valueForProperty_("First") + ' ' + person.valueForProperty_("Last")
    name 
```

当我运行这个程序时，输出看起来像这样：

```
...snip...
u'Jacob \xc5berg'
u'Fernando Gonzales'
...snip... 
```

有人可以解释为什么字符串是 unicode，但内容看起来像这样吗？

我还注意到，当我尝试打印名称时出现错误

```
UnicodeEncodeError: 'ascii' codec can't encode character u'\xc5' in position 6: ordinal not in range(128) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T19:02:45.893

```
# -*- coding: UTF-8 -*- 
```

仅影响 Python 解码源中的注释和字符串文字的方式，**而不**影响标准输出的配置方式等。如果您将 Mac 的终端设置为 UTF-8（终端、首选项、设置、高级、国际下拉菜单）并发出用 UTF-8 ( `print name.encode("utf-8")`) 编码后的 Unicode 文本，你应该没问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T06:12:33.033

如果您在交互式控制台中运行问题中的代码，解释器将打印“name”的 repr，因为循环的最后一条语句。

如果将循环的最后一行从“名称”更改为“打印名称”，则输出应该没问题。我已经在 10.5.7 系统上使用 Terminal.app 对此进行了测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:56:54.237

只需将变量名写入`repr(name)`标准输出并`repr()`编码所有 unicode 值。

`print`尝试转换`u'Jacob \xc5berg'`为 ASCII，这是行不通的。尝试将其写入文件。

请参阅[python wiki 上的 Print Fails](http://wiki.python.org/moin/PrintFails)。

> 这意味着您使用的是旧版、受限或配置错误的控制台。如果您只是想在交互式提示下使用 unicode，请转到现代的 unicode 感知控制台。大多数现代 Python 发行版都带有 IDLE，您可以在其中打印所有 unicode 字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T19:08:02.903

通过以下方式将其转换为 unicode 字符串：

```
print unicode(name) 
```

# linq - F# 和 PLINQ 扩展方法

> ID：922563
> 
> 赞同：4
> 
> 时间：2009-05-28T18:51:52.000
> 
> 标签：linq, visual-studio-2010, f#, extension-methods, plinq

在深入研究 F# 的最新版本时，我尝试让它与 PLINQ 交互。然而，我注意到两者在代码方面并没有很好地结合在一起。事实上，编写如下代码似乎是不可能的：

```
 open System.Linq
let someArray = [|"abc"; "def"|]
someArray.AsParallel().Count(new Func<_,_>(fun s -> s.Length = 3)) 
```

因为 System.Linq.ParallelEnumerable 类中包含的 ParallelQuery 的扩展方法似乎没有被 F# 采用。
如果根本不支持扩展方法，我不会感到惊讶，但是由于我可以访问为 IEnumerable 定义的 someArray.Count 扩展方法，我想知道为什么我不能访问 PLINQ 的扩展方法。
我错过了什么吗？
这是 F# 限制吗？如果是这样，是通过设计吗？如果没有，是否会在未来的版本中解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T19:18:23.460

如果你还没有使用 .NET 4.0，你可以这样写：

```
#r "System.Threading"
open System.Linq

let someArray = [|"abc"; "def"|]

someArray.AsParallel<string>()
|> Seq.filter (fun s -> s.Length = 3)
|> Seq.length 
```

来到 .NET 4.0，你可以写：

```
let someArray = [|"abc"; "def"|]

someArray
|> Array.Parallel.filter (fun s -> s.Length = 3)
|> Array.length 
```

F# 更喜欢使用 Seq 模块而不是 Linq 扩展方法。但是，在 FSharp.PowerPack.Linq 程序集中有一些辅助函数可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T18:56:29.200

如果我没记错的话，让 PLINQ 与 F# 很好地协同工作是 Microsoft 开发团队的待办事项，尽管我不确定它是否会出现在 .NET 4.0 中。然而， F# 确实有[**Asynchronous Workflows**](http://msdn.microsoft.com/en-us/library/dd233250(VS.100).aspx)，它与 PLINQ 非常相似（除了它基于列表推导，这是标准的函数式做事方式）。我似乎找不到提到在 F# 中更好地支持并行扩展 (PLINQ/TPL) 的文章，所以不要引用我的话，但我很确定我在某处看到它。

除了 MSDN 页面，[这篇文章](http://www.infoq.com/articles/pickering-fsharp-async;jsessionid=FFCDCA824BD2C2703C0F767D2E9B16C9)似乎是对该主题的一个很好的介绍。

如果您仍然喜欢使用 PLINQ 而不是 Async Workflows，那么还有[这个博客系列](http://www.navision-blog.de/2008/10/23/using-plinq-in-fsharp-parallel-map-and-reduce-fold-functions/)（*在 F# 中使用 PLINQ*）可能会很方便阅读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T20:39:27.603

扩展方法只是将对象作为第一个参数的静态方法，因此您应该可以使用

```
ParallelEnumerable.AsParallel(someArray).Count(...) 
```

# c# - 尝试使用 iTextSharp 创建 PDF 后打开它，但无法正常工作？

> ID：922564
> 
> 赞同：0
> 
> 时间：2009-05-28T18:52:37.803
> 
> 标签：c#, asp.net, itextsharp

单击时我有一个按钮，将文本插入 pdf 的表单字段并将填充的 pdf 保存到目录中。当我编辑完 pdf 后，我想在浏览器中打开 pdf，但 Process.Start() 不起作用。有没有更好的方法在生成 pdf 后立即显示它？这是按钮的代码：

```
protected void btnGenerateQuote_Click(object sender, EventArgs e)
{
    string address = txtAddress.Text;
    string company = txtCompany.Text;
    string outputFilePath = @"C:\Quotes\Quote-" + company + "-.pdf";
    PdfReader reader = null;
    try
    {
        reader = new PdfReader(@"C:\Quotes\Quote_Template.pdf");
        using (FileStream pdfOutputFile = new FileStream
                                          (outputFilePath, FileMode.Create))
        {
            PdfStamper formFiller = null;
            try
            {
                formFiller = new PdfStamper(reader, pdfOutputFile);
                AcroFields quote_template = formFiller.AcroFields;
                //Fill the form
                quote_template.SetField("OldAddress", address);
                //Flatten - make the text go directly onto the pdf 
                //          and close the form.
                //formFiller.FormFlattening = true;
            }
            finally
            {
                if (formFiller != null)
                {
                     formFiller.Close();
                }
            }
        }
    }
    finally
    {
        reader.Close();
    }
    //Process.Start(outputFilePath); // does not work
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T06:49:21.180

由于根据标签这是关于 ASP.NET 的，因此您不应该使用 Process.Start() 而是例如这样的代码：

```
private void respondWithFile(string filePath, string remoteFileName) 
{
    if (!File.Exists(filePath))
        throw new FileNotFoundException(
              string.Format("Final PDF file '{0}' was not found on disk.", 
                             filePath));
    var fi = new FileInfo(filePath);
    Response.Clear();
    Response.AddHeader("Content-Disposition", 
                  String.Format("attachment; filename=\"{0}\"", 
                                 remoteFileName));
    Response.AddHeader("Content-Length", fi.Length.ToString());
    Response.ContentType = "application/octet-stream";
    Response.WriteFile(fi.FullName);
    Response.End();
} 
```

这将使浏览器给出保存/打开对话框。

# crystal-reports - Crystal 报表中的重叠分组

> ID：922565
> 
> 赞同：1
> 
> 时间：2009-05-28T18:52:42.170
> 
> 标签：crystal-reports

我有一个数据集，每个月都有一些数字。例如：

2009 年 1 月 1 日 参数 1 参数 2

2/1/2009 参数 1 参数 2

2009 年 3 月 1 日 参数 1 参数 2

我需要的是显示 4 行摘要：

1.  过去 6 个月
2.  今年（过去 12 个月）
3.  去年（12 至 24 个月前）
4.  全部的

我正在考虑为每条记录添加一个参数，将每条记录分配到特定的时间范围（6 个月前、12 个月前等）。但是组 1 和组 2 是重叠的，所以一些记录属于两者。

您对如何显示此类摘要有任何建议吗？

非常感谢！艾琳

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T21:43:03.527

您可以将运行总计与评估公式一起使用，以仅对某些行进行总计。假设您有一个 {asofdate} 参数和 {month} 数据字段...

1.  过去 6 个月

    datediff("m", {month}, {asofdate}) <= 6

2.  今年（过去 12 个月）

    datediff("m", {month}, {asofdate}) <= 12

3.  去年（12 至 24 个月前）

    datediff("m", {month}, {asofdate}) >= 13 和 datediff("m", {month}, {asofdate}) <= 24

4.  总共只用一笔

# c# - ASP.NET：多个程序集版本，相同的 Web 应用程序

> ID：922571
> 
> 赞同：4
> 
> 时间：2009-05-28T18:54:12.183
> 
> 标签：c#, .net, asp.net, vb.net, legacy

希望你们那里的 ASP.NET 专业人士可以回答这个问题。我有一个包含网站和 Web 服务的 Web 应用程序——两者都有几个共同的程序集引用（数据访问层、实用程序等）——但是，最近对 Web 服务所做的更改将需要不同***版本***的公共程序集，该网站无法使用的版本（如果您想知道，该网站是一些旧的 1.x .NET 代码，在使用较新版本的程序集时会爆炸。）

谁能想出一种方法让我的网络服务引用一个版本并让我的网站引用另一个版本？**我显然只能在bin**文件夹中拥有一个同名的版本。

谢谢！

（PS - 我突然意识到我可以编译和引用具有不同名称的公共程序集，并将它们放在 Web 应用程序的**bin**文件夹中 - 但这听起来真的很丑......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T18:57:28.963

或者，您可以将 Web 服务分离为独立于网站的新应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:00:00.767

您可以使用 web.config 的运行时部分来指定要使用的 dll（我们之前为 SQLLite 做过）：

```
 <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <qualifyAssembly partialName="System.Data.SQLite" fullName="System.Data.SQLite, Version=1.0.60.0, Culture=neutral, PublicKeyToken=db937bc2d44ff139" />
    </assemblyBinding>
  </runtime> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T19:00:08.647

> 我有一个包含网站和 Web 服务的 Web 应用程序

那是你的主要问题，你发布了一个部分功能的应用程序，它依赖于两个不同的库代码库......

即使您要使用不同的名称复制和重新引用您的公共程序集，您仍然会被限制（请原谅这个短语）：该程序集中所有类的命名空间。

我认为您最好的选择是暂时将 Web 服务从您的 Web 应用程序中拉出，并将它们作为两个单独的应用程序托管，直到您可以解决 Common Lib 的版本控制问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T20:02:17.350

我不认为将较新的集合编译成具有不同名称的程序集会起作用 - .NET 仍然会看到相同的命名空间 - 所以充其量你会有“不明确的引用”或“类型 x 已经在 dll y 中声明”错误，或者在最坏的情况下，框架会加载与首先调用的应用程序部分相关的那个（网站 => 1.1，webservice => 2.0）并忽略另一个。

您最好的选择是将应用程序重构为两个 - 网站和 Web 服务。

在过去的几年里，我们一直在与我们的一个客户一起做这件事——他们有一个基于 ASP.NET 1.1 构建的巨大网站，但是最近他们的独立项目已经开始迁移到 2.0（引擎盖下是 3.5，但是显然它仍然在 2.0 下托管）——我们基本上不得不将公共代码移植到一组针对 3.5 构建的新库，同时利用新的语言特性，并且我们已经将这些部分移到了新网站（在 IIS 中），因为它们已完成。

这并不理想，是的，我们留下了两个代码库副本（1.1 和 2.0），任何修复通常都必须在两个地方推出，但这似乎是开始移动它们的最佳方式。

# c# - Fluent NHibernate 自动映射错误

> ID：922588
> 
> 赞同：2
> 
> 时间：2009-05-28T18:56:27.903
> 
> 标签：c#, nhibernate, fluent-nhibernate, automapping

这让我摸不着头脑，所以我希望第二双眼睛能帮助我。

设置：

我有一个名为 DomainEntity 的基类，我的所有数据传输对象都使用它。它基本上只定义了一个名为 Id 的属性（它是一个整数）。

我有数据传输对象：博客、帖子、用户 DomainEntity 在命名空间 Core.Domain 中，数据传输对象在 Core.Domain.Model 下

我有以下会话生成器代码：

```
return Fluently.Configure()
    .Database(SQLiteConfiguration.Standard.UsingFile("c:\blog.db"))
    .Mappings(x => x.AutoMappings.Add(
        AutoPersistenceModel.MapEntitiesFromAssemblyOf<Blog>()
            .Where(type => 
                type.Namespace.EndsWith("Domain.Model") &&
                !type.IsAbstract &&
                type.IsClass &&
                type.GetProperty("Id") != null)    
     )).BuildSessionFactory(); 
```

当我尝试测试一个简单的查询时，我在上面的代码（某处）上得到一个应用程序异常，错误消息是：

> System.ApplicationException：尝试为'Core.Domain.DomainEntity'构建映射文档时出错---> NHibernate.MappingException：无法编译映射文档：（XmlDocument）---> System.IndexOutOfRangeException：索引超出了数组的边界。

似乎我的代码/NHibernate 正在尝试映射 DomainEntity，但失败了。我认为我上面的代码明确声明*不要*使用 type.Namespace.EndsWith("Domain.Model") 映射该对象。那是对的吗？我在哪里会误入歧途？

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T01:30:23.227

看起来我忘记了以下行：

```
.WithSetup(a => a.IsBaseType = type => type == typeof(DomainEntity)) 
```

因此，总的来说，我的新自动映射代码如下所示：

```
return Fluently.Configure()
                .Database(SQLiteConfiguration.Standard.UsingFile("c:\\blog.db"))
                .Mappings(x => x.AutoMappings.Add(
                   AutoPersistenceModel.MapEntitiesFromAssemblyOf<Blog>()
                       .WithSetup(a => a.IsBaseType = type => type == typeof(DomainEntity))
                       .Where(type =>
                           type.Namespace.EndsWith("Domain.Model") &&
                           !type.IsAbstract &&
                           type.IsClass &&
                           type.GetProperty("Id") != null)
                   )).BuildSessionFactory(); 
```

这似乎已经清除了我的错误。

# c - 是否仍然值得尝试在 C 中为 sqrt() 创建优化？

> ID：922599
> 
> 赞同：4
> 
> 时间：2009-05-28T18:58:59.380
> 
> 标签：c, performance, optimization

用于创建更快的 sqrt() 实现的旧技巧（查找表、近似函数）是否仍然有用，或者默认实现是否与现代编译器和硬件一样快？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-29T01:37:06.347

## 规则 1：优化前的配置文件

在投入任何努力相信您可以击败优化器之前，您必须分析所有内容并发现瓶颈的真正所在。一般来说，它`sqrt()`本身不太可能是你的瓶颈。

## 规则 2：在替换标准函数之前替换算法

即使`sqrt()`是瓶颈，那么仍有合理的可能存在可以消除`sqrt()`首先调用的算法方法（例如按长度平方排序距离，无需调用任何数学函数即可轻松计算）。

## 如果您什么都不做，编译器会为您做什么

许多现代 C 编译器愿意在更高的优化级别内联 CRT 函数，使自然表达式包括调用`sqrt()`尽可能快。

特别是，我检查了 MinGW gcc v3.4.5，它`sqrt()`用内联代码替换了对 FPU 状态的调用，并在核心使用了`FSQRT`指令。由于 C 标准与 IEEE 754 浮点交互的方式，它确实必须遵循`FSQRT`一些代码来检查异常情况并`sqrt()`从运行时库调用真实函数，以便浮点异常可以由标准要求的库。

使用`sqrt()`inline 并在更大的 all`double`表达式的上下文中使用时，考虑到标准合规性和保持完全精度的约束，结果尽可能高效。

对于编译器和目标平台的这种（非常常见的）组合并且不了解用例，这个结果非常好，并且代码清晰且可维护。

在实践中，任何技巧都会使代码变得不那么清晰，并且可能更难维护。毕竟，您更愿意维护`(-b + sqrt(b*b - 4.*a*c)) / (2*a)`还是不透明的内联汇编和表格块？

此外，在实践中，您通常可以依靠编译器和库作者来充分利用您平台的功能，并且通常比您更了解优化的细微之处。

但是，在极少数情况下，可以做得更好。

一种这样的情况是在计算中，您知道您真正需要多少精度，并且还知道您不依赖于 C 标准的浮点异常处理，而是可以与硬件平台提供的东西相处。

**编辑：**我重新排列了文本，以强调 Jonathan Leffler 在评论中建议的分析和算法。谢谢，乔纳森。

**Edit2：修正了**[kmm](https://stackoverflow.com/users/152113/kmm)敏锐的眼睛发现的二次示例中的优先错字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T19:01:35.193

Sqrt 在大多数系统上基本不变。这是一个相对较慢的操作，但总体系统速度有所提高，因此可能不值得尝试使用“技巧”。

使用可以实现的（次要）增益的近似值来优化它的决定实际上取决于您。现代硬件已经消除了对这些类型牺牲（速度与精度）的一些需求，但在某些情况下，这仍然很有价值。

我会使用分析来确定这是否“仍然有用”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T22:10:17.013

如果您已经证明代码中对*sqrt()*的调用是分析器的瓶颈，那么可能值得尝试创建优化版本。否则就是浪费时间。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-12T00:48:39.107

这可能是计算平方根的最快方法：

```
float fastsqrt(float val)  {
        union
        {
                int tmp;
                float val;
        } u;
        u.val = val;
        u.tmp -= 1<<23; /* Remove last bit so 1.0 gives 1.0 */
        /* tmp is now an approximation to logbase2(val) */
        u.tmp >>= 1; /* divide by 2 */
        u.tmp += 1<<29; /* add 64 to exponent: (e+127)/2 =(e/2)+63, */
        /* that represents (e/2)-64 but we want e/2 */
        return u.val;
} 
```

[维基百科文章](http://en.wikipedia.org/wiki/Methods_of_computing_square_roots)

* * *

这可能是计算平方根倒数的最快方法。假设最多 0.00175228 错误。

```
float InvSqrt (float x)
{
    float xhalf = 0.5f*x;
    int i = *(int*)&x;
    i = 0x5f3759df - (i>>1);
    x = *(float*)&i;
    return x*(1.5f - xhalf*x*x);
} 
```

这（非常粗略地）比大约快 4 倍`(float)(1.0/sqrt(x))`

[维基百科文章](http://en.wikipedia.org/wiki/Fast_inverse_square_root)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-06T16:19:00.487

通常可以安全地假设标准库开发人员非常聪明，并且编写了高性能代码。一般来说，您不太可能匹配它们。

所以问题就变成了，你知道什么能让你做得更好吗？我不是在询问用于计算平方根的特殊算法（标准库开发人员也知道这些，如果它们通常值得，他们已经使用它们了），但是你有关于*你*使用的任何具体信息吗情况，这改变了情况？

您只需要有限的精度吗？如果是这样，与必须准确的标准库版本相比，您可以加快速度。

或者您是否知道您的应用程序将*始终*在特定类型的 CPU 上运行？然后你可以看看那个 CPU 的 sqrt 指令效率如何，看看有没有更好的替代方案。当然，这样做的缺点是如果我在另一个 CPU 上运行你的应用程序，你的代码可能会比标准的 sqrt() 慢。

你能在你的代码中做出标准库开发者做不到的假设吗？

您不太可能想出更好的解决方案来解决“实现标准库 sqrt 的有效替代”的问题。

但是您可能会想出一个解决方案来解决“针对*这种*特定情况实施有效的平方根函数”的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-29T10:19:13.020

为什么不？你可能会学到很多东西！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-06T16:05:50.187

由于现代计算机的设计方式，我很难相信 sqrt 函数是您的应用程序的瓶颈。假设这不是关于某些疯狂的低端处理器的问题，那么您访问 CPU 缓存之外的内存的速度会受到极大的影响，因此除非您的算法正在对很少的数字进行数学运算（足够他们全部基本上适合 L1 和 L2 缓存）您不会注意到优化任何算术的任何速度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-06T15:22:43.987

即使现在我仍然觉得它很有用，尽管这是为了响应变形网格而对每帧一百万个以上的向量进行归一化的上下文。

也就是说，我通常不会创建自己的优化，而是依赖作为 SIMD 指令提供的逆平方根的粗略近似：`rsqrtps`. 如果您愿意为速度牺牲精度，那么这对于加速某些实际案例仍然非常有用。使用`rsqrtps`实际上可以将包括顶点法线变形和归一化在内的整个操作减少到几乎一半的时间，但以结果的精度为代价（也就是说，以人眼几乎无法注意到的方式）。

我仍然发现快速逆 sqrt 经常被错误地归功于 John Carmack 仍然可以提高标量情况下的性能，尽管我现在不怎么使用它。如果您愿意牺牲准确性，通常会自然而然地获得一些速度提升。也就是说，`sqrt`如果您不尝试牺牲精度来提高速度，我什至不会尝试击败 C。

You generally have to sacrifice the generality of the solution (like its precision) if you want to beat standard implementations, and that tends to apply whether it's a mathematical function or, say, `malloc`. I can easily beat `malloc` with a narrowly-applicable free list lacking thread-safety that's suitable for very specific contexts. It's another thing to beat it with a general-purpose allocator which can allocate variable-sized chunks of memory and free any one of them at any given time.

# javascript - 当你显示和隐藏一个 div 时，它会自动重新调整周围的元素吗？

> ID：922600
> 
> 赞同：4
> 
> 时间：2009-05-28T18:59:06.713
> 
> 标签：javascript, ajax

当你显示和隐藏一个 div 时，它会自动重新调整周围的元素吗？

谷歌地图的排序方式[http://maps.google.com/maps?hl=en&tab=wl](http://maps.google.com/maps?hl=en&tab=wl)有那个小图标，您可以在其中显示/隐藏左窗格。

它只是通过动画效果使其可见还是比这更复杂？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T19:09:19.360

在重新调整方面，如果您使用 CSS，则取决于天气是否使用 display:none 选项或 visibility:hidden 标签。

*可见性*会隐藏它但不会影响周围的元素，另一方面*显示会......*

查看应该突出显示这一点的这段代码......

```
<div style="border: solid 2px black;">
    <div style="visibility: hidden;">
        Hello
        <br />    
    </div>
</div>

<br />

<div style="border: solid 2px black;">
    <div style="display: none;">
        Hello
        <br />    
    </div>
</div> 
```

希望能帮助到你！**:)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T20:03:08.330

任何进入/退出正常流程（默认定位）的元素都会导致页面的其余部分相应地重新调整。但是，有一些方法可以从正常流程中删除元素。

`position: absolute`或`position: relative`将从正常流程中删除一个元素。使用这些，其他元素的行为就像定位的元素不存在一样（除非它们也使用定位规则）。

隐藏/显示一个 div：

`display: none`
将从正常流程中移除一个元素

`visibility: hidden`
将隐藏该元素，但在正常流程中保持其尺寸

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:00:17.117

取决于它是相对定位还是绝对定位。而在谷歌的例子中，它更复杂，但不是那么复杂，一旦动画完成，面板右侧的控件就会移动。

# visual-c++ - 我应该将 CString 传递给 Format/printf （以及一般的可变参数）吗？

> ID：922603
> 
> 赞同：1
> 
> 时间：2009-05-28T18:59:39.770
> 
> 标签：visual-c++, printf, variadic-functions, cstring

我最近接了一个小型的MCF C++应用程序，它显然处于工作状态。首先，我在代码上运行 PC-Lint，而 lint 抱怨 CStringT 正在传递给 Format。互联网上的意见似乎存在分歧。有人说 CSting 旨在无错误地处理这个用例，但其他人（以及[MSDN 文章）](http://msdn.microsoft.com/en-us/library/awkwbzyc(VS.71).aspx)说它应该在传递给可变参数函数时始终被强制转换。Stackoverflow 可以就这个问题达成任何共识吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T06:16:16.443

CString 经过精心设计，可以作为变量参数列表的一部分传递，因此以这种方式使用它是安全的。而且您可以相当肯定，Microsoft 会注意不要破坏这种特殊行为。因此，如果您愿意，我会说您可以安全地继续以这种方式使用它。

也就是说，我个人更喜欢演员阵容。字符串类的行为方式并不常见（例如 std::string 没有），并且为了精神上的一致性，最好以“安全”的方式进行。

PS：有关实现细节和有关如何投射的进一步说明，请参阅此[线程。](http://groups.google.com/group/microsoft.public.vc.mfc/browse_thread/thread/028f80f03d7e253d)

# c# - 什么是 DailyTrigger 和 ScheduledTasks？

> ID：922606
> 
> 赞同：1
> 
> 时间：2009-05-28T18:59:46.760
> 
> 标签：c#, scheduled-tasks

我刚看到这个[问题](https://stackoverflow.com/questions/922444/how-to-schedule-a-c-windows-service-to-run-a-method-daily-closed)，其中一个答案看起来对我很有吸引力，但我不知道这些课程是从哪里来的。

我可以找到什么程序集 DailyTrigger 和 ScheduledTasks 类？

它们在什么命名空间中？

它们是否仅对位于控制面板中的 Windows 计划任务有用？

还有其他关于他们的有用信息我应该知道吗？

我指的代码：

```
Trigger tg = new DailyTrigger();
ScheduledTasks st = new ScheduledTasks();
Task t = st.OpenTask("foo");
t.Triggers.Add(tg);
t.Save(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T19:04:09.917

请参阅 MSDN 上的[DailyTrigger](http://msdn.microsoft.com/en-us/library/aa446858.aspx)参考。它是[Windows 任务计划程序](http://msdn.microsoft.com/en-us/library/aa383614.aspx)的一部分：

> 任务计划程序使您能够在选定的计算机上自动执行例行任务。任务计划程序通过监视您选择启动任务的任何标准（称为触发器）然后在满足标准时执行任务来执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:25:34.773

这是来自 CodeProject.com 项目：www.codeproject.com /KB/cs/tsnewlib.aspx

这是一个使用 Windows 中内置的 TaskScheduler 服务的 .NET 类。

另请查看 weblogs.asp.net /jguadagno/archive/2008/10/15/new-open-source-application-net-task-service.aspx 或 Quartz.NET (quartznet.sourceforge.net) 以获得其他调度服务。

# windows - 我可以使用单个“复制”命令在 Windows 命令行上复制多个命名文件吗？

> ID：922607
> 
> 赞同：39
> 
> 时间：2009-05-28T18:59:54.823
> 
> 标签：windows, command-line, post-build-event

我想将几个已知文件复制到另一个目录作为构建后事件的一部分，但不希望在我的构建事件中出现“复制[文件] [目标] [开关]”的行和行。如果可能的话，我想列出我想使用类似格式复制的文件：“复制 [文件 1] [文件 2] [文件 3] [etc...] [destination] [switches]” . 但是，Windows 似乎不喜欢这种格式。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-28T20:13:41.227

您可以在批处理文件中或直接从命令提示符中使用“for”：

```
for %I in (file1.txt file2.txt file3.txt) do copy %I c:\somedir\ 
```

文件列表中也支持通配符：

```
for %I in (*.txt *.doc *.html) do copy %I c:\somedir\ 
```

欲了解更多信息，只需输入 /? 从命令提示符，或者为了更容易阅读的帮助，使用开始->帮助和支持并搜索“For”。在我的 XP Pro 框中，它是全文搜索结果中的第 15 项。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-05-28T20:26:35.583

XP 和 Vista用**robocopy替换了****xcopy**，它会做你想做的事。你想要的语法起初感觉是倒退的，但它确实有效：

 **```
robocopy source\folder a\dest\folder file1.exe file2.bat file3.dll file4.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T19:02:09.843

使用[`<Copy>`MSBuild 任务](http://msdn.microsoft.com/en-us/library/3e54c37h.aspx)。

# php - PHP / Zend 重写机制

> ID：922611
> 
> 赞同：0
> 
> 时间：2009-05-28T19:00:42.247
> 
> 标签：php, zend-framework, url-rewriting

嘿，这是一个新手 Zend 问题。在站点位置：“<strong>mydomain.org/subA/subB”下，如果我们在没有登录（或会话）的情况下转到此位置，它 i) 会重定向到登录页面。否则，它 ii) 重定向到比赛登记表。现在，我认为 Apache 重写规则做到了这一点，但是在我们的项目 .htaccess 文件中没有配置表明这一点：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ /index.php [NC,L] 
```

我知道可以进行这种重写的唯一机制是 i) Apache 的 mod_rewrite 或 ii) 通过 Zend 的控制器或路由器组件进行重写。还有什么我可能会丢失的吗？就像我说的那样，我是 PHP/Zend 新手，所以最好有一些东西可以跟踪该请求以查看它通过了哪些系统。

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-28T19:27:20.633

我会使用 Zend 的内置路由库：

[http://framework.zend.com/manual/en/zend.controller.router.html](http://framework.zend.com/manual/en/zend.controller.router.html)

Zend 的路由器允许您从应用程序中创建重写的路由，而无需编写自定义的 mod_rewrite 规则。您从 .htaccess 文件中粘贴的重写规则是 Zend 完成其工作所需要的。

编辑：我更仔细地阅读了你的问题。我想你明白 Zend 有路由。如果您正在寻找重定向工作的原因，请尝试检查控制器以获取需要进行身份验证的页面。如果`preDispatch()`在控制器中定义，它可能会检查会话身份验证并在丢失时重定向到不同的控制器。

# c# - 如何使用 C# 确定 XML 文档的属性计数

> ID：922612
> 
> 赞同：0
> 
> 时间：2009-05-28T19:00:45.383
> 
> 标签：c#, xml

我正在使用`XmlReader`和 xml 导航器，如下所示：

```
XmlDocument doc = new XmlDocument();
doc.Load(txtFileName.Text.Trim());
// Create the navigator.

XPathNavigator xnav = doc.CreateNavigator(); 
```

创建导航后，您可以选择后代或孩子，并且可以确定孩子的数量。但是，我有一个问题，即当我需要知道该节点的属性数量时，我无法知道，例如，如果您想知道使用以下代码的孩子的数量。

```
int size = xnav.SelectDescendants(XPathNodeType.All, true).Count; 
```

在这种情况下，此函数接受两个参数：您要选择的节点类型，如文本注释或元素，第二个参数设置为 true，如果您希望选择当前节点的子树的根，以及子树的一部分。

结果`select[*]`是 XPathIterator 对象。

当然，您通常不想要评论或空白的计数，因此您不使用 all 属性来检索所有节点，但您需要指定所需的节点类型，假设我们需要所有元素、属性和因此我们应该运行以下命令：

```
int size = xnav.SelectDescendants(XPathNodeType.Attribute | XPathNodeType.Element | XPathNodeType.Text , true).Count; 
```

我认为您还需要计算属性的值，因此您必须将属性计数的结果加倍，因为它不能像这样指定节点的类型，所以我做了以下操作：

```
int size = (xnav.SelectDescendants(XPathNodeType.Attribute, true).Count * 2) +
    xnav.SelectDescendants(XPathNodeType.Element, true).Count +
    xnav.SelectDescendants(XPathNodeType.Text , true).Count; 
```

目前我有以上所有的计数，除了我没有计数的属性。

嘻嘻嘻！！！请

ps 我不想循环访问元素，这样做的成本非常高。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:32:12.173

如果您真的担心性能，您应该使用 XmlReader 直接执行此操作，而不是执行所有这些 XPath 查询。它还有一个好处是您可以一次跟踪所有计数，而不是执行多个文档范围的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:32:37.053

您可以使用 xpath 找出有多少属性

```
XmlDocument doc = new XmlDocument();
doc.Load(txtFileName.Text.Trim());
XPathNavigator xnav = doc.CreateNavigator();
xnav.Evaluate("count(//@*)"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:55:58.597

我会从字符串手动完成

```
<img src="" style="" width=""/> 
```

只需数一下“=”符号就可以了

# .net - .NET 32 位和 64 位操作系统之间的二进制序列化

> ID：922615
> 
> 赞同：3
> 
> 时间：2009-05-28T19:01:30.483
> 
> 标签：.net, serialization, binary

我有一个使用二进制序列化将数据保存到硬盘的程序。如果我在 64 位机器上重新编译程序，它可以反序列化来自 32 位机器的数据吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T19:15:08.663

几乎所有 .NET 数据类型都在其字节数中定义（IntPtr 除外，它因目标体系结构而异）。因此，无论您的架构如何，序列化任何 .NET 对象都将创建该对象的相同大小的序列化。幸运的是，您不需要做任何特殊的工作。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T19:06:22.207

是的，唯一可能破坏的类型是[IntPtr](http://msdn.microsoft.com/en-us/library/system.intptr(VS.71).aspx)，但无论如何您都不应该序列化这种类型的字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T19:30:13.780

这是MSDN中的相关文章：

> [将 32 位托管代码迁移到 64 位：迁移和序列化](http://msdn.microsoft.com/en-us/library/ms973190.aspx#64mig_topic8)

# internet-explorer - 以编程方式将记住的用户名/密码添加到 IE？

> ID：922634
> 
> 赞同：1
> 
> 时间：2009-05-28T19:05:13.470
> 
> 标签：internet-explorer

如果我希望 IE 记住特定站点的用户名和密码组合（不是文本形式，而是经过[身份验证的登录](http://newwebmasters.net/wp-content/uploads/2008/11/authenticate.gif)），我如何以编程方式将其添加到 IE 存储的用户名和密码数据库中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T19:09:37.097

由于安全原因，我认为这是不可能的。如果可以添加到数据库，那么甚至可以读取，这很可怕；-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-29T09:17:06.353

如果您的程序在与 IE 相同的用户帐户中运行，那么您可以做任何 IE 可以做的事情，这是可能的。

[本文](http://www.nirsoft.net/articles/ie7_passwords.html)介绍了 IE 将所有不同类型的密码保存在何处 - 以及可以读取它们的实用程序的链接。

我已经编写了读取 IE 自动完成保存密码的代码（使用与您想要的完全不同的机制存储），这并不困难。

# c# - 用于 MP3 编辑的音频库

> ID：922644
> 
> 赞同：4
> 
> 时间：2009-05-28T19:07:59.567
> 
> 标签：c#, asp.net, audio, mp3

在我使用 ASP.NET + C# 的一个项目中，我希望能够动态创建 30 秒的 MP3 文件剪辑并添加淡入/淡出。

你会推荐什么图书馆？

我看到有很多，包括：

> [http://www.alvas.net/alvas.audio.aspx](http://www.alvas.net/alvas.audio.aspx)
> 
> [http://www.audiosoundeditor.com/](http://www.audiosoundeditor.com/)
> 
> [http://www.mitov.com/html/audiolab.html](http://www.mitov.com/html/audiolab.html)

你曾经不得不处理这个吗？哪个图书馆最适合您？

任何东西都会有所帮助，包括我可以从我的 C# 应用程序或任何类型的 C# 兼容库中调用的免费/定价软件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-20T11:49:05.207

我最终使用了[ffmpeg](http://ffmpeg.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-26T11:24:23.390

您可以尝试[NAudio](http://naudio.codeplex.com) - 执行此操作需要一些编程，但基本上它与使用 NAudio 首先解码 MP3 类似。然后通过波形文件在需要的时候淡入（调高音量）并在需要的时候淡出（调低音量）。如果您要以波形以外的格式将其传递给客户端，则需要重新编码此文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T20:15:33.547

你可以使用`winmm.dll`图书馆。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T04:37:05.540

有一个更好的选择，那就是 BASS 库。[http://un4seen.com/bass.html](http://un4seen.com/bass.html)它有一个专门的论坛，并执行 DSP，如淡入淡出/压缩/均衡器等。另外，您可以阅读一堆不同的音频格式。它有 C# 和 vb.net 支持。

# http - Response.Redirect 并不总是重定向

> ID：922648
> 
> 赞同：3
> 
> 时间：2009-05-28T19:08:18.737
> 
> 标签：http, iis, firefox, redirect, httpresponse

我们在工作不一致的页面上有一个简单的 Response.Redirect (IIS 6.0)。大多数情况下它会正确重定向，但我们收到一些用户抱怨说他们没有重定向，而是得到“302 对象移至此处”页面。该页面显示具有正确位置的标题信息。如果您单击“此处”，它将重定向到正确的页面。

任何想法为什么它会偶尔显示 302 消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T19:20:04.487

您可以尝试手动将响应的状态代码设置为 301。以下是一些可以帮助您的[借用代码](http://dotnetslackers.com/articles/aspnet/An-In-Depth-Look-at-HTTP-Redirection.aspx)：

```
Response.StatusCode = 301; 
Response.StatusDescription = "Moved Permanently";
Response.RedirectLocation = "RedirectionPage.aspx";
Response.Flush(); 
```

您还可以将 Server.Transfer() 用作最后的努力，或者输出一个简单的脚本，将窗口的位置设置为新的 url。

```
Page.ClientScript.RegisterStartupScript(Page.GetType
"RedirectScript", "window.location.href='RedirectionPage.aspx'", true); 
```

虽然我想知道如果他们的浏览器不尊重原始重定向，他们的浏览器将如何处理 javascript。

你有关于这些人使用的浏览器的任何信息吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T19:24:31.390

302 是 response.redirect 返回的代码。我还看到了一个做客户端的笔记

```
window.location = 'url' 
```

但听起来确实像浏览器设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-11T01:20:52.643

当缺少 Location 标头时，可能会发生这种情况。

# sql - 两个电子邮件地址表，返回一个不在另一个的地方

> ID：922650
> 
> 赞同：1
> 
> 时间：2009-05-28T19:09:03.103
> 
> 标签：sql, mysql

我有一个来自一个数据库的电子邮件列表，我想对照另一个数据库中的未订阅电子邮件列表进行检查。如果它们在两个列表中都存在，那么我不希望它们返回。

```
SELECT distinct `payer_email` as `email` 
FROM `database1`.`paypal_table`
WHERE `payer_email` != 
(SELECT `email` 
 FROM `database2`.`Unsubscribers` 
 WHERE `email` 
 LIKE `database1`.`paypal_table`.`payer_email`) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T19:12:40.023

我会使用：

不存在的地方（选择.....）

我开始了解到，在使用更大的数据集时，EXISTS 的性能比 IN 更好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T19:11:18.140

尝试：

```
`payer_email` NOT IN (SELECT `email` FROM `database2`.`Unsubscribers`) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T19:20:04.737

您可以使用 join 语句来做到这一点。基本上，您尝试在他们的电子邮件地址上连接这两个表，并查看连接未能找到匹配项的位置。

```
SELECT DISTINCT email FROM table1
       LEFT JOIN table2 ON table1.email == table2.email
       WHERE table2.email IS NULL 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T19:15:28.223

试试这个-

```
select distinct(email) from table 1 where email not in (select distinct(email) from table 2)
union
select distinct(email) from table 2 where email not in (select distinct(email) from table 1) 
```

干杯

# unix - unix 命令行 使用 . （点）与没有

> ID：922651
> 
> 赞同：21
> 
> 时间：2009-05-28T19:09:12.560
> 
> 标签：unix, shell

在 unix 命令行中，通过简单地输入程序的名称来执行程序与通过输入 . （点）后跟程序名称？例如：

```
runme 
```

对比

```
. runme 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-28T19:14:11.410

`. name`源文件调用`name`到当前 shell。所以如果一个文件包含这个

```
A=hello 
```

然后，如果您来源，之后您可以引用一个名为的变量，该变量`A`将包含*hello*。但是如果你执行文件（给定适当的执行权限和`#!/interpreter`行），那么这些事情就不会起作用，因为脚本设置的变量和其他东西只会影响*它*运行的子shell。

获取二进制文件没有任何意义：Shell 不知道如何解释二进制文件（请记住，它将该文件中出现的内容插入到当前 shell 中——就像`#include <file>`C 中的旧机制一样）。例子：

```
head -c 10 /dev/urandom > foo.sh; . foo.sh # don't do this at home!
bash: �ǻD$�/�: file or directory not found 
```

当然，执行二进制文件*确实*很有意义。所以通常你只想命名你想要执行的文件，在特殊情况下，比如`A=hello`上面的例子，你想获取一个文件。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-28T19:11:09.683

使用“ `source`”或“ `.`”会导致命令在当前进程中运行。将脚本作为可执行文件运行会为其提供自己的进程。

如果您尝试在当前 shell 中设置环境变量（您不能在单独的进程中执行此操作）或想要在不中止 shell 的情况下中止脚本（您*只能*在单独的进程中执行），这最重要。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-28T19:12:22.723

第一个执行命令。第二个是在另一个中包含一个 shell 脚本的简写。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-28T19:12:49.243

此语法用于“加载”和解析脚本。当您的脚本与一堆其他脚本具有共同功能时，它最有用，您可以“点包含”它。有关详细信息，请参阅[http://tldp.org/LDP/abs/html/internal.html](http://tldp.org/LDP/abs/html/internal.html)（向下滚动到“点”命令）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-28T19:15:25.760

运行“runme”将创建一个新进程，该进程将继续其快乐的小路，并且不会影响您的 shell。

运行“.runme”将允许脚本“runme”更改您的环境变量、更改目录以及您可能希望它为您做的各种其他事情。它只能这样做，因为它正在由已经为您运行的 shell 进程解释。因此，如果您将 bash 作为登录 shell 运行，则只能使用“.”。用 bash 脚本表示，而不是（例如）C shell 脚本上的二进制文件。

# xml - E4X：使用命名空间抓取节点？

> ID：922668
> 
> 赞同：4
> 
> 时间：2009-05-28T19:11:45.033
> 
> 标签：xml, apache-flex, actionscript-3, namespaces, e4x

我想学习如何在 E4X 中使用命名空间处理 XML，所以基本上这就是我想学习的内容，比如我有一些这样的 XML：

```
<rdf:RDF 
 xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
 xmlns="http://purl.org/rss/1.0/">
    <rdf:item value="5"/>
    <item value="10"/>
</rdf:RDF> 
```

我如何分配`<rdf:item/>`给一个名为**rdfItems**的变量和`<item/>`一个名为**regItems**的变量？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-29T16:28:08.373

如果您有一个包含多个名称的 XML，但在从 XML 获取值时不关心名称空间，您可以执行以下操作....

示例 XML

```
<ns1:Item>
  <ns1:ItemType>Printed Material</ns1:ItemType>
  <ns2:Book isbn="123456">
    <ns2:Author>
      <ns2:FirstName>James</ns2:FirstName>
      <ns2:LastName>Smith</ns2:LastName>
    </ns2:Author>
    <ns2:Title>The Book Title</ns2:Title>
  </ns2:Book>
<ns1:Item> 
```

无论命名空间如何，您都可以获得任何项目

```
var itemType:String = xml.*::ItemType;
var bookISBN:Number = xml.*::Book.@isbn;
var bookTitle:String = xml.*::Book.Title; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T20:41:57.317

我不确定这是否准确地回答了这个问题，但鉴于您的情况，以下代码会检索这两个值（假设下面引用的“xml”变量是一个包含您提供的 XML 代码片段的 XML 对象）：

```
// Your "rdf" namespace
namespace rdf = "http://www.w3.org/1999/02/22-rdf-syntax-ns#";
use namespace rdf;

// Your "reg" (i.e, default) namespace
namespace reg = "http://purl.org/rss/1.0/";
use namespace reg;

private function getYourValues():void
{               
    var rdfitems:String = xml.rdf::item.@value;
    var regitems:String = xml.reg::item.@value;
} 
```

需要区分“rdf”项和“non-rdf”项，因为它们的元素名称在其他方面相同，因此声明第二个命名空间允许您独立检索每个项。希望能帮助到你！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-22T14:55:02.677

如果您不知道必须处理的名称空间，可以使用多种方法。

```
node.namespace().prefix     //returns prefix i.e. rdf
node.namespace().uri        //returns uri of prefix i.e. http://www.w3.org/1999/02/22-rdf-syntax-ns#

node.inScopeNamespaces()   //returns all inscope namespace as an associative array like above

//returns all nodes in an xml doc that use the namespace
var nsElement:Namespace = new Namespace(node.namespace().prefix, 
node.namespace().uri);

var usageCount:XMLList = node..nsElement::*; 
```

你最好的选择就是玩弄它。但我确实喜欢过滤 xml 的前置逻辑语句使其更易于使用。

希望这能给你一些动态处理命名空间的想法

问候，

乔恩

# xna - XNA 碰撞检测

> ID：922677
> 
> 赞同：0
> 
> 时间：2009-05-28T19:13:49.740
> 
> 标签：xna, collision-detection, collision

我有一个球在一个立方体内移动，我检测到它何时离开立方体（带有一个边界球和一个边界框）。现在我想检测球从哪一侧出去。然后我可以将球重定向到正确的方向。我怎样才能用球的“世界”矩阵做到这一点？

我应该自己跟踪球的坐标，还是应该从世界矩阵中推断出它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T19:24:48.003

我会从碰撞重新开始。你有六个平面（每个平面是一个 [point,normal unit vector] 对）和一个球体（一个 [point,radius] 对）。

检查每个平面的点。为此，请从该点减去平面的单位矢量，按球体半径按比例放大。（点 -= PlaneUnitVector * 半径）

现在，通过一些矢量数学，您可以看到它在平面的哪一侧。

然后，您将使用平面的单位矢量进行反弹计算。

您将遇到的下一个问题是您一次穿越多个飞机的情况。

# c# - IronPython，单击一次，.NET 2.0 错误 - 想法？

> ID：922681
> 
> 赞同：2
> 
> 时间：2009-05-28T19:14:44.623
> 
> 标签：c#, .net, scripting, ironpython

我正在尝试推出一个测试应用程序来测试纠正 Click Once Smart Client 应用程序的可行性，该应用程序还使用通过嵌入 IronPython 可定制的规则引擎。

到目前为止，除了我之外的所有用户在调用脚本引擎时都会收到此错误（如下）。

我需要做一些特别的事情来强制部署 IronPython 和脚本程序集吗？我认为这将是自动的，因为它们在我的项目中被引用。这在 .NET 2.0 中是不可行的吗？

想法？

```
************** 异常文本 **************
System.MissingMethodException：找不到方法：'Void System.Reflection.Emit.DynamicMethod..ctor(System.String, System.Type, System.Type[], Boolean)'。
   在 Microsoft.Scripting.Utils.Helpers.CreateDynamicMethod（字符串名称，类型 returnType，类型 [] 参数类型）
   在 Microsoft.Linq.Expressions.Compiler.Snippets.CreateDynamicMethod（字符串名称，类型 returnType，类型 [] 参数类型）
   在 Microsoft.Linq.Expressions.Compiler.LambdaCompiler.CreateDynamicLambdaCompiler（CompilerScope 范围，字符串方法名称，类型 returnType，IList`1 paramTypes，IList`1 paramNames，布尔闭包，布尔 emitDebugSymbols，布尔 forceDynamic）
   在 Microsoft.Linq.Expressions.Compiler.LambdaCompiler.CompileLambda（LambdaExpression lambda，类型 delegateType，布尔型 emitDebugSymbols，布尔型 forceDynamic，MethodInfo& 方法）
   在 Microsoft.Linq.Expressions.Compiler.LambdaCompiler.CompileLambda[T](LambdaExpression lambda, Boolean emitDebugSymbols)
   在 Microsoft.Linq.Expressions.LambdaExpression.Compile[T](Boolean emitDebugSymbols)
   在 Microsoft.Scripting.Runtime.OptimizedScriptCode.InvokeTarget（LambdaExpression 代码，Scope 范围）
   在 Microsoft.Scripting.SourceUnit.Execute（范围范围，ErrorSink errorSink）
   在 Microsoft.Scripting.Hosting.ScriptSource.Execute（ScriptScope 范围）
   在 UAP.UI.Form1.button1_Click（对象发送者，EventArgs e）
   在 System.Windows.Forms.Control.OnClick(EventArgs e)
   在 System.Windows.Forms.Button.OnClick(EventArgs e)
   在 System.Windows.Forms.Button.OnMouseUp（MouseEventArgs 事件）
   在 System.Windows.Forms.Control.WmMouseUp（消息和 m，MouseButtons 按钮，Int32 点击）
   在 System.Windows.Forms.Control.WndProc（消息和 m）
   在 System.Windows.Forms.ButtonBase.WndProc（消息和 m）
   在 System.Windows.Forms.Button.WndProc（消息和 m）
   在 System.Windows.Forms.Control.ControlNativeWindow.OnMessage（消息& m）
   在 System.Windows.Forms.Control.ControlNativeWindow.WndProc（消息和 m）
   在 System.Windows.Forms.NativeWindow.Callback（IntPtr hWnd，Int32 msg，IntPtr wparam，IntPtr lparam）

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T21:52:22.790

IronPython 需要 .NET 2.0SP1 或更高版本才能运行。此异常是由于 SP1 中添加的过载而发生的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T19:19:06.220

如果您右键单击您的项目并转到`Properties`一个`Publish`选项卡，它允许您为您的应用程序指定先决条件安装。

大概您可以在此处提供 IronPython 安装可执行文件的路径。

# bytecode - 每次到达该行时，是否会重新解释解释语言的代码？

> ID：922692
> 
> 赞同：2
> 
> 时间：2009-05-28T19:16:13.183
> 
> 标签：bytecode, interpreted-language

假设没有为程序生成字节码，例如在 Ruby、Perl 或 PHP 中，在这种情况下，每次执行再次到达第 1 行时，是否会重新解释下面的第 1 行？

```
while ($indexArrayMoviesData < $countArrayMoviesData + $countNewlyAddedMoviesData) {
  # do something
} 
```

也就是说，如果循环运行 100,000 次，那么该行将被重新解释 100,000 次？

如果是这样，字节码的创建不仅有助于程序的初始启动，而且在执行期间也有帮助？（因为代码不需要再次重新解释）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T19:20:38.447

通常，它将被转换为字节码，然后执行该字节码。

但是以 PHP 为例，字节码会在每个请求/页面视图上重新生成。除非您安装字节码（或在 PHP 中经常调用的操作码）缓存，例如 XCache、APC 或 EAccelerator。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T19:22:24.420

对于最近的语言，包括 perl，代码在执行之前会被预编译。所以大部分分析工作只执行一次。

对于 shell 而言，情况并非如此，它们每次执行时都会解释每一行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T19:17:28.033

正如所有顾问所知，您的问题的答案是“视情况而定”。

您是对的，在某些解释语言中，该行可能每次都被重新解释。我怀疑大多数贝壳都是这样处理的。

Basic 的原始版本也是这样做的。

大多数当前的解释器*至少*会标记语言，这样就不需要每次都重新扫描文本。也就是说，一个基本的程序，如

```
 00010 LET A=42
 00020 DO WHILE A > 0
 00025    LET A = A - 1
 00030 ENDDO 
```

至少会将其转换为关键字的小标记和变量的地址，例如

```
 LET    $0003, 42
 LABEL  00020 
 LETEST A, 0
 IFTRUEGOTO   00030
 SUB    $0005, $0003, 1
 GOTO   00020
 LABEL  00030 
```

其中翻译中的每个大写单词在内部都是一个整数。这样，有一个单一的词法分析传递来翻译它，然后解释器能够只解释标记值。

当然，一旦你走到那一步，你就会发现自己在想“哎呀，为什么不使用真正的操作码呢？”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T19:22:24.420

如果解释器是明智的，它希望检查 $countArrayMoviesData 或 $countNewlyAddedMoviesData 在循环期间是否被更改，如果不是，则可以计算并保留总和。

如果值在循环内更新，那么很可能即使是字节码也需要进行加法操作，而不是提高效率。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-28T19:23:41.047

很少有口译员会这样做。一个例子是用于 Hypercard 的古老的、不再使用的 Hypertalk 解释器，您实际上可以在其中以编程方式重写代码的文本（它只是一个字符串！）

即使是不产生字节码的解释器也会首先解析你的代码，因为很难逐行解析，而一次性完成则要容易得多。因此，一个非常简单的解释器基本上会有一棵树，其中一个节点用于“where”循环和两个子节点：一个“小于”表达式用于条件，一个块用于循环体。

# iphone - 从 xcode 中删除配置文件

> ID：922695
> 
> 赞同：50
> 
> 时间：2009-05-28T19:16:37.643
> 
> 标签：iphone

如何从 xcode 中删除以前安装的开发配置文件？

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2009-05-28T19:58:57.420

它们存储在：`~/Library/MobileDevice/Provisioning Profiles`

您需要重新启动 XCode 以刷新列表。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-04-11T09:31:52.587

Xcode 将配置文件保存在以下目录中：

```
~/Library/MobileDevice/Provisioning\ Profiles 
```

要从 Xcode 中删除旧配置文件，只需删除它的文件并重新启动 Xcode。Profile 文件名有些神秘，所以使用下面的命令来显示他们的真实姓名：

```
grep -a -A1 "<key>Name</key>" *.mobileprovision | grep -v "<key>Name</key>" | grep -v "^--" 
```

如果您需要的不仅仅是名称，例如 UDID 列表，此命令将显示特定配置文件的所有内容：

```
security cms -D -i xxx.mobileprovision 
```

更新：最近 Apple 添加了`*.mobileprovision`使用标准 Finder 应用程序预览文件的功能。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-07-15T05:15:20.880

我在 Xcode 5 中删除配置文件时遇到了麻烦。

另一种方法是使用[iPhone 配置实用程序](http://support.apple.com/downloads/#iphone%20configuration%20utility)，它会显示系统上安装的配置文件并允许您删除它们（选择并按删除键）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-03-05T22:45:23.940

我还没有找到一种方法来单独删除配置文件（Xcode 5）。

我可以让它们消失的唯一方法是**删除**与配置文件相关的 App ID。（在会员中心的证书、标识符和配置文件中）

显然，这对您来说可能不是最佳选择 - 但如果您一直在使用测试应用程序 ID，那么这是可行的方法。

* * *

我尝试删除配置文件失败的方式：

（它们在 xcode/preferences/accounts/details 中刷新后重新出现）

1.  苹果开发者网站
2.  使用 iPhone 配置实用程序
3.  直接在它们所在的文件夹中（~/Library/MobileDevice/Provisioning Profiles）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-05-03T04:49:22.650

我认为您必须打开 keychain.app 然后转到证书并在那里删除它们。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-28T19:48:12.650

听起来您想将其从 iPhone 中删除。我现在不在我的 Mac 前，但我相信在 XCode 中有一个管理器（在视图菜单选项下查看，确保你的 iPhone 已插入）你可以打开你可以访问你的配置文件的地方删除或更换它。我会检查何时回家并更新此答案。

此外，如果您只需要删除单个项目的配置文件，您可以通过导航到项目的构建文件夹并从那里删除它来执行此操作。

如果您需要删除您的签名密钥，您可以通过您的钥匙串管理工具来完成。

编辑：在 XCode 中转到 Window->Organizer 这将打开管理器。从那里您可以执行您需要执行的操作来删除配置文件。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-07-09T14:05:49.997

使用 XCode 5，配置文件现在位于 Xcode -> Preferences -> Accounts 中。要删除新下载的配置文件的副本，您只需在此页面上选择您的帐户，然后单击配置文件列表左下方的刷新按钮。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-11-22T07:05:54.887

来自 Xcode 5 及更高版本

我们无法从管理器选项卡中找到安装在 xcode 中的证书。

去

第1步

在 xcode 构建设置中，选择您要删除的配置文件

第2步

在“配置文件下”下的构建设置中选择配置文件，然后单击其他。它将显示一个 33 位十六进制数字。收到。

第 3 步

转到 ~/Library/MobileDevice/Provisioning Profiles

并在配置文件中搜索该复制的号码作为名称。

删除它。:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-04-30T06:49:25.627

转到iphone配置实用程序->选择配置文件->单击退格键（适用于xcode 6）

# reporting-services - 如何获得矩阵中一行的平均值

> ID：922696
> 
> 赞同：0
> 
> 时间：2009-05-28T19:16:51.047
> 
> 标签：reporting-services, reportingservices-2005

现在有一个矩阵报告，其中包含一个位置一个月的职位、小时数和工资。
可能有任意数量的位置...这就是为什么我从 Matrix 报告开始...用户最多可以选择 50 个位置进行查看。

```

                   位置 1 位置 2
               总小时数 总小时数
    位置 1 441.68 $4,201.46 556.73 $6,103.67

```

我们想得到那个月的平均位置，就像这样

```
                   位置 1 位置 2 平均
               总小时数 总小时数 平均小时数
    位置 1 441.68 $4,201.46 556.73 $6,103.67 499.20

```

不能完全弄清楚如何让它在 SSRS 2005 中工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T19:23:42.403

您可以使用公式 (rs!localtion1Hrs + rs!location2hrs) / 2 计算字段。

或者

用于显示报告的查询可以将此字段作为计算列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T17:59:01.437

很确定我已经通过使用以下作为报表的数据集并在报表布局中使用矩阵来解决这个问题。

基本上我做了上面shahkalpesh所说的......“用于显示报告的查询可以将此字段作为计算列。”

```
select 
        'Avg' as LocationID, 
        'Avg' as Description, 
        AccountDesc, 
        @PayrollYear as Year,
        @PayrollMonth as Month,
        avg(s.TotalHrs) as TotalHrs, 
        avg(s.Amount) as Amount from 
(
    select LocationID, 'Avg' as Description, AccountDesc, 
    @PayrollYear as Year, @PayrollMonth as Month,       
    sum(TotalHrs) as TotalHrs,
    sum(Amount) as Amount from vwPayroll
    where LocationID in (select value from dbo.ParmsToList(@PayrollLocIds)) 
    and Year = @PayrollYear and Month = @PayrollMonth
    group by LocationID, AccountDesc, Year, Month
) as s
group by AccountDesc

union all

select 
        LocationID, 
        Description, 
        AccountDesc, 
        Year, 
        Month, 
        Sum(TotalHrs) as TotalHrs, 
        Sum(Amount) as Amount 
from vwPayroll
where LocationID in (select value from dbo.ParmsToList(@PayrollLocIds)) 
and Year = @PayrollYear and Month = @PayrollMonth
group by LocationID, Description, AccountDesc, Year, Month 
```

# sql-server - 写冲突 - 即使是我。脏

> ID：922697
> 
> 赞同：1
> 
> 时间：2009-05-28T19:17:22.167
> 
> 标签：sql-server, ms-access, vba, null, default-value

在我正在编写的应用程序中，当我使用 VBA 代码更改表单上复选框的值时，我遇到了写入冲突。我尝试将以下代码插入到让 VBA 更改表单上任何对象的值的事件中：

```
If Me.Dirty Then
    Me.Dirty = False
End If 
```

但是问题仍然存在 - 好像在我通过手动操作更改任何内容之前没有保存记录。

以下是我遇到此问题的表单中完整代码的一些示例：

*更改空白定价复选框时的代码：*

```
Private Sub chkSupAllowBlankPrice_AfterUpdate()

    If Me.Dirty Then
        Me.Dirty = False
    End If

    If (chkSupAllowBlankPrice.Value = True) Then
        chkSupRequirePrice.Value = False
    End If
End Sub 
```

*更改“要求定价”复选框时的代码：*

```
Private Sub chkSupRequirePrice_AfterUpdate()
    If Me.Dirty Then
        Me.Dirty = False
    End If

    If (chkSupRequirePrice.Value = True) Then
        chkSupAllowBlankPrice.Value = False
        chkSupAllowBlankPrice.Visible = False
        chkSupAllowBlankPrice.Enabled = False
        chkSupAllowBlankPrice.Locked = True
        lblSupAllowBlankPrice.Visible = False
    Else
        chkSupAllowBlankPrice.Visible = True
        chkSupAllowBlankPrice.Enabled = True
        chkSupAllowBlankPrice.Locked = False
        lblSupAllowBlankPrice.Visible = True
    End If
End Sub 
```

不确定它是否有帮助，但这些表存储在 SQL Server express 数据库中 - 因此是标签。

-- 编辑于 2009 年 5 月 29 日 @ 1201 小时 --

我尝试注释掉所有对象值更改，只留下可见、锁定和启用的更改 - 但我不断收到写入冲突。我尝试将 Me.Dirty = False 放在事件过程的末尾，甚至尝试将其删除。到目前为止，每当我更改“要求定价”或“允许空白定价”时，我都会遇到写入冲突，而 VBA 代码不会更改其他值。

-- 编辑于 2009 年 5 月 29 日 @ 1318 小时 --

一旦创建记录，这些复选框操作的字段将不接受任何更改，每当我尝试使用它们时都会产生写入冲突。现在我完全糊涂了，想把所有东西都毁掉，然后重新开始。

-- 编辑于 06/01/2009 @ 1209 小时 --

经过调查，似乎在服务器上为所涉及的表定义了许多我无法删除的检查约束。即使项目没有更改，某些东西也会导致链接表总是报告脏表——我认为 Access 和 SQL 正在使用默认值来解决这个问题。我将擦除所有表，删除所有信息，然后重新开始我的设计，因为检查约束似乎不能在不删除表的情况下删除。谢谢大家的帮助，这个问题可以关闭吗 - 将问题提交给这个新问题（[不允许更新记录 - 写入冲突](https://stackoverflow.com/questions/936735/updates-to-records-not-allowed-write-conflict)）？

-- 编辑于 06/03/2009 @ 1307 小时 --

从其他问题交叉发布，下面描述的所有好奇的解决方案。感谢所有与我一起努力走到这一步的人，我真的很感谢你的帮助。我发现在使用 Yes/No 复选框和 SQL Server with Access 时会出现一个奇怪的问题。显然，Access 会将 NULL 解释为否 - 更改值，但 SQL Server 不会将 NULL 解释为位字段中的否（是/否在转换中变成了），因此当值不是时它会引发写入冲突错误必需，并且为 NULL。解决方案是重新设计表格，以便需要一个值，并且为之前的每个“是/否”复选框分配了一个默认值。这解决了神秘的写入冲突消息，并允许在创建记录后对其进行更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T07:40:39.347

几点评论：

*   `Dirty=false`在更改其他字段的值（这会使表单再次变脏）之前保存表单的数据（set）是否有任何特殊原因？
    我会先更改其他字段的数据，*然后*保存表单的数据，否则表单*总是很脏*。

*   从代码更改控件的值不会调用它们的事件，因此更改`chkSupRequirePrice`的值`chkSupAllowBlankPrice_AfterUpdate()`不会调用`chkSupRequirePrice_AfterUpdate()`.

*   与其将特定代码放入每个事件中，不如将所有内容重新组合到同一个，例如，`Update()`从每个事件处理程序调用的 sub 中。
    它将使您更容易管理代码及其副作用，因为它是一直被调用的同一段代码。

*   话虽如此，你的代码*应该可以工作*，所以我猜这个问题来自你代码中的其他地方。
    如果同一记录已在其他地方打开以进行编辑，则会发生写入冲突。
    您可以尝试使用锁定类型，看看它是否会改变任何东西。

*   要查看问题是否真的与您的 SQL Server 设置有关，请尝试取消链接表并将其复制到本地 Access 数据库中，以查看在处理本地 Access 表时是否仍然遇到此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T19:43:47.420

过去，如果 SQL Server 链接表没有主键，我会在 Access 中遇到一些奇怪的问题。如果您的表没有主键，则它不知道要更新哪条记录。我知道我曾经收到过类似的信息，但那是几年前的事了，所以我不知道这是否是你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-29T19:09:54.883

Access 处理“是/否”复选框值的方式与 SQL Server 之间存在差异。在将是/否布尔值从 Access 转换为 SQL Server 时，您必须记住定义默认状态并将其标记为需要回答。否则，您每次都会遇到写冲突，并且一旦设置了初始值，它将阻止记录与您的更改一起保存。

# sql - 如何在 SQL Server 2008 中创建宽表？它的使用限制是什么？

> ID：922707
> 
> 赞同：12
> 
> 时间：2009-05-28T19:20:04.847
> 
> 标签：sql, tsql, sql-server-2008, ddl

我正在阅读[SQL Server 的最大容量规范，](http://msdn.microsoft.com/en-us/library/ms143432.aspx)并且遇到了宽表的指定。它与标准表的不同之处在于它可以有多达 30,000 列，而普通（窄）表仅限于更熟悉的 1024 列。我用谷歌搜索了宽表，但似乎没有什么相关的。这个新表类型有更正式的名称吗？？？

那么为什么我们有两种不同类型的表，你如何创建这个特殊的表以及使用这个看似可以容纳更多数据的表有什么限制？有人知道吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T19:38:02.907

宽表是使用列集和稀疏列的表。它仍然遵循每行相同的宽度限制（8019 字节） - 所以您通常只在您的列大多为空时才使用它。

有关...的更多信息，请参见此处

*   [SQL 2008 中的特殊表类型](http://msdn.microsoft.com/en-us/library/ms186986.aspx)
*   [列集](http://msdn.microsoft.com/en-us/library/cc280521.aspx)
*   [稀疏列](http://msdn.microsoft.com/en-us/library/cc280604.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T19:37:25.590

“要将表创建或更改为宽表，请在表定义中添加[列集](http://msdn.microsoft.com/en-us/library/cc280521.aspx)。”

从[这里](http://msdn.microsoft.com/en-us/library/ms186986.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T19:49:45.503

但是，您通常不想这样做！行有大小限制，检索数据可能比使用相关表（即使是具有一对一关系的表）更慢。我从未见过这样的例子比相关表更好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-23T16:11:36.983

另一个限制是宽表不适用于事务或合并复制。请参阅此处的“支持稀疏列的 SQL Server 技术”部分：http: [//msdn.microsoft.com/en-us/library/cc280604 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/cc280604(v=sql.105).aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-16T17:27:20.437

```
CREATE TABLE [UR_DB].[dbo].[DesiredTableName]
(DocID int PRIMARY KEY,
Title varchar(200) NOT NULL,
ProductionSpecification varchar(20) SPARSE NULL,
ProductionLocation smallint SPARSE NULL,
MarketingSurveyGroup varchar(20) SPARSE NULL,
MarketingProgramID int SPARSE NULL,
SpecialPurposeColumns XML COLUMN_SET FOR ALL_SPARSE_COLUMNS); 
```

[创建复杂的测试数据库 - 创建超过 1,024 列的表](http://blogs.msdn.com/b/samlester/archive/2012/08/08/creating-complex-test-databases-creating-a-table-with-more-than-1-024-columns.aspx)

# c# - .NET SplitContainer 使用 C# Windows 窗体

> ID：922708
> 
> 赞同：7
> 
> 时间：2009-05-28T19:20:12.707
> 
> 标签：c#, winforms, user-interface

我在两个窗格之间添加了一个带有水平条的 SplitContainer。我可以添加内容，并上下移动栏来调整容器的大小，但栏本身是不可见的。我希望我的应用程序的用户能够看到这两个区域之间的明显差异。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-28T19:25:48.233

将 SplitContainer 的 BorderStyle 设置为 FixedSingle 或 Fixed3D。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T19:40:22.027

根据您想要的外观，您还可以尝试将具有不同边界的对象添加到 2 个内容面板，以使拆分器脱颖而出。这就是 Outlook 2003/2007 处理拆分条的方式。

# tinymce - 定期调用 TinyMCE 的 triggerSave 函数

> ID：922709
> 
> 赞同：1
> 
> 时间：2009-05-28T19:20:25.843
> 
> 标签：tinymce

如果有人很了解 TinyMCE，你知道它是否内置支持定期调用它的 triggerSave 函数？

（此函数将其内容复制到其“父”文本区域。我想观察所述文本区域的变化，以便实现自动保存。）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-09T18:01:45.987

不要尝试自动保存，相信我这个。triggerSave 是错误的，当它失败时它会默默地失败，所以您认为您的内容已发布，但实际上并没有。一旦失败，它将不再在会话的其余部分工作，直到手动重新加载页面并且 tinymce 执行另一个完整的 init()。

刚刚被这个咬得很厉害，又一次。永远不要再相信 triggerSave。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T19:24:35.273

您可以使用 JavaScript 的 setTimeout() 函数轻松地自己完成此操作。

请参阅[http://www.w3schools.com/js/js_timing.asp](http://www.w3schools.com/js/js_timing.asp)。

# ruby-on-rails - Rails collection_select 搜索问题

> ID：922714
> 
> 赞同：0
> 
> 时间：2009-05-28T19:21:29.367
> 
> 标签：ruby-on-rails, syntax

我正在尝试在属性数据库的选择框中显示我的数据库中列出的唯一县。我已经想出了如何做到这一点，但现在我不知道如何访问选择的选定值。这主要与 HTML 选择名称的输出方式有关。

我的表单代码，county 是我的属性模型的属性：

```
 <%= collection_select(:property, :county, @Counties, :county, :county, {:prompt => true}) %> 
```

这将输出 HTML

```
<select id="property_county" name="property[county]"><option value="">Please select</option>
<option value="Pearl River">Pearl River</option>
<option value="Marion">Marion</option>
<option value="Stone">Stone</option>
<option value="Lamar">Lamar</option>
<option value="Forrest">Forrest</option>
<option value="Jones">Jones</option>
<option value="Washington">Washington</option></select> 
```

选择名称“property[county]”中的 [] 让我很适合。搜索表单中的其他项目使用 select_tag，因此输出只是“min_price”而不是“property[min_price]”。这是当我尝试将搜索结果数组放在我的属性模型中时导致语法错误：

```
def self.find_by_lcc(params)
where = []
unless params[:mls].blank?
where << "mls = :mls" 
end
unless params[:county].blank?
where << "county = :county"
end 
unless params[:min_acreage].blank?
where << "acreage >= :min_acreage" 
end
unless params[:max_acreage].blank?
where << "acreage <= :max_acreage" 
end
unless params[:min_price].blank?
where << "price >= :min_price" 
end
unless params[:max_price].blank?
where << "price <= :max_price" 
end

if where.empty?
[]
else
find(:all,
:conditions => [where.join(" AND "), params],
:order => "city, price desc")
end 
```

由于县问题，所有记录都被列出，而不仅仅是该县内的财产。我得到的浏览器 URL 字符串是：

```
public/land?mls=&property[county]=Stone&min_acreage=0&max_acreage=16000000&min_price=0&max_price=1600000&commit=Search 
```

我已经为此搜索了几天的答案，我确信这是我在编译搜索数组时需要使用的一种简单语法方法。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T23:02:36.033

我想你正在寻找

```
params[:property][:county] 
```

每当您看到类似 的名称`xxx[yyy]`时，Rails 会自动在 params 对象中为您构建散列，首先使用键 xxx 访问，然后使用键 yyy。

# c# - 全局配置设置的 C# 线程安全

> ID：922715
> 
> 赞同：6
> 
> 时间：2009-05-28T19:21:41.457
> 
> 标签：c#, multithreading, configuration

在 C# 应用程序中，假设我有一个包含一些配置项的全局类，如下所示：

```
public class Options  
{  
    int myConfigInt;  
    string myConfigString;  
    ..etc.  
}  

static Options GlobalOptions; 
```

此类的成员将在不同的线程中使用：

```
Thread1: GlobalOptions.myConfigString = blah; 
```

尽管

```
Thread2: string thingie = GlobalOptions.myConfigString; 
```

当 2 个线程访问不同的成员时，使用锁访问 GlobalOptions 对象也将不必要地阻塞，但另一方面，为每个成员创建一个同步对象似乎也有点过头了。

此外，我认为对全局选项使用锁定会使我的代码不那么好；如果我必须写

```
string stringiwanttouse;
lock(GlobalOptions)
{
   stringiwanttouse = GlobalOptions.myConfigString;
} 
```

无处不在（这是线程安全的还是 stringiwanttouse 现在只是指向 myConfigString 的指针？是的，我是 C# 的新手......）而不是

```
string stringiwanttouse = GlobalOptions.myConfigString; 
```

它使代码看起来很糟糕。

那么......确保线程安全的最佳（也是最简单！）方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T19:38:21.393

您可以将有问题的字段（在本例中为 myConfigString）包装在属性中，并在使用 Monitor.Lock 或 Mutex 的 Get/Set 中有代码。然后，访问该属性只会锁定该单个字段，而不会锁定整个类。

编辑：添加代码

```
private static object obj = new object(); // only used for locking
public static string MyConfigString {
    get {
       lock(obj)
       {
          return myConfigstring;
       }
    }
    set {
       lock(obj)
       {
          myConfigstring = value;
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T19:43:20.260

以下是在 OP 编辑​​之前编写的：

```
public static class Options
{
    private static int _myConfigInt;
    private static string _myConfigString;

    private static bool _initialized = false;
    private static object _locker = new object();

    private static void InitializeIfNeeded()
    {
        if (!_initialized) {
            lock (_locker) {
                if (!_initialized) {
                    ReadConfiguration();
                    _initalized = true;
                }
            }
        }
    }

    private static void ReadConfiguration() { // ... }

    public static int MyConfigInt {
        get {
            InitializeIfNeeded();
            return _myConfigInt;
        }
    }

    public static string MyConfigString {
        get {
            InitializeIfNeeded();
            return _myConfigstring;
        }
    }
    //..etc. 
} 
```

* * *

在那次编辑之后，我可以说你应该做类似上面的事情，并且只在一个地方设置配置 - 配置类。这样，它将是唯一在运行时修改配置的类，并且仅在要检索配置选项时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:40:09.377

您的配置可能是“全局的”，但它们不应*作为*全局变量公开。如果配置没有改变，它们应该用于构建需要信息的对象——手动或通过工厂对象。如果它们*可以*更改，则应使用监视配置文件/数据库/任何内容并实现[观察者模式的对象。](http://en.wikipedia.org/wiki/Observer_pattern)

**全局变量（即使是那些恰好是类实例的变量）是一个坏事™**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T19:56:03.103

这里的线程安全是什么意思？需要线程安全的不是全局对象，而是访问代码。如果两个线程在同一时刻附近写入一个成员变量，其中一个将“获胜”，但这是个问题吗？如果您的客户端代码依赖于全局值保持不变，直到使用某个处理单元完成，那么您将需要为每个需要锁定的属性创建一个同步对象。没有什么好办法。您可以只缓存该值的本地副本以避免出现问题，但该修复的适用性将取决于您的情况。此外，默认情况下，我不会为每个属性创建一个同步对象，而是当您意识到您将需要它时。

# asp.net - 如何组织 ASP.NET app_code 文件夹？

> ID：922719
> 
> 赞同：5
> 
> 时间：2009-05-28T19:22:45.790
> 
> 标签：asp.net

在 ASP.NET 中，我的 app_code 文件夹中有大量的 .cs 文件。如果我可以按它们在我的项目中所属的模块来组织它们，那就太好了，这样当我展开 app_code 文件夹时，我就不会永远滚动。你如何组织你的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T19:30:03.220

使用文件夹...

或者将您的所有类移到您网站的类库中并引用该库。

然后在那里正确地文件夹和命名所有你的类。

过去，我不得不使用 App_Code 文件夹，我已经为任何特定内容镜像了主站点的文件夹结构，并为其他所有内容提供了一个通用文件夹

例如

```
Site
|- App_Code
    |- Login
    |- Common
    |- Controls
    |- AdminArea
    |- SomethingElse
|- Login
|- Controls
|- AdminArea
|- SomethingElse
\- Default.aspx 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T19:31:12.547

如果可能，我建议您将 .cs 文件放在不同的项目中，然后只导入 .dll 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T19:25:48.843

我们尝试将内容保存在 App_Code 中的相关文件夹中。例如，我们有一个名为 DataLinx 的功能/产品，因此 App_Code 下有一个 DataLinx 文件夹，其中包含所有相关文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T06:32:28.123

可能有两个选项可以为不同的层和功能创建项目。或者在 app_code 文件夹中为不同的功能创建一个文件夹。

假设您使用的是第一个，那么您需要为每一层创建每个类库项目。像数据库层、业务逻辑层、公共控件等。创建一个解决方案并添加所有项目。根据您的需要引用项目 dll。

对于其他方法，您只需将 .cs 文件按逻辑分组到不同的文件夹中。

# bdd - 如何在 BDD 中编写故事/场景（行为驱动设计）

> ID：922720
> 
> 赞同：22
> 
> 时间：2009-05-28T19:22:46.493
> 
> 标签：bdd, scenarios, user-stories

我即将第一次使用 BDD（行为驱动设计），并试图习惯这种不同的解决问题的方式。

您能否提供一些您会为使用 BDD 的简单登录应用程序编写的故事/场景？

例如，从我读过的内容来看，这似乎很好：

> 当用户输入无效的用户名/密码时，会显示错误消息。

相对于：

> 通过在数据库中搜索匹配记录来验证 ID 和密码。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-31T17:51:14.917

Dan North 在写故事方面有一些很好的建议。[“丹·诺斯——故事里有什么？”](http://dannorth.net/whats-in-a-story)

我还会看看围绕[Cucumber](http://cukes.info)所做的一些工作，因为他们花了很多时间思考如何以可理解和可执行的方式编写这些故事。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-01T06:43:20.020

_Kevin 提到的 Dan North 的文章很棒。

但请记住，有一些“用户故事”实际上应该由客户/用户编写或至少收集。这些更多的是“作为一个，我想要，所以”类型的故事。

然后是验收标准，确定用户故事如何以及何时被满足。这就像您在帖子中所写的那样：“当 x 时，它应该是 y。”

这里与我在项目管理系统中所谓的“系统故事”和测试中的“规范”有很多重叠之处，这些规范指定了用户可能不知道的行为，但描述了类之间的交互。系统故事：“当 LoginHandler 获得登录名和密码时，它应该使用 LoginValidator 验证数据。” 规格：

```
[TestFixture]
public class When_the_login_handler_is_given_a_login_and_password
{
   constant string login = "jdoe";
   constant string password = "password";
   static LoginValidator loginValidator;

   context c = () => loginValidator = an<ILoginValidator>;

   because b = () => sut.Validate(login, password);

   it should_validate_the_data_with_a_LoginValidator =
      () => loginValidator.was_told_to(x => x.DoValidation(login, password));
} 
```

不用管测试语法，你可以看到规范文本本身就体现在测试类名和方法名中。此外，测试/规范实际上是在测试类的行为。当像这样的测试通过简单的用户故事时，就满足了验收标准。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-22T01:16:22.353

我在这里找到了一个很棒的演讲[https://skillsmatter.com/skillscasts/2446-bdd-as-its-meant-to-be-done](https://skillsmatter.com/skillscasts/2446-bdd-as-its-meant-to-be-done) （注意，您需要创建一个帐户才能观看视频）

# design-patterns - Web 应用程序真的可以面向对象吗？

> ID：922722
> 
> 赞同：0
> 
> 时间：2009-05-28T19:23:25.010
> 
> 标签：design-patterns, web-applications, oop

似乎在我努力维护 OO 原则的同时，这一切都显得如此做作或不自然。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T19:27:16.453

我的建议是不要对 OO 原则过于教条。它们运行良好，但有时当人们说他们正在努力维护 OO 原则时，这可能意味着他们正在为所有事物创建一个类，即使它并不真正合适。当你习惯它们时，事情也会变得不那么不自然，例如“x = 3”对于作业来说是自然的，即使有数学背景的人会认为它不自然。

您还可以尝试查看现有的 OO Web 应用程序和设计模式。一种常见的 OO 设计模式是 MVC 模式，Ruby on Rails 和 Django 支持（几乎强制执行）该模式。搜索 MVC。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T19:27:36.233

如果您将对象视为保存状态信息的构造，那么“面向对象”的定义会因 Web 请求的无状态特性而变得紧张。但是，无状态对象仍然是对象，Web 应用程序可以在该上下文中遵循 OO 设计原则。

# iphone - UIWebView 似乎没有加载页面

> ID：922731
> 
> 赞同：1
> 
> 时间：2009-05-28T19:25:21.060
> 
> 标签：iphone, objective-c, uiwebview

我有一个基于导航控制器的应用程序，它下载 RSS 提要并在 TableView 中布置项目标题。那部分有效。当我单击文章标题时，我想将 FeedArticleController 的一个实例推送到导航堆栈上。FeedArticleController loadView 方法设置视图（因为我想学习如何以编程方式而不是使用 IB 来执行此操作）。这是加载视图：

```
- (void)loadView {
    UIView *view = [[UIView alloc] init];
    self.view = view;

    webView = [[UIWebView alloc] initWithFrame:self.view.bounds];
    webView.delegate = self;

    [view addSubview:webView];
} 
```

那有意义吗？现在，为了让 webView 真正加载页面，我有这个 viewDiDLoad 方法：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    [webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.google.com"]]]; 
} 
```

然后我有委托方法，webViewDidStartLoad 和 webViewDidFinishLoad。他们只是打印到 NSLog。

我在构建和添加视图的方式上是否遗漏了什么？委托方法似乎在延迟后打印到日志，并且在实例化 webView 时在线上有流量。所以，我认为它正在加载页面，但没有显示？

多谢你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T21:06:43.053

这里有两件事需要研究：

1.  将 Web 视图设置`autoresizingMask`为`UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight`以使 Web 视图在调整其父级大小时调整其大小。这是因为默认情况下，您创建的父 UIView 和 UIWebView 都有零帧 (0,0,0,0)。通过设置此项，当父级在进入屏幕之前调整大小时，Web 视图将调整大小以匹配。
2.  不要使用单独的 UIView 实例，只需将 self.view 设置为您的 UIWebView 实例。

我推荐第二个选项，除非你真的*需要*你的控制器中的另一个视图。另外，我应该在这里指出，您在上面的代码片段中同时泄漏了 UIView 和 UIWebView。这可能会被简化，但如果不是，您应该在分配视图后释放它们。这是实现上述解决方案 2 的示例：

```
- (void) loadView
{
    webView = [[UIWebView alloc] initWithFrame:self.view.bounds];
    webView.delegate = self;    // weak reference: doesn't retain self
    self.view = webView;        // strong reference: retains webView
    [webView release];          // release initial reference: now 'owned' through self.view
} 
```

# date - 显示自给定日期以来的修改（新文件和编辑文件）

> ID：922736
> 
> 赞同：41
> 
> 时间：2009-05-28T19:25:58.063
> 
> 标签：date, tfs

自给定日期以来，我如何要求 TFS 仅显示工作区（或文件夹中）中修改过的文件（新文件和编辑过的文件）。

可能吗？还是我必须自己经历所有的历史并建立自己的“修改树”。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-09-23T16:59:22.570

在 Visual Studio 中打开源代码管理资源管理器（查看->其他 Windows->源代码管理资源管理器），然后选择项目的顶层文件夹。然后右键单击并查看历史记录。

这将显示此文件夹中所有代码的所有签入，按日期排序。然后从签到列表中选择两个日期，右键单击并选择“比较”。例如，如果您想查看过去一个月内更改的所有代码，请单击最近的签入和一个月前的签入。

这将显示自这两个时间点以来更改的所有代码。您也可以只选择过去的日期来与您当前的代码进行比较。这适用于我现在正在使用的 VS2015。祝你好运。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-05-28T19:56:58.733

使用[命令行](http://msdn.microsoft.com/en-us/library/z51z7zy0.aspx)

```
tf history -noprompt -server:http://tfsserver:8080/tfs/DefaultCollection $/TeamProjectName/path
          -version:D2006-12-01T01:01:01Z~D2006-12-13T20:00:00Z -recursive
          -format:detailed -login:DOMAIN\name,password" 
```

将版本标志中的日期更改为您需要的日期，它应该可以满足您的需求。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-29T04:34:04.200

如果您打开菜单项 File->Source Control->Find In Source Control->Changesets...（您必须在 Source Control Explorer 中才能使用）。这将打开“查找变更集”对话框。然后，您可以在给定的源文件夹上按日期搜索更改集。

不利的一面是，您必须单击每个更改集上的详细信息按钮以查看更改了哪些文件（双击关闭对话框）。

如果您正在搜索更改，这可能是更好的方法。它将允许更多的交互式搜索。如果您尝试打印一份报告供其他人阅读（或更改文档），那么 Alex 显示的命令行方式更好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-08T15:36:19.300

在 VS10 中打开 Source Control Explorer（View->TeamExplorer->Source Control Explorer），右键项目，点击 Compare。您可以看到不同的视图选项。我通常使用“显示不同的项目”来查看本地和服务器之间的差异。

# javascript - E4X 按文本内容过滤？

> ID：922744
> 
> 赞同：0
> 
> 时间：2009-05-28T19:27:27.547
> 
> 标签：javascript, filter, e4x

我正在尝试使用 E4X 过滤 JavaScript 中的一些 XML，并有一些特定的需求。鉴于以下情况：

```
    var xml = <正文>
      <div>
        <p>这是我的一些文字。</p>
      </div>
    </div>;

```

我想在文档中搜索以“这是一些文本”开头的段落。

目前我可以通过以下方式获得该段落：

```
xml..div(p.text().toString().indexOf("This is some text") === 0) 
```

然而，“真正的”XML 要复杂得多（想想：一个普通的网页）。不能保证会有一个 div 直接作为问题段落的父级。在同一父元素内的相关段落之前/之后可能还有其他段落。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-29T17:31:06.640

使用双点运算符搜索任何嵌套调平的所有 <p> 节点，然后过滤掉节点以仅包含以所需字符串开头的节点。你很接近，你只需要摆脱 <div> 因为，正如你所说， <div> 可能不存在。：

```
xml..p.( text().toString().indexOf("This is some text") == 0 ); 
```

# css - 在 IE 中呈现质量差的 CSS Sprites 图像

> ID：922748
> 
> 赞同：0
> 
> 时间：2009-05-28T19:27:49.947
> 
> 标签：css, css-sprites

我有一个 CSS 图像精灵，它在 FF 和 IE 中呈现完美。问题是渲染的图像在 IE 中看起来质量很差。

有没有人遇到过这个？你怎么修好它的？我需要 CSS 精灵来节省带宽和请求。

[替代文字 http://cupacupelor.ro/img/problem.png](http://cupacupelor.ro/img/problem.png)

```
.blackmncenter2
{
    float:left;
    height:32px;
    line-height:32px;
    background-image:url(../img/top-menu-center.png);   
    background-repeat:repeat-x;
    background-position:left -64px;
    color:White;
    cursor:pointer;
    display:block;
} 
```

### 图片：

> [http://cupacupelor.ro/img/problem.png](http://cupacupelor.ro/img/problem.png)

### 演示：

> [http://cupacupelor.ro/](http://cupacupelor.ro/)

黑色顶部菜单，发布后最多 7 天可用。用 FF 试试，然后用 IE。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T19:39:00.300

你需要PNG格式的图形吗？传统上，Internet Explorer 6.0 和更早版本存在一些与 PNG 格式相关的问题，最明显的是缺乏对 alpha 通道的支持。

如果没有这个 alpha 通道，IE 就无法正确渲染 PNG 图像中表示的透明度。这可能会稍微扭曲图像，或者给你一些你期望看到的东西。

如果没有更多细节，就很难辨别是什么导致了问题（或者问题是什么）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:29:33.703

请定义“质量差”。也许是因为您的 CSS 精灵没有保留原始图像的透明度？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:46:18.660

奇怪的行为，出乎意料。

即使我有没有透明度的 IE 7 和 PNG，使用**background-position**样式渲染的背景在 IE 中也很奇怪。

将图像保存为 JPG 并修改 CSS 即可解决问题。

比你们，我投票给了答案。

# python - 为 cvs2svn 安装/配置 gdbm Python 模块？

> ID：922750
> 
> 赞同：2
> 
> 时间：2009-05-28T19:28:09.790
> 
> 标签：python, solaris, cvs2svn, gdbm

我正在尝试在 Solaris 10 机器上安装 cvs2svn。它上面有 Python 2.4.4。我没有root访问权限。当我下载 cvs2svn 并尝试运行它时，它说

> 错误：cvs2svn 使用 anydbm 包，它依赖于较低级别的 dbm 库。您的系统有 dbm，已知 cvs2svn 有问题。要使用 cvs2svn，您必须安装一个 Python dbm 库，而不是 dumbdbm 或 dbm。有关更多信息，请参阅[http://python.org/doc/current/lib/module-anydbm.html](http://python.org/doc/current/lib/module-anydbm.html)。

我下载了 gdbm，编译并安装在我的主目录中。如何安装适用于 anydbm 的 Python gdbm 模块？谷歌没有帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-25T16:27:44.603

我下载了 Python 2.5.1 并从源代码编译它。我确保我的 gdbm 库位于适当的路径中，并在我的主目录中使用了 altinstall。我现在可以使用我的私有 python 副本运行 cvs2svn。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-14T12:10:31.583

将`$PYTHONPATH`环境变量设置为指向您安装的位置`gdbm`。然后当你运行时`cvs2svn`，anybdm 模块应该会`gdbm`成功找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-18T00:07:46.357

要为 Python 安装 gdbm，请尝试：

```
pip install gdbm 
```

如果`pip`不存在，请通过以下方式安装：`easy_install pip`。

在 OSX 上，您可以尝试（如果`brew`已安装）：

```
brew install gdbm 
```

# vb.net - 如何在不创建新字体的情况下更改字体大小

> ID：922761
> 
> 赞同：4
> 
> 时间：2009-05-28T19:31:07.367
> 
> 标签：vb.net, winforms

是否可以在.net winforms 中更改字体的大小而无需创建具有新大小的新字体？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-05T06:44:23.927

您可以使用 Extension 方法执行类似的操作。

```
Imports System.Runtime.CompilerServices

Module FontExtensions

<Extension()> Public Function ToSize(ByVal OriginalFont As Font, ByVal NewSize As Single) As Font

        Dim NewFont As Font

        NewFont = New Font(OriginalFont.FontFamily, NewSize, OriginalFont.Style)

        Return NewFont

    End Function

End Module 
```

然后这样称呼它...

```
SomeObject.Font = Font.ToSize(12) 
```

它仍在幕后创建新字体，但您的应用程序代码不会因创建过程而杂乱无章。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T19:35:28.170

不可以。字体大小对于现有的“字体”对象是只读的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:36:39.023

确保使用允许您使用基本字体并传入所需的新大小的构造方法。这将为您节省一些其他方法的代码。

# sharepoint - 如何通过功能接收器和现有列表模板创建 Sharepoint 列表

> ID：922766
> 
> 赞同：2
> 
> 时间：2009-05-28T19:32:03.993
> 
> 标签：sharepoint, moss

我在 MOSS 列表模板库中有一个列表模板，我需要使用来自功能接收器的此模板创建一个列表。这听起来很容易，但我找不到这样做的方法。

SPWeb 有一个 GetCatalog 方法，它返回一个带有 1 个项目的 SPList - 我的模板 - 但它是一个 SPListItem，我需要一个 SPListTemplate。如何将项目“转换”为正确的类型？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T00:04:31.867

所以，我们放弃了，而是使用了一个特征接收器来完全从代码创建列表。ListDefs 是一个完整的 PITA - C# 是一种更合乎逻辑的创建列表的方式，此外，您还可以获得能够对列表进行代码升级的额外好处。

谢谢大家。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T15:56:06.490

你必须使用内部名称......像这样：

```
foreach (SPListTemplate template in web.ListTemplates)
 {
    if (template.InternalName.Equals("MyTemplateName")
     {
        return template;
     }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-17T16:16:03.020

阅读我对这个[问题](https://stackoverflow.com/questions/7635129/sharepoint-2010-sandbox-solution-uploaded-stp-files-to-catalogs-lt-using-featu/9331694#9331694)的回答。有了它，您应该从 GetCustomListTemplates 获得结果，而不仅仅是一个空列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T10:00:23.310

使用[SPSite](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsite.getcustomlisttemplates.aspx)对象的[GetCustomListTemplates](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsite.getcustomlisttemplates.aspx)方法来获取表示您的自定义模板的[SPListTemplate对象。](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splisttemplate.aspx)然后使用[SPListCollection.Add](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistcollection.add.aspx)方法从该模板创建一个新列表。在代码中，这看起来像这样：

```
using (SPSite site = new SPSite("http://server/sites/site"))
using (SPWeb web = site.OpenWeb())
{
  SPListTemplateCollection templates = site.GetCustomListTemplates(web);
  SPListTemplate template = templates["MyTemplates"];
  Guid listId = web.Lists.Add("Title", "Description", template);
} 
```

# c# - 加快 ClickOnce 应用程序启动的方法

> ID：922769
> 
> 赞同：4
> 
> 时间：2009-05-28T19:33:08.423
> 
> 标签：c#, clickonce

我有一个 Visual Studio 2005/ [C# ClickOnce 应用程序，它从](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29)[Web 服务](https://en.wikipedia.org/wiki/Web_service)获取所有数据。我已经对应用程序进行了调整，让用户觉得它非常灵活，尽管它必须从 Web 服务中获取几乎所有内容的数据。

然而，这家初创公司仍然相当缓慢。似乎需要一段时间才能生成第一个 Web 服务调用。在那之后，就好了。

我可以做些什么来加快此类应用程序的启动速度？我需要生成序列化程序集吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T19:40:53.663

花一些时间分析应用程序加载的程序集。这将对应用程序的加载时间产生最大的影响。如果您有仅偶尔使用的类型，请将它们移至另一个程序集。ClickOnce 可以按需优化程序集的下载，因此在加载时减少所需的程序集数量将使其加载速度更快。

您还可以拥有一种“存根”启动器，它具有最低限度的程序集依赖项，可动态加载其他程序集（Assembly.Load）并在加载后调用实际处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T06:48:30.653

您可以使用 ClickOnce 文件组将应用程序拆分为可管理的部分，然后在需要时使用 ClickOnce API 下载组。*[ClickOnce 文件组](http://www.thejoyofcode.com/ClickOnce_File_Groups.aspx)*一文解释了如何执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T07:03:39.187

确保获得 .NET 3.5 SP1，因为在启动方面有显着的性能改进。特别是 WPF 应用程序。

至于 Web 服务调用，如果确保在编译时生成序列化程序集，则可以加快速度。据我所知，Visual Studio 不知道何时自动生成此文件，但您可以使用 SGEN.EXE 来完成。

它创建一个单独的程序集，例如 MyApp.XmlSerializer.dll，其中包含 Web 服务调用的所有序列化代码。如果没有这个，您的应用程序将对程序集进行失败的探测，然后动态生成代码并在内存中编译它，这就是您的第一个 Web 服务调用缓慢的原因。

# python - Eclipse 或 TextMate 中 Mako 的语法亮点？

> ID：922771
> 
> 赞同：12
> 
> 时间：2009-05-28T19:34:26.190
> 
> 标签：python, templates, mako

有谁知道 Eclipse 或 TextMate 的 Mako 模板的语法高亮？

我知道`.mako`Ubuntu 中的默认文本编辑器有一个语法荧光笔。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T06:03:34.137

我只是做了一些[谷歌搜索](http://www.google.com/search?q=mako+bundle+textmate)。有一个[Mako 捆绑包](http://svn.makotemplates.org/contrib/textmate/Mako.tmbundle/)。

我像这样安装它`~/Library/Application Support/TextMate/Bundles/`：

```
cd ~/Library/Application\ Support/TextMate/Bundles/
svn co http://svn.makotemplates.org/contrib/textmate/Mako.tmbundle

```

在 TextMate 中，我做到了`Bundles | Bundle Editor | Reload Bundles`，并`Mako`出现在菜单中。

它添加了新的 HTML 语言变体：`HTML (Mako)`、片段和类似的东西。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T20:21:41.553

克劳迪奥，

我不使用 mako 模板，但是在 mako-discuss google 组中通过快速的 google 搜索找到了[这篇文章](http://groups.google.com/group/mako-discuss/browse_thread/thread/796926337af30cf0)，它指的是 Colorer 库语法荧光笔。这听起来对你来说可能是一个不错的线索。

-马特

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T20:38:05.920

我最终做的是用 .html 后缀命名我的 Mako 模板，从而获得我习惯的通常的 HTML 语法突出显示等。或者，我可以将 .mako 后缀与 HTML 处理程序相关联。虽然这并没有专门针对 Mako，但对我来说已经足够了，因为我发现大部分模板都是纯 HTML。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-17T12:09:00.057

你可以去：

1.  首选项->常规->编辑器->文件关联。
2.  单击以添加新文件类型并键入 *.mak，然后单击确定。
3.  在文件类型中单击 *.mak 并在关联编辑器下添加 HTML 编辑器（默认）、文本编辑器、文本编辑器（工作室）和 Web 浏览器。

这为文本着色，对我来说可以:)

PS 一定要安装 Aptana 插件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-11T11:44:32.317

Eclipse有一个[Mako 模板编辑器。](http://sourceforge.net/projects/makotemplateeditor/%20Mako%20Template%20Editor)要安装，请将带有 jar 文件的插件目录复制到 Eclipse 根文件夹中的 dropins 文件夹中。也就是说，手动安装 jar 格式的 Eclipse 插件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-15T06:48:55.993

1.  Windows（菜单）>首选项>常规>编辑器>文件关联在文件类型（上框）中添加*.mako并在关联编辑器中添加Html编辑器（下框）

2.  Windows（菜单）> 首选项 > 常规 > 编辑器 > 内容类型

在文本下找到 HTML 并在文件关联中添加 *.mako。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-07T14:12:19.033

LiClipse 插件 ( [http://www.liclipse.com/](http://www.liclipse.com/) ) 为 Eclipse 提供开箱即用的 Mako 支持（请注意，如果您想在 Eclipse 中支持任何其他语言，LiClipse 可以加载任何现有的 TextMate 包 - - [http://www.liclipse.com/textmate_bundles.html](http://www.liclipse.com/textmate_bundles.html) - 为此）。

# java-native-interface - OpenSolaris Brandz 和 JNI 是一个很好的组合吗？

> ID：922772
> 
> 赞同：1
> 
> 时间：2009-05-28T19:34:43.583
> 
> 标签：java-native-interface, opensolaris

我想在 OpenSolaris 机器上运行一个 java 应用程序，但这个应用程序使用 dll/所以我只有 linux 二进制文件。有可能吗，这是因为我对 OpenSolaris Brandz 功能一无所知，我可以在 linux brandz 上部署 dll 并从在 OpenSolaris 端运行的 jvm 链接到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-18T01:36:55.963

不，您不能混合使用 Solaris 和 Linux 二进制文件。您可能会在 Linux 品牌区域上运行整个系统。

# python - 检查输入是字符串列表/元组还是单个字符串

> ID：922774
> 
> 赞同：64
> 
> 时间：2009-05-28T19:35:21.540
> 
> 标签：python, typechecking, python-2.5

我有一种方法，我希望能够接受单个字符串（路径，但不一定存在于运行代码的机器上）或字符串列表/元组。

鉴于字符串充当字符列表，我如何判断该方法收到了哪种类型？

我希望能够接受单个条目的标准或 unicode 字符串，以及多个列表或元组，所以 isinstance 似乎不是答案，除非我错过了一个聪明的技巧（比如采取共同祖先类的优势？）。

Python版本是2.5

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-05-28T19:39:05.493

您可以检查变量是字符串还是 unicode 字符串

*   蟒蛇 3：

```
 isinstance(some_object, str) 
```

*   蟒蛇2：

```
 isinstance(some_object, basestring) 
```

这将返回`True`字符串和 unicode 字符串

当您使用 python 2.5 时，您可以执行以下操作：

```
if isinstance(some_object, basestring):
    ...
elif all(isinstance(item, basestring) for item in some_object): # check iterable for stringness of all items. Will raise TypeError if some_object is not iterable
    ...
else:
    raise TypeError # or something along that line 
```

严格性可能不是一个词，但我希望你明白这一点

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-28T19:41:12.260

`isinstance` **是**一个选项：

```
In [2]: isinstance("a", str)
Out[2]: True

In [3]: isinstance([], str)
Out[3]: False

In [4]: isinstance([], list)
Out[4]: True

In [5]: isinstance("", list)
Out[5]: False 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-28T19:39:42.403

类型检查：

```
def func(arg):
    if not isinstance(arg, (list, tuple)):
        arg = [arg]
    # process

func('abc')
func(['abc', '123']) 
```

可变参数：

```
def func(*arg):
    # process

func('abc')
func('abc', '123')
func(*['abc', '123']) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-11-07T09:10:54.913

由于我喜欢保持简单，这是与 2.x 和 3.x 兼容的最短形式：

```
# trick for py2/3 compatibility
if 'basestring' not in globals():
   basestring = str

v = "xx"

if isinstance(v, basestring):
   print("is string") 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-05-17T19:01:55.250

```
>>> type('abc') is str
True
>>> type(['abc']) is str
False 
```

此代码与 Python 2 和 3 兼容

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-28T19:39:30.673

使用 isinstance(arg, basestring) 检查类型

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-11-25T14:27:25.780

我很惊讶没有人给出鸭子类型的答案，而是给出了不清楚或高度依赖于类型或版本的答案。此外，不幸的是，接受的答案对于 Python 2 和 3 有单独的代码。Python 使用并鼓励鸭式打字，所以（比 sorin 的“最短形式”多一行，不是鸭式打字）我建议：

```
def is_str(v):
    return hasattr(v, 'lower') 
```

...以及您要使用的任何其他属性（记住引号）。这样，使用您的软件的客户端代码可以发送他们想要的任何类型的字符串，只要它具有您的软件所需的接口。鸭子类型以这种方式对其他类型更有用，但它通常是最好的方式。

或者你也可以这样做（或者通常检查 AttributeError 并采取一些其他措施）：

```
def is_str(v):
    try:
        vL = v.lower()
    except AttributeError:
        return False
    return True 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T19:36:46.980

你考虑过`varargs`语法吗？我不确定这是否是您要问的，但是像[这样的问题](https://stackoverflow.com/questions/836387/how-can-i-tell-if-a-python-variable-is-a-string-or-a-list/836406#836406)会符合您的要求吗？

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2016-10-13T23:22:36.973

你不能这样做：

```
(i == list (i) or i == tuple (i)) 
```

如果输入是元组或列表，它会回复。唯一的问题是它不能与仅包含一个变量的元组一起正常工作。

# java - 生产 JVM 的安全调试

> ID：922779
> 
> 赞同：20
> 
> 时间：2009-05-28T19:36:12.583
> 
> 标签：java, security, debugging

我们有一些应用程序有时会进入不良状态，但仅在生产中（当然！）。虽然进行堆转储有助于收集状态信息，但使用远程调试器通常更容易。设置它很容易——只需将它添加到他的命令行中：

-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=PORT

似乎没有可用的安全机制，因此在生产中打开调试将有效地允许任意代码执行（通过热交换）。

我们在 Solaris 9 和 Linux (Redhat Enterprise 4) 上混合了 1.4.2 和 1.5 Sun JVM。我们如何启用安全调试？还有其他方法可以实现我们的生产服务器检查目标吗？

**更新：**对于 JDK 1.5+ JVM，可以指定调试器应该绑定的接口和端口。因此，考虑到服务器上正确设置了 SSH，KarlP 建议绑定到环回并仅使用 SSH 隧道连接到本地开发人员框应该可行。

但是，JDK1.4x 似乎不允许为调试端口指定接口。那么，我们可以阻止对网络中某处的调试端口的访问，或者在操作系统本身中进行一些特定于系统的阻止（Jared 建议的 IPChains 等）？

更新 #2：这是一个可以让我们限制风险的 hack，即使在 1.4.2 JVM 上也是如此：

命令行参数：

```
-Xdebug
-Xrunjdwp:
    transport=dt_socket,
    server=y,
    suspend=n,
    address=9001,
    onthrow=com.whatever.TurnOnDebuggerException,
    launch=nothing 
```

开启调试器的 Java 代码：

```
try {
    throw new TurnOnDebuggerException();
} catch (TurnOnDebugger td) {
   //Nothing
} 
```

TurnOnDebuggerException 可以是保证不会在其他任何地方抛出的任何异常。

我在 Windows 机器上对此进行了测试，以证明 (1) 调试器端口最初不接收连接，以及 (2) 如上所示抛出 TurnOnDebugger 异常会导致调试器激活。启动参数是必需的（至少在 JDK1.4.2 上），但垃圾值由 JVM 优雅地处理。

我们正计划制作一个小型 servlet，在适当的安全性之后，可以允许我们打开调试器。当然，之后不能关闭它，并且调试器一旦打开它仍然会乱听。但是，这些是我们愿意接受的限制，因为生产系统的调试总是会导致之后重新启动。

**更新 #3：**我最终编写了三个类：(1) TurnOnDebuggerException，一个普通的 Java 异常，(2) DebuggerPoller，一个后台线程，用于检查文件系统上是否存在指定文件，以及 (3) DebuggerMainWrapper，启动轮询线程然后反射性地调用另一个指定类的 main 方法的类。

这是它的使用方式：

1.  在启动脚本中用 DebuggerMainWrapper 替换“主”类
2.  添加两个系统 (-D) 参数，一个指定真正的主类，另一个指定文件系统上的文件。
3.  在命令行上配置调试器，添加 onthrow=com.whatever.TurnOnDebuggerException 部分
4.  将具有上述三个类的 jar 添加到类路径中。

现在，当您启动 JVM 时，除了启动了一个后台轮​​询线程之外，一切都相同。假设该文件（我们的称为 TurnOnDebugger）最初不存在，轮询器每 N 秒检查一次。当轮询器第一次注意到它时，它会抛出并立即捕获 TurnOnDebuggerException。然后，代理被踢掉。

您无法将其关闭，并且机器在打开时也不是非常安全。从好的方面来说，我不认为调试器允许多个同时连接，所以保持调试连接是你最好的防御。我们选择文件通知方法是因为它允许我们通过在只有正确使用权限的目录中指定触发器文件来搭载现有的 Unix authen/author。您可以轻松地构建一个通过套接字连接实现相同目的的小 war 文件。当然，由于我们无法关闭调试器，我们只会在关闭有病的应用程序之前使用它来收集数据。如果有人想要这个代码，请告诉我。但是，您只需几分钟就可以自己拼凑起来。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T19:52:32.847

如果您使用 SSH，您可以允许隧道和隧道端口到您的本地主机。无需开发，全部使用 sshd、ssh 和/或 putty 完成。

可以在本地接口 127.0.0.1 上设置 java 服务器上的调试套接字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T19:40:09.157

你说得对：Java 调试 API 本质上是不安全的。但是，您可以将其限制为 UNIX 域套接字，并使用 SSL/SSH 编写代理，让您拥有经过身份验证和加密的外部连接，然后将其代理到 UNIX 域套接字中。这至少可以减少您接触到可以将进程进入服务器的人，或者可以破解您的 SSL 的人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:39:59.797

将信息/服务导出到 JMX 中，然后使用 RMI+SSL 远程访问它。您的情况就是 JMX 的设计目的（M 代表管理）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T19:42:35.377

好问题。

我不知道有任何内置功能可以加密与调试端口的连接。

可能有更好/更简单的解决方案，但我会执行以下操作：

1.  将生产机器放在阻止访问调试端口的防火墙后面。
2.  在连接到端口的主机上运行代理进程，并加密来自套接字的输入和输出。
3.  在调试工作站上运行代理客户端，该代理客户端也对输入进行加密/解密。将此连接到服务器代理。他们之间的通信将被加密。
4.  将调试器连接到代理客户端。

# .net - 在 .Net 中检索 Oracle 时间戳字段时出现问题

> ID：922783
> 
> 赞同：3
> 
> 时间：2009-05-28T19:36:41.863
> 
> 标签：.net, vb.net, oracle

我需要在 .Net 3.0 中开始使用毫秒。数据将从 Oracle 数据库返回，如果我理解正确，Oracle 只能存储使用毫秒作为时间戳的日期。.Net 中的 Date 类型似乎可以处理毫秒，但是当我过去尝试从 Oracle 存储过程中检索时间戳时，我遇到了一个令人讨厌的错误。.Net 可以处理 Oracle 时间戳数据类型，还是需要将其作为 VarChar 带回并将其转换为日期类型？

谢谢，

戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T20:44:03.163

如果您使用[ODP.NET](http://www.oracle.com/technology/tech/windows/odpnet/index.html)，那么您可以将值作为`Oracle.DataAccess.Types.OracleTimeStamp`. 然后，您可以使用该`Value`属性将其作为`System.DateTime`对象返回。

您的代码将如下所示：

```
 Private Function GetTimeStamp() As DateTime

        Dim timeStamp As DateTime

        Dim sql As String = "your timestamp query"

        Using conn As OracleConnection = New OracleConnection("your connection string")
            Using command As OracleCommand = New OracleCommand(sql, conn)
                conn.Open()

                Using dataReader As OracleDataReader = command.ExecuteReader(CommandBehavior.CloseConnection)
                    If dataReader.Read() Then
                        timeStamp = dataReader.GetOracleTimeStamp(0).Value
                    End If
                End Using

            End Using
        End Using

        Return timeStamp

    End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:11:57.487

知道错误是什么会很有帮助..

我在 Access 中链接 Oracle 表时遇到了类似的问题。它使用自 1970 年 1 月 1 日午夜以来的天数（带有小数天）的时间戳。我只是将字段作为十进制输入，然后转换它们：

现场/86400+25569

然后您可以使用 format() 或任何函数将其转换为日期字符串。

# python - 为python中的进程编写内核模式分析器

> ID：922788
> 
> 赞同：2
> 
> 时间：2009-05-28T19:37:54.793
> 
> 标签：python, kernel

我想在编写在内核模式下运行的“进程分析器”时寻求一些指导。我要求内核模式分析器是因为我运行大量应用程序并且我不希望我的分析器被换出。

当我说“进程分析器”时，我的意思是监视进程的资源使用情况。包括线程的使用及其统计信息。

我想用python写这个。向我指出一些模块或有用的资源。

请为我提供指导/建议。

## 谢谢，

编辑::: 想补充一点，目前我的兴趣是只为 linux 编写。但是，在我构建它之后，我将不得不支持 Windows。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T19:42:20.557

在 Python 中执行进程监控部分将非常困难，因为 Python 解释器不在内核中运行。

我怀疑有两种简单的方法：

1.  使用 /proc 文件系统，如果你有（你没有提到你的操作系统）
2.  如果您有 dtrace，请使用 dtrace（同样，没有操作系统，谁知道。）

* * *

好的，编辑后跟进。

首先，你不可能编写在内核、python 中运行并且可以在 Linux 和 Windows 之间移植的代码。或者至少如果你愿意，这将是一个永远活在荣耀中的黑客。

尽管如此，如果您的目的是处理 Python，那么有很多 Python 工具可用于在运行时从 Python 解释器获取信息。

*相反，如果您希望从其他*进程中获取进程信息，则需要检查各种操作系统 API 中可用的选项。Linux 有一个 /proc 文件系统；这是一个有用的开始。我怀疑 Windows 有类似的 API，但我不知道它们。

如果你必须编写内核代码，你几乎肯定需要用 C 或 C++ 编写它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T20:02:14.650

**不要**试图让 python 在内核空间中运行！

使用现有工具并让它吐出可以被 Python 吸收的 XML 会更好。我不想将 Python 解释器移植到内核模式（听起来很糟糕）。

/proc 选项听起来不错。

**一些代码** 代码，它读取 proc 信息以确定内存使用情况等。应该让你去：

[http://www.pixelbeat.org/scripts/ps_mem.py](http://www.pixelbeat.org/scripts/ps_mem.py) 像查理建议的那样**通过 /proc/smaps 使用 Python 读取进程的内存信息。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T20:10:16.197

你看过`PSI`吗？（[http://www.psychofx.com/psi/](http://www.psychofx.com/psi/)）

“PSI 是一个 Python 模块，提供对实时系统和进程信息的直接访问。PSI 是一个 Python C 扩展，提供直接从系统调用对系统信息的最有效访问。”

它可能会给你你正在寻找的东西。.... 或者至少是一个起点。

* * *

2014年编辑：

我建议`psutil`改为检查： [https ://pypi.python.org/pypi/psutil](https://pypi.python.org/pypi/psutil)

`psutil`被积极维护并具有一些漂亮的过程监控功能。 `PSI`似乎有些死（2009 年最后一次发布）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T21:50:29.113

您对其他答案的一些评论表明您是一个相对缺乏经验的程序员。因此，我强烈建议您远离内核编程，因为即使对于有经验的程序员来说也很难。

你为什么要写这样的东西

*   是一个非常复杂的系统（只需看看现有的分析基础设施以及它们的复杂程度）
*   不能在 python 中完成（我不知道任何允许在内核模式下执行 python 的内核）
*   已经存在（Linux 上的[oprofile ）](http://oprofile.sourceforge.net/)

# tfs - 如何忽略 TFS 中的文件/目录以避免它们进入中央源存储库？

> ID：922798
> 
> 赞同：265
> 
> 时间：2009-05-28T19:39:20.580
> 
> 标签：tfs

是否可以在 TFS 源代码控制中基于每个项目设置要忽略的文件/文件夹？

例如，我有一个网站，其中包含我不想进入源代码控制的资产文件夹。这些资产由单独的系统维护。另外，我不想将几 GB 的资产放入源代码管理中，但我需要在我的开发机器上提供几个示例，但我也不想检查这些。

如果我在绑定到源代码控制的同时在此网站上工作并刷新树，这些文件将自动再次添加

我想防止这种情况发生。

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2014-01-13T22:07:32.753

如果您使用的是本地工作区 (TFS 2012+)，您现在可以使用该`.tfignore`文件来排除本地文件夹和文件的签入。

如果您将该文件添加到源代码管理，您可以确保团队中的其他人共享相同的排除设置。

MSDN 上的完整详细信息 - [http://msdn.microsoft.com/en-us/library/ms245454.aspx#tfignore](http://msdn.microsoft.com/en-us/library/ms245454.aspx#tfignore)

对于懒人：

> `.tfignore`您可以通过在您希望应用规则的文件夹中放置一个名为的文本文件来配置忽略哪些类型的文件。文件的效果`.tfignore`是递归的。但是，您可以在子文件夹中创建 .tfignore 文件以覆盖`.tfignore` 父文件夹中文件的效果。
> 
> 以下规则适用于 .tfignore 文件：
> 
> *   `#`开始注释行
> *   * 和 ? 支持通配符。
> *   除非以 \ 字符为前缀，否则文件规范是递归的。
> *   ！否定文件规范（不忽略与模式匹配的文件）

示例文件：

```
# Ignore .cpp files in the ProjA sub-folder and all its subfolders
ProjA\*.cpp
# 
# Ignore .txt files in this folder 
\*.txt
#
# Ignore .xml files in this folder and all its sub-folders
*.xml
#
# Ignore all files in the Temp sub-folder
\Temp
#
# Do not ignore .dll files in this folder nor in any of its sub-folders
!*.dll 
```

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2016-11-03T19:09:58.587

# 对于 VS2015 和 VS2017

### 适用于 TFS（本地）或 VSO（Visual Studio Online - Azure 托管的产品）

NuGet 文档提供了[有关如何完成此操作的说明](http://docs.nuget.org/ndocs/consume-packages/packages-and-source-control#omitting-packages-with-team-foundation-version-control)，我刚刚成功地按照它们在 Visual Studio 2015 和 Visual Studio 2017 中针对 VSTS（Azure 托管的 TFS）进行了操作。~~截至2016 年 11~~月 2018年 8 月，所有内容均已全面更新。

我建议您按照 NuGet 的说明进行操作，但只是回顾一下我所做的事情：

1.  确保您的`packages`文件夹未提交到 TFS。如果是的话，把它从那里弄出来。
2.  除非另有说明，否则我们在下面创建的所有其他内容都将放入您的文件所在的同一文件夹中`.sln`（NuGet 的说明对此并不完全清楚）。
3.  创建一个`.nuget`文件夹。您可以使用 Windows 资源管理器为其命名`.nuget.`以成功另存为`.nuget`（它会自动删除最后一个句点）但直接尝试命名它`.nuget`可能不起作用（您可能会收到错误或可能会更改名称，具体取决于您的 Windows 版本）。或者将目录命名为 nuget，并在命令行提示符下打开父目录。类型。仁 nuget .nuget
4.  在该文件夹中，创建一个`NuGet.config`文件并添加以下内容并保存：

**NuGet.config：**

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <solution>
        <add key="disableSourceControlIntegration" value="true" />
    </solution>
</configuration> 
```

5.  返回您`.sln`的文件夹并创建一个新的文本文件并命名`.tfignore`（如果使用 Windows 资源管理器，请使用与上述相同的技巧并命名`.tfignore.`）
6.  将以下内容放入该文件中：

**.tfignore：**

```
# Ignore the NuGet packages folder in the root of the repository.
# If needed, prefix 'packages' with additional folder names if it's 
# not in the same folder as .tfignore.
packages

# include package target files which may be required for msbuild,
# again prefixing the folder name as needed.
!packages/*.targets 
```

7.  保存所有这些，将其提交到 TFS，然后关闭并重新打开 Visual Studio，团队资源管理器不应再将包文件夹标识为待签入。
8.  通过 Windows 资源管理器将`.tfignore`文件和`.nuget`文件夹复制/粘贴到我所有的各种解决方案中并提交它们，我不再有`packages`文件夹试图潜入我的源代码控制仓库！

# 进一步定制

虽然不是我的，但我发现[sirkirby的](https://github.com/sirkirby/tfignore)[这个`.tfignore`](https://github.com/sirkirby/tfignore)模板很方便。我的答案中的示例涵盖了 Nuget`packages`文件夹，但此模板包含其他一些内容，并提供了其他示例，如果您希望进一步自定义这些示例，这些示例可能很有用。

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2009-12-21T09:54:16.150

**忽略 Team Foundation Server中**的文件（和文件夹）似乎有点麻烦。我找到了几种方法来做到这一点（使用 TFS / Team Explorer / Visual Studio 2008）。这些方法也适用于网站 ASP 项目类型。

一种方法是将新项目或现有项目添加到项目中（例如，右键单击项目，添加现有项目或从 Windows 资源管理器拖放到解决方案资源管理器中），让 TFS 处理文件或文件夹，然后撤消挂起项目的变化。TFS 会将它们取消标记为具有待处理的添加更改，并且文件将安静地位于项目中并远离 TFS。

另一种方法是使用 Source Control Explorer 的 Add Items to Folder 命令。这将启动一个小向导，在其中一个步骤中，您可以选择要排除的项目（尽管，我认为您必须使用此方法将至少一个项目添加到 TFS 以便向导让您继续）。

您甚至可以添加禁止模式签入策略（在团队 -> 团队项目设置 -> 源代码控制... -> 签入策略下）以禁止团队中的其他人错误地签入某些资产。

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2015-03-11T08:57:38.150

对于**TFS 2013**：

在 VisualStudio - **Team Explorer**中启动，在**PendingChanges**对话框中撤消状态为 [add] 的更改，这应该被忽略。

Visual Studio 将再次检测到 Add(s)。单击**“检测到：x add(s)”** -在**排除的更改中**

在打开的“Promote Cadidate Changes”-对话框中，您可以使用上下文菜单轻松排除文件和文件夹。选项是：

*   忽略此项目
*   按扩展名忽略
*   按文件名忽略
*   被 ffolder 忽略（是 ffolder，TFS 2013 Update 4/Visual Studio 2013 Premium Update 4）

不要忘记签入更改后的 .tfignore 文件。

对于**2015/2017 年**：

相同的过程：在 TeamExplorer\Pending Changes 中的“Excluded Changes Tab”中单击 Detected: xxx add(s)

![TeamExplorer\Pending Changes 中的排除更改选项卡](https://i.stack.imgur.com/3R0WD.png)

“Promote Candidate Changes”对话框打开，您可以在条目上右键单击上下文菜单。错字现在已修复:-)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-02-16T11:34:18.120

我找到了像 SVN 一样忽略 TFS 中文件的完美方法。
首先，选择您要忽略的文件（例如 Web.config）。
现在转到菜单选项卡并选择：

> ***文件源代码管理 > 高级 > 从源代码管理中排除 web.config***

......和繁荣; 您的文件被永久排除在源代码管理之外。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-28T22:55:03.493

我将假设您正在使用网站项目。这些会自动爬取他们的项目目录并将所有内容都放入源代码管理中。没有办法阻止他们。

但是，不要绝望。Web 应用程序项目不会表现出这种奇怪且相当出乎意料的（恕我直言：白痴）行为。WAP 是 VS2005 的插件，直接与 VS2008 一起提供。

作为将项目更改为 WAP 的替代方法，您可以考虑将 Assets 文件夹从源代码控制中移出并移到 TFS 文档库中。仅当项目本身不直接使用资产文件时才这样做。

# database - 如果您忘记密码，有没有办法闯入 PostgreSQL 数据库？

> ID：922804
> 
> 赞同：16
> 
> 时间：2009-05-28T19:40:10.093
> 
> 标签：database, postgresql, password-recovery

我有一个拥有 PostgreSQL 数据库的客户端，他不记得我们在设置数据库时使用的密码。有没有办法恢复这些信息，这样我就不必炸毁他的数据库并从头开始？

数据库在 PC 上运行。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-28T19:46:01.487

**第一步：**编辑 PostgreSQL 配置文件建立信任关系，无需密码登录：

> vi /var/lib/pgsql/data/pg_hba.conf

旧线：

> 本地所有postgres密码

将其更改为：

> 本地所有 postgres 信任

**第 2 步：**重新启动 PostgreSQL 服务器：

> 服务 postgresql 重启

**第三步：**修改密码：

> psql -U postgres template1 -c 使用密码“newpassword”更改用户 postgres；

**第 4 步：**密码已更新。恢复配置文件的原始设置：

> vi /var/lib/pgsql/data/pg_hba.conf

旧线：

> 本地所有 postgres 信任

将其更改为：

> 本地所有postgres密码

**第 5 步：**重启服务器并使用您的新密码访问 PostgreSQL 服务器。

> 服务 postgresql 重启

[来源](http://linuxadminzone.com/recover-or-reset-root-password-of-mysql-and-postgresql-servers/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T09:29:53.103

对于 9.2，在 Windows 中：

停止服务：

> 网络停止 postgresql-x64-9

修改config文件，修改data/pg_hba.conf，基本上md5为trust：

> 托管所有所有 127.0.0.1/32 信任
> 
> 托管所有::1/128 信任

启动服务：

> 网络启动 postgresql-x64-9

在 sql 控制台或使用 psql 执行 sql 语句以设置所需的密码：

> 使用密码“newpassword”更改用户 postgres；

放回原来的配置文件。

# python - 使用 Python 进行 SSO 的 SPNEGO（kerberos 令牌生成/验证）

> ID：922805
> 
> 赞同：9
> 
> 时间：2009-05-28T19:40:12.120
> 
> 标签：python, active-directory, single-sign-on, kerberos, spnego

我正在尝试实现一个简单的单点登录方案，其中一些参与的服务器将是 Windows (IIS) 框。看起来 SPNEGO 是一个合理的路径。

这是场景：

*   用户使用他的用户名和密码登录到我的 SSO 服务。我使用某种机制对他进行身份验证。
*   稍后，用户想要访问 App A。
    *   用户对 App A 的请求被 SSO 服务拦截。SSO 服务使用 SPNEGO 将用户登录到 App A：
        *   SSO 服务点击 App A 网页，获得“WWW-Authenticate: Negotiate”响应
        *   SSO 服务代表用户生成“Authorization: Negotiate xxx”响应，响应 App A。用户现在登录到 App A。
    *   SSO 服务拦截用户对 App A 的后续请求，将 Authorization 标头插入其中，然后再将其传递给 App A。

听起来对吗？

我需要两件事（至少我现在能想到的）：

*   代表用户生成“授权：协商 xxx”令牌的能力，最好使用 Python
*   在 Python 中验证“授权：协商 xxx”标头的能力（用于项目的后面部分）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T13:49:51.233

这正是 Apple 对其[Calendar Server](http://trac.calendarserver.org/)所做的。他们有一个用于进程的 kerberos 部分的[python gssapi](http://trac.calendarserver.org/browser/PyKerberos)库，以实现[SPNEGO](http://www.ietf.org/rfc/rfc4559.txt)。

在 CalendarServer/twistedcaldav/authkerb.py 中查找服务器身份验证部分。kerberos 模块（即 ac 模块）没有任何有用的文档字符串，但 PyKerberos/pysrc/kerberos.py 具有所有函数定义。

这是 svn 中继的网址：http: [//svn.calendarserver.org/repository/calendarserver/CalendarServer/trunk](http://svn.calendarserver.org/repository/calendarserver/PyKerberos/trunk)
[http://svn.calendarserver.org/repository/calendarserver/PyKerberos/trunk](http://svn.calendarserver.org/repository/calendarserver/CalendarServer/trunk)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-04T16:19:56.740

查看[http://spnego.sourceforge.net/credential_delegation.html](http://spnego.sourceforge.net/credential_delegation.html)教程。它似乎正在做你想做的事情。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-12-03T19:10:44.937

我一直在寻找类似的东西（在 Linux 上），这导致我多次访问此页面，但没有给出答案。所以这是我的解决方案，我想出了：

网络服务器是一个带有 mod_auth_kerb 的 Apache。很长一段时间以来，它已经在 Active Directory、单点登录设置中运行。我之前已经能够做到的：

*   在 Linux 上使用具有单点登录的 chromium（使用正确的 krb5 设置，使用 kinit user@domain）
*   使用 pywin32 包中的 sspi 进行 python 连接和单点登录，例如`sspi.ClientAuth("Negotiate", targetspn="http/%s" % host)`

以下代码片段完成了这个难题（以及我的需求），在 Linux 上使用 Kerberos 进行 Python 单点登录（使用 python-gssapi）：

```
in_token=base64.b64decode(neg_value)
service_name = gssapi.Name("HTTP@%s" % host, gssapi.C_NT_HOSTBASED_SERVICE)
spnegoMechOid = gssapi.oids.OID.mech_from_string("1.3.6.1.5.5.2")
ctx = gssapi.InitContext(service_name,mech_type=spnegoMechOid)
out_token = ctx.step(in_token)
buffer = sspi.AuthenticationBuffer()
outStr = base64.b64encode(out_token) 
```

# iphone - 在应用程序在 iPhone 上运行并连接到 xcode 时捕获网络流量

> ID：922811
> 
> 赞同：5
> 
> 时间：2009-05-28T19:42:04.583
> 
> 标签：iphone

当应用程序在 iPhone 上运行并连接到 xcode 时，有什么方法可以捕获网络流量（在 Mac 上使用 Ethereal 等应用程序）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T21:39:44.737

使用以太网电缆连接你的 mac。通过 AirPort 在 Mac 上共享您的网络连接。将 iPhone 连接到 Mac 的 ad-hoc 网络。

在您的 Mac 上运行 Wireshark 或 HTTPScoop，您将能够看到来自 iPhone 的所有流量。

不过，我不知道有任何方法可以为 WAN 连接执行此操作。如果可能的话，我会感到惊讶。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-15T07:51:26.570

要使用 Wireshark 从 iPhone 捕获数据包，您必须首先从 iTunes 获取手机的设备 ID。通过 USB 将 iPhone 插入 Mac...然后打开 iTunes 并单击顶部导航栏中的 iPhone 图标。

[![在此处输入图像描述](https://i.stack.imgur.com/MZKwe.png)](https://i.stack.imgur.com/MZKwe.png)

你不能复制UUID，所以你必须手动写下来。获得 UUID 后，您需要安装设备。

打开终端并输入：`rvictl -s <device-id>`

我创建了一个别名，`~/.bash_aliases`只要`alias mntios='rvictl -s <device-id>'`您拥有同一部手机，即使您重新安装操作系统，您的设备 UUID 也不会改变。

一旦你安装了设备启动wireshark。`brew install wireshark`（见：[http](http://brew.sh) ://brew.sh ）

其中一个网络适配器应该是`rvi0`——这是你 iPhone 的网络接口。

现在您可以捕获数据包——双击它开始捕获。

如果你想过滤特定的 url，你可以输入一个过滤器，比如：`http.request.full_uri contains <string-in-url>`过滤请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T20:28:40.370

在您的计算机上，运行 HTTP 调试代理，例如[Charles](http://www.charlesproxy.com/) (Mac) 或[Fiddler2](http://www.fiddler2.com/) (Windows)。在手机的 wi-fi 设置中，打开 HTTP 代理，输入您计算机的 IP 地址和代理的端口号。确保将代理配置为允许来自您的手机的连接。（默认情况下它可能只允许本地主机。）

# android - 我应该在什么时候使用 Android 的不同消息类型？

> ID：922819
> 
> 赞同：5
> 
> 时间：2009-05-28T19:43:28.760
> 
> 标签：android, multithreading, process, messaging

我已经工作`Android`了一年多，但我仍然无法确定何时应该在进程/线程之间使用不同类型的消息传递/通信。我主要说的是广播Intents，使用AIDL for `services`，使用Handlers发送消息和socket通信。

其中许多工具可用于完成类似的任务，但哪种工具更适合特定情况？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-03T21:44:17.277

这是一个非常开放的问题，但让我来描述一下我如何看待应用程序内/应用程序间的通信效果最好。

Android 消息传递的关键方面之一是所有应用程序组件都松散绑定的概念。因为所有应用程序都在一个单独的进程中运行，并且一个“应用程序”实际上可能包含多个应用程序（负责提供不同的活动或服务），所以消息传递技术都基于跨进程边界编组消息的想法。

**意图**

消息传递的首选技术，总是尽可能尝试使用 Intent。这是在 Android 中传输消息的最“原生”方式。

*好处*

使用 Intent 进行消息传递可以保持应用程序组件的松散绑定，让您可以在多个应用程序之间无缝传输消息。Intent 在核心系统中被大量使用来启动活动和服务，以及广播和接收系统事件。

使用 extras Bundles，您可以在 Intents 中包含键/值对作为有效负载数据，以便轻松地将信息从一个应用程序组件传递到另一个应用程序组件 - 即使这些组件在不同的进程中运行。

*缺点*

因为 Intent 被设计为在进程之间传递，所以 extras 有效负载仅支持原始类型。如果您需要使用 Intent 发送对象，则需要在一端将其解构为基元，并在另一端对其进行重构。

**应用类**

如果您只想在单个进程中运行的单个应用程序中进行通信，这是一个方便的解决方案。

*好处*

通过扩展`Application`类（并将其实现为单例），您将获得一个对象，该对象将在任何应用程序组件存在时都存在，从而提供一个集中的位置来存储和在应用程序组件之间传输复杂的对象数据。

*缺点*

这种技术将您的消息传递限制在单个应用程序中的组件上。

**服务绑定、IPC 和 AIDL**

绑定到服务允许您访问其方法并与之交换对象。AIDL 是一种定义如何将对象序列化为 OS 原语的方法，以便如果您绑定到的服务在单独的应用程序中运行，它可以跨进程边界编组。

*好处*

当您绑定到服务时，您可以访问它，就好像它是调用类中的对象一样。这意味着您可以在服务上执行方法并与之交换丰富的对象。

请注意，如果您在不同的应用程序进程中绑定到服务，则需要创建 AIDL 定义来告诉 Android 如何序列化/反序列化您想要在应用程序之间传递的任何对象。

*缺点*

为 IPC 创建 AIDL 类需要一些额外的工作，并且绑定会在服务和活动之间创建额外的依赖关系，这会使内核在其他应用程序处于饥饿状态时更难清理资源。

但是，跨进程边界对消息进行编组是昂贵的。因此，如果您没有在服务上执行方法，使用绑定和 IPC 可能是矫枉过正 - 看看您是否可以使用 Intents 实现相同的目标。

**插座**

如果您使用套接字在单个设备上运行的应用程序内部或之间进行通信，那可能是因为没有其他方法，或者您在某个地方错过了一个技巧。如果您的消息正在离开设备，那么套接字是一个很好、快速的替代方案。如果您留在设备上，Intents 或 IPC 将是一个更好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-09T14:36:14.180

这完全取决于您的应用程序的用例和类型。如果应用程序一直在运行，则最好使用 AIDL 方法，因为它是最安全的通信方式。如果应用程序不需要一直运行，那么您可以使用广播意图或待处理意图方法在应用程序之间进行通信。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T18:05:35.667

我的 2 美分

*   我没有使用本地套接字。似乎有点矫枉过正，因为您必须生成和解析数据。
*   意图是针对其他应用程序可能想要做的事情（在撰写窗口中启动我或挑选一些东西）
*   AIDL/Parcels/Handlers 用于让 GUI 与不断运行的无头进程对话。根据应用程序，许多实际数据传输可能会使用内容提供程序进行，但我倾向于有一些数据需要在该通道之外传输。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-16T01:34:33.200

这是一篇很好的文章，我发现它有助于寻找 Cocoa 的 NSUserDefaults 类的替代品：

[http://developer.android.com/guide/appendix/faq/framework.html](http://developer.android.com/guide/appendix/faq/framework.html)

# asp.net - VSeWSS 管理员权限和 入口

> ID：922822
> 
> 赞同：1
> 
> 时间：2009-05-28T19:45:17.290
> 
> 标签：asp.net, visual-studio, sharepoint, administrator

我正在尝试在 sharepoint 中部署我的第一个自定义 aspx 页面：

*   视窗服务器 2003
*   微软视觉工作室 2008
*   VSeWSS 1.3
*   截至 2009 年 5 月 28 日的最新 Sharepoint 补丁

我正在遵循这个详细的方法：

[http://geeksconnected.com/jamil/Lists/Posts/Post.aspx?ID=19](http://geeksconnected.com/jamil/Lists/Posts/Post.aspx?ID=19)

不幸的是，它很快就会在底部变得不完整。到目前为止，我遇到了两个问题：

1.  如何授予 VSeWSS 管理员权限，以便“部署”选项在 Visual Studio 中起作用？

2.  它切断`<SafeControl>`了示例中的一半标签，我不确定在`PublicKeyToken=`选项后面放什么。当前的所有尝试都完全破坏了共享点。

任何解决方案和解释将不胜感激。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T02:51:47.570

帮自己一个忙，使用 WSPBuilder 及其伴侣 SPVisualDev 而不是 VSeWSS。这两个工具都在 CodePlex.com

他们将通过将安全控制问题添加到任何 SharePoint 管理员都可以安装的 WSP 文件中来解决您的安全控制问题。（坦率地说，在我看来，在 SharePoint 环境中手动修改 web.config 是一个很大的禁忌，尤其是安全控件）

他们也不需要精心设计的 2 项目欺骗，只是为了为您引用的文章所宣传的 ASPX 页面提供代码隐藏。SPVisualDev 将为您提供在 Visual Studio 中执行“添加新项目”的选项，并选择带有代码隐藏的新页面或用户控件，并通过 WSP 处理部署。轻松如！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T15:11:03.583

您是否按照 VSeWSS 1.3 的安装后配置说明进行操作？ [http://blogs.msdn.com/steve_fox/archive/2009/03/18/vsewss-1-3-post-install-configuration.aspx](http://blogs.msdn.com/steve_fox/archive/2009/03/18/vsewss-1-3-post-install-configuration.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T21:20:59.330

1.  您可能需要一个允许运行 stsadm 的帐户。

2.安全控制标签应如下所示：

<SafeControl Assembly="[Assembly Name]" Namespace="[Namespace]" TypeName="*" Safe="True" />

要获得公钥令牌，您首先必须对程序集进行签名（项目上的属性-> 签名）。然后您可以构建它并放入 GAC (C:\Windows\assembly) 并直接在您的资源管理器窗口中读取公钥令牌。

# ruby-on-rails - 你如何测试一个空的输入字段？

> ID：922827
> 
> 赞同：7
> 
> 时间：2009-05-28T19:47:05.103
> 
> 标签：ruby-on-rails, testing

我正在尝试测试输入字段是否与我的字段为空的工厂之一匹配。

```
address => {:first_name => '', :last_name => ''} 
```

在检查输入字段中的内容时，我一直在使用它：

```
assert_select '#first_name[value=?]', address.first_name 
```

除非名字为空，否则这不起作用。我会收到此错误并且测试失败。

```
Expected at least 1 element matching "#first_name[value='']", found 0.
<false> is not true. 
```

这是有道理的，因为生成的代码将没有 value 属性。有没有更好的方法来验证输入字段的值？

到目前为止，要对此进行测试，我可以检查地址字段是否为空白，然后检查是否存在没有值属性的输入字段。但这是混乱和冗长的。

有效但冗长的通用检查示例：

```
if address.first_name.blank?
  assert_select '#first_name[value]', 0
  assert_select '#first_name[type=text]', 1
else
  assert_select '#first_name[value=?]', address.first_name
end 
```

我正在使用的相关信息：
Hpricot 0.8.1
Nokogiri 1.1.1
Rails 2.2.2
Thoughtbot-Shoulda 2.0.5
Webrat 0.4.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T08:45:44.300

也许你可以使用：

```
assert_select "#first_name" do
  assert_select "[value=?]", address.first_name unless address.first_name.blank?
end 
```

我想我不能再短了。如果它是您的测试用例中的重复模式，您可以将其提取到自定义断言中：

```
def assert_has_value_unless_blank(selector, value)
  assert_select selector do
    assert_select "[value=?]", value unless value.blank?
  end
end

assert_has_value_unless_blank "#first_name", address.first_name 
```

# c++ - C++ :: Boost :: posix_time（经过的秒数。经过的小数秒）

> ID：922829
> 
> 赞同：4
> 
> 时间：2009-05-28T19:47:49.173
> 
> 标签：c++

我正在尝试回答两个起初似乎并不难的问题。Q1：如何获取 UTC.Now() 和给定日期之间经过的秒数？A1：就像下面的代码一样！Q2：如何确定自上次“完整”秒以来经过了多少小数秒？我想打印“total_elapsed_seconds.fractional_seconds”->“1234124.45”。我怎么做？A2 ： ？？？

```
#include <iostream>
#include <boost/date_time/gregorian/gregorian.hpp>
#include <boost/date_time/posix_time/posix_time.hpp>

using namespace std;
using namespace boost::gregorian;
using namespace boost::posix_time; 

void main()
{
    ptime Jan1st1970(date(1970, 1, 1));
    for(int i = 0; i < 10; i++)
    {
        ptime Now = second_clock::universal_time();
        time_duration diff = Now - Jan1st1970;
        cout << Now << " : " << diff.total_seconds() << "." << diff.fractional_seconds() << endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T21:08:10.633

您正在使用`second_clock`获取当前时间。顾名思义，它只精确到最接近的秒数。由于您的参考时间没有小数秒，因此持续时间小数秒总是最终为 0。请`microsec_clock`改用：

```
ptime Now = microsec_clock::universal_time(); 
```

此外，在如此紧密的循环中，我不希望每次迭代都会更新时钟，因此您可能还想从 boost::thread 添加睡眠：

```
boost::this_thread::sleep(boost::posix_time::milliseconds(25)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T15:10:26.193

您没有提及您使用的操作系统，但我知道窗口时钟不会为您提供超过 15 毫秒的分辨率（除非您真的玩一些游戏）。
但是，Windows 有一个性能计时器，可以为您提供纳秒级分辨率。它实际上只是 CPU 周期数的计数器（您可以除以 CPU 的频率以获得时间），因此要将其用作时钟，您必须将该时间添加到已知时间：

```
ptime Start = microsec_clock::universal_time();
initMyClockToZero();  // You have to write this to use the performance timer
.... do something ....
int64 microseconds = getMyClockMicrosec(); // this too
ptime Now = Start + posix_time::microseconds(microseconds); 
```

我还有一个秒表样式的计时器，我自己使用 Windows 调用编写的。

```
#ifndef STOPWATCH_HPP
#define STOPWATCH_HPP

#include <iostream>
#include <windows.h>

//! \brief Stopwatch for timing performance values
//!
//! This stopwatch class is designed for timing performance of various
//! software operations.  If the values you get back a greater than a 
//! few seconds, you should be using a different tool.
//! On a Core 2 Duo E6850 @ 3.00GHz, the start/stop sequence takes 
//! approximately 230 nano seconds in the debug configuration and 180 
//! nano seconds in the release configuration.  If you are timing on the
//! sub-microsecond scale, please take this into account and test it on
//! your machine.
class Stopwatch{
public:
    //! \param start if set to true will initialize and then start the 
    //! timer.
    Stopwatch(bool start=false){
        _start.QuadPart = 0;
        _stop.QuadPart = 0;
        if(start)
            Start();
    }

    //! Starts the stopwatch running
    void Start(){
        QueryPerformanceCounter(&_start);
    }
    //! Run this when the event being timed is complete
    void Stop(){
        QueryPerformanceCounter(&_stop);
    }
   //! Stops the timer and returns the result
   double StopResult(){
      Stop();
      return ResultNanoseconds();
   }
    //! You can get the result of the stopwatch start-stop sequence at
    //! your leisure.  
    double ResultNanoseconds(){
        LARGE_INTEGER frequency;
        QueryPerformanceFrequency(&frequency);
        double cyclesPerNanosecond = static_cast<double>(frequency.QuadPart) / 1000000000.0;

        LARGE_INTEGER elapsed;
        elapsed.QuadPart = _stop.QuadPart - _start.QuadPart;
        return elapsed.QuadPart / cyclesPerNanosecond;
    }
    void PrintResultNanoseconds(){
        std::cout << ResultNanoseconds() << "nanosec" << std::endl;
    }
    void PrintResultMicroseconds(){
        std::cout << ResultNanoseconds()/100 << "microsec" << std::endl;
    }
    void PrintResultMilliseconds(){
        std::cout << ResultNanoseconds()/100000 << "millisec" << std::endl;
    }
    void PrintResultSeconds(){
        std::cout << ResultNanoseconds()/1000000000 << "sec" << std::endl;
    }
private:
    LARGE_INTEGER _start;
    LARGE_INTEGER _stop;
};

#endif STOPWATCH_HPP 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T20:15:57.277

这听起来确实很合理，但是输出给了我：

```
2009-May-28 20:14:32 : 1243541672.0
2009-May-28 20:14:32 : 1243541672.0
2009-May-28 20:14:32 : 1243541672.0
2009-May-28 20:14:32 : 1243541672.0
2009-May-28 20:14:32 : 1243541672.0
2009-May-28 20:14:32 : 1243541672.0
2009-May-28 20:14:32 : 1243541672.0
2009-May-28 20:14:32 : 1243541672.0
2009-May-28 20:14:32 : 1243541672.0
2009-May-28 20:14:32 : 1243541672.0
Press any key to continue . . . 
```

事实上，我期待更多的数字 - 我希望得到 10 ^ (-6) [sec] 范围内的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T19:54:30.500

将此添加到您的示例中以获得“当前”小数秒：

```
cout << Now.time_of_day().fractional_seconds() << endl; 
```

并将时钟从 second_clock 更改为 microsec_clock 以获得非零小数秒。

```
ptime Now = microsec_clock::universal_time(); 
```

# cgi - 是否可以获得无缓冲的网络浏览器输出？

> ID：922831
> 
> 赞同：-1
> 
> 时间：2009-05-28T19:48:19.063
> 
> 标签：cgi, buffering, browser

我有一个小的 cgi 脚本，用于获取和验证 Nagios 的配置文件。典型的运行时间是几分钟，我想在运行期间在浏览器中获得一些反馈。

为了说明我想要发生的事情，请考虑一下：

```
#!/bin/sh
echo "Content-type: text/plain"
echo

for i in A B C D E
do
        echo $i
        sleep 10
done 
```

当我通过 telnet 或 wget 在此脚本上执行 GET 时，输出一次一行，间隔十秒（“A”...“B”...“C”...等等） .

当我尝试在普通浏览器中打开它时，浏览器似乎将其全部缓冲并在脚本完成时显示输出（50 秒的静默......“ABCDE”）。

是否可以让浏览器在数据到达后立即将其呈现给用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T20:58:53.803

我相信您想要的是使用“html 块编码”。这让服务器可以向浏览器发送一个它可以开始呈现的 HTML“块”。每当您使用“Response.Write”时，ASP 和 ASP.Net 都会为您解决这个问题。

以下是一些参考资料：

*   [分块传输编码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.6.1)
*   [分块传输编码](http://www.jmarshall.com/easy/http/#http1.1c2)
*   [传输类型](http://www.httpwatch.com/httpgallery/chunked/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T19:55:55.960

使用[Wireshark](http://en.wikipedia.org/wiki/Wireshark)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-24T13:07:19.727

在向响应缓冲区写入足够多的内容后使用 Response.Flush()....

[http://www.stephanunrau.com/](http://www.stephanunrau.com/)

# wpf - WPF 网格项和右对齐文本

> ID：922840
> 
> 赞同：4
> 
> 时间：2009-05-28T19:52:22.517
> 
> 标签：wpf, user-interface

我有一个 WPF 表单，我正在尝试制作一个简单的输入表单。两个标签、两个文本框和一个“提交”按钮。我的布局非常好，唯一不能让我的“标签”在它们的单元格内正确对齐。我已经尝试过 TextAlign="Right" 和 Horizo​​ntialAlign="Right"，它将文本一直移动到上方，覆盖我的文本框，而不仅仅是在单元格内移动。下面是窗口的 XAML。

```
<Window x:Class="MyWebKeepAliveDesktop.Login"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MyWebKeepAlive Desktop - Login" WindowStyle="None" AllowsTransparency="true" Height="200" Width="400" >

    <Border Background="#50FFFFFF" CornerRadius="7" BorderBrush="{StaticResource WindowFrameBrush}" BorderThickness="2,0,2,2">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="30" />
                <RowDefinition/>
            </Grid.RowDefinitions>
            <Border Background="{StaticResource WindowFrameBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
              CornerRadius="5,5,0,0" Margin="-1,0,-1,0" MouseLeftButtonDown="DragWindow">
                <Grid>
                    <TextBlock Foreground="White" FontWeight="Bold" VerticalAlignment="Center" Margin="10,2,10,2" 
                            Text="MyWebKeepAlive Desktop Login"/>
                    <Button Content="X" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="5" FontSize="7" 
                  Width="15" Height="15" Padding="0" Command="ApplicationCommands.Close"/>
                </Grid>
            </Border>
            <Grid Grid.Row="1" Width="350" Height="130" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Grid.RowDefinitions>
                    <RowDefinition Height="35" />
                    <RowDefinition Height="25" />
                    <RowDefinition Height="25" />
                    <RowDefinition Height="10" />
                    <RowDefinition Height="30" />
                </Grid.RowDefinitions>
                <TextBlock  TextAlignment="center" Text="Please provide your username/password that is used on the MyWebKeepAlive.com site to login." TextWrapping="Wrap" Grid.Row="0" Grid.ColumnSpan="2" />
                <TextBlock Text="Username" FontWeight="Bold" Grid.Row="1" Grid.Column="0"/>
                <TextBox Name="txtUsername" Width="150" Grid.Row="1" Grid.Column="1" />
                <TextBlock Text="Password" FontWeight="Bold" Grid.Row="2" />
                <TextBox Name="txtPassword" Width="150" Grid.Row="2" />
                <Button Name="btnLogin" Grid.Row="4" Grid.ColumnSpan="2">
                    <TextBlock Text="Login" />
                </Button>
            </Grid>            
        </Grid>
    </Border>
</Window> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T20:10:48.487

您的网格只有一列。它将需要两个来支持您为文本框设置 Grid.Column=1。因此，您需要添加一个`<ColumnDefinitions>`块。使用 XAML 现在的方式，WPF 只是将两个控件放入同一列，因此您看到的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T20:31:36.213

这就是我想出的。只是自己学习WPF。正如[PeterAllenWebb](https://stackoverflow.com/a/922906/179669)提到的，您的主要问题是您缺少`ColumnDefinitions`. 我还将`TextAlignment="Right"`属性添加到两个`TextBlocks`.

```
<Grid Grid.Row="1" Width="350" Height="130" HorizontalAlignment="Center" VerticalAlignment="Center">
            <Grid.RowDefinitions>
                <RowDefinition Height="35" />
                <RowDefinition Height="25" />
                <RowDefinition Height="25" />
                <RowDefinition Height="10" />
                <RowDefinition Height="30"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <TextBlock TextAlignment="center" Text="Please provide your username/password that is used on the MyWebKeepAlive.com site to login." TextWrapping="Wrap" Grid.Row="0" Grid.ColumnSpan="2" />
            <TextBlock Text="Username" TextAlignment="Right" FontWeight="Bold" Grid.Row="1" Grid.Column="0"/>
            <TextBox Name="txtUsername" Width="150" Grid.Row="1" Grid.Column="1" />
            <TextBlock Text="Password" TextAlignment="Right" FontWeight="Bold" Grid.Row="2" />
            <TextBox Name="txtPassword" Width="150" Grid.Row="2" Grid.Column="1"/>
            <Button Name="btnLogin" Grid.Row="4" Grid.ColumnSpan="2">
                <TextBlock Text="Login" />
            </Button>
        </Grid> 
```

# x11 - 如何让 Xorg 在 OpenSolaris 上与 Intel Q35 一起正常工作？

> ID：922844
> 
> 赞同：2
> 
> 时间：2009-05-28T19:53:17.617
> 
> 标签：x11, intel, opensolaris

OpenSolaris 似乎不支持 Intel 82Q35 芯片组。这会转化为缓慢的 Xorg，其性能会随着时间的推移而下降，甚至在全屏 gnome 控制台终端上执行 ls 也根本不可用。

我注意到 Xorg 进程和 gnome 使用了大量内存（>400Mb）（每个 gnome 应用程序>100Mb）。一旦我切换到 vesa，一切都变得更加合理 Xorg (90Mb)。但有时对于 GUI 密集型应用程序，UI 会变得很慢。

是否有任何替代方案可以使其更具响应性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-14T07:30:39.167

OpenSolaris 附带[用于英特尔芯片组的开源 Xorg 和 DRI 驱动程序](http://www.opensolaris.org/os/project/intelgraphics/)，英特尔帮助确保在 OpenSolaris 上正常运行，并且他们将 Q35 列在支持的列表中，因此它应该可以工作。开发人员在 opensolaris.org 上的[xwin-discuss 邮件列表/网络论坛中回复](http://www.opensolaris.org/os/community/x_win/discussions)[错误报告](http://defect.opensolaris.org "OpenSolaris 错误数据库")或帖子。

# c# - 测试空数组索引

> ID：922858
> 
> 赞同：7
> 
> 时间：2009-05-28T19:57:51.367
> 
> 标签：c#, arrays

事情是这样的：

```
object[] arrayText = new object[1];

if (arrayText[1] == null)
{
    MessageBox.Show("Is null");
} 
```

我们知道这将是空的，但它会抛出一个异常，但我不想在 try/catch 块中处理它，因为它嵌套在一个循环中，而 try/catch 会减慢它的速度，它也不会t 看起来真的很好：

```
object[] arrayText = new object[1];
try
{
    if (arrayText[1] == null)
    {

    }
}
catch (Exception ex)
{
    MessageBox.Show("Is null");
} 
```

谢谢你的建议！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-28T20:01:35.073

`null`不是这里的问题，而是索引无效。C# 中的数组是从 0 开始的，因此如果您创建一个包含 1 个元素的数组，`0`则只有索引有效：

```
array[0] == null 
```

您可以通过在访问索引之前手动检查边界来避免这种情况：

```
if (index < array.Length) {
    // access array[index] here
} else {
    // no exception, this is the "invalid" case
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-28T20:02:05.167

```
object[] arrayText = new object[1];

if (arrayText[0] == null)
{
    MessageBox.Show("Is null");
} 
```

试试看？数组是基于 0 的，因此尝试访问 arrayText[1] 会给您一个 OutOfBoundsException。并且 try/catch 不会真正影响你的表现，那时堆栈中没有太多东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T20:02:04.310

您正在访问数组边界之外的索引。数组初始值设定项采用一个数字表示元素的数量，而不是最大索引（如 VB.NET）。由于数组是从零开始的，因此在这种情况下，您的最大索引为 0。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T20:03:16.943

检查循环内数组的 .Length，或者更好的是，将循环参数设置为限制为数组的长度。

```
object[] arrayText = new object[1];
for (int i = 0; i < arrayText.Length; i++)
{
    doWork(arrayText[i]);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T20:12:29.403

我认为问题不在于 arrayText [1](http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx)为空，而是 arrayText [1](http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx)不存在 - 所以你应该得到一个 IndexOutOfRangeException 而不是空

如果你在一条小河上并且不能轻易更改代码来验证长度，你可以考虑添加一个检查 Length 属性的函数（见下面的片段）或[重载运算符](http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx)[] ...这两者都有点恶心，但如果你在泡菜... :)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace array
{
    class Program
    {
        static object Index(object [] array, int idx)
        {
            if (idx >= array.Length)
                return null;
            else
                return array[idx];
        }
        static void Main(string[] args)
        {
            object[] blah = new object[10];
            object o = Index(blah, 10);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T20:03:56.550

如果您阅读有关正在引发的异常的描述，您会看到它是“索引超出了数组的范围”。

`new object[1]`表示数组只有一个元素。（1 是计数）但是 C# 数组的开始索引为 0 而不是 1，因此一个元素的数组索引为 0。因此`arrayText[0]`将返回 null 但`arrayText[1]`会引发异常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-23T11:48:20.473

我最近需要找出结构数组中的值是否在给定索引处“填充”。看一下这个：

```
//the struct holding the properties:
struct Cities
        {
            public string name;

            public int inhabitansNumber;
        }

    Cities[] cities = new Cities[500]; // the struct array holding the cities

    int i = 0;
                        for (i = 0; i < cities.Length; ++i)
                        {
                            if (cities[i].Equals(default(Cities)))
                            {
                                Console.WriteLine("Please enter the city name:");
                                cities[i].name = Console.ReadLine();
                                Console.WriteLine("Please enter population:");
                                cities[i].inhabitansNumber = Convert.ToInt32(Console.ReadLine());
                                Console.WriteLine("Values added successfuly!");
                            }
                        } 
```

# vb6 - How to set the InitDir property of a CommonDialog control to My Computer

> ID：922859
> 
> 赞同：0
> 
> 时间：2009-05-28T19:58:22.863
> 
> 标签：vb6

My Google-Fu is weak today, hopefully this is a simple thing.

I need to set the InitDir property of a VB6 CommonDialog control to start at [My] Computer. If I set InitDir to an empty string, it just defaults to the current directory from the last open dialog.

My code:

```
With MyCommonDialogControl
    .DialogTitle = "Choose Import File"
    .Filter = "Import Files|*.dbf"
    .InitDir = Environ("HOMEDRIVE") //Needs to be "My Computer"
    .CancelError = False
    .ShowOpen
    If Len(.Filename) = 0 Then Exit Sub
    InputFile = .Filename
End With 
```

Thank you in advance for any assistance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:10:12.123

I've come across a couple of ways to do it - one is through the Environ method which appears to work in both VB6 and VBA - although I've never used this method, the other is through p/Invoke referencing: SHGetSpecialFolderLocation and SHGetPathFromIDList in the shell32.dll.

I didn't have the code to hand, so I've copied and pasted from another site [http://en.kioskea.net/faq/sujet-951-vba-vb6-my-documents-environment-variables](http://en.kioskea.net/faq/sujet-951-vba-vb6-my-documents-environment-variables)

I can't guarantee the correctness, but it looks very similar to code I've used in the past, so it should work with minimal debugging... anyway, at least it points you in the right direction.

```
Option Explicit
Private Type SHITEMID
    cb As Long
    abID As Byte
End Type
Private Type ITEMIDLIST
    mkid As SHITEMID
End Type
Private Const CSIDL_PERSONAL As Long = &H5
Private Declare Function SHGetSpecialFolderLocation Lib "shell32.dll" _
                        (ByVal hwndOwner As Long, ByVal nFolder As Long, _
                         pidl As ITEMIDLIST) As Long
Private Declare Function SHGetPathFromIDList Lib "shell32.dll" Alias "SHGetPathFromIDListA" _
                        (ByVal pidl As Long, ByVal pszPath As String) As Long

Public Function Rep_Documents() As String
    Dim lRet As Long, IDL As ITEMIDLIST, sPath As String
    lRet = SHGetSpecialFolderLocation(100&, CSIDL_PERSONAL, IDL)
    If lRet = 0 Then
        sPath = String$(512, Chr$(0))
        lRet = SHGetPathFromIDList(ByVal IDL.mkid.cb, ByVal sPath)
        Rep_Documents = Left$(sPath, InStr(sPath, Chr$(0)) - 1)
    Else
        Rep_Documents = vbNullString
    End If
End Function 
```

Referencing Rep_Documents() will give you a string holding the path name of the My Documents folder. It's just a case of assigning it to the file dialog's InitDir property.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T16:30:42.697

The problem is that My Computer is a [virtual folder](http://msdn.microsoft.com/en-us/library/cc144090(VS.85).aspx) which doesn't have an equivalent physical directory path. [Googling](http://www.vbmonster.com/Uwe/Forum.aspx/vb-winapi/1624/Can-you-set-an-OpenFile-dialog-s-initial-directory-to-a-virtual) turned up this below which works for me on Windows XP.

```
 CommonDialog1.InitDir = "::{20D04FE0-3AEA-1069-A2D8-08002B30309D}"
  CommonDialog1.ShowOpen 
```

[Apparently](http://www.codeproject.com/KB/system/ExplorerObjects.aspx) this is using the CLSID for the My Computer namespace. Anyone out there who can explain this stuff? I'm just posting Google results that I don't really understand :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T04:57:38.780

Back in the day a group of programmers founded the now defunct CCRP project. However, among the free downloads they have the Extended File Dialogs OCX/DLL, that give you what you want, plus one hell of a lot more.

[http://ccrp.mvps.org/index.html?http://ccrp.mvps.org/download/ccrpdownloads.htm](http://ccrp.mvps.org/index.html?http://ccrp.mvps.org/download/ccrpdownloads.htm)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-09-25T00:07:30.723

Works well, THANKS! (WinXP SP3)

```
Option Explicit '

    Private getdir As String
    '

    '

    Private Sub Command1_Click()

      Dim strFilter As String
    Dim lngFlags As Long
    strFilter = thAddFilterItem(strFilter, "Excel Files (*.xls)", "*.XLS")
    'strFilter = thAddFilterItem(strFilter, "Text Files(*.txt)", "*.TXT")
    'strFilter = thAddFilterItem(strFilter, "All Files (*.*)", "*.*")
 ' MsgBox thCommonFileOpenSave(InitialDir:=App.Path, Filter:=strFilter, FilterIndex:=3, Flags:=lngFlags, DialogTitle:="File Browser")
   MsgBox thCommonFileOpenSave(InitialDir:="::{20D04FE0-3AEA-1069-A2D8-08002B30309D}", Filter:=strFilter, FilterIndex:=3, Flags:=lngFlags, DialogTitle:="File Browser")

   Debug.Print Hex(lngFlags)
End Sub

Option Explicit

Type thOPENFILENAME
    lStructSize As Long
    hwndOwner As Long
    hInstance As Long
    strFilter As String
    strCustomFilter As String
    nMaxCustFilter As String
    nFilterIndex As Long
    strFile As String
    nMaxFile As Long
    strFileTitle As String
    nMaxFileTitle As Long
    strInitialDir As String
    strTitle As String
    Flags As Long
    nFileOffset As Integer
    nFileExtension As Integer
    strDefExt As String
    lCustData As Long
    lpfnHook As Long
    lpTemplateName As String
End Type

Declare Function th_apiGetOpenFileName Lib "comdlg32.dll" Alias "GetOpenFileNameA" (OFN As thOPENFILENAME) As Boolean
Declare Function th_apiGetSaveFileName Lib "comdlg32.dll" Alias "GetSaveFileNameA" (OFN As thOPENFILENAME) As Boolean
Declare Function CommDlgExtendetError Lib "commdlg32.dll" () As Long

Private Const thOFN_READONLY = &H1
Private Const thOFN_OVERWRITEPROMPT = &H2
Private Const thOFN_HIDEREADONLY = &H4
Private Const thOFN_NOCHANGEDIR = &H8
Private Const thOFN_SHOWHELP = &H10
Private Const thOFN_NOVALIDATE = &H100
Private Const thOFN_ALLOWMULTISELECT = &H200
Private Const thOFN_EXTENSIONDIFFERENT = &H400
Private Const thOFN_PATHMUSTEXIST = &H800
Private Const thOFN_FILEMUSTEXIST = &H1000
Private Const thOFN_CREATEPROMPT = &H2000
Private Const thOFN_SHAREWARE = &H4000
Private Const thOFN_NOREADONLYRETURN = &H8000
Private Const thOFN_NOTESTFILECREATE = &H10000
Private Const thOFN_NONETWORKBUTTON = &H20000
Private Const thOFN_NOLONGGAMES = &H40000
Private Const thOFN_EXPLORER = &H80000
Private Const thOFN_NODEREFERENCELINKS = &H100000
Private Const thOFN_LONGNAMES = &H200000

Function StartIt()
    Dim strFilter As String
    Dim lngFlags As Long
    strFilter = thAddFilterItem(strFilter, "Excel Files (*.xls)", "*.XLS")
    strFilter = thAddFilterItem(strFilter, "Text Files(*.txt)", "*.TXT")
    strFilter = thAddFilterItem(strFilter, "All Files (*.*)", "*.*")
    Startform.filenameinput.Value = thCommonFileOpenSave(InitialDir:="x:\Anlagen_PG80", Filter:=strFilter, FilterIndex:=3, Flags:=lngFlags, DialogTitle:="File Browser")
    Debug.Print Hex(lngFlags)
End Function

Function GetOpenFile(Optional varDirectory As Variant, Optional varTitleForDialog As Variant) As Variant
    Dim strFilter As String
    Dim lngFlags As Long
    Dim varFileName As Variant
    lngFlags = thOFN_FILEMUSTEXIST Or thOFN_HIDEREADONLY Or thOFN_NOCHANGEDIR

    If IsMissing(varDirectory) Then varDirectory = ""
    End If

    If IsMissing(varTitleForDialog) Then varTitleForDialog = ""
    End If

    strFilter = thAddFilterItem(strFilter, "Excel (*.xls)", "*.XLS")
    varFileName = thCommonFileOpenSave(OpenFile:=True, InitialDir:=varDirectory, Filter:=strFilter, Flags:=lngFlags, DialogTitle:=varTitleForDialog)

    If Not IsNull(varFileName) Then varFileName = TrimNull(varFileName)
    End If

    GetOpenFile = varFileName

End Function

Function thCommonFileOpenSave(Optional ByRef Flags As Variant, Optional ByVal InitialDir As Variant, Optional ByVal Filter As Variant, _
                               Optional ByVal FilterIndex As Variant, Optional ByVal DefaultEx As Variant, Optional ByVal fileName As Variant, _
                               Optional ByVal DialogTitle As Variant, Optional ByVal hwnd As Variant, Optional ByVal OpenFile As Variant) As Variant

    Dim OFN As thOPENFILENAME
    Dim strFileName As String
    Dim FileTitle As String
    Dim fResult As Boolean

    If IsMissing(InitialDir) Then InitialDir = CurDir
    If IsMissing(Filter) Then Filter = ""
    If IsMissing(FilterIndex) Then FilterIndex = 1
    If IsMissing(Flags) Then Flags = 0&
    If IsMissing(DefaultEx) Then DefaultEx = ""
    If IsMissing(fileName) Then fileName = ""
    If IsMissing(DialogTitle) Then DialogTitle = ""
    If IsMissing(hwnd) Then hwnd = 0
    If IsMissing(OpenFile) Then OpenFile = True

    strFileName = Left(fileName & String(256, 0), 256)
    FileTitle = String(256, 0)

    With OFN
        .lStructSize = Len(OFN)
        .hwndOwner = hwnd
        .strFilter = Filter
        .nFilterIndex = FilterIndex
        .strFile = strFileName
        .nMaxFile = Len(strFileName)
        .strFileTitle = FileTitle
        .nMaxFileTitle = Len(FileTitle)
        .strTitle = DialogTitle
        .Flags = Flags
        .strDefExt = DefaultEx
        .strInitialDir = InitialDir
        .hInstance = 0
        .lpfnHook = 0
        .strCustomFilter = String(255, 0)
        .nMaxCustFilter = 255
    End With

    If OpenFile Then fResult = th_apiGetOpenFileName(OFN) Else fResult = th_apiGetSaveFileName(OFN)

    If fResult Then
        If Not IsMissing(Flags) Then Flags = OFN.Flags
        thCommonFileOpenSave = TrimNull(OFN.strFile)
        Else
        thCommonFileOpenSave = vbNullString
    End If

End Function

Function thAddFilterItem(strFilter As String, strDescription As String, Optional varItem As Variant) As String

    If IsMissing(varItem) Then varItem = "*.*"
    thAddFilterItem = strFilter & strDescription & vbNullChar & varItem & vbNullChar

End Function

Private Function TrimNull(ByVal strItem As String) As String
    Dim intPos As Integer
    intPos = InStr(strItem, vbNullChar)
    If intPos > 0 Then
        TrimNull = Left(strItem, intPos - 1)
        Else
        TrimNull = strItem
    End If

End Function 
```

# asp.net-mvc - 将 WCF REST Starter Kit 与 ASP.NET MVC 一起使用

> ID：922864
> 
> 赞同：1
> 
> 时间：2009-05-28T19:59:39.243
> 
> 标签：asp.net-mvc, wcf, rest

我最近将一个 ASP.NET 网站转换为一个 ASP.NET MVC 应用程序，并且在尝试添加 > 新项目时似乎不再可以访问 WCF REST Starter Kit 模板...是否可以将两者一起使用或者是入门套件仅在网站内可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T00:17:17.243

默认情况下，WCF REST Starter Kit 模板托管在 IIS 主机中。您会在其他 Web 项目模板中找到它们。

如果您想将它们托管在 Win32 服务中，您只需更改默认主机（相同的 web.config）。

[新项目视图 http://img46.imageshack.us/img46/8372/sopic1.jpg](http://img46.imageshack.us/img46/8372/sopic1.jpg)

（fr-FR 语言，但你会明白我的意思）

# tinymce - TinyMCE：可以限制只允许子弹吗？

> ID：922871
> 
> 赞同：5
> 
> 时间：2009-05-28T20:01:39.643
> 
> 标签：tinymce

如果可能的话，我想使用 TinyMCE（所见即所得编辑器）来允许用户创建项目符号列表*和仅*项目符号列表。有人知道方法吗？

谢谢，

保罗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-29T21:37:28.987

在使用高级主题时，TinyMCE 有两个选项会有所帮助。第一个是[`theme_advanced_buttons<n>`](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration/theme_advanced_buttons_1_n)，它决定了在编辑器中显示哪些按钮。由于默认情况下高级主题将按钮定义为三行，因此您需要重新定义每一个。

第二个是[`valid_elements`](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration/valid_elements)，它可以让 TinyMCE 删除任何未列出的标签。它还可以将一个标签转换为另一个标签；例如，您可能希望将编号列表切换为项目符号列表。但是请注意，这并不是真正的安全性。您仍然需要执行服务器端检查以阻止来自恶意或不正当用户的无效输入。

如果您真的想阻止除项目符号列表之外的所有标签，您的 init 调用可能需要以下选项：

```
tinyMCE.init({
    // Select the advanced theme
    theme : "advanced",

    // Choose which buttons to show
    theme_advanced_buttons1 : "bullist",
    theme_advanced_buttons2 : "",
    theme_advanced_buttons3 : "",

    // Which html tags to allow
    valid_elements : "-ul/-ol,-li",

    // Other options, including what to make editable
    mode : ...
}); 
```

另一方面，如果您只想阻止编号列表，您的配置可能看起来更像：

```
tinyMCE.init({
    // Select the advanced theme
    theme : "advanced",

    // Choose which buttons to show
    theme_advanced_buttons1 : "separator,insertdate,inserttime,preview,zoom,separator,forecolor,backcolor",
    theme_advanced_buttons2 : "bullist,separator,outdent,indent,separator,undo,redo,separator",
    theme_advanced_buttons3 : "hr,removeformat,visualaid,separator,sub,sup,separator,charmap",

    // Which html tags to allow
    valid_elements : "@[id|class|style|title|dir<ltr?rtl|lang|xml::lang|onclick|ondblclick|" +
        "onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|" +
        "onkeydown|onkeyup],a[rel|rev|charset|hreflang|tabindex|accesskey|type|" +
        "name|href|target|title|class|onfocus|onblur],strong/b,em/i,strike,u," +
        "#p[align],-ul[type|compact]/-ol[type|compact],-li,br,img[longdesc|usemap|" +
        "src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup," +
        "-blockquote,-table[border=0|cellspacing|cellpadding|width|frame|rules|" +
        "height|align|summary|bgcolor|background|bordercolor],-tr[rowspan|width|" +
        "height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot," +
        "#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor" +
        "|scope],#th[colspan|rowspan|width|height|align|valign|scope],caption,-div," +
        "-span,-code,-pre,address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face" +
        "|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite]," +
        "object[classid|width|height|codebase|*],param[name|value|_value],embed[type|width" +
        "|height|src|*],script[src|type],map[name],area[shape|coords|href|alt|target],bdo," +
        "button,col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|" +
        "valign|width],dfn,fieldset,form[action|accept|accept-charset|enctype|method]," +
        "input[accept|alt|checked|disabled|maxlength|name|readonly|size|src|type|value]," +
        "kbd,label[for],legend,noscript,optgroup[label|disabled],option[disabled|label|selected|value]," +
        "q[cite],samp,select[disabled|multiple|name|size],small," +
        "textarea[cols|rows|disabled|name|readonly],tt,var,big",

    // Other options, including what to make editable
    mode : ...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:16:25.013

在您的 tinyMCE.init 中，将 theme-advanced-buttons1 设置为只有“bullist”。 **您还需要将 theme-advanced-buttons2、3 和 4 设置为空。** 这是一个完整的例子：

```
<html>
<head>
    <title>Application Name</title>
    <script type="text/javascript" src="tiny_mce/tiny_mce.js"></script>
    <script type="text/javascript">
        tinyMCE.init({
            // General options
            mode : "exact",
            elements: "description_edit_box",
            theme : "advanced",
            plugins : "safari,pagebreak,inlinepopups,paste,searchreplace",

            // Theme options
            theme_advanced_buttons1 : "bullist",
            theme_advanced_buttons2 : "",
            theme_advanced_buttons3 : "",
            theme_advanced_buttons4 : "",
            theme_advanced_toolbar_location : "top",
            theme_advanced_toolbar_align : "left",
            theme_advanced_statusbar_location : "bottom",
            theme_advanced_resizing : true,

            // Drop lists for link/image/media/template dialogs
            external_link_list_url : "lists/link_list.js"
        });
    </script>
</head>

<body>
<textarea id="description_edit_box" rows="5" ></textarea>
</body>
</html> 
```

# asp.net-mvc - 将 MembershipProvider 注入 ASP.NET MVC AccountController

> ID：922891
> 
> 赞同：7
> 
> 时间：2009-05-28T20:06:06.250
> 
> 标签：asp.net-mvc, dependency-injection, asp.net-membership, castle-windsor, sqlmembershipprovider

ASP.NET MVC 1.0 项目模板包含一个`AccountController`类，它支持构造函数注入：

```
public AccountController(IFormsAuthentication formsAuth, 
    IMembershipService service)
{
    FormsAuth = formsAuth ?? new FormsAuthenticationService();
    MembershipService = service ?? new AccountMembershipService();
} 
```

还包括一个`AccountMembershipService`类，它也支持构造函数注入：

```
public AccountMembershipService(MembershipProvider provider)
{
    _provider = provider ?? Membership.Provider;
} 
```

我相信你们中的许多人已经将它们用于单元测试，但我的目标是`SqlMembershipProvider`使用 Windsor 注入一个，从而在运行时使用 Windsor XML 文件而不是 web.config 对其进行配置。换句话说，**我想对`AccountMembershipService`类**使用构造函数注入，并且我想继续使用内置的 ASP.NET 2.0 Membership 系统。我只是想让会员系统的配置通过 Windsor IoC。

如果不编写我自己的 MembershipProvider，这是否可行，或者`SqlMembershipProvider`不能很好地与 IoC 配合使用？

> [来自 MSDN](https://haacked.com/archive/2007/11/27/question-for-you-dependency-injection-buffs.aspx)：“ASP.NET 调用 SqlMembershipProvider 构造函数来创建应用程序配置中指定的 SqlMembershipProvider 类的实例。此构造函数*不打算在您的代码中使用*。”

我相信[菲尔问了一个非常相似的问题](https://haacked.com/archive/2007/11/27/question-for-you-dependency-injection-buffs.aspx)，这是他收到[的答案。](https://haacked.com/archive/2007/11/27/question-for-you-dependency-injection-buffs.aspx#feedback)

谢谢你的帮助。

* * *

**更新：** 为了清楚起见，我通过 DI 提供应用程序的 MembershipProvider 的原因是为了支持多个租户。每个租户都有一个带有[ASP 成员表](https://msdn.microsoft.com/en-us/library/Aa478948.asp2prvdr0102l(en-us,MSDN.10).gif)的独立数据库。DI 允许我在运行时切换连接字符串，从而使核心应用程序不知道每个租户正在使用哪个数据库。Windsor 正在控制 DI，它“知道”哪个租户通过 url 发出请求：

```
var url = HttpContext.Current.Request.ServerVariables["HTTP_HOST"]
```

Mike Hadlow[撰写了有关这种技术](https://mikehadlow.blogspot.com/2008/11/multi-tenancy-part-2-components-and.html)的文章。我只是想融入`SqlMembershipProvider`他对这个 IoC 设计的使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T01:56:50.410

假设您的会员提供商配置如下：

```
<membership>
    <providers>
        <clear/>
        <add name="www.tenant1.com" 
         type="System.Web.Security.SqlMembershipProvider, ..." 
         .../>
        <add name="www.tenant2.com" 
         type="System.Web.Security.SqlMembershipProvider, ..." 
         .../>
    </providers>
</membership> 
```

您可以让 Windsor 选择合适的提供商，如下所示：

```
var container = new WindsorContainer();
container.AddFacility<FactorySupportFacility>();
container.Register(Component.For<MembershipProvider>()
    .LifeStyle.Transient
    .UsingFactoryMethod(() => Membership.Providers[HttpContext.Current.Request.Url.Host]));
... (your controller registrations, etc) 
```

# php - 在 PHP 中通过 FTP 获取 Mime 类型

> ID：922892
> 
> 赞同：0
> 
> 时间：2009-05-28T20:06:14.130
> 
> 标签：php, security, ftp, mime-types

我正在用 PHP 编写一个在 FTP 服务器上显示文件的对象。我正在使用 PHP 的内置 FTP 函数来检索我需要的大部分详细信息（文件名、大小、上次修改时间等）。但是，没有函数可以在服务器上获取文件的 mime 类型。我尝试了两种不同的方法，但我遇到了一些问题。

如下使用 fileinfo 需要 34 秒来获取 10 个文件的 mime 类型：

```
$finfo = new finfo(FILEINFO_MIME);
$mime_type = $finfo->file('ftp://username:password@host/path/file'); 
```

使用 mime_content_type() 做同样的事情只需要 6 秒：

```
$mime_type = mime_content_type('ftp://username:password@host/path/file'); 
```

这里有两个问题，我正在寻求帮助。首先是安全性。使用任何一种方法都会传输纯文本登录凭据（当然 FTP 本质上是不安全的，但这只会让情况变得更糟）。第二个问题更像是一个最佳实践。显然 mime_content_type() 是这两种方法中最好的，因为它的性能要好得多，但它已被弃用。有没有更好的、可能更安全的方法来做到这一点？我无法在 FTP 服务器上安装任何东西，因为它旨在用于希望使用它的任何人的 FTP 服务器，因此使用 Web 服务是不可能的。

在此先感谢，〜詹姆斯·阿姆斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T20:09:00.690

延迟的原因是您需要读取每个文件的魔术字节并使用您服务器的魔术文件来确定它是什么类型。

因此，您在 FTP 中打开传输并读取该信息，这在 FTP 中并没有那么快。

# c# - 如何打印全尺寸的 A4 页面？

> ID：922894
> 
> 赞同：2
> 
> 时间：2009-05-28T20:06:42.130
> 
> 标签：c#, printing, pdf-generation

我需要在 A4 页面上打印 24 个标签 (37x70mm)。

我为 A4 页面大小的表格生成 html。

我试图从浏览器打印页面但没有成功：尽管我将上边距设置为 0（对于 html 页面和浏览器也是），但页面并没有从顶部开始。

我试图用 abcpdf 生成一个 pdf 文件，这里成功了一半，页面从顶部开始，但它不打印底部边距。

任何想法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-29T20:56:04.153

**我找到了一个使用 abcpdf 从 html 页面生成 pdf 的解决方案**：

```
thedoc.mediabox.string = "A4";
thedoc.rect.string = thedoc.mediabox.string; 
```

使用此设置生成的 pdf 具有 A4 页面大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:51:48.140

使用 HTML 或 HTML/CSS 没有简单的方法可以做到这一点。

我建议使用[PrinceXML](http://www.princexml.com/)，它可以处理丰富的 XML 词汇以及 XHTML / CSS。他们甚至从其 pdf 输出中出版了一本书。它还用于 Google Documents 以生成 PDF。

[它的维基百科页面](http://en.wikipedia.org/wiki/Prince_XML)上有很好的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T00:08:52.047

您确实需要将其生成为 PDF 以获得标签的准确边距等。

另请记住，当您使用 PDF 打印时，它具有缩放模式，可以缩小页面以适应页边距，您要么必须告诉用户禁用它，要么您必须满足这一点。

至于不打印下边距，也许您的打印机打印不那么远？我知道我拥有的大多数底部边距比顶部和侧边距要大。

这是 PDF 库的列表：

[https://stackoverflow.com/questions/373926/lightweight-open-source-pdf-library-in-c](https://stackoverflow.com/questions/373926/lightweight-open-source-pdf-library-in-c)

# vba - 如何处理模态用户窗体？

> ID：922896
> 
> 赞同：0
> 
> 时间：2009-05-28T20:06:54.783
> 
> 标签：vba, excel, excel-2007

我有一个 ShowModal 设置为 True 的用户窗体。我想将对话框用作表单和进度条，因此在用户单击“确定”后，表单应保留在屏幕上，但代码应继续在后台执行。这样做的最佳方法是什么？

目前，我有两种形式，一种是用户输入数据，另一种是进度条。为简单起见，我更愿意将它们合并为一种形式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T18:31:35.737

一种方法是在主窗体中添加进度条控件。（要在 Excel 中执行此操作，请在表单编辑器中右键单击工具箱并选择添加控件。然后选择 Microsoft Progress Control 6.0 (SP6)。选择后，您可以像添加任何其他控件一样添加它。）

从那里您只需从有问题的用户表单中调用代码，这将保持表单正常运行。然后，如果您想更新进度，您可以将控件传递给 sub（还有其他方法，这只是懒惰的方法）。

```
Private Sub CommandButton1_Click()
    Module1.MyCode Me.ProgressBar1
End Sub

Public Sub MyCode(ByRef progress As MSComctlLib.ProgressBar)
    'Do stuff
    progress.value = progress.value + 10
    'Do more stuff
    progress.value = progress.value + 50 'It was a lot of stuff
    'And so on.
End Sub 
```

# python - NameError 在 python 中使用 execfile

> ID：922897
> 
> 赞同：4
> 
> 时间：2009-05-28T20:07:09.353
> 
> 标签：python, class, scope, namespaces

*我的应用程序有一个按钮，可以使用execfile*动态执行 python 脚本。如果我在脚本中定义一个函数（例如*spam()*）并尝试在另一个函数中使用该函数（例如*egg()*），我会收到此错误：

```
NameError: global name 'spam' is not defined 
```

从*egg()调用**spam()*函数的正确方法是什么？

 *```
#mainprogram.py
class mainprogram():
    def runme(self):
        execfile("myscript.py")

>>> this = mainprogram()
>>> this.runme()

# myscript.py
def spam():
    print "spam"

def eggs():
    spam()

eggs() 
```

此外，我似乎无法从脚本中的主应用程序执行方法。IE

```
#mainprogram.py
class mainprogram():
    def on_cmdRunScript_mouseClick( self, event ):
        execfile("my2ndscript.py")
    def bleh():
        print "bleh"

 #my2ndscript.py
 bleh() 
```

错误是：

```
NameError: name 'bleh' is not defined 
```

从*my2ndscript.py*调用*bleh()*的正确方法是什么？

 ***编辑**：更新第一期

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-06T05:38:23.457

自从您发布以来，您已经聪明了 3 年 8 个月，所以我假设您已经解决了第一个问题，但鉴于尚未发布解决方案（主要是因为似乎没有人对第一个问题有任何问题)，以下是我的解决方案。

## [更新]

我提供的最后一个解决方案不正确。下面我提供了正确的解决方案，并使用我执行的代码对其进行了详细解释。

**这个问题是 Python`execfile()`内置的。这是该函数在 Python 3.x 中已被弃用的原因之一。**

当您在`execfile()`内部执行时`runme()`，对象`spam()`和`eggs()`被加载到方法`runme()`的名称空间，而不是全局名称空间*（理想情况下应该如此）*。考虑以下代码：

# 我的脚本.py

```
def spam():
    print 'spam'

def eggs():
    if 'spam' not in globals():
        print 'method spam() is not present in global namespace'
    spam()

try:
    eggs()
except Exception as e:
    print e 
```

# 主程序.py

```
class mainprogram():
    def runme(self):
        execfile("myscript.py")
        print 'Objects lying in local namespace of runme() are -'
        print locals()

this = mainprogram()
this.runme() 
```

# 解释器输出

```
>>>import mainprogram
method spam() is not present in global namespace
name 'spam' is not defined
Objects lying in local namespace of runme() are -
{'e': NameError("name 'spam' is not defined",), 'spam': <function spam at 0x000000000000002B>, 'eggs': <function eggs at 0x000000000000002C>, 'self': <mainprogram.mainprogram instance at 0x000000000000002D>} 
```

从输出中您可以看到它`spam()`不在全局命名空间中，而是在 method`runme()`的命名空间中。所以假设，正确的调用方式`spam()`是

```
def eggs():
    global this
    this.runme.spam() 
```

`spam()`但是，当它位于的命名空间内时，无法访问`runme()`。因此，解决方案是`spam()`在全局命名空间中插入如下：

# 我的脚本.py

```
global spam
def spam():
    print "spam"

def eggs():
    spam()

eggs() 
```

这将确保`spam()`在字典（即全局命名空间）内创建对对象的引用`globals()`，使其可从`eggs()`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-12-09T16:38:09.753

***Addy689 解释了真正的问题：它是在从函数***调用 execfile()时出现的。execfile() 在全局空间中运行良好。这就是为什么答案通常是“对我来说有效”。

但是修改被调用脚本的解决方案可能是不可能的。所以我在这里报告我认为最好的解决方案，在 exec() 函数的另一个等效问题上发现（在那篇文章中：[https](https://stackoverflow.com/a/11754346/1808778) ://stackoverflow.com/a/11754346/1808778 ）。它与 execfile() 相同

```
def callingFunction(filename)
    # ... 
    d = dict(locals(), **globals())
    execfile(filename, d, d ) 
```

该解决方案的优点是我们不需要知道被调用的脚本：执行的是在*if **name** == **main***中命名的函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T09:23:23.397

在第二种情况下，您将需要`import`（不确定“mainprogram.py”是否在您的`$PYTHONPATH`）

```
#mainprogram.py
class mainprogram:
    def runme(self):
        execfile("my2ndscript.py")
    def bleh(self):
        print "bleh"
if __name__ == '__main__':
    mainprogram().runme()

#my2ndscript.py
import mainprogram
x = mainprogram.mainprogram()
x.bleh() 
```

但这将创建`mainprogram`. 或者，更好的是：

```
#mainprogram.py
class mainprogram:
    def runme(self):
        execfile("my2ndscript.py", globals={'this': self})
    def bleh(self):
        print "bleh"
if __name__ == '__main__':
    mainprogram().runme()

#my2ndscript.py
this.bleh() 
```

我想这`execfile`无论如何都不是解决您问题的正确方法。你为什么不使用`import`or `__import__`（`reload()`如果脚本在这些点击之间发生变化）？

```
#mainprogram.py
import my2ndscript

class mainprogram:
    def runme(self):
        reload(my2ndscript)
        my2ndscript.main(self)
    def bleh(self):
        print "bleh"

if __name__ == '__main__':
    mainprogram().runme()

#my2ndscript.py
def main(program):
    program.bleh() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T20:13:07.327

您确定您发布了您遇到问题的实际代码吗？第一个脚本对我来说很好。

第二个错误是意料之中的：名称“bleh”未定义在外部块中，仅在“mainprogram”的命名空间内

# email - 在 HTML 电子邮件中嵌入附加图像

> ID：922898
> 
> 赞同：19
> 
> 时间：2009-05-28T20:07:16.467
> 
> 标签：email, mime

如果我将图像附加到电子邮件中，如何将其放置在 HTML 内容中？我尝试只使用文件名作为图像源，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T20:09:57.663

更具体地了解如何构建 HTML 邮件消息。

结果将是一个多部分 MIME 消息，其中包含一个 text/html 部分（如果您真的使用 text/plain 类型的替代部分正确地做到了）和几个图像，然后从 HTML 中引用这些图像。

请参阅[RFC 1813](http://www.faqs.org/rfcs/rfc1873.html)和[RFC 2378](http://www.faqs.org/rfcs/rfc2387.html)，了解有关混合 MIME 和相关数据中的 content-id 的更多信息（在 HTML 源中由 CID 引用）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-03-14T15:19:34.610

您可以对标签的`src="cid:bgBoletin"`属性使用相同的方式。`img`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-17T11:48:31.107

您的问题的答案在[此处](http://static.springsource.org/spring/docs/1.1.4/api/org/springframework/mail/javamail/MimeMessageHelper.html)的春季文档中。

```
 mailSender.send(new MimeMessagePreparator() {
   public void prepare(MimeMessage mimeMessage) throws MessagingException {
     MimeMessageHelper message = new MimeMessageHelper(mimeMessage, true, "UTF-8");
     message.setFrom("me@mail.com");
     message.setTo("you@mail.com");
     message.setSubject("my subject");
     message.setText("my text <img src='cid:myLogo'>", true);
     message.addInline("myLogo", new ClassPathResource("img/mylogo.gif"));
   }
 }); 
```

消息的正文是多部分消息的一部分（请注意，在将消息设置为多部分消息的 MimeMessageHelper 的构造函数上设置为 true 的第二个参数）。

该行将`message.addInline("myLogo"...`图像添加为多部分消息的另一部分。

您可以使用`.setText`来设置电子邮件的正文（HTML 内容）。

您可以使用标签 cid 引用多部分电子邮件的其他部分（您的图像）。注意 img src 属性是怎样的`src='cid:myLogo'`。cid 是图像的内容 ID，作为多部分消息的一部分发送。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-09-19T12:12:31.700

图片附件部分需要 Content-ID

```
--T4nu9J8b
Content-Type: image/png
Content-ID: <idname>
Content-Transfer-Encoding: base64
Content-Disposition: attachment ;filename="testimage.png"

iVBORw0KGgoAAAANS...
--T4nu9J8b-- 
```

> 注意：内容 ID 名称应放在尖括号中，如给定

使用相同的 Content-ID 将其嵌入到标签中（不带尖括号）

```
<img alt="Embedded Image" src="cid:idname"/> 
```

这应该允许附加图像显示到 HTML 中！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-03-14T15:13:48.353

我正在这样做

```
_mime = new MimeMultipart();
BodyPart messageBodyPart = new MimeBodyPart();
messageBodyPart = new MimeBodyPart();
DataSource fds = new FileDataSource("C:\\bgBoletin.jpg");

messageBodyPart.setDataHandler(new DataHandler(fds));
messageBodyPart.setHeader("Content-ID", "<bgBoletin>");
_mime.addBodyPart(messageBodyPart); 
```

并且在 HTM 文件中以这种方式引用 de Content-ID 背景：url(cid:bgBoletin)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-09-28T11:39:23.447

选项 01：
- 将文件“mySignaturePictue.jpg”作为附件附加到邮件中
- 从正文中引用此附件（插入它），代码如下：
`<img src="cid:mySignaturePicture.png">`

选项 02：
- 将您的图像转换为 base64 字符串：[http://www。 motobit.com/util/base64-decoder-encoder.asp](http://www.motobit.com/util/base64-decoder-encoder.asp)
- 将其插入到 mailtext/html-body 中，代码如下
`<img alt="My Image" src="data:image/jpeg;base64,AWWhcalkjsd/beginning/RXhp/of+/long/base64cod/ZgAATU0/+BlaBlubbZ5u8/61a+Xand/much/more..." />`
- 缺点：这被大多数客户端阻止并且会增加邮件大小，请参阅：[https://www。 campaignmonitor.com/blog/email-marketing/2013/02/embedded-images-in-html-email/](https://www.campaignmonitor.com/blog/email-marketing/2013/02/embedded-images-in-html-email/)和[https://www.paperstreet.com/blog/email-marketing-embeded-images-cid-what-a -混乱/](https://www.paperstreet.com/blog/email-marketing-embeded-images-cid-what-a-mess/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-28T20:10:44.307

如果这与从您正在开发的网站发送电子邮件有关，只需将图像保存在您的服务器上，然后使用`<img src="url"/>`.

# objective-c - 判断 NSArrayController 何时完成从持久存储中加载其内容的正确方法是什么？

> ID：922913
> 
> 赞同：3
> 
> 时间：2009-05-28T20:13:13.443
> 
> 标签：objective-c, cocoa, nsarraycontroller

了解绑定到核心数据存储的阵列控制器何时完成加载其内容的最佳方法是什么？

我有一些方法（即 awakeFromNib）依赖于具有其内容的数组控制器，但大多数时候，当在该对象上调用 awakeFromNib 时，数组控制器还没有其内容。

我想延迟我的行动，直到我知道控制器拥有它的所有内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T20:25:28.317

将代码移到`-windowDidLoad`通常是一个安全的选择，它是在窗口完全加载后调用的，`-awakeFromNib`而不是你可能遇到问题的地方，因为在你的 nib 中的所有对象上调用它的顺序没有定义。

一般来说，最好记下您正在执行的所有初始化、哪些部分需要 UI 才能正常工作、哪些部分可以延迟到用户执行操作等。例如，最好将诸如获取核心数据之类的任务延迟到最后一分钟，以防您有一个窗口在用户请求之前没有打开。另一方面，有时您将使用像大纲视图这样的对象，该对象需要预先填充其数据源以使持久性方法起作用。

一旦你知道你在做什么以及需要按照什么顺序完成，你可以选择一些 init、awakeFromNib、yyyWillLoad 或 xxxDidLoad 的组合，你会在他们有机会之前处理很多这样的错误造成麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:19:07.940

有关此问题的讨论，请参见[Theocacao](http://theocacao.com/document.page/305)

# sql - SQL：查询视图 - 执行缓慢

> ID：922915
> 
> 赞同：0
> 
> 时间：2009-05-28T20:14:03.707
> 
> 标签：sql

Sql新手在这里。如果您运行一个连接两个表和一个视图的查询。如果视图由三个表组成。它会减慢查询速度吗？有没有办法加快速度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:18:42.870

视图并不比写出 SQL 更昂贵，有时甚至更快。数据库知道视图，并且可以缓存其执行计划。

但是查询两个表比查询五个表要慢，无论三个附加表是否在视图中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:19:15.523

根据您有限的输入，唯一的答案是：确保正在使用索引

# c# - C# 泛型 - 语法帮助

> ID：922916
> 
> 赞同：0
> 
> 时间：2009-05-28T20:14:49.900
> 
> 标签：c#, .net, generics, syntax

我似乎可以找到的唯一 C# 泛型解释进入“列表`<T`>”讨论并在那里结束。我正在寻找更深入的东西，特别是在处理`<T`> in 方法签名时——我有时会看到一些非常疯狂的语法，并且无法理解为什么以及何时使用它。我觉得如果我能更好地掌握泛型，我有时可以更聪明或更有效地做某些事情。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T20:18:10.983

[在 C# 泛型的 MDSN 部分](http://msdn.microsoft.com/en-us/library/512aeb7t(VS.80).aspx)中进行了非常全面的介绍

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T20:21:07.093

我强烈推荐 O'Reilly 的[C# 3.0 in a Nutshell](http://oreilly.com/catalog/9780596001810/)。它提供了对泛型、典型使用场景和语法复杂性的非常详细的讨论。

# iphone - 0xE800003a 尝试在我的设备上安装第二个应用程序时出错

> ID：922917
> 
> 赞同：2
> 
> 时间：2009-05-28T20:14:57.823
> 
> 标签：iphone

0xE8000003A 错误：

我已经开发 AppOne 好几个星期了。我可以在模拟器和设备上进行调试。

我现在想开发一个小型测试应用程序 AppTwo ，它具有稍后将移植到 AppOne 的功能。这涉及到 TextView 的文本输入，所以我肯定想在设备上尝试 AppTwo。

我可以很好地使用模拟器，但是每次我尝试在设备上加载 AppTwo 时都会收到 0xE8000003A 错误：我清理了所有内容，我删除了构建文件夹，但仍然出现此错误。

我一直在使用的我的配置文件 (PP) 使用了以下 appID：2QUXJRP5YK.com.CompanyName.AppName

我最近去了门户网站并创建了一个新的 PP 希望解决这个程序新 PP 有 appID : 2QUXJRP5YK.com.CompanyName.*

据我了解，此 PP 将允许我将 PP 用于任意数量的应用程序，而不仅仅是名为 AppName 的应用程序

在 Organizer 中，我现在在 Provisioning Profile 列表框中列出了两个 PP。我相信这意味着两个 PP 都已加载到设备上。

我将 Entitlements.plist 从 AppOne proj 复制到 AppTwo proj 文件夹。

构建配置页面 1，对于通过 CodeSigning 实现的架构，AppOne 和 AppTwo 之间的差异为零。

由于 AppTwo 仍然可以正常工作，看来我不想重置我的设备，而是以某种方式为 AppTwo 设置项目配置。

请问你有什么建议给我吗？

非常感谢，马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T20:40:45.353

昨晚我遇到了同样的错误，并与之斗争了几个小时。我最终再次从头开始创建项目，交叉手指，它同步了。由于它是一个简单的测试应用程序，我会尝试创建一个新的同步虚拟项目，然后将您的代码复制到其中。不需要很长时间，它可能会神奇地让事情为你工作。

另外，我相信在您开始分发之前不需要 Entitlements.plist。换句话说，你可以通过 XCode 将它安装在没有它的设备上。

另一方面，当我第一次开始开发时，我 100% 的时候都会遇到这个错误。有时由于我的 iPhone 上的引脚坏或脏，它会失去连接（当我拿起它进行测试时会发生这种情况）。现在，我确保它已连接到管理器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-04T04:35:17.613

有时在为新应用添加权利/捆绑标识符/配置后，最好退出 Xcode 并重新启动。这是我不用拔头发就能让 Apple 的样本运行的唯一方法。我添加了 Bundle Identifier，我在 Build Info 窗口中更改了代码签名设置，退出并重新启动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-15T11:16:15.430

[取自Unity 社区](http://forum.unity3d.com/viewtopic.php?t=23479&view=previous&sid=c849c67c624579bdc3983c4558d4cf7b)的用户 Rapzid ：

在 Xcode 中，右键单击目标并在常规（？）选项卡下，您将看到有关开发人员或捆绑标识符的行。你需要确保它是正确的。如果您重新启动 xcode/unity/您的 iphone，它可能会停止这样做。否则，每次从统一构建时，您都必须手动更改它。

确保您的捆绑标识符设置为统一的。它在 edit->something->Player 下。然后在右侧主窗格中，您将看到捆绑标识符行。

此外，如果您的应用程序 ID 没有使用通配符，您将需要一个新的配置文件。

# networking - BGP 路径属性类型 18 指的是什么？

> ID：922920
> 
> 赞同：0
> 
> 时间：2009-05-28T20:15:38.540
> 
> 标签：networking, routing, network-protocols, packet, bgp

有谁知道 Path Attribute Type 18 指的是什么以及如何解析它？我能理解的最好的是它是一个新的 AGGREGATOR（类型 7），我假设它正在读取新的 AS32 格式，但这并没有削减它，因为我无法解析这个数据包。是否有描述其工作原理的 RFC……是 CISCO 或其他网络供应商引入的特殊内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T06:57:35.580

[在此处](http://opm.twnic.net.tw/6th/doc/routing/r2.pdf)找到描述新路径属性影响的资源

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T12:44:28.543

是的，你是对的：属性 18 是 RFC 4893 中描述的 AS4_AGGREGATOR。它带有一个 4 字节的 AS 编号。我已经看到由 Cisco 和 Juniper 路由器生成的具有该属性的更新，并且从未注意到任何不符合 RFC 的异常情况。如果您发布给您带来麻烦的该数据包的十六进制转储，我可以尝试为您解码...

# perl - 设置 Perl 脚本的有效组 id

> ID：922921
> 
> 赞同：5
> 
> 时间：2009-05-28T20:15:47.963
> 
> 标签：perl, bash

我有文件权限问题，我想解决这些问题，而无需使所有内容都可写。

我正在将文件写入 NetApp SAN。我正在写入的目录归`devel`用户所有，并且有一组`devel`具有组可写权限（`0775`）。我写的用户名在`username`和`devel`组中。

问题似乎是 SAN 只检查第一组，所以我的权限被拒绝。如果我使用`newgrp`or`sg`命令将我的组更改为`devel`，那么我可以写入目录。

尝试编写的脚本是用 Perl 编写的，但它是通过 ssh 和一些 bash 脚本从另一台机器远程启动的。

我无法将目标目录更改为`username`组中，因为还有其他开发人员并且他们在不同的组中（但我们都共享`devel`组）。

我无法将 Perl 脚本本身设置为 setgid，因为我们使用适当的组运行不同的环境（开发、测试、qa、生产等），并且我不想在该级别管理文件权限位。

我不能`setgid`在 Perl 脚本中使用 POSIX 函数，因为它不是以 root 身份启动的（而且我无法获得 root 权限），所以我的权限被拒绝。分配给`$)`并`$(`给出相同的结果。

我不能使用[`newgrp`](http://www.linuxmanpages.com/man1/newgrp.1.php)来自 bash 的命令，因为`newgrp`它不接受任何参数，它只是启动一个新的交互式 shell（在新 shell 退出后执行任何以下命令）。

我也不能[`newgrp`](http://www.linuxmanpages.com/man1/newgrp.1.php)用来启动一个新的 shell 并从那里生成 Perl 脚本，因为 Perl 脚本是通过 ssh 连接在远程机器上执行的。该脚本将在我的默认组下的远程计算机上获得一个“新”外壳，而不是`newgrp`在本地计算机上设置的组。

我不能使用该`sg`命令，因为它只需要一个参数。我引用了完整的命令行，包括已知参数。`"$@"`但是，我们通过 ssh 启动远程进程的方式包括在bash 变量中传递本地参数。换句话说，我可以执行`process start`or `process stop`，`process`脚本处理`ssh`命令并传递我使用`"$@"`. 我尝试过编写一个包装器，但发现我们使用了各种有趣的本地参数形式，并且不愿深入必要的引用和逃避噩梦。

所以，我的问题是：是否有人知道通过 Perl 或 bash 为正在运行的进程设置有效组 ID 的其他方法？是否存在多参数形式`sg`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T22:26:30.040

在你的 Perl 脚本的顶部，你不能把这个：

```
if ( 0+$( != DEVEL_GROUP_ID ) { # primary group isn't devel
  my(@reinvoke) = ($0, map {quotemeta} @ARGV);
  exec('/usr/bin/sg', 'devel', "@reinvoke");
  die("/usr/bin/sg not found!  Can't change group!");
} 
```

也就是说，让 Perl 对 sg 进行必要的调用。

# database - oracle 什么时候停止 9i 数据库？

> ID：922923
> 
> 赞同：2
> 
> 时间：2009-05-28T20:16:07.477
> 
> 标签：database, oracle, oracle9i

Oracle 9i 数据库开始看起来很长。Oracle 何时会停止对它的支持？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T20:23:41.143

我想[这](http://www.oracle.com/support/library/brochure/lifetime-support-technology.pdf)就是你要找的。他们似乎从未打算完全放弃对它的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:25:05.073

ORACLE 说首要支持将于 2007 年 7 月结束，但[持续支持](http://www.oracle.com/support/lifetime-support-policy.html)永无止境。我不确定扩展支持。听说明年七月结束。

# text - 文本边界分析资源

> ID：922924
> 
> 赞同：0
> 
> 时间：2009-05-28T20:16:14.793
> 
> 标签：text, text-segmentation

我需要在我的项目中进行“文本边界分析”。

我记得有一个来自谷歌的资源可能有助于完成这项工作，但我不太记得名称或下载位置。

我记得这个资源是来自google搜索的集合统计数据，它可能包含很多人们在搜索引擎上用作关键字的词。（实际上，我不确定该资源中有什么，因为我很久以前读过这篇文章，但我确信该资源可用于查找文本边界。）

有人知道吗？

顺便说一句，是否有任何其他资源可能有助于文本边界分析？

（Alex Martelli：我尝试过 ICU 和 Java，但他们在任何一种东方语言中都找不到单词。）

（dwc：非常感谢，这可能会有所帮助。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:22:18.730

在[这个 ICU 页面](http://userguide.icu-project.org/boundaryanalysis)和[这个 Java](http://icu-project.org/docs/papers/text_boundary_analysis_in_java/)页面中对一般问题进行了很好的报道，但我相信这两个页面都没有提到你记得的资源。

# git - 什么时候需要 git-rebase？

> ID：922933
> 
> 赞同：17
> 
> 时间：2009-05-28T20:18:28.767
> 
> 标签：git, version-control, rebase

每次我阅读 git-rebase 文档时，我都会迷路。对我来说，这感觉像是一种低级操作（阅读：黑魔法）。

引用文档：

> 假设存在以下历史并且当前分支是“主题”：
> 
> ```
>  A---B---C topic
>       /
>  D---E---F---G master 
> ```
> 
> 从这一点来看，以下任一命令的结果：
> 
> ```
> git rebase master 
> git rebase master topic 
> ```
> 
> 将会：
> 
> ```
>                A'--B'--C' 主题
>               /
>  D---E---F---G主
> 
> ```

问题是：**为什么有人想做这样的事情？**

一方面，它似乎在“重写”历史，好像分支开始于不同的点；本质上，提交历史将是“一堆谎言”。

还有一点，感觉不安全。我试过一次，有很多冲突，一切都乱套了。我不记得我到底是如何解决这个地狱的，但如果我没记错的话，它是在一个临时的测试分支或类似的地方。

另一个问题：**我是否因为不知道如何使用而错过了一些非常酷/省时的功能`git-rebase`？**

### 编辑：

> 相关问题：[撤消 git rebase](https://stackoverflow.com/questions/134882/undoing-a-git-rebase)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T20:36:20.683

例如，当您想提交一个补丁到其他人修改的代码时，您需要使用它。例如，如果您从一个软件的 1.56 版分支出来，而同时维护者移到了 1.57 版，他/她可能只接受 1.57 版的补丁。

你可以将你的分支变基到 1.57 版，更正所有冲突，验证并重新提交补丁。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-28T21:58:15.633

首先，git中没有不安全的操作。rebase 有一个 abort 操作，所有操作都进入 reflog，因此您可以撤消任何操作。事实上，情况恰恰相反。

它使您可以随时随意提交，而无需在制作过程中进行“良好”构建。*您发布*的修订可以通过将您在此过程中采取的所有步骤压缩到单个提交中来保持干净。

我一直在使用 rebase（经常通过 pull ，我通常配置为在 fetch 阶段之后 rebase）。不要将其视为改写历史——将其视为为您提供一种工具，让您在发布草稿之前对其进行清理。

从现在开始的一年后，您项目中的任何人都知道您真正开始此功能是针对修订`E`而不是修订是否重要`G`？

不必要的递归合并掩盖了历史中更重要的部分。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-28T20:26:51.200

一旦您将“主题”合并回“主”，无论如何您都会遇到这些冲突。因此，最好不时将“主题”重新定位为“主”（如果你做小步骤比做一大步更容易 - 至少在imo中）。如果你在合并之前变基，所有“有风险”的事情都会发生在分支中，之后合并很容易。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-30T12:04:18.700

请参阅[git rebase：让您的分支保持最新](http://jbowes.wordpress.com/2007/01/26/git-rebase-keeping-your-branches-current/)的 James Bowes 博客文章

# sql-server - SQL Server 2008 控制服务器权限

> ID：922936
> 
> 赞同：3
> 
> 时间：2009-05-28T20:18:54.820
> 
> 标签：sql-server, sql-server-2008

sql server 2000 中的 sp_password 存储过程只需要 db_accessadmin db_securityadmin 数据库角色的成员身份和 securityadmin 服务器角色的成员身份，以允许用户在不知道旧密码的情况下更改密码。但是在 sql server 2005/2008 中，BOL 说用户现在需要“控制服务器”权限才能执行此操作。CONTROL SERVER 权限究竟赋予用户什么权力？

更新：我发现了这个：

> CONTROL SERVER 是 SQL Server 2005 的新权限，它授予与 sysadmin 固定服务器角色成员相同的访问权限。- [http://www.sqlservercentral.com/blogs/brian_kelley/archive/2009/02/24/detecting-when-a-login-has-implicit-access-to-a-database.aspx](http://www.sqlservercentral.com/blogs/brian_kelley/archive/2009/02/24/detecting-when-a-login-has-implicit-access-to-a-database.aspx)

更新：原来文档是错误的。就像 SQL Server 2000 一样，SQL Server 2008 sp_password 似乎仍然只需要 db_accessadmin 和 db_securityadmin 数据库角色的成员身份以及 securityadmin 服务器角色的成员身份，以允许用户在不知道旧密码的情况下更改密码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T20:28:42.600

[请参阅此 MSDN 页面](http://msdn.microsoft.com/en-us/library/ms186717.aspx)上受 CONTROL SERVER 影响的特定安全对象的列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-25T12:19:29.993

在此博客上，我对 CONTROL SERVER 与 sysadmin 的安全含义进行了比较的完整描述：[“CONTROL SERVER vs. sysadmin/sa：权限、系统过程、DBCC、自动模式创建和权限提升 - 警告”](http://www.insidesql.org/blogs/andreaswolter/2013/08/control-server-vs-sysadmin-sa-permissions-privilege-escalation-caveats)。

需要注意的是，具有 CONTROL SERVER 的主体可以轻松地将他的权限提升到 sysadmin，这也显示在此处。

加上仍然需要“sysadmin”-server 角色的所有程序的列表。

# .net - (.NET) 在构建插件时如何处理相同类型的两个版本？

> ID：922941
> 
> 赞同：2
> 
> 时间：2009-05-28T20:19:34.833
> 
> 标签：.net, plugins

我们正在为使用最新版本的商业 UI 框架的商业应用程序构建一个插件。我们的插件引用了同一框架的不同（旧）版本以及它插入的应用程序的 API dll。我们现在在加载商业应用程序的某些部分时在运行时遇到重复类型冲突 (CS0433)。

这是（或多或少）的情况：

[http://img39.imageshack.us/img39/769/conflictingreferences.jpg](http://img39.imageshack.us/img39/769/conflictingreferences.jpg)

任何人都知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:23:54.310

通用UI从何而来，升级难度有多大？

在我看来，这似乎是最好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T01:57:07.167

我不认为 .NET Framework（至少到 3.5）实际上可以将单个程序集的两个不同版本加载到应用程序中。我相信我在某处读到 4.0 可能在该领域具有一些额外的功能，但我不一定会指望它。

唯一可行的方法是加载插件的应用程序将它们加载到单独的 AppDomains 中，但我假设您无法控制加载应用程序。

总而言之，我认为没有升级您用于实现插件的库版本，我认为您目前无法解决此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T20:23:23.750

在应用程序配置文件中使用策略或重定向来告诉框架使用新版本代替插件请求的旧版本。

[MSDN 对此有一些信息](http://msdn.microsoft.com/en-us/library/7wd6ex19.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T20:57:42.733

[我在预编译的 ASP.NET 2.0 站点上](https://stackoverflow.com/questions/440675/compile-error-cs0433-on-pre-compiled-asp-net-2-0-site/932840#932840)回答了这个问题 Compile Error CS0433

您可以在代码中使用 extern 和 alias 关键字，并在引用程序集时指定新的（默认全局除外）别名。

```
extern alias global2;
using global2::System; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T23:03:05.937

是的，你正在寻找标题中的动态信息，因为它说的是“建筑”，这让我感到震惊。

您是否尝试过[此 app.config](http://msdn.microsoft.com/en-us/library/cd71chf0.aspx)设置？

```
<configuration> Element
  <runtime> Element
    <assemblyBinding> Element for <runtime>
      <qualifyAssembly> Element

<qualifyAssembly partialName="PartialAssemblyName"
                                  fullName="FullAssemblyName"/> 
```

[这个](http://msdn.microsoft.com/en-us/library/eftw1fys(VS.100).aspx)怎么样？

```
<configuration>
   <runtime>
      <assemblyBinding>
         <dependentAssembly>
<bindingRedirect  
   oldVersion="old assembly version"
   newVersion="new assembly version"/> 
```

假设您已经尝试过 Assembly::Load，替代 Assembly.LoadWithPartialName，两者都应该允许您在不指定任何版本信息的情况下加载。

你读过[Dave Grimes](http://www.grimes.demon.co.uk/) [的融合](http://www.grimes.demon.co.uk/workshops/fusionWS.htm)[研讨会吗？](http://www.grimes.demon.co.uk/workshops.htm) 它非常全面，深入探讨了如何管理 CLR 的类型解析系统。他还有一个很好的安全性和 .net 工具研讨会可供启动。

# java - split() 方法失败

> ID：922942
> 
> 赞同：1
> 
> 时间：2009-05-28T20:20:16.207
> 
> 标签：java, split

我正在阅读具有以下格式的文本文件：

```
Room1*Exposition*Work 1 | Work 2 | Work 3 | Work n
Room2*Exposition*Obra 1 | Work 2 | Work 3 | Work n 
```

使用以下内容：

```
try {

            String path="contenidoDelMuseo.txt";
            File myFile = new File (path);
            FileReader fileReader = new FileReader(myFile);

            BufferedReader reader = new BufferedReader(fileReader);

            String line = null;

            while ((line=reader.readLine())!=null){

            String [] fields = line.split("\\*");

} 
```

每次我尝试访问时都会引发 IndexOutOfBoundsException `fields[1]`。为什么？

编辑：类的整个代码是

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * Buscar.java
 *
 * Created on 23/04/2009, 06:22:54 PM
 */

package interfaces;

import java.io.File;
import java.io.FileReader;
import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.ArrayList;

/**
 *
 * @author Alirio
 */
public class Buscar extends javax.swing.JFrame {

    static ArrayList<String>obras = new ArrayList<String>();
    static ArrayList<String>salas = new ArrayList<String>();
    static ArrayList <String> exposiciones = new ArrayList <String>();

    /** Creates new form Buscar */

    public Buscar() {
        initComponents();

        try {

            String ruta="contenidoDelMuseo.txt";
            File myFile = new File (ruta);
            FileReader fileReader = new FileReader(myFile);

            BufferedReader reader = new BufferedReader(fileReader);

            String line = null;

            while ((line=reader.readLine())!=null){

                System.out.println(line);
            String []camposABuscar = line.split("\\*");
            salas.add(camposABuscar[0]);

            System.out.println(camposABuscar[0]);
            System.out.println(camposABuscar[1]);
            //System.out.println(camposABuscar[1]);
            // exposiciones.add(camposABuscar[1]);

            //String []obrasABuscar = camposABuscar[2].split("\\|");

            /*
            for (int contador =0; contador <obrasABuscar.length; contador++)
            {

                obras.add(obrasABuscar[contador]);
            }*/

            //System.out.print(obras.get(0));
            }

            reader.close();
        }

        catch (IOException ex){
            ex.printStackTrace();

        }

    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        Buscatext = new javax.swing.JTextField();
        Criterios = new javax.swing.JComboBox();
        Buscar = new javax.swing.JButton();
        labelBusqueda = new javax.swing.JLabel();
        labelCriterios = new javax.swing.JLabel();
        BotonSalir = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jPanel1.setLayout(null);

        jPanel2.setBackground(new java.awt.Color(255, 153, 0));
        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Buscador", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 11), new java.awt.Color(255, 255, 255))); // NOI18N
        jPanel2.setToolTipText("Hola");

        Criterios.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "-Seleccione-", "Autor", "Sala", "Piso", " " }));

        Buscar.setText("Buscar");
        Buscar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BuscarActionPerformed(evt);
            }
        });

        labelBusqueda.setText("Busqueda:");

        labelCriterios.setText("Criterios:");

        BotonSalir.setText("Salir");
        BotonSalir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BotonSalirActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(labelBusqueda, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(Buscatext, javax.swing.GroupLayout.DEFAULT_SIZE, 204, Short.MAX_VALUE))
                .addGap(63, 63, 63)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(labelCriterios)
                        .addContainerGap())
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                        .addComponent(Criterios, 0, 179, Short.MAX_VALUE)
                        .addGap(56, 56, 56)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(BotonSalir, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(Buscar, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 136, Short.MAX_VALUE))
                        .addGap(60, 60, 60))))
        );

        jPanel2Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {Buscar, Criterios});

        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(labelBusqueda)
                    .addComponent(labelCriterios))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(Buscatext, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(Criterios, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(Buscar))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(BotonSalir)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel2Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {Buscar, Criterios});

        jPanel1.add(jPanel2);
        jPanel2.setBounds(20, 180, 720, 130);

        jLabel1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/LOGOTIPO.jpg"))); // NOI18N
        jPanel1.add(jLabel1);
        jLabel1.setBounds(10, 10, 250, 150);

        jLabel3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/fondos/iconoconejo.gif"))); // NOI18N
        jLabel3.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jLabel3MouseClicked(evt);
            }
        });
        jPanel1.add(jLabel3);
        jLabel3.setBounds(710, 0, 50, 50);

        jLabel2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/fondos/background_1.jpg"))); // NOI18N
        jLabel2.setText("jLabel2");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(0, 0, 980, 980);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 763, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 619, javax.swing.GroupLayout.PREFERRED_SIZE)
        );

        pack();
    }// </editor-fold>

    private void jLabel3MouseClicked(java.awt.event.MouseEvent evt) {                                     
        // TODO add your handling code here:
        ClaveAdministrador CA= new ClaveAdministrador();
        CA.setVisible(true);
}                                    

    private void BotonSalirActionPerformed(java.awt.event.ActionEvent evt) {                                           
        // TODO add your handling code here:
        InterfazSeleccion A= new InterfazSeleccion();
        A.setVisible(true);
        this.setVisible(false);
}                                          

    private void BuscarActionPerformed(java.awt.event.ActionEvent evt) {

        String s = Buscatext.getText ();

    }

    /**
    * @param args the command line arguments
    */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Buscar().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify
    private javax.swing.JButton BotonSalir;
    private javax.swing.JButton Buscar;
    private javax.swing.JTextField Buscatext;
    private javax.swing.JComboBox Criterios;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JLabel labelBusqueda;
    private javax.swing.JLabel labelCriterios;
    // End of variables declaration

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T22:31:33.977

我敢打赌，您文件的第一行实际上是空白的，因此您第一次通过循环时，拆分什么也不做，因此数组是空的。您可以在尝试使用它之前检查**fields[]**数组的大小，如果它的 null（或长度 = 0）移动到下一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:34:03.400

我用你的数据运行了代码。有效...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T20:36:19.857

我在您给定的文本上尝试了您的拆分方法。我试着像你自己一样拆分它。一切都很完美。我认为当您从文本文件中读取时出现问题。我建议你先检查一下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T20:46:16.403

这可能是一个愚蠢的答案，但文件末尾是否包含空行？

另外，尝试在拆分之前打印出要拆分的行。这样你就可以看到你的代码实际上试图拆分哪些字符串。

# .net - Visual Studio 6“Depends”实用程序的现代等效项

> ID：922943
> 
> 赞同：6
> 
> 时间：2009-05-28T20:20:26.893
> 
> 标签：.net, visual-studio, dependencies

是否有一个很好的工具可以查看 .NET 程序集并告诉您它对其他程序集的所有依赖关系？有点像 VS6 时代的旧依赖程序。

**更新**
我想我在 Reflector 中缺少的一件事是版本号。除非我错过了什么。如何判断程序集需要什么框架？

我正在尝试解决我遇到的另一个问题：
[IronPython，单击一次，.NET 2.0 错误 - 想法？](https://stackoverflow.com/questions/922681/ironpython-click-once-net-2-0-error-thoughts)

从错误消息看来我需要：
Microsoft.Linq.Expressions.Compiler.Snippets
Microsoft.Linq.Expressions.Compiler.LambdaCompiler

除了应用程序在我身上爆炸之外......我应该如何在这里检测到需求？它在我的机器上运行良好。

这是 3.0 还是 3.5 的东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T20:24:44.137

嗯，[.NET 反射器](http://www.red-gate.com/products/reflector/)？

编辑：要查找给定程序集所需程序集的详细信息，请将程序集加载到反射器中，然后展开命名空间。您应该会看到列出的程序集名称。展开它，您将看到“参考”。展开参考以查看所需的程序集。选择其中之一将在下面提供版本和名称信息。

希望有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T21:06:51.573

The FusionLog utilities should help you track down what assemblies are being looked for and where it was searching for and finding them, or not. It will also tell you the version being searched for. (And it comes as part of the .NET SDK)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-26T11:25:29.400

.NET 的depends.exe 的最佳等价物，即显示**在运行时**加载了哪些程序集（与Reflector 的静态（？）分析相反）的工具是*[MS 程序集绑定日志查看器](https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-1.1/e74a18c4(v=vs.71))*（或朋友中的*fuslogvw* :)

它记录所有程序集加载信息 - 包括动态加载的程序集。

[![替代文字](https://i.stack.imgur.com/Ml5P7.gif)](https://i.stack.imgur.com/Ml5P7.gif)
[（来源：[microsoft.com](http://i.msdn.microsoft.com/dynimg/IC65195.gif)）]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T20:23:08.570

[NDepend](http://www.ndepend.com)
但我认为它不是免费的。

编辑：[反射器](http://www.red-gate.com/products/reflector/) 打开组件。右键单击-> 分析。它将显示当前程序集依赖于哪些程序集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T12:05:58.340

如果您想要 Microsoft SDK（而不是第三方）附带的工具，请使用`ildasm.exe`.NET 程序集反汇编程序。虽然除了 IL 之外它不会显示任何代码，但它会显示元数据、名称和程序集依赖项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T20:25:34.730

[Reflector](http://www.red-gate.com/products/reflector/)有一些[插件](http://www.codeplex.com/reflectoraddins)可以帮助解决这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-06-03T19:01:55.237

## .NET 的 DependencyWalker

[.NET 的DependencyWalker](https://github.com/isindicic/DependencyWalker.Net)显示 .NET 程序集的依赖关系树，如旧的 Dependency Walker 为非托管应用程序显示它。要快速开始使用它，请获取最新的[DependencyWalker.zip](https://github.com/isindicic/DependencyWalker.Net/releases/download/1.0/DependencyWalker.zip)并将其解压缩到某个地方。（该链接指向撰写本文时的最新版本）。

这适用于 .NET Framework 依赖项（这里是一个简单的 WPF .NET 应用程序的示例）：

[![DependencyWalker.NET 的 UI](https://i.stack.imgur.com/F0CQA.png)](https://i.stack.imgur.com/F0CQA.png)

还有一个参考列表：

[![DependencyWalker.NET - 参考列表](https://i.stack.imgur.com/VLCL2.png)](https://i.stack.imgur.com/VLCL2.png)

但是，对于 .NET Core 应用程序，我可以看到一些（但不是全部）依赖项 YMMV 的列表...：

[![DependencyWalker.NET 中的 .NET Core 应用](https://i.stack.imgur.com/7IA6y.png)](https://i.stack.imgur.com/7IA6y.png)

# javascript - jQuery查找整数并附加小数

> ID：922949
> 
> 赞同：0
> 
> 时间：2009-05-28T20:21:36.033
> 
> 标签：javascript, jquery, numeric

需要使用 SELECT 下拉列表选项并查找是否有任何值是整数，然后将 .00 附加到列表值选项。也需要更改值。

```
<select>
  <option value="1">1</option>
  <option value="1.99">1.99</option>
  <option value="2.99">2.99</option>
  <option value="4">4</option>
</select> 
```

提前感谢您对此的任何帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T20:24:51.407

不太确定这是否是最好的方法，但它有效*：*

```
$('option', '#myselect').each(function() {
    if($(this).val() == parseInt($(this).val(), 10)) {
         var x = $(this).val() + '.00';
         $(this).val(x).text(x);
    }
}); 
```

[演示](http://jsbin.com/ekafa)。

再三考虑，您也可以使用[`toFixed`](http://www.w3schools.com/jsref/jsref_tofixed.asp)更清洁的方法来执行此操作：

```
$('option', '#myselect').each(function() {
    var x = Number($(this).val()).toFixed(2);
    $(this).val(x).text(x);
}); 
```

[演示](http://jsbin.com/ayumi)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:29:46.530

如果您打算大量使用字符串格式，我建议您获取插件：

[http://code.google.com/p/jquery-utils/wiki/StringFormat](http://code.google.com/p/jquery-utils/wiki/StringFormat)

然后就很简单了： $.format('{a:.2f}', {a:'1'})

# java - Java 网络服务器和 TIME_WAIT

> ID：922951
> 
> 赞同：1
> 
> 时间：2009-05-28T20:21:51.913
> 
> 标签：java, networking, sockets

我遇到了从我公司生产的设备接收信号的网络服务器的问题。设备偶尔会重新使用它刚刚使用的源端口。这会导致 SYN 被服务器丢弃。然后设备会重试，直到旧套接字超出服务器上的 TIME_WAIT。服务器然后 SYN-ACKs。

服务器是用 Java 编写的。不幸的是，修改设备以正确循环端口不是一种选择，因为该领域有很多，并且更新现有装置不是一种选择。旧软件是用 C++ 编写的，并以某种方式从 Windows TCP 堆栈的列表中删除了 TIME_WAIT 端口。

谁能给我任何关于如何在 Windows 上绕过 Java 的 TIME_WAIT 的建议？

编辑：我确实在 Wireshark 中确认该设备正在重用最近使用的端口。

在服务器套接字上，我使用以下选项：

```
socket = new ServerSocket();
socket.setPerformancePreferences(3, 2, 1);
socket.setReuseAddress(true);
socket.setSoTimeout(CLIENT_READ_TIMEOUT);
socket.bind(new InetSocketAddress(group.getPort()), MAX_TCP_BACKLOG); 
```

并且客户端socket接收后有如下设置：

```
Socket client = server.accept();
client.setKeepAlive(false);
client.setSoLinger(true, 0);
client.setReuseAddress(true);
client.setTcpNoDelay(true);
client.setSoTimeout(CLIENT_READ_TIMEOUT); 
```

我已经尝试过 SO_LINGER 的真假，具有完全相同的跟踪结果。CLIENT_READ_TIMEOUT 设置为 10 秒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T20:52:06.627

基于尼古拉的回答，

```
Socket s;
...
s.setSoLinger(true,0); 
```

在Java中是等价的。

编辑：您可能想看的另一件事是 setReuseAddress(true);

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T20:42:19.110

旧的**不推荐**避免的技巧`TIME_WAIT`是将`SO_LINGER`套接字选项设置为`{ 1, 0 }`-`close`然后发送`RST`而不是执行正常的刷新/四路交换序列，从而避免`TIME_WAIT`所有在一起（警告 - 你可能会失去你仍然拥有的东西的尾巴发送缓冲区。）我无法评论这是否可以在 Java 中完成。

编辑：你能确认`tcpdump`客户端真的重用源端口号吗？如果不是，这可能只是乔恩指出的 SO_REUSEADDR 监听套接字选项的经典案例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T01:20:17.660

服务器忽略来自客户端的 SYN 数据包，因为它无法区分使用旧源端口的新会话和来自旧会话的重新传输。如果你绕过`TIME_WAIT`服务器上的状态，通过在控制块表中设置系统计时器间隔来老化 TIME_WAIT 状态条目，那么你的服务器将如何正确忽略已经终止的会话的 SYN 重传？

# opengl - 将 Wavefront .obj 的 vt 映射到 OpenGL 纹理坐标

> ID：922952
> 
> 赞同：4
> 
> 时间：2009-05-28T20:21:56.827
> 
> 标签：opengl, 3d, .obj, wavefront

一位艺术家朋友向我发送了一个由 3DS Max 2009 导出的 .obj 文件，其中包含三个纹理坐标作为`vt`命令的参数。根据 .obj 规范，这是正确的。但是，我不确定如何映射为常规 2D .jpg 纹理提供的 UVW 坐标。

这对我来说相对重要，因为我玩过 3DS Max，试图弄清楚如何强制它只导出 UV 坐标，但似乎没有直接的方法。在这种情况下，这只是一个天空盒，但在其他情况下，它可能会更复杂且无法手动修复。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T19:43:31.253

文章中有一个部分是[什么 UVW 映射？](http://fordy.planetunreal.gamespy.com/gradientssmeshtutorials/uvw.html)这解释了：

> 您可能会质疑为什么二维平面需要像 W 这样的深度坐标。一个原因是因为有时能够翻转地图相对于其几何图形的方向很有用。为此，您需要第三个坐标。W 坐标对 3 维程序材料也有意义。

在您的情况下，您可以简单地忽略 W 坐标，只读取以 . 开头的前两个浮点数`vt`。这假设您不是很担心 W 坐标占用的额外空间，因为 .obj 一开始是一种效率很低的文件格式。

就我个人而言，我不喜欢在 OpenGL 中使用 .obj，因为它为每个面而不是每个顶点提供顶点法线。要正确照亮对象，您必须复制顶点或通过平均面中的周围顶点法线来计算法线。如果您想探索更有效的替代方案，请查看二进制格式，例如完整记录的 .md2 格式。如果您还没有使用 glDrawElements，也可以考虑使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T12:29:23.760

对不起，如果我误解了你的问题。但是你不能简单地忽略第三个参数 w 吗？据我了解，w 只是垂直于 u 和 v 所描述平面的平面中的坐标，因此简单的 2d 纹理映射很少需要它。

希望这可以帮助。

# emacs - 我如何在 elisp 中判断 Emacs 是否使用 X？

> ID：922957
> 
> 赞同：14
> 
> 时间：2009-05-28T20:22:54.593
> 
> 标签：emacs, elisp

我的 .emacs 中有一些我不想在运行时运行的项目`emacs -nw`。如果是这种情况，我如何在 elisp 中判断？

（编辑将 -nox 更改为 -nw --- 我的大脑在哪里？）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-28T21:08:07.793

您上面的答案是正确的，尽管如果您想区分其他窗口系统并且只想在您实际使用 X 时运行代码，您就必须去

```
(if (eq window-system 'X) (foo)) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-28T20:49:13.527

我想我找到了自己的答案：

```
(when window-system
    (foo)) 
```

只有当我在 X 中运行时才会 foo。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-23T13:48:50.017

请注意，这个问题有点构思不当：Emacs 可以同时使用 tty 框架和 GUI 框架运行。

该`window-system`变量是“终端本地”，这意味着它的值将取决于当前选择的框架是 tty 框架还是 GUI 框架。

# algorithm - 什么是保存累积值的好数据结构？

> ID：922962
> 
> 赞同：11
> 
> 时间：2009-05-28T20:23:51.457
> 
> 标签：algorithm, data-structures

我正在寻找一种想法、概念或经过验证的数据结构，在访问保持累积值的集合时会非常有效。

示例可能会更清楚地说明我的需求：

我有一个值列表（2,3,5）。查看累积值时，此列表将是 (2,5,10)。

我现在将在列表的开头添加 1 并得到 (1,2,3,5) 和累积项 (1,3,6,11)。

我只需要看累积值，我对 1,2,3,5 完全不感兴趣。我需要能够快速插入位置，删除位置，所有这些都应该快速更新累积数组（理想情况下不需要遍历整个数组并重新计算值。

任何想法或提示？

@Kristo（太长无法放入评论）：为了澄清为什么负数会使总和值变得毫无意义，请遵循这个例子。

插入 1，后跟 -1。总和是 1 比 0。 (1,-1) // (1,0) 插入 3，然后插入 -3。总和是 3，然后是 0。 (1,3,-1,-3) // (1,4,3,0) 插入 2，然后插入 -2。总和是 2，然后是 0。 (1,3,2,-1,-2,-3) // (1,4,6,5,3,0)

如果我的“幻数”是 4 总和不会告诉我我是否超过了它。

PS：这样做的主要原因是能够判断我是否超过了某个值以及在链中的哪个位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T21:16:17.840

我能想到的唯一优化是对累积列表进行“惰性”评估。

除了您的源值列表外，还要跟踪累积列表中准确的最高位置的数量。如果你需要一个比这个更高的数字，那么你就可以遍历列表，更新值和索引。

```
idx 值累积运算
 3 (2,3,5) (2, 5, 10)
 0 (1,2,3,5) (X,X,X,X) 在 0 处插入 1
 3 (1,2,3,5) (1,3,6,X) 寻找大于 5 的值     
 3 (1,2,3,5,4) (1,3,6,X,X) 在 4 处插入 4

```

当然，如果您通常在列表的早期添加项目，这不会给您带来很多好处....

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T20:30:21.163

检查[累积频率表](http://www.chiark.greenend.org.uk/~sgtatham/algorithms/cumulative.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T21:43:08.223

使用具有节点包含其子树总和的附加属性的二叉搜索树。所有操作仍然是 O(lg n)。要插入或删除一个值，请执行正常过程，并更新所有父项的总和。获得总和就像找到包含该元素的节点并返回其总和减去其右子节点的总和一样简单。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T21:11:31.203

在 C# 中，我会将所有实际值保存在一个列表中，并使用自定义迭代器循环遍历累积值。

您只会重新计算直到迭代器告诉您已经超出限制的点（显然，您必须为此编写代码）。

我认为价值在于您可以在不进行任何计算的情况下添加/删除，直到需要迭代列表（我认为您无论如何都需要这样做才能找到截止数字）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T20:45:28.947

我看到有两种简单的方法，都使用基本数据类型 - 列表。

1.  保留原始列表，并重新计算每次更改的累积值。

2.  仅保留累积列表，并且仅使用以下功能添加或删除：

    *   Add(item,position *default is end of list* ) 将添加从*位置*-1 开始的项目的值。
    *   Delete(position) 将计算原始值减去两个数字，然后在删除项目之前从列表的其余部分中减少这个数字。

    Add 2 : (2)*将 2 添加到空列表中。*

    Add 3 : (2,5)*将列表末尾的 3 添加到前一个元素 (2) 中。*

    Add 5 : (2,5,10)*将列表末尾的 5 添加到前一个元素 (5) 中。*

    在开始处加 1：(1,3,6,11)*在列表的开始处加 1，并递增 1 直到结束（没有先前的元素）。*

    在第 2 个位置加 7：(1,8,11,14,19)*加 7 并递增 7 直到结束（没有先前的元素）。*

    删除第 3 个位置 ( *The 11* ) : (1,8,3,8)*获取值，删除它，将值添加到其余位置。*

这种方式可以在不保持原始值的情况下保持所有同步。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T20:58:53.257

使用 C++ 术语，您可以使用`std::list`（在中间轻松插入/删除）或`std::set`（始终排序）数据和一个变量来保存总和吗？在每次插入/删除时，您都可以根据需要修改总和。总和代表您可能的累积列表中的最高数字。只有当你破坏了你的幻数时，你才需要做一些算法工作来找出你破坏的地方。

**更新：**

根据您的新信息，我没有看到很多可用的快捷方式。您需要经常从中间插入或删除，因此建议使用某种链表方法。您可以通过仅更新列表中已更改的部分来节省一点计算。让`L`成为值列表，并`n`成为列表中的所需位置。`x`在位置插入值`n`：

*   `x + L(n-1)`在位置插入值`n`
*   在这个新元素之后添加`x`到所有元素`n`
*   如果您破坏了您的幻数，请停止

除了从所有后续值中减去之外，删除的过程是相同的。这样，如果您在开头附近插入，您只会做很多工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-14T11:06:18.167

*   [您可以查看二进制索引树](http://www.topcoder.com/tc?module=Static&d1=tutorials&d2=binaryIndexedTrees)的累积频率的数据结构
*   您可以将值范围分解为固定的位范围。前任。3 个间隔：

    ```
    #define NUM (1<<24)  // max value in your data set
    #define BITS0 8
    #define BITS1 8
    int cum0[NUM >> (BITS0+BITS1)]; // sum of cum1
    int cum1[NUM >> BITS1]; // sum of count
    int count[NUM];

    int add(id, val) { // add a value
      cum0[id >> (BITS0+BITS1)] += val;
      cum1[id >> BITS1] += val; 
      count[id] += val;                     
    }

    int cumvalue(int id) { int cum = 0; // return cum value at index id         
      for(i = 0; i < (id >> (BITS0+BITS1));i++) cum += cum0[i]; i <<= BITS0;
      for(i = (id & ~((1 << (BITS0+BITS1))-1)) >> BITS1; i < (id >> BITS1); i++) cum+= cum1[i]; i <<= BITS1;
      for(i = id & ~((1 << BITS1) -1); i < id; i++) cum += count[i];            
      return cum;
    } 
    ```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-07T18:09:20.383

使用[https://en.wikipedia.org/wiki/Fenwick_tree](https://en.wikipedia.org/wiki/Fenwick_tree)。

这将预期运行时复杂性在元素数量上呈对数增长，而不是像在幼稚的实现中那样呈线性增长。

# jquery - jqModal, jquery 问题

> ID：922968
> 
> 赞同：0
> 
> 时间：2009-05-28T20:25:02.547
> 
> 标签：jquery, jqmodal

我有以下代码；

```
// open the modal when an element with a class 'edit' is clicked
            $('.edit').live('click', function() {`
                $('#mdl_edit').jqm({onHide: f($(this).attr('id')), ajax: 'ajax/edit_modal.aspx?lid=' + $(this).attr('id'), ajaxText: '<img src="img/ajax-loader.gif"' });
                $('#mdl_edit').jqmShow();
                return false;
            });

var f = function load_it(lID) {    load_single_record(lID); }; 
```

问题是，当我单击具有“编辑”类的元素时，函数 load_it 甚至在对 edit_modal.aspx 的 ajax 调用之前运行。我实际上要求它在模式框关闭后运行。另外，我需要将 $(this).attr('id') 传递给在模态关闭后需要运行的函数。我做错了（我知道）但有人可以告诉我正确的吗在模态关闭后调用函数的方式，还传递一个变量给它？

问候，

凯姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:35:58.670

您的问题是`f`当 JS 引擎设置 onHide 的值时执行。你真正想要的是将 onHide 设置为一个匿名函数，内联定义，调用 load_it：

```
onHide:function(hash){load_it($(this).attr('id'));} 
```

您实际上并不需要`hash`那里，因为您没有使用它，但是（根据 jqModal 的文档）那里可能有一些有趣的东西适合您。

# java - 通过 Cargo 在嵌入式 Jetty 中调用 ehcache-server 时出现异常：无法实例化 WebApplicationProviderImpl

> ID：922971
> 
> 赞同：0
> 
> 时间：2009-05-28T20:25:30.393
> 
> 标签：java, jetty, ehcache, jersey, cargo

我正在开发一个使用独立 ehcache 服务器来缓存某些数据的 Web 应用程序。ehcache 服务器通过 REST（而不是 SOAP）访问。

出于功能测试的目的，我需要运行 ehcache 服务器的嵌入式实例。echcache-server 项目本身使用 Cargo Maven2 插件为自己的功能测试执行此操作。我尝试在我的应用程序的 pom.xml 中做同样的事情，但 Cargo 插件坚持部署我自己的 Web 应用程序的 WAR，即使我将其配置为使用 ehcache 的 WAR。

因此，我尝试直接使用 Cargo Container API 来进行部署和容器实例化。以下是相关代码：

```
String localRepositoryPath = "/home/zoltan/.m2/repository";
String jettyHomeDirectory = "/tmp/cargoJettyHome";

LocalConfiguration configuration = new Jetty6xEmbeddedStandaloneLocalConfiguration(jettyHomeDirectory);
Deployable war = new WAR(localRepositoryPath + "/net/sf/ehcache/ehcache-server/0.7/ehcache-server-0.7.war");
configuration.addDeployable(war);

EmbeddedLocalContainer container = new Jetty6xEmbeddedLocalContainer(configuration);
container.start(); 
```

Jetty 容器启动，并且 ehcache 本身似乎部分启动，基于各种消息，这些消息看起来与启动独立服务器时生成的消息相同。但是，RESTful Web 服务无法启动，但有以下异常：

```
com.sun.jersey.spi.service.ServiceConfigurationError: com.sun.jersey.spi.container.WebApplicationProvider: The class com.sun.jersey.impl.container.WebApplicationProviderImpl implementing provider interface com.sun.jersey.spi.container.WebApplicationProvider could not be instantiated: null
    at com.sun.jersey.spi.service.ServiceFinder.fail(ServiceFinder.java:346)
    at com.sun.jersey.spi.service.ServiceFinder.access$600(ServiceFinder.java:144)
    at com.sun.jersey.spi.service.ServiceFinder$LazyObjectIterator.hasNext(ServiceFinder.java:638)
    at com.sun.jersey.spi.container.WebApplicationFactory.createWebApplication(WebApplicationFactory.java:61)
    at com.sun.jersey.spi.container.servlet.ServletContainer.create(ServletContainer.java:570)
    at com.sun.jersey.spi.container.servlet.ServletContainer.load(ServletContainer.java:538)
    at com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:207)
    at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:433)
    at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:256)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:616)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1220)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:513)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:448)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)
    at org.mortbay.jetty.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:156)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.jetty.Server.doStart(Server.java:222)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:39)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.cargo.container.jetty.internal.JettyExecutorThread.run(JettyExecutorThread.java:68)
Caused by: java.lang.ClassCastException
    at java.lang.Class.cast(Class.java:2990)
    at com.sun.jersey.spi.service.ServiceFinder$LazyObjectIterator.hasNext(ServiceFinder.java:596)
    ... 26 more 
```

以下是我的 pom.xml 中的相关依赖项：

```
<dependency>
  <groupId>com.sun.jersey</groupId>
  <artifactId>jersey-server</artifactId>
  <version>1.0</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>com.sun.jersey</groupId>
  <artifactId>jersey-client</artifactId>
  <version>1.0</version>
</dependency>
<dependency>
  <groupId>com.sun.jersey</groupId>
  <artifactId>jersey-spring</artifactId>
  <version>1.0</version>
  <scope>test</scope>
  <exclusions>
    <exclusion>
      <groupId>org.springframework</groupId>
      <artifactId>spring-core</artifactId>
    </exclusion>
    <exclusion>
      <groupId>org.springframework</groupId>
      <artifactId>spring-beans</artifactId>
    </exclusion>
    <exclusion>
      <groupId>org.springframework</groupId>
      <artifactId>spring-aop</artifactId>
    </exclusion>
    <exclusion>
      <groupId>org.springframework</groupId>
      <artifactId>spring-context</artifactId>
    </exclusion>
    <exclusion>
      <groupId>org.springframework</groupId>
      <artifactId>spring-context-support</artifactId>
    </exclusion>
    <exclusion>
      <groupId>org.springframework</groupId>
      <artifactId>spring-web</artifactId>
    </exclusion>
  </exclusions>
</dependency>
<dependency>
  <groupId>org.mortbay.jetty</groupId>
  <artifactId>jetty-servlet-tester</artifactId>
  <version>6.1.11</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>org.codehaus.cargo</groupId>
  <artifactId>cargo-core-api-container</artifactId>
  <version>1.0</version>
</dependency>
<dependency>
  <groupId>org.codehaus.cargo</groupId>
  <artifactId>cargo-core-api-generic</artifactId>
  <version>1.0</version>
</dependency>
<dependency>
  <groupId>org.codehaus.cargo</groupId>
  <artifactId>cargo-core-container-jetty</artifactId>
  <version>1.0</version>
</dependency>
<dependency>
  <groupId>net.sf.ehcache</groupId>
  <artifactId>ehcache-server</artifactId>
  <version>0.7</version>
  <type>war</type>
</dependency> 
```

有谁知道可能导致此异常的原因？也许我正在使用不匹配的码头和球衣版本？我是否必须以某种方式注册 WebApplicationProviderImpl？任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-15T15:40:04.390

我对此没有解决方案：相反，我的功能测试使用的是独立的 ehcache 服务器。

ehcache 邮件列表中的某个人提出[了另一种方法](http://sourceforge.net/forum/forum.php?thread_id=3287255&forum_id=322278)。

# .net - 在混合托管/非托管 c++/CLI 进程关闭期间线程关闭

> ID：922973
> 
> 赞同：2
> 
> 时间：2009-05-28T20:25:36.633
> 
> 标签：.net, multithreading, interop, c++-cli

我正在使用 c++/CLI 开发混合托管/本机应用程序。

我知道 CLR 将在（完全）关闭时挂起所有托管线程，但是非托管线程呢？当 CLR 运行时正在关闭/释放内存/运行终结器时，非托管线程是否可能仍在运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-05T17:01:47.553

我找到了有关此问题的更多信息：

[Microsoft Windows 中的托管和非托管线程](http://msdn.microsoft.com/en-us/library/74169f59.aspx)

[c++/CLI 混合可执行文件中的进程关闭](http://social.msdn.microsoft.com/Forums/en-US/vclanguage/thread/e76db7e9-5e4d-415c-b209-1c6fecabe1e7)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T01:53:19.840

请注意，CLR 只会挂起属性`IsBackGround`设置为 的托管线程`true`。任何仍在运行的前台线程都会让应用程序“挂起”，等待所有前台线程完成。

就非托管线程而言，CLR 无法知道它们，所以是的，除非您编写代码来终止它们，否则它们将继续运行。

请问为什么你的应用程序不能在它决定终止的时候优雅地关闭线程，而不是将它留给环境进行清理？

# java - 我的 G4 上的 Eclipse 性能非常糟糕 - 有什么想法可以替代吗？

> ID：922974
> 
> 赞同：3
> 
> 时间：2009-05-28T20:25:46.180
> 
> 标签：java, performance, eclipse

我有一个 5 岁的 G4 PowerBook，我在旅行时使用它，我打算在接下来的几周内完成一些工作。

Eclipse 似乎在它上面慢得可怕。我已经尝试调整分配给 VM 的内存，但它似乎并没有做太多:)

关于为什么这么慢的任何想法？我在我的桌面上没有遇到这个问题——虽然它运行的是 Linux，但它的 RAM 更少。

如果我要鞭打一匹死马，您会推荐什么作为 Java 开发环境？

理想情况下，我想要良好的代码完成，因为我的心智能力有些有限:)

* * *

*谢谢大家的回复。我刚刚在笔记本电脑上设置了 netbeans，删除了一些杂物，然后导入了我的项目。在花了大约半小时扫描项目之后（有大量的外部库），我很高兴地说它反应迅速。代码完成运行良好（虽然不如 eclipse 直观）。不幸的是，我似乎只能选择您的一个答案——尽管我会使用其中的许多答案。当我旅行回来时，一台新的笔记本电脑就准备好了。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T20:28:12.540

我已经使用 Eclipse 多年了，我发现它在我的 Mac 上的运行速度从来没有达到可以接受的速度，直到我得到 Ganymede (Eclipse 3.4) 并在我的带有 2GB RAM 的 Core 2 Duo Macbook 上运行它。在我拥有这两样东西之前，它只能在 Linux 或 Windows 上忍受。我建议升级你的电脑。:-) 毕竟，无论您如何旋转 Eclipse，它都是一个程序的野兽。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T20:42:27.190

我发现了 Eclipse 性能的两个主要限制因素：

1.  可用 RAM（Windows PC 至少 2GB）
2.  硬盘驱动器速度（我遇到过很多关于驱动器速度慢和/或高度碎片化的问题。）

众所周知，笔记本电脑的驱动器速度很慢 - 而且驱动器进入“省电”模式（因此旋转速度更慢）通常会使情况更加复杂。

我们还曾经在 ClearCase 动态视图之上运行 Eclipse……谈论性能野兽……

您可能还需要花时间精简 Eclipse（禁用不需要的插件等）。单击“帮助”->“管理配置”进入可以执行此操作的界面。Eclipse 发行版附带了许多强大的工具——其中许多我们大多数人从未使用过。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T21:06:57.407

I love IntelliJ from JetBrains.

I used Eclipse for four years and loved it. But since I was shown IntelliJ I've never gone back. I feel strongly enough where I pony up the cash to buy a personal license. Worth every cent.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T20:30:03.237

如果您担心速度，请使用 vim 或 textmate 之类的东西。

否则你必须意识到，Eclipse 内置了很多，因此加载时间很长。如果您发现自己没有使用它的大部分功能，那么只需使用文本编辑器。

据说 Neatbeans 的重量更轻。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-29T00:51:20.433

以我的经验，Java 在 Mac 上的响应速度并不快。在我的 3 GB MBP 上运行相当新鲜的 Eclipse 感觉比我的工作机器慢，后者是 2 GB 的 Dell D620，有很多项目。

想尝试一个疯狂的想法吗？在您的 PB G4 上安装 linux 并尝试在其中运行 Eclipse。值得一试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-28T20:33:43.573

我建议尝试一下 IntelliJ。它可能对您来说运行得更快一些，所以值得一试。它由制造 ReSharper 和 TeamCity 的同一家公司 JetBrains 制造。（如果你喜欢它，你可以买它......它是免费试用）。

[http://www.jetbrains.com/idea/](http://www.jetbrains.com/idea/)

祝你的任务好运！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T21:15:29.370

如果速度是您最关心的问题，我绝对***不会推荐 IntelliJ Idea。***我个人觉得它和eclipse一样慢，如果不慢的话……它也是一只狗。

举个例子 - 如果想法崩溃，它通常每天都会发生，那么**所有**项目都必须重新索引（一个漫长的过程）**，无论当时是否打开**；一个痛苦的过程，尤其是在次优的盒子上。更重要的是，它还同时重新索引了整个 JDK。

我认为总体上对桌面 java 的悲哀控诉是，一个体面的、强大的 IDE 似乎无法在它之上实现，提供接近可接受的性能的任何地方。

我曾与 netbeans、eclipse、idea 以及 Visual Studio 合作过。前3个和后者的性能对比是惊人的！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T20:29:40.837

Eclipse 是 Java 最好的 IDE 之一。你的G4是什么配置？你可以做的一件事是让事情变得更快捷，那就是在后台禁用自动构建。您可以通过取消选中 Project->Build Automatically 来做到这一点。这样做可以防止 eclipse 在后台持续构建，并且可以更好地响应您的编辑需求。此外，如果您使用 Web 开发插件，您可以禁用 jsp 和 xml 验证。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T20:30:01.757

我喜欢 Netbeans，它比较小而且速度很快，但由于 Oracle 现在是 Sun 的所有者，我不知道它的未来。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T20:32:37.210

我遇到过几次这样的问题。我发现一些像猪一样运行 Eclipse 的系统可以很好地使用 Aptana 或 NetBeans。我会先尝试这些，因为它们都非常强大。

# seo - 针对 SEO 和用户友好性的 URL 建议

> ID：922982
> 
> 赞同：0
> 
> 时间：2009-05-28T20:27:34.117
> 
> 标签：seo, friendly-url

大家觉得什么比较好？

```
mysite.com/<username>/media/<mediaId>/<title>
or
mysite.com/<username>/media/<title>-<mediaId> 
```

标题部分被完全忽略，仅用于提供用户可读的 url。它可以改变。大家觉得什么比较好？前者的优点是，如果标题被截断/未链接，则 url 仍将解析，但后者的优点是左侧是可读的，而丑陋的 id 在右侧，可能不会被注意到。

我实际上不知道如果我将它与标题结合起来，我是否会遇到解决 mediaId 的问题。

你们建议另一种类型的网址吗？你认为哪个最好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:29:31.303

我认为第一个`mysite.com/<username>/media/<mediaId>/<title>`更好，它可能对 SEO 有帮助。这也是 StackOverflow 本身使用的结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:32:29.067

从 SEO 的角度来看：**没有变化**

从用户友好的角度来看：

```
mysite.com/<username>/media/<title>-<mediaId> 
```

但这只是我的意见

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-26T05:34:49.947

我在具有不同 URL 结构的非常大的网站（数百万页）上搞砸了，例如：

*   带参数且无关键字的 cgi-bin
*   嵌套关键字（使用伪文件夹结构'/'）
*   嵌套关键字（使用伪扁平结构'-'）
*   关键字排序，动态优先，动态最后等

老实说，只要您在 URL 中有关键字，您就不会注意到 SEO 方面的任何真正不同。

就可用性而言，这可能是主观的，并且没有经过验证的顺序，但是由于大多数英语用户阅读 LTR（从左到右），那么您应该将关键字（标题）放在末尾，否则它可能会迷失周围的元（在域之后）。这种方法还取决于 URL 长度，因为它会在书签、浏览器 chrome、搜索结果等中被截断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T03:07:51.313

也许我错了，但我相信第二个更好。从SEO的角度来看，ID比word更糟！这意味着 - 更好 /，因为将这些 ID 放在 URL 的尾部比放在头部附近要好！

再说一遍：我自己的看法，我不确定！

# iphone - 在 ipod/iphone 上安装应用程序时出错

> ID：922994
> 
> 赞同：1
> 
> 时间：2009-05-28T20:30:08.683
> 
> 标签：iphone, xcode

我是一名注册的 iPhone 开发人员，我收到以下错误：

> 您的移动设备遇到意外错误 (0xE8000001) 尝试断开设备并关闭设备电源；然后打开设备电源并重新连接。

我的系统规格：

*   PowerPC G5
*   Mac OSx - 10.5.6
*   iPhone 操作系统 - 2.2.1

每当我从 XCode 中单击“Build&Go”时，我都会收到此错误，我试图将其安装在我的 iPodTouch 上。我给了一个合适的 AppId，就像`info.plist(Bundle identifier)`在 iPhone 程序门户中配置的一样。

在 XCode -> Organizer -> Console 中显示以下错误：

> <错误>：用户手机的 uid 为 501
> <错误>：模式为 0x41e8。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T20:39:49.427

我以前见过类似的问题。您是否尝试过断开 iPhone、关机、重新开机并重新连接？

它对我有用，但你真的需要关闭它，而不仅仅是让它进入待机状态。按住顶部的“待机”按钮，直到出现“滑动关机”滑块。滑动它。现在电话真的没电了。

一个奇怪的提示：你真的在 G5 上编译吗？出于某种原因，我认为开发 iPhone 应用程序需要英特尔 mac。也许这只是为了让模拟器工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T15:27:51.367

以下是我昨天遇到的一些潜在解决方案的链接：

[主题：无法将开发应用程序部署到我的 iPhone（0xE800003A 变体）](http://discussions.apple.com/thread.jspa?threadID=1721273)

[PreflightingApplication 错误 (0xE8000001) 和其他](http://www.talentgrouplabs.com/blog/archive/2008/08/21/preflightingapplication-errors-0xe8000001-and-others.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T07:38:38.850

如果多次重启 iPhone 没有帮助，请考虑重新安装整个 iPhone SDK。它曾经对我有用。

# jquery - ASP.NET MVC 在 javascript 中解析 url

> ID：922997
> 
> 赞同：17
> 
> 时间：2009-05-28T20:30:50.897
> 
> 标签：jquery, asp.net-mvc

我正在通过 jQuery.load('/Business/Tags') 加载一些内容，这在使用本地网络服务器时效果很好。但是当使用 iis 时，这并不能正确解决。我已经看到了几种不同的方法来解决这个问题，例如 ResolveUrl。处理 javascript 中解析 url 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-28T20:36:36.360

我的 JavaScript 遇到了这个确切的问题。由于我的 JavaScript 也在一个单独的文件中，该文件包含在我的母版页中，因此我无法使用 ResolveUrl。

这是我在我的情况下解决它的方法。我在顶部的母版页的 head 标记中包含了以下 JavaScript：

```
<script type="text/javascript">
    var baseUrl = "<%= Request.Url.GetLeftPart(UriPartial.Authority) %>";
</script> 
```

我正在设置一个全局变量，我的所有 JavaScript 文件都可以访问它，称为 baseUrl。

您的代码将变为：

```
jQuery.load(baseUrl + '/Business/Tags'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T20:55:23.250

至于我，我在可能的情况下使用带有 JavaScript/jQuery 的 Url.Action/Url.RouteUrl 助手：

```
$.load('<%= Url.Action("Tags", "Business") %>') 
```

或者

```
$.load('<%= Url.RouteUrl("BusinessTagsRoute") %>') 
```

在其他情况下，我使用 ResolveUrl 助手（来自[MVCContrib](http://mvccontrib.codeplex.com/)或者您可以自己编写）：

```
$.load('<%= Url.ResolveUrl("~/Business/Tags") %>') 
```

**更新：**

也可以为你的 JavaScript/jQuery 创建特殊的控制器，用 JavaScript 返回 PartialViews：

```
public ActionResult YourJavaScript()
{
    Response.ContentType = "application/x-javascript";
    return PartialView("YourJavaScript");
} 
```

然后在 YourJavaScript.ascx 中，您可以使用带有 WebForms 服务器标签的 JavaScript/jQuery 代码。我仍然建议不要在 jQuery/AJAX 中使用几乎没有编码的 Url

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T12:05:08.377

我们在应用程序中执行此操作的几种方法：

```
 var applicationPath = '<%= Url.Content("~/") %>'; 
```

或者

```
 var applicationPath = '<%= Request.Url.Scheme %>://<%= Request.Url.Host %><%= Request.ApplicationPath %>/'; 
```

然后，我们使用 applicationPath 作为我们所有 ajax 调用的基本 url。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T23:55:07.363

我仍然建议在您的母版页中使用基本 href 标记。因此，任何图像或 javascript 调用都将从此 url 解析。这将允许您将 javascript 函数/调用放在外部 js 文件中。

```
<html>
    <头部>
        <base href="http://www.mysite.com/virtual_dir1/">
        <script src="location_of_js_file">

```

记住基本 href 中的结尾“/”。

此外，删除前导 '/' 并且每当您执行 jQuery.load('Business/Tags') 时，它实际上将来自[http://www.mysite.com/virtual_dir1/Business/Tags](http://www.mysite.com/virtual_dir1/Business/Tags)。

# asp.net - jGrowl 不适用于 MasterPage

> ID：922998
> 
> 赞同：0
> 
> 时间：2009-05-28T20:31:19.630
> 
> 标签：asp.net, jquery

我正在尝试在 aspx 页面中使用[jGrowl 。](http://stanlemon.net/projects/jgrowl.html)但是我遇到了一个我无法解决的问题。当我使用常规的 aspx 页面时，jGrowl 工作正常。但是，当我将页面与 MasterPage 一起使用时，jGrowl 不起作用，我收到一个 javascript 错误，说 $.jGrowl 不是函数。

从 Firebug 控制台，我可以查询 $; $("a"); 他们返回对象。这意味着 jquery 已加载，但 $.jGrowl("hello world"); return "$.jGrowl 不是函数。"

这是我正在使用的示例代码

```
<%@ Page Language="VB" AutoEventWireup="false" CodeFile="growl.aspx.vb" Inherits="growl"
MasterPageFile="~/MyMaster.Master" Title="growl" %> 
```

```
<script language="javascript" type="text/javascript" src="Scripts/jquery.min.js"></script>

<script language="javascript" type="text/javascript" src="Scripts/jquery.jgrowl.js"></script>

<script language="javascript" type="text/javascript" src="Scripts/jquery-ui.min.js"></script> 
```

```
<asp:Content ID="maincontent1" runat="server" ContentPlaceHolderID="MainContent">
$(document).ready(function() { $('#demo12').click(function() { $.jGrowl("Growl Notification");
}); });
<button id="demo12" type="reset" onclick="$.jGrowl('Hello WORLD');">
    DEMO</button> 
```

母版页包含一个 Asp:ScriptManager。

任何帮助都非常感谢。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T20:41:17.100

您是否尝试过使用`jQuery.noConflict()`并`jQuery.jGrowl()`查看 jQuery 和 Microsoft javascript 库之间的 $ 函数是否存在冲突？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:46:26.997

可能很明显，但是您可以检查您是否正确引用了该库吗？你可能走错了路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T15:09:31.217

我发现了我的问题。它是 MasterPage 中的文字，在 page_Load 中设置以包含 javascript 库。当我删除它时，它工作正常。

谢谢大家帮助。

# database - 用于记录的单独生产数据库

> ID：922999
> 
> 赞同：3
> 
> 时间：2009-05-28T20:31:28.773
> 
> 标签：database, logging

我有一个正在测试的应用程序，它将部门 Windows 窗体应用程序的事件记录到 SQL Server 数据库。该应用程序几乎可以投入生产了。日志数据库与应用程序数据库完全分离。

我的问题是，我真的需要创建日志数据库的生产版本，还是可以将生产和测试事件记录到同一个数据库？显而易见的答案是肯定的，当然我需要一个单独的数据库。您永远不希望测试和生产环境混合在一起。但在这种情况下，写入数据库的数据并不是真正的*生产*数据，确切地说，它只是我们用来解决问题的日志记录详细信息。它没有商业价值，如果数据被意外删除或数据库暂时不可用，也不会丢失任何重要内容。将这一切都放在测试环境中会让我更容易管理。

因此，从利弊的角度来看，为所有环境使用单个日志记录数据库似乎是一个更好的解决方案。但就是感觉不对。谁能给我任何具体原因，为什么这是一个坏主意？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T21:52:00.233

如果您的开发服务器已关闭但 prod 没有，您的日志记录可能无法正常工作。可以保证当您需要登录产品的关键事件发生时。在我们的案例中，prod 和 dev 不在同一个物理位置，这意味着通过我们的网络发送日志数据并导致管道瓶颈和胡思乱想的网络人员。

另外，如果您决定更改日志记录过程怎么办？当您进行新开发时，整个生产过程可能会中断。

有时有人可能会阅读日志，对一些错误感到恐慌，忘记它发生在开发中。或者更糟糕的是，有人可能会看到他们认为在 dev 上发生的严重错误，而实际上在 prod 上发生了错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:33:35.820

我会说：

使用标准的日志记录方法（单个 DLL 或类似方法）并在生产中实际容纳日志记录数据库。

这样，您的日志数据库可以被视为“日志服务器”，并且所有应用程序（Dev、Staging、Test 和 Prod）都可以登录到它，因为您使用的是经过审查的库。

当然，您仍然必须注意不要淹没服务器......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T20:40:20.660

我认为将其保留在开发框中没有任何问题，*除非*您的应用程序在无法正确记录时会失败，或者除非记录的信息比您指出的更有价值。

从好的方面来说，将日志数据库保存在开发服务器上将有助于减轻生产服务器处理这些数据的负载——在性能方面无疑是一个优势。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T20:39:14.327

首先，在数据库上保留日志是一个坏主意。当您由于某种原因无法连接到数据库时会发生什么？我建议你使用 log4net 并实现 RollingFileAppenders。他们将日志条目写入文件，当文件达到一定限制时，log4net 开始写入新文件。如果您对设置有任何疑问，请随时提问。我很乐意提供帮助！*************