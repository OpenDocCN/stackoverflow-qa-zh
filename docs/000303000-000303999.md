# StackOverflow 问答 000303000-000303999

# c# - 调试控制台中的颜色

> ID：303004
> 
> 赞同：2
> 
> 时间：2008-11-19T19:12:54.657
> 
> 标签：c#, console, debugging

看看这个 LINQ 演示：

[LINQ 框架概述](http://www.microsoft.com/emea/msdn/spotlight/sessionh.aspx?videoid=716)

进入调试模式时，输出中有颜色。我正在使用相同的 ObjectDumper 类，并且只有黑白控制台窗口。

如何在控制台窗口中获得相同的结果？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T21:07:40.103

关于什么 ：

```
 Console.ForegroundColor = ConsoleColor.Yellow;
 Console.BackgroundColor = ConsoleColor.DarkRed;
 Console.WriteLine("Test"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T20:49:10.877

如果您想以编程方式控制它，请使用该`System.Console.ForegroundColor`属性。

[http://msdn.microsoft.com/en-us/library/system.console.foregroundcolor.aspx](http://msdn.microsoft.com/en-us/library/system.console.foregroundcolor.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-21T13:10:42.533

道克有你想要的...

但是您始终可以使用 Win32 调用。

```
[DllImport("kernel32.dll")] public static extern bool SetConsoleTextAttribute(IntPtr hConsoleOutput, int wAttributes);
[DllImport("kernel32.dll")] public static extern IntPtr GetStdHandle(uint nStdHandle); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T22:34:32.083

如果这是您要查找的内容，您可以在属性中设置控制台文本和/或背景的颜色...只需右键单击标题栏，单击属性并选择所需的颜色。

# c# - MV-VM 设计问题。从 ViewModel 调用 View

> ID：303006
> 
> 赞同：18
> 
> 时间：2008-11-19T19:13:11.960
> 
> 标签：c#, wpf, mvvm

我刚刚开始研究用于 WPF 应用程序的 MV-VM。到目前为止，除了这个特定问题之外，一切都有意义......

我有一个 ViewModel，我会调用 Search。此 ViewModel 绑定到数据网格并列出项目的结果。现在，我有一个命令需要调出**另一个视图**，即项目的详细信息。

将逻辑放在搜索视图中显示另一个视图似乎不正确，它根本不可测试。

这是我的 ViewModel 实现，它是不可测试的......

```
public class SearchViewModel
{
   public void SelectItem()
   {
     // I want to call the DetailsView from here
     // this seems wrong, and is untestable
     var detailsView = new DetailsView();
     detailsView.Show();
   }
} 
```

**在这种模式中，从 ViewModel 方法显示视图的逻辑在哪里？**

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-20T21:27:11.190

正如基夫所说：

> 视图不应该在 UI 层“下方”的任何地方实例化。虚拟机存在于该领域之下，因此这不是放置该逻辑的地方（正如您已经意识到的那样）。
> 
> 几乎总会有一些 UI 级别的事件表明需要创建视图。在您的示例中，它可能是数据网格上的行（双击）单击事件。那将是更新并显示您的 DetailsView 窗口的地方。

您必须意识到 MV-VM 与其他模式（如 MVC 或 MVP）略有不同。ViewModel 对 UI 没有直接的了解。打开另一个视图是视图特定的功能。视图模型应该不太关心什么或多少视图正在使用它的数据。我很可能永远不会通过命令打开视图。

[![替代文字](https://web.archive.org/web/20060624141450/http://blogs.msdn.com:80/johngossman/attachment/576163.ashx)](https://web.archive.org/web/20060624141450/http://blogs.msdn.com:80/johngossman/attachment/576163.ashx)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-19T21:27:12.577

视图不应该在 UI 层“下方”的任何地方实例化。虚拟机存在于该领域之下，因此这不是放置该逻辑的地方（正如您已经意识到的那样）。

几乎总会有一些 UI 级别的事件表明需要创建视图。在您的示例中，它可能是数据网格上的行（双击）单击事件。那将是更新并显示您的 DetailsView 窗口的地方。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-30T10:28:14.900

这是一个基本的经验法则。

*   如果您在视图中处理本地操作，则可以从视图模型开始。

*   如果它是交叉视图（例如显示搜索屏幕），则使用 E​​ventAggregator 模式（事件服务）或注入您调用方法的应用程序控制器，然后它会显示搜索。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T19:00:09.580

[Catel](http://catel.codeplex.com/)包括一种涉及使用`IUIVisualizerService`. 此接口定义了一个 UI 控制器，可用于从 ViewModel 以模态或非模态形式显示对话框。基本上，在父 vm 中，您创建应该保留在新视图后面的视图模型，服务会找到关联的视图模型（基于某些约定或注册）然后显示它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T20:37:13.520

我们使用这种模式的一个变体，这里我们有代表 VM 的控制器，因此视图的数据上下文是 VM，我们的 DTO 是 VM/控制器的属性。我们仍然称它为控制器，因为我们使用它作为控制点，从而处理来自视图的某些命令。这是（我认为）我们将执行诸如您的命令的地方。

# c# - 实现自定义 CacheDependency 以使 ASP.Net 缓存项无效

> ID：303011
> 
> 赞同：8
> 
> 时间：2008-11-19T19:14:06.467
> 
> 标签：c#, .net, asp.net, caching

我想通过派生基本 CacheDependency 来实现我自己的 customCacheDependency 类，因为提供的 SqlCacheDependency 不适合我的情况。（数以千计的缓存项，SQL 中会有很多订阅以及 ASP.Net 中的注册问题）

我想在 ASP.Net VirtualPathProvider 的自定义实现中使用它，所以我可以通过这个 CustomCacheDependecy 来通知 asp.net 数据库中的文件内容已更改。

有人可以向我指出 CacheDependency 的任何自定义实现（最好使用 MessageQueue）吗？

谢谢和问候， 阿杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T13:07:11.267

以下文章很好地概述了实现自定义 CacheDependency 对象，甚至定义了一个使用计时器来检查数据更改的对象，这对于基于队列的解决方案可能很方便，假设您将定期使队列达到峰值。如果您使用的是发布/订阅模型，那么您的订阅逻辑将简单地调用 NotifyDependencyChanged 方法。

[http://msdn.microsoft.com/en-us/magazine/cc163955.aspx](http://msdn.microsoft.com/en-us/magazine/cc163955.aspx)

祝你好运！

# wcf - WCF 中的 DataContract 有什么意义？

> ID：303013
> 
> 赞同：50
> 
> 时间：2008-11-19T19:14:32.160
> 
> 标签：wcf

当您创建 WCF 项目时，VS.net 会创建一个模板。

它将一个类添加到 iService1.cs 文件中：

```
// Use a data contract as illustrated in the sample below to
// add composite types to service operations.
[DataContract]
public class CompositeType
{
    bool boolValue = true;
    string stringValue = "Hello ";

    [DataMember]
    public bool BoolValue
    {
        get { return boolValue; }
        set { boolValue = value; }
    }

    [DataMember]
    public string StringValue
    {
        get { return stringValue; }
        set { stringValue = value; }
    }
} 
```

既然 WCF 服务可以返回任何用户定义的类，为什么要使用 DataContract 和 CompositeType 类呢？

我可以返回类似的东西：

```
 [OperationContract]
MyUserCollection GetUsers(); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-11-19T19:17:37.487

DataContract 只是一种类型的正式定义，可以在服务边界的两侧理解。

如果您返回，如您的示例中的“MyUserCollection”对象，您的服务的消费者将需要引用您的服务/系统的内部结构，这违反了 SOA 明确边界的原则。通过使用 DataContract，您可以以松散耦合的方式发布返回类型的结构。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-11-20T09:26:06.993

需要注意的另一件有趣的事情是，如果您使用 DataContract 装饰您的代码，您可以对客户端可以看到的内容以及必须发送回您的服务的内容进行大量控制。例如：

```
[DataContract]
public class SampleClass
{
    [DataMember(IsRequired=true)]
    public int MyRequiredProperty { get; set; }

    [DataMember]
    public int MyOptionalProperty { get; set; }

    public int MyInternalProperty { get; set; }
} 
```

在上面的示例中，您定义了在接收数据时，您必须拥有 MyRequiredProperty，并且您可以拥有或不拥有 MyOptionalProperty。此外，客户端永远不会看到 MyInternalProperty （例如，这可能是一些有助于内部逻辑的属性，但您不希望它在客户端级别公开）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-04-05T09:29:45.040

还有另一个重要用途，您可以更改类和属性的名称。这是序列化和反序列化过程中的一个方便的功能。

```
[DataContract(Name="EmployeeName")]
public class Person
{
   [DataMember(Name="FullName")]
   public string Name { get; set; }

   [DataMember(Name="HomeAddress")]
   public string Address { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-20T16:59:27.270

我不同意发帖者所说的“DataContract 只是一种可以在服务边界两侧理解的类型的正式定义。”

这里的关键字是“类型”。在 .NET 中，类型是可以具有字段、属性和方法的对象。但是，当您在 WCF 服务中装饰一个类时`DataContract`，结果并不是该类被神奇地移植到调用代码中；而是 不是由一个长镜头！在调用代码中，您将有一个“代理”类。代理类接收表示数据协定内容的 XML。调用代码可以通过代理类接收这些 XML 值，但它不会*让*调用代码访问用 . 装饰的类的内部`datacontract`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-08-06T20:17:20.053

回答“marc_s”：

> “如果您在线路的两端都有 .NET，那很好。如果您有一个 Java 客户端调用您的服务怎么办？如果您将数据放在 DataContracts 中，该信息将存储在 WSDL/XSD 元数据中并且可以使用.NET 以外的客户端也一样。”

我认为这是错误的。让我们尝试这样做：

1.  使用 WCF 项目的默认示例，该类具有类上的 DataContract 属性和成员上的 DataMember，以及返回此类型的方法。
2.  构建它并显示 wsdl。xsd 包含 CompositeType 定义。好的。
3.  现在让我们删除所有属性 DataContract 和 DataMember
4.  构建它并显示 wsdl。xsd 仍然包含 ComposityType 定义！（使用 SCM 软件更明显，它显示第 2 步和第 4 步之间的文件没有差异）

因此，Java 客户端应该在没有 DataContract 和 DataMember 的情况下管理它！我错了还是什么？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-08T08:51:58.537

也许不经常使用，我们可以使用 [DataContract] 来传递私有变量。如果不使用 [DataContract] 属性，DataContractSerializer 将仅序列化/反序列化公开可见的类型。

```
[DataContract]
public class SampleClass
{    
    [DataMember]
    private int MyPrivateProperty { get; set; }
} 
```

（注意：如果您正在生成代理，则私有成员将公开为公共）

# javascript - 使用 jQuery .load 会中断指向其他库资源的链接？

> ID：303026
> 
> 赞同：1
> 
> 时间：2008-11-19T19:18:53.100
> 
> 标签：javascript, jquery, shadowbox

我有一个带有 div 的简单 html 页面。我正在使用 jQuery 将 aspx 应用程序的内容加载到“内容”div 中。代码如下所示：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js">
    </script>
    <script type="text/javascript">
        jQuery.noConflict();
    </script>
</head>
<body>
    <div id="content">
        <div id="loading"> 
            <div class="loading-indicator">Loading...</div>
        </div>
    </div>
</body>
<script type="text/javascript">
    jQuery(document).ready(function() {
        jQuery("#content").load("default.aspx");
    });
</script>
</html> 
```

问题是 default.aspx 使用 shadowbox 和其他 javascript 库。当该代码尝试在 default.aspx 上执行时，它就像未加载 js 源文件一样。我签入 firebug 并且 js 文件在那里（没有 404 或任何东西）。有人知道我错过了什么吗？如您所见，我使用了 jQuery noConflict 函数，因为我认为 $ 的使用可能与其他库发生冲突，但没有帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T19:30:11.020

我有这样做的代码，它可能比需要的更冗长，但嵌套的 js 文件应该不是问题。

```
jQuery.get('default.aspx', null, function(data) {
    $('#default').append(data);
}, 'html'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T19:28:09.400

似乎是一个常见问题：[http ://andreineculau.wordpress.com/2006/09/29/ajax-ondemand-javascript-or-dynamic-script-tags/](http://andreineculau.wordpress.com/2006/09/29/ajax-ondemand-javascript-or-dynamic-script-tags/)

我猜它是浏览器内置的安全性，以防止 ajax 响应运行任意脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T19:35:55.343

未执行的代码是否呈现为脚本块，我了解加载的库，但任何脚本块或内联 javascript 在像这样动态加载时都不会执行。您必须想出一个解决方案来评估返回的脚本块是否有效。我会看看我是否可以从原型中挖掘一个例子，我记得他们有一个。

更新：

这是直接从原型...

```
 ScriptFragment: '<script[^>]*>([\\S\\s]*?)<\/script>'

  extractScripts: function() {
    var matchAll = new RegExp(Prototype.ScriptFragment, 'img');
    var matchOne = new RegExp(Prototype.ScriptFragment, 'im');
    return (this.match(matchAll) || []).map(function(scriptTag) {
      return (scriptTag.match(matchOne) || ['', ''])[1];
    });
  }

  evalScripts: function() {
    return this.extractScripts().map(function(script) { return eval(script) });
  } 
```

当然，您可以根据需要简化它，但是当动态返回页面时，您必须手动评估所有脚本，因为浏览器不会自动评估注入元素的脚本。

# java - 在 Web 应用程序中对用户进行身份验证的最佳方式

> ID：303028
> 
> 赞同：7
> 
> 时间：2008-11-19T19:19:30.433
> 
> 标签：java, security, authentication, web-applications, openid

我正在寻找在网络应用程序中对用户进行身份验证的方法，但主要网络应用程序不需要处理密码。类似 OpenId 的东西，但身份验证服务器肯定需要托管在 Intranet 上，应用程序服务器无法访问 Internet 服务。

我的环境几乎是 Java Web 应用程序，但将系统连接到其他类型的应用程序也会很有趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T19:26:17.970

您可以[运行自己的 OpenID 服务器](http://wiki.openid.net/Run_your_own_identity_server)。

您没有提及您的环境，但如果您在 Windows 域情况下运行，另一种选择是使用带有 Active Directory 的 Windows 身份验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T17:08:51.677

您想在应用程序之间进行单点登录吗？（也就是说，如果同一个用户使用多个您的网络应用程序，如果他们已经登录过一个，那么当他们移动到另一个时，他们不需要再次登录。）

如果是这样，有几种选择，我广泛使用的一个是[CAS](http://www.ja-sig.org/products/cas/)（中央身份验证服务），它在教育机构中广泛使用。它有多种语言的客户端库，服务器部分是Java。

这当然可以与 LDAP 结合使用，以提供单点登录和用户凭据的单一存储库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T21:38:45.347

如果您不喜欢使用自己的 OpenID 服务器或 Windows Active Directory ，总会有某种[LDAP 。](http://www.isrl.uiuc.edu/systems/Documentation/ldap_webauth_howto.html#examples)

# powershell - 在 Powershell 中使用用户名/密码连接到网络文件夹

> ID：303045
> 
> 赞同：66
> 
> 时间：2008-11-19T19:27:26.890
> 
> 标签：powershell

我经常访问 Powershell 中的共享网络文件夹以获取文件等。但如果共享需要用户名/密码，Powershell 不会提示我输入这些，这与 Windows 资源管理器不同。如果我首先在 Windows 资源管理器中连接到该文件夹​​，Powershell 将允许我连接。

如何在 Powershell 中验证自己的身份？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-11-20T15:59:52.050

乍一看，人们真的很想使用[`New-PSDrive`](http://technet.microsoft.com/en-us/library/ee176915.aspx)提供凭据。

```
> New-PSDrive -Name P -PSProvider FileSystem -Root \\server\share -Credential domain\user 
```

### 失败！

```
New-PSDrive：无法检索 cmdlet 的动态参数。无法为“文件系统”提供程序检索 NewDrive 的动态参数。提供程序不支持使用凭据。请在不指定凭据的情况下再次执行该操作。
```

文档指出您可以提供一个`PSCredential`对象，但如果您仔细观察，cmdlet 还不支持这一点。也许在下一个版本中我猜。

因此，您可以使用`net use`或`WScript.Network`对象，调用[`MapNetworkDrive`](http://msdn.microsoft.com/en-us/library/8kst88h6(VS.80).aspx)函数：

```
$net = new-object -ComObject WScript.Network
$net.MapNetworkDrive("u:", "\\server\share", $false, "domain\user", "password") 
```

* * *

## 在 PowerShell 3.0 中编辑[New-PSDrive](http://technet.microsoft.com/en-us/library/hh849829.aspx)

显然，对于较新版本的 PowerShell，该`New-PSDrive`cmdlet 可以使用凭据映射网络共享！

```
New-PSDrive -Name P -PSProvider FileSystem -Root \\Server01\Public -Credential user\domain -Persist 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-11-19T20:23:44.093

这不是特定于 PowerShell 的答案，但您可以先使用“NET USE”对共享进行身份验证：

```
net use \\server\share /user:<domain\username> <password> 
```

然后在 PowerShell 中做任何你需要做的事情......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-25T16:01:59.977

[PowerShell 3 现在开箱即用地支持这一点](https://devblogs.microsoft.com/powershell/improving-the-filesystem-provider-through-community-feedback/)。

如果您卡在 PowerShell 2 上，则基本上必须使用 legacy`net use`命令（如前所述）。

# c# - 创建要出售的广泛项目

> ID：303048
> 
> 赞同：1
> 
> 时间：2008-11-19T19:28:05.250
> 
> 标签：c#, design-patterns, module

我将从头开始一个 C# 项目，该项目将包含几个模块，因此它**可以通过**现有 PHP/ASP/MySQL/Oracle/MS SQL 应用程序的模块出售，该应用程序管理显示 3D 对象并创建 2D 和 3D CAD 文件来自用户可以用来创建所有东西的网络应用程序。

**我的问题是**，从零开始，从“销售”的角度出发，它应该是我应该实现的一种很好的编程方法、设计模式、单元测试等......我怎么知道如何应用它们，有没有什么好的教程/“给我指路”有点像了解这些事情，比如......

*   我应该使哪些类可以被客户端覆盖，以便我可以在我们的模块中提供可扩展性？
*   我应该使用什么样的“包装”来“销售”？DLL、CAB、微星？
*   我应该使用 SubSonic / NHibernate 以便用户可以生成自己的 DAL？我们的原型实现将仅使用 Oracle。

我现在有点迷路，我知道该怎么做，但不知道如何完成它（记住这个完美的编码路径）。

任何好的编程想法都很高兴:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T19:51:44.207

为了快速解决您的每个明确问题，我会说。

至于如何集成，学习控制原则的反转以及如何将其用于可扩展性目的。密切关注 MEF，Microsoft 可扩展性框架。至于什么，您的集成点将主要取决于您正在编写的应用程序的类型和您的目标受众。这还取决于您希望给予第三方多少控制权。例如，Reflector 有一个很棒的、几乎完全开放的插件结构。

DLL 和 CAB 分别是库和存储格式。他们自己做的不多。MSI 是安装程序的一种形式，可以包含构成您的应用程序的 DLL。无论您拥有哪种类型的安装程序，它越容易使用，就会有越多的人尝试您的产品。

数据层本身并不一定那么重要。人们可能不会为您的应用程序创建自己的数据层，如果他们这样做了，如果您的可扩展性框架正在发挥作用，他们应该能够使用他们想要的任何东西。更重要的是，无论您决定使用什么 DAL，您都需要检查它是否能够在不同的数据库上运行，如果这对您很重要以及需要​​多少工作。您还需要确保您在 DAL 中使用的功能适用于您想要支持的所有数据库。NHibernate 有几个特性在它运行的所有数据库中都不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T19:55:46.397

您将在任何应用程序的生命周期中至少重写一次。拿出一些东西来建立价值，然后担心你的代码有多漂亮。

你可以花一年的时间来制作一个没人愿意使用的完美编码的应用程序，或者你可以花几个月的时间来改进它，或者在它遇到问题时做其他事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T19:52:52.173

首先，想想它应该有多大的可扩展性。如果您只是提供完全的可扩展性，您将面临缺乏安全性和不稳定的风险。您可以允许覆盖类，只需确保仅将正确的方法标记为“虚拟”。要销售的包裹类型取决于您的目标受众。如果您的目标是高级用户，那么 DLL 应该是“OK”的。但是，如果您想要一个易于使用的系统，那么 MSI 或任何其他安装程序会更明智。

至于DAL，你真的应该分析每个的优点和缺点，然后选择一个适合的。

确保您使其可扩展，但您可能需要等待反馈以指定它的哪一部分公开。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T18:55:45.050

I think that I'm going to buy this [book](http://blogs.msdn.com/brada/archive/2008/11/17/framework-design-guidelines-scenario-driven-framework-design.aspx), it addresses my concerns in "how to accomplishing it" and from Brad Abrams perspective, is quite good :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T19:51:12.427

首先做一些有用的东西，然后从潜在客户那里获得反馈。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T20:23:16.340

我不认为你采取了正确的方法。你不应该从“销售”的角度来设计软件。您设计软件来完成您的业务模型及其规则所需的工作。所以，从“卖”的角度来看，我会说首先担心有一个好的产品，软件（不管它写得多么好或多么糟糕）会排在第二位，你就会变得富有，只要随着软件完成工作并且您的产品大受欢迎。

听说过 ebay 是如何开始的吗？很长一段时间以来，他们都非常成功，但 C++ 代码非常糟糕（谁知道还有什么）。

# perl - 如何在 Perl 中从文件末尾读取行？

> ID：303053
> 
> 赞同：9
> 
> 时间：2008-11-19T19:28:49.523
> 
> 标签：perl, large-files

我正在编写一个 Perl 脚本来读取 CSV 文件并进行一些计算。CSV 文件只有两列，如下所示。

```
One Two
1.00 44.000
3.00 55.000 
```

现在这个 CSV 文件非常大，可以从 10 MB 到 2GB。

目前我正在使用大小为 700 MB 的 CSV 文件。我试图在记事本、excel 中打开这个文件，但看起来没有软件可以打开它。

我想从 CSV 文件中读取可能是最后 1000 行并查看值。我怎样才能做到这一点？我无法在记事本或任何其他程序中打开文件。

如果我编写一个 Perl 脚本，那么我需要处理完整的文件以转到文件末尾，然后读取最后 1000 行。

有没有更好的方法呢？我是 Perl 的新手，任何建议都将不胜感激。

我在网上搜索过，有一些可用的脚本，[`File::Tail`](https://metacpan.org/pod/File::Tail)但我不知道它们可以在 Windows 上运行吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-19T19:58:31.460

[File::ReadBackwards](http://search.cpan.org/perldoc?File::ReadBackwards)模块允许您以相反的顺序读取文件。只要您不依赖订单，就可以轻松获取最后 N 行。如果您是并且所需的数据足够小（在您的情况下应该如此），您可以将最后 1000 行读入一个数组，然后再读入`reverse`它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-19T19:32:31.187

在 *nix 中，您可以使用 tail 命令。

```
tail -1000 yourfile | perl ... 
```

这只会将最后 1000 行写入 perl 程序。

在 Windows 上，[gnuwin32](http://sourceforge.net/project/showfiles.php?group_id=163416)和[unxutils](http://sourceforge.net/projects/unxutils)软件包都有`tail`实用程序。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-20T03:24:31.170

这仅与您的主要问题无关，但是当您想检查诸如[File::Tail](https://metacpan.org/pod/File::Tail)之类的模块是否在您的平台上工作时，请检查[CPAN Testers](https://www.cpantesters.org/)的结果。[CPAN 搜索](https://metacpan.org/)模块页面顶部的链接将引导您到

[![文件尾标头](https://i.stack.imgur.com/1ywgo.jpg)](https://i.stack.imgur.com/1ywgo.jpg "brian_d_foy 的文件尾标头，在 Flickr 上")
[（来源：[flickr.com](https://farm4.static.flickr.com/3192/3044332885_53b7f294f4.jpg)）]

查看矩阵，您会发现在 Windows 上测试的所有 Perl 版本中，该模块确实存在问题：

[![文件尾矩阵](https://i.stack.imgur.com/Stqg7.png)](https://i.stack.imgur.com/Stqg7.png "brian_d_foy 的文件尾矩阵，在 Flickr 上")
[（来源：[flickr.com](https://farm4.static.flickr.com/3271/3044332679_b46363d973_o.png)）]

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-19T19:53:25.747

没有tail，仅Perl 的解决方案并不是那么不合理。

一种方法是从文件末尾查找，然后从中读取行。如果您没有足够的线条，请从末尾进一步寻找并重试。

```
sub last_x_lines {
    my ($filename, $lineswanted) = @_;
    my ($line, $filesize, $seekpos, $numread, @lines);

    open F, $filename or die "Can't read $filename: $!\n";

    $filesize = -s $filename;
    $seekpos = 50 * $lineswanted;
    $numread = 0;

    while ($numread < $lineswanted) {
        @lines = ();
        $numread = 0;
        seek(F, $filesize - $seekpos, 0);
        <F> if $seekpos < $filesize; # Discard probably fragmentary line
        while (defined($line = <F>)) {
            push @lines, $line;
            shift @lines if ++$numread > $lineswanted;
        }
        if ($numread < $lineswanted) {
            # We didn't get enough lines. Double the amount of space to read from next time.
            if ($seekpos >= $filesize) {
                die "There aren't even $lineswanted lines in $filename - I got $numread\n";
            }
            $seekpos *= 2;
            $seekpos = $filesize if $seekpos >= $filesize;
        }
    }
    close F;
    return @lines;
} 
```

PS 一个更好的标题应该是“从 Perl 中的大文件末尾读取行”。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-18T09:03:49.560

我在纯 Perl 上使用以下代码编写了快速向后文件搜索：

```
#!/usr/bin/perl 
use warnings;
use strict;
my ($file, $num_of_lines) = @ARGV;

my $count = 0;
my $filesize = -s $file; # filesize used to control reaching the start of file while reading it backward
my $offset = -2; # skip two last characters: \n and ^Z in the end of file

open F, $file or die "Can't read $file: $!\n";

while (abs($offset) < $filesize) {
    my $line = "";
    # we need to check the start of the file for seek in mode "2" 
    # as it continues to output data in revers order even when out of file range reached
    while (abs($offset) < $filesize) {
        seek F, $offset, 2;     # because of negative $offset & "2" - it will seek backward
        $offset -= 1;           # move back the counter
        my $char = getc F;
        last if $char eq "\n"; # catch the whole line if reached
        $line = $char . $line; # otherwise we have next character for current line
    }

    # got the next line!
    print $line, "\n";

    # exit the loop if we are done
    $count++;
    last if $count > $num_of_lines;
} 
```

并像这样运行这个脚本：

```
$ get-x-lines-from-end.pl ./myhugefile.log 200 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-19T19:50:32.367

```
perl -n -e "shift @d if (@d >= 1000); push(@d, $_); END { print @d }" < bigfile.csv 
```

虽然真的，UNIX 系统可以简单地`tail -n 1000`说服你简单地安装[cygwin](http://www.cygwin.com/)或[colinux](http://www.colinux.org/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-19T19:37:26.450

我相信你可以使用 Tie::File 模块。看起来这会将行加载到数组中，然后您可以获得数组的大小并将 arrayS-ze-1000 处理为 arraySize-1。

[领带::文件](http://search.cpan.org/~mjd/Tie-File-0.96/lib/Tie/File.pm)

另一个选项是计算文件中的行数，然后遍历文件一次，并开始读取 numberofLines-1000 处的值

```
$count = `wc -l < $file`;
die "wc failed: $?" if $?;
chomp($count); 
```

这会给你行数（在大多数系统上。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T19:47:14.933

如果你知道文件中的行数，你可以这样做

```
perl -ne "print if ($. > N);" filename.csv 
```

其中 N 是 $num_lines_in_file - $num_lines_to_print。你可以用

```
perl -e "while (<>) {} print $.;" filename.csv 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-30T11:30:06.577

模块是要走的路。但是，有时您可能正在编写一段代码，希望在各种机器上运行，而这些机器可能缺少更晦涩的 CPAN 模块。在那种情况下，为什么不只是“tail”并将输出从 Perl 中转储到临时文件中呢？

```
#!/usr/bin/perl

`tail --lines=1000 /path/myfile.txt > tempfile.txt` 
```

如果安装一个可能会出现问题，那么您就有一些不依赖于 CPAN 模块的东西。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-19T20:42:08.457

如果你有超过 $FILESIZE [2GB?] 的内存，我可能会不依赖 tail ，那么我会很懒惰，做：

```
my @lines = <>;
my @lastKlines = @lines[-1000,-1]; 
```

尽管涉及`tail `or的其他答案`seek()`几乎是解决这个问题的方法。``

 ``* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-11-24T20:29:42.677

您绝对应该使用 File::Tail，或者更好的另一个模块。它不是一个脚本，它是一个模块（编程库）。它可能适用于 Windows。正如有人所说，您可以在 CPAN Testers 上检查这一点，或者通常只是通过阅读模块文档或只是尝试一下。

您选择使用 tail 实用程序作为首选答案，但这在 Windows 上可能比 File::Tail 更令人头疼。

# apache-flex - 如何控制 Flex 3 图像控制缓存

> ID：303054
> 
> 赞同：3
> 
> 时间：2008-11-19T19:29:06.637
> 
> 标签：apache-flex, image

根据 adobe flex 文档：[http ://livedocs.adobe.com/flex/3/html/help.html?content=controls_15.html](http://livedocs.adobe.com/flex/3/html/help.html?content=controls_15.html)

多次使用图像

通过每次使用正常的图像导入语法，您可以在应用程序中多次使用相同的图像。Flex 只加载一次图像，然后根据需要多次引用加载的图像。

但是，在测试中我们发现，如果您在 IE flash 9/10 中请求相同的图像（相同的 url 等），则不会发出新的 http 请求，但使用 Firefox、Safari（PC 和 MAC）会发出新的请求一直发出。

我想防止每次尝试使用图像时都从服务器中提取图像，有人知道为什么这仅在 IE 中有效吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T18:57:59.257

答案是：永远不要认为 IE 做得正确。IE 错了，其他浏览器都是正确的。.swf 文件与 Cache-control: private 标头一起返回。IE 不应该返回缓存的图像。正确设置 Cache-Control 标头会导致所有浏览器按预期运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-14T03:59:07.283

一种解决方法是使用 ActionScript 创建您自己的图像缓存，方法是保存原始实例的 BitMapData 并将其用作后续实例的源：

```
private var image1:Image = new Image();    
private var image2:Image = new Image();                 

private function init() : void
{
    image1.addEventListener(Event.COMPLETE, onComplete);
    image1.source = "icon.png";
    addChild(image1);   
}

private function onComplete(event:Event) : void
{   
    var image:Image = event.target as Image;                
    var bitmapData:BitmapData = new BitmapData(image.content.width,
                                               image.content.height, true);    
    bitmapData.draw(image.content);         
    image2.source = new Bitmap(bitmapData);
    addChild(image2);
} 
```

我创建了一个功能齐全的示例并在[此处](http://www.brandondement.com/blog/2009/08/18/creating-an-image-cache-with-actionscript-3/)发布了源代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T20:38:36.840

一次加载图像然后在 flex 应用程序中多次重用该图像的最佳方法是嵌入图像并将其绑定到类表示，然后从那时起仅引用该类。

例子：

```
[Embed(source="myImage.jpg")]
[Bindable]
public var myImageClass:Class; 
```

高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T05:53:39.217

我也成功地加载了一次图像，然后重用了它的源属性：

```
<mx:Image id="myImage" source='blah.png'/>

var myNewImage:Image = new Image();

myNewImage.source = myImage.source; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T16:02:06.167

真正的问题不是如何缓存图像，而是为什么 IE 使用浏览器缓存的图像，而 FF、Safari、Chrome 等不使用？（IE7顺便说一句）。

我仍在尝试提出一个合理大小的示例应用程序。我们有一个画布，带有 mx:Image 或 mx:SWFloader。画布被重新创建，但是图像 url 是相同的，所以浏览器应该返回缓存的图像，而不是发出另一个请求。一个非常简单的 mx:Image 示例，您在其中设置源、清除源和重置源确实在所有浏览器中正确使用缓存的图像。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-07-06T13:53:33.780

问题是图像的到期时间。在应用服务器中配置图片过期时间策略，缓存在所有浏览器中运行正常。

# c# - c# 当从哈希表中删除元素时，哈希表如何缩小？

> ID：303056
> 
> 赞同：1
> 
> 时间：2008-11-19T19:31:08.757
> 
> 标签：c#, .net, .net-2.0, hashtable

我正在寻找在从 C# 中删除元素时缩小哈希表的逻辑（如果有的话）。

问候哈里什

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T19:48:00.203

c# hashtables 不会收缩；他们只会成长。逻辑很重要，因为重新散列算法运行起来非常昂贵；在大多数情况下，通过重新散列到较小的哈希表所节省的空间将完全被重新散列的成本所淹没。特别是在自动的基础上，从哈希表中的任何删除可能不是“最后一次”删除（在算法基础上不可能从哈希表中分辨出来），潜在的价值根本不值得。

如果您的哈希表显着缩小，并且您真的想回收空间，我建议简单地创建一个新的（具有正确大小）并将元素复制到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T19:47:08.753

顺便说一句，由于您使用的是 .net2.0 或更高版本，您可能应该使用 a`Dictionary<K,V>`而不是 HashTable。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T19:42:42.617

文档中哈希表大小变化的唯一指示是超过负载因子并且哈希表的大小增加了。没有提到仓促的不断缩小。

[MSDN](http://msdn.microsoft.com/en-us/library/ms379571.aspx#datastructures20_2_topic5)上有负载因子的更多详细信息。

# asp.net - 什么可能导致 XML 解析错误：找不到元素？

> ID：303066
> 
> 赞同：20
> 
> 时间：2008-11-19T19:33:38.767
> 
> 标签：asp.net

我最近将一个 ASP 站点从我的开发机器迁移到了实时服务器。除了我的常见问题页面之外的所有页面都可以正常工作，但我的常见问题解答显示：

```
XML Parsing Error: no element found
Location: http://geniusupdate.com/GSHelp/faq.aspx
Line Number 1, Column 1: 
```

我所做的唯一更改是将我的 SQL 页面上的连接字符串从本地更改为我的托管服务指定的字符串。关于我可以做些什么来找到这个问题的根源的任何提示？

这是我的常见问题页面的来源：

```
<%@ Page Language="VB" MasterPageFile="~/theMaster.master" AutoEventWireup="false" CodeFile="faq.aspx.vb" Inherits="faq" Title="Untitled Page" %>
<%@ Import Namespace="sqlstuff" %>
<%@ Import Namespace="functions" %>

<asp:Content ContentPlaceHolderID="page_title" ID="theTitle" runat="server">
    FAQ</asp:Content>
<asp:Content ContentPlaceHolderID="column1_title" ID="col1Title" runat="server">
    <%=faqPageTitle(Request.QueryString("cid"))%></asp:Content>
<asp:Content ContentPlaceHolderID="column1" ID="columnContent" runat="server">

     <p>Click on a question to expand it to see the answer!</p>
     <p><%  If cID >= 0 Then
                Dim theFaq As New List(Of faqContent), iterate As Integer = 0
                theFaq = sqlStuff.getFaqs(cID)
                For Each oFaq As faqContent In theFaq
                    Response.Output.WriteLine("<h4 id={0} class={1}>Q: {2}</h4>", _
                                                 addQuotes("gsSwitch{0}-title", iterate), _
                                                 addQuotes("handCursor"), _
                                                 oFaq.Content.Question)
                    Response.Output.WriteLine("<div id={0} class={1}><string>A: </strong>{2}</div>", _
                                                 addQuotes("gsSwitch{0}", iterate), _
                                                 addQuotes("gsSwitch"), _
                                                 oFaq.Content.Answer)

                    iterate += 1
                Next
            Else
                Response.Output.Write("Here you can find a lot of information about eTHOMAS and how to expedite your office tasks.{0}", ControlChars.NewLine)
            End If
    %></p>
    <script type="text/javascript">
        var gsContent = new switchcontent("gsSwitch", "div")
        var eID = '<%= expandID %>'
        gsContent.collapsePrevious(true) // TRUE: only 1; FALSE: any number
        gsContent.setPersist(false)
        if(eID >= 0){
            gsContent.defaultExpanded(eID) // opens the searched FAQ
            document.getElementById('gsSwitch' + eID + '-title').scrollIntoView(true) // scrolls to selected FAQ
        }        
        gsContent.init()
    </script>
</asp:Content>
<asp:Content ContentPlaceHolderID="subcolumn_right_title" ID="rSideColTitle" runat="server"></asp:Content>
<asp:Content ContentPlaceHolderID="subcolumn_right" ID="rSideColContent" runat="server"></asp:Content>
<asp:Content ContentPlaceHolderID="subcolumn_left_title" ID="lSideColTitle" runat="server"></asp:Content>
<asp:Content ContentPlaceHolderID="subcolumn_left" ID="lSideColContent" runat="server"></asp:Content>
<asp:Content ContentPlaceHolderID="sidecolumn_title" ID="sideColtitle" runat="server">
</asp:Content>
<asp:Content ContentPlaceHolderID="sidecolumn" ID="sideCol" runat="server">
    <%  If cID >= 0 Then
            Response.Write(constructFaqSideMenu(CInt(Request.QueryString("cid"))))
        Else
            Response.Write(constructFaqSideMenu())
        End If
    %>
</asp:Content> 
```

我在另一个论坛[链接](http://dev.communityserver.com/forums/t/472596.aspx)上找到了这个：

> 好吧，看来两者兼而有之。该消息由 Firefox 生成，但由框架引起。出于某种原因，.NET 在创建空页面时会生成“application/xml”响应类型。Firefox 将文件解析为 XML 并找不到根元素，然后吐出错误消息。

IE 不呈现页面，句号。这就是 XML 的来源。

这是constructFaqSideMenu() 函数：

```
Public Shared Function constructFaqSideMenu(ByVal oSelID As Integer) As String
    Dim oCatList As New List(Of faqCategory)
    Dim oRet As New StringBuilder
    Dim iterate As Integer = 1, extraTag As String = ""

    oCatList = sqlStuff.getFaqCats

    oRet.AppendFormattedLine("<ul id={0}>", addQuotes("submenu"))
    oRet.AppendFormattedLine("    <li id={0}>FAQ Categories</li>", addQuotes("title"))
    For Each category As faqCategory In oCatList
        If iterate = oSelID Then
            extraTag = String.Format(" id={0}", addQuotes("active"))
        Else
            extraTag = ""
        End If
        oRet.AppendFormattedLine("    <li{0}><a href={1}>{2}</a></li>", extraTag, addQuotes("faq.aspx?cid={0}", iterate), StrConv(category.Title,         VbStrConv.ProperCase))
        iterate += 1
    Next
    oRet.AppendLine("</ul>")

    Return oRet.ToString
End Function 
```

这是 IE 返回的空白页面的来源：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=windows-1252"></HEAD>
<BODY></BODY></HTML> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-01T21:43:08.047

这是一个非常古老的线程，但我在谷歌搜索相同的问题时发现了这一点，并希望为将来搜索此问题的任何其他人提供明确的答案。

在解析页面指令时引发异常时出现此错误。我从源代码控制更新了 aspx 文件，签入它们的开发人员拥有不同版本的 3rd 方控件库。Register Assembly 页面指令引用了我没有的版本，因此此时抛出了异常。我假设在页面请求生命周期的早期抛出异常以至于根本没有向客户端发送任何异常时，此错误会出现在客户端中。

我们在应用程序级别记录所有异常`Global.Application_Error`，因此我能够从日志中获取此信息。我们使用以下代码获取最后一个异常：

```
Server.GetLastError().GetBaseException() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-19T20:31:11.363

我对 ASP.NET 一无所知，但根据我对 Web 框架的一般经验，听起来您的应用程序根本无法产生任何输出。通常这意味着在任何输出渲染发生之前存在异常，因此请尝试查看日志以找出导致它的原因...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-03-13T15:53:22.957

我遇到了这个问题，至少对我来说发现这是因为在 C# WebAPI 2 中，如果您返回一个空的 Ok() 结果，它将返回 XML 作为内容类型。即使您在 WebAPI 配置中覆盖它以永远不返回 XML。所以我的解决方案是在我拥有的基本控制器类中创建这个函数，并在需要返回空 OK() JSON 响应的任何地方使用它。可以根据他们的需要使其更先进，但这就是我所做的。我想你也可以使用 AttributeFilter，但我做了这个解决方案，因为它在 Action 中的代码数量相同。

```
protected IHttpActionResult OKJSONResult()
{
    HttpResponseMessage response = Request.CreateResponse(HttpStatusCode.OK, "", new MediaTypeHeaderValue("application/json"));
    return ResponseMessage(response);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-22T02:21:58.630

当我部署到 IIS 时，我在所有页面上都遇到了这个问题，解决方案结果是运行应用程序池的帐户没有足够的权限来连接和执行数据库查询

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-12-19T18:39:22.233

我面临着同样的问题。我的解决方案可能不适用于 ASP.NET，我在 node/express 领域工作。我的 API 端点没有在响应中返回任何数据：

```
return res.status(200).end(); 
```

当我在数据响应中包含一些内容时，它解决了这个问题：

```
return res.status(200).send('ok').end(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T05:42:49.463

嘿，同样的错误发生在我身上，这个错误的解决方案是首先打开 iis 管理器，然后在 iis 管理器中，在您的服务器名称下双击 Web 服务扩展，如果您的活动服务器页面被“禁止”，则将其更改为“允许”现在你的asp页面将运行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-19T19:37:27.667

开头没有xml声明

<?xml 版本="1.0"?>

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-19T19:37:39.443

也许是一些编码问题，文件开头的“unicode 序列”损坏或类似的东西？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-22T14:48:51.440

我遇到过同样的问题。这是因为我在 global.asax 中处理了异常，并调用了 Server.ClearError()，而没有调用 Response.Redirect 或类似的方法。我猜，代码失败并且错误被删除，所以 asp.net 无法显示错误消息，也无法显示请求的页面。

我也收到了这个错误，因为我重写了页面的render方法，忘记调用base.render(writer)，从而给浏览器发送了一个空页面。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-06-08T07:41:25.563

我发现了这个问题，因为 URL 被重定向到不同的位置。更正解决了问题。

它被重定向到`http://localhost/forms/abc.aspx`，但它应该被重定向到`http://localhost/projectname/forms/abc.aspx`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-12-17T21:49:58.770

如果您从 .aspx 页面调用 .vb 或 .cs 脚本并收到此错误，请将以下代码添加到 .aspx 页面。FireFox 显然需要一些有效的标记。这对我有用。

```
<html>
<body></body>
</html> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-19T19:40:16.397

也许没有 XML（XML 是一个空白字符串）？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-19T19:41:34.133

该站点是用 ASP.NET 而不是 XML 开发的。这对问题有任何影响吗？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-03-02T07:39:06.580

这可能有两个原因。您可能有一个或多个未封闭的 HTML 标记，或者您可能没有为我们的响应设置内容类型。阅读[http://chiragrdarji.wordpress.com/2010/02/17/xml-parsing-error-no-element-found/](http://chiragrdarji.wordpress.com/2010/02/17/xml-parsing-error-no-element-found/)了解更多详情。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-11-05T18:21:16.907

在新的虚拟机上安装我的服务时遇到了这个问题。（即；尚未在这台机器上运行其他 WCF 服务。）

您需要安装 WCF 服务的映射并将其添加到 IIS 中。最简单的方法如下：

1.  使用提升的管理员权限运行命令提示符

2.  在命令提示符中，导航到 C:\Windows\Microsoft.NET\Framework\v3.0\Windows Communication Foundation

3.  运行命令`ServiceModelReg.exe -i`

4.  通过运行命令重新启动 IIS`iisreset`

# castle-windsor - IoC 容器适用性/场景演示？

> ID：303084
> 
> 赞同：3
> 
> 时间：2008-11-19T19:40:07.397
> 
> 标签：castle-windsor, ioc-container

.NET 领域的很多人都选择了 Castle Windsor 并在他们的项目中实现它，在过去的一年里，我一直在努力弄清楚为什么 IoC 容器似乎被视为一般的“最佳实践”？我已经阅读了很多关于温莎之类的原因的摘要和简要解释，但每一个都确实是抽象的，对于我接触过的大多数项目来说似乎并不实用，但最近我一直遇到很多使用温莎的项目，我不明白为什么。

C#/.NET 固有地支持基于接口的编码、抽象对象、委托和事件。可以直接从核心语言实现 IoC，并使用反射等实例化实现已知接口的未知实例，而无需求助于 IoC 容器库。

在应用 YAGNI/AYGNI（你会需要它吗？）时，我觉得温莎被过度使用了。我当然可以看到 IoC 容器的好处，但我觉得这些好处是以额外的依赖项和元数据为代价的（在核心代码中调用的 IoC 容器特定属性和方法、分散在各处的 .config 文件、app.config/web.config填充了绑定标签，使 .config 文件更难编辑等），所以我试图找出权衡。

也就是说，我接受了我在无知上做出*所有*这些观察/陈述的可能性，因为我从未大量参与过使用 Windsor 或其他 IoC 容器库的项目。我真正需要的是让某人演示一个使用 IoC 容器库的“平均”或“典型”项目，以及为什么这应该是“最佳实践”，而在我看来，这会让原本干净的项目变得混乱具有依赖项和元数据。

如果有人知道任何可以填满我的博客文章、文章或书籍，那就太好了。

（我不是为了争论而争论，而是因为我真的很想接受关于我是否应该在 IoC 容器方面进行自我教育的教育）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T19:56:21.327

这不是您问题的直接答案，因为我不熟悉 Castle-windsor，而且我不是 IoC 专家，但根据我对 Spring 的 java 版本的经验，我可以说（我说的是 Spring在这里，所以可能不是castle-windsor的情况）它不仅仅是依赖注入部分，还有框架本身：声明性事务管理，内置安全框架，ORM支持，内置MVC Web 框架、RMI、Web 服务、Email、AOP 等。它们都与 IoC 很好地集成在一起，并且对于大多数典型场景，框架确实为您做了很多工作。

我认为使用注释自动装配 + IDE 支持（例如 IntelliJ IDEA for Spring）可以缓解配置文件问题。

我不知道 Castle-windsor 是否是 IoC 容器之外的任何东西，但如果是的话，就其作为框架的功能的丰富性而言，它可能还不存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T19:57:07.300

好像你想要[这个问题的答案](https://stackoverflow.com/questions/124871/what-is-castle-windsor-and-why-should-i-care)

显然，如果系统像您所说的那样难以设置，那么在您维护它时它就不值得了。在使用新技术时要牢记这一点。有时，仅仅因为这个因素，旧无聊的东西会更好。

Castle Windsor 本身使用反射，所以它确实是一个包装器，可以按照你想要的方式做事。如果您可以开发一个比 CW 更易于使用的系统，那么您应该这样做，即使它会在初始启动时间上花费您。该成本将首先被 CW 的学习曲线所抵消，因此不会像重新发明轮子一样。

他们[自己](http://www.castleproject.org/container/index.html)说 IoC 不适合小项目，

> 此外，根据项目的规模和复杂性，IoC 容器可能会过大。更喜欢在大中型项目上使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T21:31:19.277

我不一定相信 IoC 容器在所有情况下都是好的。但绝对可以。如果您使用依赖注入或服务定位器来处理依赖关系，那么无论如何您已经走了很长一段路，但是 IoC 容器可以帮助您自动执行操作，为您提供对更高级场景的支持等。

不久前，我试图在一篇博客文章中为自己定义它：

控制反转 (IoC) 容器是一种非侵入式可配置智能工厂组件

将这个定义分成几部分，我们得到

*   工厂，因为它负责为您创建对象。

*   智能，因为它了解您拥有的依赖关系，并递归地为您创建它们。

*   可配置，因为您可以通过代码或配置文件来配置使用。

*   非侵入性，因为使用的对象不需要知道容器。

    -

如果您将它与依赖注入或服务定位器模式一起正确使用，您确实会获得一些非常方便的好处。您不一定需要使用像 Winsor 这样的外部容器，但这确实会给您带来一些额外的好处。

您可以编写更少的代码来实例化新对象。如果您想到更复杂的对象层次结构，IoC 容器可以帮助您自动创建整个链。这可能非常强大。

您可以在测试期间轻松添加对象的模拟版本而不会出现问题（如果您使用 DI 和/或 SL）。例如，为自己创建一个服务定位器也可以解决这个问题。

更改要在构造函数中注入的依赖项并不一定意味着您需要重构大量代码。

您可以通过一个来源获得隧道依赖项的各种好处：装饰器、拦截器、代理以及处理对象的生活方式。使用像 Windsor 这样的容器，这使您能够非常简单地完成一些困难的事情，并且耦合极少

您可以将其设施概念与 NHibernate 平滑集成

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T17:50:57.990

我建议您收听 Software Engineering Radio 播客的第 2 集。这是关于依赖注入的一整集。依赖注入是控制反转框架最广为人知的用法。我还建议听听 John Kovacs 的 DotNetRocks 第 362 集。[这](http://perseus.franklins.net/dotnetrocks_0362_james_kovacs.pdf)是节目的成绩单。

现在，IOC 的一个副作用是增加了可测试性。像 Castle Windsor 这样的 IOC 容器的使用有助于解耦依赖关系。这种解耦有助于更好的单元测试。

大多数 IOC 框架还提供了促进面向方面编程的方法。因此，如果您喜欢 IOC 容器框架，可以帮助您。

# .net - C# 中的 TripleDES 加密

> ID：303096
> 
> 赞同：4
> 
> 时间：2008-11-19T19:43:23.660
> 
> 标签：.net, encryption

我正在尝试使用 ECB 模式进行 TripleDES 加密。我的代码如下所示：

```
public static string EncryptDES(string InputText)
        {
            byte[] key = new byte[] { 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48 };
            byte[] clearData = System.Text.Encoding.UTF8.GetBytes(InputText);
            MemoryStream ms = new MemoryStream();
            TripleDES alg = TripleDES.Create();
            alg.Key = key;
            alg.Mode = CipherMode.ECB;
            CryptoStream cs = new CryptoStream(ms, alg.CreateDecryptor(), CryptoStreamMode.Write);
            cs.Write(clearData, 0, clearData.Length);
            cs.FlushFinalBlock();
            byte[] CipherBytes = ms.ToArray();
            ms.Close();
            cs.Close();
            string EncryptedData = Convert.ToBase64String(CipherBytes);
            return EncryptedData;

        } 
```

当我运行测试时，出现“要解密的数据长度无效”的异常。

有谁知道我做错了什么？

先感谢您。

## 更新

我的错 ！我发现了我的问题，而不是使用`alg.CreateEncryptor()`我正在使用的`alg.CreateDecyptor()`.

复制粘贴问题。:(

谢谢你们的帮助，伙计们

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T19:58:04.753

我的错 ！我发现了我的问题，而不是使用`alg.CreateEncryptor()`我正在使用的`alg.CreateDecyptor()`.

复制粘贴问题。:(

谢谢你们的帮助，伙计们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T19:48:22.823

听起来您的加密方法使用的密钥/盐组合与解密方法不同，它无法解密数据。

在调试期间，将您的密钥和盐转换为可读字符串并浪费循环将它们转换为字节可能是有益的。至少为了可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T19:50:05.067

这可能是编码问题。确保它是 UTF-8 或一些理智的东西。也许是这样的：

```
Public Shared DefaultEncoding As Text.Encoding = _System.Text.Encoding.GetEncoding("Unicode") 
```

（参考：[codeproject.com](https://secure.codeproject.com/KB/security/SimpleEncryption.aspx?display=PrintAll&fid=172899&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=1463997&fr=51#xx1463997xx)）

# java - 如何在 Java 中备份 ArrayList？

> ID：303098
> 
> 赞同：9
> 
> 时间：2008-11-19T19:44:53.440
> 
> 标签：java, arraylist

我有一些数据存储为`ArrayList`. 而当我想备份这些数据时，java 会永远绑定两个对象。这意味着当我更改数据中的值时，`ArrayList`这些更改就会备份。我尝试将数据中的值分别复制到循环中的备份，尝试使用方法`data.clone()`- 没有任何帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-19T19:53:30.147

你的问题不是很清楚。如果您 clone() 一个 ArrayList，如果您更改原始内容（即添加或删除元素），克隆将不会被修改，但它是“浅拷贝”，因此如果您更改原始对象中的实际对象，它们将也可以在克隆中进行更改。

如果要进行“深拷贝”，以便对实际对象的更改不会影响它们在克隆中的备份，那么您需要创建一个新的 ArrayList 然后遍历原始的，并且对于每个元素，克隆它进入新的。如在

```
ArrayList backup = new ArrayList();
for (Object obj : data)
   backup.add(obj.clone()); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-19T19:53:52.093

我认为您需要`.clone()`单个对象。克隆`ArrayList`并不“深”；它只会克隆对对象的引用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-19T19:53:46.870

我假设`data`是`ArrayList`您要备份的名称。如果是这样，您应该知道这`clone`并不*深*- 它只创建调用它的对象的副本，在这种情况下是列表。如果它是深度克隆，它将用其中对象的克隆填充新列表。

由于它不深，如果您更改列表包含的对象，那么备份列表也会显示这些更改，因为它包含相同的对象。更改“当前”列表后，您唯一不会在备份中看到更改的情况是在当前列表中添加或删除对象时。

有些类可能会覆盖`clone`到很深，但不是全部。一般来说，这不是你可以依赖的东西。创建 Java 集合的备份副本时，请记住要么克隆包含的对象，要么只处理不可变对象的集合。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-19T19:52:47.027

所有这些过程都会产生浅拷贝。如果您要更改数组中的对象的属性，则这两个数组具有对同一实例的引用。

```
List org = new java.util.ArrayList();
org.add(instance)
org.get(0).setValue("org val");
List copy = new java.util.ArrayList(org);
org.get(0).setValue("new val"); 
```

`copy.get(0).getValue()`也会返回`"new val"`，因为`org.get(0)`并`copy.get(0)`返回完全相同的实例。您必须像这样执行深层复制：

```
List copy = new java.util.ArrayList();
for(Instance obj : org) {
    copy.add(new Instance(obj)); // call to copy constructor
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-19T22:30:33.743

取决于你需要什么。浅拷贝（列表中的项目与原始项目相同）：

```
ArrayList backup = new ArrayList(mylist.size());
backup.addAll(mylist); 
```

深拷贝（项目也是副本）：

```
ArrayList backup = new ArrayList(mylist.size());
for(Object o : mylist) {
    backup.add(o.clone());
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-19T19:52:14.673

听起来（如果我正确地解释了您的问题；这有点困难）就像您没有将 ArrayList 中引用的数据复制到备份中一样；您正在复制参考。

在不知道要存储/备份的数据类型是什么的情况下，很难准确地说出如何解决您的问题，但请确保您正在复制 ArrayList 中包含的数据元素。这意味着除其他外，要对列表的元素执行 clone() 之类的操作，而不是在 ArrayList 上执行操作（因为这将创建一个新的克隆列表，其中包含对相同对象的引用的副本）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T21:25:24.673

关于克隆问题，一旦我通过将整个集合序列化为一个字符串然后将其序列化回一个新对象来解决这个问题。这迫使您使所有对象可序列化，并在两个对象真正想要引用单个第三个对象时采用，但它可以很好地平衡简单性和实用性。

实际上，我还没有尝试过，但是您可能可以使用管道在同一时间进行序列化和序列化，这样您就不会在内存中存储 3 个副本（如果它是一个巨大的集合）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-08T14:33:12.807

这是一个功能齐全的 ArrayList 备份类，用于检查 ArrayList 是否已存在。基本上它只是一个循环遍历列表并将它们手动添加到新列表中。

```
import java.util.ArrayList;

public class Snapshot {
    private ArrayList<Integer> dataBackup;

    public Snapshot(ArrayList<Integer> data)
    {
        dataBackup = new ArrayList<Integer>();
        for(int i = 0; i < data.size(); i++)
        {
            dataBackup.add(data.get(i));
        }
    }

    public ArrayList<Integer> restore()
    {
        return dataBackup;
    }

    public static void main(String[] args)
    {
        ArrayList<Integer> list = new ArrayList<Integer>();
        list.add(1);
        list.add(2);

        Snapshot snap = new Snapshot(list);

        list.set(0, 3);
        list = snap.restore();

        System.out.println(list); // Should output [1, 2]

        list.add(4);
        list = snap.restore();

        System.out.println(list); // Should output [1, 2]
    }
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-19T21:46:30.260

我还没有尝试过，但我认为 Collections.copy 会这样做。

[编辑] 现在，我尝试了：

```
static String GetRandomString(int length)
{
  UUID uuid = UUID.randomUUID();
  return uuid.toString().substring(0, length);  
}

public static void main(String[] args)
{
  ArrayList<String> al = new ArrayList<String>(20);
  for (int i = 0; i < 10; i++)
  {
    al.add(GetRandomString(7));
  }
  ArrayList<String> cloneArray = new ArrayList<String>(al);
  Collections.copy(cloneArray, al);
  System.out.println(al);
  System.out.println(cloneArray);
  for (int i = 9; i >= 0; i -= 2)
  {
    al.remove(i);
  }
  System.out.println(al);
  System.out.println(cloneArray);
} 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2008-11-19T19:50:47.513

您可以编写一个包含两个 ArrayList 的对象。任何东西都写它，以便它同时添加、删除和修改两者中的数据。

# vb.net - 从 VB 快速向 Oracle 数据库插入多行的问题

> ID：303099
> 
> 赞同：1
> 
> 时间：2008-11-19T19:46:11.097
> 
> 标签：vb.net, oracle, loops

我正在尝试将多行一个接一个地插入到数据库中。这是相关的代码。

```
Private ConnectionString As String = "Provider=OraOLEDB.Oracle;Data Source=(DESCRIPTION=(CID=GTU_APP)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=xxx)(PORT=xxx)))(CONNECT_DATA=(SID=xxx)(SERVER=DEDICATED)));User Id=xxx;Password=xxx;"
Private SQL As String = "INSERT INTO XXX.BU_LOG (PROGRAM, LOCATION, MESSAGE, TIMESTAMP, ""LEVEL"", COMPUTER, ""USER"") "
Dim Connection As New OleDbConnection(ConnectionString)
Dim Command As OleDbCommand

'The SQL variable is the first part of an insert statement
SQLValues = "VALUES ('" & Program & "','" & Location & "','" & Message & "','" & Timestamp & "','" & LevelName & "','" & Computer & "','" & User & "')"

Dim Command As New OleDbCommand(SQL & SQLValues, Connection)

Connection.Open()
Command.ExecuteNonQuery()
Connection.Close() 
```

现在，如果我调用它一次它会很好。如果我从不同的按钮（为每个按钮插入不同的值）调用它两次，效果很好。但是，当我在同一个按钮中调用代码两次时，一个接一个地插入两行，但第二行与第一行相同。我检查了命令文本，它在执行查询时是正确的，但它复制了行。

如果我在调用第二个插入之前让线程休眠 500 毫秒，它工作正常。但如果我只睡 100 毫秒，它就会重复。有任何想法吗？

* * *

编辑：对不起，如果我不清楚。问题不在于 Timestamp 列。事实上，Timestamp 列有欺骗是可以的。我是这样称呼它的。

```
log.Write(My.Application.Info.AssemblyName, System.Reflection.MethodBase.GetCurrentMethod.Name, "Hello World!")
log.Write(My.Application.Info.AssemblyName, System.Reflection.MethodBase.GetCurrentMethod.Name, "Testing", , VB2008_Log_Dll.Log.mLevel.Fatal) 
```

如您所见，第一个只是写“Hello World！” 第二个写“测试”。当我运行程序时，我得到两行“Hello World！”。我希望这能让它更清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T21:32:40.040

TIMESTAMP 列的数据类型是什么？如果是 DATE，Oracle DATE 的值只能精确到 1 秒，所以半秒左右的两次插入很可能最终得到相同的列值。

有一种较新的数据类型称为 TIMESTAMP，它可以精确到几分之一秒，如果合适，您可以使用它来代替。

# c# - 通过引用传递的数组的修改

> ID：303109
> 
> 赞同：3
> 
> 时间：2008-11-19T19:48:16.630
> 
> 标签：c#, arrays

我最近遇到了一些 3rd 方 C# 代码，它执行以下操作：

```
public int RecvByteDataFromPrinter(ref byte[] byteData)
{
    byte[] recvdata = new byte[1024];

    ///...fills recvdata array...       

    byteData = recvdata;
    return SUCCESS;
} 
```

在这种情况下， “ `byteData = recvdata`”行实际上做了什么？

看来目标是让 byteData 包含 recvdata 数组的内容。但是，我的印象是，您需要进行`Array.Copy(...)`手术才能做到这一点。

这实际上是在修改 byteData 引用以指向新分配的数组吗？如果是这样，该数组是否保证会保留？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T19:53:13.140

是的，因为 ref - 它确实修改了传递的引用。停在附近？你的意思是 - 没有被摧毁？是的，由于有新的引用，它不会被 GC 处理。如果没有更多引用，则在此分配之后，旧数组（已通过）可能会被 GC...

Array.Copy 实际上会复制元素，那么你就不需要“ref”，但这会比较耗时

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T19:56:43.773

你猜对了，赋值是修改 byteData 数组引用以指向新分配的数组（因为 'ref' 关键字）。函数的调用者将“看到”recvData 数组的内容（无论那里填写什么）。

是的，只要剩下一个对它的引用，数组就会一直存在（在这种情况下，无论你传递给这个函数的数组是什么）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T19:54:58.177

该代码会将 recvdata 数组引用分配给 byteData 数组引用。.NET 将在其垃圾收集逻辑的幕后跟踪分配，因此只要 byteData 在范围内，最初分配给 recvdata 的字节数组就不会消失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T19:53:54.950

byteData 引用现在将指向 recvdata 数组，给它一个根。它将“坚持”直到它的所有根都消失了（即被调用者摆脱了传入的 byteData 对象）并且它成为一个集合候选者。方法返回后，传递的原始数组对象是收集的候选对象。

# sql-server - 推荐的数据聚合框架

> ID：303111
> 
> 赞同：1
> 
> 时间：2008-11-19T19:48:36.490
> 
> 标签：sql-server, replication, sql-server-ce, microsoft-sync-framework

我们有一个应用程序，它将收集数据并将其存储在使用 Microsoft SQL Server Compact 的本地 WinXP PC 中。我们希望将这些数据聚合到一个完整的 SQL Server 以进行报告和归档。尽管可以接受一些延迟（最多一分钟或两分钟），但数据传输需要相当连续（即不成批处理）。

数据是从收集器到服务器的单向推送。收集器永远不需要知道其他收集器在做什么，主服务器永远不会更新收集器上的数据。目前的计划是针对 5 个收集器，但它的可扩展性基本上是无限制的。

我们必须假设我们将“大部分连接”，但我们不能保证从收集器到服务器的连接。如果服务器或网络出现故障，我们仍会收集数据，并且当服务器再次可访问时，数据将被推送回来。

理想情况下，我们希望在我们完成基础设施工作后，非编程工程师可以设置一个解决方案。因此，我们可以编写一些代码和向导，但不能假定最终用户对编写代码一无所知，尽管他们具有合理的计算机技术素养。

现在我们有两种技术候选：

1.  SQL 复制
2.  微软同步服务

我们对第一个没有什么经验，但是我们知道在 SQL Server 中设置订阅等是痛苦的，调试它们也不好玩，所以我们正在尝试寻找替代方案。

我们对#2 几乎一无所知，只是有人建议将其作为将设备数据传输到服务器的替代方案。

有没有人在这种情况下有经验，或者使用这两种技术中的一种/两种，或者我们认为他们可以分享的任何东西？收集器上的 SQL Compact 是一个固定要求。服务器上的 SQL Server 不是必需的，但由于客户已经拥有它而需要它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-29T01:01:25.330

我在完全发布之前使用过 Microsoft Sync Services。我喜欢它，它似乎非常适合您的应用程序。

我建议，如果你想让自己的生活更轻松，是使用 GUID（SQL Server 唯一标识符）作为要同步到主服务器的所有表的主键。这将防止冲突和大量额外的编码。

一个警告：我听说同步服务在第一个版本发布后发生了重大变化，所以我的信息可能已经过时了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T20:51:22.073

尝试同步并告诉我们它是如何进行的 :) 我看到了一个 MSFT 事件，这个人说：“我添加了这 3 行代码，所有内容都同步了......呜呜呜”。

听起来像我要走的路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-29T00:54:47.947

复制的问题在于，当您的架构发生更改时，您将需要在每个客户端上进行手动工作以使复制重新启动并运行。我没有使用同步服务的经验，但我会问同样的问题：架构更改时会发生什么？如果您必须接触每个客户，那可能是个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T15:55:10.620

我最终选择了选项 3：两者都不是。相反，我们只是定期（用户可调整，但默认为 5 秒）使用[SqlBulkCopy 类](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)来复制记录。这很有效，因为它允许我们传入 IDataReader，因此我们使用 TableDirect 在本地打开表，从远程表中查找最高的 RowID，然后将读取器传递给 WriteToServer 类。

# architecture - 直接从 Windows 客户端访问数据库 - 好还是坏？

> ID：303112
> 
> 赞同：0
> 
> 时间：2008-11-19T19:48:46.053
> 
> 标签：architecture

假设这是一个多用户系统

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T19:51:39.337

我不知道它本质上是好是坏。如果没有理由从业务角度集中数据访问，那么让客户端应用程序直接与数据库对话就不是问题。无论是在客户端还是通过集中式数据访问服务器，您都需要构建一个体面的数据访问层。

您提到了多用户，根据数据和使用情况，您可能需要处理事务问题，这可能是集中事务的一个论据，但也可以从多个客户端处理它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T20:03:52.950

业务应用程序的非常常见的要求，所以很好。

不过，不要尝试将 MS Access 用作多用户应用程序的后端。那会很糟糕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T20:10:20.080

出于安全原因，我更喜欢通过 Web 服务访问数据库。这样，您不必在客户端应用程序中拥有数据库用户 ID/密码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T21:42:49.927

我建议使用存储过程，因为内联数据库编码是不安全的（例如 sql 注入），并且如果将来需要对存储过程进行更改，很有可能您不必推出更新的应用程序（取决于它的编码方式）。

如果您担心用户之间的某种竞争条件，那么您可以使用提交/回滚事务。

# groovy - 是否有与 beanshell source() 方法等效的 groovy 方法？

> ID：303113
> 
> 赞同：1
> 
> 时间：2008-11-19T19:48:52.027
> 
> 标签：groovy, beanshell

我搜索了 groovy doc 并没有找到类似的东西，但是那里的东西组织得有点随意。我正在从 beanshell 切换到 groovy，并且正在使用 beanshell 中的 source("fileloc") 方法来内联包含其他实用程序 beanshell 脚本以供重用。是否有标准功能可以在 groovy 或最佳实践中执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-20T19:06:48.040

您可以将脚本的所有部分组合成一个字符串，然后让 GroovyShell 对象评估您的脚本。我从 Venkat Subramanium 的 DSL 示例中选择了这个。

```
part1 = new File("part1.groovy").text
part2 = new File("part2.groovy").text

script = """
println "starting execution"
${part1}
${part2}
println "done execution"
"""

new GroovyShell().evaluate(script) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T20:19:46.753

您没有找到它的原因是因为 Groovy 已编译。您的 Groovy 代码被编译成 Java 字节码，由 JVM 与您应用程序中的任何 Java 代码一起运行。这就是为什么像为大量 Java 代码编写 Groovified 单元测试这样的事情需要零额外的努力。

BeanShell 是一种类似 Java 的*解释*型语言，因此在运行时输入另一段代码没什么大不了的。

也就是说，您可能对[groovysh](http://groovy.codehaus.org/Groovy+Shell#GroovyShell-RecognizedCommands)及其`load`命令感兴趣。

# winforms - System.Windows.Threading.Dispatcher 和 WinForms？

> ID：303116
> 
> 赞同：31
> 
> 时间：2008-11-19T19:49:47.190
> 
> 标签：winforms, multithreading, dispatcher, begininvoke

是否在应用程序[`System.Windows.Threading.Dispatcher`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx)的 UI 线程上工作`WinForms`？

如果是，为什么？它来自似乎是一个`WPF`组件的 WindowsBase.dll。

如果没有，我如何将工作单元调用回 UI 线程？我找到了[`Control.BeginInvoke()`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx)，但是创建一个控件来引用原始线程似乎很笨拙。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-07-21T15:42:42.020

您`Dispatcher`甚至可以在 WinForms 应用程序中使用。

如果您确定在 UI 线程上（例如在 button.Click 处理程序中），则为`Dispatcher.CurrentDispatcher`您提供 UI 线程分派器，您以后可以使用它像往常一样从后台线程分派到 UI 线程。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-19T20:17:10.923

Dispatcher 是 WPF 组件，而不是 WinForms 组件。

如果您想在 UI 线程上分派工作项，那么您将不得不使用您已经找到的 Control.BeginInvoke，或者跨线程对 ResetEvents/WaitObjects 做出反应。

通常在 UI 线程上调用工作项是一件坏事，除非它是 UI 工作（即更新控件的内容或其他东西），在这种情况下 Control.BeginInvoke() 就足够了。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-04-15T04:30:26.543

[我在对问题](https://stackoverflow.com/questions/15998459/parallel-programming-using-tpl-on-winforms/16007528#16007528)“在 WinForms 上使用 TPL 进行并行编程”的回答中提供了一个`System.Windows.Threading.Dispatcher`在 Windows 窗体中使用的示例，因为[您之前回答了您的问题](https://stackoverflow.com/a/1160035/200449)：

> 如果您确定在 UI 线程中（例如，在 button.Click 处理程序中），Dispatcher.CurrentDispatcher 为您提供 UI 线程调度程序，您可以使用它像往常一样从后台线程调度到 UI 线程。

要么具有误导性，要么令人困惑，要么缺乏具体的使用上下文：

*   `button.Click`处理程序不保证在 UI 线程上；
*   如果你不在 UI 线程上，仍然可以使用 WinForms 表单的 UI 线程的调度程序

可以获取 WinForm UI 线程的调度程序：

```
Dispatcher dispatcherUI = Dispatcher.CurrentDispatcher; 
```

在按钮单击事件处理程序或其他任何地方（在表单构造函数中）

然后使用它在其他线程的 UI 上执行，在[我的答案](https://stackoverflow.com/questions/15998459/parallel-programming-using-tpl-on-winforms/16007528#16007528)中查看下面示例的更多详细信息：

```
private void button1_Click(object sender, EventArgs e)
{
  Dispatcher dispUI = Dispatcher.CurrentDispatcher;
  for (int i = 2; i < 20; i++)
  {
    int j = i;
    var t = Task.Factory.StartNew
           (() =>
      {
        var result = SumRootN(j);
        dispUI.BeginInvoke
            (new Action
                 (() => richTextBox1.Text += "root " + j.ToString()
                       + " " + result.ToString() + Environment.NewLine
                 )
             , null
            );
      }
           );
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T20:29:34.340

我在使用在 Winforms 中自己的线程上运行的 Oracle 依赖类时遇到了类似的问题，

当从 Oracle Dependency 触发 OnChange 事件时，我想通过简单地将 DataSource 设置为 eventargs.Details（本质上是一个 DataTable）来显示 DataGridView 中的更改，并且它抛出： **System.InvalidOperationException is unhandled by user code Message=Cross-thread operation无效：控件“dataGridView1”从创建它的线程以外的线程访问。**

StackOverflow 用户 Brian Peiris (bpeiris@gmail.com)，我的同事向我展示了这种方式：

```
void dep_OnChange(object sender, OracleNotificationEventArgs arg)
         {
         Console.WriteLine("Notification received");

         int infoSum = int.Parse(arg.Details.Compute("Sum(Info)", "Info is not null").ToString());
         InfoSum x = (InfoSum)infoSum;
         foreach (DataRow dr in arg.Details.Rows)
            {
            Console.WriteLine(string.Format("Operation(InfoSum)= {0}", Enum.GetName(typeof(InfoSum), x)));
            Console.WriteLine(string.Format("ontable={0}  Rowid={1},info={2}", dr.Field<string>("ResourceName"), dr.Field<string>("rowid"), dr.Field<Int32>("info")));
            }
         // Following  will throw cross-thread 
         // dataGridView1.DataSource = arg.Details;
         // instead of line above use the following
         dataGridView1.BeginInvoke((Action)(()=>dataGridView1.DataSource = arg.Details));
         IsNotified = true;
         }

      } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T20:31:50.333

使用后台工作线程，因为它可以感知 UI 消息泵，[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc163328.aspx)虽然主要是关于 WPF 的，但确实指出 BWT 是 UI 感知的，即使对于 Windows 窗体也是如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-25T15:34:43.837

有时 Timer 组件很有用且易于在 WinForms 中设置，只需设置其间隔然后启用它，然后确保您在其 Tick 事件处理程序中做的第一件事就是禁用它自己。

我认为 Timer 在其自己的线程中运行代码，因此您可能仍需要执行 BeginInvoke（调用 WinForm 对象 [this]）来运行您的 Action。

```
private WebBrowserDocumentCompletedEventHandler handler; //need to make it a class field for the handler below (anonymous delegates seem to capture state at point of definition, so they can't capture their own reference)
private string imageFilename;
private bool exit;

public void CaptureScreenshot(Uri address = null, string imageFilename = null, int msecDelay = 0, bool exit = false)
{
  handler = (s, e) =>
   {
     webBrowser.DocumentCompleted -= handler; //must do first

     this.imageFilename = imageFilename;
     this.exit = exit;

     timerScreenshot.Interval = (msecDelay > 0)? msecDelay : 1;
     timerScreenshot.Enabled = true;
   };

  webBrowser.DocumentCompleted += handler;
  Go(address); //if address == null, will use URL from UI
}

private void timerScreenshot_Tick(object sender, EventArgs e)
{
  timerScreenshot.Enabled = false; //must do first

  BeginInvoke((Action)(() => //Invoke at UI thread
  { //run in UI thread

    BringToFront();
    Bitmap bitmap = webBrowser.GetScreenshot();

    if (imageFilename == null)
      imageFilename = bitmap.ShowSaveFileDialog();

    if (imageFilename != null)
    {
      Directory.CreateDirectory(Path.GetDirectoryName(Path.GetFullPath(imageFilename))); //create any parent directories needed
      bitmap.Save(imageFilename);
    }

    bitmap.Dispose(); //release bitmap resources

    if (exit)
      Close(); //this should close the app, since this is the main form

  }), null);
} 
```

您可以在从网站抓取屏幕截图的 WebCapture 工具（[http://gallery.clipflair.net/WebCapture](http://gallery.clipflair.net/WebCapture)，源代码位于：http: [//ClipFlair.codeplex.com](http://ClipFlair.codeplex.com)，参见 Tools/WebCapture 文件夹）中看到上述内容。顺便说一句，如果您想从命令行调用可执行文件，请确保您转到项目的属性并在安全选项卡中关闭 ClickOnce 安全性（否则它无法访问命令行）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-14T23:15:06.277

看看[背景](http://code.google.com/p/backgrounder/)，看看它是否符合您的需求。

# java - 更改 NetBeans UI 外观

> ID：303122
> 
> 赞同：4
> 
> 时间：2008-11-19T19:50:38.187
> 
> 标签：java, macos, swing, netbeans, interface

是否有可能以某种方式改变 NetBeans 的外观/感觉？我知道它使用 Swing，并且通常使用 Swing 作为其 UI 的应用程序通常可以更改其 UI 方案。

OSX 的默认外观令人呕吐，甚至会满足于某种准系统`default`外观。整个外观太分散注意力和不必要了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T19:53:14.997

看起来这可能是我正在寻找的：

[http://wiki.netbeans.org/FaqCustomLaf](http://wiki.netbeans.org/FaqCustomLaf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-29T16:31:25.397

**要更改 netbeans 7.2.1 的默认外观，请转到主目录\Program file \netbeans 7.2.1\etc；**

现在打开**netbeans.confg**文件并找出以下文本。

netbeans_default_options="-J-client -J-Xss2m -J-Xms32m -J-XX:PermSize=32m -J-Dapple.laf.useScreenMenuBar=true -J-Dapple.awt.graphics.UseQuartz=true -J-Dsun. java2d.noddraw=true -J-Dsun.zip.disableMemoryMapping=true"

**现在添加以下文本**；

*-- laf com.sun.java.swing.plaf.nimbus.NimbusLookAndFeel；*

**现在它看起来像;**

netbeans_default_options="-J-client -J-Xss2m -J-Xms32m -J-XX:PermSize=32m -J-Dapple.laf.useScreenMenuBar=true -J-Dapple.awt.graphics.UseQuartz=true -J-Dsun. java2d.noddraw=true -J-Dsun.zip.disableMemoryMapping=true ***--laf com.sun.java.swing.plaf.nimbus.NimbusLookAndFeel"***

**//现在可以看到netbeans的新外观（NimbusLookAndFeel）**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T19:53:24.093

请参阅此问题的答案： [NetBeans 6.5 上的强制外观](https://stackoverflow.com/questions/231738/force-look-and-feel-on-netbeans-65#233855)

# content-management-system - DotNetNuke 中的“Nuke”是什么意思？

> ID：303124
> 
> 赞同：6
> 
> 时间：2008-11-19T19:51:08.527
> 
> 标签：content-management-system, dotnetnuke

一位同事问我“Nuke”这个词与 CMS 有什么关系？老实说，我从来没有想过它，而且我在网上找不到任何信息。

Francisco Burzi 写道，他用来管理内容的 Perl 脚本称为 NUKE。他对该系统的了解促使他将该软件适应 phpNuke。

有谁知道 NUKE 代表什么以及它与内容管理有何关系？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T19:57:08.827

Nuke 一词起源于 phpNuke 和 PostNuke 等后续分支。dotnetNuke 刚刚采用了 php 版本中的术语。

我不知道为什么 phpNuke 被这样命名，但谷歌来救援！

[http://74.125.95.132/search?q=cache:atpksHABV2AJ:www.uiarch.org/CMpro-vp-36.htm+origins+of+name+NUKE+cms&hl=en&ct=clnk&cd=10&gl=us](http://74.125.95.132/search?q=cache:atpksHABV2AJ:www.uiarch.org/CMpro-v-p-36.htm+origins+of+name+NUKE+cms&hl=en&ct=clnk&cd=10&gl=us)

简而言之，“这个名字取自弗朗西斯科的用户名 Nuke，当时他还是个破解者”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T19:56:33.540

来自常见问题解答（[http://www.dotnetnuke.com/Resources/Knowledge/FrequentlyAskedQuestions/tabid/546/Default.aspx](http://www.dotnetnuke.com/Resources/Knowledge/FrequentlyAskedQuestions/tabid/546/Default.aspx)）

> “选择新名称是为了反映应用程序 .NET (DOTNET) 框架，并与“nuke”一词相结合（由于 *nuke 固有的、行业认可的包含在几个现有的开源门户计划中。）”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T14:30:25.853

微波炉生产**垃圾**食品。所以他选择**phpnuke**是因为另一个选择是**junkphp**？

疯狂的 ：-）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-19T19:57:15.893

我听说它与使用微波炉的俚语有关。使用 CMS 可以方便地更新网站，就像使用微波炉比使用真正的烤箱更快、更简单一样。但这只是道听途说。

# .net - 带有 LIKE 和 IN 条件的参数化查询

> ID：303149
> 
> 赞同：53
> 
> 时间：2008-11-19T19:56:07.520
> 
> 标签：.net, sql, parameters, sql-injection, parameterized

.Net 中的参数化查询在示例中总是如下所示：

```
SqlCommand comm = new SqlCommand(@"
   SELECT * 
   FROM   Products 
   WHERE  Category_ID = @categoryid
", 
   conn);
comm.Parameters.Add("@categoryid", SqlDbType.Int);
comm.Parameters["@categoryid"].Value = CategoryID; 
```

但我在尝试执行以下操作时遇到了砖墙：

```
SqlCommand comm = new SqlCommand(@"
   SELECT * 
   FROM   Products 
   WHERE  Category_ID IN (@categoryids) 
      OR  name LIKE '%@name%'
", 
   conn);
comm.Parameters.Add("@categoryids", SqlDbType.Int);
comm.Parameters["@categoryids"].Value = CategoryIDs;
comm.Parameters.Add("@name", SqlDbType.Int);
comm.Parameters["@name"].Value = Name; 
```

在哪里

*   CategoryIDs 是逗号分隔的数字列表“123,456,789”（不带引号）
*   名称是一个字符串，可能带有单引号和其他坏字符

什么是正确的语法？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-11-19T21:26:52.063

假设您有一个整数数组中的类别 ID，并且 Name 是一个字符串。诀窍是创建命令文本以允许您输入所有类别 ID 作为单独的参数，并为名称构建模糊匹配。为实现前者，我们使用循环构造一系列参数名称@p0 到@pN-1，其中 N 是数组中类别 ID 的数量。然后我们构造一个参数并将其添加到命令中，并将关联的类别 id 作为每个命名参数的值。然后我们在查询本身中对名称使用连接以允许对名称进行模糊搜索。

```
string Name = "someone";
int[] categoryIDs = new int[] { 238, 1138, 1615, 1616, 1617,
                                1618, 1619, 1620, 1951, 1952,
                                1953, 1954, 1955, 1972, 2022 };

SqlCommand comm = conn.CreateCommand();

string[] parameters = new string[categoryIDs.Length];
for(int i=0;i<categoryIDs.Length;i++)
{
   parameters[i] = "@p"+i;
   comm.Parameters.AddWithValue(parameters[i], categoryIDs[i]);
}
comm.Parameters.AddWithValue("@name",$"%{Name}%");
comm.CommandText = "SELECT * FROM Products WHERE Category_ID IN (";
comm.CommandText += string.Join(",", parameters) + ")";
comm.CommandText += " OR name LIKE @name"; 
```

这是一个完全参数化的查询，应该会让您的 DBA 满意。我怀疑由于这些是整数，尽管直接使用值构造命令文本并仍然参数化名称不会有太大的安全风险。如果您的类别 ID 在字符串数组中，只需用逗号分割数组，将每个数组转换为整数，然后将其存储在整数数组中。

**注意：**我说数组并在示例中使用它，但它应该适用于任何集合，尽管您的迭代可能会有所不同。

[来自http://www.tek-tips.com/viewthread.cfm?qid=1502614&page=9](http://www.tek-tips.com/viewthread.cfm?qid=1502614&page=9)的原创想法

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-19T20:05:08.657

您需要在 sql 参数的值中使用“%”。

```
SqlCommand comm = new SqlCommand("SELECT * FROM Products WHERE Category_ID IN (@categoryid1, @categoryid2) OR name LIKE @name", conn);
comm.Parameters.Add("@categoryid1", SqlDbType.Int);
comm.Parameters["@categoryid1"].Value = CategoryID[0];
comm.Parameters.Add("@categoryid2", SqlDbType.Int);
comm.Parameters["@categoryid2"].Value = CategoryID[1];
comm.Parameters.Add("@name", SqlDbType.NVarChar);
comm.Parameters["@name"].Value = "%" + Name + "%"; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-19T20:43:28.593

这种方法行不通。时期。

IN 子句本身需要一个参数列表，因此当您将*一个*参数绑定到它时，您有机会传入*一个*值。

使用您打算传入的各个 IN 子句占位符的确切数量动态构建您的语句字符串，然后在循环中添加参数并将值绑定到它们。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-11-19T20:37:07.140

不确定这是否是正确的方法，但这是我在之前做过的方法

列表临时列表 = 新列表

comm.Parameters.Add("@categoryids", SqlDbType.varchar); comm.Parameters["@categoryids"].value = string.join(",",templist.toarray())

# sql-server - SQL Server 2005：“保护”存储过程免受 MS Access 使用的 FMTONLY 模式的影响

> ID：303152
> 
> 赞同：0
> 
> 时间：2008-11-19T19:56:34.337
> 
> 标签：sql-server, ms-access, stored-procedures, coding-style

我们拥有的一些存储过程包含条件逻辑，如下所示：

```
Create Procedure dbo.DoSomething(Some Parameters)
As
    ...
    If (Some Condition) Begin
        Set @SomeVariable = SomeValue                
    End
    ...
    Select ... 
```

当这样的存储过程用作 MS Access 表单的记录源，并且用户尝试使用表单的内置排序/过滤功能时，MS Access 会尝试在 FMTONLY 模式下执行存储过程（显然，寻找存储过程提供的行集）。

大多数人都知道（现在包括我们自己:-)，当 FMTONLY 设置为 ON 时，SQL Server 会忽略条件语句。在下面的例子中，**`Set @SomeVariable = SomeValue`**不管是否**`Some Condition`**为真，语句都会执行，这显然给我们带来了一些麻烦。

```
-- EXAMPLE
-- -------
Create Procedure dbo.DoSomething(..., @vcSomeDate as VarChar(50), ...)
As
   ...
   Declare @dtSomeDate As Datetime
   If (IsDate(@vcSomeDateOrAgeInDays)) Begin
       -- The next statement fails miserably when FMTONLY=ON
       Set @dtSomeDate = @vcSomeDateOrAgeInDays
   End Else Begin
       ...
   End
   ... 
```

为了规避这个问题，我们像这样“包装”条件逻辑（或任何其他受 FMTONLY 影响的代码片段）：

```
Create Procedure dbo.DoSomething(Some Parameters)
As
    ...

    -- HACK: Protection from unexpected FMTONLY mode
    Declare @wasFmtonlyOn As Bit; If (0 = 1) Set @wasFmtonlyOn = 1; SET FMTONLY OFF
    ...
    If (Some Condition) Begin
        Set @SomeVariable = SomeValue                
    End
    ...
    -- /HACK: Protection from unexpected FMTONLY mode
    If (@wasFmtonlyOn = 1) SET FMTONLY ON

    ...
    Select ... 
```

（“保护代码”的这种丑陋的单行格式是故意的：我们认为解决一些奇怪问题所需的黑客不值得适当的格式；恰恰相反，我们认为它们应该适合尽可能少的代码行. :-)

无论如何，这种“保护”工作得很好，但它有点过于冗长，并且没有我们想要的那样封装。例如，我们肯定更喜欢隐藏 hack 的实际逻辑 - 例如在这样的标量 UDF 后面：

```
Create Procedure dbo.DoSomething(Some Parameters)
As
    ...

    declare @wasFmtonlyOn as bit; set @wasFmtonlyOn = dbo.SetFmtonly(0)
    ...
    If (Some Condition) Begin
        Set @SomeVariable = SomeValue                
    End
    ...
    dbo.SetFmtonly(@wasFmtonlyOn)

    ...
    Select ... 
```

不幸的是，这似乎不起作用 - 标量 UDF 和另一个存储过程都不起作用。看起来 FMTONLY 阻止从任何地方返回任何数据。所以，**主要问题来了**：

> *如果您还必须处理这个问题（SQL Server 在 FMTONLY 模式下忽略条件），您是否能够想出比上述更好的“保护习语”？*

顺便说一句，我仍然不明白一件事：这个问题是 SQL Server 2005 中的错误还是功能？如果它是一个特性，那么它有什么好的理由呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-22T10:09:40.917

那这个呢？

```
If (Some Condition) Begin
    Set @SomeVariable = SomeValue
ELSE
    Set @SomeVariable = @SomeVariable --or dummy/default value?
End 
```

您的代码是否基于此变量返回 2 个不同的记录集（列和类型）？如果是这样，您必须将存储的过程分成 2

此外，我还找到了一篇解释原因的[知识库文章。](http://support.microsoft.com/?kbid=933248)

编辑：将分支更改为内联代码...

```
Set @dtSomeDate = CASE WHEN ISDATE(@vcSomeDateOrAgeInDays) = 1 THEN @vcSomeDateOrAgeInDays ELSE NULL END 
```

# sql-server - SQL Server 应用程序在 32 位和 64 位版本的 SQL Server 之间的可移植性？

> ID：303161
> 
> 赞同：3
> 
> 时间：2008-11-19T19:58:57.280
> 
> 标签：sql-server, 64-bit, migration

我有一个当前针对 32 位 SQL Server 2005 标准版数据库运行的应用程序。由于我不会在这里详细介绍的原因，我需要将数据库移动到在 64 位 Windows Server 2003 R2 Datacenter 上运行的 64 位 SQL Server 2005 标准版。

在应用程序代码、存储过程或 SQL 配置中是否有任何我应该注意的迁移问题？也就是说，两个平台上的功能是否相同？

如果存在功能差异，您能否发布指向包含迁移计划提示的文档的链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-21T04:35:44.787

一般来说，这是小菜一碟。我们一直都在做这件事，没有任何问题。纯 t-sql 代码的功能是相同的（64 位性能更好;-)。

我遇到的一个例外是扩展存储过程。由于这些是用 C 编写的，因此必须将它们重新编译为 64 位二进制文​​件。即使这样，也不需要更改源代码。

如果您不使用扩展存储过程，您应该没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T20:05:16.080

[我知道](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=167907&SiteID=1)的主要事情是，在处理没有 Jet 的 64 位版本（基本上是 Excel 或 Access）的数据源时，需要运行 dtexec 的 SSIS 32 位模式版本。

# unit-testing - 如何对应用程序的插件进行单元测试？

> ID：303166
> 
> 赞同：1
> 
> 时间：2008-11-19T20:02:00.970
> 
> 标签：unit-testing, plugins

在开发应用程序插件时，使用不独立于应用程序运行的应用程序 API，是否有可能进行单元测试？测试与应用程序紧密集成的插件的策略是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T20:04:31.683

抽象出带有接口的主机 API，并针对模拟主机进行测试。

关键是您的逻辑已使用主机可能提供的特征数据进行测试。

如果您有代码示例，我可能会给您一个更好的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T00:22:17.247

大多数人都忽略了关于模拟对象的要点。它们不是关于测试，而是关于接口发现。或者正如 Michael Feather 在最近的宣传中所说的那样：[API Wrapping](http://michaelfeathers.tumblr.com/post/60267145/notes-for-the-afflicted-excerpt-from-adaium)。

不要直接针对 api 进行编码。而是创建您自己的接口来抽象该 api，然后为您的代码编写测试。

我在为 Eclipse 编写插件时已经这样做了，结果比我提前预期的要好得多。

# c# - 更改 LINQ 对象数据上下文

> ID：303167
> 
> 赞同：2
> 
> 时间：2008-11-19T20:02:19.487
> 
> 标签：c#, sql, linq

我在 SQL (A) 中有一个对象，它与另一个对象 (B) 具有多对多关系。我目前正在构建一个 API 层 DLL，它允许用户将 B 类型的对象分配给 A 类型。现在用户将使用不同的 LINQ 数据上下文检索 A 类型的条目列表和 B 类型的条目列表. 问题是与 A 关联的数据上下文将与 B 关联的数据上下文中的任何对象视为新对象，并在我调用 SubmitChanges() 时尝试插入它们。有没有办法告诉数据上下文 A 这些对象已经存在并且不需要创建？我想写的代码看起来像这样（我将调用 A 服务和 B 输出）：

```
List<Service> svcs = Service.GetServices();
List<Output> outs = Output.GetOutputs();

svcs[0].OutputCollection.Add(outs);
svcs[0].Save(); 
```

我的示例中的每个 Service 对象都有一个对从数据库中提取它的数据上下文的引用，并且 Save 函数调用 DataContext.SubmitChanges(); 上面的代码抛出异常，因为它试图将已经存在的输出添加回表中。

我知道这很长，我不确定我是否很好地解释了我的问题。任何见解或建议都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T20:22:23.660

我实际上找到了一种不同的解决方案，现在我什至觉得问这个问题有点愚蠢。我在 Service.Outputs.Add() 方法中所做的确实是问题所在：

```
public void Add(Output output)
{
    OutputCollectionItem oci = new OutputCollectionItem();
    oci.item = output;
    this.OutputCollection.Add(oci);
} 
```

我应该做的是：

```
public void Add(Output output)
{
    OutputCollectionItem oci = new OutputCollectionItem();
    oci.itemID = output.itemID;
    this.OutputCollection.Add(oci);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T20:08:57.773

我遇到了同样的问题，我想不出一个优雅的解决方案。但我发现的唯一解决方案是使用“拼接”或使用反射。

缝合看起来像这样。

```
Person existingPerson - DB.GetPerson(1);
existingPerson.BirthDate = newPerson.BirthDate;
existingPerson.JobTitle = newPerson.JobTitle; 
```

我曾经读过一些关于使用回调的东西，但我一辈子都找不到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T13:04:17.333

我认为您必须将对象从 A 和 B 中分离出来，而不是链接它们并在您的上下文中执行 Attach 以重新附加它们。

所以：

```
// this remains
List<Service> svcs = Service.GetServices();
List<Output> outs = Output.GetOutputs();

svcs[0].OutputCollection.Add(outs);
svcs[0].Save();

// this changes
public class Service
{
    public static List<Service> GetServices()
    {
       var context = new Context();
       var result = context.ServiceSet.ToList();
       result.ForEach(e => context.Detach(e));
       return result;
    }
    public void Save()
    {
       var context = new Context();
       context.Attach(this); // will retach myself and all of my child entities.
       context.SaveChanges();
    }
}

public class Output
{
    public static List<Output> GetOutput()
    {
       var context = new Context();
       var result = context.OutputSet.ToList();
       result.ForEach(e => context.Detach(e));
       return result;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T13:07:19.730

另一种解决方案是分享您的上下文..

如果您使用 IoC 容器，您可以让容器管理上下文的生命周期，例如在网站中，将每个请求的上下文生命周期结合起来是个好主意。

# cygwin - Cygwin X11R7.4 更新支持

> ID：303174
> 
> 赞同：0
> 
> 时间：2008-11-19T20:04:44.773
> 
> 标签：cygwin, x11

我刚刚被[Cygwin X11R7.4 更新](http://cygwin.com/ml/cygwin-xfree-announce/2008-11/msg00000.html)烫伤了，我发现官方邮件列表充满敌意和笨拙。所以我想我会在这里问。

如果您在升级中幸存下来（或至少在修复问题方面取得了进展），您采取了哪些步骤来使事情正常进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T20:11:20.500

此升级将 X Window System 的各个部分拆分为单独的包。例如，如果您需要字体，则需要在运行 Cygwin 安装程序时安装这些字体。对于您需要哪些没有简单的答案，但除了使用的空间之外，没有理由不得到超出您需要的东西。我添加了所有看起来甚至非常有用的东西。

如果您对`startx`脚本做了任何事情，我很遗憾地说您将不得不重做该工作。请注意，这会让那些遵循该脚本顶部建议的人感到痛苦：“强烈敦促站点管理员编写更好的版本。” （是的，我应该使用源代码控制，是的，我不应该盲目升级 Cygwin，但谁会想到安装过程会从一个版本到下一个版本发生巨大变化。为什么安装不能保存一个副本我？）

对我来说，Windows 开始菜单中的快捷方式比`startx`从命令行运行更好，因为默认配置更接近我过去使用的配置。请注意，`startxwin.bat`假设您已经在 中安装了 Cygwin `\cygwin`，这可能正确也可能不正确。如果快捷方式闪烁控制台窗口并悄悄地失败，请首先检查。

* * *

更新：我现在决定这`startxwin.sh`是我最喜欢的启动脚本版本。我从 X 开始，`-multiwindow`并且只启动一个`xterm`。与 不同`startxwin.bat`的是，它不会对 Cygwin 的安装位置做出任何潜在的错误假设，因此每次升级时都不需要对其进行编辑。

* * *

最初，数字锁定键被搞砸了，但当我再次更新时，它似乎已经解决了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T20:54:20.340

在某些时候，startx 的默认值已从无根/多窗口更改为 Cygwin 多年前使用的单窗口选项。

呸！我认为这与更新世界以使用 X.org 的东西而不是旧的 XFree86/X11 或其他任何东西有关。不管是什么原因，这令人难以置信的烦人！我想从某人的角度来看，它是“正确的”，有一天我可能会喜欢它。我想我已经喜欢我在调查时看到的一些内容：联机帮助页正在更新，并且看起来相当清晰。

我暂时还想运行startx。我不想运行 .bat 脚本，也不想运行自定义脚本。

startx 通过 xinitrc 包中描述的过程启动 X。根据这个过程，你可以在你的主目录中创建一个 .xserverrc 文件来控制启动的服务器进程，包括它的命令行参数。（显然，您也可以在 startx 命令行上指定。）正确的做法似乎是将以下内容放入 $HOME/.xserverrc ：

```
exec XWin -multiwindow -clipboard -silent-dup-error 
```

您可能仍然希望创建一个 .xinitrc 来控制会话中启动的内容。我不喜欢一个 xterm 成为长时间运行的进程的方式，这会导致 X 会话在我退出时终止，但目前我不记得我做了什么来纠正这种情况，也没有任何例子看这里。

# character-encoding - 如何在 SQLExpress 文本字段中插入中文字符？

> ID：303178
> 
> 赞同：13
> 
> 时间：2008-11-19T20:05:54.753
> 
> 标签：character-encoding, full-text-search, sql-server-express, cjk

如何在 SQLExpress 文本字段中插入中文字符？我正在使用 VS 2008 中的 SQL Express。当我通过我编写的导入应用程序或通过从 Visual Studio 中的数据视图粘贴它们来添加中文字符时，它们最终会变成问号。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-04T23:13:14.513

只需在 nchar/nvarchar/ntext 类型的字段的 INSERT/UPDATE 语句中的文本分隔符之前添加一个“N”：

INSERT INTO myTable (myField1, myField2) VALUES (N'any chinese character',N'any arabic character')

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T20:26:38.957

确保您的列类型为 nchar、nvarchar 或 ntext。所以你可以存储Unicode。这一切都很好地描述[在这里......](http://msdn.microsoft.com/en-us/library/aa223981.aspx)

# sql - 为 SqlServer 查找表使用 tinyint 而不是 int 值得麻烦吗？

> ID：303179
> 
> 赞同：20
> 
> 时间：2008-11-19T20:06:29.027
> 
> 标签：sql, sql-server, database-design

在 SqlServer 2005 中设计查找表（枚举）时，如果您知道条目数永远不会很高，是否应该使用 tinyint 而不是 int？我最关心性能，尤其是索引的效率。

假设您有以下代表性表格：

```
Person
------
PersonId int  (PK)
PersonTypeId tinyint  (FK to PersonTypes) 
```

和

```
PersonTypes
-----------
PersonTypeId tinyint
PersonTypeName varchar(50) 
```

显而易见的因素是数据大小和编码麻烦。当我们在 person 表中达到 1 亿行时，与 int 相比，使用 tinyint 存储的字节数减少了 3 亿字节，再加上索引占用的空间。不是大量的数据，但如果将设计决策应用于数十个大表，则意义重大。当然，编码麻烦来自 ASP.NET C#/VB 代码中的所有这些转换问题。

如果我们抛开这两个问题，还有什么可以发挥作用？由于索引页的大小减小，查询会更有效吗？或者是否有某种填充会抵消好处？还有其他陷阱吗？

我个人一直只使用整数，但我正在考虑使用 tinyint 来对一些巨大的表进行重新设计/迁移工作，所以我很想得到一些建议。

[编辑]

在对此进行试验之后，我预期的编码麻烦被证明不是问题。从 int 更改为 tinyint 根本没有导致任何转换问题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-19T20:13:06.363

表（或索引节点条目）越窄，单个 IO 页面上可以容纳的记录（或索引节点）就越多，任何查询所需的物理（和逻辑）读取 IO 操作就越少。此外，单个页面上的索引节点越多，索引中的级别可能就越少，从根到叶级别，如果通过使表更窄，您通过了索引可以小一级的阈值，这可以对性能产生巨大的影响。

如果通过切换到 TinyInt 将表从 200 字节宽更改为 197 字节宽，它可能不会有任何区别......但是如果你将它从 20 字节更改为 14，（假设你有 2 个整数），那么它可能是戏剧性的......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T20:13:34.223

内存 101：更小的东西意味着一次在 RAM 中保存更多，因此硬盘读取次数更少。如果数据库足够大并且您正在运行某些类型的查询，这可能是一个非常严重的因素。但它可能不会有很大的不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T20:50:46.193

> 还有其他陷阱吗？

我不确定这是否是您所说的那种“陷阱”，但我遇到过使用 datetime 而不是 smalldatetime 会产生不正确的功能行为的情况，因为精度较低的 smalldatetime 与两个“相同”的日期的更高精度日期时间。

这里不可能发生这种情况，因为对于相同的数字整数值， tinyint / smallint / int / bigint 都会比较为相同。因此，您显然在这一点上是安全的，而不是它完全回答了您的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T20:11:09.190

我怀疑使用 smallint 而不是 int 会带来很多性能优势，除非在极少数情况下。不过，您可以轻松地为此构建一个测试应用程序，创建一些测试表并执行一百万次插入/更新/选择并比较性能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T20:22:20.273

还有一个因素是维护索引/磁盘备份/磁带备份也会占用空间，但我想说最重要的是 IO 和内存性能。

# vba - Excel 2002 Web 查询搞砸了 en-GB 日期

> ID：303180
> 
> 赞同：2
> 
> 时间：2008-11-19T20:07:51.037
> 
> 标签：vba, excel, excel-web-query

下午好，

我有一个 Web 查询`Excel 2002`要针对返回日期列的网页。日期返回为`DD/MM/YYYY`，因为我想在我的电子表格中显示它们。我运行 Excel 的机器将其区域设置设置为 en-GB，并且 Internet 选项下设置的唯一语言是英国英语。

然而，Web 查询将日期提取为`MM/DD/YYYY`，这被 Excel 误解了。

如何让 Web 查询返回我的区域设置中的日期`MM/DD/YYYY`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-21T00:40:10.893

你能修改“网络查询”吗？

通用日期格式是 Office 产品识别日期/时间的更好方法。我在使用 GB 到 US 日期时遇到了类似的问题，发现将日期编码为这种格式可以为您节省很多麻烦。

```
Universal Date format is : "yyyy-mm-dd hh:mm:ss" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T20:22:42.193

也许你很幸运，Excel 可以理解 HTML`lang`属性或`<meta http-equiv="content-language" content="...">`元标记。老实说 - 我的猜测是它没有任何区别。

如果您对网站有控制权，您可以尝试添加它们，看看是否有影响。OTOH - 如果您*可以*控制网页，则可以更改日期格式。

另一种方法是完全禁用日期识别并在查询后手动对其进行后处理。为此，请重新创建 Web 查询并在“新建 Web 查询”对话框中单击右上角的“选项...”按钮。有一个“禁用日期识别”复选框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T21:11:50.503

网页格式为 en-GB。我将控制面板中的区域设置更改为 en-GB。我将 Internet 选项语言更改为 en-GB。

尽管如此，Excel 的 Web Query 仍以 en-US 格式返回数据。我看不出你的建议有什么帮助。在这种情况下，后处理不是一种选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-26T22:24:04.037

Excel 网络查询在国际方面很糟糕。它也对我不起作用。我最后要做的就是手动提取数据，使用宏，解析它的语言环境并放到工作表上。幸运的是，我查询了一个返回 XML 的 Web 服务，所以很容易。如果您解析 HTML，请执行 Tomalak[建议](https://stackoverflow.com/questions/303180/excel-2002-web-query-screwing-up-en-gb-dates#303222)的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-24T15:17:56.617

在 Excel 2007 中，更改区域设置中的日期格式效果很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-18T19:38:51.603

在 VBA 编辑器中，尝试设置

> WebDisableDateRecognition

标准网络查询命令中的属性：

```
With Selection.QueryTable
    .Connection = _
    "URL;http://whateverYourURLis"
    .WebSelectionType = xlSpecifiedTables
    .WebFormatting = xlWebFormattingNone
    .WebTables = "7"
    .WebPreFormattedTextToColumns = True
    .WebConsecutiveDelimitersAsOne = True
    .WebSingleBlockTextImport = False
    .WebDisableDateRecognition = True
    .WebDisableRedirections = False
    .Refresh BackgroundQuery:=False
End With 
```

（请注意，您可以通过在进行网络查询时简单地录制宏来获得与上述相同的效果......）

在这里工作得很好，希望它也适合你。

干杯!

# c# - 可空的 : 和重载的运算符，布尔？& 布尔值

> ID：303181
> 
> 赞同：7
> 
> 时间：2008-11-19T20:08:01.910
> 
> 标签：c#, nullable

1.  为什么为 bool 定义了运算符 '&'？，而运算符 '&&' 不是？
2.  这 1) 究竟是如何布尔的？& 布尔？2）布尔？和布尔工作？

Nullable 上的任何其他“有趣”运算符语义？泛型 T 的任何重载运算符？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-19T20:57:05.867

上的操作员`Nullable<T>`是“提升”的操作员。这意味着：如果 T 有操作符，T? 将有“提升”的对应物。

&& 和 || 不是真正意义上的运算符 & 和 | - 例如，它们不能重载 - 来自 ECMA 规范 14.2.2 运算符重载：

> 可重载的二元运算符有： + - * / % & | ^ << >> == != > < >= <= 只有上面列出的运算符可以重载。特别是，不能重载成员访问、方法调用或 =、&&、||、??、?:、checked、unchecked、new、typeof、as 和 is 运算符。

同样，从 ECMA 规范 14.2.7 提升的运算符中，提升的运算符是：

> 对于一元运算符 + ++ - -- ！~
> 
> 对于二元运算符 + - * / % & | ^ << >>
> 
> 对于等式运算符 == !=
> 
> 对于关系运算符 < > <= >=

所以基本上，短路运算符不被定义为提升运算符。

[编辑：添加婴儿床单]

*   提升运算符：编译器提供的运算符 on `Nullable<T>`，基于 T 的运算符 - 例如：`int`“+”运算符被“提升”到`int?`，定义为：

    (int?x, int?y) => (x.HasValue && y.HasValue) ? (x.Value + y.Value) : (int?) null;

*   运算符重载：为给定类型提供自定义运算符实现的行为；例如`decimal`并`DateTime`提供各种运算符重载

*   短路：`&&`and的正常行为`||`（在许多语言中，包括 C++ 和 C#）——即第二个操作数*可能不会被计算*——即

    (表达式1, 表达式2) => 表达式1() ? 表达式2（）：假；

或者也许是一个更简单的例子：

```
bool someFlag = Method1() && Method2(); 
```

如果`Method1()`返回 false，`Method2()`则不执行（因为编译器已经知道总体答案为 false）。如果`Method2()`有副作用，这很重要，因为保存到数据库......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T20:21:47.640

没有为`bool?`

只有逻辑 AND（包括 OR）运算符，它们的行为如下：

```
x        y      x & y   x | y   
true    true    true    true
true    false   false   true
true    null    null    true
false   true    false   true
false   false   false   false
false   null    false   null
null    true    null    true
null    false   false   null
null    null    null    null 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T20:11:21.373

运算符“&”是位运算符，而“&&”是逻辑运算符。逻辑“AND”运算符不能应用于三态值，仅适用于二态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T20:21:36.733

-- 此外，逻辑 && 运算符以及 || 运算符不能重载。

2）按位运算符起作用的原因是因为它对单个位进行运算，即简单的 1 或 0。这就是布尔运算符的本质，true 和 false，1 和 0。

# ldap - Novell 错误 81 连接

> ID：303182
> 
> 赞同：1
> 
> 时间：2008-11-19T20:08:38.070
> 
> 标签：ldap, novell

我们已尝试从我们的办公室连接到远程 Novell 服务器。

首先，我们必须打开防火墙端口才能连接到服务器，否则我们会收到错误 91（这基本上表明服务器无法加入）。

其次，我们使用了一个名为 LDAP Browser 的工具来测试连接。

我们收到**错误 81 "can't contact LDAP server"**。但是我们查看了通信痕迹，我们看到我们联系了服务器并得到了响应。我们还用 Telnet 进行了测试，我们看到我们可以连接到服务器。

那么，有谁知道这个错误是什么意思以及可能的解决方案是什么？因为，我用谷歌搜索了那个错误，并没有得到有效的答案来告诉你要检查什么以及原因是什么。

Novell 服务器由第三方托管，因此我们无法为您提供其 IP，更不用说用户/密码。

我们在 636 端口上连接。在 LDAP 浏览器的跟踪中，我们看到它进入“正在初始化 SSL...”的步骤，但随后无法连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T17:41:04.577

我认为有两个问题：1）你想要做什么样的绑定？SSL？清晰的文字？匿名的？

2) 如何在 eDirectory 端配置 LDAP 绑定？

工具 LDAP Browser，你指的是这个链接上的那个吗？
[免费的 LDAP 浏览器](http://www.mcs.anl.gov/~gawor/ldap/)

在 eDirectory 方面，它们可以要求所有 LDAP 通信都使用 TLS，并且它们可以禁止匿名绑定。

您能否请另一端的人启用 LDAP 跟踪（使用启用了 +LDAP 选项的 DStrace，有关如何在 Novell eDirectory 上使用 Dstrace 的一些链接查看：[不同类型的 Dstrace](http://www.novell.com/communities/node/4418/the-many-faces-dstrace) [捕获和了解身份管理器的 DS 跟踪](http://www.novell.com/communities/node/5681/capturing-and-reading-novell-identity-manager-traces)。）

这通常会显示一条可以启发您的错误消息。

我的猜测是启用了 Require TLS，并且您可能没有进行成功的 SSL 绑定。

如果是这样，请尝试连接端口 636，启用 SSL，并为您尝试登录的用户提供完全限定的 DN。

如果您尝试启用 SSL，但没有弹出关于接受树 CA 的受信任根证书的弹出框，则可能是 eDirectory 服务器用户的 CA 或 SSL 证书已过期或损坏。（这有很多常见的原因，只需一点时间即可解决）。

通常在 Dstrace 中，如果出现问题，您会看到有关 SSL 证书的错误。本文提供了一个从 Novell Identity Manager 角度来看已过期证书的示例：[证书已过期](http://www.novell.com/communities/node/6306/certificate-expired-error) 以及有关如何修复证书的一些详细信息。

下一个可能性是您指定的 DN 不完全正确。

从错误 81 的角度来看，这里有几个链接，说明 AD 如何显示 81 错误情况，以了解可能性（主要与 SSL 相关）。 [通过 IDM 驱动程序的 AD SSL](http://www.novell.com/communities/node/4193/configuring-identity-manager-driver-active-directory-ssl)

如果您需要进一步的帮助，请告诉我。

# linq - linq to sql不在where子句中的字符串周围加上引号

> ID：303184
> 
> 赞同：1
> 
> 时间：2008-11-19T20:09:06.150
> 
> 标签：linq, linq-to-sql

我有一个简单的 Linq to SQL 查询，它通过字符串使用 where 子句提取数据。结果查询不会在字符串周围加上引号。

例子

```
字符串名称=“约翰”；
var query = from n in db.Names where n.Name == name select n;

```

结果是

.... WHERE ([t0].[Name] = John) ....

Network 是一个 varchar(10) 并且 TNT 是从一个字符串变量（不称为 John ;-) 填充的。

奇怪的是......有时它会这样做，有时它不会！

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T20:46:11.817

我在我的所有 LINQ to SQL 中看到的每个实例都使用参数化查询，所以我不知道你是如何得到那个输出的。它应该更像是：

```
WHERE ([t0].[Name] = @p0)
--@p0 VARCHAR John 
```

如果您将 context.log 设置为 console.out，您可以看到所有的 sql 正在执行。我只是建议这样做以确保正在发生的事情。

# c# - C# 中的 SAML 断言 WriteXML 问题

> ID：303197
> 
> 赞同：1
> 
> 时间：2008-11-19T20:13:16.703
> 
> 标签：c#, xml, assertions, saml

我已经创建了一个 SamlAssertion 的实例，并向其中添加了授权声明和属性声明，现在我想打印出 XML，以便我可以进行 HTTP 发布，但并不是所有的断言都被输出。我错过了什么（我确定这是一些愚蠢的东西）？

这是我正在使用的代码：

```
// Add the Statements to the SAML Assertion
   samlAssert.Statements.Add(samlAuthStatement);
   samlAssert.Statements.Add(samlAttrStatement);
   MemoryStream xmlStream = new MemoryStream();
   XmlDictionaryWriter xmlWriter = XmlDictionaryWriter.CreateTextWriter(xmlStream, System.Text.Encoding.UTF8);
   SamlSerializer samlAssertSerializer = new SamlSerializer();
   WSSecurityTokenSerializer secTokenSerializer = new WSSecurityTokenSerializer();
   samlAssert.WriteXml(xmlWriter, samlAssertSerializer, secTokenSerializer);

   xmlStream.Position = 0;
   StreamReader sr = new StreamReader(xmlStream, System.Text.Encoding.UTF8);
   string AssertStr = sr.ReadToEnd();
   TextBox1.Text = AssertStr; 
```

但得到的只是这样的：

```
<saml:Assertion MajorVersion="1" MinorVersion="1" AssertionID="assertID" 
                Issuer="my Company" IssueInstant="2008-11-19T19:54:12.191Z" 
                xmlns:saml="urn:oasis:names:tc:SAML:1.0:assertion">
    <saml:Conditions NotBefore="2008-11-19T19:54:12.191Z" NotOnOrAfter="2008-11-19T19:59:12.191Z"/>
    <saml:AuthenticationStatement AuthenticationMethod="urn:oasis:names:tc:SAML:2.0:ac:classes:TimeSyncToken" 
                                  AuthenticationInstant="2008-11-19T19:54:12.191Z">
        <saml:Subject>
            <saml:NameIdentifier Format="cs-sstc-schema-assertion-1.1.xsd" NameQualifier="My company">xxxx</saml:NameIdentifier>
            <saml:SubjectConfirmation>
                <saml:ConfirmationMethod>urn:oasis:names:tc:SAML:1.0:cm:bearer</saml:ConfirmationMethod>
            </saml:SubjectConfirmation>
        </saml:Subject>
        <saml:SubjectLocality IPAddress="x.x.x.x"/>
        </saml: 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-07T19:07:18.563

如果我在这种情况下给你一个建议，那就是：在使用[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)对象（如流）`using`时始终使用语句。除了自动刷新流之外，它还会在出现异常时释放资源：

```
// Add the Statements to the SAML Assertion
samlAssert.Statements.Add(samlAuthStatement);
samlAssert.Statements.Add(samlAttrStatement);

var sb = new StringBuilder();
var settings = new XmlWriterSettings 
{
    OmitXmlDeclaration = true,
    Encoding = Encoding.UTF8
};
using (var stringWriter = new StringWriter(sb))
using (var xmlWriter = XmlWriter.Create(stringWriter, settings))
using (var dictionaryWriter = XmlDictionaryWriter.CreateDictionaryWriter(xmlWriter))
{
    var samlAssertSerializer = new SamlSerializer();
    var secTokenSerializer = new WSSecurityTokenSerializer();
    samlAssert.WriteXml(
        dictionaryWriter, 
        samlAssertSerializer, 
        secTokenSerializer
    );
}

TextBox1.Text = sb.ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T19:05:38.383

我不确定这是否与您的案例直接相关，但这可能是与重新序列化 SAML 令牌相关的有用信息

[http://blogs.msdn.com/govindr/archive/2006/10/24/re-serialize-saml-token.aspx](http://blogs.msdn.com/govindr/archive/2006/10/24/re-serialize-saml-token.aspx)

# python - 如何删除/删除非空文件夹？

> ID：303200
> 
> 赞同：1003
> 
> 时间：2008-11-19T20:15:38.557
> 
> 标签：python, file

当我尝试删除非空文件夹时，出现“访问被拒绝”错误。我在尝试中使用了以下命令：`os.remove("/folder_name")`.

删除/删除非空文件夹/目录的最有效方法是什么？

* * *

## 回答 #1

> 赞同：1602
> 
> 时间：2008-11-19T20:23:16.997

```
import shutil

shutil.rmtree('/folder_name') 
```

[标准库参考： shutil.rmtree](http://docs.python.org/library/shutil.html#shutil.rmtree)。

按照设计，`rmtree`在包含只读文件的文件夹树上失败。如果您希望删除文件夹而不管它是否包含只读文件，然后使用

```
shutil.rmtree('/folder_name', ignore_errors=True) 
```

* * *

## 回答 #2

> 赞同：157
> 
> 时间：2008-11-19T20:23:41.643

来自python[文档](http://docs.python.org/library/os.html#os.walk)：`os.walk()`

```
# Delete everything reachable from the directory named in 'top',
# assuming there are no symbolic links.
# CAUTION:  This is dangerous!  For example, if top == '/', it
# could delete all your disk files.
import os
for root, dirs, files in os.walk(top, topdown=False):
    for name in files:
        os.remove(os.path.join(root, name))
    for name in dirs:
        os.rmdir(os.path.join(root, name)) 
```

* * *

## 回答 #3

> 赞同：131
> 
> 时间：2014-08-07T00:59:15.390

```
import shutil
shutil.rmtree(dest, ignore_errors=True) 
```

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2015-03-03T14:23:53.927

从 python 3.4 你可以使用：

```
import pathlib

def delete_folder(pth) :
    for sub in pth.iterdir() :
        if sub.is_dir() :
            delete_folder(sub)
        else :
            sub.unlink()
    pth.rmdir() # if you just want to delete the dir content but not the dir itself, remove this line 
```

实例`pth`在哪里。`pathlib.Path`不错，但可能不是最快的。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2017-05-11T11:39:26.563

来自[docs.python.org](https://docs.python.org/3/library/shutil.html#rmtree-example)：

> 此示例说明如何在 Windows 上删除目录树，其中某些文件设置了只读位。它使用 onerror 回调清除只读位并重新尝试删除。任何后续失败都会传播。
> 
> ```
> import os, stat
> import shutil
> 
> def remove_readonly(func, path, _):
>     "Clear the readonly bit and reattempt the removal"
>     os.chmod(path, stat.S_IWRITE)
>     func(path)
> 
> shutil.rmtree(directory, onerror=remove_readonly) 
> ```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-02-12T11:58:43.947

```
import os
import stat
import shutil

def errorRemoveReadonly(func, path, exc):
    excvalue = exc[1]
    if func in (os.rmdir, os.remove) and excvalue.errno == errno.EACCES:
        # change the file to be readable,writable,executable: 0777
        os.chmod(path, stat.S_IRWXU | stat.S_IRWXG | stat.S_IRWXO)  
        # retry
        func(path)
    else:
        # raiseenter code here

shutil.rmtree(path, ignore_errors=False, onerror=errorRemoveReadonly) 
```

如果设置了ignore_errors，则忽略错误；否则，如果设置了 onerror，则调用它来处理带有参数（func、path、exc_info）的错误，其中 func 是 os.listdir、os.remove 或 os.rmdir；path 是导致它失败的函数的参数；exc_info 是 sys.exc_info() 返回的元组。如果 ignore_errors 为 false 且 onerror 为 None，则会引发异常。在此处输入代码

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-10-06T21:02:15.270

根据 kkubasik 的回答，在删除之前检查文件夹是否存在，更健壮

```
import shutil
def remove_folder(path):
    # check if folder exists
    if os.path.exists(path):
         # remove if exists
         shutil.rmtree(path)
    else:
         # throw your exception to handle this special scenario
         raise XXError("your exception") 
remove_folder("/folder_name") 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-02-09T16:26:20.407

只需一些 python 3.5 选项即可完成上述答案。（我很想在这里找到它们）。

```
import os
import shutil
from send2trash import send2trash # (shutil delete permanently) 
```

**如果为空则删除文件夹**

```
root = r"C:\Users\Me\Desktop\test"   
for dir, subdirs, files in os.walk(root):   
    if subdirs == [] and files == []:
           send2trash(dir)
           print(dir, ": folder removed") 
```

**如果文件夹包含此文件，则也删除该文件夹**

```
 elif subdirs == [] and len(files) == 1: # if contains no sub folder and only 1 file 
        if files[0]== "desktop.ini" or:  
            send2trash(dir)
            print(dir, ": folder removed")
        else:
            print(dir) 
```

**如果文件夹仅包含 .srt 或 .txt 文件，则删除该文件夹**

```
 elif subdirs == []: #if dir doesn’t contains subdirectory
        ext = (".srt", ".txt")
        contains_other_ext=0
        for file in files:
            if not file.endswith(ext):  
                contains_other_ext=True
        if contains_other_ext== 0:
                send2trash(dir)
                print(dir, ": dir deleted") 
```

**如果文件夹大小小于 400kb，则删除文件夹：**

```
def get_tree_size(path):
    """Return total size of files in given path and subdirs."""
    total = 0
    for entry in os.scandir(path):
        if entry.is_dir(follow_symlinks=False):
            total += get_tree_size(entry.path)
        else:
            total += entry.stat(follow_symlinks=False).st_size
    return total

for dir, subdirs, files in os.walk(root):   
    If get_tree_size(dir) < 400000:  # ≈ 400kb
        send2trash(dir)
    print(dir, "dir deleted") 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2019-06-14T10:25:10.323

我想添加一个“纯路径库”方法：

```
from pathlib import Path
from typing import Union

def del_dir(target: Union[Path, str], only_if_empty: bool = False):
    """
    Delete a given directory and its subdirectories.

    :param target: The directory to delete
    :param only_if_empty: Raise RuntimeError if any file is found in the tree
    """
    target = Path(target).expanduser()
    assert target.is_dir()
    for p in sorted(target.glob('**/*'), reverse=True):
        if not p.exists():
            continue
        p.chmod(0o666)
        if p.is_dir():
            p.rmdir()
        else:
            if only_if_empty:
                raise RuntimeError(f'{p.parent} is not empty!')
            p.unlink()
    target.rmdir() 
```

这依赖于可排序的事实，`Path`较长的路径总是排在较短的路径之后，就像`str`. 因此，目录将位于文件之前。如果我们***反转***排序，则文件将位于它们各自的容器之前，因此我们可以简单地通过一次一个地取消链接/ rmdir它们。

好处：

*   它不依赖于外部二进制文件：一切都使用 Python 的电池模块（Python >= 3.6）
    *   这意味着它不需要重复启动一个新的子进程来进行取消链接
*   它非常快速和简单；您不必实现自己的递归
*   它是跨平台的（至少，这是`pathlib`Python 3.6 中所承诺的；上面没有说明不能在 Windows 上运行的操作）
*   如果需要，可以进行非常精细的日志记录，例如，在每次删除发生时记录它。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2010-12-22T08:00:23.753

如果您确定要删除整个目录树，并且对目录的内容不再感兴趣，那么爬取整个目录树是愚蠢的……只需从 python 调用本机操作系统命令即可。它将更快、更高效且内存消耗更少。

```
RMDIR c:\blah /s /q 
```

或 *nix

```
rm -rf /home/whatever 
```

在 python 中，代码看起来像..

```
import sys
import os

mswindows = (sys.platform == "win32")

def getstatusoutput(cmd):
    """Return (status, output) of executing cmd in a shell."""
    if not mswindows:
        return commands.getstatusoutput(cmd)
    pipe = os.popen(cmd + ' 2>&1', 'r')
    text = pipe.read()
    sts = pipe.close()
    if sts is None: sts = 0
    if text[-1:] == '\n': text = text[:-1]
    return sts, text

def deleteDir(path):
    """deletes the path entirely"""
    if mswindows: 
        cmd = "RMDIR "+ path +" /s /q"
    else:
        cmd = "rm -rf "+path
    result = getstatusoutput(cmd)
    if(result[0]!=0):
        raise RuntimeError(result[1]) 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2019-01-14T14:32:28.333

十年后，使用 Python 3.7 和 Linux 仍然有不同的方法可以做到这一点：

```
import subprocess
from pathlib import Path

#using pathlib.Path
path = Path('/path/to/your/dir')
subprocess.run(["rm", "-rf", str(path)])

#using strings
path = "/path/to/your/dir"
subprocess.run(["rm", "-rf", path]) 
```

本质上，它使用 Python 的 subprocess 模块来运行 bash 脚本`$ rm -rf '/path/to/your/dir`，就好像您使用终端来完成相同的任务一样。它不是完全的 Python，但它完成了它。

我包含该`pathlib.Path`示例的原因是因为根据我的经验，它在处理许多变化的路径时非常有用。导入`pathlib.Path`模块并将最终结果转换为字符串的额外步骤对我来说通常会降低开发时间的成本。如果`Path.rmdir()`带有 arg 选项来显式处理非空目录会很方便。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-11-08T17:04:11.137

如果您不想使用该`shutil`模块，您可以使用该`os`模块。

```
from os import listdir, rmdir, remove
for i in listdir(directoryToRemove):
    os.remove(os.path.join(directoryToRemove, i))
rmdir(directoryToRemove) # Now the directory is empty of files 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-08-03T08:24:56.723

```
def deleteDir(dirPath):
    deleteFiles = []
    deleteDirs = []
    for root, dirs, files in os.walk(dirPath):
        for f in files:
            deleteFiles.append(os.path.join(root, f))
        for d in dirs:
            deleteDirs.append(os.path.join(root, d))
    for f in deleteFiles:
        os.remove(f)
    for d in deleteDirs:
        os.rmdir(d)
    os.rmdir(dirPath) 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-05-28T17:53:09.953

删除一个文件夹，即使它可能不存在（避免[Charles Chow 的回答](https://stackoverflow.com/a/32979686/309334 "该文件可能在您调用 exists 和您尝试删除它之间被删除，或者它可能在您调用 exists 之后创建")中的竞争条件）但在其他事情出错时仍然有错误（例如权限问题、磁盘读取错误、文件不是目录）

对于 Python 3.x：

```
import shutil

def ignore_absent_file(func, path, exc_inf):
    except_instance = exc_inf[1]
    if isinstance(except_instance, FileNotFoundError):
        return
    raise except_instance

shutil.rmtree(dir_to_delete, onerror=ignore_absent_file) 
```

Python 2.7 代码几乎相同：

```
import shutil
import errno

def ignore_absent_file(func, path, exc_inf):
    except_instance = exc_inf[1]
    if isinstance(except_instance, OSError) and \
        except_instance.errno == errno.ENOENT:
        return
    raise except_instance

shutil.rmtree(dir_to_delete, onerror=ignore_absent_file) 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-07-23T15:32:36.547

对于 os.walk，我会提出由 3 个单行 Python 调用组成的解决方案：

```
python -c "import sys; import os; [os.chmod(os.path.join(rs,d), 0o777) for rs,ds,fs in os.walk(_path_) for d in ds]"
python -c "import sys; import os; [os.chmod(os.path.join(rs,f), 0o777) for rs,ds,fs in os.walk(_path_) for f in fs]"
python -c "import os; import shutil; shutil.rmtree(_path_, ignore_errors=False)" 
```

第一个脚本 chmod 的所有子目录，第二个脚本 chmod 的所有文件。然后第三个脚本毫无障碍地删除所有内容。

我已经在 J​​enkins 作业中通过“Shell 脚本”对此进行了测试（我不想将新的 Python 脚本存储到 SCM 中，这就是搜索单行解决方案的原因），它适用于 Linux 和 Windows。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-03-22T22:34:32.010

对于 Windows，如果目录不为空，并且您有只读文件或出现类似错误

*   `Access is denied`
*   `The process cannot access the file because it is being used by another process`

试试这个，`os.system('rmdir /S /Q "{}"'.format(directory))`

`rm -rf`它在 Linux/Mac 中是等效的。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-12-10T08:29:20.897

基于递归的纯`pathlib`解决方案：

```
from pathlib import Path

def remove_path(path: Path):
    if path.is_file() or path.is_symlink():
        path.unlink()
        return
    for p in path.iterdir():
        remove_path(p)
    path.rmdir() 
```

支持 Windows 和符号链接

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-01-11T04:46:15.000

为简单起见，您可以使用 os.system 命令：

```
import os
os.system("rm -rf dirname") 
```

很明显，它实际上调用了系统终端来完成这个任务。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-06-01T14:39:22.643

我找到了一种非常简单的方法来删除**WINDOWS OS上的任何****文件夹（甚至不是空的）**或文件。

 **```
os.system('powershell.exe  rmdir -r D:\workspace\Branches\*%s* -Force' %CANDIDATE_BRANCH) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-07-22T08:01:36.213

在我的情况下，删除的唯一方法是使用所有可能性，因为我的代码应该由 cmd.exe 或 powershell.exe 运行。如果是您的情况，只需使用此代码创建一个函数即可：

```
 #!/usr/bin/env python3

        import shutil
        from os import path, system
        import sys

        # Try to delete the folder ---------------------------------------------
        if (path.isdir(folder)):
            shutil.rmtree(folder, ignore_errors=True)

        if (path.isdir(folder)):
            try:
                system("rd -r {0}".format(folder))
            except Exception as e:
                print("WARN: Failed to delete => {0}".format(e),file=sys.stderr)

        if (path.isdir(self.backup_folder_wrk)):
            try:
                system("rd /s /q {0}".format(folder))
            except Exception as e:
                print("WARN: Failed to delete => {0}".format(e),file=sys.stderr)

        if (path.isdir(folder)):
            print("WARN: Failed to delete {0}".format(folder),file=sys.stderr)
        # ------------------------------------------------------------------------------------- 
```

# vb.net - 如何在VB函数中添加可选参数/默认值参数？

> ID：303214
> 
> 赞同：45
> 
> 时间：2008-11-19T20:21:45.067
> 
> 标签：vb.net, parameters, optional-parameters

如何在 Visual Basic 中创建包含可选参数的方法？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-11-19T20:23:47.293

使用`Optional`关键字并提供默认值。可选参数必须是最后定义的参数，以避免创建模棱两可的函数。

```
Sub MyMethod(ByVal Param1 As String, Optional ByVal FlagArgument As Boolean = True)
    If FlagArgument Then
        'Do something special
        Console.WriteLine(Param1)
    End If

End Sub 
```

像这样称呼它：

```
MyMethod("test1") 
```

或者像这样：

```
MyMethod("test2", False) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-12T05:58:39.277

请记住，可选参数不能位于必需参数之前。

此代码将显示错误：

```
Sub ErrMethod(可选的 ByVal FlagArgument As Boolean = True, ByVal Param1 As String)
    If FlagArgument Then
        '做一些特别的事
        Console.WriteLine(Param1)
    万一
结束子

```

这是常见错误，调试器没有太多解释......它有道理，想象一下调用......

```
ErrMethod(???, Param1)

```

# perl - 如何在 Perl 中跳出循环？

> ID：303216
> 
> 赞同：313
> 
> 时间：2008-11-19T20:21:48.530
> 
> 标签：perl, loops, break, strict

我正在尝试`break`在循环中使用语句`for`，但由于我也在我的 Perl 代码中使用严格的 subs，所以我收到一条错误消息：

> 在 ./final.pl 第 154 行使用“strict subs”时不允许使用裸词“break”。

是否有解决方法（除了禁用严格的潜艇）？

我的代码格式如下：

```
for my $entry (@array){
    if ($string eq "text"){
         break;
    }
} 
```

* * *

## 回答 #1

> 赞同：462
> 
> 时间：2008-11-19T20:23:48.570

哦，我找到了。你使用[last](http://perldoc.perl.org/functions/last.html)而不是[break](https://perldoc.perl.org/functions/break.html)

```
for my $entry (@array){
    if ($string eq "text"){
         last;
    }
} 
```

* * *

## 回答 #2

> 赞同：177
> 
> 时间：2008-11-19T20:33:48.723

附加数据（如果您有更多问题）：

```
FOO: {
       for my $i ( @listone ){
          for my $j ( @listtwo ){
                 if ( cond( $i,$j ) ){

                    last FOO;  # --->
                                   # |
                 }                 # |
          }                        # |
       }                           # |
 } # <------------------------------- 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2017-05-09T14:32:50.227

只需`last`在这里工作：

```
for my $entry (@array){
    if ($string eq "text"){
         last;
    }
} 
```

如果您有嵌套循环，`last`则将从最里面的循环退出。在这种情况下使用标签：

```
LBL_SCORE: {
    for my $entry1 (@array1) {
        for my $entry2 (@array2) {
            if ($entry1 eq $entry2) { # Or any condition
                last LBL_SCORE;
            }
        }
    }
 } 
```

给定一个`last`语句将使编译器从两个循环中出来。在任意数量的循环中都可以这样做，并且标签可以固定在任何地方。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-09-14T23:45:21.637

在大型迭代中，我喜欢使用中断。只需按`Ctrl`+`C`退出：

```
my $exitflag = 0;
$SIG{INT} = sub { $exitflag=1 };

while(!$exitflag) {
    # Do your stuff
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-08-25T14:02:17.977

对于带有*隐式循环*（使用`-n`或`-p`命令行选项）的 Perl 单行代码，使用`last`or`last LINE`来跳出遍历输入记录的循环。例如，这些简单的示例都打印输入的前 2 行：

```
echo 1 2 3 4 | xargs -n1 | perl -ne 'last if $. == 3; print;'
echo 1 2 3 4 | xargs -n1 | perl -ne 'last LINE if $. == 3; print;'
echo 1 2 3 4 | xargs -n1 | perl -pe 'last if $. == 3;'
echo 1 2 3 4 | xargs -n1 | perl -pe 'last LINE if $. == 3;' 
```

所有打印：

```
1
2 
```

perl 单行程序使用这些命令行标志：
`-e`: 告诉 Perl 查找内联代码，而不是在文件中。
`-n`：一次循环输入一行，`$_`默认情况下将其分配给。
`-p`: 与 相同，在输入的每次循环迭代后`-n`也添加。`print`

**也可以看看：**

[`last`docs](https://perldoc.perl.org/functions/last.html)
[`last`, `next`, `redo`, `continue`- perlrun**示例**](https://stackoverflow.com/a/38192317/967621)
[：命令行切换 docs](https://perldoc.perl.org/perlrun.html#Command-Switches)

* * *

**`last`Perl 单行代码的更多示例：**

[在第一次匹配后中断一个线性命令行脚本](https://www.perlmonks.org/?node_id=1060344)
[打印一个大文件的前 N ​​行](https://stackoverflow.com/a/30649878/967621)

# java - 如何将 ArrayList 绑定到 Oracle 中的 PreparedStatement？

> ID：303218
> 
> 赞同：5
> 
> 时间：2008-11-19T20:22:16.233
> 
> 标签：java, oracle, jdbc, arraylist, prepared-statement

我想知道是否有办法将 ArrayList（或任何类型的 List，就此而言）绑定到 PreparedStatement，最终将用于访问 Oracle 数据库。我发现：

[PreparedStatement IN 子句的替代方案？](https://stackoverflow.com/questions/178479/alternatives-for-java-sql-preparedstatement-in-clause-issue)

这似乎与我的问题相似，但这个问题更具体：我想将一个 ArrayList 绑定到一个 PreparedStatement 以在 Oracle 中使用，如果可能的话，这是如何完成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T20:39:28.120

您不能将 List 绑定到准备好的语句中的单个参数。

为列表中的每个元素生成带有参数标记的 SQL，例如：

```
SELECT NAME FROM ITEM WHERE ID IN (?, ?, ?, ?) 
```

即使您将为每个查询生成一个新语句，我仍然建议使用`PreparedStatement`. 如果您的列表包含`String`实例，您将获得必要的转义以防止 SQL 注入。

但即使它是安全类型，如`Integer`对象，一些驱动程序或中间件也可以缓存`PreparedStatements`，并在请求相同的表单时返回缓存的实例。当然，一些测试是必要的。如果您的列表大小差异很大，您将有许多不同的语句，并且实现不佳的缓存可能无法处理这么多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T20:53:06.687

不能直接绑定。有一种方法可以将数组作为参数传递。我不知道你想在数据库端用它做什么，所以这可能对你没有帮助。

基本上，您必须在数据库中创建一个嵌套表类型；基于该类型构建一个 Java 对象，其中包含数组中的数据；并将其作为参数传递。

如果您在数据库中创建了这些对象：

```
CREATE OR REPLACE TYPE my_nested_table IS TABLE OF VARCHAR2(20);
CREATE TABLE my_table (a  my_nested_table) NESTED TABLE a STORE AS my_table_a; 
```

然后你可以像这样编写Java代码：

```
String[] insertvalues = { "a", "b", "c" };
PreparedStatement p = conn.prepareStatement("INSERT INTO my_table VALUES( ? )");
ARRAY insertParameter = new ARRAY( a_desc, conn, insertvalues );
p.setArray( 1, insertParameter );
p.execute(); 
```

Oracle 中的结果如下所示：

```
dev> select * from my_table;

A
--------------------------------------------------------------------------------
MY_NESTED_TABLE('a', 'b', 'c') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T20:38:47.027

好吧，从那个答案来看，尤其是对我在那个问题中的错误答案的评论，你不能。

请参阅[https://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/mapping.html#996857](https://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/mapping.html#996857)。

# google-maps - GIS 程序设计概论

> ID：303221
> 
> 赞同：38
> 
> 时间：2008-11-19T20:22:32.397
> 
> 标签：google-maps, gis, survey, esri, osgeo

该站点上有多少程序员使用 GIS？

您使用什么中间件？ESRI？地图指南？谷歌？

你从事什么样的项目？您是否专注于 Web 工作、制作桌面应用程序或 Intranet 项目？你从事什么样的行业？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T19:47:55.367

过去 4 年在伦敦交通局工作，之前在 MapInfo 工作。最近参与了基于 Oracle MapViewer 和 Oracle Spatial 数据库的瘦客户端 GIS 解决方案。主要是 J2EE / AJAX 的东西。由于各种原因，我们所有的项目都朝着这个方向发展——在整个组织中使用瘦客户端、更少的许可问题、更容易的部署、更好的性能。GIS 位是最容易的部分，清理每一个垃圾数据是需要所有努力的。还有 ETL 的问题，我们正在处理一些表包含超过 350 亿行空间数据的数据库，并且有时会有点繁重。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T20:28:55.380

我使用 ESRI ArcGIS 堆栈构建各种应用程序，包括支持 GIS 的桌面应用程序、数据管理和工作流自动化（即中间件）和 Web 应用程序。过去，工作往往是内部研究项目和高级开发/原型。最近，我的工作一直是为外部客户服务。我的工作主要是为政府部门服务的。

在不久的前世，我使用一些非 ESRI 工具（主要是空间数据库）做了一些工作。

全面披露：我目前为 ESRI 工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-28T15:49:06.067

我想我会被认为是一名 GIS 程序员。我工作的公司历来从未雇佣过具有地图绘制经验的程序员。

我使用的工具包括：Autodesk Mapguide、MapInfo、FME、SQL 2008 和 Virtual Earth。

我的职业生涯始于在 ArcView 3.x 中使用 Avenue Script。

我们大部分时间都在做网络工作。虽然我们有很多数据，所以有时我也会在 ETL 类型的领域提供帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-26T20:45:44.657

我会用一个警告插入来回答：我是一名使用*GIS*的程序员。:) 我最常使用的工具是[ArcGIS](http://www.esri.com "ArcGIS")和[GDAL](http://www.gdal.org "GDAL") / [OGR](http://www.gdal.org/ogr/ "OGR")，并涉足[QGIS](http://www.qgis.org/ "地理信息系统")和[GRASS](http://grass.itc.it/ "草")。在 GIS 方面，我锻炼我所拥有的开发人员的小技能通常是格式转换和编译（采用程序 A 中使用的这种结构化数据，将其混杂一点，并与程序 B、C&D 中的数据混合并导出在程序 E) 中使用。到目前为止选择的语言是 python，但是当我回顾实际上最成功的语言时，以重用次数或处理的数据千兆字节数来衡量，人们会认为我的偏好是 AML 或 win/dos 批处理脚本。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-24T19:56:06.583

*   该站点上有多少程序员使用 GIS？

这是无法回答的，但我会猜“很多”。您只会根据网站在首页上的时间量获得使用该网站的样本，并且只有其中的样本会阅读问题，并且只有其中的样本会回答问题。

*   您使用什么中间件？ESRI？地图指南？谷歌？

我编写了自己的自定义地图软件。您将在下面看到原因。

*   你从事什么样的项目？您是否专注于 Web 工作、制作桌面应用程序或 Intranet 项目？

嵌入式 GPS 和远程信息处理设备。我为各种应用程序进行硬件和软件工程，从消费类 GPS 设备到微型跟踪和遥测单元。主要是联网的。有时 GIS 数据在设备上，有时在通过无线连接的服务器上。一些用于遥测和跟踪的网络开发工作 - 例如，超级马拉松自行车比赛将在自行车（或跟随自行车的乘员车）上安装一个设备，并且赞助商可以在线跟踪行动，而不是随着比赛的进行而驾驶路线。

*   你从事什么样的行业？

消费、工业、体育、航运等。有很多基于位置的行业，或具有基于位置的应用程序的行业。

-亚当

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-23T21:57:13.810

我是一家小型软件公司的开发人员，该公司专门从事[GE Smallworld](http://en.wikipedia.org/wiki/Smallworld)系列产品的扩展。Smallworld 并不是众所周知的 GIS，尤其是在美国，但它被公用事业广泛使用。我们的客户是天然气和/或电力公司。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-04T21:36:49.463

我在美国政府和教育部门为 Microsoft 工作。虽然我不是 GIS 专家，但我发现我们几乎所有的项目都有 GeoSpatial 组件。让我们面对现实吧，位置信息是大多数现代业务系统的要求——尤其是在政府部门。

我经常使用 Microsoft 的 Virtual Earth（现在称为 Bing Maps for Enterprise）。我发现它很容易学习和快速上手。有一个非常好的交互式 SDK，可以让学习变得容易。 [http://www.microsoft.com/maps/isdk/ajax/](http://www.microsoft.com/maps/isdk/ajax/)

我们使用 Virtual Earth 来满足简单的需求，例如地理编码位置、在地图上覆盖客户数据的混搭等。VE 最近具有一些不错的功能，包括 GeoRSS 和 KML 支持、简单图层等。此外，VE 和 ESRI 正在合作。ESRI 正在与[ARCGis、VE 和 Silverlight](http://resources.esri.com/help/9.3/arcgisserver/apis/silverlight/samples/start.htm)进行一些非常有趣的集成。

此外，SQL Server 2008 具有新的地理空间数据类型，使您能够编写基于位置的查询。

我真的很喜欢使用这项技术。这很有趣，因为它具有互动性和视觉效果。你可以在短时间内完成很多事情，而且很容易学习。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-24T14:28:54.607

我在 ArcObjects 上工作，扩展 ESRI 的 ArcGIS Desktop。目前，我正在努力将我的技能集扩展到服务器领域，并在旁边的 Opens source 上了解世界。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-29T18:33:42.530

有关一些开源想法，请参阅[链接文本。](http://www.osgeo.org/)GRASS、R、GMT、GDAL、PostGIS、Mapserver 是我经常使用的一些工具。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-24T15:26:53.037

我在 ESRI 堆栈上开发。我在 ArcMap、ArcIMS、SDE、ArcEngine、ArcReader、MapObjects 和 ArcGIS Server 上构建了应用程序。我使用 .NET 从头开始​​构建了一个 ArcIMS 查看器，它具有完全可定制的界面和后端管理。它被称为 iDV [idv.civilsolutions.biz](http://idv.civilsolutions.biz/login.aspx?Username=Demo&password=Demo&siteservice=Hammonton)。我们专注于政府工作，做所有类型的申请。从简单的流程工具到整个自定义工作流程应用程序。我在桌面、服务器、网络和数据库上开发了应用程序。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-22T22:31:24.377

我使用（d）以下：

*   鹰图 Geomedia 产品线，包括桌面版和网络版。
*   ESRI 组件
*   Tatuk GIS 组件。

我在以下领域从事最终用户应用程序的工作：

*   交通
    *   交通监控
    *   交通标志和信号
    *   交通事故分析
*   天然气、供水和下水道管道
*   公共基础设施
*   公园植被
*   公墓

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-20T15:36:39.587

我不再从事 GIS 工作，但我完成了关于模型泛化的硕士论文。（德语中的 Modellgeneralisierung）。任务是编写一个程序，将德国 ATKIS 格式 (1:25,000) 的地理数据转换为欧洲 Corine Land Cover (1:100,000) 格式。在 Oracle Spatial 中，这两个数据集都以多边形表示，主要任务是合并相邻多边形以减少多边形数量，而不会丢失不必要的信息。

编程是用 Java 完成的，仅仅是因为它是我最了解（并且最了解）的语言，并且已经有很好的库，例如 JTS（Java 拓扑套件）。

问题还没有真正解决。我在大学的辅导员一直在努力，并正在尝试一种基于栅格数据的方法。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-19T20:29:50.463

不是真正的 GIS 程序，但我们的软件适用于 ESRI 形状文件。我们制作环境建模软件（噪音和空气质量）。而且我们现在支持很简洁的 kml 文件。

我们是一家拥有自己的软件组的咨询机构（我们也将软件出售给其他人）。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-03T23:31:14.520

虽然我不认为自己是一名 GIS 程序员（在使用 GIS 进行编程 8 年后，我最近才发现地理处理的全部内容），但我确实使用 ESRI 的 ArcGIS Engine 以及 MapObjects。我们还在 ArcGIS Server 上做了一些工作。

我在拉斯维加斯的一个防洪区工作。我们主要在桌面上为我们的工程人员使用 GIS，但我们也有一个网站，旨在为外部工程师和市民提供对洪水相关信息的访问。

编辑：现在进入 ESRI 的[Flex API](http://resources.esri.com/arcgisserver/apis/flex/)。真让人激动。他们终于赶上了谷歌。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-05T20:11:09.043

我是一名~~前~~GIS 程序员。我在桌面和 ArcGIS Server 上使用 ESRI ArcObjects 大约 3 年。

**更新：**我又在 GIS 工作了。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-11-18T07:29:37.437

我在许多项目中同时使用 MapGuide classic (6.x) 和 MapGuide Open Source

我开发的[探索澳大利亚旅游指南](http://www.exploreaustralia.net.au/)使用了 MapGuide 的地图以及托管在 Amazon CloudFront 上的图块

我也必须强烈推荐 openlayers，封闭源代码的东西在地理空间世界中是 1990 年代的。我去了悉尼的 FOSS4G，可用的东西令人印象深刻。

在数据库方面，我主要使用 oracle，postgis 是 nioce，只是还没有开始使用它

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-03-25T08:46:49.403

我在一家生产多种空间功能产品的小公司工作。

我们已经完成了 Mapserver/php-mapscript/postgis 项目，但我们正在使用 MapXtreme (Mapinfo) MS SQL 2008 转向 dotnet 解决方案

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-06-22T13:27:19.077

我已经开发 GIS 应用程序大约 12 年了。我使用 ESRI 堆栈，主要是基于服务器的应用程序（ArcGIS Server 等）。我的专长是 Web 应用程序，我的大多数客户都是公共实体或私人公用事业公司，偶尔会有私人企业希望集成 GIS。

我也在一边做 Ruby on Rails 咨询。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-01-25T23:21:47.573

我是一名 GIS 软件开发人员。我大部分时间都在使用[Cadcorp](http://www.cadcorp.com) SIS 技术以及用于 GIS 项目的大量免费和开源软件，主要是来自[OSGeo Foundation](http://osgeo.org)堆栈的软件，如[GDAL/OGR](http://www.gdal.org)、[GEOS](http://trac.osgeo.org/geos)、[PROJ.4](http://trac.osgeo.org/proj/)、[PostGIS](http://www.postgis.org)和[Boost。几何（又名通用几何库）](http://trac.osgeo.org/ggl/) ——主要作为程序员和贡献者，当然也作为用户。

我也经常使用 Autodesk 的[特征数据对象 (FDO)](http://trac.osgeo.org/fdo/)。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-11-28T15:56:50.357

我曾经为 ESRI 的业务合作伙伴工作，我们有几个基于 ArcGIS Engine 的 Tablet PC 应用程序，还为 ArcMap 和 ArcSDC 做了很多定制工作（全部使用 C#，使用 ArcObjects）。我从 ArcObjects 8 的一个 beta 版本开始。我们的客户主要来自公用事业部门，以及一些国家地图机构（提示：我在英国！）。

最近我做了一些谷歌地图的工作，一些在我的业余时间。查看[我的加州交通](http://www.mycaliforniatraffic.com)- 在谷歌将该设施添加到他们的主要地图网站之前大约一年，该网站在谷歌地图上显示了实时高速公路交通数据。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-12-09T16:29:36.680

我是业余 GIS 程序员。我有一个用 VB6 编写的桌面应用程序，它使用 Blue Marbles GeoView 映射组件为使用 ESRI 形状文件和 geotiff 的位置构建数字地图。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-12-09T16:39:01.793

我做了一些简单的 GIS 编程，阅读 ESRI shapefile 和 GeoTIFF 光栅文件。我们推出了自己的计算几何代码来处理多边形数据并在 GDI+ 和 directx 中进行渲染。

然后就在最近，我参加了 ArcGIS 课程，只是为了学习基本的工作流程。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-10T01:12:10.453

I'm working on building extensions into ArcMAP, using C# (since we have other Windows COM objects we need to interact with) in MS Visual Studio.

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-12-28T13:14:49.587

我已经参与 GIS 开发近 15 年了。首先是作为使用 C++ 的商业软件开发人员，现在我主要使用 ArcObjects 在 C# 中开发应用程序。我有一些使用 GDAL 和其他开源库的自定义桌面工作，但我必须承认我更喜欢 ESRI 和其他平台的质量。

我还建议开发人员评估 Manifold。这家公司很古怪，但产品还不错。缺点是与 ESRI 相比，开发人员支持相形见绌，您需要花费大量时间重新开发轮子。尽管如此，与 ESRI 相比，它在成本方面的切入点要低得多。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-12-28T13:21:23.863

我不是很喜欢 GIS，但使用 ESRI 的东西在该领域做了一些工作。

清理原始数据并从中提取有用信息是最困难的部分：[http ://espace.library.uq.edu.au/view/UQ:10313](http://espace.library.uq.edu.au/view/UQ:10313)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-12-29T19:21:41.327

作为一名顾问，我一直在为客户从头开始开发一个客户端 JavaScript 地图控件，该控件带有一个公共 API，用于专有的基于图块的地图引擎。整个事情在功能和结构上都非常类似于 Google Maps API。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-11-02T14:03:02.343

我的公司为卫星开发任务规划软件，所以我们有一些地理数据，尽管我们经常将其转换为大地测量数据。我们的软件在 .Net 2.0 (C#) 和[NetTopologySuite](http://nts.sourceforge.net/)中。对于最终用户的可视化，我们使用[STK](http://www.stk.com/)（v7、8 或 9）或[Google Earth](http://earth.google.com/)。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-06-10T02:33:31.433

我们使用avismap。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-06-04T21:19:55.863

我经常使用 MapInfo 的 MapX 和 MapInfo Professional。比我想要的更多——我真的想将我们的软件升级到 MapExtreme 2008（我讨厌公司如何使用 EXTREME——但我离题了）。

过去，我也使用过 ESRI 的 ArcView、ArcGIS 和 MapObjects 堆栈。作为软件开发人员在该领域工作了大约 9 年。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-11-24T14:38:51.887

我们主要关注紧急服务行业，主要与 ESRI ArcObjects 合作开发桌面应用程序和 SDE。最近，我们还做了一些工作开源 GIS SharpMap 为我们的低成本客户开发应用程序。去年与 Manifold 做了一些工作，并且有兴趣使用 KML 和 google 进行更多开发，但现在我们主要是一家 ESRI 商店。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2008-12-23T19:45:15.823

晚会迟到了。然而：

我已经/正在为 ArcGIS 开发几个桌面扩展（在此之前，ArcView...Avenue，我想念你！）；我最近也一直在使用 OpenLayers 并相当广泛地使用 PostGIS。

我的一些工作是开源的：[http ://code.google.com/p/boundary-generator/](http://code.google.com/p/boundary-generator/)

做 GIS 工作最棒的事情之一是它让我有机会与保护非营利组织合作——这是一种职业生涯的好方法，而且是为了一个事业！

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-10-12T14:12:00.383

我正在研究 ESRI arcgis .net web adf。

我们主要专注于网络。我们主要专注于全球海上油气田。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2010-03-08T13:54:16.183

我已经开发 GIS 应用程序超过 15 年了。多年来使用了多种工具，包括 ArcGIS、MapInfo、Manifold、TatukGIS 和开源。我几乎放弃了 MapInfo 和 Manifold。对于咨询工作，ESRI 不会出错。一套很棒的工具，涵盖了从服务器到桌面再到 Web 的所有内容。对于预算有限的客户来说，开源也是另一个不错的选择。 多年来，[开源地理空间基金会确实得到了扩展，并为地理空间开发人员提供了一个很棒的工具包。](http://www.osgeo.org/)

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-01-02T06:42:40.093

我们主要使用基于 Web 的 GIS，在后端使用 java、coldfusion 和最近使用 arcIMS、arcGIS 和 mapServer 的 flex。我们处理各种 GIS 工作，其中一些是“嵌入”的，例如在相关地图上简单地显示样本位置（例如宝石样本与地质），以用于管理环境和矿产资源的完整 GIS 应用程序。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-12-23T03:07:02.487

我不是 GIS 程序员，但我是一名 Java 程序员，使用 ESRI ArcGIS server 9.3 和 Oracle 10g 构建网站。我们将其余的 javascript api 用于地图，大部分 SDE 的 ST 函数用于后端工作。我们将通过 java api 使用 NetworkAnalyst，并可能在我们添加功能时使用 arcobjects。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-11-19T20:38:14.360

我主要从事处理公用事业的 Intranet 软件，尽管我已经完成了一些与 Web 上的房地产相关的快速小型项目。

我主要使用 ESRI 软件，虽然我也使用过一些 Mapguide，主要是为工程部门使用 CAD 多于 ArcMAP 的客户。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-11-19T20:44:56.767

我是一名前 GIS 程序员。我们使用 ESRI 的 ArcLogistics Navigator SDK 来提供转向指示和商用车辆的车载跟踪。

SDK 相当容易使用并且占用空间小，尽管在功能上有点轻量（例如，没有地址的地理编码）。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-11-24T20:01:56.553

我实际上为地图市场的两个主要参与者之一工作，所以是的，我使用 GIS 的东西，我们生产的是你们大多数人加载到你的 ESRI 或谷歌堆栈中的东西。我想说我的行业是高度关注导航的数字地图。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2008-12-23T22:02:01.040

我使用 ESRI MapObjects 和 ESRI AcrObjects，主要用于国防项目。还与用于 S-57 格式的 SevenCs（不错的 SDK）一起使用。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2009-02-20T15:27:28.750

我正在使用.net fw。在 Esri 组件上。在我这里，我们正在开发一个 Intranet 应用程序，但我们同时使用 Web 应用程序和客户端服务器（使用 ArcGis Explorer 和定制的客户端应用程序）

此外，我们还在 Gis 工具之上创建了许多 WCF 服务，因此任何非 Gis 客户都可以享受我们的工作！

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2008-11-19T20:29:34.817

我是一名前 GIS 程序员。80 年代末、90 年代初，我在渥太华的 GeoVision Systems 工作了 6 年。工作很棒，工作的好地方。这些天来，我有一个使用 PostGIS 和大量手动 perl 代码的半 GIS 相关副项目。它是一个飞行员航路点数据库，以及一个为各种 GPS 和飞行计划应用程序生成数据子集的系统。

我希望有一天能重新开始 GIS 编程，但在纽约罗切斯特这里没有。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2009-01-14T11:50:06.393

我真的很晚才参加这个聚会，因为直到几分钟我才知道stackoverflow.com（在检查网站后说这很尴尬......不知道我是怎么错过的）。

我是一名 GIS 程序员，从 90 年代中期就开始了。我目前在 ESRI 堆栈上，刚刚开始在 SQL Server 2008 DB 上从 ArcGIS Server 9.2 迁移到 9.3，我很高兴看到我可以在 SQL Server 中使用 GEOMETRY 数据类型做什么。我会更加兴奋使用 SharpMap.v2 的 SQLSRV2008 数据提供程序。

在家里，我玩 postgresql/postgis，我也一直在玩 spatialite。

我有一些使用 Net Topologoly Suite (NTS) 和一些 OGR 库的工具，但没有那么大或令人印象深刻。虽然我确实了解到没有 ESRI 的引擎你可以做很多事情。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2009-04-29T22:36:12.583

2-3 名开发人员在这里使用 GIS，混合使用 MapGuide、Google Maps、FME、ArcObjects。内部市政应用。

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2009-06-09T22:27:50.510

我正在使用windoze 上的ESRI 9.2 java 堆栈。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2009-07-29T20:54:28.970

ESRI 堆栈、VB.net 中的一些 arc 对象和一些 python。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2009-11-15T07:08:40.807

我是一名 GIS 程序员。使用[AvisMap GIS Engine](http://www.avismap.com)。

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2011-04-06T11:13:32.620

Java、REST 服务、Tomcat、PostgreSQL 与 PostGIS、KML 和 ESRI Shapes。所有这些组件和格式都强大、灵活、最先进，适合“领域”中的大多数要求

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2015-09-30T17:14:53.743

我从事与 GIS 相关的工作已经快 10 年了。大约 5 年时间为 ESA 的地球观测卫星开发验证器，然后在海洋实验室为海洋研究人员绘制卫星和现场数据，然后在雷丁大学的气象系使用 GeoLinkedData 环境数据集，现在在伦敦大学学院帮助能源研究所的一些人绘制并分析了大量的 AIS 数据集。我正在使用最新的 CartoDB，其余的是 PostGIS、ESRI、OpenLayers、ArcGIS、GDAL 的混合体......甚至不记得了！

# linq-to-sql - LINQ to SQL - ForeignKey 中的可空 INT =“无法创建关联......”

> ID：303239
> 
> 赞同：9
> 
> 时间：2008-11-19T20:25:43.683
> 
> 标签：linq-to-sql, foreign-keys, associations

我有一个主键是 INT 的表...我有另一个表，它与第一个表有外键关系，但它是一个 NULLABLE INT。

这完全没问题，并且 100% 可以被 SQL 接受……但是 LINQ to SQL 抱怨类型不匹配（“int to Nullable[int]”）。

错误消息：无法创建关联“Store_People”。属性没有匹配的类型：“PersonID”、“ID”。

我该如何解决这个问题，以便设计师停止对 100% 正确使用 SQL 大喊大叫？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-21T18:55:52.883

我发现了问题。只有当父类没有 Nullable 字段作为键时，您才能创建关联。

所以这：

[替代文字 http://www.singingeels.com/Articles/UserImage.aspx?ImageID=43d83ac4-707d-47fc-832c-588261e6a5d7](http://www.singingeels.com/Articles/UserImage.aspx?ImageID=43d83ac4-707d-47fc-832c-588261e6a5d7)

将导致此错误：

[替代文字 http://www.singingeels.com/Articles/UserImage.aspx?ImageID=19ed54aa-9f4f-4d5c-ba18-4996509d2da7](http://www.singingeels.com/Articles/UserImage.aspx?ImageID=19ed54aa-9f4f-4d5c-ba18-4996509d2da7)

...但是这个：

[替代文字 http://www.singingeels.com/Articles/UserImage.aspx?ImageID=0e09affd-2134-4712-999b-7e792f6e081b](http://www.singingeels.com/Articles/UserImage.aspx?ImageID=0e09affd-2134-4712-999b-7e792f6e081b)

将完美地工作。

这看起来像一个错误（或者至少是 LINQ to SQL 的愚蠢）......但除此之外我更喜欢它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T21:25:07.543

我现在正好在 DBML 中遇到这种情况，并且工作正常。

## 首要的关键

*   可空 - 假
*   主键 - 真
*   服务器数据类型 - int NOT NULL IDENTITY
*   类型 - int (System.Int32)

## 外键

*   可空 - 真
*   主键 - 假
*   服务器数据类型 - Int
*   类型 - int (System.Int32) （实际上在context.designer.cs文件中定义为Nullable）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T21:38:22.680

这是我一起扔的。Table2 的 Table1Id 列是 Table1 的可为空的外键。我什至投入了一些数据记录并测试了一些 Linq 查询......

![在此处输入图像描述](https://i.stack.imgur.com/ZSRVN.png)

*编辑*：由于我（显然）对断开的链接投了一些反对票，因为这个问题已有 6 年历史，而且我使用的主机没有幸存下来……这是一个更新的版本。

# c++ - 存储二维点以快速检索矩形内的点

> ID：303243
> 
> 赞同：5
> 
> 时间：2008-11-19T20:26:52.793
> 
> 标签：c++, stl, boost, spatial, point

我有大量的 2D 点，我想快速获取位于某个矩形中的点。让我们说一个'。是任意点，“X”是我想在一个矩形内找到的点，该矩形将“T”作为 TopLeft，“B”作为 BottomRight 点：

```
. . . . . .
. T-----+ .
. | X X | .
. +-----B .
. . . . . . 
```

我尝试了一个带有排序函子的 std::set ，它在集合的开头对 TopLeft 点进行排序，在集合的末尾对 BottomRight 进行排序。当先按 X 值排序时，这将导致找到以下点。

```
. . . . . .
. T-----+ .
X | X X | X
. +-----B .
. . . . . . 
```

这意味着我必须检查每个找到的点，它是否真的在矩形内。不是很好。

有什么更好的方法来做到这一点？

我的语言是 C++ (Windows)，我有 STL 和 boost 可用。

### 更新

到目前为止阅读了答案，我注意到我没有考虑到我的问题的所有参数：没有一个固定的矩形。矩形可以由用户在运行时设置。这意味着对点集进行排序有望比在此更新之前 Artelius 建议的通过所有点进行线性搜索更有效。不过，我还是会试一试！我不希望用户*非常*频繁地设置矩形。因此，关于实施工作，它可能对我来说是一个很好的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T20:35:25.443

您可以使用四叉树或 r 树将点存储在空间索引中。然后给定矩形，您可以找到与其重叠的树的所有节点，然后您必须比较该子集中的每个点以查看它是否落在矩形中。

本质上，空间树可以帮助您修剪搜索空间。

您也许可以使用更简单的解决方案，例如对范围内的点进行分区。说 x 从 0,10 作为一个范围，11,20 作为另一个范围。任何可以让您修剪搜索空间的解决方案都会有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T20:35:42.527

请看[这个问题](https://stackoverflow.com/questions/132319/storing-objects-for-locating-by-xy-coordinates#132393)。 [Stony Brook Algorithm Repository](http://www.cs.sunysb.edu/~algorith/files/kd-trees.shtml)有一些 KDTrees 在 C++ 中的实现，尽管它们不是 STL 或 Boost 的一部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T21:11:31.767

对数组进行排序需要 O( *n* log *n* ) 时间。简单地单独检查每个点（不排序）需要 O( *n* ) 时间。

因此，只需遍历并检查每个点比排序要*快。*它也比构建四叉树更快。

编辑：如果你有很多矩形要检查，那就另当别论了。但是，如果您只需要检查一小部分固定数量的矩形，那么只需以“明显”的方式进行操作！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T20:35:33.227

使用四叉树，您有 3 种类型的 qtree 节点：

1.  节点在目标矩形之外：忽略
2.  节点在目标矩形内：包括节点内的所有点
3.  节点部分位于矩形之外：对节点内的点进行边界检查

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T20:55:34.327

在 Yuval F 的链接之后，我找到了[Range Search](http://www.cs.sunysb.edu/~algorith/files/range-search.shtml)，这似乎正是您正在寻找的东西。我从那里找到了一些链接，找到了[CGAL](http://www.cgal.org/)，一个开源 C++ 库，它实现了范围搜索，[这里](http://www.cgal.org/Manual/3.3/doc_html/cgal_manual/Point_set_2/Chapter_main.html#Section_43.2)有示例。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-19T20:43:59.000

您的排序函数可以在为矩形内部添加点时检查点，并将矩形内的所有点排序在矩形外的所有点之前。您必须跟踪每个存在的数量，或者对整个集合使用二进制搜索以在查找时找到截止点。

# svn - 如何在 Subversion 中修剪旧版本？

> ID：303247
> 
> 赞同：24
> 
> 时间：2008-11-19T20:28:09.700
> 
> 标签：svn

如何从我的开发 subversion 存储库中删除旧版本？我保留了一个颠覆沙箱，其中有很多测试项目、二进制文件等。我想偶尔修剪一下历史记录。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-19T20:31:42.707

以下是官方回答：

在某些特殊情况下，您可能想要销毁文件或提交的所有证据。（也许有人不小心提交了一份机密文件。）这并不容易，因为 Subversion 被刻意设计为永远不会丢失信息。修订是相互依赖的不可变树。从历史中删除修订会导致多米诺骨牌效应，在所有后续修订中造成混乱，并可能使所有工作副本无效。

然而，该项目计划在某一天实施一个 svnadmin obliterate 命令，该命令将完成永久删除信息的任务。（见问题 516。）

同时，您唯一的办法是 svnadmin 转储您的存储库，然后通过 svndumpfilter（不包括错误路径）将转储文件传送到 svnadmin 加载命令中。有关这方面的详细信息，请参阅 Subversion 手册的第 5 章。

在这里找到：http: [//subversion.tigris.org/faq.html#removal](http://subversion.tigris.org/faq.html#removal)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-07-07T15:49:46.757

乔恩——我们不同意。有时适合修剪“非常旧”的数据，我们确信这些数据将不再需要，因为它已在其他一些媒体中备份。以自动跟踪配置文件版本的系统为例。在某些时候，这样说是有道理的——“我们知道，我们不再需要像一年前那样在线配置。以某种离线格式保存这些信息很好，但保留它生产系统上线并不是一件好事。” 这是一个完美的例子，说明何时能够轻松归档非常旧的数据，然后将其从存储库中删除。我找到了解决问题的方法，

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T20:37:03.537

您可以使用[svndumpfilter](http://svnbook.red-bean.com/en/1.1/ch05s03.html#svn-ch-5-sect-3.1.3)。

但是，这真的不是推荐的事情。存储库应该（大部分）是仅附加数据库。由于数据库的集中性，一些数据突变是可以容忍的，但它不应该是常规操作。

您可能应该为每个项目使用一个单独的存储库，而不是一个您不时想要修剪的包存储库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-20T17:17:57.573

你真的不想修剪历史，那是疯狂的。

你可能想删除旧的分支，这样它们就不会出现在你的 svn 浏览器中，但这就像 'svn rm' 一样简单。修订保留在版本控制系统中。

# c# - 加载 ListBox 的正确方法是什么？

> ID：303248
> 
> 赞同：27
> 
> 时间：2008-11-19T20:28:17.407
> 
> 标签：c#, .net, winforms

`ListBox`在 C# .NET 2.0 Winforms中加载 a 的正确方法是什么？

我以为我可以将它绑定到一个`DataTable`. 没有这样的运气。
我以为我可以用`Dictionary`. 没运气。

我是否必须编写一个名为 的类`KeyValuePair`，然后`List<KeyValuePair>`才能使用对象来加载这个东西？也许我错过了一些明显的东西。我希望我的显示文本和值是不同的值。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-11-19T20:39:29.943

简单的代码示例。假设您有一个`Person`具有 3 个属性的类。`FirstName`,`LastName`和`Age`. 假设您要将列表框绑定到`Person`对象集合。您希望显示器显示名字，但值是年龄。以下是您的操作方法：

```
List<Person> people = new List<Person>();
people.Add(new Person { Age = 25, FirstName = "Alex", LastName = "Johnson" });
people.Add(new Person { Age = 23, FirstName = "Jack", LastName = "Jones" });
people.Add(new Person { Age = 35, FirstName = "Mike", LastName = "Williams" });
people.Add(new Person { Age = 25, FirstName = "Gill", LastName = "JAckson" });
this.listBox1.DataSource = people;
this.listBox1.DisplayMember = "FirstName";
this.listBox1.ValueMember = "Age"; 
```

诀窍是`DisplayMember`和`ValueMember`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-19T21:01:12.990

您可以直接[绑定数据表](http://www.codeproject.com/KB/database/scomlistcontrolbinding.aspx)...

```
listbox.ValueMember = "your_id_field";
listbox.DisplayMember = "your_display_field";
listbox.DataSource = dataTable; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-19T20:35:49.653

假设您的数据类型称为 MyDataType。在该数据类型上实现 ToString() 以确定显示文本。例如：

```
class MyDataType
{
  public string ToString()
  {
    //return the text you want to display
  }
} 
```

然后，您可以获取一个包含您的数据类型的列表，并通过 AddRange() 将其填充到 ListBox 中，如下所示：

```
ListBox l;
List<MyDataType> myItems = new List<MyDataType>(); // populate this however you like
l.AddRange(myItems.ToArray()); 
```

如果您需要更多帮助，请告诉我 - 这将有助于了解您尝试在列表框中显示的数据类型。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T20:40:37.117

您可以将数据源设置为您喜欢的实现 IList 或 IListSource 的任何数据源。

您还需要将 DisplayMember 和 ValueMember 属性设置为您要显示的字段，并分别具有关联的值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T21:33:28.960

使用用于降低性能的 DataSource 参数 - 至少在 ComboBoxes 上，

正如上面的另一位评论者所描述的，我现在非常习惯于覆盖对象上的 ToString() 并仅使用 Items.AddRange() 方法添加对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-20T16:17:03.810

要绑定到字典，您必须将其包装在新的 BindingSource 对象中。

```
MyListBox.DataSource = New BindingSource(Dict, Nothing)
MyListBox.DisplayMember = "Value"
MyListBox.ValueMember = "Key" 
```

# php - 关于（半）在 Flash/PHP 游戏中获得高分的建议

> ID：303255
> 
> 赞同：1
> 
> 时间：2008-11-19T20:31:27.107
> 
> 标签：php, flash, actionscript-3, actionscript

...我在这里阅读了一些讨论各种方法的主题，并且只是在寻找对我们提出的解决方案的一些反馈。在其中一个线程中发布了一条评论，推荐了一个听起来很棒的公钥/私钥，这就是我们的想法......

客户端 - 1\. 密钥存储在使用第 3 方工具加密的 Flash swf 中。2\. 高分与高分值一起散列（例如：md5 ('ourSecretKey' + 200)） 3\. 该值通过 AMF 与高分 (200) 一起发送到服务器上的 PHP 脚本

服务器端 - 1\. 服务器接收数据并对传递的高分 (200) + 密钥（存储在服务器和 Flash 中的“ourSecretKey”）进行哈希处理，并检查传递的哈希值是否匹配它允许高分进入，否则失败。

我知道这不是一个万无一失的解决方案，但这可以接受吗？我的意思是，对于一个简单的在线 Flash 游戏来说，这对于高分形式是否足够安全？想法？

先感谢您！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T20:45:26.530

对于一个可笑的短值（即：值 < 64 个字符），由于彩虹表攻击，MD5 作为哈希变得无效，并且由于您发送的值将通过网络共享，他们所要做的就是蛮力共享秘密（他们有一个已知的产品可以使用）

因此，那不是公钥私钥。它只是共享的秘密。

另外，请记住，这个共享秘密将在您发送给用户的闪存文件中，这些天并且被简单地反汇编，然后您的“秘密”不再是秘密。

您需要一个具有适当加密签名的更多挑战-响应机制，其中从服务器为每个游戏分配一个新的签名密钥，并且不能使用相同的签名密钥提交多个分数。（为了额外的保护；））

1.  用户开始游戏。请求签名密钥。（签名密钥是从他们无法访问的另一个密钥产生的）。
2.  使用签名密钥对分数进行签名，然后发送
3.  您使用您发送给他们的密钥验证标志的值。
4.  您丢弃发送给他们的签名密钥。

但是，您*仍然*存在无法防止实际评分系统被篡改的问题。足够聪明的人可以对您的 SWF 对象进行逆向工程并注入新代码，将分数设置为他们选择的值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T22:53:22.107

你的问题的答案是，这取决于。这主要取决于您的游戏的估计受欢迎程度。

从安全角度来看，您的解决方案与以明文形式发送高分一样安全。你在这里所做的被称为默默无闻的安全，根据你听谁的，在某些情况下可能有它的好处。在这种情况下，普通用户可能无法自己破解它。对于拥有一些 l33t h4xx 或技能的人，您不妨以明文形式发送所有内容。如果您只想阻止 Joe，那么这可能就足够了，至少在有人创建一个供 Joe 下载的假客户端之前（这取决于您的游戏的受欢迎程度可能需要几天到永远不会（或者更快，如果它是哇））。

一个更好的解决方案是@Kent Fredric 给出的解决方案。然而，正如它所说，它并不能解决有人创建假客户的问题。解决方案可能是这样的：

1.  给玩家可以执行的每一个动作一个id。
2.  将玩家执行的每个动作存储在一个 id 列表中。
3.  当游戏结束时，对分数、动作列表进行哈希处理，并使用从服务器接收到的公钥对其进行加密。（有关详细信息，请参阅 Kent Fredric 的帖子）
4.  将加密的哈希（通常称为数字签名）连同分数*和*执行的操作列表一起发送到服务器。
5.  让服务器根据列表中的动作“玩”游戏。
6.  验证是否获得了相同的分数。
7.  验证数字签名是否正确。
8.  更新服务器高分列表。

这将保证两件事：

1.  分数来自正确的客户。
2.  就所玩的游戏而言，得分是正确的。

但是这个方案还有一个严重的缺陷。没有办法知道游戏实际上是真的玩过的。如果客户端受到攻击，列表可能只是发送到服务器的“完美游戏”的预制件。直接篡改评分系统是不可能的，但只要付出足够的努力，某人很可能能够创建一个包含“完美游戏”的动作列表。

但是，它提供了比仅使用 Kent Fredric 帖子中的解决方案更强大的保证。要解决整个问题意味着您必须以某种方式验证客户端。这是非常困难的，因为大多数方法都很容易绕过。

最后，我只需要评论一下您选择的哈希算法：MD5 对于那些仍然生活在九十年代的人来说是一个很棒的哈希算法。对于我们其他人，我推荐 SHA-2 或至少 SHA-1。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T11:45:35.230

如果您的游戏分布有限，并且没有真正的金钱/赏金让玩家获胜，那么您的原始方案可能就足够了。

使用 SWF Encrypt 可能会使提取密钥变得更加困难，即使在更高级的系统中也可能是一个很好的工具。但是如果你有一个真正的公钥/私钥方案（例如 RSA），这真的是一个有争议的问题，因为公钥不是秘密，它不应该是。为了防止大多数人编辑代码和篡改评分系统，SWF Encrypt 可能是一个足够好的选择。

* * *

只是为了让您更加偏执，我还写了以下内容：

与大多数其他类似工具一样，SWF Encrypt 的问题在于它必须仍然可以在（可能已被破坏的）机器上执行脚本。因此，所有信息必须在所述机器上可用。将其与经典的密码学用法进行比较，发送消息：

当您发送加密消息时，您通常信任源和目标，因此它们都具有解密消息的密钥。你不信任的是信使，或者至少你的敌人不会拦截信使。所以快递员没有他们的钥匙，你的信息是安全的。

相反，您的问题是，在您的情况下，您信任目的地（您）而不是来源（客户端），反之亦然。由于您对快递员的信任程度更低，因此您仍然需要来源能够加密消息。因此，源需要拥有所有信息来加密和解密消息才能正常工作。您的问题是您看不到“好”来源和“坏”来源之间的区别。

我的意思是，由于代码必须仍然可以在客户端上运行，因此这样做的信息必须是完全可用的，尽管可能是以模糊的形式。例如，黑客可以创建自己的 ActionScript 编译器，将经过混淆的 ActionScript 代码转换为可读的内容并进行适当的更改。困难但绝对可行。

然而，如果您的分布有限并且没有真正的赏金可赢，那么这种级别的复杂攻击很可能对您来说不是问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T00:58:03.697

> Blockquote 最后，我只想评论一下您选择的散列算法：MD5 对那些仍然生活在九十年代的人来说是一个很棒的散列算法。对于我们其他人，我推荐 SHA-2 或至少 SHA-1。

呸，我知道我应该提到 SHA :)

如果我确实使用类似 swf 加密器应用程序来加密 swf 代码，那至少不会使获取存储在 Flash 中的密钥变得更加困难吗？我认为如果没有那个密钥（或者至少没有很容易地得到它），弄清楚什么是用来生成发送到服务器的散列​​将是一个巨大的痛苦。

我在想这样的事情：[SWF Encrypt](http://www.amayeta.com/software/swfencrypt/)

再次感谢大家的这些答案，这非常有帮助。哦，这只是一个由客户发送给客户的简单 Flash 游戏，在假期打发时间的乐趣。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T13:06:34.217

Kent 说，我没有看到使用该解决方案的任何优势。作为客户端，我可以请求服务器端创建的密钥。好的，我不能使用它超过一次，但我不必......每次我需要一个时，我都会请求它。

1.  所以我要求钥匙。
2.  做我自己的高分
3.  用键对高分进行散列。
4.  将高分发送到服务器
5.  服务器使用提交的密钥来获取高分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-02T10:26:08.797

加密分数的 100% 工作方式只有一种：记录回放。
但不仅仅是任何重播，理想情况下，您应该只记录用户按键和它们之间的空间。这样，即使有人篡改了源或动态地使用RAM，在服务器上播放的回放也会发现问题。
不幸的是，这个解决方案需要大量的工作才能成为可能。为简单起见，您只需手动验证所有分数（或最佳分数），您就会很高兴。尽管如此，您仍然必须避免一些事情：

*   默认随机生成器，您需要种子生成器，它总是为给定的种子提供相同的随机数；
*   没有增量计时，抱歉；
*   自定义三角函数（我不是 100% 确定，我曾经听说它们可以在不同的计算机上给出略有不同的结果）；

并且可能更多。
然而，这种防御是牢不可破的。并且需要时间来编码：D。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T22:32:11.170

哇

相当困难的解决方案 8）。

我曾经实现过这样的系统。虽然它不适用于所有游戏......

你应该在服务器上重玩游戏。当用户玩游戏时——您存储“状态变化”，然后以某种“重播”模式将其提供给您的游戏。

# wcf - 启用跨域 JSON 的 WCF

> ID：303271
> 
> 赞同：0
> 
> 时间：2008-11-19T20:36:47.093
> 
> 标签：wcf, json, cross-domain

我有一个 WCF 服务，装饰有 WebInvoke 属性和用于启用 JSON 的 WebHttp 绑定。在我们尝试使其跨域工作之前，可以从 JavaScript 访问该服务。你能推荐一下如何让它跨域工作吗？

我们尝试创建代理 Web 处理程序，但每次 WebHttpRequest 尝试访问它时它都会给出“错误请求”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-02T15:59:23.000

我必须做的是创建一个代理。跨域请求仅适用于 GET 动词，不适用于 POST。我所有的请求都通过代理，如果它是一个 POST，那么它就像一个典型的代理。如果请求使用的是 GET，那么我必须将其转换为 POST。（我在我的服务合同中将 POST 指定为动词）。

在客户端，我使用 JQuery 的 josnp（带填充的 json）功能将正确的信息附加到查询字符串中。

```
private static readonly Properties.Settings settings = new Properties.Settings();

    public void ProcessRequest(HttpContext context)
    {
        try
        {
            string wcfAddress = context.Request.QueryString["WcfAddress"];                       

            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(settings.WCFAddress + wcfAddress);

            request.ContentType = "application/json";

            request.Method = "POST";

            if (context.Request.RequestType == "GET")
            {
                string callback = context.Request.QueryString["callback"];
                string qs = context.Request.QueryString[null];
                byte[] body = body = Encoding.UTF8.GetBytes(qs);

                request.ContentLength = body.Length;

                request.GetRequestStream().Write(body, 0, body.Length);

                HttpWebResponse response = (HttpWebResponse)request.GetResponse();

                using (StreamReader reader = new StreamReader(response.GetResponseStream(), Encoding.UTF8))
                {

                    string contents = reader.ReadToEnd();

                    contents = callback + "(" + contents + ");";

                    context.Response.ContentType = "application/json";

                    context.Response.Write(contents);

                    response.Close();

                    reader.Close();
                }
            }
            else if (context.Request.RequestType == "POST")
            {
                byte[] body = new byte[context.Request.ContentLength];

                context.Request.InputStream.Read(body, 0, body.Length);

                request.ContentLength = body.Length;

                request.GetRequestStream().Write(body, 0, body.Length);

                HttpWebResponse response = (HttpWebResponse)request.GetResponse();

                using (StreamReader reader = new StreamReader(response.GetResponseStream(), Encoding.UTF8))
                {
                    string contents = reader.ReadToEnd();

                    context.Response.ContentType = "application/json";

                    context.Response.Write(contents);

                    response.Close();

                    reader.Close();
                }
            }
        }
        catch (Exception ex)
        {
            System.Diagnostics.Trace.WriteLine(ex.ToString());
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-28T20:06:23.380

按照[这个优秀文章系列的](http://dhvik.blogspot.com/2011/06/supporting-cross-origin-resource.html)**第 1-4 部分**中提供的步骤，您最终会得到一个干净的解决方案。我在生产中使用它没有任何问题。

您必须进行一项调整以使其适用于所有浏览器。在`CorsDispatchMessageInspector.BeforeSendReply`评论中检查：

> 如果（状态。消息！= null）

否则，“允许”标头仅适用于飞行前请求，而不适用于实际请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-24T19:30:58.190

要解决问题，请执行以下操作

创建一个 Global.asax 并添加以下代码以启用 Ajax 跨域 POST

```
 public void Application_BeginRequest(object sender, EventArgs e)
        {
            HttpContext.Current.Response.AddHeader("Access-Control-Allow-Origin", "*");
            HttpContext.Current.Response.AddHeader("Access-Control-Allow-Methods", "GET, POST,OPTIONS");

            if ((HttpContext.Current.Request.HttpMethod == "OPTIONS"))
            {

                HttpContext.Current.Response.AddHeader("Access-Control-Allow-Headers", "Content-Type, Accept");
                HttpContext.Current.Response.AddHeader("Access-Control-Max-Age", "1728000");
                HttpContext.Current.Response.End();
            }
        }
    } 
```

# javascript - javascript (spidermonkey) 如何从 js shell 运行 linux 命令？

> ID：303275
> 
> 赞同：3
> 
> 时间：2008-11-19T20:37:49.603
> 
> 标签：javascript, server-side

我被难住了，觉得自己很愚蠢。我已经尝试了所有我能想到的搜索组合来解决这个问题。这看起来很简单，但是对于 javascript 来说，我在搜索示例或演示时没有看到任何有用的信息。我正在寻找像 python 或 perl 脚本一样使用脚本来运行简单的 linux 命令。解释器已启动并正在运行，所以我只是在寻找服务器端 js 资源以帮助了解更多关于 js 的信息。如果我想在浏览器中做这些类型的事情，我发现了很多有用的例子——但我不想使用浏览器。我在网站上找不到这样的查询（尽管我确定我问的方式不对）所以如果这确实是一个多余的帖子，请随时关闭并指出正确的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T20:51:51.807

您无法通过浏览器访问系统。无论是 Windows 还是 Linux，您的“js shell”都被沙盒到浏览器中。无法访问文件系统或浏览器之外的任何应用程序。JS 是一种由浏览器解释的脚本语言。

您可以访问浏览器之外的世界，但只能在使用 ActiveX 的 IE 上访问，但那是在沙箱之外，不再是纯 JavaScript。如果您搜索论坛，您将找不到没有 ActiveX 的关于 javascript 文件访问的文档。ActiveX 在 Linux 或 Firefox 上不可用。

您可能想阅读 wikipedia 以了解有关 javascript、DOM 和沙箱的更多信息。 [http://en.wikipedia.org/wiki/JavaScript](http://en.wikipedia.org/wiki/JavaScript)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-21T15:35:42.897

对于 linux，我发现[EJScript](http://www.ejscript.org/)具有开箱即用的文件支持。它让我做我想做的事。我仍然会尝试使用 File_Object 标志编译 spidermonkey，因为我很固执，但到目前为止，我向想要尝试服务器端 javascript 的程序员推荐 EJScript 没有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T21:10:35.293

[在这个页面](https://developer.mozilla.org/En/SpiderMonkey/JSAPI_User_Guide)上寻找“system()” ，这应该是一个开始（对不起，我还没有真正使用过 SpiderMonkey。）

我认为如果你可以编译他们的 JSNative 函数 myjs_system()，那么你就可以在你的 JavaScript 代码中调用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T02:32:55.533

好吧，我现在感觉不那么愚蠢了。我使用 Jscript 和 Windows 上的 .NET Framework 附带的 jsc.exe 让它工作：

```
> var myFileSystemObj = new ActiveXObject("Scripting.FileSystemObject");
> 
> var pathToFileDir = ".";
> var myFolder = myFileSystemObj.GetFolder(pathToFileDir);
> 
> var myEnum = new
> Enumerator(myFolder.Files);
> 
> for
> (;!myEnum.atEnd();myEnum.moveNext()) {
>   print(myEnum.item()) } 
```

这给了我一个目录中的文件名，在 ol' XP 上很好很容易。所以我想问题应该是在 Linux 上是否有类似的工具可以做到这一点？我正在尝试使用`JS_HAS_FILE_OBJECT=1`标志重新编译 Spidermonkey 引擎，但它出错了，所以我有一些阅读和工作要做，但我认为我正朝着正确的方向前进。欢迎任何有关使用 javascript 执行此操作的不同方式的提示或建议（除了“使用 N”，其中 N = python、perl、java 等......）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-08T07:17:47.070

你可以用 node.js' 来做`exec`。

```
# install node.js (debian/ubuntu)
sudo apt-get install nodejs

# run node.js CLI
node 
```

[从此处](http://snippets.dzone.com/posts/show/12069)找到的示例：

```
var sys = require('sys')
var exec = require('child_process').exec;
function puts(error, stdout, stderr) { sys.puts(stdout) }
exec("ls -la", puts); 
```

这会输出一个目录列表。

# asp.net-mvc - MVC 框架比较（主要是成本/速度权衡）

> ID：303278
> 
> 赞同：3
> 
> 时间：2008-11-19T20:38:15.687
> 
> 标签：asp.net-mvc, model-view-controller, pylons

我正在开发一个 Web 应用程序的想法，该应用程序非常适合目前流行的 MVC 框架之一，但在两者之间纠结。我最初打算使用[Pylons](http://pylonshq.com)，但在阅读了[BizSpark](http://www.microsoftstartupzone.com/BIZSPARK/Pages/At_a_Glance.aspx)程序后，我正在重新考虑 ASP.NET MVC。

问题是，如果我成功了，我需要为我将使用的所有软件（SQL Server 和 Windows Server）买单。

所以我的问题是，ASP.NET MVC 和各种 OSS MVC 框架之间的性能比较，特别是 Pylons（或 web.py 或 Django）。而且，如果 ASP.NET MVC 好得多，那么后端的成本是否值得？

托管计划在成本方面似乎足够相似，我认为这不是一个太大的问题。我知道 StackOverflow 运行 ASP.NET MVC，并且仅在两台服务器上就能很好地处理所有流量。还有其他运行 ASP.NET MVC 的“大型”网站吗？

个人背景：我最熟悉 .NET（虽然我没有真正使用过它的 MVC 框架），但我最近基于[Python MVC 框架](http://www.sogeti-phoenix.com/Blogs/post/2008/10/Python-Frameworks.aspx)构建了几个较小的 Web 应用程序。

我查看了 Rails，但我对 Ruby 并不熟悉，而且其中一些看起来非常复杂。PHP 适合我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T21:11:30.627

我在一家使用所有三种（.Net MVC、Rails、PHP）的商店工作。

我们发现，就可维护性和最快完成项目的周转时间而言，Ruby on Rails（或 MERB）提供了最佳解决方案。我也是一个 .Net 人，但这里的其他人似乎认为在 Ruby 中编写自定义功能要比在 PHP 中容易得多。他们说 Ruby 编程语言提供了更完整的功能库，更易于阅读和维护，并且具有优于 PHP 的语言的语义应用程序。

但就您的问题而言，您必须记住，Asp MVC 是在 Asp.Net 的“精简”版本之上编写的（MVC 摆脱了与管理回发和查看状态等）。因此，当您考虑性能时，我很确定您可以放心地假设您将获得类似的性能，如果不是更好，那么您使用 Asp.Net 获得的性能。[无论如何，在ASP.NET MVC 性能](https://stackoverflow.com/questions/43743/aspnet-mvc-performance)上有一个关于这个主题的非常好的线程

至于谁（哪些大型网站）在使用 .Net MVC，我不确定现在是否真的是提出这个问题的正确时机，因为该技术仍处于测试阶段。您可能暂时不会看到 .Net MVC 被广泛使用，因为这也是因为大公司必须进行投资以彻底改革其前端技术。随着最近经济的发展，我不得不想象，对于微软来说，要说服它的任何大型 Asp.Net 客户从 Asp.Net 转移到 MVC 将是一件相当困难的事情，更不用说因为他们两者都是在微软的同一个部门下开发的，除非这符合客户的最大利益，否则他们说服客户采取一种或另一种方式可能没有太大的好处。

综上所述，我做程序员已有 10 多年了，.Net MVC 是微软在那段时间发布的我最喜欢的工具集之一。如果您是 .Net 人员并且您的项目需要 MVC 架构，我建议您继续使用它。如果有其他任何事情，您将对您的网站进行编程。;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T21:10:18.447

我的一个同事已经使用 Django 有一段时间了，最​​近做了一个 ASP.NET MVC 的探索。他的结论是，与大约一个月前的 Django（预览 4 版本）相比，ASP.NET MVC 还没有为黄金时间做好准备。

# f# - F#：如何将 Map 与集合一起使用（如正则表达式匹配）？

> ID：303284
> 
> 赞同：5
> 
> 时间：2008-11-19T20:39:35.043
> 
> 标签：f#, map

Soo... F# 不再有 IEnumerable.map_with_type... 这是人们映射集合的*方式*。我现在该怎么做？

```
let urlPat = "href\\s*=\\s*(?:(?:\\\"(?<url>[^\\\"]*)\\\")|(?<url>[^\\s]* ))";;
let urlRegex = new Regex(urlPat)
let matches = 
    urlRegex.Matches(http("http://www.google.com"))

let matchToUrl (urlMatch : Match) = urlMatch.Value
let urls = List.map matchToUrl matches 
```

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-20T03:18:18.797

你会这样写最后一行：

```
let urls = Seq.map matchToUrl (Seq.cast matches);; 
```

这可以使用流水线操作符以更好的方式编写：

```
let urls = matches|> Seq.cast |> Seq.map matchToUrl;; 
```

F# 会自动找出正确的目标类型（因为它知道是什么`matchToUrl`样的）。这仅适用于 Seq，因此您可以使用`List.of_seq`它再次将数据放入列表中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T21:41:18.650

Seq.cast 是您想要的吗？

# c# - 通用方法可以同时处理引用和可空值类型吗？

> ID：303287
> 
> 赞同：13
> 
> 时间：2008-11-19T20:40:28.820
> 
> 标签：c#, .net, generics

我有一系列扩展方法来帮助对 IDataRecord 对象进行空检查，我目前正在这样实现：

```
public static int? GetNullableInt32(this IDataRecord dr, int ordinal)
{
    int? nullInt = null;
    return dr.IsDBNull(ordinal) ? nullInt : dr.GetInt32(ordinal);
}

public static int? GetNullableInt32(this IDataRecord dr, string fieldname)
{
    int ordinal = dr.GetOrdinal(fieldname);
    return dr.GetNullableInt32(ordinal);
} 
```

等等，对于我需要处理的每种类型。

我想将这些重新实现为通用方法，部分是为了减少冗余，部分是为了学习如何编写通用方法。

我写了这个：

```
public static Nullable<T> GetNullable<T>(this IDataRecord dr, int ordinal)
{
    Nullable<T> nullValue = null;
    return dr.IsDBNull(ordinal) ? nullValue : (Nullable<T>) dr.GetValue(ordinal);
} 
```

只要 T 是值类型，它就可以工作，但如果 T 是引用类型，它就不会。

如果 T 是值类型，则此方法需要返回 Nullable 类型，否则返回 default(T)。我将如何实现这种行为？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-19T20:51:40.963

您可以像这样声明您的方法：

```
public static T GetNullable<T>(this IDataRecord dr, int ordinal)
{
    return dr.IsDBNull(ordinal) ? default(T) : (T) dr.GetValue(ordinal);
} 
```

这样，如果 T 是可为 null 的 int 或任何其他可为 null 的值类型，它实际上将返回 null。如果它是常规数据类型，它将只返回该类型的默认值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T21:14:52.603

这有效：

```
public static T Get<T>( this IDataRecord dr, int ordinal) 
{
    T  nullValue = default(T);
    return dr.IsDBNull(ordinal) ? nullValue : (T) dr.GetValue(ordinal);
}

public void Code(params string[] args)
{
    IDataRecord dr= null;
    int? a = Get<int?>(dr, 1);
    string b = Get<string>(dr, 2);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T20:56:05.650

我不认为你可以用一个函数来实现它。如果 C# 支持基于返回类型的重载，您也许可以，但即便如此，我还是建议不要这样做。

正如BFree所[建议](https://stackoverflow.com/questions/303287/can-a-generic-method-handle-both-reference-and-nullable-value-types#303321)的那样，您应该能够通过不使用可为空的数据类型并返回实际值或 null 来完成同样的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-14T10:04:40.990

我不明白为什么需要过度复杂化整个过程。为什么不让它保持简洁，并使用以下代码行：

对于 null 有效的值类型，请使用`int? iNullable = dr[ordinal] as int?;`.

对于 null 无效的值类型，请使用`int iNonNullable = dr[ordinal] as int? ?? default(int);`.

对于引用类型，请使用`string sValue = dr[ordinal] as string;`.

对于任何认为代码不起作用并且`dr[ordinal]`会为 DBNull 引发异常的人，这里有一个示例方法，一旦给出有效的连接字符串，就可以证明这个概念。

```
private void Test()
{
  int? iTestA;
  int? iTestB;
  int iTestC;
  string sTestA;
  string sTestB;

  //Create connection
  using (SqlConnection oConnection = new SqlConnection(@""))
  {
    //Open connection
    oConnection.Open();

    //Create command
    using (SqlCommand oCommand = oConnection.CreateCommand())
    {
      //Set command text
      oCommand.CommandText = "SELECT null, 1, null, null, '1'";

      //Create reader
      using (SqlDataReader oReader = oCommand.ExecuteReader())
      {
        //Read the data
        oReader.Read();

        //Set the values
        iTestA = oReader[0] as int?;
        iTestB = oReader[1] as int?;
        iTestC = oReader[2] as int? ?? -1;
        sTestA = oReader[3] as string;
        sTestB = oReader[4] as string;
      }
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T23:20:35.157

你不能用一种方法做到这一点，但你可以用三种方法做到这一点：

```
public static T GetData<T>(this IDataReader reader, Func<int, T> getFunc, int index)
{
    if (!reader.IsClosed)
    {
        return getFunc(index);
    }
    throw new ArgumentException("Reader is closed.", "reader");
}

public static T GetDataNullableRef<T>(this IDataReader reader, Func<int, T> getFunc, int index) where T : class
{
    if (!reader.IsClosed)
    {
        return reader.IsDBNull(index) ? null : getFunc(index);
    }
    throw new ArgumentException("Reader is closed.", "reader");
}

public static T? GetDataNullableValue<T>(this IDataReader reader, Func<int, T> getFunc, int index) where T : struct
{
    if (!reader.IsClosed)
    {
        return reader.IsDBNull(index) ? (T?)null : getFunc(index);
    }
    throw new ArgumentException("Reader is closed.", "reader");
} 
```

然后使用它你会做：

```
private static Whatever CreateObject(IDataReader reader)
{
    Int32? id = reader.GetDataNullableValue<Int32>(reader.GetInt32, 0);
    string name = reader.GetDataNullableRef<string>(reader.GetString, 1);
    Int32 x = reader.GetData<Int32>(reader.GetInt32, 2);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-26T00:00:45.297

```
public static T Get<T>(this IDataRecord rec, Func<int, T> GetValue, int ordinal)
{
    return rec.IsDBNull(ordinal) ? default(T) : GetValue(ordinal);
} 
```

或更高性能

```
public static T Get<T>(this IDataRecord rec, Func<IDataRecord, int, T> GetValue, int ordinal)
{
    return rec.IsDBNull(ordinal) ? default(T) : GetValue(rec, ordinal);
}

public static Func<IDataRecord, int, int> GetInt32 = (rec, i) => rec.GetInt32(i);
public static Func<IDataRecord, int, bool> GetBool = (rec, i) => rec.GetBoolean(i);
public static Func<IDataRecord, int, string> GetString = (rec, i) => rec.GetString(i); 
```

并像这样使用它

```
rec.Get(GetString, index);
rec.Get(GetInt32, index); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-19T20:47:08.587

Nullable 结构仅适用于值类型，因为无论如何引用类型都可以为空......

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-11-19T20:46:47.260

我这样做：

```
DataRow record = GetSomeRecord();
int? someNumber = record[15] as int?
Guid? someUID = record["MyPrimaryKey"] as Guid?;
string someText = GetSomeText();
record["Description"] = someText.ToDbString();

// ........

public static class StringExtensionHelper {
    public static object ToDbString( this string text ) {
         object ret = null != text ? text : DBNull.Value
         return ret;
    }
} 
```

**编辑：** 您可以（或者您应该）为其他原始类型提供“ToDbInt32、ToDbBool 等...”扩展方法。

**编辑 2：** 您还可以使用“ToDbValue”扩展基类“对象”。

```
public static class StringExtensionHelper {
    public static object ToDbValue( this object value ) {
         object ret = object.ReferenceEquals( value, null ) ? (object)DBNull.Value : value;
         return ret;
    }
} 
```

# css - ASP.Net LinkBut ton CSS 适配器

> ID：303314
> 
> 赞同：1
> 
> 时间：2008-11-19T20:48:02.640
> 
> 标签：css, asp.net-2.0

有谁知道用于 ASP.Net 2 的 LinkBut​​ton 控件的 CSS 适配器？

**更新：**

我们正在尝试使用 CSS 按钮。我们正在使用这种方法：[http](http://www.oscaralexander.com/tutorials/how-to-make-sexy-buttons-with-css.html) ://www.oscaralexander.com/tutorials/how-to-make-sexy-buttons-with-css.html为此，我们需要呈现链接按钮不做的标签。

**使用适配器的可能解决方案**

我们为链接按钮创建了一个适配器。然后将 RenderContents 更改如下：

```
 protected override void Render(HtmlTextWriter writer) {

    LinkButton linkButton = this.Control;

    linkButton.Text = String.Concat("<span>", linkButton.Text, "</span>");

    base.Render(writer);
  } 
```

这似乎有效并且需要最少的努力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T00:00:32.877

[创建一个**Web 控件**](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.aspx)，它将继承[`LinkButton`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.aspx)并仅**覆盖**该`RenderContents`方法。

它非常简单，您不必复制任何代码或重新实现任何功能。当然，使用 .NET Framework 源代码查看原始实现会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T20:49:36.943

我不认为 LinkBut​​ton 控件的输出对 CSS 更友好。它是一个纯 HTML 锚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T21:47:04.393

您可以使用用户控件或自定义控件轻松完成此操作以呈现

```
<a...><span>[text]</span></a> 
```

或者 - 您可以使用 jQuery 查找所有锚点（可能具有给定的类）并为您插入跨度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-05T02:45:43.563

使用适配器的可能解决方案

我们为链接按钮创建了一个适配器。然后将 RenderContents 更改如下：

```
 protected override void Render(HtmlTextWriter writer) {

    LinkButton linkButton = this.Control;

    linkButton.Text = String.Concat("<span>", linkButton.Text, "</span>");

    base.Render(writer);
  } 
```

这似乎有效并且需要最少的努力。

# sql-server - 确定性标量函数

> ID：303318
> 
> 赞同：0
> 
> 时间：2008-11-19T20:49:50.860
> 
> 标签：sql-server, ssms

我想在我的数据库表中索引一个计算列，它使用许多用户定义的函数。但是我刚刚了解到我的专栏是不确定的。

如果没有索引，它会降低运行我需要的查询的速度。

跟踪用户定义函数以确定它们是否具有确定性的最佳方法是什么？

SQL Server Management Studio 中是否有任何工具可以告诉我用户定义的函数是否是确定性的，或者我只需要跟踪我正在使用的所有系统定义的函数来找出哪些是非确定性的并找到在没有它们的情况下编写我的代码的其他方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T21:08:14.363

尝试：

```
SELECT  *
FROM    INFORMATION_SCHEMA.ROUTINES
WHERE   IS_DETERMINISTIC = 'NO'
        AND ROUTINE_TYPE = 'FUNCTION' 
```

或者

```
SELECT OBJECTPROPERTY(OBJECT_ID('schemaname.functionname'), 'IsDeterministic') 
```

抱歉，IIRC，SQL Server 2000 不允许非确定性 UDF。

索引一个不确定的列是非常愚蠢的——毕竟如果它的值不严格依赖于参数，那么如果它随意改变你就不会很有用，特别是如果它被用于索引找东西！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T21:13:08.503

既然您说您正在使用许多用户定义的函数，那么您是否尝试过分别为每个函数创建一个基于函数的索引？这至少应该缩小范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T12:07:34.827

我弄清楚了为什么我的函数是不确定的。它依赖于具有样式代码 1、3 以及其他大于 100 的 Convert 语句。

根据 msdn 转换为：

确定性，除非存在以下条件之一：

源类型是 sql_variant。

目标类型是 sql_variant，其源类型是不确定的。

源或目标类型为 datetime 或 smalldatetime，其他源或目标类型为字符串，并指定了非确定性样式。为了具有确定性，样式参数必须是常数。此外，小于或等于 100 的样式是不确定的，除了样式 20 和 21。大于 100 的样式是确定的，除了样式 106、107、109 和 113。

# sql-server - 压缩文件夹中的 SQL 备份

> ID：303324
> 
> 赞同：2
> 
> 时间：2008-11-19T20:52:07.453
> 
> 标签：sql-server, sql-server-2005, backup

我们正在寻找一种免费的解决方案来为 SQL Server 2005 压缩我们的 SQL Server 备份。我知道 SQL Safe 免费软件版本，但我想知道其他人如何将备份文件存储在压缩文件夹中以达到预期的效果。这将允许我们使用本机 SQL 备份任务和本机 windows 压缩，从而消除对第三方产品的需求。

我过去没有使用压缩文件夹。这是一个可行的想法吗？压缩文件夹中备份的完整性是否存在任何可预见的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-24T01:06:30.210

我是一个开源项目 (GPL v3) 的作者，它可以满足您的需求。它是一个命令行工具（用于在 Windows 中的计划任务中进行计划）并备份到 gzip、zip（特别是 zip64，因为常规 zip 文件的 4GB 限制）或 bzip2 文件。您可以使用该工具直接从压缩文件中恢复，也可以解压缩压缩文件（标准 *.bak 文件），然后使用 SQL Server GUI 进行恢复。

它称为 SQL Server 压缩备份，可在此处找到：http: [//sourceforge.net/projects/mssqlcompressed/](http://sourceforge.net/projects/mssqlcompressed/)

一个示例命令是：

```
msbp.exe backup "db(database=model)" "zip64" "local(path=c:\model.full.bak.zip)" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T21:02:51.677

来自谷歌的快速提示：[backing-up-to-a-ntf​​s-compressed-folder](http://clay.lenharts.net/blog/2008/01/28/backing-up-to-a-ntfs-compressed-folder/)。似乎数据库大小可能会产生问题。

那么免费软件解决方案怎么样，那么您可以在备份后按计划批处理运行 7zip，应该正确处理大文件。无论如何，您都应该将备份移出*生产*服务器:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-23T05:20:47.363

我使用[Syncback Freeware](http://www.2brightsparks.com/downloads.html#freeware)自动将文件复制并压缩到另一个文件夹。这样可以节省大量空间。我已经这样做了好几年了，而且效果很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T21:54:08.340

我们在 ISP 的服务器上拥有大约 100 个数据库

ISP 对磁带进行了全面的备份，但它们需要很长时间才能恢复任何东西……所以我们需要将备份“在线”保持一段合理的时间，这样我们才能首先从它们中恢复。

我们每周进行一次完整备份，每天进行一次差异备份。我们将完整备份保留一个月，差异备份保留 7 天我们每 10 分钟生成一次 TLog 备份，但仅将它们（在线）存储两天。

所以我们可以恢复到前 2 天的时间点，最后 7 天的“午夜”，以及最后 4 周的“前星期日”。

差异备份的使用减少了我们备份的总大小，并使我们能够保持更多的在线“经过时间”。

所有备份都存储在 NTFS 压缩文件夹中。我们从来没有遇到过问题，但我认为这些“共享数据库服务器”上没有任何大于 30GB 的数据库

在数据库维护期间（索引碎片整理等），我们将 TLog 备份的频率增加到每分钟。我们发现扩展数据库大小的一件事是数据库维护，因此通过这样做，我们能够减少数据库的操作大小，从而释放一些磁盘空间以进行更多备份。（通常在不同的驱动器上备份到 MDF 或 LDF，但批量操作会将旧的、陈旧的备份文件复制到包含 MDF / LDF 的驱动器，这样我们就可以让它们保持“在线”）

PS SQL 2008 具有内置的压缩​​备份功能，以防您打算升级

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T19:28:44.150

虽然我不建议直接备份到压缩文件夹，但您当然可以备份到普通文件夹，然后在服务器不太忙时使用 PowerShell 脚本单独压缩每个文件。这是我使用的一个片段。它基本上通过备份目录递归，使用NTFS压缩压缩每个文件，直到一定大小。这不是最好的解决方案；我的首选解决方案是在执行升级时使用 SQL 2008/2012 备份压缩。

```
$max_compressible_size = 10*1024*1024*1024 #10 gigs 

$files = Get-ChildItem -recurse | where {$_.Extension -match "(trn)|(diff)|(bak)"}

foreach ($file in $files) {    
    $attr = (Get-ItemProperty $file.fullname).Attributes

    if ($attr.ToString() -notmatch ".*Compressed.*" -and $file.Length -le $max_compressible_size) {
        write-output $file.FullName
        compact /C $file.FullName
    }
} 
```

# automation - 如何以编程方式从服务中打开 InfoPath 2007 文件？

> ID：303325
> 
> 赞同：0
> 
> 时间：2008-11-19T20:52:15.427
> 
> 标签：automation, infopath

我正在尝试从 Windows 服务以编程方式打开 InfoPath 2007 文件，但出现以下错误：

> System.Runtime.InteropServices.COMException (0x80043000)：InfoPath 无法打开以下文件：C:\path\datafile.xml。没有足够的存储空间来完成此操作。

此文件在 InfoPath 设计器中正确打开。它还以编程方式作为 WinForms 应用程序运行。但是，当您尝试作为 Windows 服务运行时，它就会崩溃。

我咨询了强大的谷歌。返回的两个主要结果要么是格式错误的 XML（不是原因，因为表单可以手动正确打开），要么与尝试访问数据库有关（我没有这样做）。

有谁知道如何做到这一点？我需要在服务上设置权限吗？

更新：

根据安德斯的要求，这是代码。请注意，这可能不是我 6 个月前最初发布问题时使用的确切代码。从那以后，我们开始使用 XtraReports，因为它似乎更容易使用并且这些隐秘错误更少。但是，我想为其他出现并可能需要答案的人解决这个问题。

```
Microsoft.Office.Interop.InfoPath.Application infoApp = new Microsoft.Office.Interop.InfoPath.Application();
try
{
    Microsoft.Office.Interop.InfoPath.XDocument xDoc = null;
    xDoc = infoApp.XDocuments.Open(fileName, (int)Microsoft.Office.Interop.InfoPath.XdDocumentVersionMode.xdUseExistingVersion);

    xDoc.PrintOut();
    infoApp.XDocuments.Close(0);
}
catch (Exception ex)
{
    //handle error here
}
finally
{
    try
    {
        if (infoApp != null)
            infoApp.Quit(false);
    }
    catch { }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-29T10:37:19.873

[这对我们有用](https://stackoverflow.com/questions/863864/excel-2007-automation-on-top-of-a-windows-server-2008-x64)

# web - 转移网站

> ID：303336
> 
> 赞同：-2
> 
> 时间：2008-11-19T20:56:07.617
> 
> 标签：web, hosting

我对站点进行了一些更改，并且需要重新托管它，因为当前主机已不复存在。我的客户从当前主机收到以下信息：

“最好告诉他们的是，由于我们将完全撤销我们的服务，我们希望将网站地址完全转移给他们，而不是仅仅将网址“指向”他们。如果你能将此电子邮件转发给他们并要求他们确认他们的“IPS 标签”（他们会知道那是什么），然后我可以安排在他们确认一切准备就绪时将其转移。”

任何人都可以在这里帮助我，因为我不太确定他们的意思，也不知道 IPS 标签是什么？?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T21:00:30.480

IPSTAG 是域名注册商的唯一 .uk 名称。基本上，虚拟主机要求您将域名注册从他们那里转移到新的提供商。

我建议您（或您的客户）找到一个新的注册商，获取他们的 IPSTAG，然后将其发送给您的旧主机，然后他们将能够启动更改。

一旦 IPSTAG 更新（您可以检查 WHOIS 信息），那么您的新注册商将能够获得域名（因此旧主机将放弃对它的“控制”）

这是来自 amazon.co.uk 的 WHOIS 的示例：

```
Domain name:
    amazon.co.uk

Registrant:
    Amazon Europe Holding Technologies SCS

Registrant type:
    Unknown

Registrant's address:
    65 boulevard G-D. Charlotte
    Luxembourg City
    Luxembourg
    LU-1311
    LU

Registrar:
    Amazon.com [Tag = AMAZON-COM] 
```

在这种情况下，IPSTAG 是“AMAZON-COM”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T21:01:39.197

一个快速的谷歌搜索出现了

> 每个域名注册代理都由英国域名管理机构 Nominet 分配的唯一 IPSTAG 标识。如果您想将英国域名转移到另一个互联网服务提供商，您需要知道您的新 ISP 的标签名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T21:01:45.390

查看此[链接](http://transferdomains.co.uk/index.php?cat=26)以了解 IPS 标签是什么。它本质上是您的域注册代理的标识符。去引用：

> IPS TAG 允许 Nominet 管理其自动域名注册系统和相关服务的使用。IPS-TAG 是一个独特的字母和/或数字序列。您需要能够告诉 Nominet 您的注册代理的标签才能更改您的注册代理。

# javascript - 检索文档列表时的 Web 缓存

> ID：303338
> 
> 赞同：0
> 
> 时间：2008-11-19T20:56:36.367
> 
> 标签：javascript, caching, etag

我们需要利用客户端资源来获取包含任务的列表。

客户需要：

*   收到列表更新通知
*   能够重新排序/过滤列表（请求服务器更新客户端不知道/缓存中的任务）

问题出现在初始加载或大型列表更新（从“分配给我的任务”更改为“关于 x 的任务”）

最快的做法是将所有任务返回到一个列表中，而不是单个（10+）个请求。

但是当我请求更新列表中的任务时，电子标签将无济于事，因为它不是单独下载的。

是否有某种方法可以让浏览器根据它们各自的 url 缓存列表中的项目？

或者创建一个可以在导航中幸存下来的 javascript 缓存的方法？

*   如果我离开并转到任务 url，我的 js 对象会存活吗？我怀疑没有。
*   如果我离开，然后回击，我的 javascript 对象会存活吗？我怀疑是的。
    *   如果是这样，是否有可能有一个“任务列表加载”页面来检查历史记录并返回到现有的任务列表？我认为没有 - 安全。

我想我只需要接受初始加载命中并单独检索任务，以便以后的请求很快（并减轻服务器的负载）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T01:06:47.260

HTML5 距离实现还有一段距离，但您或许可以使用[Google Gears](http://gears.google.com)来满足您的本地存储需求。

另外，我不知道我们正在谈论多少并发客户端和任务，任务有多大以及这样的请求可能会给数据库带来多大的压力，但我认为你应该能够在没有任何问题的情况下顺利运行缓存，10+ 个请求似乎并不多。如果流量不是瓶颈，我会将缓存放在服务器上并使客户端保持“哑”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T20:11:04.650

在 HTML5 中，有[Window.sessionStorage](https://stackoverflow.com/questions/304086/is-there-a-secure-browser-cache)属性能够针对选项卡/窗口中的特定会话存储内容（其他窗口将有自己的存储，即使针对同一会话运行时也是如此）。

规范中还提供了 localStorage 和数据库存储选项。

# c# - C# Process.Start，如何防止重复使用现有应用程序？

> ID：303339
> 
> 赞同：5
> 
> 时间：2008-11-19T20:56:57.427
> 
> 标签：c#, winforms

我在一个程序中编写一个功能，用户可以编辑存储在数据库中的文档，它将文档保存到一个临时文件夹，然后使用 Process.Start 将文档启动到编辑应用程序中，例如 Microsoft Word。

然后我的应用程序需要等到他们关闭被调用的进程并将数据库中的文档替换为临时文件夹中新编辑的副本。

只要被调用的应用程序尚未运行，以下代码就可以很好地工作：

```
ProcessStartInfo pInfo = new ProcessStartInfo();
pInfo.FileName=TempFolder + Path.DirectorySeparatorChar + f.Name;
Process p = new Process();
p.StartInfo = pInfo;
p.Start();
//p is null at this point if called application was already running
//i.e. Microsoft Word is re-used instead of starting a fresh copy
p.WaitForInputIdle();
p.WaitForExit(); 
```

有没有办法*强制*启动一个全新的过程，或者任何人都可以想到另一种方法来处理这个问题。我真的不希望用户能够在我的应用程序中执行任何其他操作，直到他们关闭被调用的进程，因为我需要知道他们是否在那个时间点编辑了该文件，而不是稍后当各种其他问题可能会蔓延。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T16:32:59.957

就个人而言，我不确定我是否完全同意这种方法。显示模态表单可能会让你摆脱这种情况，但在大多数情况下，当解决方案似乎很难找到时，改变你试图解决的问题会很有帮助。

**选项1：**

在这种情况下，我建议使用结帐/签入模型。这将允许用户将文件“签出”到他们的机器，然后在完成更新后签入。这有很多好处：

*   他们可以一次编辑多个文档，并一次对多个文档执行签入操作。
*   他们可以将评论应用于签到。
*   用户可以关闭他们的 PC，或者离线并继续处理他们的文档。
*   用户可以在本地签出多个文档，然后将工作带回家。
*   如果文档打开时 PC 崩溃（或笔记本电脑电池耗尽），您不必尝试找出该怎么做，以及如何将它们重新组合在一起。

该模型还非常适合创建新文档并将其添加到数据库的概念。这和签到是一样的。

您可以轻松地提供报告，显示谁签出了哪些文档，以及他们的“工作副本”位置是什么。

我承认，通常只有开发人员对这种模型感到满意，并且您可能需要投资进行少量的再培训。我认为设置一个自动提醒系统并不难，该系统会在人们签出文件很长时间时向他们发送电子邮件。

**选项 2：**

使用 FileSystemWatcher 或等效工具监视文件。这将使您能够密切关注文件，并且当用户执行保存操作时，您可以提交到数据库。毕竟，只有当用户实际保存了您对更新数据库感兴趣的文件时，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T21:00:13.520

我不确定是否要开始一个新进程，但是您是否考虑过这种等待退出的逻辑：

而 (Process.IsRunning) {}

基本上只是一个持有人循环，直到您的过程完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T21:02:16.153

是的，订阅流程的退出事件并将 process.EnableRisingEvents 属性设置为 true。然后让您的应用程序什么都不做，直到 Exited 事件被触发！

关于强制使用新进程，我认为这是默认行为，我认为这取决于您调用的进程是否允许同时运行多个实例，这是您无法控制的。 。很遗憾。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T21:30:37.627

我认为您使用错误的方法来解决问题。如果您只处理文字文档，我相信您应该使用 COM 互操作来从您的应用程序中输入和控制文字。使用 COM，您可以在 word 中控制所有内容，您将能够在 word 中打开文档，并且您会知道用户何时关闭它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T22:28:20.973

在进一步研究并遇到一些提到 WaitForExit 的不可靠性和进程退出事件的帖子后，我想出了一个完全不同的解决方案：我启动进程并且不费心等待它，只需弹出一个当用户编辑并保存临时文件或取消时，用户可以在模式对话框中单击更新将临时文件夹文件更新回数据库。

这样它就在他们手中，我不必依赖 Process.Start 的变幻莫测。

感谢大家的帮助。

# c# - C#、For 循环和速度测试... 完全相同的循环第二次更快？

> ID：303343
> 
> 赞同：4
> 
> 时间：2008-11-19T20:58:36.473
> 
> 标签：c#, arrays, foreach, for-loop, loops

```
public Int64 ReturnDifferenceA()
{
  User[] arrayList;
  Int64 firstTicks;
  IList<User> userList;
  Int64 secondTicks;
  System.Diagnostics.Stopwatch watch;

  userList = Enumerable
              .Range(0, 1000)
              .Select(currentItem => new User()).ToList();

  arrayList = userList.ToArray();

  watch = new Stopwatch();
  watch.Start();

  for (Int32 loopCounter = 0; loopCounter < arrayList.Count(); loopCounter++)
  {
     DoThings(arrayList[loopCounter]);
  }

  watch.Stop();
  firstTicks = watch.ElapsedTicks;

  watch.Reset();
  watch.Start();
  for (Int32 loopCounter = 0; loopCounter < arrayList.Count(); loopCounter++)
  {
     DoThings(arrayList[loopCounter]);
  }
  watch.Stop();
  secondTicks = watch.ElapsedTicks;

  return firstTicks - secondTicks;
} 
```

如您所见，这非常简单。创建用户列表，强制到数组，启动手表，循环列表并调用方法，停止手表。重复。通过返回第一次运行和第二次运行的差异来完成。

现在我打电话给这些：

```
differenceList = Enumerable
                 .Range(0, 50)
                 .Select(currentItem => ReturnDifferenceA()).ToList();
average = differenceList.Average();

differenceListA = Enumerable
                  .Range(0, 50)
                  .Select(currentItem => ReturnDifferenceA()).ToList();
averageA = differenceListA.Average();

differenceListB = Enumerable
                  .Range(0, 50)
                  .Select(currentItem => ReturnDifferenceA()).ToList();
averageB = differenceListB.Average(); 
```

现在有趣的部分是所有的平均值都是相对较大的正数，范围从 150k 到 300k 刻度。

我没有得到的是，我正在通过相同的列表，相同的方式，相同的方法，但有这样的差异。是否正在进行某种缓存？

另一个有趣的事情是，如果我在第一个秒表部分之前遍历列表，平均值约为 5k 左右。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T21:03:31.330

您正在使用具有执行大量缓存和性能优化的运行时环境的高级语言运行，这很常见。有时称为预热虚拟机或预热服务器（当它是生产应用程序时）。

如果要重复执行某件事，那么您会经常注意到第一次的测量运行时间较长，而其余时间应该趋于平稳。

我在 MATLAB 代码中执行此操作，并看到我第一次运行基准循环时需要五秒钟，随后的时间需要五分之一秒。这是一个巨大的差异，因为它是一种解释性语言，需要某种形式的编译，但实际上，它不会影响您的性能，因为在任何生产应用程序中绝大多数将是“第二次”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T21:07:18.157

顺便说一句，在 Array 上使用 IEnumerable.Count() 比 Array.Length 慢数百倍......尽管这根本不能回答问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T21:04:42.810

DoThings() 很可能在第一次被调用之前没有被 JIT 编译为本机代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-06T22:30:32.120

因为 .NET 与 Java 平台一样，是一个 JIT 环境。所有高级 .NET 代码都编译为 Microsoft 的中间语言字节码。

为了运行你的程序，这个字节码需要被编译/翻译成本地机器码。但是，已编译的 .NET 程序文件不存储在本机机器代码中，而是存储在中间虚拟机字节码中。

第一次运行是 JIT 编译的，所以需要额外的时间。后续运行不再需要 JIT 编译，而是从 JIT 缓存中提取本机代码，因此应该更快。

您是否在不终止后续运行的情况下保持应用程序正常运行？那么，第二个原因也是由于VM。（VM:1 = 虚拟机；VM:2 = 虚拟内存）。所有现代通用操作系统都在虚拟内存上运行它们的进程，虚拟内存是真实内存的映射，以使操作系统能够管理和优化系统资源的使用。较少使用的进程经常被清扫到磁盘缓存中，以使其他进程能够最佳地使用资源。

您的进程第一次不在虚拟内存中，因此它必须承受被扫入内存的开销。因为随后，您的进程是最近使用的顶级列表之一（也就是最近最少使用列表的底部），它还没有被扫入磁盘缓存。

此外，操作系统会根据需要将资源分配给您的进程。因此，在第一轮中，您的进程必须经历与操作系统竞争信封以扩展其资源边界的痛苦。

虚拟机允许 .NET 和 Java 将大多数编程特性抽象到与机器无关的层中，从而将依赖于机器的软件工程师进行分离，从而留下较小的混乱。尽管 Microsoft Windows 运行在相当统一的 x86 后代硬件上，但不同的操作系统版本和 CPU 模型存在足够的差异，以保证抽象的虚拟机为 .NET 程序员和用户提供一致的视图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T21:40:27.810

你说你不明白这样做 3 次，第 2 次和第 3 次比较接近。在我看来，这只是第一次通过循环，事情很慢。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T21:54:23.520

我怀疑您调用的函数在第一次运行之前不是 Just-In-Timed 。您可以尝试运行一次，然后停止并再次运行。在没有代码更改的情况下，上一次运行的即时编译应该仍然可以，您看到的任何剩余优化都是*实际*的缓存效果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-06T22:37:46.740

暂时不考虑预热 VM 或机器、缓存和 JIT 优化的问题：您的计算机还在做什么？是否有任何 3e42 系统服务和任务托盘东西占用了一些 CPU？也许您的 Steam 客户端决定检查更新，或者 IE 需要做一些非常重要的事情，或者您的防病毒程序妨碍了您？

您的测试仅与您可以将其与您的机器上运行的所有其他软件隔离的程度一样有用。在尝试测量跑步之前，尽可能关闭所有软件。

但那我知道什么呢？- 也许您的测量方法也由.net（或其他）运行时管理，并且仅考虑运行时“虚拟周期”。

# linux - 如何设置被调试进程的当前目录？

> ID：303350
> 
> 赞同：6
> 
> 时间：2008-11-19T21:01:08.170
> 
> 标签：linux, debugging, totalview

我有一个对调用它的目录很敏感的应用程序——它使用相对路径加载一些文件。

当我通过调试器启动程序时，如何控制初始当前目录是什么？

我宁愿避免向调试程序添加特殊代码以使其调用`chdir`；我的直觉是调试器应该提供某种方式来从外部指定它，因为它本质上是一个外部设置。

我使用的调试器是 TotalView，但我愿意接受其他 Linux 调试器的答案，因为它可以帮助我在 TV 中找到类似的设置。我可以在调用程序时指定环境变量，所以在云雀上，我尝试了设置`PWD`，但没有运气。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T21:13:56.613

对于 GDB，初始工作目录是您从中实例化 GDB 的目录。因此，只需从您想要的工作目录中运行 GDB。或者，在程序运行时，您只需执行以下操作即可更改当前工作目录：

```
(gdb) print chdir("new/working/directory") 
```

GDB 还有一个内置命令，用于从 GDB 提示符更改进程的工作目录：

```
(gdb) cd new/working/directory 
```

我从未使用过 TotalView，但它应该具有类似的功能，可以在调试器中执行代码（有副作用）。

# maven-2 - 什么工具相当于 TFS（或 MS-land）中的 Maven？

> ID：303357
> 
> 赞同：11
> 
> 时间：2008-11-19T21:02:55.763
> 
> 标签：maven-2, tfs, msbuild

我的公司正在从 svn（和开源产品）转向 TFS（和 MS 产品）。我们过去使用 maven 将预构建的组件打包成可发布的包。TFS 或 MS-Land 中是否有像 maven 一样强大的工具来执行此操作？

我看过 msbuild，但它似乎不如 Maven 强大。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T06:35:25.390

在官方 TFS/Microsoft 堆栈中，[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)是构建语言。然而，这更像是[Ant](http://ant.apache.org/)（或[Nant](http://nant.sourceforge.net/)）而不是[Maven](http://maven.apache.org/) - 即它是一种基于 XML 的脚本语言，专为软件构建而设计，而不是使用 Maven 的“约定优于配置”方法。MSBuild 没有 Maven 非常独特的依赖管理功能。

Team Foundation Build 基于 MSBuild，但是它在预定义的目标中建立了一个活动框架（类似于 Maven 中的目标）。这些活动涵盖诸如生成内部版本号、标记代码、下载代码、构建定义的解决方案、运行单元测试、将结果发布回 TFS 以及将构建结果复制到网络共享以供以后部署等项目. 您可以在 Visual Studio UI 中轻松创建新的 Team Foundation Build，然后通过编辑为您创建的 TFSBuild.proj 文件覆盖在默认构建过程中调用的许多各种预定义挂钩中的一些来自定义它。建造。在某些方面，您可以认为 TFSBuild.proj 文件有点像 Maven POM 文件 - 但它们非常不同。

Team Foundation Build 2008 中的构建系统是一个不错的系统——尽管它非常受 XML 驱动。但是，如果您对 Maven 配置感到满意，那么您将对 Team Foundation Build 基于 XML 的配置感到满意。TFS Build 提供诸如构建调度、持续集成、构建保留管理等功能。您还可以使用我工作的公司 ( [Teamprise](http://www.teamprise.com/) )提供的免费（和开源）[构建扩展](http://www.teamprise.com/products/build)轻松调用现有的 Ant 构建。

有趣的是，我们目前实际上正在研究 Maven2 与 Team Foundation Build 的集成。我们开发了一个与 TFS 对话的 Maven2 SCM 提供程序，我们目前正在开发 Team Build Extension，以允许您从 Team Foundation Build 轻松调用 Maven2 构建。如果您想在构建中坚持使用 Maven 并在可用时测试我们的 Maven 集成，请给我写信 (martin@teamprise.com)。

我很想知道您是否使用 Maven 来构建 .NET 或 Java 项目（或其他东西或所有东西的组合）

希望有帮助，

马丁。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-11T00:29:08.747

没有什么像它，MSBuild 不像 Maven，MSBuild 像 Ant。当然，如果 Ivy 可以使 Ant 更“类似 Maven”，那么有人可以创建类似 Ivy 的东西，但要使用 MSBuild 并使其更“类似 Maven”。

曾尝试创建一个名为[NMaven](http://incubator.apache.org/nmaven/)的类似 maven 的东西，但它现在是一个死项目。其他尝试是**Npanday**和**Byldan**。但我不确定这两个项目的状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T21:07:59.963

您将需要查看[Team Build](http://msdn.microsoft.com/en-us/library/ms181710(VS.80).aspx)，它是 TFS 和[MsBuild](http://en.wikipedia.org/wiki/MSBuild)的一部分，Team Build 使用它来自动化构建过程。将这两者结合在一起，您可以创建一个非常好的构建自动化过程来生成 iso 映像、文档和运行单元测试。

# c# - 在 PropertyGrids 中是否有更好的 StringCollection 编辑器？

> ID：303360
> 
> 赞同：4
> 
> 时间：2008-11-19T21:04:15.917
> 
> 标签：c#, .net, python, editor, propertygrid

我在我的应用程序框架的配置编辑器中大量使用了 PropertySheets。我非常喜欢它们，因为与它们一起工作很容易（一旦你学会了）并使编辑防弹。

我在配置中存储的其中一件事是 Python 脚本。可以在 StringCollection 编辑器中编辑 Python 脚本，这是我一直在使用的，但“可能”和“可用”之间还有很长的距离。我想要一个真正支持可调整大小和等宽字体的编辑器，保留空白行，并且 - 嘿，让我们为愿望清单发疯 - 进行语法着色。

如果我真的需要，我当然可以写这个，但我不想这样做。

我在谷歌上四处寻找，找不到像我描述的那样的东西，所以我想我会在这里问。这是一个已解决的问题吗？有没有人已经尝试过构建更好的编辑器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-26T20:35:17.607

您可以按照这些简单的步骤轻松创建自己的字符串集合编辑器。*此示例使用 C#。*

1）您必须创建一个编辑器控件并从`System.Drawing.Design.UITypeEditor`. 我打电话给我`StringArrayEditor`的。因此我的课开始于

```
public class StringArrayEditor : System.Drawing.Design.UITypeEditor 
```

`PropertyGrid`控件需要知道编辑器是模态，并且在选择所讨论的属性时将显示椭圆按钮。因此，您必须`GetEditStyle`按如下方式覆盖：

```
 public override UITypeEditorEditStyle GetEditStyle(ITypeDescriptorContext context)
    {
        return UITypeEditorEditStyle.Modal;
    } 
```

最后，编辑器控件必须覆盖该`EditValue`操作，以便当用户单击您的属性的省略号按钮时，它知道您希望如何进行。这是覆盖的完整代码：

```
 public override object EditValue(ITypeDescriptorContext context, IServiceProvider provider, object value)
    {
        var editorService = provider.GetService(typeof(IWindowsFormsEditorService)) as IWindowsFormsEditorService;
        if (editorService != null)
        {
            var selectionControl = new TextArrayPropertyForm((string[])value, "Edit the lines of text", "Label Editor");
            editorService.ShowDialog(selectionControl);
            if (selectionControl.DialogResult == DialogResult.OK)
                value = selectionControl.Value;
        }
        return value ?? new string[] {};
    } 
```

那么发生了什么？当用户单击省略号时，将调用此覆盖。`editorService`设置为我们编辑表单的界面。它设置为我们尚未创建的表单，我称之为`TextArrayPropertyForm`. `TextArrayPropertyForm`被实例化，传递要编辑的值。为了更好地衡量，我还传递了 2 个字符串，一个用于表单标题，另一个用于顶部的标签，解释用户应该做什么。它以模态方式显示，如果单击“确定”按钮，则使用`selectionControl.Value`我们将创建的表单中设置的值更新该值。最后，这个值在覆盖结束时返回。

步骤 2) 创建编辑器表单。在我的例子中，我创建了一个带有 2 个按钮（`buttonOK`和`buttonCancel`）一个标签（`labelInstructions`）和一个文本框（`textValue`）的表单来模仿默认的 StringCollection 编辑器。代码非常简单，但如果你有兴趣，就在这里。

```
using System;
using System.Windows.Forms;

namespace MyNamespace
{
    /// <summary>
    /// Alternate form for editing string arrays in PropertyGrid control
    /// </summary>
    public partial class TextArrayPropertyForm : Form
    {
        public TextArrayPropertyForm(string[] value,
            string instructions = "Enter the strings in the collection (one per line):", string title = "String Collection Editor")
        {
            InitializeComponent();
            Value = value;
            textValue.Text = string.Join("\r\n", value);
            labelInstructions.Text = instructions;
            Text = title;
        }

        public string[] Value;

        private void buttonCancel_Click(object sender, EventArgs e)
        {
            DialogResult = DialogResult.Cancel;
        }

        private void buttonOK_Click(object sender, EventArgs e)
        {
            Value = textValue.Text.Split(new[] { "\r\n" }, StringSplitOptions.None);
            DialogResult = DialogResult.OK;
        }
    }
} 
```

步骤 3) 告诉 PropertyGrid 使用备用编辑器。此属性与 PropertyGrid 控件中使用的任何其他属性之间的更改是 [Editor] 行。

```
 [Description("The name or text to appear on the layout.")]
    [DisplayName("Text"), Browsable(true), Category("Design")]
    [Editor(typeof(StringArrayEditor), typeof(System.Drawing.Design.UITypeEditor))]
    public string[] Text {get; set;} 
```

现在，当您在表单上创建 PropertyGrid 并设置为包含此 Text 属性的类时，它将在您的自定义表单中进行编辑。有无数机会以您选择的方式更改您的自定义表单。通过修改，这将适用于编辑您喜欢的任何类型。重要的是编辑器控件返回的类型与被覆盖的属性相同`EditValue(ITypeDescriptorContext context, IServiceProvider provider, object value)`

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T21:23:46.330

您需要编写自己的类型编辑器。您可以将其视为用户控件，因为当您编写自己的类型编辑器时，您将提供在属性网格编辑属性时出现的 UI 控件。因此，您可以创建一个可以执行任何操作的类型编辑器，这意味着如果您有第三方编辑器控件，您可以将其作为类型编辑器的一部分包含在内。

一些帮助您入门的资源：

*   [用户界面类型编辑器概述](http://msdn.microsoft.com/en-us/library/ms171839.aspx)
*   [演练：实现 UI 类型编辑器](http://msdn.microsoft.com/en-us/library/ms171840.aspx)
*   [UITypeEditor 类](http://msdn.microsoft.com/en-us/library/system.drawing.design.uitypeeditor.aspx)
*   [如何：实现 UI 类型编辑器](http://msdn.microsoft.com/en-us/library/53c49eck.aspx)
*   [使用 UITypeEditors (VB.NET) 进行丰富的设计时编辑](http://www.codeproject.com/KB/miscctrl/UITypeEditorsDemo.aspx)
*   [在 DesignTime 中为 VS.Net 轻松创建属性编辑器（UITypeEditor Helper）](http://www.codeproject.com/KB/cpp/DropDownPropertyEditor.aspx)
*   [使用 PropertyGrid](http://www.codeproject.com/KB/tabs/PropertyGrid.aspx)

# c++ - 在 C++ 中生成 xml 的最简单方法是什么？

> ID：303371
> 
> 赞同：17
> 
> 时间：2008-11-19T21:07:59.323
> 
> 标签：c++, xml, serialization

我使用了 boost 序列化，但这似乎不允许我生成符合特定模式的 xml——它的目的似乎只是为了保持一个类的状态。

平台：linux

你们用什么来生成不解析xml？

到目前为止，我正在走 Foredecker 自己生成它的路线——它不是一个大文档，但我真的不应该在找到一个像样的库来正确生成它时遇到这么多麻烦。

至于提升，我想做的事情是设置节点名称，在我的节点中设置属性，并摆脱它带来的所有额外废话，因为我并不关心必须放置我的文件回到那个班级。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-11-19T23:00:01.890

我最近查看了一组专门用于生成 XML 代码的 XML 库。

执行摘要：我选择使用[TinyXML++](http://code.google.com/p/ticpp/)。

TinyXML++ 具有不错的 C++ 语法，建立在成熟的[TinyXML](http://www.grinninglizard.com/tinyxml/) C 库之上，免费和开源（MIT 许可）且体积小。简而言之，它有助于快速完成工作。这是一个快速的片段：

```
Document doc;
Node* root(doc.InsertEndChild(Element("RootNode")));
Element measurements("measurements");
Element tbr("TotalBytesReceived",  12);
measurements.InsertEndChild(tbr);
root->InsertEndChild(measurements); 
```

产生：

```
<RootNode>
    <measurements>
        <TotalBytesReceived>12</TotalBytesReceived>
    </measurements>
</RootNode> 
```

我已经很满意了。

我审查了许多其他人；这里有一些更好的竞争者：

[Xerces](http://xerces.apache.org/xerces-c/)：国王爸爸。做*所有事情*（尤其是与[Xalan](http://xml.apache.org/xalan-c/)结合使用时），但重量级并强制用户进行内存管理。

[RapidXML](http://rapidxml.sourceforge.net/)：非常适合解析（它是一个原位解析器并且*速度很快*），但不适合生成，因为向 DOM 添加节点需要内存管理。

[Boost.XML](https://svn.boost.org/svn/boost/sandbox/xml/)（提案）：看起来*很棒*——功能强大、出色的 C++ 语法。但是它还没有通过审核过程，不受支持，界面可能会发生变化。反正也差不多用了。期待它被 Boost 接受。

[Libxml](http://xmlsoft.org/)（[++](http://libxmlplusplus.sourceforge.net/)）：非常好；强大，体面的语法。但是，如果您所做的只是*生成*XML 并且与 glibmm 库（用于 ustring）相关联，那么它就有点大了。如果我们*只*在 Linux 上（比如你自己？）我会认真考虑。

[XiMOL](http://ximol.sourceforge.net/)：独特的基于流的库。这对于我们的需求来说有点过于简单，但对于基本的 XML 生成，您可能会发现它非常有用。流语法非常简洁。

希望里面有一些有用的东西！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-19T21:20:57.787

有些人可能会说我是 XML 异端 - 但一种有效的方法是使用您最喜欢的字符串输出工具（打印、输出流等）生成它 - 这可以转到缓冲区或文件。

一旦保存 - 你真的应该在提交之前使用模式进行验证，然后再将其发送出去。

对于我们的一个项目，我们有一组非常简单的模板来管理开始/结束标签和属性。它们每个都有一个流输出运算符。这使得生成源 XML 和调试变得非常容易。这使得 XML 生成代码的结构看起来很像 XML 本身。

这样做的一个优点是，如果流式传输到文件，您可以有效地生成大量 XML。您将在稍后支付验证费用（大概是在一个更昂贵的操作的更好时间）。

这种技术的缺点是它本质上只是输出。它不适合动态创建然后使用 XML。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-15T21:42:46.123

**Boost.PropertyTree**是一种很好且直接的生成 XML 的方法——特别是如果您已经在使用 Boost。

下面是一个完整的示例程序：

```
#include <boost/property_tree/ptree.hpp>
#include <boost/property_tree/xml_parser.hpp>

using boost::property_tree::ptree;
using boost::property_tree::write_xml;
using boost::property_tree::xml_writer_settings;

int wmain(int argc, wchar_t* argv[]) {
    char* titles[] = {"And Then There Were None", "Android Games", "The Lord of the Rings"};

    ptree tree;
    tree.add("library.<xmlattr>.version", "1.0");
    for (int i = 0; i < 3; i++) {
        ptree& book = tree.add("library.books.book", "");
        book.add("title", titles[i]);
        book.add("<xmlattr>.id", i);
        book.add("pageCount", (i+1) * 234);
    }

    // Note that starting with Boost 1.56, the template argument must be std::string
    // instead of char
    write_xml("C:\\Users\\Daniel\\Desktop\\test.xml", tree,
        std::locale(),
        xml_writer_settings<char>(' ', 4));

    return 0;
} 
```

生成的 XML 如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<library version="1.0">
    <books>
        <book id="0">
            <title>And Then There Were None</title>
            <pageCount>234</pageCount>
        </book>
        <book id="1">
            <title>Android Games</title>
            <pageCount>468</pageCount>
        </book>
        <book id="2">
            <title>The Lord of the Rings</title>
            <pageCount>702</pageCount>
        </book>
    </books>
</library> 
```

一件特别好的事情是点分隔的路径，它允许您沿途隐式创建所有节点。[文档](http://www.boost.org/doc/libs/1_49_0/doc/html/property_tree.html)相当少，但应该`ptree.hpp`让您了解它是如何工作的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T21:35:00.127

哪个平台？MSXML 是 Windows 上的一个选项。 [CMarkup](http://www.firstobject.com)是另一个不错的选择。如果 .NET 是一个选项，它具有出色的 XML 支持。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T21:39:28.903

我实际上并没有尝试过提升序列化来做到这一点，但据我所知，如果你非常仔细地选择你的选项，你可以在模式中设置很多不同的选项（例如防止指针飞行加权和为某些类型设置元素名称)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T08:42:27.300

我使用 tinyXml++，它可以很容易地创建上面发布的 xml。它还将在一个命令中将其保存到文件中，但我不知道如何将其保存到缓冲区。

# apache-flex - 需要帮助在 Flex 中设置 TabNavigator 的样式

> ID：303374
> 
> 赞同：3
> 
> 时间：2008-11-19T21:09:14.860
> 
> 标签：apache-flex, actionscript-3

我有一个选项卡导航器控件，我想让所有选项卡都变成某种颜色，比如蓝色...

如何才能做到这一点？

我已经尝试过以下CSS：

```
 TabNavigator
{
    tabStyleName: "tabs";
}
.tabs {
    backgroundColor:#6588b9;
} 

```

但它似乎只适用于选定的选项卡......

然后我尝试以编程方式进行操作：

```
 for(var i:int=0; i<num_of_tabs; i++)
    tn.getTabAt(i).setStyle("backgroundColor","blue"); 

```

然而同样的事情发生了（只有选定的选项卡显示蓝色背景）

我该怎么做才能使所有选项卡都是蓝色的？我必须研究剥皮吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T21:17:47.293

我有一个带有样式标签的项目（我假设您指的是标签本身，而不是内容）。我敢肯定还有其他方法，但这似乎是我最终的结果：

```
.myTabStyle {
    tabStyleName: "myTabs"
}
.myTabs {
    backgroundColor: #ff0000;
    fillColor: #000000;  /* this is the tab widget itself, not the content */
}
<mx:TabNavigator ... styleName="myTabStyle" .. > 
```

在 Flex 中有几个地方您必须使用 CSS 样式来引用其他样式以深入了解您想要的小部件（另一个示例是在 TitleWindow 上设置标题栏样式）。

我希望这有帮助。

顺便说一句，我在 Mac 和 Windows、FireFox、IE、Safari、Flash 9 和 10 上偶尔看到“撕裂”，带有大字体和彩色标签——我不确定这是不是我在做的事情，关于较大的字体，或彩色标签本身——但只是一个提示。这只发生在使用 Flex 3 SDK 构建时（从未在 Flex 2 中看到过）。

# .net - 未处理通过 MSMQ 的较大 WCF 消息

> ID：303392
> 
> 赞同：3
> 
> 时间：2008-11-19T21:15:03.413
> 
> 标签：.net, wcf, msmq

我有一个托管从 MSMQ 读取的 WCF 服务的 Windows 控制台应用程序。当消息大小达到 7k 到 8k 左右时，服务会读取它（即它从 Q 中消失），但不会调用相应的函数。没有抛出异常。有人对正在发生的事情或在哪里寻找解决此问题有任何线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T22:17:28.827

我追查了问题。在托管应用程序/服务的 .config 文件中，添加或更改默认为 8196 的 readerQuotas 元素的 maxStringContentLength 属性。

```
<bindings>
  <netMsmqBinding>
    <binding name="netMsmq">
      <security mode="None" />
      <readerQuotas
        maxDepth="32"
        maxStringContentLength="8196"
        maxArrayLength="16384"
        maxBytesPerRead="4096"
        maxNameTableCharCount="16384"
        />
    </binding>
  </netMsmqBinding>
</bindings> 
```

# ruby-on-rails - 用于 Web 应用注册、登录、管理密码的现有库？

> ID：303394
> 
> 赞同：2
> 
> 时间：2008-11-19T21:16:49.853
> 
> 标签：ruby-on-rails, django, web-applications

主要的 Web 应用程序框架（Rails、Django 等）是否具有提供登录、注册、创建用户名、更改密码和管理丢失密码的功能的库？

在我看来，这是一些标准库应该支持的常见功能，但我在搜索中没有看到任何内容。我知道 OpenID，但我对非 OpenID 解决方案很感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-20T13:32:42.050

对于 Rails，最流行的是[RestfulAuthentication](http://github.com/technoweenie/restful-authentication/tree/master)。之所以如此，是因为它是由 Rails 的核心贡献者之一编写的。

最近又出来了一个，看起来更干净，功能更完整。我还没有花时间去尝试。查看[Authlogic](http://github.com/binarylogic/authlogic/tree/master)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T22:18:57.480

Django 有一个标准的用户数据模型，它被 Django 应用程序广泛使用。还有许多应用程序可用于简化用户管理，例如[django-registration](http://www.bitbucket.org/ubernostrum/django-registration/wiki/Home)。

Rails 比 Django 有更多的选择，但没有标准的用户模型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T22:21:01.643

在 Rails 中，它位于核心之外。您需要自己编写或使用诸如 Restful_Authentication 之类的插件 - 它具有您提到的所有功能。

如果您希望它全部预置在 Rails 中，请查看像 Bort 这样的骨架应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-21T08:47:25.013

至于 Django，这里已经提到了 User 模型。它是处理身份验证管理（帐户、密码、相关例程）的整个 contrib 应用程序的一部分。人们通常使用某种用户配置文件应用程序添加一些用户信息（有些已经构建，请查看[Django Pluggables](http://djangoplugables.com/)）。对于扩展功能，比如用户注册，（这里已经提到）[django-registration](http://www.bitbucket.org/ubernostrum/django-registration/)是最广泛使用的。

# xsd - XML 文档中的节点

> ID：303397
> 
> 赞同：0
> 
> 时间：2008-11-19T21:18:46.137
> 
> 标签：xsd, biztalk

我设计了一个 xml 模式来解析传入的 xml 文档。接收位置从 2 个提要获取 xml 文档，其中一个在文档中拼错了一个节点，“Roookie”而不是“Rookie”，有没有办法让我现有的 xsd 解析这个文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T21:31:09.170

您可能会预处理错误的 XML 文件，例如使用这个简单的 XSL 样式表：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output method="xml" indent="no"/>

<xsl:template match="Roookie">
        <Rookie>
                <xsl:apply-templates select="@*|node()" />
        </Rookie>
</xsl:template>

<xsl:template match="@*|node()" name="defaultRule">
        <xsl:copy>
                <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T03:38:51.420

The onyl answer here is to modify the bad message. The xsd is a contract and should be adhered to by submitting systems. If you don't have this kind of control over the submitting systems, I'd suggest making a second schema with a new name and have it accomodate the spelling error. I fyou start altering your contract/xsd for every mistake in a message, you will increase complexity and decrease maintainability.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T21:21:03.260

您需要替换文档中的元素或修改 xsd 以使用新的文档格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T21:30:18.250

只需修改您的模式以接受 2 个节点（Rookie 或 Roookie）之间的选择，而不是简单的 1 个名为 Rookie 的节点。两个节点具有相同的类型。当然，如果 Roo(o)kie 有一个复杂的内容，你会想要为这个内容声明一个复杂的类型，以避免重复 2 个元素的整个结构。

# sql - 帮助不同的行和数据排序

> ID：303404
> 
> 赞同：0
> 
> 时间：2008-11-19T21:21:27.723
> 
> 标签：sql, sql-server

如果我有记录：

```
行日期、位置 ID、帐户
1 2008 年 1 月 1 日 1 1000
2 2008 年 1 月 2 日 1 1000
3 2008 年 1 月 3 日 2 1001
4 2008 年 1 月 3 日 1 1001
5 2008 年 1 月 3 日 3 1001
6 2008 年 1 月 4 日 3 1002

```

我需要获取每个不同的行具有最新日期的行 ( `date`, `locatinid`, ) ：`account``locationid`

```
4 2008 年 1 月 3 日 1 1001
3 2008 年 1 月 3 日 2 1001
6 2008 年 1 月 4 日 3 1002

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T21:51:54.620

我认为这会起作用：

```
SELECT t1.*
FROM table t1
  JOIN (SELECT MAX(Date), LocationID
        FROM table
        GROUP BY Date, LocationID) t2 on t1.Date = t2.Date and t1.LocationID = t2.LocationID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T21:26:14.357

尝试类似：

```
select *
from mytable t1
where date = (select max(date) from mytable t2
              where t2.location = t1.location); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T21:39:19.713

```
select t.* from mytable t,
(select max(Date) as Date,LocationID from mytable group by LocationID) t1 
where t.Date = t1.Date and t.LocationID = t1.LocationID 
order by t1.LocationID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T21:44:07.940

```
SELECT t1.*
FROM mytable t1
  LEFT OUTER JOIN mytable t2
  ON (t1.locationid = t2.locationid 
    AND (t1.date < t2.date OR t1.date = t2.date AND t1.row < t2.row))
WHERE t2.row IS NULL; 
```

此解决方案每个 locationid 仅返回一行，即使有多行具有相同的最大日期也是如此。

# c++ - 使用 C++ 实现线程

> ID：303405
> 
> 赞同：0
> 
> 时间：2008-11-19T21:21:32.293
> 
> 标签：c++, multithreading

我的应用程序中有一个 API 调用，我正在检查单个调用所花费的时间。我把它放在一个 FOR 循环中，并使用 10000 次调用来获取所有调用的平均时间。现在出现的问题是使用 API 的实际应用程序是多线程的。如果我想让我的应用程序也这样做，我将如何去做？

该平台是 REL，我的目标是使用相同参数或不同参数同时发送多个调用。这可以在 C++ 中实现吗？如果可以，要使用哪些库函数，可以提供一个示例吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T21:24:54.393

用于线程的最佳 C++ 库可能是 Boost 中的线程库，但与所有 C++ 线程一样，您将被迫手动进行同步。您将需要使用互斥锁和锁类型才能使其正常工作。你的问题不是很清楚，所以我真的不能再帮你了（虽然我认为你实际上不需要线程，但我可能完全误解了）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T21:37:52.963

如果您阅读 Miranda IM 源代码，它应该可以帮助您入门。它做得很好，代码中有一些很好的提示，说明如何重新调整其他可执行文件（在 Windows 上）的内存偏移量，以使它们加载更快。

[http://www.miranda-im.org/development/](http://www.miranda-im.org/development/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T23:50:43.317

我不知道 REL 平台。

我可能会建议使用 OMP 替代方案，它并不完全是 Threads，但它可以完成这项工作，并且在这种情况下很容易使用。显然它在相当多的[编译器](http://openmp.org/wp/openmp-compilers/)上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T21:25:37.463

在什么平台上？几乎每个人都支持线程，我想他们都有关于如何创建线程的文档。在 Windows 下，您将调用 CreateThread API。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T21:28:46.193

Pthreads 是你在 Linux 上的表现方式。用于 Solaris 的 Solaris 线程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T22:16:13.227

我不熟悉 REL 平台。一般来说，我更喜欢[英特尔的 TBB](http://www.threadingbuildingblocks.org/)线程，但它现在只能在 x86 芯片上运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-26T21:12:50.277

从 C++11 开始，不再需要使用 Boost。C++11 包括`std::thread`、支持互斥体、条件变量等，与 Boost 非常相似。

[您可以在C++ 参考](http://en.cppreference.com/w/cpp/thread)中查看 C++11 在线程方面提供的内容。

# .net - 是否有 COMExceptions 的主列表？

> ID：303411
> 
> 赞同：1
> 
> 时间：2008-11-19T21:24:34.067
> 
> 标签：.net, exception, com

Oracle 社区有几个支持站点（[此处](http://www.11ghelp.com/map/sitemap-110.html)和[此处](http://www.oracleabc.com/oracledocs/11gErrors/)），其中包含错误列表。第一个站点甚至提供了有关如何修复它们的建议。

有谁知道 Microsoft COM 的等效列表，最好是 Office 互操作问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-27T05:09:25.640

不，每个组件都可以定义自己的。唯一的限制是错误值必须设置高位，并且中间的位*应该*识别组件。

[维基百科](http://en.wikipedia.org/wiki/HRESULT)有一篇文章展示了错误代码的位是如何划分的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T21:58:17.460

[这](http://msdn.microsoft.com/en-us/library/aa705941(VS.85).aspx)是 ms 的一般 com ex 列表；很短，但它的东西。当我使用 OWC 时，我通常会发现它们分散在不同的站点或单独的博客条目中。（耶谷歌）

# sql-server - 编写sql存储过程的最佳实践是什么

> ID：303417
> 
> 赞同：34
> 
> 时间：2008-11-19T21:25:21.083
> 
> 标签：sql-server, tsql, stored-procedures

我发现 SQL 存储过程非常有趣和有用。我已经编写了存储过程，但我想为任何类型的需求编写精心设计、良好性能调整和简洁的 SP，并且也很想了解存储过程的任何技巧或良好实践。我如何从编写存储过程的初学者进入高级阶段？

*更新：从评论中发现我的问题应该更具体。每个人都有一些技巧，我期待他们在他们的代码中使用的 SP 的这些技巧和实践使他们与其他人区分开来，更重要的是提高编写和使用存储过程的生产力。*

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-19T23:39:17.490

这是我的存储过程错误处理指南。

*   使用其完全限定名称调用每个存储过程以提高性能：即服务器名称、数据库名称、模式（所有者）名称和过程名称。
*   在创建每个存储过程的脚本中，明确指定允许哪些角色执行该过程，例如 public 或其他。
*   使用 sysmessage、sp_addmessage 和占位符而不是硬编码的错误消息。
*   使用 sp_addmessage 和 sysmessages 时，始终使用 50001 或更大的错误消息号。
*   对于 RAISERROR，始终为警告消息提供严重级别 <= 10。
*   对于 RAISERROR，始终为错误消息提供 11 到 16 之间的严重级别。
*   请记住，使用 RAISERROR 并不总是中止任何正在进行的批处理，即使在触发器上下文中也是如此。
*   在使用它或询问它之前将[@@error](http://msdn.microsoft.com/en-us/library/ms190193.aspx)保存到一个局部变量中。
*   在使用它或询问它之前，将@@rowcount 保存到一个局部变量中。
*   对于存储过程，使用返回值仅指示成功/失败，而不是任何其他/额外信息。
*   存储过程的返回值应设置为 0 表示成功，非零表示失败。
*   设置 ANSI_WARNINGS ON - 这会检测任何聚合赋值中的空值，以及任何超过字符或二进制列最大长度的赋值。
*   出于多种原因，将 NOCOUNT 设置为 ON。
*   仔细考虑您是否想要[XACT_ABORT ON 或 OFF](https://stackoverflow.com/questions/1150032/what-is-the-benefit-of-using-set-xact-abort-on-in-a-stored-procedure)。无论你走哪条路，都要保持一致。
*   在第一个错误时退出 - 这实现了 KISS 模型。
*   执行存储过程时，始终检查@@error 和返回值。例如：

    ```
    EXEC @err = AnyStoredProc @value
    SET  @save_error = @@error
    -- NULLIF says that if @err is 0, this is the same as null
    -- COALESCE returns the first non-null value in its arguments
    SELECT @err = COALESCE( NULLIF(@err, 0), @save_error )
    IF @err <> 0 BEGIN 
        -- Because stored proc may have started a tran it didn't commit
        ROLLBACK TRANSACTION 
        RETURN @err 
    END 
    ```

*   执行导致错误的本地存储过程时，请执行回滚，因为该过程可能已启动未提交或回滚的事务。
*   不要仅仅因为你还没有开始一个事务就认为没有任何活动的事务——调用者可能已经开始了一个事务。
*   理想情况下，避免对调用者启动的事务进行回滚 - 所以检查@@trancount。
*   但是在触发器中，总是回滚，因为你不知道调用者是否启动了一个活动事务（因为@@trancount 总是> = 1）。
*   始终在以下语句之后存储并检查 @@error：

    ```
    INSERT, DELETE, UPDATE
    SELECT INTO
    Invocation of stored procedures
    invocation of dynamic SQL
    COMMIT TRANSACTION
    DECLARE and OPEN CURSOR
    FETCH from cursor
    WRITETEXT and UPDATETEXT 
    ```

*   如果 DECLARE CURSOR 在进程全局游标（默认值）上失败，则发出一条语句来释放游标。
*   小心 UDF 中的错误。当 UDF 中发生错误时，函数的执行会立即中止，调用 UDF 的查询也会立即中止 - 但 @@error 为 0！在这些情况下，您可能希望使用 SET XACT_ABORT ON 运行。
*   如果您想使用动态 SQL，请尝试在每个批处理中仅使用一个 SELECT，因为 @@error 仅保存最后执行的命令的状态。一批动态 SQL 中最可能出现的错误是语法错误，SET XACT_ABORT ON 不会处理这些错误。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-19T21:39:21.897

我总是尝试使用的唯一技巧是：始终在靠近顶部的评论中包含示例用法。这对于测试您的 SP 也很有用。我喜欢包含最常见的示例 - 然后您甚至不需要 SQL 提示符或带有您喜欢的调用的单独 .sql 文件，因为它存储在服务器中（如果您存储了查看的过程，这将特别有用） sp_who 输出块或其他内容并采用一堆参数）。

就像是：

```
/*
    Usage:
    EXEC usp_ThisProc @Param1 = 1, @Param2 = 2
*/ 
```

然后要测试或运行 SP，您只需在脚本中突出显示该部分并执行即可。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-10-07T09:17:44.150

1.  始终使用 SET NOCOUNT ON
2.  如果您要执行两个或多个插入/更新/删除，请使用事务。
3.  永远不要将你的 proc 命名为“sp_”。SQL Server 将首先在主数据库中查找，而不是找到它，然后再在您的数据库中查找。如果您以不同的方式命名您的过程，SQL Server 将首先在您的数据库中查找。

坏的：

```
SET NOCOUNT ON
BEGIN TRAN
  INSERT...
  UPDATE...
COMMIT 
```

更好，但看起来很乱，而且代码很痛苦：

```
SET NOCOUNT ON
BEGIN TRAN
  INSERT...
  IF @ErrorVar <> 0
  BEGIN
      RAISERROR(N'Message', 16, 1)
      GOTO QuitWithRollback
  END

  UPDATE...
  IF @ErrorVar <> 0
  BEGIN
      RAISERROR(N'Message', 16, 1)
      GOTO QuitWithRollback
  END

  EXECUTE @ReturnCode = some_proc @some_param = 123
  IF (@@ERROR <> 0 OR @ReturnCode <> 0)
       GOTO QuitWithRollback 
COMMIT
GOTO   EndSave              
QuitWithRollback:
    IF (@@TRANCOUNT > 0)
        ROLLBACK TRANSACTION 
EndSave: 
```

好的：

```
SET NOCOUNT ON
SET XACT_ABORT ON
BEGIN TRY
    BEGIN TRAN
    INSERT...
    UPDATE...
    COMMIT
END TRY
BEGIN CATCH
    IF (XACT_STATE()) <> 0
        ROLLBACK
END CATCH 
```

最好的：

```
SET NOCOUNT ON
SET XACT_ABORT ON
BEGIN TRAN
    INSERT...
    UPDATE...
COMMIT 
```

那么“最佳”解决方案的错误处理在哪里？你不需要任何东西。请参阅**SET XACT_ABORT ON**，这意味着如果有任何错误，则执行自动回滚。代码更干净，更容易阅读，更容易编写，而且错误更少。错误更少，因为 SQL Server 现在为您执行此操作，因此不会丢失错误条件。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-19T21:41:52.407

这是一个非常笼统的问题，但这里有一些建议：

*   一致地命名您的存储过程。许多人使用前缀来标识它是一个存储过程，但不要使用“sp_”作为为主数据库指定的前缀（无论如何在 SQL Server 中）
*   将 NOCOUNT 设置为 on，因为这会减少可能的返回值的数量
*   基于集合的查询通常比游标执行得更好。[这个问题](https://stackoverflow.com/questions/287445/why-do-people-hate-sql-cursors-so-much)更详细地讨论了这个问题。
*   如果您要为存储过程声明变量，请使用良好的命名约定，就像在任何其他类型的编程中一样/应该使用。
*   使用完全限定名称调用 SP，以消除关于应该调用哪个 SP 的任何混淆，并帮助提高 SQL Server 性能；这使得更容易找到有问题的 SP。

当然，还有更多。以下是更多链接： [SQL Server 存储过程优化技巧](http://www.databasejournal.com/features/mssql/article.php/1565961/SQL-Server-Stored-Procedures-Optimization-Tips.htm)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-19T22:13:13.763

在 SQL Server 中，我总是放置一个语句，如果该过程存在则删除它，这样我就可以在开发过程中轻松地重新创建该过程。就像是：

```
IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'usp') 并输入 (N'P', N'PC'))
删除程序 usp

```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-19T22:45:27.350

这在很大程度上取决于您在存储过程中所做的事情。但是，如果您在一个 proc 中进行多次插入/更新或删除，则使用事务是一个好主意。这样，如果一个部分发生故障，其他部分将回滚，使您的数据库处于一致状态。

在写入数据库时​​（以及因此在使用执行除选择以外的操作的存储过程时）要考虑的两个最重要的事情是数据完整性和性能。没有数据完整性，您只会拥有一个包含垃圾且无用的数据库。如果没有 performacne，您将没有用户（如果他们是外部客户）或不满意的用户（如果他们被要求使用您的产品，通常是没有选择去其他地方的内部用户）。没有一个对你的职业有好处。因此，在编写存储过程时，请确保首先确保将数据正确输入到数据库中，并且如果操作的某个部分出现问题，它将失败。

如果需要将检查写入 proc 以确保您的最终结果是正确的。我是一名 ETL 专家，在尝试将数据导入表之前，我总是编写我的过程以使数据得到清理和规范化。如果您是从用户界面执行操作，那么在 proc 中执行此操作可能并不那么重要，尽管我会在运行 proc 之前让用户界面进行检查以确保数据适合插入（例如检查以确保datefield 包含一个真实的日期，所有必填字段都有值等）

如果您正在编写 proc 以将大量数据放入表中，那么最好有一种方法可以在这些结果最终确定之前对其进行测试。您会惊讶于从客户和供应商那里获得的用于数据导入的垃圾。我们使用测试标志编写所有导入过程。这样，您可以返回选择数据而不是执行操作，这样您就可以提前看到您将影响的确切内容。

我不是动态 SQL 的粉丝，我不喜欢在存储过程中使用它。如果您在现有 procs 中遇到动态 SQl，请输入一个调试标志，允许您打印 SQL 而不是执行它。然后在注释中输入您需要运行的最典型案例。你会发现如果你这样做，你可以更好地维护过程。

不要在游标中做事，只是因为你想重用另一个只在一条记录上工作的存储过程。如果是坏事，代码重用会导致性能问题。

如果您使用的是 case 语句或 if 语句，请确保您已经完成了能够触及每个可能分支的测试。你不测试的就是会失败的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-19T21:39:49.103

这不是一个可以在没有更多信息的情况下直接回答的问题，但一些一般的经验法则确实适用。

存储过程只是存储的 T-SQL 查询。因此，更加熟悉 T-SQL 以及各种函数和语法确实是您需要做的。从性能的角度来看更是如此，您需要确保您的查询和底层数据结构以允许良好性能的方式匹配。IE，确保在需要的地方实现索引、关系、约束等。

了解如何使用性能调优工具、了解执行计划的工作原理以及这些性质的事情是您如何进入“下一个级别”的

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-31T18:33:10.920

在 SQL Server 2008 中使用 TRY...CATCH 构造，您可以在 T-SQL 存储过程中使用它来提供比以前版本的 SQL Server 中更优雅的异常处理机制，方法是检查 @@ERROR（通常在每个 SQL 语句之后使用 GOTO 语句。

```
 BEGIN TRY
             one_or_more_sql_statements
         END TRY
         BEGIN CATCH
             one_or_more_sql_statements
         END CATCH 
```

在 CATCH 块中时，您可以使用以下错误函数来捕获有关调用 CATCH 块的错误的信息，

```
 ERROR_NUMBER()
         ERROR_MESSAGE()
         ERROR_SEVERITY()
         ERROR_STATE()
         ERROR_LINE()
         ERROR_PROCEDURE() 
```

与@@error 不同，由执行的每个语句重置，错误函数检索到的错误信息在 TRY...CATCH 语句的 CATCH 块范围内的任何地方都保持不变。这些函数可以允许将错误处理模块化到单个过程中，因此您不必在每个 CATCH 块中重复错误处理代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-19T22:17:38.403

基本的东西：

有一个错误处理策略，并在所有 SQL 语句上捕获错误。
决定对存储过程使用源代码控制的策略。
包括带有用户、日期/时间和 sp 目的的注释标题。
显式返回 0（成功）表示成功执行，否则返回。
对于非平凡的程序，包括一个（或多个）测试用例和预期结果的描述。
养成性能测试的习惯。对于文本案例，至少记录执行时间。
了解显式事务并使用它们。
几乎从不从 SP 调用 SP。可重用性与 SQL 不同。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-05-23T10:50:31.370

下面是一些代码来证明 SQL Server 上没有多级 ROLLBACK，它说明了事务是如何处理的：

```
 BEGIN TRAN;

    SELECT @@TRANCOUNT AS after_1_begin;

BEGIN TRAN;

    SELECT @@TRANCOUNT AS after_2_begin;

COMMIT TRAN;

    SELECT @@TRANCOUNT AS after_1_commit;

BEGIN TRANSACTION;

    SELECT @@TRANCOUNT AS after_3_begin;

ROLLBACK TRAN;

    SELECT @@TRANCOUNT AS after_rollback; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-03-07T08:41:02.647

以下是一些最佳实践，

1.  避免 _sp 前缀
2.  包括 SET NOCOUNT ON 语句
3.  尽量避免使用临时表
4.  尽量避免使用 Select * from
5.  尽量避免使用光标
6.  使用正确的索引
7.  正确的错误处理

[有关更多解释和 T-SQL 代码示例，请查看此帖子](https://codechef4u.com/post/2015/05/06/stored-procedure1)

# asp.net - 使用 ASP.Net Membership Provider 确保只有一个用户登录

> ID：303420
> 
> 赞同：1
> 
> 时间：2008-11-19T21:25:46.620
> 
> 标签：asp.net, membership-provider

您如何确保每个帐户一次只有一个用户登录？

假设 cookie 是持久的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T21:36:55.147

通常，最好的方法是在提供程序上实现自定义以检查上次登录，以及在代码中添加方法以跟踪用户操作。

关键是你必须知道用户最后一次做某事或注销是在什么时候。从那里您可以确定帐户是否实际准备就绪。如果您在代码中设置了对这些元素的跟踪，则可以修改成员资格提供程序以检查以确保帐户可以登录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T22:43:33.360

从概念上讲，您必须决定要如何响应。如果您让用户 A 登录，然后用户 B 尝试登录（使用相同的凭据），您会：

1.  踢出用户 A

或者

2.  不允许用户 B 登录

(2) 是有问题的，因为您需要可靠地知道用户 A 已注销以确定是否登录用户 B。用户 A 可能只是在您网站上的某个页面上查看了一段时间，因此通过时间进行操作可能不是最好的. 也许某种 AJAX 看门狗每 30 秒 ping 一次您的网站。

(1) 还需要一些工作。当用户登录时，您可能希望存储他们的 cookie 值（可能在数据库中）并将其添加到为该用户发布的 cookie 列表中。这样，只会接受最后一次发出的 cookie（最后一次登录）。如果您看到较早的 cookie 之一，那么您将注销该人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T03:04:34.827

我用用户的 id 创建一个表。每次用户登录时，系统都会创建一个唯一的 id，该 ID 与用户 ID 相对应存储在表中，以及会话变量中。

Every post back or page process, the key stored in the session variable is checked against the last key for that user stored in the database. If a second user logs in with the same account, the system will create a new unique id, so that when the first user posts back or changes pages, the key stored in his session variable will be different to that in the table, indicating that the account has been opened in another location.

I schedule a night process to delete the old ids from the table

# data-structures - 关系数据库的高效持久数据结构

> ID：303426
> 
> 赞同：10
> 
> 时间：2008-11-19T21:27:59.190
> 
> 标签：data-structures, functional-programming, rdbms, immutability, relational

我正在寻找可用于实现关系模型的持久数据结构的材料。

不可变数据结构含义的持久性。

有人知道一些好的资源、书籍、论文等吗？

（我已经有书[Purely Functional Data Structures](http://www.cs.cmu.edu/~rwh/theses/okasaki.pdf)，这是我正在寻找的一个很好的例子。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T21:59:07.100

将无处不在的[B 树](http://en.wikipedia.org/wiki/B-tree)修改为持久性很简单。只需在修改节点时始终分配一个新节点，并将新节点返回给递归调用者，递归调用者将通过分配新节点等将其插入该级别。最终返回新的根节点。每个操作分配不超过 O(log N) 个节点。

这是函数式语言中用于实现例如 2-3 树的技术。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-23T01:14:08.777

我已经为 BergDB ( [http://bergdb.com/](http://bergdb.com/) ) 实现了这样的数据结构——一个具有持久数据结构的数据模型的数据库。

我建议阅读

[http://www.cs.cmu.edu/~sleator/papers/Persistence.htm](http://www.cs.cmu.edu/~sleator/papers/Persistence.htm)

这是关于如何基于普通（临时）创建持久数据结构的原创作品。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-11-20T14:48:46.517

SQLite 有一个[b-tree 数据结构实现](http://www.sqlite.org/cvstrac/fileview?f=sqlite/src/btreeInt.h&v=1.36)，你可以看看；

# css - 将 a:visited 链接设置为与 a:link 和 a:hover 相同的状态

> ID：303440
> 
> 赞同：9
> 
> 时间：2008-11-19T21:31:21.510
> 
> 标签：css, hyperlink

我正在研究我的 a:link 有一个状态（蓝色，没有下划线等），而 aa:hover 是白色的。我希望我**访问的链接具有与**`a:link`和相同的状态`a:hover`。这可能吗？最常见的浏览器支持？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-19T21:39:40.650

```
a, a:link, a:hover, a:visited, a:active {text-decoration: none; color: blue;} 
```

应该适用于所有支持 CSS 的浏览器，尽管这是一个[坏主意](http://www.useit.com/alertbox/20040503.html)（目前离线，[谷歌缓存](http://209.85.129.132/search?q=cache:WLLZPIH8XjoJ:www.useit.com/alertbox/20040503.html&strip=1)）

要制作`a:hover`白色，请将其从上述规则中删除并为其创建特殊规则或仅添加：

```
a:hover {color: white !important;} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-19T21:39:59.027

正如 sblundy 指出的那样，这是完全有可能的。但是，如果您制定这样的规则，将不再有任何视觉提示用户将鼠标悬停在先前访问过的链接上。

另外，请记住按以下顺序指定规则：

```
a:link { }
a:visited { }
a:hover { }
a:active { } 
```

否则你可能会得到意想不到的结果，因为所有这些规则都具有相同的特异性。顺序很重要。

编辑：CSS2 允许将伪类链接在一起。这可用于解决您的请求造成的 [潜在] 可用性问题。

```
a:visited:hover { } 
```

但是，我不知道这个约定是否得到广泛支持。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-19T21:43:59.643

教我记住放置 CSS 链接的顺序的助记符是“LoVe HAte”：链接、访问、悬停、活动。

坚持 :focus 在那里通常也不是一个坏主意。

当然，如果您通过使用逗号列出选择器来使链接的所有状态看起来都相同，那么顺序无关紧要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T21:33:58.133

以下是您如何设置 a 标签（正常和已访问）和单独设置悬停样式的方法。

```
a
{
    color:#6c7492;
    font-weight:bold;
    text-decoration:none;
}
a:hover
{
    border-bottom:1px solid #6c7492;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T21:34:28.727

如果您使用了那些伪类，我不明白为什么不这样做。

```
a:visited, a:hover {
  ...
} 
```

# jquery - IE 在动画过程中移除 CHECKED 属性

> ID：303446
> 
> 赞同：2
> 
> 时间：2008-11-19T21:33:51.893
> 
> 标签：jquery, internet-explorer

我在一个容器中有一些单选按钮`<div>`，我通过 jQuery 效果显示和隐藏它们。当容器在 Firefox 中隐藏时，单选按钮很好，并且当容器重新出现时值会重新出现。但是，在 IE 中，单选按钮首先清除选中的单选按钮，然后隐藏。你可以看到它实际上发生了。

我也知道它正在清除 UI（选中）按钮外观和标签的 CHECKED 属性，因为在容器中查找具有 CHECKED 属性的单选按钮无法返回任何内容。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T00:18:33.060

如果在 IE 中修改了内容，则需要[重置 defaultChecked 属性](http://webbugtrack.blogspot.com/2007/11/bug-299-setattribute-checked-does-not.html)（在 IE 中是大小写！）

# blackberry - IRimTable 和 PersistenceStore 是什么关系？

> ID：303452
> 
> 赞同：3
> 
> 时间：2008-11-19T21:35:30.737
> 
> 标签：blackberry, persistence

BlackBerry Desktop API 具有接口 IRimTable，它显然将 BlackBerry 设备上的“应用程序数据库”映射到虚拟结构（即，IRimTable 具有 IRimRecords，每个都有 IRimField），开发人员可以在连接到手持设备时浏览手持设备数据台式电脑。

同时，手持设备中的应用程序可以将其数据存储在 PersistenceStore 数据库中。我卡住的地方是 PersistenceStore API 没有定义任何表或记录或字段。

有谁知道这两个类之间的关系是什么？映射是如何工作的（如果有的话）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T20:44:30.680

没有相关性。PersistenceStore 处理设备本身的存储。没有字段定义，因为“表”中的每一行基本上都有一个字段。如果您想使用持久性存储来存储信息，您的应用程序必须管理信息。

# sql-server - sp_updatestats 是否会导致在 SQL Server 2005 中无法访问表？

> ID：303454
> 
> 赞同：4
> 
> 时间：2008-11-19T21:36:02.827
> 
> 标签：sql-server, statistics

更新统计信息会导致表无法访问吗？换句话说，您可以在不停机的情况下运行此过程吗？

专门用于 SQL Server 2005

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T21:45:26.287

不（它不会使它们无法访问），是（您可以在不停机的情况下运行它）。

sp_updatestats 可以针对实时数据库运行而无需停机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T21:45:55.643

在 SQL Server 2000 中，您可以运行此过程而不会导致停机。我怀疑这在以后的版本中有所改变。

# language-agnostic - 如果我想培养作为软件开发人员的技能（Java、Python、C、C++），必须具备哪些类型的设置/工具？

> ID：303456
> 
> 赞同：3
> 
> 时间：2008-11-19T21:37:17.130
> 
> 标签：language-agnostic, ide

我是软件开发领域的新手。我渴望有更多的途径来发展、培养和成熟我的开发、脚本和编程技能，尤其是在工作时间之外。我想知道哪种类型的设置（硬件和/或软件）会非常有益，或者其他人认为这对于这项工作是必要的。

我希望能够为我的家庭“办公室”配备工具，使我能够作为开发人员取得进步和成长。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T22:34:01.867

**编写代码：**

在这篇[文章中，](http://www.codinghorror.com/blog/archives/001160.html) [Jeff Atwood](http://stackoverflow.com/users/1/jeff-atwood)谈到了如何通过设计和编写大量软件来更好地设计和编写软件。他的表述更为优雅，但这是一个有效的观点。你做的越多，你就会做得越好。

**硬件：**

任何现代 PC/Mac 硬件都应该足够了。如果您打算运行 Windows 或 Linux，我会使用 PC 而不是 Mac。有很多争论哪个更好，但使用你最喜欢的那个。

在当今时代，这应该是一个有争议的问题，但请确保您拥有某种可靠的互联网连接（电缆、dsl 等...）。然后你就可以访问[Google](http://www.google.com/)和 [stackoverflow](http://stackoverflow.com/)了；对程序员来说都是很好的资源。

确保您拥有舒适的键盘和鼠标。这包括设置您的桌子和椅子以适应您的身高和手的位置。你会在电脑前很长一段时间，你想要舒服。

**编辑器/IDE：**

选择一个编辑器：Vim、EMACS、KATE、Eclipse*等等*。选择哪一个并不重要，但无论你选择哪一个，都学得很好。编辑器是您的主要工具，您希望在使用时舒适且知识渊博。您越了解您的编辑器，您创建/编辑代码的速度就越快。

拥有一个可以在您可能正在开发的所有平台上运行的编辑器会有所帮助，但这不是必需的。

**构建工具：**

在某些时候，您会发现自己不得不创建或修复构建系统。Make 对于 *nix 和 C/C++ 来说是相当标准的，但对于您自己的个人项目，请找到最适合您的项目。有很多可供选择：Scons、Ant、Make、Jam、...

我个人使用 SCons，因为它是基于 python 的，而且我喜欢 python。

**图书：**

当学习一个新主题时，我建议你买一本关于它的好书。这通常会给你一个很好的了解你正在做什么，并给你一个很好的学习基础。谷歌和 Stackoverflow 对特定问题很有用，但很难获得一个主题的总体概述。

这当然假设你有足够的时间和金钱。对于资金有限的人，您通常可以在网上找到免费的电子书版本。

**语言：**

我曾经对学习哪种语言有强烈的感觉，但现在我意识到你应该用你最喜欢的语言写作。但是不要害怕尝试新的语言。我个人喜欢 C++、python 和 C#，没有特别的顺序。

由于您刚刚开始选择可以免费获得的语言，我实际上认为这是当今大多数语言。

在商业世界中，选择的语言往往会在大约 5-7 年的周期内波动。但是，您可以在所有“大”语言（C++、JAVA、C# VB.net、python、ruby、perl、...）中找到一份工作（至少目前是这样）。如果您很好地学习了一种现代语言，那么快速过渡到另一种语言通常不是问题。与语言本身相比，库往往需要更长的时间来学习。所以选择一种你喜欢学习的语言并学习它。

**其他想法：**

正如 Marc Charbonneau 所说，设置源代码控制。有很多免费的源代码控制产品，所以选择你最喜欢的。我个人使用[Perforce](http://www.perforce.com/)，它对两个或更少的人免费。我也听说过关于[Subversion](http://subversion.tigris.org/)和[git](http://git.or.cz/)的好消息。具体的不是那么重要，而是选择其中之一。

如果您想更深入地了解计算，我会推荐 Sipser's [Book](https://rads.stackoverflow.com/amzn/click/com/0534950973)和[Knuth](https://rads.stackoverflow.com/amzn/click/com/0201485419)。

无论您选择哪种语言，我都会花时间学习调试器。

如果您正在进行 Web 开发，请确保您知道如何最低限度地设置和运行 Apacie（或 IIS）。

如果可以的话，避免圣战。他们是在浪费时间，除了人们很固执之外，你不会从中学到任何东西。一些圣战主题（括号样式、编辑器、字节顺序、“最佳”语言、“最佳”操作系统……）。

**我的个人设置：**

标准电脑 (Windows XP Pro)

*   Visual Studio 2007（有点落后）。
*   虚拟机
*   Python
*   C/C++
*   C＃
*   斯康斯

标准 PC（FreeBSD 无头运行：无 GUI）

*   gnu 工具链（Make、C/C++ 等）
*   虚拟机
*   Python
*   斯康斯

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T21:41:10.413

就个人而言，我建议从 Linux 开始——几乎每种编程语言在 Linux 上都有很好的免费工具。然后，我会使用 VMWare 制作具有您可能想要在其上测试软件的各种其他平台的虚拟机 - Windows、其他 Linux 发行版，可能还有 OpenSolaris 等。同样，根据我的经验，带有 Windows VM 的 Linux 比带有 Linux 的 Windows 运行得更好虚拟机。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T21:44:22.340

我推荐 KATE（KDE 的一部分）作为编辑器。它是一个轻量级和简单的编辑器，具有语法高亮、多个文件和一个内置终端。它不像 emacs 或 vim 那样强大，而且由于终端，它非常适合各种项目。它有点像一个迷你IDE。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T21:50:21.953

没有什么比选择一个使用您最感兴趣的技术的项目并构建它更有帮助了。你可以决定学习 X 语言或阅读关于 Y 的书，只是为了增加你的知识，但即使你有毅力坚持到底，我敢打赌你会学以实际的学习为基础，获得更多的满足感。

至于具体的工具，唯一的答案取决于你想做什么。您最终可能会使用 Microsoft 的 Visual C# Express、适用于 Java 的 NetBeans IDE 或 Mac 上的 Xcode。所有这些都是免费的，但重要的是您计划使用这些工具做什么，而不是您将它们安装在硬盘上。硬件和操作系统也是如此，您可能希望拥有一台出色的 Windows PC 来用 C# 构建游戏，或者使用 Mac 进行 Web 开发等。决定您想要做什么，并选择允许的最佳工具你来完成那个目标。

几乎独立于一切的一件事是某种版本控制。无论您使用什么项目或技术，这都是一个好主意。Git 和 Subversion 是两个流行的跨平台选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T22:45:50.017

快速连接（用于下载 linux）和 safari.oreilly.com 帐户！

# asp.net - 正确使用 ObjectDataSource

> ID：303460
> 
> 赞同：1
> 
> 时间：2008-11-19T21:38:55.330
> 
> 标签：asp.net, c#-3.0, asp.net-2.0, objectdatasource, datagridviewcheckboxcell

问候！

我正在创建一个将在 GridView 控件中显示数据的用户控件。我们使用的是 n 层架构，有问题的数据从我们的数据库中检索并作为 ReadOnlyCollection 返回给我们。OurNewObject 是一个包含多个属性和一个不带参数的空构造函数的类 - 它位于以下命名空间中：Acme.ObjectModel。

在用户控件中，我有以下内容：

```
<asp:GridView ID="ourGrid" runat="server" DataSourceID="ourDataSource">
    <columns>
    <asp:BoundField DataField="Name" HeaderText="Full Name" />
    <asp:BoundField DataField="Gender" HeaderText="Gender" />
    <asp:BoundField DataField="BirthYear" HeaderText="Year of Birth" />
    <asp:BoundField DataField="JoinDate" HeaderText="Date Joined" />
  </columns>
</asp:GridView>
<asp:ObjectDataSource ID="ourDataSource" runat="server" SelectMethod="GetTopUsers" TypeName="Acme.Model.OurNewObject">
</asp:ObjectDataSource> 
```

在后面的用户控件代码中，我有以下公共方法：

```
public ReadOnlyCollection<OurNewObject> GetTopUsers()
{
    return (OurDataProxy.GetJustTheTopUsers());
} 
```

当我将用户控件放在 Web 窗体上并运行它时，我收到以下消息：

**ObjectDataSource 'ourDataSource' 找不到没有参数的非泛型方法 'GetTopUsers'。**

所以我的问题是：

1.  我是否错误地使用了 ObjectDataSource？
2.  在这种情况下是否有更合适的方法来使用 ObjectDataSource？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-03T02:15:02.650

通常，您将创建一个包含数据访问方法的单独对象，而不是将这些方法放在代码隐藏中。单独的对象可以是实例或静态的，但对象本身必须有一个无参数的构造函数（或根本没有构造函数）。

此外，ObjectDataSource 上的 TypeName 属性应该引用上述单独对象的类型名。例子：

```
public class SampleDataObject
{
  public ICollection<OurNewObject> GetTopUsers()
  {
    //[...]
  }
} 
```

The attributes mentioned above: [System.ComponentModel.DataObject(true)] at the class level, and [System.ComponentModel.DataObjectMethod(DataObjectMethodType.Select)] at the getter method are not required, but will aid in design-time support by filtering out other types when looking for classes to hook yer ObjectDataSource up to.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T21:51:18.020

我认为这个问题缺少两个属性。

首先在您的 GetTopUsers() 方法上添加此属性

```
[System.ComponentModel.DataObjectMethodAttribute
    (System.ComponentModel.DataObjectMethodType.Select, true)] 
```

然后在实际的 OurNewObject 类上添加这个属性

```
[System.ComponentModel.DataObject] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T06:09:26.267

尝试将`DataKeyNames`（添加主键）属性添加到`GridView`，看看是否有效？

# version-control - cvs：工作版本与存储库版本？

> ID：303467
> 
> 赞同：1
> 
> 时间：2008-11-19T21:40:26.467
> 
> 标签：version-control, cvs

当我执行 cvs status 时，我会看到工作版本和存储库版本号。两者有什么区别，或者更确切地说，它们是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T22:03:27.747

*工作版本*只是您当前使用的版本。*存储库修订*是当前在存储库中的修订。

基本上，如果*存储库修订版*大于您的*工作修订版*，则有人已提交对该文件的更改，也许您应该更新您的版本，或者如果您稍后尝试提交自己的更改，您可能最终会发生冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T14:44:42.657

谢谢，这很有意义......除了：假设我有一个文件 A.java，最新版本是 1.10。我做了一个 cvs up -r1.9 A.java。cvs status 显示工作版本和存储库版本均为 1.9...

这是怎么回事？？

# php - 在 PHP 中如何清除 WSDL 缓存？

> ID：303488
> 
> 赞同：95
> 
> 时间：2008-11-19T21:46:57.733
> 
> 标签：php, soap, caching, wsdl

通过`php_info()`保存 WSDL 缓存的位置 ( `/tmp`)，但我不一定知道删除所有以 WSDL 开头的文件是否安全。

是的，我*应该*能够从 中删除所有内容`/tmp`，但我不知道如果我删除任何所有 WSDL 文件还会产生什么影响。

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2008-11-19T21:54:24.473

您可以安全地删除 WSDL 缓存文件。如果您希望防止将来缓存，请使用：

```
ini_set("soap.wsdl_cache_enabled", 0); 
```

或动态：

```
$client = new SoapClient('http://somewhere.com/?wsdl', array('cache_wsdl' => WSDL_CACHE_NONE) ); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-02-01T01:59:24.720

删除服务器上文件夹中的所有`wsdl*`文件。`/tmp`

对于 php.ini 中定义的所有缓存文件，WSDL 文件都缓存在您的默认位置。与您的会话文件相同的位置。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-04-16T21:30:38.787

如果您已经部署了代码或无法更改任何配置，则可以从 wsdl 中删除所有临时文件：

```
rm /tmp/wsdl-* 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-08-01T10:34:00.163

我建议在 wsdl url 中使用 cache-buster。

在我们的应用程序中，我们在 wsdl url 中使用 SVN Revision id，以便客户端立即知道更改的结构。这适用于我们的应用程序，因为每次我们更改服务器端时，我们还需要相应地调整客户端。

```
$client = new SoapClient('http://somewhere.com/?wsdl&rev=$Revision$'); 
```

这需要正确配置 svn。并非所有存储库都默认启用此功能。

如果您不对这两个组件（服务器、客户端）负责，或者您不使用 SVN，您可能会在 wsdl url 中找到另一个可以用作缓存破坏器的指标。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-07-26T15:09:37.647

仅出于文档的原因：

我现在（2014 年）观察到，在所有这些有价值且正确的方法中，只有一种方法是成功的。我在服务器上的 WSDL 中添加了一个函数，但客户端无法识别新函数。

*   添加`WSDL_CACHE_NONE`到参数没有帮助。
*   添加缓存破坏器没有帮助。
*   设置`soap.wsdl_cache_enabled`为 PHP ini 有帮助。

我现在不确定它是否是这三者的组合，或者某些功能是否实施得非常糟糕，因此它们可能随机无用，或者是否存在一些不理解的功能层次结构。

所以最后，希望你必须检查所有三个来解决这些问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-10T04:25:30.367

编辑您的`php.ini`文件，搜索`soap.wsdl_cache_enabled`并将值设置为`0`

```
[soap]
; Enables or disables WSDL caching feature.
; http://php.net/soap.wsdl-cache-enabled
soap.wsdl_cache_enabled=0 
```

# asp.net - 以编程方式更改 DataGridView 的文化？

> ID：303491
> 
> 赞同：0
> 
> 时间：2008-11-19T21:47:52.443
> 
> 标签：asp.net, datagridview, settings, culture

我想根据用户选择的货币组合框的货币更改我的 DataGridView 上的定价列。

目前，价格列的格式为“C2”。这默认看起来像“$ 1.00”。

但是，如果我的用户要将货币切换为英镑，我想显示英镑符号（“£”）而不是美元符号（“$”），因此最终结果将是 £1.00 .

有关如何更改 DataGridView 的文化的任何建议？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T11:54:32.627

您正在寻找[System.Globalization](http://System.Globalization)。有很多不同的选择......

如果您只想为该特定元素更改它：

```
 //Label example but theory is the same
    [CultureInfo][2] ci = new CultureInfo("en-GB");
    double myMoney = 100.00;
    this.Label1.Text = myMoney.ToString("C2", ci); 
```

如果您想为所有内容更改它，那么您可以

```
 //Will format everything
     string strCulture = "en-GB";//Session["culture"].ToString();
     [CultureInfo][3] ci = new CultureInfo(strCulture);
     Thread.CurrentThread.[CurrentCulture][4] = ci ;
     Thread.CurrentThread.[CurrentUICulture][5] = ci;
     double myMoney = 100.00;
     this.Label1.Text = myMoney.ToString("C2"); 
```

在 DataGird 中，如果您尝试格式化数据绑定行，则需要挂钩 onDataBound 事件并以这种方式重新格式化，因为我不相信您可以将参数传递为：DataFormatString = "{0:c,en-国标}

像这样的东西应该可以解决问题（未经测试）

```
 protected void gridView_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        //Define CultureInfo in page scope just put in example for reference
        [CultureInfo][6] ci = new CultureInfo("en-GB");
        if (e.Row.RowType == DataControlRowType.DataRow)
            ((Label)e.Row.FindControl("myMoney")).Text.ToString("C2", ci);
   } 
```

**或者**

如果您要从 DataTable 绑定，则可以明确设置[DataTable Cultureinfo](http://msdn.microsoft.com/en-us/library/system.data.datatable.locale.aspx)

```
CultureInfo ci = new CultureInfo("en-GB");
myTable.Locale = ci; 
```

如果您正在寻找系统范围的文化支持（我认为您不是但值得一提），那么您可以查看使用[资源文件](http://msdn.microsoft.com/en-us/library/ms247246.aspx)

[简单的例子](http://www.c-sharpcorner.com/UploadFile/ankithakur/Globalization_Localization_in_DotNet_CSharp07032006023510AM/Globalization_Localization_in_DotNet_CSharp.aspx)是：

```
ResourceManager rm = ResourceManager.CreateFileBasedResourceManager("resource", "path to resouce files", null);
this.Label1.Text = rm.GetString("name"); 
```

# c# - C#调试时我得到“请求的操作需要提升”，为什么？昨天还好！

> ID：303492
> 
> 赞同：1
> 
> 时间：2008-11-19T21:48:06.000
> 
> 标签：c#, windows-vista

C＃

当我今天尝试调试我的程序时，我得到“请求的操作需要提升”（当然是 Vista）。为什么是今天？我没有更改任何对注册表或硬盘驱动器的读/写操作，我应该在哪里查看？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T21:57:39.007

如果只是 Visual Studio 抱怨（而不是代码的潜在安全问题），则可以将 Visual Studio 设置为[自动以 admin 身份运行](https://stackoverflow.com/questions/258728/request-admin-privileges-for-java-app-on-windows-vista#258863)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T21:59:38.597

刚刚编译了 exe，现在 exe 需要在 VS 之外进行提升！与本地 PC 的唯一交互是从注册表的用户部分读取，但那是在几天前它在没有提升的情况下工作的时候。

谢谢

# c# - C# vs VB.NET - 处理空结构

> ID：303502
> 
> 赞同：23
> 
> 时间：2008-11-19T21:50:35.760
> 
> 标签：c#, vb.net, nothing

我遇到了这个问题，想知道是否有人可以解释为什么它在 VB.NET 中有效，而我认为它应该会失败，就像在 C# 中一样

```
//The C# Version

struct Person {
    public string name;
}
...
Person someone = null; //Nope! Can't do that!!
Person? someoneElse = null; //No problem, just like expected 
```

但是在 VB.NET 中...

```
Structure Person
    Public name As String
End Structure
...
Dim someone As Person = Nothing 'Wha? this is okay? 
```

Nothing 与 null ( *Nothing != null - LOL?)*是否不同，或者这只是两种语言之间处理相同情况的不同方式？

为什么或两者之间的处理方式有所不同，这使得这在一个中可以解决，而在另一个中则不行？

**[更新]**

鉴于一些评论，我对此更加混乱......似乎如果你想在VB.NET中允许某些东西为空，你实际上必须使用Nullable......所以例如......

```
'This is false - It is still a person'
Dim someone As Person = Nothing
Dim isSomeoneNull As Boolean = someone.Equals(Nothing) 'false'

'This is true - the result is actually nullable now'
Dim someoneElse As Nullable(Of Person) = Nothing
Dim isSomeoneElseNull As Boolean = someoneElse.Equals(Nothing) 'true' 
```

太诡异了……

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-19T21:55:10.650

如果我没记错的话，VB 中的“Nothing”表示“默认值”。对于值类型，这是默认值，对于引用类型，这将是 null。因此，没有为结构分配任何内容根本没有问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-19T21:57:46.480

`Nothing`大致相当于`default(T)`对于相关类型。（刚刚检查过，字符串也是如此 - 即`Nothing`字符串上下文中的空引用。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T22:01:19.170

我试图在 MSDN 上搜索它，但在 VB 端找不到任何相关内容。在 C# 上搜索“struct”时，它清楚地返回它是一个值类型，并且不能赋值为 null，因为......它是一个值。

但是，在查看 VB.NET 关键字“结构”时，它并没有说“值类型”。相反，它说

> Structure 语句定义您可以自定义的复合值类型。

所以……对象？

那将是我的猜测。我想引用这种行为，但找不到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T22:00:23.150

此外，结构是值类型（很像 int、char 等），因此不可为空。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-06-29T04:03:18.573

因为一个结构可能由几种不同的类型组成（不是单个值类型，而是几种不同类型的可能组合），所以询问它是否为“无”会破坏使用“无”的逻辑。没有任何测试会根据您正在测试的类型而有所不同，因此复杂类型不符合使用“无”的逻辑。然而，对于这种类型的测试，即结构的所有组件成员都处于各自的“Nothing”值，我们使用函数“IsNothing”。例如：

```
Public Class Employees
    Public Structure EmployeeInfoType
       Dim Name As String    ' String
       Dim Age as Integer    ' Integer
       Dim Salary as Single  ' Single
    End Structure

    Private MyEmp as New EmployeeInfoType

    Public Function IsEmployeeNothing(Employee As EmployeeInfoType) As Boolean
       If **IsNothing**(Employee) Then
          Return True
       Else
          Return False
       End If
    End Function
End Class 
```

# xml - 如何防止 XML::XPath 在处理 XML 文件时获取 DTD？

> ID：303510
> 
> 赞同：12
> 
> 时间：2008-11-19T21:52:15.740
> 
> 标签：xml, perl, dtd

我的 XML ( **a.xhtml** ) 像这样开始

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
... 
```

我的代码是这样开始的

```
use XML::XPath;

use XML::XPath::XMLParser;

my $xp = XML::XPath->new(filename => "a.xhtml");

my $nodeset = $xp->find('/html/body//table'); 
```

它非常慢，而且它花费大量时间来获取 DTD ( [http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd](http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd) )。

有没有办法在 Perl XML:: 系列中显式声明 HTTP 代理服务器？我讨厌修改原始的**a.xhtml**文档，就像拥有 DTD 的本地副本一样。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-20T10:08:59.793

XML::XPath 基于 XML::Parser。XML::Parser 中有一个选项可以不使用 LWP 来解析外部实体（例如 DTD）。XML::XPath 允许您传递一个 XML::Parser 对象，以用作解析器。

所以你可以这样写：

```
my $p = XML::Parser->new( NoLWP => 1);
my $xp= XML::XPath->new( parser => $p, filename => "a.xhtml"); 
```

请注意，在这种情况下，您将丢失除数字实体和默认实体（>、<、&、' 和“）之外的所有实体。解析器不会抱怨，但它们会默默消失（尝试在表中包含 α 并打印例如）。

事实上，您可能不应该使用未积极维护的 XML::XPath。

试试 XML::LibXML，如果你安装 libxml2 没有问题，它的接口和 XML::XPath 非常相似，因为它们都实现了 DOM。XML::LibXML 也比 XML::XPath 强大得多，并且启动速度更快。如果您想要一个基于 expat/XML::Parser 的模块，您可能想看看 XML::Twig（这是公然的自我推销，因为我是该模块的作者，抱歉）。同样对于 HTML/dodgy XHTML，您可以使用 HTML::TreeBuilder，它添加了 HTML::TreeBuilder::XPath（也是我的），支持 XPath。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-08T02:26:57.557

porneL 的回应似乎是正确的。（www.w3.org 已经开始用 30 秒来响应我的每个查询（当它不只是放弃时），当 XML::XPath 最终检索到完整的 XHTML 集时……！）此外，mirod 的想法有效， 也：

```
use XML::XPath;
use XML::Catalog;

my $parser = new XML::Parser;
my $catalog_handler = new XML::Catalog("xhtml1-20020801/DTD/xhtml.soc")->get_handler($parser);
$parser->setHandlers("ExternEnt" => $catalog_handler);
my $xp = new XML::XPath(xml => $xml, parser => $parser); 
```

[从 ⟨URL： http](http://www.w3.org/TR/xhtml1/dtds.html) ://www.w3.org/TR/xhtml1/dtds.html ⟩添加一份“完整的 DTD 文件集以及 XML 声明和 SGML 开放目录”的副本⟩，尽情享受吧！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T22:22:54.993

通常是通过设置本地[XML 目录](http://en.wikipedia.org/wiki/XML_Catalog)来完成的。

基于 libxml 的解析器支持它，因此如果您遵循 mirod 的建议，您将能够在没有网络访问的情况下获得命名实体和验证工作。

# build-process - CruiseControl.net -- 如何在构建期间签入代码

> ID：303511
> 
> 赞同：7
> 
> 时间：2008-11-19T21:52:58.970
> 
> 标签：build-process, cruisecontrol.net

我正在设置 CruiseControl.NET 并且在构建期间我想修改我的 version.txt 文件并将其签入。当我这样做时，CruiseControl.NET 不知道此签入是由构建完成的，所以下一个当它检查源时，它会再次看到有修改和重建（我在项目构建中设置了 IfModificationExists）。如何告诉 CruiseControl.NET 签入这个文件或让它知道这个文件没问题，这样它就不会继续重新触发构建？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T22:36:55.137

您可以在项目中使用 excludeFilters 将 version.txt 文件排除在触发构建之外。

```
<sourcecontrol type="filtered">
    <sourceControlProvider type="svn">
       ...        
    </sourceControlProvider>
    <exclusionFilters>
        <pathFilter>
            <pattern>**/Version.txt</pattern>
        </pathFilter>
    </exclusionFilters>
</sourcecontrol> 
```

文档可在以下位置获得：

[http://www.cruisecontrolnet.org/projects/ccnet/wiki/Filtered](http://www.cruisecontrolnet.org/projects/ccnet/wiki/Filtered)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T22:02:25.550

我没有使用 Subversion，我使用的是 TFS。

Version.txt 包含“1.0.5.3”，这是当前的内部版本号。当有人签出进行构建时，他们将使用 1.0.5.3 作为修订版。在服务器上，它将修改内部版本号，将其存储在 version.txt 中并重新签入，以便每个人的版本都升级到该级别。例如，它将是 1.0.5.4"。

我基本上想要一种方法来告诉 CCNet 签入文件并在查找未来修改时忽略它。

# groovy - Groovy 的隐藏功能？

> ID：303512
> 
> 赞同：78
> 
> 时间：2008-11-19T21:53:57.767
> 
> 标签：groovy

似乎 Groovy 在这个线程中被遗忘了，所以我只会问 Groovy 相同的问题。

*   尝试限制对 Groovy 核心的回答
*   每个答案一个功能
*   提供功能的示例和简短描述，而不仅仅是文档链接
*   使用粗体标题作为第一行标记特征

也可以看看：

1.  [Python的隐藏特性](https://stackoverflow.com/questions/101268/hidden-features-of-python)
2.  [Ruby 的隐藏特性](https://stackoverflow.com/questions/63998/hidden-features-of-ruby)
3.  [Perl 的隐藏特性](https://stackoverflow.com/questions/161872/hidden-features-of-perl)
4.  [Java的隐藏特性](https://stackoverflow.com/questions/15496/hidden-features-of-java)

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-11-19T22:31:41.950

**使用扩展点运算符**

```
def animals = ['ant', 'buffalo', 'canary', 'dog']
assert animals.size() == 4
assert animals*.size() == [3, 7, 6, 3] 
```

这是`animals.collect { it.size() }`.

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-11-20T11:54:38.787

**with**方法允许将其变为：

```
 myObj1.setValue(10)
 otherObj.setTitle(myObj1.getName())
 myObj1.setMode(Obj1.MODE_NORMAL) 
```

进入这个

```
 myObj1.with {
    value = 10
    otherObj.title = name
    mode = MODE_NORMAL
 } 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-11-19T22:07:37.660

使用哈希作为伪对象。

```
def x = [foo:1, bar:{-> println "Hello, world!"}]
x.foo
x.bar() 
```

结合鸭子打字，你可以用这种方法走很长的路。甚至不需要抽出“as”运算符。

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2008-11-20T03:55:20.203

有人知道**猫王**吗？

```
def d = "hello";
def obj = null;

def obj2 = obj ?: d;   // sets obj2 to default
obj = "world"

def obj3 = obj ?: d;  // sets obj3 to obj (since it's non-null) 
```

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2008-11-21T05:52:05.570

找出对象上有哪些方法就像询问元类一样简单：

```
"foo".metaClass.methods.name.sort().unique() 
```

印刷：

```
["charAt", "codePointAt", "codePointBefore", "codePointCount", "compareTo",
 "compareToIgnoreCase", "concat", "contains", "contentEquals", "copyValueOf", 
 "endsWith", "equals", "equalsIgnoreCase", "format", "getBytes", "getChars", 
 "getClass", "hashCode", "indexOf", "intern", "lastIndexOf", "length", "matches", 
 "notify", "notifyAll", "offsetByCodePoints", "regionMatches", "replace", 
 "replaceAll", "replaceFirst", "split", "startsWith", "subSequence", "substring", 
 "toCharArray", "toLowerCase", "toString", "toUpperCase", "trim", "valueOf", "wait"] 
```

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2010-08-31T01:28:12.327

要拦截缺少的静态方法，请使用以下命令

```
 Foo {
    static A() { println "I'm A"}

     static $static_methodMissing(String name, args) {
        println "Missing static $name"
     }
 }

Foo.A()  //prints "I'm A"
Foo.B()  //prints "Missing static B" 
```

-*肯*

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2012-10-04T14:10:03.367

**解构**

它在 Groovy 中可能被称为其他东西；它在clojure中被称为解构。你永远不会相信它会有多方便。

```
def list = [1, 'bla', false]
def (num, str, bool) = list
assert num == 1
assert str == 'bla'
assert !bool 
```

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2008-11-20T07:13:38.807

对于使用 groovy 测试 java 代码，对象图生成器非常棒：

```
def company = builder.company( name: 'ACME' ) {
   address( id: 'a1', line1: '123 Groovy Rd', zip: 12345, state: 'JV' )
   employee(  name: 'Duke', employeeId: 1 ){
      address( refId: 'a1' )
   }
} 
```

标准功能，但仍然非常好。

[对象图形构建器](http://webcache.googleusercontent.com/search?q=cache:groovy.codehaus.org/ObjectGraphBuilder)

（您确实需要提供 POJO 的任何属性，这些属性是`List`空列表的默认值，而不是`null`让构建器支持工作。）

* * *

## 回答 #9

> 赞同：19
> 
> 时间：2008-11-20T18:43:05.887

```
println 
"""
Groovy has "multi-line" strings.
Hooray!
""" 
```

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2008-11-20T11:46:24.777

与 Java 不同的是，在 Groovy 中，任何东西都可以在**switch**语句中使用，而不仅仅是原始类型。在一个典型的*eventPerformed*方法中

```
switch(event.source) {
   case object1:
        // do something
        break
   case object2:
        // do something
        break
} 
```

* * *

## 回答 #11

> 赞同：15
> 
> 时间：2008-11-21T05:47:41.273

在 groovy 1.6 中，正则表达式适用于所有闭包迭代器（如 each、collect、inject 等），并允许您轻松使用捕获组：

```
def filePaths = """
/tmp/file.txt
/usr/bin/dummy.txt
"""

assert (filePaths =~ /(.*)\/(.*)/).collect { full, path, file -> 
        "$file -> $path"
    } ==  ["file.txt -> /tmp", "dummy.txt -> /usr/bin"] 
```

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2011-08-09T17:19:09.053

**使用宇宙飞船操作员**

我喜欢[Spaceship 运算符](http://en.wikipedia.org/wiki/Spaceship_operator)，对各种自定义排序场景很有用。[这里](http://mrhaki.blogspot.com/2009/08/groovy-goodness-spaceship-operator.html)有一些使用示例。它特别有用的一种情况是使用多个字段在对象的运行中创建比较器。例如

```
def list = [
    [ id:0, first: 'Michael', last: 'Smith', age: 23 ],
    [ id:1, first: 'John', last: 'Smith', age: 30 ],
    [ id:2, first: 'Michael', last: 'Smith', age: 15 ],    
    [ id:3, first: 'Michael', last: 'Jones', age: 15 ],   
]

// sort list by last name, then first name, then by descending age
assert (list.sort { a,b -> a.last <=> b.last ?: a.first <=> b.first ?: b.age <=> a.age })*.id == [ 3,1,0,2 ] 
```

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2008-11-20T18:56:02.960

闭包可以让所有旧的资源管理的try-finally游戏消失。文件流在块结束时自动关闭：

```
new File("/etc/profile").withReader { r ->
    System.out << r
} 
```

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2013-06-28T17:38:42.227

GDK`groovy.transform`包内的转换提供的功能，例如：

*   [`@Immutable`](http://groovy.codehaus.org/gapi/groovy/transform/Immutable.html)：@Immutable 注释指示编译器执行 AST 转换，该转换添加必要的 getter、构造函数、equals、hashCode 和其他通常在创建具有已定义属性的不可变类时编写的辅助方法。
*   [`@CompileStatic`](http://groovy.codehaus.org/gapi/groovy/transform/CompileStatic.html)：这将让 Groovy 编译器使用 Java 风格的编译时检查，然后执行静态编译，从而绕过 Groovy 元对象协议。
*   [`@Canonical`](http://groovy.codehaus.org/gapi/groovy/transform/Canonical.html)：@Canonical 注释指示编译器执行 AST 转换，将位置构造函数、equals、hashCode 和漂亮的打印 toString 添加到您的类。

其他：

*   [`@Slf4j`](http://groovy.codehaus.org/gapi/groovy/util/logging/Slf4j.html)此本地转换使用 LogBack 日志记录为您的程序添加了日志记录功能。对名为 log 的未绑定变量的每个方法调用都将映射到对记录器的调用。
*   [Groovy 的 XML Slurper](http://groovy.codehaus.org/Reading+XML+using+Groovy%27s+XmlSlurper)：轻松解析 XML。杀手级功能！

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2009-06-15T13:59:39.077

**基于闭包的接口实现**

如果您有一个类型化的引用，例如：

```
MyInterface foo 
```

您可以使用以下方法实现整个接口：

```
foo = {Object[] args -> println "This closure will be called by ALL methods"} as MyInterface 
```

或者，如果你想分别实现每个方法，你可以使用：

```
foo = [bar: {-> println "bar invoked"}, 
    baz: {param1 -> println "baz invoked with param $param1"}] as MyInterface 
```

* * *

## 回答 #16

> 赞同：12
> 
> 时间：2010-09-17T21:32:46.920

您可以使用 toSpreadMap() 将列表转换为映射，这在列表中的顺序足以确定与其关联的键和值时很方便。请参见下面的示例。

```
def list = ['key', 'value', 'foo', 'bar'] as Object[]
def map = list.toSpreadMap()

assert 2 == map.size()
assert 'value' == map.key
assert 'bar' == map['foo'] 
```

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2014-01-16T12:05:34.600

从列表中删除`null`值

```
def list = [obj1, obj2, null, obj4, null, obj6]
list -= null
assert list == [obj1, obj2, obj4, obj6] 
```

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2013-11-16T17:17:42.437

[@代表](http://webcache.googleusercontent.com/search?q=cache:groovy.codehaus.org/Delegate%2Btransformation)

```
class Foo {
    def footest() { return "footest"}   
}

class Bar {
    @Delegate Foo foo = new Foo()     
}

def bar = new Bar()

assert "footest" == bar.footest() 
```

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2014-01-15T20:03:13.913

我知道我来晚了，但我认为这里缺少一些不错的功能：

**集合加/减运算符**

```
def l = [1, 2, 3] + [4, 5, 6] - [2, 5] - 3 + (7..9)
assert l == [1, 4, 6, 7, 8, 9]

def m = [a: 1, b: 2] + [c: 3] - [a: 1]
assert m == [b: 2, c: 3] 
```

**切换语句**

```
switch (42) {
  case 0: .. break
  case 1..9: .. break
  case Float: .. break
  case { it % 4 == 0 }: .. break
  case ~/\d+/: .. break
} 
```

**范围和索引**

```
assert (1..10).step(2) == [1, 3, 5, 7, 9]
assert (1..10)[1, 4..8] == [2, 5, 6, 7, 8, 9]
assert ('a'..'g')[-4..-2] == ['d', 'e', 'f'] 
```

**Unicode 变量名**

```
def α = 123
def β = 456
def Ω = α * β
assert Ω == 56088 
```

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2015-04-13T12:23:49.300

**文字中的下划线**

在编写长字面数字时，很难弄清楚一些数字是如何组合在一起的，例如数千个单词的组等。通过允许您在数字文字中放置下划线，更容易发现这些组：

```
long creditCardNumber = 1234_5678_9012_3456L
long socialSecurityNumbers = 999_99_9999L
double monetaryAmount = 12_345_132.12
long hexBytes = 0xFF_EC_DE_5E
long hexWords = 0xFFEC_DE5E
long maxLong = 0x7fff_ffff_ffff_ffffL
long alsoMaxLong = 9_223_372_036_854_775_807L
long bytes = 0b11010010_01101001_10010100_10010010 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2008-11-19T22:53:47.397

使用隐式参数重新排序的参数是另一个不错的方法。

这段代码：

```
def foo(Map m=[:], String msg, int val, Closure c={}) {
  [...]
} 
```

创建所有这些不同的方法：

```
foo("msg", 2, x:1, y:2)
foo(x:1, y:2, "blah", 2)
foo("blah", x:1, 2, y:2) { [...] }
foo("blah", 2) { [...] } 
```

和更多。将命名和序数参数置于错误的顺序/位置是不可能搞砸的。

当然，在 "foo" 的定义中，你可以从 "String msg" 和 "int val" 中去掉 "String" 和 "int" -- 我只是为了清楚起见把它们留在里面。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2011-10-25T16:17:27.313

我认为这是闭包作为参数和参数默认值的组合：

```
public void buyItems(Collection list, Closure except={it > 0}){
  list.findAll(){except(it)}.each(){print it}
}
buyItems([1,2,3]){it > 2}
buyItems([0,1,2]) 
```

打印：“312”

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2013-03-08T13:57:26.423

**在方法参数中使用扩展运算符**

这在将代码转换为数据时很有帮助：

```
def exec(operand1,operand2,Closure op) {
    op.call(operand1,operand2)
}

def addition = {a,b->a+b}
def multiplication = {a,b->a*b}

def instructions = [
     [1,2,addition],
     [2,2,multiplication]
]

instructions.each{instr->
    println exec(*instr)
} 
```

这种用法也很有帮助：

```
String locale="en_GB"

//this invokes new Locale('en','GB')
def enGB=new Locale(*locale.split('_')) 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2015-05-06T10:32:09.210

**记忆**

记忆是一种优化技术，包括存储昂贵的函数调用的结果，并在使用相同参数再次调用函数时返回缓存的结果。

有一个无限版本，它将缓存它所看到的任何一对（输入参数，返回值）；和一个有限的版本，它将使用 LRU 缓存缓存最后看到的 N 个输入参数及其结果。

方法的记忆：

```
import groovy.transform.Memoized

@Memoized
Number factorial(Number n) {
    n == 0 ? 1 : factorial(n - 1)
}

@Memoized(maxCacheSize=1000)
Map fooDetails(Foo foo) {
    // call expensive service here
} 
```

闭包的记忆：

```
def factorial = {Number n ->
    n == 0 ? 1 : factorial(n - 1)
}.memoize()

fooDetails = {Foo foo ->
    // call expensive service here
}.memoizeAtMost(1000) 
```

[Wikipedia 页面](http://en.wikipedia.org/wiki/Memoization)包含有关在计算机科学中使用 Memoization 的大量信息。我将只指出一个简单的实际用途。

**将常量的初始化推迟到最后可能的时刻**

有时您有一个无法在类定义或创建时初始化的常量值。例如，常量表达式可能会使用来自不同类的另一个常量或方法，在您的类初始化之后，它们将被其他东西（Spring 等）插入。

在这种情况下，您可以将常量转换为 getter 并用`@Memoized`. 它只会计算一次，第一次被访问，然后缓存和重用值：

```
import groovy.transform.Memoized

@Memoized
def getMY_CONSTANT() {
    // compute the constant value using any external services needed
} 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2012-11-20T09:34:54.520

Groovy 可以像 Javascript 一样工作。您可以通过闭包拥有私有变量和函数。您还可以使用闭包对函数进行柯里化。

```
class FunctionTests {

def privateAccessWithClosure = {

    def privVar = 'foo'

    def privateFunc = { x -> println "${privVar} ${x}"}

    return {x -> privateFunc(x) } 
}

def addTogether = { x, y ->
    return x + y
}

def curryAdd = { x ->
    return { y-> addTogether(x,y)}
}

public static void main(String[] args) {
    def test = new FunctionTests()

    test.privateAccessWithClosure()('bar')

    def curried = test.curryAdd(5)

    println curried(5)
}
} 
```

输出：

富吧 10

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2014-03-23T09:53:22.023

**动态方法调用**

您可以使用带有名称的字符串调用方法

```
class Dynamic {
    def one() { println "method one()" }
    def two() { println "method two()" }
}

def callMethod( obj, methodName ) {
    obj."$methodName"()
}

def dyn = new Dynamic()

callMethod( dyn, "one" )               //prints 'method one()'
callMethod( dyn, "two" )               //prints 'method two()'
dyn."one"()                            //prints 'method one()' 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2014-03-23T19:10:51.200

如何在 groovy 中用几行代码构建 JSON 树？

1）用自引用`withDefault`闭包定义你的树

```
def tree // declare  first before using a self reference
tree = { ->  [:].withDefault{ tree() } } 
```

2) 创建自己的 JSON 树

```
frameworks = tree()
frameworks.grails.language.name = 'groovy'
frameworks.node.language.name = 'js'

def result =  new groovy.json.JsonBuilder(frameworks) 
```

这使：`{"grails":{"language":{"name":"groovy"}},"node":{"language":{"name":"js"}}}`

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2015-04-13T12:28:48.080

**安全导航操作员**

安全导航运算符用于避免 NullPointerException。通常，当您有一个对象的引用时，您可能需要在访问该对象的方法或属性之前验证它不为空。为避免这种情况，安全导航运算符将简单地返回 null 而不是抛出异常，如下所示：

```
def person = Person.find { it.id == 123 }        // find will return a null instance    
def name = person?.name                          // use of the null-safe operator prevents from a NullPointerException, result is null 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2016-02-11T07:34:46.090

## 多变量减速

1)单行多变量声明

```
def (a,b,c) = [1,2,3] 
```

2）使用不同的类型声明。

```
def (String a, int b) = ['Groovy', 1] 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2015-12-15T15:04:58.763

## **猫王算子**

**“猫王算子”**是三元算子的缩写。这很方便的一个例子是，如果表达式解析为 false（如在 Groovy 中），则返回一个“合理的默认”值。一个简单的示例可能如下所示：

使用三元运算符，您必须重复要分配的值

```
displayCity = user.city ? user.city: 'UnKnown City' 
```

使用 Elvis 运算符，如果不为假，则使用经过测试的值

```
displayCity = user.city ?: 'UnKnown City' 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2015-12-15T15:23:05.733

## 强制运算符

强制运算符 (as) 是强制转换的一种变体。强制将对象从一种类型转换为另一种类型，但它们不兼容赋值。举个例子：

Integer x = 123
String s = (String) x
Integer 不可分配给 String，因此**它将在运行时产生 ClassCastException** 这可以通过使用强制来修复：

Integer x = 123 String s = **x as String**
Integer 不可分配给 String，但使用 as 会将其强制为 String

# delphi - 是否应该将 GExperts 功能合并到 Delphi 中？

> ID：303515
> 
> 赞同：6
> 
> 时间：2008-11-19T21:54:40.667
> 
> 标签：delphi, gexperts

我最近升级到 Delphi 2009 并且很失望地发现我不能轻易地用另一个 VCL 组件替换一个 VCL 组件。最好的回答是[GExperts](http://www.gexperts.org)可以用来做这件事。

请求 Embarcadero 将 GExperts 的部分或全部功能直接整合到 Delphi 中是否值得？您最常使用他们的哪些“专家”并且希望在 Delphi 中看到？

还是 GExperts 最好作为社区开源插件保留？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-19T22:16:10.200

我也投票支持 grep 搜索和过程窗口。可能首先是程序窗口

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-20T21:55:11.803

您最希望将 GExperts 中的哪些功能包含在 Delphi 中？我建议您列出您的前 10 个功能的优先级列表。然后跳到 Quality Central ( [http://qc.codegear.com](http://qc.codegear.com) )，看看它们是否已经被添加为建议，如果是，投票给它们。如果不能随意继续添加它们。这些信息会定期被挖掘和查询，不仅是产品缺陷，也是我们从客户那里了解产品改进的一种方式。投票系统帮助我们优先规划我们的工作和产品周期。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-20T01:01:29.057

我对此投反对票。我认为，由于他们的资源有限，他们最好专注于核心语言——平台改进，因为这些方面的封闭性，社区无法提供帮助。

社区已经承担了这个高质量插件的负担，我认为他们应该做的就是以明确的方式推广它（即欢迎页面上的链接）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T22:48:13.430

我希望看到支持的代码格式（Gexperts 中 DelForEx 的实验端口）和一些帮助管理使用子句的功能。

我不介意 Delphi 的 Find in Files，但我喜欢能够在 IDE 之外使用 Gexperts grep 搜索。

有用的东西，如注释/取消注释代码和定位匹配的分隔符已经在 Delphi 中。

其余的大部分可能属于第三方附加组件，例如 Gexperts，以防止 IDE 因过多的“特殊”功能而混乱。诸如反转语句、替换组件或 ASCII 图表之类的事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-04T10:13:21.327

我想知道现在是不是 Delphi 有一个更好、更稳定的插件系统的时候了。我知道 Toolsapi 已经存在了很长一段时间并且运行良好，但它确实存在许多问题。

*   这真的很复杂。在 2009 年，我认为为 IDE 编写插件并不像在 ToolsAPI 上实现接口那样困难。
*   它不受支持并且可能会发生变化——尽管我不确定它是否曾经发生过实质性的变化，但存在变化的可能性这一事实并不是为它创造的动力。

为 IDE 提供一个简单的现代插件系统会很棒，这将使为 Delphi 编写插件变得轻而易举，这将真正增加好的插件的数量并成为 Delphi 开发的积极力量。我不认为 emb 应该花时间编写插件，但我确实认为他们应该花时间编写一个像样的插件框架。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-19T22:13:16.870

我的第一名 GExpert 是 Grep Search。

关闭第二个是过程列表窗口。

各种键盘快捷键和嵌入在编辑器中的工具栏也非常方便——我在那里有几个按钮；像 CPU 视图、项目管理器和作为下拉菜单的选择工具（如排序选择）。

有时我使用剪贴板历史记录窗口。

更罕见的是 ASCII 窗口。

其他我没有真正接触过的东西。

我知道程序列表也可以在 Delphi 2009 的结构窗格中找到，但不知何故，我可以按 Ctrl+G 来获得一个具有快速过滤和预览功能的窗口，这对我来说更有效率。

grep 也是一样——GExperts 的版本比标准的 Delphi 搜索功能更强大。

如果这两个（可能还有剪贴板历史）嵌入标准 Delphi 中，我可能不会再安装 GExperts。

但另一方面：我确实喜欢这些解决方案可作为开源使用的事实 - 例如，这允许我将部分过滤添加到 grep-search 中，否则对我来说这是不可能的......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-19T22:41:13.990

我以前也想过这个。许多 GExperts 功能非常有用，我认为它们应该是 Delphi 的一部分。我认为这归结为除了他们正在做的所有其他事情之外，还有人力来维护它内部的这些功能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-21T06:36:50.190

我投票支持程序窗口`CTRL`+`G`并将组件复制到源代码

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-04T12:45:35.887

请不要忘记来自 CnWizards 的资源。没有 CnPack 的源代码高度增强功能，无法在 Delphi 中编程，使用更清洁和程序列表。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-11-04T05:09:47.693

我也会投票给 GrepSearch，尤其是搜索设计表单的选项！就在最近，我需要在所有表单中的 TDatasources 中查找特殊的 DataSet 引用！我只能通过 GrepSearch 和激活在我的搜索中包含表单来做到这一点！那是我在 Delphi IDE 中真正错过的东西！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-21T16:39:20.617

对我来说最常用的功能是：Grep 搜索和替换组件。

但是，我认为在 IDE 中包含 gExperts 功能根本不是一个好主意。因为：

1.  gExperts 是独立的产品，可以在不到一分钟的时间内轻松安装
2.  QC 中有太多未修复的错误，无法将 Codegear 的团队时间用于改造自行车。
3.  最主要的是[GExperts license](http://www.gexperts.org/license.html)，它有以下几行：

> 您不得使用 GExperts 源代码开发专有或商业产品，包括这些产品的插件或库。您可以根据下列条款在开源项目中使用 GExperts 源代码。

这意味着，CodeGear 应该从头开始编写此功能。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-26T15:56:54.567

我也投票给程序窗口（`CTRL`+ `G`）。

在 GExperts 之前，我不知道没有它我是如何生活的。我也很喜欢 zip 备份功能……这是我的“源代码控制”:-)

# performance - 使用 O(1) 性能初始化一个 n 元素数组？

> ID：303519
> 
> 赞同：4
> 
> 时间：2008-11-19T21:55:56.357
> 
> 标签：performance

有人知道我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T22:03:13.113

如果您需要对一组元素中的每个元素执行某些操作`n`，那么您的性能不会比 O( `n`) 更好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T22:01:19.903

如果您的意思是“在与 N 无关的时间内初始化 N 项的密集数组”，那么它在物理上是不可能的。密集数组的存储空间随着项目的数量线性增长，初始化这个空间需要线性的时间。

您可以使用稀疏数组进行恒定时间初始化。这本质上是一个关联数组（或哈希图、字典或表，取决于语言），它在首次访问项目时对其进行初始化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T22:24:10.870

我认为这只是一个简单的语法问题。在 C++ 中，您可以这样做：

```
int foo[1000] = {0}; 
```

数组中的所有值现在都是 0

虽然它看起来像是在恒定时间内完成的，但它仍然是 O(n)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-21T13:56:58.240

如果您使用[Amortized Analysis](http://en.wikipedia.org/wiki/Amortized_analysis)计算所有未来读取操作的运行时间，则**可以**在 O(1) 中完成。您只需要按需初始化元素（第一次读取）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T22:38:13.963

实际上，这*是*可能的，但只有在硬件的帮助下。在软件上，您必须执行与 成比例的一些步骤`n`，因此它是`O(n)`；但是，在硬件上，您可以连线，以便并行设置数组的所有元素。

这实际上是时间/空间的权衡；以前需要`O(n)`时间，现在需要`O(n)`电路元件，但可以`O(1)`及时操作。

这实际上是一件很常见的事情。许多硬件都有一个复位输入，当它被置位时，会将整个硬件设置为已知状态。这可能涉及例如将整个内存归零。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-03T12:18:46.107

您可以在 O(1) 时间内使用常量值初始化数组。但它需要额外的内存。

看看[Initializing an array in constant time](https://eli.thegreenplace.net/2008/08/23/initializing-an-array-in-constant-time)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-09T01:14:32.643

# 可以办到！

**您可以在O(1) 最坏时间**和 O(1) 额外空间中初始化一个数组，并且可以改进为仅使用**1 个额外**的内存位。

两者都可以在本文中找到，在本文中进行**[简单](https://link.medium.com/Q8YbkDJX2bb)**解释，并在**[Farray](https://arxiv.org/abs/1709.08900)**项目中**[实现。](https://github.com/tomhea/farray)** 完全披露——最后两个是我写的。

它是最**先进的**Initializable 数组，并且*可能会保持不变*。上述论文证明，如果没有额外的位 - 填充（init）操作应该花费 Ө(n) 时间，即使对于摊销/随机算法也是如此。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-19T22:27:51.270

不，这在物理上是不可能的。但是，您可以使用向量指令使其花费一些 O(n * 1/k) 时间，其中 k 是向量设置器指令的宽度。那仍然是 O(n)，但常数缩小了。

# javascript - 间接远程图像

> ID：303541
> 
> 赞同：0
> 
> 时间：2008-11-19T22:00:38.017
> 
> 标签：javascript, image

我正在尝试创建一些 HTML 来显示我的服务器是否可以从 Internet 获得，绿灯 OK 红灯不可用。我可以为远程站点执行此操作，但不适用于我的家，我的路由器似乎阻止我通过我的静态 IP 地址返回家中。我想创建一些 HTML，以便从我的 ISP 而不是我自己的 LAN 中查看我的外观，更具体地说，我希望巴黎的老板知道巴黎服务器是否启动并运行。

```
<html>
<head><script language='JavaScript'>
// Begin
  function MyErr4(MyImage) {
      setTimeout(function() {       
        document.light4.src = 'http://www.myisp.uk/red.jpg';
      },300);
  }
// end
</script>

<img name='light4' src='http://mystaticip/2_lime.jpg'
    onerror='MyErr4(this)' border='0' width='30' /> 
```

不起作用，因为我在自己的局域网中运行它。我怎样才能编写一些在我的 ISP 处得到解决的代码。我尝试了 ASP，但 Javascript 得到了客户端解析。

请问有人喜欢评论吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T22:14:02.920

你从错误的角度解决问题。

根据定义，页面中的任何代码都将在客户端执行。

如果您需要在其他地方执行某些操作，则需要在其他地方使用外部服务器。这可以是一个非常简单的 http 服务器，您可以在页面上使用 XMLHttpRequest 进行查询，也可以是更精美的可以呈现完整状态页面的东西。

正如[另一个答案](https://stackoverflow.com/questions/303541/indirect-remote-images#303586)中所建议的，您应该考虑在第三方服务器上运行[Nagios 。](http://www.nagios.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T22:16:34.070

[您是否考虑过使用像Nagios](http://www.nagios.org/)这样的现有应用程序而不是编写自己的工具？我保证它将提供更多功能并且工作得更好。例如，您可以测试 Web 服务器是否返回可能表明数据库过载的状态代码 500（或其他错误），而不仅仅是检查它是否会响应请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T22:17:25.083

您确定您的服务器可以响应来自 LAN 外部的请求吗？听起来这是一个路由/防火墙问题，而不是代码问题。通常，对于大多数家庭网络，您会在路由器上启用端口转发，以将来自防火墙外部的请求发送到防火墙内的正确 IP。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T22:21:35.150

症状：“其他人可以访问我的服务器，但我无法在本地查看。”

问题：您有一个[Loopback Connection Error](http://www.dyndns.com/support/kb/loopback_connections.html)。

阅读链接及其解决方案。看看是否有帮助。

# .net - XML 反序列化问题

> ID：303548
> 
> 赞同：0
> 
> 时间：2008-11-19T22:02:25.127
> 
> 标签：.net, vb.net, xml-serialization

我有以下从 Web 服务发送给我的 xml。我正在使用 .NET 对其进行反序列化，但我收到一个异常，说它的格式错误。`There is an error in XML document (2, 2)` 现在，如果我理解正确，它不喜欢找到第一个`<error>`节点。

```
<?xml version="1.0" encoding="UTF-8"?>
<messages xmlns="http://www.w3.org/1999/xml">
  <error>error text</error>
  <message>message text</message>
</messages> 
```

我的代码如下所示，数据是`String`上面 XML 的版本：

```
Dim resp As cResponseMessage
Dim sr As New StringReader(data)
Dim xs As New XmlReaderSettings()

Dim xd As New XmlSerializer(GetType(cResponseMessage))
resp = xd.Deserialize(XmlTextReader.Create(sr, xs)) 
```

并且`cResponseMessage`只是一个具有`XMLRoot`属性的类和 2 个具有属性的`XMLElement`属性。这里没有什么花哨的，但它不想工作。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T22:29:36.103

这门课对我有用：

```
<XmlRoot(Namespace:="http://www.w3.org/1999/xml", ElementName:="messages")> _
Public Class cResponseMessage

    <XmlElement> _
    Public Property [error] As String
        Get
        Set(ByVal value As String)
    End Property

    <XmlElement> _
    Public Property message As String
        Get
        Set(ByVal value As String)
    End Property
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T22:07:19.440

在我看来，XML 文档 (2, 2) 中有一个错误，就像 <messages> 中的 m。

也许您没有在 cResponseMessage 中正确设置 XmlRoot？

# asp.net - 将 asp.net 控件的值绑定到代码隐藏函数

> ID：303554
> 
> 赞同：1
> 
> 时间：2008-11-19T22:05:36.853
> 
> 标签：asp.net

我有一个隐藏字段，我想绑定到页面代码后面的任何一个函数。我不太记得确切的语法，也无法通过谷歌找到答案。下面的代码是否正确？感谢。

```
print("<asp:HiddenField ID="dummy" Value='<%#Getdummy() %>' runat="server" />"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T22:36:11.363

你放的代码看起来很不错......

两步过程是......将隐藏字段添加到标记中

```
<asp:HiddenField ID="hdnId" runat="server" Value='<%# GetValue() %>'/> 
```

然后创建指定的方法签名...

```
protected string GetValue()
{
   return "something";
} 
```

希望这可以帮助 ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T22:25:04.257

如果您有带有 runat=server 的隐藏字段，您可以编写代码以在后面的代码中分配值（而不是在标记中）。

# c# - 使用接口将对象从一种类型转换为另一种类型？

> ID：303555
> 
> 赞同：9
> 
> 时间：2008-11-19T22:05:53.467
> 
> 标签：c#, .net, .net-3.5, interface, copying

假设我有两个具有相同接口的类：

```
interface ISomeInterface 
{
    int foo{get; set;}
    int bar{get; set;}
}

class SomeClass : ISomeInterface {}

class SomeOtherClass : ISomeInterface {} 
```

假设我有一个代表 SomeClass 的 ISomeInterface 实例。有没有一种简单的方法可以将其复制到 SomeOtherClass 的新实例中，而无需手动复制每个成员？

**更新：** 为了记录，我*没有*尝试将 SomeClass 的实例转换为 SomeOtherClass 的实例。我想做的是这样的：

```
ISomeInterface sc = new SomeClass() as ISomeInterface;
SomeOtherClass soc = new SomeOtherClass();

soc.foo = sc.foo;
soc.bar = soc.bar; 
```

我只是不想手动为每个对象做这些，因为这些对象有很多属性。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-19T22:27:59.053

您可以在每个类中创建隐式运算符来为您进行转换：

```
public class SomeClass
{
    public static implicit operator SomeOtherClass(SomeClass sc)
    {
        //replace with whatever conversion logic is necessary
        return new SomeOtherClass()
        {
            foo = sc.foo,
            bar = sc.bar
        }
    }

    public static implicit operator SomeClass(SomeOtherClass soc)
    {
        return new SomeClass()
        {
            foo = soc.foo,
            bar = soc.bar
        }
    }
    //rest of class here
} 
```

然后`SomeOtherClass soc = sc;`反之亦然。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-19T22:12:04.000

界面的意义不是不必这样做吗？您是否正在对 SomeOtherClass 的具体实现做些什么？不要使用具体的实现，而是使用接口，并且使用 SomeClass 或 SomeOther 类无关紧要。

除此之外，您能做的最好的事情是编写某种辅助函数（您仍然必须手动完成，或查看反射）复制接口上的每个属性，如下所示：

```
 public ISomeInterface CopyValues(ISomeInterface fromSomeClass, ISomeInterface toSomeOtherClass)
   {
    //copy properties here
    return toSomeOtherClass;
    } 
```

但是，我的第一直觉是远离实现并专注于使用您的界面，那么下面的内容就无关紧要了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T22:08:44.490

Reflection ... 循环遍历每个属性，并将其设置在另一个对象的相应属性上。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-19T23:31:37.397

查看乔对反射解决方案的回答。

我假设您使用的是 Visual Studio。

你熟悉 ctrl+shift+r 和 ctrl+shift+p 快捷键吗？如果没有， ctrl+shift+r 开始/结束录制击键宏。ctrl+shift+p 播放录制的宏。

当我设置了很多属性时，我所做的是将属性声明复制到我想要设置它们的位置并记录一个宏，用于将声明更改为 set 语句并将光标移动到下一行，然后我播放它直到我完成所有设置语句。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-19T22:10:19.760

不，要透明地将对象从一种类型转换（转换）为另一种类型，您拥有的对象的底层具体类必须从您尝试将其转换为的类继承，即使它们都实现相同的接口。

想一想，所有两个对象都必须具有共同点才能实现相同的接口是方法签名的相同子集。它们甚至可能没有（可能没有）具有相同的属性或数据字段。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-19T22:13:07.650

这不行吗？

```
class MyClass : ICloneable
{
public MyClass()
{

}
public object Clone() // ICloneable implementation
{
MyClass mc = this.MemberwiseClone() as MyClass;

return mc;
} 
```

您只需调用：MyClass.Clone()。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-19T23:10:41.917

“你能给我一个例子来说明我如何做到这一点（或者至少指出我要使用的正确方法）吗？我似乎无法在 MSDN 上找到它们”——Jason Baker

杰森，类似于以下内容：

```
var props = typeof(Foo)
            .GetProperties(BindingFlags.Public | BindingFlags.Instance);

foreach (PropertyInfo p in props)
{
     // p.Name gives name of property
} 
```

我建议编写一个工具来吐出复制构造函数所需的代码，而不是在运行时进行反射 - 这会降低性能。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-19T23:53:29.443

```
 ISomeInterface sc = new SomeClass() as ISomeInterface;
   SomeOtherClass soc = new SomeOtherClass();
   foreach (PropertyInfo info in typeof(ISomeInterface)
                                     .GetProperties(BindingFlags.Instance
                                                     |BindingFlags.Public))
   {
       info.SetValue(soc,info.GetValue(sc,null),null);
   } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-12-08T20:56:14.737

我确实喜欢以下内容，并且使用隐式运算符将一个对象转换为另一个对象非常有效：

```
课堂节目
    {
        静态无效主要（字符串 [] 参数）
        {
            Console.WriteLine("你好");
            ExecutionReport er = new ExecutionReport("ORDID1234",3000.43,DateTime.UtcNow);
            订单 ord = new Order();
            顺序 = 呃;
            Console.WriteLine("传输的值是：" + er.OrderId + "\t" + ord.Amount.ToString() + "\t" + ord.TimeStamp.ToString() + "\t");
            Console.ReadLine();
        }
    }

    公共课秩序
    {
        公共字符串 OrderId { 获取；放; }
        公共双金额{获取；放; }
        公共日期时间时间戳{获取；放; }
        公共静态隐式运算符 ExecutionReport(Order ord)
        {
            返回新的执行报告（）
            {
                OrderId = ord.OrderId,
                金额 = ord.Amount,
                时间戳 = ord.TimeStamp
            };
        }
        公共静态隐式运算符 Order(ExecutionReport er)
        {
            返回新订单（）
            {
                OrderId = er.OrderId,
                金额=呃.金额，
                时间戳 = er.TimeStamp
            };
        }

        公共秩序（）
        { }
    }

    公共类执行报告
    {
        公共字符串 OrderId { 获取；放; }
        公共双金额{获取；放; }
        公共日期时间时间戳{获取；放; }
        公共执行报告（）{}
        public ExecutionReport(string orderId,double amount, DateTime ts)
        {
            订单编号 = 订单编号；金额=金额；时间戳 = ts;
        }
    }

```

# c++ - C++ 格式宏/ 内联 ostringstream

> ID：303562
> 
> 赞同：15
> 
> 时间：2008-11-19T22:08:08.360
> 
> 标签：c++, format, printing, macros, ostringstream

我正在尝试编写一个允许我执行类似操作的宏：`FORMAT(a << "b" << c << d)`，结果将是一个字符串 - 与创建 ostringstream、插入`a...d`和返回相同`.str()`。就像是：

```
string f(){
   ostringstream o;
   o << a << "b" << c << d;
   return o.str()
} 
```

本质上，`FORMAT(a << "b" << c << d) == f()`.

首先，我试过：

```
1: #define FORMAT(items)                                                   \
   ((std::ostringstream&)(std::ostringstream() << items)).str() 
```

如果第一项是 C 字符串 ( `const char *`)，它将以十六进制打印字符串的地址，并且下一项将正常打印。如果第一项是 an `std::string`，它将无法编译（没有匹配的 operator `<<`）。

这：

```
2: #define FORMAT(items)                                                   \
   ((std::ostringstream&)(std::ostringstream() << 0 << '\b' << items)).str() 
```

给出看似正确的输出，但`0`and`\b`当然存在于字符串中。

以下似乎有效，但编译时带有警告（获取临时地址）：

```
3: #define FORMAT(items)                                                   \
   ((std::ostringstream&)(*((std::ostream*)(&std::ostringstream())) << items)).str() 
```

有谁知道为什么 1 打印 c-string 的地址并且无法使用`std::string`? 1和3本质上不是一样的吗？

我怀疑 C++0x 可变参数模板将成为`format(a, "b", c, d)`可能。但是现在有办法解决这个问题吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-19T22:58:14.343

这是我使用的。这一切都适合头文件中的一个整洁的类定义。

**更新：**感谢[litb](https://stackoverflow.com/users/34509/litb)对代码的重大改进。

```
// makestring.h:

class MakeString
{
    public:
        std::stringstream stream;
        operator std::string() const { return stream.str(); }

        template<class T>
        MakeString& operator<<(T const& VAR) { stream << VAR; return *this; }
};
```

以下是它的使用方法：

```
string myString = MakeString() << a << "b" << c << d;
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-20T17:03:09.757

你们几乎都已经搞定了。但这有点具有挑战性。所以让我试着总结一下你所说的......

* * *

这里的困难在于：

*   我们正在玩一个临时`ostringstream`对象，所以取地址是禁忌的。

*   因为它是临时的，所以我们`ostream`不能通过强制转换简单地转换为对象。

*   构造函数 [显然] 和`str()`都是类`ostringstream`方法。（是的，我们需要使用`.str()`。`ostringstream`直接使用对象最终会调用`ios::operator void*()`，返回类似指针的好/坏值，而不是字符串对象。）

*   `operator<<(...)`作为继承`ostream`方法和全局函数存在。在所有情况下，它都会返回一个`ostream&`引用。

*   这里的选择`ostringstream()<<"foo"`是继承的方法`ostream::operator<<(void* )`和全局函数`operator<<(ostream&,const char* )`。继承`ostream::operator<<(void* )`胜出，因为我们无法转换为`ostream`对象引用来调用全局函数。[向*coppro致敬*！]

* * *

因此，要实现这一目标，我们需要：

*   分配一个临时的`ostringstream`.
*   将其转换为`ostream`.
*   追加数据。
*   将其转换回`ostringstream`.
*   并调用`str()`.

* * *

***分配：*** `ostringstream()`。

***转换：*** 有多种选择。其他人建议：

*   `ostringstream() << std::string() // Kudos to *David Norman*`
*   `ostringstream() << std::dec // Kudos to *cadabra*`

***或者我们可以使用：***

*   `ostringstream() . seekp( 0, ios_base::cur )`
*   `ostringstream() . write( "", 0 )`
*   `ostringstream() . flush()`
*   `ostringstream() << flush`
*   `ostringstream() << nounitbuf`
*   `ostringstream() << unitbuf`
*   `ostringstream() << noshowpos`
*   或任何其他标准机械手。[ `#include <iomanip>`] [参考：请参阅此网页下方 1/3 的*“以格式插入数据” 。*](http://www.cplusplus.com/reference/iostream/ostream/operator%3C%3C.html)

***我们不能使用：***

*   ~~`operator<<( ostringstream(), "" )`~~
*   ~~`(ostream &) ostringstream()`~~

***附加：*** 现在直截了当。

***转换回来：*** 我们可以只使用`(ostringstream&)`. 但是a`dynamic_cast`会更安全。在不太可能发生的（不应该），以下`dynamic_cast`将触发核心转储。`NULL``.str()`

***调用`str()`：*** 猜。

* * *

把它们放在一起。

```
#define FORMAT(ITEMS)                                             \
  ( ( dynamic_cast<ostringstream &> (                             \
         ostringstream() . seekp( 0, ios_base::cur ) << ITEMS )   \
    ) . str() ) 
```

* * *

参考：

*   [IOstream 库](http://www.cplusplus.com/reference/iostream/)
*   [`ostringstream`](http://www.cplusplus.com/reference/iostream/ostringstream/)
*   [`ostream::operator<<()`](http://www.cplusplus.com/reference/iostream/ostream/operator%3C%3C/)

*   [类型转换教程](http://www.cplusplus.com/doc/tutorial/typecasting.html)
*   [Wiki: 类型转换](http://en.wikibooks.org/wiki/C%2B%2B_Programming/Type_Casting)

.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T22:26:22.147

您遇到的问题与不是 ostream 成员的事实有关`operator << (ostream&, char*)`，并且您的临时 ostream 实例无法绑定到非`const`引用。相反，它选择作为`void*`ostream 成员的重载，因此没有该限制。

最好的（但不是最简单或最优雅的，无论如何想象！）是使用 Boost 预处理器生成大量函数重载，每个函数都以大量对象为模板（包括已被省略并假设`using namespace std;`）：

```
#define MAKE_OUTPUT(z, n, data) \
    BOOST_PP_TUPLE_ELEM(2, 0, data) << BOOST_PP_CAT(BOOST_PP_TUPLE_ELEM(2, 1, data), n);

#define MAKE_FORMAT(z, n, data) \
    template <BOOST_PP_ENUM_PARAMS_Z(z, BOOST_PP_INC(n), typename T)> \
    inline string format(BOOST_PP_ENUM_BINARY_PARAMS_Z(z, BOOST_PP_INC(n), T, p)) \
    { \
      ostringstream s; \
      BOOST_PP_REPEAT_##z(z, n, MAKE_OUTPUT, (s, p)); \
      return s.str(); \
    } 
```

它不能保证完全工作（没有测试就写出来），但这基本上就是这个想法。然后，您调用`BOOST_PP_REPEAT(N, MAKE_FORMAT, ())`创建一系列函数，最多占用 N 个参数，这些参数将根据需要格式化您的字符串（将 N 替换为选择的整数。较高的值可能会对编译时间产生负面影响）。在您获得带有可变参数模板的编译器之前，这应该足够了。您应该阅读 boost 预处理器文档，它具有非常强大的功能来处理此类事情。（在调用调用生成函数之后，您可以随后`#undef`使用宏）`BOOST_PP_REPEAT`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T22:41:01.087

这是一个像 cadabra 这样的答案，它不会与 ostream 状态混淆：

```
#define FORMAT(items)     static_cast<std::ostringstream &>((std::ostringstream() << std::string() << items)).str() 
```

我相信 coppro 答案的第一段描述了为什么事情会这样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T22:30:31.950

这是一个有效的解决方案：

```
#define FORMAT(items)                                                   \
   ((std::ostringstream&)(std::ostringstream() << std::dec << items)).str() 
```

我不太了解第一个参数的行为。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-30T10:35:06.167

当我采用 mrree 的解决方案（标记为“首选”的解决方案、解释精美的解决方案以及适用于 G++ 的解决方案）时，我遇到了 MSVC++ 的问题：使用此宏构建的所有字符串最终都是空的。

几个小时（还有很多挠头并在这里问一个[“重新加载”](https://stackoverflow.com/questions/492475/inline-ostringstream-macro-reloaded)的问题）之后，我发现 seekp() 调用是罪魁祸首。我不确定 MSVC++ 有什么不同，但是替换

```
ostringstream().seekp( 0, ios_base::cur ) 
```

与卡达布拉的

```
ostringstream() << std::dec 
```

也适用于 MSVC++。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T22:31:36.050

为什么不只使用函数而不是宏？

# web-services - 使用 spring 来获取您的服务层 - 好主意吗？

> ID：303565
> 
> 赞同：0
> 
> 时间：2008-11-19T22:10:12.303
> 
> 标签：web-services, spring, architecture

假设我有服务层做休眠和数据库的东西。Silverlight 和 windows 客户端需要通过某种远程服务来获取服务层。如果可以直接获取它（在同一台机器、同一进程、类实例化上），ASP.NET 将会受益。

使用 spring 或其他工具通过 DI 容器“获取”您的服务层并能够在以后更改配置是一个好主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T22:15:54.867

绝对地。您应该有某种服务层使用的接口，然后您可以随时更改实现，只要它实现相同的接口，它应该是可互换的。

这就是接口和 DI 的好处，尤其是使用 Spring 这样的容器。更改实现后，只需配置 spring 以使用新的，然后就可以了。

* * *

更新因为评论太小：

好吧，我想这一切都取决于您的服务。问题是，如果你使用一个接口（比如在 NServiceBus 之上），你总是可以创建一个适配器来将你的 WCF 实现插入到接口中。

例如：

```
public interface IService {
   void DoSomething();
}

public class NServiceBusService : IService { 
   public void DoSomething() {
      //Some NServiceBusCode
   }
} 
```

现在（我猜，我对 spring.net 不是很熟悉），你可以让 Spring 使用 NServiceBusService 作为 IService 的实现。

现在您决定改为插入 WCF？你可以有一个 WCF 实现：

```
public class WCFService : IService { 
   public void DoSomething() {
      //Some WCF Code
   }
} 
```

现在您可以将 Spring 设置为将 WCFService 用于 IService 而不是 NServiceBusService。

或者，如果您的 WCFService 与 IService 的签名不匹配，则可能如下所示：

```
public class WCFService { 
   public void DoSomethingWCFStyle() {
      //Some WCF Code
   }
} 
```

然后你可以使用适配器模式来完成这项工作：

```
public class WCFServiceAdapter : IService { 
   private WCFService wcfService;

   public WCFServicAdapter(WCFService wcfService) {
      this.wcfService = wcfService;
   }

   public void DoSomething() {
      wcfService.DoSomethingWCFStyle();
   }
} 
```

无论如何，您可以通过多种方式注入这种依赖关系。困难的部分是您需要使用您的界面设置合同，并且您的对象必须遵守该合同，否则您将遇到麻烦。但是总有一种方法可以映射（例如，使用上面的适配器模式）对象，使其看起来像是实现了接口并使其工作。

# java - 比 O(n) 更好的范围相交算法？

> ID：303591
> 
> 赞同：24
> 
> 时间：2008-11-19T22:18:30.150
> 
> 标签：java, algorithm, search, big-o, interval-intersection

范围相交是一个简单但不平凡的问题。

它已经回答了两次：

*   [查找数字范围交点](https://stackoverflow.com/questions/224878/find-number-range-intersection)
*   [比较日期范围](https://stackoverflow.com/questions/143552/comparing-date-ranges)

第一个解决方案是 O(n)，第二个解决方案是用于数据库（当然小于 O(n)）。

我有同样的问题，但是对于一个大的 n 并且我不在数据库中。

这个问题似乎与[存储 2D 点以快速检索矩形内的点](https://stackoverflow.com/questions/303243/store-2d-points-for-quick-retrieval-of-those-inside-a-rectangle)非常相似，但我看不出它是如何映射的。

那么，您会将范围集存储在什么数据结构中，以便对范围的搜索成本低于 O(n)？（使用可用于 Java 的库的额外功劳）

**编辑：**

我想获得所有相交范围的子集，这意味着搜索范围可以与多个范围相交。

Java中需要小于O(n)的方法是：

```
public class RangeSet {
    ....
    public Set<Range> intersects(Range range);
    ....
} 
```

其中 Range 只是一个包含一对 int 开始和结束的类。

这不是一个不可能的问题，我已经有了解决方案，我只是想看看是否有更标准/更简单的方法

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-20T10:06:03.187

标准方法是使用[区间树](http://en.wikipedia.org/wiki/Interval_tree#With_an_Interval)。

> 在计算机科学中，区间树是保存区间的树数据结构。具体来说，它允许人们有效地找到与任何给定区间或点重叠的所有区间。它通常用于窗口查询，例如，在矩形视口内查找计算机地图上的所有道路，或查找 3D 场景内的所有可见元素。类似的数据结构是段树。
> 
> 简单的解决方案是访问每个区间并测试它是否与给定的点或区间相交，这需要 O(n) 时间，其中 n 是集合中的区间数。由于查询可能返回所有区间，例如，如果查询是与集合中所有区间相交的大区间，则这是渐近最优的；然而，我们可以通过考虑输出敏感算法做得更好，其中运行时间用 m 表示，m 是查询产生的间隔数。区间树的查询时间为 O(log n + m)，初始创建时间为 O(n log n)，同时将内存消耗限制为 O(n)。创建后，区间树可能是动态的，允许在 O(log n) 中有效地插入和删除一个区间。如果区间的端点在一个小的整数范围内（例如，在范围 [1,...,

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-20T00:00:19.197

**编辑：** 听起来这个解决方案或多或少[是一个区间树](http://en.wikipedia.org/wiki/Interval_tree#With_an_Interval)。可以在[此处](http://www.mit.edu/~emin/source_code/cpp_trees/index.html)找到更完整的区间树实现。

```
class TreeNode
{
public:
    long pivot;
    List<Range> leaves;  //Any ranges that intersect the pivot
    TreeNode left;        //Tree nodes that fall to the left of the pivot
    TreeNode right;       //Tree nodes that fall to the right of the pivot
}; 
```

准备 O(n log n):

1.  创建范围列表
2.  选择枢轴点（可能通过使用结束日期的排序列表。） ??
3.  建立你的树。

搜索：

1.  使用二分搜索查找 >= TestRange.End 的第一个主元
2.  遍历树直到枢轴> TestRange.Start

    2a. 将叶子添加到您的结果中。

* * *

例子：

范围：

*   0 - 2
*   1 - 2
*   2 - 3
*   1 - 4
*   2 - 4
*   0 - 5
*   4 - 5
*   2 - 6
*   3 - 7

树：

```
 4
               --------------+------------------
               3             |                 7
               |            1-4                |
               |            2-4                |
               |            0-5                |
               |            4-5                |
      ---------+------                 --------+--------
      2        |    null              6        |       null
 -----+----   2-3                 ----+----   3-7
null  |  null                   null  |  null    
     0-2                             2-6
     1-2 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-19T23:22:00.583

**非重叠范围：**

准备 O(n log n):

1.  制作范围的数组/向量。
2.  按范围的结尾对向量进行排序（通过按范围的开头排序来打破平局）

搜索：

1.  使用二分搜索查找 End 值为 >= TestRange.Start 的第一个范围
2.  迭代器从二分搜索开始，直到找到 Start > TestRange.End：

    2a. 如果当前范围在 TestRange 范围内，则将其添加到您的结果中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-20T00:10:32.187

**重叠范围：**

准备 O(n log n):

1.  制作范围的数组/向量。
2.  按范围的结尾对向量进行排序（通过按范围的开头排序来打破平局）
3.  制作第二个整数向量。这表示您可以停止搜索的点。

    ```
    int stop[size];
    stop[size-1] = Ranges[size - 1].start;
    for (int i = size - 2; i >= 0; i--)
    {
        stop[i] = min(Ranges[i].start, stop[i+1]);
    } 
    ```

搜索：

1.  使用二分搜索查找 End 值为 >= TestRange.Start 的第一个范围
2.  迭代器从二分查找开始，直到 stop[i] > TestRange.End：

    2a. 如果当前范围在 TestRange 范围内，则将其添加到您的结果中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T22:46:08.627

这取决于您的确切问题，在链接的问题中，不同的范围，没有共同部分，并且搜索的范围可能跨越多个范围。如果你的问题是一样的，那真的很简单：取一个范围数组，按它们的最低值排序（因为它们不重叠，这也与按它们的最高值排序的顺序相同）。

现在只需对您的目标下限值（如果不准确则更小）和目标上限值（如果不准确则更大）进行 binsearch。结果索引是涵盖的范围。您必须检查索引本身的范围是否包含在内或排除在外，但这只是 2 次检查。总体复杂度 O(log n)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-04T17:09:46.007

如果范围重叠，并且想要检索与给定目标范围重叠（或包含）的*所有*范围，则上述大多数解决方案似乎都不起作用。

正如一些人指出的那样，如果（最坏情况）*所有*范围都恰好与目标范围相交（例如，如果目标范围是 {0..MAXINT} 或类似的）那么当然需要 O(n) 才能返回n 个范围。

但是，这不是有趣且典型/平均的情况吗，其中 n 个总范围中只有很小的百分比与目标范围相交？将与“m”相交的数字称为“m”——在这种情况下，可以想象你可以做得和 O(m) 一样好*。*如果 n=10^9 和 m=10，那就是成败的区别。

考虑一个文本文档的简单情况，该文档具有针对其“类型”标记的多个区域——也许您希望找到包含或与给定的连续文本范围（例如，段落）相交的所有标记单元。在 HTML、XML 或类似内容中，它们只能是包含目标范围内至少一些字符的文本节点的祖先。在每个节点中具有父指针的典型表示中，这是 O(m)——比 O(n) 好得多，特别是因为 m（对于短或同步目标范围）仅仅是树嵌套深度，它往往甚至低于ln(n) 因为大型 XML 文档在实践中变得更加复杂而不是更深。

有趣的情况更难：如果您的“元素”不像在 XML 中那样形成树，而是像在 MECS、CLIX、LMNL 和其他一些系统中那样重叠，该怎么办？您仍然希望找到与您的目标重叠的所有区域/“元素”，但它们并不那么容易组织。

另一方面，您应该能够做得很好，因为在许多应用程序中标记的范围通常都很小——一本书中的单词、句子和段落远多于章节。因此，即使可能有大量范围在目标之前开始，而在目标之后结束的范围也很大，但平均而言，交叉点将非常小。

我认为这就是最初的提问者所要解决的问题，恐怕我没有看到解决该问题的答案。如果这不是最初的问题，那么我想将其作为一个新问题提出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T22:33:20.603

就像四叉树适用于一组二维点一样，简单的二叉树也适用于这种情况。用你的范围构建一棵树。

进一步解释：树中的每个节点都包含两个整数，范围的开始和结束，如果它不是叶节点，则包含两个子节点。要查找输入范围跨越的范围，然后从树的顶部开始

```
 - if the node range intersects the input range:
     - if it's a leaf node, then add the range to your result list
     - if it's not a leaf node, then traverse down to the child nodes and repeat this process. 
```

它应该是 O(logN)

更多细节：二叉树的结构类似于四叉树的一维版本。每个节点将有三个整数（对不起，我在上面说了两个，但现在我意识到你需要三个），最低的代表低于此节点的最低范围的最小值，最高的代表低于此的最高范围的最大值节点和枢轴。左孩子将从这个节点的最低点跨越到它的枢轴。右子节点将从该节点的枢轴跨越到该节点的最高节点。如果只有一个范围从“最低”到“最高”，那么您将没有枢轴，这将是一片叶子。理想情况下，您会为每个节点选择枢轴以保持树的平衡。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T22:34:12.817

听起来您需要一个实现 SortedSet 接口的类。TreeSet 是核心 API 附带的实现。

一组包含按最小值排序的范围，一组按最大值排序。

然后，您可以使用内存集实现等效的数据库算法。

至于这是否真的比 O(n) 快，我不能说。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-19T23:05:09.197

当我遇到这个问题时，我使用了一个排序的范围数组和二进制搜索来寻找交叉点。这是（我相信）O(log n) 性能，处理重叠范围需要一点开销。

我认为，您的问题的答案可以从下面的代码中得出，但没有插入。我展示了整个代码以避免因不同的上下文而造成混淆——我需要将一系列 Unicode 代码点插入到代码点范围列表中。

- 编辑 -

调整下面的代码以确定多个范围的交叉点涉及从插入点开始的简单前向搜索，直到找到不再相交的范围。

-- 结束编辑 --

Range 类包含：

```
final int                               lower;                                  // lower end of range
final int                               upper;                                  // upper end of range

public int compareTo(Object obj) {
    if(obj==null) { return -1; }

    Range                           oth=(Range)obj;

    if(lower<oth.lower) { return -1; }
    if(lower>oth.lower) { return  1; }
    if(upper<oth.upper) { return -1; }
    if(upper>oth.upper) { return  1; }
    return 0;
    } 
```

范围插入：

```
public Builder addRange(int fir, int las) {
    if(fir!=-1) { fir&=0x001FFFFF; }
    if(las!=-1) { las&=0x001FFFFF; }

    if(codepoints==null || codepoints.length==0) {
        codepoints=new Range[]{new Range(fir,las)};
        }
    else {
        int                         idx=Range.findChar(codepoints,fir);
        int                         ins=(idx<0 ? -(idx+1) : idx);

        if(idx<0) {
            if     (ins>0                 && fir==(codepoints[ins-1].upper+1)) { idx=(ins-1); }  // new range adjoins the following range (can't overlap or idx would be >=0)
            else if(ins<codepoints.length && las>=(codepoints[ins  ].lower-1)) { idx=ins;     }  // new range overlaps or adjoins the following range
            }

        if(idx<0) {
            codepoints=(Range[])Util.arrayInsert(codepoints,ins,new Range(fir,las));
            }
        else {
            boolean                 rmv=false;

            for(int xa=(idx+1); xa<codepoints.length && codepoints[xa].lower<=las; xa++) {
                if(las<codepoints[xa].upper) { las=codepoints[xa].upper; }
                codepoints[xa]=null;
                rmv=true;
                }
            if(codepoints[idx].lower>fir || codepoints[idx].upper<las) {
                codepoints[idx]=new Range((codepoints[idx].lower < fir ? codepoints[idx].lower : fir),(codepoints[idx].upper>las ? codepoints[idx].upper : las));
                }
            if(rmv) { codepoints=Range.removeNulls(codepoints); }
            }
        }
    return this;
    } 
```

二进制搜索：

```
static int findChar(Range[] arr, int val) {
    if(arr.length==1) {
        if     (val< arr[0].lower) { return -1; }                             // value too low
        else if(val<=arr[0].upper) { return  0; }                             // value found
        else                       { return -2; }                             // value too high
        }
    else {
        int                             lowidx=0;                               // low index
        int                             hghidx=(arr.length-1);                  // high index
        int                             mididx;                                 // middle index
        Range                           midval;                                 // middle value

        while(lowidx<=hghidx) {
            mididx=((lowidx+hghidx)>>>1);
            midval=arr[mididx];
            if     (val< midval.lower) { hghidx=(mididx-1); }                   // value too low
            else if(val<=midval.upper) { return mididx;     }                   // value found
            else                       { lowidx=(mididx+1); }                   // value too high
            }
        return -(lowidx+1);                                                     // value not found.
        }
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-06T14:26:53.457

我刚刚发现了 Nested Containment List [source](https://academic.oup.com/bioinformatics/article/23/11/1386/199545)，据说它的构建和查询速度比区间树快一个数量级，并且内存消耗更少[。](https://github.com/biocore-ntnu/ncls)

# uml - 用于文档的 Graphviz

> ID：303608
> 
> 赞同：17
> 
> 时间：2008-11-19T22:23:08.363
> 
> 标签：uml, doxygen, documentation-generation, graphviz

我注意到 doxygen 使用 graphviz 库来创建图表。你曾经使用过 graphviz 来生成文档吗？出于 doxygen 范围之外的文档目的而学习 graphviz 是否值得？还是我最好坚持使用像 Visio 这样的标准数据建模包？

我理解它作为图形库的优点，但是为了尝试表示更复杂的 UML（或类似的），它仍然值得研究吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-19T22:30:15.837

graphviz 是用于创建图形的非常简单的语言/格式。如果功能对你来说足够了，我会推荐它（它很简单，我估计最多学习 1 小时）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-10T16:41:51.530

如果您只是在谈论创建像 Doxygen 那样的继承/协作图，那么值得研究能够自动为您完成这些工作的 IDE。对于从头开始或手动调整的文档，我强烈推荐使用[OmniGraffle](http://www.omnigroup.com/applications/OmniGraffle/)（因为我在 Mac 上）。

但是，[GraphViz](http://en.wikipedia.org/wiki/Graphviz)和[DOT](http://en.wikipedia.org/wiki/DOT_language)非常方便，不仅用于文档，还用于调试和代码理解，特别是对于数据结构。我通常不会手动编写 DOT，但自动生成的 DOT 值得付出最小的努力。

我发现 GraphViz 非常有用的地方之一是用于理解和调试二叉搜索树算法。我开发[了 CHDataStructures.framework](http://cocoaheads.byu.edu/code/CHDataStructures)，这是一个开源的 Objective-C 框架，其中包括多种 BST。我实现了两种方法：`-(NSString*)dotGraphString`在父类和`-(NSString*)dotGraphStringForNode:`每个子类上。在大约 30-40 行代码中（大部分位于 底部`CHAbstractBinarySearchTree.m`），我添加了迭代遍历二叉树并创建它的 DOT 表示的能力，包括平衡信息、将节点着色为红色或黑色等。（与稍加注意，您可以轻松地表示空标记节点并以正确的排序顺序显示树。）

在我的测试代码中，每次修改树后，我都会调用 -`dotGraphString`并将结果保存到一个 .dot 文件中，并在此处设置断点，然后使用 GraphViz 打开该文件，它足够聪明，可以在以下情况下重新渲染 DOT 图该文件已更新。这种方法使查看树中发生的事情和发现给定算法实现中的错误变得非常容易。这种方法可以相当容易地适应各种数据结构，并且通常比创建一个仅用于可视化结构的 UI 更快、更容易。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-16T00:09:43.630

Graphviz 不会像 Visio 那样为您提供流畅的图形界面。但是，它将生成布局良好的图形。当我通过程序自动生成图形时（例如 doxygen），我发现它最有用。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-16T00:21:46.163

Graphviz 对于以编程方式生成依赖图（通过点）最有用。[访问者](http://www.hping.org/visitors/)使用它来可视化站点访问；[Hadoop/Cascading](http://cascading.org/)使用它来可视化 map-reduce 作业的执行计划。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-14T23:15:07.163

我将 GraphViz 广泛用于文档，并经常在外部使用 GraphViz 勾勒出关系或架构图，然后使用 @dot/@enddot 将它们添加到我的 Doxygen 代码的额外页面中。我最近还开始使用@dotfile，它具有双重好处，即可以将大点语句排除在代码文档之外，并允许我继续使用 GraphViz GUI 预览它们。

GraphViz 的另一大好处是简单的文本格式非常适合版本控制。您可以在 git diff 中看到对图表的更改，这对于任何二进制文档格式都是不可能的。多年来，随着我越来越多地使用它，这对我来说正成为一个更重要的功能。

但是，对于 UML，我使用了真正的 UML 工具（[Enterprise Architect](http://www.sparxsystems.com.au/)），而不是在 Visio 中随意使用。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-15T23:48:10.210

是的，graphviz 在程序中易于学习和使用。

另请查看[yEd](http://www.yworks.com/en/products_yed_about.html)，它是处理图表的好工具。与 Visio 不同，它将加载和保存各种易于手动编辑或以编程方式生成的格式。自动布局的东西也很不错。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-15T23:54:17.593

我偶尔用它来说明状态机。graphviz 非常适合。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-14T23:41:32.960

同意这里的共识；我从 Graphviz 中获得了很多价值。它非常适合创建简单而不是那么简单的图表。软件开发人员倾向于吸引图表，不仅在源代码中，而且在其他地方也是如此。

例如，现在在另一个浏览器窗口中，我使用 graphviz 图（使用[confluence 插件](http://confluence.atlassian.com/display/CONFEXT/Graphviz+Plugin)BTW 显示）说明了我们组的分支和合并策略。

Graphviz 也适用于 UML。请参阅[本教程](http://www.ffnn.nl/pages/articles/media/uml-diagrams-using-graphviz-dot.php)；这也是对 Graphviz 的一个很好的介绍。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-11T08:05:35.543

我们使用 graphviz 自动生成对象图作为我们 UML 验证工具的反馈。我们对结果非常满意，因为我们设法提供了图形结果，而完全不用担心布局。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-06-27T23:15:47.580

我曾多次使用 Graphviz，但发现它非常有限。

我发现最适合手动文本输入图的是[Tikz](http://www.texample.net/tikz/) 我将它用于[FSM](http://www.texample.net/tikz/examples/feature/automata-and-petri-nets/)

如果 Graphviz 输出满足您的特定需求，那可能没问题。如果你对它的功能不太满意并且有一些 TeX 经验 - 看看 Tikz。那里有许多不同的软件包，你不需要学习纯 Tikz/PGF（这可能看起来很重）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-04-10T19:33:23.260

仅供参考 Microsoft Visio 插件到带有 Graphviz 的布局图：http: [//www.calvert.ch/graphvizio/](http://www.calvert.ch/graphvizio/)

# ssl - HttpWebRequest 服务器不可用 503 问题

> ID：303611
> 
> 赞同：2
> 
> 时间：2008-11-19T22:24:37.453
> 
> 标签：ssl, https, httpwebrequest, webrequest

我最初使用 WebRequest 和 WebResponse 来发送 Http Post 消息。我总是得到“OK”的回应。我发布的消息是使用 xml 中的证书签名的 XML。

组成如下：发送到 https 网站的 C# 服务。HTTPS 网站在另一个我不能说的地方。HTTPS 本地网站，它只是接收我在本地发布的消息并将结果写入文件。只是为了模拟其他网站正在获得什么。

本地网站使用自签名证书签名，将于 2048 年到期。

直到本周，这段代码都运行良好。我总是张贴并得到一个好的。在这两个网站上。但本周测试和真正的项目实施都进入了 Kaput。在两个网站上。
在本地网站上，它说无法连接到 SSL。这个问题是由自签名证书引起的，由于某种原因超出了我的理解，它给了地狱。感谢这里的问题，我刚刚验证了证书始终是真实的，现在它不再有问题了。

要解决此问题，只需编写以下代码：

```
ServicePointManager.CertificatePolicy = new AcceptAllCertificatePolicy(); 
```

在您的应用程序开始时。所以它只运行一次。

剩下的问题是“远程服务器返回错误：（503）服务器不可用。”。我在浏览器中输入 URL，它对我来说很好。在该网站的代码中没有收到任何内容，当它进入网络响应时，它给了我上述错误

我做了一个仅发送“Testing 1 2 3”的测试应用程序，但我不断收到错误消息。我也将它发送到哈佛 https 网站，没有错误。

```
private void btnSend_Click(object sender, EventArgs e)
    {
        try
        {
            WebRequest req = WebRequest.Create(cboUrl.Text);
            req.PreAuthenticate = true;
            req.UseDefaultCredentials = true;
            req.Method = "POST";
            req.ContentType = "text/xml";
            String msg = txtMsg.Text;

            using (Stream s = req.GetRequestStream())
            {
                try
                {
                    s.Write(
                        System.Text.ASCIIEncoding.ASCII.GetBytes(msg), 0, msg.Length);
                }
                finally
                {
                    s.Close();
                }
            }

            WebResponse resp = req.GetResponse();
            StreamReader str = new StreamReader(resp.GetResponseStream());

            txtRes.Text = str.ReadToEnd();
        }
        catch (WebException ex)
        {
            txtRes.Text = ex.Message;
        }
        catch (Exception ex)
        {
            txtRes.Text = ex.Message;
        }

    } 
```

这是我从网上找到的另一个例子：

```
private void button1_Click(object sender, EventArgs e)
    {
        try
        {

            HttpWebRequest myReq = (HttpWebRequest)WebRequest.Create(cboUrl.Text);
            myReq.Headers.Clear();
            myReq.Method = "POST";
            myReq.KeepAlive = false;
            myReq.ProtocolVersion = HttpVersion.Version11;
            myReq.ContentType = "text/xml";
            myReq.Proxy = null;
            myReq.Credentials = null;
            myReq.ContentLength = txtMsg.Text.Length;
            using (StreamWriter sendingData = new StreamWriter(myReq.GetRequestStream()))
            {
                sendingData.Write(txtMsg.Text);
                sendingData.Flush();
                sendingData.Close();
            }

            HttpWebResponse myResponse = (HttpWebResponse) myReq.GetResponse();
            StreamReader responseStream = new StreamReader(myResponse.GetResponseStream());
            txtRes.Text = responseStream.ReadToEnd();

            responseStream.Close();
            myResponse.Close();

        }
        catch(WebException ex )
        {
            txtRes.Text = ex.Message;
        }
        catch (Exception ex)
        {
            txtRes.Text = ex.Message;
        }

    } 
```

**更新**

错误是我用 httpwebrequest 调用的那个需要一些我没有提供的 httpheaders。在唯一发生的事情是我得到“OK”响应之前。他们修复了他们的代码，我修复了我的代码，现在它可以工作了。

如果它发生在其他人身上，请像下面所说的那样检查代理设置，并检查另一方是否给出异常或什么都不返回。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T22:45:08.940

如果您在浏览器中导航到 URL 时*没有*收到 503 错误，但在使用 HttpWebRequest 请求资源时*确实*收到了它，那么我建议的第一件事是在发出请求时为**UserAgent指定一个值。**

您可能还想使用[Fiddler2](http://www.fiddler2.com/fiddler2/)或其他工具来更好地了解请求生命周期内发生的情况。如果不了解您发布消息的服务的详细信息，就很难提供指导。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-16T09:20:22.857

我有一个类似的问题。感谢 Fiddler 提示，我发现它是由我的新开发环境中的代理设置引起的。很烦人。.NET 网络服务采用 IE 中设置的代理设置。

有关详细信息，请查看： http: [//support.microsoft.com/kb/307220](http://support.microsoft.com/kb/307220)和[http://msdn.microsoft.com/en-us/library/kd3cf2ex.aspx](http://msdn.microsoft.com/en-us/library/kd3cf2ex.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T21:44:44.523

问题似乎是这个网站改变了。之前，如果我发送带有任何垃圾的消息，它会返回通常的 OK。他们更改了网站，并且需要一些 http 标头。昨天我一整天都在使用 http 标头，而晚上则是它起作用的时候。在我的情况下，它期待 http 标头而不是获取它们，也许某些东西正在爆炸。

我今天对它进行了测试，给出了标题而不是给出了 http 标题，在后一种情况下它做了 503。

如果我找到更多信息，我会尝试在此处发布。我希望这可以为其他人节省一些时间和一些头发:)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-05T11:02:42.700

我有 503 错误的类似问题，但原因是代理。如果你有代理，只需使用这个：

`request.Proxy = null;`

`request.Credentials = System.Net.CredentialCache.DefaultCredentials;`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-31T20:45:17.187

如果您重置 IIS，请确保您最近没有更改密码。愚蠢，但它发生了。

# java - 我们可以将 JMX 用于警报/通知吗

> ID：303613
> 
> 赞同：6
> 
> 时间：2008-11-19T22:25:08.827
> 
> 标签：java, notifications, jmx, alerts

简而言之，这是我试图实现的规格：

1) 必须针对应用程序中的某些事件发送一些警报。

2) 这些警报有用户订阅它们。

3) 并且用户已经设置了他们自己的通知偏好（例如电子邮件和/或短信）。

到目前为止，我还没有在 Java 中找到开源解决方案。

JMX 通知是一个选项吗？我对 JMX 的了解越多，我就越觉得它试图实现与我的问题不同的东西。

任何帮助都会很有用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-19T23:32:42.123

JMX 可以成为解决这个问题的一种机制，但它不是完整的解决方案。

JMX 为您的程序提供设施和服务，以允许客户端访问监视数据以及允许客户端对应用程序进行控制调用。

正如您所提到的，JMX 的一个方面是通知系统。该系统提供的基础设施使您的程序可以轻松地向客户端提供警报和通知，并且现代 JVM 还提供免费的 JMX 服务器以允许客户端远程连接到您的应用程序并订阅这些事件。

但发出 JMX 警报是一回事，完全采取行动是另一回事。

您需要做的是让一些 JMX 客户端在某处“订阅”您的程序的 JMX 通知，然后该客户端可以通过发送电子邮件或其他方式对这些通知采取行动。

JMX 客户端可以是通过 TCP 与您的应用程序通信的远程客户端，也可以是程序中的内部 JMX 客户端，在线程中运行，例如，它可以对通知进行操作。

因此，基本上，JMX 为您想要做的事情提供管道和基础设施，但不会将警报转换为电子邮件的“最后一英里”。

正如@fawce 所提到的，有一些“通用”JMX 客户端可以对 JMX 数据进行操作，并且可以执行您想要的操作（我不熟悉它们，所以我不能直接说），或者您可以编写代码您自己的系统来监控 JMX 数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T23:08:52.793

如果您指的是 JMX，那么有一个名为[monju](http://monju.sourceforge.net)的 JBoss/Nagios 桥接器，它有一个通用的 JMX 钩子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T21:53:49.710

我建议使用 JMX 通知和 SNMP，它们应该支持您的场景，2) 和 3) 被 SNMP 软件覆盖。

只要您可以使用某些 API 访问 SMS 网关，您也可以自己用 Java 编写代码。只要您有权访问允许匿名访问的 SMTP 主机，使用 javax.mail 就很简单。2) 的灵活发布-订阅机制可用于连接 1) 和 3)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-10T06:41:43.230

这是一篇很好的文章，其中包含在您的应用程序中使用 jms 来引发警报[链接文本](http://www.zdnetasia.com/delivering-notification-with-jmx-61962454.htm "使用 jmx 传递通知")的示例代码。一旦您使用本地监控，您需要设置 -Dom.sun.management.jmxremote.port=9999 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false 所以您可以从远程计算机连接。一个很好的简单程序来监控启用了 jmx 的 java，它可以绘制移动图形的网页，并在阈值更改时通过电子邮件发送警报是[链接文本](http://www.jmanage.org/ "管理"). 它还可以让您通过网页远程控制您的应用程序。又好又简单。当然，如果您使用的是 jmx，您可以轻松换用更复杂的东西，例如 nagios 或一些昂贵的商业工具。这些工具的关键在于它们有工作流程和轮班表以及管理一大群人想要照顾很多东西（数据库、服务器、java等）的东西——如果你刚开始的话，这可能太复杂了让 jmx 的 java 端正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-22T13:15:00.690

[Solarwinds](https://www.solarwinds.com/)是一种商业企业监控工具，能够连接到 JMX 进行监控。它能够生成 SMS 和电子邮件警报。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-19T22:51:36.463

您是指 JMS（而不是 JMX）吗？JMS 是一个消息传递 API，而 JMX 是一个监控/管理 API。使用 JMS 作为后端是实现后端消息的好方法，它将负责解耦、负载平衡和持久性。但是您仍然必须有一个组件来接收消息并将它们发送给用户。

# continuous-integration - 你最喜欢的极端反馈设备是什么？

> ID：303614
> 
> 赞同：19
> 
> 时间：2008-11-19T22:25:20.137
> 
> 标签：continuous-integration

我们可能都听说过将熔岩灯和[环境球](http://www.ambientdevices.com/cat/orb/orborder.html)连接到您的持续集成系统。我很想知道人们正在使用或听说过哪些其他有趣的东西用于极端反馈设备？此外，这个[Tux Droid](http://www.kysoh.com/)看起来很可爱

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-19T23:01:12.467

我的一个想法是购买其中一个[USB 导弹发射器](http://www.microplex.no/aspx/produkt/prdinfovnet.aspx?plid=45595)并编写一个可以将其瞄准已知用户的站点的程序......

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-19T22:34:16.500

我喜欢[Last.fm](http://blog.last.fm/2008/08/01/quality-control)使用的系统。除了用于监控服务器响应时间的老式模拟设备、大量 LCD 显示器外，它们还有红色、黄色和绿色的巨型橡皮熊，以提醒开发人员注意构建损坏。让我希望我有时间和金钱在工作中设置类似的东西。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-19T23:57:11.433

在 Agitar，我们尝试[了几种反馈装置](http://www.developertesting.com/archives/month200404/20040401-eXtremeFeedbackForSoftwareDevelopment.html)，我认为熔岩灯有一个独特的特点来推荐它们：蜡需要一段时间才能融化。

这似乎是一件小事（而且确实如此），但其效果是团队竞相在蜡开始移动之前修复构建。

然而我们学到的一件事是你想要两个灯，红色和绿色，而不是图片中的蓝色灯。因为有一个熔岩灯有点好，所以你不应该仅仅因为构建好就被拒绝。;)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-04-21T08:36:17.033

办公室天花板上的蝙蝠侠标志：

[http://www.jensjaeger.com/2010/04/extreme-feedback-device-the-batman-lamp/](http://www.jensjaeger.com/2010/04/extreme-feedback-device-the-batman-lamp/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-11-18T19:21:29.270

Nabaztag [rabbit](http://www.nabaztag.com)非常受欢迎，特别是因为开发了许多接口（例如用于 Hudson 服务器）。

[替代文字 http://leblog.wcie.fr/.a/6a00d8341cb14e53ef0120a4ee0220970b-800wi](http://leblog.wcie.fr/.a/6a00d8341cb14e53ef0120a4ee0220970b-800wi)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-25T22:14:50.570

我们在 Softwareschneiderei 有几个 XFD： - 一盏灯（没有熔岩） - 一个便携式喷泉 - 一个 LED 酒吧 - 扬声器 - 壁挂式显示器 - 臭名昭著的 USB 火箭发射器

您可以在我们的博客上阅读它们：http: [//schneide.wordpress.com/category/extreme-feedback/](http://schneide.wordpress.com/category/extreme-feedback/)

到目前为止，我们发现灯是最有用的，但便携式喷泉被认为是“最酷”的一种。led 条是需要最少解释的设备。火箭发射器由电池供电，最需要注意（重新加载！）。

今年，我们至少推出了一款新设备。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-20T00:04:16.317

没有什么比旧的乳头鳄鱼夹 rs232 组合更好的了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-25T22:18:12.263

好吧，我们已经使用[了 CruiseSaver](http://cruisesaver.sourceforge.net/)，并将它放在一个巨大的宽屏液晶显示器上。

编辑：

另外，我在一个项目中，我们在最后一个破坏构建的人的桌子上放了一个 Mr. Potatohead。它一直呆在那里，直到其他人打破它，这可能是 5 分钟或 5 周......

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-19T23:27:31.367

我已经考虑过使用其中[之一](http://www.thinkgeek.com/computing/input/a85c/?cpg=ab)

想一想：你破坏了构建，所以在你修复它之前，你的键盘会发红光。

可悲的是，最后我检查了一下，更改 kb 颜色的实用程序只有 Windows，所以我永远不会购买。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-18T19:11:16.320

CruiseControl.NET + CCTray + Growl + Prowl = iPhone 推送通知何时以及谁破坏了构建。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-12-15T14:23:48.533

我更喜欢这个[https://github.com/luismreis/beacon](https://github.com/luismreis/beacon)

# c# - 生成 xml 日志的日志记录组件

> ID：303615
> 
> 赞同：2
> 
> 时间：2008-11-19T22:25:28.327
> 
> 标签：c#, .net, xml, logging

许多程序以如下格式将内容记录到文本文件中：

2008 年 11 月 19 日 13:29:01 调试打开到 localhost 的连接。

2008 年 11 月 19 日 13:29:01 调试正在为用户“管理员”发送登录消息。

2008 年 11 月 19 日 13:29:03 调试收到用户“管理员”的登录响应“确定”。

...

但是，我更喜欢像 XML 这样更结构化的东西，这样我可以更轻松地解析日志。多年来，我一直在我的 VB6 / Asp Classic 程序中执行此操作，现在我想在 .Net 中执行此操作。**有什么东西可以做到这一点，还是我应该用 C# 重新编写我的 VB6 代码？**

以下是对我的日志记录组件的调用如何查找我的 VB6 程序：

```
Trace.Warn "MMain", "Main(command, other data)", "Deprecated command", _
    sCommandName, sOtherData 
```

导致以下日志条目：

```
<Info time="11/17/2008 04:49:45 PM" mod="MMain" proc="Main" entry="Deprecated command" command="The_Bad_Command" other_data="The other data." /> 
```

当我想用我的自定义日志查看器打开日志时，我只需将整个文件包装在一个根节点中，然后我可以使用 MSXML 轻松完成此操作，以过滤我看到的条目、查找特定用户的登录等。 ETC...

```
<Log>
...the log file text...
</Log> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T22:34:39.617

我不确定是否有任何产品可以做到这一点，但您可以使用[log4net](http://www.ondotnet.com/pub/a/dotnet/2003/06/16/log4net.html)并编写自己的[附加程序](http://logging.apache.org/log4net/release/features.html)（输出处理程序）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T06:24:52.993

Enteprise library Logging 块提供了不同的日志格式，例如 xml，但是配置和处理它的方法很长

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T19:34:14.470

没有图书馆可以满足我的要求。我自己做了一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-19T18:10:34.360

log4j 和 logback 都有 XMLLayouts 可以生成 XML 片段，然后可以由 Apache Chainsaw 或 Lillith 进行后处理。

# c# - 带有 ADAM 用户和简单绑定的 ADAM 身份验证

> ID：303625
> 
> 赞同：1
> 
> 时间：2008-11-19T22:27:44.937
> 
> 标签：c#, authentication, active-directory, adam

我遵循了 Microsoft 的 ADAM 分步指南，并在我的本地计算机上设置了一个 ADAM 实例。我正在尝试使用“Mary Baker”帐户进行身份验证，但每次我在`if (entry.Guid != null)`下面的行中收到 COM 异常。异常指出存在未知用户名或错误密码。

但是，我可以使用 ldp 实用程序连接到 ADAM 并成功执行简单的绑定 - 所以我知道用户名都存在，并且我有正确的密码。

此外，我已将用户的 msDS-UserAccountDisabled 属性设置为 false，并将用户添加到管理员和读者角色。

有什么想法吗？

```
 path = "LDAP://localhost:50000/O=Microsoft,c=US";
    userId = "CN=Mary Baker,OU=ADAM users,";
    password = "Mary@101";

    DirectoryEntry entry = new DirectoryEntry(path, userId, password, AuthenticationTypes.None);
    if (entry.Guid != null)
        LoadWelcomeScreen(); 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-06-09T03:06:44.863

ADAM stores the unique identifier for a user in the `displayName` attribute of the `user` class. They need to be unique in the ADAM instance for the user to authenticate. If two users both had their `displayName` attribute set to 'jsmith' then neither user could authenticate in ADAM.

Use the ldp utility to query the `displayName` for Mary Baker. It could be something like 'mbaker'. Use that value as the userId in the given code.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-09T15:35:17.970

感谢 Ryan 提供有关*displayName*的提示。将我的测试课程发布在我当地的 ADAM 实例上，供任何可能感兴趣的人使用。

```
 [TestMethod]
    public void CreateUserAccount()
    {
        var username = "amurray";
        var password = "ADAMComplexPassword1234";
        var firstname = "Andy";
        var lastname = "Murray";

        const AuthenticationTypes authTypes = AuthenticationTypes.Signing |
                                              AuthenticationTypes.Sealing |
                                              AuthenticationTypes.Secure;

        var ldapPath = "LDAP://localhost:389/OU=MyProject,OU=Applications,DC=Company,DC=ADAM";
        using (var dirEntry = new DirectoryEntry(ldapPath, "MyPC\\adamuser", "Password1!", authTypes))
        {
            DirectoryEntry user = null;
            const int ADS_PORT = 389;
            const long ADS_OPTION_PASSWORD_PORTNUMBER = 6;
            const long ADS_OPTION_PASSWORD_METHOD = 7;
            const int ADS_PASSWORD_ENCODE_CLEAR = 1;

            try
            {
                user = dirEntry.Children.Add(string.Format("CN={0} {1}", firstname, lastname), "user");
                user.Properties["displayName"].Value = username;
                user.Properties["userPrincipalName"].Value = username;
                user.Properties["msDS-UserAccountDisabled"].Value = false;
                user.Properties["msDS-UserDontExpirePassword"].Value = true;
                user.CommitChanges();
                var userid = user.Guid.ToString();

                // Set port number, method, and password.
                user.Invoke("SetOption", new object[]{ADS_OPTION_PASSWORD_PORTNUMBER,ADS_PORT});
                user.Invoke("SetOption", new object[]{ADS_OPTION_PASSWORD_METHOD,ADS_PASSWORD_ENCODE_CLEAR});

                user.Invoke("SetPassword", new object[] {password});
                user.CommitChanges();
                user.Close();
            }
            catch (Exception e)
            {
                var msg = e.GetBaseException().Message;
                Console.WriteLine(e);
                System.Diagnostics.Debug.Print(msg);
            }                
        }
    }

    [TestMethod]
    public void TestUserAuthentication()
    {
        try
        {
            var ldsContext = new PrincipalContext(ContextType.ApplicationDirectory, "localhost:389",
                                                  "OU=MyProject,OU=Applications,DC=Company,DC=ADAM",
                                                  ContextOptions.SimpleBind);

            // Returns true if login details are valid
            var isValid = ldsContext.ValidateCredentials("amurray", "ADAMComplexPassword1234", ContextOptions.SimpleBind);
        }
        catch (Exception e)
        {
            var msg = e.GetBaseException().Message;
            Console.WriteLine(e);
            System.Diagnostics.Debug.Print(msg);
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T03:29:31.613

我没有使用过 ADAM 或 System.DirectoryServices，但我确实有使用 LDAP 和 AD 的经验；希望以下内容适用。

我以前从未见过以这种格式给出的用户 ID。（它看起来像是某种相对 DN，如尾随逗号所示？）您是否尝试将用户 ID 指定为完整 DN（根据标准 LDAP 的要求）或作为裸用户名（如果 ADAM 支持）？

在诊断像这样的网络协议问题时（查看我的程序是否正在执行我认为我告诉它的操作，并查看它正在执行的操作与正常运行的程序正在执行的操作相比如何），我发现运行[Wireshark](http://www.wireshark.org)很有帮助对于非正常运行和正常运行的操作，看看它们有何不同。如果您从未使用过 Wireshark，希望上手不会太难：

1.  下载、安装和启动软件。
2.  在捕获下，单击选项。
3.  将 Interface 设置为 localhost / loopback 或您的以太网接口。（我不认为环回在 Windows 上按预期工作；您可能希望选择以太网接口并在 C# 代码中更新 LDAP URL 以使用您的主机名而不是 localhost。）
4.  在捕获过滤器下，输入“tcp port 50000”（无引号）。
5.  单击开始，运行连接操作，然后在捕获菜单下单击停止。

Wireshark 可以为你分析协议，所以你不必自己*太*熟悉协议细节，虽然你知道的越多，就越容易解释所有的细节。您可以启动几个 Wireshark 实例来轻松比较两个不同的捕获（您的代码和 LDP）。

# regex - **粗体文本**的 BBcode 正则表达式

> ID：303639
> 
> 赞同：5
> 
> 时间：2008-11-19T22:30:48.830
> 
> 标签：regex

我对正则表达式很糟糕，但我已经尝试过谷歌（甚至查看了 reddit 的源代码），但我仍然被卡住了，所以这里是：

我的目标是匹配以下“代码”并将它们替换为 HTML 标记。这只是我坚持的正则表达式。

```
**bold text**
_italic text_
~hyperlink~ 
```

这是我对粗体的尝试：

```
^\*\*([.^\*]+)\*\*$ 
```

为什么这不起作用？我正在使用 preg 语法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T22:33:53.927

采用：

```
\*\*(.[^*]*)\*\* 
```

解释：

```
\*\*      // match two *'s
(.        // match any character
[^*]      // that is not a *
*)        // continuation of any character
\*\*      // match two *'s 
```

在字符类“[]”中，“^”只有在它是第一个字符时才有意义。所以`(.*)`匹配任何东西，`(.[^*]*)`匹配任何东西直到文字 *

**编辑**：响应评论以匹配 (ie `**bold *text**`) 中的星号，您必须使用非贪婪匹配：

```
\*\*(.*?)\*\* 
```

字符类是更有效的非贪婪匹配，但不可能在字符类中分组（[请参阅](http://www.regular-expressions.info/brackets.html)“括号和反向引用...”）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T22:35:35.247

首先，去掉 ^ 和 $。使用这些只会匹配以 ** 开头并以 ** 结尾的字符串。其次，使用贪心量词来匹配尽可能少的文本，而不是为除星号以外的所有字符创建一个字符类。

这是我的建议：

```
\*\*(.+?)\*\* 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T01:24:25.267

这是另一个正则表达式：`\*\*((?:[^*]|\*(?!\*))*)\*\*`

Perl 中的示例：

```
my %tag2re = (b => <<'RE_BOLD', i => '_([^_]*)_');
  \*\*(      # begin bold
    (?:[^*]  # non-star
    |        # or
    \*(?!\*) # single star
    )*       # zero or more times
  )\*\*      # end bold
RE_BOLD

my $text = <<BBCODE;
before  **bold and _italic_ *text
2nd line** after _just
           italic_ 
****
**tag _soup** as a result_
BBCODE

while (my ($tag, $re) = each %tag2re) {
    $text =~ s~$re~<$tag>$1</$tag>~gsx;
}
print $text; 
```

它打印：

```
<b>粗体和<i>斜体</i>之前 *文本
<i>之后的第二行</b>
           斜体</i>
<b></b>
<b>标记<i>汤</b>作为结果</i>
```

或作为 html：

```
在  粗体和*斜体*之前*文本*刚刚*之后的 第二行 *斜体* 
 **结果***标记*****汤****
```

 ****Stackoverflow 的解释是：

在 **粗体和*斜体*之前*文本***斜体*之后的第二行

 ** * *

**结果***标记*****汤****

 *** * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T22:39:39.950

```
\*\*(.*?)\*\* 
```

这将适用于**粗体文本**。

只需将 ** 替换为 _ 或 ~ 即可

# delphi - Delphi 的自定义组件重绘问题

> ID：303642
> 
> 赞同：1
> 
> 时间：2008-11-19T22:32:11.900
> 
> 标签：delphi, drawing, custom-component

我编写了一个从 TLabel 派生的新自定义组件。该组件向组件添加了一些自定义绘图，但没有别的。绘制组件后，一切正常。但是当需要重绘时（比如在组件上拖动另一个窗口），“标签部分”可以正常工作，但我的自定义绘图没有正确更新。我基本上是在重写的 Paint 方法中直接绘制到画布上，当需要重绘时，我的代码绘制的画布部分被涂成黑色。似乎没有调用paint方法。我应该怎么做才能得到正确的重绘？

该组件基本上是：

```
TMyComponent = class(TCustomLabel, IMyInterface)
..
protected
  procedure Paint; override;
..

procedure TMyComponent.Paint;
begin
  inherited;
  MyCustomPaint;
end; 
```

更新，绘画程序：

```
Position := Point(0,0);
Radius := 15;
FillColor := clBlue;
BorderColor := clBlack;
Canvas.Pen.Color := BorderColor;
Canvas.Pen.Width := 1;
Canvas.Brush.Color := BorderColor;
Canvas.Ellipse(Position.X, Position.Y, Position.X + Radius,  Position.Y + Radius);
Canvas.Brush.Color := FillColor;
Canvas.FloodFill(Position.X + Radius div 2,
  Position.Y + Radius div 2, BorderColor, fsSurface); 
```

解决了：

问题是（冗余）使用 FloodFill。如果 Canvas 不完全可见，floodfill 会导致伪影。我删除了洪水填充，现在它可以根据需要工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T00:02:46.273

我猜您的 MyCustomPaint 有问题，因为其余部分编码正确。这是我对 MyCustomPaint 的实现。告诉我与您的不同之处：

```
procedure TMyComponent.MyCustomPaint;
var
  rect: TRect;
begin
  rect := self.BoundsRect;
  rect.TopLeft := ParentToClient(rect.TopLeft);
  rect.BottomRight := ParentToClient(Rect.BottomRight);
  Canvas.Pen.Color := clRed;
  Canvas.Rectangle(Rect);
end; 
```

它刷新就好了。在它周围画一个漂亮的红色框。你不是在转换积分吗？不确定是什么导致它按照您描述的方式运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-21T12:29:27.500

解决了：

问题是（冗余）使用 FloodFill。如果 Canvas 不完全可见，floodfill 会导致伪影。我删除了洪水填充，现在它可以根据需要工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T03:09:13.387

我不是 100% 确定它会为你工作，但我已经看到渲染问题通过放置`TXPManifest`在表单上得到解决。

# jquery - 如何使用 jquery 了解事件是否绑定到元素？

> ID：303654
> 
> 赞同：7
> 
> 时间：2008-11-19T22:34:39.837
> 
> 标签：jquery, events

我需要一种`hasEvents()`方法

```
var someBool = hasEvents($("#myelement")); 
```

`true`如果元素的任何事件处理程序有一些绑定事件，则返回。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-19T22:40:07.533

你看过[`hasEvent()`](http://plugins.jquery.com/project/hasevent)插件吗？代码很小：

```
(function(A) {
    A.fn.hasEvent = function(C) {
       var B = this.data("events");
       return( B && B[C] )
    }
}) (jQuery) 
```

对于您的特定目的，您可以稍微修改它：

```
(function($) {
    $.fn.hasEvents = function() {
        return new Boolean(this.data('events') );
    }
}) (jQuery);

$('#someDiv').click(function() {
    alert('new event');
});

$('#someDiv').hasEvents();      // true
$('#someOtherDiv').hasEvents(); // false 
```

# c# - 从 Xbap 打开新页面

> ID：303656
> 
> 赞同：3
> 
> 时间：2008-11-19T22:35:26.217
> 
> 标签：c#, .net, wpf, xbap

我们的应用程序是一个完全信任运行的 Xbap。我有一个类似的功能：

```
private void ShowPage(Page page)
{
    NavigationWindow mainWindow = Application.Current.MainWindow as NavigationWindow;  
    mainWindow.Navigate(page);
} 
```

这非常适合在现有窗口内浏览。我想在单独的窗口中打开这个新页面。有没有办法做到这一点？

有一个需要“extraData”的重载，但我无法确定要传递什么来导航到新窗口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-21T20:11:19.347

显然 WPF 对于 StackOverflow 来说有点新。这是我想出的功能，以防其他人偶然发现。

```
private void ShowPage(Page page)
{
    NavigationWindow popup = new NavigationWindow();  
    popup.Height = 400;
    popup.Width = 600;
    popup.Show();
    popup.Navigate(page);
} 
```

我没有在部分信任的情况下尝试过这个，很可能这只能在完全信任的情况下工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-21T20:50:46.303

你是对的，这只能在完全信任的情况下工作。您不能在部分信任的情况下创建弹出窗口。

# python - 关于元组的新手 Python 问题

> ID：303664
> 
> 赞同：5
> 
> 时间：2008-11-19T22:36:37.913
> 
> 标签：python, tuples, cx-oracle

我是 Python 新手，我正在使用该`cx_Oracle`模块编写一些数据库代码。在[cx_Oracle 文档](http://cx-oracle.sourceforge.net/html/module.html)中，他们有一个这样的代码示例：

```
import sys
import cx_Oracle

connection = cx_Oracle.Connection("user/pw@tns")
cursor = connection.cursor()

try:
    cursor.execute("select 1 / 0 from dual")
except cx_Oracle.DatabaseError, exc:
    error, = exc.args
    print >> sys.stderr, "Oracle-Error-Code:", error.code
    print >> sys.stderr, "Oracle-Error-Message:", error.message 
```

我的问题与“错误”对象的创建位置有关。“ `, =`”有什么作用？我尝试搜索 Python 文档，搜索引擎在搜索运算符时效果不佳。:-)

我知道 exc.args 是一个单例元组，但我只是不明白 " `, =`" 语法。如果我删除逗号，我会收到错误消息“ `AttributeError: 'tuple' object has no attribute 'code'`”。

有人可以指出我记录在哪里吗？谢谢！

**编辑：**

这无需解包元组即可工作：

```
import sys
import cx_Oracle

connection = cx_Oracle.Connection("user/pw@tns")
cursor = connection.cursor()

try:
    cursor.execute("select 1 / 0 from dual")
except cx_Oracle.DatabaseError, exc:
    print >> sys.stderr, "Oracle-Error-Code:", exc.args[0].code
    print >> sys.stderr, "Oracle-Error-Message:", exc.args[0].message 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-19T22:51:00.380

```
error, = exc.args 
```

这是一个[序列解包](http://docs.python.org/tutorial/datastructures.html#tuples-and-sequences)的情况。

一种更易读的写法，也是我个人喜欢的风格，是：

```
[error] = exc.args 
```

理解前面的示例需要两个位：

1.  当赋值的左边是一个递归的名字序列时，右边的值必须是一个长度相同的序列，RHS值的每一项都赋值给LHS中对应的名字。
2.  在 python 中编写了一个单项元组`(foo,)`。在大多数情况下，括号可以省略。特别是，它们可以在赋值运算符旁边省略。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T22:40:42.303

[http://www.python.org/doc/2.5.2/tut/node7.html](http://www.python.org/doc/2.5.2/tut/node7.html#SECTION007300000000000000000)

在第 5.3 节中查找“序列解包”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T22:49:00.120

逗号用于解包元组，即它提取元组的单个项目，并将其绑定到`error`. 如果没有逗号，您将绑定元组本身，而不是其内容。

# c# - 从 C++ 到 C# 的面向对象设计帮助

> ID：303668
> 
> 赞同：1
> 
> 时间：2008-11-19T22:39:32.353
> 
> 标签：c#, c++, oop

嘿，我通常会遇到这样一种情况，即我将创建一个只能由一个或几个类实例化的类。在这种情况下，我会将其构造函数设为私有，并使其成为应该能够实例化它的对象的朋友类。例如（在 C++ 中）：

```
class CFoo
{
    friend class CFoo;

    // private ctor because only a select few classes should instantiate
    private:
    CFoo()
    {
        ... Do stuff
    }
}

class CBar
{
    // CBar is one of the few classes that only need to use CFoo

    CFoo *m_pFoo;

    CBar()
    {
        m_pFoo = new CFoo;
    }
} 
```

所以我的问题是：这很愚蠢吗？还是有更好的方法来实现这一目标？考虑到该语言完全缺少friend关键字，我对它与C#一起使用的方式特别感兴趣。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T22:49:49.867

这里的目标似乎是，在你有一个工作的 CBar 之前，你不能有一个 CFoo。

您可以通过为 CFoo 创建一个私有构造函数，然后在 CFoo 中创建一个静态方法来实现相同的效果，该方法接受一个 CBar 参数并调用所述构造函数并返回新的 CFoo。

这类似于 System.Drawing.Graphics.FromImage(Image image) 方法。

为什么 C# 没有friend 关键字的问题已在[别处](https://stackoverflow.com/questions/203616/why-does-c-not-provide-the-c-style-friend-keyword)讨论过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T22:44:28.163

在 C# 中，根据类的使用方式，您可以在另一个类的范围内定义一个类。

```
public class CBar
{
    CBar()
    {
        m_pFoo = new CFoo();
    }

    CFoo m_pFoo;

    private class CFoo
    {
        CFoo()
        {
            // Do stuff
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T22:48:47.703

您可以查看在内部标记 CFoo

```
internal class CFoo 
```

*   这可能适合您的需求。正如@g 所说，您可以在类中嵌套类，但恕我直言，这有点代码味道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T22:45:42.340

仅仅因为只有少数特定类使用 CFoo，并不意味着您应该明确阻止其他人使用它。如果这确实是需要，您可能需要重新考虑您的设计。您绝对不想在代码中强制进行如此大量的耦合。请提供一些关于您为什么这样做的详细信息，以便我们更好地提出一个好的解决方案？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T22:47:48.297

为了帮助思考它是否愚蠢，您能否提供更具体的示例来说明这些类是什么？

我会说没有充分理由使用朋友对我来说听起来有点奇怪......在C＃中你有汇编这样的东西，所以你可以使用内部构造函数或私有构造函数和几个具有不同访问权限的静态创建方法（受保护的、公共的、内部的……）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T22:48:24.333

首先，朋友声明在错误的类中。CFoo 需要与 CBar 成为朋友，以便让 CBar 访问它的私有成员。

其次，是的，通常应该避免这种情况。类应该很少关心它们的使用方式/位置。如果他们这样做了，那么该功能可能应该以不同的方式分解。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T22:49:54.487

只需将课程设为私有即可。这只是将范围限制为您的 dll（exe 等）。没有什么比 C# 中的朋友声明更酷了，但 Marcin 是正确的，您应该重新考虑这样的设计。如果你真的需要“朋友”的支持，你可以在运行时使用反射来模拟它。

# php - 在 WHERE 子句中使用 mysql concat()？

> ID：303679
> 
> 赞同：49
> 
> 时间：2008-11-19T22:44:12.157
> 
> 标签：php, mysql

我想搜索我的表，其中有一列名字和一列姓氏。我目前接受一个字段中的搜索词并将其与两列进行比较，一次一个

```
 select * from table where first_name like '%$search_term%' or 
    last_name like '%$search_term%'; 
```

这适用于单个单词搜索词，但结果集包括名称为“Larry”的每个人。但是，如果有人输入名字，然后是空格，然后是姓氏，我想要一个更窄的搜索结果。我尝试了以下但没有成功。

```
 select * from table where first_name like '%$search_term%' or last_name 
    like '%$search_term%' or concat_ws(' ',first_name,last_name) 
    like '%$search_term%'; 
```

有什么建议吗？

**编辑：** 我正在测试的名字是“Larry Smith”。数据库将“Larry”存储在“first_name”列中，将“Smith”存储在“last_name”列中。数据干净，没有多余的空格，搜索词被左右修剪。

**编辑 2：** 我今天早上尝试了 Robert Gamble 的答案。他的和我昨晚跑的很相似。我无法解释它，但今天早上它起作用了。我能想到的唯一区别是昨晚我将 concat 函数作为搜索查询的第三个“或”部分运行（在查看了 first_name 和 last_name 之后）。今天早上，在查看了上述内容以及地址和公司名称后，我将其作为最后一部分运行。

在查询结束时运行 mysql 函数是否比在中间运行更好？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2008-11-19T23:17:59.327

你所拥有的应该可以工作，但可以简化为：

```
select * from table where concat_ws(' ',first_name,last_name) 
like '%$search_term%'; 
```

您能否提供一个不起作用的示例名称和搜索词？

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-02-10T11:01:45.250

请注意，搜索查询现在区分大小写。

使用时

```
SELECT * FROM table WHERE `first_name` LIKE '%$search_term%' 
```

它将匹配“Larry”和“larry”。有了这个concat_ws，它会突然变得区分大小写！

这可以通过使用以下查询来解决：

```
SELECT * FROM table WHERE UPPER(CONCAT_WS(' ', `first_name`, `last_name`) LIKE UPPER('%$search_term%') 
```

编辑：请注意，这仅适用于非二进制元素。另请参阅[mynameispaulie 的回答](https://stackoverflow.com/a/13184217/1201863)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-19T23:02:03.963

```
SELECT *,concat_ws(' ',first_name,last_name) AS whole_name FROM users HAVING whole_name LIKE '%$search_term%' 
```

...可能是你想要的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-01T19:33:39.653

对卢克：

我同意您的回答，尽管我想补充一点，UPPER 仅适用于非二进制元素。如果您正在使用 AGE 列（或任何数字），则需要执行 CAST 转换以使 UPPER 函数正常工作。

```
SELECT * FROM table WHERE UPPER(CONCAT_WS(' ', first_name, last_name, CAST(age AS CHAR)) LIKE UPPER('%$search_term%'); 
```

请原谅我没有直接回应 Luc 的回答，但我这辈子都不知道该怎么做。如果管理员可以移动我的帖子，请这样做。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-23T21:49:26.497

你也可以这样做（在mysql中工作）可能还有其他SQL ..试试这个：

```
select * from table where concat(' ',first_name,last_name) 
    like '%$search_term%'; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-20T00:22:16.127

有一些事情可能会妨碍您 - 您的数据是否干净？

可能是您在名字字段的末尾有空格，这意味着当您连接名字和姓氏时，您在名字和姓氏之间有两个空格？使用 trim(first_name)/trim(last_name) 将解决此问题 - 尽管真正的解决方法是更新您的数据。

您也可以匹配两个单词同时出现但不一定同时出现的位置（假设您在 php 中 - $search_term 变量表明您是）

```
$whereclauses=array();
$terms = explode(' ', $search_term);
foreach ($terms as $term) {
    $term = mysql_real_escape_string($term);
    $whereclauses[] = "CONCAT(first_name, ' ', last_name) LIKE '%$term%'";
}
$sql = "select * from table where";
$sql .= implode(' and ', $whereclauses); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2014-11-24T15:40:36.557

你可以试试这个：

```
select * FROM table where (concat(first_name, ' ', last_name)) = $search_term; 
```

# .net - VB.NET 读取文本区域中的当前行？

> ID：303699
> 
> 赞同：3
> 
> 时间：2008-11-19T22:52:16.603
> 
> 标签：.net, vb.net, richtextbox

我有一个文本区域和一个在其上进行语法突出显示的功能。现在它读取整个 RichTextBox。如何获得包含当前行的字符串变量？以下是我目前拥有的代码。

```
Private Sub HighLight()
    Dim rm As System.Text.RegularExpressions.MatchCollection
    Dim m As System.Text.RegularExpressions.Match
    Dim x As Integer ''lets remember where the text courser was before we mess with it

    For Each pass In FrmColors.lb1.Items
        x = rtbMain.SelectionStart
        rm = System.Text.RegularExpressions.Regex.Matches(LCase(rtbMain.Text), LCase(pass))
        For Each m In rm
            rtbMain.Select(m.Index, m.Length)
            rtbMain.SelectionColor = Color.Blue
        Next
        rtbMain.Select(x, 0)
        rtbMain.SelectionColor = Color.Black
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T23:01:15.883

没试过，但是：

```
rtbMain.Lines(lineNumber) 
```

如果不将 Lines 属性分配给数组并访问数组元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T23:03:04.913

我想你想要

```
rtbMain.Lines(rtbMain.GetLineFromCharIndex(rtbMain.SelectionStart)) 
```

# c# - 继承 .net 类

> ID：303700
> 
> 赞同：1
> 
> 时间：2008-11-19T22:52:19.973
> 
> 标签：c#, .net, asp.net

好的，这就是我正在尝试做的我想编写一个继承类 ListItem 的所有内容的类

```
class RealListItem : ListItem
{

  public string anExtraStringINeed;

} 
```

出于某种原因，当我尝试这样做时，.net 将所有成员视为私有成员，因此我的课程毫无价值。

我试图做一个解决方法并这样做：

```
class RealListItem : ListItem
{
  public string anExtraStringINeed;
  public ListItem list;
} 
```

但它仍然不起作用，因为我需要在使用接受类型 ListItem 的函数中使用它，而 RealListItem 并没有发挥应有的作用。我可以做 aRealListItem.list 但只传递来自 RealListItem 的列表我需要传递整个对象。

这是我做错了什么还是微软不会让你继承.net类？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-19T22:58:26.777

System.Web.UI.Controls.ListItem 类是“密封的”......这意味着你不能从它继承......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T23:16:08.833

正如查尔斯所说， ListItem 是密封的，这意味着您不能继承它。在框架中，一些类被标记为密封，而另一些则没有。（没有封印的可以继承。）

您可以创建自己的包含 System.Web.UI.WebControls.ListItem 的 ListItem，但我认为这实际上不会给您带来太多好处。

你想要完成什么？您可能需要找到另一种方法来做事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T23:48:09.250

对于您需要的额外字符串，您最好使用所需的所有额外数据创建一个自定义对象，并将其存储在 ListItem 的“标签”字段中——这就是它的用途。

# tdd - 开发人员对 TDD 不满意。TDD 真的是问题所在，还是新手从业者缺乏技能？

> ID：303701
> 
> 赞同：-6
> 
> 时间：2008-11-19T22:53:09.847
> 
> 标签：tdd, nunit, methodology

（这不是一个调查 TDD 优点的问题。还有其他地方可以进行此类讨论。提前致谢。）

我遇到过太多不熟悉该技术的开发人员，他们也报告对测试驱动开发和 NUnit 不满意。

我听到一些负面评论，例如：

*   “**我不喜欢 NUnit。** 我在一年前尝试过，**但我忘记了如何使用它**。让我们使用我刚刚编写的这个 Windows 窗体应用程序作为测试工具。无论如何，测试代码都是一次性代码，什么是有什么区别？反正我过去的方法还不错。

*   “**我对 TDD 持保留意见**。在我们的最后一个项目中（顺便说一句，这是**我第一次也是唯一一次使用 TDD 的**项目**经验**），我们甚至不知道设计是什么。”

***   “更多的代码注释很糟糕？你疯了吗？如果你不介意的话，我真的有一些工作要做。” （来自老派的更多评论是更好的评论，你永远不会有太多评论。）** 

 **当一个新手抱怨说 TDD 在他们的第一个使用 TDD 的项目中“没有工作”令他们满意时，**是 TDD 真的让他们失望了**，还是开发人员自己**的技能还不足以获得好的结果**？

如果他们不恨我这么说，我怎么能沟通呢？

问题的关键是，可以通过哪些外交手段与开发人员进行沟通，以鼓励他们更诚实地评估自己在新开发技术方面的新生和不足的能力，而不会危及我们重要的工作关系？

通常，许多开发人员显然还没有掌握 TDD 的许多重要元素，以便在他们的第一个项目中很好地完成它。

例如，与我交谈过的开发社区中的抱怨者很典型：

*   甚至从未尝试查看或记住代码异味列表。

*   甚至从未尝试研究重构目录，也从未在实际项目或玩具项目中实践过重构目录。对于某些人来说，可能需要学习更多的 OOP，以便能够很好地进行重构。重构不仅仅是“重命名方法”和“重命名变量”，它们显示为 Visual Studio 2005 重构菜单上的项目。

*   甚至从未尝试过研究或参与使用紧急设计（通过重构）实现的实际项目，与预先使用设计完成整个项目相比，与仅在编写代码后才编写单元测试的整个项目相比，并且知道差异和它们之间的权衡和适用性。

他们似乎都曾经使用过 NUnit，**所以**无论他们用它做什么，都是 TDD，天哪，他们似乎认为。NUnit 或单元测试的存在并不意味着 TDD，但他们还不够了解，甚至不知道这一点。

这些都是聪明人。开发人员是聪明人，因为这是进入整个职业的门槛。否则你不能在这个职业中呆太久。当然，如果他们花时间研究这些材料，他们就可以理解。

当他们的经验和知识的总和显然太弱以至于无法对方法或其结果进行评估时，人们怎么能诚实地告诉自己方法论很弱呢？

然而他们确实……我相信这是一种自我保护的行为。或者是懒惰。如果你甚至无法从 Fowler 的重构书目录中说出三个重构，或者如果你无法说出几个代码异味，那么你就是重构的新手，并且可能也是整个 TDD 方法论，以及你所谓的 1或者2个项目经验显然是不够的。

我可以对人们说些什么，或者我可以引导人们关注哪些材料，以让他们做必要的事情来更多地了解 TDD 成功所依赖的技能，例如：

*   单元测试，
*   重构，
*   设计模式，
*   OO设计和分析？

关于这些主题中的每一个都有整本书，有些非常好。也许也有一些更容易接受的学习技巧？我可以以身作则，但我自己给他们的时间是有限的，而且我还不是所有这些技术的黑带。

此外，他们一起去。没有彼此，它们就不能很好地工作。单元测试和重构就像花生酱和果冻一样。如果你不能 grep 单元测试，那么你的重构肯定不会有很好的结果！（问我为什么如果你还不知道，我很乐意向新人解释。）

同样重要的是，无论我做什么或说什么，都不会适得其反：

我**不能让我的同事疏远 TDD 概念**；此外，我绝不能疏远我的同事**。** 在接下来的许多年里，我将不得不每周与他们一起工作。

很难不让其他长期资深的开发人员感到不安，他们已经证明自己在编程的其他方面非常精通。他们理所当然地为自己过去的成就感到自豪，但是他们的自尊心或他们对编程中所有事情的掌握的自我概念几乎是无法克服的，而不会伤害他们的感情。一些高级开发人员还没有准备好面对他们不知道应该向其他人学习的一些新技术。在编程方面，高级开发人员可以更习惯和更自在地成为房间里的专家，有时他们要求被视为专家，即使在涉及 TDD 和相关技术和技术时这完全不现实。

我很高兴地报告说，在编写结构化自动化单元测试方面，我在扭转我们的常驻“反对者”之一方面取得了相当大的成功，一种方法是与他们一对一地使用结对编程。我猜，结对编程为学员提供了一些现实生活中的例子和经验，以及更有经验和知识渊博的从业者的直接指导。

但是结对编程是不够的。他们需要学习更多的重构、代码异味、OOP 概念和 OOD&A 概念，而我无法在一个项目中教授所有这些，甚至不能接近。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-19T23:01:07.833

把你的想法强加给别人并让他们接受几乎是不可能的。您可以使用自己的方法，也许其他人看到好的结果时会想学习。您是否只是期望像 TDD、结对编程等这些东西能够神奇地获得收益？

你也没有指出你的角色。（或者至少我没找到）

您可以尝试不同的策略：

提供关于 TDD 或 nunit 的午餐时间研讨会。展示你看到的好处。为开发人员/公司提供真实的例子和真正的好处。没有这些，您将不会有乐于接受的听众。

至少你有编写自己的测试工具的人——这是一件好事。我会赞扬这一点，并要求看到更多。

询问开发人员他们对这个问题的看法，他们想要什么样的测试，或者公司可以如何改进。你必须停止强加你的想法，让它来自他们。

编辑 - 从经验

多年前，我也有过类似的经历。我已经阅读了许多关于流程和开发软件的正确方法 (tm) 的书籍，并开始告诉我看到的每个人关于做事的正确方法......没有人想听到它。我意识到我冒着被边缘化的风险并没有真正完成任何有用的事情。所以我只是闭嘴，并在我刚刚获得领导权的小组中实施了一些好的做法。大约 4 个月后，人们开始问**我们**如何获得我们所交付的结果。

不是去找别人，而是来找我们。（那不是我的计划，但回想起来这是有道理的。人们想要结果，而不是热空气）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-19T23:17:42.153

将您的问题浓缩为一行：

```
And how can I communicate that without them hating me for saying it? 
```

作为一个优秀的开发者，你赢得了他们的尊重，然后他们就会倾听。这里真的没有捷径可走。我的建议是成为一个更好的开发者和更好的布道者。如果您向您要教的人学习，那么他们可能会开始向您学习。

恕我直言，您对 TDD 的态度是相当恭敬的。那也无济于事。将此与 TDD 所涉及的重大文化变革相结合，您成功传福音的机会开始急剧减少。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-19T23:02:52.323

我认为 TDD 最大的问题是人们变得专注于这些测试。

在某种程度上，这些测试是无关紧要的。通过所有测试仅证明您已通过所有测试。此外，您可以通过所有测试，拥有完整的覆盖范围，并且仍然拥有一个没有人想要的糟糕、无法使用的应用程序。

通过 100% 的测试和制作出色的产品之间的差距就是所谓的工艺。

另外，TDD 只是指定设计的另一种方式。这是 TDD 的重要部分，可以在一定程度上锁定设计。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-19T23:15:08.990

也许 TDD 不是问题，但您是否考虑过它是否*真的*适合您工作的环境以及您正在从事的项目类型？您没有提及您当前遇到的问题（甚至您当前使用的方法和实践）以及为什么采用 TDD 会解决这些问题。你确定你看到的阻力不是因为改变阻力，而是因为你试图解决一个不存在的问题吗？

TDD 并不适用于所有环境。它确实不适合我工作的地方，因为我们工作得太快了，规范通常是粗略地编写以开始并在每次迭代中改进/更改/重写，所以我们没有*任何*定义的行为来测试大多数时间。此外，我们开发了一些实践，这意味着代码在许多情况下根本*不需要*测试，因为该方法是静态类型检查确保必须工作的单行代码。

您的帖子中有很多评论将您标记为可能相对缺乏经验的人，并且已经锁定了您认为可以解决所有问题的灵丹妙药的方法，如果您的同事要保持这种方法，他们必须学习和你在一起。不幸的是，软件开发没有灵丹妙药，如果他们是有丰富经验的高级开发人员，并且他们不认为 TDD 是合适的，那么也许，*只是也许*，值得听听他们的意见。

您还应该知道，TDD 并不是重构的先决条件，正如那些喜欢“红绿重构”口头禅的人所希望的那样。如果您正在重构一个小区域并且您知道它会影响什么，并且可以轻松地手动测试它，那么您可以在重构期间和重构之后手动测试该区域。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-19T23:07:56.697

只是为了装逼，你为什么这么肯定TDD真的有效？个人经验？实证研究？

这里有两项研究报告了 TDD 的积极结果：

*   [http://ieeexplore.ieee.org/Xplore/login.jsp?url=/iel5/52/4455615/04455636.pdf?arnumber=4455636](http://ieeexplore.ieee.org/Xplore/login.jsp?url=/iel5/52/4455615/04455636.pdf?arnumber=4455636)
*   [测试驱动开发的影响，一项试点研究](http://digitalcommons.calpoly.edu/cgi/viewcontent.cgi?article=1038&context=csse_fac)

还有两个没有定论：

*   [http://www.springerlink.com/content/74145m974llj6678/](http://www.springerlink.com/content/74145m974llj6678/)
*   [http://cat.inist.fr/?aModele=afficheN&cpsidt=17344609](http://cat.inist.fr/?aModele=afficheN&cpsidt=17344609)

我不确定将方法论呈现为完美无缺是一个好主意。这是*一种*可能有效的方法。据我们所知，还有更好的方法。也许邀请所有开发人员设计一种适合您组织的混合方法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-19T23:17:20.513

*   没有人愿意被告知他们在自己的专业领域不够专家。年纪越大的人，他们就越不愿意采用一种让他们感觉自己像个新手的新方法。

*   我在推广测试方面取得的最大成功是创建测试覆盖率的图形报告，并将它们发布给团队（或者让内部团队网页与持续集成测试报告挂钩）。*是的，测试覆盖率并不是质量*的全面衡量标准，但它是一种非常简单的方式来显示谁在编写测试，谁不是。

*   让我们进行大学竞争，看看谁能将他们的代码覆盖率保持在最高百分比。人们喜欢竞争。当他们落后，或者如果他们用不可测试的“代码口袋”编写代码，也许他们会考虑重构它的方法，以便他们的测试确实显示代码覆盖率。如果他们不喜欢被“教育”，那就让他们自己发现重构技术。这样他们就可以继续感到聪明。

*   或者有一些棕色袋子午餐，人们可以在其中展示他们为实现更高的可测试性所做的一些巧妙的重构。人们喜欢炫耀！他们比他们更喜欢被展示他们的无知。

*   这与 TDD 相距甚远，但至少在更好的 QC 方面取得了一些进展。一旦他们对工具和一些简单的重构方法更加熟悉，那么您就可以逐渐引入一些更高级的东西：结对编程...代码审查...检测代码异味...跟踪需求到测试。 **然后**你可以绕过 TDD。

正如 Steven Lowe 在这篇文章中所说，罗马不是一天建成的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-20T00:14:41.477

您真正的问题是“我如何说服我的同事尝试新事物？”

这是一个非常好的问题，很抱歉这真的很难。几年前，我与 Alistair Cockburn 就这个主题进行了一次谈话，我已经发布[了幻灯片](http://blog.jeffreyfredrick.com/2008/07/07/tic-tac-change-slides/)，但还没有写出文字，但我可以在这里给出一个简短的版本。

您是否熟悉[技术采用生命周期](http://en.wikipedia.org/wiki/Technology_Adoption_LifeCycle)或[跨越鸿沟](http://en.wikipedia.org/wiki/Crossing_the_Chasm)？这些涉及人口的各个部分及其改变的动机。与您的情况相关的关键思想是，只有位于鸿沟左侧的人——创新者和早期采用者——有兴趣改变以尝试让事情变得更好。鸿沟右侧的人——大多数人——更抗拒改变，而当他们改变时，原因与左侧的人不同。结果，这两组人往往会互相交谈。

你在鸿沟的左边。你的大学在右边。如果你一直给他们**你**改变的理由，你就不会说服他们。

说服他们尝试新事物的是，如果它提供了减轻他们目前感受到的一些痛苦的可靠承诺。

谈论 TDD 如何变得更好以及您应该做什么，而您正在谈论它们。

谈论TDD如何解决当前的一些痛苦，你会引起他们的注意。

还有杀手锏？如果没有当前的疼痛，你就不可能让他们改变，时期。

这就是为什么选项是“更改您的组织或更改您的组织”。

祝你好运！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-23T20:09:12.047

引起我注意的第一件事是：“无论如何，测试代码都是一次性代码”。我的意思是，*哇。*

当然，TDD 的情况正好相反。您的测试成为您的回归防火墙，并允许您自信地重构和添加功能。

以我的经验，将这样的做法引入抗拒（但不是完全顽固）的公司文化中必须有两件事：你必须有一个得到它的经理授权的做法，你必须有一个工程师在以前使它工作的团队。该工程师的时间必须在实际项目工作和指导之间分配，指导采取小组演示、代码审查和（准备好）结对编程的形式，以直接向人们展示如何将实践应用于他们试图解决的问题。

除了过去成功之外，这位工程师还必须是一位熟练的教师，并且（因为您要求人们做出改变，大多数人会认为这是人身攻击）具有不具威胁性的个性和教学方法。

祝你好运。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-29T03:53:55.197

这需要时间，并且需要（因为没有更好的词）营销。TDD（或一般的单元测试）在团队成员尊重的人提倡之前不会被接受。

如果您还不是团队中最受尊敬的成员之一，那么您要么必须成为其中一员（通过展示卓越），要么专注于一个或多个技术领导者，让他们站在你这边。

当然，每个人都是不同的，您必须弄清楚如何向各个部落首领展示 TDD，以便他们尽可能地接受这个想法。

绝对必须发生的一件事是必须使创建测试和运行测试变得超级容易。如果您是从人们对 TDD 的优势持怀疑态度的位置开始的，那么尝试它的道路上的任何小颠簸都会非常缺乏动力。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-19T22:57:35.827

罗马不是一天建成的+其他陈词滥调的耐心

继续结对并树立好榜样，其他人会看到光明并效仿你

你可以把马牵到水边，但你不能让他喝水。如果你把他推到水里，他要么淹死，要么逃跑。;-)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-19T23:10:17.613

更有可能的问题是，在习惯 TDD 风格和创建 TDD 所需的文化的同时降低生产力是否是我认为事情出错的地方。

那些高级开发人员的生产力是否会大幅下降，这是每个人都可以接受的吗？如果您能感觉到每个人都可以重新学习如何开发代码，那么您可能会有所收获，但请记住，大多数开发人员都有自己的个人优化来编写我认为 TDD 会取消的代码，例如猜测然后解决错误可能是一种常见的方法，如果您使用严格的 TDD 形式，它并不能完全消除它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-03-01T17:10:41.437

有关使用 TDD 解决 hello world 问题的示例方法，请参见下面的链接

[https://stackoverflow.com/a/15163004/2124293](https://stackoverflow.com/a/15163004/2124293)

你可以看看 hello world 的简单性，但看看你可以从思考过程中得到什么

# java - 调用 JNI 模式对话框会禁用任务栏图标

> ID：303712
> 
> 赞同：1
> 
> 时间：2008-11-19T22:55:54.270
> 
> 标签：java, window, java-native-interface, native, taskbar

在 Windows XP 上的 Java 应用程序 (JRE 1.5.0_12) 中，我调用了本机方法：

```
public native int attachImage( ... ); 
```

...它存在于 Visual C++ 6.0 .dll 中。它显示一个应用程序模式窗口。问题是，当这个窗口有焦点时，应用程序的托盘图标不响应鼠标点击。这是一个问题，因为当显示此窗口时，用户经常切换到另一个应用程序以选择要附加的图像，然后想要恢复此应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T23:10:58.763

您使用的是什么 GUI 包？

您应该能够在不诉诸 JNI 调用的情况下实现这一点。

例如，在 SWT 中，您可以像这样打开应用程序模式 shell：

```
Shell shell = new Shell(display,SWT.APPLICATION_MODAL); 
```

对于摇摆，这将是：

```
dialog.setModalityType(Dialog.ModalityType.APPLICATION_MODAL); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T23:39:32.607

您的 attachImage 方法是否未将父窗口正确设置为您的 java 应用程序窗口？获得一个 hwnd 可能很棘手（GetForegroundWindow/etc？）但它可能是必要的吗？

另外，为什么图像部分需要是JNI？这可能会帮助我们找到一个完全避免 JNI 部分的解决方案？

# firefox - 如何以 IE/Opera 的方式显示不存在的图像？

> ID：303718
> 
> 赞同：4
> 
> 时间：2008-11-19T22:58:31.690
> 
> 标签：firefox

我的 Firefox 3.0.4 根本不显示不存在的图像，或者将图像 alt 显示为纯文本（如果可用）。
这样我就不知道那里应该有一个图像。

有谁知道是否有办法让它像 IE/Opera 一样工作？（即，即使图像文件不存在也显示一个框） - 插件或任何东西？

测试图像：![[残像测试]](https://example.com/notavalidlink)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-19T09:09:58.247

about:config 中有一个设置应该这样做：`browser.display.show_image_placeholders`。然而，它自己并没有做任何事情。

您需要[添加一个规则，`userContent.css`](http://blog.doxmart.com/2009/08/11/a-quick-tip-on-enabling-broken-image-placeholders-in-firefox-3-and-beyond/)如下所示：

```
/*
 * Show image placeholders
 */
@-moz-document url-prefix(http), url-prefix(https), url-prefix(file) {
  img:-moz-broken {
    -moz-force-broken-image-icon: 1;
    width: 24px;
    height: 24px;
  }
} 
```

然后图像将显示如下：

> ![示例截图](https://i.stack.imgur.com/EjsLz.png)

请注意，这会隐藏 alt 文本，这与 Chrome 会在占位符旁边显示 alt 文本不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T23:19:45.313

你可以得到[Firebug 插件](http://getfirebug.com/)。它不会改变图像的显示方式，但它确实有一个网络选项卡，您可以单击该选项卡以查看 Firefox 获取了哪些资源（以及速度有多快）。同样，它会告诉你它无法获取哪些图像、js 文件和 css 文件。它对于 Web 开发非常方便。

它还有很多其他很棒的功能，比如 JS 调试等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T23:38:22.797

有一个实验性的[Force Image Placeholders](https://addons.mozilla.org/en-US/firefox/addon/7811)插件，它会尝试执行您的请求。我没用过，但值得一试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T00:31:08.667

这是另一个基于插件的解决方法。

*   获取适用于 Firefox 的[Stylish](https://addons.mozilla.org/en-US/firefox/addon/2108)插件，允许您应用自己的样式信息。
*   `<img>`为所有标签添加背景。如果图像加载，您将看不到它。

但请注意，如果任何图像依赖透明度，则新的默认背景将显示出来。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-11T09:49:03.393

我的扩展[FeatureFix](https://addons.mozilla.org/en-US/firefox/addon/featurefix/)现在在其配置 GUI（“高级/开发人员调整”）中包含一个综合部分，用于配置损坏/加载图像占位符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T00:35:32.837

按照 Pim Jager 的建议，但您似乎需要强制图像显示为“display：block;”之类的内容。这样做的好处是允许您通过 CSS 指定其他样式，如果图像没有，则显示这些样式 - 例如背景颜色，甚至是背景图像。YMMV。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-19T23:18:03.260

据我所知，没有插件，图像应该有一个宽度和高度，如下所示：

```
<img src='...' width='100' height='100' alt='...'></img>
or
<img src='...' alt='...' style='width:100px; height:100px;'></img> 
```

然后Firefox将为图像保留适当的空间。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-06-08T20:31:50.937

没有任何效果，根据经验和对这件事的所有研究，Firefox 不会（无论如何在 Windows 中）显示损坏的图标/图像占位符图标，无论 css 和 about:config 设置如何。

最糟糕的是所有其他浏览器默认都这样做，所以如果你想知道转储 Firefox 到底发生了什么。

# javascript - 是否存在不暂停脚本的 JavaScript 警报？

> ID：303720
> 
> 赞同：42
> 
> 时间：2008-11-19T22:59:13.640
> 
> 标签：javascript

我正在寻找类似的东西`alert()`，但这不会“暂停”脚本。

我想显示警报并允许下一个命令 form`submit()`继续。因此，在显示警报后页面会发生变化，但不会等到用户单击“确定”。

有没有这样的事情，或者它只是那些不可能的事情之一？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-11-19T23:04:57.717

您可以在 setTimeout （非常短的超时）中发出警报，因为 setTimeout 是异步的：

```
setTimeout("alert('hello world');", 1); 
```

或者要正确地做到这一点，您确实会在 setTimeout 中显示使用方法而不是字符串：

```
setTimeout(function() { alert('hello world'); }, 1); 
```

否则，您将面临 JavaScript 注入攻击。当您传递一个字符串时，它会通过 JavaScript`eval`函数运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T23:29:16.293

如果已经在使用 JQuery [http://docs.jquery.com/UI/Dialog](http://docs.jquery.com/UI/Dialog)很容易使用并且样式很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T23:17:27.877

它可能不是您要查找的内容，但使用 window.status = 'foo' 可能是合适的。

我在我的一个用于 Intranet 的 webapps 中经常使用它。setTimeout 方法也有效，但如果浏览器忙于密集任务，它可能会阻塞。但是状态栏更新总是立即的。

这确实要求您的查看者具有 javascript 可以更改状态栏的设置——如果它是受信任的站点，则总是如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T23:05:40.163

在这种情况下，使用 DHTML 和 JavaScript 来动态显示消息会更合适，无论是在纯 HTML 元素中，还是看起来更像对话框（但不是）的东西中。这将为您提供所需的控制。所有主要的 JavaScript 框架（YUI、Dojo 等）都可以让您异步显示消息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T23:05:41.567

不可靠。在新页面上使用 div。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-20T15:05:14.303

98% 的情况下，有一种方法可以移动您的消息脚本，以便它在其他所有内容执行后调用。对于另外 2%，我喜欢使用看起来像这样的浮动 div。然后，您可以更改您的 CSS 以匹配您的应用程序/网站的样式，或者使其看起来更像一个标准的窗口弹出窗口。

```
/*HTML*/
<div class="floatingDiv" id="msgBox" style="visibility:hidden"></div>

/*javaScript*/
function openWindow(id){
"use strict";
document.getElementById(id).style.visibility = 'visible'; 
}
function closeWindow(id){
"use strict";
document.getElementById(id).style.visibility = 'hidden'; 
}
function myMsgBox(TITLE,MESSAGE) {
"use strict";   
document.getElementById("msgBox").innerHTML = "<a href=\"javascript:closeWindow('msgBox')\" style=\"float:right\"><img src=\"imgs/close.png\" onmouseover=\"src='imgs/closeOver.png'\" onmouseout=\"src='imgs/close.png'\"/ alt=\"[close]\"></a><h2 style=\"text-align:center; margin-top:0px;\">" + TITLE + "</h2><hr><p align=\"left\">" + MESSAGE + "</p>";
openWindow("msgBox");
}

/*CSS*/
.floatingDiv {
position:absolute;  
z-index:10000;
left:33%;
top:250px;
width:33%;
background-color:#FFF;
min-width:217px;
text-align: left;
border-radius: 10px 10px;
border:solid;
border-width:1px;
border-color:#000;
vertical-align:top;
padding:10px;

background-image: -ms-linear-gradient(top, #CCCCCC 0%, #FFFFFF 25px, #FFFFFF 100%);
background-image: -moz-linear-gradient(top, #CCCCCC 0%, #FFFFFF 25px, #FFFFFF 100%);
background-image: -o-linear-gradient(top, #CCCCCC 0%, #FFFFFF 25px, #FFFFFF 100%);
background-image: -webkit-linear-gradient(top, #CCCCCC 0%, #FFFFFF 25px, #FFFFFF 100%);
background-image: linear-gradient(to bottom, #CCCCCC 0%, #FFFFFF 25px, #FFFFFF 100%);

box-shadow:3px 3px 5px #003; 
filter: progid:DXImageTransform.Microsoft.Shadow(color='#000033', Direction=145, Strength=3);
} 
```

# asp.net - ASP.NET 应用程序状态与静态对象

> ID：303725
> 
> 赞同：41
> 
> 时间：2008-11-19T23:00:14.667
> 
> 标签：asp.net, static-members, application-state

如果我有一个标准的 ASP.NET 应用程序，那么将对象设为静态与将对象实例置于应用程序状态之间有什么区别吗？

据我了解，这两个对象在应用程序域中都存在一次。

其次，如果您在引用的 dll 中有一个静态对象，对于 ASP.NET 站点，会发生什么情况。它也是应用程序域的一部分，所以它总是存在一次？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-11-19T23:23:46.803

来自： http: [//support.microsoft.com/default.aspx ?scid=kb;en-us;Q312607](http://support.microsoft.com/default.aspx?scid=kb;en-us;Q312607)

> ASP.NET 包括应用程序状态，主要是为了与经典 ASP 兼容，以便更容易将现有应用程序迁移到 ASP.NET。建议您将数据存储在应用程序类的静态成员中，而不是应用程序对象中。这提高了性能，因为您可以比访问应用程序字典中的项目更快地访问静态变量。

另外，是的，静态变量的行为方式相同，无论它们是从哪里加载的，并且每个应用程序域仅存在一次（除非您谈论的是那些标记为 [ThreadStatic] 的变量）

# python - （Python）每个地址上的socket.gaierror ...除了http://www.reddit.com？

> ID：303726
> 
> 赞同：0
> 
> 时间：2008-11-19T23:00:57.630
> 
> 标签：python, http, sockets

我只是在玩，我正在尝试从网站上获取信息。不幸的是，使用以下代码：

```
import sys
import socket
import re
from urlparse import urlsplit

url = urlsplit(sys.argv[1])

sock = socket.socket()
sock.connect((url[0] + '://' + url[1],80))
path = url[2]
if not path:
    path = '/'

print path
sock.send('GET ' + path + ' HTTP/1.1\r\n'
    + 'User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/525.19 (KHTML, like Gecko) Chrome/0.3.154.9 Safari/525.19\r\n'
    + 'Accept: */*\r\n'
    + 'Accept-Language: en-US,en\r\n'
    + 'Accept-Charset: ISO-8859-1,*,utf-8\r\n'
    + 'Host: 68.33.143.182\r\n'
    + 'Connection: Keep-alive\r\n'
    + '\r\n') 
```

我收到以下错误：

> Traceback（最近一次调用最后一次）：
> 文件“D:\Development\Python\PyCrawler\PyCrawler.py”，第 10 行，在 sock.connect((url[0] + '://' + url[1],80 )) 文件“”，第 1 行，在连接 socket.gaierror: (11001, 'getaddrinfo failed')

我唯一没有收到错误的情况是传递的 url 是[http://www.reddit.com](http://www.reddit.com)。我尝试过的所有其他 url 都带有 socket.gaierror。谁能解释一下？并可能给出解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T23:09:00.500

> ```
> sock.connect((url[0] + '://' + url[1],80)) 
> ```

不要那样做，而是这样做：

```
sock.connect((url[1], 80)) 
```

`connect`需要一个主机名，而不是 URL。

实际上，您可能应该使用比套接字更高级别的东西来执行 HTTP。也许[httplib](http://docs.python.org/library/httplib.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T00:02:29.567

拜托拜托拜托拜托请不要这样做。

urllib 和 urllib2 是你的朋友。

如果您遇到问题，请阅读[“缺失”的 urllib2 手册。](http://www.voidspace.org.uk/python/articles/urllib2.shtml)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T16:32:59.757

你有没有修改过你的[Hosts 文件](http://en.wikipedia.org/wiki/Hosts_file)？如果它有 Reddit 的条目，但没有太多其他条目，这可能解释了该网站的独特结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T23:08:52.293

您忘记解析主机名：

```
addr = socket.gethostbyname(url[1])
...
sock.connect((addr,80)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T16:44:05.893

使用 urllib2。或[美丽汤](http://www.crummy.com/software/BeautifulSoup/)。

# c# - System.Net.Mail - 邮件地址中的无效字符

> ID：303731
> 
> 赞同：0
> 
> 时间：2008-11-19T23:02:22.917
> 
> 标签：c#, .net, asp.net, smtp

如何使用 SYStem.Net.Mail 将电子邮件发送到不常见的电子邮件地址 (myFirstName.O'Reilly@mywebsite.com) 但仍符合[RFC 5322](http://en.wikipedia.org/wiki/E-mail_address)？

.NET 是否支持发送包含单引号的邮件地址，如果支持，我如何强制系统允许将电子邮件发送到这些地址？现在我们正在使用 System.Net.Mail 类来发送邮件，但它正在轰炸那些特定类型的电子邮件地址。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T23:13:36.793

它应该可以工作 - [http://social.msdn.microsoft.com/Forums/en-US/netfxnetcom/thread/84dd5b66-f68d-4b0c-823f-25aa7c7b4d6b/](http://social.msdn.microsoft.com/Forums/en-US/netfxnetcom/thread/84dd5b66-f68d-4b0c-823f-25aa7c7b4d6b/)

即创建MailAddress("myFirstName.O'Reilly@mywebsite.com")，然后使用它来创建MailMessage，并传递给SmtpClient.Send。

# vbscript - VBScript：如何将记录集的值设置为字符串

> ID：303745
> 
> 赞同：2
> 
> 时间：2008-11-19T23:08:39.923
> 
> 标签：vbscript, string, recordset

这可能是一个初学者的问题，但是如何将记录集设置为字符串变量？

这是我的代码：

```
Function getOffice (strname, uname) 

strEmail = uname
WScript.Echo "email: " & strEmail 
Dim objRoot : Set objRoot = GetObject("LDAP://RootDSE")
Dim objDomain : Set objDomain = GetObject("LDAP://" & objRoot.Get("defaultNamingContext"))
Dim cn : Set cn = CreateObject("ADODB.Connection")
Dim cmd : Set cmd = CreateObject("ADODB.Command")
cn.Provider = "ADsDSOObject"
cn.Open "Active Directory Provider"
Set cmd.ActiveConnection = cn

cmd.CommandText = "SELECT physicalDeliveryOfficeName FROM '" & objDomain.ADsPath & "' WHERE mail='" & strEmail & "'"
cmd.Properties("Page Size") = 1
cmd.Properties("Timeout") = 300
cmd.Properties("Searchscope") = ADS_SCOPE_SUBTREE

Dim objRS : Set objRS = cmd.Execute

  WScript.Echo objRS.Fields(0)

Set cmd = Nothing
Set cn = Nothing
Set objDomain = Nothing
Set objRoot = Nothing

Dim arStore 

Set getOffice = objRS.Fields(0)

Set objRS = Nothing

End function 
```

当我尝试运行该函数时，它会引发错误“vbscript 运行时错误：类型不匹配”，我认为这意味着它无法使用记录集值设置字符串变量。

我该如何解决这个问题？

* * *

我刚试过

如果 IsNull(objRS.Fields(0).Value) = TRUE 那么 getOFFice = "noAD" else getOFFice = objRS.Fields(0).VALue end if

这会引发不同的错误 ADODB.Field：BOF 或 EOF 为 True，或者当前记录已被删除。请求的操作需要当前记录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-26T21:41:00.487

尝试这个：

```
 getOffice = objRS.getString 
```

这会将整个记录集作为制表符分隔的字符串返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T19:30:46.803

Set 仅用于对象，不能用于字符串等简单变量。
试试这个：（它还确保记录集不为空）

```
 If objRS.RecordCount <> 0 Then
  getOffice = CStr(objRS.Fields(0))
Else
  getOffice = ""
End If 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-23T15:49:11.013

你确定你的记录集不是空的吗？通常你会想在开始做任何事情之前先检查一下。对它需要做什么一无所知，我可能会建议这样的事情：

```
Function getOffice (strname, uname) 

strEmail = uname
WScript.Echo "email: " & strEmail 
Dim objRoot : Set objRoot = GetObject("LDAP://RootDSE")
Dim objDomain : Set objDomain = GetObject("LDAP://" & objRoot.Get("defaultNamingContext"))
Dim cn : Set cn = CreateObject("ADODB.Connection")
Dim cmd : Set cmd = CreateObject("ADODB.Command")
cn.Provider = "ADsDSOObject"
cn.Open "Active Directory Provider"
Set cmd.ActiveConnection = cn

cmd.CommandText = "SELECT physicalDeliveryOfficeName FROM '" & objDomain.ADsPath & "' WHERE mail='" & strEmail & "'"
cmd.Properties("Page Size") = 1
cmd.Properties("Timeout") = 300
cmd.Properties("Searchscope") = ADS_SCOPE_SUBTREE

Dim objRS : Set objRS = cmd.Execute

If Not objRS.BOF Then objRS.Move First
If Not objRS.EOF Then 
  If Not IsNull(objRS.Fields(0)) and objRS.Fields(0) <> "" Then  WScript.Echo cStr(objRS.Fields(0))
End If

Set cmd = Nothing
Set cn = Nothing
Set objDomain = Nothing
Set objRoot = Nothing

Dim arStore 

Set getOffice = objRS.Fields(0)

Set objRS = Nothing

End function 
```

显然有很多方法可以检查空记录集，检查空值等，但这里有一种方法可能有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T23:11:43.583

```
Cstr(objRS.Fields(0)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T23:12:19.370

尝试改变这个：

设置 getOffice = objRS.Fields(0)

对此：

getOffice = objRS.Fields(0)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T23:18:01.310

根据我的经验，从 DB 调用返回数据的各种方式通常非常依赖于用于访问数据的方法/驱动程序（例如 ODBC、ADO、ADO.NET、ODP.NET、OleDB 等）。需要 ToString()、GetString()、演员表或其他一些变体。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-20T00:07:30.243

我刚刚在顶部添加了“On Error Resume Next”，它只是跳过了空错误。

虽然我希望有一种更简单的方法来处理 vbscript 中的 NULL 值。

感谢你的帮助

# delphi - 从 Delphi 应用程序中激活文件病毒扫描

> ID：303755
> 
> 赞同：1
> 
> 时间：2008-11-19T23:12:16.517
> 
> 标签：delphi, api, antivirus

我们有一个应用程序可以监控文件夹中的文件丢失，并且需要在使用任何传入文件之前启动病毒扫描。

这需要是 Delphi 应用程序的一部分，并且该文件必须通过病毒扫描，否则我们将删除该文件。

我知道有可用的命令外壳选项，但是这**必须**是对安装在 PC 上的已注册 AV 引擎的直接 API 调用。

我们已经查看了 MSOffice AntiVirus API，但这似乎只适用于希望制作由托管应用程序触发的扫描应用程序的开发人员。我们需要相反的。

任何有关病毒扫描引擎和 API 的建议将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T23:52:33.267

该过程[在](http://msdn.microsoft.com/en-us/library/ms537371(VS.85).aspx "防病毒 API 简介")标题为“Internet Explorer 5 和 Office 2000 实施”的部分中进行了描述。

枚举类别的 Delphi 实现可[在此处](http://users.telenet.be/ws36637/msoav.html)获得(GetRegisteredAntiviruses)。只需填写一个 TMsoavinfo 并调用**Scan**。

大多数 AV 程序允许您通过在命令行上将文件作为单个参数传递来扫描文件 - 我相信 Windows Live Messenger 使用这种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T08:48:29.613

使用病毒扫描检查邮件服务器。VPOP3 支持两种扫描仪，其中一种是 Sophos（面向商业的 AV）。这将引导您使用 API。

# c++ - 将字符串转换为长长

> ID：303759
> 
> 赞同：9
> 
> 时间：2008-11-19T23:14:31.223
> 
> 标签：c++, string, visual-studio-2008

我正在使用 VS 2008 创建一个 C++ DLL（非托管）项目，我需要将 char* 转换为 long long 类型。有没有简单的方法来做到这一点？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-19T23:29:47.807

最简单的方法是使用 std::stringstream （它也是最安全的......）

```
std::stringstream sstr(mystr);
__int64 val;
sstr >> val; 
```

您可能需要以 64 位应用程序为目标才能使其正常工作。

[C++ 常见问题](http://www.parashift.com/c++-faq-lite/misc-technical-issues.html#faq-39.2)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-19T23:45:57.757

在我看来，如果您使用的是 boost，那么 lexical_cast 是最好的选择。

```
long long ll = boost::lexical_cast<long long>(mystr) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-19T23:28:49.167

试试`_atoi64.` 这需要`char*`并返回`__int64`。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-11-12T21:34:49.903

另一种选择是使用字符串库中的 stoll() 。采用 C++ 字符串。

```
long long ll = std::stoll(mystr); 
```

[文档](http://www.cplusplus.com/reference/string/stoll/)

# use-case - 协程的用例是什么？

> ID：303760
> 
> 赞同：54
> 
> 时间：2008-11-19T23:14:35.747
> 
> 标签：use-case, coroutine

[协程](http://en.wikipedia.org/wiki/Coroutine)的概念听起来很有趣，但我不知道，在真正的生产环境中是否有意义？协程的用例是什么，协程实现比其他方法更优雅、更简单或更高效？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-20T00:00:42.267

一个用例是具有多个同时连接的 Web 服务器，需要安排与所有连接并行的读取和写入。

这可以使用协程来实现。每个连接都是一个协同程序，它读取/写入一些数据，然后将控制权交给调度程序。调度程序传递到下一个协程（它做同样的事情），循环遍历所有连接。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-09-26T16:39:58.733

用例：协程通常在游戏编程中用于时间片计算。

为了在游戏中保持一致的帧速率，例如 60 fps，您有大约 16.6 毫秒的时间来执行每一帧中的代码。这包括物理模拟、输入处理、绘图/绘画。

假设您的方法在每一帧中执行。如果您的方法需要很长时间并且最终跨越多个帧，那么您将在游戏循环中错开其余的计算，这会导致用户看到“卡顿”（帧速率突然下降）。

协程可以对计算进行时间切片，以便它在每一帧中运行一点点。

为此，协程允许该方法将计算“让给”回“调用者”（在本例中为游戏循环），以便下次调用该方法时，它会从中断的地方恢复。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-11-20T03:26:43.710

Unix管道是一个用例：

```
grep TODO *.c | wc -l 
```

上面的管道是一个协程。该`grep`命令生成一系列行并将它们写入缓冲区。该`wc`命令从缓冲区中读取这些行。如果缓冲区填满，则`grep`“阻塞”直到缓冲区清空。如果缓冲区为空，则`wc`等待缓冲区中的更多输入。

协程更常用于更受约束的模式中，例如提到的 Python 生成器，或用作管道。

有关更多详细信息和示例，请阅读 Wikipedia 文章，尤其是[coroutines](http://en.wikipedia.org/wiki/Coroutine)和[iterators](http://en.wikipedia.org/wiki/Iterator)。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-11-19T23:23:57.817

真正的协程需要语言支持。它们需要由编译器实现并得到底层框架的支持。

协程的一种语言支持的实现是 C# 2.0`yield return`关键字，它允许您编写一个返回多个值以进行循环的方法。

但是，`yield return`确实有局限性。该实现使用辅助类来捕获状态，并且它仅支持协程作为生成器（迭代器）的特定情况。

在更一般的情况下，协程的一个优点是它们使某些基于状态的计算更容易表达和理解。例如，将状态机实现为一组协程可能比其他实现更优雅。但这样做需要 C# 或 Java 中尚不存在的语言支持。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-11-19T23:31:14.170

协程对于实现生产者/消费者模式很有用。

例如，Python 在名为[generators](http://docs.python.org/tutorial/classes.html#generators)的语言特性中引入了协程，旨在简化迭代器的实现。

它们对于实现协作多任务也很有用，其中每个任务都是一个协程，可以让给调度程序/反应器。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-07-14T15:52:35.087

当系统执行两个或多个任务时，协程可能很有用，这些任务最自然地被描述为一系列涉及大量等待的长时间运行的步骤。

例如，考虑具有 LCD 和键盘用户界面和调制解调器的设备，它需要使用调制解调器定期调用和报告其状态，而与键盘上的用户正在做什么无关。编写用户界面的最佳方式可能是使用诸如“input_numeric_value(&CONV_SPEED_FORMAT, &conveyor_speed);”之类的函数。当用户输入一个值时它会返回，处理通信的最好方法可能是使用像“wait_for_carrier();”这样的函数 当设备已连接或确定它不会连接时，它将返回。

如果没有协程，UI 子系统或调制解调器子系统都必须使用状态机来实现。使用协程可以让两个子系统都以最自然的方式编写。请注意，重要的是，任何子系统都不会在不将事物置于“一致”状态并调用yield（）的情况下运行很长时间，也不会在不首先将事物置于“一致”状态的情况下调用yield（），但通常不难满足那些约束。

请注意，虽然可以使用成熟的多任务处理，但几乎在任何共享状态发生更改的地方都需要广泛使用锁或其他互斥结构。由于协程切换器除了在 yield() 调用之外永远不会切换任何东西，因此任何一个例程都可以自由地改变共享状态，只要它确保在下一个 yield 之前一切都井然有序，并准备好让另一个例程改变状态“在“产量（）期间。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-02-04T18:20:32.980

作为一个生产者/消费者的例子，一个批处理报告程序是用协程实现的。

该示例的关键提示是消耗输入数据的重要工作（例如解析数据或在帐户上累积费用和付款），以及产生输出的重要工作。当你具备这些特征时，那么：

*   如果您可以在不同的地方编写工作单元，则很容易组织/理解输入端代码。
*   如果输出端代码可以读取嵌套控制结构中的下一个工作单元，则同样易于组织/理解输出端代码。

那么协程和队列都是可供您使用的好技术。

# drupal - 如何获取当前drupal主题的路径？

> ID：303761
> 
> 赞同：27
> 
> 时间：2008-11-19T23:14:48.617
> 
> 标签：drupal, drupal-6, drupal-theming

Drupal API[`drupal_get_path($type, $name)`](http://api.drupal.org/api/function/drupal_get_path/6)可以提供任何特定主题或模块的路径。如果我想要当前主题的路径怎么办？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-20T18:38:02.870

使用该[`path_to_theme`](http://api.drupal.org/api/function/path_to_theme/6)功能。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-19T23:25:54.430

这应该有效（[文档](http://api.drupal.org/api/globals)）：

```
global $theme;
$path = drupal_get_path('theme', $theme);

// there's also a $theme_path global

global $theme_path; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-03-03T20:40:59.760

在 D6 中 path_to_theme() 可能不会以您期望的方式运行，具体取决于您使用它的方式。如果你在任何主题预处理函数之外使用它，那么它可能会给你你想要的，但是如果它在模块的主题/预处理钩子函数的上下文中被调用......它将指向模块路径宣布了主题。

前任。如果我有一个主题“my_theme”和我的模块“my_module”，它使用预处理钩子覆盖论坛主题，在我的模块中调用 path_to_theme()：例如 my_module_preprocess_forums()... 将返回“forums”，而不是“my_theme “正如人们所预料的那样。

如果你问我，非常有果味。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-02-07T12:44:33.027

在 Drupal 7 中，为了获取当前主题的路径，我们可以使用： [path_to_theme()](https://api.drupal.org/api/drupal/includes!theme.inc/function/path_to_theme/7)函数。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-01-29T09:30:29.717

在 Drupal 8 中

```
global $base_url;
$theme = \Drupal::theme()->getActiveTheme();
$image_url = $base_url.'/'. $theme->getPath() .'/images/image.jpg'; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-11-11T12:17:23.523

在 Drupal 8 中，如果您需要在激活管理主题时获取活动主题路径，您可以获取默认主题路径：

```
$themeHandler = \Drupal::service('theme_handler');
$themePath = $themeHandler->getTheme($themeHandler->getDefault())->getPath(); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T17:46:46.483

在 Drupal 5 中，您可以简单地使用： path_to_theme()

这将为您提供从 Drupal 根目录到特定主题目录的完整路径。请注意，它不包含尾部斜杠。

在 Drupal 6 中，它的行为略有不同。如果您从页面中调用它，它将调用当前正在执行主题的任何内容......无论是您的主题、模块等。这是来自 API 文档的关键引用：

> 它可以指向活动主题或处理主题实现的模块。例如，当在主题调用范围内调用时，它将取决于处理主题函数的位置。如果从一个模块实现，它将指向该模块。如果从活动主题实现，它将指向活动主题。当在主题调用范围之外调用时，它将始终指向活动主题。

来源：[http ://api.drupal.org/api/function/path_to_theme](http://api.drupal.org/api/function/path_to_theme)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-20T16:48:44.090

对于 D8，主题文件夹在预处理函数中可用：

```
function hook_preprocess_page(&$variables) {
  $variables['some_logo_file'] = "/{$variables['theme']['path']}/images/logo.png";
} 
```

page.html.twig：

```
<img src="{{ logo_src }}"> 
```

# visual-studio - 在 VS2005/2008 中自动化“附加到进程”

> ID：303763
> 
> 赞同：8
> 
> 时间：2008-11-19T23:15:47.290
> 
> 标签：visual-studio, debugging

我想知道是否有人知道宏或键盘快捷键或任何真正可以在 Visual Studio 中自动附加到进程的东西？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-19T23:19:39.277

`CTRL + ALT + P`弹出对话框。然后点击您要附加到的进程的第一个字母，例如`W`w3wp.exe

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-19T23:16:39.703

`System.Diagnostics.Debugger.Break()`

“如果没有附加调试器，则询问用户是否要附加调试器。如果是，则启动调试器。如果附加了调试器，调试器会收到用户断点事件的信号，并且调试器会暂停进程的执行就像遇到了调试器断点一样。”

-- [http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-18T03:59:00.030

该宏在[使用一个快捷方式附加到进程后进行了描述](http://blog.lavablast.com/post/2008/01/11/Attach-to-Process-with-one-shortcut.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T23:37:19.663

您可以只录制宏并在选项对话框中为其分配键盘快捷键。这就是我所做的。我按下 CTRL-ALT-SHIFT-Z 并为我附加到 aspnet_wp.exe。

# javascript - 如何确定 jQuery 中窗口的高度和滚动位置？

> ID：303767
> 
> 赞同：181
> 
> 时间：2008-11-19T23:17:22.683
> 
> 标签：javascript, jquery

我需要在 jQuery 中获取窗口的高度和滚动偏移量，但是在 jQuery 文档或 Google 中我没有找到任何运气。

我 90% 确定有一种方法可以访问元素（可能包括窗口）的 height 和 scrollTop，但我只是找不到具体的参考。

* * *

## 回答 #1

> 赞同：298
> 
> 时间：2008-11-19T23:24:37.893

来自 jQuery 文档：

```
const height = $(window).height();
const scrollTop = $(window).scrollTop(); 
```

[http://api.jquery.com/scrollTop/](http://api.jquery.com/scrollTop/)
[http://api.jquery.com/height/](http://api.jquery.com/height/)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2010-09-09T13:27:46.840

来自[http://api.jquery.com/height/](http://api.jquery.com/height/)（注意：window和document对象的使用区别）

```
$(window).height();   // returns height of browser viewport
$(document).height(); // returns height of HTML document 
```

来自[http://api.jquery.com/scrollTop/](http://api.jquery.com/scrollTop/)

```
$(window).scrollTop() // return the number of pixels scrolled vertically 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-07-02T09:54:46.323

纯JS

```
window.innerHeight
window.scrollY 
```

比 jquery 快 10 倍以上（并且代码大小相似）：

[![在此处输入图像描述](https://i.stack.imgur.com/50lTC.png)](https://i.stack.imgur.com/50lTC.png)

在这里您可以在您的机器上执行测试：[https ://jsperf.com/window-height-width](https://jsperf.com/window-height-width)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-19T23:21:58.180

```
$(window).height()

$(window).width() 
```

jquery 还有一个插件来确定元素位置和偏移量

[http://plugins.jquery.com/project/dimensions](http://plugins.jquery.com/project/dimensions)

滚动偏移 = 元素的 offsetHeight 属性

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-15T09:03:55.893

如果您需要滚动到元素的某个点。您可以使用 Jquery 函数向上/向下滚动它。

```
$('html, body').animate({
                scrollTop: $("#div1").offset().top
            }, 'slow'); 
```

# php - PhpMailer 与 SwiftMailer？

> ID：303783
> 
> 赞同：63
> 
> 时间：2008-11-19T23:23:28.817
> 
> 标签：php, email, attachment, phpmailer, swiftmailer

我正在构建一个相当简单的 PHP 脚本，它需要发送一些带有附件的电子邮件。我发现这两个库可以做到这一点。

任何一个都比另一个有显着优势吗？还是我应该随机选择一个然后完成它？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-11-20T00:02:08.053

我要说 PHPMailer 不再开发，而 Swift Mailer 是。但是当我用谷歌搜索...

[https://github.com/PHPMailer/PHPMailer](https://github.com/PHPMailer/PHPMailer)

这表明它正在再次工作。

我经常使用 PHPMailer，它一直很可靠。由于上述原因，我最近开始使用 Swift Mailer，它也没有给我带来任何麻烦。

现在又开发了PHPMailer，我想我可能会尝试新版本。

所以，我的回答是两者都有能力，而且没那么重要——选择一个，学习它，使用它。两者都比 mail() 提供了巨大的优势，并抽象了电子邮件的细微差别，这样你就可以继续你真正想要开发的任何东西。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2014-06-08T20:22:28.727

无论功能是什么，它们的适用许可证都多种多样：

PHPMailer - LGPL 2.1 ( [https://github.com/PHPMailer/PHPMailer](https://github.com/PHPMailer/PHPMailer) )

SwiftMailer - MIT 许可证 ( [https://github.com/swiftmailer/swiftmailer](https://github.com/swiftmailer/swiftmailer) )

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-19T23:36:43.643

还有[Zend_Mail](http://framework.zend.com/manual/en/zend.mail.html)。如果我今天必须为一个新项目选择一个，我会认真考虑。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-01-08T12:42:18.700

看了两者之后，我认为 SwiftMailer 的界面比 PHPMailer 好得多，正如有人指出的那样，Zend_Mail 也是另一个不错的选择，尤其是在您使用其他 Zend 组件时。如果您使用同一框架中的所有内容，它会使生活变得更加轻松。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-20T00:02:16.977

我在许多项目中都使用过 PHPMailer，从来没有遇到过问题。它功能齐全，并且有很好的文档。

我从未听说过 Swiftmailer，所以我浏览了该网站。这似乎也是一个不错的解决方案。

如果您的需求如您所说的那样简单，那就随便挑一个。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-02-25T19:01:53.643

[谷歌趋势：swiftmailer 正在增长，但 phpmailer 仍然非常强大](https://trends.google.com/trends/explore?date=all&q=phpmailer,swiftmailer)。

我会选择 Swiftmailer，因为文档清晰易懂。Phpmailer 站点/文档有点乱（至少看起来是这样）。

* * *

编辑：在尝试了它们之后（并且对 SwiftMailer 没有输出任何类型提示的托管问题猛烈抨击）我完全改变了主意，**我肯定会选择 PHPMailer**至少有一个很好的理由：调试起来要容易得多如果您有任何问题。

SwiftMailer 和 PHPMailer 都提供了调试选项（SwiftMailer 带有插件，PHPMailer 通过打开`SMTPDebug = 2`），但是 SwiftMailer 由数百个小文件组成，与 PHPMailer 的 3 个文件相比，这使得 SwiftMailer 更难调试。

关于文档，[PHPmailer 文档](https://github.com/PHPMailer/PHPMailer/tree/master/docs)看起来不那么花哨，但它拥有你所需要的一切：[简单教程](https://github.com/PHPMailer/PHPMailer#a-simple-example)、[示例](https://github.com/PHPMailer/PHPMailer/tree/master/examples)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-06-15T20:47:07.070

由于 PHPMailer 和 PHP 5.3（即使是最新版本）的问题，我今天刚刚切换到 Swift，这很遗憾。Swift 有一个非常有据可查的集成，这让事情变得更容易。

# asp.net - asp.net 级联下拉菜单有区别

> ID：303795
> 
> 赞同：4
> 
> 时间：2008-11-19T23:28:17.530
> 
> 标签：asp.net, user-controls

任何人都知道可以实现此服务器或ajax 的asp.net 控件。

我有一个学校、部门和项目领域的层次结构。不幸的是，这种层次结构很复杂，以至于一个项目领域可以出现在不止一所学校中。

因为它是为了报告，所以我想在层次结构的每个下拉列表中为最终用户提供 ANY/ALL 选项。因此，如果选择了一所学校，您仍然可以选择该学校内的任何部门和 ANY/ALL 选项，然后将根据学校选择的学校和 ANY/ALL 部门过滤计划区域列表。

我希望这是有道理的，任何问题我都会进行编辑。

编辑：我解决了这个我意识到，我错过了明显的，我已经放入了我原来的解决方案，即 3 个单独的下拉单独的 sql 查询，需要在层次结构中输入上述下拉列表。我意识到如果我将 any 作为通配符 % （sqlserver 一个或多个字符）并将等于更改为我会达到预期的效果。

它确实回发了，但这并不是一个真正的问题，它是一组非常快速的 sql 查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T00:02:18.130

[ASP.NET AJAX 控件工具包](http://www.asp.net/ajax/)有一个级联下拉列表，它使用 Web 服务接口来确定哪些数据将填充下一个数据下拉列表。我可以很容易地看到您利用此控件，以便您的 Web 服务在选择特定项目时返回专门的子集，或者在选择 ANY/ALL 项目时返回完整的选项集。

这是否符合您的要求？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T23:51:47.077

下拉列表中显示的选项由支持控件的 XML 控制。如果您在“任何”选择框下包含所有可能的值，它们将显示在控件中。

真正的答案应该是有多少数据和多少可能的组合？如果数量很少并且可以预测，您应该制作该 XML 文件。

这是一个很大的数字，或者不容易预测，您真正需要的是“高级搜索”类型的功能，使用选择框控件应该很容易做到。

# objective-c - 将 NSTableView 连接到 XML-RPC 服务器

> ID：303805
> 
> 赞同：2
> 
> 时间：2008-11-19T23:31:30.160
> 
> 标签：objective-c, cocoa, xml-rpc

有多种方法可以通过绑定、委托或数据源来填充 NSTableView 的数据。

用 XML-RPC 服务器频繁更改的数据填充 tableview 的最佳方法是什么？我只针对 Mac OS X 10.5，并且有很多关于如何做到这一点的示例，但没有什么非常明确的。

有什么意见吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T23:56:45.973

如果我理解正确，这实际上是两个独立的问题。如何获取 XML-RPC 数据，以及如何填充表格视图？

我对 XML-RPC 不太熟悉，但是通过快速浏览一下，您似乎可以使用 NSXML* 类自己进行解析，或者使用几个第三方框架之一。我认为首先查看可用的框架是一个好主意，即使您最终没有使用它们，如果您走这条路，它们也应该让您很好地了解如何自己解析 XML 数据。

从 XML-RPC 请求中获得数据后，您将希望将其存储在控制器类中的某种数据结构中。您可以使用字典数组或基本字符串，或者制作一个自定义对象来表示您的数据，但这实际上取决于您正在做的事情的复杂性。控制器对象将为表格视图提供数据、处理刷新以及您可能需要执行的任何其他任务。您可以直接从控制器发出 XML-RPC 请求，或者您可能希望为此创建一个附加类来分隔代码。

无论您使用数据源方法还是绑定（以及数组控制器）都无关紧要，它们都可以正常工作并且有自己的优势。如果您刚开始使用 Cocoa，请务必使用数据源方法。绑定需要 Objective-C 和 Cocoa 的中级知识，否则很难使用和调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T04:14:32.507

我会使用数据源，因为它非常简单和灵活。向 NSTableView 提供数据的对象只需要实现 2 个功能：

1.  返回行数
2.  返回给定行/列的对象

对象如何在内部存储数据完全取决于您（灵活性），因此您可以选择最匹配您解析 xml-rpc 响应的方式。

更多关于[NSTableViewDataSource](http://www.cocoadev.com/index.pl?NSTableViewDataSource)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T00:52:49.073

我发现[这个 xmlrpc 框架](http://github.com/eczarny/xmlrpc/tree/master)更容易使用。当然，您仍然需要按照前面的说明进行包装，因为这实际上是两个不同的问题/问题。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-20T00:00:11.257

我不知道最好的方法是什么。我真的不认为有什么好方法，所以“最好的方法”真的会是“最不坏的”方法。

看看[Web 服务核心](http://developer.apple.com/documentation/Networking/Conceptual/UsingWebservices/1_intro_folder/chapter_1_section_1.html#//apple_ref/doc/uid/TP30000985-CH204-DontLinkElementID_3)。它是一个用于与 XML-RPC 和 SOAP Web 服务交互的 Carbon API。我只使用了 SOAP 功能，但 XML-RPC 也应该可以工作。这很痛苦，因为它是碳而不是可可；但是您不必编写很多网络代码，这应该是一个胜利。

之后，我会将与 WSCore 对话的所有内容打包到一个类中，并使其实现 NSTableViewDataSource 协议，并将您的表视图指向它作为表的数据源。每次来自 Web 服务的数据发生变化时，只需调用 reloadData 即可让表格视图自行刷新。

祝你好运。OS X 上的 Web 服务支持充其量是痛苦的，因此您将需要它。

# wpf - 如何在我的应用程序中放置/缩放 XAML 图形？

> ID：303809
> 
> 赞同：2
> 
> 时间：2008-11-19T23:34:45.660
> 
> 标签：wpf, xaml, vector-graphics

我正在开发一个简单的应用程序来开始学习 WPF。我在 Microsoft Expression Design 中创建了一个 400 x 400 像素的矢量图形，主要是因为我认为在更大的画布上创建它会更容易。

我已将图像作为 400 像素方形画布中的一系列对象导出到 XAML 文件。所有子对象都基于该 400 像素画布定位。

我想将图像放在我的应用程序窗口中，但按比例缩小到 100 像素乘 100 像素，但我不知道该怎么做。作为矢量图像，轻松缩放的概念似乎很简单，但我错过了一些东西。单击并拖动调整画布的大小，但不调整内部元素的大小。到目前为止，Internet 搜索的用处不大。

我只想将图像放在我的窗口中......而不是按钮或任何特殊的东西，并且可以轻松控制其大小。我是否需要将所有 XAML 复制到我的窗口的 XAML 中？我可以以某种方式引用 XAML 文件吗？如何使图像的元素与整体图像一起缩放？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T00:57:12.997

将 XAML 复制并粘贴到您的标记中

一个选项 - 将其粘贴到 Expression blend 后，右键单击 Canvas（左侧元素树）并将布局更改为网格。并给网格 100*100

第二个选项 - 单击“Group Into”选项并添加 ViewBox，并调整 ViewBox 的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-08T14:16:24.797

为了保持纵横比，用 Viewbox.Stretch="Uniform" 在你的画布/网格/任何东西周围包裹一个 Viewbox。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-21T22:58:57.853

Blend UI 可以为 WPF/Silverlight 应用程序进行这些类型的转换提供很多帮助。用户界面有点混乱。将 XAML 复制并粘贴到您的 or 中后，您可以单击屏幕左侧的该项目。您将看到以黄色突出显示的特定项目。然后，您可以在属性面板中或使用鼠标进行各种缩放、移动等，只要确保您有正确的光标即可。

这是最棘手的部分。不同的鼠标光标有不同的效果，具体取决于您将鼠标悬停在对象上的位置。旁边带有加号的小黑指针是渲染变换光标，它可以让您平移（移动 x/y）、缩放、旋转和倾斜。

如果您只是在 Visual Studio 中工作，则可以使用以下代码将 RenderTransoform 添加到您的图像中。这将为您提供各种控制。只需调整任何变换，您就可以上路了。

```
 dot = new Image();
        BitmapImage dotSource = new BitmapImage();
        dotSource.BeginInit();
        string dotImageFile = String.Format("path/to/my/{0}.png", "image");
        dotSource.UriSource = new Uri(@dotImageFile, UriKind.Relative);
        dotSource.EndInit();
        dot.Stretch = Stretch.None;
        dot.Source = dotSource;
        dot.RenderTransformOrigin = new Point(0.5, 0.5);
        dotTransformGroup = new TransformGroup();
        dotScaleTransform = new ScaleTransform(scaleX, scaleX);
        dotSkewTransform = new SkewTransform();
        dotRotateTransform = new RotateTransform();
        dotTranslateTransform = new TranslateTransform();
        dotTransformGroup.Children.Add(dotScaleTransform);
        dotTransformGroup.Children.Add(dotSkewTransform);
        dotTransformGroup.Children.Add(dotRotateTransform);
        dotTransformGroup.Children.Add(dotTranslateTransform);
        dot.RenderTransform = dotTransformGroup; 
```

# html - 使用 IE 在 HTML SELECT 中的可变（动态）选项列表

> ID：303810
> 
> 赞同：0
> 
> 时间：2008-11-19T23:35:16.483
> 
> 标签：html, internet-explorer, html-select

我正在尝试在 JavaScript 中实现动态 OPTION 列表。根据 web 表单中的其他选择，特定 SELECT 中的某些 OPTIONS 无效。我试过的在 IE 中不起作用的东西是：

*   填充所有选项，然后为那些无效的设置禁用属性
*   填充所有选项并使用选项组，然后禁用无效选项组
*   我什至尝试使用一种 text-decoration:line-through

在这一点上，我只好用有效的 OPTION 重新填充 SELECT，但似乎应该有更好的方法在 IE 中实际工作。我需要兼容 IE6 及更高版本。你是怎么处理的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T00:09:47.710

[IE 不支持 options 上的 disabled 属性](http://webbugtrack.blogspot.com/2007/11/bug-293-cant-disable-options-in-ie.html)，更糟糕的是，[IE 不支持 options 上的事件](http://webbugtrack.blogspot.com/2007/11/bug-280-lack-of-events-for-options.html)，并且 IE 中的[样式功能非常有限](http://webbugtrack.blogspot.com/2007/11/bug-291-no-styling-options-in-ie.html)。

在 IE 在基本元素和基本功能的共同支持方面加入浏览器世界的其他部分之前，您就是 SOL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T23:37:06.777

仅使用有效选项重新填充选择是否存在这样的问题？这种方法我用过很多次，没有遇到任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T00:08:36.900

不幸的是，在IE中不起作用，几周前在这个上反复拍脸；放弃了，只输入有效的选项。

确实找到了这个：[http](http://elmicoxcodes.blogspot.com/2007/05/activating-option-disabled-in-ie.html) ://elmicoxcodes.blogspot.com/2007/05/activating-option-disabled-in-ie.html ，
这个：[http ://www.danieltome.com/blog/2007/08/16 /disable-options-in-a-multiple-select-javascript-for-ie/](http://www.danieltome.com/blog/2007/08/16/disable-options-in-a-multiple-select-javascript-for-ie/)
还没有尝试过，但可能会为您完成这项工作。

不知道他们是否在 IE 8 中修复它。

在这种情况下，选择真的坏了......

# mysql - 使用 Ruby on Rails 访问 MySQL 关系

> ID：303827
> 
> 赞同：0
> 
> 时间：2008-11-19T23:43:12.180
> 
> 标签：mysql, ruby-on-rails

如何使用 RoR 访问 MySQL 关系？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T09:11:43.247

托比是对的。您需要了解使用 ActiveRecord 的表关系。

**要点**。您需要将以下代码放入模型中。这是一个例子。

在用户模型中：

```
has_many :addresses 
```

在地址模型中：

```
belongs_to :user 
```

这是一对多的关系。

本[指南](http://guides.rubyonrails.org/association_basics.html)应为您提供所需的所有帮助。

您还可以通过访问[此站点](http://www.gotapi.com/rubyrails)并在搜索框中输入“belongs_to”来参考 rails 文档。这会将您带到相关页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T02:06:05.587

你的问题真的没有意义。

Rails 与处理各种复杂数据库关系的 ActiveRecord 一起使用。查看 AR 文档以获取详细信息。

# ruby - 红宝石“大写！” 悖论

> ID：303829
> 
> 赞同：7
> 
> 时间：2008-11-19T23:44:11.130
> 
> 标签：ruby

在 Ruby 中，我们有一个 'bang' 方法，如果没有对字符串进行任何更改，`capitalize!`它会返回一个奇怪的行为。`nil`

这意味着我不能将此命令与其他命令链接，因为如果它返回，它会有效地破坏链`nil`。

我想做的是这样的：

```
fname =  fullname[0...fullname.index(' ')].capitalize! 
```

它从字符串中提取名字并且也应该将其大写。但如果它已经大写，则存储在中的字符串`fname`is `nil`。

当然，我可以添加另一个语句，但想知道是否有一种方法可以“不破坏链条”。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-19T23:51:40.727

使用[.capitalize](http://ruby-doc.org/core/classes/String.html#M000810)（没有爆炸）——除非你真的需要它来改变源。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-19T23:54:32.873

由于您的语句不会更改 fullname 的值，因此只需执行以下操作：

```
fname =  fullname[0...fullname.index(' ')].capitalize 
```

如果不进行任何更改，它不会返回 nil。

# ruby - 针对每行上的多个（15+）正则表达式解析文本正文的最佳方法是什么？

> ID：303830
> 
> 赞同：8
> 
> 时间：2008-11-19T23:44:42.237
> 
> 标签：ruby, regex, performance, parsing, peg

我有一段必须扫描的文本，每行至少包含 2 部分，有时包含 4 部分信息。问题是每行可以是 15-20 个不同动作中的 1 个。

在 ruby​​ 中，当前代码看起来有点像这样：

```
text.split("\n").each 做 |line| #大约20次..

.....................

      表达式['actions'].each 执行 |pat, reg| #大约20次

.....................

```

这显然是“问题”。我确实设法通过将所有正则表达式组合成一个来使其更快（在 C++ 中提高 50%），但这仍然不是我需要的速度——我需要快速解析数千个这些文件！

现在我将它们与正则表达式相匹配——但这太慢了。我从 ruby​​ 开始，然后跳到 C++，希望能提高速度，但它并没有发生。

我随便阅读了有关 PEG 和基于语法的解析，但它看起来有点难以实现。这是我应该去的方向还是有不同的路线？

基本上我正在解析扑克手牌历史，手牌历史的每一行通常包含我需要收集的 2-3 位信息：玩家是谁，多少钱或行动需要什么牌......等等。

需要解析的示例文本：

```
掩埋帖子 $5
按钮在座位 #4
*** 洞牌 ***
处理混乱 31337 [8s 广告]
宣威7折
OneMiKee 折叠
syhg99 通话 $5
掩埋场加注到 10 美元

```

在我收集了这些信息之后，每个动作都会变成一个 xml 节点。

现在我的 ruby​​ 实现比我的 C++ 快得多，但这很可能。只是因为我已经 4 到 5 年没有用 c 代码编写了

**更新：** 我不想在这里发布所有代码，但到目前为止，我的手/秒如下所示：

```
588 手/秒——c++ 中的 boost::spirit
60 手/秒——1 个非常长且复杂的 C++ 正则表达式（所有正则表达式放在一起）
33 手/秒——ruby 中的正常正则表达式样式

```

我目前正在测试 antlr，看看我们是否可以走得更远，但到目前为止，我对 Spirit 的结果非常满意。

相关问题：[针对多个正则表达式有效地查询一个字符串。](https://stackoverflow.com/questions/192957/efficiently-querying-one-string-against-multiple-regexes)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T00:04:48.047

我会建议

*   [提升精神](http://spirit.sourceforge.net/)或
*   [Antlr](http://www.antlr.org/)如果语法很复杂；
*   [Xpressive](http://www.boost.org/doc/libs/1_37_0/doc/html/xpressive.html)如果它更简单一点，
*   [标记器](http://www.boost.org/doc/libs/1_37_0/libs/tokenizer/index.html)和手工代码，如果它是微不足道的。

祝你好运

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-20T00:05:44.350

[Boost.Spirit](http://spirit.sourceforge.net/)是一个很棒的库，它允许您进行详细的解析器分析，并且由于解析器是直接生成并编译到您的代码中的，因此应该比动态计算的解决方案快得多。语法主要使用表达式模板（许多重载运算符的花哨术语）完成，这意味着您实际上将它们直接写入代码中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T20:11:40.357

如果您使用 Perl，这是一种方法。
*复制自[`perldoc perlfaq6`](http://perldoc.perl.org/perlfaq6.html#What-good-is-%27%5CG%27-in-a-regular-expression%3F)*

```
while (<>) {
    chomp;
    PARSER: {
        m/ \G( \d+\b    )/gcx   && do { print "number: $1\n";  redo; };
        m/ \G( \w+      )/gcx   && do { print "word:   $1\n";  redo; };
        m/ \G( \s+      )/gcx   && do { print "space:  $1\n";  redo; };
        m/ \G( [^\w\d]+ )/gcx   && do { print "other:  $1\n";  redo; };
    }
} 
```

对于每一行，`PARSER`循环首先尝试匹配一系列数字，然后是单词边界。此匹配必须从最后一个匹配的位置开始（或第一个匹配的字符串开头）。由于`m/ \G( \d+\b )/gcx`使用了`c`标志，如果字符串不匹配那个正则表达式，perl 不会重置`pos()`并且下一个匹配从相同的位置开始尝试不同的模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T00:12:11.153

请参阅[正则表达式匹配可以简单快速（但在 Java、Perl、PHP、Python、Ruby 中很慢...）](http://swtch.com/~rsc/regexp/regexp1.html)。根据数据量和正则表达式的复杂程度，编写自己的解析逻辑可能会更快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-30T09:50:50.487

> 我随便阅读了有关 PEG 和基于语法的解析，但它看起来有点难以实现。这是我应该去的方向还是有不同的路线？

就我个人而言，我已经成长为喜欢 PEG。可能需要一点时间才能适应它们，但我认为它们更易于维护，这是一个明显的胜利。当您在输入中发现新的边缘情况时，我发现解析代码是许多意外错误的根源。与循环和条件繁重的正则表达式代码相比，带有非终结符的声明性语法在发生这种情况时更容易更新。命名是强大的。

在 Ruby 中有[Treetop](http://treetop.rubyforge.org/)，它是一个使用 PEG 的解析器生成器。我最近发现用简短的语法替换正则表达式繁重的手写解析器非常愉快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T07:12:29.883

正则表达式匹配是否有重叠？也就是说，当两个或多个正则表达式匹配同一行时，它们是否总是匹配该行的不同部分（不重叠）？

如果匹配项从不重叠，请使用一个结合了您现在拥有的 15 个正则表达式的正则表达式运行您的搜索：

```
regex1|regex2|regex3|...|regex15 
```

如果您需要能够确定 15 个正则表达式中的哪一个匹配，请使用捕获组。

为长正则表达式搜索一次数据将比搜索 15 次更快。快多少取决于您使用的正则表达式引擎和正则表达式的复杂性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-21T23:19:40.883

在 Perl 中尝试一个简单的测试。阅读“学习”功能。我可能会尝试的是：

*   如果这些文件非常大，则将整个文件或大量行读取为单个字符串
*   在每行的开头添加一个行号。
*   “研究”字符串。这会按字符构建查找表，可以很大。
*   在字符串上运行正则表达式匹配，以换行符为界（使用 m 和 s 正则表达式修饰符）。该表达式应提取行号以及数据。
*   将按行号索引的数组项设置为在该行上找到的数据，或者做一些更聪明的事情。
*   最后，您可以处理存储在数组中的数据。

我没有尝试过，但它可能很有趣。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-21T23:28:01.367

如果你有一个漂亮的四核或八核服务器用于此，另一个想法。

建立一个划分工作的处理管道。第一阶段可以将文件切割成一个游戏或每个手，然后将每个文件写入第二阶段的八个管道中的一个，这些管道读取数据、处理数据并以某种方式产生输出，可能会写入另一台机器上的数据库。

根据我的经验，这些基于管道的多进程设计几乎与多线程设计一样快且更容易调试。使用网络套接字而不是管道来设置机器集群也很容易。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-22T00:34:48.690

好的，这让事情变得更清楚（扑克手牌历史）。我猜你正在制作一个统计工具（侵略因素，摊牌，自愿将$投入底池等）。我不知道你为什么需要过快的速度；即使您使用 16 张牌桌进行多桌游戏，手牌也只能以适中的速度进行。

我不了解 Ruby，但在 Perl 中，我会做一个小 switch 语句，同时将重要部分放入 $1、$2 等。根据我的经验，这并不比进行字符串比较然后拆分慢线用其他方式。

```
HAND_LINE: for ($Line)
    { /^\*\*\* ([A-Z ]+)/ and do 
        { # parse the string that is captured in $1
          last HAND_LINE; };
      /^Dealt to (.+) \[(.. ..)\]$/ and do
        { # $1 contains the name, $2 contains the cards as string
          last HAND_LINE; };
      /(.+) folds$/ and do
        { # you get the drift
          last HAND_LINE; }; }; 
```

我不认为你真的可以让它更快。将检查在第一个位置出现最多的行（可能是折叠语句）和最后只出现稀疏的行（开始新手，`"*** NEXT PHASE ***"`）。

如果您发现实际文件读取是一个瓶颈，您也许可以看看您可以使用哪些模块来处理大文件；对于 Perl，`Tie::File`我想到了。

确保您只阅读每手牌一次。不要在每手牌之后再次读取所有数据，而是保留例如已经解析的手牌 ID 的哈希表。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-30T10:15:34.960

对于这样的问题，我只是闭上眼睛并使用 Lexer+Parser 生成器。您可能可以通过手动优化来击败它，但使用生成器要容易得多。此外，当输入突然改变时，它会更加灵活。

# exception - 方法应该忽略非法输入还是引发异常？

> ID：303832
> 
> 赞同：3
> 
> 时间：2008-11-19T23:44:54.717
> 
> 标签：exception, illegal-input

如果一个方法检查它的输入并检测到非法输入，它应该怎么做：引发异常（或使用另一个错误机制）或什么都不做/忽略错误的输入？

在 Java 中，如果给定空引用作为参数，HashTable 类将抛出 NullPointerException。这有时很烦人，但我认为它可能有优势，因为错误会被及早发现。其他一些方法忽略非法输入，什么也不做。这不那么烦人，通常不会发生任何不好的事情，但可能会有一些情况，然后这种行为会导致头痛 - 或者不会？

我不确定，哪种方式更好。所以我问你：你对这个问题怎么看？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-19T23:46:42.563

肯定抛出异常。例外是故意令人讨厌的，以迫使您对*它们做点什么*。

这样想，如果你的程序对错误的输入什么都不做，你应该如何让用户知道什么都没发生，为什么？另外，调试一个在错误条件下不执行任何操作的程序需要多长时间？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-20T00:55:03.220

我认为这**取决于**您正在处理的上下文或抽象层。最重要的是要保持一致。如果您在该级别抛出异常，请继续抛出您的异常。如果没有，请检查图层的行为并执行相同的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T00:00:45.030

这在很大程度上取决于您正在开发的应用程序。

尽管输入非法，但仍然坚持下去可能意味着程序的输出不正确，这对于计算药物剂量的应用程序来说是一件非常糟糕的事情。另一方面，如果不会导致任何灾难性的后果，那么什么都不做可能是可以的。

另一种选择是将非法输入更改为最接近的合法值（例如，如果整数的范围是 0 - 100，并且您收到 -10，则可以将其设置为 0 并继续处理）。

您应该尝试考虑如何处理您正在编写的特定方法中的错误以及您的错误处理将如何影响整个应用程序的可能后果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-20T00:07:28.433

假设这是一个公共方法，那么该方法与调用该方法的人之间的约定是什么？

如果你正在编写这个方法，那么契约就是设计的一部分。你可以选择

*   以某种方式标记错误（自定义异常是一种选择，但不是唯一的选择）
*   在某些情况下更正错误并继续
*   丢掉错误的输入，像什么都没发生一样继续。

最后，这实际上取决于该方法在做什么以及您对该方法有什么期望。

您可以用 Class 代替方法并具有相同的选项。

在某些情况下，您可能无法引发异常 - 即固件嵌入式微控制器。在这些情况下，您必须有一个专门用于处理错误输入并继续处理有效输入的流程。

干杯，

-R

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T06:44:02.267

**快速失败**：永远不要忽略错误的输入。您可能会隐藏问题并使它们很难找到。

[有些人通过合同设计](http://en.wikipedia.org/wiki/Design_by_contract)(DBC)将这一点推得很远。

遵循已在您的项目或公司中使用的实践 - 或立即定义它们。

# .net - 在 .NET 中使用 NHibernate 时如何处理授权

> ID：303835
> 
> 赞同：2
> 
> 时间：2008-11-19T23:45:46.980
> 
> 标签：.net, nhibernate, authorization

我正在使用存储库模式使用 NHibernate 查询我们的数据库。它使执行以下操作变得非常容易：

公共 T GetById(int id) {...}

但是当有人开始使用查询字符串来查看他们不允许看到的东西时，这并没有多大帮助。

为了复合它，一些对象是应该对其执行授权的父对象的深层嵌套子对象。

例如博客 --> 作者 --> 帖子 --> 评论。在这个人为的示例中，我们希望作者能够编辑他们自己的帖子和对这些帖子的评论，但不能查看或编辑其他作者的帖子。检查帖子属于作者很容易，确定评论属于作者就有点困难了。我们有一些更深入的例子。

那么......我们如何进行授权（在模型或存储库中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T14:37:08.833

您可以实现装饰器模式 - 我假设您正在使用 DP/IoC 容器来注入您的 IRepositories？

您将创建一个 ISecureRepository 来检查所进行的调用对于特定用户/请求类型是否有效，然后将调用传递回 IRepository。这也使您能够调用该方法，然后检查返回类型...

然后，您将设置您的 IoC 以使用包裹在 IRepository 周围的 ISecureRepository ...

听起来很简单...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T02:04:26.167

这可能是满足您需求的一个很好的实现：http: [//www.codeproject.com/KB/web-security/objectlevelsecurity.aspx](http://www.codeproject.com/KB/web-security/objectlevelsecurity.aspx)，它是一个基于 ACL 的模型。

# windows - 从另一个 cmd.exe 提示符中创建一个新的 cmd.exe 窗口

> ID：303838
> 
> 赞同：118
> 
> 时间：2008-11-19T23:47:40.033
> 
> 标签：windows, command-line, cmd

我正在设置 CruiseControl.NET。我遇到的问题是我将 CC 作为控制台应用程序运行，当我的构建成功完成并执行（使用 exec）时，它会在 CruiseControl DOS 提示符下启动它。我只是使用简单的批处理文件来启动我的应用程序，但让它在与 CC 相同的提示符下运行导致 CC 认为只要我的应用程序运行，构建就会继续。

是否有命令行参数`cmd.exe`会产生另一个单独的提示窗口？

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2008-11-19T23:48:53.103

我认为这有效：

```
start cmd.exe 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2013-11-04T17:13:09.500

这是您需要的代码：

```
start cmd.exe @cmd /k "Command" 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2015-07-06T09:00:24.227

只需`start`在命令提示符下键入：

```
start 
```

这将打开新的`cmd`窗口。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-11-19T23:56:41.810

```
start cmd.exe 
```

打开一个单独的窗口

```
start file.cmd 
```

打开批处理文件并在另一个命令提示符下执行它

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-08T20:50:16.920

```
START "notepad.exe"
echo Will launch the notepad.exe application
PAUSE 
```

要制作任何 cmd 文件类型，您只需将内容保存为 .bat，即

```
@echo
TITLE example.bat
PAUSE
taskkill/IM cmd.exe 
```

把它变成一个“example.bat”文件，保存它，然后打开它并运行。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-10-25T07:29:02.720

您可以从命令提示符处键入以下 3 个命令：

1.  `start`

2.  `start cmd`

3.  `start cmd.exe`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-11-14T09:56:52.190

简单的写入你的bat文件

```
@cmd 
```

或者

```
@cmd /k "command1&command2" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-05-19T06:18:20.007

如果我们简单地使用`start`命令或者`start cmd.exe`它打开 cmd。

如果要打开相同的命令提示符窗口；

```
start "Command Prompt" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-04T03:34:23.423

我还尝试在 CCNET 任务结束时执行运行守护进程/服务器的批处理文件；使 CruiseControl 生成一个独立的异步进程而不等待进程结束的唯一方法是：

1.  创建一个批处理文件来运行守护进程（服务器应用程序）
2.  使用任务调度程序将批处理文件作为 CCNET 任务运行（使用 schtasks.exe）

    ```
    schtasks.exe /create /F /SC once /ST 08:50 /TN TaskName /TR "c:/path/to/batchFileName.bat" 
    ```

    *   08:50 是 HH:MM 时间格式

您可能需要在 ccnet 开始时终止该进程

PS：使用“start cmd.exe”选择的答案不起作用；确实生成了一个新的命令提示符，但 CCNET 将等待生成的 cmd 完成。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-03-01T07:55:26.850

launch_stack.bat 将打开 2 个窗口来运行您的 alices.bat 和 bobs.bat

```
start alices.bat
start bobs.bat 
```

# perl - 为什么我的脚本在 eval“字符串”中报告“未初始化的值”？

> ID：303841
> 
> 赞同：2
> 
> 时间：2008-11-19T23:48:13.463
> 
> 标签：perl, warnings, eval

我收到此警告：

```
Use of uninitialized value in eval \"string\" at myscript.pl line 57. 
```

当我运行此代码时：

```
eval;
{
        `$client -f $confFile -i $inputFile -o $outputFile`;
};

if( $@ )
{
        # error handling here ...
} 
```

是什么导致了错误？

我该如何解决根本原因？（或者以其他方式抑制警告？）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-20T00:37:20.230

无论如何，这里的 eval 绝对不会做任何事情。反引号从不抛出错误。这不是`$@`你`$?`想要检查的。

此外，如果您要丢弃结果，使用[system](http://perldoc.perl.org/functions/system.html)可能是一个更清洁的想法。例如

```
system($client, '-f', $confFile, '-i', $inputFile, '-o', $outputFile) and do {
    #error handling here...
}; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-19T23:53:11.847

后面有一个分号`eval`。

# windows-xp - 网页中的 ActiveX 控件以创建用户帐户

> ID：303842
> 
> 赞同：0
> 
> 时间：2008-11-19T23:48:35.523
> 
> 标签：windows-xp, activex, wmi, administration

我想知道是否有任何方法可以在 Windows XP 机器上创建用户帐户，这可以通过网页上的 ActiveX 控件的脚本来完成。具体来说，我想知道是否有任何方法可以使用计算机（我预先配置和交付）部署 ActiveX 控件，这将允许使用我的网页从该计算机检测 ActiveX 控件是否存在，并允许自动创建计算机上的本地 (Windows XP) 用户帐户。从本质上讲，这是一个预先安装 ActiveX 控件（如果需要）并在桌面上提供链接的问题；用户收到机器并登录（具有管理员权限）并访问一个网站，我的服务器在那里确定适当的用户帐户，将它们作为 HTML 发送回来，ActiveX 控件创建我指定的用户帐户。

这种事情看起来应该是可能的，但同时也存在明显的潜在安全漏洞。对这些机器的访问将非常有限，因此安全问题不再是一个问题。

有谁知道这是否可能？是否有任何内置的 WMI 组件做这样的事情？XP的安全模型甚至允许这样做吗？或者这只是打开了一个应该完全避免的巨大安全漏洞？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-30T16:01:26.337

我认为您永远无法获得 Windows 的安全模型（尤其是在 IE 中）来允许这样做。您可以使用 WMI 中的 Win32_UserAccount 通过 WMI 执行此操作，因此更好的方法可能是编写一个 PowerShell 或 VBScript 脚本来查询网页以查看需要创建哪些帐户，然后创建它们。用户需要是本地管理员。这在 PowerShell 中更容易；如果您从 www.sapienpress.com/powershell.asp（页面底部，免费）获取示例脚本，您将看到如何向 URL 提交查询并将结果以文本形式返回的示例。然后，您可以解析文本并相应地创建帐户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-30T17:07:13.833

您必须使用 url 证据或强名称证据将 caspol 安全设置设置为完全信任（或自定义集）。

在确保您的控件始终获得完全信任设置之后，您可以使用控件执行的操作没有任何限制，您可以通过嵌入式控件执行任何可以使用普通应用程序完成的操作。当然 Vista UAC 和 IE 保护模式将是您必须关注的问题。例如，可以通过将您的站点添加到受信任的站点区域来解决保护模式。

编辑：忽略 Vista 细节。

# c - 如何使用 libxml2 修改现有的 xml 文件？

> ID：303845
> 
> 赞同：10
> 
> 时间：2008-11-19T23:49:22.820
> 
> 标签：c, xml, linux, libxml2

我需要获取一个现有的 xml 文件，只修改几个属性并将文件写回。

我正在考虑使用 libxml2 来完成这项工作。应用程序是在 Linux 上运行的 C/C++。

问题是，libxml2 似乎包括厨房水槽的几种变体，以及便携式洗手间、淋浴间和通过相同管道连接的各种其他东西。有不同的解析器可用，以及不同的做事方式。对于以前没有使用过 libxml2 的人来说，这有点吓人。

我应该看什么示例，以便最后我的输出 .xml 与原始输入文件相同，加上我所做的更改？到目前为止，我一直在使用 libxml2 的 tree1.c、tree2.c 和 reader1.c 示例，但仅使用这些示例，输出 xml 将不会几乎相同。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-19T23:58:21.680

```
#include <libxml/xmlmemory.h>
#include <libxml/parser.h>
#include <libxml/xpath.h>

//Load in the xml file from disk
xmlDocPtr pDoc = xmlParseFile("file.xml");
//Or from a string xmlDocPtr pDoc = xmlNewDoc("<root><element/></root>");

//Do something with the document
//....

//Save the document back out to disk.
xmlSaveFileEnc("file.xml", pDoc, "UTF-8"); 
```

您想要的主要内容可能是这些功能：

```
xmlNodePtr pNode = xmlNewNode(0, (xmlChar*)"newNodeName");
xmlNodeSetContent(pNode, (xmlChar*)"content");
xmlAddChild(pParentNode, pNode);
xmlDocSetRootElement(pDoc, pParentNode); 
```

这是一个使用 xpath 选择事物的快速示例：

```
//Select all the user nodes
xmlChar *pExpression((xmlChar*)_T("/users/user"));
xmlXPathObjectPtr pResultingXPathObject(getnodeset(pDoc, pExpression));
if (pResultingXPathObject)
{
    xmlNodeSetPtr pNodeSet(pResultingXPathObject->nodesetval);
    for(int i = 0; i < pNodeSet->nodeNr; ++i) 
    {
        xmlNodePtr pUserNode(pNodeSet->nodeTab[i]);
                   //do something with the node
    }
}
xmlXPathFreeObject(pResultingXPathObject); 
```

# architecture - Active Record / 三层架构

> ID：303849
> 
> 赞同：0
> 
> 时间：2008-11-19T23:50:59.557
> 
> 标签：architecture, castle-activerecord

我想将我的应用程序分成三层以使用服务层。我还想在 UI 层和业务层使用相同的域模型，因为我控制两端。

这是有道理的，但我也想将 Castles Active Record 用于数据访问层。因此，我不能再在我的 UI 中引用我的域模型，因为 myActive Record 对象（例如“客户和订单”）现在包含直接与数据库通信而不是通过服务层进行通信的逻辑。

解决这个问题的最佳方法是什么？是否有任何简单的方法可以将活动记录类分离为存储库类和哑数据传输对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T00:00:03.300

你应该使用`ActiveRecordMediator<T>`而不是`ActiveRecordBase<T>`

[http://castleproject.org/activerecord/documentation/trunk/advanced/mediator.html](http://castleproject.org/activerecord/documentation/trunk/advanced/mediator.html)

# java - 您对 Maven 的印象是什么？

> ID：303853
> 
> 赞同：20
> 
> 时间：2008-11-19T23:52:00.103
> 
> 标签：java, open-source, maven-2

我正在考虑将 Maven 用于我管理的 Java 开源项目。

然而，在过去，Maven 并不总是享有最好的声誉。此时，您对 Maven 的印象如何？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-20T01:56:56.947

对于一个开源项目，Maven 有一些优势，尤其是对于您的贡献者（例如 mvn eclipse:eclipse）。

如果您确实使用 Maven，那么您必须严格遵守的一条规则是：不要与工具抗争。完全按照 Maven 的建议布局您的项目，遵循它的所有约定和最佳实践。您与 Maven 的每一次小争执都是您不会花费在为您的项目编写代码的一天。

还要预先考虑要在哪里部署工件（您要托管自己的存储库吗？）。

并且不要害怕使用 Maven 以外的东西（例如 Ant）。您项目的成功将取决于项目本身，而不是其构建工具（只要您选择了同类最佳的构建工具，Ant 和 Maven 都是）。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-20T12:59:24.880

就个人而言，我不是粉丝。我同意查尔斯米勒[所说的大部分关于它被设计破坏的说法](http://fishbowl.pastiche.org/2007/12/20/maven_broken_by_design/)。它确实解决了一些问题，但也[引入了其他](http://tapestryjava.blogspot.com/2007/11/maven-wont-get-fooled-again.html)问题。

[Ant](http://ant.apache.org)远非完美，但它更健壮，文档也更好。[不过，以模块化方式使用](http://blog.uncommons.org/2007/10/25/15-tips-for-better-ant-builds/)它确实需要一些纪律（这是 Maven 试图解决的问题之一）。我认为发明比 Ant 和 Maven 更好的东西不会那么困难，但是那个工具似乎还不存在。

如果你喜欢 Maven 的依赖管理但不喜欢 Maven，你可以在 Ant 中使用[Ivy](http://ant.apache.org/ivy/)获得类似的东西。我对这种依赖管理风格的问题是，由于您无法控制的因素，它很[脆弱。](http://blog.uncommons.org/2008/02/03/maven-revisited-fallacies-and-usefulness/)它确实有意义的一个用例是，如果您的组织内部有很多相互依赖的项目。在这种情况下，一切都在您的控制之下，并且可能运行良好。

**编辑**：我忘了补充一点，即使你不喜欢 Maven，你也不能忽略它。如果您编写其他人使用的开源库，他们会期望它们在 Maven 存储库中可用，以便他们可以从他们的 Maven 构建中轻松使用它们。

**EDIT2**：由于您已经澄清您的主要兴趣是向其他 Maven 用户提供开源库，因此值得注意的是，您不一定必须使用 Maven 来实现这一点。有[一组 Ant 任务用于发布到 Maven 存储库](http://maven.apache.org/ant-tasks/index.html)。因此，如果您想继续使用 Ant 来构建您的项目，您可以这样做，但仍然可以满足使用 Maven 的用户。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-20T10:59:20.193

如果您的项目“简单”，那么 maven 可以让您快速启动并运行。简单来说，我的意思是你有一堆代码、一些资源、一些测试类，所有这些都与一些 3rd 方 jar 一起制作一个应用程序。

当您想要做一些不寻常的事情时，您将最终花费所有时间试图让 maven 做您想做的事情，而没有时间处理您的代码。这对我来说违背了使用聪明的构建系统的目的。

Maven 在不工作时帮助您诊断问题也很糟糕。并且构建脚本是不直观和不自然的 xml 的难以阅读的长篇大论，这当然可能是您喜欢和正在寻找的（如果您有 ant-vision）。

我爱行家。Maven 充满了善良和承诺。我也讨厌maven。

**编辑：**

哦，Eclipse 的 Maven 插件非常棒。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-20T10:26:41.647

当 Maven 从 1.x 过渡到 2.x 时，我不幸使用了它。它几乎消耗了我们一位资深团队成员 100% 的时间。我们最终取消了它。

但是，最近我有机会重新访问 maven，我会说它已经改进了。我的主要问题之一是缺乏良好的文档，但在阅读[“Maven：权威指南”](https://rads.stackoverflow.com/amzn/click/com/0596517335)之后，我会说它更容易理解。

与用于 eclipse 的[m2eclipse](http://m2eclipse.codehaus.org/)插件一起，管理依赖项变得轻而易举——它具有出色的依赖项可视化工具。

总的来说，我会说 Maven 是一个很好的工具，开始于一个项目，但一旦你的构建开始变得复杂，它可能会开始迷失方向。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-20T00:54:43.657

maven 有一些非常好的地方：

*   原型：很多人制作的一种启动（基础）项目（非常有用）。在您倾向于一遍又一遍地重新创建相同类型的东西的企业中，它非常实用。
*   依赖管理：你真的必须尝试它才能爱上它。Ivy 也是一个很好的**兼容**工具。
*   生命周期管理：如果没有完整的 IDE，您可以使用 maven 从命令行执行所有操作，我的意思是：编译、打包、测试、部署等。并且可以使某些步骤依赖于其他步骤。虽然我认为默认值不是最好的，但这部分是可定制的。

此外，maven 还可以做一些蚂蚁的事情。

对我来说，缺点是很难将项目移植到它上面。最好从头开始。此外，maven 广泛使用插件来完成其工作，但在这方面并非一切都是完美的，而且还没有适合所有东西的插件。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-20T09:24:05.173

使用任何构建工具的主要原因之一是获得可重现的构建。也就是说，您今天所做的构建可以在几年内完全复制。以我的经验，Maven 在创建可重现构建的测试中非常失败。

问题源于具有许多活动部件的大型复杂野兽。每个部分都有自己的发布周期，并且版本经常相互冲突并破坏您的构建。尝试调试这样的事情非常复杂。

我将 Maven 用于开源工作，因为它相对较快地生成了一个合理的网站。非开源开发人员很少对此感兴趣。即使完成了这项任务，我也经常花费很长时间试图找出为什么事情没有按预期工作。对于开源工作，我通常使用 ant 来实际生成构建（jar），因为它是可靠的。

最后一点。如果您正在编写一个开源项目，您可能*必须*以某种方式使用 Maven。如果您的项目很受欢迎，那么您需要在中央 Maven 存储库中获取它，如果您不使用 Maven，这将更加棘手。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-26T05:04:49.610

我个人非常喜欢 Maven，还有很多其他人也喜欢。Maven2 的声誉比 Maven1 好得多，而且 OSS 社区似乎有一种趋势。对于拥有许多不同项目的商店，它确实有助于创建一致性，并且您不会觉得在每个项目上都使用 Ant 脚本重新发明轮子。

为了解决您的问题，最好至少将您的 jar 提交到中央存储库。您不必用 maven 替换现有的构建过程，但您至少必须维护一个包含项目依赖项的 POM。

[http://maven.apache.org/guides/mini/guide-central-repository-upload.html](http://maven.apache.org/guides/mini/guide-central-repository-upload.html)

这将使用户（使用 Maven 或 Ivy）更容易下载和安装您的 jar，从而使您的项目受益。

如果您决定使用 maven 进行构建，它可能会增加您对项目的参与度，因为它会在一定程度上降低进入门槛。使用 maven 构建项目后，想要从源代码构建的人所需要的只是运行“mvn install”。（FWIW，在某种程度上可以使用 Ant/Ivy 来完成）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-20T00:07:06.653

JavaPosse 在[最近的播客 #217](http://javaposse.com/index.php?post_id=403465)中讨论了很多 Maven 。共识是，它在允许您构建项目的方式上非常严格，但它的使用正在增长，并且它可能为表示项目提供跨 IDE 标准。

* * *

*更新*——Javaposse 还在去年春天的 Java 综述 09 上举办了一次信息丰富的会议，题为[“Maven with Pain？”](http://www.javaposse.com/index.php?post_id=503964) 我笑了（带着惊恐的同情），在录音快结束时，一位参与者谈到了插件更新如何破坏了他们的构建——在产品发布前两天。

* * *

老实说，我已经避开了它，很大程度上是因为我觉得这个名字很烦人。但是，管理第三方库依赖项的能力很有吸引力。

* * *

*更新*——对于那些对我的非理性观点有非理性蔑视的人，让我向你展示一下我脑海中的“maven”：

[![埃德娜模式](https://i.stack.imgur.com/kTYrx.jpg)](http://en.wikipedia.org/wiki/Edna_Mode)

是的，在我看来，Edna Mode 是“maven”*的*缩影。而且我不想让她出现在我的身材里——太专横了！

什么是更好的名字？发明词最适合其精确的谷歌搜索结果。为了给人留下好印象，请将它们扎根于具有积极含义的真实文字中。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-07T21:01:24.410

我们有一个开源开发人员社区，他们独立地从事自己的项目。其中一些项目使用来自其他项目的库。如果没有依赖管理，我们会在 jar 中遇到循环依赖。ant 对这些问题没有帮助（这是在 Ivy 之前，我没有使用过）。通过使用 maven 和部署 jar，我们正在设法减少依赖关系并减少问题。所以我们从依赖管理工具中受益匪浅，我个人发现使用 maven 的努力是非常值得的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-07-29T11:13:52.797

使用 Maven 的一个主要好处是它**外部化了“项目对象模型”**（因此`pom.xml`）。这种独立项目结构的优势在于它可以跨工具和 IDE 进行移植。

所有主要的 IDE 都在 Maven 支持上投入了大量资金。***当您在您选择的 IDE 中***打开项目时，它将采用 Maven 结构，您就可以开始了：

*   在[Eclipse](http://www.sonatype.com/books/m2eclipse-book/reference/creating-sect-importing-projects.html#creating-sect-importing-a-maven-project)中：导入... Maven 项目...
*   在[IntelliJ](http://blogs.jetbrains.com/idea/2008/03/opening-maven-projects-is-easy-as-pie/)中：打开项目...浏览到 pom.xml
*   在[Netbeans](http://wiki.netbeans.org/MavenBestPractices)中：全部透明

*您通常将所有**IDE 元数据**（.iml、.project、.classpath 等）放在**VCS 忽略列表中**。*

显然，持续集成引擎以类似的方式受益于基于 POM 的方法。

有一个学习曲线，也有限制，但你会得到很多回报。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-20T00:44:14.897

Maven 可用于管理项目的整个生命周期，从开始到部署。如果这些是您所需要的，那么 Maven 就是正确的工具。如果你只是在寻找一个依赖管理的工具，你可能也想看看[Ant 的 Ivy](http://ant.apache.org/ivy/)。

它已在我从事的大多数项目中使用过，并且.. 虽然有时很烦人（配置和文档），但它为我节省了很多时间。大多数 Apache 的基于 Java 的项目都使用 Maven。

Maven 是否有效，实际上取决于您希望它为您做什么。

yc

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-20T09:50:09.207

我们将 maven 用于一个非常大的项目（超过 15 个模块），我们努力不与该工具抗争，但

1) maven 解决了 90% 的常见问题，但如果你还在为另外 10% 的问题苦苦挣扎，那总是一团糟

2) 生命周期管理一团糟。即使你为你的事情选择了一个正确的阶段，有时它也不起作用。你不知道为什么

3）我们努力奋斗，但最终我们放弃了：我们使用来自 maven 的 ant。有时我们甚至用 ant 来调用 maven。现在甚至不要试图认为我们很糟糕：如果你能看到我们构建过程中某些步骤的复杂性……只是 maven 经常妨碍你构建复杂的项目。

4）本地存储库管理是一种负担。手艺不好。等同类产品。

总而言之：我建议使用 Ant（如果你想要依赖管理，可能会使用 Ivy，但我从未尝试过）

再见斯特凡诺

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-20T12:08:08.227

matt raible 有一个博客条目[http://raibledesigns.com/rd/entry/comprehensive_project_intelligence_with_jason](http://raibledesigns.com/rd/entry/comprehensive_project_intelligence_with_jason)。

我听说大多数使用 maven 的人都不喜欢它。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-26T05:20:19.313

一些朋友告诉我，Maven 有点像 NetBeans：两者都受到某种耻辱，这种耻辱曾经是应得的，但不再完全有效。由于缺乏文档和 XML/Jelly，我讨厌 Maven 1.x。

后一个问题可能会得到解决，因为 Maven 2 更加面向 Java。糟糕文档的耻辱仍然存在，但我不知道这是否公平。（*如果*它仍然公平，那么 Maven 团队真的丢球了。）

POM 和依赖管理都是很酷的想法，但人们想知道它们是否会被更新的工具吸收，就像 C++ 引领更新语言一样。

最后一点：Ant 和 Maven 之间的二分法有些错误。Gradle 和 Gant 是 Groovy 空间中的构建工具，可以提供很多功能，即使对于直接的 Java 项目也是如此。因为他们使用 Groovy，所以简单的任务真的很简单（与 Ant 中痛苦的 XML 构造相反）；但是它们与 Ant 的集成度很高，因此有一组丰富的“硬”任务。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-07-02T04:36:28.310

在我们公司，我们已经慢慢开始转向 Maven，以尝试在不同的组件构建之间强制执行统一性。现在，它是一个巨大的 ant 脚本混搭，试图做同样的事情。它工作得很好，与我们的构建服务器（Hudson）很好地集成，我们需要做的一些事情 Maven 不支持（或完全支持），我们基本上已经加入了一个简化的 ant build xml，我们附加到构建过程。它很好地填补了任何功能漏洞，并使转换变得简单——你所要做的就是基本的编译/打包过程，然后你可以在有时间的时候慢慢地从 ant 中转移构建的任何其他副作用。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-07-27T20:56:18.487

文档越来越好，m2eclipse 简直太棒了。但是上面有人指出了“被设计破坏”的文章。他提出了一些好的观点。虽然我个人认为 maven 是比 ant 更好的工具，但从长远来看，我们的经验会让 maven3 成为比 maven2 更好的工具。

没有它我活不下去。我可以通过互联网连接、JDK 和 Maven 2 访问世界上任何一台机器，查看我的 git 存储库，然后运行“mvn test”，它就会构建。我敢说任何其他构建工具。:-)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-20T01:26:39.553

我喜欢 Maven，我一直都在使用它。部分原因是通过 Eclipse 的 XML 插件进行设置非常简单（它有一个非常具有描述性的 XSD）。Maven 也非常适合依赖管理，因为它允许您从存储库下载 jar 并在适用的情况下排除传递依赖。它还有一个内置的 site:site 目标，非常适合生成带有适用报告的项目网站。

Maven 非常适合刚刚开始的项目，但它确实具有您预期的源代码格式。如果您使用 Maven 开始您的项目，并且知道它可以立即做什么，它将对您有很大帮助。但是你应该明确地研究它。“开箱即用”，maven 可以做很多伟大的事情，并且它的插件比比皆是。但是，有些东西 ANT 比 Maven 处理得更好，如果没有 Maven 插件，它可能很难在 Maven 中处理。但是，您也可以随时学习创建自己的 Maven 插件。

有关 Maven 的良好指南，请参阅[Better Builds With Maven](http://www.topazproject.org/trac/attachment/wiki/MavenInfo/BetterBuildsWithMaven.pdf?format=raw)。

哦，这些评论适用于 Maven 2，我从未使用过 Maven 1。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2008-11-20T01:33:57.523

@MetroidFan2002：Maven 1 已被弃用，它可以说比 Maven 2 更稳定（尽管功能更少）。写果冻脚本绝对是个坏主意。

yc

# asp.net - ASP.NET 和会话 - 新浏览器实例与新浏览器窗口

> ID：303859
> 
> 赞同：6
> 
> 时间：2008-11-19T23:53:28.803
> 
> 标签：asp.net, iis, session, session-state

我希望有人可以为我澄清这种行为，并解释 ASP.NET 是如何决定何时处理类似新会话的东西。

A) 在 Internet Explorer 中，我加载了相关的 ASP.NET 站点。它开始一个新的会话。
B）如果我去菜单文件 - 新窗口......它保持在同一个会话中。
C) 如果我启动一个新的 Internet Explorer 实例并加载相同的页面，它会启动一个新的会话。

我对步骤 C 感到困惑。我希望它是基于我的远程 IP 的同一个会话。
IIS / ASP.NET 正在做什么来确定这是一个新会话？它是否正在查看新的 IE 实例正在使用的远程端口？当您使用 File - New 打开一个新窗口时，它使用与父级相同的远程端口。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-20T00:06:23.613

IIS/ASP.NET 中的会话基于具有会话范围的 cookie，这意味着它们会在浏览器关闭时被销毁，并且显然它们不会在 Internet Explorer 的不同进程中共享。

当您使用 File > New Window 打开一个新的浏览器窗口时，该窗口将由与第一个相同的进程处理（即相同的 iexplorer.exe）。当你从开始菜单启动 IE 时，你会得到一个新进程，你现在在任务管理器中有两个 iexplorer.exe。我认为只有 IE 7 会产生多个进程。

附带说明一下，IE 8 每个选项卡/窗口都有一个进程，就像 Google Chrome 一样。我不知道这些浏览器是否在进程之间共享会话 cookie，但在使用其中一种浏览器进行测试时，一定要牢记这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-20T00:00:37.837

默认情况下，ASP.NET 通过 cookie 跟踪会话。一个新的 IE 实例没有会话 cookie，从而导致一个新的会话。但是，在现有 IE 窗口中使用 File -> New Window 将创建一个具有与“父”相同 cookie 的新窗口，从而允许 ASP.NET 使用现有会话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T23:57:15.723

我想知道新的 IE 实例是否会具有与案例 B 相同的 cookie，虽然它是一个新窗口，但它使用相同的进程。通常在 cookie 或查询字符串中有一个用于将会话映射到各种客户端的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T00:02:25.790

似乎会话数据正在每个进程缓存。A) 和 B) 存在于同一个进程中，而启动 IE 的新实例将创建一个新进程。

# documentation - TeX/LaTeX 的继任者在望吗？

> ID：303877
> 
> 赞同：123
> 
> 时间：2008-11-19T23:59:17.093
> 
> 标签：documentation, latex, tex

TeX/LaTeX 很棒，我以多种方式使用它。它的一些优点是：

*   它使用文本文件，这样可以区分输入文件，并且存在许多处理文本的工具
*   它非常灵活
*   它具有稳定的布局：如果我在文档开头更改某些内容，它不会影响文档末尾的其他内容
*   它有许多扩展来达到不同的目标（继任者会在没有扩展的情况下开始，但会有一个很好的扩展系统）
*   您可以使用标准构建控制工具来支持复杂的文档（感谢 dmckee）
*   您可以封装解决方案并将它们复制并粘贴到新文档中或将它们发送给其他人以学习（感谢 dmckee）

但另一方面，有些小事情不太好：

*   一开始很难学
*   控制图像的位置很复杂
*   有些事情有点违反直觉
*   有时你必须输入太多（begin{itemize} ... \end{itemize}）

那么，是否存在 LaTeX 的继任者/替代品，或者至少是开发中替代品的一些热门候选者。一个真正的继任者/好的替代方案将保持优势并解决劣势，或者至少是其中的一些劣势。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2008-11-20T01:43:01.890

有一个[LaTeX3](http://www.latex-project.org/latex3.html)项目基本上一直在进行。从这个意义上说，它是当前 LaTeX2e 的继承者。

您忘记/忽略了创建 TeX 的主要目标——“TeX 是一种新的排版系统，旨在创建精美的书籍”。TeX 的目标是排版，它的主要关注点是“将段落分成几行”（*Donald E. Knuth 和 Michael F. Plass，Software--Practice and Experience，第 11 卷，第 1119-1184 页，1981 年*） 、连字、字距调整、漂亮的字体（Knuth 与*Hermann Zapf*一起创建了 AMS Euler 等字体），以及对页面上文本布局的精确控制。

LaTeX 是后来建立在 TeX 之上的一组宏，它引入了“文档管理”功能，例如方程式和部分的自动编号、交叉引用等。它来自“LaTeX：文档准备系统”。

人们可以很好地想象 LaTeX 的继任者，提供 LaTeX 文档管理功能的替代品，并且可能做得更好——比如 DocBook。（嗯，它是基于 XML 的，但是……）但是很难想象有替代品会取代排版引擎本身的 TeX。TeX 可能是其中错误数量最少的程序之一——Knuth 为在 TeX 中发现的每个错误提供 327.68 美元，并且已经这样做了很长时间。以高德纳特有的对完美的追求，对其进行了很多思考。它的每个方面都是可配置的，代码是公共领域的（除了限制，如果你进行修改，你必须用其他名字来调用它——这是因为 TeX'

TeX 的一些想法已经融入到 Adob​​e 的 Indesign 中（例如），那些排版引擎也有一些创新的想法，但 TeX 仍然更胜一筹。[注意：Knuth 并不打算让 TeX 永远成为标准，只是“在接下来的 100 年左右”，直到出现更好的东西。据我们所知，可能。]

LaTeX 有基于 TeX 的替代品，例如 ConTeXt 和 LuaTeX。可能有一些任务更适合它们。

回答您的其他反对意见：尽管 LaTeX 可能引入了不必要的复杂性，但学习的 TeX 部分是不可避免的——如果您想创建精美的书籍，无论如何都必须知道*一些事情。*并且不难控制图像的位置；TeX 旨在让您控制页面上的每个[点](http://en.wikipedia.org/wiki/Point_(typography))，但要行使这种控制权，您可能必须超越简单的结构（尽管我从来没有必要......）如果您使用好的编辑器或宏，您不必输入太多 \begin{itemize} ... \end{itemize}; 这只是一个蹩脚的抱怨：P

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-12-03T12:08:21.627

简短的回答是“不”，因为 LaTeX 是现任者并且非常擅长其工作。它也是免费的，因此尝试替换它的商业动机相对较小。事实上，TeX 非常擅长技术出版，以至于技术出版工具的商业市场在“极客”端的 TeX 和“伟大的未洗过”端的词之间受到挤压。

更长的答案是“有替代方案”。LaTeX 和其他软件包严重受[泄漏抽象](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)问题的困扰，并且通常需要技术干预才能从中获得您想要的东西。这使您能够了解它在幕后的工作原理，这实际上是相当技术性的。因此，只有当您可以接触到具有该技术水平的人时，您才能真正将其用于非休闲应用程序。写报告或书很好。使用 LaTeX 构建单一来源的技术文档工作流程是一个完全不同的主张——您需要接触具有技术技能基础的人。

**LaTeX 的替代品**

*   商业技术出版工具。真的只剩下一个人了：[Framemaker](http://tryit.adobe.com/uk/framemaker/?sdid=DTBUI)。这是一个成熟的产品，但有些停滞不前。但是，它确实具有称为[MIF](http://help.adobe.com/en_US/FrameMaker/8.0/mif_reference.pdf)的开放文档和段交换格式、全面的 API 和对结构化文档的广泛支持。它在航空航天界（例如）被广泛使用，其中飞机的参考文件长达数万页。此外，在这个领域还有几个同样存在的问题： [Ventura Publisher](http://www.corel.com/servlet/Satellite/us/en/Product/1152105061811#tabview=tab0)、 [Arbortext](http://www.ptc.com/products/arbortext/)（基于 TeX 派生的后端 IIRC）和 [Interleaf](http://en.wikipedia.org/wiki/Interleaf)，现在称为 Quicksilver。
    Adobe[声明](http://www.adobe.com/products/indesign/features/)在 [InDesign](http://www.adobe.com/products/indesign/)中实现技术发布功能，但我还没有真正评估它的功能。

*   [Lout](http://en.wikipedia.org/wiki/Lout_%28software%29)一种标记语言，其底层架构与 TeX 完全不同。我从未与 Lout 合作过，但我相信它在幕后工作比 TeX 更容易一些。

*   [特罗夫/格罗夫。](http://en.wikipedia.org/wiki/Groff_%28software%29)最初设计用于 1970 年代 AT&T 内部的技术文档（实际上是 UNIX 研发工作的衍生产品），今天它仍然被广泛使用。很长一段时间以来，如果不是所有的 O'Reilly 书籍，大部分都使用它来排版。

*   [文档书](http://www.docbook.org/)。这是一种用于结构文档的基于 XML 标记的格式，并且倾向于通过外部引擎渲染来工作。我从未使用过 DocBook，因此我无法真正评论它在实践中的使用。

*   [完美](http://www.corel.com/servlet/Satellite/us/en/Product/1151523326841#tabview=tab4)的词。这是一个古老的文字处理系统，在大文档方面比 MS-Word 好得多。尽管被视为失败者，但它保留了多个利基市场，例如律师事务所，并且对于大型、复杂和大量交叉引用的文档来说相当不错（至少比 Word 好得多）。

*   [微软字](http://office.microsoft.com/en-gb/word/FX100487981033.aspx)。不推荐用于严肃的技术出版任务，因为它在复杂文档上不稳定。然而，由于政治限制，它往往是唯一的选择。索引特别痛苦。

**编辑：**有关Framemaker 和其他技术文档工具的更深入介绍，请参阅[此 Stackoverflow 帖子。](https://stackoverflow.com/questions/371654/application-not-a-markup-language-for-producing-a-user-manual#372017)这是对一个特别不想使用基于标记语言的系统的人的技术文档工具问题的回答。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-11-21T01:05:28.533

你看过[ConTeXt](http://www.berenddeboer.net/tex/)吗？它是一组用于 TeX 的宏，可以用来代替 LaTeX。

我自己没有使用过它，但示例文档中的语法在许多情况下看起来比 LaTeX 更简单。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-12-03T11:41:13.147

我已经出版了五本用 ConTeXt 排版的书籍，其中四本是带有高质量彩色插图的博物馆目录。它绝对可以生产。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-11-20T01:54:50.963

TeX 实际上是一个相当特殊的排版系统。它做得很好，但对更好的东西没有足够大的需求。“当他设计 TeX 时，Donald Knuth 并不相信单一的排版系统可以满足每个人的需求”（[维基百科](http://en.wikipedia.org/wiki/TeX#Use_of_TeX)）

大多数“较新”的系统构建 gui 并扩展 TeX，我认为这是正确的方法。

您面临的“问题”有很好的理由，因此如果您想建议以不同的方式进行处理，请先研究这些原因。

其次，您自己表示 TeX 很棒，除了一些小问题。Knuth 明确知道它并不适合所有用途和所有人，但他发布了源代码并构建了一个扩展 API，以便任何人都可以根据自己的需要对其进行调整。

您拥有进行建议更改所需的所有工具，并且更新 TeX 比从头开始甚至适应任何其他系统要容易得多。确实，没有什么能比得上 TeX。这并不是说它是最好的，而只是为了让人们明白，实现你提到的所有好事并以某种方式克服坏事将是一项巨大的努力（尽管当你遇到坏事时，你可能会更好地理解为什么存在）。

无论如何，我希望你追求这一点，即使是作为倡导者，并让其他人对此感兴趣。很高兴看到 TeX 在其他领域的应用，但这确实需要修改和更新以便于使用，并且比数学方程更好地支持其他技术实体。

-亚当

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2010-01-28T22:52:16.210

TeX 和 LaTeX 设置了很高的标准；很难想象会有全新的东西出现并取代它们。

我有一份 Knuth 的*Computer Modern Typefaces （**计算机和排版*系列中的 Book E ，我认为*它*与 TAOCP 不同）。我认为没有多少人能看到这本书，而且——放纵我——它真的很值得一看。您可以看到 Kunth 的一些时间都去了哪里。这是前言中的一段话：

> 1984 年，我又一次走运了，当时我得知用于制作 Monotype 8A 模具的原始青铜图案在旧金山。多年来，我一直在处理有关激发这项工作的字体的间接和不精确信息。*首先，我从《计算机编程艺术》*的凸版印刷原始页面的照片放大开始工作；然后，理查德·索瑟尔（Richard Southall）根据他在英格兰找到的原始证明准备了放大版。最后我找到了真正的 80 年历史的图案，这些图案产生了金属类型。这些模型的现任所有者，Othmar Peters 先生，在我准备《现代计算机》的最终稿时，好心地同意让我借用它们，我通过用卡尺测量它们学到了很多东西。

你只是没有在很多地方得到那种对细节的关注，这就是 TeX 经久不衰的原因。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-11-20T00:09:31.673

你不能用新的东西来保留“它有很多扩展来达到不同的目标”。根据定义，不是 TeX/LaTeX 的新事物将开始时没有扩展名。

[作为GNU TeXmacs](http://texmacs.org/)项目的核心贡献者，该项目旨在成为“除了 21 世纪之外的 TeX”，我认为对 LaTeX 的继承有了一些很好的了解。

我不知道任何有可能取代 LaTeX 的东西。数学界有影响力的人太习惯于使用 LaTeX 来认真考虑学习任何可能同样灵活的工具所需的努力。

也许在 20 年后，当所有在 LaTeX 很酷的时候获得博士学位的人都退休时，会有其他东西取代它。希望它类似于 TeXmacs，但没有不必要的复杂性。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-11-20T01:29:50.670

你有[LuaTeX](http://www.luatex.org)。

引用：“LuaTeX 是使用 Lua 作为嵌入式脚本语言的 pdfTeX 的扩展版本。LuaTeX 项目的主要目标是提供一个开放且可配置的 TeX 变体，同时提供向下兼容性。”

Lua 非常简单和快速，所以希望 LuaTeX 不再那么难......希望 :)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-02-11T19:14:25.940

您可能还对[XeTeX](http://en.wikipedia.org/wiki/XeTeX)感兴趣，它是 LaTeX 的现代版本，它支持 Unicode 和许多字体。您可以使用它在一个文档中直接输入日语、阿拉伯语等。（这并没有解决你给出的缺点，但它仍然与关于 LaTeX 的缺点和替代系统的讨论相关！）

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2013-07-02T17:26:47.287

[www.patoline.org](http://www.patoline.org)是 TeX/LaTeX 系统的绝佳替代品。它已经为 Arch Linux、NixOS 打包，并且可以在许多类 Unix 系统上从源代码编译。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-06-10T00:06:48.390

TeX 不是一个通用的排版系统：它的核心能力是排版包含大量数学的长文本。因为它没有任何竞争，我可以想象几个原因：

*   Donald Knuth 很聪明。例如，他在公式中的间距方面做得非常出色。
*   数学符号会随着时间的推移而变化，比如几个世纪。有一组有限的功能是必要的，因此新的排版系统没有市场。
*   网络效应。纸的唯一目的是阅读。大多数论文在其他一些研究的基础上取得进展，并使用他们的符号。使用 TeX，您可以确保获得相同的字体和相同的间距，并且您拥有从他们的论文中复制复杂公式的技术能力。
*   在 TeX 中定义新宏很简单，从定义中很容易说出一个简单的宏做了什么，并且有许多标准的宏库。任何基于 GUI 的系统都可能使这个过程变得不那么透明。

虽然您引用的缺点是真实的，但是环顾四周寻找一个建立在 TeX 之上的体面的编辑器/GUI shell 比用不同的语言排版要容易得多。如果您喜欢数学，并且希望您的文章能够保存数十年，那就是。同样，对于通用排版，您提到的程序很可能是更好的选择。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2010-12-09T17:13:38.100

org-mode，一个 Emacs 扩展，能够生成 LaTeX 和 PDF 文件。org-mode 语法类似于 Markdown。它只是**可读**的。20KB 的文档中只有几行 LaTeX 代码。org-mode 解决了您提到的三个问题-您从 LaTeX 获得了所有令人敬畏的功能并摆脱了其丑陋的语法。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2011-02-14T02:08:30.660

**梦想工具不是 TEX**

TEX 不太好用。Tex 可能（我不是打印方面的专家）很好地提供了一个与打印细节和复杂性分离的图层。

*概念线是这样*
的：数学家不是秘书，他主要关心的是他想展示**什么，而不是****如何**展示。因此需要在 Latex 之上再增加一层抽象。

*总体目标*：
因此，需要（一个梦想）一种工具，它可以更接近我们可以手动完成的工作，当然比手动更快（事实上，我曾经看到 .pdf 中扫描的书面答案正红色- 递给 Latex 的主要作者之一不使用它！）。

*Dream Tool 规格*：（大致了解一下）
S1。学习曲线中大约一个小时的初始时间。
S2。即使累了，也可以快速（通过简单的类比）编写文档。
S3。剪切和粘贴所见公式可用。
S4。比手动更正文档更快（2 分钟而不是手动 5 分钟）。

*今天最好的工具能力* ：
S1。差不多。
S2。不可能一边想别的事。
S3。剪切和粘贴公式描述（实现）。
S4。手动需要 20 分钟而不是 5 分钟（一切都是特定的，你必须来回破译）。

另一个迟钝的例子：请一个写过 10 个类别论图表的 Latex 文档的人以倾斜的方式画出所有的平方，这肯定不是一件容易的事。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2008-11-20T00:01:19.163

我认为[docbook](http://www.docbook.org)应该是 LateX 的基于开放 xml 的替代品。

“DocBook 提供了一个使用 SGML 或 XML 编写结构化文档的系统。它特别适用于有关计算机硬件和软件的书籍和论文，尽管它绝不限于这些。

“简而言之，DocBook 是一种易于理解且广泛使用的 DTD。全球有数十家组织使用 DocBook 来处理数百万页的各种印刷和在线格式的文档。”

-- 来自[文档书常见问题](http://www.dpawson.co.uk/docbook/)

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2012-07-29T04:37:44.317

过了这么久，没有人说出非常重要的事情。

LaTeX 文本写在一个文本文件中，它可以用于**Literate 编程**，这是一种由 Don Knuth 提出的风格，用于编写非常有文档的程序。这个想法是解释程序是如何以类似于数学文本的方式开发的。在数学文本中，代码片段就像公式一样呈现。这是一个好主意，一段时间后您可以阅读程序是如何构思的，并且您可以修改解释为什么以相同方式做出决定的部分。

另一个优点是**您可以生成 LaTeX 代码作为程序的输出**，通过这种方式，您可以发布漂亮的排版结果，或者使用 gnuplot 等程序生成图形，然后为图形生成 LaTeX 代码并将其插入到文本中，即非常棒，因为与导出为某种图像格式的图形相比，生成的文件非常轻，`\includegraphics`如果您通过粘贴使用某些文字处理器，则可以将其包含在内或更糟。

LaTeX 并不难学，只要慢慢来，从简单的文档开始使用你需要的东西。当您在学习中取得进步时，您将需要学习新的功能和软件包。如果你试图通过学习所有包来掌握 LaTeX 只是为了成为一名 LaTeX 专家，那你就是在浪费你的时间，有大量的包，但你不需要全部学习。尝试从*“the not so short introduction to LaTeX”* lshort.pdf 或*“A Gentle Introduction to TeX”* gender.pdf 之类的指南开始。如果您厌倦了输入长宏，请学习为您使用更多的部分编写自己的宏，指南中有一个关于此的部分。

在 ctan.org、tug.org 中查找信息的位置，*不要*在 latex.com 中搜索该域代表橡胶材料。

有一个 TeX/LaTeX 目录，在 ctan.org 中搜索它在您需要特殊功能时非常有用。[您可以在http://texcatalogue.sarovar.org/index.html](http://texcatalogue.sarovar.org/index.html)找到它，但如果此链接已过时，您可以搜索 texcatalogue。

结束我的评论，LaTeX 和其他软件不经常更换版本有一个很大的优势，TeX/LaTeX 是一个非常完整的排版系统，如果您需要一些不存在的东西，您可以添加（和共享）更多功能. **学习 LaTeX 是一种很好的时间投资，你只需要学习一次，然后专心做你的工作，而不是学习新版本。**

PS 我忘了说可以编写程序将 LaTeX 翻译成其他标记语言（如果有文档，还有文字处理器格式），*反之亦然*. 事实上，有几个可以给出可接受的结果，虽然据我所知还没有翻译任何 LaTeX 代码的程序，但对于更常见的文本，你可以找到几个将它们翻译成 HTML 的程序，LibreOffice 可以导出一个单词处理器文档到 LaTeX，虽然它不是很有用，因为很少有文字处理器用户使用标签将段落标记为标题、引号等。绝大多数标记文本以更改字体、大小、对齐方式等，这是翻译进入 LaTeX。但是在与使用 word 或 LibreOffice 的人协作时，您可能需要这样做，并且您必须将其与您的 LaTeX 文本集成，只需要求他们使用正确的标记或将其导出为文本并手动插入所需的宏你必须审阅你的合作者的全文。

曾经需要将其转换为 HTML 以在网上发布或制作便携式演示文稿，但现在带宽允许快速传输 PDF 文件，并且像 beamer 这样的软件包可以让人们编写非常漂亮的演示文稿。

TeX/LaTeX 的优势在于可以在其上写入的包的大小以及共享它们的意愿。感谢 Knuth 的伟大创意，我们仍在等待他的全套计算编程艺术。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2008-11-20T00:36:23.787

除了图形难以定位的问题外，您对 LaTeX 的其他批评更多地与它的 UI 或缺乏 UI 有关。

如果您想使用 LaTeX 生成文档但想要更简单的方式使用它，那么您真的应该查看 LyX。它是 LaTeX 的 GUI 前端并解决了您的几个问题：它使 LaTeX 更易于学习（事实上，您甚至不必了解 LaTeX 就可以创建一个简单的、无数学的文档），它更直观，并且可以节省你打字。它还添加了拼写检查、更好的图形处理、导航等。

因为 LyX 只是 LaTeX 的前端，所以您仍然可以获得精美呈现的文档。LyX 文档也是纯文本，因此版本控制效果很好。事实上，LyX 已经内置了对 subversion 的支持。

如果您还没有猜到，我衷心推荐 LyX。我用它写了我的整个[博士论文](http://threewordslong.com/blog/entry/56/The_Reviews_Are_In)，发现它非常值得。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2008-11-20T04:23:14.283

这并没有真正切入 LaTeX 的主要缺点，但没关系:) 关于你的观点

*   “有时你必须输入太多（begin{itemize} ... \end{itemize}）”

这完全是设计使然。在简洁（并且更容易输入）和易于理解（并且输入更长）之间需要权衡取舍。更长的名字也有更少的冲突，因为 TeX 和 LaTeX 不支持命名空间（很遗憾）。

无论如何，一个好的编辑会消除上面的抱怨。设置键绑定或制表符完成或其他任何你喜欢的东西，你永远不必写

```
\begin{whatever}...\end{whatever} 
```

以后再。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-11-20T00:10:54.260

你的四个缺点可以概括为“太难”、“太难”、“太难”，最后是“太难”。我认为解决方案是学习如何正确使用系统。

任何为新手设计的系统都会在其他方面表现出缺陷，失去控制或失去灵活性。如果您希望更轻松地放置图像，请尝试使用 MS Word。如果不努力学习该程序，就无法绕过简单性。TeX 支持定义宏，因此如果您愿意，您可以将该 \begin{itemize} 标记更改为更可口的内容，例如 \bi。一旦你充分了解了 LaTex 世界，它就和普通打字一样快。

我以前在数学课上练习用 TeX 写笔记，因为用 \sum_{n=1}^i 写比在 MS Word 中查找符号要快。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-11-20T01:03:50.083

不是真正的继任者，但您可能想查看 *roff (groff, troff, nroff)。我不太了解它，但我记得它的格式很简洁。它是用于手册页的工具。由于我只是顺便听说过，所以我不能再给你任何帮助了。

例如：

```
 .pl 10.0i
        .po 0
        .ll 7.2i
        .lt 7.2i
        .nr LL 7.2i
        .nr LT 7.2i
        .ds RF FORMFEED[Page %]
        .ds LH Internet Draft
        .\"   --> Header/footers: Set short title, author(s), and dates:
        .ds CH 2-nroff.template                  \" <Short title>
        .ds LF Postel, Braden                    \" <Authors>
        .ds RH October 25, 2006                  \" <Submission date>
        .ds CF Expires April 2007                \" <Expiration date>
        .hy 0
        .ad l
        .nf
        .\" 5678901234567 check 72 column width 12345678901234567890123456789012
        Internet Draft                                                 J. Postel
        <draft-rfc-editor-nroff-template-00.txt>                      RFC Editor
        Category: Informational                                          USC ISI
        Expires April 2007                                      October 25, 2006

        .ce
        Nroff Template for Internet Drafts and RFCs
        .ce
        <draft-rfc-editor-nroff.template-00.txt>

        .in 3              \"  Basic indent for text is 3 spaces
        .ti 0              \"  "Temporary indent" for next line: 0 spaces
        Status of this Memo

        Distribution of this memo is unlimited.

        By submitting this Internet-Draft, each author represents that any
        applicable patent or other IPR claims of which he or she is aware
        have been or will be disclosed, and any of which he or she becomes
        aware will be disclosed, in accordance with Section 6 of BCP 79.

        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF), its areas, and its working groups. Note that other groups
        may also distribute working documents as Internet-Drafts.

        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-04-03T08:50:02.843

XSL-FO 可能适合您的需要。虽然它不如 TeX 强大，但它确实可以很好地处理像 DocBook 这样的 XML 格式。一个流行的开源实现是 Apache FOP：http: [//xmlgraphics.apache.org/fop/](http://xmlgraphics.apache.org/fop/)。

如果您需要非常精细地控制排版，最好使用 TeX 或 FrameMaker 或 InDesign* 等专有工具。

*注意：InDesign 目前对 IMO 的 XML 支持较弱

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2011-10-16T16:07:30.607

我只是偶然发现了 [AsciiDoc](http://www.methods.co.nz/asciidoc)，它看起来像一种简单的文本标记语言（á la markdown、textile），但它的功能要强大得多。它与 DocBook 大致等价，因此它可以发出 html、pdf 甚至 docbook xml 以供进一步处理。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2008-11-20T01:30:42.977

您可能想查看维基百科的分类[排版编程语言](http://en.wikipedia.org/wiki/Category:Typesetting_programming_languages)和[免费排版软件](http://en.wikipedia.org/wiki/Category:Free_typesetting_software)。[Lout](http://en.wikipedia.org/wiki/Lout)特别好听。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-12-02T12:58:34.527

我只是略过它，但 Emacs Muse [http://mwolson.org/projects/EmacsMuse.html](http://mwolson.org/projects/EmacsMuse.html)可能很有趣（如果有人对此有更多经验，我很感兴趣。我喜欢生成多个后端的想法，乳胶，texinfo或其他东西。）

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2012-03-12T02:23:03.767

从技术上讲，[Sphinx](http://sphinx.pocoo.org/)不是 LaTex 的替代品，而是可以让您的生活更轻松的东西，并且（如果需要）为您生成 PDF（通过 LaTex）、HTML 或纯文本输出。

它主要面向代码文档，但由于它使用[reStructuredText](http://docutils.sourceforge.net/rst.html)，人们发现它更容易用于[其他目的](http://sphinx.pocoo.org/examples.html#homepages-and-other-non-documentation-sites)，包括[写书](http://sphinx.pocoo.org/examples.html#books-produced-using-sphinx)。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-12-02T11:20:44.490

特定工作的工具：

Latex2e 的优势在于它是一种标准的文档准备和表示语言，有利于文章和书籍的表示。然而，它对于排版来说并不是很好。这不是一件坏事：过早的排版是所有排版罪恶的根源：大多数出版商只是在复制编辑过程开始时就抛弃了作者的排版。

上下文非常适合排版；作为一种文档表示语言，它们无法与 Latex 竞争，因为它并没有真正解决任何应该在文档准备/编辑阶段解决的问题，因此任何人都没有理由改变成熟的 Latex。

与其通过 Latex3 的努力来修复 Latex2e 的不重要的发布缺陷，我更愿意看到努力开发以下工作流程：

1.  文件准备：Latex2e
2.  文案编辑：Latex2e
3.  转换：应用工具取 Latex2e -> Context
4.  排版：上下文
5.  校对：利用工具检查 Latex2e 内容与 Context 内容

* * *

后记

1.  上述工作流程与通常的工作流程非常匹配，其中创作/编辑在 Word 中完成，排版使用 Indesign 或 Quark Xpress 完成。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-12-02T13:17:08.833

也许你已经注意到了 TeX 奇怪的版本号。当 TeX 达到第 3 版时，Knuth 不希望 TeX 像大多数软件那样进一步发展到新版本。相反，他希望它收敛到最终且没有错误的 TeX。因此，版本号现在向数学数字 pi 收敛。在版本 3 之后是版本 3.1，然后是 3.14，当前版本是 3.1415926。

以类似的方式，Metafont 有一个收敛于数学数字 e（当前为 2.718281）的版本。

基于此，您的问题的答案是 Knuth 不希望 TeX 演变成 TeX 版本 4。

# product - 软件开发应该与软件设计和可用性分开吗？

> ID：303891
> 
> 赞同：4
> 
> 时间：2008-11-20T00:01:29.897
> 
> 标签：product, vision

在我迄今为止从事的大多数商业工作中，我的角色主要局限于“编写代码”，而我最初想从事开发的原因是因为我喜欢软件的可用性和设计方面。

我现在感到有点失望，因为现在，我几乎所有的工作日都花在“把东西放在一起”上。这似乎是可以想象的最平凡的工作，如果人们认为我们有能力，程序员在某些行业中往往会受到轻视也就不足为奇了。

回答我的问题 - 是否有适合想要进行创意控制的开发人员的工作？对于那些不仅仅是代码猴子，而是想要构建一个漂亮的产品并大量参与的开发人员，不仅仅是在代码中，而是在产品的整个设计和愿景中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T00:10:49.533

是的，工作存在；而且它们并不难进入。不过，我发现这些机会存在于较小的公司。

一般来说，大公司有更多的“结构”，高级人员在其中进行设计，然后实施。一般来说，设计被认为是一项更“高级”的活动，并且有充分的理由，因为只有通过经验，你才能了解什么是好的设计。

但在较小的公司中，没有那么稳固和固定的层级；甚至在小公司的初级职位上，你也可以对设计进行大量投入。特别是如果你表现出兴趣和技能。

我的建议是在一家规模较小的公司找到一个职位；几乎可以肯定，您将有机会在那里发挥您的设计技能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T00:05:38.873

这与我的经历是如此陌生，以至于我很庆幸我一直在一家小商店里，一个人必须是多面手。如果你对那个世界感兴趣，我建议你去一家较小的商店或公司，在那里他们使用小团队进行项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T00:08:16.420

听起来你可能最快乐地创办自己的软件公司，或者至少在业余时间从事自己的项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T00:10:01.860

我不确定你在研究什么技术。但是现在您可以看到一个新兴的创意编程领域，称为富互联网/交互式应用程序 (RIA) 开发。在 RIA 世界中还有一个新角色，称为***Integrators 或 UX Developers——***他们实际上从事编程和交互设计，比如效果和动画，以及很多乐趣。这些人实际上介于“ ***Photoshop*** ”设计师和核心程序员之间。

WPF、Silverlight、Flash 等就是这种技术的例子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T02:28:35.310

在我的公司 (Large+)，每个开发人员的任务是开发一个子应用程序，这是整个系统的一部分。整个系统的设计是由前辈完成的，但是每个子应用程序的设计是每个开发人员的责任（当然包括与您需要与之交互的子应用程序的开发人员讨论设计）。所以它实际上非常好

# nhibernate - 有任何 Rhino Commons 入门教程吗？

> ID：303906
> 
> 赞同：4
> 
> 时间：2008-11-20T00:05:59.370
> 
> 标签：nhibernate, rhino-commons

这个博客曾经有一个很棒的博客：[http](http://www.hanneyetc.co.uk/) ://www.hanneyetc.co.uk/ ，但现在离线了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T07:16:19.143

Ryan Lanciaux 博客： [RhinoCommons、NHibernate 和 ASP.NET MVC 第 1 部分 - 设置](http://frickinsweet.com/ryanlanciaux.com/post/RhinoCommons2c-NHibernate-and-ASPNET-MVC.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T05:17:16.820

更多资源：

*   艾扬德的[维基](http://ayende.com/wiki/Rhino%20Commons.ashx)
*   Ayende 的[Exesto](https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/SampleApplications/Exesto/)（示例应用程序）
*   [Rhino Commons 单元测试](https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/rhino-commons/Rhino.Commons.Test/)

# rest - REST 工具支持开发和测试

> ID：303911
> 
> 赞同：23
> 
> 时间：2008-11-20T00:07:30.850
> 
> 标签：rest

[这里](https://stackoverflow.com/questions/203495/testing-rest-webservices)有一个类似的问题，但它只涵盖了以下一些问题。

我们有一个客户需要使用 REST 的 Web 服务。

我们有大量使用 SOAP 的经验，并且随着时间的推移，我们收集了一套非常好的 SOAP 开发和测试工具，例如

*   肥皂界面
*   Eclipse 插件
*   wsdl2java
*   WS工作室

我所说的“工具”是指我们可以开始使用的“开箱即用”产品。我不是在谈论使用 Ajax 或其他什么东西来削减代码以“自行开发”。

REST 工具集似乎还没有那么成熟？

*   有哪些工具（我们主要使用 C# 和 Java）？

*   这些工具是否处理 GET、POST、PUT 和 DELETE？

*   有没有像样的 Eclipse 插件？

*   是否有像 WSStudio 这样的体面的客户端测试应用程序，您将工具指向 WSDL，它会使用适当的方法和输入动态生成代理，然后您只需输入数据？

*   有什么好的包监控工具可以让你查看数据吗？（我在这里考虑的不是像 Wireshark 这样的嗅探器，而是像soapUI 这样允许您查看请求/响应的东西）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-03-20T08:44:14.623

我用谷歌搜索并找到了这个用于 chrome 的插件。

[邮递员 REST 客户端](https://github.com/a85/POSTMan-Chrome-Extension)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-20T11:10:19.187

对于初学者，您需要一个工具来构建任意 HTTP 请求（包括诸如内容类型、HTTP 方法、HTTP 身份验证和请求正文等标头）并检查 HTTP 响应（包括状态代码、标头和响应正文）。如果它是可编写脚本的工具，那就太好了。

看一下：

*   [Eclipse HTTP 客户端](http://http4e.roussev.org/)
*   [rest-client](http://code.google.com/p/rest-client/) - 独立的 Java GUI 应用程序和插件（参见[nodeclipse](http://www.nodeclipse.org/restclient-tool/)）

要自动生成代理，我猜您正在寻找可以解析[WADL](https://wadl.dev.java.net/)的东西，即WSDL 的 REST 答案。不幸的是，我不知道这样的事情。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-04-16T00:14:28.110

我发现了一个不错的 Firefox 插件，名为 Poster，它允许您充当类似于 rest-client 和其他客户端的 REST 客户端。我希望它将响应呈现给 Firefox 选项卡（而不是自定义输出窗口），因此任何返回的 XML 都可以通过 Firefox 的出色语法突出显示来着色。但总的来说似乎工作正常。

更新：哦，更好。我发现了另一个名为 RestClient [https://addons.mozilla.org/en-US/firefox/addon/9780](https://addons.mozilla.org/en-US/firefox/addon/9780)的 firefox 插件。这似乎做了语法高亮。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-20T00:31:29.960

在 Java 方面，有 JAX-RS API，它是用于 Xml 的 Java Api，使用 Restful Services 或类似的东西。基本上，JAX-RS 提供了一种更标准的方式来用 Java 构建 RESTful 服务。

还有 Restlet，它允许轻松开发 Restful 服务，并且基于 JAX-RS 规范。

此外，查看最近添加了对 REST 的良好支持的 SOAP-UI。

[http://www.restlet.org/](http://www.restlet.org/)

[http://jcp.org/en/jsr/detail?id=311](http://jcp.org/en/jsr/detail?id=311) - JAX-RS

[http://www.eviware.com/content/view/134/1/](http://www.eviware.com/content/view/134/1/) - SOAP-UI

[http://sourceforge.net/projects/soapui](http://sourceforge.net/projects/soapui) - SOAP-UI

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-12-11T13:46:31.053

测试 REST API 调用的最简单且最好的客户端工具是 Firefox 插件[RESTClient](https://addons.mozilla.org/en-US/firefox/addon/restclient/)。

安装插件并测试 API 调用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-10-27T19:35:28.600

[Runscope](http://www.runscope.com)是一项基于云的服务，可让您[检查对 Web API 的请求和响应](https://www.runscope.com/docs/debugging)。它还对 API 性能[进行测试和测量](https://www.runscope.com/docs/radar)。

免责声明：我为 Runscope 工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-20T07:17:38.283

我想强调一下，Restlet 项目支持两个 API 来开发 RESTful 应用程序：

*   核心 Restlet API：基于类，客户端和服务器端，多协议，非常大的功能范围
*   JAX-RS API：基于注释，仅​​服务器端，功能范围更小

Restlet 可以部署在 Servlet 容器、独立（纯 JVM）、客户端的 GWT、Spring、Mule ESB 或 OSGi 容器中。这是功能的完整[列表](http://www.restlet.org/about/features)。

最好的祝福，

[杰罗姆·卢维尔](http://www.noelios.com)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-16T07:59:37.527

SOA Cleaner，是一个测试soap 和rest 的测试工具（也是WCF，但是你好像不需要那个特性）。它非常直观且可用。用 .NET 编写。还提供免费版本。可以从[http://xyrow.com](http://xyrow.com)下载。祝你好运！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-04T20:15:39.157

在客户端测试应用程序方面，我遇到了类似的问题。我找不到可以用来快速测试进出我正在创建/使用的 Web 服务的数据的工具。所以我使用 C# .NET 创建了自己的工具。它本质上是一个客户端应用程序，可用于对 rest 服务进行 GET、POST、PUT 和 DELETE 查询。

该软件称为 REST Scratch Pad。它允许您输入要发送到 REST 服务的数据，并查看查询结果及其标题和响应时间。它将处理基本身份验证并记住您在之前的会话中使用的 URL（以避免重新键入长 URL）。

当前版本是免费的。下一个版本将使用较新版本的 .NET 并涵盖更多身份验证方法。

[REST ScratchPad](http://restscratchpad.com/download)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-24T13:18:03.790

有一些工具可以做这些事情，但目前还很少支持 RESTful API。

“玫瑰”： [http ://www.ibm.com/developerworks/rational/library/design-implement-restful-web-services/index.html](http://www.ibm.com/developerworks/rational/library/design-implement-restful-web-services/index.html)

但你将需要雄厚的财力...

暂时不知道其他人。想知道虽然（买得起的东西）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-10-15T06:16:15.787

一个很好的 REST Web 服务测试器是[HttpMaster](http://www.httpmaster.net)。

它支持各种 http 方法，并允许您监控完整的请求/响应数据。您还可以使用动态参数来执行一组请求，它还支持简单的响应数据验证。它易于使用，但只能在 Windows 上运行（它是一个 .NET 应用程序）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-11T03:20:28.370

[https://play.google.com/store/apps/details?id=com.snmba.restclient](https://play.google.com/store/apps/details?id=com.snmba.restclient)

是一个非常强大的工具，可以直接从 android 设备对 rest 服务进行故障排除。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-01-22T10:32:45.527

您可以尝试使用[REST Assured](https://code.google.com/p/rest-assured/)库，它可以非常轻松地从 Java 测试 REST 服务。例如，假设您的资源名为“greeting”并返回以下 JSON：

```
{ "greeting" : { "firstName" : <first_name>, "lastName" : <last_name> } } 
```

您可以在 REST Assured 中像这样测试它：

```
given().
        param("first_name", "John").
        param("last_name", "Doe").
when().
        get("/greeting").
then().
        statusCode(200).
        body("greeting.firstName", equalTo("John").
        body("greeting.lastName", equalTo("Doe"); 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2012-08-27T10:30:21.447

SoapUI，尽管它的名字，也可以支持 REST 请求。因为 REST 通常不提供类似 WSDL 的任何东西，但您需要自己创建 Web 界面所需的请求。根据 REST Web 服务的复杂性，这可能是微不足道的，也可能是要求很高的，但它至少应该立即为您提供一些结果。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2014-05-15T09:50:13.697

[https://restclientgui.codeplex.com](https://restclientgui.codeplex.com) 可从下载部分下载的稳定版本。

# java - Java：将整数从文件读入数组

> ID：303913
> 
> 赞同：14
> 
> 时间：2008-11-20T00:08:21.177
> 
> 标签：java, arrays, io

```
File fil = new File("Tall.txt");
FileReader inputFil = new FileReader(fil);
BufferedReader in = new BufferedReader(inputFil);

int [] tall = new int [100];

String s =in.readLine();

while(s!=null)
{
    int i = 0;
    tall[i] = Integer.parseInt(s); //this is line 19
    System.out.println(tall[i]);
    s = in.readLine();
}

in.close(); 
```

我正在尝试使用文件“Tall.txt”将其中包含的整数写入名为“tall”的数组中。它在某种程度上做到了这一点，但当我运行它时，它也会引发以下异常（：

```
Exception in thread "main" java.lang.NumberFormatException: For input string: ""
    at java.lang.NumberFormatException.forInputString(Unknown Source)
    at java.lang.Integer.parseInt(Unknown Source)
    at java.lang.Integer.parseInt(Unknown Source)
    at BinarySok.main(BinarySok.java:19) 
```

为什么它会这样做，我该如何删除它？正如我所看到的，我将文件作为字符串读取，然后将其转换为整数，这不是非法的。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-11-20T01:21:48.097

您可能想做这样的事情（如果您使用的是 java 5 及更高版本）

```
Scanner scanner = new Scanner(new File("tall.txt"));
int [] tall = new int [100];
int i = 0;
while(scanner.hasNextInt()){
   tall[i++] = scanner.nextInt();
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-20T00:10:12.687

您的文件中必须有一个空行。

您可能希望将 parseInt 调用包装在“try”块中：

```
try {
  tall[i++] = Integer.parseInt(s);
}
catch (NumberFormatException ex) {
  continue;
} 
```

或者在解析之前简单地检查空字符串：

```
if (s.length() == 0) 
  continue; 
```

请注意，通过`i`在循环内初始化索引变量，它始终为 0。您应该将声明移到`while`循环之前。（或者让它成为`for`循环的一部分。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T20:24:44.413

为了比较，这里是另一种读取文件的方法。它的一个优点是您不需要知道文件中有多少个整数。

```
File file = new File("Tall.txt");
byte[] bytes = new byte[(int) file.length()];
FileInputStream fis = new FileInputStream(file);
fis.read(bytes);
fis.close();
String[] valueStr = new String(bytes).trim().split("\\s+");
int[] tall = new int[valueStr.length];
for (int i = 0; i < valueStr.length; i++) 
    tall[i] = Integer.parseInt(valueStr[i]);
System.out.println(Arrays.asList(tall)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-20T00:14:27.310

看起来 Java 正在尝试将空字符串转换为数字。您在数字系列的末尾有一个空行吗？

您可能可以像这样修复代码

```
String s = in.readLine();
int i = 0;

while (s != null) {
    // Skip empty lines.
    s = s.trim();
    if (s.length() == 0) {
        continue;
    }

    tall[i] = Integer.parseInt(s); // This is line 19.
    System.out.println(tall[i]);
    s = in.readLine();
    i++;
}

in.close(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T00:15:36.967

您可能会在不同的行尾之间产生混淆。Windows 文件将以回车符和换行符结束每一行。Unix 上的某些程序将读取该文件，就好像它在每行之间有一个额外的空白行，因为它将回车视为行尾，然后将换行视为行的另一端。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-03T06:39:48.153

```
File file = new File("E:/Responsibility.txt");  
    Scanner scanner = new Scanner(file);
    List<Integer> integers = new ArrayList<>();
    while (scanner.hasNext()) {
        if (scanner.hasNextInt()) {
            integers.add(scanner.nextInt());
        } else {
            scanner.next();
        }
    }
    System.out.println(integers); 
```

# wpf - IoC 和用户界面

> ID：303916
> 
> 赞同：0
> 
> 时间：2008-11-20T00:09:33.920
> 
> 标签：wpf, dependency-injection, inversion-of-control, sta

我正在尝试在我的应用程序中使用 IoC 进行依赖注入的最佳方式，但是我有一个小问题。

我在 WPF 应用程序中使用 MVP 模式的松散实现。本质上，演示者类被实例化，视图和任务（例如 EmployeePresenter 的 IEmployeeView 和 IEmployeeTask）被注入到演示者中。

我想使用 IoC 容器（我正在尝试 Unity，尽管我猜这也会发生在其他人身上，例如 ninject 或 Structure Map）而不是手动注入这些实例，但是如果演示者是创建的（或从IoC 容器）在异步委托调用或事件线程（例如非 STA 线程）上创建 WPF 窗口的新实例会引发以下异常：

> 当前构建操作（构建键 Build Key[ *namespace* .Window1, null]）失败：调用线程必须是 STA，因为许多 UI 组件都需要这个。

现在，我知道新窗口实例等需要是 STA，但是即使必须在 STA 线程上创建 UI，是否可以使用 IoC 容器进行依赖注入？

从这个问题来看，被解析的类/类型似乎是在解析时实例化的，而不是在其注册时...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T00:19:34.087

我会说使用工厂来创建 Presenter 对象；这样，您可以在 STA 线程中的 PresenterFactory 中创建您的 Presenter 的通用实例，然后在需要时简单地将它们传递出去。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T10:56:20.510

您的问题与 IoC 无关，只能从创建它的同一线程访问 WPF 对象 - 因此您必须在与 GUI 的其余部分相同的线程上创建您的演示者（而不仅仅是任何 STA 线程）。

使用 Dispatcher.BeginInvoke 在主线程中运行代码并从那里调用 Ioc contianer。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T17:46:15.627

您提到 Unity，您是否考虑过使用也使用它的复合应用程序库？StockTrader 示例应用程序使用 Unity 将视图注入演示模型。如果您不想实际使用 CAL - 更多信息：( [http://msdn.microsoft.com/en-us/library/cc707890.aspx](http://msdn.microsoft.com/en-us/library/cc707890.aspx)或[http://www.codeplex.com/CompositeWPF](http://www.codeplex.com/CompositeWPF)）

你也许仍然能够弄清楚他们是如何解决这个问题的。

# sql-server-2008 - Sql 2008 查询问题 - 哪个 LatLong 存在于地理多边形中？

> ID：303927
> 
> 赞同：4
> 
> 时间：2008-11-20T00:11:08.363
> 
> 标签：sql-server-2008, latitude-longitude, geography

我有以下两个表：-

地理形状

*   GeoShapeId INT IDENTITY
*   名称 VARCHAR(100)
*   ShapeFile GEOGRAPHY [这是纬度/经度的封闭多边形]

犯罪地点

*   CrimeLocationId INT IDENTITY
*   LatLong GEOGRAPHY [这是一个纬度/经度点]

现在，我有大约 10K GeoShape 结果和大约 500CrimeLocations。

*我试图找出所有 500 个犯罪纬度/经度点都存在于哪些 GeoShapes 中。*

:( 我就是不明白！我试图`STIntersects`在子查询上做一个但没有用。有什么建议吗？

干杯！

编辑1：我不能使用任何`GEOMETRY`功能..因为（如上所述）这些都是地理类型。

编辑 2：我知道如何使用`STContains`和`STIntersects`. 请不要提供这方面的基本示例。我对使用上面的表结构进行复杂查询更加好奇。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-11T11:36:49.617

关于您的“编辑”，您通常不会看到包含“请不要提供...”的问题。当然，每一点都有帮助吗？特别是因为您实际上还没有向我们展示您*所*知道的`STContains`或`STIntersects`（或`Filter()`就此而言）......

无论如何，我有一个方便的邮政编码和存储位置的数据库，所以我重命名了表/列以匹配您的（然后我有 6,535 个 CrimeLocatoins 和 3,285 个 GeoShapes）。我想你现在已经弄清楚了 - 但其他人可能会发现这很有用......

以下查询返回每个**GeoShapes.ShapeFile中的****CrimeLocations数量**

 **```
SELECT G.Name, COUNT(CL.Id)
FROM   GeoShapes G
INNER JOIN CrimeLocations CL ON G.ShapeFile.STIntersects(CL.LatLong) = 1
GROUP BY G.Name
ORDER BY 2 DESC 
```

这需要很*长时间*（比如 20 分钟），因为我没有设置任何地理空间索引，而且我的 ShapeFiles 的点数很高，但它确实运行成功。如果我想按照您的建议限制结果：

```
SELECT G.Name, COUNT(CL.Id)
FROM   GeoShapes G
INNER JOIN CrimeLocations CL ON G.ShapeFile.STIntersects(CL.LatLong) = 1
GROUP BY G.Name
HAVING COUNT(CL.Id) = 500 
```

当然，您不想对数字 500 进行硬编码 - 因此您可以在其中添加一个`COUNT(*) FROM CrimeLocations`子查询，或者一个带有来自单独查询的总数的变量。

够复杂吗？

# sharepoint - Sharepoint AspMenu 控件中的显示分隔符

> ID：303929
> 
> 赞同：1
> 
> 时间：2008-11-20T00:11:24.120
> 
> 标签：sharepoint

我要做的就是在 Sharepoint 的主要导航菜单项**之间显示一个分隔符（我尝试过图像和样式表）。**这是我想要的样子：

```
Home | Menu1 | Menu2 | Menu3 
```

当我尝试使用 StaticTopSeparatorImageUrl（使用条形图像）时，会导致以下结果：

```
Home | Menu1 | Menu2 | Menu3 | 
```

这显然不是分隔符，当我使用 StaticBottomSeparatorImageUrl 时，会发生相反的情况。我还尝试将 ms-topnav 类设置为具有左边框，这不起作用，因为控件无法识别菜单中的第一个（或最后一个）项目......

所以，我的下一个选择是使用 Telerik RadMenu，在努力让它进入 Sharepoint 之后，我很难让它像使用 SiteMapDataSource 的 Sharepoint 菜单一样显示（只显示 Home 项，没有子项）。

这看起来很简单，但它是 Sharepoint，所以没有什么是真正简单的。我想知道是否有一种方法可以使我可能错过的默认 Sharepoint 分隔符正常工作，或者是否有一个真正考虑到样式的 GOOD Sharepoint 菜单替换？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T03:00:24.433

我更喜欢从 SharePoint 团队发布的 MossMenu 继承并自定义菜单以*完全*生成我想要的 html。

[http://blogs.msdn.com/sharepoint/archive/2006/12/02/customizing-the-wss-3-0-moss-2007-menu-control.aspx](http://blogs.msdn.com/sharepoint/archive/2006/12/02/customizing-the-wss-3-0-moss-2007-menu-control.aspx)

[这里的部署](http://www.thesug.org/blogs/lsuslinky/Lists/Posts/Post.aspx?List=ee6ea231-5770-4c2d-a99c-c7c6e5fec1a7&ID=15&Source=http%3A%2F%2Fwww.thesug.org%2Fblogs%2Flsuslinky%2FLists%2FCategories%2FCategory.aspx%3FName%3DMOSS)说明应该会有所帮助。

1.  将 Microsoft.SDK.SharePointServer.Samples.dll 放入 GAC。
2.  编辑 web.config 文件并添加以下 SafeControls 条目：
3.  将 MossMenu.js 文件复制到 \12\TEMPLATE\LAYOUTS
4.  使用以下内容编辑您的 MasterPage：<%@ Register Assembly="Microsoft.SDK.SharePointServer.Samples, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6f07a0c27c74cfa1" Namespace="Microsoft.SDK.SharePointServer.Samples" TagPrefix="共享点" %>
5.  使用 SharePoint:MossMenu 更改 SharePoint:AspMenu 标记。保持所有配置标签相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-22T16:37:22.753

可以通过覆盖在 Core.css 的 topNavItem 中设置为右上角（不重复）的背景图像来自定义实际的拆分器或分隔符

只需更改那里引用的图像。

# agile - 当参与者相隔 12 个时区时，你如何让“scrum”发挥作用？

> ID：303933
> 
> 赞同：10
> 
> 时间：2008-11-20T00:14:36.577
> 
> 标签：agile, timezone, scrum

当其中一名参与者在印度（+05:30）而其他人在美国（-06:00 和 -08:00）时，尝试组建 scrum 是否明智？每个人都没有一个舒适的会议时间。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-20T00:22:53.957

我遇到过这种情况，这确实使项目管理变得困难。我看到这个“工作”的一种方式（引用是因为公司最终倒闭了，但它在一段时间内起作用）是在两组之间有非常明确的任务分离；基本上在“开发人员组”的两个实例之间强制执行“接口定义”。这样，您可以最大限度地减少相互依赖，同时清楚地说明每个人的责任；交付物变得更简单。仍然有一定数量的“愚蠢的早会时间”，但它被最小化了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-20T00:18:10.843

恕我直言，不，这不值得，不仅因为时区，还因为延迟

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-22T21:35:29.520

在我看来，在印度只有一个参与者几乎是最坏的情况。像 wikis 和第二次 scrum 这样的工具会有所帮助，但团队不对称的事实才是真正会扼杀一切的原因。

您也可以尝试让主团队中的某个人与您在印度的团队成员“搭档”。他们的职责是让印度人及时了解他们可能错过的内容，这发生在每个人都设法参加的会议之外。

我写了一篇关于分布式团队整个主题的白皮书。您可能会发现它很有帮助。

[http://www.ademiller.com/blogs/tech/2008/10/patterns-practices-agile-showcase/](http://www.ademiller.com/blogs/tech/2008/10/patterns-practices-agile-showcase/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-20T00:22:17.810

除了美国参与者的 scrum 之外，您可能还希望每个人每天都在 wiki 上发布状态和问题。重点是以最有效的方式进行日常沟通。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-20T00:20:08.907

以这样一种方式进行流程，即通过一个渠道进行通信。在每个地方都有 scrum，让他们将其更新到项目门户（Wiki）或 VSTS 或任何其他单一渠道。因此，不要只是一个早上的 scrum，而是每天进行两次 scrum，这样你们就可以从每天 24 小时的项目运行时间中受益。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-20T01:18:55.170

实际上，从经验来看，我觉得跨不同时区工作在某种程度上是一种祝福。因为没有什么比早上来看到事情实际上有进展并且正在处理错误等等......它给你一种温暖的感觉。

无论如何，我们使用邮件列表。不是 scrum，但邮件列表和紧急情况下的聊天可以很好地工作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-06-19T20:26:13.077

橄榄球队是否在一个领域一起比赛？.. 当关键团队成员实际出现在同一地点时，任何项目都会更加成功。也许在不同的阶段可能没有必要，也许视频会议最有帮助，但是当您可以自发地进行个人互动时，情况就不一样*了*。我想说的是，团队的大部分人都在哪里，其他人应该搬到那里，直到项目完成。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-20T01:26:29.850

Scrum 的一大目的是了解人们在做什么，他们计划做什么，以及任何障碍。这可以通过上面提到的 wiki 完成。只要人们每天对 wiki 进行更新，它就具有与站立会议类似的好处：交流、展示团队和个人的进步。

# c# - 包装在命名空间困境中的“site.master”模板中的 C# 扩展方法

> ID：303938
> 
> 赞同：3
> 
> 时间：2008-11-20T00:16:37.430
> 
> 标签：c#, asp.net

问题是，为什么我需要在我的**Site.Master**文件中添加一个“导入”指令才能在没有它的 html 助手工作时获得 Intellisense。

使用没有命名空间的简单 C# 字符串扩展方法 == 没问题。然而，我想把这个扩展放在一个命名空间中，成为一个优秀的程序员。

如果我将它包装在一个**命名空间**中，你必须做几件事。这是我的扩展：

```
namespace MySystemCore
{
    public static class StringExtensions
    {
        public static string F(this string s, params object[] args)
        {
            return string.Format(s, args);
        }
    }
} 
```

所以通过反复试验，我让它工作了，但想分享我的观察结果。希望它可以在将来对其他人有所帮助。

注意：我在**Site.Master中使用扩展方法**

1.  添加“使用 MySystemCore;” 到**Site.Master.cs**文件（代码隐藏文件）

    *   运行时错误，未找到扩展方法
2.  将“ `<add namespace="MySystemCore">`”添加到**web.config**`<namespaces>`中的配置块

     ***   工作，没有智能** 
***   结合#1和#2

    *   工作，没有智能*   将“ `<%@ Import Namespace="MySystemCore" %>`”添加到**Site.Master**文件

    *   工作，智能感知**

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T12:55:07.790

这是 VS 的限制，当您将其添加到**web.config**中的 <namespaces> 时，IntelliSense 不会出现。

但为了完整起见，我将讨论它的原因：

*   方法 1 根本不是正确的方法，因为**using**指令（**Imports**将编译为由**ASP.NET 预处理器****使用**）的范围为编译单元（即单个文件）***   方法 2 运行正常，因为它将**using**指令添加到编译选项中，这会影响应用程序中的所有编译单元。如果 IntelliSense 在这种情况下没有出现，那是因为 VS 不够聪明，无法考虑**web.config**。*   方法3是有效的，就像2一样。方法1与主文件完全无关，它只影响我之前提到的.cs文件。方法 2 就像自动添加 using 到所有 .cs 文件。*   方法 4 有效，因为 VS 知道您在与它正在处理的文件相同的文件中使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-22T19:04:50.213

我同意这有时很烦人。但这一切都与关注点分离有关。您必须学习所有自己的命名空间和 MS 命名空间才能找到正确的扩展方法。

# css - CSS2 中的上下文选择器

> ID：303939
> 
> 赞同：1
> 
> 时间：2008-11-20T00:17:21.330
> 
> 标签：css, syntax, css-selectors

我想知道为什么要在特定类中设置元素的样式，如下所示：

```
.reddish H1 { color: red } 
```

在上下文选择器下的 CSS1 规范中显示为正确语法的示例：

[级联样式表，级别 1](http://www.w3.org/TR/2008/REC-CSS1-20080411/#class-as-selector)

但它没有在 CSS2 规范中作为示例显示：

[级联样式表，第 2 级](http://www.w3.org/TR/2008/REC-CSS2-20080411/selector.html)

至少我找不到它的例子。CSS2 中的语法规则是否发生了变化，还是只是简单地推断为正确的语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T01:57:36.977

该语法是正确的，但该示例可能由于几个原因而发生了变化。

首先，通过描述类的功能来命名类并不是最佳实践。在 的情况下`.reddish h1`，示例 CSS 显示它将被着色为红色。但是，如果在以后的设计更改中`h1`，实际上应该是蓝色的

```
.reddish h1 { color: blue; } 
```

没有什么意义。你应该根据它们在页面上的功能或目的来命名你的类，而不是它们应该代表的样式。

其次，不建议对颜色使用关键字，因为您收到的颜色取决于浏览器的解释。相反，您应该使用十六进制代码“#ff0000”来获得所有浏览器中的准确颜色，而不是“红色”。（红色可能不是最好的例子，但那里有一些奇怪的颜色关键字）。

虽然这些事情都不是那么糟糕，但它们都可以解释为什么这个例子在规范中发生了变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T02:32:34.740

您应该用小写字母（h1，而不是 H1）编写元素。

# oracle - 在 SQL*Plus 中，如何更改提示以显示已连接的用户和数据库？

> ID：303940
> 
> 赞同：9
> 
> 时间：2008-11-20T00:17:21.393
> 
> 标签：oracle, sqlplus

举个例子，展示......

```
USER@SID > 
```

我认为这可能对一些人有帮助，所以我也要回答它！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-20T00:17:42.920

修改您的 $ORACLE_HOME\sqlplus\admin\glogin.sql 脚本 - 添加：

```
set sqlprompt "_user '@' _connect_identifier > " 
```

到文件的末尾。

在 Oracle 10g 中，每次您发出“conn”时，这都会正确更改。对于 10g 之前的客户端，当你执行“conn”时它不会改变，但会保持你第一次连接的用户名/数据库。

您还可以使用 _date 表示当前日期，使用 _privilege 表示已连接用户的权限（例如 SYSDBA）。

参考：

[http://www.acs.ilstu.edu/docs/Oracle/server.101/b12170/whatsnew.htm](http://www.acs.ilstu.edu/docs/Oracle/server.101/b12170/whatsnew.htm)

# c# - C# - 根据泛型类中提供的接口实例化一个类

> ID：303955
> 
> 赞同：2
> 
> 时间：2008-11-20T00:23:08.307
> 
> 标签：c#, generics, instantiation

我有一个通用函数，它将接口作为一种类型，现在在一种情况下，我必须根据接口创建一个新类。我一直在考虑它，解决它的一种方法是使用 IoC，但我希望有另一种方法，因为 IoC 似乎有点矫枉过正。

下面是使用访问者模式的尝试：

```
public class RepositoryManager<T> : IRepositoryManager<T> where T : class, new()
{
    public T GetOrCreate(string id)
    {
        T item = (T)CreateNew(new T(), id);
        return item;
    }
} 
```

如果我得到一个对象而不是接口，那么我可以使用访问者模式来确定要实例化的类，但根据提供的接口，我似乎无法弄清楚这一点。

我的另一个想法是，我是否可以像 or 一样做出 where 声明？

```
public class RepositoryManager<T> : IRepositoryManager<T> where T : class, Iabc or Ixyz, new() 
```

我希望问题很清楚:)

-标记

* * *

谢谢你的回复。

问题是该方法可以分配有许多不同的接口，例如：

RepositoryManager 类：

```
private static IMedicament CreateNew(IMedicament emptyType, string id)
{
    return new Medicament { Id = id };
}
private static IRefund CreateNew(IRefund emptyType, string id)
{
    return new Refund { Id = id };
}

RepositoryManager<Iabc> abcRepository = new RepositoryManager<Iabc>();
RepositoryManager<Ixyz> xyzRepository = new RepositoryManager<Ixyz>();

Iabc abc = abcRepository.GetOrCreate("12345");
Ixyz xyz = xyzRepository.GetOrCreate("12345"); 
```

所以使用`T item = (T)CreateNew(new T(), id);`不起作用，因为我必须告诉它 T 可以是 Iabc 或 Ixyz 类型，但是当我这样做时，我收到以下错误：

以下方法或属性之间的调用不明确：`RepositoryManager<T>.CreateNew(IMedicament, string)`和`RepositoryManager<T>.CreateNew(IRefund, string)`

除了多次复制代码之外，如果我能做到这一点，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T02:24:59.247

为什么这不起作用？

```
public class RepositoryManager<T> : IRepositoryManager<T> where T : Ixyz, new()
{
    public T GetOrCreate(string id)
    {
        T item = (T)CreateNew(new T(), id);
        return item;
    }
} 
```

另一种方法是，如果您不能使用 new() 是传入一个委托来创建对象（或兼容的类型）：

```
public class RepositoryManager<T> : IRepositoryManager<T> where T : Ixyz
{
    private Func<T> _tConstructor;

    public RepositoryManager(Func<T> tConstructor)
    {
      this._tConstructor = tConstructor;
    }

    public T GetOrCreate(string id, )
    {
        T item = (T)CreateNew(this._tConstructor(), id);
        return item;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-20T03:04:34.643

我不确定我是否完全理解这个问题，但我以前使用过类似的东西。

```
public class Repository
{
    public T Create<T>(string id) where T : class
    {
        return Activator.CreateInstance(typeof(T), new[] { id }) as T;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T01:58:06.960

如果我明白你的问题是什么，基本上你想做（在某种意义上）RhinoMocks 所做的事情，除了 RhinoMocks 实际上从接口动态创建一个类，因为你想使用现有的类。

我对代码不够熟悉，不知道 RhinoMocks 是如何实现这一点的，但由于它是开源的，你可能会得到一些想法，但看看它的源代码。

[http://ayende.com/projects/rhino-mocks/downloads.aspx](http://ayende.com/projects/rhino-mocks/downloads.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T19:45:13.407

让 IRefund 和 IMedicament 实现一个都有 Id 属性的共享接口怎么样？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T02:19:01.757

前几天我自己也遇到了这个问题。问题是你不知道构造函数有多少参数。假设不需要，以下代码将起作用。

```
public void Method<T>()
{
  Type type = typeof(T);

  T newObject = (T)type.GetConstructor(new System.Type[] { }).Invoke(new object[] { });
} 
```

该示例使用反射。如果您需要参数，则可以将对象放入代码中创建的数组中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-25T15:27:59.847

也许以下内容对您有用？1）创建一个字典，其中 type 是您的接口（T 参数），object 是可以创建的对象的虚拟实例，2）让您的虚拟对象成为实现 T 的新对象的工厂。

您的 RepositoryManager 只需要使用支持的接口-对象对初始化字典，其中多个接口可以映射到同一个对象（如果需要）。

# jquery - 选择哪个 href 以某个字符串结尾

> ID：303956
> 
> 赞同：688
> 
> 时间：2008-11-20T00:23:58.913
> 
> 标签：jquery, string, anchor, href

是否可以使用[jQuery](https://jquery.com/)选择所有`<a>`href 以“ABC”结尾的链接？

例如，如果我想找到这个链接`<a href="http://server/page.aspx?id=ABC">`

* * *

## 回答 #1

> 赞同：1603
> 
> 时间：2008-11-20T00:26:13.230

```
 $('a[href$="ABC"]')... 
```

选择器文档可以在[http://docs.jquery.com/Selectors找到](http://docs.jquery.com/Selectors)

对于属性：

```
= is exactly equal
!= is not equal
^= is starts with
$= is ends with
*= is contains
~= is contains word
|= is starts with prefix (i.e., |= "prefix" matches "prefix-...") 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-06-24T21:01:47.333

```
$('a[href$="ABC"]:first').attr('title'); 
```

这将返回 URL 以“ABC”结尾的第一个链接的标题。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-02-29T08:27:55.580

```
$("a[href*='id=ABC']").addClass('active_jquery_menu'); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-20T14:53:27.400

```
$("a[href*=ABC]").addClass('selected'); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-05-21T07:57:07.563

万一您不想导入像 jQuery 这样的大库来完成如此琐碎的事情，您可以使用内置方法`querySelectorAll`。几乎所有用于 jQuery 的选择器字符串也适用于 DOM 方法：

```
const anchors = document.querySelectorAll('a[href$="ABC"]'); 
```

或者，如果您知道只有一个匹配元素：

```
const anchor = document.querySelector('a[href$="ABC"]'); 
```

如果您要搜索的值是字母数字，您通常可以省略属性值周围的引号，例如，在这里，您也可以使用

```
a[href$=ABC] 
```

但报价更灵活，[通常更可靠](https://mathiasbynens.be/notes/unquoted-attribute-values)。

# c++ - 当 C++ 流打开失败时，您可以获得特定的错误情况吗？

> ID：303966
> 
> 赞同：14
> 
> 时间：2008-11-20T00:28:12.930
> 
> 标签：c++, stream

当 C++ 流打开失败时，有什么方法可以获得特定的错误条件？也就是说，它是否因为文件不存在而失败，或者权限错误等等。基本上我正在寻找与普通 C 中 fopen() 的 errno 等效的功能。

GCC 似乎正确设置了 errno，但这似乎不是 C++ 标准所要求的，我无法确定这是否只是他们实现流的方式的产物，还是故意的特性（因此我不知道它是否会跨版本持续存在）。

有没有办法可靠地获取这些信息，无论是在标准 C++ 中还是在一个或多个主要编译器中非偶然？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T03:37:05.967

出于一般原因，您可以查看 ios 标志（badbit、eofbit、failbit、goodbit）。使用 ios::bad()、ios::fail()、ios::eof() 或 ios::good() 测试将更容易。也可以使用 ios::exceptions() 将流设置为在错误时生成异常。

正如您为 GCC 指出的那样，在某些实现中可能会提供详细的 I/O 错误报告。对于不同的编译器，您可能不得不依赖此行为。如果有机会使用多个编译器，请确保测试并可能包含预处理器语句以检查当前编译器等。
据我所知，它讨论的唯一其他地方是[提议的 TR2 添加](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2655.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T01:37:27.800

在 Visual Studio fopen 等中设置最后一个错误代码值。可以使用[GetLastError()](http://msdn.microsoft.com/en-us/library/ms679360(VS.85).aspx)检索它。结果将是[这些](http://msdn.microsoft.com/en-us/library/ms681381(VS.85).aspx)值之一。

# xml - 如何使用 XPath 在 XML 文档中选择多组属性？

> ID：303970
> 
> 赞同：8
> 
> 时间：2008-11-20T00:30:14.503
> 
> 标签：xml, xpath

我在构造单个 XPath 语句以返回两组不同的属性时遇到问题。

例如下面的 XML 文档：

```
<root>
 <line name="one" alpha="a1" beta="b1"/>
 <line name="two" alpha="a2" beta="b2"/>
 <line name="three" alpha="a3" beta="b3"/>
</root> 
```

如果我使用以下 XPath 语句：

```
//@alpha 
```

它产生以下属性集：

```
alpha="a1"
alpha="a2"
alpha="a3" 
```

我使用什么语句来产生以下属性集：

```
alpha="a1"
alpha="a2"
alpha="a3"
beta="b1"
beta="b2"
beta="b3" 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-20T00:41:05.977

通过`|`在 XPath 表达式中使用运算符，您可以选择多个路径：

```
//@alpha | //@beta 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-20T00:43:12.573

```
//@*[name()='alpha' or name()='beta'] 
```

# c# - 在 Linq 中，检查子关系？

> ID：303987
> 
> 赞同：1
> 
> 时间：2008-11-20T00:35:44.523
> 
> 标签：c#, linq

Linq 中是否有任何方法可以检查其子代中是否存在父代的记录？

我有一个与其他 12 个表有外键关系的表。我要做的就是查看这些子表中的任何记录是否依赖于父表，因此我可以删除它而不会导致 FK 约束错误。

多谢你们。

我最终只是制作了一个扩展类来检查每一个......耗时但完成了工作......如果可能的话，我仍然希望得到意见

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T01:01:31.553

您可以暴力破解它并将删除包装在 try-catch 中。只要所有的删除都是同一个上下文的一部分，如果一个孩子由于 FK 关系而不能被删除，它将回滚该块中的所有删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T01:29:42.837

这可能有点笨拙，您必须遍历您的子表并将它们全部合并，但这是一个开始......

```
 ParentChildrenDataContext context = new ParentChildrenDataContext();

        var child1Ids = from c in context.ChildType1s
                        select c.ParentId;

        var child2Ids = from c in context.ChildType2s
                        select c.ParentId;

        var allChildren = child1Ids.Union(child2Ids);

        var myParents = from p in context.Parents
                        where allChildren.Contains<int?>(p.ParentId)
                        select p;

        return myParents.Count(); 
```

# mysql - 在mysql中记录所有查询

> ID：303994
> 
> 赞同：333
> 
> 时间：2008-11-20T00:39:01.583
> 
> 标签：mysql, logging

我可以在我的 mysql 数据库上打开审计日志吗？

我基本上想监视一个小时的所有查询，并将日志转储到文件中。

* * *

## 回答 #1

> 赞同：258
> 
> 时间：2013-01-18T17:03:35.877

（**注意**：对于 mysql-5.6+，这不起作用。如果[向下滚动](https://stackoverflow.com/questions/303994/log-all-queries-in-mysql#answer-25080306)或[单击此处](https://stackoverflow.com/a/25080306/535759)，有一个适用于 mysql-5.6+ 的解决方案。）

如果您不想或无法重新启动 MySQL 服务器，您可以在正在运行的服务器上进行如下操作：

*   `mysql`在数据库上创建日志表

```
 CREATE TABLE `slow_log` (
   `start_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP 
                          ON UPDATE CURRENT_TIMESTAMP,
   `user_host` mediumtext NOT NULL,
   `query_time` time NOT NULL,
   `lock_time` time NOT NULL,
   `rows_sent` int(11) NOT NULL,
   `rows_examined` int(11) NOT NULL,
   `db` varchar(512) NOT NULL,
   `last_insert_id` int(11) NOT NULL,
   `insert_id` int(11) NOT NULL,
   `server_id` int(10) unsigned NOT NULL,
   `sql_text` mediumtext NOT NULL,
   `thread_id` bigint(21) unsigned NOT NULL
  ) ENGINE=CSV DEFAULT CHARSET=utf8 COMMENT='Slow log' 
```

```
 CREATE TABLE `general_log` (
   `event_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
                          ON UPDATE CURRENT_TIMESTAMP,
   `user_host` mediumtext NOT NULL,
   `thread_id` bigint(21) unsigned NOT NULL,
   `server_id` int(10) unsigned NOT NULL,
   `command_type` varchar(64) NOT NULL,
   `argument` mediumtext NOT NULL
  ) ENGINE=CSV DEFAULT CHARSET=utf8 COMMENT='General log' 
```

*   在数据库上启用查询日志记录

```
SET global general_log = 1;
SET global log_output = 'table'; 
```

*   查看日志

```
select * from mysql.general_log 
```

*   禁用数据库上的查询日志记录

```
SET global general_log = 0; 
```

* * *

## 回答 #2

> 赞同：250
> 
> 时间：2013-12-10T04:16:40.620

除了我在这里遇到的之外，运行以下是将查询转储到日志文件而不重新启动的最简单方法

```
SET global log_output = 'FILE';
SET global general_log_file='/Applications/MAMP/logs/mysql_general.log';
SET global general_log = 1; 
```

可以关闭

```
SET global general_log = 0; 
```

* * *

## 回答 #3

> 赞同：177
> 
> 时间：2008-11-20T00:45:05.360

更新：不再适用于 MYSQL 5.6+

使用 --log 选项启动 mysql：

```
mysqld --log=log_file_name 
```

或将以下内容放入您的`my.cnf`文件中：

```
log = log_file_name 
```

任何一个都会将所有查询记录到 log_file_name。

您还可以使用`--log-slow-queries`选项而不是`--log`. 默认情况下，需要 10 秒或更长时间的查询被认为很慢，您可以通过设置`long_query_time`查询在记录之前必须执行的秒数来更改此设置。

* * *

## 回答 #4

> 赞同：156
> 
> 时间：2014-08-01T12:29:39.313

最佳答案在 mysql 5.6+ 中不起作用。改用这个：

```
[mysqld]
general_log = on
general_log_file=/usr/log/general.log 
```

在你的 my.cnf / my.ini 文件中

**Ubuntu/Debian**：/etc/mysql/my.cnf
**Windows**：c:\ProgramData\MySQL\MySQL Server 5.x
**wamp**：c:\wamp\bin\mysql\mysqlx.yz\my.ini
**xampp**：c:\xampp \mysql\bin\my.ini。

* * *

## 回答 #5

> 赞同：50
> 
> 时间：2017-04-06T10:35:35.767

为表启用日志

```
mysql> SET GLOBAL general_log = 'ON';
mysql> SET GLOBAL log_output = 'table'; 
```

通过选择查询查看日志

```
SELECT * FROM mysql.general_log 
```

如果查询太多，请截断表：

```
TRUNCATE table mysql.general_log; 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2016-11-17T18:04:04.713

无需重新启动即可启用 MySQL 常规查询日志的快速方法。

```
mysql> SET GLOBAL general_log_file = '/var/www/nanhe/log/all.log';
mysql> SET GLOBAL general_log = 'ON'; 
```

*我已经通过自制软件安装了 mysql，mysql 版本：mysql Ver 14.14 Distrib 5.7.15, for osx10.11 (x86_64) using EditLine wrapper*

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-05-09T22:05:44.543

作为记录，general_log 和 slow_log 是在 5.1.6 中引入的：

[http://dev.mysql.com/doc/refman/5.1/en/log-destinations.html](http://dev.mysql.com/doc/refman/5.1/en/log-destinations.html)

> 5.2.1。选择通用查询和慢查询日志输出目标
> 
> 从 MySQL 5.1.6 开始，如果启用了这些日志，MySQL Server 可以灵活控制输出到一般查询日志和慢速查询日志的目的地。日志条目的可能目的地是日志文件或 mysql 数据库中的 general_log 和 slow_log 表

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-12-10T17:46:54.930

操作系统/mysql版本：

```
$ uname -a
Darwin Raphaels-MacBook-Pro.local 15.6.0 Darwin Kernel Version 15.6.0: Thu Jun 21 20:07:40 PDT 2018; root:xnu-3248.73.11~1/RELEASE_X86_64 x86_64

$ mysql --version
/usr/local/mysql/bin/mysql  Ver 14.14 Distrib 5.6.23, for osx10.8 (x86_64) using  EditLine wrapper 
```

添加日志记录（例如，我认为这不是`/var/log/...`Mac OS 上的最佳路径，但可行：

```
sudo vi ./usr/local/mysql-5.6.23-osx10.8-x86_64/my.cnf

[mysqld]
general_log = on
general_log_file=/var/log/mysql/mysqld_general.log 
```

重启Mysql

结果：

```
$ sudo tail -f /var/log/mysql/mysqld_general.log
181210  9:41:04    21 Connect   root@localhost on employees
           21 Query /* mysql-connector-java-5.1.47 ( Revision: fe1903b1ecb4a96a917f7ed3190d80c049b1de29 ) */SELECT  @@session.auto_increment_increment AS auto_increment_increment, @@character_set_client AS character_set_client, @@character_set_connection AS character_set_connection, @@character_set_results AS character_set_results, @@character_set_server AS character_set_server, @@collation_server AS collation_server, @@collation_connection AS collation_connection, @@init_connect AS init_connect, @@interactive_timeout AS interactive_timeout, @@license AS license, @@lower_case_table_names AS lower_case_table_names, @@max_allowed_packet AS max_allowed_packet, @@net_buffer_length AS net_buffer_length, @@net_write_timeout AS net_write_timeout, @@query_cache_size AS query_cache_size, @@query_cache_type AS query_cache_type, @@sql_mode AS sql_mode, @@system_time_zone AS system_time_zone, @@time_zone AS time_zone, @@tx_isolation AS transaction_isolation, @@wait_timeout AS wait_timeout
           21 Query SET NAMES latin1
           21 Query SET character_set_results = NULL
           21 Query SET autocommit=1
           21 Query SELECT USER()
           21 Query SELECT USER()
181210  9:41:10    21 Query show tables
181210  9:41:25    21 Query select count(*) from current_dept_emp 
```*****************``