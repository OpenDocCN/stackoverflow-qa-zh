# StackOverflow 问答 12484000-12484999

# python - 检查时间是否在一分钟内的最佳方法是什么？

> ID：12484003
> 
> 赞同：6
> 
> 时间：2012-09-18T19:51:13.353
> 
> 标签：python

我想编写一个简单的python脚本，它将检查它是否在给定小时/分钟之前2分钟，然后每天或在给定时间的给定日期调用我的函数。

该脚本将在 cronjob 中每分钟运行一次。

所以执行myfunction()的两种情况：

每天
10:55 2012 年 9 月 28 日 10:55

但是我无法使用日期时间确定它是在给定小时/分钟之前 2 分钟的时间。另外，如何确定每天与仅在某一天？

```
mydate = datetime(2012, 09,28, 10,55)
check = mydate - datetime.now()    # gives you a timedelta

if check < datetime.timedelta(minutes=2):
     run_myfunction() 
```

以上查看是否在 2 分钟内，如果是，则运行 myfunction()。上面代码的问题是，如果 mydate 已经过去，myfunction() 仍然会运行。此外，这需要指定特定日期。如何允许每天而不是 2012 年 9 月 28 日检查？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T19:56:29.947

```
now = datetime.now()
mystart = now.replace(hours=10, minutes=55, seconds=0)
myend = mystart + timedelta(minutes=2)
if mystart <= mydate < myend:
    # do your stuff 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:00:03.397

它可能有点骇人听闻，但您可以使用它`.total_seconds()`来构建一个范围：

```
from datetime import datetime, timedelta

then = datetime(2012, 9, 18, 16, 5)
now = datetime.now()
delta = timedelta(minutes=10)

if 0 < (then - now).total_seconds() < delta.total_seconds():
    # ... 
```

这样，如果`then - now`是一个负数`timedelta`，`total_seconds()`将返回一个负数并使你的条件`False`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:09:37.643

对于日常部分，您可以使用

```
reference = datetime.datetime(2012,9,18,23,55,00)
now = datetime.datetime.now()
today = reference.replace(year=now.year,month=now.month,day=now.day) 
```

对于时差：

```
delta = (now-today)
lapse = delta.days * 86400 + delta.seconds
if abs(lapse) <= 2*60:
    run_function() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T19:57:03.027

像这样更改您的代码

```
mydate = datetime(2012, 09,2, 10,55)
current_date = datetime.now()
check = mydate - current_date    # gives you a timedelta

if mydate > current_date and check < datetime.timedelta(minutes=2):
     run_myfunction() 
```

# javascript - 使用 Jquery 更改 iframe 中的 div

> ID：12484007
> 
> 赞同：2
> 
> 时间：2012-09-18T19:51:33.680
> 
> 标签：javascript, jquery, html, iframe

我有一个“页面 A”。在这个页面中是一个`iframe`显示“页面B”的页面。

```
<iframe id="iframeD" src="https://trello.com" width="600" height="600">
  <p>Your browser does not support iframes.</p>
</iframe>
<div id="cTitle">Hello</div>​ 
```

（有关工作示例，请参见以下小提琴：http: [//jsfiddle.net/noscirre/yYkUN/](http://jsfiddle.net/noscirre/yYkUN/)）

“页面 B”包含一个`div`id `landingHeader`。如何在“Page A”上创建一个 jQuery 调用，将其替换`div`为另一个`div`（其内容在“Page A”上找到）id `cTitle`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T20:05:55.540

```
 $("iframe").contents().find("#dTitle").attr('id','cTitle').html($('#cTitle').html()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T21:06:18.910

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T19:55:39.390

仅当 iframe 域与父域相同时，您才能进行更改。如果是这样，那么您可以通过使用 contentWindow 属性从父窗口访问 iframe 来更改它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T19:58:59.043

尝试这个：

```
 $("#iFrame").contents().find("#dTitle").attr('id','cTitle'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T20:23:29.173

我认为 iFrame 可能是一个问题，除非它们共享相同的父 DOM。然而，无论如何，只是为了好玩，我为你启动了这个快速简单的 jQuery 插件，它可以提供帮助。

> 插件*更新* [返回替换比旧元素更有意义，因此更改]

```
$(function() {
    if (!$.replaceWith) {
        $.extend({
            replaceWith: function(ele, newEle) {
                ele.each(function(i) { $(this).before(newEle).remove(); });
                return newEle;
            }
        });
        $.fn.extend({
            replaceWith: function(newEle) { return $.replaceWith($(this), newEle); }
        });
    }
}); 
```

> 简单使用

```
$("#someElementID").replaceWith($("#anotherElementID"));
// or
$.replaceWith($("#someElementID"), $("#anotherElementID")); 
```

> 例如：

```
$("#dTitle").replaceWith($("#cTitle")); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-18T19:54:26.923

去看看这篇文章[用jQuery改变元素的ID](https://stackoverflow.com/questions/347798/changing-an-elements-id-with-jquery)

```
$(this).attr("id","newId"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-18T19:54:50.327

如果您只想更改内容，请执行以下操作：

```
$("div#bTitle").html($("div#cTitle").html()); 
```

# jquery - 使用 jQuery 查找与焦点元素相关的隐藏元素

> ID：12484012
> 
> 赞同：0
> 
> 时间：2012-09-18T19:52:10.780
> 
> 标签：jquery, ajax, clone, hidden

我有一个用于 Ajax 调用的 php 页面。`<ul>`它以 a和`<li>`items的形式产生输出。这些项目被用作原始页面上输入字段的自动完成。我遇到的问题是找到一种优雅的方法来更新其他字段，其中一些是隐藏的，在用户克隆它们之后，基于此 Ajax 调用和后续 sql 查询的结果。更喜欢使用 jQuery，我相信这是可能的。我只是找不到简单的解决方案。查看我目前正在使用的所有 next().next().next()。丑陋的！

首先是php页面：

```
<?PHP
include "dbconnect.php";

$partialSection=$_POST['partialSection'];
$school_id=$_POST['school_id'];

$sql="select course_section_code,course_name,course_credit_hours,school_id,ext_course_id from ext_courses 
 where course_section_code like '%$partialSection%' and school_id = $school_id";
$result = db_query($sql); 
    if (mysql_num_rows($result)==0){
        echo "<DIV>No external courses match your query for $partialSection at $school_id. Would you like to enter a new course? <button onclick='new_section()'>Yes</button></DIV>";
    }
    $output="<ul>";
    while ($record = get_record($result))
        {
            $section=$record['course_section_code'];
            $course_title=$record['course_name'];
            $credits=$record['course_credit_hours'];
            $school_id=$record['school_id'];
            $ext_course_id=$record['ext_course_id'];
            $output.="<li class=resultcss onmouseover='this.style.color=\"63b8ee\";this.style.backgroundColor=\"FFFFFF\"' onmouseout='this.style.color=\"FFFFFF\";this.style.backgroundColor=\"63b8ee\"' onclick='$(\".popup\").hide();$(\"*:focus\").val(\"".$section."\");$(\"*:focus\").next().next().next().val(\"".$course_title."\");$(\"*:focus\").next().next().next().next().next().val(\"".$credits."\");enter_data.ext_course_id0.value=\"".$ext_course_id."\"'>".$section."</li>";

        }
        $output.="</ul>";
    echo $output;
?> 
```

好的，现在这是表单的 HTML：

```
<div class="cloneMe">
            <div>

                <label for="course_section0" class="">Section: <span class="requiredField">*</span></label>
                <input type="text" class="cinputs needsPopup" name="course_section[]" id="course_section0" size="8" onfocus="check_contents();" ONKEYUP="get_section(this.value,$('#school_id').val());" autocomplete="off">&nbsp;
                <input type="hidden" class="" name="ext_course_id[]" id="ext_course_id0">
                <label for="course_name0" class="">Name: <span class="requiredField">*</span></label>
                <input type="text" class="cinputs" name="course_name[]" id="course_name0" size="30">&nbsp;
                <label for="course_credits0" class="">Credits: <span class="requiredField">*</span></label>
                <input type="text" class="cinputs" name="course_credits[]" id="course_credits0" size="3">&nbsp;
                <label for="course_grade0" class="">Grade: <span class="requiredField">*</span></label>
                <select class="cinputs" name="course_grade[]" id="course_grade0">
                    <option>Grade:</option>
                    <option>A</option>
                    <option>A-</option>
                    <option>B+</option>
                    <option>B</option>
                    <option>B-</option>
                    <option>C+</option>
                    <option>C</option>
                    <option>C-</option>
                    <option>D+</option>
                    <option>D</option>
                    <option>D-</option>
                    <option>F</option>
                    <option>P</option>
                    <option>CR</option>
                    <option>NC</option>
                    <option>IP</option>
                    <option>I</option>

                </select>&nbsp;
                <label for="hours_awarded0" class="">Hours Awarded: <span class="requiredField">*</span></label>
                <input type="text" class="cinputs" name="hours_awarded[]" id="hours_awarded0" size="3">&nbsp;
                <label for="baker_equiv0" class="">Baker Equivalent: <span class="requiredField">*</span></label>     
                <input type="text" class="cinputs needsPopup" name="baker_equiv[]" id="baker_equiv0" size="8" ONKEYUP="get_equiv(this.value);">&nbsp;<input type="hidden" class="" name="baker_equiv_id[]" id="baker_equiv_id0">
                 <label for="quest0" class="">Quest: <span class="requiredField">*</span></label>
                <input type="text" class="cinputs" name="quest[]" id="quest0" size="3">&nbsp;
                <button type="button" class="clone">Add Course</button>
                    <button type="button" class="remove">Remove</button> 
            </div> 
```

链接在红色括号中显示克隆的表格。

[http://www.rp-software.com/Screenshot.JPG](http://www.rp-software.com/Screenshot.JPG)

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:37:29.930

`li`首先，考虑将它们移动到单独的 css 和 javascript 文件中，而不是为每个输出每个样式和行为。例如，您的`onmouseover`and`onmouseout`可以被悬停规则替换：

```
.resultcss {
    color:#FFFFFF;
    background-color:#63b8ee;
}

.resultcss:hover {
    color:#63b8ee;
    background-color:#FFFFFF;
} 
```

对于您的 php 脚本在 中插入的值`li`，您可以使用 HTML5`data`属性。如果克隆它，数据将被保留：

```
$output.="<li class='resultcss' data-section='".$section."' data-title='".$course_title."' data-credits='".$credits."' data-id='".$ext_course_id."'>".$section."</li>"; 
```

对于`onclick`回调，请使用 jQuery 的[`on`](http://api.jquery.com/on/)函数，该函数也适用于当前和未来的元素（包括克隆的元素）：

```
$('body').on('click', '.resultcss', function(e) {
    var data = $(this).data();
    $(".popup").hide();
    $("*:focus").val(data.section)
        .next().next().next().val(data.title)
        .next().next().val(data.credits);
    enter_data.ext_course_id0.value = data.id;
}); 
```

请注意，我仍然使用`next`. 如果你真的想避免它，你可以在你的 html 中使用额外的类：

```
<input type="text" class="cinputs course_title" name="course_name[]" id="course_name0" size="30">&nbsp;
<input type="text" class="cinputs course_credits" name="course_credits[]" id="course_credits0" size="3">&nbsp; 
```

`find`然后使用or引用它`children`（使用`end`返回之前的上下文）：

```
 $("*:focus").val(data.section)
        .find('.course_title').val(data.title).end()
        .find('.couse_credits').val(data.credits); 
```

# java - 如何标记中文文档

> ID：12484019
> 
> 赞同：4
> 
> 时间：2012-09-18T19:52:34.637
> 
> 标签：java, tokenize

我将获得用中文编写的文档，我必须对其进行标记并将其保存在数据库表中。我正在尝试 Lucene 的 CJKBigramFilter，但它所做的只是将 2 个字符结合在一起，其含义与文档中的含义不同。假设这是文件“Hello My name is Pradeep”中的一行，在中国传统中是“你好我的名字是普拉迪普”。当我对其进行标记时，它会转换为下面的 2 个字母单词。你好 - 你好名字 - 名字好我 - Well I 字是 - 字是我的 - 我的拉迪 - Radi 是普 - 是标准普尔普拉 - 普拉的名字 - 以迪普的名义 - 迪普。我想要的只是将其转换为相同的英文翻译。我正在为此使用 Lucene ...如果您有任何其他有利的开源资源，请指导我。提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T06:17:04.540

虽然可能为时已晚，但您可以尝试使用在线 API 的 U-Tokenizer，它是免费提供的。见[http://tokenizer.tool.uniwits.com/](http://tokenizer.tool.uniwits.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-23T17:26:37.570

如果你想要一个完整的 NLP 解析器，请查看[http://nlp.stanford.edu](http://nlp.stanford.edu)

如果你想要一个简单的、一次性的中文解决方案，这就是我使用的。

首先将中文字典加载到Trie（Prefix-Tree）中以减少内存占用。然后，我一次浏览一个字符的句子，观察字典中存在的枯萎子字符串。如果他们这样做了，我会将其解析为令牌。该算法可能会大大改进，但这对我很有帮助。:)

```
public class ChineseWordTokenizer implements WordTokenizer {

    private static final int MAX_MISSES = 6;

    // example implementation: http://www.kennycason.com/posts/2012-03-20-java-trie-prefix-tree.html
    private StringTrie library;

    private boolean loadTraditional;

    public ChineseWordTokenizer() {
        this(true);
    }

    public ChineseWordTokenizer(boolean loadTraditional) {
        loadLibrary();
        this.loadTraditional = loadTraditional;
    }

    @Override
    public String[] parse(String sentence) {
        final List<String> words = new ArrayList<>();
        String word;
        for (int i = 0; i < sentence.length(); i++) {
            int len = 1;
            boolean loop = false;
            int misses = 0;
            int lastCorrectLen = 1;
            boolean somethingFound = false;
            do {
                word = sentence.substring(i, i + len);
                if (library.contains(word)) {
                    somethingFound = true;
                    lastCorrectLen = len;
                    loop = true;
                } else {
                    misses++;
                    loop = misses < MAX_MISSES;
                }
                len++;
                if(i + len > sentence.length()) {;
                    loop = false;
                }        
            } while (loop);

            if(somethingFound) {
                word = sentence.substring(i, i + lastCorrectLen);
                if (StringUtils.isNotBlank(word)) {
                    words.add(word);
                    i += lastCorrectLen - 1;
                }
            }
        }
        return words.toArray(new String[words.size()]);
    }

    private void loadLibrary() {
        library = new StringTrie();
        library.loadFile("classify/nlp/dict/chinese_simple.list");
        if(loadTraditional) {
            library.loadFile("classify/nlp/dict/chinese_traditional.list");
        }
    }

} 
```

这是一个单元测试

```
public class TestChineseWordTokenizer {

    @Test
    public void test() {
        long time = System.currentTimeMillis();
        WordTokenizer tokenizer = new ChineseWordTokenizer();
        System.out.println("load time: " + (System.currentTimeMillis() - time) + " ms");

        String[] words = tokenizer.tokenize("弹道导弹");
        print(words);
        assertEquals(1, words.length);

        words = tokenizer.tokenize("美国人的文化.dog");
        print(words);
        assertEquals(3, words.length);

        words = tokenizer.tokenize("我是美国人");
        print(words);
        assertEquals(3, words.length);

        words = tokenizer.tokenize("政府依照法律行使执法权，如果超出法律赋予的权限范围，就是“滥用职权”；如果没有完全行使执法权，就是“不作为”。两者都是政府的错误。");
        print(words);

        words = tokenizer.tokenize("国家都有自己的政府。政府是税收的主体，可以实现福利的合理利用。");
        print(words);
    }

    private void print(String[] words) {
        System.out.print("[ ");
        for(String word : words) {
            System.out.print(word + " ");
        }
        System.out.println("]");
    }
} 
```

这是结果

```
Load Complete: 102135 Entries
load time: 236 ms
[ 弹道导弹 ]
[ 美国人 的 文化 ]
[ 我 是 美国人 ]
[ 政府 依照 法律 行使 执法 权 如果 超出 法律 赋予 的 权限 范围 就是 滥用职权 如果 没有 完全 行使 执法 权 就是 不 作为 两者 都 是 政府 的 错误 ]
[ 国家 都 有 自己 的 政府 政府 是 税收 的 主体 可以 实现 福利 的 合理 利用 ] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-19T22:39:35.120

试试这个资源，它是一个使用 CC-CEDICT 的中文分词器

[https://github.com/yishn/chinese-tokenizer](https://github.com/yishn/chinese-tokenizer)

# database - Drupal 6 连接到数据库

> ID：12484029
> 
> 赞同：2
> 
> 时间：2012-09-18T19:53:39.910
> 
> 标签：database, drupal

Drupal 6 如何连接到数据库？我习惯 Drupal 7 有一个 setting.php 文件，要求输入数据库名称、用户和密码，但 Drupal 6 setting.php 文件完全不同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T20:14:40.410

您需要`$db_url`在站点的 settings.php 文件中设置变量。

例子

```
// mysql://username[:password]@hostname[:port]/databasename
$db_url = 'mysql://root@localhost/testdrupal'; 
```

# ruby-on-rails - 添加了使用 to_param 周期的 Rails 路由 - 复数错误

> ID：12484030
> 
> 赞同：0
> 
> 时间：2012-09-18T19:53:39.763
> 
> 标签：ruby-on-rails, routing

我创建了一个模型，我在上面覆盖了主键：

`set_primary_key :SONumber`

我也在使用`to_param`

```
def to_param
    self.SONumber
end 
```

我对这个模型的路线如下：

```
resources :sales_orders 
```

在链接显示单个记录时的视图中：

```
=link_to 'Open', sales_orders_path(so) 
```

它正在生成带有句点而不是斜杠的链接，即：

```
.../sales_orders.1234  instead of .../sales_orders/1234 
```

我在这里想念什么？我做错什么了吗？

编辑：从我的路线：

```
sales_order GET    /sales_orders/:id(.:format)       sales_orders#show 
```

编辑2：阅读此[链接](https://stackoverflow.com/questions/5674116/path-helpers-generate-paths-with-dots-instead-of-slashes)，我只能假设我有一个复数错误，但是，如果我将视图切换到：

```
=link_to 'Open', sales_order_path(so) 
```

我没有找到路线匹配...如果有更好的方法，我宁愿不手动定义路线

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:53:46.533

试试这个：

```
= link_to 'Open', sale_order_path(so) # sale instead of sales 
```

`sales_order_path(so)``so.SONumber`使用as 格式生成索引操作的路径。

看看这个 Rails 指南： http: [//guides.rubyonrails.org/routing.html#paths-and-urls](http://guides.rubyonrails.org/routing.html#paths-and-urls)

# php - 返回字符串与整数？

> ID：12484031
> 
> 赞同：0
> 
> 时间：2012-09-18T19:53:44.147
> 
> 标签：php, function, return, return-value

假设我有一个`checkTemperature($temp)`可以返回三种不同可能性的函数：

1.  太热
2.  好的
3.  太冷

你会返回整数，比如`-1, 0, 1`or `1, 2, 3`(etc..) 还是字符串，比如上面的？

什么被认为是最佳实践？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-18T19:57:45.533

您通常会使用枚举，但 PHP 并不直接支持枚举构造。但是，我们当然可以效仿他们。

```
class Temperatures
{
    const TooHot = 1;
    const OK = 2;
    const TooCold = 3;
} 
```

然后你可以做

```
return Temperatures::TooHot; 
```

并比较

```
if ($retval == Temperatures::OK) 
```

只要它们不同，您为变量分配的值并不重要。您可以根据您的应用程序和上下文将这些值用于有趣的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T20:00:16.173

-1 通常是对我遇到的约定中的“未找到”或无效阅读的引用。字符串很容易理解，并且有许多方法可以将字符串分配给数值。例如太冷=-100，太热=100，刚刚好=75。

我会在这个上投票字符串而不是整数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T19:59:22.333

就个人而言，我倾向于在有意义的地方使用数字和可比性。向类中添加常量以避免“幻数”效应。

```
<?php

if ($result == 2) { ... }
// vs 
if ($result == Temp::TOO_HOT) { ... }

// Though can result in some odd code
if ($result > Temp::OK) { echo "that's bad"; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T20:12:06.133

为了减少开销，您可以使用`#define`

```
define('TEMP_HOT',  1);
define('TEMP_OK',   2);
define('TEMP_COLD', 3); 
```

如果你已经这样做了，那么使用一个类才有意义。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-18T19:58:31.447

在这种情况下没有“最佳实践”。在某些情况下，返回一个字符串会更有意义，而其他时候一个整数会完成这项工作

# c++ - 使用 C++ 将某些行读入二维数组

> ID：12484034
> 
> 赞同：2
> 
> 时间：2012-09-18T19:54:00.797
> 
> 标签：c++, arrays, file, stream

好的，我正在经历一些编程练习，但遇到了一个涉及读取文件的练习。我需要做的是将一组线读入一个二维数组，线的长度和线的数量会有所不同，但我事先知道。

所以文件的格式如下：

> 有两个数字，`n`和`m`，其中`1 <= n, m <= 20`，

现在进入格式如下的文件：（`n`两个数字之间有一个空格）`m``n m`

现在在那条线之后有`n`几行整数，`m`每行都有元素。因此，例如输入是这样的：（数字在范围内）`0 <= # <= 50`

```
5 3
2 2 15
6 3 12
7 3 2
2 3 5
3 6 2 
```

所以从这个程序知道有 15 个元素，并且可以像这样保存在一个数组中： `int foo[5][3]`

那么我如何读取这样的文件呢？并且，最后，该文件具有一组接一组的输入。所以它可能会这样：（2, 2 是第一组的信息，3, 4 是第二组输入的信息）

```
2 2
9 2
6 5
3 4
1 2 29
9 6 18
7 50 12 
```

如何从 C++ 文件中读取这种输入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:13:20.133

首先，您应该有某种矩阵/网格/2darray 类

```
//A matrix class that holds objects of type T
template<class T>
struct matrix {
    //a constructor telling the matrix how big it is
    matrix(unsigned columns, unsigned rows) :c(columns), data(columns*rows) {}
    //construct a matrix from a stream
    matrix(std::ifstream& stream) {
        unsigned r;
        stream >> c >> r;
        data.resize(c*r);
        stream >> *this;
        if (!stream) throw std::runtime_error("invalid format in stream");
    }
    //get the number of rows or columns
    unsigned columns() const {return c;}
    unsigned rows() const {return data.size()/c;}
    //an accessor to get the element at position (column,row)
    T& operator()(unsigned col, unsigned row) 
    {assert(col<c && row*c+col<data.size()); return data[data+row*c+col];}
protected:
    unsigned c; //number of columns
    std::vector<T> data; //This holds the actual data
}; 
```

然后你只需重载 operator<<

```
template<class T>
std::istream& operator>>(std::istream& stream, matrix<T>& obj) {
    //for each row
    for(int r=0; r<obj.rows(); ++r) {
        //for each element in that row
        for(int c=0; c<obj.cols(); ++c)
            //read that element from the stream
            stream >> obj(c, r);  //here's the magic line!
    }
    //as always, return the stream
    return stream;
} 
```

非常坦率的。

```
int main() {
   std::ifstream input("input.txt");
   int r, c;
   while(input >> c >> r) { //if there's another line
       matrix<char> other(c, r); //make a matrix
       if (!(input >> other)) //if we fail to read in the matrix
           break;  //stop
       //dostuff
   }
   //if we get here: invalid input or all done 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:17:09.320

您需要一种在运行时动态分配内存的方法，因为这是您知道需要从文件中读取多少数据的时候。有（至少）两种方法可以做到这一点：

1.  按照@MooingDuck 的建议使用 std:vector

2.  `new`使用or运算符动态分配您的数组`new[]`。您还需要确保使用`delete`or`delete[]`运算符释放任何内存。

# matlab - matlab中的数据重排

> ID：12484035
> 
> 赞同：0
> 
> 时间：2012-09-18T19:54:17.207
> 
> 标签：matlab, structure

我有以下代码

```
[X1,Y1]=meshgrid(1:5,1:5);
z=X1.^2+Y1.^2
[X2,Y2]=meshgrid([1 2 3 3.5 4 5],[1 2 3 3.5 4 5]);
z2=interp2(X1,Y1,z,X2,Y2)
mesh(X2,Y2,z2) 
```

有什么方法可以构造数据，例如命令 mesh(z2) 会产生相同的结果吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T19:45:05.667

我不确定你在问什么，但你当然可以在你的代码中删掉几行来做同样的事情：

```
[X2,Y2]=meshgrid([1 2 3 3.5 4 5],[1 2 3 3.5 4 5]);
z2=X2.^2+Y2.^2;
mesh(X2,Y2,z2); 
```

或者，你可以这样做：

```
[X1,Y1]=meshgrid(1:5,1:5);
z=X1.^2+Y1.^2;
mesh(z); 
```

对于这个特定的示例，我认为您不会看到这两种方法之间有太大的区别。

# linq - linq变量到c#中的datagridview

> ID：12484038
> 
> 赞同：1
> 
> 时间：2012-09-18T19:54:32.183
> 
> 标签：linq, c#-4.0, datagridview

我在 Linq 中有一个简单的查询，它按字长获取字符组，下面是代码

```
string sentence = "This is sample linq query";
            string[] words =  sentence.Split(' ');

            var query = from word in words
                        group word by word.Length into gr
                        orderby gr.Key ascending
                        select new { Length = gr.Key, Words = gr };

            foreach (var obj in query)
            {
                Console.WriteLine("Word of Length: {0}", obj.Length);
                foreach (string word in obj.Words)
                {
                    Console.WriteLine("{0}", word);
                }
                Console.WriteLine();
            } 
```

它工作正常，现在我想通过将上述记录放入 DataGridView 将其转换为 windows 窗体应用程序，所以我实现如下。

```
string sentence = "This is sample linq query";
            string[] words = sentence.Split(' ');

            var query = from word in words
                        group word by word.Length into gr
                        orderby gr.Key ascending
                        select new { Length = gr.Key, Words = gr };

            dataGridView1.DataSource = query.ToList(); 
```

但在这里我只是在 DataGridView 而不是 Words 列中获得第一列（长度），我还需要做些什么来获得这两列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:38:32.130

在您的情况下，分组的单词部分由 IGrouping 组成 - 数据网格无法显示。尝试按如下方式连接单词：

```
var query = from word in words
    group word by word.Length into gr
    orderby gr.Key ascending
    select new { Length = gr.Key, Words = gr.Aggregate((left, right)=>string.Format("{0}, {1}", left, right)) }; 
```

然后你会在网格中看到两列，一列是长度，另一列是现在再次连接的那个长度的单词。

# qt - Qt 错误构建包'fromString'不是'QKeySequence'的成员

> ID：12484041
> 
> 赞同：1
> 
> 时间：2012-09-18T19:54:45.397
> 
> 标签：qt, ubuntu, build, makefile, cross-compiling

我可以在 QtCreator 中使用 QtSDK x86 GCC 和 qmake 编译我的包 (maliit)。我现在正在尝试为 ARM 交叉编译 pacakge。我的 Qmake 和 Qt 库是使用 Buildroot 使用以下配置构建的：

```
cd /home/user/project/output/buildroot/build/qt-4.8.1; PKG_CONFIG_SYSROOT_DIR="/home/user/project/output/buildroot/host/usr/arm-unknown-linux-gnueabi/sysroot" PKG_CONFIG="/home/user/project/output/buildroot/host/usr/bin/pkg-config" PKG_CONFIG_PATH="/home/user/project/output/buildroot/host/usr/arm-unknown-linux-gnueabi/sysroot/usr/lib/pkgconfig:" MAKEFLAGS="w --  -j1" ./configure -silent -force-pkg-config -separate-debug-info -xplatform qws/linux-arm-gnueabi-g++- -opensource -confirm-license -largefile -no-qt3support -nomake examples -nomake demos -depths 16,32 -qt-gfx-linuxfb -no-gfx-transformed -no-gfx-qvfb -qt-gfx-vnc -no-gfx-multiscreen -no-gfx-directfb -no-mouse-pc -no-mouse-linuxtp -qt-mouse-linuxinput -qt-mouse-tslib -no-mouse-qvfb -no-kbd-tty -qt-kbd-linuxinput -no-kbd-qvfb -debug -shared -little-endian -embedded arm -no-gif -no-libmng -system-zlib -qt-libjpeg -qt-libpng -no-libtiff -qt-freetype -dbus -qdbus -no-openssl -no-sql-sqlite -no-xmlpatterns -no-multimedia -no-audio-backend -no-phonon -no-phonon-backend -svg -no-webkit -no-script -no-scripttools -no-javascript-jit -no-stl -no-declarative -glib -no-gfx-qnx -no-kbd-qnx -no-mouse-qnx -no-xinerama -no-cups -no-nis -no-accessibility -prefix /usr -plugindir /usr/lib/qt/plugins -hostprefix /home/user/project/output/buildroot/host/usr/arm-unknown-linux-gnueabi/sysroot/usr -fast -no-rpath 
```

当我尝试在 QtCreator 中交叉编译包时，它会运行到一半，然后在以下函数的 Q_EMIT 行出错：

```
void GlibDBusIMServerProxy::onInvokeAction(const QString &action,
                                           const QString &sequence)
{
    Q_EMIT invokeAction(action, QKeySequence::fromString(sequence));
} 
```

该文件肯定包含标题：

```
#include <QKeySequence> 
```

这是整个构建错误：

```
glibdbusimserverproxy.cpp: In member function 'void GlibDBusIMServerProxy::onInvokeAction(const QString&, const QString&)':
glibdbusimserverproxy.cpp:230:33: error: 'fromString' is not a member of 'QKeySequence'
make[1]: Leaving directory `/home/user/Desktop/maliit-framework/connection'
make[1]: *** [.obj/glibdbusimserverproxy.o] Error 1
make: Leaving directory `/home/user/Desktop/maliit-framework'
make: *** [sub-connection-make_default-ordered] Error 2
12:51:08: The process "/usr/bin/make" exited with code 2.
Error while building project maliit-framework (target: Desktop)
When executing build step 'Make' 
```

我可以从 IDE 中跟踪标题，并且在 Public 下有正确的定义：

```
static QKeySequence fromString(const QString &str, SequenceFormat format = PortableText); 
```

有什么问题？我已经在很多其他项目中使用了交叉编译的库，并且对这些项目运行良好。它怎么找不到'fromString'静态方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T01:18:40.457

Qt 配置命令的选项之一是定义`QT_NO_SHORTCUT`宏，它用`QKeySequence`空类替换类的一般定义。

# java - “从 scm 结帐为 maven 项目”中缺少 scm 类型

> ID：12484042
> 
> 赞同：0
> 
> 时间：2012-09-18T19:54:46.113
> 
> 标签：java, eclipse, svn, maven, version-control

我已经安装

1.  子剪辑
2.  eclipse的maven积分器

我去了

窗口 -> 首选项 -> Maven -> 目录 ->

希望安装

1.  maven-scm-plugin 的 m2e 连接器
2.  m2e-subclipse（子剪辑的 Maven SCM 处理程序）但找不到它们

在我安装它们之前，我不会看到填充了相应条目的 scm 类型的下拉列表。

有人可以帮助我吗？

![在此处输入图像描述](../Images/077421c39764fcb14e4f16c772a93db9.png) ![在此处输入图像描述](../Images/88c7304b64c5479726cff2bd61ff8cc9.png) ![在此处输入图像描述](../Images/be24a37ad7abd10803bf487126a078ec.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T06:33:10.970

I had a similar problem, but i was using SVN. I used a workaround for this. I did `Checkout Projects from SVN` and afterwards did `Maven --> Enable Dependency Management` on the project. May be it will help.

# javascript - 如何在网络音频 API 中反向播放但同时保持正向版本？

> ID：12484052
> 
> 赞同：3
> 
> 时间：2012-09-18T19:55:44.460
> 
> 标签：javascript, html, google-chrome, web-audio-api, audiobuffer

据我所知，google Chrome (v21) 中的 Web Audio API 不支持以下内容：

```
 source.playbackRate.value = -1; 
```

我非常希望！我会耐心等待，但与此同时，[这篇文章](https://stackoverflow.com/questions/9874167/how-can-i-play-audio-in-reverse-with-web-audio-api)有一个不错的替代解决方案。我采用它来尝试反转从[加载的 bufferlist](http://code.google.com/p/chromium/source/browse/trunk/samples/audio/doc/loading-sounds.html)加载的我自己的音频样本，希望我可以同时拥有每个加载的缓冲区的正向和反向版本，如下所示：

```
 function finishedLoading(bufferList)  {
        for (var it = 0; it < this.urlList.length; ++it) {  
            storedBuffer[it] = bufferList[it]; // assign bufferList to globals
            storedBufferR[it] = bufferList[it];

            // attempt to reverse storedBufferR only ...
            Array.prototype.reverse.call( storedBufferR[it].getChannelData(0) );
            Array.prototype.reverse.call( storedBufferR[it].getChannelData(1) ); 
        }
    } 
```

上面的函数确实反转了播放，但是它反转了“storedbufferR”*和*“storedbuffer”，这样所有的缓冲区都被反转了！

所以这就是我迷路的地方......我知道 Array.protoype 会影​​响所有数组，所以我想我可以看到“storedBuffer”如何受到“storedBufferR”上的反向方法的影响。编辑：反向方法只影响有问题的数组

但是是否可以重写上述函数以确保 array.protoype 只影响我想要反转的存储缓冲区？如果没有，是否有另一种方法可以同时存储正向和反向版本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-20T17:56:34.690

关于共享相同引用的两个 AudioBuffers 的评论在正确的轨道上，但解决方案不是创建一个新的 AudioContext；相反，您只需要创建一个新的 AudioBuffer 并克隆保存实际音频样本的底层 Float32Arrays。

例如，此函数将克隆一个 AudioBuffer：

```
function cloneAudioBuffer(audioBuffer){
    var channels = [],
        numChannels = audioBuffer.numberOfChannels;

    //clone the underlying Float32Arrays
    for (var i = 0; i < numChannels; i++){
        channels[i] = new Float32Array(audioBuffer.getChannelData(i));
    }

    //create the new AudioBuffer (assuming AudioContext variable is in scope)
    var newBuffer = context.createBuffer(
                        audioBuffer.numberOfChannels,
                        audioBuffer.length,
                        audioBuffer.sampleRate
                    );

    //copy the cloned arrays to the new AudioBuffer
    for (var i = 0; i < numChannels; i++){
        newBuffer.getChannelData(i).set(channels[i]);
    }

    return newBuffer;
} 
```

然后，修改上述...

```
function finishedLoading(bufferList)  {
    for (var it = 0; it < this.urlList.length; ++it) {  
        storedBuffer[it] = bufferList[it]; // assign bufferList to globals
        storedBufferR[it] = cloneAudioBuffer(bufferList[it]);

        // attempt to reverse storedBufferR only ...
        Array.prototype.reverse.call( storedBufferR[it].getChannelData(0) );
        Array.prototype.reverse.call( storedBufferR[it].getChannelData(1) ); 
    }
} 
```

# mysql - 500,000,000 条记录，int 字段时间戳索引，mysql 会处理通过此查询进行的搜索吗？

> ID：12484057
> 
> 赞同：0
> 
> 时间：2012-09-18T19:56:05.243
> 
> 标签：mysql

假设我有一个 MySQL 表，里面有 5 亿条记录

它有一个列`ts`，该列被索引并具有时间戳作为值。做一个有效率吗

`select * from table where ts>=time()-24hours`

以及过去 24 小时/周/月/年？

还是我应该去 nosql ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:00:51.030

我发现 MySQL 在处理大日期范围时经常会丢弃索引。您的“>=”，从技术上讲是一个范围（以“现在”结尾），对于优化器来说可能是一个例外，因为它应该能够跳转到起点......

如果您可以忍受建表的时间，请使用`EXPLAIN`它来查看它是否正在使用索引。

希望你不需要`SELECT *`。如果您的结果中只需要几个较小的列，请将它们也放入索引中，这将使 MySQL 不必从磁盘读取底层更宽的行。

# c++ - 将向量拆分为块 - 奇怪的结果

> ID：12484063
> 
> 赞同：0
> 
> 时间：2012-09-18T19:56:11.087
> 
> 标签：c++, matlab, matrix

我得到了一个 MATLAB 函数，它接受一个 1D 向量和两种大小，然后该函数将数据拆分为块，最后将它们存储在 2D 向量中。我一直在编写这个函数的 C++ 版本，但是我的 C++ 函数的（不正确的）结果与 MATLAB 函数的（正确的）结果不匹配。

Matlab函数：

```
function f = block(v, N, M)

% This function separates the vector
% into blocks.  Each block has size N.
% and consecutive blocks differ in
% their starting positions by M
%
% Typically
%   N = 30 msec (600 samples)
%   M = 10 msec (200 samples)

  n = length(v);
  maxblockstart = n - N + 1;
  lastblockstart = maxblockstart - mod(maxblockstart-1 , M);

  % Remove the semicolon to see the number of blocks
  % numblocks = (lastblockstart-1)/M + 1
  numblocks = (lastblockstart-1)/M + 1;

  %f = zeros(numblocks,N);

  for i = 1:numblocks
  for j = 1:N
   f(i,j) = ((i-1)*M+j);
  end 
 end 
```

出于本示例的目的，我只是输出 ((i-1)*M+j) 的结果，在 MatLab 中我得到这些结果（示例）：

1 201 401 601 .. 1001 1201 .. 1401 .. 1601 .. 1801

这是我的 C++ 函数：

```
vector<iniMatrix> Audio::subBlocks(vector<float>& theData, int N, int M)
{
    // This method splits the vector into blocks
    // Each block has size N.
    // and consecutive blocks differ 

    int n = theData.size();
    int maxblockstart = n - N+1;
    int lastblockstart = maxblockstart - mod(maxblockstart-1, M);

    int numblocks = (lastblockstart-1)/M + 1;

    vector<float> subBlock;
    vector<iniMatrix> block;

    for(int i=1; (i < numblocks); i++)
    {
        for(int j=1; (j < N); j++)
        {
            cout << ((i-1)*M+j);
        }

    }

    return block;
} 
```

我从中得到的结果：

1 2 3 4 .. 7 8 9 .. 13 14 15 等..

附言

iniMatrix 只是浮点向量的 typdef ..

另一个注意事项，变量：

> n
> 
> 最大块启动
> 
> 最后一个块开始
> 
> 数字块

在 Matlab 程序和 C++ 中都具有相同的值，所以我认为这与 for 循环有关。

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:27:04.110

我不确定，但你在哪里写输出中的一维向量的值？

也许你需要改变这个：

```
 for i = 1:numblocks
  for j = 1:N
   f(i,j) = v((i-1)*M+j);
  end 
 end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:28:13.163

让我看看我是否正确理解了您想要的算法。说 n = 10 N = 3 M = 2

这应该产生 0、2、4、6 对吧？（因为 8 不适合，因为 8+M 超出范围 0 <= x < n）。

所以，maxblockstart 应该是 7 = 10 - 3，即 n - N

lastblockstart 应该是 6 = 7 - 7 % 2，即 maxblockstart - maxblockstart % M

并且 numblocks 应该是 4 = 6/2 + 1，即 lastblockstart/M + 1

如下修改你的代码，似乎产生了正确的结果（只在纸上解决了这个问题，没有尝试编译或执行......）：

```
vector<iniMatrix> Audio::subBlocks(vector<float>& theData, int N, int M)
{
  int n = theData.size();
  int maxblockstart = n - N;
  int lastblockstart = maxblockstart - (maxblockstart % M);

  int numblocks = (lastblockstart)/M + 1;

  vector<iniMatrix> block;    

  for(int i=0; (i < numblocks); i++)
  {
     vector<float> subBlock;
      for(int j=0; (j < N); j++)
      {
          subBlock.push_back(theData[i*M+j]); //cout << (i*M+j);
      }  
      block.push_back(subBlock);
  }

  return block;
} 
```

试试看...

请注意，将结果与 MATLAB 进行比较可能会造成混淆，因为 C++ 指示是从零开始的。因此尝试以下操作；

1）将行更改`cout << (i*M+j);`为`cout << theData[i*M+j];`

2）尝试以下测试：

```
vector<float> test;
for(int i=0; i<=10000; i++)
  test.push_back(i);

Audio::subBlocks(test, 1023, 200); 
```

# delphi - Indy HMAC-SHA1 生成意外值

> ID：12484064
> 
> 赞同：3
> 
> 时间：2012-09-18T19:56:16.610
> 
> 标签：delphi, delphi-xe2, indy, hmacsha1

我正在尝试使用使用 OAuth 1.0a 并需要 HMAC-SHA1 进行签名的第 3 方服务。我用 C# 编写了一个工作版本，并尝试将其移至 Delphi XE2。我立即注意到出了点问题，服务器拒绝了我的电话，说我的“签名无效”。这是我生成签名的方法：

```
function TOAuth1.GenerateSignature(signatureBase, key : string) : string;
var
  hmacSha1 : TIdHMACSHA1;
  keyBytes, textBytes, hashedBytes : TBytes;
begin
  if(AnsiCompareText(fSignMethod,'PLAINTEXT') = 0) then
  begin
    Result := key;
  end
  else if(AnsiCompareText(fSignMethod,'HMAC-SHA1') = 0) then
  begin
    hmacSha1 := TIdHMACSHA1.Create;
    SetLength(keyBytes,Length(key));
    Move(key[1],keyBytes[0],Length(key));
    hmacSha1.Key := keyBytes;
    SetLength(textBytes,Length(signatureBase));
    Move(signatureBase[1],textBytes[0],Length(signatureBase));
    hashedBytes := hmacSha1.HashValue(textBytes);
    Result := EncodeBase64(hashedBytes,Length(hashedBytes));
    keyBytes := nil;
    textBytes := nil;
    hashedBytes := nil;

    hmacSha1.Free;
    hmacSha1 := nil;
  end;
end; 
```

我看不出有什么不对劲的地方，所以我从我的 C# 测试中拿了一个`signatureBase`and`key`

签名库：`POST&https%3A%2F%2Fapi.twitter.com%2Foauth%2Frequest_token&oauth_callback%3Dhttp%253A%252F%252Flocalhost%252Fsign-in-with-twitter%252F%26oauth_consumer_key%3DcChZNFj6T5R0TigYB9yd1w%26oauth_nonce%3Dea9ec8429b68d6b77cd5600adbbb0456%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1318467427%26oauth_version%3D1.0`

钥匙：`L8qq9PZyRg6ieKGEKhZolGC0vJWLw8iEJ88DRdyOg&`

在 C# 中使用这些值，我得到了签名`F1Li3tvehgcraF8DMJ7OyxO4w9Y=`，这是 Twitter 给我的预期值。然而，在德尔福，我得到了签名`/kov410nJhE6PTlk0R8bjP7JQq4=`

在 Delphi 中，我这样调用我的函数：

```
 signature := self.GenerateSignature('POST&https%3A%2F%2Fapi.twitter.com%2Foauth%2Frequest_token&oauth_callback%3Dhttp%253A%252F%252Flocalhost%252Fsign-in-with-twitter%252F%26oauth_consumer_key%3DcChZNFj6T5R0TigYB9yd1w%26oauth_nonce%3Dea9ec8429b68d6b77cd5600adbbb0456%26oauth_signature_method'+'%3DHMAC-SHA1%26oauth_timestamp%3D1318467427%26oauth_version%3D1.0','L8qq9PZyRg6ieKGEKhZolGC0vJWLw8iEJ88DRdyOg&');
  assert(AnsiCompareStr(signature,'F1Li3tvehgcraF8DMJ7OyxO4w9Y=') = 0,'Signature generated is invalid'); 
```

所以我的问题是：我是否错误地使用了 HMAC-SHA1？如果是这样，我应该采取哪些步骤来修复它？如果不是，那么在 Indy 中 HMAC-SHA1 的实现是否不正确？如果是这样，是否有一个易于使用（最好是免费的）单元可以正确处理它？还是这里有其他完全错误的地方？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T20:10:07.383

看起来像是常见的 Unicode 字符串误解。自 Delphi 2009 以来，`string`映射到`UnicodeString`UTF-16 编码，不再映射到`AnsiString`. 所以，

```
Move(key[1],keyBytes[0],Length(key)); 
```

可能只会复制字符串的前半部分，每个字符 2 个字节。用于[`UTF8Encode`](http://docwiki.embarcadero.com/Libraries/en/System.UTF8Encode)先将密钥转换为 UTF8，然后将其复制到 keyBytes。

# multithreading - 不同线程中的openGL体渲染和显示更新

> ID：12484068
> 
> 赞同：0
> 
> 时间：2012-09-18T19:56:39.097
> 
> 标签：multithreading, opengl, rendering, volume

我正在使用 openGL 和“freeglut”库进行体积渲染和显示。在主线程中初始化openGL窗口，然后逐帧获取体数据，获取一个体数据后进行体绘制。这很好用，但需要很多时间。是否可以在主线程中继续初始化openGL窗口，并在另一个线程中进行体积渲染和显示？我检查了 wglMakeCurrent，它不会更新在主线程中初始化的窗口。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T20:01:05.690

多线程 OpenGL 操作是一个讨厌的野兽。但是，您可以（这是我强烈建议的）将像素缓冲区对象映射到程序的地址空间中。并且该地址空间区域对所有线程都是可见的。因此，您可以从另一个线程更新体积数据（或者，就像我目前正在处理的程序一样，在另一个 GPU 上），然后通知主线程从 PBO 中的新数据更新纹理。您还可以使用 glTexSubImage3D 从 PBO 仅更新体积的子部分。

# algorithm - Twitter 时间线算法是如何工作的？

> ID：12484072
> 
> 赞同：8
> 
> 时间：2012-09-18T19:56:56.100
> 
> 标签：algorithm, twitter, pseudocode

我正在尝试设计一个类似于 Twitter 时间线的系统，但我无法理解如何在保持高效的同时从如此多的关注者那里获取更新。假设我在 Twitter 上关注了 1000 人。当我转到我的提要时，它如何知道要显示哪些推文？这就是我的想法，但它似乎效率极低且不太可能：

```
You have 10,000 friends.
In a for loop, loop through each friend, getting their latest 
  status updates since their last update. 
```

但循环访问 10,000 个朋友似乎很荒谬。我无法想象他们会怎么做。还是会是这样的：

```
Someone I am following posted a tweet. That tweet is inserted in 
  an array containing the tweets of all people I am following. 
```

但这似乎很奇怪，如果我关注了一个拥有 20,000 条推文的新人，那么我的数组中将插入 20,000 条推文，如果那个人有数百万的关注者，那么同一组推文就有 100 万 X 20,000 个副本. 所以这似乎也不太可能。

任何人都知道他们怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T20:02:38.507

我建议您查看[twissandra 项目](https://github.com/twissandra/twissandra) ，他们使用[cassandra](http://cassandra.apache.org/)（一个 nosql 数据库）实现了 twitter 的所有基本功能。据说 twitter[不再使用它来发布推文](http://highscalability.com/blog/2010/7/11/so-why-is-twitter-really-not-using-cassandra-to-store-tweets.html)。

旧的实现可以参考[这里](http://www.slideshare.net/nkallen/q-con-3770885)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-02-15T17:08:09.923

我制作了一个关于这个主题的视频，它解释了 twitter 的完整系统设计 [https://www.youtube.com/watch?v=KmAyPUv9gOY](https://www.youtube.com/watch?v=KmAyPUv9gOY)

# android - Android 是否假定我想向用户显示的任何时间戳都是 UTC 格式，并且它会在我的手机本地时区中显示它？

> ID：12484074
> 
> 赞同：0
> 
> 时间：2012-09-18T19:57:05.147
> 
> 标签：android, timezone, timestamp

只是想确认我应该如何向用户显示时间戳。我们以 UTC 格式存储我们的系统时间戳，例如提交日期和时间戳以及某些操作或事件发生的时间等。

我现在正在做一些测试。我进行查询并将UTC时间戳列表作为字符串返回，然后我想将其放入日历表单中。我正在这样做：

```
someTimeStamp = Calendar.getInstance();
long l = Long.valueOf(stringTimeStampFromDBViaJson);
someTimeStamp.setTimeInMillis(l); 
```

例如，我从 UTC 数据库返回的值是

```
2012-09-18 19:36:23.950
2012-09-18 19:31:55.193 
```

所以我的手机在 EST 中，直接显示如下

```
18 September, 2012 03:36:23 PM
18 September, 2012 03:31:55 PM 
```

这就是我想要的。我只是想知道这是否是我可以指望的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:05:33.233

Unless you explicitly define otherwise, all Java stamps represent UTC time and date since the Unix epoch (Jan 1 1970). If you use System calls (i.e. Android/Google library API calls) then you need to know if these are local or UTC but it's usually easy to tell from the API prototype and, in my experience, is "sufficiently" documented.

I'm working on a project right now which has to mix UTC, GMT and local and all of my stamps are internally presented as milliseconds UTC since the epoch. Only when I display to the user do I take timezones into account. I use the Calendar class exclusively for representing DTGs and for calculations and have found it both accurate and reliable.

I also have a helper class which contains methods such as

```
long startOfDayUsingPrefs(long millis) 
```

and

```
long startOfDay(long millis). 
```

The former returns the timestamp for the first tick since midnight today UTC or local time, depending on a preference the user sets (use local timezone or UTC). The latter is always UTC.

Hope this helps..

# mysql - 如何确定 MySQL Bulk INSERT 的缓冲区大小

> ID：12484076
> 
> 赞同：0
> 
> 时间：2012-09-18T19:57:04.867
> 
> 标签：mysql, sql, bulkinsert

我正在编写将使用批量插入语句的迁移。它在数据库中搜索某些信息并将其编译为特定表中使用的格式并使用下面的 INSERT 方法将其写入。将运行它的 MySQL 机器都有一个 16MB 的 max_allowed_pa​​cket 大小，我无法更改。

我对此很陌生。当我的缓冲区中的字符刚好低于 16MB 时，我试图插入缓冲区中的内容。这是行不通的。max_allowed_pa​​cket 大小超过 16MB 并导致问题。对于任何知道自己在做什么的人（但对我而言），原因可能很明显。

我需要知道如何计算给定 max_allowed_pa​​cket 大小可以插入多少个字符。我们正在使用 INNODB 存储引擎。

这或多或少是我的插入语句的样子：

```
INSERT INTO _table_ (col_name1, col_name2, col_name3) 
      VALUES (val1, val2, val3), (val1, val2, val3), (val1, val2, val3)... etc. 
```

如果我需要提供更多信息，请告诉我。在这一点上，我真的不知道该怎么办。

**编辑以澄清问题。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-08T20:08:57.270

我遇到了类似的问题，并通过反复试验发现了以下问题。

1.  max_allowed_pa​​cket-1 是查询可以包含的最大字符数。
2.  查询中的空格被添加到查询的长度中

例如。

```
INSERT INTO _table_ (col_name1) Values('value1')    -- 1 
```

短于

```
INSERT INTO _table_ (col_name1   ) Values('value1'    )    -- 2 
```

在考虑字符串长度时，这似乎相当明显，但是将两者视为查询，并且您希望两者的行为完全相同。
如果 max_allowed_pa​​cket 大于上面 '1' 的长度并且小于 '2'，那么 2 不会执行而 1 正常运行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T06:42:21.153

阅读我提供的链接和网页中的用户评论会产生一个命令：

```
show variables like 'max_allowed_packet'; 
```

这允许客户端向服务器询问其配置设置。

```
Variable_name       Value
max_allowed_packet, 1048576 
```

应用程序当然可以控制客户端 SQL 驱动程序以将其设置为匹配（或更大）。

# c - 将结构类型转换为整数时出错

> ID：12484077
> 
> 赞同：3
> 
> 时间：2012-09-18T19:57:11.247
> 
> 标签：c, casting

我收到错误

```
 error: aggregate value used where an integer was expected 
```

在编译此代码时：

```
#include <stdio.h>
typedef unsigned long U32; 
typedef struct hello_s
{
  U32   a:8;
  U32   b:24;
}hello_t;

int main()
{
  hello_t str;
  U32 var;

  str.a = 0xAA;
  str.b = 0xAAA;
  var = (U32)str;
  printf("var : %lX\n", var);
  return 0;
} 
```

有人可以解释错误的含义，以及我做错了什么。

编辑：我知道这是一件愚蠢的事情。我想知道的是为什么编译器会为此哭泣。为什么不能只将前 32 位分配给整数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T19:58:27.627

```
var = (U32)str; 
```

因为`str`是结构类型的对象，您不能将结构对象转换为算术类型的对象。C 不允许您执行这种转换。

如果您想将结构对象作为整数访问，您可以创建结构和`U32`.

请注意，公共构造`var = *(U32 *) str;`是 C 中未定义的行为。它违反了别名和对齐规则。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T19:31:13.353

好吧，我认为人们不应该误认为 C99 规范违反了语言标准。

该标准仅表示转换的结果可能无法跨不同的机器/架构移植。

只要您将程序编码为在特定架构上工作，就可以了。

例如，我将唯一标识对象（即键）的数据结构 DataStr_t 的选择性成员分组到另一个结构中，例如 DataStrKey_t。我将确保 sizeof(DataStrKey_t) 等于 sizeof(uint64) 并且出于所有实际目的将其用作 uint64，因为它易于处理。

我也经常做以下操作：

```
memcmp(&var_uint64, &var_DataStructKey, sizeof(uint64)); 
```

如果您使用机器上的键对对象进行读访问或写访问，则转换产生的值是可预测的，并且按位对齐是一致的。好吧，如果您将“仅此数据”移动到另一台机器（实际上并没有写入数据）并尝试读取它，事情可能会中断。

您的程序稍作修改以获得更多解释和成功编译：这里，只要 LINE_A 和 LINE_B 在同一台机器上执行，结果总是可以预测的。但是，如果您将 (var_uint64,var_DataStructKey) 写入文件并从另一台机器读取它，然后对这些填充的值执行 LINE_B，则比较“可能”会失败。

```
#include <stdio.h>
#include <string.h>

typedef unsigned long U32;
typedef struct hello_s
{
  U32   a:8;
  U32   b:24;
}hello_t;

int main()
{
  hello_t str;
  U32 var;

  str.a = 0xAA;
  str.b = 0xAAA;
  var = *(U32 *)(&str); //LINE_A

  if(0 == memcmp(&var, &str, sizeof(U32))) //LINE_B
      printf("var : %lu\n", var);

  return 0;
} 
```

我想我的回答为时已晚，但试图解释。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T20:00:58.700

你认为演员阵容会产生什么结果？您总是可以将它的地址转换为指向 int 的指针并取消引用它......但是您确定可以安全地这样做（不，您不能）？结构成员对齐是否有一天会咬你（答案是“可能，是的，这取决于”）？

此外，从 C99 标准：

> C99 §6.7.2.1，第 10 段：“单元内位字段的分配顺序（高位到低位或低位到高位）是实现定义的。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-10T14:22:41.470

这并不总是一件愚蠢的事情。就我而言，我有一个需要通过网络连接发送的结构。数据必须以字节形式通过 SPI 总线发送，因此必须一次访问一个字节的结构。我使用这个定义来访问每个字节。您必须了解平台的字节顺序才能正确执行此操作。此外，您必须确保您的结构是[__PACKED](https://stackoverflow.com/questions/5473189/what-is-a-packed-structure-in-c)（另请参见：[C/C++：强制位字段顺序和对齐](https://stackoverflow.com/questions/1490092/c-c-force-bit-field-order-and-alignment)），因此编译器不会插入任何填充块或对齐块。如果任何位成员跨越字节边界，这也将不起作用（至少，对于 Microchip XC16 编译器，它不会）。

```
typedef unsigned char byte;
#define STRUCT_LB(x) ((byte *)(&x))[0]
#define STRUCT_HB(x) ((byte *)(&x))[1] 
```

一个更好的方法是将你的结构定义为一个位域和一个字节数组的联合，如下所示：

```
typedef unsigned char byte;
typedef struct {
    union {
        struct __PACKED {
            byte array[2];
        } bytes;

        struct __PACKED {
            byte b0: 1;
            byte b1: 1;
            byte b2: 1;
            byte b3: 1;
            byte b4: 1;
            byte other: 3;
            byte more: 6;
            byte stuff: 2;
        } fields;
    };
} MyData; 
```

# sql-server - 小 ms Sql 查询以获取具有某些条件的 id 的最大值

> ID：12484079
> 
> 赞同：1
> 
> 时间：2012-09-18T19:57:13.727
> 
> 标签：sql-server

![在此处输入图像描述](../Images/3295bbe5af35463efa5dff58614747a0.png)

我希望 sql 查询得到上述结果。结果是 TableA 中的最大 Id，TableB 中的 s_id 具有 Stat=true 即 1。

以下不做我想要的：

```
select i.category_id,i.image_id,i.image_original,i.image_title,i.photographer 
from images i 
  inner join schedule s 
    on i.scheduleid=s.scheduleid 
    and s.status='live' 
where image_id=(select max(image_id) from images) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:05:32.780

Use [TOP](http://msdn.microsoft.com/en-us/library/ms189463.aspx) to retrieve only 1 row
Use [ORDER BY](http://msdn.microsoft.com/en-us/library/ms188385.aspx) to control the sorting, so you get the single row you want

```
SELECT TOP(1) a.id, a.[image], a.s_id, b.stat, b.[desc]
  FROM TableA a
  JOIN TableB b on a.s_id = b.s_id
 WHERE b.stat = 1
ORDER BY A.ID DESC 
```

An [SQLFiddle](http://sqlfiddle.com/#!6/19ef3/1/0) showing this.

# regex - 插入式、可移植的解析

> ID：12484082
> 
> 赞同：11
> 
> 时间：2012-09-18T19:57:33.370
> 
> 标签：regex, api, parsing, dsl, context-free-grammar

我每天看到无数关于“如何用正则表达式做 X”的帖子。对他们中的大多数人来说，最好的回应似乎是老实说，“你为什么要用锤子敲螺丝？” 但是正则表达式无处不在，而且语法大多是可移植的，特别是如果你远离花哨的部分。

是否有任何与 regexen 等效但在功能和可配置性方面更上一层楼的东西？一个“你可以在任何地方使用它”的各种解析库，最好是使用极其简洁的 DSL 作为其接口？

我已经使用了一些 Ragel，但是由于预处理步骤，我会犹豫将它推荐给某人，因为“使用它而不是一些毛茸茸的正则表达式”。从 Obj-C 中使用它很尴尬，而且我希望它对于没有 compile-link-run 作为其标准操作过程的一部分的语言来说会非常尴尬。

我正在寻找的是能够通过“inline-online-universal”测试的东西。

1.  （内联）您可以将符号与您的其他代码内联，就像使用正则表达式一样。

2.  （在线）您可以像运行其他代码一样运行生成的解析器，这意味着在 Python 之类的情况下，在输入到 REPL 之后立即运行。

3.  （通用）您可以移动到不同的语言/平台，并为您的解析器使用几乎相同的代码，模方言差异。实际上，我会对 Python、Ruby、C、Java 和 Haskell 中的某些东西感到满意。

我所知道的大多数工具都属于“在线”。他们离线预处理语法并以目标语言（C、Python、Java、C++……）输出代码。它们是独立的工具，本身并没有集成到语言环境中。

我有 PEG 解析器和 lex/yacc 组合的建议。解析器组合库也可能是一个不错的选择。无论您提出什么建议，我都希望看到证明它符合这些测试。您的答案应该通过在 Python、C 和 Haskell 中提供工作演示解析器来证明所提议的解决方案满足内联在线通用要求。演示示例由作者决定，但仅使用正则表达式应该会很痛苦，但使用适当的解析器则微不足道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T00:50:09.627

[https://github.com/leblancmeneses/NPEG](https://github.com/leblancmeneses/NPEG)

实现 PEG。

满足所有 3... 让我解释一下。

它仅与 C# 内联，与所有其他程序脱机。C# 也有离线版本。

我目前支持离线版本：C/C++/Javascript（现在本地）/Java 通过所有单元测试 - 使其通用。添加另一种语言需要 25.84 小时（创建离线 Javascript 版本需要多长时间）

使每种语言都在线需要大量维护（可能），但我花了很多工作和时间来支持当前的离线版本。我现在可以将精力集中在构建语法优化器和工具以对所有离线版本都受益的语法规则进行单元测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T09:14:09.257

看看 Lex/Yacc 或它们的对应物 Flex/Bison（或 Coco，或所有其他“编译器”生成器）。该组合可用于解析复杂的文本数据，其语法（可以说）比正则表达式更具可读性。

不过，对于简单的问题，只要正则表达式绰绰有余，无论如何都要使用它们。

# php - 在 MySQL 中存储单个空格字符

> ID：12484084
> 
> 赞同：2
> 
> 时间：2012-09-18T19:57:40.623
> 
> 标签：php, mysql, unicode, pdo

我编写了一个 PHP 脚本来使用 Unicode 数据填充 MySQL 表。不过，我遇到了一些小问题。例如，*空格*`character`字符 (id = 32) 的列是空的，即使我单独运行以下命令：

 *```
UPDATE unicode SET `character` = ' ' WHERE id = 32; 
```

有任何想法吗？这是我用来填充表的脚本（包含的脚本`common.php`定义了`database`函数，它是一个 PDO 对象）：

```
<?php

include_once('common.php');

// Fetch data from Unicode website
$file = fopen('http://www.unicode.org/Public/UNIDATA/UnicodeData.txt', 'r');

// Iterate through each line of the file
while($row = fgets($file)) {

    // Gather data
    $column = explode(';', $row);
    $id = hexdec($column[0]);
    $name = $column[1];
    $general_category = $column[2];
    $uppercase_mapping = hexdec($column[12]);
    $lowercase_mapping = hexdec($column[13]);
    $titlecase_mapping = hexdec($column[14]);

    // Build the database query
    $query = sprintf("INSERT IGNORE INTO unicode VALUES (%d, CHAR(%d USING UTF8), '%s', '%s', %d, %d, %d)",
        $id,
        $id,
        $name,
        $general_category,
        $uppercase_mapping,
        $lowercase_mapping,
        $titlecase_mapping);

    database()->query($query);
    echo $id.' ';
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:02:34.097

如果您有一个`CHAR`列类型，您的数据库驱动程序可能会自动剥离尾随空格。`VARCHAR`如果未配置为保留数据，某些驱动程序甚至可能在数据上执行此操作。

您可以通过选择十六进制编码版本来检查数据库中的实际内容：

```
SELECT HEX(character) FROM unicode WHERE id=32 
```

您应该看到`20`32 的十六进制等价物。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:02:59.847

`character`必须是类型`CHAR`*

# sql - SQL语法和Rails：如何在控制台中生成带有尾随空格的数据库记录列表

> ID：12484087
> 
> 赞同：1
> 
> 时间：2012-09-18T19:57:44.883
> 
> 标签：sql, ruby-on-rails

我在 Rails 控制台中，我想生成一个包含尾随空格的用户名列表。我在想语法看起来像这样，但它不起作用。任何比我更好的程序员都可以指出我做错了什么？

```
> User.name.where("% ") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:25:23.763

不知道您是否使用 MySQL，但一种方法是：

```
User.where("name LIKE '% '") 
```

您可以根据您的数据库进行更改。不过，这有点慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:26:31.757

一种方法是

```
Job.all.select{|j| j =~ /^\d+$/} 
```

但它可能不如 MySQL 版本高效。

另一种可能性是使用命名范围来隐藏丑陋的 SQL：

```
 named_scope :all_digits, lambda { |regex_str|
    { :condition => [" invoice_number REGEXP '?' " , regex_str] }
  } 
```

然后你有 Job.all_digits。

答案来自[如何在 Rails 中使用 Active Record 时指定 Ruby 正则表达式？](https://stackoverflow.com/questions/8059770/how-to-specify-ruby-regex-when-using-active-record-in-rails)

你可以有

```
regex_str = "\w+\s+$" 
```

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:08:27.150

这是我的选择：

```
User.all.select { |c| c.name.end_with?(" ") } 
```

这让我得到了我需要的清单。

它基于 Paritosh 的第一个答案。我让他成为规范的答案，因为我认为总的来说这是一个更好的资源。我的解决方案只对我有帮助，但他有很多有用的策略。

# join - Linq-To-Nhibernate 倍数与条件连接

> ID：12484091
> 
> 赞同：1
> 
> 时间：2012-09-18T19:58:07.173
> 
> 标签：join, fluent-nhibernate, linq-to-nhibernate

我正在使用 Fluent-Nhibernate 1.3 版，并且正在尝试进行包含 5 个表的查询。我为 oracle 数据库创建了一个 sql 查询，并尝试使用 linq-to-nhibernate 进行复制。

遵循我的实体和映射示例。

实体：

```
public class A
{
    public virtual int idA { get; set; }
    public virtual String codA { get; set; }
    public virtual String tipoA { get; set; }
    public virtual IList<B> listB { get; set; }
}

public class B
{
    public virtual C objectC { get; set; }
    public virtual A objectA { get; set; }
    public virtual DateTime dtBegin { get; set; }
    public virtual DateTime dtEnd { get; set; }
}

public class C
{
    public virtual int idC { get; set; }
    public virtual String codeC { get; set; }
    public virtual IList<B> listB { get; set; }
    public virtual IList<D> listD { get; set; }
}

public class D
{
    public virtual C objectC { get; set; }
    public virtual string flgD { get; set; }
    public virtual DateTime dtBegin { get; set; }
    public virtual DateTime dtEnd { get; set; }
    public virtual E objectE { get; set; }
}

public class E
{
    public virtual int idE { get; set; }
    public virtual String dsE { get; set; }
    public virtual DateTime dtBegin { get; set; }
    public virtual DateTime dtEnd { get; set; }
    public virtual IList<D> listD { get; set; }
} 
```

我的映射：

```
class AMap : ClassMap<A>
{
    public AMap()
    {
        Table("A");

        Id(x => x.idA, "ID_A").GeneratedBy.Sequence("StringA");
        Map(x => x.tipoA, "TP_A");
        Map(x => x.codA, "CODE_A");
        HasMany(x => x.listB).Cascade.All().KeyColumn("ID_A");
    }
}

class BMap : ClassMap<B>
{
    public BMap()
    {
        Table("B");

        CompositeId()
            .KeyReference(x => x.objectC, "ID_C")
            .KeyReference(x => x.objectA, "ID_A")
            .KeyProperty(x => x.dtBegin, "DT_BEGIN");

        Map(x => x.dtEnd, "DT_END");
    }
}

class CMap : ClassMap<C>
{
    public CMap()
    {
        Table("C");
        Id(x => x.idC, "ID_C").GeneratedBy.Sequence("StringC");
        Map(x => x.codeC, "CODE_C");
        HasMany(x => x.listB).Cascade.All().KeyColumn("ID_C");
        HasMany(x => x.listD).Cascade.All().KeyColumn("ID_D");
    }
}

class DMap : ClassMap<D>
{
    public DMap()
    {
        Table("D");

        CompositeId()
            .KeyReference(x => x.objectC, "ID_C")
            .KeyProperty(x => x.flgD, "FLG_D")
            .KeyProperty(x => x.dtBegin, "DT_BEGIN");
        References(x => x.objectE, "CODE_E");
        Map(x => x.dtEnd, "DT_END");
    }      
}

class EMap : ClassMap<E>
{
    public EMap()
    {
        Table("E");

        Id(i => i.idE, "ID_E").GeneratedBy.Assigned();
        Map(m => m.dsE, "DSC_E");
        Map(m => m.dtBegin, "DT_BEGIN");
        Map(m => m.dtEnd, "DT_END");
        HasMany(x => x.listD).Cascade.All().KeyColumn("ID_E");
    }
} 
```

我的 SQL 查询（有效）：

```
SELECT C.CODE_C, E.CODE_E, E.DT_BEGIN
FROM TABLEA A, TABLEB B, TABLEC C, TABLED D, TABLEE E
WHERE A.CODE_A = '0000' AND A.ID_A = B.ID_A AND B.ID_C = C.ID_C AND B.DT_END IS NULL
AND C.ID_C = D.ID_C AND D.DT_END IS NULL AND D.CODE_E = E.CODE_E AND E.DT_END IS NULL; 
```

我尝试使用多重连接，但随后一些关系是集合，所以我必须在连接内创建一个位置。

所以我的问题是：是否可以进行与 linq-to-nhibernate 相同的 Sql 查询，或者更好地进行一系列选择？不，我不能更改数据库。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T13:55:12.560

is null 查询只能使用 DateTime 吗？作为类型

```
var query = from b in B
            from c in b.C
            from d in c.listD
            from e in d.E
            where b.A.Code == "0000" && b.EndDate == null & ...
            select new { Ccode = c.Code, Ecode = e.Code, E_BeginDate = e.BeginDate } 
```

更新：回答第三条评论

分组结果必须在内存中完成，因为 sql 中的分组只能返回聚合

```
var results = query.AsEnumerable()
    .GroupBy(a => a.Ccode, a => a.Ecode, (key, values) => new { Ccode = Key, Ecodes = values.ToList() })
    .List(); 
```

# linux - Tomcat什么是线程总启动数

> ID：12484092
> 
> 赞同：1
> 
> 时间：2012-09-18T19:58:08.780
> 
> 标签：linux, multithreading, tomcat, jvm

我们正在使用 SNMP 工具监控 Tomcat，它正在向我展示。

Thread Total Started Count = 500（经常变化）

我找到了 OID，发现了它的“jvmThreadTotalStartedCount” [http://support.ipmonitor.com/mibs/JVM-MANAGEMENT-MIB/item.aspx?id=jvmThreadTotalStartedCount](http://support.ipmonitor.com/mibs/JVM-MANAGEMENT-MIB/item.aspx?id=jvmThreadTotalStartedCount)

它是说：自 Java 虚拟机启动以来创建和启动的线程总数。

我的问题是这意味着什么？有人可以用简单/基本的语言解释我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:04:05.783

[线程](http://en.wikipedia.org/wiki/Thread_%28computing%29)是进程中的一个[执行](http://en.wikipedia.org/wiki/Process_%28computing%29)流。有些进程只有一个执行流（单线程），而其他进程（例如 Tomcat）将它们的行为划分为多个并行执行流（多线程）。

Tomcat 作为一个 Web 服务器，通常会分配一个线程来处理它接收到的每个请求，达到一个限制（可能是`500`您的情况），之后将后续请求排队，等待线程空闲来处理它们。这称为[线程池](http://en.wikipedia.org/wiki/Thread_pooling)。

因此，要回答您的第一个问题，`Thread Total Started Count`该 Tomcat 实例自开始运行以来创建的所有不同执行流的总数是多少。

# matlab - 可视化 3D 数据结构

> ID：12484101
> 
> 赞同：4
> 
> 时间：2012-09-18T19:58:59.230
> 
> 标签：matlab, 3d, visualization, paraview

我有一个 C 代码中的 3D 数据结构，我想将其可视化为 3D 空间中的框和点。所以我有一堆坐标，一些用于点，一些用于框，我想以 3D 形式绘制这些坐标以可视化数据结构。有没有人做过类似的事情的经验？我开始尝试使用 paraview。我的计划是生成一个 paraview 状态文件（xml 类型文件），然后用 paraview 打开它。问题是那些状态文件庞大而复杂。为了尝试找出 xml 结构，我在 paraview 中创建了 Boxes 和 Point 源，然后查看了它生成的状态文件。看起来很糟糕。

我只想说以简约的方式显示一个带有这些坐标的框和一个带有这些坐标的点。有人有想法么？不必一定在 C 或 paraview 中，因为我可以输出坐标并输入生成最终产品的任何内容。如果 Python + Matlab 能正常工作，它也能正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T13:46:47.150

所以我想出了一个不错的折衷方案。我从这里描述的 git 代码开始：

[http://www.shocksolution.com/microfluidics-and-biotechnology/visualization/python-vtk-paraview/](http://www.shocksolution.com/microfluidics-and-biotechnology/visualization/python-vtk-paraview/)

它只是一个python文件。要点是那里的代码允许您为点提供 x、y、z 位置和半径，并输出 VTK 格式的 XML 文件。因此，要制作粒子，我只需将 x、y、z 位置交给它，然后为所有粒子的半径设置一个常数。然后我只是在数据集上制作一个球形字形。

对于盒子，我使用完全相同的代码。对于每个盒子，我仍然输出 x,y,z 坐标，其中 x,y,z 值是盒子中心的坐标。然后对于“半径”参数，我使用立方体的边长。这很有效，因为在 paraview 中，我只是为这些框标出数据点。我使用框字形，并按标量缩放，其中标量是半径。如果您不定向框字形并将标量因子设置为 1，您将获得所需的结果。这是一个简单的例子，一切都是统一的：

![简单统一树](../Images/62141a3019dacceffc9c418cdcd53c7f.png)

所以我只是将我的 C 数据结构中的坐标输出到 CSV 文件，然后在 python 中拉入文件并使用链接中的代码并使用 paraview 打开结果。这是我在链接中使用代码的方式：

```
from vtktools import VTK_XML_Serial_Unstructured
import sys

if len(sys.argv) > 2:
    treeFile = sys.argv[1]
    bodyFile = sys.argv[2]
else:
    print 'No input files'
    exit(4)

x = []
y = []
z = []
r = []

f = open(treeFile, 'r')
for line in f:
    v = line.split(',')
    x.append(float(v[0].strip()))
    y.append(float(v[1].strip()))
    z.append(float(v[2].strip()))
    r.append(float(v[3].strip()))
f.close()

temp = treeFile.split('/')
if (len(temp) == 1):
    temp = temp[0]
else:
    temp = temp[-1]
tree_writer = VTK_XML_Serial_Unstructured()
tree_writer.snapshot(temp.split('.',1)[0] + '.vtu', x, y, z, [], [], [], [], [], [], r)
tree_writer.writePVD("octree.pvd")
x = []
y = []
z = []
r = []

f = open(bodyFile, 'r')
for line in f:
    v = line.split(',')
    x.append(float(v[0].strip()))
    y.append(float(v[1].strip()))
    z.append(float(v[2].strip()))
    r.append(float(v[3].strip()))
f.close()

temp = bodyFile.split('/')
if (len(temp) == 1):
    temp = temp[0]
else:
    temp = temp[-1]
body_writer = VTK_XML_Serial_Unstructured()
body_writer.snapshot(temp.split('.',1)[0] + '.vtu', x, y, z, [], [], [], [], [], [], r)
body_writer.writePVD("distribution.pvd") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T10:32:40.613

既然您的数据似乎并不复杂……为什么不将其导出为 CSV 文件？

您将能够从[ParaView](http://paraview.org/Wiki/ParaView/Data_formats#CSV_.28Comma_Separated_Variable.29_files)、[MATLAB](http://www.mathworks.es/help/matlab/ref/csvread.html;jsessionid=e0a7b36863f613677a5694c8f4c7)等打开它...此外，它是一个非常简单的实现。

如果您的数据不会变得比这更复杂，我会选择这个。

快乐编码！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:32:07.710

如果您的算法是纯 C 并且它正在生成静态或固定动画数据，您可能希望导出为 XML 格式或专有格式，这将打开许多选项。

Collada 是一种 XML 格式，旨在以与软件无关的方式表示 3D 对象，当然值得一看。然后，您可以在多个应用程序中打开以查看它，甚至是 Max 和 Maya，这意味着无需编码即可查看它。还有一些可用的引擎可以本地读取这些导出。

至于其他具体的可视化方式，这可能是一个完全开放式的答案，因此取决于您尝试可视化的项目数量以及您需要多少互动，这里有一些建议，但我知道这只是冰山一角.

Matlab 似乎非常擅长绘制数学图形，但我对它的相当过时的记忆是它操作起来非常缓慢且繁琐。

如果它是简单的 gouraud 阴影纹理的东西，并且你想要完全控制，那么就选择一个原生的 OpenGL 程序，因为现在那里没有什么太可怕的了。这也意味着您可以保留 C 代码。缺点是它确实需要更长的时间，特别是如果您需要处理相机控制或“像素质量”问题。即，如果您正在寻找阴影、动画、着色器效果等...请继续阅读...

如果它需要一些用户交互、一个独立的应用程序、更复杂的渲染并且数据集不是很大，或者您可以将其编译为 C#（即不使用指针），您可能想看看 Unity。它为您简化了一个数量级的 3D 渲染，您只需要编写 C# 来生成您想要渲染的网格/粒子并将一些简单的相机控件放入（或导入您的 collada 文件）。棘手的一点是，如果您是新手，则需要一两天时间来熟悉为您的目的生成网格。

或者，您可以通过 HTML5 在 WebGL 中对其进行编码，或者更好地使用其他人的 WebGL 系统来为您完成！

如果您选择这条路线，有一些项目值得一看。我最喜欢的是 PlayCanvas，如果您只需要生成它们，我相信它也会获取您的 collada 文件。

还有 SceneJS.org，它更原始，还没有亲自尝试过，但也应该提到它。

# javascript - jquery div滚动样式coverflow

> ID：12484104
> 
> 赞同：0
> 
> 时间：2012-09-18T19:59:07.597
> 
> 标签：javascript, jquery, html, css

我需要达到这个[效果](http://www.eyecon.ro/spacegallery/#about)

但我需要用容器（div）替换图像

就像是：

```
<div id="myGallery">
                <img src="http://static.flickr.com/66/199481236_dc98b5abb3_s.jpg" />
                <img src="http://static.flickr.com/75/199481072_b4a0d09597_s.jpg"  />
                <img src="http://static.flickr.com/57/199481087_33ae73a8de_s.jpg" />
                <img src="http://static.flickr.com/58/199481143_3c148d9dd3_s.jpg" />

            </div> 
```

经过

```
<div id="myGallery">
        <div id="item1">contenido uno</div>
        <div id="item2">contenido dos</div>
        <div id="item3">contenido tres</div>
        <div id="item4">contenido cuatro</div>
        </div> 
```

任何想法或任何插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:17:07.383

看看[这个演示](http://demo.rickyh.co.uk/spacegallery-moostyle/)——它看起来像你想要的那样，为了你的目的修改它的想法应该不会太难。

# mysql - 跨三个表查询一个唯一ID

> ID：12484105
> 
> 赞同：2
> 
> 时间：2012-09-18T19:59:17.347
> 
> 标签：mysql

我正在尝试查询三个不同表之一中存在的一个唯一 id 值。

这三个表具有分层的主键 ID 集，例如

```
t1 = 1-9 
t2 = 10-19 
t3 = 20-29 
```

这些表是`optgroup`菜单的一部分，PK 用作选择值。这是一个多选功能，因此用户最多可以选择 3 个值——它们都可以来自这些表中的一个，也可以来自每个表中的一个。

每个选择都存储在目标表的单独列中，例如`value1`，。如果仅传递一个值，则其他列为.`value2``value3``NULL`

我的问题——我有一个原始数据的 CSV 文件转储到临时表中。临时表中的每一行都有代表这些值的三个现有列，但它们当前也是在三个表中找到的字符串值，而不是`id`. 需要将此数据插入到另一个表设置中，并使用适用于该应用程序的适当 FK。

如何查询现有的三个表，查找与三个表`id`中的任何一个匹配的给定字符串的值，然后在同一查询中再执行 2 次，以获取临时表中剩余的“值”列排？

**编辑**

更多示例数据进行说明：

临时表中的数据：

```
temp
+---------+---------+---------+--------+
|  value1 |  value2 |  value3 |   user |
+---------+---------+---------+--------+
| primary |   light |     red |   greg | 
|     red |    blue |    NULL |  sarah |
| neutral |  orange |   green |    tim |
|    dark |    blue |   green |  laura |
+---------+---------+---------+--------+ 
```

需要插入到另一个表中。列的 id`valueX`存在于三个表中：

```
table 1
+---------+---------+
|      id |    name | 
+---------+---------+
|     003 | neutral |
|     004 |    dark |
|     005 |   light |
+---------+---------+

table 2
+---------+---------+
|      id |    name | 
+---------+---------+
|     010 |    blue | 
|     011 |  orange | 
|     012 |     red |
|     013 |   green |
+---------+---------+

table 3
+---------+---------------+
|      id |          name | 
+---------+---------------+
|     020 |       primary |
|     021 | complimentary |
|     022 |     secondary |
+---------+---------------+ 
```

临时表中的其他列（`user`在本例中）是插入的一部分，它会像这样填充目标表：

```
 target
    +---------+---------+---------+-------+
    |  value1 |  value2 |  value3 |  user |
    +---------+---------+---------+-------+
    |     020 |     005 |     012 |  greg |
    |     012 |     010 |    NULL | sarah |
    |     003 |     011 |     013 |   tim |
    |     004 |     010 |     013 | laura |
    +---------+---------+---------+-------+ 
```

我最接近的尝试是能够获取第一列值，但我不知道如何在同一个查询中获取其他两个值。

```
INSERT INTO target (user, value1, value2, value3)
SELECT t.user, a.id, X, X
FROM  temp t,  
      (SELECT * FROM table1
       UNION
       SELECT * FROM table2
       UNION    
       SELECT * FROM table3) as a
WHERE a.name = t.value1
AND X = t.value2
AND X = t.value3 
```

试图解决 X .. 我在这里完全脱离了我的元素，但这更接近于说明我想要完成的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T07:09:40.590

如果您可以创建视图，那么您可以创建所有表的并集并搜索该表以构建您的表。就像是：

```
CREATE VIEW all AS
  select * from table1 union
  select * from table2 union
  select * from table3;

SELECT
  (select id from all where name = value1) as value1,
  (select id from all where name = value2) as value2,
  (select id from all where name = value3) as value3,
  user
FROM temp; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:03:22.910

像这样的东西怎么样：

```
SELECT a.id, a.t_name
FROM
    (SELECT id, t1_name AS t_name FROM t1
    UNION ALL
    SELECT id, t2_name AS t_name FROM t2
    UNION ALL
    SELECT id, t2_name AS t_name FROM t3) a
WHERE a.id IN ('value1', 'value2', 'value3') 
```

**更新 1**

在得到一些样本数据后，我认为这是你想要去的方向：

```
SELECT a.v1, a.v2, a.v3
FROM
    (SELECT id AS v1, NULL AS v2, NULL AS v3 FROM t1
    UNION ALL
    SELECT NULL AS v1, id AS v2, NULL AS v3 FROM t2
    UNION ALL
    SELECT NULL AS v1, NULL AS v2, id AS v3 FROM t3) a
WHERE a.v1 = someId OR a.v2 = someId OR a.v3 = someId 
```

# c++ - 如何遍历 SAFEARRAY **

> ID：12484109
> 
> 赞同：11
> 
> 时间：2012-09-18T19:59:33.600
> 
> 标签：c++, com, safearray

如何遍历 C++ 安全数组指针指向指针并访问其元素。

我试图复制 Lim Bio Liong [http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/022dba14-9abf-4872-9f43-f4fc05bd2602](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/022dba14-9abf-4872-9f43-f4fc05bd2602)发布的解决方案， 但最奇怪的是 IDL方法签名出来是

```
HRESULT __stdcall GetTestStructArray([out] SAFEARRAY ** test_struct_array); 
```

代替

```
HRESULT __stdcall GetTestStructArray([out] SAFEARRAY(TestStruct)* test_struct_array); 
```

有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-18T20:12:23.187

Safearrays 是用`SafeArrayCreate`or创建的`SafeArrayCreateVector`，但是当您询问迭代 SAFEARRAY 时，假设您已经有一个由其他函数返回的 SAFEARRAY。一种方法是使用`SafeArrayGetElement`API，如果您有多维 SAFEARRAY，这将特别方便，因为它允许 IMO 更容易指定索引。

但是，对于向量（一维 SAFEARRAY），直接访问数据并迭代值会更快。这是一个例子：

假设它是`long`s 的 SAFEARRAY，即。VT_I4

```
// get them from somewhere. (I will assume that this is done 
// in a way that you are now responsible to free the memory)
SAFEARRAY* saValues = ... 
LONG* pVals;
HRESULT hr = SafeArrayAccessData(saValues, (void**)&pVals); // direct access to SA memory
if (SUCCEEDED(hr))
{
  long lowerBound, upperBound;  // get array bounds
  SafeArrayGetLBound(saValues, 1 , &lowerBound);
  SafeArrayGetUBound(saValues, 1, &upperBound);

  long cnt_elements = upperBound - lowerBound + 1; 
  for (int i = 0; i < cnt_elements; ++i)  // iterate through returned values
  {                              
    LONG lVal = pVals[i];   
    std::cout << "element " << i << ": value = " << lVal << std::endl;
  }       
  SafeArrayUnaccessData(saValues);
}
SafeArrayDestroy(saValues); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T20:05:24.627

MSDN [SafeArrayGetElement 函数](https://docs.microsoft.com/en-us/windows/desktop/api/oleauto/nf-oleauto-safearraygetelement)`SafeArrayGetElement`为您提供了用于获取单个对象到数组的代码片段。

[`SAFEARRAY`结构](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221482%28v=vs.85%29.aspx)和`SafeArray*`功能解释了可用的 API。

在 ATL/MFC 项目中，您可能希望使用包装类，例如`CComSafeArray`让事情变得更简单、更容易。请参阅[使用 CComSafeArray 简化 SAFEARRAY 编程](https://blogs.msmvps.com/gdicanio/2011/02/04/simplifying-safearray-programming-with-ccomsafearray/)。

# asp.net - 页面未重定向到默认错误页面

> ID：12484110
> 
> 赞同：1
> 
> 时间：2012-09-18T19:59:34.630
> 
> 标签：asp.net, vb.net, error-handling, devexpress, aspxgridview

我在 web.config 中定义了一个默认错误页面：

```
<customErrors mode="On" defaultRedirect="Erro_Padrao.aspx">
</customErrors> 
```

现在，我在我的一个页面中强制出错以测试错误页面：

```
Try
    Dim var1 As Integer = 1
    Dim var2 As Integer = 0
    Dim result As Integer = var1 / var2

Catch ex As Exception
    Throw ex
End Try 
```

错误发生但没有任何反应。

任何人？

谢谢你。

**编辑：**

我正在一个由 DevExpress 的 ASPxGridView 组件调用的方法中尝试这个。异常消息未显示在默认的 .NET 黄色错误页面中，但此网格以某种方式处理异常并“阻止”重定向（是的，错误消息是葡萄牙语）：

![在此处输入图像描述](../Images/a8022c2a6bfe68f7fcbd361c4341282e.png)

例如，如果我尝试在 page_load 事件中执行此操作，则默认错误页面的重定向工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:32:45.300

[在DevExpress 的 ASPxGridView](http://www.devexpress.com/Support/Center/p/Q273796.aspx)上找到一篇文章指出，**GridView 中任何未处理的异常都**将被**自动**捕获，并引发**CustomErrorEvent 。**仅查看[DevExpress 的文档](http://documentation.devexpress.com/#AspNet/DevExpressWebASPxGridViewASPxGridView_CustomErrorTexttopic)。

> CustomErrorText 事件在 ASPxGridView**中引发任何异常时发生**，并允许您更改默认显示的错误文本。如果您想本地化错误消息，这可能很有用。

# c# - 等待任务结果时会发生什么？

> ID：12484112
> 
> 赞同：47
> 
> 时间：2012-09-18T19:59:46.187
> 
> 标签：c#, asynchronous, task

我正在使用 HttpClient 将数据发布到 .NET 4.0 项目中的远程服务。我不关心这个操作阻塞，所以我想我可以跳过 ContinueWith 或 async/await 并使用 Result。

在调试时，我遇到了远程服务器没有响应的问题。当我单步执行代码时，我的代码似乎刚刚在第三行停止运行......当前堆栈指针行停止以黄色突出显示，并且没有前进到下一行。它就这样消失了。我花了一段时间才意识到我应该等待请求超时。

```
var client = new HttpClient();
var task = client.PostAsync("http://someservice/", someContent);
var response = task.Result; 
```

我的理解是在 Task 上调用 Result 会导致代码同步执行，表现得更像这样（我知道 HttpClient 中没有 Post 方法）：

```
var client = new HttpClient();
var response = client.Post("http://someservice/", someContent); 
```

我不确定这是一件坏事，我只是想弄清楚它。由于 HttpClient 正在返回任务而不是直接返回结果这一事实，我的应用程序是否真的会自动利用异步，即使我认为我正在避免它？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-09-18T20:32:25.393

在 Windows 中，所有 I/O 都是异步的。同步 API 只是一种方便的抽象。

因此，当您使用 时`HttpWebRequest.GetResponse`，实际发生的是 I/O 启动（异步），调用线程（同步）阻塞，等待它完成。

同样，当您使用 时`HttpClient.PostAsync(..).Result`，I/O 会（异步）启动，调用线程（同步）会阻塞，等待它完成。

我通常建议人们使用`await`而不是`Task.Result`或`Task.Wait`出于以下原因：

1.  如果你阻塞`Task`一个方法的结果`async`，你[很容易陷入死锁情况](http://blog.stephencleary.com/2012/07/dont-block-on-async-code.html)。
2.  `Task.Result`并将`Task.Wait`任何异常包装在一个中`AggregateException`（因为这些 API 是 TPL 的保留）。所以错误处理更加复杂。

但是，如果您知道这些限制，那么在某些情况下阻止 a`Task`可能很有用（例如，在控制台应用程序的 中`Main`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-04-27T08:02:22.473

捕获任务的结果会阻塞当前线程。在这种情况下，使用异步版本的方法是没有意义的。`Post()`并且`PostAsync().Result`都会阻塞。

如果你想利用并发，你应该这样写：

```
async Task PostContent()
{
  var client = new HttpClient();
  Task t = await client.PostAsync("http://someservice/", someContent);
  //code after this line will execute when the PostAsync completes.
  return t;
} 
```

由于`PostContent()`本身返回一个任务，调用它的方法也应该等待。

```
async void ProcessResult()
{
   var result = await PostContent(); 
   //Do work with the result when the result is ready 
} 
```

例如，如果您调用`ProcessResult()`按钮单击处理程序，您会看到 UI 仍然是响应式的，其他控件仍然起作用。

# python - python网络爬虫中的递归

> ID：12484113
> 
> 赞同：3
> 
> 时间：2012-09-18T19:59:50.680
> 
> 标签：python

我正在尝试在 python 中制作一个小的网络爬虫。现在似乎让我绊倒的是这个问题的递归部分和深度。给定一个 url 和一个我想链接到的站点的最大深度，然后将 url 添加到搜索的站点集，并从站点下载所有文本和链接。对于 url 中包含的所有链接，我想搜索每个链接并获取它的单词和链接。问题是，当我去递归调用下一个 url 时，深度已经是 maxDepth 并且它在只多一页后停止。希望我能体面地解释它，基本上我要问的问题是如何进行所有递归调用，然后设置 self._depth += 1？

```
def crawl(self,url,maxDepth):        

    self._listOfCrawled.add(url)

    text = crawler_util.textFromURL(url).split()

    for each in text:
        self._index[each] = url

    links = crawler_util.linksFromURL(url)

    if self._depth < maxDepth:
        self._depth = self._depth + 1
        for i in links:
            if i not in self._listOfCrawled:
                self.crawl(i,maxDepth) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:45:44.307

您的代码的问题是`self.depth`每次调用函数时都会增加，并且由于它是实例的变量，因此在以下调用中它会*保持增加。*假设`maxDepth`是 3，并且您有一个`A`链接到页面的 URL`B`和`C`，并且`B`链接到`D`，并且`C`有一个链接到`E`。然后，您的调用层次结构如下所示（假设`self._depth`开头为 0）：

```
crawl(self, A, 3)          # self._depth set to 1, following links to B and C
    crawl(self, B, 3)      # self._depth set to 2, following link to D
        crawl(self, D, 3)  # self._depth set to 3, no links to follow
    crawl(self, C, 3)      # self._depth >= maxDepth, skipping link to E 
```

换句话说，您跟踪对 的*累计*调用次数，而不是`depth`当前调用。*`crawl`*

 *相反，尝试这样的事情：

```
def crawl(self,url,depthToGo):
    # call this method with depthToGo set to maxDepth
    self._listOfCrawled.add(url)
    text = crawler_util.textFromURL(url).split()
    for each in text:
        # if word not in index, create a new set, then add URL to set
        if each not in self._index:
            self._index[each] = set([])
        self._index[each].add(url)
    links = crawler_util.linksFromURL(url)
    # check if we can go deeper
    if depthToGo > 0:
        for i in links:
            if i not in self._listOfCrawled:
                # decrease depthToGo for next level of recursion
                self.crawl(i, depthToGo - 1) 
```*

# sql - 使用 Select Into MULTIPLE 变量处理 NO_DATA_FOUND 异常

> ID：12484115
> 
> 赞同：0
> 
> 时间：2012-09-18T19:59:56.720
> 
> 标签：sql, oracle

我已经寻找了一段时间来寻找解决这个问题的方法，我发现的所有 NO_DATA_FOUND 处理教程只展示了如何在仅将一列放入一个变量的情况下进行 Select Into 操作。

首先，这是我的代码：

```
BEGIN 
    OPEN c_no_source; 
    LOOP 
        DECLARE 
            l_price_code  VARCHAR2(20) := ''; 
            l_price_level VARCHAR(10) := ''; 
            l_code_date   DATE := p_effective_date; 
        BEGIN 
            FETCH c_no_source INTO c_no_source_row;
                exit WHEN c_no_source%NOTFOUND;
            BEGIN 
                WITH codeList AS /* liste des dates ayant une donnée avant la date effective incluse. */
                (
                    SELECT distinct
                        NVL(effective_date,p_effective_date) as effective_date,
                        NVL(user_group2,'') as price_code, 
                        NVL(user_group3,'') as price_level
                    FROM  DGA_Service.Hjvsecmaster_Hist
                    WHERE   effective_date <= p_effective_date
                        AND user_group2 IS NOT NULL
                        AND security_alias = c_no_source_row.security_alias
                    ORDER BY 1 DESC
                )
                SELECT price_code, price_level, effective_date 
                INTO   l_price_code, l_price_level, l_code_date 
                FROM   codelist 
                WHERE  ROWNUM = 1; 
                EXCEPTION WHEN no_data_found THEN NULL;

                ...
                [UPDATE statement using the variables] 
                ...
            END; 
        END; 
    END LOOP; 

    CLOSE c_no_source; 
END; 
```

我要做的是将我的`codeList`临时结果集的前 1 个结果放入三个单独的变量中。但是，其中的三列之一`codeList`通常是`NULL`. 我的 3 个变量都不会设置。我试图处理异常，但我无法让我的代码将具有值的列插入到它们各自的变量中。如果即使其中一列是 NULL，那么它们都不会插入到它们的变量中。

我希望 Select Into 语句设置它可以设置的变量。

我尝试使用以下方法分别处理它们：

```
EXCEPTION WHEN NO_DATA_FOUND THEN
    BEGIN
        IF price_code IS NOT NULL THEN l_price_code := price_code; END IF;
        IF price_level IS NOT NULL THEN l_price_level := price_level; END IF;
        IF effective_date IS NOT NULL THEN l_code_date := effective_date; END IF;
    END; 
```

但我收到以下错误消息：

```
ORA-06550: line 294, column 18:
PLS-00201: identifier 'PRICE_CODE' must be declared
ORA-06550: line 294, column 15:
PL/SQL: Statement ignored
ORA-06550: line 295, column 18:
PLS-00201: identifier 'PRICE_LEVEL' must be declared
ORA-06550: line 295, column 15:
PL/SQL: Statement ignored
ORA-06550: line 296, column 18:
PLS-00201: identifier 'EFFECTIVE_DATE' must be declared
ORA-06550: line 296, column 15:
PL/SQL: Statement ignored 
```

所以我没有主意了。我尝试指定临时表名称，但无济于事，如下所示：

```
IF codeList.price_code IS NOT NULL 
```

我很想在这个问题上提供任何帮助。这段代码运行的包已经很重了，我不想让每一列都有一个单独的`With ... As () Select Into`子句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:27:45.817

好吧，我想我明白了；您的大部分问题是由于您错误地嵌套 PL/SQL 块引起的。

您的更新语句包含在 EXCEPTION 块中，这意味着只有在引发异常时才会执行它。其次，您在以下内容中直接引用*列*：

```
EXCEPTION WHEN NO_DATA_FOUND THEN
    BEGIN
        IF price_code IS NOT NULL THEN l_price_code := price_code; END IF;
        IF price_level IS NOT NULL THEN l_price_level := price_level; END IF;
        IF effective_date IS NOT NULL THEN l_code_date := effective_date; END IF;
    END; 
```

这是您的编译错误的原因。

最后，如果您的文件中只有一行，`select into`那么*每个*变量都将被设置，因此无需尝试处理此问题。

```
BEGIN 
    OPEN c_no_source; 
    LOOP 
        DECLARE 
            l_price_code  VARCHAR2(20); 
            l_price_level VARCHAR(10); 
            l_code_date   DATE := p_effective_date; 
        BEGIN 
            FETCH c_no_source INTO c_no_source_row;
                exit WHEN c_no_source%NOTFOUND;
            BEGIN 
                WITH codelist AS (
                 SELECT DISTINCT effective_date
                      , user_group2 AS price_code
                      , user_group3 AS price_level 
                   FROM hjvsecmaster_hist 
                   WHERE effective_date <= p_effective_date 
                     AND user_group2 IS NOT NULL 
                     AND security_alias = c_no_source_row.security_alias 
                   ORDER BY 1 DESC
                ) 
                SELECT price_code, price_level, effective_date 
                INTO   l_price_code, l_price_level, l_code_date 
                FROM   codelist 
                WHERE  ROWNUM = 1; 
                EXCEPTION WHEN no_data_found THEN
                   -- All variables are their initial setting
                   null;
            END; 
           ...
              [UPDATE statement using the variables] 
           ...
        END; 
    END LOOP; 

    CLOSE c_no_source; 
END; 
```

这通常是一种非常低效的方法。如果您可以将所有内容放入单个 UPDATE 或[MERGE](http://psoug.org/reference/merge.html)中，那么我会这样做。你似乎没有任何额外的逻辑，所以它应该是可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:23:48.327

> 然而，三个变量之一通常为 NULL，并触发 NO_DATA_FOUND 错误，并且我的 3 个变量都不会设置

当查询没有返回任何**行时**，会引发 NO_DATA_FOUND 。它与列值无关。它们都可以为空，并且该语句将成功。

```
EXCEPTION WHEN NO_DATA_FOUND THEN
    BEGIN
        IF price_code IS NOT NULL THEN l_price_code := price_code; END IF;
        IF price_level IS NOT NULL THEN l_price_level := price_level; END IF;
        IF effective_date IS NOT NULL THEN l_code_date := effective_date; END IF;
    END; 
```

您的变量以“l_”为前缀，并且您在比较中使用了列名 eg.price_code，因此出现错误。**更重要的是，NO_DATA_FOUND 意味着所有的变量值都是空的，所以这个异常块不做任何事情。**

你可能需要的就是这个。

如果您不想为给定的 id 插入空值（如果全部为空）

```
BEGIN
   insert into target_table (id, col1, col2, col3)
   select id, col1, col2, col3
     from (target_table)
     where not (col1 is null and col2 is null and col3 is null);
   commit;
end;
/ 
```

如果给定 id 没有数据，则不插入任何内容。如果其中至少一个不为空，则插入这些值。

# ruby-on-rails - Ruby/Rails：解析文件并从解析的数据创建活动记录关联

> ID：12484122
> 
> 赞同：0
> 
> 时间：2012-09-18T20:00:21.587
> 
> 标签：ruby-on-rails, ruby, regex, parsing

我有一大堆需要解析的文本文件（见下文）。它们包含我想要捕获并用于创建关联记录的章节信息。`Report has_many :chapters`

基本上我需要阅读每一行并为每个`BookmarkTitle`捕获章节名称（忽略 CR `&#13;`），然后捕获`BookmarkPageNumber`. 然后捆绑配对并用它创建一个新记录：`report.page.create(title: bookmark_title, page_number: bookmark_page_number)`

我玩了一点[IO](http://www.ruby-doc.org/core-1.9.3/IO.html#method-c-readlines)的 readline 但不确定如何捕获内容......也许是正则表达式？还是更多的 Rails 方式？

示例 txt 文件：

```
InfoKey: Creator
InfoValue: Adobe Acrobat 9.3.4
InfoKey: Producer
InfoValue: Adobe Acrobat 9.34 Paper Capture Plug-in
InfoKey: ModDate
InfoValue: D:20110315193536-04'00'
InfoKey: CreationDate
InfoValue: D:20110208171413-05'00'
PdfID0: 2dab1ce43882a53cbc24dbb839f921f8
PdfID1: 43b19192e920f38f65de0bf0a2be
NumberOfPages: 258
BookmarkTitle: 1980 Field Service Annual Report&#13;
BookmarkLevel: 1
BookmarkPageNumber: 3
BookmarkTitle: TABLE OF CONTENTS&#13;
BookmarkLevel: 1
BookmarkPageNumber: 4
BookmarkTitle: LIST OF EXHIBITS&#13;
BookmarkLevel: 1
BookmarkPageNumber: 7
BookmarkTitle: I - INTRODUCTION&#13;
BookmarkLevel: 1
BookmarkPageNumber: 11
BookmarkTitle: II - EXECUTIVE SUMMARY&#13;
BookmarkLevel: 1
BookmarkPageNumber: 16
BookmarkTitle: III - RESULTS AND ANALYSIS OF THE MAINTENANCE USER SURVEY&#13;
BookmarkLevel: 1
BookmarkPageNumber: 45
BookmarkTitle: IV - COMPARATIVE ANALYSIS OF BIGCO AND OTHER MAINTENANCE VENDORS&#13;
BookmarkLevel: 1
BookmarkPageNumber: 102
BookmarkTitle: V - RESULTS OF VENDOR SURVEY&#13;
BookmarkLevel: 1
BookmarkPageNumber: 127
BookmarkTitle: VI - SIGNIFICANT VENDOR ACTIVITIES, 1979-1980&#13;
BookmarkLevel: 1
BookmarkPageNumber: 190
BookmarkTitle: APPENDIX A:  DEFINITIONS&#13;
BookmarkLevel: 1
BookmarkPageNumber: 199
BookmarkTitle: APPENDIX B:  RESEARCH METHODOLOGY&#13;
BookmarkLevel: 1
BookmarkPageNumber: 204
BookmarkTitle: APPENDIX C:  SUPPORTING CHARTS&#13;
BookmarkLevel: 1
BookmarkPageNumber: 211
BookmarkTitle: APPENDIX D:  USER QUESTIONNAIRE&#13;
BookmarkLevel: 1
BookmarkPageNumber: 222
BookmarkTitle: APPENDIX E:  VENDOR QUESTIONNAIRE&#13;
BookmarkLevel: 1
BookmarkPageNumber: 237 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:42:01.130

```
/^BookmarkTitle:\s*(.+?)&#13;\s*BookmarkLevel:\s*(\d+)\s*BookmarkPageNumber:\s*(\d+)\s*$/m 
```

抱歉，我不是 Ruby-On-Rails 开发人员，但该正则表达式将匹配每个书签，并返回：

*   整个记录
*   标题（作为子匹配）
*   级别（作为子匹配）
*   页码（作为子匹配项）

它确实假定级别和页码是没有空格、逗号或小数的数字。但这很容易改变。

# linux - 用于发现设备文件系统的 Linux 系统调用

> ID：12484123
> 
> 赞同：3
> 
> 时间：2012-09-18T20:00:24.580
> 
> 标签：linux, filesystems, system

我的问题如下：我需要获取设备的文件系统（在我的情况下是 pendrive）才能使用此信息。我的应用程序在 Linux 嵌入式系统中运行，我只想接受具有 FAT 和 FAT32 文件系统的笔式驱动器来执行文件导出。我搜索了互联网，但我没有找到我需要的系统调用。关于源代码，我的应用程序是用 C++ 编写的。

我已经使用了 struct statfs，但是经过测试，我发现当我使用 NTFS 和 FAT32 格式的 pendrive 时，字段 f_type 的值是相同的。测试的输出是值 0x1021994。

我知道可以发现文件系统，“fdisk -l”命令可以完成这项工作，但是我无法在 fdisk 代码中弄清楚如何。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:07:56.700

You can use the `statfs` [system call](http://www.kernel.org/doc/man-pages/online/pages/man2/statfs.2.html) which includes `uint32_t f_type; /* type of filesystem */` in the returned `struct statfs`

* * *

**Note** that, as [JoshuaRLi](https://stackoverflow.com/users/5348393/joshuarli) points out, `statfs` is now deprecated in favor of `statvfs` — and `struct statvfs` does ***not*** include an `f_type` field.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:05:10.883

The easiest way is:

1) Run the ["mount"](http://linux.die.net/man/8/mount) command to list one or more filesystems

2) Parse out the information you need

3) You can invoke "mount" from the ["popen()"](http://linux.die.net/man/3/popen) API

PS:

There's also a ["mount()"](http://linux.die.net/man/2/mount) API, which could eliminate steps 2) and 3), if you prefer.

Linux being Linux, there's also probably at least half a dozen other viable alternatives - your choice :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:06:55.097

Maybe you could parse `/proc/mounts` file?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T22:15:27.310

挂载时指定文件系统类型（不要使用默认值`-t auto`）。如果您需要支持多种类型，请考虑全部尝试。

# javascript - SyntaxError: Unexpected token : 在 Chrome 中使用 Ajax 和 Facebook JS API 时

> ID：12484124
> 
> 赞同：1
> 
> 时间：2012-09-18T20:00:28.543
> 
> 标签：javascript, ajax, facebook, json, jquery

好的，我正在使用 PHP 和 Facebook JS API 使用 jQuery 的 $.ajax() 函数在用户页面上发布故事，除了 Chrome 之外，它在任何地方都可以正常工作。

Chrome 返回错误“SyntaxError: Unexpected Token:”。

我让它在错误时提醒 XHR 响应，如下所示：

`{ "id" : "30800681_37922830145443" }`

这是有效的 JSON。这不可能是我对 JSON 结果做错的任何事情，因为它会在任何解析完成之前抛出错误（即，它没有进入“成功”函数）。

这背后的代码如下：

```
if ($('#post-facebook').is(":checked")) {
    // Do the FB post

    $.ajax({
        type: "POST",
        url: "https://graph.facebook.com/<?= $this->session->userdata('fb_id') ?>/feed",
        data: "message=" + $("#upload-caption").val() + "&access_token=<?= $this->session->userdata('fbtoken'); ?>&app_id=<?= $this->config->item('appId') ?>&link=" + post_url,
    success: function(msg) {

            // Save the FB post ID to the DB
            var result = $.parseJSON(msg);
            var result_array = result.id.split("_");

            // Do more stuff here, but it's not even getting into this success function
        },                                         
        error: function(xhr,ajaxOptions,thrownError) {

            // This is what's executing because the thrown error is getting alerted
            alert(thrownError);
        }
    });
} 
```

当我添加`dataType: "json"`Ajax 参数时，它仍然通过 Error 函数，但`thrownError`参数为空。

我正在拔头发……有什么建议吗？提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T01:03:20.030

无法将 jQuery 与 post 一起使用，因为 POST 需要 CORS 支持，而这并不容易获得。改用`FB.api`它，它会以更好的方式为您处理所有这些。

# asp.net-mvc-3 - html.dropdownlistfor() 麻烦...获取空引用异常

> ID：12484125
> 
> 赞同：0
> 
> 时间：2012-09-18T20:00:34.660
> 
> 标签：asp.net-mvc-3, html.dropdownlistfor

我尝试按照这里的一些示例和其他一些资源来在我的视图模型中创建一个非常简单的成员，并使用 dropdownlistfor() 帮助器在我的视图中将其显示为下拉列表。我似乎无法绕过它，而且它不适用于我正在尝试的东西。

这是我的视图模型：

```
public class Car
{
    public int CarId { get; set; }
    public string Name { get; set; }
}

public class MyViewModel
{

    public IEnumerable<Car> Cars = new List<Car> { 
        new Car {
            CarId = 1,
            Name = "Volvo"
        },
        new Car {
            CarId = 2,
            Name = "Subaru"
        }
    };

    public int MyCarId { get; set; }
} 
```

这是我的观点：

```
@Html.DropDownListFor(m => m.MyCarId, new SelectList(Model.Cars, "CarId", "Name")) 
```

这是我的控制器：

```
public ActionResult MyView()
        {
            return View();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:25:48.970

您需要确保将模型发送到您的视图：

```
public ActionResult Index()
{
    var myViewModel = new MyViewModel()

    return View(myViewModel);
} 
```

在您的视图中，您需要确保定义您的模型：

```
@model namespace.MyViewModel 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:17:08.107

您的示例工作正常，我认为您忘记在 POST 操作中发送 MyViewModel 。

```
[HttpPost]
public ActionResult Index(MyViewModel model)
{
    return View(model);
} 
```

# eclipse - 如何以编程方式从 .zip 文件导入 Eclipse 项目？

> ID：12484128
> 
> 赞同：3
> 
> 时间：2012-09-18T20:00:41.337
> 
> 标签：eclipse, import, eclipse-plugin

我试图弄清楚如何以`.zip`编程方式从存档文件 (a) 导入 Eclipse 项目 - 我想做导入向导所做的同样的事情，但自动（使用向导定期重新导入同一个项目开始感觉真的很啰嗦）。我发现了一些相关的问题（例如[，以编程方式将现有项目导入 Eclipse](https://stackoverflow.com/questions/12401297/programmatically-importing-an-existing-project-into-eclipse)），但我不知道如何让同样的事情为`.zip`导入工作。

我目前的想法如下：如果我可以从`.zip`某种方式获得项目描述，那么我可以以编程方式创建项目（根据引用的问题）。从那里，我希望我可以：

*   为该文件创建一个`ZipLeveledStructureProvider`( [http://javasourcecode.org/html/open-source/eclipse/eclipse-3.5.2/org/eclipse/ui/internal/wizards/datatransfer/ZipLeveledStructureProvider.java.html )。](http://javasourcecode.org/html/open-source/eclipse/eclipse-3.5.2/org/eclipse/ui/internal/wizards/datatransfer/ZipLeveledStructureProvider.java.html)`.zip`
*   运行`ImportOperation`（[http://javasourcecode.org/html/open-source/eclipse/eclipse-3.5.2/org/eclipse/ui/wizards/datatransfer/ImportOperation.java.html](http://javasourcecode.org/html/open-source/eclipse/eclipse-3.5.2/org/eclipse/ui/wizards/datatransfer/ImportOperation.java.html)）将内容导入`.zip`到创建的项目。

这有道理吗？（如果没有，请问我应该怎么做？）如果是，我应该如何从`.zip`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:42:45.930

对于它的价值，这似乎有效（预先整理）：

```
IWorkspace workspace = this.project.getWorkspace();
IProjectDescription newProjectDescription = workspace.newProjectDescription(projectName);
IProject newProject = workspace.getRoot().getProject(projectName);
newProject.create(newProjectDescription, null);
newProject.open(null);

zipFile = new ZipFile(workspace.getRoot().getLocation() + "/" + projectName + ".zip");
IOverwriteQuery overwriteQuery = new IOverwriteQuery() {
    public String queryOverwrite(String file) { return ALL; }
};
ZipLeveledStructureProvider provider = new ZipLeveledStructureProvider(zipFile);
List<Object> fileSystemObjects = new ArrayList<Object>();
Enumeration<? extends ZipEntry> entries = zipFile.entries();
while (entries.hasMoreElements()) {
    fileSystemObjects.add((Object)entries.nextElement());
}
ImportOperation importOperation = new ImportOperation(newProject.getFullPath(), new ZipEntry(projectName), provider, overwriteQuery, fileSystemObjects);
importOperation.setCreateContainerStructure(false);
importOperation.run(new NullProgressMonitor()); 
```

# c# - 带有 2 个动作的单行 if 语句

> ID：12484133
> 
> 赞同：36
> 
> 时间：2012-09-18T20:01:04.307
> 
> 标签：c#, if-statement, action

我想做一个多于 1 个动作的单行 if 语句。

默认是这样的：

```
(if) ? then : else

userType = (user.Type == 0) ? "Admin" : "User"; 
```

但我不仅需要“else”，还需要“else if”

像多行一样：

```
if (user.Type == 0)
    userType = "Admin" 
else if (user.Type == 1)
    userType = "User"
else if (user.Type == 2)
    userType = "Employee" 
```

单行有可能吗？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-09-18T20:01:57.240

听起来你真的想要一个`Dictionary<int, string>`或可能是一个`switch`声明......

您*可以*使用条件运算符来做到这一点：

```
userType = user.Type == 0 ? "Admin"
         : user.Type == 1 ? "User"
         : user.Type == 2 ? "Employee"
         : "The default you didn't specify"; 
```

尽管您*可以*将其放在一行中，但我强烈建议您不要这样做。

不过，我通常*只会*在不同的条件下这样做——不仅仅是几个不同的可能值，这在地图中处理得更好。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-09-18T20:02:20.677

```
userType = (user.Type == 0) ? "Admin" : (user.type == 1) ? "User" : "Admin"; 
```

应该做的伎俩。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-18T20:02:14.223

您*可以*将其写在单行中，但这不是某人能够阅读的内容。保持它就像你已经写的那样，它本身就已经很漂亮了。

如果您有太多的`if/else`结构，您可能会考虑使用不同的数据结构，例如`Dictionaries`（查找键）或`Collection`（对其运行条件`LINQ`查询）

# python - 优化 pytables/HDF5 的 chunkshape 参数以读取整列

> ID：12484140
> 
> 赞同：1
> 
> 时间：2012-09-18T20:01:32.633
> 
> 标签：python, hdf5, pytables

我试图通过`chunkshape`在创建表时指定来提高我的 pytables/HDF5 代码的性能。我无法弄清楚`chunkshape`参数的真实尺寸或格式。我可以从代码中看到，它最终会成为一个包含单个元素的元组。

这个单个元素应该是行数、字节数还是什么？

我的具体问题是我现有的代码可以创建一个包含 20 列的 HDF5 表。我想更改表的块，以便每列连续存储在磁盘上。因此，优化一次读取整个列。

我尝试将 chunkshape 设置为 20（列数），但这大大降低了读取整列的性能。是否应该将块形状设置为单行的宽度（以字节为单位）？

我只想知道如果出现以下情况，chunkshape 应该是什么：

1.  我想尽可能快地阅读整个专栏。
2.  我确切地知道表中有多少列。
3.  出于向后兼容的原因，我不能简单地将表更改为将现有行作为列，反之亦然。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T08:00:02.830

`chunkshape`in`PyTables`指定应该连续存储在磁盘上的每行和每列的元素数（这就是它是元组的原因）。

因此，例如，如果您的数据集是 10,000 x 20（10,000 行，20 列）并且您总是一次访问一列，那么在给定最佳块大小的情况下，每个块应包含尽可能多的列（参见[此处](http://pytables.github.com/usersguide/optimization.html)更多细节）。

如果您知道您将拥有多少行并且它们不是那么大，您可以指定一个块形状`(10.000,1)`（或更少的行）。因此，如果您访问所有 20 列，则需要 20 次访问。

# javascript - 表单提交上日期字段的 EXT-JS 日期格式

> ID：12484142
> 
> 赞同：4
> 
> 时间：2012-09-18T20:01:43.223
> 
> 标签：javascript, extjs

我正在使用 EXT JS 构建一个允许用户输入的表单。其中一个字段是日期字段，当提交表单时，我希望通过 HTTP 发送的值是日期的“长”值（或毫秒）表示，而不是正常的：'dd/mm/yyyy'格式。

我搜索了很多，找不到任何答案。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T20:23:44.970

您可以使用其配置配置日期字段的提交日期值的格式[`submitFormat`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.field.Date-cfg-submitFormat)。尝试：

`submitFormat: 'U000'`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-02T15:54:37.253

在 ExtJs 3.x 中没有`submitFormat`default 的配置属性`datefield`，但在 4.x 中它是。

有几个自定义创建的插件/扩展，可以提供帮助。
例如： [XDateField](http://www.sencha.com/forum/showthread.php?25900-XDateField-with-configurable-submitFormat)和[DatePickerPlus](http://www.sencha.com/forum/showthread.php?31553-Ext.ux.DatePickerPlus-MultiMonth-MultiSelection-WeekNumbers-Custom-CSS-Days-...&p=148587)

# asp.net-mvc-3 - 如何防止用户修改表单上的某些字段？

> ID：12484143
> 
> 赞同：0
> 
> 时间：2012-09-18T20:01:43.333
> 
> 标签：asp.net-mvc-3, entity-framework

我正在使用 MVC3 和 EF4 编写 Web 应用程序。我正在使用如下所示的操作标头来捕获用户提交的表单值。

```
<HttpPost()>
Public Function Edit(ByVal prod as Product) As ActionResult 
```

我使用下面的代码来更新记录。

```
db.Attach(prod)
db.ObjectStateManager.ChangeObjectState(prod, EntityState.Modified)
db.SaveChanges() 
```

我在数据库中更新了 prod 对象中的提交值。问题是有些用户不允许修改产品中的某些字段，比如 ProductCost。我已禁用 HTML 中此类字段的文本框。但由于它是客户端，用户可以使用 Firebug 等工具轻松启用它并修改值。

我能想到的唯一解决方案是从数据库中检索现有记录并将其 ProductCost 值复制到 prod.ProductCost 中。但我不喜欢为实现这一目标而发起查询。有没有更好的方法来实现这一目标？

**编辑**：我找到了以下链接来更新特定字段。[如何使用实体框架只更新一个字段？](https://stackoverflow.com/questions/3642371/how-to-update-only-one-field-using-entity-framework)

您可以使用以下代码修改特定字段。

```
context.ObjectStateManager.GetObjectStateEntry(user).SetModifiedProperty("FieldName"); 
```

现在的问题是我是否必须为用户能够修改的每个字段编写上述语句？如果是，假设 Product 模型有 10 个字段（1 个主键），并且允许用户修改除主键之外的所有字段，我需要编写 9 条语句？有没有一种方法可以一次指定多个属性。或者甚至更好的是您指定未修改的属性。（注意：我知道我可以在字段名称数组上运行循环以避免编写 9 条语句。我要求另一种方法而不是重构上述方法）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:18:05.417

**永远不要相信客户数据。**始终让您的服务器代码验证输入并执行适当的操作。

我会创建我的呼吸方法的单独**重载**以不同的方式更新产品，然后检查当前用户的访问类型是什么，如果他是管理员，我将调用更新所有内容的重载，如果他是经理，我将调用更新名称、图像网址和价格的方法，如果他是员工，我将调用仅更新名称和图像网址的方法

```
[HttpPost]
public ActionResult Edit(Product prod)
{
  if(ModelState.IsValid) 
  {
    string userType=GetCurrentUserTypeFromSomeWhere();
    if(userType=="admin")
    {
       repo.UpdateProduct(prod);
    }
    else if(userType=="manager")
    {
       repo.UpdateProduct(prod.ID, prod.Name, prod.ImageUrl, prod.Price);
    } 
    else if(userType=="employee")
    {
       repo.UpdateProduct(prod.ID, prod.Name, prod.ImageUrl);
    } 
    return RedirectToAction("Updated",new {id=prod.ID});
  }

} 
```

# asp.net - ASP.NET URL 导航

> ID：12484145
> 
> 赞同：3
> 
> 时间：2012-09-18T20:01:56.217
> 
> 标签：asp.net

我有 asp.net 按钮，在它的按钮上单击我正在使用重定向它

```
Response.Redirect ("SomeURL.aspx"); 
```

我没有向 SomeURL.aspx 传递任何东西。这可以在不往返服务器的情况下实现吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T20:04:20.523

You could use an html anchor tag. This is the simplest approach and probably the best since anchors are the proper control to allow navigation.

```
<a href="SomeUrl.aspx">My link</a> 
```

If you still want to use the asp.net button you could do something like this

```
<asp:Button runat="server" ID="myButton"
  OnClientClick="window.location.href='SomeURL.aspx'; return false;"
  Text="Submit"></asp:Button> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:04:09.583

您可以尝试使用此代码 - 基于`Javascript Navigate`

```
window.navigate("SomeURL.aspx"); 
```

样本

```
 <input type="button" value="Navigate to SomeURL" onclick="funcNavigate();"> 

  <script language="JavaScript">
  function funcNavigate() {
  window.navigate("SomeURL.aspx");
  }
  </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:04:00.837

> 这可以在不往返服务器的情况下实现吗？

不使用后面的代码。

但是，您可以连接客户端单击处理程序或使用超链接来完成相同的操作。

```
<button onclick="window.location='SomeURL.aspx'; return false;">Some URL</a> 
```

或者

```
<a href="SomeURL.aspx">Some URL</a> 
```

超链接是最简单的答案。

# plsql - 包中的“实例”变量

> ID：12484148
> 
> 赞同：0
> 
> 时间：2012-09-18T20:02:10.837
> 
> 标签：plsql

我想在 PL/SQL 中创建一个专用的电子邮件发送包。每个电子邮件组件（发件人、收件人、主题、消息等）都有单独的程序。问题是如果多个作业同时调用电子邮件程序，包中的变量将被覆盖。

我将如何解决这个问题？我可以收到包裹的“实例”吗？或者在包中有实例变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T06:41:25.153

每个作业都有自己的会话，因此即使您更改作业会话内的任何变量，该值也不会在其他会话中看到。所以我不明白你的问题。此外，您的电子邮件发件人将具有类似 send_email(cc, from, to) 的过程，因此作业将使用不同的参数调用发件人，那么您需要变量做什么？

# wix - WIX 安装程序升级

> ID：12484151
> 
> 赞同：1
> 
> 时间：2012-09-18T20:02:25.020
> 
> 标签：wix, windows-installer, upgrade

我正在尝试使用 WIX 创建一个 MSI，我似乎偶然发现了一个小问题，这让我在升级方面有点困惑。我已经关注了大约 3 个关于该主题的教程，每个教程都给了我相同的结果。当我尝试升级应用程序时，我得到了一个通用的

> 该产品的另一个版本已安装。

信息。环顾四周后，我发现为了成功升级，我需要指定一个新的产品 G​​UID。这对我来说似乎很奇怪，因为主要的 WiX 网站说只有主要安装才需要这样做。由于我运气不佳，我决定继续使用它。瞧，它成功执行了安装程序，但是当我签入添加/删除程序时，我现在安装了 2 个应用程序副本。这真让我抓狂。请参阅下面的 .wxs，并在适用的情况下向我展示我的错误。

```
<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"> 
```

```
<Product Id="PRODUCT-GUID-GOES-HERE-B86BCC79EEFD" Name="Sample Application" Language="1033" Version="$(var.ProductVersion)" Manufacturer="Sample Inc." UpgradeCode="$(var.UpgradeCode)">
    <Package Id="*" Keywords="Installer" Platform="x64" InstallerVersion="200" InstallPrivileges="elevated" InstallScope="perMachine" Compressed="yes" />

<Upgrade Id="$(var.UpgradeCode)">
  <UpgradeVersion Minimum="$(var.ProductVersion)" IncludeMinimum="no" OnlyDetect="yes" Language="1033" Property="NEWPRODUCTFOUND" />
  <UpgradeVersion Minimum="$(var.RTMProductVersion)" IncludeMinimum="no" Maximum="$(var.ProductVersion)" IncludeMaximum="no" Language="1033" Property="UPGRADEFOUND" />
</Upgrade>

    <Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
        <Directory Id="ProgramFiles64Folder">
    <Directory Id="Sample" Name="Sample">
      <Directory Id="INSTALLLOCATION" Name="Sample Application">
        <!-- TODO: Remove the comments around this Component element and the ComponentRef below in order to add resources to this installer. -->
        <Component Id="SampleApplication" Guid="APPLICATION-GUID-GOES-HERE-c7247f5d1b42" Win64="yes">
        <!-- TODO: Insert files, registry keys, and other resources here. -->
          <File Id="SampleEXE" Name="Sample.exe" Source="Sample.exe" ProcessorArchitecture="x64" KeyPath="yes" />
        </Component>
      </Directory>
    </Directory>
        </Directory>
    </Directory>

    <Feature Id="Complete" Title="sample64" Level="1">
        <!-- TODO: Remove the comments around this ComponentRef element and the Component above in order to add resources to this installer. -->
        <ComponentRef Id="SampleApplication" />

        <!-- Note: The following ComponentGroupRef is required to pull in generated authoring from project references. -->
        <ComponentGroupRef Id="Product.Generated" />
    </Feature>

<CustomAction Id="NoDowngrade" Error="A later version of [ProductName] is already installed." />

<InstallExecuteSequence>
  <Custom Action="NoDowngrade" After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>
  <RemoveExistingProducts After="InstallFinalize" />
</InstallExecuteSequence>

<InstallUISequence>
  <Custom Action="NoDowngrade" After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>
</InstallUISequence>

</Product>
</Wix> 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:58:59.457

将 Product/@Id 设置为“*”以获取自动产品代码更改并使用[MajorUpgrade 元素](http://wix.sourceforge.net/manual-wix3/wix_xsd_majorupgrade.htm)。有关更多上下文，请参阅[我的博客](http://www.joyofsetup.com/2010/01/16/major-upgrades-now-easier-than-ever/)。

# c# - 运行 epstopdf 的问题。检查你的 TeX 安装

> ID：12484159
> 
> 赞同：7
> 
> 时间：2012-09-18T20:03:27.293
> 
> 标签：c#, pdf, documentation, latex, doxygen

运行 doxygen 时，我不断收到以下错误：

```
Problems running epstopdf. Check your TeX installation! 
```

我需要在某处安装 Latex 吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-20T20:27:08.073

[`epstopdf`](http://ctan.org/pkg/epstopdf)是一个 Perl 脚本，它使用 GhostScript 将 EPS 转换为“封装的”PDF。从技术上讲，您不需要 LaTeX，尽管默认情况下它是每个 TeX 发行版的一部分。

因此，要么直接下载它，要么安装任何一种主要的 TeX 发行版（比如[MiKTeX](http://miktex.org/)或[TeX Live](http://www.tug.org/texlive/acquire.html)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-05-15T19:00:30.103

我在玩植物时遇到了这个问题（@startuml，@enduml）。在默认配置中，GENERATE_LATEX 设置为 YES，而我只关心 html。当我将 GENERATE_LATEX 设置为 NO 时，doxygen 不再需要 epstopdf。

# linux - 从在另一个脚本中运行的脚本中获取输出

> ID：12484163
> 
> 赞同：0
> 
> 时间：2012-09-18T20:03:42.077
> 
> 标签：linux, bash, sh

我知道标题有点混乱，但这是我的情况

```
#!/bin/bash
for node in `cat path/to/node.list`
do
        echo "Checking node: $node" 
        ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no me@$node "nohup  scriptXYZ.sh"
done 
```

基本上 scriptXYZ 有一个输出。像：`Node bla is Up` 或`Node bla is Down`。我想做一些相当于以下伪代码的事情：

```
if (output_from_scriptXYZ == "Node bla is Up")
    do this
else 
    do that 
```

我一直在尝试找到一种在线执行此操作的方法，但找不到可以执行此操作的方法。再说一次，我可能不知道我在寻找什么。

另外作为奖励：有什么方法可以判断 scriptXYZ 在运行时是否有错误？类似于“文件不存在”之类的东西——不是脚本本身，而是脚本试图做的事情，从而导致错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:36:39.243

首先，`scriptXYZ.sh`如果节点已启动，是否可以退出为 0，否则为非零？然后您可以简单地执行以下操作，而不是捕获输出。脚本标准输出和标准错误将连接到您的本地终端，因此您将看到它们，就像您在本地运行它一样。

```
#!/bin/bash
while read -r node; do
    echo "Checking node: $node" 

    if ssh -o UserKnownHostsFile=/dev/null \
           -o StrictHostKeyChecking=no me@$node scriptXYZ.sh; then
       do something
    else
       do something else
    fi
done < path/to/node.list 
```

使用 运行脚本并没有什么意义`nohup`，因为您需要保持连接才能将结果发送回本地主机。

# html - 如何在谷歌地球 api 中添加自定义标记？

> ID：12484170
> 
> 赞同：2
> 
> 时间：2012-09-18T20:04:09.603
> 
> 标签：html, kml, google-earth, google-earth-plugin

而不是常规的地标，即黄色大头针。我想改用这个图标。 [http://maps.google.com/mapfiles/kml/pal3/icon39.png](http://maps.google.com/mapfiles/kml/pal3/icon39.png) 我不确定我是否必须导入 KML 文件，或者我是否可以通过加载它来使用它。如果有人可以帮助我将图标发布在谷歌地球上的某个地方，我将不胜感激。我浏览了一些 google kml 文件和指南，但无法正常工作。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T00:00:22.443

最简单的方法：如果您使用 Google 地球客户端创建 KML 文件，请右键单击图标选择“属性”单击图标 - 右上角单击“添加自定义图标”将 URL 粘贴到您要使用的图标

否则，您将需要使用某种文本编辑器编辑 .kml 文件，在将值更改为所需图标的 URL 时找到用于相关地标的文件

如果您需要帮助以找到正确的样式，请查找地标名称并找到它，这通常前面有一个“#”标签，在您的文档中搜索该样式（删除“#”标签）

有时会立即找到它（如果您看到那里的东西）

否则，您将需要找到其下列出的两种样式（其中 2 种）（使用与上述相同的方法），然后继续更改两个地方的

# stata - 存储集群稳健标准误差以创建新变量—Mac 的 Stata 12

> ID：12484171
> 
> 赞同：1
> 
> 时间：2012-09-18T20:04:16.213
> 
> 标签：stata, standard-error

我需要存储集群稳健标准误差的值，以便使用它来创建新变量。

我可以使用 mean 命令获得集群稳健标准错误，但 stata 不存储此值。

您对如何计算估计的集群稳健标准误差然后存储该值以使用它来创建新变量有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:35:42.663

我认为这几乎可以解决问题。可能有一种更优雅的方式来做到这一点。玩具数据，无意义的例子：

```
/* Get some data */
webuse nhanes2f, clear
svyset psuid [pweight=finalwgt], strata(stratid)

/* get the standard error of the constant, which is the mean */
svy: reg zinc
display _se[_cons]
generate se = _se[_cons]

/* Verify that this is correct */
svy: mean zinc 
```

但是，您还想要集群，这使事情变得复杂。我认为如果你只有调查权重（又名第一阶段集群），你可以这样做：

```
reg zinc [pweight=finalwgt], cluster(region) 
```

可能有一种方法可以使用 -glamm- 执行您想要的操作，这是用户编写的命令。如果你在这里没有得到太多回应，你应该在 Statalist 上问这个问题。

# python - Make Python unittest fail on exception from any thread

> ID：12484175
> 
> 赞同：8
> 
> 时间：2012-09-18T20:04:29.730
> 
> 标签：python, multithreading, exception, automated-tests

I am using the unittest framework to automate integration tests of multi-threaded python code, external hardware and embedded C. Despite my blatant abuse of a unittesting framework for integration testing, it works really well. Except for one problem: I need the test to fail if an exception is raised from any of the spawned threads. Is this possible with the unittest framework?

A simple but non-workable solution would be to either a) refactor the code to avoid multi-threading or b) test each thread separately. I cannot do that because the code interacts asynchronously with the external hardware. I have also considered implementing some kind of message passing to forward the exceptions to the main unittest thread. This would require significant testing-related changes to the code being tested, and I want to avoid that.

Time for an example. Can I modify the test script below to fail on the exception raised in my_thread *without* modifying the x.ExceptionRaiser class?

```
import unittest
import x

class Test(unittest.TestCase):
    def test_x(self):
        my_thread = x.ExceptionRaiser()
        # Test case should fail when thread is started and raises
        # an exception.
        my_thread.start()
        my_thread.join()

if __name__ == '__main__':
    unittest.main() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-19T13:37:43.237

起初，`sys.excepthook`看起来像一个解决方案。它是一个全局钩子，每次抛出未捕获的异常时都会调用它。

不幸的是，这不起作用。为什么？很好地`threading`将您的函数包装`run`在代码中，该代码会打印您在屏幕上看到的可爱回溯（注意它总是如何告诉您`Exception in thread {Name of your thread here}`的？这就是它的完成方式）。

从 Python 3.8 开始，您可以重写一个函数来完成这项工作：[threading.excepthook](https://docs.python.org/3/library/threading.html#threading.excepthook)

> ... threading.excepthook() 可以被覆盖以控制如何处理 Thread.run() 引发的未捕获异常

那么我们该怎么办？用我们的逻辑替换这个函数，*瞧*：

对于 python >= 3.8

```
import traceback
import threading 
import os

class GlobalExceptionWatcher(object):
    def _store_excepthook(self, args):
        '''
        Uses as an exception handlers which stores any uncaught exceptions.
        '''
        self.__org_hook(args)
        formated_exc = traceback.format_exception(args.exc_type, args.exc_value, args.exc_traceback)
        self._exceptions.append('\n'.join(formated_exc))
        return formated_exc

    def __enter__(self):
        '''
        Register us to the hook.
        '''
        self._exceptions = []
        self.__org_hook = threading.excepthook
        threading.excepthook = self._store_excepthook

    def __exit__(self, type, value, traceback):
        '''
        Remove us from the hook, assure no exception were thrown.
        '''
        threading.excepthook = self.__org_hook
        if len(self._exceptions) != 0:
            tracebacks = os.linesep.join(self._exceptions)
            raise Exception(f'Exceptions in other threads: {tracebacks}') 
```

对于旧版本的 Python，这有点复杂。长话短说，`threading`结节似乎有一个未记录的进口，其作用类似于：

```
threading._format_exc = traceback.format_exc 
```

毫不奇怪，这个函数只有在线程函数抛出异常时才会被调用`run`。

所以对于python <= 3.7

```
import threading 
import os

class GlobalExceptionWatcher(object):
    def _store_excepthook(self):
        '''
        Uses as an exception handlers which stores any uncaught exceptions.
        '''
        formated_exc = self.__org_hook()
        self._exceptions.append(formated_exc)
        return formated_exc

    def __enter__(self):
        '''
        Register us to the hook.
        '''
        self._exceptions = []
        self.__org_hook = threading._format_exc
        threading._format_exc = self._store_excepthook

    def __exit__(self, type, value, traceback):
        '''
        Remove us from the hook, assure no exception were thrown.
        '''
        threading._format_exc = self.__org_hook
        if len(self._exceptions) != 0:
            tracebacks = os.linesep.join(self._exceptions)
            raise Exception('Exceptions in other threads: %s' % tracebacks) 
```

用法：

```
my_thread = x.ExceptionRaiser()
# will fail when thread is started and raises an exception.
with GlobalExceptionWatcher():
    my_thread.start()
    my_thread.join() 
```

您仍然需要`join`自己，但在退出时，with 语句的上下文管理器将检查其他线程中抛出的任何异常，并适当地引发异常。

* * *

> 代码按“原样”提供，不提供任何形式的明示或暗示保证

这是一个无证的、可怕的黑客攻击。我在linux和windows上测试过，似乎可以。需要您自担风险使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T09:11:58.373

我自己也遇到过这个问题，我能想出的唯一解决方案是将 Thread 子类化以包含一个属性，以确定它是否在没有未捕获异常的情况下终止：

```
from threading import Thread

class ErrThread(Thread):
    """                                                                                                                                                                                               
    A subclass of Thread that will log store exceptions if the thread does                                                                                                                            
    not exit normally                                                                                                                                                                                 
    """
    def run(self):
        try:
            Thread.run(self)
        except Exception as self.err:
            pass
        else:
            self.err = None

class TaskQueue(object):
    """                                                                                                                                                                                               
    A utility class to run ErrThread objects in parallel and raises and exception                                                                                                                     
    in the event that *any* of them fail.                                                                                                                                                             
    """

    def __init__(self, *tasks):

        self.threads = []

        for t in tasks:
            try:
                self.threads.append(ErrThread(**t)) ## passing in a dict of target and args
            except TypeError:
                self.threads.append(ErrThread(target=t))

    def run(self):

        for t in self.threads:
            t.start()
        for t in self.threads:
            t.join()
            if t.err:
                raise Exception('Thread %s failed with error: %s' % (t.name, t.err)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-20T16:18:44.070

我已经使用上面接受的答案一段时间了，但是从 Python 3.8 开始，该解决方案不再起作用，因为`threading`模块不再具有此`_format_exc`导入。

另一方面，该`threading`模块现在有一个很好的方法来注册自定义除了 Python 3.8 中的钩子，所以这是一个运行单元测试的简单解决方案，它断言在线程内引发了一些异常：

```
def test_in_thread():
    import threading

    exceptions_caught_in_threads = {}

    def custom_excepthook(args):
        thread_name = args.thread.name
        exceptions_caught_in_threads[thread_name] = {
            'thread': args.thread,
            'exception': {
                'type': args.exc_type,
                'value': args.exc_value,
                'traceback': args.exc_traceback
            }
        }

    # Registering our custom excepthook to catch the exception in the threads
    threading.excepthook = custom_excepthook

    # dummy function that raises an exception
    def my_function():
        raise Exception('My Exception')

    # running the funciton in a thread
    thread_1 = threading.Thread(name='thread_1', target=my_function, args=())

    thread_1.start()
    thread_1.join()

    assert 'thread_1' in exceptions_caught_in_threads  # there was an exception in thread 1
    assert exceptions_caught_in_threads['thread_1']['exception']['type'] == Exception
    assert str(exceptions_caught_in_threads['thread_1']['exception']['value']) == 'My Exception' 
```

# java - Android Println() 到 TextView

> ID：12484176
> 
> 赞同：2
> 
> 时间：2012-09-18T20:04:30.673
> 
> 标签：java, android, textview

我想取一些变量，在这里列出；

```
double dBench = (((Math.floor((dWeight*.664)/10))*10)-10)+dPush;
double dFlies = (dBench)*.6;
double dCurls = (dWeight*dPull)*.25;
double dLats = ((Math.floor((dWeight*.5)/10))*10);

System.out.println(dBench);
System.out.println(dFlies);
System.out.println(dCurls);
System.out.println(dLats); 
```

但是如何让 println() 打印到 textview 或其他东西？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T20:14:18.740

使用 textview 的 set text 方法

```
textView = (TextView)findViewById(R.id.myTextView);
textView.setText("This text will be placed in the textView"); 
```

对于双精度值，它看起来像这样

```
textView = (TextView)findViewById(R.id.myTextView);
textView.setText(String.valueOf(double_variable); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T20:14:42.647

您不必对 textview 执行 println。TextView 具有称为**setText**和**getText**的方法。setText 可以将文本设置为 TextView，getText 可以从 textview 中获取文本。[在这里查看更多信息。](http://developer.android.com/reference/android/widget/TextView.html)

[Android TextView 教程](http://www.androidaspect.com/2012/06/android-button-textview-example.html)

对于双，

```
textView = (TextView)findViewById(R.id.myTextView);
textView.setText(String.valueOf(Your double value)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T20:29:15.940

如果你想在 textView 中打印一个值：

```
TextiView textView = (TextView) findViewById(R.id.textViewId);
textView.setText(...see below...); 
```

Integer: Integer.valueOf(integerVariable).toString() Long、Double 等也可以这样做。下面是 Double 的类比示例：

```
double a = some value;
String toShow = Double.valueOf(a).toString();
textView.setText(toShow); 
```

如果要检查这些值（调试），可以使用 Log 类。Log.d("VALUE", Integer.valueOf(integerVariable).toString()); 在这种情况下，该值将显示在 LogCat（标签 VALUE）中。您可以过滤输入标签的消息：VALUE

Integer、Long、Double 是原语的包装类，这些类具有 toString() 方法，您可以使用该方法将 String 传递到 TextView。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T22:21:24.217

如果要查看存储在变量中的值，可以使用 log cat 命令将它们打印到控制台，如下所示：

```
Log.v("Title" , variable_name); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T06:27:39.833

或者你可以使用数值

```
textView = (TextView)findViewById(R.id.myTextView);
textView.setText(""+Your double value); 
```

# c# - 自定义 Log4Net 过滤器级别未写入日志

> ID：12484179
> 
> 赞同：2
> 
> 时间：2012-09-18T20:04:52.453
> 
> 标签：c#, .net, logging, log4net

我试过这个没有成功：[How do I filter on a custom level in log4net](https://stackoverflow.com/questions/538095/how-do-i-filter-on-a-custom-level-in-log4net)

这是我正在使用的代码：

```
public static class SpecialLogging
{
    public static readonly log4net.Core.Level specialLevel = new log4net.Core.Level(35000, "SPECIAL");

    public static void Special(this ILog log, string message)
    {
        log.Logger.Log(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType,
        specialLevel, message, null);
    }
} 
```

这是我测试它：

```
private static void Main()
{
    //Logger
    LogManager.GetRepository().LevelMap.Add(SpecialLogging.specialLevel);
    ILog log = LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);
    log.Special("Special");
} 
```

最后是我的 log4net.config 文件：

```
<log4net>
  <appender name="RollingLogFileAppenderDebug" type="log4net.Appender.RollingFileAppender">
    <file value="./Logs/DEBUG.log" />
    <appendToFile value="false" />
    <rollingStyle value="Size" />
    <maxSizeRollBackups value="3" />
    <maximumFileSize value="5GB" />
    <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />

    <filter type="log4net.Filter.LevelRangeFilter">
      <acceptOnMatch value="true" />
      <levelMin value="DEBUG" />
      <levelMax value="FATAL" />
    </filter>

    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date{G} [%thread] (%stacktrace) %5level - %message%newline" />
    </layout>
  </appender>

  <appender name="RollingLogFileAppender" type="log4net.Appender.RollingFileAppender">
    <file value="./Logs/Special.log" />
    <appendToFile value="false" />
    <rollingStyle value="Size" />
    <maxSizeRollBackups value="3" />
    <maximumFileSize value="5GB" />
    <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />

    <filter type="log4net.Filter.LevelMatchFilter">
      <acceptOnMatch value="true" />
      <levelToMatch value="SPECIAL" />
    </filter>
    <filter type="log4net.Filter.DenyAllFilter" />

    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date{G} [%thread] (%stacktrace) %5level - %message%newline" />
    </layout>
  </appender>

  <!-- Set the default logging level and add the active appenders -->
  <root>
    <level value="ALL" />
    <appender-ref ref="RollingLogFileAppender" />
    <appender-ref ref="RollingLogFileAppenderDebug" />
  </root>

</log4net> 
```

Debug.log 文件中出现特殊消息，但 Special.log 文件为空！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-20T09:59:15.363

您从链接到的问题中错过了[Olle 的答案。](https://stackoverflow.com/a/538138/463828)

首先，所有 log4net 问题的经验法则是启用[内部调试](http://logging.apache.org/log4net/release/faq.html#internalDebug)。

在这种情况下，如果您添加

```
log4net.Util.LogLog.InternalDebugging = true; 
```

到你的主要开始，那么你可能会看到错误

```
log4net:ERROR XmlHierarchyConfigurator: Unknown Level Specified [SPECIAL]
log4net:WARN Unable to set property [levelToMatch] on object [log4net.Filter.LevelMatchFilter] using value [SPECIAL] (with acceptable conversion types) 
```

所以解决方案是将此信息添加到您的 log4net 配置部分，即

```
<level>
  <name value="SPECIAL" />
  <value value="35000" />
</level> 
```

# javascript - textbox content resets immediately after changing

> ID：12484180
> 
> 赞同：0
> 
> 时间：2012-09-18T20:04:53.067
> 
> 标签：javascript, html

I have built a basic script to do an elementary math add 1 on click and subtract 1 on click the problem is every time you click on the button you can watch the textbox content increase by 1 or decrease by 1 but then within a quarter of a second the form appears to reset and show the initial value of 0 again

```
<html>
<head>
<script>
function inc()
{
document.content.quant.value++;
}

function dec()
{
document.content.quant.value--;
}
</script>
</head>

<body>
<form name="content">
<input type="text" id="quant" value="0">
<button onclick="inc()">increase</button>
<button onclick="dec()">decrease</button>
</form>
</body>
</html> 
```

I am sure I am making some stupid mistake - any ideas?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:07:36.997

添加`type="button"`到您的按钮

```
<button type="button" onclick="inc()">increase</button> 
```

没有属性的按钮的默认行为`type`是提交它所属的表单。如果你改变它`type`，`button`它不会做任何事情:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:13:13.583

当您单击按钮时，表单正在提交。使用 preventDefault 来防止这种情况。

```
<html>
<head>
<script>
function inc()
{
document.content.quant.value++;
event.preventDefault();
}

function dec()
{
document.content.quant.value--;
event.preventDefault();
}
</script>
</head>

<body>
<form name="content">
<input type="text" id="quant" value="0">
<button onclick="inc()">increase</button>
<button onclick="dec()">decrease</button>
</form>
</body>
</html> 
```

# rest - REST(ful) simple authentication without SSL and HMAC?

> ID：12484185
> 
> 赞同：3
> 
> 时间：2012-09-18T20:05:13.300
> 
> 标签：rest, authentication, hash

I wonder if it is possible to have an easy authentication method that is restful, fast and provides a litte security.

SSL is not an option, because I can't rely on a valid SSL Certificate on the server of clients. Also HMAC is not really possible because the body of the request should be signed, when used properly, but in my case that body could be a large file. Further should the authentication be possible with JavaScript/AJAX.

I thought about something really simple. What's the problem with that one:

HEADER: X-Authentication: timestamp:username:sha256(timestamp:password)

The server knows the users password and could check the hash, the timestamp is used to only allow request that took place e.g. 10 seconds before. The replay window would be extremly small, and there are no sessions on the serverside.

If the hash is cracked the attacker knows the password and has unlimited access.

Alternative would be to use

HEADER: X-Authentication: timestamp:username:HMAC(password, 'timestamp+request-method+verb')

What's the way to go? I'm not a security pro, maybe storing the session on the server would be better (but not RESTful)?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T10:26:51.707

我构建了一个随机散列算法来满足你的需要，它叫做 jAuthenticate。

您可以从以下网址下载：[https](https://github.com/thomasoeser/jAuthenticate) ://github.com/thomasoeser/jAuthenticate ​</p>

你可以在这里看到它是如何工作的：http: [//furiousgryphon.com/jauthenticatedemo.html](http://furiousgryphon.com/jauthenticatedemo.html)

它是一个强大的算法（在我看来）的原因是我使用随机数来影响散列，但我正在发送一个带有散列的模糊数字。

每个哈希仅供一次性使用。

看看，它是免费的开源 (MIT)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:19:16.797

HTTP 身份验证是可扩展的，因此您可以发明自己的机制（显然风险自负！）。有关详细信息，请参阅[https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-p7-auth-20](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-p7-auth-20)。

不要费心发明自己的新 X-header。将现有的 Authorization 标头与您的方案一起使用是一个更好的选择。例如

```
Authorization: kruemel-auth timestamp:HMAC(password, 'timestamp+request-method+verb') 
```

理想情况下，新方案将连同规范一起在 IANA 注册。正在建立一个注册表来跟踪已开发的身份验证方案。见[http://tools.ietf.org/id/draft-ietf-httpbis-authscheme-registrations-03.html](http://tools.ietf.org/id/draft-ietf-httpbis-authscheme-registrations-03.html)

# android - TabView with Fragments

> ID：12484190
> 
> 赞同：0
> 
> 时间：2012-09-18T20:05:37.367
> 
> 标签：android, android-fragments, android-tabhost

In my app initially I created one class "abc.java" which extends Activity and do some functionality..

But now I have decided to implement TabView and abc.java should be first tab in tabview..

My problem is my abc.java class extends activity and now when I change it to fragments , it gives me errors.

If I implement TabActivity , which is deprecated now, it will work fine, but now if I want to use fragment what changes I have to do?

I know I have to make some changes in abc.java but I have no clue how to do that..I am new to android and trying hard to get this done..Any help would be great!!

here is my code for class "abc.java"

```
public class CountAndMarkPage extends Activity
{
  public void onCreate(Bundle savedInstanceState)
  {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.count_mark);

        //lots of code here
   }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:12:53.873

您需要使用相同的布局资源扩展 Fragment 并覆盖 onCreateView。从文档中查看[此信息。](http://developer.android.com/guide/components/fragments.html#UI)

快速示例：

```
public class CountAndMarkPage extends Fragment {
    public void onCreate(Bundle savedInstanceState){
    }

    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState){
        // Inflate your layout
        View myView = inflater.inflate(R.layout.count_mark, container, false);

        // Any additional initialization

        return myView;
    }
} 
```

* * *

要访问此布局中的小部件，您需要像这样在膨胀的根视图上使用 findViewById

```
public class CountAndMarkPage extends Fragment {
    public void onCreate(Bundle savedInstanceState){
    }

    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState){
        // Inflate your layout
        ViewGroup myView = (ViewGroup) inflater.inflate(R.layout.count_mark, container, false);

        // Any additional initialization
        TextView myTextView = (TextView) myView.findViewById(R.id.my_view);
        // And so on
        return myView;
    }
} 
```

# c# - Change the textbox(URL) text on back button press in Windows phone app

> ID：12484193
> 
> 赞同：0
> 
> 时间：2012-09-18T20:06:16.227
> 
> 标签：c#, windows-phone-7

I have developed a web browser using the `WebBrowser` API in Visual Studio for a Windows Phone application) I have add a **back** button to this web browser. This is the code that I use for the **back** button to go to previous web page:

```
 private void backOnClick(object sender, RoutedEventArgs e) {
          webBrowser1.InvokeScript("eval", "history.go(-1)");    
    } 
```

So now I want to change the textbox(URL) text considering the web page when press **back** button. How can I do that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T05:26:45.017

在控件上的`LoadComplete`事件中`WebBrowser`，查看`Source`属性并将其设置为`TextBox`（这对于重定向也很有用）。

# c# - Update browser as each file is uploaded to server

> ID：12484194
> 
> 赞同：0
> 
> 时间：2012-09-18T20:06:45.220
> 
> 标签：c#, javascript, .net, upload

I have a page where users can add attachments to emails. When they click to start uploading their attachments, I run a bit of javascript to set a label to read (for example) 'Uploading File 1 of 4'

The code that handles the upload is below. As each file is saved, I want to update the browser label to read (for example) 'File 1 uploaded. Uploading File 2 of 4'. Etc.

What technique can I use to keep the browser notified as the files are updated? I don't need a progress bar.

```
HttpFileCollection hfc = Request.Files;
for (int i = 0; i < hfc.Count; i++)
{
HttpPostedFile hpf = hfc[i];
if (hpf.ContentLength > 0)
    {
    hpf.SaveAs(path + ReturnValue.ToString() + "\\" + Path.GetFileName(hpf.FileName));
    //This is where I want to update the browser so the user is informed as each file is uploaded
    }
} 
```

I tried using Response.Write to write `<script type="text/javascript">alert('File 1 uploaded')</script>` just to see if that would do anything. But it does not work.

I tried using `ScriptManager.RegisterStartUpScript` to call a function but that didn't work.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:16:34.687

正常的方法是使用 AJAX 在服务器端轮询 Web 方法——这是一种返回当前数据的方法。

一个问题是服务器可能正在使用会话同步，因此您需要使用无会话 Web 方法。

# c - word counter 'forgetting' about already saved word

> ID：12484195
> 
> 赞同：-2
> 
> 时间：2012-09-18T20:06:49.807
> 
> 标签：c, struct

The snippets below are from my program that gets words, then prints them with the number of occurences.

It works almost fine except for it "forgots" that particular entry has been saved before and does NOT increment counter associated with it.

```
typedef struct {
    char *word;
    int occ;
}
words;
words *data=NULL;

int main(int argc, char **argv)
{
    char *word;
    words *temp;
    int c,i,num;
    words *ptr = NULL;

    num=0;

    while(1)
    {
        c=fgetc(infile);
        if(c==EOF) break;
        if(!isalpha(c)) continue;
        else ungetc(c,infile);
        word=getword(infile);

        if(findword(word))
        {

            if(!(temp=realloc(data,sizeof(words)*(num+1))))
            { /* error handling */ }
            else
                data=temp;

        }
        else
           free(word);
    }

    /* sort procedure here, irrelevant for the purpose of topic */
    for(i=0;i<num;i++)
    {
        /*printf*/
    }

    return 0;

} 
```

What's wrong with that code?

Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:23:35.710

根本问题是你的“findword”功能实际上并没有找到一个词。它只是查看列表中的一项。它需要循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:09:54.140

```
if ((strcmp(word, ptr->word)) == 0) {
  //Do something to store the count
} 
else {
  return ptr;
} 
```

# javascript - Problems with background image position on Stellar.js

> ID：12484196
> 
> 赞同：2
> 
> 时间：2012-09-18T20:06:51.553
> 
> 标签：javascript, css, parallax

I'm using [stellar.js](https://github.com/markdalgleish/stellar.js) to add a parallax effect to a vertical scrolling website, but I'm having problems with the background positions. When I use the class "data-stellar-background-ratio" to add the parallax effect on a div I can't set the background position to right via CSS. All the background images just go to the left no matter what. I tried to use the position property plugin syntax available on the website, but it seems to break the parallax effect somehow. Can anybody help me? Thank you!

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-02-23T19:16:10.437

我遇到过同样的问题。

在您的 jquery.stellar.js 文件中更改 stellar 函数，以便将水平滚动设置为 false（默认设置为 true）。

```
$.stellar({
horizontalScrolling:false
// rest of function
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-20T15:09:30.053

尝试更改`scrollProperty`为`transform`，例如：

```
scrollProperty: 'transform' 
```

这对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-23T12:02:14.273

遇到同样的问题，我尝试添加

```
scrollProperty and horizontalScrolling 
```

虽然这导致我的背景没有被加载。

删除这两个属性并运行 Stellar like..

```
$.stellar({}) instead of $.stellar() 
```

（就像在 Stellar 网站上一样）

视差就像一个魅力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-13T21:50:39.627

我有同样的问题并且已经有`horizontalScrolling:false`。添加`scrollProperty: 'transform'`解决了我的问题。

# ruby-on-rails-3.2 - Net::SMTPAuthenticationError (530 5.7.0 Must issue a STARTTLS command first

> ID：12484197
> 
> 赞同：5
> 
> 时间：2012-09-18T20:06:54.323
> 
> 标签：ruby-on-rails-3.2

I am running Mac OSX Mountain Lion

ruby: ruby 1.9.2p290 (2011-07-09 revision 32553) [x86_64-darwin12.1.0]

rails: Rails 3.2.3

I have my config/enviroment/development.rb:

MyApp::Application.configure do

```
 config.cache_classes = false
  config.whiny_nils = true
  config.consider_all_requests_local       = true
  config.action_controller.perform_caching = false
  config.active_support.deprecation = :log
  config.action_dispatch.best_standards_support = :builtin
  config.action_mailer.raise_delivery_errors = true
  config.action_mailer.delivery_method = :smtp
  config.action_mailer.smtp_settings = {
    address: "smtp.gmail.com",
    port: 587,
    domain: "gmail.com",
    authentication: :login,
    enable_starttls_auto: true,
    openssl_verify_mode: OpenSSL::SSL::VERIFY_NONE,
    user_name: "username",
    password: "password"
  }

  config.action_mailer.default_url_options = {host: 'localhost:3000'}
end 
```

This was working 2 weeks ago and the code has not been changed. I have however since then upgraded to mountain lion. We also added an extra hook for Git called staging but that should not have effected it. After encountering this problem this morning I added the line you see in the code that looks like this:

```
 openssl_verify_mode: OpenSSL::SSL::VERIFY_NONE 
```

which I saw in another post about this issue. It did not work.

The action mailer is working fine on the testers, and production servers, so we are now convinced this is an issue in regards to the upgrade to lion.

Thank you for your time.

# sql - How to write an SQL query to get rows with the same prefix

> ID：12484200
> 
> 赞同：1
> 
> 时间：2012-09-18T20:07:06.933
> 
> 标签：sql, query-optimization, prefix

everyone;

I am working on a database where path information are stored, one simplified table is shown below

```
path_id | path value
1         //a/b/c/d
2         //a/b/e
3         //a/b
4         //a/bcd 
```

So here is the question, how can I get information where has '//a/b' as the prefix? In this case, the result should be:

```
path_id | path value
1         //a/b/c/d
2         //a/b/e
3         //a/b 
```

I am seeking for a more elegant and optimized query, other than using logic operators like 'OR'. Thanks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:10:29.437

```
SELECT * FROM YourTable WHERE path_value like '//a/b/%' OR path_value = '//a/b' 
```

Note the extra slash before the wild card in the first part of the `WHERE` statement. This will exclude **//a/bcd**.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:08:44.437

the % acts as a wild card so it anything can follow that part.

```
SELECT * FROM tableName WHERE path_value like '//a/b/%' OR path_value = '//a/b' 
```

# c - 我正在使用 malloc 并且我的程序正在崩溃

> ID：12484204
> 
> 赞同：0
> 
> 时间：2012-09-18T20:07:31.457
> 
> 标签：c, malloc

今天我在搞乱 malloc 和整数指针。该程序已设置，因此它将一个内存位置分配给一个整数指针，然后用一堆整数（如数组）填充内存位置，然后打印所有整数。问题是当它完成运行时它会崩溃。而且我怀疑 malloc 导致了这个问题。

这是代码

```
#include<stdio.h>
#include<stdlib.h>
int main(){

    int *name,x;
    char y;
    name=malloc(sizeof(int));
    for(x=0;x<500;x++){
        name[x]=x;
    }
    for(x=0;x<500;x++){
        printf("%d ",name[x]);
    }

    scanf("%c",&y);
    free(name);
    return 0;
} 
```

请帮忙。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T20:09:06.910

```
name = malloc(sizeof(int)); 
```

是问题所在。这样，您只能在数组中存储一个 int。尝试

```
name = malloc(sizeof(int) * 500); 
```

反而。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T20:10:38.917

呃，“malloc()”不会让你的程序崩溃。

*你正在*崩溃你的程序:)

建议：

1.  检查返回 NULL 的“name=malloc()”（即检查错误）。

2.  不要为*1 个*int 分配空间（“sizeof(int)”可能是四个字节），然后尝试写入*500 个*int :)

3.  不要在代码中乱扔“500”之类的“幻数”——改用常量。

建议更改：

```
#include<stdio.h>
#include<stdlib.h>

#define NELMS 500

int main(){

    int *name = NULL,x;
    char y;
    name=malloc(sizeof(int) * NELMS);
    if (!name) {
      perror ("Unable to allocate memory!");
      return 1;
    }
    for(x=0;x<NELMS;x++){
        name[x]=x;
    }
    for(x=0;x<NELMS;x++){
        printf("%d ",name[x]);
    }

    scanf("%c",&y);
    free(name);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-18T20:09:44.200

您正在分配内存以仅存储一个`int`. 你需要的是：

名称=malloc(500*sizeof(int));

# c# - Convert web service call to a dictionary object

> ID：12484210
> 
> 赞同：1
> 
> 时间：2012-09-18T20:07:58.207
> 
> 标签：c#, linq, dictionary

I have a web service that I am calling which take a string, and returns a list of strings as an object[].

I want to covert this to a Dictionary> object. I'm currently using something like this:

```
foreach (string role in allRoles)
{
    Dictionary<string, List<string>> allActionsForRole = 
        lifeRay.getRoleActions(role)
        .ToDictionary<string, List<string>>(role, x => x.ToString());
} 
```

It doesn't like the "role" field.

How should I write this?

I'm assuming I could write it somehow to even remove the foreach, right?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:12:24.503

尝试以下操作：

```
Dictionary<string, List<string>> allActionsForRole = 
    lifeRay.getRoleActions(role)
    .ToDictionary<string, List<string>>(() => role, x => x.ToString()); 
```

该方法需要两个`Func`代表 - 因此您可以为密钥提供一个“虚拟”代表。

# ruby-on-rails - Distribute Ruby on Rails app

> ID：12484213
> 
> 赞同：3
> 
> 时间：2012-09-18T20:08:17.793
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, software-distribution

I'm trying to figure out a way to distribute a Rails application in a fairly standalone way. Think of [Sickbeard](http://sickbeard.com/) or [CouchPotato](https://couchpota.to/), two apps you only need Python to run.

That's basically what I want to achieve, but with Rails instead. There are some failure stories out there and some that are just too complicated, but I'm hoping that there has been some advancements in the field that I just can't find.

Is there a way to distribute a Rails application including any gems it depends on in a way you only require Ruby installed to run it?

I have no intention of trying to obfuscate the source code.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:15:27.090

只需使用捆绑器。几乎每个新的 Ruby 安装都有标准的 RubyGems 和 Bundler，因此最终用户应该做的唯一事情是：

```
$ bundle install
$ rails s 
```

并且将运行安装了所有依赖项的应用程序。

# c# - Windows phone 7 + silverlight + C# 中的商

> ID：12484215
> 
> 赞同：-1
> 
> 时间：2012-09-18T20:08:27.493
> 
> 标签：c#, silverlight, windows-phone-7, math

是否有任何内置函数来获得除法的商。`Math.DivRem`似乎不适用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:16:39.643

整数操作数的除法将产生整数商。如果您的输入是浮点类型，只需先将它们转换为整数类型：

```
double num1 = 27;
int num2 = 7;
double dblResult = num1 / num2; // will yield floating point result 3.857...
int intResult    =(int)num1 / num2; // will yield integer quotient 3 
```

# c# - Task Parallel Library exception handling

> ID：12484219
> 
> 赞同：5
> 
> 时间：2012-09-18T20:08:40.217
> 
> 标签：c#, .net, task-parallel-library

When handling exceptions in TPL tasks I have come across two ways to handle exceptions. The first catches the exception within the task and returns it within the result like so:

```
var task = Task<Exception>.Factory.StartNew(
    () =>
        {
            try
            {
                // Do Something

                return null;
            }
            catch (System.Exception e)
            {
                return e;
            }
        });

task.ContinueWith(
    r =>
        {
            if (r.Result != null)
            {
                // Handle Exception
            }
        }); 
```

The second is the one shown within the documentation and I guess the proper way to do things:

```
var task = Task.Factory.StartNew(
    () =>
        {
            // Do Something
        });
task.ContinueWith(
    r =>
        {
            if (r.Exception != null)
            {
                // Handle Aggregate Exception
                r.Exception.Handle(y => true);
            }
        }); 
```

I am wondering if there is anything wrong with the first approach? **I have received 'unhandled aggregate exception' exceptions every now and again using this technique and was wondering how this can happen?**

To clarify, I think the second pattern is the better one but I have a chunk of code which makes use of the first pattern and I am trying to find out if it needs re-factoring i.e. if it turns out that not all exceptions will be trapped.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T13:06:17.787

第一种方法假定每次调用都会引发异常。虽然这可能是真的，但这些异常似乎并不“异常”，而且有设计问题的味道。如果异常不是异常，那么结果就没有多大意义。另一个问题是，如果你确实想要一个“结果”（即，除了 之外的东西`Exception`）你不能因为唯一的`Result`插槽用于`Exception`. 另一个问题是您没有在主线程上重新抛出异常（您可以手动执行此操作），因此您没有获得 catch 语义（即您正在使用该`Handle`方法）。

第二种方法会被更多人更好地理解。

# ruby-on-rails - Rails 引擎线程安全 - ActiveResource

> ID：12484221
> 
> 赞同：3
> 
> 时间：2012-09-18T20:08:44.253
> 
> 标签：ruby-on-rails, ruby-on-rails-3, thread-safety, rails-engines

我的 Rails 3.1 应用程序使用一个引擎，我想知道对该引擎的访问是否是线程安全的。

我在引擎中有 /lib/mymodule.rb ，它看起来像这样：

```
module MyModule
  def self.my_method()
    begin
       data = WebResource.find(:all) # Where WebResource < ActiveResource::Base
    rescue
       data = nil
    end

    return data
  end
end 
```

然后在我的视图/控制器中，我这样调用这个方法：

```
MyModule::WebResource.headers[:some_id] = cookies[:some_id]
MyModule::my_method() 
```

在我的主应用程序中，我有线程安全！配置选项集。我知道线程安全！启用后，每个控制器都存在于每个请求的自己的线程中。

但是，这个模块是线程安全的吗？我怀疑所有请求只有一个该模块的副本，因此它本质**上不是**线程安全的，并且需要使用 Mutex 之类的手动同步。具体来说，我有在 ActiveResource 类**之外**设置 HTTP 请求标头的代码`WebResource`。这会导致线程问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:43:29.827

这将取决于您在此方法中执行的操作是否是线程安全的。如果它不接触类变量，那么它是线程安全的。

如果它在类级别存储或设置信息并假设在再次使用该信息之前没有其他方法会接触该信息，那么它不是线程安全的。

# c++ - What does this C++ syntax mean?

> ID：12484222
> 
> 赞同：5
> 
> 时间：2012-09-18T20:08:50.927
> 
> 标签：c++, syntax

Here's the statement. I believe this is using a cast operator, but what's the deal with the post increment?

```
(*C)(x_i,gi_tn,f)++; 
```

Declaration and definition of `C`:

```
std::auto_ptr<conditional_density> C(new conditional_density()); 
```

Declaration of the `conditional_density` class:

```
class conditional_density: public datmoConditionalDensity{
public:
  static const double l_min, l_max, delta;
  static double x_scale[X_COUNT];    // input log luminance scale
  double *g_scale;    // contrast scale
  double *f_scale;    // frequency scale      
  const double g_max;    
  double total;    
  int x_count, g_count, f_count; // Number of elements    
  double *C;          // Conditional probability function    
  conditional_density( const float pix_per_deg = 30.f ) :
    g_max( 0.7f ){
    //Irrelevant to the question               
  }    

  double& operator()( int x, int g, int f )
  {
    assert( (x + g*x_count + f*x_count*g_count >= 0) && (x + g*x_count + f*x_count*g_count < x_count*g_count*f_count) );
    return C[x + g*x_count + f*x_count*g_count];
  }

}; 
```

The parent class, `datmoConditionalDensity`, only has a virtual destructor.

It would have been easy to answer this by debugging the code, but this code won't build under Windows (needs a bunch of external libraries).

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-18T20:14:04.293

```
(*C)(x_i,gi_tn,f)++; 
```

让我们分解一下：

```
(*C) 
```

这取消了指针的引用。C 是一个智能指针，因此可以取消引用以获取指向的实际元素。结果是一个`conditional_density`对象。

```
(*C)(x_i,gi_tn,f) 
```

这将调用类中的重载`()`运算符`conditional_density`。第一次看到它可能会很奇怪，但它和其他所有东西一样都是操作员。底线是它调用此代码：

```
 double& operator()( int x, int g, int f )
  {
    assert( (x + g*x_count + f*x_count*g_count >= 0) && (x + g*x_count + f*x_count*g_count < x_count*g_count*f_count) );
    return C[x + g*x_count + f*x_count*g_count];
  } 
```

它返回对双精度的引用。最后：

```
(*C)(x_i,gi_tn,f)++ 
```

因为重载`()`运算符返回对双精度的引用，所以我可以使用`++`它来增加双精度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T20:12:58.573

如果我正确地解释了这一点，`C`则它是指向函数对象（已`operator()`定义的东西）的指针。这意味着

```
(*C)(x_i,gi_tn,f) 
```

表示“取消引用`C`以取回函数对象，然后使用参数`x_i`、`gi_tn`和调用它`f`。请注意，函数返回 a `double&`，所以这一行

```
(*C)(x_i,gi_tn,f)++; 
```

意思是“取消对 C 的引用，使用适当的参数调用函数，最后对结果进行后增量。”

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:13:23.280

operator()(int, int, int) 返回对 double 静态数组元素的引用。

++ 运算符递增返回的值。

# mercurial - Given a file, how to find out which revision in a mercurial repository this is?

> ID：12484224
> 
> 赞同：1
> 
> 时间：2012-09-18T20:08:51.410
> 
> 标签：mercurial

Assume that there is a file under `hg` version control. I have a particular version of that file, and I would like to find out in which revision this file was in this version.

I suspect that there are two possible ways to do this.

1.  Do `hg update` in a loop and diff the file against subsequent versions (sloooow, but should work).

2.  Make Mercurial put the rev number in a, say, comment in the second line of the file right before committing. From what I have read, a `precommit` hook might be of use. Then I don't have to compare anything, just look at the file itself (I'm assuming no-one will change this, of course, but this is rather safe assumption in my case).

My use case is a joint paper, written in LaTeX, with two coauthors who have no idea about version control at all, but I prefer to use it (for obvious reasons). We communicate by email, and there's effectively a human-based lock system ("I will not work on this file until you send me the next version, ok?"). The only problem that arises is that I'm sending version X to author B to proofread, then author C sends me a corrected version Y and I commit it into my repo, then author B sends *his* corrections Z (to version X) and I'm starting to get lost-but I can check the attachment in the email sent to B, and I only need to find out which revision it is.

So, my question is: which of the two ideas above would be better, or maybe there's yet another one to help me deal with this mess?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T22:49:28.300

`hg archive`是*未来工作*的好方法，但我可以建议至少 3 种替代工作方式和 1 种修正 find-correct-version 和更新

未来的工作

*   您可以为共同作者使用单独的命名分支，为合并结果使用默认分支，始终从他的分支发送共同作者，在得到更正后更新他的分支（您将永远知道，**您**发送了）并将分支合并为默认

*   一个分支，用书签标记的同事修订版，稍后您将其移至下一点

*   [Mercurial关键字](http://mercurial.selenic.com/wiki/KeywordExtension)以某种方式被认为是“[最后手段](http://mercurial.selenic.com/wiki/FeaturesOfLastResort)”，但在您的情况下，这是显而易见且可用的解决方案：只需在文件中添加带有哈希ID的关键字（默认扩展名而不是钩子 - 更容易和更可靠）

当前状态

要使用文件源查找变更集，您可以尝试使用[bisect](http://www.selenic.com/mercurial/hg.1.html#bisect)（[示例](http://alostale.wordpress.com/2009/03/02/using-mercurials-bisect-extension-to-find-bugs/)）并在 test-script、fe、文件的 CRC 中进行测试（您需要未版本化文件的 CRC，检查历史版本的文件）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:56:42.257

如果您乐于找到您发送给审阅者的电子邮件，为什么不将修订哈希与文件一起包含在其中？

您可以通过使用 生成附件，以几乎零额外的工作量获得此`hg archive`文件，这将创建一个文件，其中包含 1) 供审查的文件，以及 2) `.hg_archival.txt`，并带有修订哈希。

尽管如果没有更优雅的方式我会感到惊讶，即使您的合作者坚决反对使用版本控制。

# vb.net - 暂停和恢复线程（后台工作人员）

> ID：12484226
> 
> 赞同：1
> 
> 时间：2012-09-18T20:09:13.953
> 
> 标签：vb.net, multithreading

我在 VB.Net 中工作，我需要暂停一个线程，因为它等待另一个线程完成。

我已经看到了一个非常接近的问题，但似乎无法弄清楚（并且无法评论[后台工作人员中的 Pause/Resume loop](https://stackoverflow.com/questions/8359058/pause-resume-loop-in-background-worker)帖子）

我的情况是我有 2 个后台工作人员。Worker1 将文件名传递给处理文件的 Worker2。如果 Worker2 还没有完成，我需要暂停 Worker1。即Worker1只有在Worker2完成后才释放下一个fileName

关于如何做到这一点的任何想法？

**来自@user1666788 的评论后的工作代码**

下面的代码适用于上述两个后台工作人员的场景，其中一个必须等​​待另一个完成才能继续。

```
Dim isFinished as boolean
Dim currentFiile as integer

Private Sub StartWork_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles StartWork.Click
    bgWorker1.WorkerSupportsCancellation = True
    isFinished = True
    currentFile = 0
    bgWorker1.RunWorkerAsync()
End Sub

Private Sub bgWorker1_DoWork(ByVal sender As System.Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles bgWorker1.DoWork
    If isFinished = False Then
        bgWorker1.CancelAsync()
    End If
    isFinished = False
    For i = currentFile To fileNames.Count - 1
        Dim fileName As String = fileNames(i)
        LoadRules(myValidator.GetFileType(fileName))
        If i = fileNames.Count Then bgWorker1.CancelAsync()
        Exit Sub
    Next
End Sub

Private Function LoadRules(ByVal fileType As String) As Boolean
    ' Function to load some rules for file processing
    Try

        ' Start Thread for actual file processing using bgworker2
        bgWorker2.WorkerSupportsCancellation = True
        bgWorker2.RunWorkerAsync()
        Return True
    Catch ex As Exception

    End Try
End Function

Private Sub bgWorker2_DoWork(ByVal sender As System.Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles bgWorker2.DoWork

    Try

         ' Do your thing here
         ' for x is 0 to 1million
         ' next

        ' Mark is finished to true
        isFinished = True

        ' Set currentFile
        currentFile += 1

        ' The bgWorker1 is restarted when bgWorker2 has finished.
        ' Note however that bgWorker1 will "Continue" where it left off due to the property "currentFile"
        bgWorker1.RunWorkerAsync()

        '++++++++++++++++++++++++++++++++++++
    Catch ex As Exception

    End Try
End Sub 
```

你去吧。它按预期工作。现在需要弄清楚如何“监控”将文件写入磁盘的进度，以便在文件完全创建后我可以启动另一个进程.....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:25:49.550

我有一个类似的问题。根据VS告诉我的内容，它无法完成。但是，我找到了一种绕过子程序的方法，用于暂停/恢复不再使用的线程。

最简单的方法是检查进度，如果它仍在工作，则结束通话。这是一个示例，将 S1 想象为您的第一个线程，将 S2 作为您的第二个线程。

```
sub S1()

if(processingfile)then exit sub

'Insert code here for sending next file for processing

end sub

sub S2()
processingfile = true

'Insert code for processing files

processingfile = false

end sub 
```

这或多或少是我解决这个问题的方式。我希望我的建议有所帮助:)

Oh and one more thing, you might want to sleep the first thread before checking if the file is processing so that it doesn't use up a bunch of CPU power. But that's just a guess, I haven't tried it without a short sleeping period

# visual-studio-2012 - Configuring Controls for Windows Forms and WPF inside Toolbox in Visual Studio 2012 Express edition

> ID：12484228
> 
> 赞同：0
> 
> 时间：2012-09-18T20:09:19.773
> 
> 标签：visual-studio-2012

I tried to configure the windows forms(4.0) and WPF products(4.0) assemblies in visual studio 2012 toolbox. But i am unable to configure the assemblies manually into Visual Studio 2012 toolbox. it shows the "There are no components in {Assembly Path} that can be placed on toolbox" error.

Also i am able create only WPF application (machine configuration-> Win 8 + VS2012 Express edition)

Can you please tell, how to configure the custom assemblies(.net framework 4.0) in VS toolbox?

Regards, Siva S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:13:30.773

从`Tools`菜单选项中选择“ `Customize Toolbox`”然后选择yourAssembly.dll 程序集`browse`和`select``click OK.`

您现在将看到列在`toolboxTool`

# node.js - dev environment for jade/haml, sass/stylus and coffee (maybe AMD) - nodejs

> ID：12484239
> 
> 赞同：0
> 
> 时间：2012-09-18T20:10:06.667
> 
> 标签：node.js, coffeescript, development-environment, pug, stylus

I've recently switched from jsfiddle to codepen.io - after a long look at all possiblities - and am enjoying it

I'd like to replicate a similar environment locally, building ideally jade/stylus/coffee, but equivalents of the first two are okay. Ideally Node.js based. Something like brunch.io is abstracted a little too far for my desires.

Well, ideally I'd like a SaaS IDE offering a Chocolat style environment and managing the file system and build process (know any?) but I can't think of anything ;-)

So, to bring it back to a question - does anyone know a starter kit, bundling together the appropriate node modules, a simple scaffold, and appropriate watch commands into one?

It's something I can build myself - but thought best to see if there is anything I can leverage.

... I might also have another plan with brunc

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T08:01:40.427

如果你想要一些看起来像 CoffeeScript + Express 模板/入门工具包的东西，那么有一些项目，比如[骨架](https://github.com/EtienneLem/skeleton)和[express-coffee](https://github.com/twilson63/express-coffee)。我最近将[frappe](https://github.com/dweldon/frappe)放在一起，它结合了我从这些项目中喜欢的一些元素。它包含一些基本路线和一些示例代码，以帮助您入门。

# unit-testing - 设置 Moq 以返回多个值

> ID：12484241
> 
> 赞同：0
> 
> 时间：2012-09-18T20:10:24.263
> 
> 标签：unit-testing, moq

我是 Moq 的新手，我想进行这样的测试：

```
[Fact]
        public void IsClientExternalForWebShouldReturnFalse()
        {
            // Arrange
            var request = new Mock<HttpRequestBase>();
            request.Setup(r => r.UserHostAddress).Returns(new Queue<string>(new[] { "127.0.0.1", "10.1.10.1" }).Dequeue);

            var context = new Mock<HttpContextBase>();
            context.SetupGet(c => c.Request).Returns(request.Object);

            var service = new EnvironmentService(context.Object, null);

            // Act / Assert
            service.IsClientExternal.Should().BeFalse();
            service.IsClientExternal.Should().BeFalse();
        } 
```

它抛出这个：

```
------ Test started: Assembly: SAIF.Services.Tests.dll ------

Test 'SAIF.Services.Tests.EnvironmentServiceTests.IsClientExternalForWebShouldReturnFalse' failed: System.InvalidOperationException : Queue empty.
    at System.ThrowHelper.ThrowInvalidOperationException(ExceptionResource resource)
    at System.Collections.Generic.Queue`1.Dequeue()   at System.ThrowHelper.ThrowInvalidOperationException(ExceptionResource resource)
    at System.Collections.Generic.Queue`1.Dequeue()   at Moq.Extensions.InvokePreserveStack(Delegate del, Object[] args)
    at Moq.MethodCallReturn`2.Execute(ICallContext call)
    at Moq.Interceptor.Intercept(ICallContext invocation)
    at Moq.Proxy.CastleProxyFactory.Interceptor.Intercept(IInvocation invocation)
    at Castle.DynamicProxy.AbstractInvocation.Proceed()
    at Castle.Proxies.HttpRequestBaseProxy.get_UserHostAddress()
    Services\EnvironmentService.cs(54,0): at SAIF.Services.EnvironmentService.<get_IsClientExternal>b__3(String ip)
    at System.Linq.Enumerable.Any[TSource](IEnumerable`1 source, Func`2 predicate)
    Services\EnvironmentService.cs(54,0): at SAIF.Services.EnvironmentService.get_IsClientExternal()
    EnvironmentServiceTests.cs(25,0): at SAIF.Services.Tests.EnvironmentServiceTests.IsClientExternalForWebShouldReturnFalse()

0 passed, 1 failed, 0 skipped, took 0.69 seconds (xUnit.net 1.9.1 build 1600). 
```

实际测试代码：

```
public bool IsClientExternal
        {
            get { return IsWeb && !internalAddressRoots.Any(ip => httpContext.Request.UserHostAddress.StartsWith(ip)); }
        } 
```

但是，如果我只在它工作后才调用该服务，但该服务只获得第一个值。

此外，如果我调试并将鼠标悬停在 上`httpContext.Request.UserHostAddress`，则值会更改。

有任何想法吗？

**编辑#1**

所以我发现了我认为的问题。这个问题是被测试的实际代码循环通过所有 ip 并调用`UserHostAddress`. 我只需要弄清楚如何将字符串数组提供`Returns()`给模拟函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:34:14.803

您的`UserHostAddress`属性可能会在调用中被调用几次`Any`，我们不知道它会被调用多少次（取决于 的内容`internalAddressRoots`）。因此，当您进行第二次服务呼叫时，您的队列可能是空的。

如果你真的想测试两次，也许你应该设置两次。后续设置会覆盖之前的设置：

```
 public void IsClientExternalForWebShouldReturnFalse()
    {
        // Arrange
        var request = new Mock<HttpRequestBase>();
        request.Setup(r => r.UserHostAddress).Returns("127.0.0.1");

        var context = new Mock<HttpContextBase>();
        context.SetupGet(c => c.Request).Returns(request.Object);

        var service = new EnvironmentService(context.Object, null);

        // Act / Assert
        service.IsClientExternal.Should().BeFalse();

        request.Setup(r => r.UserHostAddress).Returns("10.1.10.1");
        service.IsClientExternal.Should().BeFalse();
    } 
```

如您所见，我们将设置与断言部分混合在一起，看起来不太好，但我不确定您的动机，所以这是一种可能的解决方案。

# objective-c - 如何管理 iPhone 5 的背景图像？

> ID：12484244
> 
> 赞同：12
> 
> 时间：2012-09-18T20:10:32.670
> 
> 标签：objective-c, uiimageview, uiimage, ios6, iphone-5

我的一些应用程序使用自定义图像作为背景。检查屏幕尺寸以放置正确图像的正确方法是什么？

在 viewDidLoad 中是否应该是这样的：

```
if ([UIScreen mainScreen] == 2.0)
{
     UIImage * backgroundImage = [UIImage imageNamed:@"bgimage-568h@2x.png"];
     backgroundImageView = [[UIImageView alloc] initWithImage:backgroundImage]];
}
else
{
    UIImage * backgroundImage = [UIImage imageNamed:@"bgimage.png"];
    backgroundImageView = [[UIImageView alloc] iniWithImage:backgroundImage]];
} 
```

非常感谢任何提示/建议！

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-18T20:23:42.790

以下代码检查屏幕的大小/边界。如果屏幕是 586 点（请记住，由于 Retina，屏幕以点为单位测量）比我们知道它是新的 4 英寸 Retina 显示屏。

```
if ([[UIScreen mainScreen] bounds].size.height == 568)
{
   UIImage * backgroundImage = [UIImage imageNamed:@"bgimage-568h@2x.png"];
   backgroundImageView = [[UIImageView alloc] initWithImage:backgroundImage];
}
else
{
   UIImage * backgroundImage = [UIImage imageNamed:@"bgimage.png"];
   backgroundImageView = [[UIImageView alloc] initWithImage:backgroundImage];
} 
```

另请参阅[iOS 6 应用程序 - 如何处理 iPhone 5 的屏幕尺寸？](https://stackoverflow.com/questions/12396545/how-to-deal-with-iphone-5-screen-size)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T19:51:32.093

上面布莱恩的回答对我有用，除了我必须使用

```
[self.bgImageView setImage:backgroundImage]; 
```

而不是

```
backgroundImageView = [[UIImageView alloc] initWithImage:backgroundImage]; 
```

只有当我使用前者时才会显示正确的图像。

# performance - Possible improvements in clojure "official" concurrency example (using locks,atoms,stm)

> ID：12484250
> 
> 赞同：5
> 
> 时间：2012-09-18T20:11:10.503
> 
> 标签：performance, concurrency, clojure, jvm, stm

i am trying to get [the "official" example of clojure concurrency](http://clojure.org/concurrent_programming) closer to a java version using manual locking. [In this gist](https://gist.github.com/3712560) i put the java and clojure code and the thread dump of a VisualVm profile of all versions. Here it is the clojure code and timing

```
(ns simple-example (:gen-class))
(set! *warn-on-reflection* true)
;; original from: http://clojure.org/concurrent_programming
(import '(java.util.concurrent Executors Future)
SimpleLocking$Node)

(defn test-concur [iter refs nthreads niters]
  (let [pool (Executors/newFixedThreadPool nthreads)
        tasks (map (fn [t]
                      (fn []
                        (dotimes [n niters]
                          (iter refs t))))
                   (range nthreads))]
    (doseq [^Future future (.invokeAll pool tasks)]
      (.get future))
    (.shutdown pool)))

(defn test-stm [nitems nthreads niters]
  (let [refs (vec (map ref (repeat nitems 0)))
        iter #(dosync (doseq [r %] (alter r + 1 %2)))]
    (test-concur iter refs nthreads niters)
    (map deref refs)))

(defn test-atom [nitems nthreads niters]
  (let [refs (vec (map atom (repeat nitems 0)))
        iter #(doseq [r %] (swap! r + 1 %2))]
    (test-concur iter refs nthreads niters)
    (map deref refs)))

;; SimpleLocking$Node is the class with the synchronized method of java version
(defn test-locking [nitems nthreads niters]
  (let [refs (->> (repeatedly #(SimpleLocking$Node.))
                    (take nitems) vec)
        iter #(doseq [^SimpleLocking$Node n %] (.sum n (+ 1 %2)))]
    (test-concur iter refs nthreads niters)
    (map (fn [^SimpleLocking$Node n] (.read n)) refs)))

(definterface INode
  (read [])
  (add [v]))

(deftype Node [^{:unsynchronized-mutable true} value]
  INode
  (read [_] value)
  (add [this v] (set! value (+ value v))))

(defn test-locking-native [nitems nthreads niters] 
  (let [refs (->> (repeatedly #(Node. 0))
          (take nitems) vec) 
    iter #(doseq [^Node n %]
          (locking n (.add n (+ 1 %2))))]
    (test-concur iter refs nthreads niters)
    (map (fn [^Node n] (.read n)) refs)))

(defn -main [& args]
  (read-line)
  (let [[type nitems nthreads niters] (map read-string args)
    t #(apply + (time (% nitems nthreads niters)))]
    (case type
      'lock (println "Locking:" (t test-locking)) 
      'atom (println "Atom:" (t test-atom))
      'stm (println "STM:" (t test-stm))
      'lock-native (println "Native locking:" (t test-locking-native))))) 
```

Time (in an "old" intel core duo):

```
Java version
int nitems=100;
int nthreads=10;
final int niters=1000;
Sum node values: 5500000
Time: 31

simple-example=> (-main "lock" "100" "10" "1000")
"Elapsed time: 60.030324 msecs"
Locking: 5500000
nil
simple-example=> (-main "atom" "100" "10" "1000")
"Elapsed time: 202.309477 msecs"
Atom: 5500000
nil
simple-example=> (-main "stm" "100" "10" "1000")
"Elapsed time: 1830.568508 msecs"
STM: 5500000
nil
simple-example=> (-main "lock-native" "100" "10" "1000")
"Elapsed time: 159.730149 msecs"
Native locking: 5500000
nil 
```

NOTE: I dont want get a clojure version as fast as java one, or a stm version as fast as clojure using locks one. I know that is in general difficult and with some problems impossible. I know the use of atoms and stm is more composable,easier to use and less error prone than using manual locks. Those version are only the best possible referents in java and clojure for the problem (well i did my best). My objective is get the atom and stm versions closer to locking ones, or to understand why (maybe in this concrete example) is not possible to speed up those versions.

NOTE: Another comparation, this time with haskell versions using STM and MVars (code in same gist linked):

```
>SimpleExampleMVar 100000 1000 6
Starting...
2100000000
Computation time: 11.781 sec
Done.

>SimpleExampleSTM 100000 1000 6
Starting...
2100000000
Computation time: 53.797 sec
Done.

>java -cp classes SimpleLocking
Sum node values: 2100000000
Time: 15.703 sec

java -cp classes;%CLOJURE_JAR% simple_example lock 1000 6 100000
"Elapsed time: 27.545 secs"
Locking: 2100000000

java -cp classes;%CLOJURE_JAR% simple_example lock-native 1000 6 100000
"Elapsed time: 80.913 secs"
Native locking: 2100000000

java -cp classes;%CLOJURE_JAR% simple_example atom 1000 6 100000
"Elapsed time: 95.143 secs"
Atom: 2100000000

java -cp classes;%CLOJURE_JAR% simple_example stm 1000 6 100000
"Elapsed time: 990.255 secs"
STM: 2100000000 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T02:27:53.867

您并没有像这里那样真正进行比较 - Clojure 版本正在创建和交换新的不可变盒装数字，而 Java 版本只是`int`在同步方法中碰撞可变原始计数器。

您可以在 Clojure 中执行普通的 Java 风格的手动锁定，方法如下：

```
(locking obj (set! (. obj fieldName) (+ 1 (.fieldName obj))))) 
```

该`locking`构造实际上等效于 Java`synchronized`代码块。

如果您使用类型提示的 Java 对象或带有`:unsynchronized-mutable`字段的 Clojure deftype 执行此操作，那么我认为您应该能够匹配纯 Java 同步性能。

尚未对此进行测试，但我认为它也应该与原语一起使用（如果您正在递增`long`计数器等，这可能很有用）

# asp.net-mvc-3 - Where to put my queries - model vs. controller

> ID：12484251
> 
> 赞同：0
> 
> 时间：2012-09-18T20:11:26.170
> 
> 标签：asp.net-mvc-3, architecture, dapper

I [just switched from ActiveRecord/NHibernate to Dapper](https://stackoverflow.com/questions/12396241/ditching-activerecord-and-nhibernate-how-to-rearchitect). Previously, I had all of my queries in my controllers. However, some properties which were convenient to implement on my models (such as summaries/sums/totals/averages), I could calculate by iterating over instance variables (collections) in my model.

To be specific, my `Project` has a notion of `AppSessions`, and I can calculate the total number of sessions, plus the average session length, by iterating over `someProject.AppSessions`.

Now that I'm in Dapper, this seems confused: my controller methods now make queries to the database via Dapper (which seems okay), but my model class also makes queries to the database via Dapper (which seems strange).

**TLDR: Should the DB access go in my model, or controller, or both?** It seems that both is not correct, and I would like to limit it to one "layer" so that changing DB access style later doesn't impact too much.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:04:50.390

您应该考虑使用[存储库模式](http://msdn.microsoft.com/en-us/library/ff649690.aspx)：

使用存储库，所有数据库查询都封装在通过公共接口公开的存储库中，例如：

```
public interface IGenericRepository<T> where T : class
{
    T Get(object id);
    IQueryable<T> GetAll();
    void Insert(T entity);
    void Delete(T entity);
    void Save(T entity);
} 
```

然后您可以将存储库[注入](https://stackoverflow.com/questions/130794/what-is-dependency-injection)控制器：

```
public class MyController
{
    private readonly IGenericRepository<Foo> _fooRepository;
    public MyController(IGenericRepository<Foo> fooRepository)
    {
        _fooRepository = fooRepository;
    }   
} 
```

这使 UI 不受任何数据库依赖，并使测试更容易；从单元测试中，您可以注入任何实现 IRepository 的模拟。这也允许存储库在没有任何客户端更改的情况下随时实现和切换 Dapper 或实体框架等技术。

上面的示例使用了通用存储库，但您不必这样做；您可以为每个存储库创建一个单独的接口，例如 IFooRepository。

存储库模式的实现方式有很多示例和多种变体，因此请谷歌更多了解它。这是我最喜欢的文章之一。[分层架构](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)。

另一个注意事项：对于小型项目，直接将查询放入控制器中应该可以...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:34:17.753

我同意@void-ray 关于存储库模型的观点。但是，如果您不想进入接口和依赖注入，您仍然可以分离出数据访问层并使用静态方法从 Dapper 返回数据。

当我使用 Dapper 时，我通常有一个 Repository 库，它返回非常小的对象或列表，然后可以将它们映射到 ViewModel 并传递给 View（映射由 StructureMap 完成，但可以在控制器或其他助手中处理） .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:13:16.603

我个人不能代表 dapper，但我一直限制我的数据库访问模型，除非在非常罕见的情况下。在我看来，这似乎是最有意义的。

更多信息：[http ://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)

> 当模型的状态发生变化时，模型会通知其关联的视图和控制器。此通知允许视图生成更新的输出，并允许控制器更改可用的命令集。MVC 的被动实现忽略了这些通知，因为应用程序不需要它们或软件平台不支持它们。

基本上，模型中的数据访问似乎是标准。

# sql - SQL Percentage Count Query By Date

> ID：12484254
> 
> 赞同：1
> 
> 时间：2012-09-18T20:11:54.557
> 
> 标签：sql, ms-access-2007

I am able to calculate the percentage count on a particular date in a Microsoft Access 2007 SQL query using:

```
SELECT Date, Val, (Count(Val) / (SELECT Count(*) From Table HAVING Date=#7/31/2012#) as PercentVal    
FROM Table  
GROUP BY Date, Val  
HAVING Date=#7/31/2012# 
```

However, I would like to make this same calculation over every date using the count totals . For instance, the query:

```
SELECT Date, Val, Count(*) AS CountVal  
FROM Table  
GROUP BY Date, Val 
```

finds the counts in every period. I would like to add an additional column with the percent counts. However, I can't seem to figure out how to calculate count percentage in every period without using the above block of text and setting up queries for each individual period.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:27:19.663

您可以像这样子查询它：

```
SELECT A.ADate, A.Val, COUNT(A.Val) / B.DateCount
FROM Table1 AS A
INNER JOIN (
    SELECT C.ADate, COUNT(*) AS DateCount
    FROM Table1 C
    GROUP BY C.ADate
) AS B ON A.ADate = B.ADate
GROUP BY A.ADate, A.Val, B.DateCount 
```

# php - SimpleXML PHP 变量问题

> ID：12484268
> 
> 赞同：0
> 
> 时间：2012-09-18T20:13:00.690
> 
> 标签：php, xml, json, simplexml

您将在下面找到我的 xml 文档：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<app>
    <version>0925</version>
    <humanVersion>0.9.25</humanVersion>
</app> 
```

这是我的php：

```
$completeurl = "ota/shingle/shingle.xml";
$xml = simplexml_load_file($completeurl);
$updateVer = $xml->version;
$updateVerHuman = $xml->humanVersion; 
```

我正在获取 php 变量并将它们放入 json 字符串中，这是输出：

{"updateVer":{"0":"0925"},"updateVerHuman":{"0":"0.9.25"}}

为什么 updateVer 和 updateVerHuman 数据包含在 {} 中并且包含“0”:?? 我只想要那个值的数据。我如何实现这一目标？

我已经尝试过了，但它产生了相同的结果：

```
$updateVer = $xml->version[0];
$updateVerHuman = $xml->humanVersion[0]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T20:28:15.660

当您使用 SimpleXML 访问任何子元素（甚至属性）时，您会返回另一个 SimpleXML 对象 - 这就是您可以编写类似`$node->child->grand_child`.

为了只获取特定 XML 位的字符串内容，您需要将 SimpleXML 对象“转换”为字符串，使用`(string)$variable`.

有时，这会发生在你身上——值得注意的是，因为你不能回显字符串以外的任何东西，所以`echo $variable`总是会为你转换为字符串。但是，**根据经验，始终将 SimpleXML 对象转换为字符串**以避免以后混淆。

在您的示例中，当您将它们转换为 JSON 时`$updateVer`，`$updateVerHuman`它们仍然是对象。`$updateVer = (string)$xml->version; $updateVerHuman = (string)$xml->humanVersion;`应该给出预期的结果。

# javascript - 从 ASP.net 代码隐藏有条件地关闭 jquery 模式窗口

> ID：12484280
> 
> 赞同：1
> 
> 时间：2012-09-18T20:13:31.067
> 
> 标签：javascript, jquery, asp.net, colorbox

我有一个 ASP.net 页面，其中包含打开基于 jquery 的模式窗口（使用 colobox jquery 插件）的链接。该窗口的内容从另一个 aspx 文件加载（它加载一个 iframe）。当用户按下 asp:button 并且我的代码隐藏中的某些条件顺利时，我想关闭该窗口。

我尝试了很多方法来从代码隐藏中关闭该窗口，如下所示：

```
Page.RegisterStartupScript("X", @"$(this).dialog('close');");

Page.RegisterStartupScript("X", @"var win = window.open('','_self'); win.close();");

btnDone.Attributes.Add("onclick", @"var win = window.open('','_self'); win.close();");

btnDone.Attributes.Add("onclick", @"window.open('../px/nsk.aspx', '_self', null); window.close(); ");

System.Web.HttpContext.Current.Response.Write("<SCRIPT LANGUAGE='JavaScript'>");
            System.Web.HttpContext.Current.Response.Write("self.close();");
            System.Web.HttpContext.Current.Response.Write("</SCRIPT>"); 
```

但他们都不能关闭那个模态窗口。我正在测试最新版本的 Firefox。后面的代码可以被认为是这样的：

```
 // do some database works
if (condition)
{
   // close this modal window
} 
```

我也尝试了 jquery 的方法，但没有一个成功。你能告诉我如何关闭这个窗口吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T00:57:52.037

给出的其他答案提供了细节；这个“答案”试图更具概念性/咨询性。

**关闭窗口**

关闭彩盒窗口是在客户端完成的。@KennyZ 和 @Farshid 都提供了有关如何执行此操作的详细信息。默认情况下，ColorBox 将在按下 ESC 或其 EXIT ui 元素（如果使用）时关闭。也可以通过编程方式关闭该框，这听起来像是您需要做的。

**调用的关闭操作在哪里？**

@KennyZ 提出了一个 Ajax 调用来确定“我的代码隐藏中的某些条件是否顺利”；假设您不能容忍整页刷新（这对我来说似乎是合理的），但这是您自己决定的事情。

如果“顺利”的确定只能在服务器上完成，那么您正在查看 Ajax 或整页刷新。

或者，如果有一种方法可以在客户端做出决定，那么您根本不需要回到后端。只需使用 js 关闭颜色框窗口即可。

如果您可以提供有关控制关闭/不关闭 ColorBox 窗口的操作的更多详细信息，也许社区可以提供更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:22:14.010

问题接缝以这种方式解决：

```
 Page.ClientScript.RegisterStartupScript(GetType(), 
        "CloseKey", "parent.$.colorbox.close();", true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:32:42.913

使用带有 div 而不是 iframe 的 jQuery 对话框。

然后，您可以使用 Ajax 帖子来运行服务器端代码并​​查看结果以决定如何处理该对话框。

声明对话框：

```
 $(document).ready(function () {
        jQuery("#MyDialog").dialog(
            {
                bgiframe: true,
                autoOpen: false,
                modal: true,
                width: 800,
                position: ['center', 100]
            }
        );
    }); 
```

填充对话框并打开它：

```
 $('#OpenMyDialog').click(function () {
        $.post($('url_for_dialog_contents'), function (data) {
            $("#MyDialog").empty();
            $("#MyDialog").append(data);
        }, null, "html");
        $('#MyDialog').dialog('open');
        return false;
    }); 
```

提交对话框：

```
 $('#SubmitMyDialog').click(function () {
        $.post($('url_for_dialog_action'), function (data) {
            if (data.success == true) { $('#MyDialog').dialog('close'); }
        }, null, "json");
    }); 
```

我确定您在提交对话框中需要更多代码，但这是一般的想法。

# actionscript - 加载文件 Flex 2

> ID：12484281
> 
> 赞同：0
> 
> 时间：2012-09-18T20:13:38.070
> 
> 标签：actionscript, actionscript-2, flex2

如何从用户选择中加载文件？

在以后的 flex 版本中，可以使用 FileReference.load() 方法。但在 flex 2 中没有。

我想做这样的事情：

```
var fileRef:FileReference= new FileReference();
button.addEventListener(MouseEvent.CLICK, onButtonClick);

function onButtonClick(e:MouseEvent):void {
    fileRef.browse([new FileFilter("Images", "*.jpg;*.gif;*.png")]);
    fileRef.addEventListener(Event.SELECT, onFileSelected);
}

function onFileSelected(e:Event):void {
    fileRef.addEventListener(Event.COMPLETE, onFileLoaded);
    fileRef.load();
}

function onFileLoaded(e:Event):void {
    var loader:Loader = new Loader();
    loader.loadBytes(e.target.data);
} 
```

# javascript - 使用 jQuery 在下拉列表中分配和检索多个值

> ID：12484282
> 
> 赞同：1
> 
> 时间：2012-09-18T20:13:38.227
> 
> 标签：javascript, jquery, html

> **可能重复：**
> [使用 jQuery 添加其他数据以选择选项](https://stackoverflow.com/questions/4564659/adding-additional-data-to-select-options-using-jquery)

除了使用“值”属性并使用标记来拆分内容之外，有没有办法将多个值分配给单个 HTML 元素？

我想做这样的事情：

```
<select id="car_model">
  <option value="1" value2="seddan" value3="Volvo">Volvo S60</option>
  <option value="2" value2="compact" value3="Saab">Saab s93</option>
  <option value="3" value2="convertible" value3="Mercedes">Mercedes SLK</option>
  <option value="4" value2="compact" value3="Audi">Audi 3</option>
</select> 
```

如何使用 jQuery 检索所选选项的所有值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:16:36.957

有几件事浮现在脑海中。正如您所暗示的，您可以`value`使用某种分隔符将元素中的所有数据包括在内，如下所示：

```
<option value="1,seddan,Volvo">Volvo S60</option> 
```

另一种选择是使用数据注释：

```
<option value="1" data-value2="seddan" data-value3="Volvo">Volvo S60</option> 
```

您选择哪个很大程度上取决于您将如何使用它。如果您提供有关您计划如何使用数据的更多细节，我可以更新此答案。

要在第一种情况下检索数据，它看起来像这样：

```
var values = $('#car_model').val().split(',');
console.log( values[0] );  // prints 1
console.log( values[1] );  // prints "seddan"
console.log( values[2] );  // prints "Volvo" 
```

在第二种情况下，它看起来像这样：

```
console.log( $('#car_model').val() );            // prints 1
console.log( $('#car_model').data('value2') );   // prints "seddan"
console.log( $('#car_model').data('value3') );   // prints "Volvo 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:23:51.380

您可以分配多个值并使用 attr 方法检索它们..您可以试试这个..

```
​$('#car_model').on('change', function() {
    var val = $(this).find('option:selected').attr('value');
    var val2 = $(this).find('option:selected').attr('value2');
    var val3 = $(this).find('option:selected').attr('value3');
    alert( 'Value - '+ val + ':: Value2 - '+ val2 + ' :: Value3 - '+ val3 ) 
});​ 
```

但我认为用标识符分隔值更有意义，也许用逗号或斜杠

检查[小提琴](http://jsfiddle.net/sushanth009/jS4by/)

# php - PHP调用未定义的方法，但方法已定义......（与其他2个类似问题不同）

> ID：12484283
> 
> 赞同：0
> 
> 时间：2012-09-18T20:13:43.467
> 
> 标签：php, caching, directory, fatal-error

我正在学习一个用 PHP 构建模拟 Flickr 站点的教程。我正在添加所有用户 CRUD。用户类已经被定义并且具有正在使用和工作的方法。但是，一旦我添加了创建、更新、删除和保存的方法，它就会说找不到它们中的任何一个……我尝试修改有效的方法，但它们并没有改变。所以对我来说，似乎有一个用户类的缓存版本，因为 user.php 文件中的更改没有被识别。我已经使用 ctrl+F5 来刷新缓存，但这并没有改变任何东西......

这是我设置的目录

```
wamp
  www
    photo_gallery
      includes
        config.php
        constants.php
        database.php
        database_object.php
        functions.php
        initialize.php
        session.php
        user.php
      public
        admin
          index,php
          login.php
          logout.php
          logfile.php
          test.php
        images
        javascript
        layouts
        stylesheets
        index.php 
```

这是我的 initialize.php 文件，它设置目录路径并加载所有需要的文件

```
<?php
    // Define the core paths
    // Define them as absolute paths to make sure that require_once works as expected

    //DIRECTORY_SEPARATOR is a php pre-defined constant
    // ( \ for Windows, / for Unix)
    defined('DS') ? null : define('DS', DIRECTORY_SEPARATOR);

    // checks if lib path exists if not defines the site root with the directory specified below
    // ***** needs to be updated when switched directories, servers or computers
    defined('SITE_ROOT') ? null :
        define('SITE_ROOT', DS.'Users'.DS.'Alan D'.DS.'Desktop'.DS.'wamp'.DS.'www'.DS.'photo_gallery');

    // Checks if lib path has been defined, if not it defines it using site path above
    defined('LIB_PATH') ? null : define('LIB_PATH', SITE_ROOT.DS.'includes');

    // first load config
    require_once(LIB_PATH.DS.'config.php');

    // load basic functions that are available for all other files
    require_once(LIB_PATH.DS.'functions.php');

    // load core object classes for application
    require_once(LIB_PATH.DS.'session.php');
    require_once(LIB_PATH.DS.'database.php');
    require_once(LIB_PATH.DS.'database_object.php');

    // load database-related object classes
    require_once(LIB_PATH.DS.'user.php'); 

?> 
```

这是用户类，在我测试时它比这个更简单，但我继续按照步骤使方法能够在我创建它们时放入我的其他类中。

```
<?php
    require_once('database.php');

    class User extends DatabaseObject{

        protected static $db_fields = array('id', 'user_name', 'password', 
        'first_name', 'last_name');
        protected static $table_name="users";

        public $id;
        public $user_name;
        public $password;
        public $first_name;
        public $last_name;

        public function full_name(){
            if(isset($this->first_name) && isset($this->last_name)){
                return $this->first_name . " " . $this->last_name;
            } else {
                return "";
            }       
        }

        // authenticates user by checking if there is a row with the 
        // input user name and password, then returns the object if found
        // if not it returns false
        public static function authenticate($user_name="", $password=""){
            global $database;
            $user_name = $database->escape_values($user_name);
            $password = $database->escape_values($password);

            $sql = "SELECT * FROM users ";
            $sql .= "WHERE user_name = '{$user_name}' ";
            $sql .= "AND password = '{$password}' ";
            $sql .= "LIMIT 1";
            $result_array = self::find_by_sql($sql);

            return !empty($result_array) ? array_shift($result_array) : false;
        }

        // checks to see if the given attribute exsits for the current object
        private function has_attribute($attribute){
            // associative array with all attributes key and value pairs
            $object_vars = $this->attributes();

            // just check if the key exists and return true or false
            return array_key_exists($attribute, $object_vars);          
        }

        // returns a key value hash of the objects variables and values
        protected function attributes(){
            // get_object_vars returns an associative array with all attributes
            // (incl private) as the keys and their current values as value
            // return get_object_vars($this);   

            // this goes through the db fields and populates the hash
            $attributes = array();
            foreach(self::$db_fields as $field){
                if(property_exists($this, $field)){
                    $attributes[$field] = $this->$field;
                }
            }
            return $attributes;
        }

        // returns a sanitized (sql escaped) array of all the attributes
        protected function sanitized_attributes(){
            global $database;
            $clean_attributes = array();

            // sanitize the values before submitting
            // Note: does not alter the actual value of each attribute
            foreach($this->attributes() as $key => $value){
                $clean_attributes[$key] = $database->escape_value($value);
            }
            return $clean_attributes;
        }

        // this function check to see if the record is already there
        // and determines whether to create or update.
        public function save(){
            return isset($this->id) ? $this->update() : $this->create();
        }

        public function create(){
            global $database;
            $attributes = $this->sanitized_attributes();

            $sql = "INSERT INTO ".self::$table_name." (";
            $sql .= join(", ", array_keys($attributes));
            $sql .= ") VALUES ('";
            $sql .= join("', '", array_values($attributes));
            $sql .= "')";
            if($database->query($sql)){
                $this->id = $database->insert_id();
                return true;
            } else {
                return false;
            }
        }

        public function update(){
            global $database;
            $attributes = $this->sanitized_attributes();

            // set up the key, value string needed for the update statement
            foreach ($attributes as $key => $value){
                $attribute_pairs[] = "{$key}='{$value}'";
            }

            $sql = "UPDATE ".self::$table_name." SET ";
            $sql .= join(", ", $attribute_pairs);
            $sql .= " WHERE id='". $database->escape_value($this->id);

            $database->query($sql);
            return($database->affected_rows() == 1) ? true : false;
        }

        public function delete(){
            global $database;

            $sql = "DELETE FROM ".self::$table_name." ";
            $sql .= "WHERE id=". $database->escape_value($this->id);
            $sql .= " LIMIT 1";

            $database->query($sql);
            return($database->affected_rows() == 1) ? true : false;
        }       
    }
?> 
```

在 admin/test.php 文件中它是这样设置的

```
<?php
require_once('../../includes/initialize.php');

if (!$session->is_logged_in()) { redirect_to("login.php"); }
?>

<?php  include_layout_template('admin_header.php'); ?>

<?php
$user = new User();

$user->user_name = "jDoe";
$user->password = "pass";
$user->first_name = "Jamie";
$user->last_name = "Doe";
echo $user->full_name();
$user->save();

//$user = User::find_by_id(1);
//$user->password = "pass1";
//$user->update();

?>

<?php  include_layout_template('admin_footer.php'); ?> 
```

当我运行该页面时，我会加载管理标题布局，全名打印在屏幕上，并在其正下方显示：

致命错误：在第 17 行调用 C:\wamp\www\photo_gallery\public\admin\test.php 中未定义的方法 User::save()

create 和 update 也是如此……但是这些函数确实存在于 user.php 文件中，我什至清空了方法中的所有内容，以确保其中的 php 代码没有错误。

然后我通过 public/index.php 从公共文件夹尝试了测试

```
<?php
require_once('../includes/initialize.php');

if (!$session->is_logged_in()) { redirect_to("login.php"); }
?>

<?php  include_layout_template('admin_header.php'); ?>

<?php
$user = new User();

$user->user_name = "jDoe";
$user->password = "pass";
$user->first_name = "Jamie";
$user->last_name = "Doe";
$user->full_name();
$user->create();

?>

<?php  include_layout_template('admin_footer.php'); ?> 
```

但这甚至没有加载管理标题布局......只是给了我与其他测试文件相同的错误。我非常肯定我正在根据设置的目录导航到正确的路径。

对于我的生活，我无法理解当我将内容添加到 user.php 中的用户类时，为什么/如何不更新用户对象。或者我如何使用我之前在用户中定义的其他方法，但是当我修改它们时它们不会改变...... php 是否会缓存我不知道的对象？我什至将 user.php 从包含目录中拉出……一切仍按上述说明运行……

任何见解将不胜感激。我一直在寻找一段时间，现在试图找到有类似问题的人，但我找不到。谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:09:01.937

`SITE_ROOT`与您在目录结构中显示的内容相比，在您的 initialize.php 中，您的定义中似乎多了一个目录。您是否还有此代码的另一个副本，可能在`photo_gallery`实际上包含文件的目录中？

这是您所有包含指向的地方：

```
/Users/Alan D/Desktop/wamp/www/photo_gallery/includes 
```

# scala - Scala中的模式匹配传递

> ID：12484289
> 
> 赞同：1
> 
> 时间：2012-09-18T20:14:14.090
> 
> 标签：scala

我想做这样的事情：

```
val a = v match {
   case 1 => 1
   case 2 if (condition) => logging
   case 2 if (other conditions) => 3
   case 2 if (more conditions) => 4
   case _ => 5
} 
```

我希望这仅返回第一种情况 2 的日志，否则会失败以查看返回的内容

编辑：更新

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T20:58:12.460

Scala 的大小写匹配不会“失败”，但如果我理解正确，这将满足您的需求。

```
val a = v match {
  case 1 => 1
  case 2 => {
    logging // I'm assuming `logging` is some Unit
    if(some condition) 3
    else if(some other condition) 4
    else 5
  }
  case _ => 5
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T20:19:53.793

像这样的东西？

如果`v == 2`,`a`将被赋值，`logging`否则`a`将被赋值`v`

```
val a = v match {
   case 2 => logging
   case _ => v
} 
```

# c# - 无效方差：类型参数 'T' 必须在 'xxx.IItem 上始终有效 .GetList()'。'T' 是协变的

> ID：12484293
> 
> 赞同：3
> 
> 时间：2012-09-18T20:14:22.237
> 
> 标签：c#, covariance

为什么以下代码会出现错误？

> 无效方差：类型参数“T”必须在“UserQuery.IItem<T>.GetList()”上始终有效。“T”是协变的。

```
public interface IFoo {}
public interface IBar<T> where T : IFoo {}

public interface IItem<out T> where T: IFoo
{
    IEnumerable<IBar<T>> GetList();
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T20:18:47.803

接口`IBar`并不`IItem`同意方差：在您的`IBar`声明中， T 不是协变的，因为没有`out`关键字，而在`IITem`T 中是协变的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:24:15.373

以下代码将摆脱错误。

```
public interface IFoo {}
public interface IBar<out T> where T : IFoo {}

public interface IItem<out T> where T: IFoo
{
    IEnumerable<IBar<T>> GetList();
} 
```

# c# - 从键值列表中获取组合

> ID：12484304
> 
> 赞同：0
> 
> 时间：2012-09-18T20:15:43.763
> 
> 标签：c#, combinations

我`dict<string, list<string>>,`在 dict 中有 3 个键，第一个键有 2 个值，第二个键有 3 个值，第三个键有 3 个值。如果我从每个值集中获得一个值，那么我将拥有 2*3*3 = 18 个集合的组合 如何在 c# 中编码？

谢谢

编辑对不起没有说清楚

我想要这样的东西说我有这样的字典

```
 {"1",new List<String>(){"a", "b"}}, 
    {"2",new List<String>(){"c", "d", "e"}}, 
 {"3", new List<string>() {"f", "g"} 
```

我想要这样的输出 acf，acg，adf，adg，aef，aeg bcf，bcg，bdf，bdg，bef，beg

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:32:50.807

使用 Linq：

```
var dict = new Dictionary<String, List<String>>() { 
    {"1",new List<String>(){"a", "b"}},
    {"2",new List<String>(){"c", "d", "e"}},
    {"3",new List<String>(){"f", "g", "h"}},
};
var combis = from kv in dict
             from val1 in kv.Value
             from val2 in kv.Value
             select string.Format("{0}{1}", val1, val2);
foreach (var combi in combis)
    Console.WriteLine(combi); 
```

演示：http: [//ideone.com/nm7mY](http://ideone.com/nm7mY)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:28:29.523

我想你是这个意思？

```
Dictionary<string, int> dict = new Dictionary<string, int>
{
    { "Hello World", 1 },
    { "HelloWorld", 1 },
    { "Hello  World", 1 },
};

foreach (var item in dict) // var is of type KeyValuePair<string, int>
    Console.WriteLine(item.Key + ", " + item.Value); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:31:04.260

```
 Dictionary<string, List<int>> storage = new Dictionary<string, List<int>>();
        storage.Add("key1", new List<int>() { 2, 7 });
        storage.Add("key2", new List<int>() { 8, 4, 1});
        storage.Add("key3", new List<int>() { 3, 9, 3 });
        foreach (string key in storage.Keys)
        {
            //access to single storage...
            List<int> subStorage = (List<int>)storage[key];
            foreach (int item in subStorage)
            {
                //access to single value inside storage...
            }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T20:45:43.937

如果我试图读取或编辑列表中的值，我会尝试以下操作：

```
Dictionary<int, List<string>> dict = new Dictionary<int, List<string>>();
var arrayOfValues = dict.Values.ToArray();

for (int i = 0; i < arrayOfValues.Length; i++)
{
    for (int j = 0; j < arrayOfValues[i].Count; j++)
    {
        //read/edit arrayOfValues[i][j];
    }
} 
```

您不需要递归，因为您知道“树”的部门。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T21:08:14.247

又快又脏，但你可以擦亮这个方法。结果列表包含预期结果：

用法：

```
var dict = new Dictionary<String, List<String>>() { 
    {"1",new List<String>(){"a", "b"}},
    {"2",new List<String>(){"c", "d", "e"}},
    {"3",new List<String>(){"f", "g"}},
};

var collections = dict.Select(kvp => kvp.Value).ToArray();            
var result = new List<string>(); 
GetNextProduct(collections, 0, String.Empty, result); 
```

产生结果的方法：

```
private static void GetNextProduct(IEnumerable<string>[] collections, int collectionIndex, string currentProduct, IList<string> results)
{
    var currentList = collections[collectionIndex];
    bool isLast = collections.Length == collectionIndex + 1;
    foreach (var s in currentList)
    {
        if (isLast) results.Add(currentProduct + s);
        else GetNextProduct(collections, collectionIndex + 1, currentProduct + s, results);
    }
} 
```

# android - 与 CC2540 蓝牙 LE 设备配对

> ID：12484306
> 
> 赞同：1
> 
> 时间：2012-09-18T20:15:50.737
> 
> 标签：android, bluetooth, core-bluetooth, bluetooth-lowenergy

我正在尝试使用我的摩托罗拉 RAZR 连接到基于 TI 的 CC2540 的 BLE 设备（我有来自 TI 的密钥卡，以及来自 connectblue OLP425 的另一个设备），到目前为止，我唯一的成功是市场上名为 Propagation 的应用程序我无权访问源代码。

我试图用这段代码连接到设备，但我最不明白的是 UUID，

我在 iPad 3 上下载了一个应用程序，发现一个设备具有以下 UUID 00000000-0000-0000-ff31-1a064f8c5966

```
private static final UUID SPP_UUID = UUID.fromString("00000000-0000-0000-ff31-1a064f8c5966");
BluetoothDevice bd  =BluetoothAdapter.getDefaultAdapter().getBondedDevices().iterator().next();
//I only have I device paired that is the Bluetooth Low Energy Device so using the first Device returned by the iterator is fine.
    try {
        BluetoothSocket bs = bd.createRfcommSocketToServiceRecord(UUID);
        bs.connect();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

我得到的只是 logcat 中的服务发现失败

在几乎所有的例子中，每个人都在使用

00000000-0000-1000-8000-00805f9b34fb

如果我在应用程序中走得更远，电池服务是 UUID 0x180f

我只想创建一个应用程序来读取此服务的值，这是一个简单的十进制值

过去有人成功与 BLE 设备配对吗？

谢谢你

乔纳森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T19:11:17.773

我已经能够使用心率监测器连接到我的 CC2540。我使用 CCDebugger 刷新了固件，并使用 0000180d-0000-1000-8000-00805f9b34fbas 的 UUID，我已经能够读取一个值。

使用 Motorola_BLE_profile 示例应用并进行一些修改。

```
primaryServices = mGattService.getGattPrimaryServices(device);
if (primaryServices == null) {
  String message = "Connection failed !";
  Toast.makeText(mContext, message, Toast.LENGTH_SHORT).show();
  return;
}
for (i = 0; i < primaryServices.length; i++) {
  Log.v(TAG, "primary service " + primaryServices[i]);
  if (primaryServices[i].equalsIgnoreCase(hrmUUID)) {
    try {
      status = mGattService.connectGatt(device, hrmUUID, callback1);
      if (status == true){
        mDevice = device;
        mLeState = CONNECTING;
        BluetoothLeReceiver.isDevicePickerPending = false;
      } else {
        String message = "Connection failed !";
        Toast.makeText(mContext, message, Toast.LENGTH_SHORT).show();   
      }

} catch (Exception e) {
  Log.e(TAG,"Exception while calling gatt Connect");
}
return;
if (i == primaryServices.length) {
 Log.v(TAG,"Primary Service not found");
 String message = "Connection failed !";
 Toast.makeText(mContext, message, Toast.LENGTH_SHORT).show(); 
```

}

# visual-studio-2008 - 安装 VS 2008 Express 失败

> ID：12484307
> 
> 赞同：1
> 
> 时间：2012-09-18T20:16:23.700
> 
> 标签：visual-studio-2008, windows-7, 64-bit, installation

我正在尝试在已经安装了 VS 2010 Pro 的 64 位 Win 7 机器上安装 VS 2008 Express。在安装的早期，我收到一个错误：“Setup.exe 已停止工作。... windows 将关闭程序”。在后台窗口中进一步显示：“安装程序无法安装以下组件：运行时先决条件”。

无论我是从 Web 安装程序安装 2008 express 还是从 MSDN CD 安装 2008 Pro，都会发生此错误。

搜索将我指向控制面板 | 打开或关闭 Windows 功能 | 微软 .NET 框架 3.5.1。我尝试启用和禁用它没有任何区别。设置仍然失败。

有任何想法吗？

# python - ValueError：尺寸不匹配

> ID：12484310
> 
> 赞同：29
> 
> 时间：2012-09-18T20:16:32.510
> 
> 标签：python, numpy, scipy, scikit-learn

我使用[SciPy](http://scipy.org/)和[scikit-learn](http://scikit-learn.org/stable/)来训练和应用多项式朴素贝叶斯分类器进行二进制文本分类。准确地说，我使用该模块[`sklearn.feature_extraction.text.CountVectorizer`](http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html#sklearn.feature_extraction.text.CountVectorizer)来创建包含文本中单词特征计数的稀疏矩阵，并使用该模块[`sklearn.naive_bayes.MultinomialNB`](http://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html#sklearn.naive_bayes.MultinomialNB)作为分类器实现，用于在训练数据上训练分类器并将其应用于测试数据。

的输入`CountVectorizer`是表示为 unicode 字符串的文本文档列表。训练数据远大于测试数据。我的代码看起来像这样（简化）：

```
vectorizer = CountVectorizer(**kwargs)

# sparse matrix with training data
X_train = vectorizer.fit_transform(list_of_documents_for_training)

# vector holding target values (=classes, either -1 or 1) for training documents
# this vector has the same number of elements as the list of documents
y_train = numpy.array([1, 1, 1, -1, -1, 1, -1, -1, 1, 1, -1, -1, -1, ...])

# sparse matrix with test data
X_test = vectorizer.fit_transform(list_of_documents_for_testing)

# Training stage of NB classifier
classifier = MultinomialNB()
classifier.fit(X=X_train, y=y_train)

# Prediction of log probabilities on test data
X_log_proba = classifier.predict_log_proba(X_test) 
```

**问题：**一旦[`MultinomialNB.predict_log_proba()`](http://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html#sklearn.naive_bayes.MultinomialNB.predict_log_proba)被调用，我就会得到`ValueError: dimension mismatch`. 根据下面的 IPython 堆栈跟踪，错误发生在 SciPy 中：

```
/path/to/my/code.pyc
--> 177         X_log_proba = classifier.predict_log_proba(X_test)

/.../sklearn/naive_bayes.pyc in predict_log_proba(self, X)
    76             in the model, where classes are ordered arithmetically.
    77         """
--> 78         jll = self._joint_log_likelihood(X)
    79         # normalize by P(x) = P(f_1, ..., f_n)
    80         log_prob_x = logsumexp(jll, axis=1)

/.../sklearn/naive_bayes.pyc in _joint_log_likelihood(self, X)
    345         """Calculate the posterior log probability of the samples X"""
    346         X = atleast2d_or_csr(X)
--> 347         return (safe_sparse_dot(X, self.feature_log_prob_.T)
    348                + self.class_log_prior_)
    349 

/.../sklearn/utils/extmath.pyc in safe_sparse_dot(a, b, dense_output)
    71     from scipy import sparse
    72     if sparse.issparse(a) or sparse.issparse(b):
--> 73         ret = a * b
    74         if dense_output and hasattr(ret, "toarray"):
    75             ret = ret.toarray()

/.../scipy/sparse/base.pyc in __mul__(self, other)
    276 
    277             if other.shape[0] != self.shape[1]:
--> 278                 raise ValueError('dimension mismatch')
    279 
    280             result = self._mul_multivector(np.asarray(other)) 
```

我不知道为什么会发生此错误。有人可以向我解释一下并为这个问题提供解决方案吗？提前非常感谢！

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-09-18T21:46:40.720

在我看来，就像您只需要`vectorizer.transform`用于测试数据集一样，因为训练数据集修复了词汇表（毕竟您无法知道包括训练集在内的完整词汇表）。只是要清楚，那`vectorizer.transform`不是`vectorizer.fit_transform`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-08-22T03:21:06.540

另一种解决方案是使用[vector.vocabulary](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html#sklearn.feature_extraction.text.CountVectorizer)

```
# after trainning the data
vector = CountVectorizer()
vector.fit(self.x_data)
training_data = vector.transform(self.x_data)
bayes = MultinomialNB()
bayes.fit(training_data, y_data)

# use vector.vocabulary for predict
vector = CountVectorizer(vocabulary=vector.vocabulary_) #vocabulary is a parameter, it should be vocabulary_ as it is an attribute.
text_vector = vector.transform(text)
trained_model.predict_prob(text_vector) 
```

# grails - grails 中的 Twitter Bootstrap 活动导航栏

> ID：12484317
> 
> 赞同：3
> 
> 时间：2012-09-18T20:16:50.373
> 
> 标签：grails, twitter-bootstrap

我很难让“活动”类停留在不同的页面上。我通过布局在每个页面上加载了导航栏，这可能是问题吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-04T12:12:33.463

我只是在我的布局 gsp 中有这个来创建导航栏，它工作得很好。我只有控制器级别的导航栏中的项目，而不是单个操作。

```
<li ${controllerName.equals('schedule') ? 'class="active"' : ''}>Schedule</li> 
```

对于 Grails 生成的默认控制器，可以使用

```
<li ${controllerName == null ? 'class="active"' : ''}>Home</li> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T20:29:53.600

是的，这就是问题所在。

每当您重新加载页面时，任何`<li>`元素都`class=active`将再次设置为活动状态。

如果您有`/grails-app/views/layouts/main.gsp`以下情况：

```
<div class="navbar">
  <div class="navbar-inner">
    <ul class="nav">
      <li class="active"><a href="/home">Home</a></li>
      <li><a href="/fred">Fred</a></li>
      <li><a href="/barney">Barney</a></li>
    </ul>
  </div>
</div> 
```

并且您的 Fred 和 Barney 的 GSP 使用 main.gsp 布局，当您单击它们时，您将加载上面的代码，并且“主页”的链接仍将处于活动状态。

解决方案是为 Navbar 控件编写 Taglib，或创建单独的布局页面。

# jquery - 简单的jquery，加载动画不起作用

> ID：12484318
> 
> 赞同：0
> 
> 时间：2012-09-18T20:16:53.523
> 
> 标签：jquery, css, onload

我有一些图像我想在页面加载后将其设置为 100% 不透明度。

我有这段代码，但由于某种原因它不起作用。

CSS代码是...

```
#photos img {
  width: 100% !important;
  height: auto !important;
  margin: 5px 10px;
  opacity: 0.2;
  -webkit-transition: opacity 0.2s ease;
  -moz-transition: opacity 0.2s ease;
  transition: opacity 0.2s ease;
}
.loaded {
  opacity: 1;
}​ 
```

jQuery代码是...

```
$(function(){
    $('#photos img').on("load", function(){
        $(this).addClass("loaded");
    });
});​ 
```

我这里有 jsfiddle... [http://jsfiddle.net/rzdzf/](http://jsfiddle.net/rzdzf/)

我确定我错过了一些非常小的东西......？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T20:29:32.523

尝试做这样的事情......

```
$('#photos img').animate({opacity: 1}, 1500 ); 
```

**或者对于负载：**

```
$('#photos img').on("load", function(){
     $(this).animate({opacity: 1}, 1500 );
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:20:08.493

如果只是在这个小提琴中，那是因为左窗格上的设置说要在onLoad上运行代码；但是你有一个 onLoad 在那里，但它已经加载，所以它不会运行。将其更改为 nowrap。当我这样做时，它按预期工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:31:57.280

将此用作您的脚本：

```
$(function(){
    $('#photos img').animate({opacity:1});
    });​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T20:34:35.303

只需绑定到`window.load`事件，所有图像都将在该点加载。`load`由于绑定到图像事件的问题，这很有帮助。由于浏览器缓存，谁知道图像是否已经加载（在这种情况下，您的加载事件处理程序不会触发）

```
//run this in the global scope, the `window` object is always available
$(window).on("load", function () {
    $('#photos img').addClass("loaded");
});​ 
```

这是一个演示：http: [//jsfiddle.net/rzdzf/10/](http://jsfiddle.net/rzdzf/10/)

您的`.loaded`课程也没有被应用，因为它没有`#photos img`规则那么具体，所以让它更具体：

```
#photos img.loaded {
    opacity : 1;
} 
```

# sql-server-2008 - 基于父记录标准的子记录索引？

> ID：12484319
> 
> 赞同：0
> 
> 时间：2012-09-18T20:17:04.653
> 
> 标签：sql-server-2008, schema, relational-database

我正在设计一个包含两个父子关系表的模式。我关心的一个查询是子记录将根据父记录的两个字段中的值被重复查询。该用例涉及选择子记录，其中父记录中的一个字段等于 1，而另一个字段大于零。***对于这个用例，不需要来自父记录的信息。***

一个月的数据工作包含约 500,000 条父记录和约 1,500,000 条子记录。有问题的用例可能会返回 99% 的子记录。

有没有办法在基于父表中的标准字段的子表上设置索引？我已经考虑过一些非规范化并向子记录添加几个标准字段，但我犹豫不决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:24:31.717

为此，听起来[索引视图](http://msdn.microsoft.com/en-us/library/ms191432%28v=sql.105%29.aspx)可以满足您的需求。

您将只能在子表的视图显示中包含列，同时加入父表以检查您需要的列 = 1。

解决方案的粗略示例可能如下所示：

```
CREATE VIEW dbo.vwChildTableRestrictedByParentValues
WITH SCHEMABINDING
AS
   SELECT ct.col1, ct.col2, ct.etc
   FROM dbo.ChildTable AS ct
   INNER JOIN dbo.ParentTable AS pt ON ct.ParentId = pt.ParentId
   WHERE pt.OneField = 1
      AND pt.AnotherField > 0;

GO

CREATE CLUSTERED INDEX IX_vwChildTableRestrictedByParentValues
ON dbo.vwChildTableRestrictedByParentValues
(
   Col1 ASC
   , Col2 ASC
   , etc ASC
) 
```

索引包括要为子表编制索引的列。

如果您没有 Enterprise Edition，则必须针对视图编写查询。如果您有 Enterprise，则可以针对表编写查询，但仍使用您在此处创建的索引。

# javascript - jQuery Validation - 仅在填写另一个字段时才需要字段

> ID：12484323
> 
> 赞同：0
> 
> 时间：2012-09-18T20:17:17.383
> 
> 标签：javascript, jquery, validation, jquery-validate

> **可能重复：**
> [如果选中复选框，则需要 JQuery 验证选择](https://stackoverflow.com/questions/6573487/jquery-validation-select-required-if-checkbox-checked)

我正在使用 jQuery Validation 验证表单。我正在尝试提出一个规则，如果填充了特定字段集中的字段，则将根据需要验证字段：

```
<form id="donate-form">
    <input type="text" name="full_name" required="required" /><br />
    <input type="text" name="address1" /><br />
    <input type="text" name="address2" /><br />
    <input type="text" name="city" /><br />
    <select name="state">
        <option value="">- State -</option>
        <option value="va">Virginia</option>
        <option value="md">Maryland</option>
    </select><br />
    <input type="text" name="zip" />
    <input type="submit" name="submit" />
</form> 
```

所有地址字段都是可选的，除非有人填写 address1、city、state*或*zip，否则它们都应该是必需的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:26:13.447

[**例子**](http://jsfiddle.net/2kDHF/1/)

使用`depends`，填写您的要求。

```
var depends = function() {
    var vals = '';
    $('form > *').not(':eq(0)').each(function () {
        vals += $(this).val();
    });

    return vals.length > 0;
}; 
```

您应该将选择器更改为更具体的内容以满足您的需求。即不是`$('form')`

# wcf-ria-services - 仅在使用 Take 查询时 Ria 服务出错

> ID：12484325
> 
> 赞同：0
> 
> 时间：2012-09-18T20:17:21.250
> 
> 标签：wcf-ria-services, ria, linq-to-nhibernate

我有一个奇怪的场景。RIA 服务适用于我的所有实体，除了一个。

有了这个实体，如果传递给 svc 的 URL 是标准的，它就可以工作。如果它有一个take参数，它就不起作用。

示例网址

```
http://mysite/ClientBin/Myclass.svc/binar/GetEntity1  //(works)
http://mysite/ClientBin/Myclass.svc/binar/GetEntity1?$take=20  //(does not work) 
```

我只有这个单一的实体有这个问题。其他人都没有这个问题。

有任何想法吗？

编辑：我通过禁用我的查询清理器并使用缓存的实体列表来修复它。我使用清理类来整理查询，以便 LINQ to nHibernate 可以处理查询，但我只对少数类型执行此操作。尽管如此，它仍然适用于其他实体，但不适用于这个实体。

# android - 将进度条微调器添加到对话框弹出 WebView

> ID：12484326
> 
> 赞同：0
> 
> 时间：2012-09-18T20:17:24.390
> 
> 标签：android, webview, android-alertdialog, android-progressbar

我试图为下面的代码实现一个进度条微调器。我对 android 编程相当陌生，并尝试过搜索和尝试示例。下面的代码是我为弹出窗口工作而工作的代码，并有一个带有自定义关闭按钮的 web 视图。有人可以告诉我或指导我如何使用以下代码使用进度微调器吗？谢谢你。

```
package com.example.expopup;

import android.app.Activity;
import android.app.Dialog;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.webkit.WebView;
import android.widget.Button;
import android.widget.ImageButton;

public class MainActivity extends Activity {

Dialog myDialog;
Button myButton;

@Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    myButton = (Button) findViewById(R.id.ClkBtn);

    myButton.setOnClickListener(new OnClickListener() {          
    public void onClick(View v) {

            myDialog = new Dialog(MainActivity.this);
            myDialog.setContentView(R.layout.mydialog);
            myDialog.setTitle("Test");
            myDialog.setCancelable(true);

            WebView myWebView = (WebView)   myDialog.findViewById(R.id.testwebview);
            myWebView.loadUrl("http://google.com");

            ImageButton close = (ImageButton)myDialog.findViewById(R.id.Btn1);
            close.setOnClickListener(
                    new OnClickListener(){

                        public void onClick(View v) {
                            myDialog.dismiss();
                    }                    
            });

            myDialog.show();
        }
    });
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:51:20.407

我不确定您在 WebView 中使用哪种类型的布局，但您可能希望在 FrameLayout 中同时包含 WebView 和 ProgressBar，而 WebView 最初是隐藏的。然后，您可以在页面完全加载后显示 WebView 并隐藏 ProgressBar。

R.layout.mydialog

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <WebView android:id="@+id/testwebview"
             android:layout_width="match_parent"
             android:visibility="invisible"
             android:layout_height="match_parent" />

    <ProgressBar android:id="@+id/testprogressbar"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:layout_gravity="center" />
</FrameLayout> 
```

在您的活动中：

```
myButton.setOnClickListener(new OnClickListener() {          
public void onClick(View v) {

        myDialog = new Dialog(MainActivity.this);
        myDialog.setContentView(R.layout.mydialog);
        myDialog.setTitle("Test");
        myDialog.setCancelable(true);

        final WebView myWebView = (WebView)   myDialog.findViewById(R.id.testwebview);
        final ProgressBar myPB = (ProgressBar) myDialog.findViewById(R.id.testprogressbar);

        // Add WebViewClient to be notified of page load
        myWebView.setWebViewClient(new WebViewClient(){
            @Override
            public void onPageFinished(WebView view, String url){
                // Show webview and hide progress bar
                myWebView.setVisibility(View.VISIBLE);
                myPB.setVisibility(View.INVISIBLE);
            }
        });
        myWebView.loadUrl("http://google.com");

        ImageButton close = (ImageButton)myDialog.findViewById(R.id.Btn1);
        close.setOnClickListener(
                new OnClickListener(){

                    public void onClick(View v) {
                        myDialog.dismiss();
                }                    
        });

        myDialog.show();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:41:09.087

你可以[`ProgressDialog`](http://developer.android.com/reference/android/app/ProgressDialog.html)这样使用

```
ProgressDialog progressDialog = new ProgressDialog(MainActivity.this);
progressDialog.setCancelable(true);
progressDialog.setIndeterminate(true);
progressDialog.setMessage("Test");
progressDialog.show(); 
```

# mysql - Tomcat、Spring、Hibernate App - 用户报告会话混淆

> ID：12484330
> 
> 赞同：0
> 
> 时间：2012-09-18T20:18:10.223
> 
> 标签：mysql, spring, hibernate, tomcat

我们使用的是 Tomcat 6、Spring 3.1 和 Hibernate。除了用户报告他们的会话混淆之外，一切正常。这只发生在我们的应用程序在一个教室或一个代理后面使用时。关于从哪里开始调试此问题的任何想法。我们的应用程序使用 Spring Security，但存储和使用会话中的用户对象，而不是 Authentication 对象。

感谢任何指针。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-22T21:04:13.287

[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3502](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3502)？

# ruby-on-rails - 将文件上传到服务器并将路径存储在 Ruby on Rails 中的数据库中

> ID：12484333
> 
> 赞同：7
> 
> 时间：2012-09-18T20:18:19.883
> 
> 标签：ruby-on-rails, ruby

我对 ROR 很陌生。我有一个任务要完成：

这是模型：

```
class File::DataImport < ActiveRecord::Base
  attr_accessible :created_by, :file_name, :file_source, :updated_at, :updated_by
end 
```

这是控制器：

```
class Files::DataImportsController < ApplicationController
  def index
  end

  def new
  end
end 
```

我的观点是`index`和`new`。

我想要一个字段来上传数据。数据应存储在服务器中，并将文件路径保存到数据库中的指定列`file_name`中。该路径应该是所有上传文件的默认路径。

我不知道如何开始。请帮助我找到解决方案，我将从中学习。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-19T07:17:04.957

db/migrate/20110711000004_create_files.rb

```
class CreateFiles < ActiveRecord::Migration
def change
  create_table :files do |t|
  t.string :name
  # If using MySQL, blobs default to 64k, so we have to give
  # an explicit size to extend them
  t.binary :data, :limit => 1.megabyte
  end
end
end 
```

应用程序/控制器/upload_controller.rb

```
 class UploadController < ApplicationController
 def get
 @file = File.new
 end
 end 
```

应用程序/视图/上传/get.html.erb

```
<% form_for(:file,
url: {action: 'save'},
html: {multipart: true}) do |form| %>
Upload your file: <%= form.file_field("uploaded_file") %><br/>
<%= submit_tag("Upload file") %>
<% end %> 
```

应用程序/模型/file.rb

```
class File < ActiveRecord::Base
def uploaded_file=(file_field)
self.name = base_part_of(file_field.original_filename)
self.data = file_field.read
end
def base_part_of(file_name)
File.basename(file_name).gsub(/[^\w._-]/, '')
end
end 
```

应用程序/控制器/upload_controller.rb

```
def save
@file = File.new(params[:file])
if @file.save
redirect_to(action: 'show', id: @file.id)
else
render(action: :get)
end
end 
```

应用程序/控制器/upload_controller.rb

```
def file
@file = File.find(params[:id])
send_data(@File.data,
filename: @File.name,
disposition: "inline")
end 
```

应用程序/控制器/upload_controller.rb

```
def show
@file = File.find(params[:id])
end 
```

应用程序/视图/上传/show.html.erb

```
<h3><%= @file.name %></h3>
<img src="<%= url_for(:action => 'file', :id => @file.id) %>"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:00:01.473

您应该考虑使用一种已经可用的解决方案，例如回形针：[https](https://github.com/thoughtbot/paperclip) : //github.com/thoughtbot/paperclip 或carrierwave：[https ://github.com/jnicklas/carrierwave](https://github.com/jnicklas/carrierwave)

除了自述文件之外，还有很好的教程：

[http://railscasts.com/episodes/134-paperclip](http://railscasts.com/episodes/134-paperclip)

[http://railscasts.com/episodes/253-carrierwave-file-uploads](http://railscasts.com/episodes/253-carrierwave-file-uploads)

编辑：由于您想自己实现它，我建议您在 Github 上检查上述源代码，并尝试了解他们的代码在做什么。我也不会费心自己实现它，但如果你有你的理由，这可能会让你继续......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:59:02.230

您可能需要研究诸如[carrierwave](https://github.com/jnicklas/carrierwave)之类的解决方案。

Github 页面对如何使用它提供了很好的解释，但这[也是](http://www.engineyard.com/blog/2011/a-gentle-introduction-to-carrierwave/)一个很好的指南。

# objective-c - 映射到 Restkit 中的多个类

> ID：12484334
> 
> 赞同：1
> 
> 时间：2012-09-18T20:18:29.440
> 
> 标签：objective-c, ios, xcode, restkit

我正在使用 RestKit 将数据映射到两个类（区域和类别）中的属性，以便在两个表视图（区域和类别）中使用。但是，它似乎只是为我在测试应用程序时进入的第一个视图正确映射数据。例如，当我首先查看类别，然后切换区域时，我的区域将存储为类别类型的对象。如果我先查看区域，然后查看类别，我的类别将被映射为区域类型的对象。由于对象的数量，我可以说正在检索正确的信息，但它没有被存储为正确的类型。如何确保每个映射请求都正确完成？每个映射的代码如下：

分类：

```
RKURL *baseURL = [RKURL URLWithBaseURLString:@"MyUrl"];
RKObjectManager *objectManager = [RKObjectManager objectManagerWithBaseURL:baseURL];
objectManager.client.baseURL = baseURL;

RKObjectMapping *categoryMapping = [RKObjectMapping mappingForClass:[Category class]];
[categoryMapping mapKeyPathsToAttributes:@"categoryID", @"categoryID", @"parentID", @"parentID", @"categoryName", @"categoryName", @"childrenCount", @"childrenCount", @"parentCount", @"parentCount", @"catCount", @"catCount", nil];
[objectManager.mappingProvider setMapping:categoryMapping forKeyPath:@""]; 
```

地区：

```
RKURL *baseURL = [RKURL URLWithBaseURLString:@"MyUrl"];
RKObjectManager *objectManager = [RKObjectManager objectManagerWithBaseURL:baseURL];
objectManager.client.baseURL = baseURL;

NSLog(@"URL Created");

RKObjectMapping *regionMapping = [RKObjectMapping mappingForClass:[Region class]];
[regionMapping mapKeyPathsToAttributes:@"regionHome", @"regionHome", @"regionID", @"regionID", @"regionName", @"regionName", @"parentCount", @"parentCount", @"parentID", @"parentID", @"childrenCount", @"childrenCount", @"parentName", @"parentName", nil];
[objectManager.mappingProvider setMapping:regionMapping forKeyPath:@""]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T04:22:28.950

根据我的判断，您不想像`@""`. `[objectManager.mappingProvider setMapping:regionMapping forKeyPath:@""];`您可能会将这些替换为`@"region"`，`@"category"`因此 RestKit 可以根据关键路径来判断它应该期望什么对象。

还有，你是用`isKindOfClass:`objectLoader`didLoadObjects`方法中的方法来区分对象的吗？

也许这会帮助你：

```
- (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects {

  if ([[objects objectAtIndex:0] isKindOfClass:[Region class]]) {

      Region *region = [objects objectAtIndex:0];

  }
  else if ([[objects objectAtIndex:0] isKindOfClass:[Category class]]) {

      Category *category = [objects objectAtIndex:0];

  }
} 
```

# coldfusion - 您如何在 ColdFusion 中捕获整个应用程序的错误？

> ID：12484335
> 
> 赞同：2
> 
> 时间：2012-09-18T20:18:30.753
> 
> 标签：coldfusion, railo, cfml, application.cfc

我目前正在尝试通过在 Application.cfc 中包含以下代码来捕获我的应用程序中的所有错误：

```
<cffunction name="onError">
    <!--- The onError method gets two arguments: 
            An exception structure, which is identical to a cfcatch variable. 
            The name of the Application.cfc method, if any, in which the error 
            happened. --->
    <cfargument name="Except" required=true/>
    <cfargument type="String" name = "EventName" required=true/>
    <!--- Log all errors in an application-specific log file. --->
    <cflog file="#THIS.NAME#" type="error" text="Event Name: #Eventname#" >
    <cflog file="#THIS.NAME#" type="error" text="Message: #Except.message#">
    <!--- Throw validation errors to ColdFusion for handling. --->
    <cfif Find("coldfusion.filter.FormValidationException", Arguments.Except.StackTrace)>
        <cfthrow object="#Except#">
        <cfelse>
        <cfoutput>
        <h1>#Eventname#</h1>
        </cfoutput>
        <cfdump var="#Except#">
    </cfif>
</cffunction> 
```

其中一些是从我见过的其他例子中借来的（我不完全理解）。我最终想展示某种优雅的错误页面来征求用户的反馈，然后记录/通过电子邮件发送错误。这似乎捕获了很多错误，但不是全部。如果我不需要，我也不想在任何地方使用 try/catch。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:28:50.270

您还可以在 ColdFusion 管理员中定义一个整体的 ColdFusion 错误处理程序。在服务器设置 > 设置下，向下滚动到底部并设置“站点范围的错误处理程序”选项。

在文档中也检查一下[关于 ColdFusion 中的错误处理](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec0bb9b-7ffe.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:00:45.023

使用共享主机不应该是一个问题，只需询问您的 hosr 错误模板是什么，如果他们对 cf 有所了解，那么他们将进行设置。Wr 使用 error.cfm 和 404.cfm fot 示例，它们位于每个客户站点的根目录中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T23:31:31.207

Application.cfc 中的“OnError”方法将仅捕获以前未被用户定义的 try/catch 语句捕获的错误。

[http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=appFramework_13.html](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=appFramework_13.html)

话虽如此，我认为在必要时在代码中包含 try catch 语句是一个好主意（不能优雅降级的情况）。我喜欢做的是实例化一个包含所有异常处理的cfc。然后，此 cfc 可以包含实际的错误处理逻辑，并且 OnError 方法需要做的就是实例化正确的组件并“控制”错误。

一个非常简单的例子：

```
<cfscript>

  /** Application.cfc **/
  public function onError(required exception, required string eventName)
  {
    var factory = new App.ExceptionFactory();
    var e = factory.getNewException(arguments.eventName, arguments.exception);

    if (e.logError()) {
      /** we cauld also have a logging cfc etc **/
      var loggingFile = new App.SomeLoggingCfc(arguments.eventName, arguments.exception);
      loggingFile.commitLog();
    }
    if (e.debugError()) {
      // show developer info here
    }

    /** Throw the exception **/
    e.throwException();
  } 

  /** App.ExceptionFactory **/
  public ExceptionFactory function getNewException(required string eventName, required exception)
  {
    return new "App.#exception.type#"(argumentCollection = arguments);
  } 

  /** App.Exception.CustomException **/
  public boolean function logError()
  {
    /** log the error **/
  }
  public boolean function debugError() {}

  public function throwException()
  {
    /** do what you want here **/
  }

</cfscript> 
```

# php - 函数查询不会执行

> ID：12484336
> 
> 赞同：0
> 
> 时间：2012-09-18T20:18:31.860
> 
> 标签：php, mysql, function

为什么这个查询不起作用？！？

**错误**

解析错误：语法错误，第 5 行 E:\xampp\htdocs\pf\shop\buy.php 中的意外 T_STRING

**变量的示例信息**

$character->islots = 20

$chatacter->name = [RE] Tizzle

$e2 = 10

**功能**

```
function increaseSlots($e2) {
    $slots = ($character->islots)+($e2);
    mysql_query('UPDATE `phaos_characters` SET `inventory_slots`="'.$slots.'" WHERE `name`="'.$character->name.'"'); // <-- Line 5
    if (mysql_affected_rows() != 0) {
        echo 'Inventory Size Incresed By '.$e2.' Slots';
    }else{
        echo mysql_error();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:20:36.077

查看文档： http: [//php.net/manual/en/function.mysql-num-rows.php](http://php.net/manual/en/function.mysql-num-rows.php)

> > 从结果集中检索行数。此命令仅对返回实际结果集的 SELECT 或 SHOW 等语句有效。要检索受 INSERT、UPDATE、REPLACE 或 DELETE 查询影响的行数，请使用 mysql_affected_rows()。

您需要使用`mysql_affected_rows()`或更好，PDO 或 mysqli。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T20:20:54.400

```
$slots = ($character->islots)+($e2); 
```

好像有错别字。尝试：

```
$slots = ($character->slots)+($e2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T20:41:27.590

首先，您应该知道 mysql_num_rows 仅返回 SELECT 或 SHOW 语句的有效结果，如[PHP 文档](http://php.net/manual/en/function.mysql-num-rows.php)中所述。您可以使用[mysql_affected_rows()](http://php.net/manual/en/function.mysql-affected-rows.php)来满足您的特定需求。

但是，旧的 PHP MySQL API（您正在使用）正在逐步淘汰，因此我建议您使用 mysqli 或 PDO 来满足您的数据库连接需求。

但是，在满足您的要求的同时，您可以尝试使用以下语法来确保您收到 MySQL 错误（如果它抛出一个错误）。您的 PHP 脚本将停止，但您会看到错误。

```
$query = sprintf('UPDATE `phaos_characters` SET `inventory_slots`=%d WHERE `name`="%s"',$slots,$character->name)
$result = mysql_query($query) or die(mysql_error()); 
```

最后的想法是，在这种情况下，它有助于打印出您的结果`$query`并通过 phpMyAdmin 之类的工具手动运行它以查看会发生什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T20:49:37.467

Bleh...我暂时找到了一种更好的方法..抱歉浪费了你们的时间...

在处理函数之前，我只是将 $character 对象放入变量中。

```
function increaseSlots($e2,$charname,$charslots) {
    $slots = $charslots+$e2;
    mysql_query('UPDATE `phaos_characters` SET `inventory_slots`="'.$slots.'" WHERE `name`="'.$charname.'"');
        if (mysql_affected_rows() != 0) {
            echo 'Inventory Size Incresed By '.$e2.' Slots';
        }
} 
```

# android - 在 RESULT_OK 情况下，Android 相机 Intent 不会返回

> ID：12484340
> 
> 赞同：5
> 
> 时间：2012-09-18T20:18:54.090
> 
> 标签：android, android-intent, android-camera

我正在尝试建立一个通过 Intents 使用相机的简单 Android 应用程序。该代码几乎直接来自[此处的 Android 文档](http://developer.android.com/guide/topics/media/camera.html#manifest)，但它不适用于我。

相机应用程序在调用 startActivityForResult() 后按预期打开，但在我拍照后它永远不会返回 (?!)。具体来说，在我拍照并选择接受图标后它不会返回（Galaxy Nexus 上的复选标记）。但在我选择取消图标（同一部手机上的“X”）后，它确实会返回。

这是代码（请注意，我正在使用片段，而不是活动）：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
                         Bundle savedInstanceState) {

    View view = inflater.inflate(R.layout.my_layout, container, false);

    final Button btnCamera = (Button) view.findViewById(R.id.cameraid);

    View.OnClickListener handler = new View.OnClickListener() {
        public void onClick(View v) {
            if (v == btnCamera) {
                Intent cameraIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);

                // create a file to save the image
                File imagesFolder = new File(Environment.getExternalStorageDirectory(), "MyImages");
                imagesFolder.mkdirs();
                File image = new File(imagesFolder, "image_001.jpg");
                Uri uriSavedImage = Uri.fromFile(image);

                // start the image capture Intent
                cameraIntent.putExtra(MediaStore.EXTRA_OUTPUT, uriSavedImage);
                startActivityForResult(intent, CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE);
            }
        }
    }
    btnCamera.setOnClickListener(handler);
} 
```

和

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) {
        if (resultCode == Activity.RESULT_OK) {
            // Image captured and saved to fileUri specified in the Intent
            Toast.makeText(getActivity(), "Image saved to:\n" +
                     data.getData(), Toast.LENGTH_LONG).show();
        }
        else if (resultCode == Activity.RESULT_CANCELED) {
            // User cancelled the image capture
        } else {
            // Image capture failed, advise user
        }
    } 
```

我需要改变什么才能使这项工作？谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-18T20:40:18.400

糟糕，当我添加清单行时它起作用了：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.CAMERA"/> 
```

如果您的应用程序依赖于外部相机应用程序，我错误地认为这些行是不必要的。但我错了！谢谢。

# c# - Office 2007 64 位和 2010 32 位中的注册表读取不同

> ID：12484341
> 
> 赞同：0
> 
> 时间：2012-09-18T20:18:57.257
> 
> 标签：c#, com, registry, vsto

我正在使用办公室互操作构建一个 COM 插件。我有从注册表读取许可证密钥的代码。奇怪的是，它在 Excel 2007（64 位）中完美地读取了许可证密钥，但是当我在 Excel 2010（32 位）中运行相同的代码时，从注册表中读取许可证密钥时，它被填充为空字符串。我正在使用此代码来读取许可证密钥：

```
RegistryKey key = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\Plugin\PluginSubFolder");
return (string)key.GetValue("License", ""); 
```

我知道这个问题有点模糊，可能是由很多事情引起的，但我不确定从哪里开始调试它。

有什么想法可能导致这种情况吗？我很高兴回答有关代码或问题的任何其他问题。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:21:44.960

64 位进程读取的注册表部分与 32 位进程不同。这里有一些操作系统重定向魔法。

最佳解决方案是将密钥添加到两个位置。

有关详细信息，请参阅MSDN 上[注册表中的 32 位和 64 位应用程序数据。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724072%28v=vs.85%29.aspx)

# sql-server - 选择日期范围，包括没有结果的日期

> ID：12484349
> 
> 赞同：0
> 
> 时间：2012-09-18T20:19:28.993
> 
> 标签：sql-server

> **可能重复：**
> [SQL Server：即使某些天不存在数据，如何选择日期范围内的所有天](https://stackoverflow.com/questions/5899829/sql-server-how-to-select-all-days-in-a-date-range-even-if-no-data-exists-for-so)

我真的不知道如何措辞这个问题，但我会尽力解释。我正在尝试使用如下查询构建一些基本报告：

```
SELECT COUNT(*) AS count, h_date FROM (SELECT CONVERT(VARCHAR(10), h_time, 102) AS h_date FROM hits h GROUP BY h_date ORDER BY h_date 
```

这会返回这样的结果，我用它来构建图表：

```
8 2012.05.06
2 2012.05.07
9 2012.05.09 
```

如您所见，它错过了 8 日，因为那天没有点击。有没有办法获得`0`没有结果的日期的值，或者我必须在事后解析结果并手动添加它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:34:07.840

您可以使用现有目录视图来导出开始日期和结束日期之间的连续日期范围。然后，您可以直接加入您的数据，任何缺失的日期都将显示为 0。

```
DECLARE @min SMALLDATETIME, @max SMALLDATETIME;

SELECT @min = MIN(h_time), @max = MAX(h_time)
  FROM dbo.hits 
  -- WHERE ?

-- or if you just want a fixed range:

-- SELECT @min = '20120101', @max = '20120131';

;WITH n(d) AS 
(
  SELECT TOP (DATEDIFF(DAY, @min, @max)+1) 
   DATEADD(DAY, ROW_NUMBER() OVER (ORDER BY [object_id]) - 1, DATEDIFF(DAY, 0, @min))
  FROM sys.all_objects ORDER BY [object_id]
)
SELECT n.d, [count] = COUNT(h.h_time)
  FROM n
  LEFT OUTER JOIN dbo.hits AS h
  ON h.h_time >= n.d
  AND h.h_time < DATEADD(DAY, 1, n.d)
  -- AND --WHERE clause against hits?
  GROUP BY n.d; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T05:11:33.190

我从来都不喜欢使用系统表来创建要加入的虚拟记录，但这是一种非常常见的方法。

我接受了 Aaron Bertrand 的回答，并将通用表表达式 (CTE) 改为使用递归表达式。它更快，因为它不必点击表来进行查询。并不是说以前的版本很慢。

您需要指定“OPTION (MAXRECURSION 0);” 否则会将返回的行数限制为默认值（100）。值 0 将返回无限行。

```
DECLARE @min SMALLDATETIME, @max SMALLDATETIME;

--SELECT @min = MIN(h_time), @max = MAX(h_time)
--  FROM dbo.hits 

SELECT @min = '20120101', @max = '20121231';

WITH recursedate(each_date, date_index) AS
(
SELECT @min, 0 

UNION ALL 
SELECT DATEADD(DAY,date_index+1,@min), date_index+1
    FROM recursedate
    WHERE DATEADD(DAY,date_index+1,@min) <= @max
)

SELECT recursedate.each_date, [count] = COUNT(h.h_time)
  FROM recursedate
  LEFT OUTER JOIN dbo.hits AS h
  ON --CONVERT(SMALLDATETIME,h.h_time) =  recursedate.dates 
  h.h_time >= recursedate.each_date
   AND h.h_time < DATEADD(DAY, 1, recursedate.each_date)
  -- AND --WHERE clause against hits?
  GROUP BY recursedate.each_date
   OPTION (MAXRECURSION 0); -- The default is 100 so you'll only get 100 dates, 0 is unlimited. 
```

# iphone - 如何将日历信息从 web 服务发送到 iphone 应用程序？

> ID：12484350
> 
> 赞同：0
> 
> 时间：2012-09-18T20:19:37.173
> 
> 标签：iphone, web-services, calendar

我想创建或使用开源 php 日历作为 Web 服务。这只是我的整个应用程序想法的一个功能，但我正在逐步开发应用程序，并希望从日历开始。有没有办法使用 php 日历来更新 iphone 应用程序日历？例如，我希望能够在 iphone 应用程序中添加约会并在我的网站上的 php 日历上更新它？我想要双向同步。如果我决定通过网站在日历上添加事件，我希望它在 iphone 应用程序中更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:32:58.840

对于最大程度的定制，我会选择用 PHP 编写自己的日历。然后，您可以使日历完全按照您的意愿工作，并且可以与您的应用程序无缝协作。这应该不会太难，因为对于一个班级项目，我必须纠正一个简单的 PHP 日历（它没有 Web 服务，但仍然）。Ray Wenderlich 讨论了在 iOS 应用程序中使用 Web 服务的几种方法，甚至还有一个基于 PHP/MySQL 的示例。

*   [如何为 iOS 应用编写简单的 PHP/MySQL Web 服务](http://www.raywenderlich.com/2941/how-to-write-a-simple-phpmysql-web-service-for-an-ios-app)
*   [如何编写使用 Web 服务的 iOS 应用程序](http://www.raywenderlich.com/2965/how-to-write-an-ios-app-that-uses-a-web-service)

# mysql - 在 MySQL 中使用 IF 语句并使用语句的结果进行进一步计算

> ID：12484351
> 
> 赞同：0
> 
> 时间：2012-09-18T20:19:45.133
> 
> 标签：mysql, sql, if-statement

我有一个问题。我试图在我的 SQL 查询中使用 IF 语句，他们在进一步的计算中使用该语句的结果：

```
SELECT average_rating, number_of_ratings,    
    IF(number_of_ratings < 500 AND number_of_ratings > 100, 0.90, 
        IF(number_of_ratings>=500 AND number_of_ratings<=1000, 0.95, 
            IF(number_of_ratings>1000, 0.99, 0.80)
        )
    ) AS rating_factor,    
    ROUND((rating_factor * average_rating), 4) AS factored_rating    
FROM table
ORDER by factored_rating DESC 
```

但是，它不起作用并返回错误：**“字段列表”中的未知列“rating_factor”**

有人知道如何使它工作吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:39:02.103

如果您不需要 rating_factor 和 factored_rating 列，Alain 的查询将起作用。njk 的查询是子查询的 ANSI 兼容版本。

但是，由于您使用的是**MySQL**，因此您可以使用临时变量来存储值。我还简化了您的 IF 条件。

```
SELECT
    average_rating,
    number_of_ratings,
    @x := IF(number_of_ratings> 1000, 0.99,
          IF(number_of_ratings>=500 , 0.95,
          IF(number_of_ratings> 100 , 0.90,
                                      0.80))) rating_factor,
    ROUND((@x * average_rating), 4) AS factored_rating
FROM mytable
ORDER by factored_rating DESC 
```

这是一个用于显示此查询的[SQLFiddle 。](http://sqlfiddle.com/#!2/e3e52/1/0)
为了后代，示例在下面复制。

```
drop table if exists mytable;
create table mytable (
average_rating int,
number_of_ratings int,
factored_rating int);
insert into mytable
select 5,2,3 union all
select 4,1,5 union all
select 12,3,1 union all
select 11,4,2 union all
select 8,2,12; 
```

查询结果

```
"average_rating";"number_of_ratings";"rating_factor";"factored_rating"
"12";"3";"0.80";"9.6000"
"11";"4";"0.80";"8.8000"
"8";"2";"0.80";"6.4000"
"5";"2";"0.80";"4.0000"
"4";"1";"0.80";"3.2000" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:24:39.600

这应该有助于：

```
SELECT a.average_rating, a.number_of_ratings, ROUND((a.rating_factor * a.average_rating), 4) AS factored_rating
FROM
    (SELECT average_rating, number_of_ratings,    
        IF(number_of_ratings < 500 AND number_of_ratings > 100, 0.90, 
            IF(number_of_ratings>=500 AND number_of_ratings<=1000, 0.95, 
                IF(number_of_ratings>1000, 0.99, 0.80)
            )
        ) AS rating_factor   
    FROM table
    ORDER by factored_rating DESC) a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T20:26:22.613

`IF`在公式中使用语句的结果。我想我的括号是对的，但你应该看到这个想法：

```
SELECT average_rating, number_of_ratings,    
  ROUND((
    IF(number_of_ratings < 500 AND number_of_ratings > 100, 0.90, 
        IF(number_of_ratings>=500 AND number_of_ratings<=1000, 0.95, 
            IF(number_of_ratings>1000, 0.99, 0.80)
        )
    ) * average_rating), 4) as factored_rating    
FROM table
ORDER by factored_rating DESC 
```

# php - 如何使用 Ghostscript 将 PDF 文件的一部分裁剪为 PNG

> ID：12484353
> 
> 赞同：6
> 
> 时间：2012-09-18T20:20:03.700
> 
> 标签：php, pdf, png, ghostscript

我需要将我的 PDF 文件中的某个部分裁剪为 PNG（这将使用 Ghostscript 和 PHP 自动完成）。这就是我现在所做的，它基本上将 PDF 的第一页转换为 PNG：

```
gs -q -dNOPAUSE -dBATCH \
   -sDEVICE=pngalpha -dEPSCrop \
   -sOutputFile=output.png input.pdf 
```

具体来说，我正在尝试将[这张左上角的卡片](http://roma-bb.com/stackoverflowQuestion.pdf)裁剪为 PNG。我也愿意就如何实现这一目标提出更多建议。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-18T21:04:38.460

**首先，**
确定您的第一个 PDF 页面的边界框：

```
gs                          \
 -q                         \
 -dBATCH                    \
 -dNOPAUSE                  \
 -sDEVICE=bbox              \
 -dLastPage=1               \
  stackoverflowQuestion.pdf \
2>&1                        \
| grep %%BoundingBox 
```

结果输出将是：

```
%%BoundingBox: 119 531 464 814 
```

它的意思是：

*   边界框的左下角在坐标处`(119,531)`
*   边界框的右上角在坐标`(464,814)`

这些值以*PostScript 点*为单位（其中`72 pt == 1 inch`）。边界框就是那个矩形，其中包括在页面上留下墨水或墨粉标记的这些图形 PDF 对象。

**然后，**
创建您的 PNG。

根据边界框值，您似乎希望它宽 345 磅（`= 464 - 119`）和高 283 磅（`= 814 - 531`）。这导致页面大小为`-g345x283`(以像素为单位，因为 Ghostscript 默认使用 72 dpi 进行图像输出（除非另有说明），因此`72 px == 1 inch`.

或者更好的是，我们保持距离边界框 1 pt 的安全区域，因此我们使图像比最低限度大一点，我们得到这个图像尺寸：`-g347x285`.

您还需要从左边缘切掉 119 pt（118 pt 用于“安全”）和 531 pt 从底部边缘（530 用于安全）。

因此命令将是：

```
gs                                                      \
  -o out.png                                            \
  -sDEVICE=pngalpha                                     \
  -g347x285                                             \
  -dLastPage=1                                          \
  -c "<</Install {-118 -530 translate}>> setpagedevice" \
  -f stackoverflowQuestion.pdf 
```

这是生成的PNG：

![出.png](../Images/12ea9b071b589bc2c58f6fca41fcffe5.png)

为了获得更好的 PNG 质量，请将分辨率从默认的 72 dpi 增加到 720 dpi 并使用以下命令：

```
gs                                                      \
  -o out720dpi.png                                      \
  -sDEVICE=pngalpha                                     \
  -r720                                                 \
  -g3470x2850                                           \
  -dLastPage=1                                          \
  -c "<</Install {-118 -530 translate}>> setpagedevice" \
  -f stackoverflowQuestion.pdf 
```

* * *

**更新：**

在 CMD 窗口中的 Windows 上，Ghostscript 的控制台应用程序名称是`gswin32c.exe`和/或`gswin64c.exe`（而不是`gs`）。此外，您必须将其`^`用作续行字符（而不是`\`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-02T20:36:43.227

在 Windows 上，Ghostscript 的控制台应用程序名称是`gswin32c.exe`和/或`gswin64c.exe`（而不是`gs`）。

## 1.CMD窗口

在 CMD 窗口中，您必须将其`^`用作续行符（而不是`\`）。此外，`grep`可能不可用 - 请`findstr`改用。最后，如果`gswinXX.exe`不在 your`%PATH%`中，并且完整路径包含空格，则必须引用它：

```
"c:\program files\ghostscript\gswin64c.exe" ^
 -q                         ^
 -dBATCH                    ^
 -dNOPAUSE                  ^
 -sDEVICE=bbox              ^
 -dLastPage=1               ^
  stackoverflowQuestion.pdf ^
| findstr %%BoundingBox 
```

## 2\. PowerShell 窗口

在 PowerShell 窗口中，仅引用可执行文件的完整路径是行不通的。你必须运行：

```
& "c:\program files\ghostscript\gswin64c.exe" -q -o nul: -sDEVICE=bbox my.pdf 
```

# php - 返回之前显示的内容 部分

> ID：12484355
> 
> 赞同：1
> 
> 时间：2012-09-18T20:20:08.280
> 
> 标签：php, javascript

我正在使用 wampsever 创建一个网站。我使用 div 标签将页面划分为多个部分。为了在同一页面中显示菜单的内容，我使用了 JavaScript。

因此，在我使用的每个链接`href="javascript:ajaxpage('info.php', 'content');"`中，“内容”是要在其中显示我的信息的 div 的 id。

问题是使用退格按钮（在 Chrome 和 Firefox 10 中测试），我无法返回 div 选择部分中先前显示的内容。

PS：我在本地工作我的页面

提前感谢您的回答

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:27:37.683

大多数现代浏览器现在支持历史记录的 javascript 操作。[Mozilla 在这里](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)做了一个很好的总结。

有关跨浏览器的兼容性，请参阅[History.js](https://github.com/balupton/history.js)。

还有一些代码：

```
// 1\. Push a state when page loads.
history.pushState(window.location.href, 'Page Title', window.location.href);

// 2\. On every ajax navigation, push that state
history.pushState(ajaxHref, 'Page title', ajaxHref);

// 3\. Setup a event for onpopstate (when the user goes back)
window.onpopstate = function(e) {
    if(e.state != null)
        ajaxpage(e.state, 'content');
}; 
```

# java - 休眠多对多中的死锁与连接表

> ID：12484358
> 
> 赞同：0
> 
> 时间：2012-09-18T20:20:17.210
> 
> 标签：java, hibernate, hibernate-mapping

我正在开发一个企业应用程序，我们在其中使用 Hibernate 以及与连接表的多对多关系。我们在生产中（大量）看到非常零星的数据库死锁，我们无法重新创建。

**类别.java**

```
public class Category {
    ....
    private Set<Product> products = new HashSet<Product>();
    ...
} 
```

**类别.hbm.xml**

```
<class 
    name="Category"
    table="CATEGORY"
>
    ...
   <!-- uni-directional many-to-many association to Product -->
   <set
       name="products"
       table="CATEGORY_PRODUCT_ASSC"
       lazy="false"
       cascade="none"
    >
        <key column="CATEGORY_ID" />
        <many-to-many class="Product" column="PRODUCT_ID" />
    </set>
</class> 
```

**Product.java、Product.hbm.xml**没有一组类别，因为这是单向多对多

该`CATEGORY_PRODUCT_ASSC`表是一个简单的连接表，只有 2 列：`CATEGORY_ID`和`PRODUCT_ID`.

现在，我们调用`Session.saveOrUpdate`Category 实例对象的唯一目的是获取 CATEGORY_PRODUCT_ASSC 连接表中的插入（Category 上没有任何变化）

我打开休眠`show_sql`并看到以下内容：

```
update CATEGORY set NAME=?, DESCRIPTION=?, where category_id=?
insert into CATEGORY_PRODUCT_ASSC (CATEGORY_ID, PRODUCT_ID) values (?, ?) 
```

问题是我们在多个服务器上以完全相同的时间创建了许多产品，所有产品都属于同一个类别。

当我们看到死锁时，`update CATEGORY`不可避免地会涉及到调用。我们需要阻止这些`update CATEGORY`SQL 语句被执行。

选项1：有什么方法可以调用 Session.saveOrUpdate(category) 并让它不更新 Category （因为它没有改变），但仍然插入连接表 CATEGORY_PRODUCT_ASSC ？

选项 2：如果没有，我们考虑过通过 JDBC 直接插入 CATEGORY_PRODUCT_ASSC 行。然而，一个问题是缓存中陈旧的 Hibernate 对象（Category 对象）。关于这种可能的方法的任何想法/建议？

非常感谢您的帮助。:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T02:39:44.287

我们解决了这个问题。结果确实是`update category`声明。我们没有使用该`CATEGORY_PRODUCT_ASSC`表作为多对多关系的连接，而是创建了一个 Hibernate 管理的实体来表示这个连接表`CategoryProductAssc`......。

这样，我们可以直接保持关系，而无需调用`Session.saveOrUpdate`Category 实例对象，其唯一目的是在`CATEGORY_PRODUCT_ASSC`Category 对象上没有任何更改时获取连接表中的插入。

我创建了 Cactus 测试，可以同时执行 20 次，测试旧代码和新代码，我们的 DBA 监控并看到旧代码的并发性，而新代码没有并发性。

# java - 如何更改 AdMob 广告的大小

> ID：12484359
> 
> 赞同：0
> 
> 时间：2012-09-18T20:20:25.733
> 
> 标签：java, android, admob

最近我将 AdMob 添加到我的应用中，我想调整 AdMmob 广告的大小。

有没有办法做到这一点？

# ios - 无法在 UIScrollView 中居中 UIImageView

> ID：12484362
> 
> 赞同：1
> 
> 时间：2012-09-18T20:20:29.347
> 
> 标签：ios, uitableview, uiscrollview

我正在向 UIScrollView 添加一系列 UIImageViews 并且我失败了，因为东西没有垂直或水平居中。

我尝试了以下方法，但它似乎不起作用：

在我的 UiTableViewController viewdidLoad 中：

```
UIImage *waitingImage = [UIImage imageWithContentsOfFile:pathOfNoImageFile];
                     UIImageView *imageview = [[UIImageView alloc] init];

              [imageview  setImageWithURL:[NSURL URLWithString:imageURL] placeholderImage:waitingImage];

                     [imageview setContentMode:UIViewContentModeScaleAspectFit];
                     self.scrollview.imageview = imageview;
                     [self.scrollview addSubview:imageview]; 
```

我正在使用自定义 UIScrollview 以便它可以进行居中：

标题

```
#import <UIKit/UIKit.h>
@interface ListingDetailScrollViewController : UIScrollView
@property (nonatomic, retain) UIImageView *imageview;
@end 
```

执行

```
#import "ListingDetailScrollViewController.h"

@implementation ListingDetailScrollViewController
@synthesize imageview=_imageview;

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
    }
    return self;
}

/*
// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    // Drawing code
}
*/
- (void)layoutSubviews {
    [super layoutSubviews];

    // center the image as it becomes smaller than the size of the screen
    CGSize boundsSize = self.bounds.size;
    CGRect frameToCenter = self.imageview.frame;

    // center horizontally
    if (frameToCenter.size.width < boundsSize.width)
        frameToCenter.origin.x = (boundsSize.width - frameToCenter.size.width) / 2;
    else
        frameToCenter.origin.x = 0;

    // center vertically
    if (frameToCenter.size.height < boundsSize.height)
        frameToCenter.origin.y = (boundsSize.height - frameToCenter.size.height) / 2;
    else
        frameToCenter.origin.y = 0;

    self.imageview.frame = frameToCenter;
}

@end 
```

任何提示或想法？

# c++ - 如何发现 pendrive 处于只读模式？

> ID：12484364
> 
> 赞同：2
> 
> 时间：2012-09-18T20:20:31.403
> 
> 标签：c++, linux, system-calls

我的问题如下：我有一个在嵌入式 Linux 系统中运行的 C++ 软件，该软件具有将一些数据导出到 pendrive 的功能，现在我的陷阱来了，一些用户试图使用旧的 pendrive 中的一键更改在读/写和只读模式之间。现在，我需要知道如何检查设备是否处于只读模式，以便在我的应用程序中向用户显示一些反馈。在挂载设备之前是否有系统调用来检查只读状态？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T20:26:28.417

处理这种情况的通常方法是尝试打开一个文件进行写入，然后检查`errno == EACCES`.

但是，如果您必须事先检查，那就是

```
int on_readonly_fs(char const *path)
{
    struct statvfs fsinfo;

    while (statvfs(path, &fsinfo)) == -1)
        if (errno != EINTR)
            return -1;
    return fsinfo.f_flag & ST_RDONLY;
} 
```

但这仅**在**安装设备后才有效。

# database - 如何在 HQL 中调用没有表名的存储过程？

> ID：12484367
> 
> 赞同：1
> 
> 时间：2012-09-18T20:20:46.543
> 
> 标签：database, nhibernate, datetime, hql

我正在尝试通过 HQL 中的存储过程获取当前时间戳。这意味着我的代码如下所示：

```
var currentTimestamp =
    session.CreateQuery("SELECT CURRENT_TIMESTAMP()")
           .UniqueResult<DateTime>(); 
```

这行不通。具体来说，它`System.NullReferenceException`深入研究了 NHibernate HqlParser.cs 文件。我对此进行了一些尝试，并改为使用以下方法：

```
var currentTimestamp =
    session.CreateQuery("SELECT CURRENT_TIMESTAMP() FROM Contact")
           .SetMaxResults(1)
           .UniqueResult<DateTime>(); 
```

现在我有了我想要的数据，但我没有 HQL 查询。我希望查询代表我要问的问题——就像我的原始格式一样。

这里有一个明显的问题是“你为什么使用 HQL？” 我知道我可以很容易地做到这一点`session.CreateSQLQuery(...)`，直接访问我们的 MySQL 5.1 数据库。这只是我的核心问题的一个示例，根本原因是我在整个代码库中使用自定义无参数 HQL 函数，并且我希望进行集成测试，以尽可能隔离地运行这些 HQL 无参数函数可能的。

我的 hack 还包含一些严肃的假设。它不会返回结果，例如，如果 Contact 表中没有记录，或者 Contact 表不再存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T13:37:48.263

在数据库表的上下文之外检索 CURRENT_TIMESTAMP()（或任何其他数据库函数）的方法因数据库而异 - 有些允许，有些不允许。例如，Oracle 不允许在没有表的情况下进行选择，因此它们提供了一个具有单行的系统表，称为 DUAL。

我怀疑 NHibernate 在 HQL 中主要实现了所有数据库实现中通用的功能，因此没有实现无表选择。

我可以建议三种方法：

1.  创建一个隐藏无表选择的视图，例如“create view dtm as select current_timestamp() as datetime”

2.  遵循 Oracle 方法并创建一个包含单行的实用程序表，您可以将其用作选择中的表

3.  创建一个仅执行“select current_timestamp()”的简单存储过程

# java - Java：我可以在字符串中编码吗？

> ID：12484371
> 
> 赞同：0
> 
> 时间：2012-09-18T20:21:07.167
> 
> 标签：java, string, command

> **可能重复：**[使用 Java 中的 eval](https://stackoverflow.com/questions/2605032/using-eval-in-java)
> [执行文本文件中给出的 java 代码](https://stackoverflow.com/questions/1057796/executing-java-code-given-in-a-text-file)

我编写了一个 Java 程序，我想知道我是否可以在 String 中执行 Java。例如，假设我有以下内容：

```
String s = "int i = 1;"; 
```

在上面的字符串中，我有一个 Java 命令。我可以在我的实际程序中执行字符串之外的命令吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:26:09.560

你可以用[BeanShell](http://www.beanshell.org/)之类的东西来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:22:10.437

不，您不能将代码输入到这样的字符串中。该`"`符号本质上将真实代码与字符串分隔开来。

一旦你输入`String xyz =`你正在创建一个变量，接下来需要的是一个字符串值。也许以后你可以用它做点什么，但截至目前它是不可执行的

您可能想复习一下字符串：

[Java 字符串类](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html)

[字符串内的引号](https://stackoverflow.com/questions/8354168/quotation-marks-inside-a-string)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T20:24:00.623

虽然像这样解析 Java 可能很[棘手](https://stackoverflow.com/questions/935175/convert-string-to-code)，但您可以使用[Rhino](https://stackoverflow.com/questions/4719055/javascript-engine-for-java)之类的东西来评估字符串中的 JavaScript。不过，这可能有点超出您的要求。

# search - Google Site Search 未将结果传递给 Google 搜索帐户

> ID：12484376
> 
> 赞同：0
> 
> 时间：2012-09-18T20:21:35.983
> 
> 标签：search, google-analytics

请考虑以下问题（问题是，我们页面上的 Google 搜索结果未在我们的 Google Analytics 帐户中注册）：

**HTML表格：**

```
 <div style="float:right; margin-right:12px;">
    <form id="cse-search-box" name="srchfrm" action="http://google.com/cse" target="_blank" onsubmit="validatesearch()">
        <input value="999999999999999999999:srraaaaaaaa" name="cx" type="hidden"/>
        <input id="q" name="q" type="text" onKeyPress="return submitenter(this,event)" placeholder="Search"/>
        <a href="javascript:;" onmouseover="MM_swapImage('go','','/btn_go_on.gif',1)" onmouseout="MM_swapImgRestore()" />
        <input type="image" src="/btn_go.gif" alt="Go" width="20" height="21" border="0" align="top" id="go"/>
        <input value="UTF-8" name="ie" type="hidden"/>    
    </form> 
</div>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load('search', '1');
  google.setOnLoadCallback(function() {
    google.search.CustomSearchControl.attachAutoCompletion(
      '999999999999999999999:srraaaaaaaa',
      document.getElementById('q'),
      'cse-search-box');
  });
</script> 
```

**执行搜索的 URL：**

```
http://www.google.com/cse?cx=999999999999999999999:srraaaaaaaa&q=test+search&x=12&y=11&ie=UTF-8&oq=&gs_l=#gsc.tab=0&gsc.q=test%20search&gsc.page=1 
```

**正在使用的查询参数：**

```
q
query (I read in another post to try this) 
```

感谢您提前提供的所有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T16:13:15.907

通过改变：

```
action="http://google.com/cse" 
```

之内，

```
<form id="cse-search-box" name="srchfrm" action="http://google.com/cse" target="_blank" onsubmit="validatesearch()"> 
```

重定向到网站内的页面，这解决了这个问题。

工作代码：

```
<div style="float:right; margin-right:12px;">
    <form id="searchbox_99999999999999999999:srraaaaaaaa" name="srchfrm" action="/search" target="_self" onsubmit="validatesearch()">
        <input value="99999999999999999999:srraaaaaaaa" name="cx" type="hidden"/>
        <input id="q" name="q" autocomplete="off" type="text" onKeyPress="return submitenter(this,event)" placeholder="Search"/>
        <input name="ie" value="UTF-8" type="hidden"/>
        <a href="javascript:;" onmouseover="MM_swapImage('go','','/btn_go_on.png',1)" onmouseout="MM_swapImgRestore()" />
        <input type="image" src="/btn_go.png" alt="Go" width="20" height="21" border="0" align="top" id="go"/> 
    </form> 
</div> 
```

根据 Google 文档，搜索页面本身具有以下代码：

头：

```
<script>
  (function() {
    var cx = '99999999999999999999:srraaaaaaaa';
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
  })();
</script> 
```

身体：

```
<gcse:searchresults-only></gcse:searchresults-only> 
```

# sql-server - 计数 count(column) > 2 的记录

> ID：12484381
> 
> 赞同：2
> 
> 时间：2012-09-18T20:21:49.513
> 
> 标签：sql-server, tsql

我有一个具有以下属性的 CustomerData 表：FirstName、LastName、DateofBirth、ID、Location

我正在尝试编写一个查询来提取属于多个位置的用户的名字、姓氏、出生日期和 IDNumber。

我尝试了以下代码，但我收到关于需要 group by 子句的聚合的错误。

```
SELECT *
FROM CustomerData
WHERE Count(Location) > 2 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:23:47.277

使用[HAVING](http://msdn.microsoft.com/en-us/library/ms180199.aspx)：

```
SELECT FirstName, LastName, DateofBirth, ID, Count(Location)
FROM CustomerData
GROUP BY FirstName, LastName, DateofBirth, ID
HAVING Count(Location) > 2 
```

HAVING 基本上是一个`WHERE`允许您使用聚合函数的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:29:11.197

您还可以使用子查询：

```
select c1.FirstName, c1.LastName, c1.DateofBirth, c1.ID, c2.CntLocation
from CustomerData c1
left join
(
    SELECT Count(Location) CntLocation, location
    FROM CustomerData
    group by location
) c2
    on c1.location = c2.location
WHERE CntLocation > 2 
```

# c# - .NET Form Treeview 节点宽度和自定义绘制文本（无法设置节点边界）

> ID：12484383
> 
> 赞同：3
> 
> 时间：2012-09-18T20:21:51.833
> 
> 标签：c#, winforms, treeview, ownerdrawn

我有一个 Windows 形式的树视图。我最近添加了代码来自定义绘制文本，以便我可以摆弄放置、粗体文本等。一切都很好，只是当我进行更改时，节点边界没有更新，因此水平滚动条会混淆思考它不需要显示。我猜是这种情况，因为当我单击树上的一个节点时，我看到一个我认为是节点边界的框，它太小了。

在我的 OnDrawText 方法中，我希望能够更改 DrawTreeNodeEventArgs 的节点成员上的边界，但它是只读的。

我已经痛苦地寻找了很长时间的解决方案，但无济于事。设置树视图本身的边界不会使滚动条出现。我在我的 OnDrawText 方法中使用 TextRenderer.DrawText()，如果这有所作为的话。

非常感谢任何帮助！

如果有人认为查看代码会有所帮助，我会添加它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T17:10:09.560

为了其他人的利益，我将提供我的 hackorama（感谢 Hans！）以供参考。

当我最初构建我的树时，我现在在我将在我的 ...OnDrawText(object sender, DrawTreeNodeEventArgs e) 方法中修改的节点的 .Text 末尾填充空白。在这种方法中，我使用 TextRenderer.DrawText 来自定义节点的外观，但是在计算我的滚动条大小时不会考虑与自定义内容对应的矩形。滚动条的大小仍然由原始文本决定。由于原始文本（大量）填充了空白，因此滚动条被适当地绘制。

我不确定随着时间的推移这将如何保持，但它现在有效。

2012 年 11 月 12 日编辑：要隐藏工具提示，请忽略一些 WndProc 消息。WM_VSCROLL 部分是为了减少滚动时的闪烁。其他案例与工具提示有关，但我不记得究竟是哪一个做了什么。我认为 Notify 可能是您唯一需要的，但我想我会添加整个方法以防万一。

```
protected override void WndProc(ref Message m)
    {
        switch (m.Msg)
        {
            //case WindowsConstants.WM_HSCROLL:
            case WindowsConstants.WM_VSCROLL:
                {
                    var nfy = m.WParam.ToInt32() & 0xFFFF;
                    if (nfy == WindowsConstants.SB_THUMBTRACK)
                    {
                        currentMsgCount++;
                        if (currentMsgCount % skipMsgCount == 0)
                            base.WndProc(ref m);
                        return;
                    }
                    if (nfy == WindowsConstants.SB_ENDSCROLL)
                        currentMsgCount = 0;

                    base.WndProc(ref m);
                }
                break;
            case WindowsConstants.MouseLeave:
            case WindowsConstants.NcMouseLeave:
            case WindowsConstants.MouseHover:
            case WindowsConstants.NcMouseHover:
            case WindowsConstants.Notify:
                break;
            default:
                base.WndProc(ref m);
                break;
        }

    }

    public const int NcMouseHover = 0x2a0;
    public const int MouseHover = 0x2a1;
    public const int NcMouseLeave = 0x2a2;
    public const int MouseLeave = 0x2a3;
    public const int Notify = 0x4e; 
```

# javascript - 不区分大小写地访问 JavaScript 属性？

> ID：12484386
> 
> 赞同：102
> 
> 时间：2012-09-18T20:21:58.620
> 
> 标签：javascript, object, properties

假设我有一个对象：

```
var obj = {
  foo:"bar",
  fizz:"buzz"
}; 
```

我需要像这样动态访问该对象的属性：

```
var objSetter = function(prop,val){
  obj[prop] = val;
} 
```

那里没有问题，除了`prop`需要不区分大小写以防将属性名称传递给函数，例如，`Foo`而不是`foo`.

那么如何不区分大小写按名称指向对象的属性呢？如果可能，我想避免迭代整个对象。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2017-11-28T17:58:32.427

试试这个：

```
var myObject = { "mIxeDCaSEKeY": "value" };

var searchKey = 'mixedCaseKey';
var asLowercase = searchKey.toLowerCase();
myObject[Object.keys(myObject).find(key => key.toLowerCase() === asLowercase)]; 
```

您也可以提供小写的 searchKey。

如果你想要它作为一个函数：

```
/**
  * @param {Object} object
  * @param {string} key
  * @return {any} value
 */
function getParameterCaseInsensitive(object, key) {
  const asLowercase = key.toLowercase();
  return object[Object.keys(object)
    .find(k => k.toLowerCase() === asLowercase)
  ];
} 
```

如果找不到对象，那么它将返回 undefined，就像正常一样。

如果您需要支持较旧的浏览器，则可以`filter`改用：

```
function getParameterCaseInsensitive(object, key) {
  const asLowercase = key.toLowercase();
  return object[Object.keys(object).filter(function(k) {
    return k.toLowerCase() === asLowercase;
  })[0]];
} 
```

如果您需要更旧的支持，我建议使用[Object.keys()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys#Polyfill)和[Array.filter()的 polyfill。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter#Polyfill)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-09-18T20:30:53.577

将 obj 的所有属性与 prop 进行比较。

```
var objSetter = function(prop,val){
  prop = (prop + "").toLowerCase();
  for(var p in obj){
     if(obj.hasOwnProperty(p) && prop == (p+ "").toLowerCase()){
           obj[p] = val;
           break;
      }
   }
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-10-15T22:28:10.293

为此，我更喜欢使用原型而不是独立函数，只是为了易于使用和表现力。如果我不需要的话，我只是不喜欢将对象汇集到函数中。

此外，虽然公认的答案有效，但我想要一个更全面的解决方案，用于获取和设置，其行为尽可能类似于原生点表示法或括号表示法。

考虑到这一点，我创建了几个原型函数来设置/获取对象属性，而不考虑大小写。在添加到 Object 原型时，您必须记住要***非常负责。***尤其是在使用 JQuery 和其他库时。将 enumerable 设置为 false 的 Object.defineProperty() 专门用于避免与 JQuery 冲突。我也没有费心为函数命名任何表明它们不区分大小写的东西，但你当然可以。我喜欢较短的名字。

这是吸气剂：

```
Object.defineProperty(Object.prototype, "getProp", {
    value: function (prop) {
        var key,self = this;
        for (key in self) {
            if (key.toLowerCase() == prop.toLowerCase()) {
                return self[key];
            }
        }
    },
    //this keeps jquery happy
    enumerable: false
}); 
```

这是二传手：

```
Object.defineProperty(Object.prototype, "setProp", {
    value: function (prop, val) {
        var key,self = this;
        var found = false;
        if (Object.keys(self).length > 0) {
            for (key in self) {
                if (key.toLowerCase() == prop.toLowerCase()) {
                    //set existing property
                    found = true;                        
                    self[key] = val;
                    break;
                }
            }
        }

        if (!found) {
            //if the property was not found, create it
            self[prop] = val;
        }  

        return val;
    },
    //this keeps jquery happy
    enumerable: false
}); 
```

现在我们已经创建了这些函数，我们的代码非常干净简洁，并且可以正常工作。

不区分大小写的获取：

```
var obj = {foo: 'bar', camelCase: 'humpy'}

obj.getProp("FOO");          //returns 'bar'
obj.getProp("fOO");          //returns 'bar'
obj.getProp("CAMELCASE");    //returns 'humpy' 
obj.getProp("CamelCase");    //returns 'humpy' 
```

不区分大小写的设置：

```
var obj = {foo: 'bar', camelCase: 'humpy'}

obj.setProp('CAmelCasE', 'super humpy');     //sets prop 'camelCase' to 'super humpy'
obj.setProp('newProp', 'newval');      //creates prop 'newProp' and sets val to 'newval'  
obj.setProp('NewProp', 'anotherval');  //sets prop 'newProp' to 'anotherval' 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-12-28T06:48:41.567

已经提出的另一种变体将迭代向下推入下划线/Lodash`findKey`函数：

```
var _ = require('underscore');
var getProp = function (obj, name) {
    var realName = _.findKey(obj, function (value, key) {
        return key.toLowerCase() === name.toLowerCase();
    });
    return obj[realName];
}; 
```

例如：

```
var obj = { aa: 1, bB: 2, Cc: 3, DD: 4 };
getProp(obj, 'aa'); // 1
getProp(obj, 'AA'); // 1
getProp(obj, 'bb'); // 2
getProp(obj, 'BB'); // 2
getProp(obj, 'cc'); // 3
getProp(obj, 'CC'); // 3
getProp(obj, 'dd'); // 4
getProp(obj, 'DD'); // 4
getProp(obj, 'EE'); // undefined 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-18T20:26:41.673

您可以这样做以“正常化”`prop`

```
 var normalizedProp = prop.toLowerCase();
 obj[normalizedProp] = val; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-30T14:38:41.963

在我看来，它是带有陷阱的代理的一个很好的候选者，可以将字符串键转换为大写或小写，并且表现得像一个常规对象。这适用于任何一种表示法：点或括号

这是代码：

```
'use strict';

function noCasePropObj(obj)
{
	var handler =
	{
		get: function(target, key)
			{
				//console.log("key: " + key.toString());
				if (typeof key == "string")
				{
					var uKey = key.toUpperCase();

					if ((key != uKey) && (key in target))
						return target[key];
					return target[uKey];
				}
				return target[key];
			},
		set: function(target, key, value)
			{
				if (typeof key == "string")
				{
					var uKey = key.toUpperCase();

					if ((key != uKey) && (key in target))
						target[key] = value;
					target[uKey] = value;
				}
				else
					target[key] = value;
			},
		deleteProperty: function(target, key)
			{
				if (typeof key == "string")
				{
					var uKey = key.toUpperCase();

					if ((key != uKey) && (key in target))
						delete target[key];
					if (uKey in target)
						delete target[uKey];
				}
				else
					delete target[key];
			},
	};
	function checkAtomic(value)
	{
		if (typeof value == "object")
			return new noCasePropObj(value); // recursive call only for Objects
		return value;
	}

	var newObj;

	if (typeof obj == "object")
	{
		newObj = new Proxy({}, handler);
        // traverse the Original object converting string keys to upper case
		for (var key in obj)
		{
			if (typeof key == "string")
			{
				var objKey = key.toUpperCase();

				if (!(key in newObj))
					newObj[objKey] = checkAtomic(obj[key]);
			}
		}
	}
	else if (Array.isArray(obj))
	{
        // in an array of objects convert to upper case string keys within each row
		newObj = new Array();
		for (var i = 0; i < obj.length; i++)
			newObj[i] = checkAtomic(obj[i]);
	}
	return newObj; // object with upper cased keys
}

// Use Sample:
var b = {Name: "Enrique", last: "Alamo", AdDrEsS: {Street: "1233 Main Street", CITY: "Somewhere", zip: 33333}};
console.log("Original: " + JSON.stringify(b));  // Original: {"Name":"Enrique","last":"Alamo","AdDrEsS":{"Street":"1233 Main Street","CITY":"Somewhere","zip":33333}}
var t = noCasePropObj(b);
console.log(JSON.stringify(t)); // {"NAME":"Enrique","LAST":"Alamo","ADDRESS":{"STREET":"1233 Main Street","CITY":"Somewhere","ZIP":33333}}
console.log('.NaMe:' + t.NaMe); // .NaMe:Enrique
console.log('["naME"]:' + t["naME"]); // ["naME"]:Enrique
console.log('.ADDreSS["CitY"]:' + t.ADDreSS["CitY"]); // .ADDreSS["CitY"]:Somewhere
console.log('check:' + JSON.stringify(Object.getOwnPropertyNames(t))); // check:["NAME","LAST","ADDRESS"]
console.log('check2:' + JSON.stringify(Object.getOwnPropertyNames(t['AddresS']))); // check2:["STREET","CITY","ZIP"]
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-04-30T02:59:39.263

这个答案需要 ES6。

```
const x = { 'aB': 1, 'X-Total-Count': 10, y3: 2 }
console.log(x[Object.keys(x).find(key=>{return key.match(/^ab$/i)})])
console.log(x[Object.keys(x).find(key=>{return key.match(/^x-total-count$/i)})])
console.log(x[Object.keys(x).find(key=>{return key.match(/^y3$/i)})])
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-13T15:00:44.080

```
const getPropertyNoCase = (obj, prop) => obj[Object.keys(obj).find(key => key.toLowerCase() === prop.toLowerCase() )]; 
```

或者

```
const getPropertyNoCase = (obj, prop) => {
    const lowerProp = prop.toLowerCase(obj[Object.keys(obj).find(key => key.toLowerCase() === prop.toLowerCase() )];
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-12-02T19:58:24.670

@nilloc 发布的 ES6 示例不正确，将无法使用。

这是一个工作示例：

```
const x = {'first':5,'X-Total-Count':10,'third':20};
console.log(x[Object.keys(x).reduce((result,key)=>{
   if (!result) {
      return key.match(/x-total-count/i)
   } else {
      return result;
   }
 },null)]); 
```

或者更好的是，如果键不存在，它应该返回 undefined：

```
const x = {'first':5,'X-Total-Count':10,'third':20};
console.log(x[Object.keys(x).reduce((result,key)=>{
   if (!result) {
     return key.match(/x-total-count/i) || undefined
   } else {
     return result;
   }
  },undefined)]); 
```

一个考虑是，如果有多个匹配的键，上面的示例将返回对象中最后一个匹配的键。

这是一个将代码制成函数的示例：

```
/**
  * @param {Object} object
  * @param {string} key
  * @return {string||undefined} value || undefined
 */
function getKeyCase(obj,key) {
  const re = new RegExp(key,"i");
  return Object.keys(obj).reduce((result,key)=>{
   if (!result) {
     return key.match(re) || undefined
   } else {
     return result;
   }
  },undefined);

const x = {'first':5,'X-Total-Count':10,'third':20};

console.log(x[getKeyCase(x,"x-total-count")]); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-12-16T21:22:06.703

不能像看起来那样跳过迭代真的很遗憾。对我来说，可以接受但可能不是每个人都可以通过迭代来塑造对象一次，然后以常规的 hashmap 方式使用它。

```
const hashmap = {
  'FOO': 'foo as in function programming',
  'bar': 'bar is in baz',
};

const shapedmap = Object.entries(hashmap).reduce(
  (acc, [key, val]) => (acc[key.toUpperCase()] = val, acc), {}
);

for (const term of ['foo', 'bar', 'baz']) {
  const match = shapedmap[term.toUpperCase()]
  match && console.log('awesome, we got the term.', match);
};
```

即使只需要执行一次查找，它的性能也不会低于任何其他迭代解决方案，因为在 1 次通过后，查找速度是恒定的。（我猜）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-09-18T21:15:55.777

不需要任何迭代。由于`prop`可能不是字符串，因此应在适当的情况下首先将其强制转换为字符串，因为这是对象本机所做的。一个简单的 getter 函数是：

```
function objGetter(prop) {
  return obj[String(prop).toLowerCase()];
} 
```

如果需要重新设置对自己属性的访问权限：

```
function objGetter(prop) {
  prop = String(prop).toLowerCase();

  if (obj.hasOwnProperty(prop)) {
    return obj.prop;
  }
} 
```

和一个二传手：

```
function objSetter(prop, val) {
  obj[String(prop).toLowerCase()] = val;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-11-25T15:51:06.620

这是一个非常简单的代码来执行此操作假设数据是对象数组，例如

```
data=[{"A":"bc","B":"nn"}]

var data=data.reduce(function(prev, curr) {
    var cc = curr; // current value
    var K = Object.keys(cc); // get all keys
    var n = {};
    for (var i = 0; i < K.length; i++) {
        var key = K[i];//get hte key

        n[key.toLowerCase()] = cc[key] // convert to lowercase and assign 
    }
    prev.push(n) // push to array
    return prev;
}, []) 
```

输出将是

```
data=[{"a":"bc","b":"nn"}] 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-05-23T14:22:43.377

如果区分大小写的匹配（便宜且快速）失败，您可能只需要进行不区分大小写的匹配（通常由于对象迭代而昂贵）。

假设你有：

```
var your_object = { "Chicago" : 'hi' , "deTroiT" : 'word' , "atlanta" : 'get r dun' } ; 
```

无论出于何种原因，您都有 the_value, `Detroit`：

```
if( your_object.hasOwnProperty( the_value ) ) 
  { 
    // do what you need to do here
  } 
else  
  { // since the case-sensitive match did not succeed, 
    //   ... Now try a the more-expensive case-insensitive matching

    for( let lvs_prop in your_object ) 
      { if( the_value.toLowerCase()  == lvs_prop.toLowerCase() ) 
          { 

            // do what you need to do here

            break ;
          } ;
      } 
  } ; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-12-22T16:11:30.923

当我们简单地把它全部变成小写时，为什么我们要做得那么复杂：

```
 var your_object = { 
"chickago" : 'hi' ,
 "detroit" : 'word', 
 "atlanta" : 'get r dun',     
GetName: function (status) {
        return this[status].name;
    } }; 
```

**称之为：** `your_object.GetName(your_var.toLowerCase());`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-01-12T12:56:15.823

另一种简单的方法：

```
function getVal(obj, prop){
var val;
  prop = (prop + "").toLowerCase();
  for(var p in obj){
     if(obj.hasOwnProperty(p) && prop == (p+ "").toLowerCase()){
           val = obj[p]
           break;
      }
   }
   return val;
} 
```

像这样使用它：

```
var obj = {
  foo:"bar",
  fizz:"buzz"
};
    getVal(obj,"FoO") -> returns "bar" 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-10-22T15:16:46.753

这是一个很好的递归函数，它允许您以不区分大小写的方式遍历 javascript 对象：

```
let testObject = {'a': {'B': {'cC': [1,2,3]}}}
let testSeq = ['a','b','cc']

function keySequence(o, kseq) {
  if(kseq.length==0){ return o; }
  let validKeys = Object.keys(o).filter(k=>k.toLowerCase()==kseq[0].toLowerCase());
  if(validKeys.length==0) { return `Incorrect Key: ${kseq[0]}` }
  return keySequence(o[validKeys[0]], kseq.slice(1))
}

keySequence(testObject, testSeq); //returns [1,2,3] 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-03-17T07:35:25.837

这会将所有内容都转换为小写，但如果您不关心保留大小写，这可能会有所帮助。

```
var somedata = {
    "MixEdCase": 1234
}

var temp = JSON.parse(JSON.stringify(somedata).toLowerCase());

console.log(temp.mixedcase);
// or
console.log(temp["mixedcase"]); 
```

# html - 与带有 webkit-autofill 伪类的输入相关的样式标记

> ID：12484387
> 
> 赞同：0
> 
> 时间：2012-09-18T20:22:03.003
> 
> 标签：html, css, autocomplete, webkit, stylesheet

我正在尝试使用 -webkit-autofill 伪类为与输入相关的兄弟设置样式，如下所示：

```
input:-webkit-autofill~span.add-on { background-color: #FAFFBD;} 
```

但它不起作用。是否有可能实现我正在尝试的目标？还是我应该为此依赖javascript？

用 HTML 更新：

```
<div>
  <span class="add-on icon-user"></span
  <input type="text" id="user_name" name="user[user_name]">
</div> 
```

为了澄清事情，我想要实现的是在自动填充输入时为 span 元素设置相同的背景颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T09:30:56.463

您不能使用纯 CSS 设置前面的兄弟姐妹的样式。选择器`~`匹配第一个元素之后的兄弟。

或者可以在 MDN 文档中阅读：

> ~ 组合符分隔两个选择器，并且仅当第二个元素在第一个元素之前时才匹配第二个元素，并且两者共享一个共同的父元素。

[https://developer.mozilla.org/en-US/docs/CSS/General_sibling_selectors](https://developer.mozilla.org/en-US/docs/CSS/General_sibling_selectors)

```
input:-webkit-autofill~span.add-on { background-color: #FAFFBD;} 
```

将匹配跨度：

```
<div>
    <input type="text" id="user_name" name="user[user_name]">
    <span class="add-on icon-user"></span>
</div> 
```

# ruby-on-rails - 由于 nil 值导致的路由错误

> ID：12484388
> 
> 赞同：0
> 
> 时间：2012-09-18T20:22:05.047
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

运行 Rail App 时出现以下错误。我相信这是因为 Rails 显示的是 0 而不是 1 的评论。记录 0 不存在。我想做的就是让编辑每条评论成为可能。

我认为错误在于我如何创建指向嵌套资源的链接（即链接到帖子中的评论）。

**错误**

> "没有路由匹配 {:action=>"show", :controller=>"comments", :post_id=>1, **:id=>nil}** 尝试运行 rake 路由以获取有关可用路由的更多信息。"

**显示.html.erb：**

```
<% @post.comments.each do |c| %>
<p>
  <b><%=h c.name %> said:</b><br />
  <%= c.created_at %>
</p>

<p>
  <%=h c.body %>
</p>

<p>
  <%=h c.id %>
</p>

<%= link_to 'test', post_comment_path(:post_id => @post.id, :id => c.id) %> |

<%#= link_to 'Edit', edit_post_comment_path(:id => @comment.id,
                                           :id => @post.id) %>

<%= link_to 'Comment', [@post, :comments ] %> |
<%= link_to 'Edit', edit_comment_path(@comment) %> |
<%= link_to 'Back', comments_path %> 
```

当我删除此行时，错误消失了。

> <%= link_to 'test', post_comment_path(:post_id => @post.id, :id => c.id) %> |

耙路线输出：

```
 C:\RUBY\RailsInstaller\Ruby1.9.3\bin\ruby.exe -e  $stdout.sync=true;$stderr.sync=true;load($0=ARGV.shift)
    C:\RUBY\RailsInstaller\Ruby1.9.3\bin\rake routes
          posts_list GET    /posts/list(.:format)                       posts#list
       post_comments GET    /posts/:post_id/comments(.:format)          comments#index
                     POST   /posts/:post_id/comments(.:format)          comments#create
    new_post_comment GET    /posts/:post_id/comments/new(.:format)      comments#new
   edit_post_comment GET    /posts/:post_id/comments/:id/edit(.:format) comments#edit
        post_comment GET    /posts/:post_id/comments/:id(.:format)      comments#show
                     PUT    /posts/:post_id/comments/:id(.:format)      comments#update
                     DELETE /posts/:post_id/comments/:id(.:format)             comments#destroy
               posts GET    /posts(.:format)                            posts#index
                     POST   /posts(.:format)                            posts#create
            new_post GET    /posts/new(.:format)                        posts#new
           edit_post GET    /posts/:id/edit(.:format)                   posts#edit
                post GET    /posts/:id(.:format)                        posts#show
                     PUT    /posts/:id(.:format)                        posts#update
                     DELETE /posts/:id(.:format)                        posts#destroy

   Process finished with exit code 0 
```

**更新：**

以下现在有效。我需要在链接中传递 id 值。

```
<%= link_to 'Edit', edit_post_comment_path(@post.id, c) %>

<%= link_to 'Destroy', [c.post, c], :confirm => 'Are you sure?', :method => :delete %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:44:31.777

试试这个代码生成链接

```
<%= link_to 'test', post_comment_path(@post, c) %> 
```

甚至

```
<%= link_to 'test', [@post, c] %> 
```

# windows - Microsoft Outlook 无法一致地保存文件

> ID：12484395
> 
> 赞同：1
> 
> 时间：2012-09-18T20:22:45.240
> 
> 标签：windows, file, email, unicode, outlook

我正在开发一个 .net 项目并与 Outlook 进行交互。这个想法是用户在他的 Microsoft Outlook 客户端（Outlook 2007 或 Outlook 2010）上收到电子邮件。他选择其中一封电子邮件并保存为 Outlook Unicode 邮件格式 (*.msg)。

然后我拿了这个文件并通过代码读取它。

问题是在某些机器上，文件是用 html 标签保存的，而在其他机器上，相同的电子邮件保存时没有 html 标签，我使用这些标签来识别电子邮件的特定信息。

我一直以为是office或windows版本的问题，但不要，两台机器的office版本相同，windows版本相同，安装的程序相同。

我无法确定两台机器之间的区别。我确定它与unicode格式或其他东西有关。

笔记：

电子邮件格式不能更改（没办法，我已经问过客户了）。

电子邮件中包含表格，我需要的信息在表格中。

我不能做一些不同的事情，所以我需要让客户按照前面的说明保存电子邮件，并且我必须使用我创建的 .net 应用程序来处理电子邮件。

有没有人知道这里可能存在什么问题？我需要确定为什么两台机器具有相同的配置，以不同的格式保存相同的 Outlook 电子邮件。

我验证使用记事本++打开它的电子邮件格式

# javascript - 那里有一个很好的基于 JavaScript 的页面演示库吗？

> ID：12484397
> 
> 赞同：2
> 
> 时间：2012-09-18T20:23:08.167
> 
> 标签：javascript, html

我正在寻找一个 JavaScript 库，它允许用户查看网页的现场演示/演示。

我的设想是在网页上放置某种“演示”按钮。该按钮将启动一个 JavaScript 驱动的页面演示，该演示突出显示页面上的特定元素，淡出其他元素，并显示模式解释框，讨论突出显示的元素。将有前进/后退按钮，可让您在演示中前进。

是否有 JavaScript 库可以做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T21:03:15.410

我想你正在寻找像 Joyride 这样的东西？这是一个 jQuery 插件，可以创建您的实时网站的遍历。 [http://www.zurb.com/playground/jquery-joyride-feature-tour-plugin](http://www.zurb.com/playground/jquery-joyride-feature-tour-plugin)

> 想要带领用户浏览您的应用程序吗？我们有合适的工具。Joyride 为您提供在应用程序或网站中调用新功能所需的一切。

替代方案是：

[http://www.walkme.com/](http://www.walkme.com/)

> WalkMe 使网站所有者和应用程序开发人员能够轻松创建多个交互式屏幕 Walk-Thru，帮助用户快速轻松地完成最复杂的任务。

[https://github.com/jeff-optimizely/Guiders-JS](https://github.com/jeff-optimizely/Guiders-JS)

> Guiders 是一种用户体验设计模式，用于向用户介绍 Web 应用程序。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-18T20:53:08.547

几乎所有的 JS 库*都可以*做到这一点，但您将不得不自己编写代码。您的要求非常具体，所以我怀疑是否有任何预先编写好的东西已经做到了这一点。

# go - 全局模板数据

> ID：12484398
> 
> 赞同：4
> 
> 时间：2012-09-18T20:23:12.800
> 
> 标签：go, go-templates

执行此操作时，`ExecuteTemplate`我看到所有示例都`&whateversruct{Title: "title info", Body: "body info"}`用于将数据发送到模板以替换信息。我想知道是否有可能不必在我的处理函数之外创建一个结构，因为我拥有的每个处理函数都不会有相同的标题、正文。能够向它发送替换模板信息的地图会很好。有什么想法或想法吗？

目前 - 写得松散

```
type Info struct {
    Title string
    Body string
}

func View(w http.ResponseWriter) {
    temp.ExecuteTemplate(w, temp.Name(), &Info{Title: "title", Body: "body"})
} 
```

似乎没有必要创建结构。您创建的每个函数的结构都不相同。所以你必须为每个函数（我知道的）创建一个结构。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-18T23:33:08.177

为了增加凯文的回答：匿名结构将产生几乎相同的行为：

```
func View(w http.ResponseWriter) {
    data := struct {
        Title string
        Body  string
    } {
        "About page",
        "Body info",
    }

    temp.ExecuteTemplate(w, temp.Name(), &data)
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-18T20:33:24.367

该结构只是一个示例。您也可以从外部传入结构，或者您可以按照您的建议使用地图。结构很好，因为结构的类型可以记录模板期望的字段，但这不是必需的。

所有这些都应该起作用：

```
func View(w http.ResponseWriter, info Info) {
    temp.ExecuteTemplate(w, temp.Name(), &info)
} 
```

* * *

```
func View(w http.ResponseWriter, info *Info) {
    temp.ExecuteTemplate(w, temp.Name(), info)
} 
```

* * *

```
func View(w http.ResponseWriter, info map[string]interface{}) {
    temp.ExecuteTemplate(w, temp.Name(), info)
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-10-08T06:10:00.267

将模板应用于结构与地图之间的重要区别：使用地图，您可以在模板中进行地图中不存在的引用；模板将毫无错误地执行，并且引用将为空。如果您针对结构进行处理并引用结构中不存在的内容，则模板执行将返回错误。

引用地图中不存在的项目可能很有用。考虑这个示例 web 应用程序中 views.go 中的 menu.html 和 getPage() 函数：[https](https://bitbucket.org/jzs/sketchground/src) ://bitbucket.org/jzs/sketchground/src 。通过使用菜单地图，活动菜单项很容易突出显示。

这种差异的简单说明：

```
package main

import (
    "fmt"
    "html/template"
    "os"
)

type Inventory struct {
    Material string
    Count    uint
}

func main() {
    // prep the template
    tmpl, err := template.New("test").Parse("{{.Count}} items are made of {{.Material}} - {{.Foo}}\n")
    if err != nil {
        panic(err)
    }

    // map first
    sweaterMap := map[string]string{"Count": "17", "Material": "wool"}
    err = tmpl.Execute(os.Stdout, sweaterMap)
    if err != nil {
        fmt.Println("Error!")
        fmt.Println(err)
    }

    // struct second
    sweaters := Inventory{"wool", 17}
    err = tmpl.Execute(os.Stdout, sweaters)
    if err != nil {
        fmt.Println("Error!")
        fmt.Println(err)
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T20:46:57.847

你是完全正确的凯文！我更喜欢这个。谢谢！！！

```
func View(w http.ResponseWriter) {
    info := make(map[string]string)
    info["Title"] = "About Page"
    info["Body"] = "Body Info"
    temp.ExecuteTemplate(w, temp.Name(), info)
} 
```

# google-app-engine - 在golang中设置图像的不透明度

> ID：12484403
> 
> 赞同：3
> 
> 时间：2012-09-18T20:23:35.607
> 
> 标签：google-app-engine, go

我有以下代码。这确实在背景图像（background.jpg）上粘贴了一个前景图像（logo.jpg） 在粘贴这个前景图像时，我想设置这个前景图像的不透明度。我使用了 DrawMask (http://golang.org/doc/articles/image_draw.html)，但似乎我在这里遗漏了一些东西。请看下面的代码。有人有什么想法吗？

```
package main

    import (
    "os"
    "image/draw"
    "image"
    "image/jpeg"
)

func main() {
//Background image
    fImg1, _ := os.Open("background.jpg")
    defer fImg1.Close()
    img1, _, _ := image.Decode(fImg1)

//Logo to stick over background image
    fImg2, _ := os.Open("logo.jpg")
    defer fImg2.Close()
    img2, _, _ := image.Decode(fImg2)

//Mask image (that is just a solid light gray image of same size as logo)
    fmask, _ := os.Open("mask.jpg")
    defer fImg2.Close()
    mask, _, _ := image.Decode(fmask)

//Create a new blank image m
    m := image.NewRGBA(image.Rect(0, 0, 1920, 1280))

//Paste background image over m
    draw.Draw(m, m.Bounds(), img1, image.Point{0,0}, draw.Src)

//Now paste logo image over m using a mask (ref. http://golang.org/doc/articles/image_draw.html )

//******Goal is to have opacity value 50 of logo image, when we paste it****
    draw.DrawMask(m, m.Bounds(), img2, image.Point{-100,-100}, mask, image.Point{-100,-100}, draw.Src)

     toimg, _ := os.Create("new.jpg")
     defer toimg.Close()

     jpeg.Encode(toimg, m, &jpeg.Options{jpeg.DefaultQuality})
} 
```

Sathish (http://stackoverflow.com/questions/12430874/image-manipulation-in-golang) 帮助了上述代码。谢谢萨蒂什。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T01:12:08.283

我看到您的代码有两个错误。

1.  您设置的掩码不正确。要获得 50% 的不透明度，您需要`mask := image.NewUniform(color.Alpha{128})`128 介于 0（透明）和 255（不透明）之间的位置。如果您想要超过 256 级的不透明度，请参阅`color.Alpha16`。

2.  调用时`draw.DrawMask()`，您很可能希望使用`draw.Over`Op 而不是`draw.Src`. 尝试它们，您应该会看到不同之处。

我也推荐`m := image.NewRGBA(img1.Bounds())`，但手动做也没有错。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T10:07:28.467

由于您希望蒙版基于另一个图像，您可能必须将灰度转换为 alpha 蒙版。下面的代码在我尝试过的示例上运行良好。

```
package main

import (
    "fmt"
    "image"
    "image/color"
    "image/draw"
    "image/jpeg"
    "os"
)

func main() {

    fBg, err := os.Open("bkground.jpg")
    defer fBg.Close()
    bg, _, err := image.Decode(fBg)

    fSrc, err := os.Open("arrow1.jpg")
    defer fSrc.Close()
    src, _, err := image.Decode(fSrc)

    fMaskImg, err := os.Open("mask.jpg")
    defer fMaskImg.Close()
    maskImg, _, err := image.Decode(fMaskImg)

    bounds := src.Bounds() //you have defined that both src and mask are same size, and maskImg is a grayscale of the src image. So we'll use that common size.
    mask := image.NewAlpha(bounds)
    for x := 0; x < bounds.Dx(); x++ {
        for y := 0; y < bounds.Dy(); y++ {
            //get one of r, g, b on the mask image ...
            r, _, _, _ := maskImg.At(x, y).RGBA()
            //... and set it as the alpha value on the mask.  
            mask.SetAlpha(x, y, color.Alpha{uint8(255 - r)}) //Assuming that white is your transparency, subtract it from 255
        }
    }

    m := image.NewRGBA(bounds)
    draw.Draw(m, m.Bounds(), bg, image.ZP, draw.Src)

    draw.DrawMask(m, bounds, src, image.ZP, mask, image.ZP, draw.Over)

    toimg, _ := os.Create("new.jpeg")
    defer toimg.Close()

    err = jpeg.Encode(toimg, m, nil)
    if err != nil {
        fmt.Println("Error: " + err.Error())
    }
} 
```

*   额外说明：在 gimp 中将 jpeg 图像转换为灰度时，我注意到它会自动保存一些图像包无法解码的选项。因此，您可能希望在每次操作后检查错误值。为了减少代码大小，我主要在这里删除了它。

# ruby-on-rails - Rails 条件，如何解决从数组中删除 nils 的问题？

> ID：12484405
> 
> 赞同：2
> 
> 时间：2012-09-18T20:23:36.420
> 
> 标签：ruby-on-rails, ruby, activerecord

对于基本条件（如 find 语句）和更通用的 where 子句，用户可以查找任何一组条件。例如：

```
User.find_by_name(["One", "Two", "Three"])
User.find_by_name_and_age(["One", "Two"],[1,2,3]) 
```

或者

```
User.where(:bonus_id => [1,2,3]) 
```

但是，它们在这里略有不一致。如果你使用

```
User.find_by_bonus_id([nil,1,2]) 
```

正如预期的那样，这将返回奖励 id 为“nil”的使用！但是，“find_by_... *and* ...”格式和“where”格式都不能以这种方式工作。

```
User.where(:bonus_id => [nil,1]) 
```

将仅返回 Bonus_id 为 1 的用户。

```
User.where(:bonus_id => [nil] 
```

将一无所有！

```
User.where(:bonus_id => nil) 
```

但是，工作正常。

据我所知，where 子句（和 find_by_and 方法）会折叠它们的数组，删除任何不真实的值。这对我来说是一个非常重要的问题。

**有谁知道将 nils 包含在 where 子句数组（或解决方法）中的方法，还是我最终必须将多个查询连接在一起才能获得正确的行为？**

> 附加说明：
> - 版本 3.0.11
> - Nils 实际上并没有被删除，而是在某些情况下它比较的是 IN (NULL) 而不是 SQL 中的 IS NULL。我将保持原样，因为即使它不准确，它也是问题在遇到时首先出现的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:46:51.267

我无法在 Rails 3.1.0 上重现您的问题。你用的是什么版本？

试试这个：

```
User.where(["bonus_id IN (?) OR bonus_id IS NULL", [1,2]]) 
```

将返回 bonus_id 为 1、2 或 null 的用户

# django - django formfield_overrides 与 TextField 中的 max_length 冲突

> ID：12484413
> 
> 赞同：3
> 
> 时间：2012-09-18T20:24:01.510
> 
> 标签：django

所以我有一个模型，其中一个字段如下所示：

```
dirlab_cruce = models.CharField(verbose_name='Cruce', max_length=40, null=True, blank=True) 
```

为了能够使所有文本字段的长度相同，我在 admin.py 中执行了此操作：

```
formfield_overrides = {
    models.CharField: {'widget': TextInput(attrs={'size':'100%'})}
} 
```

这使得所有文本字段与表单的宽度相同，但将我可以输入的文本限制为 4 个字符。

评论该`formfield_overrides`块给了我想要的 40 个字符输入，它缩短了字符域。

难道我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T18:13:17.530

我遇到过同样的问题。这是一个 Django 1.4 的错误，所以我刚刚提交了一份报告。这是我提交的票，用一种简单的方法来重新创建错误：

标题：使用 formfield_overrides 设置 CharField 大小会导致所有管理字段使用模型定义中的最后一个 max_length

描述：查看如何使用 max_length 100 和 14 定义标题和 ISBN。对于在更改表单中编辑的用户，覆盖导致两个字段的 max_length 为 14 - 第 15 个字符不能插入到标题字段中。

**模型.py：**

```
from django.db import models

class Book(models.Model):
    title = models.CharField(max_length=100,blank=True, null=True)
    ISBN13 = models.CharField(max_length=14,unique=True)
    def __unicode__(self):
        return self.title 
```

**管理员.py：**

```
from django.contrib import admin
from django.db import models
from django.forms import TextInput
from books.models import Book

class BookAdmin(admin.ModelAdmin):
    formfield_overrides = {
        # Django enforces maximum field length of 14 onto 'title' field when user is editing in the change form
        models.CharField: {'widget': TextInput(attrs={'size':'30'})},
        } 
```

admin.site.register(Book,BookAdmin)

编辑：在我提交错误的 48 小时内，令人惊叹的 Django 社区验证了错误并发布了补丁。我测试并确认此错误已在 2013 年 3 月发布的 Django 1.5 中修复。

[https://code.djangoproject.com/ticket/19423#ticket](https://code.djangoproject.com/ticket/19423#ticket)

# php - PHP str_replace 无法按预期工作

> ID：12484416
> 
> 赞同：1
> 
> 时间：2012-09-18T20:24:07.393
> 
> 标签：php, string, str-replace

我正在尝试使用 str_replace 来更正文件路径，如下所示：

```
$a="F:\xampp\htdocs\yii\get_smart\Music\mix\English\1636464449";  
$a=str_replace('\\','/', $a);  
echo $a; 
```

返回：

```
F:
mpp/htdocs/yii/get_smart/Music/mix/Englishs6464449 
```

有人可以告诉我我做错了什么吗？

我的 PHP 版本是 5.3.8

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-18T20:26:53.453

使用单引号定义 $a

```
$a='F:\xampp\htdocs\yii\get_smart\Music\mix\English\1636464449'; 
```

问题不`str_replace`在于双引号内定义的字符串。反斜杠转义`x`后面的和其他字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T20:27:10.523

发生这种情况是因为您的字符串在双引号中，因此`\x`被解析为字符。

实际上，它试图`\xam`作为一个角色来阅读。文档： http: [//php.net/manual/en/regexp.reference.escape.php](http://php.net/manual/en/regexp.reference.escape.php)

将您的字符串放在单引号中（或在 之前转义斜杠`x`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:28:31.487

您的问题是第一个字符串有一些转义序列。例如 \xam 在 php 中有一个含义。看起来 \16 也可能意味着什么。您应该在执行 str_replace 之前回显 $a 并查看您得到的结果。

# javascript - javascript从头到尾解析/识别正则表达式

> ID：12484422
> 
> 赞同：1
> 
> 时间：2012-09-18T20:24:34.707
> 
> 标签：javascript, parsing

我正在用 javascript 编写一个小的 javascript 解析器。我处于标记化级别。

我想知道如何识别正则表达式何时开始和结束。

例如，如果我问过关于如何识别字符串何时开始和结束的相同问题，答案将是：

对于以双引号开头的字符串“我知道答案是以双引号开头的字符串”并在遇到下一个双引号“时结束（除非前面有反斜杠\）

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:32:12.133

[ECMAScript 语言规范包含](http://bclary.com/2004/11/07/)[附件 A](http://bclary.com/2004/11/07/#annex-a)中语言的完整语法（在 EBNF 中）。它太大了，无法在此处完整复制，但正则表达式的产生式以“RegularExpressionLiteral”的形式给出。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-18T20:29:36.203

*“在 JavaScript 源代码中，正则表达式以/pattern/modifiers*的形式编写，其中“pattern”是正则表达式本身，“modifiers”是表示各种选项的一系列字符。“modifiers”部分是可选的。 " [JavaScript 正则表达式对象](http://www.regular-expressions.info/javascript.html)

# c# - Git 的门控签入/预测试提交？

> ID：12484424
> 
> 赞同：31
> 
> 时间：2012-09-18T20:24:44.267
> 
> 标签：c#, git, tfs, jenkins, teamcity

我正在考虑从 TFS（Team Foundation Server）迁移到 Git，但找不到与 TFS 对门控签入（也称为预测试或延迟提交）的支持相匹配的任何内容。

Atlassian Bamboo 不支持门控签到。TeamCity 确实支持它（使用他们的术语“延迟提交”），但不支持 Git。单独使用 Jenkins 或 Jenkins+Gerrit 有很大的缺点，并且不接近 TFS 中的门控签入功能。（詹金斯的创造者在这个视频中解释了自己的缺点：[http](http://www.youtube.com/watch?v=LvCVw5gnAo0) ://www.youtube.com/watch?v=LvCVw5gnAo0 ）

Git 非常流行（有充分的理由），那么人们是如何解决这个问题的呢？目前最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-18T20:35:59.837

我们刚刚开始使用 git 并使用工作流实现了预测试提交（我今天刚刚完成了测试）。

基本上每个开发人员都有一个个人存储库，他们具有读/写访问权限。在我们的例子中，构建服务器 TeamCity 使用这些个人存储库进行构建，然后如果成功将更改推送到“绿色”存储库。开发人员对“绿色”没有写入权限，只有 TeamCity 构建代理可以写入，但开发人员从“绿色”中提取通用更新。

因此，开发者从“绿色”拉动到个人，TeamCity 从个人构建，推动到绿色。

[这篇博](http://www.joergm.com/2011/05/pre-tested-commits-using-git/)文展示了我们正在使用的基本模型，个人存储库使用 GitHub 分叉（使用分叉意味着存储库的数量不会失控并最终花费更多，这意味着开发人员可以管理个人构建，因为他们可以分叉然后创建团队城市构建工作以将他们的代码推送到“绿色”）：

![在此处输入图像描述](../Images/14ab3710b6575443e50753ba1eb79d49.png)

这是在 TeamCity 中设置的更多工作，因为每个开发人员都必须有自己的构建配置。这实际上必须是 2 个配置，因为 TeamCity 似乎执行所有构建步骤（包括最后的“推动绿色”步骤），即使之前的构建步骤失败（如测试:)），这意味着我们必须有一个个人为开发人员构建，然后是另一个依赖于它的构建配置，假设构建有效，它只会进行推送。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-10-08T06:47:37.373

查看[Verigreen](https://github.com/Verigreen/verigreen) - 一个轻量级的服务器端门控签到系统。它在进入系统保护的分支之前验证每个提交。Verigreen 不允许任何失败的 CI 提交破坏集成、发布或任何需要保护的分支。此外——它是一个免费的开源项目。

工作原理： Verigreen 拦截签入并在临时分支中运行验证 - 这样在提交失败的情况下，只有相关开发人员会受到影响。

*   预接收挂钩拦截并创建代码的临时分支。
*   验证通过 Jenkins 作业运行。验证作业内容是完全可配置的。
*   经过验证的代码被合并回受保护的分支，而失败的提交被阻止并发送给开发人员的通知。

[![在此处输入图像描述](../Images/d07c29ce615d7c7b9613ff7765ba8499.png)](https://i.stack.imgur.com/HLLoG.png)

根据以下流程做出决定：

[![Verigreen - 基本流程](../Images/c9a22542ed5425b45d363a70297b4f8a.png)](https://i.stack.imgur.com/7piif.png)

有关更多信息，请参阅[wiki](https://github.com/Verigreen/verigreen/wiki)或[Verigreen.io](http://verigreen.io/)站点

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-09-17T16:22:01.267

我认为在[2013 年 10 月 23 日](http://blog.jetbrains.com/teamcity/2013/10/automatic-merge/)之后，答案可以是 -[在 TeamCity 中自动合并](http://confluence.jetbrains.com/display/TCD8/Automatic+Merge)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T20:37:45.220

git 有不同的理念——提交很容易，随心所欲地提交。如果有问题，您可以稍后更改。合并很容易。因此，您可以组织适当的工作流程，例如开发人员可以在单独的分支中提交。当一个分支被测试时，它可以被合并到一个主分支中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-22T21:44:44.543

为什么不使用 TFS 作为中央存储库并使用 GIT 作为本地 DVCS 解决方案？

这将允许您在本地构建和提交，然后将您想要的内容推送到 TFS 服务器并进行封闭式构建。

有时，两全其美是件好事……

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-21T13:25:42.890

使用 VS Team Services (fka Visual Studio Online) 和 TFS 2015 或更高版本，您可以使用[需要通过构建](https://msdn.microsoft.com/Library/vs/alm/Code/git/branch-policies#Requirethepullrequesttobuild)的分支策略来作为 Git 的门控签入工作流。

# c# - 视觉 Web 开发人员错误

> ID：12484428
> 
> 赞同：1
> 
> 时间：2012-09-18T20:25:11.210
> 
> 标签：c#, asp.net

这就是我按 F5 时得到的……有什么想法吗？我完全不确定这里出了什么问题。

```
Compilation Error
 Description: An error occurred during the compilation of a resource required to        service this request. Please review the following specific error details and modify your source code appropriately.

 Compiler Error Message: ASPNET: Make sure that the class defined in this code file matches the 'inherits' attribute, and that it extends the correct base class (e.g. Page or UserControl).

Source Error:

Line 9:  
Line 10: 
Line 11: public partial class _Default : System.Web.UI.Page
Line 12: {
Line 13:     protected void Page_Load(object sender, EventArgs e)

 <%@ Page Language="C#"  AutoEventWireup="true" 
     CodeFile="Default.aspx.cs" Inherits="Default" %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:33:16.640

行，`<%@ Page ... Inherits="Default" %>`

不匹配`class _Default`

将第一行更改为`<%@ Page ... Inherits="_Default" %>`

# javafx-2 - 使用 java 6 部署 javafx

> ID：12484430
> 
> 赞同：2
> 
> 时间：2012-09-18T20:25:26.903
> 
> 标签：javafx-2

我只是使用提供的工具打包我的 JavaFX 应用程序。但是当我尝试使用 java 运行它时，`-jar app.jar`我收到一条消息，要求我安装更新的 Java 版本。我`6u33 with`在开发环境中使用 fx 2.2beta 并且运行良好。所以，我的问题是，在 Java 6 下运行所需的配置是什么？

这是我的包命令：

```
\javafx-sdk2.2.0-beta\bin\javafxpackager.exe -createjar -appClass gui.principal.FrmPrincipal -classpath lib\jfxrt.jar;lib\antlr-2.7.7.jar;lib\dom4j-1.6.1.jar;lib\hibernate-commons-annotations-4.0.1.Final.jar;lib\hibernate-core-4.1.4.Final.jar -srcdir classes -outdir dist -outfile Etransporte.jar -V 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T23:52:40.760

好吧，几个小时后，我下载了 JavaFX SDK 的最终版本并将其安装在我的 Java 6u33 SDK 上，此后一切正常。因此，升级是规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:19:45.167

无需使用 beta sdk，使用[生产 sdk](https://stackoverflow.com/questions/12484430/javafx-deployment-using-java-6)。beta sdk 可能存在未解决的 bug，不适合打包应用程序进行一般部署。

只是一些一般信息，我想你可能已经涵盖了大部分内容，但有些东西可能有用。

这是使用 javafxpackager.exe 打包 javafx 应用程序[的示例批处理脚本](http://code.google.com/p/willow-browser/source/browse/package.bat)。您正在运行的命令看起来不错。

确保您的测试机器上的 java 系统和 javafx 安装都是相同的位架构（例如 32 位或 64 位）。此外 jre6+javafx2.2 仅在 Windows 机器上受支持，Linux 或 Mac 不支持。

请注意，如果您的客户端计算机仅安装了 jre 6 而没有安装 JavaFX 运行时，那么当您在该系统上运行打包的应用程序时，预计它将提供一些提示和帮助以允许用户在客户端上安装 JavaFX 运行时.

另请注意，JavaFX 2.2 并非支持所有版本的 jre6，它必须是最新版本的 jre6（2.2 需要 Java SE 6 Update 33）。看来您正在运行正确的最低版本。

# c# - Roslyn 流利的语法为多行 lambda 创建表达式树

> ID：12484441
> 
> 赞同：13
> 
> 时间：2012-09-18T20:26:20.400
> 
> 标签：c#, .net, metaprogramming, expression-trees, roslyn

我正在编写一个基于 Roslyn 的自定义工具，它试图通过在构建时将给定的多行 lambda 重写为表达式树来根除[CS0834 。](http://msdn.microsoft.com/en-us/library/bb397745.aspx)

**编辑**：此时，我只针对匿名多行 lambda。

例如：

```
 // Will produce CS0834 if Bar takes Expression<Action<...>>
    Foo.Bar((int x) => { ... }); 
```

到

```
 Foo.Bar(Expression.Lambda<Action<int>>(
        Expression.Block(
            ...
            ),
        Expression.Parameter(typeof(int)))); 
```

这样就可以正确编译。虽然我可以弄清楚转换给定代码所需的 Expression.(blah) 语法，但使用 Roslyn 进行转换完全是另一回事。也许我只是不太了解 Roslyn Syntax.(blah) API 来翻译这个原始 lambda

```
 (int index, float[] a, float[] b) =>
    {
        var sum = 0f;
        for (int i = 0; i < index; i++)
            sum += a[i];

        b[index] = sum;
    }); 
```

有人可以帮我编写 Roslyn Syntax.(blah) 语法，它会生成一个如下所示的表达式树吗？

```
 Expression<Action<int, float[], float[]>> action = 
        Expression.Lambda(
            Expression.Block(
                Expression.Assign(sumParameter, Expression.Constant(0)),
                Expression.Loop(...) // The for loop here
                )
            ); 
```

一旦我有了一个起点——我应该能够弄清楚或至少开始翻译这个项目中的简单案例。

非常感谢，非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-18T23:02:30.530

我们有[一个名为 Quoter 的工具，它将为任何 C# 程序生成 Syntax.* API 调用](http://blogs.msdn.com/b/kirillosenkov/archive/2012/07/22/roslyn-code-quoter-tool-generating-syntax-tree-api-calls-for-any-c-program.aspx)。

您可以[在 roslynquoter.azurewebsites.net 上实时查看](http://roslynquoter.azurewebsites.net)。

如果您弄清楚生成 Expression.* 调用的逻辑，则可以轻松生成生成它的代码。

更新：该工具现已开源！[https://github.com/KirillOsenkov/RoslynQuoter](https://github.com/KirillOsenkov/RoslynQuoter)

# python - 从 django admin 上传多个 pdf

> ID：12484445
> 
> 赞同：0
> 
> 时间：2012-09-18T20:26:28.433
> 
> 标签：python, django, django-models, django-admin

我正在 django 中创建一个应用程序，我想从 django admin 上传多个文件。我还希望这些文件与我数据库中的特定用户相关联。例如，一个 pdf 文件的文件名是“john.pdf”、“matt.pdf”、“alice.pdf”，我想从 django admin 一次上传所有这些文件，每个文件都应该与特定用户相关联，所以如果用户 john 登录，他可以在他的个人资料页面中看到 pdf 'john.pdf'。我是 django 和 web 编程的新手，几天来我一直在努力，但我找不到正确的逻辑来实现这样的代码。我查看了这些资源，但我仍然无法真正找到答案 [如何在 django admin 模型中上传多个文件](https://stackoverflow.com/questions/4343413/how-to-upload-multiple-file-in-django-admin-models) [如何通过 django admin 上传](https://stackoverflow.com/questions/4301824/how-to-upload-through-django-admin). 我正在使用 django 和 mysql 数据库。我非常感谢并提前感谢任何可以帮助我解决这个问题的人。（希望不要被低估太多）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T05:08:11.140

好的，所以我找到了一个解决方案，但我仍然不知道那是否是最好的解决方案。我所做的是在 MySQL 数据库中添加我的 pdf 文件的路径并向这些路径添加属性。我在 python 中编写了一个脚本来将这些文件添加到 MySQL 数据库中。我的脚本列出了存储文件的目录中的所有文件并将它们添加到数据库中。从这些属性中，我可以检索这些路径。由于这些只是静态文件的路径，我必须将它们保存在静态文件夹中，以便 django 访问和显示它们，其余的很简单。

# c# - 在多行文本框中显示日志文件

> ID：12484455
> 
> 赞同：0
> 
> 时间：2012-09-18T20:27:09.710
> 
> 标签：c#, .net, winforms, logging, textbox

我正在将数据写入日志文件，并且需要在我的 WinForms UI 中显示该数据。我最初的想法是使用这样的多行文本框：

```
private void UpdateUITextbox(string text)
{
    textBoxStatus.AppendText(text + Environment.NewLine);
} 
```

我不会在我的日志文件中写入大量文本，但随着时间的推移，它会加起来，我最终可能会超过多行文本框的默认最大长度。为了防止这种情况发生，我唯一能想到的就是挂接到 OnKeyPress 事件处理程序中，并在向其添加内容之前检查文本框的长度，并在必要时删除旧文本以腾出空间较新的文本。但这似乎肯定会对性能产生影响。有人请告诉我有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:41:39.327

Winforms TextBox 的[最大长度为 2GB](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.maxlength.aspx)。

在您担心内存问题之前，您将不得不担心可用性问题——如果日志太长，您的用户将无法有效地使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:42:15.703

[我们使用AvalonEdit](https://github.com/icsharpcode/SharpDevelop/wiki/AvalonEdit)显示我们的日志。它可以很好地扩展到数十万行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:23:32.977

为什么不使用列表框而不是多行文本框？
对于日志，最好在日志中添加更多信息，同时节省时间等信息。
并在加载时读取具有您认为最近的范围内的日期戳的每一行。一次加载所有日志文件是不明智的。只加载新的。
如果您需要查看较旧的日志，您仍然可以使用时间/日期戳解决方案进行管理。

# c# - 如何访问字典中唯一的 KeyValuePair？

> ID：12484458
> 
> 赞同：1
> 
> 时间：2012-09-18T20:27:10.100
> 
> 标签：c#, winforms, dictionary, key-value

我有一个从数据库中填充的字典。

如果只返回一条记录，如何访问 KeyValuePair？

我有这个代码：

```
Dictionary<int, string> CandidatePlatypiDict = PlatypusID > 0 ? DuckbillData.GetPlatypusById(PlatypusID) :  DuckbillData.GetCandidatePlatypiFromName(SearchVal);
KeyValuePair<int, String> kvp; 
```

...填充字典就好了。当有多个 KVP 时，我将它们显示在 DGV 中，然后以这种方式分配给 kvp：

```
DataGridViewRow selectedRow = dataGridViewPlatypi.Rows[selectedrowindex];
int i = Convert.ToInt32(selectedRow.Cells["DuckBillAccountNum"].Value);
string s = Convert.ToString(selectedRow.Cells["DuckBillName"].Value);
this.PlatypiKVP = new KeyValuePair<int, string>(i, s); 
```

...但如果只有一条记录，我不需要在 DGV 中显示值，因为没有真正的选择可供选择 - 我只会使用那个。但到目前为止，我对如何分配我需要的值 kvp.Key 和 kvp.Value 持空白：

```
if (CandidatePlatypiDict.Count == 1)
{
    //kvp.Key = CandidatePlatypiDict[0].     strike 1
    //kvp.Key = CandidatePlatypiDict.Keys[0] strike 2
    // ???
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:30:05.387

您可以使用`First()`或`Single()`根据您的需要。例如：

```
if (CandidatePlatypiDict.Count == 1)
{
    var firstPair = CandidatePlayDict.First();

    // can then access firstPair.Key and firstPair.Value
    ...
} 
```

`Single()`和之间有很多味道`First()`，这取决于你想要什么。

即使*可能*存在多个，也只抓取第一个项目：

*   `First()`- 即使存在很多也先抓取，如果没有则抛出。
*   `FirstOrDefault()`- 不会抛出，首先返回，如果没有则默认。

为了确保最多存在一个：

*   `Single()`- 确保只有一个条目，如果不完全是一个则抛出。
*   `SingleOrDefault()`*-最多*确保一个，如果没有则返回默认值，如果更多则抛出。

所以我会选择最能满足您需求的一款。从您的问题陈述中，我建议的是，由于似乎有一个空字典是一个非常常见的可能结果，请检查第`Count`一个（就像您正在做的那样）然后调用`First()`.

这开销要少得多，因为这样您就不必担心异常开销（并且`Count`是 O(1) 操作）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T20:30:15.217

如果您期望只使用一件物品`Single()`

```
Dictionary<int, string> CandidatePlatypiDict = PlatypusID > 0 ? DuckbillData.GetPlatypusById(PlatypusID) :  DuckbillData.GetCandidatePlatypiFromName(SearchVal);
KeyValuePair<int, String> kvp = CandidatePlatypiDict.Single(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T20:30:34.263

您可以使用`Linq`和使用`FirstOrDefault`

```
CandidatePlatypiDict.FirstOrDefault(); 
```

# php - PHP strtotime 错误？

> ID：12484470
> 
> 赞同：0
> 
> 时间：2012-09-18T20:27:52.390
> 
> 标签：php

看看这段代码，请告诉我这怎么可能在星期三完美运行，但在星期二却不行：

```
 <?php
$current_time = strtotime('now');
if ($current_time > strtotime('tuesday this week 8:45pm') && $current_time < strtotime('tuesday this week 11:45pm')) {
 $background = 1;
}
if ($current_time > strtotime('wednesday this week 8:45pm') && $current_time < strtotime('wednesday this week 11:45pm')) {
 $background = 1;
}
else{
$background = 0;
}

?>

   <script>
   var backday = <?php echo json_encode($background); ?>;
   </script> 
```

对于星期二，它返回 0，但对于星期三，它应该返回 1。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:35:40.433

你的逻辑有错误。第一个条件可能会返回 1，但随后您会遇到第二个条件。如果第二个条件中的第一个 if 为假，它将在 else 块中将变量设置为 0，而不管它在第一个条件中设置为什么。您需要将第二个 if 语句设置为 else if，如下所示：

```
 if ($current_time > strtotime('tuesday this week 8:45pm') && $current_time <   strtotime('tuesday this week 11:45pm')) {
    $background = 1;
}
else if ($current_time > strtotime('wednesday this week 8:45pm') && $current_time < strtotime('wednesday this week 11:45pm')) {
   $background = 1;
}
else{
   $background = 0;
} 
```

# mysql - sql查询不适用于concat

> ID：12484473
> 
> 赞同：0
> 
> 时间：2012-09-18T20:28:09.280
> 
> 标签：mysql

我正在研究一个搜索系统，在该系统中，一个人按国家及其名字和姓氏进行搜索。对于我使用的名字和姓氏，`concat`但在进一步和条件下使用它似乎不起作用。我的查询是

```
select * from users_profile where CONCAT(fname,' ',lname) like '%v %'
or Email like '%v %' AND country='india' 
```

在上面，如果 ise 使用不带“and”的查询，它就可以工作。但我需要指定更多条件，如果我只是使用并且不使用`concat`它也可以。

```
select * from users_profile where CONCAT(fname,' ',lname) like '%v %'
or Email like '%v %' 
```

如何使它适用于两者`concat` 以及`and condition`我想进一步申请。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:32:03.450

您不应该使用`CONCAT`，更不用说`WHERE`列周围的任何功能了。此外，您应该指定一个列列表，而不是`SELECT *`. 还要检查您的标准顺序。

你可以尝试这样的事情：

```
SELECT fullname, Email, country
FROM
    (SELECT CONCAT(fname, ' ', lname) AS fullname, Email, country FROM users_profile) a
WHERE (a.fullname LIKE '%v %' OR Email LIKE '%v ') AND country = 'india' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:32:24.160

AND 的优先级高于 OR，因此您需要对语句进行更合乎逻辑的分组。

就像是：

```
select * from users_profile where (CONCAT(fname,' ',lname) like '%v %'
or Email like '%v %') AND country='india' 
```

应该管用。

# javascript - div左侧不需要的滚动条？

> ID：12484475
> 
> 赞同：1
> 
> 时间：2012-09-18T20:28:13.613
> 
> 标签：javascript, css, google-closure-library

由于某种原因，此页面内#mainView div 的左侧有一个滚动条。我真的不明白为什么。这个问题似乎发生在几乎所有的浏览器中。一旦触发右侧的滚动条，左侧的滚动条就会消失。

[网站](http://www.niuzly.com/p/5053df08ea39d36930000001/2012-9-17)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:40:11.197

在`#mainView`加载内容之前，它`width`是 null 并且它的`overflow`属性设置为`scroll`。`div`因此，在等待内容加载时，您有一个 20px 宽的单独滚动条。

您可以选择宽度，也可以`#mainView`尝试`overflow: auto`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:56:45.697

简单来说，当您将 div 设置为 css 属性值以溢出浏览器时，默认情况下会显示滚动窗格。但是如果您仍然希望在填充 div 时具有溢出内容的相同效果，请使用 css 属性溢出：汽车

# asp.net-mvc - @Html.ActionLink() 产生意外结果

> ID：12484480
> 
> 赞同：0
> 
> 时间：2012-09-18T20:28:38.383
> 
> 标签：asp.net-mvc, razor, actionlink

我被一个似乎很奇怪的问题难住了。

在我的 Razor 标记中，我有：

```
@Html.ActionLink("World", "Browse", "Destination") 
```

但生成的 HTML 是：

```
<a href="/Destination/Browse/1/africa-middle-east">World</a> 
```

请注意，附加数据实际上是我在其他链接中使用的有效数据。但它为什么会出现在这里？我什至可以通过在调试器中检查它来验证第一行是否生成了第二行。

我知道我在这里做了一些非常愚蠢的事情。我只是不明白它是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:36:15.673

我想，它正在使用旧的路由值来构建 a 标签。检查[这篇](http://www.iwantmymvc.com/2011-03-03-actionlink-adding-extra-parameters)文章是否有类似的情况。

使用[这个](http://msdn.microsoft.com/en-us/library/dd493066%28v=vs.108%29.aspx)重载并尝试将 null 作为 RouteValues 显式传递，看看它带来了什么变化

```
public static MvcHtmlString ActionLink(
    this HtmlHelper htmlHelper,
    string linkText,
    string actionName,
    RouteValueDictionary routeValues
) 
```

所以你的代码可以重写为

```
@Html.ActionLink("World", "Browse", "Destination",null) 
```

或者，您也可以尝试使用此版本

```
<a href="Url.Action("Browser", "Destination")">World</a> 
```

# jquery - Jquery确定加载是否花费了比设定时间更长的时间

> ID：12484489
> 
> 赞同：2
> 
> 时间：2012-09-18T20:29:21.073
> 
> 标签：jquery, load

我在来自外部页面的内容中进行 AJAXing。大多数时候加载时间不到一秒，但是如果说加载时间超过 3 秒，有没有办法可以淡入一个 div（比如说一个预加载 div）？所以像这样的事情......

```
$targetPoint.load($dataImportURL + " " +$rawCollectionPoint,function(){
    if (($(this).load >= 3))
    {
        alert ("Its taken more than 3 seconds to load");
    }                       
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T20:34:14.177

看看 JavaScript 的 setTimeout 函数。

当你发送你的ajax调用时......

```
var timeout = setTimeout(function(){
    alert ("Its taken more than 3 seconds to load");
}, 3000); 
```

并且当 ajax 调用完成时取消超时触发器。

```
clearTimeout(timeout); 
```

编辑：您可能必须使用 jQuery 中的[.ajax()](http://api.jquery.com/jQuery.ajax/)函数，以便您可以利用 beforeSend 和 success 回调

像这样的东西...

```
var timeout;
$.ajax({
   url: $dataImportURL + " " +$rawCollectionPoint
   beforeSend: function(){
       timeout = setTimeout(function(){
        alert ("Its taken more than 3 seconds to load");
    }, 3000);
   }
   success: function(data){
       clearTimeout(timeout);
       $targetPoint.html(data);
   }

}); 
```

# python - 我应该在 Google App Engine 中围绕读取或 CPU 时间进行优化吗

> ID：12484497
> 
> 赞同：2
> 
> 时间：2012-09-18T20:29:54.527
> 
> 标签：python, algorithm, google-app-engine

我正在尝试优化我的设计，但很难正确看待事物。假设我有以下情况：

A. 一个用户有 1,000 个状态更新。这些更新存储在单独的实体状态中。我想获取在日期 X 之后具有 uploadDate 的用户状态。所以我进行了查询：

`statuses = Statuses.query(Statuses.uploadDate > X).fetch()`

B. 一个用户有 1,000 个状态更新。每个用户实体都有一个列表属性`list_of_status_keys`，它是用户状态的所有键的列表。我想在日期 X 之后使用 uploadDate 获取所有状态。所以我很容易使用`statuses = ndb.get_multi(list_of_status_keys)`. 然后我遍历每一个，检查日期：

```
for a_status in statuses:
  if a_status.uploadDate > X:
     myList.append(a_status) 
```

我真的不知道我应该优化哪个。查询看起来更有条理，但通过键获取更快。任何人有任何见解？

# 更新

归结为：在对 GAE 的每个 http 请求中，我都会获得用户的所有通知和状态更新（就像 facebook 一样）。使用 Appstats，它告诉我每个请求花费 490 小便士（其中 1 便士 = 1,000,000 小便士）。

获取通知和状态对用户来说很重要，因此您可以期望他们多次这样做。我很难确定这是否很多。我吓坏了，试图以任何可能的方式最小化这个数字。我以前从未运行过服务，所以我不知道这是否应该花费多少。这是数学：

当没有返回结果时，每个请求花费 490 微便士（因此仅对于基本查询，它花费 490，但在某些情况下，当返回多个结果时，它可能花费 10,000 mp），因此对于 1 便士，我可以运行 2040 个请求，或者1 美元，我可以运行 204,000 个请求。

假设我有 50,000 个用户，每个用户每天检查 75 次通知（合理）：

`75 requests X 490 mp per request X 50,000 users = 1,837,500,000 micropennies per day = 1837.5 pennies = 18.37 dollars per day.`（是对的吗？）

我以前从未运行过大规模的服务，那么这些通常的成本是多少？还是这太高了？每个请求 490 小便士是否高？如果取决于情况，我将如何找到答案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:00:41.853

设计 A 更胜一筹。

在设计中，GAE 将使用日期来执行键控查询。这意味着，Appengine 将自动为您在按日期排序的状态表上创建索引。由于它有一个索引，它只会读取和获取您指定日期之后的记录。这将为您节省大量读取。

在设计 B 中，您基本上必须自己完成索引工作。由于您需要获取每个状态然后比较其日期，您将不得不做更多的工作，无论是在 CPU（成本）方面还是在性能方面。

**编辑**

如果您的数据被如此频繁地访问，您可能还有其他设计选项。

首先，您可以考虑将 Status 对象组合到 StatusUpdatesPerDay 中。您每天创建一个实例，然后将状态更新附加到该对象。这会将数百次读取减少为几次读取。

其次，由于状态更新会被非常频繁地访问，因此可以将状态缓存在 memcache 中。这将降低成本和延迟。

第三，即使你没有像上面那样优化，我相信ndb已经内置了缓存。我从未使用过此功能，但您的实际读取计数可能低于您的计算。

第四个选项是避免一次显示所有状态更新。也许用户只想看到最后几个。然后，您可以使用查询游标在（如果）用户请求它们时获取余数。

# mysql - 这个mysql索引中字段名后面的数字是什么意思？

> ID：12484502
> 
> 赞同：2
> 
> 时间：2012-09-18T20:30:32.107
> 
> 标签：mysql, phpmyadmin

我们正在查看 mySQL 中几个表的索引，并注意到了一些东西。有几个索引包含该`type`字段，但其中一些在字段名称后的括号中带有一个数字，而另一些则没有。

![在此处输入图像描述](../Images/dd599d64f0685585776bf355a5a5801e.png)

例如，keyname 的索引`node_status_type`包含`type`在字段列表中，但没有编号。`node_title_type`，另一方面，包括`type (4)`。是什么`(4)`意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T20:34:25.060

这意味着它正在索引`(X)`字段中的第一个字符/字节数。

在前 X 个字符/字节内的数据是唯一的（或可区分的）的任何情况下，使用列索引前缀实际上是一种很好的做法。它可以减小索引大小。

查看文档以获取有关不同字段数据类型的前缀索引使用的更多信息。

[文档](http://dev.mysql.com/doc/refman/5.5/en/create-index.html)

# java - 如何提高使用 JDBC 导入数据库的性能？

> ID：12484504
> 
> 赞同：0
> 
> 时间：2012-09-18T20:30:38.637
> 
> 标签：java, jakarta-ee, jdbc

我正在将大量数据从 CSV 文件导入 MSSQL Server 2008。我正在使用核心 JDBC（没有任何 ORM 框架）并使用 Microsoft 提供的驱动程序“sqljdbc4.jar”与数据库通信。

以下是我的要求：

1.  按顺序解析 CSV 文件。
2.  根据业务需求验证记录。（如果记录无效，则将错误记录在错误文件中的每条记录中。）
3.  将未发现无效的记录导入数据库。（如果记录无效，则针对错误文件中的每条记录记录错误。）
4.  保存两个结果文件成功和错误。成功将具有相同数量的具有良好记录的字段。错误文件将有一个带有错误的附加字段“错误”（从验证/导入面记录）。

截至目前，我正在一一导入记录。即使使用的是 PreparedStatement，这也需要相当多的时间。

我没有使用批量导入，因为我需要将确切的错误记录到错误文件中。

请提出任何在不牺牲准确错误记录的情况下提高性能的想法。我被迫在没有任何 ORM 工具的情况下这样做。

这是示例代码：

```
for (Map<String, String> csvRecord : csvAsList) {
    // Prepare category object using csvRecord.
    // invoke obj.insert(category);
}

public Category insert(Category category){

if (category == null) {
   return null;
}

String SQL = "INSERT INTO t1(c1,c2) VALUES(?,?)";
PreparedStatement pstmt = null;
ResultSet rs = null;

try {

   pstmt = this.dbConnectionUtil.getConnection().prepareStatement(SQL,
           Statement.RETURN_GENERATED_KEYS);

   pstmt.setInt(1, category.getField1());
   pstmt.setString(2, category.getField2());

   int result = pstmt.executeUpdate();

   if (result < 1) {
      return null;
   }

   rs = pstmt.getGeneratedKeys();
   if (rs.next()) {
      category.setId(rs.getInt(1));
   }

} finally {
   if (rs != null)
      rs.close();
   if (pstmt != null)
      pstmt.close();
   this.dbConnectionUtil.closeConnection();
}

return category;

} 
```

2012 年 9 月 20 日更新。

我已经修改了代码，以便导入一个 CSV 文件，只会创建一个 PreparedStatement 对象。新代码如下：

```
public void importCSV(){
   // Create a db connection if its null or closed.
   // Create PreparedStatement objects for selects and inserts if null or closed.

   for (Map<String, String> csvRecord : csvAsList) {
      // Prepare category object using csvRecord.
      // Check whether category exists in by.
      // Import files can have up to 1,00,000 records so tracking errors is critical.
      try{
         categoryDAO.findByName(categoryName,<PreparedStatement object>);
      }
      catch(Exception exp){
         // log this to error.csv file
      }
      // If its a new category import it to the db.
      try{   
         categoryDAO.insert(category,<PreparedStatement object>);
      }
      catch(Exception exp){
         // log this to error.csv file
      }
   }

   // Close PreparedStatement objects
   // Close DB Connection

}

public Category insert(Category category,PreparedStatement pstmt ) throws SQLException{

if (category == null) {
   return null;
}

ResultSet rs = null;
try {

   pstmt.setInt(1, category.getField1());
   pstmt.setString(2, category.getField2());

   int result = pstmt.executeUpdate();

   if (result < 1) {
      return null;
   }

   rs = pstmt.getGeneratedKeys();
   if (rs.next()) {
      category.setId(rs.getInt(1));
   }

} finally {
   if (rs != null)
      rs.close();
}
return category;

} 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:43:48.040

看起来您正在`prepareStatement`为输入数据的每一行再次调用。这几乎可以消除使用`PreparedStatement`. 相反，`PreparedStatement`在循环外部创建，在循环内部只保留`setInt`,`setString`和`executeUpdate`调用。

# git - 项目 + 每个开发人员的 nbactions.xml？

> ID：12484505
> 
> 赞同：5
> 
> 时间：2012-09-18T20:30:47.700
> 
> 标签：git, maven, netbeans, maven-3, netbeans-7

我正在尝试为一个由八九名开发人员组成的团队简化开发过程。作为其中的一部分，我将我们的项目转移到 git 和 Maven。

我们的项目使用一些自定义的 Maven 目标来支持我们的 git 工作流。在我们的主要开发平台 NetBeans 中，我可以配置这些自定义目标，通过项目上下文菜单下的“自定义”子菜单触发，这对于来来往往的本科研究人员来说非常友好和理想。项目。

我已经省略`nbactions.xml`了，而且很`.gitignore`高兴，这意味着每当新开发人员下载代码并使用 NetBeans 打开 Maven 项目时，他们都会免费获得自定义操作（这需要一些可怕的配置）。

不幸的是，当开发人员配置他们的运行/调试设置并运行我们的项目时，他们的运行/调试/配置文件操作*也*被添加到 nbactions.xml 中，然后被提交，并在他们下一次下载代码时使用其他所有人的私人工作流程。

有没有办法将“自定义”子菜单中可用的操作（或用于触发特定 Maven 目标的一些相当简单的机制）与运行/调试配置分开，这样一个可以被版本控制而另一个被忽略？

“坚持每个人都使用相对路径”并不是一个很好的开始答案，但它特别不适合我们的目的，人们经常不得不将他们的 VM 工作目录指向他们根据自己的方案保留的不同任意目录.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T16:47:35.223

经过相当多的研究，似乎没有办法完全按照我的意愿去做。看这里：

[http://netbeans.org/bugzilla/show_bug.cgi?id=162764](http://netbeans.org/bugzilla/show_bug.cgi?id=162764)

> 如果 nbactions.xml 和 nb-configuration.xml 的行为方式与父 POM 相同，那将很有帮助：如果我在父项目中有一个 nbaction.xml，那么所有操作都会被继承。

这基本上是我想要的——“继承”项目自定义操作的每个开发人员的自定义操作。响应：

> 应该是不实用...

并且工单被设置为 Resolved/WontFix。

* * *

所以，目前，这是我的下一个最好的事情：

NetBeans 允许运行/调试/配置文件以及所有自定义操作可以独立定义的不同执行配置文件。每个配置文件都存储在一个单独的`nbactions-XXX.xml`中，其中`XXX`是配置文件的名称。所以，我可以`nbactions-*.xml`输入`.gitignore`，但例外`nbactions-GroupGlobals.xml`.

这不太理想——使用我的自定义目标之一意味着右键单击项目，进入 Profiles 菜单，选择 GroupGlobals Profile，再次右键单击项目，进入自定义目标，运行我的目标，对 -再次单击项目，转到 Profiles，然后选择默认进程。

不过，我怀疑对于我的一些开发人员来说，它不会像命令行那么可怕。

不过，我仍在寻找更好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:05:21.523

在 IntelliJ IDEA 中，您可以从列表中运行任何 ant 目标或 maven 目标（甚至为其分配按键）。我很确定 Netbeans 中有类似的东西。因此，您可以将其作为 ant/maven 配置来使用，而不是使用特定于 netbeans 的东西。当然，这些目标不应该需要任何参数/调整/等。您可以将本地设置分成一个单独的文件（包含在主 ant 脚本或 settings.xml 或 OS env 或其他文件中）。

# google-app-engine - 在 webapp2 上自动设置 App Engine Remote API

> ID：12484506
> 
> 赞同：1
> 
> 时间：2012-09-18T20:30:48.763
> 
> 标签：google-app-engine, python-2.7, remoteapi

在 Python 2.7 上为 AppEngine 配置 remote_api，我需要设置配置调用来创建和配置数据库调用存根，这样我就不必在每个 REST 资源和处理程序中复制配置调用。我想要的代码与此类似：

```
def configure_remote_api():
    try:
        from google.appengine.ext.remote_api import remote_api_stub
        remote_api_stub.ConfigureRemoteApi(None, '/_ah/remote_api', auth_func, 'myapp.appspot.com')
    except ImportError:
        pass 
```

我想要的是设置它，以便它被模块化调用，并且不必在整个应用程序代码中复制，甚至`configure_remote_api()`. 这样，我们可以保持我们的代码库干净，并在本地开发时自动使用 remote_api。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:56:10.427

也许您可以将调用放在 appengine_config.py 中。这通常会很早就加载。（但请检查。）

# android - Android：HttpClient 远程与本地服务器

> ID：12484513
> 
> 赞同：0
> 
> 时间：2012-09-18T20:31:11.930
> 
> 标签：android, httpclient

我在连接到远程 Web 服务器、针对数据库运行 php 脚本时遇到问题。但是，当我将同一个应用程序指向我的机器上运行的本地 Web 服务器时，事情就不起作用了。

这是我用于连接到远程 Web 服务器的代码（它需要身份验证）：

（所有网络代码都在 AsyncTask 类中完成。）

```
HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost(url);
StringBuilder authentication = new   
    StringBuilder().append("frankh").append(":").append("vriceI29");
result = Base64.encodeBytes(authentication.toString().getBytes());
httppost.setHeader("Authorization", "Basic " + result);
nameValuePairs.add(new BasicNameValuePair("date", date));
httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
HttpResponse response = httpclient.execute(httppost);
HttpEntity entity = response.getEntity();
is = entity.getContent(); 
```

对于到不使用身份验证的本地服务器的连接，我将注释掉这些行：

```
//StringBuilder authentication = new   
//    StringBuilder().append("frankh").append(":").append("vriceI29");
//result = Base64.encodeBytes(authentication.toString().getBytes());
//httppost.setHeader("Authorization", "Basic " + result); 
```

但是，我得到两个不同的错误，这取决于我如何将 url 表达到本地 Web 服务器。

如果我使用这个网址：“http://localhost.shoppinglistapp/fetchlist.php”

我收到此错误：

```
Error in http connectionjava.net.UnknownHostException: localhost.shoppinglistapp 
```

如果我跳过 url 中的 http 部分，我会收到以下错误：

```
Error in http connectionjava.lang.IllegalStateException: Target host must not be null,
or set in parameters. 
```

我在这里做错了什么？远程服务器是 Linux Apache 服务器，本地服务器是 IIS 7。本地服务器应该只是在我没有或没有互联网连接时工作，所以这并不重要，但我讨厌不知道为什么事情不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:33:06.693

如果您通过本地模拟器进行测试，您将需要使用 10.0.2.2 而不是 'localhost'。

[从模拟环境中引用 localhost](http://developer.android.com/guide/faq/commontasks.html#localhostalias)

# cordova - iOS OpenAllWhitelistURLsInWebView 和 iFrame

> ID：12484514
> 
> 赞同：1
> 
> 时间：2012-09-18T20:31:17.920
> 
> 标签：cordova, iframe, window.location

所以这是一个奇怪的困境。

我正在使用 zRSSFeed 将 RSS 提要引入 iOS 应用程序。我将 OpenAllWhitelistURLsInWebView 设置为 NO 并链接到 _blank ，一切正常。我还添加了一个带有 window.location.reload(); 的刷新导航按钮；用于 RSS 页面，以防用户离线且不显示任何内容。

我在一个单独的页面上添加了一个 iFrame 来显示我们网站的一些 Web 内容。也很好用。但是现在当我点击刷新按钮时，iFrame 打开了。如果我将 OpenAllWhitelistURLsInWebView 设置为“是”，“刷新”按钮会再次起作用，但 RSS 链接会在应用程序中打开，我无法返回应用程序。

有没有搞错？

我不确定要输入什么代码来帮助解决这个问题。

```
plugins.tabBar.createItem(
"page3",
"some name",
"some.png",{
onSelect: function() {
$.mobile.changePage("#page3", {transition: "slide", reverse: false});
plugins.navigationBar.setTitle("some name");
plugins.navigationBar.setupLeftButton(null,"someother.png", function() {
window.location.reload();
})
plugins.navigationBar.hideRightButton();
selectedTabBarItem = "page3";
}
}) 
```

# c# - 使用 C# 读取创建的文件的最后修改时间戳

> ID：12484515
> 
> 赞同：8
> 
> 时间：2012-09-18T20:31:23.757
> 
> 标签：c#, file-handling

> **可能重复：**
> [如何从 C# 中的文件中获取修改日期](https://stackoverflow.com/questions/1185378/how-to-get-modified-date-from-file-in-c-sharp)

您如何使用 C# 读取文件的创建/上次修改时间戳？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-18T20:33:32.117

来自：[http ://www.csharp-examples.net/file-creation-modification-time/](http://www.csharp-examples.net/file-creation-modification-time/)

```
// local times
DateTime creationTime = File.GetCreationTime(@"c:\file.txt");
DateTime lastWriteTime = File.GetLastWriteTime(@"c:\file.txt");
DateTime lastAccessTime = File.GetLastAccessTime(@"c:\file.txt");

// UTC times
DateTime creationTimeUtc = File.GetCreationTimeUtc(@"c:\file.txt");
DateTime lastWriteTimeUtc = File.GetLastWriteTimeUtc(@"c:\file.txt");
DateTime lastAccessTimeUtc = File.GetLastAccessTimeUtc(@"c:\file.txt");

// write file last modification time (local / UTC)
Console.WriteLine(lastWriteTime);     // 9/30/2007 2:16:04 PM
Console.WriteLine(lastWriteTimeUtc);  // 9/30/2007 6:16:04 PM 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T20:34:42.600

请参阅[System.IO.FileInfo](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx)。

```
 var info = new FileInfo(@"C:\thefile.txt");    
   var created = info.CreationTime;    
   var modified = info.LastWriteTime; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-18T20:38:17.703

```
using System;
using System.IO;

namespace getLastTimeStamp
{
    class Program
    {
        static void Main(string[] args)
        {
            FileInfo info = new FileInfo(@"C:\temp\getLastTimeStamp\Program.cs");

            Console.WriteLine(info.CreationTime.ToString());
            Console.WriteLine(info.LastWriteTime.ToString());

            Console.ReadLine();
        }
    }
} 
```

# java - 登录部署为 WAR 的 Web 应用程序

> ID：12484519
> 
> 赞同：0
> 
> 时间：2012-09-18T20:31:46.033
> 
> 标签：java, logging, war

我正在编写一个`Java`打包为的 Web Web 应用程序`war`，我想添加日志记录并指定日志文件夹以将日志文件写入（使用配置文件，例如`logback.xml`）

显然，我不想配置文件夹的绝对路径。现在我想知道如何在`war`. 对此有哪些最佳实践和推荐方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:23:33.357

我们过去使用相对路径，`logback.xml`但更改为使用 env 属性。当路径是相对路径时，由于 Java EE 服务器实现不同，我们永远无法准确地告诉客户日志文件在哪里。使用带有 env 变量的绝对路径会更容易。例如

```
<file>${user.dir}/logs/my_web_app.log</file> 
```

# sas - 为什么 PROC UNIVARIATE NOPRINT PLOTS 不显示输出？

> ID：12484524
> 
> 赞同：3
> 
> 时间：2012-09-18T20:32:00.930
> 
> 标签：sas

我有一个简单的数据集，我想使用茎叶图/箱线图进行分析，但我只想要文本图，而不是输出表。这是数据步骤：

```
DATA CLINIC;
   INPUT ID     $ 1-3
         GENDER $   4
         RACE   $   5
         HR       6-8
         SBP      9-11
         DBP     12-14
         N_PROC  15-16;
   AVE_BP = DBP + (SBP - DBP)/3;
DATALINES;
001MW08013008010
002FW08811007205
003MB05018810002
004FB   10806801
005MW06812208204
006FB101   07404
007FW07810406603
008MW04811207006
009FB07719011009
010FB06616410610
; 
```

我正在使用`proc univariate`，但我想只抑制表格的输出，而不是图本身。使用该`noprint`语句，所有输出都被抑制：

```
proc univariate noprint;
var SBP DBP; 
```

仅使用该`plots`选项，不会抑制任何输出，因此会显示绘图和表格。

```
proc univariate plots;
    var SBP DBP; 
```

显然，同时指定两者也不起作用。

```
proc univariate plots noprint;
    var SBP DBP; 
```

有没有办法只压制表格，而不是地块本身？

更新：我将建议的代码放入我的完整代码示例中，表格和图表仍然显示。这是完整的代码示例，在与之前代码不同的机器上运行新的 SAS 会话（两台机器都使用 SAS 9.3）。

```
PROC DATASETS LIBRARY=WORK;
DELETE clinic;

DATA clinic;
INPUT @1 ID $ 3\. @4 GENDER $ 1\. @5 RACE $ 1.
      @6 HR 3\. @9 SBP 3\. @12 DBP 3\. @15 N_PROC 2.;

AVE_BP = DBP + (SBP - DBP) / 3;

DATALINES;
001MW08013008010
002FW08811007205
003MB05018810002
004FB   10806801
005MW06812208204
006FB101   07404
007FW07810406603
008MW04811207006
009FB07719011009
010FB06616410610
;

PROC MEANS DATA=clinic N MEAN STD CLM MEDIAN;
TITLE "Means";
VAR SBP DBP AVE_BP;

ODS TRACE ON;
ODS SELECT Plots;
PROC UNIVARIATE DATA=clinic PLOTS;
TITLE "Plots";
VAR SBP DBP;
RUN;
ODS TRACE OFF;
ODS SELECT ALL; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T20:58:26.427

从版本 8 开始，当输出交付系统 (ODS) 被添加到 SAS 时，我就非常喜欢它。

1.  使用`ods trace on;`+ 原始代码（proc 单变量...此处）来确定（从 LOG）它产生什么输出（在结果树中也可见）。
2.  然后使用`ods select ...;`来让你选择。
3.  用于`ods select all;`重置。

> ```
> ods trace on;
> ods select Plots;
> proc univariate plots;
> var SBP DBP;
> run;
> ods trace off; 
> ```

ODS 远不止于此，当然值得研究 - 搜索 ODS 用户指南。

# gnuplot - 如何从一个点绘制水平线

> ID：12484527
> 
> 赞同：0
> 
> 时间：2012-09-18T20:32:03.580
> 
> 标签：gnuplot

我有一个包含单列和一些条目的数据集（一个文件）。我希望为每个条目绘制一条水平线，其中每个条目是该线的 y 轴值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:21:16.913

你试图制造一个多么奇怪的情节。您可以使用没有头的向量来做到这一点：

```
set style arrow 1 nohead
plot 'datafile' using (0.0):1:(0.0):(2.0) with vectors arrowstyle 1 
```

或者，在 gnuplot 速记中（只是为了好玩）：

```
p 'datafile' u (0.0):1:(0.0):(2.0) w vec as 1 
```

*`yrange`并`xrange`相应地调整*

# php - 重新加载由“

> ID：12484531
> 
> 赞同：0
> 
> 时间：2012-09-18T20:32:15.087
> 
> 标签：php, forms, submission

我正在使用一个简单的表单（来自[www.csskarma.com/lab/contactForm/](http://www.csskarma.com/lab/contactForm/)），它在页面上进行处理，然后抛出成功或失败消息。

我的问题有两个（可能很愚蠢）：

1) 提交后，页面 url 从“/”变为“/index.php”——这不是问题，但如果您尝试重新加载，您会收到“这将重新提交所有内容”消息。有没有办法解决这个问题？我不介意网址更改，但重新加载时重新提交有点问题。

2）再次加载表单会很棒，为空。万一有人想……写两次？如果重新加载显示一个干净的表单，这将不是一个问题，所以，我想它几乎是一个或另一个。

validate.js 正在处理一切，这是巨大的，我无法开始理解。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:35:26.140

1.  重定向到某个位置，将阻止这种情况发生

2.  重定向到表单页面

    header('位置：[http](http://www.example.com/form.php) ://www.example.com/form.php ');

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:42:01.393

使用 AJAX 通过[jQuery 表单插件](http://www.malsup.com/jquery/form/#api)提交表单意味着您可以取消任何刷新并保持 URL 干净。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T01:58:55.697

谢谢大家。

我最终将表单保留在 php 声明之外（它一直在最终标签中），虽然重新提交时重新加载仍然是一个问题，但由于表单仍然与感谢消息一起显示，一切似乎都变得更加清晰。无论如何，现在工作。再次感谢，--m

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T20:54:27.447

我已经修改了 PHP，希望它能解决你的两个问题：

**这在打开的 php 标签之后**

```
// get the status from the url bar
$status = $_GET['status']; 
```

**修改成功消息：**

```
if ($success){
    // we want to redirect via PHP so that users do not get that "resubmit message"
    header('location: '.$_SERVER['PHP_SELF'].'?status=sent');
} else {
    // we want the form to show up again? so, pass an error
    $status = 'error';
} 
```

**这正好在结束“？>”标签之前：**

```
# run the status through a switch if not empty
if(!empty($status)) {
    switch($status) {
        case 'sent':
            echo('<p class="feedback yay">All is well, your e&ndash;mail has been sent.</p>');
            break;
        case 'error':
            echo('<p class="feedback oops">Something went wicked wrong; maybe you clicked too hard.</p>');
            break;
    }
} 
```

# magento - 具有 2 列的块的 magento 模板

> ID：12484532
> 
> 赞同：0
> 
> 时间：2012-09-18T20:32:19.440
> 
> 标签：magento, block, two-columns

我制作了一个小型 magento (1.7) 模板文件，显示一个类别中的所有产品。但是，它们仅显示在单个列中。我想在 2 列中显示。

这从首页执行块：

```
{{block type="catalog/product" name="msc.specials" template="mylib/featuredlist.phtml"}} 
```

这是 featureslist.phtml -

```
<?php
//$_categoryId = $this->getCategoryId();

$productCollection = Mage::getModel('catalog/category')->load(4)
    ->getProductCollection()
    ->addAttributeToSelect('*')
    ->addAttributeToFilter('status', 1)
    ->addAttributeToFilter('visibility', 4)
    ->setOrder('price', 'ASC'); 
    $cartHelper = Mage::helper('checkout/cart');
?>

<div class='block block-list'> 
<div class='block-title'><strong><span><?php echo $this->__('SPECIALS') ?></span></strong></div>
    <div class='block-content'> 
        <ul>
            <h2><?php echo $this->__( $this->getLabel() ); ?></h2>
            <?php foreach ($productCollection as $product): ?>
                <div class="item">
                    <a class="product-image" href="<?php echo $product->getProductUrl() ?>">                
                        <img src="<?php echo $this->helper('catalog/image')->init($product, 'small_image')->resize(100); ?>" alt="<?php echo $this->htmlEscape($this->getImageLabel($product, 'small_image')) ?>" />
                    </a>
                    <a class="product-name" href="<?php echo $product->getProductUrl() ?>"><?php echo $this->htmlEscape($product->getName()) ?></a>                     
                   <?php echo $this->getPriceHtml($product, true) ?>                       
                </div>

                <div class="cms-price-box" style=" text-align:center;"></div>
                <div class="button-row" style="text-align:center;">                 
                    <button class="button btn-cart" type="button" onclick="setLocation('<?php echo $this->getUrl('')."checkout/cart/add?product=".$product->getId()."&qty=1"  ?>')" class="button"><span><?php echo $this->__('Add to Cart') ?></span></button>
                </div>
                <br/><br/>              
            <?php endforeach ?>
        </ul>
     </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:47:25.793

这实际上会有点复杂。也许我超出了范围，但你需要做几件事。它使其成为单个项目列，因为它正在执行 foreach 并且只是将每个项目吐出。要使它做两列，您需要计算列表中的项目并除以二。从那里您可以使用一些迭代将其拆分为两个数组，然后对两个结果数组进行 foreach 。

对于每个数组，您都希望它在一个具有左列或右列的 css 样式的 div 中。此外，您应该决定是否需要在中间拆分项目，第一部分进入第 1 列，后部分进入第 2 列。或者您可能更喜欢奇数项目进入第 1 列，偶数项目进入第 2 列。

如果您正在寻找更详细的答案，我可以给您一个，但这不是一个简单的答案。如果您对此感到满意，肯定会进行一些重新编码。

以下是您可以做什么的概述：[如何在 php 循环中每行显示两个表格列](https://stackoverflow.com/questions/1793716/how-to-display-two-table-columns-per-row-in-php-loop)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:15:38.750

这是基于 Nate 的建议和参考的解决方案。会对做同样事情的其他方式感兴趣

```
<?php
$_categoryId = $this->getCategoryId();

$productCollection = Mage::getModel('catalog/category')->load($_categoryId)
    ->getProductCollection()
    ->addAttributeToSelect('*')
    ->addAttributeToFilter('status', 1)
    ->addAttributeToFilter('visibility', 4)
    ->setOrder('price', 'ASC'); 
    $cartHelper = Mage::helper('checkout/cart');

    $x = 1;
?>

<div class='block block-list'> 
<div class='block-title'><strong><span><?php echo $this->__('FEATURED PRODUCTS') ?></span></strong></div>
    <div class='block-content'> 
        <ul>
            <h2><?php echo $this->__( $this->getLabel() ); ?></h2>
            <table>
            <tr>            
            <?php foreach ($productCollection as $product): ?>
            <?php           
                $x++;
                if (($x % 2) == 0){
                    echo "</tr><tr>";
                }
            ?>          
            <td>                
                <div class="item">
                    <a class="product-image" href="<?php echo $product->getProductUrl() ?>">
                        <img src="<?php echo $this->helper('catalog/image')->init($product, 'small_image')->resize(180); ?>" alt="<?php echo $this->htmlEscape($this->getImageLabel($product, 'small_image')) ?>" />
                    </a>
                    <br/>
                    <a class="product-name" href="<?php echo $product->getProductUrl() ?>"><?php echo $this->htmlEscape($product->getName()) ?></a>                     
                    <?php echo $this->getPriceHtml($product, true) ?>                      
                </div>

                <div class="cms-price-box" style=" text-align:center;"></div>
                <div class="button-row" style="text-align:center;">                 
                    <button class="button btn-cart" type="button" onclick="setLocation('<?php echo $this->getUrl('')."checkout/cart/add?product=".$product->getId()."&qty=1"  ?>')" class="button"><span><?php echo $this->__('Add to Cart') ?></span></button>
                </div>
            </td>
            <?php endforeach ?>
            </tr>
            </table>
        </ul>
     </div>
</div> 
```

# java - Java中的接口数组

> ID：12484537
> 
> 赞同：6
> 
> 时间：2012-09-18T20:32:29.940
> 
> 标签：java, arrays, interface

我有一个界面A：

```
interface A {
} 
```

然后我有一个B类：

```
class B implements A {
} 
```

然后我有一个使用 A 列表的方法：

```
void process(ArrayList<A> myList) {
} 
```

我想传递一个 B 列表：

```
ArrayList<B> items = new ArrayList<B>();
items.add(new B());
process(items); 
```

但随后出现类型不匹配的错误。我明白为什么。`ArrayList`本身是一种类型，它没有从 转换为`ArrayList<B>`的功能`ArrayList<A>`。是否有一种快速且资源明智的轻量级方法来形成一个适合传递给我的`process`方法的新数组？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T20:35:17.450

我认为最简单的解决方案是将其中一种方法更改为：

```
void process(ArrayList<? extends A> myList) {
} 
```

但是，请注意，使用此解决方案，整个列表需要属于同一类型。也就是说，如果您有一个`C`也可以实现的类，`A`则不能混合数组中的项目，使其部分为 type `B`，部分为 type `C`。

此外，正如下面评论中所指出的，您将无法在此方法中将对象添加到列表中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T20:42:19.570

另一种选择是只创建一个 ArrayList`A`而不是`B`

```
ArrayList<A> items = new ArrayList<A>();
items.add(new B());
process(items); 
```

在声明的列表中添加实现接口的类（例如 B）是完全可以接受的。

顺便说一句：我会`List`在实例化列表时使用并且只使用 ArrayList 。还包括西蒙的回答，这可能成为

```
void process(List<? extends A> myList) {
}

List<A> items = new ArrayList<A>();
items.add(new B());
process(items); 
```

# django - Django：表单中字段描述中的语言不会改变

> ID：12484539
> 
> 赞同：0
> 
> 时间：2012-09-18T20:32:43.590
> 
> 标签：django, internationalization, django-forms

当我在 Django 支持的网站上更改语言时，除了表单中字段描述的翻译外，一切正常。描述仍以旧语言显示。只有已经访问过该会话的表单会受到影响。

这似乎是某种缓存问题，但我没有使用任何缓存（据我所知）并且网站的所有其他部分都按预期运行（使用 django.utils.translaction.ugettext 的模板和随机文本工作得很好）。

总结：

1.  当我打开网站并更改语言，然后访问一个表单时：一切都按预期工作。所有文本均已翻译。
2.  当我访问表单时，更改语言并返回表单：所有内容都已翻译，但表单仍保留旧语言。
3.  重新启动 Web 服务器会强制更改语言：然后 Django 在当前会话中的行为与 (1) 中一样。直到再次更改语言。

帮助表示赞赏！

亲切的问候，帕特里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T10:55:09.310

通过更改修复它

```
from django.utils.translation import ugettext  as _ 
```

至

```
from django.utils.translation import ugettext_lazy  as _ 
```

对于我的表格。

# jquery - Jquery/Jquery UI 未加载？

> ID：12484541
> 
> 赞同：0
> 
> 时间：2012-09-18T20:32:44.830
> 
> 标签：jquery

我一直在用头撞墙，试图弄清楚为什么 Jquery 无法加载。它和 Jquery UI 正在通过 Google API 访问，因此它应该可以正常工作，但我收到“jquery is undefined”消息。

我能想到的是它与其他一些脚本有冲突吗？

找到它，看看你能不能帮忙。谢谢。

[http://marianoagency.com/intranet/trial.html](http://marianoagency.com/intranet/trial.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:34:06.033

```
<!-- JS Functions 
```

在 functions.js 中不是有效的 javascript

尝试`// <!-- JS Functions`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:36:10.900

在您的[http://marianoagency.com/intranet/scripts/functions.js](http://marianoagency.com/intranet/scripts/functions.js)文件中，您有：

```
<!-- JS Functions

function MM_jumpMenu(targ,selObj,restore){ //v3.0
  eval(targ+".location='"+selObj.options[selObj.selectedIndex].value+"'");
  if (restore) selObj.selectedIndex=0;
}

function window(page,tl,wd,ht) {
OpenWin = this.open(page, tl, "toolbar=no,menubar=no,location=no,scrollbars=yes,resizable=no,width="+wd+",height="+ht);
}

function window2(page) {
OpenWin = this.open(page, "CtrlWindow", "toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,width=500,height=300");
}

//--> 
```

这些不是合法的 JavaScript 注释标签。如果要注释掉整个代码块或每行，请使用`/*`and代替。`*/``//`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T20:40:54.127

除了@Joe Tuskan 的回答之外，您这里还有一段非常可疑的代码：

```
function window(page,tl,wd,ht) {
OpenWin = this.open(page, tl, "toolbar=no,menubar=no,location=no,scrollbars=yes,resizable=no,width="+wd+",height="+ht);
} 
```

调用函数`window`是一个非常糟糕的主意，因为它会与全局`window`对象发生冲突。严格来说，它不是语法意义上的保留字，但它也可能是。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T20:35:54.863

您`jQuery`在插件/个人脚本之后加载。

如果 Google 失败，这也是一个常见的后备方案：

```
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src=\"http://trackmyclosing.net/ci/plugins/js/jquery-1.7.2.js\" type='text/javascript'%3E%3C/script%3E"));
}
</script> 
```

# java - 从jquery加载方法加载下拉列表时如何从数据库中预选下拉值

> ID：12484558
> 
> 赞同：0
> 
> 时间：2012-09-18T20:33:48.387
> 
> 标签：java, jquery, servlets

我不完全确定这是否可能，但我会在这里问。

我有一个 .jsp 页面，它从 .txt 文件填充下拉内容并使用 jquery/javascript 加载。

它们是这样加载的：

```
$function(){  
$(".dropdownA").load("dropdowninfo.txt);  
}; 
```

我还使用 servlet 对数据库执行 ping 操作，以填写此特定 .jsp 页面的其他信息。我的问题是如何选择下拉菜单中的正确值来显示该值。

例如：
如果下拉列表包含 {a, b, c, d, e} 并且 servlet 返回“d”，我怎样才能让 jsp 页面显示“d”。目前它将显示列表。下面是我编写jsp页面的方法。

```
<select class=".dropdownA"><select> 
```

这将在下拉列表中显示 a、b、c、d、e。那么如何预选“d”呢？或者我应该从 servlet 中完成所有操作，包括填充下拉列表？

谢谢！

**更新：**

servlet 运行查询，并将结果返回到 jsp 页面。例如：

```
ResultsSet results = record.executeQuery();
Result result = ResultSupport.toResult(results);
request.setAttribute("result", result);
RequestDispatcher rd = request.getRequestDispacher("/page.jsp");
rd.forward(request, response); 
```

所以在jsp页面上，我通过调用得到对应的值：
c:out value="${result[x]}"

本质上，我需要以某种方式将 ${result[x]} 作为选择列表的预选值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:43:25.590

要使用 jQuery 预先选择一个选项，您只需使用 val()。

例如：

```
$('.dropdownA').val('b'); 
```

因此，在您填充下拉列表后，可能在您的加载方法的回调中，您应该像上面一样设置值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:45:58.773

如果从数据库 id 返回的值例如说 c。然后你可以试试这个

```
$('.dropdownA').val('c) 
```

这将为您预先选择下拉菜单

# java - 你能覆盖 -XX+HeapDumpOnOutOfMemoryError 产生的堆转储的文件权限吗？

> ID：12484559
> 
> 赞同：6
> 
> 时间：2012-09-18T20:33:55.327
> 
> 标签：java, jvm

在 Linux 上，使用`-XX+HeapDumpOnOutOfMemoryError`生成的 hprof 文件由运行 java 进程的用户拥有，并且权限为 600。

我知道这些权限是最好的安全性，但是否可以覆盖它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-06T11:00:20.307

您可以使用以下命令启动 JVM

```
java -XX:+HeapDumpOnOutOfMemoryError -XX:OnOutOfMemoryError="chmod g+r java_pid*.hprof" {mainclass} {args} 
```

该命令在创建堆转储后运行。例如，这将允许对当前目录中的所有堆转储文件进行组读取访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-04T17:57:01.120

对于 JRE 7(1.7.0_72) 上的命令中的空格，该`-XX:OnOutOfMemoryError`参数对我不起作用。但是指向一个shell脚本（没有空格）可以。例子：

> -XX:OnOutOfMemoryError="/path/to/shell/script.sh"

# c# - 将列表中的多个元素添加到数组

> ID：12484565
> 
> 赞同：1
> 
> 时间：2012-09-18T20:34:09.963
> 
> 标签：c#, asp.net, arrays, list, arraylist

我有一个包含多个变量的列表，并且想将写入文本文件的内容添加到数组中。

```
class DataFields
{
     public string name{get;set;}
     public int id{get;set;}
     public int age{get;set;}
}

List<DataFields> dfList; 
```

看起来像

```
Adam 1234 23
Pete 3841 15
Scot 8435 30

DataFields[] result = dfList.ToArray();
File.WriteAllLines(@"C:\File\TextFile.txt", result); 
```

我希望将结果显示在类似于上面列表的文本文件中，但我无法将列表添加到数组然后按该顺序显示。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T20:39:19.357

`File.WriteAllLines`想要一个字符串的集合。您可以使用 LINQ 生成一个：

```
List<DataFields> dfList = new List<DataFields>();
// populate dfList here

var formattedData = 
     dfList
        .OrderBy(df => df.Name)
        .Select(df => string.Format("{0} {1} {2}", df.Name, df.Id, df.Age));

File.WriteAllLines(@"C:\File\TextFile.txt", formattedData); 
```

您应该使用 PascalCase 作为您的属性名称（名称、ID、年龄）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T20:39:47.340

```
var result = dfList.Select(df => String.Format("{0}\t{1}\t{2}", df.name, df.id, df.age); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:07:57.243

你也可以做这样的事情..

```
List<DataFields> dfList = new List<DataFields>();
    // populate dfList here
    StreamWriter sw = new StreamWriter(@"C:\File\TextFile.txt");

            foreach (DataFields df in dfList)
            {
                sw.WriteLine(df.id+"\t"+df.name+"\t"+df.age);
            }

            sw.Close(); 
```

或者简单地使用更有效的 List 的 foreach 。

```
dfList.ForEach(df=> sw.WriteLine(df.id + "\t" + df.name + "\t" + df.age)); 
```

# tomcat - 浏览器无法从 WEB-INF 文件夹中检索 JS 文件

> ID：12484569
> 
> 赞同：1
> 
> 时间：2012-09-18T20:34:21.870
> 
> 标签：tomcat, servlets

我的 WEB-INF 文件夹中有一个文件夹“js”，它包含 javascript 文件。我无法让服务器使用 url localhost:8084/appname/js/file.js 检索它们，但我的 web.xml 文件中定义的所有其他内容都可以正常工作。

**Web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app>

   <servlet>
        <servlet-name>MeasurementNodesController</servlet-name>
        <servlet-class>com.mycompany.MeasurementNodesController</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>MeasurementNodesController</servlet-name>
        <url-pattern>/MeasurementNodes</url-pattern>
    </servlet-mapping>

    <resource-ref>
        <res-ref-name>jdbc/datasource</res-ref-name>
        <res-ref-type>javax.sql.DataSource</res-ref-type>
    </resource-ref>

    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
</web-app> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T20:37:51.957

WEB-INF 文件夹中的任何内容对外界都是不可用的。WEB-INF 仅在 Forwards 等内部可用。

您需要将 JS 移出 WEB-INF 才能使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:39:28.770

## tomcat的部署结构

您最终将在应用程序的“文档根”目录中获得以下内容：

* **.html、*.jsp 等 -** HTML 和 JSP 页面，以及应用程序的客户端浏览器必须可见的其他文件（例如**JavaScript**、样式表文件和图像）。为这些文件只维护一个目录通常要简单得多。

**/WEB-INF/web.xml** - 这是一个 XML 文件，描述构成应用程序的 servlet 和其他组件，以及任何初始化参数和容器管理的安全约束。

**/WEB-INF/classes/** - 此目录包含应用程序所需的任何 Java 类文件（和相关资源）。

**/WEB-INF/lib/ -**此目录包含 JAR 文件，其中包含应用程序所需的 Java 类文件（和相关资源），例如第三方类库或 JDBC 驱动程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-22T09:29:44.180

已经回答了这个问题，但我提供了视觉细节......`WEB-INF`外部世界无法访问其中的文件，只能由您的应用程序本身访问。

您需要将您的公共静态资产放在您的战争文件的顶层，例如，

```
js/file.js 
```

为了检索，您可以执行以下操作：

```
<script src="js/file.js"></script> 
```

[![在此处输入图像描述](../Images/c57e5a058a2072d828f2f5eff1f55ed1.png)](https://i.stack.imgur.com/SI68u.png)

# postgresql - Heroku - 将单个表转储并加载到共享 postgres 数据库

> ID：12484581
> 
> 赞同：7
> 
> 时间：2012-09-18T20:35:01.777
> 
> 标签：postgresql, heroku

我想知道是否有一种简单的方法可以将一个表的内容转储或加载到 heroku 共享数据库（postgres）。heroku 推荐了 pgbackups 插件，但根据文档，它支持转储和加载整个数据库。

我需要的是转储/加载单个表。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T20:38:47.560

您可以使用 Taps ( [https://devcenter.heroku.com/articles/taps](https://devcenter.heroku.com/articles/taps) ) 从您的 PG 数据库中提取数据。使用 Taps，您可以创建特定的表格，例如：

```
heroku db:pull --tables users 
```

您还可以在表名以逗号分隔的情况下创建多个表，例如：

```
heroku db:pull --tables users,posts 
```

**编辑：**正如一些评论所指出的，水龙头已被弃用和替换。

新机制已经通过`pg:pull`，`pg:push`可以通过他们的新文档（[https://devcenter.heroku.com/articles/heroku-postgresql#pg-push-and-pg-pull](https://devcenter.heroku.com/articles/heroku-postgresql#pg-push-and-pg-pull)）看到。

不再支持单个表，您可以通过以下示例将数据库拉到本地：

```
heroku pg:pull HEROKU_POSTGRESQL_MAGENTA mylocaldb --app sushi 
```

或从本地更新遥控器：

```
heroku pg:push mylocaldb HEROKU_POSTGRESQL_MAGENTA --app sushi 
```

# c++ - 与 IDE/编译器数组处理的差异

> ID：12484588
> 
> 赞同：-1
> 
> 时间：2012-09-18T20:35:27.840
> 
> 标签：c++, visual-studio, compiler-construction, g++

> **可能重复：**
> [C/C++：允许运行时不带动态分配的数组大小？](https://stackoverflow.com/questions/737240/c-c-array-size-at-run-time-w-o-dynamic-allocation-is-allowed)

我在一个班级，我们有一个简单的任务来编写一个函数，该函数返回一个指向动态数组的指针并提供一个存根来测试它。我已经完成了这项工作，所以我不会在作业上寻求帮助。在课堂博客上，另一位学生建议直观的是，应该能够`int Array[size];`在`size`显然是用户定义变量的地方进行操作。

我知道在标准 C++ 中，至少根据我的文本，数组必须有一个“常量整数表达式......大于零”作为大小声明符。这对我来说意味着他们的例子**行不通**。事实上，使用 VS2010 时，您会遇到三个错误。

但是，他们解释说：

> 我知道，你知道，甚至我的 Ubuntu 安装中的 g++ 编译器和我的 WinXP 安装中的 Bloodshed 编译器都知道这一点。对于某些级别的“知道”，人们会期望“int Array[size];” 工作（就像在之前的两个课程中一样）。
> 
> 但显然它无法在某些人的 VS 编译器上运行。只能假设，因为共同点是 VS（是的，我通过让朋友在他的盒子上检查确认了这一点），VS 是问题所在。几个之一。

已经有混乱，因为这`I know that...`部分是指我告诉他们不应该有任何理由来`#include <new>`使用`new`，但似乎他们认为我们同意不应该有任何理由使用`new`来分配动态数组。（ ?)

所以问题很明显。是否有任何编译器可以接受`int Array[size];`，其中 size 不是`const int`没有错误的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T20:41:31.393

```
int Array[size]; 
```

where `size`is not a constant expression is a *variable length array*。从 1999 年 ISO 标准开始，它们是 C 的标准功能。C++ 标准没有采用它们，但一些编译器支持它们作为语言扩展。

（任何 C++ 编译器，当以一致模式调用时，必须至少对具有非常量大小的数组类型发出诊断。）

顺便说一句，这与您使用的 IDE 没有直接关系。它由 IDE 调用的编译器控制。

至于`#include <new>`该名称有一个标准标题，但对于`new`内置于语言中的运算符来说不是必需的。标`<new>`头提供了几个重载版本`operator new`和一些其他声明。

# python - 与查找表匹配的字符串迭代

> ID：12484589
> 
> 赞同：1
> 
> 时间：2012-09-18T20:35:29.433
> 
> 标签：python, python-3.x

一个新手问题：我必须迭代一个名称，然后将每个字母与一个以开头的数字相关联`a=1, b=2, c=3, etc.`，然后将这些数字相加。我已经做到了这一点，但没有更进一步：

```
def main():
    name = input("Enter name  ")
    sum = 0
    for ch in name:
        # ? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:51:57.943

这个怎么样？

```
def main():
    print sum(ord(c.lower()) - ord('a') + 1 for c in raw_input("Enter name: ")) 
```

即使您同时处理大写和小写字母，这也将起作用。如果您只处理小写字母，则可以更改`c.lower()`为`c`（当然，它仍然可以按原样工作，但是如果您只使用小写字母，进行更改会使其更快）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:42:49.990

创建一个将字符映射到值的字典，然后`get()`在当前字符上使用默认值为 0 的方法。

# python - 如何更改字典中的一项

> ID：12484597
> 
> 赞同：0
> 
> 时间：2012-09-18T20:36:01.120
> 
> 标签：python, dictionary, mutable

我需要一个函数来更改复合字典中的一项。我试过类似的东西..

```
def SetItem(keys, value):

    item = self.dict

    for key in keys:          
        item = item[key]

    item = value 
```

和

```
 SetItem(['key1', 'key2'], 86) 
```

它应该等价于**self.dict['key1']['key2'] = 86**，但是这个函数没有效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:39:41.307

几乎。您实际上想要执行以下操作：

```
def set_keys(d, keys, value):
    item = d
    for key in keys[:-1]:
        item = item[key]
    item[keys[-1]] = value 
```

或者像这样递归：

```
def set_key(d, keys, value):
    if len(keys) == 1:
        d[keys[0]] = value
    else:
        set_key(d[keys[0]], keys[1:], value) 
```

不过马尔辛是对的。你真的想加入一些更严格的东西，对丢失的键/丢失的字典进行一些错误处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T20:42:12.050

```
setItem = lambda self,names,value: map((lambda name: setattr(self,name,value)),names) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T20:43:06.263

1.  你没有 self 参数
2.  只需使用您拥有的工作代码行。
3.  如果你坚持，这里有一个方法：

    ```
    def setitem(self, keys, value):
        reduce(dict.get, # = lambda dictionary, key: dictionary[key]
               keys[:-1], self.dictionary)[keys[-1]] = value 
    ```

显然，如果键列表达到非字典值，这将中断。你会想要处理它。事实上，出于这个原因，一个显式循环可能会更好，但你明白了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T21:51:33.947

一个涉及递归和 EAFP 的想法，我一直都很喜欢：

```
def set_item(d, keys, value):
    key = keys.pop(0)
    try:
        set_item(d[key], keys, value)
    # IndexError happens when the pop fails (empty list), KeyError happens when it's not a dict.
    # Assume both mean we should finish recursing
    except (IndexError, KeyError):
        d[key] = value 
```

例子：

```
>>> d = {'a': {'aa':1, 'ab':2}, 'b':{'ba':1, 'bb':2}}
>>> set_item(d, ['a', 'ab'], 50)
>>> print d
{'a': {'aa': 1, 'ab': 50}, 'b': {'ba': 1, 'bb': 2}} 
```

编辑：正如 Marcin 在下面指出的那样，这不适用于任意嵌套的字典，因为 Python 有[递归限制](http://docs.python.org/library/sys.html#sys.getrecursionlimit)。它也不适用于对性能高度敏感的情况（Python 中的递归通常不是）。尽管如此，在这两种情况之外，我发现这比涉及`reduce`or的事情更明确一些`lambda`。

# sql - 验证结果集对于列中的每个值都有一行

> ID：12484600
> 
> 赞同：0
> 
> 时间：2012-09-18T20:36:12.113
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我想检查给定的 SubId/WorkflowId 组合是否存在记录`ProcessCode = 10`，相同的`SubId/WorkflowId`组合有一行`ProcessCode`20、30 和 40。下面是我正在尝试做的一个写得很糟糕的版本；我希望有一个更优雅的解决方案。这个查询基本上是在识别任何违反规则的东西。

```
IF EXISTS( SELECT * FROM @DataTable WHERE SubID = @SubId and WorkflowId = @WorkflowId and ProcessCode = 10)
AND (
NOT EXISTS( SELECT * FROM @DataTable WHERE SubID = @SubId and WorkflowId = @WorkflowId  and ProcessCode = 20) or 
NOT EXISTS( SELECT * FROM @DataTable WHERE SubId = @SubId and WorkflowId = @WorkflowId and ProcessCode = 30) or
NOT EXISTS( SELECT * FROM @DataTable WHERE SubID = @SubId and WorkflowId = @WorkflowId and ProcessCode = 40)
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T13:20:02.267

如果您想查找所有具有 ProcessCode 10 但没有 20/30/40 的 SubID 和 WorkFlowID，您可以使用此查询而不是单独检查每个 Sub/Workflow。

```
SELECT 
    SubID,
    WorkFlowID
FROM @DataTable 
GROUP BY SubID, WorkFlowID
HAVING SUM(CASE WHEN ProcessCode = '10' THEN 1 ELSE 0 END) > 0
AND COUNT(DISTINCT (CASE WHEN ProcessCode IN ('20','30','40') THEN ProcessCode ELSE NULL END)) < 3 
```

[Sql 小提琴](http://sqlfiddle.com/#!6/64f6d/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:45:03.543

像这样的东西？

```
IF EXISTS(
    SELECT 1 FROM @DataTable DT
    LEFT JOIN @DataTable DT2 ON DT.SubId = DT2.SubId AND DT.WorkflowId = DT2.WorkflodId AND DT2.ProcessCode IN (20, 30, 40)
    WHERE DT.ProcessCode = 10 AND DT2.ProcessCode IS NULL
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T13:25:05.350

```
IF EXISTS( SELECT * FROM @DataTable WHERE SubID = @SubId and WorkflowId = @WorkflowId and ProcessCode = 10)
AND (NOT EXISTS ( SELECT * FROM @DataTable WHERE SubID = @SubId and WorkflowId = @WorkflowId  and ProcessCode in (20, 30, 40))) 
```

# c# - 无效方差：类型参数“T”必须在“UserQuery.IItem”上逆变有效 .ItemList'。'T' 是协变的

> ID：12484601
> 
> 赞同：28
> 
> 时间：2012-09-18T20:36:14.863
> 
> 标签：c#, covariance

为什么可以编译方法时属性会出错？

```
public interface IFoo {}
public interface IBar<out T> where T : IFoo {}

public interface IItem<out T> where T: IFoo
{
    // IEnumerable<IBar<T>> GetList(); // works
    IEnumerable<IBar<T>> ItemList { get; set; } // Error!
} 
```

错误：

> 无效方差：类型参数“T”必须在“UserQuery.IItem<T>.ItemList”上逆变有效。“T”是协变的。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-09-18T20:42:38.883

您会收到编译器错误，因为您有一个属性 getter ( `get`) 和一个 setter ( `set`)。属性 getter`T`的输出中有 in ，所以`out`可以工作，但是属性 setter`T`的输入中有 in ，所以它需要`in`修饰符。

因为你有`out`你`T`需要删除设置器，它会编译：

```
public interface IItem<out T> where T : IFoo
{
    // IEnumerable<IBar<T>> GetList(); // works
    IEnumerable<IBar<T>> ItemList { get; } // also works
} 
```

如果您的参数`T`是`in`通用参数，那么以下方法将起作用：

```
public interface IItem<in T> where T : IFoo
{
    IEnumerable<IBar<T>> ItemList { set; } 
} 
```

但是您不能同时拥有两者 ( `out,in`)，因此您不能拥有带有 getter 和 setter 的协/逆变属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T20:52:24.510

不允许使用 setter，因为如果是，您将能够这样做：

```
public interface ISubFoo : IFoo { }

IItem<ISubFoo> item = //whatever
item.ItemList = new List<IBar<IFoo>>>(); 
```

这不是类型安全的。

# performance - 实体框架 SQL 选择 600+ 列

> ID：12484605
> 
> 赞同：0
> 
> 时间：2012-09-18T20:36:28.513
> 
> 标签：performance, oracle, entity-framework, entity-framework-4

我有一个针对oracle运行的实体框架生成的查询太慢了。它运行大约 4 秒。

这是我查询的主要部分

```
var query = from x in db.BUILDINGs
                    join pro_co in db.PROFILE_COMMUNITY on x.COMMUNITY_ID equals pro_co.COMMUNITY_ID
                    join co in db.COMMUNITies on x.COMMUNITY_ID equals co.COMMUNITY_ID
                    join st in db.STATE_PROFILE on co.STATE_CD equals st.STATE_CD
                    where pro_co.PROFILE_NM == authorizedUser.ProfileName

                    select new
                    {
                        COMMUNITY_ID = x.COMMUNITY_ID,
                        COUNTY_ID = x.COUNTY_ID,
                        REALTOR_GROUP_NM = x.REALTOR_GROUP_NM,
                        BUILDING_NAME_TX = x.BUILDING_NAME_TX,
                        ACTIVE_FL = x.ACTIVE_FL,
                        CONSTR_SQFT_AVAIL_NB = x.CONSTR_SQFT_AVAIL_NB,
                        TRANS_RAIL_FL = x.TRANS_RAIL_FL,
                        LAST_UPDATED_DT = x.LAST_UPDATED_DT,
                        CREATED_DATE = x.CREATED_DATE,
                        BUILDING_ADDRESS_TX = x.BUILDING_ADDRESS_TX,
                        BUILDING_ID = x.BUILDING_ID,
                        COMMUNITY_NM = co.COMMUNITY_NM,
                        IMAGECOUNT = x.BUILDING_IMAGE2.Count(),
                        StateCode = st.STATE_NM,
                        BuildingTypeItems = x.BUILDING_TYPE_ITEM,
                        BuildingZoningItems = x.BUILDING_ZONING_ITEM,
                        BuildingSpecFeatures = x.BUILDING_SPEC_FEATURE_ITEM,
                        buildingHide = x.BUILDING_HIDE,
                        buildinghideSort = x.BUILDING_HIDE.Count(y => y.PROFILE_NM == ProfileName) > 0 ? 1 : 0,
                        BUILDING_CITY_TX = x.BUILDING_CITY_TX,
                        BUILDING_ZIP_TX = x.BUILDING_ZIP_TX,
                        LPF_GENERAL_DS = x.LPF_GENERAL_DS,
                        CONSTR_SQFT_TOTAL_NB = x.CONSTR_SQFT_TOTAL_NB,
                        CONSTR_STORIES_NB = x.CONSTR_STORIES_NB,
                        CONSTR_CEILING_CENTER_NB = x.CONSTR_CEILING_CENTER_NB,
                        CONSTR_CEILING_EAVES_NB = x.CONSTR_CEILING_EAVES_NB,
                        DESCR_EXPANDABLE_FL = x.DESCR_EXPANDABLE_FL,
                        CONSTR_MATERIAL_TYPE_TX = x.CONSTR_MATERIAL_TYPE_TX,
                        SITE_ACRES_SALE_NB = x.SITE_ACRES_SALE_NB,
                        DESCR_PREVIOUS_USE_TX = x.DESCR_PREVIOUS_USE_TX,
                        CONSTR_YEAR_BUILT_TX = x.CONSTR_YEAR_BUILT_TX,
                        DESCR_SUBDIVIDE_FL = x.DESCR_SUBDIVIDE_FL,
                        LOCATION_CITY_LIMITS_FL = x.LOCATION_CITY_LIMITS_FL,
                        TRANS_INTERSTATE_NEAREST_TX = x.TRANS_INTERSTATE_NEAREST_TX,
                        TRANS_INTERSTATE_MILES_NB = x.TRANS_INTERSTATE_MILES_NB,
                        TRANS_HIGHWAY_NAME_TX = x.TRANS_HIGHWAY_NAME_TX,
                        TRANS_HIGHWAY_MILES_NB = x.TRANS_HIGHWAY_MILES_NB,
                        TRANS_AIRPORT_COM_NAME_TX = x.TRANS_AIRPORT_COM_NAME_TX,
                        TRANS_AIRPORT_COM_MILES_NB = x.TRANS_AIRPORT_COM_MILES_NB,
                        UTIL_ELEC_SUPPLIER_TX = x.UTIL_ELEC_SUPPLIER_TX,
                        UTIL_GAS_SUPPLIER_TX = x.UTIL_GAS_SUPPLIER_TX,
                        UTIL_WATER_SUPPLIER_TX = x.UTIL_WATER_SUPPLIER_TX,
                        UTIL_SEWER_SUPPLIER_TX = x.UTIL_SEWER_SUPPLIER_TX,
                        UTIL_PHONE_SVC_PVD_TX = x.UTIL_PHONE_SVC_PVD_TX,
                        CONTACT_ORGANIZATION_TX = x.CONTACT_ORGANIZATION_TX,
                        CONTACT_PHONE_TX = x.CONTACT_PHONE_TX,
                        CONTACT_EMAIL_TX = x.CONTACT_EMAIL_TX,
                        TERMS_SALE_PRICE_TX = x.TERMS_SALE_PRICE_TX,
                        TERMS_LEASE_SQFT_NB = x.TERMS_LEASE_SQFT_NB
                    }; 
```

有一段代码在查询中添加了动态 where 和 sort 子句，但我将它们省略了。无论在哪里进行排序，查询都需要大约 4 秒的时间来运行。

我在 Oracle 中删除了生成的 SQL，解释计划似乎没有显示任何可以修复我的东西。费用为 1554

如果不允许这样做，我深表歉意，但我似乎找不到分享此信息的好方法。我在这里上传了 Sql Developer 生成的解释计划：[http ://www.123server.org/files/explainPlanzip-e1d291efcd.html](http://www.123server.org/files/explainPlanzip-e1d291efcd.html)

表格布局

```
Building
--------------------
- BuildingID
- CommunityId
- Lots of other columns

Profile_Community
-----------------------
- CommunityId
- ProfileNM
- lots of other columns

state_profile
---------------------
- StateCD
- ProfileNm
- lots of other columns

Profile
---------------------
- Profile-NM
- a few other columns 
```

所有具有分配列的表每个都有 120-150 列。似乎实体正在生成一个选择语句，该语句从每个表中提取每一列，而不仅仅是我想要的那些。

困扰我的事情，我认为可能是我的问题是，在我的 LINQ 中，我选择了 50 个项目，但生成的 sql 返回 677 列。我认为返回这么多列可能是我缓慢的根源。

任何想法为什么我会在 SQL 中返回这么多列或如何加快查询速度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:42:50.967

我怀疑您的对象创建会影响某些性能。尝试在没有基本“select x”的情况下运行查询，看看是 SQL 查询需要时间还是对象创建。

此外，如果生成的查询过于复杂，您可以尝试将其分成较小的子查询，这些子查询会逐渐丰富您的对象，而不是尝试一次查询所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T19:35:10.993

我最终创建了一个视图并让视图只选择我想要的列并加入需要在 linq 中左连接的内容。

EF 从您尝试加入的每个表中选择每一列，这很烦人。但我想我只是注意到了这一点，因为我加入了一堆包含 150 多列的表。

# .htaccess - 个人资料的 SEO 网址

> ID：12484607
> 
> 赞同：0
> 
> 时间：2012-09-18T20:36:37.513
> 
> 标签：.htaccess

# 前言

我正在尝试为个人资料页面重写 URL。我所有的应用程序页面都有一个`.html`扩展名，所以我试图只匹配字母、数字、`-`. 和`.`.

所以这些是有效的

```
site.com/steve
site.com/steve-robbins
site.com/steve.robbins 
```

但这些不会

```
site.com/steve.html
site.com/steve-robbins.php 
```

假设我有一个检查，以便自定义 URL 没有`.html`或`.php`最后没有。

# 问题

我目前正在使用它，但它不起作用

```
RewriteRule ^([a-zA-Z0-9\.-]+)$ profile.php?url=$1 [L] 
```

它应该设置`url`为`steve`，但它设置为`profile.php`

我究竟做错了什么？

* * *

我的完整`.htaccess`

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^[^.]+\.[^.]+$
RewriteRule ^(.*) http://www.%{HTTP_HOST}/$1 [R=301]

#
#   LOGIN
#
RewriteRule ^([a-z0-9]{255})/activate\.html$ login.php?activate=$1 [L]
RewriteRule ^logout\.html$ login.php?logout [L]

#
#   SETTINGS
#
RewriteRule ^change-([a-z]+)\.html$ account-settings.php?$1 [L]

RewriteRule ^([a-zA-Z0-9\.-]+)$ profile.php?url=$1 [L]

# SEO friendly URLs
RewriteRule ^([a-zA-Z0-9-_.]+)\.html$ $1.php [L]
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([a-zA-Z0-9-_.]+)\.php
RewriteRule ^([a-zA-Z0-9-_.]+)\.php$ $1.html [R=301] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:46:08.627

将此添加到规则的顶部（在`RewriteBase /`指令下）：

```
RewriteCond %{ENV:REDIRECT_STATUS} 200
RewriteRule ^ - [L] 
```

那应该阻止它循环。重写引擎将继续重新应用所有规则，直到进入的 URI（无查询字符串）与来自规则的 URI 相同。这就是为什么 的`url`值为`profile.php`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:40:09.633

尝试像这样在重定向中添加前导斜杠：

```
RewriteRule ^([a-zA-Z0-9.-]+)$ /profile.php?url=$1 [L] 
```

您获得`url`值的原因`profile.php`是因为该`[L]`标志在涉及`.htaccess`文件时有点误导。在服务器配置文件中，它完全按照您的想法执行，但在`.htaccess`文件中它停止读取该规则的规则，但随后再次通过规则，直到任何规则未更改路径。通过添加前导，当您从正则表达式中`/`排除时，您的规则将不会第二次匹配。`/`我自己花了一段时间在这个*功能*上苦苦挣扎。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:44:08.300

我是解释 mod_rewrite 规则的初学者，但如果我理解正确，您的规则匹配并再次匹配，要么向 /profile/user 之类的 url 匹配方案添加一些内容，要么添加一个条件以在已重定向的情况下不重定向

# php - 来自 php 页面的 ajax 调用 - 检查结果是否为空数组

> ID：12484610
> 
> 赞同：0
> 
> 时间：2012-09-18T20:37:14.953
> 
> 标签：php, ajax, arrays

我有一个 php 页面，其中包含以下 javascript：

```
<script>

$(document).ready(function(){
    $('#search').hide();
  });

$('#L1Locations').live('change',function(){

      var htmlstring;
      $selectedvalue = $('#L1Locations').val();

      $.ajax({
                url:"<?php echo site_url('switches/getbuildings/');?>" + "/" + $selectedvalue,
                type:'GET',
                dataType:'json',
                success: function(returnDataFromController) {
                    alert('success');
                        var htmlstring;
                        htmlstring="<select name='L2Locations' id='L2Locations'>";
                        htmlstring = htmlstring + "<option value='all'>All</option>";

                        console.log(returnDataFromController);

                         var JSONdata=[returnDataFromController];
                        alert('string length is' + JSONdata.length);
                        if(JSONdata.length > 0) 
                        {
                            for(var i=0;i<JSONdata.length;i++){
                            var obj = JSONdata[i];
                              for(var key in obj){
                                     var locationkey = key;
                                     var locationname = obj[key];
                                     htmlstring = htmlstring + "<option value='" + locationkey + "'>" + locationname + "</option>";
                                }
                             }

                            $('#l2locations').html(htmlstring);

                        }
                        else
                        {
                            alert('i think undefined');
                            $('#l2locations').html('');
                        }                           
               }

    });
 $('#search').show();
 });
</script> 
```

如果变量“returnDataFromController”有任何项目，我想要完成的是动态显示一个组合框。

但我认为检查 JSONdata.length 的行有一个错误。
无论 ajax 调用返回填充数组还是空数组，长度始终显示为 1。我想我对询问长度时计数的内容感到困惑。或者我的 dataType 属性不正确？我不知道。

如果它对您有帮助，当我从 ajax 调用中取回数据时（因此应该创建组合时），“console.log（returnDataFromController）”行会给出以下结果

```
[16:28:09.904] ({'2.5':"Admin1", '2.10':"Admin2"}) @ http://myserver/myapp/index.php/mycontroller/getbranches:98 
```

在这种情况下，组合框会显示正确的内容。

但是在我返回一个空数组的情况下，也会创建组合框。这是 console.log 调用转储出来的内容：

```
[16:26:23.422] [] @ http://myserver/myapp/index.php/mycontroller/getbranches:98 
```

你能告诉我哪里出错了吗？

**编辑：**

我意识到我将返回数据视为一个对象——我认为这就是我想要的，因为我要返回一个数组。我想我需要知道如何正确检查 javascript 中数组的长度。我以为它只是.length。

谢谢。

**编辑 2：** 也许我应该更改控制器发送的结果？我应该返回 false 还是 NULL，而不是返回一个空数组？

```
 if (isset($buildingforbranch))
        {
                echo json_encode($buildingforbranch);  
        }
        else 
        {
            echo json_encode(false);
        } 
```

**编辑 3：**

基于[Parse JSON in JavaScript? 中的帖子？](https://stackoverflow.com/questions/4935632/how-to-parse-json-in-javascript)，我已将 ajax 调用的“成功”部分中的代码更改为：

```
 success: function(returnDataFromController) {

                        var htmlstring;
                        htmlstring="<select name='L2Locations' id='L2Locations'>";
                        htmlstring = htmlstring + "<option value='all'>All</option>";

                        console.log(returnDataFromController);

                         var JSONdata=returnDataFromController,
                            obj = JSON && JSON.parse(JSONdata) || $.parseJSON(JSONdata);
                            alert(obj);
 } 
```

但我收到一条错误消息

```
[18:34:52.826] SyntaxError: JSON.parse: unexpected character @ http://myserver/myapp/index.php/controller/getbranches:102 
```

第 102 行是：

```
obj = JSON && JSON.parse(JSONdata) || $.parseJSON(JSONdata); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T18:36:07.487

问题是来自控制器的数据是格式错误的 JSON。

请注意我的帖子中显示返回数据的部分：

```
 ({'2.5':"Admin1", '2.10':"Admin2"}) 
```

2.5 应该用双引号而不是单引号。我不明白这是如何/为什么会发生的，但我会创建另一个帖子来处理这个问题。谢谢大家。

# javascript - WordPress 中的 Ajax 调用会导致不需要的页面重新加载并中止 fancybox 演示

> ID：12484616
> 
> 赞同：1
> 
> 时间：2012-09-18T20:37:37.307
> 
> 标签：javascript, wordpress, jquery

用户完成一个测验表格并点击“分数测验”链接。想要的是计算分数，通过 jQuery ajax 调用将结果发送到服务器，以及呈现用户通知的花式框。

正在发生的事情是计数完成并启动 ajax 调用并重新加载页面。如果我注释掉 ajax 调用，fancybox 会根据需要出现。使用 WordPress 3.4.2。

可能会发生什么？

```
 jQuery('#checkQuiz').click(function(){
        var ajaxurl = '<?php echo admin_url('admin-ajax.php'); ?>';
        // tally correct answers
        var quizData = tallyScore();
        // display user notice
        jQuery('a#hiddenAnchor').trigger('click');
        // store the data while the user is reading the results display
        jQuery.ajax({
            type:"post", 
            url:ajaxurl, 
            data:quizData
        });
        return false;
    }); 
```

注意 1：我能够在 Firebug 控制台中发现一个错误：

```
NS_ERROR_XPC_NOT_ENOUGH_ARGS: Not enough arguments [nsIDOMLocation.replace] 
```

报告的文件是 jQuery.js，似乎是 1.7.2 版本。我注意到 jQuery 当前版本是 1.8.1。我想知道这是否是问题的一部分。

注意 2：我忘了提到此代码是子主题中页面模板的一部分。在 Web 应用程序的其他页面上进行的类似 ajax 调用工作正常。我在[Wordpress.org 故障排除论坛](http://wordpress.org/support/topic/jquery-ajax-call-fails-on-ns_error_xpc_not_enough_args?replies=1)上添加了一个帖子，以防有人不访问 stackoverflow。

注意 3：我使用 wordpress “twentyeleven”的标准主题对此进行了测试。发生了同样的错误。我用完了可供测试的选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:49:35.183

你应该试试：

```
jQuery('#checkQuiz').click(function(e){
    var ajaxurl = '<?php echo admin_url('admin-ajax.php'); ?>';
    // tally correct answers
    var quizData = tallyScore();
    // display user notice
    jQuery('a#hiddenAnchor').trigger('click');
    // store the data while the user is reading the results display
    jQuery.ajax({
        type:"post", 
        url:ajaxurl, 
        data:quizData
    });
    e.preventDefault()
    return false;
}); 
```

使用`e.preventDefault`应该阻止页面重新加载。

请注意，我对您的代码进行了两次更改。我添加`e`到您的回调函数的参数列表和`e.preventDefault`该函数的末尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-22T16:17:03.137

经过测试和分解涉及的代码，发现错误是在传入ajax调用的数据数组中。为了帮助任何寻求类似错误答案的人，这是我在代码中找到的。

quizData 是为 WordPress ajax 处理程序构建的数组。

**找到的代码**

```
var quizData = {
    action: 'save_quiz',
    item: invoice_item,
    lesson: jQuery("#lesson"),
    score: ratio }; 
```

这段代码有两个问题。首先，jQuery 调用将一个 jQuery*对象*分配给数组值元素“课程”。这会在创建错误条件的数组中产生一个“未定义”值。这里缺少的是“.val()”函数调用。

第二个可能是项目的代码架构，但似乎数组汇编块中的 jQuery 调用无法按预期工作。在我的测试中，数据数组包含一个空值。

**解析度**

```
var lesson_id = jQuery("#lesson").val();
var quizData = {
    action: 'save_quiz',
    item: invoice_item,
    lesson: lesson_id,
    score: ratio }; 
```

我希望这可以帮助别人。

# eclipse - 如何为 Eclipse PDE 安装源代码/javadoc？

> ID：12484617
> 
> 赞同：7
> 
> 时间：2012-09-18T20:37:38.353
> 
> 标签：eclipse, eclipse-plugin, jface

[我已经通过http://download.eclipse.org/releases/juno](http://download.eclipse.org/releases/juno)更新站点在我的 Eclipse 3.8 上安装了插件开发环境 。现在在“插件依赖项”树下的 PDE 项目中，我看到所有 PDE JAR 都将源设置附加到相同的 JAR。然而，JAR 不包含任何源 - 只有类文件。

正因为如此，我看不到 PDE/JFace 类的 Javadoc，并且为自动生成的代码获得了丑陋的 arg0、arg1 等。

在哪里以及如何获取 PDE/JFace 的源代码或 Javadoc？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-24T18:15:59.803

首先，我试图重现您的问题。

*   从您提供的位置下载 Eclipse Platform Runtime Binary
*   已安装插件开发工具 -> 既不是源代码也不是 Javadocs

现在，以下对我有用：

*   帮助 -> 安装新软件
*   使用“Eclipse 项目更新”（不是 Juno 主站点！）
*   安装了“Eclipse RCP 插件开发人员资源”

这为我提供了新创建的“Hello World”插件项目中所有插件依赖项的源代码和 Javadocs。Eclipse 安装的大小仅增加了 10 MB，总大小为 116 MB。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-21T17:22:26.057

谢谢 tobias_k，

这很好用，但除此之外，我还必须安装这些资源以获取[IFolder](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/resources/IFolder.html) javadoc，例如：

*   **Eclipse 平台 SDK**
*   **PDE/API 工具环境描述**

我的 Eclipse 发行版中没有安装它。希望这对某人有帮助！

# windows-8 - 在 Blend 2012 中以设计模式查看示例数据的位图图像

> ID：12484620
> 
> 赞同：0
> 
> 时间：2012-09-18T20:37:52.397
> 
> 标签：windows-8, bitmapimage, design-time-data, blend-2012

有没有办法创建一个 BitmapImage 作为要在 Blend 2012 Metro Store App（在 Windows 8 上）中使用的示例数据？

我有一个 ViewModel 如下：

```
public ItemDesignDataVM()
{
   WebThumbnail = new BitmapImage(new Uri(???));
}

public string ItemId { get { return "123456"; } }
public BitmapImage WebThumbnail { get; private set; } 
```

并希望像这样在 Xaml 中绑定到它：

```
<Page.Resources>
  <DesignData:ItemDesignDataVM x:Key="ItemDesignDataVM" />
</Page.Resources>

<TextBox Text="{Binding ItemId}" />
<Image Source="{Binding WebThumbnail}" /> 
```

问题是，无论我将什么传递给 BitmapImage 构造函数，它都无法创建。我也尝试了各种不同的相对路径和绝对路径。

如果我附加到 XDesProc.exe 进程并调试该代码路径，则 BitmapImage.PixelHeight 和 PixelWidth 为 0，我认为这意味着它们尚未加载。

我的绑定是正确的，因为我看到设计器中出现了 ItemId。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:22:44.420

我不知道这是实际代码还是伪代码，但我发现您发布的内容存在一些问题。

首先，您的 WebThumbnail 属性不支持更改通知。由于该属性是在构造函数中设置的，因此您应该没问题，但是如果您稍后决定异步执行此操作，则可以在绑定发生后填充该属性，并且如果没有更改通知，UI 将永远不会更新。

接下来，尽管您已将 ViewModel 创建为页面资源，但我看不到您将其设置为页面的 DataContext 的任何地方。ViewModel 不一定要设置为资源，可以直接在 DataContext 或 d:DataContext 属性上设置。既然你说你看到了 ItemId，你要么有 xaml 或其他地方的代码来将此资源连接到 DataContext，或者你可能在文本框中有一个默认值？

至于为什么 PixelWidth 和 PixelHeight 为零，也许您在调用构造函数之后并且在 BitmapImage 实际上有机会异步下载图像数据之前检查它？这些值实际上可能稍后会被填写，但如果您没有正确设置页面的 DataContext，您将永远看不到图像。

如果实际情况并非如此，则您的 URL 可能存在问题。首先，在线尝试已知图像的 URL。确保 URL 在您的浏览器中有效，然后在代码中尝试。如果 URL 用于本地文件，则需要使用特殊前缀，例如**ms-appx:///**如果文件嵌入在您的项目中，则**ms-appdata:///local/...**如果它在您的应用程序本地文件夹，**ms-appdata:///roaming/...**如果它在您的应用程序漫游文件夹等中（注意 3 个斜杠）。

希望有帮助...

# sql - SQL 超时地理查询

> ID：12484629
> 
> 赞同：1
> 
> 时间：2012-09-18T20:38:38.793
> 
> 标签：sql, tsql, sql-server-2008-r2, sql-server-profiler, sqlgeography

我在这个查询上得到一个随机/间歇性的 SQL 超时，看起来它从一个简单的查询中生成了大量的处理。这是正确的行为吗？

我有一个像这样的简单存储过程：

```
CREATE PROCEDURE [dbo].[FindClosestXNearCoordinates]
      @latitude decimal,
      @longitude decimal
   AS
BEGIN

SET NOCOUNT ON;
declare @emptyGUID uniqueidentifier
set @emptyGUID = cast(cast(0 as binary) as uniqueidentifier)
declare @radiusInMeters float
set @radiusInMeters = 3500 * 1609.344   
declare @coordinatePoint as Geography   
SET @coordinatePoint = geography::STGeomFromText('POINT(' + CAST(@longitude AS VARCHAR(20)) + ' ' + CAST(@latitude AS VARCHAR(20)) + ')', 4326)
declare @coordinateRadius as Geography
set @coordinateRadius = @coordinatePoint.STBuffer(@radiusInMeters);

select  top 1   [b].[BaseId], [b].[Code], [b].[Name], [b].[Location], [b].[TerritoryId], [b].[Latitude], [b].[Longitude]
from        XTable b
where       ( b.GeoLocation.STIntersects(@coordinateRadius) = 1 )
order by b.GeoLocation.STDistance(@coordinatePoint) asc

END 
```

我在 SQL Profiler 中捕获它，它连续显示查询和超过 188 条语句，这真的很令人困惑，因为当我在 SSMS 中运行它时，它只显示 1 次执行，但在应用程序中运行会生成 188 条子语句。：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:24:16.797

首先是 SQL Profiler。因为 Spatial 类型对 SQL Server 来说有些特殊，所以它们会产生额外的处理。它为同一个 TSQL 语句多次注册 SP:Starting 和 SP:Completed 条目，因为它只能报告 TSQL 级别的操作。你只需要忍受这个。在 SQL Server 2012 中也是如此。

关于您的查询超时，我建议用更基本的测试替换 STIntersect() ，使条件

```
where (b.longitude between @longitude-@xdelta and @longitude+@xdelta)
  and (b.latitude between @latitude-@ydelta and @latitude-@ydelta)
order by b.GeoLocation.STDistance(@coordinatePoint) asc 
```

关键是通过将米转换为十进制值来找出合适的@xdelta。转换现在让我忘记了，但谷歌是你的朋友。如果你真的需要它，你甚至可以添加 STIntersect(buffer)。

# jsp - 动态添加内容到jsp站点

> ID：12484631
> 
> 赞同：0
> 
> 时间：2012-09-18T20:38:45.503
> 
> 标签：jsp, asynchronous, queue

我正在查询数据库并从中获取结果。这些结果每个可能持续约 1 秒。我想在表格中的 HTML 页面上显示这些异步。实现这一点的最简单方法是什么？我已经考虑过一些东西，比如队列，API 写入结果，前端读取它们，只要它们被写入并将它们发布到表中。所以是一种发布者-订阅者结构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:50:43.323

对于这种方法，我会推荐 DWR。它提供了一种从 javascript 调用服务器端服务的机制，并使用 javascript 在页面中呈现结果。

[http://directwebremoting.org/dwr/index.html](http://directwebremoting.org/dwr/index.html)

这个网站上有很多简单的例子。

# python - 使用非散列键字段查询 dynamoDB（使用 boto/python）

> ID：12484635
> 
> 赞同：2
> 
> 时间：2012-09-18T20:38:58.620
> 
> 标签：python, amazon-web-services, boto, amazon-dynamodb

我正在使用带有 boto 的 dynamoDB，并且在我的表的设计/查询中遇到了一些问题。

我希望我的数据看起来像

```
+---------------------------------------+
hash_key    account_id    mykey
-----------------------------------------
1           12345         myvalue1
2           12345         myvalue2
3           12345         myvalue3
4           123456        myvalue4
+---------------------------------------+ 
```

然后检索帐户 12345 的所有数据。查看 boto 文档，我总是需要有可用的 hash_key。我知道如何查询这个标准的 SQL / MongoDB，但我找不到 boto 的解决方案。我认为这是可能的？谢谢！

**编辑：这似乎有效**

```
+---------------------------------------+
hash_key    range_key    mykey
-----------------------------------------
12345       12568        myvalue1
12345       53890        myvalue2
12345       12322        myvalue3
123456      23432        myvalue4
+---------------------------------------+ 
```

其次是

```
> res = table.query(hash_key='12345')
> for item in res:
>    print i 
```

由于我想抓取账号#12345的所有条目，不管range_key，我需要**查询**而不是**get_item**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T20:47:26.960

我会使用 account_id`hash_key`和一些`range_key`来区分它们。

在 DynamoDB 中，主键由可选的 ( `hash_key`, `range_key`)组成。`range_key`这个元组必须是唯一的。请注意，您将需要整个元组来访问给定的元素`get_item`。

拥有“auto_increment”`hash_key`是 SQL 世界的一个坏习惯。

如果您想了解更多关于这个主题的信息，我在 dynamodb-mapper 文档中写了一些关于建模数据的背景知识：http: [//dynamodb-mapper.readthedocs.org/en/latest/api/model.html#auto-increment -何时使用](http://dynamodb-mapper.readthedocs.org/en/latest/api/model.html#auto-increment-when-to-use)

# regex - 用于搜索和替换的正则表达式，仅在 n 个匹配后开始

> ID：12484636
> 
> 赞同：0
> 
> 时间：2012-09-18T20:38:59.357
> 
> 标签：regex, perl, awk

我想搜索和替换一个简单的字符串，仅在每行有这么多匹配之后才开始，例如：

n=2 的 s/ZZ/YY

```
xxxZZxxxxxxZZxxxxZZxZZxxxxZZ
xZZxxxZZxxZZxxZZxZZxxxZZxxx
... 
```

进入：

```
xxxZZxxxxxxZZxxxxxYYxxxxYY
xZZxxxZZxxYYxxYYxYYxxxYYxxx
... 
```

在我的问题中，连续的“ZZ”之间总会有一个“x”。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T21:15:08.337

我建议一个可执行的替换字符串，它可以让你计算到目前为止看到的匹配数

这段代码演示

```
use strict;
use warnings;

while (<DATA>) {
  my $n = 0;
  s/(ZZ)/$n++ < 2 ? $1 : 'YY'/eg;
  print;
}

__DATA__
xxxZZxxxxxxZZxxxxZZxZZxxxxZZ
xZZxxxZZxxZZxxZZxZZxxxZZxxx 
```

**输出**

```
xxxZZxxxxxxZZxxxxYYxYYxxxxYY
xZZxxxZZxxYYxxYYxYYxxxYYxxx 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T20:57:32.960

可能有向后看的解决方案，或者反向字符串和向前看并再次反向的解决方案（如果有，我会支持它们），但我通常会找到解决`while`方案更容易发现，并且可以说更容易阅读。

```
1 while $string =~ s/(ZZ.*ZZ.*)ZZ/$1YY/ 
```

也就是说，虽然字符串包含三种`ZZ`模式，但将第三种模式替换为`YY`.

作为一般解决方案：

```
$expr = (quotemeta($pattern1) . ".*") x $n;
1 while $string =~ s/($expr)\Q$pattern2\E/$1$pattern2/; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T21:25:49.067

It seems like the simplest perl solution *should* be: `1 while s/ZZ/YY/3`, but perl does not accept that. So do the same with `sed`:

```
sed ':a
  s/ZZ/YY/3
  ta' 
```

Some implementations of `sed` allow this to be written more simply: `sed ':a; s/ZZ/YY/3; ta'`, and I believe it is fully portable to write: `sed -e :a -e s/ZZ/YY/3 -e ta`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-19T13:46:17.557

```
1 while $thisline=~s/((?:x*?ZZx*?){2}[xZY]*?)ZZ/$1YY/; 
```

That is a solution for n=2.

You can just change the number there for other values of n.

Also, I optimized the substitution with lazy matching and by doing away with superfluous capturing.

# java - 为什么当我把它变成负数时这个值不会改变？

> ID：12484639
> 
> 赞同：0
> 
> 时间：2012-09-18T20:39:15.940
> 
> 标签：java, object

我正在尝试编写一个 Rational 类，它有一些与加法、减法等相关的方法。我想在构造函数中将值添加到私有变量并找到 GCD 以找到简化分数。我遇到的问题是我的 if 语句。我想检查对象参数中的数字是否为负，所以我使用 if 语句进行检查。唯一的问题是当我运行程序时，它没有给我一个负值，即我有 Rational p = new Rational(-24, 48)，它只返回 1/2。

```
public class TestRational {

    public static void main(String... args) {
        Rational p = new Rational(-24, 48);
    }

    public Rational(long a, long b){
        numerator = a;
        denominator = b;
        boolean isNegative = false;
        if (numerator*denominator < 0)
            isNegative = true;
        long gd = gcd(numerator, denominator);
        numerator /= gd;
        denominator /= gd;
        if (isNegative)
            numerator = -numerator;;
    }

    private long gcd(long p, long q){
        //checks to see if numerator greater than denominator
        if(p<q)
            return gcd(q,p);
        if(Math.abs(q) == 0)
            return p;
        long remainder = Math.abs(p)%Math.abs(q);
        return gcd(Math.abs(q), Math.abs(remainder));
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T20:42:54.693

你不需要这个

```
if (isNegative)
 numerator = -numerator;; 
```

所以构造函数变成

```
public Rational(long a, long b){
 numerator = a;
 denominator = b;
 boolean isNegative = false;
 if (numerator*denominator < 0)
 isNegative = true;
 long gd = gcd(numerator, denominator);
 numerator /= gd;
 denominator /= gd;
} 
```

希望它有效...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:50:02.893

除非您的问题明确要求您使用 GCD 并且 and 的范围`a`不大`b`，否则您可以简单地使用循环来实现它：

```
public Rational(long a, long b){
    boolean isNegative = a < 0 || b < 0;
    a = Math.abs(a);
    b = Math.abs(b);
    for (int i = min(a, b); i >= 2; --i)
        if (a % i == 0 && b % i == 0)
        {
            a /= i;
            b /= i;
        }
    numerator = isNegative ? -a : a;
    denominator = b;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:16:35.977

我想在您的代码中指出一些“可避免的错误”。

1.  构造函数的名称必须与类的名称相同。**在你的情况下，它不是**。
2.  **if{ statements}**使用块，即使它包含单个语句。
3.  你没有声明局部变量**分子**和**分母的类型**
4.  你在说什么**私有变量**？

发布时多注意代码，它将帮助您获得问题的*良好*答案

# java - 我的正则表达式在单词后出现空格，不应该

> ID：12484647
> 
> 赞同：0
> 
> 时间：2012-09-18T20:40:10.460
> 
> 标签：java, regex

我有一个应该捕获大写单词的正则表达式。因此，如果有一个或多个单词都是大写的，则正则表达式会找到它。但我还有另一个正则表达式，它捕获一个单词全部大写的单词。出于某种原因，第一个 reg ex 捕获了一个全大写的单词，最后有一个空格。这是我的代码。

```
 //This looks for All Cap Words inside parens-completed
    String ucParensRegEx = "\\([A-Z]+\\)";
    regexParser(we, ucParensRegEx);
    //This looks for All Upper case words with two or more letters.- completed
    String twoPlusUCRegEx = "[A-Z][A-Z]+";
    regexParser(we, twoPlusUCRegEx);

    String letNumRegEx = "[A-Z][A-Z0-9][A-Z]+";
    regexParser(we, letNumRegEx);

    //Looks for Uppercase words that start with a number-Completed
    String numLetRegEx = "[0-9][A-Z][A-Z]+";
    regexParser(we, numLetRegEx);

    String upperwhitespaceRegEx = "(\\b[A-Z'][A-Z]+\\b\\s*)+";
    regexParser(we, upperwhitespaceRegEx);

private void regexParser(WordExtractor we, String regex) {
    if (we.getParagraphText() != null) {
        String[] dataArray = we.getParagraphText();

        for (int i = 0; i < dataArray.length; i++) {
            String data = dataArray[i].toString();
            Pattern p = Pattern.compile(regex);
            Matcher m = p.matcher(data);
            while (m.find()) {
                if (!sequences.contains(data.substring(m.start(), m.end())) && !data.equals("US ") && !data.contains("ARABIC") && !data.contains("ALATEC") && !data.contains("HYPERLINK")) {
                    sequences.add(data.substring(m.start(), m.end()));
                    System.out.println(data.substring(m.start(), m.end()));
                    Acronym acc = new Acronym(data.substring(m.start(), m.end()), data, "", false);
                    newAcList.add(acc);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:30:15.883

```
"\\b[A-Z'][A-Z]+(\s+[A-Z'][A-Z]+)*\\b" 
```

内部单词边界是不必要的（因为`\s[A-Z]`在空格和大写字母之间定义了单词边界）。所以你需要做的就是匹配一个大写单词，然后可选地匹配一堆其他的大写单词。

# c - Realloc 始终失败（在 C 中）

> ID：12484652
> 
> 赞同：1
> 
> 时间：2012-09-18T20:40:31.120
> 
> 标签：c, realloc

添加 25 个字符后，Realloc 始终失败。

错误：

ld.so 检测到的不一致：dl-minimal.c: 116: realloc: Assertion `ptr == alloc_last_block' 失败！

```
char** linePtr = getLinePtr(block, y);
char* tmpPtr = realloc(*linePtr, (strlen(*linePtr) + 1) * sizeof(char));
if (tmpPtr != NULL) {
    *linePtr = tmpPtr;
    strinsert(tmpPtr, ch, x);
} 
```

我之前检查了变量，一切似乎都很好。`*linePtr`指向一个24个字符的字符串，`strlen(*linePtr)`返回24。返回的地址`realloc`总是一样的。

没有硬编码的数字，所以我不知道为什么它总是在相同数量的字符后失败。

`*linePtr`是 1 一开始只有一个字节，现在我每次都重新分配一个额外的字节。

编辑：

```
char** getLinePtr(Block* block, int y)
{
    assert(y >= block->start && y <= block->start + block->nb_lines);

    if (y == block->start + block->nb_lines) {
        block->lines = realloc(block->lines, (block->nb_lines + 1) * sizeof(char*));
        *(block->lines + block->nb_lines) = malloc(sizeof(char));
        block->nb_lines++;
    }
    return block->lines + block->nb_lines - 1;
} 
```

编辑2：

通过粘贴代码，我意识到 getLinePtr 中存在一个错误：它返回最后一行而不是所要求的那一行（使用 y），但它不应该对此错误进行任何更改。并且只使用第一行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:45:20.240

问题似乎很可能是传递给`realloc`的指针不是`realloc`or返回的指针`malloc`。显示的代码中缺少几部分可以​​确定地知道这一点。但是您应该验证它`getLinePtr`正在返回一个“指向已分配指针的指针”（我并不是说这是一种很好的方法，但这就是它在所示代码中的使用方式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:46:42.783

问题是我需要重新分配 (strlen(*linePtr) + 2) 而不是 (strlen(*linePtr) + 1)。

strlen 返回没有终止空字符的字符串的大小。所以我需要为它添加 1，并且我需要为要添加的字符添加 1。

感谢 Daniel Fisher 的提示。

# c# - 让用户在 Metro 应用程序中更改字体

> ID：12484655
> 
> 赞同：0
> 
> 时间：2012-09-18T20:40:44.097
> 
> 标签：c#, .net, fonts, microsoft-metro

你知道如何在 WinForms 中打开字体对话框或字体浏览器（我不记得了）并让用户决定他们想要读/写的字体，以及大小和可选的颜色/粗细等吗？

我们如何在 Metro Apps 中做到这一点？显然，有些字体比其他字体更容易阅读，所以只有让他们改变它才有意义。

但我在文档中没有看到任何关于此的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:44:34.327

如果您想从 Metro 应用程序中获取可用字体列表，我相信您必须使用 DirectWrite。

请参阅（Microsoft 示例）：[http ://code.msdn.microsoft.com/windowsapps/DirectWrite-font-60e53e0b](http://code.msdn.microsoft.com/windowsapps/DirectWrite-font-60e53e0b)

# apache-flex - Flex Mobile s：列表项单击标注

> ID：12484660
> 
> 赞同：0
> 
> 时间：2012-09-18T20:40:57.777
> 
> 标签：apache-flex, flex4.5, flex-mobile

灵活的家伙 我有一个小问题，需要 flex 专业人士的一些建议。我的 flex 移动项目中有一个 Spark List 组件，当用户单击列表项时，我添加了一个 Callout 组件 - 它会生成一个新的标注组件并打开它。但在我的情况下（我已经在 iPad 上测试过），当用户单击列表时它可以工作，但是当用户在列表上双击（在列表双倍处）时它会崩溃 - 这是因为当用户创建和添加事件侦听器到标注组件等时双击列表它会尝试创建一个标注，同时在触发 MOUSE_DOWN_OUTSIDE 时关闭它（在模拟器中不是这种情况，因为 CPU 性能更好）。那么我怎样才能将它构造为无错误 - 或标注的任何更好的优势来显示列表项的详细信息。这是我的代码：

```
 <fx:Script>
            <![CDATA[
                public var clInfo:Callout;

                protected function lst_tetkikler_clickHandler(event:MouseEvent):void
                {
                    if(lst_tetkikler.selectedItem != null){
                        clInfo = new Callout();
                        clInfo.width = 400;
                        clInfo.setStyle("contentBackgroundColor",0xf8eabd);

                        lbl_adet.text = lst_tetkikler.selectedItem['adet'];
                        lbl_puan.text = lst_tetkikler.selectedItem['puan'];

                        clInfo.addElement(vg_info);
                        clInfo.verticalPosition = "after";
                        clInfo.open(lst_tetkikler.dataGroup.getElementAt(lst_tetkikler.selectedIndex) as DisplayObjectContainer,true);
                        clInfo.addEventListener(FlexMouseEvent.MOUSE_DOWN_OUTSIDE, closeComponent);
                    }

                }

                protected function closeComponent(event:FlexMouseEvent):void
                {
                    if(clInfo){
                        clInfo.removeEventListener(FlexMouseEvent.MOUSE_DOWN_OUTSIDE, closeComponent);
                        clInfo.close(); 
                        clInfo = null;
                    }
                }

            ]]>
        </fx:Script>

    <s:List id="lst_tetkikler" width="100%" height="50%" 
                dataProvider="{listTetkik}" contentBackgroundAlpha="0" 
                visible="{!(listTetkik.length==0)}" 
                labelField="tetAdi" color="#314F83" 
                click="lst_tetkikler_clickHandler(event)"
                >
        </s:List> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T05:14:06.413

我已经解决了在**CalloutButton**组件下添加所有标注内容的问题 - 似乎 Adob​​e 团队仅在标注按钮案例中考虑了这种情况 -**像上述场景一样动态创建标注会崩溃**。

# c++ - 如何使用 Qt QGraphicsitem 设计轴

> ID：12484661
> 
> 赞同：1
> 
> 时间：2012-09-18T20:40:59.013
> 
> 标签：c++, qt

我想实现一个坐标轴。我想做的是：

*   当我拖动这个轴的最头点时，只有轴的长度会随着鼠标移动而改变。
*   当我拖动这个轴的主体时，只会改变轴的方向。

怎么做？我认为，我可以使用两个 QgraphicsItems （**head**，**body**）来表示一个轴。当**头部**拖动时，进行缩放。当**身体**拖动时，它会旋转。

有没有更好的解决方案来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:55:39.673

您可以将其作为一个图形项进行，拖动行为会根据您单击的位置而变化，但您的建议是合理的。

对于您的方法，箭头需要是箭头主体的子项 - 因此，当您旋转主体时，它会适当移动，并且您需要在鼠标单击/鼠标移动事件中自定义 hack 以调整箭头大小身体适当。

# python - 在 Mac OS X 10.8.1 上安装 lxml 时我做错了什么？

> ID：12484664
> 
> 赞同：8
> 
> 时间：2012-09-18T20:41:04.530
> 
> 标签：python, macos, installation, lxml

我正在 Mac OS X 10.8.1 和 Python 2.7.2 上构建 lxml 并遇到问题。（我已经克隆了 Github 存储库并在此处按照 Mac OS X 的说明进行操作：http: [//lxml.de/build.html](http://lxml.de/build.html)）

似乎在构建 libxml2 时有些问题；以下是终端输出的尾端：

```
configure: creating ./config.status
config.status: creating libxml2.spec
config.status: creating Makefile
config.status: creating include/Makefile
config.status: creating include/libxml/Makefile
config.status: creating doc/Makefile
config.status: creating doc/examples/Makefile
config.status: creating doc/devhelp/Makefile
config.status: creating example/Makefile
config.status: creating python/Makefile
config.status: creating python/tests/Makefile
config.status: creating xstc/Makefile
config.status: creating include/libxml/xmlversion.h
config.status: creating xml2-config
config.status: creating libxml-2.0.pc
config.status: creating libxml-2.0-uninstalled.pc
config.status: creating python/setup.py
config.status: creating config.h
config.status: executing depfiles commands
config.status: executing libtool commands
rm: libtoolT: No such file or directory
Done configuring
make  all-recursive
Making all in include
Making all in libxml
make[3]: Nothing to be done for `all'.
make[3]: Nothing to be done for `all-am'.
Making all in .
  CC     error.lo 
```

[剪断]

```
 CC     hash.lo
parser.c: In function 'xmlParseInNodeContext':
parser.c:13492: warning: pointer targets in passing argument 1 of 'xmlFindCharEncodingHandler' differ in signedness
  CC     list.lo 
```

[剪断]

```
 CC     xpointer.lo
xpath.c: In function 'xmlXPathRegisterFuncNS':
xpath.c:4870: warning: ISO C forbids passing argument 4 of 'xmlHashAddEntry2' between function pointer and 'void *'
xpath.c: In function 'xmlXPathFunctionLookupNS':
xpath.c:4951: warning: ISO C forbids assignment between function pointer and 'void *'
xpath.c: In function 'xmlXPathCompOpEval':
xpath.c:13535: warning: ISO C forbids assignment between function pointer and 'void *'
xpath.c:13562: warning: ISO C forbids assignment between function pointer and 'void *'
xpath.c: At top level:
trionan.c:221: warning: 'trio_is_negative' defined but not used
  CC     xinclude.lo 
```

[剪断]

```
 CC     xmlstring.lo
threads.c: In function 'xmlCleanupThreads':
threads.c:918: error: expected expression before '{' token
make[2]: *** [threads.lo] Error 1
make[2]: *** Waiting for unfinished jobs....
make[1]: *** [all-recursive] Error 1
make: *** [all] Error 2
Traceback (most recent call last):
  File "setup.py", line 225, in <module>
    **setup_extra_options()
  File "setup.py", line 139, in setup_extra_options
    STATIC_CFLAGS, STATIC_BINARIES)
  File "/Users/jedc/Downloads/lxml/setupinfo.py", line 57, in ext_modules
    multicore=OPTION_MULTICORE)
  File "/Users/jedc/Downloads/lxml/buildlibxml.py", line 338, in build_libxml2xslt
    cmmi(libxml2_configure_cmd, libxml2_dir, multicore, **call_setup)
  File "/Users/jedc/Downloads/lxml/buildlibxml.py", line 266, in cmmi
    cwd=build_dir, **call_setup)
  File "/Users/jedc/Downloads/lxml/buildlibxml.py", line 249, in call_subprocess
    raise Exception('Command "%s" returned code %s' % (cmd_desc, returncode))
Exception: Command "make -j5" returned code 512 
```

我试图找出这里出了什么问题，这远远超出了我的深度。 **谁能指出我需要做些什么来解决这个问题？**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-18T23:45:18.563

这是 libxml2 2.9 中的一个错误。

你得到的错误是在这一行：

```
once_control = PTHREAD_ONCE_INIT; 
```

那是非法代码，恰好在linux上工作。`PTHREAD_ONCE_INIT`只能用于初始化，不能用于赋值，并且有一个特定的原因：因此平台可以定义`PTHREAD_ONCE_INIT`为聚合初始化器。OS X 可以。从 10.8.1 开始`/usr/include/pthread.h`：

```
#define PTHREAD_ONCE_INIT {_PTHREAD_ONCE_SIG_init, {0}} 
```

看起来这已经在几天前被报告到 libxml2 邮件列表（https://mail.gnome.org/archives/xml/2012-September/msg00036.html），两天后在 bugzilla 中提交（https:// /bugzilla.gnome.org/show_bug.cgi?id=684024），并在第二天修复（http://git.gnome.org/browse/libxml2/commit/?id=3f6cfbd1d38d0634a2ddcb9a0a13e1b5a2195a5e），所以大概 2.9.1 会没有这个问题。

因此，这是您的选择：

当然你可以等待 2.9.1 出来。

或者，尽管构建页面上说了什么，Mountain Lion 附带的 libxml2 版本 2.7.8 并没有“严重过时”——它比他建议使用的 2.7.3 版本更新。因此，您可以跳过`--static-deps`并使用内置的 2.7.8。

如果您确实想要比 2.7.8 更新的东西，但不像（非工作）2.9.0 那样新，构建页面会显示如何明确指定它，并且[http://www.xmlsoft.org](http://www.xmlsoft.org)应该有版本历史某处，因此您可以选择所需的版本。例如：

```
python setup.py build --static-deps \
   --libxml2-version=2.8.0 
```

[或者您可以从http://git.gnome.org/browse/libxml2/commit/?id=3f6cfbd1d38d0634a2ddcb9a0a13e1b5a2195a5e](http://git.gnome.org/browse/libxml2/commit/?id=3f6cfbd1d38d0634a2ddcb9a0a13e1b5a2195a5e)手动应用补丁并手动构建它，或者拉树的顶部而不是版本 2.9.0，构建它，然后然后告诉 lxml 使用该构建。

将来，如果您不想处理调试构建，我建议只使用 pip 安装 Python 包，并使用 Homebrew 安装任何缺少的依赖项。您可能并不总是获得所有最新版本的理想构建，但它会容易得多，而且通常足够好。

# sql - 如何在表格上进行双重比较

> ID：12484674
> 
> 赞同：3
> 
> 时间：2012-09-18T20:41:38.820
> 
> 标签：sql, tsql

我需要将一列 LeadDate （数据类型为 datetime ）与保存在另一个表（名为 EmployeeWorkTime）中的值进行比较。LeadDate 列的格式类似于“2006-08-08 11:50:51.000”。

员工工作时间表是这样的：

```
SyStaffId       Associate Name           Monday    Tuesday  Wednesday Thursday   Friday    Saturday        Sunday
34128           Natasha Dawson            0919      0918      0920      0918      0918      WKEND           WKEND    
34169           Elaine Bueno              0918      1019      0918      1019      0918      WKEND           WKEND    
34385           Aida Rodriguez            0918      1019      0918      1019      0918      WKEND           WKEND    
34419           Sy Lim                    1019      1019      1019      1019      0918      WKEND           WKEND 
```

我创建了一个视图并包含了比较所需的所有字段。新视图如附件所示。但是当我想将提前期与时间列中的值进行比较时。我遇到了一些困难。由于提前期不同，它们位于 DayofWeekName 列中，我想将提前期与仅与提前期相同的一列进行比较。我怎么能那样做？

例如，对于第一个潜在客户，dayofweekname 是 Thursay，我想将 Leadtime 列作为周四列的 Leadtime 列，我该如何编写代码来实现它。

非常感谢。

用于创建新视图的命令：

```
Create View dbo.cstAdmissionDailyReportLeadCount_jy
AS
SELECT     dbo.syStudent.AmRepID, dbo.syStudent.LeadDate, DATEPART(dw, syStudent.LeadDate) AS DayofWeekNumber, DATEPART(hh, syStudent.LeadDate)
                      AS LeadHour, dbo.EmployeeWorkTime.[Associate Name], DATENAME(dw, syStudent.LeadDate) AS DayofWeekName, EmployeeWorkTime.Monday,
                      EmployeeWorkTime.Tuesday, EmployeeWorkTime.Wednesday, EmployeeWorkTime.Thursday, EmployeeWorkTime.Friday,
                      EmployeeWorkTime.Saturday, EmployeeWorkTime.Sunday, CASE WHEN DATEPART(hh, syStudent.LeadDate)
                      < 18 THEN 1 ELSE 0 END AS CountAsEffectiveLead
FROM         dbo.syStudent INNER JOIN
                      dbo.EmployeeWorkTime ON dbo.syStudent.AmRepID = dbo.EmployeeWorkTime.SyStaffId 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:05:55.153

将此添加到您的选择子句有帮助吗？

```
case when DATENAME(dw, syStudent.LeadDate) = "Monday" then EmployeeWorkTime.Monday
when DATENAME(dw, syStudent.LeadDate) = "Tuesday" then EmployeeWorkTime.Tuesday
when DATENAME(dw, syStudent.LeadDate) = "Wednesday" then EmployeeWorkTime.Wednesday
when DATENAME(dw, syStudent.LeadDate) = "Thursday" then EmployeeWorkTime.Thursday
when DATENAME(dw, syStudent.LeadDate) = "Friday" then EmployeeWorkTime.Friday
when DATENAME(dw, syStudent.LeadDate) = "Saturday" then EmployeeWorkTime.Saturday
else EmployeeWorkTime.Sunday end as ewt_day 
```

# haskell - GHCi 中的缩进错误，实现过滤器

> ID：12484675
> 
> 赞同：3
> 
> 时间：2012-09-18T20:41:41.333
> 
> 标签：haskell

```
Prelude> let filter' p (x:xs) | p x = x : filter' p xs | otherwise = filter' p xs
Prelude> let filter' _ [] = []
Prelude> filter' odd [1..10]
*** Exception: <interactive>:1:5-21: Non-exhaustive patterns in function filter' 
```

我错过了什么模式？

```
Prelude> :{
Prelude| let filter' p (x:xs)
Prelude|     | p x              = x : filter' p xs
Prelude|     | otherwise        = filter' p xs
Prelude| let filter' _ []       = []
Prelude| :}

<interactive>:2:5: parse error (possibly incorrect indentation) 
```

在 ghci 中定义这个（语法方面）的惯用方式是什么？排队是`=`怎么回事 - 在我定义它们之前，我不知道要为以下子句留多少空间！:{}: 是怎么回事，有更好的方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T21:02:32.633

这里有两个问题。首先，使用多个`let`语句是在做出两个独立的定义，后者遮蔽了前者。其次，语法错误的原因是你没有足够的缩进你的警卫（该`| px ...`行应该缩进比 更远`filter' p (x:xs)`）。

尽管将定义保存在文件中更简单，但以下是在 GHCi 中正确输入定义的方法。

```
Prelude> :{
Prelude| let filter' p (x:xs)
Prelude|      | p x       = x : filter' p xs
Prelude|      | otherwise = filter' p xs
Prelude|     filter' _ [] = []
Prelude| :} 
```

和命令用于输入跨越多行的定义`:{`。`:}`对齐`=`是可选的，重要的是行的缩进。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T20:45:57.557

不要在 ghci 提示符下编写函数 - 将它们保存在`MyFunctions.hs`或其他东西中并执行

```
:l MyFunctions 
```

在 ghci 中。

`let`ghci 中的命令会删除以前的定义，所以当你这样做时

```
let filter' p (x:xs) | p x = x : filter' p xs | otherwise = filter' p xs
let filter' _ [] = [] 
```

您实际上是在`let filter' p (x:xs) | p x = x : filter' p xs | otherwise = filter' p xs`完全删除该定义以将其替换为`let filter' _ [] = []`.

这`Non-exhaustive patterns`意味着您在 [1..10] 上使用了不为空的过滤器的第二个定义，而您的过滤器的第二个版本仅涵盖空列表！

您的定义很好，效果很好，没有缩进错误，虽然`filter'' p (x:xs) | p x = x : filter' p xs | otherwise = filter' p xs`很丑。我意识到你试图用 ghci 写一个单行，但是文本编辑器 + ghci + [http://www.haskell.org/hoogle/](http://www.haskell.org/hoogle/)是一个强大的组合！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T20:49:52.213

要详细说明 Andrew 的答案，请考虑以下 ghci 会话。

```
Prelude> let x = 1
Prelude> let x = 2
Prelude> x
2 
```

也就是说，`let`ghci 中的表达式引入了一个新变量并隐藏了旧定义。正如 Andrew 建议的那样，只需将您的定义保存到文件中即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T21:02:33.847

正如其他答案所指出的，每次您`let`在 GHCi 中有一个新语句时，它都会覆盖以前的定义。但是，您仍然可以通过将定义放入一个`let`语句中来使用模式匹配。基本上有两种方法可以做到这一点。

首先，只需使用分号：

```
let filter' p [] = []; filter' p (x:xs) | p x = x : filter' p xs | otherwise = filter' p xs 
```

其次，使用`:{ ... :}`和缩进。

```
:{
let filter' _ [] = []
    filter' p (x:xs)
      | p x = x : filter' p xs
      | otherwise = filter' p xs
:} 
```

（我省略了提示以便于复制粘贴。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-15T20:59:21.887

除了 [Hammar's answer](https://stackoverflow.com/a/12484990/1060693)之外，您还可以设置“允许多行命令”：

```
Prelude> :set +m 
```

您可以在没有`:{`和`:}`之后编写多行定义。一个空行将完成一个块

```
Prelude> let filter' p (x:xs)
Prelude|      | p x       = x : filter' p xs
Prelude|      | otherwise = filter' p xs
Prelude|     filter' _ [] = []
Prelude|
Prelude> 
```

如果要切换回单行模式，请运行`unset`：

```
Prelude> :unset +m 
```

# jquery - 需要有关从 ajax jquery 调用返回的 xml 对象的更多信息

> ID：12484676
> 
> 赞同：0
> 
> 时间：2012-09-18T20:41:41.563
> 
> 标签：jquery, xml, ajax

我正在使用 Jquery 来调用 Wea​​ther Underground XML api。在浏览器中准备好文档时我定义的功能下方。很简单的东西。我很好奇的一件事是当我使用设置为“xml”的 dataType 时返回的 xml 对象。我看到很多例子，人们调用诸如returned_xml.find() 之类的函数来定位xml 中的特定元素。我似乎无法在 xml 对象的 api 上找到非常好的文档。任何指针？谢谢

```
$(document).ready(function () {
          jQuery.support.cors = true; // force cross-site scripting (as of jQuery 1.5)
        $.ajax(
                   {     url : "http://api.wunderground.com/api/0787878787878/geolookup/conditions/q/IA/Cedar_Rapids.xml", 
                    dataType : "xml", 
                    success : function(returned_xml) 
                    { alert("Data is " + returned_xml.xml ); 
                        },
                    error  : function(failed_data)
                    {
                        alert("failed with " + failed_data);
                    } 
                   }); 
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:18:48.103

从 jquery [jQuery.parseXML尝试这个 API](http://api.jquery.com/jQuery.parseXML/)

# jquery - jQuery 没有选择 .appended 控件/元素

> ID：12484678
> 
> 赞同：1
> 
> 时间：2012-09-18T20:41:47.433
> 
> 标签：jquery, append, selector, dynamic-controls

也许这是我的选择器语法，我不知道。当我将所有内容添加到单个语句中时，所有内容都已添加，但无法使用 jQuery 选择器选择它们。

如果我把它分开，第二个追加失败，但第一个成功。

```
$.each($.parseJSON(msg.d) , function(i){
    $("#contactsGrid").append("<tr id='contactRow." + $.parseJSON(msg.d)[i].SupplierContID + "'></tr>");
    $("#contactRow." + $.parseJSON(msg.d)[i].SupplierContID).append("<td><input type='text' id='contactLastName." + $.parseJSON(msg.d)[i].SupplierContID + "' /></td>");
}); 
```

需要能够选择动态控件。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:45:12.687

您的 ID 具有`.`需要转义的特殊字符。

```
$("#contactRow\\." +... 
```

但是，无论如何最好在 1 行中执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:46:57.317

句点是选择器中的特殊字符，您需要对其进行转义：

```
$("#contactRow\\." + $.parseJSON(msg.d)[i].SupplierContID) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:51:27.123

我刚刚在我正在构建的另一个项目中使用的东西。我很快更改了 id 名称/元素，希望这能让您很好地了解该去哪里：

```
$.each($.parseJSON(msg.d) , function(i){
     $("#contactsGrid").append(
            $(document.createElement('tr')).attr({
                'id' : "contactRow\\." + $.parseJSON(msg.d)[i].SupplierContID +
            }).append(
                $(document.createElement('td')).append({
                    $(document.createElement('input')).attr({
                       'type' : 'text',
                       'id' :  "contactLastName\\." + $.parseJSON(msg.d)[i].SupplierContID
                    })
                })
            )
         )
     )
}); 
```

# mysql - 如何加入 2 个 SQL 查询：从表中选择和从另一个表中删除？

> ID：12484680
> 
> 赞同：0
> 
> 时间：2012-09-18T20:41:52.610
> 
> 标签：mysql, sql

我有 2 张桌子：`users`&`rent`

如何`name`从表中选择`users`WHERE`unixtime`之前`2012-09-04`

**和**

从表中删除`rent`WHERE`name`来自上一个查询。

如下所示，但我不知道如何使用删除查询加入它：

```
SELECT * 
FROM  `pstone_cuboids` 
WHERE  `last_used` >= UNIX_TIMESTAMP(  '2012-09-04' ) 
```

如果我错了，请纠正我，上面是否选择了 2012 年 9 月 3 日（2 日、1 日、31 日等）之前的所有数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:44:12.003

这应该有效：

```
DELETE FROM rent WHERE name IN (
    SELECT name FROM `pstone_cuboids` 
    WHERE `last_used` >= UNIX_TIMESTAMP('2012-09-04')
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:25:41.057

您的示例具有不同的表名和列名，因此这只是一种解释：

```
DELETE r.*
FROM `rent` r JOIN `users` u ON r.name  = p.name
WHERE  r.unixtime < '2012-09-04' 
```

有关多表删除，请参阅[文档。](http://dev.mysql.com/doc/refman/5.0/en/delete.html)

# javascript - 使用 colspan 搜索行中单元格数量最多的行

> ID：12484681
> 
> 赞同：0
> 
> 时间：2012-09-18T20:41:58.257
> 
> 标签：javascript, jquery

在具有众多 colspan 的大表中搜索最多单元格的有效方法是什么（合并单元格 ** colspan 应该被忽略，因此在下面的示例中，第一行中单元格的最高数量是 4）。是带有 reg 表达式的 js/jquery 还是带有冒泡排序的循环。我得到了一个链接，如下所示，说明使用正则表达式是否是理想的方式...有人可以为此建议伪代码吗？

[由于 jquery 正则表达式补丁，CPU 消耗高](https://stackoverflow.com/questions/8990653/high-cpu-consumption-due-to-a-jquery-regex-patch)

```
<table width="156" height="84" border="0" >
    <tbody>
        <tr style="height:10px">
            <td width="10" style="width:10px; height:10px"/>
            <td width="10" style="width:10px; height:10px"/>
            <td width="10" style="width:10px; height:10px"/>
            <td width="10" style="width:10px; height:10px"/>
        </tr>
        <tr style="height:10px">
            <td width="10" style="width:10px; height:10px" colspan="2"/>
            <td width="10" style="width:10px; height:10px"/>
            <td width="10" style="width:10px; height:10px"/>
        </tr>
        <tr style="height:10px">
            <td width="10" style="width:10px; height:10px"/>
            <td width="10" style="width:10px; height:10px"/>
            <td width="10" style="width:10px; height:10px" colspan="2"/>
        </tr>
        <tr style="height:10px">
            <td width="10" style="width:10px; height:10px" colspan="2"/>
            <td width="10" style="width:10px; height:10px"/>
            <td width="10" style="width:10px; height:10px"/>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:49:36.540

```
var rowWithMaxCells = $("tr").get().reduce(function(a, b) {
    return a.children.length > b.children.length ? a : b;
});

console.log(rowWithMaxCells); 
```

[例子](http://jsfiddle.net/M58sX/)

**编辑**

```
function getRowWithMaxCells(table) {
    var rows = table.getElementsByTagName("tr"),
        i = rows.length,
        maxIdx = -Infinity,
        curMax = -Infinity;

    while (i--) {
        if (curMax <= rows[i].children.length) {
            curMax = rows[i].children.length;
            maxIdx = i;
        }
    }

    return rows[maxIdx];
} 
```

只是为了完整起见，应该在所有浏览器中工作的版本:)
[示例](http://jsfiddle.net/KLTyR/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:04:37.790

我会使用[document.querySelector](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelector)来解决这个问题。

我会做一个简单的循环并寻找`./tr/td[index]`直到它返回为`null`. 那么 max 将是`index-1`

[你可以用.getElementsByTagName](https://developer.mozilla.org/en-US/docs/DOM/element.getElementsByTagName)做类似的事情。

# c# - 在 Web 浏览器控件中使用变量

> ID：12484688
> 
> 赞同：0
> 
> 时间：2012-09-18T20:42:31.177
> 
> 标签：c#, asp.net, web

我正在开发一个 windows phone 7.1 应用程序，它将在从文本框中获取文本后通过不同的搜索引擎进行搜索。我有文本框（**searchBox**）、四个用于 bing、google、facebook 和 yahoo 的按钮以及一个 Web 浏览器控件。现在我需要将文本从文本框传递到网络浏览器。但问题是它应该是“www.bing.com?q= **textbox.text** ”的形式。我该如何实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:44:45.010

你可以调整`WebBrowser.Url`属性

链接：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.url.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.url.aspx)

或者你可以使用`Navigate`方法

```
 var address = "www.bing.com?q=" + textbox.Text;
  webBrowser1.Navigate(new Uri(address)); 
```

链接：http: [//msdn.microsoft.com/en-us/library/ms161352.aspx](http://msdn.microsoft.com/en-us/library/ms161352.aspx)

# mysql - SQL order by 标点符号在末尾的产品

> ID：12484689
> 
> 赞同：0
> 
> 时间：2012-09-18T20:42:37.633
> 
> 标签：mysql, sql, database

我们有一个产品数据库，我们需要按名称 (AZ) 对它们进行排序，但如果产品名称以标点符号开头（例如¡A tapar! 或¡Adelgaza!），它应该出现在接近末尾而不是开头。有没有办法发出这样的查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:01:45.277

如果您只是想将 AZ 推到前面，并让其他所有内容自然排序，请使用以下命令：

```
ORDER BY case when PRODUCT_NAME like '[a-Z]%' then 1 else 2 end, PRODUCT_NAME 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:49:19.050

如果您可以提取需要忽略的标点符号列表，您实际上可以使用如下语句更改 MySQL 排序依据的值：

```
ORDER BY REPLACE(product_name, "¡", "") 
```

您可以根据需要多次嵌套多个 REPLACE()。

这已经在[这里](https://stackoverflow.com/questions/12141475/mysql-sorting-with-symbols-as-first-letter)问过了。

# javascript - Apache + Passenger + Rails 3.2.5 - 生产服务器 / Javascript 不起作用

> ID：12484691
> 
> 赞同：0
> 
> 时间：2012-09-18T20:42:42.423
> 
> 标签：javascript, ruby-on-rails-3, apache, assets, passenger

亲爱的 StackOverflow 社区，

自从我开始在 Apache + 乘客服务器上部署我的 rails APP 后，我遇到了问题。但是最后一个，我找不到解决方案，希望你们能帮助我。:)

我的应用程序正在运行，但 Javascript 不能在生产模式下工作，只能在开发模式下工作。当我部署时，应用程序运行，但我的 ajax 菜单和其他 JS 功能不起作用。我用 Firebug 进行了检查，它加载了一个带有所有 javascript 的大型 application.js，一切看起来都很好，但是 JS 就是不工作。

有人可以帮忙吗？

遵循我的 Production.rb：

```
SIGMA::Application.configure do
  # Settings specified here will take precedence over those in
config/application.rb

  # Code is not reloaded between requests
  config.cache_classes = true

  # Full error reports are disabled and caching is turned on
  config.consider_all_requests_local       = false
  config.action_controller.perform_caching = false

  # Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = true

  # Compress JavaScripts and CSS
  config.assets.compress = false

  # Don't fallback to assets pipeline if a precompiled asset is missed
  #config.assets.compile = false
  config.assets.initialize_on_precompile = false

  # Generate digests for assets URLs
  config.assets.digest = false

  # Defaults to nil and saved in location specified by config.assets.prefix
  # config.assets.manifest = YOUR_PATH

  # Specifies the header that your server uses for sending files
  # config.action_dispatch.x_sendfile_header = "X-Sendfile" # for apache
  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx

  # Force all access to the app over SSL, use
Strict-Transport-Security, and use secure cookies.
  # config.force_ssl = true

  # See everything in the log (default is :info)
  # config.log_level = :debug

  # Prepend all log lines with the following tags
  # config.log_tags = [ :subdomain, :uuid ]

 # Prepend all log lines with the following tags
  # config.log_tags = [ :subdomain, :uuid ]

  # Use a different logger for distributed setups
  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)

  # Use a different cache store in production
  # config.cache_store = :mem_cache_store

  # Enable serving of images, stylesheets, and JavaScripts from an asset server
  # config.action_controller.asset_host = "http://assets.example.com"

  # Precompile additional assets (application.js, application.css, and
all non-JS/CSS are already added)
  # config.assets.precompile += %w( search.js )

  # Disable delivery errors, bad email addresses will be ignored
  # config.action_mailer.raise_delivery_errors = false

  # Enable threaded mode
  # config.threadsafe!

  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to
  # the I18n.default_locale when a translation can not be found)
  config.i18n.fallbacks = true

  # Send deprecation notices to registered listeners
  config.active_support.deprecation = :notify

  # Log the query plan for queries taking more than this (works
  # with SQLite, MySQL, and PostgreSQL)
  # config.active_record.auto_explain_threshold_in_seconds = 0.5
end 
```

正如我在开始时所说，在开发模式下一切运行正常，只有在生产模式下停止工作。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T17:56:00.347

取消注释以下行后问题已解决：

# config.action_dispatch.x_sendfile_header = "X-Sendfile" # 用于 apache

我的 Production.rb 并在我的 assets/javascript 文件夹中声明所有 javascript：config.assets.precompile

# javascript - mousedown 没有调用我的函数

> ID：12484694
> 
> 赞同：1
> 
> 时间：2012-09-18T20:42:46.430
> 
> 标签：javascript, html, jquery

我已经创建了过渡链接，但是当应该使用 onmousedown 事件调用该函数时，我得到了一个未捕获的未定义函数。显然我的功能已定义。我仍在学习代码，所以我没有看到或理解它是什么。任何提示将不胜感激。

```
<html>
<head>
<script type="text/javascript"src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery-ui.js"></script>
<script type="javascript">
$(document).ready(function (){
var url = "phpajaxtut.php";
});
function swapContent(cv){

    $("#myDiv").html("animated gif goes here").show();

    .post(url, {contentVar:cv}, function(data){

        $("#myDiv").html(data).show();

    });

}
</script>

<a href="#" onClick="return false" onmousedown="swapContent('con1')">Click the text</a>
<a href="#" onClick="return false" onmousedown="swapContent('con2');">Click the text</a>
<a href="#" onClick="return false" onmousedown="swapContent('con3');">Click the text</a>
</head>
<body >

<div id ="myDiv">My default content</div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:46:13.277

为什么不直接使用`$.click();`，因为您已经在使用 jQuery，并放弃超链接？`a`如果这是您想要的，您可以轻松地将一些跨度设置为看起来像s。我的示例只是更新了一些文本，但您可以在其中放置/调用您的函数。

见[这里](http://jsfiddle.net/Kfvn4/)：

```
// html
<span>Click Me</span>
<br />
<span>Click Me</span>​

// js
var n = 0;

$("span").click(function(){

    $(this).text($(this).text() + " " + n++);

});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:48:48.987

.post 之前需要 $ 吗？

```
$.post(url, {contentVar:cv}, function(data){ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T20:50:48.300

```
$(document).ready(function (){
    var url = "phpajaxtut.php";
}); 
```

var url 不是全局的。只能在函数内部使用

```
var url; //global url

$(document).ready(function (){
    url = "phpajaxtut.php"; // set global url
}); 
```

# php - twitter hastags 的正则表达式没有正确链接？

> ID：12484697
> 
> 赞同：0
> 
> 时间：2012-09-18T20:42:55.933
> 
> 标签：php, regex, twitter

我有一个基本的正则表达式函数，可以将 hastags 转换为链接，但我遇到的问题是它只将实际单词转换为链接，而将 # 单独保留。我希望 # 成为链接的一部分...在 a 标签内。

它产生什么：

```
#<a href="">hastag</a> 
```

我想要的是：

```
<a href="">#hastag</a> 
```

我的PHP代码：

```
public function link_hashtags($text)
{
    $text = preg_replace('/(^|\s)#(\w*[a-zA-Z_]+\w*)/', '\1#<a href="http://search.twitter.com/search?q=%23\2">\2</a>', $text);
    return $text;

} 
```

它确实正确地传递了这个词，因为我不希望将主题标签传递给 url，有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:50:03.987

像你一样将`#`符号放在`<a>`标签内，但也要取出标签前面的那个......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:51:01.957

如果要匹配带有哈希标记的单词，可以使用以下正则表达式：

```
/#([^\s]+)/

<a href="http://search.twitter.com/search?q=%23\1">#\1</a> 
```

在锚点内使用 \1 的反向引用。

# c#-4.0 - 无法从数据库中删除实体（实体框架 4.1）

> ID：12484698
> 
> 赞同：2
> 
> 时间：2012-09-18T20:42:57.727
> 
> 标签：c#-4.0, entity-framework-4.1, ef-database-first

我一直在拼命地尝试从数据库中删除一个项目，但到目前为止还无法让它工作。我看到的错误信息是这样的：

```
"The operation failed: The relationship could not be changed because one or more of the foreign-key properties is non-nullable." 
```

我使用的是 EF4.1，带有 EDMX（数据库优先）和 POCO 对象。我为每种类型都有一个存储库和一个实现基本方法的通用存储库。

具体问题是当我想删除一个项目时。删除孩子不是问题 - 一切正常 - 问题是当我开始删除实体本身时。

考虑以下模型。我有一个实体“Foo”，它与“Bar”有一对多的关系。我在我的存储库中调用以下方法：

```
 public override void Delete(Models.Foo entity)
    {
        //Load the child items...
        base.Context.Entry(entity).Collection(x => x.Bars).Load();

        //Bar
        BarRepository barRep = new BarRepository();
        foreach (var item in entity.Bars)
        {
            var obj = barRep.GetById(item.ID);
            barRep.Delete(obj);
        }            

        barRep.Save();

        //First attempt
        //base.Delete(entity);
        //base.Save();

        //Have to resort to some SQL
        base.ExecuteSqlCommand(string.Format("delete from Foo where ID = {0}", entity.ID));
    } 
```

GenericRepository“删除”方法是：

```
 public virtual void Delete(T entity)
    {
        _entities.Set<T>().Remove(entity);
    } 
```

GenericRepository“保存”方法很简单：

```
 public virtual void Save()
    {
        _entities.SaveChanges();
    } 
```

我想上班是这样的：

```
 //First attempt
        //base.Delete(entity);
        //base.Save(); 
```

但不幸的是（目前）我删除该项目的唯一方法是运行一些只调用_entities.Database.ExecuteSqlCommand(SQL) 的SQL。

我已经阅读了很多东西，但似乎没有任何效果。在尝试了解正在发生的事情时，我真的很感激一些帮助。

谢谢，

何塞

# mysql - 许多 LEFT Joins (7) 导致超时 - 另一种方法或代码问题？

> ID：12484702
> 
> 赞同：0
> 
> 时间：2012-09-18T20:43:08.977
> 
> 标签：mysql, performance, indexing

我希望能够将很多表连接在一起（9-10 左右），但即使只有 7 个，它也会超时。我尝试尽我所知建立索引（见附件说明）。连接只是不是为了处理 7 个以上的表，还是我做错了什么？

（正如您在解释中看到的那样，数据库中的记录非常少。即使我可以让它工作，当有 500,000 多条记录时会发生什么？

```
SELECT `Node`.`id`, `Node`.`name`, `Node`.`slug`, `Node`.`node_type_id`, `Node`.`site_id`, `Node`.`created`, `Node`.`modified`
FROM `mysite`.`nodes` AS `Node`
LEFT JOIN `mysite`.`data_date_times` AS `DataDateTime` ON (`DataDateTime`.`node_id` = `Node`.`id`)
LEFT JOIN `mysite`.`data_locations` AS `DataLocation` ON (`DataLocation`.`node_id` = `Node`.`id`)
LEFT JOIN `mysite`.`data_media` AS `DataMedia` ON (`DataMedia`.`node_id` = `Node`.`id`)
LEFT JOIN `mysite`.`data_metas` AS `DataMeta` ON (`DataMeta`.`node_id` = `Node`.`id`)
LEFT JOIN `mysite`.`data_profiles` AS `DataProfile` ON (`DataProfile`.`node_id` = `Node`.`id`)
LEFT JOIN `mysite`.`data_products` AS `DataProduct` ON (`DataProduct`.`node_id` = `Node`.`id`)
LEFT JOIN `mysite`.`data_texts` AS `DataText` ON (`DataText`.`node_id` = `Node`.`id`)
WHERE 1=1
GROUP BY `Node`.`id` 
```

![我的解释输出](../Images/6d118b2d328584985010817631814669.png)

我正在使用 JOINS 是因为我希望能够通过它的连接表对主要结果进行排序，并且能够查询每个包含中的特定字段（可能） - 我不知道这样做的好方法单独的查询。

非常欢迎任何想法/建议。

**更新：**

在数据库的本地副本上运行时，它说“复制到临时表”需要 117 秒，然后完成并显示所有 7 条记录。

# cocos2d-iphone - 优化步行动画的 .plist/纹理

> ID：12484703
> 
> 赞同：0
> 
> 时间：2012-09-18T20:43:13.990
> 
> 标签：cocos2d-iphone, textures

我正在尝试“挤压”我的纹理以制作行走动画。动画有 8 帧，但实际上可以很好地使用 1-2-3-4-5-4-3-2 来完成，它非常适合 128x128 点纹理。您是否知道可以为 6-7-8 创建映射到纹理的 4-3-2 区域的 plist 条目的工具？

编码仍然是一种选择，但想知道是否某些工具具有开箱即用的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:34:36.817

我很惊讶还有没有使用[TexturePacker的 Cocos2D 开发人员](http://www.codeandweb.com/texturepacker)的 Cocos2D 开发人员。:)

查看[Features下的](http://www.codeandweb.com/texturepacker/features)**Alias Creation**部分，我正在引用（但也可以确认这完美无缺）：

> 如果修剪后的两个图像相同，则仅将一个图像放置在精灵表中。重复项只会添加到描述文件中，允许您使用两个名称访问它。 ![在此处输入图像描述](../Images/ba2dd8dd8e888de05743e0fa87c26a04.png)
> 
> 这在使用动画时是完美的：您根本不必关心相等的阶段。

# php - strtotime 在给出开始日期时跳过月份

> ID：12484704
> 
> 赞同：0
> 
> 时间：2012-09-18T20:43:16.103
> 
> 标签：php, date

我试图从一个特定的时间戳开始逐月跳跃，但是当我从八月开始跳跃时，九月总是被跳过。从 8 月 31 日（1346389200）开始，跳跃 1 个月：

```
strtotime('+1 month', 1346389200); 
```

产生 1349067600 - 这是 10 月 1 日。如果没有开始计算的开始日期，我已经阅读了有关 strtotime 犯错误的所有内容，但这可能是什么问题？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:51:34.897

8 月 31 日之后的一个月是 9 月 31 日，但是，由于它不存在，php 将结果强制为 1 Oktober。因此，您应该在第 1 天强制当前月份（当然，如果您只想要年份和月份）：

```
strtotime('+1 month',strtotime(date("Y-m-1",1346389200))); 
```

但是如果你使用 php >5.3 你可以使用更可靠的`DateTime`类和方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:49:57.620

您可能不应该使用时间戳`strtotime`来进行比较。由于夏令时、闰年等原因，您将引入问题。最好使用 DateTime 和 DateInterval 类/函数以更彻底的方式执行此操作。

[http://php.net/manual/en/datetime.add.php](http://php.net/manual/en/datetime.add.php)

# python - “exec expr in globals(), locals()”的赋值顺序出乎意料

> ID：12484706
> 
> 赞同：7
> 
> 时间：2012-09-18T20:43:25.857
> 
> 标签：python, global-variables, eval

Python 2.X 中的以下代码如您所愿打印“a : 2”：

```
def f():
  #a = 1
  exec "a = 2" in globals(), locals()
  for k,v in locals().items(): print k,":",v
  #a = 3

f() 
```

但是，如果您取消注释“a = 1”，那么它会打印“a : 1”，这是我没想到的。更奇怪的是，如果您取消注释“a = 3”行，那么它根本不会打印任何内容，这是我绝对没想到的（我有一个令人费解的错误，我提炼出来）。

我认为答案隐藏在有关 locals() 和 globals() 的文档中，或者可能隐藏在其他[类似](https://stackoverflow.com/questions/7969949/whats-the-difference-between-globals-locals-and-vars)的问题中，但我认为值得将这种表现形式提出来。

我很想了解 Python 解释器在这里的想法，以及解决方法的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:50:57.037

旧的 Python 2`exec`会更改字节码以搜索本地和全局命名空间。

当您`a = 2`在全局中定义时，这是在`a = 1`注释时找到的。当您取消注释时`a = 3`，这是`a`“找到”但尚未定义。

如果您阅读[Eli Bendersky 的这篇精彩文章](http://eli.thegreenplace.net/2010/09/18/python-internals-symbol-tables-part-1/)中的符号表是如何处理的，您可以更好地理解局部变量是如何处理的。

您不应该使用`exec`这种代码（我希望这不是生产代码），并且当您将代码移植到 Py3k 时它无论如何都会中断：

Python 3 的`exec`函数不再是一个语句，因此不能改变它所处的环境。

* * *

或许我应该直奔主题：

如果你正在做所有这些动态命名的事情，你应该使用字典：

```
def f():
    data = {'a': 1}
    data['a'] = 2
    if ...:
        data['a'] = 3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:55:24.010

来自`locals`功能[文档](http://docs.python.org/library/functions.html#locals)：

**注意：**不得修改本词典的内容；更改可能不会影响解释器使用的局部变量和自由变量的值。

检查：

```
>>> def f():
    a = 1
    print(locals())
    locals()['a']=2
    print(a,locals())

>>> f()
{'a': 1}
1 {'a': 1} 
```

所以你不能通过`locals()`函数修改本地上下文

# ios - 与 Perl 兼容的 iOS CCCrypt

> ID：12484707
> 
> 赞同：1
> 
> 时间：2012-09-18T20:43:25.967
> 
> 标签：ios, encryption, sdk

我在 perl 中使用以下内容来加密 http:// 响应的正文。

```
use Crypt::CBC;
my $cipher = Crypt::CBC->new(
                            -key    => 'testpasswordof32Charlength',
                            -cipher => "Crypt::OpenSSL::AES"
                            );

print $cipher->encrypt($data); 
```

在 iOS 中，使用以下内容进行解密：

```
- (NSData *)AES256DecryptWithKey:(NSString *)key {
    // 'key' should be 32 bytes for AES256, will be null-padded otherwise
    char keyPtr[kCCKeySizeAES256+1]; // room for terminator (unused)
    bzero(keyPtr, sizeof(keyPtr)); // fill with zeroes (for padding)

    // fetch key data
    [key getCString:keyPtr maxLength:sizeof(keyPtr) encoding:NSUTF8StringEncoding];

    NSUInteger dataLength = [self length];

    //See the doc: For block ciphers, the output size will always be less than or
    //equal to the input size plus the size of one block.
    //That's why we need to add the size of one block here
    size_t bufferSize = dataLength + kCCBlockSizeAES128;
    void *buffer = malloc(bufferSize);

    size_t numBytesDecrypted = 0;
    CCCryptorStatus cryptStatus = CCCrypt(kCCDecrypt, kCCAlgorithmAES128, kCCOptionPKCS7Padding,
                                          keyPtr, kCCKeySizeAES256,
                                          NULL /* initialization vector (optional) */,
                                          [self bytes], dataLength, /* input */
                                          buffer, bufferSize, /* output */
                                          &numBytesDecrypted);

    if (cryptStatus == kCCSuccess) {
        //the returned NSData takes ownership of the buffer and will free it on deallocation
        return [NSData dataWithBytesNoCopy:buffer length:numBytesDecrypted];
    }

    free(buffer); //free the buffer;
    return nil;
} 
```

然后我执行以下操作来调用服务器上的 perl 例程

```
NSData *receivedData = [NSURLConnection
                                sendSynchronousRequest:theRequest
                                returningResponse:&theResponse
                                error:&theError];

[receivedData AES256DecryptWithKey:@"testpasswordof32Charlength"]; 
```

我在 receivedData NSData 中得到了垃圾......知道为什么吗？我可能遗漏了一些简单的东西（解密时不简单）......我确保我在 iOS 上使用 CBC 通过使用`kCCOptionPKCS7Padding`. 有任何想法吗？

拔掉（我只剩下一点点）头发！

# model-view-controller - 追加到列表不更新拉刷新

> ID：12484708
> 
> 赞同：1
> 
> 时间：2012-09-18T20:43:28.657
> 
> 标签：model-view-controller, sencha-touch-2, pull-to-refresh

我还是 ST 的新手，所以我可能在这里做错了几件事，但我不知道问题出在哪里。

**问题1** 当我使用拉取刷新插件时，我得到双倍的数据，而不是仅仅刷新数据。我已经看到使用 propertyId，所以我没有用。这应该很简单，所以可能我做错了一些愚蠢的事情。

**问题 2** 我试图找出使用 MVC 架构的最有效方法，并且我已经阅读了文档和许多示例。所以，我不知道我是不是理解不清楚还是需要一个更好的例子。我现在正在尝试创建一个简单的应用程序，其中包含一个列表，我可以点击一个项目并获取该项目的详细视图。我稍后会将它演变成一个更强大的怪物，但现在我正在尝试了解基础知识。当我单击一个列表项时，我终于得到了关闭按钮来关闭详细视图，但是当我点击另一个项目时，我再也无法获得详细视图。我已经读到这是由于“autoDestroy：off”不存在，但我试过了，也没有运气。我希望能够创建某些按钮，例如“关闭”，我可以将其放入多个视图中，并且只需要在控制器中有逻辑。

**主视图**

```
Ext.define('SenchaFirstApp.view.DistributorView', {
     //      extend: 'Ext.form.Panel',
     extend: 'Ext.Container',
       requires: ['SenchaFirstApp.store.DistributorStore', 'Ext.dataview.List', 'Ext.Toolbar', 'Ext.form.Panel'],
       model: 'SenchaFirstApp.model.Distributors',
       alias: 'widget.mainlist',
       xtype: 'mainlist',
       config:
       {
           layout: 'fit',
           border: 5,
           title: 'Distributors',
           html: 'My datalist',
           autoDestroy: false,
           items:[{

               xtype: 'toolbar',
               docked: 'top',
               title: 'Distributor List',
               height: 40,
               centered: true,
               items: [
                {
                    xtype: 'button',
                    text: 'Close',
                    width: 100,
                    height: 20, 
                    name: 'close',
            //      iconCls: 'delete',
                }]
               },
           {
           autoLoad: true,
           html: ['<div class="distr"><table><tr><th>Type</th><th>Distributor</th><th>Site</th><th>Status</th><th>Active</th><th>Assigned</th><th>State                             </th><th>Schedule</th><th>Finished</th></tr></table></div>'],
           itemTpl: [ '<div class="distr"><table><tr><td>{t}</td><td>{distr}</td><td colspan="2">{site}</td><td>{status}</td>                                                       <td>{active}</td><td>{assigned}</td> <td>{state}</td><td>{schedule}</td><td>{finished}</td></tr></table></div>' ],
           xtype: 'list',
           store: 'DistrID', 
            plugins: [
    {
        xclass: 'Ext.plugin.PullRefresh',
        pullRefreshText: 'Pull down to refresh Distributor List'
    }],
           ui: 'showDetails',
           id: 'mainlist',
           autoDestroy: false,
           }          
        ]
       },          
     }); 
```

**详细视图**

```
Ext.define('SenchaFirstApp.view.DetailView',{
      extend: 'Ext.Panel',
      requires: ['Ext.Toolbar'],
      model: 'SenchaFirstApp.model.Distributors',
      alias: 'widget.detailview',
      xtype: 'detailview',
      name: 'detail',

    config:{
         html: 'This will contain detailed information',
          xtype: 'panel',
    //    fullscreen: false,
          centered: true,
          modal: false,
          scrollable: true,
          width: 300,
          height: 200,
      },
       }); 
```

**店铺**

```
Ext.define('SenchaFirstApp.store.DistributorStore', {
                        extend: 'Ext.data.Store',
                        requires: ['SenchaFirstApp.model.Distributors'],

                        config: {
                        //  xtype: 'distrlist',
                            storeId: 'DistrID',
                        model: 'SenchaFirstApp.model.Distributors',
                        autoLoad: true,
                        proxy: {
                            type: 'jsonp',
                            url:'https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&q=http://gdata.youtube.com/feeds/api/users/hobbitin5/uploads&num=4',
                            reader: {
                                type: 'json',
                                rootProperty: 'responseData.feed.entries'
                            }
                        }
                            } 
```

**控制器获取详细视图**

```
 Ext.define('SenchaFirstApp.controller.DistributorsController',{
       extend: 'Ext.app.Controller',
       config: 
       {
           refs: 
           {
               mainlist: '#mainlist',
           },
           control: 
           {
               mainlist: {
                   itemtap: 'dispDetail'
               },
           },

       //when item is tapped
         listeners: {
                itemtap: function(list, index, items, record)
               {
                   console.log('An item was tapped and the listener heard it');
               }
           }
        },
        dispDetail: function(view, record) {
                console.log('Item was tapped on the Data View');
                var oldView = this.getMainlist();       
                var curRecord = oldView.getStore(record);
                var newView = Ext.create('SenchaFirstApp.view.DetailView');
                console.log(curRecord);
                curRecord += 'other stuff';
                newView.setHtml(curRecord);
                newView.add(
        {
         xtype:  'toolbar',
         docked: 'top',
         title: 'Details',
         height: 40,
         items: [
        {
          xtype: 'button',
          text: 'Close',
          width: 100,
          height: 20,   
          name: 'close',
        }]

        }
      )
                oldView.add(newView);
            //  Ext.Viewport.add(newView)
            //  Ext.Viewport.setActiveItem(newView)
        }

       }); 
```

**按钮控制器（暂时关闭）**

```
Ext.define('SenchaFirstApp.controller.NavController', {
       extend: 'Ext.app.Controller',
       config: 
       {
            refs: 
            {
                 mainlist: 'mainlist',
                 main: '#mainlist',
                closeBtn: 'button[name=close]',
                detaillist: {
                    selector: 'panel panel[name=detail] deetaillist',
                    xtype: 'detailview',
                }
            }, 
            control:
            {
                closeBtn: {
                    tap: 'closeView',
                },

                mainlist: {
                    tap: 'closeView',
                },
                detaillist: {
                    tap: 'closeView',
                }
            }
       },

       closeView: function(){

            var newView = this.getMainlist();
        //  var child = Ext.Viewport.getActiveItem();
            var child = this.getDetaillist();
            var instance = Ext.getCmp('mainlist');
            var activeIndex = instance.indexOf(instance.getActiveItem());
            var curIndex = activeIndex+1;
            var closeView = this.getDetaillist();
            console.log('Close btn clicked' + ' child: ' + this.child +  ' activeIndex: ' + activeIndex);
          // Ext.Viewport.destroy(closeView); //(child);
          newView.remove(child);
          newView.destroy();
          Ext.Viewport.add(Ext.create('SenchaFirstApp.view.DistributorView'));
`          }

})`; 
```

**模型**

```
Ext.define('SenchaFirstApp.model.Distributors', {
       extend: 'Ext.data.Model',
       config: {
           idProperty: 'DistrID',
             fields: [
                {name: 'DistrID'},
                {name: 't', type: 'string'},
                {name: 'distr', type: 'string'},
                {name: 'group', type: 'string'},
                {name: 'site', type: 'string'},
                {name: 'status', type: 'string'},
                {name: 'active', type: 'string'},
                {name: 'assigned', type: 'string'},
                {name: 'state', type: 'string'},
                {name: 'schedule', type: 'string'},
                {name: 'finished', type: 'string'},
                //{mapping: 't',
                // name: 'DistrID'}
                ],
       }
       }); 
```

我知道这很多，但任何帮助都是值得赞赏的……即使是朝着正确的方向轻推。提前致谢！另外，我确信那里有一些不需要的东西，因为我很难找到我想要完成的好例子，所以我在这里和那里都有我尝试过的不同示例的片段一起玩得开心:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T15:52:17.827

我通过将 idProperty 更改为 'id' 并将其放入我的模型字段列表中解决了刷新问题。我仍然不确定为什么'DistrID'不起作用，但我的脚本中有一个'id'字段，其中包含我不知道的服务器响应，因为我没有写那部分。所以，我不得不猜测这就是它不起作用的原因。

我读过'autoDestroy：false'是允许第二次点击所需的，但这是错误的。当我取出该属性时，它允许我继续打开和关闭列表项的详细信息。

现在我只需要传递单击的列表项的 id 即可获得该特定项的详细视图。如果有人可以提供帮助，那就太好了，否则我会发布一个新问题。谢谢！

我想出了如何获取列表项 ID 以防万一它可以帮助任何人...在我的 DistributorController 中，我只需获取商店和记录 ID

```
var store = Ext.getStore('NodeStore');
            var id = record.get('id'); 
```

然后设置参数并加载商店

```
store.getProxy().setExtraParams({id: id});
            store.load(); 
```

我还发现您无法通过带有 refs 的控制器引用您的商店。而是像上面那样使用 var store = Ext.getStore('StoreName'); 获取商店。这都是非常简单的东西，但我仍然非常了解，所以也许它可以帮助另一个 n00b

# c++ - 无法将（）结构插入 unordered_set

> ID：12484709
> 
> 赞同：0
> 
> 时间：2012-09-18T20:43:30.317
> 
> 标签：c++, visual-c++, c++11, std

我无法将项目插入我的无序集中。到底是怎么回事？

```
typedef struct node_t
{
    char s[SIZE];
    char blank;     //position of blank tile
    char g,h;
    int depth;      //Depth of node for IDA*
}NODE; 
```

...

```
NODE CurrentNode;
unordered_set<NODE> seen;

seen.insert(CurrentNode); 
```

引发以下错误：

错误 3 错误 C2678：二进制“==”：未找到采用“const NODE”类型的左侧操作数的运算符（或没有可接受的转换）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:01:41.560

编译器告诉你发生了什么： unordered_set 的实现**需要**你定义一个`operator==()`for `NODE`。顺便说一句：您还必须定义一个`hash()`函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:02:10.160

您没有定义比较运算符`==`，也没有安排对其进行散列处理。（还有，`MAGIC_BUFFER_SIZE` `char`和`typedef struct`？真的吗？你学的是 C++ 还是 C？）

# java - 为什么在 Spring MVC 中使用两个数据源时出现错误？

> ID：12484712
> 
> 赞同：0
> 
> 时间：2012-09-18T20:43:40.770
> 
> 标签：java, hibernate, spring-mvc

我正在将 Spring MVC 与 Hibernate 一起使用。我正在尝试使用两个不同的数据库（在两个不同的服务器上）。一个是 MySQL，另一个是 DB2。

这是我的 dispatcher-context.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/tx
        http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

    <!-- Load JDBC Properties -->
    <context:property-placeholder location="classpath:jdbc.properties" />

    <!-- Enable Annotations (MVC and Hibernate Transactions) -->
    <context:component-scan base-package="com.example" />
    <mvc:annotation-driven />
    <tx:annotation-driven transaction-manager="hibernateTransactionManager" />

    <!-- Tell Spring where to find static files and not use a controller -->
    <mvc:resources mapping="/css/**" location="/WEB-INF/css/*" />
    <mvc:resources mapping="/js/**" location="/WEB-INF/js/*" />

    <!-- Create a ViewResolver -->
    <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
        <property name="prefix" value="/WEB-INF/jsp/" />
        <property name="suffix" value=".jsp" />
    </bean>

    <!-- Create a DataSource for MySQL -->
    <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="${mysql.database.driver}" />
        <property name="url" value="${mysql.database.url}" />
        <property name="username" value="${mysql.database.user}" />
        <property name="password" value="${mysql.database.password}" />
    </bean>

    <!-- Create a DataSource for DB2 -->
    <bean id="db2DataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="${db2.database.driver}" />
        <property name="url" value="${db2.database.url}" />
        <property name="username" value="${db2.database.user}" />
        <property name="password" value="${db2.database.password}" />
    </bean>

    <!-- Create a Session Factory -->
    <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="annotatedClasses">
            <list>
                <value>com.example.model.entities.User</value>
            </list>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${mysql.hibernate.dialect}</prop>
                <prop key="hibernate.show_sql">${mysql.hibernate.show_sql}</prop>
                <prop key="hibernate.c3p0.min_size">${mysql.hibernate.c3p0.min_size}</prop>
                <prop key="hibernate.c3p0.max_size">${mysql.hibernate.c3p0.max_size}</prop>
                <prop key="hibernate.c3p0.timeout">${mysql.hibernate.c3p0.timeout}</prop>
                <prop key="hibernate.c3p0.max_statements">${mysql.hibernate.c3p0.max_statements}</prop>
                <prop key="hibernate.c3p0.idle_test_period">${mysql.hibernate.c3p0.idle_test_period}</prop>
            </props>
        </property>
    </bean>

    <bean id="sessionFactoryDB2" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="db2DataSource" ref="db2DataSource" />
        <property name="annotatedClasses">
            <list>
                <value>com.example.model.entities.Transfer</value>
            </list>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${db2.hibernate.dialect}</prop>
                <prop key="hibernate.show_sql">${db2.hibernate.show_sql}</prop>
                <prop key="hibernate.c3p0.min_size">${db2.hibernate.c3p0.min_size}</prop>
                <prop key="hibernate.c3p0.max_size">${db2.hibernate.c3p0.max_size}</prop>
                <prop key="hibernate.c3p0.timeout">${db2.hibernate.c3p0.timeout}</prop>
                <prop key="hibernate.c3p0.max_statements">${db2.hibernate.c3p0.max_statements}</prop>
                <prop key="hibernate.c3p0.idle_test_period">${db2.hibernate.c3p0.idle_test_period}</prop>
            </props>
        </property>
    </bean>

    <!-- Create a Transaction Manager -->
    <bean id="hibernateTransactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
        <property name="sessionFactoryDB2" ref="sessionFactoryDB2" />
    </bean>

</beans> 
```

但是当我运行我得到这个错误：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transfersController': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: com.example.model.service.UserService.... 
```

我在我的控制器/模型中使用@Autowired。所以它不知道使用哪个 bean 来自动装配是有道理的。但是我该如何解决呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:54:12.500

我认为您的数据源不存在问题。要自动装配服务类，您需要使用`@Service`（首选服务层类）构造型注释。

您还需要使用我在您发布的 xml 中没有看到的组件扫描来扫描这些带注释的类。

```
 <context:component-scan base-package="com.example, com.example.model.service" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:36:09.377

```
 <bean id="sessionFactoryDB2" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="db2DataSource" ref="db2DataSource" />
    <property name="annotatedClasses"> 
```

我不认为有一个名为`db2DataSource`in的属性`AnnotationSessionFactoryBean`。这可能是它失败的原因之一。应该是`<property name="dataSource" ref="db2DataSource" />`。

# request - 无法从 JMS 临时队列接收消息

> ID：12484714
> 
> 赞同：1
> 
> 时间：2012-09-18T20:43:45.147
> 
> 标签：request, jms, reply

我已经搜索了解决方案，但无法使其工作。这是摘要。我正在尝试实现一个在 Glassfish 2.1 上运行的 Web 服务，它使用临时队列实现同步 JMS 请求响应。它向远程服务器上运行的另一个 Glassfish 应用程序发送消息。我能够发送消息并对其进行处理，但是当最终消息被发送回临时队列时，Web 服务将响应设为空。这是代码：

私人消息请求回复（字符串消息，队列 jmsRequestResponse，ConnectionFactory jmsRequestRespConnFactory）{

```
 javax.jms.Connection conn = null;       
    javax.jms.MessageConsumer consumer = null;
    javax.jms.Message replyMsg = null;
    javax.jms.Session sess = null;       

    try {
        logger.debug("[requestreply input message[" + msg);
        conn = jmsRequestRespConnFactory.createConnection();
        conn.start();
        sess = conn.createSession(false, javax.jms.Session.AUTO_ACKNOWLEDGE);
        javax.jms.Message reqMessage = sess.createTextMessage(msg);
        javax.jms.Destination replyDestination = (jmsRequestResponse instanceof javax.jms.Queue) ? sess.createTemporaryQueue() : sess.createTemporaryTopic();

        reqMessage.setJMSReplyTo(replyDestination);
        sess.createProducer(jmsRequestResponse).send(reqMessage);                  

        replyMsg = consumer.receive(60000);            
        consumer.close();
        sess.close();
        conn.close();
    } catch (JMSException ex) {
        logger.debug("exception in requestreply");
    } finally {
        if (consumer != null) {
            try {
                consumer.close();
            } catch (Exception e) {
            }
        }
        if (conn != null) {
            try {
                conn.close();
            } catch (Exception e) {
            }
        }           
    }
    return replyMsg;
} 
```

我在这里想念什么？当我打印replyMsg 时，它始终为空。

# css - 的两种不同用途：哪个是可访问性的最佳解决方案？

> ID：12484716
> 
> 赞同：6
> 
> 时间：2012-09-18T20:43:51.363
> 
> 标签：css, accessibility, html

我想用图像替换一段文本（例如，带有电话图标的“呼叫”一词）以及网页中的其他一些文本。我希望这适用于普通用户，而不会惩罚禁用 css *（或没有激活 css）的人和看不到图像的盲人 [附录]*。以下两个解决方案哪个更好？

```
1\.     <span title="call" class="s1"><span>

2\.     <span class="s1 s2">call<span> 
```

和：

```
.s1 {
    display:inline-block;
    background: url("call.png") no-repeat scroll 0 0 transparent;
    width:24px;
}
.s2 {
    overflow:hidden;
    text-indent: 30px;
} 
```

PS：`<img>`别无选择，拜托。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T04:48:21.533

在给出的两个备选方案中，2 显然是正确的答案，即它显然对可访问性的不利影响较小。当 CSS 关闭时，元素缩减为单词“call”，而替代 1 缩减为空字符串。不能保证某些软件能够宣布`title`属性的值。例如，考虑在纯可视模式下使用普通图形浏览器，没有屏幕阅读器（例如，设置覆盖页面 CSS 并强制使用适合用户的足够大的字体）。

即使备选方案 2 也不利于可访问性。*启用*CSS后，“呼叫”一词将替换为图标。但不能保证用户完全可以看到它。并且无法`alt`像为内容图像那样为背景图像指定文本。此外，你会用什么作为电话图标？大多数此类图标都是老式的，例如☎或✆，并且越来越多的人从未使用过此类设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T12:45:42.953

`SPAN`是一个非常通用的元素，应该在没有更好的标记元素适合此目的时使用。在您的情况下，`A`(anchor) 正是您所需要的，假设您的“调用”元素是用户代理应该与纯文本区分开来的东西。即使您不使用`href`，它仍然是一个锚点 - 只需使用 JavaScript 将其绑定到鼠标事件。

此外，在这里使用背景图像是错误的。背景图像用于背景。事实上，用户代理甚至不应该将这些作为活动用户界面的一部分单击（仅作为非常次要的交互）如果它是您所追求的“呼叫”按钮，请改用 CSS`content`属性。不过，您是对`img`的-那是针对带有页面内容的图像，而不是导航。即按钮、锚点等不应使用`img`标签。您也可以使用`input`or `button`，具体取决于上下文（无法从您的问题中看出）。

如果您真的想让您的页面易于访问，那么您就在正确的轨道上，但我真的认为以下是更好的选择：

```
 <a class="s1" title="Call the following number">Call</a>

 .s1
 {
     content: url(call.png);
 } 
```

您可以`s1`使用 CSS`width`和`height`. 不过，我会使用 SVG。如果您的图形是矢量，那绝对是一个更好的主意。像素用于照片和像素艺术 :-)

如果要在元素后添加一些文本，可以使用 CSS `:after`：

```
.s1:after
{
    content: "Call";
} 
```

# actionscript-3 - FDT：编译时执行命令行命令

> ID：12484717
> 
> 赞同：1
> 
> 时间：2012-09-18T20:43:56.707
> 
> 标签：actionscript-3, command-line, fdt

当我在 FDT 中编译我的 AS3 应用程序时，我可以以某种方式在命令行中执行以下行吗？如果是这样，我如何在 FDT 中设置它？

```
python add-advanced-telemetry.py Application.swf 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:48:09.250

查看 FDT Ant[教程](http://fdt.powerflasher.com/docs/FDT_Ant_Tasks)和[文档](http://fdt.powerflasher.com/docs/FDT_Ant_Tasks)。

# android - Android SDK 在创建 APN 时设置身份验证类型

> ID：12484722
> 
> 赞同：0
> 
> 时间：2012-09-18T20:44:06.887
> 
> 标签：android, authentication, android-sdk-2.3, apn

我正在为需要自定义 Gingerbread 智能手机的客户编写应用程序：问题是我需要 APN 才能使用 PAP 身份验证类型，但我找不到以编程方式设置它的方法......

我发现了如何创建 APN，但我不知道如何设置身份验证类型...

谢谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:05:42.407

好的，问题解决了……

使用 aShell 设法打开数据库并注意到该字段不是“AuthType”而是“authtype”......它是一个整数，可以假定值介于 0 和 3 之间：

*   0 表示不进行身份验证
*   1 用于 PAP 身份验证
*   2 用于 CHAP 身份验证
*   3 用于 CHAP 或 PAP，无论可用

# android - Android - 在代码中的另一个视图中对齐视图（按钮）？

> ID：12484724
> 
> 赞同：1
> 
> 时间：2012-09-18T20:44:07.940
> 
> 标签：android, mobile, button, layout, view

我有一个自定义视图，它将被打包并添加到另一个项目中。在视图中，我想提供一个按钮选项。

这是我在 CustomView 类中的内容。

```
final CustomView currentView = (CustomView) findViewById(this.getId());

RelativeLayout.LayoutParams params = (new   RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT,RelativeLayout.LayoutParams.WRAP_CONTENT ));

params.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);
closeButton.setLayoutParams(params);

currentView.addView(closeButton); 
```

这都包含在一个 RelativeLayout 标记以及应用程序的其他对象中

一切都会编译，但是在 CustomView 中，按钮是左对齐而不是右对齐。有什么想法吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:47:19.047

我猜问题是你的CustomView。它可能不会占用窗口的整个宽度，并且宽度足以填充其子项（在您的情况下，它是关闭按钮）。确保您的 CustomView 具有`fill_parent`水平布局。

由于您的 CustomView 扩展了 WebView，而 WebView 又扩展了 AbsoluteLayout，因此您不能指望它处理 RelativeLayout 的参数。相反，最好将 customview 和关闭按钮放在 RelativeLayout 中并正确定位它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:54:55.523

将您添加`closeButton`到您时，您`currentView`还需要提供 LayoutParams 作为参数以使它们生效。

基本上，切换

```
currentView.addView(closeButton); 
```

和

```
currentView.addView(closeButton, params); 
```

* * *

由于按钮的宽度设置为 wrap_content，您也可以尝试将其 layout_gravity 设置为右。

```
params.gravity = Gravity.RIGHT; 
```

# eclipse - Subclipse 插件构建错误

> ID：12484731
> 
> 赞同：0
> 
> 时间：2012-09-18T20:44:34.200
> 
> 标签：eclipse, eclipse-plugin, subclipse

我正在尝试构建一个稍微修改过的 Subclipse 版本（从 Eclipse 导出“可部署的插件和片段”）。

我收到一个让我难过的错误：

F:\MyWorkspaces\Subclipse\org.tigris.subversion.subclipse.ui\build.xml:163：-log 'F:/MyWorkspaces/Subclipse/.metadata/.plugins/org.eclipse.pde.core/ 中的引号不平衡temp/destination/plugins/org.tigris.subversion.subclipse.ui_1.6.18/@dot.log'

谁能指出我正确的方向？关于如何找出问题所在的任何建议？

在弹出错误后，提到的两个文件（build.xml 和@dot.log）都不存在，因此它们必须是在构建时创建的临时文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T17:20:30.047

您是否尝试过创建本地更新站点项目，向其中添加 Subclipse 功能，然后构建更新站点？这就是我构建 Subclipse 的方式。

# php - 无法分解 Doctrine ODM 查询

> ID：12484738
> 
> 赞同：0
> 
> 时间：2012-09-18T20:45:04.450
> 
> 标签：php, mongodb, doctrine-orm, doctrine-odm

所以我有以下运行良好的 Mongo ODM 查询：

```
 $query = $dm->createQueryBuilder('MainClassifiedBundle:Listing')
         ->select('id', 'title', 'assets')
         ->field('somefield0')->equals($somefield)
         ->field('somefield')->equals($blah)
         ->field('somefield2')->range($minPrice, $maxPrice)
         ->field('somefield3')->near($latitude, $longitude)
         ->getQuery();

 $my_data = $query->execute(); 
```

但是，如果我尝试将其分解如下：

```
 $query = $dm->createQueryBuilder('MainClassifiedBundle:Listing')
     ->select('id', 'title', 'assets')
     ->field('somefield0')->equals($somefield)
     ->field('somefield')->equals($blah);

if ($propertyType != 'All') {
     $query->field('someothercrazyfield')->equals($somethingelse);

     $query->field('somefield2')->range($minPrice, $maxPrice)
     ->field('somefield3')->near($latitude, $longitude)
     ->getQuery();

 $my_data = $query->execute(); 
```

我收到一个方法执行不存在的错误。

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:20:47.730

因为调用 getQuery() 时没有存储查询。我在下面更改了您的示例。

```
$query = $dm->createQueryBuilder('MainClassifiedBundle:Listing')
    ->select('id', 'title', 'assets')
    ->field('somefield0')->equals($somefield)
    ->field('somefield')->equals($blah);

if ($propertyType != 'All') {
    $query->field('someothercrazyfield')->equals($somethingelse);

    $query->field('somefield2')->range($minPrice, $maxPrice)
       ->field('somefield3')->near($latitude, $longitude);
}

$my_data = $query->getQuery()->execute(); 
```

# sql - SQL 查询卡住 - 不同行的比较

> ID：12484739
> 
> 赞同：0
> 
> 时间：2012-09-18T20:45:07.150
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2005

我正在处理一个非常奇怪的 SQL 问题，我必须比较以前的行

```
Number    start_date                      end_date    
 -----     -------                      ------------
 1    2011-06-07 00:00:00.000         2011-07-10 00:00:00.000   
 2    2011-10-11 00:00:00.000         2011-10-11 00:00:00.000   
 3    2011-10-26 00:00:00.000         2011-10-29 00:00:00.000   
 4    2011-10-29 00:00:00.000         2011-11-15 00:00:00.000 
```

在这里，我必须比较两条不同线上的 start_date 和 end_date 并从中创建一个视图。（如果 start_date 小于前一个 end_date ，则条件设置为 1）。

那么它应该比较 2011-10-26 00:00:00.000 3 和 2011-10-27 00:00:00.000 2 30 天

```
Number    start_date                      end_date                 Criteria
-----     -----------                   ----------------          ------------
1   2011-06-07 00:00:00.000       2011-07-10 00:00:00.000            0
2   2011-10-11 00:00:00.000       2011-10-11 00:00:00.000            0
3   2011-10-26 00:00:00.000       2011-10-29 00:00:00.000            1
4   2011-10-30 00:00:00.000       2011-11-15 00:00:00.000            1 
```

我很困惑我应该如何进行。

任何帮助都会有所帮助！！！！

谢谢 ！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:52:48.473

最直接的方法是使用子查询：

```
select A.number, a.start_date, a.end_date,
    CASE WHEN start_date < dateadd(d,30,(select TOP(1) b.end_date
     from mytable B
     where B.number < A.number
     order by B.number desc)) then 1 else 0 end Criteria
from mytable A 
```

注意：如果开始日期是上一行结束日期*之后*的第 29 天，`Criteria`则变为 1。到第 30 天之后，为 0。`30`根据需要调整查询中的 。

样本：

```
create table mytable (
    Number int primary key,
    start_date datetime,
    end_date datetime);

insert mytable
select 1, '2011-06-07', '2011-07-10' union all
select 2, '2011-10-11', '2011-10-27' union all
select 3, '2011-10-26', '2011-10-29' union all
select 4, '2011-10-29', '2011-11-15' 
```

结果：

```
number  start_date  end_date    Criteria
1   2011-06-07 00:00:00.000 2011-07-10 00:00:00.000 0
2   2011-10-11 00:00:00.000 2011-10-27 00:00:00.000 0
3   2011-10-26 00:00:00.000 2011-10-29 00:00:00.000 1
4   2011-10-29 00:00:00.000 2011-11-15 00:00:00.000 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:56:47.050

尝试`case`像这样使用：

```
create view vDates as
select Number,start_date,end_date, 
       case 
         when start_date<end_date 
           then 0
         else 1
       end as Criteria
from tab 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!3/5b1dd/2/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T11:18:54.043

一种更易读的方法是创建一个函数并发送正确的日期：

功能：

```
create function [dbo].[CompareDates] (
    @START_DATE datetime,
    @PREVIOUS_END_DATE datetime
)
RETURNS int
AS
BEGIN

    if @START_DATE < @PREVIOUS_END_DATE
        return 1
    return 0

END 
```

查询（使用子查询）：

```
declare @dates table
(
    number int,
    start datetime,
    end_date datetime
)

insert into @dates values
(1, '2011-06-07 00:00:00.000', '2011-07-10 00:00:00.000'),
(2, '2011-10-11 00:00:00.000', '2011-10-27 00:00:00.000'),
(3, '2011-10-26 00:00:00.000', '2011-10-29 00:00:00.000'),
(4, '2011-10-29 00:00:00.000', '2011-11-15 00:00:00.000')

select *, dbo.CompareDates(dates.end_date, dates.previous_end_date)  from
(
    select number, start, end_date,
        (select TOP 1 end_date
        from @dates d2
        where d2.number < d1.number
        order by d2.number desc) as previous_end_date
    from @dates d1
) dates 
```

# android - 从电子邮件启动 android 应用程序

> ID：12484740
> 
> 赞同：1
> 
> 时间：2012-09-18T20:45:07.820
> 
> 标签：android

有没有办法从电子邮件启动 android 应用程序，而不使用 http/https ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:49:41.217

您可以使用自定义协议，并在您的应用程序中安装自定义处理程序。看看[这个](http://snipplr.com/view/49930/)。在此示例中，如果您的邮件包含指向 的链接`foo:do_something`，单击它将打开应用程序。

据此，[解决](https://stackoverflow.com/questions/5514467/custom-url-support-in-android-email)方法是在您的电子邮件中保留 HTTP URL，并让网络服务器将它们转换为您的自定义协议。如果您控制电子邮件，这很好。

我不知道它是否可以通过简单地返回 301 或 302 响应来工作 - 你应该尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:57:41.827

您需要以 HTML 格式发送电子邮件，并在标签中包含您的链接：

`<a href='myscheme://myhost?data=whatever'>Launch App`

在此之前，您必须将其添加到清单文件中

```
<intent-filter>
<action android:name="android.intent.action.VIEW" />
<category android:name="android.intent.category.DEFAULT" />
<category android:name="android.intent.category.BROWSABLE" />
<data android:scheme="ace" android:host="samuel"/>
</intent-filter> 
```

单击链接时，它会提示您完成操作，然后从中选择您的应用程序。

谢谢。

# jquery - 如何使用带有全日历选择回调的 jQuery 对话框？

> ID：12484742
> 
> 赞同：6
> 
> 时间：2012-09-18T20:45:13.937
> 
> 标签：jquery, fullcalendar, jquery-ui-dialog

我对 jQuery 以及可能是 javascript 的工作方式有一个基本的困惑。我一直有同样的问题，如何将参数传递给 jQuery 函数，以便它们的方法反过来可以使用这些变量调用函数。这是我最近的例子：

我正在使用全日历插件。如果我点击日历，它会触发一个回调方法“选择”。选择回调会自动给出某些参数：'startDate' 'endDate' 等。我想要的是打开一个 jQuery 对话框来收集其他信息，然后将新事件发布到服务器。沿着这条线：

```
$('calendar').fullcalendar({
...
select: function (startDate, endDate) {
    $('#newEventPopup').dialog('open'); 
```

在 html 我有这样的东西：

```
<div title = 'How cool is this event?' id='newEventPopup'>
    <select id='coolness'>
        <option value = 'super'>Super!</option>
        <option value = 'cool'>Cool</option>
        <option value = 'dorky'>Dorky</option>
        <option value = 'lame'>Lame!</option>
    </select>
</div> 
```

最后，我想在对话框中添加一个按钮，以将 fullcalendar 变量以及新变量发布到服务器：

```
var coolness = $('#coolness');
$('#newEventPopup').dialog({
    modal: true,
    autoOpen: false,
    ...
    button: {
        Save : function (){
            $.ajax({
                url: 'sample.php'
                type: 'POST'
                data: {
                    'start' : startDate,
                    'end' : endDate,
                    'coolness' : coolness
                 }
                 success: $('calendar').fullCalendar('refetchEvents')
             }
         }
     }
}); 
```

我只是不明白如何构建它，或者在哪里放置代码，以便对话框“保存”按钮“知道”变量“startDate”、“endDate”和“coolness”的含义。我应该提一下，我最初是一名 Java 程序员，但我仍在为基于 JavaScript 函数的变量范围而苦苦挣扎。

我在很多这样的 jQuery 方法中都遇到过这个问题，我希望一个方法指向某个外部函数（例如调用 $.dialog 的选择回调方法），而后者又执行另一种方法（例如调用 $.ajax 的按钮回调方法）函数）但是如何将参数传递给 $.ajax 或 $.dialog 以便他们自己的方法可以使用这些值？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:55:46.477

从[小提琴](http://jsfiddle.net/100thGear/JeDFG/)：

```
$(document).ready(function() {
    $myCalendar = $('#myCalendar').fullCalendar({
        header: {
            left: 'prev,next today',
            center: 'title',
            right: ''
        },
        theme: true,
        selectable: true,
        selectHelper: true,
        height: 500,
        select: function(start, end, allDay) {
            $('#eventStart').datepicker("setDate", new Date(start));
            $('#eventEnd').datepicker("setDate", new Date(end));
            $('#calEventDialog').dialog('open');
        },
        eventClick: function(calEvent, jsEvent, view) {
            $('#eventStart').datepicker("setDate", new Date(calEvent.start));
            $('#eventEnd').datepicker("setDate", new Date(calEvent.end));
            $('#calEventDialog #eventTitle').val(calEvent.title);
            //                    alert(calEvent.className);
            //                alert(calEvent.className=="gbcs-halfday-event"?"1":"2");
            //                    $('#allday[value="' + calEvent.className=="gbcs-halfday-event"?"1":"2" + '"]').prop('checked', true);
            $('#calEventDialog #allday').val([calEvent.className == "gbcs-halfday-event" ? "1" : "2"]).prop('checked', true);
            $("#calEventDialog").dialog("option", "buttons", [
                {
                text: "Save",
                click: function() {
                    $(this).dialog("close");
                }},
            {
                text: "Delete",
                click: function() {
                    $(this).dialog("close");
                }},
            {
                text: "Cancel",
                click: function() {
                    $(this).dialog("close");
                }}
            ]);
            $("#calEventDialog").dialog("option", "title", "Edit Event");
            $('#calEventDialog').dialog('open');
        },
        editable: true
    });

    var title = $('#eventTitle');
    var start = $('#eventStart');
    var end = $('#eventEnd');
    var eventClass, color;
    $('#calEventDialog').dialog({
        resizable: false,
        autoOpen: false,
        title: 'Add Event',
        width: 400,
        buttons: {
            Save: function() {
                if ($('input:radio[name=allday]:checked').val() == "1") {
                    eventClass = "gbcs-halfday-event";
                    color = "#9E6320";
                    end.val(start.val());
                }
                else {
                    eventClass = "gbcs-allday-event";
                    color = "#875DA8";
                }
                if (title.val() !== '') {
                    $myCalendar.fullCalendar('renderEvent', {
                        title: title.val(),
                        start: start.val(),
                        end: end.val(),
                        allDay: true,
                        className: eventClass,
                        color: color
                    }, true // make the event "stick"
                    );
                }
                $myCalendar.fullCalendar('unselect');
                $(this).dialog('close');
            },
            Cancel: function() {
                $(this).dialog('close');
            }
        }
    });
});
```

```
<div id="calEventDialog">
    <form>
        <fieldset>
        <label for="eventTitle">Title</label>
        <input type="text" name="eventTitle" id="eventTitle" /><br>
        <label for="eventStart">Start Date</label>
        <input type="text" name="eventStart" id="eventStart" /><br>
        <label for="eventEnd">End Date</label>
        <input type="text" name="eventEnd" id="eventEnd" /><br>
        <input type="radio" id="allday" name="allday" value="1">
        Half Day
        <input type="radio" id="allday" name="allday" value="2">
        All Day
        </fieldset>
    </form>
</div>
<div style="border:solid 2px red;">
        <div id='myCalendar'></div>
</div>
```

我创建这个是为了回答另一个问题，但这清楚地展示了如何使用带有`select`回调的对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T17:54:21.817

我已经解决了我的问题，这在很大程度上要归功于 ganeshk 的示例。DOM 元素可用于所有 jQuery 函数，无论它们在代码中的什么位置，以及它们范围内的任何其他变量。我通过使用隐藏输入来保存 fullCalendar 回调的值，然后从 $.ajax() 函数访问它们以将数据发布到服务器，从而解决了这个问题。

我认为这是通常的做法，尽管它似乎有问题。这感觉就像污染全局范围一样不舒服，我担心页面上的其他脚本也可能想要操纵这些数据。我希望有更好的方法将参数传递给 $.dialog() 和 $.ajax() 等函数，以便子方法可以使用这些值。如果有，请告诉我。否则，这将起作用。

# python - Python 替换语句

> ID：12484744
> 
> 赞同：0
> 
> 时间：2012-09-18T20:45:22.487
> 
> 标签：python, linux, cpanel

我对 Python 很陌生，但需要在插件服务中修补这个故障/漏洞。

我的代码如下所示：

```
#!/usr/bin/env python
import subprocess
import sys
import os
import yaml
from xml.dom import minidom
sys.path.append('/scripts')
import createvhosts
doc = minidom.parse(sys.stdin)

param0taglist = doc.getElementsByTagName('param0')
param1taglist = doc.getElementsByTagName('param1')
param0 = param0taglist[0].childNodes[0].toxml()
param1 = param1taglist[0].childNodes[0].toxml()

domain = param0 + '.' + param1
usertaglist = doc.getElementsByTagName('USER')
user = usertaglist[0].childNodes[0].toxml()
f = open('/var/cpanel/userdata/' + user + '/main')
ydata = yaml.load(f)
f.close()
sublist = ydata['sub_domains']
addondict = ydata['addon_domains']
parkedlist = ydata['parked_domains']
mainlist = ydata['main_domain']
serverip = createvhosts.getmainip()
if len(sublist) != 0:
    slcont = 0
    while slcont < len(sublist):
        domain = sublist[slcont]
        docroot, yip, alias = createvhosts.getvars(sublist[slcont])
        if yip == serverip:
            createvhosts.writeconfshared(user, domain, docroot, yip, alias)
        else:
            createvhosts.writeconfded(user, domain, docroot, yip, alias)
        slcont = slcont + 1
proc = subprocess.Popen("/etc/init.d/nginx restart > /dev/null 2>&1", shell=True) 
```

问题是当您在 CPanel 中添加带有 * 的子域时，它会使服务器崩溃，因为显然 nginx 似乎不允许并接受它。我需要帮助做的是弄清楚如何替换/阻止 * 所以它不会进入。

类似的东西有用`Param0.find( "*" ) !=-1`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:30:46.523

您正在寻找的构造是`char in string`.

```
>>> s = 'ab*de'
>>> '*' in s
True 
```

把它放在一个条件中，你就得到了你想要的——比如：

```
if '*' in param0:
    raise ValueError("Can't use '*'!") 
```

[官方文档中的内置类型下](http://docs.python.org/library/stdtypes.html#sequence-types-str-unicode-list-tuple-bytearray-buffer-xrange)记录了这一点，以及字符串上可用的用于完成更多相关工作的方法的完整列表。

# php - cURL 停止为 HTTPS 站点工作

> ID：12484753
> 
> 赞同：1
> 
> 时间：2012-09-18T20:46:07.180
> 
> 标签：php, curl, libcurl

突然之间，我通过 SSL 访问网站的 PHP cURL 实现停止工作。在 cURL 响应标头中进行了一些挖掘之后，我发现问题是 cURL 不喜欢站点 SSL 证书的结果，给出了错误：

> 错误：14090086：SSL 例程：SSL3_GET_SERVER_CERTIFICATE：证书验证失败

现在我没有在其他网站上测试它，我知道有一些解决方案可以将 Mozilla 的证书添加到 cURL。但是为了让东西正常工作，我只是添加了一个新的 cURL 选项来禁用 SSL 有效性检查 (CURLOPT_SSL_VERIFYHOS)。

但我仍然对这如何在一天之内停止工作感到困惑。它昨天奏效了。网站上的证书没有改变，它仍然是威瑞信颁发的有效、未过期的证书。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T12:06:45.060

上个月我也遇到过这种情况，唯一的原因是有问题的 SSL 证书已过期。所以我只是更新了它，curl ssl 链接再次工作。如果您碰巧处理自签名证书，顺便说一句，您可以导入它或切换验证。

这是我唯一能想到的，但你说你已经证实了……很奇怪。有没有机会查看该站点的证书或者它是私有的？如果您没有更改任何内容，那么几乎可以肯定 SSL 证书发生了一些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T07:23:29.377

在 curl CURLOPT_SSL_VERIFYPEER, FALSE
CURLOPT_SSL_VERIFYHOST, 2中尝试这两个选项

# .net - 如何通过 Powershell 创建位图

> ID：12484758
> 
> 赞同：5
> 
> 时间：2012-09-18T20:46:36.893
> 
> 标签：.net, image, powershell, bitmap, system.drawing

我想学习使用 Powershell 创建/编辑图像。请帮我创建位图图像，用某种颜色填充它，将某些像素的颜色设置为其他颜色并将图像保存到文件中。

***编辑：***我尝试了以下代码，但得到了黑色位图

```
[System.Reflection.Assembly]::LoadWithPartialName("System.Drawing")
$bmp = New-Object System.Drawing.Bitmap(320, 240)

for ($i = 0; $i -lt 100; $i++)
{
   for ($j = 0; $j -lt 100; $j++)
   {
     $bmp.SetPixel($i, $j, 1000)
   }
}

$bmp.Save("f:\Temp\bmp.bmp")
ii f:\Temp\bmp.bmp 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T21:48:13.993

`SetPixel`接受类型的最终参数`System.Drawing.Color`。Powershell 正在将整数`1000`转换为`Color`对象，这基本上以“黑色”颜色结束：

```
PS > [system.drawing.color] 1000

R             : 0
G             : 3
B             : 232
A             : 0       # A is "Alpha", aka opacity. A = 0 -> full transparent
IsKnownColor  : False
IsEmpty       : False
IsNamedColor  : False
IsSystemColor : False
Name          : 3e8 
```

您可以传递与[已知命名颜色](http://msdn.microsoft.com/en-us/library/system.drawing.color_properties.aspx)相对应的字符串（例如），或者从或中`'Red'`创建自定义 RGB 颜色，其中所有参数可以是 0 到 255（含）。[请参阅此处](http://msdn.microsoft.com/en-us/library/cce5h557.aspx)和[此处](http://msdn.microsoft.com/en-us/library/at1k42eh.aspx)的文档。`[System.Drawing.Color]::FromArgb($r, $g, $b)``[System.Drawing.Color]::FromArgb($a, $r, $g, $b)`

```
for ($i = 0; $i -lt 100; $i++)
{
   for ($j = 0; $j -lt 100; $j += 2)
   {
     $bmp.SetPixel($i, $j, 'Red')
     $bmp.SetPixel($i, $j + 1, [System.Drawing.Color]::FromArgb(0, 100, 200))
   }
} 
```

# jakarta-ee - apache tomcat 7.0.30 datasourcerealm javax.naming.NameNotFoundException：名称 [jdbc/proto] 未绑定在此上下文中。找不到 [jdbc]

> ID：12484759
> 
> 赞同：6
> 
> 时间：2012-09-18T20:46:37.907
> 
> 标签：jakarta-ee, jndi, tomcat7, osx-mountain-lion, mysql5

我先描述一下环境：

**环境：** - mac os x (java build 1.6.0_35-b10-428-11M3811) - apache tomcat 7.0.30 - mysql 5.5.27 - tomcat/lib --> mysql-connector-java-5.1.22-bin.jar

**我已经成功实现了 JDBCRealm**并希望切换到 DataSourceRealm，因为它被推荐用于生产环境。我使用基于表单的身份验证。

我做了这里描述的一切：http: [//tomcat.apache.org/tomcat-7.0-doc/realm-howto.html#DataSourceRealm](http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html#DataSourceRealm) 和这里：http: [//tomcat.apache.org/tomcat-7.0-doc/jndi- datasource-examples-howto.html#MySQL_DBCP_Example](http://tomcat.apache.org/tomcat-7.0-doc/jndi-datasource-examples-howto.html#MySQL_DBCP_Example)

**服务器.xml**

```
<Realm className="org.apache.catalina.realm.LockOutRealm">
     <Realm className="org.apache.catalina.realm.DataSourceRealm" 
            dataSourceName="jdbc/proto" digest="SHA-256" roleNameCol="role" 
            userCredCol="password" userNameCol="name" userRoleTable="roles" 
            userTable="users"/>
</Realm> 
```

**上下文.xml**

```
<Resource auth="Container" 
          driverClassName="com.mysql.jdbc.Driver" 
          maxActive="100" maxIdle="30" maxWait="10000" 
          name="jdbc/proto" password="proto" type="javax.sql.DataSource" 
          url="jdbc:mysql://localhost:3306/proto" username="proto"/> 
```

**WEB-INF/web.xml**

```
<resource-ref>
    <description>DB Connection</description>
    <res-ref-name>jdbc/proto</res-ref-name>
    <res-type>javax.sql.DataSource</res-type>
    <res-auth>Container</res-auth>
</resource-ref> 
```

当我提交用户名和密码时，出现以下异常：

```
Sep 18, 2012 9:38:32 PM org.apache.catalina.realm.DataSourceRealm open
SEVERE: Exception performing authentication
javax.naming.NameNotFoundException: Name [jdbc/proto] is not bound in this Context. Unable to find [jdbc].
at org.apache.naming.NamingContext.lookup(NamingContext.java:820)
at org.apache.naming.NamingContext.lookup(NamingContext.java:168)
at org.apache.catalina.realm.DataSourceRealm.open(DataSourceRealm.java:394)
at org.apache.catalina.realm.DataSourceRealm.authenticate(DataSourceRealm.java:285)
at org.apache.catalina.realm.CombinedRealm.authenticate(CombinedRealm.java:146)
at org.apache.catalina.realm.LockOutRealm.authenticate(LockOutRealm.java:180)
at org.apache.catalina.authenticator.FormAuthenticator.authenticate(FormAuthenticator.java:295)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:450)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:680) 
```

我没有尝试在不同的操作系统上设置环境来测试它是否是特定于 mac 的问题。

我错过了什么建议？我感谢您的帮助！谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T13:02:12.420

为避免在 GlobalNamingResources 中声明资源，请将 localDataSource="true" 放入 Realm

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T20:50:18.053

在这种情况下，我相信这是因为您的领域（在这种情况下它是在服务器级别声明的）正在尝试使用命名资源*jdbc/proto*（在这种情况下是在 Web 应用程序级别声明的）

这是我理解的java服务器上下文层次结构

1.  服务器
2.  主持人
3.  WebApplication 上下文（可以在 server.xml 或 META-INF Context.xml 中）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-05T09:38:49.420

实际上，这`[jdbc/proto]`在 ProjectName.xml 中作为属性提到

```
<ResourceLink global="jdbc/proto" name="jdbc/proto"/> 
```

因此，请确保 ProjectName.xml 文件存在 `tomcatInstances/ServerName/conf/Catalina/localhost/ProjectName.xml` 并具有此资源链接，并且您的异常消失了。

我也遇到了同样的问题，并且由于某种原因从位置删除了应用程序的本地上下文文件

```
tomcatInstances/ServerName/conf/Catalina/localhost/ProjectName.xml 
```

从后面恢复文件并完成......现在工作正常，希望这会对某人有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T01:10:11.517

就我而言，问题是我的 pom.xml 中有一个冲突的依赖项。就我而言，这是`java-naming`依赖关系。确保您没有任何与 Tomcat 的命名库冲突的命名依赖项/jar。

删除它后，问题就消失了（顺便说一句，环境与您相同）。

# javascript - 在 jQuery 中模拟实时输入

> ID：12484760
> 
> 赞同：0
> 
> 时间：2012-09-18T20:46:40.863
> 
> 标签：javascript, jquery, javascript-events

我正在尝试编写一个将输入的当前值（int）转换为单词的脚本。

```
var th = ['', 'thousand', 'million', 'billion', 'trillion'];
var dg = ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine'];
var tn = ['ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
var tw = ['twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];

function toWords(s) {
    s = s.toString();
    s = s.replace(/[\, ]/g, '');
    if (s != parseFloat(s)) return 'You must enter a number';
    var x = s.indexOf('.');
    if (x == -1) x = s.length;
    if (x > 15) return 'too big';
    var n = s.split('');
    var str = '';
    var sk = 0;
    for (var i = 0; i < x; i++) {
        if ((x - i) % 3 == 2) {
            if (n[i] == '1') {
                str += tn[Number(n[i + 1])] + ' ';
                i++;
                sk = 1;
            }
            else if (n[i] != 0) {
                str += tw[n[i] - 2] + ' ';
                sk = 1;
            }
        }
        else if (n[i] != 0) {
            str += dg[n[i]] + ' ';
            if ((x - i) % 3 == 0) str += 'hundred ';
            sk = 1;
        }
        if ((x - i) % 3 == 1) {
            if (sk) str += th[(x - i - 1) / 3] + ' ';
            sk = 0;
        }
    }
    if (x != s.length) {
        var y = s.length;
        str += 'point ';
        for (var i = x + 1; i < y; i++) str += dg[n[i]] + ' ';
    }
    return str.replace(/\s+/g, ' ');
    return false;
}

var input = $('#numbers'),
    label = $('.words'),
    converted = toWords(input.val());

input.bind('keyup keydown', function() {
    converted = toWords(this.value)
    setTimeout(function() {
        label.empty().text(converted);
    }, 1000);
});​ 
```

此时，我可以输入任何我输入的内容，但是一旦我通过 toWords 函数发送它，它就会获取页面加载时给出的输入值。

换句话说，它不会用我输入的新数字更新输入字段的值，然后它应该转换为单词。

有任何想法吗？- [http://jsfiddle.net/qTBxv/211/](http://jsfiddle.net/qTBxv/211/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T20:48:49.830

您必须使用输入的新值更新转换后的变量。

```
$(document).ready(function(){
    input.bind('keyup', function() {
        setTimeout(function() {
            converted = toWords(input.val());
            label.append(converted);
    }, 500);
    });
}); 
```

演示：http: [//jsfiddle.net/qTBxv/214/](http://jsfiddle.net/qTBxv/214/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T20:53:52.267

添加对 的调用`toWords`，同时在附加事件中传递当前输入值。

```
input.bind('keyup keydown', function() {
    converted = toWords(this.value)
    setTimeout(function() {
        label.empty().text(converted);
    }, 1000);
});​ 
```

### [演示](http://jsfiddle.net/FranWahl/qTBxv/217/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T20:54:21.987

您需要确保`converted`每次值更改时都进行更新（在这种情况下，您正在挂钩关键事件，因此您可以在那里进行）。像这样：

```
var input = $('#numbers'),
    label = $('.words'),
    converted;

input.bind('keyup keydown', function() {
    converted = toWords(input.val());
    setTimeout(function() {
        label.empty().text(converted);
    }, 1000);
});​ 
```

这似乎为我解决了问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-07T17:45:37.457

我可能会建议[将 angularJS](http://angularjs.org/)作为您的最终答案。

# ssas - 运行具有多个层次结构的总计

> ID：12484761
> 
> 赞同：1
> 
> 时间：2012-09-18T20:46:49.647
> 
> 标签：ssas, mdx

我有一个具有多个层次结构的日期维度（大多数情况下）。我有许多作为运行总计计算的度量，如下例所示。

`AGGREGATE([Date].[Calendar].[Date].Members.Item(0):ClosingPeriod([Date].[Calendar].[Date], [Date].[Calendar].CurrentMember), [Measures].[Number Of Contracts])`

我的问题是运行总计仅适用于日历层次结构（按年、月和日分解所有内容）。如果我改为使用 Weeks hiearchy （按单个周分解），则计算不起作用，它只会显示每周相同的数字。

MDX 中是否有一种高效的方法可以使运行的总工作量适用于多个层次结构？到目前为止，我尝试的一切都非常缓慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T13:30:07.470

下面是一种可能的解决方案。通过使用 EXISTING 关键字，可以获得当前上下文中存在的所有 Date 成员的列表，然后使用这些日期来定义聚合数据的范围。根据我的初步测试，性能类似于问题中的计算。

`AGGREGATE(NULL:TAIL(EXISTING [Date].[Date].[Date].Members).Item(0), [Measures].[Number Of Contracts])`

[在http://www.purplefrogsystems.com/blog/2010/08/mdx-calculated-member-spanning-multiple-date-dimensions/](http://www.purplefrogsystems.com/blog/2010/08/mdx-calculated-member-spanning-multiple-date-dimensions/)中描述了另一种可能更高效的解决方案。它通过计算所有适用层次结构的范围，然后将这些层次结构交叉连接在一起来解决问题。

`AGGREGATE({ NULL:[Date].[Calendar].CurrentMember } * { NULL:[Date].[Week].CurrentMember })`

此解决方案的唯一缺点是，如果您有许多彼此之间没有属性关系的层次结构，它可能会变得冗长。

# css - 如何在inputTextarea（PrimeFaces）中设置固定高度

> ID：12484766
> 
> 赞同：5
> 
> 时间：2012-09-18T20:46:59.067
> 
> 标签：css, primefaces

我尝试这样做：

```
<p:inputTextarea id="lineTest" rows="7" cols="33" style="height: 100px; overflow:auto;" value="#{manageLineBean.lineTest}" /> 
```

但是当大量写入时，该字段的高度会增加。如何使用 just 解决此问题`overflow:auto`？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-18T22:52:36.957

尝试设置 autoResize="false"，否则，在文档中搜索类似的属性。

UPD： [http ://www.scribd.com/doc/98840317/74/InputTextarea](http://www.scribd.com/doc/98840317/74/InputTextarea)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-03-01T00:30:13.180

autoResize=false 只移除右侧的调整大小小部件，但是当您输入文本时它仍然会增大输入框

这将解决它...

```
textarea.p-inputtext {
  max-height: 5rem;
  resize: none;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-09-29T13:54:07.030

设置`min-height`属性帮助了我：

```
<textarea pInputTextarea [rows]="1" [cols]="30" autoResize="autoResize" style="min-height: 30px; overflow:auto;"></textarea> 
```

# symfony - Symfony2 测试中的数据库清理

> ID：12484770
> 
> 赞同：5
> 
> 时间：2012-09-18T20:47:04.647
> 
> 标签：symfony, phpunit

当您使用 Symfony2/PHPUnit 进行测试时，是否有在每次测试之前（或之后）清理数据库的标准方法？在 Rails 中似乎有一种标准的、明显的方法可以做到这一点，但我在 Symfony 社区中没有找到类似的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T08:17:32.127

您可以使用 Doctrine 的数据清除器清除表或在每次测试之前重建模式。

Purger 是 data-fixtures 包的一部分：[https ://github.com/doctrine/data-fixtures](https://github.com/doctrine/data-fixtures)

我曾经写过一个 KernelAwareTest，它会在每次测试之前重建架构：[https ://gist.github.com/1319290](https://gist.github.com/1319290)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-01T18:24:59.357

如果您使用的是[LiipFunctionalTestBundle](https://github.com/liip/LiipFunctionalTestBundle)，则每次加载固定装置时都会清除数据库。如果您不需要加载任何夹具，您仍然可以调用`$this->loadFixtures(array());`("load no fixtures") 来清除数据库。

# java - 使用内部类创建自定义对象，创建该对象的数组，并使用 Java 访问该对象中的信息

> ID：12484771
> 
> 赞同：0
> 
> 时间：2012-09-18T20:47:06.707
> 
> 标签：java, class

稍后编码第一个问题......

```
public class Program2 
{
//The custom word object used when parsing the input file
class Word
{
    public String wordname;
    public int count;
    public int uniqueWord = 0;

    public Word(String word)
    {
        wordname = word;
        count = 1;
    }

    public boolean wordExists(String word)
    {
        if (word == this.wordname)
        {
            this.count++;
            return true;
        }
        else
        {
            return false;
        }   
    }

    public int getCount(Word word)
    {
        return this.count;
    }

    public String getName(Word word)
    {
        return this.wordname;
    }

}

// The main method
public static void main(String[] args) throws IOException
{
    //new array of words size 100
    Word[] words = new Word[100];
    //set the first word to bananna
    Word words[0] = new Word("bananna");
    //print bananna
    System.out.print(getName(words[0]));
}
} 
```

好的，根据我对 Java 的了解，上面的代码应该让我创建一个单词数组，将第一个设置为“bananna”，然后将其打印出来。我几乎没有制作这样的自定义类的经验，也找不到很好的建模资源。此外，我不是 100% 确定我理解调用静态/非静态方法，所以我确信一些错误也来自于此。

程序最终应该做什么，作为我为什么这样做的参考，我必须从文件中获取信息（分隔字符串也就是单词）并查看它是否已经存在于单词数组中（如果确实如此），如果没有，则创建一个新词。

我得到的错误在这里：

* * *

```
Program2.java:116: ']' expected
            Word words[0] = new Word("bananna");
                       ^
Program2.java:116: illegal start of expression
            Word words[0] = new Word("bananna");
                        ^
2 errors 
```

* * *

如果您需要任何其他信息，请告诉我。我会在一小时后回来查看这篇文章。感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:52:58.487

```
Word words = new Word[100]; 
```

我可以看到您的主要问题是`Word[100]`包含 Word 对象的 Array 类型。您需要 words 变量是 type `Word[]`，而不仅仅是 type `Word`。

关于静态和非静态，可以这样想：您已经编写了一个 Word*类*，然后您可以创建任意数量的属于该类的Word*对象。*当某事物是*静态*的时，表示它属于 Word*类*，因此它属于一个词的定义，不属于任何特定的词。相反，非*静态*的东西将属于特定的 Word 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:53:01.390

当您尝试创建数组时出现语法错误，您应该有：

```
Word[] words = new Word[100]; 
```

如果要在`Word.newWord()`不调用Word 类*实例*上的方法的情况下进行调用，则此方法需要是`static`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T20:54:32.823

让我们从第一条错误消息开始。这告诉您`Word[]`并且`Word`是不兼容的类型。最后`[]`的 告诉你这是一个`Word`对象数组。换句话说，`Word words`声明对单个`Word`对象的引用。而您的使用`new`分配了它们的数组。要解决此问题，只需更改为`Word[] words`.

我不会详细介绍其他错误消息，因为在您修复此错误消息后它们可能会发生变化。祝你的 Java 好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T20:56:38.877

问题在于您创建对象数组的方式。您应该声明 Class 的数组，然后创建对象：

```
//new array of words size 100
Word[] words = new Word[100]; 
```

//然后创建对象

```
words[0] = new Word("apple"); 
```

# qt - 如何将 cookie 从文件传递给 QNetworkAccessManager

> ID：12484773
> 
> 赞同：2
> 
> 时间：2012-09-18T20:47:21.263
> 
> 标签：qt, network-programming

我有一个名为 cookies.txt 的 cookie 文件。我想将它传递给 QNetworkAccessManager 对象。语法是什么？

# php - 使用 jquery 强制下载

> ID：12484781
> 
> 赞同：0
> 
> 时间：2012-09-18T20:47:47.213
> 
> 标签：php, jquery, force-download

我需要制作一个按钮，当我点击它时，如果我有这样的表格，我也会这样做：

```
<form action="myscript.php" method="post">
    <input type="hidden" name="items[]" value="..." />
    <input type="submit">
</form> 
```

并点击提交。在**PHP**方面，我使用正确的标头并进行强制下载。

我这里之所以不能使用表单，是因为我有很多参数，而且在我的**HTML**标记中使用表单标签并不是那么容易。而且，这些参数是动态生成的，所以...

但是如果我使用 just `$.ajax`course 是行不通的，我只会在这个 ajax 请求中得到 php 响应，但是浏览器不会开始下载文件

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T12:01:58.893

简单的答案：不要使用 GET。请改用 POST！

```
<script>
 var info = ""; // Somewhere for the response to go
 var obj = $.post(
             raw_url,
             { var1:value1, var2:value2 },
             function(data) { info = data; } );
</script> 
```

在 PHP 方面，您将接收任何基于数组的数据作为数组（因此，如果 value2 是 javascript 数组，您也会在 PHP 中将其作为数组接收。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:54:09.770

只需重定向到下载页面，如果该页面上有正确的标题，它不会更改它们所在的页面，只需在提示下下载文件即可。

# c# - 使用 DataTable 过滤器进行 MySQL 相关性搜索

> ID：12484789
> 
> 赞同：0
> 
> 时间：2012-09-18T20:48:30.417
> 
> 标签：c#, mysql, winforms, ado

我们希望能够根据我们的程序在用户创建问题、票证等时创建的标签，从我们的 WinForms 应用程序的数据库中返回各种“建议”。

使用 SQL 完成后，我们用来提取此信息的 SQL 非常简单：

```
SET @termz='random words influence topics';
SELECT _TABLE_.*, MATCH (term, description) AGAINST (@termz) AS relevance, MATCH (term) AGAINST (@termz) AS title_relevance
FROM _TABLE_
WHERE MATCH (term, description) AGAINST (@termz IN BOOLEAN MODE) 
HAVING title_relevance > 5
ORDER BY title_relevance DESC, relevance DESC; 
```

但是，我会假设即使在存储过程调用中，在创建每个票证或每次击键（例如，用于实时搜索或实时建议）时不断发送诸如上述的查询，这将是一个有用的“罪”，因为你们这里的人如此有名地一直称呼它。

所以，我会假设，我只需要针对本地、断开连接的 DataSet 运行这些类型的查询，并基于此返回结果。因为它不必每次都查询实际的数据库，所以我可以创建一个过滤器或视图来使用，然后填充任何列表等，人们可以用来读取相关信息。

但是，如何编写像上面这样的过滤器/视图？甚至可能吗？

# asp.net-mvc - 在 MVC .NET 中执行操作之前更新表单值的方法

> ID：12484792
> 
> 赞同：0
> 
> 时间：2012-09-18T20:48:46.757
> 
> 标签：asp.net-mvc, custom-attributes

我们收到客户的请求，他们希望他们网站上的每个表单都将某些字段存储在 cookie 中，以便每次在第一次提交后，表单都会使用 cookie 中的数据填充。

我们创建了一个 actionfilter 属性以用于需要此功能的方法。想法是将 FormCollection 的数据存储在 cookie 中，每次调用操作时，我们都会检查 cookie 是否存在并相应地更新值。

问题是表单是只读的，不能修改。我将如何实现此功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:19:36.560

一种技术是创建一个自定义模型绑定器，该绑定器从 cookie 中填充模型以获取适当的属性，然后使用默认模型绑定器获取其余属性。

你可以从[这里](http://odetocode.com/blogs/scott/archive/2009/05/05/iterating-on-an-asp-net-mvc-model-binder.aspx)和[这里](https://stackoverflow.com/questions/970335/asp-net-mvc-mixing-custom-and-default-model-binding)`DefaultModelBinder`描述的得到。

# xml - 从xml中提取信息

> ID：12484798
> 
> 赞同：1
> 
> 时间：2012-09-18T20:49:13.193
> 
> 标签：xml, xpath

我可以知道如何使用 xpath 从以下 html 中提取 2,34 吗？为此，我正在使用 htmlceaner，我认为我不能使用 normalize-space() 并注意我应该使用标签值，否则会有很多返回值。此外，xyz 值周围有很多空格。为了说明，我省略了 html 的其余部分。

`<tr><td colspan="2"> <strong> XYZ </strong> </td><td align="right"> <strong> 2,34&nbsp; </strong> </td>`

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T03:15:02.860

**使用**：

```
substring-before(/*/td[2]/strong, '&#xA0;') 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:template match="/">
  <xsl:value-of select="substring-before(/*/td[2]/strong, '&#xA0;')"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**（更正为格式正确）：

```
<tr>
    <td colspan="2">
        <strong> XYZ </strong>
    </td>
    <td align="right">
        <strong> 2,34&#xA0;; </strong>
    </td>
</tr> 
```

**计算 XPath 表达式，并将计算结果复制到输出：**

```
 2,34 
```

# c# - 托管 DLL 方法在 installshield 中失败

> ID：12484811
> 
> 赞同：0
> 
> 时间：2012-09-18T20:49:48.223
> 
> 标签：c#, installation, windows-installer, installshield, managed

好的，所以我有以下用 C# 编写的类库：

```
public class Program
{
    public void GetProductID(string location, out string productId)
    {
        ManagementObjectSearcher searcher = new ManagementObjectSearcher("SELECT * FROM Win32_Product");
        ManagementObjectCollection collection = searcher.Get();
        var item = new Win32Product();
        //var crap = (collection as IEnumerable<ManagementObject>).Where(o => o["InstallLocation"].ToString().StartsWith(location));
        foreach (ManagementObject obj in collection)
        {
            try
            {
                item = new Win32Product();
                item.IdentifyingNumber = (string)obj["IdentifyingNumber"];
                item.InstallLocation = (string)obj["InstallLocation"];
                item.Name = (string)obj["Name"];
            }
            catch
            { }  //shut up. I know it's an empty catch block. Its fine.
                 //If there are exceptions thrown, I don't want the data, I just
                 //want to keep running.
        }
        productId = item.ProductID.ToString();
    }        
} 

public class Win32Product
{
   //properties
} 
```

不是很多，`GetProductId()`只是搜索给定目录下的任何已安装程序。如果我在其他地方对其进行测试，它可以正常工作，但是从 installshield 运行（作为控制事件）时，它会失败（返回值 3）。

我猜这是一个模糊的问题，但知道为什么`GetProductInfo()`installshield 会失败吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:19:32.967

这里有一些阅读材料给你：

[部署工具基础 (DTF) 托管的自定义操作](http://blog.deploymentengineering.com/2008/05/deployment-tools-foundation-dtf-custom.html)

[DTF 更好的原因](http://blog.iswix.com/2008/07/reasons-dtf-is-better.html)

顺便说一句，Win32_Product 类是一个 POS。它在包装底层 MSI API 方面做得很差。当您切换到 DTF 时，请改用 ProductInstallation::GetProducts 方法。调用 MsiEnumProductsEx 做得更好。

# apache - .htaccess mod_rewrite 中的“或”标志

> ID：12484814
> 
> 赞同：39
> 
> 时间：2012-09-18T20:50:02.490
> 
> 标签：apache, .htaccess, mod-rewrite, apache2, rewrite

刚刚发现这个 .htaccess 重写代码

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^my.domain.com$ [NC,OR]
RewriteCond %{REQUEST_URI} !public/
RewriteRule (.*) /public/$1 [L] 
```

我想知道“OR”标志的目的是什么。已经检查了文档[http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteflags](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteflags)但可以找到任何信息。

有任何想法吗？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-09-18T20:54:43.077

来自[http://httpd.apache.org/docs/current/mod/mod_rewrite.html](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)

`ornext|OR`（或下一个条件）使用它来将规则条件与本地 OR 而不是隐式 AND 组合。典型例子：

```
RewriteCond %{REMOTE_HOST}  ^host1  [OR]
RewriteCond %{REMOTE_HOST}  ^host2  [OR]
RewriteCond %{REMOTE_HOST}  ^host3
RewriteRule ...some special stuff for any of these hosts... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-06-13T12:17:39.890

[OR] 用于当您想要一个 OR 另一个 OR 另一个条件触发重写时。否则，默认行为是“与”所有 RewriteConds 必须为真才能触发规则。

# ios - 尝试使用 iPad 进行开发时发生未知错误

> ID：12484817
> 
> 赞同：46
> 
> 时间：2012-09-18T20:50:03.963
> 
> 标签：ios, xcode, provisioning-profile, organizer, deployment-target

我试图在新 iPad 上测试我的应用程序，以查看 Retina 支持是否有效。

像我用于开发的任何其他设备一样，我连接了设备并按下“用于开发”是 XCode Organizer。

该过程开始，但几秒钟后进度条消失了，我收到此错误消息：“发生未知错误”

我在设备部分手动注册了它的 UDID，并且配置文件已成功安装在设备上，但在管理器中 iPad 的名称前仍有一个黄点，并且该设备未出现在 iOS 设备列表中（因此我无法运行我的应用程序）。

我尝试了任何事情，但没有任何结果:(

![在此处输入图像描述](../Images/a10268245f104d6a59140993c859e757.png)

有任何想法吗 ？

* * *

**附加信息 ：**

*   XCode 版本：4.4.1
*   iOS SDK 版本：5.1
*   最低部署目标：5.0
*   设备 iOS 版本：5.1.1 (9B206)
*   设备类型：第三代新 iPad（Wifi + 4G）
*   基于 Intel 的 Mac：配备 2 x 2.26 GHz 四核 Intel Xeon 的 Mac Pro
*   操作系统版本：OS X Mountain Lion 10.8 (12A269)

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2012-09-18T22:20:48.867

尝试断开/重新连接 iPad，退出并重新启动 XCode，...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-05-08T01:47:03.857

当我通过 Apple USB 键盘（下方有两个 USB 端口）插入时，这种情况经常发生在我身上。

如果您在该键盘上插入多个东西，例如两部 iPhone，它将无法为两者提供足够的电力，并且您开始出现间歇性断开连接。

解决方案：直接插入Mac。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-10-08T14:18:54.760

有一次这种情况发生在我身上，我的设备上的 iCloud 帐户似乎没有登录。这是由于我更改了密码。一旦我使用正确的密码重新登录，该应用程序似乎就可以很好地构建到设备上。:-)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-11-18T21:03:22.217

就我而言，在尝试了所有操作（重新启动 Ipad、XCode、imac）之后，我发现问题是由上一次运行时仍在 Ipad 后台运行的同一个应用程序引起的。我只需要从 Ipad 上关闭该应用程序，一切都得到了修复。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-08T15:01:53.150

不是重复的，但是 OS X、XCode 和 IOS 经常因为代码签名和缓存失败而陷入困境，看看这里是否有任何帮助：[错误：在 ipad 上运行时启动失败](https://stackoverflow.com/questions/9469669/error-failed-to-launch-when-running-on-ipad/10503762#10503762)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-29T18:24:35.273

我能够通过将签名身份从一个团队更改为另一个团队，然后再改回原来的团队来解决此问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-07-29T05:13:16.850

您可以使用 xcode->windows->devices 并查看设备日志以获取有关“发生未知错误”的更多详细信息，您将获得如下信息：

*   0x16e12f000 +[MICodeSigningVerifier _validateSignatureAndCopyInfoForURL:withOptions:error:]: 142: 无法验证 /private/var/mobile/Library/Caches/com.apple.mobile.installd.staging/temp.L5Dvt0/extracted/Payload/Xxx 的代码签名.app/PlugIns/packetTunnel.appex : 0xe8008001（发生未知错误。）

我在以下情况下看到“发生未知错误”并通过更正代码来修复它：

*   我用一个类编写@interface，并在扩展目标中忘记了带有该类名的@implementation。
*   我的项目的一个目标中没有代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-05-13T18:12:38.930

尝试在仅剩 300MB 的设备上安装 1GB 应用程序时出现此错误。我没想到它会成为问题，因为该应用程序已经从 iTunes 安装在设备上，而我只是安装了一个本地构建来覆盖它，但我反复收到此错误，直到我从商店卸载了副本。在那之后，它工作得很好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-27T08:38:45.900

我只能通过重新连接手机然后在我的笔记本电脑上使用 iCloud 欢迎屏幕来让它工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-09T23:33:40.423

我发现因为我的iphone没电了，我一直在充电，所以需要先用pin打开手机才能让Xcode连接

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-17T19:47:52.953

当我安装新的 pod（CocoaPods）时，我收到了同样的错误消息。我可以通过从我的项目中删除最新添加的 pod 来解决这个问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-09-20T15:05:59.247

当iTunes在后台打开时发生在我身上。关闭 iTunes 和 Xcode，然后重新打开 Xcode 对我有用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-06-26T09:01:44.847

我经常遇到同样的麻烦：iPhone重启每次都会修复它

# sql-server-2008 - 子查询 Jelp 中的 SQL Server 案例计数？

> ID：12484819
> 
> 赞同：1
> 
> 时间：2012-09-18T20:50:10.160
> 
> 标签：sql-server-2008, aggregate-functions, case

我的表中有很多种statusid。某些值意味着表中的工作是“完整的”。

如果某事是“完整的”，则分组 checkid 的所有 statusid 值都是 1 或 10 或 40。Statusid 值不是连续的（有许多 statusid 值，这只是一个摘录）。有人可以展示我如何在案例子查询中执行 In 子句，或者只是一种更简洁的方式来编写它吗？

预期结果集

```
 checkid    iscomplete
    3           0
    4           1
    5           0
    6           0 
```

4 是完整的，因为只有一行并且它有一个“10”。3 不完整，因为其中一个值为“1”，而其他值为“2”。5 不完整，因为它只有“30”个值。6 不完整，因为它有一个“40”，但也有一个“30”。

DML：

```
create table #test1 ( test1id int identity primary key , checkid int  , statusid int )
insert into #test1 ( checkid , statusid ) values (3 , 1)
insert into #test1 ( checkid , statusid ) values (3 , 2)
insert into #test1 ( checkid , statusid ) values (3 , 2)
insert into #test1 ( checkid , statusid ) values (4 , 10)
insert into #test1 ( checkid , statusid ) values (5 , 30)
insert into #test1 ( checkid , statusid ) values (5 , 30)
insert into #test1 ( checkid , statusid ) values (6 , 30)
insert into #test1 ( checkid , statusid ) values (6 , 40)

select  checkid 
, iscomplete =  ( case when count(*) Where #test1.statusid In ( 1,10,40) Then 1 )
from #test1
group by checkid 
```

错误：

> 在预期条件的上下文中指定的非布尔类型的表达式，靠近“Where”。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T05:09:02.533

编写查询以满足要求的一种方法是：

```
SELECT
    t.checkid,
    CASE 
        WHEN COUNT_BIG(*) = COUNT
            (
            CASE 
                WHEN t.statusid IN (1,10,40)
                THEN 1 
                ELSE NULL 
            END
            ) 
        THEN 1 
        ELSE 0 
    END
FROM #test1 AS t
GROUP BY
    t.checkid
ORDER BY
    t.checkid; 
```

这利用了`COUNT`(expression) 聚合不计数的事实`NULL`（aisde: 尽管`COUNT(*)`会）。对于所有条目都是状态 1、10 或 40 的组，嵌套`CASE`将为该组中的每一行返回 1，等于该组的 COUNT(*)。如果组中的一个成员不是状态 1、10 或 40，则嵌套`CASE`将返回`NULL`，不会被 计数`COUNT`。

# c++ - 从不同的构造函数将参数传递给类构造函数？

> ID：12484820
> 
> 赞同：1
> 
> 时间：2012-09-18T20:50:11.477
> 
> 标签：c++, constructor

> **可能重复：**
> [c++ 从构造函数调用构造函数](https://stackoverflow.com/questions/308276/c-call-constructor-from-constructor)

我有同一个类的两个构造函数，我希望其中一个构造函数将数据发送到第二个构造函数。

我知道如何在 C# 中做到这一点，但我是 C++ 新手，我不知道这是否可能像这样：

```
class a 
{

public:
a (int x);
a (int x, int b, char g);

};

a :: a(int x) : this(x, 6, 'h')
{

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:53:57.630

新的 C++11 标准支持此功能（称为委托构造函数）。语法如下：

```
a::a(int x) : a(x, 6, 'h') {} 
```

如果您的编译器不支持新标准，则需要将常见行为提取到另一个初始化方法中并在构造函数主体中调用该方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:58:05.613

在[C++11](http://en.wikipedia.org/wiki/C%2B%2B11#Object_construction_improvement)中是可能的，但在早期版本中是不可能的。

通常，您可以尝试将常见的东西放入（非虚拟）成员函数中，然后从构造函数中调用它。虽然这不允许您初始化所有内容（仅在构造函数主体中执行的操作，而不是在序言中的初始化），但它仍然可能“总比没有好”。

# django - django 包含标签 kwargs 错误说“函数需要 2 个参数”

> ID：12484822
> 
> 赞同：1
> 
> 时间：2012-09-18T20:50:30.267
> 
> 标签：django, templates, django-custom-tags

我已经写了包含标签，它需要上下文和 *args 和 **kwargs

```
@register.inclusion_tag('template.html', takes_context=True)
def my_tag(a, b, *args, **kwargs):
    print 'Kwargs: '
    return ..... 
```

**模板：**

```
 {% my_tag 1 1 2 page=10 %}

Error message:
Request Method:     GET
Request URL:    http://localhost:8000/
Django Version:     1.3.1
Exception Type:     TemplateSyntaxError
Exception Value:    

my_tag takes 2 arguments 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T07:02:09.323

既然你已经放`takes_context=True`了，函数的第一个参数一定是`context`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T03:56:34.060

是的，我发现了问题，问题 *args 和 **kwargs 在 Django 1.4 中实现，但我在 Django 1.3.1 中尝试了此功能，这就是它显示此类错误的原因

为了更清楚，请查看 Django 1.4 发行说明。[Django1.4 发行说明](https://docs.djangoproject.com/en/1.4/releases/1.4/)

# algorithm - 不是线性代数的 O(n^2) 和 O(n^3) 算法列表？

> ID：12484831
> 
> 赞同：1
> 
> 时间：2012-09-18T20:51:01.000
> 
> 标签：algorithm, linear-algebra, blas

我一直在阅读很多关于矩阵向量乘法 (BLAS2) 和矩阵矩阵乘法 (BLAS3) 的性能优化的[论文。](http://www.informatik.uni-trier.de/~ley/db/indices/a-tree/d/Demmel%3aJames.html)我想考虑这些优化是否/如何应用于 O(n^2) 和 O(n^3) 算法，这些算法不能完全简化为密集或稀疏线性代数。

很容易找到 NP-complete 或 NP-hard 算法的列表，但我还没有找到常见（和不太常见）多项式时间算法的良好细分。谁能建议一个多项式时间问题的列表，其中最著名的算法是 O(n^2) 或 O(n^3)？

编辑：为了使这一点更具体，我正在寻找类似[这个*NP-complete questions*](http://en.wikipedia.org/wiki/List_of_NP-complete_problems)列表的东西，但是对于n^2 或 n^3 算法的*多项式*[问题。](http://en.wikipedia.org/wiki/List_of_NP-complete_problems)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:37:39.327

第一：值得注意的是，二级和三级BLAS操作的复杂度实际上形式上是O(n)和O(n^3/2)；输入矩阵本身就是人们通常认为的“n”的二次方。

通常用于密集线性代数的技术并不真正直接应用于其他问题域，因为它们倾向于大量使用问题的线性。

接下来：O(n^2) 算法的一些最常见示例是用于排序、整数乘法和计算离散傅里叶变换的朴素算法。在所有这些情况下，都存在具有较低复杂度的更好算法。同样，还有大量朴素的 O(n^3) 算法。

可以应用密集线性代数技术来计算 DFT（因为它也是线性的），但是使用 FFT 算法之一可以做得更好，所以实际上没有人这样做。

就非朴素算法而言，我不得不教授复杂性课程已经太久了。IIRC，用于确定字符串是否为上下文无关语言的最著名算法是 O(n^3)。

# jsp - 使用 Siteminder 对自定义 Web 应用程序进行身份验证

> ID：12484834
> 
> 赞同：1
> 
> 时间：2012-09-18T20:51:04.993
> 
> 标签：jsp, web-applications, single-sign-on, siteminder

我需要让用户使用 Siteminder 登录。我已经安装了一个 Web 代理，并且还设置了 Siteminder，我的问题是我应该在我的 Web 应用程序中做什么来通过 Siteminder 启用身份验证。

我需要的是当用户未通过身份验证要求登录时，然后继续。当会话过期时，我想再次请求身份验证，如果身份验证成功，则进入提交的屏幕。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T15:21:42.907

假设针对受保护或不受保护的网络资源的政策已经到位；那么所有未决的就是在这些网络应用程序上“启用 SSO”。托管在主要应用服务器（如 WebLogic 服务器等）上的 Web 应用程序可以很容易地做到这一点。否则，您必须构建自己的自定义身份验证模块才能与 SiteMinder 集成。

> “我需要的是当用户未通过身份验证时要求登录，然后继续。当会话到期时，我想再次要求身份验证，如果身份验证成功则进入提交屏幕。”

它有两个部分..

## 1.保护资源：

假设我们定义了一个领域来保护`/web-app/(*)`策略服务器上的 URL - 因此，当 Web 代理读取请求 HTTP 阅读器并遇到未经身份验证的用户，请求 时`/web-app/home.jsp`，它将挑战用户的 SSO 凭据并验证相同的策略服务器。完成此操作后，WebAgent 将检查用户是否有权访问其请求的资源。如果是，那么 Web 代理将包含一些 SiteMinder HTTP 标头/cookie。

## 2\. 将用户名从 SiteMinder 传递到 Web 应用程序：

此请求包含一个存储用户名的 HTTP 标头（通常为 HTTP_SM_USER，请咨询策略服务器管理员）。web-app 需要从这个 header 中读取用户；它也应该设置为“信任”SiteMinder。现在，Web 应用程序将检查用户是否是其数据库（活动目录等）中的现有用户，然后提取该用户的配置信息。

所以这就是......高水平...... :)

推荐电子书：

1.  CA™ eTrust® SiteMinder - Web 代理指南 6.x QMR 5。
2.  CA eTrust 策略设计

# django - 查询集评估序列。新活动位被意外覆盖

> ID：12484837
> 
> 赞同：0
> 
> 时间：2012-09-18T20:51:12.257
> 
> 标签：django

`RelatedModel.new_reply`在将新值保存到数据库中的该字段后，我试图显示数据库模型字段 ( ) 的旧值。这应该起作用的方式是该`new_reply`字段将回复（通过将其设置为 1）标记为收件人未读（`rto`）。收件人查看邮件后，`new_reply`将重置为 0。如果收件人有尚未单击查看的新回复，模板 my_view.html 会向收件人显示一个标志。收件人第一次查看回复时，该标志`new_reply`被重置，后续视图不会被标记为新的。

问题在于，除了存储在数据库中的值之外，该行`response.save()`似乎还更改了`new_reply`in的值。`d`因此，my_view.html 永远不会看到`new_reply==1`，只有`new_reply==0`. 这对我来说似乎很奇怪，因为`d`一旦分配它就应该独立于数据库。

任何想法为什么会发生这种情况以及如何解决它？

```
class ParentModel (models.Model):
    msg = models.TextField()
    author = models.ForeignKey(User)

class RelatedModel (models.Model):
    msg = models.ForeignKey(ParentModel)
    reply = models.TextField()
    rto = models.ForeignKey(User, related_name='rto')
    new_reply = models.IntegerField(null=True, blank=True)

def view_msg(request, msg_id):
    m = get_object_or_404(ParentModel, pk=id)
    r = m.RelatedModel_set.all()
    d = add_csrf(request, m=m, r=r) # d.r.new_reply==1 should be rendered
    # Once the view data is ready for rendering, clear the new_reply
    # bit.  If we do it earlier, we will not be able to mark replies as new.
    if request.user.is_authenticated():
        for response in r:
            # Clear bit if current user is viewing reply addressed to them
            if (request.user == RelatedModel.rto):
                if response.new_reply == 1: # Is it a new reply?
                    response.new_reply = 0 # Reset the new_activity bits
                    response.save()
    return render_to_response('my_view.html',
                              {'db_data': d},
                              context_instance = RequestContext(request),
    ) 
```

# .net - 需要电话验证器

> ID：12484842
> 
> 赞同：-2
> 
> 时间：2012-09-18T20:51:28.750
> 
> 标签：.net, validation

我需要一个 asp.net 中的电话验证器，这是可接受的电话号码格式：123-4567 123-456-7890 1-123-456-7890 1-123-456-7890 x 1234 1-222-3456-7890

非常感谢。我确实找到了一些现有的讨论，要么不工作，要么不符合我的要求。“-”可以是空格或“.”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T20:53:44.973

Google 电话号码验证器 ( [libphonenumber](http://code.google.com/p/libphonenumber/) ) 的 C# 端口是目前最好的电话号码验证器

[https://bitbucket.org/pmezard/libphonenumber-csharp/wiki/Home](https://bitbucket.org/pmezard/libphonenumber-csharp/wiki/Home)

它可以处理这些要求以及更多。

对于客户端验证，您可以使用[libphonenumber](http://code.google.com/p/libphonenumber/)提供的 JavaScript 版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:55:59.283

您可以使用正则表达式轻松完成此操作：

一个可能的例子：

```
/^(([1-9]\-)?([1-9][0-9]{2}\-)?([1-9][0-9]{2}\-)([0-9]{4})( x [0-9]{4})?)$/ 
```

虽然要求不是很清楚，但它可能会或可能不会满足您的需求。

编辑，因为您编辑了原始问题：

```
/^(([1-9](\-| |\.))?([1-9][0-9]{2}(\-| |\.))?([1-9][0-9]{2}(\-| |\.))([0-9]{4})( ?x ?[0-9]{4})?)$/ 
```

# jpa - 从列表中选择 JPA

> ID：12484844
> 
> 赞同：3
> 
> 时间：2012-09-18T20:51:29.580
> 
> 标签：jpa, jpql

我似乎无法运行这个简单的查询。我有一个 id 列表，我想从 db 中检索所有具有此 id 的行。

```
 List<String> uniqueIds is my list. 
```

我试过了`String q = "SELECT item FROM Tenant item WHERE item.id IN (:"+uniqueIds+")";`

我也试过这个没有：和（）。他们都没有工作。我究竟做错了什么。我还尝试了 for (String uniqueId : uniqueIds) { in += uniqueId + ","; }

并且也使用了“in”！

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-18T21:57:37.117

您应该将参数绑定到查询。参数是匿名 ( `?`) 或命名 ( `:parameterName`)：

```
TypedQuery<Tenant> query = 
    em.createQuery("select item from Tenant item where item.id in :ids", Tenant.class);
query.setParameter("ids", uniqueIds);
List<Tenant> result = query.getResultList(); 
```

# python - 使用 scikit-image 进行分割和粒度测量

> ID：12484849
> 
> 赞同：1
> 
> 时间：2012-09-18T20:51:53.643
> 
> 标签：python, image, analysis, image-segmentation

我对 python 图像分析，尤其是 Scikit-image 非常感兴趣。

作为新手，是否有可能获得解释如何将下面的 Matlab 代码转换为 python+scikit-image。

使用图像分割检测细胞

[http://www.mathworks.com/help/images/examples/detecting-a-cell-using-image-segmentation.html](http://www.mathworks.com/help/images/examples/detecting-a-cell-using-image-segmentation.html)

雪花的粒度测定

[http://www.mathworks.com/products/image/examples.html?file=/products/demos/shipping/images/ipexsnow.html](http://www.mathworks.com/products/image/examples.html?file=/products/demos/shipping/images/ipexsnow.html)

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-24T19:29:34.830

如果您需要复杂的细胞图像分析工具，请熟悉 Cellprofiler。正如您所展示的，它可以分割图像并计算它们的对象特征。

Scikit-image 在图库中有相关的代码示例：[分水岭分割](http://scikit-image.org/docs/dev/auto_examples/plot_watershed.html)和[标签](http://scikit-image.org/docs/dev/auto_examples/plot_label.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T05:21:15.203

我建议将 Java 与 Fiji 或 ImageJ 一起使用。斐济有很多内置工具可以满足您的需求。使用内置插件和工具在斐济构建宏要容易得多。

# sql - SSIS - SQL 任务、ADO 连接和 Excel xlsx 文件问题

> ID：12484855
> 
> 赞同：1
> 
> 时间：2012-09-18T20:52:09.470
> 
> 标签：sql, excel, ssis, excel-2007

所以我有一个相对简单的 SSIS 工作，它执行以下操作：

**执行 SQL 任务 - Excel 文件中的拖放表**

```
drop table `Table` 
```

**执行 SQL 任务 - 在 Excel 文件中创建工作表**

```
CREATE TABLE `Table` (
`Col1` VarChar (255) , 
`Col2` Long , 
`Col3` VarChar (84) , 
`Col4` VarChar (60) , 
`Col5` VarChar (255) , 
`Col6` VarChar (20) , 
`Col7` VarChar (255) , 
`Col8` VarChar (255) ,
`Col9` VarChar(255)) 
```

**数据流任务 - 将数据从 SQL 导出到 Excel**

这只是运行 SQL 查询 [OLE DB 源]，将所有内容转换为 unicode 字符串，并将数据导出到 Excel 目标。

**注意：此作业在 BIDS 2005 中完美执行，没有错误。但是，当我最初尝试在 BIDS 2008（32 位模式）中运行它时，我在上面提到的 Drop Sheet 和 Create Sheet Execute SQL** Tasks上都收到以下错误：

> 警告：多步 OLE DB 操作产生错误。检查每个 OLE DB 状态值（如果可用）。没有做任何工作。

我发现我可以通过将**Execute SQL Tasks的****ConnectionType**属性更改为**ADO**并使用以下连接字符串来解决此问题：

 ****```
Data Source=\\<filelocation>\<ExcelFileName>.xls;Provider=Microsoft.ACE.OLEDB.12.0;Extended Properties=Excel 8.0; 
```

此时，我回到了在 BIDS 2008 中执行的包，没有任何错误。一切运行良好！

然后我尝试将作业从导出到 Excel 97-2003 .xls 文件更新为导出到 Excel 2007 .xlsx 文件。

因此，[根据 Microsoft](http://blogs.msdn.com/b/mattm/archive/2010/04/05/exporting-to-excel-2007-xslx-vs-xslb.aspx?Redirected=true)，我必须更改我的**Execute SQL Tasks**以使用以下连接字符串：

```
Data Source=\\<filelocation>\<ExcelFileName>.xlsx;Provider=Microsoft.ACE.OLEDB.12.0;Extended Properties=Excel 12.0 XML; 
```

我还必须将我的**Excel 目标**步骤的连接管理器（它支持 Microsoft BIDS 2008 中的 Excel 2007 格式）更新为以下内容：

```
Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\\<file location>\<Excel filename.xlsx;Extended Properties="Excel 12.0 XML;HDR=YES"; 
```

所以在这一点上，所有的连接都测试良好，一切看起来都应该可以工作。但是，当我执行包时，我遇到了以下问题。

1.  Drop Sheet Execute SQL Task 根据 BIDS 成功完成。但是，它实际上不再将工作表放入 Excel 文件中。它确实删除了工作表中包含的所有数据。
2.  由于#1，创建工作表执行 SQL 任务失败，因为工作表实际上从未被丢弃。

任何想法为什么这不再起作用？老实说，我已经查看了整个互联网和 SO，但我还没有看到有人解释如何做到这一点。是否有一些新命令可以在 Excel 2007 中删除工作表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T15:32:35.200

对于其他可能找到此内容的人：

**我通过用两个文件系统**任务替换两个**执行 SQL**任务解决了将数据导出到 XLSX 文件的问题。一个删除现有文件，另一个将“模板”Excel 文件（基本上只是一个带有列标题的空电子表格）复制到报告目录。

 **然后我使用数据流任务将数据导出到新的模板文件。

不是我理想的解决方案，我更喜欢拥有一个文件并重新创建表的旧方法。但是，显然这在 Excel 2007 中不再是一个选项，并且使用模板文件的文件系统任务方法将起作用。

我在从事这项工作时发现的两个最有用的资源是：

[SSIS - Excel 2007 连接指南](http://dougbert.com/blog/post/exporting-data-from-ssis-to-excel-2007-gotchas.aspx)

[使用 SSIS 文件系统任务复制/重命名文件](http://sqlserversolutions.blogspot.com/2009/04/copyrename-file-using-file-system-task.html)******

# sql-server - SQL Server Linked Server to Progress 使用 openquery 视图很慢

> ID：12484856
> 
> 赞同：0
> 
> 时间：2012-09-18T20:52:11.063
> 
> 标签：sql-server, progress-4gl, openedge, openquery

我们有一个 SQL Server 数据库设置，其中一个链接服务器设置连接到 Progress OpenEdge 数据库。我们使用类似于以下的代码创建了一些 OpenEdge 表的 SQL Server 视图（用于与 SSRS 一起使用）：

创建视图帐户为 SELECT * FROM OPENQUERY(myLinkedServerName, 'SELECT * FROM PUB.accounts')

创建视图客户端为 SELECT * FROM OPENQUERY(myLinkedServerName, 'SELECT * FROM PUB.clients')

由于某种原因，查询似乎带回了整个表，然后在 SQL 端进行过滤，而不是在 Progress 端执行查询。

有人知道为什么或如何纠正这种情况吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T10:00:59.353

作为原生 OpenEdge SQL 查询执行时是否更快？（您可以使用 sqlexp 命令行工具从 proenv 提示符运行查询。）

如果不是，那么问题可能是您需要在数据库上运行 UPDATE STATISTICS。

[http://knowledgebase.progress.com/articles/Article/20992](http://knowledgebase.progress.com/articles/Article/20992)

您可能还需要运行 dbtool 来调整字段宽度（OpenEdge 字段都是可变宽度并且可以过度填充——这让 SQL 客户端适合。）

[http://knowledgebase.progress.com/articles/Article/P24496](http://knowledgebase.progress.com/articles/Article/P24496)

# ruby-on-rails - Firefox 不支持 HTTP“Content-Type”“application/octet-stream”

> ID：12484857
> 
> 赞同：2
> 
> 时间：2012-09-18T20:52:15.120
> 
> 标签：ruby-on-rails, html, firefox, audio, nginx

我刚刚将我的第一个 Ruby on Rails 应用程序部署到 Engine Yard，现在媒体播放器无法在 Firefox 中运行。

到目前为止，我只支持 Opera、Chrome 和 Safari。在本地测试服务器上，媒体播放器可以与 Firefox 一起使用。我正在使用非常基本的 HTML5 播放器。

```
<audio id="audio_<%=i%>" controls="controls" height="100" width="200" title="Variante <%= @ind_titel[i]%>">   
    <source src='/audio/mp3/<%=value%>.mp3' type="audio/mp3" />                             
    <source src='/audio/ogg/<%=value%>.ogg' type="audio/ogg" />                       
<embed height="100" width="100" src='/audio/mp3/<%=value%>.mp3' />
</audio> 
```

Firebug 给了我类似的东西：

```
HTTP "Content-Type" "application/octet-stream" is not supported in Firefox 
```

**编辑：** 我现在更改了服务器上的 /etc/nginx/mime.types 并添加了以下行：

```
application/ogg ogg ogx;
audio/ogg oga; 
```

但它仍然不起作用......根据这个指令：http: [//9elements.com/io/ ?p=306](http://9elements.com/io/?p=306)

我也尝试使用给定的行更改 config/initializers/mime_types.rb，但我的本地测试服务器甚至没有以这段代码开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:53:56.483

不是 100% 肯定，但听起来您的服务器没有为您的音频文件报告正确的 mime 类型。您可以通过直接导航到音频文件并检查 Firebug 网络选项卡标题中的内容类型来进行检查。如果是这种情况，则 apache（或您使用的任何服务器）可能必须配置为报告 .mp3 和 .ogg 文件的正确 mime 类型。

# c++ - 循环遍历指针列表时的问题 - C++

> ID：12484858
> 
> 赞同：0
> 
> 时间：2012-09-18T20:52:16.597
> 
> 标签：c++, pointers, loops

我有一个指向基本抽象类（实体）的指针列表

```
std::list<Entity*> m_entities; 
```

我创建了一个 typedef 用于迭代这个类

```
typedef std::list<Entity*>::const_iterator entityIter; 
```

然后我尝试遍历列表中的每个指针

```
for (entityIter i = m_entities.begin(); i != m_entities.end(); ++i)
{
    const Entity &e = *i;    // ERROR
    e.DoStuff();
} 
```

尝试引用每个指针时出现以下错误

> IntelliSense：不存在将“Entity *const”转换为“Entity”的合适构造函数

我做错了什么？

编辑：

我曾尝试使用 std::shared_ptr

```
std::list<std::shared_ptr<Entity>> m_entities; 
```

我不能以这种方式添加到列表中

```
Entity::Entity(Game *game) 
    : m_game(game)                  
{
    m_game->g_idGenerator->generateNewID();

    m_game->m_entities.push_back(this);      // ERROR
} 
```

使用以下

```
m_game->m_entities.push_back(std::shared_ptr<Entity>(this)); 
```

给我这个错误

> 错误 C2664: 'void std::list<_Ty>::push_back(_Ty &&)' : 无法将参数 1 从 >'Entity' 转换为 'std::tr1::shared_ptr<_Ty> &&'

编辑2：

## 当前代码摘要

```
for (entityIter i = m_entities.begin(); i != m_entities.end(); ++i)
{
    // *i dereferences the iterator and returns an Entity*
    // **i would additionally deference the pointer
    // Adding 'const' infront of Entity means that I can't alter the Entity
    Entity &e = **i;

    e.draw(dt);   // Causes access violation error with standard pointers
} 
```

已尝试转换为 std:shared_ptr 以查看是否可以避免上述代码触发的错误。

但是，我现在无法将实体添加到 std::shared_ptr 列表

```
 m_game->m_entities.push_back(std::shared_ptr<Entity>(this)); 
```

所以总而言之，我有一个标准指针的访问冲突错误，我不能用 shared_ptr 添加到列表中。

填充列表是通过基础实体类的构造函数完成的

```
Entity::Entity(Game *game) 
    : m_game(game)                  
{
    m_game->g_idGenerator->generateNewID();

            // shared_ptr version
    m_game->m_entities.push_back(std::shared_ptr<Entity>(this));  // ERROR C2664

            // raw pointer version
            //m_game->m_entities.push_back(this);  // ACCESS VIOLATION ERROR when calling methods
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-18T20:53:36.413

```
const Entity &e = *i; 
```

`*i`取消对迭代器的引用并返回一个 Entity*。

`**i`将另外尊重指针。

为避免保留参考，您可以使用`(*i)->memberFunction(...);`

不要忘记，如果您分配了实体`operator new`，您也需要`operator delete`它们。

这是一个使用示例，`std::shared_ptr`因为您的代码看起来很复杂，无法在页面上讨论。

我创建了一个简单的`Entity`类并在`std::shared_ptr`. 我`std::shared_ptr<Entity>`多次放置相同的内容纯粹是为了演示`std::shared_ptr`管理这些信息，包括将自身复制到列表中。

```
#include <memory>
#include <iostream>
#include <string>
#include <list>
using namespace std;

class Entity {
private:
  string name;
public:
  Entity(const std::string& n) :
    name(n)
  { }

  const string& getName() {
    return name;
  }
};

int main(int argc, char** argv) {
  list<shared_ptr<Entity> > l;

  shared_ptr<Entity> sp(new Entity("Repeated!"));

  l.push_back(sp);
  l.push_back(sp);
  l.push_back(shared_ptr<Entity>(new Entity("Foo")));
  l.push_back(sp);
  l.push_back(shared_ptr<Entity>(new Entity("Bar")));
  l.push_back(sp);

  for(list<shared_ptr<Entity> >::const_iterator iter = l.begin();
      iter != l.end(); ++iter)
    {
      cout << ">> " << (*iter)->getName() << endl;
    }
}; 
```

注意：将完全相同的原始指针放入多个`std::shared_ptr`对象和*复制*a`std::shared_ptr`之间存在差异`push_back`。后一种情况由完全管理，`std::shared_ptr`而前一种情况则各自`std::shared_ptr`试图独立管理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T21:04:55.767

选项 A）您想要访问元素并保证您不会更改它们：

```
typedef std::list<Entity*>::const_iterator entityIter;

std::list<Entity*> m_entities;
for (entityIter i = m_entities.begin(); i != m_entities.end(); ++i)
{
    const Entity &e = **i;    // ERROR
    e.DoStuff();
} 
```

选项 B）您想要访问元素并更改它们：

```
typedef std::list<Entity*>::iterator entityIter; // no const_

std::list<Entity*> m_entities;
for (entityIter i = m_entities.begin(); i != m_entities.end(); ++i)
{
    Entity &e = **i;    // ERROR
    e.DoStuff();
} 
```

# c# - 如何从 YouTube 观看历史记录中获取最新视频

> ID：12484867
> 
> 赞同：1
> 
> 时间：2012-09-18T20:52:52.043
> 
> 标签：c#, api, youtube

我想从[YouTube](http://www.youtube.com)观看历史中获取最新视频。我正在使用以下代码，但视频大小总是不同，很少等于 100。我该如何解决这个问题？

```
YouTubeRequestSettings ytSettings = new YouTubeRequestSettings(AppKey, DevKey, currentLogin, currentPassword);
ytSettings.PageSize = 10;
ytSettings.AutoPaging = true;
YouTubeRequest ytRequest = new YouTubeRequest(ytSettings);

string uri = "https://gdata.youtube.com/feeds/api/users/default/watch_history?v=2";
Feed<Video> videos = ytRequest.Get<Video>(new Uri(uri));
List<string> vids = new List<string>();

foreach (Video vid in videos.Entries)
{
    if (vids.Count < 100)
    {
        vids.Add(vid.VideoId.ToString());
    }
    else
    {
        break;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-10T07:55:17.007

我正在粘贴链接，以便有人可能会发现它对他们的知识有用

[http://www.codeproject.com/Articles/143669/Manage-YouTube-using-C-and-Youtube-API](http://www.codeproject.com/Articles/143669/Manage-YouTube-using-C-and-Youtube-API)

**更新：** 嗨，我从谷歌开发者那里得到了链接。那里为 .NET 定义了四种方法。所以我们必须深入了解最近的上传。因为我看不到任何最近的 .NET 视频标题

[https://developers.google.com/youtube/v3/code_samples/dotnet](https://developers.google.com/youtube/v3/code_samples/dotnet)

[https://github.com/youtube/api-samples/tree/master/dotnet](https://github.com/youtube/api-samples/tree/master/dotnet)

# django - 我无法在 Osx 中安装“pip install pil”

> ID：12484876
> 
> 赞同：3
> 
> 时间：2012-09-18T20:53:08.377
> 
> 标签：django, macos, terminal, python-imaging-library, pip

Xcode 安装完毕，python+django 启动并顺利运行。

我正在写运行：

```
pip install PIL 
```

响应：

```
Downloading/unpacking PIL
  Running setup.py egg_info for package PIL
    WARNING: '' not a valid package name; please use only.-separated package names in setup.py

Installing collected packages: PIL
  Running setup.py install for PIL
    WARNING: '' not a valid package name; please use only.-separated package names in setup.py
    --- using frameworks at /System/Library/Frameworks
    building '_imaging' extension
    clang -fno-strict-aliasing -fno-common -dynamic -g -Os -pipe -fno-common -fno-strict-aliasing -fwrapv -mno-fused-madd -DENABLE_DTRACE -DMACOSX -DNDEBUG -Wall -Wstrict-prototypes -Wshorten-64-to-32 -DNDEBUG -g -Os -Wall -Wstrict-prototypes -DENABLE_DTRACE -arch i386 -arch x86_64 -pipe -IlibImaging -I/System/Library/Frameworks/Python.framework/Versions/2.7/include -I/System/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c _imaging.c -o build/temp.macosx-10.8-intel-2.7/_imaging.o
    unable to execute clang: No such file or directory
    error: command 'clang' failed with exit status 1
    Complete output from command /usr/bin/python -c "import setuptools;__file__='/var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-build/PIL/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record /var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-QFMx2t-record/install-record.txt --single-version-externally-managed:
    WARNING: '' not a valid package name; please use only.-separated package names in setup.py

running install

running build

running build_py

running build_ext

--- using frameworks at /System/Library/Frameworks

building '_imaging' extension

clang -fno-strict-aliasing -fno-common -dynamic -g -Os -pipe -fno-common -fno-strict-aliasing -fwrapv -mno-fused-madd -DENABLE_DTRACE -DMACOSX -DNDEBUG -Wall -Wstrict-prototypes -Wshorten-64-to-32 -DNDEBUG -g -Os -Wall -Wstrict-prototypes -DENABLE_DTRACE -arch i386 -arch x86_64 -pipe -IlibImaging -I/System/Library/Frameworks/Python.framework/Versions/2.7/include -I/System/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c _imaging.c -o build/temp.macosx-10.8-intel-2.7/_imaging.o

unable to execute clang: No such file or directory

error: command 'clang' failed with exit status 1

----------------------------------------
Command /usr/bin/python -c "import setuptools;__file__='/var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-build/PIL/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record /var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-QFMx2t-record/install-record.txt --single-version-externally-managed failed with error code 1 in /var/folders/3_/tp_3vp9966dc65phynpzl04h0000gn/T/pip-build/PIL
Traceback (most recent call last):
  File "/usr/local/bin/pip", line 8, in <module>
    load_entry_point('pip==1.2', 'console_scripts', 'pip')()
  File "/Library/Python/2.7/site-packages/pip/__init__.py", line 111, in main
    return command.main(args[1:], options)
  File "/Library/Python/2.7/site-packages/pip/basecommand.py", line 145, in main
    temp = tempfile.NamedTemporaryFile(delete=False)
NameError: global name 'tempfile' is not defined 
```

为什么！？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T22:36:23.370

安装 Xcode 时需要安装 Xcode 命令行工具（默认不选中）。根据您的 xcode 版本，您可以选择在首选项的下载面板中安装命令行工具，也可以重新安装。

# c - 如何在 XCode 4.4 中将库添加到 c 代码

> ID：12484882
> 
> 赞同：1
> 
> 时间：2012-09-18T20:53:31.717
> 
> 标签：c, xcode, xcode4

我在 XCode 中添加库路径时遇到了一些问题。我正在编写 C 代码。

我有我的代码和我想添加的库。但是我在添加库时遇到了麻烦，比如说我想使用的数学库。我认为路径设置不正确。我不知道如何在 XCode 中设置路径。

有人知道或有如何将库添加到 C 代码的示例吗？我正在使用当前版本：XCode 4.4.1。

提前致谢！

# gmail-contextual-gadgets - Gmail 小工具脚本错误

> ID：12484884
> 
> 赞同：2
> 
> 时间：2012-09-18T20:53:42.217
> 
> 标签：gmail-contextual-gadgets

我正在研究 gmail 上下文小工具。为了创建我的第一个“Hello World”小工具，我从[https://developers.google.com/google-apps/gmail/contextual_gadgets](https://developers.google.com/google-apps/gmail/contextual_gadgets)复制了代码 并做了完全相同的事情。下面是 manifest.xml 和 gadget.xml：

```
1.manifest 

    <?xml version="1.0" encoding="UTF-8" ?>
        <ApplicationManifest xmlns="http://schemas.google.com/ApplicationManifest/2009">

      <!-- Support info to show in the marketplace & control panel --> 
       <Support>    
      </Support>  <!-- Name and description pulled from message bundles -->  

       <Name>HelloWorld</Name>  
       <Description>A simple Hello World application for testing  Gmail contextual gadgets</Description>  
       <!-- Show this link in Google's universal navigation for all users -->  

       <!-- EXTRACTOR -->
       <Extension id="HelloWorldExtractor" type="contextExtractor">  
       <Name>Hello World</Name>  
       <Url>google.com:HelloWorld</Url>  
       <!-- Uncomment this Param to apply a filter to the extractor's  default output. The example regexp below makes the match case sensitive.  <Param name="hello" value="H[a-z]* W[a-z]*"/> -->  
       <Triggers ref="HelloWorldGadget"/>  
       <Scope ref="emailSubject"/>  
       <Scope ref="emailBody"/>  
       <Container name="mail"/></Extension>

       <!-- GADGET -->
       <Extension id="HelloWorldGadget" type="gadget">  
       <Name>Hello World Gmail contextual gadget</Name>  
       <Url>http://xxxx.com/gadget.xml</Url>  
       <Container name="mail"/>  
       <!-- Uncomment this to enable Caja. -->  
       <!-- <Param name="caja" value="enabled"/> -->
       </Extension>

       <!-- SCOPE -->
       <Scope id="emailSubject">  
       <Url>tag:google.com,2010:auth/contextual/extractor/SUBJECT</Url>  
       <Reason>This application searches the Subject: line of each email  for the text "Hello World."</Reason>
       </Scope><Scope id="emailBody">  
       <Url>tag:google.com,2010:auth/contextual/extractor/BODY</Url>  
       <Reason>This application searches the message body of each email  for the text "Hello World."</Reason>
       </Scope></ApplicationManifest>

2\. gadget.xml:
<?xml version="1.0" encoding="UTF-8"?>

<Module>  
<ModulePrefs title="Hello World"    description="Matches and echoes 'Hello World' string in emails"    height="20"    author="Sarah M and Walter Q"    author_email="..."    author_location="Mountain View, CA">
    <!-- Declare feature dependencies. -->    
    <!-- This one is not specific to Gmail contextual gadgets. -->    
    <Require feature="dynamic-height"/>    
    <!-- The next feature, Caja, is optional, and is supported for     use only within test domains. Uncomment the tag only for     non-production gadgets. -->
    <!-- <Require feature="caja"/> -->    <!-- The next feature, google.contentmatch, is required for all     Gmail contextual gadgets.     
    <Param> - specify one or more comma-separated extractor IDs in     a param named "extractors". This line is overridden by the extractor ID     in the manifest, but is still expected to be present. -->    
    <Require feature="google.contentmatch">      
    <Param name="extractors">        google.com:HelloWorld      </Param>    
    </Require>  </ModulePrefs>  
    <!-- Define the content type and display location. The settings   "html" and "card" are required for all Gmail contextual gadgets. -->  
    <Content type="html" view="card">    
    <![CDATA[      
    <!-- Start with Single Sign-On -->      
    <script type="text/javascript"></script>      
    <script type="text/javascript">        
    <!-- Fetch the array of content matches. -->        

    matches = google.contentmatch.getContentMatches();        
    var matchList = document.createElement('UL');        
    var listItem;        
    var extractedText;        
    <!-- Iterate through the array and display output for each match. -->        
    for (var match in matches) {          
        for (var key in matches[match]) {            
            listItem = document.createElement('LI');            
            extractedText = document.createTextNode(key + ": " + matches[match][key]);            
            listItem.appendChild(extractedText);            
            matchList.appendChild(listItem);          
        }        
    }        
    document.body.appendChild(matchList);        
    gadgets.window.adjustHeight(100);      
    </script>    
  ]]>  </Content></Module> 
```

但我得到了一些 javascript 错误：

1.  'Date' 未定义 2.'unescape' 未定义
2.  无法获取属性“setMessages_”的值：对象为空或未定义
3.  无法获取属性“getContentMatches”的值：对象为空或未定义

# html - 加载页面时html选择偏离中心

> ID：12484886
> 
> 赞同：0
> 
> 时间：2012-09-18T20:53:44.437
> 
> 标签：html, freemarker

我的页面上有一个选择，当页面加载最初显示在选择框中的文本不在正确的位置时，它会稍微向下移动。有没有人听说过或看到过这个问题。这就是我的选择的样子

```
<select id="usersearches">
        <#if search??>
            <#list search as s>
                <option value="${s.id!}" <#if response.payload.title?? && response.payload.title == s.title!> selected="selected" </#if> id="${s.id!}" query="${s.query!}">${s.title!}</option>
            </#list>
        </#if>
    </select> 
```

我正在为我的客户端使用 freemarker，以选择需要选择的选项。这仅在第一次加载页面时发生，一旦我单击选择框，文本会自行修复，即使我没有选择新选项。更多信息是这些选项将触发页面重定向。欢迎和赞赏所有帮助和想法。我忘了补充一点，这发生在 IE8（或一般的 IE）中

代码：

```
$("#usersearches").change(function(){
    var which = "#"+$(this).val();
    var url = "${orderSearchPostURL}?"+$(which).attr("query")+"&_title="+$(which).html()+"&sea‌​rchType="+$(this).val();
window.location.href=url;
}); 
```

# c# - 使用扩展类映射

> ID：12484888
> 
> 赞同：0
> 
> 时间：2012-09-18T20:53:48.033
> 
> 标签：c#, nhibernate, orm, conform

我正在使用 NHibernate 和[ConfORM](http://code.google.com/p/codeconform/)来映射我的域实体。

假设以下类：

```
public class Event {
    public virtual Guid Id { get; set; }
    public virtual string Title { get; set; }
    public virtual bool Active { get; set; }
}

public class EventA : Event {
    public virtual string PropertyA { get; set; }
}

public class EventB : Event {
    public virtual string PropertyB { get; set; }
} 
```

![图表](../Images/0c6b40462c90280c2196778e160235df.png)

我不需要在派生类中**重复**NHibernate 表字段，而是使用基类，如图所示。

我的 ConfORM 设置：

```
var domainAssembly = typeof(Event).Assembly;
var domainEntities = from t in domainAssembly.GetTypes() where t==typeof(Event) select t;
var orm = new ObjectRelationalMapper();
orm.Patterns.Sets.Add(new UseSetWhenGenericCollectionPattern());
orm.Patterns.PoidStrategies.Add(new ConfOrm.Patterns.IdentityPoidPattern());
orm.TablePerConcreteClass(domainEntities);
var patternsAppliers = new CoolPatternsAppliersHolder(orm);
var mapper = new Mapper(orm, patternsAppliers);
[...] 
```

关于如何解决这个问题的任何想法都可以？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T10:18:17.007

`orm.TablePerConcreteClass(domainEntities);`与之交换`orm.TablePerClass(domainEntities);`将创建

```
Event
-----
PK | Id

EventA
-----
PK,FK | EventId 
```

因为 EventA 中的单独 Id 列不是必需的

# php - XP 调平系统 - PHP

> ID：12484892
> 
> 赞同：0
> 
> 时间：2012-09-18T20:53:55.357
> 
> 标签：php, ranking

**排名表**

*   ID，主键
*   RANK，等级或级别，1 为最高，3 为最低
*   MIN_SCORE，达到排名所需的最低点数或 XP
*   NAME，等级的关联名称

    ```
    Rank Table
    +----+------+-----------+-------------------------+
    | ID | RANK | MIN_SCORE |          NAME           |
    +----+------+-----------+-------------------------+
    |  1 |    1 |     18932 | Editor-in-Chief         |
    |  2 |    2 |     15146 | Senior Technical Writer |
    |  3 |    3 |     12116 | Senior Copywriter       |
    +----+------+-----------+-------------------------+ 
    ```

**排名表**

*   ID，主键
*   FK_MEMEBER_ID，成员主键的外键
*   FK_RANK，作者排名表排名列的外键（顶部）
*   SCORE，会员当前获得的分数或 XP

    ```
    Ranking Table
    +-----+--------------+---------+-------+
    | ID  | FK_MEMBER_ID | FK_RANK | SCORE |
    +-----+--------------+---------+-------+
    |   1 |            1 |       1 | 17722 |
    |   2 |            2 |       2 | 16257 |
    |   3 |            3 |       3 | 12234 |
    +-----+--------------+---------+-------+ 
    ```

在我的课堂上，我存储了排名——与排名表中的排名相匹配——并关联了最低分数；RANK 作为键，MINIMUM_SCORE 作为值。

当成员的分数 (XP) 更新（上/下）时，我想根据下面的数组测试更新后的分数，以确定他们的排名是否也需要更新。

```
private $scores = array('3' => '12116', '2' => '15146', '1' => '18932',); 
```

使用更新后的分数，我如何从上述数组中确定相关排名？

一切都开放审查，这是我第一次创建排名系统，所以我希望能做对:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:10:57.600

好的，给定这些表：

```
Ranks
+------+-----------+-------------------------+
| RANK | MIN_SCORE |          NAME           |
+------+-----------+-------------------------+
|  1   |     18932 | Editor-in-Chief         |
|  2   |     15146 | Senior Technical Writer |
|  3   |     12116 | Senior Copywriter       |
+------+-----------+-------------------------+

Members
+-----------+-------+
| MEMBER_ID | SCORE |
+-----------+-------+
|     1     | 17722 |
|     2     | 16257 |
|     3     | 12234 |
+-----+-------------+ 
```

您可以使用以下方法获得会员及其等级：

```
SELECT m.MEMBER_ID, r.NAME
FROM Members m INNER JOIN Ranks r
ON m.SCORE > r.MIN_SCORE -- Pick ranks that a user is eligible for
WHERE MEMBER_ID = ?
HAVING MAX(r.MIN_SCORE) -- Pick the rank with the highest score 
```

这允许您删除整个表，这将使您的代码更易于维护。希望您的排名表会比它总是在内存中的小，但是两者的索引`MIN_SCORE`可能`RANK`会有所帮助。

[如果您确定此连接是一个性能问题（除非您测量了性能问题](https://softwareengineering.stackexchange.com/questions/80084/is-premature-optimization-really-the-root-of-all-evil)，否则请不要这样做），您可以使用类似的查询来更新成员表中的排名，假设它有一个`RANK`列：

```
UPDATE Members
SET RANK = (
    SELECT RANK
    FROM Ranks
    WHERE SCORE > MIN_SCORE
    AND MEMBER_ID = MEMBER_ID
    HAVING MAX(MIN_SCORE)
) 
```

# c++ - 运行 Boost.Build 时出现“批量递归超出堆栈限制”怎么办？

> ID：12484894
> 
> 赞同：4
> 
> 时间：2012-09-18T20:53:59.507
> 
> 标签：c++, boost-build

我使用的是 64 位 Win 7。

我下载了最新的 Boost 源代码，为了收集二进制文件，我必须通过 Boost.Build 过程。我还从官方网站上获取了最新的 Boost.Build，当我运行时`./bootstrap`出现错误：

```
******  B A T C H   R E C U R S I O N  exceeds STACK limits ******
Recursion Count=592, Stack Usage=90 percent
******       B A T C H   PROCESSING IS   A B O R T E D      ****** 
```

我有 i5，8 GB 内存。

是否有其他方法可以获取用于 GCC (G++) 的二进制文件。我知道有 Boostpro，但这只能给我 VS 二进制文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-28T10:12:57.337

在以下情况下会发生此错误：

*   您正在使用`*.tar.bz2`包中的源代码进行 Windows 构建，**并且**
*   您没有指定工具集。

**使用**`*.zip`源包**或**指定工具集（或`bootstrap.sh msvc`其他）可以解决这个问题（至少对我来说）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-09T01:08:39.037

Jesse Good 和 DevSolar 已经给出了答案

但需要一些组合

对于 Windows + MinGW (gcc)

1）在CMD中，在Boost的根目录下，输入

```
.\bootstrap.bat gcc 
```

gcc 参数将停止递归错误

2）然后在同一目录下会生成b2

最简单的安装方法是

```
.\b2 toolset=gcc --prefix="path\of\compiled\files\" install 
```

toolset=gcc 参数是必要的，否则 .dll 的编译将失败

3) 添加

```
"path\of\compiled\files\include\boost_?_??"
"path\of\compiled\files\lib" 
```

到系统路径（你可以谷歌“添加系统路径变量win”，Win 7不需要重启来激活设置）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:08:47.857

1.  进入`tools\build\v2\`boost 目录并从那里运行引导程序。

2.  从与上面相同的目录运行`b2 toolset=gcc install --prefix=PREFIX`，其中 PREFIX 是您希望安装 boost.build 的位置。

3.  添加`PREFIX\bin`到您的 PATH 环境变量中，然后从 boost 根目录中键入类似以下内容（这是一个示例，根据需要更改选项，要查找选项列表，请键入`b2 --help`）：

> b2 工具集=gcc 地址模型=64 变体=发布链接=静态，共享线程=多 --layout=system target-os=windows

希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-20T19:36:57.833

我已经看到当`Boost`版本过时并且不支持当前工具集时会发生这种情况。比如 boost-1.57.0 不支持 VC15 编译器，给了我你的错误信息。

简单的解决方案是使用最新版本的`Boost`.

# svn - 如果我删除每个文件，然后 svn update，我会从 repo 中获取最新版本吗？

> ID：12484904
> 
> 赞同：0
> 
> 时间：2012-09-18T20:54:37.197
> 
> 标签：svn

我想要删除的 svn 目录中有很多不需要的、未提交的文件。我只是在根 svn 目录结帐还是必须先删除所有内容？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:15:13.217

只要您保留 .svn 目录中的内容（/directories 如果您使用 Subversion <= 1.6），您唯一可能丢失的就是您的本地更改，这正是您想要的。

删除本地文件，然后更新将首先重新安装文件（未修改），然后执行更新。这种重新安装主要相当于只`svn revert`-ing 文件。

因此，您选择哪种方式并不真正相关，因为它仅在执行的 IO 量上略有不同，除非您还具有本地 svn 属性更改（或本地复制和删除）。在这种情况下，您确实需要 svn 还原您的工作副本。

在任何情况下，我都建议`svn status`您在完成后运行 a，因为它会告诉您是否还有需要更多工作的本地更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T00:57:22.667

如果您删除文件或目录并执行`svn update`，它将将该文件或目录恢复到当前的原始状态。当我确定我在特定目录中所做的所有更改都是垃圾时，我会这样做很多。这可能会导致问题（可能吗？会导致问题！）是如果您`svn move`从一个您不删除的目录执行到您计划删除的目录。例如，我将一个文件从当前目录移动到该`src`目录。`src`然后，我在目录中进行了大量更改。删除`src`目录在 Subversion 1.7 之前的版本中不起作用。

说实话，你最好做 a `svn revert`（你可以使用`--recursive`开关深入你的目录，所以 a`svn --recursive *`会做所有事情）。然后尝试`svn status`查看是否有任何文件仍未分类。如果您有冲突，请`svn resolved`在该文件或目录上执行 a ，如果常规不这样做，则执行 a`svn revert`应该有助于清理它。`svn revert`

我的建议是依靠`svn status`告诉你有什么变化。如果您有任何东西出现在`svn status`还原中，请解决它，更新它，直到它消失。

如果您真的要删除工作目录中的所有内容，只需删除整个目录并重新签出即可。这样，您就不会遇到弄乱`.svn`目录/目录的问题。

# c# - 在列表框中搜索字符串

> ID：12484905
> 
> 赞同：0
> 
> 时间：2012-09-18T20:54:41.800
> 
> 标签：c#, string, string-comparison

我无法在列表框中找到一个字符串，我的字符串 NombreCompleto 由我之前从文件（ESSD）中读取的 3 个字符串组成，在我恢复了这个字符串之后，我想知道这个字符串是否在我的 listbox3 ，我尝试了几种方法，但似乎不起作用。这是我的代码。

```
foreach (string h in Directory.EnumerateFiles(NomDirec, "resume*"))
{
   this.listBox1.Items.Add(h);
    var NombreLinea = File.ReadLines(h);
    foreach (string item in NombreLinea)
    {
        NombreAbuscar.Add(item.Remove(item.IndexOf(':')));
        this.listBox3.Items.Add(item.Remove(item.IndexOf(':')));

}

foreach (string t in Directory.EnumerateFiles(NomDirec, "ESSD1*"))
{
    string[] Nombre = File.ReadLines(t).ElementAtOrDefault(6).Split(':');
    string[] ApellidoPat = File.ReadLines(t).ElementAtOrDefault(7).Split(':');
    string[] ApellidoMat = File.ReadLines(t).ElementAtOrDefault(8).Split(':');
    string NombreCompleto = ApellidoPat[1]+" "+ ApellidoMat[1] +","+" "+ Nombre[1];
    string Nom2 = NombreCompleto.ToString();

    int index = listBox3.FindString(Nom2);
    if (index != -1)
    {
        this.listBox1.Items.Add(t);
        MessageBox.Show("Find It");
    }
    else { MessageBox.Show("Not Found :@"); }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:58:15.290

您可以尝试使用此代码 -`based on Linq operator Where, ...`

```
var selectedItems = from li in listBox3.Items
                    where li.Text == Nom2
                    select li.Text;

if(selectedItems.Any()) 
.... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:00:24.280

试试这个：

```
 int index = -1;
                            for (int i = 0; i < listBox3.Items.Count; ++i)
                               if (listBox3.Items[i].Text == Nom2) { index = i; break; }
                            if (index != -1)
                            {
                                this.listBox1.Items.Add(t);
                                MessageBox.Show("Find It");
                            }
                            else { MessageBox.Show("Not Found :@"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-30T01:06:38.590

查找某个字符串是否在列表框中的非常简单的方法。

```
private void btnAddRecipe_Click(object sender, EventArgs e)
{
    bool DoesItemExist = false;
    string searchString = txtRecipeName.Text;
    int index = lstRecipes.FindStringExact(searchString, -1);

    if (index != -1) DoesItemExist = true;
    else DoesItemExist = false;

    if (DoesItemExist)
    {
       //do something
    }
    else
    {
        MessageBox.Show("Not found", "Message", MessageBoxButtons.RetryCancel, MessageBoxIcon.Stop);
    }

    PopulateRecipe();
} 
```

# java - Java 到 JSON 的转换：JSTL vs Methodical (Jackson/Gson)

> ID：12484909
> 
> 赞同：0
> 
> 时间：2012-09-18T20:54:52.353
> 
> 标签：java, json, jstl, jackson, gson

我是熟悉 Java 的前端开发人员。对于使用有条不紊的转换与 JSTL 将 Java 对象转换为 JSON，我很难提高性能和开发的优缺点。

我知道通过有条不紊的转换，可以使用额外的 getter/setter 类来保证安全性——而且我有一个非常强烈的预感，即它的速度更快，资源消耗更少，但我找不到任何证据。我只能找到 JSON 库之间的比较。

我需要详细说明的原因：

*   更严格的安全性 - 通过我们控制在 JSP 中显示的数据来应对
*   更快，更少的开销 - 因缺乏证据而反击
*   更容易标准化 - 缺乏灵活性

这是我遇到的一些链接（下）-我真的在寻找一些可靠的研究，而不是库的比较。此外，如果有人可以向我展示杰克逊提供的 OJM 映射的一些可靠示例，那就太棒了。

*   [http://www.informit.com/articles/article.aspx?p=30334&seqNum=3](http://www.informit.com/articles/article.aspx?p=30334&seqNum=3)
*   [http://jackson.codehaus.org/](http://jackson.codehaus.org/)
*   [Spring MVC - JSTL 标记 JSON 转换可以吗？](https://stackoverflow.com/questions/6626595/spring-mvc-is-jstl-tag-json-conversion-ok)
*   [http://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)
*   [http://code.google.com/p/json-io/](http://code.google.com/p/json-io/)
*   [http://code.google.com/p/commons-json/](http://code.google.com/p/commons-json/)

再一次，我知道这太通用了——但我只是在寻找建议和提出的理由，说明为什么有条不紊比使用 JSTL 更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:28:37.653

就性能而言，Jackson 是最常用的库，根据大多数公共测量，例如[JVM Serializers](https://github.com/eishay/jvm-serializers)基准。您可以自己轻松地测试它，也可以通过 Google 进行测试（Android、Java SE 存在基准）。

Jackson OJM 很简单。给定对象'ob'：

```
MyObject ob = ...;
ObjectMapper mapper = new ObjectMapper(); // always reuse these, expensive to create
OutputStream out = context.getResponseStream(); // or whateveer

// and then write it out
mapper.writeValue(out, ob);
// or read in:
MyObject ob2 = mapper.readValue(context.getRequestStream(), MyObject.class); 
```

复杂性主要来自对`Map`s, `List`s (use `TypeReference`) 的 Java 泛型的处理；非标准命名约定（使用注释为 Java 属性名称定义 JSON 名称）等。

存在教程，例如：

*   [Jackson Databind](https://github.com/FasterXML/jackson-databind)（Jackson 2.0 数据绑定的项目页面，自述文件）
*   [杰克逊 5 分钟](http://wiki.fasterxml.com/JacksonInFiveMinutes)

大多数主要的 Java 框架正在使用或将使用 Jackson 进行 JSON 转换：所有 JAX-RS 实现（Jersey、RESTeasy、CXF）、Restlet (2.0)、Play (2.0)、SpringMVC。由于效率和可扩展性，它已经成为事实上的标准库，后者对于框架来说是最重要的。基于 Jackson 的 JSON 处理也被发现可以与“更快”的二进制格式竞争（这意味着在大多数 Web 服务案例中切换到使用 Thrift、Avro 或 Protobuf 几乎没有什么好处）。

在替代方案中，GSON 也被广泛使用，并且与 Jackson 一样易于用于数据绑定。

# c# - 如何使用 Unity 并在每个请求中重新创建 ObjectContext

> ID：12484910
> 
> 赞同：1
> 
> 时间：2012-09-18T20:54:52.137
> 
> 标签：c#, asp.net-mvc, entity-framework, unity-container, idisposable

我对 IoC - Unity 有一些问题。

我做了一个简单的网络应用程序。它由一个表“Post”组成，该表具有三个字段：PostId、title、Text。我使用通用存储库：

```
 public abstract class BaseRepository<T> : IBaseRepository<T> where T : class
    {
        protected ObjectContext db = new BlogDbEntities();

        /* CRUD */
    }

    public class PostRepository : BaseRepository<Post>, IPostRepository
    {
        public void Search(Expression<Func<Post, object>> predicate) 
        {
          /* some search specific entity logic */   
        }
    }

    public interface IPostRepository : IBaseRepository<Post>
    {
        void Search(Expression<Func<Post, object>> predicate);
    } 
```

如您所见，在该存储库中创建新的 BlogDbEntities - ObjectContext。在控制器中我使用 IPostRepository，控制器非常简单：

```
public class PostController : Controller
    {

        IPostRepository postRepository;

        public PostController(IPostRepository postRepository) 
        {
            this.postRepository = postRepository;
        }

        public ActionResult Index()
        {
            postRepository.All.ToList();
            return View();
        }

        protected override void Dispose(bool disposing)
        {
            postRepository.Dispose();
            base.Dispose(disposing);
        }

    } 
```

在 Global.asax 中，我使用 Unity 解决依赖关系：

```
 var container = new UnityContainer();
            var controllerFactory = new UnityControllerFactory(container);
            ControllerBuilder.Current.SetControllerFactory(controllerFactory);
            container.RegisterType<IPostRepository, PostRepository>(new ContainerControlledLifetimeManager()); 
```

启动应用程序后，当我请求例如 /Post/ 第一个请求正常执行。但是当我再次尝试执行请求时，我得到异常**“ObjectContext 实例已被释放，不能再用于需要连接的操作。”**

当我尝试在没有显示 Unity IoC 框架异常且 ObjectContext 正常工作的情况下执行请求时。

**我猜这种行为的原因是 Unity，我认为上下文存储在 Unity Container 中。谁能帮助我如何正确配置 Unity，并在每次请求后重新创建上下文。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:58:52.417

> 谁能帮助我如何正确配置 Unity，并在每次请求后重新创建上下文。

注册类型时，您可以指定要使用[TransientLifetimeManager](http://msdn.microsoft.com/en-us/library/microsoft.practices.unity.transientlifetimemanager.aspx)，这会导致每次调用都创建一个新实例。

# php - 我将如何开发一个 PHP 脚本来抓取 HTML 内容，然后将其放入数组中

> ID：12484924
> 
> 赞同：0
> 
> 时间：2012-09-18T20:55:59.203
> 
> 标签：php, regex, arrays

我有一种情况，客户需要显示在他的页脚上的链接集，但每个页面都需要一个完全不同的链接集。所以我们决定我们将所有的链接集放在数组中，并在一个快速的 PHP 代码片段中调用它们。成功！它有效，但现在我们有一个更大的问题。由于该网站有超过 500 页，输入每个链接集所需的手工劳动将消耗大量时间。所以我的目标是开发一个 PHP 脚本，它将采用一个链接集（见下文）并放入一个数组（见下文），然后我们需要做的就是浏览每个页面并查看它是否有一个链接集在页脚，如果不是，我们将编写一个快速片段，这将花费更少的时间，而不是编程所有的链接集。

* * *

这是链接集的样子（来自我们的源代码）

```
<!-- begin_block_7-->
<h2>Cost Reduction Resources</h2>
<a href="http://www.sourceconsulting.com/">shipping charges</a>  ||    
<a href="http://www.sourceconsulting.com/shipping-costs-calculators/fedex-ups-rates-calculator">ups shipping</a>  ||    
<a href="http://www.sourceconsulting.com/carrier-contract-negotiation">freight delivery</a>  ||   
<a href="http://www.sourceconsulting.com/parcel-freight-bill-audit">freight payment companies</a>  ||    
<a href="http://www.sourceconsulting.com/shipping-costs-calculators">compare shipping costs</a>  
<!-- end_block_7 --> 
```

* * *

我们需要获取该链接集并将其放入这样的数组中

```
$interlinking_set_1 = array ( "<a href='http://www.sourceconsulting.com'>cost freight shipping</a><br/>", 
    "<a href='http://www.sourceconsulting.com/carrier-contract-negotiation'>trucking freight rates</a><br/>", 
    "<a href='http://www.sourceconsulting.com/shipping-costs-calculators/fedex-ups-rates-calculator'>ups shipping calculator</a><br/>", 
    "<a href='http://www.sourceconsulting.com/parcel-freight-bill-audit'>air freight carrier</a><br/>",
    "<a href='http://www.sourceconsulting.com/reduce-shipping-costs'>shipping costs</a><br/>",
    "<a href='http://www.sourceconsulting.com/shipping-costs-calculators'>freight rate calculator</a><br/>"
    ); 
```

* * *

我知道这肯定会使用正则表达式，这就是我将其作为标签包含的原因。我完全不知道如何做到这一点。我们有超过 500 个需要输入到数组中的互连集。我们已经为此花费了 10 多个工时，并且必须有一个更简单的解决方案。我不是要求有人为我编写脚本，只是给我一个“可理解”的想法，可以在数小时内实施。

谢谢迪伦
_

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:02:36.800

```
<?php
    $html = @file_get_contents($YOUR_URL);

    if(preg_match('/\<\!\-\- begin\_block\_7\-\-\>[\s\S]*\<\!\-\- end\_block\_7 \-\-\>/iU', $html, $linkBlock)){
        preg_match_all('/\<a.*\>.*\<\/a\>/iU', $linkBlock[0], $links);
        var_dump($links);
    }
?> 
```

这将为您提供链接并输出它们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T20:56:53.187

刮掉它。[PHP 简单的 HTML DOM 解析器。](http://simplehtmldom.sourceforge.net/)

这有 jQuery 样式选择器。迭代，添加到数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:02:38.560

如果您熟悉 jQuery 样式的 DOM 操作，您可以使用[queryPath](http://querypath.org/)。

# mysql - 如何创建库存管理

> ID：12484925
> 
> 赞同：0
> 
> 时间：2012-09-18T20:55:59.577
> 
> 标签：mysql, database-design, stock

我目前正在创建一个拍卖网站，应该可以在其中创建一种或多种产品的拍卖。这应该通过一些不同的产品变体来管理。

我的问题是，我不确定我是否已经构建了用于处理库存管理的最佳 MySQL 结构。这是我的数据库的外观：

属性 AttributeValues 组合 CombinationParts

在这里，我将有以下连接：

```
Attributes is the "main" name of the attribute - e.g. "Size", "Colour" or so. This has a
ProductID (connecting it to a product).

AttributeValues is the value - e.g. "43", "44", "45"... 
I connect this to Attributes on a field called AttributeID. 
```

然后我会创建一些组合——例如，如果鞋子有更多的属性，就会创建一个组合。

```
Combinations has the name and stock of the product - connected 
to a product on ProductID
- e.g. "Nike shoe, red, 43" or "T-shirt, blue, Large".

CombinationParts is then connecting to a product with an AuctionID and then 
to a AttributeValue with AttributeValueID. 
```

编辑：我将库存与每种产品联系起来的原因是，我需要将更多产品与拍卖联系起来

这个想法是，当您创建拍卖时，您输入每种类型的数量，有库存。

我的问题是我是否可以让同样的事情变得更容易？换句话说：当我需要将我的网站扩展到可能包含 25,000 种产品时，这是最佳选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:14:55.967

当可能的属性集未知时，拥有一个键-键-值表（产品 X、“品牌”、“耐克”）是处理属性和值的好方法。有时查询时可能会很笨拙，但维护起来要容易得多。

# android - ListView 没有填满屏幕

> ID：12484928
> 
> 赞同：0
> 
> 时间：2012-09-18T20:56:12.370
> 
> 标签：android, listview, widget, textview, android-arrayadapter

我有一个我制作的列表视图，虽然没有足够的项目来填满整个屏幕。我已经将我的背景颜色设置为默认值以外的颜色，所以我的列表视图现在看起来真的很糟糕。有没有办法让我填满屏幕的其余部分？

**settings_list.xml**

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/gray_bkg"
>
    <TextView xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/selection"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:background="@color/gray_bkg"
    />

    <ListView 
        android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:drawSelectorOnTop="false"
        android:background="@color/gray_bkg"
    />
</LinearLayout> 
```

**SettingsActivity.java**

```
package shc_BalloonSat.namespace;

import android.app.ListActivity;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class SettingsActivity extends ListActivity
{
    private ArrayAdapter<String> adapter;

    private String[] list = {"Get Last 5 Packets", "Get Last 10 Packets", "Get Last 20 Packets",
            "Change View"};

    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        adapter = new ArrayAdapter<String>(this, R.layout.settings_list, R.id.selection , list);

        setListAdapter(adapter);
    }

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id)
    {
        super.onListItemClick(l, v, position, id);
    }
} 
```

另外，当适配器只希望我将 textview 的 id 传递给它时，为什么我需要 listview 小部件？

更新：

我在上面更新了我的 XML 代码。即使我将背景颜色添加到 LinearLayout，我的列表视图下方的背景仍然是默认的黑色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T16:56:48.497

> 我已将背景颜色设置为默认值以外的颜色

应用样式特征（如颜色）的最佳方式是使用[Themes](http://developer.android.com/guide/topics/ui/themes.html)。主题可以使用几行代码在一个地方设置所有内容的背景颜色。

> 我在上面更新了我的 XML 代码。即使我将背景颜色添加到 LinearLayout，我的列表视图下方的背景仍然是默认的黑色。

ListView 行不接收来自 ListView 元素的特征，例如背景。这些行从此处定义的行布局中接收它们的特征：

```
adapter = new ArrayAdapter<String>(this, R.layout.settings_list, R.id.selection , list); 
```

背景`settings_list.xml`需要透明或设置为与其他所有内容相同的颜色。

* * *

从评论上移：

> “当适配器只希望我将 textview 的 id 传递给它时，为什么我需要 listview 小部件？”

如果您删除 ListView，适配器将在哪里显示其 TextViews？ListView 是强制性的，它提供顺序和功能（如 onListItemClick() 方法。）

> 但是当我没有将它传递给适配器时，它怎么知道它在那里？

您正在使用 ListActivity。ListActivity 的一项要求是在您的布局中使用 id 有一个 ListView `android:id/list`。ListActivity 自动使用此 ListView，为您设置了许多功能，并了解您在调用*时*将 ArrayAdapter 传递给 ListView：

```
setListAdapter(adapter); 
```

希望有帮助！

# javascript - gruntjs - 在哪里安装任务？

> ID：12484929
> 
> 赞同：8
> 
> 时间：2012-09-18T20:56:14.677
> 
> 标签：javascript, gruntjs

从事[gruntjs](http://gruntjs.com/) 'Hello World' 项目，似乎没有安装 grunt 任务的最佳位置。例如，假设我想开始编译咖啡脚本，我需要安装“grunt-coffee”任务。

## 选项 1：将其直接安装到我的 src 树中

这似乎是[grunt 希望你这样做的方式](https://github.com/cowboy/grunt/blob/master/docs/api.md#gruntloadnpmtasks)，并且它有效。

```
cd $MY_PROJECT_HOME
npm install grunt-coffee
grunt coffee 
```

但是，这会在我的项目树中增加 7.2mg。我不想把它放在我的 src 控件中，但是如果我删除它，grunt 将不会构建我的项目。我可以 .gitignore 它，但是下载存储库的其他人如果不进行相同的安装就无法构建。这对于 CI 服务器来说也有点混乱。

## 选项 2：全局安装

```
cd $MY_PROJECT_HOME
npm install -g grunt-coffee
grunt coffee 
```

如果我以这种方式安装它们，Grunt 将找不到我的插件：

```
Local Npm module "grunt-coffee" not found. Is it installed? 
```

我不清楚为什么不支持这一点。

## 选项 3：将它们安装在其他地方？

Grunt 有一个名为[loadTasks](https://github.com/cowboy/grunt/blob/master/docs/api.md#gruntloadtasks)的 api 方法，用于在本地加载任务。我尝试拉下 npms 并将它们自己移动到我在这里引用的自定义目录中，但没有成功。例如

```
grunt.loadTasks('$SHARED_TASKS_FOR_ALL_MY_GRUNT_PROJECTS/node_modules/grunt-coffee') 
```

进而：

```
cd $SHARED_TASKS_FOR_ALL_MY_GRUNT_PROJECTS
npm install grunt-coffee
cd $MY_PROJECT_HOME
grunt coffee

Task "coffee" not found. Use --force to continue. 
```

## 选项 4：Grunt 在其 loadNpmTasks 调用中为我在某个 .grunt 目录中拉下依赖项

那会很好... :)

* * *

## 编辑

下面的辛德雷是正确的。选项 1 是可行的方法，但缺少一个部分 - package.json 文件。所以：

*   添加一个 package.json 文件并将所有 grunt 项目的[依赖项放在那里](https://npmjs.org/doc/json.html#dependencies)。
*   确保它`node_modules`是`.gitignore`-ed。
*   在您的自述文件中，提供一些说明以`npm install`在克隆时运行（注意，没有参数）或者是否将依赖项添加到构建文件中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-24T09:57:13.927

第一个选项是正确的方法。您不提交 node_modules 文件夹，而只是指示用户执行`npm install`获取所有必需依赖项的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:11:58.900

如果你想使用选项 3，正确的语法是这样的：

```
grunt.loadTasks('$SHARED_TASKS_FOR_ALL_MY_GRUNT_PROJECTS/node_modules/grunt-coffee/tasks') 
```

我们必须以某种方式将其用于我们的构建过程，该过程在与“外部世界”隔离的计算机上运行并且无法在构建时引入依赖项......

# .net - 使用 Mono Cecil 添加指令时，IL 偏移发生错误更改

> ID：12484931
> 
> 赞同：2
> 
> 时间：2012-09-18T20:56:24.187
> 
> 标签：.net, cil, mono.cecil

> **可能重复：**
> [Mono.Cecil 是否负责分支等位置？](https://stackoverflow.com/questions/7267480/does-mono-cecil-take-care-of-branches-etc-location)

我正在开发一个项目，该项目要求我在我的应用程序中调用某些方法后插入一个静态方法调用。我正在使用 Mono Cecil，并且在大多数情况下一切正常。但是，当更新的程序集写入磁盘时，我遇到了一些分支偏移量被破坏的情况。这是我的代码的样子：

```
公共无效仪器方法（方法定义方法）
{
    var 处理器 = method.Body.GetILProcessor();

    var instr = GetStaticInstrumentMethod();
    var 仪器 = method.Module.Import(instr);
    var call = method.Body.Instructions.First(i => i.IsCallImInterestedIn());
    处理器.InsertBefore（调用，仪器）；
}

```

因此，该代码在 90% 的情况下都可以正常工作 - 目标方法通过我的额外调用进行了检测，并且一切正常。

另外 10% 的情况下，检测方法无法执行，并且尝试在 ILSpy 中查看它时出错。ILSpy 错误是：

```
ICSharpCode.Decompiler.DecompilerException：错误反编译 System.Object Savo.Utilities.Mapping.ReflectionMapper::MapTo(System.Object,System.Object)
 ---> System.NullReferenceException：对象引用未设置为对象的实例。
   在 ICSharpCode.Decompiler.ILAst.ILAstBuilder.c__DisplayClass33.b__26(ByteCode b)
   在 System.Linq.Enumerable.Any[TSource]（IEnumerable`1 源，Func`2 谓词）
   在 ICSharpCode.Decompiler.ILAst.ILAstBuilder.ConvertLocalVariables(List`1 body)
   在 ICSharpCode.Decompiler.ILAst.ILAstBuilder.StackAnalysis(MethodDefinition methodDef)
   在 ICSharpCode.Decompiler.Ast.AstMethodBodyBuilder.CreateMethodBody（IEnumerable`1 参数）
   在 ICSharpCode.Decompiler.Ast.AstMethodBodyBuilder.CreateMethodBody（MethodDefinition methodDef，DecompilerContext 上下文，IEnumerable`1 参数）
   --- 内部异常堆栈跟踪结束 ---
   在 ICSharpCode.Decompiler.Ast.AstMethodBodyBuilder.CreateMethodBody（MethodDefinition methodDef，DecompilerContext 上下文，IEnumerable`1 参数）
   在 ICSharpCode.Decompiler.Ast.AstBuilder.CreateMethod(MethodDefinition methodDef)
   在 ICSharpCode.ILSpy.CSharpLanguage.DecompileMethod（MethodDefinition 方法，ITextOutput 输出，DecompilationOptions 选项）
   在 ICSharpCode.ILSpy.TextView.DecompilerTextView.DecompileNodes（反编译上下文上下文，ITextOutput textOutput）
   在 ICSharpCode.ILSpy.TextView.DecompilerTextView.c__DisplayClass10.b__f()

```

我已经用 ildasm 反编译了代码，我注意到在保存程序集时如何更新偏移似乎存在问题。我没有对调用的偏移量做任何事情（试图手动设置它们，但看到了同样的问题）。我的一种问题方法的仪器前反汇编如下所示：

```
IL_000e:  br.s       IL_005e
IL_0010:  ldloca.s   CS$5$0000
IL_0012:  call       instance !0 valuetype         [mscorlib]System.Collections.Generic.List`1/Enumerator<class MyThing>::get_Current()
IL_0017:  stloc.0
IL_0018:  nop

... business logic ...    

IL_005d:  nop
IL_005e:  ldloca.s   CS$5$0000
IL_0060:  call       instance bool valuetype      [mscorlib]System.Collections.Generic.List`1/Enumerator<class MyThing>::MoveNext()
IL_0065:  stloc.3
IL_0066:  ldloc.3
IL_0067:  brtrue.s   IL_0010
IL_0069:  leave.s    IL_007a 
```

当我查看已检测的反汇编时，此示例中对应于 IL_0067 的行显示为：

```
IL_00bc:    brtrue.s    IL_0129 
```

由于当前方法中不存在 IL_0129，因此无法编译。

我注意到了，但我还没有证明这只发生在迭代器周围。到目前为止发生这种情况的两种情况的 C# 代码都是 foreach 循环，并且不正确的分支目标似乎都与 foreach 循环的结束条件有关。

所以，我的问题是：我需要手动管理偏移量引用，还是我做错了什么？

# c# - 使用 json.net 使用 lambda 选择器序列化对象

> ID：12484933
> 
> 赞同：1
> 
> 时间：2012-09-18T20:56:36.377
> 
> 标签：c#, json, json.net

我有以下代码

```
class MyJSONSerializableClass
{        
    [JsonProperty("index")]
    public int Index { get; set; };

    [JsonIgnore]
    public long Id { get; set; };
}

var collection = new List<MyJSONSerializableClass>()
{
    new MyJSONSerializableClass() 
    {
        Index = 10,
        Id = 1000
    }
};

string jsonOutput = JsonConvert.SerializeObject(collection); 
```

jsonOutput 将是

```
[{ index: 10 }] 
```

我希望 jsonOutput 是

```
[ 10 ] 
```

是否有任何类属性可以应用于 MyJSONSerializableClass 来告诉 JSON.NET 只发出属性索引，而不是整个对象？

类似的东西

```
[JsonOutput(f => f.Index)]
class MyJSONSerializableClass
{
   ...
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:28:26.583

不确定属性，但或者，您可以尝试

```
JsonConvert.SerializeObject(collection.Select(o => o.Index)). 
```

根据[文档](http://james.newtonking.com/projects/json/help/)，所有 IEnumerable 都将是数组。

# php - 按标签/ URL Wordpress 获取所有帖子

> ID：12484945
> 
> 赞同：0
> 
> 时间：2012-09-18T20:57:27.630
> 
> 标签：php, wordpress, tags, taxonomy

我正在寻找创建一个 tag.php 页面，当用户单击标签云中的标签时，它会显示所有标签。这是我到目前为止所得到的，但这似乎显示了我所有的帖子。

```
<article class="articles"> 
<?php
echo '<h2>Tag:';
$tag = single_tag_title();
echo '</h2>';
$args = array(
            'taxonomy' => $tag,
            'terms' => $tag,
);
$postslist = get_posts( $args );?>

<?php foreach( $postslist as $post ) :  setup_postdata($post); ?>

      <div class="clear"></div>
      <span class="timestamp"><?php echo mysql2date('j M Y', $post->post_date) ;?></span></h2>
      <p class="about"><?php the_title(); ?></p>
      <?php the_content(''); ?>
      <?php endforeach;?>
</div> 
```

我似乎无法弄清楚这一点，我一直在谷歌搜索，但我似乎无法找到我想要的信息......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:20:43.940

你`single_tag_title`的它没有返回变量：

```
$tag = single_tag_title('', false); 
```

尝试：

```
<?php
$tag = single_tag_title('', false);
echo '<h2>Tag: '.$tag.'</h2>';

$args = array(
            'taxonomy' => $tag,
            'terms' => $tag,
);
$postslist = get_posts( $args );?>

<?php foreach( $postslist as $post ) :  setup_postdata($post); ?>
<div class="clear"></div>
      <span class="timestamp"><?php echo mysql2date('j M Y', $post->post_date) ;?></span></h2>
      <p class="about"><?php the_title(); ?></p>
      <?php the_content(); ?>
</div>
<?php endforeach;?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-05T20:38:17.953

尝试使用 wp_query

```
$tag = single_tag_title('', false);
echo '<h2>Tag: '.$tag.'</h2>';

// The Query
$the_query = new WP_Query( $tag );

// The Loop
if ( $the_query->have_posts() ) {
while ( $the_query->have_posts() ) {
            $the_query->the_post();
    $post = get_queried_object();
            echo "<div class='clear'></div>
  <span class='timestamp'>" . mysql2date('j M Y', $post->post_date) . " </span></h2>
  <p class='about'" . the_title() . "</p>";
  <?php the_content(); ?>
</div>
}
} else {
// no posts found
}
/* Restore original Post Data */
wp_reset_postdata(); 
```

请注意，我没有测试过这段代码！

# c# - 当它是一个短日期字符串时，Linq 排序日期

> ID：12484947
> 
> 赞同：2
> 
> 时间：2012-09-18T20:57:36.773
> 
> 标签：c#, linq

当我已经从 linq 带回一个日期并转换为短日期字符串时，我正在尝试使用 linq 按日期排序：

```
var NOVs = from n in db.CT_NOVs
join i in db.CT_Inspectors on n.ARBInspectorID equals i.CTInspectorID
join v in db.CT_ViolationTypes on n.ViolationTypeID equals v.ViolationTypeID
join t in db.CT_Tanks on n.CargoTankID equals t.CargoTankID
join c in db.CT_Companies on t.CompanyID equals c.CompanyID
select new
{
    n.NOVID,
    n.NOVNumber,
    NOVDate = n.NOVDate.Value.ToShortDateString(),
    ARBInspectorFirstName = i.FirstName,
    ARBInspectorLastName = i.LastName,
    v.ViolationName,
    t.CargoTankID,
    c.CompanyName
}; 
```

这是我尝试按日期排序的地方，但由于我将日期时间转换为短日期字符串，因此出现错误：

```
if (column == "NOVDate")
{
    if (sortDirection == "ascending")
        NOVs = NOVs.OrderBy(b => Convert.ToDateTime(b.NOVDate));
    else
        NOVs = NOVs.OrderByDescending(b => Convert.ToDateTime(b.NOVDate));
} 
```

关于如何按 NOVDate 排序的任何线索？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T21:00:51.947

为什么不将其保留为完整的 DateTime 对象并在将其显示给用户之前将其转换为 ShortDateString？我通常会尝试将对象保留为原始格式，并在最后一秒将它们转换为显示给用户。这也有助于将数据层与表示层分开，即让表示层决定如何向用户显示日期；您的数据层不应该真正关心。

### 从评论：

由于您在`<asp:BoundField>`GridView 中使用元素，因此可以使用[DataFormatString](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.boundfield.dataformatstring.aspx)属性让网格视图自动对其进行格式化。

看起来使用`DataFormatString="{0:d}"`应该可以解决问题。（感[谢格罗默](https://stackoverflow.com/users/104198)！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:03:35.317

您可以在选择元素之前使用“orderby”子句。

检查此链接：http: [//msdn.microsoft.com/en-us/library/bb383982.aspx](http://msdn.microsoft.com/en-us/library/bb383982.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:12:52.080

您先对其进行排序，然后根据需要显示它：

```
var NOVs = from n in db.CT_NOVs
               join i in db.CT_Inspectors on n.ARBInspectorID equals i.CTInspectorID
               join v in db.CT_ViolationTypes on n.ViolationTypeID equals v.ViolationTypeID
               join t in db.CT_Tanks on n.CargoTankID equals t.CargoTankID
               join c in db.CT_Companies on t.CompanyID equals c.CompanyID
               orderby n.NOVDate.Value
               select new
               {
                   n.NOVID,
                   n.NOVNumber,
                   NOVDate = n.NOVDate.Value.ToShortDateString(),
                   ARBInspectorFirstName = i.FirstName,
                   ARBInspectorLastName = i.LastName,
                   v.ViolationName,
                   t.CargoTankID,
                   c.CompanyName
               }; 
```

那么你可以这样做：

```
 if (column == "NOVDate")
        {
            if (sortDirection != "ascending")
                NOVs = NOVs.Reverse();               
        } 
```

# ruby - Ruby 中的案例语句 (line.scan)

> ID：12484955
> 
> 赞同：0
> 
> 时间：2012-09-18T20:58:29.780
> 
> 标签：ruby, regex, match

我正在使用命名的 rexeg 捕获组，并且我的 case 语句适用于`match`，但它给了我不想要的数据。当我运行下面的代码时，它只能匹配一个语句。我哪里错了？

```
File::open(file).lines do |line|
    case
      when line.scan(regex1) then puts line.scan(regex1)
      when line.scan(regex2) then puts line.scan(regex2)
      when line.scan(regex3) then puts line.scan(regex3)
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T21:03:49.707

`case`执行第一个真表达式。

如果您有多个检查，其中每个检查都可能是真的，您应该使用多个`if`- 语句。

```
File::open(file).lines do |line|
  puts line.scan(regex1) if line.scan(regex1)
  puts line.scan(regex2) if line.scan(regex2)
  puts line.scan(regex3) if line.scan(regex3)
end 
```

我认为以下版本更加灵活和高效：

```
File::open(file).lines do |line|
  [ regex1, regex2, regex3] do |regex|
    if result =  line.scan(regex)
            puts result
    end
  end
end 
```

# ruby - 如何用匹配结果查询用户？

> ID：12484958
> 
> 赞同：0
> 
> 时间：2012-09-18T20:58:52.237
> 
> 标签：ruby

我有以下内容：

```
dport = t.cmd("show ift").to_enum(:scan, /eth-\d/).map { Regexp.last_match } 
```

结果，我得到以下信息：

```
[#<MatchData "eth-0">, #<MatchData "eth-1">, #<MatchData "eth-2">, #<MatchData "eth-3">, #<MatchData "eth-4">, #<MatchData "eth-8">] 
```

好消息是这正是我所追求的；关于比赛。但是，我对如何前进感到有些困惑。我想查询用户并让用户选择一个特定的匹配项。有任何想法吗？提前感谢您为我提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:12:12.583

看起来您首先需要从每个 MatchData 对象中提取匹配的字符串，以呈现给用户，例如：

```
dport.each { |match| puts match[some_index] } 
```

有关 MatchData 对象的更多信息，请参阅[http://www.ruby-doc.org/core-1.9.3/MatchData.html](http://www.ruby-doc.org/core-1.9.3/MatchData.html)。

然后假设您使用命令行从用户获取输入使用gets() 方法：[http ://www.ruby-doc.org/core-1.9.3/IO.html#method-i-gets](http://www.ruby-doc.org/core-1.9.3/IO.html#method-i-gets)

# asp.net-mvc - 传入字典的模型项的类型为“System.Int64”

> ID：12484965
> 
> 赞同：2
> 
> 时间：2012-09-18T21:00:09.420
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我有一个包含项目集合的模型，这些项目使用 EditorTemplate 显示。如果我的模型没有 Quantity 字段的值，我没有问题。但是，如果数量属性具有值，则在呈现模板视图时，@Html.EditorFor(m=>m.Quantity ... 会引发以下异常：

```
The model item passed into the dictionary is of type 'System.Int64', 
but this dictionary requires a model item of type 'System.String' 
```

这是编辑器模板。

```
@model OrderLineItemModel
<tr id="rowid-@Model.ItemID">
    <td class="itemidcell">@Html.HiddenFor(m=>m.ItemID) @Html.DisplayFor(m=>m.ItemID)</td>
    <td>@Html.HiddenFor(m => m.CustomerItemID)@Html.DisplayFor(m=>m.CustomerItemID)</td>
    <td>@Html.HiddenFor(m => m.ItemName)@Html.DisplayFor(m=>m.ItemName)</td>
    <td>@Html.HiddenFor(m => m.BlanketOrderQuantity)@Html.DisplayFor(m=>m.BlanketOrderQuantity)</td>
    <td>@Html.HiddenFor(m => m.ReleasedQuantity)@Html.DisplayFor(m=>m.ReleasedQuantity)</td>
    <td>@Html.HiddenFor(m => m.RemainingQuanity)@Html.DisplayFor(m=>m.RemainingQuanity)</td>
    <td id="cellid-@Model.ItemID">@Html.DisplayFor(m=>m.Price)</td>
    <td class="quantitycell">@Html.EditorFor(m=>m.Quantity, new {@class = "quantitytxt"}) @Html.ValidationMessageFor(m => m.Quantity)</td>
</tr> 
```

失败的线路是这一行。

```
<td class="quantitycell">@Html.EditorFor(m=>m.Quantity, new {@class = "quantitytxt"}) @Html.ValidationMessageFor(m => m.Quantity)</td> 
```

Quantity 的数据类型为 Int64。我不确定为什么字典第二次需要 String 而不是初始渲染。

这是控制器动作。

```
 [HttpPost]
    public ActionResult Release(ReleaseModel model) {          

        var errors = _orderProcessorService.ValidateOrder(model);

        if (errors.Count > 0) {
            foreach (var orderValidationError in errors) {
                ModelState.AddModelError(orderValidationError.Name, orderValidationError.Description);
            }
        }

        if (! ModelState.IsValid) {

            return View(model);
        }

        var response = _orderProcessorService.SubmitOrder(model);

        var responseModel = new OrderResponseModel();
        if (response.OrderStatus == Enumerations.OrderStatus.Success) {
            responseModel.Message = "Thank you for submitting your order. Your sales representative will contact you with any questions concerning your order.";
            responseModel.OrderStatus = "successful";
        }
        else {
            responseModel.Message = "We are sorry, but something has happened during your order submission and your order wasn't processed successfully. Please contact your sales representative regarding this order submission.";
            responseModel.OrderStatus = "failed";
        }

        return View("OrderSubmitted", responseModel);

    } 
```

这是用于模板的我的模型。

```
using System;
using System.ComponentModel.DataAnnotations;

namespace ViewModels.BlanketOrder {
    public class OrderLineItemModel  {
        [Display(Name = "Customer Item #")]
        public string CustomerItemID { get; set; }

        [Display(Name = "Item #")]
        public string ItemID { get; set; }

        [Display(Name = "Item Name")]
        public string ItemName { get; set; }

        [DisplayFormat(DataFormatString = "#,###")]
        public int? PriceUnit { get; set; }

        public string UnitID { get; set; }

        [Display(Name = "Quantity")]
        [Required(ErrorMessage = "Item Quantity is required")]
        [RegularExpression(@"[0-9]+", ErrorMessage = "Item Quantity must be a whole Number")]
        [Range(1, 15000000, ErrorMessage = "Item Quantity must be between 1 - 15000000")]
        [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = "{0:0}", NullDisplayText = "0")]
        public Int64? Quantity { get; set; }

        [Display(Name = "Unit Price")]
        public Decimal? Price { get; set; }

        public Int64 BlanketOrderQuantity { get; set; }
        public Int64 ReleasedQuantity { get; set; }
        public Int64 RemainingQuanity { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T12:40:51.567

看看我对自己问题的回答。

[https://stackoverflow.com/questions/10723782/how-can-i-pass-an-int-value-as-the-linktext-for-and-actionlink/10726097#10726097](https://stackoverflow.com/questions/10723782/how-can-i-pass-an-int-value-as-the-linktext-for-and-actionlink/10726097#10726097)

你也许可以做到这一点。

`@Html.ValidationMessageFor(m => (string)m.Quantity.ToString() ?? 0)`

# api - 为什么 Cisco WebDialer API 在拨打电话时不使用指定的 lineNumber？

> ID：12484966
> 
> 赞同：2
> 
> 时间：2012-09-18T21:00:18.267
> 
> 标签：api, telephony, cisco

我正在使用 Cisco WebDialer API 为具有多条线路的用户拨打电话。调用`makeCallSoap`时，参数的`lineNumber`属性`UserProfile`似乎被忽略了。呼叫成功拨打，但始终使用用户的默认线路，而不是`UserProfile`参数中指定的线路。

如何使用 WebDialer API 的默认线路以外的线路拨打电话？

# solr - Solr Suggester 不返回多个术语

> ID：12484971
> 
> 赞同：2
> 
> 时间：2012-09-18T21:00:44.397
> 
> 标签：solr

我正在尝试设置建议器组件，但我没有得到我期望的结果。我希望我能得到短语，但我得到的是单个单词，有些甚至不存在。数据如下所示：

```
Fullerton, CA 
Fulton, NY 
Fultondale, AL 
Fulton County, GA 
```

我的架构文件如下所示：

```
<fieldType name="text_general" class="solr.TextField">
  <analyzer type="index">
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
  </analyzer>
  <analyzer type="query">
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
  </analyzer>
</fieldType>

<fieldtype name="phrase_suggest" class="solr.TextField">
  <analyzer>
    <tokenizer class="solr.KeywordTokenizerFactory"/>
    <filter class="solr.PatternReplaceFilterFactory"
            pattern="([^\p{L}\p{M}\p{N}\p{Cs}]*[\p{L}\p{M}\p{N}\p{Cs}\_]+:)|([^\p{L}\p{M}\p{N}\p{Cs}])+"
            replacement=" " replace="all"/>
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.TrimFilterFactory"/>
  </analyzer>
</fieldtype> 
```

我的 solrconfig 看起来像：

```
<searchComponent class="solr.SpellCheckComponent" name="suggest">
<lst name="spellchecker">
  <str name="name">suggest</str>
  <str name="classname">org.apache.solr.spelling.suggest.Suggester</str>
  <str name="lookupImpl">org.apache.solr.spelling.suggest.tst.TSTLookup</str>
  <str name="field">Location</str>
</lst>
<!-- specify a fieldtype using keywordtokenizer + lowercase + cleanup -->
<str name="queryAnalyzerFieldType">phrase_suggest</str>
</searchComponent>

<queryConverter name="queryConverter"  class="org.apache.solr.spelling.SuggestQueryConverter"/>

<requestHandler class="org.apache.solr.handler.component.SearchHandler" name="/suggest">
<lst name="defaults">
  <str name="spellcheck">true</str>
  <str name="spellcheck.dictionary">suggest</str>
  <str name="spellcheck.count">5</str>
  <str name="spellcheck.collate">true</str>
</lst>
<arr name="components">
  <str>suggest</str>
</arr> 
```

结果如下所示：

```
<response>
    <lst name="responseHeader">
        <int name="status">0</int>
        <int name="QTime">2</int>
    </lst>
    <lst name="spellcheck">
    <lst name="suggestions">
    <lst name="ful">
        <int name="numFound">5</int>
        <int name="startOffset">0</int>
        <int name="endOffset">3</int>
        <arr name="suggestion">
            <str>fuld</str>
            <str>full</str>
            <str>fuller</str>
            <str>fulton</str>
            <str>fultondale</str>
        </arr>
    </lst>
    <str name="collation">fuld</str>
    </lst>
    </lst>
</response> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-14T13:00:21.300

我认为您应该从“text_general”中删除分析器 type=query

应该是这样的：

```
`<fieldType name="text_general" class="solr.TextField">
  <analyzer type="index">
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
  </analyzer>
</fieldType>` 
```

# asp.net-mvc-3 - 使用 IIS Express 时通过 NHibernate 访问二进制文件的速度非常慢

> ID：12484974
> 
> 赞同：3
> 
> 时间：2012-09-18T21:00:59.717
> 
> 标签：asp.net-mvc-3, visual-studio-2010, nhibernate, iis-express

我一直无法谷歌这个，可能是因为我无法找出正确的搜索内容。在我正在处理的 MVC3 项目中，我有一个带有“图像”数据列的表。该表通过 NHibernate 模型访问，该模型将该列映射为字节数组。在我们的实时服务器（使用常规 IIS）上运行它或使用内置的 Visual Studio 开发服务器运行时，这不是性能问题。但是，尝试使用 IIS Express 运行它会导致对表的访问停止（几乎）。看起来，如果我尝试访问具有大小约为 500k 的二进制数组的行，则该过程将开始需要 2-3 分钟才能完成。如果阵列更大，则更长。

是否有一些我缺少的 IIS Express 配置会导致这种情况发生？

相关位：

*   NHibernate 3.1
*   Visual Studio 2010 专业版 SP1
*   Windows 7 专业版 x64
*   IIS Express 7.5
*   数据库服务器 2008

所做的唯一更改是在 IIS Express 与 cassini 中运行的 VS 项目设置。除此之外，这一切都在同一台开发机器上运行。

**更新**

在尝试运行探查器后，我发现只有在 Visual Studio 启动 IIS Express 时才会出现该问题。如果我在 VS 之外运行 IIS Express，则不会出现此问题。无论附加了 VS 调试器，VS 的 CPU 使用率都会在此问题发生时达到峰值。VS 仍然响应。

**更新 2** IIS Express 8 仍然会出现这种情况。

# python - Sqlalchemy 在多个表上使用带有外连接的 func

> ID：12484975
> 
> 赞同：3
> 
> 时间：2012-09-18T21:01:02.030
> 
> 标签：python, sql, sqlalchemy, pyramid

我在 sqlalchemy 中有以下表格：-

```
class Post(Base):
    __tablename__ = 'posts'
    id = Column(Integer, primary_key=True)
    compare_url =Column(String(200))
    url = Column(String(200))
    postedby = Column(Integer)
    category = Column(String(50))
    title  = Column(String(500),nullable=False)
    author  = Column(String(500),default="Unspecified")
    content = Column(Text(),default="could not fetch this content you will have to read it externally")
    summary = Column(Text())
    time = Column(TIMESTAMP(),default=now())
    post_type=Column(Text())
    Reads = relationship("Read", backref="Post")
    Reposts = relationship("RePost", backref="Post")
    Votes = relationship("Vote", backref="Post")

class Read(Base):
    __tablename__ = 'reads'
    id = Column(Integer, primary_key=True)
    post_read = Column(Integer, ForeignKey('posts.id'))
    #post = relationship("Post", backref=backref('Reads', order_by=id))
    time = Column(TIMESTAMP(),default=now())
    user_id = Column(String(50))

class Vote(Base):
    __tablename__ = 'votes'
    id = Column(Integer, primary_key=True)
    post_read = Column(Integer, ForeignKey('posts.id'))
    time = Column(TIMESTAMP(),default=now())
    user_id = Column(String(50))
    user_vote = Column(Boolean(),nullable=False) 
```

我有这个查询

```
posts = session.query(Post, func.count(Read.id).label('total'),func.sum(Vote.user_vote).label('votes'),User.username).outerjoin(Post.Reads).outerjoin(Post.Votes) 
```

我试图获得票数和帖子被阅读的次数。投票值可以是 -1 或 1

问题是我在每个帖子上的阅读次数和投票数都相同

例如，当我的读取表有

```
id  post_read   time             user_id
1   7       2012-09-19 09:32:06  1 
```

和投票表有

```
id  post_read   time                 user_id    user_vote
1   7 [->]         2012-09-19 09:42:27  1   1
2   7 [->]         2012-09-19 09:42:27  2   1 
```

但我仍然得到投票的价值，并且读作两个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T15:13:28.037

看起来好像您可以通过简单地替换来解决这个特定`func.count(Read.id).label('total')`问题`func.count(func.distinct(Read.id)).label('total')`。事实上，这将解决读取次数的问题。

但是，如果您的帖子突然有另一个读者（最终有 2 个读者和 2 个选民），那么您的所有选票也将被计算两次。

最好的解决方案就是不要在同一个查询中聚合不同的项目。您可以使用子查询来解决这个问题：

```
subq_read = (session.query(
                Post.id, 
                func.count(Read.id).label("total_read")
            ).
            outerjoin(Post.Reads).
            group_by(Read.post_read)
            ).subquery()

subq_vote = (session.query(
                Post.id, 
                func.sum(Vote.user_vote).label("total_votes")
            ).
            outerjoin(Post.Votes).
            group_by(Vote.post_read)
            ).subquery()

posts = (session.query(
            Post, 
            subq_read.c.total_read,
            subq_vote.c.total_votes,
        ).
        outerjoin(subq_read, subq_read.c.id == Post.id).
        outerjoin(subq_vote, subq_vote.c.id == Post.id)
        .group_by(Post)
        ) 
```

*注意：您`User.username`的查询中有一个，但我没有`join`在查询中看到任何子句。您可能也想检查一下。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-08-06T02:31:37.040

连接多个表时，较早连接的表会为稍后以一对多关系连接的表重复其行（简单地说）。这就是为什么你的计数是关闭的。在这样的连接中，您总是需要在结果集中找到一些不同的东西来计算……例如主键。我发现这比子查询更可取，因为它要快得多。事实上，我所做的大部分性能调整都来自于消除子查询。

因此，如果您对`user_vote`列进行过滤以消除您不想计算的记录，您可以像这样修复您的查询：

```
posts = session.query(Post
    ,   func.count(distinct(Read.id)).label('total')
    ,   func.count(distinct(Vote.id)).label('votes')
    ,   User.username
    ) \
    .outerjoin(Post.Reads) \
    .outerjoin(Post.Votes) \
    .filter(Votes.user_vote == True) 
```

但是，您可能还想添加一个 group_by 或其他过滤器，以获取每个帖子的计数，这是您可能的目标。

# r - 将参数的默认值从 S4 泛型函数分派到其关联方法

> ID：12484977
> 
> 赞同：8
> 
> 时间：2012-09-18T21:01:07.603
> 
> 标签：r, methods, default-value, s4

假设与特定 S4 通用函数/方法关联的**所有**S4 方法共享一个应该具有特定默认值的形式参数。直观地说，我会在 S4**泛型**的定义中陈述这样一个论点（而不是在每个方法定义中陈述它，这对我来说似乎有些多余）。

但是，我注意到这样我遇到了麻烦，因为似乎形式参数的默认值没有分派给方法，因此引发了错误。

这不是有点反对结合泛型和方法的想法吗？当默认值始终相同时，为什么我必须再次在每个方法中分别声明形式参数？我可以以某种方式显式分派形式参数的默认值吗？

* * *

您将在下面找到该行为的简短说明

## 通用函数

```
setGeneric(
    name="testFoo",
    signature=c("x", "y"),
    def=function(
        x,
        y,
        do.both=FALSE,
        ...
    ) {
    standardGeneric("testFoo")       
    }
) 
```

## 方法

```
setMethod(
    f="testFoo", 
    signature=signature(x="numeric", y="numeric"),
    definition=function(
        x,
        y
    ) { 
    if (do.both) {
        out <- list(x=x, y=y)
    } else {
        out <- x
    }
    return(out)
    }
) 
```

## 错误

```
> testFoo(x=1, y=2)
Error in .local(x, y, ...) : object 'do.both' not found 
```

## `do.both`修复它的冗余声明

```
setMethod(
    f="testFoo", 
    signature=signature(x="numeric", y="numeric"),
    definition=function(
        x,
        y,
        do.both=FALSE
    ) { 
    if (do.both) {
        out <- list(x=x, y=y)
    } else {
        out <- x
    }
    return(out)
    }
)

> testFoo(x=1, y=2)
[1] 1 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T22:20:57.370

当你调用 时`testFoo(x=1, y=2)`，它首先由 S4 泛型处理，它查找一个方法，找到它，然后向它分派一个如下所示的调用`testFoo(x=1, y=2, do.both=FALSE, ...)`：

用以下话说`?standardGeneric`：

> 'standardGeneric' 调度为名为'f' 的通用函数定义的方法，使用调用它的框架中的实际参数。

如果它派发该调用的方法不*接受*`do.both`参数，则该方法 ---**就像任何其他 R 函数一样**--- 抛出错误。没有函数可以处理包含参数的调用，`foo`除非它的函数定义包含 (a) 形式参数`foo`或 (b) “点”参数`...`，它可以吸收任意提供的参数。

基本上你所尝试的与以下没有什么不同，它以类似但可能更容易看到的方式失败：

```
testFooGeneric <- function(x=1, y=2, do.both=FALSE, ...) {
    ## The line below does essentially what standardGeneric() does
    if(is.numeric(x) & is.numeric(y)) {
        testFooMethod(x=x, y=y, do.both=do.both)
    }
}

testFooMethod <- function(x, y) {
    cat("Success!\n")
}

testFooGeneric(x=1, y=2)
# Error in testFooMethod(x = x, y = y, do.both = do.both) : 
#   unused argument(s) (do.both = do.both) 
```

要解决上述问题，您需要`testFooMethod()`通过以下两种方式之一重新定义，其中任何一种都可以修复您的 S4 方法：

```
## Option 1
testFooMethod <- function(x, y, do.both) {
    cat("Success!\n")
}
testFooGeneric(x=1, y=2)
# Success!

## Option 2
testFooMethod <- function(x, y, ...) {
    cat("Success!\n")
}
testFooGeneric(x=1, y=2)
## Success! 
```

# windows - 如何在 Windows 上安装omniORB？

> ID：12484978
> 
> 赞同：3
> 
> 时间：2012-09-18T21:01:23.973
> 
> 标签：windows, compilation, installation, omniorb

我安装了 Python 和 MinGW，将所需的一切添加到 PATH（g++ 和 python），并从[http://sourceforge.net/projects/omniorb/files/omniORB/omniORB-4.1.6/omniORB-4.1.6下载了omniORB .tar.bz2/download](http://sourceforge.net/projects/omniorb/files/omniORB/omniORB-4.1.6/omniORB-4.1.6.tar.bz2/download)，解压。

我加入了omniORB 目录，但\bin\x86_win32 目录中没有omniORB 二进制文件。

所以我有两个问题：

1) 我在哪里可以获得omniORB 二进制文件？（我想在装有 Windows XP/Vista（均为 x86）的计算机上安装omniORB）

2）当我只安装了 MinGW（没有 Visual C++）时，是否可以从源代码安装omniORB？**如何做到这一点**（我需要步骤）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-06T09:16:40.647

由于您已经安装了 Python、MinGW 并添加了环境设置，

您需要执行以下操作。

1.  转到 OmniORB 的解压缩文件夹（我假设它在 C:\OmniORB 中）
2.  打开 src 文件夹，您可以在其中找到 make 文件
3.  用你已经安装的 MinGW(gcc) 编译器编译它

问题 1 的答案：编译完成后，如果在 bin 文件夹中找不到 OmniORB 二进制文件，您将获得它。

问题 2 的答案：解压缩后，在内部意味着您已经安装。它在外部没有任何 setup.exe 文件。

由于您有 MinGW 在其中使用 gcc 编译器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T10:41:07.540

windows x86 的最新omniORB 二进制文件是4.1.4 版本。

可以在这里找到[http://sourceforge.net/projects/omniorb/files/omniORB/omniORB-4.1.4/](http://sourceforge.net/projects/omniorb/files/omniORB/omniORB-4.1.4/)

4.1.6版本只有vc2010-x64版本。

# android - Android：Camera.Parameters.setRotation() Galaxy Nexus 出现意外结果

> ID：12484980
> 
> 赞同：1
> 
> 时间：2012-09-18T21:01:34.387
> 
> 标签：android, parameters, camera, rotation, image

不调用`parameters.setRotation()`，pictureCallback保存的图片方向与屏幕预览不一样，所以我添加了行`parameters.setRotation(90)`测试，添加此行后，保存图片的方向是正确的，在我的Nexus One中没有任何问题。

在 Galaxy Nexus 中，方向也是正确的，但图片中的所有内容都比它们现在的样子又薄又高，我注意到结果不一致，有时甚至比其他时候更薄和更高，甚至传递给的图片尺寸`parameters.setPictureSize()`也没有改变。谁能帮我解决这个问题？

最近我请一些朋友测试代码，问题似乎只出现在 Galaxy Nexus 中。

```
Camera.Parameters parameters = camera.getParameters();
parameters.setPreviewSize(previewWidth, previewHeight);
parameters.setPictureSize(pictureWidth, pictureHeight);
parameters.setRotation(90);
camera.setParameters(parameters);
camera.startPreview();
camera.takePicture(shutterCallback, null, null, pictureCallback); 
```

下面是 PictureCallback 中 takePicture() 的代码：

```
public void onPictureTaken(byte[] data, Camera camera) {
    pictureFile = getOutputMediaFile(MEDIA_TYPE_IMAGE);
    errorMessage = null;//reset to null first
    if (pictureFile == null){
        Log.d(TAG, "Error creating media file, check storage permissions: "+e.getMessage());
        errorMessage = "Failed to create media file, storage not available!";
    }else{
        FileOutputStream fos = null;
        try {
            fos = new FileOutputStream(pictureFile);
            fos.write(data);
            fos.flush();
        } catch (FileNotFoundException ex) {
            Log.d(TAG, "File not found: " + e.getMessage());
            ex.printStackTrace();
            errorMessage = "Failed to create media file!";
        } catch (IOException ex) {
            Log.d(TAG, "Error accessing file: " + e.getMessage());
            errorMessage ="Error while writing media file!";
        }finally{
            try{
                if(fos!=null){
                    fos.close();
                }
            }catch(Exception ex){
            }
        }
    }
} 
```

# java - 从套接字获取十六进制值并转换为十进制

> ID：12484981
> 
> 赞同：1
> 
> 时间：2012-09-18T21:01:34.490
> 
> 标签：java, string, hex

我有从套接字读取的数据，并且我知道它具有以下格式：

[2bytes][8bytes][2bytes] = 12 字节

我想单独阅读；并且值是十六进制的。实际上，我不久前在 PHP 中捕获了该数据并将其保存到文件中，我可以使用 od (unix) 正确查看它：

```
$ od -h myFile
$ 0000000 02eb 02fe fe02 fefe 02fe 02fe 000a
$ 0000015 
```

也就是说，最后有一个 CR 和 LF，产生 14 个字节。**如何在 Java 中从套接字读取这些值？**例如，我如何获得“02eb”（2 个字节）并将其转换为十进制值？

我已经从套接字读取，我尝试的最后一件事是：

```
mMessage = mBRin.readLine();
byte[] bytes = mMessage.trim().getBytes() 
```

但这给了我数组中的 18 个字节。

如果有帮助，请在 PHP 中获得我所做的第一部分：

```
$input = socket_read($value,13,PHP_BINARY_READ);
$trim_input = trim($input);
$float_head = hexdec(bin2hex(substr($input,0,2))); 
```

我想我不明白[这一点](https://stackoverflow.com/questions/923863/converting-a-string-to-hexadecimal-in-java)，这可能是答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:06:14.530

```
Socket socket = ......;
        DataInputStream dis = new DataInputStream(socket.getInputStream());
        short f1 = dis.readShort();
        long f2 = dis.readLong();
        sort f3 = dis.readShort(); 
```

要以十六进制打印值，请使用 String.format("%x",f1); 希望能帮助到你 ...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T00:02:36.633

> 我有从套接字读取的数据，并且我知道它具有以下格式：
> 
> [2bytes][8bytes][2bytes] = 12 字节

如果您已经有从套接字读取字节的代码，则可以使用 ByteBuffer 将字节转换为 short、int、long 等值。

```
Socket s = .....;

InputStream in = s.getInputStream();
byte [] buf = new byte[12];

// read 12 bytes from socket into bytes
in.read(buf);

ByteBuffer bb = ByteBuffer.allocate(buf.length);
bb.order(ByteOrder.LITTLE_ENDIAN);
bb.put(buf);
bb.flip();
short short1 = bb.getShort();
long long1 = bb.getLong();
short short2 = bb.getShort(); 
```

请注意将字节缓冲区设置为小端的调用。

当您执行 od 命令时，您会得到类似于以下内容的输出（此输出来自我在系统上创建的用于模仿您的文件）。od -h 命令从文件中读取字节，以 little endian 模式将它们组合为 2 字节的 short，然后以十六进制打印出 short 值。

```
$ od -h binary.dat 
0000000      02eb    02fe    fe02    fefe    02fe    02fe    000a        
0000015 
```

但是，如果您使用 -tx1 ，您会以它们在文件中出现的真实顺序看到字节。

```
$ od -tx1 binary.dat
$ 0000000    eb  02  fe  02  02  fe  fe  fe  fe  02  fe  02  0a
$ 0000015 
```

如果你在你的文件上运行它，我想你会看到它实际上是 13 个字节而不是 14 个字节，并且由单个 LF 终止，而不是 CRLF。您看到的“额外”字节是 od -h 的“礼物”，实际上并不存在于文件中。

无论如何，第一个字节是值 235（十六进制的 EB）。第二个字节是 2。问题是 - 第一个短期需求的正确值是多少。如果根据您的套接字协议，数据以小端模式序列化，则连接成短字节的这两个字节的值为 02EB 十六进制或 747。如果套接字协议使用大端，则值为 EB02 十六进制或 60162。

ByteBuffer 方法为您提供了灵活性，并允许您以大端或小端方式进行读/写。它还允许您将数据的读取从套接字（到字节数组）中分离出来，然后再将数据转换为数字。这可能使单元测试更容易，因为您可以为各种测试用例创建字节数组并确保您的解析代码按预期工作。

sharadendu 的答案中的 DataInputStream 方法也可以工作——但前提是套接字协议是大端的。DataInputStream 被硬编码为大端。

# php - 如何在mysql中选择最近的时间并在函数内返回两个值

> ID：12484983
> 
> 赞同：0
> 
> 时间：2012-09-18T21:01:38.367
> 
> 标签：php, function, datetime

我试图从一个函数返回两个结果，但只有第一个结果显示在我的页面上。

这是我的功能：

```
function latestcomment($forum_topics){
    $recent = mysql_query(" SELECT created, owner, topic_id
                            FROM forum_comments
                            WHERE topic_id = '".mysql_real_escape_string($forum_topics['topic_id'])."'
                            ORDER BY created DESC 
                            LIMIT 1 ");
    $mostrecent = mysql_fetch_array($recent);

    $time = $mostrecent['created'];
    $name = $mostrecent['owner'];

    return $time;
    return $name; 
```

}

然后我这样打电话

```
<?php echo latestcomment($forum_topics); ?> 
```

我从中调用的表如下所示：

```
+-------+----------+---------------------+------------+
| id    | body     | created             | owner    |
+-------+----------+---------------------+------------+
|     1 |    hello | 2019-12-01 15:50:27 | name1      | 
|     2 |    World | 2019-12-01 15:50:32 | name2      | 
|     3 |       Hi | 2019-12-01 15:51:43 | name3      | 
|     4 |     Over | 2019-12-01 10:20:30 | name4      | 
+-------+----------+---------------------+------------+ 
```

此外，我想将返回函数的 created(DATETIME) 部分传递给如下内容：

```
 <?php           
            $date = date_create($forum_topics['$time']) ;
            echo  date_format($date, 'F j, Y'); echo"<br>";
            echo  date_format($date, 'g:i A'); 
            ?> 
```

只使用一个查询？

我怎样才能做到这一点 ？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:04:10.097

两次回报。不去工作。

```
$output = array(
 'time' => $time,
 'name' => $name,
);

return $output; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:04:30.893

这是行不通的：

```
return $time;
return $name; 
```

PHP 将返回第一个值，而带有第二个返回值的行将永远不会被执行。您需要执行以下操作：

```
return ($time, $name); 
```

这将返回两个值，作为一个数组。您需要修改用于处理数组而不是字符串的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T21:05:31.127

执行第一次返回后，您离开函数，甚至不评估第二次返回。返回一个对象或数组。喜欢：

```
return array('time' => $time, 'name' => $name); 
```

或者也许创建一个`comment`对象。填充并返回它。

# asp.net - 基础提供程序在打开时失败

> ID：12484987
> 
> 赞同：0
> 
> 时间：2012-09-18T21:01:53.653
> 
> 标签：asp.net, entity-framework

我制作了 3 个 Ajax 进程来同时运行以下代码。但是其中一个进程抛出异常，该消息显示*“底层提供程序在打开时失败”。*

```
try{
    orderRepository orderRepo = new orderRepository(); // get context (Mysql)

    var result = (from x in orderRepo.orders
          where x.orderid == orderno
          select new {x.tracking, x.status, x.charged }).SingleOrDefault();

    charged = result.charged;
}catch(Exception e){
    log.Error(e.Message); //    The underlying provider failed on Open.
} 
```

而且，我运行了之前失败的 1 个 Ajax 调用，然后它通过了。

它发生在 3 个（Ajax）进程中的 1 个，有时，5 个进程中的 2 个。

我猜是因为所有进程都尝试同时使用数据库。但我找不到解决方案。

这是我的连接字符串，

```
<add name="EFMysqlContext" connectionString="server=10.0.0.10;User Id=root;pwd=xxxx;Persist Security Info=True;database=shop_db" providerName="Mysql.Data.MySqlClient" /> 
```

任何人都知道解决方案或我可以尝试的东西，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T23:32:08.367

这听起来像是一个问题，因为使用相同的用户名与 SQL Server 并发连接。您是否尝试过在使用存储库（或连接）对象后销毁/处置它？试试看：

```
 try{
       using( orderRepository orderRepo = new orderRepository()) // get context (Mysql)
        {
          var result = (from x in orderRepo.orders
              where x.orderid == orderno
              select new {x.tracking, x.status, x.charged }).SingleOrDefault();

        charged = result.charged;
    } // orderRepo object automatically gets disposed here
catch(Exception e){
        log.Error(e.Message); //    The underlying provider failed on Open.
    } } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-06T18:35:03.990

不确定它是否重要，但您的提供商名称是否重要`Mysql.Data.MySqlClient`（`MySql.Data.MySqlClient`如果区分大小写，这可能是原因）。

# php - 如何根据命名路由创建 URL 字符串并保留参数

> ID：12484988
> 
> 赞同：1
> 
> 时间：2012-09-18T21:01:53.577
> 
> 标签：php, zend-framework, routes, urlhelper

我需要为类别切换创建 url，切换类别应将页面重置为第一个并更改猫名，但保留其余的 url 参数。

网址示例：

```
http://example.com/cat/fruits/page/3/q/testquery/s/date/t/kcal/mine/26/maxe/844/minb/9/mint/4/maxt/93/minw/7/minbl/6/maxbl/96 
```

网址可以包含许多不同的参数，但类别名称和页面应该始终放在第一位，没有页面的类别也应该工作并显示第一页。

目前我已经定义了两条路由，我正在使用 Zend 的 url 助手和命名路由，但它会重置参数，并且作为最终结果，我有 /cat/cat_name/page/1 url。

```
$category_url = $view->url(array('category'=>$list_item['url'],'page'=>1),'category',FALSE)

resources.router.routes.category_main.route = "/cat/:category/*"
resources.router.routes.category_main.defaults.module = "ilewazy"
resources.router.routes.category_main.defaults.controller = "index"
resources.router.routes.category_main.defaults.action = "results"
resources.router.routes.category_main.defaults.category = 
resources.router.routes.category_main.defaults.page = 1

resources.router.routes.category.route = "/cat/:category/page/:page/*"
resources.router.routes.category.defaults.module = "ilewazy"
resources.router.routes.category.defaults.controller = "index"
resources.router.routes.category.defaults.action = "results"
resources.router.routes.category.defaults.category = 
resources.router.routes.category.defaults.page = 1 
```

在这种情况下，我是否需要创建自定义方法来组装 url？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T07:26:24.447

我会尝试的事情：

1.  在 $urlOptions 中添加模块、控制器和操作参数（这是您传递给视图助手的第一个数组）
2.  而不是 'category' 路由名称尝试 null ，看看它对你有什么作用。
3.  尝试删除这一行“resources.router.routes.category.defaults.category =”

请说明您使用的是什么版本的 zf。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T00:27:27.503

解决方案非常简单，只需将所有当前请求参数传递给 url 助手（并且可选地覆盖/添加其中一些，在我的情况下为页面和类别），最后一个变量设置为 FALSE 以防止路由重置。

```
$view->url(
        array_merge(
                $params,
                array('category' => $list_item['url'],
                'page' => 1)
                ),
                'category_main', 
             FALSE
            ); 
```

# c# - 如何通过传入对象使用实体框架进行更新

> ID：12484996
> 
> 赞同：0
> 
> 时间：2012-09-18T21:02:49.187
> 
> 标签：c#, entity-framework, asp.net-mvc-4

如何使用实体框架进行更新？我正在传递具有更新值的对象，但我没有看到 Update 方法。

```
 public void UpdateRecipient(Domain.Entities.RecipientEntity recipient)
    {
        using (EfDbContext context = CreateEfDbContext(recipient.ApplicationId.ToString()))
        {

            context.Recipients. //?? I don't see an update method
            context.SaveChanges();

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:11:13.940

三个步骤：

1.  从上下文中获取要更新的项目
2.  从您传递更新方法的实体中复制更新的属性
3.  保存更改。

大致：

```
using (EfDbContext context = CreateEfDbContext(recipient.ApplicationId.ToString()))
{
    var toUpdate = context.Recipients.SingleOrDefault(r => r.Id == recipient.Id);
    if (toUpdate != null)
    {
        toUpdate.Field1 = recipient.Field1;
        // Map over any other field data here.

        context.SaveChanges();
    }
    else
    {
        // Handle this case however you see fit.  Log an error, throw an error, etc...
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T23:20:49.320

还有另一种更新对象的方法，而无需再次从数据库中重新获取它，从而节省了访问数据库的成本。附加的对象必须具有其主键的值。

1.  将更新的对象附加到上下文
2.  将其状态更改为“已修改”。
3.  `SaveChanges()`上下文的调用方法

喜欢：

```
 public void UpdateRecipient(Domain.Entities.RecipientEntity recipient)
    {
        using (EfDbContext context = CreateEfDbContext(recipient.ApplicationId.ToString()))
        {
            context.Attach(recipient);
            context.ObjectStateManager.ChangeObjectState(recipient,EntityState.Modified);
            context.SaveChanges();    
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T21:13:52.113

如果您正在更新记录，那么您将执行以下操作：

```
//Retrieve the entity to be updated
Entity row = context.Recipients.Single(a => a.Id == recipient.Id);

//Update a column
row.Name = recipient.Name;

//Save changes
context.SaveChanges(); 
```

如果您想同时更新/添加内容，那么您可以：

```
if(!context.Recipients.Any(a => Id == recipient.Id))
{
    context.Recipients.Add(recipient);
}
else
{
    Entity row = context.Recipients.Single(a => a.Id == recipient.Id);

    row.Name = recipient.Name;
}

context.SaveChanges(); 
```

# wpf - 验证 ComboBox 引用属性

> ID：12484997
> 
> 赞同：1
> 
> 时间：2012-09-18T21:02:50.847
> 
> 标签：wpf, entity-framework, validation, data-annotations, idataerrorinfo

我无法让 IDataErrorInfo 验证设置了 [Required] 属性（或 [ReferenceKey]）并且包含 null 作为初始值的引用属性。我正在使用 WPF + EF 4.1。验证是通过数据注释和 IDataErrorInfo 完成的。对于每个属性，一切正常，除了不能包含 null 的引用属性。此属性是此属性包含 null 作为默认值，我无法将其设置为任何其他值。

这实际上意味着 this[string propertyName] 永远不会为引用属性执行，因此 UI 不会捕获任何验证错误。我继承了 [Required] 属性只是为了查看此属性是否正在被验证，它返回它是无效的，因为它应该，但 IDataErrorInfo 完全不知道这一点。

UI 中的引用属性实现示例

```
<ComboBox DisplayMemberPath="Name"
          ItemsSource="{Binding UnitList}"
          SelectedValue="{Binding CurrentItem.UnitId, Mode=TwoWay, ValidatesOnExceptions=True, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"
          SelectedValuePath="Id" /> 
```

我能做些什么来克服这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T20:07:26.903

我发现的解决方法是使用 SelectedItem 而不是 SelectedValue。

# jquery - 访问fancybox外部的fancybox内的链接

> ID：12484999
> 
> 赞同：0
> 
> 时间：2012-09-18T21:03:06.573
> 
> 标签：jquery, html, fancybox

我有一个通过fancybox iframe 访问的页面设置。fancybox iframe 中的链接如何加载到 iframe 的父窗口中？所以如果用户点击链接，它会重新加载页面并加载点击的链接。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:08:24.597

使用 的`target`属性`<a>`。

例子：

```
<a href="yourLink.html" target="_top">Click me!</a> 
```

Target 可以接受五种值类型：

*   "_top" - 顶部文档窗口
*   "_parent" - 父窗口（类似于_top）
*   “_blank” - 新窗口/标签
*   “_self” - 相同的窗口/iframe
*   “ *framename* ” - 命名的 iframe/frame