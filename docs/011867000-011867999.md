# StackOverflow 问答 11867000-11867999

# ruby-on-rails - 类被缓存甚至 cache_class = false

> ID：11867004
> 
> 赞同：0
> 
> 时间：2012-08-08T14:42:25.240
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我将我的 development.rb 配置为不缓存类，但是为什么它仍然缓存并且当我进行更改（例如添加 binding.pry 和 puts，除非我再次 ctrl+c 和 rails s）时它没有更新。

我主要在 EditorHub::ArticlesController 类中进行开发，也许是因为命名空间？

知道为什么会这样吗？

```
rails s
=> Booting WEBrick
=> Rails 3.2.2 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server

#development.rb
CMS::Application.configure do
  config.cache_classes = false
end

#application.rb

config.autoload_paths += %W(#{config.root}/lib) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:20:41.477

有关您所做的确切更改的更多详细信息可能会有所帮助，但总的来说，对模型文件夹中的类所做的更改应在每次请求时重新加载，并且您的方法是正确的。并且对许多其他文件夹的更改位于您的加载路径中，因此它们也会被重新加载，但不是全部。您可以通过更改加载路径来解决此问题，但这可能比简单的 ctrl-c 和重新启动更有效。

我不认为这会起作用，但你可以把它放在类中而不是重新加载..

```
Rails.application.eager_load! 
```

问题是，你绝对可以让类在开发中重新加载。我通常认为这样做的努力是不值得的。

# c - 便携式仪器

> ID：11867008
> 
> 赞同：0
> 
> 时间：2012-08-08T14:42:31.350
> 
> 标签：c, instrumentation

`GCC`有一个关于检测的很好的特性，它可以让你在每次调用函数时调用例程，或者每次函数返回时。

现在，我想创建自己的系统以使其可移植到其他编译器，并允许工具化我想要的功能（参数数量可能会有所不同），所以我在两种情况下都考虑了两个宏。我正在考虑制作某种配置文件，它只能通过定义子句激活。

```
#define FUNCT(t,function_name,...)   \
    (t) function_name(...) { \
        (void) *func_pointer = &(function_name); \
        start_data(func_pointer, myclock());

#define RETURN(x) {stop_data(func_pointer, myclock()); return (x);}

FUNCT(BOOL, LMP, const int prof, const int nmo))
    if (nmo <= 5 ||
        prof > (prof_l / 3)) {
        .... do long operations....
        RETURN(FALSE);
    }
    ... do more....
    RETURN(TRUE);
} 
```

但我无法让它工作。有人可以帮我弄这个吗？或者这是一项难以完成的任务？

我想到的另一种选择是让函数在没有宏的情况下声明，如果无论如何都知道函数指针而不知道它的名称，就像在 VB 中当你和我一起调用 Form 时一样，它是一个通用别名。是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T14:59:18.427

用于`gcc -E`调试宏。使用您发布的代码：

```
$ gcc -E t.c
# ... skip stuff ....

(BOOL) LMP(...) { (void) *func_pointer = &(LMP);
                  start_data(func_pointer, myclock());)
    if (nmo <= 5 ||
        prof > (prof_l / 3)) {
        .... do long operations....
        {stop_data(func_pointer, myclock()); return (FALSE);};
    }
    ... do more....
    {stop_data(func_pointer, myclock()); return (TRUE);};
} 
```

（我添加了一些空格使其可读。）

您可以立即看到两个问题：函数参数没有像您想象的那样扩展，而且还有一个额外`)`的地方。

要获得扩展的可变参数，请使用`__VA_ARGS__`，而不是`...`。流浪`)`者在呼叫现场。

所以：

```
#define FUNCT(t,function_name,...)   \
    (t) function_name(__VA_ARGS__) { \
        (void) *func_pointer = &(function_name); \
        start_data(func_pointer, myclock());

#define RETURN(x) {stop_data(func_pointer, myclock()); return (x);}

FUNCT(BOOL, LMP, const int prof, const int nmo)
    if (nmo <= 5 ||
        prof > (prof_l / 3)) {
        .... do long operations....
        RETURN(FALSE);
    }
    ... do more....
    RETURN(TRUE);
} 
```

* * *

至于这是否值得尝试（C99 附带可变参数宏，并非所有编译器都实现该标准，并且支持可能因编译器而异），我不确定。使用每个编译器的本机分析工具可能会更好 - 你会得到更好的结果，希望更少的开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:17:51.660

在调用端而不是函数端检测函数要容易得多。宏可以与函数同名。在某处声明您的替换功能

```
double myfunc_wrapper(int someArg) {
  double ret = 0;
  // do something before
   ...
  // now call it
  ret = (myfunc)(someArg);

  // Then do something after
  ....
  return ret;
} 
```

只是为了确保将`()`调用本身放在周围，以确保始终调用函数而不是宏。

然后用宏“重载”你的函数

```
#define myfunc(...) mfunc_wrapper(__VA_ARGS__) 
```

有了这个想法，您可以在您感兴趣的编译单元中动态替换您的函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:11:37.290

除了 Mat 之外，使用还有一个人体工程学问题`#define RETURN(x) {...}`：

```
if (test)
  RETURN (TRUE);
else
  RETURN (FALSE); 
```

将评估为

```
if (test)
  {...}
;           // <syntactical error
else
  {...}
; 
```

# node.js - 如何监视未导出的属性

> ID：11867009
> 
> 赞同：4
> 
> 时间：2012-08-08T14:42:34.037
> 
> 标签：node.js, jasmine, stubbing, spy

我有一个这样的模块“sitecollection”：

```
var site = require('./site');    // <- this should be stubbed

var sitesCollection = function(spec) {

  var that = {};

  that.sites = {};

  that.findOrCreateById = function(id) {
    if (typeof(that.sites[id]) == "undefined") {
      that.sites[id] = site({id: id});            // <- its used here
    }
    return that.sites[id];
  };

  return that;
};

module.exports = sitesCollection; 
```

所以在sitescollection 中，site 是一个不被导出的模块。但在代码内部，我使用它。现在我正在为#findOrCreateById() 编写茉莉花规格。

我想指定我的 findOrCreateBy() 函数。但我想存根 site() 函数，因为规范应该独立于实现。我必须在哪里创建 spyed 方法？

```
var sitescollection = require('../../lib/sitescollection');

describe("#findOrCreateById", function() {
  it("should return the site", function() {
    var sites = sitescollection();
    mysite = { id: "bla" };
    // Here i want to stub the site() method inside the sitescollection module.
    // spyOn(???,"site").andRetur(mysite);
    expect(sites.findOrCreateById(mysite.id)).toEqual(mysite);
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-01-23T15:27:51.270

您可以使用 https://github.com/thlorenz/proxyquire 实现此目的

```
var proxyquire = require('proxyquire');

describe("#findOrCreateById", function() {
    it("should return the site", function() {

        // the path '../../lib/sitescollection' is relative to this test file
        var sitesCollection = proxyquire('../../lib/sitescollection', {
            // the path './site' is relative to sitescollection, it basically
            // should be an exact match for the path passed to require in the
            // file you want to test
            './site': function() {
                console.log('fake version of "./site" is called');
            }
        });

        // now call your sitesCollection, which is using your fake './site'
        var sites = sitesCollection();
        var mysite = {
            id: "bla"
        };

        expect(sites.findOrCreateById(mysite.id)).toEqual(mysite);
    });
}); 
```

# php - 如何将文件缓存到子文件夹中以减少缓存文件夹中的 inode 数量？

> ID：11867011
> 
> 赞同：0
> 
> 时间：2012-08-08T14:42:38.280
> 
> 标签：php, caching

我的网站正在正确缓存指定文件夹中的所有文件，但是这些文件夹中存储的文件太多。我正在考虑将缓存文件夹拆分为包含文件名第一个字母的子目录，然后可能从那里进一步分解。

如下所示，压缩版本保存在“gz”文件夹中，常规缓存存储在“html2”文件夹中。

代码：

```
if ( $cache ) {
#header("Content-Type: text/html");
// get the buffer
$buffer = ob_get_contents();
#$length = ob_get_length();
#header('Content-Length: '.$length);
// end output buffering, the buffer content
// is sent to the client
ob_end_flush();

// now we create the cache file
if (!file_exists($pathName)) {
    mkdir($pathName, 0755, true);
}
if (!file_exists(str_replace('/html/html2/', '/html/gz/', $pathName))) {
    mkdir(str_replace('/html/html2/', '/html/gz/', $pathName), 0755, true);
}
$compressed = preg_replace('%<!--(.|\s)*?-->%', '', $buffer);
$compressed = sanitize_output($compressed);
$encoded = gzencode($compressed, 9);
file_put_contents($file, $compressed);
file_put_contents(str_replace('/html/html2/', '/html/gz/', str_replace('.html', '.gz', $file)), $encoded);

} 
```

根据上面的代码，这里是当前缓存文件的路径：

```
/html2/New-York-Hotels.html

/gz/New-York-Hotels.gz 
```

理想情况下，我希望缓存的文件位置如下所示：

```
/html2/N/New-York-Hotels.html

/gz/N/New-York-Hotels.gz 
```

非常感谢您的帮助！提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:14:25.847

试试这个代码（**固定**）：

```
if ($cache) {

  // Get the buffer into a string
  // I do it this way to save memory - no point in keeping 2 copies of the data
  $buffer = ob_get_clean();

  // Send buffer content to the client
  // header("Content-Type: text/html");
  // header('Content-Length: '.strlen($buffer));
  echo $buffer;
  flush();

  // Get the paths into sensibly named variables
  $fileBase = basename($file); // The name of the HTML file
  $htmlPath = rtrim($pathName, '/').'/'.strtoupper($fileBase[0]).'/'; // The directory the HTML file is stored in
  $gzPath = str_replace('/html/html2/', '/html/gz/', $htmlPath); // The directory the gzipped file is stored in
  $htmlFile = $htmlPath.$fileBase; // The full path of the HTML file
  $gzFile = $gzPath.str_replace('.html', '.gz', $fileBase); // The full path of the gzipped file

  // Make sure the paths exist
  if (!is_dir($htmlPath)) {
    mkdir($htmlPath, 0755, true);
  }
  if (!is_dir($gzPath)) {
    mkdir($gzPath, 0755, true);
  }

  // Strip comments out of the file and sanitize_output() (whatever than does)
  // $compressed is a silly name for a variable when we are also zipping the data
  $html = sanitize_output(preg_replace('%<!--(.|\s)*?-->%', '', $buffer));

  // Save the files
  file_put_contents($htmlFile, $html);
  file_put_contents($gzFile, gzencode($html, 9));

} 
```

这里应该处理几个未经检查的潜在错误，例如如果`mkdir()`失败会发生什么，如果`file_put_contents()`失败会发生什么？

# iphone - 左右两侧有阴影

> ID：11867012
> 
> 赞同：3
> 
> 时间：2012-08-08T14:42:39.633
> 
> 标签：iphone, calayer, shadow

我正在向 a 添加一个阴影，`CALayer`但我希望这个阴影仅位于视图的左侧和右侧。有谁知道这是否可能？

目前，我正在添加这样的阴影：

```
view.layer.shadowColor = [UIColor blackColor].CGColor;
view.layer.shadowOffset = CGSizeMake(0.0f, 0.0f);
view.layer.shadowOpacity = 1.0f;
view.layer.shadowRadius = 4.0f;
view.layer.shadowPath = [UIBezierPath bezierPathWithRect:view.bounds].CGPath; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:37:52.700

您将阴影路径设置为视图的边界。尝试获取该矩形，并使用`CGRectInset`（负 x 值和 0 y 值）扩展它。这将为您提供一个超出图层左侧和右侧的阴影路径。您可能需要修改半径或稍微插入 y 值以防止阴影出现在上方和下方。

# mathematical-optimization - 旅行推销员 (TSP) 跳过城市

> ID：11867014
> 
> 赞同：-1
> 
> 时间：2012-08-08T14:42:42.550
> 
> 标签：mathematical-optimization

我想解决一个类似于旅行推销员问题的问题，但在这种情况下，如果访问城市的成本太高，销售人员可以跳过城市。

请给我一些关于如何解决这个问题的指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T07:35:14.037

一种方法是复制/粘贴这个[Drools Planner](http://docs.jboss.org/drools/release/5.4.0.Final/drools-planner-docs/html_single/index.html)的[车辆路线示例](https://github.com/droolsjbpm/drools-planner/blob/master/drools-planner-examples/src/main/resources/org/drools/planner/examples/vehiclerouting/solver/vehicleRoutingScoreRules.drl)并像这样破解它：

有 2 辆车：1 辆真实车辆（= 游览）和 1 辆未使用的车辆（= 未使用的城市）。客户 == 城市。删除容量规则。

然后，更改评分规则，使其仅对已使用车辆（而不是未使用车辆）的城市（= 客户）的距离求和：

```
rule "distanceToPreviousAppearance"
    when
        $customer : VrpCustomer(previousAppearance != null, $distanceToPreviousAppearance : distanceToPreviousAppearance, vehicleIsUsed == true)
    then
        insertLogical(new IntConstraintOccurrence("distanceToPreviousAppearance", ConstraintType.NEGATIVE_SOFT,
                $distanceToPreviousAppearance,
                $customer));
end

rule "distanceFromLastCustomerToDepot"
    when
        $customer : VrpCustomer(previousAppearance != null, vehicleIsUsed == true)
        not VrpCustomer(previousAppearance == $customer)
    then
        VrpVehicle vehicle = $customer.getVehicle();
        insertLogical(new IntConstraintOccurrence("distanceFromLastCustomerToDepot", ConstraintType.NEGATIVE_SOFT,
                $customer.getDistanceTo(vehicle),
                $customer));
end 
```

同样，您可以添加一条规则，将二手车访问过的每个城市的访问奖励相加，并尝试使用 ConstraintType.POSITIVE_SOFT（加权与行驶距离）将其最大化。

当然，你不应该像这样破解它：这只是要点。相反，请根据您的要求重命名和重新设计它。

# qt - 如何将 QPushButton 链接到 QTabWidget 的选项卡？

> ID：11867016
> 
> 赞同：1
> 
> 时间：2012-08-08T14:42:57.717
> 
> 标签：qt, qt4, qtabwidget

我正在使用 Qt 做一个 GUI 程序，所以我的问题是，我在我的 GUI 程序中创建了一个主页，并且我有一些 4 个选项卡 tab1、tab2、tab3、tab4，并且我在主页上创建了 QPushbutton。所以谁能告诉我如何将 QPushButton 链接到 QTabWidget 的 tab3 以便当我单击按钮时它应该带我到选项卡 3。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T14:51:55.343

首先创建一个插槽，处理按钮单击事件（[Slots](http://doc.qt.nokia.com/4.7-snapshot/signalsandslots.html)，[QPushButton](http://doc.qt.nokia.com/4.7-snapshot/qpushbutton.html)）然后使用 QTabWidgets [setCurrentIndex](http://doc.qt.nokia.com/4.7-snapshot/qtabwidget.html#currentIndex-prop)函数，如`yourTabWidget->setCurrentIndex(2);`

# wpf - 如何使用 XAML 移动图像？

> ID：11867017
> 
> 赞同：0
> 
> 时间：2012-08-08T14:42:58.713
> 
> 标签：wpf, image, xaml, move

我想在 WPF 中移动一个 Image 控件（实际上，Image 会从左到右再到左再到右，循环重复此操作。），我想使用 XAML 来控制它。另外，我希望图像控件在点击`MouseEnter`事件时移动。下面是我的图片`Grid`：

```
<Window
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d" x:Class="TimeZoneDaemonApp.Window1"
Title="TimeZone Browser (CodeBy:CS48516)"  Icon="/TimeZoneDaemonApp;component/Images/Settings.png" Background="{x:Null}" WindowStartupLocation="Manual" Width="704" Height="170" Opacity="1" WindowStyle="None" AllowsTransparency="True">

<Grid PreviewMouseLeftButtonDown="Grid_PreviewMouseLeftButtonDown" PreviewMouseRightButtonDown="Grid_PreviewMouseRightButtonDown" >
    <Grid.Resources>
        <Style TargetType="{x:Type Border}">
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="Black"/>
        </Style>
    </Grid.Resources>
    <Border  OpacityMask="White" Height="100" >
        <Border.Background>
            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                <GradientStop Color="Black" Offset=".6"/>
                <GradientStop Color="Green" Offset=".9"/>
            </LinearGradientBrush>
        </Border.Background>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="30"/>
                <RowDefinition Height="30"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <Border Grid.Column="0"><TextBlock FontFamily="@微软雅黑" Padding="0,5,0,0" FontSize="12pt" Foreground="Black" FontWeight="bold" Background="#FFF87800"  TextAlignment="Center"><Run Text="Hong Kong"/></TextBlock></Border>
            <Border Grid.Column="1"><TextBlock Background="#FFB0D428" Padding="0,5,0,0" FontFamily="@微软雅黑" FontSize="16" FontWeight="Bold" Foreground="Black"    Text="New York" TextAlignment="Center"/></Border>
            <Border Grid.Column="2"><TextBlock Background="#FF2283E4" Padding="0,5,0,0" FontFamily="@微软雅黑" FontSize="16" FontWeight="Bold" Foreground="Black"    Text="London" TextAlignment="Center"/></Border>
            <Border Grid.Column="3"><TextBlock Background="#FF20D4D0" Padding="0,5,0,0" FontFamily="@微软雅黑" FontSize="16" FontWeight="Bold" Foreground="Black"    Text="Pairs" TextAlignment="Center"/></Border>
            <Border Grid.Column="4"><TextBlock Background="#FF28D428" Padding="0,5,0,0" FontFamily="@微软雅黑" FontSize="16" FontWeight="Bold" Foreground="Black"    Text="Sydney" TextAlignment="Center"/></Border>
            <Border Grid.Column="5"><TextBlock Background="#FFD040F8" Padding="0,5,0,0" FontFamily="@微软雅黑" FontSize="16" FontWeight="Bold" Foreground="Black"    Text="Brasilia" TextAlignment="Center"/></Border>
            <Border Grid.Column="0" Grid.Row="1"><TextBlock x:Name="HK" Padding="0,5,0,0" Background="#FFA04C00" FontFamily="@微软雅黑" FontSize="12" Foreground="White"   TextAlignment="Center" TextWrapping="NoWrap" TextTrimming="None"><Run Text="Hong Kong"/></TextBlock></Border>
            <Border Grid.Column="1" Grid.Row="1"><TextBlock x:Name="NY" Padding="0,5,0,0" Background="#FF708418" FontFamily="@微软雅黑" FontSize="12" Foreground="White"   TextAlignment="Center" TextWrapping="NoWrap" TextTrimming="None"><Run Text="Hong Kong"/></TextBlock></Border>
            <Border Grid.Column="2" Grid.Row="1"><TextBlock x:Name="UK" Padding="0,5,0,0" Background="#FF184880" FontFamily="@微软雅黑" FontSize="12" Foreground="White"   TextAlignment="Center" TextWrapping="NoWrap" TextTrimming="None"><Run Text="Hong Kong"/></TextBlock></Border>
            <Border Grid.Column="3" Grid.Row="1"><TextBlock x:Name="PS" Padding="0,5,0,0" Background="#FF188480" FontFamily="@微软雅黑" FontSize="12" Foreground="White"   TextAlignment="Center" TextWrapping="NoWrap" TextTrimming="None"><Run Text="Hong Kong"/></TextBlock></Border>
            <Border Grid.Column="4" Grid.Row="1"><TextBlock x:Name="SD" Padding="0,5,0,0" Background="#FF188418" FontFamily="@微软雅黑" FontSize="12" Foreground="White"   TextAlignment="Center" TextWrapping="NoWrap" TextTrimming="None"><Run Text="Hong Kong"/></TextBlock></Border>
            <Border Grid.Column="5" Grid.Row="1"><TextBlock x:Name="BR" Padding="0,5,0,0" Background="#FF7800A8" FontFamily="@微软雅黑" FontSize="12" Foreground="White"   TextAlignment="Center" TextWrapping="NoWrap" TextTrimming="None"><Run Text="Hong Kong"/></TextBlock></Border>

            <Border Grid.Column="0" Grid.Row="2"><TextBlock x:Name="HKT" Padding="0,5,0,0" FontFamily="@Gill Sans MT" FontSize="21pt" Foreground="White"   TextAlignment="Center" FontWeight="Bold"><Run Text="Load"/></TextBlock></Border>
            <Border Grid.Column="1" Grid.Row="2"><TextBlock x:Name="NYT" Padding="0,5,0,0" FontFamily="@Gill Sans MT" FontSize="21pt" Foreground="White"   TextAlignment="Center" FontWeight="Bold"><Run Text="Load"/></TextBlock></Border>
            <Border Grid.Column="2" Grid.Row="2"><TextBlock x:Name="UKT" Padding="0,5,0,0" FontFamily="@Gill Sans MT" FontSize="21pt" Foreground="White"   TextAlignment="Center" FontWeight="Bold"><Run Text="Load"/></TextBlock></Border>
            <Border Grid.Column="3" Grid.Row="2"><TextBlock x:Name="PST" Padding="0,5,0,0" FontFamily="@Gill Sans MT" FontSize="21pt" Foreground="White"   TextAlignment="Center" FontWeight="Bold"><Run Text="Load"/></TextBlock></Border>
            <Border Grid.Column="4" Grid.Row="2"><TextBlock x:Name="SDT" Padding="0,5,0,0" FontFamily="@Gill Sans MT" FontSize="21pt" Foreground="White"   TextAlignment="Center" FontWeight="Bold"><Run Text="Load"/></TextBlock></Border>
            <Border Grid.Column="5" Grid.Row="2"><TextBlock x:Name="BRT" Padding="0,5,0,0" FontFamily="@Gill Sans MT" FontSize="21pt" Foreground="White"   TextAlignment="Center" TextDecorations="None" FontWeight="Bold" Background="Transparent"><Run Text="Load"/></TextBlock></Border>
        </Grid>
    </Border>
    <Image HorizontalAlignment="Left" Height="50" Margin="0,0,0,0"  Source="Images/cloud.png" Stretch="Fill" VerticalAlignment="Top" Width="190">
    </Image>
</Grid> 
```

我是 WPF 的新手，有人可以帮忙吗？谢谢。其实我在 SOF 中找到了一个章节：[WPF。以编程方式将图像移动到 (X,Y) 的最简单方法？](https://stackoverflow.com/questions/4214155/wpf-easiest-way-to-move-image-to-x-y-programmatically)

好吧，那不是我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T01:25:00.933

下面列出了我的答案：我们需要一个 Canvas 来包含图像，我们可以使用 Canvas 的“Left”属性来移动图像。

```
<Canvas x:Name="MyCanvas">
        <Canvas.Triggers>
            <EventTrigger RoutedEvent="FrameworkElement.Loaded">
                <BeginStoryboard >
                    <Storyboard Storyboard.TargetName="img1" Storyboard.TargetProperty="(Canvas.Left)">
                        <DoubleAnimation From="0" To="514" Duration="0:0:20" AccelerationRatio=".2" DecelerationRatio=".8" RepeatBehavior="23:59:59" AutoReverse="True"/>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Canvas.Triggers> 
```

# php - Google Drive SDK（PHP 客户端库）- 上传文件但在 Google Drive UI 上不可读

> ID：11867021
> 
> 赞同：1
> 
> 时间：2012-08-08T14:43:08.483
> 
> 标签：php, google-docs, google-docs-api, google-drive-api

这是我上传文件的代码：

```
private function addFile(File $file, $folderProject, User $user) {

    $fileToUpload = new Google_DriveFile();
    $fileToUpload->setTitle($file->getName());

    //set mime type
    $fileToUpload->setMimeType($file->getMimeType());

    //build parent and set id
    $parent = new Google_ParentReference();
    $parent->setId($folderProject->getId());

    //set parent to file
    $fileToUpload->setParents(array($parent));

    $data = file_get_contents($file->getPath());

    $createdFile = $this->service->files->insert($fileToUpload, array(
            'data' => $data,
            'mimeType' => $file->getMimeType(),
    ));

} 
```

* * *

例如，当我使用此 PHP 代码上传 docx 时，该文件附加在 Google Drive 网站上不可读（它显示了 docx 的 XML 结构），并且它在我的 Google Drive 文件夹中显示如下：

![不可读](../Images/9f67196bd98979118c8cd36cb5990281.png)

当我尝试直接通过 Google Drive UI 上传 docx 时，它会显示如下（我想要的）： ![可读](../Images/67f9e9a81dca7063f1fe321f03ef1427.png)

> 我很确定问题出在 Google Drive UI 尝试以不同的方式打开文件的事实，因为我通过我的应用程序上传了它，但我不希望这样 :)

（我对其他类型的文件也有同样的问题）

* * *

我尝试`'convert' = true`在数组中设置参数，但在上传过程中出现此错误：

> ..convert=true&uploadType=multipart&key=AI39si49a86oqv9fhb9yzXp7FCWL-cSqwFiClHZ‌​qS3Y3r9Hw8ujtSNlZEWZyFKBp_id7LUyFaZTJ97pMeb0XqHznycK7JJ9o_Q: (500) 内部错误

文档：[https ://developers.google.com/drive/v2/reference/files/insert](https://developers.google.com/drive/v2/reference/files/insert)

=> 但无论如何我不认为转换是正确的解决方案，我只想能够看到内容，就好像我通过 Google Drive UI 上传文件一样

* * *

如果我从我的 Google Drive Sync 文件夹中打开 docx 并编辑并保存它，我将能够通过 Google Drive UI 看到它（显示为 W 标志）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T09:42:52.930

我也遇到同样的问题。

但不同的是，我正在上传 pdf 并能够在 google drive UI 中查看 pdf。

添加新pdf后，我需要通过api代码将其自动转换为google doc格式。

如果我更改 $mimeType = 'application/vnd.google-apps.document'; 然后得到以下错误
[https://www.googleapis.com/upload/drive/v2/files?convert=true&uploadType=multipart](https://www.googleapis.com/upload/drive/v2/files?convert=true&uploadType=multipart) : (400) Bad Request

如果我添加可选参数

```
$createdFile = $service->files->insert($file, array(
  'data' => $data,
  'mimeType' => $mimeType,
'convert' => TRUE
)); 
```

然后没有变化，只有pdf上传没有转换。

你有什么建议吗，我需要在哪里准确添加转换参数？

# java - GWT SplitLayout 中南组件的位置

> ID：11867023
> 
> 赞同：0
> 
> 时间：2012-08-08T14:43:12.317
> 
> 标签：java, gwt, widget, splitpanel

我想在`SplitLayout`. [GWT 展示](http://gwt.google.com/samples/Showcase/Showcase.html#!CwSplitLayoutPanel)展示了您可以将两个南面板添加到小`SplitLayout`部件，并且布局会将它们按顺序放置。

我的问题是我只想放入一个南面板，`SplitLayout`但我想将它定位到内南面板的位置。我怎样才能做到这一点？

![在此处输入图像描述](../Images/a1d1159dc10bdbda1d2d5466a1918a25.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:45:35.327

我找到了解决我的问题的方法：

我用了两个`SplitLayout`。外面的有一个西面板和一个中心面板。该中心包含内部`SplitLayout`，其中包含所需的南面板和中心面板。这样我就可以得到我想要的；尽管此解决方案会产生更复杂的 html。

# c# - 实施此业务规则的最佳地点？

> ID：11867028
> 
> 赞同：2
> 
> 时间：2012-08-08T14:43:26.950
> 
> 标签：c#, design-patterns

我有一个服务调用返回给我一个 CustomObject 的 IEnumerable，这是一个第三方调用，我无权修改。可以假设 CustomObject 具有如下定义：

```
public class CustomObject
{
    public int Id { get; set; }
    public string Name { get; set; }

    ...
    ...
    ...

    public int Points { get; set; }
    public bool IsPrivate { get; set; }
} 
```

在返回的对象列表中，我可能有特殊的 CustomObject 对象。我需要实施一些特殊的规则，例如：

1.  如果列表中同时存在 ID 为 1 和 3 的元素，则仅根据规则 a 渲染其中一个。如果其中任何一个的 IsPrivate 标记为 true，则显示将 IsPrivate 设置为 false b 的那个。如果两者都没有 IsPrivate 设置为 true，则显示具有较高点的那个......等等

实施这些规则的最佳地点是什么？我考虑过实现一个 IEqualityComparer 并在我的服务调用中执行一个 .Distinct() ，这似乎不是 IEqualityComparer 的本意。

建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:52:03.800

由于您无法修改“CustomObject”类，因此我会将业务逻辑添加到“渲染”管道中，并且只需调用一些函数，例如下面您有适用的特定业务规则的地方。然后只需从要渲染的对象列表中删除 id1 和 id3 并仅渲染从以下函数返回的对象。

```
CustomObject BizRule3293(IEnumerable<CustomObject> objects)
{
    CustomObject id1 = objects.SingleOrDefault(t => t.Id == 1);
    CustomObject id3 = objects.SingleOrDefault(t => t.Id == 3);
    if (id1 != null && id3 !=null)
    {
        if (!id1.IsPrivate && !id3.IsPrivate)
            return id1.Points > id3.Points ? id1 : id3;

        return id1.IsPrivate ? id3 : id1;
        // No logic stated if both are private
    }

    return id1 ?? id3;
} 
```

# c# - C#中base()的用法

> ID：11867031
> 
> 赞同：14
> 
> 时间：2012-08-08T14:43:40.543
> 
> 标签：c#, constructor

我一直在学习 C#，并想查看一些开源项目以查看一些好的编写代码。我在 sourceforge 上找到了一个名为 Todomoo 的项目，其中有一部分让我感到困惑：

```
public class Category {

    // Note properties
    private int id = 0;
    private string name = "";
    private Color colour = Color.Gray;

    /// <summary>
    /// Create a new category.
    /// </summary>
    public Category() { }

    /// <summary>
    /// Load a category from the database.
    /// </summary>
    /// <param name="Id">ID of the category</param>
    public Category(int id) : base() {
        Load(id);
    } 
```

在这里，它`base()`在其中一个构造函数中使用，但该类不是派生类。那究竟是为了什么？

为什么是这样的语法`base()`而不是这样：

```
 public Category(int id) {
        base();
        Load(id);
    } 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-08T14:46:34.550

> 但该类不是派生类

该类是派生类 - 它隐式继承自`System.Object`. 不过，尚不清楚为什么有人会`base()`为 调用构造函数`System.Object`：它也是隐式完成的。

就语法而言，我的猜测是 C# 采用了一种接近 C++ 初始值设定项列表的语法，而不是 Java 对基本构造函数的调用。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-08T14:45:45.050

C# 中的每个类都是从**System.Object** [Reference of Object in C#派生的类](http://msdn.microsoft.com/en-us/library/system.object.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-08T14:50:06.520

要回答第一个问题，所有用户定义的类都至少继承自一个其他类（对象）。这意味着将默认构造函数定义为父构造函数几乎总是有效的（不仅当对象更直接地从其他没有可见默认构造函数的东西继承时）。但是，在这种情况下，它是多余的。如果基类的默认构造函数存在并且可以从子类访问，则将调用它，而无需您这么说。

其次，与方法覆盖不同，选择是否以及在何处扩展基类构造函数的功能不是一种选择。*必须*调用基类的构造函数来初始化父级中的数据成员（您可能在子级中访问也可能无法访问），这*必须*在调用子级构造函数之前发生（如果子级需要任何父级结构存在）。因此，它们不允许您在任何地方调用基类构造函数，而是强制您定义在使用此特定子构造函数时要调用的基类构造函数，并且运行时将处理何时何地。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-08T14:47:36.343

您不能在构造函数代码中的某处调用构造函数，因为语言对此进行了限制。就中间语言而言，构造函数只是另一个方法调用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-08T14:52:46.840

正如其他人指出的那样，所有类都派生自`System.Object`.

在您的具体示例中，`base()`调用`System.Object`. 这实际上没有任何意义，因为基类的默认构造函数总是被调用，即使`base()`没有指定。

例如下面的代码

```
public class Foo
{
    public Foo()
    {
        Console.WriteLine("Foo");
    }
}

public class Foo2 : Foo
{
    public Foo2()
    {
        Console.WriteLine("Foo2");
    }
}

public class Program
{
    private static void Main(string[] args)
    {
        Foo2 d = new Foo2();

        Console.ReadKey();
    }
} 
```

印刷

> 富
> 
> Foo2

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-08T14:47:28.433

它是一个外部构造函数，它在 Category 构造函数之前构造它，当你这样做`base();`时不会发生任何事情，因为它是一个构造函数并返回一些东西，并`this = new base()`会导致错误

# c# - 如何使用 Visual Studio 顺利更改重命名项目文件和类文件？

> ID：11867033
> 
> 赞同：6
> 
> 时间：2012-08-08T14:43:41.120
> 
> 标签：c#, visual-studio-2010, refactoring, resharper, rename

我终于完成了我的 ASP.NET Web 应用程序，我的解决方案包含三个项目：Web 应用程序本身、WCF 和 Classlibrary。但我想重构它以更改类名、项目名等。我怎样才能以一种流畅的方式做到这一点，这样一切都不会被搞砸，比如命名空间等。我也有 Resharper，但我是新手.

当我重命名我的项目文件和 .csproj 等时，我仍然遇到命名空间问题，新命名空间不起作用，它要求使用旧命名空间。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T14:47:12.427

右键单击类/对象名称（在文件内）> 重构 > 重命名。

它会询问您是否也想预览，以便您知道哪些会发生变化，哪些不会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:16:19.117

据我所知，没有简化的方法来完成您所要求的一切。正如 jbkkd 所提到的，重命名类很容易，但您将面临以下挑战：

*   类文件名 - 从源文件重命名类不会重命名 *.cs 文件名以匹配（如果文件已打开以进行编辑并且您从解决方案资源管理器重命名，它应该要求您重命名该类）
*   您可以从解决方案资源管理器重命名项目名称，但这不会自动重命名代码中的命名空间或解决方案中的物理文件夹名称（包含项目文件的位置）
*   根据 ASP.NET 应用程序的类型，可能会有自动生成的文件和/或代码隐藏文件，它们的类和/或命名空间名称可能没有更改；例如，如果您更改 Global.asax.cs 文件中的类名或命名空间，您还必须在 Global.asax 文件中进行更改，因为它不会自动完成

ReSharper 将帮助重命名类和命名空间等，但您仍然需要手动清理内容，并且取决于您的解决方案有多大，它本身可能是一个项目。

# php - 使用数组时在电子邮件中显示来自 $_POST 的变量

> ID：11867041
> 
> 赞同：0
> 
> 时间：2012-08-08T14:44:01.697
> 
> 标签：php, mailer

我正在尝试获取使用复选框进行多项选择的表单的结果。正如在其他几个问题上所讨论的那样，我使用了一个数组，但是当我通过电子邮件发送变量结果时，它只会给我最后选择的结果。我确定我有错误的代码来显示变量。

**代码视图：**

```
$assembly = $_POST['assembly'];
$pump = $_POST['pump'];
$exchanger = $_POST['exchanger'];
**if(!empty($_POST['options'])) {
foreach($_POST['options'] as $options) {
        echo $options; 
}
}**

$name = $_POST['name'];
$email = $_POST['email'];
$info = $_POST['info'];

$body = <<<EOD
<br><hr><br>
Assembly: $assembly <br>
Pump: $pump <br>
Heat Exchanger: $exchanger <br>
**Unit Options: $options <br>**
Email: $email <br>
Name: $name <br>
Info: $info <br> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:18:47.963

我建议使用`implode`. 为你节省了几行代码，而且不像foreach那么紧张：

```
$options = implode(", ", $_POST['options']);
Unit Options: $options <br> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T14:50:16.203

试试这个代替你的代码。

```
$assembly = $_POST['assembly'];
$pump = $_POST['pump'];
$exchanger = $_POST['exchanger'];

$opt = "";
if(!empty($_POST['options'])) {
    foreach($_POST['options'] as $options) {
        $opt .= $options.",";
    }
    $opt = rtrim($opt, ","); //comma-separated checkbox values
}

$name = $_POST['name'];
$email = $_POST['email'];
$info = $_POST['info'];

$body = <<<EOD
<br><hr><br>
Assembly: $assembly <br>
Pump: $pump <br>
Heat Exchanger: $exchanger <br>
Unit Options: $opt <br>
Email: $email <br>
Name: $name <br>
Info: $info <br> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T14:55:04.437

您可以使用

```
$option=''; 

   if(!empty($_POST['options'])) {
            $option = implode(',', $_POST['options']);
    } 
```

尝试这个

```
$assembly = $_POST['assembly'];
$pump = $_POST['pump'];
$exchanger = $_POST['exchanger'];
$option = "";
if(!empty($_POST['options'])) {
    $option = implode(',', $_POST['options']);
}
$name = $_POST['name'];
$email = $_POST['email'];
$info = $_POST['info'];

$body = <<<EOD
<br><hr><br>
Assembly: $assembly <br>
Pump: $pump <br>
Heat Exchanger: $exchanger <br>
Unit Options: $option <br>
Email: $email <br>
Name: $name <br>
Info: $info <br> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T14:47:59.650

```
**if(!empty($_POST['options'])) {
foreach($_POST['options'] as $options) {
        echo $options; 
}
}** 
```

您实际上并没有在`$options`这里分配任何东西，只是将其打印出来。您将看到电子邮件中显示的最后一个选项，因为您在循环中设置的变量保留了它的值。

尝试：

```
$myOptions = "";

if(!empty($_POST['options'])) {
    foreach($_POST['options'] as $options) {
        $myOptions .= $options; 
    }
} 
```

接着：

```
Unit Options: $myOptions <br> 
```

# mysql - wso2 管理器 - com.mysql.jdbc.Driver 未找到

> ID：11867043
> 
> 赞同：4
> 
> 时间：2012-08-08T14:44:11.990
> 
> 标签：mysql, wso2, wso2stratos

我已经下载了 WSO2 Stratos 1.5.2 平台。我正在尝试启动 wso2stratos-manager-1.5.2，但它没有找到 mysql jdbc 驱动程序

> [2012-08-08 16:31:15,201] 错误 {org.wso2.carbon.user.core.util.DatabaseUtil} - 数据库错误 - 无法加载 JDBC 驱动程序类 'com.mysql.jdbc.Driver' org.apache。 commons.dbcp.SQLNestedException：无法加载 JDBC 驱动程序类“com.mysql.jdbc.Driver”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-09T01:37:53.403

我相信您正在尝试使用 mysql 数据库作为用户管理存储库的后端数据库。你把 MySQL JDBC 驱动放到 MANAGER_HOME/repository/components/lib 目录了吗？

问候， 普拉巴斯

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-09T05:44:40.837

由于许可证问题，我们不随包一起提供 mysql-connector jar。因此，您需要将 jar 复制到 repository/components/lib 文件夹，如 Prabath 的回复中所述。

问候，阿米拉。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-18T16:53:30.157

正如其他人所提到的，但添加了具体的细节。

在许多 WSO2 产品中配置数据源驱动程序时，您需要指定要使用的 JDBC 驱动程序的类名。

确保将与数据库引擎相关的 JDBC 驱动程序复制到 /repository/components/lib/ 目录。

例如，如果您使用的是 MySQL，请将 com.mysql.jdbc.Driver 指定为驱动程序并将 mysql-connector-java-5.XX-bin.jar 文件复制到此目录。

如果在创建数据源的时候没有将驱动复制到这个目录下，会出现类似Cannot load JDBC driver class com.mysql.jdbc.Driver的异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-22T13:35:14.330

驱动程序名称为“ **com.mysql.jdbc.Driver** ”。JAR 文件 (mysql-connector-java-x.xx.xx.jar) 必须存在于 MANAGER_HOME/repository/components/lib 中

# java - 单击微调器项目并调用第二个微调器列表项的 asynctask

> ID：11867044
> 
> 赞同：0
> 
> 时间：2012-08-08T14:44:11.643
> 
> 标签：java, android

我正在开发一个应用程序，我需要从一个中填充微调器，`webservice`并且还存在第二个微调器，它们在选择第一个微调器项目后填充。第二（微调器 B）取决于微调器 A。我得到了 A 的列表，但 b 微调器有问题。

我的基本要求是当我选择微调器“A”的项目时，它将加载微调器“b”的所有项目 **这里是代码::**

```
package com.CaribPay;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.Toast;

import com.Setting.CustomParser;

public class Register2 extends Activity implements OnItemClickListener {
    private Button BtnReg2Next;
    private EditText EdtxReg2Streetadd1,
                     EdtxReg2Streetadd2,
                     EdtxReg2City,
                     EdtxReg2Zipcode;

    private Spinner 
                    SpnrReg2Contry,
                    SpnrReg2Agent,
                    SpnrReg2State,
                    SpnrReg2PrimaryCurr,
                    SpnrReg2SecondaryCurr;

    private CustomParser cstParsr = new CustomParser();

    private String[] Regstrationstep1;
    private String[] strCountry,strProvince;
    private String[] Primarysecondarycur;
    private int globPosition;
    private String strSelecteccontry;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.register2);
        GetDataFromLastPage();

        new FillSpinnerTask().execute();

    }

      private class FillSpinnerTask  extends AsyncTask<Void, Void, Void> {
            private ProgressDialog dialog = new ProgressDialog(
                    Register2.this);

            @Override
            protected void onPreExecute() {
                this.dialog.setMessage(getString(R.string.MsgPleasewait));
                this.dialog.show();
                this.dialog.setCancelable(false);
                // put your code which preload with processDialog

            }

            @Override
            protected Void doInBackground(Void... arg0) {
                // put your code here
                strCountry = cstParsr.LoadCountriesForMobApp(getApplicationContext());

                return null;
            }

            @Override
            protected void onPostExecute(final Void unused) {
                if (this.dialog.isShowing()) {
                    try {
                        this.dialog.dismiss();
                        this.dialog = null;
                    } catch (Exception e) {
                        e.printStackTrace();
                    }
                    if(strCountry != null)
                    {
                        for(int i=0;i<strCountry.length;i++)
                        {
                            Log.i("TAG","strCountry"+strCountry[i]);
                        }

                    }
                    FillView();

                }
            }
        }

    private void FillView() {

        BtnReg2Next = (Button)findViewById(R.id.BtnReg2Next);
        EdtxReg2Streetadd1 = (EditText)findViewById(R.id.EdtxReg2Streetadd1);
        EdtxReg2Streetadd2= (EditText)findViewById(R.id.EdtxReg2Streetadd2);
        EdtxReg2City  = (EditText)findViewById(R.id.EdtxReg2City);
        EdtxReg2Zipcode =  (EditText)findViewById(R.id.EdtxReg2Zipcode);

        SpnrReg2Contry = (Spinner)findViewById(R.id.SpnrReg2Contry); 
        SpnrReg2Agent = (Spinner)findViewById(R.id.SpnrReg2Agent);
        SpnrReg2State = (Spinner)findViewById(R.id.SpnrReg2State);
        SpnrReg2PrimaryCurr = (Spinner)findViewById(R.id.SpnrReg2PrimaryCurr);
        SpnrReg2SecondaryCurr= (Spinner)findViewById(R.id.SpnrReg2SecondaryCurr);

        if(strCountry != null)
        {
            ArrayAdapter languagelist = new ArrayAdapter(
                Register2.this,
                android.R.layout.simple_spinner_item, 
                strCountry);

            languagelist.setDropDownViewResource(
                android.R.layout.simple_spinner_dropdown_item);
            SpnrReg2Contry.setAdapter(languagelist);
        }

        SpnrReg2Contry.setOnItemSelectedListener(new OnItemSelectedListener() 
           {
                public void onItemSelected(AdapterView<?> parent, View view,
                        int position, long arg3) 
                {   

                        strSelecteccontry = strCountry[position];
                        new FillProvinceSpinnerTask().execute();

                }

                @Override
                public void onNothingSelected(AdapterView<?> arg0) {

                }

            });

        /*SpnrReg2State.setOnTouchListener(new OnTouchListener() {

            @Override
            public boolean onTouch(View v, MotionEvent event) {
                if(strProvince == null)
                {
                new FillProvinceSpinnerTask().execute();
                }
                return true;
            }
        });*/

        BtnReg2Next.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                if(EdtxReg2Streetadd1.getText().toString().equalsIgnoreCase("")|
                     EdtxReg2Streetadd2.getText().toString().equalsIgnoreCase("")|
                     EdtxReg2City.getText().toString().equalsIgnoreCase("")|
                     EdtxReg2Zipcode.getText().toString().equalsIgnoreCase(""))
                {
                    Toast.makeText(getApplication(),getString(R.string.nullmessage),Toast.LENGTH_LONG).show();
                }else
                {
                     Intent Registration2 = new Intent(Register2.this,Register3.class);
                     startActivity(Registration2);
                     finish();
                }

            }
        });
    }

    private void GetDataFromLastPage() {
        // TODO Auto-generated method stub
        Intent intent = getIntent();

        Regstrationstep1 = new String[9];
        Regstrationstep1 = intent.getStringArrayExtra("Regstrationstep1");

    }
    @Override
    public void onItemClick(AdapterView<?> arg0, View arg1, int Pos, long arg3) {
        // TODO Auto-generated method stub
    }

    private class FillProvinceSpinnerTask  extends AsyncTask<Void, Void, Void> {
        private ProgressDialog dialog = new ProgressDialog(
                Register2.this);

        @Override
        protected void onPreExecute() {
            this.dialog.setMessage(getString(R.string.MsgPleasewait));
            this.dialog.show();
            this.dialog.setCancelable(false);
            // put your code which preload with processDialog

        }

        @Override
        protected Void doInBackground(Void... arg0) {
            // put your code here
            strProvince = cstParsr.LoadProvinceFromCountryForMobApp(getApplicationContext(),strSelecteccontry);

            return null;
        }

        @Override
        protected void onPostExecute(final Void unused) {
            if (this.dialog.isShowing()) {
                try {
                    this.dialog.dismiss();
                    this.dialog = null;
                } catch (Exception e) {
                    e.printStackTrace();
                }

                if(strProvince != null)
                {

                    Primarysecondarycur = strProvince[0].split("~");
                    strProvince[0] = "Please Select a State";
                ArrayAdapter languagelist = new ArrayAdapter(
                        Register2.this,
                        android.R.layout.simple_spinner_item, 
                        strProvince);

                languagelist.setDropDownViewResource(
                   android.R.layout.simple_spinner_dropdown_item);
                SpnrReg2State.setAdapter(languagelist);

                }
            }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T06:47:01.727

OnItemSelectedListener 的问题在于它在声明时选择了第一个值。为了避免第一次调用，请执行以下操作：

```
 int count = 0;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(...);
        ...
        spinner.setOnItemSelectedListener(new OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView<?> arg0, View arg1,
                    int arg2, long arg3) {
                if(count>0) {
                    // do what you want on item selection
                } else {
                    count++;
                }
            }

            @Override
            public void onNothingSelected(AdapterView<?> arg0) {
            }
        });
    } 
```

# winapi - “图像文件执行选项”是否拦截 CreateProcess 命令？

> ID：11867048
> 
> 赞同：2
> 
> 时间：2012-08-08T14:44:23.833
> 
> 标签：winapi

我想知道调试器注入的机制是如何工作的。为什么“图像文件执行选项”如此特别？

我有两个猜测。

1.  **CreateProcess**将调用一个内部函数来检查注册表项列表。如果找到，则它会操纵参数并调用调试器 exe。

2.  还有**一些其他服务**监听 CreateProcess 调用并拦截它们。它终止原始调用或消息（如果 createprocess 是消息或类似消息），然后它运行新进程，就好像原始调用者调用它一样。

我的愿望是在应用程序启动之前验证和更新组件。我喜欢 IFEO 的“功能”，但我需要在验证步骤之后运行原始过程，所以我需要一种方法来运行它而不递归到更新程序中。我希望通过更多地了解注射系统，我可以让这个系统正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T17:12:06.543

[这篇文章](http://blogs.msdn.com/b/reiley/archive/2011/07/30/a-debugging-approach-to-ifeo.aspx)解释了它是如何工作的。

在 Windows XP 和 2003 中，用户模式`CreateProcess`代码读取注册表，并在需要时启动调试器。

在较新版本的 Windows 中，此功能已进入内核模式。

但是这两种情况似乎都没有涉及`CreateProcess`.

# optimization - Q-学习价值更新

> ID：11867052
> 
> 赞同：2
> 
> 时间：2012-08-08T14:44:34.210
> 
> 标签：optimization, machine-learning, reinforcement-learning, q-learning

我正在使用 Q 学习算法对设备进行电源管理。该设备有两种电源模式，即空闲和睡眠。当设备处于睡眠状态时，处理请求会缓存在队列中。Q 学习算法寻求最小化成本函数，该成本函数是即时功耗和动作引起的延迟的加权和。

```
c(s,a)=lambda*p_avg+(1-lambda)*avg_latency 
```

在每个状态下，学习算法都会采取行动（执行超时值）并评估在下一个状态下采取的行动的效果（使用上述公式）。通过执行预定义超时值池中的某些超时值来执行这些操作。上式中的参数*lambda*是功率性能参数 ( *0* _< *lambda* < *1* )。它定义了算法是应该寻找节能（lambda-->1）还是应该寻找最小化延迟（lambda-->0）。每个请求的延迟计算为*排队时间 + 执行时间*。
问题是学习算法总是倾向于睡眠状态下的小超时值。这是因为小超时值的平均延迟总是较低，因此它们的成本也很小。当我将 lambda 的值从较低更改为较高时，我看不到最终输出策略有任何影响。该策略始终选择小的超时值作为每个状态中的最佳操作。我尝试使用总体平均功耗和总体平均延迟来计算状态-动作对的成本，而不是每个状态的平均功率和平均延迟，但这没有帮助。我还尝试使用所有请求计算每个状态-动作对中成本的总能耗和总延迟，但这也无济于事。**我的问题是：对于这种情况，什么是更好的成本函数？**我更新Q值如下：

```
Q(s,a)=Q(s,a)+alpha*[c(s,a)+gamma*min_a Q(s',a')-Q(s,a)] 
```

其中*alpha*是学习率（缓慢下降），而*gamma=0.9*是折扣因子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T02:50:58.250

要回答评论中提出的问题：

> 我应该使用所有请求的全部功耗和全部延迟来计算每个状态（s，a）的成本吗？

不会。在 Q 学习中，奖励通常被认为是与单个状态-动作对相关联的瞬时信号。看看[Sutton 和 Barto 的奖励页面](http://webdocs.cs.ualberta.ca/~sutton/book/ebook/node30.html)。如图所示，瞬时奖励函数 (r_t+1) 下标为时间步 - 表明它确实是瞬时的。请注意，预期回报 R_t 考虑了奖励的历史（从时间 t 回到 t_0）。因此，您无需明确跟踪累积的延迟和功耗（这样做可能会适得其反。）

> 还是应该使用状态 s 中的动作 a 引起的即时功耗和平均延迟？

是的。要强调上述陈述，请参阅[此处](http://web.ics.purdue.edu/~huanren/files/RLSummary.pdf)第 4 页的 MDP 定义。相关位：

> 奖励函数将预期的瞬时奖励指定为当前状态和动作的函数

正如我在上面的评论中指出的那样，奖励正在“丢失”或“被淘汰”的问题可能会通过 Q(lambda) 实现更好地解决，因为时间信用分配可以更有效地执行。[在此处](http://webdocs.cs.ualberta.ca/~sutton/book/ebook/node72.html)查看 Sutton 和 Barto 关于 TD(lambda) 方法的章节。您还可以[在此处](http://www-anw.cs.umass.edu/rlr/domains.html)找到一些很好的示例和实现。

# php - 将 Fortran REAL 打包例程转换为 PHP

> ID：11867055
> 
> 赞同：2
> 
> 时间：2012-08-08T14:44:38.590
> 
> 标签：php, fortran, pack

我的任务是将一些 Fortran 代码转换为 PHP，并在最后一个障碍中绊倒。

本质上，Fortran 将 REAL 转换为最终写入文件的二进制 CHAR(4)。

Fortran（这也让我感到困惑）如下：

```
FUNCTION MKS(x)
    CHARACTER (LEN=4) :: MKS             ! The 4-character string which is returned to 
    REAL :: x                            ! The incoming single-precision variable 
    CHARACTER (LEN=1), DIMENSION(4) :: a ! A working variable
    CHARACTER (LEN=4) :: d               ! A working variable
    CALL MKS1(x,a)                       ! Send x - get back a(1), a(2), a(3), a(4) 
                                    ! Note: x will hold the first 32 bits referenced 
                                         ! and a will hold the next 32 bits
d = a(1) // a(2) // a(3) // a(4)     ! concatenate into 1 string (d)
MKS = d                              ! assign string to variable MKS
END FUNCTION MKS

SUBROUTINE MKS1 (b,c)
    IMPLICIT NONE
    CHARACTER (LEN=1), DIMENSION(4)  :: b    ! array with incoming 32 bits
    CHARACTER (LEN=1), DIMENSION(4)  :: c    ! array with each character returned
    INTEGER :: i                             !  DO Loop counter
    DO i=1,4
        c(i) = b(i)
    END DO
END SUBROUTINE MKS1 
```

我尝试使用 php 重新创建此函数，如下所示

```
pack('CCCC', $value & 0x000F, 
           ($value>>8) & 0x000F, 
           ($value>>16) & 0x000F, 
           ($value>>24) &0x000F); 
```

但是在使用 *nix od 命令比较输出值时显示完全不同的结果。

在 PHP 中将 Fortran REAL 等价物打包到 char[4] 数组中的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:00:02.267

结果很简单。

您的 FORTAN REAL 存储为[IEEE 754](http://en.wikipedia.org/wiki/IEEE_floating_point) 32 位浮点数。

您的输出`od`具有误导性。将其转换为十六进制会得到以下结果。

```
0115040 0134631 0005077

0x20, 0x9A, 0x99, 0xB9, 0x3f, 0x0a 
```

文件的第一个和最后一个字节是多余的，它们分别是一个空格和一个回车。我们所追求的位是中间的 4 个字节。

使用`pack`我们可以从浮点数转换（**警告**- 字节序*取决于*机器）。

以下：

```
var_dump(bin2hex(pack('f', 1.450))); 
```

给我们一个熟悉的字节序列。

```
string(8) "9a99b93f" 
```

因此，与其转换为十六进制，不如将其输出到一个开头有空格、结尾有回车的文件，您将拥有一个相同的文件。（只要你的 PHP/机器配置没有对浮点数做一些疯狂的事情 - 但即使你遵循 IEEE 754 规范，你应该能够重现它）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:32:15.237

这可能是扩展评论而不是答案。

你是，在声明中

```
CALL MKS1(x,a) 
```

传递一个 REAL 参数，其中子例程需要 4 个长度为 1 字符的数组。你应该得到所有发生在你身上的坏事:-) 你只能编译它，因为你的子例程不需要显式接口。

您希望 PHP 程序读取的 4 个字符是什么？例如，如果您的 Fortran 将`REAL`4 个字节写入二进制文件，而您的 PHP 将 4 个字节读取为 4 个单个字符，您会得到您想要的字符吗？我不确定你的要求是什么。

# c# - 在 StringBuilder 中使用“@”插入多行字符串

> ID：11867060
> 
> 赞同：1
> 
> 时间：2012-08-08T14:45:01.160
> 
> 标签：c#, string

我有一个 StringBuilder 对象，想使用它的 Append() 方法将整个字符串添加到它：

![在此处输入图像描述](../Images/a4a18d09f06e8247910e374bd4cf00be.png)

所以我使用 "@" 并像这样复制粘贴了整个字符串，但它给出了很多错误，例如 "; expected ", "Invalid Expression '<'" 等

```
myString.Append(@"COPY-PASTED-THAT_WHOLE-STRING"); 
```

将此字符串添加到我的字符串生成器对象的正确方法是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T14:47:10.057

即使`@`为字符串加上前缀，您也需要转义任何`"`字符，否则它们将被解释为字符串文字的结尾。

**编辑：**

例如

```
var entity = @"<!ENTITY xsd ""http://www.w3.org/2001/XMLSchema#"">"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T14:58:57.927

`"`要粘贴的字符串中的双引号 ( ) 需要通过替换为两个连续的双引号来进行转义，如`""`. 这是一个使用技巧：

*   将您的字符串粘贴到记事本的新实例中
*   将所有双引号 ( `"`) 替换为两个双引号 ( `""`)
*   选择并将记事本中的内容复制回剪贴板
*   将其粘贴到`@"…"`您的代码/文本编辑器中

来自[C# 文档](http://msdn.microsoft.com/en-us/library/aa691090.aspx)：

> 在逐字字符串文字中，分隔符之间的字符被逐字解释，唯一的例外是 *quote-escape-sequence*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T14:49:48.463

您可以使用`@`语法添加多行。但是您需要`"`通过使用来转义字符串中的 s`""`

例如

`@"<Ontology xmlns=""http://www.w3.org/2002/07/owl#"""`

如果您不转义它们，C# 会将引号视为字符串的结尾。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T14:54:13.217

正如其他人所说，一种选择是使用双双引号 ( ) 转义所有双引号`"`( `""`)。

在将 XML 块添加为文字字符串时，我更喜欢使用单引号而不是双引号，因为它使代码更具可读性。只需将 XML 文件放入文本编辑器，然后用单引号 ( `'`) 替换双引号上的所有内容。

另一种选择是，因为您的 XML 文字不是那么短，所以将其放入一个文件并在运行时读取该文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-08T16:56:25.403

你也可以像这样逃离他们......

```
@"<Ontology xmlns=\"http://www.w3.org/2002/07/owl#\"" 
```

# javascript - 智能调整大小背景

> ID：11867063
> 
> 赞同：1
> 
> 时间：2012-08-08T14:45:17.780
> 
> 标签：javascript, html, css

请原谅我这个，可能是痴情的问题。但是在为控件/元素设置皮肤时，我通常使用以下概念（我不知道正确的名称，但我在创建自定义 WinXP 主题时第一次看到它）。基本思想是在图像中设置一种限制调整大小的边距，只允许拉伸内部部分。

[http://img42.imageshack.us/img42/6188/image7rq.jpg](http://img42.imageshack.us/img42/6188/image7rq.jpg)

当在我的常规编程工作中使用这种方法时，生活很容易，我只需`BitBlt`将四个角然后`StretchBlt`其余部分放入到位。但是我不是 HTML 专家，我在互联网上找不到任何关于它的信息。当您不完全知道概念的名称时，很难搜索...

a) 这个方法是怎么调用的？

b) 有谁知道如何使用 HTML、CSS、Javascript 等来做到这一点？最好我希望一个`DIV`元素的背景是这样的主题。打算在这一天剩下的时间里不在 Photoshop 中切片图像，这让我感到非常痛苦……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:11:41.877

改用css不是更容易吗？检查此[http://jonraasch.com/blog/css-rounded-corners-in-all-browsers](http://jonraasch.com/blog/css-rounded-corners-in-all-browsers)或搜索“css圆角框”或“css圆角”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:16:27.057

有几种方法可以解决这个问题。如果允许您针对较新的浏览器并允许旧浏览器降级为方角和非渐变背景，请查看[新的 CSS 3 功能](http://www.zetalight.com/css3-shadow-rounded-corners-gradient-cross-browser-css3-support/)。

但是，如果您需要能够支持旧浏览器，您将不得不启动 Photoshop，创建一些背景图像，并嵌套一些 html 元素。如果您的背景只需要在一个方向（垂直或水平）缩放，请查看[滑动门](http://azadcreative.com/2009/03/bulletproof-css-sliding-doors/)技术。

# initialization - Fortran COMMON 块初始化

> ID：11867064
> 
> 赞同：1
> 
> 时间：2012-08-08T14:45:18.450
> 
> 标签：initialization, fortran, fortran-common-block

Fortran 新手，我被要求使用 Salford/Silverfrost 编译器使用 Fortran 77 编写的旧 Fortran 代码库（最初的开发人员已去世）。

最初的开发人员`COMMON`广泛使用命名块（模拟全局变量，AFAIU），并且他`EQUIVALENCE`在需要时使用（重新）初始化块，如下面的代码片段：

```
 IMPLICIT REAL*8 (A-H,O-Z)

      COMMON/COMMF2D/
     * ASCN(0:99,0:20,0:4)   
     *,FEMPTY2(8700)

      DIMENSION KLCKF2D(38400)
      EQUIVALENCE (KLCKF2D,ASCN)

      DO I= 1,38400                                              
      KLCKF2D(I)= 0
      END DO 
```

这是一种可接受的编程实践还是只是一种黑客行为？另外，由于我正在尝试将代码移植到 GFortran，它是否可移植？（我知道像这样`REAL*8`的声明只是对编译器的提示，并不能保证）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T15:21:27.603

`EQUIVALENCE`什么都不*做*，它当然不初始化任何东西，它`EQUIVALENCE`是一个定义或声明。这些天来（自从 Fortran 90 标准发布以来，力量一直在增长）`EQUIVALENCE`是一种黑客行为，应尽可能避免。

该语句声明 2 个变量共享存储（Fortran 标准称之为*storage-association*）。对此的一种解释是，等价的名称只是别名，但该语句的（ab-）使用允许程序员做一些其他事情，这些事情被 21 世纪的专业软件工程师认为是狡猾的。

例如，这适用于您发布的片段，`EQUIVALENCE`可用于让不同类型的变量共享相同的存储。您有一个名为`ASCN`which 的数组（隐式）`REAL*8`与一个名为 which 的数组`KLCKF2D`（再次隐式）等价于 type `INTEGER`。这意味着，如果您以一个名称引用存储，则位模式被解释为`REAL`s，使用另一个名称它们是`INTEGER`s - 请注意，具有值的实数的位模式`100.0`不会（当然）被解释为整数`100`。

黑客并不止于此。块声明的一个效果`COMMON`是将变量放在内存中，在您的情况下，`10500 (= 100*21*5)`元素`ASCN`后面是`8700`元素`FEMPTY2`。通过一点乘法和加法，您会发现`38400 = 2*(10500+8700)`与该程序中的默认整数大小一致，即 4 字节，即`REAL*8`其​​他变量中使用的 s 大小的一半。因此数组`KLCKF2D`大于`ASCN`但原始程序员知道下一个`17400`字节将被`FEMPTY2`.

所以是的，这可能是一种将程序内存数据部分中的所有位设置为 的方法`0`，但它（现在被认为是）一个可怕的黑客攻击。但它应该是可移植的——后续的 Fortran 标准对于从语言和编译器编写者中删除过时的特性非常保守，更重要的是，向后兼容性对 Fortran 程序员来说非常重要。

哦，为了回答你的问题，是`COMMON`的块是（注意过去时）声明和使用全局变量的 FORTRAN77 方式。`MODULE`如今，该语言提供了更安全的选择，即通过将变量包装在 a和 -关联它们来声明要全局共享的变量`USE`。

看到这样的线我不会感到惊讶

```
COMMON/COMMF2D/KLCKF2D(38400) 
```

在您的代码中，`COMMON`块也可以（ab-）用于重命名和重新键入存储位置。

虽然我正在对您的旧代码进行踢脚，但这些天隐式键入也令人不悦，显式键入所有声明要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-07T22:12:30.423

好吧，不管是否便携，这种做法是……很常见的。（地球幽默。兽人。兽人。）我给你举个例子：我已经翻新过的游戏 Zork 的源代码中的数据——它实际上只是常见的块和等价物。[https://github.com/LydiaMarieWilliamson/zork-fortran](https://github.com/LydiaMarieWilliamson/zork-fortran)

在相邻的 C 翻译中，您将看到它在 C 中的表现。f2c 翻译器难以处理等价和​​公共块（正如您将在我的翻译日志中看到的那样）。我的建议是将其全部重新编码为 C 或 C++，并在那里修复它。这将使更多种类的程序员更容易使用它。我正准备用整个 LAPACK 发行版（你可能已经注意到）来做这件事——大约 500000 到 1000000 行。

C等价的结构，本身也是建立多维数组的最佳方式。你只为整个事情分配一个基本段。然后，对于第二个维度，您将一段指针分配到其中 - 一个栅格。然后，对于第三个维度，您将一段指针分配到那个......等等。

等价语句本身没有良好的 C 等价性。（地球幽默。Ork。Ork。）相反，在使用引用类型的 C++ 中最好找到等价的等价物。在 C++ 中，您还可以更直接地呈现 Fortran 下标，因为下标本身（带有 [] 和 () 类型括号）是可编程运算符。因此，您实际上可以直接将等价结构及其索引方法原样转换为静态结构，而无需进行上述分配。

# c# - 如何从列表中删除空字符串，然后从列表中删除重复值

> ID：11867070
> 
> 赞同：84
> 
> 时间：2012-08-08T14:45:44.627
> 
> 标签：c#, linq

假设我有一个来自表的一些列值的列表，如何删除空字符串和重复值。请看以下代码：

```
List<string> dtList = dtReportsList.AsEnumerable().Select(dr => dr.Field<string>("column1")).ToList(); 
```

这是我刚刚编写的代码，但是 Amiram 的代码更加优雅，所以我会选择这个答案，这就是我的做法：

```
DataTable dtReportsList = someclass.GetReportsList();

        if (dtReportsList.Rows.Count > 0)
       { 
           List<string> dtList = dtReportsList.AsEnumerable().Select(dr => dr.Field<string>("column1")).ToList();
           dtList.RemoveAll(x=>x == "");
           dtList = dtList.Distinct().ToList();         

           rcboModule.DataSource = dtList;
           rcboModule.DataBind();               
           rcboModule.Items.Insert(0, new RadComboBoxItem("All", "All"));
       } 
```

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2012-08-08T14:47:40.950

```
dtList  = dtList.Where(s => !string.IsNullOrWhiteSpace(s)).Distinct().ToList() 
```

我假设空字符串和空格就像null。如果不是，您可以使用`IsNullOrEmpty`（允许空格），或者`s != null`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-08T15:01:00.640

Amiram 的回答是正确的，但实现的 Distinct() 是 N ²操作；对于列表中的每个项目，算法将其与所有已处理的元素进行比较，如果它是唯一的则返回它，否则忽略它。我们可以做得更好。

*排序*列表可以在线性时间内进行重复数据删除；如果当前元素等于前一个元素，则忽略它，否则返回它。排序是 NlogN，所以即使必须对集合进行排序，我们也会得到一些好处：

```
public static IEnumerable<T> SortAndDedupe<T>(this IEnumerable<T> input)
{
   var toDedupe = input.OrderBy(x=>x);

   T prev;
   foreach(var element in toDedupe)
   {
      if(element == prev) continue;

      yield return element;
      prev = element;      
   }
}

//Usage
dtList  = dtList.Where(s => !string.IsNullOrWhitespace(s)).SortAndDedupe().ToList(); 
```

这将返回相同的元素；他们只是排序。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-10-27T10:54:52.643

为了简化[Amiram Korach 的](https://stackoverflow.com/users/1495902/amiram-korach)解决方案：

```
dtList.RemoveAll(s => string.IsNullOrWhiteSpace(s)) 
```

无需使用 Distinct() 或 ToList()

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T15:01:52.543

Amiram Korach 解决方案确实很整洁。为了多功能性，这里有一个替代方案。

```
var count = dtList.Count;
// Perform a reverse tracking.
for (var i = count - 1; i > -1; i--)
{
    if (dtList[i]==string.Empty) dtList.RemoveAt(i);
}
// Keep only the unique list items.
dtList = dtList.Distinct().ToList(); 
```

# javascript - 从 Spotify App 中的回调中获取专辑数据

> ID：11867071
> 
> 赞同：0
> 
> 时间：2012-08-08T14:45:49.757
> 
> 标签：javascript, spotify

我正在构建一个 Spotify 应用程序，并希望拥有精选专辑。我的 JSON 数据指定了专辑，所以我用一个简单的`for`循环遍历它们。但是，与直接通过 获取的曲目数据不同`track.data.album.name`，专辑数据需要通过回调来提取：

```
var a = models.Album.fromURI(appData.Albums[i].uri, function(album) {
        console.log("Album data: ", album.name);
}); 
```

这可以按预期工作，控制台显示专辑名称，但我找不到任何示例说明如何在回调函数之外提供该数据。`a.uri`似乎是唯一有效的方法：

```
var a = models.Album.fromURI(appData.Albums[i].uri, function(album) {
    //console.log("Album data: ", album.name);
});
console.log("Album data: ", a.uri); 
```

有人可以指出我正确的方向吗？如果这是 Spotify 应用程序问题，或者我是否应该在回调中使用闭包或匿名函数，我有点困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T17:10:49.103

你得到的东西`models.Album.fromURI()`是在回调中传递给你的同一个对象：

```
var a = models.Album.fromURI("spotify:album:1KtFTJnuQbMDpKJRHQonYZ", function(album) {
    console.log(a === album);
    // ^Logs "true"
}); 
```

该`uri`属性立即可用，因为它是已知的——您将 URI 提供给对象以开始。其余的元数据是异步加载的，`a`一旦回调被触发，就会在原始对象中可用。在回调中，您可能想要调用另一个函数来实际更新您的 URI 或您接下来需要做的任何事情。

# ruby-on-rails - 将 DB2 与 JRuby Rails 3.2 DataMapper ORM 一起使用

> ID：11867082
> 
> 赞同：1
> 
> 时间：2012-08-08T14:46:25.360
> 
> 标签：ruby-on-rails, jdbc, jruby, jrubyonrails, ruby-datamapper

我最近开始了解 DataMapper，发现它对“遗留”数据库模式的支持远远优于 ActiveRecords。这启发了我尝试一下，但是我在尝试转换我现有的工作 ActiveRecord 配置时遇到了障碍。

这就是我要开始的

```
development:
  adapter:  jdbc
  driver:   com.ibm.db2.jcc.DB2Driver
  url:      jdbc:db2://<SNIP>:50000/MYDB
  username: user
  password: password 
```

现在我遇到的问题是如何将其实际转换为 DataMapper 可以使用的东西。到目前为止，我发现我需要使用 do_jdbc 适配器，并且我已经经历了一堆迭代来尝试找出各种设置应该是什么。

有人可以引导我朝着正确的方向前进吗？

谢谢

# javascript - 带有所需 CSS 的 Jquery 插件

> ID：11867083
> 
> 赞同：0
> 
> 时间：2012-08-08T14:46:26.343
> 
> 标签：javascript, jquery, css, jquery-plugins

我写了一个 JQuery 插件。该插件将自定义视图添加到列表中（类似于 JQuery Mobiles .listview()）。

这个想法是我可以创建一个通用的无序列表，然后应用我的插件来添加行为和样式。

```
 <ul data-role="none">
        <li>Hello</li>
        <li>Hello</li>
    </ul>

$("ul").myView(); 
```

我没有看到太多是添加大块 css 的插件。我的插件需要某些 css 类才能工作，那么我将它们存储在哪里？插件通常带有样式表吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:51:07.063

插件通常带有一组预定义的 CSS。但是 IMO 应该由插件用户`<head>`在加载任何 javascript 之前自行手动将样式表添加到标签中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T14:57:01.593

正如 Peter 所说，此类插件通常会将 CSS 与它们打包在一起，但用户需要手动链接它。这有几个原因：

*   用户可能将 JS 和 CSS 文件保存在不寻常的位置，需要用户干预才能正确指向包含
*   CSS 依赖于加载顺序，因此自动插入它可能会覆盖用户 CSS 规则或阻止用户在不编辑源文件的情况下覆盖插件 CSS
*   许多 jQuery 插件，尤其是那些影响表单元素和滚动的插件，需要在关闭 JavaScript 时优雅地降级。如果 CSS 是通过 JavaScript 添加的，插件作者根本无法控制降级。

自动配置一切对最终用户来说非常有用，但大多数开发人员需要增强控制程度。

# ruby-on-rails - Rails：引导程序和下拉菜单不起作用

> ID：11867091
> 
> 赞同：8
> 
> 时间：2012-08-08T14:46:46.920
> 
> 标签：ruby-on-rails, twitter-bootstrap

在我的 application.html.erb 中，我有以下内容：

```
<head>
  <title><%= title %></title>
  <%= stylesheet_link_tag "application", media: 'all' %>
  <%= javascript_include_tag "application" %>
  <%= javascript_include_tag "https://js.stripe.com/v1/", "application" %>
  <%= csrf_meta_tags %>
  <%= tag :meta, :name => "stripe-key", :content => STRIPE_PUBLIC_KEY %>
  <%= javascript_include_tag "http://twitter.github.com/bootstrap/assets/js/bootstrap-dropdown.js", "application" %>
  <%= render 'layouts/shim' %>
</head> 
```

在我的 gemfile 中，我有以下内容：

```
gem 'twitter-bootstrap-rails'
gem 'bootstrap-datepicker-rails' 
```

在我的意见\layouts_header.html.erb 中，我有：

```
 <li class="dropdown" id="admin_menu">
    <a class="dropdown-toggle" data-toggle="dropdown" data-target="#admin_menu">
      <%= ADMIN_TITLE %>
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <% Admin_menu.each do |menu_text, menu_action| %>
          <li><a href="<%= menu_action %>"><%= menu_text %></a></li>
      <% end %>
    </ul>
  </li> 
```

Admin_menu 在别处定义为： Admin_menu = Hash.new Admin_menu["Papers"] = "/papers" Admin_menu["Tracks"] = "/tracks" Admin_menu["Attendance"] = "/attendance"

当我单击插入符号时，没有任何反应。我检查了 HTML 代码，那里有下拉菜单选项。

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-30T15:29:36.890

您需要更改这些行：

```
<%= javascript_include_tag "application" %>
<%= javascript_include_tag "https://js.stripe.com/v1/", "application" %>
<%= javascript_include_tag "http://twitter.github.com/bootstrap/assets/js/bootstrap-dropdown.js", "application" %> 
```

对此：

```
<%= javascript_include_tag "https://js.stripe.com/v1/" %>
<%= javascript_include_tag "application" %> 
```

您当前的代码多次包含 application.js，这是 Bootstrap 的下拉代码的问题。我敢打赌，如果您查看 application.js 文件，您会在顶部附近看到：

```
//= require bootstrap 
```

这意味着每次包含 application.js 时都要加载一次引导程序，然后再从 github 加载一次。

如果您阅读 Bootstrap 的 Dropdown JS 代码，您会看到它添加了一个单击侦听器来*切换*下拉菜单。如果您运行此代码两次，您将添加两个点击侦听器。因此，在每次点击时，这两个听众都会打开菜单并突然再次关闭它。

我遇到了与您类似的问题，我没有注意到我`javascript_include_tag`的 for Stripe 也重新包含了`application`. 我想我们可能从同一个地方复制/粘贴！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:35:18.203

使用 Firebug 或 chrome 扩展来检查浏览器中的 html。如果不正确，请尝试使用帮助程序来避免弄乱字符串：

`<li><%= link_to menu_text, menu_action %></li>`

# javascript - 是否可以触发文件下载到用户的浏览器？

> ID：11867096
> 
> 赞同：3
> 
> 时间：2012-08-08T14:46:55.347
> 
> 标签：javascript, html, ajax, json, cgi

是否可以强制文件下载到用户的浏览器（当然是标准对话框提示）？由服务器触发。基本上我正在考虑将来自服务器文件系统的文件推送到浏览器。还是因为安全沙箱而无法做到这一点？如果这不可能，是否有非常接近此的不同方法？我不想在未经用户同意的情况下发送文件。我可以想到两步方法，首先提示用户输入数据，然后让用户单击触发下载的确定按钮，但在下载快结束时，用户会得到另一个确认框（要求打开的标准下载提示或保存）。如果可以一步到位，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T14:49:26.447

这绝对是可能的。假设您希望这由服务器触发，您只需向他们发送此标头：

```
Location: http://www.foo.com/path/to/file 
```

您的域在哪里`foo.com`，它包含文件的路径。这会将用户发送到您的文件链接并让他们自动下载。

现在，要解决浏览器查看内容的问题，您需要服务器端代码来发出`Content`像这样的标头信息（以 PHP 为例）：

```
<?php
    header("Content-Type: application/octet-stream");
    header("Content-Length: " . filesize($file));   
    header('Content-Disposition: attachment; filename=' . $file); 
    readfile($file);
?> 
```

希望这可以作为伪代码很好地帮助您入门。祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T14:50:08.840

使用每 5 秒或 10 秒轮询一次服务器的 ajax json 脚本，当服务器准备好文件时以肯定回答“我有文件”进行响应，将 iframe 移动到文件所在的 url，然后处理作为正常下载。

我已经提供了一个小例子来说明我应该如何认为它应该工作，所以你有一些工作要做。我还没有检查过它的错误，它更像是一个概念证明。

jQuery 示例（没有 json）：

```
$.ajax('/myserverscript.php?fileready=needtoknow').done(function(data) 
    {
    if(data.indexOf("I have a file") != -1)
        {
        xdata = data.split('\n');
        data = xdata[1];
        document.getElementById('myiframe').location.href = data;
        }
    }); 
```

PHP 代码

```
$x = filecheckingfunction();// returns false if none, returns url if there is a file
if($x !== false)
    {
    echo 'I have a file\n';
    echo $x;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T14:49:32.410

由于您知道必须提示用户，因此请尝试使用带有`type="application/octet-stream"`.

您还可以`"content-disposition: attachment"`在标题中使用：。

# objective-c - ios - 多个异步调用

> ID：11867099
> 
> 赞同：0
> 
> 时间：2012-08-08T14:47:03.393
> 
> 标签：objective-c, ios

在 viewController 的 viewWillAppear 中，我有一个异步调用，但我遇到的问题是每次我去这个 viewController 时都会触发一个异步调用，即使旧调用已经在运行，所以我需要检查一个旧调用是否是仍在获取数据 如果不触发则不执行任何操作

我知道我可以添加一个属性并在开始调用 YES 时对其进行设置，并在返回 viewController 时检查它，如果是，则它仍在获取，不，我们可以通过另一个调用但我不喜欢糟糕的解决方案

我正在使用 ASIHttpRequest 来调用服务器，我想知道我是否可以通过这个 3rd 方检查一些东西以了解它是否仍在获取

解决方案/帮助将不胜感激谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:33:07.733

如果您使用 GCD，则可以使用[`dispatch_once`](https://developer.apple.com/library/mac/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html).

# c# - 按钮的工具提示

> ID：11867110
> 
> 赞同：1
> 
> 时间：2012-08-08T14:47:35.500
> 
> 标签：c#, javascript, asp.net-mvc-3

我的 MVC 3 视图中有按钮。这里是：

```
 <button rowId="@employee.Id" value="refresh" class="button-submit" class="btn btn-mini" style="border: 0; background: transparent; box-shadow: none;">
                                <img class="btn btn-mini" width="24" height="24" alt="Delete doctor" src="/Content/img/refresh.png" />
                            </button> 
```

我想显示工具提示，所以：

```
 $(function () {
        $(".button-submit").tooltip();
    }); 
```

但在我的情况下不起作用。我怎样才能让它们工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:57:46.717

您是否为工具提示插件以及 JQuery javascript 导入了 javascript？

看看[本页末尾的示例](http://docs.jquery.com/Plugins/Tooltip/tooltip#options)

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <link rel="stylesheet" type="text/css" href="http://dev.jquery.com/view/trunk/plugins/tooltip/jquery.tooltip.css" />
<script type="text/javascript" src="http://dev.jquery.com/view/trunk/plugins/tooltip/jquery.dimensions.js"></script>
<script type="text/javascript" src="http://dev.jquery.com/view/trunk/plugins/tooltip/jquery.tooltip.js"></script>
  <script>
  $(document).ready(function(){
    $("a").tooltip();
  });
  </script>

</head>
<body>

<a href="http://jquery.com" title="Write less, do more">jQuery.com</a>
<br/>
<a href="http://learningjquery.com" title="Learn more, write less">learningjQuery.com</a>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T14:57:49.457

你`button`有两个`class`属性，它必须只有一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:20:06.997

尝试更改`class="button-submit" class="btn btn-mini"`为`class="button-submit btn btn-mini"`

# mercurial - 如何在 Mercurial 中使强制推动的分支成为尖端？

> ID：11867112
> 
> 赞同：1
> 
> 时间：2012-08-08T14:47:35.870
> 
> 标签：mercurial

[我最初的情况与此问题](https://stackoverflow.com/questions/11015557/forgetting-a-dead-end-branch)中的情况相似。来自强大的 Git 背景，我想强制推送我的私有分支的清理版本（以相同的名称），我已经压缩/折叠了一些提交（使用[histedit 扩展](http://mercurial.selenic.com/wiki/HisteditExtension)）。我再次所做的与[此答案](https://stackoverflow.com/a/11016218/1127485)类似，但我以不同的顺序做事：

```
$ hg clone -b private_branch <url>
$ hg histedit -r <some_rev> # Fold some commits
$ hg push -f # This creates a second branch head on the server
$ hg update -r <rev_of_original_branch_head>
$ hg commit --close-branch -m 'Closing this branch in favor of a cleaned-up version'
$ hg push 
```

我不明白的是，如果我现在建立一个新的工作树，我会得到

```
$ hg clone -b private_branch <url>
$ hg log -l 1
changeset:   <rev>:<sha1>
branch:      private_branch
tag:         tip
parent:      <tip_rev_of_branch_before_folding>:<sha1>
user:        <name> <email>
date:        Wed Aug 08 11:48:25 2012 +0200
summary:     Closing this branch in favor of a cleaned-up version 
```

为什么`tip`指向关闭的分支？`hg heads`只是按预期显示我的强制推头。然而，`hg heads -t`正为`private_branch`. 我还验证了我的结束提交确实是一个结束提交，`hg log --debug`显示`extra: close=1`。

**编辑：**这个问题是，如果我对一个新的克隆进行提交，我会得到

```
$ hg ci -m "test"
created new head
reopening closed branch head <rev> 
```

但我不想重新打开关闭的分支头，我想在打开的分支头上提交。

我该如何解决这个问题，最好不进行[无操作合并](http://mercurial.selenic.com/wiki/PruningDeadBranches#No-Op_Merges)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:56:32.543

> 提示标签是一个特殊的“浮动”标签，它始终标识存储库中的最新版本。

（来自[http://hgbook.red-bean.com/read/managing-releases-and-branchy-development.html](http://hgbook.red-bean.com/read/managing-releases-and-branchy-development.html)）

这就是为什么`tip`指向涉及封闭分支的修订。

这里真的有问题吗？如果您继续工作，您将继续进行`private_branch`您想要进行的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T08:27:34.863

解决方案是简单地做

```
$ hg update private_branch 
```

将工作目录的父版本设置为`hg parent(s)`新创建的打开分支头，远离关闭的分支头。尽管我已经“在那个分支上”，但我需要“切换分支”对我来说有点不直观，但在这种情况下，我不是在切换分支，而是在单个分支中切换头。与 Git 完全不同的东西。

# asp.net-mvc - 如何将 Orchard CMS 与当前的 MVC2 应用程序集成？

> ID：11867113
> 
> 赞同：3
> 
> 时间：2012-08-08T14:47:36.550
> 
> 标签：asp.net-mvc, orchardcms

对于我的项目，客户端有一个现有的 ASP.NET MVC 2 Web 应用程序，该应用程序具有产品目录和购物车功能。客户正在重新设计他们的网站，并希望使用 Orchard 来维护他们的内容页面，例如主页、关于、服务等。

他们希望尽可能多地使用现有代码，并保留购物车功能，只需进行外观更改。

作为 Orchard 的新手（我只是在阅读它并关注视频教程几天），我想知道如何解决这个问题，并想在这里向专家寻求帮助。我想知道我们是否可以将 Orchard 用于上述场景，以及是否有关于如何为这种场景进行开发的建议。

太感谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:01:29.993

用户1585016,

有趣的是，前几天收到了 codeproject 时事通讯，有一篇非常好的文章带您了解 mvc 和 orchard 'marriage' 的步骤。可爱的文章：

[http://www.codeproject.com/Articles/434484/Welding-on-Orchard-CMS](http://www.codeproject.com/Articles/434484/Welding-on-Orchard-CMS)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:22:24.357

最好的办法是将 MVC 应用程序重构为 Orchard 模块。您需要添加清单，在 routes.cs 文件中重新定义路由（获取现有的灵感），然后添加一些 [Themed] 属性。这实际上取决于您想要实现的集成水平，但这只是开始。

# ubuntu - Install4j 5.1 - 在无头 ubuntu 服务器上设置浮动许可证

> ID：11867116
> 
> 赞同：1
> 
> 时间：2012-08-08T14:47:49.147
> 
> 标签：ubuntu, licensing, headless, install4j, floating

我想在 Ubuntu 服务器上构建我们的应用程序。我们的安装程序是使用 Install4j 5.1 创建的，并通过 maven-install4j-plugin 集成到我们的 maven 构建中。我遇到的问题是我无法初始化许可证信​​息以指向我们的浮动许可证服务器（localhost:11862）。要初始化许可证，我使用以下命令：

install4jc --license=XXXXXXXXX

问题是我不知道将许可证设置到浮动服务器的确切语法。我试过 --license=localhost:11862 并且我尝试直接复制粘贴我的浮动许可证密钥但没有成功。

我在哪里可以找到关于如何在无头系统上设置我的浮动许可证信息的基本说明，最重要的是，如何表达它以在执行 install4jc 时停止接收“无效的语法密钥”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T13:58:20.653

使用浮动许可证服务器的语法是

```
install4jc --license=FLOAT:localhost:11862 
```

如果您有 Windows 版许可证，您当前必须编辑

$HOME/.install4j5/config.xml

并在该文件中更改`floatingMultiPlatform="true"`为。`floatingMultiPlatform="false"`

从 install4j 5.1.3 开始，您将能够传递命令行选项`--windows-edition`而不是编辑配置文件，并且`FLOAT:server`运行时会记录语法`install4jc --help`。

# perl - Perl 包模板 'a' 重复

> ID：11867120
> 
> 赞同：2
> 
> 时间：2012-08-08T14:47:58.827
> 
> 标签：perl, pack

我需要提取一系列两个字符（我将其传递给解包，因为它们确实是 BCD 的一种奇怪形式）。我目前使用：

```
my @whatever = unpack('a2 a2 a2 a2 a2 a2 a2', get_bcd_string()); 
```

看来我不能使用类似的东西`[6]`作为重复因子`a2`，但我想确定一下。

我意识到我可以将 using 提取`a12`到一个字符串中并拆分该字符串，但我正在尝试了解是否可以更有效地使用 unpack。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T14:52:30.530

这可以解决问题：

```
unpack '(a2)6' 
```

如果您只是想解压整个字符串，您可以使用以下代码：

```
unpack '(a2)*' 
```

# android - 将列表添加到 PreferenceScreen

> ID：11867122
> 
> 赞同：1
> 
> 时间：2012-08-08T14:48:04.817
> 
> 标签：android, preferencescreen

我的应用程序有一个 TabHost，里面有各种选项卡。我添加了（在 TabHost 之外）一个按钮，该按钮调用从 PreferenceActivity 扩展的另一个活动来管理应用程序的首选项。对于 PreferenceActivity，我遵循了 API Demos 中的 PreferenceWithHeaders 示例。现在，我想在其中一个标题（在 PreferenceCategory 内）的类别中添加一个列表，该列表显示来自 TabHost 的所有选项卡的名称。

有没有办法做到这一点，或者我应该考虑使用另一种类型的资源，比如结合 SharedPreferences 的片段？

提前致谢

# cocos2d-iphone - 释放鼠标关节时获取精灵位置时出现 EXC_BAD_ACCESS 错误

> ID：11867125
> 
> 赞同：0
> 
> 时间：2012-08-08T14:48:13.000
> 
> 标签：cocos2d-iphone, box2d, exc-bad-access, box2d-iphone

我试图在释放移动精灵的鼠标关节时获取精灵的确切位置（即使精灵可能仍在移动）并显示它。我正在使用 Cocos2d 和 Box2d。下面是代码 ccTouchesEnded 方法。

ccTouchesEnd:

```
- (void)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{

if (mouseJoint)
{
    b2Fixture *fixture;
    CCSprite *mySprite = (CCSprite *) fixture->GetUserData();
    NSInteger attachedSprite = mySprite.tag;
    if (attachedSprite == 1) {
        CGPoint spritePosition = mySprite.position;

        CCLOG(@"the sprite position is x:%0.2f, y:%0.2f", spritePosition.x, spritePosition.y);
        }
    world->DestroyJoint(mouseJoint);
    mouseJoint = NULL;
}
} 
```

我不断收到指向该行的 EXC_BAD_ACCESS 错误：

```
CCSprite *mySprite = (CCSprite *) fixture->GetUserData(); 
```

我不太确定出了什么问题。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:59:03.877

您收到该错误是因为夹具尚未初始化，请查看本 [教程](http://www.raywenderlich.com/606/how-to-use-box2d-for-just-collision-detection-with-cocos2d-iphone)，了解他如何遍历所有世界元素

```
for(b2Body *b = _world->GetBodyList(); b; b=b->GetNext()) {
    if (b->GetUserData() != NULL) {
        CCSprite *curSprite = (CCSprite *)b->GetUserData();
...
    }
} 
```

在执行 GetUserData() 之前，您必须为夹具分配一些东西

# c++ - WinHTTP 发送请求返回错误 12007（无法解析服务器名称）

> ID：11867129
> 
> 赞同：2
> 
> 时间：2012-08-08T14:48:25.643
> 
> 标签：c++, winhttp

我有几个用户在尝试激活我的一个程序时遇到错误，并且返回的错误代码的描述是“无法解析服务器名称”。我让 WinHTTP 尝试自动检测代理设置，但未检测到任何设置。它能够建立会话，但 WinHttpSendRequest 失败。我正在等待用户提供有关他们连接的更多信息，但我想我会在这里发布，看看是否有人能发现我的代码有什么问题。我很难找到有关 WinHTTP 代码的有用文档或示例，所以如果有人能推荐比 MSDN 更好的来源，我将永远感激不尽。

这是我初始化请求的代码：

```
WINHTTP_CURRENT_USER_IE_PROXY_CONFIG ProxyConfig;

memset(&ProxyConfig, 0, sizeof(WINHTTP_CURRENT_USER_IE_PROXY_CONFIG));

BOOL bGetProxyConfig = WinHttpGetIEProxyConfigForCurrentUser(&ProxyConfig);
if (bGetProxyConfig && ProxyConfig.lpszProxy && ProxyConfig.lpszProxyBypass)
{
    m_hHttpSession = ::WinHttpOpen(  m_strAgentName.c_str(), 
                    WINHTTP_ACCESS_TYPE_NAMED_PROXY,
                    ProxyConfig.lpszProxy, 
                    ProxyConfig.lpszProxyBypass, 0);

}
else
{
    m_hHttpSession = ::WinHttpOpen(  m_strAgentName.c_str(), 
        WINHTTP_ACCESS_TYPE_DEFAULT_PROXY,
        WINHTTP_NO_PROXY_NAME, 
        WINHTTP_NO_PROXY_BYPASS, 0);

}

if (m_hHttpSession)
{
    INTERNET_PORT nPort = INTERNET_DEFAULT_HTTPS_PORT;

    if (!m_bUseSSL)
    {
        nPort = INTERNET_DEFAULT_HTTP_PORT;
    }

    if (m_hHttpSession)
        m_hInternetConnection = ::WinHttpConnect( m_hHttpSession, m_szHostName,
                                   nPort, 0);

    if (m_hInternetConnection)
    {
        WINHTTP_AUTOPROXY_OPTIONS  AutoProxyOptions;
        WINHTTP_PROXY_INFO         ProxyInfo;
        DWORD                      cbProxyInfoSize = sizeof(ProxyInfo);

        ZeroMemory( &AutoProxyOptions, sizeof(AutoProxyOptions) );
        ZeroMemory( &ProxyInfo, sizeof(ProxyInfo) );

        // Use auto-detection because the Proxy 
        // Auto-Config URL is not known.
        AutoProxyOptions.dwFlags = WINHTTP_AUTOPROXY_AUTO_DETECT;

        // Use DHCP and DNS-based auto-detection.
        AutoProxyOptions.dwAutoDetectFlags = 
            WINHTTP_AUTO_DETECT_TYPE_DHCP |
            WINHTTP_AUTO_DETECT_TYPE_DNS_A;

        // If obtaining the PAC script requires NTLM/Negotiate
        // authentication, then automatically supply the client
        // domain credentials.
        AutoProxyOptions.fAutoLogonIfChallenged = TRUE;

        //
        // Call WinHttpGetProxyForUrl with our target URL. If 
        // auto-proxy succeeds, then set the proxy info on the 
        // request handle. If auto-proxy fails, ignore the error 
        // and attempt to send the HTTP request directly to the 
        // target server (using the default WINHTTP_ACCESS_TYPE_NO_PROXY 
        // configuration, which the requesthandle will inherit 
        // from the session).
        //

        BOOL bReturn = FALSE;

        if( WinHttpGetProxyForUrl( m_hHttpSession,
            m_strFullUrl.c_str(),
            &AutoProxyOptions,
            &ProxyInfo))
        {
            // A proxy configuration was found, set it on the
            // request handle.

            if( !WinHttpSetOption( hHttpRequest, 
                WINHTTP_OPTION_PROXY,
                &ProxyInfo,
                cbProxyInfoSize ) )
            {
                // Exit if setting the proxy info failed.
                bReturn = FALSE;
            }
            else
            {
                bReturn = TRUE;
            }
        }

        if( ProxyInfo.lpszProxy != NULL )
            GlobalFree(ProxyInfo.lpszProxy);

        if( ProxyInfo.lpszProxyBypass != NULL )
            GlobalFree( ProxyInfo.lpszProxyBypass );
    }
} 
```

# php - 使用 Ajax 插入评论内容

> ID：11867133
> 
> 赞同：0
> 
> 时间：2012-08-08T14:48:33.607
> 
> 标签：php, javascript, jquery, html, ajax

我正在尝试使用 Ajax 插入我的评论内容。但我相信我在comment_add.php 页面上遇到了问题，想知道是否有人可以帮我看看。

正如我在 firebug 中检查的那样，获取 streamid 似乎有效，但它没有显示任何内容。所以我不知道我是否错过了一些我看不到但其他人可能能够找到的东西。或者，也许我只是没有正确编写comment_add 页面。

形式

```
echo "<form id='addcomment' method='POST' class='form_statusinput'>
<input type='hidden' name='posterid' id='posterid' value='".$user1_id."'>
<input type='hidden' name='streamid' id='streamid' value='".$streamitem_data['streamitem_id']."'>
<input name='content' id='content' placeholder='Comment..' autocomplete='off'>
<input type='submit' id='button' value='Feed'>
</form>"; 
```

AJAX

```
<script>
$(document).ready(function(){
$("form#addcomment").submit(function(event) {
event.preventDefault();
var content = $("#content").val();
var streamid = $("#streamid").val();

$.ajax({
type: "POST",
url: "comment_add.php",
dataType: "json",
data: {content:content,streamid:streamid}, 
success: function(response){ 
$("#commentaddid").prepend(""+content+"");
}
});
});
});
</script> 
```

COMMENT_ADD.PHP

```
<?php
session_start();
require"include/load.php";
$user1_id=$_SESSION['id'];
if(isset($_POST['streamid'])&isset($_POST['content'])){
if($_POST['content']){
rawfeeds_user_core::add_comment($_POST['streamid'],$_POST['content']);
}
}
?> 
```

功能

```
public function add_comment($streamid,$content){
            $content =  mysql_real_escape_string($content);
            $content =  strip_tags($content);

            $content = preg_replace('/(?<!S)((http(s?):\/\/)|(www.))+([\w.1-9\&=#?\-~%;\/]+)/','<a href="http$3://$4$5">http$3://$4$5</a>', $content);

            if(strlen($content)>0){
            $insert = "INSERT INTO streamdata_comments(comment_poster, comment_streamitem, comment_datetime, comment_content) VALUES (".$_SESSION['id'].",$streamid,UTC_TIMESTAMP(),'$content')";
                        echo $insert;

            $add_post = mysql_query($insert) or die(mysql_error());
            }
            return;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:52:05.903

改变

```
success: function(response){ 
$("#commentaddid").prepend(""+content+"");
} 
```

到

```
success: function(response){ 
$("#commentaddid").prepend(""+response+"");
} 
```

因为该函数中不存在内容

和

你的链接不会`<a>`是

编辑 2 因为您想从另一端添加数据，所以这里有一个小技巧，您可以使用它来获取内容

```
$.ajax({
type: "POST",
url: "comment_add.php", 
dataType: "json",
_content:content,
data: {content:content,streamid:streamid},  
success: function(response){  
    $("#commentaddid").prepend(""+this._content+""); 
} 
}); 
```

这是可能的，因为构造函数循环遍历对象并将其设置为此

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:38:14.287

您的输入字段“内容”标记缺少**值**和**类型**属性。类型并不重要，因为它默认为文本，但总是更好地明确指定。

```
<input name="content" type="text" value="" id="content" placeholder="Comment.." autocomplete="off" /> 
```

# iphone - 顶部对齐的UILabel，使文本贴在标签视图的顶部-ios

> ID：11867135
> 
> 赞同：30
> 
> 时间：2012-08-08T14:48:35.510
> 
> 标签：iphone, objective-c, ios, xcode

有没有办法“顶部对齐”UILabel，即让文本贴在标签视图的顶部？与垂直居中对齐或浮动在视图中心相反，默认情况下？

这是三个标签的图像，左、右和居中对齐，以及一个居中和顶部对齐的 UITextView。无论视图的垂直大小如何，textView 的文本都会粘在顶部。我可以用标签做同样的事情吗？

![在此处输入图像描述](../Images/87f0691a2b3393695d62c3e8fbd110dc.png)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2014-10-29T14:08:40.050

有一个解决方法：

1.  使用常量 <=将高度和宽度设置`constraint`为您`UILabel`想要的最大高度|宽度。
2.  设置`number of lines`为零。
3.  将高度设置为`storyboard`仅适合一行。
4.  在设置`UILabel`call文本后的代码中`sizeToFit`。

这将使您`UILabel`在所需的最大宽度和高度范围内调整大小，并且文本将始终顶部对齐。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-09T01:34:51.500

我在对我的问题的评论中使用了[nevan king](https://stackoverflow.com/users/74118/nevan-king)上面链接的答案：[Vertically align text to top within a UILabel](https://stackoverflow.com/questions/1054558/vertically-align-text-within-a-uilabel/1054681#1054681)

我使用的代码在这里：

```
- (void)setUILabelTextWithVerticalAlignTop:(NSString *)theText {
    CGSize labelSize = CGSizeMake(250, 300);
    CGSize theStringSize = [theText sizeWithFont:targetLabel.font constrainedToSize:labelSize lineBreakMode:targetLabel.lineBreakMode];
    targetLabel.frame = CGRectMake(targetLabel.frame.origin.x, targetLabel.frame.origin.y, theStringSize.width, theStringSize.height);
    targetLabel.text = theText;
}

//linked to a button that sets the text from a UITextView to the label.
- (IBAction)setText:(id)sender {

    [sourceText resignFirstResponder];
    [self setUILabelTextWithVerticalAlignTop:sourceText.text];
    [targetLabel setNumberOfLines:0];
    [targetLabel sizeToFit];

} 
```

这是项目：

[owolf.net/uploads/StackOverflow/verticalAlignUILabel.zip](http://owolf.net/uploads/StackOverflow/verticalAlignUILabel.zip)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-08T14:56:13.667

`UILabel`在 iOS 中，默认情况下无法设置 a 的垂直对齐方式。相反，您将希望使用`sizeWithFont`由`NSString`. 您使用哪一个取决于您需要多行标签还是单行标签。`sizeWithFont:forWidth:lineBreakMode:`可用于单行标签，同时`sizeWithFont:constrainedToSize:lineBreakMode:`可用于多行标签。`font`您可以使用相关标签的属性轻松加载字体参数。您可以[在此处](http://developer.apple.com/library/ios/#documentation/uikit/reference/NSString_UIKit_Additions/Reference/Reference.html)查看有关使用这些功能的更多详细信息。

这些方法将`CGSize`根据`NSString`. 一旦你有正确的标签大小，你可以很容易地将它放在你的超级视图的顶部，它看起来是顶部对齐的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-03-31T06:01:52.323

我已经用 UITextView 替换了 UILabel，因为在 UITextView 中，文本贴在顶部。

只是一个建议，它可能对某人有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-22T06:43:37.490

创建一个 UILabel 的子类

.h 文件

```
@property (nonatomic, assign) UIControlContentVerticalAlignment verticalAlignment; 
```

.m 文件

```
- (void) drawTextInRect:(CGRect)rect 
{
    if(_verticalAlignment == UIControlContentVerticalAlignmentTop ||  _verticalAlignment == UIControlContentVerticalAlignmentBottom)    
    {
         // If one line, we can just use the lineHeight, faster than querying sizeThatFits
         const CGFloat height = floorf(((self.numberOfLines == 1) ? ceilf(self.font.lineHeight) : [self sizeThatFits:self.frame.size].height));
          rect.origin.y = floorf(((self.frame.size.height - height) / 2.0f) * ((_verticalAlignment == UIControlContentVerticalAlignmentTop) ? -1.0f : 1.0f));
    }
    [super drawTextInRect:rect];
}

- (void) setVerticalAlignment:(UIControlContentVerticalAlignment)newVerticalAlignment
{
     _verticalAlignment = newVerticalAlignment;
     [self setNeedsDisplay];
} 
```

我将它用于垂直对齐。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-24T10:53:43.223

对于标签高度不需要保持不变的情况，有一个简单的解决方案：将您`Label`的`Stack View`. 请务必将前导和尾随常量添加到`Stack View`. 这是如何在情节提要中执行此操作的屏幕截图：

[![在此处输入图像描述](../Images/cf73e0939530e2328097819950046c65.png)](https://i.stack.imgur.com/4v9NN.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-19T13:34:46.750

我在我的应用程序中所做的是将 UILabel 的 line 属性设置为 0，并创建底部约束`UILabel`并确保将其设置为 >= 0，如下图所示。

[![在此处输入图像描述](../Images/c3904207f557b1b165b2d968e0dbb799.png)](https://i.stack.imgur.com/GLPEY.png)

# iphone - iPhone 开发商和销售 iPhone

> ID：11867136
> 
> 赞同：-1
> 
> 时间：2012-08-08T14:48:35.967
> 
> 标签：iphone

我想出售我的 iPhone，但由于它已注册开发，因此在出售之前需要采取哪些必要步骤，这样如果买家决定越狱或其他事情不会影响我。因为我不想因为越狱而被从 ios 开发程序中删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:01:44.290

越狱你的 iPhone 不会让你失去你的开发者帐户。

只需从您的开发设备列表中删除 UDID 就足够了。由于新用户将设置设备，Appel 会将其连接到 AppleID。

# svn - 如何获取 SVN 服务器日志？

> ID：11867141
> 
> 赞同：10
> 
> 时间：2012-08-08T14:48:39.403
> 
> 标签：svn, server-side

我正在尝试找到一种获取 SVN**服务器端**日志的方法，但我只找到了使用`svn:log`. 如何获取服务器端日志？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-08-05T20:43:06.093

For SVN implementations that utilize the `svnserve` executable, it is possible to enable server-side logging by passing the `--log-file` switch when starting the daemon, e.g.:

```
# svnserve -d -r /svn --log-file=/var/log/svnserve.log 
```

This would cause the `svnserve` daemon to log to the file `/var/log/svnserve.log`.

For the sake of thoroughness, the `-d` switch runs `svnserve` in "Daemon Mode", and the `-r` switch specifies the SVN repository root.

To take my response a step further, it is possible to configure `svnserve` as a service. This ensures that `svnserve` runs on system start-up, and is terminated gracefully on system shutdown.

One method to accomplish this on Debian (and Ubuntu) systems is described at [http://odyniec.net/articles/ubuntu-subversion-server/](http://odyniec.net/articles/ubuntu-subversion-server/) , and the author provides an `initd` script that should function correctly out-of-the-box: [http://odyniec.net/articles/ubuntu-subversion-server/svnserve](http://odyniec.net/articles/ubuntu-subversion-server/svnserve)

For those who employ this script, logging can be enabled by modifying the `DAEMON_ARGS` variable on line 18 (as of this writing) to look something like:

```
DAEMON_ARGS="-d -r /svn --log-file=/var/log/svnserve.log" 
```

The service would then be started with

```
# service svnserve start 
```

and stopped with

```
# service svnserve stop 
```

The script also accepts the `restart` and `force-reload` arguments.

# xslt - 脚本标签的 XSL 转换

> ID：11867142
> 
> 赞同：0
> 
> 时间：2012-08-08T14:48:41.287
> 
> 标签：xslt

我有一个 xsl 文件，它将 html 嵌入 xml 并将其转换为 html。这不是我写的，我对 xsl 也一无所知，但我必须完成这项工作，因为它只是我工作项目的一小部分。

我发现了一个错误，它会`<script>`使用其正下方的标签呈现任何空标签。这是一个例子......

这：

```
<script type=”text/javascript” src=”…”&gt;</script>
<p>…&lt;/p> 
```

渲染成这样...

```
<script type=”text/javascript” src=”…”&gt;<p>…&lt;/p></script> 
```

这是现有的 xsl...

```
<xsl:template match="script">
    <script>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates /> 
    </script>
</xsl:template> 
```

这是整个 xsl 文件。**注意：**我在尝试一些修复时更改了脚本转换。仍然得到同样的错误......

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="p">
    <p>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates /> 
    </p>
</xsl:template>

<xsl:template match="script">
    <xsl:element name="script">
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:value-of select="." />
    </xsl:element>
</xsl:template>

    <xsl:template match="option">
    <option>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates /> 
    </option>
</xsl:template>

<xsl:template match="select">
    <select>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates /> 
    </select>
</xsl:template>

<xsl:template match="object">
    <object>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}">
                <xsl:value-of select="." />
            </xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </object>
</xsl:template>

<xsl:template match="param">
    <param>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}">
                <xsl:value-of select="." />
            </xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </param>
</xsl:template>

<xsl:template match="label">
    <label>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates /> 
    </label>
</xsl:template>

<xsl:template match="input">
    <input>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates /> 
    </input>
</xsl:template>

<xsl:template match="textarea">
    <textarea>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates /> 
    </textarea>
</xsl:template>

<xsl:template match="nbsp">
&#160;
</xsl:template>

<xsl:template match="noscript">
    <xsl:element name="noscript">
      <xsl:apply-templates />
  </xsl:element>
</xsl:template>

<xsl:template match="a">
    <a>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:for-each select="href">
            <xsl:attribute name="href"><xsl:apply-templates select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:for-each select="title">
            <xsl:attribute name="title"><xsl:apply-templates select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:for-each select="onclick">
            <xsl:attribute name="onclick"><xsl:apply-templates select="." /></xsl:attribute>
        </xsl:for-each>

        <xsl:apply-templates />

    </a>
</xsl:template>

<xsl:template match="strong">
    <strong>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </strong>
</xsl:template>

    <xsl:template match="span">
        <span>
            <xsl:for-each select="@*">
                <xsl:attribute name="{name()}">
                    <xsl:value-of select="." />
                </xsl:attribute>

                <xsl:attribute name="style">
                    <xsl:text>&#160;</xsl:text>
                </xsl:attribute>
            </xsl:for-each>

        <xsl:choose>
            <xsl:when test="string-length(.) > 0">
                <xsl:apply-templates />
            </xsl:when>
            <xsl:otherwise>
                <xsl:text>&#160;</xsl:text>
            </xsl:otherwise>
        </xsl:choose>
        </span>
    </xsl:template>

<xsl:template match="ul">
    <ul>
      <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </ul>
</xsl:template>

<xsl:template match="u">
    <u><xsl:apply-templates /></u>
</xsl:template>

<xsl:template match="ol">
    <ol><xsl:apply-templates /></ol>
</xsl:template>

<xsl:template match="li">
    <li>
      <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
  </li>
</xsl:template>

<xsl:template match="br">
  <br>  
    <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
  </br>
</xsl:template>

<xsl:template match="h1">
    <h1>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </h1>
</xsl:template>

<xsl:template match="h2">
    <h2>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </h2>
</xsl:template>

<xsl:template match="h3">
    <h3><xsl:apply-templates /></h3>
</xsl:template>

<xsl:template match="h4">
    <h4><xsl:apply-templates /></h4>
</xsl:template>

<xsl:template match="h5">
    <h5><xsl:apply-templates /></h5>
</xsl:template>

<xsl:template match="blockquote">
    <blockquote>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
  </blockquote>
</xsl:template>

<xsl:template match="img">
    <img>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
    </img>
</xsl:template>

<xsl:template match="i">
    <xsl:element name="i">
        <xsl:choose>
            <xsl:when test="string-length(.) > 0">
                <xsl:apply-templates />
            </xsl:when>
            <xsl:otherwise>
                <xsl:text>&#160;</xsl:text>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:element>
</xsl:template>

<xsl:template match="em">
    <xsl:element name="em">
        <xsl:choose>
            <xsl:when test="string-length(.) > 0 or node()">
                <xsl:apply-templates />
            </xsl:when>
            <xsl:otherwise>
                <xsl:text>&#160;</xsl:text>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:element>
</xsl:template>

<xsl:template match="div">

    <xsl:if test="@class or @id or @style or string-length(.) > 0 or node()">

        <xsl:element name="div">
            <xsl:for-each select="@*">
                <xsl:attribute name="{name()}">
                    <xsl:value-of select="." />
                </xsl:attribute>

                <xsl:attribute name="style">
                    <xsl:value-of select="." />             
                </xsl:attribute>
            </xsl:for-each>         

            <xsl:choose>
                <xsl:when test="string-length(.) > 0 or node()">
                    <xsl:apply-templates />
                </xsl:when>
                <xsl:otherwise>
                    <xsl:text>&#160;</xsl:text>
                </xsl:otherwise>
            </xsl:choose>

        </xsl:element>

    </xsl:if>

</xsl:template>

<xsl:template match="fieldset">

    <xsl:if test="@class or @id or @style or string-length(.) > 0 or node()">

        <xsl:element name="div">
            <xsl:for-each select="@*">
                <xsl:attribute name="{name()}">
                    <xsl:value-of select="." />
                </xsl:attribute>

                <xsl:attribute name="style">
                    <xsl:value-of select="." />
                </xsl:attribute>
            </xsl:for-each>

            <xsl:choose>
                <xsl:when test="string-length(.) > 0 or node()">
                    <xsl:apply-templates />
                </xsl:when>
                <xsl:otherwise>
                    <xsl:text>&#160;</xsl:text>
                </xsl:otherwise>
            </xsl:choose>

        </xsl:element>

    </xsl:if>

</xsl:template>

<xsl:template match="legend">

    <xsl:if test="@class or @id or @style or string-length(.) > 0 or node()">

        <xsl:element name="div">
            <xsl:for-each select="@*">
                <xsl:attribute name="{name()}">
                    <xsl:value-of select="." />
                </xsl:attribute>

                <xsl:attribute name="style">
                    <xsl:value-of select="." />
                </xsl:attribute>
            </xsl:for-each>

            <xsl:choose>
                <xsl:when test="string-length(.) > 0 or node()">
                    <xsl:apply-templates />
                </xsl:when>
                <xsl:otherwise>
                    <xsl:text>&#160;</xsl:text>
                </xsl:otherwise>
            </xsl:choose>

        </xsl:element>

    </xsl:if>

</xsl:template>

<xsl:template match="sup">
    <sup>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </sup>
</xsl:template>

<xsl:template match="font">
    <font>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}">
                <xsl:value-of select="." />
            </xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </font>
</xsl:template>

<xsl:template match="table">
    <table>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}">
                <xsl:value-of select="." />
            </xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </table>
</xsl:template>

<xsl:template match="tbody">
    <tbody>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}">
                <xsl:value-of select="." />
            </xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </tbody>
</xsl:template>

<xsl:template match="tr">
    <tr>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}">
                <xsl:value-of select="." />
            </xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </tr>
</xsl:template>

<xsl:template match="td">
    <td>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}">
                <xsl:value-of select="." />
            </xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </td>
</xsl:template>

<xsl:template match="b">
    <b>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}">
                <xsl:value-of select="." />
            </xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </b>
</xsl:template>

<xsl:template match="hr">
    <hr>
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}">
                <xsl:value-of select="." />
            </xsl:attribute>
        </xsl:for-each>
        <xsl:apply-templates />
    </hr>
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:30:22.383

这实际上并不能解决您的问题（我认为），但我将其作为答案给出，因为它太长而无法放入评论中......

XSLT 中有相当多的重复。许多模板似乎都遵循相同的模式。例如

```
<xsl:template match="h1"> 
    <h1> 
        <xsl:for-each select="@*"> 
            <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute> 
        </xsl:for-each> 
        <xsl:apply-templates /> 
    </h1> 
</xsl:template> 
```

在这种情况下，所做的只是复制**h1**元素，包括它的属性，然后是子元素。

在这种情况下，不需要有这么多单独的模板。可以有一个通用模板来处理这种情况。事实上，我们需要的是被称为“身份转换”的通用 XSLT 设计模式

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

它自己会照原样复制您的 XML，而无需进行任何更改。您只需要使用其他需要进行其他处理的模板对其进行扩展，而不仅仅是输出一个元素不变（例如，在**span**的模板中，有额外的处理来添加样式属性）。XSLT 将优先于更具体的模板匹配（匹配特定名称的匹配），而不是上面显示的通用模板匹配。

因此，我建议删除 XSLT 中的大多数特定模板，包括匹配**script**和**p**的模板，而只添加身份转换的通用模板匹配。事实上，您可能希望从基本的恒等变换开始，检查其是否有效，然后为需要额外处理的每种情况一次添加一个模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:15:43.220

首先，我要确保`script`模板是产生输出的模板。`class`要检查，您可以在开始`<script>`标签中添加一个虚拟属性。

也尝试`<xsl:apply-templates />`从模板中删除，使其看起来像这样；

```
<xsl:template match="script">
    <script class="dummy">
        <xsl:for-each select="@*">
            <xsl:attribute name="{name()}">
                <xsl:value-of select="."/>
            </xsl:attribute>
        </xsl:for-each>
    </script>
</xsl:template> 
```

# python - 在 500k 条记录中查找相似对象

> ID：11867143
> 
> 赞同：1
> 
> 时间：2012-08-08T14:48:42.360
> 
> 标签：python, mysql, algorithm, data-mining, bigdata

**编辑解决方案** 这是解决方案，感谢@mprivat：

```
from mysql_wrapper2 import Mysql
import Levenshtein
import time

db = Mysql()
fields = [...]

 records = db.query('SELECT *, CONCAT(%s) as `string`, SOUNDEX(CONCAT(%s)) as `soundsLike` FROM records ORDER BY `soundsLike`' % (','.join(fields), ','.join(fields)))

print len(records)

matches = []

start = time.clock()
for k,v in enumerate(records):
        if k+1 == len(records):
                break

        if Levenshtein.ratio(records[k]['string'],records[k+1]['string']) >= .98:
                matches.append((records[k],records[k+1]))

print time.clock() - start
print len(matches) 
```

**最终解决方案**

我有一个用于 Web 应用程序的 MySQL 数据库，它可能（也可能没有）有重复的记录。这些记录代表人员（即姓名、地址等）。

目前，我们有一个 python 脚本，它可以提取所有记录，将它们与带状疱疹进行比较，然后向管理用户展示潜在的重复记录。此脚本在 < 1000 条记录时效果很好。现在我们正在使用真实的数据（89k 记录）进行测试，它变得不可持续。我在 16GB 的内存使用情况下停止了脚本，我不知道它是否已完成！[虽然我看重我们的内存，但速度要重要得多，直到大约 30GB 内存——如果处理 500k 条记录]

该方法使用[pygraph](http://code.google.com/p/python-graph/)来记录数据，并使用 shingles 来查找重复项。它仍然停留在图表中——所以我假设这意味着它甚至还没有完成查看记录！

我们希望能够比较“相似”匹配，因此字段（如“St.”和“Street”）的差异不会成为唯一性的理由。我们可能不会处理简单的同义词，因此仅替换同义词不是一种选择。所以我想我们正在寻找模糊匹配。

我尝试了一些简单的解决方案，但速度不够快。

尽管在这种情况下哈希构建速度很快（当前的带状疱疹示例没有......它构建了大约 8 个小时并且没有完成），但它的比较速度是可怕的（但这是算法效率低下，而不是解释器速度）

我也一直在研究尽可能多的选择。一段时间以来，我一直坚持使用[最近邻搜索](http://scikit-learn.org/stable/modules/neighbors.html)，并承诺 DNlog(n) 搜索。

最近邻搜索有两个问题，你可能很清楚如何克服，但我一直没能做到：

1.  并非所有键都是数字的
2.  我们当前系统的限制是我们只需要一组 [K-Nearest Neighbor] 中的两个匹配项，但前提是它们是非常明确的匹配项（固定半径最近邻）

我也很幸运地使用了某种集群解决方案。我还没有找到一个可用的 python 库，其中包含可变数量的集群。我发现并且无法实施的每个解决方案都需要预先了解最终要拥有的集群数量。

1.  我们应该只在它们实际上相似时才匹配
2.  我们不知道会有多少，如果有的话。

对于#2，一旦我们有答案，我们当然可以过滤，但哪个更好？但这只有在＃1可以被克服的情况下。

由于我们正在比较的数据受到限制，我还没有能够实现 NN 或聚类解决方案，并且不得不转向普通的旧比较。这样做时，为了删除比较域的数量，我连接了所有记录的值，并对字符串与所有其他字符串进行了 Levenshtein 比较。这个解决方案也不够快。它不会在大约 20 分钟内完成一条记录（我当时停止计时）。

我想出了一个简单的例子：

```
from mysql_wrapper2 import Mysql
import Levenshtein

db = Mysql()
# Get 89k records from the database
records = db.query(""""
    SELECT *
    FROM records 
""")

# Build a dictionary where the keys are our records, and their IDs are our data
# Only passing ID, we only use about 3GB of memory, instead of 
#  > 16GB with the actual dictionaries

records_hash = {}
for i in records:
    key = []
    for k in i.values():
        key.append(str(i))
        records_hash['-'.join(key)] = i['id']

# Compare every key to every key with the Levenshtein ratio

for i in records_hash.keys():
    print 'once...'
    for j in records_hash.keys():
        if Levenshtein.ratio(i,j) >= .75:
            pass 
```

再一次，这是一个微不足道的例子，如果实际实施，将确保没有两条记录被检查两次，等等。

有什么解决办法吗？有没有一种方法可以实现 NN 或 Clustering 来解决我的问题？有没有其他我不考虑的模式可以提供帮助？我是索尔吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T14:59:00.953

我实际上并没有尝试过，您可能会发现它不起作用，但无论如何我都会分享，因为如果我遇到同样的问题，我会尝试这样做。

我会在表中添加一个新列。然后，我将浏览所有记录并执行以下操作：

1.  将名字、姓氏、地址等连接成一个字符串，我将为其计算类似 Soundex 的字符串（或根据您的需要稍作修改，例如，如果有数字，则保留数字，删除非字母数字字符，添加支持长字符串等...）

2.  然后我会计算 soundex 代码并将其存储在我的新列中

然后，假设 soundex 完成了它的工作，您可以查询记录，按 soundex 排序，然后应用您已有的比较逻辑。这个想法是只比较排序结果集中彼此附近的记录。

我所说的 soundex-like 是指与普通的 soundex 不同，后者是一个字母和三个数字。但这不适用于长字符串。可能使用三个以上的数字。

无论如何，只是想给你另一个探索的途径......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:06:46.307

据我所知，最快的方法很可能只在 MySQL 中完成。

我也必须在我的一张大表中找到所有重复项，我做了这样的事情：

```
DELETE FROM t1 
where t1.id in (SELECT clonet1.id from t1 origine, t1 clone 
    WHERE clone.id != origine.id AND clone.id > origine.id AND ... 
```

然后将 ... 替换为您的比较标准。

如果您在表中添加正确的索引，它应该足够快。

当我这样做时，我有数百万个字段要检查，但我只寻找直接的“=”。

不过，我从未见过比循环搜索更慢的简单 Where...

就像 mprivat 所说，它更多的是给你一种搜索方式，而不是一个实际的解决方案......我希望它会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:56:45.057

我意识到您说这可能不切实际，但我认为您最好以某种方式标准化您的数据，以便 St. vs street 不成问题。当然，你选择哪一个取决于你，但同时拥有这两者只会让事情变得过于复杂。

然后你可以使用布隆过滤器，假设你有很多独特的和相对较少的重复。布隆过滤器是一种概率集合数据结构，可以添加元素并测试成员资格。在测试成员资格时，它可以给出两个答案之一：“这个元素肯定不在集合中”或“这个元素几乎肯定在集合中”。这使您可以扔掉大量唯一性并将输入减少到可以在合理的内存量中使用传统算法的位置。该过程的后一阶段使事情恢复到精确性——布隆过滤器只是减少了精确算法需要考虑的输入数量。

[我在http://stromberg.dnsalias.org/~strombrg/drs-bloom-filter/](http://stromberg.dnsalias.org/~strombrg/drs-bloom-filter/)有一个 Python 的布隆过滤器实现。当然，还有其他人。

# regex - 从行尾搜索到下一行

> ID：11867145
> 
> 赞同：2
> 
> 时间：2012-08-08T14:48:46.763
> 
> 标签：regex, vim, grep, special-characters, end-of-line

我在 Unix 上使用 gvim 和 grep。

### 问题1：

我需要在 xml 文件中搜索以下模式：

```
< sample1>
< /sample1> 
```

所以问题是图案越过一条线。我是 gvim 和 grep 的新手，无法使用我的正则表达式/特殊字符知识来解决这个问题。

### 问题2：

另一个问题是，第二行的小于号 (<) 之前有空格。IE

```
< sample1>
 < /sample1> 
```

谁能建议我如何搜索这些模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:04:41.670

要在 Vim 中搜索此模式，请`/`在正常模式下使用命令：

```
/< sample>\n< \/sample1> 
```

请注意，`/`必须使用该字符对第二行上的字符进行转义`\`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:00:20.293

一种使用方式`sed`：

```
sed -n '/< sample1>/,/< \/sample1>/p' file.txt 
```

**编辑：**

如果您希望排除分隔符：

```
sed -n '/< sample1>/,/< \/sample1>/ {//!p}' file.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:13:56.877

## 维姆

你可以`\n`在 ViM 里面使用搜索模式。

### 问题1：

```
/<\ sample1>\n<\ \/sample1> 
```

### 问题2：

```
/<\ sample1>\n\ <\ \/sample1> 
```

如果您想更精确并忽略这样的情况：

```
blah blah < sample1>
 < /sample1> blah blah 
```

您可以明确要求匹配行的开头和结尾：

### 问题2：

```
/^<\ sample1>\n\ <\ \/sample1>$ 
```

如果标签前的空白数量不重要，您可以使用`\s*`

```
/^\s*<\ sample1>\n\s*<\ \/sample1>$ 
```

## grep

如果你对使用 grep 感兴趣，我有个坏消息要告诉你。grep 不做多行。但是，您可以查看[这个问题](https://stackoverflow.com/q/2686147/912144)并了解`pcregrep -M`可以解决您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:10:03.160

您只需在命令模式下键入即可搜索`< /sample1>`模式：

```
/< \/sample1> 
```

我不明白第二个问题，因为是否有空白无关紧要。只需在搜索斜杠后放置一个空格：

```
/ < \/sample1> 
```

我刚刚在 Vim 中测试过它并且它有效。希望对你有用。

干杯。

# javascript - 为什么在循环中返回时函数返回值未定义？

> ID：11867150
> 
> 赞同：3
> 
> 时间：2012-08-08T14:48:53.380
> 
> 标签：javascript, jquery

我无法弄清楚为什么会这样。

以下函数始终返回未定义。即使条件满足并且应该返回一个值。

这是 answerCollection 变量的一个实例。

```
[
Object
Answer: "2"
AnswerText: undefined
OpsID: "24"
PprID: "2"
Question: "How many colors?"
__proto__: Object
] 
```

.

```
function GetAnswerForProcessQuestion(pprID)
    {
        $.each(answerCollection, function (index, item)
        {
            var thisPprID = item["PprID"];
            if (thisPprID == pprID)
            {
                var answer = item["Answer"];
                return answer;
            }
        });
    } 
```

但是，如果我在循环内设置一个变量，然后在循环完成执行后返回该变量，则返回正确的值。

```
function GetAnswerForProcessQuestion(pprID)
    {
        var answer;
        $.each(answerCollection, function (index, item)
        {
            var thisPprID = item["PprID"];
            if (thisPprID == pprID)
            {
                answer = item["Answer"];
            }
        });
        return answer;
    } 
```

关于为什么我不能从循环内部返回值的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T14:52:06.603

从返回值`$.each`不会从父函数返回值。尝试这样做：

```
function GetAnswerForProcessQuestion(pprID)
    {
        var answer;
        $.each(answerCollection, function (index, item)
        {
            var thisPprID = item["PprID"];
            if (thisPprID == pprID)
            {
                answer = item["Answer"];
                return false; // break loop
            }
        });
        return answer;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T14:54:16.313

很简单，因为返回值在运行函数的外部或内部。我建议您使用 java-script 默认 for-each 代码：

```
function GetAnswerForProcessQuestion(pprID)
{

    for (var i in answerCollection){  // note that answerCollection must be defined
                                      // globaly or passed in
        var thisPprID = answerCollection[i]["PprID"];
        if (thisPprID == pprID) //checking if it's the value 
        {
           return answerCollection[i]["Answer"]; //if the condition is true return it
        }
    }
    return false; // if you find nothing you end up here

} 
```

函数内部定义的变量将可以访问该函数内部的任何其他函数，但不能访问外部。意义：

```
function somefunction(){
  var test='the value';
  function testing(){ alert(test); } //will alert 'the value' since the variable was
  testing();                         //defined in the functions scope

  function testing(){
                     var test=1;//the test ins now defined under the function testing()
                    }

  alert(test); //will alert 'undefined' since it was not defined in the global scope 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:09:57.073

jquery 中的 .each 不返回从您调用的函数返回的值。它分别响应`return true;`和`return false;`作为模拟`continue;`和的一种方式`break;`。此外， .each 从不​​返回值。因此，从您调用的函数返回任何其他内容将永远不会被传递。

您的第二种形式起作用的原因是由于变量范围的方式。由于该变量是在被 .each 调用包装的函数的父函数中声明的，因此它可以在函数内部访问并且可以设置。它的范围属于父级这一事实允许在该父级中读取和返回它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T14:51:22.830

您是从内部函数返回，而不是从外部函数返回。这就是外部函数返回的原因，`underfined`因为这是默认值。

您可以使用`return false;`立即结束每个循环，然后返回结果。

```
function GetAnswerForProcessQuestion(pprID)
{
    var answer;
    $.each(answerCollection, function (index, item)
    {
        var thisPprID = item["PprID"];
        if (thisPprID == pprID)
        {
            answer = item["Answer"];
            return false;
        }
    });
    return answer;
} 
```

[http://jsfiddle.net/mN5B3/](http://jsfiddle.net/mN5B3/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T14:51:42.440

$.each 是它自己的函数，注意 $.each(answerCollection, function (index, item)

你从那里回来，而不是父母。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-08T14:51:44.377

循环有一个匿名函数。当你返回时，你从那个内部函数返回并且循环继续。

您应该设置变量，然后从内部函数返回 false（这将打破每个循环），然后从外部函数返回变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-08T14:51:50.860

您在代码中的回调`$.each`定义如下：

```
function callback(index, item)
{
    var thisPprID = item["PprID"];
    if (thisPprID == pprID)
    {
        var answer = item["Answer"];
        return answer;
    }
} 
```

在函数中：

```
function GetAnswerForProcessQuestion(pprID)
{
    $.each(answerCollection, callback);
} 
```

这意味着在顶部函数中，什么也没有发生！对于每个项目，你计算一些东西，它会留在循环中。

在您的第二个代码中，您***将答案保存***到外部函数的范围内。这样，外部函数可以返回它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-08T15:00:06.643

来自[jQuery .each() 文档](http://api.jquery.com/jQuery.each/)：

> 通过使回调函数返回 false，我们可以在特定迭代中打破 $.each() 循环。返回非 false 与 for 循环中的 continue 语句相同；它将立即跳到下一次迭代。

# ruby - 无法访问 .rb 文件 (sinatra) 中函数中的变量

> ID：11867151
> 
> 赞同：0
> 
> 时间：2012-08-08T14:48:56.503
> 
> 标签：ruby, function, sinatra

现在，我的 rb 文件中有这段代码。它工作得很好：

```
project = PivotalTracker::Project.find(123456)  

get '/' do 
  @accepted = project.stories.all(:current_state => 'accepted').length
  @delivered = project.stories.all(:current_state => 'delivered').length
  @finished = project.stories.all(:current_state => 'finished').length    

  erb :home
end 
```

我想创建一个`totalStories`函数来使用，而不是使用 3 行冗长的冗余代码。

所以，我尝试了以下方法：

```
get '/' do 
  @accepted = totalStories('accepted')
  @delivered = totalStories('delivered')
  @finished = totalStories('finished')

  def totalStories(storyState)
    var estimate = project.stories.all(:current_state => storyState).length
    return var
  end

  erb :home
end 
```

使用此代码，我得到一个错误：

```
NoMethodError at /
undefined method `totalStories' for #<Sinatra::Application:0x007f89bae6c800> 
```

有关如何解决此错误的任何提示？谢谢！

**更新：** 我已将方法移到`get`块之外，但现在我收到一个新错误：`undefined local variable or method`项目'`

该`project`变量在方法之外和之上定义。

还值得注意的是，我`project`在其他 get 块中使用了该变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T07:06:30.423

改用助手：

```
get '/' do
  @accepted = total_stories('accepted') 
  @delivered = total_stories('delivered')
  @finished = total_stories('finished')

  erb :home
end

helpers do
  def total_stories(option)
    # project = PivotalTracker::Project.find(123456)
    project.stories.all(:current_state => option).length
  end
end 
```

添加@sergey 的答案，而不是上面的代码，您可以`undefined method project`通过使用该对象的帮助器来避免错误。就像是：

```
get '/' do
  # same code
end

def total_stories(option)
  project(12345).stories.all(:current_state => option).length
  # The project object here causes an error since it looks for a 
  # project method (yes, instead of object) under Sinatra's Base or Application
  # hence, we define the method inside the helpers block
end

helpers do
  def project(id)
    # Here goes the PivotalTracker find method for that particular ID.
  end

end 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T14:59:41.527

为什么不在“get”函数之外创建这个函数？

```
def totalStories(storyState)
    project.stories.all(:current_state => storyState).length
end

get '/' do 
  @accepted = totalStories('accepted')
  @delivered = totalStories('delivered')
  @finished = totalStories('finished')

  erb :home
end 
```

你也可以缩短你的 totalStories 函数，只留下一条语句，因为最后一个计算结果将被返回。

# iphone - 如何从 UILabel 创建图像？

> ID：11867152
> 
> 赞同：27
> 
> 时间：2012-08-08T14:48:57.163
> 
> 标签：iphone, objective-c, uiimage, uilabel, flatten

我目前正在iphone上开发一个简单的photoshop之类的应用程序。当我想展平我的图层时，标签的位置很好，但字体大小很差。这是我要展平的代码：

```
UIGraphicsBeginImageContext(CGSizeMake(widthDocument,widthDocument));

for (UILabel *label in arrayLabel) {
    [label drawTextInRect:label.frame];
}

UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-08-08T15:08:39.947

来自：[从 UITextView 或 UILabel 拉出 UIImage 会给出白色图像](https://stackoverflow.com/questions/2444140/pulling-an-uiimage-from-a-uitextview-or-uilabel-gives-white-image?rq=1)。

// iOS

```
- (UIImage *)grabImage {
    // Create a "canvas" (image context) to draw in.
    UIGraphicsBeginImageContextWithOptions(self.bounds.size, self.opaque, 0.0);  // high res
    // Make the CALayer to draw in our "canvas".
    [[self layer] renderInContext: UIGraphicsGetCurrentContext()];

    // Fetch an UIImage of our "canvas".
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

    // Stop the "canvas" from accepting any input.
    UIGraphicsEndImageContext();

    // Return the image.
    return image;
} 
```

// 带有用法的 Swift 扩展。在下面的评论中感谢@Heberti Almeida

```
extension UIImage {
    class func imageWithLabel(label: UILabel) -> UIImage {
        UIGraphicsBeginImageContextWithOptions(label.bounds.size, false, 0.0)
        label.layer.renderInContext(UIGraphicsGetCurrentContext()!)
        let img = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()
        return img
    }
} 
```

用法：

```
let label = UILabel(frame: CGRect(x: 0, y: 0, width: 30, height: 22))
label.text = bulletString
let image = UIImage.imageWithLabel(label) 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-11-05T13:33:34.537

我创建了一个 Swift 扩展来将其呈现`UILabel`为`UIImage`：

```
extension UIImage {
    class func imageWithLabel(label: UILabel) -> UIImage {
        UIGraphicsBeginImageContextWithOptions(label.bounds.size, false, 0.0)
        label.layer.renderInContext(UIGraphicsGetCurrentContext()!)
        let img = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()
        return img
    }
} 
```

**编辑：改进的 Swift 4 版本**

```
extension UIImage {
    class func imageWithLabel(_ label: UILabel) -> UIImage {
        UIGraphicsBeginImageContextWithOptions(label.bounds.size, false, 0)
        defer { UIGraphicsEndImageContext() }
        label.layer.render(in: UIGraphicsGetCurrentContext()!)
        return UIGraphicsGetImageFromCurrentImageContext() ?? UIImage()
    }
} 
```

用法很简单：

```
let label = UILabel(frame: CGRect(x: 0, y: 0, width: 30, height: 22))
label.text = bulletString
let image = UIImage.imageWithLabel(label) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-08T15:09:12.327

您需要在上下文中呈现标签

代替

```
[label drawTextInRect:label.frame]; 
```

和

```
[label.layer renderInContext:UIGraphicsGetCurrentContext()]; 
```

并且您需要为每个标签创建一个图像，因此将 for 循环移到 begin 和 end 上下文调用之外

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-07T08:05:05.743

对于 Swift，我使用这个 UIView 扩展：

```
// Updated for Swift 3.0
extension UIView {
    var grabbedImage:UIImage? {
        get {
            UIGraphicsBeginImageContextWithOptions(bounds.size, false, 0.0)
            layer.render(in: UIGraphicsGetCurrentContext()!)
            let img = UIGraphicsGetImageFromCurrentImageContext()
            UIGraphicsEndImageContext()
            return img
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-08T19:41:26.487

您可以在任何 CALayer 上使用 renderInContext。它将在上下文中绘制您的视图层。这样您就可以将其更改为图像。此外，如果您在 view 上执行 renderInContext ，它的所有子视图都将被绘制到上下文中。因此，在添加标签时，您可以将它们添加到 containerView 中，而不是遍历所有标签。并且只需要在该 containerView 上执行 renderInContext。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-09T14:50:02.090

```
extension UIImage {

    class func imageFrom(text: String, width: CGFloat, font: UIFont, textAlignment: NSTextAlignment, lineBreakMode: NSLineBreakMode) -> UIImage? {
        let label = UILabel(frame: CGRect(x: 0, y: 0, width: width, height: CGFloat.greatestFiniteMagnitude))
        label.text = text
        label.font = font
        label.textAlignment = textAlignment
        label.lineBreakMode = lineBreakMode

        label.sizeToFit()

        UIGraphicsBeginImageContextWithOptions(label.bounds.size, false, 0.0)
        label.layer.render(in: UIGraphicsGetCurrentContext()!)
        let img = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()
        return img
    }

} 
```

使用：

```
 let iv = UIImageView(image: UIImage.imageFrom(text: "Test For \nYarik", width: 537.0, font: UIFont.systemFont(ofSize: 30), textAlignment: .center, lineBreakMode: .byWordWrapping))
    iv.contentMode = .scaleAspectFit 
```

# android - 防止用户杀死 Android 上的应用程序

> ID：11867157
> 
> 赞同：5
> 
> 时间：2012-08-08T14:49:07.673
> 
> 标签：android

我试图弄清楚如何防止用户使用强制停止杀死应用程序。我试图检测用户何时打开设置-应用程序-管理应用程序等活动并尝试强制停止受保护的应用程序。还有一些任务管理器应用程序允许您终止进程。

我知道这在 Android 中是可能的，因为 AppLock 或 Super AppLock 等应用程序可以做到这一点。我只是找不到有关如何执行此操作的任何信息。

现在我正在尝试轮询 ActivityManager.RunningTaskInfo 以检测受限制的活动，但是由于它们在不同的设备上具有不同的名称，因此效果不佳。

有更好的方法吗？AppLock 和类似的应用程序如何实现此功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:00:34.913

已经提出并回答了[非常相似且相关的问题。](https://stackoverflow.com/questions/9477606/disabling-force-stop-button-in-android)

长话短说，**不，你不能**阻止用户或操作系统因为内存管理而杀死你的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T17:24:06.560

我想我想通了。

使用 ActivityManager.getRunningTasks() 函数似乎是最好的解决方案。然后你只需要每次顶部任务是“com.android.settings.applications.RunningServiceDetails”或“com.android.settings.applications.InstalledAppDetails”时弹出一个Activity（带有pin码）。

不幸的是，无法查看用户是否试图杀死受保护的应用程序或其他应用程序，因此访问权限仅限于所有这些应用程序。

市场上也有一堆任务管理器使用 ActivityManager.killBackgroundProcesses() 方法来杀死进程，但您可以通过使用警报来使应用程序起死回生。

# android - android创建自定义主题

> ID：11867160
> 
> 赞同：0
> 
> 时间：2012-08-08T14:49:09.683
> 
> 标签：android, themes

我想扩展默认的android AppTheme。我应该在这里写什么而不是 android:Theme？

```
<style name="CustomTheme" parent="android:Theme"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:58:04.963

实际上，您要用作父主题的主题的名称。

```
<style name="CustomTheme" parent="android:Theme.Light">
<style name="CustomTheme" parent="android:Theme.Black">
<style name="CustomTheme" parent="android:Theme.NoTitleBar">
<style name="CustomTheme" parent="android:Theme.Holo.Light">
<style name="CustomTheme" parent="android:Theme.Holo.Light.Dialog"> 
```

等等

使用在图形布局中出现的名称（在 Eclipse 中）： ![检查这个菜单](../Images/6d4a69865334d4d1712604e452e2db23.png)

此外，当然，[Android 参考是您最好的朋友](http://developer.android.com/intl/es/guide/topics/ui/themes.html "并不总是有据可查，但无论如何")

# python - 寻找二项式系数模素数，面试街头挑战

> ID：11867162
> 
> 赞同：5
> 
> 时间：2012-08-08T14:49:15.283
> 
> 标签：python, algorithm, primes, largenumber, binomial-coefficients

我在这方面做了很多工作，但找不到更大的测试用例的答案

# 问题陈述

在数学中，二项式系数是一系列正整数，在二项式定理中作为系数出现。C(n,k) 表示从 n 个不同对象中选择 k 个对象的方法的数量。

但是当n和k太大的时候，我们经常在对一个素数P进行模运算后保存。请计算n有多少个二项式系数在对P进行模运算后变为0。

## 输入

第一个输入是一个整数 T ，即测试用例的数量。

以下 T 行中的每一行都包含 2 个整数，n 和素数 P。

## 输出

对于每个测试用例，输出一行包含 \tbinom nks (0<=k<=n) 的数量，每个在 P 的模运算后为 0。

## 样本输入

```
3
2 2
3 2
4 3 
```

## 样本输出

```
1
0
1 
```

## 约束：

*   T 小于 100
*   n 小于 10^500。
*   P 小于 10^9。

# 尝试的解决方案

我通过在二项式系数中使用余数定理完成了这个

```
 #C(n,m) mod p
         #n=l*p+t
         #m=m*p+s
         #then C(n,r) mod p=0 when (t<s or t=0)

         inp1 = raw_input()
         N=int(inp1)
         result=[]
         for i in range(N):
            inp = raw_input()
            a, b = [long(x) for x in inp.split(' ')]
           j=0
           #n=lp+t
           t=a%b
           t=t+1
           l=a/b
           j=l*(b-t)
           result.append(j)
        for i in range(N):
           print result[i] 
```

小数满足上述条件

样本测试用例

> n=18794630773460178101742670493883191390743597826923079533199667903991430393463990462500322752062869664969026409174076912867222446746310051635510258172105034070506806228555577773599018819952185016092141574603857551738968553782672643049704163674318579695215402562964641111900657274032612661770435202254364177910753450214277150377049334509093906874400306682949871260040370515062243982543271073443613028133844603853807066311479739789908983610180228625059956919930500586048799830730348503994503184106117058

p= 177080341

我的输出是

> 2296508200406431043037217853758906667313789305876262916681342008001095232916608835588093082038358975456171743147798282523487485386336553910277635713985851142371010771392102277877640275384064735398164190968282400640398659343189330639672472613876688344609533340662724884373078840434716174167873375700938597411315754265893890741730938202927739246687866166994143001482839656000969674716959277820008958538229366474207686428750934149471409162993083541475267772950721250234982686128039722553219836725588488

预期输出是

> 18794630773460178101742635959946548665553041135822283621364103266511586625905046107130878283695016799933475657268010472422112556606280021574002866456544310584537519228161286450725015989697306855581489155139723025246780552510467580791551824827637581156204185887378181074365453150481221030356075255000460025095384537510111086396988416046942446776262625161326885418101128327416784858513888616089287333560469336094431461981368825028447505354473183546488856594449627370807707483671453574074503184106117059

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-10T21:46:13.957

你可以从另一端来看：有多少*不能*`nCr`被整除？有一个相当简单的公式。*`p`*

 *### 预赛：

二项式系数`nCr`由下式给出

```
nCr = n! / (r! * (n-r)!) 
```

所以 in 的多重性`v_p(nCr)`- in 的主要因式分解的指数- 是`p``nCr``p``nCr`

```
v_p(nCr) = v_p(n!) - v_p(r!) - v_p((n-r)!) 
```

`p`in的重数`n!`可以很容易地确定，一种众所周知的计算方法是

```
v_p(n!) =  ∑ floor(n/p^k)
         k > 0 
```

如果考虑这个公式的基数`p`扩展`n`，你可以看到

```
v_p(n!) = (n - σ_p(n)) / (p - 1) 
```

其中是 的基本表示`σ_p(k)`的数字之和。因此`p``k`

```
v_p(nCr) = (n - σ_p(n) - r + σ_p(r) - (n-r) + σ_p(n-r)) / (p - 1)
         = (σ_p(r) + σ_p(n-r) - σ_p(n)) / (p - 1) 
```

### 结论：

`nCr`*不能*被素数整除`p`当且仅当加`r`和`n-r`没有进位`p`。

因为那正是`σ_p(a + b) = σ_p(a) + σ_p(b)`. 当 和 的对应数字之`a`和`b`（如果已经为较低有效数字产生进位，则可能加上进位）`>= p`为`p`数字加 1，数字和减少`p - 1`.

如果对于 的基数扩展中的每个数字，对应的数字小于或等于 ，我们`n = r + (n-r)`在基数中有一个无进位加法。的数字的允许选择是独立的，因此总数是单个数字的选择计数的乘积。`p``d_k``n``p``r``d_k``r`

`nCr`不能被素数整除的个数`p`是

```
ND(n,p) = ∏(d_k + 1) 
```

其中是的基本扩展`d_k`中的数字，`n``p`

```
 m
n = ∑ d_k * p^k
   k=0 
```

由于给定的 有`n+1`（非零）二项式系数，因此可被整除的（非零）二项式系数的数量为`nCr``n``nCr``p`

```
 m
n + 1 - ∏ (d_k + 1)
       k=0 
```

与上述基数`p`展开`n`。

使用[迈克尔的](https://stackoverflow.com/a/11877334/1011995) 例子`n = 10`，，`p = 3`

```
10 = 1*3^0 + 0*3^1 + 1*3^2 
```

所以有些`(1+1)*(0+1)*(1+1) = 4`系数`10Cr`不能被 3`10 + 1 - 4 = 7`整除，也不能被 3 整除。

```
def divisibleCoefficients(n,p):
    m, nondiv = n, 1
    while m > 0:
        nondiv = nondiv * ((m % p) + 1)
        m = m // p
    return (n + 1 - nondiv) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T05:35:30.723

你的公式已经关闭了。

您正在计算 l * (p - t - 1)。

如果存在 p^2、p^3 等因子，则此公式不起作用。当 l > p 时（如果 m > p 也可能）会发生这种情况。

对于小数字，尝试 n = 10, p = 3 看看我在说什么。您的计算将返回 3 个 r 值，其中 10 C r mod 3 = 0，但实际上有 7 个。*

# jbpm - 带有 jboss 5.1 的 Web 应用程序中的 jbpm5

> ID：11867164
> 
> 赞同：0
> 
> 时间：2012-08-08T14:49:20.927
> 
> 标签：jbpm

我在没有使用jboss的情况下在eclipse中测试了一个简单的工作流示例（当然是通过在Eclipse中配置jbpm5使其支持jbpm5）

现在我想测试在服务器 jboss 5.1 中运行的 JEE 应用程序（Web 应用程序）中的示例工作流

我在 web 应用程序的源文件夹下制作了这个文件：sample.bpmn，我在下制作了 ProcessMain.java

src\com\sample

ProcessMain.java的源代码

```
package com.sample;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.naming.Context;
import javax.naming.InitialContext;

import org.apache.commons.collections.map.HashedMap;
import org.drools.KnowledgeBase;
import org.drools.builder.KnowledgeBuilder;
import org.drools.builder.KnowledgeBuilderFactory;
import org.drools.builder.ResourceType;
import org.drools.io.ResourceFactory;
import org.drools.runtime.StatefulKnowledgeSession;

import com.esprit.ConsoftEJB.daos.RequestDaoRemote;
import com.esprit.ConsoftEJB.daos.UserDaoRemote;
import com.esprit.ConsoftEJB.persistence.Request;

/**
 * This is a sample file to launch a process.
 */
public class ProcessMain {

    private RequestDaoRemote  reqService ;

    private List<Request> requests=new ArrayList<Request>();
public ProcessMain() {
    // TODO Auto-generated constructor stub

}   

public List<Request> getAllRequest()
{
    try {
        Context context=new InitialContext();
        setReqService((RequestDaoRemote) context.lookup("erq"));

    } catch (Exception e) {
        e.printStackTrace();
    }
    return requests=reqService.lisAll();
}

    public static final void main(String[] args) throws Exception {

        validation();

    }

        public static void validation()
        {
            int state=0;
            KnowledgeBase kbase = null;
            try {
                kbase = readKnowledgeBase();
            } catch (Exception e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            StatefulKnowledgeSession ksession = kbase.newStatefulKnowledgeSession();
            // start a new process instance
            ProcessMain p=new ProcessMain();
            List<Request> listreq=  p.getAllRequest();
            for (int i = 0; i < listreq.size(); i++) {
                state=Integer.parseInt(listreq.get(i).getState());
            System.err.println(listreq.get(i).getState());  
            Map<String,Object> param=new HashMap<String,Object>();
            param.put("etat",state);

            ksession.startProcess("com.sample.bpmn.hello",param);

        }

            }

    private static KnowledgeBase readKnowledgeBase() throws Exception {
        KnowledgeBuilder kbuilder = KnowledgeBuilderFactory.newKnowledgeBuilder();
        kbuilder.add(ResourceFactory.newClassPathResource("sample.bpmn"), ResourceType.BPMN2);
        return kbuilder.newKnowledgeBase();
    }
    public RequestDaoRemote getReqService() {
        return reqService;
    }
    public void setReqService(RequestDaoRemote reqService) {
        this.reqService = reqService;
    }

    public List<Request> getRequests() {
        return requests;
    }

    public void setRequests(List<Request> requests) {
        this.requests = requests;
    }

} 
```

我测试这个类，她在控制台模式下显示正确的结果

（在 sample.bpmn 文件中设置）

但是当我在使用来自java类ProcessMain.java的方法验证的网页（jsp页面）中制作了一个按钮时

显示此错误

```
java.lang.ClassNotFoundException: org.drools.builder.KnowledgeBuilderFactory from BaseClassLoader@2cfe4f04{VFSClassLoaderPolicy@6bf5a6af{name=vfsfile:/C:/serveur/jboss-5.1.0.GA/jboss-5.1.0.GA/server/default/deploy/ProjetVrai.war/ domain=ClassLoaderDomain@1cd0437b{name=vfsfile:/C:/serveur/jboss-5.1.0.GA/jboss-5.1.0.GA/server/default/deploy/ProjetVrai.war/ parentPolicy=AFTER_BUT_JAVA_BEFORE parent=ClassLoaderDomain@23b87cc4{DefaultDomain}} roots=[MemoryContextHandler@1284661896[path= context=vfsmemory://5hs4j5g-ahljra-h4wsmcy7-1-h4wsw19q-9y real=vfsmemory://5hs4j5g-ahljra-h4wsmcy7-1-h4wsw19q-9y], FileHandler@367317037[path=ProjetVrai.war/WEB-INF/classes context=file:/C:/serveur/jboss-5.1.0.GA/jboss-5.1.0.GA/server/default/deploy/ real=file:/C:/serveur/jboss-5.1.0.GA/jboss-5.1.0.GA/server/default/deploy/ProjetVrai.war/WEB-INF/classes/], DelegatingHandler@511899134[path=ProjetVrai.war/WEB-INF/lib/commons-beanutils.jar context=file:/C:/serveur/jboss-5.1.0.GA/jboss-5.1.0.GA/server/default/deploy/ real=file:/C:/serveur/jboss-5.1.0.GA/jboss-5.1.0.GA/server/default/deploy/ProjetVrai.war/WEB-INF/lib/commons-beanutils.jar], DelegatingHandler@669255256[path=ProjetVrai.war/WEB-INF/lib/commons-collections.jar context=file:/C:/serveur/jboss-5.1.0.GA/jboss-5.1.0.GA/server/default/deploy/ real=file:/C:/serveur/jboss-5.1.0.GA/jboss-5.1.0.GA/server/default/deploy/ProjetVrai.war/WEB-INF/lib/commons-collections.jar], 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T14:16:34.890

因此，显然您的 EE 环境中缺少一个类。确保在你的战争中你有 drools-compiler- *.jar 和 jbpm-flow* .jar 你能否请提及你正在使用哪个版本的 JBPM？

# javascript - 正则表达式上的重音符号有什么用？

> ID：11867165
> 
> 赞同：0
> 
> 时间：2012-08-08T14:49:25.293
> 
> 标签：javascript, regex, diacritics

我不知道为什么要使用重音符号！你能解释一下吗？例子：

```
/^(https?:\/\/)?(www\.)?([a-zA-Z0-9_\-]+)+\.([a-zA-Z]{2,4})(?:\.([a-zA-Z]{2,4}))?\/?(.*)$/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T14:52:19.070

如果你的意思是`^`它是一个位置标记。它在字符串的开头匹配。

相应地，`$`匹配字符串的末尾。

例如

```
^. 
```

匹配第`a`一个`archipelago`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T14:53:11.037

为什么不查看文档？你在这里：[http ://www.regular-expressions.info/reference.html](http://www.regular-expressions.info/reference.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:18:26.270

在这种情况下，它意味着*字符串的开始*。

例如 /ran/ 匹配伊朗语，但 /^ran/ 不匹配。

但在其他情况下，这意味着*不是*。阅读正则表达式。有很多很好的资源。

# postgresql - Postsgresql 外部联接未按预期工作

> ID：11867170
> 
> 赞同：3
> 
> 时间：2012-08-08T14:49:30.833
> 
> 标签：postgresql, outer-join

一个看似简单的查询，我无法完成......

两张桌子的房间和可用性

```
Room         [id, title, beds]
Availability [room_id, date, bed_delta] 
```

一个房间有一个固定的最大可用床数。可用性描述`Room.beds`了修改（向上或向下）的时间段。

我正在尝试构建一个查询，对于给定的房间和给定的开始日期和持续时间，将汇总可用床位。

例如：

*   房间 1 通常有 2 张床
*   1小时，占用1张床
*   预期结果为 1

如果添加与此日期时间范围重叠的另一个可用时间段并将床位进一步减少 1，则预期结果为 0。

感觉像是一个相对简单的查询：

*   LEFT OUTER JOIN Room to Availability on room_id
*   按日期约束
*   选择 Room.beds - sum(Availability.bed_delta)

IE

```
SELECT r.beds - coalesce(sum(a.bed_delta), 0) as beds_free
FROM room r
LEFT OUTER JOIN availability a ON (r.id = a.room_id)
WHERE date = '2012-01-01 09:00:00+01:00'
AND r.id = 2
GROUP BY r.id; 
```

此查询仅在 中存在匹配行时返回`availability`。我期望的是 id == 2 的房间只有一行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T15:10:24.877

问题是您的`WHERE`条款的这一部分：

```
WHERE date = '2012-01-01 09:00:00+01:00' 
```

外连接仅“允许”*连接条件*（此处为`r.id = a.room_id`）失败的行；该子句中对右侧表施加的其他约束`WHERE`仍然可以从结果中排除整行。是的，这很棘手。

解决方案：将`date`约束移动到连接条件中：

```
LEFT OUTER JOIN availability a ON (r.id = a.room_id AND date = '2012-01-01 09:00:00+01:00') 
```

（是的，令人惊讶的是，您可以在其中添加任意条件，并且正如您现在发现的那样，（对于外部连接）这可能是必要的！）

或者，您可以使用相关子查询来查找与感兴趣的所有`Availability`记录匹配的总和`Room`：

```
SELECT r.beds - coalesce((
    SELECT sum(a.bed_delta)
    FROM availability a
    WHERE a.room_id = r.id
    AND date = '2012-01-01 09:00:00+01:00'
), 0) as beds_free
FROM room r
WHERE r.id = 2; 
```

我发现子查询比外连接更容易理解`GROUP`，但是 YMMV。

# mysql - 如何在没有子选择的情况下限制从 LEFT JOIN 返回的结果数量？

> ID：11867172
> 
> 赞同：1
> 
> 时间：2012-08-08T14:49:34.833
> 
> 标签：mysql, sql

我有以下查询，但它从 profile_photos 表中返回多个条目。是否可以从个人资料照片表中仅返回一个**随机**条目？如果不是随机的，是否可以将结果数限制为 1？

这是我当前的查询：

```
$sql = "SELECT * FROM login_users " .
       "LEFT JOIN profile_photos ON profile_photos.user_id = login_users.user_id " .
       "LEFT JOIN profiles ON profiles.user_id = login_users.user_id " .
       "WHERE login_users.restricted <> 1 " .
       "ORDER BY login_users.birthdate DESC " .
       "LIMIT 0, 20"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T14:55:33.717

这是一种方法。查找随机照片，然后加入附加信息：

```
SELECT *
FROM (select lu.*,
             (select photo_id
              from profile_photos
              where lu.user_id = profile_photos.user_id
              order by RAND()
              limit 1
             ) as photo_id
      from login_users lu
     ) lu LEFT JOIN
     profile_photos pp
     ON pp.photo_id = lu.photo_id LEFT JOIN
     profiles p
     ON p.user_id = lu.user_id 
WHERE lu.restricted <> 1
ORDER BY lu.birthdate DESC
LIMIT 0, 20 
```

这假设 photo_id 是 profile_photos 上的主键。

# lua - 在游戏中按顺序收集物品（Corona SDK）

> ID：11867177
> 
> 赞同：0
> 
> 时间：2012-08-08T14:49:54.063
> 
> 标签：lua, coronasdk

我正在创建一个游戏，玩家必须收集硬币才能获得更高的分数。有 3 个硬币，当您收集一个时，它会显示在 UI 的“硬币栏”上。硬币有 3 个空洞（就像在割绳子和其他游戏中一样）。目前，当玩家收集第二枚硬币时，将填满条中的第二个孔。我希望按顺序填充孔，以便收集没有收集到第一个硬币的第二个硬币将填充第一个孔。

这是代码：

> ------金币吧
> 
> ```
>  local coin_bar = {}
>     for i=1,3 do
>         coin_bar[i] = display.newImage ("coin_bar.png", 57, 57)
>     end
> 
>     coin_bar[1].x = 325 
>     coin_bar[1].y = 37
>     coin_bar[2].x = 385 
>     coin_bar[2].y = 37
>     coin_bar[3].x = 445 
>     coin_bar[3].y = 37 
> ```
> 
> --添加硬币和处理
> 
> ```
>  local coinSprites=grabber.grabSheet("starAnim")
>     local coinGroup = display.newGroup()
>     local coins = {}
>     isLiving = {}
>     for i=1,3 do
>         isLiving[i] = 1
>         coins[i] = coinSprites:grabSprite("",true,{ starAnim={1,6,200,0}})
>         coins[i]:playClip("starAnim")
>         coinGroup:insert(coins[i])
>     end
> 
>     local function coinCollect(event)
>         for i=1, 3 do -- Nr of Coins
>             coin_clear = false
>             if isLiving[i] == 1 then
>                 if ball.x > coins[i].x -40 and ball.x < coins[i].x +40
>                 and  ball.y > coins[i].y -40 and ball.y < coins[i].y +40 then
>                 coins[i]:removeSelf()
>                 coins[i] = nil
>                 coins[i] = display.newImage ("coin_bar_collected.png", 57, 57)
>                 coins[i].x = coin_bar[i].x
>                 coins[i].y = coin_bar[i].y
>                 isLiving[i] = 0
>                 end
>             end
>         end
>     end
> 
>     Runtime:addEventListener( "enterFrame", coinCollect ) 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T14:47:02.983

Why not add a collected property to coin bar that tracks the last used position and use that? Ie:

```
local coin_bar = {collected = 0}

...

local function coinCollect(event)
    for i=1, 3 do -- Nr of Coins
        coin_clear = false
        if isLiving[i] == 1 then
            if ball.x > coins[i].x -40 and ball.x < coins[i].x +40
            and  ball.y > coins[i].y -40 and ball.y < coins[i].y +40 then
            coins[i]:removeSelf()
            coins[i] = nil
            coins[i] = display.newImage ("coin_bar_collected.png", 57, 57)
            local bar_index = coin_bar.collected + 1
            coins[i].x = coin_bar[bar_index].x
            coins[i].y = coin_bar[bar_index].y
            coin_bar.collected = bar_index
            isLiving[i] = 0
            end
        end
    end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T13:25:58.920

尝试用这个替换硬币栏中的所有东西：

```
------Coin Bar

local coin_bar = {}
for i=1,3 do
    coin_bar[i] = display.newImage ("coin_bar.png", 325+(i*60), 37)
end 
```

看看能不能解决你的问题。

# excel - Matlab和Excel之间的actxserver通信

> ID：11867179
> 
> 赞同：0
> 
> 时间：2012-08-08T14:49:55.733
> 
> 标签：excel, matlab, activex

我有一个现有的（打开的和空的）文件“D:\api.xlsx”，需要从 Matlab 与它通信。首先，我尝试从 A1:B2 读取值，并插入新值：

```
excelapp = actxserver('Excel.Application');
wkbk = excelapp.Workbooks;
wdata = wkbk.Open('D:\api.xlsx');
sheet = wdata.ActiveSheet;
range = sheet.get('Range', 'A1:B2');
range.Value
ans = 

    [NaN]    [NaN]
    [NaN]    [NaN]

range.Value = magic(2);
>> range.Value

ans = 

    [1]    [3]
    [4]    [2] 
```

但是我没有看到excel中的变化。范围 A1:B2 保持为空。同样，当我手动将新值插入 excel 时，`range.Value`返回旧值。

所以，有两个问题：

1.  如何将值插入从 Matlab 打开的 excel 文件中，以便新值立即可见？

2.  如何进入 Matlab 更新的（来自 Excel）值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:38:25.347

`actxserver`将创建一个新的、不可见的 Excel 副本，然后您需要将文件加载到该副本中，并明确地使其可见（您已经发现了这一点，正如您自己的答案所表明的那样）。

或者，如果您已经在 Excel 中打开了文件，则可以使用`actxGetRunningServer`连接到已预加载文件的 Excel 运行副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:20:52.333

这解决了两个问题：

```
excelapp.Visible = 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:33:41.700

没有 ActiveSheet.get 功能，尝试使用

```
range = sheet.Range("A1:B2") 
```

然后阅读，你应该可以打电话

```
range.Value 
```

或者

```
range.Text 
```

# mysql - MySQL 将附加字段的值设置为 auto_increment 值

> ID：11867180
> 
> 赞同：0
> 
> 时间：2012-08-08T14:49:55.860
> 
> 标签：mysql, sql

我有一个带有 的表`AUTO_INCREMENT id`，这个表也有一个`parent_id`字段。在某些情况下，当插入数据本身是父级并且没有父级时，我需要将其设置`parent_id`为与其自己的 id 相同的值。

这可能与单个 sql 语句，还是我必须做`LAST_INSERT_ID`一个单独的更新语句？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:05:16.593

这在技术上是可行的，尽管我强烈反对它。这个查询可以工作的唯一方法是，如果你能保证不会删除任何记录，即使我仍然说不要使用它。但如果你必须...

```
INSERT INTO `table` (field1, field2, parent_id)
VALUES('data1', 'data2', 
            (SELECT id FROM (SELECT max(id) AS id FROM `table`) AS a) + 1
       ) 
```

不过，您最好在 2 个查询中执行此操作。理性是人工智能的工作方式。如果最后一条记录是 20 并被删除，则下一个条目将是 21，但 parent_id 将是 20，因为它将看到`max(id)`19。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:07:45.713

是的你可以。要获取表的下一个 auto_increment 值，您可以执行以下操作：

```
SELECT AUTO_INCREMENT 
FROM information_schema.TABLES 
WHERE table_name='table_name' 
AND table_schema='schema_name'; 
```

不要使用`MAX`，因为如果你从表中删除最后一行并计算最大值，它不会给你下一个 auto_increment 值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T14:56:55.587

你必须在单独的语句中做。

树系统通常假定“0”为根或无父项的父项或一级项的父项，而“0”在数据库中不存在。

我建议您不要将 item 的 id 设置为该 item 的 parent，因为...这个 item 是他自己的父亲？你真的需要那个吗？

# ios - iOS 委托不使用 UIViewControllers

> ID：11867181
> 
> 赞同：1
> 
> 时间：2012-08-08T14:50:05.047
> 
> 标签：ios, delegates

我有 2 个 UIViewControllers、GameController 和 RhythmController。我像这样在**RhythmController.h**中定义了 RhythmDelegate 。RhythmController 中的 doEndGame 方法应该调用 GameController gameOver 中的委托方法，它实现了委托协议。

我不明白为什么这不起作用......我的代码有错误吗？提前感谢您的帮助。

```
@class RhythmView,RhythmDelegate, RhythmController;

@protocol RhythmDelegate
@required
-(void)gameOver:(RhythmController*)aRhythmController;
@end

@interface RhythmController : UIViewController <UIGestureRecognizerDelegate, UIAlertViewDelegate> {
.....

}

@property (nonatomic, retain) IBOutlet NSObject<RhythmDelegate>* delegate; 
```

在 RhythmController.m 中，我的委托调用如下：

```
@implementation RhythmController
@synthesize delegate;

-(void)doEndGame{

isPaused = true;
[delegate gameOver:self];
} 
```

我确认 doEndGame 被调用，里面有一个断点。但是，它没有转到我在 GameController 中想要的方法，它实现了委托。

```
#import <UIKit/UIKit.h>
#import "CoinsController.h"
#import "CoinsGame.h"
#import "HighscoreController.h"
#import "RhythmController.h"
#import "RhythmView.h"

@interface GameController : UIViewController <RhythmDelegate> {

IBOutlet UIView *landscapePlayView;
IBOutlet UIView *landscapeGameHolderView;
IBOutlet UIView *portraitPlayView;
IBOutlet UIView *portraitGameHolderView;
IBOutlet UIView *loadingView;
IBOutlet UIView *welcomeView;
IBOutlet UIButton *continueButton;
IBOutlet UIView *aboutView;
IBOutlet UIView *playView;
IBOutlet UIView *rhythmView;
//IBOutlet UIView *levelSelectView;
IBOutlet UILabel *musicNotation;
IBOutlet CoinsController *coinsController;
IBOutlet RhythmController *rhythmController;

IBOutletCollection(UILabel) NSArray *remainingTurnsLabels;
IBOutletCollection(UILabel) NSArray *scoreLabels;
IBOutlet HighscoreController *highscoreController;

CoinsGame* previousGame;
BOOL isPlayingGame;
}
-(void)setPreviousGame:(CoinsGame*)aCoinsGame;
-(CoinsGame*)currentGame;

- (IBAction)continueGameClicked:(id)sender;
- (IBAction)newGameClicked:(id)sender;
- (IBAction)highScoresClicked:(id)sender;
- (IBAction)aboutClicked:(id)sender;
- (IBAction)aboutDoneClicked:(id)sender;
- (IBAction)highscoreDoneClicked:(id)sender;

-(void)loadImages;
-(void)showPlayView: (UIInterfaceOrientation)interfaceOrientation;
-(void)doPause; 

@end 
```

在 GameController.m 中，方法是

```
// RhythmDelegate Tasks
-(void)gameOver:(RhythmController*)aRhythmController{

NSLog(@"Came into gameOver delegated task"); 
[self.view addSubview: welcomeView];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T14:58:13.963

检查您的委托变量是否在您的断点处为零。如果是，那么您忘记设置委托。

创建 RhythmController 后，您可以在 gamecontroller 的 viewdidload 方法中轻松设置它：

```
rythmcontroller.delegate = self; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T14:58:02.450

您可能忘记将`GameController`实例设置为`RhythmController`的委托。简单地为委托实现协议并不能神奇地建立委托连接。你在某处需要这样的一行：

```
myRhythmController.delegate = myGameController; 
```

注意：委托通常是`weak`引用，或者是`assign`属性。这是为了防止委托对象和原始对象之间的保留循环

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T14:58:10.623

你是不是忘记给节奏控制器实例设置委托属性了？

如果你已经创建了代码，你会做这样的事情：

```
rhythmController = [[RhythmController alloc] init];
rhythemController.delegate = self;
...
[rhythmController release]; 
```

其中“self”是 GameController 实例。

# arrays - 不区分大小写的关联数组键

> ID：11867187
> 
> 赞同：2
> 
> 时间：2012-08-08T14:50:16.127
> 
> 标签：arrays, lua, case

我正在使用 Lua 中的关联数组/表。我想将不区分大小写的用户输入与表中区分大小写的键进行比较。

前任：

```
table = { ["HellO"] = "world" }
user_input = "hello"
table_entry = table[user_input] 
```

如果可能的话，我希望上面的示例以存储在 table_entry 中的“world”结尾。

但是，我真的很想避免遍历整个表（这会很大）并将 string.lower(key) 与 string.lower(user_input) 进行比较。

此外，我无法控制表的创建，因此我无法仅使用小写/大写键创建它。

任何反馈表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:12:21.397

也许创建另一个表，将键的小写版本映射到原始表中的（可能是 0、1 或更多）混合大小写键。然后小写用户输入并在新表中查找。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T21:42:47.130

你没有说你打算对冲突做什么（原始表包含`'hello'`和`'Hello'`，具有不同的值。

您不会说原始表是否会更新或是否已修复。如果要更新而您无法拦截更新，那您就完蛋了，因为您永远不知道真相会是什么。

一些想法：

*   如果原始表永远不会被更新，那么您可以制作一个“影子”表，它使用原始表的键被粉碎为小写：

    ```
    shadow = { }
    for k, v in pairs(original) do shadow[k:lower()] = v end 
    ```

    使用`shadow[userkey:lower()]`.

*   如果要更新原始表，但大多数键都会命中，您可以构建一个大小写映射，将等效的混合大小写提供给任何小写：

    ```
    mixed = { }
    for k in pairs(original) do mixed[k:lower()] = k end 
    ```

    查找使用`original[mixed[userkey:lower()]]`（仅当`mixed[...]`不为零时）。

    在这种情况下，如果您获得了一个好的密钥，即使值已更改，您也会被设置。但是，如果您丢失了钥匙，您将不得不做一些昂贵的事情。（除非您可以拦截更新。）

如果原始表超出了您的控制范围*，并且*您无法检测到它何时更新，那么您就真的搞砸了。在这种情况下，我会尝试插入一个空表并使用`__index`和`__newindex`元方法来记录更新。这会增加开销，但仍然比线性搜索便宜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T18:08:32.723

> 我无法控制表的创建，所以我不能只用小写/大写键创建它。

然后你必须至少遍历一次。这是一个哈希表；没有办法让不同的字符串散列到相同的值（不改变 Lua 的核心）。

如果内存不是问题，您可以进行一次遍历以创建新的查找表。如果内存是个问题，您每次都必须遍历整个表。

或者找到某种方法来控制该表的创建。:)

# java - 如何在不使用 super 关键字的情况下使用子类对象调用超类覆盖方法？

> ID：11867189
> 
> 赞同：2
> 
> 时间：2012-08-08T14:50:25.063
> 
> 标签：java

我可以用java中的子类对象调用父类覆盖的方法吗？

> 我试过下面的例子
> 
> ```
> class First1
>  {
>    void show()
>     {
>     String msg="You are in first class";
>     System.out.println(msg);
>     }
>  }   
>  class second extends First1  
>  {  
>    void show()  
>    {  
>    String msg="You are in second class";  
>    System.out.println(msg);          }  
>    }  
>  }
>  class CallingMethod extends second  
>  {  
>    void show()  
>    {  
>     String msg="You are in the third class";  
>     System.out.println(msg);  
>    }  
>     public static void main(String[] args)  
>     {  
>     CallingMethod cm=new CallingMethod();  
>     cm.show();  
>     } 
> ```
> 
> }

现在告诉我是否可以打印“我在二等舱”。通过使用 CallingMethod 类的对象，即示例中的 cm，并且在任何地方都没有使用 super 关键字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T14:56:54.233

我假设您的意思是从子类外部调用该方法。

那么不，在java中不可能，因为被覆盖的方法意味着改变了对新类有意义的行为。

在类内部，无论如何您都将使用 super 关键字。

注意：使用反射你可以对对象做一些语言本身不允许的事情。

注意：我使用反射对此进行了测试，它不起作用。但是当您将 C 与 JNI 一起使用时，您也许可以做到这一点......

```
//does not work
class YourClass
{
    public static void main(String[] args) throws SecurityException,
            NoSuchMethodException, IllegalArgumentException,
            IllegalAccessException, InvocationTargetException
    {
        CallingMethod cm = new CallingMethod();
        First1 f = new First1();
        // Method m = First1.class.getDeclaredMethod("show");
        Method m = First1.class.getMethod("show");
        m.invoke(f);
                    //output: You are in first class
        m.invoke(cm);
                    //output: You are in the third class
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:06:43.417

也许你想要这样的东西：

```
class A
    method()
class B extends A
    method()
class C extends B
    method()
    {
        //call A.method()
    } 
```

这在 Java 中也是不可能的。您只能调用直接超类的方法。你总是需要使用

```
super 
```

编辑：这就是为什么：

```
class A
{
  private int positionA;
  void move()
  {
    positionA++;
  }
  int getPosition()
  {
    return positionA;
  }
}
class B
{
  private int positionB;

  void move()
  {
    positionB++;
  }
  int getPosition()
  {
    return positionB;
  }
}
A a = new A()
B b = new B() 
```

如果你跑

```
b.move() 
```

然后 positionB 增加。你会从调用 getPosition() 中得到你期望的结果。

如果你能跑

```
A.move() 
```

在 b

它会增加位置A。因此调用 b.getPosition() 不会返回正确的位置。

如果你有

```
Class C extends B 
```

如果你可以打电话，你会绕过 B 的 move()

```
A.move() 
```

上

```
this. 
```

这和课外的问题一样。您的类会表现得很奇怪，这就是 Java 开发人员不允许它的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T14:57:12.777

是的，这里有一个示例覆盖方法：

[http://www.cs.umd.edu/~clin/MoreJava/Objects/overriding.html](http://www.cs.umd.edu/~clin/MoreJava/Objects/overriding.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:01:24.040

`super.overriddenMethod()`只要您在子类本身内部调用它，您就可以使用它。

# python - 如何使用 Python 在文本文件中使用正则表达式搜索不区分大小写的字符串和（R）

> ID：11867191
> 
> 赞同：0
> 
> 时间：2012-08-08T14:50:26.937
> 
> 标签：python

我在文本文件中有一个名为“Micro(R) Windows explorer”的字符串 如何搜索不区分大小写和 (R) 也匹配使用正则表达式代码是

```
with open(logfile) as inf:
            for line in inf:
                if re.search(string,line,re.IGNORECASE):
                    print 'found line',line 
```

但是这个字符串“Micro(R) Windows explorer”不接受给出错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:54:20.487

对于不区分大小写的搜索，请使用该选项启动您的正则表达式`(?i)`或编译它。`re.I`

要匹配`(R)`，请使用正则表达式`\(R\)`。否则，括号将被解释为正则表达式元字符（表示捕获组），并且只有字符串`"MicroR Windows Explorer"`会被它匹配。

一起：

```
with open(logfile) as inf:
    regex = re.compile(r"Micro\(R\) Windows Explorer", re.I)
    for line in inf:
        if regex.search(line):
             print 'found line',line 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T14:55:27.370

没有正则表达式：

```
with open('C:/path/to/file.txt','r') as f:
    for line in f:
        if 'micro(r) windows explorer' in line.lower():
            print(line) 
```

# java - 谷歌应用引擎中的 Getkey() 返回 id

> ID：11867194
> 
> 赞同：1
> 
> 时间：2012-08-08T14:50:29.823
> 
> 标签：java, google-app-engine

我的数据存储表名为 document，其结构如下：Key、Write Ops、ID/Name、html、name。样本数据为：

```
Key: aglub19hcHBfaWRyDgsSCGRvY3VtZW50GAEM 
Write Ops:6
ID/Name:1
html:"<div>something</div>
name: "Untitled name" 
```

其中前三列由 Google App Engine 创建。我使用以下代码从数据存储中获取实体：

```
int PAGE_SIZE = 20;
DatastoreService datastore = DatastoreServiceFactory.getDatastoreService();
PreparedQuery queryString = datastore.prepare(new Query("document"));
int rowCount = queryString.countEntities();
int offset = 0;
//fetch results from datastore based on offset and page size
FetchOptions fetchOptions = FetchOptions.Builder.withLimit(PAGE_SIZE);
QueryResultList<Entity> results = queryString.asQueryResultList(fetchOptions .offset(offset)); 
```

当我尝试使用 .getKey() 方法从实体中检索 Key 列时，会出现问题。它不是从 Key 列返回随机字符串，而是返回 document("1)。有没有办法从结果数组中获取 Keys？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T14:55:00.597

密钥不是“随机字符串”。它是 Key 对象的字符串编码。

我使用 Python API 而不是 Java API，但在 Python 中，您可以简单地调用`str()`Key 实例来获取编码版本。在 Java 中，您可能可以使用`key.toString()`，或者您可能需要以某种方式对其进行序列化。

# iis-7 - IIS 负载平衡脚本

> ID：11867197
> 
> 赞同：0
> 
> 时间：2012-08-08T14:50:43.427
> 
> 标签：iis-7, load-balancing, windows-server-2008-r2, dynamics-ax-2009

我最近在几台托管 IIS 的服务器上设置了 Windows NLB Custering。我听说可以通过脚本控制每台服务器的“健康”状态 - 即，而不是依赖于窗口的内部定义哪些服务器具有最多的空闲容量/最少的负载，而是通过比较相对驱动来做出这个决定服务器的健康值，由脚本生成。也就是说，我找不到此类脚本的任何示例/有关如何实现此目的的任何说明。

*   这可能吗，还是我无意中听到了一个神话？
*   您知道有关如何设置的任何示例脚本和说明吗？

更多信息：

我正在使用 MS Dynamics AX 2009。目前，工作流 Web 服务托管在单个服务器上。为了消除这个单点故障，我想设置负载平衡，在服务器健康的情况下共享负载，如果服务器出现故障，请求会继续无缝发送到实时服务器，直到原始服务器出现重新联机，请求可以再次路由到两者。

我目前不知道我希望运行状况检查脚本检查什么的确切细节。一旦我知道这是否可能，我将开始试验，查看可用的选项（即，我是否通过调用托管在同一站点上的测试服务来使用简单的 IIS 是否可用测试/只需检查内存和 cpu 使用情况和相应地平衡/切换每个请求的默认服务器 - 避免离线服务器）。在这个阶段，虽然我只关心在处理细节之前这是否可能。

提前致谢。

JB

*   视窗服务器 2008 R2
*   IIS 7.5
*   动态 AX 2009 SP1 R8

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T15:36:29.817

用于负载平衡服务器的 powershell 选项允许您更改服务器的权重和优先级。但是，我发现即使在关闭关联、将权重设置为 99:1 并尝试将优先级设置为 1:2（然后是 2:1，以防我弄错了）之后，负载平衡似乎也能按预期工作对于第一个请求，则表现得好像为来自同一台机器的任何剩余请求启用了亲和性。我怀疑在很多情况下这是所需的行为，但在我的情况下并非如此（因为该服务只有一个客户端 - 专用 ax aos 批处理服务器）。

我的新解决方案是使用 F5 负载均衡器的动态循环算法（https://devcentral.f5.com/weblogs/dmacvittie/archive/2009/03/31/intro-to-load-balancing-for-developers-ndash -the-algorithms.aspx) 来分配负载，以及来自 F5 的 HTTP GET 请求以确保 Web 服务启动并运行。感谢我们的网络工程师及时从远程站点返回工作，为我指明了正确的方向。

# java - 是在 esb 内还是在 esb 外部署 Web Service

> ID：11867200
> 
> 赞同：1
> 
> 时间：2012-08-08T14:50:48.083
> 
> 标签：java, web-services, soa, esb

我正在构建一个基于休息（有些可能是基于肥皂）并将由外部代理调用的 Web 服务。代理是我们网络之外的任何软件。

我正在考虑两种选择

i) 在 esb 外部的容器上运行 Web 服务，并从 fuse esb 向外界公开一个码头端点。

ii) 在 esb 容器中运行 web 服务。

我想知道在 ESB 内或 esb 外部署 Web 服务的优缺点是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-23T19:11:00.523

这个问题特定于 Fuse ESB。Fuse 容器能够托管中介路由以及 Web 服务本身。如果你正在开发基于 OSGI 的 Web 服务，你也可以将服务部署在 Fuse 容器上。

如果负载不高，路由和 Web 服务可以托管在同一个物理容器上。在所有情况下，理想的做法是为路由和 Web 服务提供单独的捆绑包。为集成而暴露的部分成为它的 ESB 部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:44:23.030

我从未听说过使用`ESB`.

`ESB`通常用作实现各种**非功能属性**（安全、中介、转换）的中介**。**

 **`ESB`可以实现一些**功能属性**（例如消息丰富），但完全在`ESB`听起来像是不必要的`ESB`和`Webservice Application Server`角色耦合的范围内实现业务逻辑。这两个角色应该分开，以使两者的利益最大化。**

# javascript - 在 Chrome 扩展中同步 IndexedDB 的解决方案

> ID：11867204
> 
> 赞同：1
> 
> 时间：2012-08-08T14:51:13.453
> 
> 标签：javascript, google-chrome-extension, indexeddb

我开发了一个 chrome 扩展，它使用 IndexedDB 在本地保存数据。我想添加一个功能来在多台计算机之间同步数据。你能建议我一个解决方案吗？谢谢

**编辑**：我不维护任何服务器，也不收集任何用户的私人信息。该扩展基本上是来自免费第三方的数据的混搭。因此，如果我的用户对计算机 A 中的数据进行了任何更改，它也应该反映在计算机 B 或设备 C 中（以供将来的 todo 支持:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T17:28:25.660

这是一个[很好的答案](https://stackoverflow.com/a/7933140/366114)，它解释了如何建立浏览器到浏览器（点对点）的连接。

其他解决方案是制作某种服务器端应用程序，允许用户将数据存储在您的服务器或某些第三方存储设备上，然后再将数据检索到其他计算机。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T18:15:40.580

**更新：**根据您的编辑，我相信 Deni Mf 先生的链接是让点对点工作的一个很好的指针。但我相信该技术还不能用于一般用途，你可能会更好地与服务器同步，甚至可能是第三方允许你这样做（Amazon S3 和/或类似服务）。Chrome 已经内置了一些同步服务 -[如何在不同的计算机上同步 Chrome 扩展数据？](https://stackoverflow.com/questions/4901024/how-to-synchronize-chrome-extension-data-on-different-computers)- 但是您只能将其用于少量数据，因此实际上这些只能是指向其他地方托管的真实数据的指针。

**原答案如下：**

有几个方面你需要弄清楚。首先，当您说“多台计算机”时，这是否意味着多台计算机与同一组服务器通信，或者您实际上是指点对点意义上的多台计算机（每台计算机既是客户端又是服务器） .

其次，你需要一个同步机制和协议。如果一切都很好，每个人都被信任，没有真正的秘密和运行你至少有几个挑战；在某种私有网络上，您很可能会使用像 CouchDB 或类似的东西，它们开箱即用（但一旦您尝试向数据添加身份验证和授权就变得具有挑战性）。如果没有，你需要自己动手。

假设您有客户端与一组特定的服务器（使用 HTTP 或类似服务器）进行通信，并且假设您不能使用 CouchDB 或类似服务器（出于上一段中所述的原因），那么自己动手并不难。由于可以在任何客户端或服务器上创建数据库行（或类似行），因此使用传统的串行整数主键很可能不值得，并且您需要使用 UUID 或类似的唯一键（因此每台机器都可以创建自己的- 假定唯一 - 任何对象的键）。为包含“更新”时间戳（创建或更新对象时）的每一行添加至少一列，并添加包含最后一个同步时间戳的另一个数据库。每当客户端连接时，向服务器询问自上次连接以来的任何更新，并将自上次连接后在本地创建的任何更新发送给服务器。删除行之类的事情有点棘手，因为已删除的行没有“更新”时间戳，因此请考虑为每行添加一个简单的“已删除”标志以使事情变得更简单。

这至少应该足以让你继续前进。

# entity-framework - 实体框架：在代码优先 TPH 层次结构中建立关系表

> ID：11867205
> 
> 赞同：0
> 
> 时间：2012-08-08T14:51:21.133
> 
> 标签：entity-framework, ef-code-first, entity-framework-4.3

我正在 TPH 系统中建立一系列相关对象之间的关系。

```
public abstract class Box
{
    public Box()
    {
        Boxes = new HashSet<Box>();
        Descriptors = new HashSet<Descriptor>();
    }

    public Guid Id { get; set; }

    public virtual ICollection<Box> Boxes { get; set; }
    public virtual ICollection<Descriptor> Descriptors { get; set; }
} 
```

这个基类由例如 3 个单独的子类扩展

```
public class Item: Box
{
    public Sample()
    {
        Events = new HashSet<Event>();
        Phones = new HashSet<Phone>();
    }

    public virtual ICollection<Phone> Phones { get; private set; }
    public virtual ICollection<Event> Events{ get; private set; }
}

public class Phone : Box {}

public class Event: Box
{
    public Item { get; private set; }
} 
```

使用 TPH，它似乎是在 Box 表中设置关系，而不是创建外部关系表来关联 Item、Phone 和 Event 对象。我找不到一个很好的例子来说明这个映射的样子。

# android - Android 开发 - 带有 sqlite、listview、edittext 和按钮的搜索界面

> ID：11867208
> 
> 赞同：0
> 
> 时间：2012-08-08T14:51:42.067
> 
> 标签：android, sqlite, listview, filter, android-edittext

我是 android 开发的新手，我真的需要一些帮助。

在按下“搜索”按钮后，我只想在基于 EditText 输入的 Sqlite 数据库中进行查询，并在 Listview 中缩短结果。

我已经完成了错误，但是当按下按钮时列表视图没有显示出来。

这是我的代码：

```
btnSearch.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {   
            //Here is my SimpleCursorAdapter; 
            dataSource = new SimpleCursorAdapter(context, R.layout.consulta_grupos_lihas, helper.Busca(someString), campos, new int[] {R.ConsultaGruposLinhas.txvCodigo, R.ConsultaGruposLinhas.txvDescricao});
            //And so i set the Adapter
            listview.setAdapter(dataSource); 
        }
    }); 
```

所以 helper.Busca(someString) （在我的数据库类中）是我用来进行查询的方式

```
public Cursor Busca (String search) {
    String sql = "grup_descricao LIKE '% "+ search +" %'";
    return this.mDb.query("grupos", new String [] {"_id", "grup_descricao", "grup_datacad"}, sql, null, null, null, null);
} 
```

如果有人可以帮助我，我将不胜感激。非常感谢您的关注。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-08T19:39:20.877

我意识到这是一个 sql 语法错误。我正在使用 LIKE 语句，它是这样的：“LIKE '%' something '%'”。但是当我删除“某物”周围的空格时，它就起作用了！

# delphi - 如何在表单上放置半透明层

> ID：11867215
> 
> 赞同：11
> 
> 时间：2012-08-08T14:51:59.133
> 
> 标签：delphi, transparency

上周左右，我在 stackoverflow 上阅读了一些关于此的问题。

我的要求或多或少是一样的。

我需要在表单顶部放置一个半透明层，但此表单可能还有其他几个组件：列表、编辑、标签、图像等

我需要这个半透明层在这一切之上。

这个想法是淡化表格中那些不使用或无法访问的区域。

我使用德尔福 2007。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-10T06:56:30.450

这是一个使用 alpha 混合透明 TForm 作为渐变阴影的演示应用程序。此示例与 Andreas 示例的主要区别在于此代码处理嵌套控件并且不使用任何窗口区域。

![普通的](../Images/da399c34d53d54c6c45283e1e13bf289.png)

![阴影](../Images/7f24c4d6c330808b1e58e017a05b732c.png)

MainForm.pas：

```
unit MainForm;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics,
  Controls, Forms, Dialogs, StdCtrls, ExtCtrls, Shadow;

type
  TShadowTestForm = class(TForm)
    Button1: TButton;
    Button2: TButton;
    Panel1: TPanel;
    Button3: TButton;
    Button4: TButton;
    Panel2: TPanel;
    Button5: TButton;
    procedure Button1Click(Sender: TObject);
    procedure FormResize(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
    procedure Button5Click(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
  private
    { Private declarations }
    Shadow: TShadowForm;
    procedure WMMove(var Message: TWMMove); message WM_MOVE;
  public
    { Public declarations }
  end;

var
  ShadowTestForm: TShadowTestForm;

implementation

{$R *.dfm}

procedure TShadowTestForm.Button1Click(Sender: TObject);
begin
  if not Assigned(Shadow) then
  begin
    Shadow := TShadowForm.CreateShadow(Self);
    Shadow.UpdateShadow;
    Button1.Caption := 'Hide Shadow';
    Button4.Caption := 'Show Modal Form';
  end else
  begin
    FreeAndNil(Shadow);
    Button1.Caption := 'Show Shadow';
    Button4.Caption := 'Test Click';
  end;
end;

procedure TShadowTestForm.Button2Click(Sender: TObject);
begin
  ShowMessage('clicked ' + TControl(Sender).Name);
end;

procedure TShadowTestForm.Button4Click(Sender: TObject);
var
  tmpFrm: TForm;
begin
  if Assigned(Shadow) then
  begin
    tmpFrm := TShadowTestForm.Create(nil);
    try
      tmpFrm.ShowModal;
    finally
      tmpFrm.Free;
    end;
  end else
    Button2Click(Sender);
end;

procedure TShadowTestForm.Button5Click(Sender: TObject);
begin
  TShadowTestForm.Create(Self).Show;
end;

procedure TShadowTestForm.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  if not (fsModal in FormState) then
    Action := caFree;
end;

procedure TShadowTestForm.FormResize(Sender: TObject);
begin
  if Assigned(Shadow) then Shadow.UpdateShadow;
end;

procedure TShadowTestForm.WMMove(var Message: TWMMove);
begin
  inherited;
  if Assigned(Shadow) then Shadow.UpdateShadow;
end;

end. 
```

MainForm.dfm：

```
object ShadowTestForm: TShadowTestForm
  Left = 0
  Top = 0
  Caption = 'Shadow Test Form'
  ClientHeight = 243
  ClientWidth = 527
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  PopupMode = pmExplicit
  Position = poScreenCenter
  OnClose = FormClose
  OnResize = FormResize
  PixelsPerInch = 96
  TextHeight = 13
  object Button1: TButton
    Tag = 1
    Left = 320
    Top = 192
    Width = 97
    Height = 25
    Caption = 'Show Shadow'
    TabOrder = 0
    OnClick = Button1Click
  end
  object Button2: TButton
    Left = 64
    Top = 56
    Width = 75
    Height = 25
    Caption = 'Test Click'
    TabOrder = 1
    OnClick = Button2Click
  end
  object Panel1: TPanel
    Left = 192
    Top = 40
    Width = 289
    Height = 105
    Caption = 'Panel1'
    TabOrder = 2
    object Button3: TButton
      Left = 24
      Top = 16
      Width = 75
      Height = 25
      Caption = 'Test Click'
      TabOrder = 0
      OnClick = Button2Click
    end
    object Button4: TButton
      Tag = 1
      Left = 72
      Top = 72
      Width = 129
      Height = 25
      Caption = 'Test Click'
      TabOrder = 1
      OnClick = Button4Click
    end
  end
  object Panel2: TPanel
    Tag = 1
    Left = 24
    Top = 151
    Width = 233
    Height = 84
    Caption = 'Panel2'
    TabOrder = 3
    object Button5: TButton
      Tag = 1
      Left = 22
      Top = 48
      Width = 155
      Height = 25
      Caption = 'Show NonModal Form'
      TabOrder = 0
      OnClick = Button5Click
    end
  end
end 
```

影子.pas：

```
unit Shadow;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics,
  Controls, Forms, Dialogs;

type
  TShadowForm = class(TForm)
  private
    { Private declarations }
    FBmp: TBitmap;
    procedure FillControlRect(Control: TControl);
    procedure FillControlRects(Control: TWinControl);
  protected
    procedure Paint; override;
    procedure WMMouseActivate(var Message: TWMMouseActivate); message WM_MOUSEACTIVATE;
    procedure WMDisplayChange(var Message: TMessage); message WM_DISPLAYCHANGE;
  public
    { Public declarations }
    constructor CreateShadow(AForm: TForm);
    destructor Destroy; override;
    procedure UpdateShadow;
  end;

implementation

{$R *.dfm}

constructor TShadowForm.CreateShadow(AForm: TForm);
begin
  inherited Create(AForm);
  PopupParent := AForm;
  FBmp := TBitmap.Create;
  FBmp.PixelFormat := pf24bit;
end;

destructor TShadowForm.Destroy;
begin
  FBmp.Free;
  inherited;
end;

procedure TShadowForm.Paint;
begin
  Canvas.Draw(0, 0, FBmp);
end;

procedure TShadowForm.FillControlRect(Control: TControl);
var
  I: Integer;
  R: TRect;
begin
  if Control.Tag = 1 then
  begin
    R := Control.BoundsRect;
    MapWindowPoints(Control.Parent.Handle, PopupParent.Handle, R, 2);
    FBmp.Canvas.FillRect(R);
  end;
  if Control is TWinControl then
    FillControlRects(TWinControl(Control));
end;

procedure TShadowForm.FillControlRects(Control: TWinControl);
var
  I: Integer;
begin
  for I := 0 to Control.ControlCount-1 do
    FillControlRect(Control.Controls[I]);
end;

procedure TShadowForm.UpdateShadow;
var
  Pt: TPoint;
  R: TRect;
begin
  Pt := PopupParent.ClientOrigin;
  R := PopupParent.ClientRect;

  FBmp.Width := R.Right - R.Left;
  FBmp.Height := R.Bottom - R.Top;

  FBmp.Canvas.Brush.Color := clSkyBlue;
  FBmp.Canvas.FillRect(Rect(0, 0, FBmp.Width, FBmp.Height));

  FBmp.Canvas.Brush.Color := TransparentColorValue;
  FillControlRects(PopupParent);

  SetBounds(Pt.X, Pt.Y, FBmp.Width, FBmp.Height);
  if Showing then
    Invalidate
  else
    ShowWindow(Handle, SW_SHOWNOACTIVATE);
end;

procedure TShadowForm.WMDisplayChange(var Message: TMessage);
begin
  inherited;
  UpdateShadow;
end;

procedure TShadowForm.WMMouseActivate(var Message: TWMMouseActivate);
begin
  Message.Result := MA_NOACTIVATE;
end;

end. 
```

Shadow.dfm：

```
object ShadowForm: TShadowForm
  Left = 0
  Top = 0
  Cursor = crNo
  AlphaBlend = True
  AlphaBlendValue = 128
  BorderStyle = bsNone
  Caption = 'Shadow'
  ClientHeight = 281
  ClientWidth = 543
  Color = clBtnFace
  TransparentColor = True
  TransparentColorValue = clFuchsia
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  PopupMode = pmExplicit
  Position = poDesigned
  PixelsPerInch = 96
  TextHeight = 13
end 
```

ShadowDemo.dpr：

```
program ShadowDemo;

uses
  Forms,
  ShadowTestForm in 'MainForm.pas' {ShadowTestForm},
  Shadow in 'Shadow.pas' {ShadowForm};

{$R *.res}

begin
  Application.Initialize;
  Application.MainFormOnTaskbar := True;
  Application.CreateForm(TShadowTestForm, ShadowTestForm);
  Application.Run;
end. 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-08T15:25:46.357

创建一个新的 VCL 项目。向主窗体添加一些示例按钮和其他控件。创建一个*新*表单，设置`AlphaBlend`为`true`和`AlphaBlendValue`。`128`也许`Color = clSkyBlue`就足够了？然后将以下过程添加到您的主窗体中：

```
procedure TForm1.UpdateShadow;
var
  pnt: TPoint;
  rgn, rgnCtrl: HRGN;
  i: Integer;
begin
  if not Assigned(Form2) then Exit;
  Form2.Show;
  pnt := ClientToScreen(Point(0, 0));
  Form2.SetBounds(pnt.X, pnt.Y, ClientWidth, ClientHeight);
  rgn := CreateRectRgn(0, 0, Form2.Width, Form2.Height);
  for i := 0 to ControlCount - 1 do
    if Controls[i].Tag = 1 then
    begin
      if not (Controls[i] is TWinControl) then Continue;
      with Controls[i] do
        rgnCtrl := CreateRectRgn(Left, Top, Left+Width, Top+Height);
      CombineRgn(rgn, rgn, rgnCtrl, RGN_DIFF);
      DeleteObject(rgnCtrl);
    end;
    SetWindowRgn(Form2.Handle, rgn, true);
    DeleteObject(rgn);
end; 
```

并在调整大小时调用它，

```
procedure TForm1.FormResize(Sender: TObject);
begin
  UpdateShadow;
end; 
```

和形式移动：

```
procedure TForm1.WMMove(var Message: TWMMove);
begin
  inherited;
  UpdateShadow;
end; 
```

最后，将`Tag`要`1`访问的控件（在主窗体上）设置为 。

[![示例截图](../Images/ad0828f6b6aca17cc624444f52677e2a.png)](https://i.stack.imgur.com/IJmtv.png)
[（来源：[rejbrand.se](http://privat.rejbrand.se/shadowWithHoles.png)）]

**提示：**您可能还希望将`Cursor`'shadow form' 设置为`crNo`。

# java - 列表应该如何转换为它们的具体实现？

> ID：11867217
> 
> 赞同：2
> 
> 时间：2012-08-08T14:52:01.257
> 
> 标签：java

假设我正在使用一个我不知道源代码的库。它有一个返回 List 的方法，如下所示：

```
public List<SomeObj> getObjs() { ... } 
```

我想知道这是否是个好主意：

```
ArrayList<SomeObj> objs = (ArrayList<SomeObj>) getObjs(); 
```

例如，如果 getObjs() 中 List 的具体实现是 a`LinkedList`那么不会存在某种类型的差异吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T14:53:27.677

不，这不是一个好主意。您应该始终使用 interface( `List`) 来声明您的列表变量，除非您出于某种原因需要来自`ArrayList`.
此外，如果您这样做，您需要确定返回的列表是一个`ArrayList`. 在这种情况下，承诺的契约`getObjs()`只是返回类型是某种`List`，所以你不应该假设其他任何东西。即使`List`现在返回的是`ArrayList`，也没有什么可以阻止实现者`getObjs()`稍后更改`List`返回的类型，这会破坏您的代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T14:55:10.127

转换为您正在调用的 API 定义的返回类型。

如果它说它返回 a `List<SomeObj>`，那么就是这样。不要尝试检索基础类型，因为：

a) 它可能随新版本而变化（甚至在调用之间）

b) 你不需要知道任何东西的实现类。

如果你**需要**一个 ArrayList，那么做`new ArrayList<SomeObject)(getObjs());`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-08T14:54:04.263

使用接口（列表）的全部意义在于隐藏实现细节。为什么要将其转换为特定的实现？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-08T14:53:38.303

你是对的。这不是一个好主意。您需要使用它返回的界面表单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-08T14:54:33.873

如果你向下转换为 ArrayList 而实际上它是一个 LinkedList，它会抛出一个 ClassCastException。一般来说，像这样向下转换从来都不是一个好主意，特别是如果您没有编写返回要向下转换的对象的代码。另外，如果您使用这样的 3rd 方库，他们可能会在改进代码时更改返回给您的内容。如果您在代码中进行这样的向下转换，它今天可能会起作用，但是当您升级库时，它会突然中断。它在运行时而不是编译时中断，所以在你运行它之前你不会知道它的损坏。这是您违反图书馆与您签订的合同的问题，该合同仅使用 List 接口。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-08T14:56:11.393

它返回 a的*原因*`List`是您不必关心该接口的底层是什么。

该`List`接口仅声明对象必须满足的契约，以及您如何查询它。图书馆作者将来可以自由选择一个`ArrayList`，a `LinkedList`，或者也许是a `LazyDatabasePopulatedList`。事实上，根据提供类的实现方式，您可能会在运行时获得不同的实现。

只要您有要遵守的合同，这就会为您带来很多自由。仅仅谈论和提供接口，以及尽可能少地处理具体的类，有很多话要说。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-08T14:57:10.983

您应该始终使用界面代替`Handle`. 这就是`OOP`Languages 的重点，以便您以后可以在任何实现之间切换。

如果您正在转换为任何具体类，编译器将警告您`Cast`可能发生异常的可能性。`SuppressWarning`如果您非常确定类型，则可以使用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-08T14:58:17.270

这不是一个好主意，因为您不知道该方法返回什么实现；如果它不是一个`ArrayList`，你会得到一个`ClassCastException`。事实上，您不应该关心该方法返回的确切实现。请改用`List`界面。

如果出于某种原因，您绝对需要一个`ArrayList`，然后创建您自己的并使用该方法返回的`ArrayList`初始化它：`List`

```
ArrayList<SomeObj> myOwnList = new ArrayList(getObjs()); 
```

但是不要这样做，除非你*绝对*需要`ArrayList`- 因为它效率低下。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-08-08T14:59:41.857

你为什么不这样做：

```
List<SomeObj> objs = getObjs(); 
```

然后使用该列表。如果由于某种原因你真的需要一个 ArrayList，你总是可以这样做

```
ArrayList<SomeObj> arrayList = new ArrayList<SomeObj>();
arrayList.addAll(objs); 
```

并与之合作。虽然这不是很有效。

# excel - 如何在 Excel 中显示正在运行的时钟？

> ID：11867225
> 
> 赞同：3
> 
> 时间：2012-08-08T14:52:23.907
> 
> 标签：excel, vba

我想在 Excel 2007 的单元格 A1 中显示一个时钟。我熟悉 NOW() 和 TODAY() 但它不会像我想要的那样每 1 分钟刷新一次。你知道，就像一个运行时钟。我只希望 h:mm 中的当前时间在单元格 A1 中。这可能吗？

从这个时钟开始，我将进行进一步的计算，例如自从我上次进行活动 X、Y 和 Z 以来已经过了多长时间。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T15:29:41.887

找到了我在上面的评论中提到的[代码。](http://www.vbforums.com/showthread.php?555880-Creating-Splash-Screen-in-MS-Office-2003)要对其进行测试，请执行以下操作：

1.  `Sheet1`更改say的单元格高度和宽度，如`A1`下面的快照所示。
2.  通过右键单击单元格来格式化单元格以显示时间格式
3.  在工作表上添加两个按钮（表单控件）并将它们命名为快照所示
4.  将此代码粘贴到模块中
5.  右键单击工作`Start Timer`表上的按钮，然后单击`Assign Macros`。选择`StartTimer`宏。
6.  右键单击工作`End Timer`表上的按钮，然后单击`Assign Macros`。选择`EndTimer`宏。

现在单击**Start Timer**按钮，您将在 cell 中看到时间得到更新`A1`。要停止时间更新，请单击**结束计时器**按钮。

**代码**

```
Public Declare Function SetTimer Lib "user32" ( _
ByVal HWnd As Long, ByVal nIDEvent As Long, _
ByVal uElapse As Long, ByVal lpTimerFunc As Long) As Long

Public Declare Function KillTimer Lib "user32" ( _
ByVal HWnd As Long, ByVal nIDEvent As Long) As Long

Public TimerID As Long, TimerSeconds As Single, tim As Boolean
Dim Counter As Long

'~~> Start Timer
Sub StartTimer()
    '~~ Set the timer for 1 second
    TimerSeconds = 1
    TimerID = SetTimer(0&, 0&, TimerSeconds * 1000&, AddressOf TimerProc)
End Sub

'~~> End Timer
Sub EndTimer()
    On Error Resume Next
    KillTimer 0&, TimerID
End Sub

Sub TimerProc(ByVal HWnd As Long, ByVal uMsg As Long, _
ByVal nIDEvent As Long, ByVal dwTimer As Long)
    '~~> Update value in Sheet 1
    Sheet1.Range("A1").Value = Time
End Sub 
```

**快照**

![在此处输入图像描述](../Images/173039087454012bd1c1b46282c60059.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-08T15:26:43.937

请参阅下面的代码（[取自这篇文章](https://stackoverflow.com/questions/2319683/vba-macro-on-timer-style-to-run-code-every-set-number-of-seconds-i-e-120-secon)）

将此代码放在 VBA 的模块中（开发人员选项卡 - > Visual Basic）

```
Dim TimerActive As Boolean
Sub StartTimer()
    Start_Timer
End Sub
Private Sub Start_Timer()
    TimerActive = True
    Application.OnTime Now() + TimeValue("00:01:00"), "Timer"
End Sub
Private Sub Stop_Timer()
    TimerActive = False
End Sub
Private Sub Timer()
    If TimerActive Then
        ActiveSheet.Cells(1, 1).Value = Time
        Application.OnTime Now() + TimeValue("00:01:00"), "Timer"
    End If
End Sub 
```

您可以在工作簿打开时调用“StartTimer”函数，并通过在 Visual Basic 编辑器中将以下代码添加到您的工作簿 Visual Basic“This.Workbook”类中让它每分钟重复一次。

```
Private Sub Workbook_Open()
    Module1.StartTimer
End Sub 
```

现在，每经过 1 分钟，就会调用**Timer程序，并将单元格 A1 设置为当前时间。**

# python - 如何使用带有非内置类的 PyObject_IsInstance 作为第二个参数？

> ID：11867227
> 
> 赞同：5
> 
> 时间：2012-08-08T14:52:34.233
> 
> 标签：python, c, instance, pyobject

在 C/C++ 中，我想看看 a`PyObject`是否是一个实例。不幸的是，`PyInstance_Check`宏不适用于新式类。

因此，根据我阅读的论坛帖子，`PyObject_IsInstance`可以解决问题。但是，我发现的所有示例都展示了与内置类型（如整数和字符串）的比较。

我想知道如何构造一个代表一个类型的类的 PyObject，所以我可以将它传递给`PyObject_IsInstance`. 你能帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T16:50:02.807

根据该页面的内容，我终于自己找到了答案：[Create instance of a python class , declared in python, with C API](https://stackoverflow.com/questions/1147452/create-instance-of-a-python-class-declared-in-python-with-c-api)

```
// PyInstance_Check works only for old-style classes.
qBool isInstance = PyInstance_Check(pyInstance);
if (!isInstance)
{
    // It might be an instance of a new-style class.
    //
    PyRef module = PyImport_ImportModule("module.where.myclass.is");
    PyObject* moduleDict = PyModule_GetDict(module.Get());
    PyObject* protocolClass = PyDict_GetItemString(moduleDict, "MyClass");

    int returnValue = PyObject_IsInstance(pyObject, protocolClass);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T14:23:32.120

`PyTypeObject`如果它是在同一个模块中定义的，您可以使用相应的。`ProtocolType`如果从您要使用的位置看不到类型对象（假设它被称为） `PyObject_IsInstance`，请首先声明一个原型：

```
extern PyTypeObject ProtocolType; 
```

然后像这样使用它：

```
PyObject_IsInstance(object, reinterpret_cast<PyObject*>(&ProtocolType)) 
```

# google-maps - 标记聚类器 + 重叠标记 gmap v3

> ID：11867232
> 
> 赞同：1
> 
> 时间：2012-08-08T14:52:51.627
> 
> 标签：google-maps, google-maps-markers, markerclusterer

我知道这个话题很常见，但我不知道如何解决我的问题。

我正在使用 gmap v3 和 markercluster，有时我在同一位置（lat/lng）有标记。我知道谷歌没有为此提供任何解决方案，但我想打开一个包含标记重叠时的点的信息窗口。

有人知道我该怎么做吗？谢谢

# python - 在 map_reduce 操作期间按日期比较过滤 MongoEngine / PyMongo 失败

> ID：11867233
> 
> 赞同：4
> 
> 时间：2012-08-08T14:52:58.927
> 
> 标签：python, mongodb, mapreduce, pymongo, mongoengine

我已经构建了一些程序来收集大量信息并将其以原始形式存储在 Mongo 数据库中。稍后，在预先指定的时间段，`map_reduce`调用操作来评估此信息的子集。

原始数据必须保留，不能丢弃，但`map_reduce`操作不一定需要原始数据的全部结果才能进行操作。相反，我已经构建了这些`map_reduce`操作，以便它们可以仅在尚未评估的最新收集数据上运行。稍后调用第二个`map_reduce`操作来处​​理精炼原始数据的缩减。

然后，我需要指定一个查询过滤器，以便已经减少一次的原始数据不会在每个`map_reduce`操作中减少 a。我遇到的解决方案是指定一个过滤器*（或将`map_reduce`操作传递给查询）*，它只会选择**date_collected**字段比预定日期更新的条目。

首先，我尝试使用以下代码：

```
for k in SomeData.objects.filter(date_collected__gt=BULK_REQUEST_DATE).map_reduce(map_f, reduce_f, {'merge':'COLLECTION'}):
    print k.value 
```

我还用小于过滤器尝试了这个*（只是为了确保我没有考虑倒退日期）*。它也没有工作。

现在有趣的是。如果我要删除 map_reduce 链式方法调用，并`k`从上面打印，如下所示：

```
for k in SomeData.objects.filter(date_collected__gt=BULK_REQUEST_DATE):
    print k 
```

过滤器工作得非常好，并且只选择在特定时间点之后收集的数据。

接下来，我破解了 MongoEngine`queryset.py`模块，并在方法中添加了一个可选参数，以便`map_reduce`可以将查询传递给`map_reduce`函数，如下所示：

```
q = {'date_collected' : {'$lte' : BULK_REQUEST_DATE}}

for k in SomeData.objects.filter(date_collected__lte=BULK_REQUEST_DATE).map_reduce(map_f, reduce_f, {'merge':'COLLECTION'}, query=q):
        print k.value 
```

同样，这未能产生预期的结果。但是没有错误。我能够通过传递配置不正确的查询或将高级查询运算符更改为类似的东西来中断操作，所以**我**知道我通过该方法的任何查询都在被评估，并且至少不会引起任何问题.`map_reduce``$lte``$asdfjla``map_reduce`

在执行操作的所有上述方法中`map_reduce`，对原始存储中的所有数据进行了评估。我的尝试都没有破坏 map_reduce 操作，但它们也未能将查询限制为数据的子集。

有人可以指出我比较日期的逻辑中的缺陷吗？

日期作为 python datetime.time 存储在 mongo 数据库中。在比较两个日期之前，我还尝试将日期更改为 ISOformat。这在 python 或 javascript 端不起作用。

任何帮助将不胜感激！谢谢你。

**更新**

我已经确定问题不在于 MongoEngine。

问题与在 javascript 中使用“$gte”或“$lte”等运算符比较 PyMongo Datetime 对象的方式有关。由于某种原因，日期时间对象没有被这样对待，或者没有正确转换为 javascripts 日期。

我还没有弄清楚更多，但是如果您有任何指示，我肯定会使用它们！

**更新**

我已经从测试 MongoEngine 转向直接测试 PyMongo。以下代码无法产生预期的结果。注意：epochtime 是一个字段，包含自创建文档的纪元以来的秒数（以 int 形式）。Timestamp 也是一个 int，在运行时创建。

```
j = db.data.map_reduce(map_f, reduce_f, {'merge':'COLLECTION'}, query={'epochtime':{'$lte':timestamp}})
for x in j.find():
    print x 
```

我希望当使用“$ lte”时，for循环会打印x，因为时间戳> epochtime总是。或者，我希望如果使用“$gte”，则不会打印任何值。相反，相同的值被打印在两个事件中；使用“$lte”或“$gte”运算符时没有区别。

我错过了什么？

**更新**

我应用了与我之前的更新相同的操作，期望它而不是自纪元以来的秒数，我将集合中的每个纪元时间字段重置为从 1 开始的递增数字。我还设置了时间戳 = 1。然后我执行map_reduce 操作。它工作正常。

这让我觉得字段的字节大小有问题？我使用浮点字段复制了上述结果。它适用于小浮点数，但不适用于表示自纪元以来的秒数（带小数）的浮点数。

我肯定在这里错过了一些基本的东西......

**更新**

发现了可能导致问题的东西。当我使用map_reduce的合并输出功能时，它成功地根据查询进行过滤，然后第一时间将减少的数据保存到指定的集合中。但是，这只适用于一次。后记，查询中的条件无法始终如一地工作，如果有的话。这似乎只发生在合并输出功能上。使用替换、减少或内联输出方法时不会发生这种情况。此外，似乎当在同一集合上第二次使用合并函数时，查询参数中的条件取决于被比较的两个值的大小 - 请参阅先前的更新。

我不知道这意味着什么，也不知道为什么会这样。

# c# - How do I find the top-most picbox in a List within Bounds.Contains(e.Location)?

> ID：11867240
> 
> 赞同：1
> 
> 时间：2012-08-08T14:53:20.217
> 
> 标签：c#, winforms, picturebox

I've come across a problem in my panel1_MouseMove event. I have 3 pictureboxes inside List pBoxes, which are all drawn to the panel & the picturebox controls are set to Visible = false.

The problem is that when there are overlapping images, when I click one image it may select the pictureBox Behind it. Like so![enter image description here](../Images/3a13ed59393283b0b9bde0f5b359cfbf.png)

Here is the code:

```
 private void panel1_MouseMove(object sender, MouseEventArgs e)
{
if (picturebox1.Bounds.Contains(e.Location) && !picturebox1.Visible)
{
picturebox1.Show();
picturebox2.Hide();
picturebox3.Hide();
}
if (picturebox2.Bounds.Contains(e.Location) && !picturebox2.Visible)
{
picturebox1.Hide();
picturebox2.Show();
picturebox3.Hide();
}
if (picturebox3.Bounds.Contains(e.Location) && !picturebox3.Visible)
{
picturebox1.Hide();
picturebox2.Hide();
picturebox3.Show();
} 
```

Any help would be gladly appreciated, and yes I have to use Bounds.Contains for my particular application. Another way to look at my question is that I am trying to create a pictureBox1__MouseClick event without a Visible control.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:48:49.497

You can try something like this. I added three overlapping PictureBoxes with three different background colors for testing.

Initial form setup:

```
private bool isDragging = false;
private Point dragOffset = Point.Empty;
private PictureBox dragBox;

public Form1() {
  InitializeComponent();

  panel1.MouseDown += new MouseEventHandler(panel1_MouseDown);
  panel1.MouseMove += new MouseEventHandler(panel1_MouseMove);
  panel1.MouseUp += new MouseEventHandler(panel1_MouseUp);
  panel1.Paint += new PaintEventHandler(panel1_Paint);
  panel1.DragEnter += new DragEventHandler(panel1_DragEnter);
  panel1.DragDrop += new DragEventHandler(panel1_DragDrop);
} 
```

Drag Drop Events:

```
void panel1_DragDrop(object sender, DragEventArgs e) {
  dragBox.Location = panel1.PointToClient(
          new Point(e.X - dragOffset.X, e.Y - dragOffset.Y));
  panel1_MouseUp(null, null);
}

void panel1_DragEnter(object sender, DragEventArgs e) {
  e.Effect = DragDropEffects.Move;
} 
```

Mouse Events:

```
void panel1_MouseMove(object sender, MouseEventArgs e) {
  if (dragBox != null && !isDragging) {
    isDragging = true;
    panel1.DoDragDrop(dragBox, DragDropEffects.Move);
  }
}

void panel1_MouseDown(object sender, MouseEventArgs e) {
  if (e.Button == MouseButtons.Left) {
    foreach (PictureBox pb in panel1.Controls.OfType<PictureBox>()
             .OrderBy(x => panel1.Controls.GetChildIndex(x))) {

      if (pb.Bounds.Contains(e.Location)) {
        pb.BringToFront();
        pb.Visible = true;
        dragBox = pb;
        dragOffset = new Point(e.X - pb.Left, e.Y - pb.Top);
        panel1.Invalidate();
        break;
      }
    }
  }
}

void panel1_MouseUp(object sender, MouseEventArgs e) {
  foreach (PictureBox pb in panel1.Controls.OfType<PictureBox>()) {
    pb.Visible = false;
  }
  dragBox = null;
  isDragging = false;
} 
```

Paint event:

```
void panel1_Paint(object sender, PaintEventArgs e) {
  foreach (PictureBox pb in panel1.Controls.OfType<PictureBox>()
           .OrderByDescending(x => panel1.Controls.GetChildIndex(x))) {
    e.Graphics.FillRectangle(new SolidBrush(pb.BackColor), pb.Bounds);
  }
} 
```

It uses `GetChildIndex` of the parent panel to get the highest PictureBox control inside the panel, and if it finds it, makes the "clicked" one visible and to the front so the Child Index is updated.

Since the PictureBoxes are always hidden (unless dragged), this code will bring the correct PictureBox to the front. I added my paint event that draws the PictureBoxes in *reverse* order so that the highest box is painted last.

Changed the code to show the selected PictureBox on the MouseDown and then hide it again on the MouseUp.

Added drag and drop code.

# android - Android 是如何实现对 SuperNotCalledException 的检查的？

> ID：11867246
> 
> 赞同：4
> 
> 时间：2012-08-08T14:53:31.590
> 
> 标签：android, oop, inheritance, super, android-lifecycle

在`Activity`该类中，Android 提供了`super()` [必须](http://developer.android.com/reference/android/app/Activity.html#onResume%28%29)为被覆盖的生命周期回调方法调用的运行时强制。如果你忘记这样做，它会抛出 SuperNotCalledException。

这具体是如何在 Android 上实现的？如果可能，请指出实际的源代码实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:59:37.723

看起来他们[在超级方法中清除了一个标志并检查它是否已设置](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/1.5_r4/android/app/Activity.java#3488)：

```
final void performStart() {
    mCalled = false;
    mInstrumentation.callActivityOnStart(this);
    if (!mCalled) {
        throw new SuperNotCalledException(
            "Activity " + mComponent.toShortString() +
            " did not call through to super.onStart()");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-16T13:51:32.287

作为旁注，android刚刚宣布了一个新注释@CallSuper，当它被覆盖时，当@CallSuper注释方法没有调用super时，它会向您发出警告。

更多细节：

[http://tools.android.com/tech-docs/support-annotations](http://tools.android.com/tech-docs/support-annotations)

# wpf - Caliburn.Micro：无法关闭选项卡

> ID：11867249
> 
> 赞同：3
> 
> 时间：2012-08-08T14:53:41.067
> 
> 标签：wpf, tabcontrol, caliburn.micro

在我的 WPF Caliburn.Micro 应用程序中，我有一个 TabControl。我希望能够根据需要关闭标签。我在这里找到了一种方法：

[http://devlicio.us/blogs/rob_eisenberg/archive/2010/10/19/caliburn-micro-soup-to-nuts-part-6c-simple-mdi-with-screen-collections.aspx](http://devlicio.us/blogs/rob_eisenberg/archive/2010/10/19/caliburn-micro-soup-to-nuts-part-6c-simple-mdi-with-screen-collections.aspx)

但是当我尝试应用它时，我得到一个错误：

> 未找到方法 CloseItem 的目标。

这是我的代码：

```
 <TabControl x:Name="Items" >
    <TabControl.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding DisplayName}" />
                <Button Content="X"  
                            cal:Message.Attach="CloseItem($dataContext)" />
            </StackPanel>
        </DataTemplate>
    </TabControl.ItemTemplate>
</TabControl> 
```

能否请你帮忙？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-09T16:58:17.130

另一种方法是：

```
<Button Content="X" cal:Message.Attach="DeactivateItem($dataContext, 'true')" /> 
```

这样您就不必创建额外的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T16:26:30.587

不完全确定是什么导致了您的确切问题（我怀疑一个非常古老的教程加上一个截然不同的程序集是问题），但我知道如何让它工作。创建任何像这样的旧公共方法并调用它。它将覆盖您在其中的内容，因此您可以将其命名为 CloseItem。然后调用这个扩展方法，传入 IConductor 实例和 IScreen 实例。

```
public void CloseItem(object dataContext)
{
    ScreenExtensions.CloseItem(this, dataContext);
} 
```

# javascript - 每次/放置 jQuery UI 小部件的选项更改时，我如何获取堆栈跟踪或设置断点？

> ID：11867250
> 
> 赞同：2
> 
> 时间：2012-08-08T14:53:40.733
> 
> 标签：javascript, jquery, jquery-ui, debugging

我有一组相当复杂的 jQuery UI 小部件，它们彼此交互，通常是异步的。我有一种情况，特定小部件的`options`数据被意外更改，而不是通过`_setOption`or `_setOptions`。

在 Chrome、Safari 或 Firefox 中，是否有任何方法可以记录堆栈跟踪或设置断点以在该小部件的`options`数据发生更改时设置断点？似乎应该有一种方法可以观察内存中的值并在它被访问或更改时收到警报。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T22:08:39.303

[FireQuery](https://github.com/binaryage/firequery)或[jQuery Lint](https://github.com/padolsey/jQuery-Lint)应该报告这一点，并且两者都可以扩展以在这种特殊情况下设置断点，以帮助调试调用堆栈中事件的根本原因。

# regex - 在记事本++字符限制中搜索/替换

> ID：11867260
> 
> 赞同：0
> 
> 时间：2012-08-08T14:54:16.807
> 
> 标签：regex, notepad++, replace

我有一个 xml 文件，需要在某些字段上有 60 个字符的限制。

例子

```
<Description>This is a long description that is really over 60 characters long and needs to be shortened</Description> 
```

我需要修剪每一次出现，所以它只有 60 个字符，所以上面的输出是。

```
<Description>This is a long description that is really over 60 characters</Description> 
```

使用记事本++，我将如何使用正则表达式进行搜索和替换？

我有多个文件，我需要对每个文件运行这个大约有 2000 行，并且该字段大约出现 10-15 次。

并非所有字段都有超过 60 个字符，只是其中一些。

数据块示例

```
 <Product>
        <SuppliersProductCode>PF01215</SuppliersProductCode>
        <BuyersProductCode></BuyersProductCode>
        <GTIN>0</GTIN>
        <Description>This is a long description that is really over 60 characters long and needs to be shortened</Description>
        <Properties>
            <Quantity UOMCode="EA">
                <Packsize>1</Packsize>
                <Amount>1</Amount>
            </Quantity>
        </Properties>
    </Product> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:44:04.543

我认为正则表达式`<Description>([^<]{0,60})[^<]*</Description>`匹配你想要的，假设描述从不包含“<”。请注意，换行符也被计算在内。如果您想避免这种情况，请使用`<Description>\R?([^<]{0,60})[^<]*</Description>`.

在“替换”框中输入`<Description>\1</Description>`. `\1`引用与第一对括号之间的表达式匹配的内容。它被称为反向引用。[更多信息](http://www.regular-expressions.info/brackets.html)

# mongodb - MongoDB 模式结构和查询

> ID：11867263
> 
> 赞同：0
> 
> 时间：2012-08-08T14:54:27.327
> 
> 标签：mongodb

我刚刚涉足 mongoDB 开发。使用 shell，我可以将以下内容存储到一个名为 vrm 的集合中：

```
w = {
  westpalm :{
    users : [
      {pkanane : {names : {lastName : "Anane", otherNames : "Papa Kwame"}}, contacts : {}, authorization : {}},
      {csquire : {}},
      {oman : {}}
    ],
    customers : [], 
    vehicles : [], 
    settings : []

  }  
}

a = {
  wuduwudu :{
    users : [
      {pkanane : {names : {lastName : "Anane", otherNames : "Papa Kwame"}}, contacts : {}, authorization : {}},
      {zkenpachi : {}}
    ],
    customers : [], 
    vehicles : [], 
    settings : []

  }  
} 
```

然后我保存如下 db.vrm.save(a) 和 db.vrm.save(w)

Q1。我要建模的是**2**家公司**wuduwudu**和**westpalm**，每个公司都有**用户**、**客户**、**车辆**等。每个用户都有一个**名称**- 由**lastName**和**otherNames**、**联系人**等组成。这是对数据需求建模的好方法吗?

Q2。如何检索用户**pkanane的****otherNames**

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:57:09.410

我将首先在您的原始模式的上下文中解决您的第二个问题。使用用户名作为索引将使查询变得更加困难，因为您将有一个变量字段名称可供使用。同样，在用户对象中对此类字段进行索引也不会扩展，因为每个不同的字段路径都需要自己的索引。也就是说，查询效率低下是可能的：

```
db.companies.drop()
db.companies.insert({
    _id: "wuduwudu",
    users: [
        { pkanane: { fullName: "Papa Kwame" } }
    ]
});
db.companies.find({ "users.pkanane": { $exists: true }}, { "users.pkanane.fullName": 1 });
{ "_id" : "wuduwudu", "users" : [ { "pkanane" : { "fullName" : "Papa Kwame" } } ] } 
```

一种改进是制作`users`一组嵌入式用户对象。使用此模式，您可以利用字段上的[多键索引](http://www.mongodb.org/display/DOCS/Multikeys)`users.username`，Mongo 将为每个文档的数组中的所有用户名编制索引。

```
db.companies.drop()
db.companies.insert({
    _id: "westpalm",
    users: [
        { username: "pkanane", fullName: "Papa Kwame" }
    ]
});
db.companies.find({ "users.username": "pkanane" }, { "users.pkanane.fullName": 1 });
{ "_id" : "wuduwudu", "users" : [ { "pkanane" : { "fullName" : "Papa Kwame" } } ] }); 
```

* * *

为了重新考虑您的架构，我将从查看公司和用户对象结构开始。正如我上面提到的，动态字段名称不适用于索引。我建议不要将公司名称用作文档中唯一的顶级键。您可以将它用于`_id`，就像我在上面的示例中所做的那样，或者依靠 MongoDB 生成 ObjectId 并将公司名称存储在其自己的字段中，旁边是`users`,`customers`等。

一般来说，用户是大多数应用程序中的第一类对象。如果您在公司范围之外使用和编辑它们，我会考虑将它们存储在他们自己的集合中，而不是在您的公司文档中保留一组用户 ID。此外，在您自己的示例中，您在两家公司之间复制了“pkanane”。这是另一种气味，您最好在自己的集合中引用用户文档。客户、车辆和设置可能不是应用程序中的一流对象，因此嵌入它们可能更合适。MongoDB 文档中的[Schema Design](http://www.mongodb.org/display/DOCS/Schema+Design#SchemaDesign-SummaryofBestPractices)条目是一个很好的起点（我已链接到最佳实践列表）。

嵌入文档的另一个挑战可能是要求您的应用程序允许单独编辑单个嵌入文档。这对于在用户文档中嵌入地址簿并提供“编辑您的地址”表单的架构来说是典型的。使用可以更改的对象的数组位置是不可靠的，因为对象上有一个不可变的字段。使用上面我的第二个代码示例中的模式，`username`如果它是不可变的，我们可以使用它。或者，我们可以在每个嵌入式文档上存储一个唯一的 ObjectId 并引用它。

最后一点，您最终可能会将用户转移到他们自己的收藏中，但该建议对于您留在公司中的任何内容都是有效的。

# grails - 使用 Grails 2.1 调用 grails 战争时出现奇怪的 Log4J 错误

> ID：11867264
> 
> 赞同：4
> 
> 时间：2012-08-08T14:54:30.687
> 
> 标签：grails, logging, log4j

当我`grails -skipTests -verbose -plainOutput war`在命令行上执行时，它会尝试为生产环境配置日志记录。但是，我不希望在构建战争时有任何应用程序日志记录。有谁知道为什么 Grails 会尝试这样做以及如何避免它？谢谢。

BuildAgent 上不存在它尝试登录的目录。但这就是重点。没有运行应用程序，我只想建立一场战争。

我的日志配置：

```
// log4j configuration
log4j = {
    appenders {
        def logDir = '/someDirectory/'

        if (Environment.getCurrentEnvironment() in [Environment.DEVELOPMENT, Environment.TEST]) {
            logDir = 'log/'
        }

        def logFile = "${logDir}someLog.log"
        def stacktraceLogFile = "${logDir}stacktrace.log"

        appender new org.apache.log4j.DailyRollingFileAppender(name: "file",
                layout: pattern(conversionPattern: "%d{[ dd.MM.yy HH:mm:ss.SSS]} [%t] %-5p %c %x - %m%n"),
                file: logFile,
                datePattern: "'.'yyyy-MM-dd")

        appender new org.apache.log4j.DailyRollingFileAppender(name: "stacktrace",
                layout: pattern(conversionPattern: "%d{[ dd.MM.yy HH:mm:ss.SSS]} [%t] %-5p %c %x - %m%n"),
                file: stacktraceLogFile,
                datePattern: "'.'yyyy-MM-dd")
    }

    error 'org.codehaus.groovy.grails.web.servlet',  //  controllers
            'org.codehaus.groovy.grails.web.pages', //  GSP
            'org.codehaus.groovy.grails.web.sitemesh', //  layouts
            'org.codehaus.groovy.grails.web.mapping.filter', // URL mapping
            'org.codehaus.groovy.grails.web.mapping', // URL mapping
            'org.codehaus.groovy.grails.commons', // core / classloading
            'org.codehaus.groovy.grails.plugins', // plugins
            'org.springframework'

    root {
        warn 'stdout', 'file'

        environments {
            production {
                error 'stdout', 'file'
            }
        }
    }
} 
```

我的堆栈跟踪：

```
java.io.FileNotFoundException: /someDirectory/stacktrace.log (No such file or directory)
at java.io.FileOutputStream.openAppend(Native Method)
at java.io.FileOutputStream.<init>(FileOutputStream.java:192)
at java.io.FileOutputStream.<init>(FileOutputStream.java:116)
at org.apache.log4j.FileAppender.setFile(FileAppender.java:294)
...
at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSite.invoke(PogoMetaMethodSite.java:226)
at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.callCurrent(PogoMetaMethodSite.java:52)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:46)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:133)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:145)
at gant.Gant.executeTargets(Gant.groovy:590)
at org.codehaus.groovy.grails.cli.GrailsScriptRunner.executeWithGantInstance(GrailsScriptRunner.java:748)
at org.codehaus.groovy.grails.cli.GrailsScriptRunner.executeScriptFile(GrailsScriptRunner.java:551)
at org.codehaus.groovy.grails.cli.GrailsScriptRunner.executeScriptWithCaching(GrailsScriptRunner.java:452)
at org.codehaus.groovy.grails.cli.GrailsScriptRunner.callPluginOrGrailsScript(GrailsScriptRunner.java:396)
at org.codehaus.groovy.grails.cli.GrailsScriptRunner.executeCommand(GrailsScriptRunner.java:371)
at org.codehaus.groovy.grails.cli.GrailsScriptRunner.main(GrailsScriptRunner.java:232)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.codehaus.groovy.grails.cli.support.GrailsStarter.rootLoader(GrailsStarter.java:234)
at org.codehaus.groovy.grails.cli.support.GrailsStarter.main(GrailsStarter.java:262) 
```

***更新***

我刚刚注意到，只有在使用 Grails 启用详细日志记录时（即在我的 Jenkins 构建代理上），才会暴露此异常。对我来说，这似乎是一种被普通标准输出日志隐藏的不良行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:13:34.520

该错误可能意味着它`/someDirectory`不存在并且 log4j 没有创建它的必要权限。

从堆栈跟踪来看，似乎 Grails 确实初始化了配置，可能是因为大多数命令都需要它。

我的建议是在 Grails 主配置文件中创建另一个环境，它要么根本不配置 log4j，要么只配置控制台附加程序。

或者，将文件 appender 移动到生产配置或将其配置为写入开发配置中的相对路径并在生产中覆盖此路径。

**[编辑]**替换

```
def logDir = '/someDirectory/' 
```

和

```
def logDir = System.getProperty( 'appname.logDir', '/someDirectory/' ); 
```

# matlab - 如何在MATLAB中创建具有c个固定邻居的n个顶点的随机图？

> ID：11867266
> 
> 赞同：3
> 
> 时间：2012-08-08T14:54:33.433
> 
> 标签：matlab, graph-theory

我在 MATLAB 中编写了一个代码，它允许我生成一个随机`n`顶点图，每个顶点都有`c`固定的邻居，没有循环（注意边是定向的，因此“a 连接到 b”并不意味着“b 连接到 a”）。

但是，它的效率非常低，尤其是当我需要它处理诸如`n = 10000`和之类的量级时`c = 1000`。我想知道是否有人可以优化它，或者提出任何建设性的建议？

```
function [M]=matsrand(n,c)

MM=0;   %arbitrary starting value
while MM ~=n*c

    M = sparse(zeros(n));       
    ctin = zeros(1,n);  

    for i=1:n
        rp = randperm(n);   %generate vector of the randomly permuted order of n vertices
        rp(rp==i)=[];       %get rid of itself to avoid self connection

        noconnect=find(ctin(:)>=c); %generate list that i is not allowed to connect to
        where=ismember(rp,noconnect);   %returns 1 to the subset noconnect in rp
        noconnectind=find(where);

        rp(noconnectind(:))=[];         %remove the neurons i is not allowed to connect to

        if length(rp)<c
            break
        else
            r=rp(1:c);
        end
        M(i,r)=1;
        ctin(r)=ctin(r)+1;

    end
    MM=sum(ctin);
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:41:31.650

这会加快速度：

```
function [M]=matsrand(n,c)

    MM=0;   %arbitrary starting value
    all_nums=1:n;

    while MM ~=n*c

        M = sparse([],[],[],n,n,n*c);
        ctin = zeros(1,n);

        for ii=1:n
            noconnect=ctin>=c;
            noconnect(ii)=true;

            rem_nums = all_nums(~noconnect); % remaining numbers
            rp=randperm(n-sum(noconnect));
            rp = rem_nums(rp); % remaining numbers, hussled

            if numel(rp)<c
                break
            else
                r=rp(1:c);
            end
            M(ii,r)=1;
            ctin(r)=ctin(r)+1;
        end
        MM=sum(ctin);
    end
end 
```

如果内存不是问题，我认为您可以将稀疏矩阵替换为普通的`zeros(n,n)`.

主要问题仍然是你必须击中那个幸运组合。

# asp.net - 使用实体框架在 asp.net mvc3 中对多个 xml 文档运行 xpath 查询

> ID：11867268
> 
> 赞同：0
> 
> 时间：2012-08-08T14:54:47.023
> 
> 标签：asp.net, mysql, asp.net-mvc-3, xpath, entity-framework-4

我的主管的印象是，可以在 MySql 数据库上运行对存储的 xml 文档运行 xPath 查询的查询。

我关心的表称为 Responses 并具有以下列

```
 UserId, UploadTime, RawXml 
```

我已经通过以下方式获得了特定用户的所有回复

```
 public ActionResult UserResponses(Guid userid)
     {
        var allResponses = ZodiacData.Responses;
        var userResponses = (from r in allResponses
                        where r.UserId == userid
                        select r)
        //...populate model here....
         return PartialView("_responseTable", responsesmodel)
     } 
```

但是现在我正在尝试获取对 RawXml 根节点中引用的特定调查表的所有响应（通过 qid 和 qver，请参见下面的示例）根节点：

```
 <response qid="5" qver="3" date="..-..-.." qname="full"> 
```

有谁知道我如何在 asp.net 中做到这一点，我应该在上面的函数中添加什么到查询中？任何帮助都会很棒，即使只是指向正确类型的在线文章的指针。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:42:23.117

是的，可以对数据库中的 XML 数据运行 XPath 查询，但您不能为此使用 EF，因为 EF 不支持。如果要在数据库查询中使用 XPath，则必须直接编写 SQL。

.NET 4.5 应该会稍微改变这一点，因为您将能够映射表值 SQL 函数并将 XPath 查询隐藏在该函数中。

# javascript - 使用 jquery 仅替换 div 内的文本

> ID：11867269
> 
> 赞同：121
> 
> 时间：2012-08-08T14:54:47.837
> 
> 标签：javascript, jquery

我有一个像这样的 div：

```
<div id="one">
       <div class="first"></div>
       "Hi I am text"
       <div class="second"></div>
       <div class="third"></div>
</div> 
```

我正在尝试使用 jquery 仅将文本从“嗨，我是文本”更改为“嗨，我是替换”。这可能很容易，但我做不到。

使用`$('#one').text('')`只是清空整个`#One`div。

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2012-08-08T15:04:35.133

找到文本节点 ( `nodeType==3`) 并替换`textContent`：

```
$('#one').contents().filter(function() {
    return this.nodeType == 3
}).each(function(){
    this.textContent = this.textContent.replace('Hi I am text','Hi I am replace');
}); 
```

请注意，根据[文档](https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType)`3`，您可以将上面的硬编码替换`Node.TEXT_NODE`为更清楚您在做什么。

```
$('#one').contents().filter(function() {
    return this.nodeType == Node.TEXT_NODE;
}).each(function(){
    this.textContent = this.textContent.replace('Hi I am text','Hi I am replace');
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div id="one">
       <div class="first"></div>
       "Hi I am text"
       <div class="second"></div>
       <div class="third"></div>
</div>
```

* * *

## 回答 #2

> 赞同：144
> 
> 时间：2012-08-08T14:56:37.387

文本不应单独存在。将其放入一个`span`元素中。

将其更改为：

```
<div id="one">
       <div class="first"></div>
       <span>"Hi I am text"</span>
       <div class="second"></div>
       <div class="third"></div>
</div> 
```

```
$('#one span').text('Hi I am replace'); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-08-08T14:57:13.903

您需要将文本设置为空字符串以外的内容。此外， .html() 函数应该在保留 div 的 HTML 结构的同时做到这一点。

```
$('#one').html($('#one').html().replace('text','replace')); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-08-08T15:08:47.170

如果您确实知道要替换的文本，则可以使用

```
$('#one').contents(':contains("Hi I am text")')[0].nodeValue = '"Hi I am replace"'; 
```

[http://jsfiddle.net/5rWhh/](http://jsfiddle.net/5rWwh/)

或者

```
$('#one').contents(':not(*)')[1].nodeValue = '"Hi I am replace"'; 
```

`$('#one').contents(':not(*)')`在这种情况下选择非元素子节点文本节点，第二个节点是我们要替换的那个。

[http://jsfiddle.net/5rWhh/1/](http://jsfiddle.net/5rWwh/1/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-22T08:06:38.757

另一种方法是保留该元素，更改文本，然后将该元素附加回来

```
const star_icon = $(li).find('.stars svg')
$(li).find('.stars').text(repo.stargazers_count).append(star_icon) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-21T16:50:57.360

我有同样的问题，但**文本是父元素内的第一个节点。**在这种情况下，您可以执行以下操作，而且速度非常快：

```
// find the children elements
 termsChildren = $('#one').children()

// replace the text, then re-append the children element.
 $('#one').text(' "Hi I am replace" ').append(termsChildren) 
```

否则，您必须指定哪些孩子必须在文本之前，哪些在之后：

```
 // find the children elements
 termsChildren = $('#one').children()

// remove all the content
 $('#one').text(' ')
// append the first child element
 $('#one').append(termsChildren[0])
// add the new text and then the other children
 $('#one').text(' "Hi I am replace" ').append(termsChildren.slice(1)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-15T03:03:11.887

以防万一您无法更改 HTML。非常原始但简短且有效。（它将清空父 div，因此子 div 将被删除）

```
$('#one').text('Hi I am replace');
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<div id="one">
  <div class="first"></div>
  "Hi I am text"
  <div class="second"></div>
  <div class="third"></div>
</div>
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-06-21T17:13:26.170

当您用 jQuery 替换元素的纯文本时，您**不能**将纯文本单独放置，否则它将清除和/或替换整个元素。您应该将所有纯文本放在一个`<span>`元素中：

```
$(document).ready(function() {
  $("#change-btn").click(function() {
    $("#one").children("span").text("Hi I am replace");
  });
});
```

```
<!-- Import CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
<!-- Import JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>

<div class="m-2">
  <div id="one">
    <div class="first"></div>
    <span>Hi I am text</span>
    <div class="second"></div>
    <div class="third"></div>
  </div>
  <button type="button" class="btn btn-primary btn-sm mt-2" id="change-btn">Click to change text</button>
</div>
```

# scala - 从 scala 演员中检索对象

> ID：11867270
> 
> 赞同：0
> 
> 时间：2012-08-08T14:54:55.087
> 
> 标签：scala, actor

我有一个可以分发的密集任务，但其最终结果需要累积并传递给另一个方法。

具体而言，假设我正在对大量文本文件中的单个文件进行字数统计。

到目前为止，我制定的版本如下所示：

```
import scala.actors.Actor
import scala.actors.Actor._
import scala.collection.mutable.{ArrayBuffer => mArray}

case object Stop

class Collector(val bin: mArray[(String, Int)], tcount: Int) extends Actor {
  def act() {
    loop {
      receive {
        case (fn: String, val: Int) => {
          // the following "bin" object is what I ultimately need to get back
          bin.append((fn, val))
        }
        case Stop => {
          tcount -= 1
          if(tcount == 0) exit()
        }}}}}

class Processor(col: Collector, flist: Seq[File]) extends Actor {
  def act() {
    for(fn <- flist) {
      val wcount = count words in fn // just a place holder for word counting code
      col ! (fn, wcount)
    }    
    col ! (id, Stop)
  }
} 
```

我可以想到几个自制的方法，让 main 方法等待收集器完成，然后处理“bin”对象。

但是什么是正确的 scala 方法来检索上面的“bin”并将其交还给 main 或者你有什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:03:23.050

使用演员，您不会“检索”任何东西，因为调用演员方法可能很危险。

相反，你让演员发送答案。您可以为对象添加一个案例`GET`，或者在您的情况下，您可以让它`bin`在处理程序中的某处发送`Stop`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:48:23.973

您可以使用方法 ping 演员`!!`来创建未来的结果。接收消息的参与者可以使用 来填写结果`reply`。

* * *

但是，您可以通过使用执行程序来节省大量管理工作，这更适合*并行化*任务（您实际上并没有*并发*情况，其中参与者特别有用）。

以下基于 Scala 2.10（即将发布，您现在可以使用 2.10.0-M6），因为它包含改进的并发框架：

```
import java.io.File
import concurrent._
import java.util.concurrent.Executors

// count words in a file - probably not the best possible way to write this
def wc(f: File): Int = io.Source.fromFile(f).getLines.map(
   _.split(' ').filterNot(_ == "").size).sum

// utility method to get files within a directory (non-recursive!)
def filesInDir(dir: File): Seq[File] = dir.listFiles.toSeq.filter(_.isFile)

// process method which takes a list of files, spawns a word-count for each
// and collects the individual future results into a `Map` whose future is returned
def process(files: Seq[File])(implicit exec: ExecutionContext)
: Future[Seq[(File, Either[Throwable, Int])]] = {
  val futs = files.map { f =>
    // `future` submits the body for asynchronous processing. In order to
    // gracefully handle IO errors, a successful result is wrapped in `Right`,
    // and an exception in `Left`. The caller can decide how to handle errors.
    future {
      f -> (try {
        Right(wc(f))
      } catch {
        case e: Throwable => Left(e)
      })
    }
  }
  // collect all the individual results into one result object.
  // the new single `Future` is only complete after all of the individual futures
  // have completed.
  Future.sequence(futs)
} 
```

例子：

```
// use as many threads as there are processor cores
val poolSize = sys.runtime.availableProcessors()

// create a new executor context to be used for spawning
implicit val exec = ExecutionContext.fromExecutor(
  Executors.newFixedThreadPool(poolSize))

// call the process
val map = process(filesInDir(new File("/my/directory")))

// execute some body when the future is completed
map.onSuccess { case m =>
  m foreach println
} 
```

# ios - 如何从 iphone 的自定义联系人屏幕禁用呼叫（是否可能）？

> ID：11867271
> 
> 赞同：1
> 
> 时间：2012-08-08T14:54:55.983
> 
> 标签：ios, iphone

目前我正在开发一个简单的 iphone 应用程序，使用 ABPeopleNavigationViewController 创建一个自定义联系人屏幕，供用户选择电话号码来发送消息。但我的问题是，当用户选择电话号码时，它会自动拨打电话。

那么如何在 iphone 中禁用来自自定义联系人屏幕的呼叫？

# ios - copypng 失败，退出代码为 1

> ID：11867278
> 
> 赞同：20
> 
> 时间：2012-08-08T14:55:24.150
> 
> 标签：ios

构建 iPhone 应用程序时出现以下错误。reddarkedge.png 就在支持文件夹中。

```
/Users/azamsharp/Desktop/UltraCam/UltraCam/TCam/reddarkedge.pngCommand /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/Xcode/PrivatePlugIns/iPhoneOS Build System Support.xcplugin/Contents/Resources/copypng failed with exit code 1 
```

即使我从项目中删除 reddarkedge.png 它仍然给我同样的错误。

![在此处输入图像描述](../Images/c05828fdfc5170934c4e387c8e9251ae.png)

更新解决方案：

原来我不得不硬删除它们。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-08T15:47:18.303

当您从 Xcode 文件导航器中删除它时说“即使我从项目中删除了 reddarkedge.png”，它是否会从目标构建过程的复制捆绑步骤中删除？如果不是，也可以在那里手动删除它？

你也可以试试高

您也可以尝试在文本编辑器中打开 XML 项目文件并手动删除引用。确保有一个备份，以防万一你有问题。

祝你好运。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-08T15:52:36.397

CopyPNG 错误也有同样的问题。再次将图像放入您的项目中，并在图像上使用[ImageOptim](http://imageoptim.com/)程序，这解决了问题。也许它也能解决你的问题。

或者

检查“复制捆绑资源”构建阶段，看看是否有任何丢失的文件（png、txt、plist 等）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-18T16:10:37.780

大多数情况下，当您`Copy items if needed`在添加图像时错过了检查时，就会发生这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-23T14:00:36.063

我实际上是从 Desktop 中引用了应用程序图标图像。但是，我不小心删除了该图像并得到了这个错误。之后，我在桌面中添加了具有相同名称的图像并构建成功。所以请确保，如果你错过了这样的东西。希望这会对某人有所帮助！！！

# c# - 使用 XmlDocument 读取 XML 文件时遇到问题

> ID：11867285
> 
> 赞同：0
> 
> 时间：2012-08-08T14:55:44.823
> 
> 标签：c#, xml, xmldocument

我正在尝试在控制台应用程序中解析 XML 文件。代码外观示例：

```
 xml_nl = xml_d.SelectNodes("/exchange/messages/message");

        foreach (XmlNode xml_n in xml_nl)
        {

            XmlNodeList xml_ml = xml_n.SelectNodes("header");

            int h = 0;

            foreach (XmlNode xml_mhn in xml_ml)
            {
                if (xml_mhn.ChildNodes.Item(h).Name == "reference")
                {
                    switch (xml_mhn.ChildNodes.Item(h).Attributes["type"].Value)
                    {
                        case "CU":
                            senderRef = xml_mhn.ChildNodes.Item(h).ChildNodes.Item(0)["referencevalue"].InnerText.ToString();
                            break;
                        case "AAJ":
                            bulkRef = xml_mhn.ChildNodes.Item(h).ChildNodes.Item(0).InnerText.ToString();
                            break;
                        default:
                            break;
                    }
                } 
                    h++;
            } 
```

XML 本身的一个示例如下：

```
<?xml version="1.0" encoding="utf-8"?>
<exchange>
<exchangedetails>
    <exchangeref>00073281985000</exchangeref>
    <exident>1Q54A3</exident>
    <exchangedate>2012-06-22</exchangedate>
    <exchangetime>23:24:00</exchangetime>
</exchangedetails>
<messages>
    <message id="1">
        <header>
            <reference type="DM">
                <referencevalue>73500534821183387</referencevalue>
            </reference>
            <reference type="CU">
                <referencevalue>28-0686668</referencevalue>
            </reference>
            <reference type="AAJ">
                <referencevalue>28-0686668</referencevalue>
            </reference>
            <reference type="AQY">
                <referencevalue>9024</referencevalue>
            </reference>
                           </header>
                        </message>
                  </exchange> 
```

我的问题是它不会循环遍历标签及其子节点，它需要第一个，然后跳过其余的。我可能陷入了一些奇怪的想法，但我就是看不出在哪里。:P

任何帮助都会很乐意接受。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:01:41.433

您实际上并没有遍历引用。

你在做什么：

*   到达父节点
*   检查索引 H 处的子级
*   增量 H
*   离开父节点

你需要做什么：

*   到达父节点
*   使用 foreach 循环遍历子节点
*   检查 foreach 内的每个孩子
*   退出父节点

# regex - 字符串出现的正则表达式

> ID：11867291
> 
> 赞同：1
> 
> 时间：2012-08-08T14:55:58.573
> 
> 标签：regex, grep

我有一个简单的问题，我似乎无法找到答案。我需要一个正则表达式来搜索特定字符串的所有出现。例如，如果我正在搜索字符串“hi”的任意数量 pf 出现，那么我会得到以下字符串的匹配项：

```
hihi
12hi11h
hi34hi 
```

但不在：

```
hh1ii
iiihh1h 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:58:21.470

匹配字符串的正则表达式是字符串本身。

不过，请记住转义任何特殊字符。

例如，匹配任意数量的“hi”的字符串是：`hi`

注意：在 中`egrep`，您需要将正则表达式放在单引号中：`egrep '(hi){2,}' file.txt`

# web-services - 有没有办法安全地存储用户密码但能够访问该密码来验证 API？

> ID：11867294
> 
> 赞同：0
> 
> 时间：2012-08-08T14:56:04.580
> 
> 标签：web-services, security, passwords, password-protection

我希望有一项服务可以安全地存储用户密码，同时还允许我的代码检索该密码并对外部 API 的用户进行身份验证。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:00:58.440

我会做的是以下几点：

1.  取明文密码
2.  使用盐
3.  使用 SHA-1 或类似的散列算法对密码和盐进行散列
4.  将该哈希作为密码存储到数据存储中

当用户然后验证重做步骤 1-3 并且不将密码存储在数据存储中时，将其与数据存储中的哈希进行比较，如果匹配，则密码是正确的。

或者，让用户注册并获得一个“密码”，这是一个随机的字符序列，让他/她对其进行一次散列（无盐）并将其发送到您的 API，然后用盐重新散列并进行比较。

这完全取决于它的敏感程度。

//JaggenSWE

# codenameone - 应用程序在 google play 上的所有设备上均不可见

> ID：11867300
> 
> 赞同：0
> 
> 时间：2012-08-08T14:56:21.183
> 
> 标签：codenameone

我制作了一个[代号为 one的应用程序](http://www.codenameone.com)

现在，我已经将应用程序放到了 google play 上。[https://play.google.com/store/apps/details?id=in.n10k.UltimateGRE](https://play.google.com/store/apps/details?id=in.n10k.UltimateGRE)

一切正常。

但是，无法从安装在 (Samsung)Galaxy Tab 上的**Play 商店应用程序中搜索该应用程序**

它可以从其他手机搜索，但不能从 TAB 搜索。

谷歌表示，如果该应用在某些设备上不兼容，它不会在某些设备的搜索结果中显示该应用。

代号一个应用程序与 Galaxy 标签不兼容吗？这是一些分辨率问题吗？我如何确保我的应用程序可以从每个 android 设备上搜索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T05:02:41.610

向 Google play 提交应用程序时，您会看到一个对话框，指示对应用程序施加的限制，该对话框的内容将有助于验证为什么应用程序没有出现在特定设备上。

请记住，市场需要时间来刷新，因此应用程序可能会出现。

据我所知，没有限制，所有应用程序都应该在所有设备上运行。

# jquery - JQuery Parent→子选择器无法正常工作

> ID：11867303
> 
> 赞同：0
> 
> 时间：2012-08-08T14:56:31.253
> 
> 标签：jquery, selector

```
var $track = $('>.jScrollPaneTrack', $container); 
```

适用于 jquery 1.4.2，不适用于 jquery 1.7.2。

通过“作品”，我的意思是返回 jQuery 对象以便能够做到这一点，例如：

```
alert($track.html()); 
```

和

```
$track[0].css(..., ...); 
```

ETC

* * *

我想我找到了一个解决方案：不是以通常的方式使用变量 - track - 它现在希望我这样使用它 - $(track)

例如：

曾是：

```
track[0].css(..., ...); 
```

现在：

```
$(track[0]).css(..., ...); 
```

由于一些新的内部优化，当 jquery 返回 dom 对象而不是通常的 jquery 对象时。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T14:59:27.003

该选择器应该在 1.7.2 中工作，但是在 jQuery 的未来版本中[会被贬低](http://api.jquery.com/child-selector/)。尝试这样做`.children`

```
$track = $container.children('.jScrollPaneTrack') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T14:59:38.593

您可以改用该[`children`](http://api.jquery.com/children/)方法：

```
var $track = $container.children('.jScrollPaneTrack'); 
```

子选择器状态的 jQuery[文档：](http://api.jquery.com/child-selector/)

> 选择`$("> elem", context)`器将在未来的版本中被弃用。因此不鼓励使用它来代替使用替代选择器。

但是，它还没有被弃用，所以它应该仍然适合你。

# postgresql - 在postgres的两列中获取字符串切片

> ID：11867308
> 
> 赞同：1
> 
> 时间：2012-08-08T14:56:46.523
> 
> 标签：postgresql

我有一个表，其中包含一个名为`info`. 此字段包含有关驾驶员和汽车的一些信息，例如“驾驶员：马特汽车：野马”。

有没有办法在两列中获取查询，例如：`| Matt | Mustang |`.

我不知道我能做什么，也许是正则表达式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T13:22:25.190

```
WITH tbl(id, info) AS (
   VALUES
    (1::int, 'Driver: Matt Car: Mustang'::text)
   ,(2,      'Driver: Billy Car: Porsche')
   )
SELECT id
      ,split_part(info, ' ', 2) AS driver
      ,split_part(info, ' ', 4) As car
FROM   tbl; 
```

回报：

```
 id | driver  | car
----+---------+---------
  1 | Matt    | Mustang
  2 | Billy   | Porsche 
```

只要空格在那里并且名称在空格的右侧，您是否用什么字符串代替“Driver”和“Car”并不重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T10:39:26.313

如果我没有理解错误，您可以使用`string_to_array`函数将字符串拆分为数组元素，然后达到您想要的元素。

请参阅这篇文章以获取更多信息：[获取从“string_to_array()”函数返回的数组的第 N 个元素](https://stackoverflow.com/questions/11831555/get-nth-element-of-an-array-that-returns-from-string-to-array-function/11831799#11831799)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:04:28.483

您正在谈论的是一种非常不幸的设计模式，称为序列化：即将多个语义不同的数据块压缩成一个字符串。大多数时候这是一个坏主意，而且在几乎所有情况下，将数据分成多个字段甚至多个表是一个更好的主意。通过使用序列化字段，您会发现：

*   查询多个序列化子字段时，查询速度要慢得多
*   用于更新同一字段的多个部分的复杂查询
*   抑郁和绝望的感觉

如果我必须处理这样的数据库，并且我无法更改数据库结构，我可能最终会在程序代码中做很多繁重的工作。许多语言拥有比 SQL 更好（或至少更直观）的字符串处理工具，而且在处理序列化时，使用 RDBMS 带来的性能优势最多只能是微不足道的。

但是，如果您绝对必须在 SQL 中执行此操作，您应该阅读 Postgres 的字符串处理，位于此处：[http ://www.postgresql.org/docs/9.1/static/functions-string.html](http://www.postgresql.org/docs/9.1/static/functions-string.html)

你是对的，你的解决方案可能会涉及到一个正则表达式。该正则表达式的确切外观取决于它必须解析多少个序列化字段，以及它是如何分隔的。在您的示例中，看起来每个子字段由一对空格和它们之间的管道字符分隔，如果是这种情况，请确保您创建规则以根据需要转义该分隔符，或者确保前端从不将分隔符传递给数据库。

当然，如果您对前端应用程序有这种控制，您可以为序列化数据提供自己的字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:52:04.793

最好的办法是编写一个函数来获取这些值之一，并根据它找到的内容返回一个包含适当列的记录。这将允许您在填充新列（或表）之前使用 SELECT 语句调试函数。然后您可以在`INSERT`/`SELECT`或中使用查询`UPDATE ... FROM`。

您可以使用 plpgsql 语言作为函数，使用 PostgreSQL 正则表达式字符串函数；但如果你精通 perl 或 python，你可能想用其中一种语言编写函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-09T12:49:18.667

我这样做了：

select split_part(( case when
strpos(l.info,'Driver:') >= 1 then substr(l.info,strpos(l.info,'Driver:')+10, strpos(l.info,'Driver: ')+9) end),E'\n',1) 作为车库司机

一点也不漂亮，但根据我的需要返回数据

# xml - 如何从 XML 元素中去除文本、重新排列并与 XSLT 连接？

> ID：11867311
> 
> 赞同：1
> 
> 时间：2012-08-08T14:56:51.673
> 
> 标签：xml, xslt, xpath-1.0

考虑以下 XML：

```
<root>
  <contrib contrib-type="author">
    <name>
      <last-name>Simpson</last-name>
      <first-name>Bart</first-name>
    </name>
  </contrib>

  <contrib contrib-type="author">
    <name>
      <last-name>Zoidberg</last-name>
      <first-name>Dr.</first-name>
    </name>
  </contrib>
</root> 
```

...如何转换这些元素的内容以获得此输出？

```
<Authors contrib-type="author">Bart Simpson</Authors>
<Authors contrib-type="author">Dr. Zoidberg</Authors> 
```

* * *

我正在尝试将 的内容  `<first-name>`  与 的内容  连接起来`<last-name>` ，并**用一个空格分隔**。

此外，不需要任何子元素  `Authors` （如果可能，去掉  `<name>` 、  `<first-name>` 和  `<last-name>`  元素）。

* * *

这是我到目前为止的 XSL（*不起作用*）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output omit-xml-declaration="yes" indent="yes" method="xml"/>
<xsl:strip-space elements="*"/>

    <!-- identity rule -->
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

        <!-- Authors -->
        <xsl:template match="contrib[@contrib-type='author']">
            <Authors>
                <xsl:apply-templates select="@*|node()"/>
                <xsl:value-of select = "concat(given-names, surname)" />
            </Authors>
        </xsl:template>

</xsl:stylesheet> 
```

到目前为止，我能够将  `<contrib>`  元素转换为  `<Authors>` ，但无法连接或剥离其子元素......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:09:42.757

尝试这样简单的事情：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output indent="yes" method="xml" omit-xml-declaration="yes"/>
<xsl:strip-space elements="*"/>
<xsl:template match="/">
    <root>
        <xsl:apply-templates select="/root/contrib"/>
    </root>
</xsl:template>
<!-- Authors -->
<xsl:template match="contrib[@contrib-type='author']">
    <Authors>
        <xsl:copy-of select="@*"/>
        <xsl:value-of select="name/first-name"/>
        <xsl:text> </xsl:text>
        <xsl:value-of select="name/last-name"/>
    </Authors>
</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:14:08.383

除非我错过了重点，否则将您的 Authors 模板更改为以下内容应该可以：

```
<!-- Authors -->
<xsl:template match="contrib[@contrib-type='author']">
    <Authors>
        <xsl:apply-templates select="@*"/>
        <xsl:value-of select = "concat(normalize-space(name/first-name/text()), 
                                       ' ', 
                                       normalize-space(name/last-name/text()))" />
    </Authors>
</xsl:template> 
```

输出：

```
<root>
  <Authors contrib-type="author">Bart Simpson</Authors>
  <Authors contrib-type="author">Dr. Zoidberg</Authors>
</root> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:14:14.917

试试这个：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output omit-xml-declaration="yes" indent="yes" method="xml"/>
<xsl:strip-space elements="*"/>

    <!-- identity rule -->
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

        <!-- Authors -->
        <xsl:template match="contrib[@contrib-type='author']">
            <Authors contrib-type="{@contrib-type}">
                <xsl:value-of select = "concat(name/first-name, ' ', name/last-name)" />
            </Authors>
        </xsl:template>

</xsl:stylesheet> 
```

我希望这会有所帮助

# android - GetView 方法和 convertView 的误解？

> ID：11867319
> 
> 赞同：3
> 
> 时间：2012-08-08T14:57:07.300
> 
> 标签：android, android-layout

我已经阅读了好几次关于 GetView DataAdapter 类的 android 文档。据我了解，如果我有一个同质列表，其中每个项目都只是一个文本视图，并且所有项目都落在屏幕内（不可能滚动），则不会有任何视图回收，所以我应该收到 4 次调用 GetView convertView 为空。好吧，这不是发生在我身上的事情。第一次 convertView 为空，但其他 3 个创建的项目相同。列表已正确填充，但我想了解为什么会发生这种情况。如果有人可以提供帮助，我将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:03:55.330

我相信 Android 总是试图回收视图，因为这将使填充速度最快。是否所有视图都适合列表的可见视口并不重要。膨胀/创建视图非常昂贵，这就是 Android 想要尽可能多地回收的原因。

您可以保证传递给 GetView 的视图将具有相同的视图类型（在数据适配器中定义）或为空。如果为 null，则需要为该视图类型创建一个新视图，否则应尝试重用传入的视图。对于 TextView 的同构列表，这非常简单：

```
if (convertView == null)
{
    TextView tv = new TextView();
    ....
    tv.setText("First Item");
}
else
{
    TextView tv = (TextView) convertView;
    ...
    tv.setText("Recycled Item");
} 
```

为简单起见，您总是可以返回一个新视图而不是使用 convertView，但性能不会那么好。

# mysql - 我可以将我的分数值保存在基于 TEXT 的 MySQL 位置吗？

> ID：11867324
> 
> 赞同：0
> 
> 时间：2012-08-08T14:57:15.157
> 
> 标签：mysql, sql

> **可能重复：**
> [在 MySQL 中存储非常大的整数](https://stackoverflow.com/questions/1211413/storing-very-large-integers-in-mysql)

您好我正在创建一个浏览器游戏，分数可以高于 11 个字符。所以我了解到，它`INT`可以保留 11 个字符以下的信息。

我可以保留它们的`TEXT`格式吗，如果我这样做会不会有任何潜在的问题和风险？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T14:59:55.897

是的，你可以，但首先尝试使用 bigint。是的，存在风险，例如，您将遇到一些错误，试图获取分数 > 任何值或精确某个值的字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:04:30.680

**[MYSQL 数字数据类型见此处](http://dev.mysql.com/doc/refman/5.0/en/integer-types.html)**

我会推荐`BIGINT`，但请注意最大值`BIGINT`为`9223372036854775807`. 确保您可以处理来自`OverFlow`ing的值

```
mysql> SELECT (9223372036854775807 + 1) as Result;
+-------------------------+
| Result                  |
+-------------------------+
|    -9223372036854775808 |
+-------------------------+ 
```

为了在这种情况下使操作成功，请将值转换为无符号；

```
mysql> SELECT (CAST(9223372036854775807 AS UNSIGNED) + 1) as Result;
+-------------------------------------------+
| Result                                    |
+-------------------------------------------+
|                       9223372036854775808 |
+-------------------------------------------+ 
```

# svn - 确定从 Subversion 导出的版本？

> ID：11867327
> 
> 赞同：0
> 
> 时间：2012-08-08T14:57:17.380
> 
> 标签：svn, export, revision

关于版本控制，特别是 SVN，我如何识别导出的修订版本，而不知道是谁导出的或何时导出的？

我已经检查了 SVN 关键字，但它们似乎没有做我想要的。

创建一个包含修订号的文件并将其与导出一起分发对我来说似乎也不安全，因为该文件可能被操纵或删除。

那么有没有办法将实际文件与版本控制中的文件进行比较以确定修订号？（或任何其他可靠的方式，就此而言）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T18:04:23.493

由于`svn export`删除了源与颠覆的连接；颠覆不会有任何帮助。

正如您所说，您所能做的就是将版本号保存在文件中，并将其用作指示符。

# apache - osFileManager 我应该使用哪个软件包？

> ID：11867329
> 
> 赞同：0
> 
> 时间：2012-08-08T14:57:21.200
> 
> 标签：apache, xampp, wamp, lamp, wampserver

我需要使用 osFileManager。所以我需要在 Windows 上设置一个网络服务器。哪个包最好？

只能在专用 LAN 上访问 PC。

我尝试下载 Apache、PHP、PHPAdmin 和 MySQL，但配置和安装软件非常困难。所以我正在寻找一个可以完成所有工作并设置服务器的安装程序。

有几个包 WAMP、XAMP、LAMP，听起来都很棒，但我需要一个最适合这个特定开源项目的包。

我也愿意使用克隆。整个目的是每周上传一个文件（替换现有文件）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T20:35:02.880

我会推荐 XAMPP。我花了好几次才正确配置它。写下一切。最新的包配置很快。

其他提示：

*   保存网络服务器的原始图像
*   保存 Windows 框的原始图像
*   在此过程中进行备份。例如，使用 Oracle Virtual Box 之类的工具在 Windows XP 环境中对其进行配置。如果您有 OEM 产品密钥，则可以在虚拟机中使用它，但我不确定。专业许可证将可在 VM 中使用。

# javascript - 如何识别最后一个 DOMSubtreeModified 被触发？

> ID：11867331
> 
> 赞同：1
> 
> 时间：2012-08-08T14:57:34.743
> 
> 标签：javascript, dom, jquery

当我使用“DOMSubtreeModified”时，我会触发多个，有时是 30 多个事件。是否可以确保仅在最后一次 DOMSubtreeModified 被触发时才调用我的函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T15:09:13.367

Kevin B 提到的油门的实现：

```
function throttle( fn, time ) {
    var t = 0;
    return function() {
        var args = arguments,
            ctx = this;

            clearTimeout(t);

        t = setTimeout( function() {
            fn.apply( ctx, args );
        }, time );
    };
}

document.addEventListener("DOMSubtreeModified", throttle( function() {
    //code
}, 50 ), false ); 
```

如果可能的话，让你的代码独立于 DOM 突变事件，因为它们比 eval 更邪恶，并且结合了

# ontouchlistener - 触摸（非点击）监听器

> ID：11867333
> 
> 赞同：0
> 
> 时间：2012-08-08T14:57:39.063
> 
> 标签：ontouchlistener

过去两天我试图在 Android API7 中编写简单的拖放功能，但我一直遇到问题。现在有了触摸监听器。我使用 onTouchListener 但 onTouch 方法只有当我在 UI 元素上按下屏幕时才会调用它。当我在另一个地方按下屏幕然后我将手指移到指定 onTouchListener 的元素上方时，什么也没发生。为什么？是否有任何适用于 android 的侦听器，它可以在不点击 UI 元素所在位置的屏幕的情况下捕获触摸事件？感谢您的帮助，因为我今天要疯了；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T20:56:10.757

onTouchListener 仅用于视图。你可以将它用于任何布局（例如，LinearLayout）。如果您的布局带有“fill_parent”参数，它将适用于您的所有屏幕。您还需要控制您的 ACTION_DOWN、UP 和 MOVE 参数。也许这个样本可以帮助你：

```
import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnTouchListener;
import android.widget.LinearLayout;

public class main extends Activity implements OnTouchListener{
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    LinearLayout ll =(LinearLayout)this.findViewById(R.id.ll);
    ll.setOnTouchListener(this);
}

@Override
public boolean onTouch(View v, MotionEvent event)
{
    int action=event.getAction();
    StringBuilder str=new StringBuilder();
    str.append("\nActrion type: ");

    switch(action)
    {
        case MotionEvent.ACTION_DOWN: str.append(«ACTION_DOWN\n»);break;
        case MotionEvent.ACTION_MOVE: str.append(«ACTION_MOVE\n»);break;
        case MotionEvent.ACTION_UP: str.append(«ACTION_UP\n»);break;
    }

    Log.v(«Mytag», str.toString());
    return true;
}
} 
```

# php - PHP preg_split 有两个分隔符并且只捕获一个

> ID：11867342
> 
> 赞同：0
> 
> 时间：2012-08-08T14:58:06.990
> 
> 标签：php, regex, delimiter, preg-split

正则表达式真的很差，提前见谅！

我已经尽力弄清楚如何将字符串拆分为带有两个分隔符的数组，并且仍然捕获一个并将其包含在最终数组中。`preg_split`似乎很适合这个，但我的正则表达式让我失望了。

例如，如果我有字符串`foo = bar AND bar=foo`；我想将字符串拆分为空格或`=`字符但保留，`=`因此数组看起来像：

```
Array
(
    [0] => foo
    [1] => =
    [2] => bar
    [3] => AND
    [4] => bar
    [5] => =
    [6] => foo
) 
```

不幸的是，我得到了这个：

```
Array
(
    [0] => foo
    [1] => 
    [2] => =
    [3] => 
    [4] => bar
    [5] => AND
    [6] => bar
    [7] => =
    [8] => foo
) 
```

我已经有了这段代码（在 PHP 中）：

```
<!doctype html>
<?php

$string = 'foo = bar AND bar=foo';

$array = preg_split('/ +|(=)/', $string, -1, PREG_SPLIT_DELIM_CAPTURE);

?>
<pre>
<?php

print_r($array);

?>
</pre> 
```

我真的很感谢你们能提供的任何帮助，谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:06:34.723

要么使用[`PREG_SPLIT_NO_EMPTY`](http://php.net/preg_split)核对“空”匹配：

```
$array = preg_split('/ +|(=)/', $string, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY); 
```

或者，[更改正则表达式](http://php.net/regexp.reference.escape)，使其不会产生空匹配：

```
$array = preg_split('/ +|(?<!\G)(=)/', $string, -1, PREG_SPLIT_DELIM_CAPTURE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T14:59:59.063

添加`PREG_SPLIT_NO_EMPTY`标志：

```
$string = 'foo = bar AND bar=foo';
$array = preg_split('/ +|(=)/', $string, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY); 
```

现在，[这输出](http://viper-7.com/rztbU5)：

```
Array
(
    [0] => foo
    [1] => =
    [2] => bar
    [3] => AND
    [4] => bar
    [5] => =
    [6] => foo
) 
```

# php - DOMDocument 无法解析 XML

> ID：11867345
> 
> 赞同：1
> 
> 时间：2012-08-08T14:58:12.870
> 
> 标签：php, zend-framework, feed, domdocument, zend-feed

我正在使用`Zend_Feed_Atom`从网站获取提要，但收到此错误：

信息：

> DOMDocument 无法解析 XML：DOMDocument::loadXML() [domdocument.loadxml]：xmlParseEntityRef：实体中没有名称，行：827

我尝试了另一个站点，但没有错误。我想知道为什么我会在该特定页面上出现错误，以及这个错误是什么意思。我在网上看过，它说这是编码的问题（我不太明白）。

我的代码很简单，它只是

```
if($type_feed == "atom"){
    $nfeed = new Zend_Feed_Atom($address);  
}elseif($type_feed == "rss"){
    $nfeed= new Zend_Feed_RSS($address);
} 
```

任何帮助都是极好的！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-05-08T07:49:08.490

看看这里：[http ://www.php.net/manual/en/class.domdocument.php#domdocument.props.recover](http://www.php.net/manual/en/class.domdocument.php#domdocument.props.recover)

> 所有权。启用恢复模式，即尝试解析格式不正确的文档。此属性不是 DOM 规范的一部分，而是特定于 libxml。

你可以试试：

```
$dom = new DOMDocument();
$dom->recover = true; 
```

另外，看看我的实现：[https ://gitlab.com/DeepRSS/Reader/blob/a2723735ff3e3cdd7d85649c92d0115211ea9a0d/src/Core/Service/ZendReader/FeedParser.php#L99](https://gitlab.com/DeepRSS/Reader/blob/a2723735ff3e3cdd7d85649c92d0115211ea9a0d/src/Core/Service/ZendReader/FeedParser.php#L99)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T08:23:14.640

如果饲料被破坏了，那么它就被破坏了，我们对此无能为力。

解决此问题的一种方法是使用`@`来抑制错误。

```
if($type_feed == "atom"){
    $nfeed = @new Zend_Feed_Atom($address);  
}elseif($type_feed == "rss"){
    $nfeed= @new Zend_Feed_RSS($address);
} 
```

请注意，这并不理想，因为它会在`new`调用时抑制所有内容。

# java - 并发读取文件（首选java）

> ID：11867348
> 
> 赞同：27
> 
> 时间：2012-08-08T14:58:15.947
> 
> 标签：java, file, concurrency, io

我有一个需要几个小时才能处理的大文件。所以我正在考虑尝试估计块并并行读取块。

是否可以同时读取单个文件？我已经同时查看了两者`RandomAccessFile`，`nio.FileChannel`但是基于其他帖子，我不确定这种方法是否可行。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-08T16:01:46.930

这里最重要的问题是**您的情况的瓶颈是什么**。

如果瓶颈是您的**磁盘 IO**，那么您在软件部分无能为力。并行计算只会让事情变得更糟，因为同时从不同部分读取文件会降低磁盘性能。

如果瓶颈是**处理能力**，并且您有多个 CPU 内核，那么您可以利用启动多个线程来处理文件的不同部分。您可以安全地创建多个`InputStream`s 或`Reader`s 来并行读取文件的不同部分（只要您不超过操作系统对打开文件数量的限制）。您可以将工作分成任务并并行运行，如下例所示：

```
import java.io.*;
import java.util.*;
import java.util.concurrent.*;

public class Split {
    private File file;

    public Split(File file) {
        this.file = file;
    }

    // Processes the given portion of the file.
    // Called simultaneously from several threads.
    // Use your custom return type as needed, I used String just to give an example.
    public String processPart(long start, long end)
        throws Exception
    {
        InputStream is = new FileInputStream(file);
        is.skip(start);
        // do a computation using the input stream,
        // checking that we don't read more than (end-start) bytes
        System.out.println("Computing the part from " + start + " to " + end);
        Thread.sleep(1000);
        System.out.println("Finished the part from " + start + " to " + end);

        is.close();
        return "Some result";
    }

    // Creates a task that will process the given portion of the file,
    // when executed.
    public Callable<String> processPartTask(final long start, final long end) {
        return new Callable<String>() {
            public String call()
                throws Exception
            {
                return processPart(start, end);
            }
        };
    }

    // Splits the computation into chunks of the given size,
    // creates appropriate tasks and runs them using a 
    // given number of threads.
    public void processAll(int noOfThreads, int chunkSize)
        throws Exception
    {
        int count = (int)((file.length() + chunkSize - 1) / chunkSize);
        java.util.List<Callable<String>> tasks = new ArrayList<Callable<String>>(count);
        for(int i = 0; i < count; i++)
            tasks.add(processPartTask(i * chunkSize, Math.min(file.length(), (i+1) * chunkSize)));
        ExecutorService es = Executors.newFixedThreadPool(noOfThreads);

        java.util.List<Future<String>> results = es.invokeAll(tasks);
        es.shutdown();

        // use the results for something
        for(Future<String> result : results)
            System.out.println(result.get());
    }

    public static void main(String argv[])
        throws Exception
    {
        Split s = new Split(new File(argv[0]));
        s.processAll(8, 1000);
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-08T15:28:04.043

如果您有多个独立的轴，您可以并行读取大文件。例如，如果您有一个 Raid 0 + 1 剥离文件系统，您可以通过触发对同一文件的多个并发读取来看到性能改进。

但是，如果您有像 Raid 5 或 6 这样的组合文件系统或普通的单个磁盘。很有可能顺序读取文件是从该磁盘读取的最快方式。注意：操作系统足够聪明，可以在看到您按顺序读取时预取读取，因此使用额外的线程来执行此操作不太可能有帮助。

即使用多个线程不会让你的磁盘更快。

如果您想更快地从磁盘读取，请使用更快的驱动器。典型的 SATA HDD 可以读取大约 60 MB/秒并执行 120 IOPS。典型的 SATA SSD 驱动器可以以大约 400 MB/s 的速度读取并执行 80,000 IOPS，而典型的 PCI SSD 可以以 900 MB/s 的速度读取并执行 230,000 IOPS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T15:03:10.063

如果您正在从硬盘驱动器读取文件，那么获取数据的最快方法是从头到尾读取文件，即不是同时读取。

现在，如果处理需要时间，那么这可能会受益于让多个线程同时处理不同的数据块，但这与您读取文件的方式无关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T15:29:52.627

您可以并行处理，但是您的硬盘一次只能读取一条数据。如果您使用单个线程读取文件，则可以使用多个线程处理数据。

# java - java中“To”的正则表达式

> ID：11867352
> 
> 赞同：2
> 
> 时间：2012-08-08T14:58:32.560
> 
> 标签：java, regex

我得到了很多这种格式的字符串`Person To Company`。例如`Joe To Fedex`. 我需要的是一个简单的正则表达式，它可以得到这两个不同的部分。我需要这个人和公司。

我想出了这个：

```
"\\b\\s[Tt][Oo]\\s\\b" 
```

虽然这不太正确，但它并没有真正帮助我真正解析出我需要的部分。关于如何在 Java 中实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:02:13.833

```
Pattern regex = Pattern.compile("(\\S+)\\s+to\\s+(\\S+)", Pattern.CASE_INSENSITIVE);
Matcher regexMatcher = regex.matcher(subjectString);
if (regexMatcher.find()) {
    fromstr = regexMatcher.group(1);
    tostr = regexMatcher.group(2);

} 
```

应该为此工作。（`\S`匹配任何非空白字符。如果你只想匹配字母，你可以使用`\p{L}`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:02:32.277

像这样拆分字符串：

```
String[] split = someString.split("(?i)\\s+TO\\s+") 
```

第一部分在 split[0] 中，第二部分在 split[1] 中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:15:23.750

您只需要在 Matcher 中获取 group 方法。

```
String regx = "(\\w*)\\s[Tt][Oo]\\s(\\w*)";
String src = "Joe To Fedex";
Matcher matcher = Pattern.compile(regx).matcher(src);
while(matcher.find()){
    System.out.println(matcher.group(0));
    System.out.println(matcher.group(1));
    System.out.println(matcher.group(2));
} 
```

# c# - WCF 与辅助角色 Azure 绑定

> ID：11867354
> 
> 赞同：0
> 
> 时间：2012-08-08T14:58:35.320
> 
> 标签：c#, visual-studio-2010, wcf, binding

我正在使用 VSTS 2010 + C# + .Net 4.0。我正在尝试在 Windows Azure 中托管 WCF。在worker角色执行以下语句时，出现以下绑定未找到错误。这里我正在手动配置wcf。

```
ServiceHost host = new ServiceHost(typeof(AzureWcfService)); 
```

我收到错误消息：

> 找不到配置绑定扩展“system.serviceModel/bindings/NetTcpBinding”。验证此绑定扩展是否已在 system.serviceModel/extensions/bindingExtensions 中正确注册并且拼写正确。

我的 ServiceDefinition.csdef 文件如下

```
<Endpoints>

  <InputEndpoint name="port" protocol="tcp" port="9001" />
  <InputEndpoint name="mexport" protocol="tcp" port="8001" />
</Endpoints> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:12:08.137

尝试将其添加到您的 app.config 中，您可能想要使用`netTcpRelayBinding`Azure 的负载平衡友好绑定：

```
<extensions>

  <behaviorExtensions>
    <add name="connectionStatusBehavior" type="Microsoft.ServiceBus.Configuration.ConnectionStatusElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="transportClientEndpointBehavior" type="Microsoft.ServiceBus.Configuration.TransportClientEndpointBehaviorElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="serviceRegistrySettings" type="Microsoft.ServiceBus.Configuration.ServiceRegistrySettingsElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </behaviorExtensions>
  <bindingElementExtensions>
    <add name="netMessagingTransport" type="Microsoft.ServiceBus.Messaging.Configuration.NetMessagingTransportExtensionElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="tcpRelayTransport" type="Microsoft.ServiceBus.Configuration.TcpRelayTransportElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="httpRelayTransport" type="Microsoft.ServiceBus.Configuration.HttpRelayTransportElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="httpsRelayTransport" type="Microsoft.ServiceBus.Configuration.HttpsRelayTransportElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="onewayRelayTransport" type="Microsoft.ServiceBus.Configuration.RelayedOnewayTransportElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </bindingElementExtensions>
  <bindingExtensions>
    <add name="basicHttpRelayBinding" type="Microsoft.ServiceBus.Configuration.BasicHttpRelayBindingCollectionElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="webHttpRelayBinding" type="Microsoft.ServiceBus.Configuration.WebHttpRelayBindingCollectionElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="ws2007HttpRelayBinding" type="Microsoft.ServiceBus.Configuration.WS2007HttpRelayBindingCollectionElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="netTcpRelayBinding" type="Microsoft.ServiceBus.Configuration.NetTcpRelayBindingCollectionElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="netOnewayRelayBinding" type="Microsoft.ServiceBus.Configuration.NetOnewayRelayBindingCollectionElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="netEventRelayBinding" type="Microsoft.ServiceBus.Configuration.NetEventRelayBindingCollectionElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <add name="netMessagingBinding" type="Microsoft.ServiceBus.Messaging.Configuration.NetMessagingBindingCollectionElement, Microsoft.ServiceBus, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </bindingExtensions>
</extensions> 
```

# python - 什么时候需要在 python 中使用 global 关键字

> ID：11867359
> 
> 赞同：8
> 
> 时间：2012-08-08T14:58:42.823
> 
> 标签：python

好的，所以我遇到了一个非常烦人的问题，即在本地设置了一个变量，但在该函数之外又恢复为原来的自我（在这种情况下为无），但同时我可以操纵其他变量，并且仍然可以不使用“全局”关键字。

我无法为此提供真正的代码，但它是这样的：

```
foo = {}
foo_foo = {}
bar = None

def changes_foo():
    ...do some stuff to foo...

class EditThread(threading.Thread):

    def __init__(self):
        setup()

    def run(self):
       for key, value in foo.items():
           do_update_task(key, value)

    def do_update_task(self, key, value):
         ...do some editing too foo...
         del foo[key]
         bar = [key, value]
         foo_foo[key] = value

def print_the_bar():
    print bar 
```

请注意，所有的操作`foo`和`foo_foo`工作都很好，但是当我调用 bar 时仍然是 None `print_the_bar`，并且我的代码中有很多打印语句来验证里面的 bar`do_update_task`确实具有正确的值并且不是 None。

有人可以向我解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-08T15:06:05.687

如果只需要在函数中*读取*全局变量的值，则不需要 global 关键字：

```
x = 3
def f():
    print x 
```

如果您*曾经*设置过全局变量的值，则需要使用关键字，这样您就不会创建局部变量：

```
x = 3
def f():
    global x
    x = 5

f()
print x 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-08T15:05:22.550

当您对 foo 和 foo_foo 执行操作时，您不会更改引用：

```
foo = {}
foo['key'] = 'stuff' 
```

`foo`仍然指代同一个对象；它刚刚包含更多数据。

```
bar = ['key', 'value'] 
```

这**重新分配** `bar`以引用一个新对象（具有两个元素的列表）。

但是，当在函数中遇到该行时，它会创建一个**本地**引用`bar`，除非您说`global bar`. 实际上，您有两个不同`bar`的变量名为：全局变量和局部变量。

Saying`global bar`告诉 Python 使用全局版本`bar`而不是创建具有相同名称的新局部变量。

一般来说，如果你在修改全局变量，你应该`global varname`为每个变量声明，以避免意外创建一个局部变量。

或者，您可以使用一个类：

```
class State(object):
    def __init__(self):
        self.foo = {}
        self.foo_foo = {}
        self.bar = None

state = State()

def fn():
    state.bar = ['key', 'value'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:13:19.570

您可以在函数内从全局范围读取变量，但如果不使用“global”关键字，则无法修改它们的值。

当您尝试设置`bar =[key, value]`时，一个新`bar`变量会添加到您的函数的命名空间中。从那时起，`bar`引用这个新变量，而不是全局变量。

尽管您可以读取 global`bar`的值，但是一旦您尝试从函数中重新为其分配值，您实际上已经创建了一个新值`bar`并且没有对全局值进行操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:01:32.083

您在函数中定义的变量只能从此函数的主体中访问。

# programming-languages - 我正在寻找一种可以提供大量关于作为对象的函数的信息的语言

> ID：11867361
> 
> 赞同：1
> 
> 时间：2012-08-08T14:58:49.583
> 
> 标签：programming-languages

我正在寻找一种静态类型语言，它不仅将函数视为第一类对象，而且可以读取输入的数量及其类型，以及输出的数量及其类型。

我认为如果我修补 Function1 特征，那么 scala 可能会实现这一点，但这似乎很不优雅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:48:20.690

在静态类型语言中，该信息存在于函数的类型中。如果代码类型检查，那是因为所有这些信息都正确匹配。

确实，该信息通常不能以显式形式或在运行时提供，但那是因为它通常没有用处（此外，它违反了[Parametricity](http://en.wikipedia.org/wiki/Parametricity "参数化")）。在不知道您想要这些信息的目的的情况下，很难提供更多建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T18:32:54.743

到目前为止，我认为能够做到这一点的语言是：

Javascript、Ruby 和 C#。

# c++ - 循环队列和循环链表

> ID：11867362
> 
> 赞同：3
> 
> 时间：2012-08-08T14:58:53.480
> 
> 标签：c++, linked-list, queue

我想在循环队列和循环单链表之间有一个明显的区别？？虽然一开始，两者看起来几乎一样......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T15:13:54.607

**循环队列**或循环缓冲区：是一种实现队列的方式。例如，假设您想使用数组实现队列。你会有你的`enqueue()`和`dequeue()`方法。

假设底层数组的长度为 7，并且用户将五个值排入队列，那么底层数组中的值如下所示：

```
 head                   tail
position:  | 0 | 1  | 2 | 3 | 4  |   5  |   6  |
value:     | 3 | 12 | 5 | 4 | 71 | free | free | 
```

现在用户想要出列一个元素，`3`从 position中删除值`0`。作为队列实现者，您必须弄清楚如何处理这个问题。一个基本的解决方案是将所有值向下移动一个位置，因此底层数组现在看起来像这样：

```
 head               tail
position:  | 0  | 1 | 2 | 3  | 4    |   5  |   6  |
value:     | 12 | 5 | 4 | 71 | free | free | free | 
```

但这可能需要在每次出队时不必要地复制大量值！避免这种情况的一种方法是说您的头部现在位于位置 1 而不是 0，

```
 head               tail
position:  |   0  | 1  | 2 | 3 | 4  |   5  |   6  |
value:     | free | 12 | 5 | 4 | 71 | free | free | 
```

所以现在每次添加新元素时，只需将其添加到`tail`（并增加`tail`位置），如果删除元素，只需移动`head`. 这样您就不必进行任何不必要的复制。

一旦`tail`到达数组的末尾，它将开始环绕到数组的开头——即队列将在底层数组上“循环”移动。例如，经过几次入队和出队后，底层数组将如下所示：

```
 tail                head
position:  | 0  |   1  |   2  |   3  | 4  | 5  | 6 |
value:     | 91 | free | free | free | 71 | 22 | 8 | 
```

尾部现在缠绕到数组的开头。

**循环链表**：头指向尾的链表。它是一种通用的圆形结构。它可用于实现循环队列/缓冲区，也可用于其他用途。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:00:43.570

看看这个：http: [//www.vias.org/cppcourse/chap20_05.html](http://www.vias.org/cppcourse/chap20_05.html)你会注意到一个循环队列在标准定义中被实现为一个数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-19T16:46:32.420

循环链表和循环队列/循环缓冲区/环形缓冲区的主要区别在于：

*   在循环链表中，最后一个节点的下一个指针指向（链表的）头。在循环缓冲区中，我们只需在前后维护两个索引，它们指向缓冲区的开头和结尾。

*   除非另有说明（插入或删除的位置），否则它发生在末尾/尾部。如果 Circular Buffer 删除发生在前面的索引处，而添加发生在尾部；即，消费者从缓冲区的前面消费，生产者追加到最后。

# glassfish - Glassfish 3/EJB 3\. 独立的 java 客户端

> ID：11867366
> 
> 赞同：1
> 
> 时间：2012-08-08T14:59:04.337
> 
> 标签：glassfish, client, ejb, javabeans

我正在使用 Glassfish 3.1.2 在 netbeans API 之上开发一个应用程序。我的 netbeans 应用程序应该是我必须连接到 EJB 的独立 Java 客户端。

我已将我的 EJB 打包到 EAR（企业应用程序）中。我面临的问题是当我尝试查找可用的 EJB 时出现异常。

这是我的 bean 会话：

```
@Stateless
@EJB(name = "java:global/AltServer", beanInterface = AltServerRemote.class)
public class AltServer implements AltServerRemote { 
```

远程接口：

```
@Remote
public interface AltServerRemote { 
```

最后是查找调用：

```
props.setProperty("org.omg.CORBA.ORBInitialHost", getGlassfishHostname());
props.setProperty("org.omg.CORBA.ORBInitialPort", getServerPort());
ctx = new InitialContext(props)

ctx.lookup("java:global/AltServerEnt/AltServer-ejb/AltServer") 
```

关于如何查找打包到 EAR 中的 EJB，我遵循了这个：[http](http://glassfish.java.net/javaee5/ejb/EJB_FAQ.html#CosNaming) : //glassfish.java.net/javaee5/ejb/EJB_FAQ.html#CosNaming 并找到了 jndi 语法：

```
java:global[/<app-name>]/<module-name>/<bean-name> 
```

所以在我的例子中，我的企业应用程序是**AltServerEnt**，我的 EJB 模块是**AltServer-ejb**，我的会话 bean 被称为**AltServer**（见上文）。

注意：我在会话 bean 中使用了 @EJB 注释来指定一个名称，如我在上面链接的常见问题解答中解释的那样，我不确定当 EJB 是 EAR 的一部分时它是否合适。有人知道吗？

这是我得到的异常，在查找行提出：

```
java.lang.ClassNotFoundException: com.sun.ejb.codegen.GenericEJBHome_Generated 
```

有很多“Caused”子句，但这里是第一个：

```
javax.naming.NamingException: Lookup failed for 'java:global/AltServerEnt/AltServer-ejb/AltServer' in SerialContext[myEnv={org.omg.CORBA.ORBInitialPort=3700, java.naming.factory.initial=com.sun.enterprise.naming.impl.SerialInitContextFactory, org.omg.CORBA.ORBInitialHost=127.0.0.1, java.naming.factory.url.pkgs=com.sun.enterprise.naming, java.naming.factory.state=com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl} [Root exception is javax.naming.NamingException: ejb ref resolution error for remote business interfaceorg.altanis.remote.AltServerRemote [Root exception is java.lang.RuntimeException: Could not invoke defineClass!]] 
```

所以我想我的会话 bean 没有找到，但为什么？我的 JNDI 语法不对？

编辑：只是要注意我的项目组织：

*   AltServerEnt：企业应用程序 - 包含 EJB 模块
*   AltServer-ejb：EJB 模块 - 包含会话 bean 和包含远程接口 (AltServerRemote) 的 netbeans 插件。

谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:07:38.380

EAR/EJB 显然已部署。因此，打开 Glassfish 管理控制台，例如`https://<host>:4848`并登录。在左侧，浏览`Applications`并单击您的应用程序以显示“编辑应用程序”屏幕。检查显示的应用程序名称和组件名称 - 并与您的期望进行比较。

我目前没有部署任何远程 EJB，所以我无法确认 - 但我认为对于远程 EJB，`Action`列下可能有一个链接来显示 URL。

### 命名选项

1.  使用名称`AltServer`作为 EJB 的名称：`name="EJB(name = "AltServer" ...)`. 使用“简单名称”，可以在各种 JNDI 命名空间（global/app/module）中找到 bean；您的查找`ctx.lookup("java:global/AltServerEnt/AltServer-ejb/AltServer")`应该有效。

2.  如果添加前缀`java:global`，则直接在 JNDI 全局命名空间中声明了名称；您将能够使用相同的名称直接在该名称空间中查找您的 bean `java:global/AltServer`：。是的，您仍然应该能够在其他命名空间中访问它 - 请参见第一段。

### 还

你问：“我已经在我的会话 bean 中使用了 @EJB 注释来指定一个名称，就像我在上面链接的常见问题解答中解释的那样，我不确定当 EJB 是 EAR 的一部分时它是否合适。有人知道吗？”

没关系，这完全取决于你想要什么。像所有命名空间一样，人们可能会考虑避免过度填充命名空间——尤其是全局命名空间。考虑片刻，然后做出决定 - 并准备好在需要时重新考虑:-)

# apache-flex - 无法解析“WindowedApplication”

> ID：11867367
> 
> 赞同：1
> 
> 时间：2012-08-08T14:59:10.903
> 
> 标签：apache-flex, air, fdt

这是我的示例代码：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" paddingBottom="0" 
    paddingLeft="0" paddingRight="0" paddingTop="0"/> 
```

我收到以下错误：

无法解析“WindowedApplication”。在第 2 行第 4 列找到。

我正在使用 FDT 5 和 flex_sdk_4.6 设置。

任何人都可以帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:18:15.983

您的类路径中缺少 Flex 框架。

您需要一个包含 Flex 框架的项目类型。您可能忘记检查“使用 Flex 框架”按钮（下图）。

![在此处输入图像描述](../Images/90d0293b1fb049494913044c79206ad1.png)

## 要更改项目类型：

**右键单击您的项目并转到 Flash 项目>设置项目类型：** ![在此处输入图像描述](../Images/6fece295a17496422d5d654690ad7075.png)

**选择空气弹性：** ![在此处输入图像描述](../Images/852f4b632040c86174080c0efc9182bc.png)

## 在项目创建时选择 Flex：

![在此处输入图像描述](../Images/8e40bccfd340ed25b90b75a44ee00301.png)

# iphone - cocos2d - 在 UIKit 应用程序中创建 CCSprite

> ID：11867369
> 
> 赞同：0
> 
> 时间：2012-08-08T14:59:19.827
> 
> 标签：iphone, cocos2d-iphone, ccsprite

我有一个普通的 UIKit 应用程序，但我想用 cocos2d 做一些小工作。我想使用函数 glReadPixels，为此我需要一个 cocos2d 图像 -> CCSprite。

我现在在这个问题上工作了 2 天，因为我收到了这个错误：

> 2012-08-08 16:58:50.673 iBlaulicht 2[11801:16a03] *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“****+[NSString stringWithCString:encoding:]: NULL cString' ** * First throw call stack: (0x1f88022 0x1b9bcd6 0x1f30a48 0x1f309b9 0x16050c7 0x62687 0x62589 0x62317 0x86979 0x47c5c 0x2d63 0xdc5a1e 0x222d 0xcfc386 0xcfd274 0xd0c183 0xd0cc38 0xd00634 0x338cef5 0x1f5c195 0x1ec0ff2 0x1ebf8da 0x1ebed84 0x1ebec9b 0xcfcc65 0xcfe626 0x20cb 0x2065) terminate称为抛出异常（lldb）*

 *这是我的代码：

```
 - (id)initWithImage:(UIImage *)drawnImage{

    if (self == [super init]) {

        CCTexture2D *tex = [[[CCTexture2D alloc] initWithImage:drawnImage resolutionType:kCCResolutionRetinaDisplay] autorelease];
        CCSprite *imageSprite = [CCSprite spriteWithTexture:tex];

        imageSprite.position = CGPointMake(0, 0 );
        [self addChild:imageSprite];

    }

    return self;
}

- (NSArray *)determinePixels{

    for (int y_direction = 0; currentImage.size.height > y_direction; y_direction += 20) {

        for (int x_direction = 0; currentImage.size.width > x_direction; x_direction += 20) {

            Byte pixelColor[4];
            glReadPixels(x_direction, y_direction, 1, 1, GL_RGB, GL_UNSIGNED_BYTE, &pixelColor[0]);

            // Just to test
            NSLog(@"0");
        }
    }

    return 0;
} 
```

我感谢任何帮助...谢谢。克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:58:11.360

I found the solution myself !

I added a EAGLView and used a CCDirector to set it as OpenGl View.

```
- (id)initWithImage:(UIImage *)drawnImage{

    if (self == [super init]) {

        EAGLView *glview = [EAGLView viewWithFrame:CGRectMake(0, 0, 250,350)];

        CCDirector *director = [CCDirector sharedDirector];
        [director setOpenGLView:glview];

        CCTexture2D *tex = [[CCTexture2D alloc] initWithImage:drawnImage resolutionType:kCCResolutionRetinaDisplay];
        imageSprite = [KKPixelMaskSprite spriteWithTexture:tex];

        imageSprite.position = CGPointMake(0, 0 );
        [self addChild:imageSprite];

    }

    return self;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:37:28.547

看看 Ray Wenderlich 关于这个主题的帖子；

[http://www.raywenderlich.com/4817/how-to-integrate-cocos2d-and-uikit](http://www.raywenderlich.com/4817/how-to-integrate-cocos2d-and-uikit)*

# html5-video - 在三星智能电视应用程序上调整 HTML5 视频大小

> ID：11867370
> 
> 赞同：3
> 
> 时间：2012-08-08T14:59:21.843
> 
> 标签：html5-video, samsung-smart-tv

我在尝试调整三星智能电视应用程序中 HTML5 视频元素的大小时遇到​​问题。我正在使用 SDK 2.5。它在 2011 和 2012 模拟器中运行良好，但是当我在电视上测试它时，它卡在全屏状态。

我试过使用 css 和 inline 元素，但它们都没有工作。

我的代码如下所示：

索引页： `<video id="player"></video>`

Main.js，在 onLoad 函数中：

```
$("#player").attr("src","VIDEO_SOURCE");
$("#player").css({
    'position': 'absolute',
    'left': '419px',
    'top': '394px',
    'width': '125px',
    'height': '100px',
});
var v = $("#player").get(0);
v.load();
v.play(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T08:32:05.473

尝试将尺寸设置为视频标签属性而不是 CSS 样式，例如：

```
 <video src="movie.mp4" width="320" height="240">
 Your browser does not support the video tag.
 </video> 
```

2.5 SDK 支持的属性有：

*   自动播放
*   控制
*   高度
*   环形
*   预载
*   源代码
*   宽度

查看有关此主题的三星文档：http: [//www.samsungdforum.com/upload_files/files/guide/data/html/html_2/reference/HTML%20Specification.html#HTML5%20and%20Samsung%20Smart%20TV%20SDK](http://www.samsungdforum.com/upload_files/files/guide/data/html/html_2/reference/HTML%20Specification.html#HTML5%20and%20Samsung%20Smart%20TV%20SDK)

视频更灵活但更复杂为您提供三星的播放器 API： http: [//www.samsungdforum.com/Guide/View/Developer_Documentation/Samsung_SmartTV_Developer_Documentation_2.5/API_Reference/JavaScript_APIs/Device_API/Player](http://www.samsungdforum.com/Guide/View/Developer_Documentation/Samsung_SmartTV_Developer_Documentation_2.5/API_Reference/JavaScript_APIs/Device_API/Player)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-30T09:39:25.533

我知道这是一篇旧帖子，但我有一些代码可以使用，不要忘记导入 jquery

```
<HTML>
<script>
//Wait for the DOM to load
$(window).load(function()
{
    var $bodyElement = $('body');

});

//Wait for the Videos to load To add Event listeners
$(document).ready(function()
{
});

//Initialise Dom Scripts here
this.InitialiseDomScripts = function()
{
    AddDomReadyListeners();
    return true; //return true for Initialisation
}

this.InitialiseDocReadyScripts = function()
{
    AddDocReadyListeners();
    OnResize();

    return true;
}

this.AddDomReadyListeners = function()
{
    //Add a window listener, see when the window is resized
    $(window).resize(OnResize);
}

this.AddDocReadyListeners = function()
{
    //Add a listeners to videos to see when the meta data has loaded
    $('video').bind("loadeddata",function(_VideoEvent)
    {
        OnLoadedVideoData(_VideoEvent);
    });
}

this.OnLoadedVideoData = function(_VideoEvent)
{
    var loadedVideoElement = _VideoEvent.target;
    if($(loadedVideoElement).hasClass('StretchtoFit'))
    {
        ResizeVideo(loadedVideoElement);
    }

}

this.OnResize = function()
{
    //Loop through all of the videos that are marked as stretch to fit
    $('.StretchtoFit').each(function()
    {
        var CurrentChild = this;
        ResizeVideo(CurrentChild);
    });
}

this.ResizeVideo = function(_VideoElement)
{
    $VideoElement = $(_VideoElement); //Cache Jquery reference of this
    var iOriginalVideoHeight =  _VideoElement.videoHeight;
    var iCurrentVideoHeight = $VideoElement.height();
    var iVideoContainerHeight = $VideoElement.parent().height();
    var iCurrentScale = iOriginalVideoHeight/iCurrentVideoHeight;
    var iScaleY = (iVideoContainerHeight / iOriginalVideoHeight)*iCurrentScale;

    //Important to note: Set the origin to the top left corner (0% 0%), or else the position of the video goes astray
     $VideoElement.css({
        "transform-origin": "0% 0%",
        "transform":"scaleY(" + iScaleY +")",
        "-ms-transform-origin" : "0% 0% ", /* IE 9 */
        "-ms-transform":"scaleY(" + iScaleY +")", /* IE 9 */
        "-moz-transform-origin" : "0% 0%", /* Firefox */
        "-moz-transform":"scaleY(" + iScaleY +")", /* Firefox */
        "-webkit-transform-origin": "0% 0%", /* Safari and Chrome */
        "-webkit-transform":"scaleY(" + iScaleY +")", /* Safari and Chrome */
        "-o-transform-origin":"0% 0%", /* Opera */
        "-o-transform":"scaleY(" + iScaleY +")" /* Opera */
     }); 
}

</script>
<body>
<video class="StretchtoFit"  autoplay preload id="video"><source src="1.mp4" type="video/mp4" />Your browser does not support the video tag.</video>
</body>
</html> 
```

# c++ - 在实时系统上保存缓存数据的最佳方法是什么？

> ID：11867371
> 
> 赞同：0
> 
> 时间：2012-08-08T14:59:22.107
> 
> 标签：c++, algorithm, real-time

我有一台从远程电脑接收数据的服务器，我需要保存一些包含我的计算数据的数据结构。目前我通过每次更新转储到硬盘来保存数据结构，大约每秒更新 100 次，每次 800 字节。

在下一步中，我还需要保存 seq 编号，以便在服务器重新启动时告诉我的服务器接收的最后一个 seq 是什么，这可以是 2 字节，但对于文件来说，这可能是每秒 1000 次更新。

我想问一下这是否是一种以这种方式存储缓存数据的好方法？.还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T08:43:58.057

文件缓存很可能会处理这个问题，除非您立即将所有写入刷新到磁盘。所以答案很简单：不要冲水。

# html - 按下时更改浮动项目的宽度

> ID：11867373
> 
> 赞同：0
> 
> 时间：2012-08-08T14:59:27.130
> 
> 标签：html, css-float

我有 2 个相邻的 div。左手是 600px 宽，右手是 200px 宽，加上一点间距等。两个 div 都向左浮动，因此如果页面显示在较小的窗口中，右手 div 会下降到下方。

如果将右手 div 推到第二行，想要的是扩大并变成 600px 宽。但是如果顶行有 200px 的空间，那么我希望它以 200px 的位置显示。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:03:22.523

如果您正在尝试使您的页面适应移动设备，您应该真正研究[**媒体查询。**](https://developer.mozilla.org/en-US/docs/CSS/Media_queries)

```
#yourSecondDiv {
    width: 200px;
}

@media only screen and (max-width : 799px) {
    #yourSecondDiv {
        width: 100%;
    }
} 
```

也可能有帮助 -[**标准设备的媒体查询**](http://css-tricks.com/snippets/css/media-queries-for-standard-devices/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:07:20.940

我不知道这在 HTML 或 CSS 中是否可行，我认为您需要一点 JavaScript，如果是这种情况，我会使用[JQuery](http://jquery.com "Javascript 库")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:07:42.510

这似乎是你可以用 javascript 做的事情。我猜您可以检查页面宽度较小时是否已向下推div。然后你只需换掉 CSS 并将宽度设置为 600 像素。像[这样](https://stackoverflow.com/questions/5902698/swap-css-class)的东西。正如另一篇文章中所解释的那样。这可能会也可能不会。如果是这样，那就太棒了，如果不是，那就太好了。让我知道您想出什么解决方案。

# ruby-on-rails - 非常基本的 RoR 安全方法。但它安全吗？

> ID：11867383
> 
> 赞同：1
> 
> 时间：2012-08-08T14:59:44.943
> 
> 标签：ruby-on-rails

我正在开发一个非常基本的 RoR 应用程序，基本上只能由我组织内的 2-3 人使用。我有一些其他应用程序（用 Perl 编写）不时需要从 RoR 应用程序请求 JSON 对象。我需要防止未经授权访问此请求，但我不需要任何花哨的东西，因为只有我的应用程序会请求访问。仅要求请求 POST 一些预先确定的“密码”的应用程序并且仅当在 POST 请求中提供该密码时才让 RoR 应用程序回复 JSON 对象是否安全（足够，为此目的）？对于一些简单而安全的方法来实现这一点，还有其他建议吗？我对 RoR 很陌生。

谢谢！杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:14:42.377

简单且更安全一点，可能是使用带有密码和日期的 sha1 创建密钥。这样钥匙就会每天更换。

就像是：

```
key = Digest::SHA1.hexdigest("secret#{date}") 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:05:47.023

您可以实施更多奇特的解决方案，但您的方式非常有效。您可以通过简单地使您的应用程序使用 SSL 来隐藏密码的传输，并且它会比许多 Web 服务更安全（许多站点仍然以纯文本传输凭据）。并且由于凭据仅限于在客户端和服务器之间使用，因此您可以随意使用它，这将限制暴力密码攻击的风险。

如果你想要更奇特的东西，我建议使用 gem ['api_auth'](https://github.com/mgomes/api_auth "api_auth")，它会为你的 URL 参数添加一个签名，它是你整个请求的哈希和一个密钥。gem 将在客户端生成签名，然后在服务器上验证签名。这是一个非常强大的解决方案。事实上，您不需要 SSL，除非您不希望任何人看到 URL 和参数本身。但是签名对于确切的请求和包括 request.ip 在内的所有请求参数都是唯一的，这使得除了发起者之外的任何人都无法使用该请求。附注 - 签名附加到请求标头，因此您不会在您的 url 或控制台日志中看到任何不同的内容。

# html - 在不下载整个网页的情况下提取 HTML 数据

> ID：11867388
> 
> 赞同：3
> 
> 时间：2012-08-08T15:00:01.370
> 
> 标签：html, delphi, browser, extract, indy

如何在不下载整个网页 HTML 的情况下从网页中提取 HTML 表格的数据？

我在 Delphi XE2 中使用 TWebBrowser 和 TEmbededWB 来加载页面，然后获取 Table 元素并解析它。但网页很重，在我的循环中（大约 60 秒）我无法正确抓取数据。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T15:40:42.617

男人，

由于 HTML 协议的语言是解释而不是编译的，因此浏览器或任何像浏览器一样工作的类实现都需要从服务器下载整个内容。您可以阅读[浏览器的工作原理](http://www.vineetgupta.com/2010/11/how-browsers-work-part-1-architecture/)和[Surfin' Safari](http://www.webkit.org/blog/1188/how-webkit-loads-a-web-page/)了解更多信息。我相信没有一种有效的方法可以按照您的要求进行操作，但是，在我看来，一种非常有效的方法是按照[mellamokb](https://stackoverflow.com/users/116614/mellamokb)所说的进行操作。但是，它仍然会下载整个内容。

[]的

# visual-studio-2012 - 如何对分类器进行单元测试？

> ID：11867397
> 
> 赞同：0
> 
> 时间：2012-08-08T15:00:35.957
> 
> 标签：visual-studio-2012, vsx, classification

给定签名

```
 public IList<ClassificationSpan> GetClassificationSpans(SnapshotSpan span) 
```

我一直在跟踪 SnapshotSpan 的属性和构造函数，但没有发现任何看起来很可能用于测试分类器针对字符串或文件的东西。

我将如何对新的 VS2012 分类器进行单元测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T22:26:53.320

SnapshotSpan 是一个结构（即一个值类型。参考[http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.text.snapshotspan.aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.text.snapshotspan.aspx)），它不能被存根和填充。

IClassifier.GetClassificationSpans 是一个接口方法，我们正在创建 StubIClassifier 类，以便您可以存根 IClassifier。至于参数 ClassificationSpan，我们创建了一个 ShimClassificationSpan 类，您可以使用它来填充它。

有关在 VS2012 中使用 Fakes 的详细信息，请参阅[http://msdn.microsoft.com/en-us/library/hh549175.aspx](http://msdn.microsoft.com/en-us/library/hh549175.aspx)。

问候，

Patrick Tseng - Visual Studio ALM 团队。

# php - 使用国家/地区代码验证电话前缀：IF vs RegEx

> ID：11867405
> 
> 赞同：-2
> 
> 时间：2012-08-08T15:01:15.140
> 
> 标签：php

> **可能重复：**
> [黎巴嫩电话号码](https://stackoverflow.com/questions/5212341/php-regex-for-lebanese-phone-number)
> [preg_replace 的 PHP 正则表达式以掩盖电话号码的一部分](https://stackoverflow.com/questions/11651744/preg-replace-to-mask-parts-of-a-phone-number)

在我的国家，电话号码前缀有 3 种可能性输入：+62、62 和 0。

例如 ：

> +622112345、622112345 和 02112345

现在，问题是......我只想以一种格式存储电话号码，即：0xxxx。意味着，任何电话前缀都将被转换为 0xxxx 格式。

> 输入：+622112345，输出：02112345
> 
> 输入：622112345，输出：02112345
> 
> 输入：02112345，输出：02112345

我想通过使用 substr() 函数和 IF 将解决这种情况：

```
$Prefix = substr($Number, 0, 2);

if ($Prefix = "+6"){
//some code to convert +62 into 0
}else if ($Prefix = "62"){
//some code to convert 62 into 0
}else{
//nothing to do, because it's already 0
} 
```

除了使用 IF 之外，还有其他方法可以做到这一点吗？例如，使用正则表达式...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:08:11.583

是的，这在单个正则表达式中要容易得多：

```
preg_match( '/(0|\+?\d{2})(\d{7,8})/', $input, $matches);
echo $matches[1] . ' is the extension.' . "\n";
echo $matches[2] . ' is the phone number.' . "\n"; 
```

这将从任一输入中捕获分机号和电话号码。但是，对于您的特定情况，我们可以创建一个测试台并使用它`preg_replace()`来获取所需的输出字符串：

```
$tests = array( '+622112345' => '02112345', '622112345' => '02112345', '02112345' => '02112345');

foreach( $tests as $test => $desired_output) {
    $output = preg_replace( '/(0|\+?\d{2})(\d{7,8})/', '0$2', $test);
    echo "Does $output match $desired_output? " . ((strcmp( $output, $desired_output) === 0) ? "Yes" : "No") . "\n";
} 
```

您可以从[演示](http://viper-7.com/kKB02v)`$output`中看到，这为所有测试用例正确创建了正确的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:18:54.483

```
if (preg_match('[^\+62|62]', $your_phone_number)) {
    # if string contains +62 or 62 do something with this number
} else {
    # do nothing because string doesn't contain +62 or 62
} 
```

那只是更短

# iphone - 如何根据内容调整 UITextView 的框架

> ID：11867406
> 
> 赞同：0
> 
> 时间：2012-08-08T15:01:18.817
> 
> 标签：iphone, ios, ipad, xcode4.2

在我的应用程序中，我需要在包含文本的文本视图中存储确切的区域（高度和宽度）。

我有一个宽度为**300**的 UITextView 。现在假设用户写了一些文本，这些文本最多只能填充**150** ，即TextView 宽度的**50%**。我怎么知道 textview 有多少部分包含文本？我只想存储**150**而不是**300**，即我需要排除 textview 中不包含文本的冗余部分。

但是，我已经能够通过使用**textview.contentSize.height**获得确切的高度。但是**textview.contentSize.width**没有给出适当的结果

有什么建议么？？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:11:31.453

您需要计算 UITextView 范围内的文本大小：

```
CGSize textSize = [@"Some text" sizeWithFont:[UIFont boldSystemFontOfSize:12] forWidth:CGRectGetWidth(textView) lineBreakMode:UILineBreakModeCharacterWrap]; 
```

从这里你可以使用 textSize.height 属性来设置你的 UITextView 的高度。

请记住，您可能需要调整字体大小和`forWidth:`大小以匹配您的 UITextView 所具有的任何内容，但这应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:53:54.543

这直接来自我的工作代码：

```
//Make the textView as big as needed for it to fit the message body
CGSize stringSize = [m.msg_body sizeWithFont:[UIFont fontWithName:@"HelveticaNeue-Bold" size:13]
                           constrainedToSize:CGSizeMake(self.view.frame.size.width, 9999) 
                               lineBreakMode:UILineBreakModeWordWrap];

messageTextView.frame = CGRectMake(0, 0, stringSize.width, stringSize.height + 10); 
```

# video - 在产品详细信息页面上包含 og:video 标签

> ID：11867407
> 
> 赞同：1
> 
> 时间：2012-08-08T15:01:21.530
> 
> 标签：video, facebook-opengraph

我们正在尝试使用 og:video 标签和相关标记来为我们网站上通过 Facebook 共享的产品详细信息页面启用在 NewsFeed 中的视频播放。

例如，我们在这里实现了标签：

[http://www.ice.com/product/bracelets/womens-silver-bracelet-prd_bsw_106235](http://www.ice.com/product/bracelets/womens-silver-bracelet-prd_bsw_106235)

并且正在使用：

```
<meta property="og:description" content="Refined and glamorous, this bangle bracelet is studded with sparkling yellow crystals. Crafted from stainless steel, this lovely piece offers a classic and elegant look for any occasion. Wear it alone or stack a few together for a unique look. - BSW_106235" />
<meta property="fb:page_id" content="144519415627" />
<meta property="og:url" content="http://www.ice.com/product/bracelets/womens-silver-bracelet-prd_bsw_106235" />
<meta property="og:image" content="http://images.ice.com/ice/product/images/BSW/BSW_106235_b_l-Stainless_Steel_and_L_Topaz_Bangle.jpg" />
<meta property="og:title" content="Yellow Crystal Stainless Steel Bangle - BSW_106235" />
<meta property="og:video" content="http://videos.treepodia.com/UA-ICE/BSW106235.mp4" />
<meta property="og:video:type" content="application/x-shockwave-flash" />
<meta property="og:video:width" content="360" />
<meta property="og:video:height" content="280" />
<meta property="og:type" content="website" /> 
```

当我在 Facebook 中共享此产品详细信息页面的链接时，视频缩略图和在新闻源中播放视频的选项不可用。

我们做错了什么吗？

谢谢，

戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:51:10.190

您的语法是正确的，我刚刚在我的 facebook 帐户中尝试过它并且它有效 - 出现了预览图像并播放了视频。

您可以[在此处](http://developers.facebook.com/tools/debug/og/object?q=http://www.ice.com/product/bracelets/womens-silver-bracelet-prd_bsw_106235)使用您的 URL 进行检查。

只需确保您通过 https 使用 facebook，否则不会播放任何外部内容。

# api - 谷歌搜索 API 过滤/排序返回意外结果

> ID：11867411
> 
> 赞同：1
> 
> 时间：2012-08-08T15:01:27.193
> 
> 标签：api, search, filter

我创建了与 Google 自定义搜索 API 的集成，查询看起来相当简单，但返回了意想不到的结果。我的查询基于本指南：[https ://developers.google.com/custom-search/docs/structured_search](https://developers.google.com/custom-search/docs/structured_search)

在我的网站上，我创建了页面地图，其中包含我的 pagetypeid 信息（我想要在其中过滤）和页面排名（我想要排序）。这些页面由谷歌索引，当我尝试做一个简单的查询时，json 对象包含正确的值。即：当我在浏览器中测试时：

https://www.googleapis.com/customsearch/v1?key=[myKey]&cx=[myCx]&q=*&alt=json

请注意，我正在搜索 q=* （所有内容）。

我收到一个带有页面映射对象的项目列表，如下所示：

“页面地图”：{

```
"page": [
 {
  "pagetypeid": "12",
 }
],
"pageranking": [
 {
  "score": "5"
 }
],...} 
```

我有 pagetypeid 的对象：12,3 和一系列其他数字......

当我尝试添加过滤或排序时，奇怪的部分就出现了。

如果我将上面的查询更改为：

https://www.googleapis.com/customsearch/v1?key=[myKey]&cx=[myCx]&q= ***+more:pagemap:page-pagetypeid:3** &alt=json

谷歌的结果没有任何命中，即使第一个查询显示了许多带有 pagetypeid:3 的命中。

如果尝试相同的查询但从 pagetypeid:3 更改为 pagetypeid:12，我会按预期收到命中。

为什么这些查询的处理方式不同？

这与排序的方式相同。使用按分数排序搜索 * 会返回 0，但使用 q=test+sort... 搜索会返回命中。是我如何将不同参数传递给 Google 的组合吗？

**编辑：** 是否有可能因为这是一个测试站点，除了我自己的查询之外没有其他流量 - 我的请求的响应在被索引之前已被缓存，因此我的查询返回过时的结果？

是否也有可能，当我在具有更多活动的站点上安装此集成时，索引（由 Google 提供）会更频繁地更新，因此这些“错误”不会出现？

提前致谢。

# c# - ASP.NET 自定义 HttpContext 线程问题

> ID：11867422
> 
> 赞同：0
> 
> 时间：2012-08-08T15:01:59.767
> 
> 标签：c#, asp.net, multithreading

通常我必须从我的 ASP.NET 应用程序的任何部分跨多个请求访问相同的信息。使用下面的示例，我尝试获取当前请求的 URL（我经常忘记需要哪个属性）。我正在尝试提出一种类似于 ASP.NET 处理 HttpContext 的方法。到目前为止，我想出了以下内容：

```
public interface ICustomContext {
    HttpContextBase Http { get; }
    string Url { get; }
}

public class CustomContext : ICustomContext {
    private readonly HttpContextBase _httpContext;

    public CustomContext(HttpContextBase httpContext) {
        _httpContext = httpContext;
    }

    public HttpContextBase Http {
        get { return _httpContext; }
    }

    public string Url {
        get { return Http.Request.Url.AbsoluteUri; }
    }
}

public class MyContext {
    private static ICustomContext _instance = new CustomContext(new HttpContextWrapper(HttpContext.Current));

    public static ICustomContext Current {
        get { return _instance; }
    }
} 
```

这允许我稍后在我自己的上下文之上添加其他属性。我希望我可以简单地说：

```
MyContext.Current.Url; 
```

但是，它总是在第一次调用时返回页面的 url。我猜这是某种线程问题，但我不知道如何解决它。

我会很感激帮助。哦，请注意，理想情况下，我希望有一个干净且易于测试的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:10:59.460

我认为线索与*静态*字段一致

```
private static ICustomContext _instance 
```

尝试将其更改为

```
public static ICustomContext Current {
        get { return new CustomContext(HttpContext.Current); }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:31:38.993

我找到了一个很好的方法来处理这个。我最初的想法是将实例存储在 HttpContext.Current.Items 集合中（因为每个请求都存在）。然后我意识到，因为我使用 Microsoft Unity 作为我的 Ioc，并且我已经定义了我自己的 LifetimeManager，它将对象存储在 HttpContext.Current.Items 集合中，所以我可以通过说来注册类型：

```
container.RegisterType<HttpContextBase>(new InjectionFactory(c => {
    return new HttpContextWrapper(HttpContext.Current);
}));
container.RegisterType<ICustomContext, CustomContext>(new PerRequestLifetimeManager<ICustomContext>()); 
```

现在我可以像这样定义我的静态属性：

```
public static ICustomContext Current {
    get { return DependencyResolver.Current.GetService<ICustomContext>(); }
} 
```

# django - 在 Django Admin 中删除特定的伪造密钥？

> ID：11867423
> 
> 赞同：0
> 
> 时间：2012-08-08T15:02:07.460
> 
> 标签：django, django-models, django-admin

我有以下两种型号

```
class ModelOne(models.Model):
    mod_desc = models.CharField(max_length=25)
    is_active = models.BooleanField(default=True)

class ModelTwo(models.Model):
    another_desc = models.CharField(max_length=25)
    is_active = models.BooleanField(default=True)
    modone = models.ForeignKey(ModelOne) 
```

以及 ModelTwoAdmin 的以下管理代码

```
class ModelTwoAdmin(admin.ModelAdmin):
    def formfield_for_foreignkey(self,db_field,request, **kwargs):
        if db_field.name == 'modone':
            kwargs['queryset'] = ModelOne.objects.exclude(is_active=False)

    fieldsets = [
        ('String 1', {'fields' : ['another_desc','modone']}),
        ('String 2', {'fields' : ['is_active']}),
    ] 
```

我的目标是过滤掉 ModelOne 条目 where `is_active`is `False`。然而，上面的代码返回了一个错误——第 7 行在堆栈跟踪中突出显示，但在代码块中，这里被包围`**`：

```
Django Version:     1.4
Exception Type:     KeyError
Exception Value:    

"Key 'modone' not found in Form"

Exception Location:     c:\Python\Python2.7\App\lib\site-packages\django\forms\forms.py in __getitem__, line 109

1   <fieldset class="module aligned {{ fieldset.classes }}">
2   {% if fieldset.name %}<h2>{{ fieldset.name }}</h2>{% endif %}
3   {% if fieldset.description %}
4   <div class="description">{{ fieldset.description|safe }}</div>
5   {% endif %}
6   {% for line in fieldset %}
**7     <div class="form-row{% if line.fields|length_is:'1' and line.errors %} errors{% endif %}{% for field in line %}{% if field.field.name %} field-{{ field.field.name }}{% endif %}{% endfor %}">**
8   {% if line.fields|length_is:'1' %}{{ line.errors }}{% endif %}
9   {% for field in line %}
10  <div{% if not line.fields|length_is:'1' %} class="field-box{% if field.field.name %} field-{{ field.field.name }}{% endif %}{% if not field.is_readonly and field.errors %} errors{% endif %}"{% endif %}>
11  {% if not line.fields|length_is:'1' and not field.is_readonly %}{{ field.errors }}{% endif %}
12  {% if field.is_checkbox %}
13  {{ field.field }}{{ field.label_tag }}
14  {% else %}
15  {{ field.label_tag }}
16  {% if field.is_readonly %}
17  <p>{{ field.contents }}</p> 
```

如何过滤掉不活跃`ModelOne`的s？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:12:55.650

问题是您指定了一个`None`字段集两次。第二个覆盖第一个，因此表单中的唯一字段是`is_active`. 给第二个`None`一个实际的字符串名称，或者只是将两个字段集合并为一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:50:49.980

方法中缺少 return 语句`formfield_for_foreignkey`。返回语句应该是：

```
return super(ModelTwo, self).formfield_for_foreignkey(db_field, request, **kwargs) 
```

# mysql - mysql费用计算

> ID：11867426
> 
> 赞同：-1
> 
> 时间：2012-08-08T15:02:14.993
> 
> 标签：mysql

我有一个包含几个表和列的数据库。我想用基于 table2、table3 和 table4 中数据的计算的数据填充 table1。我需要所有这些表中的数据，以便正确评估应该插入 table1 的内容。我希望它是一个存储实体，因此只需调用它就可以一遍又一遍地重用它。使用 mysql 来解决这个问题的最好和最聪明的方法是什么？如果我不够清楚，请告诉我。感谢提前加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:03:50.883

使用存储过程，并使用以下`insert..select`模式填充 table1：

```
Insert into table1
Select column1, column2, column3, ...
From table2
join table3 on ??
join table4 on ?? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:06:30.183

听起来您可以使用“视图”，它就像一个表，可以根据加入其他表的查询自动保持最新。见[http://dev.mysql.com/doc/refman/5.0/en/create-view.html](http://dev.mysql.com/doc/refman/5.0/en/create-view.html)

# git - 仅当所有测试都通过时才更新 Git 主存储库，怎么办？

> ID：11867427
> 
> 赞同：3
> 
> 时间：2012-08-08T15:02:16.547
> 
> 标签：git, tdd, githooks, git-bare

我正在尝试在主 git 存储库中创建 git hook on update。我想防止破坏任何测试的推送。如何获取将在更新后运行测试的项目的裸存储库代码？

PS：当然可以使用预提交挂钩而不是更新，在这种情况下挂钩应该在提交者PC上，但我相信这应该是在服务器上进行验证的一种方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:11:52.540

使用这种方法：禁止开发人员推送到主仓库。相反，强迫人们推动构建回购。将 CI 服务器指向该构建存储库。如果构建成功，让构建服务器推送到主仓库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T15:33:49.223

CI 服务器可以为你做这件事，但一个简单的脚本也可以做到这一点。David Gageot 不久前在他的博客上介绍了一个非常简单的使用 git 进行私有构建的解决方案（这个想法是在推送远程服务器之前在辅助本地 repo 上构建测试）：

[http://blog.javabien.net/tag/git/page/2/](http://blog.javabien.net/tag/git/page/2/)

不幸的是，它是用法语编写的，但您仍然可以查看用于执行此操作的脚本：

```
#!/bin/bash
if [ 0 -eq `git remote -v | grep -c push` ]; then
    REMOTE_REPO=`git remote -v | sed 's/origin//'`
else
    REMOTE_REPO=`git remote -v | grep "(push)" | sed 's/origin//' | sed 's/(push)//'`
fi

if [ ! -z "$1" ]; then
    git add .
    git commit -a -m "$1"
fi

git pull

if [ ! -d ".privatebuild" ]; then
    git clone . .privatebuild
fi

cd .privatebuild
git clean -df
git pull

if [ -e "pom.xml" ]; then
    mvn clean install

    if [ $? -eq 0 ]; then
        echo "Publishing to: $REMOTE_REPO"
        git push $REMOTE_REPO master
    else
        echo "Unable to build"
        exit $?
    fi
fi 
```

**为非 Java 用户编辑**

在上面的脚本中，替换`mvn clean install`为允许您构建项目的命令行（并删除测试 maven pom.xml 文件是否存在的 if 语句）。

# c++ - 正确使用“extern”关键字

> ID：11867431
> 
> 赞同：10
> 
> 时间：2012-08-08T15:02:30.137
> 
> 标签：c++, extern

有资源（书籍，在线资料）解释了`extern`以下用法：

```
extern int i;        // declaration - has 'extern'
int i = 1;           // definition  - specified by the absence of 'extern' 
```

并且有支持以下语法的来源：

```
extern int i;        // declaration
extern int i = 1;    // definition  - specified by the equal sign
                     // Both marked with 'extern' 
```

我的问题是 - 这是*C*与*C++*的区别，还是*ANSI*与*ANSI*之前的做法？

现在，更实际的问题：

使用第二种语法，我想创建一个全局对象（从每个编译单元可见）。构造函数不带参数，因此括号和等号都不是必需的。

```
extern MyClass myobject; 
```

现在编译器如何区分声明和定义？

**编辑：**回到学校，我习惯了第一种语法（Borland C）。后来我使用了一个编译器（可能是一些古老的 GCC 版本），它拒绝编译没有“extern”的定义。这就是让我感到困惑的原因。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-08T16:46:43.480

特别是对于您的示例，这里的 C 和 C++ 之间没有区别。适用于两种语言的基本规则是：如果您的声明包含一个*初始化程序*，那么它就是一个*定义*。时期。没关系，它是否有明确`extern`的。如果它有一个初始化器，那么它就是一个*定义*。

这意味着在命名空间范围内两者`extern int i = 1`和`int i = 1`都是等价的，即`extern`在这样的声明中是多余的。在 C++`extern`中，当声明的对象是 时，定义变得非冗余`const`，因为`const`C++ 中的对象默认具有内部链接。例如，定义带有外部链接的`extern const int c = 42;`常量。`c`

如果一个声明没有初始化器，那么（并且只有这样）它开始依赖于`extern`关键字的存在。它`extern`是一个*非定义的声明*。没有`extern`它是一个*定义*。（在 C 语言中，这将是一个*暂定*定义，但这在我们的上下文中是无关紧要的）。

现在，对于您的实际问题。为了创建一个全局对象，您必须将其*声明*为

```
extern MyClass myobject; 
```

（通常在头文件中完成），然后在某个翻译单元中将其*定义*为

```
MyClass myobject; 
```

由于您的构造函数不带参数，因此这是定义对象的唯一方法。（从 C++11 开始，您也可以根据需要使用`MyClass myobject{};`。）

如果您必须为构造函数提供参数（例如`42`），您将能够同时使用

```
MyClass myobject(42); 
```

和

```
extern MyClass myobject(42); 
```

作为定义，因为初始化器的存在确保它确实被解释为*定义*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T15:42:43.173

对于文件范围变量，无论它们是类类型还是原始类型：

*   `extern T t;`没有初始化程序是一个声明；
*   `extern T t = expression;`任何语法（赋值、构造或统一）的初始化器都是定义；
*   `T t;`没有初始化器是一个定义，初始化为默认值`T`；
*   `T t = expression;`任何语法的初始化器都是定义。

`extern int i = 1;`和之间没有区别`int i = 1;`，并且两种样式都存在论据，但总的来说，我会主张第二种，因为您应该已经知道文件范围内的定义具有链接。

从历史上看，在 ANSI C 之前似乎`extern`不需要关键字。参见例如[http://www.jetcafe.org/jim/c-style.html#Declarations](http://www.jetcafe.org/jim/c-style.html#Declarations)

因此，对于类类型，`extern MyClass myobject;`为声明和`MyClass myobject;`定义编写。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-08T15:34:28.113

草案 n3337, 3.1.2

> **声明是一个定义，除非**它声明一个函数而不指定函数的主体 (8.4)，**它包含 extern 说明符 (7.1.1)**或链接规范25 (7.5)**并且既不包含初始值设定项** 也不是函数体，它在类定义（9.2、9.4）中声明一个静态数据成员，它是一个类名声明（9.1），它是一个不透明枚举声明（7.2），它是一个模板参数（14.1 )，它是函数声明器中的参数声明 (8.3.5)，它不是函数定义的声明器，或者它是 typedef 声明 (7.1.3)，别名声明 (7.1.3)， using-declaration (7.3.3)、static_assert-declaration (Clause 7)、attributeedeclaration (Clause 7)、empty-declaration (Clause 7) 或 using-directive (7.3.4)。[ 示例：除以下一项外，所有都是定义：

```
int a; // defines a
extern const int c = 1; // defines c
int f(int x) { return x+a; } // defines f and defines x
struct S { int a; int b; }; // defines S, S::a, and S::b
struct X { // defines X
int x; // defines non-static data member x
static int y; // declares static data member y
X(): x(0) { } // defines a constructor of X
};
int X::y = 1; // defines X::y
enum { up, down }; // defines up and down
namespace N { int d; } // defines N and N::d
namespace N1 = N; // defines N1
X anX; // defines anX 
```

> ```
> whereas these are just declarations: 
> ```

```
extern int a; // declares a
extern const int c; // declares c
int f(int); // declares f
struct S; // declares S
typedef int Int; // declares Int
extern X anotherX; // declares anotherX
using N::d; // declares d 
```

> —结束示例]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-08T15:42:53.240

> 我想创建一个全局对象（从每个编译单元可见）

`extern`不需要定义，因为外部链接是默认的。

你应该做的是：

```
extern MyClass myobject; 
```

在头文件中（这不是定义）以使编译器在编译其他编译单元时知道数据类型。然后，在一个编译单元中，编写：

```
MyClass myobject; 
```

这是一个带有外部链接的定义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-15T21:21:42.570

好的，所以`extern`关键字放在外部文件中的变量名称之前。所以说你的项目中有一个单独的文件。假设该文件是一个名为 MyMath.h 的头文件（就好像您正在制作一个包含一些有用函数/类的可移植数学文件）。在您的头文件中，您可以为您的酷数学函数和类放置所有原型或​​前向引用。这个数学头文件的实际代码或函数等将位于一个名为 MyMath.cpp 的 .cpp 文件中（通常您使用相同的名称来保持它的组织性）。关键字在`extern`这里发挥作用：如果您想在数学文件中为 PI (3.1415) 提供一个全局变量，您需要像往常一样定义它（在 .cpp 文件中），`float PI = 3.1415;`然后在您的 .h 或头文件中，您将使用前缀编写原型或变量声明`extern`。

所以完整的例子看起来像这样：

----MyMath.h----

```
#ifndef MYMATH_H_INCLUDED
#define MYMATH_H_INCLUDED

extern float PI;

#endif // MYMATH_H_INCLUDED 
```

----MyMath.cpp----

```
#include "MyMath.h"

float PI = 3.1415; 
```

----main.cpp----

```
#include <iostream>
#include "MyMath.h"

using namespace std;

int main()
{
    cout << "PI = " << PI << endl;
    return 0;
} 
```

希望我解释清楚！请记住，这是为了在文件之间使用变量！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-07T19:34:43.127

“初始化程序”胜过“外部”。行动胜过谈话。

# iphone - 在 UITextField 中获取一系列选定文本，因为 NSRange 是 iOS 4

> ID：11867436
> 
> 赞同：2
> 
> 时间：2012-08-08T15:02:36.180
> 
> 标签：iphone, ios, ios4, uitextfield, uitextinput

我一直在使用 UITextInput 协议中的 selectedTextRange 和 beginOfDocument 属性，但正如我刚刚在下面的帖子中了解到的那样，UITextField 仅开始遵守 iOS 5 中的 UITextInput 协议，因此我的应用程序在 iOS 4.3 中崩溃。我需要另一种方法在 iOS 4.3 中执行此操作。

[UITextField 和 UITextView 的 UITextInput 协议用于管理崩溃中的选择结果](https://stackoverflow.com/questions/7923659/uitextinput-protocol-usage-for-uitextfield-and-uitextview-to-manage-selection-re)。

这是我现在正在做的事情（self 是我的 UITextField 子类）：

```
UITextRange *selectedTextRange = self.selectedTextRange;
NSUInteger location = [self offsetFromPosition:self.beginningOfDocument
                                        toPosition:selectedTextRange.start];
NSUInteger length = [self offsetFromPosition:selectedTextRange.start
                                      toPosition:selectedTextRange.end];
NSRange selectedRange = NSMakeRange(location, length); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:27:03.723

假设用户在 UITextField 中选择了一些文本。如果它的 iOS 4 在“选择并复制”字段下方添加了一个标记行，那么您可以从剪贴板中获取文本（但不确定是否可以在剪贴板更改时收到通知）。

或者，您甚至可以让他们点击某个键 - 甚至是删除键，在文本委托方法“shouldChangeCharactersInRange:”中，您可以获得范围，然后返回 NO 以免更改它。

# python - Python Flask MongoDB 用户身份验证

> ID：11867440
> 
> 赞同：-3
> 
> 时间：2012-08-08T15:02:39.837
> 
> 标签：python, mongodb, flask

我打算使用 python-flask 和 mongodb 构建一个应用程序，但我在这些方面的经验绝对为零。我想知道为什么一个人更喜欢 MongoDB，以及在应用程序中是否可以进行任何类型的用户身份验证。即，新用户注册并稍后验证他的用户名和密码并获得访问权限并启动他的会话，同时获得对其数据的授权。一旦单击注销链接，他的 sessios 就会被破坏。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T17:47:38.140

> 并且在应用程序中是否可以进行任何类型的用户身份验证。即，新用户注册并稍后验证他的用户名和密码并获得访问权限并启动他的会话，同时获得对其数据的授权。一旦单击注销链接，他的 sessios 就会被破坏。

我们不是来为您编写您的网站的，但我相信 10gen 的本教程可能会对您有所帮助：[http](http://docs.mongodb.org/manual/tutorial/write-a-tumblelog-application-with-flask-mongoengine/) ://docs.mongodb.org/manual/tutorial/write-a-tumblelog-application-with-flask-mongoengine/ .

既然你知道（和我一样）不熟悉 Python，我会给你一些提示：

*   看教程
*   谷歌搜索
*   了解您的问题的性质并将其分解为您可以解决的小部分。然后，在您了解这些小部分后，将其构建到完整的上下文中。
*   当人们传授他们的知识时点赞，这是一种感激之情。

> 为什么更喜欢 MongoDB

正如上面另一个 SOer 所说，这是非常主观的，所以我将向您发送一些链接，这些链接可能支持也可能不支持使用 MongoDB，但它们将帮助您不落入乐队的陷阱：

*   [何时使用 MongoDB 或其他面向文档的数据库系统？](https://stackoverflow.com/questions/1476295/when-to-use-mongodb-or-other-document-oriented-database-systems)
*   [MongoDB 与 MySQL](https://stackoverflow.com/questions/4448194/mongodb-vs-mysql)
*   [http://www.scalabiliti.com/blog/mongodb_vs_mysql](http://www.scalabiliti.com/blog/mongodb_vs_mysql)

如果你真的必须征求我的意见，而且只征求我的意见：

*   更容易集成
*   它回归基础，没有重量
*   它还很年轻，还有很多希望
*   10gen 似乎对项目的发展方向有很好的想法，并且他们得到了一些最好的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:13:41.877

您的问题实际上是两个问题：

**为什么更喜欢 MongoDB**

正如我在评论中提到的，这是一个非常主观的问题，因此它不适合 StackOverflow 问答设计。

**应用程序中是否可以进行任何类型的用户身份验证？**

MongoDB 只是一个数据库：它存储数据。它不提供逻辑（例如“用户身份验证”或“购物车”或“博客文章”）。它提供了存储一般数据的能力。您当然可以使用 MongoDB 构建处理身份验证的应用程序。

Flask 只是一个用于处理 Web 请求的框架。与 Django 之类的框架不同，它旨在处理一些“基本必需品”，并将诸如“身份验证”或“提交博客文章”之类的逻辑留给程序员进行设计。因此，再一次，对身份验证没有开箱即用的支持，但是可以使用 Flask 和 MongoDB 作为构建块来构建这样的系统。

有关 Flask的一些可能性的更多信息，请参阅[一些关于身份验证的 Flask 文档。](http://flask.pocoo.org/snippets/category/authentication/)

Flask也有一些[扩展，旨在进行身份验证](https://stackoverflow.com/questions/6972999/flask-user-authentication)。

# android - 操作栏图标大小

> ID：11867441
> 
> 赞同：1
> 
> 时间：2012-08-08T14:43:53.633
> 
> 标签：android, icons

> **可能重复：**
> [操作栏图标大小](https://stackoverflow.com/questions/11244918/action-bar-icon-size)

Android 有关于在操作栏中使用什么大小的图标的相互矛盾的信息。

*   [他们在这里说 32dp](http://developer.android.com/design/style/iconography.html)
*   [他们在这里说 36dp](http://developer.android.com/guide/practices/ui_guidelines/icon_design_action_bar.html)

有谁知道哪个是正确的？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T11:28:51.453

32dp 是正确的值。我今天以 36dp 访问[该网站，](http://developer.android.com/guide/practices/ui_guidelines/icon_design_action_bar.html)我看到了 36px（也许 Google 已更正了该值）。

# ruby - 维护分叉的 gem 和分叉的依赖项

> ID：11867444
> 
> 赞同：0
> 
> 时间：2012-08-08T15:02:49.143
> 
> 标签：ruby, gem, dependencies, fork, bundler

我正在使用一个 ruby​​ 项目，它由一个主要的 gem（我们称之为 SuperGem）和它所依赖的几个较小的 gem 组成。该项目在 Github 上，我已经分叉了它并正在维护我自己的版本（称为 SuperGemFork）。当 SuperGem 更新时，我只需要拉取和合并新代码，然后在 SuperGemFork 上更新版本号。

现在是这种情况。我还想制作我自己版本的依赖项之一（我们称之为 SmallGem）。所以现在我希望 SuperGemFork 依赖于 SmallGemFork 而不是 SmallGem。因此，当 SuperGem 和 SmallGem 都更新时，我现在必须将两个 gem 中的代码提取并合并到我的 fork 中，更新版本号，并将 SuperGemFork 中的依赖关系更改为依赖于 SmallGemFork 的新版本。

我遇到的问题是必须更改 SuperGemFork 中的依赖项。当 SuperGem（原版）更新时，它现在依赖于 SmallGem 的新版本。但是，如果我从两个 gem 中提取并合并代码，然后忘记更新依赖项，SuperGemFork 仍然依赖于 SmallGemFork 的旧版本，即使有新版本可用。必须更改依赖项是多余且容易出错的，`bundle install`如果我忘记这样做，我希望在运行或启动应用程序时至少有一些失败。

那么，有没有一种好方法可以让我轻松维护自己的 gem 分支，这些分支之间存在依赖关系？

谢谢，亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T21:58:20.420

如果可以对原始 gem 进行猴子补丁，而不是重写源代码，我会这样做。这是 Ruby 的强项之一。

然后他们可以更改他们的代码，您将不会像实际逻辑和他们正在创建的对象那样紧密地耦合到源的物理布局。

# ruby-on-rails - 在 VPS 上安装 RVM

> ID：11867446
> 
> 赞同：1
> 
> 时间：2012-08-08T15:03:00.513
> 
> 标签：ruby-on-rails, nginx, rvm, passenger, vps

我正要建立一个将托管多个 RoR 站点的 VPS。我打算使用 nginx 作为我的服务器和乘客进行部署。我想知道如何使用 RVM 来拥有具有多个 RoR 站点的多个 gemset，这可能吗？如果是，我应该如何安装它？我已经读过，当您只使用`bash < <(curl -s https://rvm.beginrescueend.com/install/rvm`. 我已经看到它在本文中多次提到它如何不允许多个 gemset。

[http://coding.smashingmagazine.com/2011/06/28/setup-a-ubuntu-vps-for-hosting-ruby-on-rails-applications-2/](http://coding.smashingmagazine.com/2011/06/28/setup-a-ubuntu-vps-for-hosting-ruby-on-rails-applications-2/)

任何帮助将不胜感激。任何关于使用 nginx、passenger 和 rvm 在 VPS 上设置 RoR 的文章或教程都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:48:45.987

RVM 可以以 3 种模式安装（在此处描述：[https](https://rvm.io/rvm/install/) ://rvm.io/rvm/install/ ），它们都适用于托管具有不同配置的多个 Rails 站点。

这种设置有很好的描述：[https ://rvm.io/deployment/best-practices/](https://rvm.io/deployment/best-practices/)

对于使用乘客，您可以使用此文档[https://rvm.io/integration/passenger/](https://rvm.io/integration/passenger/) - 它适用于多用户模式和混合模式......在这种情况下确定每个用户的安装。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-08T15:36:50.107

我不建议您在生产环境中使用 RVM 来管理 rails 项目的依赖关系。它的主要目的不是作为依赖管理器，而是用于管理多个 Ruby VM 的工具。

更合适的解决方案是使用[Bundler](http://gembundler.com/rails3.html)，它是一种在 Ruby 中管理依赖项的更清洁、更安全的方法。更清洁，因为您为每个项目明确声明了所需的 gem 及其版本。更安全，因为它强制 Rails 应用程序加载正确的 gem 版本。

[该答案](https://stackoverflow.com/questions/5826379/what-does-bundler-offer-over-rvm)详细说明了该主题。

# excel - 如果一个单元格包含一个字符串

> ID：11867448
> 
> 赞同：49
> 
> 时间：2012-08-08T15:03:07.287
> 
> 标签：excel, if-statement, contains

如果相邻单元格包含特定字符串，如何为单元格分配值？

例如，A 列中的字段：

```
 dog11
    cat22
    cow11
    chick11
    duck22
    cat11
    horse22
    cat33 
```

B 列中的语法为：

```
=IF(SEARCH("cat",A1),"cat",IF(SEARCH("22",A1),"22","none")) 
```

它总是拾取第一个 TRUE 单元格，但当值不正确时下降。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-08-08T16:33:11.167

`SEARCH``0`如果没有匹配则不返回，它返回`#VALUE!`. 因此，您必须将调用包装到`SEARCH`with `IFERROR`。

例如...

> =IF(IFERROR(SEARCH("cat", A1), 0), "cat", "none")

或者

> =IF(IFERROR(SEARCH("cat",A1),0),"cat",IF(IFERROR(SEARCH("22",A1),0),"22","none"))

Here, `IFERROR` returns the value from `SEARCH` when it works; the given value of `0` otherwise.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T15:06:14.593

您可以使用`OR()`对表达式（以及`AND()`）进行分组：

```
=IF(OR(condition1, condition2), true, false)

=IF(AND(condition1, condition2), true, false) 
```

因此，如果您想测试“cat”和“22”：

```
=IF(AND(SEARCH("cat",a1),SEARCH("22",a1)),"cat and 22","none") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-13T22:48:23.993

```
=IFS(COUNTIF(A1,"*cats*"),"cats",COUNTIF(A1,"*22*"),"22",TRUE,"none") 
```

# wcf-data-services - 什么是 OData 提要

> ID：11867457
> 
> 赞同：1
> 
> 时间：2012-08-08T15:03:28.910
> 
> 标签：wcf-data-services

我在 WCF 数据服务教程中多次看到“feeds”这个词。但我真的不知道“饲料”是什么意思。有谁能够帮助我 ？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:36:06.670

Feed 是 ATOM 概念 - 它表示 WCF 数据服务中的实体集合。

# ravendb - RavenDB - 为什么，当按 Id 查询文档时， .Load<> 返回值而 Query<> 不返回？

> ID：11867463
> 
> 赞同：5
> 
> 时间：2012-08-08T15:03:39.793
> 
> 标签：ravendb

这是一个简单的类：

```
public class Person
{
    public int Id {get; set;}
    public string Name {get; set;}
} 
```

当我将它保存在 RavenDB 中时，它会得到一些 Id，比如说它是 1，然后这个

```
var person = session.Load<Person>("Person/1") 
```

返回我指定的人，但这

```
var person = session.Query<Person>().First(p => p.Id == 1) 
```

出错并说“序列不包含任何元素”。我不明白为什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-08T15:14:02.593

按 ID 加载文档是一种[ACID 操作](http://en.wikipedia.org/wiki/ACID)。换句话说，在您保存文档的那一刻，它就可供检索。

另一方面，查询文档遵循“最终一致性”的no-sql概念。您正在查询一个索引，而该索引可能有时间也可能没有时间来完全构建。

在您的示例中，索引仍然过时。如果您等待的时间足够长，您的查询将正确返回。或者，您可以使用 WaitForNonStaleResults 自定义来告诉 Raven 等待，但这可能会产生危险的副作用 - 尤其是在繁忙的索引上。您可以在此处阅读有关过时索引查询的更多信息：[http ://ravendb.net/docs/client-api/querying/stale-indexes](http://ravendb.net/docs/client-api/querying/stale-indexes)

通常，如果您知道文档的 Id，则应始终使用 .Load()。使用 .Query() 保留实际需要索引查找的内容。在您的情况下，一个合理的查询可能是：

```
var person = session.Query<Person>().Where(p => p.Name == "Joe").FirstOrDefault(); 
```

# regex - 使用正则表达式查找包含一个字符串并排除第二个字符串的字符串？

> ID：11867466
> 
> 赞同：0
> 
> 时间：2012-08-08T15:03:43.787
> 
> 标签：regex, bash

我正在尝试提出一个单一的正则表达式来匹配所有包含“移动”但不包含“视频”的字符串我一直在努力在一个表达式中做到这一点，并希望得到任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:11:02.720

使用否定的前瞻断言：

```
^(?!.*video).*mobile 
```

例子：

```
$ cat 1.txt
audio-mobile
mobile-video
mobile-video
video-mobile
videomobile
mobile
audio-mobile
audio

$ grep -P '^(?!.*video).*mobile' 1.txt
audio-mobile
mobile
audio-mobile 
```

# node.js - Redis Pub/Sub 与某种连接

> ID：11867477
> 
> 赞同：0
> 
> 时间：2012-08-08T15:04:18.973
> 
> 标签：node.js, redis

假设我们在 ASP.NET 中有主代码库，在 MSSQL 中有主数据库

我们想添加一些实时功能 - 有一个事件源，每个事件都与某个用户相关。用户具有一对多的关系（友谊）。与特定用户相关的每个事件都应该发布给她的每个朋友（正在收听）。

Redis 和 Node.js+Socket.IO 被认为是（可能是最强大和最适合的）解决方案。因此，当事件发生时，ASP.NET 将发布到 Redis，Node.js 将订阅并通过 Socket.IO 转发到浏览器。

现在的问题 - 过滤逻辑应该在什么时候发生以仅将事件发送给用户的朋友？

我们可以将这些数据存储在内存中的 Node.js 中，但它有效吗？我们可以定期将关系数据导出到 Redis，但是可以通过 Redis 端的一些脚本将其与 Pub/Sub 一起使用吗？

# javascript - jQuery：动态更新 N 个最新值的列表

> ID：11867483
> 
> 赞同：0
> 
> 时间：2012-08-08T15:04:32.043
> 
> 标签：javascript, jquery

我正在编写一个简单的函数，它将使用从服务器推送的数据更新页面。为了简单起见，我使用计时器来模拟服务器推送。

每次推送服务器消息时，我都想更新页面上显示的列表，新收到的消息位于列表顶部，最早的消息被丢弃。

这是我到目前为止所拥有的：

```
<html>
    <head>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    </head>
    <body>
        <div id="main_cntr">
            <ul id="lst">
                <li>Line 1 ....</li>
                <li>Line 2 ....</li>
                <li>Line 3 ....</li>
                <li>Line 4 ....</li>
                <li>Line 5 ....</li>
            </ul>
        <div>
    </body>
    <script type="text/javascript">
         // mimics server side push message received at front end
         // update list to contain only the last 5 elements
         function update_list(newtext){
            // Fetch li elements in $('#lst')
            // truncate last one
            // insert new text to top of li list (ideally, I want to pass the new text to insert to this function)
            alert('Got called')
         }

         $(document).ready(function() {
            window.setInterval(update_list, 10000);
         });
    </script>
</html> 
```

我有两个问题：

1.  我如何正确实现这一点（我不是真正的 JQuery 专家）
2.  如何修改函数`update_list()`以便我可以向它传递一个新文本（例如随机文本），以便它更好地模拟服务器推送的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:11:23.410

这是一个基于您的代码的基本示例，它删除列表中的最后一个元素并在列表顶部添加一个新元素

```
// mimics server side push message received at front end
// update list to contain only the last 5 elements
function update_list(newtext){
    // Fetch li elements in $('#lst')
    // truncate last one
    $('#lst li').last().remove()

    // insert new text to top of li list (ideally, I want to pass the new text to insert to this function)
    $('#lst').prepend("<li>"+newtext+"</li>");

    alert('Got called')
} 
```

除此之外，如果你想用随机数据改进你的模拟，你可以做这样的事情

```
var wordArray = ["hey", "you", "there"];

function RandomWord() {
    var i = Math.floor((Math.random() * wordArray.length));
    return wordArray[i];
} 
```

然后将行替换`update_list`为这个

```
$('#lst').prepend("<li>"+RandomWord()+"</li>"); 
```

最后这里是一个[jsFiddle](http://jsfiddle.net/LQr7Q/2/)展示了这个工作的随机方面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:27:15.587

所以，听起来你在 jQuery 中需要一点 101。互联网上充满了资源，在您阅读完这篇文章后，我希望您能通过一些关于`$`.

jQuery 最基本（也是最常见的）用途之一是获取 DOM 元素，而无需使用冗长的`document.getElementById("id")`. 对于 jQuery，我们可以简单地说`$("#id")`（注意：井号让 jQuery 知道它正在寻找对象 ID，这很重要）。两者都`getElementById`返回`$`对象，但其中`getElementById`返回一个 DOM 元素，`$`返回一个 jQuery 对象。在这种情况下，我们对使用 jQuery 函数感兴趣，[`prepend()`](http://api.jquery.com/prepend/)该函数与 xHTML 在 DOM 元素中的 append 函数具有相似的功能（xHTML 之外的支持充其量是 janky），只有 append 将其参数作为最后一个子元素添加，prepend 添加它们作为第一个。

`$().prepend()`超级好用。它在其父对象中的任何现有内容之后添加它的参数。参数可以是 DOM 元素、jQuery 对象或字符串（任何字符串）。在这种情况下，字符串就可以了。

```
function update_list(newtext)
{
    $("#lst").prepend("<li>" + newtext + "</li>");
} 
```

此代码将创建一个新的 jQuery 对象来代表您`<ul>`的 id `lst`（记住：磅符号！）并要求它`<li>`在其`newtext`内容之前添加一个新对象。

# android - 在活动不可见时计算时间

> ID：11867490
> 
> 赞同：0
> 
> 时间：2012-08-08T15:04:44.133
> 
> 标签：android, android-activity, android-asynctask

我的应用程序需要计算从用户单击按钮到他再次单击它的时间。用户应该能够“四处走动”其他应用程序和活动，并且当他再次打开我的应用程序时 - 计数器将保持稳定计数。

现在我的计数器在后台运行 AsyncTask 但是当用户“四处走动”并摆弄其他应用程序和活动然后回来时 - 我的应用程序不计数。就像您第一次启动该应用程序一样。

我需要做什么才能使其在后台和整个活动生命周期中继续工作和计数？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:18:18.393

为什么不记录您的计数开始时间并从您的应用重新出现的时间中减去它，然后使用该值恢复您的显示器必须完成的任何动态计数任务？

例如：1\. 用户在 000 秒时启动应用程序。以毫秒为单位的 sys 时间戳为 11100000（或其他） 2\. 应用程序运行 5 秒。3\. 用户打开他们的电子邮件应用程序等。 4\. 20 秒后，用户恢复计时器应用程序。5.app计算偏移量；11100025 -11100000 = 25。 6\. 应用程序在 25 处恢复“滴答”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:33:02.193

如果您真的想这样做，请使用[Service](http://developer.android.com/reference/android/app/Service.html)。

您的使用应该是这样的，当您想开始计数时，您会在您的活动上创建一个意图以启动您的服务，在您开始每秒发送一次广播的服务上，您将收到您的活动。

您必须在您的活动上实现广播接收器，并在 onResume 和 onPause 方法上注册和取消注册它。

用户再次单击您的按钮后，然后从您的 Activity 向您的服务发送广播/意图，告诉它停止计数。

该服务不受您活动的生命周期的约束，只要它没有收到广播/意图告诉它停止，它就会运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:29:55.443

答案很简单，您需要一项服务来计算您需要计算的任何内容。

# java - 如何从 Java 向 MySql 发送参数化的 DELETE

> ID：11867491
> 
> 赞同：1
> 
> 时间：2012-08-08T15:04:45.003
> 
> 标签：java, mysql, sql

`PersonnelTable`我想从以下列方式调用的表中删除：

```
public void verifyDetailsBeforeClosingAccount(String _idNumber,String _username,String _password ,String _account)
{

    String retrievedNumberAccount = null;
    String retrievedOwnerIdnumber = null;

    try
    {

        // take all the rows with "account-number" and "id-numbder" in the "Checking-account-table" 

        ResultSet results = this.m_statement.executeQuery("SELECT `AccountNumber`, `IdNumber`  FROM `CheckingAccountsTable`");  
        while (results.next() == true)
        {
            retrievedNumberAccount = results.getString("AccountNumber");  // take the account number 
            retrievedOwnerIdnumber = results.getString("IdNumber");       // take the ID number 

            if (retrievedNumberAccount.equals(_account) == true && retrievedOwnerIdnumber.equals(_idNumber) == true )  // found a partial match 
            {
                // put something here
            }
        }
    }
} 
```

我想删除 中的一行`PersonnelTable`，其中：

1.  `Password`表中的列等于`_password`函数的给定值，
2.  `UserName`表中的列等于`username`给函数的 _。

那不起作用：

```
this.m_statement.executeQuery("DELETE FROM `PersonnelTable` WHERE `Password` = _password AND `UserName` =_username "); 
```

我查看了教程，`DELETE`但没有显示如何将给定值处理为函数。我怎样才能解决这个问题 ？

问候

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T15:08:28.557

用单引号将值括起来，因为它是一个字符串。对？

```
this.m_statement.executeQuery("DELETE FROM `PersonnelTable` 
                               WHERE `Password` = '" + _password + "' AND 
                                     `UserName` = '" + _username + "' "); 
```

对此有更好的**[Java Prepared Statement](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)**。

前任

```
string sqlStatement = "DELETE FROM `PersonnelTable` 
                                   WHERE `Password` = ? AND 
                                         `UserName` = ? ";
PreparedStatement pstmt = con.prepareStatement(sqlStatement);
pstmt.setString(1, _password)
pstmt.setString(2, _username)
pstmt.executeUpdate(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-08T15:09:07.250

您正在做的是删除用户名为“_username”的记录（不是传递给您的值，而是字面意思是“_username”）

您必须：

a) 传递值而不是变量名：

```
 statement.executeQuery("DELETE FROM `PersonnelTable` WHERE `Password` = `" + _password + "` AND `UserName` = `" + _username + "` "); 
```

b) 使用 PreparedStatement（推荐用于避免 SQL 注入攻击）。

编辑：附带说明，如果用户名是寄存器的密钥（唯一标识符），添加密码检查只会减慢操作，使程序复杂化（如果有人同时更改密码怎么办？）并且没有任何优势。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-08T15:09:18.473

您需要使用准备好的语句并将值作为参数传递。

```
 String deleteString = "DELETE FROM `PersonnelTable` WHERE `Password` = ? AND `UserName` = ? ";

 PreparedStatement deleteStmt = con.prepareStatement(deleteString);

 deleteStmt.setString(1, _password);  // Use whatever the object type of user/password are
 deleteStmt.setString(2, _username);

 deleteStmt.executeUpdate();
 con.commit(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-08T15:10:29.007

您正在将文字值 _password 和 _username 发送到您的 SQL 中；相反，您需要传递变量中的值。我建议这样做作为参数。我的 JDBC 非常生锈，因此您暂时将其作为“正确的代码示例在此处”存根。

```
 this.m_statement.executeQuery("DELETE FROM `PersonnelTable` WHERE `Password` = '" + _password + "' AND `UserName` = '"+_username +"'"); // THIS IS BAD -- but it will usually do what you are after if you need it *RIGHT NOW* 
```

正如其他答案所述，您应该使用 PreparedStatement 和参数化查询以确保安全。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-08T15:11:36.730

您可以使用 PrepareStatement 及其 setString() 方法来设置 _password 和 _username。您不应该尝试直接设置 _password 和 _username。使用 setString() 方法时，将 SQL 语句中的 _password 和 _username 变量替换为 '?' 并执行 setString(1, _password) 和 setString(2, _username) 以便第一个变量是密码变量，第二个变量是用户名变量。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-08T15:12:16.667

你试过这个吗？

this.m_statement.executeQuery("DELETE FROM `PersonnelTable`WHERE `Password`= "+_password+" AND `UserName`="+_username);

# tridion - 最后发布的组件的版本号

> ID：11867492
> 
> 赞同：4
> 
> 时间：2012-08-08T15:04:49.960
> 
> 标签：tridion

在 CM 中，我们创建了组件并发布了它们。发布后对组件进行了编辑。我们想找出已发布组件的版本号。我无法从 GUI 中获取此信息。当我查看数据库时，我可以在 items 表中看到版本信息，而 item_states 表有发布信息但它不包含版本参考。现在，有了这些信息，我将不得不编写一个复杂的查询来比较 item_states 和 item 表中的发布日期。

是否有替代（更简单）的方法来查找此信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:20:20.400

SDL Tridion 不存储已发布项目的版本信息，因此确实无法通过 GUI 或 API 获得。

基本上有两种方法可以让您“猜测”这些信息：

1.  使用 API 查找项目发布时的版本

2.  查询数据库以获取此信息

如果您使用数据库查询，第二个选项可能看起来更容易，但让我提醒您，这是一个不受支持的选项。SDL Tridion 的数据模型不是公开的，这意味着它不必在新版本中保持不变。因此，如果您查询数据库，您的解决方案不一定是面向未来的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T20:13:43.257

除了提到的其他选项外，您还可以：

1.  实现一些事件系统代码，响应组件保存时触发的事件，以及成功发布时触发的事件

2.  在您的模板中，在组件演示文稿发布时动态地将元数据添加到它，使版本（可能还有其他东西）可用作代理数据库中的元数据。

正如 Arjen 所评论的，如果您提供了有关您的问题的更多信息，我们可以为您提供更多帮助。

# excel - SSIS 中的 Excel 连接问题

> ID：11867493
> 
> 赞同：0
> 
> 时间：2012-08-08T15:04:54.330
> 
> 标签：excel, excel-2003, ssis

我有 SSIS 包，它从 Excel(.xls) 文件中提取数据并将其加载到 SQL 表中。Durign 设计时，我能够正确映射源 Excel 文件并能够运行包。但是，当我将源文件替换为目录位置中具有相同名称的任何其他 excel 文件时（其格式与以前相同） , 连接失败..

我发现这个问题的原因是：我正在使用的 Excel 文件已从 CSV 或 txt 转换（我不知道他们如何转换它）.. 当我打开这些 excel 文件时，它说，'一些数据可能是丢失'-使用此文件运行程序包我需要做的是-需要打开工作表->单击错误消息上的确定->并保存文件..现在在SSIS连接中一切看起来都很好并且能够获取数据..

我真的很关心部署时如何维护这个包。源文件需要打开，绕过错误并在每次初始化连接之前保存？无论如何在SSIS中实现这个..？

提前致谢..

如果我对上述问题不清楚..请告诉我..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T09:14:00.473

我想不出一种实现的 ssis 方式来满足您的要求。您要归档的内容是使用 excel 修复此文件。这不是 ssis 包可以或应该做的事情。可能有某种方法可以使用脚本任务来编写自己的解决方案，但我认为您应该执行以下操作来保护自己的系统：

**在适当的条件下获取导入数据！**

当您的包必须处理大量损坏的数据时，这会导致您的系统变得越来越复杂。您变得不灵活且容易出错。因此，与提供您的进口数据的人交谈并尝试精益求精。

* * *

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T11:25:19.957

我遇到了与excel文件类似的问题。这种文件是从第三方软件/语言生成的，因此会导致问题。我建议，尝试生成正确的 excel 文件或 CSV，否则在 SSIS 中没有解决此问题的选项。

# javascript - 有没有办法从 javascript 函数中调用控制器操作？

> ID：11867495
> 
> 赞同：2
> 
> 时间：2012-08-08T15:04:59.103
> 
> 标签：javascript, jquery, grails

我有一个 grails 项目，我需要选择要删除的字段，当我单击删除时，我需要一个函数来删除所有选定的项目：

**html代码：**

```
<form name="bookForm" action="list" method="post">
    ....
    <a onclick="deleteBooks();">Delete</a>
    ....
    ....
    <g:checkBox id="select_all" name="select_all" value="" onclick="selectAll();" />
    ....
    <g:each in="${bookList}" status="i" var="bookInstance">
        <tr class="${(i % 2) == 0 ? 'odd' : 'even'}">
            <td><g:checkBox id="${bookInstance.id}" name="delete_checkbox" value="" /></td>
        </tr>
    </g:each>
    ....
</form> 
```

**javascript代码：**

```
<script type="text/javascript">
    function selectAll(){
        var select = document.getElementById("select_all");
        var checkboxes = document.forms['bookForm'].elements['delete_checkbox'];
        if (select.checked){
            for (i = 0; i < checkboxes.length; i++) checkboxes[i].checked = true;
        }else{
            for (i = 0; i < checkboxes.length; i++) checkboxes[i].checked = false;
        }
    }

    function deleteBooks(){
        var checkboxes = document.forms['bookForm'].elements['delete_checkbox'];
        var counter = 0;
            for (i = 0; i < checkboxes.length; i++){
                if(checkboxes[i].checked){
                    counter ++;
                    ${g.remoteFunction(action:'delete', controller:'book', id:checkboxes[i].id) }
                }
            }
            if (counter == 0) alert("select books to delete");
        }
    </script> 
```

selectAll 函数工作正常，但 deleteBooks 函数在我添加时会导致此错误 `${g.remoteFunction(action:'delete', controller:'book', id:checkboxes[i].id) }`

**例外：**

```
Error 500: Error evaluating expression [g.remoteFunction(action:&#39;delete&#39;, controller:&#39;book&#39;, id: checkboxes[i].id)] on line [26]: Cannot get property &#39;null&#39; on null object
Servlet: grails
URI: /myProject/grails/book/list.dispatch
Exception Message: Cannot get property &#39;null&#39; on null object 
Caused by: Error evaluating expression [g.remoteFunction(action:&#39;delete&#39;, controller:&#39;book&#39;, id: checkboxes[i].id)] on line [26]: Cannot get property &#39;null&#39; on null object 
Class: list.gsp 
At Line: [26] 
Code Snippet: 
```

如果我用`${g.remoteFunction(action:'delete', controller:'book') }`

**例外：**

```
Error 500: Error evaluating expression [g.remoteFunction(action:&#39;delete&#39;, controller:&#39;book&#39;)] on line [27]: No javascript provider is configured
Servlet: grails
URI: /myProject/grails/book/list.dispatch
Exception Message: No javascript provider is configured 
Caused by: Error evaluating expression [g.remoteFunction(action:&#39;delete&#39;, controller:&#39;book&#39;)] on line [27]: No javascript provider is configured 
Class: list.gsp 
At Line: [27] 
Code Snippet: 
```

**如何从 javascript 函数或 jquery 调用控制器操作？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:15:02.763

GSP 在服务器端工作，JavaScript 在客户端工作。你不能混合它，使用ajax：

```
$.ajax({
   type: 'POST',
   url: "${createLink(action:'delete', controller:'book')}/" + checkboxes[i].id
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-09T13:47:08.407

```
function deleteBooks(){
    var checkboxes = document.forms['bookForm'].elements['delete_checkbox'];
    var counter = 0;
    for (i = 0; i < checkboxes.length; i++){
        if(checkboxes[i].checked){
              counter ++;
              var bookId = checkboxes[i].id;
              <g:remoteFunction controller="book" action="delete" id="${bookId}" /> 
        }
    }
    if (counter == 0) alert("select books to delete");
} 
```

如果有任何错误请通知我

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:19:02.897

`remoteFunction`很好，但是您需要有一个 javascript 库。查看[http://grails.org/plugin/jquery](http://grails.org/plugin/jquery)以及如何安装它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:22:56.610

如果您编写 javascript 内联，您可以这样做。但是，如果 javascript 在您包含的文件中 - 它将不起作用。你也不需要“g”。在远程函数中。

# ms-office - 如何将我的软件包含在 Microsoft Office 软件（Word、Excel 和 PowerPoint）的菜单中

> ID：11867497
> 
> 赞同：-3
> 
> 时间：2012-08-08T15:05:09.177
> 
> 标签：ms-office

我想在 Microsoft Office 的上下文菜单中包含一个链接到我的软件的选项。

简而言之，我想要做的是：用户选择一个单词，右键单击它，然后在选择中，用户单击我的自定义选项。然后，它以单词作为参数启动我的应用程序。

就像 Antidote 所做的那样……对于那些知道它的人。

有没有人有任何线索来实现这一目标？我已经找过了，但我还没有找到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:12:21.190

修改[这个例子](http://www.codeproject.com/Articles/246837/How-to-add-a-menu-item-in-Microsoft-Office-Word-7)来执行你想要的任何东西（你的应用程序，也许有一个参数？）谷歌为我想出了很多答案。

其他文章：

*   [MSDN 链接 1](http://msdn.microsoft.com/en-us/library/dd554969.aspx)
*   [MSDN 链接 2](http://msdn.microsoft.com/en-us/library/office/ee691832.aspx)

# snmp - Indi TIdSNMP：如何使用 SendQuery

> ID：11867499
> 
> 赞同：0
> 
> 时间：2012-08-08T15:05:15.570
> 
> 标签：snmp, indy, c++builder-xe

我在 c++builder Xe（**清单代码 1**）中创建了以下例程，使用 Indi 组件 TIdSNMP 来查询代理 snmp。

对**SendQuery**的调用失败，连接正常，但代理始终不返回任何内容。

我还尝试使用**QuickSend**方法（**清单代码 2**）查询代理，在这种情况下，第二个例程工作正确，所以我想我在使用第一个例程时犯了一些错误。

有人能告诉我在第一个例程中我哪里错了吗？

最好的问候，恩佐

**清单 1**

```
 void __fastcall TForm1::LabelSimpleSnmpCallClick(TObject * Sender)
    {
        String s1, s2, hostTarget = Edit_SnmpServer->Text, sysDescr = "1.3.6.1.2.1.1.1.0", sysUpTime = "1.3.6.1.2.1.1.3.0";

        TIdSNMP * clientSnmp = 0;
        TSNMPInfo * infoSnmp = 0;
        std::auto_ptr< TStringList >sl1(new TStringList());
        std::auto_ptr< TStringList >sl2(new TStringList());

        Mylog(Format("Test simple SNMP call on server [%s]", ARRAYOFCONST((hostTarget))));
        try
        {
            __try
            {
                clientSnmp                 = new TIdSNMP(NULL);
                clientSnmp->Host           = hostTarget;
                clientSnmp->Community      = "pubblic";
                clientSnmp->ReceiveTimeout = 6000;
                clientSnmp->Connect();
                if (clientSnmp->Connected())
                {
                    clientSnmp->Query->Clear();
                    clientSnmp->Query->MIBAdd(sysDescr, "");
                    clientSnmp->Query->MIBAdd(sysUpTime, "");
                    clientSnmp->Query->PDUType = PDUGetRequest;
                    clientSnmp->SendQuery();
                    infoSnmp = clientSnmp->Reply;

                    if (infoSnmp->ValueCount > 0)
                    {
                        sl1->Clear();
                        sl2->Clear();
                        sl1->AddStrings(infoSnmp->MIBOID);
                        sl2->AddStrings(infoSnmp->MIBValue);

                        for (int idx = 0; idx < sl1->Count; idx++)
                        {
                            s1 = sl1->Strings[idx];
                            s2 = sl2->Strings[idx];
                            Mylog(Format("Query on [%s] : [%s] => [%s]", ARRAYOFCONST((hostTarget, s1, s2))));
                        }
                    }
                    else
                    {
                        Mylog("*** No anwser *** ");
                    }
                }
                else
                {
                    Mylog("*** No connected *** ");
                }
            }
            __finally
            {
                if (clientSnmp)
                {
                    delete clientSnmp;
                    clientSnmp = 0;
                }
            }
        }
        catch (Exception & ex)
        {
            Mylog(Format("ERROR [%s] ", ARRAYOFCONST((ex.Message))));
        }

    } 
```

**清单 2**

```
void __fastcall TForm1::LabelQuickSendClick(TObject * Sender)
{
    TIdSNMP * clientSnmp = 0;
    String hostTarget    = Edit_SnmpServer->Text, sysDescr = "1.3.6.1.2.1.1.1.0", sysUpTime = "1.3.6.1.2.1.1.3.0", val;

    __try
    {
        clientSnmp                 = new TIdSNMP(NULL);
        clientSnmp->ReceiveTimeout = 6000;
        clientSnmp->QuickSend(sysDescr, "public", hostTarget, val);
        Mylog(Format("Query on [%s] : [%s] => [%s]", ARRAYOFCONST((hostTarget, sysDescr, val))));
        clientSnmp->QuickSend(sysUpTime, "public", hostTarget, val);
        Mylog(Format("Query on [%s] : [%s] => [%s]", ARRAYOFCONST((hostTarget, sysUpTime, val))));
    }
    __finally
    {
        delete clientSnmp;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:42:21.070

在清单 1 中，您将其设置`Community`为`"pubblic"`，但在清单 2 中，您将其设置为`"public"`。这在 SNMP 中有很大的不同。

至于其余的代码，我建议进行以下更改以简化代码：

```
void __fastcall TForm1::LabelSimpleSnmpCallClick(TObject * Sender)
{
    String hostTarget = Edit_SnmpServer->Text;
    String sysDescr = "1.3.6.1.2.1.1.1.0";
    String sysUpTime = "1.3.6.1.2.1.1.3.0";

    Mylog(Format("Test simple SNMP call on server [%s]", ARRAYOFCONST((hostTarget))));
    try
    {
        std::auto_ptr<TIdSNMP> clientSnmp(TIdSNMP(NULL));
        clientSnmp->Host           = hostTarget;
        clientSnmp->Community      = "public";
        clientSnmp->ReceiveTimeout = 6000;

        clientSnmp->Query->PDUType = PDUGetRequest;
        clientSnmp->Query->MIBAdd(sysDescr, "");
        clientSnmp->Query->MIBAdd(sysUpTime, "");

        if (clientSnmp->SendQuery())
        {
            int cnt = clientSnmp->Reply->ValueCount;
            if (cnt > 0)
            {
                for (int idx = 0; idx < cnt; ++idx)
                {
                    String s1 = clientSnmp->Reply->ValueOID[idx];
                    String s2 = clientSnmp->Reply->Value[idx];
                    Mylog(Format("Query on [%s] : [%s] => [%s]", ARRAYOFCONST((hostTarget, s1, s2))));
                }
            }
            else
            {
                Mylog("*** No anwser *** ");
            }
        }
        else
        {
            Mylog("*** Query not sent *** ");
        }
    }
    catch (const Exception & ex)
    {
        Mylog(Format("ERROR [%s] ", ARRAYOFCONST((ex.Message))));
    }
} 
```

如果您重载`Mylog()`以接受可变数量的参数，则可以稍微简化日志记录：

```
void __fastcall TForm1::Mylog(const String &Msg)
{
    // use Msg as needed ...
}

void __fastcall TForm1::Mylog(const String &Msg, const TVarRec *Args, int Args_High)
{
    Mylog(Format(Msg, Args, Args_High));
}

void __fastcall TForm1::LabelSimpleSnmpCallClick(TObject * Sender)
{
    String hostTarget = Edit_SnmpServer->Text;
    String sysDescr = "1.3.6.1.2.1.1.1.0";
    String sysUpTime = "1.3.6.1.2.1.1.3.0";

    Mylog("Test simple SNMP call on server [%s]", ARRAYOFCONST((hostTarget)));
    try
    {
        std::auto_ptr<TIdSNMP> clientSnmp(TIdSNMP(NULL));
        clientSnmp->Host           = hostTarget;
        clientSnmp->Community      = "public";
        clientSnmp->ReceiveTimeout = 6000;

        clientSnmp->Query->PDUType = PDUGetRequest;
        clientSnmp->Query->MIBAdd(sysDescr, "");
        clientSnmp->Query->MIBAdd(sysUpTime, "");

        if (clientSnmp->SendQuery())
        {
            int cnt = clientSnmp->Reply->ValueCount;
            if (cnt > 0)
            {
                for (int idx = 0; idx < cnt; ++idx)
                {
                    String s1 = clientSnmp->Reply->ValueOID[idx];
                    String s2 = clientSnmp->Reply->Value[idx];
                    Mylog("Query on [%s] : [%s] => [%s]", ARRAYOFCONST((hostTarget, s1, s2)));
                }
            }
            else
            {
                Mylog("*** No anwser *** ");
            }
        }
        else
        {
            Mylog("*** Query not sent *** ");
        }
    }
    catch (const Exception & ex)
    {
        Mylog("ERROR [%s] ", ARRAYOFCONST((ex.Message)));
    }
} 
```

如果您切换到`String::vprintf()`then `Format()`，您可以进一步简化日志记录：

```
void __cdecl TForm1::Mylog(const PChar MsgFmt, ...)
{
    String Msg;

    va_list args;
    va_start(args, MsgFmt);
    Msg.vprintf(MsgFmt, args);
    va_end(args);

    // use Msg as needed...
}

void __fastcall TForm1::LabelSimpleSnmpCallClick(TObject * Sender)
{
    String hostTarget = Edit_SnmpServer->Text;
    String sysDescr = "1.3.6.1.2.1.1.1.0";
    String sysUpTime = "1.3.6.1.2.1.1.3.0";

    Mylog("Test simple SNMP call on server [%s]", hostTarget.c_str());
    try
    {
        std::auto_ptr<TIdSNMP> clientSnmp(TIdSNMP(NULL));
        clientSnmp->Host           = hostTarget;
        clientSnmp->Community      = "public";
        clientSnmp->ReceiveTimeout = 6000;

        clientSnmp->Query->PDUType = PDUGetRequest;
        clientSnmp->Query->MIBAdd(sysDescr, "");
        clientSnmp->Query->MIBAdd(sysUpTime, "");

        if (clientSnmp->SendQuery())
        {
            int cnt = clientSnmp->Reply->ValueCount;
            if (cnt > 0)
            {
                for (int idx = 0; idx < cnt; ++idx)
                {
                    String s1 = clientSnmp->Reply->ValueOID[idx];
                    String s2 = clientSnmp->Reply->Value[idx];
                    Mylog("Query on [%s] : [%s] => [%s]", hostTarget.c_str(), s1.c_str(), s2.c_str());
                }
            }
            else
            {
                Mylog("*** No anwser *** ");
            }
        }
        else
        {
            Mylog("*** Query not sent *** ");
        }
    }
    catch (const Exception & ex)
    {
        Mylog("ERROR [%s] ", ex.Message.c_str());
    }
} 
```

# opengl - Gstreamer OpenGL 插件

> ID：11867501
> 
> 赞同：1
> 
> 时间：2012-08-08T15:05:23.340
> 
> 标签：opengl, plugins, gstreamer

我已经克隆并成功安装了 gst-plugins-gl - Gstreamer 的 OpenGL 插件（在 Ubuntu 12.04、i386 上），但后来我尝试了：

gst-launch filesrc 位置=FORM.MPG ！mpeg2dec ！glimagesink

但“glimagesink”不作为 gstreamer 的元素存在。

我试过gst-inspect opengl，但是没有opengl插件...

变量 GST_PLUGIN_PATH 设置为 /usr/local/lib/gstreamer-0.10，我在其中复制了文件：

libgstopengl.la libgstopengl.so

因为最初他们在 /usr/local/lib/gstreamer- （没有 0.10）

但它仍然不起作用。

gstreamer 0.10 不支持 gst-register

如何添加新插件并在 gstreamer 上使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T15:18:10.723

您是如何构建和安装它们的。如果它们最终出现在 /usr/local/lib/gstreamer- （没有 0.10）中，那么您以错误的方式使用了一些额外的参数。复制插件不会解决它，因为 gl 插件也有一个库。相反，您需要修复配置、构建和安装它们的方式。

因此回到你的源目录，先运行 sudo make uninstall 进行清理。如果您希望它们位于软件包中的 gstreamer 插件旁边，请执行 ./autogen.sh --prefix=/usr。保留默认前缀=/usr/local 也可以，但是您需要同时设置 LD_LIBRARY_PATH 和 GST_PLUGIN_PATH。

# ios - 为大于 2Gb 的企业许可应用程序建议的 iOS 工作流程

> ID：11867503
> 
> 赞同：1
> 
> 时间：2012-08-08T15:05:29.233
> 
> 标签：ios, ipad, bundle

我知道应用商店的最大应用大小为 2Gb，但据我了解，使用企业许可证，您可以拥有更大的应用。在这种情况下，我需要在 ipad 上存储 500,000 多张图像，总计 8Gb。这将是唯一安装在 64Gb iPad3 上的应用程序。图像必须存储在 iPad 上，运行时一次只能加载 36 张 768 x 768px 的图像。

任何人都对如何处理这样的任务有一些见解，即使它是可能的？

到目前为止，我正在尝试制作一个 1gb 的捆绑包进行测试，但这使得构建过程和调试非常缓慢

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:55:40.360

只用几张图像创建应用程序，并有一个按钮，让用户可以从您的应用程序保存的服务器下载其余图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T03:51:32.683

好吧，无论出于何种原因，在被否决之后，我都会用几个概念证明的结果来回答我自己的问题。由于业务需求，不能从服务器下载图像。

我已经成功地在 iPad 上运行了一个企业应用程序，运行时具有 4gb 的测试数据和 144 个 1024 x 1024 图像。问题是图像按顺序加载并展平到画布中以减少内存消耗。如果内存消耗激增，iPad 似乎会终止您的应用程序，如果您逐渐增加内存消耗量，它将允许您根据当前打开的应用程序和进程增加更多。

# xml - 将xml转换为纯字符串

> ID：11867506
> 
> 赞同：1
> 
> 时间：2012-08-08T15:05:37.663
> 
> 标签：xml, vb.net

我正在尝试将类对象序列化为字符串。但它从下面的代码中以 xml 的形式给出输出。

```
Dim x As New Xml.Serialization.XmlSerializer(response.GetType)
Dim sw As New IO.StringWriter()
x.Serialize(sw, response)
Return sw.ToString 
```

**电流输出**

```
<Employees>
<Employee>John</Employee>
<Employee>Peter</Employee>
</Employees> 
```

**预期产出**

```
<Employees><Employee>John</Employee><Employee>Peter</Employee></Employees> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T15:36:38.607

您需要使用一个`XmlTextWriter`，以便您可以指定您希望如何格式化 XML 输出。例如：

```
Dim x As New Xml.Serialization.XmlSerializer(response.GetType)
Using sw As New IO.StringWriter()
  Using xw As New XmlTextWriter(sw)
    xw.Formatting = Formatting.None
    x.Serialize(xw, response)
    Return sw.ToString
  End Using
End Using 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:34:45.223

不要将响应文本转换为 XML 对象，将其保留为字符串。

从那里开始，[这篇](https://stackoverflow.com/questions/4906279/remove-carriage-return-from-string)文章应该很有启发性。一旦这一切都说完并存储在一个变量中，您就可以按照您的意愿进行所有 XML 序列化。

# android - android手机可以用作生物识别指纹设备吗

> ID：11867508
> 
> 赞同：4
> 
> 时间：2012-08-08T15:05:41.577
> 
> 标签：android, biometrics

> **可能重复：**
> [安卓设备是否支持指纹？](https://stackoverflow.com/questions/10369799/is-fingerprint-supported-in-android-devices)

是否可以将安卓手机用作生物识别指纹设备？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:08:34.070

不可以。大多数触摸屏设备只能记录少量的同时触摸——最多十几个。因此，即使分辨率（位置精度）和灵敏度（压力精度）足够，您也无法扫描足够的细节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:07:30.147

比如，你触摸屏幕，它就会得到你的指纹？不，触摸屏没有那种扫描技术。至于马克关于使用相机的评论，这可能会非常困难。光线的变化会使指纹中的所有线条都很难辨认出来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:12:13.140

我所知道的唯一一款集成指纹识别器的安卓手机是摩托罗拉 Atrix。理论上，可以使用相机和一些图像处理代码来开发软件应用程序来完成这项任务，但我还没有听说过任何认真的尝试。请注意，这种方法与您今天在市场上看到的新奇应用不同。另一种选择是使用 USB 主机 API 通过 USB 与外部指纹扫描仪连接：[https ://developer.android.com/guide/topics/connectivity/usb/host.html](https://developer.android.com/guide/topics/connectivity/usb/host.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:12:19.717

我不这么认为。不过，通过谷歌快速搜索发现[这家公司](http://www.mobbeel.com/products/)，他们似乎为 Android 手机提供了其他（虹膜、语音、手部几何、签名，显然还有更多）生物识别安全选项。

从他们的网站引用：

```
"MobbID is a state-of-the-art multi-biometric security solution that reliably and
securely verifies the identity of mobile phone users by using their unique features
or in combination i.e. iris, voice, face, signature, hand geometry.

Choose your best-fit biometric method or combine them for greater security and
user convenience." 
```

# mongodb - 在 mongodb 中将字段上移一级

> ID：11867521
> 
> 赞同：1
> 
> 时间：2012-08-08T15:06:43.480
> 
> 标签：mongodb

我已经接管了一个数据库，需要从中导出数据，但我有点不知道如何快速完成。

这是文档布局的示例：

```
 {
   "_id": ObjectId("37035cs978952"),
   "main": {
     "432daf56676": {
       "dat": "2011-09-09T15: 52: 26+01: 00",
       "a": "a",
       "b": "c",
       }
  }
} 
```

所以我想做的就是将“dat”、“a”和“b”拉上一层，这样我就可以快速将 mongo 导出到 csv。例如 mongoexport db collection -f "main.dat", "main.a"。问题是 main 下面的字段是一个随机生成的数字（我不太清楚为什么首先将它放在那里！）。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T22:55:11.593

您可以使用从 mongo shell 运行的一些 JavaScript 来执行此操作：

```
XDB = db.tb;  // season to taste

var cursor;
cursor = XDB.find();

do {
    var olddoc = cursor.next();
    var newdoc = {};
    var oldmain = olddoc.main;

    for( x in oldmain ) {
       var newmain = oldmain[x]; 
       newdoc.main = newmain;
    }
    newdoc._id = olddoc._id;
    XDB.update({_id: olddoc._id}, newdoc );
} while ( cursor.hasNext() ); 
```

# ruby-on-rails - 如何创建适用于 RSpec 中所有规范文件的存根

> ID：11867523
> 
> 赞同：16
> 
> 时间：2012-08-08T15:06:50.593
> 
> 标签：ruby-on-rails, rspec

我想知道是否有一种简单的方法可以在我的所有规范文件中包含一个存根。我正在使用[Geocoder gem](https://github.com/alexreisner/geocoder)，当我运行我的 RSpec 测试时，我不希望它尝试下载位置信息。

我找到了[以下](https://stackoverflow.com/a/5646130/467546)完美的解决方案。但是，我不想在每个规范文件中都写相同的三行。

```
before(:each) do
  User.any_instance.stub(:geocode) { [1,1] }
end 
```

是否可以在我的`spec_helper.rb`文件中放一些东西？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-08T15:15:17.897

您可以将其放在 spec_helper 中，如下所示：

```
RSpec.configure do |config|
  config.before(:each) do
    User.any_instance.stub(:geocode) { [1,1] }
  end
end 
```

# php - OSX launchd - 在后台会话中运行脚本忽略 StartInterval

> ID：11867525
> 
> 赞同：2
> 
> 时间：2012-08-08T15:06:56.647
> 
> 标签：php, macos, intervals, launchd

社区！

我试图在我的 OSX 10.7.4 上每 5 分钟执行一次简单的脚本。无论用户是否登录到机器，它都应该运行（也就是在后台会话中）

因此，我在其中创建了 com.me.script.plist`/System/Library/LaunchDaemons/` 并通过以下方式加载它：`launchctl -S background ./com.me.script.plist` 并通过以下方式启动它：`launchchctl start com.me.script`

它第一次运行良好。但在我设定的 300 秒间隔后它再也不会运行了！

你们对为什么会这样有什么建议吗？如果我在 Aqua Session 中运行它，它可以完美运行，但是，这意味着它只有在用户登录时才会运行。但是，我真的需要它在此之前开始运行......并继续这样做没有无论用户登录/注销还是其他用户登录/注销。

这是我的清单：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
    <dict>
        <key>LimitLoadToSessionType</key>
        <string>Background</string>
        <key>Label</key>
        <string>com.me.script</string>
        <key>ProgramArguments</key>
        <array>
            <string>/usr/bin/php</string>
            <string>/Sites/script/notifier.php</string>
        </array>
        <key>StartInterval</key>
        <integer>900</integer>
    </dict>
</plist> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:16:44.233

我要说问题出在这里：

```
<string>/Sites/script/notifier.php</string> 
```

您的意思是写以下内容吗？

```
<string>/Users/username/Sites/script/notifier.php</string> 
```

开始你的路径`/`暗示路径从驱动器的根目录开始，OSX 默认情况下在根目录下没有`/Sites`目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:59:06.713

我发现了自己的错误……如果我希望它每 5 分钟运行一次，StartInterval 应该是 300 而不是 900。对不起，笨蛋。

# jquery - 如何将 CSS 类添加到 div？

> ID：11867530
> 
> 赞同：-4
> 
> 时间：2012-08-08T15:07:15.900
> 
> 标签：jquery

我有来自[Railscast #288 Billing with Stripe](http://railscasts.com/episodes/288-billing-with-stripe)的这段代码。

```
if status == 200
  alert(response.id)
else
  $('#stripe_error').text(response.error.message)
  $('input[type=submit]').attr('disabled', false) 
```

此特定行`$('#stripe_error').text(response.error.message)`显示错误消息。由于我也在使用 Twitter Bootstrap，因此我想添加`class="alert alert-error"`到该 div。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:13:35.637

你可以通过使用下面的代码来做到这一点：

```
$('#stripe_error').text(response.error.message).addClass('alert alert-error') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:08:21.547

使用[`addClass`](http://api.jquery.com/addClass/)：

```
$('#stripe_error').addClass('alert alert-error'); 
```

# javascript - 在 Javascript 中创建全局变量时是否需要指定对象类型？

> ID：11867534
> 
> 赞同：0
> 
> 时间：2012-08-08T15:07:26.883
> 
> 标签：javascript, jquery

我有以下代码：

```
var oTable = $('#dataTable').dataTable({
 ... 
```

我想将 oTable 声明为全局，但我有点困惑。使用 javascript 我该如何做到这一点，当我将其声明为全局时，我是否必须指定对象类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:08:48.953

简单地说，你没有。您只需像以前一样声明变量，并在需要的任何地方使用它。

当您想在函数中使用全局变量时，您可以简单地键入它的名称，而无需先声明它。

**例子**

```
var MyVar = $('#dataTable').dataTable(); // This is a global variable. Notice that you don't specify a type, as JavaScript is not strongly typed

function MyFunction() {
  var InternalVar = MyVar; // Here you take the value from the global variable, i.e. the datatable
}

function MyOtherFunction() {
  var MyVar = 'This is a string';

  var InternalVar = MyVar; // Here you take the value from the LOCAL variable, which you declared just above, i.e. 'This is a string'
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:09:02.143

您可以像这样全局声明它，没有任何问题。Var 是泛型类型，任何类型都可以分配给它。

```
var oTable = $('#dataTable').dataTable({......

function someFunction()
{

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:13:59.950

全局变量实际上不是变量，而是全局对象的属性。它们可以显式附加如下：

```
window.oTable = $('#dataTable').dataTable({}); 
```

`window`指浏览器javascript中的全局对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:09:41.887

除非该声明在函数内部，否则它`oTable`已经是一个全局变量。此外，Javascript 是动态类型的，这意味着您不能定义变量类型。

有关 Javascript 中的全局变量的更多信息，请查看[这篇](http://snook.ca/archives/javascript/global_variable/)文章。
有关静态与动态类型的更多信息，请查看[此](https://stackoverflow.com/q/125367/1188942)问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T15:10:19.130

您*不能*声明类型。

除非该变量是在使用它的函数中定义的，否则`var`它将是一个全局变量。

# python - 如何使用 Python 将 MongoDB 的 bsondump 转换为 JSON？

> ID：11867538
> 
> 赞同：24
> 
> 时间：2012-08-08T15:07:37.717
> 
> 标签：python, json, mongodb, bson

所以我有大量来自 MongoDB 转储的 .bson。我在命令行上使用[bsondump](http://docs.mongodb.org/manual/reference/bsondump/)，将输出作为标准输入传送到 python。这成功地从 BSON 转换为“JSON”，但它实际上是一个字符串，并且看似不合法的 JSON。

例如，传入行如下所示：

```
{ "_id" : ObjectId( "4d9b642b832a4c4fb2000000" ),
  "acted_at" : Date( 1302014955933 ),
  "created_at" : Date( 1302014955933 ),
  "updated_at" : Date( 1302014955933 ),
  "_platform_id" : 3,
  "guid" : 72106535190265857 } 
```

我相信是[Mongo Extended JSON](http://www.mongodb.org/display/DOCS/Mongo+Extended+JSON)。

当我读到这样一行并执行以下操作时：

```
json_line = json.dumps(line) 
```

我得到：

```
"{ \"_id\" : ObjectId( \"4d9b642b832a4c4fb2000000\" ),
\"acted_at\" : Date( 1302014955933 ),
\"created_at\" : Date( 1302014955933 ),
\"updated_at\" : Date( 1302014955933 ),
\"_platform_id\" : 3,
\"guid\" : 72106535190265857 }\n" 
```

这仍然是`<type 'str'>`。

我也试过

```
json_line = json.dumps(line, default=json_util.default) 
```

（请参阅 pymongo json_util - 垃圾邮件检测阻止第三个链接）似乎输出与上面的转储相同。负载给出错误：

```
json_line = json.loads(line, object_hook=json_util.object_hook)
ValueError: No JSON object could be decoded 
```

那么，如何将 TenGen JSON 字符串转换为可解析的 JSON？（最终目标是将制表符分隔的数据流式传输到另一个数据库）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-09T15:11:14.027

您拥有的是 TenGen 模式下 Mongo Extended JSON 中的转储（请参见[此处](http://www.mongodb.org/display/DOCS/Mongo+Extended+JSON)）。一些可能的方法：

1.  如果可以再次转储，请通过 MongoDB REST API 使用严格输出模式。那应该给你真正的 JSON，而不是你现在拥有的。

2.  使用[http://pypi.python.org/pypi/bson/](http://pypi.python.org/pypi/bson/)`bson`将您已经拥有的 BSON 读入 Python 数据结构，然后对这些数据结构进行您需要的任何处理（可能输出 JSON）。

3.  使用 MongoDB Python 绑定连接到数据库以将数据导入 Python，然后执行您需要的任何处理。（如果需要，您可以设置一个本地 MongoDB 实例并将转储的文件导入其中。）

4.  将 Mongo Extended JSON 从 TenGen 模式转换为 Strict 模式。您可以开发一个单独的过滤器来执行此操作（从标准输入读取，将 TenGen 结构替换为严格结构，并将结果输出到标准输出），或者您可以在处理输入时执行此操作。

这是一个使用 Python 和正则表达式的示例：

```
import json, re
from bson import json_util

with open("data.tengenjson", "rb") as f:
    # read the entire input; in a real application,
    # you would want to read a chunk at a time
    bsondata = f.read()

    # convert the TenGen JSON to Strict JSON
    # here, I just convert the ObjectId and Date structures,
    # but it's easy to extend to cover all structures listed at
    # http://www.mongodb.org/display/DOCS/Mongo+Extended+JSON
    jsondata = re.sub(r'ObjectId\s*\(\s*\"(\S+)\"\s*\)',
                      r'{"$oid": "\1"}',
                      bsondata)
    jsondata = re.sub(r'Date\s*\(\s*(\S+)\s*\)',
                      r'{"$date": \1}',
                      jsondata)

    # now we can parse this as JSON, and use MongoDB's object_hook
    # function to get rich Python data structures inside a dictionary
    data = json.loads(jsondata, object_hook=json_util.object_hook)

    # just print the output for demonstration, along with the type
    print(data)
    print(type(data))

    # serialise to JSON and print
    print(json_util.dumps(data)) 
```

根据您的目标，其中之一应该是一个合理的起点。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-12-20T19:23:02.233

将整个 bson 文档加载到 python 内存中是昂贵的。

如果您想将其流式传输而不是加载整个文件并全部加载，您可以试试这个库。

[https://github.com/bauman/python-bson-streaming](https://github.com/bauman/python-bson-streaming)

```
from bsonstream import KeyValueBSONInput
from sys import argv
for file in argv[1:]:
    f = open(file, 'rb')
    stream = KeyValueBSONInput(fh=f,  fast_string_prematch="somthing") #remove fast string match if not needed
    for id, dict_data in stream:
        if id:
         ...process dict_data... 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-09T15:34:43.303

您可以像这样转换 bson 文件的行：

```
>>> import bson
>>> bs = open('file.bson', 'rb').read()
>>> for valid_dict in bson.decode_all( bs ):
.... 
```

每个 valid_dict 元素都是一个有效的 python dict，你可以将它转换为 json。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-04T14:11:51.457

您可以去除数据类型并使用正则表达式获取严格的 json：

```
import json
import re

#This will outputs a iterator that converts each file line into a dict.
def readBsonFile(filename):
    with open(filename, "r") as data_in:
        for line in data_in:
            # convert the TenGen JSON to Strict JSON
            jsondata = re.sub(r'\:\s*\S+\s*\(\s*(\S+)\s*\)',
                              r':\1',
                              line)

            # parse as JSON
            line_out = json.loads(jsondata)

            yield line_out 
```

# java - 关于单例不良设计

> ID：11867543
> 
> 赞同：-1
> 
> 时间：2012-08-08T15:07:52.597
> 
> 标签：java, multithreading

我有一堂课是下面的一堂课..

```
public class DataBaseDAO { 
    private DataBaseDAO() { }
        public static synchronized DataBaseDAO getInstance() {
            if (dao == null) {
                dao = new DataBaseDAO();
                }
            return dao;
            }
        }
    } 
```

现在这个 getinstance() 方法可以被破解：换句话说，这个单例可以被破解并且可以创建更多对象。

我怎样才能保证这个安全？
这可以通过反射、类加载器和反序列化来解决。
我应该选择同步块而不是对整个方法进行同步吗？
会对性能产生影响吗？

谢谢大家，实际上我不想引入新的枚举，因为在现有的结构中会发生很多变化，我正在寻找如何用当前的方法在类本身内改进现有的单例..！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:20:52.390

你可以更安全地做同样的事情

```
public enum DataBaseDAO { 
    INSTANCE
} 
```

例如，您可以使用反射来使用私有构造函数，`setAccessible(true)`但不能创建新的枚举实例。

代替

```
DataBaseDAO.getInstance().whateverMethod() 
```

您可以使用

```
DataBaseDAO.INSTANCE.whateverMethod() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:25:41.927

实际上你不应该*担心*你的单例*被黑*了。通常，单例被认为是一种糟糕的（过时的）设计实践（它们往往会妨碍或迟到，导致可伸缩性问题并使测试变得不必要地复杂）。

你已经定义了一个明确的访问方法，你（作为设计师或程序员）没有责任防止聪明的黑客不择手段地滥用你的单例。有项目指南可以防止这种情况发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:13:23.513

您需要使用**双重检查锁定，单例模式** 检查此链接：

[http://www.ibm.com/developerworks/java/library/j-dcl/index.html](http://www.ibm.com/developerworks/java/library/j-dcl/index.html)

[http://onjavahell.blogspot.co.il/2009/04/uses-of-singleton-design-pattern-in.html](http://onjavahell.blogspot.co.il/2009/04/uses-of-singleton-design-pattern-in.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:18:29.790

以下3种方式都是安全的，前两种通过类加载机制，最后一种通过同步。

此外，除非您使用 SecurityManagers，否则您无法保护自己免受反射，我认为这非常复杂。

另一个注意事项：不要使用单例；-P

```
class YourClass
{
    public static final YourClass instance = new YourClass();
}

// or

class YourClass2
{
    private static final YourClass2 instance = new YourClass2();

    public static synchronized YourClass2 getInstance()
    {
        return instance;
    }
}

// or

class YourClass3
{
    private static YourClass3 instance;

    public static synchronized YourClass3 getInstance()
    {
        if (instance == null)
            instance = new YourClass3();
        return instance;
    }
} 
```

# javascript - 根据覆盖的背景区域的亮度更改文本颜色？

> ID：11867545
> 
> 赞同：142
> 
> 时间：2012-08-08T15:08:05.710
> 
> 标签：javascript, jquery, html, css, sass

我正在寻找一种插件或技术，它可以改变文本的颜色或在预定义的图像/图标之间切换，具体取决于其父背景图像或颜色的覆盖像素的平均亮度。

如果背景的覆盖区域很暗，请将文本设置为白色或切换图标。

此外，如果脚本能够注意到父级是否没有定义背景颜色或 -image 然后继续搜索最近的（从父元素到其父元素..），那就太好了。

你怎么看，知道这个想法吗？那里已经有类似的东西了吗？例子？

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2012-08-08T15:38:24.210

有趣的资源：

*   [W3C - 确保前景色和背景色组合提供足够的对比度](http://www.w3.org/TR/AERT#color-contrast)
*   [计算颜色的感知亮度](http://www.nbdtech.com/Blog/archive/2008/04/27/Calculating-the-Perceived-Brightness-of-a-Color.aspx)

这是 W3C 算法（[也带有 JSFiddle 演示](http://jsfiddle.net/PXJ2C/)）：

```
const rgb = [255, 0, 0];

// Randomly change to showcase updates
setInterval(setContrast, 1000);

function setContrast() {
  // Randomly update colours
  rgb[0] = Math.round(Math.random() * 255);
  rgb[1] = Math.round(Math.random() * 255);
  rgb[2] = Math.round(Math.random() * 255);

  // http://www.w3.org/TR/AERT#color-contrast
  const brightness = Math.round(((parseInt(rgb[0]) * 299) +
                      (parseInt(rgb[1]) * 587) +
                      (parseInt(rgb[2]) * 114)) / 1000);
  const textColour = (brightness > 125) ? 'black' : 'white';
  const backgroundColour = 'rgb(' + rgb[0] + ',' + rgb[1] + ',' + rgb[2] + ')';
  $('#bg').css('color', textColour); 
  $('#bg').css('background-color', backgroundColour);
}
```

```
#bg {
  width: 200px;
  height: 50px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<div id="bg">Text Example</div>
```

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2012-08-08T15:52:34.273

您可能会对这篇关于[计算颜色对比度的 24 种方法的文章感兴趣。](http://24ways.org/2010/calculating-color-contrast)忽略第一组函数，因为它们是错误的，但 YIQ 公式将帮助您确定是使用浅色还是深色前景色。

获得元素（或祖先）的背景颜色后，您可以使用文章中的此函数来确定合适的前景色：

```
function getContrastYIQ(hexcolor){
    hexcolor = hexcolor.replace("#", "");
    var r = parseInt(hexcolor.substr(0,2),16);
    var g = parseInt(hexcolor.substr(2,2),16);
    var b = parseInt(hexcolor.substr(4,2),16);
    var yiq = ((r*299)+(g*587)+(b*114))/1000;
    return (yiq >= 128) ? 'black' : 'white';
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2017-05-10T15:16:37.563

`mix-blend-mode`诀窍：

```
header {
  overflow: hidden;
  height: 100vh;
  background: url(https://www.w3schools.com/html/pic_mountain.jpg) 50%/cover;
}

h2 {
  color: white;
  font: 900 35vmin/50vh arial;
  text-align: center;
  mix-blend-mode: difference;
  filter: drop-shadow(0.05em 0.05em orange);
}
```

```
<header>
  <h2 contentEditable role='textbox' aria-multiline='true' >Edit me here</h2>
</header>
```

添加（2018 年 3 月）：以下是一个很好的教程，解释了所有不同类型的模式/实现：[https ://css-tricks.com/css-techniques-and-effects-for-knockout-text/](https://css-tricks.com/css-techniques-and-effects-for-knockout-text/)

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-08-08T15:22:44.637

有趣的问题。我的直接想法是将背景颜色反转为文本。这涉及简单地解析背景并反转其 RGB 值。

像这样的东西：http: [//jsfiddle.net/2VTnZ/2/](http://jsfiddle.net/2VTnZ/2/)

```
var rgb = $('#test').css('backgroundColor');
var colors = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
var brightness = 1;

var r = colors[1];
var g = colors[2];
var b = colors[3];

var ir = Math.floor((255-r)*brightness);
var ig = Math.floor((255-g)*brightness);
var ib = Math.floor((255-b)*brightness);

$('#test').css('color', 'rgb('+ir+','+ig+','+ib+')'); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-09-03T12:57:09.440

我发现[BackgroundCheck](http://www.kennethcachia.com/background-check/)脚本非常有用。

它检测背景的整体亮度（无论是背景图像还是颜色），并根据背景的亮度将一个类应用于分配的文本元素（`background--light`或`background--dark`）。

它可以应用于静止和移动元素。

（[来源](http://www.sitepoint.com/4-detect-darklight-background-jquery-plugins/)）

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-10-20T13:53:48.930

如果您使用的是 ES6，请将十六进制转换为 RGB，然后可以使用：

```
const hexToRgb = hex => {
    // turn hex val to RGB
    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex)
    return result
        ? {
              r: parseInt(result[1], 16),
              g: parseInt(result[2], 16),
              b: parseInt(result[3], 16)
          }
        : null
}

// calc to work out if it will match on black or white better
const setContrast = rgb =>
    (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000 > 125 ? 'black' : 'white'

const getCorrectColor = setContrast(hexToRgb(#ffffff)) 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-04-26T19:28:07.700

通过结合答案 [@alex-ball，@jeremyharris]，我发现这对我来说是最好的方法：

```
 $('.elzahaby-bg').each(function () {
            var rgb = $(this).css('backgroundColor');
            var colors = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);

            var r = colors[1];
            var g = colors[2];
            var b = colors[3];

            var o = Math.round(((parseInt(r) * 299) + (parseInt(g) * 587) + (parseInt(b) * 114)) /1000);

            if(o > 125) {
                $(this).css('color', 'black');
            }else{
                $(this).css('color', 'white');
            }
        });
```

```
*{
    padding: 9px;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.0/jquery.min.js"></script>
<div class='elzahaby-bg' style='background-color:#000'>color is white</div>

<div class='elzahaby-bg' style='background-color:#fff'>color is black</div>
<div class='elzahaby-bg' style='background-color:yellow'>color is black</div>
<div class='elzahaby-bg' style='background-color:red'>color is white</div>
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-08-19T22:10:53.443

这是我的尝试：

```
(function ($) {
    $.fn.contrastingText = function () {
        var el = this,
            transparent;
        transparent = function (c) {
            var m = c.match(/[0-9]+/g);
            if (m !== null) {
                return !!m[3];
            }
            else return false;
        };
        while (transparent(el.css('background-color'))) {
            el = el.parent();
        }
        var parts = el.css('background-color').match(/[0-9]+/g);
        this.lightBackground = !!Math.round(
            (
                parseInt(parts[0], 10) + // red
                parseInt(parts[1], 10) + // green
                parseInt(parts[2], 10) // blue
            ) / 765 // 255 * 3, so that we avg, then normalize to 1
        );
        if (this.lightBackground) {
            this.css('color', 'black');
        } else {
            this.css('color', 'white');
        }
        return this;
    };
}(jQuery)); 
```

然后使用它：

```
var t = $('#my-el');
t.contrastingText(); 
```

这将立即使文本根据需要变为黑色或白色。做图标：

```
if (t.lightBackground) {
    iconSuffix = 'black';
} else {
    iconSuffix = 'white';
} 
```

然后每个图标可能看起来像`'save' + iconSuffix + '.jpg'`。

请注意，这在任何容器溢出其父容器的情况下都不起作用（例如，如果 CSS 高度为 0，并且溢出未隐藏）。要让它工作起来会复杂得多。

# android - 滚动后无法选择的列表项

> ID：11867546
> 
> 赞同：0
> 
> 时间：2012-08-08T15:08:05.970
> 
> 标签：android, listview

我遇到了包含 ListView 的 Activity 的问题。当 Activity 加载时，ListView 被填充，我可以点击行就好了。但是，一旦我滚动，这些项目就不再是可点击的了。为了能够单击一个项目，我必须旋转屏幕（注意：我`android:configChanges="keyboardHidden|orientation"`在 Manifest 中有此 Activity 的设置，因此 Activity 甚至不会在方向更改时被破坏）。我不太确定问题是什么。我有很多包含 ListViews 的活动，但没有一个有这个问题。有人看到有什么不对吗？

更新：我删除了 getView 开头关于页脚的代码。现在一切正常。这段代码有什么问题？我的页脚本质上是一个投影，但如果 ListView（阅读：ListView 中的项目）占据整个屏幕，我不希望它存在。

这是我的活动代码。

```
public class ActivitySelector extends MyActivity implements OnItemClickListener, OnClickListener {

    private ArrayList<MyObject> mItems;
    private ActivitySelectorAdapter mAdapter;

    private ListView mList;
    private LinearLayout mFooter;
    private Button mDone;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.layout_filterselector);

        super.onCreate(savedInstanceState);

        mItems = new ArrayList<MyObject>();

        getDataFromIntent();
        setUpUI();
    }

    public void onClick(View v) {
        if (v.getId() == R.id.activityselector_menu) {
            super.openSlider();
        }
        else if (v.getId() == R.id.activityselector_done) {
            this.onBackPressed();
        }
        else {
            super.onClick(v);
        }
    }

    public void onItemClick(AdapterView<?> l, View v, int position, long id) {
        if (l.getId() == R.id.activityselector_list) {
            if (position < mItems.size()) {
                mItems.get(position).setSelected(!mItems.get(position).getSelected());
                mAdapter.notifyDataSetChanged();
            }
        }
    }

    private void getDataFromIntent() {
        Bundle data = getIntent().getExtras();
        if (data != null) {
            if (data.containsKey("items")) {
                mItems = data.getParcelableArrayList("items");
            }
        }
    }

    private void setUpUI() {
        mDone = (Button) findViewById(R.id.activityselector_done);
        mDone.setOnClickListener(this);

        mList = (ListView) findViewById(R.id.activityselector_list);
        mFooter = (LinearLayout) ((LayoutInflater)this.getSystemService(Context.LAYOUT_INFLATER_SERVICE)).inflate(R.layout.layout_listfooter, mList, false);
        mList.addFooterView(mFooter, null, false);

        mAdapter = new ActivitySelectorAdapter(ActivitySelector.this, R.layout.layout_activityselector_item, mItems);
        mList.setAdapter(mAdapter);
        mList.setOnItemClickListener(this);
    }

    static class ActivitySelectorHolder {
        TextView txtName;
        TextView txtCount;
        ImageView imgCheck;
    }

    public class ActivitySelectorAdapter extends ArrayAdapter<MyObject> {

        private LayoutInflater mInflater;
        ArrayList<MyObject> items;

        public ActivitySelectorAdapter(Context context, int textViewResourceId, ArrayList<MyObject> items) {
            super(context, textViewResourceId, items);
            mInflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            this.items = items;
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            if (mList.getFirstVisiblePosition() > 0) {
                if (mList.getFooterViewsCount() > 0) {
                    mList.removeFooterView(mFooter);
                }
            }
            else {
                if (mList.getFooterViewsCount() < 1) {
                    mList.addFooterView(mFooter, null, false);
                }
            }

            ActivitySelectorHolder holder = null;

            if (null == convertView) {
                holder = new ActivitySelectorHolder();
                convertView = mInflater.inflate(R.layout.layout_activityselector_item, null);
                holder.txtName = (TextView) convertView.findViewById(R.id.activityselector_item_name);
                holder.txtCount = (TextView) convertView.findViewById(R.id.activityselector_item_count);
                holder.imgCheck = (ImageView) convertView.findViewById(R.id.activityselector_item_check);
                convertView.setTag(holder);
            }
            else {
                holder = (ActivitySelectorHolder)convertView.getTag();
            }

            if (holder.txtName != null) {
                holder.txtName.setText(items.get(position).getName());
            }

            if (holder.txtCount != null) {
                holder.txtCount.setText("(" + String.valueOf(items.get(position).getCount()) + ")");
            }

            if (holder.imgCheck != null) {
                if (items.get(position).getSelected()) {
                    holder.imgCheck.setImageResource(R.drawable.selector_checkmark_reverse);
                }
                else {
                    holder.imgCheck.setImageResource(R.drawable.selector_checkmark);
                }
            }

            return convertView;
        }
    }
} 
```

# mysql - MySQL替换单个反斜杠

> ID：11867549
> 
> 赞同：6
> 
> 时间：2012-08-08T15:08:19.497
> 
> 标签：mysql

尝试替换大型数据库中的单个反斜杠。打算在一列上运行更新替换查询，但我不知道如何替换单个反斜杠。完成了一些糟糕的更新，这些斜线需要更改为另一个字符，它们没有转义任何内容，也没有执行任何相关功能。

```
SELECT
REPLACE (
    "Some\s string\s with slashe\s",
    '\\',
    '  something  '
) 
```

当我运行它时，输出是：“Somes strings with slashes”

有没有办法在一个斜杠上进行真正的替换？无论我在 replace 参数中添加什么，它只是消除了单个反斜杠，但实际上并没有替换它。不确定这是一个错误还是我只是错过了一些东西。

我试过了：

```
SELECT
REPLACE (
    "Some\s string\s with slashe\s",
    '\',
    '  something  '
) 
```

我得到：

[Err] 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '\')' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:20:45.020

`REPLACE( )`不需要逃避

```
select replace("Some\s string\s with slashe\s", '\\', '  something  '); 
```

**更新 1**

我想你想永久更换它。对？`UPDATE`不使用`SELECT`

```
UPDATE tableName
SET    columnName = replace(columnName, '\\', '#'); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-08T15:18:46.777

replace() 的参数不需要转义：

选择替换('A\B\C', '\', '\');

输出：

```
A\\\\B\\C 
```

所以这将起作用：

```
select Name from T where Name = replace('A\\B\C', '\', '\\'); 
```

[如这里](https://stackoverflow.com/questions/10059450/mysql-replace-backslash-in-strings)所见

# c# - 使用存储过程显示错误消息

> ID：11867551
> 
> 赞同：2
> 
> 时间：2012-08-08T15:08:20.713
> 
> 标签：c#, sql-server

我有一个插入存储过程，我想检查电子邮件是否已经存在，如果存在我必须向用户显示错误，但是如何抛出错误并在后面的代码中捕获它？

```
CREATE procedure [dbo].[SP_ProfileRegMaster]
    @UserId Varchar(50),
    @FirstName Varchar(50)
    @EmailID varchar (50)
    @result int out)
AS
BEGIN
    IF EXISTS (SELECT EmailId FROM Profile_Master WHERE EmailId = @EmailId)
    BEGIN
        SET @result = 0
    ELSE
       RAISERROR ('Email address does not exist.', 1, 1)
END 
```

C#代码：

```
result = cmd1.Parameters.Add("@result", System.Data.SqlDbType.Int);
result.Direction = System.Data.ParameterDirection.Output; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:41:02.493

[`RAISERROR`](http://msdn.microsoft.com/en-us/library/ms178592.aspx)`severity`只有当参数 >= 11时才会在应用程序中抛出异常。

您的代码设置`severity`为 1，这被归类为信息性消息，并且不会返回给应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T10:31:57.043

正如我在评论中提到的那样，在您的情况下，我不会使用 RAISERROR() 。你可以这样做：

**存储过程**

```
CREATE procedure [dbo].[SP_ProfileRegMaster]
  @UserId  Varchar(50),
  @FirstName  Varchar(50)
  @EmailID varchar (50))
AS BEGIN
  if exists(select EmailId from Profile_Master where EmailId=@EmailId)
  begin
    return 0
  else
    return 1
  end
end 
```

**C# 代码**

```
SqlConnection conn = new SqlConnection(getConnectionString())
SqlCommand cmd = new SqlCommand("SP_ProfileRegMaster", conn);
cmd.CommandType = CommandType.StoredProcedure;

// Pass parameters to Stored Proc...

// Add one more parameter to store the Return Value
var returnParameter = cmd.Parameters.Add("@ReturnVal", SqlDbType.Int);
returnParameter.Direction = ParameterDirection.ReturnValue;

conn.Open();
cmd.ExecuteNonQuery();
// Retrieve the return value
var result = returnParameter.Value; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:19:38.470

如果您的结果只有 0 和 1，那么 @Result 应该有点，1 表示电子邮件地址存在，如果不存在，则为 0，那么您可以检查结果为真或假的代码。

编辑：

要使用 RAISEERROR，请使用以下命令

```
RAISERROR ( { msg_id | msg_str | @local_variable }
{ ,severity ,state }
[ ,argument [ ,...n ] ] )
[ WITH option [ ,...n ] ] 
```

例如：

```
 RAISERROR ('Message',10,1) 
```

10 是严重性，1 是状态

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:16:50.240

如果您真的想从 SQL 中抛出自定义错误，请使用[RAISERROR](http://msdn.microsoft.com/en-us/library/ms178592%28v=sql.105%29.aspx)，即

```
ELSE
     RAISERROR ('Email address does not exist.', 1, 1) 
```

但是，从您的示例 SQL 中，您可以设置`@Result`为与成功值不同的值：

```
ELSE
    SET @Result = 1 --indicates an error 
```

并检查`@Result`您的 C# 的值。

# c# - 我如何调用 Form1 或 this？

> ID：11867558
> 
> 赞同：2
> 
> 时间：2012-08-08T15:08:41.037
> 
> 标签：c#

我有这个功能：

```
public void NudgeMe()
        {

            int xCoord = this.Left;
            int yCoord = this.Top;

            int rnd = 0;

            Random RandomClass = new Random();

            for (int i = 0; i <= 500; i++)
            {
                rnd = RandomClass.Next(xCoord + 1, xCoord + 15);
                this.Left = rnd;
                rnd = RandomClass.Next(yCoord + 1, yCoord + 15);
                this.Top = rnd;
            }
            this.Left = xCoord;
            this.Top = yCoord;
        } 
```

我在这里调用这个函数：

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
        {
            BackgroundWorker worker = sender as BackgroundWorker;
            while (true)
            {

                if ((worker.CancellationPending == true))
                {
                    e.Cancel = true;
                    break;
                }
                else
                {
                    if (tempCpuValue >= (float?)nud1.Value || tempGpuValue >= (float?)nud1.Value)
                    {
                        soundPlay = true;
                        blinking_label();
                        NudgeMe();
                    }
                    else
                    {
                        soundPlay = false;
                        stop_alarm = true;

                    }
                    cpuView();
                    gpuView();
                    Thread.Sleep(1000);
                }
            }
        } 
```

我得到的异常是： invalidOperationException 跨线程操作无效：控件'Form1'从创建它的线程以外的线程访问

例外是在 NudgeMe() 中的行：

```
this.Left = rnd; 
```

这条线被涂成绿色。

```
System.InvalidOperationException was unhandled by user code
  Message=Cross-thread operation not valid: Control 'Form1' accessed from a thread other than the thread it was created on.
  Source=System.Windows.Forms
  StackTrace:
       at System.Windows.Forms.Control.get_Handle()
       at System.Windows.Forms.Control.SetBoundsCore(Int32 x, Int32 y, Int32 width, Int32 height, BoundsSpecified specified)
       at System.Windows.Forms.Form.SetBoundsCore(Int32 x, Int32 y, Int32 width, Int32 height, BoundsSpecified specified)
       at System.Windows.Forms.Control.SetBounds(Int32 x, Int32 y, Int32 width, Int32 height, BoundsSpecified specified)
       at System.Windows.Forms.Control.set_Left(Int32 value)
       at HardwareMonitoring.Form1.NudgeMe() in D:\C-Sharp\HardwareMonitoring\HardwareMonitoring\Hardwaremonitoring\Form1.cs:line 782
       at HardwareMonitoring.Form1.backgroundWorker1_DoWork(Object sender, DoWorkEventArgs e) in D:\C-Sharp\HardwareMonitoring\HardwareMonitoring\Hardwaremonitoring\Form1.cs:line 727
       at System.ComponentModel.BackgroundWorker.OnDoWork(DoWorkEventArgs e)
       at System.ComponentModel.BackgroundWorker.WorkerThreadStart(Object argument)
  InnerException: 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:12:49.413

您只能与创建它的线程中的控件（或窗体）进行交互。您的异常被抛出，因为您正在与第二个线程的表单进行交互。

要解决您所拥有的问题，请查看表单上的 Invoke 或 BeginInvoke 方法——它们允许您传递将在表单线程上执行的委托（这称为“编组”）

更好：与其进入一段时间然后睡觉，不如使用计时器。如果您在 Windows 窗体命名空间中使用计时器，它将为您处理编组问题，因此您甚至不需要使用 Invoke

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:12:26.717

您需要将修改同步到表单的[`SynchronizationContext`](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx).

修改位于与 UI 线程不同的线程中 - 因此是跨线程异常。

```
// get a reference to the form's sync-context
SynchronizationContext _sync = SynchronizationContext.Current;

_sync.Send((state) => {
  // code to modify UI objects
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:12:37.183

```
this.Invoke((MethodInvoker) delegate {
    this.Left = rnd;
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T15:13:00.740

发生错误是因为 UI 组件必须在创建它们的同一线程上进行操作。您的后台工作人员在不同的线程中运行。

您可以使用`InvokeRequired`和回调来让 UI 线程完成工作。

```
public void NudgeMe() {
    if( this.InvokeRequired ) {
        Action callBack = NudgeMe;
        this.Invoke( callBack );
    } else {

        int xCoord = this.Left;
        int yCoord = this.Top;

        int rnd = 0;

        Random RandomClass = new Random();

        for( int i = 0; i <= 500; i++ ) {
            rnd = RandomClass.Next( xCoord + 1, xCoord + 15 );
            this.Left = rnd;
            rnd = RandomClass.Next( yCoord + 1, yCoord + 15 );
            this.Top = rnd;
        }
        this.Left = xCoord;
        this.Top = yCoord;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T15:12:21.940

从后台线程更改 UI 线程是一个很大的禁忌。您可以删除直接从后台工作人员访问 UI 的代码，或者看看这个问题......

[如何从 C# 中的另一个线程更新 GUI？](https://stackoverflow.com/questions/661561/how-to-update-gui-from-another-thread-in-c)

# ruby - 如何在 Ruby 中动态扩展/修改继承类的所有方法？

> ID：11867562
> 
> 赞同：3
> 
> 时间：2012-08-08T15:08:50.393
> 
> 标签：ruby

我有这样的课：

```
class MainClass
  def self.method_one(String)
      puts "#{self.class} a"
  end
  def self.method_two(String)
      puts "#{self.class} a"
  end
end 
```

我有一个继承的类`MainClass`：

```
class NewClass < MainClass
  #any_mathod should match any method that is called for NewClass call
  def self.any_method(a,b)
     puts "#{self.class} b"
     super(a)
  end
end 
```

有什么方法可以从`MainClass`运行它们时扩展所有方法`NewClass`而不重新定义它们`NewClass`以接受两个参数而不是一个参数，例如：

```
NewClass.method_one(String1, String2) 
```

它会产生：

```
#=> NewClass String2
#=> MainClass String1 
```

并在类内处理`String1`参数。`NewClass`对于所有方法，附加参数的处理器都是相同的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:32:07.103

也许你想要`super`方法

```
class A
  def self.method_one(a)
    puts "a is #{a}"
  end
end

class B < A
  (superclass.methods - superclass.superclass.methods).each do |m|
    define_singleton_method(m) do |a, b|
      puts "b is #{b}"
      super(a)
    end
  end
end

B.method_one(5, 10)

# => b is 10
# => a is 5 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:48:10.030

试试这个：

```
class MainClass
    def self.method_one(string)
        puts string
    end
    def self.method_two(string)
        puts string
    end
end

class NewClass < MainClass
    #Iterate through all methods specific to MainClass and redefine
    (self.superclass.public_methods - Object.public_methods).each do |method|
        define_singleton_method method do |string1, string2|
            #Common processing for String1
            puts string1 

            #Call the MainClass method to process String2
            super(string2)
        end
    end
end 
```

NewClass 将遍历 MainClass 中专门定义的所有方法。然后它将为NewClass定义一个处理String1的类方法，然后调用MainClass方法来处理String2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:20:26.293

另一种方法是放弃继承并改用模块：

```
module TestModule
  def awesome1
  end
  def awesome2
  end
end

class TestClass
  def self.include mod
    puts (mod.instance_methods - Module.methods).sort
    super
  end
  include TestModule
end 
```

在覆盖的#include 中添加单例方法，如上述答案中所示。

# php - 使用 PHP 进行图像分类

> ID：11867563
> 
> 赞同：0
> 
> 时间：2012-08-08T15:08:52.423
> 
> 标签：php, web

我正在用 PHP 建立一个网站来分享我的漫画。我想实现分类以允许人们过滤他们想看的漫画。

该架构是围绕文件系统构建的，而不是数据库。

我一直在考虑两种方法来做到这一点：

1) 传入用户选择的类别，相应地更改图像路径。这是否需要用户会话/日志记录，IE 更复杂？

2）创建一个新的“漫画类别”页面模板。因此，与其传入用户选择的类别和过滤图像，不如将用户带到仅显示那些选定图像的新页面模板。

对此有什么想法吗？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:12:06.843

就实现您的目标而言，这两种选择都是可行的。但是，第一个选项更精简，因为您不需要为每个漫画类别实现模板。相反，您只需要创建一个页面并解析一个`GET`参数来确定漫画类型。它并不复杂，因为您不需要使用此过程存储用户会话。

例如：

```
<?php
    $category = $_GET['c'];

    switch ($category) {
        case 'action':
            // handle action comics here
            break;
        case 'romance':
            // handle romance comics here
            break;
        case 'horror':
            // handle horror comics here
            break;
        default:
            // handle 404 here
    }
?> 
```

事实上，如果您将其实现为简单的字符串操作，`$category`在需要调整图像路径的位置插入，则此过程可能会变得更加简单。

# opencv - 立体网络摄像头的机械校准和微调

> ID：11867573
> 
> 赞同：0
> 
> 时间：2012-08-08T15:09:09.453
> 
> 标签：opencv, camera-calibration, stereoscopy

有很多关于立体（计算机）视觉的读物。从这些阅读中得到的最值得注意的信息是，你几乎被 OpenCV 困住了……这绝对不是一件坏事。

大多数文章都是关于通过 OpenCV 功能进行校准以补偿劣质/便宜的镜头。

现在我更关心相机在其背板上定位的机械校准。您只能通过校准来补偿这么多，这就是为什么我希望我的相机定位接近完美。

我将 2 个罗技 9000 拧在相距约 10 厘米的铝背板上。我的目标是在 2-40 米范围内做一些深度感知。

我将如何检查相机的相对位置是否正确？我正在考虑将相机指向很远的距离（> 500m）并确保相机的中心（像素）正在查看相同的（部分）场景。这够了吗？我是否还应该注意角落显示的内容，还是稍后通过镜头校准完成？

另外，在一个有点相关的注释上：最终我需要绘制一个视差图。OpenCV 上有无数使用“快速”和“慢速”算法的指南。我将实时使用“快速”，它需要使用大量参数进行微调。这是相机类型/镜头的一次性调整，还是我应该为每个（新）场景都这样做？在后者的情况下，它会使我的立体相机在实践中变得不那么有用。

# silverlight - 如何在 PhoneGap 应用程序中使用 Microsoft 的推送通知服务？

> ID：11867577
> 
> 赞同：1
> 
> 时间：2012-08-08T15:09:12.830
> 
> 标签：silverlight, windows-phone-7, jquery-mobile, cordova

我正在开发一个需要向 Microsoft 推送通知服务注册的 PhoneGap 应用程序（适用于 WP7）。我似乎找不到任何适用于 WP7 的插件，例如适用于 Android / iOS 的插件。

是否可以在 App.xaml.cs 中创建 HttpNotificationChannel 对象和事件侦听器，并在收到通知时以某种方式提醒 JavaScript 代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T03:41:53.163

对 PhoneGap 构建的推送通知插件支持已经承诺了一年多。您可以从 2011 年开始查看：http: [//blogs.msdn.com/b/glengordon/archive/2011/11/15/phonegap-on-windows-phone-tips.aspx](http://blogs.msdn.com/b/glengordon/archive/2011/11/15/phonegap-on-windows-phone-tips.aspx)

三个月前在 Phonegap 社区中，它仍然被描述为将来会支持的东西。我一直在查看发行说明，但没有发现任何提及此功能： http: [//community.phonegap.com/nitobi/topics/_phonegap_build_future_plugin_support ?page=1](http://community.phonegap.com/nitobi/topics/_phonegap_build_future_plugin_support?page=1)

所以不幸的是它仍然不支持推送通知。

# eclipse - Eclipse 更新站点冻结

> ID：11867585
> 
> 赞同：0
> 
> 时间：2012-08-08T15:09:42.367
> 
> 标签：eclipse, ubuntu

我正在尝试使用更新站点安装 Aptana 插件。问题是它在“计算需求和依赖关系”中冻结。我检查了eclipse中的错误日志，什么也没有。

*   Eclipse Java EE x64
*   Ubuntu 12.04 x64

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:46:57.080

检查您的代理设置是否正确。看看**[这个](https://stackoverflow.com/a/11849102/325742)**答案。我在想如果您的 Eclipse 无法连接到互联网，插件安装可能会冻结。如果您打开 Eclipse 的内部浏览器，您可以浏览网站吗？

**有时，插件安装对我来说已经挂起，并且在取消选中**喜欢的选项后我已经能够通过`Contact all update sites`：

![在此处输入图像描述](../Images/43f7b67386a23759da8b5fabe5d85445.png)

另外，查看错误日志，看看当 Eclipse 冻结时是否有任何错误。Eclipse 错误日志位于`WORKSPACE_HOME/.metadata/.log`

# javascript - 试图从 twitter 的搜索结果中获取 url 值

> ID：11867587
> 
> 赞同：0
> 
> 时间：2012-08-08T15:09:44.623
> 
> 标签：javascript, twitter, getjson

我正在尝试从 twitter 的搜索结果中获取 url，但在数组中未定义。有谁知道为什么没有得到网址？

```
 function get(){
    var array=[];
        $.getJSON("http://search.twitter.com/search.json?q=euronews&rpp=5&
        include_entities=true&result_type=mixed&callback=?",
      function(data){
   $.each(data.results, function(i, item){
      var user=item.from_user;
      var user_id=item.from_user_id;
      var date=item.created_at;
      var profile_img=item.profile_image_url;
      var url=item.entities.urls[0].url;
    create_array(user,user_id,date,profile_img,url);
     });

    function create_array(a,b,c,d,e){
         array.push({user:a,user_id:b,date:c,profile_img:d,url:e});

                    }console.log(array);
}); 
} 
```

这是我从 twitter 搜索结果中获得的 json 文件的结构： [http ://search.twitter.com/search.json?q=euronews&rpp=5&include_entities=true&result_type=mixed](http://search.twitter.com/search.json?q=euronews&rpp=5&include_entities=true&result_type=mixed)

干杯:))

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:16:15.020

你得到的原因`undefined`是因为 item.entities.urls 是一个数组。事实证明，并非所有结果都具有数组。这应该适合你：

```
var array = [];

$.getJSON("http://search.twitter.com/search.json?q=euronews&rpp=5&include_entities=true&result_type=mixed&callback=?",
    function(data){
        $.each(data.results, function(i, item){
            array.push({
                user: item.from_user,
                user_id: item.from_user_id,
                date: item.created_at,
                profile_img: item.profile_image_url,
                url: (item.entities.urls.length > 0 ? item.entities.urls[0].url : '')
            });
        });
        console.log(array);
    }
); 
```

# excel - 使用 VBA 在 Excel 中保存状态和防止状态重新启动

> ID：11867588
> 
> 赞同：4
> 
> 时间：2012-08-08T15:09:46.893
> 
> 标签：excel, vba

当我的项目启动时，Workbook_Open 事件会初始化几个结构并实例化变量。在运行状态期间，用户可以更改这些变量和结构的值。

当用户关闭项目时，我想以某种方式保存这些变量的值（保存当前状态），以便用户可以重新打开项目并在关闭前从上次保存的状态运行。

在这个阶段，即使保存了excel，当重新打开项目时，变量和结构也会因为Workbook_Open事件而被重置。

**更新**

我已经研究过使用隐藏工作表并将值保存到单元格，但我不知道这对我的数据是否真的可行。

我要保存的数据是对象的字典。这些对象又可能包含其他对象是单值数据。如果我选择使用隐藏表，我将不得不将每个数据值保存在一个单元格中，如果我想保留字典中项目的顺序，这将是繁琐的写入和读取。

我想知道是否有一种方法可以将数据导出以永久存储到磁盘上，以及一种将数据导回的方法？请让我知道替代方法或我的理解是否不足。

**更新 2**

XML 能否为我提供一个可行的解决方案？[将我的集合和对象写入磁盘并稍后重新导入它们的最佳策略是什么？](https://stackoverflow.com/questions/5235465/what-is-the-best-strategy-for-writing-my-collections-and-objects-to-disk-and-rei)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:42:48.213

您必须决定持久性策略。我在不同情况下使用了隐藏工作簿、SQL 连接、.ini 文件甚至是纯文本文件。然后在 Workbook_Open 中，您必须将最后保存的数据加载到所有变量/结构中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:50:56.887

就像我在评论中提到的那样，您可以将变量存储在隐藏的工作表中。请参阅此示例。我将变量存储在 Sheets("Temp") 中。根据代码中的适用更改

在本工作簿中

```
Private Sub Workbook_BeforeClose(Cancel As Boolean)
    Sheets("Temp").Range("A1").Value = MyVariable
End Sub

Private Sub Workbook_Open()
    MyVariable = Sheets("Temp").Range("A1").Value
    MsgBox MyVariable
End Sub 
```

在一个模块中

```
Public MyVariable As Long

'~~> Some operation that you do with the variable
Sub Sample()
    MyVariable = MyVariable + 1
End Sub 
```

现在每次打开工作簿时，您的变量都会设置为最后一个值。

# ios - Netsuite 有 RESTful API 吗？

> ID：11867589
> 
> 赞同：10
> 
> 时间：2012-08-08T15:09:50.537
> 
> 标签：ios, rest, netsuite

我想做一个与[Netsuite](http://netsuite.com)集成的 iOS 应用程序，它应该通过 RESTful API 完成，但我在他们的网站、互联网上甚至通过与他们的代表交谈都找不到足够清晰的东西。有谁知道周围是否有任何文件？谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-08T15:36:55.317

您可以使用称为 RESTlet 的 SuiteScript 类型之一从移动应用程序与 NetSuite 交互。文档位于[帮助部分](https://system.netsuite.com/help/helpcenter/en_US/PDF/RESTletGuide.pdf)，因此您需要登录。用户组[社区](https://usergroup.netsuite.com/users/index.php)也很活跃，对 RESTlet 问题很有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-12T15:04:22.487

我正在为我的 NetSuite 集成应用程序使用一个 API，由 Halosys ( [http://halosys.com/new-video-mobile-apps-for-netsuite.html](http://halosys.com/new-video-mobile-apps-for-netsuite.html) ) 提供。

该 API 与 NetSuite 和其他系统集成，并为移动应用程序提供 RESTful 服务。当我启动我的 Android 应用程序时更多，但总体上对简化的 API 和通知等感到满意。

还有更多的公司提供类似的 API 服务，通常称为移动后端即服务，但重要的是你要寻找那些专注于企业而不是消费者应用程序的公司。

哈克移动

# c - 指向 pthread_create() 的最后一个参数的指针的指针导致崩溃

> ID：11867591
> 
> 赞同：0
> 
> 时间：2012-08-08T15:09:54.920
> 
> 标签：c, pthreads

刚刚遇到一个关于如何将第四个参数传递给 pthread_create() 的奇怪问题。

原来，我写的代码如下：

```
auditLogEntry *newEntry = NULL;

// malloc and init the memory for newEntry
rc = audit_init_log_entry(&newEntry);
// wrapper of 'goto cleanup'
ERR_IF( rc != 0 );
...
rc2 = pthread_attr_init(&attr);
ERR_IF( rc2 != 0 );
rc2 = pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_DETACHED);
ERR_IF( rc2 != 0 );
rc2 = pthread_create(&syslog_thread, &attr, syslog_thread_handler, (void *)newEntry);
ERR_IF( rc2 != 0 );
newEntry = NULL;
...
cleanup:
pthread_attr_destroy(&attr);
if (newEntry != NULL)
{
    audit_free_log_entry(newEntry);
    newEntry = NULL;
}

static void *syslog_thread_handler(void *t)
{
    auditLogEntry *entry = (auditLogEntry *)t;
    ... // code using entry
    cleanup:
    audit_free_log_entry(entry);

    pthread_exit(0);
} 
```

一切正常。

然后，我做了一个改变：

```
rc2 = pthread_create(&syslog_thread, &attr, syslog_thread_handler, (void *)&newEntry);
ERR_IF( rc2 != 0 );
...
cleanup:
pthread_attr_destroy(&attr);
if (rc != 0 && newEntry != NULL)
{
    audit_free_log_entry(newEntry);
    newEntry = NULL;
}

static void *syslog_thread_handler(void *t)
{
    auditLogEntry **entry = (auditLogEntry **)t;
    ... // code using *entry
    cleanup:
    audit_free_log_entry(*entry);
    *entry = NULL;

    pthread_exit(0);
} 
```

在上述更改之后，线程处理程序将使用 *entry 来访问日志条目数据。但它没有用。更糟糕的是，进程核心被转储了。

我尝试了“man pthread_create”，但没有特别提到应该如何将最后一个参数传递给它。

我这里有什么错吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T21:48:15.790

您没有显示完整的代码，因此很难判断发生了什么。

但是，`&newEntry`为您提供了指向堆栈上变量的指针。如果`newEntry`超出范围，例如因为您的函数结束，您的另一个线程现在有一个无效的指针 - 指向堆栈上现在已经消失的位置。并且取消引用这样的指针会导致未定义的行为。

```
int *foo(void) 
{
   int x = 2;
   return &x;
}

void bar(void)
{
   int *x = foo();
   printf("%d\n", *x); //can't do this, x points to something
                       //on the stack in the foo function, 
                       //which isn't valid any more
} 
```

如果将 foo() 函数传递`&x`给它创建的线程，您将遇到同样的问题。

```
void foo(void) 
{
   int x = 2;
  ...
  pthread_create(&tid, bar, NULL, &x);
} 
```

void *bar(void *arg) { int *x = arg;

```
 printf("%d\n", *x); //same problem here, x points to something
                       //on the stack in the foo function, which isn't valid 
                       //if the foo function ends. This concept is exactly the same
                       //if x had been a pointer inside the foo() function.
} 
```

这可能是您的情况：

```
int globalx = 2; //global variable
void foo(void) 
{
  int *x = malloc(sizeof(int));
  ...

  pthread_create(&tid, bar, NULL, &x); //we're still taking the address of 
                                       //a local variable. 
}

void *bar(void *arg) 
{
   int **x = arg;
   printf("%p\n", *x); //still the same problem here, x points to something
                       //on the stack in the foo function, which isn't valid 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T21:43:00.593

无论核心转储来自何处，都不是来自 pthreads。你对最后一个论点所做的事情绝对没问题。

# java - Java：正则表达式模式不起作用

> ID：11867593
> 
> 赞同：0
> 
> 时间：2012-08-08T15:09:56.700
> 
> 标签：java, regex

我有一个我正在解析的文件，它总是包含一个电子邮件地址。该文件当前布局在 之前有一个前导空格`@`，我们要捕获域。

```
foo @bar.com more data here
foo @foo.com more data here 
```

我们想退出`@bar.com`，`@foo.com`而我刚刚开始使用正则表达式。我正在尝试*在单词边界的开头提取模式“@”，包括所有后续字符，直到下一个单词边界*“。

我已经尝试了以下的各种迭代，将事物分组，文字的方形后援`@`......但似乎没有任何效果。

编辑 - 实际代码：

```
import java.util.regex.*;
import java.io.*;
import java.nio.file.*;
import java.lang.*;
//
public class eadd
{
    public static void main(String args[])
    {
        String inputLine = "foo foofoo foo foo @bar.com foofoofoo foo foo foo";
        String eDomain = "";
       // parse eadd
        Pattern p2 = Pattern.compile("(\\b@.*\\b)");
        Matcher m2 = p2.matcher(inputLine);
            if(m2.matches()) {
                eDomain = m2.group(1);
                } else {
                eDomain = "n/a";
            }
        System.out.println(p2+" "+m2+" "+eDomain);
    }
} 
```

以及我运行它时的结果。

```
(\b@.*\b) java.util.regex.Matcher[pattern=(\b@.*\b) region=0,49 lastmatch=] n/a 
```

我的所有问题都与`@`被搜索为文字而不是模式之后的内容有关（例如，寻找`.*`而不是`any and all characters`）。我找不到`@`作为控制角色的参考资料，所以我认为我不需要逃跑。

Oracle的java教程或文档中没有类似的例子，SO，也没有我查过的任何在线资源；我一直无法找到人们如何处理这个问题的其他样本。就像我说的，我对正则表达式相当陌生，但这在我看来应该对我有用。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:14:02.050

```
Pattern p = Pattern.compile("(@(?:[a-z][A-Z0-9_]+)\\.(?:[a-z][A-Z]+))"); 
```

这应该适合你。

这个正则表达式开始寻找 @ 。之后，它会查找后跟“.”的任何单词，然后是另一个单词。为了熟悉语法，您可以看一下[这个](http://en.wikipedia.org/wiki/Regular_expression)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:23:14.997

Java 不会将`@`其视为单词字符 - 因此地址开头没有单词边界。您可以用简单的空格匹配替换单词边界：

```
"\s(@.+?)\b" 
```

（或者`"\\s(@.+?)\\b"`因为这是Java）应该可以解决问题。它查找后面的空格`@`并匹配直到下一个单词边界。

编辑：哎呀，`.`就像 一样`@`，不是单词字符（duh）。利用

```
"\\s(@.+?)(?:\\s|$)" 
```

匹配直到下一个空格或 EOF。`(?:\\s|$)`是一个非捕获组，它将匹配任何空格或输入结尾。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:21:32.767

试试这个：`Pattern p = Pattern.compile("(?<=\\s)(@(?:bar|foo)\\.com\\b)");`
或通用模式： `"(?<=\\s)(@\\w+(?:\\.\\w+)+\\b)"`

说明：
`(?<=\\s)`：在后面寻找匹配的前导空格`@`
`\\w`：匹配字母、数字、下划线
`\\b`：单词边界
`@\\w+(?:\\.\\w+)+`：匹配`@bar.com`, `@bar.com.au`, `@bar.com.xyz`,`@bar.foo.xx.yy.zz`

# jquery - 有人可以指出我在做什么错 jquery - 移动列表项

> ID：11867597
> 
> 赞同：0
> 
> 时间：2012-08-08T15:10:02.267
> 
> 标签：jquery, listbox, append

列表项没有从一个列表框移动到另一个。我尝试使用 firefox 调试脚本，但它从未进入 button.click 内部。我不确定我做错了什么。谢谢你的帮助。

我有一个母版页：然后我有一个内容页面，我在其中添加了：

```
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
      <script src="../Scripts/jquery-1.4.1.js" type="text/javascript"></script>
    <script src="../Scripts/UiEffect/dragdrop.js" type="text/javascript"></script>   
</asp:Content> 
```

这是我在内容页面 HTML 中的 html：List box item I am getting from DB using Databind()

```
<div class="question">

       <asp:ListBox ID="Allitem" runat="server" Rows="7" Width="200px" ></asp:ListBox>

        <input id="ibtnLeft" type="image"  src="../Images/LeftArrow.png" />
        <input id="ibtnRight" type="image" src="../Images/rightArrow.png" />
       <asp:ListBox ID="selectedItem" runat="server" Rows="7" Width="200px"></asp:ListBox>
    </div> 
```

这是我对 dragdrop.js 外部文件的 j-query：

```
$("#ibtnRight").click(function ($e) {
    $("select[id$='Allitem'] option:selected").appendTo($("select[id$='selectedItem']"));
    $("select[id$='Allitem'] option:selected").remove(); $e.preventDefault();
});

$("#ibtnLeft").click(function ($e) {
    $("select[id$='selectedItem'] option:selected").appendTo($("select[id$='Allitem']"));
    $("select[id$='selectedItem'] option:selected").remove(); $e.preventDefault();
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:22:07.230

'dragdrop.js' 中的代码需要在 DOM 加载后运行，否则选择器可能会错过尚未创建的目标。

```
$(document).ready(function(){
  // run initializing code here
}); 
```

同样正如@Chris 指出的那样，id 可能不会像您想象的那样呈现。在这种情况下，您可以在页面本身的脚本标记中使用内联动态 javascript：

```
<script type="text/javascript">
  $(document).ready(function(){
    $('#<%= Allitem.ClientID %>').doSomething();
  });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:25:36.467

我听说 ASP.NET 有时会在您实际运行代码时更改 ID，您确定通过 JQuery 定位的 ID 与代码中定义的 ID 相同。作为旁注，为什么不移动 ASP.NET MVC。

# asp.net - 基于控件可见性的自定义验证器

> ID：11867600
> 
> 赞同：0
> 
> 时间：2012-08-08T15:10:08.147
> 
> 标签：asp.net, validation

我有自定义验证器代码

```
<asp:CustomValidator ID="ddl1" ClientValidationFunction="IscontrolVisible" ControlToValidate="ddl1"
                            runat="server" ValidationGroup="ValSummary" Display="Dynamic" ErrorMessage="drop down invisible">*</asp:CustomValidator> 
```

下面是功能

```
 function IscontrolVisible(source, arguments) {
        //if ((document.getElementById(source).visibility == "visible")) {
        debugger;
        if (arguments.value == "" || arguments.value == "Select...") {
            arguments.IsValid = false;
        }
        else {
            arguments.IsValid = true;
        }
    } 
```

如何根据控件的可见性获取错误消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:25:19.957

使用该`source.controltovalidate`属性来获取正在验证的控件的 ID，因此`document.getElementById(source.controltovalidate)`请在您的代码中使用。

**但是，如果**您直接设置控件本身的可见**性**，您将只能检测您正在验证的控件是否可见。

在这种情况下，您可以执行以下操作之一...

```
if (document.getElementById(source.controltovalidate).style.visibility !== "false") {
if (document.getElementById(source.controltovalidate).style.display !== "none") { 
```

如果控件由于其中一个父控件而不可见，则它不会继承`visibility`or的 CSS 样式`display`。在这种情况下，您必须递归检查相关控件的所有祖先。

**额外的**

如果您想更改 ErrorMessage 文本（请注意，这只会在浏览器上本地更改，并且不会在回发后复制回服务器上），那么以下内容应该适用于验证摘要消息框弹出和列表/项目符号...

```
source.errormessage = "New Error Message"; 
```

当显示为验证器本身的一部分时，以下内容应该适用于消息......

```
source.innerHTML = "New Error Message"; 
```

# jpa - 注释 jpa 休眠

> ID：11867603
> 
> 赞同：-2
> 
> 时间：2012-08-08T15:10:11.393
> 
> 标签：jpa

在我的类 request.java 我有属性 logo

logo 是将记录在 mysql 数据库中的图像

我正在寻找注解所需的属性标志

我尝试

```
@ Lob
private String logo; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T09:31:50.833

很可能您不想使用字符数据类型保留图像。

对于`BLOB`数据库中的类型`byte[]`是正确的 Java 类型：

```
@Lob
private byte[] logo; 
```

# linux - 将文件从给定的“x”（开始）偏移量复制到给定的“y”（结束）偏移量的工具

> ID：11867608
> 
> 赞同：8
> 
> 时间：2012-08-08T15:10:25.247
> 
> 标签：linux, unix

是否有任何工具可以将文件从给定的起始偏移量复制到给定的（结束）偏移量。我还想通过运行 md5sum 来确认该工具是否正确复制了指定的字节。像这样的东西

```
 1) Copy source file starting from 100 byte till 250th byte
        $cp /path/to/source/file /path/to/dest/file -s 100 -e 250

   2) Create md5sum of the source file starting from 100byte till 250th byte
        $md5sum /path/of/src/file -s 100 -e 250
         xxxxxx-xxxxx-xxxxx-xxxx-xx

   3) Confirm that destination file created from step 1 is right by comparing the md5sum generated from step 2.
        $md5sum /path/of/dest/file
         xxxxxx-xxxxx-xxxxx-xxxx-xx 
```

我知道 md5sum 没有 -s 和 -e 的选项，但我想通过给定源文件和目标文件的一些工具来确认。提前致谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-08T15:20:45.970

对于 1) 你可以使用`dd`：

```
# dd if=/path/to/source/file of=/path/to/destination/file bs=1 skip=100 count=250 
```

对于 2) 我不确定这是否可以通过标准工具实现。

[编辑]

啊哈，找到了一个方法：

对于 2)

```
# dd if=/path/to/source/file bs=1 skip=100 count=250 | md5sum 
```

对于 3)

```
md5sum /path/to/destination/file 
```

# python - (Z3Py) 检查方程的所有解

> ID：11867611
> 
> 赞同：22
> 
> 时间：2012-08-08T15:10:28.453
> 
> 标签：python, z3, z3py

在 Z3Py 中，如何检查给定约束的方程是否只有一个解？

如果有多个解决方案，我该如何列举它们？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-08T16:53:07.577

您可以通过添加一个阻止 Z3 返回的模型的新约束来做到这一点。例如，假设在 Z3 返回的模型中，我们有`x = 0`和`y = 1`。然后，我们可以通过添加约束来阻止这个模型`Or(x != 0, y != 1)`。以下脚本可以解决问题。您可以在线尝试：[http ://rise4fun.com/Z3Py/4blB](http://rise4fun.com/Z3Py/4blB)

请注意，以下脚本有一些限制。输入公式不能包含未解释的函数、数组或未解释的排序。

```
from z3 import *

# Return the first "M" models of formula list of formulas F 
def get_models(F, M):
    result = []
    s = Solver()
    s.add(F)
    while len(result) < M and s.check() == sat:
        m = s.model()
        result.append(m)
        # Create a new constraint the blocks the current model
        block = []
        for d in m:
            # d is a declaration
            if d.arity() > 0:
                raise Z3Exception("uninterpreted functions are not supported")
            # create a constant from declaration
            c = d()
            if is_array(c) or c.sort().kind() == Z3_UNINTERPRETED_SORT:
                raise Z3Exception("arrays and uninterpreted sorts are not supported")
            block.append(c != m[d])
        s.add(Or(block))
    return result

# Return True if F has exactly one model.
def exactly_one_model(F):
    return len(get_models(F, 2)) == 1

x, y = Ints('x y')
s = Solver()
F = [x >= 0, x <= 1, y >= 0, y <= 2, y == 2*x]
print get_models(F, 10)
print exactly_one_model(F)
print exactly_one_model([x >= 0, x <= 1, y >= 0, y <= 2, 2*y == x])

# Demonstrate unsupported features
try:
    a = Array('a', IntSort(), IntSort())
    b = Array('b', IntSort(), IntSort())
    print get_models(a==b, 10)
except Z3Exception as ex:
    print "Error: ", ex

try:
    f = Function('f', IntSort(), IntSort())
    print get_models(f(x) == x, 10)
except Z3Exception as ex:
    print "Error: ", ex 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-09-30T14:52:29.250

下面的 python 函数是包含常量和函数的公式的模型生成器。

```
import itertools
from z3 import *

def models(formula, max=10):
    " a generator of up to max models "
    solver = Solver()
    solver.add(formula)

    count = 0
    while count<max or max==0:
        count += 1

        if solver.check() == sat:
            model = solver.model()
            yield model

            # exclude this model
            block = []
            for z3_decl in model: # FuncDeclRef
                arg_domains = []
                for i in range(z3_decl.arity()):
                    domain, arg_domain = z3_decl.domain(i), []
                    for j in range(domain.num_constructors()):
                        arg_domain.append( domain.constructor(j) () )
                    arg_domains.append(arg_domain)
                for args in itertools.product(*arg_domains):
                    block.append(z3_decl(*args) != model.eval(z3_decl(*args)))
            solver.add(Or(block))

x, y = Ints('x y')
F = [x >= 0, x <= 1, y >= 0, y <= 2, y == 2*x]
for m in models(F):
    print(m) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-03-10T11:33:13.600

参考[http://theory.stanford.edu/~nikolaj/programmingz3.html#sec-blocking-evaluations](http://theory.stanford.edu/%7Enikolaj/programmingz3.html#sec-blocking-evaluations)

```
def all_smt(s, initial_terms):
    def block_term(s, m, t):
        s.add(t != m.eval(t))
    def fix_term(s, m, t):
        s.add(t == m.eval(t))
    def all_smt_rec(terms):
        if sat == s.check():
           m = s.model()
           yield m
           for i in range(len(terms)):
               s.push()
               block_term(s, m, terms[i])
               for j in range(i):
                   fix_term(s, m, terms[j])
               yield from all_smt_rec(terms[i:])
               s.pop()   
    yield from all_smt_rec(list(initial_terms)) 
```

从莱昂纳多自己的答案来看，这确实表现得更好（考虑到他的答案已经很老了）

```
start_time = time.time()
v = [BitVec(f'v{i}',3) for i in range(6)]
models = get_models([Sum(v)==0],8**5)
print(time.time()-start_time)
#211.6482105255127s 
```

```
start_time = time.time()
s = Solver()
v = [BitVec(f'v{i}',3) for i in range(6)]
s.add(Sum(v)==0)
models = list(all_smt(s,v))
print(time.time()-start_time)
#13.375828742980957s 
```

据我观察，将搜索空间拆分为不相交的模型会产生巨大的差异

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-01-10T17:40:23.970

Himanshu Sheoran 给出的答案引用了论文[https://theory.stanford.edu/%7Enikolaj/programmingz3.html#sec-blocking-evaluations](https://theory.stanford.edu/%7Enikolaj/programmingz3.html#sec-blocking-evaluations)

不幸的是，当时论文中给出的实现中存在一个错误，该答案在该答案中被引用。该功能已得到纠正。

对于后代，这是代码的正确版本：

```
def all_smt(s, initial_terms):
    def block_term(s, m, t):
        s.add(t != m.eval(t, model_completion=True))
    def fix_term(s, m, t):
        s.add(t == m.eval(t, model_completion=True))
    def all_smt_rec(terms):
        if sat == s.check():
           m = s.model()
           yield m
           for i in range(len(terms)):
               s.push()
               block_term(s, m, terms[i])
               for j in range(i):
                   fix_term(s, m, terms[j])
               yield from all_smt_rec(terms[i:])
               s.pop()   
    yield from all_smt_rec(list(initial_terms)) 
```

# linux - 使用 SCSI 通用接口的 SCSI 读取 (10) 和写入 (10)

> ID：11867612
> 
> 赞同：6
> 
> 时间：2012-08-08T15:10:29.273
> 
> 标签：linux, linux-device-driver, scsi

我尝试向SSD发出 scsi [read(10)](http://en.wikipedia.org/wiki/SCSI_Read_Commands#Read_.2810.29)和[write(10) 。](http://en.wikipedia.org/wiki/SCSI_Write_Commands#Write_.2810.29)我[将此示例代码](http://tldp.org/HOWTO/SCSI-Generic-HOWTO/pexample.html)用作参考/基本代码。

这是我的 scsi 阅读：

```
#define READ_REPLY_LEN 32
#define READ_CMDLEN 10
void scsi_read()
{
  unsigned char Readbuffer[ SCSI_OFF + READ_REPLY_LEN ];
  unsigned char cmdblk [ READ_CMDLEN ] =
      {        0x28,  /* command */
                  0,  /* lun/reserved */
                  0,  /* lba */
                  0,  /* lba */
                  0,  /* lba */
                  0,  /* lba */
                  0,  /* reserved */
                  0,  /* transfer length */
     READ_REPLY_LEN,  /* transfer length */
                  0 };/* reserved/flag/link */
  memset(Readbuffer,0,sizeof(Readbuffer));
  memcpy( cmd + SCSI_OFF, cmdblk, sizeof(cmdblk) );

  /*
   * +------------------+
   * | struct sg_header | <- cmd
   * +------------------+
   * | copy of cmdblk   | <- cmd + SCSI_OFF
   * +------------------+
   */

  if (handle_scsi_cmd(sizeof(cmdblk), 0, cmd,
                      sizeof(Readbuffer) - SCSI_OFF, Readbuffer )) {
      fprintf( stderr, "read failed\n" );
      exit(2);
  }
  hex_dump(Readbuffer,sizeof(Readbuffer));
} 
```

这是我的 scsi 写的：

```
void scsi_write ( void )
{
  unsigned char Writebuffer[SCSI_OFF];
  unsigned char cmdblk [] =
      {        0x2A,  /* 0: command */
                  0,  /* 1: lun/reserved */
                  0,  /* 2: LBA */
                  0,  /* 3: LBA */
                  0,  /* 4: LBA */
                  0,  /* 5: LBA */
                  0,  /* 6: reserved */
                  0,  /* 7: transfer length */
                  0,  /* 8: transfer length */
                  0 };/* 9: control */

  memset(Writebuffer,0,sizeof(Writebuffer));
  memcpy( cmd + SCSI_OFF, cmdblk, sizeof(cmdblk) );
  cmd[SCSI_OFF+sizeof(cmdblk)+0] = 'A';
  cmd[SCSI_OFF+sizeof(cmdblk)+1] = 'b';
  cmd[SCSI_OFF+sizeof(cmdblk)+2] = 'c';
  cmd[SCSI_OFF+sizeof(cmdblk)+3] = 'd';
  cmd[SCSI_OFF+sizeof(cmdblk)+4] = 'e';
  cmd[SCSI_OFF+sizeof(cmdblk)+5] = 'f';
  cmd[SCSI_OFF+sizeof(cmdblk)+6] = 'g';
  cmd[SCSI_OFF+sizeof(cmdblk)+7] = 0;
  /*
   * +------------------+
   * | struct sg_header | <- cmd
   * +------------------+
   * | copy of cmdblk   | <- cmd + SCSI_OFF
   * +------------------+
   * | data to write    | 
   * +------------------+
   */

  if (handle_scsi_cmd(sizeof(cmdblk), 8, cmd, 
                      sizeof(Writebuffer) - SCSI_OFF, Writebuffer )) {
      fprintf( stderr, "write failed\n" );
      exit(2);
  }
} 
```

在下面的例子中，我做

1.  scsi 读取
2.  SCSI写
3.  scsi 读取

我打印了写入数据的十六进制转储（scsi write）和读取的数据（scsi read）

```
Read(10)
[0000]   00 00 00 44 00 00 00 44   00 00 00 00 00 00 00 00   ...D...D ........
[0010]   00 2C 00 00 00 00 00 00   00 00 00 00 00 00 00 00   ........ ........
[0020]   00 00 00 00 00 00 00 00   00 00 00 00 00 00 00 00   ........ ........
[0030]   00 00 00 00 00 00 00 00   00 00 00 00 00 00 00 00   ........ ........
[0040]   00 00 00 00                                         ....

Write(10):
[0000]   00 00 00 00 00 00 00 24   00 00 00 00 00 00 00 00   ........ ........
[0010]   00 00 00 00 00 00 00 00   00 00 00 00 00 00 00 00   ........ ........
[0020]   00 00 00 00 2A 00 00 00   00 00 00 00 00 00 41 62   ........ ......Ab
[0030]   63 64 65 66 67 00                                   cdefg.

Read(10):
[0000]   00 00 00 44 00 00 00 44   00 00 00 00 00 00 00 00   ...D...D ........
[0010]   04 00 20 00 70 00 02 00   00 00 00 0A 00 00 00 00   ....p... ........
[0020]   04 00 00 00 41 62 63 64   65 66 67 00 00 00 00 00   ....Abcd efg.....
[0030]   00 00 00 00 00 00 00 00   00 00 00 00 00 00 00 00   ........ ........
[0040]   00 00 00 00                                         .... 
```

再次运行这三个命令后，我应该阅读`Abcdefg`第一次阅读。对？但是再次运行它们并没有改变。您现在可以假设，我使用的内存仍然具有来自先前函数的数据，但即使我在发生`memset(Readbuff,0,sizeof(Readbuff))`之前运行，我也会得到相同的结果`sys_read()`。

我假设，我尝试写入的 LBA 可能被禁止写入，我读取了缓存。但是从 0x00-0xFF 对 LBA 地址进行交互没有任何改变——这意味着，我读取了相同的数据 ( `Abcdefg`)。

您知道使用 scsi 通用接口进行 scsi 读取或写入的示例实现吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T14:35:50.110

在 SCSI 中，LBA 的单位和传输长度以块为单位，有时称为扇区。这几乎总是 512 字节。因此，您不能只读取或写入 32 个字节。至少，您必须执行 512 字节 == 一个块。这一点是您需要解决的大部分问题。

您的 scsi_write 实现中的传输长度为零，因此它实际上不会写入任何数据。

您应该为 CDB 和写入/读取数据使用不同的缓冲区。我怀疑对这些缓冲区的混淆导致您的实现写入超过您的一个静态分配数组的末尾并覆盖您的 ReadBuffer。[在valgrind](http://valgrind.org/docs/manual/quick-start.html)下运行它，看看会出现什么。

最后，handle_scsi_cmd 中的任何内容都可能出错。设置数据传输可能很棘手......特别是，请确保您直接了解数据在 I/O 标头的 dxfer_direction 中的传输方式：SG_DXFER_TO_DEV 用于写入，SG_DXFER_FROM_DEV 用于读取。

查看这个如何进行读取的示例（16）。这更符合您要完成的工作。

[https://github.com/hreinecke/sg3_utils/blob/master/examples/sg_simple16.c](https://github.com/hreinecke/sg3_utils/blob/master/examples/sg_simple16.c)

# android - 用于选择菜单项的 Android 命令行

> ID：11867615
> 
> 赞同：0
> 
> 时间：2012-08-08T15:10:40.997
> 
> 标签：android, command-line, adb

我有一个包含五个项目的菜单的活动。我想使用命令行单击其中一个。我可以通过“am start”命令打开活动，然后使用 keyevent 打开菜单。但在那之后，我无法找到从中选择项目的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:29:54.903

如果所需的菜单项具有焦点，则

```
adb shell /system/bin/sh /system/bin/input keyevent 23 
```

要不就

```
adb shell /system/bin/input keyevent 23 
```

应该管用。

那是[KeyEvent#KEYCODE_DPAD_CENTER](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.4_r1.2/android/view/KeyEvent.java#KeyEvent.0KEYCODE_DPAD_CENTER)，该链接中的其他键号也是如此。

# c#-4.0 - 循环通过 HtmlAgilityPack 创建的节点

> ID：11867619
> 
> 赞同：2
> 
> 时间：2012-08-08T15:10:56.217
> 
> 标签：c#-4.0, xpath, html-agility-pack

我需要使用 HtmlAgilityPack 和 C# 解析这个 html 代码。我可以获得 div class="patent_bibdata" 节点，但我不知道如何循环通过子节点。

在这个示例中有 6 个 href，但我需要将它们分成两组；发明家，分类。我对最后两个不感兴趣。此 div 中可以有任意数量的 href。

如您所见，在两组之前有一段文字说明了 href 是什么。

代码片段

```
HtmlWeb hw = new HtmlWeb();
HtmlDocument doc = m_hw.Load("http://www.google.com/patents/US3748943");
string xpath = "/html/body/table[@id='viewport_table']/tr/td[@id='viewport_td']/div[@class='vertical_module_list_row'][1]/div[@id='overview']/div[@id='overview_v']/table[@id='summarytable']/tr/td/div[@class='patent_bibdata']";
HtmlNode node = m_doc.DocumentNode.SelectSingleNode(xpath); 
```

那么你会怎么做呢？

```
<div class="patent_bibdata">
    <b>Inventors</b>:&nbsp;
    <a href="http://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22Ronald+T.+Lashley%22">
    Ronald T. Lashley
    </a>, 
    <a href="http://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22Ronald+T.+Lashley%22">
    Ronald T. Lashley
    </a><br>
    <b>Current U.S. Classification</b>:&nbsp;
    <a href="http://www.google.com/url?id=3eF8AAAAEBAJ&amp;q=http://www.uspto.gov/web/patents/classification/uspc084/defs084.htm&amp;usg=AFQjCNEZRFtAyKTfNudgc-XVt2-VboD77Q#C084S31200P">84/312.00P</a>;
    <a href="http://www.google.com/url?id=3eF8AAAAEBAJ&amp;q=http://www.uspto.gov/web/patents/classification/uspc084/defs084.htm&amp;usg=AFQjCNEZRFtAyKTfNudgc-XVt2-VboD77Q#C084S31200R">84/312.00R</a><br>
    <br>
    <a href="http://www.google.com/url?id=3eF8AAAAEBAJ&q=http://patft.uspto.gov/netacgi/nph-Parser%3FSect2%3DPTO1%26Sect2%3DHITOFF%26p%3D1%26u%3D/netahtml/PTO/search-bool.html%26r%3D1%26f%3DG%26l%3D50%26d%3DPALL%26RefSrch%3Dyes%26Query%3DPN/3748943&usg=AFQjCNGKUic_9BaMHWdCZtCghtG5SYog-A">
    View patent at USPTO</a><br>
    <a href="http://www.google.com/url?id=3eF8AAAAEBAJ&q=http://assignments.uspto.gov/assignments/q%3Fdb%3Dpat%26pat%3D3748943&usg=AFQjCNGbD7fvsJjOib3GgdU1gCXKiVjQsw">
    Search USPTO Assignment Database
    </a><br>
</div> 
```

想要的结果 InventorGroup =

```
<a href="http://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22Ronald+T.+Lashley%22">
    Ronald T. Lashley
    </a>
    <a href="http://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22Ronald+T.+Lashley%22">
    Thomas R. Lashley
    </a> 
```

分类组

```
<a href="http://www.google.com/url?id=3eF8AAAAEBAJ&amp;q=http://www.uspto.gov/web/patents/classification/uspc084/defs084.htm&amp;usg=AFQjCNEZRFtAyKTfNudgc-XVt2-VboD77Q#C084S31200P">84/312.00P</a>;
    <a href="http://www.google.com/url?id=3eF8AAAAEBAJ&amp;q=http://www.uspto.gov/web/patents/classification/uspc084/defs084.htm&amp;usg=AFQjCNEZRFtAyKTfNudgc-XVt2-VboD77Q#C084S31200R">84/312.00R</a> 
```

我试图抓取的页面：[http ://www.google.com/patents/US3748943](http://www.google.com/patents/US3748943)

// 安德斯

PS！我知道在这个页面中，发明者的名字是相同的，但在大多数情况下它们是不同的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T16:24:54.847

XPATH 是你的朋友！像这样的东西会给你发明者的名字：

```
HtmlWeb w = new HtmlWeb();
HtmlDocument doc = w.Load("http://www.google.com/patents/US3748943");
foreach (HtmlNode node in doc.DocumentNode.SelectNodes("//div[@class='patent_bibdata']/br[1]/preceding-sibling::a"))
{
    Console.WriteLine(node.InnerHtml);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T22:56:19.077

所以很明显我（还）不了解 XPath。所以我想出了这个解决方案。也许不是最聪明的解决方案，但它有效！

// 安德斯

```
List<string> inventorList = new List<string>();
List<string> classificationList = new List<string>();

string xpath = "/html/body/table[@id='viewport_table']/tr/td[@id='viewport_td']/div[@class='vertical_module_list_row'][1]/div[@id='overview']/div[@id='overview_v']/table[@id='summarytable']/tr/td/div[@class='patent_bibdata']";
HtmlNode nodes = m_doc.DocumentNode.SelectSingleNode(xpath);
bool bInventors = false;
bool bClassification = false;
for (int i = 0; i < nodes.ChildNodes.Count; i++)
{
    HtmlNode node = nodes.ChildNodes[i];
    string txt = node.InnerText;
    if (txt.IndexOf("Inventor") > -1)
    {
        bClassification = false;
        bInventors = true;
    }
    if (txt.IndexOf("Classification") > -1)
    {
        bClassification = true;
        bInventors = false;
    }
    if (txt.IndexOf("USPTO") > -1)
    {
        bClassification = false;
        bInventors = false;
    }
    string name = node.Name;
    if (name.IndexOf("a") > -1)
    {
        if (bInventors)
        {
            string inventor = node.InnerText;
            inventorList.Add(inventor);
        }
        if (bClassification)
        {
            string classification = node.InnerText;
            classificationList.Add(classification);
        }
    } 
```

# c# - 避免在数据库中插入任何空白行

> ID：11867620
> 
> 赞同：0
> 
> 时间：2012-08-08T15:10:58.110
> 
> 标签：c#, asp.net, database, visual-studio-2010

不久前，我发布了一个关于避免将空白行添加到数据库中的线程。在单击添加行之前，无论用户是否取消了新行，它都会自动将空白行添加到数据库中。我想通了，但现在遇到了一个新问题。如果用户决定在编辑新行时重新加载页面（F5），它将在数据库中添加一个空白行，这对我的情况来说是不行的。谁能帮我弄清楚如何避免这种情况？

下面是我的插入代码：

```
protected void gv_RowCommand(object sender, GridViewCommandEventArgs e)
    {

        if (e.CommandName == "Insert") //- this is needed to explain that the INSERT command will only work when INSERT is clicked
        {
            gv.DataBind();

            DataTable d = dbcon.GetDataTable("SELECT * FROM CIS.CIS_TRANS ORDER BY ID DESC", "ProjectCISConnectionString");

            string transCode = "", fundCode = "", BSA_CD = "", DP_TYPE = "";

            if (d.Rows.Count > 0)
            {
                transCode = d.Rows[0]["TRANS_CD"].ToString();
                fundCode = d.Rows[0]["FUND_CD"].ToString();
                BSA_CD = d.Rows[0]["BSA_CD"].ToString();
                DP_TYPE = d.Rows[0]["DP_TYPE"].ToString();

                if (transCode.Trim().Length > 0)
                {
                    dbcon.Execute("INSERT INTO CIS.CIS_TRANS (ID,TRANS_CD) VALUES(CIS.S_CIS_TRANS.nextval,'')", "ProjectCISConnectionString");

                    gv.DataBind();
                }
            }

            gv.EditIndex = gv.Rows.Count - 1;

        }
        else if (e.CommandName == "Cancel")
        {
            DataTable d = dbcon.GetDataTable("SELECT * FROM CIS.CIS_TRANS ORDER BY ID DESC", "ProjectCISConnectionString");

            string transCode = "";

            if (d.Rows.Count > 0)
            {
                transCode = d.Rows[0]["TRANS_CD"].ToString();

                if (transCode.Trim().Length == 0)
                {
                    dbcon.Execute(string.Format("DELETE CIS.CIS_TRANS WHERE ID = '{0}'", d.Rows[0]["ID"]), "ProjectCISConnectionString");

                    gv.DataBind();
                }
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:23:24.407

如果要避免用户插入空白行，则需要验证器。添加`RequiredFieldValidator`到插入模板：

```
<asp:RequiredFieldValidator runat="server" ID="valFieldName"
< ControlToValidate="txtFieldName" ErrorMessage="FieldName is missing" /> 
```

在您的方法中检查是否`Page.IsValid == true`在插入数据库之前。

编辑：如果你想完全避免回发，你可以将整个网格插入`UpdatePanel`：

```
<asp:UpdatePanel>
    <ContentTemplate>
        <asp:GrdiView>
        ....
        </asp:GridView>
    </ContentTemplate>
</asp:UpdatePanel> 
```

现在，当用户按 F5 时，他只是再次重新加载页面，而不是发回插入命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:39:32.153

似乎您试图在代码的一部分中引入过多的逻辑。您将数据库逻辑放入按钮命令中。想象一下用户只是向这个按钮发送垃圾邮件。这会导致大量的空行。

试试这个方法：划分你的数据库逻辑和你的 UI 逻辑（例如**MVVM**）。这是一种常见的模式，今天。

想象一下，您创建了所有对象，现在用户点击“保存”按钮（这也可能通过更改一行来实现 - 无论如何）。执行保存命令后，您的视图模型（视图背后的逻辑）可以验证您的数据。因此，您可以更轻松地扩展 UI 上的功能（例如：验证或类似的东西）。

如果你想用你当前的代码来做这件事，每次扩展都会把它炸得越来越大——而且维护这个代码不需要太多时间是可怕的。

在您的 VM 中的所有事情发生（验证等）之后，可能会发生进入数据库的事务命令（类似于 myEntities.Save()）。这种方法可以让您的业务对象正确地转换为 SQL 并存储在您的数据库中。

这只是对 MVVM 模式的一个非常简短的解释，但这对我来说似乎是唯一合适的解决方案。

# sql-server-2008 - 继续，我想知道为什么它会产生巨大的文件而不应该产生？

> ID：11867623
> 
> 赞同：0
> 
> 时间：2012-08-08T15:11:09.997
> 
> 标签：sql-server-2008, inner-join

[继续](https://stackoverflow.com/questions/11863643/how-do-i-return-two-columns-from-first-table-if-only-one-column-partially-matche/11863767#comment15785344_11863767)

```
select a.artno, a.name 
from Art a 
inner join store s on a.Artno <> s.Artno` 
```

运行这个查询花了我超过 1 分钟的时间，产生了更多的 899K 行，而本应产生 7.9K 的结果。

```
select artno 
from art 
except 
(select artno from store) 
```

这行代码为我提供了 7.9K 行，这对我来说是正确的。

第一个代码似乎是工作代码，但需要一些时间并产生大量结果集。想知道为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:12:52.210

`<>`除非你真的知道你想要很多记录，否则将运算符与 INNER JOIN一起使用通常不是一个好主意。换句话说，JOIN 是一个很好的包含而不是排除的工具。

当您使用`<>`运算符（特别是在键上）执行 INNER JOIN 时，查询会返回 和 的每个组合，`art`但键匹配`store`的位置除外。`Artno`

因此，如果您有 4`art`条记录和 5`store`条记录，其中只有一条具有匹配`ArtNo`值，那么您最终将得到 4 x 5 - 1 = 19 条记录。

第二个查询仅显示`art`不在任何存储中的所有记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:14:29.553

那么这两个查询是不同的。第一个查询是连接两个表的结果，虽然条件可能相同，但根据您的结果，它是两个表之间的一对多关系。

相比之下，第二个查询不是连接两个结果，而是从 ART 表中选择并排除您从另一个表提供的艺术编号。

最后，第二个查询花费更长的时间而不知道很多关于您的数据库的原因是一个猜测，但我会试一试。

第一个瓶颈是它连接两个显然不是一对一的表，但第二个瓶颈可能是索引或左侧表的大小。请记住，在像这样的 JOIN 中，左手表被扫描，理想情况下右手是搜索。

那有意义吗？

# ruby - 无法让 ffi-rzmq zeromq gem 在 Windows 上运行

> ID：11867625
> 
> 赞同：1
> 
> 时间：2012-08-08T15:11:20.660
> 
> 标签：ruby, zeromq, ffi

我无法让 ffi-rzmq gem 在 Windows 上工作。

我已经从这里安装了 ZeroMQ 2.2 的 Windows 安装程序： [http ://www.zeromq.org/distro:microsoft-windows](http://www.zeromq.org/distro:microsoft-windows)

我已将 C:\Program Files\ZeroMQ 2.2.0\bin 添加到我的 PATH 变量中。

然后我安装了 ffi 和 ffi-rzmq gems

```
gem install ffi
gem install ffi-rzmq 
```

但是当我启动一个 irb 并运行时：

```
require 'ffi-rzmq' 
```

我收到这条消息：

```
irb(main):001:0> require 'ffi-rzmq'
Unable to load this gem. The libzmq library (or DLL) could not be found.
If this is a Windows platform, make sure libzmq.dll is on the PATH.
For non-Windows platforms, make sure libzmq is located in this search path:
["C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/ffi-rzmq-0.9.3/lib/ffi-rz
mq/../../ext/libzmq.dll", "/usr/local/lib/libzmq.dll", "/opt/local/lib/libzmq.dl
l", "/usr/local/homebrew/lib/libzmq.dll", "/usr/lib64/libzmq.dll"] 
```

奇怪的是，Zero MQ安装程序似乎没有打包一个libzmq.dll，只有**libzmq-v100-mt.dll**

我确定我正在做一些非常明显的错误，但我看不出它是什么......有人可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T08:54:07.370

我已经设法解决了这个问题 - ffi-rzmq 给出的错误消息实际上在最新版本中有所改进。

Nathan 是对的，我必须将 libzmq-v100-mt.dll 重命名为 libzmq.dll，但这还不够——我使用的是 ZMQ 的 64 位编译版本，但由于某种原因 ffi-rzmq 与32位版本。

因此，一旦我卸载 64 位版本，安装 32 位版本，将 dll 重命名为 libzmq.dll 并调整路径以指向 zmq 的“c:\program files (x86)”版本，一切正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T05:31:36.927

您必须将 libzmq-v100-mt.dll 重命名为 libzmq.dll - 我不知道他们为什么决定让 Windows 构建输出不同的库名称。

我遇到了同样的问题，一旦我重命名文件 zeromq 就开始正常工作。

（好吧，从技术上讲，我必须先修复我的代码，但然后 zeromq 工作正常）。

# c++ - 图中的平面度

> ID：11867634
> 
> 赞同：0
> 
> 时间：2012-08-08T15:11:39.727
> 
> 标签：c++, algorithm, graph

我正在实现一个图形库，我想在其中包含一些基本的图形算法。我已经阅读了有关平面图的内容，并决定在我的库中包含一个检查图形是否为平面的函数。我在网上找到了许多有效的算法，但它们都有相同的缺点；它们很难实施。所以这是我的问题：它是否存在一种易于理解和实现的平面性检查算法？

**注意：**我用 C++ 编写

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:15:52.707

这是一个数学问题，但无论如何从我的记忆深处和维基百科

一个有限图是平面的当且仅当它不包含一个子图，该子图是 K5（五个顶点上的完整图）或 K3,3（六个顶点上的完整二部图，其中三个相互连接）的细分三）。

# c - C Getopt：与其选项对应的参数错误

> ID：11867636
> 
> 赞同：1
> 
> 时间：2012-08-08T15:11:41.210
> 
> 标签：c, linux, command-line-arguments, getopt

我想获得此命令的选项：

```
my_cmd show --value true -D 
```

为此，我需要检查两次选项（由于架构）。在第二遍期间，不可能正确检索与其选项对应的参数。在此示例中，在第二次传递期间，检索到的参数（对于 option `--value`）是`-D`而不是`true`。

第一关：

```
void getoptions (int argc, char **argv, globalargs_t* globalargs) {

    static const char *optstring = "vDqnd:c:f:o:h?:";

    static const struct option longopts[] = {
        { "help",         no_argument,        NULL,    'h' },
        { "Debug",        no_argument,        NULL,    'D'},
        { "verbose",    no_argument,        NULL,    'v'},
        { "quiet",        no_argument,        NULL,    'q'},
        { "noheader",    no_argument,        NULL,    0},
        { "delimiter",    required_argument,     NULL,    0},
        { "columns",    required_argument,    NULL,    0},
        { "filter",        required_argument,    NULL,    0},
        { "order",        required_argument,    NULL,    0},
        { "getid",        no_argument,        NULL,    'i'},
        { NULL,            no_argument,        NULL,    0 }
    };

    int opt = 0;
    int longindex = 0;
    //opterr = 0;

    /* Process the arguments with getopt_long(), then populate globalargs-> */
    opt = getopt_long( argc, argv, optstring, longopts, &longindex );
    while( opt != -1 ) {
        switch( opt ) {
            case '?':
                break;
            case 'D':
                globalargs->debug = 1;    /* true */
                break;
            case 'v':
                globalargs->verbose++;
                break;
            case 'q':
                globalargs->quiet = 1;
                break;
            case 'i':
                globalargs->id = 1;
                break;
            case 'h':
                globalargs->help = 1;
                break;
            case 0:        /* long option without a short arg */
                if( strcmp( "Debug", longopts[longindex].name ) == 0 ) {
                    globalargs->debug = 1;
                }
                if( strcmp( "verbose", longopts[longindex].name ) == 0 ) {
                    globalargs->verbose = 1;
                }
                if( strcmp( "quiet", longopts[longindex].name ) == 0 ) {
                    globalargs->quiet = 1;
                }
                if( strcmp( "noheader", longopts[longindex].name ) == 0 ) {
                    globalargs->noheader = 1;
                }
                if( strcmp( "delimiter", longopts[longindex].name ) == 0 ) {
                    globalargs->delimiter = *optarg;
                }
                if( strcmp( "filter", longopts[longindex].name ) == 0 ) {
                    globalargs->filter = optarg;
                }
                if( strcmp( "order", longopts[longindex].name ) == 0 ) {
                    globalargs->order = optarg;
                }
                if( strcmp( "columns", longopts[longindex].name ) == 0 ) {
                    globalargs->columns = optarg;
                }
                break;
            default:
                /* You won't actually get here. */
                break;
        }
        opt = getopt_long( argc, argv, optstring, longopts, &longindex );
    }
    if (optind < argc) {
        while (optind < argc) {
            globalargs->actions[globalargs->actionsindex] = argv[optind++];
            globalargs->actionsindex++;
        }
    }
} 
```

第二关：

```
void getspecificoptions(int argc, char **argv, globalargs_t* globalargs) {
    static const char *optstring = ":n:d:v:d";

    static const struct option longopts[] = {
        { "name",                required_argument,     NULL,    'n'},
        { "domain",                required_argument,    NULL,    0},
        { "value",                required_argument,    NULL,    0},
        { "defined_value",        required_argument,    NULL,    0},
        { NULL,                    no_argument,        NULL,    0 }
    };

    optind = 1;
    int opt = 0;
    int longindex = 0;

    /* Process the arguments with getopt_long(), then populate globalargs-> */
    opt = getopt_long( argc, argv, optstring, longopts, &longindex );
    while( opt != -1 ) {
        switch( opt ) {
            case 'n':
                /* If used in update/add => must be still a filter */
                globalargs->filter = strcat(globalargs->filter,"cluster.name=");
                globalargs->filter = strcat(globalargs->filter, optarg);
                if(!globalargs->table || strcmp(globalargs->table, "cluster") == 0 ) {
                    globalargs->table = "cluster";
                }
                else {
                    clmError(&t, "dbm-command", -1, "Incompatible options.");
                    exit(EXIT_FAILURE_OPTIONS);
                }
                break;
            case 0:        /* long option without a short arg */
                if( strcmp( "domain", longopts[longindex].name ) == 0 ) {

                    }
                    else {
                        char* f = my_new(500*sizeof(char));
                        f = strcat(f, "cluster.dns_domain=");
                        f = strcat(f, optarg);
                        globalargs->actions[globalargs->actionsindex] = f;
                        globalargs->actionsindex++;
                    }
                    if(strcmp(globalargs->table,"") == 0 || strcmp(globalargs->table, "cluster") == 0 ) {
                        globalargs->table = "cluster";
                    }
                    else {
                        clmError(&t, "dbm-command", -1, "Incompatible options.");
                        exit(EXIT_FAILURE_OPTIONS);
                    }
                }
                if( strcmp( "value", longopts[longindex].name ) == 0 ) {
                    if(strcmp(globalargs->actions[0], "show") == 0 || strcmp(globalargs->actions[0], "delete") == 0 ) {
                        globalargs->filter = realloc(globalargs->filter, strlen(globalargs->filter) + strlen(optarg) + strlen("cluster_profile.value=") + 1);
                        globalargs->filter = strcat(globalargs->filter,"cluster_profile.value=");
                        globalargs->filter = strcat(globalargs->filter, optarg);
                    }
                    else {
                        char* act = my_new(strlen(optarg) + strlen("cluster_profile.value=") + 1U);
                        act = strcat(act, "cluster_profile.value=");
                        act = strcat(act, optarg);
                        globalargs->actions[globalargs->actionsindex] = act;
                        globalargs->actionsindex++;
                    }
                    if(strcmp(globalargs->table,"") == 0 || strcmp(globalargs->table, "profile") == 0 ) {
                        globalargs->table = "profile";
                    }
                    else {
                        clmError(&t, "dbm-command", -1, "Incompatible options.");
                        exit(EXIT_FAILURE_OPTIONS);
                    }
                }
                if( strcmp( "defined_value", longopts[longindex].name ) == 0 ) {
                    /* If used in update/add => must be still a filter */
                    globalargs->filter = strcat(globalargs->filter,"cluster_profile.defined_value=");
                    globalargs->filter = strcat(globalargs->filter, optarg);

                    if(!globalargs->table || strcmp(globalargs->table, "profile") == 0 ) {
                        globalargs->table = "profile";
                    }
                    else {
                        clmError(&t, "dbm-command", -1, "Incompatible options.");
                        exit(EXIT_FAILURE_OPTIONS);
                    }
                }
                break;
        }
        opt = getopt_long( argc, argv, optstring, longopts, &longindex );
    }
} 
```

在这些通行证之后，我有`globalargs->filter="-D"`。

任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:42:00.863

optind 必须重置为 0 而不是 1。第一次通过时，限定标志被解析，但第二次不是，因为 optind 是 1 而不是 0。将其设置为 0 会重新解析字符串。

optstring 的第一个字符也必须是 + 或 -（在前导冒号之前），以防止参数被重新排序。

这一切都假设您使用的是 GNU 的 getopt_long。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:39:18.327

`getopt`重新排序参数并将在所有非选项参数之前返回所有选项参数，如[手册](http://linux.die.net/man/3/getopt_long)中所述：

> 默认情况下，getopt()**会在扫描时置换 argv 的内容，以便最终所有非选项都位于末尾**。还实现了另外两种模式。如果 optstring 的第一个字符是 '+' 或设置了环境变量 POSIXLY_CORRECT，则一旦遇到非选项参数，选项处理就会停止。如果 optstring 的第一个字符是 '-'，则每个非选项 argv 元素都被处理为就好像它是具有字符代码 1 的选项的参数一样。（这被编写为期望选项和其他 argv 元素的程序使用以任何顺序，并且关心两者的顺序。）特殊参数“--”强制结束选项扫描，而不管扫描模式如何。

由于 is 的正确长语法`--value true`，`--value=true`被`true`视为非选项参数并移到选项参数后面。

# c# - 在 SSIS 的脚本任务中连接到 SQL 数据库

> ID：11867639
> 
> 赞同：20
> 
> 时间：2012-08-08T15:11:49.350
> 
> 标签：c#, sql, sql-server, ssis, script-task

在 SSIS 的脚本任务中，我需要调用 SQL 数据库。我有一个在将数据库添加到数据源文件夹时创建的连接字符串，但是现在我不确定如何在 C# 代码中引用它。我知道如何在 ASP 网站后面的代码中执行此操作，但是 SSIS 似乎应该有更直接的方法。

编辑

这行代码实际上最终抛出了一个异常：

```
sqlConn = (System.Data.SqlClient.SqlConnection)cm.AcquireConnection(Dts.Transaction); 
```

它显示：“无法将‘System._ComObject’类型的 COM 对象转换为类类型‘System.Data.SqlClient.SqlConection。’”

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-08T15:21:01.627

您不能从脚本任务中使用连接管理器中的配置，例如：conectionManager1.exceuteSQLStatment(...)

一旦您“进入”脚本任务，您需要像访问变量一样访问 CM：

```
ConnectionManager cm;
System.Data.SqlClient.SqlConnection sqlConn;
System.Data.SqlClient.SqlCommand sqlComm;

cm = Dts.Connections["conectionManager1"];

sqlConn = (System.Data.SqlClient.SqlConnection)cm.AcquireConnection(Dts.Transaction);
sqlComm = new System.Data.SqlClient.SqlCommand("your SQL Command", sqlConn);
sqlComm.ExecuteNonQuery();

cm.ReleaseConnection(sqlConn); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-01T02:15:01.200

您必须检查您尝试实例化的连接的提供者。

您不能将`OleDb.OleDbConnection`连接转换为`SQLClient.SQLConnection`，参数不同。

# asp.net - 分页到 RAGGRID 中的另一个页面后，复选框状态未保持

> ID：11867643
> 
> 赞同：0
> 
> 时间：2012-08-08T15:12:00.087
> 
> 标签：asp.net, telerik-grid

我有一个 RADGRID，其中第一列是 CheckBox，其余 4 列是 databoud 列。最初在分页到下一页时，我的项目没有显示，然后知道我必须通过 NEEDDATASOURCE 再次绑定 gridview，然后在分页到下一页剩余项目已绑定，

之后又出现了一个问题，如果我检查第一页上的任何项目n转到下一页，第一页上检查的项目没有保持它们的状态（当我移动到其他页面时它们没有被选中）所以如何保持状态这个复选框即使我转到下一页？请提出一些解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T11:09:16.967

我觉得使用下面的方法可以解决我的问题，

[http://www.aspdotnet-suresh.com/2010/04/maintaining-state-of-checkboxes-while.html](http://www.aspdotnet-suresh.com/2010/04/maintaining-state-of-checkboxes-while.html)

仍在努力使用其他一些技术或技巧来解决它，如果发现任何请分享。

# facebook - 用于用户交互测试的 Facebook 虚拟帐户被禁止

> ID：11867644
> 
> 赞同：21
> 
> 时间：2012-08-08T15:12:00.487
> 
> 标签：facebook, testing, user-accounts

我是为许多客户从事外包项目的软件测试员。

通常，我需要在 Facebook 应用程序上线之前对其进行测试。通常，应用程序的内容需要与其他 Facebook 朋友进行多次交互，包括提取标记的照片和检索用户信息。

大多数建议建议我应该使用由特定应用程序的开发人员创建的 Facebook 测试帐户。然而，由于为了完全测试某些应用程序的某些要求的复杂性，一个虚拟帐户 - 预先填充了“真实”信息更加实用。很明显，如果我们将所有这些细节添加到每个新项目的 Facebook 测试帐户中，我们将永远没有时间实际测试应用程序。

我的公司在 Facebook 上有大约 20-30 个虚拟用户帐户，所有这些帐户都有很好的详细程度，包括个人信息、照片、朋友网络等。这些都是正常的 Facebook 帐户，因此非常适合测试。我们始终将选项设置为私人，以防止公众看到任何敏感材料。

在过去的一个月或更长时间里，我们的虚拟用户帐户正在被 Facebook 阻止的地方系统地清除掉。显然，我们无法恢复这些帐户，因为我们没有“虚拟”用户的 ID。

我们的目标是帮助开发人员提高 Facebook 应用程序的质量，因此不会对 Facebook 作为公司或品牌产生不利影响。

有没有什么办法可以在不为维护我们的虚拟账户而不断战斗的情况下实现我们的要求？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2015-04-23T04:58:37.887

登录脸书。然后在 URL 中使用 /whitehat。在左侧，您将获得创建测试帐户的选项。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-08T17:19:57.467

[测试用户](https://developers.facebook.com/docs/test_users/)是在不违反 Facebook 服务条款的情况下执行此操作的唯一方法。

您可以通过测试用户使用多个应用程序，假设您没有在测试运行之间删除和重新创建它们

# c# - 同时出队一个项目

> ID：11867645
> 
> 赞同：0
> 
> 时间：2012-08-08T15:12:01.647
> 
> 标签：c#, concurrency, parallel-processing

假设我们有两个线程使用下面执行的方法：

```
while(true){

    if(Queue.Count() <= 0){
        wait();
    }

    object anObject = Queue.Dequeue();
} 
```

现在问题发生在 Queue 有一个元素 init，Thread 1 即将执行 Queue.Count 行，Thread 2 about 在 Queue.Dequeue() 上，执行优先级在 Thread 1 上。

当这种情况发生时，线程 1 将抛出异常，因为 Queue.Count() 将返回 1 并尝试从空队列中取出对象。我该如何处理？如果我想安全地出队，最好的解决方案是什么？我应该使用同步还是锁定某些东西？

最好的问候，凯末尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:14:34.843

最好的解决方案，假设您使用的是 .NET 4.0 或更高版本并且**确实需要一个 queue**，是切换到使用[ConcurrentQueue](http://msdn.microsoft.com/en-us/library/dd267265.aspx)及其 TryDequeue 方法。ConcurrentQueue 是线程安全的。

也就是说，从您的代码片段来看，您真正在寻找的是一个线程安全的生产者/消费者队列。在这种情况下，使用[BlockingCollection](http://msdn.microsoft.com/en-us/library/dd287085)类和它的 Take 方法：

```
while(true){
    // This will block until an item becomes available to take.
    // It is also thread safe, and can be called by multiple 
    // threads simultaneously. When an item is added, only one
    // waiting thread will Take() it
    object anObject = myBlockingCollection.Take();

    // do something with anObject
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:14:50.907

您可以使用线程安全队列[ConcurrentQueue](http://msdn.microsoft.com/en-us/library/dd267265.aspx)。

或者如果你不想使用它

```
 while (true)
    {
        Monitor.Enter(lockObj);
        try
        {
            if (Queue.Count <= 0)
            {
                Monitor.Wait(lockObj);
            }

            object anObject = Queue.Dequeue();
        }
        finally
        {
            Monitor.Exit(lockObj);
        }
    } 
```

或者如果使用`lock`

```
 while (true)
    {
        lock(lockObj)
        {
            if (Queue.Count <= 0)
            {
                Monitor.Wait(lockObj);
            }

            object anObject = Queue.Dequeue();
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:15:18.697

在访问之前锁定队列。

```
lock (Queue) {
    // blah blah
} 
```

**编辑**

```
while(true){
    lock (Queue) {
        if (Queue.Count() > 0) {
            // Dequeue only if there is still something in the queue
            object anObject = Queue.Dequeue();
        }
    }     
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:21:25.640

试试这个模式：

**制片人**

```
public void Produce(object o)
{
  lock (_queueLock)
  {
    _queue.Enqueue(o);
    Monitor.Pulse(_queueLock);
  }
} 
```

**消费者**

```
public object Consume()
{
  lock (_queueLock)
  {
    while (_queue.Count==0)
    {
      Monitor.Wait(_queueLock);
    }
    return _queue.Dequeue();
  }
} 
```

# objective-c - 在 Mac 上使用 AVAudioRecorder

> ID：11867657
> 
> 赞同：3
> 
> 时间：2012-08-08T15:12:29.070
> 
> 标签：objective-c, macos, avaudiorecorder, avaudiosession

在这里找到的 AVAudioRecorder 类参考：

[https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAudioRecorder_ClassReference/Reference/Reference.html#//apple_ref/doc/uid/TP40008238](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAudioRecorder_ClassReference/Reference/Reference.html#//apple_ref/doc/uid/TP40008238)

说AVAudioSession可以用来配置音频会话

> 要为录制配置适当的音频会话，请参阅 AVAudioSession 类参考和 AVAudioSessionDelegate 协议参考。

但是 AVFoundation 框架在 OS X 上缺少 AVAudioSession。

所以我们得到错误，`use of undeclared identifier AVAudioSession`。

所以我查看了 OS X AVFoundation Framework，发现 AVAudioSession.h 不见了！

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-04T18:12:39.927

使用[AudioToolbox中的](https://developer.apple.com/documentation/audiotoolbox)[音频硬件服务](https://developer.apple.com/search/?q=audiohardwareservice)而不是 AVAudioSession。这是可能的解决方案：[OSX 上的 AVAudioSession 替代方案，以获取音频驱动程序采样率](https://stackoverflow.com/questions/25556680/avaudiosession-alternative-on-osx-to-get-audio-driver-sample-rate)

我做了一些小的修改，比如以下几行：

```
AudioDeviceID deviceID;
OSStatus err = AudioHardwareServiceGetPropertyData(kAudioObjectSystemObject, &addr, 0, NULL, &size, &deviceID); 
```

# javascript - 根据经过的时间创建总节能代码

> ID：11867658
> 
> 赞同：0
> 
> 时间：2012-08-08T15:12:29.457
> 
> 标签：javascript, counter, ticker

基本上，我想创建一个持续运行的代码（每 1-15 秒，没关系），它会更新我们公司根据设定的方程式（例如每分钟 25 美分）节省的能源节约总量。它将基于实际的时钟/日历时间，而不仅仅是访问者访问页面的时间。

我正在寻找使用 javascript 来执行此操作（或 jQuery），但我对这两种语言都是新手，经验很少。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:19:08.150

我不知道您对 javascript 的了解程度，但有两个函数称为 window.setInterval 和 window.clearInterval，您可以使用它们以特定时间间隔生成事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:17:03.780

进行计算并定期更新它们并不是很困难。您需要使用[JavaScript 日期对象](http://www.w3schools.com/jsref/jsref_obj_date.asp)来获取您的时间。您还可以使用 setInterval 函数执行定期更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:22:38.713

你可以使用 window.setInterval(function,time in milliseconds); 基本上：

```
var money_value=0.25;  //25 cents
var timing=15;     //15 seconds
var global_calculator=0;   //start time  could be brought in by php or whatever
window.setInterval("calculate()",timing*1000);  //timing*1000 milliseconds
                                                // means 15 seconds

function calculate(){
   global_calculator+=15; //add the passed seconds to the total of seconds
   total=global_calculator*money_value;  //calculate the total savings
   update_clock();   //your function that updates the values some where to show them;
} 
```

应该是这样。

# c# - 使用 C#/Linq 在 xml 中添加节点和元素

> ID：11867659
> 
> 赞同：0
> 
> 时间：2012-08-08T15:12:34.393
> 
> 标签：c#, asp.net, xml, linq

我有一个这样的xml文件，

```
<?xml version="1.0" encoding="utf-8" ?>
<root>  
  <FeaturedProductCategories>
    <FeaturedProductCategory>
      <FeaturedProducts>
        <FeaturedProduct>
          <ContentSelector datavalue_idtype="content:smartform" datavalue_displayvalue="«Smart Form:49»">49</ContentSelector>
        </FeaturedProduct>
      </FeaturedProducts>
    </FeaturedProductCategory>
  </FeaturedProductCategories>
</root> 
```

我想像下面这样修改它，

```
<?xml version="1.0" encoding="utf-8" ?>
<root>
  <Title>HomePage</Title>
  <FeaturedProductCategories>
    <FeaturedProductCategory>
      <FeaturedProducts>
        <FeaturedProduct>
          <Products>
            <Product>
              <ProductTitle>Product</ProductTitle>
              <ProductDate>03-08-2012 11:57:25</ProductDate>
              <ProductImage>
                <img src="ex1.jpg" />
              </ProductImage>
              <ProductThumbnailImage>
                <img src="ex2.jpg" />
              </ProductThumbnailImage>
              <ProductCaption>Product Caption</ProductCaption>
              <ProductImage>
                <img src="ex3.jpg" />
              </ProductImage>
              <ProductThumbnailImage>
                <img src="ex4.jpg" />
              </ProductThumbnailImage>
              <ProductCaption>Product Caption</ProductCaption>
            </Product>
          </Products>
        </FeaturedProduct>
      </FeaturedProducts>
    </FeaturedProductCategory>
  </FeaturedProductCategories>
</root> 
```

所有新节点和值都将通过 C# 函数添加。现在让我们假设这些新值是静态值。

节点“FeaturedProduct”也不仅仅是一个。该名称中有很多节点。我想修改所有“FeaturedProduct”节点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:16:46.867

你应该看看这里的`XDocument`课程：http: [//msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)

几周前我不得不做一些与此非常相似的事情。XDocument 更愿意操作数据，并且与它一起使用 LINQ 非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:18:55.660

这并不完全使用 linq，但它会为您服务

```
 XmlDocument xDoc = new XmlDocument();
        xDoc.Load("filename.xml");

        foreach (XmlNode xNode in xDoc.SelectNodes("//FeaturedProduct"))
        {
            XmlElement newElement = xDoc.CreateElement("newElementName");
            XmlAttribute newAttribute = xDoc.CreateAttribute("AttributeName");
            newAttribute.Value = "attributeValue";
            newElement.Attributes.Append(newAttribute);

            xNode.AppendChild(newElement);
            xNode.InnerText = "myInnerText";
        } 
```

此外，[此文档](http://msdn.microsoft.com/en-us/library/ms256086.aspx)是 Xpath 的一个非常方便的参考

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:42:27.503

以下是使用 Linq 的方法：

```
 string documentXml = @"<?xml version=""1.0"" encoding=""utf-8"" ?>
<root>
    <FeaturedProductCategories>
        <FeaturedProductCategory>
            <FeaturedProducts>
                <FeaturedProduct>
                    <ContentSelector datavalue_idtype=""content:smartform"" datavalue_displayvalue=""«Smart Form:49»"">49</ContentSelector>
                </FeaturedProduct>
            </FeaturedProducts>
        </FeaturedProductCategory>
    </FeaturedProductCategories>
</root>";

        string productsXml = @"<Products>
    <Product>
        <ProductTitle>Product</ProductTitle>
        <ProductDate>03-08-2012 11:57:25</ProductDate>
        <ProductImage>
            <img src=""ex1.jpg"" />
        </ProductImage>
        <ProductThumbnailImage>
            <img src=""ex2.jpg"" />
        </ProductThumbnailImage>
        <ProductCaption>Product Caption</ProductCaption>
        <ProductImage>
            <img src=""ex3.jpg"" />
        </ProductImage>
        <ProductThumbnailImage>
            <img src=""ex4.jpg"" />
        </ProductThumbnailImage>
        <ProductCaption>Product Caption</ProductCaption>
    </Product>
</Products>";

        XDocument document = XDocument.Parse(documentXml);

        var targetNodes = from featuredProduct in document.Descendants("FeaturedProduct")
                          from contentSelector in featuredProduct.Elements("ContentSelector")
                          select contentSelector;

        foreach (var targetNode in targetNodes)
        {
            targetNode.ReplaceWith(XElement.Parse(productsXml));
        }

        Console.WriteLine(document.ToString()); 
```

# powershell - 在 NuGet 包管理器控制台中列出特定包的所有可用版本

> ID：11867660
> 
> 赞同：55
> 
> 时间：2012-08-08T15:12:35.120
> 
> 标签：powershell, nuget

什么 NuGet PowerShell 命令将返回特定包的所有版本的列表？

我尝试了以下方法，但它只返回一个版本的 NUnit 以及许多其他（不）相关的包，每个包只有一个版本。

```
Get-Package -Source https://go.microsoft.com/fwlink/?LinkID=206669 -ListAvailable -Filter NUnit -AllVersions 
```

注意：我指定了源 URI，因为我们有自己的内部包源作为我们的默认远程。

我的理解是`-AllVersions`交换机*应该*撤回每个匹配包的每个版本。

我似乎无法弄清楚：

1.  我做错了吗？
2.  如果不是，项目维护者（或其他人）是否从包源中删除旧版本？
3.  如果是，为什么？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-08-08T17:27:17.390

您的源解析为似乎无法使用的提要版本 1 `-AllVersions`（我提出了一个问题：[https](https://github.com/NuGet/NuGetGallery/issues/563) ://github.com/NuGet/NuGetGallery/issues/563 ）

使用 V2 提要对我有用：

```
get-package -ListAvailable -AllVersions -filter nunit -source https://nuget.org/api/v2/ 
```

但请注意，这`-filter`不是针对特定包的，而更像是搜索词。

作为一种解决方法，我会使用选项卡自动完成来获取特定包的版本列表：

```
install-package -source https://nuget.org/api/v2/ -id nunit -version <tab> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-12-29T10:35:05.613

从 3.x 版开始，`get-package -ListAvailable -AllVersions`仍然可以使用，但会发出以下关于即将弃用的警告：

> 此命令/参数组合已被弃用，将在下一版本中删除。请考虑使用替换它的新命令：'Find-Package [-Id] -AllVersions'。

此外，[`Find-Package`](https://docs.nuget.org/ndocs/tools/powershell-reference#find-package)支持一个`-ExactMatch`可以避免通配符匹配问题的开关`-Filter`：

`Find-Package NUnit -AllVersions -ExactMatch -Source https://api.nuget.org/v3/index.json`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-07-12T08:59:41.070

[为了扩展已经提供的解决方案并解决King King](https://stackoverflow.com/questions/11867660/list-all-available-versions-of-a-specific-package-in-nuget-package-manager-conso#comment68568691_11869935) [和 JohnKoz](https://stackoverflow.com/questions/11867660/list-all-available-versions-of-a-specific-package-in-nuget-package-manager-conso#comment88237746_11869935)的后续问题，可以获得特定软件包的完整版本列表，如下所示：

```
Find-Package -AllVersions -source https://nuget.org/api/v2/ Newtonsoft.Json -ExactMatch | foreach { $_.Versions } | Select-Object Version 
```

包*Newtonsoft.Json*就是一个例子。根据需要更换。

It works by first getting all versions for a single package (via `-ExactMatch`). This returns a package object that has a *Versions* property, which is an array of version objects. The [foreach](https://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/ForEach-Object) iterates over all these and the [Select-Object](https://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Utility/Select-Object) ensures that each version object is output as a single line (by only selecting its main property).

# apache-flex - flex 4 中的多版本子应用程序资产路径

> ID：11867663
> 
> 赞同：0
> 
> 时间：2012-08-08T15:12:48.367
> 
> 标签：apache-flex, relative-path, assets, absolute-path, subapplication

希望有人可以在这里提供帮助，或多或少地寻找a）相对路径的解决方案或b）了解另一种加载资产的方法。

我们有一个使用 SDK 4.1 的独立 Web 应用程序，并在其相关资产文件夹中查找要加载的所有图像和外部 swf。

在服务器上，这是资产目录的绝对路径：

```
/ApplicationRoot/versionFldr/controls/assets/* 
```

该应用程序在加载资产的所有情况下都使用相对路径。随着我们推进应用程序的版本，这将不断添加和更新。

因此，本质上，该应用程序正在寻找：

```
assets/* 
```

* * *

现在转发到新的应用程序，我们称之为“ParentApp”和上面的应用程序“ChildApp”。

Parent App 与 ChildApp 位于不同的服务器目录中

```
/ParentApp/version/controls/ParentApp.swf
/ChildApp/version/controls/ChildApp.swf 
```

现在，当 ChildApp 加载到 ParentApp 中时，它假定它位于它一直所在的同一目录中。因此，它查找 assets/* 并找不到它们，因为

```
/ParentApp/version/controls/assets/* != /ChildApp/version/controls/assets/* 
```

我需要找到一个解决方案，让 ChildApp 在它是 ParentApp 的孩子时查看所有加载资产的绝对路径，并让它在独立时查看相对于自身的路径。

我需要注意的是，图像被加载到各种控件、缓存甚至 mx:Text 字段（带有标签的 html 文本）中。我试图避免必须全局替换应用程序中的所有路径链接，并且在为应用程序创建新资产时必须创建新的编码过程。ChildApp 正在生产中，必须保留在 4.1 SDK 上。

ParentApp 是新的并且具有更大的灵活性。

我在 childApp 中尝试了 -source-path 和 -library-path 编译器选项，但这会导致编译错误，我无法继续。

提前感谢您的任何见解和帮助！-AJ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T17:11:14.800

我会通过在子应用程序中使用“baseURL”变量来解决这个问题。给它一个默认值，这样你就可以形成你正在使用的通常的相对 URL：`var baseURL:String = "/assets/";

不幸的是，您必须修改子应用程序中的每个资产路径，因此资产的路径类似于： `baseURL + assetFileName`

当子应用程序加载到父应用程序中时，您可以为该`baseURL`变量提供一个非相对路径。理想情况下，您应在该过程的早期，在子应用程序尝试加载任何资产之前执行此操作。

# java - java如何防止类被派生超过两个级别？

> ID：11867682
> 
> 赞同：0
> 
> 时间：2012-08-08T15:13:37.600
> 
> 标签：java, inheritance

在 java 中，我需要防止 Level1 类（查看以下示例代码）被派生到两个以上的级别。派生到 Level2 和 Level3 是可以的，但如果类是由 Level4 派生的，那么应该抛出异常。查看以下代码示例。

代码示例：

```
class Level1 {
    private int level = 1;

    protected Level1() throws RuntimeException {
        level++;
        //System.out.println(level);
        if (level > 2) {
            throw new RuntimeException("Can't implement more than 2 levels");
        }
    }
}

class Level2 extends Level1 {
    protected Level2() {
    }
}

class Level3 extends Level2 {
    Level3() {
    }
}

class Level4 extends Level3 {
    Level4() {
    }
} 
```

从上面的代码示例中，我没有提出使用静态 int 级别计数器的解决方案。我只是想解释这个问题。

在Java中是否可以通过实现一些逻辑或使用一些API，其中Level1基类可以计算它已经派生的级别数？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T15:16:56.527

您可以在构造函数中使用反射并遍历 this.getClass() 的继承链以查看嵌套级别。实际上，对 this.getClass().getSuperClass() == Level1.class 的测试应该已经可以解决问题了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-08T15:22:08.850

introspection api 可以帮助您处理这个问题，请尝试以下操作：

```
protected Level1() throws RuntimeException {
        if (getClass().equals(Level1.class)) {
            return;
        }

        if (getClass().getSuperclass().equals(Level1.class)) {
            return; // first level or inheritance
        }

        if (getClass().getSuperclass().getSuperclass().equals(Level1.class)) {
            return; // second level or inheritance
        }
        // else
        throw new RuntimeException("Can't implement more than 2 levels");
    } 
```

顺便说一句，你为什么要这样做？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-08T15:17:41.050

您可以查看 getClass().getSuperclass() 等来检查您的班级不超过 N 个级别。

然而，这是一个令人费解的要求。:P

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:32:36.293

您可以将 level3 类设为 final，然后它不能被任何类扩展。声明为 final 的类不能被子类化。

# junit - 使用 JUnit “完全”重新运行失败的测试脚本

> ID：11867683
> 
> 赞同：3
> 
> 时间：2012-08-08T15:13:39.997
> 
> 标签：junit

我在[如何立即重新运行失败的 JUnit 测试？](https://stackoverflow.com/questions/8295100/how-to-re-run-failed-junit-tests-immediately). 就我而言，我从命令行执行测试。如果失败，我想重新运行完整的测试。下面给出的是我的测试脚本模板，如果失败，我想重新运行所有内容（从头到尾）

```
@BeforeClass
public static void Start(){
...
}

@Test
public void Test_One(){
...
}

@Test
public void Test_Two(){
...
}

@AfterClass
public static void End(){
...
} 
```

如果我的测试脚本失败，我将在 End() 方法中了解。如果它失败了，我想运行一切

```
@BeforeClass
@Test (all @Test)
@AfterClass 
```

JUnit可以吗？我不确定我使用的模板是否正确:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T21:58:53.887

JanakiL，这是一个非常好的问题。我试图找到一些解决方案，但我没有设法为这项任务找到干净的解决方案。我只能建议做一些最终可行的解决方法。因此，为了重新运行套件，您需要执行以下步骤：

1.  您需要创建 @ClassRule 才能执行整个套件。您可以使用以下代码重试所有套件：

    公共类 Retrier 实现 TestRule{

    ```
    private int retryCount;
    private int failedAttempt = 0;
        @Override
    public Statement apply(final Statement base,
            final Description description) {
        return new Statement() {
            @Override
            public void evaluate() throws Throwable {               

                base.evaluate();                 
                while (retryNeeded()){
                    log.error( description.getDisplayName() + " failed");
                    failedAttempt++;                    

                }

            } 
    ```

    }

retryNeeded() – 确定是否需要重试的方法

这将重试套件中的所有测试。重试将遵循@AfterClass 方法非常重要。

如果您需要在成功重试后进行“绿色构建”，您需要编写一堆其他令人沮丧的代码。

1.  您需要创建不允许“发布”失败结果的@Rule。例如：

`public class FailedRule extends TestWatcher {`

 ````
@Override
public Statement apply(final Statement base, final Description description) {
         return new Statement() {
            @Override
            public void evaluate() throws Throwable {
                List<Throwable> errors = new ArrayList<Throwable>();
                try {

                    base.evaluate();

                } catch (AssumptionViolatedException e) {
                    log.error("", e.getMessage());

                    if (isLastRun()) {
                        throw e;
                    }

                } catch (Throwable t) {
                    log.error("", t.getMessage());                  
                    if (isLastRun()) {
                        throw t;
                    }
                }
            };

        };
}   
} 
````  `isLastRun() – 验证它是否是最后一次运行的方法，并且仅在最后一次运行 ir 的情况下才会通过测试。

只需要发布最后一次重试以标记您的测试失败并构建“红色”。3\. 最后在你的测试类中你需要注册两条规则：

 `````
@Rule
public FailedRule ruleExample = new FailedRule ();
@ClassRule 
public static Retrier retrier = new Retrier (3); 
````  `在 Retrier 中，您可以传递尝试重试的次数。

我希望有人可以提出更好的解决方案！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-24T15:08:49.920

更灵活的解决方案是编写自定义运行器。我在下面的帖子中描述了这个答案：

[如何立即重新运行失败的 JUnit 测试？](https://stackoverflow.com/questions/8295100/how-to-re-run-failed-junit-tests-immediately/20762914#20762914)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:19:09.703

使用 Eclipse，在 Junit 视图中，您有一个按钮“ReRun Tests - Failures First”

您还可以看到这个答案：[如何立即重新运行失败的 JUnit 测试？](https://stackoverflow.com/questions/8295100/how-to-re-run-failed-junit-tests-immediately)```

# networking - 当我的网络服务器完全关闭时，如何显示维护页面关闭

> ID：11867685
> 
> 赞同：1
> 
> 时间：2012-08-08T15:13:46.467
> 
> 标签：networking, webserver

大家好，提前感谢您提供的任何帮助，我为一家拥有自己的网络服务器的公司工作，他们由于某种原因在周末完全停电，这意味着他们的服务器将关闭。有谁知道我们可以提供停机维护页面或某种重定向的方式，以便我们至少可以通知我们的用户该站点已停机维护，而不仅仅是丢失/损坏？再次感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:19:04.970

最好的方法可能是在您的负载平衡器或边界路由器上设置到虚拟服务器的重定向。如果您没有这样的事情，那么您可以尝试向您的提供商询问选项，或者暂时更改 DNS 记录，前提是您减少更改前后的 DNS 缓存超时，以便立即生效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:15:28.647

在另一个位置设置服务器，并在停电期间将其域 DNS 记录指向该服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:21:29.427

重定向必须由 Web 服务器执行。没有网络服务器，没有重定向。您可以做的是通过网络托管公司获取另一个网站（不会受到您的停电影响），并将其配置为仅使用普通通知 html 页面将请求从您的主 dns 路由到临时站点，然后删除一旦恢复供电。如果您有来自主站点的 dns 信息，则可以这样做。您也可以通过这种方式镜像站点，然后关闭镜像，没有人会更聪明。试试[http://siteground.com](http://siteground.com) 我已经用了很多年了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:40:45.317

如果您使用的是负载平衡器，请查看它是否支持“Sorry Server”页面。他们中的大多数都内置了此功能。

# html - W3C 验证器错误：解析错误 opacity=60

> ID：11867694
> 
> 赞同：0
> 
> 时间：2012-08-08T15:14:07.953
> 
> 标签：html, css

我已经通过 W3C 的 CSS 验证器运行了一个样式表......我得到的唯一错误是“Parse Error Opacity=60”它在 CSS 的这一位：

```
/*Navigation Link styling */
#Nav a:link, a:visited {
display: inline-block;
width: 150px;
height: 150px;
font-weight: bold;
color: #FFFFFF;
background-color: #99FFFF;
text-align: center;
padding:5px;
text-decoration:none;
text-transform:uppercase;
filter:alpha(opacity=60);
opacity:0.6; 
```

}

我假设验证器对“filter:alpha(opacity=60);”不满意 部分 - 这仅仅是因为它不是标准功能吗？并且可以忽略此错误。

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:16:19.167

是的，这是 Microsoft 使用的非标准属性（SVG 工作组正在重用该名称，因此它可能会出现在新规范中，但这将是完全不同的事情）。可以放心地忽略该错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:16:07.333

这不是标准的 CSS，不。如果它正在做您希望它做的事情并且您不担心验证您的 CSS，则可以忽略它。

# xml - 使用 PropertyPlaceHolder 国际化 XML 文件？

> ID：11867696
> 
> 赞同：0
> 
> 时间：2012-08-08T15:14:11.130
> 
> 标签：xml, properties, internationalization

我知道借助 PropertyPlaceHolder，可以在 XML 文件中使用键（在属性文件中引用）。我想知道是否可以通过国际化做类似的事情。xml中是否有语言分辨率或其他内容？

不知道它是否可以改变任何东西，但我正在使用 Spring & Struts。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T09:26:29.030

似乎不可能。无论如何，这可能没有必要。事实上，我想要国际化的是：

```
<bean id="mapPriorities" class="org.springframework.beans.factory.config.MapFactoryBean">
        <property name="example">
            <map>
                <entry key="3" value="Normal" />
                <entry key="5" value="Urgent" />
            </map>
        </property>
</bean> 
```

例如，我想将“正常”和“紧急”翻译成不同的语言。但这很愚蠢，因为在创建 bean 时，没有办法解析浏览器语言。

因此，在这种情况下，问题实际上并不是 XML 国际化的问题......

如果有人在这个问题上遇到了像我这样的脑虫，这里有一个简单的解决方案：只需在条目的 key 选项中放一个“key”，比如 key="key.priority.normal"。然后使用 ResourceBundle 获取在您的 java 代码中显示的国际化值。

抱歉我的问题很糟糕。

# asp.net-mvc - ASP.NET MVC PartialView 有时会出错？

> ID：11867697
> 
> 赞同：1
> 
> 时间：2012-08-08T15:14:12.550
> 
> 标签：asp.net-mvc, partial-views

我使用偏视图

```
<td style="vertical-align: top;">@Html.Action("_HavaDurumuPartial") 
```

它现在正在服务器上工作。但有时它会出错。错误如下：

![在此处输入图像描述](../Images/cd8650dc73d02dccd8643ba2e8f9fa57.png)

此错误并非总是发生。

我找不到这个问题的任何原因。我不明白为什么它有时会给出这个错误。

如果有必要，我会编写部分视图和控制器操作的内容。

**行动**

```
public ActionResult _HavaDurumuPartial(string il)
    {
        il = "Izmir";
        HttpWebRequest GoogleRequest;
        HttpWebResponse GoogleResponse = null;
        XmlDocument GoogleXMLdoc = null;
        try
        {
            GoogleRequest = (HttpWebRequest)WebRequest.Create("http://www.google.com/ig/api?weather=" + il + "&hl=tr&ie=utf-8&oe=utf-8");
            GoogleResponse = (HttpWebResponse)GoogleRequest.GetResponse();
            GoogleXMLdoc = new XmlDocument();
            GoogleXMLdoc.Load(GoogleResponse.GetResponseStream());
            XmlNode root = GoogleXMLdoc.DocumentElement;
            XmlNodeList nodeList1 = root.SelectNodes("weather/forecast_information");
            //ViewBag.HavaDurumu = ViewBag.HavaDurumu + "<b>Şehir : " + nodeList1.Item(0).SelectSingleNode("city").Attributes["data"].InnerText + "</b>";
            XmlNodeList nodeList = root.SelectNodes("weather/current_conditions");

            ViewBag.HavaDurumu = ViewBag.HavaDurumu + "<table cellpadding=\"5\"><tbody><tr><td style=\"width:50%;\"><b><big><nobr>" + nodeList.Item(0).SelectSingleNode("temp_c").Attributes["data"].InnerText + " °C | " + nodeList.Item(0).SelectSingleNode("temp_f").Attributes["data"].InnerText + " °F</nobr></big></b></br>";
            ViewBag.HavaDurumu = ViewBag.HavaDurumu + "<b>Şuan:</b> " + nodeList.Item(0).SelectSingleNode("condition").Attributes["data"].InnerText + "";
            ViewBag.HavaDurumu = ViewBag.HavaDurumu + " " + nodeList.Item(0).SelectSingleNode("wind_condition").Attributes["data"].InnerText + "</br>" + "";
            ViewBag.HavaDurumu = ViewBag.HavaDurumu + " " + nodeList.Item(0).SelectSingleNode("humidity").Attributes["data"].InnerText;
            nodeList = root.SelectNodes("descendant::weather/forecast_conditions");
            int i = 0;
            foreach (XmlNode nod in nodeList)
            {
                if (i == 0)
                {
                    i++;
                    continue;
                }
                ViewBag.HavaDurumu = ViewBag.HavaDurumu + "</td><td align=\"center\">" + nod.SelectSingleNode("day_of_week").Attributes["data"].InnerText + "</br>" + "";
                ViewBag.HavaDurumu = ViewBag.HavaDurumu + "<img src=\"http://www.google.com" + nod.SelectSingleNode("icon").Attributes["data"].InnerText + "\" alt=\"" + nod.SelectSingleNode("condition").Attributes["data"].InnerText + "\">" + "</br>";
                ViewBag.HavaDurumu = ViewBag.HavaDurumu + nod.SelectSingleNode("low").Attributes["data"].InnerText + "°C" + "</br>";
                ViewBag.HavaDurumu = ViewBag.HavaDurumu + nod.SelectSingleNode("high").Attributes["data"].InnerText + "°C" + "</br>";
            }
            ViewBag.HavaDurumu = ViewBag.HavaDurumu + "</td></tr></tbody></table>";
        }
        catch (System.Exception ex)
        {
            ViewBag.HavaDurumu = ex.Message;
        }
        finally
        {
            GoogleResponse.Close();
        }
        return PartialView();
    } 
```

通过此操作，我可以从 google 获取特定位置的天气。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T19:35:20.723

当前对您正在使用的 Google Weather API 有间歇性的 403 Forbidden 响应。请参阅[Google Weather API 403 错误](https://stackoverflow.com/questions/11878143/google-weather-api-403-error/)

间歇性 403 响应的原因尚不清楚，但自 2012 年 8 月 7 日以来一直存在问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T19:40:50.920

在您的 finally.xml 文件中添加一个空引用检查。初始化 GoogleResponse 可能会失败，因此它仍然为空。然后，您将点击 finally 块并获得空引用异常，因为当您尝试调用 .Close() 时 GoogleResponse 为空。

```
finally
{
    if (GoogleResponse != null)
    {
        GoogleResponse.Close();
    }
} 
```

# sql - 这两个 SQL Server 查询有什么区别？

> ID：11867700
> 
> 赞同：2
> 
> 时间：2012-08-08T15:14:27.670
> 
> 标签：sql, sql-server-2008

> **可能重复：**
> [显式与隐式 SQL 连接](https://stackoverflow.com/questions/44917/explicit-vs-implicit-sql-joins)

我在 SQL Server 中有两个查询。

第一个查询：

```
Select * 
From Stack, Overflow
Where Stack.Id = Overflow.StackId 
```

第二个查询：

```
Select * 
From Stack 
Inner Join Overflow On Overflow.StackId = Stack.Id 
```

这两个查询返回相同的结果。

那么这两个查询在性能方面有什么区别呢？

你更喜欢哪一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:20:05.770

使用查询 #2 - 它是正确的**ANSI/ISO SQL 标准** `JOIN`语法，并且优于 #1。

一方面：您的 JOIN 条件是它所属的位置 - 在`JOIN`- 并且不会弄乱您的`WHERE`子句。您的`WHERE`子句应仅包含您实际用于约束结果集的内容。

其次：由于您必须`JOIN`在 JOIN 上定义您的条件，因此您不太可能“忘记”它并无意中生成笛卡尔积。

最后：由于您定义了`INNER JOIN`or `LEFT OUTER JOIN`，您的查询变得更具可读性和更容易理解 - 对于查看您的查询的其他人，以及在六个月后您必须返回并维护您的代码的您自己。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:15:12.877

不同之处在于第一个查询*隐式*连接两个表，而第二个查询*显式*连接两个表。

我更喜欢第二个，只是因为您在说明两个表是如何连接在一起时非常~~详细。~~我想你也是第一个，但随着查询的增长，它会变得更难阅读。

性能主要取决于您的表索引。

# valueinjecter - 使用ValueInjecter，有没有办法只注入一次给定的属性

> ID：11867703
> 
> 赞同：3
> 
> 时间：2012-08-08T15:14:38.557
> 
> 标签：valueinjecter

给定3个班级，

A 和 B 各有一个 ID 属性，然后是各种其他属性

和 C，它有一个 ID，以及 A 和 B 的组合属性，

我想要

```
C.InjectFrom(A);
C.InjectFrom(B); 
```

这样来自 A 的 ID 将被保留而不被 B 覆盖。

显然，在这个简单的情况下，我可以颠倒两个调用的顺序，但在我的真实示例中，它稍微复杂一些，我不能只解决排序问题。

从本质上讲，我希望第二次注入忽略第一次注入已经处理的任何内容，并且这可能会延续到多次注入的链中。其中一些注入也可能来自相同的对象

```
C.InjectFrom(A);
C.InjectFrom<SomeInjector>(A);
C.InjectFrom<SomeInjector2>(A);
C.InjectFrom<SomeInjector3>(A); 
```

等等

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-09T21:33:48.360

干得好：

```
using System;
using System.Collections.Generic;
using Omu.ValueInjecter;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {

            var a = new { Id = 1, P1 = "p1" };
            var b = new { Id = 2, P2 = "p2" };

            var c = new C();

            var propList = new List<string>();
            c.InjectFrom(new HandlePropOnce(propList), a);
            c.InjectFrom(new HandlePropOnce(propList), b);

            Console.WriteLine("Id = {0} P1 = {1} P2 = {2}", c.Id, c.P1, c.P2);
        }
    }

    public class C
    {
        public int Id { get; set; }

        public string P1 { get; set; }

        public string P2 { get; set; }
    }

    public class HandlePropOnce : ConventionInjection
    {
        private readonly IList<string> handledProps;

        public HandlePropOnce(IList<string> handledProps)
        {
            this.handledProps = handledProps;
        }

        protected override bool Match(ConventionInfo c)
        {
            if (handledProps.Contains(c.SourceProp.Name)) return false;

            var isMatch = c.SourceProp.Name == c.TargetProp.Name && c.SourceProp.Type == c.TargetProp.Type;

            if (isMatch) handledProps.Add(c.SourceProp.Name);
            return isMatch;
        }
    }
} 
```

# c++ - 尝试使用deadline_timer 将超时添加到read_until

> ID：11867704
> 
> 赞同：1
> 
> 时间：2012-08-08T15:14:41.103
> 
> 标签：c++, boost, boost-asio

也许我误解了事情是如何工作的，但我试图为`read_until`调用添加超时，所以我创建了一个`deadline_timer`并在调用之前启动了它`read_until`，但是`read_until`仍然阻止了一切，并且计时器永远不会被激活。我做错了吗？以下是我的代码中的一些片段。

```
void MyClass::handle_timeout(const boost::system::error_code& error)
{
    // Our deadline timer went off.
    std::cout << "Deadline Timer was triggered." << std::endl;
    Disconnect();
}

// Read some data.
void MyClass::ReadData(){
            boost::asio::streambuf response;
            deadline_.expires_from_now(boost::posix_time::seconds(DEFAULT_TIMEOUT));
            deadline_.async_wait(boost::bind(&MyClass::handle_timeout, this, _1));

            boost::asio::read_until(socket_,response,asString);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T04:05:24.387

你误解了事情是如何运作的。如果您[希望可取消，](https://svn.boost.org/trac/boost/ticket/2832)则需要使用异步方法，例如

```
boost::asio::async_read_until(...); 
```

代替

```
boost::asio::read_until(socket_,response,asString); 
```

# sql - 外键可以为空。为什么需要它？

> ID：11867710
> 
> 赞同：3
> 
> 时间：2012-08-08T15:14:51.720
> 
> 标签：sql, oracle

我对表中外键关系的理解是，外键是子表中的列，是父表中的主键。我们知道主键是唯一的，不为空。我有一些疑问，需要澄清。当父表有数据时，子表是否也必须有相关数据？子表可以有空值（外键空值）。为什么规定外键为空。

我一直无法正确理解这一切。

帮助我更好地理解这些概念。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:17:46.890

> 为什么规定外键为空。

可选的参与条件。当孩子有单亲或非单亲时，这是对表之间的这种关系进行建模的一种方法。

如果值为`null`，则孩子没有父母。

如果该值**不是** `null`，则该子级有一个父级，并且该值*必须*是现有的父级 ID。

如果你有这样的关系并且不允许`null`在外键列中，那么你不能有没有父母的孩子。

您*可以*使用多对多表对此进行建模，没有任何约束意味着参与是可选的，但为了确保一对一的关系，您需要使每个外键列唯一（以及`NOT NULL`） . 我个人觉得这个选项有点矫枉过正（如果需求发生变化，它*可以*改变）。

两者之间的选择是实用性之一（例如，模型从一对一变为一对多或多对多的可能性有多大？），尽管关系纯粹主义者会选择多对多选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:19:26.713

可空外键本质上意味着关系是可选的。

假设正在检查 FK 约束，则如果外键不为空，则其值必须存在于引用的表中。

但是，如果外键的值为空，则表示该关系不存在。通常，在这种情况下，您将使用 LEFT/RIGHT OUTER JOIN 来防止空值在 JOIN 中被过滤掉。

当关系依赖于状态时，可选关系很有用。例如，只有当客户被批准为客户时，客户才会被分配到分支机构，在此之前，客户的`BranchId`将为 NULL，等等。

# iphone - Core Plot Y 轴 expandRangeByFactor 取决于数据？

> ID：11867723
> 
> 赞同：0
> 
> 时间：2012-08-08T15:15:31.660
> 
> 标签：iphone, core-plot

我有这个问题，当输入不同的数据时，Y 轴之间的间隙发生了变化。

第一：第三个数据点与其他点接近 ![在此处输入图像描述](../Images/e9888380f3da4d04e998d620fea2a1f8.png)

第二：第三个数据点稍微远一点 ![在此处输入图像描述](../Images/ac0f972c834e2597ba7d44ee632cbb08.png)

第三：第三个数据点距离其他点更远

![在此处输入图像描述](../Images/c96e87f44a8bdc0543cb1d08e6ae3a0b.png)

不知何故，我改变了 expandRangeByFactor 然后在每条 Y 轴线之间会出现不同类型的间隙。

我想知道如何修复 Y 轴间隙（不受我输入的数据的影响）？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:42:06.403

不要改变`yRange`情节空间的。请注意，诸如`-scaleToFitPlots:`用户交互（滚动、缩放）之类的方法也可以更改范围。

# java - 使用现有的 References Key 输入表一对多 JPA

> ID：11867724
> 
> 赞同：0
> 
> 时间：2012-08-08T15:15:34.530
> 
> 标签：java, postgresql, jpa

我的程序有问题。我有 2 个具有一对多关系的表。

在表“A”中的一条记录中，这些记录是表“B”中的引用键；

我如何在表“B”中输入记录。谢谢

表 A 型号

```
@Entity
@Table(name = "muatan_ktsp", catalog = "bansm", schema = "public")
@XmlRootElement
@NamedQueries({
    @NamedQuery(name = "MuatanKtsp.findAll", query = "SELECT m FROM MuatanKtsp m"),
    @NamedQuery(name = "MuatanKtsp.findByMuatanKtspDate", query = "SELECT m FROM MuatanKtsp m WHERE m.muatanKtspDate = :muatanKtspDate"),
    @NamedQuery(name = "MuatanKtsp.findByMuatanKtspTime", query = "SELECT m FROM MuatanKtsp m WHERE m.muatanKtspTime = :muatanKtspTime"),
    @NamedQuery(name = "MuatanKtsp.findByOrderDateDESC", query = "SELECT m FROM MuatanKtsp m ORDER BY m.muatanKtspDate DESC")})
public class MuatanKtsp implements Serializable {

    @Column(name =     "muatan_ktsp_date",insertable = false)
    @Temporal(TemporalType.DATE)
    private Date muatanKtspDate;
    @Column(name =     "muatan_ktsp_time",insertable = false)
    @Temporal(TemporalType.TIME)
    private Date muatanKtspTime;

    @OneToMany(cascade = CascadeType.ALL,mappedBy = "muatanKtspId")
    private List<Penjurusan> penjurusanCollection;
    @OneToMany(cascade = CascadeType.ALL,mappedBy = "muatanKtspId")
    private List<PengaturanBebanBelajar> pengaturanBebanBelajarCollection;
    @OneToMany(cascade = CascadeType.ALL,mappedBy = "muatanKtspId")
    private List<PendidikanKecakapanHidup> pendidikanKecakapanHidupCollection;
    @OneToMany(cascade = CascadeType.ALL,mappedBy = "muatanKtspId")
    private List<PendidikanGlobalLokal> pendidikanGlobalLokalCollection;
    @OneToMany(cascade = CascadeType.ALL,mappedBy = "muatanKtspId")
    private List<MuatanLokal> muatanLokalCollection;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "muatanKtspId")
    private List<MataPelajaran> mataPelajaranCollection;
    @OneToMany(cascade = CascadeType.ALL,mappedBy = "muatanKtspId")
    private List<KriteriaKenaikanKelas> kriteriaKenaikanKelasCollection;
    @OneToMany(cascade = CascadeType.ALL,mappedBy = "muatanKtspId")
    private List<KriteriaKelulusan> kriteriaKelulusanCollection;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "muatanKtspId")
    private List<KegiatanPengembanganDiri> kegiatanPengembanganDiriCollection;
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(generator = "system-uuid")
    @GenericGenerator(name = "system-uuid", strategy = "uuid")
    @Column(name = "muatan_ktsp_id", unique = true)
    private String muatanKtspId;

    public MuatanKtsp() {
    }

    public MuatanKtsp(String muatanKtspId) {
        this.muatanKtspId = muatanKtspId;
    }

    public Object getMuatanKtspId() {
        return muatanKtspId;
    }

    public void setMuatanKtspId(String muatanKtspId) {
        this.muatanKtspId = muatanKtspId;
    }

    public Date getMuatanKtspDate() {
        return muatanKtspDate;
    }

    public void setMuatanKtspDate(Date muatanKtspDate) {
        this.muatanKtspDate = muatanKtspDate;
    }

    public Date getMuatanKtspTime() {
        return muatanKtspTime;
    }

    public void setMuatanKtspTime(Date muatanKtspTime) {
        this.muatanKtspTime = muatanKtspTime;
    }

    @Override
    public int hashCode() {
        int hash = 0;
        hash += (muatanKtspId != null ? muatanKtspId.hashCode() : 0);
        return hash;
    }

    @Override
    public boolean equals(Object object) {
        // TODO: Warning - this method won't work in the case the id fields are not set
        if (!(object instanceof MuatanKtsp)) {
            return false;
        }
        MuatanKtsp other = (MuatanKtsp) object;
        if ((this.muatanKtspId == null && other.muatanKtspId != null) || (this.muatanKtspId != null && !this.muatanKtspId.equals(other.muatanKtspId))) {
            return false;
        }
        return true;
    }

    @Override
    public String toString() {
        return "bansm.model.MuatanKtsp[ muatanKtspId=" + muatanKtspId + " ]";
    }

    @XmlTransient
    public List<KegiatanPengembanganDiri> getKegiatanPengembanganDiriCollection() {
        return kegiatanPengembanganDiriCollection;
    }

    public void setKegiatanPengembanganDiriCollection(List<KegiatanPengembanganDiri> kegiatanPengembanganDiriCollection) {
        this.kegiatanPengembanganDiriCollection = kegiatanPengembanganDiriCollection;
    }

    @XmlTransient
    public List<KriteriaKelulusan> getKriteriaKelulusanCollection() {
        return kriteriaKelulusanCollection;
    }

    public void setKriteriaKelulusanCollection(List<KriteriaKelulusan> kriteriaKelulusanCollection) {
        this.kriteriaKelulusanCollection = kriteriaKelulusanCollection;
    }

    @XmlTransient
    public List<KriteriaKenaikanKelas> getKriteriaKenaikanKelasCollection() {
        return kriteriaKenaikanKelasCollection;
    }

    public void setKriteriaKenaikanKelasCollection(List<KriteriaKenaikanKelas> kriteriaKenaikanKelasCollection) {
        this.kriteriaKenaikanKelasCollection = kriteriaKenaikanKelasCollection;
    }

    @XmlTransient
    public List<MataPelajaran> getMataPelajaranCollection() {
        return mataPelajaranCollection;
    }

    public void setMataPelajaranCollection(List<MataPelajaran> mataPelajaranCollection) {
        this.mataPelajaranCollection = mataPelajaranCollection;
    }

    @XmlTransient
    public List<MuatanLokal> getMuatanLokalCollection() {
        return muatanLokalCollection;
    }

    public void setMuatanLokalCollection(List<MuatanLokal> muatanLokalCollection) {
        this.muatanLokalCollection = muatanLokalCollection;
    }

    @XmlTransient
    public List<PendidikanGlobalLokal> getPendidikanGlobalLokalCollection() {
        return pendidikanGlobalLokalCollection;
    }

    public void setPendidikanGlobalLokalCollection(List<PendidikanGlobalLokal> pendidikanGlobalLokalCollection) {
        this.pendidikanGlobalLokalCollection = pendidikanGlobalLokalCollection;
    }

    @XmlTransient
    public List<PendidikanKecakapanHidup> getPendidikanKecakapanHidupCollection() {
        return pendidikanKecakapanHidupCollection;
    }

    public void setPendidikanKecakapanHidupCollection(List<PendidikanKecakapanHidup> pendidikanKecakapanHidupCollection) {
        this.pendidikanKecakapanHidupCollection = pendidikanKecakapanHidupCollection;
    }

    @XmlTransient
    public List<PengaturanBebanBelajar> getPengaturanBebanBelajarCollection() {
        return pengaturanBebanBelajarCollection;
    }

    public void setPengaturanBebanBelajarCollection(List<PengaturanBebanBelajar> pengaturanBebanBelajarCollection) {
        this.pengaturanBebanBelajarCollection = pengaturanBebanBelajarCollection;
    }

    @XmlTransient
    public List<Penjurusan> getPenjurusanCollection() {
        return penjurusanCollection;
    }

    public void setPenjurusanCollection(List<Penjurusan> penjurusanCollection) {
        this.penjurusanCollection = penjurusanCollection;
    } 
```

表 B 型号

```
 @Entity
@Table(name = "mata_pelajaran", catalog = "bansm", schema = "public")
@XmlRootElement
@NamedQueries({
    @NamedQuery(name = "MataPelajaran.findAll", query = "SELECT m FROM MataPelajaran m"),
    @NamedQuery(name = "MataPelajaran.findByMataPelajaran", query = "SELECT m FROM MataPelajaran m WHERE m.mataPelajaran = :mataPelajaran"),
    @NamedQuery(name = "MataPelajaran.findByKkm", query = "SELECT m FROM MataPelajaran m WHERE m.kkm = :kkm"),
    @NamedQuery(name = "MataPelajaran.findByMataPelajaranId", query = "SELECT m FROM MataPelajaran m WHERE m.mataPelajaranId = :mataPelajaranId")})
public class MataPelajaran implements Serializable {
    private static final long serialVersionUID = 1L;
    @Basic(optional = false)
    @Column(name = "mata_pelajaran")
    private String mataPelajaran;
    // @Max(value=?)  @Min(value=?)//if you know range of your decimal fields consider using these annotations to enforce field validation
    @Column(name = "kkm", precision = 17, scale = 17)
    private Double kkm;

    @Id
    @GeneratedValue(generator = "system-uuid")
    @GenericGenerator(name = "system-uuid", strategy = "uuid")
    @Column(name = "mata_pelajaran_id", unique=true)
    private String mataPelajaranId;
    @JoinColumn(name = "muatan_ktsp_id", referencedColumnName = "muatan_ktsp_id")
    @ManyToOne
    private MuatanKtsp muatanKtspId;

    public MataPelajaran() {
    }

    public MataPelajaran(String mataPelajaranId) {
        this.mataPelajaranId = mataPelajaranId;
    }

    public MataPelajaran(String mataPelajaranId, String mataPelajaran) {
        this.mataPelajaranId = mataPelajaranId;
        this.mataPelajaran = mataPelajaran;
    }

    public String getMataPelajaran() {
        return mataPelajaran;
    }

    public void setMataPelajaran(String mataPelajaran) {
        this.mataPelajaran = mataPelajaran;
    }

    public Double getKkm() {
        return kkm;
    }

    public void setKkm(Double kkm) {
        this.kkm = kkm;
    }

    public String getMataPelajaranId() {
        return mataPelajaranId;
    }

    public void setMataPelajaranId(String mataPelajaranId) {
        this.mataPelajaranId = mataPelajaranId;
    }

    public MuatanKtsp getMuatanKtspId() {
        return muatanKtspId;
    }

    public void setMuatanKtspId(MuatanKtsp muatanKtspId) {
        this.muatanKtspId = muatanKtspId;
    }

    @Override
    public int hashCode() {
        int hash = 0;
        hash += (mataPelajaranId != null ? mataPelajaranId.hashCode() : 0);
        return hash;
    }

    @Override
    public boolean equals(Object object) {
        // TODO: Warning - this method won't work in the case the id fields are not set
        if (!(object instanceof MataPelajaran)) {
            return false;
        }
        MataPelajaran other = (MataPelajaran) object;
        if ((this.mataPelajaranId == null && other.mataPelajaranId != null) || (this.mataPelajaranId != null && !this.mataPelajaranId.equals(other.mataPelajaranId))) {
            return false;
        }
        return true;
    }

    @Override
    public String toString() {
        return "bansm.model.MataPelajaran[ mataPelajaranId=" + mataPelajaranId + " ]";
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T11:15:07.170

您应该先保留不是所有者方实体，然后再保留所有者方实体。根据您的代码，您应该首先保留 MuatanKtsp 实体。看[这个例子](http://examples.javacodegeeks.com/enterprise-java/jpa/one-to-many-bidirectional-mapping-in-jpa)。它可能是你的参考。

# c# - 在 sql db 中插入一个包含特殊字符的字符串 '

> ID：11867729
> 
> 赞同：0
> 
> 时间：2012-08-08T15:15:53.997
> 
> 标签：c#, sql, string

我想向 sql 表中插入一个可能包含 ' 字符的字符串。

我最好的方法是什么？我应该在 ' 之前插入一个 \ 吗？这是我在 ac# 代码中的命令：

```
SqlCommand myCommand = new SqlCommand(
    String.Format(
    "insert into ACTIVE.dbo.Workspaces_WsToRefile values({0},'{1}',getdate())", 
        folderId, 
        NewWorkspaceName), 
     myConnection); 
```

其中 NewWorkspaceName 可能包含 ' 字符，因此插入此时会导致异常。

提前感谢，哈达斯。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T15:18:07.987

您应该使用 SqlParameter。[http://msdn.microsoft.com/en-us/library/yy6y35y8.aspx](http://msdn.microsoft.com/en-us/library/yy6y35y8.aspx)

```
 string query = "insert into ACTIVE.dbo.Workspaces_WsToRefile values(@folderID, @newWorkSpace, @createDate)";

using(SqlCommand cmd = new SqlCommand(query, SqlConnection))
{

    SqlParameter param = new SqlParameter("@folderID", folderId);
    param.SqlDbType = SqlDbType.Int;
    cmd.Parameters.Add(param);
    .....
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:22:35.153

你只有一个选择，忘记其他一切。像这样使用参数化查询

```
SqlCommand myCommand = new SqlCommand("insert into ACTIVE.dbo.Workspaces_WsToRefile" + 
                                      " values(@id, @space, getDate()", myConnection);  
myCommand.Parameters.AddWithValue("@id", folderId);
myCommand.Parameters.AddWithValue("@space", NewWorkspaceName);
myCommand.ExecuteNonQuery(); 
```

**folderID**和NewWorkspaceName，都是传递给Sql Engine 里面的参数。
这将处理特殊字符，如引号。
但是使用参数化查询可以获得另一个好处。避免[Sql 注入攻击](http://xkcd.com/327/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:20:34.097

```
NewWorkspaceName= NewWorkspaceName.Replace("\'","\'\'"); 
```

'' 是 ' 在 sql

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-11T16:59:37.250

你可以试试这个：

```
string stringToDatabase=Server.HtmlEncode("կҤїАͻBsdҤїА"); 
```

这会将“stringToDatabase”保存在您的数据库中。然后在检索时

```
string OriginalText=Server.HtmlDecode(stringFromDatabase); 
```

# salesforce - 使用 VisualForce 页面/控制器

> ID：11867730
> 
> 赞同：0
> 
> 时间：2012-08-08T15:15:55.187
> 
> 标签：salesforce, apex-code, visualforce

visualforce 页面及其各自的控制器如何托管在 SFDC 上，但在将用户定向到它们时使用我自己的域名和 URL 扩展名？

我在 VisualForce 中使用 Apex 控制器扩展在后台构建页面，并且想知道如何将我的用户引导到他们，同时仍然使用我自己的 URL 而不是 na9.salesforce 来添加文件名......

这些页面是否必须托管在 Sites.com 上，或者我可以将它们作为页面托管在我的 developer.force.com 帐户中吗？我认为第一个是因为如果它们要托管在 SFDC 中，那么需要登录才能查看这些页面？

我很困惑，事情进展不顺利。我知道 SFDC 希望所有东西都被集成，但我认为用户应该只对一个没有模块的单一解决方案感到满意，因为您需要定制培训才能有效使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:41:36.267

如果您想提供自己的域 (URL)，Salesforce.com 的站点是您需要使用的技术。本质上，使用该技术，您可以设置一个访客帐户以供匿名用户访问。所以一切仍然在用户的上下文中运行，它只是这个通用的来宾帐户。

本文解释了将您的域映射到 Salesforce.com 站点域的详细信息。

[http://wiki.developerforce.com/page/Force.com_Sites_Best_Practices](http://wiki.developerforce.com/page/Force.com_Sites_Best_Practices)

# css - 如何制作推特助推器“colspan = 2”

> ID：11867738
> 
> 赞同：1
> 
> 时间：2012-08-08T15:16:18.087
> 
> 标签：css, twitter-bootstrap

我正在使用 twitter 引导程序，并且我有一个表格。我需要第一行像“colspan = 2”。
我希望我足够清楚..我该怎么做？

这是我的代码：

```
<form class="form-horizontal">
    <fieldset>
        I Need this row to be like "colspan=2" in table td
        <div class="control-group">
            <label class="control-label" for="my_input">field name</label>
            <div class="controls">
                <input type="text" class="input-xlarge" id="my_input" name="my_input"/>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="my_input">field name</label>
            <div class="controls">
                <input type="text" class="input-xlarge" id="my_input" name="my_input"/>
            </div>
        </div>
    </fieldset>
</form> 
```

这里是 jsFiddle：http: [//jsfiddle.net/3j7QP/7/](http://jsfiddle.net/3j7QP/7/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:21:25.263

像这样：http: [//jsfiddle.net/3j7QP/16/](http://jsfiddle.net/3j7QP/16/)？

```
<form class="form-horizontal">
    <fieldset>
        <div style="float: left; width: 100px; height: 80px; background: red;">
            xxx
        </div>

        <div class="control-group" style="float:left;">
            <label class="control-label" for="my_input">field name</label>
            <div class="controls">
                <input type="text" class="input-xlarge" id="my_input" name="my_input"/>
            </div>
        </div>
        <div class="control-group" style="float:left;">
            <label class="control-label" for="my_input">field name</label>
            <div class="controls">
                <input type="text" class="input-xlarge" id="my_input" name="my_input"/>
            </div>
        </div>
    </fieldset>
</form> 
```

# sql - Oracle SQL 技巧

> ID：11867739
> 
> 赞同：0
> 
> 时间：2012-08-08T15:16:19.243
> 
> 标签：sql, oracle

我想在 SQL 查询的 where 子句中的 oracle SQL 中执行以下操作

$p="All" 然后 buildingname in(Select buildingname from Building) else buildingname="$p"

问题是我无法解析这个 $p 变量，即我无法检查它包含的内容

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:20:55.597

听起来你只是想要一个`OR`条件，

```
SELECT *
  FROM sometable
 WHERE (    :bind_variable = 'All' 
        AND buildingname IN (SELECT buildingname
                              FROM building))
     OR buildingname = :bind_variable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:21:25.480

您可以在子查询中使用 OR，因此如果 $p 是“全部”，它要么选择建筑物选择，要么选择全部

```
buildingname in (Select buildingname from Building WHERE buildingname = $p OR $p = 'All') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T20:20:22.890

如果字符串中的变量被它包含的任何内容替换（因此它不是绑定变量，而只是来自 PERL 或 PHP 等语言的变量，并在您正在构建的选择字符串中使用）：

```
$selectstring = "SELECT *
  FROM sometable
 WHERE (    '$p' = 'All' 
        AND buildingname IN (SELECT buildingname
                              FROM building))
     OR (   '$p' <> 'All' AND buildingname = '$p'" 
```

意识到 SQL 注入的危险。绑定变量更好。无论如何，包含值“All”的变量 $p 的语句将是

```
SELECT *
  FROM sometable
 WHERE (    'All' = 'All' 
        AND buildingname IN (SELECT buildingname
                              FROM building))
     OR (   'All' <> 'All' AND buildingname = 'All') 
```

虽然您将有一个变量 $p 的选择字符串，其中包含 'XYZ'

```
SELECT *
  FROM sometable
 WHERE (    'XYZ' = 'All' 
        AND buildingname IN (SELECT buildingname
                              FROM building))
     OR (   'XYZ' <> 'All' AND buildingname = 'XYZ') 
```

但老实说，你也可以做类似的事情

```
if ($p eq 'All') {
...   one select
} else {
...   another select
} 
```

# .net - 每个使用 TPL 中预期的双线程并行

> ID：11867740
> 
> 赞同：1
> 
> 时间：2012-08-08T15:16:21.000
> 
> 标签：.net, c#-4.0, task-parallel-library, threadpool, parallel.foreach

我将从对我如何理解几件事情的基本解释开始这一点，然后用一个 tldr 来结束这一切；如果人们只是想解决我在这里遇到的实际问题。如果我对这里的任何理解有误，请纠正我。

TPL 代表任务并行库，它是 .NET 4.0 试图进一步简化线程以方便开发人员使用的答案。如果您不熟悉它，（在非常基础的级别上）您启动一个新的 Task 对象并向其传递一个委托，然后该委托在从线程池获取的后台线程上运行（通过使用线程池而不是真正制作通过使用这些现有线程而不是创建和处置新线程来节省新线程、时间和资源）。

据我了解，C# 中的 Parallel.ForEach 命令将为它应该执行的每个委托生成一个新线程（可能来自线程池），但可能的例外是自动执行一个甚至可能更多的内联如果编译器认为它们将足够快地发生以提高效率，则迭代。

与我的目标最相关的背景信息：

我正在尝试制作一个启动任务的快速程序，以便与程序的其余部分同时运行。在此任务中，Parallel.ForEach 运行 3 次“迭代”。总的来说，我们希望程序现在总共运行 5 个线程（最多）：1 个用于主线程，1 个用于实际任务，最多 3 个用于 Parallel.ForEach。每个 Thread 都有自己的目标要完成（尽管 Parallel.ForEach 都有相同的目标，但其相关 itemNumber 的值不同以计算。当主线程完成所有目标时，它使用 Task.Wait() 等待在完成任务上，它也等待 Parallel.ForEach 完成。然后使用并验证这些值。

tldr; 实际问题：

运行上述想法时，Parallel.ForEach 似乎正在初始化两倍于我预期的 SynchronizationContexts（本质上是另一个线程的 TPL 对象）并运行所有它们，但只等待预期数量的它们。因为 Parallel.ForEach().Wait() 命令以预期的线程运行数量完成，所以 Task 也会在它认为一切都完成时完成。然后主程序发现任务已经完成，并且当它验证当前没有更多后台线程在运行时，有时剩余的 Parrallel.ForEach() 尚未完成，因此会引发错误。

通过在每个 SynchronizationContext 的 post 调用（Async 方法启动器）时打印到调试窗口来验证线程的数量与我所说的匹配。每个线程还被一个主线程对象引用，否则该对象计划在完成任务时被处置，但由于由于未真正预期创建的未完成线程仍然有引用，因此处置不能正确发生。

```
Thread testThread = Thread.CurrentThread;
Task backgroundTask = taskFactory.StartNew(() =>
{
    Thread rootTaskThread = Thread.CurrentThread;
    Assert.AreNotEqual(testThread, rootTaskThread, "First task should not inline");
    Thread.Sleep(TimeSpan.FromSeconds(2));

    Parallel.ForEach(new[] { 1, 2, 3, 4 },
       new ParallelOptions { TaskScheduler = taskFactory.Scheduler }, (int item) => {
        Thread.Sleep(TimeSpan.FromSeconds(1));
     });
}); 
```

在上面的示例中，主线程、backgroundTask 任务和 8 个 Parallel.ForEach 线程最终都存在，其中最后 9 个线程是在 SynchronizationContexts 上创建的。

我的自定义在 SynchronizationContext 中覆盖的唯一方法是 post，如下所示：

```
public override void Post(SendOrPostCallback d, object state){
    Request requestOrNull = Request.ExistsForCurrentThread() ? Request.GetForCurrentThread() as Request : null;
    Request.IAsyncContextData requestData = null;

    if (requestOrNull != null){
       requestData = requestOrNull.CaptureDataForNewThreadAndIncrementReferenceCount();
    }

    Debug.WriteLine("Task started - request data " + (requestData == null ? "DOES NOT EXIST" : "EXISTS"));

    base.Post((object internalState) => {
        // Capture the spawned thread state and restore the originating thread state
        try{
            if (requestData != null){
                Request.AttachToAsynchronousContext(requestData);
            }
            d(state);
        }
        finally{
            // Restore original spawned thread state
            if (requestData != null){
            // Disposes the request if this is the last reference to it
                Request.DetachFromAsynchronousContext(requestData);
            }
        Debug.WriteLine("Task completed - request data " + (requestData == null ? "DOES NOT EXIST" : "EXISTS"));
        }
    }, state);
 } 
```

我认为 TaskScheduler 只做它所需的基本工作：

```
private readonly RequestSynchronizationContext context;
private readonly ConcurrentQueue<Task> tasks = new ConcurrentQueue<Task>();

public RequestTaskScheduler(RequestSynchronizationContext synchronizationContext)
{
    this.context = synchronizationContext;
}

protected override void QueueTask(Task task){
    this.tasks.Enqueue(task);
    this.context.Post((object state) => {
        Task nextTask;
        if (this.tasks.TryDequeue(out nextTask)) 
            this.TryExecuteTask(nextTask);
    }, null);
}

protected override bool TryExecuteTaskInline(Task task, bool taskWasPreviouslyQueued){
    if (SynchronizationContext.Current == this.context)
        return this.TryExecuteTask(task);
    else
        return false;
}

protected override IEnumerable<Task> GetScheduledTasks(){
    return this.tasks.ToArray();
} 
```

任务工厂：

```
public RequestTaskFactory(RequestTaskScheduler taskScheduler)
    : base(taskScheduler)
{ } 
```

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T20:29:23.560

任务本身不会创建线程。如果可以的话，由 TaskScheduler 决定做什么来使操作异步。例如，某些操作使用异步 IO，在这种情况下，硬件使其异步，而不是另一个工作线程。

如何调用延续取决于同步上下文。该上下文*不是另一个线程*，它只是抽象了可以运行操作的标准。例如，在 WPF、WinForms、Silverlight 等中，有一个 UI 同步上下文，其动作需要在**特定线程**（UI 线程或主线程，以避免异常）上执行。

ForEach 将*尝试*创建线程（更具体地说，它将尝试询问同步上下文以启动多个异步操作）。调度程序确实定义了它是如何做到的。如果你给它三个任务，*它可能会*创建三个线程，*也可能不会*。它决定三个并发线程是否是一件好事。例如，如果您只有两个内核，则 ForEach 不会创建两个以上的线程，因为由于上下文切换开销，这可能比使用单个线程并按顺序运行代码更糟糕。

不清楚“初始化两倍的 SynchronizationContext”是什么意思。这些不是线程。你只是说它创建的线程比你预期的多吗？还是您的意思是 Post 的调用次数超出了您的预期？您的 SynchronizationContext 类基于什么？（即它的基类是什么）。基础所做的主要定义了 Post 调用的可能性。它可能觉得需要创建另一个异步操作来跟踪其他操作......你如何让调度程序使用这个上下文？

SynchronizationContext 早在 TPL 之前就已经存在（首先出现在 .NET 2.0 中）。它所做的一件事是管理异步操作请求。从您的帖子中不清楚您是否理解这一点。

**更新：** 对 QueueTask 的第一次调用间接来自 StartNew。对 QueueTask 的第二次调用间接来自对 ForEach 的调用 第三次对 QueueTask 的调用间接来自 QueueTask 中的 TryExecuteTask 对 QueueTask 的接下来的 4 次调用是针对传递给 ForEach 的主体。

根据负载，QueueTask 最多可能被调用 3 次。如果我在 QueueTask 进行调试和中断，QueueTask 只会被调用 7 次。

此时，由于您在 QueueTask 中执行的操作与 TPL 不同（即 TryExecuteTask 正在调用一个额外的操作），因此很难说为什么有时会有一些额外的 QueueTask 调用。这可能来自您实现 QueueTask 的方式，因为您有效地要求调度程序从已经异步执行的任务中排队另一个异步任务。我的猜测是，这只是时机。QueueTask 可以被如此快速地调用（因为这是通过另一个异步操作完成的），以至于 TryExecuteTask 不知道任务已经排队并强制执行任务（强制*另一个*调用 QueueTask）。

如果 QueueTask 实际上导致另一个对 QueueTask 的调用，因为它还没有安排它所在的任务，这就解释了为什么最多有 10 次对 QueueTask 的调用。正是 TryExeucteTask 调用导致每个 ForEach 主体的“双重”调用......

# entity-framework - EF 5RC 表拆分为两个以上的实体

> ID：11867742
> 
> 赞同：2
> 
> 时间：2012-08-08T15:16:33.160
> 
> 标签：entity-framework, ef-code-first, split

有人可以提供示例或解释如何使用 EF 5 RC Code First 上的数据注释将表拆分为两个以上的实体吗？

我有 4 个实体想要映射到一张表中。他们每个人的代码是：

```
[Table("PatientDataEntities")]
public class PatientDataEntity
{
    [Key]
    [ForeignKey("UserFullName")]
    public virtual Guid Id { get; set; }

    public virtual UserFullNameEntity UserFullName { get; set; }

    public virtual GeneralData GenData {get; set;}

    [ForeignKey("Id")]
    public virtual PersonalPatientDataEntity PersonalData { get; set; }

    [ForeignKey("Id")]
    public virtual MedicalPatientDataEntity MedicalData { get; set; }

    [ForeignKey("Id")]
    public virtual FinancialPatientDataEntity FinancialData { get; set; }

} 

[Table("PatientDataEntities")]
public class PersonalPatientDataEntity
{
    [Key]
    [ForeignKey("UserFullName")]
    public virtual Guid Id { get; set; }

    public virtual UserFullNameEntity UserFullName { get; set; }

    [ForeignKey("Id")]
    public virtual MedicalPatientDataEntity MedicalPatientData { get; set; }

    [ForeignKey("Id")]
    public virtual FinancialPatientDataEntity FinancialPatientData { get; set; }

    [ForeignKey("Id")]
    public virtual PatientDataEntity PatientData { get; set; }

    [DataType(DataType.DateTime)]
    public virtual DateTime Birthdate { get; set; }

    public virtual Gender Sex { get; set; }

    public virtual MaritalStatus MStatus { get; set; }

    public virtual byte Children { get; set; }

    public virtual string Education { get; set; }

    public string Profession { get; set; }

} 

[Table("PatientDataEntities")]
public class MedicalPatientDataEntity
{
    [Key]
    [ForeignKey("UserFullName")]
    public virtual Guid Id { get; set; }

    public virtual UserFullNameEntity UserFullName { get; set; }

    [ForeignKey("Id")]
    public virtual PersonalPatientDataEntity PersonalData { get; set; }

    [ForeignKey("Id")]
    public virtual FinancialPatientDataEntity FinancialData { get; set; }

    [ForeignKey("Id")]
    public virtual PatientDataEntity PatientData { get; set; }

    public virtual string ClinicalHistoryNumber { get; set; }

    public virtual BiologicalState State { get; set; }

    public virtual Guid PhysicianId { get; set; }

    public virtual DateTime? RegisterDate { get; set; }

    public virtual bool AcceptsDataTreatment { get; set; }

    public virtual bool AcceptsImageTreatment { get; set; }

    public virtual /*List<Allergy>*/ string Allergies { get; set; }

    public virtual /*List<Surgery>*/ string Surgeries { get; set; }

    public virtual /*List<Medication>*/ string Medications { get; set; }

    public virtual /*List<MedicalPrecedent>*/ string MedicalPrecedents { get; set; }

    [DataType(DataType.MultilineText)]
    public virtual string Family { get; set; }

    public virtual string Nicotinism { get; set; }

    public virtual float? Weight { get; set; }

    public virtual float? Height { get; set; }

    [NotMapped]
    public virtual float? BodyMassIndex { get; set; }

    public virtual string Remarks { get; set; }
} 

[Table("PatientDataEntities")]
public class FinancialPatientDataEntity
{
    [Key]
    [ForeignKey("UserFullName")]
    public virtual Guid Id { get; set; }

    public virtual UserFullNameEntity UserFullName { get; set; }

    [ForeignKey("Id")]
    public virtual PersonalPatientDataEntity PersonalData { get; set; }

    [ForeignKey("Id")]
    public virtual MedicalPatientDataEntity MedicalData { get; set; }

    [ForeignKey("Id")]
    public virtual PatientDataEntity PatientData { get; set; }

    public virtual string KindOfPatient { get; set; }

    public virtual string Isapre { get; set; }

} 
```

我的背景是这样的：

```
public class MedicDbContext : DbContext
{
    public DbSet<UserFullNameEntity> UsersFullName { get; set; }
    public DbSet<MedicDb.Patient.PatientDataEntity> PatientDataEntities { get; set; }

    public DbSet<MedicDb.Patient.Personal.PersonalPatientDataEntity> PersonalPatientDataEntities { get; set; }

    public DbSet<MedicDb.Patient.Financial.FinancialPatientDataEntity> FinancialPatientDataEntities { get; set; }

    public DbSet<MedicDb.Patient.Medical.MedicalPatientDataEntity> MedicalPatientDataEntities { get; set; }
} 
```

当我运行时，我收到以下异常：

> EntityFramework.DLL 中出现“System.InvalidOperationException”类型的异常，但未在用户代码中处理
> 
> 附加信息：无法确定类型“MedicDb.Patient.Medical.MedicalPatientDataEntity”和“MedicDb.Patient.Personal.PersonalPatientDataEntity”之间关联的主体端。此关联的主体端必须使用关系流式 API 或数据注释显式配置。

我在这里做错了什么？我真的需要一些帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T13:04:47.177

好吧，我解决了这个问题，我想主要原因是我对该主题的无知，[ForeignKey] 属性必须仅位于关系的一端，这修复了异常但使 4 个实体在同一张桌子上必须是他们四个之间的一对一关系，它看起来有点不自然，但这是它工作的唯一方式。所以，最后我没有拆分我的表，而是创建了 4 个单独的表，它们不是在其中 4 个之间而是在 PatientDataEntity 和其他 3 个中的每一个之间具有一对一的关系，这是通过删除 [ ForeingKey] 注释来自 PatientDataEntity 中的属性，但将它们留在其他 3 个实体上（在指向 PatientDataEntity 的导航属性上。就是这样。万一其他人遇到同样的问题。

谢谢大家

胡安·卡洛斯·加尔维斯

# html - 左边 2 个 div 右边 1 个

> ID：11867743
> 
> 赞同：2
> 
> 时间：2012-08-08T15:16:34.620
> 
> 标签：html, css

嗨，我正在尝试让 2 个 div 在左侧与右侧对齐。

```
#div1 #div2
#div1 #div2
#div3 #div2
#div3
#div3 
```

诀窍是当浏览器窗口变小时，我希望 #div2 位于 #div1 和 #div3 之间。

目前 #div3 仅在 #div2 之后开始，但在窗口缩小时正确落入到位

```
#div1 #div2
#div1 #div2
      #div2
#div3
#div3
#div3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:56:14.837

如果 div 碰巧有相同数量的元素（例如 3 个链接和用于更多链接的“更多”按钮）并且每一行都可以通过“覆盖：省略号”功能附加，以便每个 div 具有相同的高度，你会解决你的问题。

否则，如果 Div 2 是唯一出现在右侧的，您可以将其设置为显示在左侧的固定位置。

我只是在小提琴中测试了它。我真的很鄙视这样做，因为我认为它会影响您的成长能力，但是唉，我希望您以此作为学习示例：http: [//jsfiddle.net/nugPA/](http://jsfiddle.net/nugPA/)

如果你把这条线去掉，它会回到一个简单的列：

```
div#two {position: fixed; left: 150px;} 
```

过去曾多次提出此类问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T17:52:59.823

这是你的想法吗？（手动缩小视口大小以查看实际的媒体查询。）

HTML

```
<div id="div1">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor.</div>
<div id="div2">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor.</div>
<div id="div3">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor.</div>​ 
```

CSS

```
#div1, #div2, #div3 {
    width: 300px;
}

#div1 {
    border: 1px solid red;
}

#div2 {
    border: 1px solid lime;
    position: absolute;
    top: 0px;
    right: 0px;
}

#div3 {
    border: 1px solid cyan;
}

@media screen and (max-width: 600px) {
#div2 {
    position: static;
}
} 
```

演示

[http://jsfiddle.net/z9AsG/](http://jsfiddle.net/z9AsG/)

# python - 在 reportlab 的 pdfgen 中独立跨越多个页面的列

> ID：11867744
> 
> 赞同：0
> 
> 时间：2012-08-08T15:16:35.703
> 
> 标签：python, reportlab, multiple-columns

我正在尝试创建一个 pdf，其中两列跨越多个页面，其中每一列独立于另一列填充。虽然 Pdfgen 似乎按页面而不是按文档填充了所有可用空间。我尝试过类似这样的代码：

```
doc = SimpleDocTemplate(myFile, pagesize = A4, leftMargin = 0, rightMargin = 0, topMargin = 0, showBoundary=1)

Elements=[]
p1 = Paragraph("I am column 1! " * 300, styles['Normal'])
p2 = Paragraph("I am column 2! " * 800, styles['Normal'])

frame1 = Frame(1.45*cm, doc.bottomMargin + 1*cm, doc.width/2-1.45*2*cm, doc.height-7*cm, id='col1')
frame2 = Frame(doc.width/2 + 1.45*cm, doc.bottomMargin + 1*cm, doc.width/2-1.45*2*cm, doc.height-7*cm, id='col2')

doc.addPageTemplates([
    PageTemplate(id = 'TwoCol', frames = [frame1,frame2], onPage = self.headerAndFooter),
])

Elements.append(NextPageTemplate('TwoCol'))
Elements.append(KeepTogether(p1))
Elements.append(FrameBreak())   
Elements.append(KeepTogether(p2))

doc.build(Elements) 
```

我是否遗漏了一些必不可少的东西，还是在 pdfgen 的限制范围内不可能？

# uiview - UIViewController 还是 UIView？甚至更好的设计解决方案？

> ID：11867753
> 
> 赞同：0
> 
> 时间：2012-08-08T15:17:06.417
> 
> 标签：uiview, uiviewcontroller, widget, dashboard

我在设计应用程序时遇到问题。这就是为什么我喜欢和你们讨论这个问题。

这个应用程序应该像一个仪表板。您有几个小窗口/小部件，其中填充了不同的数据（图像、表格等）。可以添加更多小部件或删除它们。不允许拖放。

我不确定是以正确的方式设计它。

我将为小部件创建一个 WidgetViewController。所以一切都被封装起来。然后我会将所有视图放在一个“父”UIViewController 中，以便与 UIPagecontrol 一起使用。这是在一个 UIViewController 中拥有多个 UIVIewController 的常用方法吗？我不确定这是否有效。

或者只是创建一个继承自 UIView 的类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T19:36:55.700

您可以拥有一个带有 uipagecontrol 和 uiscrollview 的容器视图控制器，它可以像 ios 中的天气应用程序一样保存您的小部件。根据不同的小部件，您需要实现不同的视图控制器并将它们的视图添加到滚动视图。如果您不实现不同的视图控制器，您可能由于您需要从单个视图控制器控制视图，因此难以处理您的子视图。

# javascript - javascript 如果变量为真

> ID：11867754
> 
> 赞同：3
> 
> 时间：2012-08-08T15:17:06.083
> 
> 标签：javascript

我不确定我是否误解了 True/False 在 Javascript 中的工作原理。在下面的 Jquery 脚本中，我将 6 个变量声明为 false。如果正则表达式验证条件良好，那么我将变量重新声明为 true。底部是一个简单的 alert() 来告诉我所有变量何时为真。

验证条件有效（删除/添加类），但未显示警报。这就是为什么我不确定我是否搞砸了真/假部分。

```
$('#password1').keyup(function() {
var checkLength = false;
var checkLetter = false;
var checkCaps = false;
var checkNum = false;
var checkSymbol = false;
var checkSpace = false;

var pswd = $(this).val();

//validate the length
if(pswd.length < 6 ){ 
 $('#length').removeClass('valid').addClass('invalid'); 
}else{ 
 $('#length').removeClass('invalid').addClass('valid'); 
 checkLength = true; 
}

//validate letter
if(pswd.match(/[A-Za-z]/)){ 
 $('#letter').removeClass('invalid').addClass('valid'); 
}else{ 
 $('#letter').removeClass('valid').addClass('invalid'); 
 checkLetter = true; 
}

//validate capital letter
if(pswd.match(/[A-Z]/)){ 
 $('#capital').removeClass('invalid').addClass('valid'); 
}else{ 
 $('#capital').removeClass('valid').addClass('invalid'); 
 checkCaps = true; 
}

//validate number
if(pswd.match(/\d/)){ 
 $('#number').removeClass('invalid').addClass('valid'); 
}else{ 
 $('#number').removeClass('valid').addClass('invalid'); 
 checkNum = true; 
}   

//validate symbols
if(pswd.match(/[^a-zA-Z0-9]/)){ 
 $('#symbol').removeClass('invalid').addClass('valid'); 
}else{ 
 $('#symbol').removeClass('valid').addClass('invalid'); 
 checkSymbol = true; 
}   

//validate no spaces
if(pswd.match(/\s/)){ 
 $('#spaces').removeClass('valid').addClass('invalid'); 
}else{ 
 $('#spaces').removeClass('invalid').addClass('valid'); 
 checkSpace = true; 
}

// here is where I'm concerned I'm wrong
if(checkLength == true && checkLetter == true && checkCaps == true && checkNum == true && checkSymbol == true && checkSpace == true){ 
    alert("All good"); 
}

}); 
```

有人会仔细检查我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T15:22:03.263

一开始，不需要写`checkLength == true`,`checkLength`就足够了，因为它们都是布尔变量。

其次，在您的某些情况下，您分配类`invalid`但将 var 设置为 true，而在其他情况下，反之亦然。每个都`check... = true`应该与`class = valid`. 另外，就我个人而言，我会调整有效性条件，让所有积极事件都在分支中`if`或`else`分支中，但不会像你现在那样混合。最后，我总是尽量避免重复代码。有很多地方可以重构，但您可以从在单独的函数中设置类开始轻松。

看到它**[在这个小提琴中](http://jsfiddle.net/poikl/FGVma/)**工作。

```
$('#password1').keyup(function() {
  var checkLength = false;
  var checkLetter = false;
  var checkCaps = false;
  var checkNum = false;
  var checkSymbol = false;
  var checkSpace = false;

  var pswd = $(this).val();

  //validate the length
  // reverse the condition, to have the valid state in the if branch as well
  if(pswd.length >= 6 ){ 
   setValid('#length'); 
   checkLength = true; 
  }else{ 
   setInvalid('#length');  
  }

  //validate letter
  if(pswd.match(/[A-Za-z]/)){
   setValid('#letter'); 
   checkLetter = true; 
  }else{ 
   setInvalid('#letter'); 
  }

  //validate capital letter
  if(pswd.match(/[A-Z]/)){ 
   setValid('#capital');
   checkCaps = true; 
  }else{ 
   setInvalid('#capital'); 
  }

  //validate number
  if(pswd.match(/\d/)){ 
   setValid('#number');
   checkNum = true;  
  }else{ 
   setInvalid('#number'); 
  }   

  //validate symbols
  if(pswd.match(/[^a-zA-Z0-9]/)){ 
   setValid('#symbol'); 
   checkSymbol = true; 
  }else{ 
   setInvalid('#symbol'); 
  }   

  //validate no spaces
  if(!pswd.match(/\s/)){
   setValid('#spaces'); 
   checkSpace = true;  
  }else{ 
   setInvalid('#spaces'); 
  }

  function setValid(e){$(e).removeClass('invalid').addClass('valid')} 
  function setInvalid(e){$(e).removeClass('valid').addClass('invalid')} 

  if(checkLength && checkLetter && checkCaps && checkNum && checkSymbol && checkSpace){ 
  alert("All good"); 
  }
  console.log("keyup");
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input id="password1" type="text">
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:21:08.120

所有这些都`check* = true`在错误的地方：

```
//validate letter
if(pswd.match(/[A-Za-z]/)){ 
 $('#letter').removeClass('invalid').addClass('valid'); 
}else{ 
 $('#letter').removeClass('valid').addClass('invalid'); 
 checkLetter = true; 
}

//validate capital letter
if(pswd.match(/[A-Z]/)){ 
 $('#capital').removeClass('invalid').addClass('valid'); 
}else{ 
 $('#capital').removeClass('valid').addClass('invalid'); 
 checkCaps = true; 
}

//validate number
if(pswd.match(/\d/)){ 
 $('#number').removeClass('invalid').addClass('valid'); 
}else{ 
 $('#number').removeClass('valid').addClass('invalid'); 
 checkNum = true; 
}   

//validate symbols
if(pswd.match(/[^a-zA-Z0-9]/)){ 
 $('#symbol').removeClass('invalid').addClass('valid'); 
}else{ 
 $('#symbol').removeClass('valid').addClass('invalid'); 
 checkSymbol = true; 
} 
```

将语句插入块中`if`（它们被认为是有效的）而不是`else`（它们被认为是无效的）：

```
//validate letter
if(pswd.match(/[A-Za-z]/)){ 
 $('#letter').removeClass('invalid').addClass('valid'); 
 checkLetter = true; 
}else{ 
 $('#letter').removeClass('valid').addClass('invalid'); 
}

//validate capital letter
if(pswd.match(/[A-Z]/)){ 
 $('#capital').removeClass('invalid').addClass('valid'); 
 checkCaps = true; 
}else{ 
 $('#capital').removeClass('valid').addClass('invalid'); 
}

//validate number
if(pswd.match(/\d/)){ 
 $('#number').removeClass('invalid').addClass('valid'); 
}else{ 
 $('#number').removeClass('valid').addClass('invalid'); 
 checkNum = true; 
}   

//validate symbols
if(pswd.match(/[^a-zA-Z0-9]/)){ 
 $('#symbol').removeClass('invalid').addClass('valid'); 
 checkSymbol = true; 
}else{ 
 $('#symbol').removeClass('valid').addClass('invalid'); 
} 
```

而且，尽管有更好的编写验证的方法，但这是一个类似但更简洁的代码段版本：

```
$("#password1").keyup(function() {
    var pswd = $(this).val();
    var checkLength = pswd.length >= 6;
    var checkLetter = /[A-Za-z]/.test(pswd);
    var checkCaps   = /[A-Z]/.test(pswd);
    var checkNum    = /\d/.test(pswd);
    var checkSymbol = /[^A-Za-z0-9]/.test(pswd);
    var checkSpace  = !/\s/.test(pswd);

    $("#length") .removeClass("valid invalid").addClass(checkLength ? "valid" : "invalid");
    $("#letter") .removeClass("valid invalid").addClass(checkLetter ? "valid" : "invalid");
    $("#capital").removeClass("valid invalid").addClass(checkCaps   ? "valid" : "invalid");
    $("#number") .removeClass("valid invalid").addClass(checkNum    ? "valid" : "invalid");
    $("#symbol") .removeClass("valid invalid").addClass(checkSymbol ? "valid" : "invalid");
    $("#spaces") .removeClass("valid invalid").addClass(checkSpace  ? "valid" : "invalid");

    if(checkLength && checkLetter && checkCaps && checkNum && checkSymbol && checkSpace) {
        alert("All good");
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:35:51.180

对我来说，您的作业似乎是有效的陈述。他们是否按照您想要的方式设置是另一回事。

很可能其中一个标志没有按照您希望的方式设置。要检查这一点，您可以提醒每个标志（checkCaps 等）以确认每个值都按您想​​要的方式设置。如果所有真/假都是正确的，那么问题将出现在您的最终 if 语句中。

正如许多人所建议的那样，删除`== true`是一个好主意。由于 Javascript 是动态类型的，因此*它*可能不会将您的标志视为布尔值，而是将其视为其他东西。

如果删除`== true`不起作用，您可以检查不同的标志对，看看哪一个使整个语句为假。

# xml - 在 Youtube XML 中获取未列出的视频

> ID：11867755
> 
> 赞同：0
> 
> 时间：2012-08-08T15:17:16.813
> 
> 标签：xml, youtube

我有问题。我想在网站上列出视频，所以我使用我帐户中的 XML 以我通过 HTML 和 PhP 控制的方式显示它们。一切正常，但我意识到未列出的视频没有显示在我的页面上的任何地方。

挖掘问题，我发现它们不在我从[http://gdata.youtube.com/feeds/api/users/fredy31/uploads获取的 XML 中](http://gdata.youtube.com/feeds/api/users/fredy31/uploads)

是否有另一个我可以调用的 XML 文件包含那些未列出的视频？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T15:39:53.107

获得不公开的视频是不可能的。

这就是它们未列出的原因：因此无法查询它们。

# php - facebook php sdk设置重定向网址

> ID：11867756
> 
> 赞同：0
> 
> 时间：2012-08-08T15:17:20.333
> 
> 标签：php, jquery, facebook-graph-api

我所做的是，

我首先使用 ajax 调用控制器/功能“用户/身份验证”

此函数从 sdk 获取 loginurl 并将其返回到 javascript 至极执行 window.open.href ...到目前为止 sogood.. 我被定向到 facebook 登录页面，

但是在成功登录后，它会重定向回相同的用户/身份验证。

问题：这是正常行为吗？或者我可以设置redirecturl ..

问题：它返回的 url 在问号之间没有斜线，因此该函数永远不会像这样“users/authenthicate?bladeblibla”那样被识别。

*我在注册应用程序时确实设置了一些网址，但那是一个完全不同的网址，例如“http://www.domain/users/facebook_login”*

谢谢理查德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:20:23.297

您可以按如下方式设置重定向 URI：

```
$linkToOauthDialog = $this->facebook->getLoginUrl(

  array(
     'scope'         =>  SCOPE_OF_THE_APP,
     'redirect_uri'  =>  REDIRECT_URI
  )

); 
```

您还应该记住，Safari 不允许在 iframe 中设置第三方 cookie，这就是为什么您需要先重定向到您自己的域，在其中设置 cookie 并再次重定向到 facebook。否则你最终会陷入无限循环。

我在这里更详细地描述了这种方法： [Safari 3rd party cookie iframe trick no longer working?](https://stackoverflow.com/questions/9930671/safari-3rd-party-cookie-iframe-trick-no-longer-working/10887116#10887116)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:23:19.743

是的，这是 php sdk 的默认行为。当您调用`getLoginUrl()`并且未在参数数组中指定`redirect_uri`at 时，它将尝试使用当前 url。

我认为您想要使用的是 JS sdk 的[FB.login()](http://developers.facebook.com/docs/reference/javascript/FB.login/)方法，而不是使用 window.open 进行重定向（将打开弹出窗口，但您会在页面的 js 中获得信息）。

# jsf-2 - Richfaces ajax 调用

> ID：11867759
> 
> 赞同：0
> 
> 时间：2012-08-08T15:17:31.770
> 
> 标签：jsf-2, richfaces, jboss7.x

迁移到 JBoss7 后，我在运行 JSF 应用程序时遇到问题。我正在使用 JSF2.0 和 Richfaces 4.2.2-Final。

将应用程序部署到 JBoss7 后，来自 Richfaces 组件的大多数 Ajax 调用停止工作，应用程序的行为非常奇怪。我们定义了两个适用于 JBoss6.1 的 jQuery 库：

虽然我在 Firebug 中看到两者都已加载，但当调用 ajax 调用时，我得到了与调用函数相关的 jQuery TypeError，例如：*$(".accordionWrapper").accordion is not a function*

奇怪的是 UI 上一些 Richfaces 组件的操作运行良好。谁能建议如何解决这个问题？

提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T18:01:17.963

几周前我遇到了类似的问题，使用这个完全相同的 RichFaces 版本。我不确定，但我认为它们与 RichFaces 问题[RF-12084](https://issues.jboss.org/browse/RF-12084)有关。

就我而言，我只是在`f:ajax`从以前的`a4j:commandLink`and切换到`a4j:ajax`.

在那个 RF 问题中，由于[JSF-2347](http://java.net/jira/browse/JAVASERVERFACES-2347)，评论中的某人建议切换到 JSF 2.1.8 ，因此您可以在弄乱您的代码之前尝试一下。

# silverlight - 如何将 TimePicker 值转换为 Windows Phone 7 的 unix 时间戳？

> ID：11867760
> 
> 赞同：0
> 
> 时间：2012-08-08T15:17:36.007
> 
> 标签：silverlight, windows-phone-7, unix-timestamp, timepicker

嗯。。

我还有一个问题。我需要将 TimePicker (Windows Phone 7) 值转换为 unix 时间戳。

这怎么可能？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:25:04.713

这应该有效：

```
DateTime selectedTime = ((DateTime) TimePicker.Value)

public static double ConvertToUnix (DateTime selDate)
{
    var unixStart = new DateTime (1970, 1, 1).ToLocalTime();
    return (selDate - unixStart).TotalSeconds;
} 
```

# iphone - 每次启动应用时播放声音

> ID：11867761
> 
> 赞同：0
> 
> 时间：2012-08-08T15:17:36.573
> 
> 标签：iphone, objective-c, ios, xcode

启动应用时有没有方便的播放声音的方法？我希望它*仅*在应用程序启动时播放，而不是在应用程序进入后台并退出后台状态时播放。

我可以在哪里放置代码的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:19:12.300

在您的应用程序委托中...

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T15:20:00.583

将您的声音代码添加到

`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`

该方法仅在应用程序首次打开时调用一次。

# javascript - javascript通过json对象移动如何判断元素是否存在

> ID：11867767
> 
> 赞同：0
> 
> 时间：2012-08-08T15:17:55.720
> 
> 标签：javascript, json

我正在遍历一个 json 对象，但由于一个额外的元素而失败。

见下面的代码

```
{
"rootLayout":"main",
"layoutDescriptions":[
      {
        "type":"Panel",
        "label":"Repeating Groups By Subform",
        "layout":"SimpleForm",
        "content":[
          { "type":"label", "constraint":"newline", "text":"Contacts" },
          { "type":"repeatableGroup", "property":"contacts", "contentRef":"ContactSubForm" }
        ]
      },
      {
        "type":"Panel",
        "label":"",
        "container" : {
          "type":"Panel",
          "layout":"SimpleForm",
          "content":[
            { "type":"label", "constraint":"newline", "text":"Contact Name" },
            { "type":"ListView", "property":"contactName", "listProps":["contactName","telephone","email"] }
          ]
        }
      }, 
```

它在数组中的第二个元素上失败我正在使用以下内容来获取我的结果

```
data.layoutDescriptions[0].container.content[i].content 
```

我知道它的停止是因为

```
data.layoutDescriptions[0].container.content[1].content 
```

它期望

```
data.layoutDescriptions[0].container.content[1].container.content 
```

所以我的问题是我该怎么说如果容器存在则执行此操作。

我现在正在尝试这个，但它不起作用。

```
 var contentObjects = data.layoutDescriptions[0].container.content[1].content;
if(contentObjects.container){
                 alert("container exists");
                 }
                         else{
                  alert("nope");
                  } 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:29:15.013

问题是并非数组`layoutDescriptions`中的每个对象都具有属性`container`。当您遍历第一个对象时，它会寻找`container`，没有找到任何东西，然后搜索`content`on `undefined`，引发错误。

此外，在里面`data.layoutDescriptions[0].container.content[1]`，你没有`content`属性。`contentObjects`设置为`undefined`，因此`contentObjects.container`将失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:29:23.593

使用 hasOwnProperty 检查对象是否存在自己的属性：

```
 var contentObjects = data.layoutDescriptions[0].container.content[1];
 if(contentObjects.hasOwnProperty('container'){
     alert("container exists");
 }
 else{
     alert("nope");
 } 
```

# sql-server - 结果到文本的最大字符数不起作用

> ID：11867771
> 
> 赞同：0
> 
> 时间：2012-08-08T15:18:08.000
> 
> 标签：sql-server, sql-server-2008, ssms

我不知道为什么 SQL Server Management Studio 即使在我设置为 3,000 后仍保持 256 的默认限制。我关闭它并再次打开，重新启动计算机（也许这将是一个愚蠢的缓存，你永远不知道..）但仍然无法正常工作。

有任何想法吗？

![管理工作室屏幕](../Images/4464f36127ddcaac06c360f44d37a35d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-08-12T14:06:54.930

我发现仅仅创建一个新的查询窗口就会应用新的限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:58:37.180

我在 sql server 2008 中尝试过，它工作正常。 [http://learningsqlserver.wordpress.com/2011/03/16/tips-for-querying-text-columns-in-ssms/](http://learningsqlserver.wordpress.com/2011/03/16/tips-for-querying-text-columns-in-ssms/)

# .htaccess - 将 URL 转换为 SEO 友好的 URL

> ID：11867777
> 
> 赞同：0
> 
> 时间：2012-08-08T15:18:29.677
> 
> 标签：.htaccess

如何使用 .htaccess 将我的网址转换为 SEO 友好的网址？

像这样的原始网址：

```
http://palestinianz.com/?page=person&p=10 
```

和

```
http://palestinianz.com/?page=persons&c=10 
```

第一个链接的重写 URL 是：

```
RewriteEngine On
RewriteRule ^([^/]*)/([^/]*)\.html$ /?page=$1&p=$2 [L] 
```

第一个链接的结果：

```
http://palestinianz.com/person/10.html 
```

如何将重定向规则写入重写的 url ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T18:22:58.133

看来您需要应用[我以前的答案](https://stackoverflow.com/a/11745914/851273)，将`person`to`persons`和`p`to更改为`c`：

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /\?page=persons&c=([^\ ]+)
RewriteRule ^$ /persons/%1.html? [R=301,L]
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /\?page=person&p=([^\ ]+)
RewriteRule ^$ /person/%1.html? [R=301,L] 
```

然后回来

```
RewriteRule ^persons/([^/]*)\.html$ /?page=persons&c=$1 [L]
RewriteRule ^person/([^/]*)\.html$ /?page=person&p=$1 [L] 
```

# jquery - JQuery在父div中选择文本

> ID：11867778
> 
> 赞同：1
> 
> 时间：2012-08-08T15:18:30.623
> 
> 标签：jquery, html, select, each

我目前有以下

```
<div class ="parent">
  <div class="inner">Hello
    <div>Goodbye</div>
  </div>
</div>

<div class ="parent">
  <div class="inner">Hello
    <div>Goodbye</div>
  </div>
</div> 
```

我目前正在`$(div.parent).each(function(index,item)`遍历每个完美运行的父级。

我的问题是我需要选择 hello 这个词。我目前正在使用`$(item).text()`，但它总是返回 HelloGoodBye，这是一个问题。我需要忽略任何其他 div。

任何帮助表示感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:53:39.157

`jQuery.text()`我建议不要使用该方法，而是找到第一个`childNode`您要查找的文本节点：

```
​var divs = document.getElementsByClassName('inner'),
    i = 0;
for (i = divs.length; i--;) {
  console.log(divs[i].childNodes[0]);   
} 
```

或者

```
var divs = $('.inner');
divs.each(function() {
  console.log(this.childNodes[0]);
}); 
```

请记住，该`childNodes`方法不会被 jQuery 识别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:21:02.020

尝试

```
$('div.parent').not('.parent .inner div').each(function(index,item) 
```

交替

```
$(div.parent:not('.inner div').each(function(index,item) 
```

[http://api.jquery.com/not/](http://api.jquery.com/not/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:26:44.277

这个主题之前已经讨论过很多合适的解决方案：[Using .text() to retrieve only text not nested in child tags](https://stackoverflow.com/questions/3442394/jquery-using-text-to-retrieve-only-text-not-nested-in-child-tags)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:31:16.667

您可以通过克隆每个元素、删除不需要的 div 然后抓取文本来实现此目的。

```
$('div.parent div.inner').each(function(index,item) {
    $this = $(item).clone();
    $this = $this.find('div').remove();
    $this.text();
});​ 
```

这是一个 JS Fiddle，上面的代码和 HTML 正在运行：http: [//jsfiddle.net/L8T7s/](http://jsfiddle.net/L8T7s/)

# mediaelement.js - mediaelement.js 和自定义播放列表

> ID：11867779
> 
> 赞同：12
> 
> 时间：2012-08-08T15:18:33.877
> 
> 标签：mediaelement.js, playlist, playlists

我有这样的代码（例如）：

```
<script>
$('audio').mediaelementplayer();
</script>

<audio id="mejs" controls="controls">
    <source src="/media/file-2.mp3" type="audio/mp3" />
</audio>

<ul class="mejs-list">
    <li>/media/file-1.mp3</li>
    <li class="current">/media/file-2.mp3</li>
    <li>/media/file-3.mp3</li>
</ul> 
```

我需要按队列（一个接一个）播放列表中的音频文件。

**播放完当前文件并开始播放下一个文件后，**如何更改列表中下一个文件的音频源？

 ****更新**：关于[mediaelement.js 和播放列表](https://stackoverflow.com/questions/6395265/how-can-i-get-html5-audio-playlist-with-mediaelement-js)的相关主题，但答案是关于使用许多 mediaelementplayer() 实例。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-09T17:53:25.257

**为 mediaelement.js**制作基本播放列表的代码：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>HTML5 MediaElement</title>

<script src="../build/jquery.js"></script>
<script src="../build/mediaelement-and-player.min.js"></script>

<link rel="stylesheet" href="../build/mediaelementplayer.min.css" />

<style>
    .mejs-list li:hover {
        background: #ffa;
        cursor: pointer;
    }
    .mejs-list li.current {
        background: #cddfff;
    }
</style>

<script>
    $(function(){
        $('video,audio').mediaelementplayer({
            success: function (mediaElement, domObject) {
                mediaElement.addEventListener('ended', function (e) {
                    mejsPlayNext(e.target);
                }, false);
            },
            keyActions: []
        });

        $('.mejs-list li').click(function() {
            $(this).addClass('current').siblings().removeClass('current');
            var audio_src = $(this).text();
            $('audio#mejs:first').each(function(){
                this.player.pause();
                this.player.setSrc(audio_src);
                this.player.play();
            });
        });

    });

    function mejsPlayNext(currentPlayer) {
        if ($('.mejs-list li.current').length > 0){ // get the .current song
            var current_item = $('.mejs-list li.current:first'); // :first is added if we have few .current classes
            var audio_src = $(current_item).next().text();
            $(current_item).next().addClass('current').siblings().removeClass('current');
            console.log('if '+audio_src);
        }else{ // if there is no .current class
            var current_item = $('.mejs-list li:first'); // get :first if we don't have .current class
            var audio_src = $(current_item).next().text();
            $(current_item).next().addClass('current').siblings().removeClass('current');
            console.log('elseif '+audio_src);
        }

        if( $(current_item).is(':last-child') ) { // if it is last - stop playing
            $(current_item).removeClass('current');
        }else{
            currentPlayer.setSrc(audio_src);
            currentPlayer.play();
        }
    }
</script>

</head>

<body>

<audio id="mejs" src="../media/audio-01.mp3" type="audio/mp3" controls="controls"></audio>
<ul class="mejs-list">
    <li class="current">../media/audio-01.mp3</li>
    <li>../media/audio-02.mp3</li>
    <li>../media/audio-03.mp3</li>
</ul>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-02T21:49:29.740

现在有一个插件可以解决这个任务 - [https://github.com/duozersk/mep-feature-playlist](https://github.com/duozersk/mep-feature-playlist)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-27T07:08:25.200

查看MediaElement.js的[YouTube 播放列表。](https://www.pakjiddat.pk/articles/view/261/youtube-playlist)它为 YouTube 视频提供播放列表，但可以轻松更新以支持其他视频格式**

# jsf - 提交后如何不关闭 Richfaces 弹出窗口？

> ID：11867781
> 
> 赞同：0
> 
> 时间：2012-08-08T15:18:40.193
> 
> 标签：jsf, popup, richfaces, submit

在我将表单放入其中后，如何防止 popupPanel 关闭？

我的按钮代码：

```
<h:commandButton value="Search" action="#{facesBean.search()}" >
<f:ajax execute="@form" render="result" />
</h:commandButton> 
```

我提交后要呈现的面板代码：

```
<h:panelGroup id="result" rendered="#{facesBean.list != null}">
TEST TO RERENDER
</h:panelGroup> 
```

它们采用相同的 h:form。

有什么不对？运行它时我没有收到任何错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:20:28.120

基本上有两种方式：

1.  只需通过ajax提交表单。
2.  如果由于某种原因无法通过 ajax 提交，只需在回发时重新打开弹出面板。

# c++ - AES CBC 加密/解密仅解密前 16 个字节

> ID：11867782
> 
> 赞同：5
> 
> 时间：2012-08-08T15:18:44.297
> 
> 标签：c++, openssl, aes

我正在使用 AES CBC 和 openssl 做一些工作，现在，我遇到了一个我无法猜测出什么问题的问题（一如既往）。

给定一条小于 16 字节长度的消息，加密和解密过程可以正常工作，但是当消息大于 16 字节时，解密仅在第 16 个第一个字节上工作。

当我调用`aes.exe stackoverflow stackoverflow`输出是：

```
Using:
IVector   = |000102030405060708090a0b0c0d0e0f|
Key       = |737461636b6f766572666c6f770d0e0f101112131415161718191a1b1c1d1e1f|
Encrypted = |6c65219594c0dae778f9b5e84f018db6|

Encrypting : stackoverflow
With Key   : stackoverflow
Becomes    :  ??????¤le!òö++þx¨ÁÞO?ìÂ.

Using:
IVector   = |000102030405060708090a0b0c0d0e0f|
Key       = |737461636b6f766572666c6f770d0e0f101112131415161718191a1b1c1d1e1f|
Decrypted = |737461636b6f766572666c6f77|

Decrypting :  ??????¤le!òö++þx¨ÁÞO?ìÂ
With Key   : stackoverflow
Becomes    : stackoverflow 
```

当我调用`aes.exe stackoverflowstackoverflow stackoverflow`输出是：

```
Using:
IVector   = |000102030405060708090a0b0c0d0e0f|
Key       = |737461636b6f766572666c6f770d0e0f101112131415161718191a1b1c1d1e1f|
Encrypted = |46172e3f7fabdcfc6c8b3e65aef175cddf8164236faf706112c15f5e765e49a5|

Encrypting : stackoverflowstackoverflow
With Key   : stackoverflow
Becomes    :  ??????¤F?.?¦½_³lï>e«±u-¯üd#o»pa?-_^v^IÑ.

Using:
IVector   = |000102030405060708090a0b0c0d0e0f|
Key       = |737461636b6f766572666c6f770d0e0f101112131415161718191a1b1c1d1e1f|
Decrypted = |737461636b6f766572666c6f77737461257d434a1edcbc970bf5346ea2fc7bc2|

Decrypting :  ??????¤F?.?¦½_³lï>e«±u-¯üd#o»pa?-_^v^IÑ
With Key   : stackoverflow
Becomes    : stackoverflowsta%}CJ?_+ù?§4nó³{-. 
```

我为每个加密/解密调用提供一个随机 IV，并在这两种情况下将密码标准化为 32 个字节；我错过了什么？有谁知道？

源代码：

```
#include <vector>
#include <string>
#include <iostream>

// Make a Key of exactly 32 bytes, truncates or adds values if it's necessary
std::string AES_NormalizeKey(const void *const apBuffer, size_t aSize)
{
    static const unsigned char key32[] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31};
    const char *const Buffer = reinterpret_cast<const char *>(apBuffer);
    std::string Result(reinterpret_cast<const char *>(key32), 32);
    std::copy(Buffer, Buffer + ((aSize < 32)? aSize: 32), Result.begin());
    return Result;
}

// Encrypt using AES cbc
std::string AESEncrypt(const void *const apBuffer, size_t aBufferSize, const void *const apKey, size_t aKeySize, std::string &aIVector)
{
    // Create IVector.
    unsigned char AES_IVector[16] = {0};
    std::srand(static_cast<int>(time(NULL)));
    std::generate(std::begin(AES_IVector), std::end(AES_IVector), std::rand);
    std::copy(std::begin(AES_IVector), std::end(AES_IVector), aIVector.begin());

    // Create key.
    const std::string Key(AES_NormalizeKey(apKey, aKeySize));
    AES_KEY EncryptKey;
    AES_set_encrypt_key(reinterpret_cast<const unsigned char *>(Key.c_str()), 256, &EncryptKey);

    // Encrypt.
    unsigned char AES_Encrypted[1024] = {0};
    AES_cbc_encrypt(static_cast<const unsigned char *>(apBuffer), AES_Encrypted, aBufferSize, &EncryptKey, AES_IVector, AES_ENCRYPT);
    const std::string Encrypted(reinterpret_cast<const char *>(AES_Encrypted), ((aBufferSize / 16) + 1) * 16);

    // Finish.
    return Encrypted;
};

// Decrypt using AES cbc
std::string AESDecrypt(const void *const apBuffer, size_t aBufferSize, const void *const apKey, size_t aKeySize, std::string &aIVector)
{
    // Read IVector.
    unsigned char AES_IVector[16] = {0};
    std::copy(aIVector.begin(), aIVector.end(), std::begin(AES_IVector));

    // Create Key.
    const std::string Key(AES_NormalizeKey(apKey, aKeySize));
    AES_KEY DecryptKey;
    AES_set_decrypt_key(reinterpret_cast<const unsigned char *>(Key.c_str()), 256, &DecryptKey);

    // Decrypt.
    unsigned char AES_Decrypted[1024] = {0};
    AES_cbc_encrypt(static_cast<const unsigned char *>(apBuffer), AES_Decrypted, aBufferSize, &DecryptKey, AES_IVector, AES_DECRYPT);
    const std::string Decrypted(reinterpret_cast<const char *>(AES_Decrypted));

    // Finish.
    return Decrypted;
};

// Entry point
int main(unsigned int argc, char **argv)
{
    typedef std::vector<const std::string> vs;
    vs a;

    for (vs::size_type Index = 0; Index < argc; ++Index)
    {
        a.push_back(argv[Index]);
    }

    if (a.size() == 3)
    {
        std::string IV("");

        std::string e(AESEncrypt(a.at(1).c_str(), a.at(1).size(), a.at(2).c_str(), a.at(2).size()), IV);
            std::cout << "Encrypting : " << a.at(1) << "\n"
                      << "With Key   : " << a.at(2) << "\n"
                      << "Becomes    : " << e << ".\n";

        std::string d(AESDecrypt(e.c_str(), e.size(), a.at(2).c_str(), a.at(2).size()), IV);
            std::cout << "Decrypting : " << e << "\n"
                      << "With Key   : " << a.at(2) << "\n"
                      << "Becomes    : " << d << ".\n";
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-19T16:30:46.950

您的代码几乎是正确的，除了初始化向量由于内存损坏而被覆盖，密文的长度被错误地舍入，并且应该使用 std::string::data() 而不是 std::string::c_str () 当使用 std::string 作为字节数组时。初始化向量被复制到覆盖堆栈的空字符串中。然后初始化向量被覆盖，因此 AESDecrypt 使用不同的值。我已经包含了包含indiv 建议并修复这些问题的源代码。当运行时

```
aes“世界你好！” 堆栈溢出
```

它产生以下输出：

```
（标准化密钥：737461636b6f766572666c6f770d0e0f101112131415161718191a1b1c1d1e1f）
加密：你好世界！
带键：stackoverflow
初始化 Vec：d8b1657d9e2317c93430994f59bb54eb
变成：��Йw�H���}�;E
（标准化密钥：737461636b6f766572666c6f770d0e0f101112131415161718191a1b1c1d1e1f）
解密：��Йw�H���}�;E
带键：stackoverflow
初始化 Vec：d8b1657d9e2317c93430994f59bb54eb
变成：世界你好！

```

```
#include <vector>
#include <string>
#include <iostream>
#include <iomanip>
#include <algorithm>
#include <initializer_list>
#include <openssl/aes.h>

typedef unsigned char byte;

template <size_t multiple> size_t round_up(const size_t len)
{
    if (len % multiple == 0) return len;
    else return ((len / multiple) + 1) * multiple;
}

std::ostream &print_buffer_as_hex(std::ostream &o, const unsigned char *buf, size_t size)
{
    o << std::hex << std::setfill('0');
    for( size_t i = 0; i < size; ++i )
    {
        o << std::setw(2) << static_cast<unsigned int>(buf[i]);
    }
    return o << std::dec;
}

inline std::ostream &operator<<(std::ostream &o, const std::vector<byte> &buf)
{
    return print_buffer_as_hex(o, reinterpret_cast<const unsigned char*>(&buf[0]), buf.size());
}

// Make a Key of exactly 32 bytes, truncates or adds values if it's necessary
std::string AES_NormalizeKey(const void *const apBuffer, size_t aSize)
{
    static const unsigned char key32[] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31};
    const char *const Buffer = reinterpret_cast<const char *>(apBuffer);
    std::string Result(reinterpret_cast<const char *>(key32), 32);
    std::copy(Buffer, Buffer + ((aSize < 32)? aSize: 32), Result.begin());
    return Result;
}

// Encrypt using AES cbc
std::string AESEncrypt(const void *const apBuffer, size_t aBufferSize, const void *const apKey, size_t aKeySize, std::vector<byte> &aIVector)
{
    // Create IVector.
    unsigned char AES_IVector[AES_BLOCK_SIZE] = {0};
    std::srand(static_cast<int>(time(NULL)));
    std::generate(std::begin(AES_IVector), std::end(AES_IVector), std::rand);
    aIVector.resize(sizeof(AES_IVector));
    std::copy(std::begin(AES_IVector), std::end(AES_IVector), aIVector.begin());

    // Create key.
    const std::string Key(AES_NormalizeKey(apKey, aKeySize));
    std::cout << "(Normalized key: ";
    print_buffer_as_hex(std::cout, (const unsigned char*)Key.data(), Key.size()) << ")\n";
    AES_KEY EncryptKey;
    AES_set_encrypt_key(reinterpret_cast<const unsigned char *>(Key.data()), 256, &EncryptKey);

    // Encrypt.
    unsigned char AES_Encrypted[1024] = {0};
    AES_cbc_encrypt(static_cast<const unsigned char *>(apBuffer), AES_Encrypted, aBufferSize, &EncryptKey, AES_IVector, AES_ENCRYPT);
    const std::string Encrypted(reinterpret_cast<const char *>(AES_Encrypted), round_up<AES_BLOCK_SIZE>(aBufferSize));

    // Finish.
    return Encrypted;
};

// Decrypt using AES cbc
std::string AESDecrypt(const void *const apBuffer, size_t aBufferSize, const void *const apKey, size_t aKeySize, std::vector<byte> &aIVector)
{
    // Read IVector.
    unsigned char AES_IVector[AES_BLOCK_SIZE] = {0};
    std::copy(aIVector.begin(), aIVector.end(), std::begin(AES_IVector));

    // Create Key.
    const std::string Key(AES_NormalizeKey(apKey, aKeySize));
    std::cout << "(Normalized key: ";
    print_buffer_as_hex(std::cout, (const unsigned char*)Key.data(), Key.size()) << ")\n";
    AES_KEY DecryptKey;
    AES_set_decrypt_key(reinterpret_cast<const unsigned char *>(Key.data()), 256, &DecryptKey);

    // Decrypt.
    unsigned char AES_Decrypted[1024] = {0};
    AES_cbc_encrypt(static_cast<const unsigned char *>(apBuffer), AES_Decrypted, aBufferSize, &DecryptKey, AES_IVector, AES_DECRYPT);
    const std::string Decrypted(reinterpret_cast<const char *>(AES_Decrypted));

    // Finish.
    return Decrypted;
};

// Entry point
int main(int argc, char **argv)
{
    typedef std::vector<std::string> vs;
    vs a;

    for (vs::size_type Index = 0; Index < static_cast<unsigned>(argc); ++Index)
    {
        a.push_back(argv[Index]);
    }

    if (a.size() == 3)
    {
        std::vector<byte> IV;

        std::string e(AESEncrypt(a.at(1).data(), a.at(1).size(), a.at(2).data(), a.at(2).size(), IV));
            std::cout << "Encrypting : " << a.at(1) << "\n"
                      << "With Key   : " << a.at(2) << "\n"
                      << "Init Vec   : " << IV << "\n"
                      << "Becomes    : " << e << "\n";

        std::string d(AESDecrypt(e.data(), e.size(), a.at(2).data(), a.at(2).size(), IV));
            std::cout << "Decrypting : " << e << "\n"
                      << "With Key   : " << a.at(2) << "\n"
                      << "Init Vec   : " << IV << "\n"
                      << "Becomes    : " << d << "\n";
    }
    std::cout.flush();

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T17:43:06.993

我没有具体的答案，但这里有一个不适合评论的提示。加密和解密需要相同的密钥和 IV 才能工作。加密函数的输出必须进入解密函数的输入。

因此，要调试您的问题，您需要将您的输入打印到 encrypt 函数并打印其输出。然后您需要将输入数据打印到解密函数并打印其输出。纯文本是一种不好的方法，因为您看不到字节的真正含义。因此，将密钥、IV 和数据打印为十六进制值。

```
#include <iostream>
#include <iomanip>
...
std::ostream &print_buffer_as_hex(std::ostream &o, const unsigned char *buf, size_t size)
{
    for( int i = 0; i < size; ++i )
    {
        o << std::hex << std::setw(2) << std::setfill('0') << static_cast<unsigned int>(buf[i]) << std::dec;
    }
    o << "\n";

    return o;
} 
```

像这样称呼它：

```
print_buffer_as_hex(std::cout, reinterpret_cast<const char *>(AES_Encrypted), ((aBufferSize / 16) + 1) * 16); 
```

我会使用`std::vector<unsigned char>`而不是`std::string`保存任意字节。使用构造函数或`resize()`方法设置所需的空间量（resize()，而不是 reserve()！）。如果您调用需要 的 API 函数`unsigned char *`，只需传递`&vec[0]`，其中 vec 是您的矢量对象。你的代码看起来会干净很多。

例如，

```
std::vector<unsigned char> iv(16);
std::srand(static_cast<int>(time(NULL)));
std::generate(iv.begin(), iv.end(), std::rand);

print_buffer_as_hex(std::cout, &iv[0], iv.size()); 
```

# sql - 尝试在 ANSI SQL 中将 VARCHAR 转换/转换为 DATETIME 时出错

> ID：11867788
> 
> 赞同：1
> 
> 时间：2012-08-08T15:18:57.907
> 
> 标签：sql, teradata-aster

我在一个表中有一个列，其中时间戳已以 VARCHAR 格式存储，但我需要将这些与另一个表中的 DATETIME 值列进行比较以查找时间间隔，因此我想将 VARCHAR 时间戳转换或转换为 DATETIME。但是，铸造和转换都给我带来了问题。

VARCHAR 时间戳的格式如下所示： `"29/07/2012 01:53:36 +12"`.

使用查询：

```
SELECT CAST(event_timestamp AS datetime) FROM the_table 
```

产生`ERROR: date/time field value out of range: "29/07/2012 01:53:36 +12"`.

使用查询：

```
SELECT CONVERT(datetime, event_timestamp, 131) from the_table; 
```

生产

```
ERROR:  syntax error at or near ","
LINE 1: select CONVERT(datetime, event_timestamp, 131) from the_tab...
                               ^ (note: this is pointing at the first comma). 
```

即使您使用通用函数（例如`getdate()`数据源），CONVERT 的错误也会发生。这个数据库使用 ANSI SQL-92（或者我被告知）。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:55:26.130

这似乎真的很痛苦，但以下应该有效：

```
select dateadd(hh, cast(right(tv, 3) as int),
               CONVERT(datetime, left(tv, 10), 103)+CONVERT(datetime, substring(tv, 12, 8), 108)
              )
from (select '29/07/2012 01:53:36 +12' as tv) t 
```

我以前从未添加过日期时间，但这仅适用于 SQL Server 2008。

为什么 SQL Server 不能只支持围绕 yyyy、mm、mmm、dd 等构建的灵活表示法？

实际的数据库是 Aster Data，它基于 Postgres（与最新的数据库引擎一样）。在此数据库中，您将使用 to_timestamp()。请参阅此处的文档[http://www.postgresql.org/docs/8.2/static/functions-formatting.html](http://www.postgresql.org/docs/8.2/static/functions-formatting.html)。调用将类似于：

```
to_timestamp(val, 'MM/DD/YYYY HH:MI:SS tz') -- not sure if this gets the +12 
```

没有用于日期转换的 ANSI 函数，因此每个数据库都有自己的功能。甚至字符串函数也因数据库而异（substr？substring？charindex？instr？location？），所以没有 ANSI 方法可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:29:16.277

您使用了错误的语法，请尝试：

```
CONVERT(varchar(X), datetimeValue, 131) 
```

其中 X 是所需的字符总数。

然后，您将能够使用`datetimeValue`和搜索匹配`event_timestamp`项，假设每个值共享相同的结构。这将允许您将字符串与字符串进行匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:31:53.927

如果我没记错的话，标准（ANSI SQL）CAST 运算符总是期望 ISO 格式的时间/日期/时间戳文字（'YYYY-MM-DD'）

但是根据Teradata V12的手册（无法测试），CAST运算符的格式是

```
CAST(character_expression AS TIMESTAMP timestamp_data_attribute) 
```

是`date_data_attribute`一个字符值加上一个可选的格式说明符。

所以在你的情况下，这可能是：

```
cast(event_timestamp AS TIMESTAMP FORMAT 'MM/DD/YYYY HH:MI:SS Z'); 
```

不过，我并不完全确定格式定义。你可能需要调整它

顺便说一句：`CONVERT`不是标准的 SQL 函数。它是特定于 SQL Server 的。

# jquery - 连接并构建 URL

> ID：11867791
> 
> 赞同：0
> 
> 时间：2012-08-08T15:19:05.637
> 
> 标签：jquery, backbone.js, mustache

当用户单击表格元素时，我试图让用户访问某个 URL。使用 Mustache 模板，我有以下内容：

```
{{#each data.Items}}            
<tr>                                        
<td data-url="/Test/Email/Edit/" + {{this.Id}}>
<span class="link">{{this.Name}}</span>
</td>
</tr> 
```

data-url 始终返回“/Test/Email/Edit/”，最后忽略 Id 部分。如何使 data-url 连接 Id 部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:21:35.550

```
<td data-url="/Test/Email/Edit/{{this.Id}}"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:27:47.433

```
{{#data.Items}}
  <tr>                                        
    <td data-url="/Test/Email/Edit/{{Id}}">
      <span class="link">{{Name}}</span>
    </td>
  </tr> 
{{/data.Items}} 
```

# python - python - 如何在不定义新函数的情况下使用生成器创建另一个生成器？

> ID：11867794
> 
> 赞同：2
> 
> 时间：2012-08-08T15:19:09.060
> 
> 标签：python, generator

假设我有一个迭代生成器的 for 循环，并且在这个循环中我正在构建一个列表以供以后使用：

```
q = []
for index, val in enumerate(['a', 'b', 'c']):
    q.append(index+val) 
```

我想**保留**生成器而不创建这样的函数：

```
def foo(gen):
    for index, val in gen:
        yield index+val 
```

这完全有可能还是我在这里看不到一些固有的问题？
我想它应该看起来像这样：

```
iter_q = something()
for index, val in enumerate(['a', 'b', 'c']):
    q.add_iteration(index+val) 
```

好的，既然我已经写了这个，它看起来确实是不可能的（或无用的），因为这个 for 循环必须在“生成器”准备好之前遍历整个列表，这使得它只是一个预制列表的迭代器，而不是对象有用意义上的生成器。

无论如何发布，因为我自己找不到这样的问题。*（另外，也许有人还有一些有趣的事情要说）*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:50:03.620

如果我正确理解了您的问题，我认为您可能想要一个[生成器表达式](http://docs.python.org/tutorial/classes.html#generator-expressions)：

```
q = (index + val for index, val in enumerate(someOtherGenerator)) 
```

该语句创建一个新的生成器`q`，它将像您的`foo`函数返回的生成器一样工作。您也不需要将其分配给变量，您可以在任何地方创建生成器表达式，例如在函数调用中：

```
doSomethingWithAGenerator(i+v for i,v in enumerate(someOtherGenerator)) 
```

有些类型的生成器不能在生成器表达式中创建，但最常见的类型可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:27:14.993

我是这样看的：这[`itertools.cycle`](http://docs.python.org/library/itertools.html#itertools.cycle)可能是一个函数在迭代器上循环同时假装不耗尽它的最佳示例。它最终创建了整个事物的完整副本。如果`itertools`不能做得更好，可能没有其他（通用）解决方案。

# dynamics-crm - CRM2011 Workflow：如果在工作流启动后更新工作流条件中使用的字段会怎样？

> ID：11867800
> 
> 赞同：8
> 
> 时间：2012-08-08T15:19:30.523
> 
> 标签：dynamics-crm, dynamics-crm-2011

示例：假设我有一个工作流程，在保修结束日期前 2 天发送电子邮件。此工作流在实体的“创建”时触发。

```
step 1: wait condition - process timeout < (warrantyendate - 2)
     after wait: send email. 
```

因此，当创建记录时，工作流就会启动。但是当用户返回并更新保修结束日期时会发生什么。

***工作流程是否检查更新的保修结束日期，还是仍使用触发时输入的结束日期（即初始创建值）？***

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T18:28:00.073

我的理解是工作流在执行时使用系统中的数据。

这里需要注意的重要一点是，一个工作流可以执行多次，此时系统中的数据可能不同。Crm 缓存工作流的状态，但不缓存数据。[Microsoft Dynamics CRM 2011 的流程架构](http://msdn.microsoft.com/en-us/library/gg309387.aspx)对此进行了描述。

因此，每次检查进程超时条件时，都会使用当前值warrantyEndDate。如果值更改，则下次检查条件时将使用新值。

在任何情况下，正如@BenPatterson1 所建议的那样，您最好只是进行测试以确定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T20:09:15.137

自己尝试后，如果条件中包含的字段的值发生变化，工作流引擎将从睡眠（等待）中启动并再次检查条件。

如果满足条件，则继续下一步或继续等待。

# javascript - javascript eval - 如何为对象属性赋值？

> ID：11867805
> 
> 赞同：0
> 
> 时间：2012-08-08T15:19:45.887
> 
> 标签：javascript

> **可能重复：**
> [动态对象属性名称](https://stackoverflow.com/questions/4244896/dynamic-object-property-name)

我有一个像这样的对象

```
var localAppConfig = {
    wallet:0,
    paySomeone:0,
    payBills:0,
    accounts:0,
    moveMoney:0,
    alerts:0,
    offers:0,
    checkIn:0
}; 
```

我想为此中的特定元素设置值 1`localAppConfig`

需要设置的元素是`json`从服务器到达的 - 中检索的。

比如说，我想为 wallet、paySomeone、payBills、alerts、offers、checkIn 设置 value = 1

这些都是从`json`类似的

```
for(var i=0;i<len;i++){
        var name = list[i].handle;
        var accessor = eval('localAppConfig.'+name);
        eval('localAppConfig.'+name)=1;
    } 
```

`var name`包含元素的名称，我能够正确访问它的值，

如何使用 javascript 设置值？

我试过`accessor=1`但它不起作用。

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:21:41.003

你应该这样做：

```
var accessor = localAppConfig[name];
localAppConfig[name] = 1; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T15:23:26.203

无论如何：试试这个尺寸：

```
localAppConfig[name] = 1;//where name is a variable of choice, it's value will be used as the propertyname 
```

然后再次：

- 当你只有评估锤时，一切看起来都像你的拇指。——Brendan Eich 回应：我们应该鼓励使用 eval() 而不是 Function 构造函数来动态创建函数。

但是为什么要使用属性列表呢？您不妨使用`for...in`循环：对于像您这样的对象，完全可以。
只要您检查`.hasOwnProperty`，也：

```
for (var prop in localAppConfig)
{
    if (localAppConfig.hasOwnProperty(name))
    {
        //set, delete... do whatever
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:23:10.283

尝试`localAppConfig[name] = 1;`

它只是一个 javascript 对象，无需`eval()`在其上使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:21:54.003

不要使用`eval()`. 您可以通过在对象中引用该值的索引来添加属性。如果它不存在，那么它将被创建，否则该值将被覆盖。

请尝试以下操作：

```
// localAppConfig[list[i].handle] = 1; 

for(var i=0;i<len;i++){         
    localAppConfig[list[i].handle] = 1;
} 
```

或者，如果您打算在另一个地方引用该变量，则设置一个值为 的变量`list[i].handle`：

```
for(var i=0;i<len;i++){
    var name = list[i].handle;        
    var accessor = localAppConfig[name];    
    localAppConfig[name] = 1;
} 
```

# security - 嵌入式系统的数字证书

> ID：11867806
> 
> 赞同：1
> 
> 时间：2012-08-08T15:19:48.790
> 
> 标签：security, https, cryptography, embedded

我负责部署大量嵌入式设备，想添加https。

我做了一些谷歌搜索，有点困惑我的计划到底在哪里落空。

1.  获得由信誉良好的 CA 签署的证书
2.  使用对应的私钥为每台设备签署新的证书
3.  用户连接到设备（例如 192.168.1.40）并收到 2 个证书
4.  用户的浏览器验证设备的证书。由我公司发行
5.  用户的浏览器验证我的公司认证。由信誉良好的 CA 颁发

有人可以戳几个洞吗？

类似的问题[在这里](https://stackoverflow.com/questions/7196728/advanced-ssl-intermediate-certificate-authority-and-deploying-embedded-boxes)

# perl - 在浏览器 Perl CGI SSH 中显示输出

> ID：11867815
> 
> 赞同：1
> 
> 时间：2012-08-08T15:20:16.857
> 
> 标签：perl, ssh, cgi, openssh

我正在使用 Web 前端使用 Net::OpenSSH 执行远程命令。我的命令在命令行上没有失败地返回，但我在网络浏览器中什么也得不到。我做了几个小时的研究无济于事——有什么想法吗？

这里有一些代码给你一个例子（一些明显的原因被删除了）。

```
#!/usr/bin/perl -w
use strict;
use CGI ':standard';
use Net::OpenSSH;
# Here in the code is just the header and standard tags
print "1";
print "2"; # both display
my $ssh = Net::OpenSSH->new($host, user => $uname, key_path => $key); # all works
$ssh- error and die "Can't ssh to host" . $ssh->error;
print "3";
$ssh->system("uname -a") or
die "remote command failed: " . $ssh->error;
my @lsa = $ssh->capture("ls -a");
$ssh->error and
die "remote ls command failed: ". $ssh->error;

print "4";
print "5"; 
print @lsa; # won't display in browser, just terminal/CLI 
```

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:22:22.157

我维护 CGI.pm。我建议将这些添加到您的简单脚本中：

1.  在打印任何其他内容之前，请打印标准 HTTP 标头`print header()`：
2.  在以下行之后添加`use CGI`：`use CGI::Carp qw(fatalsToBrowser);`... 这将在浏览器中显示任何运行时问题。如果在这些更改后您没有得到任何输出，请检查脚本是否与`perl -cw script.pl`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T12:28:25.750

也许您的错误会指向标准错误，而不是标准输出。在这种情况下，它们通常会出现在服务器日志中，而不是浏览器窗口中。也许你可以使用`POSIX::dup2`来避免这种情况：

```
use POSIX;

# Make sure to send HTTP headers before redirecting streams!

POSIX::close(2);  # close original stderr stream. No more output to apache logs!!!
POSIX::dup2(1,2); # redirect error stream to standard output, so errors will appear in browser. 
```

perl 启动的进程，例如一些 ssh 二进制文件，将继承这些流。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T20:20:35.983

下面是关于在 Debian 机器上为我工作的最小 Perl 代码。我建议您仔细阅读它并将其与您的实际代码进行比较。

但是，它在我的 Debian 上并没有开箱即用，我做出了一些决定，其中大部分可能不是很安全，但这更多的是关于特定环境：

*   为服务器运行可写的用户创建主页 (/var/www)
*   预先将主机添加到 ~/.ssh/known_hosts
*   使用`strict_mode => 0`绕过`Net::OpenSSH`的安全检查，而不是找到正确的 `ctl_dir`（`Net::OpenSSH`要求文件夹*和所有以上文件夹*都是 0755 或更严格，所以我使用的 /tmp 通常不够好）

我相信有比这更安全的做法，但正如我所说，这是特定于环境的。

所以代码：

```
#!/usr/bin/perl
use strict;
use warnings;

use Net::OpenSSH;
use File::Temp qw/ tempdir /;

# necessary minimum for CGI
print "Content-type: text/plain\n\n";

# prepare temp dir
my $temp = tempdir("/tmp/sshme.pl-XXXXXXXX", CLEANUP => 1);

# open SSH session
my %opts = (
    user        => "user",
    password    => "password",
    ctl_dir     => $temp,
    strict_mode => 0            ## NOT recommended - see my comments
);
my $ssh = Net::OpenSSH->new("host", %opts);
$ssh->error
    and die "Couldn't establish SSH connection: ". $ssh->error;

# perform command and print output
my @lines = $ssh->capture("ls")
    or die "remote command failed: " . $ssh->error;
print @lines; 
```

# html - 用于单独回车的 CSS 空白预包装规则

> ID：11867821
> 
> 赞同：3
> 
> 时间：2012-08-08T15:20:37.950
> 
> 标签：html, css, newline

将单独的回车字符放入格式为 的 HTML 块中是否有效`white-space: pre-wrap`？

我有一个应用程序正在接收 SOAP 消息，并将消息记录到文件中。我们的日志代码总是去掉换行符，所以在 Unix 上，这是一个单行日志条目。传入的消息是 Windows 格式的 CRLF，所以在剥离换行符后，我只剩下一个回车符。

应用程序上的日志查看器屏幕显示一个表格，其中包含具有`white-space: pre-wrap`格式的日志条目。至少在我的浏览器上，这看起来很棒，单独的回车与换行符或 CRLF 的工作方式相同。

这是可靠的行为吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-08T18:20:57.193

是的，它是有效的。using`white-space: pre-wrap;`与 using 完全相同`<pre>`，只是它会根据其父级的边界自然换行。

但是，您应该考虑确保您的 CSS 是跨浏览器兼容的。

```
#log {
    white-space: pre-wrap;       /* CSS3 */
    white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */
    white-space: -pre-wrap;      /* Opera 4-6 */
    white-space: -o-pre-wrap;    /* Opera 7 */
    word-wrap: break-word;       /* Internet Explorer 5.5+ */
} 
```

`white-space: pre;`如果您希望行推动其父项的边界以将输出中的所有内容保持在一行中，您也可以使用

# ruby-on-rails - 渲染一个模型，比如 include

> ID：11867822
> 
> 赞同：1
> 
> 时间：2012-08-08T15:20:41.027
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我想知道如何在我的头文件中呈现搜索模型。很像 php 中的包含，但使用 rails 我想将新表单呈现到我的标题中。我的搜索风格基于此视频[http://railscasts.com/episodes/111-advanced-search-form-revised](http://railscasts.com/episodes/111-advanced-search-form-revised)但不确定如何将代码呈现到我的标题中。任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:25:52.970

部分呢？

[文档](http://guides.rubyonrails.org/layouts_and_rendering.html)

你可以这样做：

```
<%= render "shared/search", :locals => { :search_string => @search_string } %> 
```

这将呈现`app/views/shared/_search.html.erb`文件中的内容。

# mysql - 使用转义逗号将 SQL 表导出到 CSV？

> ID：11867825
> 
> 赞同：1
> 
> 时间：2012-08-08T15:20:49.763
> 
> 标签：mysql, csv

我有一个大型 MySQL 表（8-9k 记录，我正在使用 phpMyAdmin），其中一些值是描述，带有逗号。

我需要将 SQL 表导出为 CSV 格式以在新平台上使用，但我终生无法解决此问题：

当某些字段中有逗号时，数据会被推到下一列，事情就会变得乱七八糟。

我只需要 MySQL 中的 EXACT 表就可以变成 CSV。任何提示，想法？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T15:25:08.633

使用此查询：

```
SELECT * INTO OUTFILE 'filename.csv'
FIELDS TERMINATED BY ','
OPTIONALLY ENCLOSED BY '"'
ESCAPED BY '\\'
LINES TERMINATED BY '\n'
FROM [tablename] 
```

**来源**：[http ://www.wausita.com/2011/02/mysql-export-csv/](http://www.wausita.com/2011/02/mysql-export-csv/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T15:22:53.767

只需转到数据库的*导出*选项卡。请务必**附上您的字段。**这种方式值被包裹`"`以避免错误的逗号。

否则，您可以`mysqldump`从命令行使用。

或者您可以使用查询导出数据：

```
SELECT *
FROM table
INTO OUTFILE '/tmp/table.csv'
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T16:27:29.377

我的解决方案是从 MySQL 导出为 .xlsx。列完美呈现。使用封闭/转义字符的*几种*组合无济于事。

然后我将 .xlsx 保存为 .csv ，这很好。

谢谢你们的时间。

# backbone.js - 使用 Parse.com/backbone.js 建模友谊关系

> ID：11867830
> 
> 赞同：2
> 
> 时间：2012-08-08T15:20:58.663
> 
> 标签：backbone.js, parse-platform

我正在尝试使用 Parse.com javascript API（基本上是骨干模型）来模拟友谊。我正在使用内置的 Parse.com 用户类。我有一个 mySQL / 关系数据库模型背景，发现将我的想法转变为非 sql / 非规范化方式很棘手。

它应该支持标准的 facebook 风格方法： - 用户 a 可以请求用户 b 的友谊 - 用户 b 可以接受或忽略友谊请求

对于给定的用户，我希望能够获取他们朋友的集合（双向接受的友谊）。

我一直在考虑使用 Friendships 模型并将用户模型引用为发起者和接受者：

```
initiator | acceptor | status
==========+==========+========
user a    | user b   | accepted
user b    | user c   | 
user c    | user a   | accepted 
```

我不确定这是否是最好的方法，也不确定是否使用 ACL 保护它。我担心友谊中的两个用户都需要能够更新行 - 以删除友谊。此外，用户 b 不应该能够向 Parse API 发出会泄露其他用户友谊的请求。

要查询用户 a 的朋友，我会执行两个查询，一个查询用户 a 是接受者的位置，一个查询发起者的位置。

有人可以评论这是否是一种可接受的建模方式，或者如果不是为什么不建议改进。谢谢！

2012 年 8 月 8 日更新：我在这里看到的一个问题：如果我在 Friendships 类的每一行上设置一个 ACL，以便发起者可以写入该行，并且它是公开可读的 - 那么接受者将无法更新该行状态 = 接受。

友谊可以建模为表格中的两行吗？例如：

```
initiator | acceptor | status
==========+==========+========
user a    | user b   | requested
user b    | user a   | accepted 
```

不知道我将如何查询以获取给定用户的朋友！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T09:16:17.183

我决定使用 Parse CloudCode 来实现这一点，以简化数据安全性，并锁定所有客户端对 Friend 类的写访问。

我有三个云代码功能... `friendRequest`, `friendDelete`, `friendAccept`. 这些函数使用万能钥匙对朋友类进行所有写操作。阅读 ACL 将添加到友谊中两个用户的每一行 - 因此您只能查看自己的友谊。

# .net - 使用 C# 从 Active Directory 获取组织单位

> ID：11867837
> 
> 赞同：3
> 
> 时间：2012-08-08T15:21:12.407
> 
> 标签：.net, active-directory, ldap, directoryservices

我想在我正在构建的 ASP.NET Web 窗体站点上区分两种不同类型的用户。

所有用户都在我的 AD 中，我区分两者的方法是将它们放在两个不同的组织单元中，称为：**LRDB**和**IPPDB**。

当我尝试使用此 LDAP 路径在登录时验证它们时：

```
<add name="ADConnectionString" connectionString="LDAP://test.example.com:389/DC=test,DC=com,OU=IPPDB" /> 
```

我收到一个服务器错误消息：

*说明：处理服务此请求所需的配置文件期间发生错误。请查看下面的具体错误详细信息并适当地修改您的配置文件。*

*解析器错误消息：发生操作错误。*

我的会员提供者所在的行突出显示为错误的来源。

```
<add enableSearchMethods="true" connectionStringName="ADConnectionString" name="MembershipADProvider" type="System.Web.Security.ActiveDirectoryMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" /> 
```

但是，当我更改我的 LDAP 路径以排除 OU 部分时，它“有效”。从某种意义上说，AD 内的任何人都经过身份验证，而不仅仅是组织单位内的成员。

如果我无法避免这整个混乱，我在想也许我可以允许 LDAP 路径没有 OU，然后一旦确定用户是 AD 的一部分，它就会检查它是哪个 OU部分。但是，我没有看到 OU 的属性。[这就是我希望代码的样子。](http://pastebin.com/Ubbpr8xg)有没有办法从用户那里获取 OU？

谢谢您的帮助！

-----------------**解决方案**------------------

感谢 marc_s：

我相信应该是

```
connectionString="LDAP://test.example.com:389/OU=IPPDB,DC=test,DC=com" 
```

`OU=`首先在`DC=`零件之前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T21:53:30.190

*   `ou=ippdb,dc=test,dc=com`是一个*专有名称*。
*   专有名称由一系列相对专有名称 (RDN) 构成，并用逗号 (,) 分隔。
*   相对专有名称是从属性值断言构造的，其中断言的左侧是没有选项的属性描述（意味着`cn;lang-en=Bart Simpson`不是有效的相对专有名称，但`cn=Bart Simpson`有效），右侧是根据构造的属性属性描述的语法。
*   用作左侧的属性描述必须有一个`equality matching rule`.
*   在相对专有名称中，左侧（属性描述）通常称为`naming attribute`.

构造可分辨名称使得直接上级 RDN 位于其直接下级 RDN 的右侧（以逗号分隔）。在给出的示例中（假设`dc=test,dc=com`在目录信息树中处于上级的正常约定），`ou=ippdb`然后将立即从属于`dc=test`.

# jboss7.x - JBoss EAP 6 / JBoss AS 7 的 OpenAM/OpenSSO 代理

> ID：11867838
> 
> 赞同：4
> 
> 时间：2012-08-08T15:21:22.223
> 
> 标签：jboss7.x, agent, opensso, openam

我想将 OpenAM/OpenSSO SSO 功能添加到 JBoss EAP 6 或 JBoss AS 7。这意味着我必须在 JBoss 上安装 SSO Java EE 代理。[Forgerock 的 OpenAM 下载页面](http://www.forgerock.org/openam.html)提供了获取以前版本 JBoss 的代理的机会，但不支持新的 JBoss EAP 6 / JBoss AS 7（目前）。

你知道这样的代理是否在某个地方可用，或者在不久的将来会可用吗？如果没有，您知道如何更改 JBoss 配置以使其与 OpenAM 一起使用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T11:30:05.230

目前似乎没有 JBoss EAP 6 的官方代理。

但是，我可以通过手动配置我的 JBoss 实例使其与 OpenAM SSO 一起使用。为此，我从 forgerock 下载站点上现有的 jboss_v42_agent.zip 开始。使用 jars agent.jar、openssoclientsdk.jar 和代理配置文件，我可以使用这个 module.xml 构建一个 JBoss 模块：

```
<?xml version="1.0" encoding="UTF-8"?>
<module xmlns="urn:jboss:module:1.1" name="openam.agents">
  <resources>
    <resource-root path="agent.jar"/>
    <resource-root path="openssoclientsdk.jar"/>
    <resource-root path="."/>
  </resources>
   <dependencies>
    <module name="javax.api"/>
    <module name="javax.servlet.api" />
    <module name="org.picketbox"/>
  </dependencies>
</module> 
```

然后我必须通过添加安全域来更新standalone.xml：

```
 <security-domain name="AMRealm" cache-type="default">
    <authentication>
      <login-module code="com.sun.identity.agents.jboss.v40.AmJBossLoginModule" flag="required">
        <module-option name="unauthenticatedIdentity" value="anonymous"/>
      </login-module>
      <login-module code="org.jboss.security.ClientLoginModule" flag="required">
        <module-option name="restore-login-identity" value="true"/>
      </login-module>
    </authentication>
  </security-domain> 
```

最后，在通过添加一行修改 MANIFEST.MF 后，我在 JBoss 上部署了 agentapp.war：

```
Dependencies: openam.agents 
```

其中 openam.agents 是我的模块的名称。

现在对于我要启用 SSO 的应用程序，我还必须执行一些更新：

1.  **web.xml**：添加和节点：

    ```
    <filter>
      <filter-name>Agent</filter-name>
      <display-name>Agent</display-name>
      <description>OpenAM Tomcat Policy Agent Filter</description>
      <filter-class>com.sun.identity.agents.filter.AmAgentFilter</filter-class>
    </filter>
    <filter-mapping>
      <filter-name>Agent</filter-name>
      <url-pattern>/*</url-pattern>
      <dispatcher>REQUEST</dispatcher>
      <dispatcher>INCLUDE</dispatcher>
      <dispatcher>FORWARD</dispatcher>
      <dispatcher>ERROR</dispatcher>
    </filter-mapping> 
    ```

2.  **jboss-web.xml**：声明要使用的安全域

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <jboss-web>
      <security-domain>AMRealm</security-domain>
    </jboss-web> 
    ```

3.  **MANIFEST.MF**：应用与 agentapp.was 相同的修改（添加“Dependencies：openam.agents”行）

我不确定这是否是在 JBoss EAP 6 / AS 7 上启用 SSO 的最佳方式（我不是专家），但它似乎运作良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T04:45:39.580

一个想法是放置一个安装了 OpenAM 策略代理的 Apache http 服务器，以便在 Jboss 7 前面获取请求。

这称为反向代理集成。您可以在这里找到更多信息：http: [//developers.sun.com/identity/reference/techart/app-integration.html](http://developers.sun.com/identity/reference/techart/app-integration.html) 和[http://docs.oracle.com/cd/E19575-01/820-3746/gjbna /index.html](http://docs.oracle.com/cd/E19575-01/820-3746/gjbna/index.html)

使用反向代理方法，您不必关心应用程序的运行时环境。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-14T09:40:29.993

几天前我注意到forgerock 现在已经为JBoss 7.x 发布了一个J2EE 代理，但我还没有测试它。见[http://forgerock.org/openam.html](http://forgerock.org/openam.html)

# html - 将 HTML 转换为 DOCX

> ID：11867839
> 
> 赞同：-1
> 
> 时间：2012-08-08T15:21:21.993
> 
> 标签：html, maven, docx, doc, file-conversion

我正在寻找将文档转换为`HTML`文档的所有现有可能性`DOCX`。

**语境 ：**

我有一些用 HTML 编写和维护的文档（没有复杂的东西，只是简单`H1`的 , `H2`, `P`,`IMG`元素），我想将它们转换成`word`文档。

一个`Maven`插件会很棒，或者可以让我在应用程序的发布阶段进行这种转换的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T22:53:09.767

**披露：docx4j 是“我的”项目**

对于格式良好的 XHTML，docx4j 可以做到这一点。请参阅[ConvertInXHTML* 示例](https://github.com/plutext/docx4j-ImportXHTML/tree/master/src/samples/java/org/docx4j/samples)。

docx4j-ImportXHTML 位于 Maven 中心：[https ://search.maven.org/artifact/org.docx4j/docx4j-ImportXHTML/8.0.0/jar](https://search.maven.org/artifact/org.docx4j/docx4j-ImportXHTML/8.0.0/jar)

如果你想要一个 Maven 插件，你必须自己创建它。

# sql-server - SSRS 恢复为父安全

> ID：11867850
> 
> 赞同：0
> 
> 时间：2012-08-08T15:21:38.633
> 
> 标签：sql-server, sql-server-2008, ssrs-2008, reporting-services

我有 50 多个报告部分，它们将特定的 AD 组分配给它们作为浏览器。

这是因为只有某些人才能访问数据。

为此，在安全设置上，我通过单击“编辑项目安全性”进行了更改

这导致 SSRS 不再继承安全性（即，如果我为项目文件夹添加个人 AD 名称，他们将被授予访问所有内容的权限）

所以我所有的报告部分都有单独的组，问题是我现在需要让 1 个人访问所有内容。

使用当前设置，这意味着将它们一一添加到所有报告部分，但是有一个名为“恢复为父安全性”的按钮。

我的问题是，如果我单击此按钮，它将删除我已应用的所有个人组安全设置，还是允许我向所有人添加 1 人，同时让所有其他人保持不变？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T20:15:04.850

根据联机丛书 ( [http://msdn.microsoft.com/en-us/library/ms180265.aspx](http://msdn.microsoft.com/en-us/library/ms180265.aspx) ) `Revert to Parent Security`将删除所有单独的组安全设置

> 单击可将安全设置重置为直接父文件夹的安全设置。如果在整个报表服务器文件夹层次结构中继承未中断，则使用顶级文件夹 Home 的安全设置。

在您的场景中，您似乎必须将用户单独添加到每个安全项目。您可以使用 Reporting Services 脚本主机以编程方式执行此操作（有关某些示例脚本，请参阅[http://msftrsprodsamples.codeplex.com/wikipage?title=SS2008%21Script%20Samples%20%28Reporting%20Services%29 ）或 Powershell（请参阅](http://msftrsprodsamples.codeplex.com/wikipage?title=SS2008%21Script%20Samples%20%28Reporting%20Services%29)[使用 Powershell在 Reporting Services](https://stackoverflow.com/questions/3066869/using-powershell-to-set-user-permissions-in-reporting-services)中为示例设置用户权限）

# postgresql - PostgreSQL 中的继承和关系

> ID：11867853
> 
> 赞同：3
> 
> 时间：2012-08-08T15:21:47.367
> 
> 标签：postgresql, inheritance, relationship

我对 SQL 代码有一些问题。

序列和表创建，一些数据插入：

```
CREATE SEQUENCE tmp_id_places START 1;
CREATE SEQUENCE tmp_id_books START 1;

CREATE TABLE tmp_places (
  id int PRIMARY KEY DEFAULT nextval('tmp_id_places'),
  name text
);

CREATE TABLE tmp_cities (population int) INHERITS (tmp_places);
CREATE TABLE tmp_rivers (lenght int) INHERITS (tmp_places);

INSERT INTO tmp_cities (name, population) VALUES
  ('Moscow', 15),
  ('St. Petersburg', 9);

INSERT INTO tmp_rivers (name, lenght) VALUES
  ('Volga', 115),
  ('Angara', 319);

CREATE TABLE tmp_books (
  id int PRIMARY KEY DEFAULT nextval('tmp_id_books'),
  id_place int REFERENCES tmp_places(id),
  title text
); 
```

Вut 此代码出错：

```
INSERT INTO tmp_books (title, id_place) VALUES
  ('Some book about Moscow', 1),
  ('Another book about Angara', 4); 
```

表**tmp_books**包含有关地点的信息。但我无法在其中插入数据，因为主表**tmp_places**中没有任何数据（子表中的所有数据）。

那么这无论如何都可以解决吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T13:42:35.870

仔细查看PostrgeSQL 文档中的[这一部分](http://www.postgresql.org/docs/current/interactive/ddl-inherit.html)。如果您将数据插入到子表中，则*只能*在子表中找到数据。另一方面，插入主表会使新行在所有子表中也可见。因此，您必须*始终*在第一手的主表上工作。

我前段时间一直在处理继承问题，也面临同样的问题。我最终得到以下结果：

1.  `INSERT`一个新的条目`tmp_places`；
2.  `UPDATE`额外的字段，比如说，`tmp_cities`带有它们各自的值。

回到 7.4 时代，我不得不为此类活动创建一组函数。现在可以使用statement 和[CTE的](http://www.postgresql.org/docs/current/interactive/sql-update.html)[`RETURNING`子句`INSERT`](http://www.postgresql.org/docs/current/interactive/sql-insert.html)（也在[SQL Fiddle](http://www.sqlfiddle.com/#!1/cf0f9/3)上）： [`UPDATE`](http://www.postgresql.org/docs/current/interactive/sql-update.html)

```
WITH theid AS (
  INSERT INTO tmp_places (name) VALUES ('Moscow') RETURNING id
)
UPDATE tmp_cities tc SET population = 15
  FROM theid
 WHERE tc.id = theid.id; 
```

您还应该小心约束，因为并非所有约束都是继承的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:30:46.947

丹尼斯，

继承不会在 Postgres 的 INSERT 和 COPY 语句中传播。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T12:06:22.923

在 PostgreSQL 中，您不应该为父表创建外键，因为正如您所发现的，该表几乎充当视图而不是表（因为实际数据位于它们各自的子表中）。目前只能通过触发器来解决。

您可以看到这种“触发器类型”的[示例。](https://stackoverflow.com/questions/9110559/equivalent-plpgsql-trigger-in-c)

# android - Android - 自定义 ViewGroup 上的滚动条

> ID：11867854
> 
> 赞同：1
> 
> 时间：2012-08-08T15:21:51.677
> 
> 标签：android, android-layout

我一直在我的项目中使用 Android Masonry (http://code.google.com/p/android-masonry/)。我注意到在添加了很多包含位图的视图后，我的内存不足。我认为这是因为视图组将其所有子项保存在内存中，即使它们没有显示在屏幕上。有人告诉我，我需要处理此代码，以通过使不在屏幕中的视图无效来优化内存。

我尝试使用此代码做的第一件事是删除包装 Masonry 视图组的 ScrollView，但发生的情况是我没有得到任何滚动条。当没有包装此组件的 ScrollView 时，我可以在 Masonry.java 中做些什么来使其可滚动吗？一旦我让滚动条工作，我就可以开始思考如何管理应该回收的视图。

谢谢

# facebook - 为多个域验证应用程序

> ID：11867855
> 
> 赞同：4
> 
> 时间：2012-08-08T15:21:51.803
> 
> 标签：facebook, oauth

我已经构建了一个小型 FB 应用程序，其目的是获取用户的公共个人资料 URL。我使用了提供的[客户端身份验证示例](https://developers.facebook.com/docs/authentication/client-side/)，它工作得很好。我还在 Facebook.com 上设置了一个应用程序，因此我可以提供一个 APP ID。为此，我将 App Domains 留空，并将应用程序类型设为“使用 Facebook 登录的网站”。然后我提供“站点 URL”，即回调。

![在此处输入图像描述](../Images/b8c915468647be56b1772528ab9fb164.png)

我的问题是我的 Web 应用程序跨多个域运行。个人客户在我们的主域上有自己独特的子域。我是否必须为每个子域创建一个新应用程序？现在看起来就是这样，这将导致数百个（可能是数千个）应用程序只是为了获得每个客户域的有效回调 URL。

有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:04:06.040

> 为此，我将 App Domains 留空

您可能需要重新考虑这一点；特别是您可能想*阅读*悬停在`[?]`节目上的“App Domain”参数的解释文本......</p>

# git - 头总是指向遥控器上的主人吗？

> ID：11867859
> 
> 赞同：1
> 
> 时间：2012-08-08T15:22:01.680
> 
> 标签：git

在这篇[文章](https://stackoverflow.com/questions/5582208/checkout-git-tag/5582368#5582368)中，我们解释了 HEAD 是一个指针。但我很困惑，我检查了我的仓库，我有'remotes/origin/master'和'remotes/origin/HEAD'。我们可以将远程头指向某个地方，以表明克隆存储库的用户已经在另一个分支上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:59:23.813

看到[这个答案](https://stackoverflow.com/a/3302018/912144)。它指向你[这篇文章](http://feeding.cloud.geek.nz/2008/12/setting-default-git-branch-in-bare.html)和[这个其他答案](https://stackoverflow.com/a/1485590/912144)。对于 GitHub 存储库，您也可以按照[这个答案](https://stackoverflow.com/a/6838756/912144)。

简而言之，如果您有权访问远程存储库，则可以在远程存储库本身上执行此操作：

```
git symbolic-ref HEAD refs/heads/mybranch 
```

或者在 GitHub 上，[通过 admin page](https://github.com/blog/421-pick-your-default-branch)执行此操作。

# r - 相对于字符引用列表对数据框进行排序/排序

> ID：11867861
> 
> 赞同：3
> 
> 时间：2012-08-08T15:22:04.360
> 
> 标签：r, dataframe

考虑这两个 df 示例

```
df1=data.frame(names=c('a','b','c'),value=1:3)
df2=data.frame(names=c('c','a','b'),value=1:3) 
```

以便

```
> df1
  names value
1     a     1
2     b     2
3     c     3
> df2
  names value
1     c     1
2     a     2
3     b     3 
```

现在，我想将 排序为与 中的列`df1`相同的顺序，以获得`names``df2`

```
names value
c     3
a     1
b     2 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T15:26:19.787

尝试

```
df1[match(df2$names,df1$names),]

> df1[match(df2$names,df1$names),]
  names value
3     c     3
1     a     1
2     b     2 
```

# c# - 在 ASP.NET 页面上获取 PageRequestManagerServerErrorException

> ID：11867862
> 
> 赞同：0
> 
> 时间：2012-08-08T15:22:06.387
> 
> 标签：c#, asp.net, ajax, webforms

我收到以下错误：

```
Sys.WebForms.PageRequestManagerServerErrorException: The state information is invalid for this page and might be corrupted. 
```

在我单击以下按钮后：

```
<input type="submit" class="buttonFormPrimary" id="ctl00_contentBlockPlaceHolder_lvQuals_ctrl7_btnClose" onclick="showhide(qComment_353);" value="Close" name="ctl00$contentBlockPlaceHolder$lvQuals$ctrl7$btnClose"> 
```

正在创建以下控件：

```
<asp:Button runat="server" ID="btnClose" Text="Close" CssClass="buttonFormPrimary" OnClientClick='<%#Eval("Qual_ID","showhide(qComment_{0})") %>' /> 
```

由于我没有开发应用程序，我不太确定如何调试错误。

# ios - 在 peoplePickerNavigationController 中选择人员后显示自定义视图

> ID：11867865
> 
> 赞同：0
> 
> 时间：2012-08-08T15:22:13.843
> 
> 标签：ios

我遇到了我认为是一项非常基本的任务的麻烦。在 peoplePickerNavigationController:peoplePicker:shouldContinueAfterSelectingPerson: 我想显示我自己的视图而不是标准的人视图。我正在使用情节提要，但不要认为我可以在这里简单地手动切换到一个窗口，所以我想我需要创建一个带有视图控制器的新 XIB。我将视图控制器的类设置为我在 IB 中的自定义视图控制器。然后在 peoplePickerNavigationController:peoplePicker:shouldContinueAfterSelectingPerson: 我在做：

```
MyVC *myVC = [[MyVc alloc] initWithNibName:@"XIBFileName" bundle:nil];
[self presentModalViewController:myVC animated:YES]; 
```

在我的视图控制器中，initWithNibName 被调用，但不是 viewDidLoad。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:25:49.987

只是尝试`[peoplePickerVC presentModalViewController:myVC]`而不是自我呈现。

问题是 peoplepickerviewcontroller 将位于导航堆栈的顶部。因为你已经展示了自己的人物选择器。在这种情况下，您将无法从 self 呈现/推送，因为它不在导航堆栈的顶部。

否则，一旦弹出人物选择器，您就可以从自我中进一步呈现。

# html - iis 7中的网站未显示到浏览器

> ID：11867866
> 
> 赞同：0
> 
> 时间：2012-08-08T15:22:18.900
> 
> 标签：html, iis

我有一个用 HTML5 编写的网站，并且已经将它添加到 iis7。我检查以确保路径是正确的，并且路径和身份验证都被 iis 报告为正确的。我有一个用于托管网站的个人 DNS，并且我在 IIS 中的网站由该 DNS 托管。每当我去浏览该站点时，Internet Explorer 都会返回一个页面，说它无法连接到该页面。它不会让我诊断任何连接问题。知道可能出了什么问题以及如何解决吗？

# php - 使用 curl 作为 fgetcsv 的 fopen 文件资源的替代方法

> ID：11867870
> 
> 赞同：7
> 
> 时间：2012-08-08T15:22:29.317
> 
> 标签：php, curl, fopen, fgetcsv

是否可以制作 curl，访问 url 并将结果作为文件资源？就像 fopen 是如何做到的。

我的目标：

1.  解析 CSV 文件
2.  将其传递给 fgetcsv

我的障碍：fopen 被禁用

我的代码块（在 fopen 中）

```
$url = "http://download.finance.yahoo.com/d/quotes.csv?s=USDEUR=X&f=sl1d1t1n&e=.csv";
$f = fopen($url, 'r');
print_r(fgetcsv($f)); 
```

然后，我在 curl 上尝试这个。

```
$curl = curl_init();
curl_setopt($curl, CURLOPT_VERBOSE, true);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, false);
curl_setopt($curl, CURLOPT_POST, true);
curl_setopt($curl, CURLOPT_POSTFIELDS, $param);
curl_setopt($curl, CURLOPT_URL, $url);
$content = @curl_exec($curl);
curl_close($curl); 
```

但是，像往常一样。$content 已经返回一个字符串。

现在，curl 是否可以将它作为文件资源指针返回？就像fopen一样？使用 PHP < 5.1.x 的东西。我的意思是，不使用 str_getcsv，因为它只有 5.3。

我的错误

> 警告：fgetcsv() 期望参数 1 是资源，给定的布尔值

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-08T15:30:56.727

假设`fopen is disabled`你的意思是“`allow_url_fopen`被禁用”，结合`CURLOPT_FILE`和[`php://temp`](http://php.net/manual/en/wrappers.php.php)使这相当容易：

```
$f = fopen('php://temp', 'w+');

$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_FILE, $f);
// Do you need these? Your fopen() method isn't a post request
// curl_setopt($curl, CURLOPT_POST, true);
// curl_setopt($curl, CURLOPT_POSTFIELDS, $param);
curl_exec($curl);
curl_close($curl);

rewind($f);

while ($line = fgetcsv($f)) {
  print_r($line);
}

fclose($f); 
```

基本上这会创建一个指向“虚拟”文件的指针，并且 cURL 将响应存储在其中。然后，您只需将指针重置为开头，就可以将其视为像往常一样打开它`fopen($url, 'r');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:28:53.527

您可以使用创建一个临时文件`fopen()`，然后`fwrite()`将内容放入其中。之后，新创建的文件将可供`fgetcsv()`. 该[`tempnam()`](http://php.net/manual/en/function.tempnam.php)函数应处理任意临时文件的创建。

根据评论[`str_getcsv()`](http://php.net/manual/en/function.str-getcsv.php)，无法访问该命令的用户可以尝试以下功能。评论中还有其他各种方法，请务必查看它们。

```
function str_getcsv($input, $delimiter = ',', $enclosure = '"', $escape = '\\', $eol = '\n') {
    if (is_string($input) && !empty($input)) {
        $output = array();
        $tmp    = preg_split("/".$eol."/",$input);
        if (is_array($tmp) && !empty($tmp)) {
            while (list($line_num, $line) = each($tmp)) {
                if (preg_match("/".$escape.$enclosure."/",$line)) {
                    while ($strlen = strlen($line)) {
                        $pos_delimiter       = strpos($line,$delimiter);
                        $pos_enclosure_start = strpos($line,$enclosure);
                        if (
                            is_int($pos_delimiter) && is_int($pos_enclosure_start)
                            && ($pos_enclosure_start < $pos_delimiter)
                            ) {
                            $enclosed_str = substr($line,1);
                            $pos_enclosure_end = strpos($enclosed_str,$enclosure);
                            $enclosed_str = substr($enclosed_str,0,$pos_enclosure_end);
                            $output[$line_num][] = $enclosed_str;
                            $offset = $pos_enclosure_end+3;
                        } else {
                            if (empty($pos_delimiter) && empty($pos_enclosure_start)) {
                                $output[$line_num][] = substr($line,0);
                                $offset = strlen($line);
                            } else {
                                $output[$line_num][] = substr($line,0,$pos_delimiter);
                                $offset = (
                                            !empty($pos_enclosure_start)
                                            && ($pos_enclosure_start < $pos_delimiter)
                                            )
                                            ?$pos_enclosure_start
                                            :$pos_delimiter+1;
                            }
                        }
                        $line = substr($line,$offset);
                    }
                } else {
                    $line = preg_split("/".$delimiter."/",$line);

                    /*
                     * Validating against pesky extra line breaks creating false rows.
                     */
                    if (is_array($line) && !empty($line[0])) {
                        $output[$line_num] = $line;
                    } 
                }
            }
            return $output;
        } else {
            return false;
        }
    } else {
        return false;
    }
} 
```

# c++ - 使用 QNX RTOS 实时接收 UDP 数据包

> ID：11867871
> 
> 赞同：8
> 
> 时间：2012-08-08T15:22:30.427
> 
> 标签：c++, udp, real-time, interrupt, qnx

我有一个以 819.2 Hz (~1.2ms) 的速率向我的 QNX Neutrino 机器发送 UDP 数据包的源。我希望以尽可能少的延迟和抖动接收和处理这些消息。

我的第一个代码基本上是：

```
SetupUDPSocket(); 
while (true) {
    recv(socket, buffer, BufferSize, MSG_WAITALL); // blocks until whole packet is received
    processPacket(buffer);
} 
```

问题是 recv() 仅在系统的每个计时器滴答时检查是否有新的数据包可用。计时器滴答声通常为 1ms。所以，如果我使用它，我会得到很大的抖动，因为我每 1 毫秒或每 2 毫秒处理一个数据包。我可以重置计时器刻度的大小，但这会影响整个系统（以及其他进程的其他计时器等）。而且我仍然会有抖动，因为我肯定不会完全匹配 819.2 Hz。

于是，我尝试使用网卡的中断线（5）。但似乎还有其他因素导致中断上升。我曾经遵循以下代码：

```
ThreadCtl(_NTO_TCTL_IO, 0);
SIGEV_INTR_INIT(&event);
iID = InterruptAttachEvent(IRQ5, &event, _NTO_INTR_FLAGS_TRK_MSK);

while(true) {
    if (InterruptWait(0, NULL) == -1) {
        std::cerr << "errno: " << errno << std::endl;
    }

    length = recv(socket, buffer, bufferSize, 0); // non-blocking this time

    LogTimeAndLength(); 

    InterruptUnmask(IRQ5, iID;
} 
```

这会导致在开始时进行一次成功读取，然后在经过 0 次后读取 0 字节长度。看来，在执行 InterruptUnmask() 之后，InterruptWait() 根本不等待，所以必须已经有一个新的中断（或相同的？！）。

是否可以用网卡的中断线做类似的事情？是否还有其他可能以 819.2 Hz 的速率接收数据包？

关于网卡的一些信息：'pci -vvv' 输出：

```
Class          = Network (Ethernet)
Vendor ID      = 8086h, Intel Corporation 
Device ID      = 107ch,  82541PI Gigabit Ethernet Controller
PCI index      = 0h
Class Codes    = 020000h
Revision ID    = 5h
Bus number     = 4
Device number  = 15
Function num   = 0
Status Reg     = 230h
Command Reg    = 17h
I/O space access enabled
Memory space access enabled
Bus Master enabled
Special Cycle operations ignored
Memory Write and Invalidate enabled
Palette Snooping disabled
Parity Error Response disabled
Data/Address stepping disabled
SERR# driver disabled
Fast back-to-back transactions to different agents disabled
Header type    = 0h Single-function
BIST           = 0h Build-in-self-test not supported
Latency Timer  = 40h
Cache Line Size= 8h un-cacheable
PCI Mem Address = febc0000h 32bit length 131072 enabled
PCI Mem Address = feba0000h 32bit length 131072 enabled
PCI IO Address  = ec00h length 64 enabled
Subsystem Vendor ID = 8086h
Subsystem ID        = 1376h
PCI Expansion ROM = feb80000h length 131072 disabled
Max Lat        = 0ns
Min Gnt        = 255ns
PCI Int Pin    = INT A
Interrupt line = 5
CPU Interrupt  = 5h
Capabilities Pointer = dch
Capability ID        = 1h - Power Management
Capabilities         = c822h - 28002000h
Capability ID        = 7h - PCI-X
Capabilities         = 2h - 400000h
Device Dependent Registers:
0x040:  0000 0000 0000 0000   0000 0000 0000 0000 
...
0x0d0:  0000 0000 0000 0000   0000 0000 01e4 22c8 
0x0e0:  0020 0028 0700 0200   0000 4000 0000 0000 
0x0f0:  0500 8000 0000 0000   0000 0000 0000 0000 
```

和“nicinfo”输出：

```
wm1: 
    INTEL 82544 Gigabit (Copper) Ethernet Controller

    Physical Node ID ........................... 000E0C C5F6DD
    Current Physical Node ID ................... 000E0C C5F6DD
    Current Operation Rate ..................... 100.00 Mb/s full-duplex
    Active Interface Type ...................... MII
    Active PHY address ....................... 0
    Maximum Transmittable data Unit ............ 1500
    Maximum Receivable data Unit ............... 0
    Hardware Interrupt ......................... 0x5
    Memory Aperture ............................ 0xfebc0000 - 0xfebdffff
    Promiscuous Mode ........................... Off
    Multicast Support .......................... Enabled 
```

谢谢阅读！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T05:30:23.867

我不太确定为什么*“问题是如果有新的数据包可用，recv() 只会在系统的每个计时器滴答声中检查。计时器滴答声通常是 1 毫秒。”* 对于抢占式操作系统来说是正确的。系统配置中一定有问题，或者网络协议栈实现有问题。

几年前，当我为 Yahoo BB Japan 做一些 IPTV STB 项目时，我遇到了 RTP 接收问题。问题不在于延迟或抖动，而是在我们添加一些 NDS 算法后，STB 中的整体系统性能。我们使用的是vxWorks，vxWorks支持ethernet hook接口，驱动每次接收到一个ethernet packet都会调用这个接口。

我将一个 API 连接到其中，然后直接从以太网数据包中解析具有指定端口的 UDP。当然，我们有一些假设没有碎片，这是由网络设置保证的性能问题。也许您还可以检查一下是否可以在 QNX 以太网驱动程序中获得相同的挂钩。至少您发现抖动是否来自驱动程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T09:48:09.810

How big are your UDP packets ? If the packet size is small you will gain greater efficiency by packing more data into single packet and decreasing transmission rate.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T04:06:07.710

抱歉，我参加聚会有点晚了，但是我遇到了您的问题，发现这与我遇到的情况相似。您可以尝试使用信号的软件中断，而不是硬件中断。QNX 在这里有一些文档：[http](http://www.qnx.com/developers/docs/qnx_4.25_docs/qnx4/sysarch/microkernel.html#IPCSIGNALS) ://www.qnx.com/developers/docs/qnx_4.25_docs/qnx4/sysarch/microkernel.html#IPCSIGNALS 。我当时使用的是 CentOS，但理论是一样的。根据[http://www.qnx.com/developers/docs/6.3.0SP3/neutrino/lib_ref/s/socket.html](http://www.qnx.com/developers/docs/6.3.0SP3/neutrino/lib_ref/s/socket.html)您可以使用 ioctl() 为给定文件描述符的 SIGIO 信号设置接收组...在您的情况下为 UDP 套接字。当套接字有准备好读取的数据时，会向 ioctl() 指示的进程发送一个 SIGIO 信号。使用 sigaction() 告诉操作系统使用什么信号处理函数。在您的情况下，信号处理程序可以从套接字读取数据并将其存储在缓冲区中进行处理。使用 pause() 暂停进程，直到它处理 SIGIO 信号。当信号处理程序返回时，进程将被唤醒，您可以处理缓冲区中的数据。这应该允许您处理传入的数据，而无需处理计时器或硬件中断。需要注意的一件事是，您的系统可以像 UDP 流量进入一样快地处理这些信号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T22:22:24.940

我怀疑中断服务路由（ISR）没有屏蔽中断。也许它是为边缘敏感而设计的，而中断是电平敏感的。

# c# - 将 2 个字段添加到 2 个内容类型给出：对象自上次获取以来已被另一个用户更新

> ID：11867873
> 
> 赞同：0
> 
> 时间：2012-08-08T15:22:35.890
> 
> 标签：c#, sharepoint, sharepoint-2010

我正在尝试向 2 个现有内容类型添加 2 个新字段，但我遇到了这个异常，不知道如何修复它

在该行中的第一个内容类型更新后引发异常：agendaPoints.AddFieldRefFromContentType(currentWeb, fldRecurrent);

```
private void AddRecurrentAndCopyAttachmentsFieldsToContentType(SPWeb currentWeb)
        {

            try
            {
                currentWeb.AllowUnsafeUpdates = true;
                SPContentType agendaPointsProposedCT = currentWeb.ContentTypes[Meetings.Common.Constants.CONTENTTYPES_AGENDAPOINTPROPOSED_NAME];
                SPContentType agendaPoints = currentWeb.ContentTypes[Meetings.Common.Constants.CONTENTTYPES_AGENDAPOINT_NAME];

                string recurrentFieldName = currentWeb.Fields.Add(Meetings.Common.Constants.FIELDS_AGENDAPOINTSRECURRENT_NAME, SPFieldType.Boolean, false);
                SPField recurrentField = currentWeb.Fields.GetFieldByInternalName(recurrentFieldName);

                string copyAttachmentsFieldName = currentWeb.Fields.Add(Meetings.Common.Constants.FIELDS_AGENDAPOINTSCOPYATTACHMENTS_NAME, SPFieldType.Boolean, false);
                SPField copyAttachmentsField = currentWeb.Fields.GetFieldByInternalName(recurrentFieldName);

                SPField fldRecurrent = currentWeb.Fields[Meetings.Common.Constants.FIELDS_AGENDAPOINTSRECURRENT_NAME];
                SPField fldCopyAttachments = currentWeb.Fields[Meetings.Common.Constants.FIELDS_AGENDAPOINTSCOPYATTACHMENTS_NAME];

                agendaPointsProposedCT.AddFieldRefFromContentType(currentWeb, fldRecurrent);
                agendaPointsProposedCT.AddFieldRefFromContentType(currentWeb, fldCopyAttachments);
                MoveFieldInColumnOrder(currentWeb, Meetings.Common.Constants.CONTENTTYPES_AGENDAPOINTPROPOSED_NAME, fldRecurrent.InternalName, 1);
                MoveFieldInColumnOrder(currentWeb, Meetings.Common.Constants.CONTENTTYPES_AGENDAPOINTPROPOSED_NAME, fldCopyAttachments.InternalName, 2);
                agendaPointsProposedCT.Update();

                currentWeb.AllowUnsafeUpdates = true;
                agendaPoints.AddFieldRefFromContentType(currentWeb, fldRecurrent);
                agendaPoints.AddFieldRefFromContentType(currentWeb, fldCopyAttachments);                
                MoveFieldInColumnOrder(currentWeb, Meetings.Common.Constants.CONTENTTYPES_AGENDAPOINT_NAME, fldRecurrent.InternalName, 1);
                MoveFieldInColumnOrder(currentWeb, Meetings.Common.Constants.CONTENTTYPES_AGENDAPOINT_NAME, fldCopyAttachments.InternalName, 2);
                agendaPoints.Update();

            }
            catch (Exception ex)
            {

                throw;
            }
            finally
            {
                currentWeb.AllowUnsafeUpdates = false;
            }

        } 
```

**和扩展方法**

```
public static void AddFieldRefFromContentType(this SPContentType contentType, SPWeb web,SPField field)
        {
            SPFieldLink fieldLink = new SPFieldLink(web.AvailableFields.GetField(field.InternalName));
            //Check if the Field reference exists
            if (!contentType.Fields.ContainsField(field.Title))
            {
                contentType.FieldLinks.Add(fieldLink);
                contentType.Update(true);
            }
            else
            {
                //Do Nothing
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T20:17:58.510

您是否尝试过将获取内容类型的行移动到允许不安全更新的上方/下方的行。内容类型之间是否还有任何类型的继承设置？

# javascript - Knockout.js：如何根据可观察数 组的变化来改变值？

> ID：11867876
> 
> 赞同：0
> 
> 时间：2012-08-08T15:22:37.757
> 
> 标签：javascript, knockout.js, observable

我有一个 Knockout.JS 可观察数组，它是列表的基础：

```
 self.list_elements = ko.observableArray([
     new list_element("0001", "product 1", "3.99")
  ]); 
```

此数组中的变量是可观察的：

```
function list_element ( id, name, price ) {
   this.item_id = ko.observable(id);
   this.item_name = ko.observable(name);
   this.item_price = ko.observable(price);
} 
```

还有一个详细信息视图，我想用单击的列表元素的数据填充它，例如：

```
<span data-bind="text: an_item_id"></span> 
```

填充它的函数从单击处理程序中获取相应的数组项。

```
self.fill_form = function ( array_item ) {
    // array_item is the array element corresponding to the selected list element
} 
```

如何将详细信息视图与数组中的值连接起来，以便更改数组中的值显示在详细信息视图中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:35:16.647

通常，您将创建一个`selected`observable 并使用当前选定的项目填充它。然后，您将使用`with`来呈现具有特定于所选项目的上下文的部分。

就像是：

```
var ViewModel = function() {
    var self = this;
    this.list_elements = ko.observableArray([...]);

    this.selected = ko.observable();

    this.fill_form = function(item) {
        self.selected(item);
    };
}; 
```

然后，您将绑定如下部分：

```
<div data-bind="with: selected">
   ...
</div> 
```

如果您不需要在`fill_form`函数中执行任何逻辑，那么您甚至可以直接将单击绑定到您选择的可观察对象，因为该项目将作为第一个参数传递给可观察对象（这是一个函数）并设置它的价值。

这是一个示例：http: [//jsfiddle.net/rniemeyer/YPKk2/](http://jsfiddle.net/rniemeyer/YPKk2/)

# php - 如何删除 atk4 中的子/子记录？

> ID：11867877
> 
> 赞同：1
> 
> 时间：2012-08-08T15:22:39.427
> 
> 标签：php, user-interface, atk4

看起来 Model 钩子 beforeDelete 不能分层工作。让我举例说明。

```
class Model_User extends Model_Table{
    public $table='user';
    function init(){
        parent::init();
        $this->debug();
        $this->addField('name');
        $this->hasMany('Item');
        $this->addHook('beforeDelete',$this);
    }
    function beforeDelete($m){
        $m->ref('Item')->deleteAll();
    }
}

class Model_Item extends Model_Table{
    public $table='item';
    function init(){
        parent::init();
        $this->debug();
        $this->addField('name');
        $this->hasOne('User');
        $this->hasMany('Details');
        $this->addHook('beforeDelete',$this);
    }
    function beforeDelete($m){
        $m->ref('Details')->deleteAll();
    }
}

class Model_Details extends Model_Table{
    public $table='details';
    function init(){
        parent::init();
        $this->debug();
        $this->addField('name');
        $this->hasOne('Item');
    }
} 
```

当我在“祖父”Model_User 上调用 delete() 时，它会尝试按预期删除所有 Item 记录，但不会从那里执行 Item.beforeDelete 钩子，并且在尝试删除 Item 之前不要删除 Details 记录。

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T10:40:59.527

我想我至少让它适用于分层模型结构。

这是如何完成的：

```
class Model_Object extends hierarchy\Model_Hierarchy {
    public $table = 'object';

    function init(){
        parent::init();
        $this->debug(); // for debugging
        $this->addField('name');
        $this->addHook('beforeDelete',$this);
    }

    function beforeDelete($m) {
        // === This is how you can throw exception if there is at least one child record ===
        // if($m->ref('Object')->count()->getOne()) throw $this->exception('Have child records!');

        // === This is how you can delete child records, but use this only if you're sure that there are no child/child records ===
        // $m->ref('Object')->deleteAll();

        // === This is how you can delete all child records including child/child records (hierarcialy) ===
        // Should use loop if we're not sure if there will be child/child records
        // We have to use newInstance, otherwise we travel away from $m and can't "get back to parent" when needed
        $c = $m->newInstance()->load($m->id)->ref('Object');
        // maybe $c = $m->newInstance()->loadBy('parent_id',$m->id); will work too?
        foreach($c as $junk){
            $c->delete();
        }
        return $this;
    }

} 
```

这里重要的事情是：
* 扩展层次结构\Model_Hierarchy 类而不是 Model_Table
* 在 beforeDelete 挂钩中使用适当的方法
* * 如果我们有孩子，则限制删除 - 抛出异常
* * deleteAll - 当你确定没有孩子/孩子时使用它记录
* * newInstance + 循环 + 删除 - 当您必须删除记录（甚至是子/子/...）层次结构时使用它

也许你们中的一些人有更好的解决方案？

# android - 更新使用 In App Billing 的 Android 应用

> ID：11867878
> 
> 赞同：19
> 
> 时间：2012-08-08T15:22:43.470
> 
> 标签：android, in-app-billing

我们有一个使用应用内计费的应用程序。我们看到的问题如下：

当设备上 App 的 versionCode 与 Play Developer Console 中发布的 Application 的版本代码相同时，Billing 工作正常。

当具有更高 versionCode 的构建被上传到 Play 开发者控制台时，In App Billing 停止在设备上的应用程序（具有较低 versionCode）上运行，说“应用程序未配置为计费”。

这很好，测试时，但问题是 - 当应用程序在 Google Play 商店中时的行为是什么？当您替换应用程序（执行更新）时，在野外的应用程序（具有较低版本代码）是否停止使用应用内计费？

如果是这样，人们使用什么方法来执行更新？您是否强制用户在购买前更新？或者这个问题仅在发布之前才是真的？

任何建议将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T15:56:26.497

只要您上传的“较新”apk 使用与现有密钥相同的密钥进行签名，那么您就不会遇到任何问题。

我刚刚测试了使用以前版本（版本代码较低）运行我的应用程序，并且应用程序计费仍然有效。

需要注意的是，您不得从市场上删除该 apk，只需将其停用即可。

但是你所说的强制更新，我确实会在用户打开应用程序时提示他们更新。

您可能已经阅读过它，但[这里是](http://developer.android.com/guide/google/play/publishing/multiple-apks.html)多个 apk 的官方信息。

# html - 我可以嵌入链接以在浏览器中显示 PDF，而不是诱导下载吗？

> ID：11867884
> 
> 赞同：0
> 
> 时间：2012-08-08T15:22:55.767
> 
> 标签：html, pdf, browser, embed

我希望我网站的客户能够点击我网站上的 url/按钮，然后让 url/按钮在浏览器中打开可提交的 PDF，而不是诱导下载。不确定需要添加以使 PDF 显示在浏览器中的代码细节，而不是排队进入活动下载...谢谢

最佳，SL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:33:08.053

Try something like this

```
<iframe id="myFrame" style="display:none" width="600" height="300"></iframe>
<input type="button" value="Open PDF" onclick = "openPdf()"/>
<script type="text/javascript">
function openPdf()
{
var omyFrame = document.getElementById("myFrame");
omyFrame.style.display="block";
omyFrame.src = "2.pdf";
}
</script> 
```

Hope it helps

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:40:08.477

前段时间，当我不得不解决同样的问题时，当一些用户没有在他们的浏览器中安装 Adob​​e（或其他 PDF 查看器）插件时，问题就出现了。请记住这一点，也许提供一个链接来下载您喜欢的 PDF 查看器会很有趣。我认为，您不需要特殊代码。浏览器会小心，但您可能不能强迫用户在浏览器上查看而不下载。他将永远有选择的余地。如果您真的想避免这种情况，您应该查看生成 PDF 的选项。

# c++ - 为什么 VC C4244 警告（可能丢失数据）专门处理“int”？

> ID：11867887
> 
> 赞同：3
> 
> 时间：2012-08-08T15:23:09.053
> 
> 标签：c++, visual-c++, compiler-warnings

下面的代码示例演示隐式转换 from `short`to`char`在级别 3 触发，而隐式转换 from `int`to`char`仅在警告级别 4 触发。

```
int main()
{
    short as = 1;
    int   ai = 1;
    char  b1 = as; // warning C4244 (Level 3)
    char  b2 = ai; // warning C4244 (Level 4)
    return 0;
} 
```

这是什么原因 -[文档](http://msdn.microsoft.com/en-us/library/th7a07tz%28v=vs.100%29.aspx)省略了原因？

在更改变量的类型并使用此警告识别可能的转换问题后，我遇到了这个问题。我错过了警告并意识到我必须切换到 4 级。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T15:28:36.387

一个原因可能是涉及较小类型的算术运算实际上是使用提升为 int 的值执行的，因此将 int 结果分配回原始大小稍微合理一些。

为 char 分配一个 short 几乎总是一个错误。

# php - PHP curl超时错误检测

> ID：11867891
> 
> 赞同：38
> 
> 时间：2012-08-08T15:23:17.277
> 
> 标签：php, curl, error-handling, timeout

我使用 curl 执行如下 HTTP 请求：

```
$ch = curl_init();
$timeout = 5;
curl_setopt($ch,CURLOPT_URL,$url);
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);

$data = curl_exec($ch);
curl_close($ch); 
```

如何检查是否发生错误，以及是否是超时错误？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-08-08T15:28:33.063

采用[`curl_errno()`](http://www.php.net/manual/en/function.curl-errno.php)

[代码 28](http://curl.haxx.se/libcurl/c/libcurl-errors.html)是超时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-21T09:22:02.847

您可以像这样检查错误号及其描述：

```
// Check if any error occurred
if(curl_errno($ch))
{
    echo 'Curl error: ' . curl_error($ch);
} 
```

# actionscript-3 - 标签未显示

> ID：11867893
> 
> 赞同：0
> 
> 时间：2012-08-08T15:23:19.213
> 
> 标签：actionscript-3, flash, actionscript

我正在使用裸 ActionScript 3.0 从基本的 Flash UI 组件构建一个简单的菜单，并且`Label`在电影测试期间第一个控件没有显示`(Ctrl+Enter)`。这是为什么？

我在图书馆或舞台上没有任何符号。我的文档链接到*main.as*

应该发生的是，当*.swf*启动时，`main()`会收到生成指令，而该指令`mainMenu`又会在电影屏幕的中心顶部显示唯一的标签。

**主文件**

```
package {

    import flash.display.*;

    public class main extends MovieClip{
        public function main(){
            changeState(null, "mainMenu");
        }
        public function changeState(currentState, nextState){
            if(currentState != null){
                removeChild(currentState);
            }
            if(nextState == "mainMenu"){
                var main_menu:mainMenu = new mainMenu(changeState);
                addChild(main_menu);
            }// else if(nextState == "deckManager"){
//              var deck_manager:deckManager = new deckManager(changeState);
//              addChild(deck_manager);
//          }
        }
    }
} 
```

**主菜单.as**

```
package {

    import flash.display.*;
    import flash.events.MouseEvent;
    import fl.controls.Label;
    import fl.controls.RadioButton;
    import fl.controls.ComboBox;
    import fl.controls.Button;

    public class mainMenu extends Sprite{

        const difficultyRadioGroupName:String = "difficultyGroup"; // group name for easy, normal and hard difficulty radio buttons

        var difficultyLabel:Label; // "Difficulty" label
        var easyDifficultyRadio:RadioButton; // "Easy" difficulty radio button
        var normalDifficultyRadio:RadioButton; // "Normal" difficulty radio button
        var hardDifficultyRadio:RadioButton; // "Hard" difficulty radio button
        var yourDeckLabel:Label; // "Your deck" label
        var yourDeckCombo:ComboBox; // combobox to select your deck(1)
        var editSelectedDeckButton:Button; // button to edit currently selected deck
        var startTheGameButton:Button; // button to start the game
        var theCallbackFunction:Function; // callback function to change between mainMenu and deckManager

        public function mainMenu(callback){

            // create and position the difficulty label
            difficultyLabel = new Label();
            difficultyLabel.text = "Difficulty";
            difficultyLabel.x = width / 2;
            difficultyLabel.y = height / 4;
            addChild(difficultyLabel);

            theCallbackFunction = callback;
        }

        //public function backButtonClicked(evt:MouseEvent){
//          theCallbackFunction(this, "back");
//          return;
//      }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:54:40.477

从表面上看，这似乎没问题。

但是，您分配给 的 X/Y 坐标`Label`可能不是您所期望的。您可以根据`mainMenu`Sprite 的宽度/高度设置它们。但这`Sprite`还没有孩子（孩子被添加到下一行），所以宽度/高度仍然是 0。

这可能不是问题。为了进一步解决这个问题，我会设置一些断点并使用调试器，或者添加一堆`trace`语句以确保您的代码正在使用正确的值执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T17:10:15.677

我相信“fl.controls”包中的所有内容都需要在您的库中显示适当的资产。如果您只是从 fl.controls 导入内容，则除非您将该元素添加到您的库或摄取其中包含适当库资产的 swc/swf，否则您不会获得控件的 UI 方面。

所以我猜如果在 Flash IDE 中，如果你将适当的 UI 元素从组件选项卡拖到你的库中，它们就会开始出现。它们不必在舞台上或任何东西上，只需在库中，以便 UI 元素与您的代码一起编译。

# mysql - 使用 Symfony-2.0 表单组件将 HTML 保存到数据库

> ID：11867895
> 
> 赞同：0
> 
> 时间：2012-08-08T15:23:23.747
> 
> 标签：mysql, symfony, doctrine

我正在尝试使用 Symfony2 表单系统保存 HTML 内容，但我遇到了转义问题。

我的 addPost 操作看起来像这样

```
$em = $this->getDoctrine()->getEntityManager();

$post = new Post();
$postForm = $this->createForm(new PostFormType(), $post);

if ($request->getMethod() == 'POST') {
   $postForm->bindRequest($request);

   if($postForm->isValid()){
      $em->persist($post);
      $em->flush();
   }
} 
```

问题是帖子表单有一个内容文本区域，允许用户输入 html。当使用 html 提交表单时`<a href="#">test</a>`，内容会以`<a href=\"#\">test</a>`. 然后在随后的每次保存中，反斜杠一次又一次地逃脱......

使用 Symfony2 表单组件存储 HTML 的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T14:16:40.057

在将字符串发送给用户进行编辑之前，您应该从字符串中删除反斜杠。您应该能够从 $post 对象中获取内容，然后剥离其斜线并将其设置回帖子内容，就像这样。

```
$post = new Post();
$post->setContent(stripslashes($post->getContent()));
$postForm = $this->createForm(new PostFormType(), $post); 
```

现在，当表单呈现时，它将没有转义字符。

但是，我发现如果您返回同一页面的响应，您仍然会看到反斜杠。为避免这种情况，您可以像这样返回 RedirectResponse

```
if($postForm->isValid()){
   $em->flush();
   return new RedirectResponse('route', array('postId' => $postId)));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T18:43:52.867

这些斜线放置在那里，以便 mysql 引擎不会将这些引号与 sql 语法混淆。我建议您在从数据库中检索字段时使用拒绝删除所有斜杠，但在将其发布到客户端之前。让我看看能不能给你找到rejex，也许有人会打败我:)

# artifactory - 工件是否支持同一工件的多个版本？

> ID：11867898
> 
> 赞同：9
> 
> 时间：2012-08-08T15:23:30.443
> 
> 标签：artifactory

假设我有工件“mylibrary-5.2.jar”和“mylibrary-5.3.jar”代表我们的项目为我们的其他项目之一创建和发布的库的 5.2 和 5.3 版本。

Artifactory 是否支持拥有每个这些工件的多个“版本”来表示在发布期间执行的不同构建以构建此工件？

例如，为了生成“mylibrary”的 5.2 版本（即工件：**mylibrary-5.2.jar** ）的最终版本，我们进行了 3 次构建，以获得通过了集成环境自动化测试和用户验收测试的版本。

因此，有三个独立的构建为 5.2 版生成了三个独立的工件。我们希望能够保留并可能在以后调用这些不同构建的工件（用于测试等）。

为了做到这一点，以下哪个选项会起作用？

1.  将工件捕获为单独的工件，即 build-5.2-b1.jar（构建 1 的工件）、build-5.2-b2.jar（构建 2 的工件）、build-5.2-b3.jar（构建 3 的工件）和 build- 5.2.jar（最终生产版本；与构建 3 匹配）

2.  捕获一个名为“build-5.2.jar”的单个工件，该工件具有捕获构建 1 到 3 的工件的版本，并且可以稍后按版本号调用。

3.  我们没有考虑过的其他一些选择，但应该

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T16:03:36.553

问题本身与 Artifactory 关系不大，因为它可以处理任何工件；但推荐的方式通常是您第一个建议的变体；也就是说，*保留每个构建的单独快照，*直到您对结果满意并*生成单个 release-version*。

例如，每次开发/质量保证/集成迭代都会以以下形式生成工件：

```
artifactName-1.0-${TIMESTAMP}.jar 
```

每个都有不同的名称（可能还有内容），因此是可追溯的。

一旦迭代完成，并且您准备好发布工件，请以以下形式生成它：

```
artifactName-1.0.jar 
```

该工件代表最终发布的版本。

快照在 Java 世界中非常普遍，被[Maven](http://www.sonatype.com/books/mvnref-book/reference/pom-relationships-sect-pom-syntax.html)和[Ivy广泛使用，也是](http://ant.apache.org/ivy/history/latest-milestone/terminology.html#revision)[持续集成](http://en.wikipedia.org/wiki/Continuous_integration)最基础的概念之一

# url-rewriting - web.config 中的 IIS 7.5 URL 重写规则不起作用

> ID：11867904
> 
> 赞同：0
> 
> 时间：2012-08-08T15:23:48.323
> 
> 标签：url-rewriting, windows-server-2008, iis-7.5

我刚刚将另一个站点移至服务器，但 URL 重写规则不起作用。所以，我从 iis.net 安装了 URL Rewrite 2.0 但没有运气。

当我从 IIS 管理器中选择站点时，我可以看到 URL 重写图标，但没有记录。

我不想将规则从 web.config 一个一个移动到 URL Rewrite 部分。

这里是 web.config 文件的内容；

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <configSections>
        ...
        <section name="RewriterConfig" type="URLRewriter.Config.RewriterConfigSerializerSectionHandler, URLRewriter" requirePermission="false" />
    </configSections>

    <RewriterConfig>
        <Rules>
            <!-- TR -->
            <RewriterRule>
                <LookFor>~/Sayfalar/Kategoriler/(.*)/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?ParentRawUrl=$2&amp;RawUrl=$3&amp;ID=$1&amp;Lang=0</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Sayfalar/Kategoriler/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?RawUrl=$2&amp;ID=$1&amp;Lang=0</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Sayfalar/(.*)/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?ParentRawUrl=$2&amp;RawUrl=$3&amp;ID=$1&amp;Lang=0</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Sayfalar/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=$1&amp;Lang=0</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Kategoriler/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?ID=2&amp;CategoryID=$1&amp;Lang=0</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Urunler/(.*)/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?ID=2&amp;ProductID=$1&amp;Lang=0</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Haberler/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=30&amp;NewsID=$1&amp;Lang=0</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Tarifler/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=22&amp;RecipeID=$1&amp;Lang=0</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Sizin-Tarifiniz/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=21&amp;YourRecipeID=$1&amp;Lang=0</SendTo>
            </RewriterRule>
            <!-- // TR -->
            <!-- AR -->
            <RewriterRule>
                <LookFor>~/Arabic.aspx</LookFor>
                <SendTo>~/Default.aspx?Lang=1</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Sfhat/Al-Fiat/(.*)/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?ParentRawUrl=$2&amp;RawUrl=$3&amp;ID=$1&amp;Lang=1</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Sfhat/Al-Fiat/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?RawUrl=$2&amp;ID=$1&amp;Lang=1</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Sfhat/(.*)/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?ParentRawUrl=$2&amp;RawUrl=$3&amp;ID=$1&amp;Lang=1</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Sfhat/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=$1&amp;Lang=1</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Al-Fiat/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?ID=59&amp;CategoryID=$1&amp;Lang=1</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Al-Mntjat/(.*)/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?ID=59&amp;ProductID=$1&amp;Lang=1</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Khbar/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=58&amp;NewsID=$1&amp;Lang=1</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Wsfat/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=63&amp;RecipeID=$1&amp;Lang=1</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Ldyk-Wşfh/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=62&amp;YourRecipeID=$1&amp;Lang=1</SendTo>
            </RewriterRule>
            <!-- // AR -->
            <!-- // ENG -->
            <RewriterRule>
                <LookFor>~/English.aspx</LookFor>
                <SendTo>~/Default.aspx?Lang=2</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Pages/Categories/(.*)/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?ParentRawUrl=$2&amp;RawUrl=$3&amp;ID=$1&amp;Lang=2</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Pages/Categories/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?RawUrl=$2&amp;ID=$1&amp;Lang=2</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Pages/(.*)/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?ParentRawUrl=$2&amp;RawUrl=$3&amp;ID=$1&amp;Lang=2</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Pages/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=$1&amp;Lang=2</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Categories/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?ID=111&amp;CategoryID=$1&amp;Lang=2</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Product/(.*)/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Product.aspx?ID=111&amp;ProductID=$1&amp;Lang=2</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/News/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=30&amp;NewsID=$1&amp;Lang=2</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Recipes/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=118&amp;RecipeID=$1&amp;Lang=2</SendTo>
            </RewriterRule>
            <RewriterRule>
                <LookFor>~/Your-Recipes/(.*)/(.*).aspx</LookFor>
                <SendTo>~/Page.aspx?RawUrl=$2&amp;ID=119&amp;YourRecipeID=$1&amp;Lang=2</SendTo>
            </RewriterRule>
            <!-- // ENG -->
        </Rules>
    </RewriterConfig>
    <system.web>
        ...
    </system.web>
    ...
    <system.webServer>
        ...
    </system.webServer>
    ...
</configuration> 
```

我该怎么办 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:51:29.310

这些规则不适用于 Microsoft URL 重写模块。通过谷歌搜索，`RewriterConfig`我发现这些规则可能适用于 Spring MVC 重写模块。

# php - jQuery UI 接收 Post 到 PHP 文件

> ID：11867905
> 
> 赞同：0
> 
> 时间：2012-08-08T15:23:50.007
> 
> 标签：php, jquery, user-interface, post

我正在使用 jQuery UI 为 UL 创建拖放功能。这个想法是您可以对列表中的项目进行排序，并且视图顺序将在数据库中更新（这是有效的）。我现在尝试添加的功能是能够将 LI 拖到不同的 UL 中并更新数据库，以便应用程序知道 LI 进入哪个列表。该项目可以移动到不同的列表中，但是我发布到的 php 文件没有更新数据库。

PHP 文件像这样回显列表：

```
<div class="list_div">
    <h3>List #1</h3>
    <ul id="listnumber_25" class="ui-sortable" unselectable="on">
        <li id="item_134">list item 1</li>
        <li id="item_135">list item 2</li>
        <li id="item_136">list item 3</li>
        <li id="item_137">list item 4</li>
    </ul>
</div>
<div class="list_div">
    <h3>List #2</h3>
    <ul id="listnumber_26" class="ui-sortable" unselectable="on">
        <li id="item_138">list item 1</li>
        <li id="item_139">list item 2</li>
        <li id="item_140">list item 3</li>
        <li id="item_141">list item 4</li>
    </ul>
</div> 
```

* * *

JS看起来像这样：

```
//sort / change list
$(document).ready(function(){
    $(".list_div ul").sortable({
        receive: function(event, ui) {
            var list_id = this.id;
            var li_to_reassign = ui.item.attr('id');
            $.post("functions/changelist.php", { li_to_reassign: li_to_reassign, list_id: list_id } );
        }
    });
}); 
```

函数/changelist.php：

```
<?

$list_id = $_POST['list_id'];
$list_id = substr('$list_id', 11); 

$li_to_reassign = $_POST['li_to_reassign'];
$li_to_reassign = substr('$li_to_reassign', 5); 

//------------------------------------------

// connect to DB
$host="localhost"; // Host name 
$username="********"; // Mysql username 
$password="********"; // Mysql password 
$db_name="**********"; // Database name 

// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

$sql="UPDATE tasks SET list_id='$list_id' WHERE id='$li_to_reassign'";
$result=mysql_query($sql);

?> 
```

我似乎找不到问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:47:59.547

在您的 php 文件中，您正在获取值，`$_POST`但在您使用新值重新评估这些变量之后，使用一个`$str`甚至没有设置的变量：

```
$list_id = $_POST['list_id'];
$list_id = $list_id($str, 11); 

$li_to_reassign = $_POST['li_to_reassign'];
$li_to_reassign = $li_to_reassign($str, 5); 
```

它应该是：

```
$list_id = $_POST['list_id'];

$li_to_reassign = $_POST['li_to_reassign']; 
```

编辑（如果您想获得`$_POST`变量的子串，请使用函数[substr](http://php.net/manual/en/function.substr.php)像这样）：

```
$list_id = $_POST['list_id'];
$list_id = substr($list_id, 11); 

$li_to_reassign = $_POST['li_to_reassign'];
$li_to_reassign = substr($li_to_reassign, 5); 
```

# vba - VBA 查询未像访问查询那样运行

> ID：11867909
> 
> 赞同：2
> 
> 时间：2012-08-08T15:24:01.877
> 
> 标签：vba, ms-access, jet

对于您即将收到的代码集群，我深表歉意。问题是：为什么我的查询在设计窗口中工作（注意`Debug.Print .CommandText`输出我放入访问查询的确切文本），但是**对象'_Command'的方法'Execute'失败**并且不运行INSERT查询。这是代码：

```
 cnn.BeginTrans 'Begin deletion
    cmdText = "DELETE * FROM tblB1B2"
    Set cmd = New ADODB.Command
    With cmd
        .CommandType = adCmdText
        .ActiveConnection = cnn
        .CommandText = cmdText
        .Execute
    End With
    cnn.CommitTrans 'Commit Deletion

    cnn.BeginTrans 'Begin update
    cmdText = "INSERT INTO tblB1B2 IN '" & toDB & "' " & _
                "SELECT interne AS interne, groupe AS groupe, MAX(itemref) AS [item], largeur AS largeur, hauteur AS hauteur, local AS [local], etage AS etage, partie AS partie, dessin AS dessin, datezonage AS datezonage, externe AS externe, erreur AS erreur, tag_hndl AS tag_hndl, tag_dessin AS tag_dessin, pobj_hndl AS pobj_hndl, pobj_type AS pobj_type, pobj_bname AS pobj_bname, zpl_hndl AS zpl_hndl, id AS id, Sidewalk AS Sidewalk, BarrierFreePathOfTravel AS BarrierFreePathOfTravel, Signage AS Signage, Hardware AS Hardware, PowerDoorOperator AS PowerDoorOperator, PDOMountHeight AS PDOMountHeight, ClearWidth AS ClearWidth, ClearSpace AS ClearSpace, ManoeuveringSpace AS ManoeuveringSpace, TwoDoorsInASeries AS TwoDoorsInASeries, Comments AS [Comments] " & _
                "FROM " & _
                    "(SELECT interne, groupe, [item] AS itemref, largeur, hauteur, local, etage, partie, dessin, datezonage, externe, erreur, tag_hndl, tag_dessin, pobj_hndl, pobj_type, pobj_bname, zpl_hndl, [id], Sidewalk, BarrierFreePathOfTravel, Signage, Hardware, PowerDoorOperator, PDOMountHeight, ClearWidth, ClearSpace, ManoeuveringSpace, TwoDoorsInASeries, [Comments] " & _
                    "FROM tblB1B2 IN '" & dbArray(0) & "' " & _
                "UNION ALL " & _
                    "SELECT interne, groupe, [item] AS itemref, largeur, hauteur, local, etage, partie, dessin, datezonage, externe, erreur, tag_hndl, tag_dessin, pobj_hndl, pobj_type, pobj_bname, zpl_hndl, [id], Sidewalk, BarrierFreePathOfTravel, Signage, Hardware, PowerDoorOperator, PDOMountHeight, ClearWidth, ClearSpace, ManoeuveringSpace, TwoDoorsInASeries, [Comments] " & _
                    "FROM tblB1B2 IN '" & dbArray(1) & "' " & _
                "UNION ALL " & _
                    "SELECT interne, groupe, [item] AS itemref, largeur, hauteur, local, etage, partie, dessin, datezonage, externe, erreur, tag_hndl, tag_dessin, pobj_hndl, pobj_type, pobj_bname, zpl_hndl, [id], Sidewalk, BarrierFreePathOfTravel, Signage, Hardware, PowerDoorOperator, PDOMountHeight, ClearWidth, ClearSpace, ManoeuveringSpace, TwoDoorsInASeries, [Comments] " & _
                    "FROM tblB1B2 IN '" & dbArray(2) & "' " & _
                ") AS FullTable " & _
              "GROUP BY interne, groupe, largeur, hauteur, local, etage, partie, dessin, datezonage, externe, erreur, tag_hndl, tag_dessin, pobj_hndl, pobj_type, pobj_bname, zpl_hndl, [id], Sidewalk, BarrierFreePathOfTravel, Signage, Hardware, PowerDoorOperator, PDOMountHeight, ClearWidth, ClearSpace, ManoeuveringSpace, TwoDoorsInASeries, [Comments]"

    Set cmd = New ADODB.Command
    With cmd
        .CommandType = adCmdText
        .ActiveConnection = cnn
        .CommandText = cmdText
        Debug.Print .CommandText
        .Execute
    End With
    cnn.CommitTrans 'Commit update 
```

复制粘贴到访问查询时的打印文本运行良好；但在 VBA 中会产生此错误。为什么？我怎样才能绕过它？我是否使用了我不知道的关键字？

另外，有没有一种方法可以在不指定每个字段的情况下执行此查询？（注意`MAX(itemref)`）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:55:54.713

好吧..在这里发布后（像往常一样，经过大约 3 小时的试验和失败）.. 我明白了。原来“local”是 JET 中的保留关键字。我必须做一些创造性的操作才能让它认识到它是一个领域。对于遇到此类问题的其他任何人，这是固定的 .CommandText：

```
cmdText = "INSERT INTO tblB1B2 IN '" & toDB & "' " & _
                    "SELECT interne AS interne, groupe AS groupe, MAX(itemref) AS item, largeur AS largeur, hauteur AS hauteur, localref AS [local], etage AS etage, partie AS partie, dessin AS dessin, datezonage AS datezonage, externe AS externe, erreur AS erreur, tag_hndl AS tag_hndl, tag_dessin AS tag_dessin, pobj_hndl AS pobj_hndl, pobj_type AS pobj_type, pobj_bname AS pobj_bname, zpl_hndl AS zpl_hndl, id AS id, Sidewalk AS Sidewalk, BarrierFreePathOfTravel AS BarrierFreePathOfTravel, Signage AS Signage, Hardware AS Hardware, PowerDoorOperator AS PowerDoorOperator, PDOMountHeight AS PDOMountHeight, ClearWidth AS ClearWidth, ClearSpace AS ClearSpace, ManoeuveringSpace AS ManoeuveringSpace, TwoDoorsInASeries AS TwoDoorsInASeries, Comments AS Comments " & _
                    "FROM " & _
                        "(SELECT interne, groupe, item AS itemref, largeur, hauteur, [local] AS localref, etage, partie, dessin, datezonage, externe, erreur, tag_hndl, tag_dessin, pobj_hndl, pobj_type, pobj_bname, zpl_hndl, id, Sidewalk, BarrierFreePathOfTravel, Signage, Hardware, PowerDoorOperator, PDOMountHeight, ClearWidth, ClearSpace, ManoeuveringSpace, TwoDoorsInASeries, Comments " & _
                        "FROM tblB1B2 IN '" & dbArray(0) & "' " & _
                    "UNION ALL " & _
                        "SELECT interne, groupe, item AS itemref, largeur, hauteur, [local] AS localref, etage, partie, dessin, datezonage, externe, erreur, tag_hndl, tag_dessin, pobj_hndl, pobj_type, pobj_bname, zpl_hndl, [id], Sidewalk, BarrierFreePathOfTravel, Signage, Hardware, PowerDoorOperator, PDOMountHeight, ClearWidth, ClearSpace, ManoeuveringSpace, TwoDoorsInASeries, Comments " & _
                        "FROM tblB1B2 IN '" & dbArray(1) & "' " & _
                    "UNION ALL " & _
                        "SELECT interne, groupe, item AS itemref, largeur, hauteur, [local] AS localref, etage, partie, dessin, datezonage, externe, erreur, tag_hndl, tag_dessin, pobj_hndl, pobj_type, pobj_bname, zpl_hndl, [id], Sidewalk, BarrierFreePathOfTravel, Signage, Hardware, PowerDoorOperator, PDOMountHeight, ClearWidth, ClearSpace, ManoeuveringSpace, TwoDoorsInASeries, Comments " & _
                        "FROM tblB1B2 IN '" & dbArray(2) & "' " & _
                    ") AS FullTable " & _
                  "GROUP BY interne, groupe, largeur, hauteur, localref, etage, partie, dessin, datezonage, externe, erreur, tag_hndl, tag_dessin, pobj_hndl, pobj_type, pobj_bname, zpl_hndl, [id], Sidewalk, BarrierFreePathOfTravel, Signage, Hardware, PowerDoorOperator, PDOMountHeight, ClearWidth, ClearSpace, ManoeuveringSpace, TwoDoorsInASeries, Comments" 
```

请注意这些`local`字段，我必须`[local] AS localref`在子查询和`localref AS [local]`主查询中使用，以避免关键字和循环引用。

# opengl - Ubuntu 12.04 /usr/bin/ld：错误：找不到-lGL

> ID：11867913
> 
> 赞同：0
> 
> 时间：2012-08-08T15:24:13.333
> 
> 标签：opengl, ubuntu, ubuntu-12.04, ati, amd-processor

我安装了 fglrx ATI/AMD 专有驱动程序，现在当我尝试启动我的 OpenGL/SDL 项目时，我收到以下消息：**/usr/bin/ld: error: cannot find -lGL**

我运行 64 位 Ubuntu 12.04 桌面。HD6870 [ATI Radeon HD 6800 系列]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:26:58.633

安装`fglrx-glx`应该会对您有所帮助，这些是用于专有 AMD/ATI 驱动程序的 libGL。

# scala - 播放 2：如何在 Scala 控制器中解析表单输入的动态列表？

> ID：11867915
> 
> 赞同：5
> 
> 时间：2012-08-08T15:24:21.593
> 
> 标签：scala, playframework, playframework-2.0

我有一个表单，其中输入字段的数量是动态的。

这些输入字段如何映射到播放表单？假设每个输入标签的名称是“foo_x”，其中 x 是一个整数，每次在客户端动态创建一个新的输入字段时它都会递增。Play 中是否有任何自动映射可用，或者我必须“手动”执行此操作，如果有，如何完成？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-09T19:38:54.357

正如 Brian 提到的，Play 文档有一个重复值的示例，应该可以满足您的需求。

另外，请记住，您可以嵌套映射定义。例如，我有以下内容：

```
val editUserForm: Form[User] = Form(
    mapping(
        "username" -> text(minLength = 4, maxLength = 50),
        "emails" -> list(optional(email)).verifying(Messages("error.mandatoryEmail"), e => e.size > 0),
        "urls" -> list(text(maxLength = 255)),
        {
            // Binding: Create a User from the mapping result
            (username, emails, urls) => {
              // Here, emails is a List[Option[String]] 
              // and urls is a List[String]
            }
        } {
            // Unbinding: Create the mapping values from an existing User value
            user => Some(user.username, 
                        user.emails.map(e => Some(e.email)), 
                        user.urls.map(_.url))
        }
    ) 
```

那里发生了很多事情，但我想展示的重要一点是，我正在嵌套带有可选电子邮件的列表，并验证列表至少有一个非空元素 - 有效地强制用户至少输入列表中的一个元素。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-09T14:24:32.613

[请参阅Play2 文档](http://www.playframework.org/documentation/2.0.2/ScalaForms)中的“重复值” 。

只要您遵循命名约定，您就可以将它们自动映射到列表中。

# javascript - 在 MVC razor 语法中嵌入 javascript 变量

> ID：11867916
> 
> 赞同：1
> 
> 时间：2012-08-08T15:24:35.453
> 
> 标签：javascript, asp.net-mvc-3, razor

我正在使用 ajax 在 MVC 3 razor 环境中填充一系列下拉列表，并尝试创建一个通用函数来执行此操作。我遇到问题的功能的核心是

```
url: '@Url.Action("SecondaryList")' 
```

我想用 JavaScript 变量替换“SecondaryList”。

所以

```
var myUrl = 'SecondaryList'
url: '@Url.Action(' + myUrl + ')' 
```

我不知道该怎么做，因为上述方法不起作用！

提前谢谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T17:45:29.353

你可以使用[`.replace()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)javascript函数。首先声明一个 javascript 变量

```
var myUrl = 'SomeAction'; 
```

然后使用带有服务器端 Url.Action 帮助器的虚拟占位符，您可以将其替换为 javascript 变量：

```
url: '@Url.Action("__url__")'.replace('__url__', myUrl) 
```

# javascript - Highcharts x轴偏移但在调整大小后恢复

> ID：11867918
> 
> 赞同：1
> 
> 时间：2012-08-08T15:24:52.193
> 
> 标签：javascript, highcharts, offset

在最新版本的 Highcharts 中，我的 x 轴线比预期的要大是偏移的。但是，如果我打开 Firebug（重新调整我的页面大小）并关闭它，我的 x 轴就在他的正确位置。

打开 Firebug 之前：[这里](http://desmond.imageshack.us/Himg51/scaled.php?server=51&filename=60679484.jpg&res=landing)

之后：[这里](http://img837.imageshack.us/img837/533/65999168.jpg)

这是代码：

```
options = {
    chart: {
        type: 'column',
        animation: false,
        renderTo: 'chart1'

    },
        xAxis: {
            categories: ['STBL','AHM OE','TCR'],
            labels: {
                rotation: -45,
                overflow: "justify",
                align: 'right',
                y: 20
            }
        },
        yAxis: {
            min: 0,
            title: {
                text: ''
            }
        },
        legend: {
            enabled: false,

        },
        tooltip: {
            formatter: function() {
                return ''+
                    this.x +': '+ Highcharts.numberFormat(this.y, 5);
            }
        },
        plotOptions: {
            column: {
                borderWidth: 0,
                pointWidth: 8
            }
        },
        series: [{
            name: '',
            data: [9.93782224348591E-4,0.0012882708991709339,0.01952599999881562]
        }]
    };
var chart1 = new Highcharts.Chart(options); 
```

有人可以帮我吗？

谢谢

# php - GAPI，获取唯一访问者

> ID：11867922
> 
> 赞同：0
> 
> 时间：2012-08-08T15:25:12.147
> 
> 标签：php

如何从 GAPI 类中获取所有唯一访问者。

```
$ga = new gapi(ga_email,ga_password);

$dimensions = array('visitCount');
$metrics    = array('visitors');

$ga->requestReportData(ga_profile_id, $dimensions,$metrics);

$gaResults = $ga->getResults();

//print_r( $gaResults);

$i=1;

foreach($gaResults as $result)
{

   $total= $total+ $result->getvisitors() ;
         //  $result->getVisitors()

          // );

 // print_r($result);
}

echo $total; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:34:47.237

```
$ga->requestReportData(ga_profile_id, array('pagePath'), array('visitors'));
foreach($ga->getResults() as $result) {
    var_dump($result);
} 
```

如果您查看[https://developers.google.com/analytics/community/export_changelog](https://developers.google.com/analytics/community/export_changelog)以获取 2011-01 版（2011 年 1 月 24 日）的日志。

> ga:visitors 的计算已更改为返回整个日期范围内的唯一身份访问者数量，现在支持更多维度和指标组合。

# c# - 私有字段中的 C# 注释

> ID：11867923
> 
> 赞同：1
> 
> 时间：2012-08-08T15:25:18.043
> 
> 标签：c#

> **可能重复：**
> [我应该记录我的私有方法吗？](https://stackoverflow.com/questions/1743538/should-i-document-my-private-methods)

为私有字段和私有方法写评论是一种好习惯吗？我写了一个简单的库，我真的不知道是否为我的私人字段添加评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:28:09.337

如果您有相关的内容要说，最好将其记录下来，即使是私人成员，作为未来维护课程的指导方针。但是像“获取或设置 Foo 属性”这样的样板注释对于私有代码 IMO 来说是纯粹的噪音。

# windows - Git（Windows 7）不会添加目录，但会添加明确键入的文件

> ID：11867925
> 
> 赞同：1
> 
> 时间：2012-08-08T15:25:25.670
> 
> 标签：windows, git

试图找到这个问题的答案，已经看到它的暗示，但没有解决方案。

对 git 来说并不是全新的，但几个月没用过……这是我第一次在 Windows 上使用它。使用 git bash。

我有一个蛋糕 PHP 站点，我想添加排除**我的 .gitignore 文件仅包含的任何缓存文件：**

应用程序/tmp/*

这是我尝试过的最基本的事情：

```
git init
git add .
git commit 
```

我在提交时收到一条消息，说有未跟踪的文件 - 根目录中的所有文件和目录。

```
git status 
```

给了我同样的信息。

但是，如果我输入

```
git add .htaccess 
```

它暂存 .htaccess 文件。

另外，如果我这样做：

```
git add app/.htaccess 
```

它也会添加该文件。

我也试过

```
git add app/* 
```

没运气。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-04T19:46:55.530

这些文件不会被忽略，否则您将被迫执行`git add --force afile`.

但是，您可能需要检查环境变量`GIT_DIR`，`GIT_WORK_TREE`看看它们是否引用了另一个存储库，这可以解释索引与您认为的工作树之间的差异。

# javascript - 如何限制 querySelectorAll 使其仅搜索参考节点的子节点？

> ID：11867926
> 
> 赞同：1
> 
> 时间：2012-08-08T15:25:27.713
> 
> 标签：javascript, dom, no-framework

> **可能重复：**
> [使用 querySelectorAll 时，有没有办法在不使用 ID 的情况下引用上下文节点的直接子节点？](https://stackoverflow.com/questions/11440725/when-using-queryselectorall-is-there-a-way-to-reference-the-immediate-children)

我要做的是检查给定元素是否与 css 选择器匹配。据我所知，唯一的方法是获取父节点，然后遍历 querySelectorAll 找到的内容，最后检查找到的节点是否与我开始的节点相同。但问题是如何使我必须循环的池更小。

代码：

```
function querySelectorMatch(node,query) {
  var found = node.parentNode.querySelectorAll(query);
  for (var i = 0; i<found.length; i++) {
    if (found[i] === node) return true;
  }
  return false;
} 
```

好的，这可行，但是我认为循环消耗了太多资源。好的，我可以检查父节点是否具有 id 和/或类，并将其附加到查询中，`parent#id.class > query`等等……但就受影响的资源而言，它是否会不一样，因为代码无论如何都必须做出相同的决定，但它将更接近硬件......我不知道。

（请不要使用 jQuery。）

# php - 在 32 位系统上将 64 位整数十六进制字符串转换为 64 位十进制字符串

> ID：11867928
> 
> 赞同：4
> 
> 时间：2012-08-08T15:25:30.253
> 
> 标签：php

在 32 位系统上将编码为十六进制字符串的 64 位整数转换为十进制字符串的简单方法是什么。它必须是完整值，不能是科学计数法或截断：/

“0c80000000000063”==“900719925474099299”

“0c80000000000063”！= 9.007199254741E+17

PHP 的 base_convert() 和 hexdec() 不能正确完成这项工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T02:22:25.670

您需要使用[BC Math](http://www.php.net/manual/en/book.bc.php) PHP 扩展（捆绑）。

首先拆分您的输入字符串以获得高字节和低字节，然后将其转换为十进制，然后通过 BC 函数进行计算，如下所示：

```
$input = "0C80000000000063";

$str_high = substr($input, 0, 8);
$str_low = substr($input, 8, 8);

$dec_high = hexdec($str_high);
$dec_low  = hexdec($str_low);

//workaround for argument 0x100000000
$temp = bcmul ($dec_high, 0xffffffff);
$temp2 = bcadd ($temp, $dec_high);

$result = bcadd ($temp2, $dec_low);

echo $result;

/*
900719925474099299
*/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:38:59.823

您是否在 php.net 上看到了 hexdec 帮助页面的第一条评论？

> 当给定大数时，hexdec 函数会自动将值转换为科学计数法。因此，“aa1233123124121241”作为十六进制值将转换为“3.13725790445E+21”。如果要转换表示哈希值（md5 或 sha）的十六进制值，则需要该表示的每一位以使其有用。通过使用 number_format 函数，您可以完美地做到这一点。例如 ：

```
<?php

            // Author: holdoffhunger@gmail.com

        // Example Hexadecimal
        // ---------------------------------------------

    $hexadecimal_string = "1234567890abcdef1234567890abcdef";

        // Converted to Decimal
        // ---------------------------------------------

    $decimal_result = hexdec($hexadecimal_string);

        // Print Pre-Formatted Results
        // ---------------------------------------------

    print($decimal_result);

            // Output Here: "2.41978572002E+37"
            // .....................................

        // Format Results to View Whole All Digits in Integer
        // ---------------------------------------------

            // ( Note: All fractional value of the
            //         Hexadecimal variable are ignored
            //         in the conversion. )

    $current_hashing_algorithm_decimal_result = number_format($decimal_result, 0, '', '');

        // Print Formatted Results
        // ---------------------------------------------

    print($current_hashing_algorithm_decimal_result);

            // Output Here: "24197857200151253041252346215207534592"
            // .....................................

?> 
```

# c++ - 如何清除 ActiveX OCX 控件的绘图区域？

> ID：11867929
> 
> 赞同：0
> 
> 时间：2012-08-08T15:25:33.573
> 
> 标签：c++, mfc, activex, ondraw, ocx

我在绘制 ActiveX 控件时遇到了一些麻烦。在下面的屏幕截图中，您可以看到在 VB6 IDE 中调整大小后的控件。调整大小之前的控件轮廓仍显示在控件的左侧：

![在此处输入图像描述](../Images/10d555c8693422a97361145f6ecc7d51.png)

这是用红色 Z 绘制黑色省略号的代码：

```
void CzFileIoXCtrl::OnDraw(CDC* pdc, 
                           const CRect& rcBounds, 
                           const CRect& rcInvalid)
{
    if (!pdc)
    {
        return;
    }

    pdc->SetBkMode(TRANSPARENT); 
    pdc->SelectObject(CBrush::FromHandle((HBRUSH)GetStockObject(BLACK_BRUSH)));
    pdc->Ellipse(rcBounds.left, rcBounds.top, 
                 rcBounds.left + rcBounds.Width(), 
                 rcBounds.top + rcBounds.Height());       

    HFONT font = CreateFont(int(rcBounds.Height() * 0.7),
                            int(rcBounds.Width()  * 0.5),
                            0, 0, FW_BLACK, FALSE, FALSE, FALSE,
                            ANSI_CHARSET,
                            OUT_DEFAULT_PRECIS,
                            CLIP_DEFAULT_PRECIS,
                            CLEARTYPE_QUALITY,
                            FF_DECORATIVE, NULL);
    pdc->SelectObject(font);
    pdc->SetTextColor(RGB(255, 0, 0));
    DRAWTEXTPARAMS params = { sizeof(DRAWTEXTPARAMS), 1, 0, 0, 1 };
    RECT bounds = rcBounds;
    CString z(L"Z");
    pdc->DrawTextEx(z, &bounds, DT_CENTER | DT_VCENTER | DT_SINGLELINE, &params);
} 
```

**如何清除绘图区域？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:28:37.607

我设法在 vb 表单编辑器中重现了这一点。看起来问题来了，因为您没有在椭圆之外绘制任何东西。因此，在 OnDraw() 中绘制任何内容之前，您可以像这样在整个区域中绘制一个矩形。

```
pdc->FillRect( rcBounds, &CBrush(TranslateColor( AmbientBackColor() )) ); 
```

我对此进行了测试并且工作正常。

# sql-server - NVARCHAR 的奇怪异常

> ID：11867933
> 
> 赞同：2
> 
> 时间：2012-08-08T15:25:42.347
> 
> 标签：sql-server, nvarchar

这个给出了例外：*'NVARCHAR' 不是一个公认的内置函数名。*

```
DECLARE @BatchIds TABLE
    (
      BatchId AS UNIQUEIDENTIFIER ,
      UserLogonId AS NVARCHAR(80) ,
      ReportStatus NVARCHAR(100) ,
      Created DATETIME ,
      RunTimeInMins AS INT ,
      ReportName NVARCHAR(200)
    ) 
```

当我删除 NVARCHAR 的“AS”时，它没有给出任何异常。

```
DECLARE @BatchIds TABLE
    (
      BatchId AS UNIQUEIDENTIFIER ,
      UserLogonId NVARCHAR(80) ,
      ReportStatus NVARCHAR(100) ,
      Created DATETIME ,
      RunTimeInMins AS INT ,
      ReportName NVARCHAR(200)
    ) 
```

关于为什么的任何建议？

**更新：**

请注意，我的问题更多是针对为什么 AS 在这种情况下的工作方式与试图解决工作情况不同的原因。对于那些无法让第二个样本工作的人，请试试这个。*这为我提供了与Microsoft SQL Server 2008 R2 (RTM) - 10.50.1600.1 (X64)*相同的数据和 SQL Server 版本。

 *```
DECLARE @BatchIds TABLE
    (
      UserLogonId NVARCHAR(80) ,
      ReportStatus NVARCHAR(100) ,
      Created DATETIME
    )
INSERT  INTO @BatchIds
        ( UserLogonId ,
          ReportStatus ,
          Created
        )
VALUES  ( 'Test1' ,
          'Test2' ,
          '2012-08-08'
        )

SELECT  *
FROM    @BatchIds
SELECT  @@VERSION AS [Version] 
```

在此查询中为 NVARCHAR 放置一个 AS 会引发与上述相同的异常。

**更新：**

这解决了。此行为仅在您编译它并且 SQL Server 允许您编译它时出现。但是当你运行它时，它会为任何使用 AS 的数据类型抛出异常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T15:29:29.240

您不需要所有这些`AS`关键字 - 只需像这样定义表变量：

```
DECLARE @BatchIds TABLE
(
  BatchId UNIQUEIDENTIFIER ,
  UserLogonId NVARCHAR(80) ,
  ReportStatus NVARCHAR(100) ,
  Created DATETIME ,
  RunTimeInMins INT ,
  ReportName NVARCHAR(200)
) 
```

当尝试在我的 SQL Server 2008 R2 (SP1 - Developer Edition) 上运行您的示例 #2 时，我收到以下错误：

> *消息 207，级别 16，状态 1，第 3 行
> 无效的列名称“UNIQUEIDENTIFIER”。*
> 
> *消息 207，级别 16，状态 1，第 7 行
> 无效的列名称“INT”。*

我必须删除`AS`关键字才能使其正常工作。Using`AS`正在尝试为列定义**别名**- 但由于`UNIQUEIDENTIFIER`or`INT`是 SQL Server 中的保留关键字，因此您不能将它们用作列别名。SQL Server 2012 Express 也是如此 - 我也遇到了这些错误，除非我删除那些不必要的`AS`关键字，否则无法使其正常工作*

# svn - 这个svn结构有多好？

> ID：11867935
> 
> 赞同：7
> 
> 时间：2012-08-08T15:25:46.897
> 
> 标签：svn

![在此处输入图像描述](../Images/c6f802ce6acffad7e821e42d10c8addd.png)

以上是我计划在我的组织中用于 java 项目的结构模型。你们怎么看？它看起来很传统吗？此外，如果您选择 project1，在标签下，您可以看到 1.0.1、1.0.2 等 - 这些是发布标签，在发布后创建。现在，Dev 分支下会存在什么样的标签？它们什么时候被创建？我应该在 DevBranch 下为每个开发人员创建分支吗？我很困惑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T15:38:07.490

**你们怎么看？**

不好。通常，`branches` **不**包含进一步`tags`的 , `trunk`, `branches`。`Branch`就像`trunk`一个并行开发流。通常，您通过`copy`ing from `trunk`or from `tag`or from another来创建一个分支`branch`。除此之外没关系。

**它看起来很传统吗？**

是的。

**现在，Dev 分支下会存在什么样的标签？**

标签是指名称。你可以给他们一些描述性的名字.. like or `project1_new_caching_mechanism`or `project1_1.1_spot_fixes`-- 表示这可能是从发布`1.1`标签复制来修复发布中的一些问题。当您发布此分支时，您希望将这些修复合并到其他并行运行的分支和主干。

**它们什么时候被创建？**

每当您发现并行开发场景时。就像您想通过负载测试来提高性能并在不妨碍主要开发分支的情况下向其添加改进的代码一样。或用于现场修复。或用于功能替换..或用于多版本支持。

**我应该在 DevBranch 下为每个开发人员创建分支吗？**

**不**。SVN 是集中式存储库……（与 Git 不同），任何 SCM 的目的是允许多个开发人员同时处理它……您将通过为每个开发人员分离存储库来违背目的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T20:28:30.283

我建议这样做：

```
repo--tags
    --branches
    --trunk--project1
           --project2
           --project3 
```

...如果您想同时标记和分支所有项目

或这个：

```
repo--project1--tags
              --branches
              --trunk
    --project2--tags
              --branches
              --trunk
    --project3--tags
              --branches
              --trunk 
```

..如果您希望能够为每个项目分别进行标记和分支。

不要嵌套标签/分支/树干，这在概念上没有意义。

分支属于开发周期（即 myproject_1_1_sprint_1），标签标记项目在给定时间点的状态（即 myproject_1_1_RC03，表示版本 1.1 的候选发布 3）。请注意，这些纯粹是由约定确定的概念差异。SVN 在分支和标签之间没有技术差异，它们都是项目目录结构的所谓“[廉价副本](http://svnbook.red-bean.com/en/1.1/ch04s02.html#svn-ch-4-dia-3)”。

请参阅[这篇](http://nvie.com/posts/a-successful-git-branching-model/)描述 GIT 成功分支策略的优秀文章，该策略也适用于 SVN 等其他版本控制系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T15:34:18.350

如果我没有完全错，我认为在开发（和实验）之下，应该没有分支/标签/树干。如果你想创建 dev 分支的发布，你可以把它放在这里：

```
/svn/projects/project1/tags/dev-1.0.1 
```

或类似的东西。例如 Dev 和 Experimental 就像每个分支的主干文件夹。如果您想从 Dev 创建一个分支，您可以将其称为 Dev2，但我认为这会使它变得比要求的更复杂。

此外，我根本不会使用 Dev，而是做属于主干中 Dev 分支的所有事情

```
/svn/projects/project1/trunk 
```

但可能有充分的理由拥有一个额外的 Dev 分支。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T15:28:14.280

对我来说看上去很好。`test`如果您需要使用 Maven 或 Ivy 将其自动化，我也会添加。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-08T15:35:02.860

你需要阅读[SVNBook (Version Control with Subversion)](http://svnbook.red-bean.com/)。我认为标签不属于那里。

我不喜欢你的 Dev、Experimental 等。这些就是 /branches 的意义所在。完成后，您可以将它们合并到 /trunk 或直接挂在树枝上。

标签适用于当您投入生产并且您想要创建一个只读的、永不被修改的已发布分支的副本时。

您可以选择安排存储库：

1.  一个包含 /trunk、/branches 和 /tags 的存储库，以及这些项目下的项目。
2.  一个存储库下面有多个项目，每个项目下面都有自己的 /trunk、/branches 和 /tags。
3.  每个项目一个存储库，每个存储库都有自己的 /trunk、/branches 和 /tags。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-08T15:39:11.993

似乎您希望拥有“每个功能的分支”，其中每个功能或开发人员都有自己的分支，该分支被提升为完成该功能的主干。如果是这样，您可能想看看像 mercurial 或 git 这样的分布式版本控制系统。

如果你想使用 svn（你可能有充分的理由），那么我建议有两个不同`branch`的目录：一个`dev-branches`用于为功能、开发人员或概念证明创建的分支，以及`branches`用于生产代码的分支（能够在开发过程中修复生产中的错误），并从头`Experimental`开始`Dev`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-08T15:39:38.740

就个人而言，我喜欢使用分支来进行标记编号的持续工作，以及静态快照的标记。这样，当需要冻结 的发布时`1.0.1`，我会将主干复制到其中，并且当我在最终稳定/错误修复期间构建发布时，我会在、等`branches\1.0.1`中制作不可编辑的副本。`tags\1.0.1.5``tags\1.0.1.11`

关键是制作一个快速脚本来检查父目录是否是`tags`目录，然后在创建子目录后重新配置子目录以使其没有写入权限。否则，您的标签是移动标签，这违背了静态标签的目的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-08T15:47:43.033

我会简化你所拥有的。“DEV”应该是你的后备箱。你应该从你的项目级别开始，每个项目都应该有一个标签、主干和分支目录。

```
projects/<project>
    tags
    trunk
    branches 
```

如果您需要上面提到的“Experimenal”和“Client-1”之类的东西，它应该是基于主干的分支

```
projects/<project>/branches/experimental
projects/<project>/branches/client-1 
```

同样，标签应该在一个共同的地方，你可以使用文件夹来组织它们：

```
projects/<project>/tags/experimental
projects/<project>/tags/client-1 
```

这有很多原因

1.  用户的可预测性 ==> 无论他们在哪个模块中，都应该能够预测您的 svn 结构。
2.  钩子的可预测性 ==> 保持标签只读的钩子确实需要一个可预测的结构，以避免过于复杂。
3.  合并 ==> 你的“experimental”和“client-1”分支应该从你的主干分支出来，这样就可以很容易地将主干功能一致地合并到这些分支。同样，您也可以合并特征，只要它们是从主干分支出来的。

而且我敢肯定还有更多，但这些都是我突然想到的。

# xml - XSLT 之后的 xml 是空的吗？

> ID：11867941
> 
> 赞同：0
> 
> 时间：2012-08-08T15:26:08.137
> 
> 标签：xml, xslt

所以昨天，我使用了以下代码，它能够产生一些东西：

```
<xsl:variable name="radiofields" select="AllYourBase/*[name() != 'Australia']"/>
<Table style="width:100%; table-layout: fixed;" cellspacing="0" cellpadding="2">    
    <xsl:for-each select="$radiofields">
        <xsl:variable name="i" select="position()"/>
        <xsl:copy-of select="@*"/>                      
        <xsl:copy-of select="*[name() != 'ReadOnly']"/> 
    </xsl:for-each>
</Table> 
```

它能够通过 XSLT 处理器生成一些东西。

现在，根本没有输出...可能是其他人更改或更改了 xml 吗？无论如何要在我上面的 xsl 文件中创建一个记录器来测试是否`radiofields`为空，或者至少打印出它的内容？

# php - Bitnami PHP 不会从 shebang 评估

> ID：11867948
> 
> 赞同：2
> 
> 时间：2012-08-08T15:26:41.927
> 
> 标签：php, shell, mamp, shebang, bitnami

我正在尝试从命令行运行 PHP 脚本。当我使用**Bitnami**的 php 解释器运行它时，它工作正常。例如，我有脚本`test_php`，其内容是

```
#!/Applications/drupal/php/bin/php
<?php print 'hello world'; ?> 
```

如果我`/Applications/drupal/php/bin/php test_php`在 shell 中运行它工作正常：

```
$ /Applications/drupal/php/bin/php test_php
hello world$ 
```

但是如果我运行`test_php`，我会得到：

```
$ test_php
./test_php: line 2: syntax error near unexpected token `newline'
./test_php: line 2: `<?php print 'hello world'; ?>' 
```

这只发生在 Bitnami 的 PHP 位置上。shebang 适用于 OS X 附带的版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-16T00:00:18.170

它看起来像一个换行问题。尝试运行`dos2unix test_php`并再次尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-14T12:31:12.727

Bitnami不直接执行php，所以需要使用：

```
#!/usr/bin/env /Applications/drupal/php/bin/php 
```

我在这里找到了答案：[https ://stackoverflow.com/a/15841448/2779168](https://stackoverflow.com/a/15841448/2779168)

# c# - 无法将值从 ajax.beginform 传递给控制器 的方法

> ID：11867952
> 
> 赞同：-3
> 
> 时间：2012-08-08T15:26:49.337
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, razor

**看法：**

```
@using (Ajax.BeginForm("EditP", "P",new AjaxOptions { InsertionMode = InsertionMode.Replace, HttpMethod = "POST", UpdateTargetId = "divReplace" }))
{     
    @Html.HiddenFor(model => model.Req,new {@id="req"});   
} 
```

**控制器：**

```
[HttpPost]
public PartialViewResult EditP(long requestSequence,FormCollection form)
{  
    ...........
} 
```

我可以看到`Model.req`值为 234，但当它到达控制器时显示为 0。

至少当我`form.Get("req")`用来收集值时，这也显示为 0。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:06:14.977

我相信如果您只是将控制器代码更改为：

```
[HttpPost]
public PartialViewResult EditSCP(long Req,FormCollection form)
{  
    ...........
} 
```

然后变量 Req 将具有您想要的值。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T17:53:12.767

我想，这里的模型有问题，你的模型应该有`get;`&`set;`像这样......

```
public class MyModel
{
 public long Req {get; set;}    
} 
```

# php - 检查所有数据，计算它们，按计数排序并返回每个数据bt mysql之一

> ID：11867959
> 
> 赞同：0
> 
> 时间：2012-08-08T15:27:13.123
> 
> 标签：php, mysql

我有一个包含一些数据的表，如下所示：

**编号** ：1,2,3,4,5,6,7,8,9,10

**数据**：3,2,3,2,5,3,2,3,5,1

我想要这个**输出：3,2,5,1**

这意味着 MySQL 检查所有数据，对它们进行计数，按计数排序并返回每个数据之一。

我尝试@mysql_query`('SELECT * FROM`数据表`GROUP BY data');`

但它返回一个未排序的组数据，我有重复的数据，如 3333222551

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:29:30.953

注意：我包含`data`在`ORDER BY`子句中，以便在计数相同的情况下获得确定性顺序：

```
SELECT `data`
FROM `datatable` 
GROUP BY `data`
ORDER BY COUNT(*) DESC, `data` 
```

# .net - 包含括号的动态 LINQ 查询的问题

> ID：11867962
> 
> 赞同：6
> 
> 时间：2012-08-08T15:27:21.117
> 
> 标签：.net, sql, sql-server, linq, dynamic-linq

我在我的 .NET MVC 应用程序中使用动态 Linq 库（[这个](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)）来查询 SQL Server 数据库。到目前为止一切正常。

但是，每当我使用方括号来指定包含空格或连字符的麻烦列名时，动态 Linq 库都会给出“预期表达式”错误。这里有些例子：

```
var query = context.FetchIceCream().AsQueryable().Where("Chocolate = 1"); // This is fine
var query = context.FetchIceCream().AsQueryable().Where("[Rum and Raisin] = 1"); // This results in an "Expression expected" error 
```

我无法重命名任何列名，所以这不是一个选项 - 我需要能够在代码中对其进行排序。我已经到处寻找解决方案，但无济于事......请帮助拯救我的理智！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T08:40:44.483

所以我认为这就是答案：
您在 Where 子句中使用的名称必须是您在 Queryable 集合中拥有的对象的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:44:46.890

我建议完全不要使用动态 LINQ。只需将内容添加到`IQueryable<T>`.

# spring - 通过 Spring 集成入站适配器接收 JMS 消息随机失败

> ID：11867966
> 
> 赞同：2
> 
> 时间：2012-08-08T15:27:35.453
> 
> 标签：spring, jms, spring-integration

我是这个 Spring Integration 和 JMS 的新手，我开始使用它。在这里，我想通过 activemq 创建普通的 jms 消息并通过 spring 入站适配器（消息驱动）接收它。

以下是我的弹簧配置文件

```
 <?xml version="1.0" encoding="UTF-8"?>
    <beans:beans xmlns="http://www.springframework.org/schema/integration"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:beans="http://www.springframework.org/schema/beans"
xmlns:stream="http://www.springframework.org/schema/integration/stream"
xmlns:jms="http://www.springframework.org/schema/integration/jms"
xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/integration
        http://www.springframework.org/schema/integration/spring-integration.xsd
        http://www.springframework.org/schema/integration/stream
        http://www.springframework.org/schema/integration/stream/spring-integration-stream.xsd>
        http://www.springframework.org/schema/integration/jms
        http://www.springframework.org/schema/integration/jms/spring-integration-jms.xsd">

<!-- jms beans -->
<beans:bean id="jms.msgQueue" class="org.apache.activemq.command.ActiveMQQueue">
    <beans:constructor-arg value="MSG_QUEUE" />
</beans:bean>

<beans:bean name="jms.connectionFactory" class="org.apache.activemq.ActiveMQConnectionFactory">
    <beans:property name="brokerURL" value="tcp://localhost:61616" />
</beans:bean>

 <!-- spring integration beans -->
<channel id="channels.jms.allMessages">
    <queue capacity="1000" />
</channel>

<jms:message-driven-channel-adapter id="adapters.jms.msgAdapter"
            connection-factory="jms.connectionFactory"
            destination="jms.msgQueue"
             channel="channels.jms.allMessages" /> 
```

这是我的测试课

```
package com.bst.jms;

import javax.jms.Connection;
import javax.jms.ConnectionFactory;
import javax.jms.Destination;
import javax.jms.JMSException;
import javax.jms.MessageProducer;
import javax.jms.Session;
import javax.jms.TextMessage;

import org.springframework.context.support.AbstractApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import org.springframework.integration.Message;
import org.springframework.integration.core.PollableChannel;

public class TestActiveMQ {

public static void main(String[] args){

    try{
        AbstractApplicationContext context = new ClassPathXmlApplicationContext("app-context.xml");
        ConnectionFactory connectionFactory = (ConnectionFactory)context.getBean("jms.connectionFactory");
        Destination destination = (Destination)context.getBean("jms.msgQueue");
        PollableChannel msgChannel = (PollableChannel) context.getBean("channels.jms.allMessages", PollableChannel.class );

        Connection connection = connectionFactory.createConnection();
        Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);

        MessageProducer producer = session.createProducer(destination);

         TextMessage textMessage = session.createTextMessage();
         textMessage.setText("Message from JMS");
         producer.send(textMessage);

         System.out.println("--------------- Message Sending ------------------------");

         Message<?> received = msgChannel.receive();
         String payload = (String) received.getPayload();

         System.out.println("Receving message = " + payload);
    }catch(JMSException ex){
        System.out.println("----------- JMS Exception --------------");
    }

} 
```

}

但问题是我不能保证交货。有时该程序无法接收该消息，而某些大部头它会成功并出现一些警告，例如

```
Setup of JMS message listener invoker failed for destination 'queue://MSG_QUEUE' -   trying to recover. Cause: Connection reset
Could not refresh JMS Connection for destination 'queue://MSG_QUEUE' - retrying in 5000 ms. Cause: Could not connect to broker URL: tcp://localhost:61616\. Reason: java.net.ConnectException: Connection refused: connect 
```

无法刷新目标“queue://MSG_QUEUE”的 JMS 连接 - 5000 毫秒后重试。原因：无法连接到代理 URL：tcp://localhost:61616。原因：java.net.ConnectException：连接被拒绝：连接

这在成功之前发生了几次。

你们对此有什么想法吗。

感谢你的帮助。

谢谢，凯丝

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:51:27.997

这只是意味着当侦听器容器启动时代理没有运行。使用 tcp:// URL 时，您应该在创建此上下文之前在其自己的上下文（或另一个 JVM）中运行代理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T09:05:52.627

我已经在我的 STS 中测试了这些代码，它工作正常。

您这边唯一的问题是，首先启动消息代理（比如 ActiveMQ）然后运行您的项目，您可以获得所需的输出。

谢谢。

# mongodb - MongoEngine - 查询 - 如何检查 ListField 是否为空或未设置

> ID：11867967
> 
> 赞同：9
> 
> 时间：2012-08-08T15:27:37.900
> 
> 标签：mongodb, mongoengine, listfield

如何检查`ListField()`Mongo 类的属性是否未设置或为空？

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-13T16:49:04.857

嗨，您可以使用[$exists](http://mongoengine-odm.readthedocs.org/en/latest/guide/querying.html?highlight=exists%20size#query-operators%29)和[$size](http://mongoengine-odm.readthedocs.org/en/latest/guide/querying.html?highlight=exists%20size#query-operators%29)：

```
import unittest
from mongoengine import *

class Test(unittest.TestCase):

    def setUp(self):
        conn = connect(db='mongoenginetest')

    def test_list_exists_or_has_size(self):

        class Post(Document):
            title = StringField(required=True)
            tags = ListField(StringField())

        Post.drop_collection()

        Post(title="Hello Stackoverflow").save()
        Post(title="Hello twitter", tags=[]).save()
        Post(title="Hello world", tags=['post', 'blog']).save()

        self.assertEqual(2, Post.objects(
                                Q(tags__exists=False) |
                                Q(tags__size=0)).count()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-07T16:48:49.140

如果您正在寻找相反的问题（检查**列​​表是否至少包含一个**暗示它也存在的元素），那么您可以使用查询字典进行更改：

```
query = {}
query['tags__exists'] = True
query['tags__not__size'] = 0
for post in Post.objects(**query):
    print(post) 
```

根据 MongoEngine[文档](http://docs.mongoengine.org/guide/querying.html#query-operators)，该`not`运算符可用于否定标准检查，只要它位于查询运算符之前。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-13T15:26:31.643

不完全确定这是否是*空*或未*设置*ListField 的意思：

```
from mongoengine import *

connect('tumblelog')

class Post(Document):
    title = StringField(required=True)
    tags = ListField(StringField())

post1 = Post(title='Fun with MongoEngine', tags=['mongodb', 'mongoengine'])
post1.save()

for post in Post.objects:
    print post.title
    if not post.tags:
        print '-post has no tags'
    else:
        print post.tags 
```

这将输出：

```
Fun with MongoEngine
[u'mongodb', u'mongoengine']
Fun with MongoEngine no tags
-post has no tags 
```

# r - 如何更改特定列中等于给定值的值？

> ID：11867968
> 
> 赞同：3
> 
> 时间：2012-08-08T15:27:42.293
> 
> 标签：r, dataframe

`data_active`是任何数据集。

理想情况下，当条件满足时，必须更改值。但是当我执行这段代码时，它会将每个指定列中的值更改为`if`语句中给定的值。

```
for (i in 1:nrow(data_active))
{
 if(data_active[i,1]==4866)
 {
  data_active$St="MH" 
  data_active$Reg="South Central" 
  data_active$REGION="South"
  data_active$Market="86"
 }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T15:38:14.677

你需要习惯“用 R 思考”的心态。您不需要 for 循环或 if 语句。您只需一行代码就可以做到这一点。

尝试以下操作（将 id 替换为您的列名）：

```
data_active[data_active$id == 4866,c("St","Reg","REGION","Market")] <- c("MH","South Central", "SOUTH", "86") 
```

首先，该语句查找 id 与 4866 匹配的行，并从中选择由 c 创建的列表中的列。

```
data_active[data_active$id == 4866,c("St","Reg","REGION","Market")] 
```

其次，它将这些列的值设置为一个新列表，其中包含您想要的值。

```
<- c("MH","South Central", "SOUTH", "86") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T15:34:16.073

在您的`if`语句中，您已经为整个列分配了一个值，而不仅仅是`i`. 要仅分配给特定行，您需要仅分配给向量的该元素。

```
for (i in 1:nrow(data_active))
{
 if(data_active[i,1]==4866)
 {
  data_active$St[i]="MH" 
  data_active$Reg[i]="South Central" 
  data_active$REGION[i]="South"
  data_active$Market[i]="86"
 }
} 
```

也就是说，这不是在`R`. 更自然的是使用逻辑索引。

```
data_active$St[data_active[,1]==4866]="MH" 
data_active$Reg[data_active[,1]==4866]="South Central" 
data_active$REGION[data_active[,1]==4866]="South"
data_active$Market[data_active[,1]==4866]="86" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T15:33:36.583

您必须指出要更改哪一行的值。否则，每次都会为*所有*`data_active[i,1]==4866`行赋予新值。

尝试这个：

```
for (i in 1:nrow(data_active))
{
 if(data_active[i,1]==4866)
 {
  data_active$St[i]="MH" 
  data_active$Reg[i]="South Central" 
  data_active$REGION[i]="South"
  data_active$Market[i]="86"
 }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T17:03:47.730

与 Ina 解决方案几乎相同，但也适用于具有不同类型的列（请参阅 Brian Diggs 对 Ina 解决方案的评论）。

```
data_active[data_active$id == 4866,
            c("St","Reg","REGION","Market")] <- list("MH","South Central", "SOUTH", "86") 
```

# .net - 使用 System.Linq；在.net

> ID：11867969
> 
> 赞同：-1
> 
> 时间：2012-08-08T15:27:43.673
> 
> 标签：.net, linq

我想通过 publish_at 返回最新的投票顺序

就像是 ：

```
return  db.Polls.Where(p => p.status.Equals(PollStatus.Active))
                .OrderByDescending(d => d.publish_at)
                .Take(1); 
```

不幸的是，这不起作用。我怎样才能得到最近的结果，而不是每一个结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:31:23.930

您当前的代码所拥有的是一个*Enumerable*，它将仅迭代一个项目。您还没有项目本身。

而不是`.Take(1)`，尝试使用`.First()`or `.Single()`，或者也许`.FirstOrDefault()`or `.SingleOrDefault()`。值得您花时间查找和阅读每个文档的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:30:08.040

在这里我的帖子获取最后一条记录，如果你想获得最后插入的记录，这将对你有所帮助

[使用 Linq to SQL 获取最后 n 条记录](http://pranayamr.blogspot.in/2012/05/get-last-n-records-using-linq-to-sql.html)

获取最后记录的简单方法

```
var qry = db.ObjectCollection
                     .Where(m => m.<field> == data)
                     .OrderByDescending(m => m.<field>)
                     .FirstOrDefault(); 
```

如果你想要最后 n 条记录

```
var qry = db.ObjectCollection
                     .Where(m => m.<field> == data)
                     .OrderByDescending(m => m.<field>)
                     .Take(n); 
```

# php - 从 magento 中的模块添加生成的 html 的可能性是什么？

> ID：11867976
> 
> 赞同：-2
> 
> 时间：2012-08-08T15:28:03.733
> 
> 标签：php, magento

我正在尝试在 Magento 中调试外部模块。在那，当我登录管理端时，我弹出了一些消息，也收到了一条通知消息。安装的模块生成脚本代码以提醒弹出消息，div 显示通知。此 HTML 生成并附加在 DASHBOARD 页面中，该页面的主体类为“ `adminhtml-dashboard-index`”

我想可能有某种方法可以使用仪表板页面推送生成的代码。

有哪些可能的方法来添加外部模块通知或一些 html 或生成的带有 DASHBOARD 等核心模块的 js 脚本？

希望你能理解我的问题...

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T18:42:03.263

这是在其中放置块的一种方法。观察 adminhtml_block_html_before 事件：

```
<events>
    <adminhtml_block_html_before>
        <observers>
            <super_adminhtml_block_html_before>
                <class>super/observer</class>
                <method>beforeAdminHtml</method>
            </super_adminhtml_block_html_before>
        </observers>
    </adminhtml_block_html_before>

</events> 
```

然后，创建一个新块并将其附加到通知块。

```
public function beforeAdminHtml($observer)
{
    $block = $observer->getEvent()->getBlock();
    if ($block->getNameInLayout() == 'root') {
        $extendBlock = $this->_createMyNoticeBlock();
        if ($extendBlock) {
            $block->getChild('notifications')->append($extendBlock);
        }
    }
} 
```

我用它来插入我自己的 HTML 块，通知通常显示在标题中 - 不仅显示在仪表板上，而且显示在所有管理页面上。

# eclipse - XText 以编程方式将 DSL 脚本解析为 Ecore 模型

> ID：11867986
> 
> 赞同：8
> 
> 时间：2012-08-08T15:28:50.083
> 
> 标签：eclipse, eclipse-emf, xtext

我需要以编程方式将符合 XText 语法的文本转换为符合 XText 从相同语法生成的 Ecore 元模型的 AST。

我知道 XText 也会生成实现此类解析器的 Java 类，但我不知道它们在哪里以及如何使用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T09:13:04.000

这个问题的完整答案可以在 Eclipse wiki的[Xtext 页面上找到。](http://wiki.eclipse.org/Xtext/FAQ#How_do_I_load_my_model_in_a_standalone_Java_application.C2.A0.3F)

```
 new org.eclipse.emf.mwe.utils.StandaloneSetup().setPlatformUri("../");
 Injector injector = new MyDslStandaloneSetup().createInjectorAndDoEMFRegistration();
 XtextResourceSet resourceSet = injector.getInstance(XtextResourceSet.class);
 resourceSet.addLoadOption(XtextResource.OPTION_RESOLVE_ALL, Boolean.TRUE);
 Resource resource = resourceSet.createResource(URI.createURI("dummy:/example.mydsl"));
 InputStream in = new ByteArrayInputStream("type foo type bar".getBytes());
 resource.load(in, resourceSet.getLoadOptions());
 Model model = (Model) resource.getContents().get(0); 
```

将文件扩展名 ( `mydsl`) 更改为您自己的语言扩展名。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-09T10:47:53.180

这是代码：

```
@Inject
ParseHelper<Domainmodel> parser

def void parseDomainmodel() {
  // When in a vanilla Java application (i.e. not within Eclipse),
  // you need to run a global setup:
  val injector = new MyDslStandaloneSetup().createInjectorAndDoEMFRegistration
  injector.injectMembers(this) // sets the field 'parser'

  // this is how you can use it:
  val model = parser.parse(
    "entity MyEntity {
      parent: MyEntity
    }")
  val entity = model.elements.head as Entity
  assertSame(entity, entity.features.head.type)
} 
```

另请参阅[http://www.eclipse.org/Xtext/documentation.html#TutorialUnitTests](http://www.eclipse.org/Xtext/documentation.html#TutorialUnitTests)。

# android - 在 Android 中通过 Intent 打开 Google Plus 页面

> ID：11867989
> 
> 赞同：21
> 
> 时间：2012-08-08T15:29:08.700
> 
> 标签：android, android-intent, google-plus

我有一个`Google Plus`页面

[https://plus.google.com/u/0/b/101839105638971401281/101839105638971401281/posts](https://plus.google.com/u/0/b/101839105638971401281/101839105638971401281/posts)

和一个安卓应用程序。**我想在我的应用程序中打开此页面。我不想打开浏览器！**

这将打开浏览器：

```
URL="https://plus.google.com/b/101839105638971401281/101839105638971401281/posts";
uri = Uri.parse(URL);
it = new Intent(Intent.ACTION_VIEW, uri);
startActivity(it); 
```

这崩溃了：

```
 Intent intent = new Intent(Intent.ACTION_VIEW);

intent.setClassName("com.google.android.apps.plus",             "com.google.android.apps.plus.phone.UrlGatewayActivity");

intent.putExtra("customAppUri", "10183910563897140128");
startActivity(intent); 
```

提前致谢！

**[解决了]**

```
startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("https://plus.google.com/101839105638971401281/posts"))); 
```

使用此解决方案，用户可以选择 Google Plus APP 或打开浏览器。如果选择了APP，则不会崩溃。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-08T16:44:37.800

如果用户安装了 Google+ 应用，您可以这样做：

```
startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("https://plus.google.com/101839105638971401281/posts"))); 
```

请注意 URI 的语法，它不包含`/b/id/`.

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-01-23T10:11:43.040

您必须首先检查用户是否已经在他/她的手机中安装了 G+ 应用程序？如果是，那么我们可以通过特定意图启动它，或者我们可以使用浏览器重定向到特定页面。

这是这种流程中的一种方法，

```
public void openGPlus(String profile) {
    try {
        Intent intent = new Intent(Intent.ACTION_VIEW);
        intent.setClassName("com.google.android.apps.plus",
          "com.google.android.apps.plus.phone.UrlGatewayActivity");
        intent.putExtra("customAppUri", profile);
        startActivity(intent);
    } catch(ActivityNotFoundException e) {
        startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("https://plus.google.com/"+profile+"/posts")));
    }
} 
```

现在你可以简单地调用这个方法，

```
//117004778634926368759 is my google plus id
openGPlus("117004778634926368759"); 
```

**扩展答案**：**twitter 和 facebook 你可以使用相同的方式**，

**对于推特**，

```
public void openTwtr(String twtrName) {
        try {
           startActivity(new Intent(Intent.ACTION_VIEW,Uri.parse("twitter://user?screen_name=" + twtrName)));
        } catch (ActivityNotFoundException e) {
           startActivity(new Intent(Intent.ACTION_VIEW,Uri.parse("https://twitter.com/#!/" + twtrName)));
        }
} 
```

**而对于 Facebook**，

```
public void openFB(String facebookId) {
    try{
        String facebookScheme = "fb://profile/" + facebookId;
        Intent facebookIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(facebookScheme));
        startActivity(facebookIntent);
    } catch (ActivityNotFoundException e) {
        Intent facebookIntent = new Intent(Intent.ACTION_VIEW,Uri.parse("https://www.facebook.com/profile.php?id="+facebookId));
        startActivity(facebookIntent);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-04T06:00:53.110

```
/**
 * Intent to open the official Google+ app to the user's profile. If the Google+ app is not
 * installed then the Web Browser will be used.
 * 
 * </br></br>Example usage:</br>
 * <code>newGooglePlusIntent(context.getPackageManager(), "https://plus.google.com/+JaredRummler");</code>
 * 
 * @param pm
 *            The {@link PackageManager}.
 * @param url
 *            The URL to the user's Google+ profile.
 * @return The intent to open the Google+ app to the user's profile.
 */
public static Intent newGooglePlusIntent(PackageManager pm, String url) {
    Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
    try {
        if (pm.getPackageInfo("com.google.android.apps.plus", 0) != null) {
            intent.setPackage("com.google.android.apps.plus");
        }
    } catch (NameNotFoundException e) {
    }
    return intent;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T16:44:24.067

堆栈跟踪在崩溃时会说什么？

另外我不确定这是否会有所作为，但 ID 中有错字。你写了：

```
intent.putExtra("customAppUri", "10183910563897140128"); 
```

但最初的 ID 是`101839105638971401281`. 你最后离开了 1 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-31T03:59:18.403

为什么不只是`Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));` 。Android 操作系统会查询所有可以处理特定 Uri 的应用程序。Google+ 作为一个应用程序，被编程为能够处理您请求的 Uri。所以它会在选择器中显示为一个选项（或者如果用户已经选择了 Google+ 应用程序作为该 Uri 的默认设置，则直接转到它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-23T16:58:06.637

```
public void openTwitter(String twitterName) {
    try {
       startActivity(new Intent(Intent.ACTION_VIEW,Uri.parse("twitter://user?screen_name=" + twitterName)));
    } catch (ActivityNotFoundException e) {
       startActivity(new Intent(Intent.ACTION_VIEW,Uri.parse("https://twitter.com/#!/" + twitterName)));
    }
} 
```

# entity-framework - 用于检索派生类型的 OData 查询

> ID：11867993
> 
> 赞同：2
> 
> 时间：2012-08-08T15:29:16.277
> 
> 标签：entity-framework, wcf-data-services, odata

虽然我正在浏览 OData 规范的 URI 语法以寻找答案，但我认为如果没有任何结果，可能值得一问。

如果我有一个实体：“base”，以及一个从 base 继承的实体：“Derived”，我最终会得到一个 Odata 查询，它可以检索 base 的所有实例：

blah.svc/bases()

但是我可以使用什么查询来仅返回那些派生实例？我尝试了各种形式的：

blah.svc/bases()?$filter=isof(Derived)

但无济于事。

不幸的是，我很难在网上找到这样的例子，那里的大多数东西只是谈论你如何不能在派生实体上拥有导航属性（这甚至不再是真的了！！）

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:35:06.313

您可以执行以下操作：**blah.svc/bases/Model.Derived** - Model.Derived 是模型中派生类型的全名（命名空间+名称）。

希望这可以帮助。

谢谢普拉蒂克