# StackOverflow 问答 10150000-10150999

# ruby - delay_job 钩子不在 Heroku 上执行

> ID：10150004
> 
> 赞同：2
> 
> 时间：2012-04-14T00:35:03.737
> 
> 标签：ruby, heroku, delayed-job

我正在使用延迟作业在 Heroku 上发送电子邮件，并且需要能够执行各种钩子后处理。下面的代码在开发环境中运行良好，但在 Heroku 上运行时无法执行。

```
class Notification < ActiveRecord::Base

  # Handler for Delayed Notifications Hooks
  #- takes in a Delayed::Job object and an optional exception
  def self.processed!(job,exception=nil)
     pay = job.payload_object.args
     # ... do something with the payload object here
  end

  class << self
    def deliver(method,to,ref_obj)
      to.each do |email|
        n = Notification.new(:method => method,:to => email,:delivery=>'email')
        n.obj = ref_obj
        n.save
        # This is where we send the actual email via ActionMailer
        Email.send(method, n).deliver
      end
    end
    handle_asynchronously :deliver

    # Failure handler for Delayed::Job.  
    # Marks our Notification Object as failed
    def error(job,exception)
      Notification.processed!(job,exception)
    end 
    # Success handler for Delayed::Job.  
    # Marks our Notification Object as sent
    def success(job)
      Notification.processed!(job)
    end
  end
end 
```

这就是拨打电话的方式：

```
user = User.find()   # Fetch a user object
Notification.deliver('joined','someone@email.com',user) 
```

电子邮件通过 Email.joined 正确发送，延迟作业记录已成功从数据库中删除，但延迟作业挂钩`success`从未被调用。

同样，这在开发中完美运行，但在部署到 Heroku 时无法运行。

# python - 在列表中查找项目

> ID：10150011
> 
> 赞同：0
> 
> 时间：2012-04-14T00:36:16.823
> 
> 标签：python, list, parsing

所以我试图在 python 的列表中找到一个项目。这是我的功能：

```
def operator(input):
    operatorlist = ['+', '-', '*', '/', '^', 'sin', 'cos']

    for i in operatorlist:
        if input is operatorlist[i]:
            return True 
```

我的代码坏了，我不知道为什么……有什么想法吗？

我改变了我的代码：

```
def operator(input):
    if input is '+' or input is '-' or input is '*' or input is '/' or input is '^' or input is 'sin' or input is 'cos':
    return True 
```

因为有人告诉我，从本质上讲，这样写在风格上是愚蠢的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T00:43:32.750

一条线 ：

```
return input in operatorlist 
```

这里不需要做条件，in 操作符已经返回一个布尔值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T00:39:15.787

这里有几件事：

*   函数定义行需要以冒号结尾。
*   缩进很重要。
*   你几乎从不想使用'is'。
*   您可以检查对象是否在列表中，而无需使用“in”运算符显式循环它。
*   如果你没有找到你要找的东西，你可能应该返回 False；大多数情况下你会侥幸逃脱，因为如果你没有明确返回，一个函数会返回 None ，并且 None 不是“真实的”。

所以试试：

```
def operator(input):
    operatorlist = ['+', '-', '*', '/', '^', 'sin', 'cos']

    if input in operatorList:
        return True

    return False 
```

或者更简洁：

```
def operator(input):
    operatorlist = ['+', '-', '*', '/', '^', 'sin', 'cos']
    return input in operatorList 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T00:40:56.410

使用`in`运算符：

```
return (input in operatorlist) 
```

（括号不是必需的，我已经将它们包括在内以使其更清楚。）

您可能需要通过[教程](http://docs.python.org/tutorial/)或[书籍](http://learnpythonthehardway.org/)来开始使用 Python。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-14T00:42:27.983

`for i in operatorlist`不会遍历 operatorlist 的索引，而是遍历实际元素。所以`i`将`'+'`在第一个循环中，`'-'`在第二个循环中，依此类推。

所以这`if input is operatorlist[i]`应该是这样的`if input is i`。

最后，实际上这整个函数都可以用逻辑运算来代替`input in operatorlist`。因此，您可以执行以下操作：

```
def operator(input):
    return input in ('+', '-', '*', '/', '^', 'sin', 'cos') 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-14T02:09:13.953

```
def operator(x):
    return x in {'+', '-', '*', '/', '^', 'sin', 'cos'} 
```

不过，您可能希望避免为每个函数调用创建一个新集合，在这种情况下，您可以...

```
def operator_check(*operators):
    operators = set(operators)
    def checker(x):
        return x in operators
    return checker

math_operator = operator_check('+', '/', '*', '^', '-')

if math_operator('+'):
    print "it's a math operator!" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-14T00:39:12.153

更改`for i in operatorlist`为`for i in range(len(operatorlist))`

当您只要求 时`i in operatorlist`，每次迭代`i`实际上将是该条目的元素，而不是索引。或者，您可以重新格式化循环的主体以反映它`i`是包含相关运算符的实际字符串，而不是索引。

# c# - Spring.net-ExpressionEvaluator 处理上下文对象的具体类型（假设隐式实现）

> ID：10150013
> 
> 赞同：2
> 
> 时间：2012-04-14T00:37:06.157
> 
> 标签：c#, expression, spring.net

我正在尝试通过`ExpressionEvaluator.getValue`以下方式使用 spring.net 的功能：

```
bool retVal = (bool)ExpressionEvaluator.getValue(mailMessage, "Subject.Contains('vijay')"); 
```

该`mailMessage`对象属于接口的具体类型，该接口在其契约`IMailMessage`中具有属性。`Subject`

现在的问题是`mailMessage`对象的类已经`IMailMessage`明确地实现了接口，这就是为什么`ExpressionEvaluator`它试图使用`ConcreteImplementation.Subject`并且因为它必须使用而失败`IMailMessage.Subject`。

最好的方法是什么，我当然不想隐式实现。

或者有没有办法在表达式中进行转换？

# java - 如何从数组中的指定值开始？

> ID：10150020
> 
> 赞同：-6
> 
> 时间：2012-04-14T00:38:28.490
> 
> 标签：java

例如：

```
String[] someArray = {null, "I want to start from here", "other element", "other element"};

for(int i = 1; i < someArray.length; i++)
{
    System.out.println(someArray[i]);
} 
```

除了将第一个元素设置为null之外，还有其他方法可以设置数组的初始索引吗？

在 for 循环中，我想设置`i = 1`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T00:47:08.900

当您希望从不同的元素开始时迭代元素的方法是更改​​起始索引。

```
for(int i = 1; i < n; i++) {
    // Iteration operation
} 
```

`i`是您唯一关心的事情，如果您希望从不同于 0 的位置开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T00:44:50.777

将第一个元素设置为 null 与使用 for 循环遍历数组的方式无关。

你可以将它设置为任何东西，你可以用任何东西开始你的 for 循环。

但是，决定您不喜欢基于零的索引是没有意义的。

这就是所有编程语言的工作方式（据我所知）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T00:51:33.393

无法设置数组的初始索引：它仍然有第一个（索引 0）元素，它恰好是`null`您的情况。你总是可以从你想要的任何索引开始迭代，但你会浪费空间。

你总是可以自己上课...

```
class WeirdIndexArray<T> {
    private final T[] internalArray;
    public final int firstIndex;
    public final int indexBound;
    public WeirdIndexArray( int firstIndex, int size ){
        internalArray = new T[size];
        this.firstIndex = firstIndex;
        indexBound = firstIndex+size;
    }
    public void set( int index, T item ){ internalArray[index-firstIndex] = item; }
    public T get( int index ){ return internalArray[index-firstIndex]; }
} 
```

并使用它...

```
WeirdIndexArray<String> array = new WeirdIndexArray<>(1,3);

for( int i=1; i<array.indexBound; i++ )
    array.set(i,"This is item "+i); 
```

但你**为什么**首先需要它呢？

# javascript - 如何正确评估“if”语句的元素可见性\不透明度\隐藏性

> ID：10150031
> 
> 赞同：0
> 
> 时间：2012-04-14T00:40:40.163
> 
> 标签：javascript, jquery

如何正确评估元素的“可见性”（松散地使用）？我熟悉 hide、show、fade、fadeToggle .opacity 以及其他一些功能，但这是我被难住的*评估。*

目标是更新由表单元素的任何更改触发的 DIV 中的文本（即 $('input').change() ）。DIV 中的文本源自表单上的每个 <input> 元素。如果用户选择修改元素，DIV 文本将更新为新值。但是，我试图让文本从当前字符串逐渐更改为更新后的字符串。（*还记得使用两台投影仪从一个图像渐变到下一个图像的互联网前“幻灯片”吗？*）

为了实现这一点，我认为我需要 2 个 DIV，一个在另一个之上。当#preview1 淡出时，#preview2 会随着更新的文本淡入。

所以我尝试了类似的东西（简化），但只有 fadeIn() 有效。“其他”永远不会确定。

```
$("input").change(function(){
    if($('#preview1').is(':visible'))
    //if($('#preview1').css('opacity',1))
    {
        $('#preview1').fadeOut();
        fnBuildPrev('#preview2');
        $('#preview2').fadeIn();
    }
    else
    {
        $('#preview2').fadeOut();
        fnBuildPrev('#preview1');
        $('#preview1').fadeIn();
    }
}); 
```

然后我发现了这个：[http](http://api.jquery.com/visible-selector/) ://api.jquery.com/visible-selector/它说：

> "*具有可见性的元素：隐藏或不透明度：0 被认为是可见的，因为它们仍然占用布局中的空间。* "

我在“if”语句中尝试*了*很多变化

我应该使用什么来进行正确的条件评估？

EDIT1：将“if”评估更改为“.is”，而不是我最初发布的（.not），这给了错误的印象。新秀发帖失误。

EDIT2：所以在不理解[Sam Tyson](https://stackoverflow.com/users/194044/sam-tyson)下面提供的内容之后（在这篇文章之前甚至没有听说过 jsFiddle），我开始[在 jsFiddle 中对他的建议进行胡闹](http://jsfiddle.net/styson/m6MQj/3/)。

我简化了脚本以更好地隔离确切的问题。

我将他示例中的 javascript 更改为以下内容：

```
$("input").click(function(){
    if($('#preview1').css('opacity',0))
    {
        $('#preview1').css('opacity',1);
    }
    else
    {
        $('#preview1').css('opacity',0);
    }
}); 
```

并将 #preview1 的 CSS 更改为以下内容：

```
#preview1 {
    border: 1pt solid blue;
    opacity: 0;
} 
```

据我所知，我遇到的真正问题是永远无法达到*else 。*所以#preview1 的不透明度实际上会在第一次点击时返回“0”。但是，第二次单击不会改变不透明度。我在 else 语句中尝试了许多元素修改，但它从未运行。

EDIT3：对此的正确答案来自下面的[布赖恩](https://stackoverflow.com/users/450941/brian-flanagan)。我创建[了自己的 jsFiddle](http://jsfiddle.net/brianckelley/7QLK3/8/)来解决这个问题。为了解决这个问题，我转向[Nil](https://chat.stackoverflow.com/users/457812/nil)帮助我的聊天室：

> NIL: if($('#preview1').css('opacity',0)) ← 这应该做什么？
> BRIAN: 将它设置为不可见
> NIL: 好的，为什么它在条件句中？

我在 if 语句中使用了一种方法，而不是检查属性的值。这就是对任何语言都不熟悉的考验。检查我的 jsFiddle 的工作版本。

布赖恩，无，谢谢伙计们！

[http://jsfiddle.net/brianckelley/7QLK3/8/](http://jsfiddle.net/brianckelley/7QLK3/8/)

编辑 4：Sam 给了我在 jsFiddle 中修改的基本代码。谢啦！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T01:04:54.460

.not() 从匹配元素集中移除元素。

你想要做的是使用“is()”函数：

```
$("input").click(function(){
  if($('#preview1').is(':visible')) {
      $('#preview1').fadeOut();
      fnBuildPrev('#preview2');
      $('#preview2').fadeIn();
  }
  else
  {
      $('#preview2').fadeOut();
      fnBuildPrev('#preview1');
      $('#preview1').fadeIn();
  }
}); 
```

见我的[jsFiddle](http://jsfiddle.net/styson/m6MQj/3/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T00:53:01.990

您可以更改条件：

```
if($('div').css('opacity') == 0){
    // do whatever
}​​​​​​​​​​​​​​​​​​ 
```

[jsfiddle 示例](http://jsfiddle.net/brianflanagan/zhW7C/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T00:53:25.610

你能检查一下这是否有效

```
if($('#preview1').css('display') == 'none') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T00:56:01.880

如果我理解正确，你想说`visibility: hidden`应该返回`false`并且`opacity:0`也应该返回 false。

只需自己检查评估.. 创建一个方法来检查每个

```
 $.fn.isTrulyNotVisible = function() { // silly name :P

        var $this = $(this);
        return !$this.is(':visible') || 
               $this.css('visibility') === 'hidden' || 
               !parseInt($this.css('opacity'), 10);
    }; 
```

[http://jsfiddle.net/KAbPx/1/](http://jsfiddle.net/KAbPx/1/)

```
$("input").change(function(){
    if($('#preview1').isTrulyNotVisible())

    {
        $('#preview1').fadeOut();
        fnBuildPrev('#preview2');
        $('#preview2').fadeIn();
    }
    else
    {
        $('#preview2').fadeOut();
        fnBuildPrev('#preview1');
        $('#preview1').fadeIn();
    }
}); 
```

# php - 是否可以使用谷歌静态地图 api 并将其转换为 jpg

> ID：10150035
> 
> 赞同：-1
> 
> 时间：2012-04-14T00:41:02.177
> 
> 标签：php, imagemagick, gd

是否可以使用谷歌静态地图 api 并将其转换为 jpg，也许使用 GD 或 Image Magick？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:56:02.710

这就是答案... $mapImage->readImage("http://maps.google.com/maps/api/staticmap?markers=size:small|{$latitude},{$longitude}&size=160x100&sensor=false" );

我想从技术上讲这是可能的，但谷歌可能对其使用有限制

# android - 动态更新接口

> ID：10150038
> 
> 赞同：0
> 
> 时间：2012-04-14T00:41:17.317
> 
> 标签：android, android-layout, service

我正在开发一个可以由其他手机通过 SMS 控制的 android 应用程序。我`PreferenceScreen`用作布局（应用程序的设置部分）。布局更新时`onResume()`。

当命令（SMS）通过其他手机发送时，后台运行的服务会窥探传入的短信并更改保存在 SharedPreferences 中的设置。为了看到这些变化，我的 Activity 需要执行中的代码`onResume`. 如果我回到以前的活动并回来，我可以看到变化。

我希望通过运行服务更改 SharedPreferences 后立即显示更改。我应该怎么做才能让它发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T00:58:02.660

像这样的东西：

```
public class MyActivity extends Activity implements OnSharedPreferenceChangeListener
{
    public static final String PREFS_NAME = "MyPrefsFile";

    @Override
    protected void onCreate(Bundle state)
    {
      /* get shared preferences */
      SharedPreferences mySharedPreferences = getSharedPreferences(PREFS_NAME, 0);

      /* register listener for changes to the values within the shared preferences */
      mySharedPreferences.registerOnSharedPreferenceChangeListener(this);
    }

    public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key)
    {
      /* perform application processing */
      ...

      /* update layout */
      View myView = findViewById(id.my_view);

      /* invalidate the view causing it to be redrawn */
      myView.invalidate();
    }
} 
```

# java - java.io.IOException：句柄无效

> ID：10150039
> 
> 赞同：0
> 
> 时间：2012-04-14T00:41:26.447
> 
> 标签：java, file-io

我正在尝试在自己的时间学习编程，但我仍在努力掌握它。我收到以下错误：

> java.io.IOException：句柄无效

这是我的代码

```
public class PrimeFinder {
private int[] prime;
FileInputStream input = null;
//default contructor uses the premade file prime.txt that has the first 10000 digits of pi
public PrimeFinder() throws IOException {
    try{
        input = new FileInputStream ("primes.txt");
    }
    finally {
        if (input != null ) {
            input.close();
        }
    }
}
//constructor with a predefined text file to use.
public PrimeFinder(String txtFile) throws IOException {
    try{
        input = new FileInputStream(txtFile);
    }
    finally {
        if (input != null ) {
            input.close();
        }
    }
}
public static void main(String[] args) throws IOException{

    PrimeFinder tester  = new PrimeFinder();
    tester.arrayListWithNumbers();
}
} 
```

我相信每当我调用该`arrayListWithNumbers()`方法时都会出现错误，当我尝试在默认构造函数中显示字节数时，它工作得非常好并且显示`101281 bytes`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T00:45:22.613

好吧，在您真正开始使用它之前，您正在关闭构造函数`input`的`finally`块。将关闭部分从构造函数中移到完成后将调用它的位置，例如在调用下方`arrayListWithNumbers`或从 main 调用的单独关闭方法下方。

我认为您对不应该用于此目的的内容`finally`感到困惑。`finalize()`

# python - Python 3.2 tkinter 创建一个结果框架来显示输出

> ID：10150041
> 
> 赞同：0
> 
> 时间：2012-04-14T00:42:34.390
> 
> 标签：python, python-3.x, tkinter, frame

我目前对我的餐厅有一个工作菜单测试，它读取检查按钮接收到的输入，将它们与正确答案进行比较，然后显示一个***好的工作***消息框或一个***继续工作***的消息框。我还设置了它，如果他们没有正确回答问题，它会打印他们回答的内容，然后是正确答案。而不是消息框并简单地打印他们做错了什么我想要一个最终***结果***屏幕要么有很好的工作（或类似的东西）消息，要么上面印有错误与正确的答案。这是我的代码，向您展示到目前为止我是如何实现所有内容的，就像我说的一切正常，我只是想找出一种方法让它更美观，但还没有找到一种方法来做到这一点。

```
from tkinter import *
import tkinter.messagebox as tkMessageBox
class GUI(Frame):

def __init__(self, parent):
    Frame.__init__(self, parent)    
    self.parent = parent
    self.initUI()
    self.count = -1
    self.answers = {'nft':[], 'nckt':[]}
    self.menuItems = {'nft': ['Cheese', 'Cabbage', 'Corn', 'Blackened Fish', 'Salsa'],
    'nckt': ['Lettuce', 'Cheese', 'Corn', 'Blackened Chicken', 'Salsa']}
    self.menu = ['nft', 'nckt']
    #self.p = PhotoImage(file="wahoos.gif")
    #self.l = Label(self, image=self.p).grid(row=7, column=7)
def initUI(self):
    self.grid() 
    self.parent.title("Wahoos Menu Test")
    self.create_buttons() 

def create_buttons(self):
    for r in range(20):
        for c in range(14):
            Label(self, text='',
                borderwidth=0).grid(row=r,column=c)
    self.b = Button(self, text ="Begin Exam", relief=RIDGE, fg="black", command= self.on_button_press)
    self.b.grid(row=19, column=7)
    self.m = Label(self, text="")
    self.m.grid(row=7, column=0)
    L = Label(self, text="What comes in the following", fg="blue").grid(row=6, column=0)
    self.tortButton = {'Flour':0, 'Corn':0, 'Wheat':0}
    self.vegButton = {'Lettuce':0, 'Cabbage':0, 'Cheese':0,
        'Ahee Rice':0, 'Brown Rice':0, 'Banzai Veg':0, 'Red Cabbage':0, 'Beans':0}
    self.protButton = {'Carne Asada':0, 'Flamebroiled Chicken':0, 'Blackened Fish':0,
        'Blackened Chicken':0, 'Flamebroiled Fish':0, 'Pork':0, 'Shrimp':0,
        'Tofu':0, 'Blackened Mushroom':0, 'Rice and Beans':0, 'Banzai Veggies':0}
    self.sauceButton = {'Salsa':0, 'Guacamole':0, 'Sour Cream':0,
        'Roasted Pepper':0, 'Ketchup':0, 'Ranch':0, 'Balsamic':0,
        'Mr. Lees':0, 'Teriyaki':0, 'Tapatio':0, 'Cream Cheese':0, 'Aioli':0}
    V = Label(self, text="Veggies", fg="green").grid(row=1, column=11, sticky=W)
    T = Label(self, text="Tortillas     ", fg="green").grid(row=1, column=12, sticky=W)
    P = Label(self, text="Proteins", fg="green").grid(row=1, column=13, sticky=W)
    S = Label(self, text="Sauces", fg="green").grid(row=1, column=14, sticky=W)
    c = 1
    for key in self.tortButton:
        c +=1
        self.tortButton[key] = IntVar()
        to = Checkbutton(self, text=key, variable=self.tortButton[key]).grid(row=c, column=12, sticky=W)
    c = 1
    for key in self.vegButton:
        c += 1
        self.vegButton[key] = IntVar()
        vo = Checkbutton(self, text=key, variable=self.vegButton[key]).grid(row=c, column=11, sticky=W)         
    c = 1
    for key in self.protButton:
        c +=1
        self.protButton[key] = IntVar()
        po = Checkbutton(self, text=key, variable=self.protButton[key]).grid(row=c, column=13, sticky=W)
    c = 1
    for key in self.sauceButton:
        c +=1
        self.sauceButton[key] = IntVar()
        so = Checkbutton(self, text=key, variable=self.sauceButton[key]).grid(row=c, column=14, sticky=W)

def on_button_press(self):
    self.count = self.count + 1
    if self.count == len(self.menu):
        self.m.configure(text="")
        self.b.configure(text ="Your Done!  Click here to see your results.", command = self.compare)
    else:
        self.m.configure(text=self.menu[self.count])
        self.b.configure(text ="Submit and Continue", command= self.read_checks)
def read_checks(self):
    for key, value in self.vegButton.items():
        state = value.get()
        if state !=0:
            print (key)
            self.answers[self.menu[self.count]].append(key)
            self.vegButton[key].set(0)
    for key, value in self.tortButton.items():
        state = value.get()
        if state !=0:
            print (key)
            self.answers[self.menu[self.count]].append(key)
            self.tortButton[key].set(0)
    for key, value in self.protButton.items():
        state = value.get()
        if state !=0:
            print (key)
            self.answers[self.menu[self.count]].append(key)
            self.protButton[key].set(0)
    for key, value in self.sauceButton.items():
        state = value.get()
        if state !=0:
            print (key)
            self.answers[self.menu[self.count]].append(key)
            self.sauceButton[key].set(0)
    print (self.answers)
    print (self.menuItems)
    self.on_button_press()
def compare(self):
    self.match = True
    self.count = -1     
    for key in self.answers:
        if self.answers[key] != self.menuItems[key]:
            print ("For ", self.menu[self.count], " you answered ", self.answers[key])
            print ("The correct answer for ", self.menu[self.count], " is ", self.menuItems[key])
            self.count = self.count + 1
            self.match = False
    if self.match == True:
        tkMessageBox.showinfo("All Pau!", "Nice job!  I think your ready!")
    else:
        tkMessageBox.showinfo("Uh Ohh", "Looks like you have some more studying to do.")
def main():
    root = Tk()
    app = GUI(root)
    root.mainloop()
if __name__ == '__main__':
main() 
```

`def compare(self)`是我进行比较并打印我想在结果屏幕上显示的输出的地方，这也是我弹出消息框的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T04:10:23.380

我会让 GUI 继承自 Tk，
然后将不同的“窗口”放在 Frames 中。
然后，您可以在 Frame 上使用`grid_forget()`或`destroy()`使其消失。
如果您选择不销毁它，请在框架上使用`grid()`以使其重新出现。
这是一个简化的演示，
其中原始帧 (aFrame) 在显示结果帧 (rFrame) 3000 毫秒后重新出现。
见底部的`result_screen`and方法：`go_back`

```
import tkinter as tk

class GUI(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)

        self.score = 0

        self.buttonDic = {
        'Brown Rice':0,
        'Banzai Veg':0,
        'Red Cabbage':0,
        'Black Beans':0
        }

        aFrame = self.aFrame = tk.Frame(self)
        aFrame.grid()

        for key in self.buttonDic:
            self.buttonDic[key] = tk.IntVar()
            aCheckButton = tk.Checkbutton(aFrame, text=key,
                                            variable=self.buttonDic[key])
            aCheckButton.grid(sticky='w')

        submitButton = tk.Button(aFrame, text="Submit",
                                        command=self.query_checkbuttons)
        submitButton.grid()

        self.trueList = ['Brown Rice', 'Black Beans']

    def query_checkbuttons(self):
        for key, value in self.buttonDic.items():
            state = value.get()
            if state != 0:
                if key in self.trueList:
                    self.score += 1
                else:
                    self.score -= 1
                self.buttonDic[key].set(0)
        self.result_screen()

    def result_screen(self):
        self.aFrame.grid_forget()
        self.rFrame = tk.Frame(self)
        self.rFrame.grid()
        self.scoreText = tk.Text(self.rFrame, width=20, height=1)
        self.scoreText.grid()
        self.scoreText.insert('end', self.score)
        self.after(3000, func=self.go_back)

    def go_back(self):
        self.score = 0
        self.rFrame.destroy()
        self.aFrame.grid()

gui = GUI()
gui.mainloop() 
```

# ruby - 使用纯 Ruby 数据库露营

> ID：10150043
> 
> 赞同：2
> 
> 时间：2012-04-14T00:43:31.580
> 
> 标签：ruby, camping

我想将纯 ruby​​ 数据库（kirbybase [http://www.netpromi.com/files/kirbybase_ruby_manual.html](http://www.netpromi.com/files/kirbybase_ruby_manual.html)）与 Camping（http://camping.io ruby​​ 微框架）一起使用，所以在 ruby​​ 中我们会有类似的东西这显示一条记录：

```
require 'kirbybase'
db = KirbyBase.new
cars_tbl= db.get_table(:cars)
ferrari = cars_tbl.select { |r| r.recno == 9 }
puts ferrari 
```

或所有记录

```
results = cars_tbl.select(:name,:race,:color,:recno).sort(+:color) 
```

在不混淆“rubysh”kirbybase语法的情况下将其与Camping集成的最佳方法是什么？通过活动记录连接到 Sqlite（露营的默认数据库）的简单模块如下所示

模块模型类内容<基础；结尾

```
class BasicFields < V 1.0
  def self.up
    create_table Content.table_name do |t|
      t.string :title
      t.text   :text
      t.timestamps
    end
  end

  def self.down
    drop_table Content.table_name
  end      
end 
```

结尾

在此先感谢您的帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T04:54:26.950

由于 Camping 使用 rails 的活动记录，因此您需要一个活动记录连接适配器。

[ackbar](http://ackbar.rubyforge.org/) gem 似乎可以满足这一需求。

# ios - 在 iPad 上访问电影和 iTunes U 视频

> ID：10150047
> 
> 赞同：5
> 
> 时间：2012-04-14T00:44:08.043
> 
> 标签：ios, ipad, avplayer, mpmediaquery

在我的应用程序中，我想重现一个看起来与“视频”原生 iPad 应用程序完全相同的视图（它显示位于 iPad 上的电影和 iTunes U 视频）。

我不知道如何在 iPad（电影和 iTunes U）上访问这些元素。

我玩过 Apple 文档“iPod Library Access Programming Guide”中提到的所有内容：

*   MPMediaItem
*   MPMediaPicker 控制器
*   MPMediaQuery
*   MPMoviePlayerController ...等...</li>

我认为我与 MPMediaItem 和 MPMediaQuery 很接近，因为其中两个标志似乎很有希望：

MPMediaTypeMovie = 1 << 8 MPMediaTypeVideoITunesU = 1 << 12

但是，我得到的所有结果都只包括歌曲。

我是否使用正确的类来访问这些项目？考虑到我得到的结果，这些类似乎只能访问属于 iPod 库的媒体项目，我不确定电影和 iTunes U 视频的情况。

我知道这是可能的，因为我见过另一个可以访问它的应用程序（它被称为“VideoPix”）。它在 Popover 视图中显示“视频库”，所以起初我怀疑它使用的是 MPMediaPickerController，因为在 iPad 上，您只能在 Popover 中使用它，但是当我再次尝试时，我看到的只是歌曲, 没有电影或 iTunes U 项目:(

先感谢您！

弗雷德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T05:09:08.680

查看 AVMovieExporter 示例代码，它正在执行您所说的操作。我还不确定播放，但它肯定会列出它们，尽管 DRM 的合作不那么好。

它应该为每部电影显示一个图标，当我运行它时，我返回的购买的（DRM）电影没有缩略图，在控制台中我得到：

```
AVMovieExporter[642:5b17] couldn't generate thumbnail, error:Error Domain=AVFoundationErrorDomain Code=-11836 "Cannot Open" UserInfo=0x1cd9d550 {NSLocalizedDescription=Cannot Open, NSUnderlyingError=0x1e09b5b0 "The operation couldn\342\200\231t be completed. (OSStatus error -12161.)", NSLocalizedFailureReason=This app is not authorized to play this file.} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T22:04:04.227

查看[AssetsLibrary.framework](http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/ALAsset_Class/Reference/Reference.html)中的 ALAsset。

它与您在上面尝试执行的操作的概念类似，您基本上查询 ALAssetLibrary 的资产类型（ALAssetTypePhoto | ALAssetTypeVideo），然后，您有一个可以显示给用户的集合。

# tcl - 除法运算符没有产生任何结果

> ID：10150048
> 
> 赞同：3
> 
> 时间：2012-04-14T00:44:13.387
> 
> 标签：tcl

我在 TCL 遇到了问题。我可以添加和相乘两个整数变量。这工作得很好：

```
set hdsuc [expr {$hdsuccess * $hdcount}]
set hdsuc [expr {$hdsuccess + $hdcount}] 
```

但是，由于某种原因，我无法将它们分开。以下根本不起作用：

```
set hdsuc [expr {$hdsuccess / $hdcount}] 
```

以上返回0。设置有问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T00:53:20.510

它正在做整数除法。您需要将其中一个参数转换为双精度。例如：

```
 set hdsuc [expr {double($hdsuccess) / $hdcount}] 
```

# javascript - 如何实现像 facebook like/comments 这样的部分刷新？

> ID：10150056
> 
> 赞同：2
> 
> 时间：2012-04-14T00:45:24.943
> 
> 标签：javascript, ajax, jsf

我们有 java web 应用程序。摘要页面将显示行列表。对于每一行，用户可以投票和添加评论。投票或添加评论将立即提交并刷新总投票数和评论数。我们想像 Facebook 那样刷新当前行而不是整个表。如果需要，我们可以用表单格式（iterator List of data）而不是表格格式显示数据列表。如何基于 JSF 实现此功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T00:50:11.243

您需要编写服务器端脚本来更新投票（我猜你的情况是 JSP）并通过 javascript 函数使用 AJAX 调用它，该函数将从服务器（响应）返回当前的投票数 - 并替换之前的数字DOM。

这与 facebook 无关（这是一个很好的例子 - 但问题不在 facebook api 或类似的东西上 - 所以如果你问我它不应该被标记在“facebook”标签下）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T05:54:03.073

如果您使用的是 JSF，最好查看 RichFaces、PrimeFaces 和 IceFaces 等框架。它们都有丰富的 ajax 组件。如果没有，您可以使用 AJAX 手动完成。

# php - android中的JSONException

> ID：10150060
> 
> 赞同：0
> 
> 时间：2012-04-14T00:46:15.247
> 
> 标签：php, android, json, phpmyadmin

**登录活动.java**

`baseposte`是我的数据库，`User`是一个包含`Num_Compte`和`Code_Compte`

```
 for (int i = 0; i < jArray.length(); i++) {
     HashMap<String, String> map = new HashMap<String, String>();
     JSONObject e = jArray.getJSONObject(i);
     String s = e.getString("post");
     JSONObject jObject = new JSONObject(s);

     map.put("num", jObject.getString("nomcompte"));
     map.put("code", jObject.getString("codecompte"));

     mylist.add(map);
} 
```

**连接.php**

```
<?php 
    $json = file_get_contents('php://input');
    $obj = json_decode($json);

    $link = mysql_connect('localhost','root','') or die('Cannot connect to the DB');
    mysql_select_db('baseposte',$link) or die('Cannot select the DB');

    $query = "SELECT * FROM user where ".$obj->{'numcompte'}."=Num_Compte and ".$obj->{'codecompte'}."=Code_Compte";
    $result = mysql_query($query) ;

     /* create one master array of the records */
    $posts = array();
    if(mysql_num_rows($result)) {
      while($post = mysql_fetch_assoc($result)) {
        $posts[] = array('post'=>$post);
      }
    }
    header('Content-type: application/json');
    print(json_encode(array('posts'=>$posts)));

      /* disconnect from the db */
    @mysql_close($link);
  ?> 
```

**LogCat 错误** `JSONException: Value <br of type java.lang.String cannot be converted to JSONObject`

我不明白问题出在哪里。

# ios5 - 在不同线程上分配和释放对象会导致内存泄漏。

> ID：10150066
> 
> 赞同：1
> 
> 时间：2012-04-14T00:48:17.517
> 
> 标签：ios5, thread-safety, twrequest

每次我发出请求时，我都会使用 TWRequest 调用 Twitter，但我会在类似这样的工具中遇到内存泄漏。在 [请求 performRequestWithHandler:] ![泄漏的线程](../Images/717eb32a50c6c934f16c4be3efe664bb.png)

我正在追踪包含请求的类的分配和释放。它在主线程 (1) 上分配，但在另一个线程上被释放，例如线程 6（线程是任意的）。我的问题是这可能是我看到的内存泄漏的原因吗？

# javascript - 如何替换特定类名的图像？

> ID：10150069
> 
> 赞同：-3
> 
> 时间：2012-04-14T00:48:35.833
> 
> 标签：javascript

我正在尝试编写一个脚本，它将选择每个具有类名“mainlogo-img”的元素，并用我指定的文件替换图像源。出于某种原因，这不起作用。我写这个脚本不正确吗

```
<script type="text/javascript">
pageLoc = location;
if (pageLoc == "http://www.barflypub.com/drinks/") {
    logoBox = document.getElementsByClassName("mainlogo-img")
for (i = 0; i < logoBox.length; i++) {
logoBox[i].src = "http://www.barflypub.com/wp-content/gallery/default/img_0962.jpg";
}
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T00:52:18.683

`}`到头来还是少了一个。

# java - android ui小部件初始化导致错误

> ID：10150076
> 
> 赞同：2
> 
> 时间：2012-04-14T00:50:43.660
> 
> 标签：java, android, android-widget

我对android编程很陌生，所以请原谅。

我有一个任务，我需要在当前代码库的 xml 中添加一个文本框，然后在用户编辑文本框时更改代码中的变量。

所以我添加了文本框，它显示得很好，但是当我尝试初始化它时，我收到一个错误，表明应用程序已意外停止，并且 LogCat 中有一堆东西。

澄清：只有最后一个文本框 intersymboltime 会导致错误。如果我注释掉它的初始化，一切运行正常。

我的 xml 示例（前两个来自现有代码，用于比较）：

```
 <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/hostText"
        android:layout_marginTop="5dp"
        android:text="@string/portlabel"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/portText"
        android:layout_width="110dp"
        android:layout_height="35dp"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView3"
        android:hint="@string/portHint"
        android:inputType="number|textNoSuggestions" />

    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/portText"
        android:layout_marginTop="14dp"
        android:text="@string/symboltime" />

    <EditText
        android:id="@+id/intersymboltime"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView4"
        android:ems="10"
        android:hint="@string/symboltimehint"
        android:inputType="number" /> 
```

在我的 onCreate 中（前两个调用在现有代码中，用于比较）：

```
 ((TextView)findViewById(R.id.hostText)).setText(mServerHost);
    ((TextView)findViewById(R.id.portText)).setText(new Integer(mServerPort).toString()); 
    ((TextView)findViewById(R.id.intersymboltime)).setText(mClient.portToIntersymbolTime(mServerPort, 1)); 
```

portToIntersymbolTime 按预期返回。

我错过了什么？！

编辑：我的 logcat 日志：

04-13 18:10:17.556：W/ResourceType(716)：获取资源编号 0x00000100 的值时没有包标识符 04-13 18:10:17.566：D/AndroidRuntime(716)：关闭 VM 04-13 18： 10：17.566：W/dalvikvm（716）：threadid = 1：线程退出未捕获的异常（组= 0x40015560）04-13 18：10：17.576：E/AndroidRuntime（716）：致命异常：主要04-13 18： 10：17.576：E/AndroidRuntime（716）：java.lang.RuntimeException：无法启动活动 ComponentInfo{edu.uw.cs.cse461.sp12.timingframing/edu.uw.cs.cse461.sp12.timingframing.TimingFramingAndroidActivity}： android.content.res.Resources$NotFoundException：字符串资源 ID #0x100 04-13 18:10:17.576：E/AndroidRuntime(716)：在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647) 04-13 18 ：10：17.576：E / AndroidRuntime（716）：在android.app.ActivityThread。handleLaunchActivity(ActivityThread.java:1663) 04-13 18:10:17.576: E/AndroidRuntime(716): 在 android.app.ActivityThread.access$1500(ActivityThread.java:117) 04-13 18:10:17.576: E /AndroidRuntime(716): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:931) 04-13 18:10:17.576: E/AndroidRuntime(716): 在 android.os.Handler.dispatchMessage(Handler. java:99) 04-13 18:10:17.576: E/AndroidRuntime(716): 在 android.os.Looper.loop(Looper.java:123) 04-13 18:10:17.576: E/AndroidRuntime(716) : 在 android.app.ActivityThread.main(ActivityThread.java:3683) 04-13 18:10:17.576: E/AndroidRuntime(716): 在 java.lang.reflect.Method.invokeNative(Native Method) 04-13 18 :10:17.576: E/AndroidRuntime(716): at java.lang.reflect.Method.invoke(Method.java:507) 04-13 18:10:17.576: E/AndroidRuntime(716): at com.android。内部操作系统ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839) 04-13 18:10:17.576: E/AndroidRuntime(716): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 04-13 18:10:17.576: E/AndroidRuntime(716): at dalvik.system.NativeStart.main(Native Method) 04-13 18:10:17.576: E/AndroidRuntime(716): 引起：android.content.res。 Resources$NotFoundException: 字符串资源 ID #0x100 04-13 18:10:17.576: E/AndroidRuntime(716): at android.content.res.Resources.getText(Resources.java:201) 04-13 18:10:17.576 : E/AndroidRuntime(716): 在 android.widget.TextView.setText(TextView.java:2857) 04-13 18:10:17.576: E/AndroidRuntime(716): 在 edu.uw.cs.cse461.sp12。 Timingframing.TimingFramingAndroidActivity.onCreate(TimingFramingAndroidActivity.java:39) 04-13 18:10:17.576: E/AndroidRuntime(716): 在 android.app.Instrumentation。callActivityOnCreate(Instrumentation.java:1047) 04-13 18:10:17.576: E/AndroidRuntime(716): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611) 04-13 18:10:17.576: E/ AndroidRuntime(716): ... 11 更多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T01:05:46.743

有了给定的信息，调试代码真的很困难。您能否将 Logcat 的错误日志以及您的`portToIntersymbolTime`代码提供给我们？根据我现在看到的，您的 xml 中缺少 hostText。但我假设（因为你说`((TextView)findViewById(R.id.hostText)).setText(mServerHost);`的是​​现有代码的一部分）你只是没有粘贴你的 xml 的那部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T01:07:11.513

发布您的 logcat 肯定会帮助缩小范围。我首先要看的是什么是`mClient.portToIntersymbolTime(mServerPort, 1)`. EditText 需要 type `CharSequence`。我相信你需要使用`.toString`或类似的东西。

# image - 我在 Wordpress 3.3.1 中看不到自定义缩略图

> ID：10150079
> 
> 赞同：0
> 
> 时间：2012-04-14T00:51:36.593
> 
> 标签：image, wordpress, thumbnails

我对 wordpress 拇指有疑问。我在 localhost 中安装了最后一个 wordpress，我尝试用拇指创建一个新帖子，但是当我保存它时，在家里没有出现这个拇指。

请参阅以下图片：

[http://i41.tinypic.com/ffalvk.jpg](http://i41.tinypic.com/ffalvk.jpg)

[http://i42.tinypic.com/6pn3g9.png](http://i42.tinypic.com/6pn3g9.png)

这是图片网址：

```
http://localhost/wordpress/wp-content/themes/object/thumb.php?src=wordpress/wp-content/uploads/2012/04/5767096.jpg&w=300&h=200&zc=1&q=100 
```

¿ 我做错了什么？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T01:03:18.327

只是在这里尝试，因为我不知道这是什么插件。但是，您可以尝试将图像 URL 更改为：

```
http://localhost/wordpress/wp-content/themes/object/thumb.php?src=http://localhost/wordpress/wp-content/uploads/2012/04/5767096.jpg&w=300&h=200&zc=1&q=100 
```

但是，我建议您使用 WordPress 内置的**[特征图像](http://codex.wordpress.org/Post_Thumbnails)**功能来设置缩略图。当然，如果您的主题允许的话。

# facebook - Facebook.ui 方法：“apprequests”只挂在本地开发环境上，而不挂在其他任何地方

> ID：10150082
> 
> 赞同：0
> 
> 时间：2012-04-14T00:52:08.200
> 
> 标签：facebook, facebook-graph-api, ruby-on-rails-3.1

我使用本指南来设置 apprequest 对话框。更具体地说，我正在使用`sendRequestViaMultiFriendSelector`允许用户选择多个朋友来向其发送应用请求。[https://developers.facebook.com/docs/reference/dialogs/requests/](https://developers.facebook.com/docs/reference/dialogs/requests/)

我差不多一个月前设置了它，它在我的本地开发环境中运行良好。然而，今天，无论出于何种原因，它只是挂起。我可以看到发送到 Facebook 的请求以及为我的朋友返回的所有缩略图，但它似乎没有超过“加载”图像。

另一件奇怪的事情是，在我所有的部署环境（即登台、生产）上，它工作得很好。

我检查了我用于本地开发的 Facebook 应用程序，我不太确定这是怎么发生的，但应用程序 ID 和应用程序密码已经改变。我已经相应地更新了它们，但仍然无济于事。

任何想法可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T16:12:49.163

我遇到了同样的问题。以下解决了这个问题：

1.  如本线程前面所述，在主机文件（在本地计算机上）中定义自定义域。

2.  将 Visual Studio 配置为使用端口 80。不要使用自定义（或随机端口）。

3.  使用自定义域更新 facebook 应用程序设置。

如果您使用自定义端口，例如 4543，facebook 对话框将挂起。

[http://www.lazerwire.com](http://www.lazerwire.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:44:02.797

另一种可能的解决方法是在 FB.ui 调用中设置 display:'popup'。此显示方法不会出现所描述的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T00:56:32.393

确保您的本地开发服务器和生产服务器（或您要从中运行脚本的任何其他服务器）运行在与您在应用程序设置中设置的应用程序域（在 facebook 中）相同的域（或其子域）上开发者网站，[http://developers.facebook.com/apps](http://developers.facebook.com/apps)）

# c++ - 尝试将数组传递给函数并找到总和

> ID：10150088
> 
> 赞同：0
> 
> 时间：2012-04-14T00:53:20.493
> 
> 标签：c++, arrays

我是编程新手，我试图将一个数组传递给一个函数并将所有元素加在一起并返回总和。问题是我得到了一个垃圾值。我研究了如何将数组传递给函数，但我不知道是否应该使用指针来传递数组。反正我不擅长指针。

这是我的代码

```
#include <cmath>
#include <cstdlib>

using namespace std;
float mean(int);
int sum(int ARRZO[5]);

int total;

int main()
{

    int ARRZ[5];
    char *inname = "example.txt";
    ifstream infile(inname);

    if (!infile) {
        cout << "There was a problem opening file " << inname << " for reading." << endl;
        return 0;
    }
    cout << "Opened " << inname << " for reading." << endl;
    for(int i=0; i<11; i++)
    {
        while (infile >> ARRZ[i]) 
        {
            cout << "Value from file is " << ARRZ[i] << endl;
        }
    }

    total=sum(ARRZ);
    cout<<"the sum of the elements in the array is"<<total<<endl;

    system("PAUSE");

    return 0;
}

int sum(int ARRZO[])
{
    int sumz=0;
    for (int i=0; i<5; i++)
    {
        sumz+=ARRZO[i];
        cout<<ARRZO[i];
    }
    cout<<sumz<<endl;
    return sumz;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T01:06:04.730

`ARRZ[0]`由于内部循环，您实际上正在从文件中读取所有值。当您到达 时`i=1`，您已经到了文件的末尾，并且没有读取任何内容。

`i`删除一个循环，并在您成功读取一个值时递增。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T05:22:22.483

我不确定你*认为*这对嵌套循环应该做什么：

```
for(int i=0; i<11; i++)
{
    while (infile >> ARRZ[i]) 
    {
        cout << "Value from file is " << ARRZ[i] << endl;
    }
} 
```

但是（正如@aliexisdm 指出的那样）内部循环读取文件的全部内容。他没有（至少直接）指出的是，您正在将这些值中的每一个都读入数组的第一个元素中。然后你回到外循环，递增`i`，并尝试再次读取文件——但由于流`failbit`已经设置，你所有后续的读取尝试都会失败。

之后，您将数组中的 5 个项目相加，但由于您没有向其中的 4 个项目读取任何内容（并且从未初始化其内容），您最终会得到从文件中读取的最后一个项目 + 4 个垃圾值，给出结果仍然是更多的垃圾（好吧，通常无论如何-您确实有未定义的行为，因此程序可能会崩溃并烧毁，但是对于大多数当前计算机，您只会得到一些无意义的数字）。

但是，我建议对程序进行一些更改，而不仅仅是删除一个循环并在剩下的循环中增加。相反，我会删除*所有*（显式）循环，并尝试真正使用标准库提供的内容。

您可以一举从文件中读取数字：

```
std::ifstream infile(inname);

std::vector<int> ARRZ ((std::istream_iterator<int>(infile)),
                        std::istream_iterator<int>()); 
```

然后你可以将它们全部加起来`std::accumulate`：

```
int sum = std::accumulate(ARRZ.begin(), ARRZ.end(), 0); 
```

最后，您可以打印出结果：

```
cout << "The sum of the elements in the array is: " << sum << "\n"; 
```

但是，由于您只是从文件中读取值并将它们相加，因此您根本不需要存储它们。您可以将它们加在一起并打印出结果：

```
cout << "The sum of the elements in the file is: " 
     << std::accumulate(std::istream_iterator<int>(infile),
                        std::istream_iterator<int>(), 0); 
```

整个工作简化为一步...

# android - 在可绘制的 xml 中的 android 视图上在 3 面创建边框？

> ID：10150092
> 
> 赞同：15
> 
> 时间：2012-04-14T00:53:47.937
> 
> 标签：android, styles, xml-drawable, shapedrawable

我想为我的Android按钮制作一个drawable，定义为drawable。我发现我可以使用一个矩形来设置所有的边框，但是当我想要它在三个边上时我有点卡住了。例如，我想打开顶部或底部。

谁能告诉我如何做到这一点？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-14T04:07:13.483

尝试这样做，虽然我在其他帖子上看到过

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

<item>
<shape android:shape="rectangle" >
    <solid android:color="#FFFFFF" />
    <padding
        //android:bottom="10dp"  Remove this to avoid seeing the bottom border 
        android:left="10dp"
        android:right="10dp"
        //android:top="10dp"  Remove this to avoid seeing the top border
    />

    <corners android:radius="5dp" />
</shape>
</item>
<item>
<shape android:shape="rectangle" >
    <padding
        android:bottom="5dp"
        android:left="5dp"
        android:right="5dp"
        android:top="5dp" />

    <solid android:color="#666666" />
</shape>
</item>
</layer-list> 
```

[https://stackoverflow.com/a/10133434/1244489](https://stackoverflow.com/a/10133434/1244489)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-19T22:48:16.517

如果有人在接受的答案中遇到有关填充生效的问题，请尝试查看：[https](https://stackoverflow.com/a/11006931) ://stackoverflow.com/a/11006931 。该解决方案使用标签上的位置属性来实现相同的效果。

在创建用于 ActionBar 的可绘制对象时，我在这里使用接受的答案时遇到了麻烦，并且链接的方法对我有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-11-28T06:48:40.187

这可能会帮助你。

I XML 三边的边框

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:left="0dp" android:right="0dp" android:top="0dp" android:bottom="-5dp">
        <shape android:shape="rectangle">
            <solid android:color="#ffffff" />

            <corners android:radius="0dp" />
            <stroke android:width="3dp" android:color="#000000" />
        </shape>
    </item>
</layer-list> 
```

# java - android线程和处理程序最佳实践

> ID：10150093
> 
> 赞同：2
> 
> 时间：2012-04-14T00:53:53.397
> 
> 标签：java, android

我有以下课程。该课程的目的是让我通过每秒显示大约十个字符来模拟电传打字机/打字机。

CharacterLoopThread 类的重点是查看 outputBuffer，如果其中有任何字符，则在 UI 线程上调用一个可运行的对象，该线程会提取第一个字符并将其放入 textView。然后线程休眠大约 100 毫秒。（这里有一些恶作剧……虽然电传打字机在我 1979 年使用的时候很棒，但现在我的口味有点慢。所以每 10 个字符，我稍微减少延迟。当没有更多字符可以显示时，我将延迟重置为 100 毫秒...）

我编辑了课程的底部，因为它与我的问题无关。

我在这里所拥有的似乎运作良好。然而，它是因为我还是不管我？您首选的编写线程和处理程序的方式是什么？

```
public class MyActivity extends Activity {
    private TextView textView;
    private ScrollView scrollView;
    private StringBuilder outputBuffer;
    private Handler handler;
    private CharacterLooperThread characterLooperThread; 
```

（剪断）

```
 private class CharacterLooperThread extends Thread {
        private boolean allowRun;
        private Runnable run;
        int effectiveCharacterDelay;
        int characterCount;

        public CharacterLooperThread() {
            allowRun = true;

            run = new Runnable() {
                public void run() {
                    /**
                     * Don't do anything if the string has been consumed. This is necessary since when the delay
                     * is very small it is possible for a runnable to be queued before the previous runnable has
                     * consumed the final character from the outputBuffer. The 2nd runnable will cause an
                     * exception on the substring() below.
                     */
                    if (outputBuffer.length() == 0) return;

                    try {
                        textView.append(outputBuffer.substring(0, 1));
                        scrollToBottom();
                        outputBuffer.deleteCharAt(0);
                    } catch (Exception e) {
                        toast(getMsg(e));
                    }
                }
            };
        }

        public void run() {
            resetDelay();
            while (allowRun) {

                /**
                 * This if() performs 2 functions:
                 * 1\. It prevents us from queuing useless runnables in the handler.  Why use the resources if
                 * there's nothing to display?
                 * 2\. It allows us to reset the delay values.  If the outputBuffer is depleted we can reset the
                 * delay to the starting value.
                 */
                if (outputBuffer.length() > 0) {
                    handler.post(run);
                    reduceDelay();
                } else {
                    resetDelay();
                }
                try {
                    Thread.sleep(effectiveCharacterDelay);
                } catch (InterruptedException e) {
                    toast("sleep() failed with " + e.getMessage());
                }
            }
            /**
             * Make sure there's no runnable on the queue when the thread exits.
             */
            handler.removeCallbacks(run);
        }

        public void exit() {
            allowRun = false;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T00:42:22.640

一种想法是用来`Handler.postDelayed`安排单独的“击键”。您可以一次完成所有操作，也可以在每次击键`Runnable`完成后安排下一次击键；如果处理落后于计划，前一种方法将尽快赶上，而后者基本上会将所有内容推迟以保持相同的击键间延迟。

看到一个线程改变了`StringBuilder`另一个线程读取它，我很担心。（`StringBuilder`该类是 . 的非线程安全继承者`StringBuffer`，它是在人们认为使单个类线程安全是好的设计时写回的）。如果它偶尔不会做一些意想不到的事情，那么你很幸运，尽管这里不会出错。但是，使用`postDelayed`，您可能会完全摆脱后台线程。

只要您正在创建匿名`Runnable`类，请注意您可以为它们提供参数（只要您声明变量`final`）。因此，我倾向于一次向每个 发布一个字符`Runnable`，如下所示：

```
long delay = 0;
for (int j = 0; j < outputBuffer.length(); ++j) {
    final CharSequence s = outputBuffer.subSequence(j, j + 1);
    handler.postDelayed(new Runnable() {
        @Override public void run() {
            textView.append(s);
            scrollToBottom();
        }
    }, delay);
    delay += 100; // or whatever
} 
```

# flash - 具有更多内部功能的 Flex 自定义组件

> ID：10150094
> 
> 赞同：1
> 
> 时间：2012-04-14T00:53:55.720
> 
> 标签：flash, apache-flex, air, components, custom-component

我正在使用扩展`BorderContainer`类在 Flex 中创建一个自定义组件，并且当我在主应用程序中使用它时，我希望能够在标签集中放置其他内容，如下所示：

```
<components:CustomComponent title="Hello">
    <s:Label text="If you have one enter it below:"/>
    <mx:Spacer height="15" />

    <s:HGroup>
        <s:TextInput width="250"/>
        <s:Button label="Submit"/>
    </s:HGroup>
</components:CustomComponent> 
```

这工作得很好，除了我的组件定义里面有一些额外的东西，比如 a`<s:Label/>`和样式，当我去使用它时，它被上面的标签集中的内容所取代。

如果我没有在标签集中放置任何内容，则不会替换组件中最初的内容。

有没有一种方法可以让我在使用组件时简单地在组件内附加其他内容，而不是每次都替换它？

感谢您的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T01:05:28.367

不是“简单地”，你必须解决它。这是一篇包含血腥细节的博客文章，包括一个带有源代码的示例应用程序：http: [//www.munkiihouse.com/?](http://www.munkiihouse.com/?p=37) p=37 （第 3 步）

总之，您编写该类以拦截设置为默认“虚拟”属性的子组件，并稍后将它们添加到您的“主”属性/容器中。

主要属性是您在自定义组件定义中拥有现有元素的属性。dummy 属性是组件实例将添加元素的默认属性。

祝你好运。

# google-play - Google play android market 发布和保存按钮没有效果

> ID：10150095
> 
> 赞同：7
> 
> 时间：2012-04-14T00:54:13.113
> 
> 标签：google-play, apk

**“android 开发者控制台”发布和保存按钮不执行任何操作**

在[play.google.com/apps/publish](http://play.google.com/apps/publish)的 android 开发者控制台中，我登录并单击“APK 文件”选项卡并上传我更新的 APK。我之前已经成功完成了 15 次。我按下保存按钮，实际上没有任何反应。没有错误，没有消息，没有页面刷新，nada。当我按下“取消发布”按钮时，什么也没有发生。我已经三次检查了我的程序，它运行良好。其他浏览器都试过了，重启eclipse，手机，电脑，都没问题。

Android 市场控制台有问题。android APK 保存按钮不起作用。

**好的，我发现了我的问题。**. 我 100% 确定这是 android 开发者控制台/Android 市场控制台中的错误。

基本上发生的事情是津巴布韦、卡塔尔和多哥的汇率以及其他一些地方由于通货膨胀或其他原因而改变了汇率，当我上传新的 APK 时，谷歌需要我审查并更改这些国家的价格。所以在这里修复是我必须做的：

1.  转到 play.google.com/apps/publish
2.  登录，在 android 应用列表中单击您的程序，单击“上传 APK 选项卡”。
3.  上传您的 APK。
4.  单击保存和发布按钮，完全无效。
5.  单击灰色选项卡：“产品详细信息”。
6.  向下滚动 3/4 到汇率部分，一些国家周围有一个红色框。
7.  输入这些国家的价格，修复任何其他红色项目。单击底部的复选标记以重新验证您之前验证过的内容。
8.  返回到上传 APK 选项卡。单击保存。保存会产生预期的结果“保存完成”。

对谷歌的建议：按下保存按钮应该会产生一个弹出窗口：“您需要查看程序详细信息中的一些货币兑换问题”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T06:51:08.150

如果您上传了新的应用版本但无法保存，我认为“产品详细信息”选项卡上有错误。

由于 Google Play 几天前添加了一些新国家/地区，如果您的应用是付费应用，您首先必须为这些新国家/地区设置价格，然后才能保存您的应用。

我认为这不是一个真正的错误。APK 选项卡上只缺少一条错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-04T16:53:01.507

有一个真正的错误，但我不确定它是什么。我有同样的问题。关闭浏览器选项卡并重新打开它为我解决了这个问题，表明我的应用设置没有真正的问题。

# ruby-on-rails - 用于正确用户和管理员的多个 before_filter 语句

> ID：10150098
> 
> 赞同：6
> 
> 时间：2012-04-14T00:55:01.237
> 
> 标签：ruby-on-rails, authorization, before-filter, role-base-authorization

我有一个组资源，我正在尝试使用适当的授权进行设置。

我试图实现的授权逻辑是这样的：

1.  只有群组成员才能查看他们的群组。
2.  管理员可以查看*任何*组，也可以执行其他操作。

我正在尝试使用组控制器中的以下 before_filter 语句来执行此操作：

```
before_filter :signed_in_user
before_filter :correct_user, only: :show
before_filter :admin_user, only: [:show, :index, :edit, :update, :destroy] 
```

Correct_user 工作，因为我已经验证只有组成员可以查看他们的组。但是，我想要让 admin :show 子句覆盖它，以便管理员可以查看任何组。目前这不起作用。我猜我的过滤器排序和选项有问题。

有人可以告诉我哪里出错了吗？

**编辑**

根据 Amar 的要求添加我的方法代码：

```
private

def correct_user
  # User has to be a member to view
  @group = Group.find(params[:id])
  redirect_to(root_path) if @group.members.find_by_member_id(current_user).nil?
end

def admin_user
  redirect_to(root_path) unless current_user.admin?
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T05:28:12.847

更新 correct_user 方法或使用以下定义创建另一个方法，从其他过滤器中删除 show 并使用新方法添加 before_filter。

```
def correct_user
   @group = Group.find(params[:id])
   redirect_to(root_path) if @group.members.find_by_member_id(current_user).nil?  && !current_user.admin?
end 
```

# objective-c - 在 Xcode 4.3.2 & iPhone Simulator 5.1 下找不到 sqlite3 库

> ID：10150100
> 
> 赞同：1
> 
> 时间：2012-04-14T00:55:26.400
> 
> 标签：objective-c, ios, xcode, sqlite

我正在开发一个使用 sqlite3 的项目。当我构建项目时，我在这个语句`sqlite3 _wordsClues;`中得到一个错误，错误是`Unknown type name 'sqlite3'`所以似乎找不到库。我已经`libsqlite3.0.dylib`在构建阶段进行了链接。我可以使用另一个选项，`libsqlite3.dylib`但我没有使用它。

在我的 pch 中，我在各个方面都有过这些组合`<sqlite3.h>` `"sqlite3.h"`，`"/usr/include/sqlite3.h"` 但这些组合都没有奏效（通过在 SO 上四处寻找）。

有什么建议么？我一定错过了一些简单的东西。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T01:19:33.197

此页面： http: [//klanguedoc.hubpages.com/hub/Tutorial-on-Creating-an-IOS-5-SQLite-Database-Application-IOS-5-SQLite](http://klanguedoc.hubpages.com/hub/Tutorial-on-Creating-an-IOS-5-SQLite-Database-Application-IOS-5-SQLite)有一个非常好的示例，其中包含确切的步骤。

基本上，您需要链接`usr/lib/sqlite_3.0.lib`和`#import <sqlite3.h>`

# javascript - 查找所有未选中的复选框

> ID：10150104
> 
> 赞同：3
> 
> 时间：2012-04-14T00:56:12.333
> 
> 标签：javascript, jquery

如果我想选择所有选中的复选框，我可以这样做。

```
$('#mydiv input[type=checkbox]:checked') 
```

是否有类似的简单语法可以让我选择所有未选中的复选框？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T01:00:39.697

嗨是的： **演示** [http://jsfiddle.net/usvrb/](http://jsfiddle.net/usvrb/)

[http://api.jquery.com/not-selector/](http://api.jquery.com/not-selector/)

**引用**

> ```
>  The .not() method will end up providing you with more readable selections than pushing complex selectors or variables into a :not() 
> ```
> 
> 选择器过滤器。在大多数情况下，这是一个更好的选择。

希望这会有所帮助，:) 干杯！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T00:59:47.040

```
 $('#mydiv input[type=checkbox]:not(:checked)') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T01:02:31.427

你不会相信的。

```
$('#mydiv input[type=checkbox]').not(':checked') 
```

**编辑**： Stackoverflow 管理，坚果 CAPTCHA 怎么了？今天的每一个答案都需要我输入验证码？

# linux - Bash - 重命名多个文件扩展名

> ID：10150105
> 
> 赞同：3
> 
> 时间：2012-04-14T00:56:16.903
> 
> 标签：linux, bash

我最近才切换到 Linux，我想更改大量文件以具有不同的扩展名。例如，我想将 .doc/docx 更改为 .txt 并将图像更改为 .jpg 等等。是否有一个涵盖任何扩展名的 csh 脚本，或者我必须为每种文件类型编写一个新脚本。

到目前为止我有这个，但我不确定它是否真的有效。任何帮助深表感谢！

```
#!/bin/bash
for f in *.$1
do
    [ -f "$f" ] && mv -v "$f" "${f%$1}$2"
done 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T01:03:28.523

无需重新发明轮子： http: [//linux.die.net/man/1/rename](http://linux.die.net/man/1/rename)

```
rename .doc .txt *.doc 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-14T01:04:12.580

您需要适当的程序来转换文件格式：

*   用于[`wvWare`](http://wvware.sourceforge.net/index.html)转换`doc`为`html`
*   用于[`ImageMagick`](http://www.imagemagick.org/script/index.php)转换`png`为`jpg`
*   用于[`html2text`](http://www.mbayer.de/html2text/)转换`html`为`txt`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T00:59:16.527

那将进行重命名；但请记住，重命名 Word 文档不会使其变为文本。

# javascript - 在 JQuery 函数中使用变量

> ID：10150107
> 
> 赞同：3
> 
> 时间：2012-04-14T00:56:30.103
> 
> 标签：javascript, jquery

我有一个关于在 jQuery 中访问变量的简单问题。当我在单击“a”时调用读取函数时，是否有办法访问变量（换行）。

```
(function() {
    var Example= {
        init: function() {
            var wrap = 'hello world';
            $('a').on('click', this.read);
        },

        read: function() {
            console.log(wrap)
        }
    };

    Example.init();
})(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T01:03:06.933

有几种方法可以做到这一点。也许最简单的方法是更改​​“wrap”变量的范围。目前，由于它是在`init`函数内部使用 var 声明的，因此它的作用域仅限于`init`函数并且不能`init`直接在外部使用。因此，您可以在外部声明“包装” `init`（它可能是“示例”对象的属性）：

```
 var Example= {
        wrap: 'hello world',
        init: function() {
            var self = this;
            $('a').click(function(){
                self.read();
            });
        },

        read: function() {
            console.log(this.wrap);
        }
    };

    ​Exa​mple.init(); 
```

这使得 'wrap' 的范围为 'Example'，并且在 'Example' 中定义的任何函数中都可作为 'Example' 的属性使用。

（编辑：必须稍微调整一下才能正确处理关闭。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T00:59:03.173

```
(function() {
    var wrap;
    var Example= {
        init: function() {
            wrap = 'hello world';
            $('a').on('click', this.read);
    ... 
```

因为函数可以访问在其定义范围内可见的所有变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T01:06:37.930

```
(function() {
    var Example= {
        init: function() {
            this.wrap = 'hello world';
            $('a').on('click', this.read);
        },
        read: function() {
            console.log(this.wrap)
        }
    };
    Example.init();
})(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T01:08:23.963

试试这个：（小提琴：http: [//jsfiddle.net/jRJFQ/3/](http://jsfiddle.net/jRJFQ/3/)）

```
(function(){
    var Example= {
        wrap:null,
         init: function() {
            this.wrap = 'hello world';
            $('a').on('click', this.read);
         },

        read: function() {
            console.log(Example.wrap)
        }
    };
    Example.init();
}​)();​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-14T01:11:06.227

如果您考虑使用显示模块模式，您可以定义哪些变量是私有的，哪些是公共的，如下所示：

```
var Example = (function(){

    var wrap = 'hello world',
        init = function(){
            ...
        },
        read = function(){
            ... // You can use `wrap` here
        };

    return { // Return public variables and methods
        init: init,
        read: read
    };

})();

Example.init(); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-14T00:59:05.843

是的，这应该这样做：

```
(function() {
    var wrap;
    var Example= {
        init: function() {
            var wrap = 'hello world';
            $('a').on('click', this.read);
        },

        read: function() {
            console.log(wrap)
        }
    };

    Example.init();
})(); 
```

# php - ORDER BY 打破 mysql 查询

> ID：10150110
> 
> 赞同：2
> 
> 时间：2012-04-14T00:56:46.670
> 
> 标签：php, mysql, join, sql-order-by, inner-join

这里有人帮助整理了这个非常有用的查询！

```
SELECT * FROM results r 
INNER JOIN categories c on r.id = c.result_id 
WHERE c.name in ('$purpose', '$prop_type', '$loan_type')
GROUP BY r.id
HAVING COUNT(c.c_id) = 3
LIMIT 50 OFFSET 0 
```

哪个很好用！但是，当我尝试使用

```
SELECT * FROM results r 
INNER JOIN categories c on r.id = c.result_id 
WHERE c.name in ('$purpose', '$prop_type', '$loan_type')
ORDER BY r.usefulness DESC
GROUP BY r.id
HAVING COUNT(c.c_id) = 3
LIMIT 50 OFFSET 0 
```

我收到语法错误。我在这里遗漏了一些明显的东西吗？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T00:59:45.543

查询的各个部分有一个顺序，并且`ORDER BY`应该在最后（在`LIMIT`和之前`OFFSET`......试试这个：

```
SELECT * FROM results r 
INNER JOIN categories c on r.id = c.result_id 
WHERE c.name in ('$purpose', '$prop_type', '$loan_type')
GROUP BY r.id
HAVING COUNT(c.c_id) = 3
ORDER BY usefulness DESC
LIMIT 50 OFFSET 0 
```

还要确保在任何行的末尾都有空格...

请注意，在 mysql 中，这是一个缩短版本`LIMIT x OFFSET y`- 你可以写`LIMIT y,x`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T00:58:59.137

`ORDER BY`必须在之后`HAVING`。

# android - 为什么我的画布不显示（Android）？

> ID：10150111
> 
> 赞同：1
> 
> 时间：2012-04-14T00:56:47.013
> 
> 标签：android, layout, canvas, line

我正在编写一个程序，该程序应该在屏幕底部按钮下方的画布中绘制一条线，等等。我的布局出现了，但这条线没有。有谁知道为什么我的画布没有出现？

这是代码：

```
public class Vectors extends Activity{

VectorsView vectorsView;
LinearLayout l;

public void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.vectors);        
    vectorsView = new VectorsView(this);
    l = (LinearLayout) findViewById(R.id.llCanvasV);
    l.addView(vectorsView); 

    .......
}

public class VectorsView extends View{

    public VectorsView(Context context) {
        super(context);
    }
    @Override
    protected void onDraw(Canvas canvas) {
        // TODO Auto-generated method stub
        super.onDraw(canvas);       

        Paint paint = new Paint();
        paint.setColor(Color.WHITE);

        canvas.drawLine(0, 0, 100, 100, paint);
        vectorsView.draw(canvas);
        vectorsView.setLayoutParams(new LayoutParams(25, 25)); 
    }
} 
```

这是xml：

```
 <LinearLayout 
     android:layout_width="fill_parent" 
     android:layout_height="fill_parent"
     android:background="@drawable/background" 
     android:orientation="vertical">

     <ImageView android:layout_height="wrap_content" 
        android:src="@drawable/vectors" 
        android:layout_width="wrap_content"
        android:layout_gravity="center"
        android:paddingTop="5dp"
        android:paddingBottom="5dp"
        android:adjustViewBounds="true">
     </ImageView>
     <LinearLayout android:layout_height="wrap_content" 
        android:layout_width="match_parent"
        android:orientation="horizontal">
        <Button android:text="Choose Program" 
            android:id="@+id/bChsProgV" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content"
            android:layout_marginBottom="5dp"
            android:layout_marginLeft="97dp"
            android:adjustViewBounds="true">
        </Button>
        <ImageButton android:layout_height="wrap_content" 
            android:src="@drawable/help" 
            android:id="@+id/ibHelpV" 
            android:layout_width="wrap_content"
            android:layout_marginLeft="65dp"
            android:background="@null" 
            android:layout_marginTop="10dp">
        </ImageButton>
     </LinearLayout>
     <LinearLayout android:id="@+id/llCanvasV" 
        android:layout_height="wrap_content" 
        android:layout_width="match_parent">
     </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T02:16:00.997

`onMeasure`VectorsView 类中缺少方法。并且您还可以通过保留完整的包从布局中添加 VectorsView`<package.VectorsView android:id= android:width= android:height= ></package.VectorsView>`

# c# - 如何在 Windows PGM 套接字中禁用环回？

> ID：10150114
> 
> 赞同：2
> 
> 时间：2012-04-14T00:57:37.213
> 
> 标签：c#, networking, multicast, multicastsocket

我正在使用具有 RDM 套接字类型的标准 Windows PGM 套接字实现（也称为“MSMQ PGM”）。我注意到，根据此[Microsoft 链接](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740092%28v=vs.85%29.aspx)，无法设置**MulticastLoopBack套接字选项。**

换句话说，相当熟悉的语法：

```
_socket.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.MulticastLoopback, 0); 
```

将抛出一个无效的参数错误。

有人知道在 PGM 套接字实例上禁用多播环回的任何替代方法吗？从最干净的单线到注册表黑客的任何内容都将受到欢迎。

# go - goroutine channels - send 语句的值

> ID：10150116
> 
> 赞同：4
> 
> 时间：2012-04-14T00:57:42.363
> 
> 标签：go, channel, goroutine

当我尝试打印时：

```
fmt.Println(c <- x)
```

在下面代码块中的 for 循环之前查看“c <- x”将评估为什么，它收到了错误消息：

./select.go:7: 发送语句 c <- x 用作值；使用 select 进行非阻塞发送

如果发送操作成功，“c <- x”是否被评估为真？为什么 Go 只允许你在 select 语句中的 case 语句中使用 send 语句的值（也就是 "c <- x" 的值）？

```
 func fibonacci(c, quit chan int) {
        x, y := 1, 1

        for {
            select {
            case c <- x:
                x, y = y, x + y
            case <-quit:
                fmt.Println("quit")
                return
            }
        }
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T03:02:40.510

这是真的，`c <- x`是一个陈述，没有任何价值。

您可能`select`对`switch`. Switch 通过查看哪个 case 表达式匹配或评估为 true 来工作。另一方面，Select 查找未阻塞的案例，选择其中一个允许继续，然后运行案例块中的语句。

所以不，`c <- x`如果发送操作成功，则不会评估为真。相反，case 块的语句`x, y = y, x + y` 被简单地执行。没有发送结果，没有真实值，存储在任何地方。

您可能已经阅读过，对于*接收*操作，分配有简短声明的变量仅在 case 块的范围内。这是真的（尽管在上面的 select 语句的情况下没有简短的声明。）如果您有一个在 case 块结束后想要接收值的情况，您将使用简单的赋值而不是简短的声明。

Oblig：[选择语句上的语言规范](http://golang.org/ref/spec#Select_statements)。它真的非常可读。

# mediawiki - 如何解析信息框内 {{}}（大括号）内的属性值

> ID：10150131
> 
> 赞同：1
> 
> 时间：2012-04-14T01:00:49.167
> 
> 标签：mediawiki, wikipedia, wikipedia-api

在维基百科的信息框中，一些属性值也在花括号 {{}} 内。有时它们也有 lins。我需要大括号内的值，它显示在维基百科网页上。我读了这些也是模板。任何人都可以给我一些链接或指导我如何处理它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T01:37:41.353

双花括号`{{}}`定义了对某种魔法词、变量、解析器函数或模板的调用。可以在[MediaWiki.org/.../Manual:Magic_words](http://www.mediawiki.org/wiki/Manual%3aMagic_words)上找到帮助。看起来像的小线`|`称为[管道](http://en.wikipedia.org/wiki/Vertical_bar)，用作分隔符，允许 wikicore 解析引擎定义可与魔术词、变量、解析器函数或模板一起使用的参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T03:33:59.730

希望这将帮助遇到同样问题的每个人。考虑到您将使用 PHP 解析信息框，您可以使用： [http ://www.mywiki.com/wiki/api.php?format=xml&action=query&titles=PAGE_TITLE_THAT_CONTAINS_AN_INFOBOX&prop=revisions&rvprop=content&rvgeneratexml=1](http://www.mywiki.com/wiki/api.php?format=xml&action=query&titles=PAGE_TITLE_THAT_CONTAINS_AN_INFOBOX&prop=revisions&rvprop=content&rvgeneratexml=1)

'rvgeneratexml' 设置为 true (1)，这将使 xml 节点`<rev>`生成一个属性“parsetree”，其中包含 XML 格式的信息框信息。

然后，在 PHP 中，您可以使用 simpleXML加载整个信息（`<api>`包括所有信息）：`<rev></api>`

```
$xml = simplexml_load_file($url); 
```

然后，您可以通过获取“parsetree”属性并加载字符串来加载模板的信息：

```
$template = simplexml_load_string($xml->query->pages->page->revisions->rev->attributes()->parsetree);
$template = $template->template; // If more than 1 template, check template[0], [1], etc 
```

然后，通过使用正确的结构，您可以使用以下内容访问元素：

```
if ($template->part[0]->name='name')
    $film = $template->part[0]->value; 
```

然后，`$film`将包含电影的名称（`->name`是参数的名称，`->value`是它的值）。

# web-services - JBoss RESTEasy Web 服务可以使用 x509 证书来保证安全吗？

> ID：10150137
> 
> 赞同：3
> 
> 时间：2012-04-14T01:03:14.030
> 
> 标签：web-services, jboss, x509certificate, resteasy

我目前正在将旧的 asp.net 2.0 Web 服务重写为 JBoss RESTEasy Web 服务。asp.net Web 服务使用 x509 证书进行安全/身份验证。JBoss RESTEasy 是否支持 x509 证书？如果没有，我可以在 JBoss RESTEasy 中使用哪些其他安全选项？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T01:22:33.757

是的。这是文档中的一个示例：

RESTEasy JAX-RS [38.2。消息体加密](https://docs.jboss.org/resteasy/docs/2.3.0.GA/userguide/html/ch38.html#d0e3082)

# javascript - 匹配行首时 JavaScript V8 正则表达式引擎中的错误？

> ID：10150139
> 
> 赞同：6
> 
> 时间：2012-04-14T01:03:23.503
> 
> 标签：javascript, regex, node.js, newline, v8

我有一个非常漂亮的工具[underscore-cli](https://github.com/ddopson/underscore-cli)，它在打印出帮助/使用信息时会出现最奇怪的行为。

在 usage() 函数中，我这样做是为了缩进文本块（例如，选项）：

```
str.replace(/^/, "    "); 
```

这个正则表达式除了非常明显之外，还直接来自 TJ Hollowaychuk 的[command.js](https://github.com/visionmedia/commander.js)代码。正则表达式是正确的。

然而，我在使用文本的中间插入了奇怪的空格。像这样：

```
  命令：
...
     values 检索对象属性的所有值。
     扩展 <object> 覆盖输入数据中的属性。
     defaults <object> 填写输入数据中缺失的属性。
     any <exp> 如果输入中的任何值使表达式为真，则返回“真”。表达式参数：（值、键、列表）
         all <exp> 如果输入中的所有值都使表达式为真，则返回“真”。表达式参数：（值、键、列表）
     isObject 如果输入数据是具有命名属性的对象，则返回“真”
     isArray 如果输入数据是数组，则返回 'true'
     isString 如果输入数据是字符串，则返回 'true'
...

```

99% 的可能性，这必须是 V8 中的错误。

任何人都知道为什么会发生这种情况，或者最简单的解决方法是什么？

是的，事实证明这**是**一个 V8 错误，确切地说是 1748。这是[我在该工具中使用的解决方法](https://github.com/ddopson/underscore-cli/commit/bad0802b1fdc65de8623a7950a831bf5828bf283)：

```
str.replace(/(^|\n), "$1    "); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T01:26:26.860

这是 V8 中的一个错误（错误 1748）：

[http://code.google.com/p/v8/source/browse/branches/bleeding_edge/test/mjsunit/regress/regress-1748.js?spec=svn9504&r=9504](http://code.google.com/p/v8/source/browse/branches/bleeding_edge/test/mjsunit/regress/regress-1748.js?spec=svn9504&r=9504)

以下是对该错误的测试：

```
function assertEquals(a, b, msg) { if(a !== b) { console.log("'%s' != '%s'  %s", a, b, msg); } }

var str = Array(10000).join("X");
str.replace(/^|X/g, function(m, i, s) {
  if (i > 0) assertEquals("X", m, "at position 0x" + i.toString(16));
}); 
```

在我的盒子上，它打印：

```
'X'！=''。在位置 0x100
'X'！=''。在位置 0x200
'X'！=''。在位置 0x300
'X'！=''。在位置 0x400
'X'！=''。在位置 0x500
'X'！=''。在位置 0x600
...

```

在 jsfiddle 上，它什么也不打印（我的 Chrome 浏览器中的 V8 版本没有该错误）：

[http://jsfiddle.net/PqDHk/](http://jsfiddle.net/PqDHk/)

**错误历史：**

从[V8 更新日志](http://v8.googlecode.com/svn/trunk/ChangeLog)中，该错误已在 V8-3.6.5 (2011-10-05) 中修复。

从[Node.js 变更日志](http://nodejs.org/changelog.html)，Node-0.6.5 应该使用 V8-3.6.6.11 !?!!?。Node.js 从 V8-3.6.4 更新到 V8-3.7.0 (Node-0.5.10)，然后针对 Node-0.6.0 降级到 V8-3.6.6。所以理论上，这个bug应该在Node V0.6.0之前就已经修复了。为什么它仍然在 Node-0.6.5 上重现？？？奇怪的。

~~拥有最新版本（Node-0.6.15）的人可以运行上面的测试片段并报告它是否产生错误？或者我最终会解决它。~~

感谢 ZachB 在 Node-0.6.15 上确认此错误。我针对节点提交了一个问题（[问题 #3168 ），并且已应用修复（](https://github.com/joyent/node/issues/3168) [5d69bbf](https://github.com/joyent/node/commit/5d69bbf)）并且应该包含在 Node-0.6.16 中。:) :) :)

在那之前，解决方法是替换：

```
str.replace(/^/, indent); 
```

和：

```
str.replace(/(^|\n)/, "$1" + indent); 
```

更新：只是为了傻笑，我在当前节点版本 v0.8.1 上检查了这一点，并确认该错误确实已修复。我没有费心回去确认这个错误是否在 0.6.16 或某个时间与 v0.8.X 系列之间得到修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T01:14:46.197

解决方法：捕获第一个字符，并将其替换为空格和自身

```
str.replace(/^./, "    $1"); 
```

或者，确保该行尚未缩进

```
str.replace(/^[^\s]/, "    $1"); 
```

# ruby-on-rails - 按照给定 ID 数组的顺序按 ID 查找模型记录

> ID：10150152
> 
> 赞同：47
> 
> 时间：2012-04-14T01:07:10.860
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有一个查询要按特定顺序获取人员的 ID，例如： `ids = [1, 3, 5, 9, 6, 2]`

然后我想通过`Person.find(ids)`

但它们总是按数字顺序获取，我通过执行以下操作知道这一点：

```
people = Person.find(ids).map(&:id)
 => [1, 2, 3, 5, 6, 9] 
```

如何运行此查询以使顺序与 ids 数组的顺序相同？

我使这项任务变得更加困难，因为我只想从给定的 ID 中执行一次获取人员的查询。因此，执行多个查询是不可能的。

我试过类似的东西：

```
ids.each do |i|
  person = people.where('id = ?', i) 
```

但我认为这行不通。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-14T01:37:10.773

请注意此代码：

```
ids.each do |i|
  person = people.where('id = ?', i) 
```

它有两个问题：

首先，#each 方法返回它迭代的数组，所以你只需要返回 id。你想要的是一个收藏

其次， where 将返回一个 Arel::Relation 对象，该对象最终将评估为一个数组。所以你最终会得到一个数组数组。你可以解决两种方法。

第一种方法是展平：

```
ids.collect {|i| Person.where('id => ?', i) }.flatten 
```

更好的版本：

```
ids.collect {|i| Person.where(:id => i) }.flatten 
```

第二种方法是简单地进行查找：

```
ids.collect {|i| Person.find(i) } 
```

这很好很简单

但是，您会发现这些都对每次迭代进行查询，因此效率不高。

我喜欢 Sergio 的解决方案，但这是我建议的另一个：

```
people_by_id = Person.find(ids).index_by(&:id) # Gives you a hash indexed by ID
ids.collect {|id| people_by_id[id] } 
```

我发誓我记得 ActiveRecord 曾经为我们做这个 ID 排序。也许它和 Arel 一起消失了；）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-14T03:13:46.987

正如我所看到的，您可以映射 ID 或对结果进行排序。对于后者，已经有解决方案，尽管我发现它们效率低下。

映射 ID：

```
ids = [1, 3, 5, 9, 6, 2]
people_in_order = ids.map { |id| Person.find(id) } 
```

请注意，这将导致执行多个查询，这可能是低效的。

排序结果：

```
ids = [1, 3, 5, 9, 6, 2]
id_indices = Hash[ids.map.with_index { |id,idx| [id,idx] }] # requires ruby 1.8.7+
people_in_order = Person.find(ids).sort_by { |person| id_indices[person.id] } 
```

或者，扩展 Brian Underwoods 的答案：

```
ids = [1, 3, 5, 9, 6, 2]
indexed_people = Person.find(ids).index_by(&:id) # I didn't know this method, TIL :)
people_in_order = indexed_people.values_at(*ids) 
```

希望有帮助

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-09-04T11:00:40.137

如果你有`ids`数组，那么它就像 - `Person.where(id: ids).sort_by {|p| ids.index(p.id) }` 或

`persons = Hash[ Person.where(id: ids).map {|p| [p.id, p] }] ids.map {|i| persons[i] }`

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-14T02:13:41.970

有两种方法可以通过给定的 id 数组获取条目。如果您正在使用 Rails 4，不推荐使用动态方法，您需要查看下面的 Rails 4 特定解决方案。

**解决方案一：**

```
Person.find([1,2,3,4]) 
```

`ActiveRecord::RecordNotFound`如果不存在记录，这将引发

**解决方案二 [仅限 Rails 3]：**

```
Person.find_all_by_id([1,2,3,4]) 
```

这不会导致异常，如果没有记录与您的查询匹配，则只需返回空数组。

根据您的要求，选择您想在上面使用的方法，然后按给定的方式对它们进行排序`ids`

```
ids = [1,2,3,4]
people = Person.find_all_by_id(ids)
# alternatively: people = Person.find(ids)
ordered_people = ids.collect {|id| people.detect {|x| x.id == id}} 
```

**解决方案 [仅限 Rails 4]：**

我认为 Rails 4 提供了更好的解决方案。

```
# without eager loading
Person.where(id: [1,2,3,4]).order('id DESC')

# with eager loading.
# Note that you can not call deprecated `all`
Person.where(id: [1,2,3,4]).order('id DESC').load 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-04-14T01:23:35.957

您可以`id asc`从数据库中对用户进行排序，然后在应用程序中以任何您想要的方式重新排列它们。看一下这个：

```
ids = [1, 3, 5, 9, 6, 2]
users = ids.sort.map {|i| {id: i}} # Or User.find(ids) or another query

# users sorted by id asc (from the query)
users # => [{:id=>1}, {:id=>2}, {:id=>3}, {:id=>5}, {:id=>6}, {:id=>9}]

users.sort_by! {|u| ids.index u[:id]} 

# users sorted as you wanted
users # => [{:id=>1}, {:id=>3}, {:id=>5}, {:id=>9}, {:id=>6}, {:id=>2}] 
```

这里的技巧是按人工值对数组进行排序：另一个数组中对象 id 的索引。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2018-12-29T21:03:17.513

使用 Rails 5，我发现这种方法有效（至少适用于 postgres），即使对于范围查询，也适用于使用 ElasticSearch：

```
Person.where(country: "France").find([3, 2, 1]).map(&:id)
=> [3, 2, 1] 
```

请注意，使用`where`而不是`find`不保留顺序。

```
Person.where(country: "France").where(id: [3, 2, 1]).map(&:id)
=> [1, 2, 3] 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-07-14T15:35:32.883

`FIELD`老问题，但是可以通过使用 SQL函数进行排序来完成排序。*（仅用 MySQL 测试过。）*

所以在这种情况下，这样的事情应该可以工作：

```
Person.order(Person.send(:sanitize_sql_array, ['FIELD(id, ?)', ids])).find(ids) 
```

这将导致以下 SQL：

```
SELECT * FROM people
  WHERE id IN (1, 3, 5, 9, 6, 2)
  ORDER BY FIELD(id, 1, 3, 5, 9, 6, 2) 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-04-05T16:13:21.790

大多数其他解决方案不允许您进一步过滤结果查询，这就是我喜欢[Koen 的答案的](https://stackoverflow.com/a/38378457/1701)原因。

与该答案类似，但对于 Postgres，我将此函数添加到我的 ApplicationRecord（Rails 5+）或任何模型（Rails 4）中：

```
def self.order_by_id_list(id_list)
  values_clause = id_list.each_with_index.map{|id, i| "(#{id}, #{i})"}.join(", ")
  joins("LEFT JOIN (VALUES #{ values_clause }) AS #{ self.table_name}_id_order(id, ordering) ON #{ self.table_name }.id = #{ self.table_name }_id_order.id")
    .order("#{ self.table_name }_id_order.ordering")
end 
```

查询解决方案来自[this question](https://stackoverflow.com/questions/866465/order-by-the-in-value-list)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-06-18T17:51:45.453

这在 SQL 中通过 ActiveRecord 而不是在 Ruby 中最有效地处理。

```
ids = [3,1,6,7,12,2]
Post.where(id: ids).order("FIELD(id, #{ids.join(',')})") 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-08-31T12:11:48.657

我在这里总结了解决方案，并添加了最近（9.4+）PostgreSQL 特定的解决方案。以下是基于 Rails 6.1 和 PostgreSQL 12 的。虽然我提到了早期版本的 Rails 和 PostgreSQL 的解决方案，但我还没有用早期版本实际测试过它们。

作为参考，这个[问题“ORDER BY the IN value list”](https://stackoverflow.com/questions/866465/order-by-the-in-value-list)给出了使用数据库进行排序/排序的各种方式。

在这里，我假设模型保证具有 ID 数组指定的所有记录`ids`。否则，可能会引发类似的异常`ActiveRecord::RecordNotFound`（或可能不会，取决于方式）。

## 什么不起作用

```
Person.where(id: ids) 
```

返回的 Relation 的顺序可以是任意的，也可以是主 ID 的数值顺序；无论如何，它通常不同意 的`ids`。

## 获取数组的简单解决方案

（仅限 Rails 5+（？））

```
Person.find ids 
```

它按给定的顺序返回一个 Ruby 数组 Person 模型`ids`。

缺点是您无法使用 SQL 进一步修改结果。

在 Rails 3 中，显然是以下方式，尽管在其他版本的 Rails 中这可能不起作用（当然在 Rails 6 中不起作用）。

```
Person.find_all_by_id ids 
```

### 获取数组的纯 Ruby 解决方案

两种方式。无论 Rails 版本如何（我认为），两者都可以工作。

```
Person.where(id: ids).sort_by{|i| ids.index(i.id)}
Person.where(id: ids).index_by(&:id).values_at(*ids) 
```

它按给定的顺序返回一个 Ruby 数组 Person 模型`ids`。

## 获取 Relation 的 DB 级解决方案

以下所有返回`Person::ActiveRecord_Relation`，您可以根据需要对其应用更多过滤器。

在以下解决方案中，所有记录都被保留，包括那些 ID 未包含在给定数组中的记录`ids`。您可以随时通过添加将它们过滤掉`where(id: ids)`（这种灵活性是一种美感`ActiveRecord_Relation`）。

### 对于任何数据库

基于[user3033467 的回答](https://stackoverflow.com/a/61267426/3577922)，但已更新为可与 Rails 6 一起使用（`order()`出于安全考虑，它已禁用某些功能；请参阅Justin 的“ [Rails 6.1 中的 SQL 注入更新”作为背景）。](https://dev.to/presidentbeef/updates-for-sql-injection-in-rails-6-1-1cbo)

```
order_query = <<-SQL
  CASE musics.id 
    #{ids.map.with_index { |id, index| "WHEN #{id} THEN #{index}" } .join(' ')}
    ELSE #{ids.length}
  END
SQL

Person.order(Arel.sql(order_query)) 
```

### 对于 MySQL 特定

从[Koen的回答](https://stackoverflow.com/a/38378457/1701)（我没有测试过）。

```
Person.order(Person.send(:sanitize_sql_array, ['FIELD(id, ?)', ids])).find(ids) 
```

### 对于 PostgreSQL 特定

#### PostgreSQL 9.4+

```
join_sql = "INNER JOIN unnest('{#{ids.join(',')}}'::int[]) WITH ORDINALITY t(id, ord) USING (id)"
Person.joins(join_sql).order("t.ord") 
```

#### PostgreSQL 8.2+

基于[Jerph 的回答](https://stackoverflow.com/a/43236479/3577922)，但`LEFT JOIN`替换为`INNER JOIN`：

```
val_ids = ids.map.with_index.map{|id, i| "(#{id}, #{i})"}.join(", ")
Person.joins("INNER JOIN (VALUES #{val_ids}) AS persons_id_order(id, ordering) ON persons.id = persons_id_order.id")
  .order("persons_id_order.ordering") 
```

## 获取较低级别的对象

以下是获取较低级别对象的解决方案。在绝大多数情况下，上述解决方案必须优于这些解决方案，但为了完整起见，我将其放在这里（并在我找到更好的解决方案之前记录下来）......</p>

在下面的解决方案中，不匹配 ID 的记录将`ids`被过滤掉，这与上一节中描述的解决方案不同（可以选择保留所有记录）。

### 获取 ActiveRecord::Result

这是`ActiveRecord::Result`PostgreSQL 9.4+ 的解决方案。

`ActiveRecord::Result`类似于哈希数组。

```
str_sql = "select persons.* from persons INNER JOIN unnest('{#{ids.join(',')}}'::int[]) WITH ORDINALITY t(id, ord) USING (id) ORDER BY t.ord;"
Person.connection.select_all(str_sql) 
```

`Person.connection.exec_query`返回相同（别名？）。

### 获得 PG::Result

这是`PG::Result`PostgreSQL 9.4+ 的解决方案。与上面非常相似，但替换`exec_query`为`execute`（第一行与上面的解决方案相同）：

```
str_sql = "select persons.* from persons INNER JOIN unnest('{#{ids.join(',')}}'::int[]) WITH ORDINALITY t(id, ord) USING (id) ORDER BY t.ord;"
Person.connection.execute(str_sql) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-04-17T08:41:41.837

这个简单的解决方案成本低于加入价值：

```
order_query = <<-SQL
  CASE persons.id 
    #{ids.map.with_index { |id, index| "WHEN #{id} THEN #{index}" } .join(' ')}
    ELSE #{ids.length}
  END
SQL
Person.where(id: ids).order(order_query) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-30T06:03:57.840

要按特定顺序获取人员的 ID，请说：`ids = [1, 3, 5, 9, 6, 2]`

在旧版本的 rails 中，find 和 where 以数字顺序获取数据，但 rails 5 以与查询它的顺序相同的顺序获取数据

> 注意：找到保留顺序和不保留的地方

```
Person.find(ids).map(&:id)
=> [1, 3, 5, 9, 6, 2]

Person.where(id: ids).map(&:id)
=> [1, 2, 3, 5, 6, 9] 
```

但它们总是按数字顺序获取，我通过执行以下操作知道这一点：

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-03-24T10:47:52.980

我尝试了在 Rails6 上推荐 FIELD 方法的答案，但遇到了错误。但是，我发现只需将 sql 包装在`Arel.sql()`.

```
# Make sure it's a known-safe values.
user_ids = [3, 2, 1]
# Before 
users = User.where(id: user_ids).order("FIELD(id, 2, 3, 1)")
# With warning.

# After 
users = User.where(id: user_ids).order(Arel.sql("FIELD(id, 2, 3, 1)"))
# No warning 
```

[1] [https://medium.com/@mitsun.chieh/activerecord-relation-with-raw-sql-argument-returns-a-warning-exception-raising-8999f1b9898a](https://medium.com/@mitsun.chieh/activerecord-relation-with-raw-sql-argument-returns-a-warning-exception-raising-8999f1b9898a)

# c++ - C++ STL容器set&multiset：不同返回类型的插入操作

> ID：10150154
> 
> 赞同：2
> 
> 时间：2012-04-14T01:07:39.437
> 
> 标签：c++, stl, set, containers

关于 STL 容器**集**和**多集，****插入**函数的返回类型并不完全相同。 **set**提供如下接口：

```
pair<iterator,bool> insert(const value_type& elem); 
iterator  insert(iterator pos_hint, const value_type& elem); 
```

**multiset**提供如下接口：

```
iterator  insert(const value_type& elem); 
iterator  insert(iterator pos_hint, const value_type& elem); 
```

在**set**的第一个函数中，**pair**结构的成员**second**返回插入是否成功。如果集合中已经包含具有相同值的元素，则元素的插入可能会失败。但是在 set 的第二个函数**中**，插入函数只是返回一个迭代器。如果插入失败会发生什么？有人能告诉我吗？非常感谢。

 ***** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T01:12:36.803

> 但是在set的第二个函数中，insert函数只是返回了一个迭代器，如果插入失败会怎样呢？

在`set::insert`仅返回普通元素`iterator`（而不是 a `pair<iterator,bool>`）的版本中，当找到现有元素时，该集合保持不变，并且`insert`将返回一个迭代器到现有元素（阻止插入）。

在`multiset::insert`中，函数总是成功的。

### 23.2.4 关联容器要求

### `iterator a.insert(p, t)`

> *效果*：当且仅当在具有唯一键的容器中不存在与 t 的键等效的元素时，才插入 t；总是将 t 插入具有等效键的容器中。总是返回指向与 t 的键等效的元素的迭代器。t 被插入到尽可能靠近 p 之前的位置。****

# linux - Suse Linux - 对 mpfr 进行测试说找不到 libgmp.so.10

> ID：10150156
> 
> 赞同：1
> 
> 时间：2012-04-14T01:08:27.240
> 
> 标签：linux, gcc, gmp, suse, mpfr

我用 SUSE Linux 10.1 设置了一台古老的机器，并试图构建一个当前的 gcc 发行版，但它需要 gmp、mprf 和 mpc。

现在，我成功安装了gmp，我在/usr/local/include 和/usr/local/lib 中找到了它。我还在 /usr/local/lib 中找到了共享库 libgmp.so.10。唉，当我对 mpfr 运行 make check 时，它抱怨它无法打开共享对象文件 libgmp.so.10

那么，问题是我需要做什么来告诉它共享对象文件在哪里？

谢谢

泰德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T01:19:22.683

确保`/usr/local/lib`在`LD_LIBRARY_PATH`环境变量上。

`--with-gmp=/usr/local/`或者，使用该选项配置 mpfr 。当你构建它时，你必须对 mpc 做同样的事情，但你还必须`--with-mpfr=/usr/local`在配置它时添加选项。

# extjs - extjs 获取视口面板的高度

> ID：10150157
> 
> 赞同：1
> 
> 时间：2012-04-14T01:08:35.710
> 
> 标签：extjs

**我想要页面加载时中间内容的特定高度（600px 等）：**

**现在我有类似的东西：**

[ ***_* __ *_* __ *_* __ *_* ___***标题****_* __ *_* __ *_* __ *_* __ *_* ___** ]

[左侧栏] [中间内容面板] [右侧栏]

[ ***_* __ *_* __ *_* __ *_* ___***页脚****_* __ *_* __ *_* __ *_* __ *_* ____** ]

**部分代码：**

```
var viewport = new Ext.Viewport({
    layout: 'border',
    id: 'parent_container',
    items: [{
        region: 'north',
        contentEl: 'header',
        border: false
    }, {
        region: 'west',
        id: 'left_sidebar_panel',
        split: true,
        width: 200,
        minSize: 200,
        maxSize: 400,
        autoScroll: true,
        contentEl: 'sidebar_container',
        border: false
    },{
        region: 'center',
        id: 'middle_content_panel',
        layout: 'border',
        border: false,
        items: [{
            region: 'north',
            contentEl: 'main_content_header',
            border: false
    }... 
```

无论如何强制 middle_content_panel 在页面加载/窗口扩展时具有特定高度？或者以其他方式使用 javascript 来获取它的高度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T15:48:50.750

首先，您必须将中心内容定义为变量

```
For example: var center= new Ext.Panel({
...
}); 
```

您可以使用 setHeight 方法`center.setHeight(600);`

从文档：

![在此处输入图像描述](../Images/527589c7eb00a9e89d4d9637006d18cd.png)

# c++ - 交叉铸造以获得另一个被认为是糟糕设计的界面？

> ID：10150158
> 
> 赞同：1
> 
> 时间：2012-04-14T01:09:18.737
> 
> 标签：c++, inheritance

我一直在四处寻找，但找不到太多相关信息，但是从一个界面交叉转换到另一个界面会被认为是糟糕的设计吗？这是我正在使用的代码示例：

```
class IShip {
  // strictly ship_like interface
  // i.e. move, attack, dock, etc.
};

class Sim_object {
  // all game objects are derived from this and represents component in composite pattern
  // get_name()
  // get_location()
  // add
  // remove
  // etc.
};

template<typename T>
class Group : public Sim_object {
  // composite functions
  // add
  // remove
  // display
  // map<T> container;
};

class Ship_group : public Group<IShip>, public IShip {
  // added IShip functionality
};

class Ship : public Sim_object, public IShip {
  // actual ship object
}; 
```

无论如何，我正在使用 MVC，我的控制器将在其中操纵 IShip 对象，并根据它们是复合对象还是叶子对象，将执行一些功能。我的问题是有时我需要从 IShip 转到 Sim_object 以获得不同的界面（需要 dynamic_cast）。这会被认为是糟糕的设计/实践吗？我真的不想为了访问 Sim_object 命令而污染 IShip 界面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:13:13.523

转换通常意味着糟糕的设计，除非在该上下文中已经知道转换的类型。例如，如果您有一个接口 IRenderer，它绘制由接口 ITexture 表示的纹理，并且您有一个具有 OpenGLRenderer 和 OpenGLTexture 的 OpenGL 实现，那么在 OpenGLRenderer 中将 ITexture 转换为 OpenGLTexture 不会是设计问题。

如果您确实需要将 IShip 转换为 Sim_object，那么认为 IShip 实际上应该是 Sim_object 是合理的。

# ajax - 多个ajax同时调用

> ID：10150159
> 
> 赞同：24
> 
> 时间：2012-04-14T01:09:26.710
> 
> 标签：ajax, jquery

我开发了一些网站，但我总是偶然发现一个问题：多个 ajax 调用。我有一个主页，所有内容都是异步加载的。加载页面时，有四个 INDEPENDENT 调用按区域（顶部、左侧、右侧和底部）“绘制”页面，并且在加载时我向用户显示典型的 ajax 旋转。因此，当浏览器收到请求时，我执行回调，并且不同的区域在不同的时间绘制。事实上，服务器的答案有时会混淆，我的意思是，顶部的答案是在左边绘制的，反之亦然。

我尝试了一些解决方案，例如在每个请求中创建时间戳，以向浏览器和服务器指示每个请求是不同的。

此外，我还尝试在服务器中配置一些缓存参数，以防万一。

唯一可行的方法是将 request2 包含在一个回调中，等等。

任何人都知道正确的方法或曾经解决过这个问题？我不想做链式请求。

谢谢

这是我的意思的一个例子：

```
$(document).ready(function() {

$.get('/activity',Common.genSafeId(),function(data){$('#stream').html(data);$("#load_activity").addClass("empty");});
$.get('/messages',Common.genSafeId(),function(data){$('#message').html(data);$("#load_messages").addClass("empty");});
$.get('/deals',Common.genSafeId(),function(data){$('#new_deals_container').html(data);$("#load_deal").addClass("empty");});
$.get('/tasks',Common.genSafeId(),function(data){$('#task_frames').html(data);$("#load_task").addClass("empty");});}); 
```

html是一个简单的jsp，有四个容器，每个容器都有不同的id。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-14T07:59:57.567

**关闭**

[闭包](http://en.wikipedia.org/wiki/Closure_%28computer_science%29)起初有点令人兴奋。它们是 JavaScript 和其他几种现代计算语言的一个特性。

闭包由一个函数的执行实例形成，该函数具有一个需要访问一个或多个外部变量（即在外部函数内部但在内部函数外部的变量）的内部函数（通常是匿名事件处理程序或命名方法） ）。令人兴奋的是，即使外部函数已完成并在内部函数执行时返回，内部函数仍保留对外部变量的访问权限！

此外，被闭包捕获的变量*只能*被内部函数访问，而不能被产生闭包的更远的环境访问。例如，即使在没有语言关键字“Public”和“Private”的情况下，此功能也允许我们创建具有私有成员和公共成员的类类结构。

闭包是通过内部函数使用外部变量来抑制 JavaScript 的“垃圾收集”，否则会在完成后在某个不确定的点破坏外部函数的环境。

闭包对于良好、整洁的 javaScript 编程的重要性怎么强调都不过分。

在函数`getData()`形式下面的代码中，在每次调用时，一个闭包捕获`id1`和`id2`(and `url`)，对于匿名 ajax 响应处理程序（$.get 的第三个参数）仍然可用。

```
$(document).ready(function() {

    function getData(url, id1, id2) {
        $.get(url, Common.genSafeId(), function(data) {
            $(id1).html(data);
            $(id2).addClass("empty");
        });
    }

    getData('/activity', '#stream', '#load_activity');
    getData('/messages', '#message', '#load_messages');
    getData('/deals', '#new_deals_container', '#load_deal');
    getData('/tasks', '#task_frames', '#load_task');

}); 
```

因此，我们不是编写四个单独的处理程序，而是利用语言形成闭包的能力并调用*相同*的函数，`getData()`，四次。在每次调用时，都会`getData()`形成一个新的闭包，它允许 $.get 的响应处理程序（在服务器响应时异步调用）处理*其*DOM 元素。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-04-14T01:13:18.857

确保每个 ajax 调用都有不同的回调，听起来你正在尝试对所有四个调用使用相同的函数，因此当它们被无序调用时（因为它们在服务器端花费不同的时间），它们正在渲染在错误的地方。如果您坚持对所有回调使用相同的函数，那么您必须在有效负载中放入一些内容，以便回调知道要渲染到哪里。

# android - Android SoundPool 将信息记录为错误

> ID：10150160
> 
> 赞同：1
> 
> 时间：2012-04-14T01:10:05.493
> 
> 标签：android, soundpool

我正在使用 SoundPool 开发一个 Android 应用程序。每次播放声音时，都会在以下类型的 LogCat 中记录错误：E/SoundPool(11873): sampleID=33, leftVolume=0.779528, rightVolume=0.779528, priority=1, loop=0, rate=1.000000

这个错误是什么意思？是否可以禁用这些日志，我想记录这些错误非常耗时，因为我播放了很多声音。

谢谢

我正在使用 API 8 并在装有 Android 2.3.6 的三星 Galaxy S Plus 上测试该应用程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T06:10:56.270

A 快速浏览了 SoundPool 类，并没有立即找到任何东西，但您绝对应该查看您正在播放的音频文件类型。我认为您应该尝试像 .wav 这样的未压缩文件类型，看看是否可以缓解问题。

# r - 按完美正方形对 1:17 排序

> ID：10150161
> 
> 赞同：14
> 
> 时间：2012-04-14T01:10:07.827
> 
> 标签：r

R-help上有一个有趣的问题：

“把数字从一到十七。你能把它们写成一行，这样每对相邻的数字加起来就是一个平方数吗？”

我的解决方案如下，并不是特别特别。我对更优雅和/或更强大的解决方案感到好奇。如果可能的话，也许一个可以采用任意数字字符串并像这样对它们进行排序的解决方案？

```
sq.test <- function(a, b) {
  ## test for number pairs that sum to squares.
  sqrt(sum(a, b)) == floor(sqrt(sum(a, b)))
}

ok.pairs <- function(n, vec) {
  ## given n as a member of vec,
  ## which other members of vec satisfiy sq.test
  vec <- vec[vec!=n]
  vec[sapply(vec, sq.test, b=n)]
}

grow.seq <- function(y) {
  ## given a starting point (y) and a pairs list (pl)
  ## grow the squaring sequence.
  ly <- length(y)
  if(ly == y[1]) return(y)

  ## this line is the one that breaks down on other number sets...
  y <- c(y, max(pl[[y[ly]]][!pl[[y[ly]]] %in% y]))
  y <- grow.seq(y)

  return(y)
}

## start vector
x <- 1:17

## get list of possible pairs
pl <- lapply(x, ok.pairs, vec=x)

## pick start at max since few combinations there.
y <- max(x)
grow.seq(y) 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-14T03:40:47.343

您可以使用`outer`来计算允许的对。得到的矩阵是图的邻接矩阵，你只需要一个[哈密顿路径](http://en.wikipedia.org/wiki/Hamiltonian_path)就可以了。

```
# Allowable pairs form a graph
p <- outer(
  1:17, 1:17, 
  function(u,v) round(sqrt(u + v),6) == floor(sqrt(u+v)) ) 
)
rownames(p) <- colnames(p) <- 1:17
image(p, col=c(0,1)) 

# Read the solution on the plot
library(igraph)
g <- graph.adjacency(p, "undirected")
V(g)$label <- V(g)$name 
plot(g, layout=layout.fruchterman.reingold) 
```

![哈密​​顿路径](../Images/d3fa489b80e313b6e293a920f23f1210.png)

# imagebutton - ADF：将图像缩放到按钮大小

> ID：10150162
> 
> 赞同：0
> 
> 时间：2012-04-14T01:10:13.747
> 
> 标签：imagebutton, jdeveloper, oracle-adf

我是 ADF 编程（JDeveloper）的新手。请帮助我解决这个基本问题。我想要一个带有图像（比如 200*200 像素大小）的图像按钮缩放到一个小按钮大小。我使用了一个图像按钮（Adf Faces）并在 Style-> Dimensions 中调整了它的 Height 和 Width 参数，但图像永远不会缩小到小尺寸 height:2px; 宽度：2px；边距：150px；

我还尝试使用普通按钮（ADf Faces），然后向其添加图标图像。在这里，我可以整体减小按钮大小，因此图像会被截断:-(。请告诉我如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:05:09.263

使用 commandImageLink - [http://jdevadf.oracle.com/adf-richclient-demo/faces/components/commandImageLink.jspx](http://jdevadf.oracle.com/adf-richclient-demo/faces/components/commandImageLink.jspx)

或者使用成像软件调整图像大小，然后将其分配给按钮。

# sql - 基本问题：基本的 PL/SQL 控制台输出？

> ID：10150163
> 
> 赞同：26
> 
> 时间：2012-04-14T01:10:27.597
> 
> 标签：sql, oracle, plsql, oracle-sqldeveloper, dbms-output

我正在使用 SQL Developer，并希望使用 DBMS_OUTPUT.PUT_LINE() 将变量的内容输出到控制台。我正在运行以下代码，将数字 1 到 5 相加，但我没有看到任何输出。

```
SET SERVEROUTPUT ON;
DECLARE 
n_counter NUMBER := 5; -- Substitute this variable
n_sum     NUMBER := 0;
BEGIN
  WHILE n_counter != 0
  LOOP
    n_sum := n_sum + n_counter;
    n_counter := n_counter -1;
  END LOOP;
  DBMS_OUTPUT.PUT_LINE(n_sum);
END; 
```

此外，您是否知道比极其密集的 Oracle PL/SQL 文档更好的故障排除资源？【类似Java SE7 API？】

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-04-14T01:14:34.103

由于您使用的是 SQL Developer，因此您有几个选择。

在 SQL Developer 中，转到`View | DBMS Output`以确保 DBMS 输出窗口可见。在 DBMS 输出窗口中，选择“加号”图标并选择要向 DBMS 输出窗口写入数据的连接。然后使用右箭头（在 Windows 中为 Ctrl+Enter）在 SQL Worksheet 窗口中运行 PL/SQL 块。您将看到输出出现在 DBMS 输出窗口中。

或者，您可以将 SQL*Plus`SET SERVEROUTPUT ON`命令和 PL/SQL 块都放在 SQL 工作表中，并将其作为脚本运行（Windows 中的 F5）。这将在“脚本输出”窗口中的“匿名块已完成”消息的正下方显示输出。

注意：Oracle Sql Developer 中的 Dbms 输出不会在输出窗口中显示 null。它移动到一个新行，但在它返回除 null 之外的其他内容之前，您不会知道所有以前的 null 都在那里。

# pingfederate - PingFederate - 如何验证 Salted MD5 哈希密码？

> ID：10150166
> 
> 赞同：1
> 
> 时间：2012-04-14T01:11:07.660
> 
> 标签：pingfederate

谁能指出 PingFederate 如何使用加盐的 MD5 哈希密码对帐户进行身份验证？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T02:29:48.043

您所追求的用例并不完全清楚 - 但我假设您正在充当 PingFederate 的身份提供者 (IdP)，并且您的帐户存储在某些系统/数据库中，其密码 MD5 散列（使用盐）。

根据使用的 PingFederate 版本，您可能需要自定义 IdP 适配器（6.6 之前）或自定义密码凭据验证器（6.6 及更高版本）。PingFederate SDK 具有描述所需 API 的 Javadocs 以及示例代码。您的自定义适配器/PCV 将是一些查找用户帐户的 Java 代码，MD5-salt-散列传入密码并将结果与​​存储的帐户进行比较。如果匹配，自定义代码将返回一个状态码，表明匹配。

然后，您当然需要将您的 SP 连接配置为使用此 IdP 适配器/PCV（在 HTML 或 HTTP 基本身份验证适配器中）。

# java - 来自 float.h 的 DBL_MIN_10_EXP、FLT_RADIX 和其他的 Java 等效项

> ID：10150168
> 
> 赞同：4
> 
> 时间：2012-04-14T01:11:36.180
> 
> 标签：java, floating-point, jython

我正在努力将[sys.float_info](http://hg.python.org/cpython/file/ab157c169f6e/Objects/floatobject.c#l76)添加到 Jython。它有几个来自 float.h 的属性。我正在尝试为 、 和 找到`DBL_MIN_10_EXP`Java`DBL_MANT_DIG`等效`FLT_RADIX`项`FLT_ROUNDS`。

有任何想法吗？

我*想*我有其余的属性，一些来自 java.lang.Double，其余的来自查看`Num`ssj 库中的类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T04:15:40.947

我不记得这些常量是任何标准类的一部分（java.lang.Double 和 java.lang.Float 是最有可能的地方）。似乎您自己定义它们是安全的，因为 Java 浮点数和双精度数遵循规范的 IEEE 754 标准。 [http://en.wikipedia.org/wiki/IEEE_754](http://en.wikipedia.org/wiki/IEEE_754)

```
DBL_MIN_10_EXP = -307
DBL_MANT_DIG = 53
FLT_RADIX = 2 
```

虽然不确定 FLT_ROUNDS ... 可能是 1（最近），但您可以使用 -1（未知）以确保安全。

# windows - C++ 如何导出地址表挂钩 (EAT)？

> ID：10150174
> 
> 赞同：2
> 
> 时间：2012-04-14T01:13:07.957
> 
> 标签：windows, dll, assembly, portable-executable

我将如何进行导出地址表 (EAT) 挂钩？

我能够进行 IAT（导入地址表）挂钩。

有人可以给我一个例子吗？

谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T06:57:22.193

EAT 挂钩遵循与 IAT 挂钩非常相似的方法，主要区别在于您查看的位置发生了变化*，*请查看[Win32 PE 格式](http://msdn.microsoft.com/en-us/magazine/ms809762.aspx)的 PE 文件导出部分。

可以在[此处](http://www.unknowncheats.me/forum/c-and-c/50426-eat-hooking-dlls.html)找到一个非常简单的（虽然是 C 语言）示例，如果您确实需要汇编形式，只需编译和反汇编即可。

# objective-c - UIViewController shouldAutorotateToInterfaceOrientation

> ID：10150176
> 
> 赞同：0
> 
> 时间：2012-04-14T01:13:16.600
> 
> 标签：objective-c, ios, uiviewcontroller

我有一个问题`shouldAutorotateToInterfaceOrientation`：

我有一个网格视图控制器，并且我在 autorotate 方法中放置了一个断点，以查看该方法是否被调用。事实证明，即使我旋转设备（在模拟器上测试），也不会调用该方法。

谁能建议我如何调查这个问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T01:22:49.750

确保您的视图控制器设置为窗口的 rootViewController，或者它包含在设置为该视图控制器的容器视图控制器中。

您的问题将是它没有收到传递给根视图控制器的窗口通知，然后进一步向下传递给它的每个孩子，然后再传递给他们的孩子等等。

如果您已经制作了自己的自定义容器视图控制器，请确保它们都将消息适当地转发给它们的子级。在那个链条的某个地方是一个中断。

# c# - SqlDataAdapter.Update 或 SqlCommandBuilder 不工作

> ID：10150189
> 
> 赞同：1
> 
> 时间：2012-04-14T01:15:45.227
> 
> 标签：c#, sql-server, winforms, datagrid, sqldataadapter

我有一个带有数据网格的表单，其中填充了来自 sqlserver 数据库的数据。数据网格填充得很好，但我无法将用户所做的更改回发到 sql 数据库中的表。我的表单代码如下：

```
public partial class frmTimesheet : Form
{
    private DataTable tableTS = new DataTable();
    private SqlDataAdapter adapter = new SqlDataAdapter();
    private int currentTSID = 0;

    public frmTimesheet()
    {
        InitializeComponent();
    }

    private void frmTimesheet_Load(object sender, EventArgs e)
    {
        string strUser = cUser.currentUser;            
        cMyDate cD = new cMyDate(DateTime.Now.ToString());
        DateTime date = cD.GetDate();
        txtDate.Text = date.ToString();
        cboTSUser.DataSource = cUser.GetListOfUsers("active");
        cboTSUser.DisplayMember = "UserID";
        cboTSUser.Text = strUser;
        CheckForTimeSheet();
        PopulateTimeSheet();
    }

    private void CheckForTimeSheet()
    {
        string strUser = cboTSUser.Text;
        cMyDate cD = new cMyDate(txtDate.Text);
        DateTime date = cD.GetDate();
        int newTSID = cTimesheet.TimeSheetExists(strUser, date);
        if (newTSID != this.currentTSID)
        {
            tableTS.Clear();
            if (newTSID == 0)
            {
                MessageBox.Show("Create TimeSheet");
            }
            else
            {
                this.currentTSID = newTSID;
            }
        }
    }

    private void PopulateTimeSheet()
    {
        try
        {
            string sqlText = "SELECT EntryID, CaseNo, ChargeCode, StartTime, FinishTime, Units " +
                             "FROM tblTimesheetEntries " +
                             "WHERE TSID = " + this.currentTSID + ";";
            SqlConnection linkToDB = new SqlConnection(cConnectionString.BuildConnectionString());
            SqlCommand sqlCom = new SqlCommand(sqlText, linkToDB);
            SqlDataAdapter adapter = new SqlDataAdapter(sqlCom);
            adapter.SelectCommand = sqlCom;
            SqlCommandBuilder builder = new SqlCommandBuilder(adapter);
            adapter.Fill(tableTS);
            dataTimesheet.DataSource = tableTS;                
        }
        catch (Exception eX)
        {
            string eM = "Error Populating Timesheet";
            cError err = new cError(eX, eM);
            MessageBox.Show(eM + Environment.NewLine + eX.Message);
        }         
    }

    private void txtDate_Leave(object sender, EventArgs e)
    {
        CheckForTimeSheet();
        PopulateTimeSheet();            
    }

    private void cboTSUser_DropDownClosed(object sender, EventArgs e)
    {
        CheckForTimeSheet(); 
        PopulateTimeSheet();
    }

    private void dataTimesheet_CellValueChanged(object sender, DataGridViewCellEventArgs e)
    {
        try
        {   
            adapter.Update(tableTS);
        }
        catch (Exception eX)
        {
            string eM = "Error on frmTimesheet, dataTimesheet_CellValueChanged";
            cError err = new cError(eX, eM);
            MessageBox.Show(eM + Environment.NewLine + eX.Message);
        }
    }
} 
```

没有异常发生，当我逐步解决问题时，似乎是 SqlCommandBuilder 不基于我的 gien SELECT 命令构建 INSERT / UPDATE / DELETE 命令。

谁能看到我做错了什么？

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T02:23:13.713

您需要设置[UpdateCommand](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldataadapter.updatecommand.aspx)而不是`SelectCommand`更新：

```
 SqlDataAdapter adapter = new SqlDataAdapter();
 SqlCommandBuilder sqlBld = new SqlCommandBuilder(adapter)
 adapter.UpdateCommand = sqlBld.GetUpdateCommand() ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-19T19:33:30.800

**这个问题很老，但需要更正@Anurag Ranjhan 提供的答案。**

**您无需编写以下行：**

```
 adapter.UpdateCommand = sqlBld.GetUpdateCommand() ; 
```

足以写：

```
 SqlDataAdapter adapter = new SqlDataAdapter();
   SqlCommandBuilder sqlBld = new SqlCommandBuilder(adapter)
   //remove the next line
   //adapter.UpdateCommand = sqlBld.GetUpdateCommand() ; 
```

Sql update/insert/delete 命令是根据这一行自动生成的

```
 SqlCommandBuilder sqlBld = new SqlCommandBuilder(adapter) 
```

您可以通过执行以下行找到生成的更新sql：

```
 sqlBld.GetUpdateCommand().CommandText; 
```

请参阅示例[如何使用 Visual C# .NET 中的 SqlDataAdapter 对象更新 SQL Server 数据库](https://support.microsoft.com/en-ie/help/308507/how-to-update-a-sql-server-database-by-using-the-sqldataadapter-object)

OP所说的问题可以通过查看客户端在 `SQl Server Profiler`.

# php - php中的排名/编号

> ID：10150193
> 
> 赞同：2
> 
> 时间：2012-04-14T01:16:59.500
> 
> 标签：php, sql, loops, pagination

我试图实现一种方法，在该方法中，我创建了一个记分牌（while 循环）并按某个数字字段（点）对获取的结果进行排序。但我需要实现的是如下

```
rank----username--point
1st------test-----------3200
2nd-----test2---------1200 
```

等等。我对结果进行分页并限制每页 25 个结果。我通过以下方式尝试了一个while循环

```
while($row = mysql_fetch_array($query) || $i<=$totalnumberofrows ){
   echo out the results
$i++
} 
```

它的作用是完美地从 1 到 25 编号，但另一方面，在第 2 页上它又从 1 到 25 编号。有什么诀窍可以实现我需要实现的目标吗？即从 1 到（总行数）的连续编号，即使在分页时也是如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T01:25:38.383

您正在寻找的是 MySQL LIMIT 语句。例如，以下查询将返回条目 0-24（因此，数据库中的前 25 个条目）：

```
SELECT * FROM entries ORDER BY `points` LIMIT 0, 25 
```

假设您要获取第二页（接下来的 25 个条目），您可以执行以下操作：

```
SELECT * FROM entries ORDER BY `points` LIMIT 25, 25 
```

这里要注意的最重要的一点是，第一个参数是它应该开始的行，第二个参数不是最后一行，而是它应该返回的总行数。

要确定起点，只需执行 (($page_number - 1) * 25)，假设您的第一页编号为 1。例如，您可以执行以下操作：

```
<?php
$start = (($page_number - 1) * 25);
$query = "SELECT * FROM entries ORDER BY `points` LIMIT {$start}, 25";
// ... rest of your code goes here ...
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T01:22:49.480

只需将每页的数字添加 25，对于第二页（在我的示例中）-为第三页添加 25-添加 50 等...

```
$page = 2;
while($row = mysql_fetch_array($query) || $i<=$totalnumberofrows ){
   echo out the results
   echo (($page-1)*$totalnumberofrows)+$i;
   $i++
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T01:22:21.900

如果您知道页码和偏移量，您应该能够执行以下操作

```
$rank = $offset * $page_number; 
```

# javascript - 通过单击带有 jQ uery 的标签立即获取单选按钮

> ID：10150194
> 
> 赞同：0
> 
> 时间：2012-04-14T01:17:26.497
> 
> 标签：javascript, jquery

我有一些单选按钮的样式被隐藏起来，标签可见并按我想要的样式设置。

问题是当我单击一个标签时，我在第一次单击时没有得到单选按钮的值。

如果你看这里，你会明白我的意思：http: [//jsfiddle.net/bQwtK/1/](http://jsfiddle.net/bQwtK/1/)

有没有办法在第一次点击时获得价值？

**答案-** 感谢 asawyer 和 blocco- [http://jsfiddle.net/bQwtK/14/](http://jsfiddle.net/bQwtK/14/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T01:26:36.637

你的代码被破坏了——你错过了 JavaScript 中的右括号。

[http://jsfiddle.net/bQwtK/5/](http://jsfiddle.net/bQwtK/5/)

单击标签有效。如果您想要单选按钮的值，请记住单击事件是指标签，而不是单选按钮。您必须访问“for”属性以获取单选按钮，然后获取其值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T01:26:41.463

您可以在[此处](http://jsfiddle.net/lq_blocco/bQwtK/9/)使用代码获取值：

```
$(".label_size").click(function()
{
   alert($("#"+$(this).attr("for")).val());
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T01:23:00.433

嗨：您的 jsfiddle 没有发出任何警报，请在此处查看正确的**演示**”：http: [//jsfiddle.net/NEu97/2/](http://jsfiddle.net/NEu97/2/)并感谢锯工：http: [//jsfiddle.net/NEu97/5/](http://jsfiddle.net/NEu97/5/)

请让我知道进展如何，希望这会有所帮助，:)

**jQuery代码**

```
$(".label_size").click(function()
{
   alert(' clicked value =' + $(this).text());
   alert(' correspong value =' + $('#'+$(this).attr('for')).val());
   alert("D");
});

    ​ 
```

**HTML**

```
<div class="radio">(This is styled to be hidden)
   <input name="size" class="radio_size" type="radio" id="radio_size_small" value="small "/>
   <input name="size" class="radio_size" type="radio" id="radio_size_medium" value="medium"/>
   <input name="size" class="radio_size" type="radio" id="radio_size_large" value="large"/>
</div>

<div class="radio_labels">
   <label class="label_size" for="radio_size_small" id="label_size_small">SMALL</label>
   <label class="label_size" for="radio_size_medium" id="label_size_medium">MEDIUM</label>
   <label class="label_size" for="radio_size_large" id="label_size_large">LARGE</label>
</div>
​ 
```

# java - Clojure Lein 类路径问题

> ID：10150195
> 
> 赞同：5
> 
> 时间：2012-04-14T01:17:41.377
> 
> 标签：java, clojure, classpath, leiningen

我有一个 Leiningen *project.clj*文件，如下所示：

```
(defproject insane-noises "1.0.0-SNAPSHOT"                                      
  :description "FIXME: write description"                                       
  :dependencies [[org.clojure/clojure "1.3.0"]                                  
                 [overtone "0.6.0"]]                                            
  :source-paths ["/Volumes/ramdisk"]                                            
  :java-source-paths ["/Volumes/ramdisk"]                                       
  :native-path "/Volumes/ramdisk") 
```

现在，当我跑步时

```
$ lein repl
user=> (seq (.getURLs (java.lang.ClassLoader/getSystemClassLoader))) 
```

路径*/Volumes/ramdisk*不会出现在我的路径中的任何位置。这是怎么回事？

为 Leiningen 设置类路径的正确方法是什么？（它似乎也忽略了在我的环境中定义的 CLASSPATH 变量。）

编辑：回复评论

```
user=> (seq (.. Thread currentThread getContextClassLoader getURLs))
nil 
```

编辑：问题已解决。我正在使用

```
$ lein version
Leiningen 1.7.1 on Java 1.6.0_29 Java HotSpot(TM) 64-Bit Server VM 
```

但是，我显然使用的是 Lein 2.0 的符号

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:52:45.030

您使用的是哪个版本的 Leiningen？新的 2 版本中有一些重大变化，其中之一是`:source-path "src/"`成为`:source-paths ["src/"]`. 一个可能的解释是您正试图将此 lein2 project.clj 文件与 lein1 一起使用。

由于我们目前处于过渡期，因此您必须特别注意自己使用的 lein 版本，以及如果遵循教程，则教程采用哪个版本。

您可以在此处阅读有关版本之间差异的更多信息：[https ://github.com/technomancy/leiningen/blob/master/NEWS.md](https://github.com/technomancy/leiningen/blob/master/NEWS.md)

# css - 流体布局中的固定宽度块

> ID：10150197
> 
> 赞同：1
> 
> 时间：2012-04-14T01:17:48.693
> 
> 标签：css, responsive-design

在流体布局中，我需要在同一行并排放置一个固定宽度的块和一个具有最大宽度的流体宽度块。调整窗口大小时，流体宽度块应调整大小，并由固定宽度块“推动”。

这是我要实现的目标： http: [//cssdesk.com/gHvUB](http://cssdesk.com/gHvUB)

但可悲的是，内容扩展到其容器之外......

任何人 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T03:34:12.447

通过您提供的示例实现目标的一种方法是

1.  为流体框添加 200px 的右边距
2.  将 -200px 的相对位置添加到固定宽度框。

    ```
    .line {
       ...
       position: relative;
     }
    .fluid {
       ...
       margin-right: 200px;
     }
    .fixed-width {
       ...
       position: relative;
       top: 0;
       right: -200px;
     } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T03:16:00.603

使用 css（尤其是 css3）将有许多不同的方法来实现这一点。

这里有几个例子：

[例子](http://www.dynamicdrive.com/style/layouts/item/css-liquid-layout-22-fluid-fixed/)

[例子](http://css.flepstudio.org/en/css-box-model/1-column-fixed-1-column-fluid.html)

在网站上：

[CSS Layout 2-Column 固定流体](https://stackoverflow.com/questions/580195/css-layout-2-column-fixed-fluid)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T03:49:56.010

好的，最简单的方法是设置容器溢出：auto。然后将两个子容器设置为位置：绝对。由于容器的位置：相对，它们将位于父容器内。然后你需要将父级的高度设置为某个值。您可以尝试最小高度：（值）。[我这里有一个样本。](http://cssdesk.com/HkwwV)

希望这可以帮助。

# java - 消除多个构造函数中的冗余

> ID：10150198
> 
> 赞同：0
> 
> 时间：2012-04-14T01:18:39.020
> 
> 标签：java, constructor, redundancy

如果有人能告诉我我的代码是否冗余（如果是，消除冗余的可能解决方案），我将不胜感激。

```
public class Question {
  private Queue<Double> a;

  public Question(double XXX) {
     a = new LinkedList<Double>();  // REDUNDANT?
     ......
  }

  public Question(double[] YYY) {
     a = new LinkedList<Double>();  // REDUNDANT?
     ......
  }
} 
```

基本上，一个构造函数接收一个双精度值，而另一个构造函数接收一个双精度数组。有没有办法`Queue`只实例化一次？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T01:21:34.277

使用 Java 7 和 NetBeans 或其他 IDE 时，IDE 可能会标记

```
a = new LinkedList<Double>(); 
```

作为冗余，您可以使用

```
a = new LinkedList<>(); 
```

反而。但是，如果您只是询问代码中的实际冗余，请使用：

```
public class Question {
  private Queue<Double> a;

  public Question() {
     a = new LinkedList<>();
  }

  public Question(double XXX) {
     this();
     ......
  }

  public Question(double[] YYY) {
     this();
     ......
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T01:22:15.193

您可以在声明时实例化您的变量。

```
public class Question {
   private Queue<Double> a = new LinkedList<Double>();

   ...
 } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T01:22:04.043

您可以使用该`this`运算符调用具有适当参数的另一个构造函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T01:21:42.620

把它放在字段声明中：

```
private Queue<Double> a = new LinkedList<Double>(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-14T01:29:35.657

您可能还需要考虑这一点：

```
public class Question {
    private Queue<Double> a;

    public Question(double ... ds) {
        a = new LinkedList<>(Arrays.asList(ArrayUtils.toObject(ds)));
    }
} 
```

这使用 varargs 构造函数，您可以将单个双精度、多个双精度或双精度数组传递给该构造函数。所以你可以这样做：

```
new Question(1, 2, 3);
new Question(1);
new Question(new double[] { 1, 2, 3 } ); 
```

**注意：** `ArrayUtils`是[Apache Commons Lang](http://commons.apache.org/lang/)的一部分。

# cmake - 特定于本地工作副本的 CMake 编译器设置

> ID：10150199
> 
> 赞同：1
> 
> 时间：2012-04-14T01:19:16.697
> 
> 标签：cmake

目前要在使用 gcc 时更改编译器标志，我为构建目标编辑 CMakeLists.txt：

```
if (UNIX)
    add_definitions(-Wall)
    add_definitions(-g)
    #add_definitions(-O2)
endif (UNIX) 
```

问题在于 git 接受了更改。如果我继续提交此更改，我会惹恼其他希望使用 -O2 而不是 -g 的开发人员，但是当他们拉取不相关的更改时，他们会得到我的版本。通常，我可以从我的提交中排除此更改，但是当我对 CMakeLists.txt 文件进行*实际*更改时，无法避免推高我个人选择的编译标志。

有没有办法告诉 CMake 在 build/ 目录中创建一个文件（特定于每个工作副本，因此特定于每个开发人员），个人可以根据自己的意愿进行修改，而无需触及项目文件（除了 build/ 之外的所有内容）。自然，我们的 build/ 不会提交到 git 存储库。

请注意，当使用 Visual Studio 而不是 gcc 时，IDE 会通过其 UI 为我们处理此问题，该 UI 会修改 build/. 问题是我们在使用 GNU Makefiles 时没有这样的机制。

我们的项目是这样组织的：

```
ourproject/
    bin/
    build/ <-- CMake-generated stuff goes here
    lib/
    src/
        abuildtarget/
        anotherbuildtarget/
            source.cpp
            source.h
            CMakeLists.txt 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T01:25:21.260

您在这里错误地使用了 CMake。该`add_definitions`功能不适用于像您一样添加编译器选项；相反，它是添加预处理器定义，例如`add_definitions(-DDEBUG)`.

您要做的是`CMAKE_<language>_FLAGS`在配置时设置您想要的选项。如果您需要一个标准集，则将其放入 CMakeLists.txt 文件中，例如：

```
if(${CMAKE_Fortran_COMPILER_ID} STREQUAL "Intel")                                   
  set(CMAKE_Fortran_FLAGS_RELEASE "-O2 -xhost" CACHE STRING "" FORCE)

  set(CMAKE_Fortran_FLAGS_NODEBUG "-O0" CACHE STRING "" FORCE)
  mark_as_advanced(CMAKE_Fortran_FLAGS_NODEBUG)

  set(CMAKE_Fortran_FLAGS_PROFILING "-O2 -xhost -p" CACHE STRING "" FORCE)
  mark_as_advanced(CMAKE_Fortran_FLAGS_PROFILING)

  set(CMAKE_Fortran_FLAGS_DEBUG
      "-DDEBUG -g -check noarg_temp_created -C -traceback" CACHE STRING "" FORCE)
endif() 
```

哪里`Fortran`可以用`CXX`or代替`C`。

在这种情况下，`CMAKE_<language>_FLAGS_<build type>`设置基于`CMAKE_BUILD_TYPE`变量的标志。如果设置为`Release`，则使用`CMAKE_Fortran_FLAGS_RELEASE`。我们添加了其他几种可能的构建类型。如果用户想要的东西不是标准构建类型之一，那么他们`CMAKE_<language>_FLAGS`在配置时设置为他们想要的任何东西，它会覆盖构建类型设置并使用用户定义的标志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T13:28:35.263

虽然几乎可以肯定有更好的方法`cmake`来解决您的问题，但您的这部分问题很容易解决：

> 但是当我对 CMakeLists.txt 文件进行实际更改时，无法避免推高我个人选择的编译标志。

仅当您将特定的个人文件更改提交到本地存储库时，*这才*是正确的，即使这样，您也可以`git-revert`在制作要推送的补丁时，或者在您`development`和`ready-to-push-to-other-developers`分支之间使用过滤器 - 粗略的想法可以在[这里](https://stackoverflow.com/questions/2517190/how-do-i-force-git-to-use-lf-instead-of-crlf-under-windows/2517442#2517442)找到，尽管您必须对其进行大量编辑以从问题示例中删除有问题的个人行。

因此，更好的选择是*不提交*个人更改。从[这里](https://stackoverflow.com/questions/1085162/how-can-i-commit-only-part-of-a-file-in-git)的答案，您可以轻松地提交对文件的特定更改。

但是，需要注意的是，如果您对未忽略的文件进行了未提交的更改，您最终会得到一个永久脏的工作树；这可能是也可能不是问题，具体取决于您的合并工作流程等。

# java - Java 网络 - 客户端/服务器

> ID：10150201
> 
> 赞同：0
> 
> 时间：2012-04-14T01:19:31.093
> 
> 标签：java, sockets, networking, serversocket

我的最后一个课程项目是组合一个游戏，包括多人游戏。所以我开始试图弄清楚java网络，我有点卡住了。

两个游戏客户端中的每一个都需要能够与另一个客户端发送和接收消息。

我想我会处理这个问题的方式是我有一个在它们自己的线程中运行的 NetworkServer 和 NetworkClient 对象。

我在想我会从我的主游戏应用程序中启动它们，但我想先做一些测试，所以我设置了这个项目：

**网络客户端：**

```
import java.io.IOException;
import java.io.ObjectOutputStream;
import java.net.Socket;
import java.util.Timer;
import java.util.TimerTask;

public class NetworkClient extends Thread {

    Socket server;
    ObjectOutputStream out;
    Timer timer;

    public NetworkClient(String hostname, int port) throws IOException
    {
        server = new Socket(hostname, port);
        out = new ObjectOutputStream(server.getOutputStream());
        timer = new Timer();
        timer.schedule(new SendTask(),  0, 1*1000); 
    }

    public void sendData(Integer b) throws IOException {
        out.writeObject(b);
    }

    class SendTask extends TimerTask {
        Integer i = new Integer(1);

        public void run() {
            System.out.println("Client: Sending Integer: " + i.toString());
            try {
                sendData(i);
                i = new Integer(i.intValue()+1);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        } // run()
    } // class SendTask

} 
```

**网络服务器：**

```
import java.io.IOException;
import java.io.ObjectInputStream;
import java.net.ServerSocket;
import java.net.Socket;
import java.net.SocketTimeoutException;

public class NetworkServer extends Thread {

    private ServerSocket serverSocket;
    private Socket client;
    private Integer i;
    private ObjectInputStream in;

    public NetworkServer(int port) throws IOException
    {
       serverSocket = new ServerSocket(port);
       //serverSocket.setSoTimeout(10000);
    }

    public void run()
    {
       try {
        System.out.println("Waiting for client on port " + serverSocket.getLocalPort() + "...");  
        client = serverSocket.accept();           
        System.out.println("Just connected to " + client.getRemoteSocketAddress());
        in = new ObjectInputStream(client.getInputStream());
        } catch (IOException e2) {
            // TODO Auto-generated catch block
            e2.printStackTrace();
        }

       while(true)
       {

          try
          {
             i = (Integer) in.readObject();
             System.out.println("Server: Received the integer: " + i.toString());
          }
          catch(SocketTimeoutException s)
          {
             System.out.println("Socket timed out!");
             break;
          }
          catch(IOException e)
          {
             e.printStackTrace();

             try { client.close();} catch (IOException e1) {}

             break;
          } catch (ClassNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
       }
    }

} 
```

**网络（我用来尝试测试的东西）：**

```
import java.io.IOException;

public class Network {

    NetworkClient client;
    NetworkServer server;

    public Network() throws IOException {
        server = new NetworkServer(6066);
        server.start();

        client = new NetworkClient("192.168.1.196", 6066);
        client.start();
    }

    public static void main(String [] args)
    {
       try
       {
          Network n = new Network();
       }catch(IOException e)
       {
          e.printStackTrace();
       }
    }

} 
```

我在那里有计时器，以方便将数据从客户端发送到服务器，这通常由我的游戏完成，但由于我正在测试，我必须以某种方式发送它。

当我在客户端和服务器相互交谈的地方运行它时，我会同时收到 Sent 和 Received 消息。

当我把它放在我的笔记本电脑上（并更改 NetworkClient 中的 IP 以匹配我的桌面，反之亦然）并在两个地方运行它时，桌面上的客户端发送到笔记本电脑上的服务器，但客户端笔记本电脑不会发送到桌面上的服务器。

在运行过程中的某个时刻，我收到一个关于该客户端的连接被对等方重置的异常，尽管工作的客户端/服务器连接仍在继续。

所以，我想我的问题是，有谁知道为什么它在一个方向上工作而不是双向？

**固定的！！**

编辑：Gah，我想通了。这与启动两台服务器的时间有关。

我将网络更改为：

```
import java.io.IOException;

public class Network {

    NetworkClient client;
    NetworkServer server;

    public Network() throws IOException {
        startServer();

        startClient();
    }

    private void startServer() throws IOException {
        server = new NetworkServer(6066);
        server.start();
    }

    private void startClient(){
        boolean isConnected = false;
        while (!isConnected) {
            try {
                client = new NetworkClient("192.168.1.196", 6066);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                //e.printStackTrace();
                continue;
            }
            isConnected = true;
        }
        client.start();
    }

    public static void main(String [] args)
    {
       try
       {
          Network n = new Network();
       }catch(IOException e)
       {
          e.printStackTrace();
       }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T01:41:02.523

编辑您的防火墙。确保 java.exe 启用了入站和出站流量。此外，为端口 6066 添加一条规则到您的防火墙。

# javascript - 在原型方法中从内部函数修改实例变量

> ID：10150207
> 
> 赞同：2
> 
> 时间：2012-04-14T01:21:28.770
> 
> 标签：javascript, oop, scope

我正在尝试将数据库中的数据建模为服务器端 JavaScript（节点）中的“类”。目前，我只是在适当的地方使用带有原型方法的传统构造函数模式，并将构造函数公开为整个`module.exports`. 这是服务器端的事实对于问题的核心并不重要，但我想我会提供它作为参考。

代码的问题区域如下所示：

```
User.prototype.populate = function() {  
    var that = this;    
    db.collection("Users").findOne({email : that.email}, function(err, doc){
        if(!err) {
            that.firstName  = doc.firstName;
            that.lastName   = doc.lastName;
            that.password   = doc.password;
        }
        console.log(that); //expected result
    });
   console.log(that); //maintains initial values
}; 
```

每当我调用此函数时，一旦完成，对对象的更改就不会持续存在`findOne()`。我意识到`this`全局对象的更改范围具有新的函数范围，因此我将其引用保持为`that`. 如果`console.log(that)`来自匿名函数，数据会按预期显示在它的属性中。但是，如果我在函数完成后登录`that`，它会保持函数开始时的状态。

这里发生了什么以及如何按预期更改实例变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T01:28:25.813

> *“但是，如果我在函数完成后记录它，......”*

通过这个我假设你正在做这样的事情......

```
var user = new User

user.populate();

console.log(user); 
```

如果是这样，将在调用*异步*回调`console.log`之前很久运行。*`.findOne()`*

 *任何依赖于响应的代码都`findOne`需要在回调中调用。

* * *

***编辑：***您的更新与我上面的示例略有不同，但原因是相同的。

将回调传递给该`findOne`方法的全部原因是它执行*异步*活动。如果没有，则没有理由进行回调。您只需将内部代码直接放在对 的调用之后`findOne`，就像对`console.log()`.

但是因为它是*异步*的，所以后面的代码不会等待执行。这就是您在控制台中获取未填充对象的原因。

如果为每个添加标签`console.log()`，您会看到它们执行无序。

* * *

```
var that = this;    
db.collection("Users").findOne({email : that.email}, function(err, doc){
    if(!err) {
        that.firstName  = doc.firstName;
        that.lastName   = doc.lastName;
        that.password   = doc.password;
    }
    console.log("inside the callback", that); // this happens Last!!!
});

console.log("outside the callback", that); // this happens First!!! 
```

因此，一旦您观察到调用的顺序，就会清楚地`console.log`知道空的调用发生在回调内部的调用之前。

* * *

***编辑：***您还可以让您的`.populate()`方法接收在回调中调用的`.findOne`回调。

```
User.prototype.createNickName = function () {
    this.nickname = this.firstName.slice(0,3) + '_' + this.lastName.slice(0,3);
};

    // >>>------------------------------v----receive a function argument...
User.prototype.populate = function(callback_func) {  
    var that = this;    
    db.collection("Users").findOne({email : that.email}, function(err, doc){
        if(!err) {
            that.firstName  = doc.firstName;
            that.lastName   = doc.lastName;
            that.password   = doc.password;
        }

          // all users will have the "createNickName()" method invoked
        that.createNickName();

          // ...and invoke it in the callback.
        callback_func.call(that);

          // By using .call(), I'm setting the "this" value
          //    of callback_func to whatever is passed as the first argument
    });
}; 
```

* * *

```
 // this user wants to log the firstName property in all caps
var user1 = new User;

user1.populate(function() {
    console.log(this.firstName.toUpperCase());
});

   // this user wants to log the the whole name
var user2 = new User;

user2.populate(function() {
    console.log(this.firstName + ' ' + this.lastName);
});

   // this user wants to verify that the password is sufficiently secure
var user3 = new User;

user3.populate(function() {
    console.log(verify_password(this.password));
}); 
```*

# python - 无法在 Windows 7 Ultimate 32 位上安装 setuptools

> ID：10150217
> 
> 赞同：4
> 
> 时间：2012-04-14T01:22:22.950
> 
> 标签：python, windows-7, setuptools

我正在尝试在 Windows 7 Premium 32 位上安装 setuptools。我已经`setuptools-0.6c11.win32-py2.7.exe`从[http://pypi.python.org/pypi/setuptools#files](http://pypi.python.org/pypi/setuptools#files)下载了安装程序，当我尝试安装它时，我收到以下错误：`Python 2.7 is required, which was not found in the registry`. 好吧，我知道现在已经安装了 Python 2.7.2。我在网上查看过，唯一看到的是在 Windows 7 64 位上安装时遇到问题。有没有其他人遇到过这个问题或知道如何解决？

**编辑**

添加可见性。

我搜索了注册表，但在任何地方都没有找到安装路径。我将它添加回 HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.7\ 并没有修复安装错误。

**编辑 2**

我找到了解决方案。我下载并运行： http: [//peak.telecommunity.com/dist/ez_setup.py](http://peak.telecommunity.com/dist/ez_setup.py)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:37:36.080

我找到了安装它的方法。我下载了[http://peak.telecommunity.com/dist/ez_setup.py](http://peak.telecommunity.com/dist/ez_setup.py)并运行它。安装没有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T01:24:41.327

检查您是否已将其中一个`PATH environmental variable`设置为安装 python 的位置。

[检查此链接以获取更多信息](http://docs.python.org/using/windows.html#configuring-python)

# c# - 如何对一组对象进行排序，必须根据一些不断变化的参数进行排序

> ID：10150222
> 
> 赞同：2
> 
> 时间：2012-04-14T01:23:05.163
> 
> 标签：c#, list, sorting, weighted

我正在研究如何使用加权值有效地对列表进行排序。

每个项目都有一个 ID、名称和文件路径。每个项目还有一个值列表，这些值分配了一个百分比，显示它们与每个值的相关程度。

我需要对列表进行排序，以便列表顶端的项目是与当前参数最相关的项目。

可以说，

项目一：

*   A：50，B：30，C：20，D：10
*   X：50，Z：20

项目二：

*   A:100, B:0, C:0, D:0
*   X:0, Z:100

我的参数是 A 和 Z。显然，项目二应该在我的列表顶部，因为它是最相关的项目。但是我将如何实施呢？

奖励：能够进行轻微的随机化也很好，我不想每次都得到最终的相关项目。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T01:37:12.020

假设你知道你的权重函数，你可以使用 Linq to Objects：

```
var sorted = (from o in myList orderby o.SortingValue select o).ToList(); 
```

在此示例中，`SortingValue`它将是对象上的一个属性，该属性封装了您问题中的属性并将实现您的算法。

SortingValue 的示例算法：

您可以使用字典来保存相关百分比

然后，您的“当前参数”可以用作字典的键以获得相关权重：

```
Dictionary<string, double> weightDictionary = // Load somehow

double SortingValue
{
    get {
        double sortingValue;

        foreach(string currentParameter in currentParameters)
        {
            sortingValue += weightDictionary[currentParameter];
        }

        // You could use Math.Random to get a number between say -0.1 and -.1\.  
        // Multiply sortingValue by that random number.
        return sortingValue;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-29T11:18:05.383

很久以前，我为此目的创建了一个扩展方法。我刚刚再次遇到了对它的需求：

```
public static IOrderedEnumerable<TSource> OrderByWeight<TSource, TKey>(this IEnumerable<TSource> source, Func<TSource, TKey> keySelector, Func<TKey, int> weighting) where TKey : IComparable
{
    Dictionary<TSource, int> order = new Dictionary<TSource, int>();
    foreach (TSource item in source)
    {
        if (!order.ContainsKey(item)) order.Add(item, weighting(keySelector(item)));
    }
    return source.OrderBy(s => order[s]);
} 
```

你可以像这样使用它：

```
var data = dt.Select(g => new
{
    Season = g.season,
    AverageTemp = g.temp
}).OrderByWeight(a => a.Season, x =>
{
    if (x == "WINTER") return 1;
    if (x == "SPRING") return 2;
    if (x == "SUMMER") return 3;
    if (x == "AUTUMN") return 4;
    return 99;
}); 
```

来源：[来自我的旧博客](http://www.skindog.co.uk/2009/03/18/custom-sorting-order-in-linq-order-by-weighting/)

# php - 接收“30 秒后未处于启动状态的部署角色实例”Azure PHP

> ID：10150223
> 
> 赞同：11
> 
> 时间：2012-04-14T01:23:11.433
> 
> 标签：php, deployment, azure

尝试将测试 php 应用程序部署到我的 Azure 模拟器时，我不断收到此消息

> ```
> Using session id 1
> Warning : Remapping public port 80 to 81 to avoid conflict during emulation.
> Warning : Remapping private port 80 to 82 in role 'PhpOnAzure.Web' to avoid conf
> lict during emulation.
> Created: deployment16(6)
> Deployment role instances not in "Started" state after 30 seconds.
> Exported interface at http://127.0.0.1:81/.
> C:\temp\WindowsAzurePHPApp\build/WindowsAzurePHPApp.cspkg
> C:\Users\Manu> 
> ```

我按照“在 Azure 上构建和部署 PHP 应用程序”教程（检查 CGI，也激活了 PHP）进行了一些故障排除，但在任何地方都没有。还有其他人遇到同样的问题吗？我的这段代码的输出是 Firefox 中的一个空白页，上面写着连接超时。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-19T16:11:25.037

您是否正在运行任何其他 Web 服务器软件，例如 Apache？IIS 需要控制才能正常运行。Firefox 中的连接问题让我觉得 IIS 可能被阻止或未启动。寻找另一种可能性，有时 IIS 与 PHP 混淆，并将其中两个添加到模块列表中。也检查一下

# javascript - 使用 javascript 选择列表框项目时更新文本框的信息

> ID：10150224
> 
> 赞同：2
> 
> 时间：2012-04-14T01:23:18.390
> 
> 标签：javascript, asp.net-mvc, listbox

我正在尝试使用所选项目信息（属性）更新文本框。我可以获取选定的项目名称而不是 Id，或者换句话说，如何在选择项目时获取我的 ViewData 中的内容的属性，然后将其设置为 txtbox？

```
 @Html.ListBox("ListBoxName", new SelectList((IEnumerable<Epic>)ViewData["selectedestimate"], "Id", "Name", "EstimatedTime"), new {@class = "ListBoxClass", @style = "height: 325px;"})
        @Html.TextBoxFor(model => model.Name, new {@class = "TimeClass"})

   <script type="text/javascript">
         $(function () {
           $(".ListBoxClass").click(function (event) {
        var selectedid = $(this).find("option:selected").val();

         // get items properties and info so that the value can be set to a textbox
        //set textbox value to Name of selected Value
        $(".TimeClass").val(selectedid);
        event.preventDefault(); // Stop the browser from redirecting as it normally would
        $.get('@Url.Action("UserStoriesList", "Estimate")', { id: selectedid }, function (result) {
            $('#stories').html(result);
        });
    });
});
    </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T06:41:28.177

ListBox 与 DropDownList 类似，不同之处在于它允许选择多个项目。它使用相同的 HTML 标记 ( `<select>`)，但添加了`multiple`属性。因此，当呈现您的标记将如下所示：

```
<select id="ListBoxName" name="ListBoxName" multiple="multiple">
    <option value="id1">text 1</option>
    <option value="id2">text 2</option>
    <option value="id3">text 3</option>
    ...
</select> 
```

如您所见，您有关于 DOM 中的 id 和文本的信息。如果您想获取有关所选项目的其他信息，您需要向服务器发送 AJAX 请求并传递所选 id 以检索它。因此，如果您只想显示文本：

```
$(function() {
    ​$('.ListBoxClass option')​.click(function() {
        if ($(this).is(':selected')) {
            var selectedId = $(this).val();
            var selectedText = $(this).text();
            $('.TimeClass').val(selectedText);
            ...
        }
    });​
}); 
```

每次用户单击列表框中的`click`元素时，处理程序都会运行，但只有当他选择了该项目时才会满足 if 条件。

# visual-studio - 是否有在 ReSharper 中打开建议菜单（见图）的关键命令

> ID：10150228
> 
> 赞同：1
> 
> 时间：2012-04-14T01:24:26.130
> 
> 标签：visual-studio, visual-studio-2010, resharper, keyboard-shortcuts

这一直困扰着我，今天早上我决定尝试找出是否有一个键命令可以打开 resharper 建议菜单并快速向上/向下选择适当的选项。每次都得抓鼠标很烦人。

我检查了 Resharper 键命令列表，但找不到任何听起来像它的东西（尽管我发现了一些我从来不知道的很酷的键命令，尤其是封装字段命令！）

如果它存在，有人知道吗？

![在此处输入图像描述](../Images/4abf4ecc443a3b2e7d375b9041ac9bfe.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T01:26:38.220

`Alt`+`Enter`

除非您选择保留 Visual Studio 快捷方式而不是 ReSharper 快捷方式。

# ios - 如何检测 UINavigationController 动画何时完成？

> ID：10150231
> 
> 赞同：12
> 
> 时间：2012-04-14T01:24:50.193
> 
> 标签：ios, iphone, objective-c, uikit

我希望这是一个简单的问题。如果我有一个 UINavigationController 并且我将一个新的视图控制器推送到带有动画转换的堆栈上，我如何检测动画何时完成并且新的视图控制器在屏幕上？

我有一些场景需要推送一个新控制器，然后必须执行长时间运行的操作。我想先推送新视图，以便在我开始长时间阻塞主线程之前屏幕上有一些东西。如果我在我的长时间运行的任务之后立即执行推送，则视图不会显示，直到两者都完成并且主线程能够再次处理事件之后。

所以，一旦动画完成并且视图在屏幕上，我想做的就是能够在新控制器中检测到，然后开始任务。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-14T02:05:53.097

+1 @Dhamrick 建议不要阻塞主线程。

要回答原始问题，您可以在两个地方检测 viewController 的变化：

1.  你刚刚推送的 viewController 会收到[viewWillAppear:](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/viewWillAppear:)和[viewDidAppear:](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/viewDidAppear:)消息。如果您想知道特定的 viewController 何时出现，请实现这些方法。

2.  `navigationController:didShowViewController:animated:`@Mike Z 提到的方法被发送到 navigationController 的[delegate](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html#//apple_ref/occ/instp/UINavigationController/delegate)。您需要指定一个对象作为该委托方才能接收此消息。然后，您将知道*每次*viewController 出现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-14T01:38:42.283

与其阻塞主线程，不如考虑在另一个线程内执行长时间运行的操作，甚至更好，使用 GCD 队列。

```
dispatch_queue_t backgroundQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, NULL);
dispatch_async(backgroundQueue, ^{
    // Do your long running code
    dispatch_async(dispatch_get_main_queue(), ^{
        //Update your UI
    });
}); 
```

您可以将此代码放入您的代码中，`viewDidLoad:`以便您知道您的 UI 已经加载。这也意味着您不必依赖动画的时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-14T01:32:31.927

我自己没有测试或实现过这个，但文档听起来像：

`navigationController:didShowViewController:animated:`

描述为：在导航控制器显示视图控制器的视图和导航项属性之后发送到接收器。

除此以外，

`setAnimationDidStopSelector:`可能对你有用。

描述为：设置动画停止时发送给动画代理的消息。

# javascript - 如何在屏幕中间弹出一个 div 并使网站的其余部分变暗

> ID：10150232
> 
> 赞同：-6
> 
> 时间：2012-04-14T01:24:50.790
> 
> 标签：javascript, jquery, html, css

我只是在新的 vimeo 中说，并想知道这是如何完成的

这是按钮

```
 <a href="/messages/compose?recipient=1667821" class="message btn" 
data-lightbox="">Send Message</a> 
```

没有 onclick() ，它们获取 href 值并插入到 div 中而不刷新页面..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T01:31:10.053

在不查看他们的代码的情况下，他们可能稍后会在他们的 Javascript 中绑定一个点击处理程序，可能使用 jQuery。它看起来像这样：

**jQuery：**

```
$(".message").click(function() {
    // do the lightbox
}); 
```

**香草Javascript：**

```
document.getElementByClass("message").onclick = function() {
    // do the lightbox
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T01:29:04.983

我个人使用[jQuery UI](http://jqueryui.com/)。

***[点击这里查看他们的模态对话框演示/源代码](http://jqueryui.com/demos/dialog/#modal)***。

# ruby-on-rails-3.1 - Unicorn/Nginx 进程丢失，套接字打开

> ID：10150245
> 
> 赞同：5
> 
> 时间：2012-04-14T01:26:42.337
> 
> 标签：ruby-on-rails-3.1, nginx, capistrano, production-environment, unicorn

我正在尝试使用 Capistrano 部署代码，但它失败了，`deploy:start`或者`deploy:stop`因为 Unicorn 进程已经被杀死。但是，如果我尝试这样做`cap deploy:start`，我会得到一个 stderr 声明`Address already in use - /tmp/my_app.socket`。这将如何发生，我如何才能摆脱这种混乱？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-14T18:24:39.050

仍然不确定这是如何发生的，但以下解决方案似乎有效：

`lsof /tmp/my_app.socket`- 列出 pid

`kill -9 pid`- （将“pid”替换为列出的其中之一）

然后`cap deploy:start`从本地终端。

# c# - 这种方法签名是什么意思-> 公共部分类实体：Entity.ObjectContext

> ID：10150246
> 
> 赞同：0
> 
> 时间：2012-04-14T01:27:28.983
> 
> 标签：c#, .net

这种方法签名是什么意思

```
public partial class Entities : Entity.ObjectContext<Entities> 
```

我知道冒号 (:) 继承自之后的任何内容，但是

```
<Entities> 
```

意思是？

它是某种通用的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T01:29:50.667

这不是方法签名，而是（[部分](http://msdn.microsoft.com/en-us/library/wa80x488.aspx)）类声明。

“部分”表示类的其余部分可以在一个或多个单独的文件中定义。部分类在进行代码生成时特别有用（例如，WinForms 设计器使用它们将生成的代码与用户代码分开）。您展示的具体示例来自实体框架。

该`<Entities>`部分意味着这是一个[通用函数](http://msdn.microsoft.com/en-us/library/ms379564%28v=vs.80%29.aspx)。

# javascript - 如何使用 XPath 操作 XML 数据

> ID：10150247
> 
> 赞同：0
> 
> 时间：2012-04-14T01:27:29.683
> 
> 标签：javascript, xml, xpath, xfa

我在 Acrobat JS 中处理 XML 文件数据时遇到了麻烦。我已经有一个 XML 文档并已阅读它。现在 XML 如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<xfa:data xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/">
<mapData>
<busline>  
  <id>4</id>  
  <name>K222</name>
  <stationList>
  <station>  
  <name>FirstStation</name>
  <stationAnnotName>station</stationAnnotName>  
  <cordX>-309</cordX>   
  </station>  
  <station>  
  <name>222first</name>  
  <stationAnnotName>station3</stationAnnotName>
  <cordX>-315</cordX>  
  </station>  
  </stationList>  
</busline>  
<busline>  
  <id>5</id>  
  <name>K333</name>     <-----find busline name == K333 and delete this busline node
  <stationList>
  <station>  
  <name>ss</name>
  <stationAnnotName>station</stationAnnotName>  
  <cordX>-309</cordX>   
  </station>  
  <station>  
  <name>Target</name>    <-----query by this station name
  <stationAnnotName>station3</stationAnnotName>
  <cordX>*-315*</cordX>  <----need this value
  </station>  
  </stationList>  
</busline>
</mapData>
</xfa:data> 
```

在 Adob​​e Acrobat 中，我们有一个名为 XMLData.applyXPath(oXML,sringXPath) 的方法。现在我想获取其名称 == 目标的站点节点的 cordX 值。换句话说，我们有很多不同的站节点属于statinList->busline->mapData->(xfa:data?)

那么如何编写 XPath 来找到它，如果我想删除它有一个站节点名称为 Target 的总线。我将使用颜色来明确。

所以我需要通过它的名称（红色）来获取station.cordX，删除busine.name == K333（蓝色）的总线

我很感激你的帮助。尽快需要您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T02:00:41.523

您可以检索名称标签值为 Target 的所有电台列表。

```
//busline/stationlist[name='Target']/name 
```

# mysql - 如何按第一个字母计算行数？

> ID：10150252
> 
> 赞同：4
> 
> 时间：2012-04-14T01:27:57.530
> 
> 标签：mysql, sql

这里有一个菜鸟问题！

我写了这个查询，但是“分组依据”非常愚蠢......那么，我该如何纠正这个问题？

```
SELECT
    COUNT(*) AS total,
    'x' as test
    FROM
contents
    WHERE name LIKE 'C%'
GROUP BY
    test
ORDER BY id ASC 
```

欢迎使用不同的解决方案和有关表演的信息（也许使用 DISTINCT？）

提前致谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-14T01:33:00.743

这应该与任何其他选项一样好 -

```
SELECT
    LEFT(name, 1) AS first_letter,
    COUNT(*) AS total
FROM contents
GROUP BY first_letter 
```

如果您想一次针对单个字母运行此查询，您可以添加 WHERE 子句并删除 GROUP BY -

```
SELECT COUNT(*) AS total
FROM contents
WHERE name LIKE 'a%' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T01:42:58.230

让我们剖析您的查询：

```
SELECT
    COUNT(*) AS total,
    'x' as test     <-- Why?
    FROM            <-- Bad formatting.
contents
    WHERE name LIKE 'C%'
GROUP BY
    test            <-- Removing 'x' and the whole GROUP BY has the same effect.
ORDER BY id ASC     <-- The result only contains one row - nothing to sort. 
```

因此，返回一行和一个字段的查询，包含`name`以“C”开头的行数，如下所示：

```
SELECT COUNT(*)
FROM contents
WHERE name LIKE 'C%' 
```

拥有**领先优势**的索引`name`将确保良好的性能。要了解原因，请查看[SQL 索引剖析](http://use-the-index-luke.com/sql/anatomy)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T01:33:07.823

应该给你一切，以备不时之需

```
SELECT
  COUNT(*) AS total,
  test
FROM
 (SELECT substring(name,1,1) as test
 from contents) t
GROUP BY test 
```

# windows - 在 recv 上 WinSock2 错误 10093

> ID：10150255
> 
> 赞同：0
> 
> 时间：2012-04-14T01:29:00.387
> 
> 标签：windows, multithreading, sockets, winsock2

所以我在windows中构建了一个多线程套接字库，当我调用recv时我得到了WSA Not Started错误，即使我成功地让一个客户端连接到服务器。我在穿线之前也让它工作，但我不知道从那以后发生了什么。任何帮助，将不胜感激。

Spocket.hpp

```
 #include <iostream>
    #include <string>
    #include <Windows.h>
    #pragma comment (lib,"ws2_32.lib")

    static bool initialized_ = false;

    class Spocket
    {
    protected:
        WSADATA         wsaData_;
        SOCKET          hSocket_;
        sockaddr_in     service_;
        std::string     addr_;
        USHORT          port_;
        int             exitCode_;

    public:
        Spocket() { 
            initialize(); 
            create_socket(); 
        }
        Spocket(std::string addr, USHORT port)
            : addr_( addr ), port_( port ) { 
                initialize(); 
                create_socket(); 
        }
        Spocket(Spocket spock, SOCKET sock)
            : hSocket_( sock ), 
            wsaData_( spock.wsaData_ ),
            service_( spock.service_ ),
            addr_( spock.addr_ ),
            port_( spock.port_ ) 
        { 
            initialize(); 
        }
        virtual ~Spocket() { close(); }

        void initialize();
        void create_socket();
        void close();

        template<typename T>
        int recv_data(T* i) {
            int ret = recv( hSocket_, reinterpret_cast<char*>(i), 32, 0 );
            if( ret == SOCKET_ERROR )
                cerr << WSAGetLastError() << endl;
            return ret;
        }

        template<typename T>
        int send_data(T* i) {
            int ret = send( hSocket_, reinterpret_cast<char*>(i), sizeof(i), 0 );
            if( ret == SOCKET_ERROR )
                cerr << WSAGetLastError() << endl;
            return ret;
        }
    };

class ServerSpocket : public Spocket
{
public:
    ServerSpocket(std::string addr, USHORT port);
    Spocket* accept_clients();
};

class ClientSpocket : public Spocket
{
public:
    ClientSpocket(std::string addr, USHORT port);
}; 
```

Spocket.cpp

```
#include <iostream>
using namespace std;
#include "../include/spocket.hpp"

void Spocket::initialize() {
    if(!initialized_)
    {
        cout << "Initializing socket..." << endl;

        exitCode_ = EXIT_SUCCESS;
        int iResult = WSAStartup( MAKEWORD(2,2), &wsaData_ );
        if( iResult != NO_ERROR ) {
            cerr << "WSAStartup failed" << endl;
            exitCode_ = EXIT_FAILURE;
            close();
        }
        initialized_ = true;
    }
}

void Spocket::create_socket() {
    hSocket_ = socket( AF_INET, SOCK_STREAM, IPPROTO_TCP );
    if( hSocket_ == INVALID_SOCKET )
    {
        cerr << "Error at socket(): " << WSAGetLastError() << endl;
        exitCode_ = EXIT_FAILURE;
        close();
    }

    service_.sin_family = AF_INET;
    service_.sin_addr.s_addr = inet_addr(addr_.c_str());
    service_.sin_port = htons(port_);
}

void Spocket::close() {
    closesocket( hSocket_ );
    WSACleanup();
}

ServerSpocket::ServerSpocket(std::string addr, USHORT port) : Spocket(addr, port) {
    if( bind( hSocket_, (SOCKADDR*)&service_, sizeof(service_) ) == SOCKET_ERROR )
    {
        cerr << "Failed to bind" << endl;
        exitCode_ = EXIT_FAILURE;
        close();
    }

    if( listen( hSocket_, 1 ) == SOCKET_ERROR )
    {
        cerr << "Error listening on socket" << endl;
        exitCode_ = EXIT_FAILURE;
        close();
    }
}

Spocket* ServerSpocket::accept_clients() {
    cout << "Waiting for connection...\n";
    SOCKET hAccepted = INVALID_SOCKET;
    while( hAccepted == INVALID_SOCKET )
        hAccepted = accept( hSocket_, NULL, NULL );
    return new Spocket( *this, hAccepted );
}

ClientSpocket::ClientSpocket(std::string addr, USHORT port) : Spocket(addr, port) {
    if( connect( hSocket_, (SOCKADDR*)&service_, sizeof(service_) ) == SOCKET_ERROR )
    {
        cerr << "Failed to connect" << endl;
        exitCode_ = EXIT_FAILURE;
        close();
    }
} 
```

server_main.cpp

```
#include <iostream>
#include <fstream>
#include <vector>
#include <spocket.hpp>
using namespace std;

vector<HANDLE> hThreads;
vector<DWORD> dwThreadIds;

struct ConnectionInfo
{
    string ip;
    unsigned int port;
    ConnectionInfo( string ip_, unsigned int port_ ) : ip(ip_), port(port_){}
};
static ConnectionInfo ci( "127.0.0.1", 27015 );

DWORD WINAPI clientSession( LPVOID lpParam )
{
    // create new socket to listen for connection attempts
    ConnectionInfo arg = *reinterpret_cast<ConnectionInfo*>(lpParam);
    ServerSpocket listenSock( arg.ip, arg.port );

    // spawn a duplicate thread when a connection is made, and close the current listening socket
    Spocket* sessionSock = listenSock.accept_clients();
    listenSock.close();
    cout << "client connected..." << endl;
    /*
    hThreads.push_back( CreateThread( NULL, 0, clientSession, &ci, 0, NULL ) );
    */

    // service the connected client
    string msg;
    while( sessionSock->recv_data(&msg) != SOCKET_ERROR && msg != "goodbye!" )
    {
        cout << msg << endl;
        msg.clear();
    }

    cout << "finished with client..." << endl;

    // wait quietly for server shutdown
    while( true )
        Sleep( 200 );
    return 0;
}

int main() {
    cout << "[Server]" << endl;
    cout << "starting up..." << endl;

    hThreads.push_back( CreateThread( NULL, 0, clientSession, &ci, 0, NULL ) );

    string input = "";
    do 
        cin >> input;
    while( input != "exit" );

    // close all thread handles here
    cout << "shutting down..." << endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:14:15.323

我相信您必须保持“原始”套接字处于活动状态。`listenSock.close();`在`sessionSock->recv_data()`循环之后移动。

# actionscript-3 - 评论事件处理程序参数

> ID：10150257
> 
> 赞同：-2
> 
> 时间：2012-04-14T01:29:07.263
> 
> 标签：actionscript-3, comments

我应该如何评论事件处理程序参数？我的意思是，我应该评论事件处理程序参数吗？

例子：

TimerMessage 类扩展了 Timer。

TimerMessage 类有一个 setMessage 方法，该方法将文本消息存储在其公共变量“消息”中。

在使用中：

```
var timer_message:TimerMessage = new TimerMessage(1000, 1)
timer_message.setMessage('hello')
timer_message.addEventListener(TimerEvent.TIMER_COMPLETE, displayMessage)

private function displayMessage(e:TimerEvent):void{
txt.text = e.target.message
e.target.stop()
e.target.removeEventListener(TimerEvent.TIMER_COMPLETE, displayMessage)
} 
```

我应该如何评论 displayMessage 处理程序？

```
/* Displays message on main stage
 * @param e - timer event
 * */ 
```

像那样？

我认为@param 部分太多余了。

你认为呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T04:14:48.407

不，这不是太多余。我通常在我想要记录的任何方法或变量之前按 Command-Shift-D（在 Mac 上，在 Windows 上，我认为您将 Command 键替换为 Control 键）。

Flash Builder 会生成一个注释模板供您填写，其中包括方法中每个参数的@param。

[可以使用asdoc 命令](http://www.wastedpotential.com/flash-as3-the-simple-way-to-create-an-api-reference-with-asdoc/)将其变成漂亮的 HTML 文档，供您的代码使用。在这一点上，所有那些多余的 @param 东西似乎不那么多余了，而且实际上非常整洁。[还有其他标签](http://help.adobe.com/en_US/flex/using/WSd0ded3821e0d52fe1e63e3d11c2f44bc36-7ff6.html)。

# iphone - 是否有打开Xcode在模拟器上安装应用程序的目录的快捷方式？

> ID：10150258
> 
> 赞同：0
> 
> 时间：2012-04-14T01:29:24.707
> 
> 标签：iphone, xcode, ios-simulator

我以为我遇到了类似于“在 Finder 中打开应用程序包位置”的菜单项或右键单击命令，但我找不到它。也许这是梦中的一个秘密愿望。也许不吧。这存在吗？

编辑：我知道这些文件在文件系统中的位置。我已将 iPhone Simulator 文件夹添加到 Dock 中，以便轻松到达那里。我正在做很多工作，我必须验证应用程序包是否已根据需要进行更新。正如我所说，我以为我看到了一个可以让你更快到达那里的右键菜单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T01:34:54.827

好吧，我不确定是否有这样的快捷方式，但您绝对可以通过以下方式浏览您的文件：

```
~/Library/Application Support/iPhone Simulator/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-26T14:59:19.593

试试[SimPholders 1.5](http://simpholders.com)。从他们的网站：

> 一个用于快速访问您的 iPhone 模拟器应用程序的小实用程序。在 Finder 中打开文件夹，重置库和文档，并删除选定的应用程序。

# python - Python反转列表的切片

> ID：10150260
> 
> 赞同：2
> 
> 时间：2012-04-14T01:29:38.903
> 
> 标签：python, list

如何使用其索引反转或迭代列表？

这是一个例子

```
lst = [3,2,4,1,5] 
```

输出将是：（`[3,2,4,5,1]`最后是 1 的索引 3）

另一个例子：

```
lst = [1,5,4,2,3] 
```

输出：（`[1,5,4,3,2]`索引 3 即 2 放在最后）

就像使用切片反转列表一样。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T01:34:26.543

如果您想将列表的一部分反转过去某个点，最直接的方法是：

```
output = (lst[:3] # take the list before element 3
          + # and add
          lst[3:] # the list from element 3 on
          [::-1] # reversed
         ) 
```

或者，没有评论：

```
output = lst[:3] + lst[3:][::-1] 
```

如果要更改现有列表，您可以：

```
lst[3:] = lst[3:][::-1] 
```

# asp.net - 从多个 SQL 表中提取前 5 行，如何将每行的数据显示到标签中，VB.NET？

> ID：10150262
> 
> 赞同：0
> 
> 时间：2012-04-14T01:29:43.580
> 
> 标签：asp.net, sql-server, vb.net

这个问题是我之前提出的一个问题的后续问题，这个问题很快就得到了解决。上一个问题可以在这里找到：[Selecting TOP 4 records from multiple SQL Server tables。使用 vb.net](https://stackoverflow.com/questions/10148883/selecting-top-4-records-from-multiple-sql-server-tables-using-vb-net)

我从多个按日期排序的 SQL 表中选择了前 4 行。然后我将如何将这些数据放入标签中。总共应该有 16 个项目（4 列，4 行）。但是，如果我尝试使用 sqldatareader，我只会得到 0-3 项，而其他任何内容都在数组之外。在这种情况下我不应该使用 IF 语句吗？提前感谢您的任何帮助。这个网站很棒。

除了基于先前链接的问题新形成的选择语句之外，这是我所拥有的：

```
If dr2.Read Then

        slidelink1.Text = dr2.Item(0)
        slideanchor1.Text = dr2.Item(1)
        slidethumb1.Text = dr2.Item(2)
        slidedate1.Text = dr2.Item(3)
    End If 
```

我一如既往地感谢帮助。不要犹豫，告诉我我是否离这里很远。我假设读者只显示最后一行数据，但我对这些东西很新鲜。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T01:47:16.193

如果您只调用了 4 次 Read 会怎样。

```
If dr2.Read Then
    slidelink1.Text = dr2.Item(0)
    slideanchor1.Text = dr2.Item(1)
    slidethumb1.Text = dr2.Item(2)
    slidedate1.Text = dr2.Item(3)
End If

If dr2.Read Then
    slidelink2.Text = dr2.Item(0)
    slideanchor2.Text = dr2.Item(1)
    slidethumb2.Text = dr2.Item(2)
    slidedate2.Text = dr2.Item(3)
End If

If dr2.Read Then
    slidelink3.Text = dr2.Item(0)
    slideanchor3.Text = dr2.Item(1)
    slidethumb3.Text = dr2.Item(2)
    slidedate3.Text = dr2.Item(3)
End If

If dr2.Read Then
    slidelink4.Text = dr2.Item(0)
    slideanchor4.Text = dr2.Item(1)
    slidethumb4.Text = dr2.Item(2)
    slidedate4.Text = dr2.Item(3)
End If 
```

你也可以循环，但如果你总是知道结果中有 4 个，那么这样做可能会更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T01:52:15.710

尝试从数据绑定的角度考虑这一点：

```
<asp:Repeater runat="server" id="sideLinks">
    <ItemTemplate><tr><td><%# Eval(0)%><td><%#Eval(1)%><td><%#Eval(2)%><td><%#Eval(3)%></tr>
    </ItemTemplate>
</asp:Repeater> 
```

进而：

```
sideLinks.DataSource = dr2 
```

# java - JAXB 注释 - 如何使 XmlIDRef 元素列表具有 id 值作为属性而不是元素正文文本？

> ID：10150263
> 
> 赞同：6
> 
> 时间：2012-04-14T01:29:46.703
> 
> 标签：java, xml-serialization, jaxb

**更新 - 见底部的编辑**

IDRefs/keyrefs 似乎在 JAXB 注释中是可能的，但 ref 最终成为元素文本。

我希望 ref 成为元素的属性。

例如，给定这个对象模型：

```
@XmlType
public class Employee {
    @XmlID
    @XmlAttribute
    String name;
    @XmlAttribute
    int years;
    @XmlAttribute
    String foo;
}

@XmlType
public class Office {
    @XmlAttribute
    String name;
    @XmlElementWrapper
    @XmlElement(name = "employee")
    List<Employee> employees;
}

@XmlRootElement
public class Company {
    @XmlElementWrapper
    @XmlElement(name = "office")
    List<Office> offices;
    @XmlElementWrapper
    @XmlElement(name = "employee")
    List<Employee> employees;
} 
```

我希望外部化的 xml 格式最终看起来像这样：

```
<company>
    <offices>
        <office name="nyc">
            <employees>
                <!--*** id ref to employee name ***-->
                <employee ref="alice"/>
                <employee ref="bob"/>
            </employees>
        </office>
        <office name="sf">
            <employees>
                <employee ref="connie"/>
                <employee ref="daphne"/>
            </employees>
        </office>
    </offices>
    <employees>
        <!-- *** name is the id *** -->
        <employee name="alice" years="3" foo="bar"/>
        <employee name="bob" years="3" foo="bar"/>
        <employee name="connie" years="3" foo="bar"/>
        <employee name="daphne" years="3" foo="bar"/>
    </employees>
</company> 
```

相反，我能做的最好的就是这个（使用上面在 java 代码中列出的注释）：

```
<company>
    <offices>
        <office name="nyc">
            <employees>
                <employee>alice</employee>
                <employee>bob</employee>
            </employees>
        </office>
        <office name="sf">
            <employees>
                <employee>connie</employee>
                <employee>daphne</employee>
            </employees>
        </office>
    </offices>
    <employees>
        <employee name="alice" years="3" foo="bar"/>
        <employee name="bob" years="3" foo="bar"/>
        <employee name="connie" years="3" foo="bar"/>
        <employee name="daphne" years="3" foo="bar"/>
    </employees>
</company> 
```

有没有办法可以强制 idref 值成为员工的属性，而不是元素正文？我知道我可以使用 XML 模式来做到这一点，但如果可能的话，我想坚持使用注释。

谢谢你。

**编辑** 下面 Torious 的解决方案几乎可以工作，但在某些情况下它并不完全有效。

如果“offices”元素出现在（在 xml 文件中）office 引用的“employee”元素之前，则解组失败。找不到员工引用，并且 EmployeeRef 包装器有一个空的员工对象。如果“员工”是第一位的，它就会起作用。

这不是什么大问题，但是编组方法会将“办公室”放在首位，因此试图解组刚刚编组的内容会失败。

**在 Torious 的回答中**编辑 2条评论解决了排序问题。****

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T02:44:44.077

解决方案是使用将 an`XmlAdapter`包装`Employee`在新类型实例中的 an `EmployeeRef`，它指定如何映射 XML id ref：

```
@XmlType
public class Office {

    @XmlAttribute
    String name;

    @XmlElementWrapper
    @XmlElement(name="employee")
    @XmlJavaTypeAdapter(EmployeeAdapter.class) // (un)wraps Employee
    List<Employee> employees;
}

@XmlType
public class EmployeeRef {

    @XmlIDREF
    @XmlAttribute(name="ref")
    Employee employee;

    public EmployeeRef() {
    }

    public EmployeeRef(Employee employee) {
        this.employee = employee;
    }
}

public class EmployeeAdapter extends XmlAdapter<EmployeeRef, Employee> {

    @Override
    public EmployeeRef marshal(Employee employee) throws Exception {
        return new EmployeeRef(employee);
    }

    @Override
    public Employee unmarshal(EmployeeRef ref) throws Exception {
        return ref.employee;
    }
} 
```

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-17T09:42:14.023

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

下面是一个示例，说明如何通过利用`@XmlPath`注释使用 MOXy 完成此操作。由于一个[错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=379754)，从 2012 年 5 月 17 日开始，您将需要使用 EclipseLink 2.4.0 夜间标签。此修复程序也已添加到 EclipseLink 2.3.3（从 2012 年 5 月 18 日开始）流中。您可以从以下位置下载夜间标签：

*   [http://www.eclipse.org/eclipselink/downloads/nightly.php](http://www.eclipse.org/eclipselink/downloads/nightly.php)

**办公室**

在`employees`属性上，您可以将`@XmlIDREF`注释与注释结合使用`@XmlPath`以获得所需的映射。 `@XmlIDREF`告诉 JAXB 实现写出外键而不是对象。

```
package forum10150263;

import java.util.List;
import javax.xml.bind.annotation.*;
import org.eclipse.persistence.oxm.annotations.XmlPath;

@XmlType
public class Office {
    @XmlAttribute
    String name;

    @XmlPath("employees/employee/@ref")
    @XmlIDREF
    List<Employee> employees;
} 
```

**员工**

的对应物`@XmlIDREF`是`@XmlID`。 `@XmlID`用于指定对象的主键。

```
package forum10150263;

import javax.xml.bind.annotation.*;

@XmlType
public class Employee {
    @XmlID
    @XmlAttribute
    String name;

    @XmlAttribute
    int years;

    @XmlAttribute
    String foo;
} 
```

**公司**

通过该机制引用的每个对象`@XmlIDREF`也需要被包含关系引用。在此示例中，这是由`employees`属性完成的。

```
package forum10150263;

import java.util.List;
import javax.xml.bind.annotation.*;

@XmlRootElement
public class Company {
    @XmlElementWrapper
    @XmlElement(name = "office")
    List<Office> offices;

    @XmlElementWrapper
    @XmlElement(name = "employee")
    List<Employee> employees;
} 
```

**jaxb.properties**

要将 MOXy 指定为您的 JAXB 提供者，您需要`jaxb.properties`使用以下条目添加与域模型在同一包中命名的文件（请参阅将[EclipseLink MOXy 指定为您的 JAXB 提供者](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)）

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**演示**

标准 JAXB API 用于解组/编组 XML。

```
package forum10150263;

import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Company.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum10150263/input.xml");
        Company company = (Company) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(company, System.out);
    }

} 
```

**输入.xml/输出**

```
<?xml version="1.0" encoding="UTF-8"?>
<company>
   <offices>
      <office name="nyc">
         <employees>
            <employee ref="alice"/>
            <employee ref="bob"/>
         </employees>
      </office>
      <office name="sf">
         <employees>
            <employee ref="connie"/>
            <employee ref="daphne"/>
         </employees>
      </office>
   </offices>
   <employees>
      <employee name="alice" years="3" foo="bar"/>
      <employee name="bob" years="3" foo="bar"/>
      <employee name="connie" years="3" foo="bar"/>
      <employee name="daphne" years="3" foo="bar"/>
   </employees>
</company> 
```

**了解更多信息**

*   [将 EclipseLink MOXy 指定为您的 JAXB 提供程序](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)
*   [JAXB 和共享引用：@XmlID 和 @XmlIDREF](http://blog.bdoughan.com/2010/10/jaxb-and-shared-references-xmlid-and.html)
*   [基于 XPath 的映射](http://blog.bdoughan.com/2010/07/xpath-based-mapping.html)**

# php - PHP MySQLi 查找未关闭的准备好的语句

> ID：10150266
> 
> 赞同：0
> 
> 时间：2012-04-14T01:30:00.973
> 
> 标签：php, mysqli, prepared-statement

mySQLi bind_param 方法抛出错误“命令不同步”。我猜这是来自尚未正确关闭的perpared statment。有什么方法可以通过连接查看未关闭的准备好的语句，还是我应该开始挖掘？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T01:31:27.573

看看这个：

> C.5.2.14。命令不同步如果你得到**命令不同步**；您现在无法在客户端代码中运行此命令，您正在以错误的顺序调用客户端函数。
> 
> **例如，**如果您正在使用 mysql_use_result() 并在调用 mysql_free_result() 之前尝试执行新查询，则可能会发生这种情况。如果您尝试执行两个返回数据的查询而不在两者之间调用 mysql_use_result() 或 mysql_store_result() ，也会发生这种情况。

参考：[http ://dev.mysql.com/doc/refman/5.0/en/commands-out-of-sync.html](http://dev.mysql.com/doc/refman/5.0/en/commands-out-of-sync.html)

# android - 使用广播接收器捕捉来电，onReceive 未触发？

> ID：10150267
> 
> 赞同：4
> 
> 时间：2012-04-14T01:30:03.563
> 
> 标签：android, broadcastreceiver

我想实现一个简单的广播接收器，当有来电时它会被触发。但是，似乎永远不会触发 onReceive（我非常仔细地检查了 LogCat，那里没有输出），出了什么问题？我的课：

```
public class MyPhoneReceiver extends BroadcastReceiver {
    private static final String TAG = "DEBUG";

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.e(TAG, "Test loggiiiiiiiiiiiiiiiiiiiiiiiiing!");

    }

} 
```

我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="tung.le.android.receiver.phone"
    android:versionCode="1"
    android:versionName="1.0" >

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
         <receiver android:name=".MyPhoneReceiver" >
            <intent-filter>
                <action android:name="android.intent.action.PHONE_STATE" >
                </action>

            </intent-filter>
        </receiver>

    </application>
    <uses-sdk android:minSdkVersion="15" />
    <uses-permission android:name="android.permission.READ_PHONE_STATE" >
    </uses-permission>

</manifest> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T10:28:14.170

您可能需要将**android:enabled="true"**添加到清单中的标签，或者您必须在某处注册它（例如自定义“YourApplication”类）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-23T11:37:21.310

我在使用此 BroadcastReceiver 解决方案时遇到的问题是，它无法触发活动通话期间发生的任何通话。当我与一个人在电话上交谈并且有人在另一条线上给我打电话时（我接受了第二个电话），实际上没有任何状态发生变化。电话之前是摘机的，当我接听第二个电话时它仍然处于摘机状态。

到目前为止，我发现的唯一解决方案是为 android.provider.Calls 注册一个观察者，然后在每次数据更改后从中获取最新条目。如果有人知道更好的解决方案，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T11:08:18.347

您是否在代码中注册您的接收器？？如果没有，您将不得不在 manifest.xml 中注册您的接收器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-16T20:22:50.550

您的项目中至少应该有一项活动。即使您在应用程序启动后立即完成它。它不需要做任何事情，但它应该在安装后至少启动一次。

# android - html，授权。获取 cookie

> ID：10150268
> 
> 赞同：0
> 
> 时间：2012-04-14T01:30:47.653
> 
> 标签：android, html, json, authentication, json-rpc

我不太确定它是如何工作的，但我需要做的是使用 JSON-RPC 进行身份验证，然后请求一个页面。我有这段代码来确定用户名和密码是否正确，但我不知道如何使用这些信息来请求页面..

```
 List<Cookie> cook;
    public void postData(String method, Object ... params) throws JSONException {
        // Create a new HttpClient and Post Header
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://www.examp;e.com/json-rpc/");

        try {
            // Add your data

            String methodandp = "{id:3, method:" + method + ", params:[" + params[0].toString()+ ", " + params[1].toString() + "]}";

            StringEntity a = new StringEntity(methodandp);
            httppost.setEntity(a);
            Log.i("ClientActivity: request", httppost.getMethod().toString());
            Log.i("ClientActivity: request", nameValuePairs.toString());

            // Execute HTTP Post Request
            HttpResponse response = httpclient.execute(httppost);

            Header[] head = response.getAllHeaders();

            Log.i("ClientActivity", response.getStatusLine().toString());
            String responseString = EntityUtils.toString(response.getEntity());
            responseString = responseString.trim();
            JSONObject jsonResponse = new JSONObject(responseString);
            Log.i("ClientActivity", jsonResponse.toString());
            String cookie = "";

            for(int i = 0; i < head.length; i++){
                Log.i("ClientActivity: response", head[i].toString());
                if(head[i].toString().contains("Set-Cookie")){
                    cookie = (head[i].toString()).replace("Set-Cookie: ", "");
                    cook = ((AbstractHttpClient) httpclient).getCookieStore().getCookies();
                    if (cook.isEmpty()) {
                        System.out.println("None");
                    } else {
                        for (int x = 0; x < cook.size(); x++) {
                            Log.i("ClientActivity", "-" + cook.get(x).toString());
                        }
                    }
                    Log.i("ClientActivity: Cookie", cookie);
                }
            }
        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
        } catch (IOException e) {
            // TODO Auto-generated catch block
        }
    } 
```

它返回成功并带有所有正确的数据，但我不知道如何使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T08:55:02.207

这实际上非常简单，现在我查看它，一旦我确认我已通过身份验证，我可以使用相同的 HttpClient（保存 cookie）来请求其他文件并使用 MultipartEntity 将文件推送到 Web 服务器

# android - 在java中将android mac地址十六进制字符串转换为字节[]

> ID：10150275
> 
> 赞同：1
> 
> 时间：2012-04-14T01:33:12.410
> 
> 标签：android, mac-address

```
 WifiManager wm = (WifiManager)ctx.getSystemService(Context.WIFI_SERVICE);
 String macAddress = wm.getConnectionInfo().getMacAddress(); 
```

它是一个十六进制格式的字符串，例如：

```
"00:23:76:B7:2B:4D" 
```

我想将此字符串转换为字节数组，以便可以`MessageDigest`在其上使用 sha1

我通过使用 excaping`\x`而不是`:`使用`hashlib`模块在 Python 中工作。

但我会在 android/java 中做吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T10:07:15.563

这段代码：

```
Byte.parseByte(mac[i], 16); 
```

无法正确解析以字母开头的十六进制数字：“AE”、“EF”等...
修改后的代码：

```
WifiManager wm = (WifiManager) ctx.getSystemService(Context.WIFI_SERVICE);
if (wm != null) {
    String[] mac = wm.getConnectionInfo().getMacAddress().split(":");
    byte[] macAddress = new byte[6];        // mac.length == 6 bytes
    for(int i = 0; i < mac.length; i++) {
        macAddress[i] = Integer.decode("0x" + mac[i]).byteValue();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-28T10:31:59.350

通过这个你得到字节数组中的mac地址，所以你不需要转换它。

```
import java.net.InetAddress;
import java.net.NetworkInterface;
import java.net.SocketException;
import java.net.UnknownHostException;

public class App{

   public static void main(String[] args){

    InetAddress ip;
    try {

        ip = InetAddress.getLocalHost();
        System.out.println("Current IP address : " + ip.getHostAddress());

        NetworkInterface network = NetworkInterface.getByInetAddress(ip);

        byte[] mac = network.getHardwareAddress();

        System.out.print("Current MAC address : ");

        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < mac.length; i++) {
            sb.append(String.format("%02X%s", mac[i], (i < mac.length - 1) ? "-" : ""));        
        }
        System.out.println(sb.toString());

    } catch (UnknownHostException e) {

        e.printStackTrace();

    } catch (SocketException e){

        e.printStackTrace();

    }

   }

} 
```

/*从这里复制：从[http://www.mkyong.com/java/how-to-get-mac-address-in-java/comment-page-1/#comment-139182](http://www.mkyong.com/java/how-to-get-mac-address-in-java/comment-page-1/#comment-139182)*复制/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T01:36:22.907

```
WifiManager wm = (WifiManager)ctx.getSystemService(Context.WIFI_SERVICE);
byte[] macAddress = wm.getConnectionInfo().getMacAddress().getBytes(); 
```

修改后的解决方案：

```
WifiManager wm = (WifiManager)ctx.getSystemService(Context.WIFI_SERVICE);
String[] mac = wm.getConnectionInfo().getMacAddress().split(":");
byte[] macAddress = new byte[6];
for(int i = 0; i < mac.length; i++) {            
    macAddress[i] = Byte.parseByte(mac[i], 16);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-25T22:49:43.010

在 android API 级别 28 中，有一种更简单的方法：[https](https://developer.android.com/reference/android/net/MacAddress) ://developer.android.com/reference/android/net/MacAddress 。

```
android.net.MacAddress.fromString(s).toByteArray(); 
```

# twitter-bootstrap - 覆盖引导标头边框底部

> ID：10150277
> 
> 赞同：2
> 
> 时间：2012-04-14T01:34:21.770
> 
> 标签：twitter-bootstrap

我正在使用 Bootstrap 标头，并且我不希望它有边框底部。我似乎无法将其设置为“无”（或白色，这是我的背景）。

更改颜色和大小没有问题，如下所示：

```
.navbar {
    border-bottom:4px solid green !important;
} 
```

但是，当我制作它`0px`or`white`或`none`or`transparent`时，它会恢复为灰色的底部边框。我如何摆脱边界？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T05:50:53.653

你在下面看到的灰色部分是一个 CSS 阴影，你可以像这样覆盖它：

**CSS**

```
.navbar-inner {
   box-shadow: none;
} 
```

# matlab - 在 Matlab 中如何使用 GPU 的共享内存？

> ID：10150281
> 
> 赞同：2
> 
> 时间：2012-04-14T01:35:05.123
> 
> 标签：matlab, parallel-processing, gpu

有人可以大致告诉 Matlab 并行计算工具箱如何使用 GPU 的共享内存。例如，我可以明确地使用它来同步 MP 单元吗？

顺便提一句。我有一个 GTX 580，它有 1.5GB 内存，每个 MultiProcessor 32 个内核（每个 MP 16 个内核）和 64Kb 共享 (L1) 内存。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:16:36.073

我不知道 Matlab 的答案，但如果你愿意使用 Python，那么[PyCUDA](http://mathema.tician.de/software/pycuda)是你的朋友。您可以直接在 CUDA-C 中开发内核代码，并在 Python 中以长字符串形式编写出来。然后 PyCUDA 允许您编译这些，设置设备变量，向设备发送数据和从设备发送数据，然后使用启动配置执行内核以控制线程/块等。要使用共享成员，您只需使用`shared`关键字 in声明变量您的 CUDA-C 代码作为 Python 字符串。

我写了一些用于图像处理[的代码，链接在这里](http://people.seas.harvard.edu/~ely/faceparts/software.html)。您可以将其解压缩并查看我将 CUDA-C 源模块编写为 Python 字符串的方式。使用 NumPy 和 SciPy，Python 的其余用户体验与 Matlab 非常相似——只是更好。如果您不喜欢在 Matlab 中执行此项目，请考虑将其切换到 PyCUDA。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T13:28:26.923

梅斯，

我想加入 GPU 的 M 代码 - 我发现 Jacket 是访问 GPU 的有用替代方案。Jacket 默认使用共享内存来完成工作，如果您想自己控制事情，它有一个 SDK。

GTX 580 是一张很棒的显卡，但如果你有钱的话，我个人会推荐一些 Tesla GPU，因为它们的长期可靠性（特别是对于长期运行的科学应用程序）。

# php - 将数组输入到 PHP 表中

> ID：10150284
> 
> 赞同：1
> 
> 时间：2012-04-14T01:37:02.437
> 
> 标签：php, mysql, arrays, insert

我从 rss 提要中提取数据，我想将标题和描述添加到 mysql 数据库的同一行（不同字段）中

```
$result = $xml->xpath('//title');  //finding the title tags in the xml document and loading into variable
$result1 = $xml->xpath('//description');  //finding the title tags in the xml document and loading into variable 
```

我正在将信息加载到变量中，但不明白如何将其插入到名为 data 的 mysql 表中？

这听起来很容易，但我正在为它的数组而苦苦挣扎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T01:40:53.653

**尝试以下方式：（**更新）

```
<?php
    $con = mysql_connect("localhost","yourdbusername","yourdbpassword");
    if (!$con)
    {
        die('Could not connect: ' . mysql_error());
    }

    mysql_select_db("yourdbname", $con);

    $query = sprintf("INSERT INTO `data` (`title`, `description`) VALUES ('%s','%s');",
                         mysql_real_escape_string($result),
                         mysql_real_escape_string($result1));

    mysql_query($query);

    mysql_close($con);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T02:15:06.353

您将需要更改节点名称，但这应该这样做 -

```
<?php
$db = new PDO('mysql:dbname=test;host=127.0.0.1', 'user', 'pass');

$sql = "INSERT INTO tbl (title, description) VALUES (?, ?)";
$stmt = $db->prepare($sql);

$rss = simplexml_load_file('path_to_rss_feed');

foreach ($rss->articles as $article) {
    $stmt->execute(array($article->title, $article->description));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T01:44:36.837

假设您的表设置有名为“标题”和“描述”的列，您是否尝试过这样的事情？

```
$rows=array();

foreach($result as $title){
  $rows[]="('".mysql_real_escape_string($title)."','".mysql_real_escape_string(array_shift($result1))."')");
}
mysql_query("INSERT INTO data (title, description) VALUES ".implode(',',$rows); 
```

编辑：足够公平；）添加了 mysql_real_escape_string

# database - 如何在 playframework 2.0 中配置 FS 数据库？

> ID：10150287
> 
> 赞同：2
> 
> 时间：2012-04-14T01:37:41.050
> 
> 标签：database, playframework-2.0, filesystems, h2

有可能吗？在框架的第一个版本中似乎很容易完成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T07:30:11.350

而不是使用

```
# Default database configuration
db.default.driver=org.h2.Driver
db.default.url="jdbc:h2:mem:play" 
```

你应该可以使用

```
# FS database configuration
db.default.driver=org.h2.Driver
db.default.url="jdbc:h2:playdb" 
```

这将在当前工作目录中创建文件。有关更多信息，请参阅[H2 备忘单](http://www.h2database.com/html/cheatSheet.html)

# c# - 无法使用数据库的不同记录进行搜索

> ID：10150289
> 
> 赞同：1
> 
> 时间：2012-04-14T01:37:53.737
> 
> 标签：c#, asp.net, asp.net-mvc-3, asp.net-mvc-3-areas

我是新来的，已经在这里工作了很长时间，我无法解决问题。我的 ShowAllReview 控制器中有以下代码：

```
 public ActionResult Index(string Ordering, string WordFilter, string DisplaySearchResults, int? CounterForPage)
        {
            using (var db = new gamezoneDBEntities())
            {

                ViewBag.Message = TempData["message"];
                ViewBag.CurrentSort = Ordering;
                ViewBag.NameSortParm = String.IsNullOrEmpty(Ordering) ? "GameName" : "";
                ViewBag.DateSortParm = Ordering == "ReleaseYearOfGame" ? "DiscriptionOfGame" : "Date";

                {
                    TempData["DisplaySearchResult"] = DisplaySearchResults;

                    {
                        ViewBag.search = DisplaySearchResults;
                    }
                    if (Request.HttpMethod == "GET")
                    {
                        DisplaySearchResults = WordFilter;
                    }
                    else if (DisplaySearchResults == "")
                    {
                        ViewData["MyMessage"] = "Nothing Has Been Entered.";

                    }

                    else
                    {
                        CounterForPage = 1;
                    }

                    ViewBag.CurrentFilter = DisplaySearchResults;

                    var FullDatabaseItem = from b in db.tblReviews.Include(x => x.tblGame)
                                           select b;

                    if (!String.IsNullOrEmpty(DisplaySearchResults))
                    {

                        FullDatabaseItem = FullDatabaseItem.Include (x => x.tblGame)
                       .Where (b => b.Score.ToUpper().Contains(DisplaySearchResults.ToUpper()));

                    }

                    switch (Ordering)
                    {
                        case "HeadlineName":
                            FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.Score);
                            break;
                        case "DatePosted":
                            FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.Recomendation);
                            break;
                        case "DiscriptionDate":
                            FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.Recomendation);
                            break;
                        default:
                            FullDatabaseItem = FullDatabaseItem.OrderByDescending(b => b.Recomendation);
                            break;
                    }

                    int pageSize = 3;
                    int pageNumber = (CounterForPage ?? 1);
                    var PageNumberResults = FullDatabaseItem.ToPagedList(pageNumber, pageSize);
                    ViewBag.PageNumberResults = FullDatabaseItem.Count();
                    if (PageNumberResults.Any())
                    {

                        return View(PageNumberResults);
                    }

                    return View("ErrorView");
                }
            }
        } 
```

如您所见，我添加了以下代码：

```
var FullDatabaseItem = from b in db.tblReviews.Include(x => x.tblGame)select b; 
```

如果没有评论表中的包含，视图将引发以下错误：

```
The ObjectContext instance has been disposed and can no longer be used for operations that require a connection. 
```

现在问题出在这行代码上：

```
FullDatabaseItem = FullDatabaseItem.Include (x => x.tblGame)
                        .Where (b => b.Score.ToUpper().Contains(DisplaySearchResults.ToUpper())); 
```

我正在尝试获取游戏名称，因此当用户使用我的搜索时，他只需输入游戏名称即可获得唱片购买。但是正如您所看到的，正在搜索的字段`"Score"`是 tblReview 字段，因为我需要的字段`"GameName"`不会在那里工作，因为它说它不存在。

我需要帮助来解决问题

您需要任何更多信息，请询问我，我会提供

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:40:03.613

您的实体模型具有从 tblReview 到 tblGame 的导航属性，对吗？所以你有一个看起来像这样的实体？

```
public class tblReview
{
    public virtual tblGame tblGame { get; set; }
    // other properties
} 
```

这种关系是双向的还是单向的？意思是，您的 tblGame 类是否具有这样的 tblReviews 集合属性？

```
public class tblGame
{
    public virtual ICollection<tblReview> tblReviews { get; set; }
    // other properties
} 
```

如果是这样，那么您有一个双向关联，您可以从另一个实体中的字段中搜索一个实体中的字段。

例如，您想显示具有特定名称的游戏的评论列表。你可以这样做：

```
string gameName = "Pac-Man";
using (var db = new gamezoneDBEntities())
{
    // get reviews for game named pac-man
    var reviews = db.tblReviews.Include(r => r.tblGame)
        .Where(r => r.tblGame.GameName.Equals(gameName, 
            StringComparison.OrdinalIgnoreCase));

    // get game with reviews scored greater than 4
    var games = db.tblGames.Include(g => g.tblReviews)
        .Where(g => g.tblReviews.Any(r => r.Score > 4));
} 
```

所以最终，我认为这就是你所追求的：

```
var FullDatabaseItem = db.tblReviews.Include(g => g.tblGame);
if (!string.IsNullOrEmpty(DisplaySearchResults))
{
    FullDatabaseItem = FullDatabaseItem
        .Where(review => review.tblGame.GameName.Contains(DisplaySearchResults));
} 
```

我不认为您需要将字符串转换为大写以便在使用时进行不区分大小写的匹配`.Contains()`。搜索“pAC-man”仍应返回名为“Pac-Man”的游戏。

# c# - LinkedList 中的相同行

> ID：10150290
> 
> 赞同：-2
> 
> 时间：2012-04-14T01:37:59.413
> 
> 标签：c#, .net, random, linked-list

> **可能重复：**
> [随机数生成器未按我计划的方式工作（C#）](https://stackoverflow.com/questions/767999/random-number-generator-not-working-the-way-i-had-planned-c)

我有LinkedList的LinkedList，当我在填充后尝试显示时，原始数据是相同的，但最奇怪的是在调试模式下它会显示不同的行。顺便说一句，我有 VS11 测试版。

```
 private LinkedList<LinkedList<int>> grid = new LinkedList<LinkedList<int>>();

    public void CreateMatrix(int rows, int coloumns, int maxSize)
    {
        for(int i = 0; i < rows;i++)
        {
            grid.AddFirst(generateList(coloumns, maxSize));
        }
    }

    private LinkedList<int> generateList(int size, int maxSize)
    {
        var ranodGenerator = new Random();
        var list = new LinkedList<int>();
        for (int j = 0; j < size; j++)
        {
            list.AddFirst(ranodGenerator.Next(maxSize));
        }
        return list;
    }

    public void DisplayMatrix()
    {
        foreach (var list in grid)
        {
            foreach (var i in list)
            {
                Console.Write(i+ " ");
            }
            Console.WriteLine();
        }
    } 
```

所以之后

```
MatrixManager matrixManager = new MatrixManager();
            matrixManager.CreateMatrix(4,4,200);
            matrixManager.DisplayMatrix(); 
```

它将显示 4 个相同的行

```
134 3 45 26
134 3 45 26
134 3 45 26
134 3 45 26 
```

但应该显示不同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T01:55:23.213

移动“随机ranodGenerator = new Random();” 到文件的顶部，并为整个矩阵使用相同的。

您正在为每一行创建一个新的**Random对象。**创建一个新的**Random**对象会从头开始生成随机数。

编程中的随机数实际上并不是随机的。它们是由一个数学公式生成的，该公式一遍又一遍地应用于前一次迭代的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T01:47:38.643

这应该是“如何使用随机”的副本

```
var ranodGenerator = new Random(); 
```

此行重新开始创建随机数。创建一个随机数生成器，生活会好很多。

这是常见问题解答：[随机数生成器仅生成一个随机数](https://stackoverflow.com/questions/767999/random-number-generator-not-working-the-way-i-had-planned-c)

# c++ - 如何使用 Marching Squares 生成位图的多边形网格？

> ID：10150292
> 
> 赞同：2
> 
> 时间：2012-04-14T01:38:44.717
> 
> 标签：c++, mesh, terrain

我需要能够准确地检测与任何位图地形的碰撞并做出反应，最好的方法似乎是使用 Marching Squares 生成多边形网格，然后我可以将其与 Bullet 等物理引擎一起使用，这将是比我自己写的任何东西都要好。

问题是，虽然我看到很多人提到使用行进广场来做到这一点，但我找不到任何解释如何！我什至无法找到任何关于 Marching Squares 算法本身的特别好的解释/教程，尽管我认为我从我发现的内容中非常了解它。我想不通的是如何从 MS 给我的线条中创建多边形。

我找到了这个，这几乎正是我想要做的，但我要么需要为 C++ 找到一个类似的物理库，要么自己编写网格生成。

[http://deltaluca.me.uk/docnew/swf/DestructableTerrain.html](http://deltaluca.me.uk/docnew/swf/DestructableTerrain.html)

我不想简单地查看物理引擎的源代码以了解它是如何工作的，因此希望某个地方知道一个可以更好地解释该过程的地方！C++ 中的任何东西都是首选，但如果过程解释得当，其他语言应该没问题。

# performance - 优化代码以提高效率

> ID：10150293
> 
> 赞同：3
> 
> 时间：2012-04-14T01:38:51.613
> 
> 标签：performance, algorithm, matlab, processing-efficiency

我创建了代码来执行基于欧几里得距离从一个向量到另一个向量的点映射，并检查它是否工作正常。

但是，这需要太多时间。本质上，我已经为 A 和 B 向量的欧几里德距离创建了一个矩阵，并找到了它的最小值。在我表示这些点的映射后，我通过将它们标记为 NaN 来从欧几里得矩阵中删除行和列，以便下一次映射发生。

这段代码能否更高效，因为它现在非常慢......

```
Euclid = distance(A,B); % calculates euclid distance column v/s column wise. 
for var = 1 : value
    %# finds the min of Euclid and its position, when Euclid is viewed as a 1D array
    [~, position] = min(Euclid(:)); 

    %#transform the index in the 1D view to 2 indices
    [i,j] = ind2sub(size(Euclid),position);

    %display(strcat(num2str(i),32, num2str(j)));

    mapping = [A(1,i) A(2,i) B(1,j) B(2,j)];
    fprintf(FID,'%d %d %d %d\n', mapping );

    Euclid( i , : ) = NaN;
    Euclid( : , j ) = NaN;
    %counter = counter + 1;
end 
```

问题是对于 5000 X 5000 矩阵，代码只是挂了很长时间......

有人能帮帮我吗...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T02:39:10.207

我想尝试将距离数组重塑为一维数组，在其中仔细记录新的一维索引如何映射回二维索引。然后只需调用一维数组上的排序函数，将其排序为升序。确保保存导致排序的索引的排列，然后读取与排序排列中的一维坐标相对应的二维数组坐标。在这种方法中，您将受制于 Matlab 的排序算法，并且您需要仔细跟踪索引因整形而发生的变化。

这也带来了从考虑中去除点的问题。您必须为已选择的点保留一个正在运行的索引列表，并且如果（当您遍历 1-D 排列时）遇到与已选择的索引相对应的内容，那么您只需跳过它（例如，您不'不要将它设置为 NaN，你只是从考虑中跳过它）。

这使您无需每次都计算最小值。在遍历一维排序排列的 for 循环的每次迭代中，唯一真正的检查是逻辑检查当前位置是否之前已被选择（由于其中一个点涉及较小距离的位置）。在迭代`i`时，此检查最多`i-1`进行比较，因此这将略小于 O(n^2)。

这将比您当前的方法更快，后者每次都计算整个数组的最小值，但仍然不如下面链接中提到的 O(n log n) 方法快。

更一般地说，您想阅读[此问题的答案中](https://stackoverflow.com/questions/3700983/what-is-the-fastest-algorithm-to-calculate-the-minimum-distance-between-two-sets)链接的论文。这不是一个微不足道的问题，不太适合 RAM 密集型的 Matlab 会话，并且可能需要您重写整个方法。

另一个想法是，如果您将所有数组广播`A`到一堆处理器，那么这在数组中的点上是令人尴尬的并行`B`。您可以将零件运送`B`到不同的处理器，并返回所有距离的列表。您必须在头节点上进行一些处理以选择最小距离的索引并删除这些点，但不要太多。可能无论如何您都可以重新编写该部分，这样您就不需要多次计算距离。

因此，如果您使用 Python 或 C++ 编写此代码，您可以快速使用 MPI 库，然后在 Amazon Web Services 的云集群上运行它，或者如果您有权访问，则在本地集群上运行它。

# php - 无法在 centOS 中使自定义会话保存处理程序工作（未调用注册方法）

> ID：10150296
> 
> 赞同：1
> 
> 时间：2012-04-14T01:40:13.903
> 
> 标签：php, mysql, session

我遇到了一个奇怪的问题。linux中的会话保存处理程序无法正常工作（相同的代码在我本地的windows平台上可以正常工作。）。这是我的会话保存处理程序代码：

```
<?php
class session
{
  public static function init()
  {
    session_set_save_handler('session::open', 'session::close', 'session::read', 'session::write', 'session::destroy', 'session::gc');
  }

  public static function open($save_path, $session_name)
  {
     if (!is_dir($save_path)) {
            mkdir($save_path, 0777);
     }
    return true;
  }

  public static function close()
  {
    return true;
  }

  public static function read($sid)
  {
    global $db, $user;
    register_shutdown_function('session_write_close');
    if (!isset($_COOKIE[session_name()])) {
      $user = anonymousUser($sid);
      return '';
    }
    $result = $db->query('SELECT s.data as session_data, s.* , u.* FROM users u INNER JOIN sessions s ON u.uid = s.uid WHERE s.sid = "' . $db->escape($sid) .
      '" AND timestamp >= ' . $db->escape(TIMESTAMP - Bl_Config::get('session.lifetime', 10800)));
    $user = $result->row();

    if ($user) {
      $data = $user->session_data;
      unset($user->passwd, $user->session_data);
      if ($user->uid > 0 && $user->status == 1) {
        $userInstance = User_Model::getInstance();
        $user->roles = $userInstance->getUserRoles($user->uid);
        $user->roles[] = User_Model::ROLE_AUTHENTICATED_USER;
        $user->permissions = array();
        $user->data = (isset($user->data) && $user->data) ? unserialize($user->data) : array();
        foreach ($user->roles as $rid) {
          $user->permissions = array_merge($user->permissions, $userInstance->getRolePermissions($rid));
        }
        $user->permissions = array_unique($user->permissions);
      } else {
        $user = anonymousUser($sid);
      }
      return $data;
    } else {
      $user = anonymousUser($sid);
      return '';
    }
  }

  public static function write($sid, $data)
  {
    global $db, $user;
    if (!isset($user) || ($user->uid == 0 && empty($_COOKIE[session_name()]) && empty($data))) {
      return true;
    }
    $uri = '/' . Bl_Core::getUri();
    $db->exec('UPDATE sessions SET uid = ' . $db->escape($user->uid) . ', ip = "' . $db->escape(ipAddress()) .
      '", uri = "' . $db->escape($uri) . '", data = "' . $db->escape($data) . '", timestamp = ' .
      $db->escape(TIMESTAMP) . ' WHERE sid = "' . $db->escape($sid) . '"');
    if (!$db->affected()) {
      $db->exec('INSERT IGNORE INTO sessions (sid, uid, ip, uri, data, timestamp) VALUES ("' . $db->escape($sid) .
        '", ' . $db->escape($user->uid) . ', "' . $db->escape(ipAddress()) . '", "' . $db->escape($uri) . '", "' .
        $db->escape($data) . '", ' . $db->escape(TIMESTAMP) . ')');
    }
    return true;
  }

  public static function destroy($sid)
  {
    global $db;
    $db->exec('DELETE FROM sessions WHERE sid = "' . $db->escape($sid) . '"');
    return true;
  }

  public static function gc($lifetime)
  {
    global $db;
    $db->exec('DELETE FROM sessions WHERE timestamp < ' . $db->escape(TIMESTAMP - Bl_Config::get('session.lifetime', 10800)));
    return true;
  }

  public static function count($timestamp = 0, $hasAnonymous = true)
  {
    global $db;
    if (!$hasAnonymous) {
      $cond = ' AND uid > 0';
    } else {
      $cond = '';
    }
    $result = $db->query('SELECT COUNT(0) FROM sessions WHERE timestamp > ' . $timestamp . $cond);
    return $result->one();
  }
} 
```

这是我调用会话保存处理程序的方式：

```
session::init();
session_start(); 
```

但是在静态类会话中没有调用任何方法。似乎应用程序在 session_start() 调用后停止继续运行。

我使用的php版本是`PHP Version 5.1.6`.我不知道是与php.ini有关还是db的某些权限导致了这样的问题？我正在使用 root db 用户并且已经设置了连接......

这是会话的 php.ini 设置（根据 Mike Purcell 的建议，我已将 session.save_path 从“/var/lib/php/session”更改为“/tmp”）：

```
session.save_handler = files
session.save_path = "/tmp"
session.use_cookies = 1
session.name = PHPSESSID
session.auto_start = 0
session.cookie_lifetime = 0
session.cookie_path = /
session.cookie_domain =
session.serialize_handler = php
session.gc_probability = 1
session.gc_divisor     = 1000
session.gc_maxlifetime = 1440
session.bug_compat_42 = 0
session.bug_compat_warn = 1
session.referer_check =
session.entropy_length = 0
session.entropy_file =
session.cache_limiter = nocache
session.cache_expire = 180
session.use_trans_sid = 0
session.hash_function = 0
session.hash_bits_per_character = 5 
```

错误信息是： `Fatal error: session_start() [<a href='function.session-start'>function.session-start</a>]: Failed to initialize storage module: user (path: /tmp)`

请帮忙，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T05:49:51.997

最后经过无休止的调试和环境更改，我得到了解决方案！！！

我发现这是php版本的问题。CentOS VPS 默认使用`Cent OS 5.5`and `PHP 5.1.6`，但它在支持自定义会话保存处理程序方面存在问题。奇怪的是没有人也没有医生提到这一点！！！我的建议是使用 PHP 5.2.6 或更高版本来使用此类功能。

# javascript - 模型没有属性 _committed

> ID：10150301
> 
> 赞同：2
> 
> 时间：2012-04-14T01:40:59.103
> 
> 标签：javascript, jquery, python, django

我正在使用 jquery 表单插件[http://jquery.malsup.com/form/#getting-started](http://jquery.malsup.com/form/#getting-started)通过 ajax 上传图片。当我尝试上传时，它显示模型没有属性 _committed 这是我的 Html：

```
<form id="uploadform" method="post" enctype="multipart/form-data" action="/cover/">{% csrf_token %}
        {{ form.background }}
</form> 
```

Javascript：

[https://gist.github.com/2381406](https://gist.github.com/2381406)

模型.py：

```
class BackgroundModel(models.Model):
    user = models.OneToOneField(User)
    background = models.ImageField(upload_to='backgrounds')

class BackgroundModelForm(ModelForm):
    class Meta:
        model = BackgroundModel
        exclude = ('user',) 
```

视图.py：

```
@login_required
def backgroundview(request):
    if request.is_ajax():
        form = BackgroundModelForm(request.POST, request.FILES)
        if form.is_valid():
            try:
                g = BackgroundModel.objects.get(user=request.user)
            except BackgroundModel.DoesNotExist:
                data = form.save(commit=False)
                data.user = request.user
                data.save()
            else:
                g.background = form
                g.save()
            HttpResponse(" ")
    else:
        form = BackgroundModelForm()
    return render_to_response("cover.html", {'form': form}, context_instance=RequestContext(request)) 
```

网址.py：

```
url(r'^cover/$', 'cover.views.backgroundview'), 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T02:19:33.997

而不是`g.background = form`在 else 分支中，尝试

```
try:
    g = BackgroundModel.objects.get(user=request.user)
except BackgroundModel.DoesNotExist:
    data = form.save(commit=False)
    data.user = request.user
    data.save()
else:
    g.background = form.save(commit=False).background
    g.save()
    # or
    BackgroundModelForm(request.POST, request.FILES, instance=g).save() 
```

只有接受类型的值可以分配给模型实例的相应字段。
models.ImageField 这里接受

*   文件路径字符串
*   django.db.models.fields.files.ImageFieldFile
*   django.core.files.images.ImageFile

# ruby - Ruby 数组，删除子数组中 > 之后的所有内容

> ID：10150304
> 
> 赞同：-1
> 
> 时间：2012-04-14T01:41:43.013
> 
> 标签：ruby, arrays

我想做的比我的问题要复杂一些，但我无法用语言表达我想要做什么，而且我的术语可能是错误的。对不起。如果我之后可以编辑我的问题的标题以更好地代表我想做的事情，我会这样做。

我有一个看起来像这样的数组：

```
array = [
  ["bnb ><b>(BASE CABINET)</b>", "bnb ><b>(BASE CABINET)</b>", "1", "22\"", "22\"", "22\""]
  ["bnb >Edgebanding (sides)", "bnb >Edgebanding (sides)", "2", "22\"", "1/2\"", "1/2\""]
  ["bnb >Edgebanding (top/bottom)", "bnb >Edgebanding (top/bottom)", "2", "21\"", "1/2\"", "1/2\""]
  ["bnb >Panel (back)", "bnb >Panel (back)", "1", "21\"", "21\"", "1/2\""]
  ["bnb >Panel (sides)", "bnb >Panel (sides)", "2", "21 1/2\"", "21\"", "1/2\""]
  ["bnb >Panel (top/bottom)", "bnb >Panel (top/bottom)", "1", "22\"", "21 1/2\"", "1/2\""]
  ["bnb >Top (front/back)", "bnb >Top (front/back)", "2", "22\"", "3\"", "1/2\""]
  ["bnb >Top (sides)", "bnb >Top (sides)", "2", "15 1/2\"", "3\"", "1/2\""]
] 
```

我想要做的是得到这个结果，基本上是`>`在每个子数组的第一个元素中删除所有内容，并`>`在子数组的第二个元素中删除之前的所有内容：

```
array = [
  ["bnb", "<b>(BASE CABINET)</b>", "1", "22\"", "22\"", "22\""]
  ["bnb", "Edgebanding (sides)", "2", "22\"", "1/2\"", "1/2\""]
  ["bnb", "Edgebanding (top/bottom)", "2", "21\"", "1/2\"", "1/2\""]
  ["bnb", "Panel (back)", "1", "21\"", "21\"", "1/2\""]
  ["bnb", "Panel (sides)", "2", "21 1/2\"", "21\"", "1/2\""]
  ["bnb", "Panel (top/bottom)", "1", "22\"", "21 1/2\"", "1/2\""]
  ["bnb", "Top (front/back)", "2", "22\"", "3\"", "1/2\""]
  ["bnb", "Top (sides)", "2", "15 1/2\"", "3\"", "1/2\""]
] 
```

到目前为止，这是我所拥有的代码：

```
val = 0
@test_list = []
test.each do |comp|
  new_list = test[val]
  new_list.map! { |element| element.gsub(/\s\>.*/, '') }
  comp = comp[0]
  @test_list.push(new_list)
  val = val + 1
end 
```

它删除了之后的所有内容，`>`但它在第一个和第二个元素中都这样做了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:08:14.220

遇到问题时无需使用正则表达式:) 有时一个简单的[`String#split`](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-split)就可以了。

```
source_array = [
  ["bnb ><b>(BASE CABINET)</b>", "bnb ><b>(BASE CABINET)</b>", "1", "22\"", "22\"", "22\""],
  ["bnb >Edgebanding (sides)", "bnb >Edgebanding (sides)", "2", "22\"", "1/2\"", "1/2\""],
  ["bnb >Edgebanding (top/bottom)", "bnb >Edgebanding (top/bottom)", "2", "21\"", "1/2\"", "1/2\""],
  ["bnb >Panel (back)", "bnb >Panel (back)", "1", "21\"", "21\"", "1/2\""],
  ["bnb >Panel (sides)", "bnb >Panel (sides)", "2", "21 1/2\"", "21\"", "1/2\""],
  ["bnb >Panel (top/bottom)", "bnb >Panel (top/bottom)", "1", "22\"", "21 1/2\"", "1/2\""],
  ["bnb >Top (front/back)", "bnb >Top (front/back)", "2", "22\"", "3\"", "1/2\""],
  ["bnb >Top (sides)", "bnb >Top (sides)", "2", "15 1/2\"", "3\"", "1/2\""]
]

target_array = [
  ["bnb", "<b>(BASE CABINET)</b>", "1", "22\"", "22\"", "22\""],
  ["bnb", "Edgebanding (sides)", "2", "22\"", "1/2\"", "1/2\""],
  ["bnb", "Edgebanding (top/bottom)", "2", "21\"", "1/2\"", "1/2\""],
  ["bnb", "Panel (back)", "1", "21\"", "21\"", "1/2\""],
  ["bnb", "Panel (sides)", "2", "21 1/2\"", "21\"", "1/2\""],
  ["bnb", "Panel (top/bottom)", "1", "22\"", "21 1/2\"", "1/2\""],
  ["bnb", "Top (front/back)", "2", "22\"", "3\"", "1/2\""],
  ["bnb", "Top (sides)", "2", "15 1/2\"", "3\"", "1/2\""]
]

arr = source_array.map do |a|
  [
   a[0].split('>').first.strip,
   a[1].split('>', -1)[1..-1].join('>')
  ] + a[2..-1]
end

arr == target_array # => true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:15:57.550

`Array.each_with_index`可能是你想要的。通过索引检查，我们可以确定是第一个还是第二个

```
arr=[
["bnb ><b>(BASE CABINET)</b>", "bnb ><b>(BASE CABINET)</b>", "1", "22\"", "22\"", "22\""],
["bnb >Edgebanding (sides)", "bnb >Edgebanding (sides)", "2", "22\"", "1/2\"", "1/2\""],
["bnb >Edgebanding (top/bottom)", "bnb >Edgebanding (top/bottom)", "2", "21\"", "1/2\"", "1/2\""],
["bnb >Panel (back)", "bnb >Panel (back)", "1", "21\"", "21\"", "1/2\""],
["bnb >Panel (sides)", "bnb >Panel (sides)", "2", "21 1/2\"", "21\"", "1/2\""],
["bnb >Panel (top/bottom)", "bnb >Panel (top/bottom)", "1", "22\"", "21 1/2\"", "1/2\""],
["bnb >Top (front/back)", "bnb >Top (front/back)", "2", "22\"", "3\"", "1/2\""],
["bnb >Top (sides)", "bnb >Top (sides)", "2", "15 1/2\"", "3\"", "1/2\""]
]

new_arr = 
arr.map do |sub_arr|
    sub_arr.each_with_index.map do |str,i|
        if i == 0
            str.gsub(/\s\>.*/,'')
        elsif i == 1
            str.gsub('bnb >','')
        else
            str
        end
    end
end

p new_arr 
```

这是一个有效的初步解决方案。你总是可以把它变成你自己的风格，例如，将 do end 更改为大括号，使用 map！，将 if 语句更改为同一行等。

# python - 在 Django 中打印对象

> ID：10150305
> 
> 赞同：18
> 
> 时间：2012-04-14T01:42:20.467
> 
> 标签：python, django

所以我已经成功地将 Django 连接到一个预先存在的数据库（检查、验证和同步），并且我已经创建了一个应用程序和一个项目以及所有这些（我正在阅读 Django 书，我在第 5 章），但是当我实际运行它并打印东西时，我得到一个（假定的）错误。在 python 中，我正确地导入了我需要的内容（`from myapp.models import Artist`），但是如果我尝试打印，例如，表中的前五行（`print Artist.objects.all()[:5]`），我得到这个：

```
[<Artist: Artist object>, <Artist: Artist object>, <Artist: Artist object>, <Artist: Artist object>, <Artist: Artist object>] 
```

为什么它实际上不打印值而不是看起来是占位符？我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-14T01:45:15.620

Django 使用 ORM（对象关系映射器）在 Python 对象和数据库行之间来回转换数据。因此，当您使用它从数据库中获取项目时，它会将其转换为 Python 对象。

如果该对象没有定义如何将自己显示为文本，Django 会为您完成。Python 做同样的事情：

```
>>> class MyObject(object):
...     pass
... 
>>> [MyObject(), MyObject()]
[<__main__.MyObject object at 0x0480E650>,
 <__main__.MyObject object at 0x0480E350>] 
```

* * *

如果要查看每个对象的行的所有实际值，请使用[`values`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#values).

这是文档中的示例：

```
# This list contains a Blog object.
>>> Blog.objects.filter(name__startswith='Beatles')
[<Blog: Beatles Blog>]

# This list contains a dictionary.
>>> Blog.objects.filter(name__startswith='Beatles').values()
[{'id': 1, 'name': 'Beatles Blog', 'tagline': 'All the latest Beatles news.'}] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-14T01:46:08.427

**更新：** 在**Python 3.x**中，使用`__str__`代替`__unicode__`

您看到的是 Artist 模型实例的列表。您的值在 python 对象中。如果你想让这些实例的表示更有帮助，你应该定义`__unicode__`方法让它们打印有用的东西：

[https://docs.djangoproject.com/en/dev/ref/models/instances/?from=olddocs#unicode](https://docs.djangoproject.com/en/dev/ref/models/instances/?from=olddocs#unicode)

它不是占位符，它是实际对象的表示，已转换为 unicode。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T15:42:52.220

如果您想使用打印方法，请在模型本身中使用**unicode方法**

```
 def __unicode__(self):
    return u'%s' % (self.id) 
```

这是一个示例模型

```
class unit(models.Model):
id = models.AutoField(primary_key=True)
name = models.CharField(max_length=255)
def __unicode__(self):
    return u'%s' % (self.name)

print(unit.objects.all())
[unit: KG, unit: PCs] 
```

# php - 正则表达式 MySQL 匹配一组字符内的单词

> ID：10150307
> 
> 赞同：-1
> 
> 时间：2012-04-14T01:42:45.050
> 
> 标签：php, mysql, sql, regex

我已经有一段时间试图在 mysql 中设置一个正则表达式，它可以从字典表中找到字母在集合中的单词。

给出一组字母，即“自由”，我想从这组字母中得到什么单词组合：

```
The result should be something like: 
```

“free”、“dom”、“fee”、“freedom”、“red”等等……

是否可以使用正则表达式？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T01:54:47.297

使用正则表达式绝对不可能。

但是，可以结合使用组合学和非常好的单词表。

**简而言之：**您正在尝试做的事情既具有挑战性又很困难，但是可能有一种方法...

**我会做什么：**

*   找到所有可能的“单词”（字母组合，大小不超过 N - 随便）
*   检查每一个，如果它在你的单词表中（字典）
*   如果是，那就数一数。如果没有，继续。

* * *

*   对于您可能需要的组合，请在此处查看我的答案：[PHP 采用所有组合](https://stackoverflow.com/questions/9787051/php-take-all-combinations/9787438#9787438)（您将在 PHP 中完成，对吗？）

*   对于一个好的词汇表，你可以先看看这里：[http](http://homepage.ntlworld.com/adam.bozon/scrabblelists.htm) ://homepage.ntlworld.com/adam.bozon/scrabblelists.htm （我希望它不会太压倒性）

# c# - 在 MVC Web Api 4 Beta 中从 Json 中删除 Null 属性

> ID：10150312
> 
> 赞同：14
> 
> 时间：2012-04-14T01:43:46.757
> 
> 标签：c#, asp.net-mvc, json, asp.net-web-api

我正在序列化对象并从我的 Web 服务返回为 json。但是，我试图从序列化的 json 中省略空属性。有没有办法做到这一点？我正在使用 Web Api MVC 4 beta。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-14T07:20:09.500

当前的 ASP.NET Web API（[有计划](http://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx)将其更改为最终版本以使用 Json.Net）默认使用[DataContractJsonSerializer](http://msdn.microsoft.com/en-us/library/bb908432.aspx)来序列化 JSON。

因此，您可以使用标准 DataContract/DataMember 属性控制序列化过程。要跳过空属性，您可以将[EmitDefaultValue](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datamemberattribute.emitdefaultvalue.aspx)设置为 false。

```
[DataContract]
public class MyObjet
{
    [DataMember(EmitDefaultValue = false)]
    public string Prop1 { get; set; }

    [DataMember(EmitDefaultValue = false)]
    public string Prop2 { get; set; }
} 
```

如果您想更好地控制 JSON 响应的序列化方式，您可以使用[WebAPIContrib](http://nuget.org/packages/WebAPIContrib)包，其中包含使用[Json.Net](http://json.codeplex.com/)或内置[JavaScriptSeralizer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)的格式化程序。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-06-03T15:47:17.133

在 Json.Net 中，您可以将[JsonPropertyAttribute](http://james.newtonking.com/projects/json/help/html/P_Newtonsoft_Json_JsonPropertyAttribute_NullValueHandling.htm)与 NullValueHandling=NullValueHandling.Ignore 一起使用。看起来这里无法对整个班级执行此操作，只能对每个班级字段/属性进行明确说明。

```
[JsonProperty(NullValueHandling = NullValueHandling.Ignore)]
public string SometimesNull { get; set; } 
```

供参考。Json.Net 默认使用空值序列化属性是[有原因的。](http://aspnetwebstack.codeplex.com/workitem/243)看一下，可能有一些适用于您的案例的原因。

# javascript - 如何根据班级存在有条件地加载@Font-Faces？

> ID：10150314
> 
> 赞同：0
> 
> 时间：2012-04-14T01:44:04.887
> 
> 标签：javascript, css, conditional, font-face

我需要通过@font-face 在我正在开发的网络应用程序中集成一种新字体。此字体只会放在应用程序中的某些内容上，这些内容由具有特定类的元素显示。除非页面上存在某个类，否则有没有办法不加载@font-faces？我不想因为某些页面上的某些内容需要该 Web 字体而不得不减慢每个页面的加载时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T00:47:28.760

@font-face 需要在其他样式之前声明，这样才能正确渲染字体。我很确定在页面加载后声明它们是行不通的，至少如果你正在寻找一个纯 css 解决方案。我不知道有什么javascript解决方案，但是您可以在页面加载后使用链接元素来缓存它们...我意识到如果您在某个页面上需要它们，这对您没有帮助，但它总是当用户在您的网站上从一个文档跳转到另一个文档时很有用。

# php - curl 在 php、iframe 和表单中

> ID：10150320
> 
> 赞同：0
> 
> 时间：2012-04-14T01:44:37.147
> 
> 标签：php, forms, iframe, curl

我的网站上有一个我正在尝试配置的销售页面。

我试图确定的付款流程是这样的：

销售页面加载，在 iframe 中使用信息表单，客户填写表单，点击提交 - 然后只有 iframe 然后重新加载......并导致第二个 iframe（这是支付处理器 iframe）

成功付款后，客户（仍在 iframe 内）被发送到成功的付​​款页面。支付处理器在 url 中添加了一些额外的字符串，然后需要将其编译成消息并作为电子邮件发送给我。

我可以成功地创建和调用表单 iframe 和支付处理器——但在如何将两者连接起来并创建第三个时遇到了困难。

任何帮助将不胜感激 - 我是一名 php 学习者，并在最深处陷入困境，为此提前道歉！

是否有可能在一个 php 页面内完成所有这些操作，还是我正在尝试最好的方式？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T01:54:28.143

iFrame 从来都不漂亮。为什么不使用 AJAX 来实现与 iframe 相同的结果？

如果您想使用 iFrame，您到底遇到了什么困难？url变量的传递？

编辑：

您应该能够使用标准 url 格式通过 iframe 传输变量：

```
<iframe src="landing_page.php?var=str&var2=str2" name="frame_name"></iframe> 
```

然后“landing_page.php”可以通过使用“get”方法调用这些变量来访问它们：

```
<?php
      echo $_GET['var'];
      echo $_GET['var2'];
?> 
```

或者，由于您通过单击（我假设）是一个链接来更改 iframe，您可以通过以下方式实现相同的结果：

```
<a href="landing_page.php?var=str&var2=str2" target="frame_name">Click to load new iframe</a> 
```

并且“landing_page.php”可以使用与以前相同的方法进行访问。

但是，我仍然建议使用 AJAX，因为 iframe 大多已过时且不必要。我还没有遇到任何关于 AJAX 和浏览器兼容性的问题。如果这是您想要的路线，我建议您使用[jquery 库](http://api.jquery.com/jQuery.ajax/)来帮助您快速启动和运行。如果您对此感兴趣，或者仍然对 iframe 有疑问，请告诉我。

编辑2：

因此，您似乎仍然可以在确认页面上使用 php $_GET 方法访问这些 url 变量，然后使用[mail](http://php.net/manual/en/function.mail.php)发送您的电子邮件。下面是一个示例（将 url 中的实际变量名称替换为我编造的变量名称）：

```
//retrieve 'email' var from url
$to = $_GET['email'];

//enter title of email
$subject = 'Your Payment Confirmation';

//create your message and retrieve 'name' and 'amount' var from url
$msg = "Thank you, ".$_GET['name']."! Your payment of ".$_GET['amount']." 
        was approved!";

//if you want to have a custom "FROM" in the email header
$headers = 'From: somename@example.com';

//send mail to customer
mail($to,$subject,$msg,$headers);

//send to yourself as well
mail('youremail@domain.com',$subject,$msg,$headers) 
```

注意：如果您在 localhost 上进行测试，则需要在本地服务器上启用邮件功能，否则邮件将无法发送。

编辑 3：

使用[explode](http://www.w3schools.com/php/func_string_explode.asp)以分号作为分隔符来解析Note var。然后，您将拥有一组值。例如：

```
//explode the note var from url
$vars = explode(';', $_GET['Note']);

//echo values of $vars array
for($i=0; $i<count($vars); $i++) {
      echo $vars[$i]. '</br>';
} 
```

# sockets - 发送“keepalive数据包”的做法是什么

> ID：10150322
> 
> 赞同：1
> 
> 时间：2012-04-14T01:44:52.530
> 
> 标签：sockets, network-programming

我看到如果在一段时间内没有发送数据包，某些 NAT 路由会自动断开连接。

但是 TCP 中的 KeepAlie 选项仅每 2 小时发送一次数据包（在 Windows 上），我们是否需要不时发送“keepalive”数据包？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T04:18:45.433

在 Windows 2000 和更高版本上，您可以使用[SIO_KEEPALIVE_VALS](http://msdn.microsoft.com/en-us/library/windows/desktop/dd877220.aspx)控制代码在每个连接的基础上设置保持活动超时和保持活动间隔。

# xml - 将未格式化的 Excel 转换为 XML

> ID：10150330
> 
> 赞同：0
> 
> 时间：2012-04-14T01:46:22.787
> 
> 标签：xml, excel

我熟悉将普通的 excel 表转换为 xml，这几乎是一个平面结构。我的问题是我的表格有跨越所有表格列的标题。我无法将我的架构映射到单元格。月份将作为新行自动添加到成本节点。见例子。

成本 销售 利润
一月
100 150 50
20 40 20
二月
100 150 50
20 40 20
三月
100 150 50
20 40 20

这是我正在寻找的 XML 结果

```
<Sales>  
 <Period>  
   <Month>January</Month>  
   <Cost>100</Cost>  
   <Sell>150</Sell>  
   <Profit>50</Profit>  
  </Period>  
  <Period>  
   <Month>February</Month>  
   <Cost>100</Cost>  
   <Sell>150</Sell>  
   <Profit>50</Profit>  
  </Period>  
  <Period>  
   <Month>March</Month>  
   <Cost>100</Cost>  
   <Sell>150</Sell>  
   <Profit>50</Profit>  
 </Period>  
</Sales> 
```

预先感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T09:53:25.410

我不知道您可以调整多少源 Excel 工作表以及是否可以对 XML 文件进行后处理。

您可以插入一个“结转”月份的辅助列，尽管这不会帮助您完全摆脱整个月份。

![在此处输入图像描述](../Images/04a554520813ead338099b3446b72a8b.png)

有了这个，我得到了以下 XML 导出。

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Sales xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

<Period>
    <Month>January</Month>
    <Cost>January</Cost>
</Period>
<Period>
    <Month>January</Month>
    <Cost>100</Cost>
    <Sell>150</Sell>
    <Profit>50</Profit>
</Period>
<Period>
    <Month>January</Month>
    <Cost>20</Cost>
    <Sell>40</Sell>
    <Profit>20</Profit>
</Period>
[...]
</Sales> 
```

然后，您可以使用适当的 XSLT 对该导出进行后处理，以消除仅包含月份的行。或者更进一步使用辅助列，以便仅包含月份的行全部为空（即计算 2 个月的列和仅包含数值的成本列）。但我看不到完全消除这些线条的方法。

HTH安德烈亚斯

# url - 确保用于统计跟踪的内部链接 URL 参数不会被视为不同的页面

> ID：10150337
> 
> 赞同：0
> 
> 时间：2012-04-14T01:48:20.680
> 
> 标签：url, hyperlink, get, search-engine

我想在我的 URL 中添加一些参数，以便我可以识别访问者是否通过单击主页链接、顶部导航、底部导航等打开了页面。所以类似于：

*   [http://url.com/article/123?ref=topnav](http://url.com/article/123?ref=topnav)
*   [http://url.com/article/123?ref=bottomnav](http://url.com/article/123?ref=bottomnav)
*   ..://url.com/article/123?ref=homepage

（此处不能发布超过两个链接）

但是，我想确保搜索引擎不会认为这是一个单独的页面，并且我的页面上有很多重复的内容。我认为有一些“行业标准”的方法可以做到这一点，以明确我的参数只是用于统计的内部标志，并不表示不同的内容。但是我在谷歌搜索时找不到相关的搜索结果；不知道如何搜索这个。

所以我的问题是：有没有一种方法我应该命名或使用 URL 参数来确保搜索引擎意识到这些链接的重要性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T20:43:47.440

**1)** Google 在索引页面时会忽略`#`URL 中的所有内容，因此请使用 # 而不是`?`... 然后，出于 SEO 目的，Google 将考虑：

`http://example.com/pagename.html` 并 `http://example.com/pagename.html#var1=FOO&var2=BAR`成为同一页。

**2）**您还可以在页面头部设置：

`<link rel="canonical" href="http://www.example.com/pagename.html" />`

见：http: [//googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html](http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html)

**3）**就报告而言，在谷歌分析中，他们支持使用`#`查询字符串分隔符，请参阅：[https ://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiCampaignTracking#_gat.GA_Tracker_._setAllowAnchor](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiCampaignTracking#_gat.GA_Tracker_._setAllowAnchor)

**4）**在您的谷歌分析配置文件中，您还可以将其设置为排除查询字符串参数。请参阅： http: [//support.google.com/analytics/bin/answer.py ?hl=zh-CN&answer=1010249](http://support.google.com/analytics/bin/answer.py?hl=en-GB&answer=1010249)

**我更喜欢方法 #1**。我所有的营销活动跟踪 URL 和所有内部链接和逻辑都`#`用作查询字符串分隔符，因此我可以将我的链接汁最大化到我在 .htaccess 中设置的规范域（我的规范中没有 www 子域）：

```
Options +FollowSymlinks
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www.example.com$ [NC]
RewriteRule ^(.*)$ http://example.com/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T02:10:29.440

事实证明，有一组可用的参数。他们是：

```
Campaign Source (utm_source)
Required. Use utm_source to identify a search engine, newsletter name, or other source. 
Example: utm_source=google

Campaign Medium (utm_medium)
Required. Use utm_medium to identify a medium such as email or cost-per- click. 
Example: utm_medium=cpc

Campaign Term (utm_term)
Used for paid search. Use utm_term to note the keywords for this ad. 
Example: utm_term=running+shoes

Campaign Content (utm_content)    
Used for A/B testing and content-targeted ads. Use utm_content to differentiate ads or links that point to the same URL. 
Examples: utm_content=logolink or utm_content=textlink

Campaign Name (utm_campaign)
Used for keyword analysis. Use utm_campaign to identify a specific product promotion or strategic campaign. 
Example: utm_campaign=spring_sale 
```

可以在此处阅读更多内容：http: [//support.google.com/analytics/bin/answer.py ?hl=en&answer=1033867](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1033867)

不确定这是否是“行业标准”，但至少它是分析支持的。

# android - 如何在首选项设置中从 SharedPreference 中 getLong()

> ID：10150338
> 
> 赞同：3
> 
> 时间：2012-04-14T01:48:22.497
> 
> 标签：android, xml, android-preferences

我有以下代码可以从我的 xml 首选项文件中获取长值，

```
SharedPreferences getPrefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext()); 

long longBreak = Integer.parseInt(getPrefs.getString("breakTime", "8000"));
long shortBreak = Integer.parseInt(getPrefs.getString("breakTime", "5000"));
long workTime = Integer.parseInt(getPrefs.getString("workTime", "10000")); 
```

出于某种原因，我的 LogCat 显示在“SharedPreference getPrefs=....”行出现错误，并且我的 android 应用程序在加载长值之前中断....

我的偏好xml如下，

```
<ListPreference
    android:entries="@array/workList"
    android:entryValues="@array/workTimes"
    android:key="workTime"
    android:summary="Choose Work Time"
    android:title="Work Time" />
<ListPreference
    android:entries="@array/breakList"
    android:entryValues="@array/breakTimes"
    android:key="breakTime"
    android:summary="Choose Break Time"
    android:title="Break Time" /> 
```

我的数组值如下，

```
<string-array name="workList">
    <item>25 Minutes</item>
    <item>10 Seconds</item>
</string-array>
<string-array name="breakList">
    <item>15 Minutes</item>
    <item> 5 Minutes</item>
    <item>8 Secs</item>
    <item>5 Secs</item>
</string-array>
<string-array name="workTimes">
    <item>1500000</item>
    <item>10000</item>
</string-array>
<string-array name="breakTimes">
    <item>900000</item>
    <item>300000</item>
    <item>8000</item>
    <item>5000</item>
</string-array> 
```

我已经在 diff 应用程序中测试了相同的代码，它工作正常......有什么帮助吗？提前致谢...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T03:11:37.043

您可以使用：

```
 SharedPreferences shared = getSharedPreferences("file_pref", MODE_PRIVATE);
 to get a object of SharedPreferences 
```

要从 SharedPreferences 中获取 Long 值：您应该使用 SharedPreferences 类的 Editor 中的 putLong("key","value") 和 getLong("key","default_value") 来获取您想要的值。前任：

//创建：

```
SharedPreferences shared = getSharedPreferences("file_pref", MODE_PRIVATE);
Editor edit = shared.edit();
shared.putLong("key1","value1"); 
```

//使用：

```
SharedPreferences shared = getSharedPreferences("file_pref", MODE_PRIVATE);
Long value_long = shared.getLong("key1",0);
//with 0 - default value 
```

您可以查看此链接以了解如何使用 SharedPreferences 类在 Android 中清晰轻松地保存简单信息：

[在关闭应用程序之前保存值？](https://stackoverflow.com/questions/10127396/save-values-before-close-the-app/10127842#10127842)

希望它对你有用。

# android - 自定义广播接收器不起作用

> ID：10150339
> 
> 赞同：0
> 
> 时间：2012-04-14T01:48:26.517
> 
> 标签：android, broadcastreceiver

我知道这是一个热门话题，但我找不到适合我的案例。为了在我的设计中获得一些模块化，我创建了一个单一的广播接收器，它可以监听任何网络状态的变化，并作为一个通用网关（现在是连接）广播到我的应用程序中。这个类被称为 ConnectivityReceiver，它基本上是这样的：

```
public class ConnectivityReceiver extends BroadcastReceiver {
    private static final String TAG = "ConnectivityReceiver";

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.d(TAG,"onReceive called");
        Log.d(TAG,"Intent.getAction() is "+intent.getAction());
        if(intent.getAction().equals(ConnectivityManager.CONNECTIVITY_ACTION)){
            Intent out = new Intent(MapFragment.ACTION_LOCAL_CONNECTIVITY_CHANGE);
            Log.d(TAG,"Sending broadcast");
            context.sendBroadcast(out);
        }
    }
} 
```

我确实在 Manifest 中注册了它，它运行得很好。然后，我有一个片段有兴趣了解这种连接变化，所以我创建了一个简单的内部 BroadcastReceiver，如下所示：

```
public BroadcastReceiver connectivityReceiver = new BroadcastReceiver(){

        @Override
        public void onReceive(Context context, Intent intent) {
            Log.d(TAG,"got connection info!");
        }
}; 
```

这个没有在 Manifest 中注册，但我确实很注意分别在片段的 onCreate 和 onDestroy 方法中注册和取消注册它。像这样的东西：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Log.d(TAG,"onCreate");
    connectivityReceiver = new ConnectivityReceiver();
    IntentFilter intentFilter = new IntentFilter();
    intentFilter.addAction(MapFragment.ACTION_LOCAL_CONNECTIVITY_CHANGE);
    this.getActivity().registerReceiver(connectivityReceiver, intentFilter);

    /* Creating a ParseHandler, this will be needed for the PathParser */
    mParserHandler = new ParserHandler(getActivity());
} 
```

和

```
@Override
public void onDestroy(){
    Log.d(TAG,"onDestroy");
    this.getActivity().unregisterReceiver(connectivityReceiver);
} 
```

但是由于某些未知原因，链中的第二个广播接收器没有收到广播！它正在发布，因为第一个（在 Manifest 中注册的）正在获取它。

有任何想法吗？自定义操作名称如下所示：

```
public static final String ACTION_LOCAL_CONNECTIVITY_CHANGE = "com.spiral.android.transito.CONNECTIVITY_CHANGE"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T16:07:21.047

将 ：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    // connectivityReceiver = new ConnectivityReceiver(); // why did you do this?
    Log.d(TAG,"onCreate");
    IntentFilter intentFilter = new IntentFilter();
    intentFilter.addAction(MapFragment.ACTION_LOCAL_CONNECTIVITY_CHANGE);
    this.getActivity().registerReceiver(connectivityReceiver, intentFilter);
    /* Creating a ParseHandler, this will be needed for the PathParser */
    mParserHandler = new ParserHandler(getActivity());
} 
```

工作 ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T20:35:35.300

好的，我通过创建一个扩展 BroadcastReceiver 的非匿名内部类来解决这个问题。不知道为什么其他方式不起作用。被修改的代码基本上是第二个框，现在看起来像这样：

```
class LocalBroadcastReceiver extends BroadcastReceiver{

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.d(TAG,"got connection info!");
    }
}; 
```

就像以前一样，我在 Fragment 的范围内创建了这个内部类的全局实例，就像在 onCreate 中注册它并在 onDestroy 中取消注册它一样。

# python - 使用命令行脚本打包 python 程序

> ID：10150341
> 
> 赞同：3
> 
> 时间：2012-04-14T01:49:08.130
> 
> 标签：python, command-line, release, packaging

我试图让我的宠物 Python 项目进入可发布状态，但在打包它时我很难过。

[Mark Pilgrim 在 Dive Into Python 中推荐了这个目录结构](http://docs.activestate.com/activepython/3.2/diveintopython3/html/packaging.html#structure)

```
httplib2/                 
|  
+--README.txt             
|  
+--setup.py               
|  
+--httplib2/              
    |  
    +--__init__.py  
    |  
    +--iri2uri.py 
```

我想不通的是，如果我有一个运行脚本，即一个可执行的命令行程序，比如 foo，我的项目名称是 foo，我应该给内部包目录命名什么？

举一个具体的例子，如果我有

```
README.md
LICENSE
somefile1.py
somefile2.py
foo 
```

打包这个的最好方法是什么？

例如

```
+--README.md
|
+--LICENSE
|
+--foo
|
+--foo/
    |
    +--somefile1.py
    |
    +--somefile2.py 
```

由于名称重复，无法正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T02:22:05.373

**你这样做是错的...**

这是结构“应该”的样子

```
foo 1.0/
| +--README.txt
| +--setup.py
| +--foo/__init__.py
| +--foo/iri2uri.py
| +--foo/httplib2/__init__.py
| +--foo/httplib2/bar.py 
```

将外部的封闭文件夹视为包。这应该包括安装和文档文件 LICENSE、README、MANIFEST、setup.py。包中的文件夹（在这种情况下，只是 '/foo'）是模块。

要访问上述所有功能，您可以使用以下导入语句：

```
import foo                # represented by foo/__init__.py
import foo.iri2uri        # represented by foo/iri2uri.py
import foo.httplib2       # represented by foo/httplib2/__init__.py
import foo.httplib2.bar   # represented by foo/httplib/bar.py 
```

从技术上讲，您可以选择将子模块包含为文件或文件夹。只有子模块有子模块时，才需要文件夹。

例如：

```
foo 1.0/
| +--/foo/iri2uri.py
| +--/foo/iri2uri/__init__.py 
```

两者都将被以相同的方式解释。

例如：

```
import foo.iri2uri 
```

一开始有点棘手，但每个曾经构建过安装包的人都遇到过这个减速带。

**更新：我认为这更好地回答了你的问题**

**对于可执行文件，您创建一个单独的包**

无需安装程序，因为其他应用程序不会导入此代码。

```
examples/
| +--/foo.py 
```

它们应该作为独立程序运行，并从您安装的库 (foo) 中导入必要的模块。

# c# - 应用启动和焦点恢复

> ID：10150347
> 
> 赞同：0
> 
> 时间：2012-04-14T01:51:35.570
> 
> 标签：c#, kinect

我正在开发一个 kinect 应用程序（应用程序 A），我想在其中启动另一个本地 kinect 应用程序（应用程序 B）。

我可以启动应用程序 B 没问题，它显示在我的 kinect 启动应用程序上，生活很好。要关闭应用程序 B，我必须使用 kinect 手势对其进行攻击。

我不确定的是，我希望应用 A 知道应用 B 何时消失，并让应用 A 获取一些事件，以便它可以再次全屏显示并重新连接 kinect 传感器。

我知道如何做所有事情，除了从应用程序 A 检测到它上面没有任何东西并且它可以再次控制时。

我需要做什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T07:42:34.987

**选项1**

尝试[WindowFromPoint](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633558%28v=vs.85%29.aspx)作为您知道 2 个窗口（App A 的窗口和 App B 的窗口）应该相交的屏幕点。如果返回的句柄属于 App B 窗口或其子窗口之一，则 App A 仍在运行。

**选项 2**

让 App B 在退出时向 App A 发送消息（使用[FindWindow](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499%28v=vs.85%29.aspx)查找 App A 的窗口句柄）

**选项 3**

偶尔使用 [EnumWindows](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633497%28v=vs.85%29.aspx)（基于计时器）枚举所有顶级窗口并查找 App B 的窗口是否仍然存在

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T22:49:20.697

所以我找到了解决这个问题的正确（我认为）方法，我把问题复杂化了。我正在使用 System.Diagnostics.Process 从应用程序 A 启动应用程序 B-因此我可以直接访问该进程，因为应用程序 A 永远不会停止。我只是连接到 Exited 事件，然后当应用程序 B 消失时，我可以让应用程序 A 做任何我需要的事情。

# python - 如何从python中的剪贴板获取文本并粘贴到utf-8中？

> ID：10150349
> 
> 赞同：2
> 
> 时间：2012-04-14T01:52:20.263
> 
> 标签：python

我在剪贴板中有一些 utf-8 文本和一个没有任何内容的 utf-8 .txt 文件。

如果我在 notepad++ 中打开文件，然后使用 ctrl+v 粘贴，我会以 utf-8 格式得到它，其中没有那些？

但是，如果我使用 python 代码从剪贴板获取文本并以附加模式打开文件并将其写入那里，然后在 notepad++ 中查看文件，我会在其中看到？

是否有一些特殊的 python 代码可以从剪贴板获取文本并将其写入一个空的 utf-8 文件，这样如果我在 notepad++ 中查看该文件，我不会看到那些？

有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T04:11:21.397

使用`codecs`模块：

```
 import codecs

 file = "/path/to/save/file.txt" 

 # instead of open(file,'w') do:
 f = codecs.open(file, encoding='utf-8',mode='w+')

 # Write a unicode string to the file.
 f.write(u'\u4500 blah blah blah\n') 
```

# javascript - Javascript 中的范围问题与 setTimeout

> ID：10150350
> 
> 赞同：1
> 
> 时间：2012-04-14T01:53:00.573
> 
> 标签：javascript, scope

范围问题，我认为函数语句总是被提升到当前上下文的顶部。那么为什么在下面没有定义'hideNav（）'？

```
var t;

function showNav(bflag){
clearTimeout(t);
if(bflag===true){
    $("#tS2").stop(false,false).animate({
                'bottom':'0'
            }, 1000);
}else{

    t=setTimeout("hideNav()",1000);

}
}

function hideNav(){
$("#tS2").stop(true,false).animate({
                'bottom':'-125px'
            }, 1000);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T01:54:28.453

改变，

```
setTimeout("hideNav()",1000); 
```

至

```
setTimeout(hideNav, 1000); 
```

`hideNav`仅在当前上下文中定义，但您将字符串传递给`setTimeout`. 当超时发生在全局对象的上下文中时，该字符串将被评估。由于您的`hideNav`函数未在全局对象中定义，因此会引发异常。

通过直接将函数的引用传递给`setTimeout`，您不必担心它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T01:54:41.057

`setTimeout()`在这种情况下不要使用字符串 with 。

将其更改为：

```
t = setTimeout(hideNav, 1000); 
```

使用带有`setTimeout()`强制它的字符串`eval()`来评估您的字符串，当它这样做时，它使用全局上下文，而不是您的本地上下文。所以，我的猜测是这`hideNav()`实际上不是一个全局函数（您可能将此代码包装在其他函数中）。

此外，使用直接函数引用而不是字符串总是更好，而且速度也快得多。请记住，当您使用直接函数引用时，不要在后面加上括号。你想要一个对函数的引用，你不想立即执行它并传递返回值，如果你使用它会这样做`t = setTimeout(hideNav(), 1000);`

# android - 为什么我得到一个空指针异常，可能是一个类错误（Android）？

> ID：10150353
> 
> 赞同：0
> 
> 时间：2012-04-14T01:54:15.887
> 
> 标签：android, nullpointerexception

我被困住了。我已经花了几个小时看这个，我知道这一定是我做错了一些微不足道的事情。我的母语“语言”是 C++，但我想使用 Android。我真的很喜欢在 C++ 中使用结构，但发现我必须使用 Java 中的类来解决问题。由于我的课程有问题，我已经很好地缩小了我得到一个空指针的范围。有任何想法吗？

这是标有第 267 行的代码：

```
public class Vectors extends Activity{

    Button next;

    public class infoC{
        double value = 0, angle = 0;
        boolean radian = false; //radians/degrees
        int quad = 1; //Quadrant
    }
    public infoC[] info;

    int counter = 0;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.vectors);
        vectorsView = new VectorsView(this);
        l = (LinearLayout) findViewById(R.id.llCanvasV);
        l.addView(vectorsView);

        Initialize();       

        next.setOnClickListener(new View.OnClickListener() {    
            public void onClick(View v) {
                error.setText("");
                if(value.getText().toString().length()==0||value.getText()==null||angle.getText().toString().length()==0||angle.getText()==null)
                    error.setText("Must enter both value and angle");
                else{
                    Log.e("Counter", Integer.toString(counter));
                    Log.e("Value", value.getText().toString());
                    storeInfo(); //121
                    counter++;
                }
            }
        });
            }
public void storeInfo(){
        Doublify(value);
        Doublify(angle);

        String temp;
        temp=value.getText().toString();

        info[counter].value = Double.parseDouble(temp);//267, Inserted temp instead of getText.toString
        info[counter].angle = Double.parseDouble(angle.getText().toString());
        info[counter].radian = rad.isChecked();
        if(q1.isChecked())
            info[counter].quad=1;
        if(q2.isChecked())
            info[counter].quad=2;
        if(q3.isChecked())
            info[counter].quad=3;
        if(q4.isChecked())
            info[counter].quad=4;
        angle.setText("");
        value.setText("");
    }
} 
```

这是日志猫：

```
04-13 18:50:45.188: ERROR/AndroidRuntime(9892): FATAL EXCEPTION: main
04-13 18:50:45.188: ERROR/AndroidRuntime(9892): java.lang.NullPointerException
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at com.prattia.webs.cheaterphysics.Vectors.storeInfo(Vectors.java:267)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at com.prattia.webs.cheaterphysics.Vectors$7.onClick(Vectors.java:121)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at android.view.View.performClick(View.java:2465)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at android.view.View$PerformClick.run(View.java:8907)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at android.os.Handler.handleCallback(Handler.java:587)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at android.os.Looper.loop(Looper.java:123)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at android.app.ActivityThread.main(ActivityThread.java:4627)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at java.lang.reflect.Method.invokeNative(Native Method)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at java.lang.reflect.Method.invoke(Method.java:521)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
04-13 18:50:45.188: ERROR/AndroidRuntime(9892):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T01:57:11.603

看起来您从未初始化过 info[] 数组。因此 info[counter] 抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:00:24.927

可能是因为您从未初始化数组`public infoC[] info = new infoC[size];`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T02:01:14.960

您应该只调试您的代码，在第 267 行放置一个断点，然后查看变量的值是什么。你确定你的信息不为空吗？我看不到对其进行任何初始化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T02:03:56.733

info 必须在使用之前进行初始化。

```
public infoC[] info = new infoC[10]; 
```

我很确定这也是它在 C++ 中的工作方式。当然我不知道你需要多少元素，我放了 10 个。所以你可能想使用一些动态的东西，比如：

```
...
public ArrayList<infoC> info = new ArrayList<infoC>();
...
info.add(new infoC());
info.get(counter).value = Double.parseDouble(temp);
info.get(counter).angle = Double.parseDouble(angle.getText().toString());
info.get(counter).radian = rad.isChecked();
.... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-14T02:04:57.240

在使用之前将变量 l 定义为 LinearLayout

这在你的变量声明中，你也应该将你的vectorview声明为视图

# java - 字符串不显示在编辑文本中

> ID：10150362
> 
> 赞同：0
> 
> 时间：2012-04-14T01:55:32.150
> 
> 标签：java, android, eclipse, android-intent

我创建了一个意图，它获取输入到两个编辑文本中的值，并在单击提交按钮时将它们作为意图发送到另一个类，这里​​是代码：

```
Button bSubmit1 = (Button) findViewById(R.id.submit2); //Submit Button
    bSubmit1.setOnClickListener(new View.OnClickListener(){

        public void onClick(View v) {
            // TODO Auto-generated method stub

            String entry_Minutes = entryminutes.getText().toString();
            String entry_Hours = entryhours.getText().toString();

            Intent i=new Intent("com.lukeorpin.theappliancekeeper.MOVINGSTRINGS");
            i.putExtra("Entry_Minutes", entry_Minutes);
            i.putExtra("Entry_Hours", entry_Hours);
            startActivity(i); 
```

然后开始下一个类中的活动，其中在意图中发送的字符串应该显示在另外两个编辑文本中，但是两个编辑文本框中没有出现任何内容。这是另一个类中代码的另一部分：

```
public class EntryStatistics extends Activity {

EditText hoursBox, minutesBox;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.entrystatistics);

    hoursBox = (EditText)findViewById(R.id.entry_hours);
    minutesBox = (EditText)findViewById(R.id.entry_minutes);

    String entry_minutes = getIntent().getStringExtra("Entry_Minutes");
    if(entry_minutes!=null){
        return;
    }
    String entry_hours = getIntent().getStringExtra("Entry_Hours");
    if(entry_hours!=null){
        return;
    }

    hoursBox.setText(entry_hours);
    minutesBox.setText(entry_minutes); 
```

谁能告诉我为什么字符串中的值没有显示在编辑文本中？什么都没有显示。谢谢

以下是完整的错误消息：

```
04-14 03:00:47.300: E/AndroidRuntime(373): FATAL EXCEPTION: main
04-14 03:00:47.300: E/AndroidRuntime(373): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.lukeorpin.theappliancekeeper/com.lukeorpin.theappliancekeeper.EntryStatistics}: java.lang.NullPointerException
04-14 03:00:47.300: E/AndroidRuntime(373):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
04-14 03:00:47.300: E/AndroidRuntime(373):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
04-14 03:00:47.300: E/AndroidRuntime(373):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
04-14 03:00:47.300: E/AndroidRuntime(373):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
04-14 03:00:47.300: E/AndroidRuntime(373):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-14 03:00:47.300: E/AndroidRuntime(373):  at android.os.Looper.loop(Looper.java:123)
04-14 03:00:47.300: E/AndroidRuntime(373):  at android.app.ActivityThread.main(ActivityThread.java:3683)
04-14 03:00:47.300: E/AndroidRuntime(373):  at java.lang.reflect.Method.invokeNative(Native Method)
04-14 03:00:47.300: E/AndroidRuntime(373):  at java.lang.reflect.Method.invoke(Method.java:507)
04-14 03:00:47.300: E/AndroidRuntime(373):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-14 03:00:47.300: E/AndroidRuntime(373):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-14 03:00:47.300: E/AndroidRuntime(373):  at dalvik.system.NativeStart.main(Native Method)
04-14 03:00:47.300: E/AndroidRuntime(373): Caused by: java.lang.NullPointerException
04-14 03:00:47.300: E/AndroidRuntime(373):  at com.lukeorpin.theappliancekeeper.EntryStatistics.onCreate(EntryStatistics.java:34)
04-14 03:00:47.300: E/AndroidRuntime(373):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-14 03:00:47.300: E/AndroidRuntime(373):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
04-14 03:00:47.300: E/AndroidRuntime(373):  ... 11 more 
```

这是第 34 和 35 行：

```
hoursBox.setText(entry_hours);
minutesBox.setText(entry_minutes); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:03:53.147

在您的空检查中，IT 看起来像是一个简单的错字。如果字符串不为空，则您当前正在忽略字符串，而应该反过来。

修复应该相对简单。只是改变

```
if(entry_minutes!=null){
    return;
} 
```

至

```
if(entry_minutes==null){
    return;
} 
```

对两个字符串都完成此操作后，`EditText`s 应该会毫无问题地更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:18:08.190

```
 String entry_minutes = getIntent().getStringExtra("Entry_Minutes");
    if(entry_minutes==null){
        return;
    }
    String entry_hours = getIntent().getStringExtra("Entry_Hours");
    if(entry_hours==null){
        return;
    } 
```

因为当前行返回您，因为 entry_minutes 不为空，并且根据您的条件它为真。将其更改为等于。同样从您的第一个活动开始，您正在调用一个新活动，如下所示

```
Intent i=new Intent("com.lukeorpin.theappliancekeeper.MOVINGSTRINGS"); 
```

你有 EntryStatistics 活动的代码，我认为你没有调用 EntryStatistics 活动。

只需将上述意图更改为以下并尝试::

```
Intent i=new Intent(ThisActivityName.this,EntryStatistics.class); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T02:11:49.987

这可以通过保留一些调试点并使用 F6 逐步执行以调试模式运行应用程序来逐步清楚地观察到。

* * *

发送或接收对象或字符串

**发送字符串数据**

正如我们已经知道的那样，我们可以使用 Intents 从一个 Activity 转移到另一个 Activity。

```
Intent i = new Intent(MainActivity.this,GoActivity.class);

String data = “bla bla”;// Data String to send

i.putExtra("DATA",data ); 
```

**接收数据**

我们可以接收到上面的字符串数据如下图。

```
Intent i = getIntent();
String data = i.getStringExtra("DATA");// you well get the String data i.e., BLA BLA 
```

发送和接收数据时，红色数据应相同。

**发送对象**

这是将对象从一个类发送到另一个类的代码。发送 Object 的一件重要事情是该类应该实现 Serializable 类。

下面的红色文本应该是相同的。

//MainActivity.java

```
Intent i = new Intent(MainActivity.this,startActivity.class);

ObjectClassName object = new ObjectClassName();

i.putExtra("THIS", Object); 
```

**接收对象**

// 开始活动.java

```
Intent i = getIntent();
ObjectClassName obj = (ObjectClassName) getIntent().getSerializableExtra("THIS");// TypeCasting needed 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T02:10:09.943

使用这个技巧：

* * *

## X 类：

```
static String entry_Minutes="",entry_Hours="";
Button bSubmit1 = (Button) findViewById(R.id.submit2); //Submit Button
    bSubmit1.setOnClickListener(new View.OnClickListener(){

        public void onClick(View v) {
            // TODO Auto-generated method stub

            entry_Minutes = entryminutes.getText().toString();
            entry_Hours = entryhours.getText().toString();

            Intent i=new Intent("com.lukeorpin.theappliancekeeper.MOVINGSTRINGS");
            startActivity(i); 
```

* * *

## 入口统计：

```
public class EntryStatistics extends Activity {

EditText hoursBox, minutesBox;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.entrystatistics);

    hoursBox = (EditText)findViewById(R.id.entry_hours);
    minutesBox = (EditText)findViewById(R.id.entry_minutes);

    hoursBox.setText(ClassX.entry_Hours);
    minutesBox.setText(ClassX.entry_Minutes); 
```

# php - PHP 脚本插入已解析的电子邮件数据，同时保持关键关系

> ID：10150365
> 
> 赞同：-1
> 
> 时间：2012-04-14T01:57:10.810
> 
> 标签：php, mysql, sql, email-parsing

我目前正在完成一个 PHP 脚本，该脚本解析电子邮件并将它们插入到结构如下的数据库表中 -

**用户表**

*   userId - int - auto_increment - PK
*   电子邮件 - varchar

**电子邮件表**

*   emailId - int - auto_increment - PK
*   userId - int - FK
*   attachmentId - int - FK
*   正文 - varchar
*   主题 - varchar

**附件表**

*   attachmentId - int - auto_increment - PK
*   附件名称 - varchar
*   文件类型 - varchar
*   内容 - mediumblob
*   代码 - varchar

我的问题是，一旦我解析了电子邮件，如何确保我的外键关系是正确的？我最初的方法只是执行：

```
INSERT INTO users (email) values ('$emailFrom');
INSERT INTO emails (subject, body) values ('$subject', '$body');
INSERT INTO attachments (attachmentName, fileType, content, code) values ('$attachmentName', '$fileType', '$content', '$code'); 
```

但后来我意识到这不会处理我在电子邮件表中的 FK 关系。单独执行每个查询的最佳方法是重新查询生成的 Id 然后将新 Id 放在相关的 FK 行中吗？对不起，如果我不清楚。

把它做成一张桌子并避免这个问题会有什么缺点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T02:30:08.437

我建议使用事务，确保插入的整体被视为原子（一个插入）。这可以保护您的数据，以防如果其中一个查询失败，您的数据最终不会处于格式错误的状态。

您的代码没有避开您正在使用的 API 类型（mysql、mysqli、pdo），但我将使用 PDO（未经测试）给出一个片段：

```
<?php 
try {

    $dbo = new PDO('mysql:host=localhost;dbname=test', 'username', 'password'); 

    $stmt1 = $dbo->prepare('INSERT INTO users SET email = :email'); 
    $stmt2 = $dbo->prepare('INSERT INTO attachments SET attachment_name = :attachmentName, file_type = :fileType');
    $stmt3 = $dbo->prepare('INSERT INTO emails SET set user_id = :userId, subject = :subject, body = :body, attachment_id = :attachmentId');

    try { 

        $dbo->beginTransaction(); 

        $stmt1->bindParam(':email', $email, PDO::PARAM_STR);
        $stmt->execute();

        $userId = $dbo->lastInsertId();

        $stmt2->bindParam(':attachmentName', $attachmentName, PDO::PARAM_STR);
        $stmt2->bindParam(':fileType', $fileType, PDO::PARAM_STR);
        $stmt2->execute();

        $attachmentId = $dbo->lastInsertId();

        $stmt3->bindParam(':userId', $userId, PDO::PARAM_INT);
        $stmt3->bindParam(':subject', $subject, PDO::PARAM_STR);
        $stmt3->bindParam(':body', $body, PDO::PARAM_STR);
        $stmt3->bindParam(':attachmentId', $attachmentId, PDO::PARAM_INT);
        $stmt3->execute();

        $dbo->commit(); 

    } catch(Exception $e) { 
        $dbo->rollback(); 
        error_log($e->getMessage()); 
    } 
} catch(Exception $e) { 
    error_log($e->getMessage());
} 
```

?>

您可以使用以下链接阅读有关片段中使用的 API 调用的更多信息：

*   [绑定参数](http://www.php.net/manual/en/pdostatement.bindparam.php)

*   [开始交易](http://www.php.net/manual/en/pdo.begintransaction.php)

*   [犯罪](http://www.php.net/manual/en/pdo.commit.php)

*   [回滚](http://www.php.net/manual/en/pdo.rollback.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:09:49.473

首先查看users表中是否存在$emailFrom，将userid取到$userid中。如果它不存在，则插入它并将新的用户 ID 放入 $userid。

然后插入到附件中，并在 $attachmentID 中获取新的附件 ID 存储。

然后最后插入电子邮件：

```
 INSERT INTO emails (userid, attachmentid, subject, body) 
             values ($userid, $attachmentId, '$subject', '$body'); 
```

然后您的外键将被正确设置。

# python - 为什么使用 Python 的子进程的管道输出如此不可靠？

> ID：10150368
> 
> 赞同：3
> 
> 时间：2012-04-14T01:58:03.177
> 
> 标签：python, performance, subprocess, pipe, piping

（视窗）

我编写了一些调用程序 SoX（子进程模块）的 Python 代码，如果您指定它，它会在 STDERR 上输出进度。我想从输出中获取百分比状态。如果我不是从 Python 脚本中调用它，它会立即启动并平稳进展到 100%。

如果我从 Python 脚本调用它，它会持续几秒钟直到它开始，然后它会在慢速输出和快速输出之间交替。尽管我有时会逐个字符地读取字符，但会冲出一大块。所以我不明白为什么在其他时候我可以看到角色一个接一个地变多。（顺便说一下，它在我的测试中生成了 15KiB 的数据。）

我已经用 mkvmerge 和 mkvextract 进行了同样的测试。他们也输出百分比。在那里阅读 STDOUT 很顺利。

这太不靠谱了！如何使 sox 的 stderr 流的读取更流畅，并可能防止一开始的延迟？

* * *

我如何打电话和阅读：

```
process = subprocess.Popen('sox_call_dummy.bat', stderr = subprocess.PIPE, stdout = subprocess.PIPE)
while True:
    char = process.stderr.read(1).encode('string-escape')
    sys.stdout.write(char) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:20:36.930

根据这个密切相关的线程：[Unbuffered read from process using subprocess in Python](https://stackoverflow.com/questions/1183643/unbuffered-read-from-process-using-subprocess-in-python)

```
process = subprocess.Popen('sox_call_dummy.bat', 
                stderr = subprocess.PIPE, bufsize=0)
while True:
    line = process.stderr.readline()
    if not line: 
        break
    print line 
```

由于您没有阅读标准输出，因此我认为您不需要管道。

如果您想尝试像原始示例中那样逐个字符地读取字符，请尝试每次添加一个刷新：

```
sys.stdout.write(char)
sys.stdout.flush() 
```

每次编写时刷新标准输出是手动等效于禁用 python 进程的缓冲： `python.exe -u <script>`或设置 env 变量`PYTHONUNBUFFERED=1`

# android - 从谷歌播放更新

> ID：10150369
> 
> 赞同：1
> 
> 时间：2012-04-14T01:58:11.293
> 
> 标签：android, google-play

嗨，我正在谷歌市场上免费部署一个应用程序，所以我希望人们能够直接通过蓝牙共享应用程序，但这应该是为了维护 google play 的更新功能，所以他们会收到更新。此外，如果此共享应用程序在 google play 上注册为应用程序的下载，那就太好了。

任何关于这个主题的想法都会受到极大的欢迎！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T02:02:18.370

从 4.0 查看 Android Beam。它是您正在寻找的最接近的“内置”实现。您尝试完成的问题是应用程序无权访问 /data/app，应用程序存储在手机上。因此，您的应用必须从其他来源（不是 Google Play）下载。

# grails - grails 异步文件上传

> ID：10150370
> 
> 赞同：0
> 
> 时间：2012-04-14T01:58:57.080
> 
> 标签：grails, asyncfileupload

在 grails 中是否存在真正的异步/ajax 文件上传，它连接到默认的“忙碌”微调器（显示在其他 ajax 调用上的微调器）？

或者，如果我想在文件上传期间显示微调器，我需要明确调用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T11:53:32.220

*由于交易所背后的一些复杂性和限制，这是您通常需要*第三方帮助 的事情之一。

一些插件可用于 jquery 使用 Flash 来实现这一点，但我更喜欢避免使用 Flash 的任何东西（个人喜好）。查看[Valums Ajax-Upload](http://valums.com/ajax-upload/)我已经在我的生产站点中使用了大约一年，它运行良好且易于使用。我最喜欢这个插件的一点是它对大多数网站的设计和布局都不显眼。

此外，这是一个常见的问题。看看这些答案以及...

*   [Stackoverflow - 是否可以使用 Ajax 进行文件上传？](https://stackoverflow.com/questions/543926/is-it-possible-to-use-ajax-to-do-file-upload)
*   [Stackoverflow - 远程文件上传](https://stackoverflow.com/questions/613958/remote-file-upload-in-grails)
*   [Stackoverflow - Ajax 文件上传](https://stackoverflow.com/questions/2751795/ajax-file-upload)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:06:18.197

杰夫，

我会这样编码...

1.  仅从用户那里获取文件路径。
2.  将文件路径发送到 fileupload 闭包/方法，并在异步块中进行文件读取和保存。
3.  您可能需要为此使用[Executor 插件](http://www.grails.org/plugin/executor)来实现异步功能。
4.  在这种情况下，您不需要显示微调器图像。因为提交文件路径很简单，响应也很快。

如果您想在代码中显示自己，则必须调用微调器。如果要显示图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-22T11:53:57.517

您可以使用 XMLHttpRequest，这是我通过拖放完成的项目的完整代码：

* * *

## **HTML**

```
<div id="drop_zone">Drag and drop your file here or click</div>
<input id="curriculumUploader" type="file" name="curriculum" style="display:none;"/> 
```

* * *

## **JAVASCRIPT**

```
 function uploadCurriculum(file) {
        var xmlhttp;
        if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {// code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }

        //FormData will contain the post params
        var form = new FormData();

        xmlhttp.onreadystatechange = function() {
            //Handle response if everything is right
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                //This is the element where i will put my response
                var element = document.getElementById('curriculum');
                //The response is given in the property responseText
                element.innerHTML = xmlhttp.responseText;
                //If you response has javascript elements, you need to place them in the header to make client compile them
                var scriptElements = element.getElementsByTagName('SCRIPT');
                for (i = 0; i < scriptElements.length; i ++) {
                    var scriptElement = document.createElement('SCRIPT');
                    scriptElement.type = 'text/javascript';
                    if (!scriptElements[i].src) {
                        scriptElement.innerHTML = scriptElements[i].innerHTML;
                    } else {
                        scriptElement.src = scriptElements[i].src;
                    }
                    document.head.appendChild(scriptElement);
                }
            }
        }
        //Put your params in the url if you want to send them by GET
        xmlhttp.open("POST", window.appContext + "/controller/action/" + someParams, true);
        xmlhttp.setRequestHeader("X-Requested-With", "XMLHttpRequest");
        //add the file to the form to send by POST
        form.append('curriculum', file);
        xmlhttp.send(form);
    }

    function handleFileSelect(event) {
        handleDragOver(event);

        var files = event.target.files || event.dataTransfer.files;

        if (files.length > 0) {
            parseFile(files[0]);
        }
    }

    function handleDragOver(event) {
        event.stopPropagation();
        event.preventDefault();
        if (event.type == "dragover") {
            event.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
            addClass(event.target, "hover");
        } else {
            removeClass(event.target, "hover");
        }
    }

    function showFileSelect() {
        document.getElementById('curriculumUploader').click();
    }

    function parseFile(file) {
        if (file != null && file.size > 0) {
            uploadCurriculum(file)
        } else {
            console.log('Invalid file');
        }
    }

    // Setup the dnd listeners.
    var dropZone = document.getElementById('drop_zone');
    if (dropZone != null) {
        dropZone.addEventListener('dragover', handleDragOver, false);
        dropZone.addEventListener("dragleave", handleDragOver, false);
        dropZone.addEventListener('drop', handleFileSelect, false);
        dropZone.addEventListener('click', showFileSelect, false);
    }

    var inputelement = document.getElementById('curriculumUploader');
    inputelement.addEventListener('change', handleFileSelect, false); 
```

* * *

## **CSS**

```
 #drop_zone {
        padding: 15px;
        text-align: center;
        border: 1px dashed #4b9df2;
        color: #4b9df2;
        cursor: pointer;
        transition: all linear 0.2s;
    }

    #drop_zone.hover {
        border: 1px dashed #C99F23;
        color: #C99F23;
    } 
```

# javascript - 清除所有表单字段后刷新页面（jquery）

> ID：10150374
> 
> 赞同：0
> 
> 时间：2012-04-14T02:00:37.607
> 
> 标签：javascript, jquery, input, refresh

清除所有表单字段后是否可以刷新页面？这是一个单独的函数还是可以添加到我现有的脚本中。

```
function clear_form_elements(ele) {
 $(ele).find(':input').each(function() {
 switch(this.type) {
    case 'password':
    case 'select-multiple':
    case 'select-one':
    case 'text':
    case 'textarea':
        $(this).val('');
        $(this).removeAttr("style");
        break;
    case 'checkbox':
    case 'radio':
        this.checked = false;
}
});

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T02:10:59.007

我不知道这是否真的有效。但你也可以在 jquery 中这样做：

```
$('#PageRefresh').click(function() {

              location.reload();

    }); 
```

这是相当容易和直接的。

# ruby - 如何使用 ruby 使用安全访问签名访问和写入 Azure blob 的内容？

> ID：10150376
> 
> 赞同：0
> 
> 时间：2012-04-14T02:00:45.957
> 
> 标签：ruby, azure

我有几个 Azure 共享访问签名需要访问、列出 blob，然后导出内容。我希望我可以编写一个简单的 ruby​​ 脚本并在 Mac 上运行它。

有人可以分享示例代码吗？它基本上是带有签名的 URL 的“GET”，我认为从命令终端我可以使用 curl，但不知道如何使用 Ruby 来更容易地循环并在以后扩展它。

我也愿意接受 bash 脚本。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T08:26:53.543

对谷歌的快速检查返回了[https://github.com/johnnyhalife/waz-storage](https://github.com/johnnyhalife/waz-storage)。你能检查一下这个宝石吗？

# powershell - 命名参数在我的脚本中不起作用

> ID：10150377
> 
> 赞同：0
> 
> 时间：2012-04-14T02:01:12.803
> 
> 标签：powershell

我正在尝试编写一个带有 -Computername 参数的 PS 函数。这是我正在使用的代码：

```
function Get-Foo {
param(
    [Parameter(Mandatory=$False,Position=0,ValueFromPipeline=$True,ValueFromPipelineByPropertyName=$True)]
    [string[]]$Computername = $env:COMPUTERNAME
) 
```

但是，当我运行该函数时，`Get-Foo -Computername BAZ`它从不传递命名参数 BAZ，而是始终使用`$env:COMPUTERNAME`. 我通常是 PowerShell 的新手，而且绝对是编写函数的新手，所以希望有人能很快看出我在哪里出错了。我从另一个有效的脚本中剪切并修改了该`param`行，所以我不知道为什么它在这里不起作用......谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T02:14:16.227

你怎么称呼它？它以各种可以设置的方式对我有用：

```
function Get-Foo {
    param(
        [Parameter(Mandatory=$False,Position=0,ValueFromPipeline=$True,ValueFromPipelineByPropertyName=$True)]
        [string[]]$Computername = $env:COMPUTERNAME

    )
    Write-Host $Computername
}

Get-Foo -COmputername "hi"
"hi" | Get-Foo
$obj = New-Object PsObject -Property @{ Computername='hi' }
$obj | Get-Foo 
```

所有这些都输出“hi”。

# xml - xsl:apply-templates 不会遍历 select 给出的每个节点

> ID：10150379
> 
> 赞同：1
> 
> 时间：2012-04-14T02:01:46.920
> 
> 标签：xml, xslt, saxon

我正在使用撒克逊 HE 9-4-0-3J。我的意图是使用`select`on 属性`xsl:apply-templates`来迭代每个`<RECORD>`元素，但只处理 xml 中的单个`<RECORD>`元素。

**xml**

```
<ENVELOPE>
<PRODUCT>
    <HEAD><FLAG>No</FLAG></HEAD>
    <BODY>
        <RECORD><Value>9</Value></RECORD>
        <RECORD><Value>10</Value></RECORD>
        <MISC>9</MISC>
    </BODY>
</PRODUCT> 
```

**xslt 2.0**

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/ENVELOPE">
<Interface>
   <Data><xsl:apply-templates select="PRODUCT"/></Data>
</Interface>
</xsl:template>

<xsl:template match="PRODUCT">
   <xsl:choose>
      <xsl:when test="HEAD/FLAG='Yes'">
         <xsl:attribute name="Match">Affirmative</xsl:attribute>
         <xsl:apply-templates select="BODY/RECORD" mode="affr"/>
      </xsl:when>
      <xsl:when test="HEAD/FLAG='No'">
         <xsl:attribute name="Match">Negative</xsl:attribute>
         <xsl:apply-templates select="BODY/RECORD" mode="neg"/>
      </xsl:when>
   </xsl:choose>
</xsl:template>

<xsl:template match="RECORD" mode="affr">
   <xsl:attribute name="Value"><xsl:value-of select="Value"/></xsl:attribute>
</xsl:template>

<xsl:template match="RECORD" mode="neg">
   <xsl:attribute name="Value"><xsl:value-of select="Value"/></xsl:attribute>
</xsl:template>

</xsl:stylesheet> 
```

**输出**

```
<Interface>
      <Data Match="Negative" Value="9"/> <!-- this line doesn't appear, I want it to -->
      <Data Match="Negative" Value="10"/>
</Interface> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T03:33:02.600

`<DATA...>`匹配时会生成输出标签`<ENVELOPE...>`，因此只能有这些输出之一。任何`<xsl:attribute>`指令都只是添加到这个输出标签，后面的值会覆盖前面的值。

您必须显式生成`DATA`要输出的标签，如下所示：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xs="http://www.w3.org/2001/XMLSchema" exclude-result-prefixes="xs" version="2.0">

  <xsl:output method="xml" indent="yes"/>
  <xsl:template match="/ENVELOPE">
    <Interface>
      <xsl:apply-templates select="PRODUCT"/>
    </Interface>
  </xsl:template>

  <xsl:template match="PRODUCT">
    <xsl:variable name="flag">
      <xsl:choose>
        <xsl:when test="HEAD/FLAG='Yes'">Affirmative</xsl:when>
        <xsl:when test="HEAD/FLAG='No'">Negative</xsl:when>
      </xsl:choose>
    </xsl:variable>

    <xsl:apply-templates select="BODY/RECORD">
      <xsl:with-param name="flag"><xsl:value-of select="$flag"/></xsl:with-param>
    </xsl:apply-templates>

  </xsl:template>

  <xsl:template match="RECORD">
    <xsl:param name="flag"/>
    <Data Value="{Value}" Match="{$flag}"/>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T03:40:39.743

**问题是您正在创建两个具有相同名称的属性**- `Value`。在格式良好的 XML 文档中，一个元素不能有多个同名属性。

**引用[W3C XSLT 2.0 规范](http://www.w3.org/TR/2007/REC-xslt20-20070123/#constructing-complex-content)**（这在 XSLT 1.0 中也完全相同）：

> *9.如果结果序列中的属性A与随后出现在结果序列中的另一个属性B同名，则从结果序列中丢弃属性*A。

因此，每当 XSLT 为一个元素生成多个同名属性时，只有最后一个属性被复制到输出中——这就是您所看到的。

**这是一个简短的解决方案（只有两个模板，没有条件，没有参数）**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:variable name="vDoc" select="/"/>

 <xsl:variable name="vMatch" select=
 "('Affirmative', 'Negative')[2 - number($vDoc/*/*/HEAD/FLAG eq 'Yes')]"/>

 <xsl:template match="/*">
  <Interface>
    <xsl:apply-templates select="*/BODY/RECORD"/>
  </Interface>
 </xsl:template>

 <xsl:template match="RECORD">
  <Data Match="{$vMatch}" Value="{Value}"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<ENVELOPE>
    <PRODUCT>
        <HEAD>
            <FLAG>No</FLAG>
        </HEAD>
        <BODY>
            <RECORD>
                <Value>9</Value>
            </RECORD>
            <RECORD>
                <Value>10</Value>
            </RECORD>
            <MISC>9</MISC>
        </BODY>
    </PRODUCT>
</ENVELOPE> 
```

**产生了想要的正确结果**：

```
<Interface>
   <Data Match="Negative" Value="9"/>
   <Data Match="Negative" Value="10"/>
</Interface> 
```

# entity-framework - EF 的 DbContext 是否应该包含所有表？

> ID：10150383
> 
> 赞同：7
> 
> 时间：2012-04-14T02:02:36.270
> 
> 标签：entity-framework, dbcontext

我是 EF4 的新手，我正在尝试找出创建 DbContext 类的最佳方法。

将我的所有表/实体放入一个且只有一个 DbContext 类中是否有任何问题（特别是性能），如下面的代码？

```
public class AllInOneDb : DbContext
{
    public DbSet<Customer> Customers{ get; set; }
    public DbSet<Address> Addresses{ get; set; }
    public DbSet<Order> Order{ get; set; }
    public DbSet<Product> Products{ get; set; }
    public DbSet<Category> Categories{ get; set; }
    // and more and more entities...
} 
```

或者我应该根据功能子集对我的类进行建模？

```
public class CustomerDb : DbContext
{
    public DbSet<Customer> Customers{ get; set; }
    public DbSet<Address> Addresses{ get; set; }
    public DbSet<Order> Order{ get; set; }
}

public class ProductDb : DbContext
{
    public DbSet<Product> Products{ get; set; }
    public DbSet<Category> Categories{ get; set; }
    public DbSet<Order> Order{ get; set; } // look Order entity again!
} 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T11:32:24.510

如果您有具有特定业务逻辑的子区域，则可以将其拆分为多个`DbContext`. （*这些较小的上下文遵循一种对领域驱动设计至关重要的模式，称为有界上下文*）。创建针对这些不同进程而不是一个通用上下文的 DbContext 有许多好处。随着您的应用程序的增长，维护每个上下文以及在其中找到您需要的逻辑将会变得更加容易。（比添加或修改单个`DbContext`具有许多`DbSet`属性和许多类的流畅配置的现有逻辑更好）

性能是另一个考虑因素。当 Entity Framework 创建上下文的内存模型时，上下文越大，用于生成和维护该内存模型的资源就越多。

如果要`Order`在多个上下文之间共享实例（），实体一次只能附加到一个上下文。首先从 Customer DbContext 中分离 Order，然后将 Order 附加到 Product DbContext。您应该小心（或避免）将已添加、已修改或已删除的实体从一个上下文移动到另一个上下文。

```
Order order;
using (var custDb = new CustomerDb()){
   order = custDb.FirstOrDefault(o=>OrderId == "orderid");
}
using (var prodDB = new ProductDb()){
   prodDB.Attach(order);
   ...
} 
```

# c# - 从对象中拆箱值类型

> ID：10150385
> 
> 赞同：6
> 
> 时间：2012-04-14T02:03:08.807
> 
> 标签：c#, .net, clr, unboxing

我一直在尝试理解这一段，但不知何故我无法在脑海中虚拟化它，请有人详细说明一下：

> 拆箱与装箱并不完全相反。拆箱操作比装箱成本低得多。拆箱实际上只是获取指向对象中包含的原始值类型（数据字段）的指针的操作。实际上，指针指向已装箱实例中未装箱的部分。因此，与装箱不同，拆箱不涉及复制内存中的任何字节。做出这一重要说明后，请务必注意，拆箱操作通常会在复制字段之后进行。
> 
> 杰弗里里希特 (2010-02-05)。通过 C# 进行 CLR（Kindle 位置 4167-4171）。OReilly Media - A. Kindle 版。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T02:15:13.110

为了对 int 进行装箱，您需要在堆上创建一个足够大的对象，以容纳结构所保存的所有数据。在堆上分配一个新对象意味着让 GC 找到一个位置，并让 GC 在其生命周期期间和之后清理它/移动它。这些操作虽然不是*超级*昂贵，但也不便宜。

可以这么说，要对值类型进行拆箱，您所做的就是取消引用指针。您只需要查看参考（这就是`object`您所拥有的）即可找到实际值的位置。在内存中查找值非常便宜，这就是为什么那段说“拆箱”很便宜。

***更新：***

虽然未装箱的值类型通常会在未装箱后立即复制到其他位置，但情况并非总是如此。考虑以下示例：

```
public struct MyStruct
{
  private int value = 42;
  public void Foo()
  {
    Console.WriteLine(value);
  }
}

static void Main()
{
  object obj = new MyStruct();
  ((MyStruct)obj).Foo();
} 
```

被`MyStruct`装箱，`obj`但是当它被拆箱时，它永远不会被复制到任何地方，只是在它上面调用一个方法。同样，您可以将属性/字段从结构中拉出并仅复制其中的一部分，而无需复制整个内容。这可能看起来有点做作，但仍然不完全荒谬。也就是说，正如您的报价所暗示的那样，在您将其拆箱后，它仍然可能会复制该结构。

# ruby-on-rails - 使用纸迹，获得与 object_changes 的区别？

> ID：10150392
> 
> 赞同：7
> 
> 时间：2012-04-14T02:04:15.080
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我正在使用带有 Rails 3.1 的纸迹，并希望获得模型之间的差异。似乎通过将 object_changes 作为文本列添加到版本来支持这一点。我已经这样做了，但是没有保存变更集。还有其他需要做的步骤吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-31T12:49:56.297

您需要重新启动服务器以获取书面记录以获取更改

# iphone - 为什么我的 Storyboard 无法在模拟器上启动？

> ID：10150394
> 
> 赞同：0
> 
> 时间：2012-04-14T02:04:52.880
> 
> 标签：iphone, ios, ipad, ios5, storyboard

我建立了一个这样的故事板：

![在此处输入图像描述](../Images/8341841ebf2798ed53497441ed4de22a.png)

我没有写一行代码，我的设置似乎是正确的。

![在此处输入图像描述](../Images/e55a230c58645c6359c4c75643ae8f07.png)

那么为什么我总是在模拟器上得到一个空白屏幕？

![在此处输入图像描述](../Images/164695035b16d6b023d9e97afba2b1b3.png)

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T02:48:30.797

您的应用程序委托是否明确创建`*window`？如果是这样，请删除该行代码。

```
// self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]]; 
```

但保留属性定义：

```
@property (strong, nonatomic) UIWindow *window; // keep this 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T13:41:30.397

@oratis 你签入 AppDelegate @synthesize window = _window; 这可能是无法识别选择器的原因

# iphone - UIImage stretchableImageWithLeftCapWidth

> ID：10150396
> 
> 赞同：7
> 
> 时间：2012-04-14T02:04:58.567
> 
> 标签：iphone

在 iOS 中，是否有任何 UIImage 支持 stretchableImageWithLeftCapWidth: ，这是否意味着自动调整 uiimage 的大小？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-14T02:41:52.050

首先，这是不推荐使用的，取而代之的是更强大的`resizableImageWithCapInsets:`. 但是，这仅受 iOS 5.0 及更高版本支持。

`stretchableImageWithLeftCapWidth:topCapHeight:`不会调整您调用它的图像的大小。它*返回一个新的 UIImage*。所有 UIImage 都可以以不同的大小绘制，但是一个加盖的图像通过在角落绘制它的大写来响应调整大小，然后填充剩余的空间。

这什么时候有用？当我们想用图像制作按钮时，如[本教程中的 iOS 5 版本](http://iphonedevelopertips.com/user-interface/ios-5-uiimage-and-resizableimagewithcapinsets.html)。

下面的代码是一个 UIView方法，它说明了常规图像和带大写的可拉伸图像`drawRect`之间的区别。`UIImage`用于的图像`stretch.png`来自[http://commons.wikimedia.org/wiki/Main_Page](http://commons.wikimedia.org/wiki/Main_Page)。

```
- (void) drawRect:(CGRect)rect;
{
    CGRect bounds = self.bounds;

    UIImage *sourceImage = [UIImage imageNamed:@"stretch.png"];
    // Cap sizes should be carefully chosen for an appropriate part of the image.
    UIImage *cappedImage = [sourceImage stretchableImageWithLeftCapWidth:64 topCapHeight:71];

    CGRect leftHalf = CGRectMake(bounds.origin.x, bounds.origin.y, bounds.size.width/2, bounds.size.height);
    CGRect rightHalf = CGRectMake(bounds.origin.x+bounds.size.width/2, bounds.origin.y, bounds.size.width/2, bounds.size.height);
    [sourceImage drawInRect:leftHalf];
    [cappedImage drawInRect:rightHalf];

    UIFont *font = [UIFont systemFontOfSize:[UIFont systemFontSize]];
    [@"Stretching a standard UIImage" drawInRect:leftHalf withFont:font];
    [@"Stretching a capped UIImage" drawInRect:rightHalf withFont:font];
} 
```

输出：

![带有和不带大写字母的 Wikimedia Commons 徽标](../Images/4d68b66ef7015f34a5f76a8551d9f827.png)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-03T13:05:37.900

我写了一个保持兼容性的类别方法

```
- (UIImage *) resizableImageWithSize:(CGSize)size
{
    if( [self respondsToSelector:@selector(resizableImageWithCapInsets:)] )
    {
        return [self resizableImageWithCapInsets:UIEdgeInsetsMake(size.height, size.width, size.height, size.width)];
    } else {
        return [self stretchableImageWithLeftCapWidth:size.width topCapHeight:size.height];
    }
} 
```

只需将其放入您已经拥有的 UIImage 类别（或创建一个新类别），这仅支持旧方式可拉伸调整大小，如果您需要更复杂的可拉伸图像调整大小，您只能在 iOS 5 上使用**resizableImageWithCapInsets:**直接执行此操作

# jquery - Jquery验证自定义规则：单击复选框时，需要一个文本框

> ID：10150399
> 
> 赞同：0
> 
> 时间：2012-04-14T02:05:55.937
> 
> 标签：jquery, jquery-validate

如何设置规则以便：

对于一个复选框 a，当它被点击时，文本框 a 是必需的

并且复选框的数量是灵活的，我不能一个一个地定义复选框

但是复选框的数量等于 textbox ，这是肯定的

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:20:17.297

AFAIK，您将复选框与文本框一起呈现。因此，这两者将始终彼此相等。因此，当您单击复选框时，它的配对文本框也会自动出现。否则，没有文本框将不会呈现任何复选框。这样您就可以避免再次检查。希望这对您有所帮助。

# iphone - （viewConroller.view removeFromSuperview）线程：1 EXC_BAD_ACCESS（代码= 1，地址= 0x6000000008）

> ID：10150406
> 
> 赞同：0
> 
> 时间：2012-04-14T02:07:35.230
> 
> 标签：iphone, objective-c, ios, ipad

(^.^) 嗨对不起我的英语不好。

嗨我有下一个问题我创建 2 个按钮第一个按钮创建一个视图控制器并将他的视图添加到其他视图控制器第二个按钮我释放创建的视图控制器并从父级删除视图。如果我更快地点击 2 个按钮会崩溃，并显示帖子标题中的消息，这就是代码

（我现在这是因为内存问题，但问题是什么？？我这样做只是为了查看 XCODE-PROFIL-INSTRUMENTS-Allocations 的内存管理，请帮助）：

```
- (IBAction)create:(id)sender{
       vc = nil;
       vc = [[[VC alloc] initWithNibName:@"VC" bundle:[NSBundle mainBundle]] retain];
      [_VW addSubview:vc.view];
} 
```

并用这个按钮杀死：

```
- (IBAction)kill:(id)sender{
      [vc.view removeFromSuperview];
      [vc release];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T02:32:05.953

当您快速按下按钮时，至少在终止按钮的情况下，`release`无论您按下按钮多少次，它都会尝试查看视图（假设您只按下一次按钮时代码有效）。EXC_BAD_ACCESS 代码意味着您正在尝试访问一些已被释放的内存位置。

防止这种情况的最佳方法是使用该`[NSButton setEnabled:(BOOL)enabled]`方法。按下创建按钮时，启用终止按钮并禁用创建按钮。当按下 kill 按钮时，禁用 kill 按钮并启用 create 按钮。这将防止意外的额外分配或释放。

`retain`此外，在您的 create 方法中，您应该在`vc`'s allocation 行中删除该额外内容。`alloc`自动增加保留计数（到 1），并且额外的保留将其增加到 2。这样，当按下终止按钮时，对象被释放一次，但保留计数仍然是 1，创建一个内存泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:50:07.623

这似乎`vc`是一个 iVar，所以你不应该发送方法`release`。`kill:`所以只需删除代码行：

```
[vc release]; 
```

并将其添加到您的`dealloc`方法中。

* * *

请注意，最好使用如下代码`create:`

```
if (vc == nil)
  vc = [[[VC alloc] initWithNibName:@"VC" bundle:[NSBundle mainBundle]] retain];
[_VW addSubview:vc.view]; 
```

否则，当你`vc`的不是 nil 时，它会导致内存泄漏。

# jquery - 在数组中加载图像块的 jQuery 函数

> ID：10150409
> 
> 赞同：0
> 
> 时间：2012-04-14T02:08:19.460
> 
> 标签：jquery, arrays, image, window, fade

真的用这个打了我的头。我有可变数量的图像以 5 个为一组加载到页面中。在页面加载时，我试图加载前 5 个，之后的每个组都将通过单击链接添加。

我的逻辑是这样的：

*   **在页面加载**时创建一个包含所有列表元素的数组

***   **将数组的前 10 个传递给一个函数，该函数将 li 转换为图像并在窗口加载**时将其淡入页面

    ***   **在用户单击**加载更多按钮时，从数组中传递额外的 5 组**** 

 ****我的代码不遵循上述逻辑但确实转换了 li 并将它们淡入如下：

查看关于 jsfiddle 的完整评论混乱：http: [//jsfiddle.net/danielredwood/qntMg/](http://jsfiddle.net/danielredwood/qntMg/)

感谢您的帮助！

```
function buildImg() {
    $('.userGallery li').each(function(){
        var loc = $(this).find('a').attr('href'),
            ttl = $(this).find('a').attr('title'),
            img = $('.userGallery').append($('<img/>', { class: 'user', src: loc, alt: ttl })),
            usr = $('.user');

        $(this).remove();

        usr.each(function(i){
            $(this).delay(200*i).animate({ opacity:1 },400);
        });
    });
}

    var elm = $('.userGallery li'),
        cnt = 0,
        tns = [];

    for(i=0;i<elm.length;i++){
       if(cnt==10){
         buildImg(tns);
         tns=[];   
       }
       tns[cnt++]=elm[i].image;
    }

    buildImg(tns); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T02:39:08.540

这是一个更简单的方法来做到这一点。解释一下，`buildImg()`找到所有需要的链接并为每个链接创建图像对象并将它们放入一个数组中。

`loadMore()`将接下来的 10 张图像加载到图库中并启动它们的`.fadeIn()`动画。 `loadMore()`最初调用一次（加载前 10 张图像），然后在每次按下 loadMore 按钮时加载接下来的 5 张图像。

因为您的 jsFiddle 中只有 10 个图像，所以我复制了它们，以便您可以看到它如何处理超过 10 个图像。

一切都封装在一个 document.ready 处理程序中，以便它在 DOM 加载时启动，因此我们的全局变量不是真正的全局变量（因此它们位于函数块内）。

```
$(document).ready(function() {
    var imgInfo = [];
    var imgCntr = 0;
    function buildImg() {
        $('li a').each(function(){
            var img = new Image();
            img.src = this.href;
            img.alt = this.title;
            img.className = 'user';
            img.style.display = "none";
            imgInfo.push(img);
        });
    }

    function loadMore(num) {
        var gallery = $('.userGallery');
        var delay = 0;
        for (len = Math.min(imgInfo.length, imgCntr + num); imgCntr < len; imgCntr++) {
            gallery.append(imgInfo[imgCntr]);
            $(imgInfo[imgCntr]).delay(delay).fadeIn(400);
            delay += 400;
        }
    }

    buildImg();
    loadMore(10);

    $(".loadMore").click(function() {
        loadMore(5);
        return(false);
    });
});​ 
```

在这里工作演示：http: [//jsfiddle.net/jfriend00/h2GVz/](http://jsfiddle.net/jfriend00/h2GVz/)

这是一个更复杂的版本，它在加载图像之前不会开始为图像设置动画，以防加载时间比预定的动画时间长。你可能不需要这个额外的复杂性，但我对如何做到这一点很感兴趣，所以我写了它：http: [//jsfiddle.net/jfriend00/WAuuB/](http://jsfiddle.net/jfriend00/WAuuB/)****

# c++ - 不能在另一个类中使用一个类作为模板类型？

> ID：10150410
> 
> 赞同：1
> 
> 时间：2012-04-14T02:08:20.300
> 
> 标签：c++

我有一个类Stack，使用模板，它的方法之一是“push”，它写在下面：

```
template <class T>
void Stack<T>::push(T _data){
    Node<T>* temp = new Node<T>;
    temp->data = _data;
    temp->next = head;
    head = temp;
} 
```

堆栈适用于`int`, `double`, `string`, `char`.... 但它说

```
prog.cpp:32: note: synthesized method ‘Node<Tree>::Node()’ first required here 
```

当我使用类“树”作为数据类型时。我不明白，为什么它适用于“字符串”而不适用于“树”，它们都是类，而不是原始类型。

[http://ideone.com/NMxeF](http://ideone.com/NMxeF) （忽略另一个错误，我的 IDE 在第 32 行只给出一个错误和一些警告）

帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T02:13:55.997

阅读实际代码后进行编辑（上面显示的“注释”对真正的问题具有相当大的误导性）。

查看您尝试使用的代码，`new Node<T>;`它需要 T 的默认构造函数（在本例中为`Tree`），因为您的 Node 模板包含 T 的实例：

```
struct Node {
    T data;    // <--- instance of T, not being initialized in your code.
    Node *next;
}; 
```

`Tree`没有默认构造函数，因此失败（并且注释向您显示需要默认构造函数的位置）。

关于如何解决这个问题，您有几个选择。最明显的是 a`Node`持有一个指针或对 a 的引用，`T`而不是包含 T 的实际实例。

另一种方法是让`Node`的构造函数引用一个（可能是 const）T，并将该 T 复制到节点中：

```
class Node { 
    T data;
    Node *next;
public:
    Node(T const &dat) : data(dat), next(0) {}
}; 
```

这两种方法之间的选择是相当基本的。如果您让 Node 存储一个指向 T 的指针/引用，那么只要 Node 存在，调用代码将负责确保传递的对象保持有效。节点和调用代码将共享对 T 的单个实例的访问。

相反，如果你将传递的对象复制到 Node 中，那么这个副本将在销毁时`Node`被销毁。您传递给节点的原始 T （在您的情况下为树）仍将由调用代码负责，并且`Node`将对其副本负责。

在*通常*情况下，您倾向于支持后者——它提供更清晰的语义，并保持数据的所有权清晰。但是，在树的情况下，如果可以避免的话，您可能不想将整个树复制到节点中。一种折衷的立场是使用类似 a 的东西`Node<shared_ptr<Tree> >`。shared_ptr 可以保持快速且廉价的复制，同时避免编写仅适用于少数几种对象和情况的节点。这也非常明确地表明您只存储了一个指针，该指针提供对原始对象的共享访问。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-14T02:14:40.923

你有默认构造函数`Tree`吗？如果不是，那可能是您的问题： Node 在其`data`成员中包含一个`Tree`类型，当您调用`new Node<Tree>`.

要解决此问题，您可以修改`Node`的构造函数以将`data`and`next`作为参数，因此您不需要在其模板类型上使用默认构造函数（您仍然需要赋值运算符可用）。

# java - 当 Object 是 Java 方法中的返回类型时返回特定类型

> ID：10150414
> 
> 赞同：1
> 
> 时间：2012-04-14T02:09:23.810
> 
> 标签：java, object, methods, return

我有这样的`getValue`方法

```
public Object getValue() {
     return Integer.valueOf(0); 
```

}

并在 main 方法中调用：

```
getValue() + 5; 
```

这是简化的。

如何在不强制转换 main 方法的情况下使其工作，而是如何在可能的情况下强制转换返回类型？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T02:15:57.723

您可以使用泛型：

```
public class MyClass<T extends Number>{

  public T getValue(){
    //do something here
  }
}

MyClass<Integer> foo = new MyClass<Integer>();
foo.getValue()+5; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T02:16:36.070

如果你的方法返回一个对象，你将不得不在某个时候或另一个时候强制转换以使用 Integer、Double 等特定于类的函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T02:16:09.577

我想你不应该那样做，如果你写了这个函数 public Object getValue() 那么为什么不把它改成 public Integer getValue() 并返回 Integer。

如果您还期望其他类型，则重载方法 public String getValue()、public Double getValue() 等。使用工厂模式来决定调用哪个方法。

如果您不想强制转换，那么您不能使用 Object 作为返回类型并且仍然使用 getValue() + 5;

我也喜欢elivine的回复

# c++ - 使用 lm-sensors 获取温度

> ID：10150415
> 
> 赞同：7
> 
> 时间：2012-04-14T02:09:28.257
> 
> 标签：c++, c

我已经做了一个应用程序来与一个显示我在 LCD 中发送的信息的 arduino 板进行通信。问题是我想发送 CPU 温度，我知道最好是使用 lm-sensors（我正在使用 linux）但不知道如何，它没有任何示例，所以，有人知道如何使用它或我在哪里可以得到一个例子？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T02:27:39.090

如果 lm_sensors 模块已经加载，温度应该可以在来自 sysfs 的文件中访问（例如：）`/sys/class/hwmon/hwmon0/device/temp1_input`，您可以使用标准 C/C++ 文件函数读取这些文件。

[http://www.kernel.org/doc/Documentation/hwmon/sysfs-interface](http://www.kernel.org/doc/Documentation/hwmon/sysfs-interface)

# python - 在 Ubuntu 11.10 上安装 wxPython

> ID：10150423
> 
> 赞同：1
> 
> 时间：2012-04-14T02:11:31.250
> 
> 标签：python, ubuntu, installation, wxpython

希望有人帮助我安装 wxPython。我有 ubuntu 11.10 并且没有构建包。我使用此页面（[http://wxpython.org/BUILD.html](http://wxpython.org/BUILD.html)）作为安装后安装的指导，我运行

```
>python

>>>import wx

 Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "wx/__init__.py", line 45, in <module>
    from wx._core import *
  File "wx/_core.py", line 4, in <module>
    import _core_
ImportError: libwx_gtk2u_adv-2.9.so.3: cannot open shared object file: No such file or directory 
```

应该怎么做才能修复它？谢谢你！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T03:10:16.253

按照[在 Ubuntu 或 Debian 上安装的说明进行操作](http://wiki.wxpython.org/InstallingOnUbuntuOrDebian)。

编辑：实际上，您甚至不需要这样做，因为它[位于主存储库中](http://packages.ubuntu.com/cgi-bin/search_packages.pl?keywords=wxPython&searchon=all&subword=1&version=dapper&release=all)：

```
sudo aptitude install python-wxgtk2.8 
```

# java - 可以用 JPA / Hibernate 做到这一点

> ID：10150424
> 
> 赞同：0
> 
> 时间：2012-04-14T02:11:44.530
> 
> 标签：java, hibernate, jpa, jpa-2.0

我正在使用 postgres 并将 JPA 与 Hibernate 一起使用，在 postgres 和其他 DBMS 中可以做到这一点：

```
SELECT *, function(parameter) AS xyz FROM table WHERE condition 
```

我的问题是这样的，查询可以显示一个额外的字段（xyz），虽然没有这样的列。我可以用 Hibernate JPA 做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T05:54:13.720

如果您没有映射实体，则需要使用本机查询：

```
Query query = entityManager
      .createQuery(
            "SELECT t.*, myfunction(:parameter) FROM table t WHERE t.attr = condition");
query.setParameter("parameter", value);
List resultList = query.getResultList(); 
```

否则，如果您有一个映射实体，您可以使用类型化查询或条件 API 来执行此操作。

使用类型化查询：

```
TypedQuery<Object[]> query = entityManager
      .createQuery(
            "SELECT t.*, FUNC('MyFunction', :parameter) FROM table t WHERE t.attr = condition",
            Object[].class);
query.setParameter("parameter", value);
List<Object[]> resultList = query.getResultList(); 
```

使用标准 API：

```
CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
CriteriaQuery<Tuple> query = criteriaBuilder.createTupleQuery();
Root<Table> root = query.from(Table.class);
Expression<Long> funcExpr = criteriaBuilder.function("myfunction",
      Long.class, root.get("parameter"));
query.multiselect(query.select(root), funcExpr);
List<Tuple> resultList = entityManager.createQuery(query)
      .getResultList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:34:04.097

通过使用 org.hibernate.SQLQuery，您可以使用 Hibernate 创建本机 SQL 查询。然后，您以与普通 Hibernate 查询相同的方式执行这些查询。显然，您将失去让 Hibernate 和 JPA 管理您的查询的许多好处，但如果它们不支持您想要的功能，它可能是唯一的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T06:07:58.713

另一种解决方案是使用公式，如果您在表的某些字段上调用函数，并且您总是想要函数的结果，您可以映射实体中的另一个属性并使用`@Formula("myFunction(field1, field2)")`. Hibernate 会将它添加到所有具有您的实体的查询中。

# c++ - NULL 指针调用立即失败

> ID：10150426
> 
> 赞同：0
> 
> 时间：2012-04-14T02:11:50.253
> 
> 标签：c++, visual-studio-2008

我有一个名为 pTest 的 NULL 指针。如果使用指针调用函数，是否可以使应用程序立即崩溃。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T03:08:26.730

您可以创建一个捕获取消引用的受保护指针类（一种智能指针形式），而不是使用原始指针。

```
#include <stdexcept>

template<typename T>
class CheckedPointer
{
    T * ptr;
public:
    CheckedPointer(T * init = NULL) : ptr(init) {}
    T * operator->() const
    {
        if (ptr == NULL)
            throw std::runtime_error("dereference of NULL pointer");
        return ptr;
    }
    T & operator*() const
    {
        if (ptr == NULL)
            throw std::runtime_error("dereference of NULL pointer");
        return *ptr;
    }
    // ... more members to make this a useful class
};

class Test
{
public:
    void Foo() {}
};

int main()
{
    CheckedPointer<Test> pTest;
    pTest->Foo();
} 
```

[http://ideone.com/R4mUK](http://ideone.com/R4mUK)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T02:36:09.107

你的问题需要澄清。如果 pTest 是指向对象的空指针并且您在其上调用方法，那么我希望您的 VS2008 编译程序在以下情况下自行崩溃：

1.  该方法是虚拟的
2.  该方法尝试访问实例成员

这意味着如果方法调用在语义上是静态的并且不尝试访问实例成员，则该方法调用实际上可能会起作用。此外，这种事情的行为在调试和发布版本之间有所不同。

但是如果*你*想让你的应用程序在尝试调用方法之前/时直接崩溃，那么你可以在每个之前添加断言或条件中止。或者您可以在每个方法的开头添加一个 (this == NULL) 检查（但这不适用于会在到达此点之前触发崩溃的虚拟方法）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T02:54:26.240

您可能想抛出一个异常并且永远不会捕获它。那会让你的程序崩溃。

```
if (pTest == NULL)
  throw std::invalid_argument("null pointer"); 
```

# c++ - 计算数字平方根的程序。

> ID：10150427
> 
> 赞同：1
> 
> 时间：2012-04-14T02:12:05.137
> 
> 标签：c++

我必须编写一个程序，它接受一个数字并输出它的平方根。例如 - 45 --> 3√5。我做了一个程序，但它只返回我输入的相同数字。非常感谢帮助。这是我的代码-->

```
#include<iostream>
using namespace std;

int squarerootfinder(int number, int divisor){
     if(divisor == 1){

            return 1;
     }
     else{

            if((number / (divisor * divisor))% 1 != 0){

                    divisor = squarerootfinder(number, divisor - 1);

            }
            if((number/ (divisor * divisor)) % 1 == 0 ){
            return divisor;

            }

      }

}
int main(){
     int number;
     cout << "Enter a number to find the square root of it \n";
     cin >> number;
     int divisor = number;
     int squareroot;
     squareroot = squarerootfinder(number, divisor);
     cout << squareroot << endl;
     return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T03:53:52.280

此行的两个问题都与整数类型有关：

`if((number / (divisor * divisor))% 1 != 0){`

记住整数运算的结果是整数，那么进入函数的第一组值的值是多少？假设`number`是 5。那么我们有：

`5/(5*5) = 5/25 = 0`

同样的事情也适用于`% 1`. int 总是整数，所以修改 1 总是返回 0。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-05-31T12:54:09.487

这里的问题是使用正确的算法，那就是你需要在你的 squareRootFinder 函数中使用 std 库中的 cmath 头文件。您还可以使用函数来获取整数。这是我的代码。希望能帮助到你。

```
#include <iostream>
#include <cstring>
#include <cmath>

using namespace std;

int getPositiveInt(string rqstNum)
    {
        int num;
        do
        {
           cout << rqstNum << endl;
           cin >> num;
        }while(num == 0);

        return num;
    }

double squareRootFinder(double Num)
    {
        double squareroot;
        squareroot = sqrt(Num);
        return squareroot;
    }

int main()
{
 int Num = getPositiveInt("Enter a number and i'll calculate the squareroot ");
 double squareroot = squareRootFinder(Num);

    // To dispay the answer to two decimal places we cast the squareroot variable
    squareroot *= 100;
    squareroot = (double)((int)squareroot);
    squareroot /= 100;
    cout << squareroot << endl;

   return 0;
} 
```

# c - 指针递增和取消引用（需要左值错误）

> ID：10150428
> 
> 赞同：2
> 
> 时间：2012-04-14T02:12:13.593
> 
> 标签：c, pointers, lvalue, post-increment, pre-increment

我试图了解指针递增和取消引用是如何结合在一起的，我这样做是为了尝试一下：

```
#include <stdio.h>
int main(int argc, char *argv[])
{
    char *words[] = {"word1","word2"};
    printf("%p\n",words);
    printf("%s\n",*words++);
    printf("%p\n",words);
    return 0;
} 
```

我希望这段代码能够执行以下操作之一：

1.  先解引用再增加指针（打印word1）
2.  首先取消引用然后增加值（打印 ord1）
3.  取消引用指针 + 1（打印 word2）

但是编译器甚至不会编译它，并给出这个错误：`lvalue required as increment operand`我在这里做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T02:16:08.320

您需要在第二个 printf 中的指针取消引用周围加上大括号，例如：`printf("%s\n",(*words)++);`另外，如果您试图在列表中获取数字 2，则需要使用前缀增量而不是后缀。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T02:21:13.233

您不能递增数组，但可以递增指针。如果您将声明的数组转换为指针，您将使其工作：

```
#include <stdio.h>
int main(int argc, char *argv[])
{
    const char *ww[] = {"word1","word2"};
    const char **words = ww;
    printf("%p\n",words);
    printf("%s\n",*words++);
    printf("%p\n",words);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T02:18:51.810

`words`是数组的名称，因此`++`没有任何意义。但是，您可以使用指向数组元素的指针：

```
for (char ** p = words; p != words + 2; ++p)
{
    printf("Address: %p, value: '%s'\n", (void*)(p), *p);
} 
```

你当然`2`可以使用更通用的`sizeof(words)/sizeof(*words)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T02:33:28.467

问题在于这一行：

```
printf("%s\n",*words++); 
```

它被读取为`*(words++)`，即增加一个内存块。这没有意义，这有点像尝试这样做：

```
int a = 1;
(&a)++; // move a so that it points to the next address 
```

这在 C 中是非法的。

问题是由C中的数组和指针之间的区别引起的：（基本上）数组是一块内存（在编译时分配），而指针是指向一块内存的指针（不一定在编译时分配） . 使用 C 时这是一个常见的问题，关于它还有其他问题（例如[C：char 指针和数组之间的区别](https://stackoverflow.com/questions/1335786/c-differences-between-pointer-and-array)）。

（其他答案中描述了该修复程序，但基本上您希望使用指向字符串的指针而不是字符串数组。）

# php - 将动态变量插入 HTML 模板...PHP？ASP？冷融合？MySQL？

> ID：10150429
> 
> 赞同：1
> 
> 时间：2012-04-14T02:12:15.323
> 
> 标签：php, asp.net, mysql, html, variables

我看过这个网站，用谷歌搜索，甚至搜索过 adobe 开发者中心，但没有运气。因此，我想我可能不知道要搜索的正确术语，因为我的问题非常直截了当。因此，如果标题具有误导性，我深表歉意。

我想学习如何创建一个 HTML 模板，然后根据需要插入变量，特别是城市和州的名称（对于特许经营权），在适当的地方。

[在意识到我最初的帖子太宽泛后自行编辑]

如何做到这一点，或者更重要的是我应该在查询中使用的术语，以便我找到相关信息，会很棒......

与此相关的是，所有动态脚本语言是否与所有数据库技术兼容（我读过的唯一一本关于 PHP 和 MySQL 的书）？

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T02:37:21.777

互联网中的“新热点”是客户端模板（例如，通过 JavaScript 在浏览器中），*或者*将您的数据保存在 HTML 或 JavaScript 中并根据需要隐藏/取消隐藏，*或者*使用 AJAX/JSON/XML 获取新数据从服务器动态。

Linkedin 切换到客户端模板：[http ://engineering.linkedin.com/frontend/client-side-templating-throwdown-mustache-handlebars-dustjs-and-more](http://engineering.linkedin.com/frontend/client-side-templating-throwdown-mustache-handlebars-dustjs-and-more)

# php - 在 php mysql 数据库中使用时间

> ID：10150435
> 
> 赞同：-1
> 
> 时间：2012-04-14T02:14:04.260
> 
> 标签：php, mysql, database, time

有人对此有任何想法吗？我不知道用什么来代替（1分钟）才能工作； `.$checktime['car_date']`是数据库中的一个值，就像这样 2012-04-14 04:18:14

```
$time=time();

    $checktime=mysql_num_rows($get_cars);
        if($time<$checktime['car_date'] - (1 minute))
        {
        $sqlhour = mysql_query("DELETE FROM car
                    WHERE car_date < current_timestamp - interval '1' minute;");

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T07:22:21.060

您可以直接在 MySQL 中执行此操作，无需在 PHP 中操作日期。

```
DELETE FROM car
WHERE car_date < DATE_SUB( NOW(), INTERVAL 1 MINUTE ); 
```

如果您需要知道要删除的汽车的 ID，则只需先执行 SELECT，即

```
SELECT id
FROM car
WHERE car_date < DATE_SUB( NOW(), INTERVAL 1 MINUTE ); 
```

然后循环并删除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:19:18.763

我相信`$checktime['car_date']`时间就是秒。如果是这样 1 分钟是：

```
60 
```

所以你[会得到](http://php.net/manual/en/function.time.php)：

```
$time=time();

$checktime=mysql_num_rows($get_cars);
   if($time<($checktime['car_date'] - 60)) {
       $sqlhour = mysql_query("DELETE FROM car WHERE car_date < current_timestamp - interval '1' minute;");
    } 
```

**更新**

由于`$checktime['car_date']`变量是一个 sql 时间戳，您应该首先将其转换为`seconds since UNIX epoch`：

```
$currentTime = time();
$carDate = new DateTime($checktime['car_date']);

$checktime = mysql_num_rows($get_cars);
   if($time < ($carDate->format('U') - 60)) {
       $sqlhour = mysql_query("DELETE FROM car WHERE car_date < current_timestamp - interval '1' minute;");
    } 
```

# arrays - Scala在方法中初始化类级数组变量

> ID：10150444
> 
> 赞同：2
> 
> 时间：2012-04-14T02:15:24.607
> 
> 标签：arrays, scala

```
 class Foo() {
 val array  // how do I leave initialization till later?
 def initializeArray(size : Int) = array = Array.ofDim[Int](size)
} 

```

上面的代码不会编译，那么以后如何初始化我的数组呢？

# 编辑

假设我需要读取一个包含整数矩阵的文件，并且我想将矩阵表示为二维数组。当然，我正在解析`Foo`类中的文件，并且在解析完成之前不会知道矩阵的维度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T13:37:13.073

你可以使用一个惰性值，例如

```
scala> class Foo {
     | lazy val array = initialize
     | def initialize = {
     | println("initializing...")
     | new Array[Int](5)
     | }
     | }
defined class Foo

scala> val f = new Foo
f: Foo = Foo@135810c

scala> f.array
initializing...
res46: Array[Int] = Array(0, 0, 0, 0, 0) 
```

现在你已经推迟了数组初始化的时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T02:18:42.823

一种简单的方法是将其初始化为`null`. 为此，您需要指定一个类型，`Array[Int]`并使其成为`var`（而不是`val`），以便您以后可以更改它：

```
class Foo() {
  var array: Array[Int] = null  // how do I leave initialization till later?
  def initializeArray(size : Int) = array = Array.ofDim[Int](size)
} 
```

但是，这在 Scala 中并不是很好的做法。最好使用一个`Option`：

```
class Foo() {
  var array: Option[Array[Int]] = None  // how do I leave initialization till later?
  def initializeArray(size : Int) = array = Some(Array.ofDim[Int](size))
} 
```

这明确地告诉用户，它`array`可能不会被设置为任何东西，并避免`NullPointerException`s。您可以在 StackOverflow 或其他地方阅读更多信息`Option`。

最后，Scala 中最好的设计依赖于*不可变*类。在这种情况下，您将推迟创建，`Foo`直到您真正知道要放入其中的内容。但是，在不了解您的设计的任何其他信息的情况下，很难说如何最好地进行设置。

编辑：根据您的描述，我会将您的设计分为两部分：用于解析文件的方法和`Foo`用于存储最终结果的不可变对象。

```
class Foo(array: Array[Int]) {

}

object Foo {
  def fromFile() = {
     val array: Array[Int] = /* parse file into the right structure */
     new Foo(array)
  }
} 
```

然后你可以说：

```
val foo = Foo.fromFile(filename) 
```

这`foo`将是一个完整的、不可变的`Foo`.

# haskell - 有人可以修复以下 Data.Binary 示例代码吗？

> ID：10150445
> 
> 赞同：2
> 
> 时间：2012-04-14T02:15:37.677
> 
> 标签：haskell

尝试学习如何使用 Data.Binary 并在此处遇到障碍：

[http://www.haskell.org/haskellwiki/Serialisation_and_compression_with_Data_Binary](http://www.haskell.org/haskellwiki/Serialisation_and_compression_with_Data_Binary)

```
D:\Projects\haskell\serialize\ex1.hs:114:26:
    Couldn't match expected type `bytestring-0.9.1.10:Data.ByteString.Lazy.Internal.ByteString'
                with actual type `L.ByteString'
    Expected type: Int
                   -> bytestring-0.9.1.10:Data.ByteString.Lazy.Internal.ByteString
      Actual type: Int -> L.ByteString
    In the return type of a call of `toByteString'
    In the second argument of `(.)', namely `toByteString f'

D:\Projects\haskell\serialize\ex1.hs:122:21:
    Couldn't match expected type `L.ByteString'
                with actual type `bytestring-0.9.1.10:Data.ByteString.Lazy.Internal.ByteString'
    In the first argument of `L.length', namely `fs'
    In the first argument of `(+)', namely `L.length fs'
    In the first argument of `(==)', namely `L.length fs + L.length is'
[Finished] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T02:20:05.603

看起来你的阴谋集团包裹一团糟；您安装了多个版本的`bytestring`软件包，并且它们相互冲突。最可能的情况是该`binary`包依赖于与`bytestring`您在导入时获得的版本不同的版本`Data.ByteString.Lazy`。

最简单的做法可能是从头开始清除您的 Cabal 目录。在 Windows 上，这些目录似乎是`C:\Program Files\Haskell`和. 但是，我认为不加选择地清除前者会完全卸载 Haskell 平台，所以要小心；另一方面，最简单的方法可能是卸载 Haskell 平台并重新开始。（此外，您可能需要先复制文件，以避免覆盖您的 Cabal 配置。）`C:\Documents And Settings\*username*\Application Data\cabal``config`

[`cabal-dev`](http://hackage.haskell.org/package/cabal-dev)有助于将此类问题隔离开来；它在自己的沙箱中构建每个程序，从而使包问题的影响本地化并且可以轻松清理。不过，我不知道它在 Windows 上的效果如何。

# android - 将 Android 设备连接到多个蓝牙串行嵌入式对等体

> ID：10150446
> 
> 赞同：3
> 
> 时间：2012-04-14T02:15:37.523
> 
> 标签：android, bluetooth, iobluetooth

我正在尝试为此设置找到解决方案：

我有一个 Android 设备，我想连接到多个串行嵌入式设备...

事情是这样的，使用“正常”方式检索蓝牙套接字，不适用于所有设备，虽然它可以连接到多个设备，并与多个设备发送和接收数据。

```
public final synchronized void connect()
        throws ConnectionException {
    if (socket != null)
        throw new IllegalStateException("Error socket is not null!!");
    connecting = true;
    lastException = null;
    lastPacket = null;
    lastHeartBeatReceivedAt = 0;
    log.setLength(0);
    try {
        socket = fetchBT_Socket_Normal();
        connectToSocket(socket);
        listenForIncomingSPP_Packets();
        connecting = false;
        return;
    } catch (Exception e) {
        socket = null;
        logError(e);
    }
    try {
        socket = fetchBT_Socket_Workaround();
        connectToSocket(socket);
        listenForIncomingSPP_Packets();
        connecting = false;
        return;
    } catch (Exception e) {
        socket = null;
        logError(e);
    }
    connecting = false;
    if (socket == null)
        throw new ConnectionException("Error creating RFcomm socket for" + this);
}

private BluetoothSocket fetchBT_Socket_Normal()
        throws Exception {
    /* The getType() is a hex 0xXXXX value agreed between peers --- this is the key (in my case) to multiple connections in the "Normal" way */
    String uuid = getType() + "1101-0000-1000-8000-00805F9B34FB";

    try {
        logDebug("Fetching BT RFcomm Socket standard for UUID: " + uuid + "...");
        socket = btDevice.createRfcommSocketToServiceRecord(UUID.fromString(uuid));
        return socket;
    } catch (Exception e) {
        logError(e);
        throw e;
    }
}

private BluetoothSocket fetchBT_Socket_Workaround()
        throws Exception {
    Method m;
    int connectionIndex = 1;
    try {
        logDebug("Fetching BT RFcomm Socket workaround index " + connectionIndex + "...");
        m = btDevice.getClass().getMethod("createRfcommSocket", new Class[]{int.class});
        socket = (BluetoothSocket) m.invoke(btDevice, connectionIndex);
        return socket;
    } catch (Exception e1) {
        logError(e1);
        throw e1;
    }
}

private void connectToSocket(BluetoothSocket socket)
        throws ConnectionException {
    try {
        socket.connect();
    } catch (IOException e) {
        try {
            socket.close();
        } catch (IOException e1) {
            logError("Error while closing socket", e1);
        } finally {
            socket = null;
        }
        throw new ConnectionException("Error connecting to socket with" + this, e);
    }
} 
```

事情就是这样，虽然在“正常”方式不起作用的手机上，“解决方法”方式为单一连接提供了解决方案。我已经[**广泛**](https://stackoverflow.com/questions/6760102/connecting-to-a-already-paired-bluetooth-device)[**搜索**](https://stackoverflow.com/questions/4468658/android-bluetooth-api-connect-to-multiple-devices) [**，**](http://groups.google.com/group/android-developers/browse_thread/thread/69d7810f6ef9bb7d?pli=1)但想出了 zip [**。**](http://code.google.com/p/android/issues/detail?id=5427)[](https://stackoverflow.com/questions/6760102/connecting-to-a-already-paired-bluetooth-device)**[](http://groups.google.com/group/android-developers/browse_thread/thread/69d7810f6ef9bb7d?pli=1)**[](http://code.google.com/p/android/issues/detail?id=5427)****

 ******最后一个链接中提到了解决方法的问题，两个连接都使用相同的端口，在我的情况下，这会导致一个块，两个嵌入式设备实际上都可以发送数据，而这在 Android 上没有被处理，而两者嵌入式设备可以接收来自 Android 的数据。

以前有人处理过这个吗？

[这里](http://code.google.com/p/apps-for-android/source/browse/BTClickLinkCompete/src/net/clc/bt/ConnectionService.java)有一点参考，

**更新：**

在[此](http://code.google.com/p/android/issues/detail?id=5427)之后（我之前发布的）我想给 mPort 一个机会，也许看看其他端口索引，以及其他设备如何管理它们，我发现 BluetoothSocket 对象中的字段是不同的，而它是相同的两种情况下的 FQN 类：

来自 HTC Vivid 2.3.4 的细节，使用“解决方法”技术：

Socket 类类型为：[ **android.bluetooth.BluetoothSocket** ]

```
mSocket BluetoothSocket  (id=830008629928)  
    EADDRINUSE          98  
    EBADFD              77  
    MAX_RFCOMM_CHANNEL  30  
    TAG                 "BluetoothSocket" (id=830002722432) 
    TYPE_L2CAP          3   
    TYPE_RFCOMM         1   
    TYPE_SCO            2   
    mAddress            "64:9C:8E:DC:56:9A" (id=830008516328)   
    mAuth               true    
    mClosed             false   
    mClosing            AtomicBoolean  (id=830007851600)    
    mDevice             BluetoothDevice  (id=830007854256)  
    mEncrypt            true    
    mInputStream        BluetoothInputStream  (id=830008688856) 
    mLock               ReentrantReadWriteLock  (id=830008629992)   
    mOutputStream       BluetoothOutputStream  (id=830008430536)    
    **mPort             1** 
    mSdp                null    
    mSocketData         3923880 
    mType               1 
```

来自 LG-P925 2.2.2 的细节，使用“正常”技术：

Socket 类类型为：[ **android.bluetooth.BluetoothSocket** ]

```
mSocket BluetoothSocket  (id=830105532880)  
    EADDRINUSE          98  
    EBADFD              77  
    MAX_RFCOMM_CHANNEL  30  
    TAG                 "BluetoothSocket" (id=830002668088) 
    TYPE_L2CAP          3   
    TYPE_RFCOMM         1   
    TYPE_SCO            2   
    mAccepted           false   
    mAddress            "64:9C:8E:B9:3F:77" (id=830105544600)   
    mAuth               true    
    mClosed             false   
    mConnected          ConditionVariable  (id=830105533144)    
    mDevice             BluetoothDevice  (id=830105349488)  
    mEncrypt            true    
    mInputStream        BluetoothInputStream  (id=830105532952) 
    mLock               ReentrantReadWriteLock  (id=830105532984)   
    mOutputStream       BluetoothOutputStream  (id=830105532968)    
    mPortName           "" (id=830002606256)    
    mSocketData         0   
    mSppPort            BluetoothSppPort  (id=830105533160) 
    mType               1   
    mUuid               ParcelUuid  (id=830105714176) 
```

任何人都有一些见解...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T23:22:50.097

哇，每次这都让我大吃一惊？

这是一个竞争条件问题，它显然适用于一个版本的 android，而不适用于另一个版本。在 Android 对等体上，我正在解析从套接字接收到的数据包：

```
public class SocketListener
        implements Runnable {

    private boolean stop;

    private OnIncomingPacketListener packetListener;

    @Override
    public void run() {
        InputStream inputStream;
        try {
            stop = false;
            inputStream = socket.getInputStream();
            while (!stop) {
                Packet packet = Packet.getPacket(inputStream);
                lastPacket = packet;
                if (packet.getDescriptor() == Packet.HeartBeat)
                    lastHeartBeatReceivedAt = System.currentTimeMillis();
                else if (packet.getDescriptor() == Packet.LogEntry)
                    log.append(((LogEntryPacket) packet).getLogEntry());
                synchronized (this) {
                    if (packetListener != null)
                        packetListener.onIncomingData(EmbeddedDevice.this, packet);
                }
            }
        } catch (IOException e) {
            logError("----- BLUETOOTH IO ERROR -----\n @: " + EmbeddedDevice.this, e);

            return;
        } catch (RuntimeException e) {
            logError("----- BLUETOOTH LISTENER ERROR -----\n @: " + EmbeddedDevice.this, e);
            throw e;
        } finally {
            socketListeningThread = null;
        }
    }
} 
```

Packet.getPacket(inputStream) 在哪里：

```
public static synchronized Packet getPacketInstance(InputStream inputStream)
        throws IOException {
    int data = inputStream.read();
    Packet type = null;
    for (Packet packetType : values())
        if (packetType.packetType == data) {
            type = packetType;
            break;
        } // race condition here...
    if (type == null)
        throw new IllegalArgumentException("Unknown packet type: " + data);
    try {
        Packet packet = type.incomingPacketType.newInstance();
        packet.setDescriptor(type);
        packet.readPacketData(inputStream);
        return packet;
    } catch (IOException e) {
        throw e;
    } catch (Exception e) {
        throw new IllegalStateException("Error instantiating type: " + type.incomingPacketType.getName(), e);
    }

} 
```

并且每次完成一个数据包时，下一个线程应该已经进入执行它的解析。

我的猜测是端口上有某种锁定，与我的实现一起导致第二个线程无限期地阻塞，一旦我删除了对每个线程不同实例的解析，问题就解决了。

这种见解的灵感来自于**mPort**链接的**Daniel Knoppel 。**

 **谢谢丹尼尔！********

# c# - 将包含对象的字典复制到对象数组c#

> ID：10150453
> 
> 赞同：-2
> 
> 时间：2012-04-14T02:16:12.733
> 
> 标签：c#, asp.net

我有一个像这样的字典`Dictionary<string,Object>`，是否有任何方法可以将字典转换为对象数组，其中对象的类将包含两个成员 - 其中一个是字符串，另一个是存储为值的对象 -在字典中配对。请帮忙！！！..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:24:43.917

`Dictionary<TKey, TValue>`实现`IEnumerable<T>`where `T`is `KeyValuePair<TKey, TValue>`。要将其展平为数组，只需`IEnuemrable<T>.ToArray`这样调用：

```
Dictionary<string, int> dict = new Dictionary<string, int>() { { "Key1", 0 }, { "Key2", 1 } };
var kvArray = dict.ToArray(); 
```

`kvArray`然后将是一个数组对象，将每个元素的键和值`dict`作为同一对象的两个单独成员引用。

不过，您的问题有点模棱两可，也许进一步的解释会帮助我们找到更合适的解决方案。

* * *

重新发表您的评论，LINQ 对此有好处：

```
Dictionary<string, int[]> dict = new Dictionary<string, int[]>() { { "Key1", new int[] { 0, 1, 2 } }, { "Key2", new int[] { 4, 5, 6 } } };

var pairs = dict.SelectMany(pair => pair.Value
                .Select(v => 
                    new { 
                        Key = pair.Key, 
                        Value = v 
                    }
                 )
             ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:24:02.480

给定一个类：

```
class ClassA
{
    string CustomerId { get; set; }
    PatientRecords[] Records { get; set; }

    public ClassA(string name, PatientRecords[] records)
    {
        Name = name;
        Records = records;
    }
} 
```

我假设`CollectionOfPatientRecords`实现 IEnumberable：

`var dict = new Dictionary<string, CollectionOfPatientRecords> ( ... );`

然后让你的 ClassA 数组具有正确的值：

```
dict.Select(kv => new ClassA(kv.Key, kv.Value.ToArray())).ToArray(); 
```

# android - Android - 在暂停时继续播放音乐

> ID：10150454
> 
> 赞同：0
> 
> 时间：2012-04-14T02:16:30.877
> 
> 标签：android, onpause

我有一些音频文件在应用程序中播放一两分钟，类似于音板。当有人单击按钮时，它会播放声音。很简单。我在 SharedPreference 中有一个设置，询问用户是否退出或暂停应用程序，是否希望继续播放声音。这就是我卡住的地方。

截至目前，当用户将其设置为“继续播放”时，应用程序会冻结，您必须手动强制退出。这是我所拥有的：

```
@Override
protected void onPause() {

    SharedPreferences getPrefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
    boolean settingContinueMusic = getPrefs.getBoolean("continueMusic", false);
    if(settingContinueMusic == false){
        super.onPause();
        if(audio1.isPlaying()) { audio1.pause(); }
        if(audio2.isPlaying()) { audio2.pause(); }
        if(audio3.isPlaying()) { audio3.pause(); }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T04:00:05.523

我认为问题正在发生，因为您已将`super.onPause();`if 条件放入其中。只有当用户决定暂停音频时，它才会执行。把它移出if，看看它是否有效。

```
@Override
protected void onPause() {
 super.onPause();
    SharedPreferences getPrefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
    boolean settingContinueMusic = getPrefs.getBoolean("continueMusic", false);
    if(settingContinueMusic == false){

        if(audio1.isPlaying()) { audio1.pause(); }
        if(audio2.isPlaying()) { audio2.pause(); }
        if(audio3.isPlaying()) { audio3.pause(); }
    }

} 
```

# wiki - 我如何强制新用户在 MediaWiki wiki 上创建新帐户时填写其用户：页面？

> ID：10150455
> 
> 赞同：1
> 
> 时间：2012-04-14T02:16:31.610
> 
> 标签：wiki, mediawiki

我不得不在 wiki 上还原的不必要的新用户错误越来越烦人。我有什么办法可以预先加载他们`User:Username`的说明，以找到他们可能需要的任何帮助以及指向提问地点的链接，此外，是有什么办法要求新用户在编辑其他页面之前进行三个`User:Username`//页面编辑`User_talk:Username`？`User_talk:SomeAdmin`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:22:31.257

由于我无权在此 wiki 上安装/删除扩展，因此我不得不使用我所拥有的。wiki 安装了[Extension:InputBox](http://www.mediawiki.org/wiki/Extension%3aInputBox) .. 所以，我设置了[Template:Welcome](http://ddowiki.com/page/Template%3aWelcome)，创建了一个[preload](http://ddowiki.com/page/MediaWiki%3aWelcomecreation/preload)，并使用一个简单的按钮设置了[MediaWiki:Welcomecreation](http://ddowiki.com/page/MediaWiki%3aWelcomecreation)，可以说大部分繁重的工作......它实际上并没有强制任何东西，但提供了所有需要的信息，并具有与我正在寻找的类似的最终输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T08:56:42.453

我使用的另一个“技巧”是使用[NewUserMessage](http://www.mediawiki.org/wiki/Extension%3aNewUserMessage)扩展来要求用户添加此信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T08:45:55.477

我不知道如何强制它，但这是我使用的一个技巧：

1.  下载并安装[MyVariables](http://www.mediawiki.org/wiki/Extension%3aMyVariables)扩展。
2.  创建一个模板以使用它，称为`{{User name}}`- 下面的代码。
3.  将此模板包含在主页上的欢迎消息中。然后，用户将查看`Welcome <their name>`他们是否已填写或未填写`Welcome enter your user name`。

这个模板有两点：

*   如果他们没有输入他们的名字，文本链接到一个页面，解释如何做到这一点（你需要创建这个），
*   如果他们输入了自己的姓名，则文本链接到`MY PREFERENCES`他们可以更新其用户数据的位置。

当然，如果这太过分了，你可以改变它。

编码：

`{{#if:{{CURRENTUSERREALNAME}}|[[MY PREFERENCES|{{CURRENTUSERREALNAME}}]]|[[How to create your user profile on this wiki|enter your user name]]}}<noinclude>`

`<Add text here explaining the template, or just link to this stackoverflow page!>`

`[[Category:Template]]`

`</noinclude>`

# mysql - 使用 SQL 按时间排序

> ID：10150459
> 
> 赞同：0
> 
> 时间：2012-04-14T02:18:22.167
> 
> 标签：mysql, vb.net

我正在使用 VB 和 MySQL。我有一个名为 xTime 的字段，数据类型是 TIME。我正在尝试找到一种方法来订购它 ASC 或使其能够在其中包含 PM/AM。现在我的数据如下，我需要在 3:20 和 5:50 之后，因为它们应该是下午。有任何想法吗？

```
62      4       3       03:20:00
61      4       3       05:50:00
56      1       1       07:40:00 
```

这是我的 SQL 语句：

```
 SELECT        ReserveID, MembershipID, Player_Count, `Time`, CourseID, `Date`  
    FROM            reserve  
    WHERE        (CourseID = 1) AND (`Date` = CURDATE())  
    ORDER BY `Time` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T03:06:42.350

实际上，您的代码和数据似乎都很好。您的代码按时间升序排序，结果以应有的方式显示。问题是您以错误的方式解释数据：

> 我需要下午 3:20 和 5:50，因为那应该是下午

`3:20`并且`5:50`必须`7:40`永远如此，因为那些都是`AM`时代。`3:20 PM`等于`15:20`和`5:50 PM`等于`17:40`。

# c# - WP7 NullReferenceException 导航返回

> ID：10150462
> 
> 赞同：0
> 
> 时间：2012-04-14T02:18:49.673
> 
> 标签：c#, windows-phone-7

我在尝试使用我的 RSS 阅读器中的以下代码导航回之前的 MainPage.xaml 时遇到空引用异常。有人可以通过建议我需要做些什么来避免这个错误来帮助我吗？

```
public partial class FeedDetailsPage : PhoneApplicationPage
{
    object _selectedFeedItem;
    object _selectedFeed;

    public FeedDetailsPage()
    {
        InitializeComponent();
        Loaded += new RoutedEventHandler(PhoneApplicationPage_Loaded);
        LoadFeed();
    }

    private void LoadFeed()
    {
        FrameworkElement root = Application.Current.RootVisual as FrameworkElement;
        var currentFeed = root.DataContext as ATP_Tennis_App.ViewModels.FeedViewModel;
        WebClient wc = new WebClient();
        wc.DownloadStringCompleted += new DownloadStringCompletedEventHandler(wc_DownloadStringCompleted);
        wc.DownloadStringAsync(new Uri(currentFeed.FeedUrl));
        _selectedFeed = currentFeed;
    }

    void wc_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
      //  if (e.Error != null) { return; }

        var rssFeed = XElement.Parse(e.Result);

        var currentFeed = this.DataContext as ATP_Tennis_App.ViewModels.FeedViewModel;
        var items = from item in rssFeed.Descendants("item")

                    select new ATP_Tennis_App.ViewModels.FeedItemViewModel()
                    {

                        Title = item.Element("title").Value,
                        DatePublished = DateTime.Parse(item.Element("pubDate").Value),
                        Url = item.Element("link").Value,
                        Description = item.Element("description").Value
                    };
        foreach (var item in items)
            currentFeed.Items.Add(item);

    }

    private void PhoneApplicationPage_BackKeyPress(object sender, System.ComponentModel.CancelEventArgs e)
    {
        // Cancel default navigation

        e.Cancel = true;
        PhoneApplicationFrame root = (PhoneApplicationFrame)Application.Current.RootVisual;
        root.GoBack();

    }

    private void PhoneApplicationPage_Loaded(object sender, RoutedEventArgs e)
    {
        this.DataContext = _selectedFeed;
    }

    private void lstFeeds_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        _selectedFeedItem = (sender as ListBox).SelectedItem;
        NavigationService.Navigate(new Uri("/FeedItemDetailsPage.xaml", UriKind.Relative));
        FrameworkElement root = Application.Current.RootVisual as FrameworkElement;
        root.DataContext = _selectedFeedItem;
    }

} 
```

在线抛出异常

```
wc.DownloadStringAsync(new Uri(currentFeed.FeedUrl)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T05:32:35.823

我已经解决了这个问题。错误出现在我的 MainPage 脚本中。我已将 datacontext 设置移动到主脚本中，现在不再抛出错误

# algorithm - 如何在Scala中简化表达式（and，or，not）？

> ID：10150464
> 
> 赞同：2
> 
> 时间：2012-04-14T02:19:03.340
> 
> 标签：algorithm, scala, recursion

我不知道如何解决我的问题。我有一个作业，我需要使用教授制定的规则来简化表达式。我需要接受表达式字符串：

```
"(and(x x))"
"(or (and x z) y)"
"(and (or z (not x))(or e a))" 
```

并使用规则简化它们：

```
(or x nil) => x; 
(or nil x) => x;
(or 1 x) => 1;
(or x 1) => 1;
(and x nil) => nil; 
(and nil x) => nil;
(and x 1) => x; 
(and 1 x) => x;
(not nil) => 1;
(not 1) => nil;
(not (and x y)) => (or (not x) (not y));
(not (or x y)) => (and (not x) (not y)); 
```

我决定采用上面的确切形式（不能是任何其他方式）的表达式，并将其解析为一个数组，因此例如在每个索引中，它看起来像这样：

```
and or x y z //ArrayBuffer[String] 
```

然后我使用一个递归函数来检查左右表达式，直到它得到简化的表达式。我的问题不在于规则，因为我已经弄清楚了。我基本上完成了3个案例，它们是：

```
"(and z (or x y)" // the case when the left symbol is simple but the right side must be recursed
"(and (or x y) z)" // case when the right symbol is simple but the right side must be recursed
"(and x y)" // simple case where no recursion is necessary 
```

我错过了必须递归左右符号才能获得那些简化符号的情况。我没有办法知道它们何时结束或开始，并且在很多情况下，即使在这些内部表达式中也必须递归：

```
"(and (or (and x y) z)(or x a))"
"(and (or (and x y) z)(or (and y z) a))" 
```

我已经考虑过如何使用我拥有的当前实现以有效的方式完成此操作，但还没有得到任何东西。我正在征求一些关于如何去做的建议。我没有提供代码，因为我想自己完成它，只需要朝着正确的方向轻推。如果需要澄清，请询问，我会这样做。再次感谢提前！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T02:29:04.503

```
and or x y z //ArrayBuffer[String] 
```

我会避免表示这样的表达式。虽然可以明确地获得前缀概念中的表达式结构，但它并不像拥有递归结构那样容易。

相反，您应该使用递归定义的类层次结构来表示表达式。在不提供太多细节的情况下，您可能会拥有一个接口（a`Trait`或 abstract `Class`），以及该接口的实现者，它们取决于参数的数量：一个用于具有三个部分的表达式（如 (`(or, x, y)`或`(and, (or x y), z))`)，一个用于具有两个部分的表达式（like `(not, x)`），一个用于带有一部分的表达式（like `x`, `y`, `z`, `nil`, 等）。

然后你的简化过程变成了一个大的模式匹配方法，它可以递归地调用自己来遍历表达式的解析树：

```
def simplify(expression: ExpressionIterface) = 
    expression match {
        case /* pattern */ => /* result, possibly with a recursive call to simplify */
        ...
    } 
```

编辑：`ArrayBuffer[String]`可以使用简单的递归解析函数将 转换为您的类，因为您知道每个运算符应该关联多少个参数。您可以遍历缓冲区，每次看到`and`or`or`时，您开始创建 3 部分表达式，每次看到 a`not`时，您开始创建 2 部分表达式，并为其他任何内容创建 1 部分表达式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T10:30:43.020

我认为这在[Scala by Example 一书中以 PDF 形式提供，可](http://www.scala-lang.org/sites/default/files/linuxsoft_archives/docu/files/ScalaByExample.pdf)从 scala lang 网站获得（参见第 7 章）。我的建议是使用案例类来表示您的表达式，然后使用模式匹配来简化表达式：

首先，让我们定义一个表达式特征，用于表示各种表达式。

```
scala> trait Expr { def simplify:Expr = this }
defined trait Expr 
```

在这里，我让 Expr trait 实现了一个默认`simplify`方法，该方法只返回扩展 trait 的对象。所以让我们添加一些简单的表达式：

```
scala> case object True extends Expr
defined module True

scala> case object False extends Expr
defined module False

scala> case class Var(name:String) extends Expr { override def toString = name }
defined class Var 
```

`True`并在你的例子中`False`代表`1`和。将用于表示尚无真值的变量，例如您的示例中的 x、y、a 和 b。Var 还覆盖了使打印输出更漂亮的方法:)`nil``Var``toString`

现在来看看和/或有点棘手的情况。让我们定义这些：

```
scala> case class And(a:Expr, b:Expr) extends Expr {
     | override def simplify = (a.simplify, b.simplify) match {
     | case (True,x) => x
     | case (x,True) => x
     | case (False,x) => False
     | case (x,False) => False
     | case (x,y) => And(x,y)
     | }
     | }
defined class And

scala> case class Or(a:Expr, b:Expr) extends Expr {
     | override def simplify = (a.simplify, b.simplify) match {
     | case (True,x) => True
     | case (x,True) => True
     | case (False,x) => x
     | case (x,False) => x
     | case (x,y) => Or(x,y)
     | }
     | }
defined class Or 
```

`And`并且`Or`都覆盖特征中的`simplify`方法`Expr`并返回其自身及其子表达式的简化版本。现在，这些可用于构建表达式以及更简单的 True、False 和 Var 表达式：

```
scala> val X = Var("X"); val Y = Var("Y"); val A = Var("A"); val B = Var("B")
X: Var = X
Y: Var = Y
A: Var = A
B: Var = B

scala> And(X, True).simplify
res10: Expr = X

scala> And(X, And(Y, False)).simplify
res11: Expr = False

scala> And(X, Or(Y, False)).simplify
res12: Expr = And(X,Y)

scala> Or(True, And(X, Or(Y, False))).simplify
res13: Expr = True 
```

最后我们为 not 添加一个表达式：

```
scala> case class Not(a:Expr) extends Expr {
     | override def simplify = a.simplify match {
     | case True => False
     | case False => True
     | case And(x,y) => Or(Not(x),Not(y))
     | case Or(x,y) => And(Not(x),Not(y))
     | case Not(x) => x
     | case x => Not(x)
     | }
     | }
defined class Not 
```

现在我们可以表示您示例中的表达式。但是对于某些表达式，这个 Not case 类不会做一个完整的简化，例如

```
scala> Not(Or(Not(X),Y)).simplify
res41: Expr = And(Not(Not(X)),Not(Y)) 
```

所以我们可以定义一个递归函数`Not`来尝试简化表达式，直到它不能再简化它：

```
scala> case class Not(a:Expr) extends Expr {
     | override def simplify = recursiveSimplify(a, a)
     | private def recursiveSimplify(curExpr:Expr, lastExpr:Expr):Expr = if(curExpr != lastExpr) {
     | val newExpr = curExpr.simplify match {
     | case True => False
     | case False => True
     | case Var(x) => Not(Var(x))
     | case Not(x) => x
     | case And(x,y) => Or(Not(x), Not(y))
     | case Or(x,y) => And(Not(x), Not(y))
     | }
     | recursiveSimplify(newExpr, curExpr)
     | } else {
     | lastExpr
     | }
     | }
defined class Not 
```

现在前面的表达式简化为：

```
scala> Not(Or(Not(X),Y)).simplify
res42: Expr = Or(Not(X),Y) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T08:51:59.337

这是dhg解决方案的简单实现：

```
package solve

sealed trait Expr
case class Not(e:Expr) extends Expr
case class And(e1:Expr, e2:Expr) extends Expr
case class Or(e1:Expr, e2:Expr) extends Expr
case class Idn(v:String) extends Expr
object Solve extends App {
  def prep(s:String):List[String] =
    s.replaceAll("[()]+"," ").split(" ").filter(_.size > 0).toList
  def parse(l:List[String]):Expr =
    parseI(l) match {
      case (e,Nil) => e
      case _ => throw new Exception("malformed exception")
    }
  def parseI(l:List[String]):(Expr,List[String]) =
    l match {
      case "not" :: rest =>
        val (e, rem) = parseI(rest)
        (Not(e), rem)
      case "and" :: rest =>
        val (e1, rem) = parseI(rest)
        val (e2, rem2) = parseI(rem)
        (And(e1,e2), rem2)
      case "or" :: rest =>
        val (e1, rem) = parseI(rest)
        val (e2, rem2) = parseI(rem)
        (Or(e1,e2), rem2)
      case i :: rest =>
        (Idn(i), rest)
      case Nil => throw new Exception
    }
  def simplify(e:Expr):Expr = {
    e match {
      case Or(x,Idn("nil")) => simplify(x)
      case Or(Idn("1"),x) => Idn("1")
      case Or(x,y) => Or(simplify(x),simplify(y))
      case x => x
    }
  }  
} 
```

还有一个测试用例：

```
import org.scalatest.FunSuite
import org.scalatest.matchers.ShouldMatchers
import solve._
import Solve._

class SolveTest extends FunSuite with ShouldMatchers {
  test ("prepare expression") {
    prep("(and(x x))") should equal (List("and","x","x"))
  }
  test ("parse expressions") {
    parse(prep("(and(x x))")) should equal (And(Idn("x"), Idn("x")))
    parse(prep("(or (and x z) y)")) should equal (Or(And(Idn("x"), Idn("z")), Idn("y")))
    parse(prep("(and (or z (not x))(or e a))")) should equal (And(Or(Idn("z"),Not(Idn("x"))),Or(Idn("e"),Idn("a"))))
  }
  test ("simplification") {
    simplify(parse(prep("(or (and x z) nil)"))) should equal (And(Idn("x"),Idn("z")))
  }
} 
```

# amqp - 找不到类“AMQPConnection”

> ID：10150465
> 
> 赞同：2
> 
> 时间：2012-04-14T02:19:05.137
> 
> 标签：amqp

我正在使用 Mac OSX Lion。我正在通过 MAMP 运行 php ver 5.3.6，并且在尝试创建 AMQPConnection 时出现此错误

找不到类“AMQPConnection”

我使用这个命令通过macports安装了rabbitmq

$ sudo 端口安装 rabbitmq-server

我使用此命令运行服务器

$ sudo rabbitmq-server - 分离的

一切正常

我在 php.ini 文件中添加了“extension=amqp.so”。更具体地说，我的 /Applications/MAMP/bin/php/php5.3.6/conf/php.ini 文件。

我有 rabbitmq-c 我跑了 autoreconf -i && ./Configure && make && sudo make install 没有错误

我用这个命令配置了rabbit phpize && ./configure && make && make install

这一切似乎都很顺利。

我什至创建了具有权限的用户，并使用可以通过 localhost:55672 访问的 Web 插件验证了这些权限

我什至尝试将 amqp.so 复制到我的 /Applications/MAMP/bin/php/php5.3.6/lib/php/extensions/no-debug-non-zts-20090626/ 文件中，但徒劳无功。

我所做的一切似乎都完美无缺。我没有收到错误/警告消息。Rabbit 服务器正在运行。我在没有 -detached 选项的情况下运行它以查看是否有任何错误。没有什么。

有什么建议么？？？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T20:36:42.373

测试 RabbitMQ 服务器安装的最佳方法是使用简单的 python 代码进行测试。

在 Mac OSX 上安装 PIKA 库非常简单。按照此处给出的步骤进行操作。 [http://www.rabbitmq.com/tutorials/tutorial-one-python.html](http://www.rabbitmq.com/tutorials/tutorial-one-python.html)

复制粘贴并创建两个python文件receive.py和send.py。从两个终端窗口执行这些。大约 10 分钟后，您将知道 RabbitMQ 能够接收消息和队列。

如果显示 AMQP 库处于活动状态，请使用从浏览器检查结果在服务器上创建 info.php。

我觉得您的 RabbitMQ 服务器已安装，但 PHP 库未正确加载。检查您的错误日志。必须有一些细节为什么它无法加载“amqp.so”文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-26T02:51:30.147

能否请您添加：

`use PhpAmqpLib\Message\AMQPMessage;`

根据您的：

`use PhpAmqpLib\Connection\AMQPStreamConnection;`

行，它会工作。

# c++ - 如何将 cin 和 cout 重定向到文件？

> ID：10150468
> 
> 赞同：171
> 
> 时间：2012-04-14T02:19:19.600
> 
> 标签：c++

我怎样才能重定向`cin`到`in.txt`和`cout`到`out.txt`？

* * *

## 回答 #1

> 赞同：259
> 
> 时间：2012-04-14T05:30:29.473

这是您想要做的一个工作示例。阅读注释以了解代码中每一行的作用。我已经在我的电脑上用 gcc 4.6.1 测试过它；它工作正常。

```
#include <iostream>
#include <fstream>
#include <string>

void f()
{
    std::string line;
    while(std::getline(std::cin, line))  //input from the file in.txt
    {
        std::cout << line << "\n";   //output to the file out.txt
    }
}
int main()
{
    std::ifstream in("in.txt");
    std::streambuf *cinbuf = std::cin.rdbuf(); //save old buf
    std::cin.rdbuf(in.rdbuf()); //redirect std::cin to in.txt!

    std::ofstream out("out.txt");
    std::streambuf *coutbuf = std::cout.rdbuf(); //save old buf
    std::cout.rdbuf(out.rdbuf()); //redirect std::cout to out.txt!

    std::string word;
    std::cin >> word;           //input from the file in.txt
    std::cout << word << "  ";  //output to the file out.txt

    f(); //call function

    std::cin.rdbuf(cinbuf);   //reset to standard input again
    std::cout.rdbuf(coutbuf); //reset to standard output again

    std::cin >> word;   //input from the standard input
    std::cout << word;  //output to the standard input
} 
```

您可以在一行中*保存*并*重定向为：*

```
auto cinbuf = std::cin.rdbuf(in.rdbuf()); //save and redirect 
```

这里`std::cin.rdbuf(in.rdbuf())`将`std::cin's`缓冲区设置为`in.rdbuf()`，然后返回与 关联的旧缓冲区`std::cin`。同样的事情也可以用`std::cout`- 或任何*流*来完成。

希望有帮助。

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2012-12-15T00:46:59.363

写吧

```
#include <cstdio>
#include <iostream>
using namespace std;

int main()
{
    freopen("output.txt","w",stdout);
    cout<<"write in file";
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2016-07-21T12:56:01.147

这是一个用于遮蔽 cin/cout 的简短代码片段，可用于编程竞赛：

```
#include <bits/stdc++.h>

using namespace std;

int main() {
    ifstream cin("input.txt");
    ofstream cout("output.txt");

    int a, b;   
    cin >> a >> b;
    cout << a + b << endl;
} 
```

这带来了额外的好处，即普通 fstream 比同步的 stdio 流更快。但这仅适用于单个功能的范围。

全局 cin/cout 重定向可以写成：

```
#include <bits/stdc++.h>

using namespace std;

void func() {
    int a, b;
    std::cin >> a >> b;
    std::cout << a + b << endl;
}

int main() {
    ifstream cin("input.txt");
    ofstream cout("output.txt");

    // optional performance optimizations    
    ios_base::sync_with_stdio(false);
    std::cin.tie(0);

    std::cin.rdbuf(cin.rdbuf());
    std::cout.rdbuf(cout.rdbuf());

    func();
} 
```

请注意，`ios_base::sync_with_stdio`也会重置`std::cin.rdbuf`. 所以顺序很重要。

另见[ios_base::sync_with_stdio(false); 的意义 cin.tie(NULL);](https://stackoverflow.com/questions/31162367/significance-of-ios-basesync-with-stdiofalse-cin-tienull)

Std io 流也可以很容易地在单个文件的范围内隐藏，这对于竞争性编程很有用：

```
#include <bits/stdc++.h>

using std::endl;

std::ifstream cin("input.txt");
std::ofstream cout("output.txt");

int a, b;

void read() {
    cin >> a >> b;
}

void write() {
    cout << a + b << endl;
}

int main() {
    read();
    write();
} 
```

但在这种情况下，我们必须`std`一一选择声明并避免[`using namespace std;`](https://stackoverflow.com/questions/1265039/using-std-namespace)，因为它会产生歧义错误：

```
error: reference to 'cin' is ambiguous
     cin >> a >> b;
     ^
note: candidates are: 
std::ifstream cin
    ifstream cin("input.txt");
             ^
    In file test.cpp
std::istream std::cin
    extern istream cin;  /// Linked to standard input
                   ^ 
```

另请参阅[如何在 C++ 中正确使用命名空间？](https://stackoverflow.com/questions/41590/how-do-you-properly-use-namespaces-in-c)，[为什么“使用命名空间标准”被认为是不好的做法？](https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice)以及[如何解决 C++ 命名空间和全局函数之间的名称冲突？](https://stackoverflow.com/questions/3871474/how-to-resolve-a-name-collision-between-a-c-namespace-and-a-global-function)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-09-21T20:33:58.137

假设您的编译程序名称是 x.exe 并且 $ 是系统外壳程序或提示符

```
$ x <infile >outfile 
```

将从 infile 获取输入并将输出到 outfile 。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-06-01T19:35:33.910

**试试这个将*cout*重定向到文件。**

```
#include <iostream>
#include <fstream>

int main()
{
    /** backup cout buffer and redirect to out.txt **/
    std::ofstream out("out.txt");

    auto *coutbuf = std::cout.rdbuf();
    std::cout.rdbuf(out.rdbuf());

    std::cout << "This will be redirected to file out.txt" << std::endl;

    /** reset cout buffer **/
    std::cout.rdbuf(coutbuf);

    std::cout << "This will be printed on console" << std::endl;

    return 0;
} 
```

**阅读全文[使用 std::rdbuf 重定向 cin 和 cout](https://bits.mdminhazulhaque.io/cpp/forget-freopen-use-stdrdbuf-to-redirect.html)**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-11T18:12:51.927

接受的答案显示了重定向`cin`和`cout`. 您需要构造另一个生命周期超过`cin`or的流对象`cout`。如果你想写一个类似的函数`freopen`，你可以为每个要重定向的流分配一个数组，以保存分配的流对象。

```
#include <iostream>
#include <string>
#include <fstream>
#include <vector>

using namespace std;

template<typename>
    struct fstream_traits { };
template<typename CharT, typename Traits>
    struct fstream_traits<basic_istream<CharT, Traits>> { using type = basic_ifstream<CharT, Traits>; };
template<typename CharT, typename Traits>
    struct fstream_traits<basic_ostream<CharT, Traits>> { using type = basic_ofstream<CharT, Traits>; };

template <typename Stream>
void redirect(Stream& str, string filename)
{
    using fstream_type = typename fstream_traits<Stream>::type;
    static int index = std::ios_base::xalloc();
    if (str.pword(index) == nullptr)
    {
        str.pword(index)= new vector<ios_base*>{};
        str.register_callback([](ios_base::event event, std::ios_base& stream, int index) {
            if (event == ios_base::erase_event)
            {
                for (auto fs : *(vector<ios_base*>*)stream.pword(index))
                    delete fs;
                delete (vector<ios_base*>*)stream.pword(index);
            }
        }, index);
    }
    vector<ios_base*>* list = (vector<ios_base*>*)str.pword(index);
    list->push_back(new fstream_type{filename});
    str.rdbuf(dynamic_cast<fstream_type*>(list->back())->rdbuf())->~basic_streambuf();
}

int main()
{
    redirect(cout, "out.txt");
    cout << "Redirected text!";
    return 0;
} 
```

`istream`如果您明确使用/`ostream`而不是 ，则不需要模板和别名`Stream`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-20T08:31:02.563

如果您的输入文件是 in.txt，您可以使用 freopen 将标准输入文件设置为 in.txt

```
freopen("in.txt","r",stdin); 
```

如果你想对你的输出做同样的事情：

```
freopen("out.txt","w",stdout); 
```

这适用于 std::cin （如果使用 c++）、printf 等...

这也将帮助您在 clion、vscode 中调试代码

**编辑**
如果你想重置标准输入

```
fclose(stdin);
stdin = fdopen(0, "r"); //reopen: 0 is file descriptor of std input 
```

并重置标准输出

```
fclose(stdout);
stdout = fdopen(1, "w"); //reopen: 1 is file descriptor of std output 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-05-31T08:16:33.393

C++ 中的 I/O 重定向

[https://www.geeksforgeeks.org/io-redirection-c/](https://www.geeksforgeeks.org/io-redirection-c/)

```
// Cpp program to redirect cout to a file
#include <fstream>
#include <iostream>
#include <string>

using namespace std;

int main()
{
    fstream file;
    file.open("cout.txt", ios::out);
    string line;

    // Backup streambuffers of  cout
    streambuf* stream_buffer_cout = cout.rdbuf();
    streambuf* stream_buffer_cin = cin.rdbuf();

    // Get the streambuffer of the file
    streambuf* stream_buffer_file = file.rdbuf();

    // Redirect cout to file
    cout.rdbuf(stream_buffer_file);

    cout << "This line written to file" << endl;

    // Redirect cout back to screen
    cout.rdbuf(stream_buffer_cout);
    cout << "This line is written to screen" << endl;

    file.close();
    return 0;
} 
```

# android - registerOnSharedPreferenceChangeListener 不适用于在不同进程中所做的更改

> ID：10150480
> 
> 赞同：7
> 
> 时间：2012-04-14T02:21:06.597
> 
> 标签：android, process, sharedpreferences

我在我的活动中注册`registerOnSharedPreferenceChangeListener`了我的。`SharedPreferences`当我更改`SharedPreferences`在不同进程中运行的内部服务保存的数据时，`onSharedPreferenceChanged`不会调用！

我应该怎么做才能拨打android电话`onSharedPreferenceChanged`？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-14T04:21:44.560

最有可能的是 gc 正在收集垃圾。我以前遇到过这个问题。创建一个全局变量，保持对侦听器的硬引用。

```
 OnSharedPreferenceChangeListener listener = new SharedPreferences.OnSharedPreferenceChangeListener() {
      public void onSharedPreferenceChanged(SharedPreferences prefs, String key) {
        // Implementation
      }
    }; 
```

SharedPreferences.onSharedPreferenceChangeListener的答案[没有被一致地](https://stackoverflow.com/questions/2542938/sharedpreferences-onsharedpreferencechangelistener-not-being-called-consistently/3104265#3104265)解释最好

# php - 从网页的 html 转储中提取第一个完整的句子

> ID：10150485
> 
> 赞同：-1
> 
> 时间：2012-04-14T02:21:49.627
> 
> 标签：php

我正在使用 PHP 开发一个应用程序，该应用程序使用 CURL 从另一个网页中提取所有句子。虽然我能够提取所有数据，但我发现很难提取一个完整的句子。我已经提到了所有相关的问题，并以我想要的方式帮助我。请指教

我需要从中提取完整句子的 html 内容

```
<p><font size="1" color="#C0C0C0">© Copyright <br></font><a href="http://www.dddddd.com" target="_blank"><font size="1" color="#C0C0C0">apple orange Ltd</font></a><font size="1"color="#C0C0C0"><a href="http://sm2.dddd.com/stats.asp?site=sm2ph0t0" target="_top"><img src="http://sm2.dddd.com/meter.asp?site=sm2ph0t0" alt="Site Meter" border=0></a></font></p></td><td valign="top" width="24"></td><!--msnavigation--><td valign="top"><p align="center"><a href="http://www.orangeapple.com" target="_blank"><img border="0" src="asddaf.jpg" alt="Sponsored by Ace Murder Mystery" width="85" height="121"></a><font face="Times New Roman"><b><b><u>Posters</u></b><br><font size="3" color="#008080">To find a large selection of jay joes prints and posters including framing options, please type the word..<font color="#996633"> asdasd </font></a><font color="#996633">&nbsp;</font> in the box below:<br><b> 
```

基本上，如果您注意到可能会出现很多不相关的句子。我想从上面提取一个在字符串中至少包含“6”个单词的句子，我应该得到“To find a large selection of jay joes prints and posters”作为输出。

谢谢，杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:37:21.280

我使用以下方法解决了这个问题

```
$paras = $doc->getElementsByTagName('p'); 

    for ($l = 0; $l < $paras->length; $l++)
    {
        $para = $paras->item($l);
        $paraContent = $para->textContent;
        $urlDet['para'] .= trim_text($paraContent, 1000);
    } 
```

感谢任何试图回答的人...

# xcode - Xcode 4.3 不提供 Icon Composer？

> ID：10150487
> 
> 赞同：7
> 
> 时间：2012-04-14T02:21:54.743
> 
> 标签：xcode, cocoa, xcode4.3

我试图找到 Icon Composer，它应该是作为 Xcode 的一部分下载的，但是我找不到它，无论是在应用程序中还是在聚光灯下。

任何想法可能在哪里，或者我是否必须单独下载？如果有，从哪里来？我尝试在 App Store 中寻找它，但没有找到。

编辑：如果有帮助，我正在使用 Xcode 4.3.2。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-14T03:21:07.163

MDT 是正确的，该应用程序现在捆绑在 Xcode.app 中，但有一种更简单的方法可以访问它：

![在此处输入图像描述](../Images/744b5a9b3327bbf1b223f42b9614b963.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-14T02:39:41.830

# 较新的版本

从 Xcode 4.4 开始，Icon Composer 不再与 IDE 捆绑在一起。但是，您仍然可以从 Apple 的开发者下载页面 ( [developer.apple.com/downloads/](https://developer.apple.com/downloads/index.action#) )下载该程序

搜索“Graphics Tools”，下载最新版本的工具，目前是[Xcode 5.1的版本](http://adcdownload.apple.com/Developer_Tools/graphics_tools_for_xcode__march_2014/graphics_tools_for_xcode_5.1__march_2014.dmg)

# 旧版本

在 Xcode 4.3.1 及更高版本中，Icon Composer 可以位于此目录中。

> /Applications/Xcode.app/Contents/Applications/

在您的应用程序文件夹中，右键单击 Xcode，然后单击“显示包内容”。

**编辑：**使这个答案尽可能完整。

但是，在 Xcode 4.2 及以下版本中，Icon composer 仍然可以位于以下目录中。

> /开发人员/应用程序/实用程序

当然，正如 Dave DeLong 在下面所说，Icon Composer 也可以通过 Xcode 访问，方法是导航到 Xcode Menu >> Open Developer Tool >> Icon Composer。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-11T07:06:16.133

Icon Composer 不能用于创建与 Retina mac 兼容的图标，并且不应再使用该应用程序。它不再与最新版本的 Xcode 捆绑在一起。

相反，您创建一个目录“foobar.iconset”并用您需要的大小的 png 图像填充它，然后将其拖到 Xcode 中的图像中 - 然后将在构建时创建一个 .icns 文件。

目前，您应该创建的 png 文件是（都不是必需的，但都是推荐的）：

*   图标_16x16.png
*   icon_16x16@2x.png
*   图标_32x32.png
*   icon_32x32@2x.png
*   图标_128x128.png
*   icon_128x128@2x.png
*   图标_256x256.png
*   icon_256x256@2x.png
*   图标_512x512.png
*   icon_512x512@2x.png

您也可以使用`iconutil`命令行工具手动创建 icns 文件。

官方文档和更多详细信息位于：http: [//developer.apple.com/library/mac/#documentation/GraphicsAnimation/Conceptual/HighResolutionOSX/Optimizing/Optimizing.html](http://developer.apple.com/library/mac/#documentation/GraphicsAnimation/Conceptual/HighResolutionOSX/Optimizing/Optimizing.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-14T02:24:57.343

有没有调查...

```
/Developer/Applications/Utilities 
```

我的在那里。

# c# - 多线程应用程序未达到 100% 的处理器使用率

> ID：10150489
> 
> 赞同：0
> 
> 时间：2012-04-14T02:22:15.357
> 
> 标签：c#, multithreading, performance, parallel-processing

我的多线程应用程序从 HD 中获取一些文件，然后处理这些文件中的数据。我重用了一个类的同一个实例（dataProcessing））来创建线程（我只是改变了调用方法的参数）。

processingThread[i] = new Thread(new ThreadStart(dataProcessing.parseAll));

我想知道原因是否可能是所有线程都从同一内存中读取。

处理每个文件大约需要半分钟。由于文件只有 200 KB，因此可以快速读取。处理完文件后，我将所有结果写入一个目标文件。我认为问题不在于读取或写入磁盘。所有线程都在处理任务，但由于某种原因，处理器没有被充分利用。我尝试添加更多线程以查看是否可以达到 100% 的处理器使用率，但它会减慢并减少处理使用率，而不是完全使用它。任何人都知道可能出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T15:14:10.817

您可能需要考虑以下几点：

1.  今天的大多数 CPU 都是超线程的。即使操作系统假设每个超线程内核都有 2 条管道，但情况并非如此，并且非常依赖于 CPU 和您正在执行的算术运算。虽然在大多数 CPU 上，每条管道上都有 2 个整数单元，但只有一个 FP，因此大多数 FP 操作并没有从超线程架构中获得任何好处。

2.  由于该文件只有 200k，我只能假设它已全部复制到缓存中，因此这不是内存/磁盘问题。

3.  您是否使用外部 DLL？某些操作（例如使用本机 Bitmap 类读取/保存 JPEG 文件）不是并行的，如果您一次执行多个执行，您将看不到任何加速。

4.  当您达到在线程之间切换的成本高于它们正在执行的操作的程度时，性能会降低。

5.  您是只读取数据还是同时修改数据？如果每个线程也修改数据，那么缓存上有很多锁。每个线程最好在自己的内存中收集自己的数据，并在所有线程都完成工作后将所有数据组合在一起。

# pyqt4 - Python 3：PyQt4 上的 QString

> ID：10150491
> 
> 赞同：1
> 
> 时间：2012-04-14T02:22:28.133
> 
> 标签：pyqt4, qstring, python-3.2

我在尝试做一个非常简单的用户界面时遇到了问题。我用 Qt Designer 制作了我的 UI，然后用 pyuic4 我得到了我的 python 代码。然后我编写了我需要的函数，并用 Eclipse IDE 编译。

我从 pyuic4 得到的代码是：

```
# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'Dni.ui'
#
# Created: Sat Apr 14 02:44:34 2012
#      by: PyQt4 UI code generator 4.9.1
#
# WARNING! All changes made in this file will be lost!
from PyQt4 import QtCore, QtGui
try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    _fromUtf8 = lambda s: s

class Ui_Dialog(object):
    def setupUi(self, Dialog):
        Dialog.setObjectName(_fromUtf8("Dialog"))
        Dialog.resize(371, 217)
        Dialog.setMinimumSize(QtCore.QSize(371, 217))
        self.layoutWidget = QtGui.QWidget(Dialog)
        self.layoutWidget.setGeometry(QtCore.QRect(30, 30, 311, 151))
        self.layoutWidget.setObjectName(_fromUtf8("layoutWidget"))
        self.gridLayout = QtGui.QGridLayout(self.layoutWidget)
        self.gridLayout.setMargin(0)
        self.gridLayout.setObjectName(_fromUtf8("gridLayout"))
        self.horizontalLayout = QtGui.QHBoxLayout()
        self.horizontalLayout.setObjectName(_fromUtf8("horizontalLayout"))
        self.label = QtGui.QLabel(self.layoutWidget)
        self.label.setObjectName(_fromUtf8("label"))
        self.horizontalLayout.addWidget(self.label)
        self.entrada = QtGui.QLineEdit(self.layoutWidget)
        self.entrada.setObjectName(_fromUtf8("entrada"))
        self.horizontalLayout.addWidget(self.entrada)
        self.gridLayout.addLayout(self.horizontalLayout, 0, 0, 1, 1)
        self.boton = QtGui.QPushButton(self.layoutWidget)
        self.boton.setObjectName(_fromUtf8("boton"))
        self.gridLayout.addWidget(self.boton, 1, 0, 1, 1)
        self.horizontalLayout_2 = QtGui.QHBoxLayout()
        self.horizontalLayout_2.setObjectName(_fromUtf8("horizontalLayout_2"))
        self.label_3 = QtGui.QLabel(self.layoutWidget)
        self.label_3.setObjectName(_fromUtf8("label_3"))
        self.horizontalLayout_2.addWidget(self.label_3)
        self.salida = QtGui.QLineEdit(self.layoutWidget)
        self.salida.setObjectName(_fromUtf8("salida"))
        self.horizontalLayout_2.addWidget(self.salida)
        self.gridLayout.addLayout(self.horizontalLayout_2, 2, 0, 1, 1)
        self.retranslateUi(Dialog)
        QtCore.QMetaObject.connectSlotsByName(Dialog)

    def retranslateUi(self, Dialog):
        Dialog.setWindowTitle(QtGui.QApplication.translate("Dialog", "Dialog", None, QtGui.QApplication.UnicodeUTF8))
        self.label.setText(QtGui.QApplication.translate("Dialog", "Introduzca su DNI", None, QtGui.QApplication.UnicodeUTF8))
        self.boton.setText(QtGui.QApplication.translate("Dialog", "Hallar NIF", None, QtGui.QApplication.UnicodeUTF8))
        self.label_3.setText(QtGui.QApplication.translate("Dialog", "NIF:", None, QtGui.QApplication.UnicodeUTF8))

if __name__ == "__main__":
    import sys
    app = QtGui.QApplication(sys.argv)
    Dialog = QtGui.QDialog()
    ui = Ui_Dialog()
    ui.setupUi(Dialog)
    Dialog.show()
    sys.exit(app.exec_()) 
```

我用我需要的功能制作的代码：

```
from Dni import Ui_Dialog
from PyQt4 import QtCore, QtGui

LETRADNI = {0:'T', 1:'R', 2:'W', 3:'A', 4:'G', 5:'M', 6:'Y', 7:'F', 8:'P', 9:'D', 10:'X', 11:'B', 12:'N',
            13: 'J', 14:'Z', 15:'S', 16:'Q', 17:'V', 18:'H', 19:'L', 20:'C', 21:'K', 22:'E'}

# Se hereda de la clase QtGui.QMainWindow
class Principal(QtGui.QMainWindow):
    # Se define el constructor de la clase __init__
    def __init__(self):
        # Se llama al constructor de la clase padre
        QtGui.QMainWindow.__init__(self)

        # Se crea la instancia de Ui_Dialog
        self.ventana = Ui_Dialog()
        self.ventana.setupUi(self)

        # Se conectan las señales con los slots
        self.connect(self.ventana.boton,QtCore.SIGNAL('clicked()'), self.letradni)

def Calcula_letra_dni(dni):
    '''Función Calcula_letra_dni:

        Funcionamiento:

            La función recibe el valor entero dni. Posteriormente calculará el resto de la división
            por 23\. Éste número se buscará en el diccionario 'LETRADNI' para obtener la letra correspondiente
            a ese DNI.

        Argumentos

            dni -- número del documento nacional de identidad (int)

        Devuelve:

            Una cadena (string) -- DNI + letra preparado para salida por pantalla
    '''
    #if len(str(dni))>8 & len(str(dni))<7:
    #    raise ValueError('El dni debe tener entre 7 y 8 cifras')

    num_letra = dni % 23.0

    letra = LETRADNI[num_letra]

    return '{0}-{1}'.format(dni,letra)

def letradni(self):
    self.ventana.salida.setText(Calcula_letra_dni(self.ventana.entrada.text())) 
```

第一个编译并运行，它完美地显示了我的用户界面。

编译第二个我得到一个错误，上面写着：

```
Description                                 Resource  Path  Location   Type
Undefined variable from import: QString Dni.py    /Dni  line 18    PyDev Problem 
```

谁能帮我？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T02:53:37.670

首先，我认为您列出的实际问题与 Eclipse、pydev 和您的项目 PYTHONPATH 有关。查看此内容以确保您已正确设置所有内容并将 PyQt4 包含在您的 pythonpath 中：http:
[//popdevelop.com/2010/04/setting-up-ide-and-creating-a-cross-platform-qt-python- gui-应用程序/](http://popdevelop.com/2010/04/setting-up-ide-and-creating-a-cross-platform-qt-python-gui-application/)

在那之后，除了你提到的之外，你的代码似乎还有一些问题......

首先定义`Principal`类，然后定义`Calcula_letra_dni`函数，然后定义看起来像类实例方法的东西`letradni`，它应该是`Principal`：

```
class Principal(QtGui.QMainWindow):
    # Se define el constructor de la clase __init__
    def __init__(self):
        ...

    def letradni(self):
        ...

def Calcula_letra_dni(dni):
    ... 
```

*然后，当您尝试对字符串进行数学运算（感谢@Avaris）*并浮动时，看起来您会引发异常：
`num_letra = dni % 23.0`

您可能应该先将该字符串转换为浮点数： `num_letra = float(dni) % 23.0`

最后，我认为您也忘记`main`为您的应用程序定义一个。您有一个在您的 中自动生成的`Dni.py`，但您没有为您的实际入口点脚本编写一个：

```
if __name__ == "__main__":
    import sys
    app = QtGui.QApplication(sys.argv)
    form = Principal()
    form.show()
    sys.exit(app.exec_()) 
```

# xcode4 - Mac OS X (10.7.3) 上的 pip install readline 失败

> ID：10150493
> 
> 赞同：1
> 
> 时间：2012-04-14T02:22:38.933
> 
> 标签：xcode4, osx-lion, python-2.7, pip, readline

在通过安装 readline 时构建 readline 的 c 扩展时`pip install readline`，我收到如下错误消息：-

```
Beginning configuration for readline-6.2 for i386-apple-darwin11.3.0

checking whether make sets $(MAKE)... yes

checking for gcc... gcc

checking for C compiler default output file name...

configure: error: in `/Users/calvin/.virtualenvs/myproj/build/readline/rl/readline-lib':

configure: error: C compiler cannot create executables

See `config.log' for more details.

============ Building the readline library ============

============ Building the readline extension module ============

running install

running build

running build_ext

building 'readline' extension

Compiling with an SDK that doesn't seem to exist: /Developer/SDKs/MacOSX10.7.sdk 
```

在我的系统上搜索 MacOSX10.7.sdk 的位置显示：-

```
calvin$ sudo find / -name "MacOSX10.7.sdk"
Password:
/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk
find: /dev/fd/3: Not a directory
find: /dev/fd/4: Not a directory 
```

这不是 readline 编译所期望的。

pip 如何定位 MacOSX10.7.sdk 是否存在错误？

如何在不将 MacOSX10.7 复制到`/Developer/SDKs`目录中的情况下解决此问题？

**澄清**

这就是我暂时解决问题的方法。

```
calvin$ sudo mkdir -p /Developer/SDKs/
Password:

calvin$ sudo ln -s /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk /Developer/SDKs/MacOSX10.7.sdk

calvin$ pip install readline 
```

但我不太确定这是解决它的“适当”方法，因为 pip 应该如何定位我的 .sdk 位置或我的系统 PATH 中缺少某些内容可能存在一些固有问题。因此，任何有关如何以“适当”方式解决此问题的建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T02:28:18.137

这是个好问题。需要注意的是，我*确实*有一个`MacOSX10.7.sdk`文件夹`/Developer/SDKs`，所以可能是您的文件系统状态错误。

最安全的方法可能是安装 XCode，但这在时间方面非常昂贵。我将从创建一个软链接开始：

`sudo ln -s /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk /Developer/SDKs/MacOSX10.7.sdk`

看看这是否能解决问题。

# javascript - 清除输入输出字段后丢失输入提示......有什么解决方法吗？

> ID：10150494
> 
> 赞同：0
> 
> 时间：2012-04-14T02:22:55.490
> 
> 标签：javascript, jquery, input, hints

我有两个脚本用于清除表单和使用输入提示。执行 clear 函数后，输入提示没有返回。

```
function clear_form_elements(ele) {

$(ele).find(':input').each(function() {
switch(this.type) {
    case 'password':
    case 'select-multiple':
    case 'select-one':
    case 'text':
    case 'textarea':
        $(this).val('');
        $("  .bx4a").removeAttr("style");
        $("  .bxTXTa").removeAttr("style");
        $("  .bxTXTa2").removeAttr("style");
        $("  .bx4a2").removeAttr("style");
        $("  .bx").removeAttr("style");
        $("  .ts").removeAttr("style");
        $("  .button-toggle-on").removeAttr("style");
        $("  .gnM").removeAttr("style");
        $("  .gnF").removeAttr("style");
        break;
    case 'checkbox':
    case 'radio':
        this.checked = false;
   }
  });

 }

 // jQuery Input Hints plugin
 // Copyright (c) 2009 Rob Volk
 // http://www.robvolk.com

jQuery.fn.inputHints=function() {
// hides the input display text stored in the title on focus
// and sets it on blur if the user hasn't changed it.

// show the display text
$(this).each(function(i) {
    $(this).val($(this).attr('title'))
        .addClass('hint');
});

// hook up the blur & focus
return $(this).focus(function() {
    if ($(this).val() == $(this).attr('title'))
        $(this).val('')
            .removeClass('hint');
}).blur(function() {
    if ($(this).val() == '')
        $(this).val($(this).attr('title'))
            .addClass('hint');
});
};

$(document).ready(function() {$('input[title],textarea[title]').inputHints();}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T03:03:41.207

提示文本的策略非常简单：将输入的默认值设置为您想要的提示文本，然后在获得焦点时将值设置为''。然后onblur，如果值还是''，把值设置为默认值。例如

```
<label for="userName">Name:<input name="userName" id="userName"
 value="Your full name&hellip;" class="hint"></label>

<script>
function hintFocus() {
  if (this.value == this.defaultValue) this.value = '';
}
function hintBlur(el) {
  if (this.value == '') this.value = this.defaultValue;
}

// Add the listeners
var el = document.getElementById('userName');
el.onfocus = hintFocus;
el.onblur = hintBlur;
</script> 
```

为表单使用标准的重置按钮并为其提供一个侦听器，以便在重置表单时将提示类添加到输入类型 text 和 textarea（视情况而定）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-21T10:24:49.717

我认为 RobG 的答案有一个错误，如果用户输入的文本与提示完全相同（您的全名...），然后单击某处并单击输入，那么用户输入的内容就会消失。

# php - 如何用引号连接 PHP 和 JavaScript 字符串以正确评估

> ID：10150496
> 
> 赞同：3
> 
> 时间：2012-04-14T02:23:53.173
> 
> 标签：php, javascript, eval, string-concatenation

我有一页 iframed 在另一页内。子页面使用 sendMessage() 函数与父页面通信。父页面对从子页面接收到的消息运行 eval()。

这是构造消息的代码：

```
 var msg_string = '$("body").append("<?php echo $content; ?>")';
 var send_string = "sendMessage(\'" + msg_string + "\', '<?php echo $receiver_domain; ?>')";
 setTimeout(send_string, <?php echo $delay; ?>); 
```

问题之一是 $content 变量包含 HTML，并且像 id="test" 这样的双引号不能很好地处理所有这些连接。我想弄清楚这一点不知所措。

我已经尝试通过将 $content 中的引号转换为 " 来转义它们，但这导致浏览器将 div id 放在双双引号 (""test"") 中。

** 更新 **

使用 json_encode 方法确实可以将数据获取到父页面。这是一个比我一直在做的更容易的解决方案（我已经完成了这么多，但发现有些不对劲）。也就是说，如果 div id="test" 中有双引号，则数据的评估仍然失败。一串“测试”有效，但它实际上逐字放置“测试”。这是使用json方法后html中的javascript源码：

```
 var msg_string = '$("body").append("<div class=\\\"test\\\">HEY WHATS UP<\/div>");';
 var send_string = "sendMessage(\'" + msg_string + "\', 'http://domain.com')";
 setTimeout(send_string,500); 
```

这在评估中失败。将警报代替 eval 会产生以下结果：

```
 $("body").append("<div class="test">HEY WHATS UP</div>"); 
```

有任何想法吗？

** 更新 2 **

所以我终于想通了。这是以下三个答案的组合。json 的回答给了我提示。基本上双引号需要加三倍反斜杠，这样当它进入 eval 时，所有内容都可以正确读取。

我遇到了其他一些障碍，包括 html 中的 /r/n 字符...我用 str_replace 删除了，还有一个撇号...在内部 html 元素中...我用适当的 html 实体替换了它和砰！

这是代码：

```
 function escapeQuotes(string){
   var quotes_regex = new RegExp("\"", "g");
   return string.replace(quotes_regex, "\\\"");
 }

 var msg_string = '$("body").append(<?php echo json_encode( str_replace("\r\n", '', $content) ); ?>);';
 var send_string = "sendMessage(\'" + escapeQuotes(msg_string) + "\', '<?php echo $receiver_domain; ?>')";
 setTimeout(send_string,<?php echo $delay; ?>); 
```

我赞成每个人的回答，因为我使用了所有东西。太感谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T02:28:36.590

JSON 是你的朋友。

```
var msg_string = '$("body").append(<?php echo json_encode($content); ?>)'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T02:36:51.853

如果您唯一关心的是双引号，为什么不直接用转义字符串替换它们呢？

```
var msg_string = '$("body").append("<?php echo str_replace("\"", "\\"", $content); ?>")'; 
```

我不能完全测试，但这似乎对我有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T02:40:55.707

**您需要使用[str_replace逃脱](http://php.net/manual/en/function.str-replace.php)**

```
$search  = array("'", '"');
$replace = array("\'", '\"');
var msg_string = '$("body").append("<?php echo str_replace(search, replace, $content; ?>")'; 
```

# c# - 如何自动点击登录图片链接

> ID：10150501
> 
> 赞同：0
> 
> 时间：2012-04-14T02:24:50.840
> 
> 标签：c#

这是一个“登录”图片链接。

```
<div class="inputCol">
    <a href="javascript:document.loginForm.submit()">
        <img tabindex="3" src="/sams/en_US/images/bt-signIn.gif" border="0" alt="Sign In">
    </a>
</div> 
```

我应该用什么替换“？？？？？？” 在下面的代码中获取Signin图片链接的链接元素并使用“invokemember”点击它？

```
private void button2_Click(object sender, EventArgs e)
{

    webBrowser1.Navigate("samsclub.com/sams/account/signin/login.jsp");
    while (webBrowser1.ReadyState != WebBrowserReadyState.Complete)
    {
        Application.DoEvents();
    }
    webBrowser1.Document.GetElementById("mail").SetAttribute("value", "myusername");
    webBrowser1.Document.GetElementById("pw").SetAttribute("value", "mypassword");
    webBrowser1.Document.GetElementById("???????").InvokeMember("Click");
} 
```

# c# - Crystal Report：根据不同页面上的数组索引显示文本

> ID：10150504
> 
> 赞同：0
> 
> 时间：2012-04-14T02:25:13.587
> 
> 标签：c#, visual-studio, crystal-reports

全部

假设我有一个包含字符串的动态生成的数组：{Tom, Bill, Jane, Lucy, Jam} 我想让 Tom 在第 1 页页眉中显示，Bill 在第 2 页页眉中显示，Jane 在第 3 页页眉中显示，等等。

这个想法是实现“分配给”功能，本质上只构建一个水晶报表，但不同的页面被传递给不同的人，这样得到一页报表的人就可以在上面写上他/她的名字。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T17:14:10.500

您所描述的称为“报告突发”。有两种类型的突发：单程和多程。

使用单程突发：

*   报告生成一次
*   记录选择公式适用于每个收件人

使用多遍突发：

*   为每个收件人生成一次报告，其中收件人 ID 是参数化的。

BusinessObjects Enterprise XI 使用发布支持这两种方法。收件人可以是 BO 用户或“外部”（出版物为此使用 Crystal Reports 或 WebI 报告，很奇怪）收件人。您可以以多种格式将报告发送到 BO 收件箱或 SMTP 收件箱（以及其他）。

如果您没有 BO，您可能需要考虑 Apos 的 Bursting Manager。

如果您具有编程专业知识，则可以使用 Crystal Reports SDK 轻松地生成报表。您存储原始记录选择公式，将 WHERE 子句片段附加到它上面将过滤报告（例如，对于收件人），以所需格式交付报告，恢复原始 RSF，然后重复。

# python - emit() 如何知道在 PyQT 中使用哪个 SLOT？

> ID：10150505
> 
> 赞同：1
> 
> 时间：2012-04-14T02:25:47.347
> 
> 标签：python, pyqt, pyqt4

在 main.py

```
def setNumberFormat2(self):
    dialog = numberformatdlg2.NumberFormatDlg(self.format, self)
    self.connect(dialog, SIGNAL("changed"), self.refreshTable)
    dialog.show() 
```

并在`form.py`：

```
class NumberFormatDlg(QDialog):
  def __init__(self, format, parent=None):
       .....
     self.connect(buttonBox.button(QDialogButtonBox.Apply),
                                  SIGNAL("clicked()"), self.apply)
     self.connect(buttonBox, SIGNAL("rejected()"),
                                  self, SLOT("reject()"))
     self.setWindowTitle("Set Number Format (Modeless)")

  def apply(self):
     ....
     self.emit(SIGNAL("changed")) 
```

据作者说：

> 最后，我们发出一个 changed 信号，正如我们所见，这会导致调用者的 refreshTable() 方法被调用，这反过来又使用调用者的格式字典格式化表中的所有数字。

当我们发出时，它如何知道我们要应用哪个 SLOT？本质上，如果我们有

```
self.connect(dialog, SIGNAL("changed"), self.refreshTable)
self.connect(dialog, SIGNAL("changed"), self.anotherMethod) 
```

怎么`self.emit(...)`知道我们申请的是哪个插槽？还是我错过了一些信息？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T02:30:53.690

`self.emit`什么都不“知道”——它只是发出信号。该`self.connect()`方法是捕获信号并使用信号参数运行给定的函数。

如果将两个函数连接到一个信号，我认为两者都会运行。您可能不应该这样做，因为它会使您的代码有点不可读。

*   如果要运行两个函数，请创建一个被调用的函数，该函数 `changed_signal`将调用其他函数。
*   如果你想为不同的用途运行不同的功能，只需触发不同的信号。

# c - HCL 三输入奇校验

> ID：10150507
> 
> 赞同：0
> 
> 时间：2012-04-14T02:27:21.753
> 
> 标签：c

我有三个输入：a、b 和 c。如果我的输出为 1，则输入为 1 的奇数个。否则为 0。

到目前为止`(a && b && c) || (!a && !b && !c)`，我已经尝试过 , `(a && b && c) || (!a && b && c)`，`(a && c) || (b&& !c)`还有很多其他的。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:41:18.117

怎么样`a ^ b ^ c`？

如果只允许基本的逻辑运算符，你可以使用这个

```
((a && b || !c) || (!a && !b || !c)) && (!a || !b || c) && (a || b || c) 
```

正如 dbaupp 评论的那样，只是等效的转换。

# d - D中的存储类是什么？

> ID：10150510
> 
> 赞同：13
> 
> 时间：2012-04-14T02:27:41.557
> 
> 标签：d

到目前为止，我的印象是存储类`immutable`之类的东西。`const`在最近的一个[视频（大约 11:55）](http://channel9.msdn.com/Events/Lang-NEXT/Lang-NEXT-2012/The-D-Programming-Language)中，Walter Bright 指出这`immutable`不是一个存储类，而是一个类型构造函数。在[官方文档](http://dlang.org/declaration.html)中`immutable`，`const`, 和许多其他关键字被列为存储类：

```
StorageClass:
abstract
auto
const
deprecated
enum
extern
final
immutable
inout
shared
nothrow
override
pure
__gshared
Property
scope
static
synchronized 
```

这个列表有错吗？其中一些没有意义（例如，已弃用、覆盖）。

我知道`static`并且`ref`是存储类，但剩下的呢？D 中的哪一个关键字是类型构造函数？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-14T04:29:11.710

我要指出的是，名为*StorageClass*的语法规则与语言中语义上的存储类之间存在很大差异。语法规则与解析有关，而不是与编译的语义阶段有关。

首先，第 8 章的[TDPL](https://rads.stackoverflow.com/amzn/click/com/0321635361)明确涉及类型限定符（Walter 使用了术语类型构造函数）。D中只有3个：

> const
> 不可变
> 共享

他们三个都是他们修改的类型的一部分。对于诸如`ref`.

`inout`TDPL 称之为“通配符限定符”，因此它是类型限定符的占位符，而不是真正的类型限定符或存储类。

现在，关于什么是存储类，我从 TDPL 中引用两句：

> 每个函数参数（在上面`base`的`exponent`示例中）除了它的类型之外，还有一个可选的*存储类*，它决定了在调用时将参数传递给函数的方式。

（从第 6 - 7 页开始）

> 尽管`static`与将参数传递给函数无关，但在这里讨论它是合适的，因为就像应用于数据一样`ref`，是一个*存储类*，表示有关如何存储数据的详细信息的指示。`static`

 *（从第 137 页开始）

此外，关于 C 中的存储类，有这句话似乎在网上找到的 C 中的存储类的解释中[使用](http://www.lix.polytechnique.fr/~liberti/public/computing/prog/c/C/CONCEPT/storage_class.html) [了很多：](http://www.tutorialspoint.com/ansi_c/c_storage_classes.htm)

> 存储类定义了 C 程序中变量和/或函数的范围（可见性）和生命周期。

存储类对变量的类型没有影响，只是它的存储方式。不幸的是，我找不到 D 中存储类的确切列表，人们对存储类这个术语非常自由，即使它不适用也使用它。几乎*所有*应用于类型保存访问修饰符的属性似乎都被称为存储类，这取决于谁在说话。但是，有一些是毫无疑问的存储类：

> 枚举（当用作清单常量时）
> extern
> lazy
> out
> ref
> scope
> static

`lazy`, `out`, and`ref`可用于修改函数参数并指示它们的传递方式，而`enum`and`static`用于指示变量的存储方式（`enum`在使用而不是实际变量）。`extern`影响联动。

`in`是一个混合体，因为它是 的同义词`scope const`，而 while`scope`是一个存储类，`const`是一个类型限定符。

在线文档也将`auto`and`synchronized`称为存储类，尽管我不知道基于什么。`auto`就像`inout`它是一个占位符（在这种情况下是一个类型的占位符而不是一个类型限定符），因此没有说明一个类型是如何存储的，所以我不会想到它会是一个存储类。`synchronized`不修改变量而是修改类。

`__gshared`可能也是一个存储类，虽然它有点有趣，因为它或多或少地做了`shared`（这是一个类型限定符）所做的，但它不是类型的一部分。

除此之外，我不知道。`synchronized`被列为存储类的事实意味着其他一些（例如`final`）可能是，但（例如`synchronized`）它们与变量的存储或链接方式无关。所以，我不知道如何将它们视为存储类。

不过，我会在新闻组上询问，看看是否可以获得更明确的列表。

**编辑**：似乎在 D 中没有明确的官方存储类列表。该术语用于几乎所有不影响其类型的变量声明中使用的属性（即不是类型限定符）。似乎 Walter 和 Andrei 倾向于在类型限定符上强调哪些属性实际上会影响变量的类型，但术语存储类并没有被赋予接近相同的重要性级别并且最终被使用非正式的，而不是任何严格的定义。*

# ios - 试图让我的 CoreData 显示在我的应用程序中

> ID：10150511
> 
> 赞同：0
> 
> 时间：2012-04-14T02:27:43.803
> 
> 标签：ios, core-data, storyboard

我在玩，学习 CoreData，当我得到一个以 UITableView 作为根的测试应用程序时，它可以很好地显示数据。这会告诉我它从中提取数据的数据库设置正确。

现在我试图将 UIViewController 作为初始视图控制器（通过故事板），它一直给我这个错误 -

> 无法使用 nil 模型创建 NSPersistentStoreCoordinator

现在我已经阅读了很多论坛和教程，他们基本上都说我需要确保我的 xcdatamodel 文件与此匹配

> URLForResource:@"Model" withExtension:@"momd"]

确实如此，如果 UITableView 是根视图，我可以再次显示数据。

现在如果我改变：

```
- (NSManagedObjectModel *)managedObjectModel
{
if (__managedObjectModel != nil)
{
    return __managedObjectModel;
}
  NSURL *modelURL = [[NSBundle mainBundle] URLForResource:@"Model"     withExtension:@"momd"];
__managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];
return __managedObjectModel;
} 
```

进入这个：

```
- (NSManagedObjectModel *)managedObjectModel
{
if (__managedObjectModel != nil)
{
    return __managedObjectModel;
}
  //NSURL *modelURL = [[NSBundle mainBundle] URLForResource:@"Model"   withExtension:@"momd"]; // I have commented out this line because the NSURL is no longer being used.
__managedObjectModel = [NSManagedObjectModel mergedModelFromBundles:nil];
return __managedObjectModel;
 } 
```

应用程序运行但 TableView 是空的，这对我来说很有意义，因为我没有链接到 CoreData 文件。- 问题是 - 我如何使用我所拥有的设置运行应用程序并显示数据？

干杯杰夫

* * *

@response 对 Jeff Wolski 的第一个回答

感谢您的回答，我认为我走在正确的道路上 - 我不得不对我的项目稍作改动以消除错误。我知道有

```
AppDelegate appDelegate = (AppDelegate) [[UIApplication sharedApplication] delegate]; 
```

所以我把这是

```
- (NSManagedObjectModel *)managedObjectModel { 
```

面积——对吗？它现在也提出了 appDelegate 变量未使用警告。可能是一个简单的问题，但我现在在哪里使用该变量？干杯杰夫

* * *

在@Jody Hagins 之后，我已经发布了我认为你的样子 - 希望它有所帮助:-)

```
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator
{
if (__persistentStoreCoordinator != nil)
{
    return __persistentStoreCoordinator;
}

NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"ViewToNav.sqlite"];

NSError *error = nil;
__persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];

NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
                         [NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption,
                         [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption, nil];
if (![__persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:options error:&error])
{

    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
}    

return __persistentStoreCoordinator;
} 
```

干杯杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:45:37.243

您需要在应用程序委托中设置所有核心数据。托管对象模型需要是您的应用程序委托中的一个属性，您的视图可以访问该属性。在您的视图控制器中，您可以使用

```
MyAppDelegate *appDelegate = (MyAppDelegate*) [[UIApplication sharedApplication] delegate]; 
```

这将允许您从您喜欢的任何视图控制器执行获取。

编辑：

我们需要`appDelegate`在视图控制器中使用的原因是我们可以访问`NSManagedObjectContext`应用程序委托中的那个。所以你不需要把它`NSManagedObjectModel`放在你的视图控制器中。( `NSManagedObjectContext`MOC) 使您可以访问应用程序委托中已经存在的整个核心数据堆栈。

在您的应用委托中，您的 MOC 应设置为属性。现在您可以在视图控制器中执行此操作。

```
myMOC = appDelegate.MOC; 
```

现在`myMOC`，您可以访问您的核心数据。您将在视图控制器中创建一个`NSFetchedResultsController`属性。在您的 getter 方法中，其中一个步骤是创建一个`NSEntityDescription`. 这是您使用的地方`self.myMOC`，从而将您`NSFetchedResultsController`与核心数据模型联系起来。

# php - 如何在 codeigniter 中获取整个项目的默认模板/布局？

> ID：10150513
> 
> 赞同：1
> 
> 时间：2012-04-14T02:28:10.193
> 
> 标签：php, codeigniter, templates, layout, view

谁能告诉我如何在 codeigniter 中为我的整个项目实现默认模板/布局？

我发现的一种方法是[使用 Code Igniter 进行模板化（CI 论坛）](http://codeigniter.com/forums/viewthread/88664/)

还有其他方法吗？任何人都可以发布完整的示例代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:38:18.753

制作一个布局视图。像这样的一些事情：

```
<html>
  <head>
    <title>My awesome site</title>
  </head>
  <body>
    <?= $this->load->view('shared/header') ?>
    <?= $this->load->view($partial) ?>
    <?= $this->load->view('shared/footer') ?>
  </body>
</html> 
```

然后在您的控制器中执行以下操作：

```
$this->data['partial'] = 'pages/index';
$this->load->view('layout/layout', $this->data); 
```

如果你有一个 MY_Controller 文件，你可以在那里创建一个方法：

```
function load_view($partial)
{
  $this->data['partial'] = $partial;
  $this->load->view('layout/layout', $this->data);
} 
```

然后在从 MY_Controller 继承的控制器中，您可以使用：

```
$this->load_view('pages/index'); // pages/index will be loaded in the layout 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T12:20:00.483

我知道其中一种方法是为您的站点/项目创建页眉和页脚视图。

```
application/views/template/header.php
application/views/template/footer.php 
```

然后，您可以按照自己的意愿安排其他页面。

```
application/views/users/login.php 
```

在你的控制器中，你会做这样的事情

```
<?php
    class Blah extends CI_Controller
    {
        public function __construct()
        {
            parent::__construct();
        }

        public function index()
        {
            $this->load->view('template/header');
            $this->load->view('users/login');
            $this->load->view('template/footer');
        }
    } 
```

我偶然发现了一个有用的小模板库，它使这变得更加简单。我发现它不像输入其他方式那样灵活。

[http://maestric.com/doc/php/codeigniter_template](http://maestric.com/doc/php/codeigniter_template)

编辑:: 我应该给出模板的一些示例代码，所以你去

头文件.php

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Lovely Title</title>
    </head>
    <body>
        <h1>Check This Out!!1!</h1>
        <div class="container"> 
```

页脚.php

```
 </div>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T03:20:31.380

您始终可以使用其他视图加载视图并实现您想要的。

其他更好的方法是使用支持模板继承的模板引擎，例如

*   [枝条](http://twig.sensiolabs.org/doc/templates.html#template-inheritance)
*   [聪明的](http://www.smarty.net/inheritance)
*   [杜宇](http://wiki.dwoo.org/index.php/TemplateInheritance)

在 CodeIgniter 中使用它们相当容易，因为 CI 库的实现有很多。

# java - 操作系统版本范围的 Maven 配置文件

> ID：10150515
> 
> 赞同：1
> 
> 时间：2012-04-14T02:28:26.270
> 
> 标签：java, maven

不能在 Maven 配置文件中定义操作系统版本范围吗？

```
<profile>
    <id>mac lion</id>
    <activation>
        <os>
            <family>mac</family>
            <version>[10.7.0,)</version>
        </os>
    </activation>
</profile> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T03:55:58.597

无法定义操作系统范围。

但是您可以尝试通过使用[maven enforcer plugin](http://maven.apache.org/enforcer/enforcer-rules/requireOS.html)`<RequireOS>`的参数来实现它。如果这很棘手，您可以尝试[编写自定义规则](http://maven.apache.org/enforcer/enforcer-api/writing-a-custom-rule.html)。

# android - dalvik.system.NativeStart

> ID：10150518
> 
> 赞同：0
> 
> 时间：2012-04-14T02:28:49.663
> 
> 标签：android, json, sqlite

我已经创建并发布了我的 android 应用程序。这很简单。它在我的手机 gamaxy note 上运行良好，但我在 similateur 中收到此错误：

```
04-14 02:15:12.830: W/KeyCharacterMap(301): No keyboard for id 0
04-14 02:15:12.830: W/KeyCharacterMap(301): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
04-14 02:15:30.280: D/Button(301): Login
04-14 02:15:32.400: D/dalvikvm(301): GC_FOR_MALLOC freed 3977 objects / 225448 bytes in 84ms
04-14 02:15:32.920: E/JSON(301): {"tag":"login","success":1,"error":0,"uid":"4f6a68429e5226.39186109","user":{"name":"othmane","email":"othmane@gmail.com","created_at":"2012-03-22 00:46:10","updated_at":"2012-04-14 04:09:45","phone":"212674966347"}}
04-14 02:15:33.030: I/Database(301): sqlite returned: error code = 1, msg = duplicate column name: email
04-14 02:15:33.030: E/Database(301): Failure 1 (duplicate column name: email) on 0x2a2368 when preparing 'CREATE TABLE login(id INTEGER PRIMARY KEY,name TEXT,email TEXT UNIQUE,uid TEXT,created_at TEXT,email TEXT UNIQUE)'.
04-14 02:15:33.040: D/AndroidRuntime(301): Shutting down VM
04-14 02:15:33.040: W/dalvikvm(301): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
04-14 02:15:33.080: E/AndroidRuntime(301): FATAL EXCEPTION: main
04-14 02:15:33.080: E/AndroidRuntime(301): android.database.sqlite.SQLiteException: duplicate column name: email: CREATE TABLE login(id INTEGER PRIMARY KEY,name TEXT,email TEXT UNIQUE,uid TEXT,created_at TEXT,email TEXT UNIQUE)
04-14 02:15:33.080: E/AndroidRuntime(301):  at android.database.sqlite.SQLiteDatabase.native_execSQL(Native Method)
04-14 02:15:33.080: E/AndroidRuntime(301):  at android.database.sqlite.SQLiteDatabase.execSQL(SQLiteDatabase.java:1727)
04-14 02:15:33.080: E/AndroidRuntime(301):  at com.estm.Library.DatabaseHandler.onCreate(DatabaseHandler.java:44)
04-14 02:15:33.080: E/AndroidRuntime(301):  at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:106)
04-14 02:15:33.080: E/AndroidRuntime(301):  at com.estm.Library.DatabaseHandler.resetTables(DatabaseHandler.java:120)
04-14 02:15:33.080: E/AndroidRuntime(301):  at com.estm.Library.UserFunctions.logoutUser(UserFunctions.java:99)
04-14 02:15:33.080: E/AndroidRuntime(301):  at com.estm.Ehesms.LoginActivity$waiting.onPostExecute(LoginActivity.java:101)
04-14 02:15:33.080: E/AndroidRuntime(301):  at com.estm.Ehesms.LoginActivity$waiting.onPostExecute(LoginActivity.java:1)
04-14 02:15:33.080: E/AndroidRuntime(301):  at android.os.AsyncTask.finish(AsyncTask.java:417)
04-14 02:15:33.080: E/AndroidRuntime(301):  at android.os.AsyncTask.access$300(AsyncTask.java:127)
04-14 02:15:33.080: E/AndroidRuntime(301):  at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
04-14 02:15:33.080: E/AndroidRuntime(301):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-14 02:15:33.080: E/AndroidRuntime(301):  at android.os.Looper.loop(Looper.java:123)
04-14 02:15:33.080: E/AndroidRuntime(301):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-14 02:15:33.080: E/AndroidRuntime(301):  at java.lang.reflect.Method.invokeNative(Native Method)
04-14 02:15:33.080: E/AndroidRuntime(301):  at java.lang.reflect.Method.invoke(Method.java:521)
04-14 02:15:33.080: E/AndroidRuntime(301):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-14 02:15:33.080: E/AndroidRuntime(301):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-14 02:15:33.080: E/AndroidRuntime(301):  at dalvik.system.NativeStart.main(Native Method)
04-14 02:20:33.179: I/Process(301): Sending signal. PID: 301 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:54:04.320

> 当准备'CREATE TABLE login(id INTEGER PRIMARY KEY,name TEXT,email TEXT UNIQUE,uid TEXT,created_at TEXT,email TEXT UNIQUE)'时。

创建表时，您在 SQL 中使用了两次电子邮件列名。

```
sqlite returned: error code = 1, msg = duplicate column name: email 04-14 02:15:33.030: E/Database(301): Failure 1 (duplicate column name: email) 
```

希望这会帮助你。

# javascript - 点击Like按钮后确认链接出现

> ID：10150523
> 
> 赞同：0
> 
> 时间：2012-04-14T02:29:28.850
> 
> 标签：javascript, facebook, facebook-opengraph

我刚刚切换到一个新主机，更改了我的 Facebook 应用程序设置页面上的所有信息，并将 Open Graph 命名空间 URL 添加到我的 HTML 元素中。这是怎么回事？在我的旧域上它正在运行，并且两个帐户都是子域。*我的和其他类似问题的投诉之间的区别在于，我*没有得到**喜欢**。请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:25:25.390

这是 Facebook 的反垃圾邮件措施，一旦人们开始喜欢它，它就会消失。

给看到这个问题的人的一封信。大多数情况下，当您看到此内容并且您知道您不是为了喜欢而进行网络钓鱼时，这很可能是因为您的**QA 团队**在短时间内多次**喜欢和不喜欢内容。**此行为会触发 facebook 的垃圾邮件标记，从而添加确认按钮。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T04:13:05.850

这是 Facebook 的反垃圾邮件措施。一旦人们开始喜欢它，它就会消失。

在没有确认的情况下看到[Facebook Like？](https://stackoverflow.com/questions/7405485/facebook-like-without-confirm)

# php - 取消设置 mysql 表上数组中的特定值

> ID：10150524
> 
> 赞同：0
> 
> 时间：2012-04-14T02:29:32.133
> 
> 标签：php, mysql, unset

我有一个名为related_products 的表，

`products_id`主要产品在哪里 。

并由`related_products_ids`与主要产品相关的产品 ID 组成。

```
--------------------------------------------
|   products_id   |   related_products_ids |
| -----------------------------------------
|    1            |   2,3                  |
| -----------------------------------------
|    2            |   1,3                  |
| -----------------------------------------
|    3            |   1,2                  |
------------------------------------------- 
```

我有复选框，

```
<input value="1" type="checkbox" name="rp_product[]" id="in-category1"> Microsoft IntelliMouse Pro 1
<input value="2" type="checkbox" name="rp_product[]" id="in-category2"> Microsoft IntelliMouse Pro 2
<input value="3" type="checkbox" name="rp_product[]" id="in-category3"> Microsoft IntelliMouse Pro 3 
```

复选框由php生成，

```
 <?php
    echo '<div class="categorydiv"><div id="category-all" class="tabs-panel"><ul id="categorychecklist" class="list:category categorychecklist form-no-clear">';
      $rp_sql = "select products_id, products_name from ".TABLE_PRODUCTS_DESCRIPTION." order by products_id";
      $rp_1 = mysql_query($rp_sql);
            while($rp_2 = mysql_fetch_array($rp_1)) {
            echo "<li id=\"category-".$rp_2['products_id']."\" class=\"popular-category\"><label class=\"selectit\"><input value=\"".$rp_2['products_id']."\" type=\"checkbox\" name=\"rp_product[]\" id=\"in-category-1\"> ".$rp_2['products_name']."</label></li>";
            }
    mysql_free_result($rp_1);
    echo '</ul></div></div>';
    ?> 
```

我使用此代码将选中的复选框保存到`related_products`表中，

```
for ($i=0; $i<count($_POST['rp_product']); $i++)
 {
  $check_val1 .= $_POST['rp_product'][$i] .","; //gather data
 }
$check_val = trim($check_val1, ',');  //clean last ,
unset($check_val1); //flush

$related_products = array('products_id' => (int)$products_id,
                        'related_products_ids' => $check_val);

$insert_rp_ids1 = explode(',', $check_val);

    foreach($insert_rp_ids1 as $rp_ids)
    {
    $result_rp = mysql_query("SELECT related_products_ids, products_id FROM ".TABLE_RELATED_PRODUCTS." where products_id = '" . $rp_ids ."'");

     if(mysql_num_rows($result_rp))
     {
       $related_products_value = mysql_fetch_assoc($result_rp);
       $check_dup = explode(',', $related_products_value['related_products_ids']);
        $rp_values = $related_products_value['related_products_ids'] . "," . $products_id;

        $rps_each1 = array('related_products_ids' => $rp_values);
        if(!in_array($products_id, $check_dup)) {
        $wpdb->update( TABLE_RELATED_PRODUCTS, $rps_each1, array( 'products_id' => $rp_ids ));
        }
     }
       else
            {
               $rps_each2 = array('products_id' => $rp_ids, 'related_products_ids' => $products_id);
               $wpdb->insert(TABLE_RELATED_PRODUCTS, $rps_each2);
            }
    } 
```

当先前选择的复选框被取消选择时，我想要的是列`unset`下的特定 id 。`related_products_ids`

假设我正在编辑 id 所在的帖子`2`以及`related_products_ids`它的所在位置`1,3`.. 我取消选中了值所在的复选框`3`（在 上`related_products_ids`），在点击保存按钮后，将取消设置`3`上的值，因此当前值`related_products_ids`现在是`1`。怎么做？我无法思考并找到解决方案。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:30:00.323

您需要**规范化**您的数据库。在数据库中存储逗号分隔值绝不是一个好主意。

这是我们无法轻松操作数据的非规范化数据库的主要困难。

您应该制作用于存储相关产品的父子表，而不是像这样存储它们。

# c# - 尝试在 C# 中发送邮件，但它似乎不起作用

> ID：10150530
> 
> 赞同：0
> 
> 时间：2012-04-14T02:29:54.193
> 
> 标签：c#, email, smtp

因此，我想尝试使用 Visual C# 应用程序向自己发送一些邮件，但它似乎只是通过代码运行（我知道这一点，因为我在代码末尾放置了一个消息框）并且不发送任何内容。出于明显的原因，我确实更改了下面的电子邮件信息。

这是我所拥有的：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net.Mail;
using System.Net;

namespace WindowsFormsApplication9
{
    public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }

    private void button1_Click(object sender, EventArgs e)
    {
        string Host = "smtp.live.com";
        Int16 Port = 587;
        bool SSL = true;
        string Username = "myemail@hotmail.com";
        string Password = "mypassword";

        // Mail options
        string To = "myemail@hotmail.com";
        string From = "email@hotmail.com";
        string Subject = "This is a test";
        string Body = "It works!";

        MailMessage mm = new MailMessage(From, To, Subject, Body);
        SmtpClient sc = new SmtpClient(Host, Port);
        NetworkCredential netCred = new NetworkCredential(Username, Password);
        sc.EnableSsl = SSL;
        sc.UseDefaultCredentials = false;
        sc.Credentials = netCred;

        MessageBox.Show("Test");
    }
}
} 
```

*注意，我没有得到任何错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T02:40:53.083

你实际上并没有发送邮件。

将此添加到您的代码中 - 您应该能够弄清楚在哪里：

```
sc.Credentials = netCred;

try 
{
  sc.Send(message);
}  
catch (Exception ex) 
{
  MessageBox(ex.ToString());              
}              
MessageBox.Show("Test"); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-14T02:42:26.543

添加这些命名空间...

```
using System.Net.Mail;
using System.Net;
using System.Configuration; 
```

在要发送电子邮件的代码隐藏文件中添加以下代码行。

```
System.Net.Mail.MailMessage mail = new System.Net.Mail.MailMessage("yourEmailId", "destinationEmailId");
mail.Subject = ""; //Enter the text for the subject of the mail in quotes.
mail.Body = ""; //Enter the text for the body of mail within the quotes.
mail.IsBodyHtml = true;
SmtpClient client = new SmtpClient("smtp.live.com");
NetworkCredential cred = new NetworkCredential("yourEmailId", "yourPassword");
client.EnableSsl = true;
client.Credentials = cred;
try
{
client.Send(mail);
}
catch (Exception)
{
} 
```

# c# - 如何缩短这段 C# 面向对象的代码？

> ID：10150533
> 
> 赞同：2
> 
> 时间：2012-04-14T02:30:38.157
> 
> 标签：c#, oop, optimization

这是我的 createcustomer 函数，它向调用者返回一个客户对象，getCustomerDetail 返回一个数据表，然后用值填充客户对象属性。问题是每当对象发生变化时，我必须再次修改它，我该如何解决这个问题，以便我只需要更改 Customer 对象并节省我修改整个代码的工作？

```
 public Objects.Customer createCustomer()
    {
        DataTable dt = Database.Master.Customer.getCustomerDetail(objCustomer.Custcode);

        objCustomer.Billaddress1 = dt.Rows[0]["Billaddress1"].ToString();
        objCustomer.Billaddress2 = dt.Rows[0]["Billaddress2"].ToString();
        objCustomer.Billaddress3 = dt.Rows[0]["Billaddress3"].ToString();
        objCustomer.Billcontact = dt.Rows[0]["Billcontact"].ToString();
        objCustomer.Billfaxno = dt.Rows[0]["Billfaxno"].ToString();
        objCustomer.Billpostalcode = dt.Rows[0]["Billpostalcode"].ToString();
        objCustomer.Billremarks = dt.Rows[0]["Billremarks"].ToString();
        objCustomer.Billtelno = dt.Rows[0]["Billtelno"].ToString();
        objCustomer.Custcode = dt.Rows[0]["Custcode"].ToString();
        objCustomer.Custname = dt.Rows[0]["Custname"].ToString();
        objCustomer.Doout = dt.Rows[0]["Doout"].ToString();
        objCustomer.Douom = dt.Rows[0]["Douom"].ToString();
        objCustomer.Inuom = dt.Rows[0]["Inuom"].ToString();
        objCustomer.Location = dt.Rows[0]["Location"].ToString();
        objCustomer.Outremarks1 = dt.Rows[0]["Outremarks1"].ToString();
        objCustomer.Outremarks2 = dt.Rows[0]["Outremarks2"].ToString();
        objCustomer.Outremarks3 = dt.Rows[0]["Outremarks3"].ToString();
        objCustomer.Pacout = dt.Rows[0]["Pacout"].ToString();
        objCustomer.Pacuom = dt.Rows[0]["Pacuom"].ToString();
        objCustomer.Perout = dt.Rows[0]["Perout"].ToString();
        objCustomer.Peruom = dt.Rows[0]["Peruom"].ToString();
        objCustomer.Shipaddress1 = dt.Rows[0]["Shipaddress1"].ToString();
        objCustomer.Shipaddress2 = dt.Rows[0]["Shipaddress2"].ToString();
        objCustomer.Shipaddress3 = dt.Rows[0]["Shipaddress3"].ToString();
        objCustomer.Shipcontact = dt.Rows[0]["Shipcontact"].ToString();
        objCustomer.Shipfaxno = dt.Rows[0]["Shipfaxno"].ToString();
        objCustomer.Shippostalcode = dt.Rows[0]["Shippostalcode"].ToString();
        objCustomer.Shipremaks = dt.Rows[0]["Shipremaks"].ToString();
        objCustomer.Shiptelno = dt.Rows[0]["BilladdresShiptelnos1"].ToString();
        objCustomer.Shortname = dt.Rows[0]["Shortname"].ToString();

        return objCustomer;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:38:35.140

一些想法：

*   使用[实体框架](http://msdn.microsoft.com/en-us/data/ef.aspx)或[NHibernate等对象关系模型 (ORM) 工具](http://nhforge.org/Default.aspx)
*   使用[CodeSmith Generator 之](http://www.codesmithtools.com/)类的工具自动为您生成此代码
*   使用[AutoMapper](http://automapper.codeplex.com/)和 Reflection 水合您的对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:37:43.550

您可以使用[自动映射器](http://automapper.codeplex.com/)。

```
AutoMapper.Mapper.CreateMap<IDataReader, Objects.Customer>();
var results = AutoMapper.Mapper.Map<IDataReader, IList<Objects.Customer>>(dt.CreateDataReader()); 
```

# opencv - 尝试在 OpenCv 中使用来自 Mat 对象的转换后的 IplImage 对象时出错

> ID：10150535
> 
> 赞同：2
> 
> 时间：2012-04-14T02:31:01.993
> 
> 标签：opencv

> IplImage *IplImg;
> 
> 垫 ImgMat(IplImg);
> 
> imshow（“垫”，ImgMat）；

在 OpenCV 中，如上所述，我可以将 IplImage 对象转换为 Mat 对象，并将这个新的 IplImage 对象与 imshow 函数一起使用。

> 垫 ImgMat;
> 
> IplImage IplImg(ImgMat); //没有错误
> 
> cvNamedWindow("Ipl",CV_WINDOW_NORMAL);
> 
> cvShowImage("Ipl",IplImg); // 抛出错误

但是在将 Mat 对象转换为 IplImage 对象并将这个新对象与 cvShowImage 函数一起使用时，编译器会给出错误：“没有合适的转换函数从“IplImage”到“const CvArr *”

你能帮我弄清楚为什么这个简单的操作不适用于 cvShowImage 吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T10:41:14.377

`cvShowImage`需要一个指向 IplImage 的指针

```
cvShowImage("Ipl",&IplImg); // should not throw 
```

# visual-studio-2010 - SQL Server Compact 4.0 未在 Visual Studio 2010 中显示

> ID：10150537
> 
> 赞同：8
> 
> 时间：2012-04-14T02:31:25.407
> 
> 标签：visual-studio-2010, sql-server-ce

我已将 Visual Studio 2010 SP1 应用到我的 VS2010 Pro。我的 VS 版本现在显示 10.0.40219.1 SP1Rel。

然后我下载并安装了 SQL Server Compact Edition 4.0。

但是，我仍然没有看到 MS SQL Server Compact 4.0 的选项。我只看到 MS SQL Server Compact 3.5。

如何在 VS2010 中使用 SQL Server Compact Edition 4.0？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T08:00:19.417

您需要安装该工具，它主要适用于 Web 项目。请参阅此博客文章：[http ://erikej.blogspot.com/2011/01/sql-server-compact-40-released.html](http://erikej.blogspot.com/2011/01/sql-server-compact-40-released.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-27T10:10:48.263

[http://blogs.msdn.com/b/sqlservercompact/archive/2011/03/15/sql-server-compact-4-0-tooling-support-in-visual-studio-2010-sp1-and-visual- web-developer-express-2010-sp1.aspx](http://blogs.msdn.com/b/sqlservercompact/archive/2011/03/15/sql-server-compact-4-0-tooling-support-in-visual-studio-2010-sp1-and-visual-web-developer-express-2010-sp1.aspx)

只需安装 Windows Web 平台安装程序：

[http://www.microsoft.com/web/downloads/platform.aspx](http://www.microsoft.com/web/downloads/platform.aspx)

搜索“sp1”并找到“Visual Studio 2010”任何提及“SQL Compact 4.0”的内容 - 并安装它。

我认为来自 Microsoft（Web 平台安装程序）的出色工具。

# rest - 如何使用 Meteor 公开 RESTful Web 服务

> ID：10150538
> 
> 赞同：47
> 
> 时间：2012-04-14T02:31:45.363
> 
> 标签：rest, meteor

您将如何使用 Meteor 创建一个安静的 Web 服务。我想在 Appcelerator 中创建连接到同一后端的应用程序。

Meteor 能解决这个问题吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-03-24T05:19:27.680

我在 Meteorpedia 中对此进行了完整的撰写：

[http://www.meteorpedia.com/read/REST_API](http://www.meteorpedia.com/read/REST_API)

这篇文章回顾了创建 REST 接口的所有 6 个选项，从最高级别（例如为您处理一切的智能包）到最低级别（例如编写您自己的 connectHandler）。

此外，这篇文章还介绍了在 Meteor 中使用 REST 接口是对还是错，参考 Meteor REST 测试工具，并解释了 CORS 安全问题等常见缺陷。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-08-01T08:16:45.457

[我最初在这里](https://stackoverflow.com/a/11167874)回答了这个问题，但回顾一下：

要在数据之上添加 RESTful 方法，请查看为 Meteor 编写的 Collection API：

[https://github.com/crazytoad/meteor-collectionapi](https://github.com/crazytoad/meteor-collectionapi)

至于访问数据库的认证，看看这个项目：

[https://github.com/meteor/meteor/wiki/Getting-started-with-Auth](https://github.com/meteor/meteor/wiki/Getting-started-with-Auth)

两者在开发中都绝对是幼稚的，但是您可以创建一个 RESTful API 并将其与移动本地客户端轻松集成。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-01-07T20:31:27.483

我知道这是一个旧线程，但如果有人偶然发现它，我发布了一个用于在 Meteor 0.9.0+ 中编写 REST API 的包：

[https://github.com/kahmali/meteor-restivus](https://github.com/kahmali/meteor-restivus)

它受到[RestStop2](http://github.differential.com/reststop2/)的启发，并使用[Iron Router](https://github.com/EventedMind/iron-router)的服务器端路由构建。在我不那么谦虚的意见中，这是一个比迄今为止在这里发布的任何内容更好的解决方案。

**更新：**为了澄清为什么*我*认为这是一个比上述解决方案“更好”的解决方案，我将指出每个解决方案之间的区别：

**集合API：**
CollectionAPI 仅限于在您的集合上公开非常基本的 CRUD 操作。对于我的使用，在移动应用程序中使用 REST API，发送整个文档可能非常浪费，而且大多数时候我需要对数据进行一些额外的处理（例如，在用于添加好友的 REST 端点，但前提是好友已成功添加）。CollectionAPI 为您提供了一个在端点执行之前运行的钩子，但据我了解，在响应之前没有任何内容，因此您无法修改返回的数据。对于身份验证，CollectionAPI 允许您定义必须随每个请求传递的 authToken。这更像是一个传统的 api 密钥，因为它似乎被硬编码到你的应用程序中，

Restivus，因为它不限于对集合的自动化工作，让您可以完全控制您的端点。它现在提供 Collection API 中包含的所有功能。它还支持用户身份验证和角色权限，因此您可以识别发出请求的用户（并轻松地从经过身份验证的端点访问该用户）。它还提供了一个登录和注销端点来帮助实现这一点。我将在最后提供一个 Restivus 的代码示例。

**HTTP.publish：据**
我了解，这类似于 CollectionAPI，因为它仅限于公开对集合的基本 CRUD 操作。这个更具体地与 Meteor 的发布相关，并允许您使用发布功能来处理 GET 请求。我对文档感到困惑，但它可能有也可能没有一些可用的基本身份验证。我以前没有使用过这个，但我不是它的 API 的忠实粉丝，感觉有点笨拙。一旦我更广泛地出版，我会尝试重新审视它。同一个团队还有另一个名为 HTTP.methods 的包，它不会让您访问发布功能，但具有与 Restivus 类似的 api，并且当时具有类似的功能。

Restivus 是“更好的”，因为它不会限制您使用发布功能，因此可以对您的端点进行更细粒度的控制。如果您只是想将发布函数公开给外部 API，我建议您坚持使用 HTTP.publish。Restivus 也有一个更简单的 API 并支持 HTTP PATCH 方法（似乎没有其他包承认存在）。他们的 HTTP.methods 包与 Restivus 非常相似，只是它缺乏 PATCH 支持，虽然它提供了一些基本的身份验证，但我相信你只能使所有端点都经过身份验证，或者没有。Restivus 将允许您在每个端点（不仅仅是每个路由）级别上控制它。端点上的角色权限（例如，用户、管理员）也可在 Restivus 上使用，但我没有看到任何关于 HTTP 的内容。

**Meteor Router：**
这已被弃用，取而代之的是 Iron Router，请参见下文。

**Iron Router：**
Iron Router 很棒，但它并不是专门为构建 REST API 而设计的。最近他们添加了对应于 HTTP 方法（GET、POST 等）的功能，但它们不支持任何形式的身份验证，并且您只能访问较低级别的 Node 请求和响应对象，因此您将被迫学习如何与这些人合作。一旦你这样做了，你会发现在每个端点都有一些重复的工作要做，比如使用正确的标头和响应代码创建响应。如果您的 API 是从浏览器中使用的，您还必须担心 CORS 合规性。

Restivus 实际上建立在 Iron Router 之上，并在端点上提供了一层身份验证。它还抽象出与 Node 请求和响应对象直接交互的需要，尽管它们仍然存在以防我们错过任何东西。因此，它使用 Iron Router 的所有出色功能和更高级别的 API，为您带来编码乐趣。如果您已经在使用 Iron Router，Restivus 非常棒，因为它不会添加任何额外的依赖项。

**RestStop2：**
我实际上是在我正在处理的一个项目中使用 RestStop2，当时它被弃用以支持 Iron Router。他们有可靠的文档，还有一个我比其他人更喜欢的 API。根据他们的建议，我在 Iron Router 上构建了一个新包，它的灵感来自 RestStop2。Restivus 现在在 RestStop2 GitHub 页面上得到认可，所以我认为他们同意它是一个值得替代的产品。

这是来自 Restivus 文档的快速入门部分的一小段代码：

```
if(Meteor.isServer) {
  Meteor.startup(function () {
    // Global configuration
    Restivus.configure({
      useAuth: true,
      prettyJson: true
    });

    // Generates: GET, POST on /api/users and GET, DELETE /api/users/:id for
    // Meteor.users collection
    Restivus.addCollection(Meteor.users, {
      excludedEndpoints: ['deleteAll', 'put'],
      routeOptions: {
        authRequired: true
      },
      endpoints: {
        post: {
          authRequired: false
        },
        delete: {
          roleRequired: 'admin'
        }
      }
    });

    // Maps to: POST /api/articles/:id
    Restivus.addRoute('articles/:id', {authRequired: true}, {
      post: {
        roleRequired: ['author', 'admin'],
        action: function () {
          var article = Articles.findOne(this.urlParams.id);
          if (article) {
            return {status: "success", data: article};
          }
          return {
            statusCode: 400,
            body: {status: "fail", message: "Unable to add article"}
          };
        }
      }
    });
  });
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-05-08T21:36:54.867

现在 (2013+) 遇到这个问题的人，请查看[Meteor Router](https://github.com/tmeasday/meteor-router)智能包，它提供了用于创建 RESTful 接口的[服务器端路由的方法。](https://github.com/tmeasday/meteor-router#server-side-routing)

```
Meteor.Router.add('/404', [404, "There's nothing here!"]); 
```

为了帮助您将来进行搜索，请务必查看[https://atmosphere.meteor.com](https://atmosphere.meteor.com) - 一个智能包存储库。[Meteorite](http://oortcloud.github.io/meteorite/)是一个非常方便的 CLI 工具，用于版本和包管理。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-02-12T13:33:58.107

最优雅的解决方案似乎是[HTTP.publish](https://github.com/CollectionFS/Meteor-http-publish)。它没有像其他人一样发明新的 API，而是简单地将 HTTP 协议添加到现有的 Meteor[`publish`](http://docs.meteor.com/#meteor_publish)接口中。例如，这意味着它可以自动为 HTTP 和 DDP 工作`Meteor.allow`。`Meteor.deny`

例子：

> 如果传递了一个集合和一个发布函数，`HTTP.publish`它将安装在以下 URL 和方法上：
> 
> GET - /api/list - 所有发布的数据
> POST - /api/list - 将文档插入集合
> GET - /api/list/:id - 找到一个发布的文档
> PUT - /api/list/:id - 更新文档
> DELETE - /api/list/:id - 删除一个文档

```
myCollection = new Meteor.Collection('list');

// Add access points for `GET`, `POST`, `PUT`, `DELETE`
HTTP.publish(myCollection, function(data) {
  // this.userId, this.query, this.params
  return myCollection.find({});
}); 
```

它还没有[完全处理身份验证](https://github.com/CollectionFS/Meteor-http-methods#login-and-logout-todo)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-14T05:26:50.720

我想您可能可以使用 Meteor 创建一个 RESTful 服务，但这并不是该框架的真正用途——Meteor 的主要优点之一是客户端和服务器之间的紧密交互，而 Web 服务没有客户端。如果您喜欢 Ruby，我建议您考虑自己在 node.js 中编写 Web 服务后端，或者像[https://github.com/intridea/grape这样的东西。](https://github.com/intridea/grape)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-11-14T19:46:20.297

是的，您可以使用私有 API 通过 Meteor 公开 REST 端点。该功能将很快公开，但与此同时，请参阅[Can I mount another route handler through ____meteor_bootstrap____.app?](https://stackoverflow.com/questions/10119777/can-i-mount-another-route-handler-through-meteor-bootstrap-app) .

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-09-04T19:56:33.483

我知道这是一个老话题，但您可以使用 Meteor WebApp 包，而不是使用任何外部包： [https](https://docs.meteor.com/packages/webapp.html) ://docs.meteor.com/packages/webapp.html 。

希望能帮助到你！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-11T15:42:42.793

我想我会更新 2014 年的对话。我仍然没有找到在 Meteor 中实现 REST 服务的完美方法，我希望有人能指出我另一个研究方向。我测试了 3 个项目，每个项目都有其缺点：

**[meteor-router](https://github.com/tmeasday/meteor-router)** 我使用meteor-router，但是github页面上说它只会修复错误并在所有新项目中使用Iron Router。我仍在考虑使用它，因为如果它按原样对我有用，那么除了某种类型的身份验证外，不需要升级。

**[Iron-router](https://github.com/EventedMind/iron-router)** 我有一个使用 Iron Router 构建的简单示例服务，但它似乎支持 REST 服务，甚至比meteor-router 还要少，如果有人将无效的 json 发布到 REST 端点，它会导致服务器崩溃。

**[meteor-collectionapi](https://github.com/crazytoad/meteor-collectionapi)** 公开一个 REST api 来支持基本的 CRUD 操作，但它似乎不支持除 id 以外的查询。

# java - 创建另一个任务时取消延迟的任务

> ID：10150539
> 
> 赞同：2
> 
> 时间：2012-04-14T02:31:47.220
> 
> 标签：java, bukkit

我目前有一个延迟任务，只要我点击一个按钮就会运行。单击按钮将布尔值切换为`true`7 秒后，延迟任务将其`false`再次设置为。

然而，如果一个人多次点击按钮，布尔值会被打开和关闭，打开和关闭等等，因为延迟的任务正在堆积。如果多次单击按钮而不是让所有延迟的任务相互堆积，有没有办法简单地延长延迟的任务？

因此，假设单击按钮后，延迟任务将等待 7 秒，然后将布尔值从 切换`true`为。`false`我将如何更改代码，以便如果在延迟任务尚未执行时再次按下按钮，它将取消前一个并简单地执行下一个延迟任务（我将它用于服务器，所以简单地取消前一个任务可能并不意味着这是实际延迟的任务，而是其他一些任务）？

```
@EventHandler
public void damage (EntityDamageEvent event) {
    Entity victim = event.getEntity();
    if (event instanceof EntityDamageByEntityEvent) {
        EntityDamageByEntityEvent edbeEvent = (EntityDamageByEntityEvent) event;
        if(edbeEvent.getDamager() instanceof Player && victim instanceof Player) {
            EntityDamageByEntityEvent edbeEvent1 = (EntityDamageByEntityEvent) event;
            Entity attacker = edbeEvent1.getDamager();
            //Checks if both players are humans and not NPCS.
            final Player player = (Player) victim;
            final Player player2 = (Player) attacker;
            //Saving the players as the variable Player.
            Damagelist.add(player);

            Damagelist.add(player2);
            //Adds both players to the hashmap to be used by other classes.
            isDamaged = true;
            //Toggles the boolean to true.
            int delay = plugin.getConfig().getInt("StunDuration") * 20;
            //The above line gets the delay time from the config.yml file.
            plugin.getServer().getScheduler().scheduleSyncDelayedTask(plugin, new Runnable() {
                public void run() {         

                    Damagelist.remove(player);
                    Damagelist.remove(player2);
                    //After an x amount of time, removes players from hashmap.
                    isDamaged = false;
                    playeradd = true;
                    //Toggles the booleans around.
                }
            }, delay);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:44:06.790

为了确保事件不会针对相同的损坏事件在后续时间运行，您可以使用该`isDamaged`变量来验证代码是否应该运行。

由于您在验证事件后设置`isDamaged`为`true`，您只需要在事件中尽可能高地检查此值，如果为真，则只需退出整个方法，这将停止创建另一个计划任务。

如果您也希望停止对玩家造成伤害，那么您也可以在返回之前取消整个事件以传递给其他在冷却期间不应受到伤害的插件。

```
// End event, add setCancelled(true), and exit method if the isDamaged modifier is set to true
if (isDamaged) {
    event.setCancelled(true);
    return;
} 
```

这是您修改的代码以显示示例使用。

```
@EventHandler
public void damage (EntityDamageEvent event) {
    // Get the victim of the damage event.
    Entity victim = event.getEntity();

    // End event, add setCancelled(true), and exit method if the isDamaged modifier is set to true
    if (isDamaged) {
        event.setCancelled(true);
        return;
    }

    if (event instanceof EntityDamageByEntityEvent) {
        // Get the attacker of the event.
        EntityDamageByEntityEvent edbeEvent = (EntityDamageByEntityEvent) event;
        Entity attacker = edbeEvent.getDamager();

        // Continue only if both players are humans and not NPCS.
        if(edbeEvent.getDamager() instanceof Player && victim instanceof Player) {

            // Saving the players as the variable Player.
            final Player player = (Player) victim;
            final Player player2 = (Player) attacker;

            // Add both players to the hashmap to be used by other classes.
            Damagelist.add(player);
            Damagelist.add(player2);

            // Toggle to true.
            isDamaged = true;

            // Get delay time from the config.yml file.
            int delay = plugin.getConfig().getInt("StunDuration") * 20;

            // Setup delayed task to end cooldown set under StunDuration.
            plugin.getServer().getScheduler().scheduleSyncDelayedTask(plugin, new Runnable() {
                // Define task to be run by scheduler.
                public void run() {         
                    // After amount of time set by StunDuration, remove players from hashmap.
                    Damagelist.remove(player);
                    Damagelist.remove(player2);

                    // Toggle back to false;
                    isDamaged = false;
                    playeradd = true;
                }
            }, delay);
        }
    }
} 
```

# ruby-on-rails - 如何在 IRB/Rails 控制台中抑制返回值的输出？

> ID：10150541
> 
> 赞同：36
> 
> 时间：2012-04-14T02:32:02.243
> 
> 标签：ruby-on-rails, ruby, irb

一个例子是，如果我进入 IRB 并执行以下操作：

```
jruby-1.6.7 :026 > puts [1,2,3,4,5]
1
2
3
4
5
=> nil 
```

反正有压制`nil`吗？问题是，如果我放入一个大型数据结构，它会向其他不相关的返回响应发送垃圾邮件。我对查看调试语句的输出更感兴趣，我在一个块中运行并且必须不断向上滚动并查找真实数据。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-04-14T02:56:48.417

如果您只想偶尔抑制长输出，请使用`;0`，例如：

```
a = [*1..10000];0
# => 0 
```

如果您想普遍抑制它，请使用 ~/.irbrc 文件。IRB.conf[:INSPECT_MODE] 和 IRB.conf[:PROMPT][your_prompt][:RETURN] 控制返回的内容。您可以通过检查 IRB.conf[:PROMPT_MODE] 找出 your_prompt 是什么

例子：

```
IRB.conf[:PROMPT][:DEFAULT][:RETURN] = "" # suppress return value completely 
```

更改值后，您需要重新启动 irb。

希望有帮助。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-02-15T22:04:56.080

您还可以使用以下命令将输出抑制为`irb --simple-prompt --noecho`.

查找以下内容：

```
@ubuntu:~$ irb --simple-prompt
>> puts "hi"
hi
=> nil
>> p "hi"
"hi"
=> "hi"
>> exit
@ubuntu:~$ irb --simple-prompt --noecho
>> puts "hi"
hi
>> p "hi"
"hi"
>> 
```

希望你会没事的。

我正在使用如下红宝石版本：

```
@ubuntu:~$ ruby -v
ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-03-26T09:43:27.917

来自@Tallboy 死链接

要在 Rails 控制台中抑制返回值，请输入
`conf.return_format = ""`

默认（打印返回值）
`conf.return_format = "=> %s\n"`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-10-17T21:54:57.270

我在 irb 中运行以下命令：

```
irb_context.echo = false 
```

例如

```
$ irb
> "foo"
=> "foo"
> irb_context.echo = false
> "foo"
> 
```

# c++ - 析构函数调用（堆栈）变量之间的赋值？

> ID：10150543
> 
> 赞同：5
> 
> 时间：2012-04-14T02:32:26.390
> 
> 标签：c++, destructor, lifetime

```
matrix m1(5,5); 
matrix m2(5,5); 
m1 = matrix(m2); 
```

对于上面的代码（对于任意类，矩阵），当 m2 的信息被复制到它时，是否会为与 m1 关联的信息调用析构函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T02:37:16.640

不，分配操作员需要`m1`在执行分配之前处理释放可能持有的任何资源。`m1`只有在即将超出范围时才会调用析构函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T02:40:58.667

不，一旦构建了在堆栈上分配的对象，它就不会被解构，直到它超出范围或您显式调用其析构函数（您可能永远不应该这样做）。所以在这种情况下，如果矩阵定义了一个重载的 operator=(const matrix& rhs) 成员函数，则调用 operator=() 并将 rhs 复制到 m1 中。否则，使用默认赋值，它简单地将所有成员变量从临时 matrix(m2) 对象复制到 m1，覆盖这些变量的先前值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T02:39:28.000

我认为这取决于矩阵是否正确实现了析构函数以及赋值运算符是如何实现的。如果矩阵有一个有效的析构函数并且矩阵使用“赋值交换”（类似于复制交换习语），那么应该正确释放 M1。

除此之外，调用 m1 = m2 时，您实际上并不需要 Matrix(m2)。这只是调用复制构造函数，然后将临时副本分配给 m1。因此，无用的工作正在发生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T02:51:44.027

这个矩阵是什么容器？如果是价值观，那就没有问题了。如果是智能指针，那么就没有问题。

但是如果涉及到普通的指针呢？然后就完全看执行了`matrix::operator=(const matrix&)`。如果需要在那里调用任何析构函数，它应该调用它们。这不是靠魔法发生的，你必须考虑这些事情。

一般来说，使用普通容器类来保存普通指针是个坏主意。如果不调用析构函数，则会泄漏内存。如果调用析构函数，如果通过另一个指针访问同一个对象，则会崩溃。（想象一下，如果你有两个矩阵都包含指向同一个对象的指针。）

由于使用普通容器类来处理普通指针的容器既困难又危险。为此应使用专门的容器或专门的指针。

例如，Boost 包含专门用于保存指针的[专用容器类。](http://www.boost.org/doc/libs/1_49_0/libs/ptr_container/doc/ptr_container.html)Boost 还有一个[共享指针类](http://www.boost.org/doc/libs/1_49_0/libs/smart_ptr/shared_ptr.htm)，可以被普通容器持有。

你只需要决定应该发生什么。如果你这样做`a=b;`，应该`a`并`b`持有指向相同底层对象的指针吗？还是应该创建新对象`a`以指向内部？

# python - Python函数接受一个对象作为参数？

> ID：10150546
> 
> 赞同：0
> 
> 时间：2012-04-14T02:33:45.847
> 
> 标签：python, function, tree

所以我有以下内容：

```
class Tree(object):
    def__init__(self):
        self.right = None
        self.left = None
        self.val = None 
```

我用我的代码中的东西填充树。

我想写一个表单的函数

```
def mult(newVal, node)
    newVal = diff(node.left, newVal, var)
    newVal.append('*')
    newval.append(next(node.right))
    newVal.append('+')
    newVal = diff(node.left, newVal, var)
    newVal.append('*')
    newVal.append(next(node.left)) 
```

其中 next 只是一个遍历树中下一个节点的函数，而 diff 是以下形式的递归函数：

```
def diff(node, newVal, var):
...
...
    elif(node.val == '*'):
        newVal = diff(node.left, newVal, var)
        newVal.append('*')
        newval.append(next(node.right))
        newVal.append('+')
        newVal = diff(node.left, newVal, var)
        newVal.append('*')
        newVal.append(next(node.left))
...
... 
```

我的“主要”是

```
 node = Tree()
    newEquation = []
    pos = 0
    pos, newTree = buildTree(node, equation, pos)
    newEquation = diff(newTree, newEquation, variable)
    newEquation = ''.join(newEquation)
    print newEquation 
```

我将如何编写 def`mult()`函数来接受树节点作为参数，然后`diff()`再次调用该函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:45:31.143

Python 没有类型，所以如果你调用 mult ：

```
mult(newEquation, node) 
```

那应该工作得很好。

# javascript - 删除当前项目后重新定义可放置区域

> ID：10150548
> 
> 赞同：0
> 
> 时间：2012-04-14T02:33:59.750
> 
> 标签：javascript, jquery, css

我有一个徽标网格。您可以双击徽标以摆脱它，也可以将其拖动到指定的正方形，我希望它可以显示有关该徽标的一些详细信息。

这是有问题的工具：

[拖动或隐藏徽标](http://warcadia.com/site/inxex.html)

如果你能帮助我，我有两个问题：

1.  当我将徽标拖到可放置方块时，您建议我如何收集有关该特定徽标的信息并在可放置区域旁边显示信息？

2.  当我双击已拖放到可拖放区域的徽标时，该徽标将消失。在它消失后，我怎样才能重新定义该可放置区域并将其用于其他徽标？

*如果您看到我可能搞砸的任何其他信息，请告诉我更好的执行方式。太感谢了！*

**这是jQuery：**

```
<script>

$(document).ready(function() {

$('.imageShowing').dblclick (function() {

  $(this).stop().animate({
    zIndex: '1',
    height: '100',
    width: '140',
  }, 100, function() {

        $(this).rotate({ angle:0,animateTo:90,easing: $.easing.easeInOutExpo })

    $(this).stop().animate({
    zIndex: '1',
    top: '500',
    opacity: '0'
  }, 700, function() {   
  $(this).hide("fast");  
    // Animation complete.
  });
  });
});

}); //end document.ready

$(init);

function init(){
    $('.imageShowing').draggable( { 
    containment: '#wrapper',
    cursor: 'move',
    snap: '#droppable',
    stop: cardDropped,
    start: objectGrabbed,
    revert: true,
    }); 

    $('#droppable').droppable( {
        drop: handleCardDrop,
        hoverClass: 'droppableHover',
        accept: '.imageShowing'
    });

}

function objectGrabbed(event, ui) {
    $(this).stop().animate({
    zIndex: '100',
  },0,function() { 
    $(this).stop().animate({
    opacity: '.5'
  }, 500);

  });
}

function cardDropped() {
    $(this).stop().animate({
    opacity: '1',
    zIndex: '12'
  }, 500);
 }

function handleCardDrop( event, ui ) {
    ui.draggable.draggable( 'disable' );
    $(this).droppable( 'disable' );
    ui.draggable.position( { of: $(this), my: 'left top', at: 'left top' } );
    ui.draggable.draggable( 'option', 'revert', false );
    }

</script> 
```

**如果你需要，还有 CSS：**

```
#wrapper { width: 1000px; margin: 0 auto; height: 1000px; position: relative;}
#grid {width: 935px; height: 536px; margin: auto; background: url(images/gridLine.png) repeat-y top; padding:0; position: relative; z-index: 5;} /* height equals 134 X 4\. Each horizontal grid is 134 in height and 950px in width */

#logoWrapper {position: absolute; top: 2px; left: 36px }

#logoWrapper ul {text-decoration: none; list-style-type: none; margin:0; padding:0; }
#logoWrapper ul li {list-style-type: none; float: left; position: relative; padding: 0 6px 6px 0; height: 128px; width: 180px; margin: 0;}
#logoWrapper ul li img { margin:0; position: absolute; z-index: 6;}

#bottom { height: 500px; width: 950px; background: #fff; margin: 0 auto; position: relative; z-index: 10;}
#droppableWrapper {border: dashed 5px #666; width: 180px; margin:0 auto; }
#droppable {height: 128px; width: 180px; background: #CCC;};
.droppableHover {background: #333; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:55:40.380

对于你的第一个问题..对我来说，这取决于：

a）您将显示多少信息，

b）该信息存储在哪里（在html中？logo的数据属性？ajax？）

对我来说，这感觉更像是一个设计问题，但一旦我知道数据在哪里以及它的去向，我就会创建一个函数来检索它，将它放入模板中，然后在页面上显示它。然后挂钩到您的 drop 回调。

对于您的第二个问题...看起来您只需要再次“启用”可放置。也许`$('#droppable').droppable('enable')`在你的 dblclick 动画完成之后，但我会查看 jquery 文档以了解具体信息。

# delphi - 通过 TRttiProperty.SetValue 分配对象过程时引发 EInvalidCast 异常

> ID：10150551
> 
> 赞同：2
> 
> 时间：2012-04-14T02:34:28.747
> 
> 标签：delphi, delphi-xe2, rtti

我正在尝试`procedure of object`使用该过程通过 rtti分配一个类型的属性`TRttiProperty.SetValue`，但是当我尝试进行分配时会引发此异常`EInvalidCast: Invalid class typecast`

此示例应用程序显示了问题

```
{$APPTYPE CONSOLE}

uses
 Rtti,
 SysUtils;

type
  TMyCallBack = procedure (const Foo : string) of object;
  TMyClass    = class
    procedure DoSomething(const Foo: String);
  end;

  TMyAnotherClass  = class
  private
    FDoSomething: TMyCallBack;
  published
    property DoSomething : TMyCallBack read FDoSomething Write FDoSomething;
  end;

{ TMyClass }

procedure TMyClass.DoSomething(const Foo: String);
begin
  Writeln('Hello');
end;

Var
  MyClass : TMyClass;
  t       : TRttiInstanceType;
  v       : TValue;
  p       : TRttiProperty;
  Bar     : TMyCallBack;
begin
  try
    MyClass:=TMyClass.Create;
    try
      t:=TRttiContext.Create.GetType(TMyAnotherClass).AsInstance;
      v:=t.GetMethod('Create').Invoke(t.MetaclassType,[]);
      p:=t.GetProperty('DoSomething');
      Bar:=MyClass.DoSomething;
      if p<>nil then
       p.SetValue(v.AsObject, @Bar); //here the exception is raised
    finally
     MyClass.Free;
    end;
  except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
  Readln;
end. 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T03:34:19.543

当我追踪到错误行时，我最终找到了隐式 TClass->TValue 转换例程。看起来@Bar 是一个指针，编译器隐式地将其转换为 TClass，从那里一切都搞砸了。那不是你想要的。

您需要的是一个类型和值与 Bar 匹配的实际 TValue。试试这个：

```
Var
  MyClass : TMyClass;
  t       : TRttiInstanceType;
  v       : TValue;
  p       : TRttiProperty;
  Bar     : TMyCallBack;
  vBar    : TValue;
begin
  try
    MyClass:=TMyClass.Create;
    try
      t:=TRttiContext.Create.GetType(TMyAnotherClass).AsInstance;
      v:=t.GetMethod('Create').Invoke(t.MetaclassType,[]);
      p:=t.GetProperty('DoSomething');
      Bar:=MyClass.DoSomething;
      vBar := TValue.From<TMyCallback>(bar);
      if p<>nil then
       p.SetValue(v.AsObject, vBar); //here the exception is raised
    finally
     MyClass.Free;
    end;
  except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
  Readln;
end. 
```

# android - C2DM 注册失败，因为相同的 auth_key

> ID：10150552
> 
> 赞同：0
> 
> 时间：2012-04-14T02:34:39.307
> 
> 标签：android, emulation, android-c2dm, user-registration

我目前正在笔记本上测试我的 c2dm 应用程序。我使用了两个模拟器来测试我的服务器和客户端设备之间的通信。问题是第二个设备无法注册到我的服务器，因为它与第一个设备具有相同的 [auth_token]。（他们都有不同的有效 gmail 帐户）。有没有人可以提供帮助，以便我可以使用两个（或更多）具有不同 [auth_token] 的模拟器？谢谢之前.. :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T03:21:15.887

我用上面的代码注册

```
SharedPreferences wmbPreference1 = PreferenceManager.getDefaultSharedPreferences(LoginActivity.this);
boolean isRegistrationId = wmbPreference1.getBoolean("RegistrationId", true);
    if(isRegistrationId)
       {

            Log.w("C2DM", "start registration process");
             SharedPreferences.Editor editor = wmbPreference1.edit();
             editor.putBoolean("RegistrationId", false);
              editor.commit();
              Intent intent = new Intent("com.google.android.c2dm.intent.REGISTER");
intent.putExtra("app",PendingIntent.getBroadcast(put here your current acitivity.this, 0, new Intent(), 0));`

     intent.putExtra("sender", "xyz@gmail.com");//put here different gmail id 
                    startService(intent);
                       } 
```

并使用下面的类来接收注册ID....

```
public class C2DMRegistrationReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        String action = intent.getAction();
        Log.w("C2DM", "Registration Receiver called");
        if ("com.google.android.c2dm.intent.REGISTRATION".equals(action)) {
            Log.w("C2DM", "Received registration ID");
            final String registrationId = intent
                    .getStringExtra("registration_id");
            String error = intent.getStringExtra("error");
            Log.w("C2DM", "Received registration ID"+registrationId);
            Log.d("C2DM", "dmControl: registrationId = " + registrationId
                    + ", error = " + error);
            String deviceId = Secure.getString(context.getContentResolver(),
                    Secure.ANDROID_ID);
            Log.w("C2DM", "Received device ID"+deviceId);

        }
    } 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-14T02:44:30.990

我们无法在模拟器中测试 C2DM。因为它需要设备中的市场应用程序才能注册 C2DM 服务器。并且还需要登录市场应用程序。这样应用程序才能完美运行。

# c++ - 空析构函数崩溃程序：C++

> ID：10150553
> 
> 赞同：0
> 
> 时间：2012-04-14T02:34:53.010
> 
> 标签：c++, destructor

以下程序计算真正大数（例如 600,851,475,143）的所有素数。到目前为止一切正常，除非我大量输入析构函数使应用程序崩溃。谁能看出我的申请有问题？重新检查我的解决方案后，答案是错误的，但问题仍然有效。

```
#include <iostream>
#include <iterator>
#include <algorithm>
#include <vector>
#include <cmath>
#include <stdexcept>
#include <climits>

typedef std::vector<unsigned long long>::const_iterator prime_it;

#define MAX_COL 900000

struct large_vector
{
public:
  large_vector(unsigned long long size, unsigned int row) :
    m_Row(row)
  {
    m_RowVector.reserve(size);
  }
  std::vector<bool> m_RowVector;
  unsigned int m_Row;
};

struct prime_factor
{
public:
  prime_factor(unsigned long long N);
  ~prime_factor() {}
  void print_primes();
private:
  std::vector<bool> m_Primes;
  std::vector<large_vector>m_Vect_Primes;
  unsigned long long m_N;
};

prime_factor::prime_factor(unsigned long long N) :
  m_N(N)
{
  // If number is odd then we need the cieling of N/2 / MAX_COL
  int number_of_vectors = (m_N % MAX_COL == 0) ? (m_N / MAX_COL) : ((m_N / MAX_COL) + 1);
  std::cout << "There will be " << number_of_vectors << " rows";
  if (number_of_vectors != 0) {
    for (int x = 0; x < number_of_vectors; ++x) {
      m_Vect_Primes.push_back(large_vector(MAX_COL, x));
    }

    m_Vect_Primes[0].m_RowVector[0] = false;
    m_Vect_Primes[0].m_RowVector[1] = false;
    unsigned long long increment = 2;
    unsigned long long index = 0;
    while (index < m_N) {
      for (index = 2*increment; index < m_N; index += increment) {
        unsigned long long row = index/MAX_COL;
        unsigned long long col = index%MAX_COL;
        m_Vect_Primes[row].m_RowVector[col] = true;
      }
      while (m_Vect_Primes[increment/MAX_COL].m_RowVector[increment%MAX_COL]) {
        increment++;
      }
    }
  }
}

void prime_factor::print_primes()
{
  for (int index = 0; index < m_N; ++index) {
    if (m_Vect_Primes[index/MAX_COL].m_RowVector[index%MAX_COL] == false) {
      std::cout << index << " ";
    }
  }
}

/*!
 * Driver
 */
int main(int argc, char *argv[])
{
  static const unsigned long long N = 600851475143;
  prime_factor pf(N);
  pf.print_primes();
} 
```

* * *

**更新** 我很确定这是一个工作版本：

```
#include <iostream>
#include <iterator>
#include <algorithm>
#include <vector>
#include <cmath>
#include <stdexcept>
#include <climits>

typedef std::vector<unsigned long long>::const_iterator prime_it;

#define MAX_COL 900000

struct large_vector
{
public:
  large_vector(unsigned long long size, unsigned int row) :
    m_Row(row)
  {
    m_RowVector.resize(size);
  }
  std::vector<bool> m_RowVector;
  unsigned int m_Row;
};

struct prime_factor
{
public:
  prime_factor(unsigned long long N);
  ~prime_factor() {}
  void print_primes();
private:
  std::vector<bool> m_Primes;
  std::vector<large_vector>m_Vect_Primes;
  unsigned long long m_N;
};

prime_factor::prime_factor(unsigned long long N) :
  m_N(N)
{
  // If number is odd then we need the cieling of N/2 / MAX_COL
  int number_of_vectors = (m_N % MAX_COL == 0) ? ((m_N/2) / MAX_COL) : (((m_N/2) / MAX_COL) + 1);
  std::cout << "There will be " << number_of_vectors << " rows";
  if (number_of_vectors != 0) {
    for (int x = 0; x < number_of_vectors; ++x) {
      m_Vect_Primes.push_back(large_vector(MAX_COL, x));
    }

    m_Vect_Primes[0].m_RowVector[0] = false;
    m_Vect_Primes[0].m_RowVector[1] = false;
    unsigned long long increment = 2;
    unsigned long long index = 0;
    while (index < m_N) {
      for (index = 2*increment; index < m_N/2; index += increment) {
        unsigned long long row = index/MAX_COL;
        unsigned long long col = index%MAX_COL;
        m_Vect_Primes[row].m_RowVector[col] = true;
      }
      increment += 1;
      while (m_Vect_Primes[increment/MAX_COL].m_RowVector[increment%MAX_COL]) {
        increment++;
      }
    }
  }
}

void prime_factor::print_primes()
{
  for (unsigned long long index = 0; index < m_N/2; ++index) {
    if (m_Vect_Primes[index/MAX_COL].m_RowVector[index%MAX_COL] == false) {
      std::cout << index << " ";
    }
  }
}

/*!
 * Driver
 */
int main(int argc, char *argv[])
{
  static const unsigned long long N = 400;
  prime_factor pf(N);
  pf.print_primes();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T02:47:37.023

您对储备金的使用不正确。

```
m_RowVector.reserve(size); 
```

这里`m_RowVector`保留了空间，以便向量可以增长而无需重新分配。**但是**的大小`m_RowVector`仍然存在`0`，因此访问任何元素仍然是未定义的。`resize()`您必须使用或更改数组的大小，`push_back()`才能将元素放入向量中。

我看不出有什么问题，但我确信除了矢量问题之外还有其他索引。我会将 operator[] 的使用更改为 at() 方法，当您访问向量末尾的元素并为您提供错误实际位置的线索时，这将引发异常。

# ruby-on-rails - 如果用户已经属于“组”关系，则在迭代期间不显示用户

> ID：10150556
> 
> 赞同：1
> 
> 时间：2012-04-14T02:35:28.747
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有这种关系，用户可以创建一个文档（旅行）并邀请其他用户加入属于该文档的组。我的关系表明“Group”有一个 user_id 和 trip_id 列，所以对于我邀请的每个用户，都会在数据库中创建一个新的 Group 记录。

当我邀请其他用户时，我只希望不在组中的用户出现。已经在组中的用户不应该出现，但我的视图仍然显示用户。

我一直在玩`<% if !friend.trips.include?(@trip)%>`，但我似乎无法获得正确的观点。正在数据库中正确创建记录。

另外，当我查看groups/new.html.erb 时，这是url `http://localhost:3000/groups/new?id=2`，其中id 是trip_id。

我的问题：

1.  我使用的是宁静的约定吗？也就是说，我应该在这里使用新方法（原样）还是应该使用索引方法？
2.  我如何遍历每个朋友的组以确保该组的trip_id 都不等于@trip.id？

谢谢！

查看 (/groups/new.html.erb)

```
<% if !@friends.blank? %>
  <% @friends.each do |friend| %>
     <% if !friend.trips.include?(@trip)%>
          <%= link_to groups_path(:user_id => friend.id, :trip_id => @trip.id), 
                                  :method => :post, :action => 'create' do %>
            <div id="addfriend_totrip_button_groupsnew">add friend to trip</div>
          <% end %>
    <% end %>   
  <% end %>
<% end %> 
```

groups_controller.rb

```
class GroupsController < ApplicationController
before_filter :authenticate, :only => [:update, :create, :destroy]

  def new
   @trip = Trip.find(params[:id])
   @user = User.find(current_user)
   @group = Group.new
   @friends = @user.friends.all 
  end

  def create
    @trip = Trip.find(params[:trip_id])
    @user = User.find(params[:user_id])
    @group = Group.create(:user_id => @user.id, :trip_id => @trip.id)

    if @group.save
      flash[:success] = "Friend added to group."
      redirect_to groups_path(:id => @trip.id)
    else
      flash[:error] = "Could not add friend."
      redirect_to root_path
    end
  end

end 
```

用户.rb

```
class User < ActiveRecord::Base
  has_many :trips, :through => :groups
  has_many :trips, :dependent => :destroy
  has_many :groups
end 
```

行程.rb

```
class Trip < ActiveRecord::Base
  belongs_to :user
  belongs_to :traveldeal
  has_many :groups

  has_many :users, :through => :groups
end 
```

组.rb

```
class Group < ActiveRecord::Base
  belongs_to :trip
  belongs_to :user
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:31:24.707

首先，您在模型中`has_many :trips`调用了两次。`User`我了解您有两种不同类型的`User`关系`Trip`（一种直接关系，一种通过 关系`Group`），但您不能同时给两者同名，否则一种会隐藏另一种。尝试`User`像这样定义您的模型：

```
class User < ActiveRecord::Base
  has_many :group_trips, :through => :groups,
                         :class_name   => "Trip"
  has_many :trips, :dependent => :destroy
  has_many :groups

  def all_trips
    Trip.joins(:groups).where({:user_id => self.id} | {:groups => {:user_id => self.id}})
  end
end 
```

还有一个问题是您正在搜索对象`friend`的列表。尝试将该行更改为：`groups``Trip`

```
<% if !friend.all_trips.include?(@trip) %> 
```

或者没有新方法，这样的东西应该可以工作：

```
<% if !friend.groups.where(:trip_id => @trip.id).first %> 
```

我没有看到任何关于您的方法的非 RESTful 内容。RESTful 通常意味着无状态。即响应唯一依赖的是HTTP 方法和地址。因此，只要您不将状态信息保存在会话中，您就应该遵循 REST。

# user-interface - 复杂、相互依赖的数据的用户界面设计

> ID：10150557
> 
> 赞同：1
> 
> 时间：2012-04-14T02:35:31.587
> 
> 标签：user-interface, usability, user-experience

我正面临一个非常棘手的用户输入问题。我需要我的用户输入偏好的“树形图”而不会不知所措。

例如，假设您正在构建一个应用程序来处理用户对计算机部件的请求。他们可以指定他们在此应用程序中寻找的所有部件（主板、显示器、键盘、CPU 等）。应用程序编译列表并将其发送到仓库以完成。

这就是事情变得棘手的地方。仓库可能没有所有零件。这意味着用户必须提前输入他们的所有偏好，包括后备计划。例如，“如果你有*这个*主板和*这个*CPU，就买它们。否则，试试*那个*主板和*那个*CPU。”

没有双向沟通。用户有机会在订单进入仓库之前输入订单。这意味着他们需要在初始顺序中包含所有偏好。

我知道这很尴尬，但这就是我在这里的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:27:39.680

一旦您对不同概念之间的关系进行了建模，您的 UI 可能会“显露出来”。仓库，订单，电脑零件，CPU，主板。并对流程进行建模：创建订单、选择组件、选择选项、指定优先级、提交订单。

# java - 我不确定如何从我的文本字段中获取数据

> ID：10150560
> 
> 赞同：0
> 
> 时间：2012-04-13T18:44:58.623
> 
> 标签：java, swing

我的文本字段是 main 的本地字段，因此我无法从 actionPerformed 访问它，我相信我需要将其设为实例变量，但我不知道如何做，因为我的框架也在 main 中，所以我不确定我会怎么做将其添加到框架中。

```
import java.awt.*;
import java.awt.event.*;
import java.awt.image.*;
import java.io.*;
import javax.imageio.*;
import javax.swing.*;
import java.net.*;
import java.sql.*;
import java.lang.Object;
import java.awt.Graphics;
import java.awt.Graphics2D;

/**
 * This class demonstrates how to load an Image from an external file
 */
public class Test extends JPanel {

    int x=77, y=441, w=23, h=10;

    BufferedImage img =
  new BufferedImage(100, 50,
                    BufferedImage.TYPE_INT_ARGB);    
   // BufferedImage img;

    public void paintComponent(Graphics g) {
        g.drawImage(img, 0, 0, null);
           // g.fillRect(10,10,10,10);
    }

    public Test() {
       try {
           img = ImageIO.read(new File("sales-goal.png"));
       } catch (IOException e) {}

       Graphics2D g = img.createGraphics();
       Color myColor = Color.decode("#32004b");
       g.setColor(myColor);
       g.fillRect(x,y,w,h);
                //77,441,23,10
    }

    public Dimension getPreferredSize() {
        if (img == null) {
             return new Dimension(100,100);
        } else {
           //return new Dimension(img.getWidth(null), img.getHeight(null));
            return new Dimension(300,600);
       }
    }

    public static void main(String[] args) {

        JFrame f = new JFrame("Load Image Sample");
        JTextField textField=new JTextField();
        f.add(textField);
        textField.setBounds(10,10,40,30);
        textField.setVisible(true);

        f.addWindowListener(new WindowAdapter(){
                public void windowClosing(WindowEvent e) {
                    System.exit(0);
                }
            });

        f.add(new Test());
        f.pack();
        f.setVisible(true);
    }

    public void actionPerformed(ActionEvent e) {
               //if (e.getSource() == textField) {}

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T07:37:48.193

我认为您不应该以这种方式设置您的 Swing 应用程序。`main`您应该创建 JFrame 的子类并在其构造函数（或类似的东西）中进行初始化，而不是在方法中创建所有内容。然后，此类可以保存对其包含的组件的引用。例子：

```
public class TestFrame extends JFrame {

    private JTextField textField;

    public TestFrame() {
        super("Load Image Sample");
        textField = new JTextField();
        this.add(textField);
        textField.setBounds(10,10,40,30);
        textField.setVisible(true);

        this.addWindowListener(new WindowAdapter() {
            public void windowClosing(WindowEvent e) {
                System.exit(0);
            }
        });

        this.add(new Test());
        this.pack();
        this.setVisible(true);
    }

    public void actionPerformed(ActionEvent e) {
        if (e.getSource() == textField) {
            // ...
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T13:41:13.173

创建您的框架并在构造函数中对其进行初始化。

```
public static void main(String[] args) {
    new Test();
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-14T08:09:39.287

事件处理方法`actionPerformed`必须通过`ActionListener`接口注册。由于 textField 和 Test 都是 JFrame 的组件，因此逻辑位置应该是 JFrame，或将所有内容连接在一起的单独控制器类。

我在一些细节上用更传统的方法重写了你的代码。为此，我引入了一个新类 MyFrame。

```
public class MyFrame extends JFrame implements ActionListener {

    JTextField textField = new JTextField();

    public MyFrame(String title) {
        super(title); // Or constructor without parameters and:
        setTitle("Load Image Sample");

        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        //setLayout(...); for instance with null for absolute positioning

        add(textField);
        textField.setBounds(10, 10, 40, 30);
        textField.setVisible(true);

        Test panel = new Test();
        add(panel);

        pack();
    }

    public static void main(String[] args) {
        JFrame f = new MyFrame("Load Image Sample");
        f.setVisible(true);
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        System.out.println("Text: " + textField.getText());
    }
} 
```

然后你的JPanel

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import javax.imageio.ImageIO;
import javax.swing.JPanel;

/**
* This class demonstrates how to load an Image from an external file
*/
class Test extends JPanel {

    int x = 77, y = 441, w = 23, h = 10;
    BufferedImage img;
    Color myColor = Color.decode("#32004b");

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.setColor(myColor);
        g.fillRect(x, y, w, h);

        g.drawImage(img, 0, 0, null);
        // g.fillRect(10,10,10,10);
    }

    public Test() {
        setBackground(Color.red);
        try {
            img = ImageIO.read(new File("sales-goal.png"));
        } catch (IOException e) {
            img = new BufferedImage(100, 50, BufferedImage.TYPE_INT_ARGB);
        }
        setPreferredSize(new Dimension(300, 600));
    }
} 
```

# javascript - 引导响应式导航崩溃的问题

> ID：10150561
> 
> 赞同：4
> 
> 时间：2012-04-14T02:36:51.290
> 
> 标签：javascript, css, twitter-bootstrap

我一直在为此拔头发。该文档使它看起来如此简单，但我无法让折叠的导航栏正确/一致地展开。我必须点击 2-3 次才能展开，而且只有在播放“折叠”动画后才会这样做。

为了隔离这个问题，我创建了这个页面，它有股票引导导航 HTML 和我认为它需要让它工作的最低限度的 .js。

[http://stats.thephish.fm/test.html](http://stats.thephish.fm/test.html)

（相同的导航位于该站点的根索引上）。

帮助表示赞赏！

```
<!DOCTYPE html>
<html lang="en">
<head>
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css"/>
    <link href="css/bootstrap-responsive.css" rel="stylesheet" type="text/css"/>
    <link href="css/my.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/bootstrap-collapse.js"></script>

</head>
<body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="./index.html">Bootstrap</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="">
                <a href="./index.html">Overview</a>
              </li>
              <li class="">
                <a href="./scaffolding.html">Scaffolding</a>
              </li>
              <li class="">
                <a href="./base-css.html">Base CSS</a>
              </li>
              <li class="active">
                <a href="./components.html">Components</a>
              </li>
              <li class="">
                <a href="./javascript.html">Javascript plugins</a>
              </li>
              <li class="">
                <a href="./less.html">Using LESS</a>
              </li>
              <li class="divider-vertical"></li>
              <li class="">
                <a href="./download.html">Customize</a>
              </li>
              <li class="">
                <a href="./examples.html">Examples</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

</body>
</html> 
```

我也尝试在 head 标签中添加这个脚本：

```
<script type="text/javascript">
$(document).ready(function() {
    $('.collapse').collapse();
}); 
</script> 
```

但是当我这样做时，崩溃根本不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T02:19:25.907

包括 bootstrap.js 和 bootstrap-collapse.js。哎呀。我不得不说这有点令人困惑，因为每个插件旁边都说“下载文件”，这似乎表明它是一个增强默认 javascript 库的附加组件。

# javascript - 使用 Javascript 在 UIWebView 中跳转搜索结果

> ID：10150571
> 
> 赞同：1
> 
> 时间：2012-04-14T02:38:19.043
> 
> 标签：javascript, iphone, ios, search, uiwebview

我已经使用 javascript 在 uiwebview 中设置了一个搜索，效果很好，但我希望能够跳转到搜索结果中找到的下一个单词。通过使用以下代码，我已成功使视图滚动到第一个实例：

```
if (uiWebview_SearchResultCount == 1)
{
   var desiredHeight = span.offsetTop - 140;
   window.scrollTo(0,desiredHeight);
} 
```

当用户按下应用程序中的按钮时，如何让这个 searchresultcount 更新到下一个找到的结果（比如 2、3、4、5 等...）？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T05:31:49.393

您是指应用程序中的本机按钮，例如 UIButton 吗？在这种情况下，您可以使用`stringByEvaluatingJavaScriptFromString:`在 UIWebView 中执行一些 JavaScript。作为按钮的处理程序，您可以执行以下操作：

```
- (void)buttonPressedAction:(id)sender {
    NSString * js = @"uiWebview_SearchResultCount++;";
    [yourUIWebView stringByEvaluatingJavaScriptFromString: js];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:04:24.003

我可以在 webview 中用这个 javascript 做基本相同的事情：

```
<script type="text/javascript">
var max = 100;

function goToNext() {
    var hash = String(document.location.hash);
    if (hash && hash.indexOf(/hl/)) {
        var newh = Number(hash.replace("#hl",""));
        (newh > max-1) ? newh = 0 : void(null);
        document.location.hash = "#hl" + String(newh-1); 
    } else {
        document.location.hash = "hl1";        
    }
}

</script> 
```

然后用我的 IBAction 发送这个 JavaScript 调用，如下所示：

```
- (IBAction)next:(id)sender {
    [animalDesciption stringByEvaluatingJavaScriptFromString:@"goToNext()"];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T07:58:07.303

用适当的行调用这个函数？

```
function scrollToDesiredHeight(row) {
   var desiredHeight = span.offsetTop - 140;
   window.scrollTo(0,row * desiredHeight);
} 
```

这对你有用吗？

# api - 通过 API 函数在 PowerBuilder 中打开对象

> ID：10150575
> 
> 赞同：2
> 
> 时间：2012-04-14T02:38:51.727
> 
> 标签：api, powerbuilder

是否可以通过 API 函数在 PowerBuilder 编辑器中打开对象（窗口、用户对象函数等）？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T18:26:32.057

PowerBuilder 接受要打开的工作区、画家和对象的命令行参数。有关命令行参数，请参阅 PowerBuilder 帮助。

例如在 PB 12.5 中 `pb125 /w D:\proj\myapp.pbw /P dataw /O d_order_entry`打开`myapp`工作区并`d_order_entry`在 DataWindow 画家中打开

/P 参数只需要画家姓名的前几个字符，足以唯一标识它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T08:48:35.017

我不知道实际的官方 API，但是 Visual Expert 工具使用一种 hacky/棘手的技术在 IDE 中打开对象：

*   将一个项目添加到待办事项列表中，该项目可以包含对象的引用（待办事项列表的项目在注册表中，例如`HKEY_CURRENT_USER\Software\Sybase\PowerBuilder\11.5\Target\c:$Dev$path_of_the_project$project.pbt\ToDo`
*   然后通过模拟用户与一些windows消息的交互来跳转到它（调用`tools / to do list`菜单项，在列表中搜索正确的目标和项目，等等）

对于我所看到的，您可以精确地定义要在待办事项列表条目上执行的操作，唉，它似乎也没有记录。这是一个例子： `window:///c|\Dev\path_of_the_project\some_lib.pbl?action=open&entry=w_somewindow&event=open)`

# r - 为每个连续序列创建一个组号

> ID：10150579
> 
> 赞同：124
> 
> 时间：2012-04-14T02:39:18.387
> 
> 标签：r, dataframe, sequence

我有下面的data.frame。我想添加一个列“g”，根据列中的连续序列对我的数据进行分类`h_no`。也就是说，h_no 的第一个序列`1, 2, 3, 4`是组 1，`h_no`（1 到 7）的第二个序列是组 2，依此类推，如最后一列“g”所示。

```
h_no   h_freq    h_freqsq g
1     0.09091 0.008264628 1
2     0.00000 0.000000000 1
3     0.04545 0.002065702 1
4     0.00000 0.000000000 1  
1     0.13636 0.018594050 2
2     0.00000 0.000000000 2
3     0.00000 0.000000000 2
4     0.04545 0.002065702 2
5     0.31818 0.101238512 2
6     0.00000 0.000000000 2
7     0.50000 0.250000000 2 
1     0.13636 0.018594050 3 
2     0.09091 0.008264628 3
3     0.40909 0.167354628 3
4     0.04545 0.002065702 3 
```

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2012-04-14T07:56:20.010

您可以使用各种技术将列添加到数据中。下面的引用来自相关帮助文本的“详细信息”部分，`[[.data.frame`.

> 数据帧可以以多种模式进行索引。当`[`和`[[`与单个向量索引（`x[i]`或`x[[i]]`）一起使用时，它们对数据框进行索引，就好像它是一个列表一样。

```
my.dataframe["new.col"] <- a.vector
my.dataframe[["new.col"]] <- a.vector 
```

> 的 data.frame 方法`$`，将`x`其视为列表

```
my.dataframe$new.col <- a.vector 
```

> 当`[`和`[[`与两个索引 (`x[i, j]`和`x[[i, j]]`) 一起使用时，它们的作用类似于索引矩阵

```
my.dataframe[ , "new.col"] <- a.vector 
```

由于该方法`data.frame`假定如果您不指定是使用列还是行，它将假定您的意思是列。

* * *

对于您的示例，这应该有效：

```
# make some fake data
your.df <- data.frame(no = c(1:4, 1:7, 1:5), h_freq = runif(16), h_freqsq = runif(16))

# find where one appears and 
from <- which(your.df$no == 1)
to <- c((from-1)[-1], nrow(your.df)) # up to which point the sequence runs

# generate a sequence (len) and based on its length, repeat a consecutive number len times
get.seq <- mapply(from, to, 1:length(from), FUN = function(x, y, z) {
            len <- length(seq(from = x[1], to = y[1]))
            return(rep(z, times = len))
         })

# when we unlist, we get a vector
your.df$group <- unlist(get.seq)
# and append it to your original data.frame. since this is
# designating a group, it makes sense to make it a factor
your.df$group <- as.factor(your.df$group)

   no     h_freq   h_freqsq group
1   1 0.40998238 0.06463876     1
2   2 0.98086928 0.33093795     1
3   3 0.28908651 0.74077119     1
4   4 0.10476768 0.56784786     1
5   1 0.75478995 0.60479945     2
6   2 0.26974011 0.95231761     2
7   3 0.53676266 0.74370154     2
8   4 0.99784066 0.37499294     2
9   5 0.89771767 0.83467805     2
10  6 0.05363139 0.32066178     2
11  7 0.71741529 0.84572717     2
12  1 0.10654430 0.32917711     3
13  2 0.41971959 0.87155514     3
14  3 0.32432646 0.65789294     3
15  4 0.77896780 0.27599187     3
16  5 0.06100008 0.55399326     3 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-14T15:30:21.423

轻松：您的数据框是 A

```
b <- A[,1]
b <- b==1
b <- cumsum(b) 
```

然后你得到b列。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-14T08:07:00.570

如果我正确理解了这个问题，你想检测什么时候`h_no`不增加，然后增加`class`. （我将介绍我是如何解决这个问题的，最后有一个自包含的函数。）

## 在职的

我们现在只关心`h_no`列，所以我们可以从数据框中提取它：

```
> h_no <- data$h_no 
```

我们想检测什么时候`h_no`没有上升，我们可以通过计算连续元素之间的差异何时为负或为零来做到这一点。R 提供了一个[`diff`](http://stat.ethz.ch/R-manual/R-devel/library/base/html/diff.html)函数，它为我们提供了差异向量：

```
> d.h_no <- diff(h_no)
> d.h_no
 [1]  1  1  1 -3  1  1  1  1  1  1 -6  1  1  1 
```

一旦我们有了它，找到那些是非积极的就很简单了：

```
> nonpos <- d.h_no <= 0
> nonpos
 [1] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE
[13] FALSE FALSE 
```

在 R 中，`TRUE`和 与 和`FALSE`基本相同`1`，`0`所以如果我们得到 的累积和`nonpos`，它将在（几乎）适当的位置增加 1。该[`cumsum`](http://stat.ethz.ch/R-manual/R-devel/library/base/html/cumsum.html)函数（基本上与 的相反`diff`）可以做到这一点。

```
> cumsum(nonpos)
 [1] 0 0 0 1 1 1 1 1 1 1 2 2 2 2 
```

但是，有两个问题：数字太小；而且，我们缺少第一个元素（头等舱应该有四个）。

第一个问题就简单解决了：`1+cumsum(nonpos)`. 第二个只需要`1`在向量的前面添加 a ，因为第一个元素总是在 class 中`1`：

```
 > classes <- c(1, 1 + cumsum(nonpos))
 > classes
  [1] 1 1 1 1 2 2 2 2 2 2 2 3 3 3 3 
```

现在，我们可以将它附加到我们的数据框中[`cbind`](http://www.stat.ucl.ac.be/ISdidactique/Rhelp/library/base/html/cbind.html)（通过使用`class=`语法，我们可以给列`class`标题）：

```
 > data_w_classes <- cbind(data, class=classes) 
```

`data_w_classes`现在包含结果。

## 最后结果

我们可以将这些行压缩在一起并将它们全部包装成一个函数以使其更易于使用：

```
classify <- function(data) {
   cbind(data, class=c(1, 1 + cumsum(diff(data$h_no) <= 0)))
} 
```

`class`或者，因为to 是一个因素是有意义的：

```
classify <- function(data) {
   cbind(data, class=factor(c(1, 1 + cumsum(diff(data$h_no) <= 0))))
} 
```

您可以使用以下任一功能：

```
> classified <- classify(data) # doesn't overwrite data
> data <- classify(data) # data now has the "class" column 
```

（这种解决这个问题的方法很好，因为它避免了显式迭代，这通常推荐给 R，并且避免生成大量中间向量和列表等。而且它可以写在一行上也很整洁 :)）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-14T08:02:23.760

除了罗曼的回答，这样的事情可能更简单。请注意，我没有测试它，因为我现在无法访问 R。

```
# Note that I use a global variable here
# normally not advisable, but I liked the
# use here to make the code shorter
index <<- 0
new_column = sapply(df$h_no, function(x) {
  if(x == 1) index = index + 1
  return(index)
}) 
```

该函数迭代其中的值`n_ho`并始终返回当前值所属的类别。如果`1`检测到值，我们增加全局变量`index`并继续。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-01T09:29:53.987

我相信使用“cbind”是在 R 中向数据框添加列的最简单方法。下面是一个示例：

```
 myDf = data.frame(index=seq(1,10,1), Val=seq(1,10,1))
    newCol= seq(2,20,2)
    myDf = cbind(myDf,newCol) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-28T13:25:21.237

该`data.table`功能`rleid`对于这样的事情很方便。我们减去序列`1:nrow(data)`以将连续序列转换为常数，然后用于`rleid`创建组 ID：

```
data$g = data.table::rleid(data$h_no - 1:nrow(data)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-14T18:30:52.113

基于识别组数（`x`in `mapply`）及其长度（`y`in `mapply`）的方法

```
mytb<-read.table(text="h_no  h_freq  h_freqsq group
1     0.09091 0.008264628 1
2     0.00000 0.000000000 1
3     0.04545 0.002065702 1
4     0.00000 0.000000000 1  
1     0.13636 0.018594050 2
2     0.00000 0.000000000 2
3     0.00000 0.000000000 2
4     0.04545 0.002065702 2
5     0.31818 0.101238512 2
6     0.00000 0.000000000 2
7     0.50000 0.250000000 2 
1     0.13636 0.018594050 3 
2     0.09091 0.008264628 3
3     0.40909 0.167354628 3
4     0.04545 0.002065702 3", header=T, stringsAsFactors=F)
mytb$group<-NULL

positionsof1s<-grep(1,mytb$h_no)

mytb$newgroup<-unlist(mapply(function(x,y) 
  rep(x,y),                      # repeat x number y times
  x= 1:length(positionsof1s),    # x is 1 to number of nth group = g1:g3
  y= c( diff(positionsof1s),     # y is number of repeats of groups g1 to penultimate (g2) = 4, 7
        nrow(mytb)-              # this line and the following gives number of repeat for last group (g3)
          (positionsof1s[length(positionsof1s )]-1 )  # number of rows - position of penultimate group (g2) 
      ) ) )
mytb 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-09-11T02:49:51.247

```
Data.frame[,'h_new_column'] <- as.integer(Data.frame[,'h_no'], breaks=c(1, 4, 7)) 
```

# ruby-on-rails - rails coffeescript RESTful 编辑表单提交未调用

> ID：10150580
> 
> 赞同：0
> 
> 时间：2012-04-14T02:39:19.650
> 
> 标签：ruby-on-rails, forms, rest, coffeescript

在控制器的咖啡脚本文件中，我有

```
jQuery ->
    billing_account.setupForm()

billing_account =
    setupForm: ->
        $('#new_billing_account').submit -> 
```

并且，在创建*新*资源`$('#new_billing_account').submit`时调用该函数。但是，当我*编辑*一个资源时，表单提交时不再调用；但是，确实提交了表单。**`$('#new_billing_account').submit`**

 **我尝试添加不同的表单名称前缀，但既没有`$('#update_billing_account').submit`也没有`$('#edit_billing_account').submit`被调用。

如何获得编辑/更新以调用相同（或任何）表单设置代码？

我正在使用带有 Rails 3.2 的默认 RESTful 生成的资源脚手架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:52:14.417

您必须更改`new_billing_account`为表单的任何 id（查看生成的 html）。默认情况下，rails 将编辑表单上的 id 设置为`edit_model_name_id, for example when editing the`BillingAccount `with id 456, the form would have id`edit_billing_account_456`。

您可以将额外的选项传递给 form for 以强制将 id 设置为常量，或者您可以使用表单的类将设置为的事实`edit_brand`（即，将您的选择器更改为`$('form.edit_billing_account')`**

# ios - iPad - 不要隐藏文本字段的键盘

> ID：10150583
> 
> 赞同：2
> 
> 时间：2012-04-14T02:39:42.127
> 
> 标签：ios, ipad, keyboard, hide

在我的 iPad 应用程序中，第一个视图是身份验证视图。
它有 4 个方框作为 iphone 密码屏幕，用户只需在键盘上输入数字。在这里，方形框被禁用。
现在 iPad 有键盘隐藏按钮和隐藏键盘。问题是我无法带回键盘。如何禁用在此视图中隐藏键盘？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T03:02:58.220

制作认证视图 a`UITextFieldDelegate`并添加以下方法：

```
- (BOOL)textFieldShouldEndEditing:(UITextField *)textField {
    return NO;
} 
```

# arduino - 使用 Sparkfun 的 MP3 播放器扩展板和 Arduino Ethernet Pro - SPI 问题

> ID：10150588
> 
> 赞同：1
> 
> 时间：2012-04-14T02:41:12.410
> 
> 标签：arduino, fat, atmega

我正在使用 Sparkfun 的 Arduino Ethernet Pro 板和 MP3 播放器扩展板（http://www.sparkfun.com/products/10536 和[http://www.sparkfun.com/products/10628](http://www.sparkfun.com/products/10628)）

我尝试使用 Sparkfun 提供的示例，但我一直遇到相同的错误，我已经确定初始化 SD 卡（我使用的是 SdFat）。

为了确定核心问题，我尝试从 SdFat 库运行“SdInfo”示例。这是我的输出：

> SdFat 版本：20111205
> 
> 输入任何字符开始
> 
> card.init 失败
> 
> SD错误代码：0X1
> 
> SD错误数据：0X0

如果我按照 Sparkfun 说明（http://www.sparkfun.com/tutorials/295）将 Sd2PinMap.h 中的 SS_PIN 从 9 更改为 10，则 sdcard.init(...) 方法将挂起。

我认为这个问题是因为 W5100 以太网芯片和 MP3 播放器屏蔽之间的冲突。

有没有我不知道的冲突端口？还是我需要禁用 W5100 芯片？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T10:48:33.020

您使用的所有 SPI 设备都存在片选冲突。MP3 屏蔽的 SparkFun 上的“快速入门”指南讨论了如何更改 SD 库以使用 MP3 屏蔽。您需要进行类似的更改，以便您可以将另一个 CS 引脚用于 MP3 屏蔽，并将 9 和 10 留给 SD 卡和 W5100。

使用多个 SPI 设备时，最好列出 CS 引脚。当您添加一个新的 SPI 设备时，与 MP3 屏蔽一样，您将能够看到哪些引脚已经在做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:11:00.950

您使用的是什么尺寸的 SD 卡？（尝试使用小于 4GB 的 SD 卡以实现兼容性）您不需要根据 Sparkfun 发布的示意图将其更改为引脚 10。还看看 sparkfun 页面，你试过这个吗？[madsci 的库](http://www.billporter.info/sparkfun-mp3-shield-arduino-library/) ，并在声明 card.init(SPI_FULL_SPEED, 9) 中尝试这个 init 命令 .. 让我知道它是如何为你工作的 -Ralim

# php - 如果char匹配，Mysql从字符串中删除最后2个字符

> ID：10150593
> 
> 赞同：2
> 
> 时间：2012-04-14T02:42:04.287
> 
> 标签：php, mysql, sql, select

我的某些行有一些不正确的数据，因此我无法准确搜索。

我的 category_name 列下有如下值：

```
category_name

interior--
exterior
interior 
```

由于`--`在某些类别名称的末尾，我无法获得特定类别的确切计数

我正在使用以下查询

```
select count(id) from designs where category_name='interior' 
```

`--`在where子句中匹配时 如何忽略

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T02:44:52.073

[](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_trim)**`--`使用 TRIM() 函数从值中[**修剪**](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_trim)尾随**

 **```
SELECT count(id) FROM designs WHERE TRIM(TRAILING '--' FROM category_name)='interior' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T02:49:28.830

或者您可以使用 LIKE 仅搜索内部。我想你需要这样做。

```
select count(id) from designs where category_name LIKE 'interior' 
```

希望这能解决你的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T03:29:29.543

要在字段中的任何位置找到字符串“--”并删除前导和尾随空格，这将起作用：

```
SELECT count(id) FROM designs WHERE TRIM(REPLACE(category_name, '--', ''))='interior' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T03:36:01.820

假设您在 category_name 上有一个索引，这将比对每一行应用一个函数更有效，因为它将能够利用该索引：

```
SELECT COUNT(id) FROM designs WHERE category_name IN ('interior', 'interior--') 
```**

# windows-7 - 蝙蝠和 Com，档案。尝试启动 exe 文件时出现初始化错误

> ID：10150598
> 
> 赞同：0
> 
> 时间：2012-04-14T02:43:35.683
> 
> 标签：windows-7, batch-file

我正在尝试从 Bat 文件运行 exe。该错误是弹出**Init Error Genre Unknown。** 游戏自行运行良好。但是想用一个bat文件。/这是什么原因造成的？我已经花了 3 天时间，但对 Google yahoo Dogpile 甚至 webferret 上的 Init 错误类型未知一无所知我确实检查了所有注册表站点以确保我的设置对于 Bat 文件是正确的。

```
 @echo off
    START "" "C:\01Game\1aedit\1aedit.exe" "-i"
    rem start /wait C:\01Game\1aedit\1aedit.exe
    pause
    if not errorlevel 0 goto :ERR1
    goto :STEP2
    :STEP2

    START "" "..\2atop\2atop.exe" "-i"
    rem start /wait C:\01Game\2atop\2atop.exe
    pause
    if not errorlevel 0 goto :ERR2
    goto :ALLOK
   :ERR1
    echo **** Warning: file1 did not work properly! ****
    echo.
    echo Press any key to terminate job ...
    pause>nul
    goto :END
    :ERR2
    echo **** Warning: file2 did not work properly! ****
    echo.
    echo Press any key to terminate job ...
    pause>nul
    goto :END
   :ALLOK
    echo ****** Job completed successfully *****
    echo.
    goto :END
    :END
    EXIT /B 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T09:20:56.623

我想，你只需要`CD`在你的情况下工作目录。

```
cd /d C:\01Game\1aedit\files\audio
start /wait C:\01Game\1aedit\1aedit.exe 
```

顺便提一句。我看不出 的原因`start /wait`，`C:\01Game\1aedit\1aedit.exe`没有它也应该可以工作。

# database - 如何在 Visio 2010 中更改 BOTH ENDS 的可选性和基数？

> ID：10150599
> 
> 赞同：0
> 
> 时间：2012-04-14T02:44:11.137
> 
> 标签：database, database-design, relational-database, database-schema, visio

Visio 让我停滞不前……我只能在一端更改可选性和基数。在这张图片中：

![可选性和基数](../Images/0ef771500b9f2ff937e7a5407e0bf300.png)

此图像中的外键位置是我想要的，但我想要可选性和基数，例如“一个人可以有一个或多个家庭电话，但一个家庭电话可以与一个或多个人相关联”（例如，3 个孩子来自同一个家庭在俱乐部的运动队比赛。因为他们来自同一个家庭，所以他们将共享相同的电话号码）。Visio 只允许我在一端更改基数和可选性，因此这真的很棘手。因为这听起来像是多对多的关系，所以我想我需要在其中添加一个关联实体；但正如我之前所说，Visio 真的让我对此感到困惑。

如果您有 Visio（最好是 2010 年，因为这就是我所拥有的），我已将文件上传到[http://www.downloadthatmovie.com/code-examples/database-diagrams/Database_Schema.zip](http://www.downloadthatmovie.com/code-examples/database-diagrams/Database_Schema.zip)。该文件是 .vsd。这是针对任何需要它的人的 VirusTotal 扫描：

[https://www.virustotal.com/file/ad6efef7aef74c469a2e1bb6dbb5b6e1b4c0d6b160ea635eb829f53becf5ab0d/analysis/1334370994/](https://www.virustotal.com/file/ad6efef7aef74c469a2e1bb6dbb5b6e1b4c0d6b160ea635eb829f53becf5ab0d/analysis/1334370994/)

...和 ​​URL 扫描：

[https://www.virustotal.com/url/db8809b3152eb6dd82f0f3065fe5539bf2ec5325e4eb555530e00ade4d38d6aa/analysis/1334370991/](https://www.virustotal.com/url/db8809b3152eb6dd82f0f3065fe5539bf2ec5325e4eb555530e00ade4d38d6aa/analysis/1334370991/)

抱歉，如果这听起来像是“类似”问题的重复，但我需要用我自己的话来问这个问题，这样我才能得到一个更有可能对我有意义的答案或反馈。如果我能在这个特定问题上获得帮助，我应该可以解决手头更大的问题。

提前致谢！

# javascript - 如果没有任何案例语句匹配，如何显示警报？

> ID：10150611
> 
> 赞同：0
> 
> 时间：2012-04-14T02:46:59.473
> 
> 标签：javascript, jquery

我在下面有一个案例语句，它检查文件输入中的文件类型是否正常工作：

```
function imageValidation(imageuploadform) {
    var val = $(imageuploadform).find(".fileImage").val();
    switch(val.substring(val.lastIndexOf('.') + 1).toLowerCase()){
        case 'gif':
        case 'jpg': 
        case 'jpeg':
        case 'pjpeg':
        case 'png':
             return true;
        default:
            $(imageuploadform).find(".fileImage").val();
            // error message here
            alert("To upload an image, please select an Image File");
            return false;
    }
    return false;
} 
```

现在发生的情况是，如果它与 case 语句之一匹配，则它返回 true，并且默认情况下，它返回一个警报，如果文件输入为空白，我想使用该警报。

但是我怎样才能显示这个警报：

```
alert("Image File Type is Incorrect. Must be either: \n (jpg, jpeg, pjpeg, gif)") 
```

如果文件输入与上述文件类型之一不匹配？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:53:06.710

在您的默认情况下，检查该值是否为空。如果它是空白的，请执行您当前拥有的操作，否则它具有值但与您要查找的内容不匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T03:04:19.460

只需创建一个空案例，它应该可以工作！默认情况下将捕获所有内容，从而捕获您不想要的扩展！

```
case 'png':
     return true;
case '':
     $(imageuploadform).find(".fileImage").val();
     // error message here
     alert("To upload an image, please select an Image File");
     return false;
default:
    alert("To upload an image, please select a valild file extension.");
    return false; 
```

# c - C：创建一个游戏，但在某些情况下我因一个错误和无限循环错误而失败

> ID：10150612
> 
> 赞同：0
> 
> 时间：2012-04-14T02:46:59.887
> 
> 标签：c, arrays, function

我正在上 C 类的入门课程，我的教授让我们为当前的作业编写一个名为“茶话会”的游戏。我已经完成了游戏的编码，它在大多数情况下都可以正常工作，但有些问题我似乎无法解决。

游戏规则很简单：两名玩家轮流旋转旋转器（模拟输入“0”并按下回车键），并为茶会收集所有 7 件物品。第一个获得所有 7 个项目的玩家获胜。唯一的问题是，除非你先有盘子，否则你不能收集三明治、水果或甜点。如果你落在 LOSE A PIECE 方块上，你必须放弃你的一个棋子。这两个错误都来自游戏中的丢失棋子实例，所以我认为错误必须源自“get_lost_piece”函数。

其中之一是“玩家”数组中的棋子编号奇数，因为它们比应有的值高 1 个值。另一个错误是，当玩家在有需要盘子的物品时试图移除盘子时，它应该打印出“对不起，不带盘子吃饭是不礼貌的行为。请输入另一个选择：”，但相反，我得到一个无限循环，上面写着“你丢失了第 1 项”。

这是我的代码：

```
 #include <stdio.h>
    #include <time.h>

    #define SLOW_MODE 1

    #define NUMPLAYERS 2
    #define NUMPIECES 7
    #define MAXLEN 20
    #define NO_WINNER -1

    const char CHOICES[NUMPIECES+1][MAXLEN] = {"PLATE", "NAPKIN", "TEA CUP", "CREAM AND    SUGAR", "SANDWICH", "FRUIT", "DESSERT", "LOSE A PIECE"};

        void update_player(int player[], int square);
    int get_lost_piece(int player[]);
    int search(int piece_list[], int choice);
    int get_spin();
    void init_player(int player[]);
    int get_winner(int players[][NUMPIECES]);
    int get_next_player(int player_num);
    int count_pieces(int player[]);
    void print_player(int player[], int player_num);

    int main() {

    srand(time(0));

    int players[NUMPLAYERS][NUMPIECES];

    // Initialize each player in the game.
    int i;
    for (i=0; i<NUMPLAYERS; i++)
        init_player(players[i]);

    int player_number = 0;

    // Play until we get a winner.
    int status = get_winner(players);
    while (status == NO_WINNER) {

        int dummy;

        // In slow mode, we stop before every spin.
        if (SLOW_MODE) {
            printf("Player %d, it is your turn. Type 0 and enter to spin.\n", player_number+1);
            scanf("%d", &dummy);
        }

        // Get the current player's spin and print out her pieces.
        int square = get_spin();
        printf("Player %d, have landed on the square %s.\n", player_number+1, CHOICES[square]);
        update_player(players[player_number], square);
        print_player(players[player_number], player_number+1);

        // Update the game status.
        player_number = get_next_player(player_number);
        status = get_winner(players);
        printf("\n\n");
    }

    printf("Congrats player %d, you win!\n", status+1);

    return 0;
}

    // Pre-conditions: player stores the contents of one player and square is in between 0 and 7, inclusive.
    // Post-conditions: The turn for player will be executed with the given square selected.
void update_player(int player[], int square) {

    if (square == 7) {

        if (count_pieces(player) == 0)
        {
            printf("There is no piece for you to lose. Lucky you, sort of.\n");
            return;
        }

        else{
            int q;
            q = get_lost_piece(player);
            player[q]= 0;

        }
        return;
    }

    player[square]=search(player, square);

    // Restricted by having no plate!
    if (player[0] == 0) {

       if(square == 4 || square == 5 ||square == 6){
        printf("Sorry, you can't obtain that item because you don't have a plate yet.\n");}

        else{
            if (player[square] == 0){
                player[square]++;
        }
        }
        }

    // Process a regular case, where the player already has a plate.
    else {
        if (player[square] == 0){
            player[square]++;
        }
        }
    }

    // Pre-conditions: player stores the contents of one player that has at least one piece.
    // Post-conditions: Executes asking a player which item they want to lose, and reprompts them
//                  until they give a valid answer.
int get_lost_piece(int player[]) {

    int choice = -1;

    // Loop until a valid piece choice is made.
    while (1) {
    if (choice == -1){
        printf("Which piece would you like to lose?\n");
        print_player(player,choice);
        scanf("%d", &choice);}
    if (player[choice] == 0 && choice < 7 && choice >= 0){
        printf("Sorry, that was not one of the choices");
        scanf("%d", &choice);
        }
    if (player[0] == 1 && choice == 4 || choice == 5 ||choice == 6){
        printf("Sorry, it is bad manners to eat without a plate. Enter another choice:\n");
        scanf("%d", &choice);
        }

    else{
        printf("You lost piece %d\n", choice);
        }
    }

    return choice;
}

// Pre-conditions: piece_list stores the contents of one player
// Post-conditions: Returns 1 if choice is in between 0 and 6, inclusive and corresponds to
//                  an item in the piece_list. Returns 0 if choice is not valid or if the
//                  piece_list doesn't contain it.
int search(int piece_list[], int choice) {

    int i;
    for (i=0; i<NUMPIECES; i++){
        if(piece_list[i]==choice){
           return 1;}
        else {return 0;}
    }
}
// Pre-condition: None
// Post-condition: Returns a random value in between 0 and 7, inclusive.
int get_spin() {

   return rand() % 8;

}

// Pre-condition: None
// Post-condition: Initializes a player to have no pieces.
void init_player(int player[]) {

  int j;

  for (j=0; j< NUMPIECES; j++)
    player[j]=0;

}

// Pre-condition: players stores the current states of each player in the tea party game.
// Post-condition: If a player has won the game, their 0-based player number is returned.
//                 In the case of no winners, -1 is returned.
int get_winner(int players[][NUMPIECES]) {

   int i =0;
  for (i=0; i<NUMPLAYERS; i++){
    if(count_pieces(players[i]) == NUMPIECES) {
        return i;}
  }
 return -1;

}

// Pre-condition: 0 <= player_num < NUMPLAYERS
// Post-condition: Returns the number of the next player, in numerical order, with
//                 a wrap-around to the beginning after the last player's turn.
int get_next_player(int player_num) {

    player_num++;
    if (player_num == NUMPLAYERS){
        player_num = 0;
    }
    return player_num;

}

// Pre-conditions: player stores the contents of one player
// Post-conditions: Returns the number of pieces that player has.
int count_pieces(int player[]) {

    int y, counter;

    counter = 0;

    for ( y = 0; y < 7; y++){
        if(player[y] == 1){
        counter++;
        }
    }
return counter;
}

// Pre-conditions: player stores the contents of one player and player_num is that
//                 player's 1-based player number.
// Post-conditions: Prints out each item the player has, numbered with the numerical
//                  "codes" for each item.
void print_player(int player[], int player_num) {

    int i;

    printf("\n");
    printf("Player %d\n", player_num);

    for (i=0; i < 7; i++){
        if (player[i] == 1){
            printf("%d. %s\n", i + 1, CHOICES[i]);
        }
    }

} 
```

我在这里先向您的帮助表示感谢。我觉得解决方案就在我眼前，但是在花了几天时间之后，我很难发现问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T06:42:42.860

*   需要，`#include <stdlib.h>`_`rand()``srand()`
*   添加`player_number`参数`get_lost_piece()`并将其传递给`print_player`.

以下只是重构的一种思路。它可以通过许多不同的方式来完成。

*   在循环开始时获取一次输入。
*   在每个语句中使用`continue`关键字`if`来重做循环。

当我将逻辑更改`get_lost_piece()`为：

```
 while...
     get choice
     if  choice < 1 || choice > 7   "1-7 please..." continue
     if  player[choice - 1] == 0   "sorry..." continue
     if  choice == 1  (and player[] contains foods)   "bad manners..." continue
 return choice - 1; 
```

有帮助的提示

*   循环应该是有限的并且需要给玩家一个退出选项。
*   查看[常见问题条目](http://c-faq.com/stdio/scanfprobs.html)：`scanf()`返回错误，将内容留在输入流中。
*   尽早测试，经常测试。
*   打开编译器警告（如 catcall 所建议的）

# delphi - 提高旧系统上的 Indy HTTP 客户端性能，尤其是笔记本电脑（Delphi 6）？

> ID：10150620
> 
> 赞同：4
> 
> 时间：2012-04-14T02:49:24.650
> 
> 标签：delphi, http, sockets, indy, robot

我有一个用 Delphi 6 编写的应用程序，它使用 Indy 9.0.18 HTTP 客户端组件来驱动机器人。如果我在安装 Indy 时没记错的话，版本 10 和更新版本不适用于 Delphi 6，所以我使用的是 9.0.18。在较新的桌面上，该程序运行完全正常。但是我在旧笔记本电脑上遇到了一些问题。请注意，在所有情况下，我都绝对没有错误或异常。

机器人是一个 HTTP 服务器，它响应 HTTP 请求来驱动它。要获得连续运动，您必须在连续循环中发送*驱动*命令（例如 - 向前移动）。驱动器命令是对机器人响应的数字 IP 地址的 HTTP 请求，请求中使用的 URL 不涉及域名，因此排除了域名解析的问题（我相信）。一旦你从上一个 HTTP 请求中得到响应，你立即转身发送下一个请求。您可以判断系统何时无法跟上循环，因为机器人会做出一些不平稳的小动作，永远无法达到平稳运动所需的连续动量，因为电机有时间稳定下来并停止。

有问题的两个系统是笔记本电脑，具有以下 CPU 和内存，并且运行的是 Windows XP SP3：

*   AMD Turion 64 X2 移动技术 TL-50（双核），1 GB 主内存，1.6 GHz，双核。
*   AMD Sempron(tm) 140 处理器，1 GB 主内存，2.7 GHZ。请注意，此 CPU 是双核，但仅启用了一个核。

这两个系统都不能获得平滑运动，除非是瞬态，如下所示。

我说这是笔记本电脑问题的原因是因为上面的两个系统都是笔记本电脑。相比之下，我有一个旧的 Pentium 4 单核超线程（2.8 GHz，2.5 GB 内存）。它*可以获得*平滑的运动。但是，尽管机器人连续移动，但移动速度明显变慢，表明 HTTP 请求之间仍然存在轻微延迟，但不足以完全停止电机，因此运动仍然是连续的，尽管明显慢于我的四核或双核桌面.

我知道数据点的另一个区别是旧的 Pentium 4 台式机的内存是笔记本电脑的 2.5 倍，尽管它是一台几乎过时的 PC。也许真正的罪魁祸首是一些内存抖动？机器人时不时地运行平稳，但很快又恢复到口吃状态，这表明在没有任何东西破坏插座上的交互的情况下，偶尔可以实现平稳的运动。*请注意，机器人还双向传输音频到 PC 和从 PC 传输视频，并将视频传输到 PC（但不是另一个方向），因此在驱动机器人的同时进行了大量的处理。*

Indy HTTP 客户端是在后台线程上创建和运行的，而不是在主 Delphi 线程上，在没有睡眠状态的紧密循环中。它确实在循环中进行了 PeekMessage() 调用，以查看是否有任何新命令进入了应该循环而不是当前循环的命令。在循环中调用 GetMessage() 的原因是当机器人应该空闲时线程阻塞，也就是说，在用户决定再次驱动它之前，不应向它发送 HTTP 请求。在这种情况下，向线程发布新命令会解除对 GetMessage() 调用的阻塞，并且新命令会被循环。

我尝试将线程优先级提高到 THREAD_PRIORITY_TIME_CRITICAL 但效果绝对为零。请注意，我确实使用 GetThreadPriority() 来确保确实提高了优先级，并且在 SetThreadPriority() 调用之前最初返回 0 之后，它返回了 15 的值。

1) 那么我能做些什么来提高这些旧的低功耗系统的性能，因为我的几个最好的用户都有它们呢？

2）我的另一个问题是，有没有人知道 Indy 是否必须在每个 HTTP 请求中重建连接，或者它是否智能地缓存套接字连接，这样就不会有问题了？如果我使用较低级别的 Indy 客户端套接字并自己制作 HTTP 请求会有所不同吗？我想避免这种可能性，因为这将是一次重大的重写，但如果这是一个高度确定的解决方案，请告诉我。

我在下面包含了后台线程的循环，以防您发现任何低效的情况。要执行的命令通过来自主线程的异步 PostThreadMessage() 操作发布到线程。

```
// Does the actual post to the robot.
function doPost(
            commandName,    // The robot command (used for reporting purposes)
            // commandString,  // The robot command string (used for reporting purposes)
            URL,            // The URL to POST to.
            userName,       // The user name to use in authenticating.
            password,       // The password to use.
            strPostData     // The string containing the POST data.
                : string): string;
var
    RBody: TStringStream;
    bRaiseException: boolean;
    theSubstituteAuthLine: string;
begin
    try
        RBody := TStringStream.Create(strPostData);

        // Custom HTTP request headers.
        FIdHTTPClient.Request.CustomHeaders := TIdHeaderList.Create;

        try
            FIdHTTPClient.Request.Accept := 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8';
            FIdHTTPClient.Request.ContentType := 'application/xml';
            FIdHTTPClient.Request.ContentEncoding := 'utf-8';
            FIdHTTPClient.Request.CacheControl := 'no-cache';
            FIdHTTPClient.Request.UserAgent := 'RobotCommand';

            FIdHTTPClient.Request.CustomHeaders.Add('Connection: keep-alive');
            FIdHTTPClient.Request.CustomHeaders.Add('Keep-Alive: timeout=30, max=3 header');

            // Create the correct authorization line for the commands stream server.
            theSubstituteAuthLine :=
                basicAuthenticationHeaderLine(userName, password);

            FIdHTTPClient.Request.CustomHeaders.Add(theSubstituteAuthLine);

            Result := FIdHTTPClient.Post(URL, RBody);

            // Let the owner component know the HTTP operation
            //  completed, whether the response code was
            //  successful or not.  Return the response code in the long
            //  parameter.
            PostMessageWithUserDataIntf(
                                FOwner.winHandleStable,
                                WM_HTTP_OPERATION_FINISHED,
                                POSTMESSAGEUSERDATA_LPARAM_IS_INTF,
                                TRovioCommandIsFinished.Create(
                                        FIdHttpClient.responseCode,
                                        commandName,
                                        strPostData,
                                        FIdHttpClient.ResponseText)
                                );
        finally
            FreeAndNil(RBody);
        end; // try/finally
    except
        {
            Exceptions that occur during an HTTP operation should not
            break the Execute() loop.  That would render this thread
            inactive.  Instead, call the background Exception handler
            and only raise an Exception if requested.
        }
        On E: Exception do
        begin
            // Default is to raise an Exception.  The background
            //  Exception event handler, if one exists, can
            //  override this by setting bRaiseException to
            //  FALSE.
            bRaiseException := true;

            FOwner.doBgException(E, bRaiseException);

            if bRaiseException then
                // Ok, raise it as requested.
                raise;
        end; // On E: Exception do
    end; // try/except
end;

// The background thread's Excecute() method and loop (excerpted).
procedure TClientThread_roviosendcmd_.Execute;
var
    errMsg: string;
    MsgRec : TMsg;
    theHttpCliName: string;
    intfCommandTodo, intfNewCommandTodo: IRovioSendCommandsTodo_indy;
    bSendResultNotification: boolean;
    responseBody, S: string;
    dwPriority: DWORD;
begin
    // Clear the current command todo and the busy flag.
    intfCommandTodo := nil;
    FOwner.isBusy := false;

    intfNewCommandTodo := nil;

    // -------- BEGIN: THREAD PRIORITY SETTING ------------

    dwPriority := GetThreadPriority(GetCurrentThread);

    {$IFDEF THREADDEBUG}
    OutputDebugString(PChar(
        Format('Current thread priority for the the send-commands background thread: %d', [dwPriority])
    ));
    {$ENDIF}

    // On single CPU systems like our Dell laptop, the system appears
    //  to have trouble executing smooth motion.  Guessing that
    //  the thread keeps getting interrupted.  Raising the thread priority
    //  to time critical to see if that helps.
    if not SetThreadPriority(GetCurrentThread, THREAD_PRIORITY_TIME_CRITICAL) then
        RaiseLastOSError;

    dwPriority := GetThreadPriority(GetCurrentThread);

    {$IFDEF THREADDEBUG}
    OutputDebugString(PChar(
        Format('New thread priority for the the send-commands background thread after SetThreadPriority() call: %d', [dwPriority])
    ));
    {$ENDIF}

    // -------- END  : THREAD PRIORITY SETTING ------------

    // try

    // Create the client Indy HTTP component.
    theHttpCliName := '(unassigned)';

    theHttpCliName := FOwner.Name + '_idhttpcli';

    // 1-24-2012: Added empty component name check.
    if theHttpCliName = '' then
        raise Exception.Create('(TClientThread_roviosendcmd_.Execute) The client HTTP object is nameless.');

    FIdHTTPClient := TIdHTTP.Create(nil);

    { If GetMessage retrieves the WM_QUIT, the return value is FALSE and    }
    { the message loop is broken.                                           }
    while not Application.Terminated do
    begin
        try
            bSendResultNotification := false;

            // Reset the variable that detects new commands to do.
            intfNewCommandTodo := nil;

            {
                If we are repeating a command, use PeekMessage so that if
                there is nothing in the queue, we do not block and go
                on repeating the command.  Note, intfCommandTodo 
                becomes NIL after we execute a single-shot command.

                If we are not repeating a command, use GetMessage so
                it will block until there is something to do or we
                quit.
            }
            if Assigned(intfCommandTodo) then
            begin
                // Set the busy flag to let others know we have a command
                //  to execute (single-shot or looping).
                // FOwner.isBusy := true;

                {
                    Note: Might have to start draining the queue to
                    properly handle WM_QUIT if we have problems with this
                    code.
                }

                // See if we have a new command todo.
                if Integer(PeekMessage(MsgRec, 0, 0, 0, PM_REMOVE)) > 0 then
                begin
                    // WM_QUIT?
                    if MsgRec.message = WM_QUIT then
                        break // We're done.
                    else
                        // Recover the command todo if any.
                        intfNewCommandTodo := getCommandToDo(MsgRec);
                end; // if Integer(PeekMessage(MsgRec, FWndProcHandle, 0, 0, PM_REMOVE)) > 0 then
            end
            else
            begin
                // Not repeating a command.  Block until something new shows
                //  up or we quit.
                if GetMessage(MsgRec, 0, 0, 0) then
                    // Recover the command todo if any.
                    intfNewCommandTodo := getCommandToDo(MsgRec)
                else
                    // GetMessage() returned FALSE. We're done.
                    break;
            end; // else - if Assigned(intfCommandTodo) then

            // Did we get a new command todo?
            if Assigned(intfNewCommandTodo) then
            begin
                //  ----- COMMAND TODO REPLACED!

                // Update/Replace the command todo variable.  Set the
                //  busy flag too.
                intfCommandTodo := intfNewCommandTodo;
                FOwner.isBusy := true;

                // Clear the recently received new command todo.
                intfNewCommandTodo := nil;

                // Need to send a result notification after this command
                //  executes because it is the first iteration for it.
                //  (repeating commands only report the first iteration).
                bSendResultNotification := true;
            end; // if Assigned(intfNewCommandTodo) then

            // If we have a command to do, make the request.
            if Assigned(intfCommandTodo) then
            begin
                // Check for the clear command.
                if intfCommandTodo.commandName = 'CLEAR' then
                begin
                    // Clear the current command todo and the busy flag.
                    intfCommandTodo := nil;
                    FOwner.isBusy := false;

                    // Return the response as a simple result.
                    // FOwner.sendSimpleResult(newSimpleResult_basic('CLEAR command was successful'), intfCommandToDo);
                end
                else
                begin
                    // ------------- SEND THE COMMAND TO ROVIO --------------
                    // This method makes the actual HTTP request via the TIdHTTP
                    //  Post() method.
                    responseBody := doPost(
                        intfCommandTodo.commandName,
                        intfCommandTodo.cgiScriptName,
                        intfCommandTodo.userName_auth,
                        intfCommandTodo.password_auth,
                        intfCommandTodo.commandString);

                    // If this is the first or only execution of a command,
                    //  send a result notification back to the owner.
                    if bSendResultNotification then
                    begin
                        // Send back the fully reconstructed response since
                        //  that is what is expected.
                        S := FIdHTTPClient.Response.ResponseText + CRLF + FIdHTTPClient.Response.RawHeaders.Text + CRLF + responseBody;

                        // Return the response as a simple result.
                        FOwner.sendSimpleResult(newSimpleResult_basic(S), intfCommandToDo);
                    end; // if bSendResultNotification then

                    // If it is not a repeating command, then clear the
                    //  reference.  We don't need it anymore and this lets
                    //  us know we already executed it.
                    if not intfCommandTodo.isRepeating then
                    begin
                        // Clear the current command todo and the busy flag.
                        intfCommandTodo := nil;
                        FOwner.isBusy := false;
                    end; // if not intfCommandTodo.isRepeating then
                end; // if intfCommandTodo.commandName = 'CLEAR' then
            end
            else
                // Didn't do anything this iteration.  Yield
                //  control of the thread for a moment.
                Sleep(0);

        except
            // Do not let Exceptions break the loop.  That would render the
            //  component inactive.
            On E: Exception do
            begin
                // Post a message to the component log.
                postComponentLogMessage_error('ERROR in client thread for socket(' + theHttpCliName +').  Details: ' + E.Message, Self.ClassName);

                // Return the Exception to the current EZTSI if any.
                if Assigned(intfCommandTodo) then
                begin
                    if Assigned(intfCommandTodo.intfTinySocket_direct) then
                        intfCommandTodo.intfTinySocket_direct.sendErrorToRemoteClient(exceptionToErrorObjIntf(E, PERRTYPE_GENERAL_ERROR));
                end; // if Assigned(intfCommandTodo) then

                // Clear the command todo interfaces to avoid looping an error.
                intfNewCommandTodo      := nil;

                // Clear the current command todo and the busy flag.
                intfCommandTodo := nil;
                FOwner.isBusy := false;
            end; // On E: Exception do
        end; // try
    end; // while not Application.Terminated do 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T03:59:46.707

要正确使用 HTTP keep-alives，请使用`FIdHTTPClient.Request.Connection := 'keep-alive'`instead of`FIdHTTPClient.Request.CustomHeaders.Add('Connection: keep-alive')`或 set `FIdHTTPClient.ProtocolVersion := pv1_1`。至少它在 Indy 10 中是这样工作的。当我有机会时，我会仔细检查 Indy 9。

无论您使用哪个版本，机器人都必须首先支持keep-alives，否则`TIdHTTP`别无选择，只能为每个请求建立一个新的套接字连接。如果机器人发送不包含`Connection: keep-alive`标头的 HTTP 1.0 响应或包含标头的 HTTP 1.1 响应，`Connection: close`则不支持 keep-alives。

# windows-phone-7 - 屏幕上的原始图像显示

> ID：10150629
> 
> 赞同：0
> 
> 时间：2012-04-14T02:51:58.360
> 
> 标签：windows-phone-7

我的视频文件在 .raw 文件中，我想使用位图方法逐帧读取它。但是我的视频太大了大约 1.6gb。那么我该怎么做才能在手机上显示呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T06:19:57.047

您需要将视频转码为更适合手机的格式，例如 MP4。您可以使用[VLC](http://wiki.videolan.org/Transcode)等软件进行转码。

# arduino - 解决 Arduino 中的错误

> ID：10150631
> 
> 赞同：2
> 
> 时间：2012-04-14T02:52:52.093
> 
> 标签：arduino

我正在做一个项目，我正在努力掌握它。使用[WiShield](http://asynclabs.com/store?page=shop.product_details&product_id=26&vmcchk=1)。我一直在尝试完成一个简单高音扬声器的示例程序。但是，我还没有运气。我一直在努力寻找解决方案，但我发现的一切似乎都不起作用。我该如何解决这个问题？

我的代码以及我收到的错误如下。

### 代码

```
#include <WiServer.h>

#define WIRELESS_MODE_INFRA    1
#define WIRELESS_MODE_ADHOC    2

unsigned char local_ip[] = {192,168,2,2};
unsigned char gateway_ip[] = {192,168,2,1};
unsigned char subnet_mask[] = {255,255,255,0};
const prog_char ssid[] PROGMEM = {"myssid"};

unsigned char security_type = 3; // 0 - open; 1 - WEP; 2 - WPA; 3 - WPA2

const prog_char security_passphrase[] PROGMEM = {"mywifipassword"};

prog_uchar wep_keys[] PROGMEM = {
    0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,    // Key 1
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,    // Key 2
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00    // Key 3
};

unsigned char wireless_mode = WIRELESS_MODE_INFRA;
unsigned char ssid_len;
unsigned char security_passphrase_len;

// Authentication string for the Twitter account.
char* auth = "[user:pass]"; // Base64 encoded USERNAME:PASSWORD

// This function generates a message with the current system time.
void currentTime() {
    WiServer.print("Arduino has been running for ");
    WiServer.printTime(millis());
}

// A request that sends a tweet using the currentTime function.
TWEETrequest sentMyTweet(auth, currentTime);

void setup() {
    // Initialize WiServer (we'll pass NULL for the page serving function since we don't need to serve web pages).
    WiServer.init(NULL);

    // Enable Serial output and ask WiServer to generate log messages (optional).
    Serial.begin(57600);
    WiServer.enableVerboseMode(true);
}

// Time (in milliseconds) when the next tweet should be sent.
long tweetTime = 0;

void loop(){
    // Check if it's time to sent a tweet
    if (millis() >= tweetTime) {
        sentMyTweet.submit();
        // Send next tweet 5 minutes from now
        tweetTime += 1000 * 60 * 5;
    }

    // Run WiServer
    WiServer.server_task();

    delay(10);
} 
```

### 错误

在 SimpleTweeter.cpp:5 包含的文件中：

```
C:\Program Files (x86)\arduino-1.0\libraries\WiShield/WiServer.h:198: error: conflicting return type specified for 'virtual void Server::write(uint8_t)'

C:\Program Files (x86)\arduino-1.0\hardware\arduino\cores\arduino/Print.h:48: error:   overriding 'virtual size_t Print::write(uint8_t)'

SimpleTweeter.pde:-1: error: 'TWEETrequest' does not name a type

SimpleTweeter.cpp: In function 'void loop()':

SimpleTweeter.pde:-1: error: 'sentMyTweet' was not declared in this scope 
```

（我是 Arduino 的新手。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T22:31:47.737

看起来 WiServer 库尚未升级为与 Arduino 1.0 一起使用。在这个版本的 Arduino 软件中，类中 write 方法的返回类型`Print`由`void`改为`size_t`.

Juan C. Muller在[GitHub 上](http://en.wikipedia.org/wiki/GitHub)有[一个 WiShield 的分支，](https://github.com/jcmuller/WiShield)它与 Arduino 1.0 兼容。

关于类型的后续错误`TWEETrequest`是此先前错误的连锁反应。

# cocoa-touch - 如何在表格视图上方添加封面照片（如路径或每个应用程序）

> ID：10150632
> 
> 赞同：0
> 
> 时间：2012-04-14T02:52:54.120
> 
> 标签：cocoa-touch, uitableview, uiimageview

我正在尝试在 UITableView 上方添加封面照片，以使照片看起来处于固定位置，并且 UITableView 在其顶部滚动。

Path 和 EveryMe 都有这个功能。

**图 1：初始外观**

**图 2：表格垂直滚动时的外观（注：图像顶部不变）**

[http://imgur.com/a/b35IG](http://imgur.com/a/b35IG)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T04:01:39.273

在我看来，这：

*   图像视图放置在表格视图之后，因此它保持在固定位置
*   表格视图的背景是透明的，因此图像可以通过
*   表格有一个非常高的标题（或第一行），也有一个透明的背景
*   表格中的其他单元格背景不透明

# spring - Spring 3 MVC，多部分表单和控制器映射问题

> ID：10150634
> 
> 赞同：0
> 
> 时间：2012-04-14T02:53:17.647
> 
> 标签：spring, controller, multipart

我的应用程序始终使用提交名称作为操作名称。到目前为止它已经奏效了。

输入多部分表格...

**html**

```
<form:form modelAttribute="screenObject" enctype="multipart/form-data">
<input name="save"  value="Save" type="submit" /> 
```

**控制器**

```
public static final String ACTION_SAVE="save";
@RequestMapping(method=RequestMethod.POST, params=ACTION_SAVE)
public ModelAndView save(@ModelAttribute("screenObject") FileHeaderEditScreenObject screenObject, BindingResult bindingResult, Model model, Locale locale) { 
```

**错误**

```
message Request method 'POST' not supported 
```

如果我删除`enctype="multipart/form-data"`，控制将直接流入该`save`方法。我确实需要对这个多部分表单执行不同的操作。我想保持一致，所以我希望我不必引入任何隐藏字段来表示操作或将表单提交到不同的 url...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T03:32:39.717

我建议`params=ACTION_SAVE`从注释中删除。看起来它没有解析来自多部分请求的提交操作。

您可以将该参数作为请求参数处理：

```
@RequestMapping(method=RequestMethod.POST, params=ACTION_SAVE)
public ModelAndView save(
   @RequestParam(value = "submit", required = true) String action,
   @ModelAttribute("screenObject") ....

{
     switch (action) {
        case "action1": ...
        case "action2": ...
     }
} 
```

这不是很好。我会像这样使用不同的 URL：

```
@RequestMapping("/action1"})
    public void action1(

@RequestMapping("/action2"})
    public void action2( 
```

# java - 如何从 Lucene 的 TokenStream 中删除数字？

> ID：10150635
> 
> 赞同：0
> 
> 时间：2012-04-14T02:53:22.183
> 
> 标签：java, lucene, analyzer

我编写了一个自定义分析器，它用一个长度包装了一个 StandardAnalyzer。现在我想过滤掉所有只包含数字的术语。实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:51:19.427

您可能需要定制`TokenFilter`。查看最简单的过滤器之一，[LowerCaseFilter](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.lucene/lucene-core/3.5.0/org/apache/lucene/analysis/LowerCaseFilter.java)。我认为您会发现按照这些思路编写自己的代码很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-30T14:27:03.227

您可以使用[PatternReplaceFilter](https://lucene.apache.org/core/5_4_0/analyzers-common/org/apache/lucene/analysis/pattern/PatternReplaceFilter.html)通过正则表达式从 TokenStream 中检测和删除数字。

# c# - 将方法放在一个大类中是否“节省内存”？（许多对象）

> ID：10150636
> 
> 赞同：2
> 
> 时间：2012-04-14T02:53:23.540
> 
> 标签：c#, xna

我正在为移动平台开发一款游戏，其中内存始终是一个问题。

我正在使用一个基本的抽象类敌人。所有其他敌人将是此类的变体。

我最初的意图是将更新敌人的方法存储在基类中，然后将具体行为存储在每个子敌人类中。

我的问题是：每次加载（或关卡）可能有数百个敌人，我是否会节省内存将我的所有行为写入每个敌人所指的一个大类中？换句话说，拥有数百个敌人，每个敌人都有一大堆行为代码，是否比将所有内容存储在单个引用类中需要更多的内存？

初步构想：

```
enemy.Update() 
```

节省内存的想法：

```
//Static class is named EnemyBehavior
EnemyBehavior.UpdateEnemy(enemy) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T02:56:25.757

尽管您的类的每个实例都有其自己的私有的、消耗内存的变量副本，但它**没有**其方法定义的单独副本。方法消耗每个*类*的内存，而不是每个*实例*。这才有意义，因为类实例不可能更改方法的定义。所以，对不起，但你的想法不会节省任何记忆。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-14T02:57:01.710

这不是记忆的工作方式。堆需要存储*数据*和引用，而不是*实际代码*。因此，您不会通过决定在静态类中将“通用代码”存储在何处来保存任何内容 - 将代码与您的对象实例一起使用并不意味着它被物理复制到每个实例中。

您的建议违背了面向对象编程的全部原因，即行为封装和关注点分离。

tl; dr - 将代码与类本身一起保存。

# android - 在圆形视图中绘制文本？

> ID：10150642
> 
> 赞同：9
> 
> 时间：2012-04-14T02:55:14.880
> 
> 标签：android

我想在圆形视图中画一个字符串说“stackoverflow”，如下图所示，任何人都可以建议如何去做。而且我还需要每个字符的点击事件。

![图片](../Images/a1dc30167403f1778de90558f7096c3a.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T04:21:18.747

您需要为此制作自定义视图。在 onDraw 方法中，创建一个路径对象，向该对象添加圆形，然后使用 Canvas 对象在该路径上绘制文本。

```
Path path = new Path();
path.addCircle(x, y, radius, Path.Direction.CW);
myCanvas.drawTextOnPath(myText, path, offset, 0, myPaint); 
```

编辑：

使用 os 4.0 及以上版本时使用这行代码：

```
setLayerType(View.LAYER_TYPE_SOFTWARE, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T03:42:46.217

看看两者`Path.addCircle`和`Canvas.drawTextOnPath`API。

# android - Android：无法从非硬编码 URL 播放视频

> ID：10150645
> 
> 赞同：2
> 
> 时间：2012-04-14T02:56:02.893
> 
> 标签：android

我正在尝试流式传输视频并使用 VideoView 播放。我使用 setVideoURI() 为视图提供视频的源 URL，如下所示。使用像 urlString = "www.myvideoserver.com/videos/bigbuckbunny.mp4" 这样的硬编码值，视频可以正常播放。但是，当 urlString 被赋予来自意图的值（来自用户选择视频的上一个活动）时，我收到消息：“抱歉，无法播放视频”。我读过一个常见的原因是视频格式，就像[这里](https://stackoverflow.com/questions/8714033/android-videoview-gives-me-alert-sorry-this-video-cannot-be-played)和[这里描述的那样](https://stackoverflow.com/questions/8012494/sorry-this-video-cannot-be-played-streaming-mp4-to-android). 我几乎可以肯定这不是格式问题，因为我可以在 URL 固定时播放视频（我知道这一点是因为我可以从 Log.d("PVurl", urlString); 中看到 urlString 的值是与我修复的完全相同。也就是说，在 LogCat 中，我将值复制粘贴到该行`urlString = getIntent()... // "www.myvideoserver.com/videos/bigbuckbunny.mp4"`中，它可以工作，但当 urlString 设置为意图返回值时它不起作用。LogCat Errror 面板给出以下内容：

```
04-13 17:35:32.786: ERROR/MediaPlayer(2620): error (1, -1007)
04-13 17:35:32.786: ERROR/MediaPlayer(2620): Error (1,-1007) 
```

我在互联网上搜索过，但似乎没有人以前遇到过这样的错误代码。

如果有人知道可能是什么问题，我将不胜感激。谢谢！

```
public void playvideo () { // obtain URL of the requested video from the intent in previous activity

    try
    {
        urlString =  getIntent().getStringExtra("mypackage.fulladdr");

        if (urlStr != null)
        {
            Log.d("PVurl", urlString);

            VideoView v = (VideoView) findViewById(R.id.videoView1);

            // play video

            v.setVideoURI(Uri.parse(urlString));
            v.setMediaController(new MediaController(this));
            v.start();

            v.setOnCompletionListener(new OnCompletionListener() {
                public void onCompletion(MediaPlayer mp) {
                    showRatingDialog();
                }
            });
        }
    }
    catch (Exception e)
    {
        Log.d("PV_TAG", +e.getMessage());
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T05:02:01.733

您尚未添加 Uri 需要找出它所指内容的方案 (http，在您的情况下)。

`urlString = "www.myvideoserver.com/videos/bigbuckbunny.mp4"`将其更改为 `urlString = "http://www.myvideoserver.com/videos/bigbuckbunny.mp4"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-12T17:57:23.623

(1, -1007) 错误表示：MEDIA_ERROR_UNKNOWN - “文件或网络相关的操作错误。”

这可能来自损坏的文件

另请参阅 android.media.MediaPlayer.OnErrorListener#onError [http://developer.android.com/reference/android/media/MediaPlayer.OnErrorListener.html#onError的 javadoc](http://developer.android.com/reference/android/media/MediaPlayer.OnErrorListener.html#onError)

```
@param what the type of error that has occurred:
MEDIA_ERROR_UNKNOWN
MEDIA_ERROR_SERVER_DIED

@param extra an extra code, specific to the error. Typically implementation dependent.
MEDIA_ERROR_IO
MEDIA_ERROR_MALFORMED
MEDIA_ERROR_UNSUPPORTED
MEDIA_ERROR_TIMED_OUT 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T05:02:49.890

我尝试了同样的事情并且能够让它工作。也许您的代码中发生了其他事情。这是我所拥有的：

```
// Intent to start the activity that launches the video player
Intent i = new Intent(this, ExampleActivity.class);
i.putExtra("url", "http://www.yourvideo.com/yourvid.m4v");
startActivity(i); 
```

这是处理播放器的代码：

```
private MediaController mController;
private Uri videoUri; 
private int percentBuffered= 0;
private VideoView videoView;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.your_layout);

    mController = new MediaController(this);

    videoView = (VideoView) findViewById(R.id.videoView1);

    // access String from the intent that launched this Activity
    videoUri = Uri.parse(getIntent().getStringExtra("url"));
}

@Override
public void onResume() {
    super.onResume();
    videoView.setOnCompletionListener(this);
    try {
        videoView.setVideoURI(videoUri);
        mController.setMediaPlayer(videoView);
        videoView.setMediaController(mController);
        videoView.requestFocus();
        videoView.start();
    } catch (Exception e) {
        e.printStackTrace();
    }
}

@Override
protected void onPause() {
    super.onPause();
    finish();
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    mController.show();
    return super.onTouchEvent(event);
}

@Override
public int getBufferPercentage() {
    return percentBuffered;
}

@Override
public int getCurrentPosition() { 
    return videoView.getCurrentPosition();
}

@Override
public int getDuration() {
    return videoView.getDuration();
}

@Override
public boolean isPlaying() {
    return videoView.isPlaying();
}

@Override
public void pause() {
    videoView.pause();
}

@Override
public void seekTo(int pos) {
    videoView.seekTo(pos);
}

@Override
public void start() {
    videoView.start();
}

@Override
public void onBufferingUpdate(MediaPlayer mp, int percent) {
    percentBuffered = percent;
}

@Override
public void onCompletion(MediaPlayer mp) {

}

public boolean canPause() {
    return true;
}

public boolean canSeekBackward() {
    return true;
}

public boolean canSeekForward() {
    return true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T05:38:55.413

好吧，经过数小时徒劳的挖掘以找出 MediaPlayer error(1, -1007) 的含义后，我发现了这个问题。

实际上，这与 getIntent().getStringExtra("mypackage.fulladdr"); 行这一相当不幸的事实有关。返回一个末尾带有额外空格的字符串。我认为这是 getIntent() 的实现问题。任何人都知道在哪里报告这些错误，那就太好了。

感谢@Akhil 和@javaMe 的尝试！

# javascript - window.localStorage 未按预期工作

> ID：10150650
> 
> 赞同：1
> 
> 时间：2012-04-14T02:57:32.850
> 
> 标签：javascript, jquery, html, local-storage

我有以下内容：

```
$(document).ready(function () {
   var store = window.localStorage;
   $('#accounts > li > a').click(function (e) {
                var store = window.localStorage;
                e.preventDefault();
                store.setItem('account1', $(this).html());
                alert($(this).html());
                alert(store.getItem('account1'));
   });
   ... 
```

当我对链接进行更改时，第一个警报给了我正确的值，但最后一个警报只给了我空值。我正在使用 Firefox 11（非常最新）和 IE 9。我认为两者都允许本地存储。

谁能看到我做错了什么。看起来很简单的代码。我只是无法存放物品。

这是我正在使用的 HTML：

```
<div style="margin-top: 20px;" class="btn-group">
    <label style="background: none; background-color: #333; width: 120px;" 
    class="btn btn-inverse" id="account">X</label>

    <button data-toggle="dropdown" class="btn btn-inverse dropdown-toggle">
    <span class="caret"></span>

    </button>
    <ul class="dropdown-menu" id="accounts">
    <li><a data-value="00" href="#">A</a></li>
    <li><a data-value="01" href="#">B</a></li>

    <li><a data-value="02" href="#">C</a></li>
    <li><a data-value="16" href="#">D</a></li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:07:02.163

我完全按照上面的方式复制了您的代码并将其放在 jsfiddle 上。我不得不即兴创作 HTML，因为你没有发布它，但它适用于我在 Chrome、Safari 和 IE9 上。

我建议发布您的 HTML。这可能是问题所在。

这个演示对你有用吗？：

[http://jsfiddle.net/ThinkingStiff/MRLEW/](http://jsfiddle.net/ThinkingStiff/MRLEW/)

# concurrency - 打印到标准输出会导致阻塞的 goroutine 运行？

> ID：10150652
> 
> 赞同：7
> 
> 时间：2012-04-14T02:58:07.347
> 
> 标签：concurrency, go, goroutine

作为一个愚蠢的基本线程练习，我一直在尝试在 golang中实现[睡眠理发师问题。](http://en.wikipedia.org/wiki/Sleeping_barber_problem)有了频道，这应该很容易，但我遇到了一个 heisenbug。也就是说，当我尝试诊断它时，问题就消失了！

考虑以下。该`main()`函数将整数（或“客户”）推送到`shop`通道上。`barber()`阅读`shop`频道为“客户”剪头发。如果我`fmt.Print`在函数中插入一条语句`customer()`，程序会按预期运行。否则，`barber()`永远不要剪别人的头发。

```
package main

import "fmt"

func customer(id int, shop chan<- int) {
    // Enter shop if seats available, otherwise leave
    // fmt.Println("Uncomment this line and the program works")
    if len(shop) < cap(shop) {
        shop <- id
    }
}

func barber(shop <-chan int) {
    // Cut hair of anyone who enters the shop
    for {
        fmt.Println("Barber cuts hair of customer", <-shop)
    }
}

func main() {
    shop := make(chan int, 5) // five seats available
    go barber(shop)
    for i := 0; ; i++ {
        customer(i, shop)
    }
} 
```

知道发生了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T04:52:33.797

问题在于 Go 的调度程序的实现方式。当前的 goroutine 只有在进行系统调用或阻塞通道操作时才能让步给其他 goroutine。`fmt.Println`进行系统调用，给 goroutine 一个让步的机会。否则它没有一个。

在实践中，这通常并不重要，但对于像这样的小问题，它有时会突然出现。

此外，在通道上进行非阻塞发送的一种更惯用、更不活泼的方式是：

```
func customer(id int, shop chan<- int) {
    // Enter shop if seats available, otherwise leave
    select {
    case shop <- id:
    default:
    }
} 
```

你这样做的方式，客户最终可能会在理发店外等待，因为当你实际发送时，`len(shop)`可能已经改变了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T04:48:24.453

`runtime.GOMAXPROCS(2)`在 main 开头添加可以解决这个问题吗？

# machine-learning - 您将使用什么算法来基于人员属性进行聚类？

> ID：10150653
> 
> 赞同：1
> 
> 时间：2012-04-14T02:58:08.160
> 
> 标签：machine-learning, data-mining, cluster-analysis

我是机器学习领域的新手（即使我觉得它非常有趣），我想开始一个小项目，在那里我可以应用一些东西。

假设我有一个人员数据集，其中每个人有 N 个不同的属性（只有离散值，每个属性几乎可以是任何东西）。

我想找到表现出相同行为的人群，即他们的属性具有相似模式（“相似”）。

你会怎么做？有什么想法可以让我开始吗？

我正在考虑使用 PCA，因为我们可以有任意数量的维度，这可能有助于减少它。K-均值？我不确定在这种情况下。关于什么最适合这种情况的任何想法？

我确实知道如何编写所有这些算法，但我真的缺少一些现实世界的经验来知道在这种情况下应用什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T03:01:16.967

使用 n 维属性向量的 K-means 是一种合理的入门方式。您可能想使用距离度量来查看它如何影响结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T06:16:55.240

几乎任何聚类算法的第一步都是找到合适的距离函数。许多算法，例如`DBSCAN`可以用这个距离函数参数化（至少在一个体面的实现中。当然有些只支持欧几里得距离......）。

所以从考虑如何测量对象相似度开始吧！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-15T09:56:31.140

在我看来，您还应该尝试期望最大化算法（也称为[EM](http://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm)）。另一方面，在使用 PCA 时必须小心，因为该算法可能会减少与聚类相关的维度。

# vim - VIM：不要在 HTML 链接中为前导空格加下划线

> ID：10150659
> 
> 赞同：8
> 
> 时间：2012-04-14T03:02:10.240
> 
> 标签：vim

> **可能重复：**
> [为什么 vim 在制表符的位置绘制下划线以及如何避免这种情况？](https://stackoverflow.com/questions/4625274/why-is-vim-drawing-underlines-on-the-place-of-tabs-and-how-to-avoid-this)

在 CentOS 5.x 上的 VIM 7.0 中缩进 PHP 代码时，HTML 链接显示为下划线。这非常方便，但在某些地方我在该 HTML 中缩进了 PHP 代码，并且整个缩进都带有下划线：

```
 <li class="picture">
________________<a href="<?=$linkUrl?>">
____________________<img src="/<?=$img['source']?>" alt="Picture"/>
____________________<? if ($someCondition): ?><span class="info"><?=$img['info']?></span><? endif; ?>
________________</a>
            </li> 
```

有没有办法告诉语法荧光笔忽略 HTML 链接中的行前空白？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-15T20:35:30.063

我设法通过修改来实现这一点`$VIMRUNTIME/syntax/html.vim`。复制到`~/.vim/syntax/html.vim`（在 Windows`.vim`上命名`vimfiles`），并替换原始语法定义

```
syn region htmlLink start="<a\>\_[^>]*\<href\>" end="</a>"me=e-4 contains=@Spell,htmlTag,htmlEndTag,htmlSpecialChar,htmlPreProc,htmlComment,javaScript,@htmlPreproc 
```

具有以下内容：

```
syn region htmlLink start="<a\>\_[^>]*\<href\>" end="</a>"me=e-4 keepend contains=@Spell,htmlTag,htmlEndTag,htmlSpecialChar,htmlPreProc,htmlComment,htmlLinkText,javaScript,@htmlPreproc
syn match htmlLinkText contained contains=@Spell,htmlTag,htmlEndTag,htmlSpecialChar,htmlPreProc,htmlComment,htmlLinkText,javaScript,@htmlPreproc "^\s*\zs.\{-}\ze\s*$"
syn match htmlLinkText contained contains=@Spell,htmlTag,htmlEndTag,htmlSpecialChar,htmlPreProc,htmlComment,htmlLinkText,javaScript,@htmlPreproc "\S.\{-}\ze\s*$" 
```

再往下，改变

```
HtmlHiLink htmlLink                    Underlined 
```

到

```
HtmlHiLink htmlLinkText                Underlined 
```

瞧！基本上，这引入了另一个包含的语法 group `htmlLinkText`，它不匹配前导空格和尾随空格，而是将突出显示应用于那个。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-14T04:00:42.970

你可以这样做：

```
:hi link htmlLink NONE 
```

# java - 肥皂查询数据库

> ID：10150660
> 
> 赞同：0
> 
> 时间：2012-04-14T03:02:20.033
> 
> 标签：java

我在 java soap 服务上编写了一个操作来查询数据库，然后在客户端 jsp 页面上显示我搜索过的数据。但是，我不能显示它，变量“rs”不能改变，我不知道为什么？有人可以帮我找到麻烦吗？这是我在肥皂服务上创建的操作：

```
 @WebMethod(operationName = "query")
public String query(@WebParam(name = "parameter") String parameter) {
    ResultSet rs;
    try {
        Connection con = data1.getConnection();
        Statement statement = con.createStatement();
        String QueryString;
        QueryString = "SELECT * from stud where name= parameter";
        rs = statement.executeQuery(QueryString);
        while (rs.next()) {
            System.out.println(rs.getInt(1) + " " + rs.getString(2) + "\n");

        }
    } catch (Exception ex) {
        System.out.println("Unable to connect to batabase.");//TODO write your implementation code here:
    }
    //TODO write your implementation code here:
    return null;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T03:21:22.043

我不完全确定我理解你的问题。也许你的意思是你可以查看控制台输出并且这个过程认为 rs 是一个空的结果集。您说 rs 无法更改，但您可能意识到 rs 存储整个结果集并且您只分配一次，因此如果您的代码当前正在运行，它不会“更改”。

一个明显的错误是参数是一个变量（实际上是一个参数！）但是您将它包含在引号中作为查询字符串的一部分。因此，无论函数是否输入，您都在数据库中搜索名称“参数”

# css - CSS 快捷方式类

> ID：10150665
> 
> 赞同：1
> 
> 时间：2012-04-14T03:03:41.860
> 
> 标签：css, class, shortcut, shorthand

我不知道这是否只是我的无能，但我经常为需要特殊处理的元素编写内联样式，例如：

```
<div class="asd" style="float:right;"></div>
<a class="asd" href="#" style="font-weight:bold;"></a> 
```

我觉得通过使用这样的快捷类更容易实现

```
<div class="asd right"></div>
<a class="asd bold"></a> 
```

所以我想知道在这种情况下制定这样的快捷课程规则是否是普遍和公认的做法？对我来说似乎是这样，这引出了我的实际问题：**是否有此类快捷规则的库？**因此，无论我走到哪里，我都可以放入一个 css 文件并随身携带这些快捷方式。如果不是，我想我可以自己做，但我真的想知道它是否真的是公认的做法还是有缺点？也许所有这些规则甚至都可以跟在 !important 之后，并带有某种前缀以避免冲突。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:09:22.473

不，这是一个糟糕的主意。

您特别[没有使用内容的语义标签](http://phrogz.net/css/HowToDevelopWithCSS.html#semanticselector)。

*总结为什么这很糟糕：CSS 的主要好处之一是能够在不改变内容的情况下改变你在网站上的外观。如果您将演示文稿混合到您的内容中，而不是使用描述其内容的类对其进行注释，那么您永远无法在不编辑 HTML 的情况下调整您的视觉效果（否则您最终会遇到诸如`.right { font-weight:bold; float:left }`如果您决定“那些项目”应该如何出现）。*

# python - 从统计文件构建计数字典

> ID：10150666
> 
> 赞同：1
> 
> 时间：2012-04-14T03:03:46.170
> 
> 标签：python, dictionary

我有一个这样的统计文件：

`dict-count.txt`

```
apple   15
orange  12
mango   10
apple   1
banana  14
mango   4 
```

我需要计算每个元素的数量并创建一个像这样的字典：`{'orange': 12, 'mango': 14, 'apple': 16, 'banana': 14}`. 我执行以下操作来实现这一目标：

```
from __future__ import with_statement

with open('dict-count.txt') as f:
    lines = f.readlines()

output = {}

for line in lines:
    key, val = line.split('\t')
    output[key] = output.get(key, 0) + int(val)

print output 
```

我特别关心这部分：

```
key, val = line.split('\t')
output[key] = output.get(key, 0) + int(val) 
```

有一个更好的方法吗？或者这是唯一的方法？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T03:15:05.357

对于一个小文件，您可以使用`.readlines()`，但这会一次性将文件的全部内容吞入内存。您可以使用文件对象`f`作为迭代器来编写它；当你迭代它时，你一次得到一行输入。

所以，写这个最简单的方法是使用`defaultdict`@Amber 已经显示的，但我的版本没有构建输入行列表；它只是构建字典。

我使用了简洁的变量名，比如`d`dict 而不是`output`.

```
from __future__ import with_statement
from collections import defaultdict
from operator import itemgetter

d = defaultdict(int)

with open('dict-count.txt') as f:
    for line in f:
        k, v = line.split()
        d[k] += int(v)

lst = d.items()

# sort twice: once for alphabetical order, then for frequency (descending).
# Because the Python sort is "stable", we will end up with descending
# frequency, but alphabetical order for any frequency values that are equal.
lst.sort(key=itemgetter(0))
lst.sort(key=itemgetter(1), reverse=True)

for key, value in lst:
    print("%10s| %d" % (key, value)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T03:06:52.367

使用[`defaultdict`](http://docs.python.org/library/collections.html#collections.defaultdict)：

```
from __future__ import with_statement
from collections import defaultdict

output = defaultdict(int)

with open('dict-count.txt') as f:
    for line in f:
        key, val = line.split('\t')
        output[key] += int(val)

print output 
```

# c# - win表单应用程序在服务器上崩溃

> ID：10150667
> 
> 赞同：1
> 
> 时间：2012-04-14T03:03:57.327
> 
> 标签：c#, winforms, multithreading, visual-studio-2010

我在服务器上运行 winforms 应用程序，在运行该应用程序一段时间后，该应用程序崩溃并显示以下图片中的消息。我想知道是否有人有类似的东西并帮助我解决这个问题，因为它只发生在服务器上而不是本地。

图片：

![在此处输入图像描述](../Images/9b5dd5fa5e5d1641d1875b5119093350.png)

![![Imgur](http://i.imgur.com/invLK)](../Images/26be7aa8b96f322f573364f7b4285afe.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T06:47:02.073

这是典型的崩溃场景，您可以考虑以下情况，

[http://blogs.msdn.com/b/lexli/archive/2009/08/23/when-the-application-program-crashes-on-windows.aspx](http://blogs.msdn.com/b/lexli/archive/2009/08/23/when-the-application-program-crashes-on-windows.aspx)

如果无法在该服务器上安装 VS 进行调试，则应从该机器捕获故障转储，然后在另一台机器上使用 WinDbg + sos 对其进行分析。

# android - Android：播放音频的精确时间

> ID：10150670
> 
> 赞同：3
> 
> 时间：2012-04-14T03:04:22.263
> 
> 标签：android, audio, timer

我正在编写一个使用录制的样本（使用 SoundPool）播放音乐的 android 应用程序。我有一个播放器，它根据当前时间（realTimeElapsed）检查我必须播放哪些样本。播放器使用我设置为 1 毫秒的计时器进行更新。大多数时候这工作正常，但有时我有大约 100 毫秒的延迟。

我找不到增加计时器优先级的方法，还有其他方法可以解决这些延迟吗？

我同时使用 openGL 渲染场景，但如果我禁用所有绘图，我会得到相同的延迟。

谢谢

编辑：

我用 TraceView 分析了它：音频线程（Thread-16）每毫秒执行一次。但是在 t=2580 时有大约 200 毫秒的中断。在此期间线程没有处于睡眠状态，而是在 SoundPool.play 方法中并被中断。每次我有这样的延迟时，音频线程都会被中断。没有办法防止这些中断吗？

我已将 GL 线程（中断音频线程）的优先级设置为 THREAD_PRIORITY_LOWEST。 ![跟踪视图](../Images/0a1d02988c0bfc66b5b92285e4b8c6a9.png)

右键单击图像并选择“显示图像”或附近的东西以全分辨率查看图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T04:57:09.460

我建议尝试[Handler.postDelayed()](http://developer.android.com/reference/android/os/Handler.html#postDelayed%28java.lang.Runnable,%20long%29)而不是 Timer，看看你是否能得到更好的结果。

如果没有，也许只是一个带有短[Thread.Sleep()](http://developer.android.com/reference/java/lang/Thread.html#sleep%28long,%20int%29)的线程，并检查[System.nanoTime()](http://developer.android.com/reference/java/lang/System.html#nanoTime%28%29)？

# c# - C# 列表和 ArgumentOutOfRangeException 的问题

> ID：10150680
> 
> 赞同：2
> 
> 时间：2012-04-14T03:07:04.923
> 
> 标签：c#, list, xna, outofrangeexception

我正在制作一款农业/塔防游戏，而且我对编程非常陌生。在 XNA 中使用 Lists<> 或数组似乎有一个主要问题。我无法让它从列表中返回我想要的索引。

主要问题在我的种植引擎内部。我已经成功实现了一个种植系统，它可以生成具有不同属性的植物（精灵对象）列表并将它们放置在地图上。现在，我需要一种方法来访问植物列表中基于鼠标单击该植物的特定植物。我觉得我很接近，但我最终得到了一个我无法解决的 ArgumentOutOfRangeException。这是代码的演练：

初始化

```
 public void Addplants()
        {
            switch (Mode)
            {
            case "Wotalemon":
            NewPlant = new Plant(Texture, msRect);
            NewPlant.AddAnimation("seed", 0, 16, 64, 64, 1, 0.1f);
            NewPlant.AddAnimation("sprout", 64, 16, 64, 64, 1, 0.1f);
            NewPlant.AddAnimation("wota", 128, 16, 64, 64, 1, 1.0f);
            NewPlant.CurrentAnimation = "seed";
            NewPlant.DrawOffset = new Vector2(32, 48);
            NewPlant.Position = Position;
            NewPlant.Type = "wotalemon";
            NewPlant.Birthday = Days;
            NewPlant.IsSelected = false;
            plants.Add(NewPlant);
            thisPlant = NewPlant;
            //various plants after this 
```

更新/绘制

我使用一些简单的 foreach 循环来更新和绘制植物，这里没有问题。

GetInfo（此方法使用 spriteobject 的 hitbox 属性和 mouseRectangle）

```
public void GetInfo(Rectangle ms)
        {
            msRect = ms;
            for (int i = 0; i < plants.Count; i++)
            {
                foreach (Plant NewPlant in plants)
                {
                    if (NewPlant.BoundingBox.Intersects(msRect))
                    {
                        SelectedIndex = i;
                        NewPlant.Tint = Color.Black;
                    }
                    else
                        NewPlant.Tint = Color.White;
                }

            }
        } 
```

最后，问题来了：

```
 public void SelectPlant()
        {
            //if (SelectedIndex != null)
            if (SelectedIndex > plants.Count | SelectedIndex < 0)
                SelectedIndex = plants.Count;
            SelectedPlant = plants[SelectedIndex];

        } 
```

在这一行中抛出异常：

```
SelectedPlant = plants[SelectedIndex]; 
```

调试器将该值显示为 0。我尝试了各种方法来尝试防止索引为空。我觉得 Getinfo() 方法中的某些东西在这里很关键。我确信我非常接近成功，因为我在那里插入的颜色测试非常有效。当我将鼠标悬停在植物上时，它会变黑，当我移开鼠标时，它会恢复正常。

这正是我想要的行为类型，除了我希望它将**selectedIndex 设置为我正在鼠标悬停的植物的索引**。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T03:13:38.657

首先将其设为正确的 or`||`并检查`>= plants.Count`- 请记住该列表的索引位置为`0`。然后按照建议将其设置为计数 - 1：

```
if (SelectedIndex >= plants.Count || SelectedIndex < 0)
    SelectedIndex = plants.Count - 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T22:30:43.400

我将其添加为新答案，因为这是解决一个完全不同的问题。看看这段代码：

```
msRect = ms;
for (int i = 0; i < plants.Count; i++)
{
    foreach (Plant NewPlant in plants) // <-- this is redundant
    {
        if (NewPlant.BoundingBox.Intersects(msRect))
        {
            SelectedIndex = i;
            NewPlant.Tint = Color.Black;
        }
        else
            NewPlant.Tint = Color.White;
    }

} 
```

您在彼此内部循环两次“植物”！一次使用索引 ( `for (int i = 0 ...`)，然后在其中再次使用迭代器 ( `foreach (Plant NewPlant ...`)。

`GetInfo`您的选择是使用单个循环更改以设置正确的索引：

```
msRect = ms;
for (int i = 0; i < plants.Count; i++)
{
    Plant NewPlant = plants[i];
    if (NewPlant.BoundingBox.Intersects(msRect))
    {
        SelectedIndex = i;
        NewPlant.Tint = Color.Black;
    }
    else
        NewPlant.Tint = Color.White;
} 
```

或者做同样的事情，首先将 SelectPlant() 和 SelectedIndex 的需求短路：

```
msRect = ms;
foreach (Plant NewPlant in plants) // no need for indexes
{
    if (NewPlant.BoundingBox.Intersects(msRect))
    {
        SelectedPlant = NewPlant; // this is everything you need
        NewPlant.Tint = Color.Black;
    }
    else
        NewPlant.Tint = Color.White;
} 
```

但是，您需要小心使用“全局”变量`SelectedPlant`来捕获此逻辑。您最好更改整个`GetInfo`方法以*返回*所选植物，而不是`SelectedPlant`直接修改它。也就是把方法签名改成 return `Plant`not `void`，`SelectPlant = NewPlant`把上面的代码改成`return NewPlant`. 或者为了更有趣的单行：

```
return plants.Where(p => p.BoundingBox.Intersects(ms)) 
```

# azure - 天蓝色计算模拟器的域名或绑定名称

> ID：10150685
> 
> 赞同：5
> 
> 时间：2012-04-14T03:09:12.723
> 
> 标签：azure, dns, emulation

我需要在域名而不是本地主机 IP 地址（127.0.0.1）下的 azure 计算模拟器中运行 Web 角色。我可以配置我的项目在本地 IIS 上运行常规 Web 应用程序，因此我可以使用实际域名而不是开发服务器 IP 地址...

我的应用程序非常特定于 url，因为我使用子域来定义州（美国州）。例如，我需要 azure 模拟器来使用类似的东西： [http://wa.myapp.net](http://wa.myapp.net)，但不是[http://127.0.0.1](http://127.0.0.1)这对我来说没有意义。

我有很多功能可以在我的 url 中的子域上中继。使用常规 Web 应用程序，我可以将其配置为在 IIS 上运行并在我的项目中设置 url（以及 IIS 中的绑定），但我看不出如何在 azure 模拟器中做到这一点。

现在我有一个工作。我刚刚将本地 IIS 配置为指向应用程序文件夹，我可以运行我的应用程序，然后将我的 Visual Studio 附加到 iis 进程。但在这种情况下，某些功能不起作用，因为 azure 角色没有运行......所以它并不能完全解决问题......

请，需要一个建议。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-12T03:52:08.043

MSDN 文章[为多个网站配置 Web 角色](http://msdn.microsoft.com/en-us/library/windowsazure/gg433110.aspx)解释了如何执行此操作。

**`hostHeader`您可以使用指定自定义域的属性添加额外的绑定`ServiceDefinition.csdef`。**

例如：

```
<?xml version="1.0" encoding="utf-8"?>
<ServiceDefinition name="MyService" xmlns="http://schemas.microsoft.com/ServiceHosting/2008/10/ServiceDefinition" schemaVersion="2013-03.2.0">
    [...]
    <Sites>
      <Site name="Web">
        <Bindings>
          <Binding name="Endpoint1" endpointName="WebSvc" />
          <Binding name="Endpoint1" endpointName="WebSvc" hostHeader="my.custom.domain.com" />
        </Bindings>
      </Site>
    </Sites>
    [...]
  </WebRole>
</ServiceDefinition> 
```

您仍然需要在您的机器上设置主机覆盖`C:\Windows\System32\drivers\etc\hosts`，并导航到正确的 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T03:28:37.747

您无法从外部服务器连接到 Dev Fabric。您可以在服务器上使用 fiddler 将请求从另一个端口重定向到您的 azure Fabric 模拟器。希望这只是为了开发，因为它不会扩展。

[http://www.fiddler2.com/fiddler/help/reverseproxy.asp](http://www.fiddler2.com/fiddler/help/reverseproxy.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T13:33:07.003

Also a great tool to forward the request to your azure emulator: [http://www.quantumg.net/portforward.php](http://www.quantumg.net/portforward.php)

# excel - 如何在 LiveCycle 中将多个页面计算为总计？

> ID：10150688
> 
> 赞同：1
> 
> 时间：2012-04-14T03:10:02.193
> 
> 标签：excel, acrobat, livecycle

我不是程序员，但我必须创建一个旅行费用表。它必须是 PDF 格式（最好是 Adob​​e Acrobat 可编辑）。我用 Excel 创建了表格并将其导出到 Adob​​e，但当然，公式不会传输。

我有 3 页相同的用于计算差旅费用，唯一的区别是第一页上有一个额外的单元格，用于计算从每一页到总计的总数。听起来很容易。所有页面都单独计算没有问题，但我无法将各个页面的总数引用到总计所在的第一页。

我使用 Adob​​e LiveCycle 是因为它“简化”了像我这样的人的编程过程。到目前为止它工作得很好，但这是我唯一遇到的问题，也是唯一让我无法使用表格的事情。

所有三个页面都在同一个文档中。当我将 FormCalc 用于每个页面中的总计时，效果很好：

topmostSubform.Page1.P1TotalGrand::calculate - (FormCalc, 客户端) $=P1MileageTotal+P1TransAirTotal+P1CarRenTotal+P1HotelTotal+P1AllowTotal+P1PhoneTotal+P1MIETotal+P1BusMealTotal+P1OtherTotal

如果我转到下一页，它看起来像这样：

topmostSubform.Page2.P1TotalGrand::calculate - (FormCalc, 客户端) $=P1MileageTotal+P1TransAirTotal+P1CarRenTotal+P1HotelTotal+P1AllowTotal+P1PhoneTotal+P1MIETotal+P1BusMealTotal+P1OtherTotal

我只是希望能够将它们加在一起。当我尝试时，它无法识别第二页，我不知道为什么。表格非常基本，我非常感谢任何帮助。如果您需要任何其他信息，我很乐意提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T09:26:20.917

我相信你能做到。应该有很多方法，我也是新手所以这里有两种方法......

1.  如果你想要总共 2 页 - 不管你想要哪一页，公式应该是这样的

    ```
    topmostSubform.Page1.P1GREATTotalGrand::calculate - (FormCalc, client)
    $=P1TotalGrand+P2TotalGrand 
    ```

    诀窍是通过**按住 Ctrl Key**来选择两者，然后选择要选择的字段而不是输入。这应该可以解决问题。

2.  如果您希望总数位于第一页。将其`P2GreatTotalGrand`设为**全局数据** 并在第一页创建相同的数据字段，然后在第一页添加这个新字段和已经在第一页上的字段，以便在第一页获得总计。

# zend-framework - Zend Framework 迁移到 Live Server

> ID：10150695
> 
> 赞同：0
> 
> 时间：2012-04-14T03:11:42.067
> 
> 标签：zend-framework, lamp, mamp

请原谅我，我是 ZF 的新手。我需要将我的代码从 MAMP 生产服务器移动到 LAMP Live Server。

当我在 localhost 上工作时，代码一切正常。但是，当我将它上传到实时服务器时，60% 的模块反映了这个错误。

> 致命错误：未捕获的异常 'Zend_View_Exception' 和消息 'script 'layout.phtml' 在路径中找不到 (/home/lifeoppc/public_html/application/layouts/:/home/lifeoppc/public_html/application/modules/default/views/scripts /:./views/scripts/)' 在 /home/lifeoppc/public_html/public/Zend/View/Abstract.php:988 堆栈跟踪：#0 /home/lifeoppc/public_html/public/Zend/View/Abstract.php (884): Zend_View_Abstract->_script('layout.phtml') #1 /home/lifeoppc/public_html/public/Zend/Layout.php(796): Zend_View_Abstract->render('layout.phtml') #2 /home /lifeoppc/public_html/public/Zend/Layout/Controller/Plugin/Layout.php(143): Zend_Layout->render() #3 /home/lifeoppc/public_html/public/Zend/Controller/Plugin/Broker.php(333 ): Zend_Layout_Controller_Plugin_Layout->postDispatch(Object(Zend_Controller_Request_Http)) #4 /home/lifeoppc/public_html/public/Zend/Controller/Front.php(965): Zend_Controller_Plugin_Broker->postDispatch(Object(Zend_Controller_Request_Http)) #5 /home/lifeoppc/public_html/public/ Zend/Application/Bootstrap/Bootstrap.php(9 in /home/lifeoppc/public_html/public/Zend/Controller/Plugin/Broker.php on line 336

我真的很需要帮助！网站将于周一上线，我现在真的很绝望 =(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T03:17:33.997

在项目中搜索文件`layout.phtml`，然后将其复制粘贴到目录中

```
/home/lifeoppc/public_html/application/layouts/ 
```

# svn - svn+ssh 与 Subclipse 或 TortoiseSVN

> ID：10150696
> 
> 赞同：0
> 
> 时间：2012-04-14T03:11:59.853
> 
> 标签：svn, ssh, tortoisesvn, subclipse, portforwarding

如果我在带有 -N 选项的 cmd 窗口中运行 plink

```
C:\Program Files\Putty>plink -v -l user -pw passw -L 3690:1.2.3.4:3690 mydomain.com -N 
```

可以使用 TortoiseSVN 和 Subclipse 访问远程 svn 存储库（svn://127.0.0.1）

将以下内容放入您的 Subversion 配置文件中：

ssh = C:/Program Files/TortoiseSVN/bin/Tortoiseplink.exe -v -l user -pw passw -L 3690:1.2.3.4:3690 mydomain.com

无法从 TortoiseSVN 或 Subclipse 访问远程 svn 存储库（svn+ssh://127.0.0.1）

```
Putty Fatal Error
Network error: Connection refused

TortoiseSVN Error
Unable to connect to repository at URL 'svn+ssh://127.0.0.1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T13:15:00.443

您似乎误解了`svn://`和`svn+ssh://`访问方法之间的关系。

使用`svn://`，subversion 期望找到一个`svnserve`监听指定主机端口 3690 的进程。它将连接到该端口并使用颠覆协议。

您提到的 plink 命令行打开一个 SSH 会话，通过该会话连接到端口 3690 的隧道。因此，当您运行该命令时，`svn://127.0.0.1`只要 plink 仍在运行，该 URL 就会将您连接到您的存储库。

`svn+ssh://`另一方面，使用，subversion 期望找到一个 SSH 服务器。它将打开一个 SSH 连接，使用该连接启动一个新的 SSH 连接，`svnserve`然后*使用*颠覆协议。

因此，当给定 URL 时`svn+ssh://127.0.0.1`，subversion 会尝试与 localhost 建立 SSH 连接。那不是你想要的。

如果您的服务器配置为 svn+ssh 访问，那么 URL`svn+ssh://mydomain.com`应该可以工作。

# c# - 外部方法中的按钮单击事件？

> ID：10150697
> 
> 赞同：0
> 
> 时间：2012-04-14T03:12:19.157
> 
> 标签：c#

我正在尝试在 Visual Studio 中用 C# 制作一个相对基本的基于文​​本的 RPG。我已经挂断了试图让类中的方法对表单上的按钮单击做出反应。喜欢根据单击的按钮从一种方法移动到另一种方法。

让我给你一个程序的基本布局。

我有一个 frmMain 和一个 cls_EVENTS。它会变得更复杂，但那是我真正开始工作后的一段时间。

我希望 frmMain 成为玩家与程序交互的地方。它有文本屏幕、按钮、状态表，以及大部分有趣的东西。文本屏幕下方是 6 个按钮（分别标记为 btn1 - btn6），我计划将文本更改为，以反映当前场景/事件的可用操作（检查，向右，告诉那个人你和他的母亲昨晚吃了晚饭）。

“制作”主菜单的控件位于 cls_EVENTS 中，主要是为了让主菜单按钮更方便，只需调用它即可让播放器返回主菜单（而不是从 frmMain 复制粘贴代码方法）。

```
public partial class frmMain : Form
{
    //creates a static copy of the form that references to this form, I believe.
    public static frmMain MainForm { get; private set; }

    public frmMain()
    {
        InitializeComponent();

        // sets the static form as a copy of this form named MainForm.
        frmMain.MainForm = this;

        // calls the MainMenu() method in the cls_EVENTS class.
        cls_EVENTS.MainMenu();
    }

public void btn1_Click(object sender, EventArgs e)
{
}

//Same thing all the way down to btn6_Click
//And a couple of functions for manipulating the controls on the form... 
//(enabling buttons, pushing text to the textbox, etc) 
```

我的 cls_EVENTS 是我想要对事件进行实际编码的地方。就像 MainMenu 事件将更改文本框中的文本，更改按钮上的文本以反映当前选项，并禁用我不需要的按钮。

```
public class cls_EVENTS
{
    /*the Main menu, solely here for 'conveinence' (so I can have a Main Menu button on my form)*/
    public static void MainMenu()
    {
        //clears the text screen
        frmMain.MainForm.ScreenTextClear();

        //Enables the first button, disables the rest.
        frmMain.MainForm.ButtonEnable(true, false, false, false, false, false);

        //indent = true, write text to screen.
        frmMain.MainForm.ScreenText(true, "Welcome to the alpha of this game.");

        //test to make sure it ADDS TO the text rather then overwriting.
        frmMain.MainForm.ScreenText(true, "Hi");

        //changes the six button texts to the following six strings
        frmMain.MainForm.ButtonText("New Game", "Load Game", "About", "---", "---", "---");  

        //problem area

        //when player clicks button one
        //start the NewGame() method

        //when player clicks button two, after I eventually code such a function.
        //start the LoadGame() function

        //etc.     
    }

    Public void NewGame()
    {
        //etc.
    }
} 
```

我尝试使用带有 Sleep 方法的循环来检查每个按钮将添加不同数字的变量（只要 intSelected 为 0，循环将继续，btn1 将添加 1 等）

但这导致程序挂起。

另外，我觉得做我想做的事情会是一种混乱、不专业的方式。虽然我可能不是专业人士，但即使我有标准。

有谁知道在按下按钮之前暂停程序执行的方法？或者对如何完成我想要完成的事情有更好的想法？我不能简单地将函数编码到点击事件中，因为*这些*按钮的作用会不断变化。

我会继续说 C# 不是我擅长的语言。我最初是在 VB.Net 中这样做的，但遇到了同样的问题，并被引导相信 C# 更灵活一些。我什至隐约熟悉的唯一 C 语言是 C++，而我的那门课至少是一年半前的事了。所以，请原谅“愚蠢”的编码，因为我*有点*生疏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T17:03:25.443

经过更多的实验和更多的谷歌搜索，我想我可能已经找到了。

```
public static void MainMenu()
{
    frmMain.MainForm.ScreenTextClear();

    frmMain.MainForm.ButtonEnable(true, false, false, false, false, false);
    frmMain.MainForm.ScreenText(true, "Welcome to the alpha of this game.");
    frmMain.MainForm.ScreenText(true, "Hi");
    frmMain.MainForm.ButtonText("New Game", "Load Game", "About", "---", "---", "---");  

    // Potential solution.
    frmMain.MainForm.btn1.Click += delegate(object sender, EventArgs e)
        {
            NewGame();
        };    
} 
```

这似乎正在做我想做的事情。文本加载，按钮激活，然后单击它们启动适当的方法。上升重复。

# python - 字母频率：按使用最多到最少的顺序获取要打印的频率

> ID：10150706
> 
> 赞同：0
> 
> 时间：2012-04-14T03:16:06.203
> 
> 标签：python

我想编写一个程序，从文本文件中读取字母，忽略符号和空格，并按从最常见到最不常见的顺序打印每个字母的计数。

另外，我正在为我的第一个编程课做这个，所以我不允许使用计数器。

到目前为止我有这个：

```
name= raw_input("Enter file name:")
fl= open(name, 'r+').read()
lw= fl.lower()
ws= lw.replace(' ','')
sm= ws.translate(None, ",-!.;?:")
occ= {}
alpha= list ('abcdefghijklmnopqrstuvwxyz')
for x in alpha:
    occ[x]= sm.count(x)
for x in occ:
    print x, occ[x] 
```

假装文本文件是这样的：“我对此很困惑？”

然后程序将通过它的编程并执行此操作：“iamhighlyconfusedbythis”

但现在它只显示如下内容：

```
1   a
1   b
1   c
1   d
1   e
1   f
1   g
3   h
3   i
0   j
0   k
1   l
1   m
1   n
1   o
0   p
0   q
0   r
2   s
1   t
1   u
0   v
0   w
0   x
2   y
0   z 
```

但我希望结果看起来像：

```
3   h
3   i
2   s
2   y
1   e
1   f
1   g
1   a
1   b
1   l
1   m
1   n
1   o
1   c
1   t
1   u
1   d
0   j
0   k
0   p
0   q
0   r
0   v
0   w
0   x
0   z 
```

我使用的想法来自：

间谍

[确定密文的字母频率](https://stackoverflow.com/questions/992408/determining-letter-frequency-of-cipher-text-in-python)

简单Z

[python中的字母频率](https://stackoverflow.com/questions/5148903/letter-frequency-in-python)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T03:28:15.570

**更新问题的解决方案**

```
>>> from collections import defaultdict
>>> import string
>>> text = 'I am highly confused by this?'.lower().translate(None,string.punctuation+' ')
>>> c = defaultdict(int)
>>> c.update({letter:0 for letter in string.lowercase[:26]}) #Initialize each letter of alphabet to 0
>>> for letter in text:
        c[letter] += 1

>>> for letter,freq in sorted(c.iteritems(),key=lambda (l,f): (-f,l)): #Sort by frequency in descending order by making frequency negative then by letter in ascending order
        print freq, letter

3 h
3 i
2 s
2 y
1 a
1 b
1 c
1 d
1 e
1 f
1 g
1 l
1 m
1 n
1 o
1 t
1 u
0 j
0 k
0 p
0 q
0 r
0 v
0 w
0 x
0 z 
```

**原始问题的解决方案：** 您可以使用[`collections.Counter`](http://docs.python.org/library/collections.html#counter-objects)：

```
>>> from collections import Counter
>>> import string
>>> text = 'I am highly confused by this?'.translate(None,string.punctuation+' ')
>>> print ' '.join('%d %s'%(freq,letter) for letter,freq in Counter(x).most_common())
3 h 2 i 2 s 2 y 1 a 1 c 1 b 1 e 1 d 1 g 1 f 1 I 1 m 1 l 1 o 1 n 1 u 1 t 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T03:24:41.437

你可以这样做，

```
from operator import itemgetter
for k,v in sorted(occ.items(), key=itemgetter(1), reverse=True):
    print k, v 
```

但是有更好的方法来计算字母，例如`collections.Counter`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T03:48:35.647

既然你不能使用计数器，我会做这样的事情：

```
from string import ascii_lowercase

with open(name, 'r') as f:
    raw_text = f.read().lower()

letterCounts = [raw_text.count(letter) for letter in ascii_lowercase]

frequencies = reversed(sorted(zip(ascii_lowercase, letterCounts), lambda x: x[1]))

for i in frequencies:
    print "%s: %d" % i 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T03:55:25.073

这是一个简单的 Python 版本，使用`defaultdict()`. 由于您说这是针对课程的，因此这并不是您要求的最终解决方案。

```
from collections import defaultdict
from operator import itemgetter

d = defaultdict(int)

name = raw_input("Enter file name: ")

with open(name, "r") as f:
    for line in f:
        for ch in line:
            if ch.isalpha():
                d[ch] += 1

lst = d.items()

# sort twice: once for alphabetical order, then for frequency (descending).
# Because the Python sort is "stable", we will end up with descending
# frequency, but alphabetical order for any frequency values that are equal.
lst.sort(key=itemgetter(0))
lst.sort(key=itemgetter(1), reverse=True)

for key, value in lst:
    print value, key, 
```

当您对打开的文件执行 for 循环时，就像`for line in f`这里一样，Python 将从输入文件中一次抓取一行。然后我们在输入行上一次循环一个字符。然后我们检查它是否是一个字母，如果是，我们增加该字母的频率计数。

这段代码有一个错误。您希望它计算所有字母的频率，就好像它们都是小写一样，但是此代码将保留一个大写计数和另一个小写计数。我相信您可以弄清楚如何修改它，以便计数仅用于小写。

一旦我们完成计数，我们使用`.items()`方法函数来获取`(key, value)`元组列表。例如：`('h', 3)`是一个带有字典键字符`h`及其值的元组，计数为 3。

现在我们要排序。我向你展示了 Python 可以做到的一个绝妙技巧：由于排序是“稳定”排序，如果我们进行多个排序，Python 不会干扰早期排序的结果，除非它必须这样做。这意味着如果我们首先按字母顺序排序，*然后*按频率计数，那么对于频率计数相等的所有情况，我们将在该频率内获得字母顺序。因此，由于`a`、`b`和`c`都是相同的频率（它们每个出现一次），您会期望部分输出为：`1 a 1 b 1 c`

现在，我有点棘手，但这很好学。sort 函数可以接受一个`key`控制排序的参数。 `key`应该是一个返回用于排序的值的函数。由于我们有一个元组列表，我们需要一个可以获取元组的一部分并返回它的键函数。我们可以写两个函数：

```
def get_key(kv_tuple):
    return kv_tuple[0]
def get_value(kv_tuple):
    return kv_tuple[1] 
```

但是 Python 有一个函数，`operator.itemgetter()`我们可以使用它。如果我们告诉它我们想要获取元组中的哪个位置，它将为我们创建一个关键函数，它将为我们获取元组的一部分。

由于我们希望首先按最大值对频率进行排序，因此我们还在`reverse=True`该`.sort()`方法的参数中进行了设置。

最后，我们遍历键、值元组和打印的列表。

这段代码还有另一个问题。您的示例输出显示您希望每个字母都在列表中，如果字母不在输入中，则计数为 0。这只计算那里的东西。

所以，我建议你重新编写这段代码。不要使用 a `defaultdict`，而是尝试使用普通的`dict`，但有一个循环将每个字母`a`设置`z`为`dict`0 的计数。

我还建议，在您拥有`dict`包含您要计数的字母的普通代码后，您更改决定是否计数的代码。目前它使用`.isalpha()`方法函数来决定是否计算一个字符；相反，您可以检查该字符是否`in`是字典。然后，您可以使用此代码来计算标点符号或数字或任何类型的字符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-15T13:57:55.080

我认为更简单的方法是使用本机计数功能：

此代码仅打印每个字母的计数。您需要将其放入一个集合中并对其进行排序，以便首先获得最常见的字母。

```
text = 'Your original text.'
alpha = list ('abcdefghijklmnopqrstuvwxyz')
for letter in alpha:
    print letter + ': ' + str(text.count(letter)) 
```

# flash - 将 ffmpeg 与 Flash Media Server 和 HDS 一起使用

> ID：10150710
> 
> 赞同：0
> 
> 时间：2012-04-14T03:16:53.050
> 
> 标签：flash, ffmpeg, streaming, aac, libx264

我想使用 ffmpeg 对实时流进行编码并将其发布到 Flash Media Server。为了支持 iOS 设备，我还需要实现 HTTP Live Streaming。视频必须是 H.264 格式，音频应该是 AAC。我没有太多使用 ffmpeg 的经验，而且我很难让它发挥作用。这是我尝试过的命令（以及一些变体）：

```
ffmpeg.exe -threads 15 -f dshow -i video="USB2.0 UVC WebCam":audio="Microphone (Realtek High Defini" \
      -map_channel 0.1.1 -r 24 -acodec libvo_aacenc -ar 22050 -ab 128k -vcodec libx264 \
      -s vga -vb 100k -f flv "rtmp://<public-dns>/livepkgr/livestream1?adbe-live-event=liveevent" \
      -r 24 -acodec libvo_aacenc -ar 22050 -ab 128k -vcodec libx264 -s qvga -vb 200k \
      -f flv "rtmp://<public-dns>/livepkgr/livestream2?adbe-live-event=liveevent" \
      -r 24 -acodec libvo_aacenc -ar 22050 -ab 128k -vcodec libx264 -s vga -vb 350k 
      -f flv "rtmp://<public-dns>/livepkgr/livestream3?adbe-live-event=liveevent" 
```

当我运行它时，它似乎连接到 FMS，但随后我收到很多关于丢帧的错误消息——我不确定是否有任何帧被成功编码。我的 CPU 使用率也很高。当我为单个流之一输入 *.m3u8 文件的 URL 时，我从 FMS 收到 404 错误（尽管可以访问主 livestream.m3u8 文件）。我也尝试过输出到文件而不是 FMS，但没有成功。我得到的只是一些非常混乱的声音，没有视频。

关于我应该使用哪些选项/命令来使其正常工作的任何建议？是否有人使用带有 FMS 的 ffmpeg 来处理带有 MP4 视频的 HTTP 动态流/HLS？我一直在努力让 HDS/HLS 工作一段时间，任何帮助将不胜感激！应该没什么区别，但我在 Amazon EC2 上使用 FMS 和他们的 AMI 映像。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T10:32:40.833

```
-threads 15 
```

我对这种价值深表怀疑。我自己对开关的研究和实验`threads`表明，任何高于 4 的值都是错误的。尝试使用较低的值和/或可被 2 整除的值来删除它。

```
-f flv 
```

我也对这个价值深表怀疑。FLV 和 h.264 不能很好地配合使用。请改用 MP4。

你提到 CPU 是*“高”*，但你没有提到百分比。另请注意，您正在对三种不同的比特率进行编码——实际上是三个同时编码的工作。而且你没有提到你正在运行的 CPU。奔腾 4 还是酷睿 2？我不会感到惊讶。现代酷睿i7，好吧。

你为什么使用FFmpeg？使用 Adob​​e 的[Flash Media Live Encoder](http://www.adobe.com/products/flash-media-encoder.html)可能会更容易。

# r - 基于 R 中的部分匹配重新编码变量

> ID：10150711
> 
> 赞同：0
> 
> 时间：2012-04-14T03:17:24.653
> 
> 标签：r

这个问题可能有一个简单的答案，所以我提前道歉。我想使用 R 重新编码 v2、df1 中的值，并使它们看起来像 v2、df2 中的数据值。是否可以使用 v2、df1 中包含“Y”的值的部分匹配并将这些值重新编码为 v2、df2 中的“Yr”？

```
> df1
  v1   v2
1  1 Yr01
2  2 Yr02
3  3 Yr03
4  4 Yr04
5  5 Yr05

> df2
  v1 v2
1  1 Yr
2  2 Yr
3  3 Yr
4  4 Yr
5  5 Yr
> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T03:32:29.063

您可以`grepl()`根据您定义为正则表达式的任何内容来生成布尔向量。有关正则表达式的简单介绍的详细信息，请参见此处：[http ://www.regular-expressions.info/tutorial.html](http://www.regular-expressions.info/tutorial.html)

```
df1 <- read.table(text = "
  v1   v2
  1  1 Yr01
  2  2 Yr02
  3  3 Yr03
  4  4 Yr04
  5  5 Yr05", 
  header = TRUE, stringsAsFactors = FALSE)

df1[grepl("Y", df1$v2), "v2"] <- "Yr"
> df1

  v1 v2
1  1 Yr
2  2 Yr
3  3 Yr
4  4 Yr
5  5 Yr 
```

如果您的数据是一个因素，您可以先转换为字符，然后使用上面的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:19:22.687

正则表达式的另一种用法。

```
df1$v2 <- gsub("Y.*","Yr", df1$v2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T03:34:11.693

我认为这对你有用，但根据你有多少组和数据框的大小，可能会有更好的方法：

```
df1$v2 <- ifelse(grepl("Y", df1$v2), "Yr", df1$v2) 
```

# vba - vba 用于将特定字段的行数据记录与具有要传输到另一个工作表的数据的主列字段匹配

> ID：10150712
> 
> 赞同：0
> 
> 时间：2012-04-14T03:17:30.003
> 
> 标签：vba, excel, row

我在 Excel 中有两张工作表。Sheet2 具有来自数据库源的所有输出数据表。我一直在尝试编写一个可以将特定数据记录从 sheet2 传输到 sheet1 的 VBA。我试图制定一个标准，如果大约 4 个字段列的特定记录的行数据与具有要传输的数据。

例如，我在表 2 中有一系列数据，如下所示

```
 LIMIT    SALES    REGION   LOCATION  ITEM
            422234   4768.24  HR       1         BUIL
            343222   190.73   BP       2         CON
            432220   1494.62  OP       1         EQ
            343332   1302.66  BP       1         AR
            433322   3881.67  BP       1         NO 
```

标准是，如果 sheet2 中的行显示 - 区域“OP”，位置“2”，则项目 BUIL 的销售记录只能显示在 sheet1 中的特定单元格上。同样的规则将适用于在 sheet1 中显示的限制记录。Sheet1 将 limit 和 sales 作为列，将 items 作为行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:47:00.773

The following might help you get started.

Suppose you have your database data (as shown) in `Sheet 2` starting in Range A1 and on `Sheet1` you have as follows:

```
 A        B        C
1   Item     Limit    Sales
2   BUIL
3   CON
4   EQ
    etc... 
```

The following code will work down your list of items in `Sheet1` and if it finds a match in your data on `Sheet2` it will then check to see if the criteria are met i..e `Region` = "OP" and `Loaction` = 2:

```
Sub GetSalesAndLimit()
    Dim items As Range, entries As Range, item As Range, entry As Range, row As Long

    Set items = Range("A2:A" & Range("A2").End(xlDown).row)
    Set entries = Worksheets("Sheet2").Range("E2:E" & Worksheets("Sheet2").Range("E2").End(xlDown).row)

    For Each item In items
        For Each entry In entries
            With Worksheets("Sheet2")
                If entry = item Then
                    If entry.Offset(0, -2) = "OP" And entry.Offset(0, -1) = 2 Then 'Criteria is region = 'OP' and Loaction = 2
                        item.Offset(0, 1) = entry.Offset(0, -4) 'Limit
                        item.Offset(0, 2) = entry.Offset(0, -3) 'Sales
                    End If
                End If
            End With
        Next entry
    Next item
End Sub 
```

# c - C - 读取二进制文件，验证校验和

> ID：10150716
> 
> 赞同：3
> 
> 时间：2012-04-14T03:20:19.050
> 
> 标签：c, binaryfiles, checksum, code-assist

在 C 中，读取二进制文件内容并验证校验和的正确方法是什么？

这是我正在使用的数据示例：

```
0A 01 17 D8 04 00 07 9A 1F 10 FF CF 7F FF FF FF
FF 7F 7F 7F FF 7F FF FF FF FF 7F 81 01 01 03 01
01 01 01 81 00 73 67 68 66 97 6C 76 64 64 6A 6B
6E 64 66 67 44 41 [17 7A]
```

和

```
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 44 41 [00 85]
```

校验和（在方括号之间）将前 54 个字节的总和存储为 2 字节（大端）数字。

这是我一直在使用的：

```
#include <stdio.h>
int main(int argc, char **argv)
{
    FILE *f = fopen(argv[1], "rb");

    unsigned char data[512];
    fread(data, 1, 512, f);

    int i;
    int sum = 0;
    for (i = 0; i < 54; i++)
    {
        sum += data[i];
    }

    if ((sum >> 8)   == data[54] &&
        (sum & 0xFF) == data[55])
    {
        printf("Checksum is valid.\n");
    }
    else
    {
        printf("Checksum is invalid.\n");
    }
    system("pause");
} 
```

我使用 char 数组来存储字节，使用索引在循环中重新计算校验和。为了验证我使用了一些按位移位和屏蔽。有更好的解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T03:25:51.287

您所写的内容是合理的，但如果应该只有 56 个字节，那么尝试读取 512 个字节没有任何意义。此外，不要重复 512，而是`sizeof(data)`用于第二次出现。您可以将代码打包为一个函数，并且在不匹配时打印出实际和预期的校验和。校验和算法不是很敏感，所以它很容易漏掉一些错误，比如转置错误，虽然它也能捕捉到一个公平的数字。

* * *

嗯……再看一遍……你写道：

```
if ((sum >> 8)   == data[54] &&
    (sum & 0xFF) == data[55]) 
```

由于`sum`is a (signed) `int`，您可能应该写：

```
if ((sum >> 8) & 0xFF == data[54] &&
    (sum & 0xFF)      == data[55]) 
```

否则，您可能会溢出。也许不仅仅是 54 字节的数据，但如果要校验和的数据足够长（肯定超过 256 字节），您最终可能会得到一个大于 65535 的总和，并且在不应该的情况下比较会失败。我假设`sizeof(int) == 4`，而不是`sizeof(int) == 2`。

# php - 输出数据库中的最后 5 行 [CakePHP]

> ID：10150717
> 
> 赞同：-5
> 
> 时间：2012-04-14T03:20:22.623
> 
> 标签：php, cakephp, cakephp-2.0, cakephp-model

我有一个数据库，我想输出数据库的最后 5 行。该模型称为“文本”。

```
<?php for ($j = 0; $j < 5; $j++) { 

    ?>
    <tr>
        <td><?php echo $text['Text']['id']; ?></td>
        <td>
            <?php echo $text['Text']['expiration']; ?>
        </td>
        <td>
            <?php echo $text['Text']['title'] . " - " . $text['Text']['body']; ?>
        </td>
        <td><?php echo $text['Text']['created']; ?></td>
    </tr>
    <?php } ?> 
```

这应该让你知道我在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:38:02.440

你必须使用[`find()`](http://book.cakephp.org/1.2/view/449/find)

另一种方法是使用[`query()`](http://book.cakephp.org/1.2/en/view/456/query)

```
$alltext = $this->Text->find('all', array('limit' => 5,'order'=>array('id DESC')));
<?php foreach ($alltextext as $text): ?>
 // format as necessary
<td><?php echo $text['Text']['id']; ?></td> 
// add others here
<?php endforeach; ?> 
```

# clojure - 在迭代序列时特别处理最后一个元素

> ID：10150718
> 
> 赞同：3
> 
> 时间：2012-04-14T03:20:22.747
> 
> 标签：clojure, iteration, sequence

我发现在迭代时，我经常需要以特殊的方式处理序列中的最后一个元素。例如，采用内置函数`interpose`：

```
> (interpose ", " (range 4))

(0 ", " 1 ", " 2 ", " 3) 
```

一种思考方式是：

*   取第一个元素，加上“,”
*   取第二个元素，加上“,”
*   取第三个元素，加上“,”
*   ...
*   取倒数第二个元素，添加“，”
*   取最后一个元素，**什么都不做**

我还发现在使用 Seesaw 构建 Mig 布局时需要做一些特别的事情。例如，假设我要构建这个：

```
+---+---+---+
| 1 | 2 | 3 |
+---+---+---+
| 4 | 5 | 6 |
+---+---+---+
| 7 | 8 | 9 |
+---+---+---+ 
```

其中每个数字都是一些组件（例如按钮）。我可以通过使整个面板“流”的 Mig 布局约束来做到这一点，然后将以下约束添加到每个组件：

*   “增长” - 组件 1、2、4、5、7、8、9
*   “增长，包装” - 组件 3、6

请注意，上面可以这样说：

*   除了行中的最后一个组件**之外**的每个组件“增长”
*   **除**最后一行中的最后一个组件外的所有其他组件的“增长，包装”

再次出现相同的“特殊最后元素”主题。

所以两个问题：

*   上面的推理有意义吗？即我应该从根本上改变设计并考虑到上述示例问题和一般主题的不同方式吗？
*   如果没有，是否有一种惯用且简短的方法来做到这一点？

是的，您可以制作辅助函数和宏，但我发现这种情况经常发生，以至于我倾向于认为它应该是上述之一。换句话说 - 您是否遇到相同类型的“问题”以及如何解决它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T12:03:19.140

这里的大部分讨论都是基于您的假设，即所需的功能是 interpose 'like'。在某些方面是这样，但最大的不同是为了优化中介的使用，它被做成了惰性的。

惰性函数从长度未知（即流）甚至无限（即范围）的序列中获取元素。仅计算在根函数（即 take）处产生值所需的元素。调用 last 和依赖 last 的函数，比如 count ，意味着需要完全遍历原始序列才能实现 last 或 count 。这就是 sw1nn 的警告。

但是，根据大卫的回答，在这种情况下，元素的数量或最后一个元素的索引可能是已知的。只要您可以在不使用 count 的情况下将其用作参数，您就可以非常轻松地创建这样的函数，甚至可以让它变得懒惰。

```
(def buttons [\a \b \c \d \e \f \g \h \i])

(defn partition-nth-but
  [n b coll]
  (map
    (partial map second)                            ; remove index
    (partition-by
      #(and (integer? (/ (% 0) n)) (not= (% 0) b))  ; partition by index every nth but b
      (map-indexed (fn [i v] [(inc i) v]) coll))))  ; index coll offset 1 

=> (partition-nth-but 3 9 buttons)
((\a \b) (\c) (\d \e) (\f) (\g \h \i))

(def grow str)
(def grow-and-wrap (comp clojure.string/upper-case grow))

=> (map apply (cycle [grow grow-and-wrap]) (partition-nth-but 3 9 buttons))
("ab" "C" "de" "F" "ghi") 
```

但是，如果我们无论如何都要应用一系列函数，我们也可以循环通过正确的函数重复

```
(defn every-but-nth
  [n rf nf]
  (concat (repeat (dec n) rf) (repeat 1 nf)))

=> (apply concat
     (every-but-nth 3
       (every-but-nth 3 "grow" "grow-and")
     (repeat 3 "grow")))
("grow" "grow" "grow-and" "grow" "grow" "grow-and" "grow" "grow" "grow")

=> (map
     #(% %2)
     (apply concat (every-but-nth
                     3
                     (every-but-nth 3 grow grow-and-wrap)
                     (repeat 3 grow)))
     buttons)
("a" "b" "C" "d" "e" "F" "g" "h" "i") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T21:46:44.007

您正在考虑序列的错误结束。clojure 中的所有序列（实际上是一般的 LISP）都是一个元素，它包含更多元素的序列。

序列处理旨在让您对序列的第一个元素执行某些操作，然后将其余部分视为一个整体（可能是递归的）。事实上，clojure 具有命名`first`和`rest`鼓励这种思维方式的功能。

正如@Rafal 在评论中指出的那样，interpose 可以被认为是......

*   取第一个元素
*   取第二个元素，以“，”开头
*   取第三个元素，以“，”开头...

在 clojure 中，您可以（几乎）通过以下方式实现：

```
(defn interpose [s]
    (cons (first s) (map #(str "," %) (rest s)))) 
```

core.clj 中的实际实现建立在`interleave`函数之上，该函数更复杂，因为它处理两个序列，但仍然建立在 first + rest 习惯用法上。

许多（大多数？）算法都适合这种思维方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T03:48:51.107

既然你知道输入的大小，比如*n*，只需对前*n-1 个*元素做一些事情。这是您初始*插入*示例的最简单的解决方案。

在您的*增长*示例中，在 3 和 6 处增长*n-1*（或 8）个元素。然后在最后添加*n*（9）。

但是，您可能并不总是知道输入的大小。如果是这种情况，可以通过省略第一个元素并仅对其余元素进行操作来实现相同的结果。这是更一般的情况，并且可能更接近鼓励您在使用 clojure 时的思考方式。

# sql - 在 PL/SQL 中使用带有“LIKE %”的变量（例如“variable%”）？

> ID：10150723
> 
> 赞同：10
> 
> 时间：2012-04-14T03:21:33.590
> 
> 标签：sql, oracle, plsql, sqlplus

该问题类似于在**SQL *PLUS中使用****LIKE**，其中 select 语句包含**LIKE**子句，如下所示：

 ****```
select * from sometable where somecolumn LIKE 'something%'; 
```

怎么能在游标中使用相同的？我尝试使用以下内容：

```
 cursor c is select * from sometable where somecolumn like 'something%'; 
```

*和上面一样*

编辑：我需要获取**一些东西**作为参数，这意味着 select 语句是在存储过程中执行的。

**编辑2：**

```
create procedure proc1 (search VARCHAR) is

cursor c is select student_name from students where student_name like 'search%'; 
```

--我知道使用“搜索%”检索包含“关键搜索”的学生姓名，但有没有其他方法可以使用这样的变量。

```
do something;

end; 
```

简而言之，我需要选择包含作为参数传递的值的学生姓名；这可能不是全名，可能足以在 like 子句中使用。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-14T05:06:11.253

根据我对您的问题的理解，您`search`在引号内使用变量。将您的变量放在引号之外，例如：

```
 create or replace procedure PROC1(search VARCHAR2) 
 IS
  cursor test_cur(search IN VARCHAR2)
   IS
    SELECT student_name 
    FROM student
    WHERE student_name LIKE search||'%'; --you're putting you variable within quotes

 v_temp_var student.student_name%TYPE;

BEGIN

 OPEN test_cur(search);
  LOOP
   FETCH test_cur INTO v_temp_var;
    EXIT WHEN test_cur%NOTFOUND;

    DBMS_OUTPUT.PUT_LINE(v_temp_var);  
  END LOOP;

 CLOSE test_cur;

END test; 
```****

# python - 初学者问题（Python） - 如何从列表中删除特定长度的单词

> ID：10150725
> 
> 赞同：1
> 
> 时间：2012-04-14T03:22:15.657
> 
> 标签：python

这就是我所做的：

```
for word in doc:
    if len(word) < 3:
        doc.remove(word) 
```

但是，如果我这样做：

```
for word in doc:
    if len(word) < 3:
        print word 
```

返回的结果是：“O”、“Of”、“30”、“4”。'我。' “如果”等等。

大多数两个字符项目都被删除了，但仍然有一些，我做错了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T03:34:05.173

问题是python的for循环。

例如：如果你这样做：

```
arr = range(1, 10)
for x in arr:
    print x
    arr.remove(x) 
```

然后您会看到并非所有 arr 中的项目都已删除。

在您的情况下，我们可以这样做：

```
newDoc = [ word for word in doc if len(word) >= 3 ] 
```

欢迎来到蟒蛇。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T03:37:39.087

为了准确回答你的问题，我们需要看看内容`doc`是什么。最好是在交互式 Python 解释器中显示的格式。

话虽如此，从列表中删除项目的理想（读取 pythonic）方法是 A）使用`filter`：

```
filter(lambda x: len(x) > 2, doc) 
```

或 B）使用列表推导：

```
[word for word in doc if len(word) > 2] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T03:31:12.510

您应该反转逻辑并使用列表理解：

```
[ word for word in doc if len(word) >= 3 ] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T03:33:29.453

我建议使用[列表推导](http://docs.python.org/tutorial/datastructures.html)

```
doc = [w.strip() for w in doc if len(w.strip()) >= 3] 
```

将`strip()`删除空格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-14T03:35:33.037

改为创建要从中删除元素的列表的副本。

```
for word in doc[:]:
    if len(word) < 3:
        doc.remove(word) 
```

一般来说，覆盖您正在迭代的数据并不是一个好习惯。你遇到了问题，就像你刚刚在这里做的那样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-14T15:43:43.490

当您删除一个元素时，列表会移动，并且循环将继续使用 +1 索引元素。然后它跳过一个单词。

为了测试它，在解释器中写下这些：

```
l = range(5)
for i in l:
    l.remove(i)
    print i, l 
```

结果：

```
0 [1, 2, 3, 4]  
2 [1, 3, 4]  
4 [1, 3] 
```

# javascript - 在鼠标悬停和鼠标移出时插入图像

> ID：10150726
> 
> 赞同：0
> 
> 时间：2012-04-14T03:22:16.557
> 
> 标签：javascript, html, onmouseover, onmouseout

我在 div 中有一个图像，我试图在鼠标悬停时更改它，然后在鼠标移出时恢复。但是，我无法在鼠标移出时将图像插入到 div 中。是解决此问题的特定方法还是替代消息。问题似乎与在 HTML 插入中放置斜杠有关。

```
 <div class='myImage' onmouseout='this.innerHTML = '<img src='./images/myImage.jpg' />' onmouseover='this.innerHTML = \"\"; this.style.backgroundColor = \"#1D4088\"' style='height:100px; width:100px'><image src='./images/myImage.jpg'></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T03:28:44.517

嗯，似乎你把事情复杂化了，不用担心。

尝试遵循“精灵”教程。

**[这是](http://www.tutorial9.net/tutorials/web-tutorials/building-faster-websites-with-css-sprites/)**一个很好的：

如果你真的想进入它：[http ://css-tricks.com/css-sprites/](http://css-tricks.com/css-sprites/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T03:45:30.810

我认为您的双引号和单引号有点冲突，请尝试将 javascript 放入函数中

```
<div class="myImage" onmouseout="toggle(this,'1')" onmouseover="toggle(this,'2')" style="height:100px; width:100px"><image src="./images/myImage.jpg"></div> 
```

和 javascript

```
function toggle(e,a) {
    if(a=='2') {
        e.innerHTML = '';
        e.style.backgroundColor = '#1D4088';
    } else {
        e.innerHTML = '<img src="./images/myImage.jpg" />';
        e.style.backgroundColor = '';
    }
} 
```

# prolog - 如何获取用于在 Prolog 中获取查询解决方案的所有事实？

> ID：10150728
> 
> 赞同：0
> 
> 时间：2012-04-14T03:23:59.050
> 
> 标签：prolog, fact

我正在尝试打印用于获取查询解决方案的所有事实，如果统一失败，我希望不打印任何内容。所以我写这个：

```
a:-
    b,c,writeln(b^c->a).
b:-
    d,writeln(d->b).
c:-
    fail,writeln(e->c).
d:-
    writeln(d).
a:-
    b,d,writeln(b^d->a). 
```

但是，当我查询时`a.`，我很遗憾地得到了以下输出：

```
d
d->b
d
d->b
d
b^d->a
true. 
```

似乎有人告诉我，Prolog 有一个内置机制来显示用于查询的所有事实。他是真的吗？我怎样才能得到正确的输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T05:15:25.353

您的程序没有变量，因此没有统一性。

**编辑**：或者更好，在*抽象*意义上，Prolog在将*当前目标*与每个规则头统一的 Horn 子句列表之间进行*选择。*但是实际的 Prologs 用索引代替了选择阶段，以提高性能，并尝试统一参数。

 *当您调用`a`时，它会调用`b` **and** `c`，**并** *打印*一个表达式。

显示查询中使用的所有*规则*的内置机制可能是[trace](http://www.swi-prolog.org/pldoc/doc_for?object=trace/0)。有关详细信息，请参阅您的 Prolog 手册，这是一个相当复杂的论点，涉及系统的内部工作以及您所针对的语言的“架构”。

当然没有*正确*的输出，除了你能看到的。这就是你写的语义。*

# database - Google App Engine 乐观并发

> ID：10150729
> 
> 赞同：2
> 
> 时间：2012-04-14T03:24:19.347
> 
> 标签：database, google-app-engine

我正在阅读 Google App Engine 的[文档](https://developers.google.com/appengine/docs/python/datastore/overview)，偶然发现了一些我不太理解的东西：

> Datastore 使用乐观并发来管理事务。当两个或多个应用程序实例尝试同时更改同一个实体组时（通过更新现有实体或创建新实体），第一个提交更改的应用程序将成功，所有其他应用程序将在提交时失败。然后这些其他应用程序可以再次尝试它们的事务以将它们应用于更新的数据。请注意，由于 Datastore 以这种方式工作，因此使用实体组会限制您可以对给定组中的任何实体执行的并发写入次数。

这是否意味着如果来自两个不同设备的两个不同用户尝试修改同一个对象，则只有其中一个会成功？这是典型的数据库行为，还是只是 GAE 限制？其他数据库通常如何处理这种情况，即两个或多个用户试图修改同一个对象？

当两个或更多应用程序实例尝试创建新实体时，只有一个会成功，这意味着什么。我理解错了吗？没有两个应用程序实例可以将新对象添加到同一张表中吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T03:34:08.387

虽然我不能说像 MongoDB 之类的文档数据库（又名 NoSQL），但我可以告诉你，关系数据库只允许一个*操作*生效。但是，这归结为操作*是*什么。

例如，假设两个用户试图修改同一个对象。如果他们的修改只修改了列的一个子集，比如说......

用户 1：

```
update MyTable set Col1 = '1', Col2 = '2' where ID = 'abc' 
```

用户 2：

```
update MyTable set Col2 = 'x', Col3 = 'y' where ID = 'abc' 
```

您可以确定`Col1`它将是 '1' 并且`Col3' will be 'y', as those two columns were only updated in one statement. The value of`Col2` 将由*最后*执行的命令确定。

同样，如果一个用户更新了该行而另一个用户删除了它，那么无论如何都会删除该行。如果更新用户的命令首先出现，则更新将成功，然后将删除该行。如果删除命令先出现，那么该行将首先被删除并且更新不会做任何事情，因为该行不存在（该`where`子句将不匹配任何行）。

**但是**，实际上很少有应用程序会费心使用仅包含已更改列的命令来更新数据库。在几乎所有应用程序中，命令都是在表级别创建的，它们会更新所有列，然后将“当前”（更改或未更改）值传递给这些命令。这就是使用乐观并发的原因。

假设该行`abc`当前具有以下值：

```
ID = 'abc'
Col1 = '1_original'
Col2 = '2_original'
Col3 = '3_original' 
```

并且两个用户同时检索了该行，我们上面的命令将更真实地看起来像这样：

用户 1：

```
update MyTable set Col1 = '1', Col2 = '2', Col3 = '3_original' where ID = 'abc' 
```

用户 2：

```
update MyTable set Col1 = '1_original', Col2 = 'x', Col3 = 'y' where ID = 'abc' 
```

现在我们有一个问题；即使我们的第二个命令真的不关心 中的值`Col1`，它也可能会覆盖用户 1 设置的值。同样，如果用户 2 先命中，那么用户 1 将覆盖用户 2 写入的值`Col3`。

乐观并发本质上扩展了`where`子句来检查*每一*列的值，而不仅仅是表的键。通过这种方式，您可以确保在检索行和保存行之间的时间段内不会覆盖其他人（或某物）所做的任何更改。

因此，给定相同的条件，我们的命令将如下所示：

用户 1：

```
update MyTable set Col1 = '1', Col2 = '2', Col3 = '3_original' where ID = 'abc' 
        and Col1 = '1_original' and Col2 = '2_original' and Col3 = '3_original' 
```

用户 2：

```
update MyTable set Col1 = '1_original', Col2 = 'x', Col3 = 'y' where ID = 'abc'
        and Col1 = '1_original' and Col2 = '2_original' and Col3 = '3_original' 
```

这意味着无论哪个命令最后访问数据库实际上都不会做任何事情，因为列将不再具有它们的原始值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-14T04:40:27.643

事务的 API 重试几次（默认 3 次，总共 4 次尝试）。假设您的事务函数执行诸如读取实体、更新属性、将其写回、重试也会重新读取等操作。因此，除非存在严重争用，否则通常您不会注意到失败。

您误读了有关插入的内容；通常插入使用不同的键，因此根本不会发生争用。（只有在应用程序明确设置相同的密钥时，它们才会使用相同的密钥。）

# android - 嵌套的线性布局不起作用

> ID：10150736
> 
> 赞同：1
> 
> 时间：2012-04-14T03:27:35.110
> 
> 标签：android, android-linearlayout

我已经尝试了 2 天来创建嵌套线性布局（线性布局内的线性布局）但收效甚微。我的主布局有 3 个部分，权重分别为 45、45 和 10。当我运行它时，它似乎工作得很好。我在屏幕上得到 3 个不同颜色的矩形。

一旦我创建了“子”线性布局并将其添加到主布局，子布局就会在屏幕上占主导地位。次线性布局的权重为 35,35 和 30。所以我希望在屏幕上看到顶部矩形分成 3 个更薄的矩形。相反，我得到了属于子布局的 3 个矩形。

有任何想法吗？

public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState);

```
 // Ensure there is a full screen blank window to work with
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                         WindowManager.LayoutParams.FLAG_FULLSCREEN);

      testViewA = new TestView(this);
      testViewB = new TestView(this);
      testViewC = new TestView(this);

      testViewD = new TestView(this);
      testViewE = new TestView(this);
      testViewF = new TestView(this);

      testViewA.color = 0;
      testViewB.color = 1;
      testViewC.color = 2;
      testViewD.color = 3;
      testViewE.color = 4;
      testViewF.color = 5;

    LinearLayout.LayoutParams paramsA = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, 0, .45f);
    LinearLayout.LayoutParams paramsB = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, 0, .45f);
    LinearLayout.LayoutParams paramsC = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, 0, .10f);

    LinearLayout.LayoutParams paramsX = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, 0, .35f);
    LinearLayout.LayoutParams paramsY = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, 0, .35f);
    LinearLayout.LayoutParams paramsZ = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, 0, .30f);

    paramsA.setMargins(10, 10, 10, 10);
    paramsB.setMargins(10, 10, 10, 10);

    testViewA.setLayoutParams(paramsA);
    testViewB.setLayoutParams(paramsB);
    testViewC.setLayoutParams(paramsC);
    testViewD.setLayoutParams(paramsX);
    testViewE.setLayoutParams(paramsY);
    testViewF.setLayoutParams(paramsZ);

    LinearLayout sub1 = new LinearLayout(this);
    sub1.setOrientation(LinearLayout.VERTICAL);
    sub1.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));
    sub1.addView(testViewD);
    sub1.addView(testViewE);
    sub1.addView(testViewF);

    LinearLayout masterL = new LinearLayout(this);
    masterL.setOrientation(LinearLayout.VERTICAL);
    masterL.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));
    masterL.addView(sub1);
    masterL.addView(testViewB);
    masterL.addView(testViewC);

    setContentView(masterL);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T07:39:10.177

您的布局可以正常工作，但不是`LayoutParams` `paramsA`为您实际添加的新子布局（`sub1`）添加，`masterL` `LinearLayout`而是设置了一组新的`LayoutParams`（使用`width`并`height`设置为`FILL_PARENT`？！！？），使您`sub1`填充整个主布局。您所要做的就是将正确设置`LayoutParams`为`sub1`：

```
 sub1.setLayoutParams(paramsA); 
```

**注意：** 正如其他人所说的嵌套权重对性能不太好，也许您可​​以使用其他类型的布局来改进您的布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T04:30:44.090

`wrap_content`布局权重属性仅在子布局参数设置为并且它们确实有额外的空白空间时才有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T05:40:18.953

首先是在 xml 中执行此操作，当它用 Java 编写时，它很难读取/维护布局代码（特别是当它这么简单时）。很少有充分的理由在 Java 中编写此类属性。

其次，不要嵌套权重，这对性能不利：http: [//developer.android.com/resources/articles/layout-tricks-efficiency.html](http://developer.android.com/resources/articles/layout-tricks-efficiency.html) 你应该能够想出一个不需要的替代布局嵌套布局。

第三，如果你绝对必须使用嵌套权重（同样你几乎肯定不会），你需要设置 sub1 的权重。通过将其高度设置为填充父项，而不是使用权重设置为 0，您是在告诉它填充屏幕，因此它完全按照您的指示进行操作也就不足为奇了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T05:40:25.723

你需要 ：

**1）将您为其设置体重的孩子的身高设置为0**。

**2）设置父布局的setweightSum（孩子的权重之和）。**

检查此代码作为我从您的代码示例中制作的示例：

```
 requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                             WindowManager.LayoutParams.FLAG_FULLSCREEN);

          TextView TextViewA = new TextView(this);
          TextView   TextViewB = new TextView(this);
          TextView      TextViewC = new TextView(this);

          TextView      TextViewD = new TextView(this);
          TextView      TextViewE = new TextView(this);
          TextView      TextViewF = new TextView(this);

         TextViewA.setBackgroundColor( Color.RED);
          TextViewB.setBackgroundColor( Color.BLACK);
          TextViewC.setBackgroundColor( Color.BLUE);
          TextViewD.setBackgroundColor( Color.CYAN);
          TextViewE.setBackgroundColor( Color.GRAY);
          TextViewF.setBackgroundColor( Color.GREEN);

       LinearLayout.LayoutParams paramsA = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, 0, .45f);
        LinearLayout.LayoutParams paramsB = new LinearLayout.LayoutParams( LayoutParams.FILL_PARENT,0, .45f);
        LinearLayout.LayoutParams paramsC = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT,0, .10f);

        LinearLayout.LayoutParams paramsX = new LinearLayout.LayoutParams( LayoutParams.FILL_PARENT, 0,.35f);
        LinearLayout.LayoutParams paramsY = new LinearLayout.LayoutParams( LayoutParams.FILL_PARENT,0, .35f);
        LinearLayout.LayoutParams paramsZ = new LinearLayout.LayoutParams( LayoutParams.FILL_PARENT,0, .30f);

        paramsA.setMargins(10, 10, 10, 10);
       paramsB.setMargins(10, 10, 10, 10);

      TextViewA.setLayoutParams(paramsA);
        TextViewB.setLayoutParams(paramsB);
        TextViewC.setLayoutParams(paramsC);
        TextViewD.setLayoutParams(paramsX);
        TextViewE.setLayoutParams(paramsY);
        TextViewF.setLayoutParams(paramsZ);

        LinearLayout sub1 = new LinearLayout(this);
        sub1.setOrientation(LinearLayout.VERTICAL);

        sub1.setLayoutParams(new LayoutParams( LayoutParams.FILL_PARENT,0,0.45f));
        sub1.setWeightSum(1f);
        sub1.addView(TextViewD);
        sub1.addView(TextViewE);
        sub1.addView(TextViewF);

        LinearLayout masterL = new LinearLayout(this);
        masterL.setOrientation(LinearLayout.VERTICAL);
        masterL.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));
       masterL.setWeightSum(1f);
        masterL.addView(sub1);
        masterL.addView(TextViewB);
        masterL.addView(TextViewC);

        setContentView(masterL); 
```

# java - 不使用 ConvolveOp 的高斯滤波器

> ID：10150739
> 
> 赞同：2
> 
> 时间：2012-04-14T03:27:54.133
> 
> 标签：java, pixels, gaussian

我正在尝试在不使用 ConvolveOp 的情况下创建一个高斯滤波器。我在试图让它工作时遇到了很多问题，我已经得到了一个灰度过滤器来工作，但是对于这个我在找到一个像素 8 个邻居的位置时遇到了问题，所以我可以应用过滤器。这是我到目前为止所拥有的。这是获取每个像素的正确方法吗？

```
public class Gaussian implements Filter {

   public void filter(PixelImage pi) {
    Pixel[][] data = pi.getData();
    Pixel[][] original = data;

    int kernel_rows = 3;
    int kernel_cols = 3;

    // define kernel here (double loop), these are the 1/16, 2/16, etc...
    // values that you're multiplying the image pixels by
    double[][] kernel = {{1,2,1},
      {2,4,2},
      {1,2,1}};

    // iterate over each pixel in the image
    for (int row = 0; row < pi.getHeight(); row ++) {
      for (int col = 0; col < pi.getWidth(); col++) {
        // iterate over each pixel in the kernel
        for (int row_offset = 0 ; row_offset < kernel_rows ; row_offset++ ) {
          for (int col_offset = 0 ; col_offset < kernel_cols ; col_offset++ ) {

            // subtract by half the kernel size to center the kernel
            // on the pixel in question
            // ** you'll have to modify to account for boundary conditions **
            int row_index = row + row_offset - kernel_rows/2;
            int col_index = col + col_offset - kernel_cols/2;

            int r =0;
            int g =0;
            int b =0;

            r += (data[row_index][col_index].red * kernel[row_offset][col_offset])/16;
            g += (data[row_index][col_index].green * kernel[row_offset][col_offset])/16;
            b += (data[row_index][col_index].blue * kernel[row_offset][col_offset])/16;
            Pixel temp =new Pixel( r, g, b );
            original[row][col] = temp;
          }
        }
        data = original;
        pi.setData(data);

      }
    }
   }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T04:00:59.160

卷积本质上是一个四重嵌套循环：两个循环遍历图像中的像素，并且在每个像素处，两个循环遍历内核中的像素。

因此，您可以使用以下方式显着清理您的代码：

```
 int kernel_rows = 3;
   int kernel_cols = 3;

   // define kernel here (double loop), these are the 1/16, 2/16, etc...
   // values that you're multiplying the image pixels by
   double[][] kernel = ... 

   // iterate over each pixel in the image
   // leave a kernel_rows/2 sized gap around the edge of the image
   // so that we don't run into IndexOutOfBounds exceptions
   // when performing the convolution
   for (int row = kernel_rows/2; row < pi.getHeight() - kernel_rows/2; row ++) {
     for (int col = kernel_cols/2; col < pi.getWidth() - kernel_cols/2; col++) {

       int r = 0;
       int g = 0;
       int b = 0;

       // iterate over each pixel in the kernel
       for (int row_offset = 0 ; row_offset < kernel_rows ; row_offset++ ) {
         for (int col_offset = 0 ; col_offset < kernel_cols ; col_offset++ ) {

           // subtract by half the kernel size to center the kernel
           // on the pixel in question
           int row_index = row + row_offset - kernel_row/2;
           int col_index = col + col_offset - kernel_cols/2

           r += data[row_index][col_index].red * kernel[row_offset][col_offset];
           g += data[row_index][col_index].green * kernel[row_offset][col_offset];
           b += data[row_index][col_index].blue * kernel[row_offset][col_offset];

         }
       }

     data[row][col] = new Pixel( r, g, b );

     }
   } 
```

# java - 当使用 xml 签名时，整个 xml 文档是混乱的

> ID：10150745
> 
> 赞同：1
> 
> 时间：2012-04-14T03:29:09.307
> 
> 标签：java, xml, saml, xml-signature, saml-2.0

我正在使用 xml 签名来验证 saml 请求：

签名前的初始 saml 请求：

```
<samlp:AuthnRequest xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" ID
="abc" Version="2.0" IssueInstant="2012-04-14T8:55:05:31" ProtocolBinding="urn:o
asis:names:tc:SAML:2.0:bindings:HTTP-POST" AssertionConsumerServiceURL="http://l
ocalhost:8080/consumer.jsp"><saml:Issuer xmlns:saml="urn:oasis:names:tc:SAML:2.0
:assertion">http://localhost:8080/saml/SProvider.jsp</saml:Issuer></samlp:AuthnR
equest> 
```

签署 xml 文档然后将其转换为字符串（使用转换器）后，我得到以下信息：

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?><samlp:AuthnReques
    t xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" AssertionConsumerServiceURL
    ="http://localhost:8080/consumer.jsp" ID="abc" IssueInstant="2012-04-14T8:55:05:
    31" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" Version="2.
    0"><saml:Issuer xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion">http://localh
    ost:8080/saml/SProvider.jsp</saml:Issuer><Signature xmlns="http://www.w3.org/200
    0/09/xmldsig#"><SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/
    TR/2001/REC-xml-c14n-20010315#WithComments"/><SignatureMethod Algorithm="http://
    www.w3.org/2000/09/xmldsig#rsa-sha1"/><Reference URI=""><Transforms><Transform A
    lgorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/></Transforms><
    DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/><DigestValue>J
    QV+Gff3C0PDb5zbaB62ItqWaJ/yIFgOVfANUehlJpQ=</DigestValue></Reference></SignedInf
    o><SignatureValue>PJCFgkGUlQiOVn6g0hTgbbHkqOGAKB5sA8QjcdKrR5R9zuyn9ymfFZMo1jqpxU
   //#here 3UOCz1BcxsWt6+ 
    CSFSAS0SaQstuN8ns/5ltIYu3LFUrpIT4eRHxbYEjf+CFj0c08lFB+BLK3Tx3vEi7nQF+X1rUvZX
    XZEUmaAMLqNdhRSqurY=</SignatureValue></Signature></samlp:AuthnRequest> 
```

如您所见，初始字符串中的第一个属性是 ID 但签名后的第一个属性是 AssertionConsumerServiceURL。为什么会变得杂乱无章？此外，在已签署的文件中参见`#here`（倒数第三行），有一个换行符。为什么会有换行符。我认为加密值不包含换行符。我不明白发生了什么。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T03:31:22.593

为了计算签名，必须对 XML 文件进行[规范化](http://en.wikipedia.org/wiki/Canonical_XML)。它必须采用标准格式，以便接收应用程序验证签名。

但是，我不认为它需要被规范化；因为接收应用程序还必须规范化 XML 以计算签名以进行验证。因此，您可以在签名后尝试[重新格式化它。](https://stackoverflow.com/questions/139076/how-to-pretty-print-xml-from-java)但我不知道这是否有效，因此请彻底测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T05:23:00.317

参考这个链接。[由于 xml 签名而导致的错误](https://stackoverflow.com/questions/10152350/error-due-to-xml-signature)。其中大部分都说 xml 签名不能保证您 xml 标签的顺序。它还说这是由于规范化。但我不确定。我开始知道的一件事是，使用 xml 签名并不少见。

# jquery - 将 [object, Object], [object, Object] 的 JSON 数组转换为实际值？

> ID：10150746
> 
> 赞同：1
> 
> 时间：2012-04-14T03:29:22.090
> 
> 标签：jquery, ruby-on-rails, json

我的控制器中有这个：

```
 def selectmodels
    @brand = Brand.find_by_name(params[:brand_name])
    @models = Model.where(:brand_id => @brand.id)
    render json: @models
  end 
```

返回的代码通过以下方式处理：

```
$.ajax({
    url: '/selectmodels?brand_name=' + test, type: 'get', 
    dataType: 'json',
    processData: false,
    success: function(data) {
        if (data == "record_not_found") {
            alert("Record not found");
        }
        else {
            alert(data);
            $('#style_model_name').autocomplete({ source: data });
        }
    }
}); 
```

我想将“数据”键和值加载到我的自动完成文本字段中。

谢谢！

更新：

我收到以下信息：

```
[{"brand_id":1,"created_at":"2012-04-09T03:12:43Z","id":1,"name":"x","updated_at":"2012-04-09T03:12:43Z"},{"brand_id":1,"created_at":"2012-04-09T03:15:54Z","id":2,"name":"y","updated_at":"2012-04-09T03:15:54Z"},{"brand_id":1,"created_at":"2012-04-09T09:33:59Z","id":5,"name":"z","updated_at":"2012-04-09T09:33:59Z"}] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T05:02:41.273

```
$.ajax({
    url: '/selectmodels?brand_name=' + test, type: 'get', 
    dataType: 'json',
    processData: false,
    success: function(data) {
        if (data == "record_not_found") {
            alert("Record not found");
        }
        else {
            var source = [];
            for (i in data) {
                for (k in data[i]) {
                    source.push(data[i][k]);
                }
            }
            $('#style_model_name').autocomplete({ source: source });
        }
    }
}); 
```

或者，如果您只想要某些字段：

```
$.ajax({
    url: '/selectmodels?brand_name=' + test, type: 'get', 
    dataType: 'json',
    processData: false,
    success: function(data) {
        if (data == "record_not_found") {
            alert("Record not found");
        }
        else {
            var source = [];
            for (i in data) {
                source.push(data[i]['name']);
                source.push(data[i]['id']);
                source.push(data[i]['brand_id']);
            }
            $('#style_model_name').autocomplete({ source: source });
        }
    }
}); 
```

# java - 是否可以使用 Java 在静态方法中创建静态对象

> ID：10150749
> 
> 赞同：0
> 
> 时间：2012-04-14T03:30:09.667
> 
> 标签：java, class, methods, static, bluej

我有一个 Java 作业，我想知道我目前是否在正确的轨道上......

**问题**是我要创建一个新的类名 Tester，它声明我不需要任何实例变量或构造函数。除了这个类，我还有其他 4 个类，即 Product 类、Lineitem 类、Inventory 类和 Money 类。

接下来我要添加一个方法：`private static void addTestItems(inventory theInventory)`.

此方法允许我将四种不同类型的物品添加到库存中。对于每一个，我都需要创建一个产品对象，然后创建一个包含该产品的 Lineitem 对象，然后使用我在 Inventory 类中声明的方法 addItem() 添加产品对象。

该方法是私有的，因为它只是另一个主要方法的助手：`public static void test()`在此方法中，我将使用此方法打印一些输出，说明添加到库存中的产品。

我**设法研究**的是，在这样的类中，我不需要声明实例变量和构造函数。[资料来源： http](http://www.allinterview.com/showanswers/62694.html) ://www.allinterview.com/showanswers/62694.html中的答案 #2 。

但是，**我想知道**的是，如果我能够在这种方法中创建一个静态产品对象。如果没有，我应该如何声明要添加到 Inventory 类中的产品对象？

**除了我的好奇心之外**，不声明实例变量和构造函数，直接使用静态方法，这是否意味着这是一个静态类？有没有人有一个很好的静态类或静态方法的例子，或者与我所面临的非常相似？

顺便说一句，我正在使用 BlueJ 来完成我的任务。我要感谢大家阅读或帮助我解决这个问题如果您发现这个问题很糟糕，请发表评论并让我知道如何改进它。顺便一提。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T03:34:52.803

你不能在类上声明一个静态变量来保存你的库存吗？

```
private static List<inventory> list = new LinkedList<inventory>(); 
```

它不需要在构造函数或方法中，它可以是您的变量声明。由于你的类是静态的，它只会被初始化一次。

# php - php is_dir 有时不起作用

> ID：10150750
> 
> 赞同：1
> 
> 时间：2012-04-14T03:30:18.123
> 
> 标签：php, jquery, html

所以我在我的电影目录的页面中列出项目，只要没有子目录，它似乎就可以了。

该页面可以在这里查看。 [http://jnks.dyndns.org/dirlist.php](http://jnks.dyndns.org/dirlist.php)

可以从那里获取最相关的代码，直到 XHR 将信息发送到 functions.php 页面。我认为，这一切似乎都很可靠，因为它适用于其中包含文件的文件夹，而没有其他文件夹。

这是functions.php的代码

```
 $exts = array(
    '.mp4' => 'Apple Video',
    '.m4v' => 'Apple Video',
    '.ogg' => 'OGG Vorbis Video',
    '.ogv' => 'OGG Vorbis Video',
    '.webm' => 'MS Video',
    '.avi' => 'MS Video',
    '.mkv' => 'Matroska Video',
    '.iso' => 'Compressed DVD'
);

if(isset($_POST['dirName'])) {
$arg = $_POST['dirName'];
$dirList = scandir($arg);
echo '<ul>';
foreach($dirList as $dirs){
    if($dirs === '.' || $dirs === '..') {continue;} //remove dots
    if(is_dir($dirs)){
        echo '<li class="lv2" id="'.$arg.'\\'.$dirs.'" onclick="getDirList(this)">'.$dirs.'</li>'; //if dir create new nested list with function to drill down
    } else {
        $ext = strrchr($dirs,'.');
        if($exts[$ext]){
            echo '<li class="lv3" id="'.$dirs.'" data-folder="'.$arg.'\\'.$dirs.'" onclick="openFile(this)">'.$dirs.'</li>'; //if files then create new nested list
        }
    }
}
echo '</ul>';
} else {
    echo 'POST variable is not set';
} 
```

似乎 is_dir 不想工作。我已经完成了搜索，其他所有人似乎都在不使用绝对路径方面遇到问题。我知道这不是我的问题，因为我已经打印了 $arg var 以及结束 ul 标记的 echo 行，它显示了一个完整的路径并且它绝对不是权限。

我已经尝试将 is_dir 更改为 !is_file ，这允许它列出文件夹，但它也列出了我不想显示的文件，因为它绕过了我的 ext 过滤器（我想我可以将过滤器添加到这里，但 is_dir 应该可以正常工作吗？ ）。

所以基本上我需要一些帮助才能让它工作。我疯了，不明白 is_dir 还是有更好的方法？

另外，如果有人想查看我用来隐藏嵌套列表的 JavaScript（如果已经显示），请随意。我觉得这是一种非常“hack”的方式，但我还是很新，不知道很多技巧。它在 dirList.js 的 jQuery AJAX 部分

顺便说一句，请确保您使用与 HTML5 兼容的浏览器，因为我在其他一些 HTML5 内容中使用了视频标签。我在开发这个时正在使用 chrome。

谢谢。

编辑以询问另一种相关问题。

我已经使用 CSS 模拟了视频标签的全屏模式，效果很好，只是它仍然在右侧显示滚动条，并且在非常黑暗的场景中会变得烦人。有什么办法可以摆脱这个。即使我在浏览器中也处于全屏模式（f11）​​，它仍然存在。浏览器又是 Chrome，我将 z-index 设置为 10，没有其他任何设置。

编辑：

我通过 $('body').css('overflow', 'hidden'); 摆脱了滚动条 作为我全屏功能的一部分，并在切换回时将其关闭。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T03:43:06.390

`is_dir()`适用于完整文件路径。您传递的只是一个文件名......即使该文件实际上位于`$arg`.

试试`is_dir($arg . "/" . $dirs)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T03:44:56.053

问题正是没有使用绝对路径，

在您的情况下，您可以通过如下修改来修复它：

`$arg = $_POST['dirName'];`到`$arg = realpath($_POST['dirName']);`

[http://php.net/manual/en/function.realpath.php](http://php.net/manual/en/function.realpath.php)

And `if(is_dir($dirs)){` to `if(is_dir($arg . '/' .$dirs)){`

# opengl - OpenGL - 使用 glDrawArrays() 绘制正方形

> ID：10150751
> 
> 赞同：10
> 
> 时间：2012-04-14T03:31:02.353
> 
> 标签：opengl, opengl-es

我正在用 glDrawArrays() 绘制一个正方形，如下所示：

```
glTranslatef(0.0f,0.0f,-6.0f);  
const GLfloat quadVertices[] = { -1.0f, 1.0f, 0.0f, 
        1.0f, 1.0f, 0.0f, 
        1.0f,-1.0f, 0.0f,
        -1.0f,-1.0f, 0.0f
    }; 

    glVertexPointer(4, GL_FLOAT, 0, quadVertices);
    glDrawArrays(GL_QUADS, 0, 4); 
```

输出不如预期。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T03:38:38.607

我相信你想要：

```
glVertexPointer(3, GL_FLOAT, 0, quadVertices); 
```

因为每个顶点只使用 3 个浮点数，而不是 4 个。

# xml - 向 XML 添加值而不是覆盖它（XML + VB.NET）

> ID：10150761
> 
> 赞同：0
> 
> 时间：2012-04-14T03:32:13.850
> 
> 标签：xml, windows, vb.net, windows-mobile

我的一个项目遇到了一些麻烦。它是使用 VB.net 的 windows mobile 5 的基本财务经理。一切正常，但是，当一个值保存在 xml 中时，当另一个值被保存时，它将被覆盖。我希望它添加这些值而不是完全覆盖它们。

我的代码：

```
 Private Sub MenuItem3_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MenuItem3.Click
    Dim writer As New XmlTextWriter("product.xml", Nothing)
    writer.WriteStartDocument(True)
    writer.Formatting = Formatting.Indented
    writer.Indentation = 2
    writer.WriteStartElement("Table")
    createNode(DateTimePicker.Text, Subject.Text, Category.Text, Amount.Text, PaymentLabel.Text, writer)
    writer.WriteEndElement()
    writer.WriteEndDocument()
    writer.Close()
End Sub
Private Sub createNode(ByVal eDate As String, ByVal eSubject As String, ByVal eCategory As String, ByVal eAmount As String, ByVal ePayment As String, ByVal writer As XmlTextWriter)
    writer.WriteStartElement("Expenses")
    writer.WriteStartElement("Date")
    writer.WriteString(eDate)
    writer.WriteEndElement()
    writer.WriteStartElement("Subject")
    writer.WriteString(eSubject)
    writer.WriteEndElement()
    writer.WriteStartElement("Category")
    writer.WriteString(eCategory)
    writer.WriteEndElement()
    writer.WriteStartElement("Amount")
    writer.WriteString(eAmount)
    writer.WriteEndElement()
    writer.WriteStartElement("Payment")
    writer.WriteString(ePayment)
    writer.WriteEndDocument()
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T03:47:19.320

您必须使用`XmlTextReader`,`XmlTextWriter`最重要的是`XmlDocument`,`XmlElement`等等。

使用`XmlDocument`，您将使用[Document Object Model](http://www.w3.org/DOM/)操作文档，它允许您删除、插入和附加 XML 节点等。

有关以这种方式读取/写入 XML 的一些指示，请参阅[此链接](http://support.microsoft.com/kb/317662)。有关如何操作文档，请参阅有关[XmlDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)和[System.Xml命名空间的官方文​​档。](http://msdn.microsoft.com/en-us/library/y3y47afh.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T12:23:27.680

好的，这样的事情怎么样？

```
Private Sub MenuItem3_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MenuItem3.Click

    Dim doc as New XmlDocument()
    doc.LoadXml("product.xml")

    Dim root as XmlNode = doc.DocumentElement
    Dim list as XmlNodeList = root.SelectNodes("Table")
    Dim table as XmlNode = list.Item(0)

    table.AppendChild(createNode(doc, ... , ... ))

    Dim writer As New XmlTextWriter(Console.Out)
    writer.Formatting = Formatting.Indented
    doc.WriteTo(writer)
    writer.Flush()

End Sub

Function createNode(XmlDocument doc, ByVal eDate As String, ByVal eSubject As String, ByVal eCategory As String, ByVal eAmount As String, ByVal ePayment As String, ByVal writer As XmlTextWriter) As XmlNode

    Dim element as XmlElement = doc.CreateElement("Expenses")

    Dim dateElement as XmlElement = doc.CreateElement("Date")
    dateElement.InnerText = eDate
    element.AppendChild(dateElement)

    ... similar code for the other sub-elements ...

    Return element

End Function 
```

# c# - MVC 使用 SMOLite 创建 SQL 数据库

> ID：10150762
> 
> 赞同：1
> 
> 时间：2012-04-14T03:32:16.547
> 
> 标签：c#, sql-server, asp.net-mvc, smo

我正在尝试使用自定义操作从 Visual Studio 2010 Web 设置项目创建一个新数据库。首先，我做了一个 From 用户选择他们的 sql 服务器的名称和身份验证模式的地方。我使用以下内容获取服务器名称：

```
public string ServerString { get; set; }
   private void SetServerString()
        {
            string cs;
            if (cbInstant.SelectedIndex == 0) // windows authentication
                cs = cbServer.SelectedValue.ToString();
            else
                cs = string.Format(cbServer.SelectedValue + ";" + txtUser.Text + ";" + txtPassword.Text);

            ServerString = cs;
        }

        private void btnNext_Click(object sender, EventArgs e)
        {
              SetServerString();
              formContext.Parameters["ServerString"] = this.ServerString;
              this.Close();
        } 
```

它运行良好，例如我得到“PCName\SQLEXPRESS”。

在自定义操作中：

```
public override void Install(System.Collections.IDictionary stateSaver)
        {
  string serverString = "";
            if (this.Context.Parameters["ServerString"] != null)
                serverString = this.Context.Parameters["ServerString"];
 base.Install(stateSaver);
            MakeSQLDatabase(connectionString);
}
   private void MakeSQLDatabase(string serverString)
        {
            FileInfo file = new FileInfo("M:\\script.sql");
            string script = file.OpenText().ReadToEnd();
            file.OpenText().Close();
            SqlConnection sqlConnection = new SqlConnection();
            SqlConnectionStringBuilder sqlConnectionStringBuilder = new SqlConnectionStringBuilder();
            sqlConnection.ConnectionString = sqlConnectionStringBuilder.ToString();
            Server server = new Server(sqlConnection);
            server.ConnectionContext.ServerInstance = (serverString);
            server.ConnectionContext.Connect();
            if (server.Databases["databasename"] != null)
            {
                server.KillAllProcesses("databasename");
                server.KillDatabase("databasename");
            }
            Database database = new Database(server, "databasename");
            database.Create();
            database.ExecuteNonQuery(script);
        } 
```

我收到错误“未找到或无法访问服务器”，但是如果我将变量 serverString 更改为

```
@"PCName\SQLEXPRESS" 
```

有用！！我不知道是什么问题。我无法使用 Microsoft.SqlServer.Management.Smo，因为版本 2 和版本 4 之间存在冲突。即使添加了 app.confg

```
<?xml version="1.0"?>
<configuration>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
</configuration> 
```

感谢您的帮助，或者您能否指导我找到更好的解决方案来完成此任务。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T07:22:19.060

我不明白，你想用 .NET 2 而不是 .NET 4 创建一个新数据库？我为此使用了 SMO，但也会尝试 :) Atm 我只是将主数据库连接到使用 SQL 来完成“CREATE DATABASE”的工作。只要您与“主”数据库建立有效连接，此方法就可以工作。

更新：

```
var sql = "";
using (var cnn = new SqlConnection(connection))
{
  cnn.Open();
  sql = "CREATE DATABSE <databasename>";
  using (var cmd = new SqlCommand(sql, cnn))
  {
    try
    {
      cmd.CommandTimeout = 120;
      cmd.ExecuteNonQuery();
    }
    catch (Exception ex)
    {
      Console.WriteLine("Execution error!\n\n" + sql + "\n\n\n" + ex);
    }
  }
  sql = "USE DATABSE <databasename>;EXEC sp_dbchangeowner <Username>";
  using (var cmd = new SqlCommand(sql, cnn))
  {
    try
    {
      cmd.CommandTimeout = 120;
      cmd.ExecuteNonQuery();
    }
    catch (Exception ex)
    {
      Console.WriteLine("Execution error!\n\n" + sql + "\n\n\n" + ex);
    }
  }
  cnn.Close();
} 
```

连接必须是与“主”数据库的连接。并且需要更换。如果您想动态执行此操作，请执行以下操作：

```
sql = string.Format("USE DATABSE {0};EXEC sp_dbchangeowner {1}",database,username); 
```

您使用数据库名称“master”设置的与您已有的函数的连接。然后你就完成了，可以像这样设置任何数据库。

要检查 SQL 中的帮助，您可以在您的第一个 SQL 中添加：

```
IF ( (SELECT IsNull(db_id('latest'),-1) )>0 ) 
```

希望这可以帮助。我不知道这是否是最聪明的方式，但在这种情况下，我可以简单地连接，然后创建、更改等任何我想要的东西。在我的例子中，我完全创建了一个数据库，使用 stringbuilder 加载一堆 sql 命令并针对新数据库执行所有 CREATE table/column/query 语句。删除数据库是一个简单的“删除数据库”。

# plone - 如何限制可以在 Plone 4.1 的用户个人文件夹中添加的对象类型？

> ID：10150764
> 
> 赞同：1
> 
> 时间：2012-04-14T03:32:38.313
> 
> 标签：plone

安装带有 Ploneboard 的 Plone 4.1 并使用 intranet_workflow。我不希望用户能够在他们的用户文件夹中创建 Ploneboard 对象。如果我启用用户文件夹并将用户文件夹的限制设置为标准 Plone 类型，则 Ploneboard 对象不会出现在用户自己主文件夹中的用户的添加菜单中。但是限制仍然出现，用户可以单击它并编辑限制以允许自己添加 Ploneboard 对象。如何取消用户更改其个人文件夹上设置的限制的能力？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T07:28:48.870

大多数 Plone 产品都定义了自定义*添加权限*，以允许对添加位置和添加者进行细粒度调整。

Ploneboard 的主要*添加权限*是*Ploneboard: Add Ploneboard*，默认设置为*Manager*和*Owner*角色。由于成员是其成员文件夹的所有者，因此他们获得了添加图板的权限。

改变它的最简单方法是（在 Ploneboard 已经安装之后）是

1.  去Zope的根源
2.  打开 ZMI ( */manage* )
3.  选择*安全*选项卡
4.  搜索名为*Ploneboard 的权限：添加 Ploneboard*
5.  取消选择*Owner* -role 以不具有该权限
6.  转到页面末尾并*保存更改*

现在，只有拥有*管理员*角色的用户才有权限添加板块。

如果您使用的是 Plone 4.1（或更高版本）并且想将该权限也授予具有新*站点管理员*角色的用户，您应该打开Plone 站点对象的*安全选项卡，搜索权限并将其设置在那里。*

# f# - 单一案件歧视工会的目的

> ID：10150767
> 
> 赞同：13
> 
> 时间：2012-04-14T03:33:24.903
> 
> 标签：f#, monads, discriminated-union

我正在定义一个单子可观察/反应式解析器。这与普通解析器的行为完全不同，因为它是一个连续查询。底层类型是：

```
IObservable<'a> -> IObservable<'b> 
```

通过查看函数式语言中的各种解析器实现，似乎更合适的定义事物的方法是单例区分联合：

```
type Pattern<'a,'b> = Pattern of (IObservable<'a> -> IObservable<'b>) 
```

这意味着我需要提取底层函数来使用它：

```
let find (Pattern p) = p 
```

问题是：这只是按照惯例，还是出于以后扩展的目的，或者即使定义从未改变，也有理由这样做？

额外的问题：如果只是为了更方便的类型签名，为什么不使用类型别名：

```
type Pattern<'a,'b> = IObservable<'a> -> IObservable<'b> 
```

我已经在这方面取得了很大进展，并且没有发现不使用 DU 会影响可组合性的情况。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-14T09:02:20.143

F# 编译器不保留有关类型缩写的信息，因此您根本不会从*类型推断*中受益。类型签名可以理解为程序规范；让类型检查器完成他们的工作是确保程序正确性的好方法。

在类型别名的情况下，您需要在任何地方显式指定类型注释：

```
type Vector = float * float

// val add : float * float -> float * float -> Vector
let add ((x1, y1): Vector) ((x2, y2): Vector): Vector = (x1 + y1, x2 + y2) 
```

但它不会像使用 DU 那样给你透明度：

```
type Vector = V of float * float

// val add : Vector -> Vector -> Vector
let add (V(x1, y1)) (V(x2, y2)) = V(x1 + y1, x2 + y2) 
```

在复杂的程序中，清晰的类型签名确实更容易维护可组合性。

不仅向单案例 DU 添加更多案例更简单，而且使用成员和静态方法扩展 DU 也更容易。一个例子是你经常重写`ToString()`漂亮的打印。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T08:52:46.547

据我了解，单例区分联合类型可以提供与您的问题域语义相关的名称，以及名称为“字符串”的其他通用后端类型。

这是对语义的轻抽象泄漏修复，仅此而已，AFAIK

# php - MySQL轮转广告系统，存储过程还是php处理？

> ID：10150769
> 
> 赞同：1
> 
> 时间：2012-04-14T03:33:36.627
> 
> 标签：php, stored-procedures, mysqli

我正在写一个 mysql/php 广告系统

我有一个包含以下列的**广告表**

**id、现场、城市、状态、img、url、视图、点击**

每个“城市/州”组合的每个广告“位置”最多可以有 6 行

每个页面模板都有大约 15 个独特的广告“点”

在页面加载时，我需要为模板中的每个“点”轮流抓取下一个广告并增加它们的“浏览量”

**到目前为止我尝试过的...**

我想减少数据库调用我会使用一个存储过程，插入下面（“状态”尚未实现）。

此过程通过对给定“城市/州”组合中与给定“地点”匹配的所有行的视图进行总计，将总数除以匹配行数，并使用余数确定要返回的行。

我想知道这是否是正确的方法。它绝对不是最快的，并且在我使用 mysqli 调用它之后，其他数据库功能会出现“命令不同步”问题，尽管使用了“查询”方法。

我想知道替代品。

如果我在 PHP 中进行处理并在事后增加，我假设我需要放弃“剩余”选择方法并使用不太理想的“随机”选择方法以避免冲突。

**执行以下操作是否明智**

1.  添加“页面”列
2.  将“城市/州”组合中“页面”的所有可能广告返回给 PHP。** 将是显示的 6 倍。
3.  通过 PHP 随机选择要显示的广告
4.  通过带有 WHERE id IN () 子句的 UPDATE 更新这些选定的行

**还有其他建议吗？**

```
DROP PROCEDURE IF EXISTS get_ads //
CREATE PROCEDURE get_ads(in paramcity VARCHAR(30), IN paramspots VARCHAR(255))
BEGIN

DECLARE s VARCHAR(50);
DECLARE spots VARCHAR(255);
DECLARE p INT(10);
DECLARE l INT(10);

SET s = '';
SET spots = paramspots;
SET p = 0;
SET l = 0;

CREATE TEMPORARY TABLE output (id INT(10) NOT NULL, spot VARCHAR(50) NOT NULL, url VARCHAR(255), image VARCHAR(255));

REPEAT

  SET p = LOCATE(',',spots);

  IF  p > 0 THEN
    SET s = SUBSTRING(spots,1,(p - 1));
    SET spots = SUBSTRING(spots, (p + 1));
    SET l = CHAR_LENGTH(spots);
  ELSE
    SET s = spots;
    SET spots = '';
    SET l = 0;
  END IF;

  INSERT INTO output SELECT (@t2 := dt.id) AS id, spot, url, image FROM (
    SELECT @t1 := @t1 + 1 AS num, ads.*
    FROM ads, (SELECT @t1 := -1) init
    WHERE city = paramcity AND spot = s
    ORDER BY id ASC
  ) dt
  WHERE dt.num = (
  SELECT SUM(views) % COUNT(id) FROM ads
  WHERE city = paramcity AND spot = s);

UPDATE ads SET views = views + 1 WHERE id = @t2;

UNTIL l <= 0 END REPEAT;

SELECT * FROM output;

DROP TEMPORARY TABLE output;

END // 
```

# jquery - jquery 移动站点也可以是桌面浏览器站点吗？

> ID：10150770
> 
> 赞同：5
> 
> 时间：2012-04-14T03:33:40.067
> 
> 标签：jquery, jquery-mobile

我已经构建了一个简单的小型 jquery 移动站点，但我还需要一个非常相似的站点来处理基于浏览器的流量。事实上，就目前而言，这些站点是完全一样的，只是我需要将浏览器内站点的宽度限制为 650px 左右。

有没有一种简单的方法可以做到这一点？这将节省我许多小时的开发时间。

此外，展望未来，为移动和基于浏览器的网站使用单一、通用的代码库将非常有帮助，只有分别维护差异。是否有可以帮助我保持代码[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)的框架或方法？

注意：我知道[这个问题](https://stackoverflow.com/questions/8465685/can-i-use-jquery-mobile-for-creating-a-deskop-browser-based-web-applictions)，但它略有不同，询问 jquery mobile 是否可以用于桌面*而不是*移动。我想对*两者*使用相同的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T18:54:12.187

JQM 的好处在于它允许您在桌面和移动设备上使用单一来源，尤其是在内容或多或少相同的情况下。

要将您的桌面站点限制为 650 像素，您可以使用以下两个 CSS 网格：

[1140 像素 CSS 网格](http://cssgrid.net/)
[960 像素 CSS 网格](http://jeromeetienne.github.com/jquery-mobile-960/)

要获得 650 像素，只需在内容之前和之后添加一些空块。在较小的显示器上，您的内容将使用媒体查询变为全角（要在 IE 上支持，请务必包含[respond.js](https://github.com/scottjehl/Respond)。

我还没有尝试过 960 网格，但我经常使用 1140px 网格。也适用于 JQM 可折叠设备，这是一个优点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T18:45:04.020

如果你想限制页面宽度，它只是 css。**您可以使用CSS 媒体查询**为您的浏览器特定站点加载单个 css 文件。

这是一个可以帮助您的[链接。](http://broadcast.oreilly.com/2010/04/using-css-media-queries-ipad.html)

# sql - 将字符串拆分为两列（SQL 或 PL/SQL）

> ID：10150771
> 
> 赞同：1
> 
> 时间：2012-04-14T03:33:59.143
> 
> 标签：sql, string, oracle

我需要将一个表中的字符串拆分为另一个表中的两列。有几种不同的数字和规则，但没有明确的分隔符。我可以使用 SUBSTR 和 INSTR 的组合，还是需要在 PL/SQL 中使用 if-then 循环来满足所有规则？

输入表

```
5 Kent Street 
3 A lindt Street
2/15 bold Street 
9/34-36 carmen Road
12/5a sandford Street 
```

结果

```
Number  |Street
--------------------
5       |Kent Street
3A      |lindt Street
2/15    |bold Street
9/34-36 |carmen Road
12/5a   |sandford Street 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T16:22:27.240

我不会在 pl/sql 中这样做，这真的没有必要。

Oracle SQL 有 REGEXP_SUBSTR、REGEXP_REPLACE、REGEXP_COUNT。您还可以将 IF 和 CASE 表达式放在 SELECT 子句中。转到 SQL 参考，FUNCTIONS 部分：[http ://docs.oracle.com/cd/E11882_01/server.112/e26088/functions.htm#i1482196](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions.htm#i1482196)

您的数据集有一些有趣的变化 - 房屋/建筑物编号中的字母和分数。您（还没有）是多个部分的街道名称（例如波士顿的 Melnea Cass Boulevard）或带有串联/缺失（“百老汇”）或不寻常（“Cedar Passway”）“街道”指示符的街道名称。

从 sample_data 作为重构查询开始，以保​​存您的输入数据。您可能会有一个表格或视图或其他东西。

现在我们假设每个街道名称都有两个单词。我们首先使用 REGEXP_COUNT 对它们进行计数。这是子查询 COUNTED_DATA，其值为 WORDS 作为字数。请注意，我在每一行输入后附加一个空格，以防输入数据行的末尾没有空格，这样计数是正确的。

我搜索每个单词

```
[^ ]+[ ]+ 
```

也就是说，一个或多个非空格后跟一个或多个空格。我不想使用零个或多个空格 ([ ]*)，因为那是模棱两可的。

然后我们使用正则表达式来挑选出最后两个单词和第一个（单词减 2）单词。

结果如下：

```
with sample_data as (
    select '5 Kent Street' as addr from dual
    union all select '3 A lindt Street' as addr from dual
    union all select '2/15 bold Street' as addr from dual
    union all select '9/34-36 carmen Road' as addr from dual
    union all select '12/5a sandford Street' from dual
)
select 
    counted_data.addr as "Original Address",
    substr (regexp_replace (addr || ' ', '(([^ ]+[ ]+){' || (words-2) ||'})([^ ].*)','\1'), 1, 10) as "Number",
    substr (trim (regexp_replace (addr || ' ', '(([^ ]+[ ]+){' || (words-2) ||'})([^ ].*)','\3')), 1, 25) as "Street"
from
(
    select sample_data.addr, regexp_count(addr || ' ', '[ ]+') as words
    from sample_data
) counted_data

Original Address      Number     Street                   
--------------------- ---------- -------------------------
5 Kent Street         5          Kent Street               
3 A lindt Street      3 A        lindt Street              
2/15 bold Street      2/15       bold Street               
9/34-36 carmen Road   9/34-36    carmen Road               
12/5a sandford Street 12/5a      sandford Street 
```

为了使这个可读性，我使用“substr”来减少输出列的长度。（“COLUMN”在 SQL Developer 中不起作用。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T04:11:43.893

我可以建议你三种可能性：

1.  如果分隔字符清晰简单，请按照您的建议使用 SUBSTR 和 INSTR 的组合。

2.  如果您的数据库支持正则表达式功能，并且将您的地址字段与正则表达式匹配很简单，请使用它。例如 MySQL 有[REGEXP](http://dev.mysql.com/doc/refman/5.5/en/regexp.html#operator_regexp)。

3.  但是，如果字符串的解析很复杂并且变体太多，那么请使用具有完整编程语言的外部脚本。

    连接到数据库，例如在 Java 中，处理字符串并将结果插入到新表中。如果您的行数很大，请记住使用批量操作，这样会更快。

# python - matplotlib 条形图 errbar

> ID：10150780
> 
> 赞同：0
> 
> 时间：2012-04-14T03:35:47.017
> 
> 标签：python, matplotlib, bar-chart

在官方示例中，我们可以像这样使用 bar 函数：

```
#!/usr/bin/env python
# a stacked bar plot with errorbars
import numpy as np
import matplotlib.pyplot as plt

N = 5
menMeans   = (20, 35, 30, 35, 27)
womenMeans = (25, 32, 34, 20, 25)
menStd     = (2, 3, 4, 1, 2)
womenStd   = (3, 5, 2, 3, 3)
ind = np.arange(N)    # the x locations for the groups
width = 0.35       # the width of the bars: can also be len(x) sequence

p1 = plt.bar(ind, menMeans,   width, color='r', yerr=womenStd,align='center')
p2 = plt.bar(ind, womenMeans, width, color='y',bottom=menMeans, yerr=menStd,align='center')

plt.ylabel('Scores')
plt.title('Scores by group and gender')
plt.xticks(ind, ('G1', 'G2', 'G3', 'G4', 'G5') )
plt.yticks(np.arange(0,81,10))
plt.legend( (p1[0], p2[0]), ('Men', 'Women') )

plt.show() 
```

我不明白的是， **为什么将 womenStd 用作 menMeans 的 yerr，而 menStd 用作 womenMeans 的 yerr。**

你能为我解释一下吗？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:39:45.467

这很可能是一个错字。对于示例而言，它似乎根本不重要，它的存在是为了说明 matplotlib 功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T03:52:06.553

这一定是文档中的拼写错误，可以通过更改每个组中的项目数来证明。例如，从每个`women`变量中删除最后一项并创建一个新的`ind2 = np.arange(N-1)`并重新运行代码。你会得到一个堆栈跟踪，这表明你的直觉是正确的，你应该使用类似命名的变量。显然，给定的示例无论如何都只是为了说明，但可能应该更改为更清楚。

# c# - 使用 XmlTextReader

> ID：10150785
> 
> 赞同：6
> 
> 时间：2012-04-14T03:37:21.493
> 
> 标签：c#, xml, web-services, xmltextreader

我是一名初级程序员，从 C# 和 Web 服务开始。

在`Service.cs`我的 Web 服务文件中，我创建了一个`ReadXMLFile()`方法，我试图在其中读取现有 XML 文件，从中获取数据并将其放置到我在`IService.cs`文件中创建的相应属性 (DataMembers) 中。

我的问题是我的代码基本上没有做任何事情。我试过寻找这方面的网站和教程，但那里真的没有太多，尤其是对于像我这样的初学者。任何人都知道我应该怎么做，因为到目前为止我一直在尝试的显然是错误的。

下面是我的`ReadXMLFile()`方法。

```
void ReadXMLFile()
{
    XmlTextReader reader = new XmlTextReader("ClassRoll.xml");
    reader.Read();
    while (reader.Read())
    {
        if (reader.Name == "id")
        {
            id = reader.ReadString();
        }
        else if (reader.Name == "firstname")
        {
            link = reader.ReadString();
        }
        else if (reader.Name == "lastname")
        {
            description = reader.ReadString();
        }
        else if (reader.Name == "count")
        {
            description = reader.ReadString();
        }
        else if (reader.Name == "testscore")
        {
            description = reader.ReadString();
        }
    }
} 
```

这是我的 xml 文件的示例

```
<classroll>
  <student>
    <id>101010</id>
    <lastname>Smith</lastname>
    <firstname>Joe</firstname>
    <testscores count="5">
      <score>65</score>
      <score>77</score>
      <score>67</score>
      <score>64</score>
      <score>80</score>
    </testscores>
  </student>
</classroll> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T04:03:50.077

您可能在 while 循环中缺少 IsStartElement() 条件：

```
while (reader.Read())
{
    if (reader.IsStartElement())
    {
       if (reader.Name == "id")
       {
           id = reader.ReadString();
       }
...
} 
```

[此外，使用XPath](http://msdn.microsoft.com/en-us/library/system.xml.xpath%28v=vs.100%29.aspx)或[LINQ to XML](http://msdn.microsoft.com/en-us/library/bb387098.aspx)读取 XML会更容易，当然这取决于文件。以下是一些示例：[XPath](http://www.codeproject.com/Articles/9494/Manipulate-XML-data-with-XPath-and-XmlDocument-C)和[LINQ](https://stackoverflow.com/q/670563/1048330)。

**编辑**：查看 XML 文件详细信息后

您应该更新您的逻辑以跟踪当前`student`及其`testscores`. 另外，请注意这`count`是一个属性。它很快就会变得混乱，我建议你看看上面提到的示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T09:30:57.360

我认为，您使用 XmlDocument 获得最佳结果

```
public void ReadXML()
{
    XmlDocument xmlDoc = new XmlDocument();
    xmlDoc.Load("<name file>.xml");
    xmlEntities = new List<XmlEntity>();

    foreach(XmlNode item in xmlDoc.ChildNodes)
    {
        GetChildren(item);
    }
}

private void GetChildren(XmlNode node)
{
    if (node.LocalName == "Строка")
    {
       //<you get the element here and work with it>
    }
    else
    {
       foreach (XmlNode item in node.ChildNodes)
       {
             GetChildren(item);
       }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-09T12:22:51.090

它不起作用的原因是，例如：当 reader.Name == "firstname" 为 true 但其元素值不为 true 时。它的确切含义是 reader 对象读取下一个 Nodetype，即 XmlNodeType.Element。因此，在这种情况下，使用 reader.Read(); 查看您的 XML 文件 函数再次读取下一个节点，即 XmlNodeType.Text，其值为 Joe。我给你一个工作版本的例子。

```
void ReadXMLFile()
{
XmlTextReader reader = new XmlTextReader("ClassRoll.xml");
reader.Read();
while (reader.Read())
{
    if (reader.Name == "id")
    {
         reader.Read();
         if(reader.NodeType == XmlNodeType.Text)
         {
           id = reader.Value;
           reader.Read();
         }

    }
 } 
```

}

# ruby-on-rails - Rails：如果数据库中没有密码字段，如何从输入中验证密码

> ID：10150800
> 
> 赞同：5
> 
> 时间：2012-04-14T03:41:11.257
> 
> 标签：ruby-on-rails

我有带有字段的表`email`：`password_hash`和`salt`。

在用户注册时，我想验证密码和密码确认，但我总是收到`can't be blank`提示输入密码的错误。

这是我的模型：

```
attr_accessor :password

validates :password, :presence     => true,
                     :confirmation => true,
                     :length       => { :within => 6..40 } 
```

我来宾我无法验证不是数据库的字段，但是如何验证用户输入的密码？

我在数据库中没有密码字段，因为我加密了`password`我得到的输入，然后我将它存储在 db`password_hash`字段中。

**编辑 ：**

这是数据库表：

```
class CreateStudents < ActiveRecord::Migration
  def change
    create_table :students do |t|
      t.string :first_name
      t.string :last_name
      t.string :email
      t.string :password_hash
      t.string :salt

      t.boolean :activated

      t.timestamps
    end
  end
end 
```

这是注册视图：

```
<%= form_for @student, url: {action: 'create'} do |form| %>

  <p style="font-size:smaller; color:red">
  <% @student.errors.messages.each do |att, msg| %>
    <%= msg[0] %><br>
  <% end %>
  <p>
  <%= form.label :first_name %><br>
  <%= form.text_field :first_name %>
  <p>
  <%= form.label :last_name %><br>
  <%= form.text_field :last_name %>
  <p>
  <%= form.label :email %><br>
  <%= form.text_field :email %>
  <p>
  <%= form.label :password %><br>
  <%= form.password_field :password %>
  <p>
  <%= form.label :password_confirmation %><br>
  <%= form.password_field :password_confirmation %>
  <p>
  <%= form.submit %>

<% end %> 
```

这是控制器：

```
def sing_up
    @student = Student.new
    render 'sing_up'
end

def create
    @student = Student.new
    @student.first_name = params[:student][:first_name]
    @student.last_name = params[:student][:last_name]
    @student.email = params[:student][:email]

    @student.salt = BCrypt::Engine.generate_salt
    @student.password_hash = BCrypt::Engine.hash_secret(params[:student][:password], @student.salt)
    if @student.save
        redirect_to controller: 'singups', action: 'index'
    else
        render 'sing_up'
    end
end 
```

最后，这是模型

```
class Student < ActiveRecord::Base
  attr_accessor :password
    validates :first_name, :length => { minimum: 3, message: "first_name" }
    validates :last_name, :length => { minimum: 3, message: "last_name" }
    validates :email, :presence => { message: 'email' },
              :format => { with: /\A[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]+\z/ , message: 'email format' },
              :uniqueness => { message: 'uniqueness?' }
    validates :password, :confirmation => { message: 'password' },
                         :length => { minimum: 6, message: 'password length' }
end 
```

每次用户输入密码时`:confirmation => { message: 'password' }`，无论密码是什么，它都会在第一次验证时失败。

如果我删除`validates :password`部分，一切正常，但用户输入的密码未经过验证。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:39:25.997

您正在验证用户的`password`属性，但您从未首先为其分配值。至少，您需要将其添加到您的控制器代码中：

```
@student.password = params[:student][:password]
@student.password_confirmation = params[:student][:password_confirmation] 
```

但是，更简洁的方法是使用 mass-assignment - 摆脱所有 @student.xxx = yyy 并将其替换为：

```
@student = Studen.new(params[:student]) 
```

然后，将您的密码散列方法移动到模型中，如果密码属性存在，则在每次保存之前自动触发它：

```
class User < ActiveRecord::Base
  # ...
  before_save :hash_password, :if => proc{ |u| !u.password.blank? }
  # ....

  protected

  def hash_password
    self.salt = BCrypt::Engine.generate_salt
    self.password_hash = BCrypt::Engine.hash_secret(password, salt)
  end
end 
```

这样，您不必在控制器中执行任何操作，但是：

```
def create
  @student = Student.new(params[:student])
  if @student.save
    redirect_to controller: 'singups', action: 'index'
  else
    render 'sing_up'
  end
end 
```

并在您的模型中拥有所有其他逻辑，它所属的位置。

编辑：为了使批量分配与最新版本的 Rails 3 一起使用，您需要像这样设置要分配的属性`attr_accessible`，如下所示：

```
class Student < ActiveRecord::Base
  # ...
  attr_accessible :first_name, :last_name, :email, :password # but NOT the hash or salt!!

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T04:26:19.900

您应该查看从头开始处理身份验证的 Railscast，所有内容都在此处进行了解释[http://railscasts.com/episodes/250-authentication-from-scratch](http://railscasts.com/episodes/250-authentication-from-scratch)

这里有一个更新的演员表[http://railscasts.com/episodes/250-authentication-from-scratch-revised](http://railscasts.com/episodes/250-authentication-from-scratch-revised)但您需要订阅才能查看（非常值得 IMO）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T04:04:49.560

您需要将用户输入的密码转换成加密值，然后将加密值与password_hash中的值进行比较，看是否匹配。这就是您验证用户是否是正确用户的方式。如果您的模型没有密码字段（不应该）并不重要，因为您不直接比较密码中的值。

有不同的加密方法，但重要的是你如何首先将原始密码加密到 password_hash 中（你是如何生成“password_hash”的？）。使用相同的方法检查新密码提交。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T07:15:56.950

您可以使用自定义验证来检查密码和密码确认。

```
class User< ActiveRecord::Base
  attr_accessor :password, :password_confirmation 
  validate :valid_password

  def valid_password
    if password.blank? || password_confirmation.blank?
      errors.add(:password, 'password must not be blank')
    end

    if password != password_confirmation
      errors.add(:password, 'password and confirmation does not match')
    end
  end

end 
```

这样，它会检查密码和确认是否存在并同时存在。

# bison - 我应该如何向 flex+bison 汇编器添加预处理器？

> ID：10150806
> 
> 赞同：1
> 
> 时间：2012-04-14T03:43:06.817
> 
> 标签：bison, yacc, flex-lexer, dcpu-16

我使用 flex+bison 编写了一个简单的汇编程序。我想在汇编语言中添加一个预处理器（宏）。这是我第一次尝试使用 flex+bison，我不知道该怎么做。

添加一个单独的 flex+bison 实例并完全单独进行预处理是否合适？或者他们是否支持为不同的处理阶段表达不同的结构？

如果好奇，[汇编器就在这里](https://github.com/jonpovey/das)，用于 DCPU-16 架构。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T04:07:55.750

你肯定想要一个单独的解析器。这就是 gcc 的方式 - 您可以在预处理后停止编译（`-E`我相信）。从技术上讲，可以将其编写为单个解析器，但这会麻烦很多，而且我看不出它有用的特定原因，而将其分开将允许您在预处理后停止编译，不仅可以更轻松地跟踪预处理器/汇编器本身的错误，还可以更轻松地跟踪使用它编写的任何程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T03:53:54.537

你可以看看我的。我和你有同样的想法：P [你可以在这里找到它](http://code.google.com/p/dcpu16asm/) 它支持表达式，但我意识到如果你想支持前向引用，你必须有一个 ast。也许当 Notch 发现不固定大小的操作码更难制作汇编程序时，他会改变它:)

关于该主题的一本不错的书是[Flex and Bison](http://shop.oreilly.com/product/9780596155988.do) 它展示了如何执行“状态”，即您可以推送词法分析器状态并更改文件缓冲区。它为此显示了一个基本的解析器/ lex。它对我的学习有很大帮助:)

# c# - 将一个对象的属性复制到具有相同基础的另一个对象

> ID：10150807
> 
> 赞同：0
> 
> 时间：2012-04-14T03:43:37.973
> 
> 标签：c#, inheritance, dataset

情况...

我正在为一个 asp.net 网站创建一个购物车。我有一个 Cart 对象，它将包含 CartItem 对象的列表。而不是为 CartItem 对象创建必要的属性，例如 ID、产品名称、描述、价格……我认为像这样简单地从数据集表中继承数据行会很聪明……

```
public class CartItem : DanubeDataSet.ProductsRow
{
public int Quantity { get; set; }

public CartItem(System.Data.DataRowBuilder rb) : base(rb)
{
    Quantity = 1;
}

public decimal TotalCost
{
    get
    {
        return Quantity * Price;
    }
}
} 
```

现在，如果我获取包含我想要的行的 DanubeDataSet.ProductsTable 对象，如何在我的基础对象中设置所有属性？这不工作...

```
DanubeDataSet.ProductsDataTable productTable = new DanubeDataSetTableAdapters.ProductsTableAdapter().GetProductByID(itemId);
    CartItem newItem = (CartItem)productTable[0];
    items.Add(newItem); 
```

它不能从 DanubeDataSet.ProductsRow 类型转换为 CartItem。我理解为什么会这样，但是必须有一种方法可以将 ProductsRow 的数据移动到 CartItem，因为它包含 ProductsRow 的所有属性。我错了吗？

如果您有解决方案，请记住我不想更改 DanubeDataSet.ProductsRow 中的代码，因为它是自动生成的。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T04:00:04.653

你不能做你试图用继承做的事情。但是，有一种方便的方法可以使用部分类来执行此操作。这是您要做的：打开您的数据集，右键单击设计图面并从上下文菜单中选择查看代码。这将为数据集创建一个代码隐藏文件。然后按如下方式添加您的属性：

```
public partial class DanubeDataSet 
{
    partial class ProductsRow
    {
        public decimal TotalCost
        {
            get
            {
                return Quantity * Price;
            }
        }
    }
} 
```

# c# - 从应用程序播放 MP3 文件

> ID：10150808
> 
> 赞同：0
> 
> 时间：2012-04-14T03:44:06.450
> 
> 标签：c#, media

我在网上找到了一些代码片段，但问题是它们使用系统本地托管的文件位置，我想从我的应用程序播放 MP3 或 wav 并将 mp3 文件构建到应用程序中，而不是他们需要它以及 .可执行程序。知道如何做这样的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T05:23:51.947

嵌入您的 mp3 或 wav 作为资源：

1.  在解决方案资源管理器中右键单击您的项目。
2.  从菜单中选择添加/现有项目... 选择并添加您的文件。
3.  在解决方案资源管理器中选择一个新添加的文件，右键单击它
4.  从右键菜单中选择属性
5.  将其 Build Action 属性更改为 Embedded Resource

使用以下代码播放它：

```
WindowsMediaPlayer wmp = new WindowsMediaPlayer();
Stream stream = Assembly.GetExecutingAssembly(). GetManifestResourceStream("yourfile.mp3");
string temppath = Path.GetTempPath() + "\\temp.mp3";
using (Stream output = new FileStream (temppath, FileMode.Create))
{
   byte[] buffer = new byte[BUFFER_SIZE];
   int read;

        while ( (read= stream.Read(buffer, 0, buffer.Length)) > 0)
        {
            output.Write(buffer, 0, read);
        }
}
wmp.URL = temppath;
wmp.controls.play(); 
```

完成后不要忘记删除临时文件。

# visual-studio - 无法使用 VS 2010 启动 SOS.dll

> ID：10150810
> 
> 赞同：6
> 
> 时间：2012-04-14T03:44:14.983
> 
> 标签：visual-studio, visual-studio-2010

我正在尝试`SOS.dll`从**Visual Studio 2010 Ultimate**启动。我收到以下错误。

> 命令期间出错：IDebugClient 要求提供未实现的接口 命令期间出错：1BC4EF9E 发生异常 c0000005

我还为项目启用了非托管调试。不知道我错过了什么。我尝试使用以下命令启动 sos.dll

```
.load sos
.load sos.dll
.load C:\Windows\Microsoft.NET\Framework\v4.0.30319\sos.dll 
```

不知道我错过了什么。

`load SOS.dll`与**VS 2008**一起使用时，我可以。任何建议都非常感谢。

提前致谢。

问候，

约根德拉

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-13T23:44:01.227

如果您已将 CLR 升级到 .NET 4.5，则 SOS.dll 在 VS2010 中不起作用。

[http://connect.microsoft.com/VisualStudio/feedback/details/742882/after-installing-visual-studio-11-beta-load-sos-fails-in-visual-studio-2010](http://connect.microsoft.com/VisualStudio/feedback/details/742882/after-installing-visual-studio-11-beta-load-sos-fails-in-visual-studio-2010)

# c++ - 错误：粘贴“运算符”和“+”不会给出有效的预处理令牌

> ID：10150811
> 
> 赞同：5
> 
> 时间：2012-04-14T03:44:24.470
> 
> 标签：c++, c-preprocessor

我正在编写一个小的*Float*类，以便更轻松地比较浮点数（正如我们所知，因为浮点数的精度）。所以我需要重新加载几乎所有*double*的运算符。我发现有太多重复，例如*operator+*、*operator-*、*operator**和*operator/*。它们是相似的。所以我使用宏来减少代码长度。但是当我遵守它时，它不起作用。错误是：

```
happy.cc:24:1: error: pasting "operator" and "+" does not give a valid preprocessing token
happy.cc:25:1: error: pasting "operator" and "-" does not give a valid preprocessing token
happy.cc:26:1: error: pasting "operator" and "*" does not give a valid preprocessing token
happy.cc:27:1: error: pasting "operator" and "/" does not give a valid preprocessing token 
```

这是我的代码：

```
struct Float
{
  typedef double size_type;
  static const size_type EPS = 1e-8;
private:
  size_type x;
public:
  Float(const size_type value = .0): x(value) { }
  Float& operator+=(const Float& rhs) { x += rhs.x; return *this; }
  Float& operator-=(const Float& rhs) { x -= rhs.x; return *this; }
  Float& operator*=(const Float& rhs) { x *= rhs.x; return *this; }
  Float& operator/=(const Float& rhs) { x /= rhs.x; return *this; }
};
#define ADD_ARITHMETIC_OPERATOR(x) \
inline const Float operator##x(const Float& lhs, const Float& rhs)\
{\
  Float result(lhs);\
  return result x##= rhs;\
}
ADD_ARITHMETIC_OPERATOR(+)
ADD_ARITHMETIC_OPERATOR(-)
ADD_ARITHMETIC_OPERATOR(*)
ADD_ARITHMETIC_OPERATOR(/) 
```

我的 g++ 版本是 4.4.3

这是 g++ -E 的结果：

```
struct Float
{
  typedef double size_type;
  static const size_type EPS(1e-8);
private:
  size_type x;
public:
  Float(const size_type value = .0): x(value) { }
  Float& operator+=(const Float& rhs) { x += rhs.x; return *this; }
  Float& operator-=(const Float& rhs) { x -= rhs.x; return *this; }
  Float& operator*=(const Float& rhs) { x *= rhs.x; return *this; }
  Float& operator/=(const Float& rhs) { x /= rhs.x; return *this; }
};

inline const Float operator+(const Float& lhs, const Float& rhs){ Float result(lhs); return result += rhs;}
inline const Float operator-(const Float& lhs, const Float& rhs){ Float result(lhs); return result -= rhs;}
inline const Float operator*(const Float& lhs, const Float& rhs){ Float result(lhs); return result *= rhs;}
inline const Float operator/(const Float& lhs, const Float& rhs){ Float result(lhs); return result /= rhs;} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-14T03:49:56.930

`##`连接标记以产生单个标记；结果必须是有效的单个令牌。您不需要为 执行此操作`operator`，因为 eg`operator+`实际上不是单个令牌。

```
#define ADD_ARITHMETIC_OPERATOR(x) \
inline const Float operator x(const Float& lhs, const Float& rhs)\
{\
  Float result(lhs);\
  return result x##= rhs;\
} 
```

严格来说，您*正在*为后一个令牌生成一个令牌。

实际上是文本预处理器而不是在标记化期间运行的预处理器，例如 GCC 中的预处理器，通常对此很宽容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T03:54:38.870

您不能`##`在宏中使用；粘贴的标记必须是标识符。

宏中的两次出现中的第一次可以简单地替换为空格。第二个问题要多得多。从表面上看，你可能会逃脱：

```
#define ADD_ARITHMETIC_OPERATOR(x) \
inline const Float operator x(const Float& lhs, const Float& rhs)\
{\
  Float result(lhs);\
  return result x= rhs;\
} 
```

但是，这肯定不是定义的行为；the`x`和 the`=`是单独的预处理标记，不会（不应该）被预处理器组合成单个标记。我怀疑您将需要使用：

```
#define ADD_ARITHMETIC_OPERATOR(x, y) \
inline const Float operator x(const Float& lhs, const Float& rhs)\
{\
  Float result(lhs);\
  return result y rhs;\
}
ADD_ARITHMETIC_OPERATOR(+, +=) 
```

# objective-c - 将文档文件夹中的数据显示到 UITableView 并转到 Objective C 中的选择

> ID：10150813
> 
> 赞同：2
> 
> 时间：2012-04-14T03:45:18.743
> 
> 标签：objective-c, ios, save

我正在制作一个允许用户创建文件（html）并编辑/查看它们的应用程序。这些文件保存在应用程序的 Documents 文件夹中。我想知道是否有任何好方法可以在 UITableView 中显示所有文件和文件夹。

另外，您如何将用户的选择传递给要阅读的文本视图？我知道如果函数可以加载文件，它会如何获取行 ID 并传递名称......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T03:58:32.667

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSArray *currentDirectory = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:documentsDirectory error:NULL]; 
```

将在文档目录中为您提供一个文件名数组作为 NSString，然后您只需将其用作表格视图的数据。选择文件时，您可以使用`NSMutableData`'`initWithContentsOfFile`方法将路径作为变量来获取`NSMutableData`要传递给编辑器的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T04:04:40.590

如果您正在设置单元格文本标签，那么传递字符串是不费吹灰之力的。在 didSelectRowAtIndexPath 中，执行以下操作：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
//alloc and init view with custom init method that accepts NSString* argument  
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:"];
NSString*pathToPass = [documentsDirectory stringByAppendingPathComponent:[self.tableView cellForRowAtIndexPath:indexPath].textLabel.text]; //pass this.

} 
```

# vb.net - Paypal IPN 返回无效响应

> ID：10150818
> 
> 赞同：0
> 
> 时间：2012-04-14T03:46:16.100
> 
> 标签：vb.net, paypal-ipn

```
{Following is the vb.net code for IPN listener:
    If Me.TestMode = True Then
            Me.RequestUrl = "https://www.sandbox.paypal.com/cgi-bin/webscr"
        Else
            Me.RequestUrl = "https://www.sandbox.paypal.com/cgi-bin/webscr" '"https://www.paypal.com/cgi-bin/webscr"
        End If

        '====================================Test======================================'
        Dim startTime As String = String.Format("{0:MM-dd-yyyy hh:mm:ss:tt}", Now)
        '=============================================================================='

        Dim req As HttpWebRequest = CType(WebRequest.Create(Me.RequestUrl), HttpWebRequest)
        req.Method = "POST"
        req.ContentType = "application/x-www-form-urlencoded"
        Dim Param() As Byte = HttpContext.Current.Request.BinaryRead(HttpContext.Current.Request.ContentLength)
        Dim strRequest As String = Encoding.ASCII.GetString(Param)
        strRequest = strRequest & "&cmd=_notify-validate"
        req.ContentLength = strRequest.Length
        ' Dim pairs() As String = strRecieved.Split("&")
        Using streamOut As StreamWriter = New StreamWriter(req.GetRequestStream(), Encoding.ASCII)
            streamOut.Write(strRequest.ToString)
            streamOut.Close()
        End Using
        Dim streamIn As StreamReader = New StreamReader(req.GetResponse().GetResponseStream())
        Dim strResponse As String = streamIn.ReadToEnd()
        streamIn.Close()
        WriteLog(strResponse) 
```

我已经在 vb.net 中完成了 paypal IPN 监听器的代码。当我使用 paypal 沙盒帐户测试该 url 时，它显示以下消息：“IPN 成功发送”。但是当我在服务器上检查我的日志文件时，它会显示来自贝宝沙箱 url 的无效响应。如果没有 VALID 响应，我的其他代码将无法工作。请帮忙！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T06:09:43.313

通过 vb.net 生成 paypal 交易，例如立即购买按钮

```
Public Shared Function GetPayPalPaymentUrl(item_name As String, item_number As String, amount As String, quantity As String, username As String) As String
Dim strURL As String = "https://www.sandbox.paypal.com/cgi-bin/webscr"
If PaypalBLL.Paypal_Live_Status() = 1 Then
    strURL = "https://www.paypal.com/cgi-bin/webscr"
End If
Dim BaseUrl As String = Config.GetUrl()
Dim cancel_url As String = BaseUrl + "paypal/cancel.aspx"
Dim return_url As String = BaseUrl + "paypal/confirmation.aspx"
Dim notifyUrl As String = BaseUrl + "paypal/ipn.aspx"
'string image_url = ""
Dim image_url As String = ""
' paypal header url
Dim paypal_logo As String = HttpUtility.UrlEncode(BaseUrl + "images/logo.png")
Dim Url As New StringBuilder()
Dim CustomFieldValue As String = username
'User-defined field which PayPal passes through the system and returns to you in your merchant payment notification email. Subscribers do not see this field.
Url.Append(strURL + "?cmd=_xclick&upload=1&rm=2&no_shipping=1&no_note=1&currency_code=USD&business=" + PaypalBLL.Paypal_Receiver_Email() + "&item_number=" + item_number + "&item_name=" + item_name + "&amount=" + amount + "&quantity=" + quantity + "&undefined_quantity=0&notify_url=" + notifyUrl + "&return=" + return_url + "&cancel_return=" + cancel_url + "&cpp_header_Image=" + image_url + "&cpp_headerback_color=ECDFDF&cpp_headerborder_color=A02626&cpp_payflow_color=ECDFDF&image_url=" + paypal_logo + "&custom=" + CustomFieldValue + "")
Return Url.ToString()
End Function 
```

生成贝宝链接，当您点击链接时，您将被重定向到贝宝沙箱或实时链接。完成交易后，您将被重定向回网站，并且在后台 paypal 将通过 ipn 发送交易事件。

希望您会收到正确的 ipn 响应。

# r - 模拟 R 中直方图二项式波动的零计数箱

> ID：10150820
> 
> 赞同：1
> 
> 时间：2012-04-14T03:46:26.280
> 
> 标签：r, statistics, simulation

我有一个带有观察到的 bin 计数的直方图。我想根据观察到的计数运行模拟，以了解相同数量的观察结果可能如何不同地发生。我将直方图转换为向量，并将观察到的计数作为向量的一个元素。`rbinom(n, size, prob)`我使用基于 bin 频率的概率从二项式分布（来自 ）生成的随机数来模拟每个 bin 。

我的问题是模拟观察计数为零的箱。当 bin 计数为零时，`prob`=0，因此该 bin 的模拟计数始终为零。这是非物质的，不是我想要的。目前，我通过用 1 的 bin 计数覆盖零 bin 计数来解决这个问题。我不确定这样做的效果，所以我不知道我的模拟是否会超出我的容差。我正在寻找比我的临时方法更好或更优雅的问题解决方案。

有任何想法吗？谢谢你。

这是我的相关代码：

```
sim.vector <- function(x, n = length(x)) {
  sum.vector <- round(sum(x), 0)  # the number of observations
  x.dummy <- x
  x.dummy[x.dummy == 0] <- 1  # override bins with zero counts
  f <- x.dummy / sum(x) # the frequency of each bin
  x.sim <- rep(0, n)
  while(sum.vector != sum(x.sim)) {  # make sure the simulation has the same
                                     # number of total counts as the observation
    for (i in 1:n) {
      p.target <- f[i]  # set the probability of each bin to the frequency
      x.sim[i] <- rbinom(1, sum.vector, p.target)  # create a random binomial
    }
  }
  return(x.sim)
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T18:05:45.620

这个在频率估计中解决零计数的问题有时被称为平滑（特别是在自然语言处理社区中，它们处理数千个“bin”，因此零计数很常见）；而不是使用计数，您使用[伪](http://en.wikipedia.org/wiki/Pseudocount)计数。

与您正在做的类似的一种简单方法称为[拉普拉斯的“继承规则”](http://en.wikipedia.org/wiki/Rule_of_succession)：只需在每个 bin 中添加一个（不仅是零）。[更一般地，您可以在附加平滑](http://en.wikipedia.org/wiki/Additive_smoothing)中添加不同的数字（通常小于 1）。贝叶斯，这对应于在二项式概率上使用狄利克雷先验。

更复杂的方法是[Good-Turing 平滑](http://en.wikipedia.org/wiki/Good-Turing_smoothing)。

如果您的数据有不同的概率模型，在您的设置中更有意义，您也可以使用它（如 Eric 建议的那样）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T17:41:04.417

您尝试做的事情听起来很像自举，如果您从一个包含 n 个值的数组开始，您会从该数组中随机选择 n 个值并进行替换。正如您所注意到的，引导不会给您一个您还没有的价值。

您设置零箱的方法是可以的。生态学家使用的一种技术是将零值设置为他们可以做出的最小测量误差。例如，如果对树木进行计数，则最小错误计数为 1。如果保持分布的平均值对您很重要，请确保将 0 更改为 1 不会使平均值增加太多。

另一种选择是使用参数分布来拟合您的 bin。您所在领域的人是否有他们使用的典型分布，或者数据是否暗示了分布？如果您仍然需要 bin，则可以对拟合的参数分布进行 bin。祝你好运。

这是生成垃圾箱计数的更快方法：

```
# you have three bins which we label 1,2,3
# change to 1:n where n = number of your bins
binIndex = 1:3
# you have 2 values in bin 1, 3 values in bin 2, 1 value in bin 3
count1 = c(2,3,1)

# create a vector with all bin labels
unbin = mapply(function(bin1,ct1){
    rep(bin1,times=ct1)
},binIndex,count1)

unbin = unlist(unbin)
print(unbin)

# generate "bootstrapBinCount" of bootstrapped bins
bootstrapBinCount = 10

# in general, use lapply instead of while/for loops in R - it's orders of magnitude faster
# newBins is a list of binCounts
# to access the first bin count, try newBins[[1]]
newBins = lapply(1:bootstrapBinCount,function(x){
    # generate a bootstrap from the list of bin labels by sampling with replacement
    bootstrap1 = sample(unbin, size=length(unbin), replace = TRUE)
    # count the number of times each bin label shows up
    rebin = table(bootstrap1)
    # get the names of the labels that showed up
    names1 = as.integer(names(rebin))
    # fill in the counts from rebin, but also include cases where there are no values     for a given bin label
    rebinPlusZeroes = rep(0,times=length(binIndex))
    rebinPlusZeroes[names1] = as.integer(rebin)

    return(rebinPlusZeroes)
})

print(str(newBins)) 
```

# ios - iOS - Core Data - 成功创建/打开之前

> ID：10150821
> 
> 赞同：0
> 
> 时间：2012-04-14T03:46:51.693
> 
> 标签：ios, core-data, uimanageddocument

**概述**

我有一个 iOS 项目，我在其中将名称列表存储在表格视图中。

我了解打开/创建数据库的那一刻，有一个完成处理程序来执行一个方法。

**脚步：**

1.  就我而言，第一个屏幕是显示名称的表格视图
2.  有一个 + 按钮（在导航栏上）可以添加一个新名称，该名称会将其带到新屏幕以输入详细信息。

**关心**

我担心的是，如果我在完成处理程序中获取 tableview 的名称，并且如果用户不等待打开数据库并创建一个新名称，同时保存它，数据库可能不会打开/创建。

**问题**

1.  如何处理这样的情况？
2.  我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T04:26:22.657

真的，在一切初始化之前，您不应该允许用户更改内容。如果需要一段时间，则只需禁用该功能，直到准备好。

在这种情况下，这很容易。从禁用“添加”按钮开始，并在完成处理程序中启用它。

您可以编写一个 documentIsReady 方法（这将启用编辑，以及在“一切就绪”时您想做的任何其他事情），然后在文档准备好使用时调用它。例如，请参见下面的代码。

```
 if (![[NSFileManager defaultManager] fileExistsAtPath:[doc.fileURL path]]) {
        [doc saveToURL:doc.fileURL forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success) {
            [self documentIsReady: success];
        }];
    } else if (doc.documentState == UIDocumentStateClosed) {
        [doc openWithCompletionHandler:^(BOOL success) {
            [self documentIsReady: success];
        }];
    } else {
        BOOL success = doc.documentState == UIDocumentStateNormal;
        [self documentIsReady: success];
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T03:52:54.607

好吧，处理这种情况的一种（简单）方法是添加一个计时器以等待数据库打开/创建。您也可以将按钮（+ 按钮）变灰，直到数据库准备就绪。

# jquery - 从 JQuery 将 JSON 写入文本文件

> ID：10150824
> 
> 赞同：2
> 
> 时间：2012-04-14T03:47:35.630
> 
> 标签：jquery, json

我有一堆 JSON 对象存储在 JQuery 的一个数组中。有没有一种简单的方法可以将它们重写为我本地机器的 JSON 文本文件？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T05:16:55.360

您可以使用数据 URI 方案将 JSON 转换为可以下载的“URL”，即

```
/* Firstly you'll need a javascript library which can encode data to base 64
 * http://archive.plugins.jquery.com/project/base64  - jQuery Plugin
 * http://www.webtoolkit.info/javascript-base64.html - Collection of functions
 * http://stackoverflow.com/a/6740027/451672         -     ''     ''     "
 */

/* Now we must convert the JSON to text, which can be done with the 
   JSON.stringify() method
 * http://msdn.microsoft.com/en-us/library/cc836459(v=vs.85).aspx
 */

var data = JSON.stringify(myObject);

/* Now we convert the data to a Data URI Scheme, which must be Base64 encoded
   make sure you use the appropriate method to Base64 encode your data depending
   on the library you chose to use.
 * application/octet-stream simply tells your browser to treat the URL as 
   arbitrary binary data, and won't try to display it in the browser window when 
   opened.
 */
var url = "data:application/octet-stream;base64," + Base64.encode(data);

/* To force the browser to download a file we need to use a custom method which
   creates a hidden iframe, which allows browsers to download any given file 
 * http://stackoverflow.com/a/3749395/451672
 */
var downloadURL = function(url)
{
    var iframe;
    iframe = document.getElementById("hiddenDownloader");
    if (iframe === null)
    {
        iframe = document.createElement('iframe');  
        iframe.id = "hiddenDownloader";
        iframe.style.display = "none";
        document.body.appendChild(iframe);
    }
    iframe.src = url;   
}

/* Now downloading is simple as executing the following code, make sure that
   the DOM is not modified until after the page has finished loading!
 */
window.onload = function()
{
    var link = document.getElementById("downloadJSON");
    link.onclick = function()
    {
        downloadURL(url);
    }
} 
```

**jsFiddle：http:** [//jsfiddle.net/cQV7X/](http://jsfiddle.net/cQV7X/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-14T03:56:15.383

```
console.log(JSON.stringify([1,2,3,4,5])); 
```

打开 gedit 或其他文本编辑器。从控制台复制。粘贴到文件中。另存为 array.json。

**编辑** Chrome 支持`copy`，因此您可以这样做`copy("foobar")`，并且“foobar”将出现在您的剪贴板上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T03:56:42.563

有一个 jQuery 插件[jQuery.twFile](http://jquery.tiddlywiki.org/twFile.html)允许您读取和写入本地文件。

# playn - PlayN，点 [x,y] 位置与缩放层

> ID：10150827
> 
> 赞同：1
> 
> 时间：2012-04-14T03:48:52.157
> 
> 标签：playn

在 PlayN 中，如果我缩放了根层（例如，比例为 2.0），当我在屏幕上检测到鼠标点 10,10 并将其绘制在屏幕上时，显示的点是我在操作系统上看到的距离的两倍鼠标点。

我想要的是我拖动的对象以与我移动操作系统鼠标指针完全相同的距离移动。

是否有一个坐标映射函数可以将我的鼠标输入 X/Y 映射到我的逻辑缩放坐标系？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T19:07:03.010

你有两个选择。您可以`Pointer.Listener`在根图层上注册您的并用于`Pointer.Event.localX/Y`获取图层坐标系中的鼠标坐标：

```
graphics().rootLayer().addListener(new Pointer.Adapter() {
    public void onPointerStart(Pointer.Event event) {
        // use event.localX() and event.localY() here
    }
}); 
```

或者您可以注册一个全局`Pointer.Listener`并使用`Layer.Util`手动翻译点：

```
pointer().addListener(new Pointer.Adapter() {
    public void onPointerStart(Pointer.Event event) {
        Point local = Layer.Util.screenToLayer(graphics().rootLayer(), event.x(), event.y());
        // use local.x and local.y here
    }
}); 
```

# javascript - 如何使用 FQL 一次获得最新的朋友墙

> ID：10150830
> 
> 赞同：0
> 
> 时间：2012-04-14T03:49:52.477
> 
> 标签：javascript, stream, facebook-fql

我想用 FQL 一次获得最新的朋友墙。

当我调用以下 FQL 时，我无法获得每个朋友的墙。

```
'SELECT created_time,message FROM stream WHERE source_id IN (SELECT uid2 FROM friend WHERE uid1=me())' 
```

所以，我调用每个朋友的 ID 的 Graph API。

```
FB.api('/'+<friend uid>+'/posts?limit=1'); 
```

但是，如果用户有 5000 个朋友，则需要 5000 个电话。

实际上，当我练习它时，它变成了错误。

因为50箱也好所以没有获得的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T06:49:06.660

查找 fql 批处理，您一次最多可以执行 50 个查询

# java - 我可以使用数字作为用于在 JFreeChart 中的 XYPlot 上显示点的形状图标吗？

> ID：10150833
> 
> 赞同：1
> 
> 时间：2012-04-14T03:50:28.980
> 
> 标签：java, awt, shape, glyph, imageicon

我正在绘制三个时间序列，我想使用数字 1、3 和 5 作为 XYLineAndShapeRenderer 用于显示序列的实际形状。

即使您没有使用 JFreeChart 的经验，如果我能弄清楚如何执行以下任何操作，我想我可以完成我的任务：

1.  将字符/字形转换为 java.awt.Shape
2.  将字符/字形转换为 ImageIcon

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T04:36:39.297

`Font.createGlyphVector`您可以使用和获得字形轮廓`GlyphVector.getGlyphOutline`。

下面的方法检索`GlyphVector`指定的 a`String`并检索它们的轮廓，`AffineTransform`在此过程中应用 an。

```
static Shape[] getGlyphShapes(Font font, String strGlyphs, AffineTransform transform) {

    FontRenderContext frc = new FontRenderContext(null, true, true);
    GlyphVector glyphs = font.createGlyphVector(frc, strGlyphs);

    int count = glyphs.getNumGlyphs();
    Shape[] shapes = new Shape[count];
    for (int i = 0; i < count; i ++) {

        // get transformed glyph shape
        GeneralPath path = (GeneralPath) glyphs.getGlyphOutline(i);
        shapes[i] = path.createTransformedShape(transform);
    }
    return shapes;

} 
```

默认情况下，返回的字形形状的字体大小为 1，因此`AffineTransform`. 一个示例转换是：

```
 AffineTransform transform = new AffineTransform();
            transform.translate(-20, 20);
            transform.scale(40, 40); 
```

它应该将每个字形（我认为您需要）以 40 的字体大小大致居中。为了更准确的居中，您可以使用`GlyphMetrics`，通过获取`GlyphVector.getGlyphMetric`并计算您需要的确切翻译。

# objective-c - 将 C 类型转换为 Objective-C 对象

> ID：10150836
> 
> 赞同：1
> 
> 时间：2012-04-14T03:51:02.227
> 
> 标签：objective-c, ios, c

我有两个问题。

1.  如何使用 FILE* 实例创建 NSFileHandle 对象？

2.  如何使用 void* 实例创建 NSData 对象？

很抱歉，没有上下文的信息很少。

只需参考我最近的问题。[ios 上 fopen 的奇怪行为](https://stackoverflow.com/questions/9749369/weird-behavior-of-fopen-on-ios/9759112#9759112)我无法使用本机 fopen 函数来创建内容或将内容写入文件。

结果我只想用ios框架里面的api，把fopen和fwrite之类的代码封装起来。所以我应该将 FILE* 对象转换为 NSFileHandle 或可以操作文件的东西。用 void* 处理的内容也应该转换为 ios 框架可以接受的数据格式。我认为 NSData 应该是选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T04:17:09.930

至于 FILE* 到 NSFileHandle，我发现这个[邮件列表](http://lists.apple.com/archives/cocoa-dev/2002/Mar/msg01943.html)问题完全符合您的需要。相关代码：

```
FILE *fp;
NSFileHandle *p;

fp = fopen( "foo", "r");
p = [[[NSFileHandle alloc] initWithFileDescriptor:fileno( fp)
closeOnDealloc:YES] autorelease]; 
```

它带有来自回答者的可爱警告：

> 注意不要从 fp 读取，因为 stdio 缓存。

编辑：至于 void* 到 NSData，我想你想要`NSData's -initWithBytesNoCopy:Length:freeWhenDone:`. 请参阅有关如何使用它的[相关问题。](https://stackoverflow.com/questions/8691997/behavior-of-nsdata-initwithbytesnocopylengthfreewhendone)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T04:15:45.640

您可以像在 C 中一样使用 FILE*。例如...

```
- (id)initWithFileUrl:(NSURL *)url
{
    if (self = [super init]) {
        NSFileManager *fileManager = [[NSFileManager alloc] init];
        [fileManager createDirectoryAtPath:[[url path] stringByDeletingLastPathComponent] withIntermediateDirectories:YES attributes:nil error:0];

        char const *path = [fileManager fileSystemRepresentationWithPath:url.path];
        fp = fopen(path, "a");
        if (!fp) {
            [NSException raise:@"Can't open file for recording: " format:@"%s", strerror(errno)];
        }

        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(applicationWillResignActive:) name:UIApplicationWillResignActiveNotification object:[UIApplication sharedApplication]];
    }
    return self;
}
- (void)writeBytes:(void const *)bytes length:(uint32_t)size
{
    if (fp && fwrite(bytes, size, 1, fp) != 1) {
        [NSException raise:@"File Write Error" format:@"%s", strerror(errno)];
    }
}
- (void)writeBytes:(void const *)bytes andSize:(uint32_t)size
{
    if (!fp) return;
    if (fwrite(&size, sizeof size, 1, fp) != 1 || fwrite(bytes, size, 1, fp) != 1) {
        [NSException raise:@"File Write Error" format:@"%s", strerror(errno)];
    }
}
- (void)writeInt32:(int32_t)value
{
    [self writeBytes:&value length:sizeof value];
}
- (void)writeInt64:(int64_t)value
{
    [self writeBytes:&value length:sizeof value];
}
- (void)writeData:(NSData *)data
{
    [self writeBytes:data.bytes andSize:data.length];
}
- (void)writeCGFloat:(CGFloat)value
{
    [self writeBytes:&value length:sizeof value];
}
- (void)writeCGPoint:(CGPoint)point
{
    [self writeBytes:&point length:sizeof(point)];
} 
```

# mysql - 在 MySQL 中插入唯一行的最便宜的方法？

> ID：10150840
> 
> 赞同：3
> 
> 时间：2012-04-14T03:52:03.437
> 
> 标签：mysql, database

我有一个表，其中包含在唯一索引下定义的列。在向表中插入数据时，我目前不检查是否已经存在匹配的行，而是让 MySQL 处理它。

这是首选方法吗？我的意思是，我可以在插入之前添加一个 SELECT 来检查重复行，但从性能角度来看，这似乎会更昂贵，因为可能有 5-10% 的插入会触发重复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T03:53:37.047

是的，让 MySQL 自己弄清楚。它已经知道下一个可能的值是什么，并且会比你更快地选择它。

您的方法不仅可能`select`失败，而且还涉及到服务器的两次往返而不是一次。更不用说让服务器自己解决它会给它更多优化的机会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T04:04:44.950

MySQL 有一个非常有用的“ON DUPLICATE KEY”语法：

[http://dev.mysql.com/doc/refman/5.5/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.5/en/insert-on-duplicate.html)

# directx - HLSL 将单个浮点数传递给 PS？

> ID：10150848
> 
> 赞同：3
> 
> 时间：2012-04-14T03:54:28.617
> 
> 标签：directx, shader, hlsl

我正在阅读 Frank Luna 的“DirectX 9.0c: A Shader Approach”一书，我在第 10 章的练习 2 中遇到问题。我应该计算一个浮点值*s*并将其传递给像素着色器，以便我可以计算“香椿照明”。我了解计算工作原理背后的理论，但我似乎无法弄清楚如何将单个浮点值从我的顶点着色器传递到像素着色器。当我在 MSDN 上搜索时，我只找到了让你传递 3d 向量等的语义。

看起来我可能需要以某种方式修改我的输入和输出结构，但是到目前为止的练习除了单个“outputVS”结构之外还没有任何结构。

简而言之，如何将单个浮点值从顶点着色器传递到 HLSL 中的像素着色器？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T05:33:25.243

您将浮点数放入向量的一个分量中。然后你的像素着色器只读取一个组件。

没有法律规定向量的每个分量都*必须*包含实际数据；）

# java - 如何将任何语言和字符集的字符串转换为 Java 中的有效文件名？

> ID：10150850
> 
> 赞同：6
> 
> 时间：2012-04-14T03:54:44.423
> 
> 标签：java, unicode, internationalization, filenames

我需要从用户输入的名称生成文件名。这些名称可以是任何语言。例如：

*   “约翰·史密斯”
*   《高冈和子》
*   "محمد سعيد بن عبد العزيز الفلسطيني"

这些是使用输入的值，所以我不能保证名称不包含在文件名中无效的字符。

用户将从他们的浏览器下载这些文件，因此我需要确保文件名在所有配置的所有操作系统上都有效。

我目前正在为英语国家这样做，只需使用简单的正则表达式删除所有非字母数字字符：

```
string = string.replaceAll("[^a-zA-Z0-9]", "");
string = string.replaceAll("\\s+", "_") 
```

一些示例转换：

*   “约翰史密斯”->“John_Smith.ext”
*   “约翰·奥亨利”->“John_OHenry.ext”
*   “约翰·范·史密斯三世”->“John_van_Smith_III.ext”

显然，这在国际上是行不通的。

我考虑过查找/生成在所有文件系统上无效的所有字符的黑名单，并从名称中删除这些字符。我一直找不到完整的清单。

如果可能的话，我更愿意使用公共库中的现有代码。我想这是一个已经解决的问题，但是我找不到在国际上有效的解决方案。

**文件名是给下载文件的用户的，不是给我的。我不会存储这些文件。**这些文件是由服务器根据数据库中数据的请求动态生成的。文件名是为了方便下载文件的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T07:14:51.323

正则表达式`[^a-zA-Z0-9]`将过滤非 ASCII 字符，这些字符将忽略 Unicode 字符或超过 128 个代码点的字符。

假设您要通过替换无效文件名字符（例如`? \ / : | < > *`用下划线 ( `_`) ）来过滤用户输入的有效文件名：

```
import java.io.UnsupportedEncodingException;

public class ReplaceI18N {

    public static void main(String[] args) {
        String[] names = {
                "John Smith",
                "高岡和子",
                "محمد سعيد بن عبد العزيز الفلسطيني",                
                "|J:o<h>n?Sm\\it/h*", 
                "高?岡和\\子*", 
                "محمد /سعيد بن عبد ?العزيز :الفلسطيني\\"
                };

        for(String s: names){
            String u  = s;
            try {
                u = new String(s.getBytes(), "UTF-8");
            } catch (UnsupportedEncodingException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } 
            u = u.replaceAll("[\\?\\\\/:|<>\\*]", " "); //filter ? \ / : | < > *
            u = u.replaceAll("\\s+", "_");
            System.out.println(s + " = " + u);
        }
    }
} 
```

输出：

```
John Smith = John_Smith
高岡和子 = 高岡和子
محمد سعيد بن عبد العزيز الفلسطيني = محمد_سعيد_بن_عبد_العزيز_الفلسطيني
|J:o<h>n?Sm\it/h* = _J_o_h_n_Sm_it_h_
高?岡和\子* = 高_岡和_子_
محمد /سعيد بن عبد ?العزيز :الفلسطيني\ = محمد_سعيد_بن_عبد_العزيز_الفلسطيني_ 
```

即使是 Unicode 字符，有效的文件名也可以显示在任何支持 UTF-8 编码和正确 Unicode 字体的网页上。

此外，在任何支持 Unicode 的操作系统文件系统上，每个文件都是其文件的正确名称（在 Windows XP、Windows 7 上测试正常）。

![i18n 文件名](../Images/2fb07a3462a84fa738a69d827b07d025.png)

但是，如果您想将每个有效文件名作为 URL 字符串传递，请确保使用正确对其进行编码，`URLEncoder`然后使用`URLDecoder`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T03:59:13.673

让输入确定文件名而不进行适当的清理似乎容易受到安全攻击。您可以使用散列函数（SHA-1、MD5）来生成有效的文件名。请注意，您不能从哈希中派生原始名称。

此外，如果您有一个简单的查找表，您可以为名称分配特殊标识符（如序号或 GUID），并将标识符用作文件名。

另一件事，你有没有想过同音字？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T04:02:34.183

将文件名编码为 UTF-8，然后对结果进行 URL 编码。

```
'高岡和子' -> '%E9%AB%98%E5%B2%A1%E5%92%8C%E5%AD%90' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T04:03:47.117

Windows[似乎支持 unicode 文件名](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx)，我知道 Linux 支持，显然 OS X 也支持。据推测，编写良好的文件会在保存文件名之前修复文件名中的无效字符。

似乎您应该能够只使用 unicode 文件名。是否有一些操作系统或浏览器无法运行？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-14T05:53:21.723

我的建议是*要求*您的应用程序在支持 Unicode 文件名的平台上运行。这些天大多数人都这样做。

我认为从 Unicode 映射到（未指定的）受限字符集是不可行的，同时仍保留人类可读性和原始含义并避免冲突。事实上，甚至不可能进行从 Latin-1 到 ASCII 的映射。

如果您的应用程序*必须*在不支持 Unicode 文件名的平台上运行，那么在某些情况下，您将需要牺牲人类可读性和/或文件名的含义。此外，请考虑（例如）ASCII 化的中文字符或西里尔字母或去除重音的字母是否会被您的最终用户接受。

* * *

我要做的是为用户提供两个选项供您选择：

*   使用 Unicode 文件名上传文件的选项。这应该是默认设置，因为大多数用户的机器都支持这一点。

*   使用与原始字符串/文本无关的生成名称的后备选项。

实际上，如果用户的机器不支持 Unicode，那么他们将在处理未使用机器的本机编码编码的文本名称时遇到巨大的问题。没有完全可靠的方法可以找出那是什么。即使您有一种半可靠的方法来解决这个问题......在服务器端......将所有 Unicode 映射到该编码的问题是棘手的。

最好*鼓励*用户将他/她的操作系统升级到支持 Unicode 的操作系统。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T09:54:12.967

总结和解释@eee的答案......

```
String sanitizeFilename(String unsanitized) {
     return unsanitized
                .replaceAll("[\\?\\\\/:|<>\\*]", " ") // filter out ? \ / : | < > *
                .replaceAll("\\s", "_");              // white space as underscores
} 
```

（不要将多个空间合二为一！）

# php - 包含数组时找不到PHP服务器？

> ID：10150856
> 
> 赞同：-1
> 
> 时间：2012-04-14T03:56:08.817
> 
> 标签：php, arrays

我只是在检查一些函数，代码就这么简单：

```
<?php 

echo "hello" ; 

$var = '1';

var_dump($var);
//$arr = ('a'=>'1','b'=>'2', 'c'=>'3' ,) ;

//print_r($arr);

?> 
```

现在，如果我取消注释`$arr`，然后在浏览器中访问我的文件，它会给我一个服务器错误。这太奇怪了。我不知道wassup。但我确信这是一个愚蠢的错误。谁能给我一个提示？

我也这样做了`$arr = (1,2,3,4,5)`，`$arr = ('1','2','3','4','5')`但无济于事；同样的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T03:57:40.093

如果你~~`,`从数组声明的末尾删除多余的逗号 ( ) +~~正确声明你的数组？

**像这样 ：**

```
<?php 

    echo "hello"; 

    $var = '1';

    var_dump($var);
    $arr = array('a'=>'1','b'=>'2','c'=>'3');

    print_r($arr);

?> 
```

**如何创建数组：**

```
<?php
$array = array(
    "foo" => "bar",
    "bar" => "foo",
);

// as of PHP 5.4
$array = [
    "foo" => "bar",
    "bar" => "foo",
];
?> 
```

* * *

**参考： http:** [//php.net/manual/en/language.types.array.php](http://php.net/manual/en/language.types.array.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T04:01:13.730

您需要使用`array()`构造来创建数组，而不仅仅是`()`.

```
// all versions
$array = array('foo' => 'bar');

// 5.4+
$array = ['foo' => 'bar']; 
```

虽然@Dr.Kameleon 提到删除多余的`,`（*逗号*），但将它留在里面是完全可以接受的；在很多情况下推荐。

```
$array = [
    'foo' => 'bar',
]; 
```

它只是有助于快速重新排列/添加/删除条目。

# keyboard - 无法使用 Ukulele 重新映射修改键

> ID：10150863
> 
> 赞同：1
> 
> 时间：2012-04-14T03:58:16.727
> 
> 标签：keyboard

我有一个 USB 键盘，正在尝试使用 Ukulele 重新映射某些键。虽然重新映射适用于大多数键，但它似乎根本不适用于修饰符（命令、选项等）当我使用本机键盘时默认设置。帮助？我是 Mac OS X 雪豹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T04:00:38.470

修改键重新映射已在键盘首选项窗格中可用（隐藏在按钮下）。我不记得它是否是 Snow Leopard 中的每个键盘。它在狮子。

# javascript - Jquery - 更新背景 css

> ID：10150865
> 
> 赞同：0
> 
> 时间：2012-04-14T03:58:38.457
> 
> 标签：javascript, python, django, jquery

我正在使用 Jquery 表单插件[http://jquery.malsup.com/form/#ajaxForm](http://jquery.malsup.com/form/#ajaxForm)通过 ajax 将图像上传到用 Django 编程的服务器端。上传图像时，它会自动将背景更改为该图像。一切都很完美（图像存储在数据库中并返回响应）但是如何使用该 responseText 更新 css。

这是我的 javascript 代码：[https ://gist.github.com/2381991](https://gist.github.com/2381991)

姜戈回应：

```
 url('home/nirmal/try/files/background/monalisa.jpg') 
```

Django 视图.py：

```
@login_required
def backgroundview(request):
    if request.is_ajax():
        form = BackgroundModelForm(request.POST, request.FILES)
        if form.is_valid():
            try:
                g = BackgroundModel.objects.get(user=request.user)
            except BackgroundModel.DoesNotExist:
                data = form.save(commit=False)
                data.user = request.user
                data.save()
            else:
                g.background = request.FILES['background']
                g.save()
            return HttpResponse("url('"+g.background.url+"')")
    else:
        form = BackgroundModelForm()
        return render_to_response("cover.html", {'form': form}, context_instance=RequestContext(request)) 
```

我不知道如何在 jquery 中更新 css: background-image: url() 。有人可以帮我吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T04:14:37.807

在 jQuery 表单插件的 showResponse 回调中，只需选择要应用背景图片的元素，然后使用 .css 方法设置背景图片：

```
$("#some_element_id").css("backgroundImage", "url('/relative/address/to/image.jpg')"); 
```

注意：您需要使用相对于 Web 根目录的图像路径，而不是您的主目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T04:38:40.030

首先，您的客户端 jQuery 期望什么 mimetype 响应？你代码返回`text/html`，`HttpResponse`你可以[`.css('background-image', response_data)`](http://api.jquery.com/css/)。

其次，`g.background.url`看起来不正确，您`MEDIA_URL`的设置是什么？

此外，请检查您的问题[Model has no attribute _committed](https://stackoverflow.com/questions/10150301/django-model-has-no-attribute-committed)，`g.background = request.FILES['background']`这里不检查图像类型，并且可以允许上传和存储任何类型的文件。

# javascript - 只允许输入浮点数

> ID：10150877
> 
> 赞同：10
> 
> 时间：2012-04-14T04:00:58.827
> 
> 标签：javascript, jquery

在输入只允许使用 jquery 库的浮点数时，我很痛苦。我的代码无法阻止字符“。” 当它成为第一个输入时，任何人都可以指导我解决这个问题吗？

```
$('.filterme').keypress(function(eve) {
   if (    ( eve.which != 46 || $(this).val().indexOf('.') != -1 ) 
        && ( eve.which <  48 || eve.which > 57 ) 
        || ( $(this).val().indexOf('.') == 0) 
      )
   {
       eve.preventDefault();
   }
});​ 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2015-08-31T21:46:05.493

我用这个 - 适用于键盘输入或复制和粘贴

```
$('input.float').on('input', function() {
  this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<input type="text" class="float" />
```

解释：

*   第一个正则表达式替换任何不是数字或小数的东西。
*   第二个正则表达式删除第二个小数的任何实例。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-14T04:46:43.937

我使用 jQuery Caret 插件过滤第一个位置输入。否则，一旦输入了点，再检查它的位置就太晚了。我尝试检查该点，然后删除该点，但它看起来不太好。

jQuery 插入符号插件： [http ://examplet.buss.hk/js/jquery.caret.min.js](http://examplet.buss.hk/js/jquery.caret.min.js)

我做了什么：

[http://jsfiddle.net/FCWrE/422/](http://jsfiddle.net/FCWrE/422/)

尝试一下 ：）

```
$('.filterme').keypress(function(eve) {
  if ((eve.which != 46 || $(this).val().indexOf('.') != -1) && (eve.which < 48 || eve.which > 57) || (eve.which == 46 && $(this).caret().start == 0)) {
    eve.preventDefault();
  }

  // this part is when left part of number is deleted and leaves a . in the leftmost position. For example, 33.25, then 33 is deleted
  $('.filterme').keyup(function(eve) {
    if ($(this).val().indexOf('.') == 0) {
      $(this).val($(this).val().substring(1));
    }
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/caret/1.0.0/jquery.caret.min.js"></script>
<input type="text" class="filterme">
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-14T04:31:49.663

正则表达式也是我的建议。如果该值作为数字而不是字符串传递，则可以使用 .toString 将其更改为字符串并使用正则表达式对其进行验证。例如：

```
var str = value.toString();
if(!str.match(/^-?[0-9]*[.][0-9]+$/)) {
    alert("Value must be a float number");
    return;
}
return value; 
```

如果传递的值是浮点数，则上述正则表达式将匹配。它接受负数和正数。如果您只想接受正数，只需删除“-？” 从表达式。如果该值只是零“0”而没有任何小数点，它也会失败。如果您想接受零，只需将其作为条件添加到“if”语句中。

您可以使用上述验证和 onchange 事件来防止用户输入非浮点数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T04:09:10.433

为什么不使用`Regular Expression`

```
^[0-9]*[.][0-9]+$ 
```

[在这里阅读代码和测试..](http://www.regular-expressions.info/javascriptexample.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-26T05:57:58.663

您可以使用以下方法，在*onkeypress*事件中调用。下面是 JS 方法后跟的 HTML 片段：

input type="text" **onkeypress** ="return isNumberKey(event)" id="floor"

```
function isNumberKey(evt){
    var charCode = (evt.which) ? evt.which : event.keyCode
    if (charCode == 46){
        var inputValue = $("#floor").val();
        var count = (inputValue.match(/'.'/g) || []).length;
        if(count<1){
            if (inputValue.indexOf('.') < 1){
                return true;
            }
            return false;
        }else{
            return false;
        }
    }
    if (charCode != 46 && charCode > 31 && (charCode < 48 || charCode > 57)){
        return false;
    }
    return true;
} 
```

**注意**：上面的代码还确保您在输入中只输入一个小数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-08T16:09:03.883

这是我的解决方案，也适用于负数（[小提琴](http://jsfiddle.net/dinopasic/a3dw74sz/)）

```
$("input").keypress(function (event) {
    var inputCode = event.which;
    var currentValue = $(this).val();
    if (inputCode > 0 && (inputCode < 48 || inputCode > 57)) {
        if (inputCode == 46) {
            if (getCursorPosition(this) == 0 && currentValue.charAt(0) == '-') return false;
            if (currentValue.match(/[.]/)) return false;
        } 
        else if (inputCode == 45) {
            if (currentValue.charAt(0) == '-') return false;
            if (getCursorPosition(this) != 0) return false;
        } 
        else if (inputCode == 8) return true;
        else return false;

    } 
    else if (inputCode > 0 && (inputCode >= 48 && inputCode <= 57)) {
        if (currentValue.charAt(0) == '-' && getCursorPosition(this) == 0) return false;
    }
});
function getCursorPosition(element) {
    if (element.selectionStart) return element.selectionStart;
    else if (document.selection)
    {
        element.focus();
        var r = document.selection.createRange();
        if (r == null) return 0;

        var re = element.createTextRange(),
            rc = re.duplicate();
        re.moveToBookmark(r.getBookmark());
        rc.setEndPoint('EndToStart', re);
        return rc.text.length;
    }
    return 0;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-25T00:03:45.533

这对我有用：

```
var str = document.getElementById('product_'+id_product).value;
if( !str.match(/^[0-9]*([.,][0-9]+)?$/) ) {
 console.log("Value must be a number or float number");
}else{
 console.log("The number is valid");
} 
```

我希望这可以帮助某人。问候！

# python - 为什么python在windows上这么慢？

> ID：10150881
> 
> 赞同：19
> 
> 时间：2012-04-14T04:01:30.253
> 
> 标签：python, benchmarking

我今天了解了 pystones，所以我决定看看我的各种环境是什么样的。我在裸机上运行 windows 的笔记本电脑上运行了 pystones 并得到了这些结果

```
Python 2.7.2 (default, Jun 12 2011, 15:08:59) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> from test import pystone
>>> for i in range(0,10):
...   pystone.pystones()
...
(1.636334799754252, 30556.094026423627)
(2.1157907919853756, 23631.82607155689)
(2.5324817108003685, 19743.479207278437)
(2.541626695533182, 19672.4405231788)
(2.536022267835051, 19715.915208695682)
(2.540327088340973, 19682.50475676099)
(2.544761766911506, 19648.20465716261)
(2.540296805235016, 19682.739393664764)
(2.533851636391205, 19732.804905346253)
(2.536483186973612, 19712.3325148696) 
```

然后我在我们的一些 linux VM 上运行它，性能提高了 2.7-3.4 倍。所以我在我的笔记本电脑上启动了我的 vmware Linux VM 并重新运行了相同的测试并得到了以下结果：

```
Python 2.7.2+ (default, Oct  4 2011, 20:03:08) 
[GCC 4.6.1] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> for i in range(0,10):
...   pystone.pystones()
... 
(1.75, 28571.428571428572)
(1.17, 42735.042735042734)
(1.6600000000000001, 30120.48192771084)
(1.8399999999999999, 27173.913043478264)
(1.8200000000000003, 27472.52747252747)
(1.8099999999999987, 27624.30939226521)
(1.3099999999999987, 38167.938931297744)
(1.7800000000000011, 28089.88764044942)
(1.8200000000000038, 27472.527472527414)
(1.490000000000002, 33557.04697986573) 
```

我不太明白在同一个窗口中运行的 linux VM 实际上比在 windows 下的同一个裸机上运行的 python 更快。

Windows 上的 python 有什么不同，以至于它在裸操作系统上的执行速度比在同一机器上运行 Linux 的 VM 中执行得慢？

*   更多细节 Windows 平台 Win7x64 32 位 python 在两个平台上运行 32 位 linux VM 在 VMWare 中运行 windows 平台

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2016-10-07T20:31:11.050

在 windows 10 上也有类似的问题 - 这是因为**windows defender**。

我不得不在 Windows Defender 设置中排除 python 目录和进程并重新启动计算机。

之前：我不得不等待大约 20 秒才能运行任何 python 代码——现在是毫秒。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-16T20:11:56.190

我无法回答您的问题，但请考虑以下可能会产生影响的事情：

*   您正在使用不同版本的 Python。“2.7.2+”表示您的 linux Python 是从版本控制检出而不是发行版构建的。

*   它们是用不同的编译器编译的（并且可以想象有不同的优化级别）。

*   你没有提到复制这么多。可以想象，如果你没有，那是侥幸。

*   您的虚拟机可能计时不准确。

*   您正在链接 Python 依赖项的不同实现，尤其是 Ignacio Vazquez-Abrams 指出的 libc。

*   我不知道 pystone 的实际基准是什么样的，但很多事情的工作方式不同——比如 unicode 处理或磁盘 IO 可能是系统相关因素。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-07T10:40:04.517

你在那个 Windows 机器上运行防病毒软件吗？这或许可以解释。我个人喜欢将 Python、Cygwin 和我的源目录添加到防病毒排除列表中——我认为我得到了一个小而明显的加速。也许这解释了你的结果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-04-29T18:20:07.340

对您的启动进行基准测试，但只有一些缓慢的模块需要在 Windows 上进行初始化。一个小技巧，每次启动都可以为我节省一秒钟的时间：

```
import os
import mimetypes #mimetypes gets imported later in dep chain

if __name__ == "__main__":
   # stub this out, so registry db wont ever be read, not needed
   mimetypes._winreg = None 
```

Another source of slowness is, multiple standard library modules compile and cache their regexes at import time. re.compile just looks like its slow on windows

# mysql - MySQL - 试图在长文本字段上获取唯一键

> ID：10150885
> 
> 赞同：2
> 
> 时间：2012-04-14T04:03:20.063
> 
> 标签：mysql

我正在尝试按成员、日期和问题在 MySQL 中添加一个约束，以便同一个用户每天不能多次询问同一个问题。

```
alter table questions add UNIQUE INDEX three_UNIQUE ( member_id , question , date ); 
```

但由于问题字段是长文本，我收到此错误：

```
ERROR 1071 (42000): Specified key was too long; max key length is 1000 bytes 
```

有什么办法可以解决这个问题？

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T04:05:03.290

您可以散列问题，并将散列值存储为字段。由于散列值会小得多，您将能够对其添加约束。很可能，没有两个独特的问题会散列到相同的值。

注意：当问题只有微小差异时，您会遇到同样的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T04:04:53.623

在用户输入的长文本字段上指定唯一键约束通常没有多大意义。用户仍然可以多次询问同一个问题，只需添加一个空格或进行一些其他小的更改。

如果您的目的是防止*意外*转发，请使用带有 GUID 或类似唯一标识符的隐藏字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T04:06:29.623

为哈希（md5 或其他）添加一个新列。当问题被问到时，也填充散列列..然后在索引中使用它而不是问题字段。

# android - RuntimeException：无法实例化应用程序

> ID：10150899
> 
> 赞同：99
> 
> 时间：2012-04-14T04:05:30.353
> 
> 标签：android, android-intent, android-emulator

当我运行我的应用程序时，每次我在我的 logcat 中收到以下异常：

```
 04-14 09:29:53.965: W/dalvikvm(1020): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
    04-14 09:29:53.985: E/AndroidRuntime(1020): FATAL EXCEPTION: main
    04-14 09:29:53.985: E/AndroidRuntime(1020): java.lang.RuntimeException: Unable to instantiate application   android.app.Application: java.lang.NullPointerException
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at android.app.LoadedApk.makeApplication(LoadedApk.java:482)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at android.app.ActivityThread.handleBindApplication(ActivityThread.java:3938)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at android.app.ActivityThread.access$1300(ActivityThread.java:123)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1185)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at android.os.Handler.dispatchMessage(Handler.java:99)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at android.os.Looper.loop(Looper.java:137)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at android.app.ActivityThread.main(ActivityThread.java:4424)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at java.lang.reflect.Method.invokeNative(Native Method)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at java.lang.reflect.Method.invoke(Method.java:511)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at dalvik.system.NativeStart.main(Native Method)
    04-14 09:29:53.985: E/AndroidRuntime(1020): Caused by: java.lang.NullPointerException
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at android.app.LoadedApk.initializeJavaContextClassLoader(LoadedApk.java:362)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at android.app.LoadedApk.getClassLoader(LoadedApk.java:305)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     at android.app.LoadedApk.makeApplication(LoadedApk.java:474)
    04-14 09:29:53.985: E/AndroidRuntime(1020):     ... 11 more 
```

注意：当我从模拟器中卸载应用程序并运行它时，我没有得到这个异常，但是当我在模拟器中重新运行安装的应用程序时，我得到了这个。请帮忙。

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2012-04-14T23:31:44.080

这是当 dalvik 重新安装 .apk 文件并尝试重用或回收同一包中先前打开的活动/视图时（如果您尚未关闭先前安装的应用程序），底层框架引发的详细错误消息。它与您的应用程序无关，此外，您的应用程序不太可能因最终用户设备上的此详细错误消息而冻结或崩溃。

似乎这个 dalvik 详细错误日志只发生在 Android 4.0 系统上，我自己在 Android 3.2 和 2.3.3 运行环境中对其进行了测试，您无法复制以在它们都不显示此消息。[之前已在此处](https://stackoverflow.com/questions/9746116/exception-when-i-run-my-application-from-eclipse)讨论过类似的问题，并且有人在[Android 问题跟踪器](http://code.google.com/p/android/issues/detail?id=25869&can=1&q=LoadedApk.makeApplication&colspec=ID%20Type%20Status%20Owner%20Summary%20Stars)中填写了错误报告。

我认为你现在不用太在意这个冗长的错误日志，如果你在 Logcat 中查看这个红色错误之前和之后的更多日志，你可以看到完整的故事并发现之前打开的活动/视图（其中被标记为死亡状态）被杀死并且新重新安装的最终被弹出。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-07-17T17:44:12.823

我意识到这是一个非常古老的问题，但无论如何这可能很有用。我发现当我在自己的开发中观察到这个错误时，这是​​由于我的应用程序之前运行的实例没有整齐地关闭，例如在退出之前关闭后台线程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-25T20:43:52.903

当我尝试在我的应用程序类中使用 JSOUP 连接到 Internet 时，我遇到了同样的错误。这很棘手，因为应用程序在模拟器上运行，而不是在实际设备上。原来，我只是错误地使用了 JSOUP 库。[在新线程中加载页面](https://stackoverflow.com/questions/8791061/jsoup-connect-working-with-java-not-with-android) 解决了我的问题。

希望我帮助了某人。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-02-18T17:04:39.120

希望这可以帮助某人。单击此按钮转到模拟器上正在运行的应用程序：

[![在此处输入图像描述](../Images/ec2a7aed6eb2e7fe11ab8521690acf04.png)](https://i.stack.imgur.com/TTUBF.png)

[![在此处输入图像描述](../Images/0631f933ea85561b463c1c22d6b35ddf.png)](https://i.stack.imgur.com/aOOOU.png)

关闭您尝试安装的应用程序，然后再次运行它。无需卸载/重新安装应用程序或清理项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-05T15:45:31.553

对我来说，它有助于清理项目。在 Eclipse 中：
- Project --> Clean
Please control that Project --> Build Automatically is CHECKED
如果 gen-Folder 之后为空，则 res-folder 中有错误。通常，res-folder 中的错误不会被红叉显示！祝你好运和问候

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-02-14T07:19:55.840

**简单的解决方案：**

只需**重新启动**您的模拟器或移动设备。问题消失了！此问题的原因是以前的应用程序活动被错误地停止。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-04T10:01:42.527

在我的情况下，在我将 Android Maven 项目导入新工作区后出现此错误，并且 SRC 文件夹未自动添加到构建路径中。

右键单击项目/构建路径/配置构建路径/源 - 检查是否缺少源。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-15T04:58:27.610

我遇到了同样的问题。清理项目对我有用。

选择项目转到项目-> 清理

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-23T13:24:36.973

在我的情况下，logcat 告诉我它找不到初始活动，但 Dex 路径不同，它是“.../data/app/myapp-1”而不是“.../data/app/myapp” . 我解决了这个问题，在 Package explorer 窗口中单击 elcipse 项目名称“myapp”。然后右键单击它，->refactor->rename... 我将项目名称设置为 myapp-1，然后 ->refactor->rename... 并再次返回“myapp”。然后它起作用了...... eclipse中的一些错误？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-17T04:47:33.913

我遇到了同样的问题。卸载我的应用程序然后重新安装它解决了这个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-03-27T06:29:25.573

当我导入由另一台机器构建的项目时，我遇到了这种情况。只是使缓存无效并重新启动

文件>无效缓存/重新启动>无效并重新启动

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-10T18:39:09.087

我在 (Module:app) build.gradle 文件上将 applicationId 更改为不同的内容，然后在我的设备上再次运行该应用程序。然后，我撤消更改并再次运行应用程序，一切正常。它适用于 Android Studio 2.3.1 和我在这里拥有的 4 种不同的设备，从 5.0 到 7.0。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-12-04T08:01:28.313

我遇到了这个问题。使用时`gradle clean`，`gradle installDebug`它工作正常！

```
 AndroidRuntime  D  Shutting down VM
E  FATAL EXCEPTION: main
E  Process: tv.panda.live.broadcast, PID: 4685
E  java.lang.RuntimeException: Unable to instantiate application tv.panda.live.broadcast.PandaApplication: java.lang.ClassNotFoundException: Didn't find class "tv.panda.live.broadcast.PandaApplication" o
   n path: DexPathList[[zip file "/data/app/tv.panda.live.broadcast-1/base.apk"],nativeLibraryDirectories=[/data/app/tv.panda.live.broadcast-1/lib/arm, /vendor/lib, /system/lib]]
E      at android.app.LoadedApk.makeApplication(LoadedApk.java:572)
E      at android.app.ActivityThread.handleBindApplication(ActivityThread.java:4883)
E      at android.app.ActivityThread.access$1500(ActivityThread.java:178)
E      at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1573)
E      at android.os.Handler.dispatchMessage(Handler.java:111)
E      at android.os.Looper.loop(Looper.java:194)
E      at android.app.ActivityThread.main(ActivityThread.java:5691)
E      at java.lang.reflect.Method.invoke(Native Method)
E      at java.lang.reflect.Method.invoke(Method.java:372)
E      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:959)
E      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:754)
E  Caused by: java.lang.ClassNotFoundException: Didn't find class "tv.panda.live.broadcast.PandaApplication" on path: DexPathList[[zip file "/data/app/tv.panda.live.broadcast-1/base.apk"],nativeLibraryDi
   rectories=[/data/app/tv.panda.live.broadcast-1/lib/arm, /vendor/lib, /system/lib]]
E      at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:56)
E      at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
E      at java.lang.ClassLoader.loadClass(ClassLoader.java:469)
E      at android.app.Instrumentation.newApplication(Instrumentation.java:988)
E      at android.app.LoadedApk.makeApplication(LoadedApk.java:567)
E      ... 10 more
E      Suppressed: java.lang.ClassNotFoundException: tv.panda.live.broadcast.PandaApplication
E          at java.lang.Class.classForName(Native Method)
E          at java.lang.BootClassLoader.findClass(ClassLoader.java:781)
E          at java.lang.BootClassLoader.loadClass(ClassLoader.java:841)
E          at java.lang.ClassLoader.loadClass(ClassLoader.java:504)
E          ... 13 more
E      Caused by: java.lang.NoClassDefFoundError: Class not found using the boot class loader; no stack available 
```

# c - 通过终端构建时更改构建输出目录

> ID：10150901
> 
> 赞同：4
> 
> 时间：2012-04-14T04:05:35.643
> 
> 标签：c, macos, build, terminal, output-directory

最近，我发现了一个混合了 IDE 和文本编辑器的程序。它支持语言的语法并进行格式化，但它不会为您构建和运行程序。我正在运行 Mac OS X 10.6.8。我查找了如何使用终端应用程序构建 C 代码。格式为：

```
gcc [file] 
```

很简单。问题是我无法更改构建文件的输出目录，也无法更改名称。默认情况下，每个编译的文件都以“a.out”的名称输出到主目录中。如何指定输出目录和名称？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T04:11:18.917

gcc 可以`-o`选择更改输出名称。您可以在那里指定路径。例如：

```
$ ls
program.c
$ gcc program.c -o program
$ ls
program   program.c
$ mkdir bin
$ gcc program.c -o bin/program
$ ls bin
program
$ 
```

您可能还想了解其他一些常见选项：

*   `-std=c99`, `-std=gnu99`: 使用 c99 标准 / 与 gnu 扩展。
*   `-Wall`, `-Wextra`, `-pedantic`: 启用额外警告。
*   `-O0 -ggdb`: 用调试符号编译。看看怎么用`gdb`。
*   `-O2`：使用独立于处理器的优化进行编译。不兼容`-O0`。

# php - MVC接线；视图和模型

> ID：10150903
> 
> 赞同：3
> 
> 时间：2012-04-14T04:06:24.817
> 
> 标签：php, model-view-controller

根据这个答案，从视图中调用模型似乎是可以的。

[我可以从视图中调用模型吗？](https://stackoverflow.com/questions/1973221/can-i-call-a-model-from-a-view/)

现在我的问题是，接线如何？

控制器会将模型工厂传递给视图吗？（我认为这会破坏这个问题的目的，因为除非我理解错误，否则它必须绕过控制器才能做到这一点）

或者

在视图传递给控制器​​之前，视图是否会在视图的构造函数中注入模型工厂？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T16:19:50.697

乍一看，我认为这没有问题。让我们来看看替代方案：

1.  将原始模型传递到视图中，键入提示通用模型接口

    从表面上看，这似乎没问题。但是，如果您的模型在它们的 api 中不一致（例如`$model->getPerson($id)`，这很可能），这实际上是将控制器模型和视图紧密耦合在一起。

    由于您的视图不能真正接受*任何*模型，因此从控制器注入原始模型可能有点过于自由，并为未来的不一致或奇怪的错误打开了大门。

2.  将原始模型传递到视图中，键入提示所需的模型类

    这解决了先前解决方案的自由度问题，因为只有正确的模型才能通过。但是现在您已将视图进一步耦合到该模型。所以这不好。

3.  在视图中实例化模型。

    这也不是一个理想的解决方案，因为现在您无法模拟您的模型进行测试并且已经将视图完全耦合到模型。明确的 SOLID 违规。

所以这基本上离开了注入模型的工厂。它允许视图确定它需要的模型（因此要求工厂）。它允许模拟模型（通过交换不同的工厂）。它还允许通过调整工厂返回的内容来传递任意模型。

所以现在依赖是松耦合的，而你依赖于一个工厂（这是一个更好的依赖）。

这是我的第一个想法。我需要进一步考虑，看看是否有更清洁的解决方案，但你有它......

# c# - WP7 WCF 底层连接被关闭：连接被意外关闭

> ID：10150907
> 
> 赞同：0
> 
> 时间：2012-04-14T04:07:10.910
> 
> 标签：c#, wcf, windows-phone-7, .net-4.0

由于我无法理解的原因，我开始在我的 WCF 服务中收到此错误：底层连接已关闭：连接意外关闭。

> 服务器堆栈跟踪：在 System.ServiceModel.Channels.HttpChannelUtilities.ProcessGetResponseWebException(WebException webException, HttpWebRequest request, HttpAbortReason abortReason)
> 在 System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply（TimeSpan 超时） 在 System.ServiceModel.Channels.RequestChannel.Request（消息消息，TimeSpan 超时） 在 System.ServiceModel.Dispatcher.RequestChannelBinder.Request（消息消息，TimeSpan超时）在 System.ServiceModel.Channels.ServiceChannel.Call（字符串操作，布尔单向，ProxyOperationRuntime 操作，Object[] 输入，Object[] 输出，TimeSpan 超时）在 System.ServiceModel.Channels.ServiceChannelProxy.InvokeService（IMethodCallMessage methodCall，ProxyOperationRuntime操作）在 System.ServiceModel.Channels.ServiceChannelProxy.Invoke（IMessage 消息）
> 
> 在 [0] 处重新抛出异常：在 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type) 在 IPublicService.GetProduct(字符串条形码）
> 在 PublicServiceClient.GetProduct（字符串条形码）
> 
> 内部异常：基础连接已关闭：连接意外关闭。在 System.Net.HttpWebRequest.GetResponse() 在 System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply（时间跨度超时）

下面是服务方法：

```
public Product GetProduct(string barcode)
        {
            DataContext Db = new DataContext();
            var p = Db.Products.Find(barcode);
            if (p == null)
                return null;

            return new Product()
            {
                ProductID = p.ProductID,
                Name = p.Name,
                Nutrition = p.Nutrition,
                Allergen = p.Allergen,
                Image = p.Image,
                ManufacturerID = p.ManufacturerID,
                ReviewIDs = p.ReviewIDs
            };
        } 
```

这是产品数据合同：

```
[DataContract]
    public class Product
    {
        [Key]
        [Required]
        [DataMember]
        public string ProductID { get; set; }

        [Required]
        [DataMember]
        public string Name { get; set; }

        [Required]
        [DataMember]
        public string Nutrition { get; set; }

        [Required]
        [DataMember]
        public string Allergen { get; set; }

        [Required]
        [DataMember]
        public string Image { get; set; }

        [Required]
        [DataMember]
        public virtual Manufacturer ManufacturerID { get; set; }

        [DataMember]
        public virtual ICollection<Review> ReviewIDs { get; set; }
    } 
```

但是，如果我将服务方法更改为：

```
public Product GetProduct(string barcode)
        {
            DataContext Db = new DataContext();
            var p = Db.Products.Find(barcode);
            if (p == null)
                return null;

            //return new Product()
            //{
            //    ProductID = p.ProductID,
            //    Name = p.Name,
            //    Nutrition = p.Nutrition,
            //    Allergen = p.Allergen,
            //    Image = p.Image,
            //    ManufacturerID = p.ManufacturerID,
            //    ReviewIDs = p.ReviewIDs
            //};
            return new Product();
        } 
```

没有抛出异常，它返回并清空产品，所以我不确定是什么导致了我得到的模棱两可的异常，任何人都可以阐明这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T06:04:22.293

不幸的是，WCF 异常并不总是很有帮助，但您可能会遇到一些内置的 WCF 限制（这些限制是可调的）。默认[`MaxReceivedMessageSize`](http://msdn.microsoft.com/en-us/library/ms731078.aspx)为 64kb，我认为默认的最大字符串长度为 8kb。尝试增加这些限制应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T06:22:45.020

一般来说，你应该使用微软提供的[Svctraceviewer.exe来调试 WCF pluming。](http://msdn.microsoft.com/en-us/library/ms732023.aspx)您应该在服务端运行跟踪。

# actionscript-3 - 无法导入 qnx.fuse

> ID：10150909
> 
> 赞同：0
> 
> 时间：2012-04-14T04:07:31.180
> 
> 标签：actionscript-3, flash-builder, blackberry-playbook

我正在使用 Adob​​e Flash Builder 为 PlayBook 创建一个 BlackBerry 应用程序。为此，我需要导入`qnx.fuse.*`，它会显示一条错误消息，告诉**The import fuse could not be found**。但我可以导入其他一些 BlackBerry 组件。例如，我有以下导入：

```
import qnx.dialog.DialogButtonProperty;
import qnx.dialog.PromptDialog;
import qnx.display.IowWindow;
import qnx.fuse.ui.buttons.LabelButton;
import qnx.fuse.ui.text.Label; 
```

但是，只有最后两个导入显示错误。这是为什么？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T04:38:14.000

What Blackberry Playbook sdk version for air you have installed.

```
import qnx.fuse.ui.buttons.LabelButton;
import qnx.fuse.ui.text.Label; 
```

These imports can be used if you are using Flashbuilder 4.6 & Air version 3.1 , below it will not supported.

```
https://developer.blackberry.com/air/apis/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T16:25:40.453

新的 Fuse 组件是在 Playbook 中用于 AIR 开发的正确组件。

API 记录在[https://bdsc.webapps.blackberry.com/air/api](https://bdsc.webapps.blackberry.com/air/api)

也许你不能**导入 qnx.fuse.*;** 因为该文件夹中没有类，它只包含其他子文件夹。没关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T18:56:07.603

您需要做两件事才能访问这些类。

*   [从 qnx 添加原生扩展 QNXSkins](http://developer.blackberry.com/air/documentation/bb10/add_ane_fb.html)
*   将 quxui.swf 添加到您的库路径（属性->构建路径->库路径）。该文件位于 /Application/ResearchInMotion/blackberry-tablet-sdk-3.1.0/frameworks/libs/qnx（在 Mac 上）。

# html - 缩放整个站点

> ID：10150912
> 
> 赞同：0
> 
> 时间：2012-04-14T04:08:05.760
> 
> 标签：html, css

我本质上希望能够将整个站点（图像、元素、整个 sha-bang）缩放到用户正在使用的任何浏览器大小的窗口。任何人都成功地做到了这一点，并愿意分享如何？

顺便说一句，我正在使用 HTML 5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T08:42:55.763

您需要开始考虑使用百分比而不是像素来调整元素的大小。

看看这个简单的例子，它可能会对你有所帮助。祝你好运。

[http://jsfiddle.net/hACbn/1/](http://jsfiddle.net/hACbn/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T12:53:09.117

看看使用响应式布局：

这是一个半体面的框架，可以帮助您入门

[http://gridpak.com/](http://gridpak.com/)

# python - 是否可以将两个高阶函数的返回值分配给 Python 中的同一个变量？[查看详细信息]

> ID：10150913
> 
> 赞同：1
> 
> 时间：2012-04-14T04:08:22.000
> 
> 标签：python, higher-order-functions

[http://pythonprogramming.jottit.com/functional_programming](http://pythonprogramming.jottit.com/functional_programming)有一个教程，它给出了一个如何使用高阶函数返回函数的示例：

```
def trace(f):
    f.indent = 0
    def g(x):
        print '|  ' * f.indent + '|--', f.__name__, x
        f.indent += 1
        value = f(x)
        print '|  ' * f.indent + '|--', 'return', repr(value)
        f.indent -= 1
        return value
    return g 
```

和

```
def memoize(f):
    cache = {}
    def g(x):
        if x not in cache:
            cache[x] = f(x)
        return cache[x]
    return g 
```

但我不明白它是如何在语句的同一个变量上分配两个函数的：

```
fib = trace(fib)
fib = memoize(fib)
print fib(4) 
```

trace 和 memoize 似乎都对最后一次通话有影响。这是为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T04:24:24.090

你写的很相似

```
fib2 = memoize(trace(fib))
print fib2(4) 
```

因为您`fib`在调用 后更改了变量指向的函数`trace`，所以`memoize`应用于跟踪版本（然后`fib`再次“覆盖”）。

如果你想分别有一个跟踪版本和一个记忆版本，你需要将它们的结果分配给不同的变量，例如：

```
fib_trace = trace(fib)
fib_memo = memoize(fib)
print fib_trace(4), fib_memo(4) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T04:17:22.067

这与以下没有什么不同：

```
a = a + 2
a = a + 5
print a 
```

正如`a`will 增加 7 一样，`fib`将同时应用两个装饰器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T04:23:43.647

两者都`trace()`创建`memoize()`一个新的函数对象并将其返回给您。

在每种情况下，新函数对象都会“包装”旧函数对象，因此原始函数不会丢失。

使用我惊人的 ASCII 艺术技巧，这是一个图表：

```
f(x)   # this is your original function

trace(f(x))   # trace "wraps" it and returns a wrapped object

memoize(trace(f(x)))   # memoize "wraps" it and returns a new wrapped function object 
```

我们从绑定到 name 的函数对象开始`fib`。

然后我们调用`trace(fib)`which 创建一个新的函数对象。当它第一次被创建时，它的名字是，`g`但是我们将它绑定到名字`fib`上。尝试打印`fib.__name__`。

然后我们调用`memoize(fib)`which 创建一个新的函数对象。同样，它首先使用名称创建，`g`但随后绑定到名称`fib`。

请记住，在 Python 中，一切都是对象，对象可以没有名称、一个名称或多个名称而存在。在这种情况下，我们不断重复使用名称`fib`，但我们不断将其与不同的函数对象重新绑定。

# eclipse - Eclipse Indigo 的 Struts 插件

> ID：10150916
> 
> 赞同：0
> 
> 时间：2012-04-14T04:08:51.427
> 
> 标签：eclipse, eclipse-plugin, struts

我正在为 Eclipse Indigo 寻找一个 Struts 1.x 插件。我在网上看过，但似乎找不到任何易于设置的东西。到目前为止，我一直在使用 NetBeans，它对 struts 有很好的支持，比如自动更新 struts-config.xml 文件。

我不是在寻找基于 GUI 的插件，只是在寻找我需要在 struts-config.xml、web.xml（如 taglib 导入等）中手动执行的操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T09:32:25.823

[AmaterasIDE](http://marketplace.eclipse.org/content/amateraside)包含的 StrutsIDE 可能正是您正在寻找的...

# java - 使用 BASE64 编码器对包含原始字符的字符串进行编码

> ID：10150918
> 
> 赞同：0
> 
> 时间：2012-04-14T04:09:18.430
> 
> 标签：java, base64

因此，我要发送的字符串包含`#`在服务器中，仅接收到字符串 upto `#`。我应该如何在客户端使用 BASE64Encoder 对字符串进行编码。请记住，我有一个包含`#`. 以及如何在服务器中对其进行解码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T04:27:42.280

为此目的使用`URLEncoder`和分类。`URLDecoder`

```
String urlParam = URLEncoder.encode(param); 
```

……

```
String param = URLDecoder.decode(urlParam); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T04:17:34.017

看起来您在查询字符串中传递了非 url 编码的参数。您不需要 Base64，只需 url-encode。

请参阅[Java 中的 HTTP URL 地址编码](https://stackoverflow.com/questions/724043/http-url-address-encoding-in-java)：

```
URI uri = new URI( 
        "http",  
        "www.google.com",  
        "/ig/api", 
        "weather=São Paulo#123", 
        null); 
String request = uri.toASCIIString(); 
```

# database - 使用 Clojure/ClojureScript 进行 Web 开发的后端

> ID：10150919
> 
> 赞同：6
> 
> 时间：2012-04-14T04:09:26.173
> 
> 标签：database, clojure, clojurescript

我熟悉在 Clojure 中开发桌面应用程序（编写了一个多线程交互式可视化系统）。但是，我对使用 Clojure 进行 Web 开发还很陌生。

我打算在服务器上使用 Clojure 来处理逻辑；和 ClojureScript 用于处理客户端工作。但是，我不知道为我的数据库服务器使用什么。我应该使用 Monogodb 之类的东西吗？还是Hadoop？或者 .... ？

该应用程序非常简单；一个基本的论坛。在给定时间，并发用户总数将小于 100。对我来说重要的一件事是轻松备份/数据一致性的能力——对我来说非常重要的是我可以轻松地进行日常备份（并且不会丢失所有数据。）

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T05:17:35.610

您可以使用许多数据库；如果数据库有用于 Java 的 API，那么你应该很高兴。[MySQL](https://stackoverflow.com/questions/613929/how-do-i-connect-to-a-mysql-database-from-clojure)、[MongoDB](https://github.com/aboekhoff/congomongo)、[Postgres](http://en.wikibooks.org/wiki/Clojure_Programming/Examples/JDBC_Examples#PostgreSQL)、[Hadoop](http://alexott.net/en/clojure/ClojureHadoop.html) ……等等。

如需对 Clojure 中的 webstack 有一个很好的概述，请查看 brehaut[关于此事的文章](http://brehaut.net/blog/2011/ring_introduction)。

要快速启动和运行 Clojure 和 ClojureScript，请尝试[ClojureScriptOne](http://clojurescriptone.com/)。

有很多方法可以写出你想写的东西；如果您已经熟悉 Clojure，那么上手应该不会太难。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-22T03:48:49.367

我自己没有使用过它，但 Datomic ( [http://datomic.com/](http://datomic.com/) ) 对于来自 Clojure 的任何人来说看起来都很棒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-28T20:39:26.207

Datomic 是一个了不起的数据库，我强烈推荐它。它具有许多与其他数据库系统不同的特性：

*   和 Clojure 的数据结构一样，它是持久化的，这意味着默认情况下，向数据库添加新事实不会删除旧事实，允许您查询数据库在之前时间点的状态，增强审计能力和辅助调试.
*   底层实体属性值（EAV/三元组）数据模型（至少部分受到 RDF 和语义网的启发）非常灵活，允许您表达任意图形结构并轻松处理多态性。
*   查询语言是 Datalog 的风格，是一种基于模式匹配的查询语言，比 SQL 等更具表现力，因为它可以进行递归查询，使其特别适合处理图形数据/查询。
*   除了 Datalog 查询之外，还有一个`pull`api，它让您可以更简单地使用类似 GraphQL 的表达式从数据库中提取数据，该表达式指定您希望从数据库中提取的类文档结构的形状。这些查询甚至可以在`:find`Datalog 查询的子句中使用。
*   您可以在查询中使用 Clojure 函数。
*   索引系统非常智能并且或多或少是自动的，这与通常用于调整 SQL 数据库以提高性能的工作形成鲜明对比。
*   事务通过与查询不同的 API/函数调用，这意味着 OWASP（SQL 注入）确定的第一大安全风险在 Datomic 中实际上是不可能的。
*   Transactor/read-replica 设计使得扩展读取/查询变得超级容易，同时保持对 transactor 的压力。
*   这很有趣。

这里值得指出的一件事是，通过采用 EAV 数据模型和数据记录/拉取查询，Datomic 最终具有更接近 NoSQL 数据库的结构灵活性，同时仍然从根本上是关系的，并且在它的关系查询中更具表现力比 SQL。

这太棒了，你绝对应该试一试。它会让你的大脑融化一点。以好的方式。

还值得注意的是，它的受欢迎程度激发了许多成功的开源项目，因此底层方法不会很快出现在任何地方：

*   DataScript：在内存中 clj/cljs 部分实现
*   Datahike：DataScript 的分支，它在磁盘索引上进行查询，这意味着您不必将所有内容都保存在内存中进行查询
*   Mentat：Mozilla 项目试图为 Mozilla 项目制作 Datomic-alike

# java - Java中标签和单选组之间不需要的线

> ID：10150922
> 
> 赞同：1
> 
> 时间：2012-04-14T04:10:58.587
> 
> 标签：java, swing, radio-button, label

在我的项目中，我使用 Swing 控件。我曾将标签与按钮组一起使用，但有一条不需要的线。请帮忙。每个单选按钮组都有一个标签。不需要的行在那里。如何将标签和相应的单选按钮组添加到同一面板

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
//import java.util.Arrays;

public class Online extends JFrame {

    static JRadioButton[] choice = new JRadioButton[6];
    JFrame jtfMainFrame, jtfMainFrame1;

    public void createWindow() {

        jtfMainFrame = new JFrame("Online Examination");
        jtfMainFrame.setSize(800, 500);
        jtfMainFrame.setLocation(200, 150);
        jtfMainFrame.addWindowListener(new WindowAdapter() {

            @Override
            public void windowClosing(WindowEvent e) {
                System.exit(0);
            }
        });
        JPanel pa = new JPanel();

        JPanel panlabels = new JPanel(new GridLayout(0, 1, 0, 60));

        JPanel pancontrols = new JPanel(new GridLayout(0, 1, 0, 60));
        JPanel panEast = new JPanel();

        JPanel pan = new JPanel(new FlowLayout());
        JLabel qLabel = new JLabel("Question.");
        qLabel.setOpaque(true);
        qLabel.setForeground(Color.blue);
        qLabel.setBackground(Color.lightGray);

        JLabel aLabel = new JLabel("Question.");
        aLabel.setOpaque(true);
        aLabel.setForeground(Color.blue);
        aLabel.setBackground(Color.lightGray);

        JLabel bLabel = new JLabel("a.");
        bLabel.setOpaque(true);
        bLabel.setForeground(Color.blue);
        bLabel.setBackground(Color.lightGray);

        JLabel cLabel = new JLabel("b.");
        cLabel.setOpaque(true);
        cLabel.setForeground(Color.blue);
        cLabel.setBackground(Color.lightGray);

        JLabel dLabel = new JLabel("c.");
        dLabel.setOpaque(true);
        dLabel.setForeground(Color.blue);
        dLabel.setBackground(Color.lightGray);

        JLabel eLabel = new JLabel("d.");
        eLabel.setOpaque(true);
        eLabel.setForeground(Color.blue);
        eLabel.setBackground(Color.lightGray);

        panlabels.add(aLabel, BorderLayout.WEST);
        panlabels.add(bLabel, BorderLayout.CENTER);
        panlabels.add(cLabel, BorderLayout.CENTER);
        panlabels.add(dLabel, BorderLayout.CENTER);
        panlabels.add(eLabel, BorderLayout.CENTER);
        //panlabels.add(fLabel, BorderLayout.WEST);
        //fLabel.setVisible(false);

        JLabel ques = new JLabel("q");
        ques.setBackground(Color.red);

        choice[1] = new JRadioButton("a");
        choice[1].setBackground(Color.red);

        choice[2] = new JRadioButton("b");
        choice[2].setBackground(Color.red);

        choice[3] = new JRadioButton("c");
        choice[3].setBackground(Color.red);

        choice[4] = new JRadioButton("d");
        choice[4].setBackground(Color.red);

        ButtonGroup bGroup = new ButtonGroup();
        pancontrols.add(ques, BorderLayout.WEST);
        for (int i = 1; i < 5; i++) {
            // pancontrols.add(aLabel,BorderLayout.WEST);
            bGroup.add(choice[i]);

            pancontrols.add(choice[i], BorderLayout.WEST);
        }
        choice[4].setVisible(true);
         panEast.add("West", panlabels);
        panEast.add("West", pancontrols);
        pa.add("Center", panEast);
        pa.setBorder(BorderFactory.createTitledBorder(
            BorderFactory.createEtchedBorder(), "Select your answer"));

        //getContentPane().add(label);
        //to be deleted pa.add("South", pan);
        pa.setBackground(Color.pink);
        jtfMainFrame.add(pa);
        jtfMainFrame.setExtendedState(Frame.MAXIMIZED_BOTH);

        jtfMainFrame.setVisible(true);
    }

    public static void main(String[] args) {
        Online r = new Online();
        r.createWindow();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:05:33.857

首先，您对选项标签的命名约定已关闭。qLabel="questions"、aLabel="questions"、bLabel="a"、cLabel="b" 等。我建议您修复它以消除混淆并使您的代码更具可读性（即只有一个标签是问题）。

`panEast.add("West",panlabels);`其次，一般不建议您使用and 其他两个语句。继续阅读`BorderLayout`以找到更可接受的方法：http: [//docs.oracle.com/javase/tutorial/uiswing/layout/border.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/border.html)

至于您的问题，我已经重写了您的代码，所以事情确实排成一列，我将尝试指出我注释掉的内容以提供帮助：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
//import java.util.Arrays;

public class Online extends JFrame {

    static JRadioButton[] choice = new JRadioButton[6];
    JFrame jtfMainFrame, jtfMainFrame1;

    public void createWindow() {

        jtfMainFrame = new JFrame("Online Examination");
    jtfMainFrame.setSize(800, 500);
    jtfMainFrame.setLocation(200, 150);
    jtfMainFrame.addWindowListener(new WindowAdapter() {

        @Override
        public void windowClosing(WindowEvent e) {
            System.exit(0);
        }
    });
    JPanel pa = new JPanel();

    //JPanel panlabels = new JPanel(new GridLayout(0, 1, 0, 60));

    JPanel pancontrols = new JPanel(new GridLayout(0, 2, 0, 60));
    JPanel panEast = new JPanel();

    JPanel pan = new JPanel(new BorderLayout());
    JLabel qLabel = new JLabel("Question.");
    qLabel.setOpaque(true);
    qLabel.setForeground(Color.blue);
    qLabel.setBackground(Color.lightGray);

    JLabel aLabel = new JLabel("Question.");
    aLabel.setOpaque(true);
    aLabel.setForeground(Color.blue);
    aLabel.setBackground(Color.lightGray);

    JLabel bLabel = new JLabel("a.");
    bLabel.setOpaque(true);
    bLabel.setForeground(Color.blue);
    bLabel.setBackground(Color.lightGray);

    JLabel cLabel = new JLabel("b.");
    cLabel.setOpaque(true);
    cLabel.setForeground(Color.blue);
    cLabel.setBackground(Color.lightGray);

    JLabel dLabel = new JLabel("c.");
    dLabel.setOpaque(true);
    dLabel.setForeground(Color.blue);
    dLabel.setBackground(Color.lightGray);

    JLabel eLabel = new JLabel("d.");
    eLabel.setOpaque(true);
    eLabel.setForeground(Color.blue);
    eLabel.setBackground(Color.lightGray);

    //panlabels.add(fLabel, BorderLayout.WEST);
    //fLabel.setVisible(false);

    JLabel ques = new JLabel("q");
    ques.setBackground(Color.red);

    choice[1] = new JRadioButton("a");
    choice[1].setBackground(Color.red);

    choice[2] = new JRadioButton("b");
    choice[2].setBackground(Color.red);

    choice[3] = new JRadioButton("c");
    choice[3].setBackground(Color.red);

    choice[4] = new JRadioButton("d");
    choice[4].setBackground(Color.red);

    ButtonGroup bGroup = new ButtonGroup();
    //pancontrols.add(new JLabel(""));
    pancontrols.add(ques, BorderLayout.WEST);
    for (int i = 1; i < 5; i++) {
        // pancontrols.add(aLabel,BorderLayout.WEST);
        bGroup.add(choice[i]);

    }

    pancontrols.add(qLabel);
    pancontrols.add(ques);

    pancontrols.add(bLabel);
    pancontrols.add(choice[1]);
    pancontrols.add(cLabel);
    pancontrols.add(choice[2]);
    pancontrols.add(dLabel);
    pancontrols.add(choice[3]);
    pancontrols.add(eLabel);
    pancontrols.add(choice[4]);
    pancontrols.setSize(400,200);
    choice[4].setVisible(true);
    pa.add(pancontrols);
    pa.setBorder(BorderFactory.createTitledBorder(
        BorderFactory.createEtchedBorder(), "Select your answer"));

    //getContentPane().add(label);
    //to be deleted pa.add("South", pan);
        pa.setBackground(Color.pink);
        jtfMainFrame.add(pa);
        jtfMainFrame.setExtendedState(Frame.MAXIMIZED_BOTH);

        jtfMainFrame.setVisible(true);
    }

    public static void main(String[] args) {
        Online r = new Online();
        r.createWindow();
    }
} 
```

基本上，我删除了你不必要的面板。您现在添加的唯一面板是 pancontrols 面板。我把它改成了`new JPanel(new Gridlayout(0,2,0,60))`. 使用两列，由于使所有内容都具有相同的大小`GridLayout`，因此您将始终将事物排成一列。`GridLayout`

最后，我`choices[]`从循环中提取了添加内容，并与标签一起执行以确保内容对齐。除了添加到的 pancontrols 之外，我删除了所有添加的面板`pa`，我假设您想在这种情况下向 pa 添加更多问题面板。这尤其涵盖了您的问题，但是您应该做很多事情（例如，使用选择[0]，消除未使用的标签和面板等）

# python - 使用数学函数遍历字典

> ID：10150926
> 
> 赞同：3
> 
> 时间：2012-04-14T04:11:37.653
> 
> 标签：python

我有这本字典，其中（key1，key2）：值

```
dict = {('1', '4'): 'A', ('3', '8'): 'B', ('4', '7'): 'C', 
('8', '9'): 'D', ('4', '2'): 'E', ('2', '0'): 'F', ('3', '9'): 
'G', ('7', '7'): 'H', ('8', '6'): 'I', ('5', '3'): 'J', 
('6', '1'): 'K'}

key1 = input('enter value of key1: ')
key2 = input('enter value of key2: ') 
```

如果我输入一对key1，key2并且这对不存在，有什么方法可以循环遍历这个字典并传递一个数学函数，即找到每对键的平均值并打印具有最大平均值？

编辑：实际上这个字典是从一个文本文件派生的，所以它必须首先在字符串中，我需要将它转换为 int 但我不知道如何。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T04:19:13.757

不要调用它`dict`，这会阻止您访问内置的`dict`.

您的键是`str`ings，因此没有平均值。如果我们转换为`int`s：

```
dct = dict((tuple(map(int, key)), value) for key, value in str_dict.iteritems()) 
```

这使：

```
dct = {(8, 9): 'D', (4, 7): 'C', (6, 1): 'K', (7, 7): 'H', 
       (1, 4): 'A', (3, 8): 'B', (2, 0): 'F', (3, 9): 'G', 
       (4, 2): 'E', (8, 6): 'I', (5, 3): 'J'} 
```

然后您可以[`max`](http://docs.python.org/library/functions.html#max)在[`sum`](http://docs.python.org/library/functions.html#sum)每个键上使用：

```
key = max(d, key=sum)
# (8, 9) is the key with the highest average value 
```

因为最高的`sum`也有最高的平均值。

如果你想要那个键的值，它是：

```
value = dct[key]
# 'D' is the value for (8, 9) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T04:25:05.773

```
# Use NumPy. It seems this will help if you'll be needing argmin type functions.
# This is BY NO MEANS the only way to do it in Python, but it is a good way to
# know nonetheless.
import numpy as np

my_dict = {('1', '4'): 'A', ('3', '8'): 'B', ('4', '7'): 'C', 
('8', '9'): 'D', ('4', '2'): 'E', ('2', '0'): 'F', ('3', '9'): 
'G', ('7', '7'): 'H', ('8', '6'): 'I', ('5', '3'): 'J', 
('6', '1'): 'K'}

# Get the keys
dict_keys = my_dict.keys()

# Get the average value of each key pair.
averages_for_keys = np.array([np.mean(elem) for elem in dict_keys])

# Get the index and the key pair of the largest average.
largest_average_key = dict_keys[averages_for_keys.argmax()]

# Get user input
key1 = input('enter value of key1: ')
key2 = input('enter value of key2: ')

# If not in dict_keys, print for largest average key pair.
if (key1, key2) not in dict_keys:
    print "Invalid input key pair. Proceeding with largest average."
    print my_dict[largest_average_key]

###
# An alternative to index on the closest key by Euclidean distance.
# This can be adjusted for other distances as well.
###
if (key1, key2) not in dict_keys:
    print "Didn't find key pair in dict."
    print "Proceeding with keypair of minimal distance to input."

    dists = np.array([sqrt((elem[0]-key1)**2.0 + (elem[1]-key2)**2.0) for elem in dict_keys])
    min_index = dists.argmin()
    closest_key = dict_keys[min_index]

print my_dict[closest_key] 
```

# java - Java：验证输入是否为某个数字

> ID：10150928
> 
> 赞同：0
> 
> 时间：2012-04-14T04:11:44.703
> 
> 标签：java

一个驱动类、输入输出类和 numberValidator 类。用户将使用 j-option 窗格弹出框输入数字 1-8，如果输入的不是 1-8，则应该显示错误消息。如果数字是 1-8，则其余代码（此处未写）应该继续运行。我收到错误，有人看到我错在哪里了吗？

```
///Driver class (excludes package)////

public class Driver {
    public static void main(String[] args) {
       InputOutput inputoutput = new InputOutput();

       inputoutput.displayMenu();
    }
}

///InputOutput class (excludes package and import for JOptionPane)///
public class InputOutput {
    public int displayMenu()
    {

        String stringChoice = JOptionPane.showInputDialog("Restaurant:\n"
                + "1\. Pancakes: $10.00\n"
                + "2\. Bananas: $1.00\n"
                + "3\. Bread: $2.00\n");
        if (numberValidator.isNumeric(stringChoice)){
            choiceNumber = Integer.parseInt(stringChoice);   
        }
        return choiceNumber;
    }

///numberValidator class code (excludes package)///
public class numberValidator {
    public boolean isNumeric(String str)
   {
        boolean valid = true;
        String regex = "[1-8/.]*";
    valid = str.matches(regex);
    return valid;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T04:19:42.253

可能您的意思是：`String regex = "[1-8]\."`- 即间隔 1-8 中的单个数字后跟一个点？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T04:21:18.307

您可以将您的正则表达式简化为`String regex = "[1-8]";`.

这意味着您的正则表达式只能接受 1 到 8 之间的数字。

问候。

编辑 ：

对于您的错误：

您从未初始化`numberValidator`，因此编译器看到您想要在没有 numberValidator 实例的情况下访问 isNumeric 方法，并看到方法 isNumeric 没有关键字 static。这就是为什么它告诉你消息错误。

像这样更改您的 if 语句可以解决您的问题：

```
if ( new numberValidator().isNumeric(stringChoice)) 
```

或使您的方法`isNumeric()`静态。

顺便说一句：类名的第一个字符必须大写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T04:29:33.103

你得到什么错误？仅仅是不管用户选择什么，它都会继续运行吗？在下面的代码中，我添加了一个如果选择的值不是数字`else`，它将重新运行该方法。`displayMenu()`

```
public class InputOutput {
    public int displayMenu()
    {

        String stringChoice = JOptionPane.showInputDialog("Restaurant:\n"
                + "1\. Pancakes: $10.00\n"
                + "2\. Bananas: $1.00\n"
                + "3\. Bread: $2.00\n");
        if (numberValidator.isNumeric(stringChoice)){
            choiceNumber = Integer.parseInt(stringChoice);   
        }
        else {
            return displayMenu();
            }
        return choiceNumber;
    } 
```

但是对于您的问题，使用选项下拉列表会更好吗？...

```
String[] options = new String[]{"Pancakes: $10.00","Bananas: $1.00","Bread: $2.00"}

int chosenIndex = JOptionPane.showOptionDialog(null, "Choose a menu item", "Menu", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, null, options, options[0]);

String chosenValue = options[chosenIndex]; 
```

# java - 小程序中的 java.security.AccessControlException

> ID：10150930
> 
> 赞同：1
> 
> 时间：2012-04-14T04:12:32.933
> 
> 标签：java, exception, applet, appletviewer

在我的 Applet 中，它需要从其他站点下载 csv 文件才能运行。

当我用 appletviewer 运行小程序时，它给了我这个异常：

```
java.security.AccessControlException: access denied (java.net.SocketPermision www.xxxsitexxx.com:80 connect, resolve
   .... 
```

我的小程序已签名：

```
 jarsigner -verify myfile.jar >> the result :  jar verified. 
```

我试图添加：

```
grant {
      permission java.security.AllPermission;
    }; 
```

进入Tomcat的文件夹：

```
..conf/catalina.policy 
```

但它没有用。

谷歌建议我添加安全许可：

```
... jre/lib/security/java.policy 
```

但我无法改变它：

```
Access to ... jre/lib/security/java.policy was denied. 
```

我的问题是：

1.  向 java.policy 添加权限是否可以解决问题？
2.  如果是这样，我该如何更改 java.policy 的内容？

PS：我在这里阅读了许多与我在 Stackoverflow 中的问题有关的问题，但我找不到解决问题的正确方法。

```
EDIT : i got the Applet work by signing all jar files that needed to run with the Applet. 
```

# html - Rails 3：在视图中转义字符串但不是全部

> ID：10150932
> 
> 赞同：0
> 
> 时间：2012-04-14T04:13:37.110
> 
> 标签：html, ruby-on-rails-3, view, escaping

在视图中，字符串默认被转义。

```
mystring = "A&B: <b>some string here</b>" 
<%=mystring%> 
```

`mystring`呈现为：

```
A&amp;B: &lt;b&gt;some string here&lt;/b&gt; 
```

但是，我需要`<b></b>`渲染标签并转义 & 符号。

```
A&amp;B: <b>some string here</b> 
```

`html_safe`取消转义 & 和`<b>`标签。有没有办法转义特殊字符，如＆符号而不是 html 标签？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T04:41:31.820

您可以使用 Ruby 的 CGI::unescapeElement 方法对特定元素进行转义。在您的情况下，您需要使用以下内容：

```
mystring = CGI::escape_html("A&B: <b>some string here</b>")

# You can replace ["B"] with an array of tags to be escaped, i.e. ["B", "A", "IMG"]
mystring = CGI::unescapeElement(mystring, ["B"]) 

<%= mystring.html_safe %> 
```

有关更多转义方法，请参见[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/cgi/rdoc/CGI.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/cgi/rdoc/CGI.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T04:22:41.493

您可以在部分上拆分字符串，然后取消转义一些您想要的

# javascript - 数组等于两个不同的值并动态更改变量

> ID：10150937
> 
> 赞同：0
> 
> 时间：2012-04-14T04:15:44.040
> 
> 标签：javascript, arrays, variables, equals

我希望用户键入一个 ID 号。当用户单击一个按钮时，代码将查找一个包含所有 id 编号列表的数组，以检查它是否存在。然后它将检查该 ID 号的价格。根据价格和查找的 ID 号，我希望它动态更改名为“成本”的变量。例如，用户键入数字“5555” 代码查找 ID 5555 是否存在，如果存在，则检查该 ID 的价格。基于这个价格，我希望它改变一个叫做成本的变量。同样，如果我查找“1234”的 id。它会查找 id（如果存在），获取价格，然后更改名为 cost 的变量。

我什至不知道从哪里开始。我正在考虑使用数组来映射 id 编号和价格，但我不知道这是否可行。我希望一个数字本质上等于另一个数字，然后根据第二个数字更改一个变量，我想不出该怎么做。

```
id[0] = new Array(2)
id[1] = "5555";
id[2] = "6789";
price = new Array(2)
price[0] = 45;
price[1] = 18; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T04:27:16.943

您可以将对象用作字典之类的对象。

```
// Default val for cost
var cost = -1;

// Create your dictionary (key/value pairs)
// "key": value (e.g. The key "5555" maps to the value '45')
var list = {
    "5555": 45,
    "6789": 18
};

// jQuery click event wiring (not relevant to the question)
$("#yourButton").click(function() {
    // Get the value of the input field with the id 'yourInput' (this is done with jQuery)
    var input = $("#yourInput").val();

    // If the list has a key that matches what the user typed,
    // set `cost` to its value, otherwise, set it to negative one.
    // This is shorthand syntax. See below for its equivalent
    cost = list[input] || -1;

    // Above is equivalent to
    /*
    if (list[input])
        cost = list[input];
    else
        cost = -1;
    */

    // Log the value of cost to the console
    console.log(cost);
}); 
```

# bash - 在 Bash 脚本中的用户命令中格式化 Expect 脚本

> ID：10150939
> 
> 赞同：1
> 
> 时间：2012-04-14T04:15:45.497
> 
> 标签：bash, shell, scripting, expect

所以我有 NVIDIA 的 CUDA API 的三个安装程序——第一个是一个驱动程序，带有很好的静默安装标志选项（但你必须是 root 并且必须有运行级别 3）。

下面显示了下面的后两个手动安装（为简洁起见，省略了之后安装的冗长混乱）

> [root]# sh cudatoolkit_4.1.28_linux_64_rhel5.x.run 验证存档完整性...一切都很好。解压缩 NVIDIA CUDA................................................................. ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ………………………………………………………………………………………………………………………………………………
> Enter install path (default /usr/local/cuda, '/cuda' will be appended):
> A previous version of CUDA was found in /usr/local/cuda/bin
> 你想卸载吗？（是/否/中止）：是

换句话说，我需要识别：“输入安装路径”并输出一个 '\n'

现在棘手的部分是卸载可能并不总是存在。如果不是，我只需等待安装完成，但如果我看到“你想卸载吗？” 我需要输出“是”才能完成。

第三个也是最后一个安装程序的输出如下所示....

> [root]# sh gpucomputingsdk_4.1.28_linux.run
> 验证存档完整性...一切都好。
> 解压缩 NVIDIA GPU 计算
> 
> 开发工具包.................................................. ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ................................................................ ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ........................................................................................................ ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... …………..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... …………..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... …………..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... …………..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... …………..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... …………..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... …………..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... ..................................................... …………..................................................... …………..................................................... …………
> 
> 输入安装路径（默认 ~/NVIDIA_GPU_Computing_SDK）： /usr/local/CUDA_SDK
> 
> CUDA 位于 /usr/local/cuda
> 如果正确，请选择下面的默认值。
> 如果不正确，输入正确的CUDA
> 
> 路径输入CUDA安装路径（默认/usr/local/cuda）：

对于这个，没有卸载操作，所以看起来有点简单。

我只需要检测“输入安装路径”并输出“/usr/local/CUDA_SDK\n”，然后检测“输入CUDA安装路径”并输出“\n”

我的想法是使用一对期望脚本——每个安装程序一个——但由于命令的双引号内嵌套切换到 root，我在这方面遇到了一些困难。我目前拥有的是：

```
#!/bin/bash
CR="\"\n\""
YES="\"Yes\""
INSTALL_PATH_REQUEST="\"Enter install path\""
CUDA_PATH_REQUEST="\"Enter CUDA install path\""
UNINSTALL_REQUEST="\"Would you like to uninstall?\""
TOOLKIT=`ls -t cudatoolkit* | head -n 1`
TOOLKIT_EXPECT="sh $TOOLKIT"
SDK=`ls -t gpucomputingsdk* | head -n 1`
SDK_INSTALL_PATH="\"/usr/local/CUDA_SDK\n\""
SDK_EXPECT="sh $SDK"
/bin/su root -c "yum -q -y install expect expectk;
/sbin/init 3; sh `ls -t NVIDIA*|head -n 1` -s --update -a -X;
/usr/bin/expect <<EOF;
spawn $TOOLKIT_EXPECT
expect $INSTALL_PATH_REQUEST
send $CR
expect $UNINSTALL_REQUEST
send $YES
EOF
/usr/bin/expect <<EOF;
spawn $SDK_EXPECT
expect $INSTALL_PATH_REQUEST
send $SDK_INSTALL_PATH
expect $CUDA_PATH_REQUEST
send $CR
EOF
/sbin/init 5" 
```

这将正确切换到 root（一旦输入密码）并正确安装带有内置选项的驱动程序。然后它似乎产生了第二个安装过程并输入第一个参数（回车），但似乎过早地退出了第二个安装程序（例如，我没有看到“是”选项。）。

我觉得我已经很接近了，希望有人能指出我出错的地方并建议正确的语法。

**注意：** 我添加了 yum install 命令，因为我正在安装的一些机器没有预料到（库存`CentOS 6`），这样我就省去了那里的麻烦......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T05:29:23.730

此处可能是超时问题...不确定安装程序需要多长时间。
默认的预期超时为 10 秒，如果在该时间内没有看到预期的文本，它将继续进行，您可以像这样更改超时值：

```
expect -timeout 100 $INSTALL_PATH_REQUEST 
```

也改变你的 $YES 从

```
YES="\"Yes\"" 
```

到：

```
YES="\"Yes\r\"" 
```

（最好在 $CR 中也使用 \r 而不是 \n）

在安装结束时期待一些“安全字符串”也是一个好主意，例如：

```
 expect -timeout 320 "Install Complete." 
```

因此，在生成的进程完成之前，expect 脚本不会终止。

# java - 如何实现一个可以被多个线程处理的队列？

> ID：10150943
> 
> 赞同：2
> 
> 时间：2012-04-14T04:17:20.507
> 
> 标签：java, queue

我想我做错了。我正在创建假设从共享队列中处理一些数据的线程。我的问题是程序很慢而且内存占用很大，我怀疑队列可能不像我希望的那样共享。我怀疑这是因为在我的代码中我添加了一条显示队列大小的行，如果我启动 2 个线程，那么我会得到两个具有完全不同数字的输出，并且似乎会自行增加（我认为它可能是相同的数字，但也许它从 100 跳到 2 等等，但在观看后显示 105 和 5 并且以不同的速率运行。如果我有 4 个线程，那么我会看到 4 个不同的数字）。

这是相关部分的片段。我在程序顶部的队列中创建了一个带有我想要的数据的静态类

```
static class queue_class {
        int number;
        int[] data;
        Context(int number,  int[] data) {
            this.number = number;
            this.data = data;
        }
    } 
```

然后我在向可调用对象发送一些作业后创建队列..

```
static class process_threaded implements Callable<Void> {
    // queue with contexts to process
    private Queue<queue_class> queue;

    process_threaded(queue_class request) {
        queue = new ArrayDeque<queue_class>();
        queue.add(request);
    }

    public Void call() {
        while(!queue.isEmpty()) {
            System.out.println("in contexts queue with a size of " + queue.size());
            Context current = contexts.poll();
            //get work and process it, if it work great then the solution goes elsewhere
            //otherwise, depending on the data, its either discarded or parts of it is added back to queue
            queue.add(new queue_class(k, data_list)); 
```

如您所见，数据有 3 个选项，如果数据良好则发送出去，如果数据非常糟糕则丢弃或发送回队列。我认为队列在被发回时正在运行，但我怀疑是因为每个线程都在自己的队列上工作，而不是共享队列。

这个猜测正确吗？我做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T04:31:06.607

您的评估是正确的，每个线程（可能）都在使用自己的队列，因为您在`Callable`. （实际上有一个很奇怪`Callable<Void>`——那不就是一个`Runnable`吗？）

还有其他问题，例如，您使用的队列不是线程安全的，或者您的代码在编写时无法编译。

但是，重要的问题是，您*真的*需要首先显式创建队列吗？为什么不`ExecutorService`给你提交你`Callable`的s（或者`Runnables`如果你决定进行那个切换）：将对执行者的引用传递到你`Callable`的s中，他们可以将新`Callable`的s添加到执行者的任务队列中以运行。无需重新发明轮子。

例如：

```
static class process_threaded implements Runnable {
    // Reference to an executor
    private final ExecutorService exec;
    // Reference to the job counter
    private final AtomicInteger jobCounter;
    // Request to process
    private queue_class request;

    process_threaded( ExecutorService exec, AtomicInteger counter, queue_class request) {
        this.exec = exec;
        this.jobCounter = counter;
        this.jobCounter.incrementAndGet(); // Assuming that you will always
                                           // submit the process_threaded to
                                           // the executor if you create it.
        this.request = request;
    }

    public run() {
        //get work and process **request**, if it work great then the solution goes elsewhere
        //otherwise, depending on the data, its either discarded or parts of are added back to the executor
        exec.submit( new process_threaded( exec, new queue_class(k, data_list) ) );

        // Can do some more work

        // Always run before returning: counter update and notify the launcher
        synchronized(jobCounter){
            jobCounter.decrementAndGet();
            jobCounter.notifyAll();
        }
    }
} 
```

**编辑：**

为了解决您何时关闭执行程序的问题，我认为最简单的解决方案是有一个作业计数器，并在达到 0 时关闭。对于线程安全`AtomicInteger`来说，可能是最好的选择。我在上面添加了一些代码来合并更改。然后您的启动代码将如下所示：

```
void theLauncher() {

    AtomicInteger jobCounter = new AtomicInteger( 0 );

    ExecutorService exec = Executors.newFixedThreadPool( Runtime.getRuntime().availableProcesses());

    exec.submit( new process_threaded( exec, jobCounter, someProcessRequest ) );
    // Can submit some other things here of course...

    // Wait for jobs to complete:
    for(;;jobCounter.get() > 0){
        synchronized( jobCounter ){ // (I'm not sure if you have to have the synchronized block, but I think this is safer.
            if( jobCounter.get() > 0 )
                jobCounter.wait();
        }
    }

    // Now you can shutdown:
    exec.shutdown();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T04:45:29.133

不要重新发明轮子！使用[ConcurrentLinkedQueue](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)怎么样？从javadocs：

> 基于链接节点的无界线程安全队列。此队列对元素进行 FIFO（先进先出）排序。队列的头部是在队列中时间最长的元素。队列的尾部是在队列中时间最短的元素。新元素被插入到队列的尾部，队列检索操作获取队列头部的元素。当许多线程将共享对公共集合的访问时，ConcurrentLinkedQueue 是一个合适的选择。

# c# - 使用 SqlDataSource 和参数时出错

> ID：10150946
> 
> 赞同：0
> 
> 时间：2012-04-14T04:17:25.107
> 
> 标签：c#, sql, c#-4.0

尝试使用 SqlDataSource 和 Gridview 的 SelectCommand 时出现以下错误。我觉得我应该工作，但我得到了这个错误；我怀疑我很接近但忽略了一些东西：

```
System.Data.SqlClient.SqlException (0x80131904): Invalid object name '@tbl'. 
at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) 
at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) 
at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() 
at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) 
at System.Data.SqlClient.SqlDataReader.ConsumeMetaData() 
at System.Data.SqlClient.SqlDataReader.get_MetaData() 
at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) 
at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) 
at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) 
at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method) 
at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method) 
at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior) 
at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior) 
at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) 
at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) 
at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, String srcTable) 
at System.Web.UI.WebControls.SqlDataSourceView.ExecuteSelect(DataSourceSelectArguments arguments) 
at System.Web.UI.DataSourceView.Select(DataSourceSelectArguments arguments, DataSourceViewSelectCallback callback) 
at System.Web.UI.WebControls.DataBoundControl.PerformSelect() 
at System.Web.UI.WebControls.BaseDataBoundControl.DataBind() 
at System.Web.UI.WebControls.GridView.DataBind() 
at Test.BindData() in C:\Dev\Test.aspx.cs:line 45 
```

ASPX：

```
 <asp:DropDownList ID="ddlTable" AutoPostBack="true" runat="server"/>

   <asp:SqlDataSource ID="sqlDS" runat="server" SelectCommand="Select * From [@tbl]">
       <SelectParameters>
            <asp:ControlParameter ControlID="ddlTable" Name="tbl" PropertyName="SelectedItem.Text" />
       </SelectParameters>
   </asp:SqlDataSource>

   <asp:GridView
    ID="grd"
    CssClass="auto"
    runat="server" 
    DataSourceID="sqlDS"
    AutoGenerateDeleteButton="true"
    AutoGenerateEditButton="true" /> 
```

代码：

```
sqlDS.ConnectionString = "valid connection string";
grd.DataBind(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T04:32:46.303

这不是有效的 SQL，那是你的问题。我不确定你想得到什么，但你不能传递一个参数，它将作为一个表。您的查询需要从数据库中进行选择，您可以使用该参数进行过滤或选择。您不能将其用作表格本身。也许您正在寻找更像这样的东西？

```
Select ID From tablename where columnname = '@tbl' 
```

# html - 制作DIV Scrollbar 主页滚动条？

> ID：10150949
> 
> 赞同：2
> 
> 时间：2012-04-14T04:17:35.827
> 
> 标签：html, scrollbar

我正在为我的客户[http://sw6.us/scott/index.html在此页面上工作](http://sw6.us/scott/index.html)

请注意，该站点都基于一个 div，问题是由于文本太长而产生的滚动条。我已经编辑了我的 CSS 并将“溢出”更改为隐藏而不是自动，但这只会使文本从屏幕上消失，您根本无法滚动。

这是我精炼的 HTML 代码

```
<div class="main">

<div class="blk">
....
</div>
<div class="navbar">
....
</div>
<div class="programs">
.....
</div>
<div class="blk2">
...
</div>

</div>
</body>
</html> 
```

该站点是由 .main div 构建的

如何使该滚动条出现在浏览器的最右侧并滚动 .main div？

如果这是不可能的，我如何通过将滚动条放置在浏览器右边缘的设置来实现这种精确的外观？我这样做的原因是因为客户希望网站看起来完全像他的 .pdf 模型。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T04:29:03.037

如果要滚动主 div，请按如下方式更改 CSS...

```
html, body { overflow: hidden; }
div.main { overflow: auto; } 
```

您还应该设置一些底部边距，以便为底部的阴影留出一些空间......

也许发布PDF会帮助我更好地理解......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T04:31:42.393

尝试这个：

```
<div style="height:250px; width:550px; overflow-x:scroll ; overflow-y: scroll;></div> 
```

如果你想隐藏水平滚动：`overflow-x:hidden ;`

# zend-framework2 - Zend Framework 2 DI 别名，不同模块中的控制器名称相同

> ID：10150950
> 
> 赞同：3
> 
> 时间：2012-04-14T04:17:58.527
> 
> 标签：zend-framework2

我有一个包含 3 个模块和路由配置的应用程序，如下所示：

*   admin.domain.tld/[:controller[:/action]] => 管理员
*   rest.domain.tld/[:controller[:/id]] => 休息
*   domain.tld/[:controller[:/action]] => 站点

并为每个模块中的所有控制器设置 DI 别名

REST 模块 DI 别名：

```
'alias' => array(
    'index' => 'Rest\Controller\IndexController',
    ...
), 
```

管理模块 DI 别名：

```
'alias' => array(
    'index' => 'Admin\Controller\IndexController',
    ...
), 
```

站点模块 DI 别名：

```
'alias' => array(
    'index' => 'Site\Controller\IndexController',
    ...
), 
```

如您所见，一些控制器具有相同的名称（例如`IndexController`：），但由于 zf2 将配置与 LIFO 行为合并，'index' 别名总是来自最后添加的模块。

应用程序配置

```
'modules' => array('Rest','Admin', 'Site'), 
```

当我访问[http://admin.domain.tld/](http://admin.domain.tld/)我希望`index`别名给出`Admin\Controller\IndexController`但因为站点模块（最后注册）具有相同的别名给`index`它 `Site\Controller\IndexController`

如何使用不同的 DI 别名来匹配相同的控制器名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T10:21:40.973

在新的视图层合并到主视图层之前，它需要有别名，以便控制器在解析视图脚本时正确运行。现在不再需要了，甚至不再建议使用控制器别名。别名的问题是一个 FQCN 有一个别名，因此您的问题与此直接相关。

您需要做的是从 DI 配置中删除别名并改用显式路由。“魔术”路线 [:controller[/:action]] 是一种不好的做法，会导致比它可以帮助您的问题更多的问题。所以写一些明确的路线并删除别名。

# php - 与 fetch_all 一起使用时导致 mysqli 出现问题的存储过程

> ID：10150951
> 
> 赞同：3
> 
> 时间：2012-04-14T04:18:18.180
> 
> 标签：php, stored-procedures, mysqli

我已将这个问题分解为本质，但仍然遇到问题。

当我尝试使用 fetch_all 来获取存储过程的结果时，我得到的结果按预期返回到数组，但随后的 mysqli 调用会引发“命令不同步”错误。

我什至尝试将我的存储过程简化为...

```
CREATE PROCEDURE testp()
BEGIN
   SELECT * FROM tbl
END 
```

我把桌子做得很小，10 行 3 列。

我使用以下 PHP

```
$query = "CALL testp()";
$result = $db->query($query);
$rows = $result->fetch_all(MYSQL_ASSOC);
$result->free();
print_r($rows);
$query = "SELECT * FROM tbl WHERE id = ?";
$stmt = $this->db->prepare($query);
echo $this->db->error;
$stmt->close(); 
```

Echo 的“命令不同步；您现在无法运行此命令”并抛出致命错误：调用非对象上的成员函数 close()

$rows 按预期输出

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T12:49:49.807

老实说，这实际上是 mysqli 的工作方式！事情以 2 个批次发生，这意味着您需要在执行任何其他操作之前清除最后一个结果。如果你不这样做 -> 错误！

您可以通过使用来实现`next_result()`，示例如下：

```
while($this->_mysqli->next_result()); 
```

..然后成功地继续您的代码。上面的示例适合在 fetch_assoc_ 进程运行后返回数组之前。

（我知道这是 3 个月前问过的，但迟到总比没有；）

# c - 为什么这个函数接受一个 `const char*` 作为参数而不是只接受 `char*`？

> ID：10150955
> 
> 赞同：3
> 
> 时间：2012-04-14T04:18:48.047
> 
> 标签：c, function, pointers

Noob C 问题传入：

```
#include <sys/types.h> 
#include <sys/socket.h> 
#include <netdb.h> 
int 
getaddrinfo(const char *hostname, const char *servname, const struct addrinfo *hints, struct addrinfo **res)

void 
freeaddrinfo(struct addrinfo *ai) 
```

取自[http://www.nxmnpg.com/3/getaddrinfo](http://www.nxmnpg.com/3/getaddrinfo)。也就是说，我对为什么它不仅仅是 getaddrinfo(char *hostname) 而是一个 const 感兴趣。

我知道指针是什么。在我看来，几乎 C 中的所有函数都更喜欢仅传递给变量的指针，这是正确的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T04:22:17.497

限定符是函数与您签订的`const`合同，以确保您**不会**`const`更改传递给它的任何参数的值。这可以由编译器验证，因此这是在漫长的早晨结束时为您增加额外安全和保证的好方法（;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T04:25:17.367

C 没有字符串作为基本类型的概念；它是 的数组`(char)`，只能作为指向 的指针传递给函数`(char)`。您还将看到`(long)`在较旧的 API 中作为指针传递，可以追溯到许多实现 C 的 CPU 无法`(long)`在寄存器中传递 a （因此无法`return`编辑）。

# javascript - 使用 javascript 或 jquery 将 xml 转换为 html

> ID：10150960
> 
> 赞同：0
> 
> 时间：2012-04-14T04:19:38.700
> 
> 标签：javascript, jquery, html

我有 xml 文件，其中包含一些详细信息我想从中选择一些值我做了那个 javascript 但我不接近我的要求，我想从条件中选择值。

```
<edata updated="2012:12:32.697" product_type_id="3" product_type="epack" headline="Gold Coast" destination="india" localised_destination="Gold Coast" headline_no_html="Gold Coast" price="372" />
<edata updated="2012:12:32.697" product_type_id="3" product_type="epack" headline="Gold Coast" destination="china" localised_destination="Gold Coast" headline_no_html="Gold Coast" price="450" /> 
```

这是我在 xml 文件中丢失数据的示例。

## 标头部分中的 javascript

```
<script type="text/javascript">
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","edata.xml",false);
xmlhttp.send();
xmlDoc=xmlhttp.responseXML; 
</script> 
```

## 正文部分的代码

```
<div id="Frame2">
  <script type="text/javascript">
    function load()
    {
      alert("Page is loaded");
    }
    var x=xmlDoc.getElementsByTagName("edata");
    document.write("<div>");
    document.write(x[0].getAttribute('price'));
    document.write("</div>");
  </script>
</div> 
```

请注意我的代码在第一个 div 中获得第一个 edata 值我想按条件获得中国价格值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T05:40:46.377

我假设由于您在此标签上标记了“jquery”，因此您正在使用 jquery（尽管您的代码示例并不暗示这一点）。使用 jQuery，您可以（使用 jQuery.ajax 更简洁地获取数据，然后......）：

```
<div id="Frame2">
  <script type="text/javascript">
    function load()
    {
      alert("Page is loaded");
    }
   $xml = $( xmlDoc ),
   $title = $xml
     .find( "edata[price]" ) //gets all nodes with a price
     .filter( function(i) {
         // filter out all the items that have a price less than 100
         return ( parseInt( this.attr("price") ) > 100 ) ? true : false;
     })
   ; 
  </script>
</div> 
```

如果您不想使用 jQuery，当然必须使用循环：

```
<div id="Frame2">
  <script type="text/javascript">
    function load()
    {
      alert("Page is loaded");
    }
    var x=xmlDoc.getElementsByTagName("edata");
    var i, l = x.length;
    var price;
    for( i = 0; i < l; i++ ){
      price = x[i].getAttribute( 'price' );
      if( typeof price !== "undefined" && parseInt( price ) > 100 ){
        document.write("<div>" + price + "</div>");
      }
    }
  </script>
</div> 
```

# c - C 中的解析错误

> ID：10150962
> 
> 赞同：-1
> 
> 时间：2012-04-14T04:20:04.313
> 
> 标签：c, parsing, syntax

我正在做一些按位运算作业，它说我的代码有一个“解析错误”我假设它的语法或其他东西......但我找不到丢失的分号或任何东西。你能找出为什么我可能会遇到问题吗？

```
int isGreater(int x, int y)
{
      int xSign = (x>>31);
      int ySign = (y>>31);
      int check1 = (xSign & ySign) | (~xSign & ~ySign);
      int same = ( x + ((~y) + 1) )>>31;
      same = !(same & 0x1);
      int check2 = (check1 & same) | (~check1 & !xSign);
      int equal = (!(x ^ y))<<31>>31;
      return (equal & 0) | (~equal & check2);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T06:52:20.807

一定有什么可疑的事情发生。也许您的编辑器将`<<`or`>>`与某些 unicode 字符`«`或`»`.

或者你正在写的相反`< <`或`> >`在某处有空格。然后解析会看到两个不同的标记，例如`<`和`<`而不是一个`<<`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T06:30:42.433

所以，我写了一小段代码——它似乎和你做的完全一样……我不知道这是否有帮助，但它告诉你哪个更大，而不是它们是否相等. 不确定它是否有助于缩短代码。

```
#include <stdio.h>

int isGreater(int x, int y)
{
   return (y + (~x +1)) >> 31 & 1;
}

int main(void)
{
    int x = 1;
    int y = 2;
    int greater = isGreater(x,y);
    if(greater == 1) {
        printf("%i > %i \n", x, y);
    } else {
        printf("%i < %i \n", x, y);
    }
    return 0;
} 
```

# python - AppEngine python上用于PayPay网络支付标准的加密PayPal按钮？

> ID：10150964
> 
> 赞同：2
> 
> 时间：2012-04-14T04:20:16.637
> 
> 标签：python, google-app-engine, encryption, paypal

我正在寻找从运行 python 的 appEngine 为贝宝创建加密表单的示例。我在附近看到了很多东西，但不是正确的地址：

这是[PayPal 网站](https://cms.paypal.com/us/cgi-bin/?&cmd=_render-content&content_ID=developer/e_howto_html_encryptedwebpayments#id08A3I0P017Q)上生成加密表格的一般信息。基本上，表单数据被加密并发送到贝宝，这样就不会被篡改。

这篇[很棒的文章](http://jonatkinson.co.uk/paypal-encrypted-buttons-django/)谈到了在 django 中做这件事。问题在于它依赖于 M2Crypto 并且不在 AppEngine 上运行。

有一个基于上一篇文章的[库，但应该被黑客入侵以在应用程序引擎上运行。](https://github.com/jdennes/django-paypal-appengine)当您浏览 PayPalEncryptedPaymentsForm 类时，他们正在使用 M2Crypto。

这导致我尝试验证您[不能在 AppEngine 上使用 M2Crypto](https://stackoverflow.com/questions/8838855/importing-m2crypto-to-google-app-engine)。

结果在搜索过程中，我发现[了这篇](http://hustoknow.blogspot.com/2012/01/using-pycrypto-instead-of-m2crypto-on.html)关于使用 PyCrypto 而不是 M2Crypto 的文章。这篇文章中有很多不属于我专业领域的警告。我希望有人尝试使用 PyCrypto 进行 PayPal 的加密网站支付，并通过一个例子来说明一些问题。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T09:05:58.243

我对 GAE 加密无能为力，但也许另一种解决方案会有所帮助：为什么不使用快速结帐 API 来协商用于将用户重定向到 PayPal 支付流程的 server2server 令牌？

# ruby-on-rails - Mongoid - 如何获得第二条记录？

> ID：10150965
> 
> 赞同：6
> 
> 时间：2012-04-14T04:20:33.737
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, mongoid

我可以

`1.9.3p125 :122 > User.first
=> #<StandardUser _id: 4f849..`

和

`1.9.3p125 :124 > User.last`

和

`1.9.3p125 :125 > User.count
=> 5`

但我找不到任何方法来获取其他记录（2 到 4）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-14T04:27:55.393

`User.skip(1).first`返回您的第二份文件。

# c - 无法使用 openssl 解密包含空字符 (\x00) 的加密字符串

> ID：10150971
> 
> 赞同：1
> 
> 时间：2012-04-14T04:21:30.567
> 
> 标签：c, ubuntu, openssl, encryption

我有以下字符串：

```
char *str = "\x45\x00\x10"; 
```

我需要使用 openssl 对其进行加密，通过网络发送并解密以取回相同的字符串。

我使用以下代码进行加密（在 Ubuntu Linux 中使用 C 语言编程）：

```
int do_encrypt(char *cipher, char *key, char *iv, char *plaintext, int len)
{
    unsigned char outbuf[BUFSIZE];
    int outlen, tmplen;
    EVP_CIPHER_CTX ctx;
    EVP_CIPHER_CTX_init(&ctx);
    EVP_EncryptInit_ex(&ctx, EVP_aes_128_cbc(), NULL, key, iv);

    if(!EVP_EncryptUpdate(&ctx, outbuf, &outlen, plaintext, len))
    {
            EVP_CIPHER_CTX_cleanup(&ctx);
            return 0;
    }

    if(!EVP_EncryptFinal_ex(&ctx, outbuf + outlen, &tmplen))
    {
            EVP_CIPHER_CTX_cleanup(&ctx);
            return 0;
    }

    outlen += tmplen;
    EVP_CIPHER_CTX_cleanup(&ctx);

    outbuf[outlen] = '\0';
    strcpy(cipher,outbuf);
    return 1;
} 
```

我使用以下代码进行解密：

```
int do_decrypt(char *plain, char *key, char *iv, char *cipher)
{
    unsigned char outbuf[BUFSIZE];
    int outlen, tmplen;
    EVP_CIPHER_CTX ctx;

    EVP_CIPHER_CTX_init(&ctx);
    EVP_DecryptInit_ex(&ctx, EVP_aes_128_cbc(), NULL, key, iv);

    if(!EVP_DecryptUpdate(&ctx, outbuf, &outlen, cipher, strlen(cipher)))
    {
            EVP_CIPHER_CTX_cleanup(&ctx);
            return 0;
    }

    if(!EVP_DecryptFinal_ex(&ctx, outbuf + outlen, &tmplen))
    {
            EVP_CIPHER_CTX_cleanup(&ctx);
            return 0;
    }

    outlen += tmplen;
    EVP_CIPHER_CTX_cleanup(&ctx);

    outbuf[outlen] = '\0';
    strcpy(plain,outbuf);

    return outlen;
 } 
```

当我使用第一个函数加密 str 并将第三个参数作为 3 传递（我不想传递 strlen(str) 因为它不会加密整个字符串）并使用第二个函数对其进行解密时，我得到以下纯回信：

```
 \x45\x00\x00 // recovered plain text 
```

我应该对我的代码进行什么更正，以便我可以加密整个字符串并仍然获取整个字符串，即使原始字符串包含空字符？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T04:24:11.150

你...*知道*会`strcpy()`在第一个 NUL 停止，对吧？改为使用`strncpy()`。

# php - 将 PHP/MySQL 请求转换为 jQuery AJAX 请求

> ID：10150973
> 
> 赞同：2
> 
> 时间：2012-04-14T04:22:13.697
> 
> 标签：php, jquery, ajax

我在这里踢自己的屁股，因为我一生都无法弄清楚......这应该是一个快速而肮脏的项目，但是，我决定我想尝试一些新的东西，而且我几乎没有没有使用 jQuery 中的 AJAX 方法的经验...我花了 5 天时间尝试学习和理解如何适当地实现 AJAX 调用，但要知道有用...我学到了一些基本的东西，但不是我需要的执行下面的代码。

同样，我想知道如何使用 jQuery 将这个标准请求转换为 AJAX ......

这是我的表格和 php

HTML：

```
<form action="categories.php?action=newCategory" method="post">
  <input name="category" type="text" />
  <input name="submit" type="submit" value="Add Categories"/>
</form> 
```

PHP：

```
<?php
if (isset($_POST['submit'])) {
  if (!empty($_POST['category'])) {
    if ($_GET['action'] == 'newCategory') {
      $categories = $_POST['category'];
      $query = "SELECT * FROM categories WHERE category ='$categories' ";
      $result = mysql_query($query) or die(mysql_error());
      if (mysql_num_rows($result)) {
        echo '<script>alert("The Following Catergories Already Exist: ' . $categories . '")</script>';
      } else {
    // Simply cleans any spaces
        $clean = str_replace(' ', '', $categories);
    // Makes it possible to add multiple categories delimited by a comma
        $array = explode(",", $clean);
        foreach ($array as &$newCategory) {
          mysql_query("INSERT INTO categories (category) VALUES ('$newCategory')");
        }
        echo "<script>alert('The following Categories have been added successfully: " . $categories . "')</script>";
      }
    }
  } else {
    echo "<script>alert('Please Enter at Least One Category.')</script>";
  }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T04:36:47.737

这是在后台进行调用而不提交表单但仍发送/检索结果的正确语法。

```
$(function(){
  $('form').submit(function(e){
    e.preventDefault(); // stop default form submission
    $.ajax({
      url: 'categories.php',
      data: 'action=newCategory',
      success: function(data){
        //here we have the results returned from the PHP file as 'data'
        //you can update your form, append the object, do whatever you want with it
        //example:
        alert(data);
      }
    });
  });
}); 
```

还：

我不会这样做->

`echo "<script>alert('Please Enter at Least One Category.')</script>";`

做就是了`echo 'Please Enter at Least One Category.';`

如果您需要创建错误系统，您可以执行以下操作，

`echo "Error 1001: <!> Please enter at least One Category!';`

然后在“成功”的 Ajax 回调中，我们可以将返回的对象拆分为`<!>`. 要遵循的示例：

```
success: function(data){
  if($(data+':contains("<!>")'){
    var errMsg = $(data).split('<!>');
    alert(errMsg[0]+' : '+errMsg[1]);
    //above would output - Error 1001 : Please enter at least One Category!;
  }
} 
```

# c - C：sscanf赋值抑制和返回值

> ID：10150976
> 
> 赞同：4
> 
> 时间：2012-04-14T04:22:19.953
> 
> 标签：c, scanf

我正在尝试在 C 中使用 sscanf 从字符串中获取一些值。但是，如果字符串的值比我想要的多，我需要它来引发错误。IE。如果我想要一个整数，“2”应该没问题，但“2 5”应该崩溃。

现在使用 sscanf 上的返回值，如下所示：

```
if (sscanf(mystring, "%d %*s", &num) == 1) 
```

不起作用，因为即使字符串更长，它也会返回 1。我可以做这个：

```
char tmpString [100];
if (sscanf(mystring, "%d %s", &num, tmpString) == 1) 
```

效果很好，但不是特别好。还有其他方法吗？我可以使用赋值抑制并且仍然得到我想要的返回值吗？

编辑这是我使用的代码：

```
char c; // This is a global variable, just gets used over and over.
sscanf(mystring, "%d%c", &num, &c);
    if (c == '\n') { 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T04:33:12.860

一种可能性是：

```
int pos;
if (sscanf(mystring, "%d %n", &num, &pos) == 1)
{
    if (mystring[pos] != '\0')
        ...oops...extra data...
    else
        ...only number...
}
else
    ...not even one number... 
```

`%n`是 C89的一部分。它不是一个特别常用（或广为人知）的转换规范。它不被计为转换（因此测试`1`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-14T12:08:45.277

一个更简单的测试，只使用`scanf`返回值而不是返回值的一个测试和一个字符计数，可以通过以下方式实现：

```
if (1 == sscanf(mystring, "%d %c", &num, &(char){0})) 
```

这是有效的，因为如果在尾随空格被消耗后有任何字符，则会执行第二次赋值，因此返回值是 2 而不是 1。

（这`(char){0}`是一个复合文字，它提供了一个临时对象来保存分配的`char`，之后它被丢弃。）

# php - 如何在下一页显示日期？

> ID：10150978
> 
> 赞同：1
> 
> 时间：2012-04-14T04:22:38.977
> 
> 标签：php

我真的需要一些关于如何在下一页（save.php）中传递返回日期值的帮助。我不能传递的值在这个“（输入类型='隐藏'名称='retDate [$i]'值='$retDate'）”下。我在这个网站上使用日历日期选择器（[http://www.triconsole.com/php/calendar_datepicker.php](http://www.triconsole.com/php/calendar_datepicker.php)）。感谢有人可以帮助我解决这个问题，并在下面参考我的编码。

在“结果.php”下

```
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0"></br>
    <h1>RESULT </h1>
    <p><b>Escalation Date : </b>
    <?php echo $_POST["date1"] ?> until <?php echo $_POST["date2"] ?>
    </p>
    <?php 
                 ......
            //Select database
            $selected = mssql_select_db($myDB, $link)
            or die("Couldn't open database $myDB");

            //declare the SQL statement that will query the database
            $query = "SELECT....."; 

        //execute the SQL query and return records
        if ($result = mssql_query($query, $link)){
            echo "<form name='form1' method='post' action='save.php'>";
            echo "<table border='1'>
            <tr>
            <th>batch_exception_id</th>
            <th>batch_id</th>
            <th>process_date_time</th>
            <th>Return Date</th>
            </tr>";
            $i=0;
            while ($row = mssql_fetch_assoc($result)) {   
                $rDate = $row['ReturnDate'];
                $beID = $row['batch_exception_id'];                         
                $proc_dt = $row['process_date_time'];
                echo "<tr>";
                echo "<td>" . $beID . "<input type='hidden' name='beID[$i]' value='$beID'/></td>";
                echo "<td>" . $row['batch_id'] . "</td>";
                echo "<td>" . $proc_dt . "<input type='hidden' name='procDT[$i]' value='$proc_dt'/></td>";

                if($rDate == ""){
                    echo "<td>";    
                            $f_name="retDate[".$i."]";    
                    $myCalendar = new tc_calendar($f_name, true, false);      
                    $myCalendar->setIcon("calendar/images/iconCalendar.gif");     
                    $myCalendar->setDate(date('d'), date('m'), date('Y'));    
                    $myCalendar->setPath("calendar/");    
                    $myCalendar->setYearInterval(2000, 2020);     
                    $myCalendar->dateAllow('2000-01-01', '2020-01-01');   
                    $myCalendar->setDateFormat('j F Y');      
                    $myCalendar->setAlignment('left', 'bottom');      
                    //$myCalendar->setSpecificDate(array("", "0", "0"), 0, 'year');   
                    //$myCalendar->setSpecificDate(array("0", "0"), 0, 'month');      
                    //$myCalendar->setSpecificDate(array("0"), 0, '');    
                    $myCalendar->writeScript();
                    echo "<input type='hidden' name='retDate[$i]' value='$retDate'/>";
                    //echo "<input type='hidden' name='retDate[$i]' value='".$myCalendar->getDate()."'/>";    
                    $i++;       
                    echo "</td>";
                } else {
                    echo "<td>" . $rDate . "</td>";
                }
                echo "</tr>";       
            }           

            echo "</table><br/>";
            echo "<input type='button' value='<<' onclick='history.back(-1)'/>";
            echo "<input type='hidden' name='total_rec' value='$i'/>";          
            echo "<input type='submit' value='Save'/>";         
            echo "<input type='button' value='Print' onclick='window.print()'/>";
            echo"</form>";
        }

        //close the connection
        mssql_close($link);     
    ?><br/>                 
</body> 
```

![在此处输入图像描述](../Images/e45bf9ac792c6ed88316ba3446646425.png)

在“save.php”下

```
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0"></br>       
    <?php 
        //$ReturnDate = $_POST["rDate"];
        $arrbeID = $_POST["beID"];
        $tot_rec = $_POST["total_rec"];
        $arrprocDT = $_POST["procDT"]; 
        $arrretDate = $_POST["retDate"]; 

        for ($i=0; $i<$tot_rec;$i++) {
            echo "Batch Esc. ID: ".$arrbeID[$i]." 
                | Proc. DateTime: ".$arrprocDT[$i]."
                | Ret. Date: ".$arrretDate[$i]."
                <br>";
        }       

    ?><br/>
</body> 
```

![在此处输入图像描述](../Images/48c0ddd0fe75345a87fc2b3302030ded.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T05:35:20.827

我认为你需要这条线：

```
echo "<input type='hidden' name='retDate[$i]' value='$retDate'/>"; 
```

成为：

```
echo "<input type='hidden' name='retDate[$i]' value='$rDate'/>"; 
```

因为 $rDate 是您实际存储从数据库中获取的返回日期的位置：

```
$rDate = $row['ReturnDate']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:00:33.850

解决方案：-

将 Result.php 中的 sript 放在头部下方

```
 <link rel="stylesheet" title="Style CSS" href="cwcalendar.css" type="text/css" media="all" />
    <script type="text/javascript" src="calendar.js"></script> 
```

在 Result.php 的正文下添加以下代码

```
 $date="date[".$i."]"; 
echo "<input type='text' name='date[$i]' id='$date' value=' ' onclick=\"fPopCalendar('".$date."')\">"; 
```

脚本参考： [http ://codetale.com/2009/06/21/javascript-calendar-widget-108/](http://codetale.com/2009/06/21/javascript-calendar-widget-108/)

# django - 如何从用户访问组子类？

> ID：10150980
> 
> 赞同：1
> 
> 时间：2012-04-14T04:23:20.800
> 
> 标签：django

我有一个模型 Course，它是 Group 模型的子类。如何以类似于他所有组的方式访问用户课程（例如`request.user.courses`）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T04:44:23.117

尝试

```
qs = request.user.groups.filter(course__isnull=False)
for group in qs:
    course = group.course

# or shortcuts
User.get_courses = lambda self: map(lambda g: g.course, self.groups.filter(course__isnull=False))
# or 
User.get_courses = lambda self: Course.objects.filter(pk__in=self.groups.all())
# then
request.user.get_courses() 
```

用户和课程之间没有直接关系。`Group`您需要通过模型继承生成的 OneToOneField 在和之间获取组然后获取课程`Course`。

不知道你为什么子类化`Group`. 你也可以

```
class Course(models.Model):
    students = models.ManyToManyField(User, related_name='courses') 
```

如果你真的想扩展`User`拥有`User.courses`like `User.groups`，你可以

```
# Option 1
# in models.py
class UserCourse(models.Model):
     user = models.ForeignKey(User)
     course = models.ForeignKey(Course, db_column='group_id')
     class Meta:
         db_table = User.groups.through._meta.db_table

m2m = models.ManyToManyField(Course, related_name='students', through=UserCourse)
m2m.contribute_to_class(User, 'courses')

# Option 2
# simpler but has duplicated m2m table and different API
# Also a Course instance will not have corresponding
# Group instance in user.groups, which may not be correct in logic.
class UserCourse(models.Model):
     user = models.ForeignKey(User, related_name='courses')
     course = models.ForeignKey(Course)

# Option 3
# just as Option 2, but w/ M2M API
class UserCourse(models.Model):
     user = models.ForeignKey(User)
     course = models.ForeignKey(Course)
m2m = models.ManyToManyField(Course, related_name='students', through=UserCourse)
m2m.contribute_to_class(User, 'courses') 
```

# facebook - 如何重定向您的“转到应用程序”按钮以 引导用户访问您的网站

> ID：10150982
> 
> 赞同：0
> 
> 时间：2012-04-14T04:24:06.640
> 
> 标签：facebook, web-applications

我设置了一个新应用程序——当我的用户收到许可屏幕后，单击“转到应用程序”后，我希望它重定向到我自己的网站（例如 www.mysite.com），而不是将我重定向到我在 facebook 中的网站.

由于我的网站在 facebook 中不兼容，我需要该应用程序来引导用户访问我的网站 - 我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:04:47.670

如果您的应用存在 Canvas，则 Go To App 按钮将重定向到您的画布登录页面。例如[http://apps.facebook.com/yourapp](http://apps.facebook.com/yourapp)

如果您的应用程序严格来说是 Connect 应用程序，那么 Go To App 按钮将重定向到 Facebook 以外的站点，例如[http://www.yourapp.com](http://www.yourapp.com)

如果您的应用同时实现了 Canvas 和 Connect，它将转到 Canvas 页面。

Facebook 开发者应用中的相关设置位于“选择您的应用如何与 Facebook 集成”下。您无需在 Facebook.com 中拥有任何画布。您只需选中网站复选框，然后转到应用程序按钮会将用户直接带到您的网站。请注意，如果这样做，您将无法使用一些重要的 API 功能，例如书签和请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T10:49:22.713

单击允许按钮后，用户被重定向到的 url 是您在将用户发送到 oauth 对话框时在“redirect_uri”参数中提供的 url。

您可以使用 ex.www.mysite.com（只要它与应用程序设置中的内容相同），而不是指定您的 fb 应用程序 url (apps.facebook.com/APP_NAME)。

您可以做的另一件事是使用 javascript 重新加载页面：

```
top.location.href = "ex.www.mysite.com"; 
```

说了这么多，你**不**应该那样做。[它在Facebook 平台政策](http://developers.facebook.com/policy/)中明确表示：

> 1.  Facebook 上的 Canvas 或 Page Tab 应用程序的主要目的不能是简单地将用户从 Facebook 体验重定向到外部网站。

# php - sql查询中的MD5发布数据

> ID：10150986
> 
> 赞同：2
> 
> 时间：2012-04-14T04:24:56.317
> 
> 标签：php, sql

我正在尝试执行以下操作，但给出了错误，编写该语句的正确方法是什么；

```
$sql="SELECT * FROM $tbl_name WHERE $db_usercol= '".$_POST['myusername']"' and $db_passcol= '"(md5($_POST['mypassword']))"'";
        $result=mysql_query($sql); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T04:27:19.560

`mysql_real_escape_string()`是一个很好的做法。

```
$sql = "SELECT * 
        FROM $tbl_name 
        WHERE $db_usercol= '" . mysql_real_escape_string($_POST['myusername']) . 
          "' AND $db_passcol= '" . (md5($_POST['mypassword'])) . "'"; 
```

另外，您忘记了连接符号`.`.

# c# - ValueConveter 或 DataTemplate

> ID：10150993
> 
> 赞同：0
> 
> 时间：2012-04-14T04:26:22.480
> 
> 标签：c#, .net, wpf, converter

我正在尝试构建一个可以接受对象列表的通用界面，然后根据用户选择他们想要查看对象的方式来选择显示对象的不同方式。目前，用户有一个下拉菜单，允许他们像资源管理器一样选择视图类型，例如“详细信息、预览等”，然后根据选择显示应该更改。我的第一次尝试是创建将接受绑定对象并显示它的用户控件，但是我不知道如何将我的列表项转换为用户控件。我的问题是，我应该使用 IValueConverter 将列表项转换为我想要显示的用户控件类型，还是应该使用 DataTemplates 和 TemplateSelector 来定义我的不同视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T04:32:17.497

为什么不直接使用 ListView 和 GridView？您的用例正是它们存在的原因。

MSDN 有一个很好的小示例，说明如何在运行时切换 ListView 中的[视图](http://msdn.microsoft.com/en-us/library/ms771469.aspx)。

# java - setLinearVelocity() 没有按预期工作

> ID：10150995
> 
> 赞同：2
> 
> 时间：2012-04-14T04:26:38.673
> 
> 标签：java, box2d, jbox2d

我一直在搞乱 jbox2d，当身体的 x 速度受到世界重力的影响时，我感到很惊讶。这是我的代码：

```
 //create world
    Vec2 gravity = new Vec2(0, 1);
    boolean sleep = true;
    world = new World(gravity, sleep);
    //create wheel
    BodyDef wheelBodyDef = new BodyDef();
    wheelBodyDef.type = BodyType.DYNAMIC;
    wheelBody = world.createBody(wheelBodyDef);
    CircleShape circleShape = new CircleShape();
    FixtureDef wheelFixtureDef = new FixtureDef();
    wheelFixtureDef.shape = circleShape;
    Fixture wheelFixture = wheelBody.createFixture(wheelFixtureDef);
    wheelBody.setLinearVelocity(new Vec2(50, 0)); 
```

如果我每帧都应用它或禁用重力，线速度只会产生显着差异。谁能弄清楚我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T18:22:15.403

Box2d 不支持零重力模拟；这就是为什么当你禁用重力时你看不到任何区别。此外，您可能看到的差别不大，因为 的重力`(0, 1)`非常弱；试试`(0, 10)`。

也是`setLinearVelocity`一个 rayCast 函数。您可能正在寻找`applyForce()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T08:11:25.773

如果您在物体上设置线速度，则意味着它将沿矢量设置的速度方向移动。如果您禁用重力，则不会影响此运动，但启用重力后，其运动每帧都会受到重力的影响。如果你把一个苹果扔到外太空，它会朝着发射的方向无限移动，但在地球上，重力又会不断地把它拉下来。如果你想让你的身体沿着你想要的方向直线移动，那么你必须设置每帧的线速度。观看[本](http://www.kerp.net/box2d/)教程，#2.35 和 #2.36，那里的问题得到了很好的解释。

祝你好运

# c# - ExecuteNonQuery 静默失败，没有任何错误

> ID：10150997
> 
> 赞同：1
> 
> 时间：2012-04-14T04:27:01.477
> 
> 标签：c#, asp.net, sql-server-2008, ado.net

**更新**：我的代码行为符合预期，因为存储过程中有一个错字，这是它失败的原因。

* * *

我似乎无法弄清楚为什么或如何解决这个问题，因为我没有收到任何错误，我得到的是返回值为 0，这意味着失败。

这是我的 .net 代码：

```
SqlParameter returnValue= new SqlParameter("returnValue", SqlDbType.Int);
returnValue.Direction = ParameterDirection.ReturnValue;
cmd.Parameters.Add(returnValue);

cmd.ExecuteNonQuery();

result = Convert.ToInt32(returnValue.Value); //1 success and 0 failed 
```

我的存储过程：

```
CREATE PROCEDURE EmployeeUpdate
    @employee_id BIGINT,
    @name nvarchar(250)
AS
BEGIN 
    SET NOCOUNT ON 

    DECLARE @Result int  
    SET @Result = 0  

    UPDATE Employee
    SET name = @name 
    WHERE employee_id = @employee_id                   

    IF (@@rowcount = 1) 
    BEGIN
        SET @Result = 1       
    END

    SET NOCOUNT OFF

    RETURN @Result 
END 
```

因此，如果我只是从 SQL Server Management Studio 执行存储过程，它会成功更新我的行而不会出现任何错误

```
EXEC EmployeeUpdate 34,'John John'

Return Value = 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T17:35:28.543

替换以下

```
CREATE PROCEDURE EmployeeUpdate
       @employee_id BIGINT,
       @name nvarchar(250)
AS
BEGIN 
      SET NOCOUNT ON 
```

跟随

```
CREATE PROCEDURE EmployeeUpdate
       @employee_id BIGINT,
       @name nvarchar(250)
AS
BEGIN 
      SET NOCOUNT OFF 
```

* * *

> SET NOCOUNT ON 表示不返回 T-SQL 影响的行数
> 
> SET NOCOUNT OFF 表示将返回 T-SQL 影响的行数。

![在此处输入图像描述](../Images/4056d383ead6ea35017bf3778f71474f.png) ![在此处输入图像描述](../Images/eed445fcb5116dbe19cceafd2f9f2edb.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T04:37:24.387

我建议完全删除 returnValue 参数，而只使用 ExecuteNonQuery() 方法的返回值：

```
int rowsAffected = cmd.ExecuteNonQuery();

result = rowsAffected == 1 ? 1 : 0; 
```

存储过程：

```
CREATE PROCEDURE EmployeeUpdate
       @employee_id BIGINT,
       @name nvarchar(250)
AS
BEGIN 
      UPDATE Employee
      SET  name = @name 
      WHERE  employee_id = @employee_id                   
END 
```