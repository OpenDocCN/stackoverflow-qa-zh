# StackOverflow 问答 11543000-11543999

# java - Unicode字符的MySQL数据截断

> ID：11543003
> 
> 赞同：0
> 
> 时间：2012-07-18T13:52:06.460
> 
> 标签：java, mysql, unicode

我已将 mysql 5.0 配置为存储 UTF-8。我有一列数据类型为`longtext`. 我尝试存储它，它可以毫无问题地存储（MySQL 能够存储 UTF-8）：

> Τὴ γλῶσσα μοῦ ἔδωσαν ἑλληνικὴ τὸ σπίτι φτωχικὸ στὶς ἀμμουδιὲς τοῦ Ὁμήρου。Μονάχη ἔγνοια ἡ γλῶσσα μου στὶς ἀμμουδιὲς τοῦ Ὁμήρου。ἀπὸ τὸ Ἄξιον ἐστί τοῦ Ὀδυσσέα Ἐλύτη</p>

只是为了测试我尝试存储这个：

> 梵文：काचं शक्नोम्यत्तुम् । नोपहिनस्ति माम् ॥ 梵文（标准转录）：kācaṃ śaknomyattum；nopahinasti 妈妈。古希腊语：ὕαλον φαγεῖν δύναμαι· τοῦτο οὔ με βλάπτει。希腊语（单调）：Μπορώ να φάω σπασμένα γυαλιά χωρίς να πάθω τίποτα。希腊语（多调）：Μπορῶ νὰ φάω σπασμένα γυαλιὰ χωρὶς νὰ πάθω τίποτα。伊特鲁里亚语：（需要）拉丁语：Vitrum edere possum；mihi non nocet。古法语： Je puis mangier del voirre。不用我了。法语：Je peux manger du verre，ça ne me fait pas mal。Provençal / Occitan: Pòdi manjar de veire, me nafraria pas. Québécois: J'peux manger d'la vitre, ça m'fa pas mal。瓦隆： Dji pou magnî do vêre, çoula m' freut nén må。Champenois：（需要）Lorrain：（需要）Picard：Ch'peux mingi du verre，cha m'foé mie n'ma。科西嘉/科苏：（需要）Jèrriais：(需要) Kreyòl Ayisyen (海地): Mwen kap manje vè, li pa blese'm。巴斯克语：Kristala jan dezaket，ez dit minik ematen。加泰罗尼亚语/加泰罗尼亚语：Puc menjar vidre, que no em fa mal。西班牙语：Puedo comer vidrio，no me hace daño。Aragonés: Puedo minchar beire, no me'n fa mal 。Aranés：（需要） Mallorquín：（需要）加利西亚语：Eu podo xantar cristais e non cortarme。欧洲葡萄牙语：Posso comer vidro, não me faz mal。巴西葡萄牙语 (8)：Posso comer vidro, não me machuca。Caboverdiano/Kabuverdianu（佛得角）：M' podê cumê vidru, ca ta maguâ-m'。Papiamentu: Ami por kome glas anto e no ta hasimi daño。意大利语：Posso mangiare il vetro e non mi fa male。米兰人：Sôn bôn de magnà el véder, el me fa Minga mal。Roman: Me posso magna' er vetro, e nun me fa male。Napoletano: M' pozz magna' o'vetr, e nun m' fa mal. 威尼斯人: Mi posso magnare el vetro, no'l me fa mae。Zeneise (Genovese): Pòsso mangiâ o veddro eo no me fà mâ。西西里语：Puotsu mangiari u vitru，nun mi fa mali。Campinadese (Sardinia): (NEEDED) Lugudorese (Sardinia): (NEEDED) Romansch (Grischun): Jau sai mangiar vaider, senza che quai fa donn a mai。Romany / Tsigane：（需要）罗马尼亚语：Pot să mănânc sticlă și ea nu mă răneşte。世界语： Mi povas manĝivivon, ĝi ne damaĝas min. 皮克特语：（需要）布列塔尼语：（需要）康沃尔语：Mý a yl dybry gwéder hag éf ny wra ow ankenya。威尔士语：Dw i'n gallu bwyta gwydr, 'dyw e ddim yn gwneud dolur i mi。马恩岛盖尔语：Foddym gee glonney agh cha jean eh gortaghey mee。古爱尔兰语（Ogham）：᚛᚛ᚉᚑᚅᚔᚉᚉᚔᚋ ᚔᚈᚔ ᚍᚂᚐᚅᚑ ᚅᚔᚋᚌᚓᚅᚐ᚜ 古爱尔兰语（拉丁语）：Con·iccim ithi nglano。尼姆·热那。爱尔兰语：féidir liom gloinne 是 ithe。Ní dhéanann sí dochar ar bith dom。阿尔斯特盖尔语：Ithim-sa gloine agus ní miste damhé。苏格兰盖尔语：S urrainn dhomh gloinne ithe；cha ghoirtich i mi。盎格鲁 - 萨克逊（符文）：ᛁᚳ᛫ᛗᚨᚷ᛫ᚷᛚᚨᛋ᛫ᛖᚩᛏᚪᚾ᛫ᚩᚾᛞ᛫ᚻᛁᛏ᛫ᚾᛖ᛫ᚻᛖᚪᚱᛗᛁᚪᚧ᛫ᛗᛖ᛬盎格鲁撒克逊（拉丁语）：ICmægllæseotan ond hit ne mevermiað我。中古英语：Ich canne glas eten 和 hit hirtiþ me nouȝt。Chinese: 我可以吃玻璃，它不会伤害我。英语（国际音标）：[aɪ kæn iːt glɑːs ænd ɪt dɐz nɒt hɜːt miː]（标准发音）英语（盲文）：⠊⠀⠉⠁⠝⠀⠑⠁⠞⠀⠛⠇⠁⠞⠎⠀⠁⠝†⠙⠀⠀⠊ ⠕⠑⠎⠝⠞⠀⠓⠥⠗⠞⠀⠍⠑ 牙买加人：Mi kian niam glas han i neba hot mi。Lalland Scots / Doric：啊可以吃gless，它伤害了我们。格拉斯哥：（需要）哥特式（4）：̈，. 古诺尔斯语（符文）：ᛖᚴ ᚷᛖᛏ ᛖᛏᛁ ᚧ ᚷᛚᛖᚱ ᛘᚾ ᚦᛖᛋᛋ ᚨᚧ ᚡᛖ ᚱᚧᚨ ᛋᚨᚱ 古诺尔斯语（拉丁语）：Ek get etið gler án án 挪威/挪威（Nynorsk）：例如，kan eta glas utan å skada meg。Norsk / 挪威语 (Bokmål)：Jeg kan spise glass uten å skade meg。Føroyskt / 法罗语：例如 kann eta glas、skaðaleysur。Íslenska / 冰岛语：Ég get etið gler án þess að meiða mig。瑞典语/瑞典语：Jag kan äta glas utan att skada mig。丹麦/丹麦：Jeg kan spise glas, det gør ikke ondt på mig。Sønderjysk: Æ ka æe glass uhen at det go mæ naue。Frysk / Frisian：Ik kin glês ite，它让我感到很痛苦。荷兰语/荷兰语：Ik kan glas eten, het doet mĳ geen kwaad。Kirchröadsj/Bôchesserplat: Iech ken glaas èèse, mer 't deet miech jing pieng。南非荷兰语：Ek kan glas eet, maar dit doen my nie skade nie。Lëtzebuergescht / 卢森堡语：Ech kan Glas iessen, daat deet mir nët wei。Deutsch / German: Ich kann Glas essen, ohne mir zu schaden。Ruhrdeutsch: Ich kann Glas verkasematuckeln, ohne dattet mich wat jucken tut。Langenfelder Platt：Isch kann Jlaas kimmeln，uuhne datt mich datt weh dääd。Lausitzer Mundart（“Lusatian”）：Ich koann Gloos assn und doas dudd merr ni wii。Odenwälderisch: Iech konn glaasch voschbachteln ohne dass es mir ebbs daun doun dud。Sächsisch / Saxon: 'sch kann Gloss essn, ohne dass'sch mer wehtue。Pfälzisch: Isch konn Glass fresse ohne dasses mer ebbes ausmache dud。Schwäbisch / Swabian: I kå Glas frässa, ond des macht mr nix！Deutsch (Voralberg): I ka glas eassa, ohne dass mar weh tuat。Bayrisch / Bavarian: I koh Glos esa, und es duard ma ned wei。Allemannisch：我 kaun Gloos essen，es tuat ma ned weh。Schwyzerdütsch (苏黎世): Ich chan Glaas ässe, das schadt mir nöd。Schwyzerdütsch (卢塞恩): Ech cha Glâs ässe, das schadt mer ned。Plautdietsch：（需要）匈牙利语：Meg tudom enni az üveget，nem lesz tőle bajom。Suomi / 芬兰语：Voin syödä lasia, se ei vahingoita minua。萨米语（北部）：Sáhtán borrat lása, dat ii leat bávččas。Erzian: Мон ярсан суликадо, ды зыян эйстэнзэ а ули。北卡累利阿：Mie voin syvvä lasie ta minla ei ole kipie。南卡累利阿语：Minä voin syvvä st'oklua dai minule ei ole kibie。Vepsian：（需要） Votian：（需要）Livonian：（需要）爱沙尼亚：Ma võin klaasi süüa，见 ei tee mulle midagi。拉脱维亚语：Es varu ēst stiklu, tas man nekaitē。立陶宛语：Aš galiu valgyti stiklą ir jis manęs nežeidžia 古普鲁士语：(NEEDED) Sorbian (Wendish)：(NEEDED) 捷克语：Mohu jíst sklo, neublíží mi. 斯洛伐克语：Môžem jesť sklo。内兹拉尼玛。Polska / 波兰语：Mogę jeść szkło i mi nie szkodzi。斯洛文尼亚语：Lahko jem steklo，ne da bi mi škodovalo。克罗地亚语：Ja mogu jesti staklo i ne boli me。塞尔维亚语（拉丁语）：Ja mogu da jedem staklo。塞尔维亚语（西里尔文）：Ја могу да једем стакло。马其顿语：Можам да јадам стакло, а не ме штета。俄语：Я могу есть стекло, оно мне не вредит。白俄罗斯语（西里尔文）：Я магу есці шкло, яно мне не шкодзіць。白俄罗斯语（Lacinka）：Ja mahu jeści škło，jano mne ne škodzić。乌克兰语：Я можу їсти скло, і воно мені не зашкодить。保加利亚语：Мога да ям стъкло, то не ми вреди。格鲁吉亚语：მინას ვჭამ და არა მტკივა。亚美尼亚语： Կրնամ ապակի ուտել և ինծի անհանգիստ չըներ։ 阿尔巴尼亚语：Unë mund të ha qelq dhe nuk më gjen gjë。土耳其语：Cam yiyebilirim、bana zararı dokunmaz。土耳其语（奥斯曼）：جامييةبلورمبیافررررفیوقونمةBangla / Bengali：আমিকাঁচখেতেখেতে，তাতেআমারকোনোক্ষতিহয়。马拉地语：मी काच खाऊ शकतो、मला ते दुखत नाही。卡纳达语：ನನಗೆ ಹಾನಿ ಆಗದೆ, ನಾನುಗಜನ್ನುತಿನಬಹುದುhindi：मैंकाँचखासकताहूँऔरमुझेकोईचोटनहींपहुंचती。泰米尔：நான்கண்ணாடிசாப்பிடுவேன்，அதனால்எனக்குஒருகேடும்வராது。Telugu：నేనుగాజుతినగలనుమరియుఅలాచేసినానాకుఇబ్బందిలేదుsinhalese：මටමටකෑමටහැකියි。එයින් මට කිසි හානියක් 乌尔都语 (3): Pashto（3）：زهشيشهشهوړلیکم，هغهمانیهوږويfarsi / persian（3）：。منمهتوانمبیوناحسایکریکيدبیورم阿拉伯语（3）：فنازادرعلىفلالفایوهالايؤلمني。阿拉姆语：（需要）马耳他语：Nista' niekol il-ħġieġ u ma jagħmilli xejn。希伯来语（3）：אני יכול לאכול זכוכית וזה לא מזיק לי。意第绪语（3）： איך קען עסן גלאָז און עס טוט מיר נישט װײ。犹太阿拉伯语：（需要）拉丁语：（需要）Gǝʼǝz：（需要）阿姆哈拉语：（需要）Twi：Metumi awe tumpan，ɜnyɜ me hwee。豪萨语（拉丁语）：Inā iya taunar gilāshi kuma 在 gamā lāfiyā。豪萨语 (Ajami) (2): إِنا إِىَ تَونَر غِلَاشِ كُمَ إِن غَمَا لَافِىَا 约鲁巴语(4): Mo lè je̩ dígí, kò ní pa mi lára。林加拉语：Nakokí kolíya biténi bya milungi, ekosála ngáí mabé tɛ́。(Ki)斯瓦希里语：Naweza kula bilauri na sikunyui。马来语：Saya boleh makan kaca dan ia tidak mencederakan saya。他加禄语：印地语 ako masaktan 的 Kaya kong kumain nang bubog。查莫罗：Siña yo' chumocho krestat, ti ha na'lalamen yo'。斐济：Au rawa ni kana iloilo，ia au sega ni vakacacani kina。爪哇语：Aku isa mangan beling tanpa lara。缅甸语：က်ယ်ဝန်‌တော်‌၊က်ယ်ဝန်‌မ မ်ယက်‌စားနိုင်‌သည်‌။ ၎င်းက်ရောင့်‌ ထိခိုက်‌မ်ဟု မရ်ဟိပာ။ (9) 越南语 (quốc ngữ)：Tôi có thể ăn thủy tinh mà không hại gì。越南语 (nôm) (4): 些世咹 水晶空害 嘿 高棉语: ខ្ញុំអាចញុំកញ្ចក់បាន ដោយគ្មានបញ្ន 天天快报 泰语：ฉันกินกระจกได้แต่มันไม่ให้ฉันเจ็บ蒙古（西里尔西克）：бишилидюйчадна，Нададхортойбиш蒙古（经典）（5）:(必需的）Nepali：मकाँच खान सक्छू र मलाई केहि नी हुन्‍न् । 藏语：ཤེལ་སྒོ་ཟ་ནས་ང་ན་གི་མ་རེད། 中文：我能吞下玻璃而不伤身体。 中文（繁体）：我能吞下玻璃而不伤身体。日文：私はガラスを食べられます。それは私を伤つけません。 韩文：나는 유리를 먹을 수 있어요。그래도 아프지 않아요 Bislama: Mi save kakae glas, hemi no save katem mi。夏威夷语：Hiki ia'u ke ʻai i ke aniani；'a'ole no lā au e 'eha。Marquesan: E koʻana e kai i te karahi, mea ʻā, ʻaʻe hauhau。因纽特语 (10)：ᐊᓕᒍᖅ ᓂᕆᔭᕌᖓᒃᑯ ᓱᕋᙱᑦᑐᓐᓇᖅᑐᖓ 支奴干术语：Naika məkmək kakshət labutay，pi weyk ukuk munk-sik nay。纳瓦霍：Tsésǫʼ yishą́ągo bííníshghah dóó doo shił neezgai da. 切诺基语（以及 Cree、Chickasaw、Cree、Micmac、Ojibwa、Lakota、Náhuatl、Quechua、Aymara 和其他美国语言）：（需要）Garifuna：（需要）Gullah：（需要）Lojban：mi kakne le nu citka le blaci。 iku'i le se go'i na xrani mi Nórdicg: Ljœr ye caudran créneþ ý jor cẃran。

我得到了这个：

`com.mysql.jdbc.MysqlDataTruncation: Data truncation: Data too long for column`

为了确保这不是文本长度的问题，我存储了[此页面](http://en.wikipedia.org/wiki/Google)中包含的全文......它的长度比我在上面粘贴的文本长......这很有效。它被存储没有任何问题。

有谁知道是什么问题？

**编辑 ：**

如何检查我的 UTF-8 数据是否都是 3 字节 Unicode？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:10:52.390

是的，问题似乎是因为非 utf8 内容。我能够在具有字段类型的列中放置相同的文本：没有此数据的文本：ᠪᠢ ᠰᠢᠯᠢ ᠢᠳᠡᠶᠦ ᠴᠢᠳᠠᠨᠠ ᠂ ᠨᠠᠳᠤᠷ ᠬᠣᠤᠷᠠᠳᠰᠢ ᠪᠢ

请在执行插入查询之前尝试触发以下查询：

```
set names "utf8"; 
```

还将这些行添加到 my.cnf 或 my.ini：

```
 [client]
default-character-set=utf8

 [mysql]
 default-character-set=utf8

 [mysqld]
 default-character-set=utf8
 character-set-server=utf8 
```

希望这有帮助。

**这是正文**

梵文：काचं शक्नोम्यत्तुम् । नोपहिनस्ति माम् ॥ 梵文（标准转录）：kācaṃ śaknomyattum；nopahinasti 妈妈。古希腊语：ὕαλον φαγεῖν δύναμαι· τοῦτο οὔ με βλάπτει。希腊语（单调）：Μπορώ να φάω σπασμένα γυαλιά χωρίς να πάθω τίποτα。希腊语（多调）：Μπορῶ νὰ φάω σπασμένα γυαλιὰ χωρὶς νὰ πάθω τίποτα。伊特鲁里亚语：（需要）拉丁语：Vitrum edere possum；mihi non nocet。古法语： Je puis mangier del voirre。不用我了。法语：Je peux manger du verre，ça ne me fait pas mal。Provençal / Occitan: Pòdi manjar de veire, me nafraria pas. Québécois: J''peux manger d''la vitre, ça m''fa pas mal。瓦隆： Dji pou magnî do vêre, çoula m'' freut nén må。Champenois：（需要）Lorrain：（需要）Picard：Ch''peux mingi du verre，cha m''foé mie n''ma。科西嘉/科苏：（需要）Jèrriais：(需要) Kreyòl Ayisyen (海地): Mwen kap manje vè, li pa blese''m。巴斯克语：Kristala jan dezaket，ez dit minik ematen。加泰罗尼亚语/加泰罗尼亚语：Puc menjar vidre, que no em fa mal。西班牙语：Puedo comer vidrio，no me hace daño。阿拉贡内斯： Puedo minchar beire，不是我的家人。Aranés：（需要） Mallorquín：（需要）加利西亚语：Eu podo xantar cristais e non cortarme。欧洲葡萄牙语：Posso comer vidro, não me faz mal。巴西葡萄牙语 (8)：Posso comer vidro, não me machuca。Caboverdiano/Kabuverdianu（佛得角）：M'' podê cumê vidru, ca ta maguâ-m''。Papiamentu: Ami por kome glas anto e no ta hasimi daño。意大利语：Posso mangiare il vetro e non mi fa male。米兰人：Sôn bôn de magnà el véder, el me fa Minga mal。Roman: Me posso magna'' er vetro, e nun me fa male。Napoletano: M'' pozz magna'' o' 'vetr, e nun m'' fa mal. 威尼斯人： Mi posso magnare el vetro，不是我的前任。Zeneise (Genovese): Pòsso mangiâ o veddro eo no me fà mâ。西西里语：Puotsu mangiari u vitru，nun mi fa mali。Campinadese (Sardinia): (NEEDED) Lugudorese (Sardinia): (NEEDED) Romansch (Grischun): Jau sai mangiar vaider, senza che quai fa donn a mai。Romany / Tsigane：（需要）罗马尼亚语：Pot să mănânc sticlă și ea nu mă răneşte。世界语： Mi povas manĝivivon, ĝi ne damaĝas min. 皮克特语：（需要）布列塔尼语：（需要）康沃尔语：Mý a yl dybry gwéder hag éf ny wra ow ankenya。威尔士语：Dw i''n gallu bwyta gwydr，''dyw e ddim yn gwneud dolur i mi。马恩岛盖尔语：Foddym gee glonney agh cha jean eh gortaghey mee。古爱尔兰语（Ogham）：᚛᚛ᚉᚑᚅᚔᚉᚉᚔᚋ ᚔᚈᚔ ᚍᚂᚐᚅᚑ ᚅᚔᚋᚌᚓᚅᚐ᚜ 古爱尔兰语（拉丁语）：Con·iccim ithi nglano。尼姆·热那。爱尔兰语：féidir liom gloinne 是 ithe。Ní dhéanann sí dochar ar bith dom。阿尔斯特盖尔语：Ithim-sa gloine agus ní miste damhé。苏格兰盖尔语：S urrainn dhomh gloinne ithe；cha ghoirtich i mi。盎格鲁-撒克逊语（符文）：盎格鲁-撒克逊语（拉丁语）：Ic mæg glæs eotan ond hit ne heartiað me。中古英语：Ich canne glas eten 和 hit hirtiþ me nouȝt。Chinese: 我可以吃玻璃，它不会伤害我。英语（国际音标）：[aɪ kæn iːt glɑːs ænd ɪt dɐz nɒt hɜːt miː]（标准发音）英语（盲文）：⠊⠀⠉⠁⠝⠀⠑⠁⠞⠀⠛⠇⠁⠞⠎⠀⠁⠝†⠙⠀⠀⠊ ⠕⠑⠎⠝⠞⠀⠓⠥⠗⠞⠀⠍⠑ 牙买加人：Mi kian niam glas han i neba hot mi。Lalland Scots / Doric：啊可以吃gless，它伤害了我们。格拉斯哥语：（需要）哥特语（4）：古诺尔斯语（拉丁语）：Ek get etið gler án þess að verða sár。挪威/挪威（Nynorsk）：例如 kan eta glas utan å skada meg。Norsk / 挪威语 (Bokmål)：Jeg kan spise glass uten å skade meg。Føroyskt / 法罗语：例如 kann eta glas、skaðaleysur。Íslenska / 冰岛语：Ég get etið gler án þess að meiða mig。瑞典语/瑞典语：Jag kan äta glas utan att skada mig。丹麦/丹麦：Jeg kan spise glas, det gør ikke ondt på mig。Sønderjysk: Æ ka æe glass uhen at det go mæ naue。Frysk / Frisian：Ik kin glês ite，它让我感到很痛苦。荷兰语/荷兰语：Ik kan glas eten, het doet mĳ geen kwaad。Kirchröadsj/Bôchesserplat: Iech ken glaas èèse, mer ''t deet miech jing pieng。南非荷兰语：Ek kan glas eet, maar dit doen my nie skade nie。Lëtzebuergescht / 卢森堡语：Ech kan Glas iessen, daat deet mir nët wei。Deutsch / German: Ich kann Glas essen, ohne mir zu schaden。Ruhrdeutsch: Ich kann Glas verkasematuckeln, ohne dattet mich wat jucken tut。Langenfelder Platt：Isch kann Jlaas kimmeln，uuhne datt mich datt weh dääd。劳西泽·蒙德特（“卢萨蒂安”）：Ich koann Gloos assn und doas dudd merr ni wii。Odenwälderisch: Iech konn glaasch voschbachteln ohne dass es mir ebbs daun doun dud。Sächsisch / Saxon: ''sch kann Gloss essn, ohne dass''sch mer wehtue。Pfälzisch: Isch konn Glass fresse ohne dasses mer ebbes ausmache dud。Schwäbisch / Swabian: I kå Glas frässa, ond des macht mr nix！Deutsch (Voralberg): I ka glas eassa, ohne dass mar weh tuat。Bayrisch / Bavarian: I koh Glos esa, und es duard ma ned wei。Allemannisch：我 kaun Gloos essen，es tuat ma ned weh。Schwyzerdütsch (苏黎世): Ich chan Glaas ässe, das schadt mir nöd。Schwyzerdütsch (卢塞恩): Ech cha Glâs ässe, das schadt mer ned。Plautdietsch：（需要）匈牙利语：Meg tudom enni az üveget，nem lesz tőle bajom。Suomi / 芬兰语：Voin syödä lasia, se ei vahingoita minua。萨米语（北部）：Sáhtán borrat lása, dat ii leat bávččas。Erzian: Мон ярсан суликадо, ды зыян эйстэнзэ а ули。北卡累利阿：Mie voin syvvä lasie ta minla ei ole kipie。南卡累利阿：Minä voin syvvä st''oklua dai minule ei ole kibie。Vepsian：（需要） Votian：（需要）Livonian：（需要）爱沙尼亚：Ma võin klaasi süüa，见 ei tee mulle midagi。拉脱维亚语：Es varu ēst stiklu, tas man nekaitē。立陶宛语：Aš galiu valgyti stiklą ir jis manęs nežeidžia 古普鲁士语：(NEEDED) Sorbian (Wendish)：(NEEDED) 捷克语：Mohu jíst sklo, neublíží mi. 斯洛伐克语：Môžem jesť sklo。内兹拉尼玛。Polska / 波兰语：Mogę jeść szkło i mi nie szkodzi。斯洛文尼亚语：Lahko jem steklo，ne da bi mi škodovalo。克罗地亚语：Ja mogu jesti staklo i ne boli me。塞尔维亚语（拉丁语）：Ja mogu da jedem staklo。塞尔维亚语（西里尔文）：Ја могу да једем стакло。马其顿语：Можам да јадам стакло, а не ме штета。俄语: Я могу есть стекло, оно мне не вредит。白俄罗斯语（西里尔文）：Я магу есці шкло, яно мне не шкодзіць。白俄罗斯语（Lacinka）：Ja mahu jeści škło，jano mne ne škodzić。乌克兰语：Я можу їсти скло, і воно мені не зашкодить。保加利亚语：Мога да ям стъкло, то не ми вреди。格鲁吉亚语：მინას ვჭამ და არა მტკივა。亚美尼亚语： Կրնամ ապակի ուտել և ինծի անհանգիստ չըներ։ 阿尔巴尼亚语：Unë mund të ha qelq dhe nuk më gjen gjë。土耳其语：Cam yiyebilirim、bana zararı dokunmaz。土耳其语（奥斯曼）：جامييةبلورمبیافررررفیوقونمةBangla / Bengali：আমিকাঁচখেতেখেতে，তাতেআমারকোনোক্ষতিহয়。马拉地语：मी काच खाऊ शकतो、मला ते दुखत नाही。kannada：ನನಗೆಹಾನಿಆಗದೆ，ನಾನುಗಜನ್ನುತಿನಬಹುದುhindi：मैंकाँचखासकताहूँऔरमुझेउससेचोटनहींपहुंचती。泰米尔：நான்கண்ணாடிசாப்பிடுவேன்，அதனால்எனக்குஒருகேடும்வராது。Telugu：నేనునేనుగాజుతినగలనుమరియుఅలాఅలాచేసినాఏమిఇబ్బందిలేదులేదులేదులేదులేదు：මට වීදුරු කෑමට හැකියි。එයින් මට කිසි හානියක් 乌尔都语 (3): Pashto（3）：زهشيشهشهوړلیکم，هغهمانیهوږويfarsi / persian（3）：。منمهتوانمبیوناحسایکریکيدبیورم阿拉伯语（3）：فنازادرعلىفلالفایوهالايؤلمني。阿拉姆语：（需要）马耳他语：Nista'' niekol il-ħħġieġ u ma jagħmilli xejn。希伯来语（3）：אני יכול לאכול זכוכית וזה לא מזיק לי。意第绪语（3）： איך קען עסן גלאָז און עס טוט מיר נישט װײ。犹太阿拉伯语：（需要）拉丁语：（需要）Gǝʼǝz：（需要）阿姆哈拉语：（需要）Twi：Metumi awe tumpan，ɜnyɜ me hwee。豪萨语（拉丁语）：在 gamā lāfiyā 中的 Inā iya taunar gilāshi kuma。豪萨语 (Ajami) (2): إِنا إِىَ تَونَر غِلَاشِ كُمَ إِن غَمَا لَافِىَا 约鲁巴语(4): Mo lè je̩ dígí, kò ní pa mi lára。林加拉语：Nakokí kolíya biténi bya milungi, ekosála ngáí mabé tɛ́。(Ki)斯瓦希里语：Naweza kula bilauri na sikunyui。马来语：Saya boleh makan kaca dan ia tidak mencederakan saya。他加禄语：印地语 ako masaktan 的 Kaya kong kumain nang bubog。查莫罗：Siña yo'' chumocho krestat, ti ha na''lalamen yo''。斐济：Au rawa ni kana iloilo，ia au sega ni vakacacani kina。爪哇语：Aku isa mangan beling tanpa lara。缅甸语：က်ယ်ဝန်‌တော်‌၊က်ယ်ဝန်‌မ မ်ယက်‌စားနိုင်‌သည်‌။ ၎င်းက်ရောင့်‌ ထိခိုက်‌မ်ဟု မရ်ဟိပာ။ (9) 越南语 (quốc ngữ)：Tôi có thể ăn thủy tinh mà không hại gì。越南（Nôm）（4）：些世咹水晶空咦咦អាចញុំកញ្ចក់បានគ្មានររររ:រຍບໍ່ຍເຮັດຍ້ຍ 泰语：ฉันกินกระจกได้แต่มันไม่ให้ฉันเจ็บ蒙古语（西里尔西克）：бишилидюйчадна，Нададхортойбиш蒙古（经典）（5）（5）（5）（需要）尼泊尔：尼泊尔：藏语：ཤེལ་སྒོ་ཟ་ནས་ང་ན་གི་མ་རེད། 中国人：我能吞下玻璃伤身体。 中文（繁体）：我能吞下玻璃而不伤身体。日文：私はガラスを食べられます。それは私を伤つけません。 韩文：나는 유리를 먹을 수 있어요。그래도 아프지 않아요 Bislama: Mi save kakae glas, hemi no save katem mi。夏威夷语：Hiki ia'u ke ʻai i ke aniani；'a'ole no lā au e 'eha。Marquesan: E koʻana e kai i te karahi, mea ʻā, ʻaʻe hauhau。因纽特语 (10)：ᐊᓕᒍᖅ ᓂᕆᔭᕌᖓᒃᑯ ᓱᕋᙱᑦᑐᓐᓇᖅᑐᖓ 支奴干术语：Naika məkmək kakshət labutay，pi weyk ukuk munk-sik nay。纳瓦霍语：Tsésǫʼ yishą́ągo bííníshghah dóó doo shił neezgai da。切罗基语（以及 Cree、Chickasaw、Cree、Micmac、Ojibwa、Lakota、Náhuatl、Quechua、Aymara 和其他美国语言）：（需要）Garifuna：（需要）Gullah：（需要）Lojban：mi kakne le nu citka le blaci。 iku''i le se go''i na xrani mi Nórdicg: Ljœr ye caudran créneþ ý jor cẃran。台湾语(6)：Góa ē-tàng chia̍h po-lê, mā bē tio̍h-song. 我能吞下玻璃伤身体。日文：私はガラスを食べられます。それは私を伤つけません。 韩文：나는 유리를 먹을 수 있어요。그래도 아프지 않아요 Bislama: Mi save kakae glas, hemi no save katem mi。夏威夷语：Hiki ia'u ke ʻai i ke aniani；'a'ole no lā au e 'eha。Marquesan: E koʻana e kai i te karahi, mea ʻā, ʻaʻe hauhau。因纽特语 (10)：ᐊᓕᒍᖅ ᓂᕆᔭᕌᖓᒃᑯ ᓱᕋᙱᑦᑐᓐᓇᖅᑐᖓ 支奴干术语：Naika məkmək kakshət labutay，pi weyk ukuk munk-sik nay。纳瓦霍语：Tsésǫʼ yishą́ągo bííníshghah dóó doo shił neezgai da。切诺基语（以及 Cree、Chickasaw、Cree、Micmac、Ojibwa、Lakota、Náhuatl、Quechua、Aymara 和其他美国语言）：（需要）Garifuna：（需要）Gullah：（需要）Lojban：mi kakne le nu citka le blaci。 iku''i le se go''i na xrani mi Nórdicg: Ljœr ye caudran créneþ ý jor cẃran。台湾语(6)：Góa ē-tàng chia̍h po-lê, mā bē tio̍h-song. 我能吞下玻璃伤身体。日文：私はガラスを食べられます。それは私を伤つけません。 韩文：나는 유리를 먹을 수 있어요。그래도 아프지 않아요 Bislama: Mi save kakae glas, hemi no save katem mi。夏威夷语：Hiki ia'u ke ʻai i ke aniani；'a'ole no lā au e 'eha。Marquesan: E koʻana e kai i te karahi, mea ʻā, ʻaʻe hauhau。因纽特语 (10)：ᐊᓕᒍᖅ ᓂᕆᔭᕌᖓᒃᑯ ᓱᕋᙱᑦᑐᓐᓇᖅᑐᖓ 支奴干术语：Naika məkmək kakshət labutay，pi weyk ukuk munk-sik nay。纳瓦霍语：Tsésǫʼ yishą́ągo bííníshghah dóó doo shił neezgai da。切诺基语（以及 Cree、Chickasaw、Cree、Micmac、Ojibwa、Lakota、Náhuatl、Quechua、Aymara 和其他美国语言）：（需要）Garifuna：（需要）Gullah：（需要）Lojban：mi kakne le nu citka le blaci。 iku''i le se go''i na xrani mi Nórdicg: Ljœr ye caudran créneþ ý jor cẃran。私はガラスを食べられます。それは私を伤つけません。 韩语：나는 유리를 먹을 수 있어요。그래도 아프지 않아요 Bislama: Mi save kakae glas, hemi no save katem mi。夏威夷语：Hiki ia'u ke ʻai i ke aniani；'a'ole no lā au e 'eha。Marquesan: E koʻana e kai i te karahi, mea ʻā, ʻaʻe hauhau。因纽特语 (10)：ᐊᓕᒍᖅ ᓂᕆᔭᕌᖓᒃᑯ ᓱᕋᙱᑦᑐᓐᓇᖅᑐᖓ 支奴干术语：Naika məkmək kakshət labutay，pi weyk ukuk munk-sik nay。纳瓦霍语：Tsésǫʼ yishą́ągo bííníshghah dóó doo shił neezgai da。切诺基语（以及 Cree、Chickasaw、Cree、Micmac、Ojibwa、Lakota、Náhuatl、Quechua、Aymara 和其他美国语言）：（需要）Garifuna：（需要）Gullah：（需要）Lojban：mi kakne le nu citka le blaci。 iku''i le se go''i na xrani mi Nórdicg: Ljœr ye caudran créneþ ý jor cẃran。私はガラスを食べられます。それは私を伤つけません。 韩语：나는 유리를 먹을 수 있어요。그래도 아프지 않아요 Bislama: Mi save kakae glas, hemi no save katem mi。夏威夷语：Hiki ia'u ke ʻai i ke aniani；'a'ole no lā au e 'eha。Marquesan: E koʻana e kai i te karahi, mea ʻā, ʻaʻe hauhau。因纽特语 (10)：ᐊᓕᒍᖅ ᓂᕆᔭᕌᖓᒃᑯ ᓱᕋᙱᑦᑐᓐᓇᖅᑐᖓ 支奴干术语：Naika məkmək kakshət labutay，pi weyk ukuk munk-sik nay。纳瓦霍语：Tsésǫʼ yishą́ągo bííníshghah dóó doo shił neezgai da。切诺基语（以及 Cree、Chickasaw、Cree、Micmac、Ojibwa、Lakota、Náhuatl、Quechua、Aymara 和其他美国语言）：（需要）Garifuna：（需要）Gullah：（需要）Lojban：mi kakne le nu citka le blaci。 iku''i le se go''i na xrani mi Nórdicg: Ljœr ye caudran créneþ ý jor cẃran。'a'ole no lā au e 'eha。Marquesan: E koʻana e kai i te karahi, mea ʻā, ʻaʻe hauhau。因纽特语 (10)：ᐊᓕᒍᖅ ᓂᕆᔭᕌᖓᒃᑯ ᓱᕋᙱᑦᑐᓐᓇᖅᑐᖓ 支奴干术语：Naika məkmək kakshət labutay，pi weyk ukuk munk-sik nay。纳瓦霍语：Tsésǫʼ yishą́ągo bííníshghah dóó doo shił neezgai da。切诺基语（以及 Cree、Chickasaw、Cree、Micmac、Ojibwa、Lakota、Náhuatl、Quechua、Aymara 和其他美国语言）：（需要）Garifuna：（需要）Gullah：（需要）Lojban：mi kakne le nu citka le blaci。 iku''i le se go''i na xrani mi Nórdicg: Ljœr ye caudran créneþ ý jor cẃran。'a'ole no lā au e 'eha。Marquesan: E koʻana e kai i te karahi, mea ʻā, ʻaʻe hauhau。因纽特语 (10)：ᐊᓕᒍᖅ ᓂᕆᔭᕌᖓᒃᑯ ᓱᕋᙱᑦᑐᓐᓇᖅᑐᖓ 支奴干术语：Naika məkmək kakshət labutay，pi weyk ukuk munk-sik nay。纳瓦霍语：Tsésǫʼ yishą́ągo bííníshghah dóó doo shił neezgai da。切诺基语（以及 Cree、Chickasaw、Cree、Micmac、Ojibwa、Lakota、Náhuatl、Quechua、Aymara 和其他美国语言）：（需要）Garifuna：（需要）Gullah：（需要）Lojban：mi kakne le nu citka le blaci。 iku''i le se go''i na xrani mi Nórdicg: Ljœr ye caudran créneþ ý jor cẃran。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:16:46.620

`my.ini`在 MySQL 安装目录下的文件中添加以下行。

```
[mysqld]                     # already exists
max_allowed_packet=1024M     # just add this line, you can set size whatever you want.

# Also set this
default-character-set=utf8 
```

您必须重新启动mysql服务。

检查[MySQL 文档](http://dev.mysql.com/doc/refman//5.5/en/packet-too-large.html)

# email - 发送自动生成的密码”复选框什么都不做？

> ID：11543004
> 
> 赞同：1
> 
> 时间：2012-07-18T13:52:05.863
> 
> 标签：email, magento, passwords, admin, magento-1.7

管理员中的“发送自动生成的密码”复选框什么都不做？它不会通过电子邮件将自动生成的密码发送给客户！

如何使它工作？（我使用的是 Magento v1.7）

# java - 验证文本之间 使用硒

> ID：11543010
> 
> 赞同：2
> 
> 时间：2012-07-18T13:52:20.060
> 
> 标签：java, selenium, webdriver, selenium-chromedriver

我需要验证网页上的特定插槽是否已加载。我正在`main()`为此使用 Selenium WebDriver（我应该使用 JUnit 测试用例吗？）。

有什么方法可以在`<div>`具有特定 ID 的任何人之间检索文本？

如果给出[这个页面](http://ideone.com/TK8Mk)：

```
<div id="center-2" class="promo">
    <div class="unified_widget rcmBody">
        <span class="logo"><img src="someimage.gif" /></span>
        <span class="headline">Make money by Selling items on Amazon</span>
        <span class="link"><a href="/content/sell-on-amazon.htm">Selling On Amazon</a></span>
        <span class="body">Sell your items on Amazon.com. Amazon can help you grow your business and reach more customers.</span>
        <div class="h_rule"></div>
    </div>
</div> 
```

当`<div id = center-2>`给出时，我需要提取

“通过在亚马逊上销售商品赚钱”、
“在亚马逊上销售”、
“在 Amazon.com 上销售您的商品。亚马逊可以帮助您发展业务并吸引更多客户。”

我应该使用哪种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:05:45.023

为确保元素已加载，请使用[隐式和显式等待](http://seleniumhq.org/docs/04_webdriver_advanced.html#explicit-and-implicit-waits)。

通常，当您需要与元素交互时，隐式等待就足够了。设置后，它将用于每个元素查找。根据我的经验，这对于 95% 的情况来说已经足够了。

```
driver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS); 
```

如果您需要一些更高级的等待（或只使用一次等待），则可以使用显式等待。

* * *

有三种常用的方法来检索具有`id`我所知道的特定元素的元素：

1.  首选方式：

    ```
    driver.findElement(By.id("elemId")); 
    ```

2.  如果您需要从一个元素开始然后搜索其后代，这是一个好方法：

    ```
    driver.findElement(By.cssSelector("#elemId"));
    driver.findElement(By.xpath("id('elemId')")); 
    ```

3.  很多人使用的方式，因为他们对 XPath 很满意：

    ```
    driver.findElement(By.xpath("//*[@id='elemId']")); 
    ```

要了解有关[CSS 选择器](http://www.w3.org/TR/CSS/#selectors)和[XPath](http://www.w3.org/TR/xpath/)的更多信息，请参阅 Web 上的任何教程。

* * *

关于正文：

```
String text = driver.findElement(By.id("center-2")).getText();
System.out.println(text); 
```

输出

> 通过在亚马逊上销售商品赚钱 在亚马逊上销售 在 Amazon.com 上销售您的商品。亚马逊可以帮助您发展业务并吸引更多客户。

如果您想独立获得这三件事，请使用例如：

```
String headline = driver.findElement(By.cssSelector("#center-2 .headline")).getText();
System.out.println(headline);

String link = driver.findElement(By.cssSelector("#center-2 .link")).getText();
System.out.println(link);

String body = driver.findElement(By.cssSelector("#center-2 .body")).getText();
System.out.println(body); 
```

# android - 在 ListView 中显示数据库项目时，每次我更改标签时它都会成倍增加

> ID：11543012
> 
> 赞同：0
> 
> 时间：2012-07-18T13:52:22.073
> 
> 标签：android, sqlite

我有 3 个选项卡，在我的一个选项卡中，我有一个`ListView`从 SQLite 数据库中获取项目的选项卡。

问题是当我切换到其他选项卡并返回此选项卡时，我`ListView`正在显示数据库项目 2 次，并且每次更改选项卡时它都会成倍增加。

这是我的标签显示代码`ListView`：

```
public class MyActivity extends Fragment
{
   private ListView mListView;
   private DatabaseHandler db;
   List my = new ArrayList();
   MyListAdapter madapter ;

   //.....

   //...
   public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
   {
       MyItem i;
       LinearLayout mylayout = (LinearLayout) inflater.inflate(R.layout.my_layout, container, false);

       List<MyItem> l = db.getAllMyItem();

       while(!l.isEmpty() )
       {
           i = l.get(0);
           l.remove(0);
           my.add(new MyList(i.getName(),0));
       }

       mListView = (ListView) mylayout.findViewById(R.id.list);
       madapter = new MyListAdapter(getActivity(), my);

       mListView.setAdapter(madapter);
  } 
```

我知道这是我的`while`循环，它一次又一次地从数据库中获取结果，但是我能做些什么来显示我从数据库中检索到的结果一次，即使在更改选项卡并返回此`Fragment`选项卡之后也是如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:57:19.667

You never empty your list, so add this before the `while` loop:

```
my.clear(); 
```

Also I would change the loop as follows because you don't need to remove items from the `l` list.

```
for (MyItem i : l) {
     my.add(new MyList(i.getName(),0));
} 
```

# css - CSS/Ruby on Rails - 将列表分成三个独立的等宽列

> ID：11543015
> 
> 赞同：0
> 
> 时间：2012-07-18T13:52:32.277
> 
> 标签：css, html-lists

在使用 CSS 的 Ruby on Rails 视图中实现此类目标的最佳方法是什么：

**这就是我现在所拥有的：**

列表项 1 - 不太长 ![在此处输入图像描述](../Images/3b2182f0a7114c3f2f846f7443998b62.png) ![在此处输入图像描述](../Images/99909f833d41a57eaa027283fe738272.png)
列表项 2 - 非常非常长，我不希望“列”这么大；我希望它包装 ![在此处输入图像描述](../Images/3b2182f0a7114c3f2f846f7443998b62.png) ![在此处输入图像描述](../Images/99909f833d41a57eaa027283fe738272.png)
列表项 3 - 你好 ![在此处输入图像描述](../Images/3b2182f0a7114c3f2f846f7443998b62.png) ![在此处输入图像描述](../Images/99909f833d41a57eaa027283fe738272.png)

**这就是我要的：**
![在此处输入图像描述](../Images/f8371c30458902aeb6fb72a4ed95ed06.png)

列表项来自解决方案类；赞成/反对是来自 Solution_votes 类的投票。

理想情况下，我会使用一个包含 3 列的表，但是，我也使用 Axaj 和 JQuery 来更新并希望使用无序列表（使用 $('#items_list').prepend(new_item); 轻松更新）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:13:10.037

HTML：

```
<ul class="entries">
  <li>
    <span class="title">List Item 1 - is not too long</span>
    <a class="thumb down">0 Votes Down</a>
    <a class="thumb up">0 Votes Up</a><!-- float:right will place this to the left -->
  </li>
  ...
</ul> 
```

CSS：

```
ul.entries { list-style: none; }
ul.entries li {
  margin: 10px 0;
  border: 2px solid black;
  border-radius: 6px;
  width: 600px;
}
ul.entries .title {
  float: left;
  width: 380px;
}
ul.entries .thumb {
  float: right;
  margin-left: 20px;
  width: 90px;
  /* todo: color, background + padding-left declarations for thumb icons */
} 
```

# .net - 在 LINQ 中加入课程

> ID：11543016
> 
> 赞同：1
> 
> 时间：2012-07-18T13:52:32.837
> 
> 标签：.net, linq

我开始使用 LINQ，据我所知，为了使用连接查询，我需要手动创建返回类，该类将包含我连接的两个或多个表的混合值。

我的问题是，是否有人知道有助于自动创建这些加入类的工具。当桌子太大时手工操作是一项繁重的任务，对于维护人员来说，我认为这也很烦人。

提前致谢。

**编辑：**我需要能够使用强数据类型的类，因此在 VS 中使用智能感知，我对 LINQ 查询本身没有问题，只有连接类才能返回。我来自“数据集世界”，我的联接查询自动创建相应的数据表。

现在我使用 ASP.NET MVC，所以我的方法返回一个 IEnumerable<> 类型，该类型稍后将作为模型对象传递给 View，例如：

```
public IEnumerable<MyJoinClass> GetData(int clientID)
{      
    var query =
    from t1 in objDataContext.table1
    join t2 in objDataContext.table2 on
    new { t1.clientID } equals new { t2.clientID }
    where t1.clientID == clientID
    select new MyJoinClass()
    {   
        //here the fields I want to retrieve... 
        column1_From_Table1 = t1.column1, 
        column2_From_Table1 = t1.column2, 
        //etc...
    };

    //Return result   
    return query;
}

public class MyJoinClass
{        
    public short column1_From_Table1;
    public string column2_From_Table1;
    public short? column3_From_Table1;
    public int column1_From_Table2;
    public short? column2_From_Table2;
    public string column3_From_Table2;
    //lets imagine 50 columns... do I need to do all this stuff on my own?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:57:45.320

It's called "The Compiler". If will let you use an anonymous type, without needing a formal class definition.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:59:18.583

使用[Linqer](http://www.sqltolinq.com/)

使用此工具，您实际上可以编写 SQL，并且该工具会将其转换为 LINQ 结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:55:42.650

没有这样的工具 AFAIK，因为没有理由写一个。你真的总是想从连接表中返回所有字段吗？不见得。

您可能正在做的是内部连接以过滤掉记录并在链接表上添加约束。从数据库中获取所有列可能是一种资源浪费。

如果在代码中手动连接，您总是可以在数据库中创建一个**视图并查询它。**

# javascript - 如果在使用 IE 7 或 8 时隐藏，单击标签不检查复选框

> ID：11543021
> 
> 赞同：8
> 
> 时间：2012-07-18T13:52:46.557
> 
> 标签：javascript, jquery, checkbox, label, clickable

我正在尝试使用与复选框元素关联的标签并隐藏（显示：无）复选框来创建自定义设计的复选框。

这在除 IE 之外的所有浏览器中都可以正常工作，IE 需要复选框可见才能使标签可点击。

这是我的代码...

HTML

```
<input type="checkbox" id="myCheck" />​ 
```

CSS

```
label.checkbox {
    border:1px solid #666;
    width:25px;
    height:23px;
    display:block; 
}​ 
```

jQuery

```
$("input[type=checkbox]").each(function() {
    $(this).hide().before('<label for="' + $(this).attr("id") + '" class="checkbox"></label>');
});

$("input[type=checkbox]").live('change', function() {
    if ($(this).prop('checked') == true) {
        $('label[for=' + $(this).attr("id") + ']').html("X")
    } else {
        $('label[for=' + $(this).attr("id") + ']').html("")
    }
});​ 
```

或[jsfiddle](http://jsfiddle.net/many_tentacles/hR6yf/1/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-18T14:06:27.920

我不知道是否有更有效的方法可以做到这一点，但您可以通过将复选框元素位置设置在页面外来做到这一点，

```
.hiddenEl {
   position:absolute;
   top: -3000px;
}

$("input[type=checkbox]").each(function() {
    $(this).addClass("hiddenEl").before('<label for="' + $(this).attr("id") + '" class="checkbox"></label>');
}); 
```

[演示](http://jsfiddle.net/hR6yf/4/)

* * *

**更新**

您还可以将复选框不透明度设置为零，这将在没有“显示：无”的情况下隐藏它，

```
$(this).css("opacity", 0) 
```

或者

```
$(this).fadeTo(0, 0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:09:22.240

试试这个：

```
#myCheck{
  position:absolute;
  left:-9999px;
  } 
```

并保留复选框“可见”

# c - 使用管道进行 IPC

> ID：11543024
> 
> 赞同：1
> 
> 时间：2012-07-18T13:52:57.940
> 
> 标签：c, unix, ipc, pipe

我目前正在学习IPC，我有第一个程序

A：为 B 执行 exec 并等待

B：通过fifo接收来自第三个程序“C”的字符串，并且必须将其重新发送给A

我想在执行之前在 A 中打开一个管道，然后将 fd[1] 作为参数传递给 B

```
if(pipe(fd)==-1){
    perror("Pipe Failed");
    myExit(EXIT_FAILURE);
}

close(fd[1]);   
sprintf(fdString,"%d",fd[1]);

    .......

if((int)(pid=fork())>0)

    waiting(status);    

else if(pid==0){    

    close(fd[0]);   

    execl("./B","B",fdString,(char*)0);
    perror("Exec failed");
    myExit(EXIT_FAILURE);

} 
```

然后在 B 中：

```
int fd=atoi(argv[1]);

    //Receive string from C 

    len=strlen(string)+1;

if(write(fd,&len,sizeof(int))==-1){
    perror("Error on writing length");
    exit(EXIT_FAILURE); 
}

if(write(fd,string,len)==-1){
    perror("Error on writing string");
    exit(EXIT_FAILURE);     
} 
```

我现在的问题是在 A 中读取此字符串。我正在考虑将 SIGUSR1 发送到 A，只要字符串由 B 在管道上写入并在 A 中具有类似的内容：

```
signal(SIGUSR1, signalHandler);
    ........
    static void signalHandler(int signo){
    switch(signo){
    case SIGUSR1:
        listen();
        break;
    default: break;

    }
}
    ........
static void listen(){

    int len;

    if(read(fd[0],&len,sizeof(int))<sizeof(int)){
        perror("Error reading len");
        myExit(EXIT_FAILURE);   
    }

    char string[len];

    if(read(fd[0],&string,len)<len){
        perror("Error reading string");
        myExit(EXIT_FAILURE);   
    }
    printf("String: %s with length %d\n", string, len);
} 
```

但是我得到的是 *"Error reading len: Success"*，怎么了？

对不起，如果我的英语不好，任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:16:25.530

由于这一行，写入字符串的程序很可能出现*段错误*：

```
if(write(fd,&string,len)==-1) { /* ... */ 
```

正如你应该通过`string` **而**没有`&`.

另一方面，您的错误消息信息量不大，因为`read()`可能返回 0 或小于`sizeof(int)`字节。`errno`只有当返回值为 时才会设置`-1`。`read()`返回 0 或小于预期的事实通常意味着*文件结束*条件，即另一端已关闭管道。

在尝试进一步挖掘之前，您应该解决这些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T22:23:10.250

我自己回答，因为我实际上已经解决了我自己的问题：

我在 fork() 之前关闭了 fd[1]，这将导致 fd[1] 关闭的孩子（导致读取错误！）正如 Ethanol (C2H5OH ;)) 所说。

我接受了他的回答，因为它让我找到了解决方案！

# ios - Ios本地化不起作用

> ID：11543025
> 
> 赞同：3
> 
> 时间：2012-07-18T13:52:59.810
> 
> 标签：ios, localization, nslocalizedstring

我正在运行 XCode 版本 4.3.3 和 iOS 5.1。我可以做我想做的。我无法运行本地化。我通过项目文件添加了不同的语言。我调整了每种语言的 InfoPlist.strings，如下所示：

```
"key" = "value"; 
```

我到处都有：

```
NSLocalizedString(@"key", nil); 
```

没有键与它的值相同。我检查了选择的语言：

```
NSString * language = [[NSLocale preferredLanguages] objectAtIndex:0]; 
```

### 但是当我运行该应用程序时，该应用程序总是只显示键而没有任何价值。

### 我没有主意了

我尝试按照此处所述删除和清理所有内容： [本地化不起作用](https://stackoverflow.com/questions/3061334/localization-not-working)

我尝试复制此处描述的文件： [NSLocalizedString Problem](https://stackoverflow.com/questions/4297051/nslocalizedstring-problem)

所有文件都在他们的语言文件夹中： [iPhone：NSLocalizedString 从英文 .strings 文件读取，即使设置了另一个语言](https://stackoverflow.com/questions/2971513/iphone-nslocalizedstring-reading-from-english-strings-file-even-when-another-l)

有人知道我还能做什么吗？！？我不知道我做错了什么？！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T13:57:14.540

Do you have a Localizable.strings file? That's the default file that

```
NSLocalizedString(@"key", nil); 
```

looks for.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-18T19:48:51.760

使用 Xcode 5.1.1 和 7.1 模拟器时，本地化不可靠。在真实硬件上进行测试确实有效。

# testing - TestNG - 是否可以将 AnnotationTransformer 与 dataProvider 一起使用？

> ID：11543026
> 
> 赞同：1
> 
> 时间：2012-07-18T13:52:57.890
> 
> 标签：testing, automated-tests, testng, testng-dataprovider

我正在使用 TestNG 编写功能测试，并且我有几十个具有不同数据的类似测试。我想使用 DataProvider 来减少重复代码。

但其中一些测试通过，一些失败（由于已知缺陷）。我想禁用失败的测试，直到它们被修复，所以它们不会破坏测试运行的整个画面。

我看到 AnnotationTransformer 可以动态更改测试注释。AnnotationTransformer 可以仅对某些数据集禁用测试吗？或者它会禁用所有提供的数据的测试，最好不要改变任何东西？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T04:15:38.590

为什么不简单地将这些失败的测试放在一个组中，说“损坏”，然后从你的运行中排除该测试？比使用注释转换器简单得多，并且报告会显示哪些组被排除在外，因此在发货时不会错过任何风险。

# javascript - Backbone.js 视图未呈现

> ID：11543030
> 
> 赞同：0
> 
> 时间：2012-07-18T13:53:12.017
> 
> 标签：javascript, oop, backbone.js

在我的 Backbone 应用程序中，其中一个视图未按预期呈现。

当用户遵循“test/addtests”路线时，它会调用如下所示的函数

```
addtests: function () {

    this.testView = new TestView();
}, 
```

然后视图应该使用下面的初始化函数自动呈现

```
window.TestView = Backbone.View.extend({

    template: _.template($('#test').html()),

    initialize: function () {
        tests.bind("reset", this.render, this);
    },

    render: function (eventName) {
        alert('asdf');
        $(this.el).html(this.template());
        _.each(tests.models, function (test) {
             this.renderSelectBox(test);
         }, this);
        return this;
    },

    renderSelectBox: function (test) {
           var optionView = new TFS.FormOptionView({
               model: test
           });
           $(this.el).append(optionView.render().el);
       },

    events:{
        "click button": "addTest"
    },

    ...ect

}); 
```

但是什么也没发生，它只是显示最后一页的内容。我在渲染函数中设置的警报也不会触发。然而奇怪的是，如果我单击刷新，警报会触发：S。

路线设置正确，并正确指向“addtests”功能，似乎它只是没有按预期初始化视图。

我发现令人困惑的第二件事是，如果我有一个完整的集合，我无法使用 get 方法来拉出单个模型。例如

```
players // a full collection

var test = players.get(1);

console.log(test.get('id')); //undefined 
```

:S

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:08:51.683

哎呀，我的印象是绑定函数正在调用渲染，但似乎并非如此。

我只是把

```
this.render(); 
```

在视图初始化功能中，它起作用了。

有谁知道为什么我无法从上述集合中拉出单个模块？

# ios - iOS - 在视图控制器中，放置用户会话管理代码最合乎逻辑的位置在哪里？

> ID：11543037
> 
> 赞同：0
> 
> 时间：2012-07-18T13:53:33.113
> 
> 标签：ios, ios5

我是一名 iOS 新手，我正在尝试了解一些在 iOS 应用程序中做事的“良好实践”方式。

我有一个 ViewController，我把它作为应用程序启动时调用的控制器。在其中，我看到了一个名为 viewDidLoad 的函数，我尝试对其进行修改以检查用户是否有 user_id，然后调用一个函数，该函数最终会发出异步请求来管理远程数据库中的该用户。这是我的代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    EmailUtil *email = [EmailUtil alloc];
    email = [email init];

    // This is just a test call to the function that would make a remote server request
    [email setEmail: @"test" andBody: @"hello"];

    NSUserDefaults *standardUserDefaults = [NSUserDefaults standardUserDefaults];
    if([standardUserDefaults objectForKey:@"user_id"] == nil)
    {
        NSLog(@"First time"); 

        [standardUserDefaults setBool:YES forKey:@"user_id"];      

    }
    else 
    {
        NSString *subject = @"subject";
        NSString *body = @"bod";

         NSLog(@"Not first time"); 
    }    
} 
```

所以这里有几件事我不确定。我正在调用一个函数以从 viewDidLoad 进行远程调用这一事实会导致该函数出现问题吗？目前它没有发送远程请求。

另外，我应该为我在这个函数结束时创建的对象释放内存吗？

或者我应该把这段代码移到课堂上的另一个地方，在那里有那个代码更有意义吗？

我这样称呼电子邮件对象：

```
[email setEmail: @"test" andBody: @"hello"]; 
```

这是 EmailUtil 类的代码：

```
//
//  EmailUtil.m
//

#import "EmailUtil.h"

@implementation EmailUtil

-(void) setEmail: (NSString *) subject andBody: (NSString *) body
{   
    NSString *final_url = [NSString stringWithFormat:@"http://www.my_url.com?subject=%@&body=%@",subject, body];
    NSURL *url = [NSURL URLWithString:final_url];

    NSURLRequest *urlRequest = [NSURLRequest requestWithURL:url ];

    // TODO: ok I dont really understand what this is
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];

    [NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
     {         
         NSLog(@"On return");

         NSLog(@"This is data: %@" , data);
         NSLog(@"This is response: %@" , response);
         NSLog(@"This is error: %@" , error);

         NSLog(@"OK");

     }];    

}
@end 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:07:13.413

你说：

> 所以这里有几件事我不确定。我正在调用一个函数以从 viewDidLoad 进行远程调用这一事实会导致该函数出现问题吗？目前它没有发送远程请求。

随意在 viewDidLoad 中进行任何你想要的调用。只要确保不要做任何会阻塞用户界面的事情（例如一些冗长、复杂的方法）。任何长时间运行的、非 UI 相关的任务都将在单独的队列中异步完成，但那是另一天，在遥远的将来。

无论您是在此处还是在 中执行此操作，`application:didFinishLaunchingWithOptions:`都取决于您的 UI 将要执行的操作。我们需要更好地了解您的应用程序的流程来回答这个问题。而且我们需要了解`EmailUtil`呈现本身是如何呈现的（通常这类类使用模态呈现，从另一个视图控制器而不是从`application:didFinishLaunchingWithOptions:`.

但是，归根结底，我个人`application:didFinishLaunchingWithOptions:`总是将我带到应用程序的“主”或“主页”页面，如果我有一些我想在第一次使用时展示的东西，但不是主页，然后我将从我的主视图控制器的`viewDidLoad`. 其他人将`application:didFinishLaunchingWithOptions:`使用“第一次使用”逻辑进行自定义。这是个人喜好的问题。

> 另外，我应该为我在这个函数结束时创建的对象释放内存吗？

内存管理的第一条规则是，您始终应该释放您拥有的任何东西（通常是您创建的任何东西），并且只释放您拥有的东西。但是，如果您使用的是 ARC（我强烈鼓励您这样做），这会为您处理好（对象在超出范围时被释放）。

> 或者我应该把这段代码移到课堂上的另一个地方，在那里有那个代码更有意义吗？

就个人而言，我不会因为主视图控制器出现而让应用程序发送电子邮件而疯狂，因为我认为这只是一个示例而不是真正的应用程序。但是，如果您打算将其放在不同的地方，“发送电子邮件”功能在逻辑上更符合用户点击“发送电子邮件”按钮，而不是跑掉自己做。

关于其他点：

1.  不过，这段代码很奇怪，因为您正在创建`EmailUtil`一个本地 var，设置它的一些属性，然后不对其进行任何操作，然后让它超出范围。我想你会想要一些方法来`EmailUtil`完成它的工作，例如`[email sendMessage]`，或者任何合适的方法。

2.  您还创建了两个本地变量`subject`and `body`，而不是使用它们并让它们超出范围。我想你想`email`相应地更新你的对象的属性，但还没有做到这一点。

3.  您是否有理由编写自己的`EmailUtil`课程而不是使用[`MessageUI.framework`](http://developer.apple.com/library/ios/#DOCUMENTATION/MessageUI/Reference/MessageUI_Framework_Reference/_index.html)？希望`EmailUtil`只是一个很好的包装器`MessageUI.framework`，或者做一些完全不同的事情，但不复制 Apple 已经提供的功能。

4.  您说该应用程序将“发出异步请求以管理远程数据库中的该用户”。哇。我现在一直都在做这种事情，但我不建议将与服务器的异步协调作为一个好的第一次项目。希望当您说“最终”时，您的意思是“从现在开始的几个月”，而不是“在接下来的一两周内”。看起来你仍然在基本的视图控制器和内存管理的东西上得到你的海腿。您可能想看看是否可以将应用程序的初始版本的功能限制为不那么雄心勃勃的东西。如果您还没有一些基本技能并尝试做一些复杂的事情，那么您最终可能会手头上一团糟，您会发现自己以后会完全重写。所以，无意冒犯，但是看看你是否能为你的第一个真正的项目想出一些更简单的东西。或者先做几个测试应用程序。只是一个想法。

5.  Lvsti 是非常正确的，典型的对象创建构造是`[[EmailUtil alloc] init]`. 你所拥有的是等价的，但非标准的。

6.  我知道这是一项正在进行的工作，但看起来您`setEmail:andBody:`正在设置属性并发送消息。我建议 (a)为and设置`@property`条目（它将自动生成和方法，并让您执行类似的操作）；(b) 如果你愿意，有一个 init 方便的方法，例如，`subject``body``setSubject``setBody``email.subject = @"This is the subject of the email";``initWithSubject:body:`它将初始化您的对象并设置这两个属性；(c) 有一个单独的方法来实际发送消息。拥有一个看起来像 setter 的东西不是一个好习惯，有点像 setter，但也做更多的物质工作，所有这些都在一个方法中。以“set”开头的方法通常是标准设置器，iOS 约定会导致其他程序员误读您的代码（就像我刚才所做的那样）。通过遵循一些标准的 iOS 约定，如果你让 iOS 程序员参与审查和修改代码会更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:06:59.823

您应该将此代码移至您的 appdelegate 的 application:didFinishLaunchingWithOptions: 方法。从 iOS-Dev-Center

> 您应该使用此方法来初始化您的应用程序并为运行做好准备。在您的应用程序启动并加载其主 nib 文件后调用它。在调用此方法时，您的应用程序处于非活动状态。

如果你不使用 arc，你唯一应该释放的是 EmailUtil，没有理由手动释放一些东西

# c# - C# xml 到密钥对值

> ID：11543045
> 
> 赞同：0
> 
> 时间：2012-07-18T13:53:47.300
> 
> 标签：c#, xml

我有一个无法再解决的问题，需要新的见解。我需要以下 XML 结构才能成为密钥对值。

XML

```
<?xml version="1.0" encoding="utf-8"?>
<data>
   <page>
     <title>Home</title>
     <url>http://data.home.nl</url>
     <page>
         <title>link 1</title>
         <url>http://data.home.nl/link1.aspx</url>
         <page>
            <title>link 2</title>
            <url>http://data.home.nl/link/link2.aspx</url>
            <page>
               <title>link 3</title>
               <url>http://data.home.nl/link/link/link3.aspx</url>
            </page>
            <page>
               <title>Test 4</title>
               <url>http://data.home.nl/link/link/test4.aspx</url>
            </page>
            <page>
               <title>Test 5</title>
               <url>http://data.home.nl/link/link/test5.aspx</url>
            </page>
            <page>
               <title>Test 6</title>
               <url>http://data.home.nl/link/link/test6.aspx</url>
            </page>
            <page>
               <title>Test 7</title>
               <url>http://data.home.nl/link/link/test7.aspx</url>
            </page>
         </page>
      </page>
   </page>
</data> 
```

我需要实现的是和在密钥对值中，我迷路了....

谢谢！

*更新 xml 抱歉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:16:05.217

正如 Shyju 已经指出的那样，您的 XML 格式不正确。我还假设您的意思是元素`title`代替`titel`? 我`titel`在答案中使用了，因为那是您的 XML 字符串中的内容。

我相信您可以使用[LINQ to XML](http://msdn.microsoft.com/en-us/library/bb387061.aspx)实现您的结果：

```
var xmlString = // set your xml string here
var xml = System.Xml.Linq.XElement.Parse(xmlString);

var myDictionary = xml.Elements()
    .Select(e => new KeyValuePair<string, string>(
        e.Element("titel").Value, 
        e.Element("url").Value))
    .ToDictionary(k => k.Key, v => v.Value); 
```

**编辑**

我看到你已经编辑了你的问题，页面实际上是分层的。要处理这个问题，您可以创建一个 LINQ 扩展方法来处理递归：

```
public static IEnumerable<T> Recursive<T>(
    this IEnumerable<T> source, 
    Func<T, IEnumerable<T>> recursiveFunc)
{
    foreach (T item in source)
    {
        yield return item;
        var result = recursiveFunc(item);

        if (result != null)
        {
            foreach (T nextItem in Recursive(result, recursiveFunc))
            {
                yield return nextItem;
            }
        }
    }
} 
```

然后像这样创建你的字典：

```
var myDictionary = xml.Elements()
    .Recursive(e => e.Elements())
    .Where(e => e.Element("title") != null && e.Element("url") != null)
    .Select(e => new KeyValuePair<string, string>(
        e.Element("title").Value, 
        e.Element("url").Value))
    .ToDictionary(k => k.Key, v=> v.Value); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:58:35.163

Personally, I'd create a list of Page entities and deserialize it:

```
[XmlRoot(name="page"]
public class MyPage
{
    [XmlElement(name="titel")]
    public string Title { get; set; }
    [XmlElement(name="url")]
    public string Url { get; set; }
} 
```

Then deserialize into:

```
List<MyPage> pages; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:10:56.407

您的 XML**无效**。你可以[在这里查看](http://validator.w3.org/)

假设这是一个错字，并且您有以下格式的有效 XML。

```
<?xml version="1.0" encoding="utf-8"?>
<data>
    <page>
       <titel>link 3</titel>
       <url>http://data.home.nl/link/link/link3.aspx</url>
    </page>
    <page>
       <titel>Test 4</titel>
       <url>http://data.home.nl/link/link/test4.aspx</url>
    </page>           
</data> 
```

然后你可以使用**LINQtoXML**来查询它并做任何你想做的事情

```
Dictionary<string, string> dictionary =    new Dictionary<string, string>();

var path = Server.MapPath("~/Content/pairs.xml");

XElement elm = XElement.Load(path);
//you can also load the XML from a stream /Textreader etc..

if (elm != null)
{       
    foreach (var page in elm.Elements("page"))
    {
        var title = page.Element("titel").Value;
        var url = page.Element("url").Value;
        dictionary.Add(title, url);
    }
}
//dictionary is filled now 
```

我相信您会添加适当的错误处理（始终包括`null`在访问元素以应用某些方法或读取属性值之前进行检查）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T15:05:23.857

您的 xml 采用递归形式。

如果需要存储父子关系，使用嵌套类代替字典

```
public class Page 
{ 
    public string Title { get; set; } 
    public string Url { get; set; } 
    public List<Page> childPage {get; set;}
} 
```

# objective-c - 带有 CoreText 的多页 PDF

> ID：11543048
> 
> 赞同：1
> 
> 时间：2012-07-18T13:53:50.963
> 
> 标签：objective-c, ios, core-graphics, core-text

我正在使用 CoreText 生成一个包含一系列`NSAttributedString`' 的 PDF 文档，所以我创建一个`CTFrameSetterRef`并给它一个覆盖整个页面的框架，然后循环使用`CTFrameDraw`来绘制文本，检查结果`CTFrameGetVisibleStringRange`以检测何时开始一个新的页。这很好用，但我怎么知道文本在哪里结束？例如，文本可能会在最后一页停止，我想在下面画一些图像。如何获得文本结束的位置？

```
CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)notesAttrString);
do {
    CTFrameRef frame = CTFramesetterCreateFrame(framesetter, currentRange, path, NULL);
    if( frame ) {
        CTFrameDraw(frame, context);

        if( currentRange.location < CFAttributedStringGetLength((CFAttributedStringRef)notesAttrString) ) {
             UIGraphicsBeginPDFPage();
        } else {
            complete = YES;
        }
    }
} while( !complete ); 
```

（以上代码为说明过程而删减，不完整）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:57:52.223

您可以使用`CTFrameGetLineOrigins`并检查最后一行的原点，也`CTFramesetterSuggestFrameSizeWithConstraints`可以获取整个帧的大小。

# c++ - 此代码中是否存在内存泄漏？

> ID：11543053
> 
> 赞同：0
> 
> 时间：2012-07-18T13:54:03.187
> 
> 标签：c++, pointers, memory-leaks

```
#include <iostream>

using namespace std;

int main()
{
    int i,j;
    int * k;
    char m;
    do{
        cin >> j;
        k = new int[j];
        for (i = 0; i < j; i++){
            k[i] = i;
            cout << k[i] << ", ";
        }

        delete[] k;

        cout << "\nContinue?\n";
        cin >> m;
    }while (m != 'n');
} 
```

这是我为描述我在理解`new`和`delete`. 'k' 会产生内存泄漏吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-18T13:55:29.167

此代码不是异常安全的 - 如果在两者之间引发异常`new[]`并且`delete[]`指向的块被泄露。用于`std::vector`解决此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:07:01.510

正如sharptooth 已经指出的那样，您应该使用try-catch 块来确保捕获并`k`释放任何异常。在一般情况下，您可以使用[valgrind](http://valgrind.org/docs/manual/QuickStart.html)来检查您的程序是否正在释放在执行期间分配的所有块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:56:37.053

不，在这种情况下它不会释放循环内的内存。但是，在这种情况下使用[scoped_array](http://www.boost.org/doc/libs/1_50_0/libs/smart_ptr/scoped_array.htm)会更好。

# c++ - 如何将 volatile 与 2D 共享内存一起使用？

> ID：11543057
> 
> 赞同：0
> 
> 时间：2012-07-18T13:54:17.610
> 
> 标签：c++, cuda, shared-memory

我想知道**如何**声明一个指向二维共享内存的 volatile 指针，以及这是否与一维数组具有**相同的效果**。

```
__shared__ float 2d_array[32][32];
// not working: volatile T ** smem = sdata; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:06:19.593

请注意，您的“二维”共享内存数组实际上只有一维。所以是这样的：

```
__shared__ volatile float array_2d[32][32]; 
volatile float *smem = &array_2d[0][0]; 
float val = *(smem + y + 32*x) // address of s2_array[x][y] 
```

是你想要的。静态数组`array_2d`以行主要顺序存储，并且可以按我所示的方式访问。

# php - 托管到服务器时，php会话变量值为空

> ID：11543061
> 
> 赞同：4
> 
> 时间：2012-07-18T13:54:29.970
> 
> 标签：php, session, session-variables, shared-hosting

我在会话中有一个奇怪的问题..这在我本地机器上的 WAMP 服务器上工作..我的问题是托管在美国的服务器上它不工作..

我这样做：

```
session_start();
$_SESSION['test'] = 'testing login..'; 
```

在另一个页面中，我正在做：

```
session_start();
echo('my session value is : '.$_SESSION['test']); 
```

但我得到的只有我的会话值是：

我的会话值没有设置..

我在服务器的 cPanel 中检查了 session.save_path，它显示为 /tmp。

请帮助..提前谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:06:41.937

也许您的脚本因`session_start`“标头已发送”而失败？例如，如果您的测试机器和生产服务器没有以相同的方式对新行进行编码，则可能会发生这种情况......

这些错误可能不会显示在您的生产服务器上，请尝试以下操作：

```
ini_set('display_errors', 1);
session_start(); 
```

看看你是否得到了有用的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:36:41.370

检查您的`session.save_path`. 此位置需要 Apache/httpd 用户可写。

还要检查您是否`session.save_path`包含任何`sess_`前缀文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T11:55:47.523

感谢所有的帮助。

我的问题是 /tmp 文件夹中的安全权限。一旦它纠正它的工作。

平均时间不要只对 SESSION id 使用数字（例如 $_SESSION['12345']），因为在 linux 托管它不采用仅数字索引并跳过它。（所以使用 $_SESSION['ACS12345']）..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-17T21:49:44.433

php 开始标签必须写在 php 文件的第一行。这种方法帮助我解决了这个问题。

# c++ - 添加十六进制值以获得结果的十六进制

> ID：11543068
> 
> 赞同：1
> 
> 时间：2012-07-18T13:54:47.283
> 
> 标签：c++, wxwidgets, hex

我想添加两个十六进制值以获得结果十六进制值我已经编写了以下代码但是当我打印结果值时，结果值被写入例如`"abc" ->61+62+63=186`但是在写入时`jk ->6a+6b`我应该得到类似`d5`但是它给出的东西`12`。

这是我写的代码：

我还将全局变量定义为

```
 char buffer[20];
  long int li ;

  for (int i = 0; i < length; ++i) {
      itoa(TextAlia[i], buffer, 16);
      li = li + atol (buffer);
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:56:58.990

```
li = li + atol (buffer); 
```

`atol`在第一个非数字（十进制）处停止。要解析十六进制表示，请使用

```
li += strtol(buffer, NULL, 16); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T16:03:20.153

我在这里假设您有两个字符串“TextAlia”和“TextAlib”，每个字符串都包含一个十六进制数字的字符串表示形式。添加数字并生成十六进制字符串作为输出的一种典型方法：

```
int a, b;
sscanf(TextAlia, "%x", &a);
sscanf(TextAlib, "%x", &b);
printf("%x", a + b); 
```

然而，这并不是在 C 中添加十六进制数字的最快方法，也不是以典型的 C++ 风格编写的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:01:11.810

试试看这个：[在 C# 中添加六进制值](https://stackoverflow.com/questions/4457712/adding-hexa-values-in-c-sharp)

或者试试这个：

```
int value = Convert.ToInt32(hexString1, 16) + Convert.ToInt32(hexString2, 16); 
```

希望这可以帮助。

# javascript - QML - 如何在 JavaScript 中修改 MouseArea onPressed 和 onReleased？

> ID：11543069
> 
> 赞同：0
> 
> 时间：2012-07-18T13:54:53.850
> 
> 标签：javascript, mouseevent, qml

我知道我可以像这样连接 onClicked 事件：

```
myMouseAreaID.clicked.connect(someJavaScriptFunction) 
```

但是对于 onPressed 和 onReleased 事件，我找不到类似的东西......

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T15:25:44.643

`myMouseArea.released.connect(fun)`按预期工作，但`pressed`信号被[同名的布尔属性](http://qt-project.org/doc/qt-4.8/qml-mousearea.html#pressed-prop)遮蔽，指示当前是否按下按钮。因此，目前无法动态连接此信号。

这实际上是一个已知错误，请参阅[QTBUG-24477](https://bugreports.qt-project.org/browse/QTBUG-24477)。您现在所能做的就是重新设计您的应用程序，使其不依赖于该特定功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T17:21:53.937

与此同时，我找到了解决方法：

```
MouseArea
{
    id: ma
    signal onPressedState
    onPressed: onPressedState()
} 
```

所以稍后在 JavaScript 中可以像这样使用它：

```
function someFunction()
{
    ma.onPressedState.connect(someOtherFunction)
} 
```

这有效:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T03:38:16.297

另一种选择是使用更具声明性的`Connections`类型来处理新闻：

```
Connections {
    target: myMouseAreaID
    onPressed: myPressedFunc()
} 
```

# sql - 内部连接的sql server问题

> ID：11543071
> 
> 赞同：0
> 
> 时间：2012-07-18T13:54:56.147
> 
> 标签：sql, sql-server

我现在有这个代码

```
SELECT JOB.JobID, A.adID, AR.ARNum
FROM dbo.vEvent AS E, dbo.[vAd] as A, dbo.[vAR] as AR, dbo.JOB_EVENT as JOB
INNER JOIN A ON A.eventID = E.eventID
INNER JOIN AR ON AR.eventID = A.eventID
INNER JOIN JOB ON JOB.EVENT_ID = E.eventID
WHERE year = '' AND season = '' AND month = '' 
```

然而; 当我在 SQl 服务器中执行它时，我得到了这个错误。

```
Msg 208, Level 16, State 1, Line 1
Invalid object name 'A'. 
```

我不明白，因为我所有的变量对我来说都是正确的。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:56:12.063

你要

```
SELECT JOB.JobID, A.adID, AR.ARNum
FROM dbo.vEvent AS E
INNER JOIN dbo.[vAd] as A ON A.eventID = E.eventID
INNER JOIN dbo.[vAR] as AR ON AR.eventID = A.eventID
INNER JOIN dbo.JOB_EVENT as JOB ON JOB.EVENT_ID = E.eventID
WHERE year = '' AND season = '' AND month = '' 
```

# java - 使用 Jersey 构建 XML 响应

> ID：11543081
> 
> 赞同：2
> 
> 时间：2012-07-18T13:55:49.120
> 
> 标签：java, xml, jersey

我正在尝试构建一个 Jersey Web 服务，它将接收数据，将其格式化为 XML 文档，然后将其传递给另一个服务。我意识到[Jersey 确实支持 XML](http://jersey.java.net/nonav/documentation/latest/xml.html)，但是由于项目所需的 XML 结构，我在实现它时遇到了一些麻烦。所需的输出如下所示：

```
<root-element>
    <table>
        <row>
            <d>data1</d>
            <d>data2</d>
            <d>data3</d>
        </row>
        <row>
            <d>data4</d>
            <d>data5</d>
            <d>data6</d>
        </row>
    </table> 
```

我的问题在于有可变数量的`<d>`和`<row>`元素，这将根据传入的数据来确定。我知道我可以`@XmlRootElement`在处理数据的类之上格式化一个简单的表格，但这可能只对我`<root-element>`的，因为该元素只会填充其他元素。我知道我需要使用某种循环来创建 each `<row>`，但我不确定如何`<d>`在每个字段中创建具有不同数据的每个元素。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T09:55:14.280

您可以使用带有[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)注释的 Java 模型来支持您的用例。可以多次出现的元素将对应`List`于 Java 模型中的属性。以下是如何映射文档的示例。

**桌子**

我们将使用`@XmlElementWrapper`注解添加分组元素，并使用`@XmlElement`注解设置集合中项目的元素名称。

```
package forum11543081;

import java.util.List;
import javax.xml.bind.annotation.*;

@XmlRootElement(name="root-element")
@XmlAccessorType(XmlAccessType.FIELD)
public class Table {

    @XmlElementWrapper(name="table")
    @XmlElement(name="row")
    private List<Row> rows;

} 
```

**排**

如果您的属性/字段的名称与生成的 XML 元素的名称相匹配，那么您不需要任何注释。

```
package forum11543081;

import java.util.List;
import javax.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
public class Row {

    private List<String> d;

} 
```

**演示**

下面是一个证明映射有效的独立示例：

```
package forum11543081;

import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Table.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum11543081/input.xml");
        Table table = (Table) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(table, System.out);
    }

} 
```

**输入.xml/输出**

```
<root-element>
    <table>
        <row>
            <d>data1</d>
            <d>data2</d>
            <d>data3</d>
        </row>
        <row>
            <d>data4</d>
            <d>data5</d>
            <d>data6</d>
        </row>
    </table>
</root-element> 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2010/09/jaxb-collection-properties.html](http://blog.bdoughan.com/2010/09/jaxb-collection-properties.html)
*   [http://blog.bdoughan.com/2010/08/creating-restful-web-service-part-15.html](http://blog.bdoughan.com/2010/08/creating-restful-web-service-part-15.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T04:06:46.990

如果您想使用默认的 Jersey/JAXB 编组到 XML，您将构建一个模式来反映您指定的结构，其中包括集合（无界元素）并生成（使用 xjc）相应的 java 类。来自您的 restful 服务的响应将是与根元素关联的类型，并且您将构建该结构作为服务的一部分。无界元素呈现为 java 列表，因此它们可以是任意数量的元素。在代码中，您只需根据需要添加 .add(element) 即可。就像是：

```
<schema ...>
...
  <element name="root-element">
    <complexType>
      <sequence>
        <element name="table" type="tns:TableType" />
      </sequence>
    </complexType>
  </element>

  <complexType name="TableType">
    <sequence>
      <element name="row" minOccurs="0" maxOccurs="unbounded" type="tns:RowType" />
    </sequence>
  </complexType>

  <complexType name="RowType">
    <sequence>
      <element name="d" minOccurs="0" maxOccurs="unbounded" type="string" />
    </sequence>
  </complexType>
</schema> 
```

另一种方法是（如 TedTrippin 所述）使用 stax（流处理器）逐个标记构建 xml 文档标记，并在适当的位置使用循环并返回最终结果。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-19T16:53:11.217

***我最终做了什么：***

由于我有来自另一个项目的代码，我可以重新使用它来循环遍历 XML 构建，因此我决定在文档中构建 XML，然后将该文档写入字符串，如下所示：

```
public class XmlHandler{
    public static String buildXml(){
        String xmlString="";

        //Create XML Document
        DocumentBuilderFactory docfac = DocumentBuilderFactory.newInstance();
        DocumentBuilder docbuil = null;
        docbuil = docfac.newDocumentBuilder();
        Document doc = docbuil.newDocument();

        //Build XML Elements
        Element root = doc.createElement("root-element");
        doc.appendChild(root);      
        Element table = doc.createElement("table");
        root.appendChild(table);

        //Hard coded data here for testing purposes.
        String[][]array={
        {"data1", "data2", "data3"},
        {"data4", "data5", "data6"}
        };

        Text text = null;
        Element d = null;
        Element row = null;
        for(String[] line : array)
        {
            row=doc.createElement("row");
            table.appendChild(row);
            for(String label : line)
            {
                d = doc.createElement("d");
                row.appendChild(d);
                text = doc.createTextNode(label);
                d.appendChild(text);
                }
            }
        }

        //Write Document to String
        DOMImplementationLS domImplLS = (DOMImplementationLS) doc.getImplementation();
        LSSerializer serializer = domImplLS.createLSSerializer();
        serializer.getDomConfig().setParameter("format-pretty-print", true);
        LSOutput output = domImplLS.createLSOutput();
        output.setEncoding("UTF-8");
        StringWriter sw = new StringWriter();
        output.setCharacterStream(sw);
        serializer.write(doc, output);
        xmlString = sw.toString();

        return xmlString;
    }
} 
```

虽然硬编码的字符串数组不会存在很长时间，但直到我找出需要传入的数据类型，这个类就可以很好地解决问题。

# android - 日历 API 和 OAuth

> ID：11543084
> 
> 赞同：0
> 
> 时间：2012-07-18T13:56:00.860
> 
> 标签：android, oauth-2.0, google-calendar-api

从网上的很多例子中，我自己尝试了一个日历应用程序。这些示例在日历构建期间使用了**GoogleAccessProtectedResource 。**但是当我尝试它时，它说它已被弃用。有人可以告诉我实现这一点的正确方法是什么吗？

```
public static Calendar build(String accessToken) {
  HttpTransport transport = AndroidHttp.newCompatibleTransport();
  JacksonFactory jsonFactory = new JacksonFactory();
  GoogleAccessProtectedResource accessProtectedResource =
      new GoogleAccessProtectedResource(accessToken);
  ...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:23:23.187

[当前版本的 Google API JAVA 客户端库](http://javadoc.google-api-java-client.googlecode.com/hg/1.10.3-beta/index.html?com/google/api/client/googleapis/auth/oauth2/draft10/GoogleAccessProtectedResource.html)的 Javadocs 是这样说的：

> 已弃用。（计划在 1.11 中删除）使用[GoogleCredential](http://javadoc.google-api-java-client.googlecode.com/hg/1.10.3-beta/index.html?com/google/api/client/googleapis/auth/oauth2/GoogleCredential.html)

有关如何使用它的示例，请参阅[Google OAuth wiki 页面：](https://code.google.com/p/google-api-java-client/wiki/OAuth2#Credential_and_Credential_Store)

```
GoogleCredential credential = new GoogleCredential().setAccessToken(accessToken);
Plus plus = Plus.builder(new NetHttpTransport(), new JacksonFactory())
    .setApplicationName("Google-PlusSample/1.0")
    .setHttpRequestInitializer(credential)
    .build(); 
```

# r - 运行 Cspade 时系统调用错误 - R

> ID：11543085
> 
> 赞同：0
> 
> 时间：2012-07-18T13:56:07.050
> 
> 标签：r

我正在尝试在 R 的 arulesSequences 包中运行 cspade 函数。在使用 read_baskets 成功读取我的事务后，我尝试对我读入的事务对象执行 cspade 函数。

但是，当我执行命令时，我得到一个错误：系统调用失败。具体来说，这是输出。

```
 preprocessing ... 1 partition(s), 1.2 MB [0.23s]
 mining transactions ...Error in cspade(table, parameter = list(support = 0.1), control =         list  (verbose = TRUE)) : 
 system invocation failed 
```

“挖掘交易”的存在表明 cspade 代码中的以下函数调用失败。

```
 if (system2(file.path(exe, "spade"), args = c("-i", file, 
  "-s", parameter@support, opt, "-e", nop, "-o"), stdout = out)) 
  stop("system invocation failed"). 
```

作为参考，我可以使用示例 zaki 数据集成功生成序列。

有谁知道为什么该命令可能会失败？

谢谢，

斯图尔特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:37:25.667

[http://en.wikibooks.org/wiki/Data_Mining_Algorithms_In_R/Sequence_Mining/SPADE#Caveats](http://en.wikibooks.org/wiki/Data_Mining_Algorithms_In_R/Sequence_Mining/SPADE#Caveats)

请参阅上面的链接，注意事项部分并降低您的支持门槛。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2018-06-14T16:27:52.610

我有同样的问题，我减少了支持（put 0），仍然没有工作。但是想出了另一个解决方案：我更改了数据大小（更少的行）并且它有效。因此，例如，如果您可以将数据集划分为 2 个一半大小的部分，并将每个部分的事务数据设为 x_1 和 x_2，

频繁模式_1 <- cspade（x_1，参数=列表（支持= 0））频繁模式_2 <- cspade（x_2，参数=列表（支持= 0））

然后获得分析每个数据集以获得所有结果的绝对支持。

获得绝对支持值 support_x_1<-support(frequent_pattern_1 ,x_1, type= c("absolute"), control = NULL) support_x_2<-support(frequent_pattern_2 ,x_2, type= c("absolute"), control = NULL)

然后找到匹配序列并对匹配序列的支持进行求和。

# mysql - PHP explode and MySQL query to search in multiple columns

> ID：11543088
> 
> 赞同：0
> 
> 时间：2012-07-18T13:56:14.843
> 
> 标签：mysql, forms, search, explode, implode

I have a form where I want a user to enter one or more words. These words should then match mutiple columns in a MySQL database.

I have started to build some code but I'm stuck.

```
<?php
  $term = $_SESSION['session_searchstring']; //Let's say that session is John Doe
  $searchterm = explode(' ',$term);

  $searchFieldName = "name";
  $searchCondition = "$searchFieldName LIKE '%" . implode("%' OR $searchFieldName LIKE '%", $searchterm) . "%'";

  $sql = "SELECT * FROM students WHERE $searchCondition;";

  echo $sql; //Echo to test what mysql_query would look like

?> 
```

The above code will output:

```
SELECT * FROM students WHERE name LIKE '%John%' OR name LIKE '%Doe%'; 
```

The problem is that I want to search in multiple columns (`$searchFieldName`). I have for example

```
customer_firstname
customer_lastname 
```

And I want to match my searchstring against the content of both columns.. How would I continue?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:07:58.203

如果您的表是 MyIsam 类型，或者您可以将其转换为 MyIsam，请使用[MySQL 全文搜索](http://dev.mysql.com/doc/refman/5.5/en/fulltext-search.html)。如果没有，无论如何，您可以构建一个长查询，例如

```
SELECT * FROM students WHERE name LIKE '%John%' OR name LIKE '%Doe%' OR lastname LIKE "%John%" OR lastname LIKE "%Doe%" 
```

或将您的列合并到另一个只是为了搜索（但这两者都不是首选）。一个好的方法是使用像[Sphinx](http://sphinxsearch.com/)这样的全文搜索引擎。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:09:34.053

也许

```
 $term = $_SESSION['session_searchstring']; //Let's say that session is John Doe
  $searchterm = explode(' ',$term);

  $searchColumns = array("customer_firstname","customer_lastname");

  for($i = 0; $i < count($searchColumns); $i++)
    {
        $searchFieldName = $searchColumns[$i];
        $searchCondition .= "($searchFieldName LIKE '%" . implode("%' OR $searchFieldName LIKE '%", $searchterm) . "%')";
        if($i+1 < count($searchColumns)) $searchCondition .= " OR ";
     }

  $sql = "SELECT * FROM students WHERE $searchCondition;";

  echo $sql; //Echo to test what mysql_query would look like 
```

生产

`SELECT * FROM students WHERE (customer_firstname LIKE '%John%' OR customer_firstname LIKE '%Doe%') OR (customer_lastname LIKE '%John%' OR customer_lastname LIKE '%Doe%');`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-15T07:45:41.120

在我的情况下，我需要所有搜索短语/术语来匹配至少一列，没有搜索短语/术语可能是不匹配的。

我最终通过以下方式调整了[Kermit的示例：](https://stackoverflow.com/users/679449/kermit)

```
public function getRawWhereFilterForColumns($filter, $search_columns)
{
  $search_terms = explode(' ', $filter);
  $search_condition = "";

  for ($i = 0; $i < count($search_terms); $i++) {
    $term = $search_terms[$i];

    for ($j = 0; $j < count($search_columns); $j++) {
      if ($j == 0) $search_condition .= "(";
      $search_field_name = $search_columns[$j];
      $search_condition .= "$search_field_name LIKE '%" . $term . "%'";
      if ($j + 1 < count($search_columns)) $search_condition .= " OR ";
      if ($j + 1 == count($search_columns)) $search_condition .= ")";
    }
    if ($i + 1 < count($search_terms)) $search_condition .= " AND ";
  }
  return $search_condition;
} 
```

我只需要 Where 子句的内容，因为我使用的是 Laravel，并且可以将其放入 rawWhere 方法中。

**用法：**

```
$search_condition = $this->getRawWhereFilterForColumns
    ("John Doe", array("column1", "column2")); 
```

**产生**

```
 (column1 LIKE '%John%' OR column2 LIKE '%John%') 
AND (column1 LIKE '%Doe%' OR column2 LIKE '%Doe%') 
```

最后，您可以以任何适合您的方式使用此 $search_condition，例如：

```
 $sql = "SELECT * FROM students WHERE $search_condition;"; 
```

或者在我的 Laravel 案例中：

```
 $modelInstances = Model::whereRaw
     ($search_condition)->paginate(self::ITEMS_PER_PAGE); 
```

[对于David](https://stackoverflow.com/users/1398242/david)或任何其他访问此线程的人（例如我）来说，这可能是一个改进的解决方案，即使它是在原始帖子发布将近两年之后。

# cordova - blackberry phonegap + webworks fileupload not reliable

> ID：11543095
> 
> 赞同：0
> 
> 时间：2012-07-18T13:56:39.057
> 
> 标签：cordova

I have been using the default test sample that comes with cordova and one thing I have noticed is that the fileupload function works initially and then seems to just suddenly stop working with a connection error: 3

Any ways around this?

The same issue has been occuring with my other apps I'm trying to make with phonegap.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T13:58:50.210

您可以尝试放弃 PhoneGap 并仅使用 WebWorks FileUploader 扩展。

你可以在这里找到它：[https ://github.com/blackberry/WebWorks-Community-APIs/tree/master/Smartphone/FileUploader](https://github.com/blackberry/WebWorks-Community-APIs/tree/master/Smartphone/FileUploader)

# c# - OR 正则表达式中的表达式？

> ID：11543098
> 
> 赞同：1
> 
> 时间：2012-07-18T13:56:54.527
> 
> 标签：c#, regex, or-operator

我正在尝试对结尾有温度的消息使用正则表达式。整个消息的示例如下所示：

```
RH= 12.1 %RH T= -3.5 'C 
```

如果不明显，则温度（以及与此问题相关的部分）为`T = -3.5 'C`. 我想捕捉`C`或捕捉`F`到最后。现在我有这个表达：

```
"RH=\\s*(?<1>[^\\s]*)\\s%RH T=\\s*(?<2>[^\\s]\\s*'\\w)" 
```

但这将在最后捕获任何字母数字字符。如何将最后的最后一个更改为`'\\w'`“仅`C`或`F`？”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:57:43.480

您可以使用[字符类](http://www.regular-expressions.info/charclass.html)：而不是`\\w`，写`[CF]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:59:59.900

好吧，如果提供的 formt 是*确定*的，不要使用复杂的正则表达式，而是简单的：

```
int index = data.LastIndexOf('\''); //index of last ' symbol
data.Substring(index); 
```

*应该*为你工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:00:50.647

另一种选择是将结尾替换为`\\w`,`c|f`意思是：c 或 f。

# asp.net - ASP.NET 共享 DLL

> ID：11543105
> 
> 赞同：1
> 
> 时间：2012-07-18T13:57:15.420
> 
> 标签：asp.net, vb.net

几周前我问了这个问题并得到了一些很好的答案：[ASP.NET 类库最佳实践](https://stackoverflow.com/questions/11318082/asp-net-class-library-best-practice)。我现在有另一个问题。

我的问题是我继承了一个 ASP.NET 应用程序，其中包含许多紧密耦合和低内聚的类，这并不理想。我想与其他应用程序共享一些代码。大多数代码存在于一个类中，但是该类引用其他类，而这些类引用其他类等。有没有办法在一个类中共享代码（引用其他类）？我能想到的唯一方法是使用 Web 服务，但存在敏感信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:05:23.823

在这种情况下，唯一好的选择是重构代码。但是，您不必更改现有的类接口。您可以创建多个设计正确的新类，并替换原始设计不佳的类中的逻辑。然后，您可以重构原始类以在内部使用新类来执行功能。您不必一次全部完成。当您发现您需要共享库中的特定逻辑位时，只需重构该逻辑并保持其余部分不变。随着时间的推移，您可以通过这种方式重构整个事物。当然，除非它不是那么大，或者你有足够的时间来重构这头野兽。但是，通常情况并非如此。

例如，假设您有以下过度简化的类：

```
Public Class OriginalBeast
    Private _dependency As New Dependency()

    Public Function Method1() As Integer
        Return _dependency.Calculate(2)
    End Sub

    Public Function Method2() As Integer
        Return _dependency.Calculate(2)
    End Sub

    ' ...

    Public Function Method1027() As Integer
        Return _dependency.Calculate(1027)
    End Sub
End Class

Public Class Dependency
    Public Function Calculate(value As Integer) As Integer
        Return value * 2
    End Function
End Class 
```

并且您想在`OriginalBeast.Method2`类库中共享逻辑，您需要将`Dependency`类移动到类库（并且可能还需要对其进行部分重构）。然后，您需要创建一个新类，其中仅包含原始野兽所需的方法：

```
Public Interface INice
    Function Method2() As Integer
End Interface

Public Class Nice
    Implements INice

    Public Sub New(dependency As IDependency)
        _dependency = dependency
    End Sub

    Private _dependency As IDependency

    Public Function Method2() As Integer Implements INice.Method2
        Return _dependency.Calculate(2)
    End Function
End Class

Public Interface IDependency
    Function Calculate(value As Integer) As Integer
End Interface

Public Class Dependency
    Implements IDependency

    Public Function Calculate(value As Integer) As Integer Implements IDependency.Calculate
        Return value * 2
    End Function
End Class 
```

然后，您需要重构原始野兽以使用类库而不是执行逻辑本身：

```
Public Class OriginalBeast
    Public Sub New()
        _dependency = New Dependency()
        _nice = New Nice(_dependency)
    End Sub

    Private _dependency As IDependency
    Private _nice As INice

    Public Function Method1() As Integer
        Return _dependency.Calculate(2)
    End Sub

    Public Function Method2() As Integer
        Return _nice.Method2()
    End Sub

    ' ...

    Public Function Method1027() As Integer
        Return _dependency.Calculate(1027)
    End Sub
End Class 
```

显然，现实世界中的野兽从来没有那么简单，甚至可能需要大量工作来重构其中的一小部分，但希望这能让您了解我在说什么。

# android - Getting aapt source using git

> ID：11543109
> 
> 赞同：9
> 
> 时间：2012-07-18T13:57:30.623
> 
> 标签：android, aapt

how can I download Android Asset Packaging Tool (aapt) source using git from this URL [https://android.googlesource.com/](https://android.googlesource.com/)?

Thanks

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T13:25:07.057

aapt 位于 Google 存储库中：[https](https://android.googlesource.com/platform/frameworks/base) ://android.googlesource.com/platform/frameworks/base 。

可以通过运行克隆：`git clone https://android.googlesource.com/platform/frameworks/base`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-18T14:05:37.953

从以下链接获取 GITbash --> 运行命令窗口实用程序 --> 从存储库中复制粘贴命令行。

[重击](http://code.google.com/p/msysgit/downloads/list)

您也可以使用命令行或 GIT gui 工具。

# java - Type Conversion from C to Java

> ID：11543110
> 
> 赞同：9
> 
> 时间：2012-07-18T13:57:31.213
> 
> 标签：java, android, c, type-conversion, android-ndk

I did my best to Google this but couldn't find a clean answer in a table-like form that shows type conversions.

The reason I would like to convert these types, is because I am using the Android NDK to call functions from native code. The problem is that the native code calls different types that do not exist in Java.

I actually have no experience in C, and have found these few types from looking at code quickly. Please feel free to edit this post to add different types to be converted.

```
From C to Java

long ->

short ->

char ->

unsigned long ->

unsigned short ->

unsigned char ->

byte ->

Int8 ->

Int16 ->

Int32 ->

UInt8 ->

UInt16 ->

UInt32 -> 
```

Also, if any of these cannot convert into a Java type, please explain why.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T14:01:03.330

这些是等价的，请记住 Java 中原始数据类型的大小始终相同，而 C 中数据类型的大小在某种程度上是编译器和体系结构特定的，正如 @millimoose 在注释。

另外，请注意，`char`数据类型被[定义](https://en.wikipedia.org/wiki/C_data_types#Basic_types)为“可以包含基本字符集的机器的最小可寻址单元。它是整数类型。实际类型可以是有符号或无符号，具体取决于实现”，而在 Java 中是单个16 位 Unicode 字符。

```
long -> long
short -> short
char -> char
unsigned long -> N/A
unsigned short -> N/A
unsigned char -> N/A
byte -> byte
Int8 -> byte
Int16 -> short
Int32 -> int
UInt8 -> N/A
UInt16 -> N/A
UInt32 -> N/A 
```

在 Java 中没有无符号的原始数据类型。该`byte`类型使用8位、`int`32位、`short`16位和`long`64位。

这是 Java 教程中相关部分的[链接](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)，在[Java 语言规范的](http://docs.oracle.com/javase/specs/jls/se7/html/index.html)[第 4.2 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.2)中有更详细的解释。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-06-27T14:42:14.930

你需要导入类

UInt32 类

java.lang.Object

然后你可以简单地使用 Uint32 和 Uint16

# android - Rectify a rectangle to get area

> ID：11543114
> 
> 赞同：1
> 
> 时间：2012-07-18T13:57:47.077
> 
> 标签：android, opencv, computer-vision

I need to get the area of a known object inside a scene to get the distance from that. The problem is rectifying it so that the area is independent from the angle. I'm using opencv (on Android) with some java code that is equivalent to this:

[http://docs.opencv.org/doc/tutorials/features2d/feature_homography/feature_homography.html#feature-homography](http://docs.opencv.org/doc/tutorials/features2d/feature_homography/feature_homography.html#feature-homography)

In other words: how do i get the area of the object observed perpendicularly from that distance given the H matrix.

Thank you in advance and sorry for my poor english... :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T13:42:52.093

您可以调用 cvCalibrateCamera，但不确定它是否仅适用于一张图像。它所基于的[算法](http://research.microsoft.com/en-us/um/people/zhang/Papers/TR98-71.pdf)可以处理一个图像的情况，见第 3.1 节。它说“如果n = 1 ...”。因此，您可以在紧要关头重新实现它。

# django - 在 Django 中测试“不同层”的最佳实践是什么？

> ID：11543117
> 
> 赞同：38
> 
> 时间：2012-07-18T13:57:49.877
> 
> 标签：django, testing, tdd, automated-tests, django-testing

我对测试**并不**陌生，但对在 Django 中测试不同层的一堆建议感到非常困惑。

有些人建议（他们是对的）避免模型中的**Doctests**，因为它们不可维护......

其他人说不要使用**固定装置**，因为它们不如**辅助功能**灵活，例如..

还有两组人为使用**Mock**对象而战。第一组相信使用 Mock 并隔离系统的其余部分，而另一组更喜欢 **停止 Mocking 并开始测试**..

我上面提到的主要是关于测试模型。**功能测试**是另一回事（使用 test.Client() VS webTest VS etc.）

是否有**任何**可维护、可扩展和正确的方法来测试不同的层？

**更新**

我知道[Carl Meyer](http://pycon-2012-notes.readthedocs.org/en/latest/testing_and_django.html)在 PyCon 2012 上的演讲。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-07-18T16:37:05.597

**更新 08-07-2012**

我可以告诉你我的单元测试实践对我自己的目的非常有效，我会给你我的理由：

1.- 仅将[Fixtures](https://docs.djangoproject.com/en/dev/howto/initial-data/)用于测试所需但不会更改的信息，例如，每次测试都需要一个用户，因此使用**基本**Fixture 来创建用户。

2.- 使用工厂来创建你的对象，我个人喜欢[FactoryBoy](https://github.com/dnerdy/factory_boy)（这来自 FactoryGirl，它是一个 ruby​​ 库）。我为保存所有这些对象的每个应用程序创建了一个名为 factory.py 的单独文件。通过这种方式，我将所有需要的对象都放在测试文件之外，这使得它更具可读性和易于维护。这种方法很酷的一点是，您可以创建一个基础对象，如果您想基于工厂中的某个对象测试其他内容，则可以对其进行修改。它也不依赖于 django，所以当我开始使用 mongodb 并需要测试它们时迁移这些对象时，一切都很顺利。现在，在阅读了有关工厂的信息后，通常会说“那我为什么要使用固定装置”。由于这些灯具永远不应该改变所有来自工厂的额外好东西都是无用的，而且 django 开箱即用地支持灯具。

3.- 我[模拟](http://labix.org/mocker/)对外部服务的调用，因为这些调用使我的测试非常缓慢，并且它们依赖于与我的代码是对还是错无关的事情。例如，如果我在测试中发推文，我会测试它是否正确发推文，复制响应并模拟该对象，以便它每次都返回准确的响应而不进行实际调用。有时也可以在出现问题时进行测试，而嘲讽对此非常有用。

4.- 我使用一个集成服务器（[jenkins](http://en.wikipedia.org/wiki/Jenkins_%28software%29)是我在这里推荐的），每次我推送到我的登台服务器时都会运行测试，如果它们失败，它会向我发送一封电子邮件。这太好了，因为我经常在上次更改中破坏其他东西并且忘记运行测试。它还为您提供其他好东西，例如覆盖率报告、[pylint](http://www.logilab.org/857/) / [jslint](http://www.jslint.com/) / [pep8](http://www.python.org/dev/peps/pep-0008/)验证，并且存在许多插件，您可以在其中设置不同的统计信息。

关于您测试前端的问题，django 附带了一些[辅助函数](https://docs.djangoproject.com/en/dev/topics/testing/?from=olddocs#module-django.test.client)以基本方式处理此问题。

这是我个人使用的，您可以触发获取、发布、登录用户等，这对我来说已经足够了。我不倾向于使用像 selenium 这样的完整的前端测试引擎，因为我觉得测试除业务层之外的任何其他东西都是一种矫枉过正的做法。我相信有些会有所不同，这总是取决于你在做什么。

除了我的意见之外，django 1.4 还为浏览器内框架提供了非常方便的[集成](https://docs.djangoproject.com/en/dev/topics/testing/?from=olddocs#django.test.LiveServerTestCase)。

我将设置一个示例应用程序，我可以在其中应用这种做法，以便更容易理解。让我们创建一个非常基本的博客应用程序：

**结构体**

```
blogger/
    __init__.py
    models.py
    fixtures/base.json
    factories.py
    tests.py 
```

**模型.py**

```
 from django.db import models

 class Blog(models.Model):
     user = models.ForeignKey(User)
     text = models.TextField()
     created_on = models.DateTimeField(default=datetime.now()) 
```

**固定装置/base.json**

```
[
{
    "pk": 1,
    "model": "auth.user",
    "fields": {
        "username": "fragilistic_test",
        "first_name": "demo",
        "last_name": "user",
        "is_active": true,
        "is_superuser": true,
        "is_staff": true,
        "last_login": "2011-08-16 15:59:56",
        "groups": [],
        "user_permissions": [],
        "password": "IAmCrypted!",
        "email": "test@email.com",
        "date_joined": "1923-08-16 13:26:03"
    }
}
] 
```

**工厂.py**

```
import factory
from blog.models import User, Blog

class BlogFactory(factory.Factory):
    FACTORY_FOR = Blog

    user__id = 1
    text = "My test text blog of fun" 
```

**测试.py**

```
class BlogTest(TestCase):
    fixtures = ['base']  # loads fixture

    def setUp(self):
        self.blog = BlogFactory()
        self.blog2 = BlogFactory(text="Another test based on the last one")

    def test_blog_text(self):
        self.assertEqual(Blog.objects.filter(user__id=1).count(), 2)

    def test_post_blog(self):
        # Lets suppose we did some views
        self.client.login(username='user', password='IAmCrypted!')
        response = self.client.post('/blogs', {'text': "test text", user='1'})

        self.assertEqual(response.status, 200)
        self.assertEqual(Blog.objects.filter(text='test text').count(), 1)

    def test_mocker(self):
        # We will mock the datetime so the blog post was created on the date
        # we want it to
        mocker = Mock()
        co = mocker.replace('datetime.datetime')
        co.now()
        mocker.result(datetime.datetime(2012, 6, 12))

        with mocker:
            res = Blog.objects.create(user__id=1, text='test')

        self.assertEqual(res.created_on, datetime.datetime(2012, 6, 12))

    def tearDown(self):
        # Django takes care of this but to be strict I'll add it
        Blog.objects.all().delete() 
```

请注意，为了示例，我使用了一些特定的技术（顺便说一句，尚未测试）。

我必须坚持，这可能不是标准的最佳实践（我怀疑它是否存在），但它对我来说效果很好。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-07T18:31:41.410

我真的很喜欢@Hassek 的建议，并想强调一下他对明显缺乏标准实践的观点是多么的好，这适用于 Django 的许多方面，而不仅仅是测试，因为我们所有人都带着不同的关注点来处理框架请记住，除了我们在设计应用程序时所具有的高度灵活性之外，我们经常会得到适用于同一问题的截然不同的解决方案。

尽管如此，我们大多数人在测试我们的应用程序时仍然为许多相同的目标而努力，主要是：

*   保持我们的测试模块井井有条
*   创建可重用的断言和辅助方法，减少测试方法的 LOC 的辅助函数，使它们更紧凑和可读
*   表明有一种明显的、系统的方法来测试应用程序组件

像@Hassek 一样，这些是我的偏好，可能与您可能正在应用的实践直接冲突，但我觉得很高兴分享我们已经证明有效的东西，如果只是在我们的案例中。

## 没有测试用例夹具

应用程序夹具工作得很好，如果您有某些恒定的模型数据，您希望保证出现在数据库中，例如一组城镇及其名称和邮局号码。

但是，我认为这是提供测试用例数据的一种不灵活的解决方案。测试夹具非常冗长，模型突变迫使您要么经历一个漫长的过程来重现夹具数据，要么执行繁琐的手动更改，并且很难手动执行维护参考完整性。

此外，您很可能会在测试中使用多种固定装置，而不仅仅是模型：您希望存储 API 请求的响应主体，创建针对 NoSQL 数据库后端的固定装置，编写使用的固定装置填充表单数据等

最后，利用 API 创建数据是简洁、易读的，并且更容易发现关系，因此我们大多数人都求助于使用工厂来动态创建夹具。

## 广泛利用工厂

工厂函数和方法比删除测试数据更可取。您可以创建助手工厂模块级函数或测试用例方法，您可能希望在应用程序测试或整个项目中重用它们。特别是，[`factory_boy`](https://github.com/dnerdy/factory_boy)@Hassek 提到的 ，为您提供了继承/扩展夹具数据并进行自动排序的能力，如果您手动进行，这可能看起来有点笨拙。

利用工厂的**最终目标**是减少代码重复并简化创建测试数据的方式。我不能给你确切的指标，但我敢肯定，如果你以敏锐的眼光审视你的测试方法，你会注意到你的大部分测试代码主要是准备驱动测试所需的数据。

如果这样做不正确，阅读和维护测试将成为一项令人筋疲力尽的活动。当数据突变导致全面的测试失败不那么明显时，这种情况往往会升级，此时您将无法应用系统的重构工作。

我个人解决这个问题的方法是从一个模块开始，该模块为我的模型以及我可能在大多数应用程序测试中经常使用的任何对象`myproject.factory`创建易于访问的方法引用：`QuerySet.create`

```
from django.contrib.auth.models import User, AnonymousUser
from django.test import RequestFactory

from myproject.cars.models import Manufacturer, Car
from myproject.stores.models import Store

create_user = User.objects.create_user
    create_manufacturer = Manufacturer.objects.create
create_car = Car.objects.create
create_store = Store.objects.create

_factory = RequestFactory()

def get(path='/', data={}, user=AnonymousUser(), **extra):
    request = _factory.get(path, data, **extra)
    request.user = user

    return request

def post(path='/', data={}, user=AnonymousUser(), **extra):
    request = _factory.post(path, data, **extra)
    request.user = user

    return request 
```

这反过来又允许我做这样的事情：

```
from myproject import factory as f  # Terse alias

# A verbose, albeit readable approach to creating instances
manufacturer = f.create_manufacturer(name='Foomobiles')
car1 = f.create_car(manufacturer=manufacturer, name='Foo')
car2 = f.create_car(manufacturer=manufacturer, name='Bar')

# Reduce the crud for creating some common objects
manufacturer = f.create_manufacturer(name='Foomobiles')
data = {name: 'Foo', manufacturer: manufacturer.id)
request = f.post(data=data)
view = CarCreateView()

response = view.post(request) 
```

大多数人都对减少代码重复很严格，但我实际上是在我觉得它有助于测试全面性的时候故意引入一些。同样，无论您对工厂采用哪种方法，其目标都是尽量减少您在每种测试方法的标题中引入的脑力劳动。

## 使用模拟，但要明智地使用它们

我是 的粉丝[`mock`](http://www.voidspace.org.uk/python/mock/)，因为我对作者对我认为是他想要解决的问题的解决方案产生了赞赏。该包提供的工具允许您通过注入预期结果来形成测试断言。

```
# Creating mocks to simplify tests
factory = RequestFactory()
request = factory.get()
request.user = Mock(is_authenticated=lamda: True)  # A mock of an authenticated user
view = DispatchForAuthenticatedOnlyView().as_view()

response = view(request)

# Patching objects to return expected data
@patch.object(CurrencyApi, 'get_currency_list', return_value="{'foo': 1.00, 'bar': 15.00}")
def test_converts_between_two_currencies(self, currency_list_mock):
    converter = Converter()  # Uses CurrencyApi under the hood

    result = converter.convert(from='bar', to='foo', ammount=45)
    self.assertEqual(4, result) 
```

正如您所看到的，mock 确实很有帮助，但它们有一个令人讨厌的副作用：您的 mock 清楚地显示了您对应用程序行为方式的假设，这引入了耦合。如果`Converter`被重构为使用`CurrencyApi`.

因此，强大的力量伴随着巨大的责任——如果您要成为一个聪明人并使用模拟来避免根深蒂固的测试障碍，您可能会完全混淆测试失败的真实性质。

## 最重要的是，保持一致。非常非常一致

这是最重要的一点。与所有内容保持一致：

*   您如何在每个测试模块中组织代码
*   如何为应用程序组件引入测试用例
*   你如何引入测试方法来断言这些组件的行为
*   你如何构建测试方法
*   您如何测试通用组件（基于类的视图、模型、表单等）
*   你如何应用重用

对于大多数项目来说，关于如何以协作方式进行测试的问题经常被忽视。虽然应用程序代码本身看起来很完美——遵守风格指南、使用 Python 习惯用法、重新应用 Django 自己的方法来解决相关问题、使用框架组件的教科书等——但没有人真正努力弄清楚如何将测试代码变成有效的、有用的通信工具，如果只需要为测试代码制定明确的指导方针，那就太可惜了。

# hibernate - Creating table when using in-memory database

> ID：11543121
> 
> 赞同：0
> 
> 时间：2012-07-18T13:57:57.263
> 
> 标签：hibernate, derby

I am using Hibernate for connecting to derby . i am using derby as an in-memory database for my application. I am completely new to hibernate and derby stuff. I have two xml files, sample.cfg.xml and sample.hbm.xml. The sample.hbm.xml contains the mapping between the table and the bean class. I am setting the in-memory db as follows:

```
 Dialect = org.hibernate.dialect.DerbyDialect
       DriverClassName = org.apache.derby.jdbc.EmbeddedDriver
       Url= jdbc:derby:unitTestDB;create=true
       UserName = ""
       Password="" 
```

My question is , will the table be automatically created ? (by using the sample.hbm.xml as a reference) or do i need to create the table separately ? Pardon my ignorance as i am completely new to this.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:34:00.603

默认情况下，不会自动创建表。如果您建议 Hibernate 通过为配置中的属性提供所需的值来创建表`hibernate.hbm2ddl.auto`（属性位于您在查询中列出的其他属性的同一位置），则将创建表。

一般而言，最有可能开发*create-drop*是最佳选择，每次部署时，您都将从新数据库开始。对于内存来说，它当然总是新鲜的。其他选项是：*validate*、*update*和*create*。

# c++ - Fastest way to count/ access DOMNode children using Xerces C++

> ID：11543130
> 
> 赞同：2
> 
> 时间：2012-07-18T13:58:26.513
> 
> 标签：c++, xerces, xerces-c

I'm trying to figure out the fastest way to count the number of child elements of a Xerces C++ DOMNode object, as I'm trying to optimise the performance of a Windows application which uses the Xerces 2.6 DOMParser.

It seems most of the time is spent counting and accessing children. Our application needs to iterate every single node in the document to attach data to it using `DOMNode::setUserData()` and we were initially using `DOMNode::getChildNodes()`, `DOMNodeList::getLength()` and `DOMNodeList::item(int index)` to count and access children, but these are comparatively expensive operations.

A large performance improvement was observed when we used a different idiom of calling `DOMNode:: getFirstChild()` to get the first child node and invoke `DOMNode::getNextSibling()` to either access a child at a specific index or count the number of siblings of the first child element to get a total child node count.

However, `getNextSibling()` remains a bottleneck in our parsing step, so I'm wondering is there an even faster way to traverse and access child elements using Xerces.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T02:04:08.903

> 是的，在我发布后不久，我添加了代码来存储和管理每个节点的子数，这产生了很大的不同。重复访问相同的节点并且每次都重新计算子计数。这是一项相当昂贵的操作，因为 Xerces 本质上是为该节点重建 DOM 结构以保证其活跃性。我们有自己的对象，它封装了一个 Xerces DOMNode 以及我们需要的额外信息，我们使用 DOMNode::setUserData 将我们的对象与相关的 DOMnode 关联起来，现在这似乎是最后剩下的瓶颈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-11T08:28:27.153

问题`DOMNodeList`在于，它实际上是一个非常简单的列表，因此在[代码](https://github.com/apache/xerces-c/blob/b73d4a9a57f7c03df64413e123fba9dd10aa62f1/src/xercesc/dom/impl/DOMNodeListImpl.cpp#L46)中可以看到像这样的操作`length`并且`item(i)`具有 as 的成本，例如这里的长度：`O(n)`

```
XMLSize_t DOMNodeListImpl::getLength() const{
    XMLSize_t count = 0;
    if (fNode) {
        DOMNode *node = fNode->fFirstChild;
        while(node != 0){
            ++count;
            node = castToChildImpl(node)->nextSibling;
        }
    }

    return count;
} 
```

因此，`DOMNodeList`如果不希望在迭代时更改 DOM 树，则不应使用，因为访问项目`O(n)`从而使迭代成为一种`O(n^2)`操作 - 等待发生的灾难（即 xml 文件足够大）。

使用`[DOMNode::getFistChild()][2]`and[`DOMNode::getNextSibling()`](https://xerces.apache.org/xerces-c/apiDocs-3/classDOMNode.html#a4149ddc7ca78a13610e57dcd5cfb42d7)是一个足够好的迭代解决方案：

```
DOMNode *child = docNode->getFirstChild();
while (child != nullptr) {
    // do something with the node
    ...
    child = child->getNextSibling();
} 
```

正如预期的那样发生在`O(n^2)`.

也可以使用`[DOMNodeIterator][3]`，但为了[创建它](https://xerces.apache.org/xerces-c/apiDocs-3/classDOMDocumentTraversal.html#ab44df9d4b136bea37d02a5d881879c49)，需要正确[`DOMDocument`](https://xerces.apache.org/xerces-c/apiDocs-3/classDOMDocument.html)的，当需要迭代时并不总是在手边。

# php - 创建负条形图和覆盖第二个图表的能力的图表库

> ID：11543132
> 
> 赞同：0
> 
> 时间：2012-07-18T13:58:28.847
> 
> 标签：php, javascript, charts, visualization

我知道有很多 js 和 php 图表库，尽管我不确定创建图表的最佳方法，使其看起来与下面显示的图像非常相似：

我正在尝试创建一个允许我使用负值的图表 - 棘手的一点是“深灰色”覆盖，因为我不确定执行此操作的最佳库，我使用过 Google Charts 但没有太多成功。

欢迎任何建议 - 谢谢:)

![带有负值和次要叠加值的图表](../Images/8a12d9d66eef0af75890eaccc056dbcc.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:55:30.523

您可以使用 amCharts.com 轻松实现此目的：

1）以此图表为基础：[http](http://amcharts.com/javascript/stacked-bar-chart/) ://amcharts.com/javascript/stacked-bar-chart/ 2）创建2个连续图表（您也可以用一个图表实现完全相同，但可能有点复杂设置标签）3）最重要的 - 将 ValueAxis 的 stackType 设置为“3d”。这将使条形像您的示例一样覆盖。4) 将底层图的 fillAlphas 设置为 <1 值，以便它们是透明的。

# c++ - 粒子系统物理行为怪异

> ID：11543133
> 
> 赞同：1
> 
> 时间：2012-07-18T13:58:30.930
> 
> 标签：c++, physics, simulation, particles

我的粒子系统的物理更新功能似乎不正确。我的目标是让所有粒子都被吸引到鼠标上。

粒子像预期的那样向鼠标指针移动，直到它们非常靠近。当它们靠近时，它们会加速很多，以至于它们飞离指针很远并且永远不会返回。

这是更新功能：

```
void updateParticle(particle& p,double time){
    const double G=0.000000000066726;
    const double POINTERMASS=1000000000000;

    double squareDistance=pow(p.coords.x-pointerDevice.x,2)+pow(p.coords.y-pointerDevice.y,2)+pow(p.coords.z-pointerDevice.z,2);
    if(squareDistance<0.001)
        squareDistance=0.001;//to fix the possible division by zero

    coords_3d_f accelerationVector={p.coords.x-pointerDevice.x,p.coords.y-pointerDevice.y,p.coords.z-pointerDevice.z};

    accelerationVector=vector_scalar_multiplication(vector_unit(accelerationVector),((G*POINTERMASS)/squareDistance));
    accelerationVector=vector_scalar_multiplication(accelerationVector,time);

    p.velocity=vector_addition(p.velocity,accelerationVector);

    p.coords.x-=p.velocity.x*time;
    p.coords.y-=p.velocity.y*time;
    p.coords.z-=p.velocity.z*time;
} 
```

当 squareDistance 为常数时，程序看起来不错，但我知道它是错误的。

那么，我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T14:04:00.860

力与距离的平方成反比，因此当距离接近 0 时，力（和加速度）接近无穷大。换句话说，如果粒子非常接近，它们也会变得非常快。

如果你想在物理上准确，让你的指针对象有一个有限的大小，这样粒子就会从它上面反弹。

如果不需要精确，可以在粒子非常靠近时使力*减小。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:03:09.540

这很简单：当粒子与鼠标指针接触时 ，由于除以零是非法的，因此您的粒子会`squareDistance`变成`0`并产生未定义的行为。`((G*POINTERMASS)/squareDistance)`

这可能对您更有效：

```
if (squareDistance >= 1.0) // 1.0 is the zero tolerance for your context of pixel distances
{
    // proceed normally
    accelerationVector=vector_scalar_multiplication(vector_unit(accelerationVector),((G*POINTERMASS)/squareDistance));
    accelerationVector=vector_scalar_multiplication(accelerationVector,time);
}
else
{
    // no acceleration
    accelerationVector=/*{0, 0}*/;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:14:47.993

当您的粒子非常接近鼠标指针时，粒子将具有**非常**高的速度。当这个速度乘以这个速度`time`时，粒子将跳得很远。

您可以尝试通过设置最大速度来解决此问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T15:15:16.480

模拟运动方程涉及在有限间隔内对函数进行积分，因此只能近似该函数。这会导致系统不稳定。一个简单快速的解决方案是使用固定步骤*verlet 集成*：

```
void integrate(particle& p, double t2, const particle& mouse)
{
  // universal gravitational constant
  const double G = 0.000000000066726;

  // artificial drag
  // set it to 1.0 to not have any drag
  // set it to 0.0 to not have any momentum
  const double drag = 0.99;

  // get direction and distance between the particle and the mouse
  dvec3 dir = p.pos - mouse.pos;
  double dist2 = dot(dir, dir);
  double dist = sqrt(dist2);
  dir /= dist;

  // calculate relative acceleration vector
  dvec3 a = -dir * G * (p.mass + mouse.mass) / dist2;

  // verlet integration
  dvec3 tmp = p.pos;
  p.pos += (p.pos - p.prev_pos) * drag + a * t2;
  p.prev_pos = tmp;
}

void update(particle& p, double elapsed, const particle& mouse, double& accumulator)
{
  // fixed timestep (arbitrary)
  const double timestep = 1.0 / 120.0;
  const double timestep2 = timestep * timestep;

  // "accumulate" time
  accumulator += elapsed;

  // "consume" time
  while(accumulator > timestep)
  {
    // perform integration
    integrate(p, timestep2, mouse);
    accumulator -= timestep;
  }
} 
```

注意：为了清楚起见，它使用[GLM 数学库](http://glm.g-truc.net/)。

# java - Java反射：在运行时检查方法参数的类型

> ID：11543134
> 
> 赞同：9
> 
> 时间：2012-07-18T13:58:32.573
> 
> 标签：java, reflection

我需要检查方法第一个参数的类型是否`List<Class<? extends Exception>>`。任何人都可以提出比将其与字符串进行比较更好的解决方案吗？

```
Method m = Foo.class.getMethod("m1", List.class);
if (m.getGenericParameterTypes()[0].toString().equals("java.util.List<java.lang.Class<? extends java.lang.Exception>>")) {
  ...
} 
```

我的意思是这样的：

```
List.class.isAssignableFrom((Class<?>)((ParameterizedType)m.getGenericParameterTypes()[0]).getRawType())); 
```

这检查它是否是一个列表。但是我怎样才能检查`Class<? extends Exception>`类型的一部分呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T14:17:43.423

刚刚尝试了以下，它似乎工作：

```
// package whatever.your.package.happens.to.be;

import java.lang.reflect.Method;
import java.lang.reflect.ParameterizedType;
import java.lang.reflect.WildcardType;
import java.util.List;

public class ReflectionTest {
  public static void main(String[] args) throws NoSuchMethodException, SecurityException {
    Method method = ReflectionTest.class.getMethod("method", List.class);
    ParameterizedType listType = (ParameterizedType)method.getGenericParameterTypes()[0];
    ParameterizedType classType = (ParameterizedType)listType.getActualTypeArguments()[0];
    WildcardType genericType = (WildcardType)classType.getActualTypeArguments()[0];
    Class<?> genericClass = (Class<?>)genericType.getUpperBounds()[0];

    boolean isException = Exception.class.isAssignableFrom(genericClass);
    // vvv Prints out "Is Class<? extends Exception>: true"
    System.out.println("Is Class<? extends Exception>: " + isException);

    boolean isRuntimeException = RuntimeException.class.isAssignableFrom(genericClass);
    // vvv Prints out "Is Class<? extends RuntimeException>: false"
    System.out.println("Is Class<? extends RuntimeException>: " + isRuntimeException);
  }

  public void method(List<Class<? extends Exception>> exceptionClasses) {
    // Do something with "exceptionClasses," I would imagine...
  }
} 
```

**编辑：**好的，这次是真的。我**刚才**注意到它是`List<Class<? extends Exception>>`而不是`List<? extends Exception>`。所以这个（希望）最终解决方案实际上应该与这种情况相匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:19:29.993

编辑：

问：如何从参数参数中读取上限？

例如我们将使用方法描述

`public void testMethod(Collection<? extends Exception);`

首先我们必须访问方法参数的参数

```
 ParametrizedType parametrizedType = (ParametrizedType)method.getGenericParametersTypes()[0]; 
```

从这里`parametrizedType`我们必须得到它的论点：

```
Type argumentOfargument  parametrizedType.getActualTypeArguments()[0]; 
```

到目前为止一切顺利，现在我们需要检查这`argumentOfargument`是否是通配符。

```
if(arguemntOfargument instaceof WildcardType) {
   WidlcardType wildcardArgumentofArgumentType = (WidlcardType )argumentOfargument;  
} 
```

此时，我们有两个 upper 选项：

```
 return  wildcardArgumentofArgumentType.getUpperBounds()[0] 
```

或更低：

```
 return  wildcardArgumentofArgumentType.getLowerBounds()[0] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:01:34.757

我认为在类型擦除之后你不能得到那种信息。

如果您不知道它是如何工作的，请查看官方文档： [Java 类型擦除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)

简而言之，当编译器解释您的代码时，它会清除所有通用信息并将它们替换为有界参数或`Object`如果它们未绑定则替换它们。

但是，您可以使用`instanceof`运算符来检查`Exception`类型。

**编辑：**如果您想在实际调用方法之前检查参数，您可以尝试使用代理模式。详细信息：[代理模式](http://en.wikipedia.org/wiki/Proxy_pattern)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T14:27:42.373

您是否需要它是具体`List<Class<? extends Exception>>`的，或者超类型（例如`Collection<Class<? extends Exception>>`，甚至`Object`）可以吗？我问是因为您提到`isAssignableFrom`，它寻找子类型 - 超类型关系。

如果您正在寻找子类型-超类型关系，那么您可以执行 Random Human 描述的操作。

如果您正在寻找精确匹配，那么您应该能够使用`equals`：反射 API 中的各种类和接口指定`equals`. 例如，[`ParameterizedType`说](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/ParameterizedType.html)：

> 实现此接口的类的实例必须实现一个 equals() 方法，该方法等同于任何两个共享相同泛型类型声明并具有相同类型参数的实例。

当然，这需要在某个`List<Class<? extends Exception>>`参数的某处有一些示例，您可以获取其类型并对其进行`equals`比较。

（但老实说，这种`toString`方法虽然很老套，但对我来说并没有那么糟糕！）

# android - 在 1024 x 600 分辨率设备中运行应用程序的问题

> ID：11543136
> 
> 赞同：0
> 
> 时间：2012-07-18T13:58:38.073
> 
> 标签：android

在我的 res 文件夹中，我有 layout-hdpi、layout-mdpi、layout-xhdpi 和 layout-ldpi 文件夹。现在我的问题是分辨率为 1024 x 600 的平板电脑从 layout-mdpi 文件夹中获取布局。因此，我也很难管理其他设备的布局。因为分辨率为 320 x 480 的 HVGA 设备也从 layout-mdpi 文件夹中获取布局。那么我该如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:05:34.527

这是一篇很好的文章。简而言之，您可以创建 layout-w600dp 资源文件夹，其中可以是 1024 x 600 平板电脑的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:06:34.397

你可以用来举例

**layout-mdpi**用于 HVGA 设备，**layout-mdpi-sw1024dp**用于分辨率为 1024*600 的平板电脑 - sw 表示最小宽度

你可以在这里找到所有可用的选项：http: [//developer.android.com/guide/topics/resources/providing-resources.html](http://developer.android.com/guide/topics/resources/providing-resources.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:03:29.937

它们是`Size`like `small`, `large`, `xlarge`... 的一些限定词，您可以使用它们。

[更多](http://developer.android.com/guide/practices/screens_support.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T09:07:16.567

您可以尝试为具有 7" 和 1024*600 res 的平板电脑创建名称为 layout-sw600dp 而不是 layout-mdpi 的文件夹。我相信它对你有用，因为它对我有用。如果它在运行时给你运行时异常然后在模拟器中检查目标设备的api级别。将其增加到11级。您也可以在下面的链接中参考与您的问题类似的我的问题的答案：

[在此处输入链接描述](https://stackoverflow.com/questions/15697593/how-to-differentiate-7-1024600-tablet-and-10-1-1280800-tablet-at-design)

如果您有任何疑问，请随时提出......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T14:10:00.703

密度不是可以更改布局的唯一参数。尺寸是另一个。请查看以下链接中的表格，了解您可以使用的所有选项。layout-large 或 layout-xlarge 可能适合您。

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

# c# - asp:button 和 javascript 弹出窗口

> ID：11543139
> 
> 赞同：2
> 
> 时间：2012-07-18T13:58:50.960
> 
> 标签：c#, javascript, asp.net, button, popup

我想添加一个简单的确认，当您单击执行回发的 asp:button 时确定对话框。就像是：

```
OnClientClick="if(confirm('Format the hard disk?'))
alert('something');
else alert('something else')" 
```

问题是无论您单击确定还是取消它仍然会发回。如何使它只回发OK？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:12:18.443

你也可以使用下一个：

```
OnClientClick="return confirm('Delete this entity?');" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:13:06.530

如果您只是想根据确认对话框中的选择进行回发，这可能更简单：

```
OnClientClick="return confirm('Are you sure?');" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:06:37.990

总之“ `....; return false;`”停止点击，下面的例子不使用内联JS：

**标记：**

```
OnClientClick="confirmSomething()"; 
```

**JS功能：**

```
function confirmSomething()
{
    var result = confirm('Format the hard disk?');
    if(result == 1)
    {
       alert('something');
       return true; //continue click event
    }
    else if(result == 0)
    {
       alert('something else');
       return false; //stop click event
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T14:04:04.890

使用返回假。

```
OnClientClick="if(confirm('Format the hard disk?')) alert('something'); else {alert('something else'); return false;}" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T14:05:21.500

您需要返回确认。

见：[http ://rumandcode.wordpress.com/2008/08/11/javascript-confirm-on-aspnet-button/](http://rumandcode.wordpress.com/2008/08/11/javascript-confirm-on-aspnet-button/)

# .net - Telerik 控件 - .NET 版本兼容性问题

> ID：11543141
> 
> 赞同：1
> 
> 时间：2012-07-18T13:58:53.620
> 
> 标签：.net, .net-4.0, frameworks, web

我稍微增强了一个旧网站，但问题是我使用了 Telerik 控件，它需要比原始网站更高版本的 .net。该网站在外部托管，我只能通过 ftp 站点访问该网站本身。

我的问题是设置此站点以能够处理 .net 4.0 的最简单方法是什么？我相信 4.0 已经向后兼容了。我几乎可以肯定旧服务器上的 IIS 版本正在运行 .net 4.0。

先感谢您..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:02:22.923

您不能在同一应用程序池中运行依赖于不同版本的 .NET 运行时的 .NET 应用程序。不幸的是，如果您唯一的控制是通过 FTP，那么您将无法为该应用程序或任何其他应用程序配置应用程序池。您必须要求您的托管公司为此站点的目录设置一个应用程序池，以便您可以运行 .NET 4.0。

# ruby-on-rails - 如何在“有很多通过”多态关联中定义运行时 source_type？

> ID：11543150
> 
> 赞同：1
> 
> 时间：2012-07-18T13:59:33.450
> 
> 标签：ruby-on-rails, activerecord, model-associations

有什么方法可以`source_type`在 rails`has_many` `through` `polymorphic`关联中定义运行时。

下面的代码应该给你一个简短的想法..但它不起作用..有什么建议吗？

```
class A < ...
  has_many :message_messagables, :foreign_key => :message_id

  has_many :messagables, :through => :message_messagables, :source => :messagable, :source_type => lambda { |a| a.custom_type }

 def custom_type
   raise "needs to be defined inside subclass"
 end

end

class MessageMessagable < ... 
 belongs_to :messagable, :polymorphic => true #[C, D]
 belongs_to :message
end

class B < A

 def custom_type
   "C"
 end
end

class E < A
 def custom_type
   "D"
 end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-27T12:26:45.143

我遇到了同样的问题。我通过列出所有可用的源类型并添加了一个调度方法来解决它。

```
class A < ...
  has_many :message_messagables, :foreign_key => :message_id

  # list all source types as association
  %w(email file).each do |source_type|
    has_many source_type.pluralize.to_sym, :through => :message_messagables, :source => :messagable, :source_type => source_type
  end

  # dispatch methodk
  def messagables
    public_send custom_type.pluralize.to_sym
  end
end 
```

# android - AccessibilityEvent.TYPE_NOTIFICATION_STATE_CHANGED 是否适用于果冻豆？

> ID：11543151
> 
> 赞同：0
> 
> 时间：2012-07-18T13:59:47.787
> 
> 标签：android, notifications, accessibility, android-4.2-jelly-bean

我有一项服务正在运行以收集可访问性事件。在 Jelly Bean 中，它不会捕获 TYPE_NOTIFICATION_STATE_CHANGED 事件的任何变化。我按照教程进行操作，但没有...

这是我的代码：

```
@Override
protected void onServiceConnected() {
    super.onServiceConnected();

    AccessibilityServiceInfo localAccessibilityServiceInfo = new AccessibilityServiceInfo();
    localAccessibilityServiceInfo.eventTypes = AccessibilityEvent.TYPES_ALL_MASK;          
    localAccessibilityServiceInfo.notificationTimeout = 80L;
    localAccessibilityServiceInfo.feedbackType = AccessibilityServiceInfo.DEFAULT;
    setServiceInfo(localAccessibilityServiceInfo);
}

@Override
public void onAccessibilityEvent(AccessibilityEvent event) {
    if(event.getEventType() ==  AccessibilityEvent.TYPE_NOTIFICATION_STATE_CHANGED)
        doSomething(); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T09:23:09.190

在此处查看我的帖子AccessibilityService 已启动，但在我设法使其正常工作的方式[上没有收到 JellyBean 上的 AccessibilityEvents](https://stackoverflow.com/questions/12019848/accessibilityservice-is-started-but-does-not-receive-accessibilityevents-on-jell/12042493#12042493)

出于某种原因，用于注册事件的声明性 xml 似乎有效，但使用代码注册它们（如 ICS 之前的版本必须）似乎并没有发现这些事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T01:28:33.537

是的。至少从我开始编写应用程序的 2.0 开始，所有版本的 Android 都有可能完全按照您所说的进行。见这里[https://gist.github.com/1909616](https://gist.github.com/1909616)

# xamarin.ios - monotouch 将项目绑定到框架

> ID：11543154
> 
> 赞同：0
> 
> 时间：2012-07-18T13:59:56.903
> 
> 标签：xamarin.ios

为框架和库创建绑定项目的正确步骤是什么？（是的，它们接近于同一个东西，但不一样，框架是一个包含头文件、库和资源的目录结构）。这些是我想出的，请注意，据我在 Xamarin 网站上所知，没有任何框架特定步骤被记录（请证明我错了）。

1.  通过 MonoDevelop 向导创建绑定项目。

2.  使用 btouch 或手动生成 ApiDefinition.cs 和 StructsAndEnums.cs 文件。

3.  将文件从框架目录的根目录复制到 lib.a（例如，ArcGIS 到 libArcGIS.a）并将其添加到工程中。需要注意的是，框架目录中没有任何文件扩展名的文件实际上是一个库文件。

4.  ?? 包括框架资源？？

你会注意到我在第三步变得模糊不清。如何将这些资源添加到绑定项目？大部分绑定项目链接并运行良好，但我认为它有时会崩溃，因为它缺少预期的资源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T13:42:31.427

您必须 (a) 创建一个描述 Objective-C 合同的 C# 合同以及您希望投影到 C# 中的样子，以及 (b) 将库与您的项目一起静态分发。

要自动填充 linkwith.cs，您必须重命名框架库（例如 MyFramework）以使用库模式（在本例中为“libMyFramework.a”）

您必须选择并标记为资源的资源，它们将直接捆绑到您的应用程序中，并在使用库时提取。

# ruby - Nokogiri 扩展现有 XML

> ID：11543157
> 
> 赞同：0
> 
> 时间：2012-07-18T14:00:16.670
> 
> 标签：ruby, xml, nokogiri

我正在尝试扩展现有的 XML 文件并添加一个新节点。我正在加载包含很多产品的 XML，添加一个新的并保存它。

我正在使用 Nokogiri 和 Ruby 1.9.3。

这是我创造的最好的：

```
builder = Nokogiri::XML::Builder.new do
  root do
    load_xml = Nokogiri::XML(IO.read("test.xml"))
    parent.add_child(load_xml.root)
    data do
      name "Name"
    end
  end
end

file = File.open("test.xml",'w')
file.puts builder.to_xml
file.close 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T16:15:52.873

`Nokogiri::XML::Builder`实际上只在创建新的 XML 文件时使用，而不是在编辑它们时使用。

此外，您的代码加载 XML 并将其放入新的根节点（根），同时将新的子节点（数据节点）附加到它。这真的是理想的行为吗？

通常你会像这样添加一个节点：

```
doc = Nokogiri::XML(IO.read("test.xml"))
name_node = Nokogiri::XML::Node.new("name",doc)
name_node.content = "Name"
data_node = Nokogiri::XML::Node.new("data",doc)
data_node.add_child(name_node)
doc.root.add_child(data_node)

file = File.open("test.xml",'w')
file.puts doc.to_xml
file.close 
```

这没有创建一个新的根节点，因为这对我来说似乎有点奇怪......

您也可能想尝试[Nokogiri-Documentation](http://nokogiri.org/tutorials/modifying_an_html_xml_document.html)，它相当广泛。

还有其他方法可以`Nokogiri::XML::Builder`用来创建包括*数据*在内的所有缺点，这将是这种组合方法的一个示例：

```
builder = Nokogiri::XML::Builder.new do
  data do 
    name "Name"
  end
end
doc = Nokogiri::XML(IO.read("test.xml"))
doc.root.add_child builder.doc.root

file = File.open("test.xml",'w')
file.puts doc.to_xml
file.close 
```

# javascript - 为什么 $().map 会产生循环引用

> ID：11543168
> 
> 赞同：8
> 
> 时间：2012-07-18T14:00:53.913
> 
> 标签：javascript, jquery

Chrome`array.map`工作正常，但 jQuery`.map`以某种方式产生循环引用。我看不到任何使用 循环引用的证据`console.log`，但 JSON.stringify`Uncaught TypeError: Converting circular structure to JSON`在第二个块中抛出。

在 JSFiddle 上运行它：http: [//jsfiddle.net/langdonx/vQBak/](http://jsfiddle.net/langdonx/vQBak/)

或者查看代码：

```
var callback = function(index, element) {
    return {
        "index": index
    };
};

var array1 = ["1", "2"];
var mappedArray1 = array1.map(callback);
console.log(mappedArray1);
var json1 = JSON.stringify(mappedArray1);
console.log(json1);

var jqueryArray2 = $('body > div');
var mappedArray2 = jqueryArray2.map(callback);
console.log(mappedArray2);
var json2 = JSON.stringify(mappedArray2); // Chokes with "Uncaught TypeError: Converting circular structure to JSON"
console.log(json2);​ 
```

是的，我使用的是相同的回调，是的，ECMAScript`map`以不同的顺序传递参数，但是对于这个例子来说这无关紧要，因为它们都是简单的类型（字符串、数字）。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-18T14:05:31.080

jQuery[`.map()`](http://api.jquery.com/map/)函数返回一个包含数组的 jQuery 对象，而不是实际的数组，这可能是一个重要的区别。尝试调用：

```
var json2 = JSON.stringify(mappedArray2.get()); 
```

调用`.get()`将返回实际数组而不是 jQuery 对象。

# objective-c - 当前日期格式为“MMM dd, yyyy hh:mm:ss a”时如何转换为第二天？

> ID：11543171
> 
> 赞同：-2
> 
> 时间：2012-07-18T14:01:03.080
> 
> 标签：objective-c, ios, date

我的申请中有一个日期，格式如下：

```
"MMM dd, yyyy hh:mm:ss a" 
```

用户从选择器中选择一天，并且日期始终转换为此格式。从这种格式我怎样才能得到正好 24 小时后的日期？

例如，如果日期是`Mon 24 , 2012 17:44:33`我需要将其转换为`Tue 25 , 2012 17:44:33`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:04:09.677

1.  阅读[日期和时间编程指南](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/DatesAndTimes/DatesAndTimes.html#//apple_ref/doc/uid/10000039-SW1)。

2.  使用日期格式化程序从字符串生成日期。

3.  在日期上加一天。

4.  使用日期格式化程序从新日期生成字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:13:45.673

使用以下代码`NSDate`从您的字符串创建一个：

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setTimeZone:[NSTimeZone localTimeZone]];
[dateFormatter setCalendar:[NSCalendar currentCalendar]];
[dateFormatter setDateFormat:<FORMAT_OF_DATE_STRING>];
NSDate *date = [dateFormatter dateFromString:<DATE_STRING>];
[dateFormatter release]; 
```

使用以下代码将天数添加到 a `NSDate`：

```
 NSDate *today =<YOUR_DATE>        
    NSCalendar *gregorian = [[NSCalendar alloc]
                             initWithCalendarIdentifier:NSGregorianCalendar];
    /*
     Create a date components to represent the number of days to add to the current date.         
     The weekday value for Sunday in the Gregorian calendar is 1, so add 1 from the number of days to subtract from the date in question.  (If today is Sunday, add 0 days.)    
     */
    NSDateComponents *componentsToAdd = [[NSDateComponents alloc] init];

    if(day<7)
    {
       [componentsToAdd setDay: day];
    }

    NSDate *calculateDay = [gregorian dateByAddingComponents:componentsToAdd
                                                      toDate:today options:0]; 
```

快乐编码！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:27:45.823

这是设置日期格式化程序所需的代码：

```
NSString *dateString = @"Tue 24 , 2012 17:44:33";

NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];

[dateFormat setDateFormat:@"EEE dd , yyyy HH:mm:ss"];

NSDate *theDate = [dateFormat dateFromString:dateString];

theDate = [NSDate dateWithTimeInterval:(60*60*24) sinceDate:theDate];

NSString *newDate = [dateFormat stringFromDate:theDate];

NSLog(@"%@",newDate); 
```

控制台返回：

```
2012-07-18 09:26:28.395 TesterProject[71645:f803] Wed 25 , 2012 17:44:33 
```

不过，您确实应该包括一个月，因为如果您不这样做，它只会占用当前月份，这可能会影响您一周中的某一天。

我使用了您输入的日期的实际格式，而不是您在问题中输入的错误格式。有关日期格式的信息，请参阅[unicode 标准](http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)。

有关`NSDateFormatter`此处的信息，请参阅 Apple 文档：[NSDateFormatter](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html)。

编辑：这是一个替代实现：

```
NSString *dateString = @"Tue 24 , 2012 17:44:33";

NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];

[dateFormat setDateFormat:@"EEE dd , yyyy HH:mm:ss"];

NSDate *theDate = [dateFormat dateFromString:dateString];

NSCalendar *gregorian = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];

NSDateComponents *offsetComponents = [[NSDateComponents alloc] init];

[offsetComponents setDay:1];

theDate = [gregorian dateByAddingComponents:offsetComponents toDate:theDate options:0];

NSString *newDate = [dateFormat stringFromDate:theDate];

NSLog(@"%@",newDate); 
```

它返回完全相同的东西。

# c - C：定义一个long为返回类型的函数的数组

> ID：11543174
> 
> 赞同：0
> 
> 时间：2012-07-18T14:01:06.833
> 
> 标签：c, return-type

在 C# 中我会这样做：

```
private long[] myMethodName()
{
    //etc
} 
```

C中的等价物是什么？

这给出了一个错误：

```
long[] readSeqFile(char *fileName) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:04:08.720

```
long *readSeqFile(char *filename); 
```

您可能想要制作`filename`const：

```
long *readFileName(const char *const filename); 
```

更新：虽然这回答了最初的问题，但它不是很好的 C 练习。如果，正如海报所说，他想从文件中读取整数列表并将其作为 long 数组取回，那么原型可能看起来像这样：

```
int readSeqFile(const char *const filename,long **longArray,size_t *const len); 
```

和实施（草图形式）：

```
#include <stdio.h>
#include <stdlib.h>

const size_t longArrayChunkSize=100;

int readSeqFile(const char *const filename,long **longArray, size_t *const len)
{
   FILE *fp;
   size_t nInts=0,curBufferLen;
   long tmp;

   fp=fopen(filename,"r");
   if(fp==NULL)
      return -1;

   *longArray=malloc(longArrayChunkSize*sizeof(long));
   if(*longArray==NULL)
      return -1;

   curBufferLen=longArrayChunkSize;

   // let's assume file is a list of integers, one per line
   while(read from file and !feof())
       {
       (scan line into tmp)
       longArray[nInts++]=tmp;
       if(nInts==curBufferLen)
          (realloc *longArray by longArrayChunkSize, increase curBufferLen)
       }

   *len=nInts;

   fclose(fp);

   return 0;
} 
```

像这样调用它：`result=readSeqFile(filename,&longArray,&arrayLen);` `longArray`是类型`long*`，调用者有责任在之后释放它。成功时结果为零，错误时结果为 -1。

这是您使用 C++ 和 STL 类获胜的地方，`vector<long>`因为您可以只`push_back()`从文件中取出每个类，而不必担心内存管理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:04:54.107

通常对于 C，你会传递一个指针和长度

```
// returns number of elements written
size_t myMethodName(long* dest, size_t len)
{
    //etc
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:04:30.173

没关系..我明白了：

```
long *readSeqFile(char *fileName) 
```

不管怎么说，还是要谢谢你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T15:55:15.823

在 C 中，函数不能返回数组类型；它们可以返回*指向*数组的指针，例如

```
long (*readSeqFile(char *filename))[N]
{
  ...
} 
```

缺点是如果您使用的是 C89 或更早版本的编译器，或者不支持可变长度数组的 C2011 编译器，则 N 必须是编译时间常数。如果您不知道阵列应该提前多大，您*可能*不想走这条路。

# php - 坏词过滤器集成

> ID：11543175
> 
> 赞同：1
> 
> 时间：2012-07-18T14:01:09.783
> 
> 标签：php

我正在尝试集成 php bad words filter 输入是通过 $_REQUEST['qtitle'] 和 $_REQUEST['question'] 但我没有这样做

```
$USERID = intval($_SESSION['USERID']);

if ($USERID > 0)
{
$sess_ver = intval($_SESSION[VERIFIED]);
$verify_asker = intval($config['verify_asker']);
if($verify_asker == "1" && $sess_ver == "0")
{
    $error = $lang['225'];
    $theme = "error.tpl";
}
else
{
    $theme = "ask.tpl";
    STemplate::assign('qtitle',htmlentities(strip_tags($_REQUEST['qtitle']), ENT_COMPAT, "UTF-8"));
    STemplate::assign('question',htmlentities(strip_tags($_REQUEST['question']), ENT_COMPAT, "UTF-8"));
    if($_REQUEST['subform'] != "")
    {
        $qtitle = htmlentities(strip_tags($_REQUEST['qtitle']), ENT_COMPAT, "UTF-8");
        $question = htmlentities(strip_tags($_REQUEST['question']), ENT_COMPAT, "UTF-8");
        $category = intval($_REQUEST['category']);

        if($qtitle == "")
        {
            $error = $lang['3'];
        }
        elseif($category <= "0")
        {
            $error = $lang['4'];
        }
        else
        {
            if($config['approve_stories'] == "1")
            {
                $addtosql = ", active='0'";
            }
            $query="INSERT INTO posts SET USERID='".mysql_real_escape_string($USERID)."', title='".mysql_real_escape_string($qtitle)."',question='".mysql_real_escape_string($question)."', tags='".mysql_real_escape_string($qtitle)."', category='".mysql_real_escape_string($category)."', time_added='".time()."', date_added='".date("Y-m-d")."' $addtosql";
            $result=$conn->execute($query);
            $userid = mysql_insert_id();
            $message = $lang['5'];
        }
    }
}
}   

else
{
$question = htmlentities(strip_tags($_REQUEST['qtitle']), ENT_COMPAT, "UTF-8");
$redirect = base64_encode($thebaseurl."/ask?qtitle=".$question);
header("Location:$config[baseurl]/login?redirect=$redirect");exit;
} 
```

我正在尝试以下代码，但此代码替换了每个单词（不包含在数组中）

```
FUNCTION BadWordFilter(&$text, $replace){

$bads = ARRAY (
  ARRAY("butt","b***"),
  ARRAY("poop","p***"),
  ARRAY("crap","c***")
);

  IF($replace==1) {                                        //we are replacing
  $remember = $text;

  FOR($i=0;$i<sizeof($bads);$i++) {               //go through each bad word
       $text = EREGI_REPLACE($bads[$i][0],$bads[$i][1],$text); //replace it
  }

  IF($remember!=$text) RETURN 1;                     //if there are any changes, return 1

 } ELSE {                                                  //we are just checking

  FOR($i=0;$i<sizeof($bads);$i++) {               //go through each bad word
       IF(EREGI($bads[$i][0],$text)) RETURN 1; //if we find any, return 1
  }     
 }
}
$qtitle = BadWordFilter($wordsToFilter,0); 
$qtitle = BadWordFilter($wordsToFilter,1); 
```

我在这里缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:19:13.517

我同意@Gordon 的观点，这是在重新发明轮子，但如果你真的想这样做，这里有一个更好的开始：

```
function badWordFilter(&$text, $replace)
{
    $patterns = array(
        '/butt/i',
        '/poop/i',
        '/crap/i'
    );

    $replaces = array(
        'b***',
        'p***',
        'c***'
    );

    $count = 0;
    if($replace){
        $text = preg_replace($patterns, $replaces, $text, -1, $count);
    } else {
        foreach($patterns as $pattern){
            $count = preg_match($pattern, $text);
            if($count > 0){
                break;
            }
        }
    }

    return $count;
} 
```

但是，有很多固有的问题。例如，对文本运行过滤器`How do you like my buttons?`......你最终会得到`How do you like my b***ons?`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:28:02.053

我认为你应该使用这种功能：

```
function badWordsFilter(&$text){
    $excluded_words = array( 'butt', 'poop', 'crap' );
    $replacements = array();

    $i = count($excluded_words);
    while($i--){
        $tmp = $excluded_words{0};
        for($i=0;$i<(strlen($excluded_words)-1);$i++){
            $tmp .= '*';
        }
        $replacements[] = $tmp;
    }

    str_replace($excluded_words, $replacements, $text);
} 
```

# html - 为什么列表样式类型不起作用？没有显示任何内容

> ID：11543179
> 
> 赞同：2
> 
> 时间：2012-07-18T14:01:26.247
> 
> 标签：html, css

CSS 和 HTML 代码如下所示。我使用了 eric meyer 的重置脚本。我编辑了我认为相关的那个。

```
 /* reset CSS script */

ol, ul {
    list-style: none;
}

/* End of reset CSS script */

#navbar {
    border: 5px solid red;
    margin: -580px 0 0 160px;
    width: 1500px; 

    font-size: 26px;
    font-family: 'Conv_LITHOSPRO-REGULAR';
}
#navbar ul li {     
        display:inline;
        padding:0 35px 0 0; 
        list-style-type:disc;
        } 
```

这是 HTML 代码。

```
 <nav id="navbar">
            <ul id="hli">
                <li id="OP"><a  href="Orders.html">Your Order</a></li>
                <li id="MP"><a  href="Menu.html">Menu</a></li>
                <li id="CUP"><a  href="ContactUs.html">Contact Us</a></li>
                <li id="JP"><a  href="Jobs.html" target="_blank">Jobs</a></li>
                <li id="TCP"><a  href="TC.html">Terms & Conditions</a></li>
            </ul>   
        </nav> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T14:27:06.300

该[`list-style-type`属性](http://www.w3.org/TR/CSS21/generate.html#propdef-list-style-type)仅适用于元素`display: list-item`。因此，如果您想在已转换为内联元素的列表项之前放置一些标记，则必须直接或通过生成的内容将标记添加到内容中。例如，以下在每个项目之前放置一个项目符号“•”和一个空格：

```
#navbar ul li:before {
   content: "\2022  "
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-04T15:59:25.290

在我的情况下，overflow-x:hidden 导致了这个问题。

# c++ - 使用抽象返回类型设计继承

> ID：11543182
> 
> 赞同：1
> 
> 时间：2012-07-18T14:01:38.037
> 
> 标签：c++, templates, design-patterns, inheritance, abstract-class

这是我试图实现的粗略图像（它不会编译，所以认为它是伪代码）。请注意，尽管该示例基于公钥密码方案，但问题是关于设计模式、模板和继承。

```
class CryptoProvider
{
public:
    template <typename T>
    virtual T Encrypt ()
    {
        T data;

        return data;
    }
};

class Paillier : public CryptoProvider
{
public:
    typedef int Ciphertext;

    Ciphertext Encrypt ()
    {
        Ciphertext data;
        return data;
    }
};

class ElGamal : public CryptoProvider
{
public:
    struct Ciphertext
    {
    public:
        int c1;
        int c2;
    };

    Ciphertext Encrypt ()
    {
        Ciphertext data;
        return data;
    }
}; 
```

基本上，我想在 CryptoProvider 中提供一些通用功能，如果需要，它可以被派生类覆盖，否则我会得到很多重复的代码。如果`Encrypt`只是需要创建一个变量并调用另一个函数，那么我不想在每个派生类中都编写这段代码，但是，如果派生类需要对数据进行一些额外的处理，它应该能够覆盖基础方法。

我遇到的最大限制是通过指定完全不同的返回类型来以某种方式覆盖 Encrypt 函数。有人可以为我指出如何实现这一目标的正确方向吗？我应该坚持传统继承还是应该尝试使用[CRTP](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)进行编译时/静态多态性？我不知道从哪里开始。

我还想强制派生类来实现某些方法，但我不确定如何实现这一点，如果第一个问题的解决方案要求我放弃标准继承（并且我不会从虚拟方法中受益）.. .

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:45:10.840

您所有的子类都将`Ciphertext`类型定义为不同的事物。这建议将其作为模板参数`CryptoProvider`。

```
template <typename T>
class CryptoProvider
{
public:
    virtual T Encrypt () { ... }
    typedef T Ciphertext;
};

class PaillierBase : public CryptoProvider<int> { ... } 
```

恕我直言，这里不需要 CRTP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:34:05.990

CRTP 将致力于提供编译时可覆盖的功能，而无需虚拟功能：

```
template <typename Derived> class CryptoProvider
{
public:
    typename Derived::Ciphertext Encrypt() {
        typename Derived::Ciphertext data;
        return data;
    }
};

class PaillierBase
{
public:
    typedef int Ciphertext;
};

class Paillier : public CryptoProvider<PaillierBase>
{
public:
    void test1() {
        Encrypt();
    }
};

class ElGamalBase
{
public:
    struct Ciphertext {
        int c1;
        int c2;
    };
};

class ElGamal : public CryptoProvider<ElGamalBase>
{
public:
    void test2() {
        Encrypt();
    }
}; 
```

返回类型需要在基类中声明，当您从它派生 CRTP 模板时，该基类必须是完整类型。下面的代码不起作用，至少在 C11 之前的编译器中：在点 P，类 ElGamal 还不是一个完整的类型，因此 CryptoProvider::Encrypt() 不能被实例化。我不知道 C11 是否在这里改变了什么。恕我直言，这是语言的一个愚蠢的缺点。

```
// Doesn't work, unfortunately
class ElGamal : public CryptoProvider<ElGamal> /* P */
{
public:
    struct Ciphertext {
        int c1;
        int c2;
    };
    void test2() {
        Encrypt();
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T15:11:39.447

请参阅另一种方法来实现这一点。不过，有点绕圈子……这提供了基于模板和可派生性的通用实现的可能性。唯一的问题是 CipherText 定义不能在派生类中。我想这对你来说不是什么大问题。如果您可以在全局范围内定义这些类，则可以摆脱额外的派生。

```
template <typename T>
class CryptoProvider
{

public:
    virtual T Encrypt()
    {
        T data;

        return data;
    }
};

class PaillierBase
{
public:
   typedef int Ciphertext;
};

class Paillier : public PaillierBase, public CryptoProvider<PaillierBase::Ciphertext>
{
public:

};

class ElGamalBase
{
public:
    struct Ciphertext
    {
    public:
        int c1;
        int c2;
    };

};

class ElGamal : public ElGamalBase, public CryptoProvider<ElGamalBase::Ciphertext>
{
public:

};

class CustomEncryptorBase
{
public:
    struct Ciphertext
    {
    public:
        char* c1;
        int* c2;
    };

};

class CustomEncryptor : public CustomEncryptorBase, public CryptoProvider<CustomEncryptorBase::Ciphertext>
{
public:

    virtual CustomEncryptorBase::Ciphertext Encrypt()
    {
        CustomEncryptorBase::Ciphertext data;

        //  Do additional processing

        return data;
    }
};

int main()
{
    ElGamal e;
    ElGamalBase::Ciphertext c = e.Encrypt();

    CustomEncryptor ce;
    CustomEncryptorBase::Ciphertext c1 = ce.Encrypt();

    return 0;
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T14:29:09.860

您可以创建一个名为 CipherText 的基类，在其中保存密文。然后，您可以将其子类化为您需要返回的特定类型。您可以将返回类型指定为基类指针。

当然，根据您要执行的操作，此答案可能是对还是错。

# java - 从 GAE Blobstore 提供文件

> ID：11543185
> 
> 赞同：0
> 
> 时间：2012-07-18T14:01:45.000
> 
> 标签：java, google-app-engine, google-cloud-datastore, blobstore

每当我们从 Blobstore API 提供文件时，我都曾多次遇到过这个问题。它总是被下载为：

serve.fileNameExtention

是否有任何可能的方式可以使用我们保存的名称提供或下载文件。

即 someName.docx

如果可能，请告诉我该怎么做，因为我已经在互联网上搜索过，但我找不到任何解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:16:17.437

将其设置在标题中：

```
public void doGet(HttpServletRequest req, HttpServletResponse res)
    throws IOException {
        BlobKey blobKey = new BlobKey(req.getParameter("blob-key")); //example
        String filename = "someName.docx";
        res.setHeader("Content-Disposition", "attachment; filename=\"" +fileName +\"");

        blobstoreService.serve(blobKey, res);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T09:17:32.873

```
BlobKey blobKey = new BlobKey(key);                

BlobInfo blobInfo =  new BlobInfoFactory().loadBlobInfo(blobKey);
// set response header
response.setContentType(blobInfo.getContentType());
response.setHeader("Content-Disposition", "filename=" + blobInfo.getFilename());

// serve blob
blobService.serve(blobKey, response); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:15:14.793

您必须更改提供文件的 url 中的文件名。您可以使用 urlRewriteFilter (https://code.google.com/p/urlrewritefilter/) 之类的东西来重写 url，以允许您仍然使用“服务”servlet，但在离开 servlet 时将 url 更改为无论你想让他们成为什么样的人。

# jquery - 无法在隐藏/显示 div 中加载外部页面

> ID：11543186
> 
> 赞同：1
> 
> 时间：2012-07-18T14:01:48.087
> 
> 标签：jquery

我的问题是：

我有一些外部页面，当我点击派对的主照片时，我会从我`fotos1.asp`的内部调用。`#fotos_dentro``index.asp`

这张主照片在另一个 div`#fotos`中。我使用一些 jquery 脚本来处理这个问题。

我有一些滚动条脚本.. 那么发生了什么？

我`fotos1.asp`没有出现在`#fotos_dentro`.

这是我的脚本：

```
$(function(){

   $("#fotos_dentro").hide();

    $('.fotos1').live('click', function(e) {
        e.preventDefault();
        var h = $(this).attr('href');
        $.get(h, function() {
            $("#fotos").fadeOut("slow", function() {
                $("#fotos_dentro").show(function(){
                    $(this).load(h).fadeIn("slow", function(){
                        $("#mcs_container").mCustomScrollbar("vertical",400,"easeOutCirc",1.05,"30","yes","yes",10);
                    });
                });
            });
        });
    });
}); 
```

这是我的 HTML：

```
<div class="conteudo">
    <!-- comeco sroll -->
    <div id="mcs_container" class="rolagem">
        <div class="customScrollBox">
            <div class="container">
                <div class="content">
                <div id="fotos_dentro"></div>
                <div id="fotos">
                    <!-- HERE IS MY ASP PROGRAMMING -->
                </div>
                </div>
            </div>
            <div class="dragger_container">
                <div class="dragger"></div>
            </div>
        </div>
    </div>
    <!-- fim scroll -->
</div> 
```

这是我的网站：[http](http://www.alsite.com.br/luxxx/) ://www.alsite.com.br/luxxx/ - 点击`GALERIA`查看问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:31:23.353

`.load`在这种情况下是多余的，只需附加返回的 html。

```
$(function() {

    $("#fotos_dentro").hide();

    $('.fotos1').live('click', function(e) {
        e.preventDefault();
        var h = $(this).attr('href');
        $.get(h, function(data) {
            $("#fotos").fadeOut("slow", function() {
                $("#fotos_dentro").html(data).fadeIn("slow", function() {
                    $("#mcs_container").mCustomScrollbar("vertical", 400, "easeOutCirc", 1.05, "30", "yes", "yes", 10);
                });
            });
        });
    });
});​ 
```

# mysql - mysql查询更新在其他表中仅存在一次的事务（transactionID）（transactionID）

> ID：11543187
> 
> 赞同：0
> 
> 时间：2012-07-18T14:01:53.690
> 
> 标签：mysql, group-by

我需要生成一个类似这样的 mysql 查询：

更新 TRANSACTION SET 点 = 0 WHERE TransactionID NOT IN(SELECT TransactionID, COUNT(*) FROM trans_products GROUP BY TransactionID WHERE COUNT(*) > 1)

关键是我需要更新在表“trans_products”中存在一次的“事务”表中的事务

任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T15:54:09.953

尝试：

```
UPDATE
    TRANSACTION
SET
    points = 0
WHERE
   TransactionID IN (
       SELECT 
           TransactionID
       FROM
           trans_products
       GROUP BY
           TransactionID
       HAVING
           COUNT(*) = 1
   ) 
```

**编辑**：根据您需要添加 ProductID 的[评论](https://stackoverflow.com/questions/11543187/mysql-query-updating-transactionstransactionid-that-only-existtransactionid/11545416#comment15283595_11545416)，您不能有`WHERE`after`HAVING`子句。这就是你需要的：

```
UPDATE
    TRANSACTION
SET
    points = 0
WHERE
   TransactionID IN (
       SELECT 
           TransactionID
       FROM
           trans_products
       WHERE
           ProductID = '192'
       GROUP BY
           TransactionID
       HAVING
           COUNT(*) = 1
   ) 
```

# javascript - 检查文本区域中的空白字段

> ID：11543188
> 
> 赞同：0
> 
> 时间：2012-07-18T14:01:54.093
> 
> 标签：javascript, html

我有 3 个文本框和 1 个文本区域字段。身份证、姓名、地址、联系方式。所有都是为了检查空白字段而编写的java脚本。我是这样做的：

javascript代码：

```
function checkForm()    
{
var id=document.getElementById("id").value;
var name=document.getElementById("name").value;
var address=document.getElementById("address").value;
var contact=document.getElementById("contact").value;

if(id.length<1 )        
{
alert("Please enter all the informations!");
return false;
}
if(name.length<1 )      
{
alert("Please enter the name!");
return false;
}
if(address.length<1 )       
{
alert("Please enter the address!");
return false;
}
if(contact.length<1 )       
{
alert("Please enter the contact!");
return false;
} 
```

html代码：

```
<form method="post" action="clients.php" onSubmit="return checkForm()">
  id <input type="text" name="id" id="id">
  name <input type="text" name="name" id="name">
  address <textarea name="address" id="address"> </textarea>
  contact <input type="text" name="contact" id="contact">
  <input type="submit" name="submit" value="Enter">
</form> 
```

除了textarea之外，所有的都在工作。我正在尝试使用其他一些在互联网上创建的代码，但这些代码不起作用。维护序列号（id 然后是名称，然后是地址，然后是联系方式....）我如何检查 textarea 的空白区域？

提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:03:37.400

使用修剪功能删除空格

```
var id=document.getElementById("id").value.trim();
var name=document.getElementById("name").value.trim();
var address=document.getElementById("address").value.trim();
var contact=document.getElementById("contact").value.trim(); 
```

# c# - 如何在我的 XAML 代码中设置默认组合框选择？

> ID：11543193
> 
> 赞同：3
> 
> 时间：2012-07-18T14:02:07.840
> 
> 标签：c#, wpf, xaml, combobox

如何在 XAML 代码中设置 ComboBox 的默认选择？这就是我的 ComboBox 的代码的样子：

```
<ComboBox Name="ComboBox1" Width="200" Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="10,10,0,0">           
  <ComboBoxItem>My first item</ComboBoxItem>
</ComboBox> 
```

在我的 C# 代码中，我总是像这样设置 ComboBox 的默认值：

```
ComboBox1.SelectedIndex = 0; 
```

是否可以在我的 XAML 代码中做同样的事情？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-18T14:08:03.593

```
<ComboBox Name="ComboBox1" SelectedIndex="0" Width="200" Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="10,10,0,0">
        <ComboBoxItem>My first item</ComboBoxItem>
    </ComboBox> 
```

我希望这个能帮上忙

# c# - 模板中的 RazorEngine 扩展方法

> ID：11543197
> 
> 赞同：1
> 
> 时间：2012-07-18T14:02:23.260
> 
> 标签：c#, razor, razorengine

我正在使用 Razor 引擎：[https](https://github.com/Antaris/RazorEngine) ://github.com/Antaris/RazorEngine 。

我正在动态创建模型。我试图在模板中包含一个扩展方法，但它可以识别扩展类。我收到以下错误消息“ **‘字符串’不包含‘ToUpperFirstLetter’的定义**”

**模型创建**

```
dynamic model = new ExpandoObject();
((IDictionary<string, object>)model).Add("Forename", "john"); 
```

**模板**

```
@using Namespace.Extensions
@{
     ViewBag.Title = "Title";
}

Hello @Model.Forename.ToUpperFirstLetter() 
```

**扩展类**

```
namespace Namespace.Extensions
{
    public static class StringExtensions
    {
         public static string ToUpperFirstLetter(this string source)
         {
             return ....removed for abbreviation
         }
    }
} 
```

**剃刀解析**

```
ITemplate template = Razor.Resolve(template, model);
string result = template.Run(new ExecuteContext()); 
```

**编辑**

我还想在 Dynamic ExpandoObject 上创建一个扩展方法。查看模型中的值是否存在。我收到以下错误消息“ **System.Dynamic.ExpandoObject'不包含'HasValue'的定义**”

**扩展类**

```
public static class ExpandoObjectExtensions
{
    public static bool HasValue(this ExpandoObject source, string key)
    {
        return ((IDictionary<String, object>)source).ContainsKey(key);
    }
} 
```

**扩展使用**

```
@if(Model.HasValue("Hello"))
{ 
    @Model.Hello
} 
```

**编辑两个**

以下工作并进入扩展方法

```
var o = new object();
var bool = o.HasValue("value"); 
```

动态模型仍然抛出异常 - **RuntimeBinderException: 'System.Dynamic.ExpandoObject' 不包含 'HasValue' 的定义**

```
dynamic model = new ExpandoObject();
var bool = model.HasValue("value"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T10:40:54.477

您看到的问题是您正在尝试执行一个方法`ToUpperFirstLetter(this string source)`，而实际上该`Forename`属性是`dynamic`. 我想如果你做了类似的事情：

```
@(((string)Model.Forename).ToUpperFirstLetter()) 
```

......它可能会工作。这完全取决于使用`dynamic`. 动态是在运行时通过后期绑定处理的，但是当 RazorEngine 正在*编译*您的视图时，它会尝试静态链接需要您提供动态字符串的方法。编译器不知道这`Forename`是一个字符串。

您也**不能**有`dynamic`扩展方法的第一个参数，例如：

```
public static string ToUpperFirsLetter(this dynamic source) { ... } 
```

因为扩展方法在编译时被解析为显式方法调用，但编译器不知道如何处理扩展方法中的动态第一个参数。

**编辑** 根据您的回复，如果您想实现这些类型的扩展方法，其中动态可能是类型，您最好使用`object`和测试类型，例如：

```
public static class StringExtensions
{
  public static string ToUpperFirstLetter(this object val)
  {
    string str = val as string;
    if (string.IsNullOrWhitespace(str)) return str;

    return str.Substring(0, 1).ToUpper() + str.Substring(1);
  }
}

public static class ExpandoObjectExtensions
{
  public static bool HasValue(this object val, string key)
  {
    var expando = val as ExpandoObject;
    if (expando == null) return false;

    return ((IDictionary<string, object>)expando).ContainsKey(key);
  }
} 
```

...不理想，但它仍然是在`dynamic`.

# eclipse - 未解决的包含： 在 mac 上的日食中

> ID：11543198
> 
> 赞同：4
> 
> 时间：2012-07-18T14:02:28.853
> 
> 标签：eclipse, macos, compiler-construction, eclipse-indigo

Eclipse 不允许我包含`<iostream>`. 我在 Mac 上，当我使用 xcode 尝试同样的事情时，它可以工作。我正在运行 eclipse Indigo，我已经尝试了 MAC OS X 编译器选项和跨平台编译器选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-19T17:12:15.813

我通过手动将 iostream 的路径添加到我的项目中解决了这个问题：

右键单击项目 -> 属性 -> C/C++ 常规 -> 路径和符号 -> GNU C++（在包含中的语言列下） -> 添加

我添加了以下内容（粗体字）——我认为第二个是你需要的：

![我的 elcipse 设置的屏幕截图](../Images/cdfac09a103074ad0e49f310c3c9ab01.png)

# sql - 存储函数未在“插入”子查询中触发

> ID：11543199
> 
> 赞同：2
> 
> 时间：2012-07-18T14:02:33.243
> 
> 标签：sql, oracle, stored-procedures, oracle11g

我在 ORACLE 11g 上使用 SQL 插入`table1`并同时触发插入到`table3`. 存储的函数没有触发，我怀疑这是因为 ORACLE 优化器意识到插入不需要存储的函数，`table1`所以它忽略了它们？有没有办法请求oracle不优化查询或者有更好的解决方案。示例代码：

```
INSERT INTO table1 (col1)
SELECT A.col1
FROM (SELECT col1, storedFunction(col2),storedFunction(col3),storedFunction(col4)
FROM table2) A 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:17:37.337

您可以让您的存储过程返回`NULL`并使用以下内容：

```
INSERT INTO table1 (col1)
SELECT NVL( col1, storedProcedure(col2) )
FROM table2 
```

`NVL`始终评估两个参数，即使第一个参数不为空。

我不确定我是否会对这个黑客感到满意......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T15:32:44.600

鉴于您`storedFunction`作为一个自治事务工作，并且您正在处理超过 1 亿行，您可能会遇到*严重*的性能问题。如果可能的话，我会重新考虑整个策略。报废它。重来。

**选项1**

如果这不可能，最好的办法是执行`bulk collect`提取（有限制）以检索`col1`和`col2`，显式调用`storedFunction`每一行的`col2`，然后`bulk insert`进入`table1`。这应该有望最大限度地减少读取`table2`和写入`table1`. 不过，你真的会在打电话时付钱给吹笛者`storedFunction`。

**选项 2** 将您的函数包装在另一个具有您想要的行为的函数中。你没有提到类型，但我假设 VARCHAR2。当然，您可以根据需要进行调整。*请原谅语法错误，因为我手边没有 Oracle 数据库。*

```
CREATE FUNCTION MYFUNC(col1 IN VARCHAR2, col2 IN VARCHAR2) RETURN VARCHAR2
AS
   v_dummy VARCHAR2(100);
BEGIN
  v_dummy := storedFunction(col2);   --Call stored function
  return col1;                       --return col 1 unchanged
END; 
```

然后您可以按如下方式进行插入：

```
INSERT INTO table1 (col1)
SELECT MYFUNC(A.col1, A.col2)
FROM   table2 A; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T13:50:41.967

SQL 的解决方案是将子查询做成临时表，并使用`/*+ MATERIALIZE */`子查询中的提示来强制 Oracle 对存储的 Functions 进行求值。例如

```
INSERT INTO table1 (col1)
WITH temp_table AS (/*+ MATERIALIZE */  SELECT col1, storedFunction(col2),storedFunction(col3),storedFunction(col4)
FROM table2) 
SELECT col1
FROM temp_table 
```

# html - 如何在无序列表jquery中获取所选选项的文本

> ID：11543207
> 
> 赞同：0
> 
> 时间：2012-07-18T14:02:48.120
> 
> 标签：html, jquery-mobile

```
<div id="menu">
        <ul class="ui-body-e" id="clientsList"   data-filter="true"  data-inset="true" data-role="listview" >

            <li id="entryTemplate" class="entry" style="display:none">
                <a href="#cliMaLi" data-transition="slide">
                <span class="fnameLabel">Label</span> <span class="snameLabel">Label</span></a>
           </li>
        </ul>
    </div> 
```

```
 // Generate client list
function refreshCliLi () {
$('#menu ul li:gt(0)').remove();
JLEGALDB.transaction (
function(transaction){
    transaction.executeSql('SELECT id, fname, sname FROM clients;', undefined,       function(transaction, result){
        for(var i = 0; i < result.rows.length; i++){
             var row = result.rows.item(i);
             var newEntryRow = $('#entryTemplate').clone();
             newEntryRow.removeAttr('style');
             newEntryRow.data('entryId', row.id);
             newEntryRow.appendTo('#menu ul');
             newEntryRow.find('.snameLabel').text(row.sname);
             newEntryRow.find('.fnameLabel').text(row.fname);
             }
    }, errorHandler);
}); 
```

}

客户列表中的项目是从数据库中生成的。在客户列表中选择客户名称时，如何获取该选择的文本？？？

# java - Quartz 中的异步作业调度

> ID：11543209
> 
> 赞同：4
> 
> 时间：2012-07-18T14:02:57.400
> 
> 标签：java, quartz-scheduler

java Quartz Scheduler是否支持异步作业调度。如果是，是默认情况下还是必须自定义作业才能异步运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:36:38.570

它不仅支持这种行为，而且基本上没有其他方法。一旦您安排了作业和触发器（在任何线程中），该作业将在线程池中异步执行。您可以对该线程池进行一些控制，例如线程数。

另一个问题是同一作业的并行执行。默认情况下，同一个作业可以在由不同线程启动的多个线程中运行，除非该作业是*有​​状态*的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:09:38.363

是的，它应该是默认的。我在我的 Grails 应用程序中为我的网站使用 Quartz，它为每个作业衍生出新线程。

# c# - C# OpenTK GLSL 在尝试渲染时崩溃

> ID：11543212
> 
> 赞同：0
> 
> 时间：2012-07-18T14:03:03.277
> 
> 标签：c#, opengl, glsl, opentk

我一直在尝试在我的程序中实现 GLSL，但是鉴于我以前从未使用过 GLSL，我决定尝试按照教程进行操作。不幸的是，以下教程不是我的强项，当调用“RenderTerrain()”时，我的程序崩溃了（在函数的第二行代码中（GL.DrawElements））

现在这显然是程序中的所有代码，还有很多，你们中的任何人都没有机会通过 20k 行来找到我的问题：P 但是如果您需要就其中任何一个问题提出问题，请发表评论 :)

所以我的问题很简单，这段代码有什么问题吗？为什么会崩溃？

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using OpenTK.Graphics.OpenGL;
using OpenTK;

namespace HoardOfUpgrades
{
    public class Shaders
    {
        private static string TerrainVertexShaderText = @"

            #version 140

            // object space to camera space transformation
            uniform mat4 modelview_matrix;            

            // camera space to clip coordinates
            uniform mat4 projection_matrix;

            // incoming vertex position
            in vec3 vertex_position;

            // incoming vertex normal
            in vec3 vertex_normal;

            // incoming vertex_color
            in vec3 vertex_color

            // transformed vertex normal
            out vec3 normal;

            void main(void)
            {
              //not a proper transformation if modelview_matrix involves non-uniform scaling
              normal = ( modelview_matrix * vec4( vertex_normal, 0 ) ).xyz;

              // transforming the incoming vertex position
              gl_Position = projection_matrix * modelview_matrix * vec4( vertex_position, 1 );
            }

        ";

        private static string TerrainFragmentShaderText = @"

            #version 140

            precision highp float;

            const vec3 ambient = vec3( 0.1, 0.1, 0.1 );
            const vec3 lightVecNormalized = normalize( vec3( 0.5, 0.5, 2 ) );
            const vec3 lightColor = vec3( 1.0, 0.8, 0.2 );

            in vec3 normal;

            out vec4 out_frag_color;

            void main(void)
            {
              float diffuse = clamp( dot( lightVecNormalized, normalize( normal ) ), 0.0, 1.0 );
              out_frag_color = vec4( ambient + diffuse * lightColor, 1.0 );
            }

        ";

        public static int TerrainFragmentShaderHandle, TerrainVertexShaderHandle, TerrainProgramHandle, ProjectionMatrixLocation, ModelviewMatrixLocation, TerrainNormHandle, TerrainPosHandle, TerrainColorHandle, TerrainIndicesHandle, TerrainIndiceCount;

        public static void Load(Vector3[] position, Vector3[] normals, Vector3[] colors, int[] indices)
        {
            LoadShaders();
            LoadProgram();

            LoadVertexPositions(position);
            LoadVertexNormals(normals);
            LoadVertexColors(colors);
            LoadIndexer(indices);
        }

        static void LoadProgram()
        {
            TerrainProgramHandle = GL.CreateProgram();

            GL.AttachShader(TerrainProgramHandle, TerrainVertexShaderHandle);
            GL.AttachShader(TerrainProgramHandle, TerrainVertexShaderHandle);

            GL.LinkProgram(TerrainProgramHandle);
        }

        static void LoadShaders()
        {
            TerrainVertexShaderHandle = GL.CreateShader( ShaderType.VertexShader );
            TerrainFragmentShaderHandle = GL.CreateShader( ShaderType.FragmentShader );

            GL.ShaderSource(TerrainVertexShaderHandle, TerrainVertexShaderText);
            GL.ShaderSource(TerrainFragmentShaderHandle, TerrainFragmentShaderText);

            GL.CompileShader(TerrainVertexShaderHandle);
            GL.CompileShader(TerrainFragmentShaderHandle);
        }

        private static void QueryMatrixLocations()
        {
            ProjectionMatrixLocation = GL.GetUniformLocation(TerrainProgramHandle, "projection_matrix");
            ModelviewMatrixLocation = GL.GetUniformLocation(TerrainProgramHandle, "modelview_matrix");
        }

        public static void SetModelviewMatrix(Matrix4 matrix)
        {
            GL.UniformMatrix4(ModelviewMatrixLocation, false, ref matrix);
        }

        public static void SetProjectionMatrix(Matrix4 matrix)
        {
            GL.UniformMatrix4(ProjectionMatrixLocation, false, ref matrix);
        }

        private static void LoadVertexPositions(Vector3[] data)
        {
            GL.GenBuffers(1, out TerrainPosHandle);
            GL.BindBuffer(BufferTarget.ArrayBuffer, TerrainPosHandle);
            GL.BufferData<Vector3>(BufferTarget.ArrayBuffer,
                new IntPtr(data.Length * Vector3.SizeInBytes),
                data, BufferUsageHint.StaticDraw);

            GL.EnableVertexAttribArray(0);
            GL.BindAttribLocation(TerrainProgramHandle, 0, "vertex_position");
            GL.VertexAttribPointer(0, 3, VertexAttribPointerType.Float, false, Vector3.SizeInBytes, 0);
        }

        private static void LoadVertexNormals(Vector3[] data)
        {
            GL.GenBuffers(1, out TerrainNormHandle);
            GL.BindBuffer(BufferTarget.ArrayBuffer, TerrainNormHandle);
            GL.BufferData<Vector3>(BufferTarget.ArrayBuffer,
                new IntPtr(data.Length * Vector3.SizeInBytes),
                data, BufferUsageHint.StaticDraw);

            GL.EnableVertexAttribArray(1);
            GL.BindAttribLocation(TerrainProgramHandle, 1, "vertex_normal");
            GL.VertexAttribPointer(1, 3, VertexAttribPointerType.Float, false, Vector3.SizeInBytes, 0);
        }

        private static void LoadVertexColors(Vector3[] data)
        {
            GL.GenBuffers(1, out TerrainColorHandle);
            GL.BindBuffer(BufferTarget.ArrayBuffer, TerrainColorHandle);
            GL.BufferData<Vector3>(BufferTarget.ArrayBuffer,
                new IntPtr(data.Length * Vector3.SizeInBytes),
                data, BufferUsageHint.StaticDraw);

            GL.EnableVertexAttribArray(1);
            GL.BindAttribLocation(TerrainProgramHandle, 1, "vertex_color");
            GL.VertexAttribPointer(2, 3, VertexAttribPointerType.Float, false, Vector3.SizeInBytes, 0);
        }

        private static void LoadIndexer(int[] data)
        {
            TerrainIndiceCount = data.Length;

            GL.GenBuffers(1, out TerrainIndicesHandle);
            GL.BindBuffer(BufferTarget.ElementArrayBuffer, TerrainIndicesHandle);
            GL.BufferData<int>(BufferTarget.ElementArrayBuffer,
                new IntPtr(data.Length * sizeof(int)),
                data, BufferUsageHint.StaticDraw);
        }

        public static void RenderTerrain()
        {
            GL.UseProgram(TerrainProgramHandle);

            GL.DrawElements(BeginMode.Triangles, TerrainIndiceCount,
                DrawElementsType.UnsignedInt, IntPtr.Zero);

            GL.UseProgram(0);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T07:28:54.723

必须包括这些代码行：

```
 GL.DisableClientState(ArrayCap.NormalArray);
        GL.DisableClientState(ArrayCap.VertexArray);
        GL.DisableClientState(ArrayCap.TextureCoordArray); 
```

启用数组，必须禁用它们才能使用 GL.DrawElements() 函数

# android - Android - 从文件中设置和获取元数据

> ID：11543217
> 
> 赞同：2
> 
> 时间：2012-07-18T14:03:16.927
> 
> 标签：android, android-file

如何设置和获取文件的作者、修改日期等元数据？

# racket - hc-在模块中附加未绑定标识符

> ID：11543223
> 
> 赞同：2
> 
> 时间：2012-07-18T14:03:35.053
> 
> 标签：racket

您好，我正在关注[球拍的快速介绍](http://docs.racket-lang.org/quick/)。在第 5 章中，他们提出了这段代码（运行良好）：

```
(define (four p)
  (define two-p (hc-append p p))
  (vc-append two-p two-p)) 
```

通常会使用 let 来编写，所以我编写了代码：

```
#lang slideshow

(define (square n)
  (filled-rectangle n n))
(define (four p)
  (let ([two-p (hc-apppend p p)])
  (vc-append two-p two-p))) 
```

但它不起作用。错误信息是：

```
expand: unbound identifier in module in: hc-apppend 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T14:40:00.373

只是检查：你还记得吗

```
#lang slideshow 
```

作为第一行？

另外，计算**p**个字符的数量！它是 hc-append。错误提到*hc-append*：它应该是*hc-append*。

# android - Android - 将字节数组写入 OutputStreamWriter

> ID：11543227
> 
> 赞同：7
> 
> 时间：2012-07-18T14:03:41.450
> 
> 标签：android, string, stream, byte

我有一个通过网络服务上传照片的应用程序。过去，我将文件加载到流中，然后转换为 Base64。然后我通过 OutputStreamWriter 的 write() 方法发布了结果字符串。现在，Web 服务发生了变化，它需要 multipart/form-data 而不需要 Base64。

因此，不知何故，我需要按原样发布该文件的字符而不进行转换。我确定我已经接近了，但我得到的只是内容长度下溢或溢出。奇怪的是，在调试器中，我可以看到我的缓冲区长度与我发布的字符串长度相同。这是我正在做的事情，希望有足够的代码：

```
// conn is my connection
OutputStreamWriter dataStream = new OutputStreamWriter(conn.getOutputStream());

// c is my file
int bytesRead = 0;
long bytesAvailable = c.length();

while (bytesAvailable > 0) {
   byte[] buffer = new byte[Math.min(12288, (int)bytesAvailable)];
   bytesRead = fileInputStream.read(buffer, 0, Math.min(12288, (int)bytesAvailable));

   // assign the string if needed.
   if (bytesRead > 0) {
      bytesAvailable = fileInputStream.available();

      // I've tried many encoding types here.
      String sTmp = new String(buffer, "ISO-8859-1");
      // HERE'S the issue.  I can't just write the buffer,
      dataStream.write(sTmp);
      dataStream.flush();
// Yes there's more code, but this should be enough to show why I don't know what I'm doing! 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-18T14:24:17.020

改变

```
OutputStreamWriter dataStream = new OutputStreamWriter(conn.getOutputStream()); 
```

有了这个

```
DataOutputStream dataStream = new DataOutputStream(conn.getOutputStream()); 
```

并直接调用`dataStream.write(buffer);`

让我知道它的行为

编辑：根据评论编辑答案

# mediaelement.js - mediaelement.js Mac FF/Safari 上的全屏模式

> ID：11543236
> 
> 赞同：1
> 
> 时间：2012-07-18T14:04:11.640
> 
> 标签：mediaelement.js

在[http://www.rocklobsterweb.de/soho/](http://www.rocklobsterweb.de/soho/)上，全屏模式在 Mac（Safari 和 Firefox）上的“projekte”中无法正常工作。我不确定这是 mediaelements.js 还是 html/css 容器的问题。我认为是后者，因为在“rolle”中，John 的“虚拟”电影在全屏中运行良好。

有人知道吗？

谢谢， 约尔戈

正在考虑将视频文件更改为 vimeo。

# powershell - 用 Try, Catch 确认

> ID：11543238
> 
> 赞同：0
> 
> 时间：2012-07-18T14:04:19.233
> 
> 标签：powershell, scripting, vmware, powercli

我创建了一个脚本，该脚本在 VM 中创建新快照，然后删除该 VM 中除 6 个最新快照之外的所有快照。我想找到一种方法让我的脚本检查错误并确认一切正常，但之前从未在 Powershell 中使用过 try/catch，并且很好奇是否有人可以指导我做错了什么：

```
$server = $args[0]
$date = get-date
try{
    new-snapshot -vm $server -name "Auto Created via Powershell" -description $date
}
catch{
    [system.exception]
    "Not finding"}  
get-snapshot -vm $server | sort -property created -desc | select -skip 6 | foreach-object{remove-snapshot $_ -confirm:$false}
if (get-snapshot -vm $server | select -first 6){
    write-host "script is keeping current 6 as expected"
} 
```

我创建新快照的代码的第一部分工作正常，问题出在第二部分，我想确认除 6 个最新快照之外的所有快照都已删除。目前我正在尝试使用 if 语句来确认，但是我没有从我的 if 语句中得到任何输出。无论如何，我很好奇是否有更好的方法来执行我的脚本的第二部分来确认，而不是使用 if 语句来确认脚本保留了当前的 6 个最新快照。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T09:41:52.363

所以试试这个，认为它可能有效。

```
 $server = $args[0]
    $date = get-date
    try{
        new-snapshot -vm $server -name "Auto Created via Powershell" -description $date
       }
    catch{
          [system.exception]
         "Not finding"}  

    get-snapshot -vm $server | sort -property created -desc | select -skip 6 | foreach-object{remove-snapshot $_ -confirm:$false}

$ListOfVms = get-snapshot -vm $server

if ($ListOfVms.count -eq 6){
    write-host "script is keeping current 6 as expected"
    } 
```

这应该计算 vms 的数量，如果它等于 6，则写下你想要的文本。

# javascript - 将js输出转换为目标C

> ID：11543241
> 
> 赞同：2
> 
> 时间：2012-07-18T14:04:39.477
> 
> 标签：javascript, objective-c, xcode

我正在开发 iphone 应用程序，在该应用程序中，我还使用了 js 和 css 文件以及目标 C 来获得更好的输出。但有一次我坚持了下来。我正在使用以下显示警报的 js 代码。我还通过单击“确定”按钮附加了代表警报的图像。

```
**NSString *someHtmlContent1 = @"<script src='jquery.min.js'>
</script>
<script src='jquery-ui.min.js'></script>
<script src='jquery.ui.touch-punch.min.js'></script>
<script>
function result(qn) {
    var u = document.getElementById('sortable'+qn);
    var LIs = u.getElementsByTagName('li');
    var list = [];
    for( var i = 0; i < LIs.length; ++i ){
       var LI = LIs[i];list.push(LI.innerHTML);
    }
    res = list;
    var i=0;
    var str = '';
    for (i in res) {
        str = str+' '+res[i];
    }
    alert(str);
    return str;
}
</script>";** 
```

![在此处输入图像描述](../Images/ae6f124e967825fe8a0a73feae3e3edb.png)

我想获取 NSString 中显示的内容**（.......）** 。任何人都知道如何将 js 变量转换为目标 C？请帮帮我。

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:29:12.387

在 JS 和 Objective-C 之间建立联系的唯一技巧是：

在您的 JS 中，调用类似 window.location = "something://smth/smthelse" 的链接

在 Objective-C 中，在您的 Web 视图委托方法 (webView:shouldStartLoadWithRequest:navigationType: ) 中，您可以处理此调用并对其进行处理。

# java - Spring WS + Wss4jSecurityInterceptor + MTOM 内存问题

> ID：11543255
> 
> 赞同：1
> 
> 时间：2012-07-18T14:05:28.620
> 
> 标签：java, out-of-memory, spring-ws, mtom, axis

这似乎是一个长期存在的问题，到目前为止还没有确定的解决方案：传入的 MTOM 消息被内联到 SOAP 消息的情况，由于内存使用而导致应用程序崩溃。

我正在使用 Apache Axiom (1.2.13) 使用 Spring WS (2.1) 创建文件上传 Web 服务，因为我收到的文件很大：

```
<bean id="messageFactory" class="org.springframework.ws.soap.axiom.AxiomSoapMessageFactory">
    <property name="payloadCaching" value="true"/>
    <property name="attachmentCaching" value="true"/>
</bean> 
```

我使用 JAXB (2.2.5) 进行 XML 数据编组，但它内联附件，因此对于处理我`SoapMessage`直接使用的附件的端点；不是我想要的，但可以接受。到目前为止，这个设置很好，我可以上传非常大的文件。问题是我还需要身份验证，为此我使用的是 Apache WSS4J 1.6.6：

```
<bean id="wsSecurityInterceptor" class="org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor">
    <property name="validationActions" value="UsernameToken"/>
    <property name="securementActions" value="NoSecurity"/>
</bean> 
```

当拦截器进行消息验证时，它还将附件数据内联到消息正文中，占用大量内存并生成`OutOfMemoryError`合理大小的消息：

```
java.lang.OutOfMemoryError: Java heap space
    at java.util.Arrays.copyOfRange(Arrays.java:3209) ~[na:1.6.0_14]
    at java.lang.String.<init>(String.java:215) ~[na:1.6.0_14]
    at com.sun.org.apache.xerces.internal.xni.XMLString.toString(XMLString.java:185) ~[na:1.6.0_14]
    at com.sun.org.apache.xerces.internal.parsers.AbstractDOMParser.characters(AbstractDOMParser.java:1188) ~[na:1.6.0_14]
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:463) ~[na:1.6.0_14]
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:807) ~[na:1.6.0_14]
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) ~[na:1.6.0_14]
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:107) ~[na:1.6.0_14]
    at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:225) ~[na:1.6.0_14]
    at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:283) ~[na:1.6.0_14]
    at weblogic.xml.jaxp.RegistryDocumentBuilder.parse(RegistryDocumentBuilder.java:163) ~[weblogic.jar:10.3.2.0]
    at javax.xml.parsers.DocumentBuilder.parse(DocumentBuilder.java:124) ~[na:1.6.0_14]
    at org.springframework.ws.soap.axiom.support.AxiomUtils.toDocument(AxiomUtils.java:133) ~[spring-ws-core-2.1.0.RELEASE.jar:na]
    at org.springframework.ws.soap.axiom.AxiomSoapMessage.getDocument(AxiomSoapMessage.java:201) ~[spring-ws-core-2.1.0.RELEASE.jar:na]
    at org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor.validateMessage(Wss4jSecurityInterceptor.java:561) ~[spring-ws-security-2.1.0.RELEASE.jar:na]
    at org.springframework.ws.soap.security.AbstractWsSecurityInterceptor.handleRequest(AbstractWsSecurityInterceptor.java:123) ~[spring-ws-security-2.1.0.RELEASE.jar:na]
    at org.springframework.ws.server.endpoint.interceptor.DelegatingSmartEndpointInterceptor.handleRequest(DelegatingSmartEndpointInterceptor.java:78) ~[spring-ws-core-2.1.0.RELEASE.jar:na]
    at org.springframework.ws.server.MessageDispatcher.dispatch(MessageDispatcher.java:224) ~[spring-ws-core-2.1.0.RELEASE.jar:na]
    at org.springframework.ws.server.MessageDispatcher.receive(MessageDispatcher.java:173) ~[spring-ws-core-2.1.0.RELEASE.jar:na]
    at org.springframework.ws.transport.support.WebServiceMessageReceiverObjectSupport.handleConnection(WebServiceMessageReceiverObjectSupport.java:88) ~[spring-ws-core-2.1.0.RELEASE.jar:na]
    at org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.handle(WebServiceMessageReceiverHandlerAdapter.java:59) ~[spring-ws-core-2.1.0.RELEASE.jar:na]
    at org.springframework.ws.transport.http.MessageDispatcherServlet.doService(MessageDispatcherServlet.java:221) ~[spring-ws-core-2.1.0.RELEASE.jar:na]
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882) ~[org.springframework.web.servlet-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789) ~[org.springframework.web.servlet-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:727) ~[javax.servlet_1.0.0.0_2-5.jar:2.5]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820) ~[javax.servlet_1.0.0.0_2-5.jar:2.5]
    at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:227) ~[weblogic.jar:10.3.2.0]
    at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:125) ~[weblogic.jar:10.3.2.0]
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:292) ~[weblogic.jar:10.3.2.0]
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:175) ~[weblogic.jar:10.3.2.0]
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3591) ~[weblogic.jar:10.3.2.0]
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321) ~[com.bea.core.weblogic.security.identity_1.1.2.0.jar:1.1.2.0] 
```

到目前为止，我还没有找到解决这种不受欢迎的内联的方法。我不想手动读取和处理标题，这会使 WSS4J 毫无意义，并且我的代码在处理未来需求方面的灵活性降低。

[该线程](http://forum.springsource.org/showthread.php?78233-SpringWS-Security-MTOM-and-java-lang-OutOfMemoryError)建议欺骗拦截器使用仅包含标头的消息副本，但我无法实现它（它已有几年历史，API 可能会更改）。这可能会禁止使用加密和签名的消息（正如回复指出的那样），但到目前为止对我来说不是必需的。[这个另一个线程](http://forum.springsource.org/showthread.php?100951-Problems-with-Spring-WS-Streaming-Attachments-with-Security-Interceptor)建议坚持使用 Axiom 1.2.8，它什么也没做，并将`validateRequest`Axiom 工厂上的标志设置为`false`（这听起来很奇怪，因为它禁用了安全性 - 没有错误但没有安全性，这有什么意义呢？ ）。

那么，任何人都可以帮助我解决这个问题吗？修复 JAXB、欺骗 WSS4J 拦截器或其他解决方案？欢迎任何帮助！

谢谢！

# rally - 实际花费的时间

> ID：11543256
> 
> 赞同：1
> 
> 时间：2012-07-18T14:05:29.033
> 
> 标签：rally

我希望能够将时间表上的任务中的总“花费的时间”复制到任务“实际”字段中。这样，我可以使用时间表输入我在任务上花费的时间，并在团队状态页面上查看值（以“实际”列的形式）。建议解决这个问题的最佳方法？我是 Rally API 的新手，所以不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T16:13:23.163

花费的时间字段仅存在于任务详细信息页面上。它实际上并未存储在 on 对象中，因此不会在 WSAPI 中返回。如果您想更新任务的实际值，则必须总结[TimeEntryValue](https://rally1.rallydev.com/slm/doc/webservice/body.jsp#TimeEntryValue)上的小时字段。

我的建议是使用看起来像

```
fetch="Hours,TimeEntryItem,Task" 
```

这将在一个查询中为您提供所需的一切。

# python - 如果仅用于原始 sql 查询，是否仍然推荐使用 SQLAlchemy？

> ID：11543266
> 
> 赞同：16
> 
> 时间：2012-07-18T14:05:52.233
> 
> 标签：python, orm, sqlalchemy, flask

使用 Flask，我很想知道 SQLAlchemy 是否仍然是使用原始 SQL（直接`SELECT x FROM table WHERE ...`）而不是使用 ORM 查询我的数据库的最佳方法，或者是否有更简单但功能强大的替代方法？

感谢您的回复。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-18T14:07:50.570

我一直使用 SQLAlchemy 进行直接查询。

主要优势：它为您提供针对 SQL 注入攻击的最佳保护。SQLAlchemy 做正确的事，无论你给它什么参数。

我发现它也可以根据条件调整生成的 SQL。显示带有多个过滤器控件的结果集？只需在一组 if/elif/else 结构中构建您的查询，您就会知道您的 SQL 仍然是黄金。

这是一些实时代码的摘录（旧的 SA 版本，因此语法可能会有所不同）：

```
# Pull start and end dates from form
# ...
# Build a constraint if `start` and / or `end` have been set.
created = None
if start and end:
    created = sa.sql.between(msg.c.create_time_stamp, 
        start.replace(hour=0, minute=0, second=0),
        end.replace(hour=23, minute=59, second=59))
elif start:
    created = (msg.c.create_time_stamp >= 
               start.replace(hour=0, minute=0, second=0))
elif end:
    created = (msg.c.create_time_stamp <= 
               end.replace(hour=23, minute=59, second=59))

# More complex `from_` object built here, elided for example
# [...]
# Final query build
query = sa.select([unit.c.eli_uid], from_obj=[from_])
query = query.column(count(msg.c.id).label('sent'))
query = query.where(current_store)
if created:
    query = query.where(created) 
```

它的来源代码要复杂得多，但我想在此处突出显示日期范围代码。如果我必须使用字符串格式构建 SQL，我可能会在某处引入 SQL 注入孔，因为它更容易忘记引用值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-24T09:57:43.520

在我完成了我的一个小项目之后，我决定尝试只使用 MySQLDB，而不使用 SQL Alchemy。

它工作得很好而且很容易使用，这是一个例子（我创建了一个小类来处理数据库的所有工作）

```
import MySQLdb
from MySQLdb.cursors import DictCursor

class DatabaseBridge():
    def __init__(self, *args, **kwargs):
        kwargs['cursorclass'] = DictCursor
        self.cnx = MySQLdb.connect (**kwargs)
        self.cnx.autocommit(True)
        self.cursor = self.cnx.cursor()

    def query_all(self, query, *args):
        self.cursor.execute(query, *args)
        return self.cursor.fetchall()

    def find_unique(self, query, *args):
        rows = self.query_all(query, *args);
        if len(rows) == 1:
            return rows[0]

        return None

    def execute(self, query, params):
        self.cursor.execute(query, params)
        return self.cursor.rowcount

    def get_last_id(self):
        return self.cnx.insert_id()

    def close(self):
        self.cursor.close()
        self.cnx.close()

database = DatabaseBridge(**{
        'user': 'user',
        'passwd': 'password',
        'db': 'my_db'
    })

rows = database.query_all("SELECT id, name, email FROM users WHERE is_active = %s AND project = %s", (1, "My First Project")) 
```

（这是一个愚蠢的例子）。

它就像一个魅力，**但**你必须考虑到这些：

*   不支持多线程！`multiprocessing`如果你不使用Python也没关系。
*   您不会拥有 SQLAlchemy 的所有优势（数据库到类（模型）包装器、查询生成（select、where、order_by 等））。**这是关于如何使用数据库的关键点。**

但另一方面，就像 SQLAlchemy 一样，有针对 SQL 注入攻击的保护措施：

一个基本的查询是这样的：

```
cursor.execute("SELECT * FROM users WHERE data = %s" % "Some value") # THIS IS DANGEROUS 
```

但你应该这样做：

```
cursor.execute("SELECT * FROM users WHERE data = %s", ("Some value",)) # This is secure! 
```

看出区别了吗？再读一遍；）

不同之处在于我将`%`, 替换为`,`: 我们将参数作为 ... 参数传递给执行，这些都被转义了。使用时`%`，参数不会被转义，从而启用 SQL 注入攻击！

最后一句话是，这取决于您的使用情况以及您计划对项目执行的操作。对我来说，SQLAlchemy 太过分了（它是一个基本的 shell 脚本！），所以 MysqlDB 是完美的。

# php - SimpleSamlPHP 使 Apache 在 PHP 5.3.9 上崩溃

> ID：11543267
> 
> 赞同：1
> 
> 时间：2012-07-18T14:05:52.127
> 
> 标签：php, apache, easyphp

我在 Windows XP 机器上的 EasyPHP 中的 PHP 5.3.9 安装上运行[simpleSamlPHP 1.9 。](http://simplesamlphp.org/docs/1.9/)SimpleSamlPHP 充当 SAML 身份提供者，在本地 MySQL 数据库中获取用户。

我的问题是，当请求对此 IdP 进行身份验证时，Apache 崩溃并抛出“违规访问”错误，即 segfault。问题与[此线程](https://stackoverflow.com/questions/1138269/apache-error-notice-parent-child-process-exited-with-status-3221225477-res)类似，只是子进程以状态 0 退出（但这不是 PHP 关于退出代码的 Windows 特定功能吗？）。

常见的修复方法是在 C:\Windows\system32 中复制 libmysql.dll 和 php5apache2.dll，但没有帮助。

运行 VC++6 即时调试器不会给我任何关于哪个模块被定罪的信息:'(

我试图尽可能多地禁用 PHP 扩展。SimpleSamlPHP 需要 openSSL 和 PDO/MySQL，因此我只启用了这两个，并且无论如何都会发生崩溃。我单独检查了使用 openSSL 和 MySQL 工作正常。

最后，我必须确定机器托管了 3 个 PHP 实例，包括 EasyPHP 中的 2 个（2 个单独安装），但当崩溃发生时，只有相关实例处于活动状态。

有什么线索吗？干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T13:51:34.957

您是否使用 apache 运行 php `mod_php`？我在这里也有同样的情况。当 sp 身份验证进入时，它总是崩溃。我不知道这是怎么发生的。但最后，我通过在 FastCGI 模式下运行 php 避免了这个问题。

# java - Android：定义要使用的加密：AES 128 或 AES 256

> ID：11543268
> 
> 赞同：2
> 
> 时间：2012-07-18T14:05:53.180
> 
> 标签：java, android, encryption, aes

在我正在使用的一个 android 项目中

```
import javax.crypto.Cipher;

ecipher = Cipher.getInstance("AES/CBC/PKCS5Padding"); 
```

请问：AES128 还是AES256 是用的，是用的key 定义的吗？例如`key="012345678901234567890123456789012";`，结果会使用 AES256？

谢谢
托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:15:40.883

是的，是否使用 AES128 或 AES256 由正在使用的密钥定义。

然而，决定它的不是`String`长度，而是`byte[]`长度。在您的代码中的某个时刻，您应该转换`String`为`byte[]`. 结果的大小`byte[]`就是您的密钥大小。在不知道如何转换`"012345678901234567890123456789012"`的情况下，不可能知道您的加密强度。

或者，您可以使用`KeyGenerator`：

```
 KeyGenerator keyGen = KeyGenerator.getInstance("AES");
    keyGen.init(128); // or 256

    // Generate the secret key specs
    SecretKey secretKey = keyGen.generateKey();
    byte[] byteArray = secretKey.getEncoded(); 
```

# javascript - 调用远程脚本的方法

> ID：11543269
> 
> 赞同：0
> 
> 时间：2012-07-18T14:05:54.747
> 
> 标签：javascript, web-applications

**设想**

页面调用此 url 上可用的远程脚本：`http://url.to.script/myScript?ScriptParamsList`。让我们假设：

*   不需要异步执行。
*   不需要显示输出。
*   该脚本在按钮单击事件上调用。让 Handler() 成为 javascript 事件处理程序：

    `function Handler() { //invoke the remote script }`

有几种方法可以实现 Handler() 函数：

*   **脚本与 img 标签**：

`document.write('<script src="http://url.to.script/myScript?ScriptParamsList" type="text/javascript"></script>');`

`document.write('<img src="http://url.to.script/myScript?ScriptParamsList" />');`

*   **jQuery .html() 与 .load()**：

`$('#TargetDiv').html('<img src="http://url.to.script/myScript?ScriptParamsList" />');`

`$('#TargetDiv').load('http://url.to.script/myScript?ScriptParamsList');`

**问题**

有哪些优点和缺点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:11:56.510

*   `document.write`在加载文档后调用它时将替换您当前的文档。永远不要使用这种方法。
*   使用`<script>`允许您从外部域获取请求，而不会受到同源策略的阻碍。此外，在服务器的响应中，您可以添加和执行 JavaScript，这可能很有用。
*   `.html('<img ...>')`除非您的服务器返回包含有意义数据的图像，否则使用没有意义。如果您打算仅触发服务器请求，则以下内容会更好：

    ```
    new Image().src = 'http://url.to.script/myScript?...'; 
    ```

*   `$('..').load`如果 URL 位于不同的域中，则由于[相同的源策略](https://developer.mozilla.org/En/Same_origin_policy_for_JavaScript)而无法正常工作。

我投票赞成该`new Image().src = '..';`方法。如果您不喜欢这种语法，并且想要更多 jQuery，请使用：

```
$('<img>').attr('src', 'http://...'); 
```

注意：结果可能会被缓存。如果您不希望这种情况发生，请附加一个随机查询字符串，以破坏缓存（例如。`url = url + '&_t=' + new Date().getTime()`）。

# eclipse - 如何使用 Eclipse EMF 创建通用列表？

> ID：11543272
> 
> 赞同：12
> 
> 时间：2012-07-18T14:06:00.347
> 
> 标签：eclipse, eclipse-emf

`List`我想用包含`String`对象的 Eclipse EMF 创建一个类。我看到 Ecore 有一个`EList`但我无法更改列表的通用类型。

知道怎么做吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-18T18:03:43.980

如果你想生成一个给你的代码`EList<String>`，那么添加一个新`EAttribute`的给一个`EClass`，给它一个`EType` `EString`，并将它的“上界”属性设置为'-1'。

如果您想以编程方式创建这样的列表，您可以使用`BasicEList`例如 ( `org.eclipse.emf.common.util.BasicEList<E>`)：

```
EList<String> stringList = new BasicEList<String>(); 
```

如果您想查看其他选项，请在以下位置打开类型层次结构：`org.eclipse.emf.common.util.AbstractEList<E>`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-17T09:30:32.753

不确定您的问题是否已得到解答，以及您真正想要做什么。

如果您想从 .ecore 文件生成 Java 代码，那么我在这里提供了一个使用 Eclipse Juno 的 EMF 示例 Ecore 模型编辑器的示例（右键单击 .ecore 文件）。

也许这不是您想要的，但这可能对其他人有帮助。

假设您想要在生成的 Java 类 MyClass 中使用这样的方法：

```
<T extends String> EList<T> getListOfType(Class<T> T) 
```

在您的示例 Ecore 模型编辑器中，您希望通过以下方式实现[您的方法在 Ecore 编辑器中的](https://i.stack.imgur.com/7Gzz4.png)外观

*   将 EOperation 的“新孩子”添加到 MyClass，将其命名为 getListOfType
*   将 ETypeParameter 的“新子代”添加到 getListOfType，将其命名为 T
*   添加到 T 一个 EGeneric Bound Type 的“New Child”，你会看到一个“T extends ?” 而不是“T”
*   单击箭头到“T extends ?”，单击“？”，在“属性”窗口中，在 EClassifier 的下拉菜单中选择一个 EString，现在您会看到“T extends EString”

*   将 EGeneric 返回类型的“新孩子”添加到 getListOfType

*   点击新创建的“？” 返回类型，在 EClassifier 的下拉菜单中选择一个 EEList
*   打开 EEList 的箭头，在 Property 窗口中，在 EType Parameter 的下拉菜单中选择“T extends EString”

*   将“EParameter”的“新孩子”添加到 getListOfType

*   在新创建的参数“null”的属性窗口中，选择Name为“clazz”，EType为“EJavaClass”
*   在新的“？”的属性窗口中 （节点“clazz：EJavaClass”下两层），选择EType Parameter为“T extends EString”，现在“clazz：EJavaClass”变为“clazz：EJavaClass”

现在您的 .ecore 文件已准备好用于生成 java 类。

![您的方法在 Ecore 编辑器中的外观](../Images/8affbe9bf435b5ea80395b6441a96c2f.png)

# gwt - 使用“gwt-maps-3.8.0”从 GWT 2.5 触发 resize 事件到 Google Maps

> ID：11543276
> 
> 赞同：1
> 
> 时间：2012-07-18T14:06:18.207
> 
> 标签：gwt, google-maps-api-3

使用**gwt-maps-3.8.0** [lib GWT-Maps](http://goo.gl/mYqbj)，我无法触发调整大小。

-> 尝试使用“import com.google.gwt.user.client.Event;” -> `Event.trigger(mapWidget,"resize");`“事件类型的触发器（GoogleMap，String）方法未定义”

（这是从这里开始的后续行动：[谷歌地图的第二次调用没有以正确的大小显示地图](https://stackoverflow.com/questions/11530334/second-call-of-google-maps-does-not-show-the-map-in-correct-size)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T13:44:51.070

这是迄今为止我发现的最好的：

```
private final native void resizeMap(GoogleMap map) /*-{
    $wnd.google.maps.event.trigger(map, 'resize');
}-*/; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T12:45:02.517

如果您不想使用自己的 nativ JS 代码，您可以使用`mapWidget.getMap().triggerResize()`gwt-maps-3.8.0 库提供的方法

# php - kohana 框架遇到几个问题：路由和在 ubuntu 12.04 上运行

> ID：11543279
> 
> 赞同：0
> 
> 时间：2012-07-18T14:06:25.197
> 
> 标签：php, ubuntu, apache2, kohana, url-routing

几天前我开始学习 kohana，使用 Zend Framework，我的学习体验似乎很快，直到遇到几个问题。

首先，我在 Windows 7 中启动了该项目（使用 linux ubuntu 12.04 进行双启动）。在我开始使用 kendo ui 向管理应用程序添加更多页面之前，我知道每个链接都很好。我添加了一些路由来处理子文件夹中的控制器并使用表单的查询字符串处理 url `?bla=dkll&second=lkdjf`（由 kendo 网格用于根据用户与网格的交互发送未知数量的参数）。

**第一个问题**：在 Windows 下，我可以访问除根目录之外的任何 url，`/`例如`localhost/admin/`（管理员是我在 htdocs 中的文件夹）它给了我

`ERROR: HTTP_Exception_404 [ 404 ]: The requested URL / was not found on this server`：

> 83 `try`
> 84 `{`
> 85      `if ( ! class_exists($prefix.$controller))`
> 86      `{`
> 87          `throw new HTTP_Exception_404('The requested URL :uri was not found on this server.',`
> 88              `array(':uri' => $request->uri()));`
> 89      `}`
> 90
> 91      `// Load the controller using reflection`
> 92     `$class = new ReflectionClass($prefix.$controller);`

**第二个问题**：在 ubuntu 下，我不仅有同样的第一个问题，而且我什至不能打其他`urls`类似的问题`localhost/admin/useraccess/login`

**问题：**

是与第一个问题相关的第二个问题（显然除了 '/' not found 一个）我在 ubuntu mod_rewrite 上启用了并且 kohana 安装页面都是绿色的。

是否还有其他我忘记启用的设置在不在 ubuntu 上的 windows php (xampp) 中启用？

我的 .htaccess/logs/boostrap 在[这里](http://pastie.org/4278033)

感谢您阅读本文并提供帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T14:10:25.883

我和你有同样的问题，我的 kohana 在我的 Windows 机器上运行良好。但是当我将它迁移到 Ubuntu 时，我遇到了路由问题。这是我的错，我忘了编辑我的 apache conf。您可以查看 /etc/apache2/sites-enabled/000-default 中的 conf 文件

```

目录 /var/www/>
   选项索引 FollowSymLinks MultiViews
   AllowOverride 无
   命令允许，拒绝
   允许所有人
/目录>

```

将 'AllowOverride None' 编辑为 'AllowOverride All' 并重新启动您的 apache webserver 。

像魔术一样工作！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T11:00:01.270

我假设您的应用程序的根文件夹是“admin”。在 bootstrap.php 你应该有：

```
Kohana::init(array(
    'base_url'      => '/admin',
    'index_file'    => FALSE,
)); 
```

同样在你的 bootstrap.php 默认路由应该是最后一个路由：

```
Route::set('default', '(<controller>(/<action>(/<id>)))')
    ->defaults(array(
        'controller' => 'index',
        'action'     => 'index',
    )); 
```

您添加的其他路由应位于默认路由之上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T15:00:15.480

添加到[digby 的注释](http://forum.kohanaframework.org/discussion/comment/73494#Comment_73494)：[所有类文件名和目录名都是小写的。](http://kohanaframework.org/3.2/guide/kohana/conventions#class-names-and-file-location)

我注意到了一些小事情，但没有什么可以解释您遇到的问题：

*   [查询字符串不应该也不应该用于路由到操作](https://github.com/kohana/core/blob/3.2/master/classes/kohana/request.php#L764)。在控制器中使用 $this->request->query() 来使用 GET 值。
*   斜线在 URI 的开头和结尾被[剪掉](https://github.com/kohana/core/blob/3.2/master/classes/kohana/request.php#L783)，所以注释掉的 'def' 路由中的可选 / 是无用的。
*   第二次定义 kendogrid 路线会覆盖旧路线。并不是说它真的很重要，因为它们是相同的，所以为什么不删除一个呢？

您还希望路由什么控制器？目前应该是Controller_...嗯...我用我的小眼睛窥探一个错字！“订阅者”而不是“订阅者”。所以目前你将被路由到 Controller_Subcribers::index()。

如果你想要 Controller_Useraccess::index() 而不是 Controller_Subscribers::index() （假设你修正了错字）删除第一个 kendogrid 路由，因为 'kendogrid' 和 'default' 都匹配一个空的 URI。

PS。我假设你使用 3.2

# node.js - 如何在 node.js 应用程序中包含 npm 库

> ID：11543280
> 
> 赞同：0
> 
> 时间：2012-07-18T14:06:25.433
> 
> 标签：node.js, ncurses

我正在尝试使用我安装的 node-ncurses 创建一个小应用程序`npm install ncurses`

使用此库安装，我正在尝试从以下运行 node-ncurses 的示例

[https://github.com/mscdex/node-ncurses/tree/master/examples](https://github.com/mscdex/node-ncurses/tree/master/examples)

但是我在示例中遇到路径错误`require('ncurses')`，有什么问题吗？

我的 ncurses 库已安装到`~/.npm/`其中，这对我来说似乎是正确的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:53:13.403

您希望将它们本地安装到项目的同一文件夹中。如果您错过了`-g`标志并且只是`npm install ncurses`在您的项目目录中运行，那么您应该能够正常运行`require("ncurses")`。本地安装的所有 NPM 模块都放入`node_modules`项目中的文件夹中。

进一步的提示，如果你安装：

```
npm install ncurses --save 
```

这将添加`ncurses`到您`package.json`的依赖项中，这意味着可能签出您的项目的任何其他开发人员都可以`npm install`在项目目录中运行并自动安装，因为它作为依赖项`ncurses`列出。`package.json`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:50:21.753

如果没有`-g`标志，您使用 NPM 安装的任何内容都会安装到相对于您运行命令的位置的 node_modules 文件夹中。

我的第一个建议是确保您位于项目的工作目录中，然后`ncurses`再次安装。

这是一篇关于它是如何设计的旧但相关[的博客文章。](http://blog.nodejs.org/2011/03/23/npm-1-0-global-vs-local-installation/)

# android - Android：getSearchableInfo(getComponentName()) 返回 null？

> ID：11543287
> 
> 赞同：13
> 
> 时间：2012-07-18T14:06:41.780
> 
> 标签：android, android-searchmanager, search-suggestion, searchview

我正在尝试获取有关 SearchView 的建议。我已经为它实现了一个自定义内容提供程序。我还参考了这个[链接](http://developer.android.com/intl/es/training/search/setup.html)来实现对 SearchView 的建议。我面临的问题是，我得到空值`searchManager.getSearchableInfo(getComponentName())`

以下是片段：

**AndroidManifest.xml**

```
 <application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

    <provider android:name=".SearchProvider"
        android:enabled="true"
        android:authorities="com.example.currentlocationmapdemo"
        android:grantUriPermissions="true"
        android:exported="true">
        <grant-uri-permission android:pathPattern="*" />
    </provider>
    <uses-library android:name="com.google.android.maps" />

    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
      <meta-data android:name="android.app.searchable"
          android:resource="@xml/searchable"/> 
    </activity> 
```

**可搜索的.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<searchable xmlns:android="http://schemas.android.com/apk/res/android"
android:label="label"
android:hint="hint"
android:searchSuggestAuthority="com.example.currentlocationmapdemo"
android:searchSuggestSelection=" ? "> 
```

**主要活动**

```
 @Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.searchview_in_menu, menu);
    MenuItem searchItem = menu.findItem(R.id.action_search);
    mSearchView = (SearchView) searchItem.getActionView();
    SearchManager searchManager = (SearchManager) getSystemService(Context.SEARCH_SERVICE);
SearchableInfo info = searchManager.getSearchableInfo(getComponentName());  // null returned
mSearchView.setSearchableInfo(info);

 return true;
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-08T18:12:37.300

至少您的一项活动（您正在执行搜索的活动就足够了）必须在清单中包含此意图过滤器：

```
<intent-filter>
  <action android:name="android.intent.action.SEARCH" />
</intent-filter> 
```

如果不是，则`searchManager.getSearchableInfo(getComponentName())`始终返回 null，并且您的配置将被忽略。

这让我死了一天 - 我认为它与 ActionBarSherlock 相关，但不适用。问题是我试图使样品短路，就像你一样:-)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-01T12:33:49.013

我认为你的方法是错误的。您应该有 2 个活动 - 1：具有 SearchView（在 ActionBar 或布局上）的主要活动和 2：将在执行搜索时启动的 SearchActivity。

也许你也可以这样做，但我不确定。您希望在您的方法中从哪里接收 ACTION_SEARCH 意图？通常你在你的 searchActivity 中的 OnCreate 中这样做：

```
Intent intent = getIntent();
if (Intent.ACTION_SEARCH.equals(intent.getAction())) {
  String query = intent.getStringExtra(SearchManager.QUERY);
  System.out.println("searching for: " + query);
} 
```

我在两个活动中做到了，它对我有用。我必须做的另一件事是在 Android 搜索教程中没有找到：

```
<meta-data
android:name="android.app.default_searchable"
android:value=".SearchableActivity" /> 
```

在我的 MainActivity 清单中

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-04T23:45:17.273

您的 searchable.xml 包含字符串文字（提示和标签），它们应该是引用。这就是使它失败的原因：[SearchInfo always come out null](https://stackoverflow.com/questions/10217582/searchinfo-always-coming-out-null)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-06T12:53:24.117

只是想为仍在为此苦苦挣扎的任何人添加`<data>`标签会干扰您的意图过滤器并导致您获得 null `searchableInfo`。我有这个：

```
<intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <action android:name="android.intent.action.SEARCH" />
    <data android:scheme="https"
          android:host="www.example.com"/>
</intent-filter> 
```

我需要更改为：

```
<intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <data android:scheme="https"
          android:host="www.example.com"/>
</intent-filter>

<intent-filter>
    <action android:name="android.intent.action.SEARCH" />
</intent-filter> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-21T08:58:07.287

如果您正在使用两个活动，一个用于显示搜索对话框（OtherActivity），另一个用于结果（SearchableActivity），请查看此[https://stackoverflow.com/a/58261225/4594347以节省时间](https://stackoverflow.com/a/58261225/4594347)

# c - pthread_sigmask 干扰 GDB

> ID：11543288
> 
> 赞同：2
> 
> 时间：2012-07-18T14:06:43.750
> 
> 标签：c, gdb, pthreads, signals, sigint

我一直在 Linux 下开发一个多线程程序，对信号处理有特殊要求。例如，我需要程序打印单个 Ctrl-C 输入的统计信息。

我使用 pthread_sigmask 和 sigwait 实现了这一点，即在创建其余线程之前阻塞主线程中的所有非关键信号，并启动一个在 sigwait 上阻塞的“捕获器”线程。

初始化（主要）：

```
sigfillset(&set);
sigdelset(&set, SIGSEGV);
sigdelset(&set, SIGBUS);
sigdelset(&set, SIGILL);

s = pthread_sigmask(SIG_BLOCK, &set, NULL);
if (s != 0)
    handle_error_en(s, "pthread_sigmask");

s = pthread_create(&signal_thread, NULL, &sig_thread, (void *) &set);
if (s != 0)
    handle_error_en(s, "pthread_create"); 
```

捕手线程例程：

```
void *sig_thread(void *arg) {
    sigset_t *set = (sigset_t *) arg;
    int s, sig;

    pthread_detach(pthread_self());

    for(;;) {
        s = sigwait(set, &sig);
        if (s != 0)
            handle_error_en(s, "sigwait");
        switch(sig) {
            case SIGINT:
                break;
            case SIGTERM:
                break;
            case SIGUSR1:
                break;
            case SIGUSR2:
                break;
            default:
                break;
        }
    }
    pthread_exit(NULL);
    return NULL;
} 
```

一切都按预期工作，但我的捕获机制阻止 GDB 暂停程序（触发 SIGINT 例程）。我怎样才能解决这个问题 ？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T10:04:51.903

在附加 gdb 之前 尝试使用`SIGSTOP`（而不是）暂停程序。不能被捕获或忽略，它会暂停你的程序，直到 gdb 附加到它（然后可以继续它）。`SIGINT``SIGSTOP`

# php - cakephp $this->User->save($this->data) 登录用户的编辑功能出错

> ID：11543289
> 
> 赞同：1
> 
> 时间：2012-07-18T14:06:44.310
> 
> 标签：php, cakephp, cakephp-2.0

我正在尝试为 cakephp 中的登录用户创建“编辑”个人资料页面。这将是添加/编辑有关用户的信息的功能。我在 $this->User->save($this->data) 函数期间遇到错误，我不明白问题出在哪里。

```
public function edit() {
   $this->User->id = $this->Auth->User('id');

    if ($this->request->is('post')) {
        if ($this->User->save($this->data)) {
            $this->Session->setFlash(__('The user has been saved'), 'flash_success');
           // $this->redirect($this->Auth->redirect());
        } else {
            var_dump($this->invalidFields());

            $this->Session->setFlash(__('The user could not be saved. Please, try again.'), 'flash_failure');
        }
    } else {
        //autocompleto il form
        $this->data = $this->User->read(null, $this->Auth->User('id'));
    }
} 
```

观点是：

```
<?php 
echo $this->Form->create('User',array('action' => 'edit'));
echo $this->Form->input('name', array('label'=> 'Name'));
echo $this->Form->input('surname', array('label'=> 'Surname'));
echo $this->Form->input('id', array('type'=> 'hidden'));
echo $this->Form->end(__('Submit')); 
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T08:13:30.893

我看到你使用`Auth`组件。如果您的`Auth::authorize`默认值被覆盖，请确保您授予用户适当的权限来执行数据写入（也许他只允许读取）。

另一个问题可能是您`$validate`在模型中的声明，您在其中强制用户输入字段值（使用`'required' = true`），但实际上该字段甚至没有显示在 View 上。`'on' => 'create'`如果在内部定义，您可以避免在数据编辑时使用此验证规则。

此外，我建议使用 CakePHP [debug()](http://book.cakephp.org/2.0/en/development/debugging.html)而不是 var_dump() 进行调试。

# android - 自定义列表视图中进度条的相同纵横比

> ID：11543296
> 
> 赞同：2
> 
> 时间：2012-07-18T14:07:26.260
> 
> 标签：android, android-layout, progress-bar

我有一个带有自定义行布局的列表视图。在这个自定义行中是一个进度条（“圆圈”），它指示加载状态。为了使布局看起来我喜欢它，我使用 layout_weight 作为进度条和包含其他一些 gui 内容的布局。

例子：

```
<ProgressBar
    android:id="@+id/progressBar1"
    style="?android:attr/progressBarStyleSmall"
    android:layout_width="0dip" 
    android:layout_height="match_parent" 
    android:layout_weight="1" />

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="0dip" 
    android:layout_height="match_parent" 
    android:layout_weight="7"
    android:layout_marginLeft="6dip" 
    android:orientation="vertical"
    > 
```

我希望进度条具有相同的纵横比。

我的问题是进度条在不同的设备上看起来很奇怪。在我的 Galaxy Nexus 上，一切看起来都很好，并且进度条具有相同的纵横比。但是在 - 例如 - 我的模拟器上，进度条看起来像一个鸡蛋，这太可怕了。

有人可以指出我的错误吗？

**编辑：**

我不使用 wrap_content 因为布局将在视图的其余部分使用进度条的宽度，这真的很小（那么文本就没有地方了）。

**编辑2：**

两张图片显示问题：

“蛋” [http://s14.directupload.net/file/d/2955/89xvdhrz_png.htm](http://s14.directupload.net/file/d/2955/89xvdhrz_png.htm)

wrap_content 的使用 [http://s1.directupload.net/file/d/2955/sryrhkkk_png.htm](http://s1.directupload.net/file/d/2955/sryrhkkk_png.htm)

**编辑3：**

CFlex 的方法。整个 xml 文件

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
android:layout_width="fill_parent" 
android:layout_height="wrap_content" 
android:orientation="horizontal">

<ProgressBar
    android:id="@+id/progressBar1"
    style="?android:attr/progressBarStyleSmall"
    android:layout_width="wrap_content" 
    android:layout_height="match_parent" 
    android:layout_gravity="center"
    android:layout_margin="4dp"/>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="0dip" 
    android:layout_height="match_parent" 
    android:layout_weight="7"
    android:layout_marginLeft="6dip" 
    android:orientation="vertical"
    >

    <TextView 
        android:id="@android:id/text1" 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" 
        android:textAppearance="?android:attr/textAppearanceLarge"/>

    <TextView 
        android:id="@android:id/text2" 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" 
        android:textAppearance="?android:attr/textAppearanceSmall"/>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T14:30:11.757

你为什么不尝试这样的事情：

```
<ProgressBar
    android:id="@+id/progressBar1"
    style="?android:attr/progressBarStyleSmall"
    android:layout_width="wrap_content" 
    android:layout_height="match_parent"  
    android:layout_gravity="center"
    android:layout_margin="4dp"/>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="0dp" 
    android:layout_height="match_parent" 
    android:layout_weight="1"
    android:layout_marginLeft="6dip" 
    android:orientation="vertical"
    > 
```

假设你在水平`LinearLayout`

告诉我这是否行不通。

**编辑**：使用 relativeLayout

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content">

    <ProgressBar
            android:id="@+id/progressBar1"
            style="?android:attr/progressBarStyleSmall"
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:layout_margin="4dp"/>

    <TextView
            android:id="@android:id/text1"
            android:layout_toRightOf="@+id/progressBar1"
            android:layout_alignParentTop="true"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textAppearance="?android:attr/textAppearanceLarge"/>

    <TextView
            android:layout_toRightOf="@+id/progressBar1"
            android:layout_below="@android:id/text1"
            android:id="@android:id/text2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textAppearance="?android:attr/textAppearanceSmall"/>

</RelativeLayout> 
```

# python - 将 Python 函数中的所有变量设为全局变量

> ID：11543297
> 
> 赞同：24
> 
> 时间：2012-07-18T14:07:27.897
> 
> 标签：python, function, global-variables

有没有一种简单的方法可以使函数中的所有变量成为全局变量？

我在一个函数中有 20 个奇怪的变量，并且将它们一个一个地命名为全局变量并不能成为很好的代码......无论如何对我来说 :)

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-07-18T14:29:25.357

## 警告：不要在家里尝试这个，你可能会烧毁它。

在正常的日常编程过程中，没有正当理由进行以下操作。请查看此问题的其他答案以获得更现实的替代方案。

我几乎无法想象你为什么要这样做，但这里有一种方法：

```
def f(a, b, c):
    d = 123
    e = 'crazy, but possible'
    globals().update(locals())

def g():
    print a, b, c, d ,e

>>> globals()
{'g': <function g at 0x875230>, 'f': <function f at 0x8751b8>, '__builtins__': <module '__builtin__' (built-in)>, '__package__': None, '__name__': '__main__', '__doc__': None}

>>> g()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 2, in g
NameError: global name 'a' is not defined

>>> f(10, 20, 'blah')
>>> g()
10 20 blah 123 crazy, but possible

>>> globals()
{'a': 10, 'c': 'blah', 'b': 20, 'e': 'crazy, but possible', 'd': 123, 'g': <function g at 0x875230>, 'f': <function f at 0x8751b8>, '__builtins__': <module '__builtin__' (built-in)>, '__package__': None, '__name__': '__main__', '__doc__': None} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-18T16:19:08.750

这样做的pythonic方法是将变量保持在本地范围内（即在每个函数中定义它们）并将它们作为参数/返回值在函数之间传递；或将变量保留为对象或类的属性，从而在该类中创建“函数”方法。无论哪种方式都可以，但是该`global`关键字专门设计用于阻止您以您描述的方式使用它。全局变量不仅仅是“糟糕的风格”，而且它们使您的代码非常难以维护，因为您的变量需要坚持的任何不变量都需要在每个函数中进行检查。

这是一个良好风格的例子（带有功能）：

```
def quads(a, b, c):
    x1 = (-1.0 * b + math.sqrt(b * b - 4.0 * a * c)) / (2.0 * a)
    x2 = (-1.0 * b - math.sqrt(b * b - 4.0 * a * c)) / (2.0 * a)
    return x1, x2

def pretty(a, b, c, x1, x2):
    eqn = "%fx^2 + %fx + %c" % (a, b, c)
    print "The first solution to the equation %s is: %f" % (eqn, x1)
    print "The second solution to the equation %s is: %f" % (eqn, x2)
    return

def main():
    a = 100
    b = 200
    c = 300
    x1, x2 = quads(a, b, c)
    pretty(a, b, c, x1, x2)
    return

if __name__ == '__main__':
    main() 
```

这是一个良好风格的示例（使用 OOP）：

```
class Quadratic(object):

    def __init__(self, a, b, c):
        self.a = a
        self.b = b
        self.c = c
        self.x1 = None 
        self.x2 = None 
        self.solve() # Set x1 and x2 to correct values
        # To maintain the invariant between a, b, c and x1, x1
        # we should override __setattr__ or use descriptors or
        # properties so that self.solve() is called every time
        # a, b, or c are updated.
        return

    def solve(self):
        self.x1 = (-1.0 * self.b +
                   math.sqrt(self.b * self.b - 4.0 * self.a * self.c)) / (2.0 * self.a)
        self.x2 = (-1.0 * self.b - 
                   math.sqrt(self.b * self.b - 4.0 * self.a * self.c)) / 2.0 * self.a
        return 

    def pretty(self):
        eqn = "%fx^2 + %fx + %c" % (self.a, self.b, self.c)
        print "The first solution to the equation %s is: %f" % (eqn, self.x1)
        print "The second solution to the equation %s is: %f" % (eqn, self.x2)
        return

def main():
    quad = Quadratic(100, 200, 300)
    quad.pretty()
    return

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-07-18T14:24:34.467

没有办法将它们全部声明为全局的，而且您真的不想这样做。这 20 个变量可能应该变成一个具有 20 个属性的对象。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-19T01:03:45.630

最简单的解决方案是只有一个全局的——或者更好的是，弄清楚如何将它传递给函数。将它用作全局看起来像这样（再次，我展示了最简单的情况，不一定是 Python 的最佳使用）：

```
class Info(object):  # or whatever you want to name the container
    """Holder for global information."""

info = Info()        # single instance we will use

def my_function():
    print "Here is some info:"
    print info.a, info.b, info.c

info.a = 3
info.b = 8
info.c = []

if __name__ == '__main__':
    my_function() 
```

同样，我可能会`info`改为传递给函数。但是由于您的问题是关于全局的，所以这里显示为全局。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-14T04:03:06.050

我想这样做的一个小众示例：使用导入函数。*

```
def temp():
    a = "stays local value"
    old_locs = locals().copy()
    b = "is global value"
    import math
    new_locs = locals()
    new_vars = {k: new_locs[k] for k in set(new_locs) - set(old_locs)
                if k != 'old_locs'}
    globals().update(new_vars)    
temp()
print(b)
print(math.sqrt(3))
print(a) 
```

给
`is global value`

`1.7320508075688772`

`NameError: name 'a' is not defined`

这样，只有特定的 20 个左右的变量会更新全局命名空间，而函数中的中间变量名则不会。

*我需要从 .ipynb 文件导入，这样做的过程取决于是否从 google Collaboratory、桌面 .ipynb 或桌面 .py 文件调用；这涉及使用魔法，这些魔法在不会调用这些分支的情况下被视为无效语法，因此通过导入我的导入函数，我可以逃避这个问题。

# multithreading - Qt + OpenCV - 在 QLabel 上显示图像

> ID：11543298
> 
> 赞同：3
> 
> 时间：2012-07-18T14:07:33.373
> 
> 标签：multithreading, qt, opencv

我正在尝试从相机捕获实时视图，并将其重定向以显示在 QLabel 上。但只有一半的观点出现（见下文）： ![截屏](../Images/ea2af9a60d831aac2158cd5bb8d947a8.png)

左侧窗口使用 cv::imshow() 显示，效果很好。我在不同的线程中捕获 Mat，然后以 Qimage 作为参数发出信号，然后将图像设置为插槽中的 QLabel。

这是代码：

```
while(true){
    cam >> mat;
    cv::imshow("name",mat);
    emit send_UIupdate(mat2qimage(mat));
} 
```

并在将图像设置为 Qlabel 的插槽中：

```
void Dialog::updateUI(const QImage &img){
    label->setPixmap(QPixmap::fromImage(img));
} 
```

使用以下将 Mat 转换为 QImage：

```
QImage camera::mat2qimage(const cv::Mat& mat) {
    cv::Mat rgb;
    cv::cvtColor(mat, rgb, CV_BGR2RGB);
    return QImage((const unsigned char*)(rgb.data), rgb.cols, rgb.rows, QImage::Format_RGB888);
} 
```

**有什么建议可以解决这个问题吗？？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T23:15:17.020

你可以试试这个：

```
QImage MainWindow::putImage(const Mat& mat)
{
    // 8-bits unsigned, NO. OF CHANNELS=1
    if(mat.type()==CV_8UC1)
    {
        // Set the color table (used to translate colour indexes to qRgb values)
        QVector<QRgb> colorTable;
        for (int i=0; i<256; i++)
            colorTable.push_back(qRgb(i,i,i));
        // Copy input Mat
        const uchar *qImageBuffer = (const uchar*)mat.data;
        // Create QImage with same dimensions as input Mat
        QImage img(qImageBuffer, mat.cols, mat.rows, mat.step, QImage::Format_Indexed8);
        img.setColorTable(colorTable);
        return img;
    }
    // 8-bits unsigned, NO. OF CHANNELS=3
    if(mat.type()==CV_8UC3)
    {
        // Copy input Mat
        const uchar *qImageBuffer = (const uchar*)mat.data;
        // Create QImage with same dimensions as input Mat
        QImage img(qImageBuffer, mat.cols, mat.rows, mat.step, QImage::Format_RGB888);
        return img.rgbSwapped();
    }
    else
    {
        qDebug() << "ERROR: Mat could not be converted to QImage.";
        return QImage();
    }
} 
```

我用 QTimer 调用它。我从那里得到它：[http ://code.google.com/p/qt-opencv-multithreaded/](http://code.google.com/p/qt-opencv-multithreaded/)

希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-23T14:47:02.303

```
VideoCapture cap("video.avi");
Mat frame;
QImage img;
QPixmap pixel;
while(cap.isOpened())
{
    cap >> frame;
    img= QImage((uchar*) frame.data, frame.cols, frame.rows, frame2.step, QImage::Format_RGB888);
    pixel = QPixmap::fromImage(img);
    ui->label->setPixmap(pixel);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-28T07:54:57.417

我认为问题来自以下代码：

```
while(true){
    cam >> mat;
    cv::imshow("name",mat);
    emit send_UIupdate(mat2qimage(mat));
} 
```

您的应用程序冻结，因为您正在循环并且从不让 Qt 进行必要的处理。参考链接：[QT 做 while 循环](https://stackoverflow.com/questions/5700403/qt-do-while-loop)

你知道，Qt 有它自己的事件循环，所以，如果你在函数中使用 while(true) 循环，Qt 可能永远不会收到事件。

尝试删除 while 循环，并按照@CTZStef 所说的那样使用 Qtimer。

以下源代码可能对您有所帮助：http: [//blog.csdn.net/robertkun/article/details/9030929](http://blog.csdn.net/robertkun/article/details/9030929)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-03T21:55:16.077

在 mat2qimage 函数中，您应该返回一个副本。

`return QImage((const unsigned char*)(rgb.data), rgb.cols, rgb.rows, Image::Format_RGB888).copy();`

# html - 用于 m3u 文件的 Live Flash Player

> ID：11543309
> 
> 赞同：1
> 
> 时间：2012-07-18T14:08:11.933
> 
> 标签：html, wordpress, live, flash, radio

我正在寻找可以播放 m3u 文件的 Flash Player。我可以用 Windows Media Player 打开 m3u 文件，但我想嵌入到我的博客中。

我有 m3u 文件的 URL。它用于广播电台。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:10:15.613

[JWPlayer 就是](http://www.longtailvideo.com/players)这样做的。你只需要传递正确的参数。

这是一个确切的片段：[https ://stackoverflow.com/a/6871647/141200](https://stackoverflow.com/a/6871647/141200)

如果您的 wordpress，他们的 Wordpress 插件效果很好：[http ://wordpress.org/extend/plugins/jw-player-plugin-for-wordpress/](http://wordpress.org/extend/plugins/jw-player-plugin-for-wordpress/)

简码片段：[jwplayer height="24" file="http://domain/podcasts/playlist.m3u"]

# jquery - LavaLamp 菜单在我的菜单上不起作用

> ID：11543310
> 
> 赞同：0
> 
> 时间：2012-07-18T14:08:21.040
> 
> 标签：jquery, html, css, jquery-ui, lavalamp

我有一个导航菜单，我想使用熔岩灯 jQuery 插件。在这个小提琴示例中，熔岩灯插件完美运行：http: **[//jsfiddle.net/tsLPT/3/](http://jsfiddle.net/tsLPT/3/)**但在我的菜单上：http: **[//jsfiddle.net/DMfvx/65/](http://jsfiddle.net/DMfvx/65/)**不起作用:((谁能帮我这是因为我被困住了

我希望熔岩灯只在我的菜单中的主 UL 上运行，而不是在儿童 ul 上运行。

**谢谢你！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:20:29.583

与引用#selected 的“currentPageItem”相关的错误。

由于您的菜单项都没有“已选择”的 id，因此它失败了。通过向你的一个 li 添加一个“selected”的 id，它现在可以工作了。

[http://jsfiddle.net/gRoberts/DMfvx/66/](http://jsfiddle.net/gRoberts/DMfvx/66/)

# javascript - HTML5 中的自定义拖放画布

> ID：11543311
> 
> 赞同：0
> 
> 时间：2012-07-18T14:08:26.143
> 
> 标签：javascript, html, drag-and-drop

我做了一个小测试来检查 HTML 5。

在我的测试中，我有一个`<canvas>`并且想要拖动这个。但我有一个小问题，我的画布有点晃动。

有人可以帮我吗？

小提琴：http: [//jsfiddle.net/wnxFK/](http://jsfiddle.net/wnxFK/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:18:57.950

在拖动开始时计算 layerX 和 layerY 有助于创建更平滑的效果：

[http://jsfiddle.net/jB5YN/](http://jsfiddle.net/jB5YN/)

所以一开始你有：

```
var mousedown = false;

var layerX = 0;
var layerY = 0;

function onMouseDown(event)
{
    var canvas = document.getElementById("myCanvas");
    mousedown = true;

    layerX  = event.layerX;
    layerY  = event.layerY;

    // Code
    drag(event);
} 
```

当你来拖动时，你有：

```
function drag(event)
{
     var clientX = ('clientX' in event) ? (event.clientX) : (event.offsetX);
     var clientY = ('clientY' in event) ? (event.clientY) : (event.offsetY);

     var canvas = document.getElementById("myCanvas");
     var context = canvas.getContext('2d');

     var x = (event.clientX- layerX);
            var y = (event.clientY- layerY);

     var log = document.getElementById("log");
     log.innerHTML = "x: " + x + " y: " + y;

     canvas.style.left = x + 'px';
     canvas.style.top = y + 'px';
} 
```

此外，我已经将事件移动到一开始只连接一次，对我来说感觉更整洁！

**更新**

只是为了一个完整的答案，如果您想避免似乎在 webkit 中被弃用的 layerX 和 layerY ，您可以自己计算它们：

[http://jsfiddle.net/B3TYe/](http://jsfiddle.net/B3TYe/)

变化是：

```
var offsetX= 0;
var offsetY= 0;

function onMouseDown(event)
{
    var canvas = document.getElementById("myCanvas");
    mousedown = true;

    var left = (canvas.style.left=="")? 0:parseInt(canvas.style.left);
    var top = (canvas.style.top=="")? 0:parseInt(canvas.style.top);

    offsetX = event.pageX - left;
    offsetY = event.pageY - top;

    // Code
    drag(event);
} 
```

安迪

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:23:31.413

我不会使用 clientX 和 layerX 属性。这是一个例子：

[http://jsfiddle.net/wnxFK/3/](http://jsfiddle.net/wnxFK/3/)

```
function drag(event)
    {
        var canvas = document.getElementById("myCanvas");

        canvas.style.left = event.pageX - 50 + 'px';
        canvas.style.top = event.pageY - 50 + 'px';
    }​ 
```

# vb.net - 显示文本框工具提示

> ID：11543318
> 
> 赞同：2
> 
> 时间：2012-07-18T14:08:52.887
> 
> 标签：vb.net, winforms, tooltip

我正在尝试在 vb.net 的工具提示中工作。我想要做的是我在文本框控件中写入的文本在工具提示中显示它。我能够在工具提示中显示文本，但我的问题是当我编辑输入文本时，它会在弹出工具提示中显示新旧文本。这是我到目前为止所做的。

```
Public Class Form1
  Dim s As String = ""

  Private Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
    s = TextBox1.Text
    Dim tooltip1 As System.Windows.Forms.ToolTip = New System.Windows.Forms.ToolTip()

    tooltip1.SetToolTip(Button1, s)
  End Sub
End Class 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:22:50.817

很难弄清楚为什么这很有用，但尝试使用`TextChanged`文本框的事件来更新工具提示：

```
Private _ToolTip As New ToolTip()

Private Sub TextBox1_TextChanged(ByVal sender As Object, ByVal e As EventArgs) _
                                 Handles TextBox1.TextChanged
  _ToolTip.Show(TextBox1.Text, TextBox1)
End Sub 
```

# client-side - 如何使用 grunt.js 验证 HTML/CSS 文件？

> ID：11543319
> 
> 赞同：10
> 
> 时间：2012-07-18T14:08:59.980
> 
> 标签：client-side, html-validation, gruntjs

这是一个菜鸟问题。

我想`grunt.js`用作我的网络项目的构建工具。可以`grunt.js`用来验证我的`HTML/CSS`文件吗？你有这样一个`grunt.js`文件的例子吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-14T16:06:44.643

There is another plugin that seems to be updated more often and does not require java. [grunt-html-validation](https://github.com/praveenvijayan/grunt-html-validation). It has a number of options and has been working great for me. You can install and use it like this:

```
npm install grunt-html-validation --save-dev 
```

Then put something like this in the initconfig of your Gruntfile.js

and this in appropriate places in your Gruntfile.js

```
grunt.loadNpmTasks('grunt-html-validation');
grunt.registerTask("default", ["validation"]); 
```

There is also a number of useful options including the ability to relax errors based on a regular expression (could be useful for AngularJS for example) and the ability to save a report.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-25T13:56:59.147

您可以使用 grunt 插件[grunt-html](https://github.com/jzaefferer/grunt-html)。请注意，您需要在计算机上安装 Java 才能使用它。这对我来说很有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-26T15:54:46.043

到目前为止，似乎有两个流行的 HTML 验证插件：

*   [grunt-html-验证](https://github.com/praveenvijayan/grunt-html-validation)
*   [咕噜-html](https://github.com/jzaefferer/grunt-html)

`grunt-html-validation`使用 W3C 标记验证服务并`grunt-html`使用基于 java 的 The Nu HTML Checker 的本地副本。

它们都运行良好并且具有非常相似的选项，因此归结为您是要等待外部服务调用还是等待本地 Java 应用程序。

# xml - 如何确定要从算法 URI 创建的对象的类别

> ID：11543320
> 
> 赞同：2
> 
> 时间：2012-07-18T14:09:10.357
> 
> 标签：xml, cryptography, uri, canonicalization, xml-dsig

由于对我施加的规范，我编写了自己的 C# 代码来签署 XML，并验证签署的 XML。很像 SignedXml 类，但这样我更灵活，例如是否使用 XML 命名空间前缀（似乎 SignedXml 不喜欢签名 XML 中的命名空间前缀，但我的 XML 规范说我必须拥有它们），并且在签名算法（规范现在说 sha256）。

一切似乎都有效，但困扰我的一个“不完美”是 - 例如 - 在验证 xml 时，我需要使用特定类别的对象来转换或验证数据，而我所要做的只是指定的算法 URI在 XML 中。一个例子是规范化：如果 XML 说`"http://www.w3.org/2001/10/xml-exc-c14n#"`我*知道*我可以使用`XmlDsigExcC14NTransform`该类，但我的问题是：**有没有办法从这样的 URI（或任何 URI）到特定的对象类？**

我现在使用我已知的 URI 列表和它们引用的对象类（我认为）（或将其与已知对象类列表的算法属性进行比较，例如`XmlDsigExcC14NTransform.Algorithm`），这并不是我真正喜欢的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T19:35:49.403

这没有很好的记录，但[`System.Security.Cryptography.CryptoConfig.CreateFromName(string)`](http://msdn.microsoft.com/en-us/library/381afeex.aspx)会返回与 URI 关联的转换。

# r - 在 R 中创建一系列图形

> ID：11543321
> 
> 赞同：0
> 
> 时间：2012-07-18T14:09:11.160
> 
> 标签：r, graph, plot

我有一系列三个相似的图表，我想在 R.. 的单个窗口中显示它们。

这是数据：

```
Date Tank Time Female.in.Middle Female.in.R.assoc Female.in.L.assoc R.side.of.divider
117 25-Jun   I3  200           0.0966            0.2721            0.2001            0.0000
120 26-Jun   I3 1030           0.2118            0.5663            0.2212            0.0000
123 27-Jun   I3  200           0.0000            0.0000            0.0000            0.0000
128 28-Jun   I3 1100           0.0237            0.0672            0.1408            0.3289
129 28-Jun   I3  230           0.0683            0.0606            0.2488            0.0000
132 29-Jun   I3  200           0.1823            0.1180            0.6990            0.0000
135  2-Jul   I3  200           0.0000            0.0000            0.0000            0.0000
138  3-Jul   I3 1030           0.0000            0.0000            0.0000            0.0000
    L.side.of.Divider Tank.1 Date.Entered M.L.name Male.L.Length Male.L.Weight M.R.name
117            0.4285     I3       22-Jun  green 2           7.6         14.32   pink 1
120            0.0000     I3       22-Jun  green 2           7.6         14.32   pink 1
123            0.9961     I3       22-Jun  green 2           7.6         14.32   pink 1
128            0.4423     I3       22-Jun  green 2           7.6         14.32   pink 1
129            0.6215     I3       22-Jun  green 2           7.6         14.32   pink 1
132            0.0000     I3       22-Jun  green 2           7.6         14.32   pink 1
135            0.9952     I3       22-Jun  green 2           7.6         14.32   pink 1
138            0.9948     I3       22-Jun  green 2           7.6         14.32   pink 1
    Male.R.Length Male.R.Weight Side.of.Spawn F.Length F.Weight F.name last.female.spawn.date
117           7.7         14.79             L      5.5     5.64     2c                 22-Jun
120           7.7         14.79             L      5.5     5.64     2c                 22-Jun
123           7.7         14.79             L      5.5     5.64     2c                 22-Jun
128           7.7         14.79             L      5.5     5.64     2c                 22-Jun
129           7.7         14.79             L      5.5     5.64     2c                 22-Jun
132           7.7         14.79             L      5.5     5.64     2c                 22-Jun
135           7.7         14.79             L      5.5     5.64     2c                 22-Jun
138           7.7         14.79             L      5.5     5.64     2c                 22-Jun
    spawn.date.in.paradigm  X d.in.p dbs X.1 X.2 X.3
117                  3-Jul 11      3   8  NA  NA  NA
120                  3-Jul 11      4   7  NA  NA  NA
123                  3-Jul 11      5   6  NA  NA  NA
128                  3-Jul 11      6   5  NA  NA  NA
129                  3-Jul 11      6   5  NA  NA  NA
132                  3-Jul 11      7   4  NA  NA  NA
135                  3-Jul 11     10   1  NA  NA  NA
138                  3-Jul 11     11   0  NA  NA  NA 
```

我正在使用这段代码来制作图表：

```
d2c<-plot(jd2c$d.in.p, jd2c$L.side.of.Divider, type='l', col='purple', xlab='Days After Entry', ylab='Proportion of Time Spent on Each Side of Divider', main='Female 2c', ylim=c(0,1))
legend('topleft',.8,c('Left', 'Right'),pch=c(.8), col=c('purple','green'))
points(jd2c$d.in.p, jd2c$R.side.of.divider, type='l', col='green')

az2c<-plot(jd2c$d.in.p, jd2c$Female.in.L.assoc, type='l', col='purple', xlab='Days After Entry', ylab='Proportion of Time Spent in Assoc. Zones', main='Female 2c', ylim=c(0,1))
legend('topleft',.8,c('Left', 'Right'),pch=c(.8), col=c('purple','green'))
points(jd2c$d.in.p, jd2c$Female.in.R.assoc, type='l', col='green')

rside2c<-cbind(jd2c$Female.in.R.assoc + jd2c$R.side.of.divider)
lside2c<-cbind(jd2c$Female.in.L.assoc + jd2c$L.side.of.Divider)

side2c<-plot(jd2c$d.in.p, lside2c, type='l', col='purple', xlab='Days After Entry', ylab='Proportion of Time Spent on Each Side (cumulative)', main='Female 2c', ylim=c(0,1))
legend('topleft',.8,c('Left', 'Right'),pch=c(.8), col=c('purple','green'))
points(jd2c$d.in.p, rside2c, type='l', col='green') 
```

如何让所有三个图表都显示在一个窗口上？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:14:51.167

你会想要使用`par`：

```
# Put this before your plots:
par(mfrow=c(3,1))  # your plots appear in one column, three rows,
                   # in one figure.
plot(...)
plot(...)
plot(...)
par(mfrow=c(1,1))  # always a good idea to return it to how it was
                   # afterwards, so later plots aren't affected 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:32:48.747

目前尚不清楚您希望这三个图表如何显示，但一个简单的解决方案是在您的图表前加上...

```
par(mfrow = c(1,3)) 
```

现在您将在一个窗口中看到所有三个图表。当然，您需要使窗口更宽。否则图形将全部被压扁。您需要查找`?Devices`所需的特定输出。如果你只是想让它出现在屏幕上，那么`X11`在 Linux 或`quartz`Mac OS X 上都可以。例如，在 Mac 通话中...

```
quartz('my new graph', 15, 5) 
```

这将使空间的绘制宽度达到其高度的 3 倍。每当您进行初始绘图调用时，它都会自动隐式调用，尺寸为 7"。

您可能应该查找`par`帮助。保存当前设置然后再恢复它们也是一个很好的建议。所以，在绘制图形之前...

```
opar <- par(mfrow = c(1,3)) 
```

然后在你的图表之后

```
par(opar) 
```

即使您对图形参数进行了许多更改，这也是一种恢复事物的简单方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T16:36:16.050

其他人已经提到`par`，如果您想更好地控制绘图区域的位置、大小和形状，`mfrow`也可以使用该功能。`layout`

# python - 如何通过匹配python中的特定单词从字符串中只收集所需的整数

> ID：11543322
> 
> 赞同：0
> 
> 时间：2012-07-18T14:09:15.217
> 
> 标签：python, string, url

假设我有以下字符串

```
str = 'http://www.example.com/servlet/av/jd?ai=782&ji=2553120&sn=I' 
```

我只想获取整数`ji`，因为在上面的 url 中`255312`可能会生成不同的数字`ji`

提前致谢......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T14:12:00.553

解析 URL [`urlparse`](http://docs.python.org/library/urlparse.html)：

```
>>> import urlparse
>>> url = 'http://www.example.com/servlet/av/jd?ai=782&ji=2553120&sn=I'
>>> query_string = urlparse.urlparse(url).query
>>> query_dict = urlparse.parse_qs(query_string)
>>> query_dict
{'ai': ['782'], 'ji': ['2553120'], 'sn': ['I']}
>>> int(query_dict['ji'])
2553120 
```

现在您可以轻松检索所需的值。

# android - 安卓。内存不足问题

> ID：11543326
> 
> 赞同：3
> 
> 时间：2012-07-18T14:09:23.677
> 
> 标签：android

我需要在我的应用程序中显示许多图像。这些是 jpgs 和 pngs，我将它们加载到 ImageViews 中，如下所示：

```
tile.setImageResource(R.drawable.tile_highlight); 
```

我目前遇到 OutOfMemory 问题 ( `java.lang.OutOfMemoryError: bitmap size exceeds VM budget`)

我搜索并发现了其他一些帖子，它们都建议您应该手动回收 ImageView 的位图，如下所示：`((BitmapDrawable)imageView.getDrawable()).getBitmap().recycle();`这将从内存中转储它。

但在我的情况下，因为我没有使用`setBitmap()`将图像加载到 ImageView 对象上，当我尝试运行上面的代码时，它返回`NullPointerException`，更准确地说，该方法`getBitmap()`返回 null，没有位图？！？！

我是否需要返回我的代码并更改我在 ImageViews 中加载所有图像的方式，然后尝试使用该`recycle()`方法？或者我怎样才能释放内存使其不再崩溃？

**编辑**

我已经尝试过类似`imageView.setImageResource(-1);`的方法：希望它会从内存中删除图像并将其替换为 ... null 或其他东西，但它似乎无济于事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T14:18:27.263

如果您可以发布一些代码，那将会很有帮助。具体来说，您如何设置`ImageView`对象的图像。如果您不使用位图，我希望它`getBitmap()`会返回 null。但是，如果您使用另一种`Drawable`或其他方式来设置图像，则可能有类似的方法可以采用不涉及位图的方法。

编辑：

好吧，试一试。`Bitmap`您可以从这样的资源创建一个：

```
Bitmap bm = BitmapFactory.decodeResource(getResources(), R.drawable.image); 
```

然后，像这样使用位图，考虑到 img 是你的`ImageView`：

```
img.setImageBitmap(bm);
//Do some stuff with it, then when memory gets low:
((BitmapDrawable)img.getDrawable()).getBitmap().recycle(); 
```

当然，这是考虑到您正在进行一项活动。如果没有，您将必须掌握上下文并替换`getResources()`为`context.getResources()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-15T05:42:15.030

如果要将图像从 drawable 设置为 ImageView，请不要`ImageView.setImageResource(int resId)`直接与 drawable id 一起使用。而是获取按比例缩小的位图（如果适用）并将其设置为 imageView。像这样：这对我有用。

```
 iv.setImageBitmap(decodeResource(getResources(), R.drawable.big_image));

    private static Bitmap decodeResource(Resources res, int id) {
        Bitmap bitmap = null;
        BitmapFactory.Options options = new BitmapFactory.Options();
        for (options.inSampleSize = 1; options.inSampleSize <= 32; options.inSampleSize++) {
            try {
                bitmap = BitmapFactory.decodeResource(res, id, options);
                Log.d(TAG_LOG, "Decoded successfully for sampleSize " + options.inSampleSize);
                break;
            } catch (OutOfMemoryError outOfMemoryError) {
                // If an OutOfMemoryError occurred, we continue with for loop and next inSampleSize value
                Log.e(TAG_LOG, "outOfMemoryError while reading file for sampleSize " + options.inSampleSize
        + " retrying with higher value");
            }
        }
        return bitmap;
    } 
```

来源：[https ://codingjunkiesforum.wordpress.com/2014/06/12/outofmemory-due-to-large-bitmap-handling-in-android/](https://codingjunkiesforum.wordpress.com/2014/06/12/outofmemory-due-to-large-bitmap-handling-in-android/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:30:42.717

尝试

```
((BitmapDrawable)im.getBackground()).getBitmap().recycle(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-18T06:54:13.873

我认为您应该显示分辨率较低的图像。这将解决 OOM 问题。您还可以阅读 Android 开发者指南[链接](http://developer.android.com/intl/zh-tw/training/displaying-bitmaps/load-bitmap.html#load-bitmap)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-18T08:17:28.080

OutOfMemory 错误发生在您在使用位图后不释放位图（可能是大尺寸），因此为防止这种情况发生，我们应该记住重新调整大小、采用弱引用等，但是有很好的库可以解决所有问题之一他们是毕加索。请看一下-

[使用毕加索加载图像](http://square.github.io/picasso/)

# .htaccess - 带有 301 htaccess 重定向的小“hic”

> ID：11543327
> 
> 赞同：0
> 
> 时间：2012-07-18T14:09:25.660
> 
> 标签：.htaccess, redirect, http-status-code-301

我只想创建一个 301 重定向，但我的代码不起作用并返回一个漂亮的 404 页面 (-_-)。

我认为问题是“？” 在来自 url 中，我试图逃避它，但它不再起作用了。

```
RewriteRule ^produit.php?PDT_ID=473 /product.php?id_product=210 [R=301] 
```

谢谢看看

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:31:40.177

这是一个常见的错误。正如[文档](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)所说，要测试查询字符串中的内容，您需要使用 RewriteCond 指令，如下所示：

```
RewriteCond %{QUERY_STRING} PDT_ID=473
RewriteRule ^produit.php /product.php?id_product=210 [R=301] 
```

这意味着“如果查询字符串匹配模式'PDT_ID = 473'，并且模式匹配uri，然后重写”。请注意，您可能希望 rewriteCond 的正则表达式更加万无一失，以确保它也不会匹配 APDT_ID=4735 之类的内容，但这应该可以帮助您入门。

# jsf - 在生命周期的特定阶段调用 JSF 2.0 绑定方法

> ID：11543328
> 
> 赞同：1
> 
> 时间：2012-07-18T14:09:33.167
> 
> 标签：jsf, jsf-2

我有以下情况：

```
 form1.xhtml:
    <h:commandButton action="#{bean1.action1}" /> <!-- action1 returns "form2" -->
    form2.xhtml:
    <h:form binding="#{bean2.init}">
    ...
    <h:commandButton action="#{bean2.action2}" /> <!-- *** -->
    </h:form>

    Bean2.java:
    @Named
    Bean2{
    public Object getInit(){
        return null;
    }

    public void setInit (Object i){
        //do something
    } 
```

*提交form1*时，在第 6 阶段 RENDER_RESPONSE 期间执行绑定方法 setInit()（在 action1() 返回“form2”之后）并显示 form2。

*提交form2*时，如果 action2() 返回“null”，则在第 1 阶段 RESTORE_VIEW 期间执行 setInit()。**但如果 action2() 返回“form2”而不是 null，则该方法也会**在第 6 阶段被调用。

你知道为什么吗？如果操作返回 null，是否也可以调用绑定方法？

非常感谢！

# jquery - pageLoad() 未在使用 .NET 4.0 的动态加载页面中触发（在 3.5 上运行良好）

> ID：11543332
> 
> 赞同：4
> 
> 时间：2012-07-18T14:09:41.713
> 
> 标签：jquery, asp.net

我有一个简单的 aspx 页面，其中包含在右侧 div 上加载另一个 aspx 页面的链接（使用 JQuery 加载），如下所示：

```
<%@ Page Title="Home Page" Language="C#"  AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>
<html>
<head>
   <script type="text/javascript" src="Scripts/jquery-1.6.2.js"></script>
</head>
<body>
<form id="form1" runat="server">

    <script type="text/javascript">
        function loadPage() {
            $('#myRightdiv').load('Test.aspx', function () {});
        }
    </script>

 <asp:Button ID="Button1" runat="server" Text="Load ..." OnClientClick="loadPage(); return false;" />
 <div id="myRightdiv"></div>
 </form> 
```

在我的 Test.aspx 中，我有一个这样的 pageLoad：

```
<%@ Page Title="Test" Language="C#" AutoEventWireup="true" CodeFile="Test.aspx.cs" Inherits="About" %>

<html>
<head id="Head1" runat="server">
  <title></title>
</head>
<body>
<form id="form1" runat="server">
  <asp:ScriptManager ID="ScriptManager1" runat="server" />
  <script type="text/javascript">
    function pageLoad() {          
       alert("pageloaded");
    }        
  </script> 

</form>
</body>
</html> 
```

这在 ASP .NET 3.5 上运行良好 .... 但是使用 .NET 4.0 不会触发 pageLoad！

任何想法或解决方法？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-29T20:32:59.647

当 Microsoft Ajax 库完成对对象的初始化时，将调用该特殊`pageLoad`函数。`Sys.Application`不幸的是，这个初始化代码在 ASP.NET 4.0 中被彻底重写（详情如下），现在，在符合标准的浏览器中，当 jQuery函数`Sys.Application`加载页面时，根本不会初始化。`load`幸运的是，有一个简单的解决方法：初始化`Sys.Application`自己：

```
$('#myRightdiv').load('Test.aspx', function () { Sys.Application.initialize(); }); 
```

我在 IE9（标准模式）、Firefox 和 Chrome 中测试了此修复程序。

要让您的示例在 IE9（Quirks 模式）下工作，您还需要将您的`pageLoad`函数向上移动到`<head>`.

## ASP.NET 3.5 和 ASP.NET 4.0 之间发生了什么变化

在 ASP.NET 3.5 中，控件在标记之前`<asp:ScriptManager>`插入一个调用。当 jQuery 加载 Test.aspx 时，它会按顺序执行每个，因此在调用它之前定义了你的，并且一切正常。`Sys.Application.initialize()``</form>``<script>``pageLoad``Sys.Application.initialize()`

在 ASP.NET 4.0 中，`<asp:ScriptManager>`控件不再插入该位 JavaScript。反而：

*   在支持`document.addEventListener`[例如 IE9（标准模式）、Firefox 和 Chrome] 的浏览器中，`Sys.Application`构造函数会添加一个`DOMContentLoaded`事件侦听器，该侦听器调用`Sys.Application.initialize()`. 但是当浏览器完成加载*当前*页面（Default.aspx）`DOMContentLoaded`时已经提出。通过 AJAX 请求加载 Test.aspx 不会导致浏览器重新引发.*`DOMContentLoaded`*

**   在支持`document.attachEvent`但不支持的浏览器中`document.addEventListener`[例如 IE9（Quirks 模式）]，如果浏览器已完成加载当前页面（它已完成，因为当前页面是 Default.aspx） ，则`Sys.Application`构造函数调用。`Sys.Application.initialize()`在这种情况下，您需要在包含 MicrosoftAjax.js*之前*`pageLoad`定义您的函数；一个好地方是。*`<head>`** 

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T10:36:07.527

您可能想尝试在 pageLoad 之前引发的 Sys.Application.add_load(handler)，有关更多信息，请查看[此](http://msdn.microsoft.com/en-us/library/bb383829)内容。

如文档中所述[，](http://msdn.microsoft.com/en-US/library/bb386417.aspx) pageLoad 似乎没有任何变化。如果您没有对部分回发执行任何操作，那么您也可以使用 window.onload。

如果您只是检查是否成功收到响应，您可以使用[Jquery.load()的回调函数](http://api.jquery.com/load/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T20:01:40.573

有时，当您调用未完全加载的目标页面时，您将调用 pageload 方法，它不会应用于它，因此您必须在页面完全加载后调用

所以你可以在 Test.aspx 页面中做一些简单的解决方案，如下所示：

```
<asp:ScriptManager ID="ScriptManager1" runat="server" />
  <script type="text/javascript">
    function pageLoad() {          
       alert("pageloaded");
    }        

    pageLoad(); //invoke pageLoad immediately
  </script> 
```

与 3.5 和 4.0 相关的另一个原因我认为 4.0 中加载脚本管理器的处理时间更高。**

# sql-server - SQL：用最后一次观察替换 NA

> ID：11543336
> 
> 赞同：-1
> 
> 时间：2012-07-18T14:10:05.257
> 
> 标签：sql-server, sql-server-2012

我有一张像这样的大桌子：

```
Date   Price1   Price2
1      13       14.9
2      13.1     NULL
3      NULL     14
4      NULL     14.5
5      13       14 
```

我想填充 NA，以便我在 SQL 中的表如下所示：

```
Date   Price1   Price2
1      13       14.9
2      13.1     14.9
3      13.1     14
4      13.1     14.5
5      13       14 
```

我对SQL真的很陌生，所以请原谅。我在这里搜索，似乎您可以在 R 中执行此操作，但我应该如何在 SQL 中执行此操作。

我正在使用 Microsoft SQL Server 管理。此外，我似乎无法弄清楚如何正确插入表格，他们不会让我发布照片。所以，很抱歉格式化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:15:47.937

尝试这个：

```
UPDATE a
  SET a.Price1 = b.Price1
  FROM <YOUR-TABLE> a CROSS APPLY 
    (
        SELECT TOP 1 Price1
          FROM <YOUR-TABLE> b
        WHERE a.Date > b.Date
          AND Price1 <> 'NA'
            ORDER BY b.Date DESC
    ) b

    UPDATE a
  SET a.Price2 = b.Price2
  FROM <YOUR-TABLE> a CROSS APPLY 
    (
        SELECT TOP 1 Price2
          FROM <YOUR-TABLE> b
        WHERE a.Date > b.Date
          AND Price2 <> 'NA'
            ORDER BY b.Date DESC
    ) b 
```

# vb.net - 制作一个使其自身适应其中的文本的字符串

> ID：11543337
> 
> 赞同：0
> 
> 时间：2012-07-18T14:10:08.907
> 
> 标签：vb.net, string, math, equation

我正在编写一个程序来解决二年级方程（例如 2x²+2x+2），并且我试图让用户在单个文本框中输入整个方程。然后计算机将输入文本框中的内容存储在一个字符串中，然后解析该字符串以查找系数。对于像 2x²+2x+2 这样的方程，系数是 2、2 和 2，它们存储在字符串中的位置 0、4 和 7。最大的问题是，如果它是像 32x²+32x+45 这样更大的方程怎么办？还是 123x²+45x+6？在这种情况下，我的逻辑将不起作用。有谁知道该怎么做？

这是我的代码，仅适用于小方程：

```
Public Class Form1
    Dim i1 As Double
    Dim i2 As Double
    Dim i3 As Double
    Dim delta As Double
    Dim x1 As Double
    Dim x2 As Double
    Dim leters As String

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        i1 = T1.Text
        i2 = T2.Text
        i3 = T3.Text
        delta = (i2 * i2) - 4 * (i1 * i3)
        If (delta < 0) Then
            Ld.Text = delta
            L1.Text = "Impossível"
            L2.Text = "Impossível"
        Else
            x1 = (-i2 + Math.Sqrt(delta)) / (2 * i1)
            x2 = (-i2 - Math.Sqrt(delta)) / (2 * i1)
            Ld.Text = delta
            L1.Text = x1
            L2.Text = x2
        End If
    End Sub

    Private Sub RadioButton1_CheckedChanged(sender As System.Object, e As System.EventArgs) Handles RadioButton1.CheckedChanged
        GroupBox1.Text = "Equação"
        GroupBox1.Width = 200
        GroupBox1.Height = 58
        T1.Width = 188
        T3.Hide()
        T2.Hide()
        Label1.Hide()
        Button1.Hide()
        Button2.Show()
    End Sub

    Private Sub RadioButton2_CheckedChanged(sender As System.Object, e As System.EventArgs) Handles RadioButton2.CheckedChanged
        GroupBox1.Text = "Coeficientes"
        GroupBox1.Width = 200
        GroupBox1.Height = 143
        T1.Width = 119
        T3.Show()
        T2.Show()
        Label1.Show()
        Button1.Show()
        Button2.Hide()
    End Sub

    Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click
        leters = T1.Text
        leters.ToString()
    End Sub    
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:35:33.787

您可以使用 RegEx 来解析字符串，这很好，因为您可以将 RegEx 表达式更改为设置，而无需重新构建程序集。但是，如果方程字符串格式总是相同的，就像这里的情况一样（因为如果不是，其余的代码会失败），那么你可以简单地使用它`String.Split`来解析字符串。例如：

```
Dim equation As String = "32x²+32x+45"
Dim parts() As String = equation.Split(New Char() {"+"c, "x"c}, StringSplitOptions.RemoveEmptyEntries)
Dim coefficient1 As Integer = Integer.Parse(parts(0))
Dim coefficient2 As Integer = Integer.Parse(parts(2))
Dim coefficient3 As Integer = Integer.Parse(parts(3)) 
```

# java - BufferedWriter 写入文件

> ID：11543338
> 
> 赞同：0
> 
> 时间：2012-07-18T14:10:15.003
> 
> 标签：java, bufferedwriter

我正在使用 java 中的 BufferedReader 读取文件。这是我在读取文件时尝试执行的操作序列

1.  继续读取文件中一定长度的字符
2.  一旦读取到长度，对读取的字符串进行一些操作
3.  将读取的字符串写入临时文件
4.  重置所有计数器（例如长度计数器）
5.  返回 #1 并为其余文件再次执行此操作

我想弄清楚的是＃3。我想在使用 BufferedWriter 写入文件时附加到临时文件。我知道有 append() 但是，这看起来像是写入新行。但是，我想每次都写入下一个光标。基本上，我想保留原始文件的格式。制作一个完全相同的文件，除了一些值被更改。

我希望这是有道理的。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:16:03.177

您可以通过将 true 作为第二个参数传递给其构造函数来使用 FileWriter。这将导致 FileWriter 追加到文件的末尾，而不是覆盖现有的内容。

[http://docs.oracle.com/javase/6/docs/api/java/io/FileWriter.html](http://docs.oracle.com/javase/6/docs/api/java/io/FileWriter.html)

```
BufferedWriter writer = new BufferedWriter(new FileWriter(file, true));
//calls to write will now append 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:16:51.333

append() 可以正常工作。你甚至可以只做普通的 write()。如果你想用 BufferedWriter 写一个新行，你会这样做

```
BufferedWriter buff = new BufferedWriter();
buff.newLine(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:18:10.053

对于写作，你可以使用`PrintWriter`

```
java.io.PrintWriter pw = new PrintWriter(new FileWriter(file, true)); 
```

# vim - 跳到一长串重复模式的末尾

> ID：11543340
> 
> 赞同：4
> 
> 时间：2012-07-18T14:10:17.277
> 
> 标签：vim

我有一个大文件，其中有很多行共享相同的模式，如下所示：

```
dbn.py:206 ... (some other text)  <-- I am here
dbn.py:206 ... (some other text)
...
(something I don't know)          <-- I want to jump here 
```

Vim中是否有快速跳转到连续`dbp.py:206`结束的地方的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T14:47:26.463

`/``^\(dbn.py\)\@!`

匹配不以转义括号内的文本开头的第一行。

如果您想快速访问它，您可以添加一个`vmap`猛拉视觉选择的文本并将其插入到正确的位置（但首先使用`escape(var, '/')`.

试试这个 vmap：`vmap <leader>n "hy<Esc>/^\(<C-R>=escape(@h,'/')<CR>\)\@!<CR>`
在视觉上选择你想跳过的文本时按 n，你应该被放置在下一个不以选择开头的第一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T15:19:53.107

我只是写了一个函数来选择相同的行：

```
nnoremap vii :call SelectIdenticalLines()<CR>
fun! SelectIdenticalLines()
    let s = getline('.')
    let n = line('.')
    let i = n
    let j = n
    while getline(i)==s && i>0
        let i-=1
    endwhile

    while getline(j)==s && j<=line('$')
        let j+=1
    endwhile

    call cursor(i+1, 0)
    norm V
    call cursor(j-1, 0)
endfun 
```

* * *

*   键入`vii`以选择相同的行（随意更改键绑定）
*   键入`zf`折叠它们。
*   键入`za`以切换折叠

* * *

当你想挤几个空行时，它很方便。它的行为就像`C-x C-o`在 emacs 中一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:29:29.833

一种选择是转到文件底部并向后搜索所需的最后一行，然后向下搜索：

`G` `?^dbn\.py:206?+1`

# c - 使用 fscanf 从文件中读取字符串、整数等

> ID：11543341
> 
> 赞同：4
> 
> 时间：2012-07-18T14:10:18.650
> 
> 标签：c, string, integer, scanf

我希望您能帮助我了解我应该如何执行以下操作：

我有一个文件，其中包含由空格“”分隔的整数。我需要读取所有整数，对它们进行排序并将它们作为字符串写入另一个文件。我写了一个代码，但是我逐个字符地读取字符，把这个词放在一个 char sub_arr [Max_Int] 中，当我遇到''时，我把这些字符，现在是一个字符串，在将它放入另一个 Main int 数组之后，直到逐个字符串地到达文件末尾，然后我对它们进行排序和 itoa-ing 并将它们写入另一个文件。

但后来我记得有一个[fscanf](http://www.cplusplus.com/reference/clibrary/cstdio/fscanf/) 函数：我读过它，但我仍然不完全了解它的作用以及如何使用它。

就我而言，所有整数都用空格分隔，我可以写`fscanf(myFile,"%s",word)`吗？它会知道不考虑 ' ' 并在特定字符串的末尾停止吗？！如何？

不仅如此，我可以写`fscanf(myFile,"%d",number)`，它会给我下一个数字本身吗？（我一定是误会了。感觉​​像魔术）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T14:27:57.117

你是对的，`fscanf`可以给你下一个整数。但是，您需要为它提供一个指针。因此，您需要一个`&`后面的号码：

```
fscanf(myFile, "%d", &number); 
```

`*scanf`函数族也自动跳过空格（给定`%c`,`%[`或除外`%n`）。

读取文件的循环最终将如下所示：

```
while (you_have_space_in_your_array_or_whatever)
{
    int number;
    if (fscanf(myFile, "%d", &number) != 1)
        break;        // file finished or there was an error
    add_to_your_array(number);
} 
```

* * *

旁注：你可能会想到这样写：

```
while (!feof(myFile))
{
    int number;
    fscanf(myFile, "%d", &number);
    add_to_your_array(number);
} 
```

这虽然看起来不错，但**有一个问题**。如果您确实到达文件末尾，您将在测试文件末尾之前读取一个垃圾编号并添加到您的数据中。这就是为什么你应该使用`while`我首先提到的循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:20:21.397

以下行将完成您的工作，以下行将读取单个整数。

```
int number;
fscanf(myFile, " %d", &number); 
```

将它放在一个循环中直到文件结束，并将数字放入数组中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-18T14:25:52.957

尝试这个：

```
#include <stdio.h>

int main(int argc, char* argv[])
{
    char name[256];
    int age;
    /* create a text file */
    FILE *f = fopen("test.txt", "w");
    fprintf(f, "Josh 25 years old\n");
    fclose(f);

    /* now open it and read it */
    f = fopen("test.txt", "r");

    if (fscanf(f, "%s %d", name, &age) !=2)
        ; /* Couln't read name and age */
    printf("Name: %s, Age %d\n", name, age);

} 
```

# iphone - 如何创建类似于 Path 的 iOS 搜索？

> ID：11543343
> 
> 赞同：0
> 
> 时间：2012-07-18T14:10:38.527
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我正在寻找创建某种搜索视图控制器来搜索名称的表格视图。我想要的与 Path 应用程序中的实现非常相似。它开始看起来类似于 UISearchViewController，除了顶部的搜索栏不是标准栏： ![路径搜索](../Images/6c70f39d449eb88fe7dcce34ed10d07a.png)

然后，当您从搜索中选择一个名称时，它会出现在一个蓝色气泡中（如苹果的邮件应用程序），并为您提供添加更多人的选项，如下所示： ![多个名称](../Images/731781d1efa197c3c3d2ecad96bf2203.png)

有谁知道如何重新创建这种行为？我觉得这可能是 uikit 中的东西，因为他们在邮件应用程序中使用相同的蓝色气泡，但也许不是。

无论如何，我真的很感激知道这是如何完成的。

谢谢，

# c# - 在Jquery中关闭父窗口时关闭子窗口

> ID：11543352
> 
> 赞同：0
> 
> 时间：2012-07-18T14:11:07.737
> 
> 标签：c#, jquery, childwindow

我有一个窗口，单击按钮可以打开一个窗口。现在我希望在关闭父窗口时关闭子窗口。我为父窗口编写了卸载函数，但是我尝试访问子窗口的代码行引发了错误。

我的子窗口是使用后面代码中的这个脚本打开的：

```
"childWindow=window.open('MyPage.aspx,'ChildWindow','left=20, top=20, height=900, width=500,status= no, resizable= yes, scrollbars=yes, toolbar=no,location=no,menubar=yes'); childWindow.focus();" 
```

在我的父卸载功能中，我正在这样做：

```
$(window).unload(function () {
if ($(childWindow) != null)
    $(childWindow).close();}); 
```

我想这是我访问子窗口的方式有问题。但我不知道访问由脚本从后面的代码创建的子窗口的正确方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T16:43:41.443

您是否在页面 JavaScript 中将 childWindow 声明为全局变量？如果不是，它可能真的未定义到卸载代码。

# c#-4.0 - 实体框架代码优先：多级 TPC 继承与中间层的关系

> ID：11543353
> 
> 赞同：0
> 
> 时间：2012-07-18T14:11:08.537
> 
> 标签：c#-4.0, entity-framework-4.1, ef-code-first

我正在使用 TPC 继承将复杂对象模型映射到现有数据库。当我在继承结构的中间级别创建关系时遇到了问题。

```
public class ParentClass
{
}

public class MiddleClass : ParentClass
{
    public Int64 RelationshipId;
    public Relationship Relationship;
}

public class ChildClass1 : MiddleClass
{
}

public class ChildClass2: MiddleClass
{
}

public class Relationship
{
    public string RelationshipInfo { get; set; }
}

public class MyEntities : DbContext
{
    public DbSet<ParentClass> Parents
    public override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<ChildClass1>.Map(m => m.MapInheritedProperties);
        modelBuilder.Entity<ChildClass2>.Map(m => m.MapInheritedProperties);

        modelBuilder.Entity<MiddleClass>.HasRequired(mc => mc.Relationship).WithMany().HasForeignKey(mc => mc.RelationshipId);
    }
} 
```

在我添加该`modelBuilder.Entity<MiddleClass>.HasRequired(mc => mc.Relationship).WithMany().HasForeignKey(mc => mc.RelationshipId);`行之前，我的模型将一直有效。我必须将这种关系映射到每个孩子吗？

我收到的错误是*“无法按照定义映射“MiddleClass”类型，因为它映射了使用实体拆分或其他形式继承的类型的继承属性。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:37:30.130

我在[这里](https://stackoverflow.com/questions/8781707/entity-framework-code-first-tpc-inheritance-self-referensing-child-class)找到了答案（有点） 。基本答案是，由于任何继承的类都不表示为数据库中的表，因此您无法在这些表上创建关系。

即使尝试像这样通过父类映射继承的属性也行不通：

```
modelBuilder.Entity<ChildClass>()
            .HasRequired(cc => cc.Relationship).WithMany().HasForeignKey(cc => cc.RelationshipId); 
```

它知道关系对象仍然是中间类“表”的一部分，并尝试将其映射到那里。似乎唯一的行动是在子类中拥有所有关系对象。

```
public class ParentClass
{
}

public class MiddleClass : ParentClass
{
    public Int64 RelationshipId;
    public Relationship Relationship;
}

public class ChildClass1 : MiddleClass
{
    public Int64 RelationshipId;
    public Relationship Relationship;
}

public class ChildClass2: MiddleClass
{
    public Int64 RelationshipId;
    public Relationship Relationship;
}

public class Relationship
{
    public string RelationshipInfo { get; set; }
} 
```

这不是最好的解决方案，但您可能可以通过 EntityConfigurations 的继承结构进行映射。

# ios - 如何导入/链接共享 xCode 项目（并能够从任何客户端编辑共享项目）？

> ID：11543356
> 
> 赞同：-1
> 
> 时间：2012-07-18T14:11:27.967
> 
> 标签：ios, xcode, shared, workspace

我不想将共享项目编译为任何类型的库。我只想使用现有的类，就像它们是客户项目的组成部分一样。

我想从使用它的任何客户项目中编辑/开发/改进共享项目。

我已经通过谷歌运行，但找不到最简单/更方便的方法。

* * *

更简单：

我想要拖放共享代码项目，并且能够在任何地方进行编辑。如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:35:48.843

有两种选择：使用静态库，或将源文件直接包含在您的项目中。

如果您不想使用静态库（恕我直言，这是 iOS 的首选方法并与 Xcode 很好地集成），您可以添加对共享类的引用作为文件引用或文件夹引用。

无论哪种方式，构建工具链都会将所有内容链接到一个 Mach-O 二进制文件中，这是为 iOS 交付代码的唯一方法。

# javascript - 处理具有很长类别名称的 highcharts 条形图

> ID：11543357
> 
> 赞同：17
> 
> 时间：2012-07-18T14:11:31.213
> 
> 标签：javascript, graph, charts, highcharts

我有一个用 Highcharts 构建的条形图，它的 x 轴使用类别——非常长的罗嗦类别。 **我想不出一种确保类别始终保持在一条线上的好方法**。我不能缩写它们，除非我可以使用工具提示或其他东西在鼠标悬停或其他一些直观的用户交互时显示长版本。当类别换行时，它开始看起来像一堵文字墙。

**以干净的方式显示长类别和数据的任何想法**？我愿意考虑使用不同类型的图表，只要它以清晰美观的方式显示数据即可。我想坚持使用 Highcharts，但只有在可能的情况下。

**编辑**：经过努力，我放弃了以跨浏览器 (IE6+) 的方式将工具提示添加到 x 轴类别标签的想法。即使使用 JQuery，它似乎也不可能或不切实际。[我仍在寻找任何可以让我很好地显示这些长类别的解决方案（我对之前创建的小提琴](http://jsfiddle.net/a6zsn/67)不满意，因为悬停在数据栏上对用户来说不够明显）。

问题图的图片，**类别被涂黑：** ![标签太长，转到下一行](../Images/e93b122c8d35db555552cb9bc08c8065.png)

JSFiddle 代码：

HTML：

```
<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
<div id='mytoolTip'></div> 
```

Javascript：

```
$(function() {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'bar'
            },
            title: {
                text: 'Historic World Population by Region'
            },
            subtitle: {
                text: 'Source: Wikipedia.org'
            },
            xAxis: {
                categories: ['Africa blahblahblah blah blah blah ', 'America blahblahblah blah blah blah ', 'Asia blahblahblah blah blah blah', 'Europe blahblahblah blah blah blah ', 'Oceania blahblahblah blah blah blah '],
                    title: {
                        text: null
                    },
                    labels: {
                        formatter: function() {
                            return(this.value.substring(0,10) + "...");
                        }
                    }                            
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: 'Population (millions)',
                        align: 'high'
                    },
                    labels: {
                        overflow: 'justify'
                    }
                },
                tooltip: {
                    formatter: function() { 
                       $("#mytoolTip").html(this.x + 'and the value is ' + this.y) ; 
                       return false ; 
                    }
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            enabled: true
                        }
                    }
                },
                legend: {
                    layout: 'vertical',
                    align: 'right',
                    verticalAlign: 'top',
                    x: -100,
                    y: 100,
                    floating: true,
                    borderWidth: 1,
                    backgroundColor: '#FFFFFF',
                    shadow: true
                },
                credits: {
                    enabled: false
                },
                series: [{
                    name: 'Year 1800',
                    data: [107, 31, 635, 203, 2]
                }, {
                    name: 'Year 1900',
                    data: [133, 156, 947, 408, 6]
                }, {
                    name: 'Year 2008',
                    data: [973, 914, 4054, 732, 34]
                }]
            });
        });
    }); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-24T03:24:28.913

**试试这个小提琴：http:** [//jsfiddle.net/a6zsn/70/](http://jsfiddle.net/a6zsn/70/)

我们有一个类似的问题，我们最终通过允许标签使用 HTML 解决了这个问题。虽然我们没有采用下面发布的确切解决方案，但这应该对您有用，因为它使用 jQueryUI 工具提示小部件在悬停时显示全文。

请注意我是如何定义 xAxis.labels 对象的。

```
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'bar',
                events: {
                    load: function (event) {
                        $('.js-ellipse').tooltip();
                    }
                }
            },
            title: {
                text: 'Historic World Population by Region'
            },
            subtitle: {
                text: 'Source: Wikipedia.org'
            },
            xAxis: {
                categories: ['Africa is the best place to do safari.  Label is soooo big that it iss ugly now.  =(.  -38023-8412-4812-4812-403-8523-52309583409853409530495340985 ', 'America is the best place you can ever live in ', 'Asia is the best food ever ', 'Europe best chicks ever on earth ', 'Oceania i dont know any thing about this place '],
                title: {
                    text: null
                },
                labels: {
                    formatter: function () {
                        var text = this.value,
                            formatted = text.length > 25 ? text.substring(0, 25) + '...' : text;

                        return '<div class="js-ellipse" style="width:150px; overflow:hidden" title="' + text + '">' + formatted + '</div>';
                    },
                    style: {
                        width: '150px'
                    },
                    useHTML: true
            }
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Population (millions)',
                    align: 'high'
                },
                labels: {
                    overflow: 'justify'
                }
            },
            tooltip: {
                formatter: function() {
                   $("#mytoolTip").html(this.x + 'and the value is ' + this.y) ; 
                    return false ;
                }
            },
            plotOptions: {
                bar: {
                    dataLabels: {
                        enabled: true
                    }
                }
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'top',
                x: -100,
                y: 100,
                floating: true,
                borderWidth: 1,
                backgroundColor: '#FFFFFF',
                shadow: true
            },
            credits: {
                enabled: false
            },
            series: [{
                name: 'Year 1800',
                data: [107, 31, 635, 203, 2]
            }, {
                name: 'Year 1900',
                data: [133, 156, 947, 408, 6]
            }, {
                name: 'Year 2008',
                data: [973, 914, 4054, 732, 34]
            }]
        });
    });

}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-18T14:41:06.503

*工作* [的jsFiddle](http://jsfiddle.net/a6zsn/)

移动工具提示：

HTML

```
 <div id='mytoolTip'></div>​ 
```

JavaScript

```
 tooltip: {
            formatter: function() {

               $("#mytoolTip").html(this.x + 'and the value is ' + this.y) ; 
                return false ; 
            }
        }, 
```

这是您如何从工具提示悬停中获取类别名称的方法

```
 this.key 
```

[jsFiddle](http://jsfiddle.net/a6zsn/5/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-02T09:55:31.367

修剪标签

```
xAxis: {
            categories: ['Foo afkhbakfbakjfbakfbnbafnbaf', 'Bar', 'Foobar'],
            labels: {
                formatter: function() {
                    return this.value.substring(0, 8);
                }
            }
        }, 
```

# asp.net - 单击 MVC 中图像中的链接

> ID：11543364
> 
> 赞同：1
> 
> 时间：2012-07-18T14:12:02.737
> 
> 标签：asp.net, css, asp.net-mvc, asp.net-mvc-2

Orginally 我有在 MVC 2 中查看的链接。

```
 <div id="sidebar">
              <li> <%=Html.ActionLink("View1", "View1", "Home") %></li> 
              <li> <%=Html.ActionLink("View2", "View2", "Home") %></li>
              <li> <%=Html.ActionLink("View3", "View3", "Home") %></li>
      </div> 
```

Web 表单中有 ImageMap 控件，您可以在其中单击不同的链接到不同的页面。现在我要用图像替换 MVC 中的列表。通过单击不同的位置，我们可以转到不同的视图。我只是想知道MVC中是否有类似的ImageMap？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:14:59.180

MVC 没有内置的解决方案。

但你可以看看这个：[http ://forums.asp.net/t/1644834.aspx/1?How+to+create+img+map+area+in+MVC+2](http://forums.asp.net/t/1644834.aspx/1?How+to+create+img+map+area+in+MVC+2)

# c# - GDI+ 图像比 C# 图像快得多

> ID：11543372
> 
> 赞同：2
> 
> 时间：2012-07-18T14:12:32.927
> 
> 标签：c#, c++, .net, gdi+, benchmarking

我决定在 C# 和 C++ 中对读取图像进行基准测试，以决定在我正在考虑为自己制作的项目中使用哪种语言。
我预计基准测试将与 C++ 非常接近，可能会稍微向前推进。

C# 代码每次运行大约需要 300 毫秒（我每个测试运行 100 次），而 C++ 代码大约需要 1.5 毫秒。

那么我的 C# 代码错了吗？我是否对它进行了糟糕的基准测试？还是真的就这么慢？

这是我使用的 c# 代码：

```
Stopwatch watch = new Stopwatch();

watch.Start();
Image image = Image.FromFile(imagePath);
watch.Stop();

Console.WriteLine("DEBUG: {0}", watch.ElapsedMilliseconds); 
```

C ++代码几乎可以归结为：

```
QueryPerformanceCounter(&start);
Image * img = Image::FromFile(imagePath);
QueryPerformanceCounter(&stop);
delete img;
return (stop.QuadPart - start.QuadPart) * 1000.0 / freq.QuadPart; 
```

无论哪种语言，它们都需要以 Image 对象结尾，因为它提供了我需要的功能。

**==================================================== ======================**

正如 xanatos 在评论中指出的那样， Image.FromFile 确实进行了检查。

更具体地说，这是：

```
num = SafeNativeMethods.Gdip.GdipImageForceValidation(new HandleRef(null, zero));
if (num != 0)
{
    SafeNativeMethods.Gdip.GdipDisposeImage(new HandleRef(null, zero));
    throw SafeNativeMethods.Gdip.StatusException(num);
} 
```

改用 Image.FromStream() 可以避免这种情况。

我想知道的是，如果您确实避免这种情况并尝试加载无效的图像文件，则会引发 OutOfMemory 异常。
而在 C++ 中，您不会进行这样的检查。那么这个检查有多重要呢？谁能给我一个避免这种情况不好的情况？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T17:56:38.413

是的，你的基准是有缺陷的。问题是您忘记对位图进行实际*操作。*喜欢画它。

GDI+ 极大地优化了图像的加载。非常类似于 .NET 优化加载程序集的方式。它只做必要的事情，它读取文件的标题以检索基本属性。格式、宽度、高度、Dpi。然后它创建一个内存映射文件以创建到文件中像素数据的映射。但实际上并没有*读取*像素数据。

现在差异开始发挥作用。System.Drawing.Image 接下来实际读取像素数据。这会导致页面错误，操作系统现在读取文件并将像素数据复制到 RAM 中。非常可取的是，如果文件有任何问题，那么您将在 FromFile() 调用时收到异常，而不是稍后，通常是当您的程序绘制图像并埋在您没有编写的框架代码中时。您的 C# 代码基准乘以 mmf 的创建*加上*像素数据的读取。

C++ 程序也总是需要为读取像素数据付费。但是您没有衡量这一点，您只衡量了创建 MMF 的成本。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2014-03-12T08:29:03.713

我知道的几点

有一种东西叫做CLR。如果上述c++框架（好像是Qt）使用了不依赖.net框架的系统调用，那么显然它会运行得很快。

关于 c# => 可以在代码中调用它之前加载该程序集。如果你这样做，那么你会发现它的牢度很好。

如果你使用windows平台，那么除非有必要，否则MS不会降低自己语言的执行速度。

# python - 如何使用 django-tastypie 为继承另一个模型的模型创建模型资源？

> ID：11543375
> 
> 赞同：0
> 
> 时间：2012-07-18T14:12:41.823
> 
> 标签：python, django, tastypie

我的 Django 模型看起来像：

```
class Session(models.Model):
    ...

class Document(models.Model):
    session = models.ForeignKey(Session)
    date_created = models.DateTimeField(auto_now_add=True)

    class Meta:
        abstract = True

class Invoice(Document):
    number = models.PositiveIntegerField()
    # and some other fields

class SupplyRequest(Document):
    # fields here 
```

这样，每个`Invoice`和`SupplyRequest`实例都链接到一个`Session`并具有一个`date_created`属性。好的。所以，我创建了一个`ModelResource`for`Session`和 for `Invoice`，想象 Tastypie 可以透明地遍历`Document`模型字段。但不起作用：

```
class SessionResource(ModelResource):

    class Meta:
        queryset = Session.objects.all()
        ...

class InvoiceResource(ModelResource):

    session = fields.ForeignKey(SessionResource, 'session')

    class Meta:
        queryset = Invoice.objects.all()
        ... 
```

当我尝试序列化发票时，我收到以下错误消息：

```
NoReverseMatch: Reverse for 'api_dispatch_detail' with arguments '()' and keyword arguments '{'pk': 1, 'resource_name': 'session'}' not found. 
```

有没有办法使用 Tastypie 处理模型继承？

我忘了提到`Document`模型是一个抽象类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:24:41.863

我想你一定忘记设置 url SessionResource。

```
from tastypie.api import Api

api = Api()

api.register(SessionResource())

urlpatterns += patterns('',
    (r'^api/', include(api.urls)),
) 
```

您在 urls.py 中执行此操作？

拥抱。

# c# - 排序分数和带分数的列表

> ID：11543376
> 
> 赞同：2
> 
> 时间：2012-07-18T14:12:45.183
> 
> 标签：c#, sql, sql-server, sql-server-2008, fractions

我正在寻找一种方法，可以让我有一个列，我只需手动输入一个数字，然后列表将根据该列表对自身进行排序，这将使用 c# 作为列表的语言，它是 ms SQL

我没有太多信息，但是如果有人想知道其他任何事情，请随时询问，我会尽力回答。

它们当前存储为字符串。

导致它被抛出的原因是因为一些列表包含范围但一些包含分数，两者都显示相同的 IE 1/2 可能意味着 1-2 或 1/2(half)

所有的 SQL 连接都是使用 NHibernate 完成的。

不简单地对其进行正常排序的原因是，列表目前使用分数排序并且列表工作正常，但是当它超过 1 时，它似乎会中断并将它们全部扔到列表 IE 的底部：

![图像列表](../Images/66a7f963ab55cc1a4ca1cfd9aaf0c869.png)

我希望它如何工作的示例：

我会在我的数据库中有一个名为“DisplayOrder”的列或类似的东西。

数据库行显示“1”，这将是列表中出现的第一项。数据库行显示“8”，这将是列表中出现的第 8 个项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:19:48.370

排序结果似乎完全正常，因为我真的认为数据库不理解“1 1/4”的含义。哪种类型有你的数据库字段？我猜是文本/varchar/字符串？

也许您应该创建一个存储过程来将小数值转换为数字，然后调用

```
SELECT field1, field2, ParseAndConvertProc(DisplayOrder) as disp_order ORDER by disp_order 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T18:25:00.637

我整理了一个快速函数来解析你的分数并将它们转换为浮点数，然后可以用于比较和排序。您可能需要在“清理”步骤中进行更多操作，可能需要规范化空格、删除其他字符等，并且可能必须检查除数是否为零（只有您知道您的数据）。

```
create function dbo.FractionToFloat(@fraction varchar(100))
returns float
as
begin
    declare @input varchar(100)
        , @output float
        , @whole int
        , @dividend int
        , @divisor int

    -- Sanitize input
    select @input = ltrim(rtrim(replace(replace(@fraction, '''', ''), '"', '')))

    select @whole = cast(case
        when charindex('/', @input) = 0 then @input
        when charindex(' ', @input) = 0 then '0'
        else left(@input, charindex(' ', @input) - 1)
        end as int)

    select @dividend = cast(case
        when charindex('/', @input) = 0 then '0'
        when charindex(' ', @input) = 0 then left(@input, charindex('/', @input) - 1)
        else substring(@input, charindex(' ', @input) + 1, charindex('/', @input) - charindex(' ', @input) - 1)
        end as int)

    select @divisor = cast(case
        when charindex('/', @input) = 0 then '1'
        else right(@input, charindex('/', reverse(@input)) - 1)
        end as int)

    select @output = cast(@whole as float) + (cast(@dividend as float) / cast(@divisor as float))

    return @output
end 
```

这样，您可以简单地按函数的输出排序，如下所示：

```
select *
from MyTable
order by dbo.FractionToFloat(MyFractionColumn) 
```

我通常不建议滚动你自己的解析器，你必须在数据变化时维护它，但这从表面上看似乎很简单，并且可能比手动维护序数列更好。此外，如果您必须比较各种单位（英尺到英寸，分钟到秒），那么这会变得更加复杂。我正在删除您演示数据中看起来像一个单元的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T21:06:12.547

暂时忽略这`1/2`可能意味着`between 1 and 2`，您可以处理疯狂并尝试从中获得一些秩序。

```
CREATE TABLE #Fractions (
   Frac varchar(15)
);

INSERT #Fractions VALUES
   ('1 1/2'), ('1 1/4'), ('1"'), ('1/2'), ('1/4'), ('1/8'),
   ('2 1/2'), ('2"'), ('3"'), ('3/4'), ('3/8'), ('4"');

WITH Canonical AS (
   SELECT
      Frac,
      F,
      CharIndex(' ', F) S,
      CharIndex('/', F) D
   FROM
      (SELECT Frac, Replace(Frac, '"', '') F FROM #Fractions) F
   WHERE
      F NOT LIKE '%[^0-9 /]%'
), Parts AS (
   SELECT
      Frac,
      Convert(int, Left(F, CASE WHEN D = 0 THEN Len(F) ELSE S END)) W,
      Convert(int, CASE WHEN D > 0 THEN Substring(F, S + 1, D - S - 1) ELSE '' END) N,
      Convert(int, CASE WHEN D > 0 THEN Substring(F, D + 1, 2147483647) ELSE '1' END) D
   FROM Canonical
)
SELECT
   Frac,
   W + N * 1.0 / D Calc
FROM Parts
ORDER BY Calc;

DROP TABLE #Fractions; 
```

但我不推荐这个。使用我的查询作为基础来获得正确的值，并切换到使用十进制值。

请注意，您还必须在数据中搜索此代码未考虑的字符，使用上面的模式匹配与 LIKE 而不是 NOT LIKE。然后删除它们或以某种方式解释它们。

如果你说的是真的，这`1/2`可能意味着两件事，并且你能分辨出它们之间的区别，那么你可以做点什么。将范围存储在两列中。如果它们相同，则没有范围。

如果您无法区分这两种含义之间的区别，那么您只是一团糟，还不如辞掉工作去阿拉斯加赛雪橇犬。

# css - 我什么时候需要 *-device-width？

> ID：11543378
> 
> 赞同：0
> 
> 时间：2012-07-18T14:12:59.353
> 
> 标签：css, media-queries

我正在为桌面和移动设备创建响应式 Web 应用程序。我的问题是我不知道什么时候需要使用`*-device-width`. 请解释用例`*-device-width`。为什么我应该使用它而不是`*-width`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:21:04.407

您将它与元标记一起使用，您将添加到您的头部标记中

```
<meta name="viewport" content="width=device-width" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T15:53:55.673

来自[CSS 媒体查询中宽度和设备宽度之间的差异](https://stackoverflow.com/a/5716208?difference-between-width-and-device-width-in-css-media-queries)：

> `device-width`是个...
> 
> > 输出设备的宽度（指整个屏幕或页面，而不仅仅是呈现区域，例如文档窗口）。
> 
> [来源](https://developer.mozilla.org/en/CSS/Media_queries#device-width)。
> 
> `width`... _
> 
> > 描述输出设备的渲染表面的宽度（例如文档窗口的宽度，或打印机上的页面框的宽度）
> 
> [来源](https://developer.mozilla.org/en/CSS/Media_queries#width)。

# continuous-integration - 成功构建 CI 后实时构建 Teamcity？

> ID：11543380
> 
> 赞同：0
> 
> 时间：2012-07-18T14:13:00.630
> 
> 标签：continuous-integration, teamcity

我有一个环境构建系统，目前具有以下环境：

*   开发者
*   词
*   uat
*   居住

当我说环境构建时要清楚，我的意思是每个环境都有一组属性文件，并且在构建期间这些属性用于模板项目文件，因此数据库服务器可能是开发环境中的“localhost”，但“12.34\. 56.78" 在 CI 上。因此，在开始构建时，您可以给它一个 environment 属性，它将为 dev 以外的东西（这是默认环境）构建。

现在 CI 构建工作正常并正确吐出工件，但是由于构建是 CI，所有它都被配置为在该环境中工作，我正在寻找能够在 CI 构建成功时触发 live 或 uat 构建. 这将运行相同的构建，但使用不同的构建参数。

现在我注意到有一些机制可以解决这个问题，一个似乎是在完成时自动触发，这可能会触发另一个构建，但这似乎需要 2 个单独的构建配置，除了构建参数是“environment=live”之外，它们基本上是相同的" 而不是 "environment=ci"。然后添加另一个构建步骤，它与第一个步骤相同，但采用不同的参数并将实时工件输出到其他地方，但这总是会像第一个选项一样发生。

*我可以看到的最后一个选项是在我有一个实时候选人*后触发手动构建，但目前还不清楚如何设置构建参数，我可以制作一个构建参数，但它似乎没有被拉入构建像构建参数这样的命令的脚本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T16:14:04.317

我会看看是否有更好的答案，但是在写完这篇文章后，我发现使用构建参数似乎是最好的选择，然后可以使用 %environment%（或 %your_parameter_here%）将其嵌入到您的构建配置中的任何位置。

然后可以设置为手动构建创建表单元素，以便您可以轻松地为不同环境创建构建。

# c# - 从 NHibernate 2 更新到 3.3.1 后，为什么我不能调用 BuildSessionFactory？

> ID：11543386
> 
> 赞同：1
> 
> 时间：2012-07-18T14:13:12.333
> 
> 标签：c#, nhibernate, notsupportedexception

今天我将我的项目更新到 NHibernate 3.3 并替换了 NHibernate 和 Iesi.Collections 参考。

我保留了 NHibernate.ByteCode.Castle 我 `<property name="proxyfactory.factory_class">NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle</property>`从我的应用程序配置中删除了该行。现在我在以下代码的最后一行收到错误 NotSupportedException：

```
NHibernate.Cfg.Configuration cfg = new NHibernate.Cfg.Configuration();
cfg.AddAssembly(Assembly.GetExecutingAssembly());
sessionFactory = cfg.BuildSessionFactory(); 
```

我用谷歌搜索了很多，但我不知道出了什么问题。和想法？谢谢！

我的配置：

```
 <hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
<session-factory>
  <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
  <property name="dialect">NHibernate.Dialect.PostgreSQLDialect</property>
  <property name="connection.driver_class">NHibernate.Driver.NpgsqlDriver</property>
  <property name="connection.connection_string">Server=myserverip;Port=myport;database=my_test;User Id=my_user;Password=mypwd;CommandTimeout=1;</property>
  <!--<property name="proxyfactory.factory_class">NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle</property>-->
  <property name="command_timeout">0</property>
</session-factory> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T11:54:08.960

只需将此行添加到您的 xml 配置中

```
<property name="hbm2ddl.keywords">none</property> 
```

此处描述的更多详细信息： [C#/Postgres/FluentNHibernate：配置 npgsql 抛出 NotSupportedException](https://stackoverflow.com/questions/5532236/c-sharp-postgres-fluentnhibernate-configuring-npgsql-throws-notsupportedex)

# c# - 通过代理从 Web 服务保护数据库访问？

> ID：11543387
> 
> 赞同：1
> 
> 时间：2012-07-18T14:13:13.873
> 
> 标签：c#, wcf, security, iis, database-connection

我们正在脱离我们典型的原生应用程序开发，正在开发一些新的基于 Web 的应用程序服务。我们正在使用 .Net 和 WCF，并且很可能托管在 IIS 上。

我们的服务需要使用数据库来持久化数据。在所有情况下，我们都打算使数据库服务器与我们的主机不同。我们发现的大多数资源似乎表明将数据库连接字符串存储在 web.config（或用于自托管的 app.config 文件）中。我们担心的是，由于该服务是面向网络的，因此它运行的盒子更有可能被黑客入侵/妥协。如果发生这种情况，攻击者现在拥有了数据库连接字符串，并且可以完全访问所有数据。

最初的想法是让 WCF 服务简单地代理到位于另一台机器上的服务器应用程序，该机器保存连接信息并执行所有处理逻辑。这样，如果网络主机被入侵，他们将不得不弄清楚如何与我们的服务器应用程序通信，或者也破坏该机器，以获得数据库访问权限。尽管我们确实担心代理的性能成本，并且可能会在服务器应用程序中遇到瓶颈。

与这种方法有关的问题是，我们在 WCF/IIS 文献中没有找到太多推荐这种方法的方式，但我们可能只是不知道为了找到此类信息而调用什么。问题：这样的代理是一种好的做法吗？为什么/（为什么不）（或者我在哪里可以找到关于这个主题的更多信息），还是有更好的做法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:18:30.490

与这些东西一样，这一切都取决于您需要的东西有多安全。您可以加密您的 web.config：

[http://msdn.microsoft.com/en-us/library/dtkwfdky.aspx](http://msdn.microsoft.com/en-us/library/dtkwfdky.aspx)

但是您必须问，如果您的攻击者有能力破坏您的网络主机，他们将能够找到您的另一台服务器，然后也可能有能力破坏它 - 不是 100% 确定这里的净收益是多少（除了让你的生活更困难）。

# xcode - NSNotification EXC_BAD_ACCESS

> ID：11543388
> 
> 赞同：5
> 
> 时间：2012-07-18T14:13:15.827
> 
> 标签：xcode, exc-bad-access, nsnotificationcenter

这是我得到的错误

```
Thread 1:EXC_BAD_ACCESS (code=2, address=0xb7ffffc) 
```

在这条线上

```
[[NSNotificationCenter defaultCenter] postNotificationName:AsyncImageLoadDidFinish
                                                        object:target
                                                      userInfo:[[userInfo copy] autorelease]]; 
```

在 AsyncImageView.m 文件中。

该错误会停止代码，但如果我继续使用调试器，它会冻结 Xcode 并将其关闭。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-18T14:35:20.910

在 init 中你需要注册，而在 dealloc 中你需要取消注册！

```
-(void)dealloc
{
    [[NSNotificationCenter defaultCenter] removeObserver:self name:AsyncImageLoadDidFinish  object:nil]; 
```

或者

```
- (void)dealloc
{
    [[NSNotificationCenter defaultCenter] removeObserver:self];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-18T14:30:13.833

试试下面的代码，应该没问题：

```
NSDictionary * userInfo = [NSDictionary dictionaryWithObjectsAndKeys:..., nil];
[[NSNotificationCenter defaultCenter] postNotificationName:AsyncImageLoadDidFinish
                                                    object:target
                                                  userInfo:userInfo]; 
```

或者：

```
NSDictionary * userInfo = [[NSDictionary alloc] initWithObjectsAndKeys:..., nil];
[[NSNotificationCenter defaultCenter] postNotificationName:AsyncImageLoadDidFinish
                                                    object:target
                                                  userInfo:userInfo];
[userInfo release]; 
```

# javascript - 使用 google.maps.Symbol 类型的图标创建标记有时会出现错误“属性值无效 "

> ID：11543389
> 
> 赞同：1
> 
> 时间：2012-07-18T14:13:15.377
> 
> 标签：javascript, google-maps, gwt, google-maps-api-3

在尝试使用 Maps API 3.9 中的矢量图标时，我注意到一些奇怪的行为，如下所述：[https ://developers.google.com/maps/documentation/javascript/overlays#VectorIcons](https://developers.google.com/maps/documentation/javascript/overlays#VectorIcons)

我创建了一个带有运行良好的矢量图标的测试页面（ [http://www.foxden.nl/test/symboltest1.html ）。](http://www.foxden.nl/test/symboltest1.html)

然而，在第二次测试中（http://www.foxden.nl/test/symboltest2.html）我放弃了绘制标记的脚本。然后，当我使用 Firefox 的 Web 控制台添加标记时，我得到以下信息：

```
[16:03:18.483]     var marker = new google.maps.Marker({
                     position: new google.maps.LatLng(-25.363882, 131.044922),
                     icon: {
                       path: google.maps.SymbolPath.CIRCLE,
                       scale: 10
                     },
                     draggable: true,
                     map: map
                     });
[16:03:18.486] Error: Invalid value for property <icon>: [object Object] 
```

它在 Chrome 的 web 控制台中运行良好，但在 Firefox 的控制台中却不行。这是完全相同的代码。

在 GWT 应用程序中，我得到相同的行为。我有这个功能：

```
private native void createMarker(GoogleMap map, LatLng position) /*-{
    var marker = new $wnd.google.maps.Marker({
        position: position,
        icon: {
            path: $wnd.google.maps.SymbolPath.CIRCLE,
            scale: 10
        },
        map: map
    });
}-*/; 
```

这给了我同样的错误：

```
com.google.gwt.core.client.JavaScriptException: (Error): Invalid value for property <icon>: [object Object] 
```

为什么会发生这种情况，有什么办法可以避免这个问题？

# editor - 如何更改 Sublime Text 2 选定的选项卡颜色

> ID：11543393
> 
> 赞同：35
> 
> 时间：2012-07-18T14:13:28.920
> 
> 标签：editor, text-editor, sublimetext2

我非常喜欢 Sublime Text 2 默认配色方案**Monokai**。唯一的问题是选项卡颜色、所选选项卡和其余选项卡看起来都相同（几乎）。如何仅更改此主题的选定选项卡颜色。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-11-14T14:16:04.133

这是我找到的最佳解决方案： [https ://coderwall.com/p/jg4kog](https://coderwall.com/p/jg4kog)

1.  在 Sublime Text 中转到 Preferences > Browse packages

2.  导航到用户文件夹。

3.  在那里你**创建了一个**名为**Default.sublime-theme的文件**

4.  在 Sublime Text 中打开该文件并复制并粘贴以下 JSON 对象：

.

```
[
   {"class": "tab_control", "attributes": ["selected", "file_medium_dark"],"tint_modifier":[255, 255, 255, 80]}
] 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-07-19T11:26:08.917

您需要深入研究主题自定义才能做到这一点：

由于您的主题是 Monokai (medium-dark)，请转到**“Packages/Theme - Default/Default.sublime-theme”**

从第**528**行到第**531**行是您的答案...

您可以通过更改**tint_modifier**或**layer2.opacity来***破解*

 ****或者

例如，您可以直接在“medium_dark_unselected_tab_bg2.png”处进行更改，然后尝试将其更改为“light_unselected_tab_bg2.png”。

无论哪种方式，我都建议您使用[苏打主题](https://github.com/buymeasoda/soda-theme/)！一个非常棒且易于配置的主题！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-12T11:00:23.487

对于我的 Monokai 主题，我做了：

```
vim ~/.config/sublime-text-2/Packages/Theme\ -\ Default/Default.sublime-theme +609 
```

这会将您带到第 609 行，然后更改：

```
"fg": [55, 255, 55, 230] 
```

现在 fg 颜色将变为绿色。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-04T13:51:52.237

要更改选定选项卡标题颜色，请编辑：

`Packages/Theme - Default/Default.sublime-theme`（如罗曼所说）

然后搜索评论*选项卡标签*并将包含从 255、255、255的*类*`fg`的属性更改为您的新颜色（255、0,0 为红色）。*`selected`*

 ** * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-12T03:10:07.483

如果您更改活动选项卡标题的颜色 - 那么您将失去该主题的逻辑（选项卡标题和正文具有相同的颜色并且看起来像单个对象）

最好的方法是更改​​非活动选项卡标题的颜色，而不是更改活动选项卡标题的颜色，只需将`"layer0.texture"`Default.sublime-theme 中的值更改为白色选项卡标题背景 .png 文件：

```
/** Tabs **/
{
    "class": "tab_control",

    "layer0.texture": "Theme - Default/tab_mask_white.png",
    "layer0.inner_margin": [22, 4],
    "layer0.opacity": 1.0,
    "tint_index": 0,        // tint layer 0
    "tint_modifier": [255, 0, 0, 0],

    "layer1.texture": "",
    "layer1.inner_margin": [22, 4],
    "layer1.opacity": 0.0,

    "layer2.inner_margin": [22, 4],

    "content_margin": [24, 8, 23, 4],
    "max_margin_trim": 6,
    "hit_test_level": 0.4
}, 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-10T09:22:22.207

找出您正在使用的主题（Preferences > Color scheme）然后通过（Preferences > Browse packages > 然后主题命名文件夹）打开文件夹，否则在默认文件夹中查找....

找到以下文件，并在paint中编辑它们！保存后它会立即显示在 Sublime 中。

```
tab-active.png
tab-inactive.png 
```

我在顶部添加了一条浅蓝色条纹，它很有帮助........

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-13T20:39:25.200

对于 Sublime Text 3 用户：从官方的 Sublime Text 官方 3.0 更新开始，这只是一点点改变。

除了[这个 Sublime Text Forum Post](https://forum.sublimetext.com/t/highlight-modified-tabs-build-3143/31303/10 "崇高文本论坛")的一些帮助之外，这个 SO 帖子让我将此代码片段添加到**“Packages/Theme - Default/Default.sublime-theme”**或**“Packages/User/Default.sublime-theme”**

```
 {
        "class": "tab_control", 
        "attributes": ["selected"],
        "tint_modifier": [0, 255, 0, 40], //RGBA value - makes my selected tab a deep green
        "layer1.opacity": 1.0,
    }, 
```

[在这里](http://www.sublimetext.com/docs/3/themes.html "崇高的文档")，您可以找到有关主题的 Sublime Text 3 文档站点的更多详细信息*****

# php - MySQL更新不更新所有行（使用php）

> ID：11543394
> 
> 赞同：-1
> 
> 时间：2012-07-18T14:13:31.387
> 
> 标签：php, mysql

我正在尝试更新我的值，但发生了一些奇怪的事情，MySQL 似乎是出于自己的自由意志更新行。这是我所做的

```
UPDATE accountsTable SET Status = 'TerminatedProfile' WHERE id IN (1,2,3) 
```

即使我多次运行代码，它也会更新一或两行而不是全部 3。如果我接受这个查询并通过 phpmyadmin 运行它，它工作正常。php的mysql实现有问题还是什么？

我在用

```
mysql_connect("$host", "$user", "$password")or die("cannot connect"); 
mysql_select_db("$db")or die("cannot select DB"); 
mysql_query($query2); 
```

更新：我在 Joomla 上运行它，也许它与会话有关，因为我试图更新的行之一是我登录的管理员用户。特别感谢 MikeB 的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:48:01.237

如果没有完整的代码或者 $query2 被应用在哪里，很难知道发生了什么。

但是您可以尝试不使用列表来更新这些行。尝试：

```
UPDATE accountsTable SET Status = 'TerminatedProfile' WHERE id = 1 AND id = 2 AND id = 3 
```

这只是为了确保问题出在 $query2 的位置。

您也可以尝试在 mysql 控制台上直接运行此查询，看看会发生什么。如果可行，则错误可能在于您的操作方式。

# wpf - 更改选项卡时，RadioButton IsChecked 属性被覆盖

> ID：11543396
> 
> 赞同：4
> 
> 时间：2012-07-18T14:13:40.997
> 
> 标签：wpf, radio-button, tabcontrol

我确定这种行为是已知的，但我无法用谷歌搜索它。我有以下代码：

```
<Window x:Class="ContentControlListDataTemplateKacke.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <DockPanel>
        <TabControl ItemsSource="{Binding Items}">
            <TabControl.ContentTemplate>
                <DataTemplate>
                    <StackPanel>
                        <Label Content="{Binding Name}" />
                        <RadioButton Content="Option1" IsChecked="{Binding Option1}" />
                        <RadioButton Content="Option2" IsChecked="{Binding Option2}" />
                    </StackPanel>
                </DataTemplate>
            </TabControl.ContentTemplate>
        </TabControl>
    </DockPanel>
</Window> 
```

代码隐藏很简单：

```
public partial class MainWindow
{
    public MainWindow()
    {
        InitializeComponent();
        DataContext = new ViewModel();
    }
} 
```

ViewModel 看起来像这样：

```
public class ViewModel : NotificationObject
{
    public ViewModel()
    {
        Items = new ObservableCollection<Item>
        {
            new Item {Name = "1", Option1 = true},
            new Item {Name = "2", Option2 = true}
        };
    }

    public ObservableCollection<Item> Items { get; set; }
} 
```

和这样的项目：

```
public class Item : NotificationObject
{
    public string Name { get; set; }

    private bool _option1;
    public bool Option1
    {
        get { return _option1; }
        set
        {
            _option1 = value;
            RaisePropertyChanged(() => Option1);
        }
    }

    private bool _option2;
    public bool Option2
    {
        get { return _option2; }
        set
        {
            _option2 = value;
            RaisePropertyChanged(() => Option2);
        }
    }
} 
```

我正在使用 Prism，因此 RaisePropertyChanged 会引发 PropertyChanged 事件。选择第二个选项卡，然后是第一个选项卡，然后再次选择第二个选项卡，瞧，第二个选项卡上的 RadioButtons 被取消选择。

为什么？

## 除了 Rachels 之外的另一种解决方案

我的一位同事刚刚想到将 RadioButtons 的 GroupName 属性绑定到每个项目的唯一字符串。只需将 RadioButtons 的声明更改为：

```
<RadioButton GroupName="{Binding Name}" Content="Option1" IsChecked="{Binding Option1}" />
<RadioButton GroupName="{Binding Name}" Content="Option2" IsChecked="{Binding Option2}" /> 
```

如果 Name-property 对于所有项目都是唯一的（就像我的问题一样），它会起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T17:06:35.837

WPF 将所有单选按钮作为同一组的一部分读取，并且在单选按钮组中一次只能选择一项。

加载顺序如下：

*   加载选项卡1
*   加载 Tab1.Radio1。IsChecked = 真
*   加载 Tab1.Radio2。IsChecked = True，因此设置 Tab1.Radio2.IsChecked = False

*   单击选项卡 2

*   加载选项卡2
*   加载 Tab2.Radio1。IsChecked = True，因此设置 Tab1.Radio2.IsChecked = False
*   加载 Tab2.Radio2。IsChecked = True，因此设置 Tab2.Radio1.IsChecked = False

*   到目前为止，Tab2.Radio2 是唯一选中的，并且所有其他 Radio 都已加载且未选中，因此它们的 DataBound 值已更新为 false。

*   单击选项卡 1

*   加载 Tab1.Radio1。IsChecked = 假
*   加载 Tab1.Radio2。IsChecked = 假

如果您的单选按钮不相关并且可以同时检查，我建议切换到`CheckBoxes`

如果它们要被分组并且一次只能选择一个项目，我建议切换到使用`ListBox`绘制的`RadioButtons`，并且只将 存储`SelectedOption`在您的`ViewModel`

这是我通常使用的样式：

```
<Style x:Key="RadioButtonListBoxStyle" TargetType="{x:Type ListBox}">
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="KeyboardNavigation.DirectionalNavigation" Value="Cycle" />
    <Setter Property="ItemContainerStyle">
        <Setter.Value>
            <Style TargetType="{x:Type ListBoxItem}" >
                <Setter Property="Margin" Value="2, 2, 2, 0" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <Border Background="Transparent">
                                <RadioButton
                                    Content="{TemplateBinding ContentPresenter.Content}" VerticalAlignment="Center"
                                    IsChecked="{Binding Path=IsSelected,RelativeSource={RelativeSource TemplatedParent},Mode=TwoWay}"/>

                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Setter.Value>
    </Setter>
</Style> 
```

它是这样使用的：

```
<ListBox ItemsSource="{Binding Options}"
         SelectedValue="{Binding SelectedValue}"
         Style="{StaticResource RadioButtonListBoxStyle}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T15:33:00.973

我曾经遇到过一个与此非常相似的问题，当我在视图之间切换时，文本被清除了。如果我没记错的话，以下解决方案是有效的。

*   绑定`OneWay`到属性并使用属性标记这些绑定的属性。
*   每次加载视图（以及视图模型）时，对上述属性使用反射来查找绑定的属性。
*   `PropertyChanged`为每个属性触发一个事件以正确更新视图。

我认为这是由于使用默认设置加载视图而不是在加载时查询属性，因为没有任何事件引发`PropertyChanged`事件。

此外，这不是您的问题的一部分，但您可以直接在 XAML 中设置数据上下文（通过 Window 中的 DataContext 属性），这样 Visual Studio 就不必有明确的代码隐藏文件。

# javascript - jQuery：如何从链接中删除查询字符串？

> ID：11543398
> 
> 赞同：5
> 
> 时间：2012-07-18T14:13:47.250
> 
> 标签：javascript, jquery, query-string

如何从链接的 url 中删除查询字符串？例如我有

```
<a href="http://example.com/somepath/anotherpath?title=dog">The Link</a> 
```

如何`?title=dog`使用 javascript/jquery 从 url 中删除？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-18T14:28:19.657

您只需更改[Location](https://developer.mozilla.org/en/window.location)对象的[`search`属性即可从链接中删除查询字符串。](https://developer.mozilla.org/en/window.location#Properties)

```
$("#your_link")[0].search = ""; 
```

演示：http: [//jsfiddle.net/uSrmg/1/](http://jsfiddle.net/uSrmg/1/)

或者，如果您需要定位多个元素：

```
$("a.someclass").each(function() {
 this.search = "";   
}); 
```

演示：http: [//jsfiddle.net/uSrmg/4/](http://jsfiddle.net/uSrmg/4/)

* * *

如果您希望解析任意 URL 以删除查询字符串，您可以反转本文中解释的[技巧](https://stackoverflow.com/questions/6644654/parse-url-with-jquery-javascript/6644749#6644749)。例如：

```
function remove_qs(url) {
    var a = document.createElement('a'); // dummy element
    a.href = url;   // set full url
    a.search = "";  // blank out query string
    return a.href;
} 
```

这应该非常健壮，因为它使用[Location](https://developer.mozilla.org/en/window.location)对象进行所有解析。

用法示例：http: [//jsfiddle.net/uSrmg/](http://jsfiddle.net/uSrmg/)

* * *

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-05T04:57:57.900

还有另一种方法可以用空白替换搜索。

```
String(document.location.href).replace("&title=dog", ""); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-18T14:20:38.010

要从锚标记中删除查询字符串：

```
var anchor = $('#yourAnchor');
var href = anchor.attr('href');

if (href.indexOf('?') !== -1) {
   anchor.attr('href', href.split('?')[0]);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-18T14:16:02.710

```
var url=$('a').attr('href').split('?')[0]; 
```

拆分“？” 并获得第一项。如果要更改页面上所有链接的 url，则可以使用以下代码：

```
$('a').each(function(i,el){ 
    $(el).attr('href', $(el).attr('href').split('?')[0]);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-16T09:56:05.370

这段代码对我有用：

```
var url = "www.foo.com/test?name=kevin&gender=Male&id=1234";

var res = url.replace("&gender=Male", "");

window.location.href =res; 
```

通过javascript在url中拆分特定的字符串查询参数

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-22T05:46:31.693

您可以在页面加载时将查询字符串从 url 拆分为：-

```
$(function(){
  if(Modernizr.history)
  {
    history.replaceState({},"",location.href.split("?")[0]);
  }
}); 
```

# c# - WCF ServiceHost 是否充当侦听器或轮询器？

> ID：11543401
> 
> 赞同：1
> 
> 时间：2012-07-18T14:14:03.810
> 
> 标签：c#, .net, wcf, msmq

我将 WCF 与 netMsmqBinding 一起使用。打开时`serviceHost`会发生哪种情况：

1.  `serviceHost`注册为 MSMQ 的侦听器 - 在发送到 MSMQ 的每条新消息上，MSMQ 都会通知它的所有侦听器。
2.  `serviceHost`将轮询 MSMQ 以获取新消息 -

开通服务主机

```
using (var serviceHost = new ServiceHost(typeof(Service)))
{                
    serviceHost.Open();

    Console.WriteLine("The service is ready.");
    Console.WriteLine("Press <ENTER> to terminate service.");
    Console.ReadLine();    
} 
```

如果第一种情况是真的，它实际上是如何注册到 MSMQ 的。我没有找到任何文章深入解释它是如何发生的。我会很感激任何文章。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:35:12.433

本实例中的 ServiceHost 是一个队列侦听器。

当队列接收到消息时，WCF 堆栈会调用您的服务操作，将队列消息传递给您的服务操作。

> ...MSMQ 将通知所有它的听众。

是不正确的。如果您在同一个队列上有多个侦听器，那么只有其中一个会收到消息。

# html - 将文本移入 到结束 只有 CSS 的宽度

> ID：11543402
> 
> 赞同：0
> 
> 时间：2012-07-18T14:14:06.167
> 
> 标签：html, css, format

我在`<p>`一个固定宽度的元素中有一条线，如下所示：

```
<p class="line">
To be, or not to be, 
<span class="variant">that is the question,</span>
<span class="variant right">&nbsp<b>&minus;</b>&nbsp</span>
</p> 
```

我正在尝试将`&minus;`“-”移动到该行的右端，其余文本左对齐。我只需要使用 HTML 和 CSS（最好不是 CSS3）来执行此操作，因为我正在制作模型模型。我觉得有办法做到这一点，但我想不出它会是什么。

任何帮助，将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:17:54.050

在您的 CSS 中：

```
.right{
    float:right;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:18:51.597

喜欢这个**[jsFiddle 示例](http://jsfiddle.net/j08691/yxC56/)**吗？

**CSS**

```
.variant.right {
    float:right;
}​ 
```

**HTML**

```
<p class="line">
To be, or not to be, 
<span class="variant">that is the question,</span>
<span class="variant right">&nbsp;<b>&minus;</b>&nbsp;</span>
</p>​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:20:31.160

如果你想把它从你的 HTML 中分离出来，你可以这样做（特别是对于表示层，而不是内容层）

```
p.line:after { 
    content: " - "; 
    font-weight: bold; 
    float: right;
} 
```

​</p>

```
<p class="line">
    To be, or not to be, 
    <span class="variant">that is the question,</span>
</p> 
```

jsFiddle：http: [//jsfiddle.net/fch5J/6/](http://jsfiddle.net/fch5J/6/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T14:21:13.360

`-`如果有足够的文本，这样的事情还有一个额外的好处，就是防止段落文本出现在 , 之上。你本质上是在为他们的`-`生活创造一个“排水沟”。

```
p.line {
  position: relative;
  padding-right: 2em;
}
p .right { 
  position: absolute;
  right: 0;
  text-align: right;
  width: 2em;
} 
```

如果您希望始终相对于段落块的顶部或底部显示，您还可以添加`top`or`bottom`规则`p.right``-`

# r - 从子集中选择观察值以基于 R 中的大型数据框创建新子集

> ID：11543404
> 
> 赞同：5
> 
> 时间：2012-07-18T14:14:11.037
> 
> 标签：r, dataframe, dataset, subset

我有一个包含许多列和行的数据集（Purchase.df）。这个问题的重要变量名称是“Customer”、“OrderDate”、“DateRank”（对日期进行排序以便我可以找到最小的日期）和“BrandName”。以下是我正在使用的一个非常小的示例：（我是这个网站的新手，所以我希望我在下面粘贴的内容有效）

```
Purchase.df<-structure(list(Customer = c(10071535L, 10071535L, 10071535L, 
10071535L, 10071535L, 10071535L, 10071711L, 10071711L, 10071711L, 
10071711L, 10071711L, 10071711L, 10071711L, 10071711L, 10071711L, 
10071711L, 10071711L, 10071711L, 10072059L, 10072059L, 10072059L, 
10072113L, 10072113L, 10072113L, 10072113L, 10072113L, 10072113L, 
10072113L), BrandName = structure(c(1L, 2L, 2L, 2L, 3L, 3L, 2L, 
2L, 2L, 2L, 3L, 3L, 1L, 3L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 
2L, 3L, 3L, 3L, 3L), .Label = c("X", "Y", "Z"), class = "factor"), 
OrderDate = structure(c(14L, 14L, 15L, 16L, 19L, 20L, 11L, 
18L, 5L, 6L, 1L, 17L, 21L, 22L, 23L, 8L, 10L, 13L, 7L, 9L, 
12L, 4L, 4L, 2L, 2L, 2L, 3L, 3L), .Label = c("1/17/2011 0:00", 
"1/19/2010 0:00", "1/25/2010 0:00", "1/4/2010 0:00", "10/22/2010 0:00", 
"11/15/2010 0:00", "11/23/2011 0:00", "12/14/2011 0:00", 
"12/16/2011 0:00", "2/7/2012 0:00", "3/16/2010 0:00", "3/21/2012 0:00", 
"4/16/2012 0:00", "4/27/2012 0:00", "5/16/2012 0:00", "5/30/2012 0:00", 
"5/5/2011 0:00", "6/1/2010 0:00", "6/12/2012 0:00", "7/3/2012 0:00", 
"8/1/2011 0:00", "8/16/2011 0:00", "9/19/2011 0:00"), class = "factor"), 
DateRank = c(18.5, 18.5, 20, 21, 24, 25, 15, 23, 9, 10, 1, 
22, 26, 27, 28, 12, 14, 17, 11, 13, 16, 7.5, 7.5, 3, 3, 3, 
5.5, 5.5)), .Names = c("Customer", "BrandName", "OrderDate", 
"DateRank"), row.names = c(NA, -28L), class = "data.frame") 
```

我创建了这个大型数据集 (subset.df) 的一个子集，它为每个客户找到了第一个 OrderDate，并告诉我他们购买了哪个品牌。我使用以下代码来执行此操作：

```
subset1<-split(Purchase.df,Purchase.df$Customer)
subset2<-lapply(split(Purchase.df,Purchase.df$Customer), function(chunk) chunk[which(chunk$DateRank==min(chunk$DateRank)),])
subset.df<-do.call(rbind, as.list(subset2)) 
```

现在，我想弄清楚哪些客户在他们的第一个 OrderDate 订购了品牌 X，并创建一个新数据集 (BigSubset.df)，其中包含在第一个订购日期购买了品牌 X 的客户的所有 OrderDates。

应该看起来像这样：

```
Customer    BrandName   OrderDate   DateRank
10071535    X   4/27/2012 0:00  18.5
10071535    Y   4/27/2012 0:00  18.5
10071535    Y   5/16/2012 0:00  20
10071535    Y   5/30/2012 0:00  21
10071535    Z   6/12/2012 0:00  24
10071535    Z   7/3/2012 0:00   25
10072059    X   11/23/2011 0:00 11
10072059    X   12/16/2011 0:00 13
10072059    X   3/21/2012 0:00  16
10072113    X   1/4/2010 0:00   7.5
10072113    Y   1/4/2010 0:00   7.5
10072113    Y   1/19/2010 0:00  3
10072113    Z   1/19/2010 0:00  3
10072113    Z   1/19/2010 0:00  3
10072113    Z   1/25/2010 0:00  5.5
10072113    Z   1/25/2010 0:00  5.5 
```

当我尝试从 Purchase.df 创建 BigSubset.df 时，我似乎无法让 R 引用较小的数据集，因为行数不相等。我在谷歌上搜索过，没有看到任何答案，所以我什至不确定这在 R 中是否可行。让我知道你的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T20:23:04.420

也许我误解了，但我相信这有效：

```
Xfirst <- as.vector(subset.df[subset.df$BrandName == "X", ])$Customer
BigSubset.df <- Purchase.df[Purchase.df$Customer %in% Xfirst, ] 
```

我认为您的 daterank 中可能存在错误，因为在您的示例中，客户 10072113 的日期为 2010 年 1 月 19 日排名第 3，但较早的 2010 年 1 月 4 日排名为 7.5。（旁注，在您的`chunk`函数中，您可以使用`which.min(chunk$DateRank)`而不是`which(chunk$DateRank==min(chunk$DateRank))`，我认为这更有效。）

# android - 在单个屏幕中调用多个 Activity 类？

> ID：11543406
> 
> 赞同：0
> 
> 时间：2012-07-18T14:14:16.997
> 
> 标签：android, android-activity

我们可以`Activity`在 Android 应用程序的单个屏幕中使用多个类吗？

例如，利用多个`Activity`类调用不同的 Web 服务并在屏幕上填充信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:29:12.770

一个活动代表安卓上的一个屏幕。我认为 Fragments 就是您要搜索的内容。使用 Fragments，您可以在一个屏幕上显示更多布局。

# mysql - 在数据库中删除表列后，无法使用 Symfony 2 应用程序保存或编辑实体

> ID：11543407
> 
> 赞同：0
> 
> 时间：2012-07-18T14:14:21.507
> 
> 标签：mysql, symfony

我有一个 MySQL 数据库的 Symfony 2 前端。我通过在我的一张表上删除一列来更改我的数据库。在应用程序中，我执行了以下操作以反映此更改：

*   从表单类中删除了该字段
*   从实体类中移除了字段、getter & setter 和注解
*   从模板中删除了该字段

所有页面都显示正确，但是当我在编辑或创建新记录后提交时，出现以下错误：

> SQLSTATE [42S22]：未找到列：1054 未知列“新”500 内部服务器错误 - PDOException 中的“trial_abbrev”

我想我一定错过了什么，但我怀疑它是在教义魔法的深处自动发生的。

任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:57:05.807

不是答案，但对该问题的评论变得混乱且有些脱节。所以回到基础。跑：

```
app/console doctrine:schema:update --dump-sql 
```

它应该说：

```
Nothing to update - your database is already in sync with the current entity metadata. 
```

请说明您收到的回复，我们可以从那里开始工作。

# azure - Azure Blob 容器共享访问签名即将到期

> ID：11543408
> 
> 赞同：9
> 
> 时间：2012-07-18T14:14:21.847
> 
> 标签：azure, azure-blob-storage

我在 Azure Blob 和共享访问签名过期时遇到问题。我需要授予对 blob 的访问权超过 1 小时（7 天），因此我使用的是命名容器策略，但不幸的是，一旦这 7 天结束，我似乎无法生成新的 url。

我有以下代码来创建“默认”策略。请注意，在这段代码中，我将过期时间设置为从现在开始 1 分钟，以便于测试：

```
CloudStorageAccount account = new CloudStorageAccount(credentials, true);

CloudBlobClient client = new CloudBlobClient(account.BlobEndpoint, credentials);

CloudBlobContainer container = client.GetContainerReference("files");

SharedAccessPolicy sharedAccessPolicy = new SharedAccessPolicy();
sharedAccessPolicy.Permissions = SharedAccessPermissions.Read;
sharedAccessPolicy.SharedAccessStartTime = DateTime.UtcNow;
sharedAccessPolicy.SharedAccessExpiryTime = DateTime.UtcNow.AddMinutes(1);

BlobContainerPermissions blobContainerPermissions = new BlobContainerPermissions();
blobContainerPermissions.SharedAccessPolicies.Add("default", sharedAccessPolicy);

container.SetPermissions(blobContainerPermissions); 
```

然后我使用以下内容创建一个 SharedAccessSignature url：

```
CloudStorageAccount account = new CloudStorageAccount(credentials, true);

CloudBlobClient client = new CloudBlobClient(account.BlobEndpoint, credentials);

CloudBlobContainer container = client.GetContainerReference("files");

CloudBlob blob = container.GetBlobReference(path);

string sas = blob.GetSharedAccessSignature(new SharedAccessPolicy(), "default");

Console.WriteLine(blob.Uri.AbsoluteUri + sas); 
```

这会生成一个 url，并且该 url 在下一分钟（或实际代码中的 7 天）内正常工作。一分钟结束后，该 url 无效并且不再像预期的那样工作。

但是一旦过期，我再次运行代码以生成一个新的 url。不幸的是，它生成了相同的 url，仍然无效。

容器策略的开始/结束时间是绝对的，这意味着我现在设置该策略时：

```
sharedAccessPolicy.SharedAccessStartTime = DateTime.UtcNow;
sharedAccessPolicy.SharedAccessExpiryTime = DateTime.UtcNow.AddMinutes(1); 
```

使用该政策的任何内容仅在今天上午 10:10 (EDT) 至上午 10:11 (EDT) 有效？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-18T14:59:45.510

您可以做的一件事是创建没有过期日期的访问策略。您在创建签名 URL 时指定到期日期。

所以你的代码看起来像：

```
 SharedAccessPolicy sharedAccessPolicy = new SharedAccessPolicy();
        sharedAccessPolicy.Permissions = SharedAccessPermissions.Read;
        sharedAccessPolicy.SharedAccessStartTime = DateTime.UtcNow;
        //sharedAccessPolicy.SharedAccessExpiryTime = DateTime.UtcNow.AddMinutes(1); No need to define expiry time here.

        BlobContainerPermissions blobContainerPermissions = new BlobContainerPermissions();
        blobContainerPermissions.SharedAccessPolicies.Add("default", sharedAccessPolicy);

        container.SetPermissions(blobContainerPermissions);

        Console.WriteLine("Press any key to continue....");
        Console.ReadLine();
        CloudBlob blob = container.GetBlobReference(path);

        string sas = blob.GetSharedAccessSignature(new SharedAccessPolicy()
        {
            SharedAccessExpiryTime = DateTime.UtcNow.AddDays(7),//add expiry date only when you're creating the signed URL
        }
            , "default");

        Console.WriteLine(blob.Uri.AbsoluteUri + sas);

        Process.Start(new ProcessStartInfo(blob.Uri.AbsoluteUri + sas));

        Console.WriteLine("Press any key to continue....");
        Console.ReadLine(); 
```

这对你有用吗？显然，您需要在 7 天后重新生成 URL，但您不必对访问策略进行任何更改。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:43:41.320

1 分钟到期后，您可能会遇到 SAS 生成盒和 Windows Azure 存储之间的时钟偏差效应。您应该使用更长的间隔。我发表了一篇深入探讨共享访问签名的帖子，您可能会觉得有帮助[。](http://convective.wordpress.com/2010/01/20/access-control-for-azure-blobs/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T15:03:02.607

您可能会达到容器级别访问策略的最大值。

存储的访问策略包括一个最长 64 个字符的名称，该名称在容器中是唯一的。此名称出现在链接到存储的访问策略的共享访问签名上的签名标识符字段中。一个容器最多可以包含 5 个存储的访问策略。每个策略可由任意数量的共享访问签名使用。

[使用存储访问策略](http://msdn.microsoft.com/en-us/library/windowsazure/ee393341.aspx)

# objective-c - initWithObjects 上的 NSMutableArray EXEC_BAD_ACCESS

> ID：11543410
> 
> 赞同：0
> 
> 时间：2012-07-18T14:14:23.287
> 
> 标签：objective-c

启用 ARC 的 Objective-c 中的以下内容是否合法？

```
NSMutableArray * smallArray = [[NSMutableArray alloc] initWithObjects:@"1", @"2", @"3", nil];
smallArray = [[NSMutableArray alloc] initWithObjects:@"4", "5", nil]; 
```

我认为应该是。但是，在这种情况下，它在第四行给了我 EXEC_BAD_ACCESS：

```
NSMutableArray * bigArray = [[NSMutableArray alloc] init];
NSMutableArray * smallArray = [[NSMutableArray alloc] initWithObjects:@"1", @"2", @"3", nil];
[bigArray addObject: smallArray];
smallArray = [[NSMutableArray alloc] initWithObjects:@"4", "5", nil]; 
```

addObject 复制指针对吗？因此，如果我将新的内存段分配给 smallArray 以指向，那有什么问题？

但是，此代码段不会崩溃：

```
NSMutableArray * bigArray = [[NSMutableArray alloc] init];
NSMutableArray * smallArray = [[NSMutableArray alloc] initWithObjects:@"1", @"2", @"3", nil];
[bigArray addObject: smallArray];
smallArray = [[NSMutableArray alloc] init];
[smallArray addObject:@"4"];
[smallArray addObject:@"5"]; 
```

这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:20:33.860

尝试这个：

```
smallArray = [[NSMutableArray alloc] initWithObjects:@"4", "5", nil]; 
```

第二个对象必须是**@"5"**，而不仅仅是**"5"**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:22:03.813

我猜这是因为您忘记了字符串“5”中的@。它应该是：

```
smallArray = [[NSMutableArray alloc] initWithObjects:@"4", @"5", nil]; 
```

# java - 是否可以避免在 split() 或 Arrays.asList() 中将一种对象类型转换为另一种对象类型的循环？

> ID：11543411
> 
> 赞同：3
> 
> 时间：2012-07-18T14:14:24.190
> 
> 标签：java, arrays, type-conversion

我正在尝试简化我的代码，但我有一个问题：是否可以将由逗号分隔的 ID 字符串转换为特定的集合类型？

所以，我现在的代码是：

```
String [] condition_list_id_tmp = rule.getContractRuleConditions().split(",");
List<String> condition_list_id = Arrays.asList(condition_list_id_tmp);
List<Long> condition_ids = new ArrayList<Long>();
    for (String str_id : condition_list_id){
         condition_ids.add(Long.parseLong(str_id));
    } 
```

我可以通过使用例如`Type collectionType = new TypeToken<List<Long>>() {}.getType();`gson 来简化此代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:49:51.080

你考虑[过 LambdaJ](http://code.google.com/p/lambdaj/)吗？

```
class StringToLong implements Converter<String, Long> {
    public Long convert(String str) {
        return Long.parseLong(str);
    }
}

String [] condition_list_id_tmp = rule.getContractRuleConditions().split(",");
List<String> condition_list_id = Arrays.asList(condition_list_id_tmp);
List<Long> condition_ids = convert(condition_list_id, new StringToLong()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:40:47.377

或使用一些库，如番石榴？这样您的代码中就没有循环（但在他们的代码中）？我看到您提到您的目标是“简化我的代码”

例如

```
final List<String> strList = Arrays.asList("1,2,3,4,5".split(","));
final List<Long> l = Lists.transform(strList, new Function<String, Long>() {
    @Override
    public Long apply(final String input) {
        return Long.parseLong(input);
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:31:15.990

没有循环就没有可用的方法。即使有一种方法可用，它在您看来也是一个单一的操作，但显然它必须

> 内部循环。

例如：`Arrays.fill(arrayname, intval);`

这是用任何整数值填充数组的单一方法。但在内部，它也会在数组上运行一个循环。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T14:20:51.440

我**不**认为没有`looping`你可以做到这一点。如何在`collection's` 没有明确转换的情况下更改您的内容类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T14:32:38.670

[java 8](http://jdk8.java.net/)可以做到这一点：

```
String [] condition_list_id_tmp = rule.getContractRuleConditions().split(",");
List<String> condition_list_id = Arrays.asList(condition_list_id_tmp);

List<Long> condition_ids = condition_list_id.map(c -> Long.parseLong(c)) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-18T14:47:25.500

在 Java 8 推向市场之前，您的问题的解决方案可能是[Guava](http://code.google.com/p/guava-libraries/wiki/Release13)项目，它支持[Functional Idioms](http://code.google.com/p/guava-libraries/wiki/FunctionalExplained)。

然后您可以以不同的方式执行该操作，但正如我在评论中所写的那样。最后，您将进行相同的操作。

```
public static List<Long> splitToLong(String list, String token) {

  StringTokenizer tokenizer= new StringTokenizer(list, token);
  List<Long> result = new ArrayList<Long>();
  while(tokenizer.hasMoreTokens() {
     result.add(Long.parseLong(tokenizer.nextToken()));
  }
} 
```

如果将此方法放在某个 Util 类中，则可以享受干净的代码

```
 //....

 for(Long mLong : StringHelper.splitToLong(message,",")) {
    //Do something with mLong
 }

 //.... 
```

# delphi - 如何以像素为单位计算 Windows 区域 (HRGN) 的面积？

> ID：11543412
> 
> 赞同：4
> 
> 时间：2012-07-18T14:14:25.123
> 
> 标签：delphi, winapi, area, region

获取任意 Windows 区域面积的最快方法是什么？

我知道我可以枚举边界矩形的所有点并调用该`PtInRegion()`函数，但它似乎不是很快。也许你知道一些更快的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-18T14:31:26.313

当您调用 时[`GetRegionData`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144920.aspx)，您将获得组成该区域的非重叠矩形列表。将它们的区域相加，如下所示：

```
function GetRegionArea(rgn: HRgn): Cardinal;
var
  x: DWord;
  Data: PRgnData;
  Header: PRgnDataHeader;
  Rects: PRect;
  Width, Height: Integer;
  i: Integer;
begin
  x := GetRegionData(rgn, 0, nil);
  Win32Check(x <> 0);
  GetMem(Data, x);
  try
    x := GetRegionData(rgn, x, Data);
    Win32Check(x <> 0);
    Header := PRgnDataHeader(Data);
    Assert(Header.iType = rdh_Rectangles);

    Assert(Header.dwSize = SizeOf(Header^));
    Rects := PRect(Cardinal(Header) + Header.dwSize);
    // equivalent: Rects := PRect(@Data.Buffer);

    Result := 0;
    for i := 0 to Pred(Header.nCount) do begin
      Width := Rects.Right - Rects.Left;
      Height := Rects.Bottom - Rects.Top;
      Inc(Result, Width * Height);
      Inc(Rects);
    end;
  finally
    FreeMem(Data);
  end;
end; 
```

# django - Django 表单和 MultipleChoiceField

> ID：11543413
> 
> 赞同：1
> 
> 时间：2012-07-18T14:14:27.010
> 
> 标签：django, forms

尝试创建一个表单，您可以在其中注册为用户，并将自己添加到一个或多个类别。执行此操作时出错：

> /users/add-user/ 处的类型错误
> 
> > 'categories' 是此函数的无效关键字参数

这是我的forms.py：

```
class AddUser(forms.Form):
    name = forms.CharField()
    title = forms.CharField()
    website = forms.CharField(required=False)
    email = forms.EmailField()
    phone = forms.CharField(required=False)
    company = forms.ModelChoiceField(queryset=Company.objects.all())
    categories = forms.ModelMultipleChoiceField(queryset=Category.objects.all()) 
```

最后一行是我遇到的麻烦。

这是我的views.py：

```
def add_user(request):
    if request.method == 'POST':
        form = AddUser(request.POST)
        if form.is_valid():
            cd = form.cleaned_data
            try:
                p = User.objects.get(email=cd['email'])
                error = "There's already a user with that e-mail adress registered. Maybe he/she is already here?"
                return render_to_response('users/add_user.html', {'form': form, 'error': error}, context_instance=RequestContext(request))
            except User.DoesNotExist:
                p = User(name=cd['name'], title=cd['title'], website=cd['website'], email=cd['email'], phone=cd['phone'], company=cd['company'], categories=cd['categories'])
                p.save()
            return HttpResponseRedirect('../thanks/')
    else:
        form = AddUser(request.POST)
        error = "You can't really submit empty forms. Try adding something useful :)"       
    return render_to_response('users/add_user.html', {'form': form}, context_instance=RequestContext(request)) 
```

如果有人对这个问题有任何建议（或者甚至是改进我的代码的一般建议），我会很高兴！我是 Django 的初学者，感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:32:44.047

你的问题出在这里：

```
p = User(name=cd['name'], title=cd['title'], website=cd['website'], email=cd['email'], phone=cd['phone'], company=cd['company'], categories=cd['categories']) 
```

问题是 User 模型不包括类别字段，就像它不包括网站或公司一样。查看[可用字段的列表](https://docs.djangoproject.com/en/dev/topics/auth/#fields)。

结合 Django 的身份验证系统，有不同的方法来处理额外的数据。子类化 User 类或向 User 添加带有附加信息和一对一字段的模型会浮现在脑海中。似乎[建议](https://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users)使用后一种选择，所以我建议沿着这条路走。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:47:29.327

有点挑剔，但您确实要求提供其他建议。这一点：

```
else:
    form = AddUser(request.POST) 
```

应该（IMO）改为：

```
else:
    form = AddUser() 
```

对于 GET 请求，无需使用 request.POST。我从未尝试过，但我猜它会起作用，你只是得到一个空集。所以不是错误，但可能是混乱的根源。

您的错误消息也没有被使用。在这种情况下，页面上的 GET 根本不是错误，它只是页面最初显示的方式。

# objective-c - OpenGL glBlendFuncSeparate

> ID：11543419
> 
> 赞同：6
> 
> 时间：2012-07-18T14:14:58.023
> 
> 标签：objective-c, xcode, macos, cocoa, opengl

我需要一些有关 OpenGL 纹理遮罩的帮助。我让它工作，但需要找到一些其他混合函数参数以其他方式工作。我现在有：

```
//Background 
...code...
    glBlendFunc(GL_ONE, GL_ZERO);
...code

//Mask
...code...
    glBlendFuncSeparate(GL_ZERO, GL_ONE, GL_DST_COLOR, GL_ZERO);
...code...

//Foreground
...code
    glBlendFunc(GL_DST_ALPHA, GL_ONE_MINUS_DST_ALPHA);
...code 
```

现在它将前景的不透明度设置为 0（用背景纹理填充），其中蒙版是透明的。我需要它对面具的颜色做出反应。我的意思是根据蒙版的颜色设置前景不透明度。例如，如果蒙版是黑色 (0.0,0.0,0.0)，则前景中该位置的不透明度为 0（填充背景），如果蒙版为白色（1.0,1.0,1.0），则前景的不透明度为 1（未填充背景）。它可以是相反的结果（白色 = 不透明度 0，黑色 = 不透明度 1）。我只需要它根据颜色工作。

我当前结果的可视化如下。

* * *

背景：
![在此处输入图像描述](../Images/036c2386e6175da0b5aca4bd8a258faa.png)

面具（圆圈是透明的）：
![在此处输入图像描述](../Images/8014bbba53bb70b899d16b4aae170b32.png)

前景：
![在此处输入图像描述](../Images/05f5e664ad11edc94f42164ee06d97be.png)

结果：
![在此处输入图像描述](../Images/c04073179e0dbf07ea69645ddb5df9a8.png)

* * *

我希望它像这样工作：

背景：
![在此处输入图像描述](../Images/036c2386e6175da0b5aca4bd8a258faa.png)

面具（圆圈为白色，背景为黑色）：
![在此处输入图像描述](../Images/8014bbba53bb70b899d16b4aae170b32.png)

前景：
![在此处输入图像描述](../Images/05f5e664ad11edc94f42164ee06d97be.png)

结果：
![在此处输入图像描述](../Images/c04073179e0dbf07ea69645ddb5df9a8.png)

* * *

这样以后就可以像这样使用它：

背景：
![在此处输入图像描述](../Images/036c2386e6175da0b5aca4bd8a258faa.png)

面具（圆圈为白色，背景为黑色）：
![在此处输入图像描述](../Images/165588abd7bd116041a3026bd473a8ee.png)

前景：
![在此处输入图像描述](../Images/05f5e664ad11edc94f42164ee06d97be.png)

结果：
![在此处输入图像描述](../Images/e2e43e88d7b975aa990d5cabf6e714b8.png)

* * *

尝试使用@Gigi 解决方案：
![在此处输入图像描述](../Images/90835b269c48acfe7d0ed4b58560b634.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T15:42:54.960

也许这就是你想要的：

* * *

1）清除目标图像：

```
glClearColor(0.0, 0.0, 0.0, 0.0);
glClear(GL_COLOR_BUFFER_BIT); 
```

* * *

2) 绘制背景，屏蔽掉 alpha 通道：

```
glColorMask(GL_TRUE, GL_TRUE, GL_TRUE, GL_FALSE); 
```

* * *

3）绘制“遮罩覆盖”，遮蔽颜色通道：

```
glColorMask(GL_FALSE, GL_FALSE, GL_FALSE, GL_TRUE); 
```

* * *

4) 绘制前景，启用混合：

```
glEnable(GL_BLEND);
glBlendEquationSeparate(GL_FUNC_ADD, GL_FUNC_ADD);
glBlendFuncSeparate(GL_ONE_MINUS_SRC_ALPHA, GL_SRC_ALPHA, GL_ONE, GL_ZERO); 
```

* * *

注意：叠加图像必须指定 Alpha 通道。

# c# - 从数据集中获取 HH:MM 格式的总数

> ID：11543423
> 
> 赞同：0
> 
> 时间：2012-07-18T14:15:05.237
> 
> 标签：c#, asp.net

```
CREATE procedure St_Proc_GetUserReportforCurrentDayTask                        
@userID int                        
as                        
    Begin                        
        set NoCount on;                        
        DECLARE @TODAY DATE                          
        SET @TODAY = CONVERT(VARCHAR(10), GETDATE(), 111)                        
        select  CONVERT(VARCHAR,production.CalendarDate,101) + RIGHT (CONVERT(VARCHAR,production.CalendarDate , 100 ) ,7) as Date,                         
        RegionAndProjectInfo.RegionProjectName as Region ,                        
        County.CountyName as County,                        
        WorkType.WorkTypeName as WorkType,                        
        Task.TaskName as Task,            
        Production.VolumeProcessed as 'Volumes Processed',                        
        Production.TimeSpent as 'Duration'                        
        from Production                         
        inner join RegionAndProjectInfo                        
        on                        
        RegionAndProjectInfo.RegionProjectID=Production.RegionProjectID                        
        inner join County                        
        on                         
        County.CountyID=Production.CountyID                        
        inner join WorkType                        
        on                        
        WorkType.WorkTypeID=Production.WorkTypeID                        
        inner join Task                        
        on                        
        Task.TaskID=Production.TaskID                        
        where Production.UserID=@userID and CalendarDate >= @TODAY                        
    End 
```

从上面的存储过程中，我正在填充一个数据集。之后，我将此数据集绑定到一个网格视图。在数据集中，列持续时间包含 HH:MM 格式的数据（example-01:00,12:45,02:59 等）。有没有办法可以从数据集本身。我不想再次从数据库中查询以获取持续时间的总和。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:27:24.610

如果您至少使用 SQL-Server 2008，则应使用`Time`数据类型来表示 .NET `TimeSpan`。

为了让它与 varchar-column 一起工作，我会使用 `Linq-To-DataSet`，例如：

```
var timeSpans = dataSet.Tables[0].AsEnumerable()
    .Select(r => new {
        DurHour   = r.Field<String>("Duration").Split(':')[0],
        DurMinute = r.Field<String>("Duration").Split(':')[1]
    })
    .Select(x => new TimeSpan(int.Parse(x.DurHour), int.Parse(x.DurMinute), 0));

Console.WriteLine("Total time in minutes: {0}", timeSpans.Sum(ts=>ts.TotalMinutes)); 
```

但这只是一种解决方法，实际上您应该避免将时间跨度存储在 varchar 列中，仅将 varchar 用于文本而不是其他任何内容。

在 SQL-Server 2005（或其他 dbms）中，您还可以使用两列，一列用于 start `DateTime`，一列用于 end `DateTime`。

# javascript - 在 Javascript 中创建一个动态选择对象

> ID：11543427
> 
> 赞同：5
> 
> 时间：2012-07-18T14:15:21.167
> 
> 标签：javascript

> **可能重复：**
> [如何在 javascript 中填充选择元素的选项](https://stackoverflow.com/questions/6601028/how-to-populate-the-options-of-a-select-element-in-javascript)

我想在 javascript 中创建一个动态选择标签和选项标签。有什么建议么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-18T14:19:13.783

试试 javascript

```
 var select = document.createElement( 'select' );
   var option;
   var inputdata = 123||456||789;

    inputdata.split( '||' ).forEach(function( item ) {

        option = document.createElement( 'option' );

        option.value = option.textContent =        item;

        select.appendChild( option );
    }); 
```

jQuery

```
var inputdata = 123||456||789;
 var split = input.split('||');
 var select = $('<select name="options" id="options"></select>');
 $.each(split, function(index, value) {
   var option = $('<option></option>');
   option.attr('value', value);
   option.text(value);
   select.append(option);
 });
 $('#container).empty().append(select); 
```

# php - 我需要在被截断的字段末尾添加“...”

> ID：11543428
> 
> 赞同：1
> 
> 时间：2012-07-18T14:15:24.937
> 
> 标签：php, mysql

我希望描述、分辨率和附加注释在超过 6 个单词时被切断，然后有“...”和“查看完整案例”的链接。我只希望它显示在被截断的字段上，而不是少于 6 个单词的字段上，因为整个字段已经显示。如果你们能帮我弄清楚如何做到这一点，那会让我很开心！谢谢你！

我有这个查询，到目前为止只能使该字段在 6 个单词处被截断：

```
$sql = ("SELECT id, sso, case_status, assigned_to, updated, created, SUBSTRING_INDEX(additional_notes,' ',6) as additional_notes, SUBSTRING_INDEX(resolution,' ',6) as resolution, SUBSTRING_INDEX(description,' ',6) as description FROM rmstable2 WHERE sso LIKE '%{$sso}%'"); 
```

结果显示在表格中，如下所示：

说明：php here
解析：php here
附加说明：php here
以此类推...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:34:55.050

这个怎么样：

```
<?php

$text = array(
    'some long texts with multiple words, more then seven',
    'some long texts with multiple words, more then seven',
    'some long texts with multiple words, more then seven'
);

$new_text = array();
foreach ( $text as $key => $string ) {
    $words = explode( ' ', $string );
    for ( $k=0; $k<6; $k++ ) {
        if ( $words[ $k ] ) $new_text[ $key ] .= $words[ $k ] . ' ';
    }
    $new_text[ $key ] .= '...';
    # Or like this, if you don't need the space
    //$new_text[ $key ] = rtrim( $new_text[ $key ] ) . '...';

}
print_r( $new_text );

?> 
```

输出：

```
Array
(
    [0] => some long texts with multiple words, ...
    [1] => some long texts with multiple words, ...
    [2] => some long texts with multiple words, ...
) 
```

或 CSS 方式：

```
overflow: hidden;
white-space: nowrap;
text-overflow: ellipsis;
width: 200px; 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:19:04.173

为什么不使用 PHP 函数？

```
function cutLongWord($String='', $Length=20, $Suffix='...'){
    return (strlen($String) > $Length ? substr($String, 0, $Length).$Suffix : $String);
} 
```

# sql - 想要检索最多 3 个条件的 sql 查询

> ID：11543431
> 
> 赞同：0
> 
> 时间：2012-07-18T14:15:35.780
> 
> 标签：sql, db2

我在源表中有一个数据，如下所述：

```
Employee_Id Status  Date        Address Phone number
52345       N       28-Jan-10   ABC     9833455456
52345       N       30-Apr-10   ABC     9833455456
52345       Y       13-Dec-10   ABC     9934467879
10145       N       25-Mar-10   PQR     8766129989
32456       N       20-Jun-10   XYZ     9860799849
32456       N       03-Nov-10   XYZ     9860799849
32456       Y       07-Feb-11   XYZ     9860799849
32456       Y       22-May-11   XYZ     8977767889
32456       N       18-Sep-11   DEF     9811223300
42123       N       25-Feb-10   MNO     9920030048
42123       N       23-Sep-11   MNO     9833445566 
```

目标是在输出中获取员工的唯一记录，但基于以下提到的标准：

1.  如果员工 ID 是唯一的，则按原样传递。
2.  如果员工 ID 重复，则传递 status=”Y” 的记录</li>
3.  如果即使在应用 status=”Y” 后员工 ID 仍然重复，则选择具有最新日期的记录。

有了这些规则，我应该得到这些结果：

```
Employee_Id Status  Date        Address Phone number
52345       Y       13-Dec-10   ABC     9934467879
10145       N       25-Mar-10   PQR     8766129989
32456       Y       22-May-11   XYZ     8977767889
42123       N       23-Sep-11   MNO     9833445566 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:27:28.487

您可以使用 row_number() 函数来获得您想要的。

```
select t.*
from (select t.employee_id,
             row_number() over (partition by employee_id order by status desc, date desc) as seqnum,
             count(*) over (partition by employee_id) as cnt
      from t
     ) t
where seqnum = 1 and not (cnt > 1 and status = 'N') 
```

这将按状态（首先是“Y”）然后按日期（最晚在前）对每个员工的行进行排序。然后它选择该组中的第一个。

如果你只有一行，那么它将有 seqnum = 1。

如果你只有一个“Y”，那么它的 seqnum = 1。

如果您有多个“Y”，那么这将选择日期最晚的那个。

# jquery - IE8显示：无；漏洞

> ID：11543435
> 
> 赞同：0
> 
> 时间：2012-07-18T14:15:47.790
> 
> 标签：jquery, internet-explorer-8, hidden-field

我的页面中有这段代码：

```
<form class="store_product_form" name="" method="post" action="http://www.mydomain.etc...">
    <div style="margin:0;padding:0;display:inline">
        <input type="hidden" value="135" name="entry_id">
        <input type="hidden" value="collezione/unica/C13/portapenne" name="return_url">
        <input type="hidden" value="1" name="site_id">
        <inpu type="hidden" value="4194b647df2a6b56a8086303d43eac678c8d49cb" name="XID">
    </div>
    other stuff here...
</form> 
```

输入通过 css 隐藏：

```
input[type="hidden"] {
-moz-appearance: none;
-moz-binding: none;
-moz-user-focus: ignore;
border: 0 none;
cursor: auto;
display: none !important;
padding: 0;
} 
```

仅在 IE8 上显示包含 div，尽管它的内容不显示。但它最终会在页面中占据一席之地，这并不好。

不幸的是，我无法修改代码，因为它是在页面呈现时由 CMS 注入的。

我在网上冲浪并阅读了有关 IE8 :hidden 和 :visible bug 的信息：http: [//forum.jquery.com/topic/hidden-visible-broken-in-ie8](http://forum.jquery.com/topic/hidden-visible-broken-in-ie8)

于是我尝试通过js修改代码，注入一些代码使容器div隐藏，但是IE8似乎没有响应：

```
$(".store_product_form div input:hidden").parent().attr("style", "margin:0;padding:0;display:none;"); 
```

关于如何解决这个问题的任何想法？

谢谢！卡罗

# sql-server - 如何使用tsql计算学生的成绩？

> ID：11543443
> 
> 赞同：0
> 
> 时间：2012-07-18T14:15:58.837
> 
> 标签：sql-server, tsql

我有这样的场景，

```
 Studentid|Subject1|Subject2|Subject3|Subject4|Subject5|Grade

   1      |   1    |    1   |   1    |   1    |    1   |
   2      |   1    |    2   |   2    |   2    |    3   |
   .....etc 
```

该表显示了每个科目中的学生 ID 和他们的排名。我想根据以下条件更新成绩列，

1）如果所有科目排名都是1，那么毕业生应该是A 2）如果任何3个排名是1，并且其他2个科目排名为2，那么B 3）如果任何3个排名是2，并且其他2个科目有排名为 3，然后是 c

等等......像这样的许多情况可以来。所以我只想知道解决方法。

是否可以编写单个查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:29:31.570

您可以取消数据透视表来计算成绩：

```
;with 
Subject1 as (
  select Studentid, 1 as SubjectCode, Subject1 as subjectResult
  from your_table
),
Subject2 as (
  select Studentid, 2 as SubjectCode, Subject2 as subjectResult
  from your_table
),
...
Subject5 as (
  select Studentid, 5 as SubjectCode, Subject5 as subjectResult
  from your_table
),
subjects as (
   select * from Subject1 union all
   select * from Subject2 union all
   ...
   select * from Subject5

) 
select 
   Studentid, sum( subjectResult )
from
   subjects
group by
   Studentid 
```

`case`请注意，在最后一次选择中，您可以使用语句计算成绩。您也可以`Grade`通过少量更改升级列：

```
...),
subjects as (
   select * from Subject1 union all
   select * from Subject2 union all
   ...
   select * from Subject5

), 
grades as (
 select 
   Studentid, sum( subjectResult ) as grade
 from
   subjects
 group by
   Studentid
)
update t set grade = grades.grade
from your_table t 
inner join grades on t.Studentid = grades.Studentid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:58:52.953

同意所有其他评论，这是一种存储数据的糟糕方式。但是，如果您被卡住并且必须使用它，那么这样的事情可能会起作用：

```
UPDATE StudentsTable
SET StudentsTable.Grade = CASE 
    WHEN Tally.Total < 8
        THEN 'A'
    WHEN Tally.Total < 13
        THEN 'B'
    ELSE 'C'
    END
FROM StudentsTable AS St
JOIN (
    SELECT StudentID,
    Subject1 + Subject2 + Subject3 + Subject4 + Subject5 AS [Total]
FROM StudentsTable
) AS Tally
    ON St.StudentID = Tally.StudentID 
```

根据需要修改 CASE 语句。它不漂亮，但它应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T18:12:33.773

我使用了 UNPIVOT：

```
CREATE TABLE s
    (
      Studentid INT ,
      Subject1 INT ,
      Subject2 INT ,
      Subject3 INT ,
      Subject4 INT ,
      Subject5 INT ,
      Grade CHAR(1)
    )

INSERT INTO [s] VALUES 
(   1      ,   1    ,    1   ,   1    ,   1    ,    1   , ''),
(   2      ,   1    ,    2   ,   2    ,   2    ,    3   , '')

WITH cte AS (
SELECT u.StudentID, AVG(u.[g]) AS [grade]
from (SELECT * FROM [s]) AS [f]
UNPIVOT (g FOR [SUBJECT] IN (Subject1, Subject2, Subject3, Subject4, Subject5)) AS [u]
GROUP BY u.StudentID
)
UPDATE [s]
SET [Grade] = CASE
    WHEN c.[grade] <=1 THEN 'A'
    WHEN c.[grade] <=2 THEN 'B'
    WHEN c.[grade] <=3 THEN 'C'
    WHEN c.[grade] <=4 THEN 'D'
    ELSE 'F'
END
FROM [cte] AS [c]
INNER JOIN [dbo].[s]
    ON [c].StudentId = [s].[Studentid] 
```

正如其他人所说，你的评分指标有点模棱两可，但我猜了一下。如果不同，请根据需要进行更改。

# java - 在 RIAK 上获取 MapReduce 结果（使用 Java 客户端）

> ID：11543447
> 
> 赞同：1
> 
> 时间：2012-07-18T14:16:05.340
> 
> 标签：java, mapreduce, riak

我在 RIAK 上存储 Person POJO（4 个字符串字段 - id、name、lastUpdate、Data），然后尝试使用 MapReduce 获取这些对象。

我的做法与 Basho 文档非常相似：

```
 BucketMapReduce m = riakClient.mapReduce("person");
    m.addMapPhase(new NamedJSFunction("Riak.mapByFields"), true);
    MapReduceResult result = m.execute();
    Collection<Person> tmp = result.getResult(Person.class); 
```

调用 Person 的 String 构造函数：

```
public Person(String str){} 
```

（我必须有这个构造函数，否则我会因为它丢失而出现异常）在那里我将对象作为字符串 - 一个字符串中的对象字段带有一个奇怪的分隔符。

为什么我没有将对象自动转换为我的 POJO？我真的需要遍历字符串并反序列化它吗？我做错了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T18:40:43.907

您使用的 JS 函数并没有按照您的想法执行 :) 它基于具有特定值的字段选择对象，您必须将其作为参数提供给阶段。

我认为您正在寻找的是`mapValuesJson`哪个会做您似乎想做的事情。

此外，您的 POJO 中根本不需要构造函数。

下面的代码应该为您指明正确的方向（显然这是超级简单的，POJO 中的所有公共字段都没有注释）：

```
public class App {

    public static void main( String[] args ) throws IOException, RiakException
    {
        IRiakClient client = RiakFactory.httpClient();
        Bucket b = client.fetchBucket("test_mr").execute();

        b.store("myobject", new Person()).execute();
        IRiakObject o = b.fetch("myobject").execute();
        System.out.println(o.getValueAsString());

        BucketMapReduce m = client.mapReduce("test_mr");
        m.addMapPhase(new NamedJSFunction("Riak.mapValuesJson"), true);
        MapReduceResult result = m.execute();
        System.out.println(result.getResultRaw());
        Collection<Person> tmp = result.getResult(Person.class);

        for (Person p : tmp)
        {
            System.out.println(p.data);
        }

        client.shutdown();
    }
}

class Person 
{
    public String id = "12345";
    public String name = "my name";
    public String lastUpdate = "some time";
    public String data = "some data";

} 
```

# vb.net - 使用LINQ将父键与二维字典的子键切换

> ID：11543449
> 
> 赞同：1
> 
> 时间：2012-07-18T14:16:07.493
> 
> 标签：vb.net, linq, dictionary, option-strict

我不确定确切的术语，但我尝试使用 LINQ 做的是用它的孩子的键“切换”字典的键。

这是我作为输入得到的集合：

```
Key:HeaderID Value:
 Key:ItemID Value:Object
 Key:ItemID Value:Object
 Key:ItemID Value:Object
Key:HeaderID Value:
 Key:ItemID Value:Object
 Key:ItemID Value:Object
 Key:ItemID Value:Object
Key:HeaderID Value:
 Key:ItemID Value:Object
 Key:ItemID Value:Object
 Key:ItemID Value:Object 
```

这是我想要作为输出的集合：

```
Key:ItemID Value:
 Key:HeaderID Value:Object
 Key:HeaderID Value:Object
 Key:HeaderID Value:Object
Key:ItemID
 Key:HeaderID Value:Object
 Key:HeaderID Value:Object
 Key:HeaderID Value:Object  
Key:ItemID
 Key:HeaderID Value:Object
 Key:HeaderID Value:Object
 Key:HeaderID Value:Object 
```

我已经在 VB.net 中创建了代码：

```
 Dim objInput As Dictionary(Of String, Dictionary(Of String, Object)) = fakefunction()
  ' ItemID -> HeaderID ColumnValue
    Dim objOutput As New Dictionary(Of String, Dictionary(Of String, Object))

    For Each strHeaderID As String In objInput.Keys

        Dim objColumnValuesPerItem As Dictionary(Of String, Object) = objInput(strHeaderID)

        For Each strItemID As String In objColumnValuesPerItem.Keys

            Dim objColumnValue As Object = objColumnValuesPerItem(strItemID)

            If Not objOutput.ContainsKey(strItemID) Then
                objOutput.Add(strItemID, New Dictionary(Of String, Object))
            End If

            objOutput(strItemID).Add(strHeaderID, objColumnValue)

        Next

    Next 
```

我问这个问题的原因是纯粹的教育，我曾尝试使用 LINQ 将其转换为正确的列表，但如果不创建非常复杂且冗长的 LINQ 语句，我将一事无成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:54:39.757

我不知道任何 VB.Net，但我认为这应该做你想要的。

```
Dim objOutput As Dictionary(Of String, Dictionary(Of String, Object)) =
    objInput _
        .SelectMany(Function(oKvp) oKvp.Value.Select(Function(iKvp) New With { _
            .OuterKey = oKvp.Key, _
            .InnerKey = iKvp.Key, _
            .Value = iKvp.Value})) _
        .GroupBy(Function(tri) tri.InnerKey) _
        .ToDictionary( _
            Function(g) g.Key, _
            Function(g) g.ToDictionary( _
                Function(tri) tri.OuterKey, _
                Function(tri) tri.Value)) 
```

基本上，您将整个嵌套字典扁平化为具有键和值的对象序列，然后按内部键对它们进行分组，然后再转换回嵌套字典。

# python - 虽然循环没有中断

> ID：11543454
> 
> 赞同：1
> 
> 时间：2012-07-18T14:16:23.423
> 
> 标签：python, while-loop

下面是一段来自 Python 的代码，它困扰了我一段时间。

```
var=0
while (var <1 or var>100):
    var=raw_input('Enter the block number ')
    if (var >=1 and var<=100):
        print '\nBlock Number : ',var 
    else:
        print 'ERROR!!! Enter again.' 
```

问题是 while 循环不断迭代而不会中断。谁能帮助我如何打破循环。

有什么方法可以在 Python中实现*do..while吗？*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-18T14:17:51.270

问题是`raw_input`返回一个字符串。您正在将字符串与可以在 python 2.x 中执行的整数进行比较（在 python 3 中，这种比较会引发 a `TypeError`），但结果显然总是`False`. 要完成这项工作，您可能需要类似的东西`var=int(raw_input('Enter the block number'))`

从[文档](http://docs.python.org/reference/expressions.html#not-in)中：

> 不同类型的对象总是比较不相等，并且顺序一致但随意。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-18T14:18:29.087

您不必要地检查 var 两次，并且您正在尝试比较 int 和 str （因为 raw_input 返回一个字符串），这不起作用。尝试这个：

```
var=0
while True:
    var=int(raw_input('Enter the block number '))
    if (var >=1 and var<=100):
        print '\nBlock Number : ',var 
        break
    else:
        print 'ERROR!!! Enter again.' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:18:34.123

您应该将字符串转换为 int。

```
var=0
while (var <1 or var>100):
    # I changed here
    var=int(raw_input('Enter the block number '))
    if (var >=1 and var<=100):
        print '\nBlock Number : ',var 
    else:
        print 'ERROR!!! Enter again.' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T14:28:51.913

你好你需要输入“break”并且var应该是一个整数，见下文

```
while True:
var=int(raw_input('Enter the block number '))
if (var >=1 and var<=100):
    print '\nBlock Number : ',var
    break
else:
    print 'ERROR!!! Enter again.'
    continue 
```

希望这可以帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T14:20:24.483

您遇到了一个问题，即字符串（由 返回`raw_input`）总是大于整数：

```
>>> "25" > 100
True 
```

您需要先将输入转换为整数：

```
var = int(raw_input("Enter the block number ")) 
```

当然，面对糟糕的输入，您会希望保持弹性，因此您可能希望将整个事情包装在一个`try`块中。

# php - 分片服务器配置中的 PHP 文件上传

> ID：11543456
> 
> 赞同：5
> 
> 时间：2012-07-18T14:16:26.403
> 
> 标签：php, javascript, file-upload, load-balancing, round-robin

我们使用多个服务器来处理传入的 Web 请求，这些请求以循环方式进行负载平衡。我遇到了一个不知道如何解决的问题。

使用 AJAX ( [qqFileUploader](http://valums.com/ajax-upload/) )，我正在上传一个文件。默认情况下，它进入**/tmp**文件夹，这很好。问题是当我尝试检索该文件时，该检索请求由下一个**没有**我上传的文件的服务器处理。如果我一遍又一遍地重复请求，它最终会到达存储文件的原始服务器（通过循环负载平衡），然后我可以打开它。显然这不是一个好的解决方案。

这里*基本上*是代码：http: [//jsfiddle.net/Ap27Z/](http://jsfiddle.net/Ap27Z/)。为了简洁起见，我删除了一些。您将看到上传器对象调用 PHP 文件进行文件上传，然后在文件上传完成后，对脚本进行另一个 AJAX 调用以处理 .csv 文件。这是该过程在循环中迷失的地方。

我在这里阅读了一些关于将文件上传到内存的问题，似乎目前基本上不可行。我可以使用其他选项来上传文件并在同一个请求中处理它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T14:28:33.760

此类问题的经典解决方案是在负载均衡器上使用粘性会话。这对您来说可能不是一个好的解决方案，因为它会修改您的整个设置以解决一个小问题。

我建议为每台机器添加一个子域前缀，例如上传到 www.example.com，然后为每个服务器分配一个额外的子域 www1.example.com、www2.example.com，它们总是直接传递给该服务器，而不是循环 DNS。

作为成功结果的一部分，您可以传回指向确切服务器的服务器名称，而不是负载平衡名称，然后所有引用上传数据的后续 Ajax 调用都使用该服务器特定的域名，而不是通用负载均衡域名。

> 我可以使用其他选项来上传文件并在同一个请求中处理它吗？

当然，为什么不呢？处理数据 POST 的代码可以做任何你想做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:31:39.980

您的问题有（至少）2个解决方案：

1.  **您更改负载平衡**。

有几个负载平衡代理支持会话亲和性，也就是“粘性会话”。这意味着用户总是在会话中获得相同的服务器。

可以以这种方式运行的两个程序是[HAProxy](http://haproxy.1wt.eu/)（[相关问题在 SO 上](https://stackoverflow.com/questions/6498030/load-balancing-haproxy-or-other-sticky-sessions)）和带有[custon 模块的](https://code.google.com/p/nginx-sticky-module/)[nginx](http://wiki.nginx.org)（[在此处教程](http://opensourcehacker.com/2011/03/21/session-affinity-sticky-with-nginx-load-balancing/)）。

2.  **您可能会遇到文件的位置**。

另一种选择是将存储文件的位置更改为所有服务器都可以通过同一位置访问的某个位置。例如，这可能是 NFS 挂载或数据库（文件存储为 BLOBS）。这样，哪个服务器处理请求并不重要，因为它们都可以访问该文件。

# jquery-mobile - jquery mobile：如何在页面启动时只创建一次动态内容？

> ID：11543460
> 
> 赞同：1
> 
> 时间：2012-07-18T14:16:34.857
> 
> 标签：jquery-mobile

这是我想要做的：

*   使用 Ajax 加载篮子
*   显示“等待”消息
*   加载后，刷新篮子。

当我尝试使用`pageinit`功能时：

```
$(document).bind('pageinit', function(evt) {
    console.log(evt);
} 
```

控制台日志显示它被调用了 29 次！

一切都在一个 HTML 页面上，我`$.mobile.changePage()`用来更改页面。所以我尝试了这个技巧：

```
$(document).bind('pagebeforeshow', function(evt, pg) {
    if (pg.prevPage.length==0) {
        /* first page = code executed once */
        var pg = $('#page-basket'),
            footer = pg.children( ":jqmData(role=footer)" );
        footer.hide().trigger('updatelayout');
        AjaxGetBasket( function(data) { console.log('ajax basket ok'); });
    }
}); 
```

但是布局永远不会更新。

我该如何修改页面，但在开始时只修改*一次*？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:23:33.437

尝试委派`pageinit`事件处理程序，使其仅在`#page-basket`初始化时运行：

```
$(document).on("pageinit", "#page-basket", function() {
    $(this).children(":jqmData(role=footer)").hide().trigger("updatelayout");
    AjaxGetBasket(function(data) {
        console.log("ajax basket ok");
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T11:15:56.303

我不明白您的问题是否已解决，但我处于问题中解释的相同情况，并且我已经解决了将函数绑定到 pagecreate 事件的问题：

```
$(document).bind("pagecreate", function(e){
   // call ajax and update the DOM of first 'page'
}); 
```

就这样。

# c# - 子弹没有出现在类似 Space Invaders 的游戏中

> ID：11543462
> 
> 赞同：0
> 
> 时间：2012-07-18T14:16:45.420
> 
> 标签：c#, xna, xna-4.0

我刚刚开始制作一款有点像太空入侵者的游戏。

在编程方面，我是一个完全的新手，而且经验很少（我只是在尝试这个，因为我需要在下周末完成一个软件设计项目）。

无论如何，我一直在关注如何发射子弹的[教程。](http://www.youtube.com/watch?v=Bytt-enP2yU&feature=related)它似乎没有工作。我已经复制了本教程的几乎所有方面，除了“子弹”类中的“速度”变量（我认为我不需要，因为我只使用左右移动而不是向前/向后）。

这是下面的代码。提前致谢。:)

* * *

**主要的**

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;

namespace Software_Design_Major_Project
{

    public class Game1 : Microsoft.Xna.Framework.Game
    {
        GraphicsDeviceManager graphics;
        SpriteBatch spriteBatch;

        Texture2D ship; // Declaring the sprite
        Vector2 shipposition = Vector2.Zero; 

        List<bullets> bullets = new List<bullets>();
        KeyboardState pastkey;

        public Game1()
        {
            graphics = new GraphicsDeviceManager(this);
            Content.RootDirectory = "Content";

            graphics.PreferredBackBufferWidth = 600; 

        }

        protected override void Initialize()
        {

            base.Initialize();
        }

        protected override void LoadContent()
        {

            spriteBatch = new SpriteBatch(GraphicsDevice);

            ship = Content.Load<Texture2D>("ship"); // Loads the ship into the memory.
            shipposition = new Vector2((graphics.GraphicsDevice.Viewport.Width / 2) -
            (ship.Width / 2), 420);

        }

        protected override void UnloadContent()
        {

        }

        protected override void Update(GameTime gameTime)
        {

            if (Keyboard.GetState(PlayerIndex.One).IsKeyDown(Keys.Left) && shipposition.X
            >= 0) 
            {
                shipposition.X -= 6;
            }
            if(Keyboard.GetState(PlayerIndex.One).IsKeyDown(Keys.Right) && shipposition.X <
            ((graphics.GraphicsDevice.Viewport.Width) - (ship.Width))) 
            {
                shipposition.X += 6;
            }

            if (Keyboard.GetState().IsKeyDown(Keys.Space) && pastkey.IsKeyUp(Keys.Space)) 
            {
                shoot();                
            }
            pastkey = Keyboard.GetState();
            updatebullets();
            base.Update(gameTime);
        }

        public void updatebullets() 
        {
            foreach(bullets bullet in bullets)
            {

                if (Vector2.Distance(bullet.position, shipposition) < 0)
                    bullet.isvisible = false;
            }

            for (int i = 0; i < bullets.Count; i++) 
            {
                if (!bullets[i].isvisible)
                    bullets.RemoveAt(i);
                i--;
            }
        }

        public void shoot() 
        {
            bullets newbullet = new bullets(Content.Load<Texture2D>("bullet"));
            newbullet.position = shipposition;
            newbullet.isvisible = true;

            if (bullets.Count < 20)
                bullets.Add(newbullet);
        }

        protected override void Draw(GameTime gameTime)
        {
            GraphicsDevice.Clear(Color.CornflowerBlue);

            spriteBatch.Begin(SpriteSortMode.BackToFront, BlendState.AlphaBlend); 
            spriteBatch.Draw(ship, shipposition, Color.White);
            spriteBatch.End();

            foreach (bullets bullet in bullets)
                bullet.Draw(spriteBatch);

            base.Draw(gameTime);
        }

    }
} 
```

* * *

**子弹**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Graphics;

namespace Software_Design_Major_Project
{

          class bullets // A new class needs to be created to allow for bullets.
        {
            public Texture2D texture;

            public Vector2 position;
            public Vector2 origin;

            public bool isvisible;

            public bullets(Texture2D newtexture) 
            {
                texture = newtexture;
                isvisible = false;
            }

            public void Draw(SpriteBatch spritebatch) 
            {
                spritebatch.Draw(texture, position, null, Color.White, 0f, origin, 1f, 
                SpriteEffects.None, 0);
            }
    }
} 
```

PS对不起，很长的帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:27:22.770

我没有看到任何改变你的子弹位置的代码，你需要一个速度变量，并根据每帧的速度更新位置。

你可以从 a = Math.Atan(Y,X) 得到角度

看起来您可能删除了计算位置的部分，因为您认为您不需要速度的东西。我建议您尝试将其重新添加以查看它是否有效，然后删除您不需要的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-14T05:47:46.177

让没有人更早发现这一点感到惊讶。在绘制子弹之前，您将结束 SpriteBatch。对 SpriteBatch.Draw 的调用必须发生在 Begin 和 End 方法之间，因为在幕后进行的所有工作都是为了使绘图尽可能快。您需要做的就是将 spriteBatch.End() 进一步向下移动，如下所示：

```
protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);

        spriteBatch.Begin(SpriteSortMode.BackToFront, BlendState.AlphaBlend);
        spriteBatch.Draw(ship, shipposition, Color.White);

        foreach (bullets bullet in bullets)
            bullet.Draw(spriteBatch);

        spriteBatch.End(); //Move to here instead

        base.Draw(gameTime);
    } 
```

额外琐事：基本上幕后发生的事情是精灵批处理实际上使用 begin 描述的设置对纹理进行批处理（是的，这些可以更改）然后当 end 被调用时，它会计算出哪些位落在屏幕之外并注意不要绘制它们，如果被告知，它会对纹理进行深度排序，它会在将它们绘制到后台缓冲区之前进行各种其他优化，然后最后当所有绘图结束时，后台缓冲区会呈现到屏幕上，然后旧的被拿走并重新用于下一次绘制调用。听起来工作量很大，但随着现代计算机的工作方式，优化往往会带来很大的改进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:32:50.337

你可以在这里查看这个样本。我很久以前就写过这个东西了，我想在XNA的v2.0中，现在想不起来了。

[http://gozoomin.com/media/p/69699.aspx](http://gozoomin.com/media/p/69699.aspx)

那里的逻辑很简单:)

开始制作“经典”总是一个好的开始。

编辑 - 你也可以在这里得到它：[http](http://www.sendspace.com/file/r4s4um) ://www.sendspace.com/file/r4s4um Edit2 - 我现在刚刚检查了代码，它有一些注释记录了大部分内容，可能你会得到一些用葡萄牙语写的东西. PS - 不要复制过去的代码！尝试学习有关示例的基础知识。

# android - Android - 复制文件（同时）

> ID：11543466
> 
> 赞同：1
> 
> 时间：2012-07-18T14:16:52.380
> 
> 标签：android

我目前正在为 android 开发一个基本的文件浏览器。我有一个用于复制文件的工作版本，但是当它通过目录工作时，它会复制它找到的文件。我想更改它，以便在开始复制之前找到所有文件的总大小，以帮助获得更好的进度条。

如果有另一种方法来查找目录的总大小及其所有内容？

这是我当前的版本。我无法更改此设置，我尝试使用 arrayList 但是当我尝试在最后复制文件时，我认为他们试图以错误的顺序复制。

```
public void copyDirectory(File sourceLocation , File targetLocation) throws IOException {
        if (sourceLocation.isDirectory()) {
            if (!targetLocation.exists() && !targetLocation.mkdirs()) {
                throw new IOException("Cannot create directory: " + targetLocation.getAbsolutePath());
            }

            String[] children = sourceLocation.list();
            for (int i = 0; i < children.length; i++) {
                copyDirectory(new File(sourceLocation, children[i]),
                        new File(targetLocation, children[i]));
            }
        } else {                
            File directory = targetLocation.getParentFile();
            if (directory != null && !directory.exists() && !directory.mkdirs()) {
                throw new IOException("Cannot create directory: " + directory.getAbsolutePath());
            }

            FileInputStream in = new FileInputStream(sourceLocation);
            FileOutputStream out = new FileOutputStream(targetLocation);

            long fileLength = sourceLocation.length();

            byte[] buf = new byte[1024];
            long total = 0;
            int len;
            while ((len = in.read(buf)) > 0) {
                out.write(buf, 0, len);
                total += len;
                publishProgress((int) (total * 100 / fileLength));
            }
            in.close();
            out.close();
        }
    } 
```

**解决方案**

jtwigg的回答也应该有效。我只是想我会添加我找到的解决方案。无法回答我自己的问题，所以我将其放在这里。

遍历目录中的所有文件并保持运行总数似乎可行。虽然它需要先循环大小，然后再实际复制文件。只需在调用 copyDirectory() 之前使用要复制的文件或目录调用 getDirectorySize()。

```
private void getDirectorySize(File sourceLocation) throws IOException {
        if (sourceLocation.isDirectory()) {
            String[] children = sourceLocation.list();
            for (int i = 0; i < children.length; i++) {
                getDirectorySize(new File(sourceLocation, children[i]));
            }
        } else {
            totalFileSize += sourceLocation.length();
        }
} 
```

该函数将需要全局 long totalFileSize，然后只需要替换：

```
publishProgress((int) (total * 100 / fileLength)); 
```

和：

```
publishProgress((int) (total * 100 / totalFileSize)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:58:21.563

如果我理解正确，您希望找到目录中所有文件的总大小，然后复制它们。我会创建另一个函数，例如：

```
public void beginCopy(File source, File destination)
{
    ArrayList<PendingFile> filesToCopy = new ArrayList<PendingFile>();
    long totalSize = copyDirectory(source, destination, filesToCopy);
    // totalsize now contains the size of all the files
    // files to copy now contains a list of source and destination files

    // now modifying your copy method we can copy all the files
    long totalThusFar = 0;
    for (PendingFile pending : filesToCopy)
    {
        FileInputStream in = new FileInputStream(pending.source);
        FileOutputStream out = new FileOutputStream(pending.destination);

        long fileLength = sourceLocation.length();

        byte[] buf = new byte[1024];
        int len;
        while ((len = in.read(buf)) > 0) {
            out.write(buf, 0, len);
            totalThusFar += len;
            publishProgress((int) (total * 100 / totalsize));
        }
        in.close();
        out.close();
    }
} 
```

您将需要一个 PendingFile 类/结构来保存源和目标。您将在复制方法中将它们添加到 ArrayList 中，如下所示：

```
public long copyDirectory(File sourceLocation , File targetLocation, ArrayList list) throws IOException {
    if (sourceLocation.isDirectory()) {
        if (!targetLocation.exists() && !targetLocation.mkdirs()) {
            throw new IOException("Cannot create directory: " + targetLocation.getAbsolutePath());
        }

        String[] children = sourceLocation.list();
        long totalSize = 0;
        for (int i = 0; i < children.length; i++) {
            totalSize += copyDirectory(new File(sourceLocation, children[i]),
                    new File(targetLocation, children[i]), list);
            return totalSize;
        }
    } else {                
        File directory = targetLocation.getParentFile();
        if (directory != null && !directory.exists() && !directory.mkdirs()) {
            throw new IOException("Cannot create directory: " + directory.getAbsolutePath());
        }

        list.add(new PendingFile(sourceLocation, targetLocation));
        return sourceLocation.length;
    }
} 
```

我刚刚写了所有这些，所以它可能不会立即工作，但我认为你应该能够让它与它一起工作。祝你好运！

# android - 已经添加：Lcom/android/vending/billing/IMarketBillingService$Stub for android project with maven under intellij?

> ID：11543469
> 
> 赞同：0
> 
> 时间：2012-07-18T14:17:01.940
> 
> 标签：android, maven, intellij-idea

当我尝试在 intellij 11.1.2 中构建 android 项目时出现错误

`java.lang.IllegalArgumentException: already added: Lcom/android/vending/billing/IMarketBillingService$Stub;`

这个项目是建立在 maven pom 文件上的。在我将依赖项添加到 Android 计费库后，它开始发生：

```
<dependency>
        <groupId>com.codeslap</groupId>
        <artifactId>android-billing-library</artifactId>
        <version>1.0.0</version>
        <type>apklib</type>
</dependency> 
```

如果我`mvn package`在控制台中执行它工作正常。问题仅存在于 intellij 构建中。

Intellij`IMarketBillingService`在类路径中添加了 2 个位置，如下面的链接所示。 [https://skitch.com/ukache/e8ppd/pom.xml-gopro-gopro-projects-labs-mobile-android-gopro](https://skitch.com/ukache/e8ppd/pom.xml-gopro-gopro-projects-labs-mobile-android-gopro)

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:20:12.130

检查一个库（jar 文件）是否没有在你的 Android 项目中添加两次

# mysql - Mysql查询大表

> ID：11543470
> 
> 赞同：0
> 
> 时间：2012-07-18T14:17:02.723
> 
> 标签：mysql

我有一张大约有 1 千万条记录的表格。

必需：我需要触发一个查询，该查询将从该表中获取 login_date 小于 6 个月的记录（产生 5 条 lacs 记录）和某些条件，查询大约需要 60 秒。

考虑：如果我将过去 6 个月的登录日期记录保存在一个单独的表中，那么查询只需要 1 到 2 秒。

解决方案 ？我应该使用触发器创建一个单独的表吗？或任何其他更好的解决方案更好....喜欢视图或类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:23:59.220

您是否在此表上使用[索引？](http://dev.mysql.com/doc/refman/5.0/en/create-index.html "指数")在 login_date 上创建 btree 索引应该会给您提供与拥有第二个没有架构复杂性的表相同的性能。

此外，crore 和 lac 不是很常见的英语单词。试试“千万”和“五十万”，应该会有更多人明白你的意思。

# android - 更改 Preference 活动的外观

> ID：11543472
> 
> 赞同：2
> 
> 时间：2012-07-18T14:17:19.460
> 
> 标签：android, android-layout, android-fragments, android-preferences

> **可能重复：**
> [PreferenceActivity 和主题不适用](https://stackoverflow.com/questions/2615528/preferenceactivity-and-theme-not-applying)

我正在创建具有 2 个窗格的首选项屏幕，一个用于标题，一个用于相应的片段。

但我想改变这些偏好的布局。对于片段，我知道该怎么做。

但我不知道如何在这里更改首选项标题的布局。而且也找不到任何相关文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:44:53.853

您是否尝试过使用样式和主题来自定义您的偏好活动？

[http://developer.android.com/guide/topics/ui/themes.html](http://developer.android.com/guide/topics/ui/themes.html)

# jquery - 网站正在自行重新加载

> ID：11543473
> 
> 赞同：0
> 
> 时间：2012-07-18T14:17:21.253
> 
> 标签：jquery, load, reload, getjson

我有以下站点，它会回调到不同的域。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title> Example Entry Form </title>

    <script src="http://code.jquery.com/jquery-1.7.2.js" type="text/javascript"></script>
    <script type="text/javascript">
    function getParameters(){
        // login
        //window.showModalDialog('http://localhost:8080/test/login/check.mvc','','dialogWidth:500px; dialogHeight:350px; resizable:no; unandorned:yes; status:no; ');
        //get data
        $.getJSON('http://localhost:8080/test/secure/profile/services/export/getuser.mvc?callback=?',function(res){
            alert('Your name is '+res.lname);
            $('#lastname').val(res.lname);
            $('#firstname').val(res.fname);
            $('#club').val(res.club);
            $('#phone').val(res.phone);
            $('#mobile').val(res.mobile);
            $('#mail').val(res.email);
            $('#street_nr').val(res.streetNr);
            $('#zip_city').val(res.zip + " " + res.city);
            $('#birthday').val(res.birthday);
        })
        .error(function(){
            alert("Error");
        })
        .complete(function(){
            alert("Complete");
        });
        alert("Script End!");
    }
    </script>
</head>

<body >

    <h1>Entry Form</h1>

    <table>
     <tr>
      <td style="width:400px;">
        <form action="save.php" id="FormName">
            <table>
                <tr>
                    <td>Lastname:</td>
                    <td><input type="text" id="lastname"/></td>
                </tr><tr>
                    <td>Firstname:</td>
                    <td><input type="text" id="firstname"/></td>
                </tr><tr>
                    <td>Club:</td>
                    <td><input type="text" id="club"/></td>
                </tr><tr>
                    <td>Mobile:</td>
                    <td><input type="text" id="mobile"/></td>
                </tr><tr>
                    <td>Telephone:</td>
                    <td><input type="text" id="phone"/></td>
                </tr><tr>
                    <td>eMail:</td>
                    <td><input type="text" id="mail"/></td>
                </tr><tr>
                    <td>Street+Nr:</td>
                    <td><input type="text" id="street_nr"/></td>
                </tr><tr>
                    <td>ZIP+City:</td>
                    <td><input type="text" id="zip_city"/></td>
                </tr><tr>
                    <td>Birthday:</td>
                    <td><input type="text" id="birthday"/></td>
                </tr><tr>
                    <td>&nbsp;</td>
                    <td><button type="submit">Send Form</button>
                </tr>
            </table>
        </form>
      </td>
      <td valign="top">
        <a href="" onclick="getParameters();"><img src="script/pic.png" alt="Get Data"/></a>
      </td>
     </tr>
    </table>
</body>
</html> 
```

所述脚本工作正常，除了两个主要问题：

1.  它仅在有 alert() 时才有效；在脚本中，它不在 &.getJSON() 函数中。
2.  在最后一个警报（）之后；触发（“脚本结束！”）站点正在重新加载（浏览器显示：http: [//code.jquery.com/](http://code.jquery.com/) -> jquery 脚本）并在完成后。所有数据都没了。

为什么？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:29:21.210

您的页面正在重定向，因为您的标签有一个空的 href 并且您的函数没有阻止您的页面重定向。

它与警报一起使用，因为警报会阻止窗口重定向，直到您按确定。

正如迈克尔建议的那样，尝试使用 return false。

但是使用 onClick 是一种不好的做法。

或者，您可以使用 jQuery 绑定（这是最佳实践）绑定点击处理程序。

像这样更新您的html：

```
<td valign="top">
        <a href='#' id='someButton'><img src="script/pic.png" alt="Get Data" /></a>
      </td> 
```

然后在脚本标签中，执行以下操作：

```
 $('#someButton').bind('click', getParameters); 
```

在你的函数中这样做：

```
function getParameters(e){
 ..... // your code here
 e.stopPropagation();
 e.preventDefault();'
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:22:41.317

尝试`onclick="return getParameters();"`替换`alert`为`return false;`（或者是真的吗？）

或将`a`标签替换为`span`. 或者完全删除它并添加`onclick`到`img`.

现在发生的事情是您启动异步请求并继续执行单击链接时通常会执行的操作。

# c# - 删除不是 ASCII 32 到 175 C# 的字符的更好方法

> ID：11543474
> 
> 赞同：8
> 
> 时间：2012-07-18T14:17:25.793
> 
> 标签：c#, regex, string, linq

我需要从不在 Ascii 32 到 175 范围内的字符串中删除字符，其他任何内容都必须删除。

我不太清楚 RegExp 是否可以成为最好的解决方案，而不是使用 .replace() 或 .remove() 之类的东西来粘贴每个无效字符或其他东西。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-18T14:18:50.757

您可以使用

```
Regex.Replace(myString, @"[^\x20-\xaf]+", ""); 
```

这里的正则表达式由一个字符类 ( ) 组成，它由U+0020 到 U+00AF（32-175，以十六进制表示）范围内的`[...]`所有字符组成，*而不是*（在类的开头）。`^`就正则表达式而言，这是相当基本的，但可能会让不太熟悉它的人感到困惑。

但你也可以走另一条路：

```
new string(myString.Where(c => (c >= 32) && (c <= 175)).ToArray()); 
```

这可能主要取决于您更喜欢阅读什么。如果没有太多的正则表达式经验，我会说第二个会更清楚。

一些性能测量，每个 10000 轮，以秒为单位：

```
2000 characters, the first 143 of which are between 32 and 175
  Regex without +                          4.1171
  Regex with +                             0.4091
  LINQ, where, new string                  0.2176
  LINQ, where, string.Join                 0.2448
  StringBuilder (xanatos)                  0.0355
  LINQ, horrible (HatSoft)                 0.4917
2000 characters, all of which are between 32 and 175
  Regex without +                          0.4076
  Regex with +                             0.4099
  LINQ, where, new string                  0.3419
  LINQ, where, string.Join                 0.7412
  StringBuilder (xanatos)                  0.0740
  LINQ, horrible (HatSoft)                 0.4801 
```

所以是的，我的方法是最慢的:-)。您可能应该使用 xanatos 的答案，并将其包装在一个具有漂亮、清晰名称的方法中。对于内联使用或快速而肮脏的事情或性能无关紧要的地方，我可能会使用正则表达式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-18T14:21:19.193

因为我认为，如果您不知道如何编写正则表达式，则不应使用它，尤其是对于如此简单的事情：

```
var sb = new StringBuilder();

foreach (var c in str)
{
    if (c >= 32 && c <= 175)
    {
        sb.Append(c);
    }
}

var str2 = str.ToString(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-18T14:20:06.450

使用正则表达式`[^\x20-\xAF]+`并将其替换为空字符串`""`

```
Regex.Replace(str, @"[^\x20-\xAF]+", ""); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T14:37:06.363

以这种方式使用linq怎么样

```
string text = (from c in "AAA hello aaaa #### Y world" 
               let i = (int) c where i < 32 && i > 175 select c)
              .Aggregate("", (current, c) => current + c); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-19T04:09:11.467

```
static unsafe string TrimRange(string str, char from, char to)
{
    int count = 0;

    for (int i = 0; i < str.Length; i++)
    {
        char ch = str[i];

        if ((ch >= from) && (ch <= to))
        {
            count++;
        }
    }

    if (count == 0)
        return String.Empty;

    if (count == str.Length)
        return str;

    char * result = stackalloc char[count];

    count = 0;

    for (int i = 0; i < str.Length; i++)
    {
        char ch = str[i];

        if ((ch >= from) && (ch <= to))
        {
            result[count ++] = ch;
        }
    }

    return new String(result, 0, count);
} 
```

# drupal - Drupal Commerce + 分类

> ID：11543476
> 
> 赞同：2
> 
> 时间：2012-07-18T14:17:35.263
> 
> 标签：drupal, drupal-7, drupal-commerce

我想为我的产品创建一个基于分类的目录。第一步是为我的产品创建分类树：

*   第一学期
    *   第 1.1 条
    *   第 1.2 条
*   第二学期
    *   第 2.1 条
*   第三学期

但是我需要创建我的产品目录页面。问题实际上是哪种技术最能满足我的需要。在我的产品页面顶部，我想列出我所有的父项（第 1 项、第 2 项和第 3 项）以及该类别或其子类别中列出的产品的数量。当我单击这样的术语时，我需要它来过滤掉我的产品列表以仅显示带有该术语或其中一个子术语标记的产品。

实现这种功能的最佳实践是什么？我是使用分类菜单还是生成一些视图并使它们相互通信（例如通过与获取参数的链接）？

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-23T14:35:22.300

正如 Clive 建议的那样，这一块可以使用 Views 来实现。但是，如果您想要更多，您应该查看可用于实现分面搜索接口的[facet API模块。](https://drupal.org/project/facetapi)

# iframe - iFrame - 如何加载用户刚刚来自的页面？

> ID：11543481
> 
> 赞同：0
> 
> 时间：2012-07-18T14:17:48.430
> 
> 标签：iframe

我在网页上有一个 iFrame，在所有其他页面上我有一个按钮说“讨论”。当用户单击此按钮时，它会将他们带到 iframe 页面。

我想知道如何让 iframe 显示用户刚刚来自的页面？即带有讨论按钮的页面。

这样最终用户将能够通过在 iframe 中查看该页面来讨论该页面。

在此先感谢，丹尼尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T15:45:00.963

下面是一个例子。两个文件必须在同一个目录中。

`mainpage.html`：

```
<html>
  <body>
    <script>
      function gotoFramePageNormal() {
        window.open('framepage.html', '_top');
      }
      function gotoFramePageWithVar() {
        window.open('framepage.html?ref='+document.location.href, '_top');
      }
    </script>
    <input type=button value="Discuss" onclick="gotoFramePageNormal()" /> (normal referrer; via HTTP header)<br />
    <br />
    <input type=button value="Discuss" onclick="gotoFramePageWithVar()" /> (with URL variable referrer)<br />
  </body>
</html> 
```

`framepage.html`：

```
<html>
  <body>
    <div>
      Source: <span id="srcurl">...</span>
    </div>
    <iframe id="theframe" width=800 height=600></iframe>
    <script>
      (function() {
        if (document.referrer=='') { //no referrer
          //parse URL variables
          var a=document.location.search,b,c;
          while ( (a.length>0) && (a[0]=='?') ) a=a.substring(1,a.length);
          //split variables
          a=a.split('&');
          //check each variable
          for (b=0; b<a.length; b++) {
            //split name and value
            c=a[b].split('=');
            if (c[0].toLowerCase()=='ref') {
              //show source url
              srcurl.innerText=decodeURI(c[1]);
              //set iframe source
              theframe.location.href=decodeURI(c[1]);
              return;
            }
          }
          //show no source url
          srcurl.innerText='none';
        } else { //has referrer
          //show source url
          srcurl.innerText=document.referrer;
          //set iframe source
          theframe.location.href=document.referrer;
        }
      })();
    </script>
  </body>
</html> 
```

使用`mainpage.html`URL 变量将源页面传递给框架页面。通常，这是由网络浏览器自动完成的，但它不够可靠，因为用户可以禁用该功能。将`framepage.html`使用这两种方法来检测源页面 URL。

# mysql - SQL 全文匹配值仅返回匹配项的布尔值（1 或 0）

> ID：11543483
> 
> 赞同：0
> 
> 时间：2012-07-18T14:17:57.010
> 
> 标签：mysql, match, full-text-search

我有以下 SQL 语句：

```
SELECT
    g.*,
        (
            MATCH (g.GameTitle) AGAINST ('call of duty')
            OR g.GameTitle SOUNDS LIKE 'call of duty'
        )
    AS MatchValue,
    p.id AS platformid,
    p.alias AS PlatformAlias,
    p.name,
    p.icon
FROM
    games AS g,
    platforms AS p
WHERE
    (
        (
            MATCH (g.GameTitle) AGAINST ('call of duty')
            OR g.GameTitle SOUNDS LIKE 'call of duty'
        )
        OR
        (
            MATCH (g.Alternates) AGAINST ('call of duty')
            OR g.Alternates SOUNDS LIKE 'call of duty'
        )
    )

AND g.Platform = p.id
ORDER BY MatchValue DESC 
```

它在与全文索引匹配时返回一组正确的结果，但是报告的“MatchValue”仅具有布尔性质（0 或 1）。

如果我删除语句的第 5 行：

```
OR g.GameTitle SOUNDS LIKE 'call of duty' 
```

我得到了不错的匹配值，范围从大约 5.23 到 15.56，但是在匹配“替代”时我失去了一些功能。

我对 SQL 并不精通，我花了好几天的时间才让它运行得这么好......

有没有办法让第 5 行和第 6 行返回一个非布尔匹配值，以便我的结果正确排序？

提前致谢 ;）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:45:39.447

When you say `'ABC' OR (3 > 2)` you are asking for a `BOOL` result. You cannot either get a string or a boolean. In the above case, the string `'abc'` translates to boolean **0**, since it does not represent a number.

Since it does not make much sense in `OR`ing a string and a boolean, I would separate the two:

```
SELECT
    g.*,
        (
            MATCH (g.GameTitle) AGAINST ('call of duty')
            OR g.GameTitle SOUNDS LIKE 'call of duty'
        )
    AS MatchResultBoolean,
    MATCH (g.GameTitle) AGAINST ('call of duty') AS MatchText,
    p.id AS platformid,
    p.alias AS PlatformAlias,
    p.name,
    p.icon
FROM
    games AS g,
    platforms AS p
WHERE
    (
        (
            MATCH (g.GameTitle) AGAINST ('call of duty')
            OR g.GameTitle SOUNDS LIKE 'call of duty'
        )
        OR
        (
            MATCH (g.Alternates) AGAINST ('call of duty')
            OR g.Alternates SOUNDS LIKE 'call of duty'
        )
    )

AND g.Platform = p.id
ORDER BY MatchValue DESC 
```

Note the change:

```
 (
            MATCH (g.GameTitle) AGAINST ('call of duty')
            OR g.GameTitle SOUNDS LIKE 'call of duty'
        )
    AS MatchResultBoolean,
    MATCH (g.GameTitle) AGAINST ('call of duty') AS MatchText, 
```

This way you get it both ways: one time you get the boolean value, in a nother column you get the (possible) match.

# android - InAppBilling 问题

> ID：11543495
> 
> 赞同：1
> 
> 时间：2012-07-18T14:18:38.413
> 
> 标签：android, in-app-billing

当我实现 InAppBilling 时，会出现以下屏幕。我使用了这个链接

*   [http://blog.blundell-apps.com/simple-inapp-billing-payment/](http://blog.blundell-apps.com/simple-inapp-billing-payment/)

用于实施 InAppBilling

所以我错在哪里？

![在此处输入图像描述](../Images/6f982dfc37ee7079b708dcd3d04e7031.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:20:09.083

可能是你直接从 eclipse 运行这个应用程序。

每当您在应用中使用应用内购买时。

导出**已签名的 APK**然后试试这个...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:22:29.757

您很可能正在使用使用调试密钥签名的应用程序版本，或者您尝试使用不允许的开发者帐户进行购买。

您还应该已将具有计费权限的 apk 上传到 Play 商店（尽管您不需要发布它）

您需要使用您的发布密钥签署您的 apk。尝试在调试模式下购买是行不通的。

有关完整的测试说明，请参阅此链接。 [http://developer.android.com/guide/google/play/billing/billing_testing.html](http://developer.android.com/guide/google/play/billing/billing_testing.html)

# google-fusion-tables - Fusion Table API 错误，无法处理在数字字段上具有相等性的 WHERE 子句？

> ID：11543518
> 
> 赞同：0
> 
> 时间：2012-07-18T14:19:50.523
> 
> 标签：google-fusion-tables

我从 FusionTable API 得到奇怪的结果。具体来说，它似乎无法处理对数值具有相等约束的简单选择语句。我尝试以下形式的任何查询：

[从 1Nynh5pPrj1q8JqbalppAm-qzAsgKvL0ZRala7VI 中选择 COUNT()，其中 AGE=41](https://www.googleapis.com/fusiontables/v1/query?sql=SELECT+COUNT%28%29+FROM+1Nynh5pPrj1q8JqbalppAm-qzAsgKvL0ZRala7VI+WHERE+AGE%3D41&key=AIzaSyBT_ZCriV-Tm78KsJiQp6KKhjDwMhP0tYM)

产生零记录：

```
{
 "kind": "fusiontables#sqlresponse",
 "columns": [
  "count()"
 ],
 "rows": [
  [ "0" ]
 ]
} 
```

相比之下，范围约束可以正常工作：

[从 1Nynh5pPrj1q8JqbalppAm-qzAsgKvL0ZRala7VI 中选择 COUNT()，其中 AGE>40.99 AND AGE<41.01](https://www.googleapis.com/fusiontables/v1/query?sql=SELECT+COUNT%28%29+FROM+1Nynh5pPrj1q8JqbalppAm-qzAsgKvL0ZRala7VI+WHERE+AGE+%3E40.99+AND+AGE%3C41.01&key=AIzaSyBT_ZCriV-Tm78KsJiQp6KKhjDwMhP0tYM)

```
{
 "kind": "fusiontables#sqlresponse",
 "columns": [
  "count()"
 ],
 "rows": [
  [  "362" ]
 ]
} 
```

也许下面的数字不是整数？ [从 1Nynh5pPrj1q8JqbalppAm-qzAsgKvL0ZRala7VI 中选择 AGE>40.99 AND AGE<41.01](https://www.googleapis.com/fusiontables/v1/query?sql=SELECT+AGE+FROM+1Nynh5pPrj1q8JqbalppAm-qzAsgKvL0ZRala7VI+WHERE+AGE%3E40.99+AND+AGE%3C41.01&key=AIzaSyBT_ZCriV-Tm78KsJiQp6KKhjDwMhP0tYM)返回

```
{
 "kind": "fusiontables#sqlresponse",
 "columns": [
  "AGE"
 ],
 "rows": [
  [ "41" ],
  [ "41" ],
  [ "41" ],
  ...359 more...
]} 
```

现在，也许有一些浮点表示错误正在发生？我认为小整数可以精确地表示为浮点数（即使某些小数，例如 0.1，在二进制中重复小数）。

Fusion Table SQL 中的错误似乎不太可能在不被其他人发现的情况下通过，所以也许[这个特定的 FusionTable](https://www.google.com/fusiontables/DataSource?docid=1Nynh5pPrj1q8JqbalppAm-qzAsgKvL0ZRala7VI)的加载方式有一些独特之处？

**更新：**

虽然使用上面的新 Fusion Table API 查询似乎失败，但使用旧的 Fusion Table SQL API（最近已弃用）成功： [www.google.com/fusiontables/api/query ?sql=SELECT%20COUNT()%20FROM% 204579147%20WHERE%20AGE%20LIKE%2041](http://www.google.com/fusiontables/api/query?sql=SELECT%20COUNT%28%29%20FROM%204579147%20WHERE%20AGE%20LIKE%2041)

返回此 JSON 响应：

```
count()
362 
```

此外，新的 FusionTable API 似乎被数值混淆了：

*   `SELECT COUNT() FROM 4579147 WHERE AGE = 41` 产量`0`（不正确）

*   `SELECT COUNT() FROM 4579147 WHERE AGE = "41"` 产量`0`（不正确）

*   `SELECT COUNT() FROM 4579147 WHERE AGE MATCHES 41` 产量`362`

*   `SELECT COUNT() FROM 4579147 WHERE AGE LIKE 41` 产量`362`

*   `SELECT COUNT() FROM 4579147 WHERE AGE LIKE "41"` 产量`362`

*   `SELECT COUNT() FROM 4579147 WHERE AGE LIKE "%41%"` 产量`362`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:48:24.627

该表中的 AGE = 41 没有任何问题： [https ://www.google.com/fusiontables/DataSource?snapid=S580613IY6U](https://www.google.com/fusiontables/DataSource?snapid=S580613IY6U)

关于 count() 的某些事情导致查询失败

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T17:56:34.540

这是最近引入的错误，将很快修复。如前所述，它只影响聚合的数值相等查询。带来不便敬请谅解！

# php - MS DOS 命令行输出重定向到文件不产生输出

> ID：11543522
> 
> 赞同：1
> 
> 时间：2012-07-18T14:20:04.683
> 
> 标签：php, r, dos, stdout, io-redirection

考虑两种情况 a) 关闭输出重定向和 b)Rscript 输出重定向到文件 out.txt 两种情况下在 STDOUT 中看到的输出都无法重定向到文件 out.txt 仅在场景 b 中。我在这里遗漏了什么还是 Rscript.exe 特有的？

```
C:\>C:\\WINDOWS\\system32\\shutdown.exe -t:30 > out.txt

C:\>dir out.txt
 Volume in drive C has no label.
 Volume Serial Number is 3568-1B07

 Directory of C:\

07/18/2012  07:43 PM               841 out.txt
               1 File(s)            841 bytes
               0 Dir(s)  17,618,206,720 bytes free

C:\>G:\\Progra~1\\R\\R-2.14.0\\bin\\Rscript.exe --version > out.txt
R scripting front-end version 2.14.0 (2011-10-31)

C:\>dir out.txt
 Volume in drive C has no label.
 Volume Serial Number is 3568-1B07

 Directory of C:\

07/18/2012  07:44 PM                 0 out.txt
               1 File(s)              0 bytes
               0 Dir(s)  17,618,239,488 bytes free 
```

关于为什么 Rscript.exe 输出没有被重定向到文件 out.txt 的任何想法或解释？也许等待一个非常简单的解释。

感谢您，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:30:05.700

您不能使用重定向来获取版本信息，但可以将重定向用于实际的 R 命令。例如，如果您的文件`a.r`中只有一个命令，如下所示`1+1`：

```
Rscript a.r > out.txt 
```

将显示结果。我认为这与`R`将版本信息发送到的“输出”有关。我认为它是输出到 STDERR 而不是 STDOUT（或 DOS 中的等效概念），因此重定向不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:30:30.247

答案很简单。版本信息被写入 STDERR（标准错误流），但您只是重定向 STDOUT（标准输出）。如果你想两者都去文件，然后使用

```
G:\\Progra~1\\R\\R-2.14.0\\bin\\Rscript.exe --version >out.txt 2>&1 
```

# c# - C# 中的 Google 云消息传递服务器端代码

> ID：11543527
> 
> 赞同：14
> 
> 时间：2012-07-18T14:20:18.463
> 
> 标签：c#, google-cloud-messaging

我想使用 .Net 为 android 编写实现 GCM（Google Cloud Messaging）的第 3 方服务器。官方文档提供了将其与 servlet-api 和 gcm-server.jar （服务器端的 Java 助手）一起使用的指南。

在 C# 中使用它有什么等价物吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-12T13:12:15.983

Google Cloud Messaging 客户端库已移植到 C#： [https ://github.com/Redth/GCMSharp](https://github.com/Redth/GCMSharp)

同一位开发人员制作了一个库，用于向 iOS、Android、Windows Phone 和 Blackberry 发送服务器端推送通知： [https ://github.com/Redth/PushSharp](https://github.com/Redth/PushSharp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:28:12.427

如果你不热衷于重写整个事情，也许[IKVM.NET](http://www.ikvm.net/)会有所帮助？它是一个用于 .NET 的 Java 虚拟机，并且还具有用于 Java-.NET 互操作性的工具。

希望这可以帮助！

# android - 安卓。在 ImageView 中加载图像

> ID：11543535
> 
> 赞同：0
> 
> 时间：2012-07-18T14:20:36.963
> 
> 标签：android

在 ImageView 中加载图像的最佳方法是什么？我目前正在`.setImageResource()`这样做，但我听说'.setBitmap（）'更好，因为你可以让它在调整大小之前不将整个图像加载到内存中。这篇文章：[将图像加载到位图对象时出现奇怪的内存不足问题](https://stackoverflow.com/questions/477572/android-strange-out-of-memory-issue-while-loading-an-image-to-a-bitmap-object/823966#823966)

从设备内存的角度来看，哪个是最好的？哪个占用的内存更少，哪个对设备的“压力”最小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:22:01.037

重新调整大小后将图像放在图像视图中是最好的，因为它可以避免内存问题。setBitmap() 更好。

如果你只有一两张图片，那么 .setImageResource 就足够了。但是，如果您有更多不同大小的图像，则 setBitmap() 会更好。

从设备内存的角度来看，哪个是最好的？- 同一个..哪个占用更少的内存，哪个“压力”最小？- 一样的！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:25:07.697

一般来说，尽量不要将 setImageResource() 用于较大的图像，因为这是在 UI 线程上执行的（这可能会导致 UI 滞后）。

至于加载位图，我[强烈推荐 Google 的这个指南](http://developer.android.com/training/displaying-bitmaps/index.html)。它涵盖了异步加载、使用缓存、一般加载等等。该教程是在过去几个月内发布的，因此使用了当前的最佳实践。

# iphone - 如何向推送通知警报视图添加操作？

> ID：11543537
> 
> 赞同：0
> 
> 时间：2012-07-18T14:20:39.930
> 
> 标签：iphone, ios, ipad, push-notification

我有一个应用程序，我在其中添加推送通知。我将推送通知显示为 aletview。有两个按钮视图和取消。当用户单击视图按钮时，我需要转到特定的视图控制器。任何人都可以帮忙我实现了这一点？这就是我处理通知的方式。

```
- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo {

    NSLog(@"########################################didReceiveRemoteNotification****************************###################### %@",userInfo);
    //check application in forground or background
    if(application.applicationState == UIApplicationStateActive)
    {
        //NSLog(@"FOreGround");
        //////NSLog(@"and Showing %@",userInfo)
    }
    else {

        NSDictionary *curDict= [userInfo objectForKey:@"aps"];
        UIAlertView *connectionAlert = [[UIAlertView alloc] initWithTitle:@"app" message:[NSString stringWithFormat:@"%@",[curDict objectForKey:@"alert"]] delegate:self cancelButtonTitle:@"View" otherButtonTitles:@"Cancel",nil];
        [connectionAlert show];
        [connectionAlert release];
        [UIApplication sharedApplication].applicationIconBadgeNumber =[[curDict objectForKey:@"badge"] intValue];

    }

} 
```

`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:23:44.717

您只需要实现`UIAlertViewDelegate`并调用委托方法

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
  switch(buttonIndex) {
    case 0: // do something
      break;
    case 1: // do something else
      break;
  }
} 
```

# c# - asp.net中gridview上的大量数据

> ID：11543538
> 
> 赞同：5
> 
> 时间：2012-07-18T14:20:42.083
> 
> 标签：c#, asp.net, sql

我有大量数据（一个包含 20000 条记录的 sql 查询），用这些数据填充我的数据网格需要 10 分钟，这是我的 gridview 定义：

```
<asp:GridView ID="g" runat="server" Height="113px" Width="817px" 
BackColor="White" BorderColor="#999999" BorderStyle="None" BorderWidth="1px" 
CellPadding="3" GridLines="Vertical" AllowPaging="True" Font-Size="Small" 
     PageSize="30">
    <AlternatingRowStyle BackColor="#DCDCDC" />
    <FooterStyle BackColor="#CCCCCC" ForeColor="Black" />
    <HeaderStyle BackColor="#000084" Font-Bold="True" ForeColor="White" />
    <PagerStyle BackColor="#999999" ForeColor="Black" HorizontalAlign="Center" />
    <RowStyle BackColor="#EEEEEE" ForeColor="Black" />
    <SelectedRowStyle BackColor="#008A8C" Font-Bold="True" ForeColor="White" />
    <SortedAscendingCellStyle BackColor="#F1F1F1" />
    <SortedAscendingHeaderStyle BackColor="#0000A9" />
    <SortedDescendingCellStyle BackColor="#CAC9C9" />
    <SortedDescendingHeaderStyle BackColor="#000065" />
    <PagerStyle cssClass="gridpager" HorizontalAlign="Left" />  

</asp:GridView> 
```

正如你所看到的，我已经启用了 AllowPaging 属性。

这就是我绑定数据的方式：

```
DataSet dts = new DataSet();
OracleDataAdapter oad = new OracleDataAdapter(query, co.conn);

cmd.CommandText = query;
cmd.CommandType = CommandType.Text;

cmd.CommandText = query;
cmd.CommandType = CommandType.Text;
OracleDataReader reader = cmd.ExecuteReader();

oad.Fill(dts);

g.DataSource = dts.Tables[0];
g.DataBind(); 
```

我怎样才能提高性能？

当我填充数据集时 (oad.Fill(dts);) 需要 10 分钟才能完成。这是因为我一次设置了20000条记录吗？有没有办法只显示前 30 条记录并在用户对 gridview 进行分页时调用数据？还有其他方法可以提高性能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T14:39:32.917

如果我的理解是正确的，你要添加*服务器分页*

当您简单地添加`AllowPaging="True"`到网格时，默认情况下，`GridView`不知道如何从服务器分页您的数据，**分页是在从数据库中获取整个结果后在内存中执行的，并且每次`GridView`绑定时都会发生这种情况**

我认为您想添加服务器分页（在服务器中分页并仅向客户端发送一小束记录），为此，您可以利用几个 ASP.Net 数据源控件。

由于您手动连接到数据库，因此您需要在查询中手动添加分页代码并将该代码映射到控件

我认为唯一可以帮助您的数据源控件（因为您使用 Oracle 作为数据库）是

*   SqlDataSource。遗憾的是它不支持开箱即用的服务器分页，您需要对其进行调整
*   对象数据源。它可以很容易地与`GridView`控件集成以提供分页，但是您需要手动将代码添加到查询或存储过程中以在服务器中对数据进行分页
*   实体数据源。它用于在使用 EntityFramework 时与您的数据库连接

例如，如果您使用 EF 或 NHibernate，它会更容易，代码如下所示：

```
g.DataSource = myContext.MyTable.Skip(pageIndex * pageSize).Take(pageSize);
g.DataBind(); 
```

使用示例`ObjectDatasource`

## ASPX

```
 <asp:ObjectDataSource runat="server" ID="ods" TypeName="MyObject" EnablePaging="True"
        SelectMethod="FindPaging"
        MaximumRowsParameterName="pageSize"
        SortParameterName="sortColumn"
        StartRowIndexParameterName="startIndex"
        SelectCountMethod="FindPagingCount" onselected="ods_Selected"
    >
        <SelectParameters>
            <asp:Parameter Name="sortColumn" Type="String" />
            <asp:Parameter Name="startIndex" Type="Int32" />
            <asp:Parameter Name="pageSize" Type="Int32" />
        </SelectParameters>
    </asp:ObjectDataSource>

            <asp:GridView ID="grid" runat="server" AllowPaging="True" AllowSorting="True" PageSize="10"
                DataSourceID="ods" AutoGenerateColumns="true">
            </asp:GridView> 
```

## 数据组件

```
[System.ComponentModel.DataObject]
public class MyObject
{
    [System.ComponentModel.DataObjectMethod(System.ComponentModel.DataObjectMethodType.Select)]
    public IEnumerable<employee> FindPaging(int startIndex, int pageSize, string sortColumn)
    {
        // place here your code to access your database and use the parameters to paginate your results in the server
    }

    [System.ComponentModel.DataObjectMethod(System.ComponentModel.DataObjectMethodType.Select)]
    public int FindPagingCount(int startIndex, int pageSize, string sortColumn)
    {
        var c = new DataClassesDataContext();

        return c.employees.Count();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:40:04.850

简单的解决方案是抓取前 30 行，然后当您抓取下一组时，您通过执行前 30 行（其中 id > @lastid）来抓取接下来的 30 行。

这样，您只需请求 30 行，而不必费心从数据库中获取整个记录集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-18T14:40:26.657

分页只是意味着它一次只显示“pagesize”项目，但它仍然需要从数据库中获取所有数据才能显示这几个项目，因为这就是您的查询告诉它要做的事情。

您需要做的是修改查询，使其仅获取“pagesize”项，然后您需要向事件添加事件处理程序，`OnPageIndexChanging`以便您可以重新查询数据库以获取下一个“pagesize”项。（或者之前的，或者其他的，基于你设置的分页选项。事件参数将包含用户要求的页面索引。）

如果您在网络上搜索“gridview 分页”或类似内容，您可以找到代码示例，但它们会根据您使用的数据库、获取它的方式等而有很大差异。

oracle 的分页：

[https://stackoverflow.com/a/241643/351383](https://stackoverflow.com/a/241643/351383)

# deployment - Heroku 推送：gzip 标准输入不是 gzip 格式

> ID：11543541
> 
> 赞同：8
> 
> 时间：2012-07-18T14:20:51.423
> 
> 标签：deployment, heroku, gzip, push

当我尝试在我的一个 PHP 应用程序中向 Heroku 推送更新时，我遇到了以下问题：

> 计数对象：25，完成。
> Delta 压缩最多使用 4 个线程。
> 压缩对象：100% (12/12)，完成。
> 写入对象：100% (13/13)，1.20 KiB，完成。
> 总共 13 个（增量 10），重用 0 个（增量 0）
> 
> -----> Heroku 接收推送
> -----> 获取自定义 buildpack... 完成
> -----> 检测到 PHP 应用程序
> ----->运行 Sitebase buildpack
> -----> 捆绑 Apache 版本 2.2.22
> 
> gzip：stdin：不是 gzip 格式
> tar：子返回状态 1
> tar：由于先前的错误而退出失败状态
> ！Heroku push 被拒绝，无法编译 PHP 应用程序
> 
> 到 git@heroku.com:x
> ！[remote denied] feature-removeapi -> master (pre-receive hook denied)
> 错误：未能将一些引用推送到 'git@heroku.com:x'

以前从来没有遇到过这个问题，所以我完全不知道问题是什么。这可能是 Heroku 方面的错误吗？

如果我查看 Heroku 日志，我还会看到以下行：

> Slug 编译失败：无法编译 PHP 应用程序

欢迎所有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-07T15:39:54.053

我遇到这个问题的情况似乎是 Heroku 问题。只需等待 10 分钟左右对我来说就是诀窍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-16T02:39:01.817

这么多年过去了，还是会出现这个问题。[顺便说一句：我的解决方法是固定到此处](https://elements.heroku.com/buildpacks/robgraeber/heroku-buildpack-nodejs-gulp)提到的特定版本：

`heroku buildpacks:set https://github.com/heroku/heroku-buildpack-nodejs#v75 -a my-app`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-08T11:54:14.607

Same issue had occurred for my Java application which was built with Maven. It got fixed by configuring Java buildpack provided by Heroku (Earlier I was using custom buildpack which used to work on heroku for same application).

# .net - .net 中的 Addhandler 和 AddressOf

> ID：11543547
> 
> 赞同：0
> 
> 时间：2012-07-18T14:21:04.423
> 
> 标签：.net, addhandler

您好，我正在尝试编写以下代码来触发 MyHelper 方法。但它没有在 timScheduledTask.Elapsed 触发，
请任何人帮忙，触发 MyHelper 方法的最佳方法是什么？

```
 Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)

        Dim timScheduledTask As New System.Timers.Timer
        timScheduledTask.Interval = 600 * 1000 //in milliseconds    
        timScheduledTask.Enabled = True
        timScheduledTask.Start()
    **AddHandler timScheduledTask.Elapsed, AddressOf MyHelper**    
    End Sub

    Protected Sub MyHelper(ByVal sender As Object, ByVal e As EventArgs)
        //Just Do something        
    End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:27:06.683

您的问题是该函数`timScheduledTask`的位置变量`Application_Start`。一旦这个函数完成，定时器的实例就会被垃圾收集器销毁。如果您将计时器存储在类变量中，您应该没问题。

例如像这样：

```
Public Class Foo
    Private timScheduledTask As System.Timers.Timer

    Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)
        timScheduledTask = New System.Timers.Timer
        timScheduledTask.Interval = 600 * 1000 //in milliseconds    
        timScheduledTask.Enabled = True
        timScheduledTask.Start()
        AddHandler timScheduledTask.Elapsed, AddressOf MyHelper   
    End Sub

    Protected Sub MyHelper(ByVal sender As Object, ByVal e As EventArgs)
        Dim ds As DataSet = obj1.Dataset()

        Dim onRemoveCallback As CacheItemRemovedCallback

        _cache.Insert("ResultDataset", ds, New CacheDependency("C:\AspNetSql\Quotes.Quotations"), Cache.NoAbsoluteExpiration, Cache.NoSlidingExpiration, CacheItemPriority.[Default], onRemoveCallback)
    End Sub
End Class 
```

甚至像这样：

```
Public Class Foo
    Private WithEvents timScheduledTask As System.Timers.Timer

    Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)
        timScheduledTask = New System.Timers.Timer
        timScheduledTask.Interval = 600 * 1000 //in milliseconds    
        timScheduledTask.Enabled = True
        timScheduledTask.Start()  
    End Sub

    Protected Sub MyHelper(ByVal sender As Object, ByVal e As EventArgs) Handles timScheduledTask.Elapsed
        Dim ds As DataSet = obj1.Dataset()

        Dim onRemoveCallback As CacheItemRemovedCallback

        _cache.Insert("ResultDataset", ds, New CacheDependency("C:\AspNetSql\Quotes.Quotations"), Cache.NoAbsoluteExpiration, Cache.NoSlidingExpiration, CacheItemPriority.[Default], onRemoveCallback)
    End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T17:35:59.940

代码必须看起来像这样。
但是我们必须牢记在心。如果您将间隔设置为 50 秒，则每秒钟代码执行应在起始标记行下方的断点处停止，即 _cache.insert。

```
Class Foo  
Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)

        //Caching the Dataset for every mentioned time interval
        _cache = Context.Cache
        Dim timer As New System.Timers.Timer()
        timer.Interval = 50 * 1000 //in milliseconds = 50Seconds   
        timer.Enabled = True

        //Automatically calling the GetMetricsDataset mothod for every mentioned time interval
        AddHandler timer.Elapsed, AddressOf Me.GetDataset

        timer.Stop()
        timer.Start()

    End Sub

    Private Function GetDataset(ByVal sender As Object, ByVal e As System.Timers.ElapsedEventArgs) As DataSet
        Dim ds As DataSet = obj1.GetDataset()

        Dim onRemoveCallback As CacheItemRemovedCallback

        **_cache.Insert("Dataset", ds, New CacheDependency("C:\AspNetSql\Quotes.Quotations"), Cache.NoAbsoluteExpiration, Cache.NoSlidingExpiration, CacheItemPriority.[Default], _
         onRemoveCallback)**

        Return ds
    End Function
End 
```

# ios - 获取进程任务失败

> ID：11543548
> 
> 赞同：2
> 
> 时间：2012-07-18T14:21:12.453
> 
> 标签：ios, xcode

> **可能重复：**
> [Xcode 无法获取进程 XXX 的任务。我该如何解决这个问题？(iPhone SDK 4.0)](https://stackoverflow.com/questions/3523722/xcode-fails-to-get-the-task-for-process-xxx-how-do-i-solve-this-iphone-sdk-4)

在设备上运行我的应用程序时收到错误消息：

```
error: failed to launch '/Users/michalsvacha/Library/Developer/Xcode/DerivedData/myApp-fvyxohsnqeujfwcjuqdnvfobusdt/Build/Products/Debug-iphoneos/myApp.app/iSense' 
-- failed to get the task for process 46681 
```

几天前没有发生。该应用程序启动并最小化自身（无崩溃）。此消息被记录。

有人遇到过同样的问题吗？我在这里搜索，但所有问题都涉及临时分发，这不是我的情况。其他应用程序运行顺利。

# python - 在 Tornado 中启动异步的、类似 Node.js 的 HTTP 请求

> ID：11543551
> 
> 赞同：1
> 
> 时间：2012-07-18T14:21:20.643
> 
> 标签：python, asynchronous, tornado

我以前在 Node.js 中编写过应用程序，特别是数据抓取工具。这些类型的应用程序没有 Web 前端，而只是与 cron 作业定时的进程，以异步发出许多可能很复杂的 HTTP GET 请求来拉取网页，然后从结果中抓取和存储数据。

我可能编写的函数示例如下：

```
// Node.js

var request = require("request");

function scrapeEverything() {
    var listOfIds = [23423, 52356, 63462, 34673, 67436];

    for (var i = 0; i < listOfIds.length; i++) {
        request({uri: "http://mydatasite.com/?data_id = " + listOfIds[i]},
                function(err, response, body) {
                     var jsonobj = JSON.parse(body);
                      storeMyData(jsonobj);
                });
    }
} 
```

此函数循环遍历 ID 并发出一堆异步 GET 请求，然后从中存储数据。

我现在正在用 Python 编写一个爬虫，并尝试使用 Tornado 做同样的事情，但我在文档中看到的所有内容都是指 Tornado 充当 Web 服务器，这不是我想要的。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T18:29:14.337

答案比我想的要复杂一些，但它是如何使用 Tornado ioloop 和 AsyncHTTPClient 获取一些数据的快速演示。我实际上已经在 Tornado 中编写了一个网络爬虫，所以它可以“无头”使用。

```
import tornado.ioloop
import tornado.httpclient

class Fetcher(object):
    def __init__(self, ioloop):
        self.ioloop = ioloop
        self.client = tornado.httpclient.AsyncHTTPClient(io_loop=ioloop)

    def fetch(self, url):
        self.client.fetch(url, self.handle_response)

    @property
    def active(self):
        """True if there are active fetching happening"""

        return len(self.client.active) != 0

    def handle_response(self, response):
        if response.error:
            print "Error:", response.error
        else:
            print "Got %d bytes" % (len(response.body))

        if not self.active:
            self.ioloop.stop()

def main():
    ioloop = tornado.ioloop.IOLoop.instance()
    ioloop.add_callback(scrapeEverything)
    ioloop.start()

def scrapeEverything():
    fetcher = Fetcher(tornado.ioloop.IOLoop.instance())

    listOfIds = [23423, 52356, 63462, 34673, 67436]

    for id in listOfIds:
        fetcher.fetch("http://mydatasite.com/?data_id=%d" % id)

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T15:12:11.747

如果您对 tornado 的替代方案持开放态度（我假设您使用套接字编程而不是 urllib2），您可能会对异步、并发（和分布式、容错）编程框架[asyncoro感兴趣。](http://asyncoro.sourceforge.net)使用 asyncoro 编程与使用线程非常相似，除了一些语法变化。您的问题可以用 asyncoro 实现为：

```
import asyncoro, socket

def process(url, coro=None):
    # create asynchronous socket
    sock = asyncoro.AsynCoroSocket(socket.socket())
    # parse url to get host, port; prepare get_request
    yield sock.connect((host, port))
    yield sock.send(get_request)
    body = yield sock.recv()
    # ...
    # process body

for i in [23423, 52356, 63462, 34673, 67436]:
    asyncoro.Coro(process, "http://mydatasite.com/?data_id = %s" % i) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-10T11:11:27.847

您还可以尝试不需要任何外部库的本机解决方案。对于 linux，它基于 epoll，可能看起来像[这样](https://bitbucket.org/snippets/fippo/rkLqk)。使用示例：

```
# ------------------------------------------------------------------------------------
def sampleCallback(status, data, request):
    print 'fetched:', status, len(data)
    print data

# ------------------------------------------------------------------------------------
fetch(HttpRequest('google.com:80', 'GET', '/', None, sampleCallback)) 
```

# c++ - 指向模板函数的指针

> ID：11543555
> 
> 赞同：3
> 
> 时间：2012-07-18T14:21:46.607
> 
> 标签：c++

所以我现在已经习惯了将模板函数指针存储在地图容器中，主要是作为一种模板化函数的方法，该函数返回模板化对象的新实例，并将该函数指针存储在地图中，以便在给定相应的字符串索引时调用（那是一口）。我的问题在于使用模板函数指针。这似乎可行的唯一原因是因为返回类型或参数都不是模板参数类型。它看起来像这样：

```
template<class T>
base * createT() {return new T;} 
```

其中 T 应该是从 base 派生的类。现在我可以制作一个可以正常工作的函数指针

```
base*(*funcptr)() = &createT<derived>; 
```

但假设我想设置这样的东西：

```
template <class returnType, class T>
returnType * createT() { return new T;} 
```

这个函数的函数指针声明是什么样的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T14:25:28.493

您不能有指向函数模板的指针，只能指向函数。所以实际上模板是无关紧要的。你会做类似的事情

```
A *(*funcptr)() = &createT<A,B>; 
```

演示：http: [//ideone.com/NoHYS](http://ideone.com/NoHYS)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:25:57.323

完全相同的：

```
base *(*funcptr)() = &createT<base, derived>; 
```

# mysql - MySQL查询：单表多比较

> ID：11543561
> 
> 赞同：2
> 
> 时间：2012-07-18T14:22:10.817
> 
> 标签：mysql

我有以下mysql表：

```
id     |  member     |
1      | abc       
1      | pqr   
2      | xyz   
3      | pqr   
3      | abc 
```

我一直在尝试编写一个查询，该查询将返回与给定 id 具有完全相同成员的 id。例如，如果给定 id 为 1，则查询应返回 3，因为 id 1 和 id 3 具有完全相同的成员，即。{abc, pqr}。任何指针？欣赏它。

**编辑：**该表可能有重复，例如 id 3 可能有成员 {abc,abc} 而不是 {pqr,abc}，在这种情况下查询不应返回 id 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:39:53.407

这是为整个表查找匹配对的解决方案 - 您可以根据需要添加 where 子句进行过滤。基本上它基于相等的“成员”和不相等的“id”进行自加入。然后，它比较按 2 个 id 分组的结果计数，并将它们与原始表中这些 id 的总计数进行比较。如果它们都匹配，则意味着它们具有相同的确切成员。

```
select
    t1.id, t2.id
from
    table t1
    inner join table t2
        on  t1.member = t2.member
            and t1.id < t2.id
    inner join (select id, count(1) as cnt from table group by id) c1
        on  t1.id = c1.id
    inner join (select id, count(1) as cnt from table group by id) c2
        on  t2.id = c2.id
group by
    t1.id, t2.id, c1.cnt, c2.cnt
having
    count(1) = c1.cnt
    and count(1) = c2.cnt
order by 
    t1.id, t2.id 
```

这是我使用的一些样本数据，它返回了 (1,3) 和 (6,7) 的匹配项

```
insert into table
values 
    (1, 'abc'), (1, 'pqr'), (2, 'xyz'), (3, 'pqr'), (3, 'abc'), (4, 'abc'), (5, 'pqr'),
    (6, 'abc'), (6, 'def'), (6, 'ghi'), (7, 'abc'), (7, 'def'), (7, 'ghi') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:42:37.613

试试这个：

```
declare @id int
set @id=1
select a.id from
(select id,COUNT(*) cnt from sample_table
where member in (select member from sample_table where id=@id)
and id <>@id
group by id)a
join
(select count(distinct member) cnt from sample_table where id=@id)b
on a.cnt=b.cnt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T15:12:18.220

使用子查询的类似（与 Derek Kromm 的）方法：

```
SELECT id
FROM mc a
WHERE
  id != 1 AND
  member IN (
    SELECT member FROM mc WHERE id=1)
GROUP BY id
HAVING
  COUNT(*) IN (
    SELECT COUNT(*) FROM mc WHERE id=1) AND
  COUNT(*) IN (
    SELECT COUNT(*) FROM mc where id=a.id); 
```

这里的逻辑是我们需要所有符合以下 2 个条件的 id：

*   member 属于 id 1 的成员
*   成员总数与属于 id 1 的成员数相同
*   选定成员的总数等于当前 ID 的成员总数

# c# - 循环通过动态创建的列表框

> ID：11543563
> 
> 赞同：1
> 
> 时间：2012-07-18T14:22:17.337
> 
> 标签：c#, asp.net

我正在导出数据，现在一些字段导出值，而不是文本。因此，我将返回文本和值的对象保存到列表框中，并将其与来自对象的列表框中的值匹配，如下所示：

```
MaterialDB materials = new MaterialDB();
DropDownList listBoxMaterials = new DropDownList();
listBoxMaterials.DataSource = materials.GetItems(ModuleId, TabId);
listBoxMaterials.DataBind();

string materialString = "";

foreach (ListItem i in listBoxMaterials.Items)
{
    if (i.Value == row["MaterialTypeID"].ToString())
    {
        materialString = i.Text;
    }
} 
```

当我将它用于 i.Value 时，它​​总是返回“System.Data.DataRowView”而不是实际值。我在后面的代码中做这一切。无论如何要让它工作？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:26:08.863

您需要设置 DropDownList 的 DataTextField 和 DataValueField 属性。例子：

```
MaterialDB materials = new MaterialDB();
DropDownList listBoxMaterials = new DropDownList();
listBoxMaterials.DataSource = materials.GetItems(ModuleId, TabId);
listBoxMaterials.DataTextField = "MaterialName";
listBoxMaterials.DataTextValue = "MaterialID";
listBoxMaterials.DataBind();

string materialString = "";    

foreach (ListItem i in listBoxMaterials.Items)
{
    if (i.Value == row["MaterialTypeID"].ToString())
    {
        materialString = i.Text;
    }
} 
```

# jquery - J Query 在 Joomla 中停止 mod_djimageslider

> ID：11543564
> 
> 赞同：0
> 
> 时间：2012-07-18T14:22:25.420
> 
> 标签：jquery, joomla, module

我有一个网站，客户希望每隔几秒钟更改一次推荐，所以我使用 J Query 构建了一个简单的脚本。一切正常，但让谷歌托管 J Query 正在阻止加载另一个元素中的图像。有谁知道为什么会这样？

您可以看到它的当前页面：（目前我知道 CSS 有点倾斜） [http://www.pressbeau.co.uk/tithe-farm-nursing-home/](http://www.pressbeau.co.uk/tithe-farm-nursing-home/)

获取 J Query （我做错了吗？ - 它确实有效并且完成了淡入元素的工作，但阻止了其他不相关的图像加载......）

```
 <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">
      // This Script loads the J Query File
</script> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T16:55:58.320

尝试在加载 jQuery 的行下方添加此代码，即：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
// This Script loads the J Query File
jQuery.noConflict(); 
```

如果你不能这样做（因为使用 joomla）在本地保存 jquery.min.js 并在该文件的末尾添加上面的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T18:04:35.140

尝试添加此代码，而不是按原样嵌入脚本。

```
if (!JFactory::getApplication()->get('jquery')) {
        JFactory::getApplication()->set('jquery', true);
        // add jQuery from Google library
        $document->addScript('http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T10:24:12.137

我发现（感谢我收到的 2 个答案所做的研究），这是 J Query 库与站点内的另一个 JavaScript 库之间的冲突。

供以后参考解决问题，调用J Query Library后放置在这段代码中： `<script>jQuery.noConflict();</script>`

这将禁用 jQuery 快捷方式“$”，因此任何使用 $ 调用 jQuery 函数的实例都需要替换为 jQuery

所以这是之前

```
$("#???").fadeIn(speed, timerChangeTwo); 
```

这是改变之后

```
jQuery("#???").fadeIn(speed, timerChangeTwo); 
```

那应该可以解决问题-希望其他人发现有用！

# c# - 如何在 Windows 任务栏下滑动表单并关闭透明度？

> ID：11543565
> 
> 赞同：0
> 
> 时间：2012-07-18T14:22:27.103
> 
> 标签：c#, winforms

我有一个从任务栏下方弹出的表单。到目前为止，一切都很好。但是在透明任务栏的情况下，表单不能首先在任务栏下看到，然后才在其他所有内容之上，我不喜欢这种效果。

![在此处输入图像描述](../Images/2cf52d78133133345f61a96882172dfa.png)

我可以在几毫秒内以某种方式禁用 Windows 任务栏的透明度吗？或者也许还有其他想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:32:45.047

我同意@GeraldVersluis：让弹出窗口位于任务栏顶部。您可以通过询问 Screen 对象来做到这一点（例如，获取屏幕区域的下边缘）。 [`Screen.PrimaryScreen.WorkingArea`](http://msdn.microsoft.com/en-us/library/system.windows.forms.screen.workingarea)

# matlab - 将矩阵划分为更小的矩阵

> ID：11543571
> 
> 赞同：0
> 
> 时间：2012-07-18T14:22:39.647
> 
> 标签：matlab, matrix

嗨，我有一个大小为 ixi 的矩阵 A，我想将其划分为更小的矩阵，以便每个子矩阵都适合矩阵 B 大小 jxj 的维度。我该怎么做呢？

```
B = mat2cell(A,size(B)); 
```

似乎没有这样做。

注意：子矩阵的数量 = sqrt(n) 即如果 A 为 100x100 则将有 10 个子矩阵，如果 A 为 81x81 将有 9 个子矩阵。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T14:30:24.303

对于`mat2cell`，如果要将矩阵一分为二，则必须为每组行/列指定大小。因此，如果您需要将一个 2×2 数组分成四个 1×1 数组，则为`mat2cell(array,[1 1],[1 1])`.

```
nSub = sqrt(size(A,1));

B = mat2cell(A,nSub*ones(1,nSub),nSub*ones(1,nSub)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:27:15.850

试试repmat。这将根据需要将您的 axb 数据重组为更小的 pxqxr 矩阵。

# vba - vba代码将多个excel图表复制到word

> ID：11543577
> 
> 赞同：1
> 
> 时间：2012-07-18T14:22:57.630
> 
> 标签：vba, excel

我在[这里](http://www.vbaexpress.com/kb/getarticle.php?kb_id=133#instr)使用 VBA 代码将 Excel 工作簿中的所有图表和表格复制到模板中的新 Word 文档中，该模板使用书签（标记为 Book1、Book2 等）预先格式化。不幸的是，我只有几张表，但大约有 20 个图表，如果我在汇总表中为我得到的范围留一个空白

> 运行时错误“5101”：
> 应用程序定义或对象定义错误

它只复制并粘贴到差距之前的图表和表格上。

这是我的excel汇总表：

![在此处输入图像描述](../Images/fa3de9365a965ad6cd97a4a87466784b.png)

知道如何修改代码以防止这种情况发生吗？

对不起 - 我是一个完整的 VBA 菜鸟

```
'You must set a reference to Microsoft Word Object Library from Tools | References

Option Explicit 

Sub ExportToWord() 

    Dim appWrd          As Object 
    Dim objDoc          As Object 
    Dim FilePath        As String 
    Dim FileName        As String 
    Dim x               As Long 
    Dim LastRow         As Long 
    Dim SheetChart      As String 
    Dim SheetRange      As String 
    Dim BookMarkChart   As String 
    Dim BookMarkRange   As String 
    Dim Prompt          As String 
    Dim Title           As String 

     'Turn some stuff off while the macro is running
    Application.ScreenUpdating = False 
    Application.EnableEvents = False 
    Application.DisplayAlerts = False 

     'Assign the Word file path and name to variables
    FilePath = ThisWorkbook.Path 
    FileName = "WorkWithExcel.doc" 

     'Determine the last row of data for our loop
    LastRow = Sheets("Summary").Range("A65536").End(xlUp).Row 

     'Create an instance of Word for us to use
    Set appWrd = CreateObject("Word.Application") 

     'Open our specified Word file, On Error is used in case the file is not there
    On Error Resume Next 
    Set objDoc = appWrd.Documents.Open(FilePath & "\" & FileName) 
    On Error Goto 0 

     'If the file is not found, we need to end the sub and let the user know
    If objDoc Is Nothing Then 
        MsgBox "Unable to find the Word file.", vbCritical, "File Not Found" 
        appWrd.Quit 
        Set appWrd = Nothing 
        Exit Sub 
    End If 

     'Copy/Paste Loop starts here
    For x = 2 To LastRow 

         'Use the Status Bar to let the user know what the current progress is
        Prompt = "Copying Data: " & x - 1 & " of " & LastRow - 1 & "   (" & _ 
        Format((x - 1) / (LastRow - 1), "Percent") & ")" 
        Application.StatusBar = Prompt 

         'Assign the worksheet names and bookmark names to a variable
         'Use With to group these lines together
        With ThisWorkbook.Sheets("Summary") 
            SheetChart = .Range("A" & x).Text 
            SheetRange = .Range("B" & x).Text 
            BookMarkChart = .Range("C" & x).Text 
            BookMarkRange = .Range("D" & x).Text 
        End With 

         'Tell Word to goto the bookmark assigned to the variable BookMarkRange
        appWrd.Selection.Goto What:=wdGoToBookmark, Name:=BookMarkRange 

         'Copy the data from Thisworkbook
        ThisWorkbook.Sheets(SheetRange).UsedRange.Copy 

         'Paste into Word
        appWrd.Selection.Paste 

         'Tell Word to goto the bookmark assigned to the variable BookMarkChart
        appWrd.Selection.Goto What:=wdGoToBookmark, Name:=BookMarkChart 

         'Copy the data from Thisworkbook
        ThisWorkbook.Sheets(SheetChart).ChartObjects(1).Copy 

         'Paste into Word
        appWrd.Selection.Paste 
    Next 

     'Turn everything back on
    Application.ScreenUpdating = True 
    Application.EnableEvents = True 
    Application.DisplayAlerts = True 
    Application.StatusBar = False 

     'Let the user know the procedure is now complete
    Prompt = "The procedure is now completed." & vbCrLf & vbCrLf & "www.VBAExpress.com" 
    Title = "Procedure Completion" 
    MsgBox Prompt, vbOKOnly + vbInformation, Title 

     'Make our Word session visible
    appWrd.Visible = True 

     'Clean up
    Set appWrd = Nothing 
    Set objDoc = Nothing 

End Sub 
```

完整的工作代码如下。我修改了代码，将图表粘贴为增强的元文件，因为这是我老板想要的。

```
 'You must set a reference to Microsoft Word Object Library from Tools | References

Option Explicit

Sub ExportToWord()

Dim appWrd          As Object
Dim objDoc          As Object
Dim FilePath        As String
Dim FileName        As String
Dim x               As Long
Dim LastRow         As Long
Dim SheetChart      As String
Dim SheetRange      As String
Dim BookMarkChart   As String
Dim BookMarkRange   As String
Dim Prompt          As String
Dim Title           As String

    'Turn some stuff off while the macro is running
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    Application.DisplayAlerts = False

    'Assign the Word file path and name to variables
    FilePath = ThisWorkbook.Path
    FileName = "WorkWithExcel.doc"

    'Determine the last row of data for our loop
    LastRow = Sheets("Summary").Range("A" & Rows.Count).End(xlUp).Row

    'Create an instance of Word for us to use
    Set appWrd = CreateObject("Word.Application")

    'Open our specified Word file, On Error is used in case the file is not there
    On Error Resume Next
    Set objDoc = appWrd.Documents.Open(FilePath & "\" & FileName)
    On Error GoTo 0

    'If the file is not found, we need to end the sub and let the user know
    If objDoc Is Nothing Then
        MsgBox "Unable to find the Word file.", vbCritical, "File Not Found"
        appWrd.Quit
        Set appWrd = Nothing
        Exit Sub
    End If

    'Copy/Paste Loop starts here
    For x = 2 To LastRow

        'Use the Status Bar to let the user know what the current progress is
        Prompt = "Copying Data: " & x - 1 & " of " & LastRow - 1 & "   (" & _
            Format((x - 1) / (LastRow - 1), "Percent") & ")"
        Application.StatusBar = Prompt

        'Assign the worksheet names and bookmark names to a variable
        'Use With to group these lines together
        With ThisWorkbook.Sheets("Summary")
            SheetChart = .Range("A" & x).Text
            SheetRange = .Range("B" & x).Text
            BookMarkChart = .Range("C" & x).Text
            BookMarkRange = .Range("D" & x).Text
        End With

If Len(BookMarkRange) > 0 Then

'Tell Word to goto the bookmark assigned to the variable BookMarkRange
appWrd.Selection.Goto What:=wdGoToBookmark, Name:=BookMarkRange

'Copy the data from Thisworkbook
ThisWorkbook.Sheets(SheetRange).UsedRange.Copy

'Paste into Word
appWrd.Selection.Paste
End If

If Len(BookMarkChart) > 0 Then

'Tell Word to goto the bookmark assigned to the variable BookMarkChart
appWrd.Selection.Goto What:=wdGoToBookmark, Name:=BookMarkChart

'Copy the data from Thisworkbook
ThisWorkbook.Sheets(SheetChart).ChartObjects(1).Copy

'Paste into Word
'appWrd.Selection.PasteSpecial ppPasteEnhancedMetafile
 appWrd.Selection.PasteSpecial Link:=False, DataType:=wdPasteEnhancedMetafile, _
        Placement:=wdInLine, DisplayAsIcon:=False

End If

    Next

    'Turn everything back on
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    Application.DisplayAlerts = True
    Application.StatusBar = False

    'Let the user know the procedure is now complete
    Prompt = "The procedure is now completed." & vbCrLf & vbCrLf & "www.VBAExpress.com"
    Title = "Procedure Completion"
    MsgBox Prompt, vbOKOnly + vbInformation, Title

    'Make our Word session visible
    appWrd.Visible = True

    'Clean up
    Set appWrd = Nothing
    Set objDoc = Nothing

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:50:51.707

此代码存在多个问题，包括如果您的范围比图表多，它只会复制与图表一样多的范围。

但是要快速解决您的问题，请更换

```
 'Tell Word to goto the bookmark assigned to the variable BookMarkRange
appWrd.Selection.Goto What:=wdGoToBookmark, Name:=BookMarkRange 

 'Copy the data from Thisworkbook
ThisWorkbook.Sheets(SheetRange).UsedRange.Copy 

 'Paste into Word
appWrd.Selection.Paste 

 'Tell Word to goto the bookmark assigned to the variable BookMarkChart
appWrd.Selection.Goto What:=wdGoToBookmark, Name:=BookMarkChart 

 'Copy the data from Thisworkbook
ThisWorkbook.Sheets(SheetChart).ChartObjects(1).Copy 

 'Paste into Word
appWrd.Selection.Paste 
```

和

```
if len (BookMarkRange) > 0 then
   'Tell Word to goto the bookmark assigned to the variable BookMarkRange
  appWrd.Selection.Goto What:=wdGoToBookmark, Name:=BookMarkRange 

   'Copy the data from Thisworkbook
  ThisWorkbook.Sheets(SheetRange).UsedRange.Copy 

   'Paste into Word
  appWrd.Selection.Paste 
end if

if len(BookMarkChart) > 0 then
   'Tell Word to goto the bookmark assigned to the variable BookMarkChart
  appWrd.Selection.Goto What:=wdGoToBookmark, Name:=BookMarkChart 

   'Copy the data from Thisworkbook
  ThisWorkbook.Sheets(SheetChart).ChartObjects(1).Copy 

   'Paste into Word
  appWrd.Selection.Paste 
end if 
```

# windows - 将文本从 Windows CMD 窗口复制到剪贴板

> ID：11543578
> 
> 赞同：32
> 
> 时间：2012-07-18T14:23:07.227
> 
> 标签：windows, batch-file, cmd

有谁知道是否可以从 Windows 的命令提示符或控制台窗口复制文本，例如命令、控制台应用程序或批处理文件的输出？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-07-18T16:50:41.517

如果您提前知道要将命令的结果放在剪贴板上，则另一个选择是将输出通过管道传输到 CLIP 实用程序。

下面是两个简单的例子

```
echo Hello world!|clip

dir|clip 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-07-18T14:35:28.357

*   右键单击>标记
*   通过按住鼠标左键并选择文本来选择要复制的文本，或者使用箭头键导航到要复制的文本的开头，按 Shift，然后（使用箭头键）移动到文本的末尾.
*   右键单击**标题栏**，进入“编辑”，然后点击复制。

现在，您可以再次粘贴到记事本或命令提示符中，方法是右键单击**标题栏**，进入“编辑”，然后点击“粘贴”。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-18T21:20:01.073

打开命令窗口，然后右键单击标题栏并左键单击上下文菜单底部的**属性。**在**选项选项**卡上添加复选标记**QuickEdit Mode**。单击 “**确定**”并在下一个对话框中选择第二个单选按钮，以便您将来打开的每个命令窗口都启用此选项。**用OK**关闭对话框。

现在您可以使用鼠标左键选择文本。要将文本复制到剪贴板，只需按`Enter`键。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-03-16T10:40:56.477

按着这些次序：

1.  使用指点设备（鼠标、触摸板、指点杆……）将指针移到窗口上，按右键打开上下文菜单，然后左键单击第一个上下文菜单选项**Mark**。
2.  之后，按住左键选择文本（矩形选择）。
3.  选择击键`Enter`或`Return`将所选文本复制到剪贴板后。
4.  使用 将复制的文本粘贴到任何地方`Ctrl+V`。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-18T14:24:58.617

*   右键单击>标记
*   按住左键选择要复制的文本
*   右键单击选定的文本
*   粘贴到你想要的地方

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-18T14:25:06.980

[当然可以](http://www.youtube.com/watch?v=4S6WTPc9UxE)！右键单击，选择标记，选择需要的文本并再次右键单击以复制文本。

您也可以从cmd菜单中选择[QuickEdit模式](http://www.winhelponline.com/blog/enable-quick-edit-command-prompt-by-default/)，这样您就不必右键单击并选择标记，而是可以直接选择复制。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-03-30T23:09:11.643

**Haloo 我的朋友：
如果您想复制当前在 Cmd 或 PowerShell 中剪贴板中的任何文本，您应该：**

1\写下你想要的任何命令。

2\在按回车之前写入 |clip 然后按回车。

3\打开任何文本编辑器，例如记事本。

4\ Ctrl+v 或右键单击 -Paste 。

和她，你的文本编辑器中有剪贴板 ^_^ 。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-18T14:26:13.700

如果您右键单击并在上下文菜单中标记，您可以拖动以编辑选择，然后按 Ctrl+c，它应该复制到剪贴板

# sql - Access 数据库的 Codeigniter 限制

> ID：11543584
> 
> 赞同：1
> 
> 时间：2012-07-18T14:23:35.247
> 
> 标签：sql, codeigniter, ms-access, activerecord

我有以下“活动记录”设置：

```
$this->db->select('*');
$this->db->from('Orders');
$this->db->join('MPC_Agents', 'Orders.UserName = MPC_Agents.UserName', 'inner');    
$this->db->limit(50,20);
$query = $this->db->get(); 
```

使用`$this->db->last_query();`mereley 输出：

```
SELECT * FROM (Orders) INNER JOIN MPC_Agents ON Orders.UserName = MPC_Agents.UserName 
```

为什么不应用限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:36:16.790

限制在 MS Access SQL 中不可用。您可以选择顶部：

```
SELECT Top 10 Id FROM Table Order BY Id 
```

或者

```
SELECT Top 10 Id FROM Table 
WHERE ID Not IN (SELECT Top 10 ID From Table ORDER BY Id)
Order BY Id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T12:21:51.483

将您的极限乐趣放在查询顶部并编辑为

```
 $this->db->limit(20,50);
 $this->db->select('*');
 $this->db->from('Orders');
 $this->db->join('MPC_Agents', 'Orders.UserName = MPC_Agents.UserName', 'inner');
 $this->db->get(); 
```

希望效果更好

# flash - Flash：组件在 CS5 中不起作用，在 CS4 中起作用

> ID：11543588
> 
> 赞同：0
> 
> 时间：2012-07-18T14:23:44.810
> 
> 标签：flash, components, flash-cs5, cs4

我大部分时间都在尝试将基于 SWC 的组件转换为基于 FLA 的组件，除了实时预览之外，我已经完成了所有工作 - 显示只是在两个帧（头像和皮肤）之间连续循环。

经过多次尝试，我已经在 Flash CS4 中加载了组件并且实时预览工作正常，我也通过我下载的示例组件确认了这一点。

有没有人遇到过这个问题？从 CS4 到 CS5 的实时预览实施方式是否有任何变化？或者这可能是我的 CS5 副本的问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-21T23:45:41.810

今天刚刚找到你的问题的答案。我认为我们所面临的是遵循指示的问题。

1.  将组合框拖到舞台上。
2.  双击组件。
3.  选择所需的皮肤，例如。皮肤。（可能在第 2 帧中）
4.  在属性检查器中，调整位置、大小、颜色效果等。
5.  控制 -> 测试影片 -> 测试

# java - 如何去除Chrome web driver和IE web driver的日志

> ID：11543592
> 
> 赞同：4
> 
> 时间：2012-07-18T14:24:02.610
> 
> 标签：java, selenium

我正在开发一个使用 selenium chrome web 驱动程序的工具。那应该只在控制台上显示结果。但是在初始化期间它会打印一些错误日志。我的问题是如何删除这些日志。

```
WebDriver driver=new InternetExplorerDriver(); 
```

在这种情况下，它显示日志

```
 Started InternetExplorerDriver server (32-bit)
  2.24.2.0
 Listening on port 41437 
```

而对于铬

```
 WebDriver driver =new ChromeDriver(); 
```

日志是

```
 Started ChromeDriver
  port=42458
  version=21.0.1180.4
  log=G:\Workspace_Selenium\WebTestSelenium_ToResolveTheReview\chromedriver.log 
```

寻求帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:30:21.530

如果您没有使用控制台以外的任何类型的日志记录（或自己管理），那么

```
Logger shutUp = Logger.getLogger("");
shutUp.setLevel(Level.WARNING); 
```

做这项工作。那应该只输出警告。当然，您可以使用`Level.SEVERE`它使其仅输出错误甚至`Level.OFF`绝对安静。

# git - grep 查找多个 git 存储库中的内容

> ID：11543593
> 
> 赞同：11
> 
> 时间：2012-07-18T14:24:05.357
> 
> 标签：git, gitosis

所以我从其他一些开发人员那里继承了相当大的代码库，代码存储在各种 git 存储库中。

有时，很难知道某段代码可能位于哪个项目中，或者该段代码是否存在于 git 中。

我想要做的是 grep 某些特定文本的所有项目。

我正在使用 gitosis，因此所有 git 存储库都存储在 /home/git/repositories 中，其结构如下：

```
/home/git/repositories
  |- project1
    |- HEAD
    |- branches
    |- config
    |- description
    |- hooks
    |- info
    |- objects
    |- refs
  |- project2
    |- ... 
```

我尝试对对象目录中的内容进行递归 grep，如下所示：

```
grep -Hr "text" /home/git/repositories/*/objects 
```

当然，这无法按我的意图工作，因为对象以 git 的自定义格式存储。

做什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-18T14:28:39.167

`git grep`与 ref 或 一起使用`--no-index`：

```
cd /home/git/repositories
for i in *; do ( cd $i; git grep text HEAD ); done 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-26T19:46:46.720

我知道它的老问题，但如果你使用命令行，你可以将它添加到`bash_profile`或`bashrc`

```
ggrep() {
    find . -type d -name .git | while read line; do
        (
        cd $line/..
        cwd=$(pwd)
        echo "$(tput setaf 2)$cwd$(tput sgr0)"
        git grep -n "$@"
        )
    done
} 
```

上述功能的基本要点是搜索包含`.git`并首先输出该目录的所有目录，然后是文件以及该标记出现的行号

然后去`/home/git/repositories`搜索使用

`ggrep "InvalidToken"`

它会像这样输出

```
/home/git/org/repo1
/home/git/org/repo2
/home/git/org/repo3
/home/git/org/repo3
lib/v3/Utility.pm:59:         code              => 'InvalidToken',
lib/v3/Utility.pm:142:        code              => "InvalidToken", 
```

您还可以传递标志`ggrep -i "search"`（用于不区分大小写的搜索）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-03T16:56:46.640

使用[多](https://github.com/coryfklein/multi)。它是`git grep`一次通过多个存储库专门编写的。

```
$ ls
vim spring-framework gradle phantomjs
$ multi -i "fantastic"
vim
====================================================
runtime/doc/quotes.txt:VIM 4.5 is really a fantastic editor.  It has sooooo many features and more
runtime/doc/quotes.txt:fantastic it is! (Tony Nugent, Australia)
spring-framework
====================================================
gradle
====================================================
subprojects/docs/src/docs/userguide/ant.xml:        simply by relying on Groovy, and the fantastic <literal>AntBuilder</literal>.
subprojects/docs/src/docs/userguide/buildScriptsTutorial.xml:            relying on Groovy. Groovy is shipped with the fantastic <literal>AntBuilder</literal>. Using Ant tasks
subprojects/docs/src/docs/userguide/ideSupport.xml:            if you do this you have a fantastic IDE support for developing Gradle scripts. Of course if you use
phantomjs
====================================================
test/ghostdriver-test/fixtures/common/macbeth.html:<A NAME=1.3.55>Are ye fantastical, or that indeed</A><br>
test/ghostdriver-test/fixtures/common/macbeth.html:<A NAME=1.3.148>My thought, whose murder yet is but fantastical,</A><br> 
```

# php - Google Maps API V3 不显示地图

> ID：11543594
> 
> 赞同：0
> 
> 时间：2012-07-18T14:24:08.553
> 
> 标签：php, html, ajax, google-maps-api-3, kml

好的，所以我有一个 PHP 脚本来处理文件上传，特别是 KML 文件，提取上传文件的中心点和位置，将这些详细信息保存在文本文件中，然后通过“标题”加载另一个页面。然后，此其他页面使用 AJAX 调用来设置从文本文件中收集的变量名称，用于 KML 文件的位置和中心点，以便调用 Google Maps API 在地图上显示 KML 层。

那是应该发生的事情，但什么都没有出现。我浏览我的 KML 文件，点击上传按钮，然后显示一个空白页面。当我检查我的服务器时，文件已上传，相关详细信息已写入各自的文本文件，因此当我尝试调用 Google Maps API 时显然出现了问题。

PHP上传和文件信息保存：

```
<?php
//Check that we have a file
if((!empty($_FILES["UploadedFile"])) && ($_FILES['UploadedFile']['error'] == 0)) {
  //Check if the file is JPEG image and it's size is less than 3Mb
  $filename = basename($_FILES['UploadedFile']['name']);
  $ext = substr($filename, strrpos($filename, '.') + 1);
  if (($ext == "kml") && ($_FILES["UploadedFile"]["size"] < 3145728)) {
    //Determine the path to which we want to save this file
      $newname = dirname(__FILE__).'/kml/'.$filename;
      //Check if the file with the same name is already exists on the server
      if (!file_exists($newname)) {
        //Attempt to move the uploaded file to it's new place
        if ((move_uploaded_file($_FILES['UploadedFile']['tmp_name'],$newname))) {
           findCenter($newname);
           saveName($newname);
        } else {
           echo "Error: A problem occurred during file upload!";
        }
      } else {
         echo "Error: File ".$_FILES["UploadedFile"]["name"]." already exists";
      }
  } else {
     echo "Error: Only .kml files under 3Mb are accepted for upload";
  }
} else {
 echo "Error: No file uploaded";
}

function findCenter($file) {
   $kmlContent = file_get_contents($file);

   $startName = "#sh_green-circle";
   $endName = "#sh_red-circle";
   $startCoords = getCoords($kmlContent, $startName);
   $endCoords = getCoords($kmlContent, $endName);

   $startLat = substr($startCoords, strrpos($startCoords, ',') +1);
   $startLong = substr($startCoords, 0, strrpos($startCoords, ','));

   $endLat = substr($endCoords, strrpos($endCoords, ',') +1);
   $endLong = substr($endCoords, 0, strrpos($endCoords, ','));

   $midLat = ($startLat+$endLat)/2;
   $midLong = ($startLong+$endLong)/2;

   $midCoord = "$midLat,$midLong";

   $saveCenter = "kmlcenter.txt";
   $fh = fopen($saveCenter, 'w') or die ("Can't create file");
   $stringData = $midCoord;
   fwrite($fh, $stringData);
   fclose($fh);
}

function getCoords($kml, $name) {
   $startSearch = strpos($kml, $name);
   $midSearch = strpos($kml, "<coordinates>", $startSearch+1);
   $endSearch = strpos($kml, "</coordinates>", $midSearch+1);

   $longlat = substr($kml, $midSearch+13, $endSearch-($midSearch+13));
   return $longlat;
}

function saveName($filename) {
   $saveFile = "kmlfilename.txt";
   $fh = fopen($saveFile, 'w') or die("Can't create file");
   $stringData = "$filename";
   fwrite($fh, $stringData);
   fclose($fh);
   header("Location: initgmaps.html");
}
?> 
```

地图初始化：

```
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8P7CzxiwQFf-RdK9QVRpH9se8AsMSsjEsensor=false"></script>
<script type="text/javascript">
function initialize() {
  var kmlName = getName()
  var kmlCoords = getCoords()
  var mapcenter = new google.maps.LatLng(kmlCoords);
  var myOptions = {
    zoom: 11,
    center: mapcenter,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }

  var map = new google.maps.Map(document.getElementById("infoArea"), myOptions);

  var kmlLayer = new google.maps.KmlLayer(kmlName);
  kmlLayer.setMap(map);
}
</script> 
```

相关AJAX函数：

```
<script language="javascript" type="text/javascript">
<!-- 
//Browser Support Code
function getName(){
    var ajaxRequest;  // The variable that makes Ajax possible!
    var kmlName;
    try{
        // Opera 8.0+, Firefox, Safari
        ajaxRequest = new XMLHttpRequest();
    } catch (e){
        // Internet Explorer Browsers
        try{
            ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
            try{
                ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
            } catch (e){
                // Something went wrong
                alert("Your browser does not support AJAX.");
                return false;
            }
        }
    }
       // Create a function that will receive data sent from the server
       ajaxRequest.onreadystatechange = function(){
            if(ajaxRequest.readyState == 4 && ajaxRequest.status == 200){
               kmlName = ajaxRequest.responseText;   
               }
       }
       ajaxRequest.open("GET", "kmlfilename.txt", false);
       ajaxRequest.send(null);
}
//-->

<script language="javascript" type="text/javascript">
<!-- 
//Browser Support Code
function getCoords(){
    var ajaxRequest;  // The variable that makes Ajax possible!
    var kmlCoords;
    try{
        // Opera 8.0+, Firefox, Safari
        ajaxRequest = new XMLHttpRequest();
    } catch (e){
        // Internet Explorer Browsers
        try{
            ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
            try{
                ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
            } catch (e){
                // Something went wrong
                alert("Your browser does not support AJAX.");
                return false;
            }
        }
    }
       // Create a function that will receive data sent from the server
       ajaxRequest.onreadystatechange = function(){
            if(ajaxRequest.readyState == 4 && ajaxRequest.status == 200){
               kmlCoords = ajaxRequest.responseText;   
               }
       }
       ajaxRequest.open("GET", "kmlcenter.txt", false);
       ajaxRequest.send(null);
}
//--> 
```

当然，在 initgmaps.html 的正文中，我有：

```
onload="initialize()" 
```

infoArea 是我的内联框架的 ID。

谁能看到为什么它不加载？我对网络开发完全陌生，边走边学，如果代码很糟糕，我很抱歉，我确信我犯了一些明显的错误。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:36:40.653

尝试在您的密钥之后和 sensor=false 参数之前添加一个 & 符号。

## 此外

var kmlCoords = getCoords()

是 javascript，但函数 getCoords() 是 PHP。Javascript 无法执行 PHP 函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:35:02.443

```
<script type="text/javascript"
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8P7CzxiwQFf-RdK9QVRpH9se8AsMSsjEsensor=false"></script> 
```

你在这里错过了一个＆符号......应该是：

```
<script type="text/javascript"
  src="https://maps.googleapis.com/maps/api/js?key=[[YOUR-GMAPS-KEY]]&sensor=false"></script> 
```

（其中**[[YOUR-GMAPS-KEY]]**是您的 Google 地图密钥 - “ *AIzaSyB8P7CzxiwQFf-RdK9QV...* ”。）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-10-22T18:37:25.093

该错误可能是由于不遵循此格式引起的：

***src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY"***

看，在“YOUR_API_KEY”之后不应该有“sensor=false”。试试看。希望它有效。

# c# - SQL Server 存储过程在查询分析器中执行，但在 C# 中无法正常运行

> ID：11543599
> 
> 赞同：0
> 
> 时间：2012-07-18T14:24:17.213
> 
> 标签：c#, sql-server

我有一个更新我的数据库的存储过程。

它在查询分析器中运行良好，但是当我尝试从我的 C# Web 应用程序运行它时，表没有更新。

我收到以下错误，所以我将 ARITHABORT 设置为“ON”，但我仍然收到错误。

> 更新失败，因为以下 SET 选项的设置不正确：“ARITHABORT”。验证 SET 选项是否适用于索引视图和/或计算列上的索引和/或查询通知和/或 xml 数据类型方法。

C#代码：

```
p = new SqlParameter("@userAnswers", SqlDbType.VarChar, 1000);
p.Value = "";
p.Value = exam.ExamQuestions.Rows[0].ItemArray[0] + ":" + exam.UserAnswerChoices[0];

for (int x = 1; x < exam.NumQuestions; x++)
{
    p.Value+= ", " + exam.ExamQuestions.Rows[x].ItemArray[0] + ":" + exam.UserAnswerChoices[x];
}

conn.query("insertAnswers", p);
return p.Value.ToString(); 
```

存储过程代码：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ARITHABORT ON
GO
ALTER PROCEDURE [dbo].[insertAnswers] 
@userAnswers VarChar(1000)
AS
BEGIN
SET NOCOUNT ON;
DECLARE @input XML
Set @input = '<Questions><Question id="' + Replace(Replace(@userAnswers, ':', '">'), ', ', '</Question><Question id="') + '</Question>' + '</Questions>'

;WITH ParsedXML AS
(
SELECT
    ID = C.value('(@id)[1]', 'int'),
    ColumnName = C.value('(.)[1]', 'varchar(10)')
FROM @input.nodes('/Questions/Question') AS T(C)
)
UPDATE CourseQuestions 
SET a = CASE WHEN p.ColumnName = 'a' THEN t.a + 1 ELSE t.a END,
    b = CASE WHEN p.ColumnName = 'b' THEN t.b + 1 ELSE t.b END,
    c = CASE WHEN p.ColumnName = 'c' THEN t.c + 1 ELSE t.c END,
    d = CASE WHEN p.ColumnName = 'd' THEN t.d + 1 ELSE t.d END,
    e = CASE WHEN p.ColumnName = 'e' THEN t.e + 1 ELSE t.e END,
    f = CASE WHEN p.ColumnName = 'f' THEN t.f + 1 ELSE t.f END
FROM CourseQuestions t
INNER JOIN ParsedXml p ON t.QuestionID = p.ID
END 
```

`@userAnswers`基本上是一个逗号分隔的字符串（因为我无法将数组发送到 SQL Server）。它看起来像：'1：d，2：a，3：b'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:29:42.237

有几件事要检查；

Management Studio 中的执行/常规+高级选项，确保您没有在那里设置一些奇怪的东西。默认情况下打开的常见嫌疑人是：

QUOTED_IDENTIFIER

ANSI_NULL_DFLT_ON

ANSI_PADDING

ANSI_WARNINGS

ANSI_NULLS

CONCAT_NULL_YIELDS_NULL

ARITHABORT（您已经检查过）

您是否有机会实际发布正在执行的查询，否则我们有点盲目。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-18T14:40:42.640

在这里野刺，但是 C# 代码可以处理已经包含 : 或 ' 的文本吗？或者您传递的串联字符串是否超过 1000 个字符？

另一方面，您应该使用 StringBuilder 进行连接，因为它在大多数情况下提供了更好的性能，尤其是当您进行许多连接时。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-18T14:45:32.353

SET ARITHABORT ON 不在存储过程中

```
ALTER PROCEDURE [dbo].[insertAnswers]  
@userAnswers VarChar(1000) 
AS 
BEGIN 
SET NOCOUNT ON
SET ARITHABORT ON
..... 
```

没有测试过。如果这不起作用，请尝试

```
strSQL = "SET ARITHABORT ON" & chr(13) & chr(10) & "EXEC MySPRoc ..."
conn.Execute strSQL 
```

# javascript - 如何从数组中删除元素？

> ID：11543602
> 
> 赞同：27
> 
> 时间：2012-07-18T14:24:41.367
> 
> 标签：javascript, arrays

> **可能重复：**
> [如何在 JavaScript 中清空数组](https://stackoverflow.com/questions/1232040/how-to-empty-an-array-in-javascript)

如何从jQuery数组中删除所有项目？

我有数组 `var myArray = [];`，我想在每次回帖时清除此数组中的所有项目。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-07-18T14:25:41.033

最简单的事情就是

```
myArray = []; 
```

再次。

*编辑*——正如评论中指出的，在回答其他问题时，另一个“最简单的事情”是

```
myArray.length = 0; 
```

并且具有保留相同数组对象的优点。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-18T14:28:07.600

您可以使用数组长度删除 myArray 中的所有项目，这是常见的模式。

试试这个

```
var myArray = [1, 2, 3];    
myArray.length = 0; // remove all item 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:25:41.283

没有 jQuery 数组之类的东西，它只是一个 javascript 数组。当一个页面回发时，它会重新渲染并且所有的 javascript 都会重新运行，您不需要清除数组的内容。

如果在页面执行期间，您想清除一个 javascript 数组，只需将其重新初始化为一个新的空白数组：

```
myArray = []; // no var, we are just initializing not declaring 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T14:26:44.950

要清除数组值，您可以执行以下操作：

```
myarray = []; 
```

附言

```
jQuery != javascript 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T14:26:56.570

这是您可以在 javascript 中对数组执行[的方法列表](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/prototype)

# firefox - Firefox 问题：页面加载期间脚本面板处于非活动状态

> ID：11543611
> 
> 赞同：1
> 
> 时间：2012-07-18T14:25:16.133
> 
> 标签：firefox

我下载了最新的 firefox 14.0.1 并开始收到“脚本面板在页面加载期间处于非活动状态”，谷歌查看大部分网站的分辨率解释了私人浏览器功能。经过一些研究，我发现从工具菜单禁用私人浏览本身（给出的链接以下）

[http://support.mozilla.org/en-US/questions/921609](http://support.mozilla.org/en-US/questions/921609)

但我仍然看到“脚本面板处于非活动状态”消息。有什么解决方案我必须忍受它...我什至尝试使用其他版本的萤火虫，但我仍然看到这个问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:34:17.180

转到萤火虫选项（错误旁边的三角形）并启用“对所有网页启用”。我确信这不是你真正想要的，但它确实解决了这个问题。

# facebook - 如何在 iOS 中同时为 facebook 进行身份验证和 requestWithGraphPath？

> ID：11543612
> 
> 赞同：0
> 
> 时间：2012-07-18T14:25:24.697
> 
> 标签：facebook, facebook-graph-api, facebook-authentication, facebook-ios-sdk

我正在将我的 iOS 应用程序与 facebook 集成。我想同时验证和发送 requestWithGraphPath 。我怎样才能做到这一点？现在写我正在使用以下代码：

```
 if (!facebook.isSessionValid) {
            NSLog(@"in else login button tapped");
            NSArray *permissions = [[NSArray alloc] initWithObjects:
                                    @"user_likes", 
                                    @"publish_stream",
                                    @"user_about_me",
                                    @"email",
                                    nil];
            [facebook authorize:permissions];
            [permissions release];

            [facebook requestWithGraphPath:@"me" andDelegate:self]; 
        } 
```

但是在调用 requestWithGraphPath 之后。我的应用程序一直在等待。但是下次当我再次按下按钮时，它就可以正常工作了。当 facebook.isSessionValid 为 false 时，authentication 和 requestWithGraphPath 可以同时工作吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T08:54:20.433

授权后，如果您已正确设置委托。用户回到你的应用程序，方法：

```
 -(void)fbDidLogin {

 } 
```

应该触发，你可以在那里请求graphPath。

# amazon-s3 - 重复性，亚马逊 s3 后端异常

> ID：11543615
> 
> 赞同：8
> 
> 时间：2012-07-18T14:25:34.373
> 
> 标签：amazon-s3, backup, duplicity

我正在尝试按照本指南在亚马逊 s3 中使用重复性创建自动备份：[easy server backups to amazon s3 with duplicity](http://icelab.com.au/articles/easy-server-backups-to-amazon-s3-with-duplicity/)

但是，在此命令中：

```
duplicity /var/www s3+http://com.mycorp.myhost.backup 
```

我遇到错误：

```
BackendException: Could not initialize backend: No module named boot 
```

谷歌搜索对我来说不会产生可以理解的结果。仅供参考，我运行的实际命令是：

```
duplicity /Users/okyretina/Dropbox/archive/ s3+http://com.sinkdrive.okyretina.dropbox.archieve 
```

我知道本指南适用于 linux，我使用的是 mac osx lion，但我认为它也应该可以工作。任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-30T13:10:23.500

如果您在 debian/ubuntu 上，您可以通过以下方式安装它： sudo apt-get install python-boto

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-11-01T16:55:16.763

升级到 Ubuntu 19.10 并且安装没有帮助时，我*再次*遇到了同样的问题。`python-boto`原来`python3-boto`在较新的版本中是必需的。

```
sudo apt install python3-boto 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T13:34:23.113

原来我需要先从[这里安装boto](https://github.com/boto/boto)

# linux - 如何在静态地图 PNG 文件上显示坐标，因为它们是从 R 中的 GPS 接收的？

> ID：11543620
> 
> 赞同：0
> 
> 时间：2012-07-18T14:25:45.027
> 
> 标签：linux, r, qt, rinside, rgooglemaps

所以，目前我已经成功编译了程序（使用**RInside**），用于在 Google 的静态地图（在**Qt**上）上绘制坐标。

现在，我必须在地图上绘制从 GPS 接收到的坐标。

**是否有可能以某种方式“即时”在 png 上*显示新绘制的点？*
我的意思是我不希望每次收到新点时都从*硬盘中读取 png。***

* * *

从这里：[http ://cran.r-project.org/web/packages/png/png.pdf](http://cran.r-project.org/web/packages/png/png.pdf)

> 这个包提供了一种简单的方法来读取、写入和显示以 PNG 格式存储的位图图像。它可以读写文件**和内存中的原始向量**。

这有什么帮助吗？

* * *

```
#include <RInside.h>
#include <Rcpp.h>
#include <iostream>

int main (int argc, char *argv[])
{
    std :: cout << "\nThank-SO :-)\n";

    RInside R (argc, argv);

    std :: string txtA = "library(RgoogleMaps)";
    std :: string txtB = "png(filename='Rg.png', width=480, height=480)";

    std :: string txtC = "lat = c(40.702147,40.718217,40.711614)";
    std :: string txtD = "lon = c(-74.012318,-74.015794,-73.998284)";
    std :: string txtE = "center = c(mean(lat), mean(lon))";
    std :: string txtF = "zoom <- min(MaxZoom(range(lat), range(lon)))";

    std :: string txtG = "MyMap <- GetMap(center=center, zoom=zoom, markers='&40.702147,-74.015794,blues%7C40.711614,-74.012318,greeng%7C40.718217,-73.998284,redc', destfile='My.png')";

    std :: string txtH = "tmp <- PlotOnStaticMap(MyMap,lat=c(40.702147,40.711614,40.718217),lon=c(-74.015794,-74.012318,-73.998284),cex=1.5,pch=20,col=c('red', 'blue', 'green'),add=F)";

    std :: string txtI = "dev.off()";

    R.parseEvalQ (txtA);
    R.parseEvalQ (txtB);
    R.parseEvalQ (txtC);
    R.parseEvalQ (txtD);
    R.parseEvalQ (txtE);
    R.parseEvalQ (txtF);
    R.parseEvalQ (txtG);
    R.parseEvalQ (txtH);
    R.parseEvalQ (txtI);

    return 0;
} 
```

这是`C++`用`RInside`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T16:17:46.657

您可以使用`png`您提到的包（或其他工具）自己绘制地图，然后您需要某种方式在绘图坐标和 gps 坐标之间进行映射。

如果地图区域足够小以至于您对笛卡尔近似值感到满意，那么一种简单的方法是使用包中的`updateusr`函数`TeachingDemos`来更改绘图坐标以匹配您的纬度/经度信息，您需要知道纬度并在地图上长 2 个点，您可以使用该`locator`功能找到它们的原始坐标（或者如果它们是角落，那么您可能不需要`locator`）。然后，您可以使用该`points`功能在地图顶部添加点，而无需重新读取或重新绘制它。如果地图是城市或更小的区域，这可能很好，但如果您试图显示整个国家，则可能会开始受到近似值的影响。

对于不同的投影，您可以找到一种从纬度/经度转换为当前绘图坐标的方法，然后`points`与转换后的坐标一起使用。`sp`包和其他可能在这里有所帮助。

需要考虑的其他几个包（如果包中的当前功能还不够，您仍然可以查看代码以获取想法和/或修改代码以使用您的 png 文件）是`RgoogleMaps`和`ggmap`.

# javascript - 单击标记时，地理编码器正在返回先前存储的值

> ID：11543621
> 
> 赞同：0
> 
> 时间：2012-07-18T14:25:46.727
> 
> 标签：javascript, google-maps-api-3

我正在使用 google map api v3 (javascript) 实现地理编码器。我正在放置多个标记，当我单击标记时，我希望相应的地址出现在信息窗口中。但是当我单击标记时，最初的默认值地址（根据代码地理地址不可用！）即将到来，当我单击第二个标记时，它具有先前单击的标记的地址。我附上这段代码。

```
 var addr=" Geo-Address Unavailable!";
    var geocoder = new google.maps.Geocoder();
    for(var i = 0; i < latLngs.length-1; i++){ //latLngs is the array of latlongs
       marker = new google.maps.Marker({
        position: latlng,
        id:markerId,
        icon: image,
        map: map,
        animation : google.maps.Animation.DROP,
             });
     }
     markers[markerId] = marker;
      var infowindow = new google.maps.InfoWindow({
                    content: "loading..."
                });
                google.maps.event.addListener(marker, "click", function () {
                    geocoder.geocode({'latLng': this.getPosition()}, function(results, status) {
                        if (status == google.maps.GeocoderStatus.OK) {
                                addr = results[0].formatted_address;

                            }
                    });

                    infowindow.setContent(addr);
                    infowindow.open(map, this);
                }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:33:13.883

地理编码是异步的。您必须在地理编码器的回调中使用返回的值。

怎么了：

1.  您向地理编码器发送请求。
2.  你显示响应
3.  响应来自地理编码器
4.  您向地理编码器发送另一个请求
5.  您显示对第一个请求的响应
6.  响应从地理编码器返回到第二个请求

# serial-port - 用于创建标准调制解调器的示例 inf 文件

> ID：11543622
> 
> 赞同：2
> 
> 时间：2012-07-18T14:25:48.337
> 
> 标签：serial-port, modem, inf

我开始参与通过 USB 在我的嵌入式设备（GSM 调制解调器）和我的电脑之间创建 PPP 连接。我的职责是为我的 USB（笔记本电脑端）到串行（RS232 嵌入式设备端）嵌入式设备（GSM 调制解调器）安装驱动程序。我计划使用创建虚拟 COM 端口的 Usbser.sys 文件。

我的疑问是如何创建调制解调器以与串行设备通信。我开始知道它可以通过使用 inf 文件来完成。

有人可以给我一些示例 inf 文件吗？

用于将 COM 端口转换为标准调制解调器链路。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T10:26:01.413

嘿查看 MSDN 文档。

[http://msdn.microsoft.com/en-us/library/windows/hardware/ff542605%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff542605%28v=vs.85%29.aspx) [http://www.osronline.com/ddkx/modem/modemref1_9wz6.htm](http://www.osronline.com/ddkx/modem/modemref1_9wz6.htm)

[imodem-readme.pdf](http://www.usr.com/support/imodem/imodem-files/imodem-readme.pdf)

希望它可能会有所帮助。

# c++ - 将数组作为 C++ 中方法的 const 参数传递

> ID：11543625
> 
> 赞同：13
> 
> 时间：2012-07-18T14:25:53.957
> 
> 标签：c++, arrays, methods, arguments, constants

我希望能够将 const 数组参数传递给 C++ 中的方法。

我知道，当您将数组传递给方法时，它与将指针传递给数组的第一项相同，因此一种简单的方法是使用指针。

```
void myMethod(int * const inTab) 
```

但是有时拥有一个数组会更好，例如，您可以编写数组的大小。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-18T14:32:55.137

您可以使用获取数组大小的模板：http: [//ideone.com/0Qhra](http://ideone.com/0Qhra)

```
template <size_t N>
void myMethod ( const int (& intArray) [N] )
{
    std::cout << "Array of " << N << " ints\n";
    return;
} 
```

编辑：避免代码膨胀的一种可能方法是拥有一个函数，该函数接受一个指针和一个执行实际工作的大小：

```
void myMethodImpl ( const int * intArray, size_t n ); 
```

和一个调用它的简单模板，很容易内联。

```
template <size_t N>
void myMethod ( const int (& intArray) [N] )
    { myMethodImpl ( intArray, N ); } 
```

当然，您必须找到一种方法来测试它是否始终被内联，但您确实获得了安全性和易用性。即使在不是的情况下，您也可以以相对较小的成本获得好处。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-18T14:58:49.720

每 3.9.3:2

> 任何应用于数组类型的 cv 限定符都会影响数组元素类型，而不是数组类型 (8.3.4)。

和 8.3.4:1

> 任何形式的“cv-qualifier-seq array of NT”都被调整为“array of N cv-qualifier-seq T”，同样适用于“array of unknown bound of T”。

此外，根据 8.3.5:5

> 在确定每个参数的类型后，将“T的数组”或“返回T的函数”类型的任何参数分别调整为“指向T的指针”或“返回T的函数的指针”。

这意味着在采用数组参数的函数中，参数类型实际上是一个指针，并且由于 3.9.3:2，该指针是非 cv 限定的：

```
void foo(const int parameter[10]) {
    parameter = nullptr;   // this compiles!
} 
```

这不会影响函数本身的类型，因为 8.3.5:5 中有另一个子句

> 在生成参数类型列表后，任何修改参数类型的顶级 cv 限定符都会在形成函数类型时被删除。

因此，如果您希望能够传递带有 cv 限定符的数组，它*必须*是通过引用：

```
void foo(const int (&parameter)[10]); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-18T14:38:04.107

不知道是不是你问的，但也许是你要找的

```
void func (const int array[10])
{
    //array[0] = 12345; // this wouldn't compile, so 'const' works
}

int main ()
{
    int array[10];
    func(array);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-18T14:29:38.667

如果您需要数组的大小：

```
template < std::size_t Size >
void myMethod( const int ( &inTab )[ Size ] ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-10T15:01:23.643

尝试`std::vector`

```
void myMethod(const std::vector<int> &inTab); 
```

# java - 使用 JAXP 在 XML 文档中插入表格

> ID：11543633
> 
> 赞同：1
> 
> 时间：2012-07-18T14:26:07.913
> 
> 标签：java, xml, jaxp

我想为我用 JAXP (DOM) 创建的 XML 文档做一个很好的演示。

我知道我可以在创建文件后读/写我的文件，但我想要更优雅的东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T08:12:40.290

```
transformer.setOutputProperty("{http://xml.apache.org/xslt}indent-amount", "2"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:32:21.807

您可以使用 XMLOutputter 输出格式化的 XML。

代码：

```
 XMLOutputter XMLOUTPUTTER = new XMLOutputter(
            org.jdom.output.Format.getPrettyFormat());
 XMLOUTPUTTER.outputString(doc); 
```

# python - 使用 xlwt 在 Excel 中从 SQL 打印 unicode 字符

> ID：11543641
> 
> 赞同：1
> 
> 时间：2012-07-18T14:26:22.903
> 
> 标签：python, unicode, xlwt

我正在使用 Python 使用 ODBC 连接从 MSSQL 数据库中提取数据。然后我尝试使用 xlwt 将提取的数据放入 Excel 文件中。

但是，这会产生以下错误：

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0xd8 in position 20: ordinal not in range(128) 
```

我已经运行脚本来打印数据，并确定数据库中的违规字符是一个带有斜线的 O。在 python 打印上，它显示为“\xd8”。

xlwt 的工作表编码设置为 UTF-8。

有没有办法让这个直接进入Excel？

**编辑**

完整的错误信息如下：

```
C:\>python dbtest1.py
Traceback (most recent call last):
  File "dbtest1.py", line 24, in <module>
    ws.write(i,j,item)
  File "build\bdist.win32\egg\xlwt\Worksheet.py", line 1032, in write
  File "build\bdist.win32\egg\xlwt\Row.py", line 240, in write
  File "build\bdist.win32\egg\xlwt\Workbook.py", line 309, in add_str
  File "build\bdist.win32\egg\xlwt\BIFFRecords.py", line 25, in add_str
  File "C:\Python27\lib\encodings\utf_8.py", line 16, in decode 
    return codecs.utf_8_decode(input, errors, True)
UnicodeDecodeError: 'utf8' codec can't decode byte 0xd8 in position 20: invalid
continuation byte 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T09:10:21.270

将工作簿编码设置为“latin-1”似乎也达到了同样的效果：

```
wb = xlwt.Workbook(encoding='latin-1') 
```

（之前设置为 'UTF-8'）

另一个答案在我的情况下不起作用，因为还有其他字段不是字符串。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-18T14:29:05.790

SQL 提取似乎返回使用 ascii 编码的字符串。您可以使用以下方法将它们转换为 unicode：

```
data = unicode(input_string, 'latin-1') 
```

然后，您可以使用 xlwt 将它们放入电子表格中。

# javascript - 在javascript上使用动画将对象从中心移动到角落？

> ID：11543643
> 
> 赞同：0
> 
> 时间：2012-07-18T14:26:39.977
> 
> 标签：javascript, jquery, animation

它是我想要的基本 Flash 动画。但我不想使用 Flash。

首先，我想在介绍屏幕上看到大徽标，它会随着动画移动到更小的左角。

执行此操作的最佳做​​法是什么。任何示例？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:30:43.137

你应该使用[animate()](http://api.jquery.com/animate/)

[这是 jsfiddle 示例，只需单击](http://jsfiddle.net/YBAaM/)

CSS：

```
.logo { position:absolute; left:0px; top:0px; } 
```

jQuery：

```
$(document).ready(function(){
  //when document ready
  $('.logo').animate({'left':'960px'},1000); //1000 = 1second

  //click animation
  $('.logo').click(function(){
     $(this).animate({'left':'960px'},1000); // you can set left/top or you can do it with margins
  });

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:29:45.403

[具有所有正确值的jquery animate](http://api.jquery.com/animate/)可以很容易地做到这一点。

# c# - 保持将使用任务计划程序运行的控制台应用程序更新

> ID：11543651
> 
> 赞同：2
> 
> 时间：2012-07-18T14:27:00.830
> 
> 标签：c#, deployment, console-application, publishing

我有一个 Web 应用程序、控制台应用程序（和 Windows 服务，但这可能是另一个问题）的解决方案。

发布和保持 Web 应用程序是最新的很容易。我只需右键单击`Publish`初始发布或更新实时版本。

* * *

目前要“发布”或更新控制台应用程序，我将发布 exe 和文件复制到实时机器。这样我就可以使用任务管理器在复制的位置运行exe了。

这对我来说是一种不好的做法。在控制台应用程序上右键单击的问题`Publish`是任务计划程序无法轻松启动 exe。此外，我不确定在更新应用程序时会发生什么。“更新可用”屏幕会坐在那里等待用户单击确定吗？

* * *

**轻松发布和保持控制台应用程序最新的最佳方式是什么？**
理想情况下，我只需要在 Visual Studio (2008) 中完成。我需要能够设置任务计划程序然后忘记它（无需对任务计划程序执行任何操作或在更新时单击任何内容）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:45:29.597

应用程序的自动部署部分听起来像[持续集成](http://en.wikipedia.org/wiki/Continuous_integration)。您可能对 TDD 部分不感兴趣，因此您可以只关注允许您从存储库（例如 SVN）获取代码、构建和自动部署它的工具。

就个人而言，根据个人经验，我只会在后台环境中这样做，对于生产我会坚持手动复制 exe（当然还要保留备份！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:33:31.513

就我个人而言，对于这些服务器端可执行文件，我只是复制了 exe。如果你要更新它们很多，并且你想确保你不会把它们放在错误的文件夹中或错过一个文件，你可以编写一个 .bat 脚本来为你进行复制，这样你就可以双击它.

老实说，如果您经常部署新程序以至于这对您来说是一个主要问题，那么我会说您遇到了不同的问题。您不应该经常对生产应用程序进行更改。目前可能有一些代码驱动的东西应该是数据驱动的，这样您就可以通过修改数据库、配置文件等而不是程序的代码来对程序进行所需的修改。

# java - 在 Android SQLite 数据库 onCreate() 中重新抛出异常

> ID：11543658
> 
> 赞同：1
> 
> 时间：2012-07-18T14:27:15.867
> 
> 标签：java, android, database, sqlite, create-table

嘿，这是我创建新数据库时当然会调用的 SQLiteDatabase 的 onCreate 方法。我想抓住任何问题并记录下来，然后重新抛出它以便在上面处理。但是编译器不允许我重新抛出异常，抱怨它没有被处理。这是在写着“throw e;”的那一行。

```
@Override
public void onCreate(SQLiteDatabase db) {//arg0?
    db.beginTransaction();
    try {
        Checklist.createTable(db);
        Item.createTable(db);
        db.setTransactionSuccessful();
    } catch (Exception e) {
        Log.e(KnowUrStuffApp.TAG,"KusDBHelper.onCreate: " + e.getLocalizedMessage());           
        db.endTransaction();
        throw e;//SYNTAX ERROR: Unhandled Exception Type Exception
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:43:15.257

你的问题是，你抛出了一个*检查*异常。仅当出现此异常时才能执行此操作

1.  直接被`try/catch`-block捕获和处理
2.  `throws SomeException`或者通过添加到您的[方法签名](http://docs.oracle.com/javase/tutorial/java/javaOO/methods.html)“向上”抛出异常。

但是，在您的情况下，您将覆盖`onCreate()`-method，该方法（在基类中）不会引发检查异常。因此，您不能覆盖该方法并添加`throws`到签名中，因为那将不再是覆盖。

你可以做的是，`RuntimeException`向上抛出一个，它不需要添加到方法签名中：

```
Log.e(KnowUrStuffApp.TAG,"KusDBHelper.onCreate: " + e.getLocalizedMessage());           
db.endTransaction();
throw new RuntimeException(e); // Add the checked exception as the cause! 
```

有关异常（抛出和捕获）的更多信息，请参阅我的博客文章：[捕获实践](http://codeisland.org/2012/catching-practice/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:28:18.967

```
public void onCreate(SQLiteDatabase db) throws Exception {//arg0? 
```

**编辑**：谢谢，抛出*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:29:56.750

改变

```
public void onCreate(SQLiteDatabase db) { 
```

至

```
public void onCreate(SQLiteDatabase db) throws Exception{ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T14:30:27.727

添加`throws Exception`到您的方法中。

# wcf - 为什么我在 wcf 反序列化时得到空数据？

> ID：11543665
> 
> 赞同：0
> 
> 时间：2012-07-18T14:27:31.347
> 
> 标签：wcf, deserialization, nettcpbinding

我有一个系统，我在不同的点对点通信通道之间交换消息 - 在 Windows 和嵌入式系统之间，并且已经完成了这一切作为非常标准的自定义序列化/反序列化功能几乎完全手动完成，因为这很容易在 Windows 端的 C# 和嵌入式的 C 之间移植。

现在我想添加一个在整个网络上的 PC 之间进行通信的块。与其做另一批相同的事情，不如使用 TcpClient/TcpListener 并跟踪重叠的消息和响应，我决定看看 WCF。

在查看了这里的大量消息以及其他地方的文档等之后，我想出了一个非常简单的应用程序来交换消息，服务器包含一个接收和返回接口实例的函数，而不是一个固定的类。尽管该示例只有一种消息 - 因此仅使用 KnownType 和 ServiceKnownType 属性设置了一种类型，但我认为可以发送数十种不同类型的消息，并且我希望能够添加它们随着事情的发展，相当容易。

尽管代码没有生成错误，但在远端实例化的对象没有任何发送的数据。我已经尝试过数据包嗅探，看看我是否可以确认数据确实在网络上传输，但我无法理解网络协议。所以我不知道数据是在客户端传输时消失还是在服务器中消失。如果我将代码更改为直接使用 TestMessageType 的实例而不是使用接口，它就可以正常工作。

该解决方案由三个项目组成；一个“类型”程序集，然后是引用该程序集的客户端和服务器控制台应用程序。类型程序集包含此代码；

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ServiceModel;
using System.Runtime.Serialization;

namespace WCF_TCP_Sandpit
{

    public interface ITestInterface
    {
        Int64 I64Value {get; set;}
    }

    [ServiceContract]
    public interface IServer
    {
        [OperationContract]
        [ServiceKnownType(typeof(TestMessageType))]
        ITestInterface Test(ITestInterface msg);
    }

    [DataContract]
    [KnownType(typeof(TestMessageType))]
    public class TestMessageType : ITestInterface
    {
        Int64 _v1;

        public long I64Value
        {
            get { return _v1;  }
            set { _v1 = value; }
        }

        public static Type[] KnownTypes()
        {
            return new Type[] { typeof(TestMessageType) };   
        }
    }
} 
```

服务器代码是

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ServiceModel;
using WCF_TCP_Sandpit;
using System.Runtime.Serialization;

namespace Server
{  
    class Program : IServer
    {
        static void Main(string[] args)
        {
            using (ServiceHost serviceHost = new ServiceHost(typeof(Program), new Uri("net.tcp://127.0.0.1:9000")))
            {
                serviceHost.Open();

                // The service can now be accessed.
                Console.WriteLine("The service is ready.");
                Console.WriteLine("Press <ENTER> to terminate service.");
                Console.WriteLine();
                Console.ReadLine();
            }

        }

        #region IServer Members

        public ITestInterface Test(ITestInterface msg)
        {
            ITestInterface reply = new TestMessageType();

            reply.I64Value = msg.I64Value * 2;
            return reply;
        }

        #endregion 
    }
} 
```

客户端代码是

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using WCF_TCP_Sandpit;

using System.ServiceModel;

namespace Client
{
    class Program
    {
        static void Main(string[] args)
        {
            ITestInterface m,r;
            int i = 0;
            ChannelFactory<WCF_TCP_Sandpit.IServer> srv
                = new ChannelFactory<WCF_TCP_Sandpit.IServer>
                (new NetTcpBinding(), "net.tcp://127.0.0.1:9000");

            WCF_TCP_Sandpit.IServer s;
            s = srv.CreateChannel();

            while (true)
            {
                m = new WCF_TCP_Sandpit.TestMessageType();
                m.I64Value = i++;

                r = s.Test(m);

                Console.WriteLine("Sent " + m.I64Value + "; received " + r.I64Value);
                System.Threading.Thread.Sleep(1000);
            }
        }
    }
} 
```

任何人都可以对出了什么问题有所了解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T15:18:50.073

您不需要`DataMember`属性上的`I64Value`属性吗？

# c++ - 通过两个 WT12 蓝牙模块之间的蓝牙 ssh

> ID：11543677
> 
> 赞同：0
> 
> 时间：2012-07-18T14:28:04.347
> 
> 标签：c++, ssh, embedded, embedded-linux

我使用两个 WT12 bluegiga 蓝牙模块。我需要通过 ssh 中的蓝牙在它们之间传输文件。有没有人尝试过做类似的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:38:27.647

尝试使用 PAN 在它们之间建立 IP 网络，然后使用 scp。

我认为这个[HOWTO](http://bluez.sourceforge.net/contrib/HOWTO-PAN)可以是一个很好的起点。

# javascript - 带有分组类别的小胡子模板

> ID：11543684
> 
> 赞同：0
> 
> 时间：2012-07-18T14:28:12.513
> 
> 标签：javascript, mustache

我正在尝试呈现以下列表：

```
 var servicesList1 = {
        services : [
            {title: "Service 1 Lorem", category: "Category 1", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 2 Lorem", category: "Category 1", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 3 Lorem", category: "Category 1", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 4 Lorem", category: "Category 1", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 5 Lorem", category: "Category 2", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 6 Lorem", category: "Category 2", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 7 Lorem", category: "Category 2", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 8 Lorem", category: "Category 2", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."}
        ]
    }; 
```

使用以下模板：

```
{{#services}}
<h3>{{category}}</h3>
<article>
    <section class="service-image {{imageClass}}"></section>
    <h4>{{title}}</h4>
    <p>{{description}}</p>
</article>
{{/services}} 
```

但我只希望 {{category}} 显示值何时发生变化。

IE

第一类

```
Title 1
Description 1

Title 2
Description 2

Title 3
Description 3 
```

第 2 类

```
Title 4
Description 4

Title 5
Description 5

Title 6
Description 6 
```

这是可行的吗？

谢谢，斯科特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:48:27.123

您将不得不进行一些重组`servicesList1`。如果要按类别组织模板，则必须以相同的方式组织数据。

```
var servicesList1 = {
    categories : [
        {
            name: "Category 1",
            services: [
                {title: "Service 1 Lorem", category: "Category 1", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
                {title: "Service 2 Lorem", category: "Category 1", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            ]
        },
        {
            name: "Category 2",
            services: [
                {title: "Service 3 Lorem", category: "Category 2", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
                {title: "Service 4 Lorem", category: "Category 2", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            ]
        }
    ]
}; 
```

模板将是这样的。

```
{{#categories}}
    <h3>{{name}}</h3>
    {{#services}}
        <article>
            <section class="service-image {{imageClass}}"></section>
            <h4>{{title}}</h4>
            <p>{{description}}</p>
        </article>
    {{/services}}
{{/categories}} 
```

您可以`category`像我一样将属性保留在每个服务对象中，也可以将其取出。如果您使用不是 JavaScript 的 Mustache 实现，我会保留它。例如，Coldfusion 实现在向后遍历链时遇到了麻烦。因此，如果您需要显示每项服务的类别，我会将其保留，否则我会将其取出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:57:24.403

如果您将对象更改为以下内容，则可以这样做：

```
var servicesList1 = {
    categories:[
        {name: "Category 1", services:[
            {title: "Service 1 Lorem", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 2 Lorem", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 3 Lorem", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 4 Lorem", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
        ]},
        {name: "Category 2", services:[
            {title: "Service 5 Lorem", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 6 Lorem", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 7 Lorem", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."},
            {title: "Service 8 Lorem", imageClass : "", description: "Lorem ipsum dolor sit amet consectetur adipiscing elit aliquam interdum."}
        ]}
    ]
}; 
```

您的模板可能如下所示：

```
{{#categories}}
    <h3>{{name}}</h3>
    {{#services}}
        <article>
            <section class="service-image {{imageClass}}"></section>
            <h4>{{title}}</h4>
            <p>{{description}}</p>
        </article>
    {{/services}}
{{/categories}} 
```

这应该可以完成工作；但是如果你不能改变我建议运行一个javascript函数的对象。

# c# - 在两个值之间振荡或“乒乓”？

> ID：11543685
> 
> 赞同：2
> 
> 时间：2012-07-18T14:28:13.687
> 
> 标签：c#, algorithm, math

我有一条在时间“t”评估的路径，并根据路径类型返回方向和位置。

time 的值受路径类型的影响：

```
switch (type)
{
    case PathType.Closed:
        time = ToolBox.Wrap(time, StartTime, EndTime);
        break; // Wrap time around the path time to loop

    case PathType.Open:
        time = ToolBox.Min(time, EndTime);
        break; // Clamp the time value to the max path time range

    case PathType.Oscillating:
        break;
} 
```

缺失的环节在摆动。

我的问题是什么是在两个值之间振荡的一种好的、有效的方法？

例如 (2, 7)。如果时间达到 7，它会反转并减少到 2，一旦达到 2，它就会反转并增加到 7。

该算法应该知道是否根据原始值增加/减少该值，因此如果值为 9，则它知道答案是 7 - (Abs(7 - 9)。如果值为 14，则该值已环绕，因此它将导致增加1。

较高的值也会增加或减少该值，具体取决于它环绕原始范围的次数。

我希望这是有道理的，因为我发现很难解释。

编辑：

不随浮点值振荡：

```
 for (float i = 0; i < 100; i += 0.1f)
        {
            Console.WriteLine("{0} {1}", i, Oscillate(2.5f, 7.5f, i));
        }

    private float Oscillate(float min, float max, float value)
    {
        float range = max - min;

        float multiple = value / range;

        bool ascending = multiple % 2 == 0;
        float modulus = value % range;

        return ascending ? modulus + min : max - modulus;
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-18T15:11:17.097

这是我想出的：

```
public static int Oscillate(int input, int min, int max)
{
    int range = max - min ;
    return min + Math.Abs(((input + range) % (range * 2)) - range);
} 
```

我假设`input`将是一个从 0 开始的计数器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-18T17:35:04.903

理想情况下，您应该将此功能抽象为某种类，而不必担心在使用它时实现的实际工作方式。这是 C++ 中的初步看法（我的 C# 有点生疏）。我认为您可以毫不费力地将其用于 C#。

```
class oscillator
{
  private:
    float min;
    float max;

    static float mod(float num, float div)
    {
        float ratio = num / div;
        return div * (ratio - std::floor(ratio));
    }

  public:
    oscillator(float a, float b)
      : min(a < b ? a : b), max(a > b ? a : b) {}

    float range() ( return max-min; }

    float cycle_length() { return 2*range(); } 

    float normalize(float val)
    {
        float state = mod(val-min, cycle_length());

        if (state > range())
            state = cycle_length()-state;

        return state + min;
    }
};
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-18T14:39:37.360

这将使您的数字在 2 和 7 之间振荡，在此示例中，时间是一个整数：

```
bool isIncreasing = time <= 7;
for (int i = 0; i < 20; i++) //some random loop
{
    time = time + (isIncreasing ? 1 : -1);
    if (time >= 7 || time <= 2) isIncreasing = !isIncreasing;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T14:55:26.367

考虑浮点值的新答案：

```
 // Note: Increase FACTOR depending on how many decimal places of accuracy you need.
    private const float FACTOR = 10;

    public void Test()
    {
        for (float i = 0; i < 1000; i += 0.1F)
        {
            Console.WriteLine("{0} {1}", i, Oscillate(2.5F, 7.5F, i));
        }
    }

    private float Oscillate(float min, float max, float time)
    {
        return (float)(Oscillate_Aux(Upscale(min), Upscale(max), Upscale(time))) / FACTOR;
    }

    private int Upscale(float value)
    {
        return (int)(value * FACTOR);
    }

    private int Oscillate_Aux(int min, int max, int time)
    {
        int range = max - min;

        int multiple = time / range;

        bool ascending = multiple % 2 == 0;
        int modulus = time % range;

        return ascending ? modulus + min : max - modulus;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T15:03:19.113

您所描述的听起来很像两个值之间的周期性线性插值。考虑使用 XNA 的[MathHelper.Lerp](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.mathhelper.lerp.aspx)函数作为振荡的基础。

请注意，它使用百分比来控制振荡作为其第三个参数。您必须弄清楚如何将您的时间 t 值转换为百分位数，但您可以从 ex 开始。sin(t) 看看事情是如何运作的。

如果您不愿意将 XNA 导入您的项目，核心方程式非常简单：

```
value1 + (value2 - value1) * amount 
```

**编辑**：如果您的问题的核心是“什么是在两个值之间振荡的好、有效的方法？”，那么 Math.Sin(t)（或 Cos）可以为您提供 0 和 1 之间的常规振荡。

* * *

# javascript - 相对于其他元素的 Jquery 索引

> ID：11543691
> 
> 赞同：-1
> 
> 时间：2012-07-18T14:28:32.577
> 
> 标签：javascript, jquery, indexing

我想知道是否可以找到与具有相同类的元素数量相关的元素索引，如果可以，我将如何去做？

所以如果我有以下...

```
<div class="container">
    <p>This is content 1</p>
    <p>This is content 2</p>
    <p>This is content 3</p>
</div>

    ...other HTML

<div class="container">
    <p>This is content 1</p>
    <p>This is content 2</p>
    <p>This is content 3</p>
</div> 
```

然后单击第一个容器中的项目，它将返回索引 1，但如果单击第二个容器中的项目，它将返回索引 2，因为它是具有“容器”类的第二个 div。

这可能吗？如果是这样，怎么办？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:30:54.133

```
$(function() {
    $('.container p').on('click', function() {
      var index = $(this)   // point the clicked p
                      .parent()  // jump to .container parent
                      .index() +1;  // get index, As index() is zero based, so you can
                                    // add 1 to get 1,2,...
      alert( index );
    });
}): 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:33:01.730

你可以试试这样

```
$(document).ready(function(){
    $('div.container p').click(function(){
        alert($(this).parent().index());
    });
});​ 
```

[活生生的例子](http://jsfiddle.net/mG7yy/)

# android - 如何使用 DriverManager 为 getConnection 放置正确的“url”？

> ID：11543695
> 
> 赞同：0
> 
> 时间：2012-07-18T14:28:39.550
> 
> 标签：android, mysql, jdbc, database-connection

我正在尝试连接到 Android 应用程序中的 MySQL 数据库，但无法这样做。

我用于连接 MySQL 数据库的 URL 是：`jdbc:mysql://xx.xx.x.xxx/dbname`，其中 xx.xx.x.xxx 代表我的服务器的 IP 地址。该数据库`dbname`由该服务器上的 phpMyAdmin 管理。

但我总是收到同样的错误：`com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure`

我的清单中有互联网许可。

我正在使用的代码：

```
private void callSQL() {
    java.sql.Connection laConnection;
    java.sql.Statement transmission;
    ResultSet leResultat;

    try {
            Class.forName("com.mysql.jdbc.Driver").newInstance();
            laConnection= DriverManager.getConnection("jdbc:mysql://xx.xx.x.xxx/dbname", "user", "passwrd");

            transmission = laConnection.createStatement();
            leResultat= transmission.executeQuery("select * from Communes");

            while (leResultat.next()) {
                System.out.println("Commune : "+ leResultat.getString("Nom"));
            }
    }catch(Exception e){
        System.out.println(e);
    }
} 
```

我已经能够在连接到数据库的 PHP 页面上使用带有 HTTP 请求的另一种解决方案。这个解决方案效果很好，但哪一个是最好的使用方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T08:26:28.763

我找到了解决方案。问题不在于代码。问题是连接。我没有连接数据库的权限。允许远程用户对数据库的权限，就可以了。

# mysql - MySQL - 即时计算百分位数排名

> ID：11543696
> 
> 赞同：2
> 
> 时间：2012-07-18T14:28:41.390
> 
> 标签：mysql

我有一个 MySQL SELECT 查询，它在同一个表中使用 20 个不同的比较。这是一个例子：

```
SELECT * FROM mytable
WHERE (col1 > (col2 * 0.25))
AND (col5 < col10) ....... 
```

`SCORE`我正在尝试根据返回的`SELECT`结果中调用的列的顺序来计算百分位等级。我尝试使用增量行号并`COUNT(*)`获取股票的排名和返回的结果总数，但不确定如何在某些结果相同的情况下分配相同的排名`SCORE`。

这是我要计算的公式：

```
((COUNT(lower scores) + (COUNT(same/tied scores) / 2)) * 100) / COUNT(total results) 
```

如何在同一结果行中找到较低分数、相同/并列分数和总分的数量，以便即时计算百分位数？

我试图避免使用存储过程，因为我希望我的应用程序管理员根据需要在我的应用程序管理区域中定制 SELECT 语句。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T05:44:12.087

使用上面的 Shlomi 的代码，这是我想出的用于计算百分位等级的代码（以防将来有人想计算这些）：

```
SELECT 
    c.id, c.score, ROUND(((@rank - rank) / @rank) * 100, 2) AS percentile_rank
FROM
    (SELECT 
    *,
        @prev:=@curr,
        @curr:=a.score,
        @rank:=IF(@prev = @curr, @rank, @rank + 1) AS rank
    FROM
        (SELECT id, score FROM mytable) AS a,
        (SELECT @curr:= null, @prev:= null, @rank:= 0) AS b
ORDER BY score DESC) AS c; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:37:37.627

这是一篇（我的）帖子，它解释了以下期间的排名`SELECT`：[SQL: Rank without Self Join](http://code.openark.org/blog/mysql/sql-ranking-without-self-join)。

它使用用户定义的变量，即使在迭代行时也可以访问和分配这些变量。

使用相同的逻辑，它可以扩展到包括总分数、不同分数等。作为预览，这是一个典型的查询：

```
SELECT
  score_id, student_name, score,
  @prev := @curr,
  @curr := score,
  @rank := IF(@prev = @curr, @rank, @rank+1) AS rank
FROM
  score,
  (SELECT @curr := null, @prev := null, @rank := 0) sel1
ORDER BY score DESC
; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-25T15:55:18.880

来自 Shlomi 和 Zishan（使用 Shlomi 的代码）的响应肯定不会给出准确的结果，正如我通过在我的一张大表上检查结果发现的那样。正如在其他地方回答的那样，显然不可能在单个 MySQL 查询中计算百分位等级： [SQL rank percentile](https://stackoverflow.com/questions/15241247/sql-rank-percentile/27649407#27649407)

使用用户定义变量的 Shlomi Noach 方法确实**- 起初 - 看起来**对于排名前几个百分比的排名很好，但对于表中排名较低的行，它很快就会退化。像我一样，亲自查看您的数据结果。

请参阅 Roland Bouman 的这篇博客文章，了解为什么 Shlomi**在单个 SQL 语句**中使用用户定义变量的方法不起作用，并提出了更好的解决方案：

[http://rpbouman.blogspot.com/2009/09/mysql-another-ranking-trick.html](http://rpbouman.blogspot.com/2009/09/mysql-another-ranking-trick.html)

因此，我为此目的修改了 Bouman 的代码，这是我的解决方案，它必然结合了 PHP 和 MySQL：

步骤 1) 通过提交以下两个查询计算并存储每行的绝对排名：

```
SET @@group_concat_max_len := @@max_allowed_packet;

UPDATE mytable INNER JOIN (SELECT ID, FIND_IN_SET(
    score,
        (SELECT GROUP_CONCAT(
             DISTINCT score
             ORDER BY score  DESC
            )
        FROM mytable)
        ) AS rank
FROM mytable) AS a
ON mytable.ID=a.ID
SET mytable.rank = rank; 
```

第 2 步：获取总行数（并将结果存储在 PHP 变量 $total 中）

```
SELECT COUNT(ID) FROM mytable 
```

第 3 步：使用 PHP 循环遍历表以使用每行的绝对排名来计算行的百分排名：

3a）循环：

```
SELECT ID, rank FROM mytable 
```

在 PHP 中将这些行值存储为 $ID 和 $rank

3b) 对于每一行运行：

```
$sql = 'UPDATE mytable INNER JOIN (
            SELECT (100*COUNT(ID)/'.$total.') percentile
            FROM mytable
            WHERE rank >= '.$rank.'
        ) a 
        ON mytable.ID = a.ID
        WHERE mytable.ID='.$ID.'
        SET mytable.percentile = a.percentile'; 
```

可能不是最有效的过程，但绝对准确，因为在我的情况下，'score' 值不会经常更新，所以我将上述脚本作为 cron 批处理操作运行，以保持百分位数排名最新。

# java - 注释类是否有通配符

> ID：11543699
> 
> 赞同：1
> 
> 时间：2012-07-18T14:28:48.007
> 
> 标签：java, annotations

持久对象：

```
@Entity
public class PersistentModelObject{
  ...
} 
```

我需要类似的东西：

```
interface GenericDao<T annotated_with Entity>{
  //crud
} 
```

或者可以以某种方式模拟它（扩展、实现等）。

编辑：请理解我的问题的人将其编辑到可以理解的水平。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:44:24.927

我不认为你可以通过泛型使用这样的注释，但你可以使用 java.lang.Class java.lang.reflect.Field isAnnotationPresent(YourAnnotation.class) 来检查一个类是否被某个注释注释。

更好的方法可能是使用标记接口？就像是：

```
public class PersistentModelObject implements MyPersistableType{
     ...
} 
```

和

```
interface MyPersistableType {} //marker interface 
```

然后你可以像这样使用它：

```
interface GenericDao<T extends MyPersistableType>{
  //crud
} 
```

但是话又说回来，这取决于您要解决的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:45:32.240

只能在运行时使用反射检查此限制。

# ruby - ruby 中的类和模块

> ID：11543700
> 
> 赞同：2
> 
> 时间：2012-07-18T14:28:48.403
> 
> 标签：ruby, class, module

你能告诉我我们应该在哪里使用模块和在哪里使用类吗？我的意思是 Ruby 中模块的可用性和适用性原则是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:08:15.943

*模块是方法和常量的集合。他们不能生成实例。类可以生成实例（对象），并具有每个实例的状态（实例变量）。模块可以混合到类和其他模块中。混合模块的常量和方法融入了该类自己的，增强了该类的功能。然而，类不能混入任何东西。一个类可以从另一个类继承，但不能从一个模块继承。一个模块不能继承任何东西。--[红宝石常见问题解答](http://www.rootr.net/rubyfaq-8.html)*

类是可靠的抽象，只包含重要的东西，模块是可以为我提供信息或服务的容器，此外还可以成为保持奇异性的地方。例如，我们可以对害羞的人进行分类，而胆怯是该分类的一个奇点。ShyPeople 可能是一个类，而 Timidity 可能是 ShyPeople 类中包含的一个模块。

'什么重要？'，'是模块的方法还是类的方法？或者“它会是一个类还是一个模块？” 是只有经验和 RL 的类比才能帮助你的问题。有关更多详细信息，我建议您阅读和编码 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:36:34.950

我的简单经验法则是，如果我需要保持对象的内部状态，例如创建实例变量，我将使用一个类。
我将模块用于其他一切。这包括命名空间、mixin 和实用程序对象。

[一些基本的命名空间和 Mixin 信息](http://ruby-doc.org/docs/ProgrammingRuby/html/tut_modules.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:50:35.200

类**是**模块。不同之处在于可以实例化一个类。

两者的使用实际上取决于您的类/模块将如何使用，它代表什么，......

这个问题没有最终的答案。无论如何（恕我直言），这是您通过阅读和编写代码，学习习语，设计模式，...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T14:38:32.400

本质上，Ruby 模块就像一个类，但没有对象工厂部分。通常 Ruby 开发人员使用模块来存储必须由多个类使用的方法组。除其他外，这是避免使用非常反红宝石模式的子类的好方法。

无论如何，这几乎是一个无法在短时间内正确回答的哲学问题。也许您应该尝试阅读有关 Ruby 基础知识的书（例如，Eloquent Ruby）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-22T20:03:38.233

在 ruby​​ 中，模块由方法、变量和常量组成，类似于类，只是它缺乏实例化的能力。

模块通常包含或扩展在类中，具体取决于您希望如何公开和使用它包含的方法。如果您希望模块的方法、变量和常量在包含它的类的每个对象中都可用，则包含模块。如果您希望模块的方法、变量和常量对类可用而不是不可用，则扩展模块TO 类的实例。

Ruby 类采用单继承，即一个类只有一个父类/超类。但是，ruby 允许您通过在类中包含模块来“某种程度地”模拟多重继承，这个概念被称为 mixins。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-26T18:26:34.453

模块用作命名空间和混合。Ruby 不支持多重继承。但是，在某些情况下，一个类会通过获取在多个其他类中定义的方法而受益。这可以通过使用称为模块的构造来实现。模块有点类似于类，只是它不支持继承，也不支持实例化。它主要用作存储多个方法的容器。使用模块的一种方法是在类中使用包含或扩展语句。这样，类就可以访问模块中定义的所有方法和对象。据说模块是混在课堂上的。因此，mixin 只是一个包含在类中的模块。单个模块可以混入多个类，单个类可以混入多个模块；因此，Ruby 施加的任何限制

所有模块都是 Module 类的实例。

```
module Foo
end

Foo.instance_of? Module  # Output: => true 
```

在下面的示例中，Person 类中包含 JapaneseGreetings 模块（作为 mixin）。

```
module JapaneseGreetings
  def  hello
    puts "Konnichiwa"
  end

  def goodbye
    puts "Sayōnara"
  end
end

class Person
  include JapaneseGreetings
end

p = Person.new
p.hello  # Output: Konnichiwa
p.goodbye  # Output: Sayōnara 
```

## 类是模块

所有类都是名为 Class 的内置类的实例？好吧，Class 是 Module 的子类（另一个内置类）。

```
Class.superclass  # Output: => Module 
```

大多数用于操作类的内置方法都定义在 Module 类中。

```
Module.instance_methods(false)
 => [:<=>, :module_exec, :class_exec, :<=, :>=, :==, :===, :include?, :included_modules, :ancestors, :name,
 :public_instance_methods, :instance_methods, :private_instance_methods, :protected_instance_methods, :const_get,
 :constants, :const_defined?, :const_set, :class_variables, :class_variable_get, :remove_class_variable,
 :class_variable_defined?, :class_variable_set, :private_constant, :public_constant, :singleton_class?,
 :deprecate_constant, :freeze, :inspect, :module_eval, :const_missing, :prepend, :method_defined?, :class_eval,
 :public_method_defined?, :private_method_defined?, :<, :public_class_method, :>, :protected_method_defined?,
 :private_class_method, :to_s, :autoload, :autoload?, :instance_method, :public_instance_method, :include] 
```

在超类中实现“通用”代码（可以在不同的上下文中使用）并在子类中添加额外的专业化是标准做法。一个例子是 Class 类如何从 Module 类继承所有上述实例方法并实现三个附加方法。

```
Class.instance_methods(false)
 => [:new, :allocate, :superclass] 
```

allocate 方法分配内存并创建一个新的“空”类实例，而不调用 initialize 方法。新方法调用 allocate，然后在新创建的对象上调用 initialize 方法。至于超类，它返回给定类的超类的名称。

在他的《Ruby 编程语言》一书中，Yukihiro Matsumoto（Ruby 的创造者，AKA Matz）演示了如果用 Ruby 编写新方法会是什么样子：

```
def new(*args)
  o = self.allocate # Create a new object of this class
  o.initialize(*args) # Call the object's initialize method with our args
  o # Return new object; ignore return value of initialize
end 
```

简而言之，我们可以说类是具有两个重要的额外功能的模块：继承和实例化。另一个区别是，与模块不同，类不能用作混合。

# java - 不确定如何处理应用程序设计

> ID：11543708
> 
> 赞同：5
> 
> 时间：2012-07-18T14:29:05.680
> 
> 标签：java

我正在尝试在 Java 中创建一个应用程序，该应用程序允许从小种子图生成大的出处图，但我在找出设计类的最佳方法时遇到了一些麻烦。

首先，Provenance 本质上具有图结构、节点和边。我创建了一个 Java 库，它充当出处数据模型到 Java 对象的映射。这允许我从 Provenance 模型中抽象出我的应用程序特定信息。

我的类结构看起来有点像这样：

*   图（包含节点集和边集）
*   抽象节点（现在只是一个字符串名称）
    *   代理人
    *   活动
    *   实体
    *   Node的其他子类
*   抽象边缘
    *   一代
    *   协会
    *   Edge 的其他子类

现在，我想做的是在充当乘数/饱和度级别的节点和边上提供权重。有几种方法可以使用该库来实现这一目标，但我不清楚从开发和可维护性的角度来看什么是最好的。

首先，我使用一些简单的方法定义了一个 Weighable 接口，例如获取和设置最小和最大权重。

现在，我可以扩展每个子类节点，例如

```
class WeighableAgent extends Agent implements Weighable 
```

但这需要为每种类型的可用节点提供扩展类，并要求我在每个级别实现 Weighable 接口。

或者，我可以提供一个 mixin，但它仍然依赖于我在每个子类中实现相同的功能。

或者，我可以有一个基于 Agent 的类，但这仍然需要我在每个组合类中实现 Weighable。

或者，我可以只在 Node 类上作曲，例如

```
class WeighableNode implements Weighable {

    private Node node;

    public WeighableNode(Node node) {
        this.node = node;
    }

    etc etc... 
```

这将允许我只在一个地方实现 Weighable。但是，然后我从使用 WeighableNode 的任何内容中丢失了有关具体类类型的一些重要信息，而我看到的唯一解决方法是提供一个方法：

```
Node getNode(); 
```

由于得墨忒耳定律，我很担心。此外，这个 WeighableNode 将由 PresentationNode 组成，以帮助 Swing，这意味着我最终会链接调用，例如：

```
presentationNode.getWeighableNode().getNode() instanceof Agent 
```

这似乎很不愉快。

我刚刚想到的一个最终解决方案是如上所述在 Node 上进行组合，然后使用 WeighableAgent 等扩展 WeighableNode。这意味着我不需要每次都重新实现 Weighable，如果我知道我有

```
instanceof WeighableAgent 
```

那么被包装的节点就是一个代理。

我很欣赏这很长，但我希望有经验的开发人员能很快看到正确的设计实践。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T15:59:44.053

太糟糕了，Java 既没有真正的 mixin，也没有多重继承……</p>

# 通用包装器

我想我会`WeighableNode<NodeType extends Node>`用作*通用*包装器类型。这样，所有需要特定类型节点的地方都可以清楚地说明这一事实。它的`getNode`方法可以返回正确的类。而且你不会到处都有太多的课程。

# 转换成语

即使您不使用上述方法，以下成语也可能很有趣：

```
class Node {
    public T asNode(Class<T extends Node> clazz) {
        return clazz.cast(this);
    }
}

class NodeWrapper<N extends Node> {
    private N realNode;
    public T asNode(Class<T extends Node> clazz) {
        try {
            return super.asNode(clazz);
        }
        catch (ClassCastException e) {
            return realNode.asNode(clazz);
        }
    }
} 
```

如果您愿意，您可以将上述内容更改为返回`null`而不是抛出异常。这个想法是调用代码不必担心如何将您的节点转换为各种类型。你会例如简单地写

```
presentationNode.getNode(Agent.class) 
```

这将实现与接口分开，让您在以后有需要时可以自由地进行更改。基本`Node`实现将知道如何转换自己，照顾派生类。将`NodeWrapper`使用组合添加转换。您可以将其用作`WeighableNode`和您的`presentationNode`.

# 胖接口

您可以自己实现称重的东西`Node`，并`WeighedNode`仅用作标记接口，或者根本不使用。不是最好的解决方案，但会帮助减少类的数量，并且除了额外数据消耗的内存位之外不应该造成任何真正的伤害。到目前为止，其他方案所需的间接级别可能会超过内存需求。

# java - 如何将数组的值设置为参数？

> ID：11543714
> 
> 赞同：0
> 
> 时间：2012-07-18T14:29:19.863
> 
> 标签：java, arrays

我想从类路径调用方法路径。我需要在入口处设置一些数字 - 数组长度和适当的数组值。这是我的课：

```
class Path {
 int number;
 String[] path_name = new String [number];
 Path (int n, String [] p){
     number=n; 
     path_name=p; 
 }
public void path(){
 for (int i=1; i<number; i++){
     driver.findElement(By.linkText(path_name[i])).click();  
 }
} 
```

}

这就是我尝试调用方法的方式：

```
Path pa = new Path (6,'array value');
  pa.path(); 
```

但我不知道如何正确启动“数组值” - 例如，我需要设置“一”、“二”、“三”。有人可以帮忙吗？

我不知道开头的数组长度，所以我不能在构造函数中定义几个字符串

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:42:31.970

你的班级有很多问题。

首先直接写入类变量的变量的初始化是在构造函数体执行**之前完成的。**因此，您对数组的初始化`path_name`将始终使用默认值`number`and完成`0`。这可行，但您的数组将无法以这种方式存储任何值。

现在在你的身体里，我猜你试图用`path_name`数组的内容填充你的`p`数组。但是，您替换了实例。这工作得很好，但如果有人在类之外更改数组，它也会在这个类中更改。我猜您想使用`System.arraycopy`or传输值`Arrays.copyOf`。

对于您的构造函数的调用，您必须调用如下内容：

```
new Path(6, new String[] {"one", "two", ...}); 
```

作为改进，我建议您完全删除该`number`变量，因为您可以随时使用`path_name.length`.

您可能想要研究的另一件事是可变长度参数。如果您像这样更改构造函数：

```
Path(int n, String p...){
     number=n; 
     path_name = p
} 
```

您设置在构造函数调用中的数字之后添加未定义数量的字符串。所有这些字符串都自动打包在一个名为 的字符串数组中`p`。由于此数组仅存在于此构造函数中，因此您可以安全地复制实例而不是变量。构造函数的调用如下所示：

```
new Path(6, "one", "two", ...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:33:15.183

尝试类似：

```
Path pa = new Path(6, String[] {"one", "two", "three"} ); 
```

如果您可以更改代码，您可能可以使用 varargs 使其更容易：

```
Path (int n, String p...) 
```

然后你可以：

```
Path pa = new Path(6, "one", "two", "three"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:36:59.950

如果我理解您的要求正确，我认为这就是您想要的-

```
class Path { 
 int number; 
 String[] path_name; 
 Path (int length){ 
     path_name = new String[length];
     for(int i=1;i<=length;i++)
         path_name[i-1] = Integer.ToString(i); 
 } 
} 
```

这假设您希望数组为 1...n。如果你想要任何你想要的字符串元素，我认为这可能是一个更好的解决方案，我会做

```
 class Path { 
 int number; 
 String[] path_name; 
 Path (String p){ 
     path_name = p;
 }

 public void some_method(){ 
    String[] a = {"one", "two", "three"};
    Path p = new Path(a);
 }
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T14:37:03.077

您可以在 Path 实例化之前初始化一个 String 数组，如下所示：

```
String[] p = {"one", "two", "three"};
Path pa = new Path(6, p); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T14:38:50.403

如果您接受数组的所有元素都是路径的有效元素的不变量，则可以消除您引用的 n 数字。

考虑到这一点，您可以简单地拥有

```
class Path {
    final String[] pathNames;
    // uses var args
    Path(String... paths) {
         pathNames = paths;
    }
    void path() {
        // uses enhanced for loop
        for(String path : pathNames) {
            driver.findElement(By.linkText(path)).click();
        }
    }
} 
```

一些批评：

*   `number`创建对象时，您当前正在创建一个大小数组。但此时数字为 0。所以你正在创建一个空数组。
*   但是上述观点无关紧要，因为您正在立即重新分配参考...
*   因为您不是在防御性地复制数组，所以一些外部代码可能会修改数组的元素。这可能不是一件好事。（这是由 var args 解决的，其中没有外部代码可以访问该数组。你不能阻止某人传递一个数组而不是 var args，但他们至少会意识到你期望 var args ，因此如果他们*愿意*，他们仍然有能力在内部进行更改，但不太可能以这种方式*意外*引入错误。）

# gtk - 为什么即使 iter 有效，gtk_tree_selection_select_iter() 也不选择另一行的子行？

> ID：11543716
> 
> 赞同：0
> 
> 时间：2012-07-18T14:29:22.883
> 
> 标签：gtk, gtk2, gtktreeview

我有一个[带有](http://sscce.org/)[.](http://pastebin.com/cNLQHujY) _ [`GtkTreeView`](http://developer.gnome.org/gtk/2.24/GtkTreeView.html)每次选择一行时，都会调用一个回调。此回调应检索选定的行并以某种方式处理其数据。

我的应用程序有时必须选择此树视图本身的某些行：

```
// Selecting a line
gtk_tree_model_get_iter_from_string(GTK_TREE_MODEL(model), &iter, "0");
GtkTreeSelection *selection =
        gtk_tree_view_get_selection(GTK_TREE_VIEW(tree_view));
gtk_tree_selection_select_iter(selection, &iter); 
```

当我必须选择顶层线时，这很有效，即直接从根下降的线。但是，如果我尝试选择一个子行（例如，第三行的第一个子行），我在回调函数中遇到错误（[此处](http://pastebin.com/BG0ztDP7)为 sscce 代码，仅在第 42 行更改）：

```
// Selecting a line
gtk_tree_model_get_iter_from_string(GTK_TREE_MODEL(model), &iter, "2:0");
GtkTreeSelection *selection =
        gtk_tree_view_get_selection(GTK_TREE_VIEW(tree_view));
gtk_tree_selection_select_iter(selection, &iter); 
```

错误是以下警告，后跟段错误：

> (treetest:1843): Gtk-CRITICAL **: gtk_tree_store_get_path: 断言 `iter->user_data != NULL' 失败
> 
> （treetest：1843）：Gtk-CRITICAL **：IA__gtk_tree_model_get_string_from_iter：断言“路径！= NULL”失败

此外，当我用鼠标选择同一行时，这个错误永远不会发生。

怎么会这样？选择的路径`"2:0"`是有效的，但从选择返回的迭代器不是，所以我认为该行没有被选择。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:29:22.883

问题是顶层线被折叠了。它的子行是隐藏的，因此无法选择。

[一种解决方案是在选择其中一个子行之前以编程方式扩展父行（此处](http://pastebin.com/NcrGM0kX)为 sscce 代码）：

```
// Expanding
GtkTreePath *path = gtk_tree_path_new_from_string("2");
gtk_tree_view_expand_row(GTK_TREE_VIEW(tree_view), path, TRUE);
// Selecting a line
gtk_tree_model_get_iter_from_string(GTK_TREE_MODEL(model), &iter, "2:0");
GtkTreeSelection *selection =
        gtk_tree_view_get_selection(GTK_TREE_VIEW(tree_view));
gtk_tree_selection_select_iter(selection, &iter); 
```

当然，这个错误只会在我以编程方式选择行时发生，因为无法选择折叠行的子项单击它。

# ssh - 如何在连接后使用 ssh 运行本地命令并在执行此本地命令后退出？

> ID：11543720
> 
> 赞同：9
> 
> 时间：2012-07-18T14:29:26.570
> 
> 标签：ssh, portforwarding

我希望使用 SSH 建立一个临时端口转发，运行本地命令然后退出，关闭 ssh 连接。

该命令必须在本地运行，而不是在远程站点上运行。

例如，考虑 DMZ 中的服务器，您需要允许计算机中的应用程序连接到端口 8080，但您只有 SSH 访问权限。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T14:40:55.597

假设您从命令行使用 OpenSSH....

SSH 可以打开一个连接，该连接将维持隧道并尽可能长时间保持活动状态：

```
ssh -fNT -Llocalport:remotehost:remoteport targetserver 
```

您也可以让 SSH 在服务器上启动一些运行一段时间的东西。隧道将在那个时候开放。只要隧道仍在使用中，远程命令退出后 SSH 连接就应该保持。如果您只使用一次隧道，则指定一个短暂的“睡眠”，让隧道在使用后过期。

```
ssh -f -Llocalport:remotehost:remoteport targetserver sleep 10 
```

如果您希望能够从本地运行的脚本中*终止*隧道，那么我建议您在 shell 中将其作为后台，然后记录 pid 以便稍后终止。假设您使用的是包含 Bourne shell 的操作系统......

```
#/bin/sh

ssh -f -Llocalport:remotehost:remoteport targetserver sleep 300 &
sshpid=$!
# Do your stuff within 300 seconds
kill $sshpid 
```

如果您不喜欢使用 shell 将 ssh 设置为后台，您还可以使用高级 ssh 功能来控制后台进程。如此[处所述](https://stackoverflow.com/a/26470428/1072112)，SSH 的功能`ControlMaster`以及`ControlPath`您如何使其工作。例如，将以下内容添加到您的`~/.ssh/config`:

```
host targetserver
    ControlMaster auto
    ControlPath ~/.ssh/cm_sockets/%r@%h:%p 
```

现在，您的第一个连接`targetserver`将设置一个控件，以便您可以执行以下操作：

```
$ ssh -fNT -Llocalport:remoteserver:remoteport targetserver
$ ssh -O check targetserver
Master running (pid=23450)
$ <do your stuff>
$ ssh -O exit targetserver
Exit request sent.
$ ssh -O check targetserver
Control socket connect(/home/sorin/.ssh/cm_socket/sorin@192.0.2.3:22): No such file or directory 
```

显然，这些命令也可以包装到您的 shell 脚本中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:41:43.863

您可以使用类似于此的脚本（未经测试）：

```
#!/bin/bash
coproc ssh -L 8080:localhost:8080 user@server
./run-local-command
echo exit >&${COPROC[1]}
wait 
```

# jquery - 当我通过 jquery 渲染图像、地图和区域标签时，ImageMapster 插件不起作用

> ID：11543721
> 
> 赞同：1
> 
> 时间：2012-07-18T14:29:26.773
> 
> 标签：jquery

我正在尝试为我的应用程序使用 ImageMapster 插件。在 html 中使用静态图像映射时效果很好。但我的问题是，当我通过 jquery 渲染图像和区域标签时，它不起作用。我正在使用 web api 来获取图像的属性。

这是我的脚本：

```
$(document).ready(function () {

       var iiim = "";
       var url = 'http://mobileappapi.azurewebsites.net/api/HomeApiImage';
       $.get(url, function (data) {
           iiim = data["BgImg"];
           var url = 'http://mobileappapi.azurewebsites.net/api/HomeApi';
           $.get(url, function (data) {

               $('#map_demo').prepend('<img  src="' + iiim + '" usemap="#usa" id="myimage" style="margin-top:43px;"/>')
               for (var i = 0; i < data.length; i++) {

                   $('#usa_image_map').append('<area href="#" coords="' + data[i].Node_Location + '" state="n' + i + '" shape="rect" title="' + data[i].Node_Title + '" />')

               }
           }, "jsonp");

       }, "jsonp");

       $('#myimage').mapster({

           fillColor: 'ff0000',
           fillOpacity: 0.3
       });
   }); 
```

这是我的html代码，

```
 <body>
<div id="map_demo"> 
</div>
    <map id="usa_image_map" name="usa">
    </map>

 </body> 
```

请帮助我，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:37:19.760

`$.get()`是一个 AJAX 函数；`.mapster`因此，在您的方法运行之前，它还没有完成生成新图像。

创建图像后，您必须将`.mapster`调用放入`.get`回调中，以确保它在正确的时间运行。

尝试这个：

```
$(document).ready(function () {

    var iiim = "";
    var url = 'http://mobileappapi.azurewebsites.net/api/HomeApiImage';
    $.get(url, function (data) {
        iiim = data["BgImg"];
        var url = 'http://mobileappapi.azurewebsites.net/api/HomeApi';
        $.get(url, function (data) {
            $('#map_demo').prepend('<img  src="' + iiim + '" usemap="#usa" id="myimage" style="margin-top:43px;"/>')
            for (var i = 0; i < data.length; i++) {
                $('#usa_image_map').append('<area href="#" coords="' + data[i].Node_Location + '" state="n' + i + '" shape="rect" title="' + data[i].Node_Title + '" />')
            }
            $('#myimage').mapster({
                fillColor: 'ff0000',
                fillOpacity: 0.3
            });
        }, "jsonp");
    }, "jsonp");

}); 
```

# c# - linq max 惰性求值

> ID：11543728
> 
> 赞同：2
> 
> 时间：2012-07-18T14:29:40.837
> 
> 标签：c#, linq, lazy-evaluation

我在理解惰性求值与 linq Max 运算符之间的关系时遇到了一些麻烦。

这是我的代码：

```
 var someList = new List<someType>
        {
            new someType { decimalValue = 32 }
        }; 
```

`line1: var valA = someList.Any() ? someList.Max(s => s.decimalValue) : 0.0M;`

`line2: var valB = someList.Any() ? someList.Max(s => s.decimalValue) : 0.0M;`

`line3: var valC = valB;`

单步执行代码时，我看到以下行为：

第 1 行执行后，`valA = 0, valB = 0, valC = 0`

在第 2 行执行后，`valA = 32, valB = 0, valC = 0`

第 3 行执行后，`valA = 32, valB = 32, valC = 32`

为什么分配`valA`后只显示一个值`valB`，为什么`valB`只显示一个值`valC`分配一次？

下面是我的调试器的截图。我想我的 IDE 一定有一些非标准的东西。

[![IDE 映像](../Images/bfe6a66419ccfcc0dfc369b573e30064.png)](https://i.stack.imgur.com/GKuhi.png)
[（来源：[toastermagic.co.uk](http://toastermagic.co.uk/images/linqMax.png)）]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:36:11.027

运算符立即执行，`Max`根本没有延迟。您所看到的只是调试器的正常行为。当它突出显示一行时，表示“我即将运行这条线”而不是“我刚刚运行了这条线”。您总是需要在“下一行”才能查看给定代码行的结果。

看来你已经解释了这一点。您看到所有更改（这不应该只是特定于 LINQ）一行的事实可能意味着您的源代码和可执行文件有点不同步。您应该对解决方案进行干净并重新构建，然后一切都会好起来的。我猜你对源代码做了一些小的修改，这些修改在构建中没有被正确提取，因此可执行文件与源代码中的行号各相差一个。

如果确实有问题，您可以尝试将代码完全移动到一个新项目（如果您的代码库足够小），以尝试摆脱导致此问题的任何损坏或损坏的文件/设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:40:46.143

无法复制：

```
 static void Main(string[] args)
    {
        var data = (from n in Enumerable.Range(0, 10)
                    select new { value = (decimal)n })
                   .ToList();

        var valA = data.Any() ? data.Max(s => s.value) : 0.0M;
        Console.WriteLine("A = {0}, B = {1}, C = {2}", valA, 0, 0);

        var valB = data.Any() ? data.Max(s => s.value) : 0.0M;
        Console.WriteLine("A = {0}, B = {1}, C = {2}", valA, valB, 0);

        var valC = valB;
        Console.WriteLine("A = {0}, B = {1}, C = {2}", valA, valB, valC);

        Console.ReadLine();
    } 
```

按预期工作。

看起来是对调试器的误读。

# ruby-on-rails - 图像缓存和重定向以处理默认图像

> ID：11543729
> 
> 赞同：1
> 
> 时间：2012-07-18T14:29:41.470
> 
> 标签：ruby-on-rails, http, caching, browser-cache

我很想知道人们将如何解决这个问题，或者是否可以使用重定向来完成。

在网站上，一个常见的问题是有一个图标来代表一个资源（比如一个用户），如果这个资源不存在，有一个默认图标。

现在说我想在标记中解决这个问题，那么它很简单：

```
# Default for user without an icon
<img src="/images/default.png" alt="theozaurus">

# For user with an icon
<img src="/images/users/theozaurus.png" alt="theozaurus"> 
```

但是，在某些情况下这可能会很痛苦：

*   预呈现标记（用户可能会在创建标记后上传图标）
*   在浏览器中动态生成的标记（发现用户是否有图标可能会很昂贵，相反，最好有简单/快速的逻辑来生成正确的 url）。

所以解决方案似乎很明显：

```
<img src="/images/users/theozaurus.png" alt="theozaurus"> 
```

然后该应用程序可以返回默认图标，或已上传的正确图标。这是低效的，好像我有一个包含 100 个这些图标的页面，其中 90% 是默认图标，我有效地下载了 90 次相同的图像，只是因为我不想处理预渲染或动态产生标记问题。

如果我使用重定向解决了这个问题，它会起作用吗（保持理智） - 并且缓存仍然有效。

例如 a `GET`to`/images/users/theozaurus.png`可以返回 a `302 /images/default.png`。然后当theozaurus上传一个图标时，它会返回`200 <unique icon>`

浏览器会在重定向时获得缓存命中吗？我在这里错过了什么陷阱吗？

# javascript - 为什么 bool(true) && string 的结果是 javascript 中的字符串？

> ID：11543735
> 
> 赞同：24
> 
> 时间：2012-07-18T14:29:49.947
> 
> 标签：javascript

测试代码是：

```
console.log(true && "abc");//abc 
```

谁能告诉我为什么会这样`abc`？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-18T14:33:15.343

来自[MDN（逻辑运算符） - 逻辑与 (&&)](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Logical_Operators)：

> 如果可以转换为 false，则返回 expr1；否则，返回 expr2。因此，当与布尔值一起使用时，如果两个操作数都为真，则 && 返回真；否则，返回 false。

`true`显然不能评估为假，因此返回第二个值“abc”。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-18T14:31:16.770

JavaScript 中的`&&`运算符与 C 或 Java 等中的运算符有些不同。它总是返回最后评估的子表达式值（无论整个表达式为真 - “真” - 或假 - “假”）并且不强制布尔结果. 当它失败时（当其中一个值是“falsy”时），结果同样是原始值，而不是值的布尔解释。

所以它是这样的：给定`A && B`，解释器执行以下操作：

1.  计算表达式 A，给出 A [V] — A 的值
2.  设 A [B]是将 A [V]转换为布尔值的结果
3.  如果 A [B]是`false`，则`&&`表达式的值为 A [V]
4.  计算表达式 B，给出 B [V]
5.  返回 B [V]作为`&&`表达式的值。

因此，在`if`语句中，`&&`表达式与 C 或 Java 中的布尔转换运算符具有相同的*效果*，因为`if`语句本身对表达式的整体结果执行真/假测试。然而，当单独使用时，它更像是“如果第一个表达式为真，则给我第二个表达式的值，否则给我第一个表达式的值”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:32:39.330

`&&`如果左侧评估为`false`，则返回左侧，否则返回右侧大小。

`true`is not `false`，因此它返回右侧，即您的字符串。

```
> 0 && true // LHS is false, return LHS
0
> 1 && true // LHS is true, return RHS
true
> false && 0 // LHS is false, return LHS
false
> true && false // LHS is true, return RHS
false 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T14:33:04.957

您可以通过将表达式包装成以下内容来“修复”该问题`!!()`：

```
!!(true && 'abc'); 
```

# regex - Postgres 将 varchar 字段设置为自身的正则表达式

> ID：11543736
> 
> 赞同：0
> 
> 时间：2012-07-18T14:29:51.657
> 
> 标签：regex, postgresql

我试图通过删除一个相当常见的后缀来规范化数据字段。我已经在 postgres 中使用**substring()**函数，但不能完全让它工作。例如，如果我想从任何具有它的值中去除后缀“xyz”；

```
UPDATE my_table SET my_field=substring(my_field from '#"%#"xyz' for '#'); 
```

但这会产生一些我无法确定的奇怪影响。有什么想法吗？非常感谢一如既往。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:38:18.150

```
UPDATE my_table
SET    my_field = left(my_field, -3)
WHERE  my_field LIKE '%xyz'; 
```

有几个原因：

*   如果您不想更改每一行，请**始终**在. 即使表达式实际上只更改了某些行。从相同的值到相同的值仍然是一个并且会产生死行和表膨胀并触发触发器......`WHERE``UPDATE``UPDATE``UPDATE`

*   `left()`与 结合使用`LIKE`。

    *   `left()`使用负的第二个参数有效地修剪字符串末尾的字符数。`left()`是在 PostgreSQL 9.1 中引入的。[我在这里](http://www.postgresql.org/docs/current/interactive/functions-string.html#FUNCTIONS-STRING-OTHER)引用手册：

    > 当 n 为负时，返回除最后一个以外的所有 |n| 人物。

    *   如果可以，请始终选择 `LIKE`正则表达式 ( )。没有那么通用，但速度更快。(在内部被重写为正则表达式)。[dba.SE 上](https://dba.stackexchange.com/a/10696/3684)此相关答案中的详细信息。`~``LIKE``SIMILAR TO`

* * *

如果要确保保留最少的字符：

```
WHERE  my_field LIKE '_%xyz'; -- prepend as many _ as you want chars left 
```

* * *

`substring()`会像这样工作（一种可能性）：

```
substring(my_field, '^(.*)xyz$'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:38:47.150

```
update my_table
   set my_field = regexp_replace(my_field, 'xyz$', '')
where my_field ~ 'xyz$'; 
```

这也会将值更改`'xyz'`为空字符串。我不知道你是否想要（或者后缀是否可以“独立”存在。

where 子句不是绝对必要的，但会使更新更有效，因为只有那些实际满足条件的行才会被更新。

# apache - 简单的modrewrite，链接怎么出现？

> ID：11543742
> 
> 赞同：0
> 
> 时间：2012-07-18T14:30:12.840
> 
> 标签：apache, .htaccess, mod-rewrite

当您使用 modrewrite 重写您的 url 时，何时发生重写。将鼠标悬停在链接上时，用户能否在重写之前看到 url？当他们将鼠标悬停在链接上时，他们的浏览器会显示重写的 url 还是使用 modrewrite 修改之前的 url？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:33:50.967

重写是在服务器中完成的，所以用户永远不会知道，PHP 也不知道它指向的只是脚本文件的链接

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:33:08.240

mod_rewrite 作用于服务器端，这意味着 apache 在响应请求之前重写传入的 URL。您添加到页面的任何 HTML 链接都将指向您输入的 URL，因为 mod_rewrite 不会修改任何传出数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:33:49.717

重写发生在 Apache 解析请求时 - 在 PHP 解释器启动之前。

# linux - 为什么 Linux (x86) 的页面大小是 4 KB，这是如何计算的？

> ID：11543748
> 
> 赞同：39
> 
> 时间：2012-07-18T14:30:28.543
> 
> 标签：linux, x86, kernel, cpu-architecture

x86 架构上 Linux 内核的默认内存页面大小为 4 KB，我想知道这是如何计算的，为什么？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-07-18T14:41:16.807

默认页面大小由 CPU 的 MMU（内存管理单元）支持的大小固定。在 32 位保护模式下，x86 支持两种页面：

*   正常的，4 KiB
*   巨大的，4 MiB

并非所有 x86 处理器都支持大页面。需要有一个具有页面大小扩展 (PSE) 功能的 CPU。这不包括奔腾之前的处理器。几乎所有当前一代的 x86 CPU 都实现了它。

4 KiB 也是其他架构中广泛流行的页面粒度。有人可能会争辩说，这个大小来自于将 32 位虚拟地址划分为页面目录/表中的两个 10 位索引，其余 12 位给出 4 KiB 页面大小。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2014-06-30T12:39:10.657

32位架构的4KB正常页面大小的设计其实很有意思：）

我想添加一个额外的答案来证明为什么它是合理的。

x86 使用“2 级页表”将虚拟内存地址转换为物理内存地址。

所以假设页目录和页表都包含![在此处输入图像描述](../Images/70b78af166457a5b1947bbfe79a7ab88.png)条目，并且页大小是![在此处输入图像描述](../Images/50b40e927102f08443f830b5d37f5d7a.png)字节。为了充分利用![在此处输入图像描述](../Images/e8ba7c14b3da67d025fb5f6ca2d0e173.png)地址，我们有：

![在此处输入图像描述](../Images/88f6151bd7f24610879049435c4a426d.png)

页目录/表中的每个条目占用 4 个字节（32 位），因此：

![在此处输入图像描述](../Images/4e3ba89749343bfbaa74a27a437f9a0e.png)

因此 y = 12，以字节为单位的页面大小将为![在此处输入图像描述](../Images/50b40e927102f08443f830b5d37f5d7a.png)= ![在此处输入图像描述](../Images/fca958847ad94e6af7ef0f35a7a472c1.png)= 4KB。

* * *

那么'1级页表'呢？这很有趣，因为从逻辑上讲，我们可以使用单个页表进行地址查找。

假设页目录包含![在此处输入图像描述](../Images/808a5a84eff8a0eb76c4c48ed4138d30.png)条目，每个条目映射一个地址到对应的页，页大小为![在此处输入图像描述](../Images/dcfb61ccd93f2e3a043ef55f1ac665a8.png)字节。

同样，为了充分利用![在此处输入图像描述](../Images/e8ba7c14b3da67d025fb5f6ca2d0e173.png)地址，我们需要：

![在此处输入图像描述](../Images/5a7a96b68ca2f6fbe2f8a25a35eecd47.png)

和：

![在此处输入图像描述](../Images/4e3ba89749343bfbaa74a27a437f9a0e.png)

我们得到 y = 17，页面大小为![在此处输入图像描述](../Images/50b40e927102f08443f830b5d37f5d7a.png)= ![在此处输入图像描述](../Images/8d618a3a8be2c5a1029e5b02fd61b381.png)= 128KB。

* * *

我们也可能会争辩说，在“2 级页表”版本中，页目录和页表可能有不同的大小。然而，这意味着我们将使用更大的页面目录，这将占用一个以上的内存页面。可悲的是，每次产生新的用户进程时，操作系统必须为其自己的页面目录分配连续的页面，这在设计上并不优雅。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2018-04-26T02:32:53.250

## 介绍

第一个支持分页虚拟内存技术的 Intel 处理器是[Intel 80386](https://en.wikipedia.org/wiki/Intel_80386)。处理器支持单一页面大小，4 KB。自从它在 1985 年发布以来，我们必须回到那个时期来理解英特尔为什么选择那个特定的页面大小。

[Atlas](https://en.wikipedia.org/wiki/Atlas_(computer))是第一台支持分页的计算机，页面大小为 3 KB，对虚拟内存的设计和相关研究产生了深远的影响。该系统是在 1958-1962 年间设计的。有趣的是，80386 支持的页面大小有点接近 Atlas 支持的页面大小，尽管 80386 是在大约 20 年后设计的，并且计算机（以及它们运行的​​工作负载）在那个时期发生了根本性的变化。时间！事实上，那个时期的许多计算机使用的页面大小在 0.5-5 KB 之间。当时的研究人员实际上花费了大量精力研究虚拟内存系统（分页和分段）。

最大的问题之一是：最佳页面大小是多少？在 60 和 70 年代发表了大量的作品，试图研究和理解页面大小对应用程序性能的影响，并推荐或提供如何选择页面大小的指南。肯定有许多论文从未发表过。据我所知，这包括来自英特尔的文档，上面写着“......因此，页面大小应为 4 KB”。但是影响页面大小或与页面大小交互的因素以及选择页面大小（或多个页面大小）的过程是众所周知的，这就是我将在此答案中基本讨论的内容。我还将特别解释为什么 4 KB 的页面大小是合理的。

## 页面大小问题

在分页方法中，物理内存被组织为一系列连续的内存区域，称为页框，它们具有相同的大小（这是分页¹的定义特征）。每个页框都可以映射到相同大小的虚拟地址空间块，称为虚拟页。

假设一个页面由`N`字节²组成（这意味着`N`根据定义，一个页框的大小也是字节）并考虑一个由`P`页面组成的虚拟地址空间（即，页码是 {0,1,2,... , `P`- 1} 并且虚拟地址的总数是`N`* `P`)。还假设物理地址空间由`F`页框组成（即页框号为 {0, 1, 2, ..., `F`- 1}，物理地址的总数为`N`* `F`）。

给定一个虚拟地址`VA`，需要一种机制（*映射设备*）来确定物理地址，`PA`它被映射到，或者如果它没有被映射，则应该引发页面错误。映射设备使用存储在某处的数据结构（页表）来执行映射。对于每个分配的虚拟页面，该表中应该有一个条目，该条目描述页面的映射方式以及可能的一些附加属性（例如保护属性）。如您所见，页表条目的设计与页面大小相互作用。稍后我将讨论 Intel 80386 中页表项的设计。

虚拟地址的大小为 log [2] ( `N`* `P`)，物理地址的大小为 log [2] ( `N`* `F`)。的一些位`VA`将表示页面内的偏移量，而其他位将表示页码，它使用映射设备标识页面。

页面大小有多少种选择？好吧，它可以小到一个字节，最多`N`*`P`或`N`* `F`，以较小者为准。这是很多选择。

## Page Size 是 2 的幂很方便

虚拟地址 ,`VA`相当于一对页码和偏移量 ( `PN`, `OFF`)。翻译过程应尽可能高效。对于程序员³来说，让一个页面中的字节在地址空间中是连续的是很方便的。这样，一个多字节数据结构中的项目的地址可以通过对单个地址的简单算术来计算，这将构成数据结构的基地址。这可以通过使用虚拟地址的最低有效 log [2] ( `N`) 位（向上舍入）来表示偏移量和其余位来表示页码来实现。

如果`N`不是 2 的幂，则偏移量和页码之间将共享一些位，具体取决于这些位的值。通过`N`2 的幂，不存在这种复杂性。因此，使用 2 的幂的页面大小会很巧妙。所有支持分页的实际处理器都使用 2 的幂的页面大小（尽管可寻址单元可能不是 8 位），这是有道理的。但老实说，目前尚不清楚这是否真的重要。使用当今的技术，无论`N`是 2 的幂可能对性能或任何其他感兴趣的指标没有任何可衡量的影响。事实上，在未来需要越来越大的页面大小时，可能会出现一些不是 2 的幂的页面大小更好的情况。但到目前为止，这还没有发生。我在这里要说明的一点是，不应自动取消使页面大小不是幂 2 的设计选项。我相信这是研究未来虚拟内存系统的好机会。

无论如何，请记住 4 KB 页面的选择是在 80 年代做出的，页面大小的如此微小的变化（理论上和实验上）被证明是无关紧要的。因此，2 次幂页面大小的便利性占了上风。这会以指数方式减少要考虑的页面大小的数量。但是我们仍然有很多选择。

## 偏爱较小的页面大小

由于映射设备工作在页级别，所以从操作系统的角度来看，分配的单位是虚拟页⁴。即使应用程序只需要分配 1 个字节，它仍然必须告诉操作系统为该 1 个字节分配整个虚拟页面。这个问题称为*内部碎片*. 每个应用程序（甚至可能是应用程序的每个组件）都有自己的虚拟地址空间，它从该空间以页面大小的块分配内存。每个应用程序不希望为它分配的单个对象使用单个页面，而是在分配更多页面之前从同一页面分配尽可能多的对象。然而，由于页面属性在页面级别起作用，同一个应用程序可能会使用多个用户模式内存管理器（例如使用多个 C/C++ 运行时时），并且应用程序很难共享它们不使用的部分页面对于其他应用程序，系统中的许多页面可能会出现内部碎片。使用较小的页面大小可以帮助减少浪费的物理（整个系统）和虚拟（每个进程）内存的数量。

此外，通常应用程序在其生命周期中会经历多个阶段，在不同阶段它们表现出不同的内存需求。例如，如果页面大小为 16 KB，但许多应用程序的许多阶段可能只需要更少的 10 KB，那么将会浪费大量物理内存，这可能会导致内存不足的情况如果支持较小的页面大小（例如 8 或 4 KB），则可以避免。

较小的页面大小更适合处理写时复制软页面错误，因为页面越小，创建它的副本所需的时间就越少。对于极小的页面大小，这可能不会产生任何可测量的差异，具体取决于内存总线带宽。

70 年代计算机中可用的典型物理内存量在 10 或 100 KB 范围内。拥有数百 KB 或更大的页面大小是没有意义的。事实上，当时的应用程序工作集通常只有几个或几十个 KB。因此，即使只有 16 KB 的页面大小也不太实用，因为只有几个页面可能会消耗所有可用的物理内存。页面大小应与物理内存量一致。这个论点当然可以应用于今天的系统（例如，拥有 128 GB 的页面是没有意义的）。

[所以考虑到70 年代和 80 年代初](https://en.wikipedia.org/wiki/Timeline_of_computing_1980%E2%80%9389)的工作集大小和物理内存可用性，页面大小应该是 2 的幂，范围为 2 ⁰ -2 ^(14)。很酷，现在我们只有 15 个选项可供选择。

## 偏爱更大的页面大小

我们也可以争辩说更大的页面大小更好。对于相同的工作集，较小的页面大小意味着每个应用程序的页面数量较多，这需要页表条目才能启用转换。无论页表的结构如何，这基本上都需要更大的页表（尽管确切的开销取决于页表条目本身的设计，我将在后面讨论）。想象一下，例如 4 字节的页面和数十 KB 的典型工作集。然后大部分物理内存实际上将被分配来保存页表，而不是数据。将页表分页到辅助存储会导致单个内存引用出现双页错误，这对性能来说绝对是可怕的。这样的设计显然是荒谬的。

从本质上讲，页面大小不应该（很多）小于可能的最小工作集大小。这立即排除了大小为 2 ⁰ -2 ⁶的页面，为我们留下了 8 个选项。70 年代和 80 年代初研究页面大小的论文大多只研究这 8 个选项。

还有另一个原因使更大的页面大小更有利。虚拟内存的好处之一是能够透明地使用除主内存之外的辅助存储来保存易失性数据。但是，辅助存储设备是机械的，并且在批量传输时性能最佳。这实际上更像是一个指导方针，我们不应该排除任何页面大小。存在具有不同设计和特性的设备，最终，批量传输的性能优势将在某个时候达到饱和。但在衡量页面大小对性能的影响时，肯定需要考虑到这一点。如果正在考虑的应用程序类型表现出很少的空间局部性，那么较小的页面大小仍然是可取的，因为将额外的字节复制到磁盘或从磁盘复制并不是完全免费的。

空间参考位置鼓励使用某些页面大小。对于非常小的页面大小，页面中的所有字节很可能会在很短的时间内被使用。随着页面大小变大，不太可能使用的字节数会增加。但是，对于非常大的页面，所有工作集都可能适合少数页面，而与位置无关。因此，为了最大限度地减少页面错误的数量，页面大小应该太小或太大，但不能介于两者之间。但最终，这会因一个应用程序而异。新兴的编程范式，例如面向对象编程和函数式编程，由于链接结构的广泛使用以及不同应用程序相互交互的方式，多线程等技术实际上可能会降低空间局部性。较大的页面大小更适合减少页面错误的数量。但是，较小的页面大小可能更适合多个应用程序之间共享的内存，以减少共享页面的内部碎片。实验还表明，可以保存在主存储器中的页框数量与页面错误的数量相关，有利于更小的页面大小。

对 TLB 的需求在当时得到了广泛认可。英特尔在他们的专利中称它们为*页面缓存*（不确定英特尔是否是第一个使用该术语的）。快速 TLB 非常重要，因为地址转换是执行指令的关键路径。为了使它们尽可能快，它们应该做得很小，但是它们只能缓存少量的页表条目。这促使使用更大的页面大小。

在寻找最佳页面大小时，事实证明没有。当时就知道需要支持多种页面大小。事实上，1965 年设计的 Multics 系统支持 64 或 1,024 字的页面（一个字的大小为 36 位）。^(在不同的场景中，2 7) -2 ^(14)范围内的页面大小在经验和理论上都是最佳的。**英特尔必须观察到 4 KB 页面可以为其客户在 80 年代使用的应用程序带来最佳的平均性能。**对于今天的计算机和应用程序，页面大小的微小差异并没有像 70 年代和 80 年代那样产生太大影响。

## Intel 80386的页表项设计

页目录项和页表项的设计在英特尔的[一项专利](https://patents.google.com/patent/US5321836A/en)中进行了详细讨论。这很重要，因为页表条目的大小和页表的整体结构在许多关于页大小的研究中都被考虑在内，因为它们都相互影响。我不想更详细地讨论这个问题，以保持答案简短。

## 近期的页面大小

几个月前，英特尔获得了一项[专利](https://patents.google.com/patent/US9858198B2/en)，该专利显然提出了一个默认页面大小为 64 KB 的系统，但同时支持 4 KB 页面（和其他 IA-32e 页面大小）以实现向后兼容性。我引用专利：

> 由于支持将 64 KB 页映射到 4 KB 子页，VA64 直接支持当前定义的所有 4 KB 页上的操作，包括每 4 KB 页的独立保护位和任意 4 KB 对齐地址映射。VA64 还支持 4 KB 边界上的操作系统内核页面管理，即使操作系统内核以 64 KB 为单位分配内存。由于支持大页面，VA64 支持将虚拟地址范围划分为现有分页系统（例如英特尔公司的 IA-32e 分页系统）支持的页面。因此，VA64 支持使用 4 KB 页面 Windows® OS 内核的应用程序和硬件设备，同时在可以使用 64 KB 页面时充分利用 64 KB 页面。
> 
> VA64 的能力可以逐渐被操作系统内核采用，而不是要求它们都在第一代支持 VA64 的操作系统内核中得到支持。例如，支持 VA64 的操作系统内核可以通过将所有页面映射到当前大小（例如，英特尔公司的 IA-32e 分页系统中的 4 KB/2 GB/1 TB）开始，但会更改为新的页表格式。在页表格式改变后，操作系统内核可以修改为以 64 KB 为单位映射虚拟内存，并在其空闲列表中更改为存储 64 KB 页面。然后，只要对齐和保护允许，操作系统内核就可以开始使用 64 KB 页面，并添加对其他 VA64 功能的支持。

除了专利中的内容外，我对 VA64 寻呼系统一无所知。互联网上的任何地方都没有任何内容。我想我们很快就会知道更多。

## 选定的参考文献

丹宁，PJ（1970）。[虚拟内存](https://courses.cs.washington.edu/courses/cse451/15wi/lectures/extra/10.1.1.117.9654.pdf)。ACM 计算调查第 2 卷第 3 期，153-189。

Gelenbe, E.、Tiberio, P. 和 Boekhorst, JCA (1973)。[按需分页系统中的页面大小](https://link.springer.com/article/10.1007%2FBF00288648)。信息学报，3（1），1-23。

Alanko, TO 和 Verkamo, AI (1983)。[虚拟内存中的分段、分页和最佳页面大小](https://www.sciencedirect.com/science/article/pii/0166531683900305)。绩效评估，3（1），13-33。

科尔巴托，FJ 和维索茨基，弗吉尼亚州（1965 年）。[Multics系统的介绍和概述](https://courses.cs.washington.edu/courses/cse451/16wi/readings/lecture_readings/MulticsDesign.pdf)。在 1965 年 11 月 30 日——1965 年 12 月 1 日的会议记录中，秋季联合计算机会议，第一部分（第 185-196 页）。

* * *

### 脚注

（1）实际上单个虚拟页面的大小可以是页框大小的倍数，但我们不要去那里。

(2) 我们可以概括公式并使用术语“字”来指代内存的最小可寻址单元而不是字节，但这并不重要。

(3) 也许不是程序员，取决于编程语言，而是编译器、链接器、汇编器和使用二进制代码的工具。

(4) 当然可以设计一个同时支持分页和非分页的系统，从而可能支持多个分配单元，但我们不要去那里。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-07-18T14:37:02.103

[这取决于处理器架构](http://en.wikipedia.org/wiki/Page_%28computer_memory%29#Page_size_trade-off)。

在许多体系结构上，默认页面大小为 4 KB。[一般可以通过切换到巨页](http://en.wikipedia.org/wiki/Page_%28computer_memory%29#Huge_pages)模式来增加（有时很多，比如AMD64的1GB） 。这允许页表更小，从而可以提高性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T14:36:12.037

我从维基百科文章中得到这个，我引用：

> 页大小通常由处理器架构决定

看看下面的文章：

[http://en.wikipedia.org/wiki/Page_(computer_memory)](http://en.wikipedia.org/wiki/Page_(computer_memory))

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-09T10:26:50.743

我添加这个答案/评论是因为 sleepsort 的计算非常有趣，我必须将它添加到我的网页中（当然要提到来源）。可以在[此处](https://stackoverflow.com/questions/11543748/why-is-the-page-size-of-linux-x86-4-kb-how-is-that-calculated%22here%22)找到如何以编程方式计算页面大小的问题的（可能）答案。sleepsort 提到的计算方式非常有趣。我对 x86_64 做了同样的事情，结果出乎我的意料。然而进一步阅读[内存管理 x86_64](https://en.wikipedia.org/wiki/Memory_management_unit#x86-64%22memory%20management%20on%20x86_64%22)我发现对于 64 位的英特尔，16 位没有使用，留给我们计算 48 位。9 位用于内存树分支，每个分支另外 9 位，这里另外 9 位用于分支，最后 9 位用于最后一个分支的叶子。因此，内存页中每个地址的 48 - 36 = 12 位。2^12 = 4096，就像 sleepsort 之前提到的那样。我只是想知道这个架构有多少通过，3 或 4（如果有人能解释的话）遵循 sleepsort 的计算：

```
2^x * 2^x * 2^x * 2^x * 2^y = 2^48
4x + y = 48

this time we have 8 bytes for each address (8 bytes * 8 bits / byte = 64 bits)

2^y / 2^3 = 2^x
y - 3 = x
filled in in previous equation:

4(y - 3) + y = 48
4y - 12 + y = 48
5y = 60
y = 12
because 2^y represents the pagesize, the size = 2^12 = 4096 bytes 
```

让我问“Linux 中的那些大页面怎么样”？

# jenkins - 使用 Jenkins 在多个环境中按顺序运行作业任务

> ID：11543752
> 
> 赞同：5
> 
> 时间：2012-07-18T14:30:33.390
> 
> 标签：jenkins, jenkins-plugins

我是詹金斯的新手。我正在尝试在单个作业中实现特定场景，以使用 Jenkins 构建移动应用程序。

在单个作业中，我想按顺序启动多个任务：任务 1 (Windows) ---> 任务 2 (Windows) ---> 任务 3 (Windows) ---> 任务 4 (Mac OSX)

每个工作都将专门用于一个项目。将结果从一个任务传递到另一个任务可以通过工作空间来实现，但似乎作业任务必须都运行在同一个环境中。是否有任何插件可以让我在特定的奴隶中运行一些工作任务？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T09:36:10.200

您可以在从属作业上**远程使用触发器构建。**然后从主作业中，您可以使用 curl 执行从属构建。像这样：

```
$(curl --user "username:password" "http://jenkins.yourdomain.org/job/JOB-name/buildWithParameters?SOMEPARAMETER=$SOMEPARAMETER&token=TheSecretToken") 
```

**TheSecretToken**是您在从属插件上指定的令牌密码。并且用户名：密码是您詹金斯的有效用户。不要在这里使用您自己的帐户，而是使用仅有权启动特定作业的“构建触发器”帐户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T20:53:19.570

1.  为您提到的每项任务定义一个工作。

2.  在远程机器上有一个奴隶 - 大概是 Mac。

3.  在每个作业中，设置将运行它的相关主机（您有一个参数）。

4.  使用“触发参数化构建”插件以正确的顺序触发作业，并确保在该部分传递“当前构建参数”。

5.  该插件还允许您传递其他值 - 请阅读其帮助以获取更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-23T06:48:18.097

尝试这个

1.  [构建流程插件](https://wiki.jenkins-ci.org/display/JENKINS/Build+Flow+Plugin)
2.  [多任务插件](https://wiki.jenkins-ci.org/display/JENKINS/Multijob+Plugin)

# mysql - 多个mysql join，如何组合这2个select语句

> ID：11543759
> 
> 赞同：0
> 
> 时间：2012-07-18T14:30:45.393
> 
> 标签：mysql, join

我有 2 个选择语句，我想合并为一个，尽管我真的只需要第二个选择语句中一个字段的信息（`data`来自 user_info_data 的字段）。我需要的字段是名字、姓氏、电子邮件、课程全名、角色和`data`fieldid = '15' 的字段。第一个 select 语句将给我除数据字段之外的所有内容。第二个给了我除了课程之外的一切。我尝试执行类似于 Role 字段的第二个 select 语句，但它抱怨它返回不止一行。如果我尝试只使用没有 fieldid='15' 部分的课程名称，它会产生超过 100k 条记录（每个用户显示在每门课程及其所有数据中）。

表格字段：

```
user(id,auth,confirmed,policyagreed,username,password,idnumber,firstname,lastname,email,phone etc..)
user_info_data(id,userid,fieldid,data)
role(id,name,shortname,description,sortorder)
role_assignments(id,roleid,contextid,userid...)
context(id,contextlevel,instanceid,path,depth) 
```

第一个声明：

```
SELECT user.firstname AS Firstname, user.lastname AS Lastname, user.email AS Email, course.fullname AS Course, role.name AS Role
FROM user AS user, course AS course,role,role_assignments AS asg
INNER JOIN context AS context ON asg.contextid=context.id   
WHERE context.contextlevel = 50
AND role.id=asg.roleid
AND user.id=asg.userid
AND context.instanceid=course.id 
```

第一条语句的输出：

**名字姓氏电子邮件课程角色**

John Doe john.doe@email.com 课程名称 学生

第二个声明：

```
SELECT user.firstname AS 'First Name', user.lastname AS 'Last Name', user.email AS 'Email', user_info_data.data AS 'IBCLC Certified'
FROM user, user_info_data
WHERE user.id = user_info_data.userid
AND fieldid = '15' 
```

第二条语句的输出：

**名字 姓氏 电子邮件 IBCLC 认证**

约翰·多伊 john.doe@email.com 是

***期望的输出：***

名字、姓氏、电子邮件、IBCLC 认证、课程、角色

我试过的其他选择语句：带来 9,494 条记录，但是现在 fieldid 为 15 的字段数据是可能选择的列表，这可能是为什么？

```
SELECT user.firstname AS Firstname, user.lastname AS Lastname, user.email AS Email, userdata.data, course.fullname AS Course, role.name AS Role
FROM user AS user, course AS course, user_info_data AS userdata, role,role_assignments AS asg
INNER JOIN context AS context ON asg.contextid=context.id   
WHERE context.contextlevel = 50
AND userdata.fieldid = 15
AND role.id=asg.roleid
AND user.id=asg.userid
AND context.instanceid=course.id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:08:53.147

我`user_info_data`在您的第一个请求中添加了这样的内容：

```
SELECT user.firstname AS Firstname,
       user.lastname AS Lastname,
       user.email AS Email,
       course.fullname AS Course,
       role.name AS Role,
       ibclcCert.data AS 'IBCLC Certified'
FROM user,
     course,
     role,
     role_assignments AS asg,
     context,
     user_info_data AS ibclcCert
WHERE context.contextlevel = 50
  AND role.id=asg.roleid
  AND user.id=asg.userid
  AND context.instanceid=course.id
  AND asg.contextid=context.id
  AND ibclcCert.userid = user.id
  AND ibclcCert.fieldid = '15' 
```

在这种情况下，我将`user_info_data`表引用重命名为表示实际字段的内容。`ibclcCert`如果您有一天想要访问多个数据字段，则此重命名是一项规定。当您这样做时，您将多次包含该表，为您需要的每个字段提供一个。另请参阅有关如何处理此类数据格式的[答案。](https://stackoverflow.com/a/11332913/1468366)

# php - WordPress 侧边栏加载特定帖子

> ID：11543766
> 
> 赞同：1
> 
> 时间：2012-07-18T14:31:01.527
> 
> 标签：php, wordpress

我正在 Wordpress 中构建一个网站，我需要一个侧边栏，当您单击侧边栏上每个帖子的名称时，它会在页面中间加载该特定帖子。

我不确定如何去做。

我是 wordpress 和 php 的新手，感谢您的帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:40:26.417

好吧，基本上据我了解，您想用帖子内容替换当前的中间内容。

为此，您必须使用 AJAX 连接。您需要将帖子 ID 传递给函数，在那里您将检索帖子数据并将其返回到页面，您只需将其插入内容中即可。

我建议你检查这些链接 -

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

[http://codex.wordpress.org/AJAX](http://codex.wordpress.org/AJAX)

例子 -

[http://net.tutsplus.com/tutorials/javascript-ajax/uploading-files-with-ajax/](http://net.tutsplus.com/tutorials/javascript-ajax/uploading-files-with-ajax/)

[http://www.1stwebdesigner.com/css/implement-ajax-wordpress-themes/](http://www.1stwebdesigner.com/css/implement-ajax-wordpress-themes/)

更简单的解决方案是添加`the_permalink();`到页面链接，因此它直接链接到帖子。

# java - Java：如何创建 Java 树，按字符串路径排序

> ID：11543776
> 
> 赞同：7
> 
> 时间：2012-07-18T14:31:41.140
> 
> 标签：java, data-structures, tree

我有一个这样的字符串路径列表：

> {“/foo”、“/bar”、“/foo/admin”、“/foo/cust”、“/bar/erp”、“/bar/erp/call”、“/foo/cust/profile”}

如何创建有序字符串树路径？或者我在哪里可以找到一种可以解决我的问题的库？

另一部分，是我想知道如何循环结构以获取我需要的信息（例如，树节点将包含字符串路径，但也可以包含具有路径属性的对象集合），以便您理解需要复杂的数据结构

树可以这样表示：

```
- /
-- /foo
-- -- /foo/admin
-- -- /foo/cust
-- -- -- /foo/cust/profile
-- /bar
-- -- /bar/erp
-- -- -- /bar/erp/call 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T15:08:34.427

你需要什么：

1.  从头到尾一次遍历字符串数组 1 的主循环。
2.  将 /foo/bar/sid 等路径拆分为字符串数组 {'foo','bar','sid'} 的分词器函数。
3.  树结构（如果您不知道如何在内存中表示树，请查看此 java 操作方法：http: [//vivin.net/2010/01/30/generic-n-ary-tree-in-java /](http://vivin.net/2010/01/30/generic-n-ary-tree-in-java/)但查看独立于语言的指南也会有所帮助，因为它可以让您很好地了解其背后的理论：http: [//people.cis.ksu.edu/~schmidt/300s05/Lectures/Week7b。 html](http://people.cis.ksu.edu/~schmidt/300s05/Lectures/Week7b.html) ). 树的顶部应该是“根”之类的东西，因为 foo 和 bar 应该都在同一棵树下。

如何一起使用它们：遍历 1\. 中的主数组，将每个字符串传递给 2\. 中的标记器，一次一个。使用新的标记化字符串遍历树，使用第一个标记作为树的第一级，第二个作为第二级，等等。当您遇到树中不存在的标记时，添加它们。

构建树后，您只需一次遍历一个分支，以回显其内容。

干杯，快乐的编码！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-18T15:19:58.370

试试这个：

```
import java.util.*;

public class Main {
public static void main(String[] args){
    List<String> data = Arrays.asList("/foo", "/bar", "/foo/admin", "/foo/cust", "/bar/erp", "/bar/erp/call", "/foo/cust/profile");

    // order by path
    Collections.sort(data, new Comparator<String>(){
        @Override public int compare(String o1, String o2) {
            return o1.compareTo(o2);
        }
    });

    for (String s : data){
        int length = s.split("/").length - 1; // -1 means.. without empty string
        for (int i=0; i< length; i++){
            System.out.print("-- ");
        }
        System.out.println(s);
    }
}   
} 
```

// 结果是

```
-- /bar
-- -- /bar/erp
-- -- -- /bar/erp/call
-- /foo
-- -- /foo/admin
-- -- /foo/cust
-- -- -- /foo/cust/profile 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T15:24:23.813

您可以尝试以这种方式将 Comparator 与数组一起使用：

```
String array[]={"/foo", "/bar", "/foo/admin", "/foo/cust", "/bar/erp", "/bar/erp/call", "/foo/cust/profile"};

Arrays.sort(array,new Comparator<String>() {
    @Override
    public int compare(String o1, String o2) {
        return o1.compareTo(o2);
    }
});

for(int i=0;i<array.length;i++){
    if(i>0){
        if(array[i].startsWith(array[i-1])){
            System.out.print("\t");
        }
    }
    System.out.println(array[i]);
} 
```

# actionscript-3 - Flex mobile - 提高列表滚动性能

> ID：11543777
> 
> 赞同：0
> 
> 时间：2012-07-18T14:31:49.127
> 
> 标签：actionscript-3, apache-flex, air, flex4.5, flex4.6

想象一个并排显示两个内容区域的平板电脑应用程序。它们完全填满显示屏，高度为 100%，宽度为 50%。假设我们将一个列表添加到一个容器中。自然这个列表会占用整个显示空间的一半。

现在我的问题是，这种大小的列表是否可能无法实现高帧率滚动？我拥有最基本的 AS3 ItemRenderer，但在滚动期间仍然无法获得高于 30fps 的任何内容。现在奇怪的是，如果我在另一个容器中添加东西，比如说另一个列表或其他组件，列表滚动性能下降到 20 秒。因此，您在 MAX 节目中看到的 Adob​​e 广告远不及 40+ fps。

我正在 iPad2 和 3 上进行测试，即使使用静态值，滚动也不是很好。现在，如果我启用流式传输值以便`set data`调用 ItemRenderer 的方法，则帧速率会再下降 2 到 3 帧。

我的（几乎）完整的渲染器看起来像这样，但即使我将其剥离以仅显示单个文本字段，禁用其中正在进行的内容`set data`并仅设置 中的单个文本字段的大小`layoutContents`，性能如所述，大约 30如果列表单独显示，如果还显示其他内容，则低 20 秒。

```
 //FCStyleableTextField is just a StyleableTextField with an additional ID

    private var _textFields:Vector.<FCStyleableTextField>;
    private var _oldValues:Dictionary;
    private var _sym:Symbol;

    public function GridRenderer() {
        super();
        _textFields = new Vector.<FCStyleableTextField>();
        _oldValues = new Dictionary();
    }

    override protected function createChildren():void {

        var _symLabel:FCStyleableTextField = new FCStyleableTextField();
        _symLabel.editable = false;
        _symLabel.selectable = false;
        _symLabel.multiline = false;
        _symLabel.id="sym";
        _symLabel.setStyle("fontSize", fontSize);
        _symLabel.textColor = 0xc0c0c0;
        _textFields.push(_symLabel);
        addChild(_symLabel);

        var fidLen:int = fids.length;
        for (var i:int = 0; i<fidLen; i++) {
            var _fid_lbl:FCStyleableTextField = new FCStyleableTextField();
            _fid_lbl.selectable = false;
            _fid_lbl.editable = false;
            _fid_lbl.multiline = false;
            _fid_lbl.id = String(fids[i]);
            _fid_lbl.textColor = 0xc0c0c0;
            _fid_lbl.setStyle("textAlign", "right");
            _fid_lbl.setStyle("fontSize", fontSize);
            _fid_lbl.text = " ";
            _textFields.push(_fid_lbl);
            addChild(_fid_lbl);

            if(i>visibleColumns) {
                _fid_lbl.includeInLayout = false;
                _fid_lbl.visible = false;
            }
        }
    }

    override public function set data(value:Object):void {
        if(!value) return;

        if(data) {
            // check if the value's symbolName is different than the current
            // data's symbolName, if so, the itemRenderer has been 
            // recycled, thus we need to reset the old fid values
            if((value as Symbol).symbolName != (data as Symbol).symbolName)
                _oldValues = new Dictionary();
        }

        super.data = value;

        _sym = data as Symbol;

        try {
            var textLen:int = _textFields.length;
            for (var i:int = 0; i<textLen;i++) {
                var lbl:FCStyleableTextField = _textFields[i];
                if(lbl.id == "sym") {
                    lbl.text = _sym.symbolName;
                    lbl.truncateToFit();
                } else {
                    if(lbl.id == _sym.fidList.fidMap[lbl.id].fidId && lbl.text != _sym.fidList.fidMap[lbl.id].fieldValue) {
                        var time:int = new Date().time;
                        var timerName:String = _sym.symbolName+","+lbl.id+","+grid;
                        globalTimer.addTimer(timerName, time, "reset", lbl, null, null);

                        var _oldVal:* = _oldValues[lbl.id];
                        var _newVal:* = _sym.fidList.fidMap[lbl.id].fieldValue;

                        // basic color formatting
                        if(Number(_newVal) > Number(_oldVal))
                            lbl.textColor = 0x40c040;
                        else if(Number(_newVal) < Number(_oldVal))
                            lbl.textColor = 0xf05050;

                        // add + to change and changePercent fids if value is positive
                        if(lbl.id == "56") {
                            if(_newVal >0)
                                lbl.text = "+" + _newVal;
                            else
                                lbl.text = String(_newVal);
                        } else if(lbl.id == "11") {
                            if(_newVal >0)
                                lbl.text = "+" + _newVal;
                            else 
                                lbl.text = String(_newVal);
                        } else 
                            lbl.text = String(_newVal);

                        if(!_sym.fidList.fidMap[lbl.id].fieldValue)
                            lbl.text =" ";

                        _oldValues[lbl.id] = _newVal;
                    } 
                }

                lbl.truncateToFit();
            }       
        } catch (e:Error) { /* nothing to do here -> try/catch required due to async symbolassembly */ }
    } 

    override protected function layoutContents(unscaledWidth:Number, unscaledHeight:Number):void {
        var viewWidth:Number  = unscaledWidth  - paddingLeft - paddingRight;
        var viewHeight:Number = unscaledHeight - paddingTop  - paddingBottom;
        var _previousLabel:FCStyleableTextField;
        var textLen:int = _textFields.length;

        for(var i:int =0; i<textLen;i++) {
            var lbl:FCStyleableTextField = _textFields[i];
            graphics.beginFill(0x808080, .3);
            lbl.height = viewHeight;
            lbl.y = paddingTop;

            if(lbl.id=="sym") {
                lbl.width = 95;
            } else if (lbl.id == "35000") {
                lbl.width = 24;
            } else { 
                lbl.width = optimalColWidth;
            }

            _previousLabel ? lbl.x = (_previousLabel.x + _previousLabel.width): lbl.x = paddingLeft;
            graphics.drawRect(lbl.x+lbl.width, 1, 1, unscaledHeight-1);

            lbl.commitStyles();
            _previousLabel = lbl;
            graphics.endFill();
        }
    } 
```

不过，我很确定不是项目渲染器导致了减速，因为正如我所说，与只显示单个文本字段的渲染器相比，它花费 2 帧，也许 3 帧。我宁愿认为 Flex 无法处理一次显示的矢量数量，这可能吗？有什么方法可以提高性能吗？一旦用户滚动列表，我已经禁用了实时流媒体值，因此 flex 基本上只需要滚动位图（因为 LabelItemRenderer 自动启用`cacheasbitmap`），但这可能会获得 4 帧。你们有什么技巧可以使滚动更顺畅？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T13:00:08.960

发现使用`setElementSize()`和`setElementPosition()`而不是使用宽度/高度和 x/y 会产生很大的不同。初始滚动性能提高 3fps，渲染每个项目后提高 8fps。所以我现在非常接近 30fps，仍然不能接近原生应用程序所能做到的，但我认为这与使用 Flex 和如此庞大的渲染器一样好。

还禁用了实时更新，以便渲染器在更新时不需要再次缓存为位图。

# ruby-on-rails - 方法未找到回形针

> ID：11543779
> 
> 赞同：0
> 
> 时间：2012-07-18T14:31:52.730
> 
> 标签：ruby-on-rails, ruby, paperclip, will-paginate

我明白了

```
undefined method `photo' for #<ActiveRecord::Relation:0x00000102a8a7c0> 
```

我试图在我的页面上显示图像时出错。我正在使用回形针上传文件和 will_paginate。

这是 Admin::Image 模型的内容

```
class Admin::Image < ActiveRecord::Base
  attr_accessible :added_on, :title, :photo

  validates_presence_of :title
  validates_presence_of :photo

  self.per_page = 15

  has_attached_file :photo
end 
```

这是图像控制器的内容

```
class ImagesController < ApplicationController
  def index
    @data = Admin::Image.paginate(:page => params[:page])
  end
end 
```

和视图

```
<%= image_tag @data.photo.url %> 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:10:50.660

在控制器中，您将 Admin::Image 对象的集合分配给 @data 实例变量（顺便说一句，为什么不将其称为 @images），并且在视图中您试图在整个集合上调用“照片”方法，而“照片” ' 方法在 Admin::Image 对象中可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T15:13:08.733

Cthulhu 是对的，您缺少的是迭代集合：

```
<% @data.each do |datum| %>
  <%= image_tag datum.photo.url %>
<% end %> 
```

# sql - sql更新codeigniter

> ID：11543780
> 
> 赞同：1
> 
> 时间：2012-07-18T14:31:54.043
> 
> 标签：sql, codeigniter, activerecord, sql-update

我正在使用codeIgniter ..我想在我这样做时更新表格列 ：`is_close`-`id=$ticket_id``table= tbl_tickets.`

```
$data=array(
            'is_close'=>1
            );
        $this->db->where('id',$title_id);
        $this->db->update('tbl_tickets',$data); 
```

我也这样做了：-

```
$sql = "UPDATE tbl_tickets SET is_close={1} WHERE id='$title_id'";
$this->db->query($sql); 
```

两者都不起作用，即我的表没有将值更新为 1，并且浏览器中也没有显示错误。:(

**编辑：包括我的模型部分：**

```
function setClosePost($title_id){
        $sql = "UPDATE tbl_tickets SET is_close=0 WHERE id='$title_id'";
        $this->db->query($sql);
        // $data=array(
        //     'is_close'=>1
        //     );
        // $this->db->where('id',$title_id);
        // $this->db->update('tbl_tickets',$data);
     } 
```

我的控制器：-

```
function closePost(){
        $this->load->model('helpdesk_model');
        $this->helpdesk_model->setClosePost($this->input->post('title_id'));
      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T12:18:50.737

试试这样

```
$sql = "UPDATE tbl_tickets SET is_close='1' WHERE id=".$title_id;
$this->db->query($sql); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T16:30:51.927

试试这样

```
**function edit($close,$id) {
$sql = "UPDATE tbl_tickets SET is_close= ?  WHERE id = ? ";
 $this->db->query($sql, array($close,$id));
}** 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:39:26.330

首先，`$title_id`通过前检查：

```
var_dump($title_id); 
```

然后，在更新之前和之后尝试“选择具有此 ID 的行”。

```
$query = $this->db->get_where('tbl_tickets', array('id' => $id));  

foreach ($query->result() as $row)
{
    var_dump($row->is_close);
}

$data=array(
            'is_close'=>1
            );
        $this->db->where('id',$title_id);
        $this->db->update('tbl_tickets',$data);

$query = $this->db->get_where('tbl_tickets', array('id' => $id));

foreach ($query->result() as $row)
{
    var_dump($row->is_close);
} 
```

然后，给出你的表结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-25T14:26:12.603

首先使用 get 方法检查是否`ticket_id`存在。

另一件事是始终在模型中的函数中使用 return 以便您可以通过`if(function_name){...}else{...}`

那么如果您的 get 方法正确返回数据，请尝试

**模型方法**

```
public function set_closed($ticket_id){
    $this-db->set(array(
            'is_close'=>1
            ));
    $this->db->where('id',$ticket_id);
    $this->db->update('tbl_tickets');
    return true;
} 
```

然后在你的**控制器中检查**

```
if($this->Ticket_model->set_closed($ticket_id) == true){
    echo 'ticket set to closed correctly';
}else{
    echo 'there is some error on updating database'.$this->db->error(); // to checkout db error .
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-25T10:57:03.890

***要处理此类错误，我的意思是如果数据库中没有发生反射，则使用以下步骤来解决此类错误。***

1) 使用**$this->db->last_query()**函数打印查询，使用它我们可以确保我们的变量具有正确的值（不应该为空或未定义），使用它我们可以确保 SQL 查询也有效或无效.

2) 如果 SQL 查询有效，则打开 phpmyadmin 并在 phpmyadmin 中触发相同的查询，如果查询列或表名无效，它将返回错误。

***使用这种方式，它是交叉检查我们的 SQL 查询问题的最佳方式。***

我希望它会奏效。

谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-27T06:27:22.297

您正在尝试更新整数（INT）类型值，只需与您的列数据类型进行交叉检查，如果那是 varchar，那么您必须将值放在单引号或双引号中。

像这样 $data=array('is_close'=> '1');

# sql - SQL 返回重复行的特定值

> ID：11543783
> 
> 赞同：0
> 
> 时间：2012-07-18T14:32:05.260
> 
> 标签：sql, distinct

这是我的问题

我正在使用批量导入将 CSV 文件导入表 (InputTable)。该表需要分成 3 个具有不同值的不同表。

表格是客户、子公司、联系人

客户与子公司以及联系人之间存在一对多关系。

客户表有两个字段（名称，状态）

使用此查询从 dbo.InputTable 中提取一个不同的名称很容易......

```
 insert into Client
    (
Name
    )
    select distinct Name
    from InputTable 
```

此查询将插入这样的数据

```
姓名

一家公司

两家公司

三连

```

但是，当我尝试此代码时

```
 insert into Client
    (
 Name
     ,Status

    )
    select distinct Name
    from InputTable
    group by Name
    ,Status 
```

我得到这个结果

```
姓名 | 地位

一家公司 | 积极的

二公司| 积极的

二公司| 终止

三公司| 积极的

```

这是踢球者，如果客户端在一行中显示为活动，无论有多少行，那么我需要在客户端表上显示该名称记录的活动

如果它们全部显示已终止，那么我需要将终止状态复制到该行的客户端表中。

关于如何做到这一点的任何想法？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:33:45.133

```
insert into Client (Name, status)
select name,
    min(status) as status
from InputTable 
group by name 
```

# git - Git：如何通过.gitignore忽略隐藏文件/点文件/具有空文件名的文件？

> ID：11543789
> 
> 赞同：20
> 
> 时间：2012-07-18T14:32:14.760
> 
> 标签：git, gitignore

这些文件都应该被忽略：

```
.weirdBackupFileType
.travis.yml 
```

不应忽略以下文件：

```
_.weirdBackupFileType
Z.travis.yml 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-06-07T10:10:21.200

如果要忽略所有点文件，请将其添加到 .gitignore 文件中（如果不存在，请添加）

```
.*
!.gitignore 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-10T13:28:15.607

你的答案很简单：

这是您`.gitignore`文件的内容：

```
# ignore those files 
.weirdBackupFileType
.travis.yml

#DONOT ignore those files (this is what the ! is for - un ignore files)
!_.weirdBackupFileType
!Z.travis.yml 
```

就是这样。

在图像中，您可以看到我已经创建了文件，并且在将其添加到`.gitignore`它们之后它们不再处于状态。

[![在此处输入图像描述](../Images/dd096a192b02232d19ae24ae2fd39934.png)](https://i.stack.imgur.com/sAowo.png)

# javascript - 在选择框的 onchange 期间调用 JavaScript 函数

> ID：11543796
> 
> 赞同：2
> 
> 时间：2012-07-18T14:32:27.670
> 
> 标签：javascript, ruby-on-rails

在我看来，我有以下几点：

```
<%= select("event", :event_id, events_ids_titles_hash, { :include_blank => true, :onchange => "alert_me_test()" }) %> 
```

alert_me_test() 是：

```
<script type="text/javascript">
  function alert_me_test()
  {
      alert ("this is a test")
  }
</script> 
```

下拉列表看起来不错，但是当我从中选择时，什么也没有发生。我期待一个带有“这是一个测试”的警报框。

# 编辑案例：

当我进行编辑时，我有以下代码：

```
<% if @panel.event_id %>
  <%= select("panel", :event_id, events_ids_titles_hash, {:selected => @panel.event_id}, { :include_blank => true}) %> 
```

我的 IDE（RubyMine）不想接受“onchange”作为附加参数，并将其放在 :selected 或 :include_blank 参数哈希之一中不会产生错误，但它也不起作用

# 最终适用于 new 和 edit 的内容：

```
<% if @panel.event_id %>
    <%= 'Event is ' + events_ids_titles_hash.key(@panel.event_id) %>
    <%= select("panel", :event_id, events_ids_titles_hash, {:selected => @panel.event_id}, { :include_blank => true, :onchange => "alert_me_test()"}) %>
<% else %>
    <%= 'Select Event from list' %>
    <%= select("event", :event_id, events_ids_titles_hash, { :include_blank => true }, { :onchange => "alert_me_test()" }) %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T15:02:03.073

```
<%= select("event", :event_id, events_ids_titles_hash, { :include_blank => true, :onchange => "alert_me_test()" }) %> 
```

为我工作，但我必须说你正在用这个来对抗当前。Rails 遵循 UJS，这意味着您的偶数处理程序应该与您的 HTML 分开。在这种情况下，选择将是相同的减去 onclick，然后脚本将是

```
<script type="text/javascript">
  $('select').change(alert_me_test);

  function alert_me_test(){
  ...
  }
</script> 
```

您不必以这种方式做事，但在查看事件调用来自的脚本时会更清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:47:50.203

我相信您需要将其设置`:onchange`为 HtmlOption，这是第 4 个参数：

```
<%= select("event", :event_id, events_ids_titles_hash, { :include_blank => true}, {:onchange => "alert_me_test()" }) %> 
```

# iphone - 谁将在目标 c 中调用 Main 方法

> ID：11543799
> 
> 赞同：5
> 
> 时间：2012-07-18T14:32:39.510
> 
> 标签：iphone

我想知道谁会在objective-c中调用main方法？

我知道 UIApplicationMain(nil,nil,nil,NSStringFromClass[Appdelgate class]) 方法是从 main() 方法调用，然后从 appdelegate didFinishLaunchingWithOptions() 方法继续处理.....

而且我也知道 java 中的 main() 方法由 JVM 调用，并且进程正在从 main() 方法进行。

像那样，我想知道谁会在 Objective-c 中调用 main()。

感谢帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T15:10:07.013

找出答案的简单方法是插入断点`main()`并查看：

![调用栈](../Images/b2d3d8b2e6f2948ab31cdef9fc269816.png)

所以从技术上讲，这个问题的答案`main()`是从一个叫做`start`. 您没有获得 的源代码`start`，但如果您愿意，可以在调试器中查看汇编代码。此版本来自为模拟器构建的代码：

```
0x1c30:  pushl  $0
0x1c32:  movl   %esp, %ebp
0x1c34:  andl   $-16, %esp
0x1c37:  subl   $16, %esp
0x1c3a:  movl   4(%ebp), %ebx
0x1c3d:  movl   %ebx, (%esp)
0x1c40:  leal   8(%ebp), %ecx
0x1c43:  movl   %ecx, 4(%esp)
0x1c47:  addl   $1, %ebx
0x1c4a:  shll   $2, %ebx
0x1c4d:  addl   %ecx, %ebx
0x1c4f:  movl   %ebx, 8(%esp)
0x1c53:  movl   (%ebx), %eax
0x1c55:  addl   $4, %ebx
0x1c58:  testl  %eax, %eax
0x1c5a:  jne    0x00001c53               ; start + 35
0x1c5c:  movl   %ebx, 12(%esp)
0x1c60:  calll  0x00001c70               ; main at main.m:9
0x1c65:  movl   %eax, (%esp)
0x1c68:  calll  0x00002376               ; exit
0x1c6d:  hlt    
0x1c6e:  nop    
0x1c6f:  nop 
```

如果您创建一个 MacOS X 命令行程序并在 中放置一个断点`main()`，您会发现它也在桌面上`main()`被调用。`start`Mac 版本的程序集`start`并不完全相同，但非常接近。所以这是一个很好的猜测，它`start`是编译器根据目标平台为你生成的，`start`也是操作系统在启动程序时寻找的入口点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:38:37.250

我相信它是由 Obj-C 运行时库中的汇编例程调用的，与 C 中相同，但使用 C 运行时库

检查这个：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-18T14:45:25.537

在大多数系统中，操作系统具有负责将可执行程序加载到内存中的特殊功能。它们分配所需的内存并将文件中的信息加载到该空间中。在某些情况下，他们甚至可能对代码进行特殊修改，以便它在加载它的特定内存空间中工作。

将程序加载到内存后，操作系统将控制权传递给程序文件代码段的开头。代码段的开头通常有一个小例程，它执行一些必要的操作，如初始化堆栈和内存堆。当这些事情完成后，它会将控制权交给 main() 函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T14:42:19.013

由于 Objective-C 是 C 的派生词，因此许多内部结构是相似的（这就是为什么您可以将 C\C++ 代码与 Objective-C 混合使用）。因此，当两者都编译成可执行文件时，它们在相似的系统上工作。这也是为什么 Objective-C 由 gcc 或 Clang 编译的原因。

考虑到这一点，编译时会发生什么？您的所有 C 代码都被转换为汇编\机器代码（因为汇编只是机器代码的助记符版本）。汇编比Java低；CPU 只是运行它并按顺序执行每个单独的指令。C 语言中的`main()`函数是编译器“知道”指令从哪里开始的地方。完成所有声明后，该`main()`函数将跳转到一条名为“ `jmp`”的指令。

那么当你在 Xcode 中编译并启动时会发生什么？首先，gcc/Clang 将代码转换成汇编\机器码。其次，Xcode 将二进制文件加载到内存中。第三，Darwin（OS X 或 iOS，或与此相关的任何操作系统）认识到这是一个可执行的内存区域，并从指令集的顶部开始并贯穿每条指令。

为了回答您的问题，该`main()`功能由 CPU 启动。这与 Java 不同，后者具有在 JVM 中“模拟”的独立于平台的指令集。

[这个](https://stackoverflow.com/questions/823138)问题有一个很好的答案，它解释了`main()`函数如何被翻译成汇编代码。

# python - Python wsgi 网站扫描仪

> ID：11543800
> 
> 赞同：1
> 
> 时间：2012-07-18T14:32:40.213
> 
> 标签：python, cgi, wsgi, openshift

我需要构建一个扫描器来扫描给定的 url 数组，并将它们显示在网页、url 和状态码上。我设法用不到 50 个 url 做到了这一点。问题是当扫描更多时，脚本需要更多时间来运行并且服务器返回 504 Gateway Timeout 错误。

有没有办法在扫描时打印 url？，不是在扫描完所有 url 之后。我正在使用 python wsgi。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-22T17:15:49.393

我发现我可以使用 Python 的 yield 关键字分别返回字符串。就像这样。无需等待整个过程完成。

```
def htmlOut():
    yield '<html>'
    yield '<body><h1>'
    yield 'Hello world'
    yield '</h1></body></html> 
```

# python - 使用ini文件运行python脚本

> ID：11543803
> 
> 赞同：0
> 
> 时间：2012-07-18T14:32:45.067
> 
> 标签：python, ini

我想用不同的ini文件运行一个python脚本

我将一些变量放在 ini.py 中，然后我想用这个 inifile 运行我的 program.py。

我试过类似的东西：

在批处理-> program.py ini

```
sys.argv[1]
from sys.argv[1] import * 
```

和

```
eval('from '+sys.argv[1]+' import *') 
```

但这不起作用。

现在我写道：

```
import sys
f = open('outp.py','w')
f.write("from "+sys.argv[1]+" import *\n")
f.write("print x\n")
with open('program.py', 'r') as content_file:
    content = content_file.read()
f.write(content)
f.close()

execfile( "outp.py") 
```

基本上用额外的导入语句重写我的程序文件......我希望有一种更简单的方法？！（不一定是批量）thx

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:40:22.227

对于解析 INI 文件，您可以使用 Python 中的[configparser](https://docs.python.org/library/configparser.html)标准库模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:36:35.527

您可以使用该`__import__`功能。

```
my_module=__import__('os')  #basically the same as `import os as my_module` 
```

当然，你不能这样做`from blah import *`，但是很多人会争辩说，无论如何你都不应该在生产代码中使用那个习惯用法。

但是，如果您只想设置一些变量，则应该考虑使用命令行解析实用程序或配置文件解析器（`configparser`所有这些都在标准库中），因为这将防止用户运行不受信任的`argparse`代码`optparse`.

# objective-c - 反对依赖注入框架 - 将类绑定到协议

> ID：11543806
> 
> 赞同：0
> 
> 时间：2012-07-18T14:32:48.800
> 
> 标签：objective-c, dependencies, protocols, code-injection

尝试使用 Objection 进行依赖注入，为协议属性实例注入具体类时，我有点困惑。出于学习目的，我制作了一个简单的记录器注入示例，如下所示：

```
// Protocol definition
@protocol TestLogger<NSObject>
-(void)trace: (NSString*) message, ...;
-(void)info: (NSString*) message,...;
-(void)warn: (NSString*) message,...;
-(void)error: (NSString*) message, ...;
@end

// Concrete class definition following my protocol - note it doesn't actually use
// CocoaLumberjack yet, I just had an NSLog statement for testing purposes
@interface CocoaLumberjackLogger : NSObject<TestLogger> 
@end

// Implementation section for lumberjack logger
@implementation CocoaLumberjackLogger

-(void)trace: (NSString*) message, ...
{
    va_list args;
    va_start(args, message);
    [self writeMessage:@"Trace" message:message];
    va_end(args); 
}

//(note: other implementations omitted here, but are in my code)
.
.
.
@end 
```

**现在我想将我的记录器作为属性注入到视图中，所以我执行以下操作：**

```
// My test view controller interface section
@interface TestViewController : UIViewController
- (IBAction)testIt:(id)sender;

@property id<TestLogger> logger;

@end

// Implementation section
@implementation TestViewController

objection_register(TestViewController)
objection_requires(@"logger")

@synthesize logger;
. 
. 
. 
```

**最后我有应用程序模块设置：**

```
@interface ApplicationModule : JSObjectionModule {

}
@end

@implementation ApplicationModule
- (void)configure {
[self bindClass:[CocoaLumberjackLogger class] toProtocol:@protocol(TestLogger)];
}
@end

@implementation TestAppDelegate

@synthesize window = _window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:     (NSDictionary *)launchOptions
{
    JSObjectionModule *module = [[ApplicationModule alloc] init];
    JSObjectionInjector *injector = [JSObjection createInjector:module];   
    [JSObjection setDefaultInjector:injector];
    return YES;
} 
```

**结果**

一切似乎都运行得很好，当我单击测试按钮调用记录器语句时，只有我的记录器属性在我的测试视图中为零。我希望它会被一个具体类类型 CococoaLumberJackLogger 的对象填充。

关于我哪里出错的任何想法？任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T01:35:19.197

肖恩，

什么负责初始化 TestViewController？TestViewController 的初始化必须委托给注入器。

例如，如果一个 NIB 负责实例化它，那么记录器将为 nil，因为 NIB 不了解 TestViewController 的依赖关系。

# java - 实体：条件 + 组件成员 vs. O(1) 哈希查找策略

> ID：11543808
> 
> 赞同：1
> 
> 时间：2012-07-18T14:32:50.603
> 
> 标签：java, performance, architecture

我正在用 Java 构建一个新的实体系统。我想知道我提出的方法是否会导致任何问题，无论是架构方面还是性能方面。

我想：

```
...

for (Entity entity : entities)
{
    for (Entry<String, Component> entry : entity.components.entrySet()) //collection is a Map
    {
        Component component = entry.getValue();
        component.update(deltaTime);
    }
}

... 
```

与不受欢迎的替代方案相比：

```
...

for (Entity entity : entities)
{
    if (entity.componentA != null)
        entity.componentA.update(deltaTime);

    if (entity.componentB != null)
        entity.componentB.update(deltaTime);

    //etc. for as many components as the entity has. Finite, but possibly many.
}

... 
```

对于第一种方法，我想到了一些关于 HashMap 方法的事情：

*   我会避免不必要的条件（当成千上万的实体被`update()`调用时，这很重要）；
*   读取访问时间平均为 O(1)（您唯一可能无法获得的时间是在哈希冲突中）；
*   `HashMap.entrySet()`必须调用以使用 for-each 语法遍历集合。正如我从文档中了解到的那样，“集合 [set] 由地图支持”。但是，这并不能告诉我 HashMap 是否在内部创建集合，每次都`entrySet()`被调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:39:58.193

> 读取访问时间平均为 O(1)（您唯一可能无法获得的时间是在哈希冲突中）；

在入口集上的 for each 循环中，您不需要调用`map.get()`.

> 但是，这并不能告诉我 HashMap 是否在内部创建集合，每次调用 entrySet()。

不，它不会每次都创建一个新集。

* * *

您应该编写最干净、最容易阅读和维护的代码。如果性能不够好（即您已经分析了您的应用程序并确定性能问题是由于该部分代码引起的），请开始优化。

==> 为每个循环使用一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:47:59.903

第一个版本几乎肯定会是最好的设计：

*   更通用的代码 - 涵盖所有可能的组件配置
*   更简洁的代码和可维护性 - 避免所有条件
*   运行时更灵活——您可以动态更改组件列表
*   快速 - 假设 entity.components 是一个具有良好迭代器的合理数据结构，每个组件应该是 O(1)

如果您真的关心性能并且**已经分析**出这是一个重要的特殊情况，您可能需要考虑`ComponentList`为 entity.components 编写一个自定义数据结构（例如），这将有一个额外的方法`updateAll(deltaTime)`来有效地为所有包含的组件。这有几个优点：

*   您可以避免分配 Iterator 对象（如果您使用 HashMap 或 ArrayList 会发生这种情况）
*   您可以通过专注于 Component 类型来避免一些不必要的强制转换

# amazon-web-services - reddit 是否使用亚马逊云搜索？

> ID：11543809
> 
> 赞同：0
> 
> 时间：2012-07-18T14:32:50.260
> 
> 标签：amazon-web-services, reddit, amazon-cloudsearch

我在 reddit wiki 中读到 reddit 移至 indextrunk 但是当我查看 run.py 文件时，我发现有 Cloud_Search_Api_key 之类的键......所以我猜它正在使用 Amazon 云搜索。如果这是真的，应该在 run.py 中更改哪些值才能使 cloudsearch 正常工作？subreddit_cloud_api_key 是什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T03:46:34.387

我很确定 Reddit 使用 Cloudsearch。~~他们的[Github FAQ](https://github.com/reddit/reddit/wiki/FAQ)声称他们使用 Indextank，但~~IndexTank[自 2012 年 4 月以来已被关闭](https://twitter.com/indextank/status/188396462529454081)。如果您在 Reddit 上搜索并突出显示“δ”符号，它将显示类似“δ 将查询转换为 cloudsearch 语法：(and (field text 'search') (field text 'terms'))”的文本。

我对 Python 或 AWS 不太熟悉，但它看起来像 CLOUDSEARCH_SEARCH_API 和其他类似的变量是 Amazon 调用[Endpoints](http://docs.amazonwebservices.com/cloudsearch/latest/developerguide/endpoints.html)的 URL 。

reddit/r2/run.ini 中的变量名称包含 SEARCH 和 DOC，反映了 Amazon 的文档。此外，[cloudsearch.py](https://github.com/reddit/reddit/blob/master/r2/r2/lib/cloudsearch.py#L519)​​ 与该变量建立 HTTP 连接：

```
search_api = g.CLOUDSEARCH_SEARCH_API
//...
connection = httplib.HTTPConnection(search_api, 80) 
```

因此，您可能会使用指向您的 Cloudsearch 端点的 URL 设置 CLOUDSEARCH_SEARCH_API。

**编辑**：[Kemitche 在 Reddit 上回答了这个问题](http://www.reddit.com/r/redditdev/comments/wqx7o/does_reddit_using_amazon_cloud_search/c5fut4i)。不像我，他知道他在说什么，所以看看。

# sql - 是否有更有效的方法来更新/插入表中的行

> ID：11543820
> 
> 赞同：1
> 
> 时间：2012-07-18T14:33:17.930
> 
> 标签：sql

我想在表中更新或插入一行。我还在 WHERE 子句中搜索的列上创建了一个索引。

我想插入表中的东西可能已经存在也可能不存在于表中，因此它可能是更新或插入。所以首先我定义了一个像“already_exists”这样的布尔变量和一个在表中搜索值的选择语句，如果找到它，它将把布尔变量设置为真，否则它将保持为假。然后我说哦，如果该变量为真，则在表上运行此更新命令，如果为假，则运行此插入命令。

那么这是正确的方法还是有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:35:58.533

是的。

取决于您的 SQL 平台，`MERGE`或者`UPSERT`...

[维基百科合并 (SQL)](http://en.wikipedia.org/wiki/Merge_%28SQL%29)

# push-notification - 订阅推送通知所需的 Exchange 邮箱/启用邮件的文件夹权限

> ID：11543821
> 
> 赞同：1
> 
> 时间：2012-07-18T14:33:27.957
> 
> 标签：push-notification, exchange-server, exchangewebservices, user-permissions

我需要使用单个 Exchange 帐户订阅多个 Exchange 邮箱和启用邮件的文件夹的[推送通知。](http://msdn.microsoft.com/en-us/library/bb204063%28v=exchg.80%29)

为此需要哪些[Exchange 文件夹访问帐户权限？](http://technet.microsoft.com/en-us/library/aa998834%28v=exchg.80%29)

该邮箱和文件夹的读者权限就足够了吗？

# c# - GetValue(...) - 错误在运行时被忽略

> ID：11543823
> 
> 赞同：2
> 
> 时间：2012-07-18T14:33:33.720
> 
> 标签：c#, reflection

尝试创建获取任何枚举属性值的枚举扩展方法时，我遇到了以下情况：

编译 VS 2010 下面的代码时显示错误：方法 'GetValue' 没有重载需要 1 个参数。注释代码并使用监视工具时 - 该行返回值（见附图）。

知道为什么吗？

```
 public static class EnumExtensions
{
    public static IEnumerable<object> GetAttributeValue(this Enum enm, Type attribute, string attributeName)
    {

        FieldInfo fi = enm.GetType().GetField(enm.ToString());

        var fiAtts = fi.GetCustomAttributes(attribute, false);

        if (fiAtts.Length == 0)
            return null;

        foreach (var att in fiAtts)
        {
            //VS2010 throws an error: No overload for method 'GetValue' takes 1 argument
            //yield ==> Ignore
            return att.GetType().GetProperty(attributeName).GetValue(att);
        }
    }
} 
```

![在此处输入图像描述](../Images/8e728b1b3206145adc4d3ddcac169afc.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:50:21.947

显然，在.Net 4 中，没有`GetValue`一种方法只将一个参数作为[PropertyInfo](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.aspx)类的参数

我现在可以看到监视窗口返回某些内容的唯一可能性是，在您的代码中的某处，您有一个只需要一个参数作为输入`GetValue`的类型的扩展方法。`PropertyInfo`它在您的代码中可能是未知的，因为没有`using [PropertyInfoExtensionNamespace]`指定。也许出于未知（或错误）的原因，它以调试器而闻名。

有关扩展方法 + 调试器错误行为的讨论，请参阅[此博客文章](http://blogs.msdn.com/b/jaredpar/archive/2010/07/22/extension-methods-and-the-debugger.aspx)。

# codeigniter - Internet Explorer 的 codeigniter 中的阿拉伯语 url

> ID：11543829
> 
> 赞同：0
> 
> 时间：2012-07-18T14:33:53.353
> 
> 标签：codeigniter, url

当我运行任何 url 时，我正在使用 codeigniter 2.1.1：

```
www.mysite.com/search/عربي 
```

$key = "عربي"; 它适用于除 Internet Explorer 和 IE 之外的所有浏览器说：未定义的变量键

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:35:24.133

根据标准 ( [RFC1738](http://www.faqs.org/rfcs/rfc1738.html) )，URL 只能包含 ASCII 字符。必须对非 ASCII 字符进行编码。这是 IE 比其他浏览器更符合标准的罕见情况。

我相信您会发现，如果您使用诸如 HTTP Watch 之类的东西，其他浏览器正在对它们进行编码以发送到服务器，只是在地址栏中显示 Unicode 字符...

# php - 包含中的 PHP 重定向失败

> ID：11543833
> 
> 赞同：0
> 
> 时间：2012-07-18T14:34:10.753
> 
> 标签：php, redirect, include

我正在尝试实现一个相当复杂的 3rd 方脚本，该脚本由几个相互连接的脚本组成。我已经在我的一个简单页面中包含了脚本的介绍。该脚本基本上根据逻辑将不同的内容写入字符串并在末尾回显字符串。有时它会回显一个表单，当您单击提交时，脚本会再次运行并基于新逻辑回显不同的文本，这些文本在我的页面内显示良好，它被包含在早期表单的位置。（我的页面中包含的第 3 方脚本也有自己的一些内容。）

我的问题是，有时我想让它重定向到我网站上的另一个页面，而不是让它回显它回显的一些东西，尤其是错误操作系统成功消息。

我已经用我的其他页面成功地做到了这一点。我在页面中包含一个脚本，该脚本编写了一些标题类型代码。基于调用脚本的用户的某些参数或操作，包含可能重定向到它自己或另一个页面。我唯一需要确保的是在重定向之前的包含过程中没有空格或文本。

然而，使用这个第三方脚本，虽然我认为我已经删除了所有的空白，但它并没有让我重定向。错误消息将我的页面中编写的代码包含在第 3 方脚本中。这是味精：

```
Warning: Cannot modify header information - headers already sent by (output started at /blah blah/stepone.php:5). 
```

第一步是我调用第 3 方脚本的简单页面。

即使当前显示了一些文本，包含可以重定向以响应用户操作，我是对的吗？我应该只是检查第三方脚本的空白还是有一些我可能做错的结构性事情。

第 3 方脚本太大，无法放在这里，否则我会把它们放在这里。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:36:44.567

您需要的，可能是`ob_start()`. 这会缓冲输出并使您能够重定向，即使已经生成了输出。

另请查看手册： http: [//php.net/manual/en/function.ob-start.php](http://php.net/manual/en/function.ob-start.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:42:25.487

您提到的错误是由于标头已经发送到浏览器而发生的。当它尝试再次发送标头时会引发错误。例如。

当你尝试做这样的事情时。

```
echo 'Hello World';
header('Location:some/location.php'); 
```

它可能会给你一个错误。因此，将重定向标头放在顶部总是好的。但有时我们可能不希望这样。在这种情况下，您可以根据 PHP 的定义使用 php 的[ob_start()](http://php.net/ob_start)打开输出缓冲

> 此功能将打开输出缓冲。当输出缓冲处于活动状态时，不会从脚本发送输出（除了标题），而是将输出存储在内部缓冲区中

因此，您可以使用类似的东西来代替上面的示例代码。

```
ob_start();
echo 'Hello World';
header('Location:some/location.php');
ob_end_flush(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:42:21.330

你必须：

1.  `ob_start()`在文件的开头使用。
2.  `ob_end_flush()`在文件末尾使用。

# video - 使用 FFmpeg 进行 H.264 转换（来自 RTP 流）

> ID：11543839
> 
> 赞同：19
> 
> 时间：2012-07-18T14:34:27.250
> 
> 标签：video, stream, ffmpeg, h.264, rtp

**环境：**

我有一个 IP 摄像机，它能够通过 RTP 以 H.264 编码格式传输数据。此原始流是从以太网记录的。有了这些数据，我必须工作。

**目标：**

最后，我想要一个 *.mp4 文件，我可以使用常见的媒体播放器（如 VLC 或 Windows MP）播放它。

**到目前为止我做了什么：**

我获取我拥有的原始流数据并对其进行解析。由于数据是通过 RTP 传输的，我需要处理 NAL 字节、SPS 和 PPS。

***1.写一个原始文件***

首先，我确定通过以太网接收的每个帧的类型。为此，我解析每个 RTP Payload 的前两个字节，因此我可以获得 8 个 NAL 单元位、片段类型位以及开始、保留和结束位。在有效载荷中，它们的排列方式如下：

```
Byte 1: [          3 NAL Unit Bits          | 5 Fragment Type Bits]
Byte 2: [Start Bit | Reserved Bit | End Bit | 5 NAL Unit Bits] 
```

由此我可以确定：

*   视频帧的开始和结束 -> 开始位和结束位
*   有效负载的类型 -> 5 个片段类型位
*   NAL 单位字节

在我的情况下需要的片段类型是：

```
Fragment Type  7 = SPS
Fragment Type  8 = PPS
Fragment Type 28 = Video Fragment 
```

NAL 字节是通过将字节 1 和 2 中的 NAL 单元位放在一起创建的。

现在根据碎片类型，我执行以下操作：

*SPS/PPS：*

1.  写入 NAL 前缀 ( `0x00 0x00 0x01`)，然后写入 SPS 或 PPS 数据

*带起始位的分片*

1.  写 NAL 前缀
2.  写入 NAL 单元字节
3.  写入剩余的原始数据

*没有起始位的分片*

1.  写入原始数据

这意味着我的原始文件看起来像这样：

```
[NAL Prefix][SPS][NAL Prefix][PPS][NAL Prefix][NAL Unit Byte][Raw Video Data][Raw Video Data]....[NAL Prefix][NAL Unit Byte][Raw Video Data]... 
```

对于我在流数据中找到的每个 PPS 和 SPS，我只需编写一个 NAL 前缀 ( 0x00 0x00 0x01 )，然后是 SPS/PPS 本身。

现在我无法使用某些媒体播放器播放这些数据，这导致我：

***2.转换文件***

因为我想避免大量使用编解码器，所以我只使用了现有的应用程序 -> FFmpeg。我用这些参数调用：

`ffmpeg.exe -f h264 -i <RawInputFile> -vcodec copy -r 25 <OutPutFilename>.mp4`

`-f h264`：这应该告诉 ffmpeg 我有一个 h264 编码流

`-vcodec copy`：从手册页引用：

`Force video codec to codec. Use the "copy" special value to tell that the raw codec data must be copied as is.`

`-r 25`：将帧速率设置为 25 FPS。

当我使用这些参数调用 ffmpeg 时，我得到一个 .mp4 文件，我可以使用 VLC 和 Windows MP 播放该文件，因此它确实有效。但是该文件现在看起来与我的原始文件有点不同。

这引出了我的问题：

**我实际上做了什么？**

我的问题不在于它不起作用。我只是想/需要知道我在调用 ffmpeg 时实际上做了什么。我有一个**无法**播放的原始 H264 文件。使用 FFmpeg 后，我**可以**播放它。

原始原始文件（我已经编写）和 FFmpeg 编写的原始文件之间存在以下差异：

1.  标头：FFmpeg 文件具有大约 0x30 字节的标头
2.  页脚：FFmpeg 文件也有页脚
3.  更改了前缀和 2 个新字节：

虽然原始文件中的新视频帧像 `[NAL Prefix][NAL Unit Byte][Raw Video Data]`在新文件中一样开始，但它看起来像这样：

```
[0x00 0x00][2 "Random" Bytes][NAL Unit Byte][Raw Video Data].....[0x00 0x00[2 other "Random" Bytes][NAL Unit Byte][Raw Video Data]... 
```

我知道视频流需要一个容器格式（如果我错了，请纠正我，但我认为新的页眉和页脚对此负责）。但为什么它实际上改变了原始数据中的一些字节？它不能是一些解码，因为流本身应该由播放器而不是 ffmpeg 解码。

正如你所看到的，我不需要一个新的解决方案来解决我的问题，而不仅仅是解释（所以我可以自己解释）。ffmpeg 实际上做了什么？为什么它会改变视频数据中的一些字节？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-28T11:55:46.237

除了添加 MP4 容器外，ffmpeg 还将您的 H.264 Annex B 字节流（带有 NAL 前缀）转换为长度前缀格式。

您的 [0x00 0x00][2 "Random" Bytes] 是一个 32 位整数，以字节为单位给出以下 NAL 单元的长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:09:07.827

看起来流被打包了。许多容器格式将比特流分成数据包并添加一些信息，例如时间戳、数据包长度等。这为解码器提供了挂钩，可以跳过文件而不解码所有内容，在数据包丢失时重新同步，同步音频/视频，组合多个流等

查看 MP4 文件格式信息以获取更多信息：
[http ://en.wikipedia.org/wiki/MPEG-4_Part_14](http://en.wikipedia.org/wiki/MPEG-4_Part_14)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-04-10T15:28:38.707

您可以阅读更多关于您在开放[h264 规范](https://www.itu.int/rec/recommendation.asp?lang=en&parent=T-REC-H.264-201304-S)中所做的更改。附录 B 章。

# c# - C# MVC4 中的全局 javascript 变量

> ID：11543842
> 
> 赞同：0
> 
> 时间：2012-07-18T14:34:30.083
> 
> 标签：c#, javascript, asp.net-mvc-4

[我在这里](https://stackoverflow.com/questions/2932782/global-variables-in-javascript-across-multiple-files)通过定义 js 变量来遵循答案。但是，如果我在浏览时转到另一个页面，则该变量的范围不会保留。这似乎是合理的，因为我确实转到浏览器中的另一个页面。所以我想知道如何在浏览时跨多个页面保存 js 变量？我需要在 C# 中使用会话变量、查询字符串吗？或者有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:42:18.273

一种方法是使用本地存储，这是一种 HTML5 功能。

[http://paperkilledrock.com/2010/05/html5-localstorage-part-one/](http://paperkilledrock.com/2010/05/html5-localstorage-part-one/)

当然，这取决于您的客户以及您是否希望他们能够使用 HTML5。

否则 Cookie 可能是最好的途径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:39:50.427

没有跨页面范围的变量。在客户端，您可以使用 cookie 或查询字符串，或者您可以将值保存在服务器端的会话变量中，或者将其以 post 数据发送到服务器端，并将其放入页面中，以便在客户端代码。

# asp.net-mvc - ASP MVC 3：获取 javascript 参数以供以后渲染的 HtmlHelper

> ID：11543843
> 
> 赞同：1
> 
> 时间：2012-07-18T14:34:32.287
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我想有一种方法可以将页面中的所有脚本添加到包中并在标记之前呈现它们。

我的助手看起来像：

```
 public static MvcHtmlString Script(this HtmlHelper htmlHelper, string scriptBody)
 {
     htmlHelper.ViewContext.HttpContext.Items["_script_" + Guid.NewGuid()] = scriptBody;
     return MvcHtmlString.Empty;
 } 
```

这取自：[在编辑器/显示模板中使用部分](https://stackoverflow.com/questions/5433531/using-sections-in-editor-display-templates/5433722#5433722) 问题是我不能像这样在我的视图中使用它：

```
@Html.Script(
    {
        <script type="text/javascript" src="somescript.js"> </script>
        <script type="text/javascript"><!--
           ...script body
        </script>
    }); 
```

有没有可能实现这样的目标？我想要脚本的智能感知，但将文本作为参数发送给我的助手。我对 MVC 要求太多了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:42:28.653

我做过类似的事情

```
public static MvcHtmlString Script(this HtmlHelper htmlHelper, string scriptBody)
{
    var stuff = htmlHelper.ViewContext.HttpContext.Items;
    var scripts = stuff['scripts'] as List<string>;
    if( scripts == null )
        scripts = stuff['scripts'] = new List<string>();

    scripts.Add(scriptBody);
    return MvcHtmlString.Empty;
} 
```

这使得以后获取脚本并插入它们变得更加容易。您不必去寻找随机道具，您只需遍历“脚本”。

编辑：

我刚刚阅读了问题的最后一点。如果您正在编写足够的代码以需要智能感知，那么最好将其扔进 .js 文件中......

# scrapy - Scrapy pyOpenSSL Windows 7x64

> ID：11543849
> 
> 赞同：1
> 
> 时间：2012-07-18T14:35:09.757
> 
> 标签：scrapy, pyopenssl

我已经在 x64 windows 7 机器上安装了 pyOpenSSL。

但是每次我尝试访问“https”网站时都会收到错误消息

```
HTTPS not supported: install pyopenssl library 
```

如果您追溯错误，这就是它的来源：

```
scrapy\core\downloader\handlers\http.py", line 34, in _connect
            raise NotSupported("HTTPS not supported: install pyopenssl library") 
```

我抬头`http.py`发现这个：

```
from scrapy import optional_features

ssl_supported = 'ssl' in optional_features
if ssl_supported:
    from twisted.internet.ssl import ClientContextFactory 
```

当我去寻找 optional_features 来添加 pyopenssl 的路径时，我找不到它。

optional_features 文件在哪里？想法是找到文件并添加路径。

这是解决这个问题的正确方法吗？有什么建议么？

**编辑**：

我卸载了 pyOpenSSL 并尝试通过重新安装

```
pip install pyopenssl 
```

但不断出现短缺。错误日志：[http ://sebsauvage.net/paste/?4066d45d10e18a4f#AwpphSnXEhq7Sc9fi6yZdt6O9YEHnHYZl+2k2QgITjQ=](http://sebsauvage.net/paste/?4066d45d10e18a4f#AwpphSnXEhq7Sc9fi6yZdt6O9YEHnHYZl+2k2QgITjQ=)

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-05-07T16:56:50.210

尝试：easy_install pyOpenSSL==0.15

# extjs - 网格 extjs 中的分页

> ID：11543852
> 
> 赞同：0
> 
> 时间：2012-07-18T14:35:19.257
> 
> 标签：extjs, grid, paging

我想使用分页工具栏但有一个问题。我不提供服务，所以我需要使用我拥有的 json。问题是 json 的格式与教程不同。

```
{
"Weather": [{
    "totalCount": 2962,
    some data
           },{
    "totalCount": 2962,
    some data
           }]
} 
```

但在教程中我看到它应该是

```
{
"totalCount": 2962,
"Weather": [{
    some data
           },{
    some data
           }]
} 
```

有没有办法可以使用我拥有的格式？我试图这样做：

```
proxy: {
      type: 'ajax',
  url: detailURL,
       reader: {
            type: 'json',
            root: 'Weather',
            totalProperty: 'Weather.totalCount'
     }
   }, 
```

那没有用。建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:39:13.650

您的格式错误，因为总数在每个数组元素内。Unfurtunatellly 你需要改变你的格式。您可以尝试以下方法：

```
// inside your reader (gets the totalCount of the first array element)
totalProperty: 'Weather[0].totalCount' 
```

但这确实不是正确的选择，因为让每个数组元素具有相同的计数是没有意义的，您不同意吗？

# android - 图形布局 ADT 预览中的 Resources$NotFoundException（但应用程序实际上可以工作）

> ID：11543855
> 
> 赞同：7
> 
> 时间：2012-07-18T14:35:27.130
> 
> 标签：android, exception, layout, adt

我的问题是加载在 XML 中定义的字符串数组在应用程序中工作，但会导致 ADT 图形布局预览中的错误。

由于这个错误，现在我在 Graphical Layout 中看不到任何图形，并且很难使用其他图形。但是如果我构建和运行我的应用程序，视图正在加载和显示字符串。

所以我想我的代码是正确的，但要么：

*   我缺少图形布局预览的一些限制和一些解决方法
*   或者也许我遗漏了一些明显的东西并且做错了即使它似乎在应用程序中工作

我有一个自定义视图，其中我在 array.xml 文件中获得了我定义的数组。

```
public class ScoreTable extends View {
  [...]
  @Override
  protected void onDraw(Canvas canvas) {
    [...]
    int score_vals[] = getResources().getIntArray(R.array.score_vals);
    [...]
  }
  [...]
} 
```

我的数组在 res/values/array.xml 中定义：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <array name="score_vals">
        <item >10</item>
        <item >20</item>
        <item >50</item>
    </array>
</resources> 
```

图形布局为空白并显示：

```
Int array resource ID #0x7f050000
Exception details are logged in Window > Show View > Error Log 
```

但是我当然有“public static final int score_vals=0x7f050000;” 在 R.java 中！

此错误的详细信息位于 50 深的堆栈中，但继续如下：

```
android.content.res.Resources$NotFoundException: Int array resource ID #0x7f050000
    at android.content.res.Resources.getIntArray(Resources.java:405)
    at com.threecats.poker.ScoreTable.onDraw(ScoreTable.java:53)
    at android.view.View.draw(View.java:6740)
[...] 
```

那么，getResources().getXXXArray() 是否应该在 ADT 图形布局预览的上下文中工作？

我想提一下，我尝试在 XML 中同时使用“array”和“array-integer”，它们都可以在应用程序中使用，但不能在预览中使用。我还尝试将 Context 从视图的构造函数中保存在私有 Context 成员中......也没有帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-18T15:20:18.713

您的代码没问题，但不幸的是 ADT 插件中仍然存在一些错误，其中有一个。布局编辑器在渲染自定义视图时遇到问题。我有同样的问题，我发现的唯一锻炼是检查[View.isInEditMode](http://developer.android.com/reference/android/view/View.html#isInEditMode())并以其他方式初始化 int 数组，但不是从资源中。因此，您的代码将如下所示：

```
int score_vals[];
if (isInEditMode()) {
    score_vals = { 10, 20, 50 };
} else {
    score_vals = getResources().getIntArray(R.array.score_vals);
} 
```

顺便说一句，不要在您的`onDraw`方法中创建或加载任何资源。我想`getResources().getIntArray`使用某种缓存，但无论如何你的性能可能会受到影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T09:15:56.967

我找到了一种解决方法，您必须劫持 android 自己的属性才能访问设计器中的资源。

下面应该提供这个想法，但你必须找到一个 int[] 类型的原生 android 属性

### 此自定义视图 XML 应在使用资源时呈现在图形布局预览中

```
<!-- Could override individual attributes here too rather than using a style -->
<com.github.espiandev.showcaseview.ShowcaseView
     style="@style/ShowcaseView"/> 
```

### styles.xml - 指定要使用的一些资源的样式

```
<style name="ShowcaseView" parent="match_fill">
    <!--# Cling drawable -->
    <item name="android:src">@drawable/cling</item>
    <!--# Title #-->
    <item name="android:contentDescription">@string/showcase_title</item>
    <!--# Description #-->
    <item name="android:description">@string/showcase_description</item>
    <!--# Button Text #-->
    <item name="android:text">@string/ok</item>
    <item name="sv_titleTextColor">#33B5E5</item>
    <item name="sv_detailTextColor">#FFFFFF</item>
    <item name="sv_backgroundColor">#3333B5E5</item>
    <item name="sv_buttonBackgroundColor">#3333B5E5</item>
    <item name="sv_buttonForegroundColor">#33B5E5</item>
</style> 
```

### attrs.xml - 与设计时预览兼容的自定义属性定义

```
<!-- The android attrs assume the corresponding android format / data type --> 
<declare-styleable name="ShowcaseView">
    <!--# Cling drawable -->
    <attr name="android:src"/>
    <!--# Title #-->
    <attr name="android:contentDescription"/>
    <!--# Description #-->
    <attr name="android:description"/>
    <!--# Button Text #-->
    <attr name="android:text"/>
    <attr name="sv_backgroundColor" format="color|reference" />
    <attr name="sv_detailTextColor" format="color|reference" />
    <attr name="sv_titleTextColor" format="color|reference" />
    <attr name="sv_buttonBackgroundColor" format="color|reference" />
    <attr name="sv_buttonForegroundColor" format="color|reference" />
</declare-styleable> 
```

### ShowcaseView.java - 在自定义视图中使用自定义属性

```
public ShowcaseView(Context context) {
    this(context, null, R.styleable.CustomTheme_showcaseViewStyle);
}

public ShowcaseView(Context context, AttributeSet attrs) {
    this(context, attrs, R.styleable.CustomTheme_showcaseViewStyle);
}

public ShowcaseView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
    // Get the attributes for the ShowcaseView
    final TypedArray styled = context.getTheme().obtainStyledAttributes(attrs, R.styleable.ShowcaseView, 0, 0);
    showcase = styled.getDrawable(R.styleable.ShowcaseView_android_src);
    titleText = styled.getString(R.styleable.ShowcaseView_android_contentDescription);
    subText = styled.getString(R.styleable.ShowcaseView_android_description);
    buttonText = styled.getString(R.styleable.ShowcaseView_android_text);
    backColor = styled.getInt(R.styleable.ShowcaseView_sv_backgroundColor, Color.argb(128, 80, 80, 80));
    detailTextColor = styled.getColor(R.styleable.ShowcaseView_sv_detailTextColor, Color.WHITE);
    titleTextColor = styled.getColor(R.styleable.ShowcaseView_sv_titleTextColor, Color.parseColor("#49C0EC"));
    styled.recycle();
    // Now make use of the fields / do further initialization ..
} 
```

# ruby-on-rails - 如何正确解析xml数据？

> ID：11543858
> 
> 赞同：0
> 
> 时间：2012-07-18T14:35:30.567
> 
> 标签：ruby-on-rails, paypal

我有创建付款的操作，我需要重定向用户以完成付款。我使用了支付 API 操作。

在 Pay API 中，据说：

```
 You must redirect the sender to PayPal to complete the payment 
```

但是确切的 url 是什么？在开发和生产中我应该在哪里重定向用户？

这是我的控制器：}

**编辑**

```
 @xml = XmlSimple.xml_in(res.content)
 payKey = @xml['payKey']
 redirect_to "https://svcs.sandbox.paypal.com/AdaptivePayments/Pay?cmd=_ap-payment&paykey="+payKey.to_s() 
```

从日志**错误**：

```
 Redirected to https://svcs.sandbox.paypal.com/AdaptivePayments/Pay?cmd=_ap-payme
     nt&paykey=["AP-7FC15543VK133501B"]
    Completed 302 Found in 1780ms (ActiveRecord: 0.0ms)
   [2012-07-18 20:01:53] ERROR URI::InvalidURIError: bad URI(is not URI?): https://svcs.sandbox.paypal.com/AdaptivePayments/Pay?cmd=_ap-payment&paykey=["AP-7FC15543VK133501B"] 
```

**所以我需要删除[“”]，是吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T16:47:11.183

根据[Adaptive Payments 指南](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_AdaptivePayments.pdf)的第 70 页，您需要将它们重定向到[https://www.paypal.com/webscr?cmd=_ap-payment&paykey=value](https://www.paypal.com/webscr?cmd=_ap-payment&paykey=value)，其中“value”是 payKey。

沙盒（开发）环境的等效 URL 是[https://www.sandbox.paypal.com/webscr?cmd=_ap-payment&paykey=value](https://www.sandbox.paypal.com/webscr?cmd=_ap-payment&paykey=value)

# java - 计算字符串的字母（大写和小写）

> ID：11543860
> 
> 赞同：1
> 
> 时间：2012-07-18T14:35:34.663
> 
> 标签：java, file-io, for-loop

我这里有一个程序，它输入一个段落并将其写入一个文件。之后，它应该计算每个字母的出现次数（区分大小写）。但是，它不计算字母出现的次数。我想我把 `for`循环放在错误的地方。

```
import java.io.*;
import java.util.*;
public class Exercise1 {

    public static int countLetters (String line, char alphabet) {
        int count = 0;
        for (int i = 0; i <= line.length()-1; i++) {
            if (line.charAt(i) == alphabet)
                count++;
        }
        return count;
    }

    public static void main(String[] args) throws IOException {
        BufferedReader buffer = new BufferedReader (new InputStreamReader(System.in));
        PrintWriter outputStream = null;
        Scanner input = new Scanner (System.in);
        int total;

        try {
            outputStream = new PrintWriter (new FileOutputStream ("par.txt"));
            System.out.println("How many lines are there in the paragraph you'll enter?");
            int lines = input.nextInt();
            System.out.println("Enter the paragraph: ");
            String paragraph = buffer.readLine();
            outputStream.println(paragraph);
            int j;
            for (j = 1; j<lines; j++) {
                paragraph = buffer.readLine();
                outputStream.println(paragraph);    
            }
            outputStream.close();
            System.out.println("The paragraph is written to par.txt");

            for (int k=1; k<lines; k++) {
                paragraph = buffer.readLine();
                total = countLetters (paragraph, 'A');
                if (total != 0)
                    System.out.println("A: "+total);
                            //I'll do bruteforce here up to lowercase z

            }
        }

        catch(FileNotFoundException e) {
            System.out.println("Error opening the file par.txt");
        }

    }

} 
```

请帮我修复代码。我是编程新手，我需要帮助。非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T14:53:38.987

首先，您最初的阅读用户输入有点浪费，因为您阅读了一次然后进入 for 循环其余部分 - 这不是问题，只是更好的代码。

```
// your code
String paragraph = buffer.readLine();
outputStream.println(paragraph);
int j;
for (j = 1; j<lines; j++) {
     paragraph = buffer.readLine();
     outputStream.println(paragraph);    
 } 
```

您可以将它们放入循环中：

```
// better code
String paragraph;
int j;
for (j = 0; j<lines; j++) {
     paragraph = buffer.readLine();
     outputStream.println(paragraph);    
} 
```

那么您的第一个问题来自您阅读这些行的方式：

```
// your code - not working
outputStream.close();
for (int k=1; k<lines; k++) {
      paragraph = buffer.readLine();
      total = countLetters (paragraph, 'A'); 
```

考虑上面发生的事情：

*   输入已经**完成**，输出已经写入并且流已经关闭——到这里一切都很好
*   然后，当您尝试计算字符数时，您会：`paragraph = buffer.readLine();`- 这段代码有什么作用？它等待另一个用户输入（而不是读取插入的内容）

要解决上述问题：您需要从**已经**编写的内容中读取 - 而不是要求其他输入。然后，您可以将它们放入一个列表并编写一个 for 循环，而不是一个一个地强制每个字符。

所以现在，您想从您已经创建的现有文件中读取（即读取用户输入的 WAS 内容）：

```
BufferedReader fileReader = new BufferedReader(new FileReader(new File("par.txt")));

String allCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
String aLineInFile;

// Read the file that was written earlier (whose content comes from user input)
// This while loop will go through line-by-line in the file
while((aLineInFile = fileReader.readLine()) != null)
{
      // For every line in the file, count number of occurrences of characters  
      // This loop goes through every character (a-z and A-Z)  
      for(int i = 0; i < allCharacters.length(); i++)
      {
            // For each single character, check the number of occurrences in the current line
            String charToLookAt = String.valueOf(allCharacters.charAt(i));
            int numOfCharOccurancesInLine = countLetters (aLineInFile, charToLookAt);

            System.out.println("For line: " + aLineInFile + ", Character: " + charToLookAt + " appears: " + numOfCharOccurancesInLine + " times " );
      }         
} 
```

以上为您提供了每行中每个字符的出现次数 - 现在您只需组织它们以跟踪整个文件的总数。

在代码方面，可能有更好的方法来编写它以获得更清晰的实现，但上面的内容很容易理解（而且我写得很快）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:41:02.327

在一个循环中完成所有操作：

```
 for (j = 1; j<lines; j++) {
            paragraph = buffer.readLine();
            total = countLetters (paragraph, 'A');
            if (total != 0)
                System.out.println("A: "+total);
            outputStream.println(paragraph);    
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T03:26:00.340

以前的答案可以解决您的问题，但另一种避免蛮力的方法可能是使用使用 ASCII 字符值的循环。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T15:05:00.313

您可以使用 HashTable 计算每个大小写敏感字母：

```
 final Pattern patt = Pattern.compile("A-Za-z]");
        final HashMap<Character, Integer> tabChar = new HashMap<Character, Integer>(
            52);

        // replace : paragraph = buffer.readLine();
        // Unless you use it outside, you can declare it 'final'
        final char[] paragraph = "azera :;,\nApOUIQSaOOOF".toCharArray();

        for (final Character c : paragraph ) {
            if (Character.isLetter(c)) {
                Integer tot = tabChar.get(c);
                tabChar.put(c, (null == tot) ? 1 : ++tot);
            }
        } 
```

输出 ：

```
{F=1, A=1, O=4, I=1, U=1, Q=1, S=1, e=1, a=3, r=1, p=1, z=1} 
```

您可以使用`final TreeSet<Character> ts = new TreeSet(tabChar.keySet());`对字符进行排序，然后将`get(c);`它们从`tabChar`

# xslt - 返回特定类型的子节点及其属性 (Umbraco)

> ID：11543861
> 
> 赞同：1
> 
> 时间：2012-07-18T14:35:36.143
> 
> 标签：xslt, umbraco, nodes

我正在尝试编写一些基本上应该通过以下算法的 XSLT：

```
if child of current node is of type Accordion
    if child of Accordion node is of type AccordionItem
        take the AccordionItem's title and content and display in <div> tags
    end if
end if 
```

看起来很简单，但是我目前拥有的代码似乎没有按应有的方式工作。我一定错过了什么，但我无法弄清楚到底是什么。到目前为止，这是我的 XSLT 代码：

```
<xsl:for-each select="$currentPage/ancestor-or-self::Home//AccordionItem[@isDoc]">
    <div id="accordion">
        <h3><a href='#'><xsl:value-of select="accordionItemTitle"/></a></h3>
        <div><xsl:value-of select="accordionItemContent" disable-output-escaping="yes" />
        </div>
    </div>
</xsl:for-each> 
```

任何人都可以就为什么这不能正常工作提供任何建议吗？先谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:51:33.953

您的 XPath 似乎与您在算法中定义的行为不太一样，并且正在导航到 type 的节点`Home`，这是有意的吗？

如果不是，请尝试将 XPath 修改为以下内容：

```
<xsl:for-each select="$currentPage/Accordion/AccordionItem[@isDoc]"> 
```

# ruby-on-rails - 在 heroku 上部署设计/omniauth

> ID：11543863
> 
> 赞同：1
> 
> 时间：2012-07-18T14:35:39.140
> 
> 标签：ruby-on-rails, heroku, devise

运行时：

```
heroku run rake db:migrate 
```

我返回错误：

```
Running `rake db:migrate` attached to terminal... up, run.1
rake aborted!
no such file to load -- devise 
```

这是我在 application.rb 文件顶部的“require 'devise'”行中看到的错误。以前（没有这一行），我在运行 heroku run rake db:migrate 时返回一个不同的错误，说“未初始化的常量设计”。

我的应用程序在本地运行良好。我似乎找不到其他有同样问题的人，所以任何线索将不胜感激！

（编辑）：添加 Gemfile：

```
source 'https://rubygems.org'

gem 'rails', '3.2.3'
gem 'bootstrap-sass', '2.0.0'

group :development do

gem 'sqlite3', '1.3.5'
gem 'rspec-rails', '2.9.0'
gem 'guard-rspec', '0.5.5'
gem 'devise'
gem 'omniauth-linkedin'
gem 'nifty-generators', :group => :development
gem 'debugger'
gem 'linkedin', :git => "git://github.com/pengwynn/linkedin.git"

end 

group :assets do

gem 'sass-rails', '3.2.4'
gem 'coffee-rails', '3.2.2'
gem 'uglifier', '1.2.3'
gem 'jquery-rails'#, '2.0.0'

end

group :test do

gem 'rspec-rails', '2.9.0'
gem 'capybara', '1.1.2'
gem 'rb-fsevent', '0.4.3.1', :require => false
gem 'growl', '1.0.3'
gem 'guard-spork', '0.3.2'
gem 'spork', '0.9.0'

end

group :production do

gem 'pg', '0.12.2'

end

gem "mocha", :group => :test 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:54:57.527

问题是：Heroku 在没有开发或测试组的情况下编译您的 gem 文件。

要修复它，只需从这里获取您需要的内容：

```
group :development do

gem 'sqlite3', '1.3.5'
gem 'rspec-rails', '2.9.0'
gem 'guard-rspec', '0.5.5'
gem 'devise'
gem 'omniauth-linkedin'
gem 'nifty-generators', :group => :development
gem 'debugger'
gem 'linkedin', :git => "git://github.com/pengwynn/linkedin.git"

end 
```

并将其移动到开发或测试组之外的任何地方，如下所示：

```
group :development do

gem 'sqlite3', '1.3.5'
gem 'rspec-rails', '2.9.0'
gem 'guard-rspec', '0.5.5'
gem 'omniauth-linkedin'
gem 'nifty-generators', :group => :development
gem 'debugger'
gem 'linkedin', :git => "git://github.com/pengwynn/linkedin.git"

end 

gem 'devise' 
```

# api - freebase api - 通过 GUID 恢复内容

> ID：11543867
> 
> 赞同：0
> 
> 时间：2012-07-18T14:35:56.567
> 
> 标签：api, freebase

我正在尝试通过 guid 获取主题详细信息，因为它是我从客户端获得的唯一参数。是否可以通过它的指南获取有关主题的所有详细信息？我正在尝试使用“trans raw”，但从 freebase 返回的信息量非常少。另外，我正在尝试使用 mql：

```
https://api.freebase.com/api/service/mqlread?query={"query":[{ "guid":"#9202a8c04000641f800000001b6c8698" }]} 
```

但也没有取得任何成功。请问这里有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:54:59.803

忽略为什么您要求为您不知道如何做的工作获得报酬的问题，您应该尝试以下方式：

[http://www.freebase.com/queryeditor?q=%5B%7B%22guid%22%3A%22%239202a8c04000641f800000001b6c8698%22%2C%22type%22%3A%5B%5D%2C%22name%22%3Anull %7D%5D](http://www.freebase.com/queryeditor?q=%5B%7B%22guid%22%3A%22%239202a8c04000641f800000001b6c8698%22%2C%22type%22%3A%5B%5D%2C%22name%22%3Anull%7D%5D)

[http://wiki.freebase.com](http://wiki.freebase.com)上有大量关于如何使用各种 API 的文档。

另请注意，您正在使用已弃用的已弃用 API，但如果这是一次性任务，这不是问题。

# asp.net - SignalR 通知问题

> ID：11543870
> 
> 赞同：1
> 
> 时间：2012-07-18T14:36:00.870
> 
> 标签：asp.net, asp.net-web-api, signalr

我有一个监控站点，它将数据从服务器更新到客户端。我正在使用 SignaR 执行此操作。我有一个问题，当我加载页面时，我需要第一次获取数据，然后服务器上有一个工作人员负责每次 x 次通知客户端。我在 My Web API 控制器中添加了一个方法，因此页面使用它来获取当前数据，并且我希望工作人员也可以使用它来通知客户端。我的问题，我不希望第一个加载页面发出通知（因为我在同一个 api 方法中的通知登录相同）有没有办法在 Hub 类之外获取 ConnectionID。

提前致谢 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T18:22:03.800

是的，您可以在集线器上下文之外联系集线器：

```
var myHub = GlobalHost.ConnectionManager.GetHubContext<MyHub>(); 
```

# tomcat7 - Tomcat 版本 7，无法登录

> ID：11543873
> 
> 赞同：0
> 
> 时间：2012-07-18T14:36:06.753
> 
> 标签：tomcat7

在我的 tomcat-users.xml 中，我有

```
<tomcat-users>
<role rolename="admin-gui"/>
<role rolename="manager-gui"/>
<user username="admin" password="pass" roles='admin-gui,manager-gui'/>
</tomcat-users> 
```

当我尝试`http://localhost:8080/manager/html`使用用户名和密码访问时，它并没有让我登录。同样的身份验证框再次出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:38:44.637

将您的角色放在双引号中：

```
<user username="admin" password="pass" roles="admin-gui,manager-gui"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T12:13:27.910

我发现在更改 tomcat-user.xml 后有必要重新启动 tomcat 服务器并重新启动/关闭/重新打开浏览器。

然后这奏效了。

重新启动 tomcat 服务器时，我使用 ./shutdown.sh 等待几秒钟，然后使用 tomcat bin 目录中的 ./startup.sh。这使服务器有机会重新加载。

# ios - 归档应用程序在管理器屏幕上产生模糊图标

> ID：11543875
> 
> 赞同：2
> 
> 时间：2012-07-18T14:36:09.607
> 
> 标签：ios, archiving

我已经指定了视网膜和非视网膜图像，并验证我将它们放在 Xcode 中的正确位置。归档应用程序后，图标出现模糊，如附件所示。

我能做些什么来解决这个问题？

![在此处输入图像描述](../Images/ce48ab0c6aa7d948eb51cd2cf9c5179c.png)

列表文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>CFBundleDevelopmentRegion</key>
    <string>en</string>
    <key>CFBundleDisplayName</key>
    <string>${PRODUCT_NAME}</string>
    <key>CFBundleExecutable</key>
    <string>${EXECUTABLE_NAME}</string>
    <key>CFBundleIcons</key>
    <dict>
        <key>CFBundlePrimaryIcon</key>
        <dict>
            <key>CFBundleIconFiles</key>
            <array>
                <string>app_icon_57.png</string>
                <string>app_icon_114.png</string>
            </array>
        </dict>
    </dict>
    <key>CFBundleIdentifier</key>
    <string>com.gannett.democratandchronicle.${PRODUCT_NAME:rfc1034identifier}</string>
    <key>CFBundleInfoDictionaryVersion</key>
    <string>6.0</string>
    <key>CFBundleName</key>
    <string>${PRODUCT_NAME}</string>
    <key>CFBundlePackageType</key>
    <string>APPL</string>
    <key>CFBundleShortVersionString</key>
    <string>1.0</string>
    <key>CFBundleSignature</key>
    <string>????</string>
    <key>CFBundleVersion</key>
    <string>1.0</string>
    <key>LSRequiresIPhoneOS</key>
    <true/>
    <key>UIMainStoryboardFile</key>
    <string>MainStoryboard</string>
    <key>UIRequiredDeviceCapabilities</key>
    <array>
        <string>armv7</string>
    </array>
    <key>UISupportedInterfaceOrientations</key>
    <array>
        <string>UIInterfaceOrientationPortrait</string>
    </array>
</dict> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T17:49:26.977

它只是在组织者中模糊不清。它对用户设备或 App Store 上的图标没有影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T23:47:33.000

这是 xcode 中的一个错误 - 我已经向Apple 提交了一个描述它的雷达（ [openradar 链接）。](http://openradar.appspot.com/radar?id=2286402)

如上所述，它不会影响在 iOS 上创建的 .ipa。如果问题困扰您，解决方法是在 info.plist 图标文件数组中的 1x 版本之前定义图标的 @2x 版本。

# javascript - 向文本框添加永久前缀

> ID：11543881
> 
> 赞同：2
> 
> 时间：2012-07-18T14:36:20.873
> 
> 标签：javascript, jquery, textbox, prefix

我想要实现的是强制文本框以前缀（国家电话代码）开头并使其永久化，这意味着用户无法绕过它。例如，电话文本框应始终以“+45”开头，然后用户可以添加电话号码。如何以任何方式防止它删除代码？

到目前为止，我使用 jQuery 做了什么：

```
//attach event on phone text boxes
$(document).delegate(".phone", "keyup", function(event){

var target = $(this);

var value = target.val().trim();

if (value.indexOf(CONSTANTS.DANISH_PHONE_CODE) == -1) {
    //country code not found

    //if the user starts deleting the country code 
    if (value.indexOf("+") == 0){
        value = "";
    }

    //if the user types something in front of the country code, put the country code at the end
    value = value.replace(CONSTANTS.DANISH_PHONE_CODE, "");

    //phone doesn't start with +45
    value = CONSTANTS.DANISH_PHONE_CODE + value;

    target.val(value); 
}

}); 
```

但问题是用户可以删除加号，前缀会自动放在开头，所以我们将得到 +4545。你知道实现这一目标的优雅方法吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:40:01.480

您可以绝对地将文本（在跨度中）放置在文本框上并为其添加左边距。

这样用户将无法删除它。但是您必须将其添加到服务器端。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-18T14:43:31.360

在字段前添加 +45 作为静态 html。要求用户输入号码的“其余部分”（不是 +45）。

如有必要，请在保留值之前添加 +45 服务器端。同样，编辑时去掉+45。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:49:11.580

[JSFiddle 示例](http://jsfiddle.net/coreyog/9fuh3/)

这应该主动阻止他们删除“+45”，而不是在用户更改后尝试修复问题。按键时，确定字符位置，如果该位置在字符串中太早（即在“+45”内，而不是在它之后），则不允许按键，除非该键是向左或向右箭头键。

获得的资源：

[http://blog.vishalon.net/index.php/javascript-getting-and-setting-caret-position-in-textarea](http://blog.vishalon.net/index.php/javascript-getting-and-setting-caret-position-in-textarea) [在 JS/jQuery 中绑定箭头键](https://stackoverflow.com/questions/1402698/binding-arrow-keys-in-js-jquery)

# javascript - 使用 Youtube iframe 删除 DOM 元素时未定义“__flash__removeCallback”

> ID：11543888
> 
> 赞同：8
> 
> 时间：2012-07-18T14:36:36.177
> 
> 标签：javascript, youtube, internet-explorer-9

我有一个通过 iframe 嵌入 Youtube 视频的 div。

```
<div id="container">
    <div id="video">
        <iframe width="480" height="360" src="http://www.youtube.com/embed/LiyQ8bvLzIE" frameborder="0" allowfullscreen></iframe>
    </div>
</div> 
```

我使用 ajax 调用更改了#container 的内容

```
$.get(url, function(data) {
    ('#container').html(data);
} 
```

现在我在 IE9 中收到以下错误：“SCRIPT5009：'_ *flash* _removeCallback'未定义”。

我尝试在 ajax 调用之前删除、删除……视频和/或 iframe，但这不起作用：

```
<script>
    $('#video').html('')
</script>

<script>
    $('#video').empty()
</script>

<script>
    $('#video').remove()
</script>

<script>
    $('#video iframe').attr('src', '')
    $('#video').empty()
</script>

<script>
    $('#video').hide()
    $('#video iframe').attr('src', '')
    $('#video').empty()
</script>

... 
```

但现在我没主意了...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T10:26:42.843

最后我得到了解决方案。

我不知道您使用的是哪种服务器端语言，我使用的是 PHP。无论如何，如果浏览器是 IE9，然后使用对象标签。

```
if (preg_match('/MSIE 9.0/', $_SERVER['HTTP_USER_AGENT'])) { /*for IE 9.0 generate with objace tag*/ ?>
     <object type="application/x-shockwave-flash" data="VIDEO_URL">
      <param name="movie" value="VIDEO_URL" />
      </object>
 <?php } else { /*rest of all browsers,in iframe*/ ?>
      <iframe src="VIDEO_URL"></iframe>
 <?php } ?> 
```

简而言之，使用`object`标签为 IE9 和`iframe`休息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T20:27:16.253

我得到了解决方案。

```
ytplayer.getIframe().src=''; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T22:27:17.040

如果您仍想继续使用 iframe 代码，可以通过调用 removeAttr 删除 iframe src（而不是尝试将其设置为空白）。

```
$('#video iframe').removeAttr('src') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-05T16:24:35.917

我收到了同样的错误并找到了自己的解决方案。我觉得为 IE9/IE10 使用旧的“对象”解决方案并不是真正的解决方案，因为您永远不必专门为一个浏览器编写代码。

我的情况不同，我只需要弹出一个视频，然后在单击关闭按钮时停止播放并消失。

使用您提供的代码...

```
function playVideo() {
    $('#video iframe').attr('src', 'http://www.youtube.com/embed/VIDEO_ID_HERE');
    $('#video iframe').fadeIn();
}

function stopVideo() {
    $('#video iframe').attr('src', '');
    $('#video').fadeOut();
} 
```

# java - 如何创建对象数组

> ID：11543896
> 
> 赞同：2
> 
> 时间：2012-07-18T14:36:54.140
> 
> 标签：java, class

我认为这很简单，因为我很确定我以前做过，但我似乎无法让它发挥作用。我的课是：

```
public class City
{
    String start = null;
    String end = null;
    int weight = 0;
} 
```

我正在做：

```
City cityGraph[] = new City[l]; 
```

例如，当我尝试访问 cityGraph[x].start 时，我得到一个空指针异常，所以我想我还需要初始化数组中的每个元素，所以我这样做：

```
for(int j = 0; j < l; j++)
        {
            cityGraph[j] = new City();
        } 
```

但它给了我这个错误：

```
No enclosing instance of type Graphs is accessible. 
Must qualify the allocation with an enclosing instance 
of type Graphs (e.g. x.new A() where x is an instance of Graphs). 
```

我不知道这意味着什么，或者如何解决它。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T14:42:55.370

当您声明为这样的内部类时，可能会发生这种`public class City`情况`public class Graphs`

```
public class Graphs {

    public class City {

    }

} 
```

这样，`City`如果不先构造`Graphs`实例，就无法构造。

您需要构建`City`如下：

```
cityGraph[j] = new Graphs().new City();
// or
cityGraph[j] = existingGraphsInstance.new City(); 
```

老实说，这没有任何意义。而是将其提取`City`到一个独立的类中，

```
public class Graphs {

} 
```

```
public class City {

} 
```

或通过声明它使其成为静态嵌套类`static`。

```
public class Graphs {

    public static class City {

    }

} 
```

无论哪种方式，您都可以`City`通过 just构建一个新的`new City()`。

### 也可以看看：

*   [Java 教程 - 学习语言 - 类和对象 - 嵌套类](http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:42:19.640

看来您的类不是静态内部类，这意味着它需要外部类的实例才能被实例化。

有关静态与内部类的更多信息 [http://mindprod.com/jgloss/innerclasses.html](http://mindprod.com/jgloss/innerclasses.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:40:01.640

我实际上有自己问题的答案。使类静态修复它。我不知道为什么直到我发布后我才想到这个......希望这对将来的某人有所帮助。

# java - Android Listview 和 textWatcher

> ID：11543900
> 
> 赞同：3
> 
> 时间：2012-07-18T14:37:03.157
> 
> 标签：java, android, listview, android-listview, textwatcher

大家下午好 ：）

我有一个用于添加目标的列表视图（不重要：p）。列表视图的子视图有一些文本视图和编辑文本框，用户可以在其中填写其信息。我有一个 Textwatcher，它检查 listview 的一个子项中的文本是否已更改，因此可以将数据写入 listview + 全局数组之外的数组中的类（用于在 activety 之间传递数据，但这也不重要）。

现在我的问题是，当我将一个项目添加到列表中时，edittext 'discription' 中所有先前现有项目的文本都会更改为新添加项目的文本。例如，当我在列表视图中有 1 个项目显示“测试”时，我在列表中添加了一个新项目，显示“这是一个新测试”>>两者都更改为“这是一个新测试”。我对程序进行了很多调试，并注意到最后（在添加新项目之后），程序将通过 textwatcher 's' = 'this is a new test' 和 position = '0'。这可能会导致第一个的文本发生变化。但我不明白为什么会这样。

有人可以帮助我吗？

这是我的列表视图：

```
class listViewAdapter extends BaseAdapter {
        private Context context;
        private ArrayList<Goals> list;

        public listViewAdapter(final Context context, ArrayList<Goals> list) {
            this.context = context;
            this.list = list;
        }

        @Override
        public int getCount() {
            return list.size();
        }

        @Override
        public Object getItem(int position) {
            return list.get(position);
        }

        @Override
        public long getItemId(int position) {
            return position;
        }

        public void synchronise(){
            geldclass.setGoals_list(this.list);
        }

        @Override
        public View getView(final int position, View convertView, ViewGroup parent) {
            if (convertView == null) {
                final LayoutInflater inflater = (LayoutInflater) context
                        .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    convertView = inflater.inflate(R.layout.goal_item, parent,
                            false);
            }

            Goals goal = (Goals) getItem(position);

            final EditText txtdiscription = (EditText) convertView.findViewById(R.id.editDiscription);
            txtdiscription.setText(goal.getDiscription());
            txtdiscription.addTextChangedListener(new textWatcher(txtdiscription, position));

            final EditText txtgoal = (EditText) convertView
                    .findViewById(R.id.editGoal);
            txtgoal.addTextChangedListener(new textWatcher(txtgoal, position));

            final EditText txtfrom = (EditText) convertView
                    .findViewById(R.id.editFrom);
            txtfrom.addTextChangedListener(new textWatcher(txtfrom, position));

            final EditText txtto = (EditText) convertView
                    .findViewById(R.id.editto);
            txtto.addTextChangedListener(new textWatcher(txtto, position));

            final CheckBox check_date = (CheckBox) convertView
                    .findViewById(R.id.check_enable_date);
            check_date
                    .setOnCheckedChangeListener(new OnCheckedChangeListener() {
                        @Override
                        public void onCheckedChanged(CompoundButton buttonView,
                                boolean isChecked) {

                        }
                    });

            return convertView;
        }

        private class textWatcher implements TextWatcher {
            private View view;
            private int position;

            private textWatcher(View view, int position) {
                this.view = view;
                this.position = position;
            }

            @Override
            public void afterTextChanged(Editable s) {
                switch (view.getId()) {
                case R.id.editDiscription:
                    list.get(position).setDiscription(s.toString());
                    synchronise();
                    break;
                case R.id.editGoal:
                    list.get(position).setGoalvalue(Integer.parseInt(s.toString()));
                    synchronise();
                    break;
                }
            }

            @Override
            public void beforeTextChanged(CharSequence s, int start, int count,
                    int after) {
                // TODO Auto-generated method stub

            }

            @Override
            public void onTextChanged(CharSequence s, int start, int before,
                    int count) {
                // TODO Auto-generated method stub

            }
        }
    } 
```

这是我在 xml 中的目标子项：

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TableRow
        android:id="@+id/tableRow1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/textDiscription"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="right"
            android:text="@string/name"
            android:textSize="15dp"
            android:width="80dp" />

        <EditText
            android:id="@+id/editDiscription"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:inputType="textNoSuggestions"
            android:width="120dp" >
        </EditText>
    </TableRow>

    <TableRow
        android:id="@+id/tableRow3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/textGoal"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="right"
            android:text="@string/goal"
            android:textSize="15dp" />

        <EditText
            android:id="@+id/editGoal"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:inputType="textNoSuggestions"
            android:width="200dp" >
        </EditText>
    </TableRow>

    <TableRow
        android:id="@+id/tableRow2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <CheckBox
            android:id="@+id/check_enable_date"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/from"
            android:textSize="15dp" />

        <EditText
            android:id="@+id/editFrom"
            android:enabled="false"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:inputType="date"
            android:ems="10" >
        </EditText>
    </TableRow>

    <TableRow
        android:id="@+id/tableRow4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/textfrom"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="right"
            android:text="@string/to"
            android:textSize="15dp" />
        <EditText
            android:id="@+id/editto"
            android:enabled="false"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:inputType="date"
            android:ems="10" >
        </EditText>
    </TableRow>

</TableLayout> 
```

这是我添加项目的地方（不要注意'geldclass'..它是一个存储全局数组的全局类）：

```
public void onClick(View v) {
                Goals goal = new Goals("this is a new test");
                geldclass.addGoals(goal);
                goal_adapter = new listViewAdapter(GoalManager.this, geldclass.getGoals_list());
                goal_list.setAdapter(goal_adapter);
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-16T02:19:07.933

```
public void onClick(View v) {
                Goals goal = new Goals("this is a new test");
                geldclass.addGoals(goal);
                goal_adapter = new listViewAdapter(GoalManager.this, geldclass.getGoals_list());
                goal_list.setAdapter(goal_adapter);
            } 
```

应该改为

```
public void onClick(View v) {
                Goals goal = new Goals("this is a new test");
                geldclass.addGoals(goal);
                goal_adapter.setNotifyDatasetChanges();
            } 
```

调用`setNotifyDatasetChanges()`make **Adapter**以使用其列表中的新更改数据刷新 listView，我假设该`geldclass.getGoals_list()`列表与您之前初始化**Adapter**的列表相同。

# excel - 如何在两个斜杠之间替换excel中的字符串

> ID：11543903
> 
> 赞同：0
> 
> 时间：2012-07-18T14:37:13.563
> 
> 标签：excel

如何替换 excel 中 url 中两个斜杠之间的单词？

前任：

> www.google.com/temp/announce/news/p5638/zero.html
> www.google.com/temp/announce/news/p4231/one.html

到

> www.google.com/temp/announce/news/new **/zero.html**
> www.google.com/temp/announce/news/new **/one.html** _ _

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:53:20.253

如果该值`news/`始终位于要替换的元素之前，则可以使用搜索和替换。按下`ctrl+H`并将这些值输入到查找和替换字段中：

```
Search: /news/*/
Replace: /news/new/ 
```

现在，单击`Replace All`。或者，您可以使用公式。假设这两个值在 A1 和 A2 中，那么 B1 和 B2 中的这些公式将为您解决问题：

```
=MID(A1,1,SEARCH("news/",A1,1)+LEN("news/")-1)&"new"&MID(A1,FIND("/", A1,SEARCH("news/",A1,1)+LEN("news/")),255)
=MID(A2,1,SEARCH("news/",A2,1)+LEN("news/")-1)&"new"&MID(A2,FIND("/", A2,SEARCH("news/",A2,1)+LEN("news/")),255) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:45:52.883

如果它们始终处于相同的深度，我认为实现这一目标的最简单方法是使用“/”作为分隔符拆分您拥有 URL 的列，然后将倒数第二列替换为“新”。然后，您会将这些列合并为一列。

# java - 为空时自动关闭标签发出 xstream

> ID：11543904
> 
> 赞同：0
> 
> 时间：2012-07-18T14:37:15.740
> 
> 标签：java, xml, xstream

我有一个像下面这样的类，我使用 xSteam 将 Edge 转换为 xml。

```
@XStreamAlias("edge")
class Edge{

     @XStreamAsAttribute
     @XStreamAlias("source")
     private String source;

     @XStreamAsAttribute
     @XStreamAlias("target")
     private String target;

     @XStreamAlias("data")
     private Data data;
     .....
} 
```

当我设置 data=null 时，我可以得到

```
 <edge source="8" target="10" /> 
```

但是当 data =null 时我想低于

```
 <edge source="8" target="10" ></edge> 
```

有人可以为此提供帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-02T15:08:50.187

您可以使用 Dom4JDriver 驱动程序。在这种情况下，您可以像以下代码一样格式化您的 xml 输出：

```

```
``OutputFormat outPutFormat = new OutputFormat();
outPutFormat.setLineSeparator("");
outPutFormat.setExpandEmptyElements(true);
outPutFormat.setEncoding("UTF-8");

Dom4JDriver d4j = new Dom4JDriver(new XmlFriendlyNameCoder("_", "_"));
d4j.setOutputFormat(outPutFormat);
XStream xstream = new XStream(d4j);
xstream.autodetectAnnotations(true);`` 
```

 * * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2012-07-18T16:06:18.617

在 XML 级别上您无能为力，因为在该级别上，两种形式完全相同。如果您确实需要一种形式而不是另一种形式，则必须提供自己的 XML 序列化程序，或者使用默认序列化程序并对其输出流进行后处理。在不知道您当前如何序列化数据的情况下，我无法为您提供更多详细信息。 
```

# mysql - 为什么这个mysql代码有错误？

> ID：11543905
> 
> 赞同：-4
> 
> 时间：2012-07-18T14:37:16.277
> 
> 标签：mysql, sql

我在使用这个 mysql 代码时看到错误，为什么？

```
CREATE TABLE books (
      id int(6) unsigned NOT NULL auto_increment,
      title varchar(100) NOT NULL default '',
      author varchar(100) NOT NULL default '',
      price decimal(3,2) NOT NULL default '0.00',
      PRIMARY KEY  (id)
    ) TYPE=MyISAM;

    INSERT INTO books VALUES (1, 'Where God Went Wrong', 'Oolon Colluphid', '24.99');
    INSERT INTO books VALUES (2, 'Some More of God\'s Greatest Mistakes', 'Oolon Colluphid', '17.99');
    INSERT INTO books VALUES (3, 'Who Is This God Person Anyway?', 'Oolon Colluphid', '14.99'); 
```

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 7 行的 'TYPE=MyISAM' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:38:38.170

使用`ENGINE`而不是`TYPE`. `TYPE`早已被遗弃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:39:01.353

代替

```
TYPE=MyISAM; 
```

和

```
ENGINE=MyISAM; 
```

现在不是`TYPE`了。请改用名称`ENGINE`：

```
TYPE keyword is depreciated (since 5.0) and not supported in MySQL5.5 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:39:22.103

您应该使用`ENGINE`而不是`TYPE`. [http://dev.mysql.com/doc/refman/5.1/en/create-table.html](http://dev.mysql.com/doc/refman/5.1/en/create-table.html)

# asp.net-mvc - 在 Web 层之外获取当前的 Principal

> ID：11543908
> 
> 赞同：8
> 
> 时间：2012-07-18T14:37:24.880
> 
> 标签：asp.net-mvc, asp.net-mvc-3, authentication, forms-authentication, iprincipal

我有以下 ntier 应用程序：MVC > 服务 > 存储库 > 域。我正在使用表单身份验证。在我的 MVC 层之外使用 Thread.CurrentPrincipal 来获取我的应用程序的当前登录用户是否安全，或者我应该使用 HttpContext.Current.User 吗？

我问的原因是 Thread.CurrentPrincipal 似乎存在一些问题，但我谨慎地在 MVC 层之外添加对 System.Web 的引用，以防我将来需要提供非 Web 字体端。

**更新**

到目前为止，我一直在遵循收到的建议，将用户名作为被调用方法的参数的一部分传递到服务中，这导致了对我最初问题的改进。我需要能够检查用户是否在我的许多服务和域方法中处于特定角色。似乎有几个解决方案，只是想知道哪个是最好的方法：

1.  将整个 HttpContext.Current.User 作为参数传递，而不仅仅是用户名。
2.  在我的网络层之外调用 Thread.CurrentPrincipal 并使用它。但是如何确保它等于 HttpContext.Current.User？
3.  坚持按照目前的建议传递用户名，然后使用 Roles.IsUserInRole。这种方法的问题是它需要一个对 System.Web 的引用，我觉得这在我的 MVC 层之外是不正确的。

你会建议我如何进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:39:36.463

我也不会这样做，`HttpContext.Current.User`特定于您的 Web 层。

为什么不将用户名注入您的服务层？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:39:58.403

您应该抽象您的用户信息，使其不依赖于`Thread.CurrentPrincipal`or `HttpContext.Current.User`。

例如，您可以添加接受用户名的构造函数或方法参数。

这是构造函数参数的过度简化示例：

```
class YourBusinessClass 
{
   string _userName;
   public YourBusinessClass(string userName)
   {
      _userName = userName;
   }

   public void SomeBusinessMethodThatNeedsUserName()
   {
      if (_userName == "sally")
      {
         // do something for sally
      }
   }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-18T14:41:42.973

将相关的用户详细信息映射到新`Class`的以表示 LoggedInUser 并将其作为参数传递给您的业务层方法

```
 public class LoggedInUser
 {
   public string UserName { set;get;}
   //other relevant proerties
 } 
```

现在设置它的值并传递给你的 BL 方法

```
var usr=new LoggedInUser();
usr.UserName="test value ";  //Read from the FormsAuthentication stuff and Set
var result=YourBusinessLayerClass.SomeOperation(usr); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-29T04:55:34.463

我更喜欢选项 2（在 Web 层之外使用 Thread.CurrentPrincipal ）。因为这不会影响您的服务层和数据层方法。附带奖金：您可以将您的角色 + 附加信息存储在自定义主体中；

确保您的服务和数据层中的 Thread.CurrentPrincipal 与您的 Web 层相同；您可以在 Global.asax(Application_AuthenticateRequest) 中设置您的 HttpContext.Current.User (Context.User)。您可以设置的其他替代位置添加在底部。

示例代码：

```
 //sample synchronizing HttpContext.Current.User with Thread.CurrentPrincipal
    protected void Application_AuthenticateRequest(Object sender, EventArgs e)
    {
        HttpCookie authCookie = Request.Cookies[FormsAuthentication.FormsCookieName];

        //make sure principal is not set for anonymous user/unauthenticated request
        if (authCookie != null && Request.IsAuthenticated)
        {
            FormsAuthenticationTicket authTicket = FormsAuthentication.Decrypt(authCookie.Value);

            //your additional info stored in cookies: multiple roles, privileges, etc
            string userData = authTicket.UserData;

            CustomPrincipal userPrincipal = PrincipalHelper.CreatePrincipal(authTicket.Name, authTicket.UserData, Request.IsAuthenticated);

            Context.User = userPrincipal;
        }
    } 
```

当然，首先您必须实现您的登录表单以创建包含您的自定义主体的授权 cookie。

Application_AuthenticateRequest 将对服务器的任何请求（css 文件、javascript 文件、图像文件等）执行。要将此功能仅限于控制器操作，您可以尝试在 ActionFilter 中设置自定义主体（我没有尝试过）。我尝试的是在控制器的拦截器中设置此功能（我使用 Castle Windsor 进行依赖注入和面向方面的编程）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-07T06:07:09.593

我相信您遇到了这个问题，因为您需要进一步限制您的域责任。您的服务或文件不应该负责处理授权。该责任应由您的 MVC 层处理，因为当前用户登录到您的 Web 应用程序，而不是您的域。

如果不是尝试从您的服务或文档中查找当前用户，而是在您的 MVC 应用程序中执行检查，您会得到如下内容：

```
if(Roles.IsUserInRole("DocumentEditorRole")){

    //UpdateDocument does NOT authorize the user. It does only 1 thing, update the document.
    myDocumentService.UpdateDocument(currentUsername, documentToEdit);

} else {

    lblPermissionDenied.InnerText = @"You do not have permission 
                                      to edit this document.";

} 
```

它干净，易于阅读，并允许您使您的服务和域类免于授权问题。您仍然可以映射`Roles.IsUserInRole("DocumentEditorRole")`到您的视图模型，因此您唯一丢失的是 Document 类上的 CurrentUserCanEdit 方法。但是，如果您认为您的域模型代表真实世界的对象，那么该方法无论如何都不属于 Document。您可能会将其视为域 User 对象 ( ) 上的一种方法`user.CanEditDocument(doc)`，但总而言之，我认为如果您将授权排除在域层之外，您会更开心。

# android - Dropbox API Android

> ID：11543913
> 
> 赞同：0
> 
> 时间：2012-07-18T14:37:39.707
> 
> 标签：android, dropbox, dropbox-api, dropbox-entry

这个问题主要与Android有关，但它更笼统一些。

我可以使用此类 API 调用上传和下载文件`getFile`，但是，我正在尝试访问 Dropbox 上已经存在的目录并列出它的内容。

使用 API，我希望能够引用路径 '/path/to/dir/' 处的目录，并`Entry`使用`Entry.contents`.

我已经尝试过了，但它不起作用：

```
Entry dir = new Entry();
dir.path = "/path/to/dir";
Log.d(TAG, "isDir ? " + Boolean.toString(dir.isDir));
for (Entry entry : dir.contents) {
    Log.d(TAG, entry.filename());
} 
```

目录不为空。`isDir`返回`false`并且不打印文件名。

有没有办法做到这一点，还是我需要使用搜索方法？

我想要的只是现有目录中的文件列表。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T21:06:08.260

这可以通过元数据函数来完成：

```
String path2Dir = "path/to/dir";
Entry dir = mDropboxApiInstance.metadata(path2Dir, null, true, null);
List<Entry> contents = dir.contents;
for (Entry dropboxFile : contents){
  // do stuff with remote file's data
} 
```

# security - 为什么 Twitter 有 /1 他们的 API URL？

> ID：11543914
> 
> 赞同：1
> 
> 时间：2012-07-18T14:37:48.233
> 
> 标签：security, twitter

谁能解释为什么 Twitter 在他们的 API URL 中有一个 /1/ “根目录”？

例如

```
https://api.twitter.com/1/statuses 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:39:56.823

相当确定它的 API 版本，以允许多个版本从相同的端点同时运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:39:55.833

是版本号。当他们进行大修时，他们可以简单地投入其中`/2/`而不会破坏兼容性。

# android - java.lang.nullpointerexception 错误：应用程序崩溃

> ID：11543917
> 
> 赞同：2
> 
> 时间：2012-07-18T14:37:55.473
> 
> 标签：android, eclipse, nullpointerexception

在我按下激活我的单选按钮所在的 xml 的按钮后，我的应用程序崩溃了。

logcat 说我的错误是 java.lang.nullpointerexception。

我已经包含了我的 logcat、发生错误的 java 和清单。

我最初遇到了问题`RadioButtons`，该程序允许我同时检查它们并且无法取消选中它们。当我更改编码以包含`onCheckChange`侦听器时，应用程序现在在我按下时崩溃`RadioButton`。

```
07-17 18:09:37.067: W/dalvikvm(329): threadid=1: thread exiting with uncaught exception (group=0x40015560)
07-17 18:09:37.077: E/AndroidRuntime(329): FATAL EXCEPTION: main
07-17 18:09:37.077: E/AndroidRuntime(329): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.com.proto1/com.example.com.proto1.Voiceprompt}: java.lang.ClassNotFoundException: com.example.com.proto1.Voiceprompt in loader dalvik.system.PathClassLoader[/data/app/com.example.com.proto1-2.apk]
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.os.Looper.loop(Looper.java:123)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread.main(ActivityThread.java:3683)
07-17 18:09:37.077: E/AndroidRuntime(329):  at java.lang.reflect.Method.invokeNative(Native Method)
07-17 18:09:37.077: E/AndroidRuntime(329):  at java.lang.reflect.Method.invoke(Method.java:507)
07-17 18:09:37.077: E/AndroidRuntime(329):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
07-17 18:09:37.077: E/AndroidRuntime(329):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
07-17 18:09:37.077: E/AndroidRuntime(329):  at dalvik.system.NativeStart.main(Native Method)
07-17 18:09:37.077: E/AndroidRuntime(329): Caused by: java.lang.ClassNotFoundException: com.example.com.proto1.Voiceprompt in loader dalvik.system.PathClassLoader[/data/app/com.example.com.proto1-2.apk]
07-17 18:09:37.077: E/AndroidRuntime(329):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
07-17 18:09:37.077: E/AndroidRuntime(329):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
07-17 18:09:37.077: E/AndroidRuntime(329):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561)
07-17 18:09:37.077: E/AndroidRuntime(329):  ... 11 more

    package com.example.com.proto1;

import android.app.Activity;
import android.content.Intent;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.View;
import android.widget.RadioButton;
import android.widget.RadioGroup;
import android.widget.RadioGroup.OnCheckedChangeListener;

public class VoicePrompts extends Activity implements OnCheckedChangeListener {

    RadioButton on, off, onc, offc;

    // Button Sound
    MediaPlayer buttonSound1 = MediaPlayer.create(VoicePrompts.this, R.raw.vpo);
    MediaPlayer buttonSound2 = MediaPlayer
            .create(VoicePrompts.this, R.raw.vpof);
    MediaPlayer buttonSound3 = MediaPlayer
            .create(VoicePrompts.this, R.raw.vpoc);
    MediaPlayer buttonSound4 = MediaPlayer.create(VoicePrompts.this,
            R.raw.vpofc);

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.voiceprompts);

        // Setting up the button references
        on = (RadioButton) findViewById(R.id.vbutton1);
        off = (RadioButton) findViewById(R.id.vbutton2);
        onc = (RadioButton) findViewById(R.id.vbutton1);
        offc = (RadioButton) findViewById(R.id.vbutton2);

        buttonSound1 = MediaPlayer.create(VoicePrompts.this, R.raw.vpo);
        buttonSound2 = MediaPlayer.create(VoicePrompts.this, R.raw.vpof);
        buttonSound3 = MediaPlayer.create(VoicePrompts.this, R.raw.vpoc);
        buttonSound4 = MediaPlayer.create(VoicePrompts.this, R.raw.vpofc);
    }

    public void onCheckedChanged(RadioGroup arg0, int checkedId) {
        // TODO Auto-generated method stub
        switch (checkedId) {
        case R.id.vbutton1:
            on.setOnLongClickListener(new View.OnLongClickListener() {

                public boolean onLongClick(View v) {
                    // TODO Auto-generated method stub
                    try {
                        buttonSound1.prepare();
                        buttonSound1.start();
                        startActivity(new Intent("android.intent.action.VPON"));

                    } catch (Exception e) {

                    }
                    return false;
                }
            });

            onc.setOnClickListener(new View.OnClickListener() {

                public void onClick(View v) {
                    // TODO Auto-generated method stub
                    try {
                        buttonSound3.prepare();
                        buttonSound3.start();
                        startActivity(new Intent("android.intent.action.VPON"));
                    } catch (Exception e) {

                    }
                    ;

                }
            });

            break;
        case R.id.vbutton2:

            off.setOnLongClickListener(new View.OnLongClickListener() {

                public boolean onLongClick(View v) {
                    // TODO Auto-generated method stub
                    try {
                        buttonSound2.prepare();
                        buttonSound2.start();
                        startActivity(new Intent("android.intent.action.VPOFF"));
                    } catch (Exception e) {

                    }
                    ;
                    return false;

                }
            });

            offc.setOnClickListener(new View.OnClickListener() {

                public void onClick(View v) {
                    // TODO Auto-generated method stub
                    try {
                        buttonSound4.prepare();
                        buttonSound4.start();
                        startActivity(new Intent("android.intent.action.VPOFF"));
                    } catch (Exception e) {

                    }
                    ;

                }
            });

            break;
        }

    }

}

<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.com.proto1"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".mainj"
            android:label="@string/title_activity_mainj" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".menu"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MENU" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".Infoactive"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.INFOSCREEN" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".VoicePrompts"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.VOICEPROMPTS" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".VPon"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.VPON" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".VPoff"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.VPOFF" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
    </application>

</manifest>

package com.example.com.proto1;

import android.app.Activity;
import android.content.Intent;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class menu extends Activity {

    @Override
    protected void onCreate(Bundle aboutmenu) {
        // TODO Auto-generated method stub
        super.onCreate(aboutmenu);
        setContentView(R.layout.mainx);

        // Button Sound
        final MediaPlayer buttonSound = MediaPlayer.create(menu.this,
                R.raw.button_click);

        // Setting up the button references
        Button info = (Button) findViewById(R.id.aboutbutton);
        Button voice = (Button) findViewById(R.id.voicebutton);

        info.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                buttonSound.start();
                startActivity(new Intent("android.intent.action.INFOSCREEN"));

            }
        });

        voice.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                buttonSound.start();
                Intent voiceIntent = new Intent("android.intent.action.VOICEPROMPTS");
                startActivity(voiceIntent);
            }
        });

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:39:45.307

之后给按钮参考`setContentView(R.layout.voiceprompts);`

**像，**

```
 @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.voiceprompts);

         // Setting up the button references

            on = (RadioButton) findViewById(R.id.vbutton1);
            off = (RadioButton) findViewById(R.id.vbutton2);
            onc = (RadioButton) findViewById(R.id.vbutton1);
            offc = (RadioButton) findViewById(R.id.vbutton2);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:50:13.457

我认为您有两个名称为 Activity`VoicePrompts`和`VoicePrompt`. 您`VoicePrompts`在清单文件中声明。但是你在打电话`VoicePrompt`。

编辑根据你的新问题

MediaPlayer buttonSound1,buttonSound2,buttonSound3,buttonSound4 ;

并初始化`onCreate`

像

```
 @Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.voiceprompts);

    // Setting up the button references
    on = (RadioButton) findViewById(R.id.vbutton1);
    off = (RadioButton) findViewById(R.id.vbutton2);
    onc = (RadioButton) findViewById(R.id.vbutton1);
    offc = (RadioButton) findViewById(R.id.vbutton2);
    buttonSound1 = MediaPlayer.create(VoicePrompts.this,
        R.raw.vpo);
    buttonSound2 = MediaPlayer.create(VoicePrompts.this,
        R.raw.vpof);
    buttonSound3 = MediaPlayer.create(VoicePrompts.this,
        R.raw.vpoc);
    buttonSound4 = MediaPlayer.create(VoicePrompts.this,
        R.raw.vpofc);
} 
```

# iphone - 两个具有相同锚点的 UIView

> ID：11543919
> 
> 赞同：0
> 
> 时间：2012-07-18T14:38:00.713
> 
> 标签：iphone, ios, uiview, calayer

我一直在尝试下面的代码，将两个 UIView 与 anchorPoint (1,0) 相交。

```
UIView *v=[[UIView alloc] initWithFrame:CGRectMake(50,50, 100, 100)];
v.backgroundColor=[UIColor redColor];
v.layer.anchorPoint=CGPointMake(1,0);

UIView *v2=[[UIView alloc] initWithFrame:CGRectMake(50,50,200,300)];
v2.backgroundColor=[UIColor greenColor];
v2.layer.anchorPoint=CGPointMake(1, 0);

[self.view addSubview:v2];
[self.view addSubview:v]; 
```

我使用此代码的输出如下所示。

![将两个视图与锚点相交](../Images/f21d595266bc3ba6d904e0609665eb5b.png)

我看起来像红色视图这样的输出与绿色视图重叠，并且它们都具有相同的锚点，如下所示。

![在此处输入图像描述](../Images/8c8fc15b22c99ce94b70e738ea64f673.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T15:18:54.877

请[在此处](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/Layers.html#//apple_ref/doc/uid/TP40006082)`anchorPoint`查看有关坐标系和坐标系的原始文档

**图 2** 三个 anchorPoint 值：![三个锚点值](../Images/5a72073b5894ff39cebedae957a1fae6.png)

**更新＃1：**

（此图显示了 OSX 的坐标系！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T15:43:31.633

它可能有助于描述您的示例中发生的事情：

您将两个矩形放在屏幕上的确切大小，在一个确切的位置`(50, 50)`（相对于它们在左上角的原点）它们都有锚点，默认情况下它们都在它们的中心。想象一下在这些中心点放置一个大头针。现在你说你实际上想要右上角的别针而不是中心。

两种情况之一将发生，要么

1) 矩形将保持静止，引脚将自行移动到右上角`red:(150, 50)` `green:(250, 50)`，这不是您想要的。

或者

2）引脚将保持静止，矩形将自行移动，直到它们的右上角是引脚所在的位置`red pin:(100, 100)` `green pin:(150, 200)`，这也不是您想要的！

第二种选择是实际发生的情况。

根据文档，`layer.position`是相对于 的`layer.anchorPoint`，因此您应该尝试将 设置`anchorPoint`为右上角，然后将`position`两个矩形图层的 设置为您想要的确切位置。例如

```
UIView *v=[[UIView alloc] initWithFrame:CGRectMake(50,50, 100, 100)];
v.backgroundColor=[UIColor redColor];
v.layer.anchorPoint=CGPointMake(1,0);
v.layer.position = CGPointMake(200, 50);

UIView *v2=[[UIView alloc] initWithFrame:CGRectMake(50,50,200,300)];
v2.backgroundColor=[UIColor greenColor];
v2.layer.anchorPoint=CGPointMake(1, 0);
v2.layer.position = CGPointMake(200, 50);

[self.view addSubview:v2];
[self.view addSubview:v]; 
```

**只是为了好玩**：这是一个动画，展示了矩形如何从它们的初始位置`initWithFrame`到它们的最终位置，相对于它们中心的锚点。

```
UIView *v=[[UIView alloc] initWithFrame:CGRectMake(50,50, 100, 100)];
v.backgroundColor=[UIColor redColor];

UIView *v2=[[UIView alloc] initWithFrame:CGRectMake(50,50,200,300)];
v2.backgroundColor=[UIColor greenColor];

[self.view addSubview:v2];
[self.view addSubview:v];   

UIView *ap=[[UIView alloc] initWithFrame:CGRectMake(0,0, 10, 10)];
ap.backgroundColor=[UIColor blackColor];
ap.center = v.layer.position;

UIView *ap2=[[UIView alloc] initWithFrame:CGRectMake(0,0, 10, 10)];
ap2.backgroundColor=[UIColor blackColor];
ap2.center = v2.layer.position;

[self.view addSubview:ap]; 
[self.view addSubview:ap2];   

CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"anchorPoint"];
animation.duration = 2.0;
animation.toValue = [NSValue valueWithCGPoint:CGPointMake(1,0)];
animation.autoreverses = YES;
animation.repeatCount = 10;
[v.layer addAnimation:animation forKey:@"anchorPoint"];
[v2.layer addAnimation:animation forKey:@"anchorPoint"]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:45:48.533

你的意思是，你想让红色视图成为绿色视图和原始红色视图之间重叠区域的大小？

如果是这样，

```
v.frame = CGRectIntersection(v.frame, v2.frame); 
```

# hadoop - 强制 HDFS 将块写入特定主机

> ID：11543921
> 
> 赞同：0
> 
> 时间：2012-07-18T14:38:02.837
> 
> 标签：hadoop, hdfs

我想强制 HDFS 将文件的所有块写入特定主机。这是否可能，如果这是实现它的最简单方法？

为什么？我正在为基于hdfs的集群计算框架编写一个新的实例分配算法。将文件的所有块都放在一台主机上，可以更轻松地将新分配系统（考虑到数据局部性）与旧分配系统进行比较，尤其是在较小的集群上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T22:43:07.387

不，您不能这样做 - 如果该主机出现故障会发生什么？

如果您查看 HDFS 中的特定文件（具有多个块），您会经常看到许多块确实由同一个数据节点托管，但不能保证这一点。

# ios - iOS 应用的图标文件

> ID：11543925
> 
> 赞同：2
> 
> 时间：2012-07-18T14:38:18.093
> 
> 标签：ios, icons

我正在阅读[http://developer.apple.com/library/ios/#qa/qa1686/_index.html](http://developer.apple.com/library/ios/#qa/qa1686/_index.html)，Xcode 如何知道何时显示特定图标。它是基于名称还是分辨率？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:41:57.970

它基于几件事，但主要是文件名。您还需要根据 info.plist 指定什么是什么。

但是，如果分辨率错误，xcode 会抛出警告。

此页面显示所有各种尺寸，但需要针对 iPad 视网膜进行更新：http: [//mrgan.tumblr.com/post/708404794/ios-app-icon-sizes](http://mrgan.tumblr.com/post/708404794/ios-app-icon-sizes)

祝你好运！

# c# - 无法在 MyCombobox 和绑定属性之间绑定

> ID：11543926
> 
> 赞同：0
> 
> 时间：2012-07-18T14:38:20.793
> 
> 标签：c#, wpf, binding

我创建了一个自己的 ComboBoxItem。这里我简化了代码。ComboBoxItem 包含一个 CheckBox。

ComboBoxItem 控件 xaml：

```
<ComboBoxItem x:Class="WpfApplication1.MyCombobox"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Height="50"
             Width="200">
    <!-- ... -->
    <StackPanel>
        <CheckBox IsChecked="{Binding Path=IsCheckboxChecked}" IsEnabled="{Binding Path=IsCheckboxEnabled}">
            <CheckBox.LayoutTransform>
                <ScaleTransform ScaleX="1" ScaleY="1" />
            </CheckBox.LayoutTransform>
        </CheckBox>
        <!-- ... -->
    </StackPanel>
</ComboBoxItem> 
```

ComboBoxItem Control c#（代码隐藏）

```
public partial class MyCombobox
{
    public MyCombobox()
    {
        InitializeComponent();
        DataContext = this;

        //Defaults
        IsCheckboxChecked = false;
        IsCheckboxEnabled = true;

        //...
    }

    //...

    public string Text { get; set; }

    public bool IsCheckboxChecked { get; set; }

    public bool IsCheckboxEnabled { get; set; }

    //...
} 
```

我把它包括在内：

```
<WpfApplication1:MyCombobox IsCheckboxChecked="{Binding Path=IsMyCheckBoxChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsCheckboxEnabled="{Binding Path=IsMyCheckBoxEnabled, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" Text="Write your Text here" /> 
```

当我运行我的应用程序时，我收到此错误：

> 发生致命错误：无法在“MyCombobox”类型的“IsCheckboxChecked”属性上设置“绑定”。只能在 DependencyObject 的 Dependency 属性上设置“绑定”

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:42:25.913

好吧，错误很清楚：您必须为*IsCheckboxChecked*字段创建一个 DP：

```
public static readonly DependencyProperty IsCheckboxCheckedProperty = DependencyProperty.Register("IsCheckboxChecked", typeof(bool), typeof(MyComboBox));
public bool IsCheckboxChecked
{
    get { return (bool)GetValue(IsCheckboxCheckedProperty); }
    set { SetValue(IsCheckboxCheckedProperty, value); }
} 
```

代替：

```
public bool IsCheckboxChecked { get; set; } 
```

但这也意味着你必须让你的 MycomboBox 类继承 DependencyObject 类：

```
public partial class MyCombobox : DependencyObject 
```

我建议这个：http: [//msdn.microsoft.com/en-gb/library/ms752347.aspx](http://msdn.microsoft.com/en-gb/library/ms752347.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:40:54.413

您必须使您的财产“可绑定”。

看看这个： http: [//www.wpftutorial.net/dependencyproperties.html](http://www.wpftutorial.net/dependencyproperties.html)

# ruby-on-rails - Rails3 资产管道：特定于控制器的样式表

> ID：11543930
> 
> 赞同：6
> 
> 时间：2012-07-18T14:38:37.220
> 
> 标签：ruby-on-rails, asset-pipeline

关于资产管道的主题，Rails Guides 建议 Rails 可以通过调用简单地链接到特定于控制器的 CSS 文件：

```
stylesheet_link_tag params[:controller] 
```

Rails 指南的摘录：

> 例如，如果您生成一个 ProjectsController，Rails 还将在 app/assets/javascripts/projects.js.coffee 和 app/assets/stylesheets/projects.css.scss 添加一个新文件。您应该将控制器特有的任何 JavaScript 或 CSS 放入它们各自的资产文件中，因为这些文件可以仅针对这些控制器加载，例如 <%= javascript_include_tag params[:controller] %> 或 <%= stylesheet_link_tag params[ ：控制器] %>。 [http://guides.rubyonrails.org/asset_pipeline.html#how-to-use-the-asset-pipeline](http://guides.rubyonrails.org/asset_pipeline.html#how-to-use-the-asset-pipeline)

这在我们允许 Rails 依赖资产管道的开发中工作得很好。但是，在生产中，我收到一条错误消息，指出样式表未预编译。

根据我的阅读，您必须将要显示为独立文件的任何资产添加到预编译数组中，如下所示：

```
config.assets.precompile += ['admin.js', 'admin.css', 'swfObject.js'] 
```

如果我想要按照上面的 Rails 指南示例链接的特定于控制器的样式表，我是否必须枚举预编译数组中的每个样式表？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T14:53:56.653

简短的回答是……是的。

但是，请记住资产管道也可用于匹配选择器。我为一个简单的 cms 实现了类似的设置，我知道我希望每个控制器都有自己的 .css 和 .js。配置看起来像...

```
config.assets.precompile += ["*.css", "*.js") 
```

如果您分配了与控制器不直接相关的样式表或脚本，则不是最佳解决方案。就我而言，每个控制器都需要非常不同的 .js 文件。

此外，如果您的不同资产可以分为两个或三个相互关联的组，您可以考虑创建多个清单，然后明确列出它们。

**编辑** 我想为任何试图决定如何设置资产预编译的人完善这个答案。

除了显式预编译每个资产或清单之外，您还可以将要预编译的所有文件放入资产文件夹中的文件夹中，并使用相同的通配符匹配来仅编译这些资产。

例如

```
config.assets.precompile += ['*.css', 'manifests/*.js'] 
```

将编译所有 css 工作表，并且只编译 manifests 文件夹中的 .js 文件。

同样，您可以通过 assets.precomile 一个正则表达式。因此，如果您想将“pre_”附加到您想要预编译的任何文件中，您可以使用类似...

```
config.assets.precompile += [/^pre_\w*.(css|js)/i] 
```

可能性是无穷无尽的，只是不要觉得你必须满足于预编译所有资产，这可能是无用的吞食，因为大多数脚本和 css 应该被编写为在多个实例中使用并与其他脚本一起使用，或者抛出所有东西，甚至应用程序中高度专业化的脚本。*。

# operators - Cakephp 1.3 Set::extract 使用 OR XPATH 运算符

> ID：11543936
> 
> 赞同：3
> 
> 时间：2012-07-18T14:38:51.130
> 
> 标签：operators, cakephp-1.3

我想使用 Set::extract 拉回这样的东西。

```
Set::extract('/User[region_id=1 or email_region_id=1]', $users); 
```

我可能可以通过多个查询来做到这一点，但我不确定这是否会更快。考虑到当前的设置，肯定会更容易。

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-14T20:48:47.117

目前这看起来不可能。

# html - 如何使用 CSS/HTML 使背景图像进入“背景”

> ID：11543938
> 
> 赞同：0
> 
> 时间：2012-07-18T14:39:03.493
> 
> 标签：html, css, background

我想用背景图像填充我的页面，并使文本与该背景对齐。使用下面的代码，背景图像加载到页面顶部，文本位于其下方。我知道我可以使用“背景：”功能，但在我下面的代码中完成的方式允许自动调整大小，而不管浏览器大小（即移动设备的浏览器大小）。所以，我只希望背景图像位于文本后面。

```
<html>
<head>

<title>Title</title>    

<style>

img.bg
{
    min-height: 100%;
    min-width; 781;

    width: 100%;
    height: auto;

    top: 0;
    left: 0;

    z-index: -1;
}

@media screen and (max-width: 781)
{
    img.bg
    {
        left: 50%;
        margin-left: -390.5;
    }
}

#container 
{
    position: relative;
    width: 781;
    margin: 50 px auto;
    height: 758;
    border: 1px solid black
}

#left
{   
    position: relative;
    left: 1.280409731113956%;
    top: 14.51187335092348%;
    padding-top: 10px;
    padding-left: 10px;
    padding-right: 10px;
    width: 50%;
    height: 50%;
    color: #FFFFFF;
    position: relative;
}   

p
{
    font: 14px Georgia;
}

</style>

</head> 
```

HTML

```
<img class="bg" src="background.jpg">

<div id="container">

<div id="left">
    <p>
    Text
    </p>
</div>

</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:45:00.900

使您的 BG 图像的 z-index 为 1，而您的 #container div 的 z-index 为 2。这行得通吗？

```
img {
  position: relative;
  z-index: 1;
}

#container {
   position: relative;
   z-index: 2;
   top: 0px;
   left: 0px; /*or whatever top/left values you need*/
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:45:11.217

只需`position: fixed`用于您的背景图片[http://dabblet.com/gist/3136606](http://dabblet.com/gist/3136606)

```
img.bg {
    min-height: 100%;
    min-width: 781px;
    width: 100%;
    top: 0;
    left: 0;
    position: fixed;
    z-index: -1;
} 
```

* * *

* * *

***编辑***（我希望有办法让它比这更明显）

好的，在阅读了原始问题的评论后，我明白这样做的目的是让背景可以很好地适应任何显示尺寸。

不幸的是，很多移动设备都存在问题- 您可以[**在此处**](http://bradfrostweb.com/blog/mobile/fixed-position/)`position: fixed`阅读更多相关信息。[](http://bradfrostweb.com/blog/mobile/fixed-position/)

 **因此*，在这种情况下，最好的解决方案是使用背景图像，而不是 img 标签*，[**`background-size`**](https://developer.mozilla.org/en/CSS/background-size)设置为`100%`（将拉伸图像 -[**示例**](http://dabblet.com/gist/3136688)）或设置为`cover`（将缩放图像以使其完全覆盖屏幕 -[**示例**](http://dabblet.com/gist/3136759))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:46:55.897

好吧，也许你也可以试试那个 css：

```
body{
   background: url(images/bg.jpg) no-repeat center center fixed; 
   -webkit-background-size: cover;
   -moz-background-size: cover;
   -o-background-size: cover;
   background-size: cover;
} 
```

即使页面大小改变，它也应该覆盖你的所有页面**

# iphone - 在 iOS 中进行单元测试时正确的依赖注入

> ID：11543942
> 
> 赞同：1
> 
> 时间：2012-07-18T14:39:25.333
> 
> 标签：iphone, ios, unit-testing, dependency-injection

我终于开始在开发 iOS 应用程序时测试我的代码。但是，我很想知道更多关于其他人如何创建可测试代码的信息，尤其是在将假对象注入到被测类时。到目前为止，这就是我的做法：

// 1) Init CUT with fakes (constructor injection) A *a = [[A alloc] initWithB:C:D:.....];

// 2) 将依赖项暴露为属性（属性注入） aB = myB;

我更喜欢 1) 因为我不喜欢将任何内部数据作为属性公开，除非我真的需要。

我的问题是：在处理 Objective-c 和 iOS 测试框架时，是否有任何替代/更好/更有效的方法来进行属性注入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:31:58.050

现在已经有一段时间了，自从我提出这个问题以来，我有机会使用不同的解决方案。现在，在大多数情况下，我更喜欢组合。如果类 A 依赖于类 B，我将使用 B 的实例初始化 a，如下所示：

```
A* myA = [[A alloc] initWithB:myB]; 
```

除此之外，我会将 B 作为属性公开，以便可以在运行时切换它。在某些情况下，界面模式甚至更可取。

```
- (id)initWithBy:(id<bProtocol>)aB; 
```

这显然不适合所有情况，但我发现这是一种将依赖项注入我的类的好方法，从而使它们更具可测试性。

# jquery - 单击图库中的链接会导致页面“跳转”？

> ID：11543944
> 
> 赞同：0
> 
> 时间：2012-07-18T14:39:26.393
> 
> 标签：jquery, html, css, gallery

请原谅措辞不佳的标题，希望我能在这里解释这个问题。

我在 jQuery 中编写了一个简单的画廊控件，有六个图像和两个按钮控件，允许用户循环浏览整个图像集合。我的这部分工作正常，但是每当我单击按钮以在集合中移动时，页面会自动“跳转/滚动”到页面顶部？我试过给画廊容器一个固定的高度，因为我有一个类似的问题，在此之前我设法解决了这个问题，但这没有帮助：

这是jQuery：

```
var index = 0;
$(function () {
    $('#btnLeft').click(function () {
        if (index != 0) {
            index--;
            $('#sixth').attr('src', $('#fifth').attr('src'));
            $('#fifth').attr('src', $('#fourth').attr('src'));
            $('#fourth').attr('src', $('#third').attr('src'));
            $('#third').attr('src', $('#second').attr('src'));
            $('#second').attr('src', $('#first').attr('src'));
            $('#first').attr('src', '/Content/Images/Gallery/Thumbs/' + parseInt(index + 1) + '.png');
        }
    });

    $('#btnRight').click(function () {
        if (parseInt(6 + index) != 10) {
            index++;
            $('#first').attr('src', $('#second').attr('src'));
            $('#second').attr('src', $('#third').attr('src'));
            $('#third').attr('src', $('#fourth').attr('src'));
            $('#fourth').attr('src', $('#fifth').attr('src'));
            $('#fifth').attr('src', $('#sixth').attr('src'));
            $('#sixth').attr('src', '/Content/Images/Gallery/Thumbs/' + parseInt(6 + index) + '.png');
        }
    });
}); 
```

这是标记：

```
<div id="gallerySlider" style="height: 160px;">
    <img id="first" src="/Content/Images/Gallery/Thumbs/1.png" alt="Image" width="160" height="160" style="float:left;" /> 
    <img id="second" src="/Content/Images/Gallery/Thumbs/2.png" alt="Image" width="160" height="160" style="float:left;" />
    <img id="third" src="/Content/Images/Gallery/Thumbs/3.png" alt="Image" width="160" height="160" style="float:left;" />
    <img id="fourth" src="/Content/Images/Gallery/Thumbs/4.png" alt="Image" width="160" height="160" style="float:left;" />
    <img id="fifth" src="/Content/Images/Gallery/Thumbs/5.png" alt="Image" width="160" height="160" style="float:left;" />
    <img id="sixth" src="/Content/Images/Gallery/Thumbs/6.png" alt="Image" width="160" height="160" style="float:left;" />

    <a id="btnLeft" style="position:relative; float:left; bottom:105px;" href="#"><img src="/Content/Images/Design/leftbutton.png" alt="Left Button" /></a>
    <a id="btnRight" href="#" style="position:relative; float:right; bottom:105px;"><img src="/Content/Images/Design/rightbutton.png" alt="Right Button" /></a>
</div> 
```

任何人都可以提供建议吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:40:39.973

使用[`.preventDefault()`](http://api.jquery.com/event.preventDefault/)如下方式停止浏览器默认加载和跳转：

```
$('#btnLeft').click(function (e) {

        e.preventDefault();

        if (index != 0) {
            index--;
            $('#sixth').attr('src', $('#fifth').attr('src'));
            $('#fifth').attr('src', $('#fourth').attr('src'));
            $('#fourth').attr('src', $('#third').attr('src'));
            $('#third').attr('src', $('#second').attr('src'));
            $('#second').attr('src', $('#first').attr('src'));
            $('#first').attr('src', '/Content/Images/Gallery/Thumbs/' + parseInt(index + 1) + '.png');
        }
    });

    $('#btnRight').click(function (e) {

        e.preventDefault();

        if (parseInt(6 + index) != 10) {
            index++;
            $('#first').attr('src', $('#second').attr('src'));
            $('#second').attr('src', $('#third').attr('src'));
            $('#third').attr('src', $('#fourth').attr('src'));
            $('#fourth').attr('src', $('#fifth').attr('src'));
            $('#fifth').attr('src', $('#sixth').attr('src'));
            $('#sixth').attr('src', '/Content/Images/Gallery/Thumbs/' + parseInt(6 + index) + '.png');
        }
    }); 
```

# asp.net-mvc - Razor 在服务器和本地的行为不同

> ID：11543949
> 
> 赞同：1
> 
> 时间：2012-07-18T14:39:39.077
> 
> 标签：asp.net-mvc, razor

我对 MVC Razor @ 转义有一个奇怪的问题。

在我看来，在某些 javascript 中，我有这样的一行。目的是查看 e 是否是包含 a 的电子邮件地址。之前 @：

```
if (e.indexOf(".") < e.indexOf("@@")) { //Assume use firstname.lastname@... } 
```

在本地测试时，它正确呈现为：

```
if (e.indexOf(".") < e.indexOf("@")) { //Assume use firstname.lastname@... } 
```

但是在服务器上它呈现为：

```
if (e.indexOf(".") < e.indexOf("@@")) { //Assume use firstname.lastname@... } 
```

这当然意味着它不起作用。

我通过 SVN 部署到服务器，所以除了 web.config 之外所有文件都是相同的。

这可能是什么原因造成的？我正在使用 MVC 4.0。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T16:43:20.610

如果您改用 @ 混淆，则可以回避`\x40`。

```
if (e.indexOf(".") < e.indexOf("\x40")) { ... } 
```

# mysql - MYSQL无法启动服务

> ID：11543952
> 
> 赞同：2
> 
> 时间：2012-07-18T14:39:46.783
> 
> 标签：mysql

我刚刚下载了 MySQL 5.0.9 源代码并以 root 用户身份构建和安装：

```
./configure
./make
./make install 
```

现在我试图调出 mysqld 但错误说：

```
[root libexec]# ./mysqld
120718  7:37:09 [ERROR] Fatal error: Can't change to run as user 'mysql' ;  Please check that the user exists!

120718  7:37:09 [ERROR] Aborting

120718  7:37:09 [Note] ./mysqld: Shutdown complete

[root libexec]# 
```

请注意，我以 root 用户身份完成了所有活动，并尝试自己第一次启动服务？

我做了下面***user868766***所述的操作，但无法成功执行最后一个命令。但是现在我在尝试直接调用它时得到了其他东西：

顺便说一句，我们如何设置 MySQL root 密码？

```
[root libexec]# ./mysqld
InnoDB: The first specified data file ./ibdata1 did not exist:
InnoDB: a new database to be created!
120718  7:52:35  InnoDB: Setting file ./ibdata1 size to 10 MB
InnoDB: Database physically writes the file full: wait...
120718  7:52:35  InnoDB: Log file ./ib_logfile0 did not exist: new to be created
InnoDB: Setting log file ./ib_logfile0 size to 5 MB
InnoDB: Database physically writes the file full: wait...
120718  7:52:35  InnoDB: Log file ./ib_logfile1 did not exist: new to be created
InnoDB: Setting log file ./ib_logfile1 size to 5 MB
InnoDB: Database physically writes the file full: wait...
InnoDB: Doublewrite buffer not found: creating new
InnoDB: Doublewrite buffer created
InnoDB: Creating foreign key constraint system tables
InnoDB: Foreign key constraint system tables created
120718  7:52:35  InnoDB: Started; log sequence number 0 0
120718  7:52:35 [ERROR] Fatal error: Can't open and lock privilege tables: Table 'mysql.host' doesn't exist 
```

**我只是按照user868766**提供的链接中的信息运行：

```
[root bin]# mysql_install_db 
```

注意使用除此之外的命令会产生问题：

```
[root bin]# mysql_install_db -user=mysql -ldata=/opt/mysql/mysql/data
Installing MySQL system tables...
120718  8:35:00 [Warning] Ignoring user change to 'ser=mysql' because the user was set to 'mysql' earlier on the command line

120718  8:35:00 [Warning] Ignoring user change to 'ser=mysql' because the user was set to 'mysql' earlier on the command line

/usr/local/libexec/mysqld: File 'data=/opt/mysql/mysql/data' not found (Errcode: 2)
120718  8:35:00 [ERROR] Could not use data=/opt/mysql/mysql/data for logging (error 2). Turning logging off for the whole duration of the MySQL server process. To turn it on again: fix the cause, shutdown the MySQL server and restart it.
OK
Filling help tables...
120718  8:35:00 [Warning] Ignoring user change to 'ser=mysql' because the user was set to 'mysql' earlier on the command line

120718  8:35:00 [Warning] Ignoring user change to 'ser=mysql' because the user was set to 'mysql' earlier on the command line

/usr/local/libexec/mysqld: File 'data=/opt/mysql/mysql/data' not found (Errcode: 2)
120718  8:35:00 [ERROR] Could not use data=/opt/mysql/mysql/data for logging (error 2). Turning logging off for the whole duration of the MySQL server process. To turn it on again: fix the cause, shutdown the MySQL server and restart it.
OK

To start mysqld at boot time you have to copy
support-files/mysql.server to the right place for your system

PLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !
To do so, start the server, then issue the following commands:
/usr/local/bin/mysqladmin -u root password 'new-password'
/usr/local/bin/mysqladmin -u root -h idc-bldtool01 password 'new-password'

Alternatively you can run:
/usr/local/bin/mysql_secure_installation

which will also give you the option of removing the test
databases and anonymous user created by default.  This is
strongly recommended for production servers.

See the manual for more instructions.

You can start the MySQL daemon with:
cd /usr/local ; /usr/local/bin/mysqld_safe &

You can test the MySQL daemon with mysql-test-run.pl
cd mysql-test ; perl mysql-test-run.pl

Please report any problems with the /usr/local/bin/mysqlbug script!

The latest information about MySQL is available on the web at
http://www.mysql.com
Support MySQL by buying support/licenses at http://shop.mysql.com
[root bin]# ls -l /opt/mysql/mysql/data
total 0 
```

但是，在此之后，我可以启动 mysqld：

```
[root libexec]# ./mysqld
InnoDB: Log scan progressed past the checkpoint lsn 0 36808
120718  8:37:22  InnoDB: Database was not shut down normally!
InnoDB: Starting crash recovery.
InnoDB: Reading tablespace information from the .ibd files...
InnoDB: Restoring possible half-written data pages from the doublewrite
InnoDB: buffer...
InnoDB: Doing recovery: scanned up to log sequence number 0 43655
120718  8:37:22  InnoDB: Starting an apply batch of log records to the database...
InnoDB: Progress in percents: 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99
InnoDB: Apply batch completed
120718  8:37:23  InnoDB: Started; log sequence number 0 43655
120718  8:37:23 [Note] ./mysqld: ready for connections.
Version: '5.0.91'  socket: '/var/lib/mysql/mysql.sock'  port: 3306  Source distribution 
```

现在我正在尝试在上面的控制台转储中设置 root 密码作为提示：

```
[root~]# /usr/local/bin/mysql_secure_installation

NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL
      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!

In order to log into MySQL to secure it, we'll need the current
password for the root user.  If you've just installed MySQL, and
you haven't set the root password yet, the password will be blank,
so you should just press enter here.

Enter current password for root (enter for none):
ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2)
Enter current password for root (enter for none):
Aborting!

Cleaning up... 
```

请让我知道我该如何解决这个问题？

感谢**user868766**，我设法解决并能够启动mysql并连接到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T14:45:56.660

请试试这个：

```
1\. cd /var/lib/mysql

2\. adduser mysql

3\. chown mysql:mysql -R /var/lib/mysql

4\. service mysqld restart 
```

请按给定的顺序执行命令，它应该对您有所帮助。

# mysql - 无法弄清楚 MySQL 语句

> ID：11543957
> 
> 赞同：0
> 
> 时间：2012-07-18T14:39:53.810
> 
> 标签：mysql, sql

我的 SQL 语句看起来像这样

```
SELECT q.content 
FROM questions AS q, user_question_assoc AS uqa 
WHERE uqa.user_id=? AND (q.course_id = uqa.course_id 
OR q.lesson_id=uqa.lesson_id
OR q.question_id=uqa.question_id) 
```

声明的最后一部分不是我需要的

```
WHERE uqa.user_id=? AND (q.course_id = uqa.course_id 
    OR q.lesson_id=uqa.lesson_id
    OR q.question_id=uqa.question_id) 
```

实际上我想从下面找出 1 个也是唯一的 MySQL 语句（我试图用人类语言解释））

如果`uqa.question_id`不是 0（或 NULL），那么

```
WHERE uqa.user_id=? AND (q.course_id = uqa.course_id 
        AND q.lesson_id=uqa.lesson_id
        AND q.question_id=uqa.question_id) 
```

如果`uqa.lesson_id`不是 0（或 NULL）而是`uqa.question_id`0，则

```
WHERE uqa.user_id=? AND (q.course_id = uqa.course_id 
        AND q.lesson_id=uqa.lesson_id) 
```

如果 `uqa.course_id`不是 0（或 NULL）但`uqa.question_id`是`uqa.lesson_id`0 那么

```
WHERE uqa.user_id=? AND q.course_id = uqa.course_id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:51:03.147

首先，您应该使用正确的连接语法来执行此操作：

```
SELECT q.content
FROM questions q join
     user_question_assoc uqa
     on (q.course_id = uqa.course_id OR
         q.lesson_id=uqa.lesson_id OR
         q.question_id=uqa.question_id) 
WHERE uqa.user_id=? 
```

现在试试这个：

```
SELECT q.content
FROM questions q join
     user_question_assoc uqa
     on q.course_id = uqa.course_id AND
        (q.lesson_id=uqa.lesson_id OR coalesce(uqa.lesson_id, 0) = 0) AND
        (q.question_id=uqa.question_id or coalesce(uqa.question_id, 0) = 0) 
WHERE uqa.user_id=? 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:49:12.797

我认为您可以在以下情况下使用案例：

```
WHERE (CASE WHEN xx is not null then xid when yyx is null the yid end) = (CASE WHEN ww is null then someother id else id end) 
```

我不知道 MySQL 中的语法，但这是在 Oracle 或 MS sql 中可以做到的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:49:51.820

`OR`如果您使用该子句，某些数据库（例如 MySQL）将不会使用索引。使用`UNION`大表可能会更好地执行：

```
SELECT
    1 AS id,
    q.content 
FROM 
    questions AS q
INNER JOIN
    user_question_assoc AS uqa ON 
        q.course_id   = uqa.course_id AND
        q.lesson_id   = uqa.lesson_id AND
        q.question_id = uqa.question_id
WHERE 
    uqa.user_id     = ? AND
    uqa.question_id <> 0
UNION
SELECT 
    2 AS id,
    q.content 
FROM 
    questions AS q
INNER JOIN
    user_question_assoc AS uqa ON 
        q.course_id   = uqa.course_id AND
        q.lesson_id   = uqa.lesson_id
WHERE 
    uqa.user_id     = ? AND
    uqa.question_id = 0
UNION
SELECT 
    3 AS id,
    q.content 
FROM 
    questions AS q
INNER JOIN
    user_question_assoc AS uqa ON 
        q.course_id   = uqa.course_id
WHERE 
    uqa.user_id     = ? AND
    uqa.question_id = 0 AND
    uqa.lession_id  = 0 
```

# struts2 - Struts 2.3 升级 OGNL 问题

> ID：11543959
> 
> 赞同：4
> 
> 时间：2012-07-18T14:39:55.300
> 
> 标签：struts2

我有一个最初使用 Struts 2.0 构建的网站。我现在将它升级到 Struts 2.3。该网站包含执行 AJAX 请求的文件（基于通用搜索表单搜索库存）。AJAX 请求将整个表单提交给 searchInventory 操作。这在 Struts 2.0 中运行良好，但在 2.3 中，我在错误日志中得到如下所示的异常：

```
[STDOUT] WARN [com.opensymphony.xwork2.ognl.OgnlValueStack] - CommonsLogger.warn(60) | Error setting expression 'nonInventoryRelatedField' with value '[Ljava.lang.String;@833d35'
ognl.OgnlException: target is null for setProperty(null, "9", [Ljava.lang.String;@833d35)
    at ognl.OgnlRuntime.setProperty(OgnlRuntime.java:2309)
    at ognl.ASTProperty.setValueBody(ASTProperty.java:127)
    at ognl.SimpleNode.evaluateSetValueBody(SimpleNode.java:220)
    at ognl.SimpleNode.setValue(SimpleNode.java:301)
    at ognl.ASTChain.setValueBody(ASTChain.java:227)
    at ognl.SimpleNode.evaluateSetValueBody(SimpleNode.java:220)
    at ognl.SimpleNode.setValue(SimpleNode.java:301)
    at ognl.Ognl.setValue(Ognl.java:737)
    at com.opensymphony.xwork2.ognl.OgnlUtil.setValue(OgnlUtil.java:217)
    at com.opensymphony.xwork2.ognl.OgnlValueStack.trySetValue(OgnlValueStack.java:186)
    at com.opensymphony.xwork2.ognl.OgnlValueStack.setValue(OgnlValueStack.java:173)
    at com.opensymphony.xwork2.ognl.OgnlValueStack.setParameter(OgnlValueStack.java:151)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.setParameters(ParametersInterceptor.java:292)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:203)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:190)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:243)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:100)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:145)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:176)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:171)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:192)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:187)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.LoggingInterceptor.intercept(LoggingInterceptor.java:67)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.TimerInterceptor.intercept(TimerInterceptor.java:120)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:54)
    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:511)
    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:432)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:399)
    at org.springframework.security.intercept.web.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
    at org.springframework.security.intercept.web.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411)
    at org.springframework.security.ui.SessionFixationProtectionFilter.doFilterHttp(SessionFixationProtectionFilter.java:67)
    at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
    at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411)
    at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
    at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411)
    at org.springframework.security.ui.ExceptionTranslationFilter.doFilterHttp(ExceptionTranslationFilter.java:101)
    at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
    at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411)
    at org.springframework.security.wrapper.SecurityContextHolderAwareRequestFilter.doFilterHttp(SecurityContextHolderAwareRequestFilter.java:91)
    at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
    at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411)
    at org.springframework.security.ui.AbstractProcessingFilter.doFilterHttp(AbstractProcessingFilter.java:278)
    at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
    at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411)
    at org.springframework.security.ui.logout.LogoutFilter.doFilterHttp(LogoutFilter.java:89)
    at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
    at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411)
    at org.springframework.security.context.HttpSessionContextIntegrationFilter.doFilterHttp(HttpSessionContextIntegrationFilter.java:235)
    at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
    at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:411)
    at org.springframework.security.util.FilterChainProxy.doFilter(FilterChainProxy.java:188)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:236)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:230)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:182)
    at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:84)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:157)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:262)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:446)
    at java.lang.Thread.run(Thread.java:662) 
```

问题是包含库存搜索的页面有几个与库存搜索无关的其他字段（并且在inventorySearch 操作中没有getter/setter）。在 Struts 2.0 中，inventorySearch 操作会忽略这些额外的字段。但是，当这些额外的字段与表单一起发布时，Struts 2.3 会引发上述异常。有没有人对如何最好地解决这个问题有任何好主意？

我已经想到了以下选项：

1.  查找包含库存搜索的所有页面以及每个页面中的所有额外字段。然后获取所有这些额外的字段，并在库存搜索操作中为它们添加一个 getter/setter。
2.  尝试重新设计库存搜索 AJAX 以不提交表单，而是使用 DOM 操作来检索所有与库存相关的字段并省略其他字段。
3.  更改我的日志记录设置以抑制 OgnlExceptions。

是否有任何其他好的想法或论据支持/反对上述选择？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T02:36:33.123

我们在这里也有同样的事情。这是一个例外，但日志记录级别设置为警告。

当系统实际上想要警告您时，有那么长的异常是有点烦人的。

Struts 2.3.x 想要的是提高对事物的更多认识。

您可以选择将日志记录级别提高到 ERROR，这样警告就不会总是出现并且会使您的生产日志文件膨胀。至少那是我们所做的。

例如，如果您使用 log4j.xml，您可以添加以下内容：

```
<logger name="com.opensymphony.xwork2.ognl.OgnlValueStack" additivity="false">
    <level value="ERROR" />
<appender-ref ref="LOGFILE" />
</logger> 
```

稍后在您的开发环境中，您仍然可以启用该日志记录并逐步将您的操作类中缺少的属性与您的 OGNL 值堆栈使用情况相匹配。

# java - 如何锁定文件

> ID：11543967
> 
> 赞同：4
> 
> 时间：2012-07-18T14:40:03.350
> 
> 标签：java, multithreading, file, file-io, locking

我有一种`write`方法可以安全地将数据写入文件。

```
// The current file I am writing to.
FileOutputStream file = null;
...
// Synchronized version.
private void write(byte[] bytes) {
  if (file != null && file.getChannel() != null) {
    try {
      boolean written = false;
      do {
        try {
          // Lock it!
          FileLock lock = file.getChannel().lock();
          try {
            // Write the bytes.
            file.write(bytes);
            written = true;
          } finally {
            // Release the lock.
            lock.release();
          }

        } catch (OverlappingFileLockException ofle) {
          try {
            // Wait a bit
            Thread.sleep(0);
          } catch (InterruptedException ex) {
            throw new InterruptedIOException("Interrupted waiting for a file lock.");
          }
        }
      } while (!written);
    } catch (IOException ex) {
      log.warn("Failed to lock " + fileName, ex);
    }
  } else {
    log.warn("Failing - " + (file == null ? "file" : "channel") + " is null!!");
  }
} 
```

它对我来说已经有一段时间了，虽然我知道它有一些皱纹。

我最近更改了一个项目，该项目使用此代码在 Java 5（来自 Java 6）下构建和运行，现在它看起来像死锁等待文件锁定。它是一个多线程应用程序，多个线程很有可能尝试写入同一个文件。

调试器告诉我挂起的线程正在等待`FileLock lock = file.getChannel().lock()`调用返回。

一些研究提出了这个有趣的小[金块](http://docs.oracle.com/javase/1.5.0/docs/api/java/nio/channels/FileChannel.html#lock%28long,%20long,%20boolean%29)，其中提到：

> 文件锁代表整个 Java 虚拟机持有。**它们不适用于控制同一虚拟机内的多个线程对文件的访问。**

那我做错了吗？如果是这样，正确的方法是什么？如果我做得对，我怎么会陷入僵局？

**补充：**忘了提 - 每个线程都有自己的这个对象的副本，所以代码中不应该有任何同步问题。我觉得依靠这种`FileChannel.lock()`方法来确保写入不会交错是安全的。

**也补充说：**我确实使用各种`synchronized`机制解决了这个问题。但是，我确实有一些悬而未决的问题：

1.  为什么`FileLock lock = file.getChannel().lock();` **不适合...**？
2.  为什么我的问题只在切换回 Java-5 时才出现，而 Java-6 一切正常？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T15:20:48.347

`FileLock`仅用于进程间锁定，[javadoc](http://docs.oracle.com/javase/1.4.2/docs/api/java/nio/channels/FileLock.html)读取：

> “文件锁代表整个 Java 虚拟机持有。 **它们不适用于控制同一虚拟机内的多个线程对文件的访问**。”

要在 java 线程（相同的 JVM）之间锁定，您需要使用一些共享锁。我建议在文件写入类中使用同步块（[根据](http://my.safaribooksonline.com/book/programming/java/0321349601/explicit-locks/ch13lev1sec4)[这些](https://blogs.oracle.com/dave/entry/java_util_concurrent_reentrantlock_vs) [文章](http://codeidol.com/java/java-concurrency/Explicit-Locks/Choosing-Between-Synchronized-and-ReentrantLock/)，它可能表现最好）：

```
final Object lock = new Object();

public void write(...){
  synchronized(lock){
    // do writing
  }
} 
```

另一种方法是使用[ReentrantLock](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantLock.html)然后使用经过验证的习语

```
final ReentrantLock lock = new ReentrantLock();

public void write(...){
  try {
    lock.lock()
    // do the writing
  } finally {
    // forget this and you're screwed
    lock.unlock();
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:44:11.070

您可能需要使用文件而不是哈希图在实际代码上实现临界区概念。您可以创建一个同步块或将文件访问代码分离到一个单独的过程中并使该方法同步。

本质上，一次只有一个线程执行同步块。它为您提供所需的独家访问权限。

另一种方法是使用串行线程执行器，具体取决于您的功能要求。

你可能想看看这个线程： [Howto synchronize file access in a shared folder using Java (OR: ReadWriteLock on network level)](https://stackoverflow.com/questions/320159/howto-synchronize-file-access-in-a-shared-folder-using-java-or-readwritelock-o)

# c# - 在 C# 中使用 Properties.Settings 作为数据源（特别是用于 DataGridViewComboBoxColumn）

> ID：11543969
> 
> 赞同：1
> 
> 时间：2012-07-18T14:40:04.733
> 
> 标签：c#, visual-studio, datagridview, datasource, properties.settings

我编写了一个包含 DataGridView 的 GUI 应用程序，用户可以在其中`Arrow`通过在视图中创建新行并填写新`Arrow`的属性来添加类的新实例。其中一个属性被调用`transferType`并且是一个字符串。

我允许用户`transferType`在设置表单中设置有效 s 的列表。我`Properties.Settings`用来保存设置，使用 Visual Studio 中内置的修道院工具来创建和管理应用程序设置。

我没有让用户`transferType`手动输入该字段并让 DataGridView 拒绝该条目，如果它与任何有效的 s 不匹配`transferTypes`，我一直在尝试设置 DataGridView 的列以使用填充有有效选项的下拉菜单. 为此，我使用 Visual Studios GUI 设计工具（用于构建 GUI）编辑了列并将“列类型”`DataGridViewTextBoxColumn`从`DataGridViewComboBoxColumn`. 该更改允许我选择一个`DataSource`来填充组合框的选择，所以我去了“其他数据源”下尝试选择存储我的设置（`Properties.Settings.Default`）的“属性”，但由于某种原因，Visual Studio 不允许我选择它。

然后，我尝试`DataSource`在 GUI 初始化后在代码中设置组合框，使用该行“ `((DataGridViewComboBoxColumn)arrowView.Columns[3]).DataSource = Properties.Settings.Default.validTransferTypes;`（传输类型是第四列），但是当我运行我的程序时，当我单击组合框并尝试时出现此错误“放下”：

DataGridVIew 中出现以下异常： System.ArgumentException: DataGridViewComboBoxCell 值无效。要替换此默认对话框，请处理 DataError 事件。

点击 OK 或退出窗口后，错误会立即循环并重新出现。

我假设必须有一种合理的方式来使用我的设置来填充组合框，但无法弄清楚如何。我也不明白为什么 Visual Studio 不允许我创建`DataSource`using `Properties`. 任何帮助，将不胜感激。

（这也是我第一次发布的问题，所以请对批评保持温和：））

更新：事实证明 using`((DataGridViewComboBoxColumn)arrowView.Columns[3]).DataSource = Properties.Settings.Default.validTransferTypes;`确实正确填充了组合框，但是只要将鼠标悬停在组合框上，就会出现前面提到的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:03:29.947

如果您使用 Properties.Settings.validTransferTypes 作为字符串，那么该组合框的值将只是一个字符串值。您的设置中是否有更多想要填充组合框的值？似乎错误即将到来，因为除了要加载的单个字符串之外，您没有其他内容可供组合框读取。尝试使用 Properties.Settings.Default 加载数组可能是一个选项，然后将数据源设置为等于大批。

# php - 从 php 调用 python/psycopg2 - 获取权限被拒绝错误连接到数据库

> ID：11543970
> 
> 赞同：1
> 
> 时间：2012-07-18T14:40:04.567
> 
> 标签：php, python, postgresql, permissions, psycopg2

我有可能（希望如此？）一个简单的权限问题，我一直在努力解决这个问题。希望一些新鲜的眼睛会有所帮助。

我在 Centos 6.2 上运行。我正在使用 python 成功访问和管理 postgresql 数据库。

但是，当我尝试通过 php 运行这些 python 脚本时，我在访问数据库时遇到错误。

我的 php 调用：

```
 exec('python test_get_bcas.py 2>&1 1> /dev/null', $output); 
```

和我的结果（请原谅格式）；

```
 0 => 'Traceback (most recent call last):',
  1 => '  File "test_get_bcas.py", line 3, in <module>',
  2 => '    response = getBCAs()',
  3 => '  File "/var/www/html/proj/getBCAs.py", line 22, in getBCAs',
  4 => '    database = Database()',
  5 => '  File "/var/www/html/proj/databaseFunctions.py", line 32, in __init__',
  6 => '    self.connection = psycopg2.connect("dbname=bsr user=gbtc password=broadcast host=localhost port=5432")',
  7 => '  File "/usr/lib/python2.6/site-packages/psycopg2-2.4.5-py2.6-linux-x86_64.egg/psycopg2/__init__.py", line 179, in connect',
  8 => '    connection_factory=connection_factory, async=async)',
  9 => 'psycopg2.OperationalError: could not connect to server: Permission denied',
  10 => '   Is the server running on host "localhost" and accepting',
  11 => '   TCP/IP connections on port 5432?',
  12 => '',
  13 => 'Exception AttributeError: AttributeError("\'NoneType\' object has no attribute \'close\'",) in <bound method Database.__del__ of <databaseFunctions.Database instance at 0x7f0de346efc8>> ignored', 
```

我的 python 代码如下所示：

```
self.connection = psycopg2.connect("dbname=proj user=user password=pw host=localhost port=5432") 
```

我认为问题出在运行 httpd 进程的用户身上。但是我尝试过弄乱文件的权限，甚至在 sudoers 文件中添加 apache 作为 root 用户。

任何人有任何想法我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T23:03:13.557

解决了！这是需要更改的 SELinux 设置，特别是 httpd_can_network_connect。

这样做：

```
setsebool -P httpd_can_network_connect on 
```

解决了这个问题。

# django - 在查询 django 中查询

> ID：11543971
> 
> 赞同：0
> 
> 时间：2012-07-18T14:40:19.643
> 
> 标签：django

如何在 django 中进行这样的查询。

我有站点模型，我可以在其中找到与主题模型的关系。在主题模型中，我可以找到与帖子模型的关系。我想从仅包含有关站点而不是主题的信息的站点中提取帖子。更多的帖子必须从查询开始。

```
query = request.GET.get('query','')         
iweb_obj = IWeb.objects.get(id=iweb_id)
topics = Topic.objects.filter(iweb=iweb_obj)
iweb_posts = []

for t in topics:
  posts = Post.objects.filter(topic=t)

for p in posts:
  iweb_posts.append(p)          

iweb_posts = iweb_.filter(content__istartswith=query) 
```

我有一个错误，即 iweb_posts 未设置查询，我无法执行此类操作。这很明显，但是我不知道如何使它起作用？我听说我可以使用 filter(**kwargs) 但我不知道如何使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:04:12.450

您的逻辑看起来有点古怪，因为您`posts`每次都在`topic`循环中覆盖。您可以在不使用循环和列表的情况下仅使用查询集过滤器来完成所需的操作（`__in`例如，我添加了一个过滤器）：

```
query = request.GET.get('query','')         
iweb_obj = IWeb.objects.get(id=iweb_id)
topics = Topic.objects.filter(iweb=iweb_obj)

iweb_posts = Post.objects.filter(topic__in=topics).filter(content__istartswith=query) 
```

# facebook-graph-api - 如何加快 /me/home 请求？

> ID：11543976
> 
> 赞同：1
> 
> 时间：2012-07-18T14:40:27.487
> 
> 标签：facebook-graph-api, optimization, facebook-fql

我有一个应用程序，我想在其中显示您的朋友共享的项目。这基本上是出现在您的 Facebook 新闻提要上的数据子集，因此我正在抓取`/me/home`并过滤掉一些我不需要的东西。

问题是`/me/home`速度非常慢。我看到的响应时间范围在 1200 到 10000 毫秒之间，平均可能在 4 秒左右。

即使使用缓存连接和正确执行 SSL 的 HTTP 库，这些请求时间也不会发生太大变化。

有谁知道获取新闻提要的更好方法？当我在浏览器中打开 Facebook 时，News Feed 几乎立即出现。所以我想知道是否有一些针对这些数据优化的 Graph API 调用或者已经缓存了这个结果。

是否有*FQL*替代方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T15:25:35.517

您可以在 FQL 中执行此操作。这个查询应该让你开始：

```
SELECT post_id, actor_id, target_id, message, attachment FROM stream WHERE filter_key = 'others' 
```

在我提要的 Graph API 资源管理器中，FQL 查询的响应时间约为 1000 毫秒，而`me/home`.

对于 Facebook 的主页，请记住，他们使用一系列 AJAX 查询来一次填充您页面上的每个框。上周，我在一家酒店的连接速度非常慢，看着这些东西一盒一盒地填满。新闻提要首先填充，一次五个帖子，然后是页面上的其他框。如果页面加载性能可能是一个问题，您可能希望迁移到异步模型。

FQL 肯定会对此有所帮助，因为与仅使用 Graph API 相比，您将能够在 FB 返回之前更精细地过滤数据。

# javascript - 使用 jquery 的 .done() 的好处

> ID：11543987
> 
> 赞同：0
> 
> 时间：2012-07-18T14:41:14.747
> 
> 标签：javascript, jquery, jquery-callback

> **可能重复：**
> [jQuery.ajax 处理继续响应：“成功：”与“.done”？](https://stackoverflow.com/questions/8840257/jquery-ajax-handling-continue-responses-success-vs-done)

与成功回调相比，使用 jquery 的 done 方法有什么好处吗？据我所知，这些都将执行相似（如果不相同？）

案例 1 使用`$.get`回调

```
$.get("....", function(data){
        console.log(data);
}); 
```

案例 2 使用 .done()

```
$.get("....").done(function(data){
     console.log(data);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:47:43.780

您可以在处理之前或之后附加任意数量的处理程序，并指望它们全部触发。您不必将所有内容都压缩到一个函数中。

```
var request = $.get("....")
request.done(function(data) {
    console.log(data);
});
request.done(function(data) {
    // do something else
});
request.done(someOtherPredefinedFunction); 
```

此外，我相信`success`处理程序已被弃用并计划最终删除。

# c# - 为什么我的 EF Code First 预生成视图没有效果？

> ID：11543990
> 
> 赞同：8
> 
> 时间：2012-07-18T14:41:22.860
> 
> 标签：c#, asp.net, entity-framework-4, entity-framework-4.3

我的上下文中有大约 300 个 DbSet，应用程序加载后的第一个查询（索引字段上的 FirstOrDefault() ）需要大约 40 秒。

为了改进这一点，我尝试在此处使用 T4 模板在 EF 4.3.1 Code First 中使用预生成的视图：

[http://blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-gallery/](http://blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-gallery/)

我编译它，但我没有看到性能差异。我希望/假设它会帮助我正在经历痛苦的​​缓慢启动，但没有运气。

它应该有帮助吗？如果不是，那么预生成的视图到底是做什么用的？而且，我*能*做些什么来缩短启动时间吗？至少可以说，拆分我的上下文是痛苦的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-21T16:29:58.800

某些 ORM 像 NHibernate 和 EF 启动速度很慢。我不想尝试“修复”这种缓慢，而是通过确保 IIS 在应用程序池启动时触发此代码来消除问题。为此，您必须将 IIS 配置为自动启动您的应用程序池。此解决方案仅适用于 .NET 4 和 IIS7.5 及更高版本。

您想实现一个类，通过将 serviceAutoStartProviders 节点添加到您的 web.config 并为您的应用程序应用程序池设置 startMode="AlwaysRunning" 来`IProcessHostPreloadClient`加载`ObjectContext`并配置您的应用程序以使用它。

详情请参阅[Scott Gu 的博客](http://weblogs.asp.net/scottgu/archive/2009/09/15/auto-start-asp-net-applications-vs-2010-and-net-4-0-series.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-21T18:34:43.030

事实证明，它实际上似乎是**在第一个引用实体所在的程序集中**搜索预生成的视图，而不是在 DbContext 所在的程序集中。在此处查看更多讨论：http: [//blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-gallery/#comment-76](http://blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-gallery/#comment-76)。

为了解决这个问题，我创建了一个新实体并将其放入上下文的程序集中，并将其列为第一个 DbSet。现在它捡起来了，并且运行良好（除了这很荒谬）。

# python - 如何从python中的数组中确定一组连接线

> ID：11543991
> 
> 赞同：1
> 
> 时间：2012-07-18T14:41:23.593
> 
> 标签：python, numpy, nearest-neighbor

我有一个看起来像这样的数组：

[0 x1 0 0 y1 0 z1
0 0 x2 0 y2 0 z2
0 0 x3 0 0 y3 z3
0 0 x4 0 0 y4 z4
0 x5 0 0 0 y5 z5
0 0 0 0 y6 0 0]

我需要从数组中确定一组连接线（即连接到点 [x1,x2,x3..]、[y1,y2,y3...]、[z1,z2,z3..] 的线）然后需要在每一行中找到最大值，即 max{x1,x2,x3,...}, max{y1,y2,y3..} 等。我试图使用 kdtree 进行最近邻搜索，但它返回相同的数组。我有大小（200 x 8000）的数组。有没有更简单的方法来做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:02:33.770

我不知道有什么东西可以提供您想要的开箱即用功能。如果您已经编写了逻辑，而且速度很慢，那么您是否考虑过 Cython-ing 您的代码。对于简单的类型循环操作，您可以获得显着的加速。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:06:29.857

加快线搜索算法的另一种方法是预先计算每条线的起点，然后应用昂贵的逻辑从这些点中的每一个计算线。

我对逻辑的看法有限（因为您没有提供完整的行识别逻辑），它可以计算快速矢量化代码中的起点。

能够在快速矢量化代码中实现这样的事情的第一步是能够找出哪些点在一条线上，但它们上面的直接点不是：

```
import numpy

# using the array that was provided in the question
a = """0 x1 0 0 y1 0 z1 
0 0 x2 0 y2 0 z2 
0 0 x3 0 0 y3 z3 
0 0 x4 0 0 y4 z4 
0 x5 0 0 0 y5 z5 
0 0 0 0 y6 0 0"""

array = numpy.array([int(v.strip()) if v.strip().isdigit() else i for i, v in enumerate(a.split(' '))]).reshape(6, 7) 
```

结果在一个数组中，如下所示：

```
>>> print repr(array)
array([[ 0,  1,  0,  0,  4,  0,  6],
       [ 0,  0   9,  0, 11,  0, 13],
       [ 0,  0, 16,  0,  0, 19, 20],
       [ 0,  0, 23,  0,  0, 26, 27],
       [ 0, 29,  0,  0,  0, 33, 34],
       [ 0,  0,  0,  0, 39,  0,  0]]) 
```

从这里，我们可以做一些 numpy 滚动：

```
 >>> print `numpy.roll(array, 1, axis=0)`
 array([[ 0,  0,  0,  0, 39,  0,  0],
        [ 0,  1,  0,  0,  4,  0,  6],
        [ 0,  0,  9,  0, 11,  0, 13],
        [ 0,  0, 16,  0,  0, 19, 20],
        [ 0,  0, 23,  0,  0, 26, 27],
        [ 0, 29,  0,  0,  0, 33, 34]]) 
```

可以将其组合起来为我们提供线条的垂直起点：

```
>>> potential_start_points = (array != 0) & (numpy.roll(array, 1, axis=0) == 0)
>>> # include the top row points, as they are certainly start points
>>> potential_start_points[0, :] = (array != 0)[0, :]
>>> print `potential_start_points`
array([[False,  True, False, False,  True, False,  True],
       [False, False,  True, False, False, False, False],
       [False, False, False, False, False,  True, False],
       [False, False, False, False, False, False, False],
       [False,  True, False, False, False, False, False],
       [False, False, False, False,  True, False, False]], dtype=bool) 
```

从这里开始，可以改进矢量化逻辑以挑选对角线等，但我很想迭代每个 True 并应用更复杂的基于索引的逻辑。

```
xs, ys = numpy.where(potential_start_points)

for x, y in zip(xs, ys):
    # do more complex logic here ... 
```

毕竟，在这种情况下，问题现在从迭代 6x7=42 个数字减少到仅迭代 7 个。

# python - pylint：禁用 R0921 不起作用，仍然警告

> ID：11543992
> 
> 赞同：5
> 
> 时间：2012-07-18T14:41:27.540
> 
> 标签：python, pylint

我有一个类，它有两个方法，它们引发`NotImplementedError`并继承自一个抽象类（一个包含抽象方法的类，来自`abc`包。这个父类又继承自一个标记为 abstract through 的类`__metaclass__ = ABCMeta`）。因此，在我的代码上运行 pylint 时会引发 R0921 警告。如果我删除`NotImplementedErrors`pylint 不会发出警告。现在，我尝试为此类禁用 R0921，如下所示：

```
# pylint: disable=R0921
class Wrapper(AbstractWrapper):
    ...
    def func(self, kwargs**):
        raise NotImplementedError
    ... 
```

但这似乎不起作用。我仍然收到警告“未引用抽象类”。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T03:40:25.970

这是一个错误并已报告，请参阅 pylint 跟踪器 [http://www.logilab.org/ticket/111138上的票证](http://www.logilab.org/ticket/111138)

# ms-access - 以新形式显示记录集

> ID：11543998
> 
> 赞同：0
> 
> 时间：2012-07-18T14:41:46.593
> 
> 标签：ms-access, vba

以下代码从表单中获取一个参数并将其传递给 vba 中的存储过程。我正确返回了值，并且存储过程在使用 debug.Print 时有效。现在我需要以“cat_percent_match”的形式显示存储过程的结果。所有这一切都在单击按钮时发生。下面的代码确实打开了表单，但现在我需要将记录集传递给它并显示结果。任何帮助是极大的赞赏。

```
Dim Cmd1 As ADODB.Command
Dim lngRecordsAffected As Long
Dim rs1 As ADODB.Recordset
Dim intRecordCount As Integer
'-----
Dim cnnTemp As ADODB.Connection
Set cnnTemp = New ADODB.Connection
cnnTemp.ConnectionString = "DRIVER=SQL Server;SERVER=***;" & _
"Trusted_Connection=No;UID=***;PWD=***;" & _
"Initial Catalog=IKB_QA;"
cnnTemp.ConnectionTimeout = 400
'Open Connection
cnnTemp.Open
Set Cmd1 = New ADODB.Command
Cmd1.ActiveConnection = cnnTemp
'---
With Cmd1
Dim localv As Integer
Dim inputv

localv = [Forms]![Start]![Selection]![cat_code]
.CommandText = "dbo.ix_spc_planogram_match_cat_percent " & inputv
.CommandType = adCmdStoredProc
Set inputv = Cmd1.CreateParameter("@deptcode", 3, 1, 10000, localv)
Cmd1.Parameters.Append inputv
Set rs1 = Nothing
Set rs1 = Cmd1.Execute

DoCmd.OpenForm "Cat_Percent_Match"

End With
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:55:07.770

相关文章是[http://support.microsoft.com/kb/281998](http://support.microsoft.com/kb/281998)

```
Private Sub Form_Open(Cancel As Integer)
   Dim cn As ADODB.Connection
   Dim rs As ADODB.Recordset

   'Use the ADO connection that Access uses
   Set cn = CurrentProject.AccessConnection

   'Create an instance of the ADO Recordset class, and
   'set its properties
   Set rs = New ADODB.Recordset
   With rs
      Set .ActiveConnection = cn
      .Source = "SELECT * FROM Customers"
      .LockType = adLockOptimistic
      .CursorType = adOpenKeyset
      .Open 
   End With

   'Set the form's Recordset property to the ADO recordset
   Set Me.Recordset = rs

   Set rs = Nothing
   Set cn = Nothing
End Sub 
```

因此，在这种特殊情况下，您可以尝试：

```
DoCmd.OpenForm "Cat_Percent_Match"
Set Forms.Cat_Percent_Match.Recordset = rs1 
```