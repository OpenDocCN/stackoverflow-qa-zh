# StackOverflow 问答 10559000-10559999

# c# - c#在另一个进程的内存中搜索-突然锁定

> ID：10559002
> 
> 赞同：0
> 
> 时间：2012-05-11T21:39:52.893
> 
> 标签：c#, memory, process

我需要跟踪另一个程序的内存，不断寻找出现在其中的字节序列，当它们出现时，我需要记住它们的位置，以便我以后知道在哪里写入。

我使用以下帖子来学习如何在另一个进程的内存中查找 byte[]： [C#: Search a byte[] array in another process's memory](https://stackoverflow.com/questions/781716/c-search-a-byte-array-in-another-processs-memory)

我的程序非常简单：它启动进程（使用 Process.Start），然后从链接线程的答案之一重复运行函数：

```
private static  int GetMemoryAddressOfString(byte[] searchedBytes)
    {
        IntPtr hProcess = OpenProcess(ProcessAccessFlags.VMOperation | ProcessAccessFlags.VMRead | ProcessAccessFlags.VMWrite, false, Program.ArtemisProcess.Id);
        if (hProcess == IntPtr.Zero)
            throw new Win32Exception(Marshal.GetLastWin32Error());

        int addr = 0;
        int speed = 1024 * 64;
        for (int j = 0x00400000; j < 0x11000000; j += speed)
        {
            byte[] bigMem = new byte[speed + searchedBytes.Length];

            IntPtr unmanagedPointer = Marshal.AllocHGlobal(4);
            ReadProcessMemory(hProcess, (IntPtr)j, bigMem, new UIntPtr((uint)(speed + searchedBytes.Length)), unmanagedPointer);
            int result = Marshal.ReadInt32(unmanagedPointer);
            Marshal.DestroyStructure(unmanagedPointer, typeof(int));

            for (int k = 0; k < bigMem.Length - searchedBytes.Length; k++)
            {
                bool found = true;
                for (int l = 0; l < searchedBytes.Length; l++)
                {
                    if (bigMem[k + l] != searchedBytes[l])
                    {
                        found = false;
                        break;
                    }
                }
                if (found)
                {
                    addr = k + j;
                    break;
                }
            }
            if (addr != 0)
                break;
        }
        return addr;
    } 
```

其中 ArtemisProcess 是我使用 .Start() 运行的进程

大多数时候，它工作正常。一旦我在监视进程中执行将搜索到的字节序列放入内存的操作，下一次搜索就会找到它。但是，有时，它不会。

我想知道我是否正确并使用作弊引擎来确保搜索到的数据在那里。

然后我添加了创建非托管指针的部分，以了解读取了多少字节 - 那就是当我发现内存中搜索字节出现的位置（作弊引擎正确识别）返回 0 时！它不会让我在那里读取内存。这种“锁定”发生了大约一两分钟，然后才允许我读取内存（只是突然之间，下一次尝试在该位置读取内存是成功的，并且找到了字节序列）。

现在，我在 msdn 上读到“如果请求的读取操作进入无法访问的进程区域，他的函数将失败”但是我如何知道进程内存的哪个部分是可访问的，哪些不是？

为什么作弊引擎能够读取该内存，而我的程序却不能？

为什么它突然允许我再次读取进程内存？

我在这里不知所措...

# vim - 如何从 Vim 启动 WinMerge？

> ID：10559010
> 
> 赞同：0
> 
> 时间：2012-05-11T21:40:42.247
> 
> 标签：vim, windows-7, winmerge

在我的 Mac 上，我使用它来区分我当前的缓冲区：

```
nnoremap <Space>d
\   :silent w! /tmp/vim_current_buffer<cr>
\   :silent !gdiff "%" /tmp/vim_current_buffer<cr> 
```

（gdiff 是我的图形不同）

现在我使用的是 Windows 7，我正在尝试让这段代码与[WinMerge](http://winmerge.org/)一起使用。但是，我不知道如何从命令行启动[WinMerge 。](http://winmerge.org/)

* * *

**更新**

我可以运行 WinMerge：

```
nnoremap <Space>m :!"C:\Program Files (x86)\WinMerge\WinMergeU.exe"<cr> 
```

但我无法打开两个文件。添加额外的斜杠不起作用。当我尝试它时，我得到了这个：

```
C:\Windows\system32\cmd.exe /c C:\\Program\ Files\ (x86)\\WinMerge\\WinMergeU.ex
e
'C:\\Program\' is not recognized as an internal or external command,
operable program or batch file.
shell returned 1
Hit any key to close this window... 
```

这是我到目前为止所拥有的：

```
nnoremap <Space>d
\   :silent w! "C:\tmp\vim_current_buffer"<cr>
\   :silent !"C:\Program Files (x86)\WinMerge\WinMergeU.exe" "C:\tmp\vim_current_buffer" "%" <cr> 
```

有没有人看到错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T04:41:33.887

你知道 WinMerge 的可执行文件的路径吗？这将是类似的东西`C:\Program Files\WinMerge\WinMergeU.exe`。您应该能够将其放入而不是`gdiff`，但在名称中的每个原始反斜杠和空格之前放置一个反斜杠（例如`C:\\Program\ Files\\WinMerge\\WinMergeU.exe`）。

# django - 将 ForeignKey 添加到 UserProfile 给出外键约束失败

> ID：10559012
> 
> 赞同：1
> 
> 时间：2012-05-11T21:40:47.407
> 
> 标签：django

几个小时以来，我一直在试图解决这个问题，相信我，我真的在 Stack Overflow 上到处寻找。

在我的 UserProfile 中，我有一个对另一个模型（称为“公司”）的 ForeignKey 引用，并且在注册后，我创建了一个新公司并将我的 UserProfile ForeignKey 指向该公司。

models.py 如下：

```
class UserProfile(models.Model):
  company = models.ForeignKey(Company)
  title = models.CharField(max_length = 50, default = '')
  user = models.OneToOneField(User, default = 0, null = True)

class Company(models.Model):
  """A company profile."""
  name = models.CharField(max_length = 50) 
```

我使用表格进行注册。这是表格：

```
class SignupForm(ModelForm):
  name = forms.CharField(label = "Name")
  company = forms.CharField(max_length = 50)
  email = forms.EmailField(label = "Email")
  password = forms.CharField(widget=forms.PasswordInput)

  class Meta:
    model = User
    fields = ("name", "company", "email", "password")

  def save(self, commit=True):
    user = super(SignupForm, self).save(commit=False)
    name = self.cleaned_data["name"].split()
    if len(name) == 1:
      # User did not enter a last name.
      user.first_name = name
    else:  
      user.first_name, user.last_name = name
    user.email = self.cleaned_data["email"]
    user.set_password(self.cleaned_data["password"])
    user.username = user.email
    if commit:
      user.save()

    return user 
```

这是注册视图：

```
def signup(request):
  if request.method == 'POST':
    form = SignupForm(request.POST)
    if form.is_valid():
      # Check if email has already been used for an account.
      email = request.POST['email']
      existing_account = User.objects.filter(email = email)
      if existing_account:
        form = SignupForm()
        return render_to_response('registration/signup.html',
          { 'form': form,
            'error': 'duplicate_email',
          })

      # Otherwise, save the form and create a new user.
      new_user = form.save()

      company = Company(name=request.POST['company'])
      company.save()

      user_profile = new_user.get_profile()
      user_profile.company = company
      user_profile.save()

      new_user = authenticate(
        username = email,
        password = request.POST['password']
      )
      # Log the user in automatically.
      login(request, new_user)

      # Redirect user to Thank You page.
      return HttpResponseRedirect('/thanks')
  else:
    form = SignupForm()

  return render_to_response('registration/signup.html', {
    'form': form,
  }) 
```

我得到的错误是告诉我 company_id 不能为空。我清楚地添加了一家新公司。请让我知道您认为可能有什么问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T01:56:34.297

不确定这是否对您的口味来说太老套了，但也许您可以创建/保存 Company 对象并将其作为位置/关键字参数传递给您的 SignupForm.save() 方法。

你会遇到的问题是你会期待一个 CharField 并且你会传入一个公司对象。因此，您可能希望将 company.pk 提供给表单中的公司字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:07:15.487

我今天遇到了这个确切的错误，没有任何原因，只是它是由 SQLite 引起的。使用 SQLite，一张表的 id 字段从 INTEGER PRIMARY KEY 变为 INTEGER。如果您使用的是 SQLite，请尝试删除有问题的表并使用 syncdb 重新创建它。

什么是价值

```
user_profile = new_user.get_profile() 
```

?

# java - Java 2d 用鼠标射击方向

> ID：10559017
> 
> 赞同：1
> 
> 时间：2012-05-11T21:41:57.877
> 
> 标签：java, algorithm, direction, projectile

我的问题可能很简单。我今天大部分时间都在考虑一种算法（这很可能是几个 if 语句），它将确定鼠标指向的方向并朝那个方向发射子弹。我已经对子弹进行了测试，以确保它们通过向定义的方向射击来射击。

我将如何计算鼠标是在播放器的左侧、右侧、顶部、底部还是在播放器的角落？

**已解决：**感谢您的所有帮助，但经过一天的思考，我想出了一个自己的方法。我所做的是使用 if 语句来确定当我按下鼠标时，它是否会与播放器的顶部、底部、右侧、左侧或角落发生碰撞。无论如何，这是我的代码。PS我使用变量x1作为mousex，y1作为mousey，x作为playerx，y作为player y。我唯一的其他变量是 dx 和 dy 但你应该知道它们的作用。

```
//top
if (x1 > x && x1 < x + 40 && y1 > y - 250 && y1 < y){
        dy = -1;
    dx = 0;
}
//right
if (x1 > x + 40 && x1 < x + 250 && y1 > y && y1 < y + 40){
    dx = 1;
    dy = 0;
}
//bottom
if (x1 > x && x1 < x + 40 && y1 > y+40 && y1 < y+250){
    dy = 1;
    dx = 0;
}
//left
if (x1 < x && x1 > x - 250 && y1 > y && y1 < y + 40){
    dx = -1;
    dy = 0;
}
//top right corner
if (x1 > x + 40 && x1 < x + 250 && y1 > y - 250 && y1 < y){
    dx = 1;
    dy = -1;
}
//top left corner
if (x1 < x && x1 > x - 250 && y1 > y - 250 && y1 < y){
    dx = -1;
    dy = -1;
}
//bottom right corner
if (x1 > x + 40 && x1 < x + 250 && y1 > y + 40 && y1 < y + 250){
    dx = 1;
    dy = 1;
}
//bottom left corner
if (x1 < x && x1 > x - 250 && y1 > y + 40 && y1 < y + 250){
    dx = -1;
    dy = 1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:01:03.477

如果要在按下鼠标按钮时实现射击，则必须实现鼠标移动动作侦听器。

简单的直线方程就可以了。

`(x0,y0)`解决方法：获取按钮按下时的初始点。当按下鼠标移动时，获取鼠标移动`(x1,y1)`的点（这会不断变化）-获取线方程-（您有 2 个点，所以找到`slope`然后使用一个点来获取`equation of the line`）。

现在子弹发射的方向是`perpendicular to this line through (x1,y1)`. 因此，当已知另一个方程时，您可以找到该垂直线的方程。现在要知道它是否必须向上或向下发射是相对于找出枪指向哪一侧（方向存储在变量中）

毕竟，当鼠标仍然移动时，旧点现在将成为`(x1,y1)`新点`(x2,y2)`，并且您继续实施这些更改。

# python - 替换列表中的项目，python

> ID：10559018
> 
> 赞同：4
> 
> 时间：2012-05-11T21:42:08.393
> 
> 标签：python, replace

我有一个这样的字符串列表：

```
Item_has_was_updated_May_2010
Item_updated_Apr_2011
Item_got_updated_Sept_2011 
```

我想遍历字符串列表并更新字符串的最后 2 部分。月份和年份。其余的字符串我想保持不变。月份和年份将取自我之前在脚本中设置的变量，因此我们将月份称为 x 和年份 y。

我的方法是：

1.  遍历字符串列表
2.  用“_”分割每个字符串
3.  替换最后 2 项
4.  将项目与替换的项目重新连接在一起

月份和年份将取自我之前在脚本中设置的变量，因此我们将月份称为 x 和年份 y。

如果有人可以提出一种方法，我们将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T21:44:42.403

您可以使用以下方法在不使用正则表达式的情况下执行此操作`str.rsplit`：

```
yourlist = [s.rsplit('_', 2)[0] + '_' + x + '_' + y for s in yourlist] 
```

在线查看它：[ideone](http://ideone.com/WcvKY)

* * *

如果你想使用格式而不是字符串连接，试试这个：

```
yourlist = ['{}_{}_{}'.format(s.rsplit('_', 2)[0], x, y) for s in yourlist] 
```

在线查看它：[ideone](http://ideone.com/j9zDF)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:51:58.510

我不认为你真的需要're'。
你可以使用这样的东西：

```
m="dec"
y=2012
l=["Item_has_was_updated_May_2010",
    "Item_updated_Apr_2011",
    "Item_got_updated_Sept_2011"]
r=[]
for s in l:
    t=s.split("_")
    r.append("_".join(t[:-2])+"_%s_%s"%(m,y)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-12T03:47:19.873

```
lst = [
   'Item_has_was_updated_May_2010',
   'Item_updated_Apr_2011',
   'Item_got_updated_Sept_2011',
]
month='Sep';year='2012'
for s in lst:
        list=s.split('_')
        list[-2:]=(month,year)
        r=''
        for a in list:
                r=r+"%s_"%a
        r=r[:-1]
        print r 
```

# java - 将 AbstractTableModel 实现到 JTable。如何添加方法？

> ID：10559020
> 
> 赞同：0
> 
> 时间：2012-05-11T21:42:12.587
> 
> 标签：java, swing, jdbc, jtable, abstracttablemodel

我曾经在 JTable 中显示我的数据库数据，它工作正常。我发现我需要实现 AbstractTableModel 或 DefaultTableModel 来立即更新数据。

我不确定我应该在 getValueAt() 中写什么？我应该在哪里添加 fireDataChanged()？任何指导表示赞赏，谢谢！

我曾经使用以下代码检索我的数据库数据：

```
Vector columnNames = new Vector();
Vector data = new Vector();  

try
{
    Class.forName("com.mysql.jdbc.Driver");
    Connection con = DriverManager.getConnection ("jdbc:mysql://localhost:3306/watchlist","root","root");                   

    String sql = "SELECT * FROM watchlist";
    Statement stmt = con.createStatement();
    ResultSet rs = stmt.executeQuery(sql);
    ResultSetMetaData md = rs.getMetaData();

    int columns = md.getColumnCount();
    for (int i = 1; i <= columns; i++)
    {
        columnNames.addElement( md.getColumnName(i));
    }                               

    int rowCount = md.getColumnCount();             
    while (rs.next())
    {
        Vector row = new Vector(rowCount);

        for (int i=1; i <= rowCount; i++)
        {
            row.addElement( rs.getObject(i) );
        }

        data.addElement( row );
    }

    rs.close();
    stmt.close();
    con.close();                                      
}

catch(Exception e)
{
    System.out.println(e);
} 
```

我的抽象表模型：

```
public class MyTableModel extends AbstractTableModel 
{
    Vector columnNames = new Vector(); 
    Vector data = new Vector(); 

    public void connectionDB()
    {
        try
        {                               
            Class.forName("com.mysql.jdbc.Driver");
            Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/watchlist","root","root");

             String sql = "SELECT * FROM watchlist";
             Statement stmt = con.createStatement();
             ResultSet rs = stmt.executeQuery(sql);
             ResultSetMetaData md = rs.getMetaData();   
        }

        catch(Exception e)
        {
            System.out.println(e);
        }
    }

    public int getColumnCount() 
    {
        return columnNames.size(); 
    }

    public int getRowCount() 
    {
        return data.size(); 
    }

    public Object getValueAt()
    {
        return data;    
    }

    public boolean isCellEditable(int row, int col)
    {
        return false; 
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:03:16.887

这是一个使用示例`AbstractTableModel`：

```
public class CustomTableModel extends AbstractTableModel
{
    private static final long serialVersionUID = 1L;
    private static final String[] columnNames = new String[]{"ID", "Name", "Number", "Yes/No"};
    protected List<Foo> lstFoo;
    protected Class<?>[] types = new Class[]{Integer.class, String.class, String.class, Boolean.class};

    public CustomTableModel(List<Foo> lstFoo)
    {
        this.lstFoo = lstFoo;
        fireTableDataChanged();
    }

    @Override
    public String getColumnName(int columnIndex)
    {
        return columnNames[columnIndex];
    }

    @Override
    public Class<?> getColumnClass(int columnIndex)
    {
        return types[columnIndex];
    }

    @Override
    public boolean isCellEditable(int row, int columnIndex)
    {
        return false;
    }

    @Override
    public Object getValueAt(int row, int column)
    {
        if(row < 0 || row >= lstFoo.size()) return null;
        Foo obj = lstFoo.get(row);
        switch(column)
        {
            case 0: return obj.getId();
            case 1: return obj.getName();
            case 2: return obj.getNumber();
            case 3: return obj.isYes();
            default: return null;
        }
    }

    @Override
    public int getRowCount()
    {
        return lstFoo.size();
    }

    @Override
    public int getColumnCount()
    {
        return columnNames.length;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T09:20:52.970

只是一点，两个很多连接到一个数据库会降低速度和过多的开销。我遇到了这个问题并且能够解决它。

# c# - 带有 Ninject 的 AutoMapper

> ID：10559026
> 
> 赞同：4
> 
> 时间：2012-05-11T21:42:33.047
> 
> 标签：c#, asp.net-mvc-3, ninject, ioc-container, automapper

我一直在尝试设置 AutoMapper 以通过 Ninject 实例化所有对象。我的 global.asax 文件中有以下代码

```
Mapper.Configuration.ConstructServicesUsing(x => kernel.Get(x)); 
```

作为一个例子，我有以下映射

```
Mapper.CreateMap<TestModel, IndexViewModel>(); 
```

但是，这似乎不起作用。我收到“IndexViewModel”没有默认构造函数的错误。

我可以通过明确告诉 automapper 在映射中使用 ninject 来使映射器工作。

```
Mapper.CreateMap<TestModel, IndexViewModel>().ConstructUsingServiceLocator(); 
```

但是，我宁愿不必为每个映射都这样做。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T08:51:42.133

只需在初始化代码的某处创建一个函数来为您执行此操作

```
void CreateMapWithServiceLocator<T1,T2>()
{
     Mapper.CreateMap<T1,T2>().ConstructUsingServiceLocator();
} 
```

# django - Django在javascript中获取动态表单的语言

> ID：10559027
> 
> 赞同：0
> 
> 时间：2012-05-11T21:42:52.837
> 
> 标签：django, forms, internationalization

我有一个 django 表单，其中包含两个用于选择气候参数的字段。这两个字段都由相同的 CHOICES 填充，但我需要第二个字段受第一个选项的影响。基本上，如果在第一个参数中选择了一个参数，那么它应该从第二个选项中删除。

我现在有代码可以很好地解决这个问题，除了一个问题。我需要这些字段具有语言意识。

**表格.py**

```
class ClimateForm(forms.Form):
    ...
    param1 = forms.ChoiceField(choices=PARAM_CHOICES, label=_('Y axis one'), initial=_('Not Specified'),
                widget=forms.Select(attrs={"onChange":'activateParam()'}),
                )
    param2 = forms.ChoiceField(choices=PARAM_CHOICES, label=_('Y axis two'), initial=_('Not Specified'),
                required = False,
                )
    ... 
```

然后我调用`activateParam()`执行此操作的函数：

**filter_form.js**：

```
function activateParam() {
    // get value to exclude from select
    var param1Val = document.getElementById("id_param1").value;
    // get next element id
    var param2 = document.getElementById("id_param2");
    // param2.setAttribute("style", "display:block");
    updateSelect($('select[name=param2]'), param1Val);   
 }

function updateSelect(select, value) {
    // find and remove existing options
    select.find('option').remove();
    // loop through results and append to select as options
    for (var k in climate_params) {
        if (k!=value) {
            select.append($('<option value="'+k+'">'+climate_params[k]+'</option>'));
        }
    }
} 
```

`climate_params`只是填充第二个字段的值和字符串数组：

```
var climate_params = {
    '': 'Not Specified',
    'mean_air_temp': 'Mean Air Temperature', 
    'min_air_temp': 'Min Air Temperature', 
    'max_air_temp': 'Max Air Temperature',
    'sea_temp': 'Sea Surface Temperature',
    'mean_rel_hum': 'Mean Relative Humidity',
    'precipitation': 'Preciptitation',
}; 
```

所以，我可以修改这个数组或包含另一个数组，但我需要知道如何将语言状态传递给这个 JS 脚本。有什么方法可以直接在 JS 中访问语言变量吗？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T06:13:16.053

您可以[直接在 js 中标记翻译字符串](https://docs.djangoproject.com/en/1.4/topics/i18n/translation/#internationalization-in-javascript-code)，
或者初始化`climate_params`w/ Python 翻译对象：

```
{# in template #}
var climate_params = {
    {% for param, label in PARAM_CHOICES %}
    '{{ param|escapejs }}: '{{ label|escapejs }}',
    {% endfor %}
}; 
```

另请查看检查[我如何在 django 中获取当前语言？](https://stackoverflow.com/questions/3356964/how-i-get-the-current-language-in-django). 如果您通过 Ajax 传递标签，则翻译已经完成。

# jquery - 如何用 jQuery 调用这个函数

> ID：10559030
> 
> 赞同：0
> 
> 时间：2012-05-11T21:43:06.910
> 
> 标签：jquery

我试图让代码运行但没有任何反应，因为我不确定我是否必须调用该函数或它是否自动运行。

当使用 window.onload 方法时，我会给函数一个名称 < init > 并且它会运行。用 jquery 调用它我不确定我是否应该有一个函数名？

请问我应该如何让代码运行。

```
// JavaScript Document
$(document).ready(function () {
    var xhr = false;
    var xPos, yPos;

    function () {
        var allLinks = document.getElementsByTagName("a");

        for (var i = 0; i < allLinks.length; i++) {
            allLinks[i].onmouseover = showPreview;
        }

    } //end function
    function showPreview(evt) {
        if (evt) {
            var url = evt.target;
        } else {
            evt = window.event;
            var url = evt.srcElement;
        }
        xPos = evt.clientX;
        yPos = evt.clientY;

        if (window.XMLHttpRequest) {
            xhr = new XMLHttpRequest();
        } else {
            if (window.ActiveXObject) {
                try {
                    xhr = new ActiveXObject("Microsoft.XMLHTTP");
                } catch (e) {}
            }
        }

        if (xhr) {
            xhr.onreadystatechange = showContents;
            xhr.open("GET", url, true);
            xhr.send(null);
        } else {
            alert("Sorry, but I couldn't create an XMLHttpRequest");
        }
        return false;
    }

    function showContents() {
        if (xhr.readyState == 4) {
            if (xhr.status == 200) {
                var outMsg = xhr.responseText;
            } else {
                var outMsg = "There was a problem with the request " + xhr.status;
            }
            var prevWin = document.getElementById('previewWin');
            prevWin.innerHTML = outMsg;
            prevWin.style.top = parseInt(yPos) + 2 + "px";
            prevWin.style.left = parseInt(xPos) + 2 + "px";
            prevWin.style.visibility = "visible";

            preview.onmouseout = function () {
                document.getElementById('preview').style.visibility = "hidden";
            }
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:49:11.033

你已经声明了函数。没有你在哪里调用函数以便它执行。

您将无法从外部调用此函数，因为它们是在 document.ready 函数中声明的。做这样的事情

```
$(document).ready(function() {
    function showcontent(){
    };
    showcontent();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:47:40.363

# jQuery === JavaScript

因此，在 jQuery 中调用函数与在 JavaScript 中调用函数完全相同。

jQuery 所做的唯一一件事就是创建易于使用的方法和函数来加速您的 JavaScript 开发。例如，`window.onload`事件被事件替换`$(document).ready()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:55:22.050

你有两个选择，内联 JavaScript：

```
<script>...yourcode...</script> 
```

或在外部文件中链接 javascript：

```
<script type="text/javascript" src="yourfile.js"></script> 
```

通常链接的文件在头标签中，内联脚本在底部。

如果你不使用 jQuery，你还需要包含这个库[http://jquery.com](http://jquery.com)

```
function () {
    var allLinks = document.getElementsByTagName("a");

    for (var i = 0; i < allLinks.length; i++) {
        allLinks[i].onmouseover = showPreview;
    }

} //end function 
```

真的应该是：

```
function () {
    var allLinks = $("a");

    allLinks.on("mouseover", showPreview);

} //end function 
```

# javascript - Jquery设法打破，比较值

> ID：10559034
> 
> 赞同：0
> 
> 时间：2012-05-11T21:43:51.987
> 
> 标签：javascript, jquery, html

这是一个问题的大量代码，但基本上这是可行的，然后我尝试对其进行调整并设法破坏它。谁能发现问题？实际上可能有一对。

基本上，这只是我学习jquery，我想从输入中获取一个值，然后当用户点击比较时，它会慢慢生成他们答案的图表，然后对预设的“平均”答案做同样的事情，最终会告诉他们答案与平均值之间的差异。

```
<h2 id="compare">Compare your score with the average</h2>

<p><a href="#compare" class="run">Compare</a></p>
<div style="height:400px;position:relative;">
<div id="score" style="position:absolute;left:0px;bottom:0px;width:200px;height:2px;background-color:#01DFD7;float:left;"></div>
<div id="score2" style="position:absolute;left:220px;bottom:0px;width:200px;height:2px;background-color:#FFD;float:left;"></div>
</div>

<input id="yourValue" type="text" />

<p id="answer"></p>

<script type="text/javascript">  
$('.run').click(function(){  
var theValue = $("#yourValue").val();
$('#score').animate({height:'theValue'}, 5000, function(){
  $('#score2').animate({height:'200px'}, 5000, function(){
      $('#answer#).html("<p>Your Answer: </p>" +  theValue);
  });
});
});
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:46:32.413

`{height:'theValue'}`- 这不应该用引号引起来。引号意味着它是一个字符串，你实际上想要 theValue 的值。

$('#answer#) - 这在语法上是不正确的。我假设你想要 $('#answer')

# python - 如何使用 OpenCV 旋转视频

> ID：10559035
> 
> 赞同：10
> 
> 时间：2012-05-11T21:43:54.123
> 
> 标签：python, image-processing, opencv

如何使用 OpenCV 旋转视频流中的所有帧？我尝试使用[类似问题](https://stackoverflow.com/questions/9041681/opencv-python-rotate-image-by-x-degrees-around-specific-point)中提供的代码，但它似乎不适用于返回 cv.RetrieveFrame 的 Iplimage 图像对象。

这是我目前拥有的代码：

```
import cv, cv2
import numpy as np

def rotateImage(image, angle):
    if hasattr(image, 'shape'):
        image_center = tuple(np.array(image.shape)/2)
        shape = image.shape
    elif hasattr(image, 'width') and hasattr(image, 'height'):
        image_center = (image.width/2, image.height/2)
        shape = np.array((image.width, image.height))
    else:
        raise Exception, 'Unable to acquire dimensions of image for type %s.' % (type(image),)
    rot_mat = cv2.getRotationMatrix2D(image_center, angle,1.0)
    result = cv2.warpAffine(image, rot_mat, shape, flags=cv2.INTER_LINEAR)
    return result

cap = cv.CaptureFromCAM(cam_index)
#cap = cv.CaptureFromFile(path)
fps = 24
width = int(cv.GetCaptureProperty(cap, cv.CV_CAP_PROP_FRAME_WIDTH))
height = int(cv.GetCaptureProperty(cap, cv.CV_CAP_PROP_FRAME_HEIGHT))

fourcc = cv.CV_FOURCC('P','I','M','1') #is a MPEG-1 codec

writer = cv.CreateVideoWriter('out.avi', fourcc, fps, (width, height), 1)
max_i = 90
for i in xrange(max_i):
    print i,max_i
    cv.GrabFrame(cap)
    frame = cv.RetrieveFrame(cap)
    frame = rotateImage(frame, 180)
    cv.WriteFrame(writer, frame) 
```

但这只是给出了错误：

```
 File "test.py", line 43, in <module>
    frame = rotateImage(frame, 180)
  File "test_record_room.py", line 26, in rotateImage
    result = cv2.warpAffine(image, rot_mat, shape, flags=cv2.INTER_LINEAR)
TypeError: <unknown> is not a numpy array 
```

大概是因为 warpAffine 采用 CvMat 而不是 Iplimage。根据[C++ cheatsheet](http://opencv.willowgarage.com/documentation/cpp/c++_cheatsheet.html)，两者之间的转换是微不足道的，但我找不到任何关于在 Python 中做等价的文档。如何在 Python 中将 Iplimage 转换为 Mat？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-12T01:59:05.730

如果您刚刚旋转 180 度，则可以`Flip`在两个轴上使用，

代替：

```
frame = rotateImage(frame, 180) 
```

和：

```
cv.Flip(frame, flipMode=-1) 
```

这是'到位'，所以它很快，你将不再需要你的`rotateImage`功能:)

例子：

```
import cv
orig = cv.LoadImage("rot.png")
cv.Flip(orig, flipMode=-1)
cv.ShowImage('180_rotation', orig)
cv.WaitKey(0) 
```

这： ![在此处输入图像描述](../Images/1f341a4d4ddcffbf9731855a6a31daa6.png)变成，这：![在此处输入图像描述](../Images/d20c748983651bf84c0da7f679194d34.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-12T01:07:50.583

通过反复试验，我最终找到了解决方案。

```
import cv, cv2
import numpy as np

def rotateImage(image, angle):
    image0 = image
    if hasattr(image, 'shape'):
        image_center = tuple(np.array(image.shape)/2)
        shape = tuple(image.shape)
    elif hasattr(image, 'width') and hasattr(image, 'height'):
        image_center = tuple(np.array((image.width/2, image.height/2)))
        shape = (image.width, image.height)
    else:
        raise Exception, 'Unable to acquire dimensions of image for type %s.' % (type(image),)
    rot_mat = cv2.getRotationMatrix2D(image_center, angle,1.0)
    image = np.asarray( image[:,:] )

    rotated_image = cv2.warpAffine(image, rot_mat, shape, flags=cv2.INTER_LINEAR)

    # Copy the rotated data back into the original image object.
    cv.SetData(image0, rotated_image.tostring())

    return image0 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T21:47:37.570

你不需要使用`warpAffine()`，看看`transpose()`和`flip()`。

[这篇文章](https://stackoverflow.com/a/7825243/176769)演示了如何将图像旋转 90 度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-01-26T07:46:04.480

这对我有用：

```
gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)
flipped = cv2.flip(gray, flipCode = 1)
cv2.imshow('frame',flipped) 
```

[更多关于翻转码](https://docs.opencv.org/2.4/modules/core/doc/operations_on_arrays.html#void%20flip(InputArray%20src,%20OutputArray%20dst,%20int%20flipCode))

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-26T21:14:34.230

开放式简历。**版本**= 3.4.2

_, frame = cap.read() frame = cv2.rotate(frame, cv2.ROTATE_90_CLOCKWISE)

# php - 正则表达式用php和javascript匹配字符串中的最后一个整数

> ID：10559037
> 
> 赞同：0
> 
> 时间：2012-05-11T21:44:19.997
> 
> 标签：php, javascript, regex, anchor, digit

我需要匹配字符串中的最后一个整数，并在最后一个整数之前和之后捕获可能的元素，假设字符串可以由单个整数或文本和/或整数的组合组成。假设 $str 可以是：

*   '123' -> '' - 123 - ''
*   'abc 123' -> 'abc' - 123
*   'abc 123 def' -> 'abc' - 123 - 'def'
*   'abc 123 def 456' -> 'abc 123 def' - 456
*   等等

我希望php中的以下代码可以完成这项工作：

```
$str = 'abc 123 def 456 ghi';
preg_match('/(.*)(\d+)(\D*)$/', $str, $matches);
echo 'Matches = ' . implode(' : ', $matches); 
```

但是 (\d+) 只拾取一位数字：

```
 Matches = abc 123 def 456 ghi : abc 123 def 45 : 6 :  ghi 
```

在我期待的时候：

```
 Matches = abc 123 def 456 ghi : abc 123 def  : 456 :  ghi 
```

我在 Javascript 中得到相同的行为。(.*) 对 (\d+) 有那么贪婪吗？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T21:50:05.793

为什么不`/(\d+)\D*$/`呢？这样，唯一的捕获组就是整数。

顺便说一句，当我使用正则表达式时，我通常使用[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:49:38.363

在 Javascript 中：

```
$str = 'abc 123 def 456';
$matches = $str.match(/\d+/g);
$lastInt = $matches[$matches.length-1]; 
```

在 PHP 中

```
$str = 'abc 123 def 456';
preg_match_all('/(\d+)/', $str, $matches);
$lastInt = end($matches);
echo 'Last integer = ' . $lastInt; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T21:56:53.627

您可以完全避免使用 .*，因为模式末尾的 "\D*$" 会确保它是最后一个数字。

也建议你不要添加不必要的括号，只获取你真正需要的。也就是说，您可以执行以下操作以仅获取最后一个数字：

```
preg_match('/(\d+)\D*$/', $str, $matches); 
```

但是，如果您确实需要对字符串的其他部分进行匹配，并且您要查找的数字将是它自己的单词，您可以在 (\d+) 之前将 \b 参数添加到该正则表达式中，以便 (.* ) 不会贪婪地消耗您的部分号码。IE：

```
preg_match('/(.*)\b(\d+)(\D*)$/', $str, $matches); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T21:49:56.970

这应该为你做...

```
(\d+)(?!.*\d) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T21:50:57.053

如果要缓存**最后一个**整数，则应在正则表达式末尾使用 $。

尝试`/(\d+)$/`两种语言。

# magento - Magento 使用 PayPal 处理信用卡而不重定向到 PayPal

> ID：10559038
> 
> 赞同：0
> 
> 时间：2012-05-11T21:44:21.397
> 
> 标签：magento, payment-gateway, paypal, payment

我想知道是否可以使用 PayPal Pro 作为网关来处理信用卡信息，而无需重定向到 PayPal 页面。我们想要的是在我们的商店中显示表单，进行 API 调用并将响应打印给用户，而无需让他离开贝宝。

我们正在使用 Magento 1.4.2，有没有现成的解决方案？否则我们必须自己开发一个

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T01:05:13.763

你可以让贝宝出现在一个框架中，并使用他们的 API 和它的安全密钥等。我相信 Josh 的回答在技术上是不正确的，但是 PP 对编码来说是一个足够大的痛苦，我们决定做任何我们可以做的事情工作，这是重定向到他们的网站。

不用担心，paypal 用户对此已经习以为常，并不介意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:17:21.110

您要查找的内容称为参考事务。这将允许您进行一键式付款或存储和记帐用户的 PayPal 帐户，就像信用卡一样，而无需重定向到 PayPal；但是，您*必须*首先将客户重定向到 PayPal，才能获得客户的同意。

您还需要获得 PayPal 的批准才能使用参考交易，因此并非所有商家都能使用此功能。

我对 Magento 不熟悉，所以我无法评论您将如何在该平台上专门实现这一点，但使用 Reference Transactions 是您将如何做到的。

[https://www.x.com/devzone/articles/recurring-payments-reference-transactions-and-preapproved-payments](https://www.x.com/devzone/articles/recurring-payments-reference-transactions-and-preapproved-payments)

[https://www.x.com/developers/community/blogs/ppintegrationsnate/express-checkout-reference-transactions](https://www.x.com/developers/community/blogs/ppintegrationsnate/express-checkout-reference-transactions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T04:09:49.310

那是负面的。PayPal 在获取付款信息​​方面非常严格。即使您找到了绕过所需重定向的方法，您也可能会在几秒钟内被 PayPal 的某个人注意到您在做什么而关闭。

更不用说这样做可能会在任何在您商店结账的人的脑海中引发危险信号，因为您所做的事情与其他任何人都不同。更铁杆的 PayPal 用户只会假设您在进行网络钓鱼（然后如果他们收到投诉，您可能会看到您的 ISP 关闭您的网站）。

我想，我想说的是，这是一个非常糟糕的主意。

# html - Chrome 不显示边框（有时）

> ID：10559039
> 
> 赞同：2
> 
> 时间：2012-05-11T21:44:25.083
> 
> 标签：html, css, google-chrome, border

所以，我的网站 (www.around-around.com) 有很多边框，它们在 Safari、FF 和 IE 上运行良好；但在 Chrome 上，它们偶尔会消失。我已经搜索了代码，这对我来说没有意义。

如果你在 FF 上[访问 http://www.around-around.com/8/](http://www.around-around.com/8/)，你会看到文章周围的边框。但在 Chrome 上，它们消失了。

相关的CSS是：

```
#page {
background: none repeat scroll 0 0 #FFFFFF;
border-left: 1px dotted #222222;
border-right: 1px dotted #222222;
margin: 0 auto;
width: 1148px;
}
.singular #primary {
margin-bottom: 0;
padding: 0 0 20px 20px;
width: 787px;
border-right: 1px dotted #222222;
float: left;
} 
```

（和#primary）

我完全感到困惑。在其他页面上，例如[http://www.around-around.com/dream-perfume/](http://www.around-around.com/dream-perfume/)，Chrome 可以很好地显示边框。代码完全相同 - 唯一的区别是帖子内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-08T18:02:25.343

我也有这个问题。Chrome 似乎不喜欢这样。

```
{border: <size> <style> <color>;} 
```

只有当我像这样单独放入参数时它才有效。

```
{
    border: <size>;
    border-style: <style>;
    border-color: <color>;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:21:48.810

我相信您正在点击[http://code.google.com/p/chromium/issues/detail?id=32702](http://code.google.com/p/chromium/issues/detail?id=32702)

**编辑**：

该错误已修复，已针对 Chromium [src@139014](http://code.google.com/p/chromium/source/detail?r=139014)进行了验证！应该在 Chrome 21 中上线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T09:56:07.113

因为 Chrome 中的默认边框样式是“无”。对于 Chrome 中的每个边框属性，您必须分配边框样式值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-18T18:45:57.947

我最近遇到了这个问题（Chrome 72），在这个 bug 在 Chromium 项目中被标记为已解决很久之后。禁用硬件加速解决了这个问题。

# android - 使用复选框刷新 CustomArrayAdaptor 中的列表视图

> ID：10559040
> 
> 赞同：1
> 
> 时间：2012-05-11T21:44:39.077
> 
> 标签：android, checkbox, android-arrayadapter

我正在尝试实现一个自定义数组适配器，它必须用一个文本和一个复选框来可视化一个列表视图。我需要记住选择，并且我希望每次选中一个选项时，所有其他选项都作为单选按钮未选中。

这是我的代码

```
public class RAnswerAdapter extends ArrayAdapter<RAnswer> {

private final ArrayList<RAnswer> list;
private final Activity context;

public RAnswerAdapter(Activity context, ArrayList<RAnswer> list) {
    super(context, R.layout.answer_item, list);
    this.context = context;
    this.list = list;
}

static class ViewHolder {
    protected TextView text;
    protected CheckBox checkbox;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View view = null;
    if (convertView == null) {
        LayoutInflater inflator = context.getLayoutInflater();
        view = inflator.inflate(R.layout.answer_item_radio, null);
        final ViewHolder viewHolder = new ViewHolder();
        viewHolder.text = (TextView) view.findViewById(R.id.answerName);
        viewHolder.checkbox = (CheckBox) view.findViewById(R.id.checkAnsw);

        viewHolder.checkbox
                .setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
                    @Override
                    public void onCheckedChanged(CompoundButton buttonView,
                            boolean isChecked) {
                        Answer element = (Answer) viewHolder.checkbox.getTag();

                        for(Answer a: list)
                            //if true
                            if(a.isSelected())
                                //I set at false
                                a.setSelected(false);

                        //I set the new at true
                        element.setSelected(buttonView.isChecked());    

                        //I refresh the list
                        notifyDataSetChanged();
                    }
                });

        view.setTag(viewHolder);
        viewHolder.checkbox.setTag(list.get(position));
    } else {
        view = convertView;
        ((ViewHolder) view.getTag()).checkbox.setTag(list.get(position));
    }
    ViewHolder holder = (ViewHolder) view.getTag();
    holder.text.setText(list.get(position).getAnswer_option());
    holder.checkbox.setChecked(list.get(position).isSelected());
    return view;
} 
```

}

代码实际上以一种奇怪的方式工作......列表的前 4 个元素工作完美，其他所有元素都无法检查！为什么这个？错误在哪里？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:40:30.730

我无法在您的代码中查明问题而无法自己进行调试。我建议向您的适配器添加一个变量来存储当前检查项目的索引，这样您就不必`list`在每次点击时进行搜索。还要在 onCheckChanged() 中添加一个 if 语句，如果答案已被选中（就像它现在的行为一样），则不采取行动，甚至允许用户取消选中当前答案。

要自己推送 ListView 的 ChoiceMode 选项，我将介绍以下内容：

```
public class Example extends Activity implements OnItemClickListener {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        String[] array = {"one", "two", "three"};
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_multiple_choice, array);

        ListView listView = (ListView) findViewById(R.id.list);
        listView.setAdapter(adapter);
        listView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
        listView.setOnItemClickListener(this);
    }

    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        Log.v("Example", "ItemClick: " + ((ListView) parent).getCheckedItemPosition());
    }
} 
```

这个应用程序简短而甜蜜。您可以设计自己的布局并将其传递给适配器，这是当前的[复选框示例](http://www.devdaily.com/java/jwarehouse/android-examples/platforms/android-2/data/res/layout/simple_list_item_multiple_choice.xml.shtml)。并且您可以在任意点引用选中行的位置（或 id 或文本）；甚至可以随时将所有答案保存在数据库中。

让我知道这些是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:19:05.973

我认为您必须在 StackOverflow 上查看这篇有用的帖子。如果您看一下，有一个指向我制作的教程的链接，这可以解决您的问题；）

[链接 CheckedListView](https://stackoverflow.com/questions/9450058/using-checkbox-to-filter-contacts-and-get-phone-number/10097399#10097399)

# jquery - 是否可以在 jQuery 中获取对实时集合的引用？

> ID：10559042
> 
> 赞同：0
> 
> 时间：2012-05-11T21:44:50.550
> 
> 标签：jquery

我有一个简单的表格，有 1 行开始。

```
<table>
    <tr id="tr1">
        <td>ROW 1</td>
        <td>ROW 1</td>
    </tr>
</table> 
```

每个都`tr`监听一个点击事件。单击表格行后，我想获得表格中的行数，而不必不断地重新查询它。jQuery 是否在某处存储了当前的集合，`tr's`如果是，我如何访问它？

```
$("table").on("click", "tr", function(e){

    $("#output").html("click on row with id " + $(this).attr("id") + "<br>")

        $("#output").append("Number of rows" + $("table").find("tr").size())
        // instead of "live" requerying $("table").find("tr") is there another way to get to all tr's

});

// more code...

$("table").append("<tr id='tr2'><td>ROW 2</td><td>ROW 2</td></tr>"); 
```

编辑：要清楚，获取行数只是一个例子。我实际上还需要对集合执行其他操作

请参阅此处的示例：http: [//jsfiddle.net/Flandre/Ed4pp/2/](http://jsfiddle.net/Flandre/Ed4pp/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:50:03.147

简短回答**否**，没有实时查询来维护表的长度。

由于它是一个动态表，您可以在其中添加行/删除行，因此您必须重新查询

`$("table").find("tr").length //(note not size()).`

如果未将其设置为处理程序外部的 var 并在添加/删除行时更新它。

```
var rowCount = $("table").find("tr").length;
$("table").on("click", "tr", function(e) {
    $("#output").html("click on row with id " + $(this).attr("id") + "<br>")
    $("#output").append("Number of rows" + rowCount);

});

function addRow() {
    // add a row to the table
    $("table").append("<tr id='tr2'><td>ROW 2</td><td>ROW 2</td></tr>");
    rowCount++; //Manually :P
}

addRow(); 
```

[**演示**](http://jsfiddle.net/skram/Ed4pp/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:50:32.303

尝试：

```
$("table tr").on("click", function(e){ 
```

代替：

```
$("table").on("click", "tr", function(e){ 
```

和这个：

```
$("#output").append("Number of rows" + $("table").find("tr").size()) 
```

应该：

```
$("#output").append("Number of rows" + $("table tr").length) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:50:51.523

我不相信 jQuery 会跟踪这些事情。当您使用委托事件处理程序时，唯一的处理程序放置在选定元素 ( `table`) 上。当用户单击 a`tr`时，事件会在 DOM 树中冒泡，直到到达`table`处理事件的位置。

如果您想在`tr`不进行轮询的情况下保持该数量的 s 最新，您可以查看突变事件：[http://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events。 html#Events-MutationEvent](http://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-MutationEvent)

这是一个插件，不知道它是否有什么好处：[https ://github.com/jollytoad/jquery.mutation-events](https://github.com/jollytoad/jquery.mutation-events)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T21:53:14.003

我会这样做：http: [//jsfiddle.net/mkjkm/](http://jsfiddle.net/mkjkm/)

```
var table = $("table")[0];
$(table).on("click", "tr", function(e) {

    $("#output").html("click on row with id " + this.id + "<br>")

    $("#output").append("Number of rows" + table.rows.length)
    $(table).append("<tr id='tr" + (table.rows.length + 1) + "'><td>ROW " + (table.rows.length + 1) + "</td><td>ROW " + (table.rows.length + 1) + "</td></tr>");
}); 
```

DOM 将给定表中所有行的集合保存在表的 DOMElement 上。

# windows - 从通过 Windows 任务计划程序运行的 Perl 脚本生成的进程无权访问 %PATH%

> ID：10559050
> 
> 赞同：3
> 
> 时间：2012-05-11T21:45:39.637
> 
> 标签：windows, path, scheduled-tasks

我有一个使用反引号在 Windows 上调用程序的 Perl 脚本。当我在命令提示符下运行它时，它工作正常。当我使用 Windows 任务调度程序运行它时它停止工作。这是在带有 ActiveState Perl 的 Windows Server 2008 x64 上。它给我一个错误，无法识别为内部或外部命令、可运行程序或批处理文件。一旦我改变对程序的调用以指向程序的完整路径，它就会再次工作。

因此，当它在带有反引号的任务计划中运行时，它会阻止它看到 Windows 环境变量，特别是运行时的 %PATH% 变量。反引号产生的外壳中可能缺少某些东西？我应该使用不同的命令来执行系统调用吗？还是有一个任务计划程序设置可以解决这个问题？如果有人可以提供帮助，我将不胜感激。

老实说，我的环境比这更复杂，但这就是我将其缩小到的范围。我实际上有一个带有批处理文件的任务计划，该批处理文件运行一个 php 脚本，该脚本本身运行 perl 脚本，然后运行该程序。我之前没有提到的堆栈的其余部分似乎可以访问 %PATH%，因此批处理文件运行“php ...”并且 php 脚本运行“perl ...”然后 perl 脚本失败使用反引号运行“程序名”时。我已经剥离了批处理文件和 php 脚本，并且仅使用任务调度程序和 perl 的行为仍然存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T18:38:49.757

从 perl 中运行路径基本上帮助我解决了这个问题。问题不在于 perl 本身，而是在重新启动任务调度程序服务之前，对 %PATH% 变量的更改不会显示给任务调度程序。据我所知，如果不重新启动机器，就无法重新启动任务调度程序。所以程序路径在任务计划中运行时没有显示，而是显示在命令行中。

我找到了两个解决方案。

一种是重新启动机器。

第二个是确保您的任务计划设置为“无论用户是否登录都运行”（与该选项最接近的命令行参数是 schtasks 的 /NP 参数）由于某种原因，在该场景中运行计划会给出它访问当前的 %PATH% 变量。我不确定，但我认为这会破坏需要与桌面交互的脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:26:22.803

如果您具有管理权限，则可以定义系统范围的`%PATH%`. 用户对其`%PATH%`进行增强。以用户帐户在系统上运行的常规程序应该能够在系统范围内看到`%PATH%`。

我不知道您是从 GUI 还是使用 计划任务`AT`，但[计划的作业无法访问用户环境变量](http://support.microsoft.com/KB/124621)可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:45:38.480

我刚刚遇到了同样的问题，或者至少是类似的问题。我不会告诉你我调查的血腥细节。解决方案是 UAT 挡道了。

我的 Windows 7 机器上有本地管理员权限。我必须进入管理工具>本地安全策略>安全选项并启用用户帐户控制：在管理员批准模式下运行所有​​管理员。重新启动 - 瞧。我的脚本现在在任务计划程序中运行。

希望这可以帮助

# android - ScrollView 不拉伸 ImageView 以适应屏幕？

> ID：10559051
> 
> 赞同：0
> 
> 时间：2012-05-11T21:45:39.510
> 
> 标签：android, android-layout, android-widget, scrollview, imagebutton

我正在使用 ScrollView 来保存和显示一个静态地图图像，它的大小为 480 px x 904 px，并且我可以上下滚动来查看地图。我已经实现了 ScrollView 应该适合并填满屏幕。但是，它似乎无法拉伸地图图像以适应屏幕，我不确定我做错了什么。地图图像是一个 9-patch 图像，其中仅允许拉伸右边缘。

这是 XML 代码：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/rlayoutResultMap"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:padding="0dp" >

    <ScrollView
        android:id="@+id/scrollResultMap"
        android:fillViewport="true" 
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_alignParentTop="true"
        android:layout_alignParentLeft="true"
        android:scrollbars="none" >

        <RelativeLayout
            android:id="@+id/rlayoutScrollMap"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" >

            <ImageView
                android:id="@+id/imgResultMap"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_alignParentTop="true"
                android:src="@drawable/map_base"/>

        </RelativeLayout>
    </ScrollView>

    <ImageButton
        android:id="@+id/btnBack"
        android:layout_width="40dp"
        android:layout_height="40dp"
        android:background="@android:color/transparent"
        android:contentDescription="@string/btnBack_desc"
        android:scaleType="centerInside"
        android:src="@drawable/back_button" />

    <TextView
        android:id="@+id/tickerWeather"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:background="#80000000"
        android:ellipsize="marquee"
        android:marqueeRepeatLimit="marquee_forever"
        android:scrollHorizontally="true"
        android:singleLine="true"
        android:text="@string/weather_feed_init_text"
        android:textColor="#ffffffff" />

    <ImageView
        android:id="@+id/imgMapZoom"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/tickerWeather"
        android:layout_alignParentRight="true"
        android:layout_marginBottom="5dp"
        android:layout_marginRight="10dp"
        android:src="@drawable/map_zoom_icon" />

</RelativeLayout> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:50:04.260

尝试`scaleType`在您的 上使用属性`ImageView`，[这里](http://developer.android.com/reference/android/widget/ImageView.ScaleType.html)是文档。

# svn - 如何将 SVN 工作副本中的修改保存到 zip 文件

> ID：10559054
> 
> 赞同：5
> 
> 时间：2012-05-11T21:45:50.230
> 
> 标签：svn, tortoisesvn, zipfile

我正在使用 svn，有时我需要恢复一些不顺利的更改。我想先对更改的文件进行压缩。我希望 zip 有完整的路径。我大部分时间都在使用 TortoiseSVN，但如果需要，我并不害怕使用命令行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T21:22:09.703

您可以只使用一个简单的 bash 单行代码（前提是您是 Linux 快乐用户）：

`zip ~/modified.zip $(svn status | grep ^M | awk '{ print $2;}')`

这将提取所有状态为 M so Modified 的文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-08-30T12:18:11.873

在**TourtoiseSVN 检查修改对话框中**

*   选择你想要的文件
*   右键点击
*   然后 shell 上下文菜单将它们发送到 7zip

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T22:21:42.337

[您可以购买WinZip](http://www.winzip.com)的副本，或使用开源的[7-Zip](http://www.7-zip.org/)。两者都包含命令行版本，可以满足您的需求。它们都支持用作 Windows shell 扩展，这意味着您可以从 Windows 资源管理器中选择一个或多个文件，右键单击并从上下文菜单中执行压缩选项。（或者比使用您发布的拖放解决方案更好，顺便说一句。）

这两种产品都包含关于从命令行使用它们的非常好的文档，如果这是您选择的选项。

借助 7-Zip 的外壳支持，您`Shift+Click`可以`Ctrl+Click`选择文件，然后右键单击其中任何一个并`7-Zip->Add to archive...`从上下文菜单中进行选择。然后，您可以选中包含路径信息的选项。

WinZip 包含与 Windows shell 类似的功能，尽管我已经多年没有使用它并且无法给出具体的说明。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-03T05:48:14.793

这很粗糙，但很有效。

```
@echo ================================================
@echo ZIPS all modified or added svn controlled files
@echo to the specified  zip file
@echo "svnzipmodified <filename>"
@echo ================================================
@if "%1"=="" goto end
@echo Getting list of modified or added files
@echo ================================================
svn status -q > list.txt
@echo Strip status text to leave path and filename
@echo ================================================
find "M    " list.txt > list2.txt
find "A    " list.txt >> list2.txt
(for /F "tokens=1,2*" %%i in (list2.txt) do @echo %%j) > list3.txt
@echo Zip up files
@echo ================================================
del %1 /Q
"C:\Program Files\MATLAB\R2010a\bin\win64\zip.exe" %1 -@ < list3.txt

pause
del list3.txt /Q
del list2.txt /Q
del list.txt /Q
@echo Done
@echo ================================================

:end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-11T22:01:33.313

您可以将本地更改保存到文件中：

```
svn diff > my_changes.patch 
```

以后可以通过以下方式恢复这些更改：

```
patch -p0 < my_changes.patch 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-19T18:10:37.140

我喜欢这个解决方案，因为它可以在 Windows 和 Mac 上稍作修改。

下载命令行颠覆客户端。[在 Windows 上，请在http://sliksvn.com/en/download/](http://sliksvn.com/en/download/)上查看 SlikSVN， 因为 TortoiseSVN 不提供。

如果没有，请下载 Python 3.x。

下载 7zip 并将其添加到您的路径中。

执行：

```
import os
import re
import subprocess
import time

re_svn = re.compile(r'(.)\s+(.+)$')
files = []

for line in os.popen('svn status -q').readlines():
    match = re_svn.match(line)
    if match:
        files.append(match.group(2))

if len(files) > 0:
    subprocess.call(['7z','a',time.strftime('%Y%m%d-%H%M%S') + '.zip'] + files) 
```

注意：学习 Python，但这似乎可行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-13T10:38:25.043

在 linux 中，你会这样做。

svn diff -r REV:HEAD --summarize | sed 's/[A-Za-z][ ]+//' | xargs 压缩 myfiles.zip

其中 REV 是您要开始的修订号。通常在您退房时。

来源：[http ://www.semicolon.co.za/linux/get-list-of-changed-tiles-via-svn-diff-and-zip-them.html](http://www.semicolon.co.za/linux/get-list-of-changed-tiles-via-svn-diff-and-zip-them.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-11T22:28:22.893

好的，我找到了一种方法，但对此并不完全满意。我正在回答我自己的问题，但我希望有人可以改进它。

1.  使用 WinZip 创建一个空的 zip 文件**，并**选择包含完整路径信息。在 WinZip 中打开 zip。我无法弄清楚如何使用本机 Windows zip 实用程序执行此操作。
2.  在工作副本中，使用 TourtoiseSVN 上下文菜单打开检查修改对话框。
3.  选择对话框中的所有文件并将它们拖放到 WinZip 中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-19T19:21:46.673

如果您可以同意在撤消之前提交（到*某个不同的地方*）这些更改（变为 just `svn up PREV-REV`），您可以使用任何[“文件在修订中更改”技巧](https://stackoverflow.com/a/13063724/960558)

对于 TortoiseSVN 最新的 GUI 方式（[“仅在版本之间导出 TortoiseSVN 中更改的文件”](http://www.electrictoolbox.com/tortoisesvn-exporting-changed-files/)）可能是您的首选方法

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-08-07T13:35:42.647

尽管[Boscabouter 的回答](https://stackoverflow.com/a/39227294/1496037)在一台机器上对我来说效果很好，但我注意到在另一台机器上*TortoiseSVN*在其上下文菜单中没有*Shell条目。*因此，我无法轻松地将*检查修改*对话框中的文件发送到*7zip*。

根据[Ken White 的输入](https://stackoverflow.com/a/10559346/1496037)，我使用命令行将文件移动到存档：

1.  打开*TortoiseSVN* *检查修改*对话框，例如从存储库的基本目录中
2.  标记您感兴趣的所有文件，右键单击任何文件并选择*复制路径到剪贴板*
3.  将路径粘贴到临时文本文件中，例如`filelist.txt`，在同一目录中
4.  在该目录中打开终端（例如 Shift + 右键单击​​ Windows Explorer 中的该文件夹，然后选择*Open command prompt*）
5.  跑`"%ProgramFiles%"\7-Zip\7z a -tzip modified.zip @filelist.txt`

作为步骤 1 - 3 的替代方法，您可以`svn status | find "M " > filelist.txt`使用文本编辑器运行并删除不需要的行/字符。

# html - 调整视图宽度，使用 CSS 保持图像纵横比

> ID：10559058
> 
> 赞同：1
> 
> 时间：2012-05-11T21:46:08.280
> 
> 标签：html, css, responsive-design, aspect-ratio

当您在 Google+ 上的“灯箱”图像上调整浏览器的大小时，我注意到图像是如何缩放的，我对此很感兴趣：https: [//plus.google.com/](https://plus.google.com/)。

下面是一个jsfiddle，当您调整浏览器宽度时，只会调整图像宽度和纵横比的大小：http: [//jsfiddle.net/trpeters1/mFPTq/1/](http://jsfiddle.net/trpeters1/mFPTq/1/)

有人可以帮我弄清楚 CSS 在保留此图像的纵横比方面会是什么样子吗？

如果您不想查看 jsfiddle，请查看 HTML：

```
<div id="imgWrapper" >
  <div id="titleContainer">title container
  </div>
  <div id="imgContainer"  >    
        <img id="mainImg" src="https://lh4.googleusercontent.com/-f8HrfLSF2v4/T609OOWkQvI/AAAAAAAAGjA/waTIdP4VkMI/s371/impact_of_early_exposure_to_D%26D.jpg">    
  </div>
</div>​ 
```

这是CSS：

```
 #imgWrapper{
  background:gray;
  width:80%;
  height:80%;
  border-radius:5px;
  border:1px solid gray;
 }
 #imgContainer{
   width:100%;
   height:100%;    
 }
#titleContainer{
  background:yellow;
  border-radius:5px;
  border:1px solid gray;
}
#mainImg{
  width:100%;
  height:61.8%;    
}​ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T21:48:08.083

如果我对您的理解正确，只需将`img`所有高度一起删除即可。

[http://jsfiddle.net/mFPTq/2/](http://jsfiddle.net/mFPTq/2/)

```
#mainImg{
    width:100%;
    /* NO HEIGHT height:61.8%; */
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-26T21:51:18.210

有时浏览器会缩放高度......我遇到了这个问题，所以我要做的就是解决这个问题：

```
 <style> 
 img{ max-width:100%; height:auto; }
 </style> 
```

# android - 如何检查铃声是否存在？

> ID：10559061
> 
> 赞同：0
> 
> 时间：2012-05-11T21:46:33.647
> 
> 标签：android, backup, ringtone

在我的应用程序中，我将用户选择的铃声存储在 SharedPreference 文件中。当重新安装应用程序并[恢复备份](http://developer.android.com/guide/topics/data/backup.html)时，我想检查设备上是否仍然存在铃声，因为如果不存在，我想使用默认铃声（而不是什么都不播放）。

为此，我计划覆盖该`onRestore`方法并检查设备上是否有可用的铃声。

那么我该如何检查Android设备上是否存在铃声（我更喜欢最轻量级的方法）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:46:32.503

假设您将铃声存储为一个`content://` `Uri`值，我会使用`openInputStream()`or `getType()`on `ContentResolver`。`getType()`可能是“最轻量级的”，但它可能容易出现误报（例如，铃声存在但由于某种原因无法确定 MIME 类型）。

# shell - 子命令抛出时终止makefile命令？

> ID：10559064
> 
> 赞同：7
> 
> 时间：2012-05-11T21:46:46.913
> 
> 标签：shell, makefile

我有以下 Makefile：

```
#runs the working directory unit tests
test:
    @NODE_ENV=test; \
        mocha --ignore-leaks $(shell find ./test -name \*test.js);

#deploys working directory
deploy:
    @make test; \
    make deploy-git; \
    make deploy-servers;

#deploys working to git deployment branch
deploy-git:
    @status=$$(git status --porcelain); \
    if test "x$${status}" = x; then \
        git branch -f deployment; \
        git push origin deployment; \
        echo "Done deploying to git deployment branch."; \
    else \
        git status; \
        echo "Error: cannot deploy. Working directory is dirty."; \
    fi

deploy-servers:
#   for each server
#       @DEPLOY_SERVER_IP = "127.0.0.1"; \
#       make deploy-server

#deploy-server:
#   connect to this server with ssh
#   check if app is already running
#   stop the app on the server if already running
#   set working directory to app folder
#   update deployment git branch
#   use git to move head to deployment branch
#   start app again 
```

请注意，`deploy-servers`并且`deploy-server`现在只是假人。这是`deploy`命令应该做的：

1.  运行测试（`make test`），失败退出
2.  将当前头推送到部署分支（`make deploy-git`），失败退出
3.  拉取服务器上的部署分支 ( `make deploy-servers`)

您可以在 Makefile 中将其视为：

```
deploy:
    @make test; \
    make deploy-git; \
    make deploy-servers; 
```

问题是我不确定如何防止`make deploy-git`在`make test`失败时执行，以及如何防止`make deploy-servers`在测试失败或`make deploy-git`失败时执行。

有没有明确的方法可以做到这一点，或者我应该求助于使用 shell 文件或用普通的编程语言编写这些工具？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-11T22:03:21.267

shell 命令*列表*的退出状态是列表中最后一个命令的退出状态。只需将您的命令列表转换为单独的*简单命令*即可。默认情况下，`make`当命令返回非零时停止。所以你得到你想要的

```
deploy:
    @make test
    make deploy-git
    make deploy-servers 
```

如果你**想**忽略一个简单命令的退出状态，你可以在它前面加上一个破折号：

```
 target:
     cmd1
     -cmd2 # It is okay if this fails
     cmd3 
```

您的`make`手册包含所有详细信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-12T01:01:53.530

其他人给出的答案是基于将“配方”分成单独的命令。

在不可行的情况下，您可以做的是`set -e`在 shell 脚本中使其在命令失败时终止：

```
target:
        set -e ; \
          command1 ; \
          command2 ; command3 ; \
          ... commandN 
```

这与`set -e`您将放置在 shell 脚本顶部附近以使其在某些命令未成功终止时保释的方式相同。

假设我们对 和 的终止状态不`command2`感兴趣`command3`。假设这些指示失败或不可靠地使用终止状态是可以的。然后，`set -e`我们可以编写显式退出测试，而不是编写代码：

```
target:
        command1 ; \
        command2 || exit 1 ; \
        command3 ; \
        true  # exit 0 will do here also. 
```

由于`command3`可以指示失败，并且我们不希望它使我们的构建失败，因此我们添加了一个成功的虚拟命令。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T21:49:24.080

`make`应该已经这样做了；它使用 执行复杂`sh -e`的命令，如果命令非零退出（只要它不在与 POSIX 兼容的 shell 中的循环中），它将中止执行，并在`Makefile`命令失败时中止整个命令，除非您明确告诉它不要这样做。如果您感到偏执，可以在命令中使用`&&`代替。`;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-24T07:05:42.883

我通过在潜在断点处代理到新的 make 命令解决了这个问题：

```
.PHONY cmd_name cmd_name_contd

cmd_name:
    if [ "`pwd`" = "/this/dir" ]; then make cmd_name_contd; fi

cmd_name_contd:
    @echo "The directory was good, continuing" 
```

这样，如果目录错误，它只是静默退出，您还可以添加带有消息的 else 条件以在失败时显示。

# duplicates - 列计数重复一次的平均值 - PowerPivot + DAX

> ID：10559068
> 
> 赞同：1
> 
> 时间：2012-05-11T21:47:20.163
> 
> 标签：duplicates, average, powerpivot, dax

我在 PowerPivot 中有一个列，我想获得它的平均值。但是，我只希望包含的行是值的唯一实例或另一列中重复值的第一个实例。这可能与 DAX 吗？

简单地说，我需要唯一行的列平均值，确定另一列的唯一性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-15T06:46:18.047

可能会帮助到老，但对于那些偶然发现的人：

您需要创建两个度量。第一个将汇总您尝试通过另一列中的不同值进行平均的任何内容。

* * *

| 编号 | 海蜇|
| 01 | 100 |
| 01 | 110 |
| 02 | 90 |
| 03 | 100 |
| 03 | 90 |

* * *

因此 id=1 的总 squilla 为 210，id=2 花费为 90，id=3 花费为 190。不同的平均值（其中 id 是标识符）为 163.333

要在 powerpivot 中执行此操作，首先创建一个按 id 对 squilla 求和的度量： Measure1:=CALCULATE(SUM('yourTable'[squilla]),VALUES('yourTable'[id]))

第二个在 id 上对其进行平均：Measure2:=AVERAGEX(DISTINCT('yourTable'[id]),[Measure1])

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-01T16:40:46.127

我对 OP 问题的理解是这样的：

```
| 编号 | 年龄 |
| -- | --- |
| 1 | 20 |
| 1 | 20 |
| 2 | 50 |
| 3 | 35 |
| 3 | 35 |

```

在这种情况下，a 建议的求和平均值 (40 + 50 + 70)/3 是不合适的。

然而，平均平均值 ((40/2) + (50/1) + (35/2))/3 将是确定按 id 分组的不同平均值的解决方案。
`Measure:=AVERAGEX(VALUES(table[id]), CALCULATE(AVERAGE(table[age])))`

# apache - python3.2安装mod_wsgi

> ID：10559071
> 
> 赞同：2
> 
> 时间：2012-05-11T21:47:55.157
> 
> 标签：apache, debian, mod-wsgi, wsgi, python-3.2

我正在尝试在 Debian 6 (Squeeze) 上为 Python 3.2 安装 mod_wsgi。

首先我从默认存储库安装了 libapache2-mod-wsgi-py3，它适用于 Python3.1，然后我添加到 source.list

```
*deb http://ftp.de.debian.org/debian wheezy main* 
```

并再次调用*apt-get install libapache2-mod-wsgi-py3*。在 wsgi 中的 sys.version 之后返回 3.2.3。

它是真正的 mod-wsgi 与 Python3.2 一起工作还是只是错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T00:09:59.227

如果希望使用 Python 3.2，您必须从 mod_wsgi 源代码存储库中的源代码编译 mod_wsgi。发行版的最后一个 tar 球和二进制包不支持 3.2。

# php - 如何在 MYSQL/PHP 中显示两位小数？

> ID：10559075
> 
> 赞同：3
> 
> 时间：2012-05-11T21:48:14.007
> 
> 标签：php, mysql, double

我想显示**£2.00**而不是**£2**或**£3.50**而不是**£3.5**。

假设这些数字是在 MySQL 数据库`price`中定义的。`DOUBLE`如何强制 MySQL 或 PHP 显示两位小数？

非常感谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T21:58:42.750

对于 MySQL，您可以使用以下`format`函数：

```
SELECT FORMAT(1.2345, 2); 
```

它将返回 1.23

对于 PHP，您可以`number_format`以类似的方式使用：

```
echo number_format(1.2345, 2); 
```

还打印 1.23

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-11T21:50:51.117

尝试这个：

```
echo number_format ($price, 2); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-11T21:50:01.947

[`number_format`](http://php.net/manual/en/function.number-format.php)并且[`money_format`](http://php.net/manual/en/function.money-format.php)是你的朋友！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-11T23:22:12.143

其他答案是正确的，因为它们会将值*格式化*为两位小数。

但是，鉴于您问题中的上下文，更好的答案是**不要使用`DOUBLE`数据类型**- 至少，不是为了这个目的。

像[浮点数据类型](http://dev.mysql.com/doc/en/floating-point-types.html)`DOUBLE`是*近似*的，不代表精确的数字；它们对于表示质量或长度等连续量很有用。对于像货币这样的离散数量，它们可能是灾难性的，导致非常意想不到的结果。对于这样的数量，您*确实*应该使用 MySQL 的[定点类型](http://dev.mysql.com/doc/en/fixed-point-types.html)，例如`DECIMAL`，它使您能够指定*比例*（即要存储的小数位数），因此不需要任何此类格式或舍入来生成正确的货币值。

# php - CodeIgniter DataMapper ORM 无法实例化模型对象

> ID：10559076
> 
> 赞同：3
> 
> 时间：2012-05-11T21:48:19.987
> 
> 标签：php, mysql, codeigniter, orm, codeigniter-datamapper

我正在创建一个这样的模型对象： $object1 = new Object1(); 数据库中有一个名为 object1s 的表。Object1 类是一个扩展 DataMapper 的空类。这没有问题。我能够保存数据，并从数据库中检索数据（我可以使用单独的数据库客户端查看它）。

我尝试对另一个对象（和不同的表）做同样的事情，例如，$object2 = new Object2(); 这次我收到以下错误消息：

> 致命错误：在第 6049 行的 /Applications/XAMPP/xamppfiles/htdocs/c/application/libraries/Datamapper.php 中的非对象上调用成员函数 line()

第 6049 行如下所示：

> 返回 $this->lang->line($key);

当我实例化 Object1 时，此时 $this->lang 被设置为 DM_Lang 的一个实例，但在实例化第二个对象时，$this->lang 被设置为“en”。两者之间的唯一区别是名称和数据库表。

我能做些什么来解决这个问题？为什么它们不同？$this->lang 设置在哪里（我已经使用调试器逐步完成但找不到它）？

数据库是 MySQL。我在 MacOSX Lion 上运行它是为了开发目的。网络服务器是 apache。我正在使用 DataMapper ORM v1.8.2。

* * *

有一条评论要求提供有问题的确切代码。这是我测试的完整代码（我从每个文件中复制并粘贴）。

Object1 被称为 Movie，models/movie.php：

```
<?php

class Movie extends DataMapper {

} 
```

对象 2 称为 Image，models/image.php：

```
<?php

class Image extends DataMapper {

} 
```

控制器看起来像这样，controllers/test.php：

```
<?php

class Test extends CI_Controller {

    public function newdata()
    {
        // The following line runs as expected
        $movie = new Movie();
        // The following line fails with the Fatal error mentioned above
        $image = new Image();

    }

} 
```

* * *

我按照 DataMapper v1.8.2 附带的安装说明进行操作。在加载 CodeIgniter 引导文件之前，我的 index.php 文件包含以下内容。

```
/* --------------------------------------------------------------------
 * LOAD THE DATAMAPPER BOOTSTRAP FILE
 * --------------------------------------------------------------------
 */
        require_once APPPATH.'third_party/datamapper/bootstrap.php'; 
```

它与 Movie 对象配合得非常顺利。我能够向其中写入数据并使用单独的 SQL 查询工具验证它是否存在。

我刚刚注意到，如果“$movie = ...”行被注释掉，“$image = ...”行运行没有错误。但是，我需要它们两者才能使我的应用程序正常运行。

我正在使用 CI_VERSION=2.1.0。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:11:10.327

在切换到 CodeIgniter 之前已经使用了数据库模式。第一个表有名称冲突（它使用“lang”作为字段名称）。第二个表没有冲突，并且失败只是因为它是出现问题的模型对象之后的下一个 DataMapper 子类实例化。我的注意力集中在失败的桌子/模型上，而实际上是成功的桌子/模型出现了问题。

解决方法是检查所有模型对象是否存在冲突，而不仅仅是失败的模型对象。

# ruby-on-rails - Rails nested_form 排序

> ID：10559078
> 
> 赞同：6
> 
> 时间：2012-05-11T21:48:47.230
> 
> 标签：ruby-on-rails, nested-forms

我正在使用 Ryan Bates [nested_form gem](https://github.com/ryanb/nested_form)。我希望能够控制它列出嵌套字段的顺序。我有一个可以工作的 default_scope，但我需要根据场景对此进行更多控制。

理想情况下像

```
# In controller action
@nesties = Nesty.order("name desc")

# In view
# If @nesties defined the following line would respect the @nesties ordering
f.fields_for :nesties do |nestie-form| 
```

现在它将尊重 default_scope 排序，但我找不到任何其他方式来控制排序。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-16T00:24:42.990

请注意，它`fields_for`接受第二个参数，这就是在指定要使用的对象/关联时可以指定命名范围的地方。以下对我有用。导轨 3.x

```
#In Model Nestie
scope :ordered_nesties, order("name DESC")
belongs_to :parent

#In Model Parent
has_many :nesties

#In View
f.fields_for :nesties, @parent.nesties.ordered_nesties do |nestie-form| 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-11T23:04:44.963

在具有 nesties 关联的模型中：

```
has_many :nesties, :order => "name DESC" 
```

不过，这对于您的应用来说可能过于全球化。

但基本的事情是 fields_for 不接受@nesties 它接受父表单模型的关联。

编辑：不确定这是否适用于nested_form gem，但此解决方案不会影响nesties 关联的正常排序：

```
named_scope :ordered_nesties, :order => "name DESC" 
```

然后

```
f.fields_for :ordered_nesties do |nestie-form| 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-30T18:12:25.360

仅供参考，这件事对我有用，但没有制作范围

```
f.fields_for :nesties, @parent.nesties.ordered("name DESC") do |nestie-form| 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-05T23:03:07.640

我能够使用以下方法对我的嵌套表单对象进行排序。希望它可以帮助别人......

```
<%= form.nested_fields_for :evaluations, 
      form.object.evaluations.target.sort_by! { |e| e.skill.sort } do |f| %> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-20T16:43:32.767

nested_form gem 似乎有一个奇怪的行为（在我看来这是一个错误）。当给定一个要渲染的集合时 - 它在渲染之前按“id”对其进行排序。它对大多数人来说可能是透明的，但在某些情况下却很不愉快。

Shantanu 上面给出的解决方案通过直接将集合提供给 fields_for 进行渲染并有效地绕过nested_forms 迭代器来解决该问题。

我浪费了 2 个多小时试图解决这个问题。谢谢 Shantanu！

# json - 使用 Delphi 2012 反序列化嵌套 json 对象

> ID：10559080
> 
> 赞同：2
> 
> 时间：2012-05-11T21:49:04.300
> 
> 标签：json, delphi, unmarshalling

我正在为 delphi 2012 中的 Dropbox 开发一个包装器。我遇到的问题是反序列化 json 响应。当我请求我的帐户中的文件夹和文件列表时，我收到如下所示的响应：

```
{
    "hash": "some_hash",
    "thumb_exists": false, 
    "bytes": 0,
    "path": "/", 
    "is_dir": true, 
    "size": "0 bytes", 
    "root": "dropbox", 
    "contents": 
    [
        {
            "revision": 11, 
            "rev": "b074cbcbb", 
            "thumb_exists": false, 
            "bytes": 0, 
            "modified": "Mon, 23 Apr 2012 19:19:27 +0000", 
            "path": "/Apps", 
            "is_dir": true, 
            "icon": "folder", 
            "root": "dropbox", 
            "size": "0 bytes"
        }, 
        {    
            "revision": 142, 
            "rev": "8e074cbcbb", 
            "thumb_exists": false, 
            "bytes": 0, 
            "modified": "Wed, 09 May 2012 22:55:44 +0000", 
            "path": "/code", 
            "is_dir": true, 
            "icon": "folder", 
            "root": "dropbox", 
            "size": "0 bytes"
        },
        {
            "revision": 7,
            "rev": "7074cbcbb", 
            "thumb_exists": false, 
            "bytes": 246000, 
            "modified": "Mon, 23 Apr 2012 18:40:51 +0000", 
            "client_mtime": "Mon, 23 Apr 2012 18:40:52 +0000", 
            "path": "/Getting Started.pdf", 
            "is_dir": false, 
            "icon": "page_white_acrobat", 
            "root": "dropbox", 
            "mime_type": "application/pdf", 
            "size": "240.2 KB"
        }
    ],
    "icon": "folder"
} 
```

我希望能够使用 TJSONUnMarshal 对象来解析它，但事实证明 TJSONUnMarshal 期望 json 看起来像这样：

```
{
"type":"DropboxApiU.TFile",
"id":1,
"fields":
{
    "hash": "some_hash",
    "thumb_exists": false, 
    "bytes": 0,
    "path": "/", 
    "is_dir": true, 
    "size": "0 bytes", 
    "root": "dropbox", 
    "contents": 
    [
        {
            "type":"DropboxApiU.TFile",
            "id":1,
            "fields":
            {
                "revision": 11, 
                "rev": "b074cbcbb", 
                "thumb_exists": false, 
                "bytes": 0, 
                "modified": "Mon, 23 Apr 2012 19:19:27 +0000", 
                "path": "/Apps", 
                "is_dir": true, 
                "icon": "folder", 
                "root": "dropbox", 
                "size": "0 bytes"
            }
        }, 
```

我看过[这个](http://www.danieleteti.it/2009/09/01/custom-marshallingunmarshalling-in-delphi-2010/)页面，认为它可能是我要找的东西，但它从来没有真正涉及如何使用 TTypeObjectReverter （我认为这是我需要使用的）而且我似乎找不到网上的例子。

实现这一目标的最佳方法是什么？我希望我可以只写一个 TTypeObjectReverter 或类似的东西，但我需要查看一个示例才能理解它。

**编辑** 这是两者之间差异的屏幕截图。红色不是在 Dropbox 服务器的响应中发送的，而是解组器所期望的。

![差异](../Images/bc15b13b5714c97340cf4c92f007896c.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T12:05:21.337

你可以使用我的[SvSerializer](http://code.google.com/p/sv-utils/source/browse/trunk/SvSerializer/SvSerializer.pas)类来完成这个任务。首先，您需要定义要序列化/反序列化的类，例如：

```
TDropbox = class
  private
    FHash: string;
    Fthumb_exists: Boolean;
    Fbytes: Integer;
    Fpath: string;
    Fis_dir: Boolean;
    FSize: string;
    Froot: string;
    Fcontents: TArray<TContent>;
    Ficon: string;
  public
    [SvSerialize]
    property Hash: string read FHash write FHash;
    [SvSerialize]
    property thumb_exists: Boolean read Fthumb_exists write Fthumb_exists;
    [SvSerialize]
    property bytes: Integer read Fbytes write Fbytes;
    [SvSerialize]
    property path: string read Fpath write Fpath;
    [SvSerialize]
    property is_dir: Boolean read Fis_dir write Fis_dir;
    [SvSerialize]
    property size: string read FSize write FSize;
    [SvSerialize]
    property root: string read Froot write Froot;
    [SvSerialize]
    property contents: TArray<TContent> read Fcontents write Fcontents;
    [SvSerialize]
    property icon: string read Ficon write Ficon;
  end;

TContent = record
  private
    frevision: Integer;
    Frev: string;
    Fthumb_exists: Boolean;
    Fbytes: Integer;
    fmodified: string;
    fclient_mtime: string;
    fpath: string;
    fis_dir: Boolean;
    ficon: string;
    froot: string;
    fmime_type: string;
    fsize: string;
  public
    property revision: Integer read frevision write frevision;
    property rev: string read Frev write Frev;
    property thumb_exists: Boolean read Fthumb_exists write Fthumb_exists;
    property bytes: Integer read Fbytes write Fbytes;
    property modified: string read fmodified write fmodified;
    property client_mtime: string read fclient_mtime write fclient_mtime;
    property path: string read fpath write fpath;
    property is_dir: Boolean read fis_dir write fis_dir;
    property icon: string read ficon write ficon;
    property root: string read froot write froot;
    property mime_type: string read fmime_type write fmime_type;
    property size: string read fsize write fsize;
  end; 
```

然后将 TDropbox 对象的实例添加到序列化程序：

```
FSerializer := TSvSerializer.Create();
FDropboxFile := TDropbox.Create;
FSerializer.AddObject('', FDropboxFile); 
```

现在你可以通过 SvSerializer 序列化/反序列化这个对象：

```
FSerializer.DeSerialize(mmo1.Lines.Text{your json string, stream or filename}, TEncoding.UTF8{if it is string you must specify the encoding});
//After this line your FDropBoxFile's properties are filled from your json string 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-12T00:08:31.420

也许您可以尝试使用[Progdigy 的 JSON Wrapper](http://www.progdigy.com/?page_id=6)代替？

# android - 每个项目上都有进度条的listView？

> ID：10559081
> 
> 赞同：5
> 
> 时间：2012-05-11T21:49:05.057
> 
> 标签：android, listview, progress-bar

我有一个 listView 并且在每个项目上我都添加了一个 progressBar，它需要在图像下载后消失。但我找不到办法做到这一点。我试图让它在 getView 类上消失，但它不会在下载图像后立即消失。

例如，在 AsyncTask 类的 DoInBackground 上向 scrollView 添加一些视图时，我可以下载图像，然后 onPostExecute 我可以设置图像，然后删除进度条。这工作得很好。我想为 listView 做这样的事情。有人可以帮我吗？

我不知道我是否清楚，但我可以总结一下，我的 list_item.xml 包含 imageview 和 progressbar。我想让这些进度条在下载和设置图像后消失。

感谢您的帮助。

**这是我的适配器类：**

```
class myListAdapter extends ArrayAdapter<Items> {

    private ArrayList<Items> items;
    private Context ctx;

    public myListAdapter(Context context, int textViewResourceId,
            ArrayList<Items> items) {
        super(context, textViewResourceId, items);
        this.ctx = context;
        this.items = items;
    }

    @Override
    public int getCount() {
        return items.size();
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View v = convertView;

        if (v == null) {
            LayoutInflater inf = (LayoutInflater) ctx
                    .getSystemService(LAYOUT_INFLATER_SERVICE);
            v = inf.inflate(R.layout.main_list_item, null);
        }

        Items index = listContents.get(position);

        if (index != null) {

            ImageView img = (ImageView) v.findViewById(R.id.listImage);
            TextView title = (TextView) v.findViewById(R.id.listTopText);
            TextView content = (TextView) v.findViewById(R.id.listDownText);

            if (title != null)
                title.setText(index.getTitle());

            if (content != null)
                content.setText(index.getContent());

            if (img != null) 
                img.setImageBitmap(index.getImageBitmap());
            ((ProgressBar) v.findViewById(R.id.listItemProgressBar)).setVisibility(View.GONE);

        }

        return v;
    }
} 
```

因此，在下面的这一行中，我使进度条消失了，但是在下载并设置图像后它应该消失了……但是在添加的列表项上没有进度条，这是我的问题吗？

```
 ((ProgressBar) v.findViewById(R.id.listItemProgressBar)).setVisibility(View.GONE); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T23:30:22.803

你可以这样做，但这不是最好的做法。你应该自己检查线程同步。并使用 LruCache 或 WeakRefrences 缓存位图。演示仅显示逻辑。

```
final class MyAdapter extends BaseAdapter {

    private final HashMap<String, Bitmap> mImageMap;
    private final HashSet<String> mDownloadingSet;

    public MyAdapter() {
        mImageMap = new HashMap<String, Bitmap>();
        mDownloadingSet = new HashSet<String>();
    }

    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        return NUMBER_YOU_WANT;
    }

    @Override
    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return 0;
    }

    public void setImage(String url, Bitmap bitmap) {
        mDownloadingSet.remove(url);
        if (bitmap != null) {
            mImageMap.put(url, bitmap);
            notifyDataSetChanged();
        }
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder;
        if (convertView == null) {
            convertView = getLayoutInflater().inflate(R.layout.grid_view,
                    parent, false);
            holder = new ViewHolder();

            /***
             * find the views.
             */

            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        final String url = "";// Get the image url here.

        if (mImageMap.containsKey(url)) {
            holder.image.setImageBitmap(mImageMap.get(url));
            holder.progressBar.setVisibility(View.GONE);
        } else {
            holder.image.setImageResource(R.drawable.img_downloading);
            holder.progressBar.setVisibility(View.VISIBLE);
            if (!mDownloadingSet.contains(url)) {
                ImageDownloader task = new ImageDownloader();
                mDownloadingSet.add(url);
                task.execute(url);
            }

        }

        return convertView;
    }
}

static class ViewHolder {
    ImageView image;
    ProgressBar progressBar;
}

final class ImageDownloader extends AsyncTask<String, Void, Bitmap> {

    String url;

    @Override
    protected Bitmap doInBackground(String... params) {
            url = params[0];
        final Bitmap bitmap = fetchUrlAndDecode(params[0]);
        return bitmap;
    }

    @Override
    protected void onPostExecute(Bitmap result) {
        mAdapter.setImage(url, result);
    }

    private Bitmap fetchUrlAndDecode(String url) {
        Bitmap bitmap = null;

        /**
         * Fetch your bitmap and decode it.
         */

        return bitmap;
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T17:37:14.683

这是您的 XML：

```
 <RelativeLayout
    android:layout_width="50dp"
    android:layout_height="wrap_content"
    android:layout_gravity="center_vertical"
    android:paddingLeft="5dp" >

    <ProgressBar
        android:id="@+id/progress"
        style="?android:attr/progressBarStyleHorizontal"
        android:layout_width="fill_parent"
        android:layout_height="40dp"
        android:layout_below="@+id/text_progress"
        android:indeterminate="false"
        android:layout_centerInParent="true"
        android:progress="50"
        android:max="100" />

     <TextView
        android:id="@+id/text_progress"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:textColor="#000"
        android:textStyle="bold"
        android:textSize="15dp"
        android:text="0%"/>

</RelativeLayout> 
```

并覆盖 getView# 方法：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View vi = convertView;
    if (vi == null)
        vi = inflater.inflate(R.layout.oportunidade_item_list, null);

    ProgressBar title = (ProgressBar) vi.findViewById(R.id.progress);
    title.setProgress(Integer.parseInt(((Oportunidade) get(position)).getProbabilidade()));
    return super.getView(position, vi, parent);
} 
```

调用超级，它会为你设置其他视图的值，如果你这样做了`ArrayList<HashMap<?, ?>>`

就这些;

# c# - 在 Visual Studio 外部运行时，每个 .NET WinForms 应用程序都会崩溃

> ID：10559082
> 
> 赞同：3
> 
> 时间：2012-05-11T21:49:06.623
> 
> 标签：c#, .net, visual-studio-2010

这很可能是一个非常愚蠢的问题，所以我提前道歉。

问题如下：

每个带有 Windows 窗体的应用程序（甚至是非常简单的应用程序）我都尝试在 Visual Studio 2010 下组装，即使它在从 IDE 运行时运行良好 - 调试模式，没有错误，没有未处理的异常，没有崩溃，没有任何东西。编译器没有警告（我的警告级别设置为 4）。每当我尝试在没有调试模式或在 IDE 之外运行它时，它会运行大约 1 分钟，然后自行关闭，无论我是否与应用程序交互。没有显示错误消息，没有任何东西。它只是消失了。我试图搜索windows事件日志，没有结果。也许我需要更改事件日志的设置？

这个问题与 stackoverflow 上描述的其他类似问题的不同之处在于，它发生在 Visual Studio 下编译的每个应用程序中，每次运行应用程序时都会发生“崩溃”，并且会在很短的时间内发生。

这是我编写的一个这样的示例单格式虚拟应用程序的主要源代码：

```
 namespace pj2_lastAttemptApp
    {
        public partial class Form1 : Form
        {
            public Form1()
            {
                InitializeComponent();
            }

            private void button1_Click(object sender, EventArgs e)
            {
                label1.Text = "You have written: " + textBox1.Text;
            }
        }
    } 
```

然而，除非在调试模式下，否则即使这样也会崩溃。我正在使用 Visual Studio 2010 Professional，我的操作系统是 Windows Vista Business。任何帮助将不胜感激。

编辑：这是附加的调试器输出：

```
 'pj2_lastAttemptApp.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_32\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll'
  'pj2_lastAttemptApp.exe' (Managed (v4.0.30319)): Loaded 'D:\User_data\<my user name>\Documents\Visual Studio 2010\Projects\pj2_lastAttemptApp\pj2_lastAttemptApp\bin\Release\pj2_lastAttemptApp.exe', Symbols loaded.
  'pj2_lastAttemptApp.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Windows.Forms\v4.0_4.0.0.0__b77a5c561934e089\System.Windows.Forms.dll'
  'pj2_lastAttemptApp.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Drawing\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll'
  'pj2_lastAttemptApp.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System\v4.0_4.0.0.0__b77a5c561934e089\System.dll'
  The program '[1852] pj2_lastAttemptApp.exe: Managed (v4.0.30319)' has exited with code 0 (0x0).
  The program '[3436] pj2_lastAttemptApp.vshost.exe: Managed (v4.0.30319)' has exited with code 0 (0x0). 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:05:12.453

如果您直接运行exe文件的应用程序，请尝试为References节点中的每个程序集设置“Local copy” = true并重建项目。如果运行没有问题，请执行并尝试。

# ruby - Backbone JS 和 Ruby on Rails CRUD 问题

> ID：10559084
> 
> 赞同：0
> 
> 时间：2012-05-11T21:49:18.793
> 
> 标签：ruby, ruby-on-rails-3, backbone.js

这对我来说似乎是个问题。Backbone 的正常工作方式是使用相同的 URL 和 GET、POST、PUT 和 DELETE。但很明显：

1) 除了方法之外的所有`POST`方法都需要在 URL 或请求正文中的 ID

2)`DELETE`请求不能包含正文或某些服务器忽略正文

那么，如何让 Ruby on Rails 服务器应用程序成功地与 Backbone 一起工作，而无需破解 Backbone，例如`model.destroy()`需要在 URL 中包含 ID？而且，正如我们的 RoR 开发人员告诉我的那样，为 PUT 进行路由的正常方法是在 URL 中也有一个 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:09:05.437

您需要实现 5 条路由来利用骨干网的默认[`sync`](http://documentcloud.github.com/backbone/#Sync)行为。对于资源`user`，它们是：

```
GET /user/        // Get a list of users
GET /user/:id     // Get a single users by id
POST /user/       // Create a new user
PUT /user/:id     // Update an existing user by id
DELETE /user/:id  // Delete an existing user by id 
```

我对 Ruby on Rails 不是很熟悉，但是看看他们的文档，你可以通过以下方式来满足这个规范：

```
match "/user/" => "users#all", :via => :get
match "/user/:user_id" => "users#one", :via => :get
match "/user/" => "users#create", :via => :post
match "/user/:user_id" => "users#update", :via => :put
match "/user/:user_id" => "users#delete", :via => :delete 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T22:13:09.027

您不必破解 Backbone 即可与 RoR 一起使用。Backbone 足够聪明，可以（在一定程度上）知道应该使用什么 URL 和方法。

例如，对于模型的初始获取，如果您将 url 设置为“/tasks”，它将向“/tasks/id”发出 GET 请求。当您更改该模型并调用 model.save 时，它​​将向“/tasks/id”发出 PUT 请求。当你调用 model.destroy 时，它会发送一个 DELETE 请求（带有一个空的 body）

您必须考虑的一件事是 CSRF 令牌。我建议您在 Gemfile 中包含[骨干轨](https://github.com/codebrew/backbone-rails)。它包含一些 JavaScript 来帮助 Rails/Backbone 集成。

# python - 在 Matplotlib 中无意中移动绘图

> ID：10559086
> 
> 赞同：0
> 
> 时间：2012-05-11T21:49:32.403
> 
> 标签：python, matplotlib

我在 matplotlib 中有一些我无法解释的奇怪行为，我想知道是否有人能看到发生了什么。本质上发生的是，我试图将过去的两个数字合二为一。我通过创建两个`GridSpec`对象来做到这一点，一个用于图形的左半边，另一个用于右半边。我绘制左侧并添加一个`colorbar`，但是当我在右侧选择我的第一个时，左侧的图形在颜色栏*下方*`subplot`向右移动。如果您尝试执行不包括最后两行的示例代码，您将看到您所期望的，但如果您执行全部代码，左边的图会发生变化。这是怎么回事？

 *```
import matplotlib.gridspec as gridspec
import numpy as np
import pylab as pl

scores = np.array([[ 0.32      ,  0.32      ,  0.32      ,  0.32      ,  0.32      ,
         0.32      ,  0.32      ,  0.32      ,  0.32      ],
       [ 0.32      ,  0.32      ,  0.32      ,  0.49333333,  0.85333333,
         0.92666667,  0.32      ,  0.32      ,  0.32      ],
       [ 0.32      ,  0.32      ,  0.51333333,  0.87333333,  0.96      ,
         0.95333333,  0.89333333,  0.44      ,  0.34      ],
       [ 0.32      ,  0.51333333,  0.88      ,  0.96      ,  0.96666667,
         0.95333333,  0.90666667,  0.47333333,  0.34      ],
       [ 0.51333333,  0.88      ,  0.96      ,  0.96      ,  0.96      ,
         0.96      ,  0.90666667,  0.47333333,  0.34      ],
       [ 0.88      ,  0.96      ,  0.96      ,  0.96      ,  0.94666667,
         0.96      ,  0.90666667,  0.47333333,  0.34      ],
       [ 0.96      ,  0.96      ,  0.96666667,  0.96      ,  0.94      ,
         0.96      ,  0.90666667,  0.47333333,  0.34      ],
       [ 0.96      ,  0.96666667,  0.96666667,  0.94666667,  0.94      ,
         0.96      ,  0.90666667,  0.47333333,  0.34      ],
       [ 0.96666667,  0.97333333,  0.96      ,  0.94666667,  0.94      ,
         0.96      ,  0.90666667,  0.47333333,  0.34      ],
       [ 0.96666667,  0.96666667,  0.96666667,  0.94666667,  0.94      ,
         0.96      ,  0.90666667,  0.47333333,  0.34      ],
       [ 0.95333333,  0.96      ,  0.96666667,  0.94666667,  0.94      ,
         0.96      ,  0.90666667,  0.47333333,  0.34      ]])
C_range = 10.0 ** np.arange(-2, 9)
gamma_range = 10.0 ** np.arange(-5, 4)

pl.figure(0, figsize=(16,6))
gs = gridspec.GridSpec(1,1)
gs.update(left=0.05, right=0.45, bottom=0.15, top=0.95)
pl.subplot(gs[0,0])
pl.imshow(scores, interpolation='nearest', cmap=pl.cm.spectral)
pl.xlabel('gamma')
pl.ylabel('C')
pl.colorbar()
pl.xticks(np.arange(len(gamma_range)), gamma_range, rotation=45)
pl.yticks(np.arange(len(C_range)), C_range)
gs = gridspec.GridSpec(3,3)
gs.update(left=0.5, right=0.95, bottom=0.05, top=0.95)
pl.subplot(gs[0,0])  # here's where the shift happens 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T01:14:15.373

您可以在 # 之后创建颜色条，这是发生转变的地方

```
pl.figure(0, figsize=(16,6))
gs = gridspec.GridSpec(1,1)
gs.update(left=0.05, right=0.45, bottom=0.15, top=0.95)
ax = pl.subplot(gs[0,0])  # save the axes to ax
pl.imshow(scores, interpolation='nearest', cmap=pl.cm.spectral)
pl.xlabel('gamma')
pl.ylabel('C')
pl.xticks(np.arange(len(gamma_range)), gamma_range, rotation=45)
pl.yticks(np.arange(len(C_range)), C_range)
gs = gridspec.GridSpec(3,3)
gs.update(left=0.5, right=0.95, bottom=0.05, top=0.95)
pl.subplot(gs[0,0])  # here's where the shift happens

pl.colorbar(ax=ax) # create colorbar for ax
pl.show() 
```

![在此处输入图像描述](../Images/f844a680bb5dcde9b625429ab6ea78f9.png)*

# objective-c - 在 Obj C 中初始化和修改 C 结构数组

> ID：10559088
> 
> 赞同：0
> 
> 时间：2012-05-11T21:49:34.173
> 
> 标签：objective-c, c, struct, opengl-es-2.0

我正在尝试在 iOS 中使用一些 Open GL 的东西，但我被 C 的东西困住了，这是我十年来没有使用过的东西。

我用作基础的示例代码声明了 struct Vertex：

```
typedef struct {
    float Position[3];
    float Color[4];
} Vertex; 
```

然后，它声明了一个用于数学运算的 C 风格的顶点数组：

```
Vertex Vertices[] = {
    {{0.5, -0.5, 0}, {1, 1, 1, 1}},
    {{0.5, 0.5, 0}, {1, 1, 1, 1}},
    {{-0.5, 0.5, 0}, {1, 1, 1, 1}},
    {{-0.5, -0.5, 0}, {1, 1, 1, 1}}
}; 
```

我需要调用一个方法来返回一个新的顶点数组，而不是只使用这个固定数组，这就是我卡住的地方。我想要的是类似的东西（我知道这是完全错误的，它比任何东西都更像伪代码）：

```
- (Vertex (*)[])getLineSegments {
    Vertex *vertices = ?? //(need [allPoints count] Vertexs)
    for (int i = 0; i < [allPoints count]; i++) {
        vertices[i] = { [allPoints[i] getPoints], [allPoints[i] getColor] }; //how do I make a new Vertex in this fashion?
        //and then, in getPoints/getColor, how would I make a float[] and return that properly
    }
    return vertices;
} 
```

只是尝试使用 malloc 实例化和分配值，而我在其他地方读到的东西却惨遭失败：

```
- (Vertex (*)[])getLineSegments {
    Vertex (*vertices)[4] = malloc(sizeof(Vertex) * 4);
    Vertex *point = malloc(sizeof(Vertex));
    float Pos[3] = {0.5, -0.5, 0}; //error: Array Type Pos[3] is not assingable
    point->Position = Pos;
    float Color[4] = {1,1,1,1};
    point->Color = Color;
    vertices[0] = point;
    vertices[1] = {{0.5, 0.5, 0} , {1, 1, 1, 1}};
    vertices[2] = {{-0.5, 0.5, 0}, {1, 1, 1, 1}};
    vertices[3] = {{-0.5, -0.5, 0},{1, 1, 1, 1}}; //errors... errors everywhere
    return vertices;
} 
```

我该如何正确地做到这一点？

## ---

编辑：根据伯顿的建议更新为以下内容。还有一些错误：

```
- (Vertex (*)[])getLineSegments {
Vertex (*vertices)[4] = malloc(sizeof(Vertex) * 4);
for (int i = 0; i < 4; i++) {
    vertices[i] = malloc(sizeof(*vertices[i])); //err: Array type 'Vertex[4]' is not assignable 
    vertices[i]->Position[0] = 0.5; //this one works. is this correct?
    vertices[i].Position[1] = -0.5; //Member reference type 'Vertex *' is a pointer; maybe you meant to use ->?
    vertices[i].Position[2] = 0;
    vertices[i].Color[0] = 1;
    vertices[i].Color[1] = 1;
    vertices[i].Color[2] = 1;
    vertices[i].Color[3] = 1;
}
return vertices;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:54:32.607

您需要手动分配值。您使用的符号仅适用于自动变量。它看起来不太好，但这几乎是初始化动态数据的唯一方法。像这样：

```
vertices[1].Position[0] = 1;
vertices[1].Position[1] = 2;
vertices[1].Position[3] = 3;
vertices[1].Color[0] = 1;
vertices[1].Color[1] = 1;
vertices[1].Color[2] = 1;
vertices[1].Color[3] = 1; 
```

对于每个顶点[2]和顶点[3]，依此类推。

哦，你必须做

```
vertices[1] = malloc(sizeof(*vertices[1])); 
```

首先为数据分配存储空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:50:48.747

这是我的建议（即使我使用了一个变量而不是 4）。假设我明白你想做什么。

```
Vertex *getLineSegments(int size) {
    Vertex *vertices = malloc(sizeof(Vertex) * size);
    for (int i = 0; i < size; ++i) {
        vertices[i].Position[0] = ...;
        vertices[i].Position[1] = ...;
        vertices[i].Position[2] = ...;
        vertices[i].Color[0] = ...;
        vertices[i].Color[1] = ...;
        vertices[i].Color[2] = ...;
        vertices[i].Color[3] = ...;
    }
} 
```

然后你调用这个方法的方式：

```
Vertex *vertices = getLineSegments(4); 
```

- 或者 -

```
Vertex vertices[] = getLineSegments(4); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T03:10:24.930

如果我理解正确，您正在尝试创建 type 的一维数组`Vertex`，这是正确的吗？

如果是这种情况，您`getLineSegments`可能看起来像这样：

```
typedef struct {
    float Position[3];
    float Color[4];
} Vertex;

typedef Vertex * VertextPtr;

VertextPtr getLineSegments() 
{
    VertextPtr vertices = (VertextPtr)calloc(sizeof(Vertex), 4);

    for (int i = 0; i < 4; i++) 
    {
        vertices[i].Position[0] = 0.5;
        vertices[i].Position[1] = -0.5;
        vertices[i].Position[2] = 0;
        vertices[i].Color[0] = 1;
        vertices[i].Color[1] = 1;
        vertices[i].Color[2] = 1;
        vertices[i].Color[3] = 1;
    }
    return vertices;
}

int main(void)
{
    VertextPtr vertices = getLineSegments();

    printf("Position: %f\n", vertices[2].Position[0]);
    printf("Position: %f\n", vertices[2].Position[1]);
    printf("Position: %f\n", vertices[2].Position[2]);
    //
    // Do clean-up here.
    return 0;   
} 
```

请注意，我使用了 a`typedef`来`Vertex *`使代码更简洁。我希望这有帮助。

# android - Android - 删除以对话框为主题的活动

> ID：10559091
> 
> 赞同：0
> 
> 时间：2012-05-11T21:49:42.117
> 
> 标签：android

Android 2.1 通过 Eclipse

我有一个活动，通过复选框 onChecked 功能打开一个对话框主题活动

我正在使用 Intent 创建这个以对话框为主题的新活动。

问题是，一旦我完成对话主题活动，我该如何关闭它？（现在的情况，我必须发送一个新意图才能通过单击按钮返回上一个活动）

任何帮助将不胜感激！

代码片段：

主要活动：

```
cbReminder.setOnCheckedChangeListener(new OnCheckedChangeListener() {

    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
        if (isChecked)
        {                   
            Intent intent = new Intent(getApplicationContext(), DateTimeDialog.class);
            startActivity(intent);
        }
    }
}); 
```

对话主题活动：

```
public void onClick(View v) {
    if (v.getId() == R.id.b_datetime_save)
    {

    }
    else if (v.getId() == R.id.b_datetime_cancel)
    {
        finish();
        Intent intent = new Intent(getApplicationContext(), MakeNoteActivity.class);
        startActivity(intent);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:56:04.580

正如您所指定的，该意图确实不需要返回到先前的活动，应该被删除。

要在从对话框返回后取消选中复选框，您可以使用`startActivityForResult`并设置返回时的回调。

像这样打开你的对话框：

```
Intent intent = new Intent( getApplicationContext(), DateTimeDialog.class );
startActivityForResult( intent, UNIQUE_IDENTIFIER ); 
```

然后为同一活动添加回调：

```
@Override
protected void onActivityResult( int requestCode, int resultCode, Intent data )
{
    if ( requestCode == UNIQUE_IDENTIFIER )
    {
        cbReminder.setChecked( false );
    }
} 
```

`UNIQUE_IDENTIFIER`可以是唯一标识此对话框的任何数字。如果您还有其他问题，请告诉我。

# delphi - 比较JPEG图像的最快解决方案是什么？（忽略元数据，只是“像素”）

> ID：10559099
> 
> 赞同：4
> 
> 时间：2012-05-11T21:50:09.163
> 
> 标签：delphi, comparison, jpeg

当我搜索“JPEG”和“元数据”这两个词时，我有很多答案来操纵元数据......而这与我想要的相反......;o）

我编写了一个完全符合我要求的函数...（如果图像相似，并且只有元数据发生变化，则函数返回`True`；如果至少一个像素发生变化，则返回`False`）但是，我想改进表现...

瓶颈是`bmp.Assign(jpg);`

```
function CompareImages(fnFrom, fnTo: TFileName): Boolean;
var
  j1, j2: TJpegImage;
  b1, b2: TBitmap;
  s1, s2: TMemoryStream;
begin
  Result := False;
sw1.Start;
  j1 := TJpegImage.Create;
  j2 := TJpegImage.Create;
sw1.Stop;
sw2.Start;
  s1 := TMemoryStream.Create;
  s2 := TMemoryStream.Create;
sw2.Stop;
//sw3.Start;
  b1 := TBitmap.Create;
  b2 := TBitmap.Create;
//sw3.Stop;
  try
  sw1.Start;
    j1.LoadFromFile(fnFrom);
    j2.LoadFromFile(fnTo);
  sw1.Stop;

            // the very long part...
            sw3.Start;
              b1.Assign(j1);
              b2.Assign(j2);
            sw3.Stop;

  sw4.Start;
    b1.SaveToStream(s1);
    b2.SaveToStream(s2);
  sw4.Stop;
  sw2.Start;
    s1.Position := 0;
    s2.Position := 0;
  sw2.Stop;
  sw5.Start;
    Result := IsIdenticalStreams(s1, s2);
  sw5.Stop;
  finally
//  sw3.Start;
    b1.Free;
    b2.Free;
//  sw3.Stop;
  sw2.Start;
    s1.Free;
    s2.Free;
  sw2.Stop;
  sw1.Start;
    j1.Free;
    j2.Free;
  sw1.Stop;
  end;
end; 
```

sw1, ..., sw5 是[TStopWatch](http://docwiki.embarcadero.com/Libraries/en/System.Diagnostics.TStopwatch)，我用来识别花费的时间。

IsIdenticalStreams 来自[这里](https://stackoverflow.com/a/4606388/596852)。

如果我直接比较`TJpegImage`，流是不同的......

有更好的编码方式吗？

问候，

W。

**更新：**

测试从评论中提取的一些解决方案，我与此代码具有相同的性能：

```
type
  TMyJpeg = class(TJPEGImage)
    public
      function Equals(Graphic: TGraphic): Boolean; override;
  end;

...

function CompareImages(fnFrom, fnTo: TFileName): Boolean;
var
  j1, j2: TMyJpeg;
begin
  sw1.Start;
  Result := False;
  j1 := TMyJpeg.Create;
  j2 := TMyJpeg.Create;
  try
    j1.LoadFromFile(fnFrom);
    j2.LoadFromFile(fnTo);
  Result := j1.Bitmap.Equals(j2.Bitmap);
  finally
    j1.Free;
    j2.Free;
  end;
  sw1.Stop;
end; 
```

有什么方法可以在不进行位图转换的情况下直接访问文件中的像素数据字节（跳过元数据字节）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-12T04:06:05.060

JPEG 文件由块组成，其类型由标记标识。chunks的结构（除了独立的SOI、EOI、RSTn）：

```
chunk type marker (big-endian FFxx)
chunk length (big-endian word)
data (length-2 bytes) 
```

**编辑：** SOS 块受另一个标记的限制，而不是长度。

元数据块以 APPn 标记 (FFEn) 开头，但带有 JFIF 标题的 APP0 (FFE0) 标记除外。

所以我们可以只读取和比较重要的块，而忽略 APPn 块和 COM 块（正如 TLama 所注意到的）。

示例：一些 jpeg 文件的十六进制视图： ![在此处输入图像描述](../Images/5363457c97d1e8cbdeed0556ddda8cd4.png)

它以 SOI（图像开始）标记 FFD8（独立，无长度）开头，

然后是长度为 16 字节的 APP0 块 (FFE0)，

然后是 APP1 块 (FFE1)，其中包含元数据（EXIF 数据、NIKON COOLPIX 名称等），因此我们可以忽略 9053 字节（23 5D）并检查地址 2373 处的下一个块标记，依此类推...

**编辑：**简单的解析示例：

```
var
  jp: TMemoryStream;
  Marker, Len: Word;
  Position: Integer;
  PBA: PByteArray;

  procedure ReadLenAndMovePosition;
  begin
    Inc(Position, 2);
    Len := Swap(PWord(@PBA[Position])^);
    Inc(Position, Len);
  end;

begin
  jp := TMemoryStream.Create;
  jp.LoadFromFile('D:\3.jpg');
  Position := 0;
  PBA := jp.Memory;

  while (Position < jp.Size - 1) do begin
    Marker := Swap(PWord(@PBA[Position])^);
    case Marker of
      $FFD8: begin
          Memo1.Lines.Add('Start Of Image');
          Inc(Position, 2);
        end;
      $FFD9: begin
          Memo1.Lines.Add('End Of Image');
          Inc(Position, 2);
        end;
      $FFE0: begin
          ReadLenAndMovePosition;
          Memo1.Lines.Add(Format('JFIF Header Len: %d', [Len]));
        end;
      $FFE1..$FFEF, $FFFE: begin
          ReadLenAndMovePosition;
          Memo1.Lines.Add(Format('APPn or COM Len: %d Ignored', [Len]));
        end;
      $FFDA: begin
          //SOS marker, data stream, ended by another marker except for RSTn
          Memo1.Lines.Add(Format('SOS data stream started at %d', [Position]));
          Inc(Position, 2);
          while Position < jp.Size - 1 do begin
            if PBA[Position] = $FF then
              if not (PBA[Position + 1] in [0, $D0..$D7]) then begin
                Inc(Position, 2);
                Memo1.Lines.Add(Format('SOS data stream ended at %d',
                  [Position]));
                Break;
              end;
            Inc(Position);
          end;
        end;
    else begin
        ReadLenAndMovePosition;
        Memo1.Lines.Add(Format('Marker %x Len: %d Significant', [Marker, Len]));
      end;
    end;
  end;
  jp.Free;
end; 
```

# javascript - zeroclipboard 元素在位于辅助/非默认 jQuery 选项卡内时不起作用

> ID：10559100
> 
> 赞同：1
> 
> 时间：2012-05-11T21:50:12.827
> 
> 标签：javascript, jquery, zeroclipboard

我有一个带有 jQ​​uery 选项卡的页面，我正在尝试使用 zeroclipboard 链接辅助选项卡内的 div 元素。不幸的是，它不起作用，因为我怀疑辅助选项卡在页面加载时最初是隐藏的。

html如下：

```
<span id="form" class="tabs tabs-normal grid100">

   <!-- HEADER BUTTONS -->
   <div class="row_btns_header">
      <button class="btn_neutral">Cancel</button>
      <button class="btn_primary last save">Save</button>     
   </div>

   <!-- TABS -->
   <div class="row">
      <ul id="tabs-list">
        <li><a href="#blog">Blog</a></li>
        <li><a href="#links">Links</a></li>
        <li><a href="#images">Images</a></li>
        <li><a href="#more">More..</a></li>
      </ul>
   </div>

   <!-- DEFAULT TAB -->
   <div id="blog" class="container">

   </div>

   <!-- LINKS TAB -->
   <div id="links" class="container">
        <div id="embed" style="position: relative">
           <a href="#">Copy into the clipboard</a>
        </div>
   </div>

   <!-- etc. --> 
```

javascript是：

```
$(".tabs").tabs();

$("#embed").zclip({
        path: "http://www.steamdev.com/zclip/js/ZeroClipboard.swf",
        copy: "aaaaaaaaaaaa"
    }); 
```

zeroclipboard 工作正常，如果我将#embed div 移动到#blog div 中。我怀疑这是因为默认情况下 #blog 是可见的。

当 zeroclipboard 元素位于辅助非默认选项卡内时，我需要做什么才能使它工作？

非常感谢。

巴迪

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-20T09:49:57.027

我意识到这是一个旧线程，但希望这可以帮助那里的人。

我只是遇到了同样的问题，我想出的解决方案是将 zclip 对象的创建绑定到与所需触发按钮/链接相关的 mouseover 事件。此外，为了防止脚本在每次发生 mouseover 事件时重新初始化 zclip 对象，只需在第一次调用时将其关闭即可。这是一个例子：

的HTML：

```
<input type='text' value='Text being copied.'/> <input type='button' class='clipcopy' value='Copy'/> 
```

Javascript：

```
$(document).ready(function(){

    $(".clipcopy").on('mouseover', function(){

        //turn off this listening event for the element that triggered this
        $(this).off('mouseover');

         //initialize zclip
        $(this).zclip({
            path: "js/zclip/ZeroClipboard.swf",
            copy: function(){return $(this).prev().prop('value');}
         });

     });
 }); 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-20T07:11:17.013

关键是在鼠标悬停事件上对其进行初始化，我使用[jquery.clipboard](https://github.com/valeriansaliou/jquery.clipboard "jQuery剪贴板")这也可以

```
$("a.button-copy-shortcode").on('mouseover', function(event){
    event.preventDefault();

    //initialize clipboard
    $(this).clipboard({
        path: pluginDir+'/tonjoo-tom/assets/js/jquery.clipboard.swf',
        copy: function() {

            var shortcode = $(this).find('.shortcodeValue').text();

            return shortcode;
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T22:01:27.273

选项卡插件将选项卡面板设置为`display: none`，这意味着 Flash 不会立即启动。你可以尝试用 CSS 破解它：

```
.container.ui-helper-hidden {
    display: block !important;
    position: absolute;
    left: -99999px;
} 
```

这将覆盖`display: none`并将面板放置在屏幕之外 - 这样会加载内容并测量面板，但不会对用户可见。（这与`.ui-helper-hidden-accessible`过去的工作方式相同）

# .net - 运行 IIS 7 并使用 cookie 的负载平衡服务器的 .NET FormsAuthentication 问题

> ID：10559108
> 
> 赞同：3
> 
> 时间：2012-05-11T21:50:44.237
> 
> 标签：.net, cookies, iis-7, forms-authentication, load-balancing

我有一对运行 .NET 3.5 / MVC 2 应用程序的负载平衡 Web 服务器。我们正在使用带有 cookie 的表单身份验证。

当用户被踢到第二台服务器时， `HttpContext.Current.User.Identity.IsAuthenticated`总是返回为`false`，因此用户退出。

另一个有趣的消息是`.ASPXAUTH`cookie 仍然从浏览器传递，仍然可以在请求标头中看到，但**不再存在**于`HttpContext.Current.Request.Cookies`. 我已经设置了 auth cookie`HttpOnly`和.`Secure``true`

我检查了两个 Web 服务器使用的机器密钥是否与它们的 web.config 文件中设置的完全相同。

# java - 将一维数组转换为二维数组

> ID：10559115
> 
> 赞同：1
> 
> 时间：2012-05-11T21:51:31.493
> 
> 标签：java, arrays

我正在尝试获取一个包含 400 个整数的数组，并将其拆分为一个 20x20 二维数组。我以为我有正确的算法，但是一维数组的总和与二维数组的总和不匹配，所以我显然做错了。这是我的代码：

```
private static void processArray(int[] inArray)
{
    int[][] array = new int[20][20];

    for (int x = 0; x < 20; x++)
    {
        for (int y = 0; y < 20; y++)
        {
            for (int z = 0; z < 400; z++)
            {
                array[x][y] = inArray[z];
            }
        }
    }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:53:12.787

对于每一对`x`and `y`，您的代码将*每个*值从`inArray`to分配给`array[x][y]`。这显然是不正确的。

这是修复代码的一种方法：

```
private static void processArray(int[] inArray)
{
    int[][] array = new int[20][20];

    for (int x = 0, z = 0; x < 20; x++)
    {
        for (int y = 0; y < 20; y++)
        {
            array[x][y] = inArray[z++];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:53:07.710

您将输入数组中的最后一个元素分配给输出数组中的每个元素。输入数组的内部循环必须更改为选择正确输入元素的单个分配。

```
private static void processArray(int[] inArray)
{
    int[][] array = new int[20][20];

    for (int x = 0; x < 20; x++)
    {
        for (int y = 0; y < 20; y++)
        {
            array[x][y] = inArray[x * 20 + y];  // or devise your own calculation
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T21:53:14.530

当前方法将为数组中的每个元素分配原始元素中的最后一个元素。

您不应该迭代`z`，而是在相同的循环中将其用作计数器。

```
int z = 0;
for (int x = 0; x < 20; x++)
    {
        for (int y = 0; y < 20; y++)
        {
                array[x][y] = inArray[z++];
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T21:56:30.867

你基本上是指派 array[x][y] 等于 inArray[0]，然后是 inArray[1]，然后是 inArray[2]，一直到 [400]。

我会做类似的事情

```
private static void processArray(int[] inArray)
{
    int[][] array = new int[20][20];

    for (int x = 0; x < 20; x++)
    {
        for (int y = 0; y < 20; y++)
        {
            array[x][y] = inArray[x * 20 + y];
        }
    }
} 
```

# key - 在 Mac 上生成 GPG 密钥

> ID：10559117
> 
> 赞同：0
> 
> 时间：2012-05-11T21:51:40.430
> 
> 标签：key, gnome, sign, gnupg

有谁知道 GNOME 的 Seashorse 在 Mac 上生成 Gpg 密钥的任何好的替代方案？

（另一个问题是，如何在 Mac 上安装 Seashorse？我已经下载了软件包，但是在我运行之后`./configure`，我收到一条错误消息`intltool-update: command not found`

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T23:19:06.907

GPGTools 是一个不错的工具集，它捆绑了 GPG Keychain Access，它提供了一个 GUI，允许您创建、删除、查找、签名和验证所有密钥 - [https://www.gpgtools.org/](https://www.gpgtools.org/)

注意：我绝不隶属于 GPGTools

至于在 OSX 上编译 GNOME 的 Seahorse，那应该是一个单独的问题；但有人问，所以我会回答；

首先，您需要设置构建环境。为方便起见，我使用 macports [http://www.macports.org/](http://www.macports.org/)来安装依赖项。

`sudo port install intltool gnome-doc-utils gtk2 gconf libgnome-keyring xorg-libsm`

现在我们可以建造 Seahorse -

获取海马源

`wget http://download.gnome.org/sources/seahorse/2.28/seahorse-2.28.1.tar.gz`

提取源码

`tar -xzf ./seahorse-2.28.1.tar.gz`

进入源目录

`cd ./seahorse-2.28.1.tar.gz`

使用所需前缀配置源

`./configure --prefix=/usr`

制作源码

`make`

无论出于何种原因，我不得不编辑 pkcs11/seahorse-pkcs11-operations.c 因为 make 失败了：

`seahorse-pkcs11-operations.c:185: error: too few arguments to function 'gp11_slot_open_session_async'`

所以我将 185 处的行从：

`gp11_slot_open_session_async (slot, CKF_RW_SESSION, self->cancellable,`

对此：

`gp11_slot_open_session_async (slot, CKF_RW_SESSION, NULL, NULL, self->cancellable,`

如果您必须编辑该文件，然后再次制作

`make`

如果一切构建成功，请安装构建的应用程序

`sudo make install`

您现在应该能够在 OSX 下运行 GNOME Seahorse。

# regex - 将最接近的字符串与搜索词匹配（perl 正则表达式）

> ID：10559118
> 
> 赞同：5
> 
> 时间：2012-05-11T21:51:50.167
> 
> 标签：regex, perl, replace

基本上，我要做的是搜索一个相当大的 PHP 文件，并用其他代码替换其中包含字符串“search_term”的任何 PHP 代码块。IE

```
<?php
//some stuff
?>
<?php
// some more stuff
$str = "search_term";
// yes...
?>
<?php 
// last stuff
?> 
```

应该成为

```
<?php
//some stuff
?>
HELLO
<?php 
// last stuff
?> 
```

到目前为止我得到的是

```
$string =~ s/<\?php(.*?)search_term(.*?)\?>/HELLO/ims; 
```

这正确匹配最近的结束`?>`，但从第一个开始匹配`<?php`，而不是最接近字符串的那个`search_term`。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T22:34:29.420

一般来说，我不喜欢使用非贪心匹配，因为它通常会导致这样的问题。Perl 查看您的文件，找到第一个`'<?php'`，然后开始寻找正则表达式的其余部分。它通过了第一个`'?>'`和第二个`'<?php'`，因为它们匹配`.*`，然后找到`search_term`和下一个`'?>'`，它就完成了。

非贪婪匹配意味着你有一个正则表达式匹配的东西比你真正想要的要多，它让 perl 决定返回哪个匹配。最好使用与您想要匹配的内容完全匹配的正则表达式。`((?!\?>).)*`在这种情况下，您可以通过使用代替`.*?`(`(?!\?>)`是一个否定的前瞻断言)来获得您想要的东西

```
s/<\?php((?!\?>).)*search_term((?!\?>).)*\?>/HELLO/is; 
```

如果您期望多个匹配项，您可能希望使用`/isg`而不是`/is`.

或者，只需将文件拆分为块：

```
@blocks = split /(\?>)/, $string;
while (@blocks) {
    $block = shift @blocks;
    $sep = shift @blocks;
    if ($block=~/search_term/) {
        print "HELLO";
    } else {
        print $block, $sep;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:57:35.200

您只需要将您的第一个捕获组放回您的替换组。像这样的东西：

```
s/<\?php(.*)<\?php(.*?)search_term(.*?)\?>/<\?php$1HELLO/ims 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T23:22:11.303

```
$string =~ s/<\?php(?:(?!\?>|search_term).)*search_term.*?\?>/HELLO/isg; 
```

`(?:(?!\?>|search_term).)*`在确保字符不是or的开头*之后*，一次匹配一个字符。当它停止匹配时，如果字符串中的下一个是它，它会消耗它以及它之后的所有内容，直到下一个。否则，该尝试将失败，并从下一个 重新开始。`?>``search_term``search_term``?>``<?php`

关键点是，就像@RobertYoung 的解决方案一样，它在`?>`搜索`search_term`. 通过不匹配`search_term`，它消除了回溯，从而使搜索更有效。取决于可能无关紧要的源字符串的大小，但它也不会明显影响性能。

@Benj 的解决方案（如当前发布的）不起作用。它使用您提供的示例字符串产生所需的输出，但这只是偶然的。它只替换其中的**最后一个**代码块`search_term`，并且（正如@mob 评论的那样）它完全忽略了第一个代码块的内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T22:20:05.073

```
s/(.*)<\?php.*?search_term.*?\?>/${1}HELLO/ims; 
```

在您的正则表达式中，正则表达式引擎试图找到与您的目标表达式匹配的子字符串最早出现的位置，并在 first`<?php`和 second之间找到它`?>`。

通过放在`(.*)`正则表达式的开头，您可以欺骗正则表达式引擎进入字符串的末尾（因为`.*`匹配整个字符串），然后回溯到可以找到字符串“ `<?php`”的位置。这样，生成的匹配就不会包含`<?php`不必要的令牌。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T21:58:25.323

您正在使用~~贪婪~~的吝啬匹配，但仍然可以匹配太多。

[*匹配的重复*很好地`perlretut`](http://perldoc.perl.org/perlretut.html#Matching-repetitions)描述了它。

我有时会使用否定匹配来提供帮助，但我认为这不会有帮助。例如：

```
s/^[^A]*A/A/ 
```

以确保我的角色不匹配。

但我通常不会尝试跨越多行，除非必须，否则我不会使用 perl。

# c++ - 如何在 C++ 中连接两个 LPCWSTR

> ID：10559119
> 
> 赞同：7
> 
> 时间：2012-05-11T21:51:55.560
> 
> 标签：c++, windows, winapi, concatenation

我正在尝试使用 MoveFile(LPCWSTR existing, LPCWSTR new) 函数。我希望能够通过连接不同的数据（例如：根目录和潜在的文件名）来获得目录之一（由 LPCWSTR 表示）。尽管进行了数小时的研究，但我无法弄清楚如何做到这一点。感谢任何帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-11T21:54:04.790

听起来您正在尝试将两个`LPCWSTR`表示路径元素的组合为组合路径。如果是这种情况，那么您想使用[PathCombine](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773571%28v=vs.85%29.aspx)方法

```
LPCWSTR root = ...;
LPCWSTR name = ...;
WCHAR combined[MAX_PATH];
if (PathCombineW(combined, root, name) != NULL) {
  // Succeeded
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:11:03.117

您应该[**`_wmakepath_s()`**](http://msdn.microsoft.com/en-us/library/5a1745t0.aspx)用于组成宽字符路径。

# ruby-on-rails - 如何限制具有多个角色的用户的 load_resource？

> ID：10559122
> 
> 赞同：1
> 
> 时间：2012-05-11T21:52:02.250
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cancan

在我的应用程序中，所有用户都可以在那里阅读自己的任务。第二个控制器仅供版主使用，版主可以查看所有任务。

```
# accessible for every user
# every user should see only own tasks, 
# but at the moment all moderators see all tasks
class TasksController < ActionController::Base
  load_and_authorize_resource
end

# only accessible for moderators, all tasks
class TasksModeratorController < ActionController::Base
  load_and_authorize_resource :task, :parent => false
end

# Ability
# Moderators can read all tasks
if user.moderator?
  can :read, Task
end
# All users can read there own tasks
can :read, Task, :user_id => user.id 
```

我如何限制 TasksController 中的任务只向版主显示自己的任务，但 TasksModeratorController 中的所有任务？还是有更常见的方法来处理这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:38:12.667

能力是一个模型，因为通常访问权限是独立于控制器的。但是，如果不只是通过 current_ability 将控制器传递给能力初始化器来使其显式化。我认为鼓励这种将更多信息传递给能力的做法。所以我未经测试的 2 美分

```
# in ApplicationController
def current_ability
  @current_ability ||= Ability.new(current_user, self)
end

# in Ability
def initialize(user, controller)

# all same as before ...
# Moderators can read all tasks if using TasksModeratorController or any subclass
if user.moderator? && controller.is_a?(TasksModeratorController)
  can :read, Task
end

# All users can read there own tasks
can :read, Task, :user_id => user.id 
```

# c# - 通过命令行编译c#代码时如何使用引用

> ID：10559125
> 
> 赞同：5
> 
> 时间：2012-05-11T21:52:33.670
> 
> 标签：c#, .net, compiler-construction, command-line, csc

谁能帮我通过命令行编译一些 c# 文件？我有 4 个文件要编译，Main、Form1（使用 2.cs 文件）和项目中使用的另一个类。

我想在命令行中编译这个项目，这样我就可以添加 /t:library 开关（就像在本教程中一样：http: [//dotnetslackers.com/articles/csharp/WritingAnActiveXControlInCSharp.aspx](http://dotnetslackers.com/articles/csharp/WritingAnActiveXControlInCSharp.aspx)）。

但是，在使用“csc /t:library Program1.cs MainForm.cs MainForm.Designer.cs EigenObjectRecognizer.cs”后，我得到了缺少程序集参考错误，例如：

```
\Project\FaceRecProOVaspVer\FaceRecProOV\MainForm.cs(14,15): error CS0234: The type or namespace name 'Structure' does not exist
    in the namespace 'Emgu.CV' (are you missing an assembly reference?) 
```

我确实安装了 EMGU 二进制文件。我认为我需要使用该文件夹中的一些 .dll，例如 EMGU.CV.dll？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-11T21:56:31.963

要在命令行上引用库，您需要使用`/r:`编译器选项并将相对路径传递给库。假设它在同一目录中，您可以执行以下操作

> csc /r:EMGU.CV.dll /t:library Program1.cs MainForm.cs MainForm.Designer.cs EigenObjectRecognizer.cs

文档：http: [//msdn.microsoft.com/en-us/library/yabyz3h4](http://msdn.microsoft.com/en-us/library/yabyz3h4)。通过指定可以直接从命令行获得的简短文档版本`/?`：`C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc /?`

# openssl - sha1的差异

> ID：10559127
> 
> 赞同：1
> 
> 时间：2012-05-11T21:52:39.567
> 
> 标签：openssl, sha1

试图弄清楚为什么我的 base64 sha1 是不同的。

我明白了

> 密码 'a' 结果 'hvfkN/qlp/zhXR3cuerq6jd2Z7g='

使用我的 java 函数时。我可以使用一些随机的在线工具来验证这一点。

但是，当我尝试使用命令行和 openssl 进行验证时

```
echo a | openssl dgst -binary -sha1 | openssl base64 
```

我明白了

> P3hoUOOHVQ/auDbtfm3Igd4jABs=

那可能是 utf8/bash 的东西，所以我尝试了

```
echo 'a' | iconv --from-code=ISO-8859-1 --to-code=UTF-8 | openssl dgst -binary -sha1 | openssl base64 
```

结果相同。

我错过了什么？

编辑：

验证我的原始结果的站点 [http://www.tools4noobs.com/online_php_functions/sha1/](http://www.tools4noobs.com/online_php_functions/sha1/)以计算十六进制 sha1

86f7e437faa5a7fce15d1ddcb9eaeaea377667b8

将十六进制转换为 base64 [http://tomeko.net/online_tools/hex_to_base64.php?lang=en](http://tomeko.net/online_tools/hex_to_base64.php?lang=en)

hvfkN/qlp/zhXR3cuerq6jd2Z7g=

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:00:17.257

`echo`附加一个换行符，它将包含在摘要计算中；试试吧`printf`。还要小心管道的其他部分添加无关的换行符或其他字符。

# xslt - XSLT 按原样复制

> ID：10559129
> 
> 赞同：0
> 
> 时间：2012-05-11T21:52:49.350
> 
> 标签：xslt, copying

我有 xml 我想按原样复制（检查 xmlns="" 和标签。我想按原样创建。总计算被照顾。只有这个问题。它是有效的。仍然客户希望预期的格式像任何帮助都非常感谢。

源代码.xml

```
 <Employees>
       <employee>
        <dept>1</dept>
        <sec></sec>
         <employee>
          <employee>
           <dept>2</dept>
               <sec></sec>
            <employee>
            </Employees> 
```

预期结果.xml

```
 <Employees xmnls="1.2" xmlns:xsi="3" xsi:schemalocation="4">
                    <totalemp>2</totalemp>
                   <employee>
                     <dept>1</dept>
                      <sec></sec>
                     <employee>
                      <employee>
                           <dept>2</dept>
                                  <sec></sec>
                         <employee>
                        </Employees> 
```

实际结果

```
 <Employees>
                              <totalemp>2</totalemp>
                               <employee xmlns="">
                                <dept>1</dept>
                                  <sec/>
                                </employee>
                                 <employee>
                                   <dept>2</dept>
                                      <sec/>
                                   <employee>
                                  </Employees> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:16:29.793

为了获得`<sec/>`类似的输出`<sec></sec>`，请尝试添加`method="html"`到您的`xsl:output`（如果有的话？）。

例子：

**XML 输入**（格式正确）：

```
<Employees>
  <employee>
    <dept>1</dept>
    <sec/>
  </employee>
  <employee>
    <dept>2</dept>
    <sec/>
  </employee>
</Employees> 
```

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output indent="yes" method="html"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="Employees">
    <xsl:copy>
      <xsl:apply-templates select="@*"/>
      <totalemp><xsl:value-of select="count(employee)"/></totalemp>
      <xsl:apply-templates/>
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

**XML 输出**（用 Xalan 和 Saxon 6.5.5 测试）

```
<Employees>
   <totalemp>2</totalemp>
   <employee>
      <dept>1</dept>
      <sec></sec>
   </employee>
   <employee>
      <dept>2</dept>
      <sec></sec>
   </employee>
</Employees> 
```

# objective-c - 当有人在 Objective-C 类/对象中使用特定方法时限制使用/生成编译错误

> ID：10559132
> 
> 赞同：2
> 
> 时间：2012-05-11T21:52:56.700
> 
> 标签：objective-c, overriding, subclass, pragma

假设我有一个`AwesomeClass`但我无法更改它的实现（即它来自静态库或框架）。我喜欢一切，`AwesomeClass`除了`- (void)thatOneBadMethod`。我可以将其子类化为`AwesomeClass`并`MyAwesomeClass`使用空实现（而不是调用`super`）覆盖该方法，但问题是，如果我的开发人员正在使用`MyAwesomeClass`并且不知道我的行为，他可能会尝试使用`thatOneBadMethod`认为它正在做的事情它不是。

是否有一些预处理器指令我可以放入覆盖中，`thatOneBadMethod`以便他在尝试使用它时收到编译器错误或警告？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:54:47.073

您可以在头文件中[弃用该方法：](http://clang.llvm.org/docs/LanguageExtensions.html#deprecated)

```
-(void)thatOneBadMethod __attribute__ ((deprecated("Unsupported, please call 'thatOneGoodMethod' instead!"))); 
```

但我也建议当人们尝试调用它时产生一个错误：

```
-(void)thatOneBadMethod {
  NSAssert(NO, @"Unsupported, please call 'thatOneGoodMethod' instead!");
} 
```

# php - PHP 选择带权重的随机数

> ID：10559133
> 
> 赞同：3
> 
> 时间：2012-05-11T21:52:59.643
> 
> 标签：php, random, probability

假设我想随机`choose`取一个数字`1-10`，但每个数字都有权重。

```
1 - 15% chance
2 - 15% chance
3 - 12% chance
4 - 12% chance
5 - 10% chance
6 - 10% chance
7 - 8% chance
8 - 8% chance
9 - 5% chance
10 - 5% chance 
```

我将如何进行编码`PHP`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:54:49.990

我假设你的百分比加起来是 100%？

构建一个数组

```
15 times a '1' value, 
15 times a '2' value, 
... 
10 times a '6' value, 
8 times a '7' value,
...
5 times 1 '10' value 
```

您最终将得到一个包含 100 个元素的数组。

随机选择一个元素（并从数组中弹出它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:57:09.290

如果你的权重是百分比，选择一个介于 0 到 100 之间的随机数，然后迭代地减去百分比，直到你越过零：

```
<?php
function getWeightedRandom() {
    $weights = array(15, 15, 12, ...); // these should add up to 100
    $r = rand(0, 99);
    for ($i=0; $i<count($weights); $i++) {
        $r -= $weights[$i];
        if ($r < 0)
            return $i+1;
    }
}
?> 
```

这具有支持非整数权重的额外好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T21:57:34.867

具有以下类的 OP 权重的示例回显值：

`echo 1+Rand::get_weighted_rand(array(15,15,12,12,10,10,8,8,5,5));`

和班级：

```
class Rand
{
    /*
     * generates a random value based on weight
     * @RETURN MIXED: returns the key of an array element
     * @PARAM $a ARRAY:
     *  the array key is the value returned and the array value is the weight
     *      if the values sum up to less than 100 than the last element of the array 
     *      is the default value when the number is out of the range of other values
     * @PARAM $p INT: number of digits after decimal
     *
     * i.e array(1=>20, 'foo'=>80): has an 80 chance of returning Foo
     * i.e array('bar'=>0.5, 2=>1, 'default'=>0), 1: 98.5% chance of returning default
     */
    public static function get_weighted_rand($a, $p=0)
    {
        if(array_sum($a)>100)
            return FALSE;#total must be less than 100
        $p=pow(10, $p+2);
        $n=mt_rand(1,$p)*(100/$p);
        $range=100;
        foreach($a as $k=>$v)
        {
            $range-=$v;
            if($n>$range)
                return $k;
        }
            #returning default value
        end($a);
        return key($a);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T21:55:31.393

将它们全部多次放入数组中，例如 1 15 次，3 12 次等等。然后从该数组中选择一个随机数。

```
$array = array_merge (array_fill (0, 15, 1), array_fill (0, 15, 2), array_fill (0, 12, 3), array_fill (0, 12, 4), array_fill (0, 10, 5), array_fill (0, 10, 6), array_fill (0, 8, 7), array_fill (0, 8, 8), array_fill (0, 5, 9), array_fill (0, 5, 10));
$random_number = array_rand ($array); 
```

# django - 来自 QuerySet 的 Django 管理表单验证

> ID：10559143
> 
> 赞同：1
> 
> 时间：2012-05-11T21:54:35.857
> 
> 标签：django, django-forms, django-admin, django-validation

我有这两个模型：

```
class Service(MelosModel):
    performer = models.ForeignKey(Performer)
    event = models.ForeignKey('Event')
    composition = models.ForeignKey(Composition)

class Event(MelosModel):
    event_type = models.ForeignKey('EventType')
    project = models.ForeignKey(Project)
    works = models.ManyToManyField(Work)
    date_of_event = models.DateTimeField()
    location = models.ForeignKey(Address) 
```

*注意：A`MelosModel`的所有意图和目的都与`models.Model`. 此外，`Composition`扩展`Work`.*

问题是`Service`管理表单中的组合列表需要根据可用`Work`的 s进行验证，`Event.`您如何做到这一点？

我读过关于`ModelChoiceField`从查询集中创建一个，但这无济于事，因为在`Event`提交表单之前我们不知道它是什么。处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T15:03:17.277

如果我理解正确，您可以在服务模型类上编写一个[clean() 方法](https://docs.djangoproject.com/en/dev/ref/models/instances/#django.db.models.Model.clean)来进行自定义验证。

# python - Matplotlib 字幕打印在旧标题上

> ID：10559144
> 
> 赞同：13
> 
> 时间：2012-05-11T21:54:38.150
> 
> 标签：python, matplotlib

我正在尝试使用`suptitle`打印标题，并且我想偶尔替换此标题。目前我正在使用：

```
self.ui.canvas1.figure.suptitle(title) 
```

其中 figure 是 matplotlib 图（canvas1 是 mplCanvas，但这不相关），并且 title 是 python 字符串。

目前，这可行，除了当我稍后再次运行此代码时，它只是将新文本打印在旧文本之上，导致标题混乱、不可读。

你如何替换旧`suptitle`的图形，而不仅仅是打印出来？

谢谢，

泰勒

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-11T22:52:45.253

`figure.suptitle`返回一个`matplotlib.text.Text`实例。您可以保存它并设置新标题：

```
txt = fig.suptitle('A test title')
txt.set_text('A better title')
plt.draw() 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-16T19:02:57.723

复活这个旧线程，因为我最近遇到了这个问题。在 figure.texts 中有一个对 suptitle 的原始设置返回的 Text 对象的引用。您可以使用它来更改原始文件，直到在 matplotlib 中修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-26T10:12:12.270

我有类似的问题。图形对象的替代方法显示旧标题（以前创建）的标题。这绝对是 matplotlib 中的一个错误。特别是您可以在 figure.py（matplotlib 包的一部分）中找到此代码：

```
 (...)

        sup = self.text(x, y, t, **kwargs)
        if self._suptitle is not None:
            self._suptitle.set_text(t)
            self._suptitle.set_position((x, y))
            self._suptitle.update_from(sup)
        else:
            self._suptitle = sup
        return self._suptitle 
```

幸运的是，这个错误存在于 matplotlib 版本 1.2.1 中，但后来被修复（在 2.2.4 中，它不再存在）。尝试更新 matplotlib，它会为您修复它。

# scala - Scala隐式转换实现Java接口的通用特征

> ID：10559145
> 
> 赞同：1
> 
> 时间：2012-05-11T21:54:41.457
> 
> 标签：scala, generics, implicit-conversion

几天来，我一直在研究隐式转换的问题，但不知何故，我无法弄清楚我做错了什么。我通读了关于 SO 的所有其他涉及隐式的问题，但我仍然不明白问题是什么。

例如，让我们考虑这样的 Java 接口（为简洁起见，T 扩展了 Object）：

```
public interface JPersistable<T extends Object> {
    public T persist(T entity);
} 
```

在 scala 中，我执行以下操作：

```
case class A()
case class B() extends A
case class C()
case class D() extends C

trait Persistable[DTOType <: A, EntityType <: C] {
  // this would be implemented somewhere else
  private def doPersist(source: EntityType): EntityType = source

  // this does not implement the method from the Java interface
  private def realPersist(source: DTOType)(implicit view: DTOType => EntityType): EntityType = doPersist(source)

  // this DOES implement the method from the Java interface, however it throws:
  // error: No implicit view available from DTOType => EntityType.
  def persist(source: DTOType): EntityType = realPersist(source)
}

case class Persister() extends Persistable[B, D] with JPersistable[B]

object Mappings {
  implicit def BToD(source: B): D = D()
}

object Test {
  def main(args: Array[String]) {

    import Mappings._
    val persisted = Persister().persist(B())
  }
} 
```

如评论中所述，我在编译时遇到异常。我想我的问题是：

1）为什么我需要`doRealPersist`显式指定隐式转换？即使我执行以下操作，我也希望转换发生：

```
trait Persistable[DTOType <: A, EntityType <: C] {
  // this would be implemented somewhere else
  private def doPersist(source: EntityType): EntityType = source

  def persist(source: DTOType): EntityType = doPersist(source)
} 
```

但是，这也不能编译。

2) 为什么编译在`persist`实际的方法调用 () 处而不是在实际的方法调用处失败`val persisted = Persister().persist(B())`？那应该是第一个知道 EntityType 和 DTOType 的实际类型的地方，对吧？

3）有没有更好的方法来做我想要实现的目标？同样，这不是我想要做的实际事情，但足够接近。

如果这个问题是无知的，请提前道歉，并提前非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:27:28.497

您需要*在 trait*中提供转换。您不能从外部隐式传递它，因为外部不知道需要隐式转换的`persist`秘密需要。`realPersist`这一切都失败了，即使没有考虑`JPersistable`。

例如，您可以添加

```
implicit def view: DTOType => EntityType 
```

作为特征中的一个方法，然后它将被编译。（你也可以放弃`realPersist`。）

然后，您需要一种方法来设置该视图。你可以

```
case class Persister()(implicit val view: B => D) extends Persistable[B,D] 
```

然后你们都很好。（`implicit val`满足`implicit def`特征的 。）

但是现在您遇到了更大的问题：您的 Java 接口签名*与您的 Scala 签名不匹配*。等效的 Scala 是

```
trait JPersistable[T <: Object] { def persist(t: T): T } 
```

看看如何`persist`获​​取和返回相同的类型？看看它在你的 Scala 类中是如何*不存在的？*那是行不通的，也不应该！因此，您必须重新考虑您要在这里完成的工作。也许你只是想让隐式转换可用——而不是将它传递给方法！——让 Scala 为你应用隐式转换，这样你就认为你有一个`persist`映射 from `DTOType`to `EntityType`，但你真的只有`EntityType`转换`EntityType`Java接口所需的。

* * *

编辑：例如，这是您使用标准隐式转换发布的工作版本：

```
trait JPer[T] { def persist(t: T): T }
class A
case class B() extends A
class C
case class D() extends C
trait Per[Y <: C] extends JPer[Y] {
  private def doIt(y: Y): Y = y
  def persist(y: Y) = doIt(y)
}
case class Perer() extends Per[D] // "with JPer" wouldn't add anything!
object Maps { implicit def BtoD(b: B): D = D() }
object Test extends App {
  import Maps._
  val persisted = Perer().persist(B())
} 
```

注意在哪里使用了哪些类型！（谁接受`B`，谁接受`D`，你需要转换哪个方向？）

# java - 如何从该程序的运行时间中缩短 0.1 秒？

> ID：10559150
> 
> 赞同：-3
> 
> 时间：2012-05-11T21:55:09.677
> 
> 标签：java, optimization, binomial-coefficients

我正在 InterviewStreet 进行练习程序，我有一个运行时间为 5.15xx 秒的解决方案，而 Java 解决方案允许的最长时间为 5 秒。我能用我在这里的东西做些什么来让它在 5 秒内完成吗？还有一个 256 MB 的限制，所以据我所知，这是解决问题的最节省时间和内存的方法......

编辑：N 和 K 的可能值是 N <= 10^9 和 K <= N，这就是为什么我选择使用 BigInteger 做所有事情的原因。最大试验次数为 10000。因此，基本上，您输入试验次数，然后输入每个试验次数的一对整数值，程序在第二个循环中计算方程的三个版本的二项式系数。我认为将所有内容读入数组，然后处理数组并将结果放入第三个数组以由第三个循环处理会更快，因为我认为这样可能会更快。我尝试在同一个循环中执行所有操作，但运行速度较慢。

我已经尝试了三种或四种不同的算法来计算二项式系数（nCr - 或 n 选择 r，都是说同一件事的不同方式）。一些算法涉及二维数组，如 c[n][k]。这是我提交的唯一没有出现某种内存错误的解决方案。答案需要输出 mod (10 ^ 6) + 3，因为 nCr * nCr 的答案非常庞大。该程序的示例运行是：

```
3

4 1
5 2
90 13

2
5
815483 
```

不能在更快的机器上运行它，因为它需要通过他们的机器来计算，基本上我提交代码并针对他们的测试用例运行它，我不知道他们的测试用例是什么，只是输入是在上面给出的范围内。

和程序本身：

```
import java.math.BigInteger;
import java.util.Scanner;

public class Solution {

public BigInteger nCr(int n, int r) {
    if (r > n ) {
        return BigInteger.ZERO;
    }

    if (r > n / 2) {
        r = n - r;
    }
    BigInteger result = BigInteger.ONE;

    for (int i = 0; i < r; i++) {
        result = result.multiply(BigInteger.valueOf(n - i));
        result = result.divide(BigInteger.valueOf(i + 1));
    }
    return result;
}

public static void main(String[] args) {
    Scanner input = new Scanner( System.in );
    BigInteger m = BigInteger.valueOf(1000003);
    Solution p = new Solution();
    short T = input.nextShort(); // Number of trials
    BigInteger intermediate = BigInteger.ONE;
    int[] r = new int[T];
    int[] N = new int[T];
    int[] K = new int[T];

    short x = 0;

    while (x < T) {
    N[x] = input.nextInt();
    K[x] = input.nextInt();
    x++;
    }

    x = 0;
    while (x < T) {
    if (N[x] >= 3) { 
            r[x] = ((p.nCr(N[x] - 3, K[x]).multiply(p.nCr(N[x] + K[x], N[x] - 1))).divide(BigInteger.valueOf((N[x] + K[x]))).mod(m)).intValue();
        } else {
            r[x] = 0;
    }
    x++;
    }

    x = 0;
    while (x < T) {
    System.out.println(r[x]);
    x++;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:07:07.503

不完全确定该算法试图完成什么，但我根据您对帖子的标记猜测二项式系数。

您需要检查我的建议是否修改了结果，但看起来您可以合并两个 while 循环：

原来的：

```
while (x < T) {
    N[x] = input.nextInt();
    K[x] = input.nextInt();
    x++;
}

x = 0;
while (x < T) {
if (N[x] >= 3) { 
        r[x] = ((p.nCr(N[x] - 3, K[x]).multiply(p.nCr(N[x] + K[x], N[x] - 1))).divide(BigInteger.valueOf((N[x] + K[x]))).mod(m)).intValue();
    } else {
        r[x] = 0;
    }
    x++;
} 
```

新的：

```
x = 0;
while (x < T) {

//this has been moved from your first while loop
N[x] = input.nextInt();
K[x] = input.nextInt();

if (N[x] >= 3) { 
        r[x] = ((p.nCr(N[x] - 3, K[x]).multiply(p.nCr(N[x] + K[x], N[x] - 1))).divide(BigInteger.valueOf((N[x] + K[x]))).mod(m)).intValue();
    } else {
        r[x] = 0;
    }
    x++;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-11T22:16:25.833

尝试使用 profilerm 例如 jvisualvm 运行并运行此类

-Dcom.sun.management.jmxremote

附加到流程并启动配置文件。

# c - 我怎样才能让 isalnum() 正确接受字符串

> ID：10559151
> 
> 赞同：0
> 
> 时间：2012-05-11T21:55:21.347
> 
> 标签：c

我正在尝试转换一些代码，这些代码旨在从命令行参数中删除除“_”之外的所有非数字字符，除了命令行参数之外，我试图让代码接受来自常规字符串的输入，我试图将代码转换为接受字符串，但我不断收到此错误

```
words.c:9: warning: assignment makes pointer from integer without a cast 
```

我对自己做错了什么感到困惑，所以我真的很感激能在这个问题上得到任何帮助，谢谢！

这里也是接受命令行参数的原始代码

```
#include <stdio.h>
#include <string.h>
#include <ctype.h>
int main(int argc, char ** argv) {
    int i;
    char *p;
    if (argc > 1) {
        for (p = argv[1]; *p != '\0'; p++) {
           if (islower(*p) || isdigit(*p) || *p == '_') {
               putchar (*p);
           }
        }
        putchar ('\n');
    }
    return 0;
} 
```

这是我的“版本”

```
#include <stdio.h>
#include <string.h>
#include <ctype.h>
int main(void) {
    int i;
    char *p;
    char stg[] = "hello";
   // if (argc > 1) {
        for (p = stg[1]; *p != '\0'; p++) {
           if (isalnum(*p) || *p == '_') {
               putchar (*p);
           }
        }
        putchar ('\n');
     return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:57:42.027

在您的代码`p`中是一个指针。更改`p = stg[1];`为`p = &stg[1];`。

# javascript - JQuery .hasClass 用于 if 语句中的多个值

> ID：10559153
> 
> 赞同：84
> 
> 时间：2012-05-11T21:55:28.993
> 
> 标签：javascript, jquery, syntax, logic

我有一个简单的 if 语句：

```
if ($('html').hasClass('m320')) {

// do stuff 

} 
```

这按预期工作。但是，我想向 中添加更多类以检查标记`if statement`中是否存在任何类。`<html>`我需要它，所以它不是全部，而只是至少一个班级的存在，但它可以更多。

我的用例是我为各种视口宽度添加了类（例如`m320`，`m768`），所以如果它是特定宽度（类），我只想执行某些 Jquery。

这是我到目前为止所尝试的：

1.

```
if ($('html').hasClass('m320', 'm768')) {

// do stuff 

} 
```

2.

```
if ($('html').hasClass('m320')) || ($('html').hasClass('m768')) {

 // do stuff 

} 
```

3.

```
 if ($('html').hasClass(['m320', 'm768'])) {

 // do stuff 

    } 
```

但这些似乎都不起作用。不确定我做错了什么，但很可能是我的语法或结构。

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2012-05-11T21:58:06.730

您可以使用`is()`而不是`hasClass()`：

```
if ($('html').is('.m320, .m768')) { ... } 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2012-05-11T21:57:59.570

您在第二次尝试中只是有一些混乱的括号。

```
var $html = $("html");

if ($html.hasClass('m320') || $html.hasClass('m768')) {

  // do stuff 

} 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-05-11T22:11:28.667

为了好玩，我写了一个小的 jQuery 附加方法，它将检查多个类名中的任何一个：

```
$.fn.hasAnyClass = function() {
    for (var i = 0; i < arguments.length; i++) {
        if (this.hasClass(arguments[i])) {
            return true;
        }
    }
    return false;
} 
```

然后，在您的示例中，您可以使用它：

```
if ($('html').hasAnyClass('m320', 'm768')) {

// do stuff 

} 
```

您可以传递任意数量的类名。

* * *

这是一个增强版本，它还允许您传递多个由空格分隔的类名：

```
$.fn.hasAnyClass = function() {
    for (var i = 0; i < arguments.length; i++) {
        var classes = arguments[i].split(" ");
        for (var j = 0; j < classes.length; j++) {
            if (this.hasClass(classes[j])) {
                return true;
            }
        }
    }
    return false;
}

if ($('html').hasAnyClass('m320 m768')) {
    // do stuff 
} 
```

工作演示：http: [//jsfiddle.net/jfriend00/uvtSA/](http://jsfiddle.net/jfriend00/uvtSA/)

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2013-05-31T13:50:30.107

这可能是另一种解决方案：

```
if ($('html').attr('class').match(/m320|m768/)) {  
  // do stuff   
} 
```

根据[jsperf.com](http://jsperf.com/hasclass-vs-is-stackoverflow/7)，它也非常快。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-11-30T00:34:53.663

对于任何想知道所有这些不同选项的不同性能方面的人，我在这里创建了一个 jsperf 案例：[jsperf](http://jsperf.com/hasclass-vs-is-rsteffer)

总之，使用`element.hasClass('class')`是最快的。

下一个最佳选择是使用`elem.hasClass('classA') || elem.hasClass('classB')`. 关于这一点的说明：订单很重要！如果更可能找到类“classA”，请先列出它！OR 条件语句在满足其中之一时立即返回。

到目前为止，性能最差的是使用`element.is('.class')`.

jsperf 中还列出了 Cyber​​Monk[的功能](https://stackoverflow.com/a/14887517/2953985)和[Kolja 的解决方案](https://stackoverflow.com/a/16858898/2953985)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-15T02:32:24.910

以下是 jfriend00 提供的答案略有不同：

```
$.fn.hasAnyClass = function() {
    var classes = arguments[0].split(" ");
    for (var i = 0; i < classes.length; i++) {
        if (this.hasClass(classes[i])) {
            return true;
        }
    }
    return false;
} 
```

允许使用与 .addClass() 和 .removeClass() 相同的语法。例如，`.hasAnyClass('m320 m768')` 当然需要防弹，因为它至少假设一个论点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-11T22:06:53.180

```
var classes = $('html')[0].className;

if (classes.indexOf('m320') != -1 || classes.indexOf('m768') != -1) {
    //do something
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-12T14:25:48.470

hasClass 方法将接受一个类名数组作为参数，你可以这样做：

```
$(document).ready(function() {
function filterFilesList() {
    var rows = $('.file-row');
    var checked = $("#filterControls :checkbox:checked");

    if (checked.length) {
        var criteriaCollection = [];

        checked.each(function() {
            criteriaCollection.push($(this).val());
        });

        rows.each(function() {
            var row = $(this);
            var rowMatch = row.hasClass(criteriaCollection);

            if (rowMatch) {
                row.show();
            } else {
                row.hide(200);
            }
        });
    } else {
        rows.each(function() {
            $(this).show();
        });
    }
}

    $("#filterControls :checkbox").click(filterFilesList);
    filterFilesList();
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-11-09T17:29:03.703

这是为了以防您需要两个类。对于任何一个或逻辑，只需使用 ||

```
$('el').hasClass('first-class') || $('el').hasClass('second-class') 
```

随意根据需要进行优化

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-10-14T11:49:51.467

尝试这个：

```
if ($('html').hasClass('class1 class2')) {

// do stuff 

} 
```

# java - JBoss AS 7.1 上的会话计数

> ID：10559154
> 
> 赞同：1
> 
> 时间：2012-05-11T21:55:29.913
> 
> 标签：java, session, web-applications, servlets, jboss7.x

如何查看我的 JBoss AS 7.1 实例的 http-session 计数。

我在 JBoss Application Server 7.1 管理控制台上找不到任何东西。

上次我使用 JBoss AS 是 4.3 版。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:59:31.573

如果您正在谈论特定应用程序，那么您可以使用“HttpSessionListener”或使用“HttpSessionBindingListener” [http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpSessionBindingListener.html](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpSessionBindingListener.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-17T09:35:15.980

这将从 servlet 容器内部查看会话。另一方面，容器也应该能够计算它们。旧的 JBoss 能够公开有关 JMX bean 的信息

```
jboss.web:host=localhost,path=/<context-name>,type=Manager 
```

具有名为“activeSessions”的属性。

在最近的 JBoss 上，该值在不同的位置可用，最好在这里解释： [https ://developer.jboss.org/thread/219739?_sscc=t](https://developer.jboss.org/thread/219739?_sscc=t)

# php - 为什么不能在类中的数组值中使用运算符？

> ID：10559159
> 
> 赞同：2
> 
> 时间：2012-05-11T21:56:07.070
> 
> 标签：php, class

试试这个：

```
$test = array (2+2);
var_dump($test); 
```

然后在一个类中尝试相同的方法：

```
class test {
    public $test = array(2+2);
} 
```

我只想知道为什么会出现解析器错误，以及如何（在一个类中）尽可能地解决这个问题，使其代码友好和高性能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T21:58:09.037

您不能使用语句来初始化类字段。它必须是一个字面量，一个常量值。一种解决方法是使用构造函数：

```
class Test {
    public $test;

    public function __construct() {
        $this->test = array(2+2);
    }
} 
```

从**[手册：](http://il.php.net/manual/en/language.oop5.properties.php)**

> 类成员变量称为“属性”。您可能还会看到使用“属性”或“字段”等其他术语来提及它们，但出于本参考的目的，我们将使用“属性”。它们是通过使用关键字`public`、`protected`或之一来定义的`private`，后跟一个普通的变量声明。**这个声明可能包括一个初始化，但是这个初始化必须是一个常量值——也就是说，它必须能够在编译时被评估，并且不能依赖于运行时信息才能被评估。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:59:09.787

原因是对类中属性的赋值必须是静态声明。它们不能是被评估的表达式。

那就是你可以这样做：

```
public $test = array(4); // static assignment
public $test = 'some string'; // static assignment
public $test = strtoupper('  some string  '); // invalid, expression
public $test = $global_variable; // invalid, not a constant expression
public $test = time(); // invalid, an expression 
```

# c - C 中的堆头和 free()

> ID：10559160
> 
> 赞同：1
> 
> 时间：2012-05-11T21:56:11.473
> 
> 标签：c

我想知道是否有人可以向我指出一个对堆进行深入解释的资源。我想了解更多关于实践中使用的标头以及 free() 函数如何通过删除标头信息来实际“释放”内存。许多资源只是给出通用的

```
 struct heapHeader
     {
       heapHeader* next;
       heapHeader* previous;
       unsigned int size;
     } 
```

然后继续说这在实践中从未实施过。所以，总结一下，我想更多地了解堆头是如何在“实践”中实现的，以及诸如 free() 之类的函数如何与所述头交互。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T22:45:57.940

C 语言标准没有定义堆的细节。它根据它们执行的任务、它们的参数以及程序员可以对结果做什么来指定 malloc、calloc、realloc 和 free。

如果您询问实现细节，您很容易做出可能会在以后咬到您的假设。除非您有非常具体的理由这样做，否则您不需要调查内部工作原理。malloc 和 free 工作的方式可能会随着下一个 OS 版本、下一个编译器版本甚至使用的编译选项而改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T22:03:52.707

以下是一篇有趣的文章：关于堆管理的全面的、描述性的。

[1] [http://www.apriorit.com/our-company/dev-blog/209-linux-memory-management](http://www.apriorit.com/our-company/dev-blog/209-linux-memory-management)

简单的实现示例：

[2] [http://lambda.uta.edu/cse5317/notes/node45.html](http://lambda.uta.edu/cse5317/notes/node45.html)

希望有帮助。

# objective-c - paymentQueueRestoreCompletedTransactionsFinished：当它应该有交易时返回一个空队列

> ID：10559161
> 
> 赞同：10
> 
> 时间：2012-05-11T21:56:11.567
> 
> 标签：objective-c, ios, storekit

这是我第一次使用 Store Kit，在我尝试恢复购买之前一切都很好。我已经看过其他几篇关于堆栈溢出的关于类似问题的帖子，但我还没有找到适合我的解决方案。

我的应用程序中有一个按钮，可以调用`[[SKPaymentQueue defaultQueue] restoreCompletedTransactions]`. 这反过来又触发了`SKPaymentTransactionObserver`方法`paymentQueueRestoreCompletedTransactionsFinished:`。问题是`paymentQueueRestoreCompletedTransactionsFinished:`返回队列中的事务为零。

如果我随后尝试进行购买，则会通知我我已经进行了购买。这告诉我商店知道我的测试 Apple ID 在之前的尝试中成功进行了购买。那么为什么`paymentQueueRestoreCompletedTransactionsFinished:`在它的队列上返回一个空的事务集合呢？

有人提到沙盒的行为不正常，但在我上线 AppStore 之前，我需要看看它是否正常工作。

有任何想法吗？我错过了什么吗？

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T13:15:33.663

你在处理交易`-paymentQueue:updatedTransactions:`吗？此回调在`paymentQueueRestoreCompletedTransactionsFinished:`回调之前获取您恢复的交易。

您应该在内部进行还原处理和处理`-paymentQueue:updatedTransactions:`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-06T05:08:50.157

我相信这是沙盒 App Store 的一个错误。我的恢复不适用于我的测试帐户（创建于 iOS 5.0 时代）。`-paymentQueue:updatedTransactions:`在恢复期间没有被调用。

正如**process255**的评论所建议的，我在 iTunes Connect 中创建了一个新的测试用户。使用新的测试帐户，一切正常！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-04T12:49:32.553

这**取决于产品类型**，哪些产品将重新排队：

```
-(void)paymentQueueRestoreCompletedTransactionsFinished:(SKPaymentQueue *)queue 
```

作为替代方案，请阅读以下收据：

```
[[NSBundle mainBundle] appStoreReceiptURL] 
```

收据的唯一问题是它们存储在本地，但苹果不会让它挂起..当然，购买也保存在苹果服务器上。通过以下方式刷新/加载收据：

```
 SKReceiptRefreshRequest *recreq = [[SKReceiptRefreshRequest alloc] init];
[recreq start]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-24T19:57:56.473

我遇到了同样的问题，但我没有创建新用户，而是去了设置中的 iTunes 和 Aoo 商店，然后退出沙盒测试帐户并再次尝试。在职的！

# ubuntu - Mercurial 森林扩展：未找到

> ID：10559164
> 
> 赞同：1
> 
> 时间：2012-05-11T21:56:25.723
> 
> 标签：ubuntu, mercurial, ubuntu-11.04, kubuntu

我启用了 Mercurial 森林扩展：

hgext.森林=

但是仍然找不到命令“fclone”。

我猜这个扩展没有安装。

如何在 Kubuntu 11.04 上安装森林扩展？（我使用的是 Mercurial v2.2.1）

/usr/share/mercurial 包含 hgk 和 hgext.rc 脚本，那么这是 hgext 目录吗？

我怎样才能得到森林脚本？我在 KPackageKit 中搜索过，但找不到...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:11:01.310

来自[Mercurial 维基](http://mercurial.selenic.com/wiki/ForestExtension)：

**这个第三方扩展似乎没有得到积极维护。考虑改用*subrepos*。此扩展不与 Mercurial 一起分发。**

# browser - 在所有操作系统上完成 WebBrowser 控制？

> ID：10559180
> 
> 赞同：-1
> 
> 时间：2012-05-11T21:58:13.143
> 
> 标签：browser

我想创建一个新的应用程序（我将出售），它使用 Web 浏览器控件自动在 Internet 上发布内容等。

我做了一些研究，看起来大多数人的主要选择是 .NET 网络浏览器控件（通过 IE 实例）。

我不想这样做，因为我希望拥有 Mac 和 Linux 的客户能够使用我的软件。

话虽如此，是否有任何可用的 Web 浏览器控制类或工具包可以在所有操作系统上运行（例如，使用 Java 的东西？）

提前致谢！

**更新：**

Web 浏览器控制基本上是程序能够像人类一样运行并打开 Web 浏览器并访问网站、填写表格、检查电子邮件 (lol) 等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T12:28:53.983

火狐，铬，Safari。我认为除了 IE 之外的所有东西都可以在所有操作系统上运行。当您认为它是由微软制造时，这并不奇怪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T22:25:09.960

[Selenium](http://seleniumhq.org/)库可让您创建脚本（使用 GUI 或一种受支持的语言 [它拥有大多数流行的语言，如 Java、Python 等]），以在所有流行的浏览器（包括 chrome，它适用于所有操作系统，如其他答案提到）。

# c++ - 在延迟对象构造的同时创建动态数组

> ID：10559182
> 
> 赞同：0
> 
> 时间：2012-05-11T21:58:19.147
> 
> 标签：c++, arrays, memory-management

我希望能够“以某种方式”创建一个动态数组，它仍然可以让我使用 new 运算符构建它的元素。这是我想要实现的目标：

```
A* a = new A[3]; //or any equivalent syntax 
new (&a[0]) A(myparams1); //placement new on first slot 
new (&a[1]) A(myparams2, ...); //placement new on 2nd slot 
new (&a[2]) A(myparams3, ...); //placement new on 3rd slot
delete[] a; //correct deletion of all elements 
```

我知道这段代码可以工作（减去覆盖的 3 个元素），但我想避免`a`在第一次调用`new[]`. 我在这里假设我*总是*在调用之前放置 3 个元素`delete[]`。我在想这样的事情可以通过使用智能调用来实现，`A::operator new[]`但我不确定如何。有谁有想法吗？主要是出于好奇

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T22:09:00.820

你只是得到原始内存：

```
void* mem = ::operator new(capacity * sizeof(A)); 
```

任何类型都需要对齐，包括`A`'s 数组。现在您可以在其中构建：

```
for (std::size_t i = 0; i < capacity; ++i)
{
    void* addr = static_cast<char*>(mem) + i * sizeof(A);
    new (addr) A(x, y, z, ...);
} 
```

破坏需要你显式调用它：

```
for (std::size_t i = 0; i < capacity; ++i)
{
    void* addr = static_cast<char*>(mem) + i * sizeof(A);
    static_cast<A*>(addr)->~A();
} 
```

现在您可以释放原始内存：

```
::operator delete(mem); 
```

请注意，这些都不是异常安全的。这也是什么`std::vector<A>`，检查代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T22:07:16.163

使用运算符 new。

```
A a* = (A*) ::operator new(sizeof(A) * 3);
new (&a[0]) A(/* whatever */);
//do stuff
a[0].~A();
::operator delete(a); 
```

请注意手动调用析构函数。使用placement new 时，不会自动调用析构函数，因此由您决定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T22:17:25.147

您可以创建指针数组。

```
A ** a = new A*[3]
a[0] = new A;
a[1] = new A;
a[2] = new A; 
```

您需要调用`delete`每个分配的元素

```
delete a[2];
delete a[1];
delete a[0]; 
```

并删除数组本身`delete[] a;`

# iphone - iPhone 和 jQuery Mobile - 后退按钮按下并重新访问后的链接行为不正确

> ID：10559183
> 
> 赞同：0
> 
> 时间：2012-05-11T21:58:21.627
> 
> 标签：iphone, ios, macos, jquery-mobile

注意：我只能在**iPhone 模拟器**中始终如一地重现该错误，但在整个网站上随机出现类似错误。

jQuery Mobile 以一种特殊的方式运行。如果您在**iPhone Simulator中访问**[此站点](http://mobile.stolaf.edu/sports/new/)并执行以下操作：

 **1.  选择任何团队。[即：男子越野]
2.  单击“返回”。3)
3.  选择任何团队。[即：男子越野]

您会注意到页面快速显示，然后在团队再次显示时隐藏。如果稍微修改一下顺序：

1.  选择任何团队。[即：男子越野]
2.  单击“返回”。3)
3.  重新加载页面。
4.  选择任何团队。[即：男子越野]

然后 jQuery Mobile 行为正常。

任何想法为什么会发生这种情况？

*注意：* 我的 mobileinit 函数如下所示：

```
 $(document).bind("mobileinit", function(){
        $.extend(  $.mobile , { 
              ajaxFormsEnabled : false,
              ajaxLinksEnabled : false, 
              defaultPageTransition : 'none'
         });
         $.mobile.ajaxEnabled = false;
  }); 
```**

# c# - 从服务中检索 Json 并传递给 ApiController

> ID：10559187
> 
> 赞同：2
> 
> 时间：2012-05-11T21:58:30.577
> 
> 标签：c#, asp.net, asp.net-mvc-4

我想直接从服务层中的外部 API 捕获 JSON，将其返回到 MVC 4 ApiController，然后通过该 ApiController 输出 JSON。我基本上是在围绕另一个 API 服务编写一个包装器，因为必须同时发生一些其他操作（身份验证等）。问题是 JSON 被转换为字符串并在我的 C# 代码中作为字符串传递。这只是将转义字符添加到 JSON。无论如何我可以在我的 C# 代码中传递 JSON 对象吗？我的实施细节如下。

在服务层中，我正在使用通过以下方法提供 JSON 的 API。

```
return new WebClient().DownloadString(url); 
```

不幸的是，这会返回一个字符串。由于这个 API 已经向我返回 JSON，这是有问题的，因为很多转义字符被添加到字符串中。

JSON 应该看起来像这样

```
[{"Citation":{"Attachments":[{"AttachedPersonIds":null,..."Type":"Record"}] 
```

但它现在看起来像这样

```
"[{\"Citation\":{\"Attachments\":[{\"AttachedPersonIds\":null,...\"Type\":\"Record\"}]" 
```

在我得到这个字符串后，我通过几个方法将它返回给 ApiController（设置为返回 JSON），就像这样。

```
public class HintsController : ApiController
{
    public string Get(string treeId, string personId)
    {
        return _hintService.GetHints(treeId, personId);
    }
} 
```

我尝试将字符串转换为文字字符串并尝试再次序列化字符串。这样做只会添加更多的转义字符，并不能解决问题。我认为问题在于我如何使用初始调用，因为它将它从 JSON 转换为字符串。但我不知道如何避免这种情况。

提前感谢您的任何想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T06:46:11.343

因为控制器返回一个字符串，所以 JSON 格式化程序将整个字符串序列化为 JSON 字符串并转义嵌入的引号字符。

你可以这样做：

```
public HttpResponseMessage Get()
{
    var resp = new HttpResponseMessage()
    {
        Content = new StringContent("{json here...}")
    };
    resp.Content.Headers.ContentType = 
                  new MediaTypeHeaderValue("application/json");
    return resp;
} 
```

这假设您总是希望返回 JSON。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T07:06:36.487

`dynamic`如果你真的想传递对象，你可以把它变成一个对象并传递它。

我不知道文字转义字符来自哪里，你能更清楚一点吗？是 API 生成它们，还是我们的代码中有其他点？我之前在调试窗口中看到过它们，当时字符串实际上并不包含它们，并且打印/等工作正常。

您可以使用 Json.net（标准）、内置序列化程序、[https://github.com/jsonfx/jsonfx](https://github.com/jsonfx/jsonfx)等。

从[jsonfx](https://github.com/jsonfx/jsonfx)网站：

```
var reader = new JsonReader(); var writer = new JsonWriter();
string input = @"{ ""foo"": true, ""array"": [ 42, false, ""Hello!"", null ] }";

dynamic output = reader.Read(input);
Console.WriteLine(output.array[0]); // 42
string json = writer.Write(output);
Console.WriteLine(json); // {"foo":true,"array":[42,false,"Hello!",null]} 
```

还有其他几种方法，请参阅这些线程：

*   [使用 Json.net 将 json 对象反序列化为动态对象](https://stackoverflow.com/questions/4535840/deserialize-json-object-into-dynamic-object-using-json-net)
*   [将 JSON 反序列化为 C# 动态对象？](https://stackoverflow.com/questions/3142495/deserialize-json-into-c-sharp-dynamic-object)

# wpf - WPF：根据配置设置在两个不同的控件之间切换？

> ID：10559188
> 
> 赞同：0
> 
> 时间：2012-05-11T21:58:31.863
> 
> 标签：wpf, xaml

我有一个表单，由一个包装了一个 ORM 对象的 ViewModel 支持，该对象映射一个包含“领土”字段的数据库记录。

此字段的业务逻辑由“ValidateTerritory”配置标志切换。如果打开该标志，则该字段必须包含 Territories 表中的值之一。在这种情况下，我的视图应该包含一个填充了这些区域的 ComboBox。这个我可以处理，很简单：在从数据库填充的 ViewModel 上包含一个 ValidTerritories 属性，并将 ComboBox 的 ItemsSource 绑定到该属性。当然，将 ComboBox 的 SelectedValue 绑定到 ORM 中的区域字段。

问题是如果“ValidateTerritory”标志被关闭，这个字段就没有验证规则。它是一个纯文本字段，包含任何不受约束的值。在这种情况下，我的视图应该包含一个 TextBox，它的 Text 属性绑定到 ORM 中的字段。

问题是：处理此问题的最简洁方法是什么 - 根据该配置对象的值将表单上的控件从一种类型切换到另一种类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T11:46:36.343

我会考虑使用 a`ContentControl`绑定到“完整”数据（即`Content="{Binding }"`）并具有 a`DataTemplateSelector`返回包含 a 的数据模板`ComboBox`（具有正确的绑定）或包含 a 的数据模板`TextBox`（同样，绑定在 中`DataTemplate`）。

这样，您就没有验证问题，加载折叠的控件没有性能成本，并且将来可以更灵活地让其他控件担任该角色（也许，一个`AutoComplete`）。

# firebase - Firebase 和索引/搜索

> ID：10559191
> 
> 赞同：28
> 
> 时间：2012-05-11T21:59:09.890
> 
> 标签：firebase, firebase-realtime-database

我正在考虑将 Firebase 用于人们应该对数千个对象的集合使用全文搜索的应用程序。我喜欢提供仅客户端应用程序的想法（不必担心托管数据），但我不确定如何处理搜索。数据将是静态的，因此索引本身并不是什么大问题。

我假设我需要一些额外的服务来运行查询并返回 Firebase 对象句柄。我可以在某个固定位置启动这样的服务，但我不得不担心它的可用性和可扩展性。虽然我不希望这个应用程序有太多的流量，但它可能会在几千个并发用户时达到峰值。

建筑思想？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-11T23:16:03.477

从长远来看，Firebase 可能有更高级的查询，所以希望它能直接支持这种事情，而无需您做任何特别的事情。在那之前，您有几个选择：

1.  **编写服务器代码来处理搜索。** 正如您所提到的，最简单的方法是运行一些负责索引/搜索的服务器代码。Firebase 有一个 Node.JS 客户端，因此这是一种将服务连接到 Firebase 的简单方法。所有数据传输仍然可以通过 Firebase 进行，但您可以编写一个 Node.JS 服务，在 Firebase 中的某个指定位置监视客户端“搜索请求”，然后通过将结果集写回 Firebase 来“响应”，用于客户消费。
2.  **将索引存储在 Firebase 中，客户端会自动更新它。** 如果你想变得非常聪明，你可以尝试实现一个无服务器方案，其中客户端在编写数据时自动索引他们的数据......所以全文搜索的索引将存储在 Firebase 中，当客户端写入集合的新项目，它将负责适当地更新索引。为了进行搜索，客户端将直接使用索引来构建结果集。这实际上对于您想要索引存储在 Firebase 中的复杂对象的一个​​字段的简单情况很有意义，但对于全文搜索，这可能会非常麻烦。:-)
3.  **将索引存储在 Firebase 中，并使用服务器代码对其进行更新。**您可以尝试一种混合方法，将索引存储在 Firebase 中并由客户端直接用于进行搜索，但不是让客户端更新索引，而是在将新项目添加到集合时更新索引的服务器代码. 这样，当您的服务器关闭时，客户端仍然可以搜索数据。在您的服务器赶上索引之前，它们可能会得到陈旧的结果。

在 Firebase 有更高级的查询之前，如果您愿意运行一些服务器代码，#1 可能是您最好的选择。:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-07-28T23:40:18.467

Google 当前进行全文搜索的方法似乎是与[Algolia](https://www.algolia.com/)或[BigQuery](https://cloud.google.com/bigquery/)与[Cloud Functions for Firebase](https://firebase.google.com/docs/functions/)同步。

这是 Firebase 的[Algolia 全文搜索集成示例](https://github.com/firebase/functions-samples/blob/master/fulltext-search/README.md)，以及可以扩展以支持完整搜索的[BigQuery 集成示例。](https://github.com/firebase/functions-samples/blob/master/bigquery-import/README.md)

# javascript - 我的自定义主页上的自定义搜索栏

> ID：10559193
> 
> 赞同：0
> 
> 时间：2012-05-11T21:59:25.160
> 
> 标签：javascript, html, search

我需要在[http://www.winpatrol.com/db/pluscloud/](http://www.winpatrol.com/db/pluscloud/)上不断搜索 smss.exe 等文件。

有没有办法可以在我的自定义主页上创建一个自定义搜索栏来为我做到这一点？

因此，如果我在搜索栏中键入 smss，它将带我到[http://www.winpatrol.com/db/pluscloud/smss.html](http://www.winpatrol.com/db/pluscloud/smss.html)

我尝试使用带有 GET 请求的纯 HTML，但找不到方法。我在想也许有一种Javascript方式或其他东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:21:39.807

像这样的东西是纯 Javascript 并且可以工作，但是如果用户在该站点上输入一个不存在的页面，它只会导致他们找不到页面。

您可以使用服务器端 PHP 或类似的东西以更好的方式实现这一目标。

这是几乎没有错误检查的 JS 解决方案：

```
<form onsubmit="return redirect()">
    <input id="search_form_input" type="text" name="query" />
    <input type="submit" value="Search" />
</form>

<script type="text/javascript">
    function redirect()
    {
        var query = document.getElementById('search_form_input').value;
        if (query != '') {
            window.location = 'http://www.winpatrol.com/db/pluscloud/' + query + '.html';
        }
        return false;
    }
</script> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-11T22:26:50.867

[谷歌自定义搜索](http://www.google.com/cse/)是您可能正在寻找的。

# java - 在 GWT 客户端和 App Engine 服务器 (Java) 之间移动数据

> ID：10559195
> 
> 赞同：0
> 
> 时间：2012-05-11T21:59:26.710
> 
> 标签：java, json, google-app-engine, gwt, servlets

我正在使用 GWT 创建一个客户端，并使用 App Engine 创建一个服务器，其中我们组合了标准 servlet 和 Restlet 组件。

根据一些在线建议，我成功地在客户端使用 restyGWT（仅编码/解码）和在服务器端使用 Gson，将对象编码为 JSON，将数据移动到另一端，并解码对象。在两个方向。这仅适用于具有两个公共成员的简单类。到目前为止，我喜欢这种方法，因为它似乎*不需要*使用注释。

我们正在使用 POST 请求。

有人使用这种方法吗？有没有我应该考虑的陷阱？私人会员呢？列表/数组？

有没有人喜欢不同的方法，它是什么？

显然，我们希望客户端和服务器共享我们来回移动的对象的源代码。我们正在使用 JDO 注释，这些会与 restyGWT 或 Gson 冲突吗？

谢谢收听。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T13:10:22.013

我和我的团队在服务器端使用带有 jersey 和 jackson 的 restyGWT。我们很高兴，除了在每个实例开始时球衣需要很长时间（大约 30 秒）。这就是我开始关注 [http://cxf.apache.org/](http://cxf.apache.org/)的问题。

无论如何，在没有任何 REST 框架的情况下工作可能会影响代码的可维护性：我们有大约 10 种不同类型的资源（每种资源都有 4 种不同的 HTTP 方法），并且已经很难维护所有内容。

一个建议是：注意预热实例需要多长时间。GAE 和其他 PaaS 架构可以很好地横向扩展，因此创建新实例所花费的时间很重要（很多）。只是想有个主意：我让 JAXB、Jackson 和 JDO 一起启动，我已经过了 60 秒的最后期限。

这与我不使用持久性框架的建议有关。我正在使用 JDO，我意识到我一直在理解它与 NoSql DB 的关系可以更好地用于创建我自己的层（将我的类简单地序列化为由低级 API 持久化的“实体”类）。无需初始化 JDO 所需的所有内容

# ios - OpenGL ES 2.0 GLKit 画线

> ID：10559199
> 
> 赞同：1
> 
> 时间：2012-05-11T21:59:39.473
> 
> 标签：ios, opengl-es-2.0, glkit, vertex-buffer

我正在尝试用 OpenGL ES 2.0 GLKit 画一条线。当我运行以下代码并使用 OpenGL ES Analyzer 时，我收到以下错误：

“使用不存在的程序”glDrawArrays(GL_LINE_STRIP,0,4)

“GL 错误：无效操作” GL_INVALID_OPERATION <- glVertexPointer(2,GL_FLOAT,0,NULL) GL_INVALID_OPERATION <- glEnableClientState(GL_VERTEX_ARRAY)

这是我的代码：

```
#import "GLDrawingView.h"

const float data[] = {0.0f, 1.0f, 0.0f, 0.0f, 1.0f, -0.0f, 0.0f, 1.0f};

@interface GLDrawingView () {
    GLuint lineVBO;
}

@end

@implementation GLDrawingView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        [EAGLContext setCurrentContext:self.context];           
        glGenBuffers(1, &lineVBO);
        glBindBuffer(GL_ARRAY_BUFFER, lineVBO);
        glBufferData(GL_ARRAY_BUFFER, sizeof(data), data, GL_STATIC_DRAW);
    }
    return self;
}

- (void)drawRect:(CGRect)rect
{
    glVertexPointer(2, GL_FLOAT, 0, NULL);   
    glEnableClientState(GL_VERTEX_ARRAY);
    glDrawArrays(GL_LINE_STRIP, 0, sizeof(data) / sizeof(float) / 2);
}

@end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T22:17:49.597

当您在 OpenGL ES 2.0 中绘制某些东西时，您必须使用着色器程序 ( `glUseProgram`) 进行渲染。在 GLES2 中，您无法在没有着色器的情况下进行渲染。

# powershell - PowerShell 使用 Invoke-Command 创建 IE 的远程实例

> ID：10559200
> 
> 赞同：3
> 
> 时间：2012-05-11T22:00:14.780
> 
> 标签：powershell, powershell-2.0, powershell-remoting

我正在尝试通过 PowerShell 远程生成 IE 实例。

```
Invoke-Command -computername foo -scriptblock {
    $ie = New-Object -ComObject InternetExplorer.Application
    $ie.Visible = $true
    $ie.Navigate("http://duckduckgo.com")
} 
```

它生成实例，我可以在进程中看到它，但它对用户不可见。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T05:11:22.980

我认为你没有做错任何事。

据我了解，通过 PSRemoting 与远程用户的桌面进行交互是不可能的。

如果 Powershell 不能做到这一点，微软（以前是 Sysinternal 的）工具 PSEXEC 可以做到这一点（看看 -i 参数）。

# javascript - C# 和 Javascript 之间的 SHA-256 哈希值不同

> ID：10559203
> 
> 赞同：7
> 
> 时间：2012-05-11T22:00:42.283
> 
> 标签：javascript, sql-server, hash, sha256

我目前正在开展一个项目，该项目将涉及基于数据库行的信用卡刷卡录取。与遗嘱呼叫系统一样，CC 编号的 SHA-256 哈希必须与 DB 行中的哈希匹配，才能被视为“正确的取货”。

但是，由于票房系统是基于浏览器的，所以取货时的CC号码必须在客户端使用Javascript进行哈希处理，然后与之前下载的会调用数据进行比较。

但是，当尝试对数字进行哈希处理时，哈希值总是与创建 DB 行时的哈希值不同（使用 VB.NET 和 SQL Server 2008 R2）。例如，如果数据库中的 CC 编号恰好是**4444333322221111**，那么来自 .NET 的结果哈希将变为**xU6sVelMEme0N8aEcCKlNl5cG25kl8Mo5pzTowExenM=**。

但是，当我可以找到任何 SHA-256 哈希库用于 Javascript 时，生成的哈希将始终为**NbjuSagE7lHVQzKSZG096bHtQoMLscYAXyuCXX0Wtw0=**。

我假设这是某种 Unicode/UTF-8 问题，但无论我尝试什么，我都无法得到相同的哈希值，它开始让我发疯。任何人都可以提供任何建议吗？

这里有一些可以提供一些见解的东西。请访问[http://www.insidepro.com/hashes.php?lang=eng](http://www.insidepro.com/hashes.php?lang=eng)并在密码框中插入不带引号的“4444333322221111”。然后，向下滚动到 SHA-256 部分。

您可以看到有四个结果，其中两个是我发布的哈希码（从上数第二个是 Javascript 哈希，底部一个是 SQL 哈希）。根据该页面，底部哈希结果是使用 base 64 字符串生成的，并将密码转换为 unicode 格式。

我已经对此进行了调查，并尝试了许多不同的函数将密码编码为 un​​icode 格式，但无论我尝试进行什么小调整或进行其他功能，我都无法让它与我需要的哈希码相匹配。

我目前正在研究在服务器端调用 SHA-256 函数时使用的参数。

**更新：**

因此，为了确保我没有发疯，我在调试时在即时窗口中运行了用于 CC 编号的 Hash 方法。同样，结果与以前相同。你可以在这里看到截图：http: [//i.imgur.com/raEyX.png](http://i.imgur.com/raEyX.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:08:30.477

根据[在线 SHA-256 哈希计算器](http://www.xorbin.com/tools/sha256-hash-calculator)和[base-64 到十六进制解码器](http://tomeko.net/online_tools/base64.php)，是 .NET 实现没有正确计算哈希。您可能需要仔细检查传递给散列函数的参数。

当您处理两个不受信任的实现时，最好找到另一个独立的实现，并选择与第三个匹配的那个是正确的。要么，要么[找到一些测试向量](http://www.nsrl.nist.gov/testdata/)，并单独验证实现。

* * *

编辑：

一个快速实验表明，您从 .NET 获得的 SHA-256 哈希与十六进制字符串`3400340034003400330033003300330032003200320032003100310031003100`（小端 16 位字符）匹配。确保传入 ASCII。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:44:24.973

[当 Adam Liss](https://stackoverflow.com/users/29157/adam-liss)提到 .NET/SQL Server 中字符串之间的字节数组与 Javascript 中的字符串不同时，他说得对。.NET 中字符串**4444333322221111**的数组看起来像 [52 0 52 0 52 0 52 0 51 0 51 0... 等]，而 Javascript 中的同样的东西看起来像 [52 52 52 52 51 51 51 51 ...]。因此，使用不同的字节数组，会生成不同的哈希值。

[我可以通过从这里](https://github.com/h2non/jsHashes)修改 base 64 SHA-256 散列算法来为我的应用程序解决这个问题，其中每个字符一次从字符串中提取一个以生成散列。

我没有这样做，而是首先将字符串转换为类似 unicode 的字节数组（如上面的 .NET 示例，5​​2 0 52 0 等），将该数组提供给散列算法而不是字符串，然后一些非常小的调整，以便它抓取每个数组成员以生成哈希。瞧，它工作了，现在我有一种非常方便的方法来散列 CC 编号，其方式与 .NET 框架相同，可以快速轻松地查找订单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T22:02:53.037

你确定你的 JavaScript SHA256 函数吗？

* * *

你第一次生成的哈希？

```
SHA-256("4444333322221111"); // 35b8ee49a804ee51d5433292646d3de9b1ed42830bb1c6005f2b825d7d16b70d 
```

* * *

```
hex: 35b8ee49a804ee51d5433292646d3de9b1ed42830bb1c6005f2b825d7d16b70d
HEX: 35B8EE49A804EE51D5433292646D3DE9B1ED42830BB1C6005F2B825D7D16B70D
h:e:x: 35:b8:ee:49:a8:04:ee:51:d5:43:32:92:64:6d:3d:e9:b1:ed:42:83:0b:b1:c6:00:5f:2b:82:5d:7d:16:b7:0d
base64: NbjuSagE7lHVQzKSZG096bHtQoMLscYAXyuCXX0Wtw0= 
```

# c++ - 在未加载的 Dll 中发生崩溃

> ID：10559211
> 
> 赞同：1
> 
> 时间：2012-05-11T22:01:29.020
> 
> 标签：c++, windows, dll

我正在开发 Win7 和 VS 2010。

我的应用程序调用 LoadLibrary 来加载 A.dll。LoadLibrary 返回 NULL，错误代码是 126，这是我的预期。

然后，如果我不理会我的应用程序，它会在几分钟后崩溃。

Windows 事件查看器中有一条错误消息：

异常代码：0xc0000005

错误的应用程序路径：MyApplication.exe

错误模块路径：A.dll

发生了什么？！我确定我的应用程序只调用一次 LoadLibrary。卸载的 Dll 中如何发生错误？

谢谢~

**结果：**

再次感谢所有帮助。

最后，我找到了崩溃的原因。

A.dll 中有一个包含消息循环的线程。在卸载 A.dll 之前，我忘了让这个线程退出。应用程序没有立即崩溃，因为它在 GetMessage() 中被阻塞。当它从 GetMessage() 返回时，它崩溃了。

A.dll：

```
void ThreadFunc (void *) {
    while (true) Sleep(10000); // message loop

    return ;
}

extern "C" {
__declspec(dllexport) int init() {
    _beginthread(ThreadFunc, 0, NULL);
    return 0;
}
} 
```

应用 ：

```
typedef int (*FUNC)();

HMODULE hMod = LoadLibrary(TEXT("A.dll"));
FUNC init = (FUNC) GetProcAddress(hMod, "init");

init();

Sleep(1000);  // wait for thread to sleep

BOOL freeRet = FreeLibrary(hMod); 
```

# actionscript-3 - Flex：为什么 TileList 图像在拖动时会消失？

> ID：10559213
> 
> 赞同：0
> 
> 时间：2012-05-11T22:01:35.823
> 
> 标签：actionscript-3, apache-flex, drag-and-drop, tilelist

我正在开发一个 Flex Air（桌面）应用程序，它将图像从本地文件系统加载到 TileList 中。然后，用户将能够将这些图像从列表中拖出（复制）到另一个控件上。

我终于让图像正确显示（并且在滚动 TileList 后不会消失），但它们似乎在拖动操作开始时从 TileList 中消失。

我来自 .NET 背景，正在学习 AS3/Flex，所以如果你看到我在这里使用了任何反模式，请随时指出它们！

示例代码如下（我已尝试使其尽可能小）。

**测试.mxml：**

```
<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
                       xmlns:s="library://ns.adobe.com/flex/spark" 
                       xmlns:mx="library://ns.adobe.com/flex/mx">
    <fx:Script>
        <![CDATA[

            import mx.collections.ArrayCollection;
            import mx.events.FlexEvent;

            [Bindable]
            protected var _pics:ArrayCollection = new ArrayCollection();

            protected function picsList_creationCompleteHandler(event:FlexEvent):void
            {
                const imageFolderPath:String = "c:\\users\\bbrooks\\Pictures";

                var imageDir:File = new File(imageFolderPath);
                var imageFiles:Array = imageDir.getDirectoryListing();
                for each(var imageFile:File in imageFiles)
                {
                    _pics.addItem(new PictureObject(imageFile.nativePath));
                }

                // give images a chance to load
                var timer:Timer = new Timer(1000);
                timer.addEventListener(TimerEvent.TIMER, onTimerExpired);
                timer.start();
            }

            protected function onTimerExpired(event:TimerEvent):void
            {
                picsList.dataProvider = _pics;
            }

        ]]>
    </fx:Script>

    <mx:TileList id="picsList" x="0" y="0" width="100%" height="100%" dragEnabled="true" dragMoveEnabled="false"
                 creationComplete="picsList_creationCompleteHandler(event)" >
        <mx:itemRenderer>
            <fx:Component>
                <mx:Image width="75" height="75" source="{data.image}" />
            </fx:Component>
        </mx:itemRenderer>
    </mx:TileList>

</s:WindowedApplication> 
```

**图片对象.as：**

```
package
{
    import flash.display.Loader;
    import flash.display.LoaderInfo;
    import flash.events.Event;
    import flash.net.URLRequest;

    import mx.controls.Image;

    [Bindable]
    [RemoteClass]
    public class PictureObject extends Object
    {
        protected var _image:Image = null;
        public function get image():Image { return _image; }
        public function set image(newValue:Image):void { _image = newValue; }

        public function PictureObject(path:String)
        {
            var imageLoader:Loader = new Loader();
            imageLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onImageLoaded);
            imageLoader.load(new URLRequest(path));
        }

        protected function onImageLoaded(e:Event):void
        {
            var imageLoader:Loader = LoaderInfo(e.target).loader;
            var bmp:Bitmap = Bitmap(imageLoader.content);

            _image = new Image();           
            _image.smoothBitmapContent = true;
            _image.source = new Bitmap(bmp.bitmapData);
            _image.width = imageLoader.width;
            _image.height = imageLoader.height;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:35:53.073

我将主要回答您的次要问题（猜测它会一举解决主要问题）：随着反模式的发展，这不是一个坏例子；）

1.  您正在手动加载图像，而`Image`该类具有内置的加载功能；只需为其`source`属性提供一个 URL，它就会自动加载它。
2.  您正在将一个`Image`实例设置为另一个`Image`实例的源；该`source`属性需要 URL 或 ByteArrays；我很惊讶它没有抛出错误；Image 类可能足够聪明，可以提取`source`另一个 Image 实例的。
3.  `Timer`是多余的。如前所述， an`Image`会自动处理加载其内容。
4.  `s:Image`标记没有包装在 an 中，`ItemRenderer`因此不应访问`data`属性：此代码甚至不应该编译。
5.  如果你不打算绑定它，那么拥有一个`Bindable`属性是没有意义的。`_pics`
6.  您使用 mx TileList。为什么不使用更“现代”的 Spark 版本？（但这并不意味着 mx 类不能在 Spark 应用程序中工作）。

所以你有很多删除工作要做。您可以完全废弃 PictureObject 类；删除定时器代码；并将 URL 字符串添加到`_pics`集合中。另外，您还可以将 mx TileList 替换为带有 TileLayout 的 Spark 列表；像这样的东西：

```
<s:List id="picsList">
    <s:layout>
        <s:TileLayout />
    </s:layout>
    <s:itemRenderer>
        <fx:Component>
            <s:ItemRenderer>
                <s:Image source="{data}" />
            </s:ItemRenderer>
        </fx:Component>
    </s:itemRenderer>
</s:List> 
```

ActionScript 部分可以简化为：

```
const imageFolderPath:String = "c:\\users\\bbrooks\\Pictures";

var imageDir:File = new File(imageFolderPath);
var imageFiles:Array = imageDir.getDirectoryListing();
picsList.dataProvider = new ArrayCollection(imageFiles); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:04:56.760

谢谢RIAstar。您的回答使我走上了解决问题的道路。新的示例代码如下所示。

最初的问题似乎与 mx:Image 控件有关。不知道为什么，但使用 s:Image 控件似乎有效。

当然，这可以通过简单地将数据源设置为文件路径列表来完成，而无需 PictureObject 类，但我稍后会使用图像数据，我想通过将图像数据提供给自定义渲染器来使其工作动态的。

**测试.mxml：**

```
<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
                       xmlns:s="library://ns.adobe.com/flex/spark" 
                       xmlns:mx="library://ns.adobe.com/flex/mx">
    <fx:Script>
        <![CDATA[
            import mx.collections.ArrayCollection;
            import mx.events.FlexEvent;

            import spark.components.Image;

            protected var _pics:ArrayCollection = new ArrayCollection();

            protected function picsList_creationCompleteHandler(event:FlexEvent):void
            {
                const imageFolderPath:String = "c:\\users\\bbbrooks\\Pictures";

                var imageDir:File = new File(imageFolderPath);
                var imageFiles:Array = imageDir.getDirectoryListing();
                for each(var imageFile:File in imageFiles)
                {
                    if (imageFile.extension == "jpg")
                    {
                        _pics.addItem(new PictureObject(imageFile.nativePath));
                    }
                }

                // give images a chance to load
                var timer:Timer = new Timer(1000);
                timer.addEventListener(TimerEvent.TIMER, onTimerExpired);
                timer.start();
            }

            protected function onTimerExpired(event:TimerEvent):void
            {
                picsList.dataProvider = _pics;
            }

        ]]>
    </fx:Script>

    <s:List id="picsList" x="0" y="0" width="100%" height="100%" 
            creationComplete="picsList_creationCompleteHandler(event)"
            dragEnabled="true" dragMoveEnabled="false">
        <s:layout>
            <s:TileLayout />
        </s:layout>
        <s:itemRenderer>
            <fx:Component>
                <s:ItemRenderer>
                    <s:Image id="imageDisplay" 
                             width="75" height="75" source="{data.bmp}" /> 
                </s:ItemRenderer>
            </fx:Component>
        </s:itemRenderer>
    </s:List>

</s:WindowedApplication> 
```

**图片对象.as**

```
package
{
    import flash.display.Bitmap;
    import flash.display.Loader;
    import flash.display.LoaderInfo;
    import flash.events.Event;
    import flash.net.URLRequest;

    import mx.controls.Image;

    [RemoteClass]
    [Bindable]
    public class PictureObject extends Object
    {
        protected var _bmp:Bitmap = null;
        public function get bmp():Bitmap { return _bmp; }
        public function set bmp(newValue:Bitmap):void { _bmp = newValue; }

        public function PictureObject(path:String)
        {
            var imageLoader:Loader = new Loader();
            imageLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onImageLoaded);
            imageLoader.load(new URLRequest(path));
        }

        protected function onImageLoaded(e:Event):void
        {
            var imageLoader:Loader = LoaderInfo(e.target).loader;

            // create our own copy of the bits in the Loader
            var bmp:Bitmap = Bitmap(imageLoader.content);
            _bmp = new Bitmap( Bitmap(imageLoader.content).bitmapData );
        }
    }
} 
```

# ios - RubyMotion 和指针

> ID：10559215
> 
> 赞同：6
> 
> 时间：2012-05-11T22:01:52.650
> 
> 标签：ios, ruby, rubymotion

我是一个 Objective-C 菜鸟，搜索了高低还没有找到答案：

在我的 RubyMotion 项目中，我有一个名为 StatusGuage 的 UIView 子类，其中包含一个名为 drawLinearGradient 的方法，如下所示：

```
def drawLinearGradient(context, rect, startColor, endColor)
  colorspace = CGColorSpaceCreateDeviceRGB()
  locations = [0.0, 1.0]
  # colors = NSArray.arrayWithObjects(startColor, endColor, nil)
  # ptrColors = Pointer.new(:object, colors)
  colors = [startColor, endColor, nil]
  # CGGradientRef gradient = CGGradientCreateWithColors(colorSpace, (CFArrayRef) colors, locations);
  CGGradientCreateWithColors(colorspace, colors, locations)
end 
```

我想知道如何调用 CGGradientCreateWithColors。它显然需要一个 (CFArrayRef) 指针，但我无法弄清楚如何将它传递进去。我尝试过的迭代之一被注释掉了。

这是错误消息：

```
2012-05-11 16:57:36.331 HughesNetMeter[34906:17903] 
*** Terminating app due to uncaught exception 'TypeError', 
  reason: 'status_guage.rb:43:in `drawLinearGradient:': expected 
  instance of Pointer, got `[0.0, 1.0]' (Array) (TypeError)
    from status_guage.rb:13:in `drawRect:' 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T23:45:29.347

有几件事。错误不是在谈论颜色，而是指`const CGFloat locations[]`论点。

这应该是一个可以像这样实现的指针（[指针类的参考](http://ofps.oreilly.com/titles/9781449380373/_one_step_deeper.html#_pointers)）

```
locations = Pointer.new(:float, 2)
locations[1] = 1.0 
```

* * *

接下来，您的阵列不需要`nil`终止。在 Ruby 中，这将创建一个包含 3 个对象的数组，这不是您想要的，因为它很可能会导致`CGGradientCreateWithColors()`函数混乱

* * *

这看起来像[http://www.raywenderlich.com/](http://www.raywenderlich.com/2033/core-graphics-101-lines-rectangles-and-gradients)中的示例，所以这是其余的

```
def drawLinearGradient(context, rect, startColor, endColor)
  colorspace = CGColorSpaceCreateDeviceRGB()
  locations = Pointer.new(:float, 2)
  locations[1] = 1.0

  colors = [startColor, endColor]
  gradient = CGGradientCreateWithColors(colorspace, colors, locations)

  startPoint = CGPointMake(CGRectGetMidX(rect), CGRectGetMinY(rect))
  endPoint   = CGPointMake(CGRectGetMidX(rect), CGRectGetMaxY(rect))

  CGContextSaveGState(context)
  CGContextAddRect(context, rect)
  CGContextClip(context)
  CGContextDrawLinearGradient(context, gradient, startPoint, endPoint, 0)
  CGContextRestoreGState(context)
end 
```

* * *

### 最后的旁注

`locations`在这种情况下甚至不需要该参数，因为`CGGradientCreateWithColors()`会自动将第一种和最后一种颜色的值设置为 0.0 和 1.0。检查[CGGradient 参考](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CGGradient/Reference/reference.html)

> **位置**
> 组件中提供的每种颜色的位置。每个位置必须是 0 到 1 范围内的 CGFloat 值，包括 0 到 1。如果 0 和 1 不在位置数组中，Quartz 使用提供的最接近这些位置的 0 和 1 的颜色。
> 如果位置为 NULL，则颜色中的第一种颜色分配给位置 0，颜色中的最后一种颜色分配给位置 1，中间颜色分配给它们之间等间隔的位置。

# objective-c - 确定 2 个坐标之间的中点

> ID：10559219
> 
> 赞同：24
> 
> 时间：2012-05-11T22:02:47.760
> 
> 标签：objective-c, mapkit, core-location

我正在尝试确定`MKMapView`. 我正在按照[此处](https://stackoverflow.com/q/4656802)（和[此处](https://stackoverflow.com/questions/4164830/geographic-midpoint-between-two-coordinates)）概述的方法并在 Objective-C 中重写它，但地图的中心是巴芬岛东北部的某个地方，这与两点不相近。

我的方法基于上面链接的java方法：

```
+(CLLocationCoordinate2D)findCenterPoint:(CLLocationCoordinate2D)_lo1 :(CLLocationCoordinate2D)_loc2 {
    CLLocationCoordinate2D center;

    double lon1 = _lo1.longitude * M_PI / 180;
    double lon2 = _loc2.longitude * M_PI / 100;

    double lat1 = _lo1.latitude * M_PI / 180;
    double lat2 = _loc2.latitude * M_PI / 100;

    double dLon = lon2 - lon1;

    double x = cos(lat2) * cos(dLon);
    double y = cos(lat2) * sin(dLon);

    double lat3 = atan2( sin(lat1) + sin(lat2), sqrt((cos(lat1) + x) * (cos(lat1) + x) + y * y) );
    double lon3 = lon1 + atan2(y, cos(lat1) + x);

    center.latitude  = lat3 * 180 / M_PI;
    center.longitude = lon3 * 180 / M_PI;

    return center;
} 
```

2个参数有以下数据：

```
_loc1:
    latitude = 45.4959839
    longitude = -73.67826455

_loc2:
    latitude = 45.482889
    longitude = -73.57522299 
```

以上内容正确放置在地图上（蒙特利尔及其周边地区）。我试图将地图居中在 2 之间的中点，但我的方法返回以下内容：

```
latitude = 65.29055
longitude = -82.55425 
```

在北极的某个地方，应该在南边大约 500 英里处。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2015-05-21T03:25:02.973

如果有人需要 Swift 中的代码，我在 Swift 中编写了库函数来计算多个坐标之间的中点：

```
//        /** Degrees to Radian **/
class func degreeToRadian(angle:CLLocationDegrees) -> CGFloat {
    return (  (CGFloat(angle)) / 180.0 * CGFloat(M_PI)  )
}

//        /** Radians to Degrees **/
class func radianToDegree(radian:CGFloat) -> CLLocationDegrees {
    return CLLocationDegrees(  radian * CGFloat(180.0 / M_PI)  )
}

class func middlePointOfListMarkers(listCoords: [CLLocationCoordinate2D]) -> CLLocationCoordinate2D {

    var x = 0.0 as CGFloat
    var y = 0.0 as CGFloat
    var z = 0.0 as CGFloat

    for coordinate in listCoords{
        var lat:CGFloat = degreeToRadian(coordinate.latitude)
        var lon:CGFloat = degreeToRadian(coordinate.longitude)
        x = x + cos(lat) * cos(lon)
        y = y + cos(lat) * sin(lon)
        z = z + sin(lat)
    }

    x = x/CGFloat(listCoords.count)
    y = y/CGFloat(listCoords.count)
    z = z/CGFloat(listCoords.count)

    var resultLon: CGFloat = atan2(y, x)
    var resultHyp: CGFloat = sqrt(x*x+y*y)
    var resultLat:CGFloat = atan2(z, resultHyp)

    var newLat = radianToDegree(resultLat)
    var newLon = radianToDegree(resultLon)
    var result:CLLocationCoordinate2D = CLLocationCoordinate2D(latitude: newLat, longitude: newLon)

    return result

} 
```

详细答案可以在[这里找到](http://www.geomidpoint.com/calculation.html)

**为 Swift 5 更新**

```
func geographicMidpoint(betweenCoordinates coordinates: [CLLocationCoordinate2D]) -> CLLocationCoordinate2D {

    guard coordinates.count > 1 else {
        return coordinates.first ?? // return the only coordinate
            CLLocationCoordinate2D(latitude: 0, longitude: 0) // return null island if no coordinates were given
    }

    var x = Double(0)
    var y = Double(0)
    var z = Double(0)

    for coordinate in coordinates {
        let lat = coordinate.latitude.toRadians()
        let lon = coordinate.longitude.toRadians()
        x += cos(lat) * cos(lon)
        y += cos(lat) * sin(lon)
        z += sin(lat)
    }

    x /= Double(coordinates.count)
    y /= Double(coordinates.count)
    z /= Double(coordinates.count)

    let lon = atan2(y, x)
    let hyp = sqrt(x * x + y * y)
    let lat = atan2(z, hyp)

    return CLLocationCoordinate2D(latitude: lat.toDegrees(), longitude: lon.toDegrees())
} 
```

}

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-11T22:19:54.383

只是一种预感，但我注意到你的`lon2`and`lat2`变量是用`M_PI/100`and not计算的`M_PI/180`。

```
double lon1 = _lo1.longitude * M_PI / 180;
double lon2 = _loc2.longitude * M_PI / 100;

double lat1 = _lo1.latitude * M_PI / 180;
double lat2 = _loc2.latitude * M_PI / 100; 
```

将它们更改为 180 可能会对您有所帮助。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-10-12T11:55:10.763

对于 swift 用户，按照@dinjas 的建议更正了变体

```
import Foundation
import MapKit
extension CLLocationCoordinate2D {
    // MARK: CLLocationCoordinate2D+MidPoint
    func middleLocationWith(location:CLLocationCoordinate2D) -> CLLocationCoordinate2D {

        let lon1 = longitude * M_PI / 180
        let lon2 = location.longitude * M_PI / 180
        let lat1 = latitude * M_PI / 180
        let lat2 = location.latitude * M_PI / 180
        let dLon = lon2 - lon1
        let x = cos(lat2) * cos(dLon)
        let y = cos(lat2) * sin(dLon)

        let lat3 = atan2( sin(lat1) + sin(lat2), sqrt((cos(lat1) + x) * (cos(lat1) + x) + y * y) )
        let lon3 = lon1 + atan2(y, cos(lat1) + x)

        let center:CLLocationCoordinate2D = CLLocationCoordinate2DMake(lat3 * 180 / M_PI, lon3 * 180 / M_PI)
        return center
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-04-09T11:06:44.377

重要的是要说 OP 用于计算地理中点的公式是基于[这个](http://www.geomidpoint.com/calculation.html)解释 cos/sin/sqrt 计算的公式。

这个公式将为您提供任何**长距离**的地理中点，包括四个季度和本初子午线。

但是，如果您的计算是针对1 公里左右**的短程**，使用简单的平均值将产生相同的中点结果。IE：

```
let firstPoint = CLLocation(....)
let secondPoint = CLLocation(....)

let midPointLat = (firstPoint.coordinate.latitude + secondPoint.coordinate.latitude) / 2
let midPointLong = (firstPoint.coordinate.longitude + secondPoint.coordinate.longitude) / 2 
```

您实际上可以将它用于 10 公里，但预计会出现偏差 - 如果您只需要使用快速解决方案对短程中点进行估计，那就足够了。

* * *

## 回答 #5

> 赞同：-10
> 
> 时间：2012-05-11T22:24:27.983

我觉得你想多了。做就是了：

```
float lon3 = ((lon1 + lon2) / 2)
float lat3 = ((lat1 + lat2) / 2) 
```

lat3 和 lon3 将是中心点。

# sql-server - 为系统表创建外键

> ID：10559227
> 
> 赞同：7
> 
> 时间：2012-05-11T22:03:47.177
> 
> 标签：sql-server, foreign-keys, sysobjects

我想用 to 列创建表：

```
IdRole
IdProcedure 
```

这个想法是`IdProcedure`对`sys.objects`.

当我创建此查询时：

```
SELECT * 
FROM sys.objects 
WHERE type='p' 
```

它工作正常，但这个：

```
ALTER TABLE dbo.CORE_ProcedureXRole
ADD CONSTRAINT FK_SysProcedure
FOREIGN KEY (IdProcedure)
REFERENCES sys.objects(object_id) 
```

告诉我：

> 外键“FK_SysProcedure”引用无效表“sys.objects”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-04T19:35:08.797

`sys.objects`不是表。它是以专有 SQL Server 格式存储的数据支持的系统视图。如果要确保存储的名称正确，请添加一个`TRIGGER`for update 和 insert 来处理检查。

# javascript - 从函数返回数组时出现 Javascript 命名空间问题

> ID：10559228
> 
> 赞同：0
> 
> 时间：2012-05-11T22:03:48.630
> 
> 标签：javascript, jquery, ajax

我有一个对 sharepoint 的 AJAX 调用（如下所示）。

```
function GetProductIDSforActiveQuote() {
var arr = new Array();
$().SPServices({
    operation: "UpdateListItems",
    listName: "Quotes",
    ID:quoteID,
    completefunc: function (xData, Status) {
      $(xData.responseXML).SPFilterNode("z:row").each(function() {
        arr = $(this).attr("ows_Products").split(',');
      });
    }
  });
return arr;
} 
```

我试图返回一个数组，但最后得到一个空数组。我可以通过将控制台日志放在 completefunc 块中来验证是否正确返回了值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:07:29.807

AJAX 调用是异步的。这意味着当您点击 line`return arr`时，`completeFunc`还不一定会调用 。

你能修改代码，让它接受一个提供数组的回调函数吗？像这样：

```
function GetProductIDSforActiveQuote(callback) {
    // other details omitted
    completefunc: function (xData, Status) {          
        arr = // your code
        callback(arr); // <- here's the difference.
      };        
} 
```

在回调函数中，您可以根据需要处理数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T22:07:26.103

看起来`SPServices`是异步的，所以它会在响应到达之前返回。您必须从内部使用数组`completefunc`。

# java - 如何使用 Javassist 定义具有参数化列表的字段

> ID：10559231
> 
> 赞同：2
> 
> 时间：2012-05-11T22:03:53.107
> 
> 标签：java, javassist

如何使用 Javassist 定义参数化列表字段？我尝试了以下代码，它不会抱怨未参数化的 List 类，但在给定参数时会导致 CannotCompileException。

```
 ClassPool pool = ClassPool.getDefault();
    pool.importPackage("java.util.List");
    CtClass cc = pool.makeClass("Test");
    CtField f = CtField.make("public List<String> p;", cc);
    // throws javassist.CannotCompileException: [source error] syntax error near "lic List<String> p;" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:12:31.560

我猜想编译器 javassist 在内部使用的语言合规级别设置为 Java 1.4，这可以解释为什么它不理解泛型（它们是在 1.4 中引入的）

# java - 想要将旧的 Java soap.jar 样式代码翻译成现代的东西

> ID：10559233
> 
> 赞同：3
> 
> 时间：2012-05-11T22:04:10.243
> 
> 标签：java, axis, soap-client

我有一些 10 年前的 Java 代码用于调用旧版 SOAP 身份验证服务。WSDL 是 RPC:ENCODED 并且包含许多拼写错误。我希望轻松地将旧代码转换为 Axis 1.4 或其他东西，但遇到了障碍。我看到的所有东西都想使用 WSDL。有人可以帮助将其翻译成不需要错误 WSDL 的现代代码吗？

这是 SOAP 调用部分：

```
 SOAPMappingRegistry soapmappingregistry = new SOAPMappingRegistry();
    BeanSerializer beanserializer = new BeanSerializer();

    soapmappingregistry.mapTypes(Constants.NS_URI_SOAP_ENC, new QName(
            "urn:xml-soap-session-demo", "authenticationresult"),
            AuthenticationResult.class, beanserializer, beanserializer);
    Call call = new Call();
    call.setSOAPMappingRegistry(soapmappingregistry);
    call.setTargetObjectURI("urn:Security");
    call.setMethodName("authenticate");
    call.setEncodingStyleURI(Constants.NS_URI_SOAP_ENC);
    Vector<Object> vector = new Vector<Object>();
    vector.addElement(new Parameter("app", String.class, "PHS", null));
    vector.addElement(new Parameter("user", String.class, userName, null));
    vector.addElement(new Parameter("password", String.class, password, null));
    vector.addElement(new Parameter("encryption", Integer.class, new Integer(0), null));
    call.setParams(vector);
    Response response = null;
    URL endpointURL = new URL(endpoint);
    response = call.invoke(endpointURL, "");
    if (!response.generatedFault()) {
        Parameter parameter = response.getReturnValue();
        Object obj = parameter.getValue();
    ...
    } 
```

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:23:51.993

好吧，大多数soap 框架都非常依赖WSDL 标准。Axis、CXF、Spring WS 等。我想你可以试试 Spring WS。当您不知道或想要使用整个 WSDL（但知道应如何编码有效负载）时，它为我节省了几次。

但是，如果服务充满了 type-o:s，你为什么还要移植那个东西呢？旧客户端，旧服务 - 为什么不保持这种状态并在服务被替换为没有 type-o:s 的东西后升级代码？我不认为你最终会得到一些不那么丑陋的东西。

# lisp - 搜索包含列表或 cons 的列表

> ID：10559234
> 
> 赞同：-4
> 
> 时间：2012-05-11T22:04:46.470
> 
> 标签：lisp, scheme, chicken-scheme

假设我们得到了一个这样的列表（包含更多元素，但方法应该相同）：

```
(define l '((cons 'name 'john)
            (cons 'sur 'asurname)
            (cons 'name 'george)
            (cons 'sur 'georgesurname))) 
```

我们总是可以在现有列表中添加更多元素。这是最有效的方法，可以说编写一个获取用户名并返回姓氏的函数：

就像是 ：

```
(define display-surname
  (lamdba (name)
   (...))) 
```

在这种情况下，一般做法是什么？谁能指出一个如何做的例子/链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T01:35:18.810

`(name,surname)`将每条记录表示在一个列表中会更好，然后将您的数据作为对列表的列表进行处理：

```
(define lst '(((name . a) (sur . b)) ((name . c) (sur . d)))) 
```

使用上面的表示，找到一个名字（给定一个姓氏）就这么简单（假设记录中的每个字段总是在相同的位置找到）：

```
(define display-surname
  (lambda (lst name)
   (cond ((null? lst) #f)
         ((eq? (cdaar lst) name) (cdadar lst))
         (else (display-surname (cdr lst) name))))) 
```

您可以通过如下表示上述数据来进一步简化事情（再次假设记录中的每个字段始终位于相同的位置），并在 中进行相应的更改`display-surname`：

```
(define lst '((a . b) (c . d)))

(define display-surname
  (lambda (lst name)
   (cond ((null? lst) #f)
         ((eq? (caar lst) name) (cdar lst))
         (else (display-surname (cdr lst) name))))) 
```

无论哪种方式，这都有效：

```
(display-surname lst 'a)
> 'b

(display-surname lst 'x)
> #f 
```

# javascript - 单击一个按钮，将您带到 android 现有应用程序的主菜单

> ID：10559235
> 
> 赞同：0
> 
> 时间：2012-05-11T22:05:09.670
> 
> 标签：javascript, html, cordova

嗨，我正在写一个“退出”（退出按钮）我希望它带我到 android 现有应用程序的主菜单我正在使用 javascript、css 和 HTML 这是一个用 HTML5 编写的移动应用程序任何想法请

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:43:37.063

你无法做到这一点。安卓不允许。

# php - AddItem 功能似乎不起作用

> ID：10559237
> 
> 赞同：-1
> 
> 时间：2012-05-11T22:05:56.270
> 
> 标签：php, mysql

我把这件事搞定了，但我的 AddItem 函数似乎不起作用。我单击产品页面上的“添加项目”链接，它会将我带到购物车页面。但是购物车页面上没有任何内容。我希望有人能看到它并告诉我该怎么做才能纠正它。

AddItem 函数：

```
function AddItem($itemId, $qty) { 
            // Will check whether or not this item 
            // already exists in the cart table.  
            // If it does, the UpdateItem function 
            // will be called instead 

            // Check if this item already exists in the users cart table 
            $result = mysql_query("select count(*) from cs368_cart where cookieID = '" . GetCartID() . "' and itemId = $itemId");
            $row = mysql_fetch_row($result); 
            $numRows = $row[0]; 

            if($numRows == 0) { 
                    // This item doesn't exist in the users cart, 
                    // we will add it with an insert query 
                    mysql_query("insert into cs368_cart(cookieID, itemId, qty) values('" . GetCartID() . "', $itemId, $qty)");
            }       
            else {  
                    // This item already exists in the users cart, 
                    // we will update it instead 

                    UpdateItem($itemId, $qty);  
                    }       
            } 
```

我刚刚检查了数据库的 cs368_cart 表，它是空的。

```
mysql> select * from cs368_cart
-> ;
Empty set (0.00 sec) 
```

所以显然没有添加任何内容。我想知道我的查询是否正确？

我的桌子：

```
mysql> select * from cs368_products
-> ;
+--------+----------------+---------------------------------------------+-----------+
| itemId | itemName       | itemDesc                                    | itemPrice |
+--------+----------------+---------------------------------------------+-----------+
|      1 | French Vanilla | A medium blend with a hint vanilla          |      9.79 | 
|      2 | Hazelnut Cream | A light blend with a spicy note of Hazelnut |      9.69 | 
|      3 | Columbian      | A medium-dark blend straight up             |      9.89 | 
+--------+----------------+---------------------------------------------+-----------+
3 rows in set (0.00 sec) 
```

还有我的购物车桌；

```
mysql> show columns from cs368_cart;
+----------+-------------+------+-----+---------+----------------+
| Field    | Type        | Null | Key | Default | Extra          |
+----------+-------------+------+-----+---------+----------------+
| cartId   | int(11)     | NO   | PRI | NULL    | auto_increment | 
| cookieId | varchar(50) | NO   |     |         |                | 
| itemId   | int(11)     | YES  |     | NULL    |                | 
| qty      | int(11)     | YES  |     | NULL    |                | 
+----------+-------------+------+-----+---------+----------------+
4 rows in set (0.00 sec) 
```

这是我在一个单独的 php 文件中的 GetCartId，该文件由带有此 AddItem 函数的 php 文件正确调用。

```
function GetCartId(){
    if(isset($_COOKIE["cartId"])){
    return $_COOKIE["cartId"];
}
else {
    session_start();
    setcookie("cartId", session_id(), time()+((3600*24)*30));
    return session_id();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:26:54.733

您应该将您的插入查询更改为类似于下面的内容，这将告诉您您的插入数据有什么问题（也是优雅处理任何错误的好习惯）

```
<?php
    $queryResult = mysql_query("insert into cs368_cart(cookieID, itemId, qty) values('" . GetCartID() . "', $itemId, $qty)");
if (!$queryResult) {
    die('Invalid query: ' . mysql_error());
}

?> 
```

基于[http://php.net/manual/en/function.mysql-query.php中的示例](http://php.net/manual/en/function.mysql-query.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T23:27:06.483

当您的表具有整数时，您似乎正在尝试`cartId`作为字符串插入。`cartId`仔细查看 PHP 字符串中的 SQL。

# ruby-on-rails - 移动 Heroku 共享数据库

> ID：10559238
> 
> 赞同：2
> 
> 时间：2012-05-11T22:06:05.740
> 
> 标签：ruby-on-rails, ruby, database, postgresql, heroku

我最近使用 heroku 达到了 5mb 的数据库限制，在此之后成本急剧上升，所以我希望将数据库移到其他地方。

我对使用 VPS 和从头开始设置服务器非常陌生，但是，我最近为另一个应用程序这样做了。

我有几个与此相关的问题：

*   是否可以在 VPS 上创建数据库并将我的 rails 应用程序指向 heroku 以使用该数据库？
*   如果是这样，`database.yml`实际上会是什么样子。`localhost`将数据库存储在应用程序外部的示例是什么？

这些可能是基本问题，但我对服务器和编程的知识是自学的，所以我承认，我“应该”已经理解的事情可能存在巨大的漏洞。

**注意：**欢迎其他（更简单）移动我的数据库的建议。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T22:13:47.323

好的——对于初学者来说，是的，你可以在 Heroku 外部托管一个数据库，并将你的 database.yml 指向该服务器——这只是将主机名设置为指向正确的地址，并为其提供正确的凭据。

但是，您需要考虑几件事：

1) 延迟 - 除非您在 EC2 East 内托管，否则 Heroku 和您的数据库之间的延迟会导致您出现各种性能问题。

2) 建立一个数据库服务器不是一个简单的任务。您需要考虑它的安全性、性能如何、保持最新、保持备份，以及不得不日夜担心它的运行情况。使用 Heroku，您不需要这样做，因为它是完全托管的。

价格方面，你知道[Heroku 新的低成本 Postgres 计划](https://postgres.heroku.com/pricing)吗？15 美元/月将获得 20Gb（共享实例），50 美元/mp 将获得 TB（专用实例）。对我来说，这太便宜了，因为我更加珍惜自己的时间，而且我知道我需要投入多少小时来制作自己的服务器才能每月节省 10 美元。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T22:14:04.943

[使用Amazon RDS](https://devcenter.heroku.com/articles/amazon_rds)会更便宜，它由 Heroku 正式支持并从同一数据中心（亚马逊美国东部）提供服务。如果您确实想使用 VPS，请在美国东部使用 Amazon EC2 实例以获得最佳性能。 [本教程](http://www.askthepony.com/blog/2011/07/getting-django-on-heroku-prancing-8-times-faster/)详细展示了如何使用 Django 进行操作。即使您不决定使用 EC2，请参阅该教程以了解如何正确地将外部数据库信息添加到您的 Heroku 应用程序，以便 Heroku 不会尝试覆盖它。

尽管如此，Heroku 的共享数据库还是极具成本竞争力——远远超过大多数 VPS，而且安装和维护也少得多。

# javascript - JavaScript - 通过引用传递对象

> ID：10559242
> 
> 赞同：4
> 
> 时间：2012-05-11T22:06:51.537
> 
> 标签：javascript, arrays, prototypejs, push, prototype

> **可能重复：**
> [如何在数组中存储对变量的引用？](https://stackoverflow.com/questions/5865094/how-can-i-store-reference-to-a-variable-within-an-array)

考虑以下代码：

```
var a = 'cat';
var b = 'elephant';
var myArray = [a,b];

a = 'bear'; 
```

myArray[0] 仍将返回“猫”。有没有办法将引用存储在数组中而不是克隆中，以便 myArray[0] 将返回“熊”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T23:05:54.467

While I agree with everyone else saying that you should just use myArray[0] = whatever, if you really want to accomplish what you're trying to accomplish you could make sure that all you variables in the array are objects.

```
var a = {animal: 'cat'},
    b = {animal: 'elephant'};

var myArray = [a, b];

a.animal = 'bear'; 
```

myArray[0].animal is now 'bear'.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-11T22:08:17.217

不，JavaScript 不会以这种方式进行引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T22:18:14.507

即使您的数组包含对对象的引用，使变量引用完全不同的对象也不会更改数组的内容。

您的代码不会*修改*a引用的对象*变量。*它使*变量 a*完全引用不同的对象。

就像您的 JavaScript 代码一样，以下 Java 代码将无法工作，因为与 JavaScript 一样，Java 通过值传递对对象的引用：

```
 Integer intOne = new Integer(1);
  Integer intTwo = new Integer(2);

  Integer[] intArray = new Integer[2];
  intArray[0] = intOne;
  intArray[1] = intTwo;

  /* Make intTwo refer to a completely new object */

  intTwo = new Integer(45);

  System.out.println(intArray[1]);

  /* output = 2 */ 
```

在 Java 中，如果您更改变量引用的对象（而不是为变量分配新的引用），您将获得所需的行为。

例子：

```
 Thing thingOne = new Thing("funky");
  Thing thingTwo = new Thing("junky");

  Thing[] thingArray = new Thing [2];

  thingArray[0] = thingOne;
  thingArray[1] = thingTwo;

  /* Modify the object referenced by thingTwo */

  thingTwo.setName("Yippee");

  System.out.println(thingArray[1].getName());

  /* output = Yippee */

  class Thing
  {
      public Thing(String n) { name = n; }
      private String name;
      public String getName() { return name; }
      public void setName(String s) { name = s; }
  } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T22:08:35.037

不，这是不可能的。JavaScript 不支持此类引用。

只有对象被存储为引用。但我怀疑这是你想要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-11T22:12:08.530

你已经回答了你自己的问题。如果您希望 myArray[0] 等于 Bear，则设置：

```
myArray[0] = "bear"; 
```

# c# - 在 NUnit 测试中卸载外部非托管 dll

> ID：10559245
> 
> 赞同：3
> 
> 时间：2012-05-11T22:07:10.143
> 
> 标签：c#, c, nunit, unmanaged

我正在对非托管 dll 的 ac# 绑定进行测试。我如何编写测试，确保.dll 已卸载并再次加载以进行下一次测试，以便 dll 代码中的任何状态都不会传递到下一次测试？

dll 方法是使用 DllImport 属性导入的。

解决方案：

我的 dll 在静态构造函数中进行了一些初始化，所以我必须在再次卸载它后调用这个初始化代码。所以代码如下所示：

```
 private static int SDllHandle;
    private static bool SInitializationRequired;

    [SetUp]
    public static void Init()
    {
        SDllHandle = LoadLibrary("my.dll");
        if (SInitializationRequired)
        {
            //do some init code
            SInitializationRequired = false;
        }
    }

    [DllImport("kernel32")]
    static extern int LoadLibrary(string lpLibFileName);

    [DllImport("kernel32")]
    static extern bool FreeLibrary(int hModule);

    [TearDown]
    public static void End()
    {
        //do some release code

        while(FreeLibrary(SDllHandle)) 
        {
            SInitializationRequired = true;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:52:00.893

我没有尝试过，所以我不知道它是否有效，但我会尝试循环调用 FreeLibrary(GetModuleHandle(DLLNAME)) 直到它失败。

# visual-studio - Visual Studio 2010 输出窗口在构建时最大化

> ID：10559255
> 
> 赞同：1
> 
> 时间：2012-05-11T22:08:05.250
> 
> 标签：visual-studio, visual-studio-2010

有没有办法在构建时**自动**最大化输出窗口，然后在构建完成时自动恢复到以前的状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:23:02.913

您可以创建一个宏来构建解决方案，然后激活输出窗口。例如：

```
DTE.ExecuteCommand("Build.BuildSolution")
DTE.Windows.Item(Constants.vsWindowKindOutput).Activate() 
```

然后，您可以替换 Build 按钮或构建键盘快捷键来执行该宏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:34:09.510

我可以使用宏的组合来实现解决方案。

部分解决方案在这个 SO 问题中： [OnBuildBegin does not fire in Visual Studio Macro until I run it from Macro Explorer](https://stackoverflow.com/questions/2345467/onbuildbegin-does-not-fire-in-visual-studio-macro-until-i-run-it-from-macro-expl)

另一部分是使用 2 个导出的窗口设置并在构建事件上切换它们。

就像是：

```
Public Sub BuildEvents_OnBuildBegin() Handles BuildEvents.OnBuildBegin
      DTE.ExecuteCommand("Tools.ImportandExportSettings", "-import:C:\Development\VsSettings\build_inprocess.vssettings")
End Sub

Private Sub BuildEvents_OnBuildDone(ByVal Scope As EnvDTE.vsBuildScope, ByVal Action As EnvDTE.vsBuildAction) _
    Handles BuildEvents.OnBuildDone
    DTE.ExecuteCommand("Tools.ImportandExportSettings", "-import:C:\Development\VsSettings\Two_Screen.vssettings")
End Sub 
```

# css - 带有 IE7 问题的 CSS3

> ID：10559260
> 
> 赞同：0
> 
> 时间：2012-05-11T22:08:56.220
> 
> 标签：css, internet-explorer-7

我已经尝试了一些修复，但没有一个工作。我正在网站[http://MetroClick.com/上工作](http://MetroClick.com/)

在 IE7 中，导航变得疯狂。我尝试了[http://ie7-js.googlecode.com/svn/test/index.html](http://ie7-js.googlecode.com/svn/test/index.html)但它并没有真正奏效，因为它保持不变。任何帮助肯定会受到赞赏，因为我已经在这几个小时了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:13:56.130

为了使它看起来可以接受（这是对完全损坏的改进），`#menu a`替换`float: right`为`display: block`.

这对现代浏览器没有任何影响，但对 IE7 有很大帮助。

# javascript - 可以计算出使用 AJAX 加载了多少数据？

> ID：10559264
> 
> 赞同：4
> 
> 时间：2012-05-11T22:09:09.207
> 
> 标签：javascript, jquery, ajax

我一直忙于一些 AJAX 代码。我想计算已经加载了多少数据，我想用百分比显示它。

我所有的预加载信息都在“反馈”中。我可以计算它包含多少数据（以字节为单位），我还可以查看进度吗？就像它加载时一样：10kb、20kb、30kb 等

我的代码：

```
function calc(page)
    {
    $('#pageLoad h2').animate({ marginTop : '0px'}, 200);
        $.ajax(
        {
            url:            './pages/page.php',
            type:           'POST',
            data:           'page='+page,
            success:        function( feedback )
            {
                $('#content').html( feedback );
            }                               

        });
    }; 
```

对不起我糟糕的英语。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T22:31:45.077

这*是*可能的。XHR 有一个[`progress`事件](https://developer.mozilla.org/En/XMLHttpRequest/Using_XMLHttpRequest#Monitoring_progress)。唯一的问题是访问 XHR 对象 - 不幸的`beforeSend`是只接收`jqXHR`对象而不是底层 XHR 对象。它也不能作为包装器的属性访问。但是，您可以通过将以下选项添加到 XHR 对象的创建过程`$.ajax()`：

```
xhr: function () {
    var xhr = $.ajaxSettings.xhr(); // call the original function
    xhr.addEventListener('progress', function (e) {
        if (e.lengthComputable) {
            var percentComplete = e.loaded / e.total;
            // Do something with download progress
        }
    }, false);
    return xhr;
} 
```

* * *

这是我的初步解决方案。与 jQuery 结合起来非常困难，因为您不能轻松地挂接到 onreadystatechange 处理程序，并且在设置后无法安全地替换它：

~~您需要添加自定义`onreadystatechange`处理程序。当`readyState`XHR 对象变为`2`(*HEADERS_RECEIVED*) 时，您可以访问`Content-Length`标头以获取总大小，然后等待事件触发`xhr.readyState == 3`( *LOADING* )。~~

~~然后你可以通过查看来计算进度`xhr.responseText.length`。
但是，这只会触发一次。因此，您需要启动一个计时器（使用`setInterval()`），它将检查就绪状态和响应大小，例如每 100 毫秒。请求完成后，您再次使用 停止间隔`clearInterval()`。~~

# php - php模式匹配

> ID：10559265
> 
> 赞同：0
> 
> 时间：2012-05-11T22:10:04.340
> 
> 标签：php, pattern-matching

我想在最后一次出现“-”之前获取字符串的一部分，

例如，

```
$string1 = 'a-b-c-de-f-gfgh'; 
```

我想让这部分返回：abc-de-f。当然，我不知道最后一部分的长度。

什么是简单的方法？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T22:11:29.740

```
echo substr ($string1, 0, strrpos ($string1, '-')); 
```

strrpos() 查找子字符串的最后一次出现，在这种情况下为 -，并且 substr() 将原始字符串从第 0 个字符拆分到 strrpos() 定义的第 n 个字符

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T22:22:11.947

获取最后一次`-`使用`$x = strrpos($string1,'-');` 然后使用`substr()`返回从 0 到 $x 的指定字符串

```
 echo substr ($string1, 0, $x); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T22:13:31.247

使用[strrpos()](http://php.net/manual/de/function.strrpos.php)获取最后一个 "-" 的位置并使用[substr()](http://php.net/manual/de/function.substr.php)它：

```
echo substr($string1, 0, strrpos($string1, "-")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T22:14:46.593

您可以删除最后一部分：

```
$string = preg_replace("|-[^-]+$|", "", $string); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T22:14:27.520

作为其他海报的替代品：

```
preg_match('/(.*)-[^-]+/', 'a-b-c-de-f-gfgh', $result); 
```

结果：

```
Array
(
    [0] => a-b-c-de-f-gfgh-a
    [1] => a-b-c-de-f-gfgh
) 
```

虽然我更喜欢 Jeroens 解决方案。

# ios - 为什么我的 Xcode 构建总是失败？

> ID：10559266
> 
> 赞同：0
> 
> 时间：2012-05-11T22:10:47.153
> 
> 标签：ios, xcode, certificate

知道为什么我不能用 Xcode 构建我的 iOS 应用程序吗？我已经为模拟器成功构建了很多次，所以应用程序本身不是问题。当 Xcode 失败时，它给我这个错误消息：“代码签名错误：身份‘iPhone 开发者’与默认钥匙串中任何有效的、未过期的证书/私钥对不匹配。”

很简单，对吧？但是：在我的登录钥匙串中，我有两个证书，“iPhone Developer: [My First Name] [My Last Name] ([alphanumeric ID])”和“iPhone Distribution: [Name of My Company]”。两者都在 2012 年 8 月到期。“这个证书是有效的，”Keychain Access 告诉我他们两个。

在 Organizer 中，我有三个配置文件：“[公司名称] Distribution”、“[应用程序名称]”和“iOS 团队配置文件：*.”。所有这三个都有未来的到期日期。它们都在平台 iOS Profile 上。前两个的应用标识符为 [ALPHANUMERICCODE].com.[nameofcompany]。*，第三个的应用标识符只是 [ALPHANUMERICCODE].*。但是得到这个：所有三个在状态下都有“未找到有效的签名身份”。

我进行了大量搜索，找不到任何人报告证书和配置文件都存在但仍然无法在 Xcode 中构建存档的示例。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T03:04:01.870

这是钥匙的问题。在钥匙串访问中，有一个部分称为钥匙。我认为您缺少用于签署配置文件的密钥。

# android - 如何使用 Intent.ACTION_APP_ERROR 作为 Android 中“反馈”框架的一种手段？

> ID：10559267
> 
> 赞同：16
> 
> 时间：2012-05-11T22:10:52.097
> 
> 标签：android, android-intent

我想在我的应用程序中重用 Intent.ACTION_BUG_REPORT，作为获取用户反馈的简单方法。

谷歌地图使用它作为他们的“反馈”选项。但是我没有成功触发该事件。

我在 a 中使用以下内容`onOptionsItemSelected(MenuItem item)`：

```
 Intent intent = new Intent(Intent.ACTION_BUG_REPORT);
    startActivity(intent); 
```

在我`AndroidManifest.xml`的下面我声明了以下内容`Activity`：

```
 <intent-filter>
       <action android:name="android.intent.action.BUG_REPORT" />
       <category android:name="android.intent.category.DEFAULT" />
    </intent-filter> 
```

但是，当我选择该选项时，除了屏幕“闪烁”之外似乎什么都没有发生。应用程序或意图不会崩溃，它不会记录任何内容。在模拟器和 ICS 4.0.4 设备上都试过了。

我显然错过了一些东西，但是什么？

## 编辑

`Intent.ACTION_APP_ERROR`（常量`android.intent.action.BUG_REPORT`）在 API 中添加`level 14`，[http://developer.android.com/reference/android/content/Intent.html#ACTION_APP_ERROR](http://developer.android.com/reference/android/content/Intent.html#ACTION_APP_ERROR)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-03T20:40:17.700

请不要将两种不同的意图`Intent.ACTION_BUG_REPORT`和`Intent.ACTION_APP_ERROR`. 第一个是为旧的错误报告和反馈而设计的，它受**API v1**的支持。第二个是用于发送高级错误报告（支持`ApplicationErrorReport`可以存储大量有用信息的对象）并添加到**API v14**中。

为了发送反馈，我正在我的新版 APP 中测试以下代码（它还创建了活动的屏幕截图）。这开始`com.google.android.gms.feedback.FeedbackActivity`了，它是**Google Play 服务**的一部分。但问题是我在哪里可以找到反馈？！

```
protected void sendFeedback(Activity activity) {
    activity.bindService(new Intent(Intent.ACTION_BUG_REPORT), new FeedbackServiceConnection(activity.getWindow()), BIND_AUTO_CREATE);
}

protected static class FeedbackServiceConnection implements ServiceConnection {
    private static int MAX_WIDTH = 600;
    private static int MAX_HEIGHT = 600;

    protected final Window mWindow;

    public FeedbackServiceConnection(Window window) {
        this.mWindow = window;
    }

    public void onServiceConnected(ComponentName name, IBinder service) {
        try {
            Parcel parcel = Parcel.obtain();
            Bitmap bitmap = getScreenshot();
            if (bitmap != null) {
                bitmap.writeToParcel(parcel, 0);
            }
            service.transact(IBinder.FIRST_CALL_TRANSACTION, parcel, null, 0);
            parcel.recycle();
        } catch (RemoteException e) {
            Log.e("ServiceConn", e.getMessage(), e);
        }
    }

    public void onServiceDisconnected(ComponentName name) { }

    private Bitmap getScreenshot() {
        try {
            View rootView = mWindow.getDecorView().getRootView();
            rootView.setDrawingCacheEnabled(true);
            Bitmap bitmap = rootView.getDrawingCache();
            if (bitmap != null)
            {
                double height = bitmap.getHeight();
                double width = bitmap.getWidth();
                double ratio = Math.min(MAX_WIDTH / width, MAX_HEIGHT / height);
                return Bitmap.createScaledBitmap(bitmap, (int)Math.round(width * ratio), (int)Math.round(height * ratio), true);
            }
        } catch (Exception e) {
            Log.e("Screenshoter", "Error getting current screenshot: ", e);
        }
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-26T08:55:53.143

这在上面@TomTasche 评论中的链接的帮助下得到了解决。[在 Android 上使用内置的反馈机制](http://blog.tomtasche.at/2012/10/use-built-in-feedback-mechanism-on.html)。

在我的中，`AndroidManifest.xml`我将以下内容添加到`<Activity>`我想从中调用反馈代理的位置。

```
<intent-filter>
   <action android:name="android.intent.action.APP_ERROR" />
   <category android:name="android.intent.category.DEFAULT" />
</intent-filter> 
```

我做了一个简单的方法，叫做`sendFeedback()`（来自 TomTasche 博客文章的代码）

```
@SuppressWarnings("unused")
@TargetApi(Build.VERSION_CODES.ICE_CREAM_SANDWICH)
private void sendFeedback() {
    try {
        int i = 3 / 0;
    } catch (Exception e) {
    ApplicationErrorReport report = new ApplicationErrorReport();
    report.packageName = report.processName = getApplication().getPackageName();
    report.time = System.currentTimeMillis();
    report.type = ApplicationErrorReport.TYPE_CRASH;
    report.systemApp = false;

    ApplicationErrorReport.CrashInfo crash = new ApplicationErrorReport.CrashInfo();
    crash.exceptionClassName = e.getClass().getSimpleName();
    crash.exceptionMessage = e.getMessage();

    StringWriter writer = new StringWriter();
    PrintWriter printer = new PrintWriter(writer);
    e.printStackTrace(printer);

    crash.stackTrace = writer.toString();

    StackTraceElement stack = e.getStackTrace()[0];
    crash.throwClassName = stack.getClassName();
    crash.throwFileName = stack.getFileName();
    crash.throwLineNumber = stack.getLineNumber();
    crash.throwMethodName = stack.getMethodName();

    report.crashInfo = crash;

    Intent intent = new Intent(Intent.ACTION_APP_ERROR);
    intent.putExtra(Intent.EXTRA_BUG_REPORT, report);
    startActivity(intent);
    }
} 
```

从我的角度来看，`SettingsActivity`我称之为：

```
 findPreference(sFeedbackKey).setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {
          public final boolean onPreferenceClick(Preference paramAnonymousPreference) {
              sendFeedback();
              finish();
              return true;
          }
      }); 
```

## 经验证可与 Android **2.3.7**和**4.2.2**一起使用。

当`sendFeedback()`调用该方法时，会打开一个“使用完成操作”对话框，用户可以在其中从三个操作/图标中进行选择。

![使用完成动作](../Images/ae6590eb7638f84cbd97cb4f1c15f7c2.png)

返回到应用程序的调用应用程序，以及 Google Play 和反馈代理。选择`Google Play Store`或`Send feedback`将按预期打开内置 Android 反馈代理。

![发送反馈](../Images/0763fbf66abcb4afb39418ebfdcbc048.png)

如果可以跳过“使用完成操作”步骤，我还没有进一步调查，可能通过将正确的参数传递给`Intent`. 到目前为止，这正是我现在想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-07T19:53:04.723

请注意，崩溃报告解决方案（如此处）不适用于 ICS 之前的 Android 版本。

“kaderud”解决方案的更短、更简单的版本（[**此处**](https://stackoverflow.com/a/16232417/878126)）：

```
 @TargetApi(Build.VERSION_CODES.ICE_CREAM_SANDWICH)
  private void sendFeedback()
    {
    final Intent intent=new Intent(Intent.ACTION_APP_ERROR);
    final ApplicationErrorReport report=new ApplicationErrorReport();
    report.packageName=report.processName=getApplication().getPackageName();
    report.time=System.currentTimeMillis();
    report.type=ApplicationErrorReport.TYPE_NONE;
    intent.putExtra(Intent.EXTRA_BUG_REPORT,report);
    final PackageManager pm=getPackageManager();
    final List<ResolveInfo> resolveInfos=pm.queryIntentActivities(intent,0);
    if(resolveInfos!=null&&!resolveInfos.isEmpty())
      {
      for(final ResolveInfo resolveInfo : resolveInfos)
        {
        final String packageName=resolveInfo.activityInfo.packageName;
        // prefer google play app for sending the feedback:
        if("com.android.vending".equals(packageName))
          {
          // intent.setPackage(packageName);
          intent.setClassName(packageName,resolveInfo.activityInfo.name);
          break;
          }
        }
      startActivity(intent);
      }
    else
      {
      // handle the case of not being able to send feedback
      }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-07T00:26:18.807

从 API 级别 14 开始，您可以尝试使用该`ACTION_APP_ERROR`意图，但该应用程序需要在 Google Play 商店中可用才能正常工作。

```
Intent intent = new Intent(Intent.ACTION_APP_ERROR);
startActivity(intent);
//must be available on play store 
```

# javascript - 图表库开放或商业

> ID：10559268
> 
> 赞同：1
> 
> 时间：2012-05-11T22:10:57.100
> 
> 标签：javascript, mapping, data-visualization, vector-graphics

任何人都对如何获得控制来做这样的事情有建议 [http://screencast.com/t/VyHdxOdRJQwY](http://screencast.com/t/VyHdxOdRJQwY)

我将根据城市或邮编进行绘图，因此我需要维护一些地理方面，但最终图表控件需要看起来像这个人。

理想情况下没有闪光灯......但有兴趣看看是否有人遇到过这样的事情。

开源或商业源代码，即时游戏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T01:41:03.040

我们最终使用了具有开放地图背景的[http://www.mapdotnet.com/ 。](http://www.mapdotnet.com/)来自存储在 SQL 中的形状文件的自定义中间缓存切片，在顶部我们有开放的街道图层（或者可以使用 bing）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:13:11.650

我建议您查看[Google Maps API](https://developers.google.com/maps/documentation/javascript/)。API 有两个版本：

*   [静态地图 API V2](https://developers.google.com/maps/documentation/staticmaps/) - 来自文档：

> Google 静态地图 API 可让您在网页上嵌入 Google 地图图像，而无需 JavaScript 或任何动态页面加载。Google 静态地图服务根据通过标准 HTTP 请求发送的 URL 参数创建地图，并将地图作为可以显示在网页上的图像返回。

有使用限制：免费版本的查询限制为每位查看者每天 1000 个唯一（不同）图像请求，如果这适合您的情况。有一个许可选项高于相关许可费用。

*   [Google Maps JavaScript API v3](https://developers.google.com/maps/documentation/javascript/) - 来自文档：

> Google Maps Javascript API 可让您将 Google Maps 嵌入您自己的网页中。此 API 的第 3 版专门设计用于更快、更适用于移动设备以及传统的桌面浏览器应用程序。API 提供了许多用于操作地图的实用程序（就像在[http://maps.google.com](http://maps.google.com)网页上一样）并通过各种服务向地图添加内容，从而允许您在您的网站上创建强大的地图应用程序。

此版本也有类似的使用限制，在免费版本之上还有一个许可选项。

API 可以轻松地创建地图以匹配您链接中的地图。这些不是完全匹配，但以下是[Google 地图演示库](https://developers.google.com/maps/documentation/javascript/demogallery)中的一些示例：

![在此处输入图像描述](../Images/43e066f40ff7913936bf9142ff9974e0.png) ![在此处输入图像描述](../Images/3745eb9e8ca79981bf93f78417942dd1.png) ![在此处输入图像描述](../Images/cef57fad49d0b9d66d7ab2ed4f0205ea.png) ![在此处输入图像描述](../Images/cff44eabecd992a6cc9a575a8ba2d58e.png) ![在此处输入图像描述](../Images/98b4990b9b9e8276a6218952aae847c4.png) ![在此处输入图像描述](../Images/47d06301467ceab8ae395d0a8659b46b.png) ![在此处输入图像描述](../Images/df50a3e22d1c836cb8cbbe3e9fab3182.png) ![在此处输入图像描述](../Images/dc17d7966f984d9accc4bab4707ff723.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T22:23:33.897

[d3](https://github.com/mbostock/d3)似乎是一个非常好的数据可视化库。

在此处查看示例：[https ://github.com/mbostock/d3/wiki/Gallery](https://github.com/mbostock/d3/wiki/Gallery)

这是一个类似于您正在寻找的实现。[http://trends.truliablog.com/vis/metro-movers/](http://trends.truliablog.com/vis/metro-movers/)

# optimization - GCC：march 与 mtune 有何不同？

> ID：10559275
> 
> 赞同：93
> 
> 时间：2012-05-11T22:12:18.843
> 
> 标签：optimization, gcc, compiler-construction, options, flags

我试图为此擦洗 GCC 手册页，但仍然不明白，真的。

`-march`和有什么区别`-mtune`？

什么时候使用 just `-march`, vs. both？有没有可能只是`-mtune`？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-05-11T22:22:49.963

如果您使用`-march`，那么 GCC 将可以自由地生成在指定 CPU 上工作的指令，但（通常）不能在架构系列中的早期 CPU 上工作。

如果您只使用`-mtune`，那么编译器将生成适用于其中任何一个的代码，但会偏向在您指定的特定 CPU 上运行速度最快的指令序列。例如，为该 CPU 适当地设置循环展开启发式。

* * *

`-march=foo`暗示`-mtune=foo`除非您还指定不同的`-mtune`. 这就是为什么使用`-march`比只启用选项（例如`-mavx`不做任何调整）更好的原因之一。

警告：`-march=native`在 GCC 未明确识别的 CPU 上，仍会启用 GCC 可以检测到的新指令集，但会离开`-mtune=generic`. 如果您希望它编写好的代码，请使用了解您的 CPU 的足够新的 GCC。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2014-04-24T11:24:20.777

这是我用谷歌搜索的：

该`-march=X`选项采用 CPU 名称`X`并允许 GCC 生成使用`X`. GCC 手册准确解释了哪些 CPU 名称意味着哪些 CPU 系列和功能。

因为通常会添加但不会删除功能，所以用 构建的二进制文件`-march=X`将在 CPU 上运行`X`，很有可能在比 更新的 CPU 上运行`X`，但几乎可以肯定它不会在比`X`. 某些指令集（我猜是 3DNow！）可能特定于特定的 CPU 供应商，使用这些指令集可能会让您获得不在竞争 CPU 上运行的二进制文件，无论是更新的还是其他的。

该`-mtune=Y`选项将生成的代码调整为`Y`比在它可能运行的其他 CPU 上运行得更快。`-march=X`暗示`-mtune=X`。`-mtune=Y`不会覆盖`-march=X`，因此，例如，它可能没有意义`-march=core2`并且`-mtune=i686`- 您的代码将不会在任何比任何旧的东西上运行`core2`，因为`-march=core2`，那么究竟为什么您要针对比 core2 更旧（功能较少）的东西进行优化？`-march=core2 -mtune=haswell`更有意义：不要使用超出`core2`提供的任何功能（这仍然比`-march=i686`提供给您的功能要多得多！），但要为更新的`haswell`CPU 优化代码，而不是为`core2`.

还有`-mtune=generic`。`generic`使 GCC 生成在当前 CPU 上运行最好的代码（意味着`generic`从一个版本的 GCC 更改为另一个版本）。Gentoo 论坛上有传言说生成的代码比 do 生成的`-march=X -mtune=generic`代码运行得更快（或者只是暗示）。不知道这是不是真的。`X``-march=X -mtune=X``-march=X``-mtune=X`

通常，除非您确切知道自己需要什么，否则最好的方法似乎是指定`-march=<oldest CPU you want to run on>`and `-mtune=generic`(`-mtune=generic`在这里是为了对抗隐含的`-mtune=<oldest CPU you want to run on>`，因为您可能不想针对最旧的 CPU 进行优化)。或者只是`-march=native`，如果您只在您构建的同一台机器上运行。

# c# - 如何使用 MemoryCache 处理昂贵的构建操作？

> ID：10559279
> 
> 赞同：63
> 
> 时间：2012-05-11T22:13:04.570
> 
> 标签：c#, .net, memorycache

在 ASP.NET MVC 项目中，我们有几个数据实例，需要大量资源和时间来构建。我们想缓存它们。

`MemoryCache`提供一定程度的线程安全，但不足以避免并行运行多个构建代码实例。这是一个例子：

```
var data = cache["key"];
if(data == null)
{
  data = buildDataUsingGoodAmountOfResources();
  cache["key"] = data;
} 
```

正如您在繁忙的网站上看到的那样，数百个线程可能会同时进入 if 语句，直到构建数据并使构建操作变得更慢，从而不必要地消耗服务器资源。

MemoryCache 中有一个原子`AddOrGetExisting`实现，但它错误地需要“设置值”而不是“检索要设置的值的代码”，我认为这使得给定的方法几乎完全没用。

我们一直在围绕 MemoryCache 使用我们自己的临时脚手架来使其正确，但是它需要显式`lock`的 s。使用 per-entry 锁对象很麻烦，我们通常通过共享锁对象来逃避，这远非理想。这让我认为避免这种约定的原因可能是故意的。

所以我有两个问题：

*   `lock`不构建代码是更好的做法吗？（我想知道，这可能被证明对一个人来说更敏感）

*   对于这种锁，为 MemoryCache 实现每个条目锁定的正确方法是什么？`key`在“.NET 锁定 101”处消除了使用字符串作为锁定对象的强烈冲动。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-04-09T06:38:09.283

我们通过结合`Lazy<T>`with解决了这个问题，`AddOrGetExisting`从而完全避免了对锁定对象的需求。这是一个示例代码（使用无限过期）：

```
public T GetFromCache<T>(string key, Func<T> valueFactory) 
{
    var newValue = new Lazy<T>(valueFactory);
    // the line belows returns existing item or adds the new value if it doesn't exist
    var value = (Lazy<T>)cache.AddOrGetExisting(key, newValue, MemoryCache.InfiniteExpiration);
    return (value ?? newValue).Value; // Lazy<T> handles the locking itself
} 
```

那还不完整。有像“异常缓存”这样的陷阱，所以你必须决定你想要做什么，以防你的 valueFactory 抛出异常。但是，优点之一是也能够缓存空值。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-11T22:23:15.197

对于有条件的添加要求，我总是使用[`ConcurrentDictionary`](http://msdn.microsoft.com/en-us/library/dd287191.aspx)，它有一个重载[`GetOrAdd`](http://msdn.microsoft.com/en-us/library/ee378677.aspx)方法，如果需要构建对象，它接受一个委托来触发。

```
ConcurrentDictionary<string, object> _cache = new
  ConcurrenctDictionary<string, object>();

public void GetOrAdd(string key)
{
  return _cache.GetOrAdd(key, (k) => {
    //here 'k' is actually the same as 'key'
    return buildDataUsingGoodAmountOfResources();
  });
} 
```

实际上，我几乎总是使用`static`并发字典。我曾经有一个受`ReaderWriterLockSlim`实例保护的“普通”字典，但是一旦我切换到 .Net 4（它只从那以后可用），我就开始转换我遇到的任何字典。

`ConcurrentDictionary`至少可以说，他的表现令人钦佩:)

**使用仅基于年龄的过期语义**更新Naive 实现。**还应确保单个项目仅创建一次 - 根据@usr 的建议。 **再次更新**- 正如@usr 所建议的那样 - 简单地使用 a`Lazy<T>`会简单得多 - 您可以在将创建委托添加到并发字典时将其转发给该委托。我更改了代码，因为实际上我的锁字典无论如何都不会起作用。但我自己真的应该想到这一点*（尽管在英国的午夜过后，我被打败了。任何同情？不，当然不是。作为一名开发人员，我有足够的咖啡因在我的血管中流淌来唤醒死者）*。**

 **不过，我确实建议[`IRegisteredObject`](http://msdn.microsoft.com/en-us/library/system.web.hosting.iregisteredobject.aspx)用这个实现接口，然后用[`HostingEnvironment.RegisterObject`](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.registerobject.aspx)方法注册它——这样做会提供一种更简洁的方法来在应用程序池关闭/回收时关闭轮询线程。

```
public class ConcurrentCache : IDisposable
{
  private readonly ConcurrentDictionary<string, Tuple<DateTime?, Lazy<object>>> _cache = 
    new ConcurrentDictionary<string, Tuple<DateTime?, Lazy<object>>>();

  private readonly Thread ExpireThread = new Thread(ExpireMonitor);

  public ConcurrentCache(){
    ExpireThread.Start();
  }

  public void Dispose()
  {
    //yeah, nasty, but this is a 'naive' implementation :)
    ExpireThread.Abort();
  }

  public void ExpireMonitor()
  {
    while(true)
    {
      Thread.Sleep(1000);
      DateTime expireTime = DateTime.Now;
      var toExpire = _cache.Where(kvp => kvp.First != null &&
        kvp.Item1.Value < expireTime).Select(kvp => kvp.Key).ToArray();
      Tuple<string, Lazy<object>> removed;
      object removedLock;
      foreach(var key in toExpire)
      {
        _cache.TryRemove(key, out removed);
      }
    }
  }

  public object CacheOrAdd(string key, Func<string, object> factory, 
    TimeSpan? expiry)
  {
    return _cache.GetOrAdd(key, (k) => { 
      //get or create a new object instance to use 
      //as the lock for the user code
        //here 'k' is actually the same as 'key' 
        return Tuple.Create(
          expiry.HasValue ? DateTime.Now + expiry.Value : (DateTime?)null,
          new Lazy<object>(() => factory(k)));
    }).Item2.Value; 
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-28T10:37:33.910

将最佳答案带入 C# 7，这是我的实现，它允许从任何源类型存储`T`到任何返回类型`TResult`。

```
/// <summary>
/// Creates a GetOrRefreshCache function with encapsulated MemoryCache.
/// </summary>
/// <typeparam name="T">The type of inbound objects to cache.</typeparam>
/// <typeparam name="TResult">How the objects will be serialized to cache and returned.</typeparam>
/// <param name="cacheName">The name of the cache.</param>
/// <param name="valueFactory">The factory for storing values.</param>
/// <param name="keyFactory">An optional factory to choose cache keys.</param>
/// <returns>A function to get or refresh from cache.</returns>
public static Func<T, TResult> GetOrRefreshCacheFactory<T, TResult>(string cacheName, Func<T, TResult> valueFactory, Func<T, string> keyFactory = null) {
    var getKey = keyFactory ?? (obj => obj.GetHashCode().ToString());
    var cache = new MemoryCache(cacheName);
    // Thread-safe lazy cache
    TResult getOrRefreshCache(T obj) {
        var key = getKey(obj);
        var newValue = new Lazy<TResult>(() => valueFactory(obj));
        var value = (Lazy<TResult>) cache.AddOrGetExisting(key, newValue, ObjectCache.InfiniteAbsoluteExpiration);
        return (value ?? newValue).Value;
    }
    return getOrRefreshCache;
} 
```

### 用法

```
/// <summary>
/// Get a JSON object from cache or serialize it if it doesn't exist yet.
/// </summary>
private static readonly Func<object, string> GetJson =
    GetOrRefreshCacheFactory<object, string>("json-cache", JsonConvert.SerializeObject);

var json = GetJson(new { foo = "bar", yes = true }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-07-05T19:31:47.240

Sedat 将 Lazy 与 AddOrGetExisting 相结合的解决方案令人鼓舞。我必须指出，该解决方案存在性能问题，这对于缓存解决方案似乎非常重要。

如果你看一下 AddOrGetExisting() 的[代码](https://github.com/microsoft/referencesource/blob/e0bf122d0e52a42688b92bb4be2cfd66ca3c2f07/System.Runtime.Caching/System/Caching/MemoryCacheStore.cs#L151)，你会发现 AddOrGetExisting() 并不是一个无锁的方法。与无锁的Get()方法相比，它浪费了MemoryCache的优势之一。

我想建议遵循解决方案，首先使用 Get() 然后使用 AddOrGetExisting() 以避免多次创建对象。

```
public T GetFromCache<T>(string key, Func<T> valueFactory) 
{
    T value = (T)cache.Get(key);
    if (value != null)
    {
        return value;
    }

    var newValue = new Lazy<T>(valueFactory);
    // the line belows returns existing item or adds the new value if it doesn't exist
    var oldValue = (Lazy<T>)cache.AddOrGetExisting(key, newValue, MemoryCache.InfiniteExpiration);
    return (oldValue ?? newValue).Value; // Lazy<T> handles the locking itself
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-08T21:52:09.500

这是一个遵循您似乎想到的设计。第一次锁定只发生很短的时间。对 data.Value 的最终调用也会锁定（在下方），但只有当其中两个同时请求相同的项目时，客户端才会阻塞。

```
public DataType GetData()
{      
  lock(_privateLockingField)
  {
    Lazy<DataType> data = cache["key"] as Lazy<DataType>;
    if(data == null)
    {
      data = new Lazy<DataType>(() => buildDataUsingGoodAmountOfResources();
      cache["key"] = data;
    }
  }

  return data.Value;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-03T16:25:34.967

这是作为 MemoryCache 扩展方法的简单解决方案。

```
 public static class MemoryCacheExtensions
 {
     public static T LazyAddOrGetExitingItem<T>(this MemoryCache memoryCache, string key, Func<T> getItemFunc, DateTimeOffset absoluteExpiration)
     {
         var item = new Lazy<T>(
             () => getItemFunc(),
             LazyThreadSafetyMode.PublicationOnly // Do not cache lazy exceptions
         );

         var cachedValue = memoryCache.AddOrGetExisting(key, item, absoluteExpiration) as Lazy<T>;

         return (cachedValue != null) ? cachedValue.Value : item.Value;
     }
 } 
```

并测试它作为使用说明。

```
[TestMethod]
[TestCategory("MemoryCacheExtensionsTests"), TestCategory("UnitTests")]
public void MemoryCacheExtensions_LazyAddOrGetExitingItem_Test()
{
    const int expectedValue = 42;
    const int cacheRecordLifetimeInSeconds = 42;

    var key = "lazyMemoryCacheKey";
    var absoluteExpiration = DateTimeOffset.Now.AddSeconds(cacheRecordLifetimeInSeconds);

    var lazyMemoryCache = MemoryCache.Default;

    #region Cache warm up

    var actualValue = lazyMemoryCache.LazyAddOrGetExitingItem(key, () => expectedValue, absoluteExpiration);
    Assert.AreEqual(expectedValue, actualValue);

    #endregion

    #region Get value from cache

    actualValue = lazyMemoryCache.LazyAddOrGetExitingItem(key, () => expectedValue, absoluteExpiration);
    Assert.AreEqual(expectedValue, actualValue);

    #endregion
} 
```**

# c++ - 如何创建用户定义大小但没有预定义值的向量？

> ID：10559283
> 
> 赞同：79
> 
> 时间：2012-05-11T22:13:30.267
> 
> 标签：c++, vector

在 C++ 中，可以使用`int myarray[20]`. 但是，[关于向量的在线文档](http://www.cplusplus.com/reference/vector/vector/vector/)并没有显示初始化向量的类似方法：相反，向量应该使用例如`std::vector<int> myvector (4, 100);`. 这给出了一个大小为 4 的向量，所有元素的值都是 100。

如何像数组一样仅使用预定义的大小和没有预定义的值来初始化向量？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-05-11T22:17:12.827

使用构造函数：

```
// create a vector with 20 integer elements
std::vector<int> arr(20);

for(int x = 0; x < 20; ++x)
   arr[x] = x; 
```

# .net - ADODB 和 ADO.NET

> ID：10559289
> 
> 赞同：0
> 
> 时间：2012-05-11T22:14:15.907
> 
> 标签：.net, vb.net

在同一个应用程序中混合和匹配 ADODB（例如 Connections 等）和 ADO.NET（例如 SQLConnections 等）是不是特别糟糕的做法？我正在尝试将一些 VB6 代码合并到 ASP.NET 应用程序 (VB.NET) 中。

# java - 从 InputStream 读取到 byte[] 抛出 IndexOutOfBoundsException

> ID：10559292
> 
> 赞同：2
> 
> 时间：2012-05-11T22:14:31.857
> 
> 标签：java, sockets, networking, inputstream

我显然不知道问题出在哪里！首先我要求客户向我发送`byte[]`他要发送的长度，然后我像这样读取它的长度。

```
int i = 323292; // length of incoming Byte[]
byte[] b = new byte[i]; 
int readBytes=inputStream.read(b,0,b.length); 
```

但它总是读取 readBytes 少于 i。而且我确信客户端会发送整个`byte[]`.

我试图把它放在一个循环中，直到我的读取字节总数为 i，但我总是在第二次迭代后得到 IndexOutOfBoundsException！这是代码

```
boolean flag = true;
int i = 323292;
int threshold = 0;
byte[] b = new byte[i];
int read = 0;
while (flag) {
    if (threshold < i) {
        System.out.println(threshold);
        try {
            read = inputStreamFromClient.read(b, threshold, b.length);
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        threshold = threshold + read;
    } else {
        flag = false;
    }
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T22:17:29.090

这：

```
read = inputStreamFromClient.read(b, threshold, b.length); 
```

应该：

```
read = inputStreamFromClient.read(b, threshold, b.length - threshold); 
```

# preg-match - 从 ereg 更新到 preg_match

> ID：10559296
> 
> 赞同：1
> 
> 时间：2012-05-11T22:15:05.077
> 
> 标签：preg-match, ereg

我读过类似的标题，但我无法让它运行..

现在，我有这样的代码（最初是 ereg）：

```
 if (preg_match("[^0-9]",$qrcode_data_string)){
        if (preg_match("[^0-9A-Z \$\*\%\+\-\.\/\:]",$qrcode_data_string)) { 
```

我也尝试在规则的开头和结尾使用 / 但没有奏效。

欢迎任何回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:16:39.107

使用`preg_*`您需要在模式周围使用[分隔符](http://php.net/manual/en/regexp.reference.delimiters.php)的功能：

```
if (preg_match("#[^0-9]#", $qrcode_data_string)) {
#               ^      ^ 
```

从文档中：

> 使用 PCRE 函数时，需要用分隔符将模式括起来。定界符可以是任何非字母数字、非反斜杠、非空白字符。
> 
> 常用的分隔符是正斜杠 (/)、井号 (#) 和波浪号 (~)。

# php - 通过 Facebook 邀请朋友，在他们的墙上发帖并返回网站

> ID：10559300
> 
> 赞同：0
> 
> 时间：2012-05-11T22:16:02.917
> 
> 标签：php, facebook, response.redirect, invite

我在 Facebook 中为我的网站创建了一个应用程序。在邀请朋友加入应用时，它会返回一个回调 url：

```
> referrals/fb_invite?channel=6&ids[]=100000576230613 
```

这会导致 404 页面错误。

**这个 URL 从 facebook 是什么意思，如何重定向到我的网站？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:59:31.307

> 我认为这不是来自 facebook 的错误。这可能只发生在您身边。
> 
> > 尝试更改回调 url 并使用从 facebook 检索到的 id。
> 
> 创建函数 fb_invite 并使用检索到的 id 并传递它。

# ruby-on-rails - 嵌入式 Ruby 中的标题

> ID：10559302
> 
> 赞同：0
> 
> 时间：2012-05-11T22:16:07.583
> 
> 标签：ruby-on-rails

我是 Ruby on Rails 的新手，我想知道，我目前将标题定义为：

```
<% provide(:title, @user.first_name) %> 
```

如果我想将 @user.last_name 添加到该字符串，我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:20:49.240

您可以使用运算符连接字符串`+`：

```
<% provide(:title, @user.first_name + " " + @user.last_name) %> 
```

# css - 使用 text-overflow:ellipsis 时 white-space:nowrap 的替代品

> ID：10559311
> 
> 赞同：6
> 
> 时间：2012-05-11T22:17:25.310
> 
> 标签：css

在他的[演示页面上](http://www.quirksmode.org/css/textoverflow.html)，PPK 说 text-overflow:ellipsis 要求（除其他外）“盒子有空格：nowrap 或类似的方法来限制文本的布局方式。”

有谁知道他指的是什么其他类型的“约束”？我已经尝试了所有其他空白选项，但没有一个能满足我的需求。我不相信他所说的“类似的约束方法”这句话的意思只是“任何其他空白设置”，但我无法想到任何其他文本布局约束。

我问是因为我想在视觉截断文本之前显示最多两行文本（我使用 height:2.5em 完成），并且 white-space:nowrap 防止文本换行以填充我分配的空间.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T22:21:47.780

`white-space: nowrap`如果您想以`text-overflow: ellipsis`有用的方式使用，则需要。

我不知道他会想到什么“限制文本布局方式的类似方法”。

> 我问是因为我想在视觉上截断文本之前最多显示两行文本

我认为 CSS 做不到。这是[一个答案](https://stackoverflow.com/questions/6572330/is-it-possible-to-use-text-overflowellipsis-on-multiline-text)，我说了同样的话，10 个月后有 612 次观看，没有人不同意。

# playframework - 播放框架安装

> ID：10559313
> 
> 赞同：10
> 
> 时间：2012-05-11T22:17:32.923
> 
> 标签：playframework, playframework-2.0, failed-installation

我正在尝试在 ubuntu 11 上安装播放框架 2.0.1。我已经添加了在 ubuntu 中播放的路径，我配置了 SUN JRE 1.6 (java/javac)，并且我已经为播放脚本提供了读/写/执行权限。但是，当我运行“播放帮助”时，我仍然收到下面复制的错误 - 播放目录应该只包含“文档”、“存储库”、“框架”和“样本”子目录，还是应该包含其他子目录. 欢迎任何有用的建议。

```
java.io.IOException: No such file or directory
at java.io.UnixFileSystem.createFileExclusively(Native Method)
at java.io.File.createNewFile(File.java:900)
at xsbt.boot.Locks$.apply0(Locks.scala:34)
at xsbt.boot.Locks$.apply(Locks.scala:27)
at scala.collection.mutable.FlatHashTable$class.$init$(Proxy.scala:32)
at xsbt.boot.Launch$ScalaProvider.<init>(Launch.scala:110)
at xsbt.boot.Launch$$anonfun$1.apply(Launch.scala:84)
at org.apache.ivy.plugins.namespace.NamespaceRule.newEntry(Cache.scala:17)
at org.apache.ivy.plugins.namespace.NamespaceRule.apply(Cache.scala:12)
at xsbt.boot.Launch.getScala(Launch.scala:86) 
at xsbt.boot.Launch$.run(Launch.scala:49)
at xsbt.boot.Launch$$anonfun$explicit$1.apply(Launch.scala:43)
at xsbt.boot.Launch$.launch(Launch.scala:68)
at xsbt.boot.Launch$.apply(Launch.scala:14)
at xsbt.boot.Boot$.runImpl(Boot.scala:25)
at xsbt.boot.Boot$.main(Boot.scala:15)
at xsbt.boot.Boot.main(Boot.scala)
Error during sbt execution: java.io.IOException: No such file or directory 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-14T00:22:33.017

如果您查看[文档](http://www.playframework.org/documentation/2.0.1/Installing)，您将看到以下警告：

> 将存档解压缩到**您同时具有读写访问权限**的位置（...）运行 play 会将一些文件写入存档中的目录，因此**不要安装到 /opt、/usr/local 或您需要的任何其他位置写信的特别许可**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-20T17:47:16.683

如果您真的想在您的开发机器上运行 play in opt，您可能希望自己使用 chown /opt。

```
sudo chown yourself:yourself /opt 
```

我不认为这是有道理的，并且对 /opt 中的其他内容以及 /opt 目录的通常用途有影响。与典型的 Web 服务器环境不同，play 有一个嵌入式服务器（如 nodejs）。此外，如前所述，当您准备要运行的项目时，会生成大量文件。对于开发，我认为最好将游戏安装在您默认拥有的目录中，例如您的主目录。在生产中，您将以 root 身份安装和启动所有内容，从而使 /opt 成为可行的选项。此外，在使用需要管理访问权限的目录的窗口中，即使不是更多，也需要进行不明智的更改。Play 不正式支持生产模式下的 windows。

# django - 在 django admin 中上传和处理文件

> ID：10559321
> 
> 赞同：1
> 
> 时间：2012-05-11T22:18:53.223
> 
> 标签：django, file-upload, django-admin

我有两个模型，`Course`和`Student`。我想`Course`在管理员的表单中包含一个文件上传字段，以接受一个 CSV 文件，我将处理该文件并将其作为一个或多个记录存储在`Student`s 表中。我的问题是：

1.  如何将此“瞬态”字段添加到`Course`模型中，而不是相应表中的列或其他内容？
2.  我应该在哪里进行文件处理？我在想也许覆盖类`save_model`中的方法`CourseAdmin`会做到这一点，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T05:46:18.567

1 - 您可以在管理员中覆盖[表单类。](https://github.com/django/django/blob/master/django/contrib/admin/options.py#L68)创建您自己的`ModelForm`并在那里添加必要的字段 2 - 之后，覆盖[form_save](https://github.com/django/django/blob/master/django/contrib/admin/options.py#L698)或表单的`save()`方法并在那里处理您的文件

# c++ - Detours - 挂钩类成员函数 - 设置目标函数偏移的语法？

> ID：10559323
> 
> 赞同：2
> 
> 时间：2012-05-11T22:19:19.743
> 
> 标签：c++, hook, detours

对于非类函数 - 我可以简单地声明要绕行的函数的偏移量，例如：

```
typedef int (_cdecl* SomeFunc)(char* pBuffer, int size);

SomeFunc Real_SomeFunc = (SomeFunc)(0xCAFEBABE);

...

DetourAttach(&(PVOID&)Real_SomeFunc, (PVOID)Hook_SomeFunc); 
```

现在，绕行类的成员函数变得很困难 - detours 有一个示例：

[https://github.com/microsoft/Detours/blob/master/samples/member/member.cpp](https://github.com/microsoft/Detours/blob/master/samples/member/member.cpp)

该示例已经定义了目标成员函数 - 但我不只知道将我的 DLL 注入的二进制文件中的偏移量 - 那么我该如何转换它

```
void (CDetour::* CDetour::Real_Target)(void) = 
    (void (CDetour::*)(void))&CMember::Target; 
```

像这样：

```
void (CDetour::* CDetour::Real_Target)(void) = 
    (void (CDetour::*)(void))0xCAFEBABE; 
```

我在这里遇到编译错误

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-06-01T16:44:26.557

> ```
> void (CDetour::* CDetour::Real_Target)(void) = (void (CDetour::*)(void))0xCAFEBABE; 
> ```
> 
> 我在这里遇到编译错误

具体来说，就是`error C2440: 'type cast' : cannot convert from 'unsigned int' to 'void (__thiscall CDetour::* )(void). There are no conversions from integral values to pointer-to-member values`。转换为成员指针是一件不平凡的事情——它们可能是也可能不是简单的内存地址，具体取决于成员函数的类型和类层次结构的复杂性。多重虚拟继承给这个伪数据结构增加了额外的字段；除了代码地址之外，还有重新定位信息。此数据的格式是特定于编译器的。

出于我的目的，我使用这个特定于 MSVC 的宏：

```
/// Void pointer to Func pointer.
/// Assumes first four bytes should hold the address and rest be zero.
template<typename T> T VTOF(void* ptr)
{// fills in 4 bytes and zeroes the rest
    T result = 0;
    *(void**)&result = ptr;
    return result;
} 
```

用法：`ptr = VTOF<void (CDetour::*)(void)>((void*)0xCAFEBABE);` 现在，这显然不适用于真正的复杂代码，但我认为它足以在挂钩中调用原始代码。自从我不得不在成员函数指针上使用它已经有一段时间了。

# javascript - javascript跟踪和放置多个图像在图像顶部

> ID：10559325
> 
> 赞同：0
> 
> 时间：2012-05-11T22:19:43.053
> 
> 标签：javascript, jquery, html, canvas

我在这里进行了搜索，找不到任何适合此问题的答案。

我正在写一个曲棍球得分机会跟踪器，基本上我想显示曲棍球冰的图像，每次单击图像时，它都会记住您单击的位置，并在您单击的位置放置一个红色小圆圈，并在顶部显示一个数字。该数字将是一个自动递增的数字。最终，我想跟踪所有鼠标点击在哪里存储到数据库中。

图像的一侧将是一个表格，每次单击鼠标都会在表格中添加一个新行。这部分不太难，我可以用 jquery 轻松完成。

我遇到的问题是试图找到一种快速简便的方法来多次将相同的图像放置在用户单击的另一个图像之上。我一直在研究 HTML5/Canvas，以及简单的 javascript/jquery 来做到这一点。

我在这里寻求有关简单方法的建议。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:23:25.680

这是我的做法 - 简单，简短的方式，我不知道你想如何扩展它：

我会创建一个数组，并将事件侦听器绑定到您希望用户单击的 div。

每次用户点击此图片时，都会传递一个事件对象，您可以根据您的布局读出鼠标的 X 和 Y 坐标 - .position() 或 .offset()。创建一个 JSON 对象，该对象存储这些值：

```
var hit = {
    id: 1,
    x: 250,
    y: 365,
    //add more attributes if you like/need
    //for this particular 'hit'
} 
```

您可以将此对象（-notation）存储在数组中：

```
hitz.push(hit); 
```

现在你应该基于这个数组“更新”你的 UI。只需使用 for...in 循环循环并创建图像：

```
var hockeyIceClone= $("div.hockey-ice").clone(true);

for (var i in hitz) {
    var hit = hitz[i];
    hockeyIceClone.append(
        //assuming that your .hockey-ice div has position:relative at least
        var image = $(new Image('image/path.png'));
        //add more stuff for image if you like
        $(image).css({
            position: absolute,
            left: hit.x,
            top: hit.y
        })
    );
}

$("div.hockey-ice").replaceWith(hockeyIceClone); 
```

克隆的原因是，当您遍历数组并将元素附加到放置在 UI 上且可见的“容器”时，它可能会在呈现时闪烁。所以你最好先“收集”它，然后把它们放在 UI 上。您也可以使用除克隆以外的其他方法，这只是一种选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T22:57:16.200

这是一个超级简单的 jsfiddle，其中包含了我可能会如何着手做的开始 - 如果您有任何问题/疑虑/需要帮助进行进一步改进，请告诉我，我会很高兴更新！

[http://jsfiddle.net/jking/4dMJG/](http://jsfiddle.net/jking/4dMJG/)

（只是防止我的 div 是图像，而侧边栏是真实的形式......）

# php - ajax 不适用于 LIKE 按钮

> ID：10559339
> 
> 赞同：0
> 
> 时间：2012-05-11T22:21:21.730
> 
> 标签：php, javascript, jquery, mysql, ajax

我在使用 AJAX/JS 和 PHP 时遇到了一些问题。我想要做的是一个 LIKE 按钮，如果单击，页面不会重新加载，但特定评论的类似列会更新。我已经能够想出这两个脚本 php 和 AJAX。但是现在当我加载 about_cs.php 并单击 LIKE 按钮时，屏幕上什么也没有显示。请问我的问题来自哪里？感谢您的时间和耐心，我非常感激。谢谢你。

**about_cs.php**

```
 $q = "SELECT c.comment_id
    FROM comment AS c  
    INNER JOIN about AS ac ON
    c.article_id = ac.about_id
    WHERE   c.article_id =  '".$article_id."'
    AND page_name = '".$page_name."'"
    or die (mysql_error());

    $r = mysql_query($q);
    if(mysql_num_rows($r)==1)
    {

   $row = mysql_fetch_assoc($r);
    $likes = $row['votes_up'];
    }

    $comment_id = $_GET['comment_id'];
    $action = $_GET['action'];

    if($action=='like') 
    {
    $total_likes = $likes+1;
    $q = "UPDATE comment 
    SET like = $total_likes 
    WHERE   c.article_id =  '".$article_id."'
    AND page_name = '".$page_name."'";
    } 
```

**喜欢按钮**

```
echo "<a class=\"like\" href=\"about_cs.       php?action=like&comment_id=
  $comment[comment_id]&article_id=$_
  SESSION[article_id] \"><img src =\"like.
  jpeg\" ></a>";

 $(function(){
 $(".like").click(function(){
 the_id = $(this).attr('comment_id');
    $.ajax({
      type: "GET",
            data: "action=likep&comment_id     ="+$(this).attr("comment_id"),
        url: "about_cs.php",
        success: function(msg)
        {
        $("span.likes"+the_id).html(msg);  

        }
       });
      });
      }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T22:24:21.547

您正在将类添加到锚点并尝试通过 id 选择器来定位它。

```
$(".like").click(function(){

   ^ notice the selector. 
```

# windows-phone-7 - 如何在 Windows Phone 7 上播放在线声音剪辑？

> ID：10559341
> 
> 赞同：0
> 
> 时间：2012-05-11T22:21:26.150
> 
> 标签：windows-phone-7, streaming, audio-player

我正在尝试创建一个应用程序来播放在线找到的短声音剪辑。我不能把它们放在客户端上，所以它们需要从互联网上播放。我可以使用 MediaElement 播放声音，但前提是在手机上找到声音剪辑。我怎样才能让它从网上下载一个播放声音剪辑？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:28:20.970

MediaElement 可用于此。您应该使用[Source](http://msdn.microsoft.com/en-us/library/system.windows.controls.mediaelement.source%28v=vs.95%29.aspx)属性。

```
<MediaElement x:Name="Media" Source="http://www.domain.com/song"/> 
```

您也可以从代码中设置源代码

```
Media.Source = new Uri("http://www.domain.com/song");
Media.Play(); 
```

# r - 未附加命名空间时的 R 包依赖性问题

> ID：10559350
> 
> 赞同：11
> 
> 时间：2012-05-11T22:21:48.837
> 
> 标签：r, cran

我一直认为在“Depends”字段中有一个包也会自动*导入*命名空间。但是，似乎在 R 2.15 中，依赖关系在包实际*附加*到搜索路径之前不可用。这是预期的行为吗？

问题出现如下：假设有一个包'Child'，它*依赖*，但没有显式*导入*一个名为'Parent'的包，并且包含一个调用'Parent'命名空间中的对象的函数。那么当这个函数在没有实际附加'Child'的情况下被调用时，'Parent'中的函数就找不到了。

这是包手册中的一个示例`bigdata`，但问题非常普遍：

```
x = matrix(rnorm(50*80),50,80)
beta = c(3,2,1.5,rep(0,77))
y = rnorm(50) + x%*%beta
z1 = bigdata::lasso.stars(x,y) 
```

该示例失败，因为 lasso.stars 依赖于 'glmnet'，它在`bigdata`附加之前不会加载。能够调用的唯一方法`lasso.stars`是实际附加`bigdata`包：

```
library(bigdata)
z1 = bigdata::lasso.stars(x,y) 
```

现在使事情进一步复杂化，似乎这个问题被继承到在这种情况下导入 lasso.stars 函数的任何“孙子”*包*。我很难找到一个很好的例子，但我相信他们就在那里。

这是一个错误吗？我知道可以通过要求包作者使用 Imports 而不是 Depends 来避免这种情况，但实际上 CRAN 上的大多数包仍然使用 Depends。如果 R 会自动将任何 Depends 包的名称空间导入到子包名称空间中，那么这个问题似乎很容易避免。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T21:14:50.163

对于那些感兴趣的人，在 r-devel 邮件列表中继续[讨论](http://r.789695.n4.nabble.com/R-package-dependency-issues-when-namespace-is-not-attached-td4629828.html)：

# ruby-on-rails-3 - Ruby on Rails：从检索到的模型对象数组中获取所有链接的模型对象

> ID：10559352
> 
> 赞同：0
> 
> 时间：2012-05-11T22:22:11.287
> 
> 标签：ruby-on-rails-3

我正在使用一个有很多链接模型对象的数据库，我想知道，如果我有一个名为“用户”的模型对象并且用户可以将“应用程序”链接到它们，那么获取链接到给定用户数组的所有应用程序的数组？

例如，如果我有一个特定的用户子集：

```
@users = User.find_all_by_favorite_color("Green")
@applications = @users.applications # What is the right call here? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:55:47.097

```
@applications = @users.map(&:applications) 
```

# jquery - 将脚本添加到 head 标签

> ID：10559356
> 
> 赞同：-3
> 
> 时间：2012-05-11T22:22:24.500
> 
> 标签：jquery, jquery-plugins

> **可能重复：**
> [如何在页面加载后通过 jQuery 动态插入 <script> 标签？](https://stackoverflow.com/questions/3857874/how-to-dynamically-insert-a-script-tag-via-jquery-after-page-load)

我有这个代码

```
var scri = "<script type=\"text/javascript\">var _gaq = _gaq || []; _gaq.push(['setAccount','UA-22xxxxx3-15']); _gax.push(['_trackPageview']); <\/script>";
document.getElementsByTagName("script")[23].add(scri);
console.log(scri); 
```

我想将该元素附加到文档的开头，我尝试了 .append() .text() .add() 和许多其他方法，但我总是出错。最后一个是

```
Uncaught TypeError: Object #<HTMLScriptElement> has no method 'add' 
```

知道如何将其附加到头部元素吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T22:24:51.847

您应该使用`document.createElement`and `.appendChild()`：

```
var script = document.createElement("script");
script.innerHTML = "alert(\"This is the truth.\");";
document.head.appendChild(script); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:43:27.793

为什么要将内联脚本附加到 HEAD 标记？没有必要这样做。如果您想通过 URL 加载远程脚本文件，附加到 HEAD 标记很有用，但在您的情况下不需要或没有用。

要在您的 JS 代码想要运行的地方执行一些内联​​代码，只需像这样执行您的代码：

```
var _gaq = _gaq || []; 
_gaq.push(['setAccount','UA-22xxxxx3-15']);
_gaq.push(['_trackPageview']); 
```

# javascript - 如何将弹出窗口放置设置为下方而不是右侧

> ID：10559358
> 
> 赞同：1
> 
> 时间：2012-05-11T22:22:36.090
> 
> 标签：javascript, jquery, jquery-plugins, twitter-bootstrap

我的语法有什么问题我无法在下面显示。默认情况下，弹出框设置为正确显示。我想将其更改为在下面显示。根据文档，我需要在下面写下位置。但它不工作。

```
 $("a[rel=popover1]")
  .popover({placement:'below'})
  .click(function(e) {
    e.preventDefault()
  }) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T22:50:18.803

`bottom`如果您使用的是[bootstrap-popover.js](http://twitter.github.com/bootstrap/javascript.html#popovers)，我认为它不应该低于。

[http://jsfiddle.net/5DGef/15/](http://jsfiddle.net/5DGef/15/)

```
$(function() {
    $('a[rel=popover]').popover({placement:'bottom'});
});​ 
```

# vb.net - 更新时单独表单上的进度条冻结/崩溃

> ID：10559359
> 
> 赞同：1
> 
> 时间：2012-05-11T22:22:39.580
> 
> 标签：vb.net, winforms, progress-bar, invokerequired

我有一个奇怪的异常，我似乎无法调试。对于任何要建议工作线程的人，我都被禁止在工作中使用它们......我问自己为什么不这样做，并收到一个模糊的答案和明确的指示来避免它......无论如何......

我决定我想在一个单独的表单上有一个进度条，该表单被初始化并直接从我的库类中显示（独立于主表单并在不同的线程上执行）。即使此类初始化表单本身，我仍然使用 control.InvokeRequired 和 control.Invoke，因此我可以在其他地方重用该表单。以下是用于初始化进度条：

```
Public Sub InitializePB(ByVal _Maximum As Integer, ByVal _Step As Integer, ByVal _StartValue As Integer, ByVal _Style As Windows.Forms.ProgressBarStyle)
    If Me.InvokeRequired Then
        'Different thread - invoke delegate
        pb_Progress.Invoke(Sub() InitializePB(_Maximum, _Step, _StartValue, _Style))
    Else
        'Same thread - set values
        pb_Progress.Minimum = 1
        pb_Progress.Maximum = _Maximum
        pb_Progress.Step = _Step
        pb_Progress.Value = _StartValue
        pb_Progress.Style = _Style
        Me.Refresh()
    End If
End Sub 
```

现在对于阶跃函数：

```
 Public Sub PerformStepPB()
    If Me.InvokeRequired Then
        'Different thread - invoke delegate
        pb_Progress.Invoke(Sub() PerformStepPB())
    Else
        'Same thread - perform step
        pb_Progress.PerformStep()
        Me.Refresh()
    End If
End Sub 
```

现在以下是我启动包含进度条的表单然后发送步骤调用的测试代码：

```
 pbForm = New frmProgress(_OwnerDesktopLoc)
        pbForm.Show()

        pbForm.InitializePB(100, 1, 1, Windows.Forms.ProgressBarStyle.Blocks)

        Dim msElapsedVals As Integer = 0

        While msElapsedVals <= 100
            pbForm.PerformStepPB()
            Thread.Sleep(100)
            msElapsedVals += 1
        End While
        pbForm.Close()
        pbForm.Dispose()
        While Not pbForm.IsDisposed
            Thread.Sleep(100)
        End While

        Exit Sub 
```

到目前为止一切顺利......您会注意到，每次调用 step 方法时，我都会为进度条表单调用 Form.Refresh 方法。我最终这样做了，因为当表单启动时，它会在几个进度条步骤后崩溃。在这个时间点，表单确实显示而没有崩溃（因为刷新），除非我单击它崩溃的表单（并且 Visual Studio 没有捕获到异常）。奇怪的是，库类中用于更新进度条的代码继续没有任何问题，就好像问题只是与 Win32 窗口有关。这是与崩溃相关的 Windows 消息：

**描述：一个问题导致该程序停止与 Windows 交互。问题签名：问题事件名称：AppHangB1 应用程序名称：DL_RDS_Sort.vshost.exe**

我尝试从主表单线程启动表单，但结果相同。我不知道发生了什么......任何帮助将不胜感激=D

更新事物的确切调用方式：

从 MainForm 开始，线程以库类中定义的子例程的地址开始：

```
 Private Sub but_Sort_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles but_Sort.Click

    Me.Sorter.OwnerDesktopLoc = New Drawing.Point(Me.DesktopLocation.X + CInt(Me.DesktopBounds.Width / 6), Me.DesktopLocation.Y + CInt(Me.DesktopBounds.Height / 2))

    'Start sorting thread
    Me.sortThread = New Threading.Thread(AddressOf Me.Sorter.Sort)
    Me.sortThread.Start() 
```

然后在这个线程的例程中，我正在测试表单的初始化并调用我为更新性能栏属性而编写的方法（如前所示）：

```
 Public Sub Sort()
    Try
        IIf(_OwnerDesktopLoc = Nothing, useProgressBar = False, useProgressBar = True)

        'TESTING//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        pbForm = New frmProgress(_OwnerDesktopLoc)
        pbForm.Show()

        pbForm.InitializePB(100, 1, 1, Windows.Forms.ProgressBarStyle.Blocks)

        Dim msElapsedVals As Integer = 0

        While msElapsedVals <= 100
            pbForm.PerformStepPB()
            Thread.Sleep(100)
            msElapsedVals += 1
        End While
        pbForm.Close()
        pbForm.Dispose()
        While Not pbForm.IsDisposed
            Thread.Sleep(100)
        End While

        Exit Sub
        'TESTING////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 
```

请注意，测试区域后面还有更多代码，但它从未被调用，并且不会在此问题中发挥作用，因为我退出了子例程。我通常使用 ShowDialog 但这会停止执行，这不是我想要的。

一些值得一提的事情： -frmProgress 将 ControlBox 属性设置为 false。-frmProgress 的 FormBorderStyle 设置为 FixedDialog

另外：当我使用 Show() 方法时，当我将鼠标悬停在显示的表单上时，会出现 Windows“忙圈”光标。ShowDialog() 没有这种行为......好像表单正在等待什么......希望这能澄清我的问题。

# android - android中的可扩展列表视图中的错误

> ID：10559364
> 
> 赞同：1
> 
> 时间：2012-05-11T22:23:20.760
> 
> 标签：android, expandablelistview

我是 android 新手，我想根据这段代码制作一个可扩展的列表：

```
public class ListexpActivity extends ExpandableListActivity {

    ExpandableListView  epView;

    @Override
    public void onCreate( Bundle savedInstanceState ) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        ExpandableListAdapter mAdapter;
        epView = (ExpandableListView) findViewById(R.id.expandablelistview01);
        mAdapter = new MyExpandableListAdapter();
        epView.setAdapter(mAdapter);
        epView.setOnGroupClickListener(new OnGroupClickListener() {
            @Override
            public boolean onGroupClick( ExpandableListView arg0, View arg1, int groupPosition, long arg3 ) {
                if (groupPosition == 5) {
                }
                return false;
            }
        });

        epView.setOnChildClickListener(new ExpandableListView.OnChildClickListener() {
            @Override
            public boolean onChildClick( ExpandableListView parent, View v, int groupPosition, int childPosition, long id ) {
                if (groupPosition == 0 && childPosition == 0) {
                }
                return false;
            }
        });

    }

    class MyExpandableListAdapter extends BaseExpandableListAdapter {
        // Sample data set. children[i] contains the children (String[]) for
        // groups[i].
        private String[]    groups      = { "Parent1", "Parent2", "Parent3" };
        private String[][]  children    = { { "Child1" }, { "Child2" }, { "Child3" }, { "Child4" }, { "Child5" } };

        public Object getChild( int groupPosition, int childPosition ) {
            return children[groupPosition][childPosition];
        }

        public long getChildId( int groupPosition, int childPosition ) {
            return childPosition;
        }

        public int getChildrenCount( int groupPosition ) {
            int i = 0;
            try {
                i = children[groupPosition].length;

            } catch (Exception e) {
            }

            return i;
        }

        public TextView getGenericView() {
            // Layout parameters for the ExpandableListView
            AbsListView.LayoutParams lp = new AbsListView.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, 64);

            TextView textView = new TextView(ListexpActivity.this);
            textView.setLayoutParams(lp);
            // Center the text vertically
            textView.setGravity(Gravity.CENTER_VERTICAL | Gravity.LEFT);
            // textView.setTextColor(R.color.marcyred);
            // Set the text starting position
            textView.setPadding(36, 0, 0, 0);
            return textView;
        }

        public View getChildView( int groupPosition, int childPosition, boolean isLastChild, View convertView, ViewGroup parent ) {
            TextView textView = getGenericView();
            textView.setText(getChild(groupPosition, childPosition).toString());
            return textView;
        }

        public Object getGroup( int groupPosition ) {
            return groups[groupPosition];
        }

        public int getGroupCount() {
            return groups.length;
        }

        public long getGroupId( int groupPosition ) {
            return groupPosition;
        }

        public View getGroupView( int groupPosition, boolean isExpanded, View convertView, ViewGroup parent ) {
            TextView textView = getGenericView();
            textView.setText(getGroup(groupPosition).toString());
            return textView;
        }

        public boolean isChildSelectable( int groupPosition, int childPosition ) {

            return true;
        }

        public boolean hasStableIds() {
            return true;
        }
    }
} 
```

并在 xml 文件中

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/hello" />

    <ExpandableListView
        android:id="@+id/expandablelistview01"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ExpandableListView>

</LinearLayout> 
```

但是当在模拟器中实现程序时，错误是

```
 05-11 14:38:24.507: E/AndroidRuntime(332): FATAL EXCEPTION: main
    05-11 14:38:24.507: E/AndroidRuntime(332): java.lang.RuntimeException: Unable to start activity ComponentInfo{ola.listexp.Main/ola.listexp.Main.ListexpActivity}: java.lang.RuntimeException: Your content must have a ExpandableListView whose id attribute is 'android.R.id.list'
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.os.Handler.dispatchMessage(Handler.java:99)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.os.Looper.loop(Looper.java:123)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.app.ActivityThread.main(ActivityThread.java:4627)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at java.lang.reflect.Method.invokeNative(Native Method)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at java.lang.reflect.Method.invoke(Method.java:521)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at dalvik.system.NativeStart.main(Native Method)
    05-11 14:38:24.507: E/AndroidRuntime(332): Caused by: java.lang.RuntimeException: Your content must have a ExpandableListView whose id attribute is 'android.R.id.list'
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.app.ExpandableListActivity.onContentChanged(ExpandableListActivity.java:222)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:201)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.app.Activity.setContentView(Activity.java:1647)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at ola.listexp.Main.ListexpActivity.onCreate(ListexpActivity.java:31)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
    05-11 14:38:24.507: E/AndroidRuntime(332):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627) 
```

我是从互联网上来的，我应该`@+id/expandablelistview01`改成`@android/idexpandablelistview01`

```
but i have another error in 

    NOTE: This project contains resource errors, so aapt did not succeed, which can cause rendering failures. Fix resource problems first.

Unable to resolve id "@andriod:id/expandablelistview01" for attribute "id"` 
```

所以帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:30:12.387

确实有错误与您的扩展列表的 id 有关。从您的错误代码中有以下行：

```
Caused by: java.lang.RuntimeException: Your content must have a ExpandableListView whose id attribute is 'android.R.id.list' 
```

它告诉您的是，在您的 XML 文件中，与列表关联的 ID 必须是 @android:id/list

那应该可以解决问题:)

# c# - 将多个字典组合成一个字典

> ID：10559367
> 
> 赞同：32
> 
> 时间：2012-05-11T22:23:50.860
> 
> 标签：c#

> **可能重复：**
> [在 C# 中合并字典](https://stackoverflow.com/questions/294138/merging-dictionaries-in-c-sharp)

字典 1

> “a”、“1”
> 、“b”、“2”

字典 2

> “c”、“3”
> 、“d”、“4”

字典 3

> “e”、“5”
> 、“f”、“6”

组合字典

> “a”、“1”、
> “b”、“2”、
> “c”、“3”、
> “d”、“4”
> 、“e”、“5”
> 、“f”、“6”

如何将上述 3 个字典组合成一个组合字典？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2012-05-11T22:31:23.653

```
var d1 = new Dictionary<string, int>();
var d2 = new Dictionary<string, int>();
var d3 = new Dictionary<string, int>();

var result = d1.Union(d2).Union(d3).ToDictionary (k => k.Key, v => v.Value); 
```

**编辑**
为了确保没有重复的键使用：

```
var result = d1.Concat(d2).Concat(d3).GroupBy(d => d.Key)
             .ToDictionary (d => d.Key, d => d.First().Value); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-11T22:27:51.677

只需遍历它们：

```
var result = new Dictionary<string, string>();

foreach (var dict in dictionariesToCombine) {
    foreach (var item in dict) {
        result.Add(item.Key, item.Value);
    }
} 
```

（假设你`dictionariesToCombine`的一些`IEnumerable`字典要组合，比如一个数组。）

# android - 如何在 ICS 中设置系统范围的代理

> ID：10559370
> 
> 赞同：3
> 
> 时间：2012-05-11T22:24:14.113
> 
> 标签：android, networking, properties, proxy, wifi

对于 Android 3.x 及之前的版本，您可以调出一个名为 com.android.settings.ProxySelector 的隐藏 UI。它在 Settings.Secure.HTTP_PROXY 中设置并由移动网络使用（WiFi 网络并不总是有效）。但是对于 ICS，我仍然可以调出这个隐藏的 UI，但它似乎不再设置代理了。当我单击“完成”时，我检查 Settings.Secure.HTTP_PROXY 或系统属性 http.proxyHost，两者均未设置。

那么在 ICS 中是否有一种方法可以让我设置全局代理，就像我以前使用 com.android.settings.ProxySelector UI 所做的一样？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T08:34:45.847

不幸的是，隐藏的活动“com.android.settings.ProxySelector”不是为设置 Wi-Fi 网络代理而设计的。事实上，您可以使用此活动设置全局代理，但对于标准应用程序，您不会看到更改。

例如，默认浏览器仅对**MOBILE网络使用此设置，而对****Wi-Fi**网络完全忽略它。

当然，您可以使用此[库](https://github.com/shouldit/android-proxy-library)读取您的个人应用程序中的设置，但您不能指望其他应用程序也会这样做:(

如果一切都清楚，请告诉我。无论如何，我试图在[这里](http://www.android-proxy.com/)解决问题，因此您可以找到有关此主题的更多资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T23:10:43.827

如果设备已植根。您可以编辑 Iptable

# android - 等垂直间距按钮

> ID：10559371
> 
> 赞同：0
> 
> 时间：2012-05-11T22:24:17.077
> 
> 标签：android, android-linearlayout

例如，它们之间有相同的空间，而不是调整它们的大小。

例如：top-20dp-button-20dp-button-20dp（20是一个例子，我不想用dp）

我试过这个没有运气：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:visibility="visible" android:weightSum="3">

    <Button
        android:id="@+id/button1"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:gravity="center_vertical|center_horizontal"
        android:text="Button" android:layout_weight="1"/>

    <Button
        android:id="@+id/button2"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:gravity="center_vertical|center_horizontal"
        android:text="Button" android:layout_weight="1"/>

    <Button
        android:id="@+id/button3"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:gravity="center_vertical|center_horizontal"
        android:text="Button" android:layout_weight="1"/>

</LinearLayout> 
```

感谢您的帮助 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:22:21.080

您可以通过使用其自己的线性布局围绕每个按钮，然后将新线性布局上的权重设置为每个按钮来实现您寻找的效果。从那里你只需要调整按钮来指定 layout_gravity 而不仅仅是重力（layout_gravity 将视图与它的父级一起定位，重力在视图中定位元素）

代码看起来像这样

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:visibility="visible"
    android:weightSum="3" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="1" >

        <Button
            android:id="@+id/button1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical|center_horizontal"
            android:text="Button" />
    </LinearLayout>

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="1" >

        <Button
            android:id="@+id/button2"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical|center_horizontal"
            android:text="Button" />
    </LinearLayout>

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="1" >

        <Button
            android:id="@+id/button3"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical|center_horizontal"
            android:text="Button" />
    </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T10:04:43.507

感谢 Kostya，这是一个答案 :)

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical">
    <View
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"/>
<Button
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="button 1"/>

<View
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"/>

<Button
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="button 2"/>

<View
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"/>

<Button
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="button 3"/>
<View
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"/> 
</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T22:30:34.617

你的问题**很难**理解，我知道你的英语不流利，但你需要更具体。发布您想要的设计图像。我会再**猜测一下**，也许这就是您要描述的内容：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"  
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:visibility="visible">

    <Button
        android:id="@+id/button1"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="20dp"
        android:text="Button 1"
        />

    <Button
        android:id="@+id/button2"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="20dp"
        android:text="Button 2"
        />

    <Button
        android:id="@+id/button3"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="20dp"
        android:text="Button 3" 
        />

</LinearLayout> 
```

我基于您提供的唯一描述：

> 例如：top-20dp-button-20dp-button-20dp

再次，您可以使用 dp、sp 或**任何**您想要的东西；了解 dp 代表与密度无关的像素。再次[支持多屏幕](http://developer.android.com/guide/practices/screens_support.html)和[更多资源类型](http://developer.android.com/guide/topics/resources/more-resources.html#Dimension)描述得很好，你会看到 dp 是相对的。它还描述了 dp 或 dip 之间的区别，它**不是**dpi。

另请注意，我将填充建议更改为调整边距，我第一次错了，但问题如此模糊，这只是一个猜测。我希望这会有所帮助，否则请张贴您希望实现的清晰图片。祝你好运！

# javascript - jQuery 在除 ONE 之外的所有页面上做它应该做的事情

> ID：10559377
> 
> 赞同：-3
> 
> 时间：2012-05-11T22:25:58.463
> 
> 标签：javascript, jquery, html, css

这是我的脚本：http: [//jsfiddle.net/9cnGC/11/](http://jsfiddle.net/9cnGC/11/)

```
<div id="callus">
<div class="def">111-1111</div>
<div class="num1">222-2222</div>
<div class="num2">333-3333</div>
<div class="num3">444-4444</div>
<div class="num4">555-5555</div>
<div class="numnames numname1">location 1</div>
<div class="numnames numname2">location 2</div>
<div class="numnames numname3">location 3</div>
<div class="numnames numname4">location 4</div>
</div>

$(function() {
    $(document).ready(function() {
        $('.numnames').hover(function() {
            $(".def").toggle();
        });

        $('.num1').hide();
        $('.numname1').hover(function() {
            $('.num1').toggle();
            return false;
        });
        $('.num2').hide();
        $('.numname2').hover(function() {
            $('.num2').toggle();
            return false;
        });
        $('.num3').hide();
        $('.numname3').hover(function() {
            $('.num3').toggle();
            return false;
        });
        $('.num4').hide();
        $('.numname4').hover(function() {
            $('.num4').toggle();
            return false;
        });
    });

}); 
```

我想知道是否有人可以帮助我解决这个问题，也许可以稍微清理一下，以便它可以更有效地运行？

我相信这是因为页面上运行了另一个 jQuery 实例。这里的脚本搞砸了，但我不确定它有什么问题。

这是显示逻辑混乱的页面。[http://ben.chmark.com/mdcp/index.php/prescriptions/transfer-prescription](http://ben.chmark.com/mdcp/index.php/prescriptions/transfer-prescription)

有一个右上角的模块（给我们打电话）。任何时候都应该只显示一个电话号码。它以我上面提供的 jsfiddle 为模型。它在除此之外的所有其他页面上运行良好。我很难过:(

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:35:12.810

从弄乱 Fiddle 链接来看，它看起来像是 1.4 以下的 jQuery 版本的问题。

试试看这里：[我可以在同一页面上使用多个版本的 jQuery 吗？](https://stackoverflow.com/questions/1566595/can-i-use-multiple-versions-of-jquery-on-the-same-page)

noConflict() 可能是您正在寻找的：[http ://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

```
<!-- load jQuery 1.1.3 -->
<script type="text/javascript" src="http://example.com/jquery-1.1.3.js"></script>
<script type="text/javascript">
var jQuery_1_1_3 = $.noConflict(true);
</script>

<!-- load jQuery 1.3.2 -->
<script type="text/javascript" src="http://example.com/jquery-1.3.2.js"></script>
<script type="text/javascript">
var jQuery_1_3_2 = $.noConflict(true);
</script> 
```

# dynamics-crm - Microsoft Dynamics CRM 2011 E-mail Router SchedulingPeriod 以毫秒为单位？

> ID：10559385
> 
> 赞同：2
> 
> 时间：2012-05-11T22:27:14.647
> 
> 标签：dynamics-crm, dynamics-crm-2011, crm

我试图通过编辑 Microsoft.Crm.Tools.EmailAgent.xml 文件来加快 CRM 2011 中发送的电子邮件。我正在修改 SchedulingPeriod 元素，但我不确定间隔设置是以秒还是毫秒为单位。

Microsoft 的 CRM 4.0 文档指出“配置文件中的所有时间间隔都以毫秒为单位指定”。[http://msdn.microsoft.com/en-us/library/cc906241.aspx](http://msdn.microsoft.com/en-us/library/cc906241.aspx)

Microsoft Dynamics CRM 2011 Unleashed Book 指出“外发电子邮件是异步处理的，默认轮询安排为每 1,000 秒（约 15 分钟），因此您必须等待该时间才能真正发送电子邮件。” </p>

**提示：**要提高外发电子邮件的发送速度，您可以编辑配置文件 Microsoft.Crm.Tools.EmailAgent.xml（通常位于 C:\Program Files\Microsoft CRM Email\Service）并找到SchedulingPeriod 元素。我们建议将其默认值更改为 10 秒。

**问题 1：**在 CRM 2011 中，SchedulingPeriod 是以毫秒还是秒为单位指定的？

**问题 2：**在 CRM 2011 中，默认的 SchedulingPeriod (1,000) = 1 秒还是 15 分钟？

Microsoft Dynamics CRM 2011 Unleashed 书中提到通过将默认值更改为 10 秒来加速外发电子邮件。
**问题 3：**在 CRM 2011 中，将 SchedulingPeriod 更改为 (10) = 10 秒还是 10 毫秒？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T00:32:27.993

it is in seconds, 1000 seconds == 16 minutes 35 seconds, there should also be a setting for number of threads just above this in the file that you can increase to improve performance.

Like everything CRM though test it first as your setup might behave differently to mine, speeding this up might just move your bottleneck elsewhere - usually the UI if you havent put it on another server. also concider if you are using Virtual Servers and they are on the same physical hardware making one work more can slow the others if they aren't balenced correctly.

# wxpython - wxPython：将 Checkbox 作为 TreeCtrl 的项目

> ID：10559386
> 
> 赞同：4
> 
> 时间：2012-05-11T22:27:17.277
> 
> 标签：wxpython

我正在阅读字典并在 wx.TreeCtrl 结构上显示它的项目，它很好。我尝试插入复选框而不是字符串作为每个项目，但这是不允许的。如何将复选框添加为 TreeCtrl 的项目？我希望能够选择单个项目或完整的子树。这是一个非常常见的场景。谁能指导我如何在 wxpython 中实现这一目标？

# file - 如何将计时器添加到批处理文件？

> ID：10559387
> 
> 赞同：2
> 
> 时间：2012-05-11T22:27:17.893
> 
> 标签：file, batch-file, timer

我想制作一个等待几分钟，然后执行命令的批处理文件。我该怎么做？具体来说，我希望它在打开文件后 3 分钟内结束另一个程序。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T22:47:15.560

使用`timeout`. 这将让您等待其`/t`参数中给出的几秒钟。 `timeout /t 180`将休眠 3 分钟（180 秒）。

```
TIMEOUT [/T] timeout [/NOBREAK]

Description:
    This utility accepts a timeout parameter to wait for the specified
    time period (in seconds) or until any key is pressed. It also
    accepts a parameter to ignore the key press.

Parameter List:
    /T        timeout       Specifies the number of seconds to wait.
                            Valid range is -1 to 99999 seconds.

    /NOBREAK                Ignore key presses and wait specified time.

    /?                      Displays this help message.

NOTE: A timeout value of -1 means to wait indefinitely for a key press.

Examples:
    TIMEOUT /?
    TIMEOUT /T 10
    TIMEOUT /T 300 /NOBREAK
    TIMEOUT /T -1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T22:37:50.500

另一种方法是在一定时间内 ping 无效 IP 地址：

```
PING 1.1.1.1 -n 1 -w 60000 >NUL 
```

60000 = 毫秒

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-01T15:11:18.330

嗨，我喜欢 stockoverflow，但有时答案太简洁了......所以这里比你要求的要多......计时器和许多其他片段

```
@ECHO off
MODE CON:COLS=25 LINES=11
cls
color 0B
:taskkill
echo.
echo    Program To Shutdown
echo.
set /p taskkill=                               
if "%taskkill%" == "%taskkill%" goto taskkillconfirm
exit
:taskkillconfirm
color 0B
:image
set image=/im
if "%image%" == "%image%" goto imageconfirm
exit
:imageconfirm
color 0B
:forced
set forced=/f
if "%forced%" == "%forced%" goto forcedconfirm
exit
:forcedconfirm
cls
:hour
color 0B
echo.
echo.                                  Hours?
echo.
set /p hour=                                     
:min
color 0B
cls
echo.
echo                                   Minutes?
echo.
set /p min=                                     
:sec
color 0B
cls
echo.
echo                                   Seconds?
echo.
set /p sec=                                     
:continue
color 0B
cls                                                             
echo                             %taskkill%  
echo                             Program Shutdown in                                                             
echo   %hour%   Hours
echo   %min%  Minutes  
echo   %sec%  Seconds
set /a sec="%sec%-1"
if %sec%==-1 set /a min="%min%-1"
if %sec%==-1 set /a sec="59"
if %min%==-1 set /a hour="%hour%-1"
if %min%==-1 set /a min="59"
if %hour%==-1 goto done
ping -n 2 127.0.0.1 >NUL
goto continue
:done
color 0B
cls
taskkill %image% %taskkill% %forced%
exit 
```

希望你真的喜欢这个答案

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-27T23:39:52.110

很简单，试试这个

```
@echo off
echo Do you want to read word file or pdf file? Hit any key for options...
pause >nul
echo w for word
echo p for pdf
::set input =
set /p input = Choose your option
if %input% == w goto w
if %input% == p goto p
:w
echo Reading Word file...
::start /your/path/to/your/Office/winword.exe          
/path/to/your/doc/file/filename.doc
echo Timer starts
pause >nul
echo 10
ping localhost -n 2 >nul
cls
echo 9
ping localhost -n 2 >nul
cls
echo 8
ping localhost -n 2 >nul
cls
echo 7
ping localhost -n 2 >nul
cls
echo 6
ping localhost -n 2 >nul
cls
echo 5
ping localhost -n 2 >nul
cls
echo 4
ping localhost -n 2 >nul
cls
echo 3
ping localhost -n 2 >nul
cls
echo 2
ping localhost -n 2 >nul
cls
echo 1
ping localhost -n 2 >nul
cls
echo Time's up. Starting the next document...
::you can copy/paste the above commands to start another word file
:p
echo Reading Pdf file...
echo Timer starts
::start /your/path/to/your/Acrobat/acrord32.exe    
/path/to/your/pdf/file/filename.pdf
pause >nul
echo 10
ping localhost -n 2 >nul
cls
echo 9
ping localhost -n 2 >nul
cls
echo 8
ping localhost -n 2 >nul
cls
echo 7
ping localhost -n 2 >nul
cls
echo 6
ping localhost -n 2 >nul
cls
echo 5
ping localhost -n 2 >nul
cls
echo 4
ping localhost -n 2 >nul
cls
echo 3
ping localhost -n 2 >nul
cls
echo 2
ping localhost -n 2 >nul
cls
echo 1
ping localhost -n 2 >nul
cls
echo Times up. Starting the next document...
::you can copy/paste the above commands to start another Pdf file 
```

# python - 为什么用指数更快地在 python 中取模数？

> ID：10559392
> 
> 赞同：13
> 
> 时间：2012-05-11T22:27:54.697
> 
> 标签：python, optimization, profiling

我正在尝试优化我正在修改的程序，当我注意到 do`value = i % 65536`似乎比 do 运行得更慢时`value = i % (2**16)`。

为了测试这一点，我运行了以下程序：

```
import cProfile
import pstats

AMOUNT = 100000000

def test1():
    for i in xrange(AMOUNT):
        value = i % 65536
    return

def test2():
    for i in xrange(AMOUNT):
        value = i % (256**2)
    return

def test3():
    for i in xrange(AMOUNT):
        value = i % (16**4)
    return

def test4():
    for i in xrange(AMOUNT):
        value = i % (4**8)
    return

def test5():
    for i in xrange(AMOUNT):
        value = i % (2**16)
    return

def run_tests():
    test1()
    test2()
    test3()
    test4()
    test5()
    return

if __name__ == '__main__':
    cProfile.run('run_tests()', 'results')
    stats = pstats.Stats('results')
    stats.sort_stats('calls', 'nfl')
    stats.print_stats() 
```

...产生以下输出：

```
Fri May 11 15:11:59 2012    results

         8 function calls in 40.473 seconds

   Ordered by: call count, name/file/line

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000   40.473   40.473 <string>:1(<module>)
        1    0.000    0.000   40.473   40.473 test.py:31(run_tests)
        1   10.466   10.466   10.466   10.466 test.py:6(test1)
        1    7.475    7.475    7.475    7.475 test.py:11(test2)
        1    7.485    7.485    7.485    7.485 test.py:16(test3)
        1    7.539    7.539    7.539    7.539 test.py:21(test4)
        1    7.508    7.508    7.508    7.508 test.py:26(test5) 
```

using`65536`最慢，为 10.466 秒，而 doing`256**2`最快，为 7.475 秒（其他可能的指数值介于两者之间）。诚然，这种速度差异只有在大量重复的情况下才会明显，但我仍然很好奇为什么会发生这种情况。

为什么取模数`65536`比使用指数取模要慢？它们应该评估为相同的数字，我原以为 python 解释器在使用 mod 之前需要更长的时间来完全评估指数。

通过扩展，在python表达式中使用2的幂而不是完全输入数字通常更有效吗？这种模式是否适用于除模数以外的运算或除 以外的其他数字`2`吗？

（顺便说一句，我使用的是 Python 2.7.2（32 位），并且我在 64 位 Windows 7 笔记本电脑上运行了上述程序）。

**编辑：**
所以我尝试颠倒我调用的函数的顺序，现在正好相反。看起来`run_tests`在使用 cProfile 时，无论第一个函数是什么，运行速度总是会慢一些，这很*奇怪*。所以，吸取教训，我猜——分析器很奇怪：D

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-11T22:32:43.250

生成的字节码没有区别，因为编译器很好地完成了它的工作并优化了常量算术表达式。这意味着您的测试结果只是一个巧合（尝试以不同的顺序计时功能！）。

```
>>> import dis
>>> dis.dis(test1)
  2           0 SETUP_LOOP              30 (to 33)
              3 LOAD_GLOBAL              0 (xrange)
              6 LOAD_GLOBAL              1 (AMOUNT)
              9 CALL_FUNCTION            1
             12 GET_ITER            
        >>   13 FOR_ITER                16 (to 32)
             16 STORE_FAST               0 (i)

  3          19 LOAD_FAST                0 (i)
             22 LOAD_CONST               1 (65536)
             25 BINARY_MODULO       
             26 STORE_FAST               1 (value)
             29 JUMP_ABSOLUTE           13
        >>   32 POP_BLOCK           

  4     >>   33 LOAD_CONST               0 (None)
             36 RETURN_VALUE        
>>> dis.dis(test5)
  2           0 SETUP_LOOP              30 (to 33)
              3 LOAD_GLOBAL              0 (xrange)
              6 LOAD_GLOBAL              1 (AMOUNT)
              9 CALL_FUNCTION            1
             12 GET_ITER            
        >>   13 FOR_ITER                16 (to 32)
             16 STORE_FAST               0 (i)

  3          19 LOAD_FAST                0 (i)
             22 LOAD_CONST               3 (65536)
             25 BINARY_MODULO       
             26 STORE_FAST               1 (value)
             29 JUMP_ABSOLUTE           13
        >>   32 POP_BLOCK           

  4     >>   33 LOAD_CONST               0 (None)
             36 RETURN_VALUE 
```

（实际上存在差异：数字存储在常量表中的不同偏移量处。不过，我无法想象这会导致任何差异）。

为了完整起见，这是使用该`timeit`模块的正确测试：

```
import timeit

setup = "i = 1337"

best1 = best2 = float("inf")
for _ in range(5000):
  best1 = min(best1, timeit.timeit("i % 65536", setup=setup, number=10000))
for _ in range(5000):
  best2 = min(best2, timeit.timeit("i % (2**16)", setup=setup, number=10000))
print best1
print best2 
```

请注意，我正在测量所需的*最短*时间，而不是平均值。如果由于某种原因需要更长的时间，这只是意味着它被更频繁地中断（因为代码不依赖于任何东西，只依赖于你的 CPU 的能力）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-11T22:39:27.717

嗯，使用[dis](http://docs.python.org/library/dis.html)显示 python 字节代码表明功能是相同的。Python 已经优化了常量（如预期的那样）。所以我怀疑时差是缓存效应。我的笔记本电脑上的时间证明了这一点（在 Linux 上使用 Python 2.7.3 64 位）

```
Fri May 11 23:37:49 2012    results

     8 function calls in 38.825 seconds

Ordered by: call count, name/file/line

ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     1    0.000    0.000   38.825   38.825 <string>:1(<module>)
     1    0.000    0.000   38.825   38.825 z.py:31(run_tests)
     1    7.880    7.880    7.880    7.880 z.py:6(test1)
     1    7.658    7.658    7.658    7.658 z.py:11(test2)
     1    7.806    7.806    7.806    7.806 z.py:16(test3)
     1    7.784    7.784    7.784    7.784 z.py:21(test4)
     1    7.697    7.697    7.697    7.697 z.py:26(test5) 
```

几乎完全相同

```
>>> from dis import dis
>>> def test1():
...     for i in xrange(AMOUNT):
...         value = i % 65536
...     return
... 
>>> def test5():
...     for i in xrange(AMOUNT):
...         value = i % (2**16)
...     return
... 
>>> dis(test1)
  2           0 SETUP_LOOP              30 (to 33)
              3 LOAD_GLOBAL              0 (xrange)
              6 LOAD_GLOBAL              1 (AMOUNT)
              9 CALL_FUNCTION            1
             12 GET_ITER            
        >>   13 FOR_ITER                16 (to 32)
             16 STORE_FAST               0 (i)

  3          19 LOAD_FAST                0 (i)
             22 LOAD_CONST               1 (65536)
             25 BINARY_MODULO       
             26 STORE_FAST               1 (value)
             29 JUMP_ABSOLUTE           13
        >>   32 POP_BLOCK           

  4     >>   33 LOAD_CONST               0 (None)
             36 RETURN_VALUE        
>>> dis(test5)
  2           0 SETUP_LOOP              30 (to 33)
              3 LOAD_GLOBAL              0 (xrange)
              6 LOAD_GLOBAL              1 (AMOUNT)
              9 CALL_FUNCTION            1
             12 GET_ITER            
        >>   13 FOR_ITER                16 (to 32)
             16 STORE_FAST               0 (i)

  3          19 LOAD_FAST                0 (i)
             22 LOAD_CONST               3 (65536)
             25 BINARY_MODULO       
             26 STORE_FAST               1 (value)
             29 JUMP_ABSOLUTE           13
        >>   32 POP_BLOCK           

  4     >>   33 LOAD_CONST               0 (None)
             36 RETURN_VALUE        
>>> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-11T22:40:32.333

您只运行了每个测试一次。你的 CPU 的速度并不总是一样的，在测试开始时它很可能处于休眠状态，这就是第一次测试较慢的原因。要对一小部分代码（如 mod）进行基准测试，请使用 timeit 模块：

```
>>> timeit.timeit('for i in range(10000): i % 65536', number=1000)
0.8686108589172363
>>> timeit.timeit('for i in range(10000): i % 256**2', number=1000)
0.862062931060791
>>> timeit.timeit('for i in range(10000): i % 4**8', number=1000)
0.8644928932189941
>>> timeit.timeit('for i in range(10000): i % 2**16', number=1000)
0.8643178939819336
>>> timeit.timeit('for i in range(10000): i % 65536', number=1000)
0.8640358448028564 
```

您可以看到平均值始终在 0.864 左右。

# hadoop - 虚拟机上的hadoop集群

> ID：10559396
> 
> 赞同：0
> 
> 时间：2012-05-11T22:28:42.813
> 
> 标签：hadoop

我必须在我的计算机上使用 5 个带有 hadoop 的虚拟机设置一个集群。配置需要一个端口号。有人可以启发我吗？我是初学者

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T22:53:13.543

如果您的主要目标是学习 Hadoop，那么在 Windows 或 Linux 上学习它并不重要，因为这两个平台上的一切都完全相同。我在这两个平台上都广泛使用了 Hadoop，发现所有命令和处理在 Windows 和 Linux 上都是相同的。所以这里是我的建议：

1.  在您的 Windows/Linux 机器上下载 VMware VMPlayer
2.  下载适用于 VMware 的 CDH 虚拟机

    [https://ccp.cloudera.com/display/SUPPORT/Downloads](https://ccp.cloudera.com/display/SUPPORT/Downloads)

访问您的 Windows/Linux 机器中的虚拟机，并完全按照它们在 Linux 上的教程进行操作。

此处共享相同的信息：

[Windows 上的 Hadoop](https://stackoverflow.com/questions/10310736/hadoop-on-windows/10310828#10310828)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T04:05:02.933

由您选择端口。通常人们使用hadoop提供的默认端口。对于默认端口，请参阅[此](http://www.cloudera.com/blog/2009/08/hadoop-default-ports-quick-reference/)。如果您使用这些端口，绝对不会有任何危害（除非您在这些端口上运行了其他东西）。

# ruby-on-rails - 改进使用 Ruby 'map' 和 'splat' 转换数组的代码

> ID：10559400
> 
> 赞同：1
> 
> 时间：2012-05-11T22:29:17.813
> 
> 标签：ruby-on-rails, ruby, arrays, ruby-on-rails-3

我正在使用 Ruby on Rails 3.2.2，我想改进下面的*代码*，也许使用一些 Ruby on Rails 方法。

`["one", "two", "three"]`我有一个我要制作的数组

```
# From `Symbol`s to `String`s
array = [:one, :two, :three].map {|k| k.to_s}
# => ["one", "two", "three"] 
```

然后（`attr_accessible`下面使用的方法只是一个*示例*方法，仅用于说明我的工作；在生产中，我在自定义方法中使用“splat”数组）

```
attr_accessible *array
# => attr_accessible "one", "two", "three" 
```

有没有更好的方法来制作上述内容？如果是这样，我怎样才能`["one", "two", "three"]`以“优雅”的方式“转换”数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:45:48.623

在普通的 Ruby 中，你可以做

```
array = [:one, :two, :three].map(&:to_s) 
```

使用 map_by_method gem，您可以：

```
array = [:one, :two, :three].map_by_to_s 
```

如果您像这样实现自定义方法：

```
def foo(*args)
  converted_args = args.flatten.map(&:to_s)
end 
```

你可以这样称呼它

```
 foo "one", "two", "three"
 foo :one, :two, :three

 args = [:one, :two, :three]
 foo *args
 foo args # see flatten above 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T05:04:39.027

你的问题我不清楚。我不知道您是要将字符串数组转换为符号数组，还是要将符号数组转换为字符串数组？或者，也许您正在寻找比使用 splat 更好的解决方案。任何状况之下 ...

要将字符串转换为符号，请使用 to_sym。

```
["one", "two", "three"].map(&:to_sym) 
```

要将符号转换为字符串，请使用 to_s （如@Mr.Ronald 的回答所示）

```
[:one, :two, :three].map(&:to_s) 
```

# ios - CoreGraphics - 仅混合视图的*部分*

> ID：10559402
> 
> 赞同：13
> 
> 时间：2012-05-11T22:29:39.490
> 
> 标签：ios, uitableview, core-graphics

我最近看到了这篇关于使用 UITableViewCells 提高滚动性能的精彩文章：http: [//engineering.twitter.com/2012/02/simple-strategies-for-smooth-animation.html](http://engineering.twitter.com/2012/02/simple-strategies-for-smooth-animation.html) -- 虽然可以在其中找到许多很棒的技巧文章中，有一篇特别让我感兴趣：

> iPhone 4.0 版 Twitter 中的推文在微妙的纹理背景之上有一个投影。这提出了一个挑战，因为混合成本很高。**我们通过减少核心动画必须考虑的非透明区域来解决这个问题，方法是将阴影区域与单元格的内容区域分开。**

使用 iOS 模拟器，单击*Debug* - *Color Blended Layers*将显示如下内容：

![TwitterTableViewCell](../Images/831a592211a8923e856bdab038c544e3.png)

用红色标记的区域是混合的，绿色区域是不透明的。伟大的。这篇文章没有提到的是：我该如何实现这个？我的理解是 UIView 要么不透明，要么不透明。在我看来，实现这一点的唯一方法是使用子视图，但文章明确指出这是*一个幼稚的实现*：

> 相反，我们的 Tweet 单元格包含一个没有子视图的视图；一个drawRect：绘制一切。

那么我如何区分不透明的部分，以及我的单个 drawRect: 方法中不包含的部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:38:36.700

在您展示的示例中，我不相信他们通过视图显示背景。我认为他们正在模拟核心图形中的背景。换句话说，在每个单元格中，他们为背景绘制了浅灰色。然后他们绘制阴影（使用透明度），最后在顶部绘制其余的不透明内容。我可能是错的，但我不相信您可以使部分视图透明。如果是这样，我会对它非常非常感兴趣，因为我一直使用核心图形，但我避免使用圆角，因为为它混合整个视图似乎并不值得。

**更新**

在进行了更多研究并查看了 Apple 的文档之后，我不相信只有部分视图是不透明的。此外，在阅读了 Twitter 的博客文章后，我认为他们并不是在说他们这样做了。请注意，当他们说：

> 相反，我们的 Tweet 单元格包含一个没有子视图的视图；一个drawRect：绘制一切。

他们专门谈论`UILabel`和`UIImageView`。换句话说，他们不是使用那些视图，而是直接使用 Core Graphics 绘制图像。至于 UILabel，我个人使用 Core Text，因为它有更多的字体支持，但他们也可能使用更简单的东西，比如 NSString 的`drawAtPoint:withFont:`方法。但他们试图传达的主要观点是，单元格的*内容*都是一张 CG 绘图。

然后他们转移到一个新的部分：**避免混合**。在这里，他们强调要避免通过以下方式混合：

> 将阴影区域与单元格的内容区域分开。

做到这一点的唯一方法是使用不同的视图。他们可以使用两种方法，但首先请注意，单元格分隔符本身就是叠加层（由 tableView 提供）。第一种方法是在单元格内使用多个视图。第二种方法是通过将适当的视图插入 UIScrollView 来覆盖/覆盖单元格后面/上方的阴影/混合视图。鉴于他们之前关于每个单元格只有一个 view/drawRect 的声明，这可能就是他们正在做的事情。每种方法都会有其挑战，但我个人认为将单元格拆分为 3 个视图（阴影、内容、阴影）会更容易。这将使处理第一个/最后一个单元格情况变得更加容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:38:55.887

我不得不沿着这些思路猜测一些东西
[http://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_shadows/dq_shadows.html](http://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_shadows/dq_shadows.html)

```
 CGContextRef context = UIGraphicsGetCurrentContext();

UIBezierPath* path = [UIBezierPath bezierPathWithRoundedRect:self.bounds cornerRadius:10.0f];

CGContextSaveGState(context);
CGRect leftRect = CGRectZero;
CGContextClipToRect(context, leftRect );
CGContextSetBlendMode(context, kCGBlendModeNormal);
// draw shadow

//    Call the function CGContextSetShadow, passing the appropriate values.
//    Perform all the drawing to which you want to apply shadows.
CGContextSetShadowWithColor(context, CGSizeMake(1.0f, 1.0f), 10.0f, [UIColor blackColor].CGColor);
CGContextAddPath(context, path.CGPath);
CGContextDrawPath(context, kCGPathStroke);

CGContextRestoreGState(context);

CGContextSaveGState(context);
CGRect middleSection = CGRectZero;
CGContextClipToRect(context, middleSection);
CGContextSetFillColorWithColor(context, self.backgroundColor.CGColor);
CGContextFillRect(context, self.bounds);
// draw opaque
CGContextSetBlendMode(context, kCGBlendModeCopy); 

CGContextRestoreGState(context); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T18:52:43.190

我的意见是：不要让 Core Animation 使用各种[图层属性](http://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/LayerVisProps.html#//apple_ref/doc/uid/TP40006074-SW18)来绘制阴影。只需在两侧绘制一个预渲染的图像，这实际上是一个阴影。在[拉伸绘制](http://developer.apple.com/library/ios/documentation/uikit/reference/UIImage_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006890-CH3-SW50)中考虑单元格的可变高度可能会奏效。

编辑：如果背景是普通的，可以将预渲染的阴影应用到两侧而不知道它会影响视觉吸引力。

在不适用的情况下，tableview 必须缩小到没有阴影的大小。然后可以混合阴影而不需要对每个单元格进行混合，而只是“在顶部”。它真的不滚动。这仅在阴影没有任何“纹理”时才有效，否则人们会注意到它只是应用在顶部。

# c# - 如何获取谁导致 PostBack？

> ID：10559403
> 
> 赞同：4
> 
> 时间：2012-05-11T22:29:44.830
> 
> 标签：c#, asp.net, postback, webpage

在我的页面中有很多控件，我想知道谁`PostBack`在`Page_Load`事件中导致页面。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T22:31:03.110

为此，您可以尝试

```
string ctr = Page.Request.Params.Get("__EVENTTARGET"); 
```

这里`ctr`将包含您的控件的`ID`.

`__EVENTTARGET`携带信息谁导致页面`PostBack`

您还可以使用`__EVENTARGUMENT`此控件获取参数传递。

```
Page.Request.Params.Get("__EVENTARGUMENT") 
```

# objective-c - 在命令行上运行 iOS 单元测试的问题 (OCUnit + OCMock)

> ID：10559404
> 
> 赞同：5
> 
> 时间：2012-05-11T22:29:50.513
> 
> 标签：objective-c, unit-testing, ocunit, ocmock

我正在尝试让单元测试在 CI (Jenkins) 中运行。我在网上看到[了这篇文章](http://longweekendmobile.com/2011/04/17/xcode4-running-application-tests-from-the-command-line-in-ios/)，其中有一些技巧可以让测试在命令行中运行。我在一个具有单元测试默认设置的空项目上进行了尝试，并且那里的说明工作得很好，但是当我尝试在具有单元测试设置的现有项目上执行此操作时，我遇到了一个模棱两可的错误：

```
/bin/sh -c /Users/jzhwu/smule/magicpiano/build/MagicPiano.build/Debug-iphonesimulator/MagicPianoTest.build/Script-7C0B24BE155310BE001AC942.sh
/Applications/Xcode.app/Contents/Developer/Tools/RunPlatformUnitTests.include:266: note: Started tests for architectures 'i386'
Run unit tests for architecture 'i386' (GC OFF)
/Applications/Xcode.app/Contents/Developer/Tools/RunPlatformUnitTests.include:273: note: Running tests for architecture 'i386' (GC OFF)
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
UIPasteboard - failed to launch pasteboardd. Make sure it's installed in UIKit.framework/Support
2012-05-11 15:10:39:247 MP-Debug[24398:17003] loading model magic
2012-05-11 15:10:39:250 MP-Debug[24398:17003] loading model magic-analytics
2012-05-11 15:10:39.264 MP-Debug[24398:17003] Unresolved error Error Domain=NSCocoaErrorDomain Code=512 "The operation couldn’t be completed. (Cocoa error 512.)" UserInfo=0xa2c5ce0 {reason=Failed to create file; code = 2}, {
reason = "Failed to create file; code = 2";
}
2012-05-11 15:10:39.264 MP-Debug[24398:17003] Try deleting and reinstalling the app to fix this issue
/Applications/Xcode.app/Contents/Developer/Tools/RunPlatformUnitTests.include: line 269: 24398 Abort trap: 6           "${TEST_HOST}" ${TEST_HOST_FLAGS} ${OTHER_TEST_FLAGS}
/Applications/Xcode.app/Contents/Developer/Tools/RunPlatformUnitTests.include:339: error: Test host '/Users/jzhwu/smule/magicpiano/build/Debug-iphonesimulator/MP-Debug.app/MP-Debug' exited abnormally with code 134 (it may have crashed).

** BUILD FAILED **

The following build commands failed:
        PhaseScriptExecution "Run Script" build/MagicPiano.build/Debug-iphonesimulator/MagicPianoTest.build/Script-7C0B24BE155310BE001AC942.sh
(1 failure) 
```

忽略重新安装应用程序部分。那是来自应用程序代码。所以这告诉我它在运行时在某个时候崩溃了。单元测试在 Xcode 4 中运行得很好，我只是无法让它与命令行很好地配合。如果有任何帮助，我将 OCUnit 与 OCMock 一起使用。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T15:24:15.120

我最近在使用我正在处理的应用程序时遇到了类似的问题。我继承了代码库，它没有测试设置，所以我必须构建它们。我曾尝试使用 Apple 的标准方法来根据他们的示例 iPhoneTests 项目设置项目，但它不起作用。我切换到 GHUnit，我能够让它更轻松地工作。如果您在编写测试方面不太远，我建议您切换。

[文档](http://gabriel.github.com/gh-unit/docs/appledoc_include/guide_command_line.html)非常好，对我来说可以从命令行和 Jenkins 运行。在我的应用程序中，我通过复制主目标、将 GHUnitiOS.framework 添加到构建并为我的单元测试类添加其他源来设置第二个测试目标。

我知道这可能不是您正在寻找的答案，但我希望它有所帮助！

# javascript - 在 jquery ajax 请求上操作数据的返回

> ID：10559411
> 
> 赞同：2
> 
> 时间：2012-05-11T22:30:57.350
> 
> 标签：javascript, jquery, ajax, fadein

所以目前的问题不在于 ajax 本身，而在于我获取数据后该怎么做。我在尝试将数据添加到动态内容的类中时遇到了一个巨大的问题。这是执行 ajax 请求的代码，ajax 再次按预期工作，但是当我尝试添加返回的数据时，它会将其添加到我网站上的每个帖子中（[http://readysetfail.com](http://readysetfail.com)）。

```
 /*
         * This is the ajax
         */
        $(".reply").on( "submit" , function(){
        // Intercept the form submission
        var formdata = $(this).serialize(); // Serialize all form data

        // Post data to your PHP processing script
        $.post( "/comment.php", formdata, function( data ) {
            // Act upon the data returned, setting it to #success <div>
            $(this).parent('.post_comment').children('.view_comments').prepend(data);
            $('.hidden').hide();
        });
           return false;
        });
        /*
         * End ajax
         */ 
```

抱歉，如果我解释得很糟糕，就像总结一样，这是我理想中想要的。用户点击发表评论，然后它会淡出他们在正确帖子上发布的评论。

万分感谢！

乔恩

我解决了！

这是一个简单的解决方案，我像这样存储了 jquery 变量，然后就可以导航了:)

```
$(".reply").on( "submit" , function(){
        // Intercept the form submission
        var formdata = $(this).serialize(); // Serialize all form data
        var reply = $(this); 

        // Post data to your PHP processing script
        $.post( "/comment.php", formdata, function( data ) {
            // Act upon the data returned, setting it to .success <div>
            reply.parent().next().prepend(data);
            $('.hidden').hide();
        });
        return false;
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T01:26:17.867

```
$(".reply").on("submit" , function(e) {
      e.preventDefault();
      var formdata = $(this).serialize();
      $.post( "/comment.php", formdata, function( data ) {
           $(this).siblings('.view_comments').prepend(data);
           $('.hidden').hide();
      });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:39:07.217

您可以将 div id 存储在某个变量中并在 ajax 调用后使用它

例如

```
 $(".reply_comment").on( "submit" , function(event){

     event.preventDefault(); 
    var formdata = $(this).serialize();
     $.post( "/comment.php", formdata, function( data ) {

        $(this).parent('.view_comments').prepend(data);
        $('.hidden').hide();
    });
 }); 
```

# php - PHP - 在创建它的文件之外使用函数

> ID：10559413
> 
> 赞同：1
> 
> 时间：2012-05-11T22:31:14.360
> 
> 标签：php, function

我有 3 个 php 文件。第一个（connexion.php）包含一个我用来创建新 PDO 连接的函数：

```
<?php
header('Content-Type: text/html; charset=utf-8');
date_default_timezone_set('Europe/Paris');

function connexion($host, $user, $pass, $db){
    $db_host = $host;  
    $db_user = $user;  
    $db_password = $pass;  
    $db_database = $db;               
    return $connexion = new PDO("mysql:host=$db_host;dbname=$db_database;charset=utf8", $db_user, $db_password);
}

?> 
```

第二个文件（my_function.php）包含一个函数，该函数只包含一个连接到数据库的函数，然后回显一些信息。

```
 <?php
    include(connexion.php);
    function my_first_function(){
        try{
           $connexion = connexion('localhost', 'user', 'user', 'mydb');
           $connexion->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
           //some code that echoes information
        }
        catch(...){...}
    }
    ?> 
```

我的问题是当我尝试将最后一个文件包含到我的第三个 php 脚本中以便能够使用该函数时。该脚本甚至没有启动。我只是有“内部错误”。如果我删除 include(my_function.php) 我的文件会正确加载。我不明白。希望有人能帮助我理解。提前致谢。干杯。马克。在第三个文件下面：

```
<?php
include('connexion.php');
include('my_function.php');

//some code
my_first_function();
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:54:52.503

您不应该`include('connexion.php');`在第三个文件中使用它，因为它也会在您使用时自动包含在内`include('my_function.php');`

由于它包含一个函数声明，这将导致错误，因为该函数已被声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T22:33:12.717

“内部错误”不是 PHP 问题，您可能需要检查您的 .htaccess 或其他 apache 设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T22:41:49.653

如果您尝试多次包含该文件，则会出现错误，因为 PHP 不允许您重新声明具有相同名称的函数。要解决这个问题，请使用：

```
include_once("my_include_file.php"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T22:41:26.723

您要么没有提供包含文件的相对路径，要么您的包含文件内部有错误。要对此进行测试，请尝试以下代码..

```
if( file_exists('the_file_where_the_function_is.php') )
{
    echo "Found the file";
} else {
    echo "File not found";
} 
```

如果它找到该文件，那么您很可能在包含的文件中存在语法错误。另外我猜你正在使用 IE 并得到一个“内部服务器错误”？？？如果是这样，请进入您的 IE 首选项并关闭友好的错误消息以查看实际的 PHP 错误。

# visual-studio-2010 - Visual Studio 2010/2012/2013，类图：如何将接口显示为基类，而不是“lillypop”？

> ID：10559419
> 
> 赞同：18
> 
> 时间：2012-05-11T22:32:04.560
> 
> 标签：visual-studio-2010, visual-studio-2012, visual-studio-2013, visual-studio-2019

由于接口已经在图表上，我想显式地显示继承引用。但我找不到怎么...

![在此处输入图像描述](../Images/376235b7d42d618f5e4527b8c51372f2.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T22:08:11.673

到 2012 年的 VS 2005 中存在一个不允许它工作的错误。我有一个工作方法可能会欺骗它为接口绘制继承。假设您的界面称为 IMyInterface。您必须将其替换为实现该接口的抽象类并使用它而不是您的接口。代码将使用条件编译，如下所示：

```
//生成类图，将'CLSDIAGRAM'添加到Build选项卡上的条件符号，
// 或在此文件顶部添加“#define CLSDIAGRAM”
#if CLSDIAGRAM
#warning CLSDIAGRAM 已定义，此构建应仅在生成类图的上下文中使用
//通过添加_重命名您的界面
公共接口IMyInterface_
{
    int MyProperty { 得到；}
    无效我的方法（）；
}
//这个类将作为类图中的接口；）
public abstract class IMyInterface : IMyInterface_ // 欺骗其他代码使用该类
{
//假实现
    公共 int MyProperty {
        得到 { 抛出新的 NotImplementedException(); }
    }

    公共无效我的方法（）
    {
        抛出新的 NotImplementedException();
    }
}
＃别的
// 这是原始界面
公共接口 IMyInterface {
    int MyProperty { 得到；}
    无效我的方法（）；
}
＃万一

```

这可能会如您所愿。在您的情况下，IMyInterface 将变为 IMedicine。

# c# - C# .NET 中的 Web 响应不工作超过几次

> ID：10559430
> 
> 赞同：2
> 
> 时间：2012-05-11T22:34:25.090
> 
> 标签：c#, httpwebrequest, httpwebresponse

我正在使用 twitter api 开发一个应用程序，其中涉及编写一个方法来检查用户是否存在。这是我的代码：

```
 public static bool checkUserExists(string user)
    {
        //string URL = "https://twitter.com/" + user.Trim();
        //string URL = "http://api.twitter.com/1/users/show.xml?screen_name=" + user.Trim();
        //string URL = "http://google.com/#hl=en&sclient=psy-ab&q=" + user.Trim();
        string URL = "http://api.twitter.com/1/users/show.json?screen_name=" + user.Trim();
        HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(URL);
        try
        {
            var webResponse = (HttpWebResponse)webRequest.GetResponse();
            return true;
        }
        //this part onwards does not matter
        catch (WebException ex)
        {
            if (ex.Status == WebExceptionStatus.ProtocolError && ex.Response != null)
            {
                var resp = (HttpWebResponse)ex.Response;
                if (resp.StatusCode == HttpStatusCode.NotFound)
                {
                    return false;
                }
                else
                {
                    throw new Exception("Unknown level 1 Exception", ex);
                }
            }
            else
            {
                throw new Exception("Unknown level 2 Exception", ex);
            }
        }
    } 
```

问题是，调用该方法不起作用（它没有得到响应）超过 2 或 3 次，使用任何已评论的 url，包括谷歌搜索查询（我认为这可能是由于 twitter API 限制）。在调试时，它显示它卡在：

```
var webResponse = (HttpWebResponse)webRequest.GetResponse(); 
```

我是这样称呼它的：

```
Console.WriteLine(TwitterFollowers.checkUserExists("handle1"));
Console.WriteLine(TwitterFollowers.checkUserExists("handle2"));
Console.WriteLine(TwitterFollowers.checkUserExists("handle3"));
Console.WriteLine(TwitterFollowers.checkUserExists("handle4"));
Console.WriteLine(TwitterFollowers.checkUserExists("handle5"));
Console.WriteLine(TwitterFollowers.checkUserExists("handle6")); 
```

最多我得到2-3行输出。有人可以指出什么问题吗？

**更新 1：**
我每 15 秒发送 1 个请求（在限制范围内），它仍然会导致错误。另一方面，发送请求、关闭应用程序并再次运行它的效果非常好（平均每 5 秒有 1 个请求）。速率限制为每小时 150 次[Twitter 常见问题解答](https://dev.twitter.com/docs/rate-limiting#rest)。

另外，我确实等了一段时间，并在第 2 级得到了这个异常：http: [//pastie.org/3897499](http://pastie.org/3897499)

**更新 2：** 听起来可能令人惊讶，但如果我运行 fiddler，它会完美运行。不管我是否针对这个过程！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T22:40:05.087

您看到的效果几乎可以肯定是由于 Twitter API 上的速率限制类型策略（快速连续的多个请求）。他们密切关注您如何使用他们的 API：第一步是检查他们[的使用条款和](https://dev.twitter.com/terms/api-terms)[速率限制](https://dev.twitter.com/docs/rate-limiting)政策，并确保您遵守规定。

我突然想到两件事：

1.  您正在快速连续地使用多个请求访问 API。大多数 REST API，包括 Google 搜索，都不允许你这样做。这些 API 是非常明显的目标，它们积极主动地防止拒绝服务攻击是有道理的。
2.  您的请求中没有指定**用户代理。**大多数 API 要求您向他们发送有意义的 UA，以帮助他们识别您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T22:57:22.220

1.  请注意，您正在处理`HttpWebResponse`. 因此`Dispose()`及时调用或将对象包装在`using`语句中不仅是明智的，而且对于避免阻塞也很重要。
2.  此外，var 非常适合处理匿名类型、Linq 查询结果等，但它不应该成为拐杖。当您非常了解类型时，为什么要使用 var 呢？（即，您已经在执行强制转换`HttpWebResponse`。）
3.  最后，像这样的服务通常会限制每秒的连接速率和/或允许同时连接的数量，以防止滥用。如果不处理您的 HttpWebResponse 对象，您可能会违反允许的同时连接数。通过过于频繁地查询，您将打破速率限制。

# javascript - Windows 8 IndexedDB createObjectStore

> ID：10559431
> 
> 赞同：0
> 
> 时间：2012-05-11T22:34:25.727
> 
> 标签：javascript, html, windows-8, windows-runtime

尝试使用 Javascript 构建 Metro 应用程序并遇到 IndexedDb 问题。我无法创建对象存储。我的代码如下所示。我在 open() 函数成功后这样做。

```
dbReq.onsuccess = function (evt) {
  var txn = evt.target.transaction;
  var db = evt.target.result;
  if (!db.objectStoreNames.contains("test")) {
    var store = db.createObjectStore("test");
  }
} 
```

每次，它都会在“createObjectStore”调用上抛出一个异常，上面写着

> 0x800a139e - JavaScript 运行时错误：[object IDBDatabaseException]

[他们在这里](http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/a63ce772-0d88-4e90-a4b5-84fce275987f)谈论它，这也是一个很好的例子，但仍然没有帮助我。请注意，控制会命中“if”语句中的一行代码。所以 'db' 不是 null 并且是有效的。但我看到交易是空的 - 不确定这是否是一个问题，或者即使你现在应该得到一个有效的交易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T17:41:21.180

不知道为什么它不起作用。切换到使用漫游设置，它非常易于使用。

```
roamingSettings.values[SETTING_NAME] = SETTING_VALUE; 
```

阅读，当然，

```
var temp = roamingSettings.values[SETTING_NAME]; 
```

# grails - Grails冲洗不起作用

> ID：10559433
> 
> 赞同：1
> 
> 时间：2012-05-11T22:34:42.297
> 
> 标签：grails, batch-processing

我正在处理一个大型 csv 文件，我发现这篇关于批量导入的文章：http: [//naleid.com/blog/2009/10/01/batch-import-performance-with-grails-and-mysql/](http://naleid.com/blog/2009/10/01/batch-import-performance-with-grails-and-mysql/)。我尝试做同样的事情，但似乎没有任何效果。

每次刷新后是否应该在数据库中查看实例？因为当我尝试查询“SELECT COUNT(*) FROM TABLE1”时，现在有 0 个或所有实体，所以看起来这些实例是一次性提交的。

然后我还注意到第一次导入空白表时导入工作很快，但是当表已满并且实体应该更新或另存为新时，整个过程非常缓慢。这主要是因为内存没有被清理并减少到1MB或更少，并且应用程序卡住了。那么是因为没有刷新会话吗？

我的导入代码在这里：

```
public void saveAll(List<MedicalInstrument> listMedicalInstruments) {
    log.info("start saving")
    for (int i = 0; i < listMedicalInstruments.size() - 1; i++) {
        def medicalInstrument = listMedicalInstruments.get(i)
        def persistedMedicalInstrument = MedicalInstrument.findByCode(medicalInstrument.code)
        if (persistedMedicalInstrument) {
            persistedMedicalInstrument.properties = medicalInstrument.properties
            persistedMedicalInstrument.save()
        } else {
            medicalInstrument.save()
        }
        if ((i + 1) % 100 == 0) {
            cleanUpGorm()
            if ((i + 1) % 1000 == 0) {
                log.info("saved ${i} entities")
            }
        }
    }
    cleanUpGorm()
}

protected void cleanUpGorm() {
    log.info("cleanin GORM")
    def session = sessionFactory.currentSession
    session.flush()
    session.clear()
    propertyInstanceMap.get().clear()
} 
```

非常感谢您的帮助！

问候，

洛伊扎

PS：我的 JVM 内存总共有 252.81 MB，但它只是我和其他 3 人的测试环境。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T10:05:51.580

我曾经遇到过类似的问题。然后我意识到原因是因为我是在 grails 服务中做的，默认情况下它是事务性的。因此，对服务中方法的每次调用本身都包装在一个事务中，该事务使对该数据库的更改一直存在，直到方法完成，在这种情况下，结果不会被刷新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:47:02.627

根据我的经验，在它们最终全部提交之前，它们仍然不一定在数据库中可见。我正在使用 Oracle，我能够让它们分批提交（在数据库中可见）的唯一方法是为每个批次创建单独的事务并在刷新后将其关闭。然而，这导致在最后一次刷新的过程结束时出现错误。我没有时间弄清楚，并且使用上面的过程，无论数据负载有多大，我都不会遇到问题。

使用这种方法仍然有很大帮助——它确实会刷新和清除会话。您可以查看您的内存使用情况以了解这一点。

至于用记录更新表，表上有索引吗？有时索引会减慢像这样的大量插入/更新，因为数据库试图保持索引新鲜。也许在导入/更新之前禁用索引，然后在完成时启用？

# java - 在线程安全对象上同步是否会阻止可能操纵它的其他调用？

> ID：10559435
> 
> 赞同：3
> 
> 时间：2012-05-11T22:35:24.840
> 
> 标签：java, concurrency

假设我创建了一个线程安全对象：

```
PriorityBlockingQueue<Object> safeQueue = new PriorityBlockingQueue<Object>(); 
```

如果我同步它：

```
synchronized (safeQueue) {
   ....
} 
```

是否会阻止代码：

```
// some non-synchronized block
Object value = safeQueue.poll(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T22:36:22.390

不。唯一一次你得到*任何*阻塞是如果另一个线程*也在*`synchronized`同一个对象上执行。如果您的代码是`synchronized (safeQueue)`，那么只有在是方法或代码使用代码时`PriorityBlockingQueue.poll()`才会阻塞。`poll()``synchronized``synchronized (this)`

当您调用代码时，实际上是`safeQueue.poll()`在`PriorityBlockingQueue`使用内部 `ReentrantLock`，而*不是*在使用`synchronized (this)`. 这是代码`poll()`：

```
public E poll() {
    final ReentrantLock lock = this.lock;
    lock.lock();
    try {
        return q.poll();
    } finally {
        lock.unlock();
    }
} 
```

最后，正如您所提到的，`PriorityBlockingQueue`它已经是可重入的，因此您不需要对其进行同步以允许多个线程访问队列。当然，如果您需要在自己的代码中解决竞争条件，您仍然可能需要对其进行同步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T23:28:37.740

简短的回答是：这取决于线程安全类的线程安全性来自何处。

如果你想走这条路（小心未来版本的变化......），你必须依赖类的文档或它的实现代码，或者是防御性的而不是信任它，而是在另一个对象上同步以满足你的原子性需求（或您正在同步的任何其他内容）。

它当然不必阻塞，特别是因为许多`java.util.concurrent`类都是非阻塞的（因此不会自行同步以实现线程安全）。另一方面，如果该类从`synchronized(this)`（或等效地，`synchronized`实例方法）获得其线程安全性，那么是的，这将阻塞。这方面的一个示例是从 返回的地图`Collections.synchronizedMap`，其中记录了阻塞并且实际上是预期的功能（以便您可以原子地查询和修改地图）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T22:43:52.380

如果对象本身具有在实例上同步的方法，这是可能的。例如：

```
MyClass c = new MyClass();
synchronized(c) {
    ...
} 
```

并且`MyClass`是：

```
class MyClass {

    // foo needs a lock on this
    public synchronized void foo() { 
       ...
    }
} 
```

现在，如果与上面编写的代码并行执行，对节`c.foo();`外部的调用仍然会阻塞。`synchronized`

例如，旧的 Java`Vector`类是这样在内部同步的，因此从外部锁定对象可能会干扰内部锁定。

# opengl - cl/gl 互操作：带有 GLIntercept 的 clCreateFromGLTexture2D 在 AMD FUSION 上失败

> ID：10559440
> 
> 赞同：1
> 
> 时间：2012-05-11T22:36:07.990
> 
> 标签：opengl, opencl, gpu, amd-processor

我有一个 clgl 互操作可执行文件，它正在调用`clCreateFromGLTexture2D`. 那个电话失败了……

```
clCreateFromGLTexture2D( 0x06691828, CL_MEM_WRITE_ONLY, GL_TEXTURE_2D, 0, 1, CL_INVALID_GL_OBJECT ) = 0x00000000 
```

我正在使用[GLIntercept](http://code.google.com/p/glintercept/)。这里。所以我在这里使用由 GLIntercept 生成的 Opengl32.dll ......好吧，它可以在 Nvidia GTX 上运行，并且可以在 AMD FUSION 和 AMD Radeon GPU 上独立运行而不会被拦截。但是，在使用开源 GLIntercept 时它会失败。

如果您有兴趣下载和重新创建问题，clgl 互操作测试代码会在此处发布。

有谁知道如何解决它？以下是我的调试日志中的一些陈述......如果有帮助..

如果您有兴趣下载我用于此的测试示例 clgl 互操作代码，我在 GLIntercept 代码网站上创建了一个未解决的[问题/票证...](http://code.google.com/p/glintercept/issues/detail?id=2)

```
glutInit(  ) = 
glutInitDisplayMode( 12 ) 
glutInitWindowSize( 320, 258 ) 
wglChoosePixelFormat( 38010929, 001EF950 PIXELFORMATDESCRIPTOR {  nSize 28 nVersion 1 dwFlags 25  PFD_DOUBLEBUFFER  PFD_DRAW_TO_WINDOW  PFD_SUPPORT_OPENGL  iPixelType PFD_TYPE_RGBA cColorBits   cRedBits  cRedShift   cGreenBits  cGreenShift   cBlueBits  cBlueShift   cAlphaBits   cAlphaShift   cAccumBits   cAccumRedBits   cAccumGreenBits   cAccumBlueBits   cAccumAlphaBits   cDepthBits   cStencilBits   } 28 ) = 0x2
wglGetCurrentContext(  ) = 0x00000000
wglGetCurrentDC(  ) = 0x00000000
glutCreateWindow( OpenGL-CL interraction! ) = 0x1
glClearColor( 0, 0, 0, 0 ) 
glEnable( b71 ) 
glEnable( de1 ) 
glGenTextures( 1, 0125B194 { 1}  ) 
glBindTexture( de1, 1 ) 
glTexEnvi( 2300, 2200, 1e01 ) 
glTexParameteri( de1, 2801, 2600 ) 
glTexParameteri( de1, 2800, 2600 ) 
glTexImage2D( de1, 0, 8058, 100, 100, 0, 1908, 1401, 00C2E858 ) 
glBindTexture( de1, 0 ) 
clGetPlatformIDs( 0, NULL, 1 ) = CL_SUCCESS
clGetPlatformIDs( 1, 05744514, NULL ) = CL_SUCCESS
clGetDeviceIDs( 05744514, CL_DEVICE_TYPE_GPU, 1, 04516F40 , NULL ) = CL_SUCCESS
clGetDeviceInfo( 0x04516F40, CL_DEVICE_NAME, 400, BeaverCreek, NULL ) = CL_SUCCESS
clGetDeviceInfo( 0x04516F40, CL_DEVICE_EXTENSIONS, 400, cl_khr_global_int32_base_atomics cl_khr_global_int32_extended_atomics cl_khr_local_int32_base_atomics cl_khr_local_int32_extended_atomics cl_khr_3d_image_writes cl_khr_byte_addressable_store cl_khr_gl_sharing cl_ext_atomic_counters_32 cl_amd_device_attribute_query cl_amd_vec3 cl_amd_printf cl_amd_media_ops cl_amd_popcnt cl_khr_d3d10_sharing , NULL ) = CL_SUCCESS
wglGetCurrentContext(  ) = 0x00020000
wglGetCurrentDC(  ) = 0x38010929
wglGetCurrentContext(  ) = 0x00020000
clCreateContext( 8200  0x20000  8203  0x38010929  4228  0x5744514, 1, 04516F40 , NULL, NULL, CL_SUCCESS ) = 0x06A30828
clCreateCommandQueue( 0x06A30828, 0x04516F40, 0, CL_SUCCESS ) = 0x06A69900
clCreateProgramWithSource( 0x06A30828, 1, C:\Users\inteltc\Documents\clgl_latest\Debug\clgl_1.program, CL_SUCCESS ) = 0x06A6B9F8
clBuildProgram( 0x06A6B9F8, 0, NULL, NULL, NULL, NULL ) = CL_SUCCESS
clCreateKernel( 0x06A6B9F8, kernel1, CL_SUCCESS ) = 0x045266E0
clCreateFromGLTexture2D( 0x06A30828, CL_MEM_WRITE_ONLY, GL_TEXTURE_2D, , 0, 1, CL_INVALID_GL_OBJECT ) = 0x00000000 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T04:08:25.307

我没有看到您为纹理对象调用 glTexImage2D，这基本上使纹理宽度、高度和 mipmap 未定义，因此很明显为什么它失败了。

# iphone - XCode 不允许我在我的 xib 文件中使用静态库视图

> ID：10559443
> 
> 赞同：1
> 
> 时间：2012-05-11T22:36:26.723
> 
> 标签：iphone, ios, xcode4, interface-builder

我创建了一个静态链接库类型的新项目。

我已将代码（以前在应用程序中工作）移动到库中，将所有 xib 文件留在应用程序中。

我已经更改了导出目录并从派生数据文件夹中添加了库文件，以便它获取编译版本并链接到它。

我已将库添加到捆绑包中，并已使用 iPhone Explorer 验证它在应用程序中

我已经通过在身份检查器的自定义类字段中删除并选择自定义视图类型来验证 xib 文件识别新视图类型。

我已更改所有#import 命令以反映 <> VS "" 更改并已编译应用程序。

但是我的自定义类的任何方法都不能执行。并且 NSLog 报告该类是其基本对应物，而不是自定义派生类。

我不知所措，花了很长时间转换我必须在库中工作的所有代码。我希望有人可以帮助解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T19:36:34.463

在这个问题上，事实证明，Objective C 的编译器默认不加载库中的类别和自定义类。有两种方法可以克服这一点。

这是您的选择。

1.  在将被调用以“激活”该类或类别的类别上创建一个激活类型方法。这需要在应用程序加载任何 nib 文件之前完成。而且好像有点屁股疼。然而，这就是我最初克服这个问题的方式。

2.  添加链接器标志，告诉目标 C 在执行应用程序之前加载所有库并在库中附加任何和所有类别和类。（这需要在#import(ing) 正确位置的正确文件之上完成。我将在下面提供一个图形。并提供用于搜索目的的标志

![在此处输入图像描述](../Images/8bb55611549d9f7ce434b0126d145781.png)

-ObjC 是我添加的第一个，但 -all_load 确实成功了。

我希望其他人可以从这次经历中受益。

# session - 通过php会话变量检查特定用户是否在线

> ID：10559444
> 
> 赞同：1
> 
> 时间：2012-05-11T22:36:30.480
> 
> 标签：session

我目前正在尝试使用 php 会话变量在我的网页上显示所有在线用户。为此，每当用户登录或注销时，数据库中的列都会设置为“在线”或“离线”。但这并不完全有效，因为当用户关闭浏览器时数据库不会更新（因此破坏了会话）。那么是否有另一种方法来检查是否设置了某个 sessionid？

目前我正在设置这样的会话：

```
session_start();

$_SESSION['username']="Example Username"; 
```

要从当前用户页面检查是否有会话变量集，我们可以简单地使用：

```
if(isset($_SESSION['username']))
{
//username is set
} 
```

但是如果我们需要检查一个特定的用户是否在线，我们如何获得一个包含所有已设置会话变量的数组？例如

```
//Get all $_SESSION['username'] vars

//loop through array and check for specific $_SESSION

for($i=0; ... )
{
  if( $_SESSION['username'][$i] == "User 1" )
  {
  //do something
  }
} 
```

从到目前为止我读过的所有内容来看，似乎没有办法在您的页面上获取所有会话的数组。那么有没有更好的方法，例如 Facebook、Twitter 等如何处理这玩意儿？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T22:54:02.283

一种解决方案是在您的数据库中存储一个时间戳，以及记录用户最后一次访问您的任何网站资源的在线/离线标志。然后，您可能会在 15 分钟或其他一些恒定值后将它们视为离线。

另一个解决方案是在这里使用回调[http://php.net/manual/en/function.session-set-save-handler.php](http://php.net/manual/en/function.session-set-save-handler.php)我认为您可以在其中处理 gc 回调并在数据库中设置离线标志.

如果您在该页面上搜索`class SessionDB`或转到[此处](http://www.php.net/manual/en/function.session-set-save-handler.php#96305)，看起来有人已经在自定义类中实现了某个版本！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-21T12:44:33.130

您可以使用简单的更新查询

例如，您有一个表 users 并且您有一个名为 status(online/offline) 的列

在您的 login.php 上使用

```
<?php
//your user verification code
if(variable that holds your sql query){
$user_status=('UPDATE user SET status= online WHERE email="'your user email selector'")
} 
```

然后在注销时执行类似的脚本，只需将在线值更改为离线

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-11T22:54:21.713

你可以试试这个：

```
foreach ($_SESSION as $sessionKey => $sessionValue)
{
  if( $sessionKey == 'username' ) && ( $sessionValue == 'User 1' )
  {
  //do something
  }
} 
```

# java - 使用字符串参数镜像方法

> ID：10559445
> 
> 赞同：1
> 
> 时间：2012-05-11T22:36:55.553
> 
> 标签：java, string, reflection, mirroring

我正在尝试使用镜像来调用我的类 MyClass 的方法 s1，参数为 s2。Java 抱怨 String.TYPE 不存在。我检查了 API，它是正确的：我不能做与调用 Integer.TYPE 时相同的事情。但是我该如何解决这个问题呢？我需要 String 类型的 partype，否则该方法会引发异常。

```
public void trying(MyClass method, String s1, String s2){
   try {
       Class cls = Class.forName("MyClass");
       Class partype[] = new Class[1];
       partype[0] = String.TYPE;
       Method meth = cls.getMethod(s1, partype);
       meth.invoke(methobj, s2);
   }
   catch (Throwable e) {
        System.err.println(e);
   }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T22:38:48.173

它不是一个类型，它是一个`class`：

```
partype[0] = String.class; 
```

# django - 如何在 Django CMS 中使用标签检测语言

> ID：10559446
> 
> 赞同：1
> 
> 时间：2012-05-11T22:37:21.263
> 
> 标签：django, django-cms

我正在设计主页，但有些词取决于实际主页的语言。我想做这样的事情 {% if english %} Hello {% elif french %} Bonjour {% else %} Blabla {% endif %}

django-cms 中是否有任何模板标签可以完成这项工作？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T00:24:32.687

其实你想错了。Django 在 Python 代码和模板中支持翻译。[Django Translation 文档](https://docs.djangoproject.com/en/dev/topics/i18n/translation/)给出了如何做到这一点的建议。

您创建一个模板

```
{% load i18n %}
{% trans "Hello" %} 
```

设置完成后，“Hello”将被翻译为 bonjour。

您需要在项目设置中激活 I18N，然后调用

```
manage.py makemessages 
```

为您的项目创建一个 .po 文件。为 .po 文件创建翻译后，键入类似

```
manage.py compilemessages 
```

实际的做事方式比这要困难一些，但在文档中进行了正确描述。

# c++ - 我的 WIN32 API 对话框不显示 - C++

> ID：10559450
> 
> 赞同：3
> 
> 时间：2012-05-11T22:37:57.587
> 
> 标签：c++, winapi, dialog

您好，我正在尝试学习如何使用 WIN32 API 创建 Windows 应用程序。为此，我正在阅读有关该主题的 The Forgers Tutorial。当我的菜单项被点击时，我一直试图让我的第一个对话框显示出来。我查看了 MSDN 站点并查看了关于我的代码中所有相关函数的文档，并且所有内容对我来说都是正确的。但是，当然，我不知道，因为我只是在学习，我想知道是否有人可以指出我的错误，或者指出我可能在文档中遗漏的内容。无论如何，我确信这真的很愚蠢（这些东西总是如此）这是我的小脚本。希望你们中的任何人都可以提供帮助。谢谢

```
#include <windows.h>
#include "resource.h"
/*  Declare Windows procedure  */
LRESULT CALLBACK WindowProcedure (HWND, UINT, WPARAM, LPARAM);
BOOL CALLBACK AboutDlgProc(HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam);
/*  Make the class name into a global variable  */
char szClassName[ ] = "WindowsApp";

int WINAPI WinMain (HINSTANCE hThisInstance,
                HINSTANCE hPrevInstance,
                LPSTR lpszArgument,
                int nFunsterStil)

{
HWND hwnd;               /* This is the handle for our window */
MSG messages;            /* Here messages to the application are saved */
WNDCLASSEX wincl;        /* Data structure for the windowclass */

/* The Window structure */
wincl.hInstance = hThisInstance;
wincl.lpszClassName = szClassName;
wincl.lpfnWndProc = WindowProcedure;      /* This function is called by windows */
wincl.style = CS_DBLCLKS;                 /* Catch double-clicks */
wincl.cbSize = sizeof (WNDCLASSEX);

/* Use default icon and mouse-pointer */
wincl.hIcon = LoadIcon (NULL, IDI_APPLICATION);
wincl.hIconSm = LoadIcon (NULL, IDI_APPLICATION);
wincl.hCursor = LoadCursor (NULL, IDC_ARROW);
wincl.lpszMenuName = NULL;                 /* No menu */
wincl.cbClsExtra = 0;                      /* No extra bytes after the window class */
wincl.cbWndExtra = 0;                      /* structure or the window instance */
/* Use Windows's default color as the background of the window */
wincl.hbrBackground = (HBRUSH) COLOR_BACKGROUND;

/* Register the window class, and if it fails quit the program */
if (!RegisterClassEx (&wincl))
    return 0;

/* The class is registered, let's create the program*/
hwnd = CreateWindowEx (
       0,                   /* Extended possibilites for variation */
       szClassName,         /* Classname */
       "Windows App",       /* Title Text */
       WS_OVERLAPPEDWINDOW, /* default window */
       CW_USEDEFAULT,       /* Windows decides the position */
       CW_USEDEFAULT,       /* where the window ends up on the screen */
       544,                 /* The programs width */
       375,                 /* and height in pixels */
       HWND_DESKTOP,        /* The window is a child-window to desktop */
       NULL,                /* No menu */
       hThisInstance,       /* Program Instance handler */
       NULL                 /* No Window Creation data */
       );

/* Make the window visible on the screen */
ShowWindow (hwnd, nFunsterStil);

/* Run the message loop. It will run until GetMessage() returns 0 */
while (GetMessage (&messages, NULL, 0, 0))
{
    /* Translate virtual-key messages into character messages */
    TranslateMessage(&messages);
    /* Send message to WindowProcedure */
    DispatchMessage(&messages);
}

/* The program return-value is 0 - The value that PostQuitMessage() gave */
return messages.wParam;
}
/*  This function is called by the Windows function DispatchMessage()  */

LRESULT CALLBACK WindowProcedure (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)
{
switch (message)                  /* handle the messages */
{
    case WM_CREATE:
         {
             HMENU  hMenu, hSubMenu, hOtherMenu, hOtherSubMenu;

             hMenu = CreateMenu();
             hSubMenu = CreatePopupMenu();
             hOtherMenu = CreateMenu();
             hOtherSubMenu = CreatePopupMenu();
             AppendMenu(hSubMenu, MF_STRING, ID_FILE_EXIT, "E&xit");
             AppendMenu(hMenu, MF_STRING | MF_POPUP, (UINT)hSubMenu, "&File");
             AppendMenu(hSubMenu, MF_STRING, ID_STUFF, "S&tuff");

             AppendMenu(hOtherSubMenu, MF_STRING,ID_OTHER_SUB, "O&ther");
             AppendMenu(hMenu, MF_STRING | MF_POPUP, (UINT)hOtherSubMenu, "&Other");

             SetMenu(hwnd, hMenu); 
             //SetMenu(hwnd, hOtherMenu);

             }
             break;

    case WM_LBUTTONDOWN:
         MessageBox(hwnd, "this is my program", "program box", 0);
         break;
    case WM_CLOSE:
         DestroyWindow(hwnd);
         break;
    case WM_DESTROY:
        PostQuitMessage (0);       /* send a WM_QUIT to the message queue */
        break;
             case WM_COMMAND:
         switch(LOWORD(wParam))
         {
             case ID_STUFF:
                 DialogBox(GetModuleHandle(NULL), MAKEINTRESOURCE(IDD_ABOUT), hwnd, AboutDlgProc);
                 break;

             case ID_FILE_EXIT:
                  PostQuitMessage(0);
                  break;
         } 
    default:                      /* for messages that we don't deal with */
        return DefWindowProc (hwnd, message, wParam, lParam);
}
return 0;
}
BOOL CALLBACK AboutDlgProc(HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam){
 switch(message)
 {
     case WM_INITDIALOG:
              return TRUE;
     case WM_COMMAND:
              switch(LOWORD(wParam))
              {
                  case IDOK:
                   EndDialog(hwnd, IDOK);
break;
case IDCANCEL:
EndDialog(hwnd, IDCANCEL);
break;
}     
break;
default:
return FALSE; 
}
return TRUE;
} 
```

这是.rc

```
#include "resource.h"
#include <windows.h>

    IDR_MYMENU MENU
    BEGIN
    POPUP "F&ile"
    BEGIN
       MENUITEM "E&xit", ID_FILE_EXIT
       MENUITEM "stuff I like", ID_STUFF
    END
END    

IDD_ABOUT DIALOG DISCARDABLE 0,0,239,66
STYLE DS_MODALFRAME | WS_POPUP | WS_CAPTION | WS_SYSMENU
CAPTION "About Box"
FONT 8, "MS Sans Serif"
BEGIN
    DEFPUSHBUTTON "&ok", IDOK, 174,18,50,14
    PUSHBUTTON "&Cancel", IDCANCEL, 174,18,50,14
    GROUPBOX "About this program...",IDC_STATIC,7,7,225,52
    CTEXT "This is a Modular Database program", IDC_STATIC, 16,18,144,33
END 
```

这是 .rc 的标头

```
#define IDR_MYMENU 101

#define ID_FILE_EXIT 4001
#define ID_STUFF 4002

#define IDC_STATIC -1
#define IDD_ABOUT 102
#define ID_OTHER_SUB 4003 
```

PS我是任何论坛的第一次发帖，所以如果我没有清楚地获得代码，我深表歉意，请让我知道再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-25T09:38:10.833

我认为您没有将`resource.h`and添加`recource.rc`到您的项目中。

如果您不添加它们，您的项目将编译但不会显示对话框。

我编译了你的代码，它运行良好。

我使用 mingw4.7 和 devc++ IDE。

[![添加后](../Images/15de02710710cec9adbae1372349fb5a.png)](https://i.stack.imgur.com/jsbRI.jpg)

[![添加前](../Images/c3493a84b7a8f7cf519575d6473ec691.png)](https://i.stack.imgur.com/xTfxC.jpg)

# twitter - 如何在不受速率限制的情况下检查用户名是否在 Twitter 上被使用？

> ID：10559452
> 
> 赞同：-1
> 
> 时间：2012-05-11T22:38:31.190
> 
> 标签：twitter

有许多 REST API 方法可以检查用户名是否在 Twitter 上使用，但据我研究，所有这些方法都受到速率限制。

我想要此功能的原因是防止某人在其他人在 Twitter 上使用的*网站*上声明用户名，例如，某人可能会声明名人的用户名并混淆人们。

在这种情况下不可能使用 oauth，因为这种情况下的用户可能不是 Twitter 用户。

[150/小时的速率限制是不可接受的。一个可能的解决方案是使用必应搜索 API 来搜索用户名？- 如果必应搜索当然不受速率限制]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T13:26:03.630

试试 curl，这是 php 中最小的工作脚本：

```
$url = "http://mobile.twitter.com/justinbieber";
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
$resp = curl_exec($curl);
$code = curl_getinfo($curl, CURLINFO_HTTP_CODE);
if($code == 200)
{
    echo "He is on twitter";
}
else 
{
    echo "He is on not twitter";
} 
```

*您应该查询 mobile.twitter.com 而不是真实的，因为真实的不做 HTTP 响应代码。还有其他几个原因。*

# objective-c - IOS Obj C：使用相同的值初始化多个 IBOutlet 实例

> ID：10559453
> 
> 赞同：0
> 
> 时间：2012-05-11T22:38:42.333
> 
> 标签：objective-c, ios, iboutlet

我很难弄清楚如何初始化一个类并将相同的初始化参数传递给多个实例。我可以让它与 1 个插座（instance1）一起工作。但是我怎样才能让它在不为每个实例重写变量的情况下与实例 2 一起工作呢？

视图控制器.h：

```
#import "CustomClass.h"

@interface MYViewController : UIViewController

@property (unsafe_unretained, nonatomic) IBOutlet CustomClass *instance1;
@property (unsafe_unretained, nonatomic) IBOutlet CustomClass *instance2;

@end 
```

视图控制器.m：

```
#import "CustomClass.h"

@implementation MYViewController;

@synthesize instance1, instance2;

- (void)viewDidLoad
{
    [super viewDidLoad];
    instance1.variable1 = option1;
    instance1.variable2 = 4.5;
    instance1.variable3 = instance1.value;
    [instance1 addTarget:self action:@selector(instance1DidChange) forControlEvents:UIControlEventValueChanged]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:16:43.650

本质上，您希望将实例添加到 NSSet 或 NSArray 并对其进行迭代或使用[键值编码](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/KeyValueCoding.html)来设置值。如果这些出口在概念上是一组事物，而不仅仅是一堆碰巧具有相同初始值的独立对象，则可以使用 IBOutletCollection 而不是 IBOutlet 将它们全部保存在一个数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:19:29.313

带有一些 KVC 的循环应该为您完成...

```
@implementation MYViewController;

@synthesize instance1, instance2;

- (void)viewDidLoad
{
    [super viewDidLoad];

    for (int i = 0; i =< 1; i++) {
        MyClass *newInstanceVariable = [[MyClass alloc] init];
        newInstanceVariable.variable1 = option1;
        newInstanceVariable.variable2 = 4.5;
        newInstanceVariable.variable3 = instance1.value;
        [newInstanceVariable addTarget:self action:@selector(instance1DidChange) forControlEvents:UIControlEventValueChanged];
        instanceVariableName = [NSString stringWithFormat:@"instance%i",i];
        [self valueForKey:instanceVariableName] = newInstanceVariable;
    }
} 
```

应该非常接近您要查找的内容。

# python - 删除与另一个列表中的任何条目匹配的列表条目

> ID：10559465
> 
> 赞同：1
> 
> 时间：2012-05-11T22:40:30.160
> 
> 标签：python

我有一个诅咒词列表，我想与其他列表匹配以删除匹配项。我通常单独使用 list.remove('entry') ，但是在一个条目列表中循环访问另一个列表 - 然后删除它们让我很难过。有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-11T22:47:46.890

使用[`filter`](http://docs.python.org/library/functions.html#filter)：

```
>>> words = ['there', 'was', 'a', 'ffff', 'time', 'ssss']
>>> curses = set(['ffff', 'ssss'])
>>> filter(lambda x: x not in curses, words)
['there', 'was', 'a', 'time']
>>> 
```

也可以通过列表理解来完成：

```
>>> [x for x in words if x not in curses] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T22:43:58.027

使用套装。

```
a=set(["cat","dog","budgie"])
b=set(["horse","budgie","donkey"])
a-b
->set(['dog', 'cat']) 
```

# javascript - 在 Rails 中存储和播放音乐文件

> ID：10559468
> 
> 赞同：0
> 
> 时间：2012-05-11T22:40:58.797
> 
> 标签：javascript, ruby-on-rails-3, html, mp3

好吧，现在我有回形针存储 mp3，它们只有在我使用 amazon s3 时才会播放，我现在不想这样做，因为那时我对如何保护这些文件一无所知....

但现在我正在重新考虑我的方法，因为我需要锁定 mp3，然后给予一定的下载权限。对我来说，关键是所有用户都可以播放歌曲。但除非获得许可，否则不得下载。

所以我的问题

1.  在特定时间存储 mp3 和限制不同类型的访问的最佳方式是什么？
2.  我应该使用回形针吗？[https://github.com/thoughtbot/paperclip](https://github.com/thoughtbot/paperclip)

该项目在rails 3.2.3，ruby 1.9.3中。使用 HTML5/Javascript 音乐播放器。并且生活在 Unicorn/Nginx 服务器上。

这可以用作我们的播放器，但我想自己构建一个....有什么想法吗？： http: [//jplayer.org/](http://jplayer.org/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T17:27:58.067

学习和使用 Ryan Bates 的 CanCan gem [https://github.com/ryanb/cancan](https://github.com/ryanb/cancan)

您将定义能力，例如“聆听”或“下载”，并在您的控制器操作中测试当前用户是否有能力执行该操作。

# oop - 代表另一个类中的数据的中间类的名称

> ID：10559471
> 
> 赞同：0
> 
> 时间：2012-05-11T22:41:55.010
> 
> 标签：oop, class, object, business-logic-layer, multi-tier

一个类是否有一个标准名称来表示另一个类，但要保持不同；

一个例子应该有助于说明：假设我的业务层可以访问一个类对象，例如 .NET 的 System.Diagnostics.Process，其中包含有关系统上运行的进程的大量信息。另一个项目，例如系统资源项目，对所有这些信息没有用处，因此在业务层中，我实现了一个 ProcessInfo 类，它只包含被认为重要的属性。

这种中间的、有代表性的班级有名字吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:31:34.877

我将其称为包装类，例如： ProcessInfoWrapper

# ruby-on-rails - Sass 未在 Rails 3.1 资产管道上预编译，资产：预编译 rake 任务

> ID：10559474
> 
> 赞同：1
> 
> 时间：2012-05-11T22:43:24.283
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, sass, asset-pipeline, assets

我有一个刚刚转换为 Rails 3.1 的应用程序。在我的 app/assets/stylesheets 中，我有一堆 sass 文件，它们使用 @import 导入 parial sass 文件。其中一个文件称为 screen.sass，它是我想在其中一种布局中使用的主要 sass 文件。

但是，当我跑步时

```
RAILS_ENV=demo bundle exec rake assets:precompile 
```

我得到那个屏幕没有预编译（在../app/assets/stylesheets/screen.sass中）

如果不将其添加到 demo.rb，它根本没有被编译，没有任何消息

```
config.assets.precompile += %w( screen.css ) 
```

我尝试了几件事，例如将 screen.sass 文件重命名为 screen.css.sass，并且我尝试在我的 app/assets/stylesheets 目录中创建一个名为 screen.css 的清单文件并需要 screen.sass 文件。在每种情况下，我都会得到与上面相同的预编译错误。

我没有使用生产环境进行预编译，因为演示是我想要测试 3.1 升级的暂存环境。

有人对我还可以尝试解决此错误有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:01:14.263

rake assets precompile 需要知道将样式表编译成什么类型​​的文件。将 screen.sass 更改为 screen.css.sass

# php - 基于当前类别的 Magento 特色项目

> ID：10559476
> 
> 赞同：0
> 
> 时间：2012-05-11T22:43:30.253
> 
> 标签：php, magento, random, content-management-system

我在 view.phtml 文件中使用以下代码来显示随机特色产品：

```
 <?php
$catId = $this->getCat_id();
$cat=Mage::getModel("catalog/category")->load($catId);
$prodCollection = $cat->getProductCollection();
$pids=array();
foreach($prodCollection as $product)
{
        array_push($pids,$product->getId());
}
$randProductId=array_rand($pids);
$product = Mage::getModel('catalog/product')->load($randProductId);
$product->getName();
?>
<div class="catalog-h-price">

                        <img src="<?php echo $product->getImageUrl();?>" height="64" width="64" /><?php echo $product->getName();?><br /><span class="price"><sup>$</sup><?php echo number_format($product->getData('price'), 0); ?></span> <span class="msrp">U.S. MSRP</span><a href="#"><a href="<?php echo $product->getProductUrl();?>">
<img src="http://coloresg.com/skin/frontend/default/modern/images/view-now.gif" width="36" height="28" /></a>
                    </div> 
```

目前它显示整个目录中的随机产品；我想知道如何调整以仅从当前类别中提取。谢谢，-山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T05:59:25.157

在另一个线程中回答了错误

代替

```
$product = Mage::getModel('catalog/product')->load($randProductId); 
```

经过

```
$product = Mage::getModel('catalog/product')->load($pids[$randProductId]); 
```

# javascript - d3.js 线和面积图 - 想要添加由两个点定义并表示阈值/最小值的额外线（以便于查看）

> ID：10559478
> 
> 赞同：3
> 
> 时间：2012-05-11T22:43:42.623
> 
> 标签：javascript, d3.js

我有一个有效的 d3.js 可视化，将数据返回率显示为复合线和面积图 (http://anf.ucsd.edu/tools/data_return_rates/)。

x 轴是时间，y 轴是百分比数据返回率。您可以单击可视化顶部的各种按钮在数据集（仅解析的 JSON 文件）之间切换。

除了原始数据图之外，我还想添加一条简单的线来定义所需的最低数据返回率 (85%)。这纯粹是帮助用户确定数据返回率是否高于此最小值/阈值的视觉辅助。我使用数据集上的 d3.min() 和 d3.max() 方法计算这条“最小值”线（只有两个点）的 x 值（时间）。y 值只是整数 (85)：

```
var min_data_return = [ 
      {   
      "readable_time": d3.min(data, function(d) { return d.readable_time; }),
      "value": 85
      },  
      {   
      "readable_time": d3.max(data, function(d) { return d.readable_time; }),
      "value": 85
      }   
  ] 
```

（我做了一些其他的转换以确保一切正常）

现在，在我想要将这条最小线添加到可视化之前，我只是执行以下操作来创建区域和线图，这很有效：

```
svg.select("path.area").data([data]);
svg.select("path.line").data([data]); 
```

脚本后面还有一些其他的绘图代码：

```
svg.select("path.area").attr("d", area);
svg.select("path.line").attr("d", line); 
```

我读过的所有 d3.js 示例都说要创建多行，您只需要使您的数据数组具有您想要绘制的所有数据集，所以在我上面的示例中，这是：

```
svg.select("path.line").data([data]); 
```

变成：

```
svg.select("path.line").data([data, min_data_return]); 
```

这应该有效。然而，事实并非如此。我看到像以前一样绘制的数据集线，但不是 min_data_return 线。

任何想法我做错了什么？

要点在这里：[https ://gist.github.com/2662793](https://gist.github.com/2662793)

在 Gist 中，查看第 133 - 140 行（搜索注释字符串 OPTION）。这些是与使其正常工作相关的唯一行。为了完整起见，我将整个脚本放入 Gist 中。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T15:51:39.950

与其尝试将参考线和数据线一起绘制，不如考虑分别绘制：

```
svg.append("svg:path")
    .attr("class", "minline")
    .attr("clip-path", "url(#clip)");   
...
svg.select("path.minline").data([min_data_return]);
...
svg.select("path.minline").attr("d", line); 
```

JSfiddle 这里有完整的例子：http: [//jsfiddle.net/qAHC2/6/](http://jsfiddle.net/qAHC2/6/)

# facebook - FB.Canvas 在控制台中未定义

> ID：10559481
> 
> 赞同：0
> 
> 时间：2012-05-11T22:44:06.447
> 
> 标签：facebook, facebook-canvas

我正在尝试使用 Javascript 在我的 Facebook 画布应用程序中调整 iFrame 的大小。我知道如何在代码中做到这一点 - 它工作正常。

但是，出于测试目的，我似乎无法让它在控制台中工作。在控制台中，`FB`已定义但未定义`FB.Canvas`（最接近的是`FB.CanvasClient`）。这是为什么？如何在控制台中测试 iFrame 调整大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T07:03:38.197

您必须在内部`fbAsyncInit`和之后运行 FB.Canvas `FB.init`，
始终用于`window.fbAsyncInit`在 api 加载后运行初始化代码。

```
//initializing API
window.fbAsyncInit = function() {
    FB.init({
        appId      : APP_ID,
        status     : true,
        cookie     : true,
        xfbml      : true
    });

    FB.Canvas.setSize({ width:810, height:850 });
    FB.Canvas.setAutoGrow();
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:52:57.033

您可以通过 developer.facebook.com 调整 IFrame 的大小

从您正在使用的应用程序中单击高级。在该页面中，您将看到画布大小。让它流动。

# php - 恶意用户如何利用输入键？

> ID：10559482
> 
> 赞同：23
> 
> 时间：2012-05-11T22:44:17.247
> 
> 标签：php, security, input

在[CodeIgniter](http://en.wikipedia.org/wiki/Codeigniter#CodeIgniter) PHP 框架中，有一个函数会在每个请求上自动运行，除其他外，[过滤 GET/POST/COOKIE 数组键](http://codeigniter.com/user_guide/libraries/input.html)，并在遇到它认为不安全的字符时终止应用程序。

> 为了防止恶意用户尝试利用密钥，我们确保密钥仅以字母数字文本和其他一些项目命名。

就像是：

```
// foreach GET/POST/COOKIE keys as $str...
if ( ! preg_match("/^[a-z0-9:_\/-]+$/i", $str))
{
    exit('Disallowed Key Characters.');
} 
```

例如，如果您不小心发布了类似`<input name="TE$T">`的内容或有类似的查询字符串，这将触发`?name|first=1`。

我可以看到这是强制执行常识键名或在开发应用程序时发现错误的好方法，但我不明白：例如，恶意用户如何可能“利用`$_POST`数据中的键”？特别是因为（我会假设）输入*值*同样可以利用，这实际上阻止了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-11T23:38:44.763

你经常在新手代码中看到这个垃圾：

```
$_SESSION = $_POST; 
```

一个鲜为人知的秘密是[`$_SESSION`“特殊”并且不能将管道字符](https://bugs.php.net/bug.php?id=33786),处理`|`为顶级数组键。php 在关机/session_write_close 期间无法保存会话变量，而是擦除整个数组。

```
session_start();

if (!isset($_SESSION['cnt'])) {
    $_SESSION['cnt'] = 0;
}

$_SESSION['cnt']++;

/* prior to php 5.4, it will never increment, because it never successfuly saves
unless you comment line below
*/
$_SESSION['a|b'] = 1;

print_r($_SESSION); 
```

我并不是说这就是 CodeIgniter 清除键的原因，但它是许多“可利用输入键的方式”之一。

也许一个更可能的原因是因为人们肯定会做这样的事情：

```
if ($formPostDidntValidate) {
    echo "Please fix the form submission errors and try again\n";
    foreach ($_POST as $key => $value) {
        echo "<p>$key<br>
              <input name='$key' value='$value'></p>";
    }
} 
```

输出请求变量而不进行适当的特定于上下文的转义，例如转义 html 上下文、html 属性上下文，甚至 sql 上下文：

```
$sql = "select * from myTable where 1=1";
foreach ($_POST as $key => $value) {
    $sql .= " and $key = '$value'";
} 
```

我见过很多人逃避价值，但不是构建 sql 和/或 html 时的关键。

如果你不逃避一切，你很容易被黑客入侵。清理值不如转义，但总比没有好，而且考虑到有多少开发人员还不够成熟，无法理解何时以及如何转义，我可以看到添加自动请求变量清理的吸引力。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-11T22:58:41.130

你的问题本身就提出了一个很好的观点：目前还不清楚*你*到底受到了什么保护。但它可以解决一些受欢迎的项目：

*   魔术语录
*   [最终可能导致SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)的事情
*   可以通过 shell 命令执行的字符串
*   可能与您的网址冲突的事情
*   可能与 HTML 冲突的东西
*   类似于目录遍历攻击的东西
*   [跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)(XSS) 攻击

但除此之外，我真的想不出为什么你总是为什么要保护 via `preg_match("/^[a-z0-9:_\/-]+$/i", $str)`。

我有一种感觉，他们*过度保护*只是因为 CodeIgniter 的使用如此广泛，以至于他们需要保护他们自己还没有想到的事情，因为他们的用户可能对此类攻击知之甚少。 CodeIgniter 的开发人员。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-11T22:58:14.127

在控制台中说我将表单的字段名称从更改`name="email"`为`name="email\"); DROP TABLE users;`

这不太可能是一次成功的 XSS 攻击，但我可以看到类似的东西会对编码不佳的 PHP 造成损害。CI 可能只是试图覆盖他们所有的基础，以便他们可以声称尽可能受到 XSS 保护。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-11T22:54:12.583

这种检查是浪费时间。无论如何，您只能访问您期望的键 - 如果由于某种原因您遍历所有元素，您很可能会正确地转义它们，无论您要对它们做什么。

然而，看看一个普通新手 PHP 程序员的技能（即使这个物种的成员很可能根本不使用框架）这是有道理的，你永远不知道他会用代码做什么讨厌的事情甚至可能在没有这样的检查的情况下杀死他的猫。

同样的事情也适用于拒绝包含例如“删除”作为反 SQL 注入措施的帖子。它很容易导致误报，如果您使用参数化查询，无论如何您都是安全的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-11T22:59:32.170

或许它正试图阻止[这种攻击](http://news.softpedia.com/news/PHP-Vulnerable-to-Algoritmic-Complexity-Attacks-243565.shtml)。

该攻击通过使用 PHP 如何构建其散列结构的知识来制作`$_POST`需要任意长时间来处理的密钥。

我怀疑它可能只是试图阻止更普通的 SQL 注入攻击。

# powershell - 使用 PowerShell 导入电子邮件地址时如何跳过 csv 中的空单元格？

> ID：10559486
> 
> 赞同：1
> 
> 时间：2012-05-11T22:45:02.793
> 
> 标签：powershell, exchange-server

我正在尝试运行以下脚本以在 powershell 中导入电子邮件地址：

```
Import-CSV "C:\AliasesTest.csv" | foreach-object {
    Set-Mailbox -Display Name $_.Name -EmailAddresses @{add=$_.Alias1,$_.Alias2,$_Alias3}} 
```

它工作正常，除非 csv 在 Alias 列之一下有一个空单元格，此时会产生以下错误：

```
"The address '' is invalid: "" isn't a valid SMTP address..: 
```

如何构建我的脚本以在遇到空单元格时忽略它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T01:15:40.657

检查每个属性（别名）以查看它是否为空，并且仅将具有值的属性添加到哈希表内的数组中：

```
Import-CSV "c:\AliasesTest.csv" | ForEach-Object {
    #Save the CSV row for use in another loop later
    $CSV = $_

    Set-Mailbox -DisplayName $_.Name -EmailAddresses @{add = ("Alias1","Alias2","Alias3" | ForEach-Object { $Csv.$_ } | Where-Object{$_}) }
} 
```

这种疯狂的做法是，创建一个新的哈希表，其键“add”具有子表达式的值。子表达式有一个属性名称数组，您要检查它是否迭代，将每个名称转换为该属性的值，然后过滤掉空的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T01:13:49.337

过滤别名以取出空的别名：

```
Import-CSV "C:\AliasesTest.csv" | foreach-object {
    $aliases = @($_.Alias1,$_.Alias2,$_Alias3) | where-object{$_};
    Set-Mailbox -Display Name $_.Name -EmailAddresses @{add=$aliases}} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T22:56:07.947

在这样之前使用`Where-Object`过滤器：`ForEach-Object`

```
Import-CSV "C:\AliasesTest.csv" | Where-Object {
        $_.Alias1 -and $_.Alias2 -and $_Alias3 
    } | foreach-object { $_ } 
```

如果别名'是空字符串，它们将被跳过。您不必`-and`全部使用它们，如果只有一个值可以更改为使用`-or`.

# actionscript-3 - FLV 播放全屏按钮不起作用

> ID：10559489
> 
> 赞同：0
> 
> 时间：2012-05-11T22:45:33.947
> 
> 标签：actionscript-3, flash-cs5, flvplayback

我正在构建一个 Flash 应用程序并使用 FLVPlayback 组件，当我单击控件上的按钮时，由于某种原因它没有扩展到全屏。

我的应用程序中只有播放器，所以我确信我在其他地方没有任何冲突的组件代码。

这就是我在文档类中得到的

```
flvPlayer.x = 0;
flvPlayer.y = 0;
flvPlayer.width = 640;
flvPlayer.height = 480;
flvPlayer.skin = "SkinOverPlaySeekFullscreen.swf";
flvPlayer.skinBackgroundColor = 0x999999;
flvPlayer.skinBackgroundAlpha = 0.7;
flvPlayer.skinAutoHide = true;
flvPlayer.source = "vid.flv";
addChild(flvPlayer); 
```

关于可能缺少什么的任何建议？

我 90% 确定我过去曾在一个项目中使用此设置使用 FLVPlayback，因此我倾向于认为缺少设置而不是代码错误。

我正在使用 Flash CS5 和 ActionScript 3，以及用于 AS 代码的外部类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:16:30.230

您必须创建带有参数的 html 包装文件：

```
<param name="allowFullScreen" value="true"/> 
```

然后尝试按 html 文档中的全屏按钮

如果您使用的是 Flash CS，在 Publish settings 中有 html 模板，里面有需要的参数。检查[adobe 全屏安全性](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7c5d.html)

# javascript - 离线 HTML 文档的 Javascript 可查询索引

> ID：10559492
> 
> 赞同：3
> 
> 时间：2012-05-11T22:46:00.973
> 
> 标签：javascript, search

我之前发布了一个类似的问题，但我认为我没有很清楚地解释我的要求。基本上，我有一个 .NET 应用程序，它写出一堆 HTML 文件......我还希望这个应用程序能够索引这些 HTML 文件以进行全文搜索，以便 HTML 文件中的 javascript 代码可以查询索引（基于用户在网络浏览器中*离线*查看文件时输入的搜索词）。

我们的想法是创建所有这些，然后复制到诸如拇指驱动器或 CD-ROM 之类的东西上，以便在具有 Web 浏览器但不一定可以访问 Internet 的设备上进行分发。

我使用 Apache Solr 进行概念验证，但这需要运行 Web 服务器。

我最接近可行的解决方案是 JSSindex (jssindex.sourceforge.net)，它使用 Lush，但我们的用户环境是 Windows，我们不想要求他们安装 Cygwin。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:51:32.930

看起来您的主要问题是让本地 HTML 可以访问索引。作弊方法：将索引放入 JS 文件并从 HTML 页面引用。

```
var index=[ {word:"home", files:["f.html", "bb.html"]},....]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T18:45:17.363

[Ladders](http://dev.theladders.com/archives/2006/11/introducing_javascript_fulltex_1.html) Could be a solution, as it provides on the spot indexing. But with 1,000 files or more, I dunno how well it'd scale... Sadly, I am not sure JS is the answer here. I'd go for a custom (compiled) app that served both as front-end (HTML display) and back-end (text search and indexing).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T23:51:11.960

使用[trie](http://en.wikipedia.org/wiki/Trie) - 它们非常紧凑且非常可扩展 - 对于文本匹配非常方便。

有一篇[很棒的文章](http://ejohn.org/blog/javascript-trie-performance-analysis/)涵盖了性能和设计策略。它们的启动速度比字典慢，但占用的空间要少得多，尤其是在处理更大的数据集时。

我将按如下方式处理它：

1.  在您的 .net 代码中索引所有对您很重要的关键字（跟踪它们的文档和偏移量）。
2.  使用 alpha 排序的关键字列表生成您的 trie 结构，
3.  用有关可以找到它们所代表的单词的文档的信息来装饰终端节点。

    ```
     C
     A
    R  T [{docid,[hit offsets]},...] 
    ```

您不必存储偏移量，但它允许您按接近度或顺序搜索单词。

您的 .net 人员可以构建 trie[示例代码](http://www.glennslayden.com/code/c-sharp/trie)。

生成地图需要一些时间，但是一旦完成并且您将其序列化为 JSON，您的 javascript 应用程序就会通过它。

# .net - 在 WCF REST 服务中管理身份验证的简单方法（如 OAuth 灯）？

> ID：10559493
> 
> 赞同：1
> 
> 时间：2012-05-11T22:46:15.193
> 
> 标签：.net, wcf, oauth

我有一个基于 REST 的 WCF Web 服务，目前受基本身份验证保护。它目前只接受一个用户 ID/密码组合，因为我仍处于测试阶段。
该组合现在只是存储在我`web.config`的。

至少在可预见的将来，我的 Web 服务不打算被多个客户端调用，并且没有不同范围的概念（您可以使用完全权限调用它，或者不能调用它全部）。

由于这些原因，我很犹豫是否按照我所描述的方式（例如[此处](http://blog.nerdbank.net/2011/06/what-is-2-legged-oauth.html)）实现一个成熟的 OAuth 提供程序，因为它似乎过于复杂，无法满足我的需要。

我已经看到 OAuth 提供者（例如通过 Yelp 的 API）以更简单的方式完成，提供者“离线”向消费者提供凭据，而消费者只使用这些凭据生成“符合 OAuth 的”请求。
不幸的是，我找不到有关如何执行此操作的任何详细信息，只有典型的 2 或 3 足 OAuth。

有什么好的建议吗？

# visual-studio-2010 - 如何安装和使用商业智能，而无需重新安装 Visual Studo 2008

> ID：10559500
> 
> 赞同：0
> 
> 时间：2012-05-11T22:47:12.783
> 
> 标签：visual-studio-2010, reporting-services, business-intelligence

几个月前，我从我的机器上卸载了 Business Logic，因为我不需要它。现在我想处理一些报告，但我无法在我的 Visual Studio 2010 安装中找到商业智能工具。

请问如何下载并加载到 Visual Studio 2010 或 SSMS 中使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:02:15.697

BIDS (SQL Server 2008/2008 R2) 和 SQL Server Data Tools (SQL Server 2012) 都是 SQL Server 安装程序（不是 Express Edition）的一部分，而不是 Visual Studio。

如果您使用的是 SQL Server 2008/08 R2，则商业智能工具将安装在使用 Visual Studio 2008 shell 的 Visual Studio 的单独“版本”中。这意味着，如果您正在运行 VS 2010，您实际上似乎安装了 2 个版本的 VS，VS 2010 用于您的所有普通开发和 VS 2008，它将仅包含 BI 项目类型）。

如果您使用的是 SQL Server 2012，BI 项目类型将使用 VS 2010 shell 安装，因此在您启动 VS 2010 时可以访问它们。

运行 SQL Server 安装过程并在安装向导的“功能安装”步骤中选择相关的 BI 组件（Analysis Services/Reporting Services/Integration Services）。

# ios - 如何让 iOS 应用从中断的地方开始

> ID：10559504
> 
> 赞同：1
> 
> 时间：2012-05-11T22:47:33.923
> 
> 标签：ios, xcode, storyboard, continue

我正在通过`UIStoryboard`模式制作一个iOS应用程序，我想知道是否有办法添加一些东西，所以当用户离开应用程序时，它会在用户下次启动应用程序时从离开的地方继续。顺便说一句，我正在制作一个`UIStoryboard`像我之前提到的只有简单页面的简单应用程序。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:59:18.753

查看 Apple 简要介绍此主题的文档中的此部分。

[保留应用程序用户界面的状态](http://developer.apple.com/library/ios/DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW8)

我认为这是你如何做到这一点的一般想法，Three20 框架通过使用 URL 来做到这一点，你也可以尝试采用这种设计。这并不是说你应该使用 Three20，但你可以从他们如何解决这个问题中获得一些想法。

[Three20 框架中的持久性](http://three20.info/showcase/persistence)

# facebook - 将您的页面选项卡应用程序添加到您的页面

> ID：10559508
> 
> 赞同：0
> 
> 时间：2012-05-11T22:48:14.403
> 
> 标签：facebook

您的[https://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID&next=YOUR_URL](https://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID&next=YOUR_URL)将我带到错误页面。

请指教。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:03:52.940

“下一个”应该是“redirect_uri”

https://www.facebook.com/dialog/pagetab?app_id=[APP-ID]&redirect_uri=[https://www.yourdomain

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T23:18:54.460

根据 Facebook，建议使用 &next= 参数：[https ://developers.facebook.com/docs/appsonfacebook/pagetabs/](https://developers.facebook.com/docs/appsonfacebook/pagetabs/)

![来自 Facebook 文档](../Images/562c623bf752ec2dde8f67bfc5467fee.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-02T16:58:50.060

你可以试试这个：

[https://www.facebook.com/dialog/pagetab?app_id=](https://www.facebook.com/dialog/pagetab?app_id=) {YOUR_APP_ID}&redirect_uri= [https://facebook.com](https://facebook.com)

希望有所帮助:)

# ios - 在 iOS 5.x 中增加 UITextView 中表情符号字符的字体大小

> ID：10559510
> 
> 赞同：8
> 
> 时间：2012-05-11T22:49:19.887
> 
> 标签：ios, ios5, fonts, uitextview, emoji

如果我有 UITextView 并将字体大小设置为 32。当我运行应用程序（在模拟器和设备上）时，我看到一个大光标和我输入的文本，就像我假设的那样。但是如果我切换表情符号键盘，它们会显示得很小。就像字体的大小从未增加一样。

我知道这些表情符号字体比例，因为我在 OSX Lion 中将它们放大到巨大的比例，如果我创建一个带有表情符号字符作为标签的 UIButton 并将字体设置为“Apple Color Emoji”并将大小设置为 64，它们在我的设备上看起来又大又漂亮。似乎只是 UITextView 没有调整它们的大小。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T01:06:02.217

您是否也尝试将 UITextView 的字体设置为 AppleColorEmoji？在 iOS 上，AppleColorEmoji 似乎是唯一可以绘制放大表情符号的字体。如您所见，使用任何其他字体，表情符号永远不会超过 20x20 像素。

我使用[这个名为 Fonts 的方便的免费应用程序进行了测试！](http://itunes.apple.com/us/app/fonts/id285217489?mt=8)，这是获得有关实际设备本身的快速反馈的好方法。

我注意到 Game Center 应用程序似乎能够将有趣的字体与放大的表情符号混合在一起，所以很明显它可能比（相当普通的）表情符号字体做得更好！不过，我不知道这是否是它的代码中的特殊之处，或者它使用的字体有什么特殊之处，它看起来像一个自定义字体。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-12-07T02:36:18.977

您可以使用任何字体缩放表情符号，即设置 UITextViews contentScaleFactor，然后使用 CGTransform 缩放文本字段。（您甚至可以将它们放大（具有高分辨率）比 AppleColorEmoji 允许您默认使用的更大。

```
float scaleFactor = 2.0f;
float resolutionFactor = 2.0f;

CGPoint tempCenter = theTextView.center;

theTextView.contentScaleFactor *= resolutionFactor;
theTextView.layer.contentsScale *= resolutionFactor;

for (UIView *subview in [theTextView subviews]) {
    subview.contentScaleFactor *= resolutionFactor;
    subview.layer.contentsScale *= resolutionFactor;
}

theTextView.transform = CGAffineTransformScale(CGAffineTransformIdentity, scaleFactor, scaleFactor);

theTextView.center = tempCenter; 
```

# android - 按钮自我“重新排列”

> ID：10559515
> 
> 赞同：0
> 
> 时间：2012-05-11T22:50:07.983
> 
> 标签：android, layout

想知道当用户使用 relativelayout 将他的设备从纵向变为横向时，我如何使用自动重新排列按钮构建布局？

我不想在我的布局上使用滚动并且我有很多按钮

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:54:59.980

您可以提供两个不同的 main.xml（或任何布局 xml 文件）将一个放在 res/layout/ 中，一个放在 res/layout-land/ 中 当设备切换方向时，系统将处理切换到相应文件的“魔术” .

* * *

这是[一些](http://developer.android.com/guide/practices/screens_support.html)有关支持这些类型行为的文档...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:00:40.920

如果我正确理解了您的问题，那么您要做的是为纵向模式显示一种布局，而为横向模式显示另一种布局。这实际上是相当容易实现的。

这是一个快速教程的链接： [如何在 Android 横向/纵向模式下更改布局](http://www.tekkie.ro/quick-n-dirty/how-to-change-your-layout-in-android-landscape-portrait-mode/)

# azure - 有没有办法在不编写程序代码的情况下调用 Windows Azure 服务管理 REST API

> ID：10559516
> 
> 赞同：0
> 
> 时间：2012-05-11T22:50:09.463
> 
> 标签：azure

我们正在寻找一种可以直接调用 Windows Azure 服务管理 REST API（即无需编写源代码）的工具，以便操作员可以轻松调用它们。

到目前为止，我们发现的是：

*   Fiddler 无法调用它们。[来源：[使用提琴手获取请求 URI 获取托管服务详细信息](https://stackoverflow.com/questions/8410794/get-hosted-service-details-with-get-request-uri-with-fiddler)]
*   cURL 可以调用它们。[来源：[http](http://social.msdn.microsoft.com/Forums/en-AU/windowsazuremanagement/thread/f1cf3322-a8e3-4179-a35e-6bfb2fd55075) ://social.msdn.microsoft.com/Forums/en-AU/windowsazuremanagement/thread/f1cf3322-a8e3-4179-a35e-6bfb2fd55075 ] 所以我们现在使用 cURL 但 cURL 是一个 CUI 程序但 GUI 程序是对于操作员来说更容易。我们需要额外的工作来将证书 (=.pfx) 转换为 .pem。

Windows Azure PowerShell Cmdlets ( [http://wappowershell.codeplex.com/documentation](http://wappowershell.codeplex.com/documentation) ) 现在也是我们的选择之一，但如果我们可以直接调用 REST API 会更好。原因是1）测试目的。有时我们想调用 REST API，而不是包装一个。2）在 Cmdlet 实现 REST API 之前有一些时间滞后。（如果我没记错的话，在引入 Storage Analytics 时，我们需要调用 REST API 才能使用它。但当时还没有 Cmdlet。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T22:52:24.193

使用 BURP 工具怎么样？Burp 是一个很棒的基于 Java 的工具，可以直接在 GUI 中使用 REST API。您可以使用 Burp 工具设置与 Azure 管理一起使用的 PFX 证书，然后只需键入 REST API 和参数即可发送请求并获得响应。

您可以下载以下工具：http: [//portswigger.net/burp/proxy.html](http://portswigger.net/burp/proxy.html)

我今天测试了该工具，然后写了以下博客来解释如何配置 Burp 以使用 REST API 管理 Windows Azure 订阅和服务。

[http://blogs.msdn.com/b/avkashchauhan/archive/2012/05/16/windows-azure-management-using-burp-java-based-gui-tool-and-rest-api.aspx](http://blogs.msdn.com/b/avkashchauhan/archive/2012/05/16/windows-azure-management-using-burp-java-based-gui-tool-and-rest-api.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T04:11:51.720

除了 Azure Powershell Cmdlets，查看 Cerebrata 的 Powershell Cmdlets @ [http://cerebrata.com/Products/AzureManagementCmdlets/](http://cerebrata.com/Products/AzureManagementCmdlets/)

# node.js - 基本 db-mysql 设置错误

> ID：10559518
> 
> 赞同：1
> 
> 时间：2012-05-11T22:50:13.763
> 
> 标签：node.js

我刚开始在我的项目中使用 node.js，并尝试连接到 MySQL 并插入基本值。但我不断收到以下错误：

```
node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: Unable to load shared library /Users/****/nodeJS/node_modules/db-mysql/build/Release/mysql_bindings.node
    at Object..node (module.js:472:11)
    at Module.load (module.js:348:31)
    at Function._load (module.js:308:12)
    at Module.require (module.js:354:17)
    at require (module.js:370:17)
    at Object.<anonymous> (/Users/****/nodeJS/node_modules/db-mysql/db-mysql.js:18:15)
    at Module._compile (module.js:441:26)
    at Object..js (module.js:459:10)
    at Module.load (module.js:348:31)
    at Function._load (module.js:308:12) 
```

我按照指示做了，我指定了 MYSQL_CONFIG 环境变量：

```
$ export MYSQL_CONFIG=/usr/local/mysql/bin/mysql_config 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:40:06.123

也许为时已晚，我希望你自己解决了这个问题，但它可能对遇到同样问题的其他人有用。

我为解决它所做的是设置以下变量：

```
export DYLD_LIBRARY_PATH=<your absolute path to mysql lib folder> 
```

就我而言，它是：

```
export DYLD_LIBRARY_PATH=/usr/local/mysql-5.5.25-osx10.6-x86_64/lib/ 
```

在 MacOS Lion 10.7.4 上测试

# c++ - throw()（即 __declspec(nothrow)）是否在 Visual C++ 中提供了真正的好处？

> ID：10559521
> 
> 赞同：13
> 
> 时间：2012-05-11T22:50:30.740
> 
> 标签：c++, visual-c++, exception

专注于 Visual C++，您是否体验过使用`throw()`（即`__declspec(nothrow)`）非抛出规范在 C++ 代码中的显着性能提升？它真的对优化器有帮助吗？是否有任何基准显示性能提升？

我在互联网上发现了不同的（相反的）建议：

[Boost exception-specification 的基本原理](http://www.boost.org/development/requirements.html#Exception-specification)是*反对* 的，相反，Larry Osterman在他的博客文章中`throw()`似乎*支持它：* [Why add a throw() to your methods？](http://blogs.msdn.com/b/larryosterman/archive/2006/03/22/558390.aspx)

（我想澄清一下，**我对 VC++ 特定代码感兴趣**；我知道在 GCC 中，`throw()`由于运行时检查，规范实际上可能是“悲观化”。）

**PS**阅读 ATL 标头，我发现它`throw()`被普遍使用；[此外，我在这篇 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/hh288076.aspx)中发现了一个方便的 C++ RAII`unique_handle`类，它也使用了规范。`throw()`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T09:49:38.130

MSVC 编译器将其视为优化提示，是的。

Boost 必须是跨平台的，它们必须在各种编译器上寻找安全且高效的东西。正如 boost 文档所说，*某些*编译器在指定时可能会生成较慢的代码`throw()`，并且在许多情况下，编译器可以推断出*无论*是否有`throw()`规范都不会引发异常，因此对于 Boost，最安全的方法是永远不要使用投掷规格。

但是，如果您专门针对 MSVC，则`throw()`有效地告诉编译器不要为函数生成异常处理代码，这可能会在函数过于复杂而编译器无法确定不会抛出异常的情况下加快速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T08:08:44.430

我添加了它，但它并不能帮助优化器帮助我编写更正确的代码。

```
class X
{
    public:
        void swap(X& rhs) throw(); // Swap better not ever throw
                                    // If it does there is something else
                                    // much more seriously wrong
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-12T10:26:23.667

主要问题`throw()`是标记为的函数内的代码`throw()` *可以*抛出。例如，这将完美地工作：

```
void foo() throw()
{
    throw "haha\n";
}

int main()
{
    try {
        foo();
    }
    catch(const char* s) {
        std::cout << s;
    }
    return 0;
} 
```

请注意，这 foo 不会`throw`，`main`原因。而且您不会捕获异常（就像您注释`throw()`说明符一样）。相反，编译器将使用`try{}catch()`块包装代码函数。生成异常时，它将由全局处理程序处理（这意味着您的程序默认崩溃）。

请注意，编译器*必须*用块包装函数代码`try{}cath()`，除非编译器确定，否则内部代码不可能产生异常。

结果，可以使用 的*调用者*进行一些优化，但*内部*`foo`的事情变得更加复杂。 *`foo`*

 ***编辑：**

事情`__declspec(nothrow)`有所不同：正如[Microsft 所说](http://msdn.microsoft.com/en-us/library/49147z04%28v=vs.71%29.aspx)，

> 这个属性告诉编译器声明的函数**和它调用的函数**永远不会抛出异常。

这意味着，编译器可以省略`try{}catch()`包装代码。

**EDIT2** 实际上，Microsoft 违反了标准行为并且不会为`throw()`. 那么，你可以使用它`throw()`来提高性能。*

# android - Android 如何阅读用户词典以扫描单词？

> ID：10559529
> 
> 赞同：2
> 
> 时间：2012-05-11T22:51:26.733
> 
> 标签：android, dictionary

我正在编写一个程序来帮助拼字游戏。我想利用用户字典来扫描。如何访问此文件以进行扫描？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T22:55:27.567

您将需要使用[UserDictionary](http://developer.android.com/reference/android/provider/UserDictionary.html)类。

下面是一个例子：[如何在 Android 上查询 UserDictionary 内容提供者？](https://stackoverflow.com/q/8282017/1267661)

这是一些 Android 文档：[Content Provider Basics](http://developer.android.com/guide/topics/providers/content-provider-basics.html)（它使用 UserDictionary 作为示例 ContentProvider，非常适合您的问题。）

# java - Java：需要标识符

> ID：10559539
> 
> 赞同：48
> 
> 时间：2012-05-11T22:52:38.017
> 
> 标签：java

这里有什么问题？

```
class UserInput {
  public void name() {
    System.out.println("This is a test.");
  }
}

public class MyClass {
  UserInput input = new UserInput();
  input.name();
} 
```

这抱怨：

```
<identifier> expected
   input.name(); 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-11T22:55:39.087

将您的代码放入方法中。

试试这个：

```
public class MyClass {
    public static void main(String[] args) {
        UserInput input = new UserInput();
        input.name();
    }
} 
```

然后从你的 IDE 中“运行”这个类

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-05-11T22:54:04.637

您不能在方法之外调用方法。像这样的代码不能在类中浮动。

你需要类似的东西：

```
public class MyClass {

  UserInput input = new UserInput();

  public void foo() {
      input.name();
  }
} 
```

或在构造函数中：

```
public class MyClass {

  UserInput input = new UserInput();

  public MyClass() {
      input.name();
  }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-11T22:54:26.763

`input.name()`需要在函数内部；类包含声明，而不是随机代码。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-11T22:56:19.693

尝试这样，将您的 myclass 项目移动到 main 方法中：

```
 class UserInput {
      public void name() {
        System.out.println("This is a test.");
      }
    }

    public class MyClass {

        public static void main( String args[] )
        {
            UserInput input = new UserInput();
            input.name();
        }

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-22T22:12:06.920

我在方法中的代码中看到了这个错误；但是，它位于 try-with-resources 块中。

以下代码是非法的：

```
 try (testResource r = getTestResource(); 
         System.out.println("Hello!"); 
         resource2 = getResource2(r)) { ... 
```

print 语句是什么使它非法。print 语句之前和之后的 2 行是资源初始化部分的一部分，所以它们很好。但是这些括号内不能有其他代码。在此处阅读有关“try-with-resources”的更多信息：[https ://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html](https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)

# mysql - 性能最佳的 MySql 'Friend' 表

> ID：10559546
> 
> 赞同：1
> 
> 时间：2012-05-11T22:53:30.777
> 
> 标签：mysql, join, union

我在使用这种结构构建的社交类型网络上有一个朋友表：

```
uid binary(16) 
memberid int 
friendid int 
datefriended datetime 
isactive bool 
```

这样，我将关系和其他数据仅存储在一个表中。但是说我需要得到我所有的朋友，无论我是friender（memberid）还是friendee（friendid），那么我需要从members表中获取用户名。查询是这样的：

```
SELECT m.name FROM members m
INNER JOIN friends f on m.memberid = f.friendid
WHERE f.memberid = 1

UNION ALL

SELECT m.name from members m
INNER JOIN friends f on m.memberid = f.memberid
WHERE f.friendid = 1 
```

如果您有很多用户和朋友提取这些数据，这对我来说似乎是对数据库的资源密集型调用。我知道可以选择为每个朋友关系设置一对条目，但我试图在一次查询中执行此操作。您对如何改进查询或表结构以提高性能有任何想法。或者也许它不会像我预想的那么糟糕？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T23:00:35.070

除了我上面建议您在`friends.memberid`,`friends.friendid`和上创建索引的评论之外`members.memberid`，您根本不需要`UNION`：

```
SELECT m.name
FROM members AS m JOIN friends AS f
  ON (m.memberid, 1) IN ((f.friendid, f.memberid), (f.memberid, f.friendid)) 
```

# asp.net-mvc - MVC 3 - 数据库上下文 - Web.Config

> ID：10559547
> 
> 赞同：1
> 
> 时间：2012-05-11T22:53:48.353
> 
> 标签：asp.net-mvc, asp.net-mvc-3, dbcontext

如何在不创建多个连接的情况下在我的 web.config 中共享我的 DBcontext？

```
WEB.config:
    <configuration>
      <connectionStrings>
        <add name="daC_Companies" connectionString="Data Source=10.0.2.100;Initial Catalog=XXXXX;User ID=XXXXXXXXXx;Password=XXXXXXXX;Persist Security Info=False" providerName="System.Data.SqlClient" />
      </connectionStrings>

Data Access:
        public class daC_Companies : DbContext
        {
            public DbSet<ClassLibrary.Companies.C_Companies> dbsetC_Companies { get; set; }
        } 
```

然后我有一个上面引用的名为 C_Companies 的类。它工作得很好，但我不想为我想访问的每个类都有一个新的 DBContext。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:12:15.440

DbContext 应该特定于数据库，而不是对象。要添加对更多 db 表的引用，请将它们作为属性添加到 daC_Companies 对象中：

```
 public class daC_Companies : DbContext
    {
        public DbSet<ClassLibrary.Companies.C_Companies> dbsetC_Companies { get; set; }
        public DbSet<ClassLibrary.Companies.Object2> Object2s { get; set; }
        public DbSet<ClassLibrary.Companies.Object3> Object3s { get; set; }
        public DbSet<ClassLibrary.Companies.Object4> Object4s { get; set; }
    } 
```

# connection - 从来自 NSUrlRequest 的 httpcontext 获取变量

> ID：10559551
> 
> 赞同：0
> 
> 时间：2012-05-11T22:18:47.057
> 
> 标签：connection, http, c#, asp.net, objective-c

这个问题将是 Iphone 和 asp.net 服务器之间的 http 连接“POST”的一个很好的教程 :) 我想要做的是将图像从 iphone 发送到 Asp.net 服务器；这是我在objective-c中的uploadImage函数：

```
- (IBAction)uploadImage {
/*
 turning the image into a NSData object
 getting the image back out of the UIImageView
 setting the quality to 90
*/
NSData *imageData = UIImageJPEGRepresentation(image.image, 33);
// setting up the URL to post to
NSString *urlString = @"MyWebServiceUrl";

// setting up the request object now
NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
[request setURL:[NSURL URLWithString:urlString]];
[request setHTTPMethod:@"POST"];

/*
 add some header info now
 we always need a boundary when we post a file
 also we need to set the content type

 You might want to generate a random boundary.. this is just the same 
 as my output from wireshark on a valid html post
*/
NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
[request addValue:contentType forHTTPHeaderField: @"Content-Type"];

/*
 now lets create the body of the post
*/
NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];    
[body appendData:[[NSString stringWithString:@"Content-Disposition: form-data; filepath=\"ProfilePic\"; filename=\"ipodfile\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[NSData dataWithData:imageData]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
// setting the body of the post to the reqeust
[request setHTTPBody:body];

// now lets make the connection to the web
NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];

NSLog(@"%@", returnString); 
```

}

这是我的 webService 函数，它解析发送的数据并保存文件：

```
public class SaveData : IHttpHandler
{

    public void ProcessRequest(HttpContext context)
    {
        context.Response.ContentType = "text/plain";
        bool hasErrors = false;
        HttpFileCollection filesPosted = context.Request.Files;
        String filePath = context.Request.QueryString["filepath"];
        String fileName = context.Request.QueryString["filename"];
        try
        {
            if (String.IsNullOrEmpty(fileName) || String.IsNullOrEmpty(filePath) || filesPosted.Count <= 0)
                hasErrors = true;

            if (!hasErrors)
            {
                HttpContext.Current.Response.Write(WriteFile(filesPosted[0], filePath, fileName));
            }
            else
            {
                context.Response.Write("Failed: parsing error");
            }
        }
        catch (Exception ex)
        {
            context.Response.Write("Failed: exception error:::" + ex.Message);
        }

    }

    private string WriteFile(HttpPostedFile file, String filePath, String fileName)
    {
        System.IO.Directory.CreateDirectory(filePath);
        int counter = 0;
        string path = String.Format("{0}\\{1}.jpg", filePath, fileName);
        while (System.IO.File.Exists(path))
        {
            counter++;
            path = String.Format("{0}\\{1}-{2}.jpg", filePath, fileName, counter);
        }

        file.SaveAs(path);
        return path;
    }

    public bool IsReusable
    {
        get
        {
            return false;
        }
    }
} 
```

我的问题来自这两行

```
 String filePath = context.Request.QueryString["filepath"];
        String fileName = context.Request.QueryString["filename"]; 
```

context.Request.QueryString 返回 null 所以我的 hasErrors 是假的；任何如何解决这个问题的想法将不胜感激，谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T04:52:00.430

查询字符串从 Url 参数中填充 (http://someserver.com/foobar?field1=value1&field2=value2)

要访问在 POST 正文中发送的表单数据，请使用`Request.Form["filepath"]`或简写`Request["filepath"]`，它在 Form、QueryString、Cookies 和 ServerVariables 集合中查找项目。

发布文件的数据可以在`Request.Files`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T09:46:11.453

经过一天的尝试后，这里的解决方案：

客户端代码：

```
// post body
NSMutableData *body = [NSMutableData data];

// add params (all params are strings)
[body appendData:[[NSString stringWithFormat:@"--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"%@\"\r\n\r\n", @"filename"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithFormat:@"%@\r\n", imageName] dataUsingEncoding:NSUTF8StringEncoding]];

// add image data
if (imageData) {
    [body appendData:[[NSString stringWithFormat:@"--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"myImage\"; filename=\"image.jpg\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithString:@"Content-Type: image/jpeg\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:imageData];
    [body appendData:[[NSString stringWithFormat:@"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
} 
```

Asp.net 服务器代码：

```
String filePath = context.Request.Form["filename"]; 
```

希望你喜欢这个问题（教程）；）

# .htaccess - 使用 HTACCESS 删除文件夹

> ID：10559552
> 
> 赞同：1
> 
> 时间：2012-05-11T22:54:08.600
> 
> 标签：.htaccess, apache

当用户访问以下网址时：

```
http://mysite.com/folder/subfolder?a=blah&b=blah 
```

我需要将它们指向根文件夹中的内容，同时保持变量不变：

```
http://mysite.com/?a=blah&b=blah 
```

由于[http://mysite.com](http://mysite.com)是一个虚拟主机，因此该解决方案还应该不理会其他基本 URL。

我不希望进行完全重定向，因为我们在系统中使用日志跟踪，并且我们需要让标头为日志返回 200 代码（也许这无关紧要）。

我知道对于真正了解 .htaccess 重定向的人来说，这是一个相当简单的问题。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:20:37.830

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^mysite\.com$ [NC]
RewriteRule ^folder/subfolder/?$ / [L,NC] 
```

# character-encoding - 如何在 Python 中将字符串转换为 pdf 文件而不使用 HDD 上的临时 txt 文件？

> ID：10559554
> 
> 赞同：1
> 
> 时间：2012-05-11T22:54:13.877
> 
> 标签：character-encoding, pdf-generation, python-2.7

我有一个纯 txt 格式的大图书馆。我需要将这些文件转换为 pdf 格式（从Python 脚本**内部**，而不是从命令行），但之前我需要对原始文件的文本进行一些操作。我只是将文件的内容读入字符串，进行所需的更改，然后我想将更改后的字符串输出到 pdf 文件中，但**不在**HDD 上创建临时文本文件。有没有办法做到这一点？

提前致谢。

PS BTW，图书馆是俄语的，所以我想我需要处理编码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T06:46:53.787

使用 ReportLab 工具包：[http](http://www.reportlab.com/software/opensource/rl-toolkit/) ://www.reportlab.com/software/opensource/rl-toolkit/ （它也在 PyPi 上：pip install reportlab；或者如果您正在运行 Linux，请使用包管理器）

PDF 的默认内置字体不支持俄语，因此您必须执行以下操作：

```
canvas.setFont('DejaVuSans',10) 
```

（将“DejaVuSans”替换为您知道其中包含您的字符的已安装字体名称）。这将在您的 PDF 中包含该字体，并使生成的文件比没有字体大 20K 左右。如果有必要，也可以将 PDF 生成到内存中。

# c# - WCF 传递文件流

> ID：10559555
> 
> 赞同：3
> 
> 时间：2012-05-11T22:54:17.180
> 
> 标签：c#, wcf, filestream

据我所知，当我将文件放入文件流时，该文件不存在于内存中。但是，当我将该文件流从我的客户端传递给我的服务时，客户端是否将文件放在内存中，然后才将字节 [] 发送到服务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T23:01:06.717

WCF 中有 2 种模式：[流式传输与缓冲传输](http://msdn.microsoft.com/en-us/library/ms789010.aspx)。您正在寻找流传输模式以避免将整个数据加载到内存中：

> Windows Communication Foundation (WCF) 可以使用缓冲或流传输来发送消息。在默认的缓冲传输模式下，消息必须在接收者可以读取之前完全传递。在流传输模式下，接收方可以在消息完全传递之前开始处理消息。当传递的信息很长并且可以串行处理时，流模式很有用。当消息太大而无法完全缓冲时，流模式也很有用。
> 
> 要启用流式传输，请适当定义 OperationContract 并在传输级别启用流式传输。

# orbeon - 在应用程序/myApp/subFolder 下的 Orbeon 上创建应用程序

> ID：10559557
> 
> 赞同：1
> 
> 时间：2012-05-11T22:54:22.647
> 
> 标签：orbeon

我在 WAS 7.1 下使用 Orbeon 3.7.0 beta1。

`orbeon.war/WEB-INF/resources/apps/myApplication/myUser/`我有一个将 XForms（XHTML 和 page-flow.xml）放在Orbeon 部署项目下的外部应用程序。

我的问题是 Orbeon 仅读取`page-flow.xml`它是否位于“apps/myApplication/”下，因为 Orbeon 的默认行为就是这样。

如果我的应用程序位于子文件夹下，我如何访问它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T00:06:32.790

嵌套页面流的处理方式并没有什么神奇之处。顶级页面流通过顶级 page-flow.xml 中的以下规则分派到子页面流：

```
<page id="apps"
  path-info="/([^/]+)/.*"
  matcher="oxf:perl5-matcher"
  model="apps/${1}/page-flow.xml"/> 
```

您应该能够编写类似的规则，但更深一层。我还没有尝试过，但是是这样的：

```
<page id="apps2"
  path-info="/([^/]+)/([^/]+)/.*"
  matcher="oxf:perl5-matcher"
  model="apps/${1}/${2}/page-flow.xml"/> 
```

# jquery - jQuery UI 在溢出的 Div 中可选

> ID：10559559
> 
> 赞同：2
> 
> 时间：2012-05-11T22:54:28.150
> 
> 标签：jquery, html, jquery-ui, selectable

我们有一个项目列表，我们需要允许用户选择多个项目。除了使用带有 multiselect 属性的默认 html 选择元素之外，我们还想使用 jQuery UI 可选交互。我们已经把它全部连接起来，它工作得很好，除非项目列表很长，我们把它放在一个 div 中，它会在一定高度溢出。问题是，如果用户单击并拖动以选择列表中的多个项目，并且他们希望能够选择不可见但在 div 溢出部分中的项目，如果他们将鼠标向下拖动到 div 之外，它不会像普通的多选元素那样自动滚动到 div 的“隐藏”部分。

我毫不怀疑我们可以处理 div 的 mousemove 或 mouseleave 事件并手动滚动它，但我想知道是否有任何人知道自动执行此操作的方法或最简单的方法是什么。

这是一个 jsfiddle 显示什么不起作用：http: [//jsfiddle.net/CAZxk/](http://jsfiddle.net/CAZxk/)

如果您单击项目 1 并向下拖动，一旦您离开演示 div，我希望 ul 滚动以便项目 6、7 等开始显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T02:17:21.737

这很容易从可排序插件中的代码转换。我只是把它放在可选择的“开始”功能中：

```
$(window).mousemove(function(e) {

    var sensitivity = 10, speed = 20, $d = $(document);

    if (e.pageY - $d.scrollTop() < sensitivity) {

        $d.scrollTop($d.scrollTop() - speed);    // scroll up

    } else if ($(window).height() - (e.pageY - $d.scrollTop()) < sensitivity) {

        $d.scrollTop($d.scrollTop() + speed);    // scroll down

    }

    if (e.pageX - $d.scrollLeft() < sensitivity) {

        $d.scrollLeft($d.scrollLeft() - speed);  // scroll left

    } else if ($(window).width() - (e.pageX - $d.scrollLeft()) < sensitivity) {

        $d.scrollLeft($d.scrollLeft() + speed);  // scroll right

    }

}); 
```

并在可选择的“停止”功能中关闭监听器：

```
$(window).unbind('mousemove'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T11:22:29.537

这是 jQuery UI Selectable 插件的一个已知问题 -

> [http://bugs.jqueryui.com/ticket/3223](http://bugs.jqueryui.com/ticket/3223)。

jQuery UI Sortable 确实提供了这个功能，所以你可以看看那里做了什么来提供帮助。jQuery UI 票有一个链接，其中包含用于在 Sortable 中实现此功能的源代码。

# scala - 如何让 Squeryl 与 Play 一起工作！框架？

> ID：10559562
> 
> 赞同：8
> 
> 时间：2012-05-11T22:54:53.710
> 
> 标签：scala, playframework, playframework-2.0, squeryl

我正在尝试学习如何使用 Play 和 Squeryl 制作一个简单的数据库应用程序。我已经从 Play 教程中制作了 Tasks 应用程序，但我想更改模型/架构，以便它使用 Squeryl 而不是 Anorm。我一直在查看不同的[教程](http://squeryl.org/getting-started.html)、示例和[答案](https://stackoverflow.com/a/9706308/1390113)，但我还没有真正弄清楚如何做到这一点。

**因此，鉴于[Play Tutorial (ScalaTodoList)](http://www.playframework.org/documentation/2.0.1/ScalaTodoList)的源代码；我如何继续使它与 Squeryl 一起工作？**

## 进一步来说：

*   如何在我的模型中实现`all()`、`create()`和`delete()`方法？（我想为任务使用自动递增的 ID）
*   使用哪个数据库适配器当前是硬编码的`Build.scala`（`Global.scala`见下文）。我怎样才能让它自动使用 H2 进行开发/测试和 Heroku 上的 Postgres，就像 Play 教程中的 Anorm 一样？
*   如何确保它自动创建我的表？

* * *

# 这是我到目前为止所做的

我已经完成了 Play ScalaTodoList 教程。

在`project/Build.scala`,`object ApplicationBuild`中，我添加了依赖项：

```
// From the "Squeryl Getting Started tutorial"
val posgresDriver = "postgresql" % "postgresql" % "8.4-702.jdbc4"
val h2 = "com.h2database" % "h2" % "1.2.127"

// From the "Squeryl Getting Started tutorial"
libraryDependencies ++= Seq(
  "org.squeryl" %% "squeryl" % "0.9.5",
  h2
)

// From the Play tutorial
val appDependencies = Seq(
  // Add your project dependencies here,
  "org.squeryl" %% "squeryl" % "0.9.5", // Copied from above so that it compiles (?)
  "postgresql" % "postgresql" % "8.4-702.jdbc4"
) 
```

添加`app/Global.scala`（取自上面提到的[SO 答案](https://stackoverflow.com/a/9706308/1390113)，只是将适配器更改为 H2）：

```
import play.db.DB
import play.api.Application
import play.api.GlobalSettings
import org.squeryl._
import org.squeryl.adapters._

object Global extends GlobalSettings {

  override def onStart(app: Application): Unit =
  {
    SessionFactory.concreteFactory = Some(
      () => Session.create(DB.getDataSource().getConnection(),
        dbAdapter));
  }

  override def onStop(app: Application): Unit =
  {
  }

  val dbAdapter = new H2Adapter(); // Hard coded. Not good.

  } 
```

在中，`app/models/Task.scala`我添加了导入并删除了`all()`、`create()`和中的 Anorm 实现`delete()`。Play 教程中的控制器期望该`all()`方法返回`List[Task]`。

```
import org.squeryl.PrimitiveTypeMode._
import org.squeryl.Schema
import org.squeryl.annotations.Column

case class Task(id: Long, label: String)

object Task extends Schema {
  val tasks = table[Task] // Inspired by Squeryl tutorial

  def all(): List[Task] = {
          List[Task]() // ??
  }

  def create(label: String) {
// ??
  }

  def delete(id: Long) {
// ??
  }
} 
```

其余文件保留在 Play 教程结束时的状态。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-12T00:09:12.673

这是一个使用 Squeryl 的 Play 2 项目示例：
[https ://github.com/jamesward/play2bars/tree/scala-squeryl](https://github.com/jamesward/play2bars/tree/scala-squeryl)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T08:57:09.723

“Play for Scala”（MEAP）一书中有一章介绍了 Squeryl 集成

[http://www.manning.com/hilton/](http://www.manning.com/hilton/)

# javascript - 如何使用 Raphael.js 在每次鼠标点击时触发旋转动画？

> ID：10559568
> 
> 赞同：1
> 
> 时间：2012-05-11T22:55:30.460
> 
> 标签：javascript, animation, svg, rotation, raphael

所以我一直在研究这个问题，但又遇到了另一个障碍。

本质上，我试图让鼠标点击触发一组用 Raphael.js 绘制的 svg 对象的旋转动画。虽然我已经解决了实际的动画，但我似乎无法让它在随后的点击中运行……只运行一次就可以了。

所以我想有一些我忽略的代码......或者在应用动画之后的坐标变化之后动画可能会中断？反正我是懵逼...

这是[JSFiddle 演示](http://jsfiddle.net/H3GGERS/A5GZL/)。

这是代码：

```
var rsr = Raphael('rsr', 320, 240),
    circle_01 = rsr.circle(160, 120, 20).attr({fill:"#666666"}),
    circle_02 = rsr.circle(160, 220, 20),
    circle_03 = rsr.circle(160, 20, 20),
    circle_04 = rsr.circle(20, 120, 20),
    circle_05 = rsr.circle(300, 120, 20),
    group = rsr.set();

group.push(
    circle_02, 
    circle_03, 
    circle_04, 
    circle_05
);

var aa = group.getBBox();

circle_01.click(function() {

    var group_x_center = aa.x + (aa.width / 2),
        group_y_center = aa.y + (aa.height / 2);

    group.animate({
        transform: group.attr("transform") + "R360," 
            + group_x_center + "," 
            + group_y_center
    }, 1000); 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:59:26.400

我认为您看到的问题是，当您第一次运行动画时，它会旋转您的集合所需的度数 - 然后当随后触发相同的动画时，它什么也不做，因为集合已经旋转到那个角度。

我会通过附加到转换而不是绝对设置来解决这个问题：

```
group.animate({transform: group.attr("transform") + "...R45,"+group_x_center+","+group_y_center}, 1000); 
```

或者，您可以跟踪当前角度，在每次点击时增加它，然后进行可变设置——但这可能需要更多工作 =)

# unix - 哪些 POSIX 系统调用可能会阻塞进程？

> ID：10559570
> 
> 赞同：2
> 
> 时间：2012-05-11T22:55:40.097
> 
> 标签：unix, posix, blocking, nonblocking

是否有参考文档描述了 POSIX 系统调用的阻塞行为？

到目前为止，我的启发式方法是标记为可能阻止任何可能失败的函数`EINTR`？这是一个充分必要条件吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-12T13:08:08.503

坦率地说，据我所知，只需查看`man`页面并使用常识即可。即使调用没有指定 EINTR，也要考虑它的作用。我可能是错的，但在我看来，POSIX 库中的每个调用默认情况下都会阻塞，并且如果您也询问它（通过各种标志）只会在非阻塞模式下执行，但我还没有看到一个取消阻塞的调用默认情况下（*除了*取消阻止之外，它会做任何事情）。

# flash - AS2：FLVPlayback 组件 contentPath 相关性

> ID：10559577
> 
> 赞同：0
> 
> 时间：2012-05-11T22:57:27.990
> 
> 标签：flash, actionscript-2, relative-path, flvplayback

我有一个加载 XML 文件的网站，该文件告诉在哪里可以找到要加载到主 SWF 中的资产。图像和外部 SWF 可以正确加载，但由于某种原因，除非 contentPath 是绝对路径，否则 FLV 根本不会加载，而我不能在这个项目中拥有它。我也制作了相对于 HTML 页面的链接。

**我的文件结构是这样的：**

index.html -- 主加载器文件

project/shared/published/section1/loader.swf -- 要加载的主要 SWF

project/english/images/videos/welcome.flv -- 要加载的电影。

FLVPlayback contentPath 的路径是否可能是相对于 SWF 而不是 HTML 页面？任何帮助将不胜感激。

**加载视频的页面代码**

导入 mx.video.*；

```
import mx.video.*;
playback1.contentPath = getNodeValue(findNode(videos, "one"));

// Assign the mySeekBar instance to the flvPlayback instance
playback1.playPauseButton = playpause;
playback1.backButton = myrewind;
playback1.seekBar = seekbar_container.myseek;
playback1.bufferingBar = mybuffer; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T11:08:24.177

希望这会对您有所帮助。我创建了一个测试，这就是我所拥有的：

文件夹设置：

flash/application/ - loader.swf 和 index.html

闪光/电影/-movie.flv

我使用的路径是 - ../movies/movie.flv

代码示例是：

```
/**
  Requires:
   - FLVPlayback component on the Stage with an instance name of my_FLVPlybk
*/
import mx.video.*;
my_FLVPlybk.contentPath = "../movies/movie.flv";
var listenerObject:Object = new Object();
listenerObject.metadataReceived = function(eventObject:Object):Void {
    my_FLVPlybk.setSize(my_FLVPlybk.preferredWidth, my_FLVPlybk.preferredHeight);
}
my_FLVPlybk.addEventListener("metadataReceived", listenerObject); 
```

我把它上传到我的本地主机，它工作正常。

我还通过将应用程序文件夹外的索引移动到 flash 文件夹来测试它，这表明 FLV 确实是相对于 swf 而不是 html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T11:12:47.043

FLV 文件的路径是相对于 .swf 文件的。

其他文件的路径是相对于 .html 文件的。

不仅在组件中，而且在一般情况下。

# vb.net - 检查哪个复选框被循环选中

> ID：10559588
> 
> 赞同：2
> 
> 时间：2012-05-11T22:59:52.753
> 
> 标签：vb.net, forms, checkbox, for-loop

在 Visual Basic 表单面板中检查复选框并查找已选中的语法是什么？我了解如何使用 for 循环和 if 语句，但我对检查每个复选框的语法感到困惑。例如：

```
Dim i As Integer
For i = 1 To 10
    'Here is where my code would go. 
    'I could have ten checkboxes named in sequence (cb1, cb2, etc), 
    'but how could I put i inside the name to test each checkbox?
Next 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T23:17:10.857

您需要遍历已添加 Checkbox 的控件的 Controls 集合。每个 Control 对象都有一个 Controls 集合。在这种情况下，我更喜欢 For Each 循环，因此我无需使用 Controls 索引即可立即获得 Control 如果您的 CheckBoxes 直接添加到 Panel 中，最简单的方法是..

```
For Each ctrl As var In panel.Controls
    If TypeOf ctrl Is CheckBox AndAlso DirectCast(ctrl, CheckBox).IsChecked Then
        'Do Something
    End If
Next 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T23:10:45.463

我对 VB.Net 语法不是很熟悉，但在伪代码中：

```
ForEach CheckBox in ControlContainer
  DoSomething
Next 
```

如果您将所有 CheckBox 控件放在一个容器中 - 例如 a **-**那么`Panel`上面的代码将迭代每个.**`CheckBox`**

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T05:35:23.197

尝试这个 ：

```
Protected Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
            If CheckBoxList1.Text = "" Then
                do/display something
                Exit Sub
            Else
                For Each item As ListItem In CheckBoxList1.Items
                    If item.Selected Then
                        do/display something
                    End If
                Next
            End If
        End Sub 
```**

# python - 将输出文件添加到 Python 扩展

> ID：10559589
> 
> 赞同：4
> 
> 时间：2012-05-11T22:59:54.590
> 
> 标签：python, pip, setuptools, distutils, python-extensions

我已经定义了一个自定义`build_ext`来构建一个我试图使 pip 友好的时髦扩展。以下是我正在做的精简版。

```
foo_ext = Extension(
  name='foo/_foo',
  sources=foo_sources,
)

class MyBuildExt(build_ext):
  def build_extension(self, ext):
    # This standalone script builds the __init__.py file 
    #  and some .h files for the extension
    check_call(['python', 'build_init_file.py'])

    # Now that we've created all the init and .h code
    #  build the C/C++ extension using setuptools/distutils
    build_ext.build_extension(self, ext)

    # Include the generated __init__.py in the build directory 
    #  which is something like `build/lib.linux-x86/foo/`.  
    #  How can I get setuptools/distutils to install the 
    #  generated file automatically?!
    generated_file = 'Source/foo/__init__.py'
    output_path = '/'.join(self.get_outputs()[0].split('/')[:-1])
    self.move_file(generated_file, output_path)

setup(
    ...,
    ext_modules = [foo_ext],
    cmdclass={'build_ext' : MyBuildExt},
) 
```

在打包这个模块并用 pip 安装它之后，`foo`我的 virtualenv 的 site-packages 目录中有一个模块。目录结构如下所示。

```
foo/
foo/__init__.py
foo/_foo.so 
```

该`egg-info/SOURCES.txt`文件**不包括**`__init__.py`我手动创建/移动的文件。当我执行`pip uninstall foo`命令时，命令会留`foo/__init__.py`在我的 virtualenv 的站点包中。我想 pip 删除整个包。如何将`__init__.py`我手动移动到构建目录的生成文件添加到已安装的输出文件列表中？

我意识到这是令人作呕和骇人听闻的，所以我欢迎恶心和骇人听闻的答案！

## 尝试：

1.  添加`packages=['foo']`-当我这样做时，pip 不会构建扩展。还尝试调整包名称的文件路径/命名空间版本——没有区别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T04:34:19.347

为了让 distutils 安装 Python 包，您需要传递`packages=['foo']`，并且如果您将它放在不是项目根级别的地方（我的意思是 setup.py 脚本旁边的 foo 目录），就像您看起来的那样要做到这一点，你还必须通过`package_dir={'foo': 'Source'}`或使用更简单的布局。如果您的 setup.py 脚本包含此`packages`参数，则 build 命令将调用 build_py 命令将 Python 源文件（和目录）移动到 build 目录，稍后将由 install 命令复制该目录。

这里的问题是您的`foo/__init__.py`文件是由 build_ext 命令构建的，该命令在 build_py 之后运行。您需要使用自定义构建命令覆盖它：

```
class MyBuild(build):
  sub_commands = [('build_clib', build.has_c_libraries),
                  ('build_ext', build.has_ext_modules),
                  ('build_py', build.has_pure_modules),
                  ('build_scripts', build.has_scripts),
                 ]

setup(..., cmdclass={'build': MyBuild, 'build_ext': MyBuildExt}) 
```

The elements in the sub_commands attribute are tuples of (command name, function to call to decide whether to run the command or not); this is documented in the source code but I don’t remember if it’s explained in the doc. In the standard build class build_py precedes build_clib. I may change this in the next version of Python 2.7, as it was reported that it interacted badly with 2to3 conversion.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T03:56:24.783

首先，您的 Extension 实例中的 name 参数应该是模块名称 (foo._foo)，而不是路径。

您是否尝试将 packages=['foo'] 添加到您的设置调用中？

# c# - RadioButtonList SelectedIndexChanged 事件未触发

> ID：10559590
> 
> 赞同：0
> 
> 时间：2012-05-11T22:59:59.040
> 
> 标签：c#, asp.net, .net

我在 asp 视图控件上有单选按钮列表。我在运行时动态填充单选按钮列表。但 selectedindexchange 事件未触发。我尝试启用自动回发，page.oninit 但它没有触发。

```
<asp:MultiView ID="MultiView1" runat="server">
            <asp:View ID="View1" runat="server">
                <br />
                <asp:Label ID="Label1" runat="server" Text="Label" CssClass="text"></asp:Label>
                &nbsp;<asp:Label ID="Label2" runat="server" Text="Label" CssClass="text"></asp:Label>

                <br />
               <asp:RadioButtonList ID="RadioButtonList1" runat="server" AutoPostBack="True" 
                    onselectedindexchanged="RadioButtonList1_SelectedIndexChanged1">
                </asp:RadioButtonList>
                <br />

                <p align="center">
                    <asp:Button ID="Button1" runat="server" Text="Previous" onclick="Button1_Click" Width="100px" />&nbsp;&nbsp;&nbsp;&nbsp;
                    <asp:Button ID="Button2" runat="server" Text="Next" onclick="Button2_Click" Width="100px" />
                </p>

            </asp:View>
    </asp:MultiView> 
```

我的 onpage_load 代码

```
if (!IsPostBack)
        {
            cnn.Open();
            cmd.Connection = cnn;

            cmd.CommandText = "SELECT ")";
            adp.SelectCommand = cmd;
            adp.Fill(ds);
            cnn.Close();

            dt = new DataTable("Answered");
            dt.Columns.Add("Serial", typeof(int));
            dt.Columns.Add("question", typeof(string));
            dt.Columns.Add("opt1", typeof(string));
            dt.Columns.Add("opt2", typeof(string));
            dt.Columns.Add("opt3", typeof(string));
            dt.Columns.Add("opt4", typeof(string));
            dt.Columns.Add("answer", typeof(int));
            dt.Columns.Add("selected", typeof(int));

            foreach (DataRow r in ds.Tables[0].Rows)
            {
                dr = dt.NewRow();
                dr["Serial"] = dt.Rows.Count + 1;
                dr["question"] = r["question"];
                dr["opt1"] = r["opt1"].ToString();
                dr["opt2"] = r["opt2"].ToString();
                dr["opt3"] = r["opt3"].ToString();
                dr["opt4"] = r["opt4"].ToString();
                dr["answer"] = Convert.ToInt16(r["answer"].ToString());
                dr["selected"] = -1;
                dt.Rows.Add(dr);
            }
            Session["Answered"] = dt;
            Show();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:08:18.677

May be you lost event handler for your `RadioButtonList`. You can create it by double cliking on it in Design view. this will create event handler for it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:10:32.560

我相当确定您`RadioButtonList`在回发时也重新绑定了数据。只做那个`if(!IsPostBack)`。

```
protected void Page_Load(Object sender, EventArgs e)
{
    if(!IsPostBack) 
        BindRadioButonList();
} 
```

否则不会触发事件。

# python - 从一个部分中提取一个单词加上 20 个以上（python）

> ID：10559591
> 
> 赞同：4
> 
> 时间：2012-05-11T23:00:15.407
> 
> 标签：python, nltk, extraction, gensim

Jep 仍然在玩 Python。

我决定尝试 Gensim，这是一个为选定的单词和上下文找出主题的工具。

所以我想知道如何在一段文本中找到一个单词并连同它一起提取 20 个单词（例如在那个特定单词之前的 10 个单词和那个特定单词之后的 10 个单词）然后将它与其他这样的提取一起保存，这样 Gensim 就可以运行它。

对我来说似乎很难的是找到一种方法来在找到所选单词时提取前后 10 个单词。我之前玩过 nltk，只需将文本标记为单词或句子，就很容易掌握句子。仍然在那个特定句子之前和之后得到那些单词或句子对我来说似乎很难弄清楚该怎么做。

对于那些感到困惑的人（这里是凌晨 1 点，所以我可能会感到困惑），我将举一个例子：

> 话音刚落，她的血液就涌上心头，因为听到白雪公主还活着，她很生气。“可是现在，”她心想，“我要不要做点什么，彻底毁掉她。” 说着，她用自己懂的术做了一把毒梳子，然后伪装成老寡妇的样子。她翻过七座小山来到七个小矮人的家，[15] 敲了敲门，喊道：“今天卖的好货！”

如果我们说这个词是白雪公主，那么我想提取这部分：

> 她的心，因为听到白雪公主还活着，她很生气。“可是现在，”她心想，“会

白雪公主前后各 10 个字。

如果这可以在 nltk 中完成并且更容易，那么在出现 Snow-White 的句子之前和之后获取句子也很酷。

我的意思是，如果有人可以帮助我，我会对这两种解决方案中的一种感到满意。

如果 Gensim 也可以做到这一点……而且这更容易，那么我也会对此感到满意。所以这 3 种方法中的任何一种都可以……我只是想尝试看看如何做到这一点，因为 atm 我的脑袋一片空白。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T23:20:20.547

该过程称为[上下文中的关键字（KWIC）](http://en.wikipedia.org/wiki/Key_Word_in_Context)。

第一步是将您的输入拆分为单词。[使用正则表达式模块](http://docs.python.org/library/re.html#module-re)有很多方法可以做到这一点，例如[re.split](http://docs.python.org/library/re.html#re.split)或[re.findall 。](http://docs.python.org/library/re.html#re.findall)

找到一个特定的单词后，您可以使用切片来查找之前的十个单词和之后的十个单词。

要为所有单词建立索引，带有 maxlen 的[*deque*](http://docs.python.org/library/collections.html#deque-objects)可以方便地实现滑动窗口。

[这是使用itertools](http://docs.python.org/library/itertools.html#module-itertools)有效地做到这一点的一种方法：

```
from re import finditer
from itertools import tee, islice, izip, chain, repeat

def kwic(text, tgtword, width=10):
    'Find all occurrences of tgtword and show the surrounding context'
    matches = (mo.span() for mo in finditer(r"[A-Za-z\'\-]+", text))
    padded = chain(repeat((0,0), width), matches, repeat((-1,-1), width))
    t1, t2, t3 = tee((padded), 3)
    t2 = islice(t2, width, None)
    t3 = islice(t3, 2*width, None)
    for (start, _), (i, j), (_, stop) in izip(t1, t2, t3):
        if text[i: j] == tgtword:
            context = text[start: stop]
            yield context

print list(kwic(text, 'Snow-White')) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-11T23:05:46.340

```
text = """
As soon as it had finished, all her blood rushed to her heart, for she was so angry to hear that Snow-White was yet living. "But now," thought she to herself, "will I make something which shall destroy her completely." Thus saying, she made a poisoned comb by arts which she understood, and then, disguising herself, she took the form of an old widow. She went over the seven hills to the house of the seven Dwarfs, and[15] knocking at the door, called out, "Good wares to sell to-day!"
"""
spl = text.split()

def ans(word):
    for ind, x in enumerate(spl):
       if x.strip(",'\".!") == word:
           break
    return " ".join(spl[ind-10:ind] + spl[ind:ind+11])

>>> ans('Snow-White')
her heart, for she was so angry to hear that Snow-White was yet living. "But now," thought she to herself, "will 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-23T14:06:30.530

只是想更新[Raymond Hettinger](https://stackoverflow.com/a/10559717/4691538)对 python 3 的精彩回答：

您所要做的就是更改`izip`为`zip`

```
from re import finditer
from itertools import chain, islice, repeat, tee

def kwic(text, tgtword, width=20):
'Find all occurrences of tgtword and show the surrounding context'
    matches = (mo.span() for mo in finditer(r"[A-Za-z\'\-]+", text))
    padded = chain(repeat((0,0), width), matches, repeat((-1,-1), width))
    t1, t2, t3 = tee((padded), 3)
    t2 = islice(t2, width, None)
    t3 = islice(t3, 2*width, None)
    for (start, _), (i, j), (_, stop) in zip(t1, t2, t3):
        if text[i: j] == tgtword:
            context = text[start: stop]
            yield context 
```

此外，为了完整起见，两者`NLTK`都`Texacity`内置了此功能；但是，两者都不像雷蒙德的答案那样有效，因为两者都使用**字符**数作为 window 而不是**tokens**。

## NLTK

```
import nltk

test = """
As soon as it had finished, all her blood rushed to her heart, for she was so angry to hear that Snow-White was yet living. "But now," thought she to herself, "will I make something which shall destroy her completely." Thus saying, she made a poisoned comb by arts which she understood, and then, disguising herself, she took the form of an old widow. She went over the seven hills to the house of the seven Dwarfs, and[15] knocking at the door, called out, "Good wares to sell to-day!"
"""

tokens = nltk.word_tokenize(test)
text = nltk.Text(tokens)
text.concordance('Snow-White', width=100)

Displaying 1 of 1 matches:
er heart , for she was so angry to hear that Snow-White was yet living . `` But now , '' thought she 
```

## 文本性

```
from textacy.text_utils import KWIC

test = """
As soon as it had finished, all her blood rushed to her heart, for she was so angry to hear that Snow-White was yet living. "But now," thought she to herself, "will I make something which shall destroy her completely." Thus saying, she made a poisoned comb by arts which she understood, and then, disguising herself, she took the form of an old widow. She went over the seven hills to the house of the seven Dwarfs, and[15] knocking at the door, called out, "Good wares to sell to-day!" 
"""

snow_white = KWIC(test, "Snow-White", window_width=50)
print(next(snow_white, ["Finished"]))

d to her heart, for she was so angry to hear that  Snow-White  was yet living. "But now," thought she to herself
['Finished'] 
```

# php - iframe 中的第三方 cookie 和 facebook 应用程序，getUser 失败

> ID：10559595
> 
> 赞同：1
> 
> 时间：2012-05-11T23:00:56.680
> 
> 标签：php, facebook

我有这个让我发疯的问题，我希望它也能帮助任何明白我观点的人。

在阅读了很多之后，显然过去的所有“黑客”（包括 p3p 标头）在下一次更新后不再在 safari 上工作，所以我重写了所有内容以在 GET 中附加会话 ID，一切都很好，除了显然没有第三方 cookie facebook 不再工作：

```
$user = $facebook->getUser();
        var_dump($user); 
```

这会在激活第三方 cookie 的情况下返回预期结果，而在没有激活 cookie 的情况下返回 int(0)，为什么？

有解决方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:09:57.587

Turn off cookies in the FB.init / new Facebook class, and record the access token instead. (getAccessToken). Pass that to your iFrame and use setAccessToken to set it just after initiating the Facebook class.

# bash - 如何用sed用空格替换不是字母的任何东西？

> ID：10559600
> 
> 赞同：1
> 
> 时间：2012-05-11T23:01:50.850
> 
> 标签：bash, sed

我需要从文件中删除不是字母、小写或大写的所有内容，并将其替换为空格，例如：

```
The bear ate 3 snakes, then ate 50% of the fish from the river. 
```

这变成：

```
The bear ate   snakes  then ate     of the fish from the river 
```

*   有时文件包含不寻常的字符。它保存为 UTF-8。

如何用空格替换任何非字母？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T23:33:56.930

如果你想支持 unicode 字母`(as mentioned in your question)`，那么这个 perl 命令替换所有`unicode non-letters`：

```
echo $line | perl -pe 's/[^\p{L}\s]+/ /g;' 
```

参考：[http ://www.regular-expressions.info/unicode.html](http://www.regular-expressions.info/unicode.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T23:10:43.103

```
$ echo "The bear ate 3 snakes, then ate 50% of the fish from the river." | sed "s/[^a-zA-Z]/ /g"
The bear ate   snakes  then ate     of the fish from the river 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-12T00:21:43.867

这可能对您有用：

```
echo 'The bear ate 3 snakes, then ate 50% of the fish from the river.' | 
tr -c '[:alpha:]' ' '
The bear ate   snakes  then ate     of the fish from the river 
```

或者：

```
echo 'The bear ate 3 snakes, then ate 50% of the fish from the river.' |
sed 's/[^[:alpha:]]/ /g'
The bear ate   snakes  then ate     of the fish from the river 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T23:09:46.863

尝试：

```
sed 's/[^A-Za-z]/ /g;' myfile.txt 
```

# java - 在 App Engine Java 开发服务器中，如何模拟并发线程以确保安全？

> ID：10559602
> 
> 赞同：4
> 
> 时间：2012-05-11T23:02:22.400
> 
> 标签：java, multithreading, google-app-engine, thread-safety

我读到 Google App Engine Java 开发服务器只运行一个 servlet 线程。

我想模拟两个并行运行的线程，以便在调试模式下我可以暂停其中一个并观察另一个的正确行为。

似乎当我放置断点并从 Chrome 中的两个不同选项卡进行调用时，其中只有一个中断。

这可能吗？我可以通过哪些其他方式模拟这样的场景来测试线程安全？

（特别是，我正在尝试观察 jdo 事务的行为）

ps 我`<threadsafe>true</threadsafe>`在 appengine-web.xml 中有

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T05:47:57.580

好的。问题是完全不同的。一定是 Chrome 不喜欢在一个挂起时向同一台服务器发送多个请求。从 Chrome 发送一个，从 Firefox 发送一个。所以毕竟，Google App Engine Java 开发服务器可以处理不同线程的并发请求。我读到的，是错误的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T03:19:49.123

如果可以接受命令行，您可以打开两个终端并在每个终端中使用[cURL](http://curl.haxx.se/docs/manpage.html)来访问您的 servlet。

# php - 获取 where 子句中的所有值

> ID：10559606
> 
> 赞同：0
> 
> 时间：2012-05-11T23:03:06.203
> 
> 标签：php, mysql

我在这段代码中遇到了麻烦，如果用户从选择下拉菜单中选择了“全部显示”，我只想从表行中获取所有数据。

这是选择菜单！

所以，这个菜单从这个表中获取数据，但是如果他选择全部，那么在选项值之间回显的合适代码是什么:)

```
<b>speciality:</b>  <select id="main_mav" name="speciality">
<option value="none">Select speciality:</option>
<option value=""> All specialities </option>
<?php

        $result = mysql_query('SELECT speciality FROM visits') or die(mysql_error());
        while ($row = mysql_fetch_assoc($result)) {
                echo '<option value="'.$row['speciality'].'">'.$row['speciality'].'</option>';
        }
?>
</select><br /> 
```

那是提交表格！

```
if ($region=="All regions" ){

              $region=$_POST['""'];  
            }
            else ( $region=$_POST['region']);

            $date1 =$_POST['from_date'];
            $date2 = $_POST['to_date'];
            $product=$_POST['product'];
            $speciality=$_POST['speciality'];
            $type=$_POST['visit_type'];

sql="SELECT id, customer_name, seller_1_name, seller_2_name FROM visits Where (speciality ='$speciality') AND (visit_type ='$type') AND (product ='$product') AND (region ='$region') AND (visit_date BETWEEN '$date1' AND '$date2')";
$result=mysql_query($sql); ## This line is new.
$num=mysql_numrows($result);
$row = mysql_fetch_array($result); 
```

如果用户选择“在下拉菜单中显示全部”，输入的正确代码是什么？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:07:55.870

You really need to sanitize your inputs, at least with [`mysql_real_escape_string`](http://php.net/manual/en/function.mysql-real-escape-string.php)!

On to your actual question: just check if `$speciality` is empty, and generate a different query without the `(speciality ='$speciality')` condition.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:10:59.740

由于您的 HTML 引用了“专业”，而您的 PHP 引用了“区域”，我将坚持使用“区域”，但这是我的想法。

```
 if ($region=="All regions" ){
        $sql = 'SELECT id, customer_name, seller_1_name, seller_2_name, FROM visits';
    } else {
        $region     = mysql_real_escape_string($_POST['region']);
        $date1      = mysql_real_escape_string($_POST['from_date']);
        $date2      = mysql_real_escape_string($_POST['to_date']);
        $product    = mysql_real_escape_string($_POST['product']);
        $speciality = mysql_real_escape_string($_POST['speciality']);
        $type       = mysql_real_escape_string($_POST['visit_type']);
        $sql        = "SELECT id, customer_name, seller_1_name, seller_2_name FROM visits Where (speciality ='$speciality') AND (visit_type ='$type') AND (product ='$product') AND (region ='$region') AND (visit_date BETWEEN '$date1' AND '$date2')";
    }

$result = mysql_query($sql); ## This line is new.
$num    = mysql_numrows($result);
$row    = mysql_fetch_array($result); 
```

# iphone - 使用 SDK 获取从上传图像到 Dropbox 的 URL 链接

> ID：10559607
> 
> 赞同：2
> 
> 时间：2012-05-11T23:03:06.310
> 
> 标签：iphone, metadata, response, dropbox

使用 SDK 将图像上传到文件夹我想获取图像的原始链接。我已经使用以下方法从 DMMetaData 中搜索了元数据。DBMetaData 拥有多种方法，例如“root”和“content”，但我总是收到 Null 响应。如果有人能引导我朝着正确的方向从响应中获取该信息，将不胜感激！

```
-(void)uploadImage:(UIImage *)image{

[sounds PlayUploading:nil];

NSLog(@"upload from uploader!~");
NSData *data = UIImagePNGRepresentation(image);
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, 
NSUserDomainMask, YES);
NSString *path = [[paths objectAtIndex:0] stringByAppendingString:@"PreviewMaker.png"];

[restClient setDelegate:self];

[data writeToFile:path atomically:YES];
[[self restClient] uploadFile:@"PreviewMaker.png" toPath:@"/"
                withParentRev:nil fromPath:path]; 

 }

 -(void)restClient:(DBRestClient *)client uploadedFile:(NSString *)destPath 
 from:(NSString *)srcPath metadata:(DBMetadata *)metadata{

 NSLog(@"uploaded: %@ from %@ withData %@",destPath,srcPath,metadata.root);

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-12T13:35:32.197

在 DropBox 中获取文件的可共享链接！

DBRESTClient.h 中有一个方法，你应该看看！

```
- (void)loadSharableLinkForFile:(NSString *)path; 
```

以及他们的委托方法！！

```
- (void)restClient:(DBRestClient*)restClient loadedSharableLink:(NSString*)link 
forFile:(NSString*)path;
- (void)restClient:(DBRestClient*)restClient loadSharableLinkFailedWithError:(NSError*)error; 
```

示例：让我们考虑一下我的 Dropbox 中有一个文件 MyContacts 然后共享它，

```
[[self restClient] loadSharableLinkForFile:@"/MyContacts"]; 
```

及其委托方法

```
- (void)restClient:(DBRestClient*)restClient loadedSharableLink:(NSString*)link 
           forFile:(NSString*)path
{

    NSLog(@"Sharable link %@",link);
    NSLog(@"File Path %@ ",path);
}

- (void)restClient:(DBRestClient*)restClient loadSharableLinkFailedWithError:(NSError*)error
{
    NSLog(@"Error %@",error);
} 
```

# asp.net - 根据登录控制中输入的用户名和密码授予对相应asp页面的访问权限

> ID：10559612
> 
> 赞同：0
> 
> 时间：2012-05-11T23:04:03.880
> 
> 标签：asp.net

我的 ASP.NET Web 应用程序项目中有两个文件夹“Admin”和“User”文件夹。在Admin文件夹下有一个“Admin.aspx”页面，在User文件夹下有一个“User.aspx”页面。我在 Account 文件夹下还有另一个名为“Login.aspx”的页面。对于这个登录页面，我使用了工具箱中的内置登录控件。根据字段中给出的 ID 和密码，必须调用相应的网页。例如，当我输入用户名“admin”和密码“password” **（基本上是管理员用户）**时，它应该加载 Admin.aspx 页面。另一方面，当用户名是“mike”，密码是“mike123”时**（基本上是普通用户）**，应用程序应该加载 User.aspx 页面。我已经使用“ASP.NET 配置”向导为“Admin”和“User”文件夹创建了所需的访问规则。我的问题是根据输入的 id 和密码映射相应的 aspx 页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:55:57.657

您的问题有点含糊，我假设您使用的是标准的 SqlMembership 提供程序和表单身份验证。

使用网站管理工具来管理您的登录提供了身份验证机制。我建议配置和使用用户角色来定义对网站功能的访问。

根据角色重定向到特定页面如下所示： 处理 Login 控件的 LoggedIn 事件。

```
protected void LoginControl_LoggedIn(object sender, EventArgs e)
{
    try
    {

       if (HttpContext.Current.User.IsInRole("Site Admin"))
       {
          Response.Redirect("~/Admin/Admin.aspx");
       }
       else if  (HttpContext.Current.User.IsInRole("User")) 
       {
          Response.Redirect("~/User/User.aspx");
       }
    catch (Exception ex)
    {
       Debug.WriteLine("Exception in d: " + ex.Message);
       throw;
    }
} 
```

您还需要通过 web.config 提供对站点安全部分之外的 Login.aspx 页面的访问权限。

```
<authentication mode="Forms">
  <forms name="MyApplication" loginUrl="~/Account/Login.aspx" timeout="60">
  </forms>
</authentication> 
```

这只是您可以实施的众多解决方案之一。网上有很多资源可以帮助您实现这一目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:42:30.787

```
protected void Login1_LoggedIn(object sender, EventArgs e)
    {
        String[] users = Roles.GetRolesForUser(Login1.UserName);
        if (users.Contains("admin"))
        {
            Response.Redirect("~/Admin/Admin.aspx");
        }
        else if (users.Contains("users"))
        {
            Response.Redirect("~/Secure/User.aspx");
        }
    } 
```

# animation - 要学习哪个 3D（渲染和动画）程序？

> ID：10559613
> 
> 赞同：0
> 
> 时间：2012-05-11T23:04:16.777
> 
> 标签：animation, 3d, maya, 3dsmax

首先：我来自3D Cad背景（我是一名工程师），所以我在使用Catia，Solidworks等软件方面经验丰富......

现在，我也对 3D 动画内容非常感兴趣，例如短（电视）广告、品牌的 3D 徽标或网页上任何其他炫酷的东西。

非常简短的问题：你能给我一些关于学习哪些软件的提示吗？有太多的选择！:(

*   3dmax？
*   玛雅？
*   4D影院？
*   还有其他我可能不知道的软件吗？

你会推荐什么？

磷

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:18:05.383

[Maya](http://usa.autodesk.com/maya/)最常用于 3D 广告、短片和电影。如果您正在为您提出的问题寻找最相关的软件包，Maya 就是您想要的。我相信他们有免费试用版。

对于游戏开发，[3ds Max](http://usa.autodesk.com/3ds-max/)是最流行的软件包。

[Blender](http://www.blender.org/)有一个特殊的用户界面，但它是开源的并且可以免费使用；做专业品质的工作就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T23:07:29.480

You could do worse than try Blender ([http://www.blender.org](http://www.blender.org)) - it's free :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T16:45:11.320

另一个很棒的软件包是 Luxology Modo [http://www.luxology.com/](http://www.luxology.com/)

真的很棒的渲染。

# delphi - 有没有办法将宽字符串传递给 TStringStream？

> ID：10559618
> 
> 赞同：0
> 
> 时间：2012-05-11T23:05:06.313
> 
> 标签：delphi, delphi-6

我有这个德尔福功能：

```
function DevuelveResumenEventos(cnnBBDD : TADOConnection;sFecha,sHora,sCtrlPac : string) : TStream;
var
   sTextoArmado : string;
   stCarga : TStringStream;
begin
   with TADOTable.Create(Application.MainForm) do
   try
      sTextoArmado := '';
      Connection := cnnBBDD;
      TableName := 'EAPC_EVENTOS';
      Filter := 'EAPC_FECHA = '+sFecha+' and EAPC_HORA = '+sHora+' and EAPC_CTRL_PAC = '+sCtrlPac;
      Filtered := True;
      Open;
      while not Eof do
      begin
         sTextoArmado := sTextoArmado + FormatDateTime('dd-mm-yyyy', FieldValues['EAPC_FECHA_EVENTO'])+
                         ' '+MinutsToStr(FieldValues['EAPC_HORA_EVENTO'])+
                         '  ('+Trim(FieldValues['EAPC_LOGIN_USER'])+
                         ') - '+FieldByName('EAPC_EVENTO').AsString+CRLF+CRLF;

         Next;
      end;

      **stCarga := TStringStream.Create(sTextoArmado);
      with TRichEdit.Create(Application.MainForm) do
      begin
         Parent := Application.MainForm;
         Text := sTextoArmado;
         Lines.SaveToStream(stCarga);
         Free;
      end;
   finally
      Close;
      Free;
   end;
   Result := stCarga;**
end; 
```

目的是检索一系列 RTF 格式的文本，将它们与其他文本连接起来，并将它们返回到单个 TStringStream 中，以便在 TRichEdit 中以表单的形式显示。

如何跳过“使用即时 RichEdit”并将生成的文本作为 TStringStream 发送？

# php - PHP cURL JSESSIONID Cookie Error

> ID：10559624
> 
> 赞同：2
> 
> 时间：2012-05-11T23:06:22.080
> 
> 标签：php, cookies, curl, session-cookies

I wan't to login to a ssl site with my php script. If i load the page with the post login form i get a session cookie with the value

```
JSESSIONID=E180962D04FFCCDCEFF3ACA063347C23; Path=/qisserver; Secure 
```

And the source code of the page shows the session id in the form post destination:

```
<form method="post" action="https://foo.bar/baz;jsessionid=E180962D04FFCCDCEFF3ACA063347C23?state=user&amp;type=1&amp;category=auth.login&amp;startpage=portal.vm" name="loginform"> 
```

If I login i get a new session cookie with a location:

```
JSESSIONID=91E63CBCE0E309D5ACE2F609453E0D63; Path=/qisserver; Secure
Location=https://foo.bar/baz;jsessionid=91E63CBCE0E309D5ACE2F609453E0D63?state=user&type=0&category=menu.browse&startpage=portal.vm 
```

This is the process in my web browser so far. Now I wrote a php/curl script, which first connects, collects the first cookie and extracts the jsessionid value because it is a part of the form action url.

Second my script should login and store the new cookie but I get an error. I can't tell you more about the error.

Here is my php:

```
<?php

$username = "foo";
$password = "blubb";

# Define the target and referer web pages
$target = "https://foo.bar/rds?state=user&type=0";
$ref    = "https://foo.bar/rds?state=user&type=0";

$useragent = "User-Agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:13.0) Gecko/20100101 Firefox/13.0"; 

// GET JSESSION ID COOKIE START   //////////   //////////   //////////   //////////   //////////   //////////   //////////   //////////

$ch = curl_init();

    curl_setopt($ch, CURLOPT_COOKIEJAR, "cookies.txt");   // Cookie management.
    curl_setopt($ch, CURLOPT_COOKIEFILE, "cookies.txt");
    curl_setopt($ch, CURLOPT_COOKIESESSION, TRUE); 

    curl_setopt($ch, CURLOPT_HEADER, TRUE);
     curl_setopt($ch, CURLOPT_NOBODY, FALSE); // remove body 

    curl_setopt($ch, CURLOPT_TIMEOUT, 20);    // Timeout sek
    curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
    curl_setopt($ch, CURLOPT_URL, $target);             // Target site
    curl_setopt($ch, CURLOPT_REFERER, $ref);            // Referer value
    curl_setopt($ch, CURLOPT_VERBOSE, TRUE);           // Minimize logs
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);    // No certificate
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, TRUE);     // Follow redirects
    curl_setopt($ch, CURLOPT_MAXREDIRS, 5);             // Limit redirections to four
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);     // Return in string

    # Create return array
    $header   = curl_exec($ch); 

    # Close PHP/CURL handle
    curl_close($ch);
    unset($ch);
    $cookie = findSessionID($header);

function findSessionID($html){
    //extract session id value
    $begin = 'JSESSIONID=';

    $starnr = strpos($html,$begin);
    $starnr += strlen($begin);

    $laenge = 32;
    $id= substr($html,$starnr,$laenge); 
    return $id;
}
// GET JSESSION ID COOKIE END   //////////   //////////   //////////   //////////   //////////   //////////   //////////   //////////

sleep(2);

// LOGIN START  //////////   //////////   //////////   //////////   //////////   //////////   //////////   //////////

$formurl ="https://foo.bar/qisserver/rds?;jsessionid=".$cookie."&state=user&amp;type=1&amp;category=auth.login&amp;startpage=portal.vm";
$query_string = "username=".$username."&submit=%A0Ok%A0&password=".$password;

echo"<br> Rufe URL:   ". $formurl ." auf <br> mit Querystring:   ". $query_string ."<br>";

    $ch = curl_init();

    curl_setopt ($ch, CURLOPT_POSTFIELDS, $query_string);
    curl_setopt ($ch, CURLOPT_POST, TRUE); 
    curl_setopt ($ch, CURLOPT_HTTPGET, FALSE); 

    curl_setopt($ch, CURLOPT_COOKIEJAR, "cookies.txt");   
    curl_setopt($ch, CURLOPT_COOKIEFILE, "cookies.txt");
    curl_setopt($ch, CURLOPT_COOKIESESSION, FALSE); 

    curl_setopt($ch, CURLOPT_TIMEOUT, 20);   
    curl_setopt($ch, CURLOPT_USERAGENT, $useragent);   
    curl_setopt($ch, CURLOPT_URL, $formurl);          
    curl_setopt($ch, CURLOPT_REFERER, $ref);         
    curl_setopt($ch, CURLOPT_VERBOSE, TRUE);        
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);    
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, TRUE);   
    curl_setopt($ch, CURLOPT_MAXREDIRS, 5);          
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); 

    curl_setopt($ch, CURLOPT_HEADER, TRUE);   // Include head as needed
    curl_setopt($ch, CURLOPT_NOBODY, FALSE);
    # Create return array
    $html   = curl_exec($ch); 

    curl_close($ch);
    echo $html;

// LOGIN END  //////////   //////////   //////////   //////////   //////////   //////////   //////////   //////////

?> 
```

Thank you very much

# android - Problems using ViewPager Example

> ID：10559625
> 
> 赞同：0
> 
> 时间：2012-05-11T23:06:33.407
> 
> 标签：android, android-viewpager

I'm an android newbie trying to use the ViewPager control which is part of the "Compatibility Package."

I first used the SDK manager to install the Extras Support Package.

I then went to [https://github.com/commonsguy/cw-omnibus/tree/master/ViewPager/Fragments](https://github.com/commonsguy/cw-omnibus/tree/master/ViewPager/Fragments) and got the ViewPager project and loaded it into Eclipse.

I then added a libs folder to the project and put "android-support-v4.jar" into that directory.

I did a Clean build and got all sorts of errors. The screenshot of my project is at [http://dl.dropbox.com/u/39662979/viewpager.jpg](http://dl.dropbox.com/u/39662979/viewpager.jpg).

What have I faild to do? thanks, Gary Blakely

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:13:18.020

我已经看到您正在使用 SherlockActionBar 的一部分，但是必须将缺少的主题引用到一个未命中库。特别是您必须将 Jake Wharthon 的作品作为库项目导入，然后作为 android 库链接到您的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:09:00.347

Delete the Theme or add the theme to your styles.xml.

I do think you don't need the Theme if you only try to use ViewPager.

So delete it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T22:44:52.563

您可能正在寻找[ActionBarSherlock - 常见问题解答](http://actionbarsherlock.com/faq.html)。有一个视频可以帮助您开始使用图书馆

`import android.R;`PS 有的话别忘了删除

# php - PHP 打印消息

> ID：10559626
> 
> 赞同：0
> 
> 时间：2012-05-11T23:06:35.467
> 
> 标签：php

当用户单击按钮时，我想从 php 代码中打印一条消息。我在 php 中添加了代码，并放置了当用户单击按钮时执行的 if 条件。这是default.php的代码：

```
 <?php
if (isset($_POST['button1'])) {
echo '<b>Ok.</b>';
}
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script type="text/javascript">

</script>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>PHP3</title>
</head>

<body>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

<form id="form1" name="form1" method="post" action="default.php">
  <p>
    <label for="textfield1">User Name</label>
    <input type="text" name="username" id="username" />
  </p>
  <p>
    <label for="textfield2">Password</label>
    <input type="password" name="password" id="password" />
  </p>
  <p>
    <input type="submit" name="button1" id="button1" value="Submit"  />
    <br />
    <br />
  <label id="label1">
  </label></p>
  <p>&nbsp;</p>
</form>
<p>&nbsp;</p>

</body>
</html> 
```

应该打印“Ok”。但我看不到“好的”消息被打印出来。

我能做些什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:54:30.900

你可以尝试添加`<?php phpinfo(); ?>`你的身体标签吗？它应该确认您的服务器上是否安装了 php。

编辑，刚刚看到你的最后一条消息，如果你的服务器没有运行 PHP，那么你必须安装它才能达到你想要的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:09:34.747

您应该自行提交表格或将其留空。检查表单操作并确保您发布到正确的 php 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T23:37:22.377

您在 DOCTYPE 声明之前回显“Ok”——可能它就在那里，而您在浏览器中看不到它。您是否尝试过查看源代码并确保您的“Ok”不存在？

您可能希望将 php 代码移动到文档的正文部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-12T00:20:11.727

如果您说当您在 Web 浏览器中单击查看源代码时看不到 PHP 代码，则说明您的服务器上没有安装 PHP。您需要 PHP 来运行此脚本。您需要与您的网络主机取得联系，或者如果它是您自己的，则在您的网络服务器上启用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-12T00:25:52.193

如果您只是在本地测试您的 PHP 文件，然后尝试安装[XAMMP](http://www.apachefriends.org/en/xampp-windows.html)以再次测试您的 php 文件，如果它有效，那么之前没有安装 PHP。XAMMP 包括 PHP、MySQL 和 Apache。

# php - 如何使用 PHP 跳过 MySQL 表的记录？

> ID：10559628
> 
> 赞同：-1
> 
> 时间：2012-05-11T23:07:08.077
> 
> 标签：php, mysql

我正在尝试使用 PHP 让 MySQL 将前 5 个条目跳过到名为“blog”的表中，然后列出第 6 到第 10 个条目。

我的意思是，如果表“blog”中有 10 个条目，“id”-> 1、2、3、4、5、6、7、8、9、10，我希望 PHP 跳过“ id" 6 到 10，然后回显 "id" 1 到 5。

这是我目前拥有的代码。我应该如何编辑它来实现它？

```
$sql="SELECT * FROM blog ORDER BY id DESC;";
$result=mysqli_query($mysqli,$sql); 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:08:52.217

`LIMIT`正是用于此。它的用法[在 MySQL 文档中的](http://dev.mysql.com/doc/refman/5.5/en/select.html)[文章`SELECT`](http://dev.mysql.com/doc/refman/5.5/en/select.html)中进行了描述。

```
SELECT * FROM blog ORDER BY id DESC LIMIT 5 
```

# exception-handling - Business logic exception.example

> ID：10559630
> 
> 赞同：0
> 
> 时间：2012-05-11T23:07:13.787
> 
> 标签：exception-handling, n-tier-architecture

I have this scenario in my 3-tier app with a Service Layer that serves to a MVC presentation layer:

I have an operation that creates, for example, an Employee whose email must be unique in the set of Employees. This operation is executed in the MVC presentation layer through a service.

How do I manage the intent to create a Employee whose email is already registered in the Database for another Employee?

I am thinking in 2 options:

1) Have another operation that queries if there's an Employee with the same email given for the new Employee.

2) Throw an exception in the service CreateEmployee for the duplicate email.

I think it is a matter of what I think is best or most suitable for the problem. I propose the 1) option because I think that this is a matter of validation. But the 2) option only needs *1* call to the service, therefore its (?) more efficient.

What do you think?

Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T23:19:35.850

我肯定会选择第二种选择：

*   正如您所提到的，它避免了对服务的 1 次调用
*   它只使用一种创建员工的方法来保持您的服务界面清洁
*   从事务的角度来看，它是一致的（异常意味着“事务失败”）。请记住，验证不仅是导致交易失败的众多原因之一。
*   想象一下您的验证约束不断发展（例如：其他员工属性......），您不会想让您的所有实现仅为此而发展。

需要记住的一点：确保让你的异常足够详细，以清楚地识别失败的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T23:19:08.730

如果“演示”层的真正意思是演示，那么您不应该在该层创建新员工。您应该只准备在 HTTP 响应对象中清晰呈现的任何数据。

通常，考虑此类问题的一个好方法是考虑如果被命令行程序调用，您的服务对象应该做什么：

```
> createEmployee allison.brie@awesome.com
  Error! 'allison.brie@awesome.com' is already registered. 
```

其中有一些终端管理层调用该服务。该服务会做一些事情来实现另一个用户使用相同的电子邮件，并抛出一个适当的异常（即`DuplicateUserException`）。然后终端管理层解释该异常并打印出来`"Error! " + exception.getMessage();`

也就是说，请注意您的两个选项实际上是相同的选项。您的服务仍必须查询数据库中的重复项。虽然这是“验证”，但它不是输入验证。输入验证意味着检查它是否是有效的电子邮件地址。（是否有“@”符号和有效的 TLD？）

# javascript - Is there a CSS-only (no JavaScript) solution to fit variable content to a vertical grid?

> ID：10559634
> 
> 赞同：1
> 
> 时间：2012-05-11T23:07:54.410
> 
> 标签：javascript, html, css

I've got a small issue with a [website](http://westerndesigndays.com/) I'm currently working on, that doesn't bother me too much, but would be nice to fix. We've designed the site (along with the rest of the advertising for this event) to be based on a strict square grid. Everything is working just fine, except for one little problem:

At the bottom of the page, we have a few paragraphs of body copy that are throwing off the page by a third of a grid square. (We have the line-height of the text to be a third of a grid square) Short of Javascript calculations, is there any way we can add some sort of "smart" padding to the bottom of these paragraphs to re-align the next elements to the grid?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T23:39:24.093

> 有什么办法可以在这些段落的底部添加某种“智能”填充以将下一个元素重新对齐到网格？

我不认为有一个纯粹的 CSS 修复，特别是当您考虑到不同的浏览器/操作系统可能会以稍微不同的高度呈现文本时。

我可以添加到我的答案中的唯一另一件事是您不想要的 JavaScript 修复：

```
document.body.style.height = Math.round(document.body.offsetHeight/72)*72 + "px"; 
```

至少它很短。

# mongodb - MongoDB Assertion Error: starting_from == self.__retrieved (pymongo driver)

> ID：10559638
> 
> 赞同：-1
> 
> 时间：2012-05-11T23:08:32.573
> 
> 标签：mongodb, replication, pymongo, sharding, assertion

MongoDB Question:

We're using a sharded replicaset, running pymongo 2.2 against mongo (version: 2.1.1-pre-). We're getting a traceback when a query returns more than one result document.

```
Traceback (most recent call last):
File "/usr/lib64/python2.6/threading.py", line 532, in __bootstrap_inner
  self.run()
File "/opt/DCM/mods/plugin.py", line 25, in run
  self._mod.collect_metrics_dcm()
File "/opt/DCM/plugins/res.py", line 115, in collect_metrics_dcm
  ms.updateSpecificMetric(metricName, value, timestamp)
File "/opt/DCM/mods/mongoSaver.py", line 155, in updateSpecificMetric
  latestDoc = self.getLatestDoc(metricName)
File "/opt/DCM/mods/mongoSaver.py", line 70, in getLatestDoc
  for d in dlist:
File "/usr/lib64/python2.6/site-packages/pymongo/cursor.py", line 747, in next
  if len(self.__data) or self._refresh():
File "/usr/lib64/python2.6/site-packages/pymongo/cursor.py", line 698, in _refresh
  self.__uuid_subtype))
File "/usr/lib64/python2.6/site-packages/pymongo/cursor.py", line 668, in __send_message
  assert response["starting_from"] == self.__retrieved
AssertionError 
```

The code that give what dlist is is a simple find(). I've tried reIndex(), no joy. I've tried stopping and starting the mongo server, no joy.

This is easily replicable for me. Any ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T01:12:54.623

这是 mongos 2.1.1 开发版本中的一个错误。见[https://jira.mongodb.org/browse/SERVER-5844](https://jira.mongodb.org/browse/SERVER-5844)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T14:22:56.760

好的，所以稍微追踪了一下，我有一个解决这个断言错误的方法。

**Mongo中有一个BUG。** 查询分片副本集时，Mongo 返回的“starting_from”值不正确。它不是在第一个查询中返回 0，而是返回接收到的记录数而不是偏移值。我有一个 pymongo 补丁来防止这种不良信息：

文件是 site-packages/pymongo/cursor.py。

```
[user@hostname]$ diff cursor.py.orig cursor.py
631,632c631,634
<         if not self.__tailable:
<             assert response["starting_from"] == self.__retrieved
---
>   if ((not self.__tailable) and (self.__retrieved != 0) and (response["starting_from"] != self.__retrieved)):
>             from pprint import pformat
>             msg = "Server response of 'starting_from' is '%s', but self__retrieved (which is only set to nonzero below here) is '%s'." % (pformat(response), pformat(self.__retrieved))
>             assert False, msg 
```

'starting_from' 来自 helpers.py 解码来自 Mongo 的响应：

```
result["starting_from"] = struct.unpack("<i", response[12:16])[0] 
```

所以，这是 Mongo 响应的第 12 到第 15 个字节。

# iphone - 已识别 UITavleViewCell 标签中的点击手势，但也不选择单元格

> ID：10559641
> 
> 赞同：1
> 
> 时间：2012-05-11T23:08:54.513
> 
> 标签：iphone, objective-c, ios, storyboard

我有一个与`UITableViewCell`新视图控制器相连的自定义。当点击手势发生时，segue 工作，但总是从唯一的第一个单元格传递数据，无论在哪个单元格中执行了 tapGesture。但是，当我第一次选择标签之外的单元格时，tapGestureRecognizer，然后执行点击手势，数据成功通过 b/c 我首先选择了相应的单元格。`UITapGestureRecognizer``UILabel`

如何将 tapGesture 设置为也识别单元格选择？

PS我在情节提要中设置了手势和segue，而不是代码。另外，我的数据传递代码是我的 prepareForSegue 方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T01:58:15.463

您的问题对细节有点轻，但让我问：您是否在代码中确定在点击发生时选择了哪个单元格？

IE。在点击发生时触发的方法中，通过查询 tableview 检查点击发生在哪个单元格中，然后您可以确定需要在 prepareForSegue 方法中传递哪些代码。

例如，我使用下面的这种方法来确定点击了哪个单元格，并为该单元格的文本字段调出键盘。您可以轻松地对其进行调整以存储被点击的单元格，然后在您的 prepareForSegue 中使用它来发送正确的数据。

希望这是您正在寻找的。虽然不能完全从你的问题中看出！

```
- (void) tapDetected:(UIGestureRecognizer*)sender
{
    // get location of tap
    CGPoint tapLocation = [sender locationInView:self.tableView];

    // Query tableview and get location of cell
    NSIndexPath *idp = [self.tableView indexPathForRowAtPoint:tapLocation];

    // Now get the actual cell
    UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:idp];

    // Get handle on text field
    UITextField *textField = (UITextField *)[cell viewWithTag:1];

    // Bring up keyboard for that textfield.
    [textField becomeFirstResponder];

} 
```

# sql - How do I get the index of VARRAY items after converting to a table

> ID：10559647
> 
> 赞同：4
> 
> 时间：2012-05-11T23:09:43.637
> 
> 标签：sql, oracle, collections

In the following example I create a VARRAY with 3 items.

```
TEST@XE> select t1, t2.* from
  2  (select 'X' as t1 from dual UNION select 'Y' from dual) t1,
  3  table (sys.odcivarchar2list('a', 'b', 'c'))             t2;

T1  COLUMN_VALUE
--- --------------------
X   a
X   b
X   c
Y   a
Y   b
Y   c 
```

I'd like to have the following output:

```
T1  INDEX COLUMN_VALUE
--- ----- --------------------
X   1     a
X   2     b
X   3     c
Y   1     a
Y   2     b
Y   3     c 
```

Note that `sys.odcivarchar2list` is predefined as `VARRAY(32767) OF VARCHAR2(4000);`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T21:21:06.037

据我所知，没有可以保证工作的纯 SQL 解决方案。您可能需要创建一个 PL/SQL 函数来将 VARCHAR2 的 VARRAY 转换为对象的 VARRAY。

即使对于下面的 PL/SQL 解决方案，也很难说它可以保证工作。[我在PL/SQL 语言参考](http://docs.oracle.com/cd/E11882_01/appdev.112/e25519/composites.htm#i20453)中找不到任何明确说明构造函数中项目的顺序将始终与索引顺序匹配的内容。但是这些例子暗示顺序是保留的，如果它不是真的，它会导致我现在可能会遇到的各种奇怪的错误..

请注意，我的示例可能*不适*用于嵌套表。从手册：

> “当您从数据库中存储和检索可变数组时，它的索引和元素顺序保持稳定。” ...“当您从数据库中存储和检索嵌套表时，嵌套表的索引和行顺序可能不会保持稳定。”

* * *

```
SQL> create or replace type varchar2_with_index as object
  2  (
  3     id number,
  4     value varchar2(4000)
  5  );
  6  /

Type created.

SQL> create or replace type varchar2_with_index_varray as
  2     varray(32767) of varchar2_with_index;
  3  /

Type created.

SQL> create or replace function add_index(p_list in sys.ODCIVarchar2List
  2  ) return varchar2_with_index_varray as
  3     v_new_list varchar2_with_index_varray := varchar2_with_index_varray();
  4  begin
  5     for i in 1 .. p_list.count loop
  6             v_new_list.extend;
  7             v_new_list(v_new_list.count) := varchar2_with_index(i, p_list(i));
  8     end loop;
  9     return v_new_list;
 10  end;
 11  /

Function created.

SQL> column value format a6
SQL> select t1, t2.* from
  2  (select 'X' as t1 from dual UNION select 'Y' from dual) t1,
  3  table (add_index(sys.odcivarchar2list('a', 'b', 'c')))  t2;

T         ID VALUE
- ---------- ------
X          1 a
X          2 b
X          3 c
Y          1 a
Y          2 b
Y          3 c

6 rows selected. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T09:48:01.840

```
 select t1, row_number() over ( partition by t1 order by t1), t2.* from
 (select 'X' as t1 from dual UNION select 'Y' from dual) t1,
 table (sys.odcivarchar2list('a', 'b', 'c'))             t2; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T08:37:29.300

我想知道为什么没有人想出这个，所以我正在回答我自己的问题

```
select t1, t2.* from 
(select 'X' as t1 from dual UNION select 'Y' from dual) t1, 
(select ROWNUM rn, COLUMN_VALUE from table (sys.odcivarchar2list('a', 'b', 'c'))) t2

T1          RN COLUMN_VALUE
--- ---------- --------------------
X            1 a
X            2 b
X            3 c
Y            1 a
Y            2 b
Y            3 c 
```

然而，问题仍然存在，这是否真的能保证 100% 有效

# gwt - GWT track modification on a set of input widgets

> ID：10559651
> 
> 赞同：0
> 
> 时间：2012-05-11T23:10:20.290
> 
> 标签：gwt, event-handling, widget

I have an application where the user can modify an entity, say customer, by modifying a bunch of text-boxes, list-boxes, date-pickers and check-boxes. I also have 2 buttons, save and cancel. I would like to enable the save button if an actual change was made (i.e. one of the input widgets has been modified). Obviously, this can be done in a "brute-force" way by manually adding a change listener to every widget. Or a slight improvement could be to define lists of widgets and add listeners in a for loop. I am curious whether anyone has a more elegant solution?

Thanks, Matyas

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T07:55:43.467

如果你使用 UiBinder，你可以使用类似的东西：

```
@UiField TextBox textBoxA;
@UiField TextBox textBoxB;
@UiField TextBox textBoxC;
@UiField DatePicker datPickerA;
@UiField RadioButton radioButton;

...

@UiHandler(value={"textBoxA", "textBoxB", "textBoxC", "datePickerA"})
void somethingChanged(ChangeEvent e) {
  // Enable your save button.
}

@UiHandler("radioButton")
void somethingClicked(ClickEvent e) {
  // Enable your save button.
} 
```

# maven - Unable to find the mojo 'generate-sources'

> ID：10559652
> 
> 赞同：4
> 
> 时间：2012-05-11T23:10:24.097
> 
> 标签：maven, playn

When I try to install playn, I get that :

```
[INFO] ------------------------------------------------------------------------
[INFO] Building PlayN Tests Android
[INFO]    task-segment: [install]
[INFO] ------------------------------------------------------------------------
[INFO] [enforcer:enforce {execution: enforce-maven}]
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] Internal error in the plugin manager executing goal 'com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.1.1:generate-sources': Unable to find the mojo 'generate-sources' (or one of its required components) in the plugin 'com.jayway.maven.plugins.android.generation2:android-maven-plugin'
Component descriptor cannot be found in the component repository: org.sonatype.aether.RepositorySystem. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-13T12:35:35.247

当您需要使用 Maven 3 时，该错误是由使用 Maven 2 引起的。

# sql - How can I declare a varbinary(MAX) in VIsual Studio?

> ID：10559653
> 
> 赞同：1
> 
> 时间：2012-05-11T23:10:28.003
> 
> 标签：sql, visual-studio-2010

![SQL Table in Visual Studio 2010](../Images/bb39b9638267646b27588e8129d25350.png)

I have the table that you can see in the image (it's Visual Studio 2010), and I want to declare that last column as a varbinary(MAX). But in the 'length' field it only accepts numbers 1 to 8000.

Where/How can I change it to MAX?

# python - ValueError: invalid \x escape:

> ID：10559654
> 
> 赞同：-1
> 
> 时间：2012-05-11T23:10:28.367
> 
> 标签：python, scons

```
ValueError: invalid \x escape:
  File "SConstruct", line 49:
    execfile("hosts.cfg") 
```

I'm completely stumped with this one guys...

If I print right before line 49, I can see the output. On the very first line of "hosts.cfg" I put a second print statement which is never executed.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T00:01:20.493

即使在 Windows 上，正斜杠也应该适用于目录名称，因此您可以对其进行标准化：

```
"libpath" : [".", "../xlib", "../tools", "../info"], 
```

或者使用原始字符串，正如@Adam Rosenfield 在评论中所说：

```
"libpath" : [r".", r"..\xlib", r"..\tools", r"..\info"], 
```

我认为上述两种解决方案都比将所有反斜杠加倍更好，并且比仅对以“x”开头的目录名称加倍反斜杠加载更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:19:49.517

```
"libpath" : [".", "..\xlib", "..\tools", "..\info"], 
```

这是 hosts.cfg 中的问题行，不知道为什么 Python 一直抱怨 execfile 行而不是我正在调用的文件中的行。

我改为：

```
\\xlib and it's working now. 
```

# ruby-on-rails - Ruby on Rails 3.2.1 在 Nivo 滑块下的 Heroku 上不显示图像

> ID：10559656
> 
> 赞同：0
> 
> 时间：2012-05-11T23:10:32.203
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, nivo-slider

我的Ruby on Rails 3.2.1 APP在Heroku上上传时不显示图片，我真的不知道问题出在哪里。在 localhost:3000 上一切正常。我做了一个测试并在内容中添加了一张图片，不是在 Nivo 滑块标签下，一切都很完美，但在 Nivo 下我的应用程序没有显示任何内容。

Nivo 滑块标签：

```
<div class="slider-wrapper theme-default">
    <div class="ribbon"></div>
    <div id="slider" class="nivoSlider">
        <%=image_tag "/assets/birz.JPG"%>
        <%=image_tag "100.jpg"%>
        <%=image_tag "102.jpg"%> 
        <%=image_tag "103.jpg"%> 
        <%=image_tag "104.jpg"%> 
        <%=image_tag "105.jpg"%> 
        <%=image_tag "106.jpg"%> 
        <%=image_tag "107.jpg"%> 
        <%=image_tag "108.jpg"%> 
        <%=image_tag "109.jpg"%> 
        <%=image_tag "110.jpg"%> 
        <%=image_tag "111.jpg"%> 
        <%=image_tag "112.jpg"%> 
    </div>
</div> 
```

**生产.rb**

```
 # Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = true

  # Compress JavaScripts and CSS
  config.assets.compress = true

  # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = false

  # Generate digests for assets URLs
  config.assets.digest = true 
```

**Heroku 堆栈：**

```
 aspen-mri-1.8.6
  bamboo-mri-1.9.2
  bamboo-ree-1.8.7
* cedar (beta) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T10:57:08.583

我的 production.rb 看起来像这样（值得一试）：

```
 config.serve_static_assets = false
  config.assets.compress = true
  config.assets.compile = true
  config.assets.digest = true 
```

我发现这对我有用，因为我在开发中预编译了资产（我已经按照[这里](https://devcenter.heroku.com/articles/rails3x-asset-pipeline-cedar)的文章 ，我使用选项 1\. 在开发中在本地预编译）。这就是我所做的

```
1\. First precompile assets in development run: "bundle exec rake assets:precompile" 
```

“将创建一个 public/assets 目录。在此目录中，您将找到一个 manifest.yml，其中包含已编译资产的 md5sum。” - 来源：heroku 文档

```
2\. Then save to git and push to heroku 
```

看看你在生产应用程序中是否仍然遇到同样的错误（如果是，那么我不知道该怎么做）。

在我的应用程序中，每当我在本地预编译资产时，这都会导致我的开发样式表和 javascript 发疯:(。要解决打开 environment/development.rb 并更改此行：

```
config.assets.debug = true 
```

至

```
config.assets.debug = false 
```

还要删除资产预编译在本地创建的 public/assets 目录。重新启动服务器，希望它应该再次工作。正确弄清楚（资产管道）似乎是一件棘手的事情，但希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T00:05:21.767

在 config/environments/production.rb 上，检查以下配置：

```
config.serve_static_assets 
```

# javascript - 如何在 javascript/jquery 中构建 json 字符串？

> ID：10559660
> 
> 赞同：23
> 
> 时间：2012-05-11T23:10:36.103
> 
> 标签：javascript, json

我想以编程方式构建一个 json 字符串。最终产品应该是这样的：

```
var myParamsJson = {first_name: "Bob", last_name: "Smith" }; 
```

但是我想一次做一个参数。如果它是一个数组，我会做类似的事情：

```
var myParamsArray = [];
myParamsArray["first_name"] = "Bob";
myParamsArray["last_name"] = "Smith"; 
```

我什至不介意构建该数组然后转换为 json。有任何想法吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-05-11T23:14:10.050

你可以对对象做类似的事情：

```
var myObj = {};
myObj["first_name"] = "Bob";
myObj["last_name"] = "Smith"; 
```

然后您可以使用该`JSON.stringify`方法将该对象转换为 JSON 字符串。

```
var json = JSON.stringify(myObj);
alert(json); 
```

将会呈现：

```
{"first_name":"Bob","last_name":"Smith"} 
```

这种方法原生内置于所有现代浏览器中（即使 IE8 也支持它，即使 IE8 离现代浏览器还很远）。如果您需要支持一些旧版浏览器，您可以包含[json2.js](https://github.com/douglascrockford/JSON-js)脚本。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-11T23:13:18.893

创建一个普通对象：

```
var o = {
    first_name: 'Robert',
    last_name: 'Dougan'
}; 
```

然后使用[`JSON.stringify`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/stringify)使其成为字符串：

```
var string = JSON.stringify(o); //"{"first_name":"Robert","last_name":"Dougan"}" 
```

# c - 如何将 putchar 的输出保存到变量中

> ID：10559661
> 
> 赞同：2
> 
> 时间：2012-05-11T23:10:37.937
> 
> 标签：c

我正在研究一些在将文本进一步发送到程序之前过滤文本的代码（此代码删除除所有字母数字字符和下划线之外的所有内容），代码本身完美运行，除了我找不到存储输出的方法其中的一部分用于程序的其他部分，如果我不得不猜测，这可能涉及将标准输出从 putchar 保存到一个变量中，但是如果有人能指出我正确的方向，我在网上找不到太多这样做的信息为此，我将不胜感激，谢谢！

```
#include <stdio.h>
#include <string.h>
#include <ctype.h>
int main(void) {
    int i;
    char *p;
    char stg[] = "hello";
        for (p = &stg[0]; *p != '\0'; p++) {
           if (isalnum(*p) || *p == '_') {
           putchar (*p);
           }
        }
        putchar ('\n');
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T23:20:38.123

也许我不理解您`putchar()`在进行过滤时使用的“需要”，但是您可以将输入过滤到输出`array of chars`中，以便在过滤后使用，如下所示。

```
#include <stdio.h>
#include <string.h>
#include <ctype.h>

int main(void) {
    int i;
    char *p;
    char stg[] = "hel123*^_lo";
    char output[200] = {0x00};
    int index = 0;

    p = stg;
    while( *p )
    {
        if (isalnum(*p) || *p == '_')
        {
            output[index++] = (char)putchar(*p);
        }       
        p++;
    }
    putchar('\n');
    printf("[%s]\n", output);
    return 0;
} 
```

输出：

```
hel123_lo
[hel123_lo] 
```

编辑：

如果您只想将字符串过滤到数组中而不显示字符串，`putchar()`您可以执行以下操作：

```
#include <stdio.h>
#include <string.h>
#include <ctype.h>

int main(void) {
    int i;
    char *p;
    char stg[] = "hel123*^_lo";
    char output[200] = {0x00};
    int index = 0;

    p = stg;
    while( *p )
    {
        if (isalnum(*p) || *p == '_')
        {
            output[index++] = *p;
        }       
        p++;
    }

    printf("[%s]\n", output);
    return 0;
} 
```

你到底想对过滤后的文本的输出做什么？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T23:19:59.867

putchar -- `int putchar( int ch );`-- 如果成功则返回您写入的字符，如果失败则返回 EOF。

没有什么能阻止您声明一个 int 变量，无论是标量变量、数组元素还是结构中的字段，并保存您编写的内容。请注意，返回的是 int，而不是 char。

根据您编写的内容，您可能必须编写一些代码来管理您保存的所有输出。换句话说，如果我正确地解释了您的问题，您将做的不仅仅是将您写入的内容保存到变量中。您可能想说明您在代码中执行 putchar 的位置，甚至可能是时间。不过只是猜测。

# facebook-c#-sdk - Facebook C# SDK v6 - 如何强制对象重新抓取？

> ID：10559667
> 
> 赞同：0
> 
> 时间：2012-05-11T23:11:49.737
> 
> 标签：facebook-c#-sdk

我在 facebook 文档（[此处](https://developers.facebook.com/blog/post/612/)）上读到，您可以强制重新刮擦您的对象以在用户的​​时间轴上更新它。

> 更新对象
> 
> 修改 Open Graph 对象时，您需要告诉 Facebook 的抓取工具重新抓取您的页面以获取更新的信息。有几种不同的方法可以重新刮擦您的对象。
> 
> 通过使用 "scrape=true" POST 参数更加自动化。[对https://graph.facebook.com/?id=](https://graph.facebook.com/?id=) {id}&scrape=true进行 POST 调用，其中 {id} 是对象 id 或对象的 url。响应是一个 JSON 对象，其中包含为 url 抓取的数据。

那么您将如何使用 C# SDK 来解决这个问题呢？

在此先感谢，乍得

编辑：我尝试了以下作为快速而肮脏的测试：

```
 Dim fbData As FacebookSDKInterface = New FacebookSDKInterface()
        Dim fb As Facebook.FacebookClient = New Facebook.FacebookClient(fbData.FacebookAccessToken)

        Dim fbURL As String = NavigateURL() & "?ID=" & GetPathFromDyno(e.Keys(0))

        Dim dicFBPostParams As New Dictionary(Of String, String)
        dicFBPostParams.Add("id", fbURL)
        dicFBPostParams.Add("scrape", "true")

        fb.Post(dicFBPostParams) 
```

但我得到了这个错误：

```
System.Reflection.TargetParameterCountException: Parameter count mismatch. at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks) at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture) at System.Reflection.RuntimePropertyInfo.GetValue(Object obj, BindingFlags invokeAttr, Binder binder, Object[] index, CultureInfo culture) at System.Reflection.RuntimePropertyInfo.GetValue(Object obj, Object[] index) at Facebook.FacebookClient.ToDictionary(Object parameters, IDictionary`2& mediaObjects, IDictionary`2& mediaStreams) at Facebook.FacebookClient.PrepareRequest(HttpMethod httpMethod, String path, Object parameters, Type resultType, Stream& input, Boolean& containsEtag, IList`1& batchEtags) at Facebook.FacebookClient.Api(HttpMethod httpMethod, String path, Object parameters, Type resultType) at Facebook.FacebookClient.Post(String path, Object parameters) at Facebook.FacebookClient.Post(Object parameters) at Incite.Modules.TheDynoRoom.MyGarage.dtlDyno_ItemUpdated(Object sender, DetailsViewUpdatedEventArgs e) in C:\Users\Chad\Documents\Incite Systems\Development\Web Sites\DNN_Dyno\DesktopModules\Incite\The Dyno Room\Controls\MyGarage.ascx.vb:line 1156 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T06:47:09.403

普拉比尔是正确的。更新到最新版本......它工作！谢谢@prabir！

# java - 请求帮助指定要与之交互的元素。（Java w/Selenium）

> ID：10559668
> 
> 赞同：1
> 
> 时间：2012-05-11T23:11:51.850
> 
> 标签：java, selenium

该页面的代码如下：

```
<td align="center" width="50%">

<input type="button" id="M_860735" value="Continue" class="entereclass" style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(244, 244, 244); width: 100px; visibility: hidden; background-position: initial initial; background-repeat: initial initial; " onclick="this.disabled= true; this.value='Loading...'; M_3275409(1);"><br>

<input type="button" id="M_1723091" value="Continue" class="enterclass" style="background: #F4F4F4; width: 100px; margin-top: 3px; visibility: hidden;" onclick=" this.disabled= true; this.value='Loading...'; M_3275409(2);">
</td>

<td align="center" width="50%">

<input type="button" id="M_2802510" value="Continue" class="enterclass" style="background: #F4F4F4; width: 100px; visibility: hidden;" onclick="this.disabled= true; this.value='Loading...'; M_3275409(3);"><br>

<input type="button" id="M_1860441" value="Continue" class="enterclass" style="background-image: initial; background-attachment: initial; background-origin:n initial; background-clip: initial; background-color: rgb(244, 244, 244); width: 100px; margin-top: 3px; visibility: visible; background-position: initial initial; background-repeat: initial initial; " onclick="this.disabled= true; this.value='Loading...'; M_3275409(4);">
</td> 
```

我希望能够获取每个元素并将四个 ID 存储在临时变量中，以便在每次尝试单击时使用。（按钮的 ID 是随机生成的，它们的类循环通过三个不同的选择 ["enterclass"、"forward" 和 "inputsubmit"]）

我要做的就是浏览每个课程并在登录时单击按钮：

```
try{ driver.findElement(By.ByClassName.ByClass("enterclass")).click(); } catch {exception e {} 
```

然后将“enterclass”更改为其他选项，然后粘贴。

但我不能在这里这样做，因为它们都是一样的。

也许不是每次都获取 ID，我可以让程序识别出有四个，然后尝试单击每个？（同样，也不知道该怎么做，哈哈）

我还是 Java 新手，所以我不太清楚最熟练的方法来做这些事情。

如果有人可以帮助我，将不胜感激。^_^

谢谢！〜莫里亚的本·金

更新：失败......我想通了。:P

我已经做了：

```
 try{ 
     driver.findElement(By.xpath("/html/body/div/div/table/tbody/tr/td[2]/div[2]/center/table[13]/tbody/tr[3]/td/table/tbody/tr/td/input")).click();
     } catch(Exception e){}
     try{ 
     driver.findElement(By.xpath("/html/body/div/div/table/tbody/tr/td[2]/div[2]/center/table[13]/tbody/tr[3]/td/table/tbody/tr/td/input[2]")).click();
     } catch(Exception e){}
     try{ 
     driver.findElement(By.xpath("/html/body/div/div/table/tbody/tr/td[2]/div[2]/center/table[13]/tbody/tr[3]/td/table/tbody/tr/td[2]/input")).click();
     } catch(Exception e){}
     try{ 
     driver.findElement(By.xpath("/html/body/div/div/table/tbody/tr/td[2]/div[2]/center/table[13]/tbody/tr[3]/td/table/tbody/tr/td[2]/input[2]")).click();
     } catch(Exception e){} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T01:43:29.720

那是一个很长的xpath。我建议改为使用“FindElements”而不是“findElement”来获取页面上的所有“输入”元素，然后通过访问它们的 id 等来过滤这些元素。例如。

```
elements = driver.findElements(By.xpath("/input");
foreach(IWebElement e in elements)
{
    sting class = elements[0].getAttribute("class");
    if (class == "whatever")
        ;//do your stuff! :)
} 
```

在 xpath 之外看起来非常长，这是非常难以维护的。如果页面上的 UI 有细微的变化，您的 xpath 很容易变得不正确。恕我直言，最好获取页面元素的子集，然后在逻辑上筛选它们。但是，如果它有效，它就有效！:)

# heroku - 在 Heroku 上托管一个静态网站需要多少台测功机？

> ID：10559669
> 
> 赞同：18
> 
> 时间：2012-05-11T23:11:56.843
> 
> 标签：heroku, hosting

我想在 Heroku 上托管一个静态网站，但不确定从多少 dyno 开始。

它在此页面上说：[https](https://devcenter.heroku.com/articles/dyno-requests) ://devcenter.heroku.com/articles/dyno-requests dyno 可以服务的请求数量取决于所使用的语言和框架。但我也在某处读到 1 dyno 一次只能处理一个请求。

这里有点困惑，1 个网络测功机是否足以托管一个流量非常小的静态网站（<1000 次浏览/月，<10/小时）？随着流量开始增加，您将如何估计测功机的额外使用？

希望我的问题措辞正确。非常感谢您的意见，在此先感谢！

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-05-12T15:55:12.840

有点恼火，因为我删除了一个完全有效的答案，但这是另一个尝试。

Heroku dynos 是单线程的，因此它们能够一次处理一个请求。如果您有一个动态页面（php、ruby 等），那么您将查看页面在服务器上响应所需的时间，假设响应时间为 250 毫秒，那么单个测功机每秒可以处理 4 个请求。添加更多测功机会提高并发性而*不是*性能。因此，如果您有 2 个测功机，在这种情况下，您每秒可以处理 8 个请求。

由于您只是在谈论静态页面，因此它们的响应时间应该比这快得多。确定是否需要更多信息的最佳方法是查看 heroku 日志输出，看看是否有持续的“队列”值水平；这意味着测功机无法跟上，请求正在排队等待处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T23:29:17.990

由于大多数[HTTP 1.1 客户端在请求资源时会创建两个到 Web 服务器的 TCP 连接](http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.1.4)，我有一种预感，如果您启动两个 dyno，您会在单个客户端上看到更好的性能，因此客户端的流水线资源请求也可以流水线处理。

您必须决定是否值得为单个客户的（可能轻微的）性能改进而额外花钱。

如果您预计会有多个客户同时请求信息，那么您可能需要两个以上的测功机，以确保至少有一个可供其他客户使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-27T18:21:21.693

在这种情况下，如果您使用一个测功机。第一个是免费的，第二个让您超过每月最低限额并开始触发成本。

但是，您还应该意识到，在 Heroku 上使用一个测功机，如果最近没有访问该应用程序，该应用程序将进入睡眠状态（我认为这大约是 30 分钟）。在这种情况下，再次唤醒可能需要 5-10 秒，并且会给您的用户带来非常缓慢的初始体验。

有一些网络服务会 ping 您的站点，测试它的响应并使其保持清醒。 [http://www.wekkars.com/](http://www.wekkars.com/)例如。

# php - 无法将 JSON 字符串从 PHP 文件传输到 Jquery 中的 getJSON 方法

> ID：10559670
> 
> 赞同：0
> 
> 时间：2012-05-11T23:12:00.500
> 
> 标签：php, jquery, ajax, json

这就是我想要的，在名为 input.php 的 PHP 页面上，用户通过 html 表单提交用户名。这将存储到 MYSQL 数据库中。有一个名为 results.php 的页面查询 MYSQL 数据库中的所有用户名。

我需要发生的是，每隔 5 秒左右，一些 jquery 代码（可能是 getJSON）将从 results.php（同一页面）中获取一个 JSON 字符串。这个 JSON 字符串可能会随着用户在 input.php 页面上添加更多用户名而更新。

这是 input.php 文件

```
 <form name="input" action="<?php $_SERVER['PHP_SELF']?>" method="post">
        Usernames: <input type="text" name="usernames" />
         <input type="submit" value="Submit" name="submit" />
    </form>

    <?php

    if(isset($_POST['submit'])) {
        $link = mysql_connect('', '', '');
        if (!$link) {
            die('Could not connect: ' . mysql_error());
        }

        $db_selected = mysql_select_db('', $link);
        if (!$db_selected) {
            die ('Can\'t use  : ' . mysql_error());
        }

        $result = mysql_query("INSERT INTO users(user_name)             VALUES('".$_POST['usernames']."')");
        if (!$result) {
            die('Invalid query: ' . mysql_error());
        }

    }
    ?> 
```

这是 results.php 文件

```
 <script
        type="text/javascript" src="jquery-1.7.1.min.js"></script>
    <?php

    $link = mysql_connect('localhost', 'root', '');
    if (!$link) {
        die('Could not connect: ' . mysql_error());
    }

    $db_selected = mysql_select_db('test', $link);
    if (!$db_selected) {
        die ('Can\'t use test : ' . mysql_error());
    }

    $result = mysql_query("SELECT user_name FROM users");
    if (!$result) {
        die('Invalid query: ' . mysql_error());
    }

    $names = array();

    while ($row = mysql_fetch_assoc($result)) {

        foreach ($row as $key => $val) {

            $names[][$key] = $val;
        }
    }

    echo json_encode($names);

    ?>
    <script type="text/javascript"> 

        $.getJSON("http://localhost/test/results.php", function(json){
            alert("JSON Data: " + json);
        });

    </script>

    <div></div> 
```

我被困在要放什么 jquery 上，或者即使我做得正确。最终结果就像 Gmail 一样，您无需刷新页面即可收到电子邮件。但是我的系统会每 5 秒从数据库中检索一次用户名，而无需刷新页面。我已经阅读了有关 getJSON 方法的信息，但我完全不了解它，所以我可能需要一些非常深入的解释。如果我以错误的方式实现这一目标，请告诉我并告知我如何实现这一目标的良好做法。

我在我的浏览器中尝试这个 url，除了来自 php 代码的回显 JSON 字符串之外没有任何结果。

这是我的 JSON 字符串

[{"user_name":"matt"},{"user_name":"matt"},{"user_name":"peter"},{"user_name":"jim"},{"user_name":"sam"} ]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:37:59.840

你可以使用 setTimeout。

```
 setTimeout( function() {
    getData()
  }, 5000);

 function getData() {
    $.getJSON("http://localhost/test/results.php", function(json){
        alert("JSON Data: " + json);
    });
    });
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:38:31.253

您正在寻找的东西称为 AJAX，您需要 javascript 才能完成它。如果你想要一种时尚而简单的方法，我会推荐 jQuery。你的代码看起来像这样：

```
setTimeout(function(){
    $.post("results.php",function(result){
        //Do somthing with the result Array or object
    },"json");
},5000); 
```

此外，由于您只获取 1 条数据“用户名”，因此您应该返回数组 json 而不是对象 json

```
["matt","matt","peter","jim","sam"] 
```

您和您的用户都应该减少带宽。

注意：您应该从 results.php 中删除 jquery 脚本，您唯一应该重新调整的是 json 本身。如果有任何疑问，请问

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T23:17:03.743

如果你想使用 results.php 来做这两件事（即显示用户名以及响应 JSON 查询），那么你需要将文件分成两个分支。使用 _GET 变量来指定哪个分支。例如，您将在 results.php?json=true 上运行 .getJSON 而不仅仅是 results.php。现在在 results.php 内部有一个 if 分支来检查这个 _GET 变量是否存在，如果存在，获取你需要的数据，在一个 json 编码的字符串中回显它，**然后 exit()**。在 results.php 中执行所有这些操作之前，甚至在`<script>`tag 之前。

编辑提供代码：（从OP的问题编辑）

```
<?php
    $link = mysql_connect('localhost', 'root', '');
    if (!$link) {
        die('Could not connect: ' . mysql_error());
    }

    $db_selected = mysql_select_db('test', $link);
    if (!$db_selected) {
        die ('Can\'t use test : ' . mysql_error());
    }

    $result = mysql_query("SELECT user_name FROM users");
    if (!$result) {
        die('Invalid query: ' . mysql_error());
    }

    $names = array();

    while ($row = mysql_fetch_assoc($result)) {

        foreach ($row as $key => $val) {

            $names[][$key] = $val;
        }
    }

    if (isset($_GET['json'])) {
        echo json_encode($names);
        exit();
    }

    ?>
    <script type="text/javascript" src="jquery-1.7.1.min.js"></script>
    <script type="text/javascript"> 
        $.getJSON("http://localhost/test/results.php?json=true", function(json){
            alert("JSON Data: " + json);
        });
    </script>

    <div></div> 
```

# php - 在 MAC OS X 中使用 PEAR

> ID：10559674
> 
> 赞同：5
> 
> 时间：2012-05-11T23:13:07.637
> 
> 标签：php, macos, pear

我尝试使用 pear 来安装 phpunit 和 phpdoc，但我的 pear 安装似乎遇到了问题。

[按照此处](http://www.phpdoc.org/docs/latest/for-users/installation.html)的安装指南：

1.  您可以使用以下命令准备 PEAR 安装：`$ pear channel-discover pear.phpdoc.org`

这给了我一条错误消息： `-bash: pear: command not found`

我见过提到使用`$ locate bin/pear`来查找安装。这给了我以下信息：

```
WARNING: The locate database (/var/db/locate.database) does not exist.
To create the database, run the following command:

  sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.locate.plist

Please be aware that the database can take some time to generate; once
the database has been created, this message will no longer appear. 
```

不知道那是什么意思，但如果我没看错的话，那就是梨不存在。我知道我的梨之路是`/Applications/MAMP/bin/php/php5.3.6/bin/pear /Applications/MAMP/bin/php/php5.3.6/bin/pear`。

我对接下来要尝试什么有点迷茫。关于我做错了什么有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T13:07:25.340

使用给定的命令创建您的定位数据库。您可以根据第一次安装 osx 时 Spotlight 必须“加载”或索引所有内容的方式来考虑这一点。“can take some time”通常意味着“will take some time”

如果你知道你的梨路径，你可以直接执行它：

`/Applications/MAMP/bin/php/php5.3.6/bin/pear channel-discover pear.phpdoc.org`

或在您的 bash 配置文件目录中手动为其添加别名 [http://blog.elucidcode.com/2011/03/terminal-aliases-in-os-x/](http://blog.elucidcode.com/2011/03/terminal-aliases-in-os-x/)

或在`/usr/bin`.

概览。看来梨安装得很好。就在您在控制台中输入“梨”时，osx 不会将其识别为命令，它就像桌面上的快捷方式，不指向任何地方。需要做的是（使用上述方法之一）将“桌面快捷方式”（`pear`命令）指向实际的 pear 二进制文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T13:24:06.310

尝试使用梨的完整路径：

```
$ /Applications/MAMP/bin/php/php5.3.6/bin/pear channel-discover pear.phpdoc.org 
```

当您输入这样的 unix 命令时，第一部分是您要运行的应用程序。键入“pear”表示您要运行 pear 应用程序。您的操作系统知道一些可以在其中查找应用程序的目录。您可以通过输入以下命令查看它们是什么：

```
echo $PATH 
```

该列表由冒号分隔。如果您要运行的应用程序不在这些文件夹之一中，那么您的操作系统不知道在哪里可以找到它。它不会自动搜索您的整个硬盘驱动器以查找该名称的应用程序。这将是一种安全风险，或者如果您有多个同名的应用程序，至少会缓慢且模棱两可。

如果您输入应用程序的整个路径，就像我上面建议的那样，那么您的操作系统确切地知道在哪里可以找到应用程序，并且会直接运行它，而无需搜索 PATH 中的目录。

您可以将新目录添加到 PATH，也可以将应用程序的别名添加到 PATH 目录之一。然后，您只需键入“pear”，操作系统就可以找到它。互联网上有用于将目录添加到 PATH 的教程。

需要创建定位数据库才能使用定位命令。这是一个单独的问题。您可以构建定位数据库，它将查看您的所有文件。运行需要一点时间，但完成后，定位命令将起作用。但是，由于您已经知道您的 pear 应用程序在哪里，因此 locate 不会为您提供任何新信息。

# c# - Windows Phone 启动画面弹出窗口

> ID：10559677
> 
> 赞同：0
> 
> 时间：2012-05-11T23:13:18.393
> 
> 标签：c#, windows-phone-7, splash-screen

我目前正在开发一个 Windows Phone 应用程序，并使用弹出窗口添加了一个动画启动屏幕。

```
public MainPage()
    {
        splashPopup = new Popup() { IsOpen = true, Child = new SplashScreenControl() };
        bgWorker = new BackgroundWorker();
        BgWorker();

        InitializeComponent();
    } 
```

所有这些都可以正常工作，但问题是当应用程序导航到另一个屏幕时，启动屏幕将再次显示，因为该屏幕使用 MainPage 的实例。有没有办法只显示一次启动画面？

我尝试使用全局变量来检查它是否设置为 true，但由于它一直被初始化为 false，所以失败了。还有其他可能的方法吗？

这是我试图做但没有奏效的：

```
public class MainPage
{
    bool splash = false;

    public MainPage()
    {
        if (splash == false)
        {    
            splashPopup = new Popup() { IsOpen = true, Child = new SplashScreenControl() };
            bgWorker = new BackgroundWorker();
            BgWorker();
        }
        InitializeComponent();

        splash = true;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:27:21.983

有一个全局标志，比如`bool wasShown;`在应用程序首次加载时将其设置为 true。然后，在您拥有的构造函数中，检查标志，如果弹出窗口已经显示，请不要再次显示。

在您的代码中，`splash`不是**global**。它仍然存在于 MainPage 的上下文中。在静态类中声明它`App`或使用额外的静态类。之后您应该执行以下操作：

```
public class MainPage
{
    public MainPage()
    {
        if (!App.Splash)
        {    
            splashPopup = new Popup() { IsOpen = true, Child = new SplashScreenControl() };
            bgWorker = new BackgroundWorker();
            BgWorker();
            App.Splash = true;
        }
        InitializeComponent();
    }
} 
```

# ajax - CodeIgniter 的 url 分段不适用于我的 JSON

> ID：10559681
> 
> 赞同：1
> 
> 时间：2012-05-11T23:13:51.537
> 
> 标签：ajax, json, codeigniter, url, text-segmentation

这是我在这里的第一篇文章，我还没有想出正确格式化我的帖子，但它就在这里。

所以基本上，如果我直接指向一个 php 文件，我只能让我的代码工作。如果我尝试在我的控制器中调用一个方法，似乎什么都没有发生。

我的 JavaScript：

```
$(document).ready(function() {  
$(".guide_button").click(function(){

    var id = $(this).text();
    var data = {};
    data.id = id;

    $.getJSON("/guides/hehelol", data, function(response){
        $('#test').text(response.id);
    });
    return false;
});
}); 
```

我的标记：

```
<div id="content_pane">
<ul>
  <li><a href="#" name="temp" class="guide_button">RL</a></li>
  <li><a href="#">LG</a></li>
  <li><a href="#">RG</a></li>
  <li><a href="#">SG</a></li>
  <li><a href="#">GL</a></li>
  <li><a href="#">MG</a></li>                       
</ul>                   
</div>

<div class="description">
<h3>Description</h3>
<p id="test">This text area will contain a bit of text about the content on this section</p>
</div> 
```

我的控制器：

```
<?php
class Guides extends CI_Controller {    

public function Guides()
{
    parent::__construct();

    $this->load->helper('url');
    $this->load->helper('form');
}   

public function index()
{
    $this->load->view('guides_view');
    $title = 'Some title';      
}   

public function hehelol() //The controller I am desperatly trying to call
{   
    $id = $_GET['id'];       
    $arr = array ('id'=>$id);
    echo json_encode($arr);
}           
} 
```

可能是我的控制器做错了什么。因为它的代码只有在创建一个 hehelol.php 文件并像这样直接引用它时才有效。

```
$.getJSON("hehelol.php", data, function(response){
$('#test').text(response.id);
}); 
```

谁知道我需要做什么才能使我的控制器正常工作？请帮忙！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:20:13.953

我只是将您的确切代码完整地放在我的 codeigniter 应用程序中，它对我有用。意思是我用了这个：`...$.getJSON("/guides/hehelol",...`

因为您正在发出`$_GET`请求，所以您必须启用查询字符串。

在您的 config.php 文件中，确保此行设置为`TRUE`：

```
$config['allow_get_array']= TRUE; 
```

# ruby-on-rails - 在 Rails 中选择嵌套资源的最佳实践？

> ID：10559683
> 
> 赞同：2
> 
> 时间：2012-05-11T23:14:31.030
> 
> 标签：ruby-on-rails, nested-resources

您使用什么标准来决定是否嵌套资源？

过去，我选择在资源上的索引操作没有意义的情况下进行嵌套，而不将范围限定为关联资源（父级）。

即使在我写下上述标准时，我也意识到它充其量是模棱两可的。

一位同事表示：

> 嵌套资源，因为它在 url 结构中直观地捕获关联模型的关系......并且它可以轻松修改 url 以返回到帖子。如果我看到 /posts/123/offers/555 - 我知道我可以去 /posts/123 看到我的帖子。就好像我刚刚看到/offers/555 一样，除了手动浏览该站点之外，我没有办法返回帖子。

对我来说，用户对 url 的操作应该与应用程序的架构无关，并且违背了我理解的普遍持有的原则，即尽可能避免嵌套资源。此外，这个论点似乎支持多层次的嵌套，这也是我读过的几乎每一篇文章都反对的。

你有什么经验吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T02:14:12.790

正如您首先提到的那样，我嵌套了路线，如果没有前者，路线中的后面的东西就没有意义。博客上的评论将嵌套在下面`resources articles`，因为尽管您可能希望在其自己的页面上显示单独的评论（谁知道为什么......），但评论属于一篇文章。

这也有控制器实现。如果您知道该文章，则可以找到该文章范围内的特定评论。这使得查询更有效。

此外，您的同事是正确的，您必须处理弄乱您的路线的用户，尽管他的理由是错误的。这不是为了他们的方便，而是为了他们的安全。

让我们以一个带有用户和订单的类似亚马逊的应用程序为例。如果我在，`users/5/orders/2`那么我会想“嘿！我可以将那个 5 更改为 4，然后查看其他人的订单！” 如果您不限定订单，那么用于授权用户查看的控制器级逻辑将`orders/2`变得更加棘手。对用户的范围限定允许`current_user.orders.find(params[:id])`在订单控制器中。可以根据身份验证找到当前用户，因此他们不能只是交换 URL 中的 id 并成为其他人。

# android - 通过 onclick 增加 android 数据库版本。(SQLiteOpenHelper)

> ID：10559684
> 
> 赞同：0
> 
> 时间：2012-05-11T23:14:50.513
> 
> 标签：android

是否有可能（简单）获取当前数据库版本号，将其递增，然后从活动中将其传递给 SQLiteOpenHelper 的构造函数，而不是像这样对版本号进行硬编码？

活动（从 onclick 调用）：

```
public void updatedb(){
    //pseudo-code next 2 comments
    //int incVersion = getCurrentDBVersion();<==question here
    //incVersion = incVersion + 1;
    DatabaseHandler dbincrement = new DatabaseHandler(this, incVersion);
} 
```

SQLiteOpenHelper 扩展：

```
public class DatabaseHandler extends SQLiteOpenHelper{
    public DatabaseHandler(Context context, int incVersion) {
        super(context, DATABASE_NAME, null, incVersion);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:25:23.530

是的，使用这样的东西来获取[数据库版本](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#getVersion%28%29)：

```
DatabaseHandler dh = new DatabaseHandler(this);
SQLiteDatabase db = dh.getWriteableDatabase();
int version = db.getVersion();
DatabaseHandler dhInc = new DatabaseHandler(this, version++); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T15:07:29.053

除非您首先打开数据库，否则您无法获取当前的数据库版本号。因此，如果您的意图是获取已安装的数据库版本，将其递增，*然后*使用新版本调用 SQLiteOpenHelper 构造函数，那么我不相信 Sam 的建议会满足您的要求。

原因如下：

1) DatabaseHandler 构造函数的第一行必须调用 SQLiteOpenHelper (super) 构造函数，提供您的数据库版本。
2) 调用 getWriteableDatabase 会自动导致调用 DatabaseHandler 中的 onOpen 和/或 onUpgrade/onDowngrade 方法。调用哪个 onXXXX 方法取决于 SQLiteOpenHelper 将安装的数据库版本与您在上面的构造函数初始化中提供的版本的比较。

如果不先提供一个，我不知道有一种简单的方法可以找出已安装的数据库版本。

# javascript - 使用 Node.JS，如何按时间顺序获取文件列表？

> ID：10559685
> 
> 赞同：48
> 
> 时间：2012-05-11T23:15:23.800
> 
> 标签：javascript, node.js, directory

对于给定的目录，如何在 Node.JS 中按时间顺序（按日期修改）获取文件列表？我在文件系统文档中没有看到任何内容。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-05-11T23:32:01.100

试一试。

```
var dir = './'; // your directory

var files = fs.readdirSync(dir);
files.sort(function(a, b) {
               return fs.statSync(dir + a).mtime.getTime() - 
                      fs.statSync(dir + b).mtime.getTime();
           }); 
```

我使用了方法的“同步”版本。您应该根据需要使它们异步。（可能只是`readdir`一部分。）

* * *

如果您缓存统计信息，您可能会稍微提高性能。

```
var files = fs.readdirSync(dir)
              .map(function(v) { 
                  return { name:v,
                           time:fs.statSync(dir + v).mtime.getTime()
                         }; 
               })
               .sort(function(a, b) { return a.time - b.time; })
               .map(function(v) { return v.name; }); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-07-04T18:40:01.460

2021，异步/等待使用 fs.promises

```
const fs = require('fs').promises;
const path = require('path');

async function readdirChronoSorted(dirpath, order) {
  order = order || 1;
  const files = await fs.readdir(dirpath);
  const stats = await Promise.all(
    files.map((filename) =>
      fs.stat(path.join(dirpath, filename))
        .then((stat) => ({ filename, mtime: stat.mtime }))
    )
  );
  return stats.sort((a, b) =>
    order * (b.mtime.getTime() - a.mtime.getTime())
  ).map((stat) => stat.filename);
}

(async () => {
  try {
    const dirpath = __dirname;
    console.log(await readdirChronoSorted(dirpath));
    console.log(await readdirChronoSorted(dirpath, -1));
  } catch (err) {
    console.log(err);
  }
})(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-05-25T09:47:51.570

`cliffs of insanity`解决方案的紧凑版本

```
function readdirSortTime(dir, timeKey = 'mtime') {
  return (
    fs.readdirSync(dir)
    .map(name => ({
      name,
      time: fs.statSync(`${dir}/${name}`)[timeKey].getTime()
    }))
    .sort((a, b) => (a.time - b.time)) // ascending
    .map(f => f.name)
  );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-04T15:03:11.033

我最终使用下划线来说明用于排序的统计数据。

第一次使用获取目录中的文件`files = fs.readFileSync(directory);`（如果目录不存在或读取权限，您可能想尝试捕获错误）

然后将它们传递给如下函数。这将返回您的有序列表。

```
function orderByCTime(directory, files) {
    var filesWithStats = [];
    _.each(files, function getFileStats(file) {
        var fileStats = fs.statSync(directory + file);

        filesWithStats.push({
            filename: file,
            ctime: fileStats.ctime
        });
        file = null;
    });
    return _.sortBy(filesWithStats, 'ctime').reverse();
} 
```

下划线[默认按 asc 排序](http://underscorejs.org/#sortBy)。我把它倒过来，因为我需要它降序。

您可以决定按另一个统计数据排序（[在此处查看节点 fs 文档](https://nodejs.org/api/fs.html#fs_stat_time_values)）。我选择使用 ctime 因为它也应该考虑“触摸”文件。

希望有所帮助，

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-05-11T23:19:30.073

你试过`fs.readdir()`吗？

[http://nodejs.org/docs/v0.3.1/api/fs.html#fs.readdir](http://nodejs.org/docs/v0.3.1/api/fs.html#fs.readdir)

# trigger.io - trigger.io 有存储敏感数据的 API 吗？

> ID：10559687
> 
> 赞同：2
> 
> 时间：2012-05-11T23:15:33.097
> 
> 标签：trigger.io

我需要存储敏感数据，例如 OAuth 刷新令牌。trigger.io 中是否有 API 以加密和安全的方式存储数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T06:24:03.733

[prefs API](http://docs.trigger.io/en/v1.3/modules/prefs.html)使用本机设备存储，应在应用程序之间很好地划分。

我们愿意在此处添加一层加密，但如何以一种明智的方式进行加密并不是很明显：为了能够在客户端解密数据，我们需要将密钥存储在本地。将加密数据和解密密钥存储在同一个地方不是一个好主意！

# java - JSch 会话连接

> ID：10559688
> 
> 赞同：0
> 
> 时间：2012-05-11T23:15:42.197
> 
> 标签：java, gwt, jdbc, ssh, jsch

您好我正在尝试通过 ssh 隧道连接到服务器上的数据库，但我什至无法连接 Jsch 会话。我试图在 GWT 中将其作为后端代码的一部分。所以这是在服务器端代码的实现部分。我一般对服务器不是很熟悉。通常在终端 I 中键入：

> ssh -x 用户名@xxxxx.xxx.edu

然后我被提示输入我的密码，我输入密码，然后我就进去了。

所以在java中我的代码如下：

```
String host="xxxxx.xxx.edu";

String user="username";
String password="password";

Session session= null;
try{
            //Set StrictHostKeyChecking property to no to avoid UnknownHostKey issue
            java.util.Properties config = new java.util.Properties();
            config.put("StrictHostKeyChecking", "no");
            JSch jsch = new JSch();
            session=jsch.getSession(user, host, 22);
            session.setPassword(password);
            session.setConfig(config);
            session.connect();
} 
```

我已经仔细检查了用户名和密码以及主机字符串，它们都是我在终端中成功使用的。

我在“session.connect()”行得到的错误如下：（向右滚动查看整个错误）

```
com.jcraft.jsch.JSchException: java.security.AccessControlException: access denied (java.net.SocketPermission xxxxx.xxx.edu resolve)
at com.jcraft.jsch.Util.createSocket(Util.java:341)
at com.jcraft.jsch.Session.connect(Session.java:194)
at com.jcraft.jsch.Session.connect(Session.java:162)
at com.front.server.GameServiceImpl.createGame(GameServiceImpl.java:39) 
```

有什么我想念的吗？这与我在终端中通过 ssh 登录所做的不同吗？我也尝试在主机字符串前添加 'ssh://'，但无济于事。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T16:50:22.907

我发现上面的代码没有问题。我将它复制/粘贴到一个简单的 java main 中，它工作正常。将相同的代码放在 GWT 后端似乎有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T23:25:53.823

根据异常信息，问题似乎不是来自JSch。

请参阅java.sun.com 上的[安全和权限：](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/appA.html)

> 除了对调用程序的目录及其子目录的读取访问权限之外，所有使用安全管理器调用的小程序和任何应用程序都必须被授予访问本地系统资源的显式权限。Java 平台提供权限以允许对不同类型的本地信息进行不同级别的访问。

，并参见[SocketPermission](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/appA.html#SocketPermission)部分。

# php - 选择价格后更新运费 (PHP)

> ID：10559690
> 
> 赞同：-2
> 
> 时间：2012-05-11T23:16:04.600
> 
> 标签：php, shopping-cart

我正在为我的网站制作购物车。在购物车区域，我从数据库中提取运输详细信息，包括取决于邮政编码的价格。当用户点击“更新购物车”时。我正在尝试使用运费更新总数。如果有人能指出我解决这个问题的正确方向。

这是我显示购物车的功能。

```
function showCart() {
$cart = $_SESSION['cart'];
$zip = $_SESSION['zipcode'];
if ($cart) {

    $items = explode(',',$cart);
    $contents = array();
    foreach ($items as $item) {
        $contents[$item] = (isset($contents[$item])) ? $contents[$item] + 1 : 1;
    }
    $output[] = '<form action="cart.php?action=update" method="post" id="cart">';
    $output[] = '<table>';
    foreach ($contents as $id=>$qty) {
        $sql = 'SELECT * FROM products WHERE id = '.$id;
        $result = mysql_query($sql) or die(mysql_error());
        $row = mysql_fetch_array($result, MYSQL_ASSOC);
        extract($row);
        $output[] = '<tr>';
        $output[] = '<td><a href="cart.php?action=delete&id='.$id.'" class="r">Remove</a></td>';
        $output[] = '<td>'.$title.' by '.$author.'</td>';
        $output[] = '<td>$'.$price.'</td>';
        $output[] = '<td><input type="text" name="qty'.$id.'" value="'.$qty.'" size="3" maxlength="3" /></td>';
        $output[] = '<td>$'.($price * $qty).'</td>';
        $total += $price * $qty;
        $output[] = '</tr>';
    }
    $output[] = '</table>';

    $sql  = 'SELECT * FROM zipcodes WHERE zipcode = '.$zip;
        $result = mysql_query($sql) or die(mysql_error());
        while($row = mysql_fetch_array($result, MYSQL_ASSOC)){

        $output[] = '<label>Price: </label><select name="delivery" id="delivery" class="long-field">';
        $output[] = '<option value="">Please Select</option>';
        $output[] = '<option value='.$row['free_dev'].'>$'.$row['free_dev'].'</option>';
        $output[] = '<option value='.$row['next_day_dev'].'>$'.$row['next_day_dev'].'</option>';
        $output[] = '</select>';
        }

    $output[] = '<p>Delivery Charge: <strong>$'.$delivery.'</strong></p>';          
    $output[] = '<p>Grand total: <strong>$'.$total.'</strong></p>';
    $output[] = '<div><button type="submit">Update cart</button></div>';
    $output[] = '</form>';
} else {
    $output[] = '<p>You shopping cart is empty.</p>';
}
return join('',$output); 
```

}

这是通过 cart.php 更新的部分

```
case 'update':
if ($cart) {
    $newcart = '';
    foreach ($_POST as $key=>$value) {
        if (stristr($key,'qty')) {
            $id = str_replace('qty','',$key);
            $items = ($newcart != '') ? explode(',',$newcart) : explode(',',$cart);
            $newcart = '';
            foreach ($items as $item) {
                if ($id != $item) {
                    if ($newcart != '') {
                        $newcart .= ','.$item;
                    } else {
                        $newcart = $item;
                    }
                }
            }
            for ($i=1;$i<=$value;$i++) {
                if ($newcart != '') {
                    $newcart .= ','.$id;
                } else {
                    $newcart = $id;
                }
            }
        }
    }
}
$cart = $newcart;
break; 
```

谢谢你。任何帮助是极大的赞赏！PS我正在使用这里的购物车教程[http://v3.thewatchmakerproject.com/journal/276/](http://v3.thewatchmakerproject.com/journal/276/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:36:04.910

鉴于您提供的代码对这个问题相当不可知，因此不清楚您在哪里遇到了困难。但是为了让你开始：

```
case 'update':
if ($cart) {
    $newcart = '';
    foreach ($_POST as $key=>$value) {
        ... //same thing as before
    }
    $newcart .= $shipping_price; //or however you're encoding this. It's unclear.
}
$cart = $newcart;
break; 
```

并替换：

```
$output[] = '<p>Grand total: <strong>$'.$total.'</strong></p>'; 
```

和：

```
$output[] = '<p>Grand total: <strong>$'.$total+ $shipping_price.'</strong></p>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:50:01.823

如果我是你，我会搜索一个 PHP 类购物车，该代码让我想起了一些 PHP4（它应该是因为示例来自 2005 年）。

我没有找到一个很好的示例链接，我将尝试在下面描述这个想法。

您创建了两个类，一个代表商品，另一个代表购物车（第一个可以只是带有 mysql_fetch_object 的数据库的结果或类似 Pdo 之类的东西，它将把它变成来自 php 的 stdClass

```
class someItem 
```

{公共$id; 公共$数量；公开的$价格；公共 $totalprice;

```
public function __get($var)
{
    if ($var == 'totalPrice') {
        return $this->price*$this->qty;
    }

    return $this->$var;
} 
```

}

类购物车{

```
private $items;

public function addItem($someItem)
{
    if (array_key_exists($someItem->id, $this->items)) {
        $this->items[$someItem->id]->qty = $this->items[$someItem->id]->qty + $someItem->qty;
    } else {
        $this->items[$someItem->id] = $someItem;
    }
}

public function removeItem($someItem)
{
    unset($this->items[$someItem->id]);
}

public function getTotal()
{
    $total = 0;
    foreach($this->items as $item){
        $total += $item->totalPrice;
    }
    return $total;
} 
```

}

将信息序列化到会话中 $_SESSION['user']['cart'] = serialize($Shoppingcart);

用户登录时设置一个新的购物车，当他退出时清理它。添加和删​​除项目可以在一切之前完成

// 根据您的 HTML 表单执行任何操作 foreach ($_POST['cart'] as $itemId ) { $ItemObj = $db->getitemAsObject($itemId); // 使用 PDO 什么的 $shoppingcart->addItem($itemObj); }

发布后将购物车重新保存到会话 $_SESSION['user']['cart'] = serialize($Shoppingcart);

# php - 服务器请求 URI 通配符 Magento

> ID：10559692
> 
> 赞同：1
> 
> 时间：2012-05-11T23:16:25.613
> 
> 标签：php, magento, content-management-system, request

我目前正在使用以下代码在链接上生成活动状态： `<?php if ($_SERVER["REQUEST_URI"] == "/styles/bracelets.html/"):?>`

后跟一个 else if 语句。我将如何添加通配符，以便上面的路径包含路径为：/styles/bracelets.html?p=2、/styles/bracelets.html?p=3 等的所有页面。

提前感谢山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:20:52.463

在这种情况下，您可以使用[strpos() ：](http://php.net/strpos)

```
if (strpos($_SERVER['REQUEST_URI'], '/styles/bracelets.html/') === 0): 
```

这基本上会检查以确保`/styles/bracelets.html/`位于请求 URI 的开头，并且如果末尾有其他内容也将通过`/`。 `strpos`如果在 haystack 中没有找到需要，则返回 false，如果在 haystack 开头找到，则返回 0，因此需要`===`.

[preg_match()](http://php.net/preg_match)也可以，但 strpos 在这种情况下可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-17T18:22:39.057

我想我找到了一些更清洁的方法：

```
if($_SERVER['SCRIPT_NAME'] == '/desired_page_name.php') 
```

`$_SERVER['SCRIPT_NAME']`返回当前脚本的路径，但省略可能的 $_GET 连接 。

即如果 `www.example.com/page.php?variable=value`输入，则将`$_SERVER['SCRIPT_NAME']`仅包含`/page.php`部分。

# javascript - 如何保护客户端上使用的 AES 密码？

> ID：10559695
> 
> 赞同：2
> 
> 时间：2012-05-11T23:16:44.163
> 
> 标签：javascript, aes

我想在这里使用斯坦福的 AES 实现：

[http://crypto.stanford.edu/sjcl/](http://crypto.stanford.edu/sjcl/)

但是，如果我按照他们的建议使用它，它基本上是没用的

> SJCL 易于使用：只需运行 sjcl.encrypt("password", "data") 来加密数据，或运行 sjcl.decrypt("password", "encrypted-data")。

由于任何人都可以简单地加载我的网站，因此请查看 java 脚本并使用密码以与我相同的方式解密数据。

我如何使这个解决方案有用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T00:03:06.863

With a bit more back-and-forth I think I understand what you want to know better enough to give you an answer. Let me know if this is what you were looking for.

In general, managing symmetric keys is very difficult. There are two primary uses for symmetric ciphers:

*   Protecting the privacy of stored data for later use by the same person. If you use an online backup service, you really hope that your data is encrypted on the client *before* being uploaded to the online service -- you do not want them to have access to your data in plaintext. But when you go to decrypt the data in the future, *you're* the one to supply the key. This means you could store the key on offline media (CD-R, USB memory stick, SD card, little notebook next to the monitor...) or online (browser cookie, OS-supplied keychain of some sort, or standard file...).

*   Protecting the privacy of data while in transit between two parties. One party encrypts the data and the other party decrypts the data. This is how spies communicate, how TLS provides HTTPS client-to-server security, how SSH provides client-to-server security. In this case, both parties need to agree to the key that will be used, and this can be done with [Diffie-Hellman-Merkle Key Exchange](http://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange) or using a [public-key encryption algorithm such as RSA](http://en.wikipedia.org/wiki/RSA_%28algorithm%29) to allow one party to encrypt a randomly-generated session key in a way that it can only be decrypted by the other party.

The library you have found looks like it is highly optimized for the first case -- allowing users to encrypt their data for you to store and then retrieve for them later. Because they use a [password based key derivation function](http://en.wikipedia.org/wiki/PBKDF2) it is prepared to handle the poor passwords that are available through simply typing on a keyboard -- the function will allow building safer keys out of just what a human can (or will) type on a keyboard.

Of course, it *could* be used for the second case, but presumably you're using this in a browser that has full TLS support, which can provide for end-to-end security in case you choose to use both client certificates and server certificates.

If you chose to allow the user to store encrypted data through your software, you should definitely make clear where the decryption key is being stored. I could see a use case for having a cookie on the browser store the key -- so that the user does not need to re-type it when they want their data. But if they change machines or browsers, they'll need to know the password so they can again retrieve their data.

However, if a user thinks their data is "secure", perhaps they should re-type their key every time they want to use their data. That way, the user alone is responsible for the security of the key; browser flaws that allow exposure of cookie data -- or locally-running malicious code -- cannot simply read the key off disk.

The downside of all this, of course, is that there isn't an easy answer available: you have to decide between the simplicity of storing passwords *or* the safety of not storing passwords.

# winapi - VirtualQueryEx 我如何解析结果（我如何知道页面是否可以被 ReadProcessMemory 读取？）

> ID：10559697
> 
> 赞同：1
> 
> 时间：2012-05-11T23:16:57.603
> 
> 标签：winapi

我正在尝试学习如何访问其他进程的内存。我正在使用`ReadProcessMemory`但它失败了，据说是因为我正在从无法访问的内存中读取。我想我应该`VirtualQueryEx`先看看我要读取的内存是否可读，但我不知道如何解析`VirtualQueryEx`.

`VirtualQueryEx`返回此处描述的结构[http://msdn.microsoft.com/en-us/library/windows/desktop/aa366775%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366775%28v=vs.85%29.aspx)

有没有什么好的简单方法可以知道`MEMORY_BASIC_INFORMATION`结构中的值是否表明该页面是可读的`ReadProcessMemory`？

这个结构有几个参数，据我了解，定义内存是否可访问：

```
DWORD  AllocationProtect;
DWORD  State;
DWORD  Protect;
DWORD  Type; 
```

它甚至不清楚哪些参数组合实际上允许读取内存（例如，我应该从`AllocationProtect`or读取保护标志`Protect`，`State`除了 Commit 是否意味着内存不可读等）并产生巨大的 if （这就是那个，那是那或这就是……）似乎不是一个干净的解决方案。

一定有更好的方法，但我似乎无法找到它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T00:42:41.173

实际上，线索在您链接的文档中：

> **分配保护**
> 
> *最初分配区域时*的内存保护选项。此成员可以是内存保护常量之一，如果调用者无权访问，则为 0。

`VirtualProtect`或者`VirtualProtectEx`可以同时用于更改保护（每页，而初始保护是针对整个分配范围）。因此，您必须根据 MSDN 文档中声明允许读取的[内存保护常量](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366786%28v=vs.85%29.aspx)`Protect`检查结构的成员。检查单个位似乎还不够。

# cocoa - 可可HTTP重定向？

> ID：10559700
> 
> 赞同：0
> 
> 时间：2012-05-11T23:17:16.600
> 
> 标签：cocoa, redirect, hosts

我知道`/etc/hosts`可以修改该文件以重定向网站，但这在应用程序中并不可行。我想知道是否有办法从应用程序中执行此操作，并且仅在该应用程序运行时重定向它。

# c# - 具有多个级别的 Windows 窗体中的序列化/反序列化

> ID：10559702
> 
> 赞同：0
> 
> 时间：2012-05-11T23:18:07.940
> 
> 标签：c#, visual-studio-2010, serialization, deserialization, windows-forms-designer

我目前正在使用具有多个级别的类的 Windows 窗体应用程序上的序列化/反序列化。我花了 5 天时间尝试调试它（从带有断点的简单函数 StepInto 到按属性关闭属性），但是到 Form 类中发生的相同 TargetInvocationException。

我将通过首先解释级别来到达那里。

首先，最上面的一个是这样的：

```
[Serializable]
public enum SAI
{
    level1,
    level2,
    level3
}

[Serializable]
public class First:ISerializable
{
    public SAI something { get; set; }
    public double something1 { get; set; }
    public int something2 { get; set; } 
```

我已经实现了自定义序列化/反序列化部分

```
public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        info.AddValue("something", something,typeof(SAI));
        info.AddValue("something1", something2, typeof(double));
        info.AddValue("something2", something2,typeof(int));
    }

    private First(SerializationInfo info, StreamingContext context)
    {
        something = (SAI)info.GetValue("something", typeof(SAI));
        something1 = (double)info.GetValue("something1",typeof(double));
        something2 = (int)info.GetValue("something2",typeof(int));
    } 
```

下一节课是这样的：

```
[Serializable]
public class Second:ISerializable
{
  public String something3 { get; set; }
  public int something4 { get; set; }
  public bool something5 { get; set; }
  public double something6 { get; set; }
  public System.Drawing.Bitmap something7 { get; set; }
} 
```

和自定义序列化/反序列化部分：

```
private Second(SerializationInfo info, StreamingContext context)
    {
        something3 = (String)info.GetValue("something3",typeof(String));
        something4 = (int)info.GetValue("something4",typeof(int));
        something5 = (bool)info.GetValue("something5",typeof(bool));
        something6 = (double)info.GetValue("something6",typeof(double));
        something7 = (System.Drawing.Bitmap)info.GetValue("something7", typeof(System.Drawing.Bitmap));
    }

    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        info.AddValue("something3", something3,typeof(String));
        info.AddValue("something4", something4,typeof(int));
        info.AddValue("something5", something5,typeof(bool));
        info.AddValue("something6", something6,typeof(double));
        info.AddValue("something7", something7,typeof(System.Drawing.Bitmap));
    } 
```

然后是第二层：

```
[Serializable]
public class Third :ISerializable
{
  public String something8 { get; set; }
  public int something9 { get; set; }
  public System.Drawing.Bitmap something10 { get; set; }
  public First first { get; set; }
  public List<Second> second { get; set; }
} 
```

和序列化/反序列化部分：

```
private Third(SerializationInfo info, StreamingContext context)
    {
        something8 = (String)info.GetValue("something8",typeof(String));
        something9 = (int)info.GetValue("HeroWins",typeof(int));
        something10 = (System.Drawing.Bitmap)info.GetValue("something10", typeof(System.Drawing.Bitmap));
        first = (First)info.GetValue("first", typeof(First));
        second = (List<Second>)info.GetValue("second", typeof(Second));
    }
public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
      info.AddValue("something8", something8,typeof(String));
      info.AddValue("something9", something9,typeof(int));
      info.AddValue("something10", something10, typeof(System.Drawing.Bitmap));
      info.AddValue("first", first, typeof(First));
      info.AddValue("second", second, typeof(List<Second>));
    } 
```

最后是第三级：

```
[Serializable]
public class Fourth:ISerializable
{
     public String something11 { get; set; }
     public List<Third> third { get; set; }
} 
```

和序列化/反序列化部分：

```
private Fourth(SerializationInfo info, StreamingContext context)
    {
        something11 = (String)info.GetValue("something11",typeof(String));
        third = (List<Hero>)info.GetValue("third", typeof(List<Third>));
    }
public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        info.AddValue("something11", Name,typeof(String));
        info.AddValue("third", third,typeof(List<Third>));
    } 
```

**最后**是错误发生的地方：D

```
public partial class MainForm : Form
{
   private List<Fourth> fourth; // this is initialized in Constructor on first time
   private Third t1, t2, t3; // these are initialized in Constructor on first time

   private void MainForm_FormClosing(object sender, FormClosingEventArgs e)
    {
        using (FileStream str = File.Create("Third.bin"))
        {
            BinaryFormatter bf = new BinaryFormatter();
            bf.Serialize(str, t1); 
            bf.Serialize(str, t2);
            bf.Serialize(str, t3);
        }

        using (FileStream str = File.Create("Fourth.bin"))
        {
            BinaryFormatter bf = new BinaryFormatter();
            bf.Serialize(str, fourth);
        }
    }

    private void VersusGlavno_Load(object sender, EventArgs e)
    {
            using (FileStream str = File.OpenRead("Third.bin"))
            {
                BinaryFormatter bf = new BinaryFormatter();
                t1 = (Third)bf.Deserialize(str); //first TargetInvocationException, returns NULL
                t2 = (Third)bf.Deserialize(str); //second TargetInvocationException, returns NULL
                t3 = (Third)bf.Deserialize(str); //third TargetInvocationException, returns NULL
            }
            using (FileStream str = File.OpenRead("Fourth.bin"))
            {
                BinaryFormatter bf = new BinaryFormatter();
                fourth = null;
                fourth = (List<Fourth>)bf.Deserialize(str); //fourth TargetInvocationException, returns NULL
            }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T15:05:57.107

`TargetInvocationException`当反射试图调用引发异常的东西时发生。为了更好地判断发生了什么，请发布详细信息

> TargetInvocationException.InnerException

# regex - 如何将所有包含 IP 地址的 URL 重定向到我的 www 域？

> ID：10559712
> 
> 赞同：4
> 
> 时间：2012-05-11T23:19:32.563
> 
> 标签：regex, apache, mod-rewrite, rewrite

我有几台具有不同 IP 地址的服务器。我想让它无法通过 IP 直接联系到他们。相反，我希望他们重定向到我的域 www.site.com。

以下条件与确切 IP 匹配：

```
RewriteCond %{REMOTE_HOST} !^123\.456\.789\.012$ 
```

如何使用 Apache 重写规则匹配*任何*IP？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T23:21:21.320

请注意，您使用了错误的标签。它不是 REMOTE_HOST，因为这是用户的 ip。您需要 HTTP_HOST 来获取服务器的 IP。

例如：：

```
Options +FollowSymlinks
RewriteEngine On
RewriteCond %{HTTP_HOST} ^\d+\.
RewriteRule (.*) http://www.example.com/$1 [R=301] 
```

*编辑，您可以根据需要使用更具体的正则表达式。主要问题是您的原始标签。*

编辑2：

如果您有要重定向的**特定IP 列表，则可以使用**

```
Options +FollowSymlinks
RewriteEngine On
RewriteCond %{HTTP_HOST} ^111\.111\.111\.111 [OR]
RewriteCond %{HTTP_HOST} ^222\.222\.222\.222
RewriteRule (.*) http://www.example.me/$1 [R=301] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T23:25:39.767

如果您只需要正则表达式，您可以尝试替换`!^123\.456\.789\.012$`：

```
!^[0-9]{0,3}\.[0-9]{0,3}\.[0-9]{0,3}\.[0-9]{0,3}$ 
```

这将匹配 0-9 之间的字符（数字字符）从 0 到每个文字点之间的 3 次，3 个点之间的 4 次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-17T09:17:02.313

比上面的@Fabrício-Matté 稍微完整。它将捕获任何 IP 并将其转换为特定的域名。这在您不确定用户将使用哪个 IP 时尤其有用（例如，当您拥有多个 IP，例如内部和外部 IP 时）：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$
RewriteRule ^(.*)$ http://www.example.com$1 [L,R=301] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T23:27:33.340

如果 Apache 收到一个请求，其中没有明确的 ServerName 或 ServerAlias 匹配的 VirtualHost，它会将所有这些请求定向到定义的第一个 VirtualHost。

我会设置一个单独的默认虚拟主机，并在其中拥有所有“不匹配的请求”功能。

# c++ - 使用“this->”的性能损失？

> ID：10559718
> 
> 赞同：2
> 
> 时间：2012-05-11T23:20:22.667
> 
> 标签：c++

考虑这个类 C 中两个相似的 C++ 成员函数的示例：

```
void C::function(Foo new_f) {
    f = new_f;
} 
```

和

```
void C::function(Foo new_f) {
    this->f = new_f;
} 
```

这些函数是否以相同的方式编译？使用`this->`（更多内存访问或其他）是否有任何性能损失？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T23:22:27.853

是的，它完全相同，您将获得相同的性能。

唯一真正*必须*使用该`this->`语法的情况是，当函数的参数与要访问的实例变量同名时。单独使用变量的名称将引用参数，因此您需要`this->`. 当然，您也可以重命名参数。而且，正如 ildjarn 在评论中指出的那样，您需要`this`在某些情况下使用来调用依赖的函数，因为`this`它是隐式依赖的（尽管您可以阅读更多相关信息）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T23:23:27.033

`this->`从编译器的角度来看，隐式和显式没有区别。

但是请记住，代码应该主要是为人类读者编写的，其次才是为编译器编写的。从这个角度来看，使用`this->`（除了在少数地方确实需要它）是一个巨大的损失，应该从所有代码中删除。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T23:22:23.970

这是一个简写。在这种情况下，它是完全相同的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-12T06:31:27.633

结果代码没有性能损失，因为`this`无论如何编译器都必须使用它来访问该成员。

阅读代码会对我造成*性能*损失，因为我不得不停在这里思考“为什么`this->`需要在这里？是否涉及编码技巧？我是否错过了有关该课程的重要内容？或者编码人员只是插入了一个`this->`无缘无故随机？”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T23:23:43.133

编译器会在你不知道的情况下为你使用这个指针。每当您自己键入时，您都会明确说明它，但（在某些情况下）没有必要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-12T01:22:53.837

您可以通过在 GCC 下使用标志 -S 编译这两个函数来比较它们的汇编输出。这将为输入的 C/C++ 文件生成符号汇编代码，并且两者应该相同。

# jquery - 如何使用jquery获取父元素的href attr？

> ID：10559723
> 
> 赞同：-1
> 
> 时间：2012-05-11T23:20:59.250
> 
> 标签：jquery, find, parent, href, attr

我有这个 html 树示例

```
<div class="auditions_date">
    <div class="new_green above_deadline"><a href="/auditions/2 ?>">Contact</a></div>
    <span class="aud_recommend"><a class="222" id="aud_recommend" href="#recommend_data">test</a></span>
</div>
<div class="auditions_date">
    <div class="new_green above_deadline"><a href="/auditions/3 ?>">Contact</a></div>
    <span class="aud_recommend"><a class="333" id="aud_recommend" href="#recommend_data">test</a></span>
</div> 
```

当我单击`test`链接时，我想获取标签的`href`属性`a`

也许：

```
$('a#aud_recommend').on("click", function() {
        var j = $(this).parent('.auditions_date').find('a').attr('href');
    console.log(j);
}); 
```

这似乎无法正常工作..有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-12T13:21:49.090

```
$(document).ready(function () {
    $('a#aud_recommend').on("click", function (e) {
        //e.preventDefault();
        var j = $(this).parents('.auditions_date').find('.new_green a').attr('href');

        console.log(j);
    });
}); 
```

# ruby-on-rails - Puppet 意外删除了 etckeeper-commit-pre 和 etckeeper-commit-post 有没有办法重新生成这些文件？

> ID：10559724
> 
> 赞同：1
> 
> 时间：2012-05-11T23:21:17.527
> 
> 标签：ruby-on-rails, ubuntu, puppet

基本上我在我的 puppet 目录中进行一些清理时删除了这些文件。现在，当我运行 @app: puppet apply /some/file 时，我收到一条错误消息，指出这些文件在哪里丢失。（当然）

所以我创建了两个新文件，我得到了这个：

错误：无法从 prerun_command 运行命令：执行“/etc/puppet/etckeeper-commit-pre”返回 1：错误：无法从 postrun_command 运行命令：执行“/etc/puppet/etckeeper-commit-post”返回1

任何提示都会非常感谢谢谢安东尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:23:04.007

如果您启用了 Puppet “ [filebucket](http://docs.puppetlabs.com/man/filebucket.html) ”，您可以查看日志以找到已删除文件的哈希值，然后从中恢复。

否则，请转到您的备份，或重新安装它们来自的软件包。

# php - 使用 PHP 在 Selenium WebDriver 上远程上传文件

> ID：10559728
> 
> 赞同：8
> 
> 时间：2012-05-11T23:21:45.597
> 
> 标签：php, file-upload, selenium-webdriver

我一直在搜索 StackOverflow（和其他资源），了解如何使用 PHP 在 Selenium WebDriver 上远程上传文件。我读过这个[http://saucelabs.com/blog/index.php/2012/03/selenium-tips-uploading-files-in-remote-webdriver/](http://saucelabs.com/blog/index.php/2012/03/selenium-tips-uploading-files-in-remote-webdriver/)，它提到你需要使用“setFileDetector”方法以某种方式改变您正在使用的 WebDriver 库的工作方式。

如果我使用的是 Ruby 或 Java，这应该可以正常工作。另一方面，大多数 PHP 框架都没有这种方法。

谁能告诉我如何在 PHP 中做到这一点？具体来说，我正在使用 phpwebdriver 库[http://code.google.com/p/php-webdriver-bindings/](http://code.google.com/p/php-webdriver-bindings/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-12T00:20:42.120

我能够`/session/<sessionId>/file`通过查看 SauceLabs.com 博客文章 ( [https://saucelabs.com/jobs/1a408cf60af0601f49052f66fa37812c/selenium-server.log](https://saucelabs.com/jobs/1a408cf60af0601f49052f66fa37812c/selenium-server.log) ) 上的原始日志来确定上传文件的 JsonWireProtocol ，因此，我创建了这个函数来添加到**php-webdriver-bindings**库：

```
/**
 * Send a file to your Remote WebDriver server
 * This will return the local URL of the file you uploaded, which will then
 * let you use sendKeys in file input elements
 * @params String $value - a local or remote file to send
 * @return String $resopnseValue - the local directory where the file resides on the remote server
 */
public function sendFile($value) {
    $file = @file_get_contents($value);

    if( $file === false ) {
        return false;
    }

    $file = base64_encode($file);
    $request = $this->requestURL . "/file";
    $session = $this->curlInit($request);
    $args = array( 'file' => $file );
    $postargs = json_encode($args);
    $this->preparePOST($session, $postargs);
    $response = trim(curl_exec($session));

    $responseValue = $this->extractValueFromJsonResponse($response);
    return $responseValue;
} 
```

将此添加到**WebDriver.php**文件中。

要使用，只需执行以下操作：

```
...
$file_location = $webdriver->sendFile('http://test.com/some/file.zip');
$file_input = $webdriver->findElementBy(LocatorStrategy::id, 'uploadfile');
$file_input->sendKeys(array($file_location)); 
```

我希望这将帮助其他开发人员，他们花了大约 3 个小时来寻找这个问题的答案。

更新：

由于收到此错误，我不得不更改此设置：

```
Expected there to be only 1 file. There were: 0 
```

希望把它放在这里会得到谷歌的结果（我试着在谷歌上搜索错误消息，它唯一能找到的结果是对谷歌代码上源代码的引用）。

为了解决这个问题，我能够推断出您发送的文件实际上需要压缩。所以我扩充了源代码以使用 PHP 的**ZipArchive**库。我会将旧代码保留在最上面以保存记录，但请在此处使用新代码：

```
public function sendFile($value, $file_extension = '')
{   
    $zip = new ZipArchive();

    $filename_hash = sha1(time().$value);

    $zip_filename = "{$filename_hash}_zip.zip";
    if( $zip->open($zip_filename, ZIPARCHIVE::CREATE) === false ) {
        echo 'WebDriver sendFile $zip->open failed\n';
        return false;
    }

    $file_data = @file_get_contents($value);
    if( $file_data === false ) {
        throw new Exception('WebDriver sendFile file_get_contents failed');
    }

    $filename = "{$filename_hash}.{$file_extension}";
    if( @file_put_contents($filename, $file_data) === false ) {
        throw new Exception('WebDriver sendFile file_put_contents failed');
    }

    $zip->addFile($filename, "{$filename_hash}.{$file_extension}");
    $zip->close();

    $zip_file = @file_get_contents($zip_filename);
    if( $zip_file === false ) {
        throw new Exception('WebDriver sendFile file_get_contents for $zip_file failed');
    }

    $file = base64_encode($zip_file);

    $request = $this->requestURL . "/file";
    $session = $this->curlInit($request);
    $args = array( 'file' => $file );
    $postargs = json_encode($args);
    $this->preparePOST($session, $postargs);
    $response = trim(curl_exec($session));

    return $this->extractValueFromJsonResponse($response);
} 
```

**更新：**原来，您需要在 $zip->addFile() 方法上设置两个参数。编辑了上面的代码以反映更改。

# c# - url重写正则表达式问题

> ID：10559738
> 
> 赞同：0
> 
> 时间：2012-05-11T23:23:12.700
> 
> 标签：c#, asp.net, iis-7, url-rewriting

晚上，

我的任务是将网站从 subdomain.domain.com 移动到 domain.com/subdomain。

我遇到的问题：

原子域和域名都有url重写规则（asp.net、UrlReWriter）

所以，我已经将子域内容文件移动（或者更确切地说，复制）到主域下的新子文件夹，事情似乎进展顺利，但有一两个问题......

我需要匹配以下内容：

[http://www.maindomain.com/category.aspx?name=foo](http://www.maindomain.com/category.aspx?name=foo) -> [http://www.maindomain.com/foo/](http://www.maindomain.com/foo/) http://www.maindomain.com/viewproduct.aspx?catName=foo&productName=bar -> [http://www.maindomains.com/foo/bar.aspx](http://www.maindomains.com/foo/bar.aspx)

我有点已经开始工作了，但是由于配置文件继承，我必须在主应用程序（主域）web.config 中指定重写规则，所以我还需要匹配这些规则：

[http://www.maindomain.com/us/category.aspx?name=foo](http://www.maindomain.com/us/category.aspx?name=foo) -> [http://www.maindomain.com/us/foo/](http://www.maindomain.com/us/foo/) http://www.maindomain.com/us/viewproduct.aspx ?catName=foo&productName=bar -> [http://www.maindomain.com/us/foo/bar.aspx](http://www.maindomain.com/us/foo/bar.aspx)

显然，重写引擎需要忽略 css/images 其他文件等，例如：

[http://www.maindomain.com/about.aspx](http://www.maindomain.com/about.aspx) & [http://www.maindomain.com/us/about.aspx](http://www.maindomain.com/us/about.aspx)

需要任何其他信息，只是问..

我目前的规则是：

```
 <rewrite url="^(/.+(\.gif|\.png|\.jpg|\.ico|\.pdf|\.css|\.js)(\?.+)?)$" to="$1" processing="stop"/>
<rewrite url="^/us/.+(\.gif|\.png|\.jpg|\.ico|\.pdf|\.css|\.js)(\?.+)?$" to="$1" processing="stop"/>

<rewrite url="^/us/Error.aspx" to="$1" processing="stop"/>
<rewrite url="^/us/Error404.aspx" to="$1" processing="stop"/>

<rewrite url="Error.aspx" to="$1" processing="stop"/>
<rewrite url="Error404.aspx" to="$1" processing="stop"/>

    <rewrite url="^/us/$" to="$1" processing="stop"/>
<rewrite url="^/us/(.+)/(.+).aspx" to="/us/viewProduct.aspx?productName=$2&amp;catName=$1" processing="stop"/>
<rewrite url="^/us/(.+)/" to="/us/category.aspx?name=$1" processing="stop"/>

<rewrite url="^/(.+)/(.+).aspx" to="~/viewProduct.aspx?productName=$2&amp;catName=$1" processing="stop"/>
<rewrite url="^/(.+)/" to="~/category.aspx?name=$1" processing="stop"/> 
```

使用，iis7.5，c#，asp.net v2 谢谢迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T12:23:53.650

这里有几个问题。首先是下面的重写规则不起作用：

```
<rewrite url="^/us/$" to="$1" processing="stop"/> 
```

您要求重写模块将 url 替换为`/us/`匹配组一，但您的捕获表达式中没有组。要解决此问题并处理 tha`/us/`文件夹中的 .aspx 文件，请将其替换为以下两条规则：

```
<rewrite url="^/us/$" to="/us/default.aspx" processing="stop"/>
<rewrite url="^(/us/[^/]+\.aspx)$" to="$1" processing="stop"/> 
```

此外，`/us/`不需要您的第二个重写规则（用于文件夹中的静态内容），因为第一个重写规则不关心文件在哪个文件夹中，并且会匹配（并停止处理）诸如`/us/images/foo.jpg`.

# html - HTML 元素与同级居中元素的边缘右对齐

> ID：10559739
> 
> 赞同：2
> 
> 时间：2012-05-11T23:23:18.890
> 
> 标签：html, css, layout

我想使用 CSS 获得特定的布局，如下所示，我不确定是否可能。div 中有一些居中的文本。在下面，还有另一个 div 里面有文本；我想做的是右对齐此文本，使其右边缘与上方文本的右边缘齐平。

使用 CSS，我不知道如何做到这一点。显然，以下方法不起作用，因为子标题将与容器右对齐。但是有什么技巧可以完成我想要的对齐吗？

~~<div style='text-align: center;'>这是一些标题文字</div>~~

~~<div style='text-align: right;'>副标题文字</div>~~

**注意：**强烈偏好直接使用 CSS（如果可能，不要使用 Javascript）。

**注意#2：**我不拘泥于上面的 HTML。我可以使用任何完成所述对齐的标记。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T23:40:19.600

> @thirtydot 不，我对任何可以完成对齐的 HTML 都很满意。

那么试试这个：http: [//jsfiddle.net/thirtydot/nU9Cj/](http://jsfiddle.net/thirtydot/nU9Cj/)

```
<div style='text-align: center'>
    <span style="position: relative">This is some headline text
        <span style='position: absolute; top: 100%; right: 0; font-weight: bold'>Sub-header text</span>    
    </span>
</div> 
```

您可能想在 , 中添加一些`padding-bottom`内容`div`，以弥补由于绝对定位的子标题而损失的高度。

# php - Zend_Date::sub() 和 ISO_8601 计算时差错误

> ID：10559743
> 
> 赞同：0
> 
> 时间：2012-05-11T23:23:32.987
> 
> 标签：php, zend-framework, iso8601, zend-date

我想计算两个 Zend_Date 对象之间的时间差（用于倒计时计算器）：

```
$now = new Zend_Date($now_datetime, Zend_Date::ISO_8601);
$end= new Zend_Date($end_datetime, Zend_Date::ISO_8601);
echo $now->getIso(); 
echo $end->getIso();

$expires=array();
$expires['expired']=false;
if($end->isEarlier($now)){
   $expires['expired']=true;
   return $expires;
}

$dif=$end->sub($now);
$expires['days']=($dif->getDay()->toValue()/(60*60*24));
$expires['hours']=($dif->getHour()->toValue()/(60*60));
$expires['minutes'] = $dif->getMinute()->toValue()/60;
$expires['seconds'] = $dif->getSecond()->toValue();

var_dump($expires); 
```

对于 $now_datetime =' **2012-06-30 01:01:01** ' 和 $end_datetime=' **2012-06-30 23:59:59** '，结果是

```
2012-06-30T01:01:01+02:00
2012-06-30T23:59:59+02:00
//array
'expired' => boolean false
'days' => int 0
'hours' => int 22
'minutes' => int 58
'seconds' => int 58 
```

没关系。

但是对于 $now_datetime =' **2012-06-30 00:01:01** ' 和 $end_datetime=' **2012-06-30 23:59:59** '，结果是

```
2012-06-30T00:01:01+02:00
2012-06-30T23:59:59+02:00
//array
'expired' => boolean false
'days' => int 1
'hours' => int -1
'minutes' => int 58
'seconds' => int 58 
```

这是不行的。我希望“小时”是**23**，而不是**-1**？！

我正在使用 php 5.3、Zend_Framework 1.10 运行 MAMP。那有什么问题？ISO_8601 用于 MySQL 'datetime' 数据，我不想更改为 mktime()...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T07:04:52.130

尝试设置

```
date_default_timezone_set('UTC'); 
```

在你的 index.php 中 .. 它会正常工作..

# linux - 如何在 ubuntu 上使用伯克利包过滤器（BPF）

> ID：10559751
> 
> 赞同：2
> 
> 时间：2012-05-11T09:52:39.920
> 
> 标签：linux, networking, firewall, c

我进行了搜索，但没有找到可以在我的计算机上使用的任何 BPF 代码，也没有任何示例代码可供使用。我的目标是找到过滤数据包的低级函数。我正在使用 C 程序语言工作。我正在使用带有 3.2.0 内核的 Ubuntu 12.04。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T23:30:35.173

您可能想从为您带来 tcpdump 的人那里查看[pcap库。](http://www.tcpdump.org/)Pcap 是一个跨平台的包过滤库，支持 BPF 过滤器。

# wordpress - 两个子文件夹中博客的正确 WordPress .htaccess 是什么？

> ID：10559752
> 
> 赞同：0
> 
> 时间：2012-05-11T23:25:55.630
> 
> 标签：wordpress, .htaccess, subdirectory

假设您在 www.example.com/folder1/folder2 目录中安装了一个 WordPress 站点。假设您希望网站显示为 www.example.com/folder1。

folder1 中的 .htaccess 应该是什么样子才能正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T16:39:22.447

找到了我自己的答案。对于上述情况，正确的 .htaccess 配置是：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /folder1/folder2/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /folder1/folder2/index.php [L]
</IfModule> 
```

# database - 如何让每个列表视图项显示不同的数据？

> ID：10559754
> 
> 赞同：1
> 
> 时间：2012-05-11T23:26:39.287
> 
> 标签：database, listview

我正在创建一个应用程序来组织学校课程并为每个班级输入作业。单击列表视图中的课程时，应显示该特定课程分配的另一个布局。我将如何保存每门课程的作业，以便在选择另一门课程时，使用如下数据库显示特定课程作业？

提前致谢。

```
public class CourseTable {

    // Database table
    public static final String TABLE_COURSE = "course";
    public static final String COLUMN_ID = "_id";
    public static final String COLUMN_NAMECOURSE = "namecourse";
    public static final String COLUMN_DAYOFCOURSE = "dayofcourse";
    public static final String COLUMN_TIMEOFCOURSE = "timeofcourse";

    // Database creation SQL statement
    private static final String DATABASE_CREATE = "create table " 
                + TABLE_COURSE
                + "(" 
                + COLUMN_ID + " integer primary key autoincrement, " 
                + COLUMN_NAMECOURSE + " text not null, " 
                + COLUMN_DAYOFCOURSE + " text not null," 
                + COLUMN_TIMEOFCOURSE + " text not null,"
                + ");";

    public static void onCreate(SQLiteDatabase database) {
        database.execSQL(DATABASE_CREATE);
    }

    public static void onUpgrade(SQLiteDatabase database, int oldVersion,
            int newVersion) {
        Log.w(CourseTable.class.getName(), "Upgrading database from version "
                + oldVersion + " to " + newVersion
                + ", which will destroy all old data");
        database.execSQL("DROP TABLE IF EXISTS " + TABLE_COURSE);
        onCreate(database);
    } 
```

内容提供商：

```
public class CourseContentProvider extends ContentProvider {

    // database
    private CourseDBHelper database;

    // Used for the UriMacher
    private static final int COURSES = 10;
    private static final int COURSE_ID = 20;

    private static final String AUTHORITY = "entcproject.organizer.tamu.main.contentprovider";

    private static final String BASE_PATH = "courses";
    public static final Uri CONTENT_URI = Uri.parse("content://" + AUTHORITY
            + "/" + BASE_PATH);

    public static final String CONTENT_TYPE = ContentResolver.CURSOR_DIR_BASE_TYPE
            + "/courses";
    public static final String CONTENT_ITEM_TYPE = ContentResolver.CURSOR_ITEM_BASE_TYPE
            + "/course";

    private static final UriMatcher sURIMatcher = new UriMatcher(
            UriMatcher.NO_MATCH);
    static {
        sURIMatcher.addURI(AUTHORITY, BASE_PATH, COURSES);
        sURIMatcher.addURI(AUTHORITY, BASE_PATH + "/#", COURSE_ID);
    }

    @Override
    public boolean onCreate() {
        database = new CourseDBHelper(getContext());
        return false;
    }

    @Override
    public Cursor query(Uri uri, String[] projection, String selection,
            String[] selectionArgs, String sortOrder) {

        SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();

        checkColumns(projection);

        queryBuilder.setTables(CourseTable.TABLE_COURSE);

        int uriType = sURIMatcher.match(uri);
        switch (uriType) {
        case COURSES:
            break;
        case COURSE_ID:
            queryBuilder.appendWhere(CourseTable.COLUMN_ID + "="
                    + uri.getLastPathSegment());
            break;
        default:
            throw new IllegalArgumentException("Unknown URI: " + uri);
        }

        SQLiteDatabase db2 = database.getWritableDatabase();
        Cursor cursor = queryBuilder.query(db2, projection, selection,
                selectionArgs, null, null, sortOrder);
        cursor.setNotificationUri(getContext().getContentResolver(), uri);

        return cursor;
    }

    @Override
    public Uri insert(Uri uri, ContentValues values) {
        int uriType = sURIMatcher.match(uri);
        SQLiteDatabase sqlDB = database.getWritableDatabase();
        int rowsDeleted = 0;
        long id = 0;
        switch (uriType) {
        case COURSES:
            id = sqlDB.insert(CourseTable.TABLE_COURSE, null, values);
            break;
        default:
            throw new IllegalArgumentException("Unknown URI: " + uri);
        }
        getContext().getContentResolver().notifyChange(uri, null);
        return Uri.parse(BASE_PATH + "/" + id);
    }

    @Override
    public int update(Uri uri, ContentValues values, String selection,
            String[] selectionArgs) {

        int uriType = sURIMatcher.match(uri);
        SQLiteDatabase sqlDB = database.getWritableDatabase();
        int rowsUpdated = 0;
        switch (uriType) {
        case COURSES:
            rowsUpdated = sqlDB.update(CourseTable.TABLE_COURSE, 
                    values, 
                    selection,
                    selectionArgs);
            break;
        case COURSE_ID:
            String id = uri.getLastPathSegment();
            if (TextUtils.isEmpty(selection)) {
                rowsUpdated = sqlDB.update(CourseTable.TABLE_COURSE, 
                        values,
                        CourseTable.COLUMN_ID + "=" + id, 
                        null);
            } else {
                rowsUpdated = sqlDB.update(CourseTable.TABLE_COURSE, 
                        values,
                        CourseTable.COLUMN_ID + "=" + id 
                        + " and " 
                        + selection,
                        selectionArgs);
            }
            break;
        default:
            throw new IllegalArgumentException("Unknown URI: " + uri);
        }
        getContext().getContentResolver().notifyChange(uri, null);
        return rowsUpdated;
    }

    private void checkColumns(String[] projection) {
        String[] available = { CourseTable.COLUMN_NAMECOURSE,
                CourseTable.COLUMN_DAYOFCOURSE, CourseTable.COLUMN_TIMEOFCOURSE,
                CourseTable.COLUMN_ID };
        if (projection != null) {
            HashSet<String> requestedColumns = new HashSet<String>(
                    Arrays.asList(projection));
            HashSet<String> availableColumns = new HashSet<String>(
                    Arrays.asList(available));
            // Check if all columns which are requested are available
            if (!availableColumns.containsAll(requestedColumns)) {
                throw new IllegalArgumentException(
                        "Unknown columns in projection");
            }
        }
    }

} 
```

# c# - 从 C# 连接到 Exchange 的 PowerShell 命令

> ID：10559757
> 
> 赞同：1
> 
> 时间：2012-05-11T23:26:56.190
> 
> 标签：c#, powershell, exchange-server

我有以下命令连接到 Exchange PowerShell。我使用 C# 进行连接，但是最后一行 ,`Import-PSSession $Session`使站点崩溃并将我带到调试器。

```
$password = ConvertTo-SecureString -AsPlainText -Force mypassword;$mycred = new-object -typename System.Management.Automation.PSCredential -argumentlist me@mail.net,$password;$LiveCred = Get-Credential -Credential $mycred;$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlookurlforpowershell/ -Credential $LiveCred -Authentication Basic –AllowRedirection; Import-PSSession $Session 
```

这是我的 C# 代码：

```
private void initconnection(string text){

    Runspace rs = GetRunspace();
    Pipeline cmd = rs.CreatePipeline(text);
    Collection<PSObject> results = cmd.Invoke();
}

initconnection("$password = ConvertTo-SecureString -AsPlainText -Force Maxipereyra15;$mycred = new-object -typename System.Management.Automation.PSCredential -argumentlist cpereyra@crescentmortgage.net,$password;$LiveCred = Get-Credential -Credential $mycred;$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://ps.outlook.com/powershell/ -Credential $LiveCred -Authentication Basic –AllowRedirection; Import-PSSession $Session"); 
```

我该如何解决这个问题？

# asp.net-mvc - 使用 Knockout.js (MVC Razor) 将复选框绑定到数组

> ID：10559759
> 
> 赞同：3
> 
> 时间：2012-05-11T23:27:16.263
> 
> 标签：asp.net-mvc, asp.net-mvc-3, knockout.js

我有一个看起来像这样的 Knockout.js 视图模型：

```
"UserName":null,
"FirstName":null,
"LastName":null,
"Countries":{
    "arrCountries":[]
} 
```

以及一组必须使用相同`data-bind`值呈现的国家/地区复选框（我正在使用[此](http://www.codeproject.com/Articles/292050/MVC3-Html-CheckBoxList-custom-extension)自定义 CheckBoxListFor 助手，它可以将自定义 HTML 应用于每个复选框，但每个复选框的自定义 HTML 相同。它需要一个列出的属性我的 razor 视图模型中的每个可用国家都创建复选框，然后根据另一个 razor 视图模型属性将一些渲染为标记）。

复选框值是整数（1、2、3 等），我想将这些整数放入`arrCountries`视图模型的属性中。

以下是当前复选框的呈现方式：

```
<input checked="checked" data_bind="checked: ???" id="Countries.arrCountries107" name="Countries.arrCountries" type="checkbox" value="1"></input> 
```

我已经证明了使用`viewModel.Countries.arrCountries.push(1);`来更新视图模型的概念（随后是一个警报，它给我 arrCountries 中的元素计数以证明`push`有效），但我似乎无法获得`data-bind`复选框上的 HTML 属性连线，以便他们在我发送`push`和`remove`命令时检查和取消检查。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-12T03:56:25.903

使选中的数据属性指向所选国家。如果复选框的值在复选框数组中，则将对其进行检查。否则不会。

```
<input checked="checked" data-bind="checked: Countries" type="checkbox" value="3"></input> 
```

看看我放的这个小提琴。

[http://jsfiddle.net/u8xP9/3/](http://jsfiddle.net/u8xP9/3/)

# ruby-on-rails-3 - 急切加载 - 仅加载特定记录

> ID：10559764
> 
> 赞同：0
> 
> 时间：2012-05-11T23:28:02.567
> 
> 标签：ruby-on-rails-3

关于急切加载的快速问题。我有以下代码：

> @user = User.includes(:restaurants).find_by_unique_identifier(params[:unique_identifier])

但是，我只想加载与给定用户关联的餐厅，前提是餐厅的 list_id 为 X（这是餐厅表的列之一）。

我该怎么办？

我尝试了以下操作，但它仍然加载了与用户关联的所有餐厅记录。

```
@user = User.includes(:restaurants).where(:restaurants => {:list_id => params[:list_id]}).find_by_unique_identifier(params[:unique_identifier]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:38:32.170

假设您已设置所有关联要求，则可以使用`joins`：

```
@user = User.all(:conditions =>["restaurants.list_id = ?", params[:list_id] ], :joins => [:restaurants]) 
```

**更新：**
*我的代码获取用户列表。但是，您可以使用过滤方法缩小列表范围或获取单个记录。*

# ruby-on-rails - 如何在 Ruby 中将 MS excel 日期从浮点数转换为日期格式？

> ID：10559767
> 
> 赞同：10
> 
> 时间：2012-05-11T23:28:46.547
> 
> 标签：ruby-on-rails, ruby, excel, date, activesupport

尝试在 ruby​​ 脚本中使用 roo gem 解析和 XLSX 文件。

在 Excel 中，日期以 DDDDD.ttttt 格式存储为浮点数或整数，从`1900-01-00 (00 no 01)`. 因此，为了转换诸如 40396 之类的日期 - 你会得到`1900-01-00 + 40396`，你应该得到 2010-10-15，但我得到的是 2010-08-08。

我正在使用 active_support/time 进行计算，如下所示：

```
Time.new("1900-01-01") + 40396.days 
```

我的计算是错误的还是主动支持中存在错误？

我在 Windows 7 + 最新的 active_support gem (3.2.1) 上运行 ruby​​ 1.9.3-mri

**编辑**

我在 Excel 中查看带有错误数据的旧文件 - 我的脚本/控制台正在提取正确的数据 - 因此我感到困惑 - 除了使用正确的文件之外，我做的一切都是正确的！！！！该死的通宵达旦！

感谢大家的回复，如果有人需要有关如何使用 ruby​​ 从 excel 转换日期的信息，我会将问题保留在这里。

同样对于遇到此问题的其他任何人-电子表格gem目前不支持正确读取XLSX文件（v 0.7.1）-因此我使用 roo 进行阅读，并使用 axlsx 进行写作。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-12T01:12:46.793

您的日期编号有一个错误 - 由于 Lotus 1-2-3 中的一个错误，Excel 和其他电子表格程序已经小心地保持了 30 多年的兼容性。

最初，第 1 天打算是 1900 年 1 月 1 日（如您所说，这将使第 0 天等于 1899 年 12 月 31 日）。但是 Lotus 错误地认为 1900 年是闰年，所以如果你使用现在的 Lotus 数字并倒数，正确地将 1900 年设为普通年，那么 1900 年 3 月 1 日之前的所有日期数字都太高了。第 1 天变为 1899 年 12 月 31 日，第 0 天移回 30 日。因此，基于 Lotus 的电子表格中日期算术的纪元实际上是 1899 年 12 月 30 日星期六。（现代 Excel 和其他一些电子表格扩展了 Lotus 错误兼容性，足以显示 1900 年 2 月实际上有第 29 天，因此它们将标记日期0 “12 月 31 日”，同时同意这是星期六！但其他基于 Lotus 的电子表格不这样做，Ruby 当然也不这样做。）

但是，即使允许出现此错误，您所说的示例也不正确：Lotus day number 40,396 是 2010 年 8 月 6 日，而不是 10 月 15 日。我已经在 Excel、LibreOffice 和 Google 表格中确认了此通信，所有这些都同意。您一定在某处遇到过示例。

这是进行转换的一种方法：

```
Time.utc(1899,12,30) + 40396.days #=> 2010-08-06 00:00:00 UTC 
```

或者，您可以利用另一个已知的通信。Ruby（以及一般的 POSIX 系统）的时间为零是 1970 年 1 月 1 日，格林威治标准时间午夜。1970 年 1 月 1 日是莲花日 25,569。只要您记得使用 UTC 进行计算，您也可以这样做：

```
Time.at( (40396 - 25569).days ).utc # => 2010-08-06 00:00:00 UTC 
```

在任何一种情况下，您可能都希望为纪元日期声明一个符号常量（`Time`表示 1899-12-30 的对象或 POSIX“第 0 天”值 25,569）。

`.days`如果您不需要`active_support/core_ext/integer/time`其他任何内容并且不想为此加载它，则可以将这些调用替换为乘以 86400（每天秒数）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-06T16:18:02.040

“Excel 将日期和时间存储为一个数字，表示自 1900 年 1 月 0 日以来的天数，加上 24 小时日的小数部分：ddddd.tttttt。这称为序列日期或序列日期时间。” ( [http://www.cpearson.com/excel/datetime.htm](http://www.cpearson.com/excel/datetime.htm) )

如果您的列包含日期时间，而不仅仅是日期，则以下代码很有用：

```
 dt = DateTime.new(1899, 12, 30) + excel_value.to_f 
```

另请记住，Excel 工作表中有 2 种日期模式，基于 1900 和基于 1904，通常默认情况下会为在 Mac 上创建的电子表格启用。如果您始终发现日期相差 4 年，则应使用不同的基准日期：

```
 dt = DateTime.new(1904, 1, 1) + excel_value.to_f 
```

您可以为任何电子表格启用/禁用 1904 日期模式，但如果您在添加数据后更改设置，则日期将在电子表格中显示 4 年。一般来说，您应该始终使用 1900 日期模式，因为大多数 excel 用户都是基于 Windows 的。

注意：这种方法的一个问题是舍入可能会发生 +/- 1 秒。对我来说，我导入的日期“足够接近”，但需要牢记。更好的解决方案可能会使用小数秒的舍入来解决此问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-12T01:12:07.783

你计算错了。您如何得出 2010-10-15 的预期结果？

在 Excel 中，`40396`是`2010-08-06`（当然不使用 1904 年的日历）。为了证明这一点，在 Excel 单元格中键入 40396 并将格式设置为`yyyy-mm-dd`.

或者：

```
40396 / 365.2422 = 110.6 (years -- 1900 + 110 = 2010)
0.6 * 12 = 7.2 (months -- January = 1; 1 + 7 = 8; 8 = August)
0.2 * 30 = 6 (days) 
```

Excel 的日历错误地包含 1900-02-29；这说明了您 2010-08-08 结果之间的一天差异；我不确定第二天差异的原因。

# linux - .screenrc chdir 中的通配符

> ID：10559769
> 
> 赞同：1
> 
> 时间：2012-05-11T23:28:58.747
> 
> 标签：linux, wildcard, gnu-screen

我正在尝试构建一个`.screenrc`适合我的需求。为此，我想做一个`chdir`我不知道确切名称的目录。在 Bash 我会做

```
cd /path/to/some-V4.3.*/sub/directory/ 
```

进入当前存在的 4.3.x 目录，但只能有一个。现在，如果有的话，我怎么能做到这一点`.screenrc`？

```
chdir /path/to/some-V4.3.*/sub/directory/ 
```

不起作用，它告诉我该目录不存在，因为未扩展通配符。

# linux - 带有 Control-m 字符的文件

> ID：10559774
> 
> 赞同：2
> 
> 时间：2012-05-11T23:29:36.203
> 
> 标签：linux

我们正在使用 Windows 机器，代码部署在 linux 中。

在开发一些 linux 脚本时，我们有一些 ctrl-m 字符。版本提供给客户。

对 shell 脚本中的 ctrl-m 字符有什么影响。

努斯

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-28T19:06:20.033

在 vi 编辑器中打开文件

按转义键并在文件的命令行中键入以下内容。

:%s/^M//g

确保通过按 Cntrl 键 + V + M 添加 ^M 然后按 Enter

它将删除字符，您可以保存文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-12T00:35:56.503

It will change the shebang line, so that the interpreter isn't found.

```
$ ./t.sh
bash: ./t.sh: /bin/bash^M: bad interpreter: No such file or directory 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-12T01:27:57.203

`^M`字符是回车符。`CR`Windows 和 DOS 以(`^M`或 ASCII 代码 13) 后跟`LF`(`^J`或换行符，ASCII 代码 10)来终止文本行。Linux 使用 just `LF`，因此回车符作为文本的一部分出现并被解释为这样。这意味着他们会破坏脚本。

大多数 linux 发行版都预装了一个名为[dos2unix的实用程序。](http://linuxcommand.org/man_pages/dos2unix1.html)您可以使用它将行尾字符从 DOS 样式转换为 linux 样式。

有些编辑器会自动为您进行转换；其他人有让您指定使用哪种模式的选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-11T05:04:00.830

您也可以使用以下语法。由于在 Windows 中，此 Control+v+m 不起作用，您可以使用 \r 代替。

使用带有 -b 选项的 vim 编辑器以二进制模式打开文件以查看 Control-M 字符并使用以下命令替换 Control-M 字符

> %s@\r@@g

# css - css命中时更改文本输入边框颜色

> ID：10559782
> 
> 赞同：1
> 
> 时间：2012-05-11T23:30:52.480
> 
> 标签：css

# css命中时更改文本输入边框颜色

你好

我有这个 html 字段

```
<input type=text value=test id=ff> 
```

我正在使用这个 css 代码来设置边框

```
#ff{
border:1px #000 solid
} 
```

当我单击该字段时，我想将边框颜色更改为（红色）

例如：谷歌搜索栏，当你点击搜索栏写任何东西时，边框会变成蓝色

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T23:32:14.873

```
#ff:focus {border-color: #f00; } 
```

对于 IE7，您可以使用 JavaScript（尤其是 jQuery），例如：

```
<style>
    #ff:focus,
    #ff.focus {border-color: #f00; }
</style>

<!--[if lte IE 7]>
<script>
$('#ff').focus(function() {
    $(this).addClass('focus');
}).blur(function() {
    $(this).removeClass('focus');
});
</script>
<![endif]--> 
```

# zend-framework - xml配置中的Zend Navigation路由不使用传入的参数

> ID：10559786
> 
> 赞同：1
> 
> 时间：2012-05-11T23:31:28.700
> 
> 标签：zend-framework, zend-navigation, zend-config-xml

我有一条路线：

```
resources.router.routes.page.route = "page/:page"
resources.router.routes.page.defaults.module = "core"
resources.router.routes.page.defaults.controller = "page"
resources.router.routes.page.defaults.action = "view"
resources.router.routes.page.defaults.page = "home" 
```

这是我的导航xml：

```
<company>
    <label>Company</label>
    <route>page</route>
    <page>company</page>
</company> 
```

正如您在此处看到的，我想在我的 zend 导航 xml 中使用我的路线（并使用页面变量）。问题是，页面元素没有被使用。结果变为：

`http://localhost/website/public/page`

代替

`http://localhost/website/public/page/company`

如何让 zend 导航使用页面参数？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T03:50:11.620

您需要将页面元素包装在 params 元素中。见如下：

```
<company>
    <label>Company</label>
    <route>page</route>
    <params>
       <page>company</page>
    </params>
</company> 
```

# matlab - 降噪

> ID：10559788
> 
> 赞同：0
> 
> 时间：2012-05-11T23:31:47.200
> 
> 标签：matlab, math, image-processing, noise-reduction

我有一个灰度值 = 100 处处强度均匀的图像，然后我添加了标准偏差 = 5 的附加零均值独立高斯噪声

```
I = ones(100,100)*100;
I_n=I+(5*randn(100,100)); 
```

我认为噪声图像中像素强度的均值和标准差将分别为 100 和 5，

然后我想通过 2x2 平均掩码来减少嘈杂图像中的噪声。

平均掩膜对图像中像素强度的均值和标准偏差有何影响？增加口罩的尺寸会更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:38:42.260

对于统一的原始图像和统一的噪声，平均不会改变平均值。它会减少像素之间的变化，但也会使相邻像素之间的噪声相关。

如果您计算标准偏差，那么您会发现该值为 2.5（减少了 2 倍，2 = sqrt(4)，平均 4 个值）。

使用更大的蒙版将进一步降低噪点，但会将其与更多像素相关联。它还会模糊底层图像中的任何结构（在这种情况下不是问题，因为它是统一的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T16:05:51.620

在这些情况下，标准平均技术将无法正常工作。如果您有自相关矩阵，只需使用[维纳滤波器](http://en.wikipedia.org/wiki/Wiener_deconvolution)，否则使用带有合适内核矩阵的高斯过程回归。

# python - glibc 检测到 *** python: 双重释放或损坏 (!prev) SWIG

> ID：10559791
> 
> 赞同：5
> 
> 时间：2012-05-11T23:32:05.230
> 
> 标签：python, swig, glibc

在 SWIG 中为我的 C++ 算法编写了一个包装器后，当我在导入模块后退出 Python 解释器时，我经常收到此错误：

```
 $ python
    iPython 2.5.6 (r256:88840, Mar 10 2012, 14:05:15) 
    [GCC 4.4.3] on linux2
    Type "help", "copyright", "credits" or "license" for more information.
    >>>from algol import *
    >>> 
    *** glibc detected *** python: double free or corruption (!prev): 0x0000000001e42430 *** 
```

然后我必须按 Ctrl+C 才能重新获得控制权……发生了什么事？

我正在运行以下命令来构建我的 SWIG 包装器：

```
$NAME=algol
swig -c++ -python $NAME.i
g++ -fpic -c $NAME.cpp $NAME.hpp $NAME\_wrap.cxx -I/usr/local/include/python2.5
g++ -Xlinker -zmuldefs -shared $NAME.o $NAME\_wrap.o -o _$NAME.so 
```

我的 swig 接口文件只是 algol.hpp 的一个包含：

```
%module algol
%{
#include "algol.hpp"
%}
%include "algol.hpp" 
```

你怎么看待这件事？:S

编辑：在此处附加示例源代码-> [http://pastebin.com/q210vEAs](http://pastebin.com/q210vEAs)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T15:39:46.590

> 怎么了？

正是消息所说的：某些代码执行了双重释放，或者其他一些堆损坏。

正如 awoodland 所建议的那样，在 Valgrind 下运行 python，并查看*发生*损坏或双重释放的位置。

# python - 任何顺序的正则表达式或语句

> ID：10559794
> 
> 赞同：0
> 
> 时间：2012-05-11T23:33:00.107
> 
> 标签：python, regex

Python 正则表达式 我有一个包含关键字的字符串，但有时这些关键字不存在，而且它们没有任何特定的顺序。我需要正则表达式方面的帮助。

关键字是：

```
Up-to-date
date added
date trained 
```

这些是我需要在许多其他关键字中找到的关键字，它们可能不存在并且将按任何顺序排列。

刺痛是什么样子的

```
<div>
<h2 class='someClass'>text</h2>

 blah blah blah Up-to-date blah date added blah

</div> 
```

我试过的：

```
regex = re.compile('</h2>.*(Up\-to\-date|date\sadded|date\strained)*.*</div>') 

regex = re.compile('</h2>.*(Up\-to\-date?)|(date\sadded?)|(date\strained?).*</div>')

re.findall(regex,string) 
```

我正在寻找的结果是：

```
If all exists
['Up-to-date','date added','date trained']

If some exists
['Up-to-date','','date trained'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:41:57.227

它必须是正则表达式吗？如果没有，您可以使用`find`：

```
In [12]: sentence = 'hello world cat dog'

In [13]: words = ['cat', 'bear', 'dog']

In [15]: [w*(sentence.find(w)>=0) for w in words]
Out[15]: ['cat', '', 'dog'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:46:50.990

这段代码做你想做的事，但它闻起来很臭：

```
import re

def check(the_str):
    output_list = []
    u2d = re.compile('</h2>.*Up\-to\-date*.*</div>') 
    da = re.compile('</h2>.*date\sadded*.*</div>')
    dt = re.compile('</h2>.*date\strained*.*</div>')
    if re.match(u2d, the_str):
        output_list.append("Up-to-date")
    if re.match(da, the_str):
        output_list.append("date added")
    if re.match(dt, the_str):
        output_list.append("date trained")

    return output_list

the_str = "</h2>My super cool string with the date added and then some more text</div>"
print check(the_str)
the_str2 = "</h2>My super cool string date added with the date trained and then some more text</div>"
print check(the_str2)
the_str3 = "</h2>My super cool string date added with the date trained and then Up-to-date some more text</div>"
print check(the_str3) 
```

# php - 在页面上回显数据是否安全？

> ID：10559796
> 
> 赞同：3
> 
> 时间：2012-05-11T23:33:26.640
> 
> 标签：php, security

我有一个表单，用户可以在其中输入 Web 模板，然后他们可以在浏览器中进行预览。

此页面仅供他们查看：

```
<?php
echo "<title>".htmlspecialchars($_POST['title'], ENT_QUOTES)."</title><br/>";
echo nl2br($_POST['body']);
?> 
```

我在测试时意识到它可以访问我的本地 css 文件/js 文件。这让我想知道这是否可能导致安全攻击？

站点 cookie 具有域标志和 httponly 标志。如果客户端尝试 XSS，他们只会利用自己，对吗？

我的 Web 服务器回显 $_POST 是否安全？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:43:09.117

即使使用 httponly 标志，您仍然希望防止 XSS，原因如下：http://lcamt [​​uf.coredump.cx/postxss/](http://lcamtuf.coredump.cx/postxss/)。攻击者可以窃取页面上显示的其他有价值的信息，除了 cookie。

# objective-c - 如何从 NSData 中分辨出 NSStringEncoding？

> ID：10559798
> 
> 赞同：0
> 
> 时间：2012-05-11T23:33:33.297
> 
> 标签：objective-c, nsdata, nsjsonserialization, nsstringencoding

我`NSData`从`+[NSJSONSerialization dataWithJSONObject:options:error:]`. 数据是如何编码的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T23:36:40.277

看.h文件中方法上面的注释：

> 结果数据以 UTF-8 编码。

# coffeescript - Sammy.js - 渲染外部路线

> ID：10559801
> 
> 赞同：0
> 
> 时间：2012-05-11T23:34:02.640
> 
> 标签：coffeescript, haml, sammy.js

我正在构建一个 Sammy 应用程序，我想为此使用 Haml。到目前为止看起来不错。

```
app = $.sammy '#main', ->
    @use 'Haml'

    # Get some server data
    $.getJSON '/some-data', (data) ->
        # Hic sunt ponies

    @get '#!/', ->
        @partial '/tmpl/maintenance.haml'

    @

$ -> app.run '#!/' 
```

我有一个模板`/tmpl/navbar.haml`，我想在任何路由之前渲染。这样做的原因是，导航栏依赖于我从服务器接收到的一些数据——同样，在路由之前。

那么如何在路由之外渲染模板呢？Sammy 似乎没有为此读取的方法，仅在 a 内部[`RenderContext`](http://sammyjs.org/docs/api/0.7.1/all#Sammy.RenderContext)，例如路由。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T08:04:23.873

我使用了 'location-changed' 事件，可能并不理想，但似乎有效：

```
this.bind('location-changed', function(context) {
  var url = escape(app.getLocation());
  if (app.connected()) {
      $('#welcome').html(i18n('text_logged', 'index.php/account/account', app.connected().firstname, 'index.php/account/logout?_url=' + url));
  } else {
      $('#welcome').html(i18n('text_welcome', 'index.php/account/account?_url=' + url, 'index.php/account/register?_url=' + url));
  }
}); 
```

其中 app.connected 是会话检查。并且 '#welcome' 在 sammy 的 $element 之外，应该存在。

您可以使用 context.load 作为模板。

# javascript - 登录按钮在 IE7、8、9 上不起作用

> ID：10559802
> 
> 赞同：2
> 
> 时间：2012-05-11T23:34:19.657
> 
> 标签：javascript, facebook, internet-explorer, login

这是我的第一个应用程序。登录按钮在我的应用程序上不起作用。它显示了，但是当我单击它时，什么也没有发生。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
  <html xmlns:fb="http://www.facebook.com/2008/fbml" xmlns:og="http://opengraphprotocol.org/schema/">
  ....
  <body>
  <div id="fb-root"></div>
  <script>
        window.fbAsyncInit = function() {
              FB.init({
              appId      : '306025322809511',
              channel    : 'http://koreplayer.fb.levelkro.com/channel.php',
              status     : true, 
              cookie     : true,
              xfbml      : true,
              oauth      : true,
              });
              FB.Event.subscribe('auth.login', function () {
                    if (response.authResponse) {
                          window.location = "/manage.php";
                    }
              });
        };
        (function(d){
        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/fr_FR/all.js";
        d.getElementsByTagName('head')[0].appendChild(js);
        }(document));
  </script>
  ....
  <div class="fb-login-button">Se connecter en utilisant Facebook</div> 
```

我尝试过使用通道参数，但是没有通道就无法显示样式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T11:05:39.890

您需要在“fb-login-button”上触发操作来调用 FB.login()。您可以使用 onclick() 或使用 jQuery $('.fb-login-button').click( function() { FB.login(); });

另外，下面的问题不会因为弹出登录而出现，但它会在登录后停止刷新。所以，如果你已经登录，它会看起来像什么都没有发生，因为登录框只会打开然后关闭，因为它无关紧要。

```
 FB.Event.subscribe('auth.login', function () { 
                if (response.authResponse) { 
                      window.location = "/manage.php"; 
                } 
          }); 
```

需要更改为

```
 FB.Event.subscribe('auth.login', function (response) { 
                if (response.authResponse) { 
                      window.location = "/manage.php"; 
                } 
          }); 
```

最后，windows.location 最好有一个完整的 URL（以 http:// 或 https:// 开头）。没必要，但应该让它更好地工作。

* * *

在以下评论后编辑：

```
 window.fbAsyncInit = function() {
      FB.init({
        appId      : '306025322809511',
        channel    : 'http://koreplayer.fb.levelkro.com/channel.php',
        status     : true, 
        cookie     : true,
        xfbml      : true,
        oauth      : true,
      });
    };
    FB.Event.subscribe('auth.login', function (response) {
    if (response.authResponse) {
      window.location = "http://koreplayer.fb.levelkro.com/manage.php";
      }
    }); 
```

您需要在 fbAsyncInit 函数中订阅 FB.Event：

```
window.fbAsyncInit = function() {
      FB.init({
        appId      : '306025322809511',
        channel    : 'http://koreplayer.fb.levelkro.com/channel.php',
        status     : true, 
        cookie     : true,
        xfbml      : true,
        oauth      : true,
      });
      FB.Event.subscribe('auth.login', function (response) {
        if (response.authResponse) {
          window.location = "http://koreplayer.fb.levelkro.com/manage.php";
         }
      });
    }; 
```

* * *

后期编辑：我已在帖子的第二部分中将“响应”添加到 auth-subscribe 的参数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T18:35:32.750

在我知道 js sdk 已加载后，我使用 xfbml 解析来呈现我的按钮，请在下面使用。

* * *

```
<div id="login_button"><div>
<div id="fb-root"></div>
<script>
      window.fbAsyncInit = function() {
        FB.init({
    appId  : '135669679827333',
    status : true, // check login status
    cookie : true, // enable cookies to allow the server to access the session
    xfbml  : true, // parse XFBML
    channelUrl : 'https://anotherfeed.com/emo/channel.html', // channel.html file
    oauth  : true // enable OAuth 2.0
        });  
function loginbutton(){
var loginb=document.getElementById('login_button');
login.innerHTML+='<div class="fb-login-button">Se connecter en utilisant Facebook</div>';
FB.XFBML.parse(loginb);
};
setTimeout("loginbutton();", 2000);
      };
  // Load the SDK Asynchronously
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=135669679827333";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script> 
```

* * *

注意：这将仅呈现登录链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:24:15.617

好的，问题是由apps.facebook.com/koreplayer/的iFrame引起的，IE不保存cookie，因为d在一个框架中。这是 IE 的一项安全功能，可防止欺诈。

# vba - vba - 检查空数组

> ID：10559804
> 
> 赞同：4
> 
> 时间：2012-05-11T23:34:25.687
> 
> 标签：vba

```
Function IsVarArrayEmpty(anArray As Variant)

Dim i As Integer

On Error Resume Next
    i = UBound(anArray, 1)
If Err.Number = 0 Then
    IsVarArrayEmpty = False
Else
    IsVarArrayEmpty = True
End If

End Function 
```

未初始化返回 true，初始化返回 false。我想看看它是否有任何数据/内容。但是，问题是我觉得即使数组中没有数据，上面的代码也会返回 false。我该如何检查？

（我尝试将字符串 s 设置为等于字节数组。那是“”。这意味着数组是空的，对吗？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-12T10:04:47.527

我个人使用这个 - 现在如果你`ReDim`的数组带有`ReDim v (1 To 5) As Variant`,`isArrayEmpty(v)`将返回 false 因为`v`有 5 个项目，尽管它们都未初始化。

```
Public Function isArrayEmpty(parArray As Variant) As Boolean
'Returns true if:
'  - parArray is not an array
'  - parArray is a dynamic array that has not been initialised (ReDim)
'  - parArray is a dynamic array has been erased (Erase)

  If IsArray(parArray) = False Then isArrayEmpty = True

  On Error Resume Next

  If UBound(parArray) < LBound(parArray) Then
      isArrayEmpty = True
      Exit Function
  Else
      isArrayEmpty = False
  End If

End Function 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-09-30T13:56:26.087

我只是将伟大的 Chip Pearson 粘贴在代码下方。
还可以查看他[关于数组函数的页面](http://www.cpearson.com/excel/vbaarrays.htm)。

我希望这有帮助。

```
Public Function IsArrayEmpty(Arr As Variant) As Boolean
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' IsArrayEmpty
' This function tests whether the array is empty (unallocated). Returns TRUE or FALSE.
'
' The VBA IsArray function indicates whether a variable is an array, but it does not
' distinguish between allocated and unallocated arrays. It will return TRUE for both
' allocated and unallocated arrays. This function tests whether the array has actually
' been allocated.
'
' This function is really the reverse of IsArrayAllocated.
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

    Dim LB As Long
    Dim UB As Long

    err.Clear
    On Error Resume Next
    If IsArray(Arr) = False Then
        ' we weren't passed an array, return True
        IsArrayEmpty = True
    End If

    ' Attempt to get the UBound of the array. If the array is
    ' unallocated, an error will occur.
    UB = UBound(Arr, 1)
    If (err.Number <> 0) Then
        IsArrayEmpty = True
    Else
        ''''''''''''''''''''''''''''''''''''''''''
        ' On rare occassion, under circumstances I
        ' cannot reliably replictate, Err.Number
        ' will be 0 for an unallocated, empty array.
        ' On these occassions, LBound is 0 and
        ' UBound is -1.
        ' To accomodate the weird behavior, test to
        ' see if LB > UB. If so, the array is not
        ' allocated.
        ''''''''''''''''''''''''''''''''''''''''''
        err.Clear
        LB = LBound(Arr)
        If LB > UB Then
            IsArrayEmpty = True
        Else
            IsArrayEmpty = False
        End If
    End If

End Function 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-12T00:05:35.010

尝试这个

```
Sub Sample()
    Dim Ar As Variant
    Dim strTest As String

    strg = "Blah"
    Ar = Split(strg, "|")
    Debug.Print "TEST1 : "; IsArrayEmpty(Ar)

    strg = "Blah|Blah"
    Ar = Split(strg, "|")
    Debug.Print "TEST2 : "; IsArrayEmpty(Ar)

End Sub

Function IsArrayEmpty(Ar As Variant) As Boolean
    If InStr(TypeName(Ar), "(") > 0 Then
        If Not IsEmpty(Ar) Then
            If UBound(Ar) > 0 Then
                IsArrayEmpty = False
            Else
                IsArrayEmpty = True
            End If
        End If
    End If
End Function 
```

**快照**

![在此处输入图像描述](../Images/2d4020fc3776cc30a2bc9526b69e409a.png)

**跟进**

> 您的代码是否假定数组仅存储字符串？– TPG 7 分钟前

是的。它做了。如果您想测试所有条件，那么我建议您使用 API。这是一个例子

```
Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" _
(pDst As Any, pSrc As Any, ByVal ByteLen As Long)

Sub Sample()
    Dim Ar() As Long

    Debug.Print ArrayNotEmpty(Ar) '<~~ False

    ReDim Ar(1)

    Debug.Print ArrayNotEmpty(Ar) '<~~ True
End Sub

Public Function ArrayNotEmpty(Ar) As Boolean
    Dim Ret As Long

    CopyMemory Ret, ByVal VarPtr(Ar) + 8, ByVal 4
    CopyMemory Ret, ByVal Ret, ByVal 4
    ArrayNotEmpty = (Ret <> 0)
End Function 
```

# c# - 如何将我的分页功能转换为使用 AJAX Insead？

> ID：10559807
> 
> 赞同：2
> 
> 时间：2012-05-11T23:34:48.033
> 
> 标签：c#, asp.net, asp.net-mvc-3, pagination

我目前使用 PagedList 库（https://github.com/TroyGoode/PagedList）在我的 MVC 3 项目中进行分页。

我想将此代码转换为使用 ajax 使用新结果更新页面，而不是刷新整个页面。我真的不知道该怎么做。我对来自 Webforms 的 MVC 相当陌生。任何帮助将不胜感激！

这是我的代码：

家庭控制器：

```
//#####################################
// ActionResult = Retrieve Comments
//#####################################
[ChildActionOnly]
public ActionResult _Comments(int ProductID, int? Page)
{
    //Perform the Database Query.
    try
    {
        //SQL Query - Get * records
        var Model = from r in DB.Comments where r.ProductID == ProductID select r;

        //Page number passed in via url. Default to 1 if not specified.
        var PageNumber = Page ?? 1;

        //Grab 6 results from the result set.
        var Results = Model.ToPagedList(PageNumber, 6);

        //Store Paged Result set in ViewBag for Paging.
        ViewBag.Results = Results;

        //Store in ViewBag for display (Page 1 of 43)
        ViewBag.PageNumber = PageNumber;

        //Get Total Pages: Divide Total Records by 6 Records per page.
        ViewBag.PageCount = Model.Count() / 6 + 1; 

        //Return Records to my view.
        return PartialView(Results);
    }
    //There was an error.
    catch
    {
        //ViewBag.ErrorMessage = ex;
        return PartialView("Error");
    }
} 
```

部分视图：_评论

```
@model IEnumerable<DH.Models.Comment>

@using PagedList.Mvc;
@using PagedList;

@{  
    //No Comments Yet
    if (@Model.Count() == 0)
    {
        <div id="CommentStatus">Be the first to comment on this product!</div>
    }
    //There are comments!
    else
    {
        foreach (var item in Model)
        {   
             //html for writing out the comments...
        }
    }
}

<div>Page @ViewBag.PageNumber of @ViewBag.PageCount</div>

@Html.PagedListPager((IPagedList)ViewBag.Results, Page => Url.Action("Index", new { Page = Page }), new PagedListRenderOptions { LinkToPreviousPageFormat = "< Prev", LinkToNextPageFormat = "Next >", LinkToLastPageFormat = "&Uacute;ltima >>" }) 
```

模型

```
namespace DH.Models
{
    public class Comment
    {  
        public int CommentID { get; set; }

        public int ProductID { get; set; }

        public string Author { get; set; }

        public string Message { get; set; }

        public DateTime MessageDate { get; set; }

        public int ThumbsUp { get; set; }

        public int ThumbsDown { get; set; }

        public string IP { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T13:44:08.550

我是 PagedList nuget 包的创建者。

在项目的 git repo 中有一个做 Ajax 分页（以及无限滚动）的例子：

[https://github.com/TroyGoode/PagedList/tree/master/src/PagedList.Mvc4.Example](https://github.com/TroyGoode/PagedList/tree/master/src/PagedList.Mvc4.Example)

**控制器：** [https ://github.com/TroyGoode/PagedList/blob/master/src/PagedList.Mvc4.Example/Controllers/AjaxController.cs](https://github.com/TroyGoode/PagedList/blob/master/src/PagedList.Mvc4.Example/Controllers/AjaxController.cs)

**查看：** [https ://github.com/TroyGoode/PagedList/blob/master/src/PagedList.Mvc4.Example/Views/Ajax/Index.cshtml](https://github.com/TroyGoode/PagedList/blob/master/src/PagedList.Mvc4.Example/Views/Ajax/Index.cshtml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-12T13:00:54.623

您可以使用敲除和分页列表包轻松完成

```
 <script type="text/javascript">
$(function() {
    $('#users').pagify({
        dataUrl: '/User/UserLisr',
        callBack: function(){
           // Ajax remove preloader and some other callbacks  
        },
        beforeSend: function(){
           // Ajax show preloader and some other function before start
        }
    });
}
</script> 
```

[pagify.mvc 包](https://github.com/turhancoskun/pagify.mvc)

# asp.net-mvc-3 - 执行命令定义时发生错误。有关详细信息，请参阅内部异常。MVC3

> ID：10559809
> 
> 赞同：0
> 
> 时间：2012-05-11T23:35:12.893
> 
> 标签：asp.net-mvc-3, linq, exception, command, definition

我收到这个错误

![在此处输入图像描述](../Images/20481da4f202f23fce379cd80902e101.png)

但我不知道为什么会这样。当我重新启动 Visual Studio 时它停止发生，但过了一段时间，它又发生了。这很奇怪，因为它发生在登录后不久。这让我觉得我打开了一个连接或者还有其他事情发生。你们知道会是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T14:26:31.480

不知道你的项目很难说。但它可能与在 setter 中执行代码有关，这通常被视为一种反模式。（顺便说一句：这样做的原因是 setter 建议您只更改对象状态的那一小部分，而没有副作用）。`ProjectList`一个改进是在解决问题之前循环通过`ProjectExtensionList`。

如果设置值 for`ProjectList`是其包含对象 ( `DashboardModel`) 实现的一部分，则循环可能会导致数据库读取必须等待与读取 s 值有关的连接`DashboardModel`。如果您将循环推迟到真正需要的时候，那么在那个时间点，`DashboardModel`对象处于其最终状态并且连接应该可用。

# ruby-on-rails - 在 Rails 中观察 RESTful 路由并耦合资源模型和控制器的最佳实践？

> ID：10559813
> 
> 赞同：0
> 
> 时间：2012-05-11T23:36:15.453
> 
> 标签：ruby-on-rails, model-view-controller, rest, controller

严格的 REST 支持者可能会说，如果您发现自己在不是 CRUD 的控制器上定义了一个操作，那么您应该强烈考虑创建一个新资源并将您的操作定义为对新资源的 CRUD 操作。

一个例子可能是改变模型状态的操作——比如购买。在此示例中，您可以创建 CompletePurchasesController 并使用 create 操作将购买状态更新为已完成，而不是在 PurchaseController 上定义“完成”操作。

假设上述情况，您显然不会将 PurchaseState 直接保存到数据库中。

我的问题是你什么时候将控制器耦合到模型？何时定义 PurchaseState 模型（未持久化）以及何时直接使用 Purchase。

这是一个复杂性和您在控制器操作中与之交互的松散关联模型的数量的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T02:35:27.523

“完成”是（现有）购买的状态转换事件。我发现将此操作概念化为对虚拟资源的创建而不是对耦合到购买模型的控制器（实际上是购买控制器本身）上的更新操作是违反直觉的。

我会为这种状态转换定义单独的类似更新的操作。我认为通过这种方式，您可以以最经济的方式利用 rails 结构，包括模型初始化、视图调度、路由、访问控制。假设您使用了inherited_resources，cancan只需添加

```
# routes.rb
resource :purchase do 
  put :complete, :on => :member
end

# purchase_controller.rb
def complete
  @purchase.complete!
end

# cancan ability (entry already there for basic crud)
can :manage, Purchase, :user_id => user.id 
```

您已经完成了整个 UI 的实现（视图/模型逻辑除外）。在rails中是多么酷啊。

如果您的典型用例是购买仅由状态转换更新，尤其是所有具有相同访问权限和重定向视图的，那么我什至会使用带有 state_event 属性的 PurchaseController 的更新操作。看

[有人可以为 pluginaweek - statemachine 提供一个活动记录示例吗？](https://stackoverflow.com/questions/9559702/can-somebody-give-an-active-record-example-for-pluginaweek-statemachine)

严格的 REST 主义者，咬我！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-24T21:13:22.217

要更新购买状态，您可能只需要一个 PurchasesController 更新操作，您可以在路由文件中将其定义为“put”或“patch”方法。

如果更新时发生的所有事情都是更改购买对象上的状态字段，那么您可能只需在更新操作中执行此操作即可。

如果围绕某些状态转换存在一些业务逻辑，但最终您只是更改了该购买对象，那么您可能希望将其放入您的购买模型中。

如果其他表也更新了，或者你也在做一些事情，比如排队给你的用户发送一封电子邮件，祝贺他们新购买，我认为你可以添加一个单独的 PurchaseComplete 或 PurchaseAbort 模型/服务对象。当动作的逻辑更复杂时，这些似乎最自然地发挥作用，和/或您对多个模型进行了更改，或者正在做其他事情。

# jquery - 具有相同类名的 div 只有一个 jQuery 点击事件

> ID：10559814
> 
> 赞同：1
> 
> 时间：2012-05-11T23:36:17.953
> 
> 标签：jquery

有两个`div`部分具有相同的类，并且具有相同的`ul`and`li`和`a`。

我的代码中有两个 jQuery 点击事件。当我点击 Google 时，两个 jQuery 点击事件都会触发。但我不想两者都这样做，只有一个。我如何实现这一目标？

例如，如果 Google 被点击，我只希望那个 jQuery 点击事件来做某事，而不是另一个。这些是我正在使用的 DOM 元素：

```
<div class = "abc">
 <ul>  
  <li class="year_"><a href="www.google.com">google</a></li>
 </ul>
</div>
<div class ="abc">
 <ul>
  <li><a href="www.yahoo.com>yahoo</a></li>
 </ul>
</div> 
```

可能会改变，`href`所以我不能以此为基础选择我的选择器。我的代码如下。

```
$( 'div.abc ul li[class^="year_"]  a' ).click( function(){
    //do something
});

$( 'div.abc ul li a' ).click( function(){
    //do something
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T23:43:13.177

你可以做一个条件语句，找到带有“year_”类的 li：

```
$( 'div.abc ul li a' ).click( function(){
    if ($(this).parents('li').is('[class^="year_"]')){
        //do something
    } else {
        //do something else
    }
}); 
```

见[jsfiddle](http://jsfiddle.net/bozdoz/cV3Fz/)。

# drupal - Drupal 6：复选框表未正确呈现

> ID：10559815
> 
> 赞同：1
> 
> 时间：2012-05-11T23:36:29.760
> 
> 标签：drupal, drupal-6, drupal-theming

我正在研究一个 Drupal 6 模块，我想从我保存在数据库中的数据中生成一个表，每行中都有复选框。表格生成良好，但复选框未在表格中呈现，而是将其节点 ID 放在表格下方。请看下面的截图：

![drupal 复选框](../Images/d241243784f08f2fe75867b8a7691b8e.png)

“21”是“Test Question 01”的节点id，“19”是“Test Question 02”的节点id。

我正在使用的代码（是的，它都在一个不理想的主题函数中。我计划在解决复选框问题后移动东西）：

```
function theme_qt_assignment_questions_table($form) {
   // Get the questions from the database
   $db_results = db_query('SELECT {qt_questions}.nid, title, lesson, unit FROM node INNER JOIN {qt_questions} on {node}.nid = {qt_questions}.nid WHERE lesson = %d AND unit = %d', 
                     $form['#lesson'], $form['#unit']);

  // Define the headers for the table
  $headers = array(
    theme('table_select_header_cell'),
    array('data' => t('Title'), 'field' => 'title'/*, 'sort' => 'asc'*/),
    array('data' => t('Lesson'), 'field' => 'lesson'),
    array('data' => t('Unit'), 'field' => 'unit'),
  );

  while($row = db_fetch_object($db_results)) {
    $checkboxes[$row->nid] = '';

    $form['nid'][$row->nid] = array(
      '#value' => $row->nid
    );
    $form['title'][$row->nid] = array(
      '#value' => $row->title
    );
    $form['lesson'][$row->nid] = array(
      '#value' => $row->lesson
    );
    $form['unit'][$row->nid] = array(
      '#value' => $row->unit
    );
  }

  $form['checkboxes'] = array(
    '#type' => 'checkboxes',
    '#options' => $checkboxes,
  );

  // Add the questions to the table
  if(!empty($form['checkboxes']['#options'])) {
    foreach(element_children($form['nid']) as $nid) {
      $questions[] = array(
        drupal_render($form['checkboxes'][$nid]),
        drupal_render($form['title'][$nid]),
        drupal_render($form['lesson'][$nid]),
        drupal_render($form['unit'][$nid]),
     );
    }
  } else {
    // If no query results, show as such in the table
    $questions[] = array(array('data' => '<div class="error">No questions available for selected lesson and unit.</div>', 'colspan' => 4));
  }

  // Render the table and return the result
  $output = theme('table', $headers, $questions);

  $output .= drupal_render($form);
  return $output;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T03:04:12.557

事实证明，我试图简化问题实际上是问题所在。也就是说，在 hook_theme 中做所有事情都是不正确的。相反，我定义了一个从数据库中提取信息并创建复选框数组并在 hook_form 中调用它的函数：

```
$form['questions_wrapper']['questions'] = _qt_get_questions_table($node->lesson, $node->unit); 
```

在这个函数（_qt_get_questions_table()）的末尾，我指定了将所有内容都放入表中的主题函数：

```
 $form['#theme'] = 'qt_assignment_questions_table'; 
```

我对 Drupal 还是很陌生，所以这个解释对于有同样问题的人来说可能不是最好的，但希望它会有所帮助。

# asp.net-mvc - DotNetOpenAuth 还是 DotNetOpenId？

> ID：10559818
> 
> 赞同：1
> 
> 时间：2012-05-11T23:37:44.090
> 
> 标签：asp.net-mvc, openid, dotnetopenauth

我正在尝试让用户使用他们的 Google、Facebook、Live 帐户登录。非常困惑选择哪一个 - DotNetOpenAuth 或 DotNetOpenId？

我用过 DotNetOpenId，但似乎 DotNetOpenAuth 有点像有更多的功能？而且我不是特别喜欢 Janrain，因为它没有退出选项，反正也不是免费版本。

我也没有在 stackoverflow 上找到任何特别有用的文章。

如果这里有这两种经验的人可以对此有所了解，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T19:41:22.717

实际上，它们是同一个库。当 DotNetOpenId 有一个从 v2 到 v3 的主要版本时，它也被重命名。因此，对于最新版本，请从[http://www.dotnetopenauth.net获取](http://www.dotnetopenauth.net)

# ios - 文档协作

> ID：10559819
> 
> 赞同：2
> 
> 时间：2012-05-11T23:37:58.687
> 
> 标签：ios, real-time, collaboration

我正在尝试制作一个 iOS 应用程序，该应用程序将涉及 5 个左右的用户连接到一个 Web 文档，其中一个人编辑它，而其他人则实时接收更新。

如何制作应用程序以便它可以实时更新其文档（无需用户单击“同步”按钮）？它应该类似于共享的谷歌文档，当一个用户进行更改时，它会立即反映在所有用户的副本中，但它应该在 iOS 上本地运行，而不是通过网络浏览器。

我不是要完整的应用程序原理图或任何代码，我只需要朝着正确的方向轻推。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T02:29:03.633

我建议您在服务器上保留文档的主副本（顺便说一下，您需要一台服务器才能有效地进行这项工作），而用户编辑存储在本地的文档的临时版本在他们的 iPhone 上，服务器会不断收到更改通知，当服务器上的版本发生更改时（如果服务器上的版本与设备上的版本不同），服务器会发送一条消息使用您将指定的特殊协议

1.  将内容（文本、图像或其他内容）添加到文档中
2.  内容已从文档中删除
3.  文档中的内容已编辑
4.  ...你明白了

您只需要不同的方式来通知设备对服务器文档所做的不同类型的更改。从这些通知中，用户的临时文档可以根据对服务器版本所做的更改进行更改，而无需一遍又一遍地不断下载完整文档。每隔一段时间（或通过手动用户输入），您可以让 iPhone 应用程序请求完整的服务器文档，以确保在 iPhone 上所做的所有更改都是正确的。

使用`NSInputStream`s 和`NSOutputStream`s 接收和发送消息到您的服务器。使用 an`NSStreamDelegate`来处理服务器事件（它唯一的实例方法是事件处理方法）。如果您真的对发送消息一无所知，[本指南是一个很好的开始。](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Streams/Streams.html#//apple_ref/doc/uid/10000188i)你可以发送和接收`NSData`你`NSString`的协议，你可以在其中存储你的协议。

作为协议的一个示例，我创建的一个应用程序可以接收和发送来自 Windows 服务器的消息，它执行以下操作：

1.  在准备要在 iOS 应用程序上发送的数据时，我首先将 4 个字节的数据写入一个`NSData`包含处理数据长度的对象，以便服务器确切地知道要从流中读取多少字节。我选择了 4 个字节，因为这是一个`unsigned int`类型的大小，它可以表示非常大的数字（因此非常大的数据大小）。
2.  我将数据添加到`NSData`对象。`struct`在我的情况下，数据是 a 的形式。实际上，只要您知道如何在另一端解析它，您就可以发送任何类型的数据。
3.  我发送`NSData`对象。

确实，发送、接收和解析`NSStream`消息非常简单，但是如果您是第一次为 iOS 应用程序编写服务器-客户端代码，这个过程可能会让人望而生畏。我确实将过程简化了很多，因为您还必须考虑服务器是否准备好接收消息，是否有空间可用于写入消息等等，但是我之前链接到的指南也是正确的[在这里](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Streams/Streams.html#//apple_ref/doc/uid/10000188i)，在我编写客户端-服务器应用程序时非常有帮助。

希望这些指南足够通用（并且针对正确的主题），以满足您的喜好。

# bash - 如何删除以反斜杠开头的任何字符串？

> ID：10559821
> 
> 赞同：2
> 
> 时间：2012-05-11T23:38:02.017
> 
> 标签：bash, sed

我有一个包含很多 TeX 标记的文件，如下所示：

```
The fish ate 20\percent more food than the bear.
The fish ate \the\number\percent more food than the bear. 
```

我想删除作为 TeX 代码的文本，例如`\percent`并用空格替换它。

*   标记总是以`\`.
*   标记后始终跟一个空格`{`、 或另一个`\`。
*   文件中的`\`其他情况从不使用。

如何删除这些项目的外观，这些项目以空格、 或其他开头`\`和之后？`{``\`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T23:49:57.370

你可以使用这个 perl 命令：

```
perl -pe 's#\\[^ \\{]+# #g' file.txt 
```

或使用 sed：

```
sed -E 's#\\[^ \\{]+# #g' file.txt 
```

或者如果不支持 -E 则：

```
sed -r 's#\\[^ \\{]+# #g' file.txt 
```

### 输出

```
The fish ate 20  more food than the bear.
The fish ate     more food than the bear. 
```

# java - 为套接字服务器实现我自己的 java.nio

> ID：10559822
> 
> 赞同：0
> 
> 时间：2012-05-11T23:38:19.377
> 
> 标签：java, multithreading, sockets, nio

过去几天我一直在阅读构建 java 套接字服务器时 io 和 nio 之间的区别。对于我的使用，我需要一个可以运行大量连接的服务器，并且 ion 应该可以解决问题。我唯一担心的是，它比为每个连接运行一个线程更慢且更难实现。所以我想为什么我不使用相同的线程易用性和 java.nio 的逻辑并构建一个服务器有一个线程来检查所有打开的连接，当有新事件时，它会打开一个新线程来处理它. 我认为这样我就可以享受这两个世界了……你有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T00:36:16.340

NIO almost entirely relies on JNI, so if you want to implement it again, you'll actually have to write loads of C/++ and OS API interface code.

I think the existing Java implementations are already quite good. For example, the Selector class wraps the system call for waiting on multiple file descriptors. There's hardly anything you can do to improve the efficiency of that.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:44:40.913

我建议你不要理解 NIO 的意思，就是只使用一个线程。这当然很复杂，并且在 1000 个以下的客户（可能是 10,000 个，甚至可能是 100,000 个）以下，您是否需要它是有争议的。如果您到达那里并向自己证明您确实需要它，我将使用 java.net 实现您的服务器以使其运行并为第 2 阶段保存 java.nio。

**编辑：**我当然会忘记滚动自己的概念。您大大低估了这项任务（它需要 Sun 1.4.0、1.4.1、1.4.2 才能真正正常工作），并且您的目标似乎是两全其美。与 Sun 对 java.nio 所做的相比，您将无法从中得到更多，因为没有更多了。可以说少了一点;-)

# java - 如何将此代码从小程序更改为独立应用程序

> ID：10559823
> 
> 赞同：0
> 
> 时间：2012-05-11T23:38:24.670
> 
> 标签：java, applet

有谁知道如何把这个小程序变成一个应用程序？删除“扩展小程序”后，它不起作用。我不确定如何将其更改为应用程序以及“扩展”后要写什么。

```
 import java.awt.*;
    import java.awt.event.*;
    import javax.swing.*;

    public class BlackjackGUI extends JApplet {

       public void init() { 
```

init() 方法创建组件并布置小程序。BlackjackCanvas 占据布局的 CENTER 位置。底部是一个包含三个按钮的面板。BlackjackCanvas 对象侦听来自按钮的事件并执行程序的所有实际工作。

```
 setBackground( new Color(130,50,40) );

          BlackjackCanvas board = new BlackjackCanvas();
          getContentPane().add(board, BorderLayout.CENTER);

          JPanel buttonPanel = new JPanel();
          buttonPanel.setBackground( new Color(220,200,180) );
          getContentPane().add(buttonPanel, BorderLayout.SOUTH);

          JButton hit = new JButton( "Hit!" );
          hit.addActionListener(board);
          buttonPanel.add(hit);

          JButton stand = new JButton( "Stand!" );
          stand.addActionListener(board);
          buttonPanel.add(stand);

          JButton newGame = new JButton( "New Game" );
          newGame.addActionListener(board);
          buttonPanel.add(newGame);

       }  // end init()

       public Insets getInsets() {
             // Specify how much space to leave between the edges of
             // the applet and the components it contains.  The background
             // color shows through in this border.
          return new Insets(3,3,3,3);
       }

       // --- The remainder of this class consists of a nested class ---

       class BlackjackCanvas extends JPanel implements ActionListener {

             // A nested class that displays the card game and does all the work
             // of keeping track of the state and responding to user events.

          Deck deck;         // A deck of cards to be used in the game.

          BlackjackHand dealerHand;   // Hand containing the dealer's cards.
          BlackjackHand playerHand;   // Hand containing the user's cards.

          String message;  // A message drawn on the canvas, which changes
                           //    to reflect the state of the game.

          boolean gameInProgress;  // Set to true when a game begins and to false
                                   //   when the game ends.

          Font bigFont;      // Font that will be used to display the message.
          Font smallFont;    // Font that will be used to draw the cards.

          BlackjackCanvas() {
                // Constructor.  Creates fonts and starts the first game.
             setBackground( new Color(0,120,0) );
             smallFont = new Font("SansSerif", Font.PLAIN, 12);
             bigFont = new Font("Serif", Font.BOLD, 14);
             doNewGame();
          }

          public void actionPerformed(ActionEvent evt) {
                 // Respond when the user clicks on a button by calling
                 // the appropriate procedure.  Note that the canvas is
                 // registered as a listener in the BlackjackGUI class.
             String command = evt.getActionCommand();
             if (command.equals("Hit!"))
                doHit();
             else if (command.equals("Stand!"))
                doStand();
             else if (command.equals("New Game"))
                doNewGame();
          }

          void doHit() {
                 // This method is called when the user clicks the "Hit!" button.
                 // First check that a game is actually in progress.  If not, give
                 // an error message and exit.  Otherwise, give the user a card.
                 // The game can end at this point if the user goes over 21 or
                 // if the user has taken 5 cards without going over 21.
             if (gameInProgress == false) {
                message = "Click \"New Game\" to start a new game.";
                repaint();
                return;
             }
             playerHand.addCard( deck.dealCard() );
             if ( playerHand.getBlackjackValue() > 21 ) {
                message = "You've busted!  Sorry, you lose.";
                gameInProgress = false;
             }
             else if (playerHand.getCardCount() == 5) {
                message = "You win by taking 5 cards without going over 21.";
                gameInProgress = false;
             }
             else {
                message = "You have " + playerHand.getBlackjackValue() + ".  Hit or Stand?";
             }
             repaint();
          }

          void doStand() {
                  // This method is called when the user clicks the "Stand!" button.
                  // Check whether a game is actually in progress.  If it is,
                  // the game ends.  The dealer takes cards until either the
                  // dealer has 5 cards or more than 16 points.  Then the 
                  // winner of the game is determined.
             if (gameInProgress == false) {
                message = "Click \"New Game\" to start a new game.";
                repaint();
                return;
             }
             gameInProgress = false;
             while (dealerHand.getBlackjackValue() <= 16 && dealerHand.getCardCount() < 5)
                dealerHand.addCard( deck.dealCard() );
             if (dealerHand.getBlackjackValue() > 21)
                 message = "You win!  Dealer has busted with " + dealerHand.getBlackjackValue() + ".";
             else if (dealerHand.getCardCount() == 5)
                 message = "Sorry, you lose.  Dealer took 5 cards without going over 21.";
             else if (dealerHand.getBlackjackValue() > playerHand.getBlackjackValue())
                 message = "Sorry, you lose, " + dealerHand.getBlackjackValue()
                                                   + " to " + playerHand.getBlackjackValue() + ".";
             else if (dealerHand.getBlackjackValue() == playerHand.getBlackjackValue())
                 message = "Sorry, you lose.  Dealer wins on a tie.";
             else
                 message = "You win, " + playerHand.getBlackjackValue()
                                                   + " to " + dealerHand.getBlackjackValue() + "!";
             repaint();
          }

          void doNewGame() {
                 // Called by the constructor, and called by actionPerformed() if
                 // the use clicks the "New Game" button.  Start a new game.
                 // Deal two cards to each player.  The game might end right then
                 // if one of the players had blackjack.  Otherwise, gameInProgress
                 // is set to true and the game begins.
             if (gameInProgress) {
                     // If the current game is not over, it is an error to try
                     // to start a new game.
                message = "You still have to finish this game!";
                repaint();
                return;
             }
             deck = new Deck();   // Create the deck and hands to use for this game.
             dealerHand = new BlackjackHand();
             playerHand = new BlackjackHand();
             deck.shuffle();
             dealerHand.addCard( deck.dealCard() );  // Deal two cards to each player.
             dealerHand.addCard( deck.dealCard() );
             playerHand.addCard( deck.dealCard() );
             playerHand.addCard( deck.dealCard() );
             if (dealerHand.getBlackjackValue() == 21) {
                 message = "Sorry, you lose.  Dealer has Blackjack.";
                 gameInProgress = false;
             }
             else if (playerHand.getBlackjackValue() == 21) {
                 message = "You win!  You have Blackjack.";
                 gameInProgress = false;
             }
             else {
                 message = "You have " + playerHand.getBlackjackValue() + ".  Hit or stand?";
                 gameInProgress = true;
             }
             repaint();
          }  // end newGame();

          public void paintComponent(Graphics g) {
                // The paint method shows the message at the bottom of the
                // canvas, and it draws all of the dealt cards spread out
                // across the canvas.

             super.paintComponent(g); // fill with background color.

             g.setFont(bigFont);
             g.setColor(Color.green);
             g.drawString(message, 10, getSize().height - 10);

             // Draw labels for the two sets of cards.

             g.drawString("Dealer's Cards:", 10, 23);
             g.drawString("Your Cards:", 10, 153);

             // Draw dealer's cards.  Draw first card face down if
             // the game is still in progress,  It will be revealed
             // when the game ends.

             g.setFont(smallFont);
             if (gameInProgress)
                drawCard(g, null, 10, 30);
             else
                drawCard(g, dealerHand.getCard(0), 10, 30);
             for (int i = 1; i < dealerHand.getCardCount(); i++)
                drawCard(g, dealerHand.getCard(i), 10 + i * 90, 30);

             // Draw the user's cards.

             for (int i = 0; i < playerHand.getCardCount(); i++)
                drawCard(g, playerHand.getCard(i), 10 + i * 90, 160);

          }  // end paint();

          void drawCard(Graphics g, Card card, int x, int y) {
                  // Draws a card as a 80 by 100 rectangle with
                  // upper left corner at (x,y).  The card is drawn
                  // in the graphics context g.  If card is null, then
                  // a face-down card is drawn.  (The cards are 
                  // rather primitive.)
             if (card == null) {  
                    // Draw a face-down card
                g.setColor(Color.blue);
                g.fillRect(x,y,80,100);
                g.setColor(Color.white);
                g.drawRect(x+3,y+3,73,93);
                g.drawRect(x+4,y+4,71,91);
             }
             else {
                g.setColor(Color.white);
                g.fillRect(x,y,80,100);
                g.setColor(Color.gray);
                g.drawRect(x,y,79,99);
                g.drawRect(x+1,y+1,77,97);
                if (card.getSuit() == Card.DIAMONDS || card.getSuit() == Card.HEARTS)
                   g.setColor(Color.red);
                else
                   g.setColor(Color.black);
                g.drawString(card.getValueAsString(), x + 10, y + 30);
                g.drawString("of", x+ 10, y + 50);
                g.drawString(card.getSuitAsString(), x + 10, y + 70);
             }
          }  // end drawCard()

       } // end nested class BlackjackCanvas

    } // end class BlackjackGUI 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T00:38:24.050

If you're using an Applet-based approach for your game, you may just want to keep it that way. You can create a wrapper window which will hold your applet, which can then operate as normal. All you'll need to do is add a main method to your applet class, like so:

```
public static void main(String[] args) {
    JFrame mainWindow = new JFrame("Blackjack"); // You can change "Blackjack" to anything, it will display that as the window title
    mainWindow.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    mainWindow.setResizeable(false); // If your applet can handle resizing, you can remove this line
    BackjackGUI applet = new BlackjackGUI();
    applet.init();
    mainWindow.add(applet);
    mainWindow.setSize(applet.getSize());
    mainWindow.setVisible(true);
} 
```

This will allow your app to run as both an applet and a stand-alone application.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T03:19:20.717

类似于 Jake Kings 的方法：

将不纯粹与小程序相关的所有内容从 init-method 移至生成主面板的方法。大多数情况下，您都有这样的主面板。否则你可以定义一个。

在applet 的init-method 中，调用这个新的makeMainPanel()。

同时，创建一个 main 方法，将应用程序作为 Swing JFrame 启动。创建一个大型机，并将具有该方法的相同面板添加到您的大型机，并在 main.js 中执行纯粹的应用程序典型工作。

现在你可以用任何一种方式调用它。

# javascript - 如何使导航按钮动画到内部页面上的某些位置

> ID：10559824
> 
> 赞同：0
> 
> 时间：2012-05-11T23:38:29.613
> 
> 标签：javascript, jquery, css, animation, nav

所以我的一个客户问，如果没有 Flash，我是否可以建立一个在某个位置具有导航负载的主页，但是如果我单击其中一个导航按钮，整个导航会在内部页面上的不同位置进行动画处理，这可能没有闪光灯？用**jQuery**吗？和**css3**？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:41:09.680

jQuery 有一个`animate()`你可能会感兴趣的函数。

看看这里的例子：http: [//api.jquery.com/animate/](http://api.jquery.com/animate/)

CSS3 也有一些动画功能[http://www.w3schools.com/css3/css3_animations.asp](http://www.w3schools.com/css3/css3_animations.asp)，但在 IE 或 Opera 中不支持兼容，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:46:07.130

您还可以查看 jQuery [scrollTo](http://demos.flesler.com/jquery/scrollTo/)插件。

# php - PHP SQL注入预防技术

> ID：10559826
> 
> 赞同：0
> 
> 时间：2012-05-11T23:38:32.330
> 
> 标签：php, sql-injection

我开始考虑保护我的输入免受 SQL 注入。我已经阅读了 PDO 和 mysqli 并将使用这些技术。当我在研究针对 SQL 注入的保护时，我想到了一种技术。每当我有来自用户的输入时，我都可以扫描输入字符串并搜索出现的“'”或“DROP”，如果字符串包含这些字符，那么我就无法继续。这种技术会阻止大量的 SQL 注入吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T23:41:03.657

最好使用事先经过严格测试的方法，不要尝试自己实现。

您想要的解决方案的一个问题是，当 SQL 添加一个用于删除表的新符号时会发生什么？或者如果他们改用“截断”怎么办？这不是万无一失的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T23:40:50.317

只需使用 PDO 或 SQLi。

如果正确使用并按预期使用，两者都会阻止它；使用停止单词 DROP 之类的措施会很愚蠢——想象一下，例如，如果有人键入“dropbox”？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T23:41:11.830

您应该转义您的输入，并考虑使用准备好的语句。这将消除几乎所有的 SQL 注入弱点。扫描特定单词是一种糟糕的做法，因为它通常会惹恼合法用户，并且不会阻止坚定的黑客。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T23:45:07.130

尝试仅使用准备好的语句。这是有史以来最好的技术之一。

[http://php.net/manual/pt_BR/pdo.prepared-statements.php](http://php.net/manual/pt_BR/pdo.prepared-statements.php)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-05-08T23:11:11.730

最好的方法是根据严格的模式验证所有用户输入，以确保没有用户数据异常，以及 PDO 准备好的语句 - 这样您也可以防止 XSS，但通常也有利于清理所有用户生成的输出，以防万一您没有正确验证某些内容，并且用户能够执行恶意代码。

# c - TCP套接字编程错误

> ID：10559831
> 
> 赞同：2
> 
> 时间：2012-05-11T23:39:00.353
> 
> 标签：c, sockets

学习socket编程，以下是错误部分的剪切/粘贴。

仅供参考，我正在关注[本教程](http://www.tutorialspoint.com/cgi-bin/printversion.cgi?tutorial=unix_sockets&file=socket_client_example.htm)。

无法偿还的`gethostbyname()`回报`struct hostent`

```
struct hostent *gethostbyname(const char *name); 
```

使用以下代码。

```
 1 #include <stdio.h>
  2 #include <sys/types.h>
  3 #include <sys/socket.h>
  4 #include <netinet/in.h>
  5 #include <stdlib.h>
  6 #include <strings.h>
  7 
  8 int main(int argc, char *argv[])
  9 {
 10     int sockfd, portno, n;
 11     struct sockaddr_in serv_addr;
 12     struct hostent *server;
 13 
 14     server = gethostbyname(argv[1]);
 15 
 16     /* compose serv_addr */
 17     bzero( (char *)&serv_addr, sizeof(serv_addr) );
 18     serv_addr.sin_family = AF_INET;
 19     bcopy( (char *)server->h_addr, (char *)&serv_addr.sin_addr.s_addr, server->h_length);
 20     serv_addr.sin_port = htons(portno);
 21 
 22     return 0;
 23 } 
```

我有以下 gcc 错误/警告

```
$gcc client2.c
client2.c: In function ‘main’:
client2.c:14: warning: assignment makes pointer from integer without a cast
client2.c:19: error: dereferencing pointer to incomplete type
client2.c:19: error: dereferencing pointer to incomplete type 
```

请指出我做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T23:43:45.600

尝试将其添加到顶部：

```
#include <netdb.h> 
```

这是`gethostbyname`. 如果你`man gethostbyname`在命令行输入，你会得到手册页，打开：

![屏幕截图](../Images/404d730b3c495517099e32cb58db8916.png)

手册页详细说明了您需要包含哪些标题（在**SYNOPSIS**下）。

（点击`q`退出`man`。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T23:50:38.867

手册页中的注意事项`bzero(3)`：

```
 4.3BSD.  This function is deprecated (marked as LEGACY in
   POSIX.1-2001): use memset(3) in new programs.  POSIX.1-2008
   removes the specification of bzero(). 
```

您绝对应该使用`memset(3)`而不是`bzero(3)`- API 只是稍微冗长一些，但这并不完全可怕。`bcopy(3)`和的故事相同`memcpy(3)`。

`memset(3)`并且`memcpy(3)`在`<string.h>`，不是`<strings.h>`，所以也改变它。

您在代码中使用了太多的演员表；当函数的原型包含`void *`时，它将接受任何指针类型作为参数，编译器将正确跟踪类型。添加演员表会告诉编译器你知道得更好——并且会经常*掩盖*实际的错误和警告。

另请注意，这也`gethostbyname(3)`需要`<netdb.h>`标头。

进行这些更改后，您的代码编译时出现的警告更少：

```
$ CFLAGS="-Wall -Wextra" make client2
cc -Wall -Wextra    client2.c   -o client2
client2.c: In function ‘main’:
client2.c:11:25: warning: unused variable ‘n’ [-Wunused-variable]
client2.c:11:9: warning: unused variable ‘sockfd’ [-Wunused-variable]
client2.c:9:14: warning: unused parameter ‘argc’ [-Wunused-parameter]
client2.c:21:31: warning: ‘portno’ is used uninitialized in this function [-Wuninitialized] 
```

（它们都不应该是一个惊喜；它的代码正在进行中。你尝试慢慢构建代码真是太好了......）

# opencart - Opencart 模块开发 - 在某些页面中注入 javascript/html 代码

> ID：10559839
> 
> 赞同：1
> 
> 时间：2012-05-11T23:40:01.907
> 
> 标签：opencart

我是 Opencart 的初学者，刚刚开始为 Opencart 开发一个模块，它必须在这些页面中注入一些 javascript 和 html 代码行： - 购物车页面 - 产品页面 - 确认订单页面 - 注册表单页面

官方文档没有关于我该怎么做的信息，我试图找到一个关于 OpenCart 的好的文档，但我没有找到任何东西。

我需要帮助。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T10:46:57.523

挖掘死灵主题；）：

我认为最简单的方法：

upload/catalog/view/theme/[themename]/template/product/product.tpl - 在这里您可以为产品页面添加自定义 html

[你的主题名称，你不应该覆盖默认主题，因为它会在更新后造成损坏]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T12:33:12.973

这取决于您尝试插入 HTML/JavaScript 的位置。

在 OpenCart 中以*正确的*方式做事，您仅限于左列、右列、内容顶部和内容底部位置。

您需要创建的文件是：

```
admin/controller/module/mymodule.php
admin/language/english/module/mymodule.php
admin/view/template/module/mymodule.tpl
catalog/controller/module/mymodule.php
catalog/language/module/mymodule.php
catalog/view/theme/default/module/mymodule.php 
```

第一次学习如何做到这一点，最简单的方法是复制现有的 OpenCart 库存模块（最好是简单的，例如信息）。一旦你复制了它，你将需要浏览每个文件，并将对“信息”的任何引用替换为“mymodule”。

在那之后，如果你做得正确，你应该能够导航到 Admin > Extensions > Modules 并在那里看到你的模块。然后安装它，使用“添加模块”按钮将模块放置在所有相关布局上，点击保存，嘿，你在前端有一个工作模块。

要修改前端输出，只需编辑`catalog/view/theme/default/module/mymodule.php`

如果您想在 OpenCart 提供的 4 个可用位置以外的位置插入 HTML，请将您的模块放置在 content-bottom 位置并使用 JavaScript/jQuery 在您想要的位置注入一些 HTML。

如果这是针对您自己的个人网站，那么正如 Pawel S 建议的那样，简单地修改相关的视图文件（即。 `catalog/view/theme/[themename]/template/product/product.tpl`）是最简单的，但是如果您正在制作一个您计划分发的模块，那么这应该是最后的手段。

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-16T06:11:13.420

我意识到这可能早就死了，但是如果您正在创建一个需要修改现有控制器、语言、模型或视图的模块，那么要使用的正确工具是 vQMod。

vQMod 允许您使用 XML 动态修改现有代码。

[https://code.google.com/p/vqmod/](https://code.google.com/p/vqmod/)

# ruby-on-rails - Rails 正确使用 link_to 与设计的方法

> ID：10559841
> 
> 赞同：2
> 
> 时间：2012-05-11T23:40:45.393
> 
> 标签：ruby-on-rails

我开始使用 Rails 并设计身份验证，我想创建一个链接以在用户登录到管理页面时注销。

正确的写法是什么`link_to code`

这是我的`rake routes`：

```
admin_index        /admin/index(.:format)         {:controller=>"admin/home", :action=>"index"}
        new_user_session GET    /users/sign_in(.:format)       {:action=>"new", :controller=>"devise/sessions"}
            user_session POST   /users/sign_in(.:format)       {:action=>"create", :controller=>"devise/sessions"}
    destroy_user_session DELETE /users/sign_out(.:format)      {:action=>"destroy", :controller=>"devise/sessions"}
           user_password POST   /users/password(.:format)      {:action=>"create", :controller=>"devise/passwords"}
       new_user_password GET    /users/password/new(.:format)  {:action=>"new", :controller=>"devise/passwords"}
      edit_user_password GET    /users/password/edit(.:format) {:action=>"edit", :controller=>"devise/passwords"}
                         PUT    /users/password(.:format)      {:action=>"update", :controller=>"devise/passwords"}
cancel_user_registration GET    /users/cancel(.:format)        {:action=>"cancel", :controller=>"devise/registrations"}
       user_registration POST   /users(.:format)               {:action=>"create", :controller=>"devise/registrations"}
   new_user_registration GET    /users/sign_up(.:format)       {:action=>"new", :controller=>"devise/registrations"}
  edit_user_registration GET    /users/edit(.:format)          {:action=>"edit", :controller=>"devise/registrations"}
                         PUT    /users(.:format)               {:action=>"update", :controller=>"devise/registrations"}
                         DELETE /users(.:format)               {:action=>"destroy", :controller=>"devise/registrations"}
              home_index GET    /home/index(.:format)          {:controller=>"home", :action=>"index"}
                    root        /                              {:controller=>"home", :action=>"index"} 
```

我试过`<%= link_to "Sign Out", destroy_user_session_path %>`了，但是当我点击链接时，它给了我错误：

```
No route matches [GET] "/users/sign_out" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T23:49:34.360

从这个[设计示例应用程序](https://github.com/RailsApps/rails-devise/blob/master/app/views/layouts/_navigation_links.html.erb)，在[设计 wiki](https://github.com/plataformatec/devise/wiki/Example-Applications)上推荐：

```
<% if user_signed_in? %>
  <li><%= link_to 'Edit account', edit_user_registration_path %></li>
  <li><%= link_to 'Sign out', destroy_user_session_path, :method=>'delete' %></li>
<% end %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T23:53:44.820

您问题的根本错误是您没有在“link_to”中使用 RESTful 路由。

您应该将代码更正为：

```
<%= link_to "Sign Out", destroy_user_session_path, :method => :delete %> 
```

这样它就会匹配路线

```
DELETE /users(.:format)  {:action=>"destroy", :controller=>"devise/registrations" } 
```

# google-analytics - Google Analytics - SSL 跟踪更改后流量下降

> ID：10559859
> 
> 赞同：0
> 
> 时间：2012-05-11T23:43:24.243
> 
> 标签：google-analytics

我最近更改了网站上的跟踪代码，访问者等似乎下降了相当多的幅度，要么是旧代码夸大了数字，要么是新代码没有跟踪所有内容。我所做的更改旨在提供跨子域的更好跟踪，因为我添加了一个安全区域 (https://secure.)。谁能帮我解释一下下降吗？

我的新代码目前看起来像：

```
 var _gaq = _gaq || []; 
  _gaq.push(['_setAccount', 'UA-9396xxx-1']); 
  _gaq.push(['_setDomainName', '.domainname.co.uk']); 
  _gaq.push(['_trackPageview']); 

  (function() { 
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; 
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; 
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); 
  })(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T20:14:23.727

您在更新之前遇到的很可能是 Google Analytics 默认为每个子域分别设置 cookie。以下代码举例说明了这种行为：

Google Analytics 在 www.domainname.co.uk 上默认为以下行为：

```
// Sets cookie to be accessible to only www.domainname.co.uk
_gaq.push(['_setDomainName', 'www.domainname.co.uk']); 
```

Google Analytics 在secure.domainname.co.uk 上默认为以下行为：

```
// Sets cookie to be accessible to only secure.domainname.co.uk
_gaq.push(['_setDomainName', 'secure.domainname.co.uk']); 
```

根据浏览器安全预防措施，“安全”无法访问“www”cookie，因此您无法在默认情况下访问 customer1.shoppingcart.com 和 customer2.shoppingcart.com 之间的 cookie。因此，最初，“安全”_trackPageview 无法访问您的“www”cookie 数据，因此您的访问/访问者在您的原始实现中重复。

根据[Google Analytics 文档 - 跟踪多个域](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingSite)，上面的新代码看起来是正确的。

```
// Set cookie accessible to www & secure
_gaq.push(['_setDomainName', '.domainname.co.uk']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T16:39:42.270

您的页面浏览量几乎保持不变吗？如果是这样，跳出率的下降等似乎表明，在访问者在访问主站点后转到子域之前，它被计为新访问，但现在（正确地）被跟踪为同一访问的一部分。

# java - Java误认为原始数据类型？

> ID：10559860
> 
> 赞同：1
> 
> 时间：2012-05-11T23:43:29.773
> 
> 标签：java, types, primitive

问题：我无法存储号码“600851475143”。我意识到这个数字大于 int 可以容纳的数字，并且小于最大 long 值。但是，我的程序没有将变量“number”注册为 long，而是将其注册为 int。有人可以阐明这个问题吗？

** - 问题所在行

```
public class Problem3{
//What is the largest prime factor of the number 600851475143
public static void main(String[] args){
  ***long number = 600851475143 , total = 0;
    for(long x = (number-1)/2; x>1; x--)
      if(number%x == 0 && isPrime(x)) total += x;
    System.out.println(total);
}
private static boolean isPrime(long determine){
  for(long x = determine/2 - 1; x>1; x--)
    if(determine%x ==0) return false;
  return true;
} 
```

}

解决方案：正如吉姆在下面所说，为了输入长，必须在数字的末尾加上“L”或“l”。"整数文字如果以字母 L 或 l 结尾，则为 long 类型；否则为 int 类型。建议您使用大写字母 L，因为小写字母 l 与数字 1 难以区分。” - 来自 Oracle 网站上的原始类型。

更多信息： [Java 的 L 编号（长）规范](https://stackoverflow.com/questions/769963/javas-l-number-long-specification-question)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-11T23:48:49.907

长文字需要用尾随“L”表示，如`600851475143L`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T23:47:49.940

在这个字面值中放一个小“L”：

```
 600851475143L 
```

原因是：

如果整数文字以字母 L 或 l 结尾，则它是 long 类型；否则它是 int 类型。建议您使用大写字母 L，因为小写字母 l 很难与数字 1 区分开来。

[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)

你也可以使用这个表示法，更清楚：

```
 600_851_475_143L 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-11T23:48:45.513

> “我的程序没有将变量“number”注册为 long，而是将其注册为 int”。

这是不正确的。您将其声明为长。它很长。

你必须得到的是完全不同的东西：常量 600851475143 上的*编译错误*。试试 600851475143L。我建议，如果您更仔细地阅读编译器错误消息，您就会看到这一点。

# javascript - Javascript 永远不会被调用

> ID：10559861
> 
> 赞同：-1
> 
> 时间：2012-05-11T23:43:31.127
> 
> 标签：javascript, asp.net

Javascript没有触发的任何原因？

```
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
<script type="text/javascript">

function ChangeDisplay() 
{
    alert("Changing");

    document.getElementById('warningDiv').innerHTML = "<h1>Change Text</h1>";
    setTimeout(finalize,6000); 
} 

function finalize() 
{ 
    alert("Done");
    document.getElementById('warningDiv').innerHTML="<h1>Done</h1>"; 
}​
</script>

<h2>
    Welcome to ASP.NET!
</h2>
<p>
    <div id="warningDiv">Hello World</div>
    ​
</p>
<script>
    window.onload = setTimeout(ChangeDisplay, 3000); 
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T23:49:40.623

> Javascript没有触发的任何原因？

是的，`WarnTheUser`不存在并且其他函数没有被调用。

**编辑**：也许这是一个浏览器问题，你可以使用 jQuery，也许它会有所作为：

```
$(document).ready(function() { setTimeout(ChangeDisplay, 3000) }); 
```

或者

```
$(window).load(function() { setTimeout(ChangeDisplay, 3000) }); 
```

我不认为这是一个 ASP.NET 问题。无论如何，您还没有展示太多 ASP.NET 代码，您使用的是 Ajax 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T00:34:27.553

**SOLUTION**

Well, it seems that

```
<script type="text/javascript">    
   window.onload = setTimeout(ChangeDisplay(), 3000); 
</script> 
```

does work, so THANKS ALL for the various tips.

All ...minus the one that did the "-1" on the post.
Never understood why people do that.

# java - 从 ArrayList 恢复和挂起线程

> ID：10559864
> 
> 赞同：0
> 
> 时间：2012-05-11T23:43:41.113
> 
> 标签：java, multithreading, sleep, wakeup

我对 Java 有疑问。我想编写一个程序，其中有一个类 Main，它有一些类（类任务）的线程数组列表，它只写一个字母和数字。Object Main 只是从 ArrayList 中唤醒一个线程，并让它在同一个对象（Main）休眠另一个线程时做某事。但是我在类任务中得到了非法状态的错误：

```
while(suspended){
wait();
    System.out.println(character);
        } 
```

整个代码

```
import java.util.ArrayList;

public class Main extends Thread {
ArrayList<Thread> threads;
public Main() {
    super();
    threads = new ArrayList<Thread>();
}

public void run(){
    for(int i = 0; i < 1; i++){
        threads.add(new Thread(new Task(i+65)));
    }
    long cT = System.currentTimeMillis();
    for(int i = 0; i < threads.size(); i++){
        threads.get(i).start();
    }
    while(System.currentTimeMillis() - cT < 10000){
        for(int i = 0; i < threads.size(); i++){
            threads.get(i).start();
            try {
                Thread.sleep(1000);
            } catch (Exception e) {e.printStackTrace();
            }
            threads.get(i).stop();;
        }
    } 

}

public static void main(String[] args) {
//  new Main().start();
    new Thread(new Task(65)).start();

}

}

public class Task implements Runnable {
int nr;
char character;
boolean suspended, resumed, stopped;
public Task(int literaASCII) {
    this.nr = 0;
    character = (char) (literaASCII);
    suspended = true;
    resumed = true;
    stopped = false;
}

@Override
public void run() {
    while(true){
        try{
        while(suspended){
            wait();
            System.out.println(character);
        }
        if(resumed){
            System.out.println("(Wznawiam watek litera: "+character+")");
            resumed = false;
        } 
        System.out.print(nr+""+character+", ");
        nr++;
        int r =  (int)((Math.random()*500) + 500);
        Thread.sleep(r);
        }catch(Exception e){e.printStackTrace();} 
    }
}

synchronized    public void suspend(){
    suspended = true;
    resumed = false; //chyba zbedne
}

synchronized    public void resume(){
    suspended  = false;
    resumed = true;
}

public static void main(String[] args) {
    // TODO Auto-generated method stub

}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:52:39.257

如果您阅读 Javadoc，[`Thread.start()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#start%28%29)您会发现它说：

> 多次启动一个线程是不合法的。特别是，线程一旦完成执行就可能不会重新启动。

这就是你非法状态的来源。

此外，您调用了 Object.wait() 但从未调用过 notify()，这让我相信您对自己在做什么一无所知。所以我建议你拿起一本书，阅读一下 Java 中的多线程和同步。这是一个很难的话题，但是一旦你掌握了它，它就会非常有益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:57:14.830

`someObject.wait()`只能由在 上同步的线程调用`someObject`。JavaDoc`wait`提到了这一点：

> 当前线程必须拥有该对象的监视器。（[来源](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#wait%28long%29)）

换句话说，这被打破了：

```
someObject.wait();
wait(); 
```

虽然这是有效的：

```
synchronized(someObject) {
    someObject.wait();
}
synchronized(this) {
    wait();
} 
```

`notify`但是你从不打电话或`notifyAll`可疑的事实。

听起来您要实现的是一个阻塞队列：一个线程将项目放入该线程，另一个线程将它们从其中取出并处理它们。如果是这种情况，您应该查看[BlockingQueue](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/BlockingQueue.html)。

# c# - 如何从 StackTrace 获取正确的行号？

> ID：10559867
> 
> 赞同：2
> 
> 时间：2012-05-11T23:44:05.100
> 
> 标签：c#, visual-studio, stack-trace

我正在编写自己的穷人测试框架。在我的控制台应用程序中，我有这个：

```
 static void Main(string[] args)
  {     // Line 12
     double adouble = 77;
     double expected = 70;
     TestingFramework.assertEquals<double>(expected, adouble - 7);  // Line 15
     TestingFramework.assertEquals<double>(expected, adouble - 6);  // Line 16
   } 
```

在 TestingFramework 我有这一行：

```
System.Console.WriteLine("Success, File {0}, Line {1}", 
   new System.Diagnostics.StackTrace(true).GetFrame(1).GetFileName(), 
   new System.Diagnostics.StackTrace(true).GetFrame(1).GetFileLineNumber()); 
```

但是当我运行测试时，它告诉我两个函数调用的 FileLineNumber 都是 12。此外，它给了我正确的文件名，所以我认为它引用了正确的框架。

有人可以告诉我如何让它向我报告发起呼叫的行号（15 然后 16），而不是开放括号​​的行号（12）？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:59:30.783

附加到我的评论，是这样的：

```
 foreach(var frame in StackTrace.GetFrames())
    { 
        System.Reflection.MethodBase method = frame.GetMethod ( );
        Type type = method.DeclaringType;
        // If this is what I am looking for
        if ( type.IsSubclassOf( typeof(TestClassBase)) ||  type != typeof ( TestClassBase) )
        {
            System.Console.WriteLine("Success, File {0}, Line {1}", frame.GetFileName(), frame.GetFileLineNumber());
            return;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T23:15:25.300

我已经弄清楚了问题以及如何解决它。

我在 TestingFramework 中重载了 assertequals 函数：1) assertEquals(T expectedValue, T actualValue) 和 2) assertEquals(T expectedValue, T actualValue, string comment)。

当客户端代码调用 2-param 函数时，该函数只调用 3-param 函数。这种不同的帧深度取决于它的调用方式。

所以我不得不添加

```
static int depth; 
```

我在输入函数时递增，退出时递减。这将代码更改为：

```
new System.Diagnostics.StackTrace(true).GetFrame(depth).GetFileLineNumber()); 
```

现在可以了。

# jquery - 在发布请求中传递来自 jquery .sortable('serialize') 的结果

> ID：10559874
> 
> 赞同：1
> 
> 时间：2012-05-11T23:44:58.677
> 
> 标签：jquery, jquery-ui, coffeescript

所以我知道它会`$('#table_content').sortable('serialize')`返回一个数组，因为我使用 console.info 对其进行了测试。我想要做的是将该表达式的值用作发布请求中的数据，但我希望将其结果作为回调中的数据传递给另一个 ajax 请求。我以为我可以通过将其`$('#table_content').sortable('serialize')`作为 .post 的数据参数来做到这一点，但是当我这样做时，根据 firebug，参数是“undefined=undefined”。

```
jQuery ->
  ids = $('#table_content').sortable('serialize')
  console.info(ids)

  $('#tasks_table').load('/dashboard #tasks_table', null, -> $.post('/tasks/sort', $('#table_content').sortable('serialize'), ->location.reload()))

undefined=undefined 
```

关于为什么会发生这种情况的任何想法？请注意，如果我`ids`在 的位置传递`$('#table_content').sortable('serialize')`，它可以工作，但我只想`$('#table_content').sortable('serialize')`在前一个 ajax 请求运行后的值。如果我只使用 ids，那么它的值不会反映调用后的变化`$('#tasks_table').load`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T06:46:16.960

从您的示例中，您似乎在加载后最终得到以下结构（当然可能不是 DIV 元素）：

```
<!-- #tasks_table you call .load() upon -->
<div id="tasks_table"> 
   <!-- #tasks_table that is loaded -->
   <div id="tasks_table">
   </div>
</div> 
```

请注意，加载页面片段会将加载的片段（包括包装元素）**插入**匹配的集合元素中，而不是替换它们**！**

您可能应该在负载中提取 #tasks_table 的子项：

```
$('#tasks_table').load('/dashboard #tasks_table > *', ... ); 
```

* * *

不确定这一点，但您可能必须在对加载的内容调用“序列化”方法之前**初始化可排序插件。**

```
$('#tasks_table').load('/dashboard #tasks_table', null, function() {
    var ids = $('#table_content')
        .sortable() // init first
        .sortable('serialize'); // then call 'serialize'
    $.post('/tasks/sort', ids, function() {
        location.reload()
    });
}); 
```

# windows - 为什么使用 Windows 定义的数据类型？

> ID：10559879
> 
> 赞同：1
> 
> 时间：2012-05-11T23:45:41.943
> 
> 标签：windows, winapi

我最近一直在做一些 Winsock 编程。我在 Windows SDK 中做的事情不多。我从小就没有构建过真正的 Win32 应用程序，当时我也没有考虑过，但现在我查看了一些已定义的类型，它们只是简单地包装了与平台无关的其他类型，我想知道为什么有人当他们不需要时会使用它们。我看不出比使用 PSTR 或 DWORD 比使用本地对应部件有任何优势。在[Winsock Reference](http://msdn.microsoft.com/en-us/library/windows/desktop/ms741416%28v=vs.85%29.aspx) 中有一个页面列出了所有的[结构和 typedef](http://msdn.microsoft.com/en-us/library/windows/desktop/ms741435%28v=vs.85%29.aspx)被定义的。他们将所有结构类型定义为大写字母，我不理解当设计 Windows SDK 的决定是像这样将所有类型定义为大写字母时试图完成的总体策略。

我不明白为什么任何人，即使在 Windows 中编写代码，如果他们没有大写版本，也会使用大写版本，仅仅是因为如果将来需要的话，这似乎会使代码更难移植。我总是尽可能使用本机类型和原始 Winsock 结构。我试图做一些寻找这个问题的答案，但也许我想不出如何正确地表达一个查询。我错过了一些优势吗？任何人都可以为我阐明这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T00:14:03.277

优点是`typedef`Windows SDK 中的 s 将根据需要进行调整。近期历史上最好的例子可能是`DWORD_PTR`，在 x64 构建中正确使用的开箱即用的行为，而您必须经历一些困难才能使其与您所谓的“本机类型”（即那些来自语言标准）。

还要记住，一些 Winsock 函数与原始 BSD 套接字函数并不完全对应。因此，出于遗留原因或简洁性，人为地将事物分开是有意义的。

对于语言标准中未定义的某些 Win32 类型也是如此，因为它们会根据您的构建进行调整，例如`LPTSTR`.

最后但并非最不重要的一点是，如果您曾经从事过跨平台编程并且由于各种原因不能依赖（全部或部分）类型`stdint.h`，您会喜欢诸如`DWORD`到某个接口（API）。

# eclipse - 如何让 Aptana/Eclipse 用引号替换选定的文本？

> ID：10559890
> 
> 赞同：3
> 
> 时间：2012-03-20T11:03:35.360
> 
> 标签：eclipse, aptana

在 Aptana Studio 中选择部分文本时（我假设 Eclipse 通常也是如此），如下所示：
![在此处输入图像描述](../Images/dcd5d24af46cbb4a042b855592db8ddd.png)
然后键入一个单引号 ( `"`)，结果如下：
![在此处输入图像描述](../Images/95f978f37fd6c3d1b282f5d98e0e5690.png)

* * *

但我想要的是：
![在此处输入图像描述](../Images/6a90713003820957cf4ff8c511d8bb5a.png)
甚至**更好**：
![在此处输入图像描述](../Images/6558ef9ab2a4d1e566e7641eb8a90dff.png)

请注意，我真的很喜欢自动关闭括号/引号/大括号/...，我只想影响选择文本时的行为。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T09:18:59.710

### 在 Aptana Studio 3 中：

窗口 > 首选项 > Aptana Studio > 编辑器 > 禁用“用匹配字符换行所选文本”

![在此处输入图像描述](../Images/350379a34e3c1016b80e3f5fefd429f9.png)

这帮助我找到了解决方案：[https ://aptanastudio.tenderapp.com/discussions/questions/1122-disable-automatically-closing-quotes](https://aptanastudio.tenderapp.com/discussions/questions/1122-disable-automatically-closing-quotes)

# android - 无法再在模拟器/真实设备中选择编辑框

> ID：10559891
> 
> 赞同：0
> 
> 时间：2012-05-11T23:48:35.960
> 
> 标签：android, selectable, editbox

我有一个带有 4 个标签的标签主机。每个选项卡都有几个编辑框。在真正的 2.1 设备和模拟器中，我可以选择任何编辑框并将值插入其中。但在 2.3 模拟器和真实设备中 - 只有第 4 个选项卡上的编辑框是可选的...选项卡 1 - 相对布局选项卡 2-4 - 表格布局。编辑框具有相似的属性...我看不出选项卡 3 和 4 上的编辑框之间的区别，但行为不同。

注意： 2.1 是 800x480 设备（横向） 2.3 是 1024x768 设备（横向） 我有编辑框的样式 - 两种情况都一样...

有谁知道什么会导致这种情况？...

另外：刚刚注意到在 2.1 模拟器中 - 如果我单击选项卡 1-3 中的控件，一切正常。但是，如果我转到 tab4 然后返回到任何选项卡 - 编辑框在选项卡 1-3 的任何一个上都变得不可选择（第一个是“选择”但没有任何响应） - 与 2.3 相同（但这些字段不可编辑从头开始...）。而且选项卡 4 正在工作，但其余的都没有……完全与 2.3 中的一样

更新：每个选项卡都有一个单独的布局文件，这些文件通过“包含布局”包含在主布局中（{include layout="@layout/tab_1_main" /}, {include layout="@layout/tab_2_main" }， ETC）。只有在最后一个“包含”布局中，控件在 2.3 中是可编辑的 - 在其他的不是。如果“include”行被打乱（即 {include layout="@layout/tab_2_main" /} 成为最后一行），则选项卡 2 是唯一可编辑控件的选项卡...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T22:40:06.723

好像解决了

“包含”布局的 id（标记为粗体）设置在“tablelayout”级别

```
<merge xmlns:android="http://schemas.android.com/apk/res/android">
    <ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
            **android:id="@+id/layoutTab2"**
                android:scrollbars="none">
        <TableLayout 
            android:layout_width="fill_parent" 
```

似乎 Android 2.3 在向用户显示此类布局时无法“激活”这些布局。当我将 ID 移动到每个选项卡布局中的顶层（滚动视图）时 - 问题就解决了。

# linux - Damn Small Linux 上的 CGI Perl 脚本和 Monkey Web 服务器

> ID：10559896
> 
> 赞同：1
> 
> 时间：2012-05-11T23:49:18.017
> 
> 标签：linux, perl, web, cgi

我需要带有 Web 服务器的小型虚拟机，所以我决定安装 Damn Small Linux。我需要运行一个 Web 服务器，该服务器使用一个脚本来托管一个站点，该脚本检查服务器的 IP 地址并在 HTML 页面中返回它。到目前为止，我有这样的工作：

脚本文件：

```
#!/usr/bin/perl

print "Content-type: text/html\n\n" ;
print <<EOF ;
<html>
<head><title>CGI Results</title></head>
<body>
<h1>Hello, world.</h1>
</body>
</html>
EOF
exit ; 
```

该脚本是从 HTML 调用的，如下所示：

```
<iframe src="http://localhost/cgi-bin/skrypt.cgi" width="100%"></iframe> 
```

它工作正常，但是每当我向该脚本添加除`print`语句之外的其他内容时，例如：

```
my $address = "someValue" 
```

…然后HTML页面没有运行脚本，而是下载它。我必须做什么才能使这个脚本工作？我只需要一个 IP 地址就可以出现在网页上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:54:21.107

尝试在命令行中运行您的 cgi 脚本：

```
perl -c my_script.cgi 
```

如果没问题，请尝试使用严格运行并激活警告。

```
#!/usr/bin/perl
use strict;
use warnings;
use diagnostics; 
```

如果没有问题，请查看错误日志。

# php - php代码的wordpress魔术引号

> ID：10559901
> 
> 赞同：0
> 
> 时间：2012-05-11T23:50:04.343
> 
> 标签：php, wordpress, magic-quotes

我有 wordpress 安装，其中魔术引号在 phpini 文件中设置为 ON。这导致每次我更新帖子时都会重复每个报价。

我无法更改 phpini 超出了我的能力范围，因此唯一的方法是通过 php 代码。

我的 wp-config.php 文件中的参数使用魔术引号设置为 0。

有人知道我在哪里添加了一些代码来执行它。

我使用自定义帖子，所以我需要一个兼容的解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:53:41.477

1.  尝试放在`ini_set( 'magic_quotes_gpc', 0 );`页面顶部
2.  `php_flag magic_quotes_gpc off`在您的根 Wordpress 目录中放入一个 .htaccess 文件
3.  使用代码自动为您剥离斜线。这需要放在您希望处理的页面顶部：

.

```
if (get_magic_quotes_gpc()) {
    $process = array(&$_GET, &$_POST, &$_COOKIE, &$_REQUEST);
    while (list($key, $val) = each($process)) {
        foreach ($val as $k => $v) {
            unset($process[$key][$k]);
            if (is_array($v)) {
                $process[$key][stripslashes($k)] = $v;
                $process[] = &$process[$key][stripslashes($k)];
            } else {
                $process[$key][stripslashes($k)] = stripslashes($v);
            }
        }
    }
    unset($process);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T00:04:04.257

最后我发现了这个：

```
if ( get_magic_quotes_gpc() ) {
    $_POST      = array_map( 'stripslashes_deep', $_POST );
    $_GET       = array_map( 'stripslashes_deep', $_GET );
    $_COOKIE    = array_map( 'stripslashes_deep', $_COOKIE );
    $_REQUEST   = array_map( 'stripslashes_deep', $_REQUEST ); 
} 
```

设置在我页面的开头。

它有效。

谢谢大家。

# php - 使用haversine公式，结果太高

> ID：10559902
> 
> 赞同：0
> 
> 时间：2012-05-11T23:50:30.943
> 
> 标签：php, geolocation, haversine

我有一个问题，我花了太多时间试图解决。我正在使用 de Haversine 公式来计算两点之间的距离，但是我使用的代码给我的值对于像 KM 这样的距离来说太高了。

这是代码：

```
$pesquisa_raio = "%" . $_GET['raio'] . "%";
$latitude = floatval("%" . $_GET['lat'] . "%");
$longitude = floatval("%" . $_GET['log'] . "%");
$cidade="%" . $_GET['cidade'] . "%";

$sql= "SELECT * FROM oferta";//"add depois" //Inner Join concelhos On oferta.concelhos_id = concelhos.idconcelhos ";
$query = mysql_query($sql);
$array = mysql_fetch_array($query);
$row = mysql_num_rows($query);
//$sql_cidades = "SELECT * FROM oferta WHERE localizacao like '$pesquisa_loc'";

if (isset($latitude) && isset($longitude)) {
    if ($row > 0) {
        do {
        $endereco=$array['concelho_id'];
        $request="http://maps.google.com/maps/api/geocode/json?address='.$endereco.'sensor=false";
        $json_data=file_get_contents($request);

        $earth_radius = 6372.795477598;
        $lat_1 = floatval($latitude);
        $lon_1 = floatval($longitude);
        $lat_2 = 41.145570;//floatval($latitude2);
        $lon_2 = -8.627014;//floatval($longitude2);
        $delta_lat = $lat_2 - $lat_1 ;
        $delta_lon = $lon_2 - $lon_1 ;
        $alpha    = $delta_lat/2;
        $beta     = $delta_lon/2;
        $a        = sin(deg2rad($alpha)) * sin(deg2rad($alpha)) + cos(deg2rad($lat_1)) * cos(deg2rad($lat_2)) * sin(deg2rad($beta)) * sin(deg2rad($beta)) ;
        $c        = asin(min(1, sqrt($a)));
        $distance = 2*$earth_radius * $c;
        $distance = round($distance, 4);
        echo $distance."\n";
          if($distance<=$pesquisa_raio){
            $response = $array['titulo'] . "|";
        }
    } while ($array = mysql_fetch_assoc($query));
        json_encode($response); 
```

代码有问题，还是我无法理解结果？

* * *

### 解决了

所以我有这段代码不起作用，但我解决了这个问题，这就是解决方案：

```
 $tipo_output = "json"; // pode ser utilizado o json também
               // a sua API KEY do Google Maps gerado com o link acima
                $google_api = "0R4r34bcHA6I0Ppts5oHcxhgoPmdOvt4Hz2cA2w";
               // o endereço que desejamos que o google procure
               // lembrando que o endereço tem que ser no padrão de uma requisição URL e caso possua acentuação, vamos executar um utf8_encode
               $cidade=$array['concelho'];
               echo $cidade;
               $endereco_desejado = urlencode(utf8_encode("$cidade, PT"));
               // Desired address
               $endereco_final = "http://maps.google.com/maps/api/geocode/json?address=". $endereco_desejado ."&sensor=true";
               // conteudo da página
                $string = file_get_contents($endereco_final); // get json content
$json_a = json_decode($string); //json decoder
            //busca da lat e log
            $longitude2 = $json_a->results[0]->geometry->location->lng;
            $latitude2 =$json_a->results[0]->geometry->location->lat;
            //calculo da distancia

            $earth_radius = 6371.0;
            $latitude1 = $latitude * pi() / 180.0;
            $longitude1 = $longitude * pi() / 180.0;
            $latitude2 = $latitude2 * pi() / 180.0;
            $longitude2 = $longitude2 * pi() / 180.0;

             $dLat = $latitude2 - $latitude1;
             $dLong = $longitude2 - $longitude1;

             $a = sin($dLat / 2) * sin($dLat / 2) + cos( $latitude1) * cos($latitude2) * sin($dLong / 2) * sin($dLong / 2);

             $c = 2 * atan2(sqrt($a), sqrt(1 - $a));

             $resultado=intval($earth_radius * $c); // resultado em km. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T00:04:57.497

我不确定你的代码，但我会创建一个函数来计算距离。

```
function getDistance($latitude1, $longitude1, $latitude2, $longitude2) {
    $earth_radius = 6371;

    $dLat = deg2rad($latitude2 - $latitude1);
    $dLon = deg2rad($longitude2 - $longitude1);

    $a = sin($dLat/2) * sin($dLat/2) + cos(deg2rad($latitude1)) * cos(deg2rad($latitude2)) * sin($dLon/2) * sin($dLon/2);
    $c = 2 * asin(sqrt($a));
    $d = $earth_radius * $c;

    return $d;
} 
```

[取自 Hasversine 公式的 codecodex.com 页面](http://www.codecodex.com/wiki/Calculate_Distance_Between_Two_Points_on_a_Globe#PHP)

我测试了 C# 公式，它是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T06:08:25.553

您的输入已损坏。

```
$latitude = floatval("%" . $_GET['lat'] . "%");
$longitude = floatval("%" . $_GET['log'] . "%"); 
```

想想你在做什么。`floatval('%123.4%')`无论您从`$_GET`.

这些看起来像是 SQL 查询的剩余部分，但您需要不同的转义方法（例如 PDO）来避免 SQL 注入。

* * *

此外，您正在使用格式错误的查询加载远程数据并且显然忽略了结果？

```
$endereco=$array['concelho_id'];
$request="http://maps.google.com/maps/api/geocode/json?address='.$endereco.'sensor=false";
$json_data=file_get_contents($request); 
```

这将产生一个类似于 的 URL `http://maps.google.com/maps/api/geocode/json?address='.some kind of address.'sensor=false`，它永远不会给你有用的答案，因为它是

1.  包括单引号和句点（您似乎混淆了双引号和单引号），
2.  根本没有正确地逃避动态部分，
3.  缺少一个`&`之前`sensor=false`。

（更不用说在你第一次运行循环`$array`时甚至不会被初始化。）`do {} while`

# java - 关闭另一个班级的活动

> ID：10559904
> 
> 赞同：11
> 
> 时间：2012-05-11T23:50:35.717
> 
> 标签：java, android, google-maps

在创建我的 google-maps 应用程序期间，我在 Android 中有一个问题。

我有一项活动如下

```
public class MapCallActivity extends MapActivity {
    classA class = new classA(this);
    classA.callMethod();
} 
```

`classA`定义如下：

```
 public class classA{
   public classA(Context context){
   this.myContext = context;
 }

   void callMethod(){
      if (isFileValid) {
        <do_something...>;
      } else {
        <call_the_activity's finish() method>;
      }
   }
 } 
```

有没有办法让我`<call_the_activity's finish() method>`关闭`MapCallActivity`？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-11T23:54:32.587

```
public class classA{
    public classA(Context context){
        this.myContext = context;
    }

    void callMethod(){
        if(isFileValid){

        }else{
            ((Activity)myContext).finish();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-18T02:00:19.633

我通常做的是在我的活动中使用接收器，然后从**B 类**触发广播。 **A 类**获取广播，其**onReceive**处理工作。说**完成（）；**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-18T08:29:02.090

像这样你可以从另一个类中调用 Activity 的完成方法。这是完美的工作。在 kotlin 代码中使用。

```
class DialogHelper(applicationContext: Context) {

 private var context = applicationContext

    fun showDialog() {
        var dialog: Dialog? = null
        val builder = Dialog.Builder(context)
            .content(R.string.your_string)
            .positiveButton(R.string.str_ok, listener = {
                (context as Activity).finish()
                dialog?.hide()
            })
        dialog = builder.create()
        dialog.setCanceledOnTouchOutside(false)
        dialog.show()
    }
} 
```

# javascript - jQuery在文本中添加数字

> ID：10559911
> 
> 赞同：3
> 
> 时间：2012-05-11T23:52:27.953
> 
> 标签：javascript, jquery

我正在尝试做一些我认为非常简单的事情。将 1 的值加到一个数字上。

然而，这个数字是纯文本，事情变得有点混乱。您可能会猜到，我对此很陌生。

我的目标是在现有分数上加 1 分，分数有一位小数，例如 1.3。所以加点后想要的结果是2.3。但是，我编写的当前脚本正在返回将一个点添加到小数点后第二位，我不明白为什么。

谢谢您的帮助。

```
var getPoints = parseInt($('.awesome-points').text(), 10).toFixed(1);
alert(getPoints);
var addPoint = 1;
var newScore = getPoints + addPoint;
$('.awesome-points').text(newScore); 
```

标记

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-12T00:00:27.570

`.toFixed()`返回一个字符串（参见[MDN 文档](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number/toFixed)），这就是`getPoints + addPoint`执行字符串连接而不是加法的原因。

执行添加*后*调用该方法：

```
// unary + converts any numerical string to a number (no matter whether float
// or int)
var getPoints = +$('.awesome-points').text();
var newScore = getPoints + 1;
$('.awesome-points').text(newScore.toFixed(1)); 
```

或更简洁：

```
$('.awesome-points').text(function(i, val) {
    return (+val + 1).toFixed(1);
}); 
```

这是如何工作的：

[您可以传递一个](http://api.jquery.com/text/#text2)[*函数*](http://api.jquery.com/text/#text2)`.text()`，而不是将值传递给。将为每个选定的元素执行此函数。传递给函数的第一个参数是所选元素集中元素的索引，第二个参数是当前文本内容。返回值将设置为新的文本内容。 这是读取和写入文本内容的好方法，无需调用两次。[](http://api.jquery.com/text/#text2) *`.text()`*

 *`(+val + 1).toFixed(1)`求值如下：首先`val`通过一元加号（`+val`）转换为数字，然后加一（`+ 1`）。`.toFixed(1)`在该操作的结果上调用。

`+val``NaN`如果文本无法成功转换为数字，将返回。我认为这不会发生在你的情况下，但这可以很容易地用表达式处理

```
return ((+val || 0) + 1).toFixed(1); 
```

这意味着，如果`+val`计算结果为`false`（包括`NaN`），我们将`0`改为使用。这是 JavaScript 中的一种常见模式，另请参阅 JavaScript中的[“options = options || {}”是什么意思？](https://stackoverflow.com/q/2851404/218196).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T01:33:31.637

我想你想要的是这样的

```
var getPoints = $('.awesome-points').text();
//alert(getPoints);
var addPoint = 1;
var newScore = parseFloat(getPoints) + addPoint;
$('.awesome-points').text(newScore.toFixed(1)); 
```

似乎这是您的答案， toFixed() 将数值转换为字符串，因此通过在您的流程后期制作 toFixed 函数*

# c++ - 类体之外的成员函数定义导致错误

> ID：10559912
> 
> 赞同：0
> 
> 时间：2012-05-11T23:52:30.133
> 
> 标签：c++, templates, stack, singly-linked-list

我对模板的概念很陌生。我错过了什么吗？

```
#ifndef STACK_H
#define STACK_H

template < class T>
class Stack{
private:
  struct node {
    T data;
    node* next;
  };
  node * top;
  //node* getNewNode(T num);
};

//template <class T>
//(node*)Stack<T> :: getNewNode(T num){
//    node *    temp = new node;
//      temp->data = num;
//      temp->next = NULL;
//      return temp;
//  }

#endif 
```

当我取消注释函数 getNewNode 并将相应的语句推荐给 getNewNode 函数时，编译器会给出错误，例如为什么我的函数 getNewNode 没有按预期工作。我哪里做错了？

```
Error   7   error C2470: 'Stack<T>::getNewNode' : looks like a function
definition, but there is no parameter list; skipping apparent
body    c:\users\nitinjose\documents\visual studio
2010\projects\templatequeue\templatequeue\stack.h   26  1   TemplateQueue
Error   2   error C4430: missing type specifier - int assumed. Note: C++
does not support default-int    c:\users\nitinjose\documents\visual
studio
2010\projects\templatequeue\templatequeue\stack.h   26  1   TemplateQueue
Error   5   error C2146: syntax error : missing ')' before identifier
'num'   c:\users\nitinjose\documents\visual studio
2010\projects\templatequeue\templatequeue\stack.h   26  1   TemplateQueue 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:56:42.650

返回值的规范是错误的。尝试这个

```
template <class T>
typename Stack<T>::node* Stack<T> :: getNewNode(T num){
    // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T00:05:19.350

在类主体之外定义成员函数会稍微改变此时可以访问哪些名称的规则。在您的情况下，编译器不知道是什么`node`。你需要告诉他，`node*`实际上是在课堂`Stack<T>`上，例如`typename Stack<T>::node`。这里`typename`是必需的，因为 node 是一个从属名称。

# algorithm - 编程算法：寻找比赛的获胜者

> ID：10559915
> 
> 赞同：8
> 
> 时间：2012-05-11T23:52:51.413
> 
> 标签：algorithm

我将参加 OBI（巴西信息学奥林匹克，英语），我正在尝试过去几年的一些练习。但是我找不到这个练习的解决方案（我翻译了它，所以可能会有一些错误）：

> 巧克力大赛
> 
> 卡洛斯和宝拉刚拿到一袋巧克力球。由于他们吃得太快，他们进行了比赛：
> 
> *   他们会一个接一个地交替进食（宝拉总是开始）。
> *   每次只能吃1到M个丸子，M由Paula的妈妈决定，所以他们不会噎着。
> *   如果一个人轮到他/她吃 K 个球，那么下一个不能吃 K 个球。
> *   谁不能按上述规则比赛谁输。

在下面的示例中，M = 5 和 20 个球，卡洛斯赢了：

```
Who plays        How many ate        Balls left

                                     20
Paula            5                   15
Carlos           4                   11
Paula            3                   8
Carlos           4                   4
Paula            2                   2
Carlos           1                   1 
```

请注意，最后，卡洛斯不能吃 2 个球来获胜，因为宝拉在最后一回合吃了 2 个。但是保拉吃不到最后一个球，因为卡洛斯在最后一回合吃了1个，所以保拉不能上场，输了。

两者都非常聪明并且发挥最佳。如果有一系列回合可以确保他/她的胜利独立于其他回合，他/她将玩这些序列。

任务：

你的任务是找出如果双方都发挥最佳，谁将赢得比赛。

输入：

输入只包含一个测试组，应该从标准输入（通常是键盘）读取。

输入有 2 个整数 N (2 ≤ N ≤ 1000000) 和 M (2 ≤ M ≤ 1000)，其中 N 是球数，M 是每圈允许的球数。

输出：

您的程序应该在标准输出中打印包含获胜者姓名的一行。

例子：

```
Input:          Output:
5 3             Paula
20 5            Carlos
5 6             Paula 
```

我一直在尝试解决这个问题，但我不知道如何解决。

可以在此处找到 C 中的解决方案：http: [//olimpiada.ic.unicamp.br/passadas/OBI2009/res_fase2_prog/programacao_n2/solucoes/chocolate.c.txt](http://olimpiada.ic.unicamp.br/passadas/OBI2009/res_fase2_prog/programacao_n2/solucoes/chocolate.c.txt)但我无法理解该算法。有人在另一个网站上发布了关于这个问题的问题，但没有人回复。

你能解释一下算法吗？

以下是该计划的预期输出：http: [//olimpiada.ic.unicamp.br/passadas/OBI2009/res_fase2_prog/programacao_n2/gabaritos/chocolate.zip](http://olimpiada.ic.unicamp.br/passadas/OBI2009/res_fase2_prog/programacao_n2/gabaritos/chocolate.zip)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T05:47:14.067

假设我们有一个布尔函数 FirstPlayerWin (FPW)，它接受两个参数：剩下的巧克力数量 (c) 和最后一步 (l)，即上一轮采取的巧克力数量，在第一步时为 0。当且仅当第一个在这种情况下比赛的玩家保证获胜时，该例程才会返回 true。

基本情况是任何 l != 1 的 FPW(0, l) = false

否则，要计算 FPW(c, l)，如果任何 x <= M, x <= c, x != l, FPW(c - x, x) 为假，则 FPW(c, l) 为真。否则为假。这就是动态规划发挥作用的地方，因为现在 FPW 的计算简化为计算较小 c 值的 FPW。

但是，存储此公式的条目将需要 N * M 表条目，而您指出的解决方案仅使用 2N 表条目。

这样做的原因是，如果 FPW(c, 0) 为真（如果在巧克力计数 c 处有任何移动可用，则第一个玩家获胜）但 FPW(c, x) 对于 x > 0 为假，FPW(c, y) 对于并且 y != x 必须为真。这是因为如果拒绝移动 x 会使玩家输掉，即玩家只能通过下 x 来获胜，那么当 y 被禁止时，移动 x 是可用的。因此，对于任何计数“c”，最多存储一个导致玩家输掉的禁止移动就足够了。因此，您可以重构动态规划问题，以便您拥有两个数组，而不是存储完整的二维数组 FPW(c, x)，一个存储值 FPW(c, 0)，另一个存储导致的单个禁止移动第一个输掉而不是赢的玩家，如果有的话。

如何获得引用的 C 程序的确切文本留给读者作为练习。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T04:34:45.497

我认为这是动态编程中又一个隐蔽的练习。游戏的状态由两个量来描述：剩余的球数和上一步吃掉的球数。当剩余的球数 <= M 时，游戏要么赢（如果剩余的数量不等于前一步吃掉的数量）或输（如果是 - 你不能吃掉所有的球，并且你的对手可以吃掉你留下的球）。

如果你已经计算出最多 H 的所有球数的输赢情况，以及前一个玩家吃掉的所有可能的球数并将其写在表格中，那么你可以计算出所有球数的答案最多 H+1。一个有 H+1 个球和 k 个球在前一步吃掉的玩家会考虑所有的可能性 - 吃 i 个球，因为 i = 1 到 M，除了 k 的非法值，留下一个有 H+1-i 个球和前一个球的位置i的移动。他们可以使用表格给出最多 H 个球的输赢情况，尝试找到一个合法的 k 让他们获胜。如果他们能找到这样的值，那么 H+1/k 的位置就是胜利。如果没有，那就是损失，所以他们可以扩大桌子以覆盖 H+1 个球，依此类推。

我还没有完成所有未注释的示例代码，但看起来它可能正在做这样的事情 - 使用像递归这样的动态编程来构建表。

# c# - 从本地数据库c#中读取列

> ID：10559918
> 
> 赞同：0
> 
> 时间：2012-05-11T23:53:36.997
> 
> 标签：c#, database, visual-studio

我敢肯定，这是一个非常简单的问题，所以请多多包涵。我在 Visual Studio 2010 中创建了一个本地数据库。我创建了一个带有列的表`(c1,c2)`。我还使用 VS 的向导创建了一个数据集。这包括一个`ListTableAdapter`. 我能够用值填充数据库，但我无法获取`c2`. 谁能提供一个从 c# 中的指定列获取行集合的示例？如果您需要澄清细节，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T00:09:27.600

列没有行。您遍历行并选择字段。

例如类似的东西

```
foreach(DataRow row in MyDataset.Table["TableName"].Rows)
{
  yield return row["FieldName"];
} 
```

您想要什么类型以及如何处理空值将是一个考虑因素。请记住，表中的 ColumnName 是数据表中的 fieldName 是默认值。同样，列具有本机类型，但 DataRow 中的字段是对象，如果在数据库中为 null，则将其设置为 DBNull.Value。

# android - 如何将相机图像保存到目录并压缩它

> ID：10559926
> 
> 赞同：0
> 
> 时间：2012-05-11T23:54:36.410
> 
> 标签：android, image, directory

我正在开发一个应用程序，其中一个要求是在每捕获 5 张图像压缩文件夹后将从相机捕获的图像保存到文件夹中。谁能帮我修复以下代码或指出我哪里出错了。任何供参考的来源或链接表示赞赏。

```
package c.k;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import org.apache.commons.net.ftp.FTP;
import org.apache.commons.net.ftp.FTPClient;
import org.apache.commons.net.ftp.FTPReply;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.graphics.Bitmap;
import android.net.Uri;
import android.os.Bundle;
import android.os.Environment;
import android.provider.MediaStore;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.Toast;

public class ProjectActivity extends Activity {

Intent i;
final static int cameraData = 0;
ImageButton ib;
Bitmap bmp;
Button tg;
Button st;
private static final int CAMERA_REQUEST = 100;
protected static final int MEDIA_TYPE_IMAGE = 1;
private ImageView imageView;

/** Called when the activity is first created. */

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    ib = (ImageButton) this.findViewById(R.id.imageButton1);
    imageView = (ImageView) this.findViewById(R.id.imageView1);

    //trigger();
    ib.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {  
            String path = getDir("camerApp", Context.MODE_PRIVATE).getPath() + "/test.jpg";
            Log.d(path, "the path");
            File file = new File(path);
            final Uri outputFileUri = Uri.fromFile(file);
            Log.d(outputFileUri.toString(), "The file URI");
            Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE); 
            cameraIntent.putExtra(MediaStore.EXTRA_OUTPUT, outputFileUri);
            Log.d(MediaStore.EXTRA_OUTPUT, "The medis output");
            startActivityForResult(cameraIntent, CAMERA_REQUEST); 
        }
    });

}

protected void onActivityResult(int requestCode, int resultCode, Intent data) {  
   if(requestCode == CAMERA_REQUEST) {  
        Bitmap photo = (Bitmap) data.getExtras().get(MediaStore.EXTRA_OUTPUT);
        Log.d("", "the bitmap image");
        imageView.setImageBitmap(photo);
    if (resultCode == RESULT_OK) {
        // Image captured and saved to fileUri specified in the Intent
        Toast.makeText(this, "Image saved to:\n" +
                 data.getData(), Toast.LENGTH_LONG).show();
    } else if (resultCode == RESULT_CANCELED) {
        // User cancelled the image capture
        Toast.makeText(this, "Image saved to:\n" +
                data.getData(), Toast.LENGTH_LONG).show();
    } } 
} 

/*
public void trigger() {
    ib = (ImageButton) findViewById(R.id.imageButton1);
    ib.setOnClickListener(this);

}

public void onClick(View v) {
    i = new Intent(android.provider.MediaStore.INTENT_ACTION_STILL_IMAGE_CAMERA);
    startActivityForResult(i, cameraData);
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {

    super.onActivityResult(requestCode, resultCode, data);
    if (resultCode == RESULT_OK) {
        Bundle extras = data.getExtras();
        bmp = (Bitmap) extras.get("data");
    }
}*/

public void onClick(View v){
    setContentView(R.layout.main);

}

public void onSettings(View V) {

    final CharSequence[] items = { "Backup Images", "Retrieve Images" };

    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setTitle("Pick a color");
    builder.setSingleChoiceItems(items, -1,
            new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int item) {
                    Toast.makeText(getApplicationContext(), items[item],
                            Toast.LENGTH_SHORT).show();
                }
            });
    AlertDialog alert = builder.create();

}

public FTPClient client;
public String host = "10.185.209.83";
public String username = "karthik";
public String password = "1234";
public int port = 21;

public boolean onConnect(View v) {
    try {
        client = new FTPClient();
        client.connect(host, port);

        if (FTPReply.isPositiveCompletion(client.getReplyCode())) {

            boolean status = client.login(username, password);

            client.setFileType(FTP.BINARY_FILE_TYPE);
            client.enterLocalPassiveMode();

            return status;
        }
    } catch (Exception e) {
    }

    return false;
}

// The ftpDisconnect() method is called when the client wants to disconnect
// from the server.
public boolean ftpDisconnect() {
    try {
        client.logout();
        client.disconnect();
        return true;
    } catch (Exception e) {
    }

    return false;
}

// The below code lets the user view the current working directory.
public String ftpGetCurrentWorkingDirectory() {
    try {
        String workingDir = client.printWorkingDirectory();
        return workingDir;
    } catch (Exception e) {

    }

    return null;
}

// The client can create a new directory using this method.
public boolean ftpMakeDirectory(String new_dir_path) {
    try {
        boolean status = client.makeDirectory(new_dir_path);
        return status;
    } catch (Exception e) {

    }

    return false;
}

// THe ftpDownload method lets the client download files from the server. We
// specify the path to the files and the path in the client where we want
// the files to be stored.

public boolean ftpDownload(String srcFilePath, String desFilePath) {
    boolean status = false;
    try {
        FileOutputStream desFileStream = new FileOutputStream(desFilePath);
        ;
        status = client.retrieveFile(srcFilePath, desFileStream);
        desFileStream.close();

        return status;
    } catch (Exception e) {
    }

    return status;
}

// The upload method is used for sending files to the server. We specify the
// source file path where the files are found and the file name.

public boolean ftpUpload(String srcFilePath, String desFileName,
        String desDirectory) {
    boolean status = false;
    try {
        FileInputStream srcFileStream = new FileInputStream(srcFilePath);

        // change working directory to the destination directory
        if (ftpMakeDirectory(desDirectory)) {
            status = client.storeFile(desFileName, srcFileStream);
        }

        srcFileStream.close();
        return status;
    } catch (Exception e) {

    }

    return status;
}

} 
```

# postgresql - PostgreSQL：当来自另一个模式的视图依赖于它时更新模式

> ID：10559927
> 
> 赞同：2
> 
> 时间：2012-05-11T23:54:54.163
> 
> 标签：postgresql, views, schema

这是我的设置。我有两个模式：`my_app`和`static_data`. 后者是从静态转储导入的。为了满足我的应用程序逻辑的需要，我制作了使用 的表的视图`static_data`，并将它们存储在`my_app`模式中。

这一切都很好。但我需要`static_data`用新的转储更新架构，并让我的视图使用新数据。问题是，无论我做什么，我的观点总是会参考旧模式！

我尝试在新架构中导入新转储`static_data_new`，然后尝试删除`static_data`并重命名`static_data_new`为`static_data`. 它不起作用，因为我的视图依赖于 中的表`static_data`，因此 PostgreSQL 不会让我删除它。

然后我尝试设置`search_path`为`static_data_new`. 但是当我这样做时，视图仍然引用旧表！

是否有可能使用引用表的视图`search_path`？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T01:05:48.320

视图绑定到底层*对象*。重命名对象不会影响此链接。
我基本上看到了**3 种不同的方法**来处理您的问题：

1.  **`DELETE`您的意见**`CREATE`并在您的新表格就位后重新提出意见。简单快速，只要您有完整的创建脚本。也不要忘记重置权限。但是，重新创建脚本可能编译起来很乏味。

2.  使用**表函数**（函数`RETURNING SETOF rows`或`RETURNING TABLE`）而不是视图。从而获得“后期绑定”：对象名称将在执行时在系统目录中查找，而不是在创建时。实际上，您有责任找到这些对象。

    `search_path`可以为[每个函数预先设置，](http://www.postgresql.org/docs/current/interactive/sql-createfunction.html#SQL-CREATEFUNCTION-SECURITY)或者执行`search_path`角色对没有明确模式限定的对象有效。[此相关答案](https://stackoverflow.com/a/7548734/939860)中的详细说明和链接SO 。

    函数基本上就像准备好的语句，其行为与视图略有不同。[dba.SE 上此相关答案中的](https://dba.stackexchange.com/a/8189/3684)详细信息。

3.  为新数据采用**`TRUNCATE`and`INSERT`**路由而不是`DELETE`and `CREATE`。然后所有引用保持不变。[在这里](https://stackoverflow.com/a/8826879/939860)找到更详细的答案。

    如果外键引用您的表，则必须`DELETE FROM TABLE`改用 - 或删除并重新创建外键约束。您有责任恢复参照完整性，否则重新创建外键将失败。

# html - CSS DIV 宽度 100% 超过 div

> ID：10559928
> 
> 赞同：4
> 
> 时间：2012-05-11T23:55:00.273
> 
> 标签：html, css

我有一个宽度为 512px 的 DIV。然后在那个 DIV 里面是另一个 DIV。我将 THAT DIV 的宽度设置为 100%。然而，这不是我想要的。

我正在努力使它保持在 div 内。就像所有边上的 5px 填充一样。

[http://jsfiddle.net/weka/USvTC/](http://jsfiddle.net/weka/USvTC/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T00:04:16.047

发生此问题是因为`padding`并且`border`不是`width: 100%`.

假设您确实想要绝对定位`#exp_wrap`，请使用：http: [//jsfiddle.net/thirtydot/USvTC/1/](http://jsfiddle.net/thirtydot/USvTC/1/)

我删除`width: 100%`了`.bar_wrap`/ `#exp_wrap`，并添加`right:5px;`了`#exp_wrap`。

块元素（例如 a`div`默认为`width: auto`，并占用全部可用水平空间）。这类似于`width: 100%`工作原理，除了`padding`和`border`被计算*在内* `width: auto`。

如果`#exp_wrap`不需要绝对定位，使用这个：http: [//jsfiddle.net/thirtydot/USvTC/2/](http://jsfiddle.net/thirtydot/USvTC/2/)

我再次删除/`width: 100%`并替换为. 我还添加了 to以避免折叠边距。`.bar_wrap``#exp_wrap``position:absolute; top:5px; left:5px;``margin: 5px;``overflow: hidden``.container`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T23:58:39.217

只需将子元素的宽度设置为宽度 (502) 的 512-(2*5) 像素，而不是 100%。

# c++ - 可变大小的 char 数组，最小化对 new 的调用？

> ID：10559930
> 
> 赞同：-1
> 
> 时间：2012-05-11T23:55:14.363
> 
> 标签：c++

我需要一个大小会动态变化的 char 数组。我不知道它可以有多大，所以预分配不是一种选择。它永远不会超过 20 字节 1 次，下一次它可能会达到 5kb ......

我希望分配就像一个标准向量。

我想过使用标准向量 < char > 但所有这些推回似乎都在浪费时间：

```
strVec.clear();
for(size_t i = 0; i < varLen; ++i)
{
   strVec.push_back(0);
} 
```

这是我能做的最好的事情，还是有办法一次将一堆项目添加到向量中？或者也许是更好的方法来做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T00:02:43.550

`std::vector`每次调用时都不会分配内存`push_back`，但只有在大小变得大于容量时才分配内存

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-12T04:28:18.560

首先，在分析代码并确定存在瓶颈之前不要进行优化。通过做一些聪明的事情来考虑可读性、可访问性和可维护性的成本。确保您采取的任何计划都不会妨碍您将来使用 Unicode。还在？好吧。

正如其他人所提到的，向量保留的内存比它们最初使用的更多，并且 push_back 通常非常便宜。

但是，在某些情况下，使用 push_back 重新分配的内存超出了必要的范围。例如，对 myvector.push_back() 的一百万次调用可能会触发 myvector 的 10 或 20 次重新分配。另一方面，在其末尾插入向量将导致 myvector* 最多 1 次重新分配。出于速度和可读性的原因，我通常更喜欢插入习语而不是 reserve / push_back 习语。

```
myvector.insert(myvector.end(), inputBegin, inputEnd) 
```

如果您事先不知道字符串的大小并且不能容忍由重新分配引起的打嗝，可能是因为硬实时限制，那么也许您应该使用链表。链表将以更差的平均性能为代价获得一致的性能。

如果所有这些都不足以满足您的目的，请考虑其他数据结构，例如[绳索](http://en.wikipedia.org/wiki/Rope_%28computer_science%29)或回发有关您的案例的更多细节。

*   来自 Scott Meyer 的 Effective STL，IIRC

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T23:57:52.460

您可以使用`resize`成员函数添加一堆。但是，我不认为这`push_back`会很慢，特别是如果向量的内部容量已经很重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-12T04:50:39.810

> 这是我能做的最好的事情，还是有办法一次将一堆项目添加到向量中？或者也许是更好的方法来做到这一点。

`push_back`不是很慢，它只是将大小与当前容量进行比较，并在必要时重新分配。由于 CPU 上的分支预测和超标量执行，比较结果可能基本上为零。重新分配执行 O(log N) 次，因此向量使用的内存最多是所需内存的两倍，但花费在重新分配上的时间很少加起来。

要一次插入多个项目，请使用`insert`. 有一些重载，唯一的技巧是你需要明确地传递`end`.

```
my_vec.insert( my_vec.end(), num_to_add, initial_value );
my_vec.insert( my_vec.end(), first, last ); // iterators or pointers 
```

对于第二种形式，您可以先将值放入数组中，然后将数组复制到向量的末尾。但这可能会增加和消除一样多的复杂性。这就是微优化的方式。仅当您知道有可衡量的收益时才尝试优化。

# salesforce - databasedotcom 中的身份验证失败

> ID：10559933
> 
> 赞同：3
> 
> 时间：2012-05-11T23:55:38.953
> 
> 标签：salesforce, databasedotcom-gem

我正在尝试采用 databasedotcom gem，但无法超越身份验证。这是我所做的（在安装 databasedotcom gem 之后）：

1.  rails c（或irb然后需要'databasedotcom'）
2.  client=Databasedotcom::Client.new :client_id => 'foo', :client_secret=>'bar'
3.  client.ca_file = '/Users/tjiang/missioncontrol/tmp/ca-bundle.crt'
4.  client.verify_mode = OpenSSL::SSL::VERIFY_PEER
5.  client.authenticate :username=>'myusername', :password=>'mypassword'

所有凭据都在此过程中复制并粘贴，因此不会出现错误；证书在这里下载：http: [//certifie.com/ca-bundle/ca-bundle.crt.txt](http://certifie.com/ca-bundle/ca-bundle.crt.txt)

我反复尝试了 Ruby 187 和 193 以及 Rails 内部和外部，但总是收到以下错误消息：

Databasedotcom::SalesForceError：来自 /Library/Ruby/Gems/1.8/gems/databasedotcom-1.3.0/lib/databasedotcom/client.rb:112:in 'authenticate' 的身份验证失败

我想知道我在这里错过了什么？特别是，我担心在 Salesforce 中创建远程访问时使用的回调 URL（我尝试了“oob”、“http://localhost:3000”和“https://www.salesforce.com”，但没有有什么不同）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-12T15:35:15.440

事实证明，这是由于 databasedotcom 中的一个错误。当您使用用户名和密码进行身份验证时，它会将它们放入不带编码的 url 查询字符串中，并使用该 url 发布请求。结果，我的用户名中的加号将被解释为空格。

解决方案： CGI::escape() 你的用户名和密码。

# python - django：如何从数据库对象的主键中散列 URL？

> ID：10559935
> 
> 赞同：6
> 
> 时间：2012-05-11T23:55:51.887
> 
> 标签：python, django, design-patterns, url, hash

我正在尝试为我的数据库对象生成 URL。[我读过](http://agiliq.com/books/djangodesignpatterns/misc.html#do-not-use-primary-keys-in-urls)我不应该对 URL 使用主键，对于这个特定的模型来说，存根不是一个好的选择。根据该链接中的建议，我在 Python 解释器中使用 zlib.crc32() 并发现值通常返回负数，这是我不希望在我的 URL 中出现的。我应该使用更好的哈希来生成我的 URL 吗？

**更新：**我最终使用了 David 下面建议的按位 XOR 掩码方法，效果非常好。感谢大家的意见。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-12T00:49:56.497

首先，“不要在 URL 中使用主键”只是一个非常薄弱的​​准则。*如果*您使用的是增量整数 ID *，并且*您不想透露这些数字，那么您可以稍微混淆一下它们。例如，您可以使用:`masked_id = entity.id ^ 0xABCDEFAB`和`unmasked_id = masked_id ^ 0xABCDEFAB`.

其次，您链接的文章*高度*可疑。我不会相信它。首先，CRC32 是一种单向散列函数：（通常）不可能获取 CRC32 散列并取回用于创建该散列的字符串。您会注意到，他没有向您展示如何在`Customer`给定的 CRC32 中查找他们的`pk`. 其次，文章中的代码甚至没有意义。该`zlib.crc32`函数需要一个字节字符串，而`Customer.id`将是一个整数。

第三，如果你想为 URL 使用 slug 时要小心：如果 slug 改变，你的 URL 也会改变。这可能没问题，但这是您需要考虑的事情。

# java - Hibernate/JPA/GlassFish/Netbeans 在哪里存储数据？

> ID：10559938
> 
> 赞同：2
> 
> 时间：2012-05-11T23:56:17.727
> 
> 标签：java, hibernate, postgresql, jakarta-ee, jpa

我正在学习 Java EE 6，我从基本教程开始，试图真正理解所有的基础设施并尝试使用它。

所以我做了一个关于使用 JPA的基本教程（[这个）。](http://www.objectdb.com/tutorial/jpa/netbeans)唯一的区别是我更改了 Hibernate 的 ObjectDB 实现。

它非常简单，它有一个Entity、一个DAO Session Bean、一个Servlet 和一个JSP。它所做的唯一一件事就是您注册名称并向您显示名称。我将 Hibernate 配置为使用 postgres 数据库，并在 persistence.xml 文件中放入以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
  <persistence-unit name="TutorialGuestBook1PU" transaction-type="JTA">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>jdbc/__default</jta-data-source>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <properties>
      <property name="hibernate.hbm2ddl.auto" value="update"/>
    </properties>
  </persistence-unit>
</persistence> 
```

一切正常，但我看不到使用示例应用程序保存的信息保存在哪里。我知道它一定在某个地方，但我查询了 postgres 数据库，但我找不到它。

信息应该在哪里？是关于默认数据源或类似的东西吗？谁能点亮我？

提前致谢。

此致，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T00:00:07.263

这是我在搜索“GlassFish 默认数据源”时发现的，第一次点击：

[http://docs.oracle.com/cd/E18930_01/html/821-2424/gksmw.html](http://docs.oracle.com/cd/E18930_01/html/821-2424/gksmw.html)

> Java DB 数据库预`jdbc/__default`配置了 Embedded GlassFish Server。当应用程序部署在使用 Java Persistence 但未指定数据源的 Embedded GlassFish Server 中时使用它。Embedded GlassFish Server 使用在 Embedded GlassFish Server 停止时销毁的临时域中创建的嵌入式 Java DB 数据库。

IIRC 在非嵌入式上是一样的，但有一段时间没有检查过。不过，搜索很简单。

# c# - 如何向桌面应用程序发送推送通知

> ID：10559940
> 
> 赞同：3
> 
> 时间：2012-05-11T23:56:46.033
> 
> 标签：c#

我有一个驻留在系统托盘中的应用程序，而不是标准的“轮询”方法（以 X 秒间隔检查服务器是否有更新）我希望使用推送通知系统。因此，当有更新时，所有客户端都会收到一条消息，他们将完成他们的任务。网络服务器将是带有 Apache 和 PHP 的 Debian。

我的目标平台是 .NET 3.5，那该怎么做呢？将`Observer Design Pattern`不起作用（由于它是 .NET 4.0 或更高版本）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T00:30:44.413

您必须创建两个接口及其派生的具体类。您的服务将创建 IObservable、IObserver 和 ApplicationErrorState。

您的客户端将创建类并从 IObserver 派生 ErrorMessageSync。

这是我的示例，它显示错误并使用 .Net 3.5 创建。

**PS你也可以使用委托**

```
/// It will store observers and will push the message
public interface IErrorObservable
{
  void Attach(IErrorObserver observer);

  void Detach(IErrorObserver observer);

  void Notify();
}

public interface IErrorObserver
{
  void Update(string message);
}

///It is concrete class to push message
public sealed class ApplicationErrorState : IErrorObservable
{
  private List<IErrorObserver> _observers = new List<IErrorObserver>();

  ///constructor
  public ApplicationErrorState()
  {
  }

  public void Attach(IErrorObserver observer)
  {
     _observers.Add(observer);
  }

  public void Detach(IErrorObserver observer)
  {
     _observers.Remove(observer);
  }

  public void Notify()
  {
     foreach (IErrorObserver observer in _observers)
     {
        observer.Update(/*Logic*/);
     }
  }

  public void SetError()
  {
     Notify();
  }

  ///COncrete subject 
  private class ErrorMessageSync : IErrorObserver
  {
     private MyClass _parent;

     public ErrorMessageSync(MyClass parent)
     {
        _parent = parent;
     }

     public void Update(string message)
     {
            //This work will be done
     }
  } 
```

这是这种方法的 UML。

![检查这个 UML 图](../Images/c89789538f9296a4b480d8232106dea8.png)

# xcode - MAS：代码签名身份私钥

> ID：10559942
> 
> 赞同：13
> 
> 时间：2012-05-11T23:57:44.380
> 
> 标签：xcode, code-signing

我已经从开发门户中删除了所有开发和安装程序证书，创建了一个新的 CSR 并生成了新的应用程序和安装程序证书。

现在我即将将该应用程序分发到 MAS，并且不断出现此错误：

```
"Name" is a valid identity. However, the private key for the associated package
identity "Name" is not installed on this Mac.

Developer Profiles from a different Mac can be imported. 
```

这让我感到困惑，因为私钥在系统上，没有它们我怎么能生成证书？

![在此处输入图像描述](../Images/f43ee1676d55bb7bf8027207d5526723.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-12T02:27:12.437

仔细检查您已删除所有旧证书，KeyChain 应用程序中有一个菜单项可显示所有过期证书。我扔掉了所有过期的证书，事情开始起作用了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T09:20:31.683

得到它的工作：

*   在我的 Mac 上创建了一个新用户帐户
*   在那里克隆了回购
*   从开发门户中删除了所有配置文件和证书
*   让 Xcode 为您生成所有证书
*   上传作品！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-29T20:40:35.337

问题是 Mac 安装程序分发证书。

修复所有问题并消除所有麻烦的最简单方法只需转到 Xcode->Window->Organizer->Devices 然后在右下角按刷新并使用您的帐户登录... xcode 将生成并下载所有所需的证书和配置文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-24T13:12:05.007

我按照说明从钥匙串中删除了所有过期的证书，并刷新了管理器中的配置文件列表。在我重新启动 Xcode 后，错误才消失。

# ruby-on-rails - 如何在 Rails 3 中禁用 XML 解析

> ID：10559944
> 
> 赞同：5
> 
> 时间：2012-05-11T23:58:23.747
> 
> 标签：ruby-on-rails, ruby

我想禁用 HTTP 参数的自动 XML 解析。但我发现只有 Rails 2.x 的命令，它们都不适用于 3.0：

```
config.action_controller.param_parsers.delete Mime::XML (application.rb)
ActionController::Base.param_parsers.delete Mime::XML 
```

Rails 3.0 中的等价物是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-09T17:15:54.267

根据[CVE-2013-0156](https://groups.google.com/forum/#!topic/rubyonrails-security/61bkgvnSGTQ/discussion)的最新安全公告， 您可以将其用于 Rails 3.0。3.1 和 3.2

```
ActionDispatch::ParamsParser::DEFAULT_PARSERS.delete(Mime::XML) 
```

# css - CSS垂直和水平对齐div内的跨度？

> ID：10559947
> 
> 赞同：6
> 
> 时间：2012-05-11T23:58:39.690
> 
> 标签：css, alignment

请看这个jsfiddle：http: [//jsfiddle.net/xMAKq/20/](http://jsfiddle.net/xMAKq/20/)

我怎样才能使左列文本居中，如下所示：

![在此处输入图像描述](../Images/0df1eab525e770b148a2449a5d207b98.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-12T00:19:06.280

您想使用`text-align: center`和`vertical-align: middle`css 属性。

查看[示例](http://jsfiddle.net/eeWFz/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-12T00:09:50.163

您可以尝试使用`display`和表值（`table-row`和`table-cell`），然后使用`vertical-align: middle`，如[http://jsfiddle.net/frozenkoi/xMAKq/22/](http://jsfiddle.net/frozenkoi/xMAKq/22/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T00:05:24.267

添加文本对齐中心...见[http://jsfiddle.net/jEKsK/1/](http://jsfiddle.net/jEKsK/1/)

# css - 意外的 z-index 堆叠行为

> ID：10559950
> 
> 赞同：1
> 
> 时间：2012-05-11T23:59:21.943
> 
> 标签：css, position, z-index

基本上，我试图`#page_container`在我的网站上放置重叠角，以便看起来图像与页面重叠。

现场示例：http: [//jsfiddle.net/xBwQp/15/](http://jsfiddle.net/xBwQp/15/)

**HTML：**

```
<div id="page_container">
    <div id="banner_wrapper">
        <img id="banner_image" src="http://placehold.it/350x150" />
        <div class="triangle-l"></div>
        <div class="triangle-r"></div>        
    </div>
</div> 
```

**CSS：**

```
#page_container {
    background: red;
    width: 400px;
    position: relative;
    z-index: 10;
}

#banner_wrapper {
  position: relative;
}

#banner_image {
  position: relative;
}

.triangle-l {
  border-color: transparent green transparent transparent;
  border-style: solid;
  border-width: 15px;
  height: 0px;
  width: 0px;
  position: absolute;
  right: 0px;
  top: 0px;
  z-index: 5;
}

.triangle-r {
  border-color: transparent transparent transparent blue;
  border-style: solid;
  border-width: 15px;
  height: 0px;
  width: 0px;
  position: absolute;
  right: 0px;
  top: 0px;
  z-index: 5;
} 
```

您可以看到三角形`.triangle-l`和`.triangle-r`明显低于`z-index:5`，`#page_container` `z-index:10`但它们仍然出现在 上方`#page_container`。

我已经能够通过设置来实现我想要的结果，但是`.triangle-l`这仅适用于 FF、Opera 和 Webkit。不支持IE。`.triangle-r``z-index:-1`

我相信这与堆叠上下文有关。但是，我不确定如何通过跨浏览器兼容性来实现预期的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T01:35:23.540

你是绝对正确的 - 它是关于堆叠上下文。

每当您将 z-index 放在元素上时，您都会创建一个新上下文，因此因为三角形是 #page_container 的后代，它们将属于 #page_container 的堆叠上下文，无论您为三角形，它们仅在此上下文中有意义，您将无法将它们向后移动到此容器后面。

在此处详细阅读：[https ://developer.mozilla.org/en/CSS/Understanding_z-index/The_stacking_context](https://developer.mozilla.org/en/CSS/Understanding_z-index/The_stacking_context)

可能的解决方案是；

*   将元素移出 html 结构中的容器（然后使用 css 将它们放置在您想要的位置）
*   从容器中删除 z-index 并将三角形设置为 z-index -1 以将它们移动到文档本身下方

# authentication - 如何使用本地数据用户运行 squid3？

> ID：10559954
> 
> 赞同：0
> 
> 时间：2012-05-11T23:59:31.500
> 
> 标签：authentication, squid

我想运行 squid3 并强制用户再次验证本地和简单的数据库用户传递文件。可以是系统的用户通行证文件或简单的 .txt 文件，哪个更容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T14:52:25.830

这是设置具有`htdigest`身份验证的 Squid 3 服务器的更全面的指南：http: [//dabase.com/blog/Minimal_squid3_proxy_configuration/](http://dabase.com/blog/Minimal_squid3_proxy_configuration/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T16:14:35.727

使用

> /usr/lib/squid3/digest_pw_auth

鱿鱼安装工作附带的助手。

> /usr/bin/htdigest

可用于创建用户密码文件。

# objective-c - XCode 4.2 中的 STAssertThrowsSpecificNamed 和代码覆盖率

> ID：10559957
> 
> 赞同：0
> 
> 时间：2012-05-12T00:00:08.133
> 
> 标签：objective-c, xcode, unit-testing, exception-handling

我对 XCode 4.2 有一个奇怪的问题。最近我决定为我的项目添加代码覆盖支持，该项目有一个名为`SomeClass`with的类，该类`someMethod`会引发异常：

```
@interface SomeClass : NSObject

- (void)someMethod;

@end

@implementation SomeClass

- (void)someMethod {  
  [NSException raise:NSInternalInconsistencyException format:@"Some reason..."];
}

@end 
```

该类通过`SomeClassTests`位于具有以下方法的测试项目中进行测试：

```
- (void)testSomeMethod {
   SomeClass *sClass = [[SomeClass alloc] init];

   STAssertThrowsSpecificNamed([sClass someMethod], NSException, NSInternalInconsistencyException, @"Some description...");
} 
```

到目前为止一切顺利 - 测试通过。[为了支持代码覆盖，我必须根据这个源](http://code.google.com/p/coverstory/wiki/UsingCoverstory)打开“仪器程序流程”和“生成测试覆盖文件”构建设置。但是当我打开“仪器程序流程”时，测试失败并出现以下错误：`"raised Some reason... (Expected exception:NSException)"` 所有其他测试都运行良好。这种行为的原因可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T15:40:40.327

我只是通过升级到最新的 xcode 来解决这个问题。

# mongodb - 在 MongoDb 中，当仅更新文档的 2 个字段时，进行常规更新还是原子更新更快？

> ID：10559958
> 
> 赞同：1
> 
> 时间：2012-05-12T00:00:25.407
> 
> 标签：mongodb, database

在 MongoDb 中，如果我只需要更新具有 10-20 列的文档的 2 个字段，那么定期更新整个文档还是对这两个字段进行原子更新（$set）会更高效吗？

如果只更新几个字段，我应该总是更喜欢进行原子更新吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T11:21:57.803

根据您提供的有限信息， $set 可能会更有效，而不是重写整个文档。

但是要小心增长文档，因为如果它超出其原始范围，则需要移动它 - 当然不是最有效的操作。更多信息在这里：

[http://www.mongodb.org/display/DOCS/Padding+Factor](http://www.mongodb.org/display/DOCS/Padding+Factor)

通常，最好的做法是测试并查看对您最有意义的内容以及对您的数据集和应用程序最有效的内容

# backbone.js - 何时是在 Backbone js 中获取集合的合适时间？

> ID：10559960
> 
> 赞同：5
> 
> 时间：2012-05-12T00:01:02.897
> 
> 标签：backbone.js, backbone-views

所以我正在开发一个主干应用程序，并尝试使用 require.js 尽可能多地模块化事物。 [这](http://backbonetutorials.com/organizing-backbone-using-modules/)一直是我的向导。

我无法让我的视图始终获取我的收藏。如果我从基本 url ( ) 访问我的应用程序`myapp.com/`，并转到我的视图的路线，则会获取该集合。如果我不去视图，而是从 访问它`myapp.com/#/campaigns`，则不会获取集合。

这是一些相关的代码。

**路由器.js**

```
 define([
  'jQuery',
  'Underscore',
  'Backbone',
  'views/home/main',
  'views/campaigns/list'
], function($, _, Backbone, mainHomeView, campaignListView ){
  var AppRouter = Backbone.Router.extend({
    routes: {
      // Define some URL routes
      'campaigns': 'showCampaigns',

      // Default
      '*actions': 'defaultAction'
    },
    showCampaigns: function(){
      campaignListView.render();
    },
    defaultAction: function(actions){
      // We have no matching route, lets display the home page 
      //mainHomeView.render(); 
    }
  });

  var initialize = function(){
    var app_router = new AppRouter;
    Backbone.history.start();
  };
  return { 
    initialize: initialize
  };
}); 
```

**收藏/campaigns.js**

```
 define([
  'jQuery',
  'Underscore',
  'Backbone',
  'models/campaigns'
], function($, _, Backbone, campaignsModel){
  var campaignsCollection = Backbone.Collection.extend({
    model: campaignsModel,
    url: '/campaigns',
    initialize: function(){
    }

  });
  return new campaignsCollection;
}); 
```

**意见/活动/list.js**

```
define([
  'jQuery',
  'Underscore',
  'Backbone',
  'collections/campaigns'
  ], function($, _, Backbone, campaignsCollection){
      var campaignListView = Backbone.View.extend({
        el:$('#container'),
        initialize:function(){
          this.collection = campaignsCollection;
          this.collection.fetch();
        },
        render: function(){
          var data = {
            campaigns: this.collection,
            _: _
          };
          $('#container').html('Campaigns length: '+data.campaigns.models.length);
        }
      });
      return new campaignListView;
  }); 
```

关于我做错了什么的任何想法？我相信这与调用视图`this.collection.fetch()`的`initalize`功能有关。如果这是问题，我应该把它放在`fetch()`哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T07:40:15.327

您的代码中的问题是您`campaignListView`在初始化时获取集合并且它只初始化一次。当您第二次更改时，实际上从路由器调用的方法不会调用您的campaignListView方法`render`。`initialize``url`

你有两个选择：

### 1.返回类而不是你的campaignListView的实例并在路由器中初始化它：

```
// in your router code
showCampaigns: function(){
    var campaignListViewInstance = new campaignListView(); // don't forget the brackets after your initialize function
    campaignListViewInstance.render();
},

// in your campaignListView code :
return campaignListView; // without "new" 
```

这将在每次路由器被击中时初始化代码。

### 2\. 将你的 fetch 放在 render 方法中

```
// in your campaignListView code :
initialize:function(){
    this.collection = campaignsCollection;
},
render: function(){
    this.collection.fetch({success: function(collection) {
        var data = {
            campaigns: collection,
            _: _
        };
        $('#container').html('Campaigns length: '+data.campaigns.models.length);
    }); // this will be fetched everytime you render and also it has success callback
} 
```

另请注意，您应该在末尾用括号替换所有实例创建函数

```
return new campaignListView; --> return new campaignListView();
return new campaignsCollection; --> return new campaignsCollection(); 
```

您将面临的另一个问题是`fetch`. 您应该使用集合的成功或事件驱动渲染，因为`fetch`在后台工作，并且当您在调用后立即调用 render 时将没有数据`fetch`。

+1 为您的 AMD 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T00:08:15.163

我真的应该更新教程，但最好不要返回实例化模块。也许尝试检查[http://backboneboilerplate.com](http://backboneboilerplate.com)

# entity-framework - Entity Framework Code First 中的 IDisposable 实体

> ID：10559964
> 
> 赞同：0
> 
> 时间：2012-05-12T00:02:23.113
> 
> 标签：entity-framework, design-patterns, database-design, ef-code-first

我的业务逻辑和核心实体是紧密耦合的。

*   例如，一个名为 Session 的对象是一个数据库实体，但从字面意义上来说，它是一个真实的 Session，在此期间会记录事件。
*   此 Session 对象还具有 [NotMapped] 对象和非托管资源的句柄。
*   Session 对象也实现了 IDisposable。
*   我的项目中有很多实体具有上述特征。

这听起来像是一场灾难。问题是在这里采取什么方法。

我期待答案指向设计模式或架构，但请包含一个非常简短的代码示例来说明您的观点，而不仅仅是提议的解决方案的名称。

到目前为止，我所想到的是将每个实体作为业务对象派生出来，并使用代码生成从一种类型转换为另一种类型。由于这是一个客户端/服务器应用程序，我希望能够在我的桌面应用程序中按原样使用实体关系集，尽管它是派生的。

不知道如何以可持续的方式实现这一目标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T12:53:55.313

这不是关于设计模式，而是关于一次性实体的所有权。谁拥有实体？业主负责处置。那是您的代码/设计直接定义的东西。

EF 上下文本身是一次性的 - 您可以覆盖它的`Dispose`操作并强制它处理所有附加的实体，但这很可能是您不想做的事情，因为上下文很可能不是实体的所有者。从上下文请求实体或请求实体持久性的代码应被视为负责处置的所有者。

# android - Android - 如何将 ant 版本用于签名的私钥附加到 GNOME 密钥环？

> ID：10559966
> 
> 赞同：3
> 
> 时间：2012-05-12T00:02:52.100
> 
> 标签：android, keystore, gnome-keyring-daemon

显然，Java 使用与 gnome-keyring/GPG 不同的签名格式。Gnome Keyring 使用[PKCS #11](https://en.wikipedia.org/wiki/PKCS11)，而 Java 使用[PKCS #12](https://en.wikipedia.org/wiki/PKCS12)。我不喜欢让 .keystore 文件四处飘荡的想法，所以我想使用 Gnome Keyring / Seahorse 来轻松集中管理我的所有密钥。这一点尤其重要，因为 Android 开发人员需要将他们的密钥安全保存 25 年以上！

如何将 Java 密钥库转换/附加到我的密钥环，以便在运行时`ant release`可以使用 GNOME 密钥环输入密码？

# php - 函数装饰器（Python）类似 PHP 中的行为

> ID：10559967
> 
> 赞同：1
> 
> 时间：2012-05-12T00:02:57.953
> 
> 标签：php, python, reflection

> **可能重复：**
> [python 装饰器的 PHP 等效项？](https://stackoverflow.com/questions/1425303/php-equivalent-for-a-python-decorator)

我想在 PHP 中实现与 Python 装饰器相同的行为。

所以不要像这样写我的课：

```
class MyClass
{
    public function myFunc($param1, $param2, $param3)
    {
        $param1 = $param1 * 2;
        $param1 = $param1 * 2;
        $param1 = $param1 * 2;
        echo $param1.$param2.$param3;
    }
} 
```

我想这样做：

```
class MyClass
{
    @some_magic_multiplier_decorator
    public function myFunc($param1, $param2, $param3)
    {
        echo $param1.$param2.$param3;
    }
} 
```

两个班级都做同样的事情。

这在PHP中可能吗？

谢谢

# winapi - MFC CLisCtrl：当用户对列重新排序时，我如何得到通知？

> ID：10559970
> 
> 赞同：0
> 
> 时间：2012-05-12T00:03:29.387
> 
> 标签：winapi, visual-c++, mfc

我添加了 LVS_EX_HEADERDRAGDROP 样式，它允许用户拖动列：

```
myListControl_.SetView(LVS_REPORT);
myListControl_.SetExtendedStyle(LVS_EX_HEADERDRAGDROP); 
```

这工作正常。但是，当用户对列重新排序时，我如何获得通知，以便我可以保存新的排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T03:04:17.733

```
ON_NOTIFY_EX(HDN_ENDDRAG, 0, OnHeaderEndDragMethod) 
```

[Header_GetOrderArray](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775399%28v=vs.85%29.aspx)

# python - Objective-C gzipped NSData 到 Python gzipped 字符串？

> ID：10559971
> 
> 赞同：1
> 
> 时间：2012-05-12T00:03:38.770
> 
> 标签：python, objective-c, nsstring, gzip, nsdata

我正在使用[+[NSData gtm_dataByGzippingData:]](http://code.google.com/p/google-toolbox-for-mac/source/browse/trunk/Foundation/GTMNSData%2Bzlib.h?r=517#40)对`+[NSJSONSerialization dataWithJSONObject:options:error:]`.

如何将此 gzipped 转换`NSData`为可以作为参数发送到 Python 服务器的字符串，以便服务器可以使用[zlib.decompress()](http://docs.python.org/library/zlib.html#zlib.decompress)对其进行解压缩？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T03:56:33.690

在将 gzip 压缩文件发送到 Python 服务器之前，请使用类似[`-[NSData base64EncodedString]`](https://github.com/venmo/venmo-ios-sdk/blob/master/Venmo/Private/VenmoBase64.m#L24-53)base64 编码的方法。`NSData`

然后，Python 服务器可以对其进行 base64 解码，然后像这样解压缩：

```
contacts_data = zlib.decompress(base64.b64decode(contacts_base64), 16) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T03:59:31.770

正如您在问题中引用的头文件中所说，deflate 不是 gzip。Gzip 是一种文件结构，而 zlib 更像是一种压缩流。

首先，我建议您更改代码以使用...

```
+ (NSData *)gtm_dataByDeflatingData:(NSData *)data; 
```

所以，现在你有了压缩数据。你如何将它发送到服务器？你是通过 HTTP 推送这个吗？它是具有直接套接字连接的自定义服务吗？您可以发送 8 位字节吗，您是否仅限于发送 7 位字节？...您在使用 NURLConnection 吗？...您是否尝试通过 HTTP 将（压缩）数据作为文件上传？

# cocos2d-iphone - PhysicsSprite 和 CCSprite 有什么区别？

> ID：10559977
> 
> 赞同：2
> 
> 时间：2012-05-12T00:04:23.270
> 
> 标签：cocos2d-iphone, physics, ccsprite

我是 Cocos2D 的新手，我意识到在 Cocos2d 更新之前编写的大部分代码都使用了 CCSprites。最近我意识到更新后很多更新的代码都在使用 PhysicsSprite。有什么区别？哪种情况会优先于另一种？或者如果有的话，一个比另一个有什么优势？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-12T08:52:17.683

PhysicsSprite 是一个 CCSprite，它使用物理体来控制精灵的运动（位置）和旋转。

根据您是从 Box2D 模板还是 Chipmunk 模板开始，PhysicsSprite 将具有 b2Body (Box2D) 或 cpBody/cpShape (Chipmunk) 作为实例变量。

如果您不打算使用物理，请使用 CCSprite。如果你这样做了，对那些代表物理对象的精灵使用 PhysicsSprite。

# html - 播放上传的视频或嵌入 youtube 视频

> ID：10559987
> 
> 赞同：0
> 
> 时间：2012-05-12T00:06:33.610
> 
> 标签：html, video, youtube

我正在创建一个内容管理系统，允许内容管理器将视频上传到服务器。会有一个页面列表，每个页面上都有一个视频。然后内容观察者应该能够播放每个视频。

问题：我可以播放一些视频，但我无法让所有视频都播放，我不知道为什么。 **如何强制内容管理器仅上传有效的视频或转换无效的视频？** 我使用过嵌入、对象、iframe 和视频标签，但我无法让它们中的任何一个一直工作。这个链接是我试过的。[http://ww.w3schools.com/html/html_videos.asp](http://ww.w3schools.com/html/html_videos.asp)

替代解决方案：只需让内容管理器将视频上传到 youtube，然后将嵌入代码放入数据库中，并在需要时调用它。这可行，但是当您执行此操作时代码不会验证，这对 SEO 不利。此外，如果内容管理员没有正确执行此操作，他可能会为比赛做广告，因为视频可以在完成后显示指向其他视频的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T00:15:58.990

很难。在我们的 CMS 中，您需要验证内容，可能是在异步过程中，如果有问题则拒绝视频。最重要的是选择一组好的格式和编解码器（以及其他特性，如每秒帧数、音频比特率等），并使这个“合同”变得非常明确。带有 -i 选项的 ffmpeg 可以识别视频、扩展名、编解码器、长度、纵横比等。

您还尝试从任何格式转换为一种好的格式，例如 mp4 h264 with 360p。

# mysql - 存储过程中有 SLEEP() 的方法吗？

> ID：10559989
> 
> 赞同：23
> 
> 时间：2012-05-12T00:07:39.640
> 
> 标签：mysql, stored-procedures, sleep

我有一个*存储过程*，我想永远运行，但在循环中休眠一秒钟。当它醒来时，它会轮询一个表以查看它是否应该做一些工作。工作只需要每分钟完成一次，因此无需担心投票表同时受到来自两个作者的更新的影响。

*在存储过程*`SLEEP()`中间隔的最佳方法是什么？实际上，如果它可以休眠 200 毫秒，那就太好了，但一秒钟也可以。

 ** * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-26T03:10:47.777

我遇到了同样的问题。谷歌搜索了很多之后，我发现我们可以使用

```
SELECT SLEEP(<seconds>); 
```

延迟我们的程序这么多秒。在你的情况下，使用

```
SELECT SLEEP(0.2); 
```

就好了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-09-01T08:33:15.783

您可以使用：

```
DO SLEEP(0.2); 
```

参考：[http ://dev.mysql.com/doc/refman/5.7/en/do.html](http://dev.mysql.com/doc/refman/5.7/en/do.html)

或者

```
SELECT SLEEP(0.2); 
```

参考：[http ://dev.mysql.com/doc/refman/5.7/en/miscellaneous-functions.html#function_sleep](http://dev.mysql.com/doc/refman/5.7/en/miscellaneous-functions.html#function_sleep)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-12-03T22:06:53.550

MySQL 有一个事件调度程序。[https://dev.mysql.com/doc/refman/5.6/en/events-overview.html](https://dev.mysql.com/doc/refman/5.6/en/events-overview.html)

样本：

```
CREATE EVENT performance_schema_snapshots.fill_events_statements_summary_by_digest_history1
  ON SCHEDULE -- every day at 6 am 
    EVERY 1 DAY
    STARTS TIMESTAMP(CURRENT_DATE) + INTERVAL 1 DAY + INTERVAL 14 HOUR
  DO
    -- take snapshot 
    CALL performance_schema_snapshots.events_statements_summary_by_digest_snapshot_reset (); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-12T00:13:36.510

你没有指定你正在使用哪个数据库，但通常实现你想要的方法不是拥有一个无限运行的存储过程，而是拥有一些外部组件——比如调度程序，或者 MSSQL 中的 SQL Server 代理——经常执行存储过程.*

# android - 如何使我的连接成为 AsyncTask 连接

> ID：10559991
> 
> 赞同：0
> 
> 时间：2012-05-12T00:07:59.290
> 
> 标签：android, multithreading, json, android-asynctask

**更新：我发现最简单的方法是使用[AQuery](http://code.google.com/p/android-query/)。**

我需要让我的 HttpPost 在另一个线程上获取 JSON 数据，但我不知道如何让它们一起工作。我查看了[无痛线程博客](http://android-developers.blogspot.com/2009/05/painless-threading.html)，但仍然无法正常工作。

以下是我尝试对其进行同步之前的原始代码。

这是我第一次尝试 AsyncTasking，所以请不要太苛刻。谢谢。

在我的 OnCreate 中：

```
 /**
     * Connecting to MySQL using PHP and Populate the ListView
     * ========================================================
     */
    mList = (ListView) findViewById(R.id.sidebar_list);

    /** - http post for the list - */
    try  //<--THIS TRY METHOD IS WHAT NEED TO BE ON A SEPERATE THREAD??
    {
    HttpClient httpClient = new DefaultHttpClient();
    HttpPost httpPost = new HttpPost("http://192.168.1.34/xxxx/xxxxx_list.php");

    List<NameValuePair> nameValue = new ArrayList<NameValuePair>();
    httpPost.setEntity(new UrlEncodedFormEntity(nameValue));

    HttpResponse httpResponse = httpClient.execute(httpPost);

    HttpEntity httpEntity = httpResponse.getEntity();

    is = httpEntity.getContent();

    } catch (Exception e)
    {
    // TODO handle e
    Log.e("log_tag", "Error in HTTP connect" + e.toString());
    Toast.makeText(this, "HTTP Connection Error : " + e.toString(), Toast.LENGTH_LONG).show();
    }

    // EVERYTHING BELOW HERE CAN BE ON THE UI THREAD???
    /**
     * Convert response to string------------------------------------
     * ----------------------
     * */
    try
    {
    BufferedReader BufR = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
    sb = new StringBuilder();
    sb.append(BufR.readLine() + "\n");

    String line = "0";
    while ((line = BufR.readLine()) != null)
    {
    sb.append(line + "\n");
    }
    is.close();
    result = sb.toString();
    } catch (Exception e)
    {
    // TODO handle e
    Log.e("log_tag", "Error in convert to String" + e.toString());
    }

    // paring data
    int q_id;
    String q_label;
    String q_title;
    String q_description;
    String q_gotoURL;

    try
    {
    jArray = new JSONArray(result);
    JSONObject json_data = null;
    for (int i = 0; i < jArray.length(); i++)
    {
    json_data = jArray.getJSONObject(i);
    q_id = json_data.getInt("_ID");
    q_label = json_data.getString("label");
    q_title = json_data.getString("title");
    q_description = json_data.getString("description");
    q_gotoURL = json_data.getString("gotoURL");
    // mList.add();
    }

    setupList();
    } catch (JSONException e1)
    {
    Toast.makeText(getBaseContext(), "No Data Found", Toast.LENGTH_LONG).show();
    } catch (ParseException e1)
    {
    e1.printStackTrace();
    }

    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T02:40:42.520

我认为你可以尝试这样的事情：

```
public class MyActivity extends Activity {

// paring data
int q_id;
String q_label;
String q_title;
String q_description;
String q_gotoURL;
Context context;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    mList = (ListView) findViewById(R.id.sidebar_list);
    context = getApplicationContext();
    new HttpTask().execute("http://192.168.1.34/xxxx/xxxxx_list.php");

}
private class HttpTask extends AsyncTask<String, Void, String> {

    protected String doInBackground(String... urls) {
        try {
            HttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost(urls[0]);

            List<NameValuePair> nameValue = new ArrayList<NameValuePair>();
            httpPost.setEntity(new UrlEncodedFormEntity(nameValue));

            HttpResponse httpResponse = httpClient.execute(httpPost);

            HttpEntity httpEntity = httpResponse.getEntity();

            is = httpEntity.getContent();

            // Get result
            BufferedReader BufR = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
            sb = new StringBuilder();
            sb.append(BufR.readLine() + "\n");

            String line = "0";
            while ((line = BufR.readLine()) != null) {
                sb.append(line + "\n");
            }
            is.close();
            result = sb.toString();

        } catch (Exception e) {
            Toast.makeText(context, "HTTP Connection Error : " + e.toString(), Toast.LENGTH_LONG).show();
            return null;
        }
    }

    protected void onPostExecute(String result) {
        try {
            if(result == null)
                throw new Exception("result is null");
            jArray = new JSONArray(result);
            JSONObject json_data = null;
            for (int i = 0; i < jArray.length(); i++) {
                json_data = jArray.getJSONObject(i);
                q_id = json_data.getInt("_ID");
                q_label = json_data.getString("label");
                q_title = json_data.getString("title");
                q_description = json_data.getString("description");
                q_gotoURL = json_data.getString("gotoURL");
                // mList.add();
            }
            //send message to handler to draw list
            drawListHandler.sendEmptyMessage(0);
        } catch (Exception e1) {
            Toast.makeText(context, e1.getMessage(), Toast.LENGTH_LONG).show();
        }
    }
}

Handler drawListHandler = new Handler(){
    /* (non-Javadoc)
     * @see android.os.Handler#handleMessage(android.os.Message)
     */
    @Override
    public void handleMessage(Message msg) {
        setupList();
    }
};
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T00:38:56.847

除了`setupList()`（假设更新了一些`ListView`）和之外`Toast`，其余的应该在`doInBackground()`. 您希望在主应用程序线程上尽可能少的代码。

# c++ - 仅从大型数据文件读取/写入所需的数据以最小化内存占用

> ID：10559994
> 
> 赞同：0
> 
> 时间：2012-05-12T00:08:30.240
> 
> 标签：c++, qt, large-files

我目前正在头脑风暴一个财务计划，该计划将处理（随着时间的推移）相当大量的数据。它将是一个 C++/Qt GUI 应用程序。

我认为在运行时将所有数据读入内存是不可能的，因为给定足够的数据，它可能会占用太多内存。

我试图想出一种方法来仅将我需要的内容读入内存，例如，如果我显示了一个帐户，则只有实际显示的数据（以及其他任何绝对必要的数据）。这样即使数据文件是 4gb 左右，内存占用也可以保持很小。

我想到了某种搜索功能，它会慢慢地逐行读取文件并找到一个“标签”或识别我想要的特定数据的东西，然后加载它，但考虑到这种情况理论上可能会在每次有 gui 更新时发生似乎是一个可怕的路要走。

本质上，我希望能够有效地定位文件中的特定数据，仅将其读取到内存中，并可能对其进行更改并将其写回，而无需每次都读取和写入整个文件。我不是一个经验丰富的程序员，我在谷歌上搜索想法并不是很成功。

编辑：我可能应该提到我打算使用 Qt 的花哨的 QDataStream 相关类来存储数据。换句话说，该文件可能是二进制文件，不容易像文本文件那样逐行搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T00:56:29.317

好的，根据您的评论。

从简单开始。暂时忘记你的财务申请，除了作为背景。非常适合您的文件系统的示例

一种数据类型，例如帐户。从固定宽度的列开始，为您提供固定宽度的记录。

一个文件为数据 另一个文件为帐号索引

做插入、更新和删除，你会学到很多东西。

例如。删除，您可以找到索引和数据，将它们移出并重建两个文件。

您可以在帐户记录上有一个内部字段，表明它已被删除，在数据中设置它，然后删除索引。后者也重写了整个文件。您可以将删除标志放在索引文件中...插入时是否要追加，是否要查找已删除的记录并重用该插槽？

您的索引是否只是账户和头寸的直接列表，或者想要对其进行哈希处理，请使用树。您可能会花费数周甚至数月的时间来单独查看索引策略。

总之学习愉快。帮助您解决未来的问题会很有趣。

# java - Array-List里面的构造函数作为参数之一，如何创建一个新对象？

> ID：10559996
> 
> 赞同：4
> 
> 时间：2012-05-12T00:08:33.943
> 
> 标签：java, constructor, arraylist

我遇到了一个将arrayList 作为参数之一的构造函数的问题。

```
public class ItemisedProductLine extends ProductLine{

public static ArrayList<String> serialNumbers;

public ItemisedProductLine(String productCode, double recRetPrice, double salePrice, int quantity, String description, ArrayList<String> SerialNumbers){
    super( productCode,  recRetPrice,  salePrice,  quantity,  description);
    this.serialNumbers = serialNumbers;
} 
```

}

现在在我的类 Inventory 中，我想实例化一个新的 ItemisedProductLine 并将序列号的 arryList 传递给构造函数

```
ItemisedProductLine item = new ItemisedProductLine("productCode", 2600, 2490, 2, "descrpition", new ArrayList<String>("1233456", "6789123")); 
```

这在Java中可能吗？这似乎不是一个常见的任务，没有找到任何例子。

作为替代方案，我可以使用通用数组而不是 Array-List 但由于大小未知，我无法初始化它

希望我不会忘记另一个括号:-)

最后一件事是错误是“没有找到合适的构造函数 ArraList<>”

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-12T00:10:18.703

你可以试试：

```
new ArrayList<String>(Arrays.asList("1233456", "6789123")) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-01T01:07:50.437

@Edwin 的回答很好，但您也可以放弃`ArrayList`构造函数以支持简单的演员表。`Arrays.asList`已经为您创建了一个`new ArrayList`。

`(ArrayList<String>) Arrays.asList("1233456", "6789123")`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-15T11:32:44.467

还有另一种使用***[Java 8 Stream API](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html)***的方法。
您可以创建对象流并将它们收集为 List （或 Set 或任何您可以构建[自己的收集器的](https://www.google.gr/webhp?sourceid=chrome-instant&ion=1&espv=2&es_th=1&ie=UTF-8#q=Java8+custom+Collector+tutorial)原因）。

```
Stream.of(
        new MyClassConstructor("supplierSerialNo", "supplierSerialNo", String.class),
        new MyClassConstructor("title", "title", String.class),
        new MyClassConstructor("kind", "kind", String.class))
.collect(Collectors.toList()) 
```

# ruby-on-rails - 将两个模型链接在一起时的未知属性

> ID：10559998
> 
> 赞同：1
> 
> 时间：2012-05-12T00:09:12.760
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, foreign-keys, relationship

我的应用程序的简要概述。

这是非常基本的，因为用户首先在一个页面上创建一个集合 A 客户端，然后使用另一个页面来创建和分配作业给用户。

我的客户模型和视图按预期工作，但我无法链接我的工作模型。

这是我的工作模型。

```
class Client < ActiveRecord::Base 
  has_and_belongs_to_many :jobs
end

class Job < ActiveRecord::Base
  has_and_belongs_to_many :clients
end 
```

这也是我的客户控制器。

```
class JobsController < ApplicationController

  def index
    @jobs = Job.find(:all)

    respond_to do |format|
      format.html # index.html.erb
      format.xml { render :xml => @job }
    end
  end

  def new
    @jobs = Job.new 

    respond_to do |format|
      format.html # index.html.erb
      format.xml { render :xml => @job }
    end
  end

  def create
    @jobs = Job.new(params[:job])
    respond_to do |format|
      if @jobs.save
        format.html { redirect_to @jobs, notice: 'Job was successfully created.' }
        format.json { render json: @jobs, status: :created, location: @jobs }
      else
        format.html { render action: "new" }
        format.json { render json: @jobs.errors, status: :unprocessable_entity }
      end
    end
  end

  def show
    @jobs = Job.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @jobs }
    end
  end
end 
```

在我的表单中，我有两个字段。一个是作业名称，另一个是数据库中列出的所有客户端的下拉列表。

但是，当填写此内容并按保存时，我会收到以下错误。

```
ActiveRecord::UnknownAttributeError in JobsController#create

**unknown attribute: client_id**

Application Trace | Framework Trace | Full Trace
app/controllers/jobs_controller.rb:22:in `new'
app/controllers/jobs_controller.rb:22:in `create'
Request

Parameters:

{"utf8"=>"✓",
 "authenticity_token"=>"0ZVYpM9vTgY+BI55Y9yJDwCJwrwSgGL9xjHq8dz5OBE=",
 "job"=>{"name"=>"Sample Monthly",
 "client_id"=>"1"},
 "commit"=>"Save Job"} 
```

我有一个连接表设置`clients_jobs`也称为..

```
class AddClientsJobsTable < ActiveRecord::Migration
  def up
    create_table :clients_jobs, :id => false do |t|
      t.belongs_to :job, :client
      t.integer :client_id
      t.integer :job_id
  end
end

  def down
    drop_table :clients_jobs
  end
end 
```

我想我需要声明`client_id`

某处，但这是我的第一个 Rails 应用程序，我不确定在哪里。

任何帮助将不胜感激。

编辑：这是我的工作表格。

```
<%= simple_form_for :job do |f| %>
  <%= f.input :name %>
  <%= select("job", "client_id", Client.all.collect {|c| [ c.name, c.id ] }, {:include_blank => 'None'})%>
  <%= f.button :submit %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T01:15:11.710

您的模型表明 job - client 是一个 habtm 关联，但您的表单实现就像 job 属于（一个）客户一样。如果您确实打算将工作分配给多个客户，那么您的 for 应该类似于：

```
<%= collection_select(:job, :client_ids, Client.all, :id, :name, {:include_blank => 'None'}, { :multiple => true }) %> 
```

注意复数“client_ids”并允许输入多个。

如果一项工作只属于一个用户，则不应使用 has_and_belongs_to_many :clients。