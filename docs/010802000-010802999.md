# StackOverflow 问答 10802000-10802999

# python - 为什么 deepcopy 不创建对 lambda 函数的新引用？

> ID：10802002
> 
> 赞同：14
> 
> 时间：2012-05-29T15:17:36.570
> 
> 标签：python

在python中发现了这个奇怪的：

```
class SomeClass():
    def __init__(self):
        pass

a = [SomeClass()]
b = copy.deepcopy(a) 
```

输出：

```
>>> a
[<__main__.Some instance at 0x10051b1b8>]
>>> b
[<__main__.Some instance at 0x10051b092>] 
```

这和预期的一样——deepcopy`SomeClass()`为 b 创建了新对象。

但如果，

```
f = lambda x:x+1
a = [f]
b = copy.deepcopy(a) 
```

我得到：

```
>>> a
[<function <lambda> at 0x10056e410>]
>>> b
[<function <lambda> at 0x10056e410>] 
```

为什么 deepcopy 在第二种情况下不创建新的 lambda 实例？这是否意味着 lambda 函数是原子的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T15:30:01.270

这不仅适用于 lambda，而且更普遍地适用于没有状态的函数。

```
>>> def some_function(word): print word
>>> a = [some_function]
>>> a
[<function some_function at 0x1007026e0>]
>>> copy.deepcopy(a)
[<function some_function at 0x1007026e0>] 
```

因为函数不存储状态，所以 deepcopy 不会为它们创建新的引用。此处记录了与此问题（尽管不是完全相同的问题）类似的主题的有趣讨论：http: [//bugs.python.org/issue1515](http://bugs.python.org/issue1515)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T16:20:55.637

作为一些认为 lambda 不可变的人的旁注，请注意以下行为：

```
>>> a = lambda x: x + 1
>>> a(12)
13
>>> b = lambda x: x - 1
>>> b(12)
11
>>> a.__code__ = b.__code__
>>> a(12)
11
>>> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-29T15:22:52.187

查看[源代码中的第 222 和 223](http://hg.python.org/cpython/file/v2.7.3/Lib/copy.py#l222)行：

```
d[types.BuiltinFunctionType] = _deepcopy_atomic
d[types.FunctionType] = _deepcopy_atomic 
```

该模块认为它们是原子的，我不知道如何改变 lambda。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T17:40:15.347

我不知道 Python 的完整历史，但函数过去可能像字符串和元组一样不可变，因此最初的`deepcopy`行为是完全合理的。

此外，在实践中，大多数人更关心他们的数据对象被复制而不是他们的功能。制作函数副本的必要性`deepcopy`是一个明确的边缘案例，期望受该边缘案例影响的人推出他们自己的解决方案对我来说似乎完全没问题。

一种合理的方法是编写一个装饰器`@copyablefunc`，将函数包装在可调用对象（即具有`__call__()`方法的类）中，并且还定义例程要使用的方法`__copy__()`。`__deepcopy__()``deepcopy`

`copy.deepcopy`顺便说一句，也没有真正复制课程。

# image - 图片工具提示组件

> ID：10802008
> 
> 赞同：0
> 
> 时间：2012-05-29T15:17:59.163
> 
> 标签：image, apache-flex, tooltip

我正在关注这个关于如何在工具提示上放置图像的小教程。

[http://flexscript.wordpress.com/2008/08/18/flex-image-tooltip-component/](http://flexscript.wordpress.com/2008/08/18/flex-image-tooltip-component/)

我完全按照这个例子，但我有一个运行时错误：

```
ReferenceError: Error #1069: Property bitmapData not found on SWFLoaderStyleembed_css_Assets_swf__brokenImage_1882983457  and there is no default value.
at be.rtbf.radio.cockpit.commons.view::ExtendedToolTip/set imageTip()[C:\projets\cockpitRadio\trunk\flex\trunk\cockpit-commons-flex\src\main\flex\be\rtbf\radio\cockpit\commons\view\ExtendedToolTip.as:25]
at be.rtbf.radio.cockpit.onAir.module.view::RadioOnAir/createToolTip()[ 
```

这是**ExtendedToolTip.as**中的代码：

```
public class **ExtendedToolTip** extends VBox implements IToolTip {
    private static var MAX_WIDTH:Number = 500;
    private static var MAX_HEIGHT:Number = 500;
    private var image:Bitmap = new Bitmap();
    private var lbl:Label;
    private var imageHolder:Image;
    private var _tipText:String;

    public function set imageTip(img:*) : void {
        image.bitmapData
        if (img is Class) {
    **-->Line 25**      imageHolder.source = new img().bitmapData;
        }
        if (img as String) {
            imageHolder.load(img);
        }
    } 
```

方法调用：

```
private function createToolTip(tip:String) : ExtendedToolTip {
            var imageToolTip:ExtendedToolTip = new ExtendedToolTip();
            imageToolTip.imageTip = this.visual.source;
            imageToolTip.tipText = tip;
            return imageToolTip;
        }`enter code here` 
```

有什么建议可以避免这个运行时错误吗？

# scheme - 如何获取库导出的所有符号的列表？

> ID：10802010
> 
> 赞同：0
> 
> 时间：2012-05-29T15:18:06.093
> 
> 标签：scheme, r6rs

有没有一种方法可以获取库导出的所有方法的列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:17:51.243

没有便携的方法可以做到这一点。不同的方案实现可以提供一种方法。

# iphone - 如何从 UIImage 中获取红色通道的平均值

> ID：10802011
> 
> 赞同：2
> 
> 时间：2012-05-29T15:18:08.617
> 
> 标签：iphone, objective-c, uiimage, rgb, pixel

如何从 UIImage 中获取红色通道的平均值。

使用此代码，我可以找出像素的红色通道值（240,160）

```
CFDataRef pixelData = CGDataProviderCopyData(CGImageGetDataProvider(image.CGImage));
const UInt8* data = CFDataGetBytePtr(pixelData);

        int pixelInfo = ((image.size.width * 240) + 160) * 4; // The image is png

        UInt8 red = data[pixelInfo]; 
```

我感兴趣的是从整个图像的所有像素中找到红色通道值的平均值，或者只是图像的一个正方形部分。

如果不使用 320*480 计算，这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T18:21:49.510

你在做正确的事。如果您想要平均值，则必须在您正在测量的区域中添加所有红色通道的值。即使您使用过滤器来隔离红色通道，它也将本质上是相同的。在我看来，像你正在做的那样通过像素缓冲区是最快的方法。

您也许可以根据您拥有的其他信息进行优化（例如，它有多均匀），这样您就可以减小矩形的大小。或者，例如（或更多），您也许可以跳过所有其他像素。我想在照片上，这将产生可接受的平均值近似结果。它会减少您必须扫描的区域。

只是想给你额外的途径......

# c# - ZeroMQ C# HelloWorld 示例

> ID：10802012
> 
> 赞同：1
> 
> 时间：2012-05-29T15:18:18.667
> 
> 标签：c#, sockets, zeromq

出于好奇，我决定浏览一下 ZeroMQ 库中的几个示例。[具体来说，http://zguide.zeromq.org/cs: hwclient](http://zguide.zeromq.org/cs:hwclient)上的“Hello World”示例

据我所知，我已正确复制了示例中的代码，并且具有以下内容：

```
public class Program
{
    public static void Main(string[] args)
    {
        using(var context = new Context(1))
        {
            using(Socket requester = context.Socket(SocketType.REQ))
            {
                requester.Connect("tcp://localhost:5555");

                const string requestMessage = "Hello";
                const int requestsToSend = 10;

                for(int requestNumber = 0; requestNumber < requestsToSend;requestNumber++)
                {
                    Console.WriteLine("Sending Request {0}...", requestNumber);
                    requester.Send(requestMessage,Encoding.Unicode);

                    string reply = requester.Recv(Encoding.Unicode);
                    Console.WriteLine("Received Reply {0}: {1}", requestNumber, reply);
                }
            }
        }

        Console.ReadLine();

    }

} 
```

我遇到的问题是，一旦它到达下一行，程序就会停止并等待消息，而且它似乎永远不会收到它。

```
string reply = requester.Recv(Encoding.Unicode); 
```

程序赶上了这条线。我想这可能与冲突的 tcp 地址有关？不太确定，因为我对套接字级编程不太熟悉。

关于为什么这不起作用的任何想法？我已经搜索了 ZeroMQ 文档，但到目前为止还没有找到任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:24:38.593

请注意它是如何被称为“HWClient”的。也有一个 Hello World 服务器端。你应该先运行它。

# asp.net-mvc-3 - 如何在 ASP.NET MVC3 中对相关表进行排序

> ID：10802020
> 
> 赞同：0
> 
> 时间：2012-05-29T15:18:58.807
> 
> 标签：asp.net-mvc-3, linq

这是我的（简化的）代码：

**控制器**

```
var userQuery = from u in _db.Users
                where u.Username.ToLower().Contains(search.ToLower())
                    || u.FirstName.ToLower().Contains(search.ToLower())
                    || u.LastName.ToLower().Contains(search.ToLower())
                select u.FirmID;

var query = from f in _db.Firms
            where f.Name.ToLower().Contains(search.ToLower()) 
                || f.Keyword.ToLower().Contains(search.ToLower()) 
                    || f.KeywordList.ToLower().Contains(search.ToLower())
                    || userQuery.Contains(f.ID)
            select f;

// order by firm name
query = query.OrderBy(f => f.Name); 
```

**用户模型**

```
public class User
{
    [Key]
    public int ID { get; set; }

    public string Username { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public int FirmID { get; set; }
    [ForeignKey("FirmID")] 
    public virtual Firm Firm { get; set; }
} 
```

**公司模式**

```
public class Firm
{
    [Key]
    public int ID { get; set; }

    public string Keyword { get; set; }
    public string KeywordList { get; set; }
    public string Name { get; set; }

    public virtual ICollection<User> Users { get; set; }
} 
```

使用此代码，我得到与某个搜索字符串匹配的用户的公司列表。该列表按公司名称排序。我现在想做的，也是按用户姓氏排序。我怎样才能做到这一点？

现在：

*   公司
    *   用户 b
    *   用户 a
    *   用户 c
*   公司 b
    *   用户 z
    *   用户 d

期望：

*   公司
    *   用户 a
    *   用户 b
    *   用户 c
*   公司 b
    *   用户 d
    *   用户 z

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:07:46.497

像这样试过

```
query.OrderBy(f => f.Name).Select(aux => new 
{
   Firm = aux.Firm,
   Users = aux.Users.OrderBy( x => x.Username )
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T16:04:37.883

好吧，我终于找到了最适合我的解决方案：

```
query.OrderBy(f => f.Name)
     .ToList()
     .ForEach(f => f.Users = f.Users.OrderBy(u => u.LastName).ToList() ); 
```

这意味着，我不必创建匿名选择对象（如 Jorge 的回答），这使得模型在视图中更容易处理。

另一种解决方案可能是不在控制器中而是在视图中对用户进行排序。例如：

```
@foreach (var user in Model.Users.OrderBy(u => u.LastName)) {  } 
```

# heroku - 我在 Heroku（免费版）上的代码是公开的还是受保护的？

> ID：10802032
> 
> 赞同：-2
> 
> 时间：2012-05-29T15:19:39.080
> 
> 标签：heroku

我正在 Heroku 上运行测试应用程序（不要付费）。也许我错过了什么，但回答我：我的代码是私有的还是任何人都可以拉它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:26:34.667

你的代码是安全的，只有heroku的东西可以把它拉起来看看，而且它是免费的。您最好阅读他们的文档并接受他们的许可协议。

# android - 在谷歌地图上显示位置列表

> ID：10802040
> 
> 赞同：0
> 
> 时间：2012-05-29T15:20:45.293
> 
> 标签：android, google-maps

我在同一个屏幕上有一个地图视图和一个列表视图。一半是地图，另一半是列表视图。我有一个位置列表（即纬度和经度）。当我开始我的活动时，它应该加载地图上的所有位置，并且它应该指向我列表中的第一个位置，而其他位置不应该是可见的。每个列表视图项上都有一个按钮。当我点击列表视图项目上的任何按钮时，地图应该动画到该特定位置。屏幕顶部还有一个按钮可以查看所有位置，当我点击此按钮时，它应该在地图上显示列表中的所有位置。列表项的数量可能会有所不同。我该怎么做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T06:18:27.090

尝试做这些事情，例如单击 listView 的每个项目（按钮）在 mapView 上创建叠加层，只需使用 AnimateTo() 动画到使用 Point 方法转换位置（lat，lng）到指向的位置。您必须为每个位置（即当项目单击时）并将其添加到叠加列表。

但是这种方法无法通过单击按钮来显示所有位置，以覆盖您在 mapView 上创建的内容。

如果您为每个位置创建叠加层并将其添加到叠加层列表并尝试显示它可能工作正常，但首先绘制的位置可能不正确可见（尝试设置叠加层的透明度），而不是您可以搜索 Google api，它获取位置列表并绘制它们。

希望这个解释对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T06:02:02.400

由于您在加载它们之前知道位置，因此您可以编写代码以在侧边栏中显示列表。如果加载 KML 文件，则完全不同，需要自己解析文件才能获取其中的数据。我自己用字符串解析做过一次，但整个项目非常慢。我找到了[JAK](http://code.google.com/p/javaapiforkml/)，但它需要注册并且我没有使用它

# android - 如何获得所有可以运行的意图？

> ID：10802043
> 
> 赞同：1
> 
> 时间：2012-05-29T15:21:01.247
> 
> 标签：android

我已使用此代码来获取设置中的所有意图：

```
for (int i = 0; i < pi.size(); i++) {
            try {

                if (pi.get(i).activities != null) {
                    int k = pi.get(i).activities.length;
                    Log.d(tag, "" + k + "  " + pi.get(i).packageName);

                    if (pi.get(i).packageName.toLowerCase().endsWith(
                            ".settings")) {
                        for (int j = 0; j < pi.get(i).activities.length; j++) {

                            Log.d(tag, "" + k + "  "
                                    + pi.get(i).activities[j].name);
                        }
                    }
                }
            } catch (Exception e) {

                e.printStackTrace();
            }
        } 
```

但是其中一些可以使用 StartIntent 运行，而其中一些由于内部使用而不能运行，您有什么方法可以获得可以使用 StartIntent 运行的所有意图？

谢谢

# c++ - std::unique_ptr::get 有什么意义

> ID：10802046
> 
> 赞同：68
> 
> 时间：2012-05-29T15:21:05.123
> 
> 标签：c++, c++11, pointers, unique-ptr

首先不会`std::unique_ptr::get`破坏拥有 unique_ptr 的目的吗？我本来希望这个函数改变它的状态，所以它不再持有指针。std::unique_ptr::get 有实际有用的用途吗？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-05-29T17:23:28.697

`std::unique_ptr`安全地提供独特的所有权语义。然而，这并不排除对*非拥有*指针的需要。`std::shared_ptr`有一个非拥有的对应物，`std::weak_ptr`. 原始指针作为`std::unique_ptr`' 的非拥有对应物运行。

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2012-05-29T15:24:02.897

每次需要将原始指针传递给 C 函数时都使用它：

```
std::unique_ptr<char[]> buffer( new char[1024] );
// ... fill the buffer
int rc = ::write( fd, buffer.get(), len ); 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2012-05-29T16:47:45.280

我倾向于遵循的规则是：如果被调用者没有使用生命周期/所有权，请不要向它传递智能指针；而是传入原始 C++ 引用（首选）或原始指针。我发现将所有权的关注与使用的关注区分开来更清晰、更灵活。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2012-05-29T15:24:39.420

当你的双手被束缚并且你确实需要传递一个指向某物的指针时，`p.get()`读起来比`&*p`.

有一个函数可以更改状态，因此`unique_ptr`不再保存指针，并且该函数被命名为`release`. 这对于将所有权转移到其他不提供从`unique_ptr`. 任何其他使用都有泄漏资源的风险。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-29T15:23:04.720

当您需要调用 C API 或设计不佳的 C++ API 时，就会出现明显的情况。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-08-02T20:06:32.537

Herb Sutter 有一个很好的解释（大约 3:40） [https://www.youtube.com/watch?v=JfmTagWcqoE](https://www.youtube.com/watch?v=JfmTagWcqoE)

主要优点是唯一指针跟踪该指针有多少其他引用。仅在使用所有权时才使用唯一指针。当你想用那个指针对数据做一些事情时，你传递原始指针。

# iphone - UIImageView 和多线程

> ID：10802059
> 
> 赞同：1
> 
> 时间：2012-05-29T15:21:44.347
> 
> 标签：iphone, objective-c, ios, uiimageview

在[iOS 4 中的新增](http://developer.apple.com/library/ios/#releasenotes/General/WhatsNewIniOS/Articles/iPhoneOS4.html)功能中，提到`UIImage`如果在后台线程中完成绘图现在是安全的。但是，在使用 时`UIImageView`，在大多数情况下对图像属性进行简单分配：

```
imageView.image = [UIImage imageNamed:@"..."] 
```

出于性能原因，优先于绘图（因为`UIImageView`这样可以更好地利用 GPU）。

我的问题是：`imageView.image`如果在后台线程中完成分配是否安全？一般来说 UIKit 需要在主线程中完成工作，所以我很犹豫。

如果它不安全，那么在使用 时，`UIImage`利用非 UI 线程中绘图是安全的事实的最佳方法是`UIImageView`什么？

# asp.net-mvc-3 - 受保护的内部集合属性的模型绑定

> ID：10802061
> 
> 赞同：3
> 
> 时间：2012-05-29T15:21:47.853
> 
> 标签：asp.net-mvc-3, c#-4.0, properties, model-binding

在我的模型类中，我有多个“受保护的内部集”属性。一旦创建了这些属性，就不能对其进行修改。话虽如此，我很难创建允许在创建时设置这些属性的模型绑定器。为了能够只设置一次这些属性，最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:24:50.643

不幸的是，这不是您可以自动完成的。您必须为每种类型创建一个唯一的模型绑定器，然后使用构造函数参数创建对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T00:50:18.687

我使用自定义模型绑定器做到了这一点。我不仅有私有设置器，而且我的 MVC 操作的参数是一个接口，而且我没有无参数构造函数（三连胜！）；这些都不适用于默认模型绑定器。

在您的情况下，您只需为您的类型制作一个自定义模型绑定器。使用默认值创建您的类的新实例。然后只需使用反射来设置类的属性。反射方法不关心属性的可访问性。像这样的东西：

```
// assuming your class looks like this
public class MyClass
{
    public int MyInt { get; private set; }
    public string MyString { get; private set; }

    public MyClass(int myInt, string myString)
    {
        MyInt = myInt;
        MyString = myString;
    }
}

// model binder is like this
public class MyModelBinder : DefaultModelBinder
{
    protected override object CreateModel(ControllerContext controllerContext,
        ModelBindingContext bindingContext,
        Type modelType)
    {
        // initialize with default values, they will be overwritten
        MyClass myClass = new MyClass(default(int), default(string));
        // get the reflection info on the int property
        PropertyInfo intProperty = typeof(MyClass).GetProperty("MyInt");
        // get the int value from the request
        int myIntValue = int.Parse(bindingContext.ValueProvider
            .GetValue(intProperty.Name).AttemptedValue);
            // btw, attempted value is a string
        // set the property value, SetValue ignores accessibility modifiers
        intProperty.SetValue(myClass, myIntValue, null);
        // do the same stuff for MyString property
        PropertyInfo stringProperty = typeof(MyClass).GetProperty("MyString");
        string myStringValue = bindingContext.ValueProvider
            .GetValue(stringProperty.Name).AttemptedValue;
        stringProperty.SetValue(myClass, myStringValue, null);
        return myClass;
    }
}

// Your controller action is like this
public ActionResult MyAction([ModelBinder(typeof(MyModelBinder))]
                             MyClass myClass)
{
    ...
} 
```

我想你可以在不使用反射来设置它们的情况下将正确的值传递给构造函数：

```
 ...
        int myIntValue = int.Parse(bindingContext.ValueProvider
            .GetValue(intProperty.Name).AttemptedValue);
        string myStringValue = bindingContext.ValueProvider
            .GetValue(stringProperty.Name).AttemptedValue;
        MyClass myClass = new MyClass(myIntValue, myStringValue);
        ... 
```

但是如果您需要做更多事情，反射可以让您绕过访问修饰符限制（当然是出于有效的基础设施原因！:D）。在我的例子中，我不想为每个可以实现接口的类编写模型绑定器，所以我使用了更多的反射来匹配类，找到一个构造函数，将默认值传递给它，然后循环遍历每个属性类并从请求值中设置它。我有一个单独的方法可以在运行基于消息的操作之前验证消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T11:08:36.533

仅当尚未设置私有字段时，您是否可以保护设置方法设置私有字段？

```
public string PropertyName
{
  get
  {
     return this.privateField;
  }

  protected set
  {
     if (this.privateField == null)
     {
       this.privateField = value;
     }

  }
}

private string privateField; 
```

# ios - 缩放和平移/倾斜的捏合手势

> ID：10802065
> 
> 赞同：1
> 
> 时间：2012-05-29T15:21:52.860
> 
> 标签：ios, ios5, uigesturerecognizer, uipinchgesturerecognizer

我如何将其`UIPinchGestureRecognizer`用于多种用途？目前我正在使用它来放大/缩小我的 GLKView，但我想使用手势来移动（平移/倾斜），但同时能够缩放。我在 iOS 上的许多 CAD 和 3D 应用程序中都看到了这种行为。

捏合代码：

```
- (void)pinchDetected:(UIPinchGestureRecognizer *)pinchRecognizer
{
    NSLog (@"%@", @"Pinching");

    if (pinchRecognizer.state == UIGestureRecognizerStateBegan ||
        pinchRecognizer.state == UIGestureRecognizerStateChanged ||
        pinchRecognizer.state == UIGestureRecognizerStateEnded) {
        _zoom += (-1)*(logf(pinchRecognizer.scale) * 10.0f);
        pinchRecognizer.scale = 1.0;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:32:05.283

请参阅此示例以获取更多指导，因为此示例显示了您想要执行的操作，因为它提供了同时执行缩放、平移和倾斜操作所需的一切，请参阅[此](https://github.com/AalokParikh/pinch-and-uiguesture)

# php - 网站的 PayPal 集成选项

> ID：10802066
> 
> 赞同：0
> 
> 时间：2012-05-29T15:21:53.773
> 
> 标签：php, paypal, integration, payment

我的任务是将 PayPal 集成到一个正在开发的网站中。我很好奇是否有人可以告诉我满足我需求的最佳解决方案，因为那里似乎有很多选择。

该网站必须通过两种方式进行支付——首先，我们需要一个用于预订门票的静态支付系统。我已经在网站上设置了一个购物篮功能，因为它必须设置为只有部分价格是在线支付的，所以基本上我需要向一个不变的电子邮件地址单次付款。在此期间，我正在使用 IPN，这似乎有效。

其次，人们可以设置每月固定金额的订阅。我不确定使用 IPN 设置是否可行，我必须处理单笔付款，因为我似乎找不到任何文档来处理人们取消订阅、错过付款等的所有可能性。

所以我真的需要第二个方面的帮助，但如果有人有一个他们认为应该同时用于这两个方面的解决方案，那就太棒了，因为这显然会更干净。我以前从未将 PayPal 集成到网站中，所以欢迎大家帮忙！

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:34:15.427

IPN 也适用于订阅。

当用户订阅时，您将收到一个 txtype = subscr_signup 的 IPN 信号，其中包含大量信息，因此您知道您的用户已订阅。

当付款到达时，您将（在经常性期间）收到一个带有 txtype = subscr_payment 的 IPN 信号以及大量信息。

当用户通过他们的贝宝帐户取消订阅或重复付款失败两次（可以在您的商家帐户中设置）时，您会收到 subscr_cancel，这意味着您将不再收到钱。

然而，诀窍是这并不意味着订阅结束。

因为该贝宝会向您发送一个信号 subscr_eot，这意味着您必须停止向您的用户提供服务。（eot 代表期末）

例如，我每个月为音乐服务支付 30 美元，并在每月 3 日进行设置。

当用户设置订阅时，您会收到 subscr_signup + subscr_payment。

每个月的第三天，您会收到 subscr_payment（失败或成功信息）

我决定在每月 20 日通过贝宝停止订阅。

您将直接收到 subscr_cancel。

在我取消后的下个月 3 日，您将收到一个 subscr_eot。

希望完整的详细信息可以访问贝宝文档。

[https://cms.paypal.com/uk/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_admin_IPNReference#id091EB080EYK](https://cms.paypal.com/uk/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_admin_IPNReference#id091EB080EYK)

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:30:18.367

有大量的 Wordpress 或 Joomla 插件可以为您设置，包括通过贝宝订阅和单个项目。

我曾与 wp-ecommerse 和 cart66 合作解决这些问题。

使用框架的另一个好理由是因为它们总是在更新和保护站点，并允许我继续从事其他项目。

# bash - 在while循环中捕获信号和清理

> ID：10802076
> 
> 赞同：4
> 
> 时间：2012-05-29T15:22:24.067
> 
> 标签：bash

我有这个脚本：

```
FINISH=0;
trap 'FINISH=1' SIGINT

INTERVAL=100;

while true
do
    START=`date +%s`;
    php-cgi -f process.php;
    STOP=`date +%s`;
    ELAPSED=$(($STOP-$START));
    SLEEP=$(($INTERVAL-$ELAPSED));
    if [ $SLEEP -gt 0 ]
    then
        echo "sleeping for $SLEEP seconds";
        sleep $SLEEP;
    fi
    if [ $FINISH -eq 1 ]
    then
        echo "exit";
        break;
    fi
done 
```

但它不能像我想要的那样工作 - 我希望它只设置 FINISH=1 但它会杀死当前执行的命令（php-cgi 或睡眠） - 如何避免这种情况？其实我不希望它杀死 php-cgi ......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T18:49:52.620

这可能对你有用。

```
#!/bin/bash
trap 'exit' SIGINT

interval=100;

while true
do
    start=$(date +%s)
    nohup php-cgi -f process.php
    stop=$(date +%s)
    ((elapsed = stop - start))
    ((sleep = interval - elapsed))
    if (( sleep > 0 ))
    then
        echo "sleeping for $sleep seconds"
        sleep "$sleep"
    fi
done 
```

# android - 我应该将 zoomIn 放在 MapActivity 的哪个位置？

> ID：10802082
> 
> 赞同：1
> 
> 时间：2012-05-29T15:22:54.783
> 
> 标签：android, google-maps, map, zooming, loading

我正在编写一个 Android 应用程序，我想在地图加载后立即放大。我收到以下错误：

```
java.lang.IllegalArgumentException: width and height must be > 0 
```

这个[MapActivity - width and height must be > 0](https://stackoverflow.com/questions/9545482/mapactivity-width-and-height-must-be-0) question表明问题是 zoomIn() 方法在 onCreate() 方法中。但是当我把它放在 onResume() 方法中时，我得到了同样的错误。

我已经搜索了几个小时，但在[http://developer.android.com](http://developer.android.com)或其他任何地方都找不到任何关于它的信息……我也找不到获取地图加载时间点的方法. “MapLoadedListener”或类似的东西......

**编辑这是我的代码：**

```
public class AMap extends MapActivity{

private final String LOG_TAG = this.getClass().getSimpleName();
private Context mContext;
private Chronometer timer;
private TextView tvCountdown;
private RelativeLayout rl;
private MapView mapView;
private MapController mapController;
private List<Overlay> mapOverlays;
private PlayersOverlay playersOverlay;
private Drawable drawable;      
private Builder endDialog;
private ContextThemeWrapper ctw;
private Handler mHandler = new Handler();
private Player player = new Player();
private StartTask startTask;
private EndTask endTask;    
private MyDBAdapter mdba;
private Cursor playersCursor; 
private UpdateBroadcastReceiver r;  

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.map_view);
    mContext = AMap.this;

    // set map
    mapView = (MapView) findViewById(R.id.mapview);
    mapView.setBuiltInZoomControls(true);
    mapView.setFocusable(true);   

    // find the relative layout
    rl = (RelativeLayout) findViewById(R.id.rl);        

    // set the chronometer
    timer = (Chronometer) findViewById(R.id.tv_timer);
    timer.setBackgroundColor(Color.DKGRAY);

    // set the countdown textview
    tvCountdown = (TextView) findViewById(R.id.tv_countdown);

    // Open DB connection and get players Cursor
    mdba = new MyDBAdapter(mContext); 
    mdba.open();
    playersCursor = mdba.getGame();

    // Get this player's id and location
    Intent starter = this.getIntent();
    player.setId(starter.getIntExtra("id", 0));
    player.setLatitude(starter.getDoubleExtra("lat", 0));
    player.setLongitude(starter.getDoubleExtra("lon", 0));  

    // Set this player's location as map's center
    GeoPoint geoPoint = new GeoPoint((int) (player.getLatitude()*1E6), (int) (player.getLongitude()*1E6));      
    mapController = mapView.getController();
    mapController.setCenter(geoPoint);      
    mapController.setZoom(15);

    Log.d(LOG_TAG, "My playersCursor has "+playersCursor.getCount()+" rows");    
    // drawable is needed but not used
    drawable = this.getResources().getDrawable(R.drawable.ic_launcher);

    // set PlayersOverlay (locations and statuses)
    playersOverlay = new PlayersOverlay(player.getId(), playersCursor, drawable, this);  
    mapOverlays = mapView.getOverlays();
    mapOverlays.add(playersOverlay);  

    mHandler.postDelayed(mUpdateTimeTask, 100);        
}

private Runnable mUpdateTimeTask = new Runnable() {
   public void run() {
       int h = mapView.getLayoutParams().height;
       int w = mapView.getLayoutParams().width;
       Log.d(LOG_TAG, "w = "+w+" , h = "+h);         
       mHandler.postAtTime(this, SystemClock.elapsedRealtime() + 1000);
   }
};

 @Override
 public void onAttachedToWindow(){
        Log.d(LOG_TAG, "Attached to Window");
        int h = mapView.getLayoutParams().height;
        int w = mapView.getLayoutParams().width;
        Log.d(LOG_TAG, " Attached to window: w = "+w+" , h = "+h);
        //mapController.zoomInFixing(screenPoint.x, screenPoint.y);
 }

 public void onWindowFocusChanged(boolean hasFocus){
        Log.d(LOG_TAG, "Focus changed to: "+hasFocus);
        int h = mapView.getLayoutParams().height;
        int w = mapView.getLayoutParams().width;
        Log.d(LOG_TAG, " Window focus changed: w = "+w+" , h = "+h);
        //mapController.zoomInFixing(screenPoint.x, screenPoint.y);
 }

@Override
protected void onStart(){
    super.onStart();

    // Create and register the broadcast receiver for messages from service
    IntentFilter filter = new IntentFilter(AppConstants.iGAME_UPDATE);
    r = new UpdateBroadcastReceiver();
    registerReceiver(r, filter);     

    // Create the dialog for end of game
    ctw = new ContextThemeWrapper(mContext, android.R.style.Theme_Translucent_NoTitleBar_Fullscreen);
    endDialog = new AlertDialog.Builder(ctw);
    endDialog.setMessage("End of Game");
    endDialog.setCancelable(false);
    endDialog.setNeutralButton("OK", new OnClickListener(){

        @Override
        public void onClick(DialogInterface dialog, int which) {
            Intent highScores = new Intent(AMap.this, HighScores.class);
            startActivity(highScores);                      
            playersCursor.close();
            finish();               
        }

    });

}

@Override
protected void onStop() {       

    if(!playersCursor.isClosed())
        playersCursor.close();

    unregisterReceiver(r);
    mdba.close();       
    super.onStop();
}

@Override
protected boolean isRouteDisplayed() {
    return false;
}

// Receives signal from NetworkService that DB has been updated
public class UpdateBroadcastReceiver extends BroadcastReceiver {

    boolean startSignal, update, endSignal;

    @Override
    public void onReceive(Context context, Intent intent) {

        endSignal = intent.getBooleanExtra("endSignal", false);
        if(endSignal){
            Log.d(LOG_TAG, "Game Update BroadcastReceiver received End Signal");
            endTask = new EndTask();
            endTask.execute();  
            return;
        }

        update = intent.getBooleanExtra("update", false);
        if(update){
            Log.d(LOG_TAG, "Game Update BroadcastReceiver received game update");
            playersCursor.requery();
            mapView.invalidate();
            return;
        }

        startSignal = intent.getBooleanExtra("startSignal", false);
        if(startSignal){                
            Log.d(LOG_TAG, "Game Update BroadcastReceiver received Start Signal");
            startTask = new StartTask();
            startTask.execute();        
            return;
        }
    }
}

class StartTask extends AsyncTask<Void,Integer,Void>{

    private final ToneGenerator tg = new ToneGenerator(AudioManager.STREAM_NOTIFICATION, 100);
    private final long DELAY = 1200;

    @Override
    protected Void doInBackground(Void... params) {

        int i = 3;
        while(i>=0){

            publishProgress(i);
            try {
                Thread.sleep(DELAY);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            i--;
        }

        return null;
    }

    @Override
    protected void onProgressUpdate(Integer... progress){

        tg.startTone(ToneGenerator.TONE_PROP_PROMPT);
        tvCountdown.setText(""+progress[0]);
    }

    @Override
    protected void onPostExecute(Void result) {         
        rl.removeView(tvCountdown);
        timer.setBase(SystemClock.elapsedRealtime());
        timer.start();
        //enable screen touches
        playersOverlay.setGameStarted(true);
    }       
}

class EndTask extends AsyncTask<Void,Void,Void>{

    @Override
    protected void onPreExecute(){
        //disable screen touches
        playersOverlay.setEndOfGame(true);
        timer.stop();
    }

    @Override
    protected Void doInBackground(Void... params) {
        return null;
    }

    @Override
    protected void onPostExecute(Void result) {         
        try{
            endDialog.show();
        }catch(Exception e){
            Toast.makeText(mContext, "End of game", Toast.LENGTH_LONG);
            Intent highScores = new Intent(AMap.this, HighScores.class);
            startActivity(highScores);                      
            playersCursor.close();
            finish();
        }
        mHandler.removeCallbacks(mUpdateTimeTask);
    }
} 
```

}

**最后编辑：** 我最终使用了这段代码。我想反复放大，所以我使用了一个处理程序和一个可运行程序，它从 onWindowFocusChanged 开始每 1500 毫秒调用一次。MapView 的宽度和高度肯定是正值。OnAttachedToWindow 可能不起作用，因为它为宽度和高度返回 0。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.map_view);
    mContext = AMap.this;

    // set map
    mapView = (MapView) findViewById(R.id.mapview);
    mapView.setBuiltInZoomControls(true);
    mapView.setFocusable(true);   

    // Set this player's location as map's center
    geoPoint = new GeoPoint((int) (37.974718*1E6), (int) (23.733684*1E6));  
    projection = mapView.getProjection();
    screenPoint = new Point();
    projection.toPixels(geoPoint, screenPoint);
    mapController = mapView.getController();
    mapController.setCenter(geoPoint);      
    mapController.setZoom(1);

    // drawable is needed but not used  
    Timer t = new Timer();
    HTask ht  = new HTask();
    t.schedule(ht, 15000);

}

 public void onWindowFocusChanged(boolean hasFocus){
        Log.d(LOG_TAG, "Focus changed to: "+hasFocus+" ("+i+")");       
        int h = mapView.getHeight();
        int w = mapView.getWidth();
        Log.d(LOG_TAG, " Window focus changed: w = "+w+" , h = "+h);
        if(w > 0 && h > 0)  {           
            mHandler.postDelayed(mUpdateTimeTask, 100); 
        }           
 }

private Runnable mUpdateTimeTask = new Runnable() {
   public void run() {
        int h = mapView.getHeight();
        int w = mapView.getWidth();
        if(h>0 && w>0){   
                mapController.zoomIn();
                mapController.animateTo(geoPoint);
                mHandler.postAtTime(this, SystemClock.uptimeMillis() + 1500);
        }

   }
};

class HTask extends TimerTask{

    @Override
    public void run() {
        mHandler.removeCallbacks(mUpdateTimeTask);          
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:53:57.243

只需覆盖`onAttachedToWindow()`您的 MapActivity，放大那里，一切都应该没问题。如果 MapView 附加到 Window 并且因此具有宽度和高度，它会被调用

由于代码更新而编辑：

我不舒尔。这里有一些东西，我会改变，因为它们对我来说看起来很奇怪：

```
private Runnable mUpdateTimeTask = new Runnable() {
   public void run() {
       //WHY you asking LayoutPARAMS for their dimensions? try this:
       int h = mapView.getHeight();
       int w = mapView.getWidth();
       Log.d(LOG_TAG, "w = "+w+" , h = "+h);         
       mHandler.postAtTime(this, SystemClock.elapsedRealtime() + 1000);
   }
 }; 
```

同样在这里：

```
@Override
public void onAttachedToWindow(){
    Log.d(LOG_TAG, "Attached to Window");
    int h = mapView.getHeight();
    int w = mapView.getWidth();
    Log.d(LOG_TAG, " Attached to window: w = "+w+" , h = "+h);
    //mapController.zoomInFixing(screenPoint.x, screenPoint.y);
}
public void onWindowFocusChanged(boolean hasFocus){
    .... 
```

另外，我看不到您在任何地方都调用 zoomIn

# c# - 将数据从 php 发送到 ac# 桌面应用程序

> ID：10802084
> 
> 赞同：1
> 
> 时间：2012-05-29T15:22:56.780
> 
> 标签：c#, php

我正在考虑做一个涉及 php 和 c# 的项目。我需要做的是从 PHP 用户可以执行某个任务，一旦 php 处理了一些信息，这些信息需要发送到 ac# 应用程序，c# 可以使用提供的信息做一些其他工作。

c# 应用程序很可能在运行 php Web 应用程序的同一台服务器上工作，但如果它们位于完全独立的服务器上，它应该可以工作。

我想我可以将一些 XML 从 php 发送到运行 c# 程序的任何 IP 地址，但不知道我将如何让 php 进行发送以及如何让 c# 应用程序来列出数据。

任何帮助将不胜感激。d

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T15:26:47.520

您无需指定要发送的数据的性质，但如果您通过 Web 发送数据，那么使用 XML、JSON、Web 服务等与语言无关的方法意味着您的服务器端语言在很大程度上是无关的。

但是，如果您要发送大型电影文件之类的内容，那么使用 FTP 或类似文件可能会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T15:26:57.860

## 肥皂

在一个首字母缩略词中，您可以（几乎）解决您生活中的任何互操作性问题。

“简单地”定义在桌面应用程序中运行的 Web 服务（**有可能**，但不是那么简单）并实例化 PHP [SoapClient](http://php.net/manual/en/book.soap.php)。

## XML（纯）

当然，您可以将直接 XML 输入发送到您的桌面应用程序。这利用了 .NET Socket ( `System.Net.Sockets`) 和 PHP 套接字 I/O ( `fsockopen`)。您可以创建特定于应用程序的协议并注入 XML 数据。

如果您已经非常熟悉 XML 并且对套接字很熟悉，建议您使用。如果您想要更高级别的可重用性，则不推荐。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:26:55.207

您可以在 C# 服务中打开 WCF 通道，然后使用 PHP 调用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T16:07:30.553

您应该在桌面应用程序中托管一个[自托管 WCF 服务](http://msdn.microsoft.com/en-us/library/ms731758.aspx)，并从您的 php 应用程序调用这些服务。

```
using System.ServiceModel;
using System.ServiceModel.Description; 
```

示例代码：

```
[ServiceContract]
public interface IHelloWorldService
{
   [OperationContract]
   string SayHello(string name);
}

public class HelloWorldService : IHelloWorldService
{
  public string SayHello(string name)
  {
    return string.Format("Hello, {0}", name);
  }
} 
```

# java - 运行 java 应用程序/小程序时出错

> ID：10802087
> 
> 赞同：0
> 
> 时间：2012-05-29T15:23:14.067
> 
> 标签：java, eclipse, applet, neural-network, sudoku

我正在使用[此处的代码在 java 中研究神经网络](http://code.google.com/p/my-sudoku/source/browse/trunk/Sudoku/src/neural/network/sudoku/Board.java?spec=svn4&r=4)

但是当我将它作为 Java 应用程序运行时，它会给出错误“选择不包含主要类型”，因为我是 java 新手。任何形式的帮助将不胜感激:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:27:34.167

您需要从主类调用 Board 构造函数来显示框架

```
public static void main(String args[]){
  Board board = new Board();
} 
```

# winforms - 在 Windows 窗体中使用 reportviewer 控件的参数化 rdlc 报告 [本地 rdlc 报告]

> ID：10802088
> 
> 赞同：-1
> 
> 时间：2012-05-29T15:23:24.230
> 
> 标签：winforms, reportviewer

我想使用reportviewer 控件制作本地参数化报告。

任何机构都可以给出提示吗？

我想得到以下输出

```
-------------------------------------------------------------------------------------------------------------------------
Bill No : 101  Name : abc  Address : adsf  Phone:9889898  <------    Master Table
-------------------------------------------------------------------------------------------------------------------------
Item No        Name        Price           Qty            Total <------     Detail Table 
-----------------------------------------------------------------------
1              abc         40              2              80
2              adsf        34              2              ??
----------------------------------------------------------------- 
```

累计 ： ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T05:46:29.673

如果您使用的是 SQL Server，请尝试使用存储过程并像往常一样向其提交参数，然后将本地报表绑定到返回的数据集。我不知道在 Winforms 中有一种方法可以让参数像 webforms 一样动态显示。在winforms中我结束了uo构建了我自己的报告提交子系统来处理这个....

将数据集绑定到报表后，您必须对报表查看器对象执行刷新

# sql - 批量更新 SQL Server 2005

> ID：10802089
> 
> 赞同：2
> 
> 时间：2012-05-29T15:23:38.170
> 
> 标签：sql, tsql, sql-server-2005, upsert

有没有办法在 SQL Server 2005 中批量更新插入？类似于 2008 年的 MERGE 将是完美的。我有一个表作为临时工作区工作，需要在会话完成时与主表进行协调。在 2008 年，merge 可以很好地解决这个问题，但我见过的唯一 2005 年方法是针对单个 upsert，而不是批量。想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T15:52:14.953

首先进行更新，然后进行插入。像这样的东西。

```
update TargetTable
set Col1 = SourceTable.Col1,
    Col2 = SourceTable.Col2
from SourceTable
where TargetTable.ID = SourceTable.ID

insert into TargetTable(Col1, Col2)
select Col1, Col2
from SourceTable
where SourceTable.ID not in (select ID from TargetTable) 
```

**更新：**

如果主键中有多个列，则可以`not exists`改用。

```
update TargetTable
set Col1 = SourceTable.Col1,
    Col2 = SourceTable.Col2
from SourceTable
where TargetTable.ID1 = SourceTable.ID1 and
      TargetTable.ID2 = SourceTable.ID2

insert into TargetTable(Col1, Col2)
select Col1, Col2
from SourceTable
where not exists (select * 
                  from TargetTable
                  where TargetTable.ID1 = SourceTable.ID1 and
                  TargetTable.ID2 = SourceTable.ID2) 
```

# javascript - 单击按钮时用css显示图像

> ID：10802091
> 
> 赞同：0
> 
> 时间：2012-05-29T15:23:59.190
> 
> 标签：javascript, jquery

当在此小提琴中单击“蓝色”时，我正在尝试显示图像和一些 CSS：http: [//jsfiddle.net/adrianjsfiddlenetuser/C6Ssa/25/](http://jsfiddle.net/adrianjsfiddlenetuser/C6Ssa/25/)

但是没有显示图像并且没有应用css？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T15:27:56.830

类中的`width`和`height`属性`myImage`太小，图像无法显示。

我试过了，它奏效了：

```
.myImage{
    ...
    width:60px;
    height:70px;
    ...
}​ 
```

在这里查看：http: [//jsfiddle.net/S6Ntn/](http://jsfiddle.net/S6Ntn/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:28:21.530

您尝试显示的图像是 256x256 像素，但`div`您使用的是 6x7 像素，因此只显示了一小部分（透明）区域。如果您希望显示整个 X，那么您需要将图像调整为正确的尺寸，使用`img`标签或使用`background-size: 100%`（CSS3，因此浏览器支持有限）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:28:33.377

## 更新

[更新的 jsFiddle](http://jsfiddle.net/C6Ssa/43/)
这是一个使用`img`标签而不是背景的工作示例。宽度和高度仍在 css 中设置，但`src`现在在 javascript 中设置。

**JavaScript**

```
$("#red").click(red);
$("#blue").click(blue);

function red()
{
    $("#myDiv").removeClass('blue')
        .addClass('red')
        .text('test')
        .remove('img');
}

function blue()
{
      $("#myDiv").removeClass('red')
          .addClass('blue')
          .text('test')
          .append('<img src="http://oneseasonnation.com/www/wp-content/uploads/2008/11/2009/01/ip_icon_02_cancel.png" />');
} 
```

**CSS**

```
.red
{
    background-color : red   
}
.blue
{
    background-color : blue   
}
.blue img
{
    width:25px;
    height:25px;
} 
```

​</p>

## 原来的

您将其设置为具有固定宽度和高度的背景。背景图像缩放不受广泛支持，因此将图像添加到`div`具有指定高度和宽度的图像可能会更容易。您需要使用jQuery 方法将其显式添加为`img`标签。`append`

您的图像**已**设置好，但由于它太大而不可见，为了证明这一点，我已经[更新了您的 jsFiddle](http://jsfiddle.net/C6Ssa/34/)，增加了`#myImage`div 的宽度和高度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T15:32:53.333

如果你仔细看，图像正在显示，并且 css 也在被应用。每当您单击时，最右侧都会出现一个灰色的小框（您可能需要滚动）。那就是加载图像的地方。而且，你有一个打字错误。而不是`addClass('myImage')`你使用`removeClass('myImage')`. 除此之外，您没有利用链接的强大功能。查看更新代码。它更好并且有效。

# c# - 重新创建新对象

> ID：10802094
> 
> 赞同：-2
> 
> 时间：2012-05-29T15:24:08.063
> 
> 标签：c#, class, object, instance

所以我有一个很容易解决（我认为）的问题。我正在制作一些迷你游戏，假设我有游戏 1、游戏 2、游戏 3。我可以开始游戏1，然后在完成后我可以从头开始游戏。问题是当我重新开始游戏时，我做 game1=new Game1(); 它不是从 0 开始的，一些对象已经分配给了 game1，所以我显然得到了错误。

澄清一点：用户选择：Game1,Game2,Game3 --> 他选择了 Game1 --> CreateGame1(); --> 游戏1=新游戏1(); 用户完成游戏并选择再次进入游戏： CreateGame1() --> game1=new Game1(); 这就是问题所在。game1 在我的课开始时被定义为 Game1 game1；

有什么简单的方法可以解决这个问题，还是我应该手动删除每个项目？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:26:31.693

我认为您有一些静态属性，其值在创建新对象时不会重置。我没有看到这个问题的其他原因。无论如何，由于您没有发布代码，因此很难准确地回答这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:28:06.380

您是否在 Game 类中使用静态字段？

当您创建一个类的新实例时，所有非静态字段都会被初始化。但是静态字段不是每个实例的，因此它们保持其值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:28:17.233

如果您使用静态字段，请记住这些是“类级别”，并且在创建新实例时不会“重置”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T15:30:32.990

我认为我误解了，因为创建一个新实例应该清除不是按定义或在构造函数或静态中的任何内容

如果我错过了这一点，那么请尝试查看 iDisposable

# java - 根据相关的 id 列表重新排序集合

> ID：10802096
> 
> 赞同：1
> 
> 时间：2012-05-29T15:24:20.347
> 
> 标签：java, collections, sequence

我有一个具有*id*属性的对象集合（无序）和一个（有序）列表*ids*。**id 列表未排序**。我想在我的集合中创建一个对象列表，根据 ID 列表排序。

我在 Guava 或 Apache Commons 中没有看到这种方法——但这正是我正在寻找的。具有良好实现的库函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T17:15:17.733

听起来您的 id 列表有自己的顺序；你不只是使用自然顺序，对吧？

这是番石榴解决方案：

```
Ordering.explicit(idList)
     // constructs a "fluent Comparator" that compares elements in the
     // explicitly specified order
  .onResultOf(new Function<MyObject, Id>() {
    public Id apply(MyObject o) { return o.getId(); }
   }) // make this a Comparator<MyObject> that compares on IDs
  .sortedCopy(myObjects); // get the sorted copy of the collection 
```

就是这样。没什么。（披露：我为 Guava 做出了贡献。）

或者，如果您知道 ID 是唯一的，它可能只是说

```
Map<Id, MyObject> objectsById =
  Maps.uniqueIndex(myObjects, GET_ID_FUNCTION); // defined elsewhere
List<MyObject> sortedObjects = Lists.newArrayList();
for (Id id : sortedIds) 
  sortedObjects.add(objectsById.get(id)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T01:59:37.527

如果您的无序输入不比 Collection 更具体，并且您的 ID 列表是任意顺序（不是数字递减或类似的东西），那么您最简单且性能相当好的方法可能就是这样。成本是线性的，O(m+n) 其中 m 是您最初排序的列表中的 id 数，n 是要排序的值的数量。

```
Map<IDType, ValueType> keyed = new HashMap<IDType, ValueType>();
for (ValueType value : unsortedCollection) {
    keyed.put(value.getId(), value);
}

List<ValueType> sorted = new ArrayList<ValueType>();
for (IDType id : sortedIds) {
    ValueType value = keyed.get(id);
    if (value != null) {
        sorted.add(value);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:47:35.567

听起来你有一个你想要的给定顺序，可能是也可能不是数字升序/降序？

我建议在下面制作自己的谓词。 `org.apache.commons.collections.CollectionUtils.find(java.util.Collection collection,` [谓词](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/Predicate.html) `predicate);`

并遍历您的特定顺序，在无序列表中找到每个实际对象。N^2 解

`java.util.collections.sort(List list, Comparator c)`以及org.apache.find()的创造性使用，`java.util.collections.swap(List list, int i, int j)`您可能会远离 n^2

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T15:48:18.397

读取 ID 列表，将集合复制到 ID 列表顺序中的新列表中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T15:51:38.160

创建一个实现 Comparable 的类。在该类中，根据您的有序 id 列表进行排序。然后根据 Comparable 类定义一个 TreeSet。下面显示了一个大大简化的示例。

例如

```
public class MyObject implements Comparable<MyObject> {
  private Integer id;

  // a map of IDs to how they are ordered.
  private static Map<Integer, Integer> idOrder = null;

  public MyObject(Integer id) {
      setId(id);

      if (idOrder == null) {
           idOrder = new HashMap<Integer, Integer>();
           idOrder.put(17, 1);
           idOrder.put(27, 2);
           idOrder.put(12, 3);
           idOrder.put(14, 4);
      }
  }

  public int getId() {
      return (this.id);
  }

  public void setId(int id) {
      this.id = id;
  }

  public int compareTo(MyObject anotherThing) {
    return (idOrder.get(this.getId()).compareTo(idOrder.get(anotherThing.getId()))); 
  }
} 
```

然后，像这样定义和填充您的集合：

```
private Set<MyObject> mySet = new TreeSet<MyObject>;
mySet.add(new MyObject(12));
mySet.add(new MyObject(17)); 
```

当您执行 mySet.add() 时，它会根据您的 MySort 类自动排序。如果您遍历生成的 TreeSet，“17”条目将位于“12”条目之前。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-29T15:53:16.950

你可以：

*   在你的对象中实现接口[Comparable](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)然后调用[Collections.sort(List)](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List%29)
*   用一个新类实现接口[Comparator](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)然后调用[Collections.sort(List, Comparator)](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)

对于第一个解决方案，您必须修改您的对象，对于第二个解决方案，您必须创建另一个类，但您可以不修改您的对象。 `<T>`是你的对象类。

# xamarin.ios - 使用 MonoTouch 时，MonoDevelop 中有哪些不同的“版本”输入字段？如何自动增加版本？

> ID：10802105
> 
> 赞同：2
> 
> 时间：2012-05-29T15:24:34.813
> 
> 标签：xamarin.ios, monodevelop

在 MonoDevelop 中，我可以看到三个可以编辑应用程序版本的地方。

*   第一个在*Project -> Solution Options 下：*
*   第二个是*Project -> TestProject options (Main Settings)*
*   第三个是*Project -> TestProject options (iPhone application)*

第二个我可以选择从父母那里继承。第三个又独立了。

当我提交到 App Store 时将使用什么版本？我必须维护所有三个版本吗？

MonoDevelop 中是否有一个选项可以在每次构建时自动更改版本，这样我就不必手动执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T10:38:46.843

> *   第一个在 Project -> Solution Options 下：
> *   第二个是 Project -> TestProject options (Main Settings)

我相信这些没什么用，没有人（除了你）会真正看到它们。

> *   第三个是 Project -> TestProject options (iPhone application)

这是重要的一个，客户将在 App Store 中以及他们安装应用程序时看到的一个。

没有内置的方法可以自动增加它，但是在 MonoDevelop 中添加一个为您执行此操作的构建后脚本并不难（您所要做的就是修改 Info.plist 中的 CFBundleVersion）。

要在运行时从应用程序包中读取版本，请执行以下操作：

```
NSBundle.MainBundle.InfoDictionary.ValueForKey (new NSString ("CFBundleVersion")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T17:51:15.047

第三个中的重要版本——这是 info.plist 文件，它对 App Store 很重要。

据我所知，无法自动增加版本，但您可以尝试通过构建脚本或向 MonoTouch BugTracker 添加功能请求

# php - 当我将我的 php 联系表单从 get 切换到 post 时，它不起作用

> ID：10802116
> 
> 赞同：-1
> 
> 时间：2012-05-29T15:24:59.993
> 
> 标签：php, html, forms, post, media-queries

这是我的联系表格，您可以在页面底部的[benlevywebdesign.com上查看。](http://benlevywebdesign.com)

```
<form id="form1" action="<?php echo $_SERVER['PHP_SELF']; ?>" enctype="text/plain" method="get">    

        <fieldset>
            <p class="form">
                <label for="name">Name</label>
                <input type="text" name="name" id="name" size="30" />
            </p>
            <p class="form">
                <label for="email">Email</label>
                <input type="text" name="email" id="email" size="30" />
            </p>
            <p class="form">
                <label for="web">Website</label>
                <input type="text" name="web" id="web" size="30" />
            </p>            
        </fieldset>
        <fieldset>                                                                          
            <p class="form">
                <label for="message">Message</label>
                <textarea name="message" id="message" cols="30" rows="10"></textarea>
            </p>                                
        </fieldset>                 

        <p class="submit"><button name="submit" type="submit">Send</button></p>

    </form>` 
```

这是我试图从 get 切换到 post 的 php 代码。我不知道那么多php

```
<?php
        if(isset($_GET['submit'])){

            $to = "benlevygraphics@gmail.com";
            $headers = "From: " . $_GET['email'];
            $subject = "Ben, you have been contacted by...";
            $body = "Name: " . $_GET['name'] . "\nEmail: " . $_GET['email'] . "\nWebsite: " . $_GET['web'] . "\nMessage: " . $_GET['message'];
            if(mail($to, $subject, $body, $headers)){
                echo("<p>Your message has been sent!</p>");
            }
            else{
               echo("<p>Message delivery failed...</p>");
            }
       }

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:37:21.833

首先，摆脱你的`enctype`属性。您正在将其设置为`text/plain`规范所说的：

> 使用 text/plain 格式的有效负载旨在供人类阅读。它们不能被计算机可靠地解释

二、设置`method`为`"POST"`

三、在PHP中使用`$_POST`不`$_GET`

第四，不要在`$_POST/GET/SERVER/ETC`没有先用[`htmlspecialchars`](http://php.net/htmlspecialchars). 否则你有一个巨大的 XSS 安全漏洞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:28:42.303

尝试改变：

```
<p class="submit"><button name="submit" type="submit">Send</button></p> 
```

经过

```
<p class="submit"><input type="submit" name="submit" id="submit" value="Send" /></p> 
```

# python - 在 Biopython 的 PDB 模块中实现等价

> ID：10802123
> 
> 赞同：1
> 
> 时间：2012-05-29T15:25:31.713
> 
> 标签：python, biopython

### 背景

在`PDB`Biopython 的模块中，[PDB 结构](http://en.wikipedia.org/wiki/Protein_Data_Bank)被解析为`Structure`对象，这些对象将结构的组件存储在 SMCRA 架构中（Structure/Model/Chain/Residue/Atom）。此层次结构的每一级都由一个继承`Entity`容器类的对象表示。

### 等价

我的问题是任何两个实体对象都不能相等。

从同一个文件构建的结构不相等：

```
>>> from Bio import PDB
>>> parser = PDB.PDBParser()
>>> struct1 = parser.get_structure("1hgg", "pdb1hgg.ent")
>>> struct2 = parser.get_structure("1hgg", "pdb1hgg.ent")
>>> struct1 == struct2
False 
```

该结构中的残基不相等：

```
>>> first_res1 = struct1.get_residues().next()
>>> first_res2 = struct2.get_residues().next()
>>> first_res1 == first_res2
False 
```

等等。

如果我们要分别解析同一个 PDB 文件，则结构中的任何`Entity`对象都不可能相等。

### 解决方案

这个问题的明显解决方案是永远不要对同一个 PDB 文件进行两次解析。然后，我们有对象身份，因此，等价。但是，这个答案对我来说似乎不完整。

每个`Entity`对象都可以返回一个标识元组[`get_full_id()`](http://biopython.org/DIST/docs/api/Bio.PDB.Entity.Entity-class.html#get_full_id)。此方法给出从顶部对象向下的所有 id；如果在构造对象时提供了正确的 PDB id，则它对于结构中的每个结构都应该是唯一的`Entity`，并且在所有结构中都是唯一的。`Structure`

我测试`Entity`等效性的解决方案只是比较这个完整的 id。那是：

```
def __eq__(self, other):
    return self.get_full_id() == other.get_full_id() 
```

### 问题

在这一点上，我在问我对`Entity`等价的实现是否明智。

*   误报（例如，提供相同 PDB id 的不同结构）是否令人担忧？
*   每当我们需要测试等效性时，简单地手动比较完整的 id 会更好吗？
*   是否有任何理由在模块`__eq__`中未实现？`PDB`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:46:56.770

不定义 an 的一个常见原因`__eq__`是它使事物不可散列（因此您不能将它们用作字典键或将它们放在集合中），除非您还定义了一致的`__hash__`函数，**并且**您的对象是不可变的。

默认情况下`__hash__`，对象只使用 ID，这甚至适用于可变对象，因为 ID 永远不会改变。但是如果你定义了一个 custom `__eq__`，你就不能继续按 ID 进行散列，否则你会遇到两个对象可以比较相等但具有不同散列的情况，这与散列的工作方式不一致。所以你必须定义一个自定义`__hash__`函数（你可以这样做），但是如果你的对象是可变的，你也不能/不应该真的这样做*，*所以你只会有一个不可散列的对象。这对你来说可能没问题。

[在此处](http://docs.python.org/reference/datamodel.html#object.__hash__)的 python 文档中查看更多信息。

`__eq__`因此，只要您不需要对象是可散列的，或者它们是不可变的，您就可以使用自定义；否则事情会变得更复杂。或者您可以不理会`__eq__`，将您的完整 ID 比较函数命名为其他名称，以免破坏哈希性。

我不太了解 PDB ID 的含义（特别是是否可能出现误报），无法`__eq__`从这个角度判断您的实施是否合理。

# ios - 从 iOS 模拟器下载 iOS 应用程序

> ID：10802126
> 
> 赞同：1
> 
> 时间：2012-05-29T15:25:38.940
> 
> 标签：ios, ios-simulator

嗨，我需要尝试应用商店中的 iOS 应用。我没有任何设备，所以我想知道是否可以从 iOS 模拟器下载它。是否可以？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:27:01.607

不，这是不可能的。App Store 上的应用程序是为 arm 架构编译的，而模拟器运行 i386 的应用程序。

# php - 计算实际播种机的总数

> ID：10802134
> 
> 赞同：0
> 
> 时间：2012-05-29T15:26:11.807
> 
> 标签：php, bittorrent, dht

我正在根据种子的信息哈希创建一个 PHP 种子刮板。我设法在很多跟踪器上获得了每个种子的种子数和对等数。但是我如何计算“平均”种子数？

我可以用 DHT 做些什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:29:04.343

由于跟踪器和 DHT 都没有为所有种子甚至超出特定大小的单个种子提供详尽的唯一 IP 列表——因为这会给它们带来太多流量——你不能自己创建这些统计数据。充其量您可以对单个群体进行采样并从那里进行推断。

如果您想要此类数据，则需要控制跟踪器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:34:35.500

你不把每个跟踪器的所有种子加起来，然后用这个数字除以有多少个跟踪器，如果你想要平均值吗？我不确定哈希中隐藏了哪些信息，但这似乎是计算平均值的合理解决方案。

```
$seeds = 0;

foreach($tracker as $track) {
   /* 
    * Something along this line to add the current trackers
    * seeds to a $seeds variable
    */
   $seeds += $track['seeds'];
}

$average = $seeds / count($tracker); 
```

# apache - Apache 1 和 Apache 2 的区别

> ID：10802135
> 
> 赞同：5
> 
> 时间：2012-05-29T15:26:14.660
> 
> 标签：apache, apache2

Apache 1 和 Apache 2 的分支有什么区别？

使用一种或另一种的优点和缺点？

似乎 Apache 2 的缺点之一是使用大量内存，但在处理请求时可能更快？

最有趣的是 Apache 作为 php 页面的服务器（不用于提供静态文件）。

附言。也许需要比较 Apache 1.3.* 和 Apache 2.2.*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:34:50.523

查看[Apache 2.0 中的新功能概述](http://httpd.apache.org/docs/2.0/new_features_2_0.html)和[从 1.3 升级到 2.0](http://httpd.apache.org/docs/2.0/upgrading.html)。

# visual-studio-2010 - F# 编译在 Visual Studio 中挂起

> ID：10802136
> 
> 赞同：2
> 
> 时间：2012-05-29T15:26:15.297
> 
> 标签：visual-studio-2010, f#

我有一个包含 C# 和 F# 项目混合的解决方案（它是一个 Silverlight 应用程序）。当我尝试在 Visual Studio 2010 SP1 中编译它时，构建过程挂在 F# 项目之一上。如果我删除该项目，它会挂在另一个 F# 项目上。

F# 编译器 ( `fsc.exe`) 没有运行，我找不到任何看起来可能要杀死的进程（除了`devenv.exe`）。

它使用 MSBuild 在命令行上编译得很好。它在 VS11 beta 中编译得很好。我们（还）不能将解决方案迁移到 VS11。

这发生在我的电脑和另一台电脑上。其他团队成员都没有这个问题。

有没有人见过这种行为？我该如何调试呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T18:53:23.967

转到 Tools\Options\Projects&Solutions\Build&Run 并将 MSBuild 输出详细程度更改为“诊断”，然后检查输出窗口以查看挂起的确切位置可能会很有用，这可能有助于诊断。

# java - 如何使字符串索引超出范围：iText 中的 -1

> ID：10802145
> 
> 赞同：-1
> 
> 时间：2012-05-29T15:26:48.513
> 
> 标签：java, itext

在这里我需要处理捕获的异常，我需要将这些 PDF 移动到我在代码“失败文件夹”中指定的文件夹中。

```
package extractInfoFromPDF;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import com.itextpdf.text.exceptions.InvalidPdfException;

import com.itextpdf.text.pdf.PdfReader;
import com.itextpdf.text.pdf.parser.PdfTextExtractor;

public class Test {
    static FileWriter output = null;
    public static void main(String[] args) throws IOException {

        File file = new File("c:/write.txt");
        output = new FileWriter(file);

        PdfReader pdfArticle = null;

        Pattern pattern = Pattern.compile("\\b(10[.][0-9]{4,}(?:[.][0-9]+)*/(?:(?![\"&\\'<>])\\S)+)\\b", Pattern.CASE_INSENSITIVE);

        File ArticleFolder = new File("D:\\AI\\failed1");
        File[] listOfArticles = ArticleFolder.listFiles();
        int count = 0;

        StringBuffer s = null;

        for (File article : listOfArticles) {

            if(!article.getName().contains("article.fulltext.000001")){
                continue;
            }

                pdfArticle = new PdfReader(article.getAbsolutePath());
try{
                s = new StringBuffer(PdfTextExtractor.getTextFromPage(pdfArticle, 1));
} catch (InvalidPdfException|StringIndexOutOfBoundsException|ArrayIndexOutOfBoundsException  e) {

    copyFile(article, new File ("D:\\AI\\fail"));
    delete(article);

}

            // System.out.println(s);
            Matcher m = pattern.matcher(s);
            String DOI = null;
            if (m.find()) {
                DOI = m.group();

            }
            if (DOI == null) {
                Pattern pattern2 = Pattern.compile("(DOI:).*", Pattern.CASE_INSENSITIVE);
                Matcher m2 = pattern2.matcher(s);

                if (m2.find()) {
                    DOI = m2.group();
                    DOI=DOI.replaceAll("\\s+", "");
                    m = pattern.matcher(DOI);
                    if (m.find()) {
                        DOI = m.group();

                    }else{
                        DOI = "DOI-NOT-AVALIABLE";
                    }

                }else{
                    DOI = "DOI-NOT-AVALIABLE";
                }

            }
            count = count + 1;
            String d[]=DOI.split(" ");

            for(String d2 : d){
                if(d2.contains("10.")){
                    DOI=d2;
                }
            }

            DOI = DOI.replaceAll("(DOI:)(doi:)(\\s+)([\\.,;)]])", "").trim();
            System.out.println(count + "    TAN: " + article.getName() + "      "
            + DOI);
//if(DOI.matches(""[A-Z-a-z-0-7]"))

            output.write(count + "  TAN: " + article.getName() + "      " + DOI+"\n");

            // FileUtils.writeStringToFile(new File("write.txt"), count++
            // +"   TAN: "+article.getName()+"      "+DOI, "UTF-8");

        }

        output.close();

    }

    public static void copyFile(File source, File dest) throws IOException{

        if(!dest.exists()){

        dest.createNewFile();

        }

        InputStream in = null;

        OutputStream out = null;

        try{

        in = new FileInputStream(source);

        out = new FileOutputStream(dest);

        byte[] buf = new byte[1024];

        int len;

        while((len = in.read(buf)) > 0){

        out.write(buf, 0, len);

        }

        }

        finally{

        in.close();

        out.close();

        }
    }

    public static boolean delete(File resource) throws IOException{ 

        if(resource.isDirectory()){

        File[] childFiles = resource.listFiles();

        for(File child : childFiles){

        delete(child);

        }

        }

        return resource.delete();

        }

} 
```

这是我的完整代码，下面是我得到异常的特定行。

```
s = new StringBuffer(PdfTextExtractor.getTextFromPage(pdfArticle, 1)); 
```

我从 1000 和 1000 的 PDF 中得到`String index out of range`（-1 或一些 thime 0）几个 100 的 PDF。当我谷歌它时，没有解决方案。下面是我从 iText 获得的例外情况。而不是来自我的代码。对于某些pdf，我还可以`ArrayIndexOutOfBoundsException`在代码中的同一行中获得（有时是397或有时是286或其他类似的3位数字）`(PdfTextExtractor.getTextFromPage)`（有时是 397 或有时是 286 或其他一些 3 位数字） 。

```
java.lang.StringIndexOutOfBoundsException: String index out of range: -1
    at java.lang.String.charAt(String.java:695)
    at com.itextpdf.text.pdf.parser.LocationTextExtractionStrategy.getResultantText(LocationTextExtractionStrategy.java:121)
    at com.itextpdf.text.pdf.parser.PdfTextExtractor.getTextFromPage(PdfTextExtractor.java:73)
    at com.itextpdf.text.pdf.parser.PdfTextExtractor.getTextFromPage(PdfTextExtractor.java:88)
    at extractInfoFromPDF.Test.main(Test.java:41) 
```

对于 ArrayIndexOutOfBoundsException 我另一个 PDF 我得到了这个异常

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 397
    at com.itextpdf.text.pdf.CMapAwareDocumentFont.getWidth(CMapAwareDocumentFont.java:182)
    at com.itextpdf.text.pdf.parser.TextRenderInfo.getStringWidth(TextRenderInfo.java:210)
    at com.itextpdf.text.pdf.parser.TextRenderInfo.getUnscaledWidth(TextRenderInfo.java:113)
    at com.itextpdf.text.pdf.parser.TextRenderInfo.getUnscaledBaselineWithOffset(TextRenderInfo.java:147)
    at com.itextpdf.text.pdf.parser.TextRenderInfo.getBaseline(TextRenderInfo.java:122)
    at com.itextpdf.text.pdf.parser.LocationTextExtractionStrategy.renderText(LocationTextExtractionStrategy.java:154)
    at com.itextpdf.text.pdf.parser.PdfContentStreamProcessor.displayPdfString(PdfContentStreamProcessor.java:303)
    at com.itextpdf.text.pdf.parser.PdfContentStreamProcessor.access$2500(PdfContentStreamProcessor.java:74)
    at com.itextpdf.text.pdf.parser.PdfContentStreamProcessor$ShowText.invoke(PdfContentStreamProcessor.java:496)
    at com.itextpdf.text.pdf.parser.PdfContentStreamProcessor.invokeOperator(PdfContentStreamProcessor.java:246)
    at com.itextpdf.text.pdf.parser.PdfContentStreamProcessor.processContent(PdfContentStreamProcessor.java:366)
    at com.itextpdf.text.pdf.parser.PdfReaderContentParser.processContent(PdfReaderContentParser.java:79)
    at com.itextpdf.text.pdf.parser.PdfTextExtractor.getTextFromPage(PdfTextExtractor.java:73)
    at com.itextpdf.text.pdf.parser.PdfTextExtractor.getTextFromPage(PdfTextExtractor.java:88)
    at extractInfoFromPDF.Test.main(Test.java:41) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:45:32.837

经过所有尝试，我发现了异常的问题。这是因为**5.1 版中的 iText API 错误，当我用最新的****5.2 版**重建我的应用程序时，我没有任何例外，而且一切正常 :)

# ios - segue.destinationViewController 错误类 -> 错误：无法识别的选择器发送到实例

> ID：10802146
> 
> 赞同：0
> 
> 时间：2012-05-29T15:26:48.800
> 
> 标签：ios, uiviewcontroller, segue

我正在尝试使用 prepareForSegue 方法在 2 个 ViewController 之间传递一些数据，但我的 segue.destinationViewController 总是错误的类，所以我得到一个“发送到实例的无法识别的选择器”

segue.destinationViewController 应该是一个 WebViewController 是一个 UIViewController。

ARC 已启用。

这是我的一些代码：

NewsTableViewController.h

```
#import "WebViewController.h"

@interface NewsTableViewController : UITableViewController {

}
@end 
```

NewsTableViewController.m

```
@implementation NewsTableViewController

//some code

-(void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{

   if ([segue.identifier isEqualToString:@"showNewsWebView"]) {

     WebViewController *webViewConroller = segue.destinationViewController ;

     // here it prints UIViewController instead of WebViwController*
     NSLog(@"%@",[webViewConroller class]); 

     //here i get the error, because setUrlAsString is not defined for UIViewController but WebViewController
     [webViewConroller  setUrlAsString:[NSString stringWithString:@"www.apple.com"]];  
   }

} 
```

WebViewController.h

```
@interface WebViewController : UIViewController{
   IBOutlet UIWebView * webView;
   NSString *urlAsString;
}

@property (nonatomic) NSString * urlAsString;

-(void)setUrlAsString:(NSString *) string; 
```

WebviewController.m

```
#import "WebViewController.h"

@interface WebViewController ()
@end

@implementation WebViewController

@synthesize urlAsString;

-(void)setUrlAsString:(NSString *) string{
    self.urlAsString = string;
    NSLog(@"%@",urlAsString);
}

//some other code 
```

# java - Jgroup 示例

> ID：10802147
> 
> 赞同：2
> 
> 时间：2012-05-29T15:26:51.840
> 
> 标签：java, jgroups

有没有显示任何 jgroup 代码示例的网站？jgroups.org 上的教程和手册不是很好，通过谷歌粗略搜索了几次，并没有找到太多。我正在寻找序列化对象并将它们通过通道发送到另一个 JVM 等的示例。

提前致谢，

——贾斯汀·理查德·布莱斯坦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T07:57:27.007

您是否查看了[http://www.jgroups.org/tutorial-3.x/html/index.html](http://www.jgroups.org/tutorial-3.x/html/index.html)上的新教程？它显示了如何在集群节点之间发送（字符串）消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-28T20:41:57.700

请注意 .. 如果您正在寻找简单快速的 1:N 远程处理和序列化 ，请尝试[http://code.google.com/p/fast-cast/ 。](http://code.google.com/p/fast-cast/)如果出现问题，我会积极支持它。它的速度要快一个数量级，尤其是在远程调用和序列化方面。

# eclipse - 即使在使用 selenium testng 指定 firefox 后，IE 浏览器也会打开

> ID：10802148
> 
> 赞同：0
> 
> 时间：2012-05-29T15:26:53.367
> 
> 标签：eclipse, selenium, automation, testng

我正在使用 Eclipse IDE 并使用 testNG 框架。我已经指定了 Firefox，但测试运行器在 Firefox 中打开，并且测试在 IE 中执行。

**这是我的代码：**

```
public class Flipkart extends SeleneseTestNgHelper {

    @BeforeTest
    public void setup()
    {
           selenium = new DefaultSelenium("localhost" ,4444, "*firefox", "http://www.flipkart.com");
           selenium.start();
           selenium.windowMaximize();
    }

    @Test 
    public void testFlipkart() throws Exception {
        selenium.open("http://www.flipkart.com");
        verifyEquals(selenium.getTitle(), "Online Shopping India | Buy Books, Mobiles, Cameras, Laptops, Electronics, Accessories, Lifestyle Products | Flipkart.com");
        verifyTrue(selenium.isTextPresent("Featured:"));
    }

} 
```

有没有人遇到过同样的问题。请提出代码有什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:07:46.933

将 Eclipse 默认浏览器更改为 firefox（有时它会有所帮助）将 firefox 添加到类路径。还要看看你正在使用的 Firefox 版本，这应该与 selenium 兼容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T03:36:34.353

使用`*chrome`而不是`*firefox`.

另外，检查 selenium 服务器是否启动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T05:08:11.513

```
I was also getting same problem, Try out below  code for Solution this will help you

public static String browser="firefox";  //declare Browser this in the class heading.

@BeforeSuite

 public void setupBeforeSuite() throws Exception{
selenium = new DefaultSelenium("localhost", 4444,browser, "http://www.google.com");
selenium.start();
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-26T09:29:02.340

你可以试试这些步骤::

```
*STEP 1* : import org.openqa.selenium.firefox.FirefoxDriver;
         import org.openqa.selenium.WebDriver;
         import org.openqa.selenium.WebElement;

*Step 2* : WebDriver driver = new FirefoxDriver();

*Step 3* : driver.get("http://www.google.com"); 
```

# symfony - 表单集合，进入 getXXX 而不是 setXXX 或 addXXX

> ID：10802153
> 
> 赞同：0
> 
> 时间：2012-05-29T15:27:04.177
> 
> 标签：symfony

我正在使用 Symfony 2.1，我只是**对没有正确保存的表单集合**感到生气，

这是一个在我看来最奇怪的事情的简单示例：[https ://gist.github.com/2829001](https://gist.github.com/2829001)

为什么当我保存表单（处理`Car`对象）时，它`condition`通过`getConditions`而不是`setConditions`/`addCondition`

**这导致汽车参考未保存在条件表中。**

我只是怀疑是否需要添加一个`prePersist`和`preUpdate`循环条件对象来设置 Car 引用。

如果我们需要 prePersist / preUpdate 钩子，那么 addXXX / setXXX 的目标是什么？也许我错过了一些东西（我真的希望如此）。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T17:15:45.900

您应该将`by_reference`集合字段上的选项设置为`false`。另外，请确保使用最新版本的 Doctrine，因为`PersistentCollection`最近修复了一个影响集合字段的错误。

# jquery - AJAX .post 异步

> ID：10802156
> 
> 赞同：5
> 
> 时间：2012-05-29T15:27:20.013
> 
> 标签：jquery, asynchronous, post, get, asp.net-ajax

以下具体是做什么的：

```
$.ajax({
     type: "POST",
     async: false, 
```

对比

```
$.ajax({
    type: "POST",
    async: true, 
```

意思是行为上有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T15:32:31.397

从[jQuery 网站](http://api.jquery.com/jQuery.ajax/)：

> 默认情况下，所有请求都是异步发送的（即默认设置为true）。如果您需要同步请求，请将此选项设置为 false。跨域请求和 dataType: "jsonp" 请求不支持同步操作。请注意，同步请求可能会暂时锁定浏览器，从而在请求处于活动状态时禁用任何操作。

这里的所有都是它的。如果您在特定问题上需要帮助，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:42:28.080

异步调用不会“中断”javascript 代码的执行。从服务器交付返回请求时需要回调函数。它的开发更加复杂，需要更多地控制您的功能。

# c++ - while 循环不能有两个 cin 语句吗？

> ID：10802157
> 
> 赞同：2
> 
> 时间：2012-05-29T15:27:20.867
> 
> 标签：c++, cin, do-while

我只是在做一个关于 do/while 循环的简单 c++ 教程，我似乎完全复制了教程中写的内容，但我没有得到相同的结果。这是我的代码：

```
int main()
{
    int c=0;
    int i=0;
    int str;
    do
    {
        cout << "Enter a num: \n";
        cin >> i;
        c = c + i;
        cout << "Do you wan't to enter another num? y/n: \n";
        cin >> str;

    } while (c < 15);

    cout << "The sum of the numbers are: " << c << endl;

    system("pause");
    return (0);
} 
```

现在，在 1 次迭代之后，循环只是运行而无需再次询问我的输入，并且仅使用我的第一个初始输入计算总和 i。但是，如果我删除第二对 cout/cin 语句，程序运行正常。

有人可以发现我的错误吗？谢谢你！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:31:37.713

使用 读取字符串后`cin >> str;`，输入缓冲区中仍然有一个换行符。当您`cin >> i;`在下一次迭代中执行时，它会读取换行符，就好像您只是按下`enter`而不输入数字一样，因此它不会等待您输入任何内容。

`cin.ignore(100, '\n');`通常的解决方法是在阅读字符串之后放置类似的东西。这`100`或多或少是任意的——它只是限制了它将跳过的字符数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:41:24.363

如果你改变

```
int str; 
```

至

```
char str; 
```

您的循环按您的预期工作（在 Visual Studio 2010 中测试）。
虽然，你也应该检查一下`str == 'n'`，因为他们告诉你他们已经完成了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T15:31:57.000

> ...并且仅使用我的第一个初始输入计算总和...

这是预期的行为，因为您只是在阅读`str`而不是使用它。如果输入`i >= 15`则循环必须中断，否则继续。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-15T10:18:58.030

我想你想要这个东西

在这种情况下，总和`c`将小于 15，如果用户输入 y，则继续求和。

```
#include<iostream>
using namespace std;
int main()
{
    int c=0;
    int i=0;
    char str;
    do
    {
        cout << "Enter a num: \n";
        cin >> i;
        c = c + i;
        cout << "Do you wan't to enter another num? y/n: \n";
        cin >> str;

    } while (c < 15 && str=='y');

    cout << "The sum of the numbers are: " << c << endl;
    return 0;
} 
```

# javascript - jQuery ..如何将文本附加到现有文本的末尾？

> ID：10802160
> 
> 赞同：1
> 
> 时间：2012-05-29T15:27:35.597
> 
> 标签：javascript, jquery

简单的问题......也许？基本上我想要做的是将文本插入到页面上加载的 URL 的末尾。所以在我的页面上我会有类似...

```
<a href="myurl.html">My Url</a> 
```

我想要的是在点击事件的文件扩展名之后附加文本。所以点击后它应该看起来像..

```
<a href="myurl.html#something">My Url</a>

$('a').click(function(){
  //add text to url
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:29:27.300

您可以使用或更改`href`属性。[`.prop()`](http://api.jquery.com/prop/)[`.attr()`](http://api.jquery.com/attr/)

```
$("a").click(function() {
    $(this).prop("href", $(this).prop("href") + "#something");
}); 
```

或者

```
$("a").click(function() {
    $(this).attr("href", $(this).attr("href") + "#something");
}); 
```

# javascript - 我在 html 中还有多少滚动？

> ID：10802163
> 
> 赞同：2
> 
> 时间：2012-05-29T15:27:43.570
> 
> 标签：javascript, jquery, html, css

假设滚动条在某个位置，有没有办法让我知道，以像素为单位，我还有多少滚动？

我正在使用 jQuery scrollLeft：[http](http://api.jquery.com/scrollLeft/) ://api.jquery.com/scrollLeft/ 但我不想超出该值...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:44:02.663

[http://www.softcomplex.com/docs/get_window_size_and_scrollbar_position.html](http://www.softcomplex.com/docs/get_window_size_and_scrollbar_position.html)

这里有一套很棒的跨浏览器解决方案......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:31:05.840

使用 element.scrollHeight, element.scrollWidth: [https://developer.mozilla.org/en/DOM/element.scrollHeight](https://developer.mozilla.org/en/DOM/element.scrollHeight) [https://developer.mozilla.org/en/DOM/element.scrollWidth](https://developer.mozilla.org/en/DOM/element.scrollWidth)

兼容性：[http ://www.quirksmode.org/dom/w3c_cssom.html](http://www.quirksmode.org/dom/w3c_cssom.html)

但是，不要担心超出该值 - 浏览器无论如何都会调整到最大值。

# java - 是否需要向 android manifest 添加操作、数据和类别信息

> ID：10802166
> 
> 赞同：0
> 
> 时间：2012-05-29T15:27:55.130
> 
> 标签：java, android, xml, android-intent

我浏览了一些 Android 资源，发现了一些有趣的东西。它说要向 Android 清单添加具有不同数据、类别和 Activity 能够执行的操作的意图过滤器。但是，我无需添加这些东西就可以让我的应用程序正常工作。任何人都可以解释它是否需要以及添加这些意图过滤器的实际作用是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:32:33.977

`intent-filter`如果您希望您的应用程序显示在启动器上，则要求您有一个具有以下条件的 Activity ：

```
 <activity android:name=".YourMainActivity">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

这让操作系统知道在您的应用程序启动时要显示哪个 Activity。注意：`intent-filter`如果您不希望您的应用程序显示在启动器上（例如，如果您的应用程序是一个小部件），则不需要上述内容（感谢 Justin Breitfeller）。

如果您想了解更多有关 Intent-Filters 的信息，请查看[开发者文档](http://developer.android.com/guide/topics/intents/intents-filters.html)。一个常见的用途是允许其他应用程序调用您的应用程序，前提是它可以处理某些操作（例如发送电子邮件、启动相机等）。如果您在 中声明这些操作`AndroidManifest`，则可以通过 Implicit 调用您的应用程序`Intent`（请参阅上面的链接）。

# javascript - 使用 JavaScript Rangy 在 Chrome 中的空节点之前插入节点

> ID：10802169
> 
> 赞同：0
> 
> 时间：2012-05-29T15:28:00.217
> 
> 标签：javascript, html, dom, rangy

在另一个元素的开头（管道 | 是插入符号位置）尝试在空元素之前插入节点时，我注意到了这个问题。从此开始：

```
<p>|<span />Some text</p> 
```

我在 Rangy 范围上使用 range.insertNode() 来粘贴一些文本，但在 Chrome 中我看到了这个结果，新节点出现在空之后`<span>`：

```
<p><span />|INSERTED TEXTSome text</p> 
```

而不是这样：

```
<p>|INSERTED TEXT<span />Some text</p> 
```

请注意，这在 IE9 中似乎可以正常工作，并且如果插入未在`<p>`节点的开头完成，它也可以在 Chrome 中工作，例如：

```
<p>Some |<span />text</p> 
```

结果是：

```
<p>Some |INSERTED TEXT<span />text</p> 
```

这是一个简化的示例，但显示了我看到的问题。

为了澄清（如果我以错误的方式处理这个问题，有人可以提出替代方案）我正在尝试插入文本，并且一旦插入完成，光标总是出现在新插入文本的末尾。

例如`<p>|Original Text</p>`应该成为`<p>INSERTED TEXT|Original Text</p>`

但是，插入节点会导致插入符号紧挨在插入的文本之前放置（正如文档所述，它应该用于插入节点，因此没有抱怨）。我试图在插入后使用空`<span>`作为标记来恢复插入符号的位置（实际上我正在使用 Rangy 的选择保存和恢复模块来为我做这件事）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T08:37:38.763

这是因为 WebKit 不认为 之前的位置`<span>`是有效的插入符号位置。它与这些 Webkit 错误有关：

*   [https://bugs.webkit.org/show_bug.cgi?id=23189](https://bugs.webkit.org/show_bug.cgi?id=23189)
*   [https://bugs.webkit.org/show_bug.cgi?id=15256](https://bugs.webkit.org/show_bug.cgi?id=15256)

如果范围符合您的预期，Rangy 将允许您将节点插入到您想要的位置，但如果您从选择中获得了范围，那么该范围将反映浏览器对选择的想法。可能有办法解决它，但我不太清楚你到底想要做什么。

# java - 将 JAXB 注释与 RestEasy 一起使用

> ID：10802170
> 
> 赞同：2
> 
> 时间：2012-05-29T15:28:01.820
> 
> 标签：java, web-services, annotations, jaxb, resteasy

我正在尝试将 JAXB 注释与 RestEasy 一起使用，以便在我的 JSON 输出中选择名称和元素顺序。

不知何故，它不起作用，即使 RestEasy 文档说它是可能的。

这里有一些代码：

```
@XmlRootElement(name = "translation")
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "translation", propOrder = {
    "key",
    "value"
})
public class TranslationDTO {

  public TranslationDTO() {}
  public TranslationDTO(Translation translation) {
    setKey(translation.getTranslationKey().getValue());
    setValue(translation.getContent());
    //setCreationDate(translation.getCreatedTimestamp());
  }

  @XmlElement(name = "key")
    private String key;

  @XmlElement(name = "value")
    private String value;

    //private Date creationDate;

    @XmlElement(name = "key")
    public String getKey() {
    return key;
  }

    public void setKey(String key) {
    this.key = key;
  }

    @XmlElement(name = "value")
    public String getValue() {
    return value;
  }

    public void setValue(String value) {
    this.value = value;
  }

    /*@XmlElement(name = "creationDate")
    public Date getCreationDate() {
    return creationDate;
  }

    public void setCreationDate(Date creationDate) {
    this.creationDate = creationDate;
  }*/

} 
```

这里是一个示例输出：

```
{
    "name":"i18nhelp",
    "currentVersion":"1",
    "currentTotalKeys":28,
    "oldTotalKeys":0,
    "totalLanguages":2,
    "languageDtos":[{
        "name":"Anglais",
        "iso639":"en",
        "totalCurTrans":28,
        "newCurTrans":28,
        "oldTrans":0
    },
    {
        "name":"Français",
        "iso639":"fr",
        "totalCurTrans":28,
        "newCurTrans":28,
        "oldTrans":0
    }]
} 
```

似乎根本没有考虑 JAXB 注释。

任何想法都会被考虑...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-02T14:25:03.020

如果您使用 JBoss（或现在称为 WildFly）作为应用程序服务器，您可能正在使用 Jackson ( [http://jackson.codehaus.org/](http://jackson.codehaus.org/) ) JSON marshaller 体验 RestEasy，它有自己的注释 - 您可以找到从杰克逊的主页链接的文档。它们比“仅”JAXB 更具表现力，如果您专门针对 JSON 输出，您可能需要考虑它们。

如果您只想使用 JAXB，如您的示例所示，您可以通过指定要在 a 中使用的 resteasy 提供程序模块从 Jackson 切换到不同的东西`jboss-deployment-structure.xml`，如[本答案](https://stackoverflow.com/a/13533317/2740117)中所述。

# php - WordPress WooCommerce - 使用 WC_Cart 类将变量产品添加到购物车

> ID：10802172
> 
> 赞同：10
> 
> 时间：2012-05-29T15:28:05.457
> 
> 标签：php, wordpress

我正在尝试将可变产品添加到 WordPress 插件 WooCommerce 的购物车中。

到目前为止，我已经能够添加单一/简单的产品：

```
$woocommerce->cart->add_to_cart( [product_id], [quantity] ); 
```

但是，查看函数签名的 WC_Class：

```
function add_to_cart( $product_id, $quantity = 1, $variation_id = '', $variation = '', $cart_item_data = array() ) { 
```

我们可以清楚地看到该函数允许输入variation_id。

我已经尝试了空值和整数的每种组合：

```
$woocommerce->cart->add_to_cart( 24, 1, 28, null, null ); 
```

等等都无济于事。

我还尝试了我自己的 hacky 方法，尝试重新创建 WooCommerce 自己的产品页面执行的发布事件，同样没有运气。

```
<a id="buy_v" href="#">Buy Variable Product !</a>    
<script>    
   $('#buy_v').click(function(e) {
      e.preventDefault();
      addToCartV(24,26,'Red',1);
      return false;
   });    
   function addToCartV(p_id, v_id, c, q) {    
    $.ajax({
      type: 'POST',
      url: '/wp/?product=tee1&add-to-cart=variation&product_id='+p_id,
      data: { 'attribute_colour': c,
              'variation_id':  v_id,
              'quantity':  q,
              'product_id':  p_id},
      success: function(response, textStatus, jqXHR){
            // log a message to the console
            console.log("It worked!");
        }/*,
      dataType: 'JSON'*/
    });    
   }   
</script> 
```

任何人都可以建议我可能会出错的地方吗？谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-29T16:04:27.963

上述两个示例实际上都可以正常工作，只是在 WooCommerce 自己的购物车中无法正确显示。

为了使它们正确显示，为第四个参数传入一个数组，该参数似乎代表 WooCommerce 自己的购物车中的变化：

```
$arr = array();
$arr['Color'] = 'Green';
$woocommerce->cart->add_to_cart( 24, 1, 28, $arr, null ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T13:41:30.227

对于其他尝试类似事情的人，这是我的方法。

我创建了一个通过 ajax 调用的脚本，其中包含以下内容：

```
<?php
require_once("../../../wp-blog-header.php");
header("HTTP/1.1 200 OK");
global $woocommerce;

$quantity       = (isset($_REQUEST['qty'])) ? (int) $_REQUEST['qty'] : 1;
$product_id     = (int) apply_filters('woocommerce_add_to_cart_product_id', $_REQUEST['pid']);   
$vid            = (int) apply_filters('woocommerce_add_to_cart_product_id', $_REQUEST['vid']);   

if ($vid > 0) $woocommerce->cart->add_to_cart( $product_id, $quantity, $vid );         
else $woocommerce->cart->add_to_cart( $product_id, $quantity ); 
```

这成功地将产品变体添加到购物车

# zend-framework - Zend_Form_Element_File (no decorator found 错误)

> ID：10802173
> 
> 赞同：0
> 
> 时间：2012-05-29T15:28:06.157
> 
> 标签：zend-framework, zend-form, zend-form-element

我正在创建一个带有上传元素的表单。我用下面的代码创建了文件元素

```
 $image = new Zend_Form_Element_File('image');
 $image->setAttrib('title','Listing Image:')
       ->addDecorator('File')
       ->addValidator('Size', false, 204800)
       ->addValidator('Extension', false, 'jpg,png,gif');

  $this->addElement($image); 
```

据我所知，效果很好。它尝试向页面添加文件元素。我收到一条错误消息，上面写着“警告：未找到文件装饰器...无法在...中呈现文件元素”

如您所见，我已将元素的装饰器设置为文件装饰器，所以我不确定为什么会收到此错误？

值得注意的是，我已经删除了除 viewHelper 和 PrepareElements 之外的所有默认装饰器，并且我使用 view partial 作为 viewHelper 来显示输出。以防万一这是必需的，我还将其包括在下面。

```
<form method="<?php echo $this->element->getMethod(); ?>" action="<?php echo $this->element->getAction(); ?>">
<div class="boxmiddle-Holder">
    <div class="boxmiddle-content">
        <table border="0" cellspacing="2" cellpadding="3" class="dataTable">
            <?php foreach($this->element->getElements() as $element): ?>

                        <!-- if not a button then display label -->
                        <tr>
                            <td><label for="<?php echo $element->getName(); ?>"><?php echo $element->getAttrib('title'); ?></label></td>

                        <td class="normal"><?php echo $element; ?></td>
                        <?php if($element->getMessages()) {
                            foreach($element->getMessages() as $message) { ?>
                                <td> <?php echo "<p class='elementError'>".$message."</p>"; ?></td>
                         <?php    }
                        }
                        ?>
                        </tr>
            <?php endforeach; ?>
       </table>
    </div>
</div> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:52:34.887

我会仔细检查以确保文件装饰器稍后没有被清除或重置，该错误表明您的表单的文件元素没有`Zend_Form_Decorator_File`附加装饰器。

在`Zend/Form/Element/File.php`第 859 行查看引发此错误的函数。我怀疑 File 装饰器正在以某种方式从元素中删除。可能是它没有装饰器，或者只是缺少`File`装饰器。

希望有帮助。

# x86 - 在 SSE 中使用位集的实现和性能

> ID：10802175
> 
> 赞同：2
> 
> 时间：2012-05-29T15:28:07.533
> 
> 标签：x86, sse, simd, bitset

我正在尝试使用 SSE（在 Visual Studio 上）加快我的方法。我是该地区的新手。我在我的方法中使用的主要数据类型是大小为 32 的位集，我主要使用的逻辑运算是 AND 运算（很少使用 _BitScanForward）。我想知道是否可以使用 SSE 指令来加快我的程序。

这就是我现在正在做的事情（我已经完全完成了，无法直接比较结果）：

我使用 _mm_set_ps 加载操作数（位集）。我在位集上使用 to_ulong() 将它们转换为无符号长整数：

```
__m128 v1 = _mm_set_ps(b1.to_ulong(),b2.to_ulong(),b3.to_ulong(),b4.to_ulong());
__m128 v2 = _mm_set1_ps(b.to_ulong()) 
```

接下来是实际的 AND 操作：

```
__m128 v3 = _mm_and_ps(v1,v2); 
```

在这一点上，我有两个问题：

1.  我这样做的方式（使用 to_ulong() 将位集转换为无符号长整数）是一种好方法吗？我怀疑有很大的开销可能会扼杀我使用 SSE 可能获得的潜在性能改进。

2.  以 4 个位集的形式将 v3 存储回内存的最佳方法是什么？我打算使用 _mm_storeu_ps 内在函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T15:53:51.277

有几件事：

*   如果您的位集基本上是 32 位整数，那么您应该使用合适的整数 SIMD 类型，即`__m128i`，不是浮点 ( `__m128`)

*   `_mm_set_XXX`宏相对昂贵 - 与常规 SSE 内在函数不同，它们可以生成相当多的指令 - 如果您所做的只是一次 AND 操作，那么 _mm_and_XXX 操作带来的任何性能优势都将被`_mm_set_XXX`操作成本所抵消

理想情况下，如果您只想 AND 数组中的一堆位集，那么代码应该如下所示：

```
const int N = 1024;

int32_t b1[N]; // 2 x arrays of input bit sets
int32_t b2[N];
int32_t b3[N]; // 1 x array of output bit sets

for (int i = 0; i < N; i += 4)
{
    __m128i v1 = _mm_loadu_si128(&b1[i]); // load input bits sets
    __m128i v2 = _mm_loadu_si128(&b2[i]);
    __m128i v3 = _mm_and_si128(v1, v2);   // do the bitwise AND
    _mm_storeu_si128(&b3[i], v3);         // store the result
} 
```

如果您只想使用固定掩码就地 AND 一个数组，那么它将简化为：

```
const int N = 1024;

int32_t b1[N]; // input/output array of bit sets

const __m128i v2 = _mm_set1_epi32(0x12345678); // mask

for (int i = 0; i < N; i += 4)
{
    __m128i v1 = _mm_loadu_si128(&b1[i]); // load input bits sets
    __m128i v3 = _mm_and_si128(v1, v2);   // do the bitwise AND
    _mm_storeu_si128(&b1[i], v3);         // store the result
} 
```

注意：为了获得更好的性能，请确保您的输入/输出数组是 16 字节对齐的，然后使用`_mm_load_si128`/`_mm_store_si128`而不是上面未对齐的对应物。

# javascript - 使用 CSS3 进行缩放

> ID：10802176
> 
> 赞同：25
> 
> 时间：2012-05-29T15:28:07.793
> 
> 标签：javascript, jquery, css, touch, coffeescript

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-31T05:59:42.593

我设法让它工作。

[jsFiddle 演示](https://jsfiddle.net/NKyTZ/553/)

在 jsFiddle 演示中，单击图像表示以单击点为中心的捏合手势。随后的点击以恒定的量增加比例因子。为了使它有用，您可能希望在转换事件上更频繁地进行缩放和转换计算（hammer.js 提供了一个）。

让它工作的关键是正确计算相对于图像的比例坐标点。我用来`event.clientX/Y`获取屏幕坐标。以下行将屏幕坐标转换为图像坐标：

```
x -= offset.left + newX
y -= offset.top + newY 
```

然后我们计算图像的新尺寸并找到要平移的距离。平移方程取自[Stephen Woods 的演讲](http://www.yuiblog.com/blog/2012/02/23/video-stephen-woods-html5-touch)。

```
newWidth = image.width() * scale
newHeight = image.height() * scale

newX += -x * (newWidth - image.width) / newWidth
newY += -y * (newHeight - image.height) / newHeight 
```

最后，我们缩放和翻译

```
image.css '-webkit-transform', "scale3d(#{scale}, #{scale}, 1)"         
wrap.css '-webkit-transform', "translate3d(#{newX}px, #{newY}px, 0)" 
```

我们在包装元素上进行所有翻译，以确保翻译原点位于图像的左上角。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-10T22:00:21.963

我使用hammer和jquery成功地使用该片段来调整phonegap上的图像大小。

如果有人感兴趣，我将其翻译为 JS。

```
function attachPinch(wrapperID,imgID)
{
    var image = $(imgID);
    var wrap = $(wrapperID);

    var  width = image.width();
    var  height = image.height();
    var  newX = 0;
    var  newY = 0;
    var  offset = wrap.offset();

    $(imgID).hammer().on("pinch", function(event) {
        var photo = $(this);

        newWidth = photo.width() * event.gesture.scale;
        newHeight = photo.height() * event.gesture.scale;

        // Convert from screen to image coordinates
        var x;
        var y;
        x -= offset.left + newX;
        y -= offset.top + newY;

        newX += -x * (newWidth - width) / newWidth;
        newY += -y * (newHeight - height) / newHeight;

        photo.css('-webkit-transform', "scale3d("+event.gesture.scale+", "+event.gesture.scale+", 1)");      
        wrap.css('-webkit-transform', "translate3d("+newX+"px, "+newY+"px, 0)");

        width = newWidth;
        height = newHeight;
    });

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-02T15:03:44.543

我查看了整个互联网和外部网络，直到我遇到唯一有效的插件/库 - [http://cubiq.org/iscroll-4](http://cubiq.org/iscroll-4)

```
var myScroll;
myScroll = new iScroll('wrapper'); 
```

其中 wrapper 是您的 id，如 id="wrapper"

```
<div id="wrapper">
    <img src="smth.jpg" />
</div> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-01T13:34:12.603

不是真正的答案，而是指向为您完成所有工作的插件的链接。做得好！

[https://github.com/timmywil/jquery.panzoom](https://github.com/timmywil/jquery.panzoom)

（感谢'Timmywil'，无论你是谁）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-10T10:21:02.267

这是我几年前用 Java 写的，最近转换为 JavaScript

```
function View()
{
 this.pos = {x:0,y:0};
 this.Z = 0;
 this.zoom = 1;
 this.scale = 1.1;
 this.Zoom = function(delta,x,y)
 {
  var X = x-this.pos.x;
  var Y = y-this.pos.y;
  var scale = this.scale;
  if(delta>0) this.Z++;
  else
  {
   this.Z--;
   scale = 1/scale;
  }
  this.zoom = Math.pow(this.scale, this.Z);
  this.pos.x+=X-scale*X;
  this.pos.y+=Y-scale*Y;
 }
} 
```

`this.Zoom = function(delta,x,y)`需要：

*   `delta`= 放大或缩小
*   `x`= 缩放原点的 x 位置
*   `y`= 缩放原点的 y 位置

一个小例子：

```
<script>
var view = new View();
var DivStyle = {x:-123,y:-423,w:300,h:200};
function OnMouseWheel(event)
{
 event.preventDefault();
 view.Zoom(event.wheelDelta,event.clientX,event.clientY);
 div.style.left = (DivStyle.x*view.zoom+view.pos.x)+"px";
 div.style.top = (DivStyle.y*view.zoom+view.pos.y)+"px";
 div.style.width = (DivStyle.w*view.zoom)+"px";
 div.style.height = (DivStyle.h*view.zoom)+"px";
}
function OnMouseMove(event)
{
 view.pos = {x:event.clientX,y:event.clientY};
 div.style.left = (DivStyle.x*view.zoom+view.pos.x)+"px";
 div.style.top = (DivStyle.y*view.zoom+view.pos.y)+"px";
 div.style.width = (DivStyle.w*view.zoom)+"px";
 div.style.height = (DivStyle.h*view.zoom)+"px";
}
</script>
<body onmousewheel="OnMouseWheel(event)" onmousemove="OnMouseMove(event)">
<div id="div" style="position:absolute;left:-123px;top:-423px;width:300px;height:200px;border:1px solid;"></div>
</body> 
```

这是为了与画布和图形一起使用而制作的，但它应该适用于正常的 HTML 布局

# c# - 处理队列中或每个接收到的数据包中的 UDP 数据包

> ID：10802177
> 
> 赞同：2
> 
> 时间：2012-05-29T15:28:10.333
> 
> 标签：c#

我有一个接收 UDP 数据包并处理它们的 UDP“服务器”。

我现在实现它的方式是，每当我收到一个数据包时都会引发一个事件，并在某个线程池线程上处理每个数据包。处理相当简单，我怀疑它比数据包进来的速度要快得多。

我现在有另一个应用程序，其中数据包的速率可以更高，我想知道一般来说有一个数据包队列是否会更好，并以更大量的方式处理数据包，而不是引发事件每次收到。

你对这个问题有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T18:30:55.933

好吧，如果您期望有很多数据包，那么在新线程中处理每个数据包可能不是一个很好的选择。您可以制作生产者/消费者系统。您的 UDP 数据包接收模块将是生产者，它将产生数据包（推入某种队列），然后您可以拥有一个读取数据包并处理它的消费者。这将是一种更快、更具可扩展性的选项，您可以运行多个消费者线程来处理数据包。

如果可以的话，以批量方式处理数据包总是更好。

# javascript - Highcharts Gauge：标签半径样式

> ID：10802180
> 
> 赞同：3
> 
> 时间：2012-05-29T15:28:18.220
> 
> 标签：javascript, html, highcharts

在我的浏览器 (Firefox 12) 中，这个Highcharts 图表[示例](http://jsfiddle.net/highcharts/QeJGx/)看起来不正确。标签的样式与背景半径不同。

Highcharts 中是否有任何选项可以解决此问题？

提前谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T16:33:32.947

是的，标签上有可以解决此问题的选项。如果您根据以下代码格式化标签，则标签应围绕仪表正确弯曲。

```
labels: {
    step: 2,
        rotation: 'auto',
        align: 'center',
        distance: 15,
        x: 0,
        y: 0
}, 
```

我更新了你的[**jsfiddle**](http://jsfiddle.net/QeJGx/50/)来演示。您缺少**x**和**y**位置偏移量。

# jquery - jQuery 事件在 mouseup 时停止

> ID：10802184
> 
> 赞同：5
> 
> 时间：2012-05-29T15:28:31.810
> 
> 标签：jquery, mousedown, mouseup

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T15:35:12.800

您所要做的就是从表格单元中绑定和取消绑定事件。

```
 var currentColor;
    $('.colors').click(function() {
        $(this).fadeTo("fast", 0.40);
        currentColor = $(this).css("background-color");
        $('.colors').not(this).fadeTo("fast", 1);
    });

    $('table').mousedown(
    function() {
        $('td').bind('hover', function(){
            $(this).css(
            "background-color", currentColor
            );            
        });
        }).mouseup(function(){
            $('table td').unbind('hover');
            $('table').css(function(){
                return false;
        });
        });

    $("#reset").click(function() {
        $("td").css("background-color", "white")
    }
    ); 
```

这里正在工作 jsFiddle [http://jsfiddle.net/mFzkG/12/](http://jsfiddle.net/mFzkG/12/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T15:48:20.037

你也可以试试这个 jquery 代码：

```
$('table').mousedown(
function() {
    $('td').bind('mousedown mousemove', function(){
        $(this).css(
        "background-color", currentColor
        );            
    });
    });
$('table').mouseup(
    function() {
        $('td').unbind('mousedown mousemove');
    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T15:46:01.087

为什么不这样做：

```
 var currentColor;
    var isMouseDown = false;       
    $('.colors').click(function() {
        $(this).fadeTo("fast", 0.40);
        currentColor = $(this).css("background-color");
        $('.colors').not(this).fadeTo("fast", 1);
    });
    $('td').mousedown(function() {        
        isMouseDown = true;
    });
    $('td').mouseup(function() {
        isMouseDown = false;
    });
    $('td').hover(function() {
        if (isMouseDown) {
            $(this).css("background-color", currentColor);    
        }
    });
    $("#reset").click(function() {
        $("td").css("background-color", "white")
    }); 
```

所以，我认为正确的实现是捕获`mouseup`/`mousedown`事件，将状态保存在变量中并在函数`isMouseDown`中检查这个变量。`hover()`

# iphone - 合并两个 UIImage 比 CGContextDrawImage 更快

> ID：10802189
> 
> 赞同：6
> 
> 时间：2012-05-29T15:28:38.403
> 
> 标签：iphone, objective-c, ios, ipad

我将两个 UIImage 合并到一个上下文中。它可以工作，但执行速度很慢，我需要一个更快的解决方案。`mergeImage: withImage:`因为我的解决方案是在 iPad 1G 上拨打电话大约需要 400 毫秒。

这就是我所做的：

```
-(CGContextRef)mergeImage:(UIImage*)img1 withImage:(UIImage*)img2
{
    CGSize size = [ImageToolbox getScreenSize];
    CGContextRef context = [ImageToolbox createARGBBitmapContextFromImageSize:CGSizeMake(size.width, size.height)];

    CGContextSetRenderingIntent(context, kCGRenderingIntentSaturation);

    CGContextDrawImage(context, CGRectMake(0, 0, size.width, size.height), img1.CGImage);
    CGContextDrawImage(context, CGRectMake(0, 0, size.width, size.height), img2.CGImage);

    return context;
} 
```

这是 ImageToolbox 类的静态方法：

```
static CGRect screenRect;

+ (CGContextRef)createARGBBitmapContextFromImageSize:(CGSize)imageSize
{
    CGContextRef    context = NULL;
    CGColorSpaceRef colorSpace;
    void *          bitmapData;
    int             bitmapByteCount;
    int             bitmapBytesPerRow;

    size_t pixelsWide = imageSize.width;
    size_t pixelsHigh = imageSize.height;

    bitmapBytesPerRow   = (pixelsWide * 4);
    bitmapByteCount     = (bitmapBytesPerRow * pixelsHigh);

    colorSpace = CGColorSpaceCreateDeviceRGB();
    if (colorSpace == NULL)
    {
        fprintf(stderr, "Error allocating color space\n");
        return NULL;
    }

    bitmapData = malloc( bitmapByteCount );
    if (bitmapData == NULL)
    {
        fprintf (stderr, "Memory not allocated!");
        CGColorSpaceRelease( colorSpace );
        return NULL;
    }

    context = CGBitmapContextCreate (bitmapData,
                                     pixelsWide,
                                     pixelsHigh,
                                     8,      // bits per component
                                     bitmapBytesPerRow,
                                     colorSpace,
                                     kCGImageAlphaPremultipliedFirst);
    if (context == NULL)
    {
        free (bitmapData);
        fprintf (stderr, "Context not created!");
    }

    CGColorSpaceRelease( colorSpace );

    return context;
}

+(CGSize)getScreenSize
{
    if (screenRect.size.width == 0 && screenRect.size.height == 0)
    {
        screenRect = [[UIScreen mainScreen] bounds];    

    }
    return CGSizeMake(screenRect.size.height, screenRect.size.width-20);
} 
```

有什么提高性能的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:10:22.773

我肯定会推荐使用 Instruments 来分析什么消息花费的时间最多，这样你就可以真正分解它。另外，我写了几个方法，我认为它们应该用更少的代码做同样的事情，但是你必须把所有的东西都写出来，才能真正保持可定制性。无论如何，他们在这里：

```
-(CGContextRef)mergeImage:(UIImage *)img1 withImage:(UIImage *)img2
{  
  CGSize size = [ImageToolbox getScreenSize];
  CGRect rect = CGRectMake(0, 0, size.width, size.height);

  UIGraphicsBeginImageContextWithOptions(size, YES, 1.0);

  CGContextRef context = UIGraphicsGetCurrentContext();

  CGContextSetRenderingIntent(context, kCGRenderingIntentSaturation);

  [img1 drawInRect:rect];
  [img2 drawInRect:rect];

  UIGraphicsEndImageContext();

  return context;
} 
```

或者，如果您想要立即组合图像：

```
- (UIImage *)mergeImage:(UIImage *)img1 withImage:(UIImage *)img2
{
  CGSize size = [ImageToolbox getScreenSize];
  CGRect rect = CGRectMake(0, 0, size.width, size.height);

  UIGraphicsBeginImageContextWithOptions(size, YES, 1.0);

  CGContextRef context = UIGraphicsGetCurrentContext();

  CGContextSetRenderingIntent(context, kCGRenderingIntentSaturation);

  [img1 drawInRect:rect];
  [img2 drawInRect:rect];

  UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

  UIGraphicsEndImageContext();

  return image;
} 
```

我不知道他们是否会更快，但我真的不知道如何加速你拥有的东西，除非你有仪器配置文件崩溃。

无论如何，我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T08:12:30.337

我没有设法找到一种更快的合并图像的方法。我减小了图像尺寸以使操作更快。

# php - Shell 脚本中的 PHP $_GET/$argv 等价物？

> ID：10802190
> 
> 赞同：0
> 
> 时间：2012-05-29T15:28:40.777
> 
> 标签：php, bash, shell, variables

在`PHP`中，我们可以将一个变量从文件名作为`file.php?key=value`或传递到脚本中`file.php -key=value`。在 Shell 脚本中是否有任何等效的选项可以这样做？

我想在终端中运行脚本；**类似于** `./file.sh -key=value`将变量传递到 shell 脚本以进行进一步处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:35:35.593

和`_GET`shell 参数彼此非常不同。 `_GET`是 HTTP 请求参数的扩展。Shell 脚本在技术上可以处理获取请求并接受查询字符串参数，但我非常怀疑这就是您想要的。相反，您可以将参数传递给脚本，只需用空格分隔它们（并根据需要使用引号）。

您可以使用 shell 中的许多可执行文件来执行此操作。甚至 PHP 脚本也可以接受这些参数，这些参数存储在`argv`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:31:58.077

是的：

```
file.sh value1 value2 
```

`value1`并且`value2`将暴露给脚本中的变量`$1`和`$2`；整个字符串`value1 value2`也将显示在`$*`.

您可以使用`shift`内置的 shell 一次获取一个变量。

# sql - 在 postgresql 中使用流星

> ID：10802191
> 
> 赞同：20
> 
> 时间：2012-05-29T15:28:41.927
> 
> 标签：sql, postgresql, meteor

我想使用 Meteor 连接到我们的关系数据库（PostgreSQL）。有没有将 Meteor 连接到其他数据库的经验？

我想我们必须编写自己的连接器才能在 PostgreSQL 中使用 Meteor 的优秀特性。

**更新：** 请参阅下面的答案。由于这个问题仍然受到关注，这里是解决方案的链接。

[https://github.com/meteor-stream/meteor-postgres](https://github.com/meteor-stream/meteor-postgres)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T18:57:41.263

是的，您必须编写自己的连接器。我也在为mysql寻找这样的东西，但我认为，没有人在这方面开始任何努力。我很想知道，在这个方向上正在进行的任何努力。

看看mysql的类似问题。[流星与mysql](https://stackoverflow.com/questions/10605796/meteor-with-mysql/10612133#10612133)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-24T10:50:52.937

不确定您是否仍在寻找它，但这可能会有所帮助：[https ://github.com/meteor-stream/meteor-postgres](https://github.com/meteor-stream/meteor-postgres)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-05-08T04:46:47.790

如果你和我一样，你喜欢 Meteor 但讨厌 Mongo。在 Meteor 的 Trello 路线图 ( [https://trello.com/b/hjBDflxp/meteor-roadmap](https://trello.com/b/hjBDflxp/meteor-roadmap) ) 中，投票最多的功能是 SQL 支持，无论是 PostgreSQL 还是 MySQL。

由于 Meteor 中没有日期，因此我在这里总结了我找到的部分解决方案。

1.- 仅将 SQL 用于客户端查询。

**更新：alasql 现在是一个流星包：

你可以安装alaSQL

```
 meteor add agershun:alasql 
```

AlaSQL 和 Meteor Mongo 集合

现在您可以使用 Meteor 集合作为参数。将 SQL 应用于 Meteor 集合：

```
Template.body.helpers({
   tasks: function () {
     return alasql('SELECT * FROM ?',[Tasks]);
   }
}); 
```

或者您可以使用带有特殊 METEOR() 函数的 find() 选项：

```
return alasql('SELECT * FROM ?',[Tasks]);
return alasql('SELECT * FROM METEOR(?)',[Tasks]);
return alasql('SELECT * FROM METEOR(?,?)',[Tasks,{text:"Hello world!"}]);
return alasql('SELECT * FROM METEOR(?,{text:"Hello world!"})',[Tasks]); 
```

让我们面对现实吧，Mongo 很讨厌普通的数据操作，所以能够使用 SQL 来查询数据（使用 JOINS、GRUP BY 等）会减轻很多痛苦。有一些包可以让您在客户端中使用 SQL，至少用于查询：最简单的是旧的（2010 年）实用程序 SqlLike（[http://www.thomasfrank.se/sqlike.html](http://www.thomasfrank.se/sqlike.html)）。镇上的新玩家是 alaSQL，它由 @agershun ( [https://github.com/agershun/alasql](https://github.com/agershun/alasql) ) 积极开发。SqlLike 的优点是它只有 10k。当然，AlaSQL 功能要强大得多，但是对于在联合和聚合中使用 SQL 替换 mongo sintax，SqlLike 是可以的。

使用它们，您可以在助手中执行以下操作：

```
 productsSold:function(){
    var customerSalesHistory=salesHistory.find({cutomerId:Session.get('currentCustomer')}).fetch();
    var items=products.find().fetch();
    return alasql("select item.name, sales.ordered as sumaVentas from ? sales, ? items
      where items.Id=sales.itemId",[customerSalesHistory,items]);
} 
```

2.- 试验直接 SQL 支持。

一些包试图用 MySql 或 PostgreSQL 替换 Mongo（和 minimongo）。@numtel 的 MySql 包是 Meteor-MySql [https://github.com/numtel/meteor-mysql](https://github.com/numtel/meteor-mysql)，而 PostgreSQL 是 Meteor-pg ( [https://github.com/numtel/meteor-pg](https://github.com/numtel/meteor-pg) )。两者都是解决问题的好尝试，但仍然存在一些问题，并且在某种程度上适应起来很麻烦。

Hack Reactor 的一个团队组建了 Meteor Stream，它的第一个产品是 PostgreSql 与 Meteor 的集成，meteor-postgres ( [https://github.com/meteor-stream/meteor-postgres](https://github.com/meteor-stream/meteor-postgres) )。看起来很不错，在客户端用alaSql代替minimongo。

这两种方法都很好，但它们都有一些问题：

他们打破了对流星的部署。他们非常非常年轻，还没有准备好生产 AFAIK 他们仍然需要对我们习惯的通常的 pub-sub sintax 进行调整，这可能会引发与其他流星包的兼容性问题。3.- 仍然使用 Mongo，但作为 MySql 数据库的简单存储库。

此选项保留 Meteor 的所有特性，并使用 Mongo 作为 MySql 或 PostgreSql 数据库的临时存储库。

[@perak ( https://github.com/perak/mysql-shadow](https://github.com/perak/mysql-shadow) )的 mysql-shadow 是一个绝妙的尝试。它按照它说的做，让 Mongo 与 MySql 双向同步，让你在 MySql 中处理你的数据。

坏消息是开发人员将不会继续维护它，但所做的足以处理简单的场景，您没有复杂的触发器来更新其他表或类似的东西。

对于全功能同步，您可以使用 SymmetricsDS ( [http://www.symmetricds.org](http://www.symmetricds.org) )，这是一个经过很好测试的数据库复制器。当然，这涉及到设置一个新的 java 服务器，但到目前为止，这是确保您能够将 Mongo 数据库转换为真实 MySql、PostgreSQL、SQL Server、Informix 数据库的简单存储库的最佳方法。我还得自己检查。

目前 MySQL Shadow 似乎是一个足够好的解决方案。

这种方法的一个优点是您仍然可以使用所有标准的 Meteor 功能、包、meteor 部署等。除了设置同步机制外，您无需做任何事情，而且您不会破坏任何东西。

此外，如果有一天 Meteor 团队使用了 SQL 集成中筹集的一些资金，您的应用程序更有可能按原样运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-26T19:03:16.083

与您现在要求的最接近的是[Meteor SQL 项目](https://github.com/drorm/meteor-sql)，尽管它目前仅支持 MySQL。

也许您会考虑为支持 Postgres 的项目做出贡献？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-05T23:48:26.130

[您可以使用https://github.com/meteorhacks/npm](https://github.com/meteorhacks/npm)添加对 NPM 包的支持

然后，您可以安装 NPM PG 包 [https://github.com/brianc/node-postgres](https://github.com/brianc/node-postgres)

这对我来说很有效

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-08-24T04:46:10.223

Meteor现在实验性[地支持](https://forums.meteor.com/t/an-early-look-at-sql-in-meteor/8736)PostgreSQL 。

# facebook-graph-api - 获得 facebook 上传照片的扩展权限

> ID：10802197
> 
> 赞同：1
> 
> 时间：2012-05-29T15:29:00.637
> 
> 标签：facebook-graph-api, facebook-apps

在我的 facebook 应用程序中，当用户第一次开始使用它时，该应用程序请求非常基本的权限。在稍后阶段，我需要请求扩展权限以允许该应用上传照片，当我只落在遗留部分时，我正在谷歌搜索：

```
 FB.Connect.showPermissionDialog("photo_upload",permissionHandler); 
```

有人知道如何获得使用新 sdk 上传照片的许可吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T15:36:57.530

没有`photo_upload`权限。`publish_stream`但是，您可以改为使用权限上传照片。`user_photos`并且您可以使用权限查看用户的照片。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T05:28:23.200

要获得用户的扩展权限，有两种方式向用户请求权限。无论哪种方式，最终都是获得用户的许可：

1.  打开一个弹出窗口并询问用户扩展权限

FB.login(function(response) { if (response.authResponse) { // 用户已登录并授予一些权限。 } else { // 用户取消登录或未完全授权。 } }, {scope:'read_stream,发布流，离线访问'}）；

1.  打开一个新窗口并询问用户权限

    window.location="https://www.facebook.com/dialog/permissions.request?app_id=&next=https://apps.facebook.com//&type=user_agent&perms=user_photos,publish_stream,friends_photos&fbconnect=1";

您还需要知道您想从用户那里获得哪些权限。[这](https://developers.facebook.com/docs/authentication/permissions/)是您可以向 facebook 用户询问的权限列表

# visual-studio - Visual Studio 项目类型指南

> ID：10802198
> 
> 赞同：40
> 
> 时间：2012-05-29T15:29:01.663
> 
> 标签：visual-studio, csproj

我下载了一个 Visual Studio 项目，但无法在我的 Visual Studio 2010 副本中打开它。无用的错误消息：

> 此安装不支持项目类型。

打开项目类型需要什么软件？它没有说。

我实际上去阅读了`.csproj`文件，它告诉我它的项目类型

```
<ProjectTypeGuids>{786C830F-07A1-408B-BD7F-6EE04809D6DB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids> 
```

我的意思是从这个随机字符串中识别出我需要什么软件？这绝对是荒谬的。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-29T15:42:50.747

我找到[了一个网站，其中列出了一些](http://www.mztools.com/articles/2008/mz2008017.aspx)Visual Studio 2008 的已知项目类型 GUID。

*   `FAE04EC0-301F-11D3-BF4B-00C04F79EFBC`看起来像一个 Windows C# 项目（可能是一个类库项目？）
*   `786C830F-07A1-408B-BD7F-6EE04809D6DB`似乎是一个[便携式图书馆项目](http://web.archive.org/web/20120829075853/http://www.alexthissen.nl:80/blogs/main/archive/2011/07/07/portable-libraries-for-visual-studio-2010-sp1.aspx)

我同意期望开发人员理解由 GUID 表示的项目类型是很疯狂的，但是提供您下载的代码的人可能已经指出了构建它所需的内容！

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2018-11-26T16:19:27.133

以下是项目类型 GUID 的列表：

*   `8BB2217D-0F2D-49D1-97BC-3654ED321F3B`ASP.NET 5
*   `603C0E0B-DB56-11DC-BE95-000D561079B0`ASP.NET MVC 1
*   `F85E285D-A4E0-4152-9332-AB1D724D3325`ASP.NET MVC 2
*   `E53F8FEA-EAE0-44A6-8774-FFD645390401`ASP.NET MVC 3
*   `E3E379DF-F4C6-4180-9B81-6769533ABE47`ASP.NET MVC 4
*   `349C5851-65DF-11DA-9384-00065B846F21`ASP.NET MVC 5 / Web 应用程序
*   `FAE04EC0-301F-11D3-BF4B-00C04F79EFBC`C＃
*   `9A19103F-16F7-4668-BE54-9A1E7A4F7556`C#（强制使用[SDK 项目系统](https://github.com/dotnet/project-system/blob/master/docs/opening-with-new-project-system.md#project-type-guids)）
*   `8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942`C++
*   `13B669BE-BB05-4DDF-9536-439F39A36129`CPS准系统项目
*   `A9ACE9BB-CECE-4E62-9AA4-C7E7C5BD2124`数据库
*   `4F174C21-8C12-11D0-8340-0000F80270F8`数据库
*   `C8D11400-126E-41CD-887F-60BD40844F9E`数据库
*   `3EA9E505-35AC-4774-B492-AD1749C4943A`部署驾驶室
*   `06A35CCD-C46D-44D5-987B-CF40FF872267`部署合并模块
*   `978C614F-708E-4E1A-B201-565925725DBA`部署设置
*   `AB322303-2255-48EF-A496-5904EB18DA55`部署智能设备驾驶室
*   `F135691A-BF7E-435D-8960-F99683D2D49C`分布式系统
*   `BF6F8E12-879D-49E7-ADF0-5503146B24B8`AOT 中的 Dynamics 2012 AX C#
*   `82B43B9B-A64C-4715-B499-D71E9CA2BD60`可扩展性
*   `F2A71F9B-5D33-465A-A702-920D77279786`F＃
*   `6EC3EE1D-3C4E-46DD-8F32-0CC8E7565705`F#（强制使用[SDK 项目系统](https://github.com/dotnet/project-system/blob/master/docs/opening-with-new-project-system.md#project-type-guids)）
*   `95DFC527-4DC1-495E-97D7-E94EE1F7140D` IL项目
*   `E6FDF86B-F3D1-11D4-8576-0002A516ECE8`##
*   `262852C6-CD72-467D-83FE-5EEB1973A190`脚本
*   `20D4826A-C6FA-45DB-90F4-C717570B9F32`旧版 (2003) 智能设备 (C#)
*   `CB4CE8C6-1BDB-4DC7-A4D3-65A1999772F8`旧版 (2003) 智能设备 (VB.NET)
*   `581633EB-B896-402F-8E60-36F3DA191C85`灯开关项目
*   `8BB0C5E8-0616-4F60-8E55-A43933E57E9C`灯开关
*   `b69e3092-b931-443c-abe7-7e7b65f2a37f`微框架
*   `C1CDDADD-2546-481F-9697-4EA41081F2FC`Office/SharePoint 应用程序
*   `786C830F-07A1-408B-BD7F-6EE04809D6DB`可移植类库
*   `66A26720-8FB5-11D2-AA7E-00C04F688DDE`项目文件夹
*   `D954291E-2A0B-460D-934E-DC6B0785DB48`共享项目
*   `593B0543-81F6-4436-BA1E-4747859CAAE2`共享点 (C#)
*   `EC05E597-79D4-47f3-ADA0-324C4F7C7484`共享点 (VB.NET)
*   `F8810EC1-6754-47FC-A15F-DFABD2E3FA90`SharePoint 工作流
*   `A1591282-1198-4647-A2B1-27E5FF5F6F3B`银光
*   `4D628B5B-2FBC-4AA6-8C16-197242AEB884`智能设备 (C#)
*   `68B1623D-7FB9-47D8-8664-7ECEA3297D4F`智能设备 (VB.NET)
*   `2150E333-8FDC-42A3-9474-1A3956D46DE8`解决方案文件夹
*   `3AC096D0-A1C2-E12C-1390-A8335801FDAB`测试
*   `A5A43C5B-DE2A-4C0C-9213-0A381AF9435A`通用 Windows 类库
*   `F184B08F-C81C-45F6-A57F-5ABD9991F28F`VB.NET
*   `778DAE3C-4631-46EA-AA77-85C1314464D9`VB.NET（强制使用[SDK项目系统](https://github.com/dotnet/project-system/blob/master/docs/opening-with-new-project-system.md#project-type-guids)）
*   `C252FEB5-A946-4202-B1D4-9916A0590387`可视化数据库工具
*   `54435603-DBB4-11D2-8724-00A0C9A8B90C`Visual Studio 2015 安装程序项目扩展
*   `A860303F-1F3F-4691-B57E-529FC101A107`适用于应用程序的 Visual Studio 工具 (VSTA)
*   `BAA0C2D2-18E2-41B9-852F-F413020CAA33`适用于 Office 的 Visual Studio 工具 (VSTO)
*   `2CFEAB61-6A3B-4EB8-B523-560B4BEEF521`网络部署
*   `E24C65DC-7377-472B-9ABA-BC803B73C61A`网站
*   `3D9AD99F-2412-4246-B90B-4EAA41C64699`Windows 通信基础 (WCF)
*   `76F1466A-8B6D-4E39-A767-685A06062A39`Windows Phone 8/8.1 空白/集线器/Webview 应用程序
*   `C089C8C0-30E0-4E22-80C0-CE093F111A43`Windows Phone 8/8.1 应用程序 (C#)
*   `DB03555F-0C8B-43BE-9FF9-57896B3C5E56`Windows Phone 8/8.1 应用程序 (VB.NET)
*   `60DC8134-EBA5-43B8-BCC9-BB4BC16C2548`Windows 演示基础 (WPF)
*   `BC8A1FFA-BEE3-4634-8014-F334798102B3`Windows 应用商店（Metro）应用程序和组件
*   `D954291E-2A0B-460D-934E-DC6B0785DB48`Windows 应用商店应用通用
*   `930C7802-8A8C-48F9-8165-68863BCCD9DD`WiX 设置
*   `14822709-B5A1-4724-98CA-57A101D1B079`工作流 (C#)
*   `D59BE175-2ED0-4C54-BE3D-CDAA9F3214C8`工作流 (VB.NET)
*   `32F31D43-81CC-4C15-9DE6-3FC5453562B6`工作流基础
*   `EFBA0AD7-5A72-4C68-AF49-83D382785DCF`Xamarin.Android / Mono for Android
*   `6BC8ED88-2882-458C-8E55-DFD12B67127B`Xamarin.iOS / MonoTouch
*   `F5B4F3BC-B597-4E2B-B552-EF5D8A32436F`MonoTouch 绑定
*   `6D335F3A-9D43-41b4-9D22-F6F17C4BE596`XNA (视窗)
*   `2DF5C3F4-5A5F-47a9-8E94-23B4456F55E2`XNA (XBox)
*   `D399B71A-8929-442a-A9AC-8BEC78BB2433`XNA (Zune)

其中一些在不同版本的 Visual Studio 下被赋予不同的名称，因此如果您没有看到完全匹配的名称，请查找相似或相关的名称。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-05-30T09:35:56.443

Visual Studio 项目系统体系结构使用 GUID 来识别项目的类型。您可以在下面找到这些在线列表：

*   [INFO：已知项目类型指南列表](http://www.mztools.com/articles/2008/mz2008017.aspx)

*   [Visual Studio 项目 - 项目类型 GUID](http://onlinecoder.blogspot.com/2009/09/visual-studio-projects-project-type.html)

此类 GUID 允许 Visual Studio 识别用户打开的项目类型并使用适当的工具和编辑器。为了更好地理解我的意思 - 例如阅读这篇文章：Open [an ASP.NET MVC project without having ASP.NET MVC installed: The project type is not supported by this installation](http://weblogs.asp.net/leftslipper/archive/2009/01/20/opening-an-asp-net-mvc-project-without-having-asp-net-mvc-installed-the-project-type-is-not-supported-by-this-installation.aspx)

# javascript - 关注表单验证后的第一个无效文本字段

> ID：10802199
> 
> 赞同：1
> 
> 时间：2012-05-29T15:29:08.717
> 
> 标签：javascript, focus, setfocus

我有一个非常标准的 HTML 表单，用于收集用户输入。我有一个提交按钮，它将运行一个 JavaScript 函数 (onClick)，该函数反过来验证用户输入的数据。

该函数如下所示：

```
 function validateForm()
  {
    var isValid = true;

    var txtFirstname = document.getElementById("firstName").value;
    var txtLastname = document.getElementById("lastName").value;
    (etc...)

    /*Validate First Name*/
    if(txtFirstname.length <= 0){
        document.getElementById("lblFirstName").innerHTML=" *";
        isValid = false;
    }
    else{
        document.getElementById("lblFirstName").innerHTML="";
        document.getElementById("firstName").value = txtFirstname;
    }

    /*Validate last Name*/
    if(txtLastname.length <= 0){
        document.getElementById("lblLastName").innerHTML=" *";
        isValid = false;
    }
    else{
        document.getElementById("lblLastName").innerHTML="";
        document.getElementById("lastName").value = txtLastname;
    }

    (etc...)

    if(isValid){
        document.formX.submit();
    }
    else{
        return false 
    }

  } 
```

我的问题是：如何在函数验证表单后将焦点设置在第一个“无效”文本框上？

谢谢，埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-02T10:25:24.097

我搜索 4 它并找到一个更受欢迎的解决方案：

```
`$("#"+document.querySelectorAll(":invalid")[1].id).focus();` 
```

这对我有用。请注意，Firefox 中第一个无效输入的索引是 1 而不是 0。因为在 FF 中，当存在无效输入时，表单无效并计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:33:40.433

如果您在功能上分解您的验证，它会更干净。然后你可以有一个名为“firstInvalidField”的变量，它最初设置为空。在字段失效时，检查 firstInvalidField 是否为空，如果是，请将其设置为相关文本框。如果它不为空，则跳过代码。

验证完成后，如果 firstInvalidField 变量不为 null，则对其调用 .focus() 。

# java - 如何在 VMware sdk 中取消挂起 VM？

> ID：10802200
> 
> 赞同：0
> 
> 时间：2012-05-29T15:29:11.167
> 
> 标签：java, api, vmware

在 VMware 中挂起的相反功能是什么？我正在使用 VI Java API 进行简化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:59:36.220

显然 PowerOn 是 VMWare 中的简历。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-20T11:17:07.833

您可以通过以下命令使用 VI java SDK 启动 VM。

```
virtualMachine.powerOnVM_Task(hostSystem); 
```

# google-analytics - 检测用户是否已登录 LinkedIn 并记录结果

> ID：10802204
> 
> 赞同：1
> 
> 时间：2012-05-29T15:29:41.133
> 
> 标签：google-analytics, linkedin

我想跟踪有多少人访问了我的网站并可能登录了 LinkedIn。根据结果​​，我可能会使用他们的 API 添加一个交互式 LinkedIn 部分。

我已经有 Javascript 逻辑来检测他们是否已登录。我的问题是记录此结果的最佳方法是什么？Google Analytics 可以通过自定义变量或事件检测来做到这一点吗？

我很想报告类似“10,000 次访问我的网站，其中 X 位访问者登录到 LinkedIn”的报告。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:52:50.443

我相信[谷歌分析自定义跟踪变量](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariables)可以解决问题。类似于以下内容：

```
_gaq.push(['_setCustomVar',
  1,              // variable slot
  'LinkedInUser', // variable
  'true',         // value
  1               // variable scope, 1=visitor
]);
_gaq.push(['_trackPageview']); 
```

对于自定义变量（不是说这是初始 GA 页面加载逻辑后用户触发的事件，需要调用 _trackPageview 将数据推送回 GA），或者：

```
_gaq.push(['_trackEvent',
  'PageView',
  'LinkedIn'
]); 
```

对于自定义事件。只需将类似的内容弹出到您的 JS 例程中，以检查经过身份验证的 LinkedIn 用户。

# jakarta-ee - JPA 开发工具

> ID：10802208
> 
> 赞同：-3
> 
> 时间：2012-05-29T15:30:03.070
> 
> 标签：jakarta-ee, servlet-3.0, apache-tomee

我使用 apache tomee、Java EE 6、servlet 3，当我启动服务器 tomee 时出现以下错误：

```
Server TomEE Server at localhost at localhost was unable to start within 45 seconds. If the server requires more time, try increasing the timeout in the server editor. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:40:04.653

这种情况在SO中不止一次出现过。查看控制台输出，看看它是否告诉您任何有用的信息。阅读其他人针对同一问题所做的工作，然后尝试一下。如果您用完了可以尝试的东西，您至少可以发布控制台结果，以便其他更了解的人可能有机会看到您的问题是什么。（同时发布您尝试过的内容和结果，以提供更多信息并明确表明您已经投入了一些工作。）

# python - 用于私人文件传输的 bittorrent 跟踪器服务器 - python

> ID：10802210
> 
> 赞同：3
> 
> 时间：2012-05-29T15:30:13.330
> 
> 标签：python, p2p, file-transfer, bittorrent

我们有一个客户端/服务器应用程序，有时需要将相同的大文件传输到许多不同的客户端。

首先，所有操作都是以最明显的方式完成的，即从客户端将请求发送到的网络服务器 api 提供文件，但一切都是手动完成的。

显着提高错误冗余和传输速度的一个好方法是使用点对点协议，例如 bittorrent。

由于截止日期的限制，尽管我不能在试错过程上花费太多时间。

我找不到任何可以轻松集成到我们的 python api 的简单跟踪器实现。

有没有人知道任何最新的 bittorrent 跟踪器，它足够简单，可以在没有所有口哨声和钟声的情况下工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T19:27:58.093

这是一个用 python 编写的开源跟踪器， [https://github.com/JosephSalisbury/python-bittorrent](https://github.com/JosephSalisbury/python-bittorrent)

根据作者的说法，您需要做的就是：

```
from bittorrent import Tracker
tracker = Tracker()
tracker.run() 
```

仅供参考，这里列出了一些开源跟踪器， [http ://en.wikipedia.org/wiki/Comparison_of_BitTorrent_tracker_software](http://en.wikipedia.org/wiki/Comparison_of_BitTorrent_tracker_software)

海盗湾（世界上最大的追踪器）使用 Opentracker 软件， [http ://en.wikipedia.org/wiki/Opentracker](http://en.wikipedia.org/wiki/Opentracker)

# database - Oracle (ORA-02270) : 此列列表错误没有匹配的唯一键或主键

> ID：10802212
> 
> 赞同：26
> 
> 时间：2012-05-29T15:30:17.010
> 
> 标签：database, oracle, foreign-keys, primary-key

我有两张桌子，`Table JOB`这`Table USER`是结构

```
 CREATE TABLE JOB
 (
   ID       NUMBER NOT NULL ,
   USERID   NUMBER,
   CONSTRAINT B_PK PRIMARY KEY ( ID ) ENABLE
 );

 CREATE TABLE USER
 (
   ID       NUMBER NOT NULL ,
   CONSTRAINT U_PK PRIMARY KEY ( ID ) ENABLE
 ); 
```

现在，我想添加外键约束来`JOB`引用`USER`表，如

```
Alter Table JOB ADD CONSTRAINT FK_USERID FOREIGN KEY(USERID) REFERENCES USER(ID); 
```

这引发`Oracle (ORA-02270) : no matching unique or primary key for this column-list error`了一些调查，似乎我们需要有任何一个`unique key or primary key`约束，`USERID`但我不能有这个，因为一个人`USERID`可以有多个`JOBS`与他相关联，关于如何解决这个问题的任何想法或建议？

研究[了 ORA-02270](http://oraclequirks.blogspot.com/2007/09/ora-02270-no-matching-unique-or-primary.html)和[SO 相关问题](https://stackoverflow.com/q/7521817/164299)

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-05-30T03:33:43.043

ORA-2270 错误是一个简单的逻辑错误：当我们在外键中列出的列与父表上的主键或唯一约束不匹配时，就会发生这种错误。造成这种情况的常见原因是

*   父级完全没有 PRIMARY KEY 或 UNIQUE 约束
*   外键子句引用了父表中的错误列
*   父表的约束是一个复合键，我们没有引用外键语句中的所有列。

您发布的代码中似乎都不是这种情况。但这是一条红鲱鱼，因为您的代码*不会*像您发布的那样运行。从之前的编辑来看，我认为您发布的不是实际代码，而是一些简化的示例。不幸的是，在简化过程中，您已经消除了导致 ORA-2270 错误的任何原因。

```
SQL> CREATE TABLE JOB
 (
   ID       NUMBER NOT NULL ,
   USERID   NUMBER,
   CONSTRAINT B_PK PRIMARY KEY ( ID ) ENABLE
 );  2    3    4    5    6  

Table created.

SQL> CREATE TABLE USER
 (
   ID       NUMBER NOT NULL ,
   CONSTRAINT U_PK PRIMARY KEY ( ID ) ENABLE
 );  2    3    4    5  
CREATE TABLE USER
             *
ERROR at line 1:
ORA-00903: invalid table name

SQL> 
```

该语句失败，因为 USER 是保留关键字，因此我们无法将表命名为 USER。让我们解决这个问题：

```
SQL> 1
  1* CREATE TABLE USER
SQL> a s
  1* CREATE TABLE USERs
SQL> l
  1  CREATE TABLE USERs
  2   (
  3     ID       NUMBER NOT NULL ,
  4     CONSTRAINT U_PK PRIMARY KEY ( ID ) ENABLE
  5*  )
SQL> r
  1  CREATE TABLE USERs
  2   (
  3     ID       NUMBER NOT NULL ,
  4     CONSTRAINT U_PK PRIMARY KEY ( ID ) ENABLE
  5*  )

Table created.

SQL> Alter Table JOB ADD CONSTRAINT FK_USERID FOREIGN KEY(USERID) REFERENCES USERS(ID);   

Table altered.

SQL> 
```

瞧！没有 ORA-2270 错误。

唉，我们在这里无法为您提供更多帮助。您的代码中有错误。你可以在这里发布你的代码，我们中的一个人可以发现你的错误。或者您可以检查自己的代码并自己发现它。

* * *

注意：早期版本的代码将 HOB.USERID 定义为 VARCHAR2(20)。因为 USER.ID 被定义为 NUMBER，所以尝试创建外键会抛出一个不同的错误：

> ORA-02267: 列类型与引用的列类型不兼容

避免不匹配的一种简单方法是使用外键语法来默认列的数据类型：

```
CREATE TABLE USERs
 (
   ID    number NOT NULL ,
   CONSTRAINT U_PK PRIMARY KEY ( ID ) ENABLE
 );

CREATE TABLE JOB
 (
   ID       NUMBER NOT NULL ,
   USERID   constraint FK_USERID references users,
   CONSTRAINT B_PK PRIMARY KEY ( ID ) ENABLE
 ); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-29T15:34:31.603

Job 表中的数据类型 (Varchar2(20)) 与 USER 表中的数据类型不匹配 (NUMBER NOT NULL)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-05-04T11:43:40.593

在我的情况下，问题是由禁用的 PK 引起的。

为了启用它：

1.  我寻找约束名称：

    `SELECT * FROM USER_CONS_COLUMNS WHERE TABLE_NAME = 'referenced_table_name';`

2.  然后我取了约束名称，以便使用以下命令启用它：

    `ALTER TABLE table_name ENABLE CONSTRAINT constraint_name;`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-23T15:23:21.173

我在我的场景中遇到了同样的问题，如下所示：

我首先创建了教科书表

```
create table textbook(txtbk_isbn varchar2(13)
primary key,txtbk_title varchar2(40),
txtbk_author varchar2(40) ); 
```

然后章节表：

`create table chapter(txtbk_isbn varchar2(13),chapter_title varchar2(40), constraint pk_chapter primary key(txtbk_isbn,chapter_title), constraint chapter_txtbook foreign key (txtbk_isbn) references textbook (txtbk_isbn));`

然后主题表：

```
create table topic(topic_id varchar2(20) primary key,topic_name varchar2(40)); 
```

现在，当我想在章节（具有复合主键）和主题（具有单列主键）之间创建一个名为 chapter_topic 的关系时，我遇到了以下查询的问题：

`create table chapter_topic(txtbk_isbn varchar2(13),chapter_title varchar2(40),topic_id varchar2(20), primary key (txtbk_isbn, chapter_title, topic_id), foreign key (txtbk_isbn) references textbook(txtbk_isbn), foreign key (chapter_title) references chapter(chapter_title), foreign key (topic_id) references topic (topic_id));`

解决方案是引用复合外键，如下所示：

`create table chapter_topic(txtbk_isbn varchar2(13),chapter_title varchar2(40),topic_id varchar2(20), primary key (txtbk_isbn, chapter_title, topic_id), foreign key (txtbk_isbn, chapter_title) references chapter(txtbk_isbn, chapter_title), foreign key (topic_id) references topic (topic_id));`

感谢 APC 的帖子，他在帖子中提到了以下声明：

> 造成这种情况的常见原因是
> ——父表完全没有约束
> ——父表的约束是一个复合键，我们没有引用外键语句中的所有列。
> - 引用的 PK 约束存在但已禁用

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-12T12:17:08.107

很可能当您缺少未从父表定义的主键时。然后它发生。

就像在父级中添加主键定义如下：

```
ALTER TABLE "FE_PRODUCT" ADD CONSTRAINT "FE_PRODUCT_PK" PRIMARY KEY ("ID") ENABLE; 
```

希望这会奏效。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-29T18:20:58.420

方案是正确的，User.ID 必须是 User 的主键，Job.ID 应该是 Job 的主键，Job.UserID 应该是 User.ID 的外键。此外，您的命令似乎在语法上是正确的。

那么有什么问题呢？我相信您至少有一个 Job.UserID，它在 User.ID 中没有一对。例如，如果 User.ID 的所有值都是：1,2,3,4,6,7,8 并且 Job.UserID 的值是 5（不在 1,2,3,4,6 之间,7,8，这是 UserID 的可能值），您将无法创建外键约束。解决方案：

```
delete from Job where UserID in (select distinct User.ID from User); 
```

将删除所有不存在用户的作业。您可能希望将这些迁移到包含存档数据的该表的副本。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-02-18T15:05:58.180

我们有以下用于创建新表的脚本：

```
CREATE TABLE new_table
(
id                     NUMBER(32) PRIMARY KEY,
referenced_table_id    NUMBER(32)    NOT NULL,
CONSTRAINT fk_new_table_referenced_table_id
    FOREIGN KEY (referenced_table_id)
        REFERENCES referenced_table (id)
); 
```

我们在执行时遇到了这个错误：

> [42000][2270] ORA-02270: 此列列表没有匹配的唯一键或主键

在我们的案例中，问题是由于禁用了引用表的主键。我们通过以下方式启用了它

```
ALTER TABLE referenced_table ENABLE PRIMARY KEY USING INDEX; 
```

之后我们使用第一个脚本创建了新表，没有任何问题

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-04-11T17:37:51.460

运行此命令时：

```
ALTER TABLE MYTABLENAME MODIFY CONSTRAINT MYCONSTRAINTNAME_FK ENABLE; 
```

我收到了这个错误：

```
ORA-02270: no matching unique or primary key for this column-list
02270\. 00000 -  "no matching unique or primary key for this column-list"
*Cause:    A REFERENCES clause in a CREATE/ALTER TABLE statement
          gives a column-list for which there is no matching unique or primary
          key constraint in the referenced table.
*Action:   Find the correct column names using the ALL_CONS_COLUMNS 
```

引用的表具有匹配类型的主键约束。就我而言，这个错误的根本原因是主键约束被禁用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-29T15:36:50.990

你的 USERID 声明之间的区别不是问题吗

```
JOB: UserID is Varchar
USER: UserID is Number? 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-09-27T04:35:47.780

如果尚未在父表上定义主键，则可能会出现此问题。请尝试在现有表上定义主键。例如：

```
ALTER TABLE table_name
ADD PRIMARY KEY (the_column_which_is_primary_key); 
```

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2015-04-22T10:02:09.633

```
create table articles(code varchar2(30)constraint articles_pk primary key,titre varchar2(30),
support varchar2(30) constraint support_fk references supports(support),type_support varchar2(30),
numeroDePage varchar2(30),datepublication date,categorie varchar2(30)constraint categorie_fk references organismes(categorie),
tendance varchar2(30)constraint tendance_fk references apreciations(tendance)); 
```

# asp.net - 列出项目中使用的所有资源

> ID：10802218
> 
> 赞同：0
> 
> 时间：2012-05-29T15:30:52.430
> 
> 标签：asp.net, resources, project, resx

我想列出 ASP.Net 项目中使用的所有资源。我有几个资源文件 (.resx) 有一些重复，我想知道使用了一个女巫。

我想解析整个项目，寻找资源构建器名称、GetLocalResource、getGlobalResource 方法，但它返回了很多意想不到的东西，比如“使用”部分......

你最简单的解决方案是什么？

非常感谢！

# sql - 交叉表查询错误 | Ms Access 未将 MEMBER_ID 识别为有效字段或表达式

> ID：10802224
> 
> 赞同：1
> 
> 时间：2012-05-29T15:31:16.547
> 
> 标签：sql, ms-access-2007

这是一场噩梦。

我在 MS Access 2007 中创建了这个交叉表查询；该查询在单独运行时完美运行，但是当我将查询添加到其他表时；示例：当我将查询加入到属于其他查询的其他表时，我收到此错误：

```
Ms Access does not Recognized MEMBER_ID as a Valid filed or expression. 
```

我到处搜索，但找不到任何专门针对我的问题或场景的东西。

如果我单独运行查询，它可以工作。

这是代码：

```
TRANSFORM First(MEMBER_PHONE.PHONE_NBR) AS FirstOfPhone_NBR
SELECT MEMBER_PHONE.[MEMBER_ID]
FROM MEMBER_PHONE
WHERE (((MEMBER_PHONE.PHONE_TYPE) In ("CELL","HOME","WORK")))
GROUP BY MEMBER_PHONE.[MEMBER_ID]
PIVOT MEMBER_PHONE.[PHONE_TYPE]; 
```

我怎样才能解决这个问题？

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T17:38:53.150

我认为如果您对交叉表查询采取另一种方法，这可能会起作用。如果您不使用 Access 中的向导，并在标准 (Access) SQL 中构建查询，它看起来像这样

```
SELECT 
    MEMBER_ID,
    FIRST(IIF(MEMBER_PHONE.PHONE_TYPE = "CELL",MEMBER_PHONE.PHONE_NBR,"")) As [CELL],
    FIRST(IIF(MEMBER_PHONE.PHONE_TYPE = "HOME",MEMBER_PHONE.PHONE_NBR,"")) As [HOME],
    FIRST(IIF(MEMBER_PHONE.PHONE_TYPE = "WORK",MEMBER_PHONE.PHONE_NBR,"")) As [WORK]
FROM
    MEMBER_PHONE
WHERE 
    MEMBER_PHONE.PHONE_TYPE In ("CELL","HOME","WORK") 
GROUP BY
    MEMBER_ID 
```

然后，您应该能够链接到 MEMBER_ID 上的其他表/查询。

# .net - for 和 Parallel.For() 进度更新

> ID：10802227
> 
> 赞同：0
> 
> 时间：2012-05-29T15:31:46.487
> 
> 标签：.net, task-parallel-library

为什么我可以这样做...

```
for(int i = 0; i < 100; i++)
{
   // do work here

   ProgressBar.Value = i;
} 
```

...但我不能这样做？

```
object theLock = new object();

Parallel.For(0, 100, delegate(int i)
{
   // do work here

   lock(theLock)
   {
      Invoke((Action) delegate
         {
            ProgressBar.Value = i;
         });
   }
}); 
```

使用`BeginInvoke()`进度条更新延迟到 Parallel.For() 循环结束。这就是我尝试使用`Invoke()`.

我已经考虑过将所有内容封装在Task 中，`Task task = Task.Factory.StartNew(delegate`但在 Task 中停止 Parallel.For() 并不是那么容易。

谢谢。

# android - TableLayout 中的右对齐列

> ID：10802230
> 
> 赞同：1
> 
> 时间：2012-05-29T15:31:53.180
> 
> 标签：android, tablelayout

我想发布一张图片来描述这个问题，但显然我还没有足够的 stackoverflow 声誉，所以我将尝试描述我想要完成的事情。

我有一个 5 列的 TableLayout。它们由公司名称、工作编号、姓氏、图形垂直分隔线和右箭头按钮组成。我希望分隔线和右箭头按钮与屏幕右侧对齐。我希望第 2 列（工作编号）扩大到足以容纳整个数字而不换行。我希望第 1 列（公司名称）和第 3 列（姓氏）填写表格的其余部分，并在它们太大时使用省略号（没有文字换行）。我的表是以编程方式构建的。

目前，每当公司名称过长时，分隔线和右箭头就会被推离屏幕右侧。

这是我的 layout.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent"
          android:orientation="vertical">
<TextView android:id="@+id/searchResultsFoundTextView"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:textSize="16dp"
          android:text="@string/searchResultsLabel"/>
<ScrollView android:layout_width="fill_parent"
            android:layout_height="fill_parent">
    <TableLayout android:id="@+id/searchResultsTableLayout"
                 android:layout_width="fill_parent"
                 android:layout_height="fill_parent"
                 android:layout_marginTop="10dp"
                 android:stretchColumns="1"
                 android:shrinkColumns="0,2" />
</ScrollView>
</LinearLayout> 
```

这是我构建表格的代码：

```
TableLayout table = (TableLayout)findViewById(R.id.searchResultsTableLayout);
for (JobBase job : jobList) {
  TableRow row = new TableRow(this);
  row.setLayoutParams(new TableRow.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT));
  row.setPadding(5, 10, 5, 20);
  table.addView(row);

  TextView customerNameTextView = new TextView(this);
  customerNameTextView.setText(job.getCustomerName());
  customerNameTextView.setEllipsize(TextUtils.TruncateAt.END);
  customerNameTextView.setTextSize(FONT_SIZE);
  customerNameTextView.setPadding(10, 5, 10, 0);
  row.addView(customerNameTextView);

  TextView jobNumberTextView = new TextView(this);
  jobNumberTextView.setText(job.getJobNumber());
  jobNumberTextView.setTextSize(FONT_SIZE);
  jobNumberTextView.setPadding(10, 5, 10, 0);
  row.addView(jobNumberTextView);

  TextView crewLeaderTextView = new TextView(this);
  crewLeaderTextView.setText(job.getCrewLeader().getLastName());
  crewLeaderTextView.setEllipsize(TextUtils.TruncateAt.END);
  crewLeaderTextView.setTextSize(FONT_SIZE);
  crewLeaderTextView.setPadding(10, 5, 10, 0);
  row.addView(crewLeaderTextView);

  ImageView dividerImageView = new ImageView(this);
  dividerImageView.setImageDrawable(getResources().getDrawable(R.drawable.btn_med_hl_div_white));
  dividerImageView.setPadding(10, 10, 10, 0);
  row.addView(dividerImageView);

  Button rightArrowButton = new Button(this);
  rightArrowButton.setBackgroundDrawable(getResources().getDrawable(R.drawable.right_arrow_button));
  rightArrowButton.setPadding(10, 0, 10, 0);
  rightArrowButton.setOnClickListener(new RowSelectedAction(row));
  row.addView(rightArrowButton);

  row.setOnClickListener(new RowSelectedAction(row));
} 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T15:24:39.527

我可以通过 LayoutParams 向第一列添加权重来解决此问题：

```
TextView customerNameTextView = new TextView(this);
customerNameTextView.setText(job.getCustomerName());
// --- Added this statement
customerNameTextView.setLayoutParams(new TableRow.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT, 1f));
// --- 
customerNameTextView.setEllipsize(TextUtils.TruncateAt.END);
customerNameTextView.setTextSize(FONT_SIZE);
customerNameTextView.setPadding(10, 5, 10, 0);
row.addView(customerNameTextView); 
```

第一列现在扩展和收缩，分隔线和按钮始终右对齐。有时客户名称是椭圆形的，有时名称是换行的，但这对我来说并不重要，只要列大小正确。

# c# - System.Data.OleDb 作为 System.Data.OracleClient (C#) 的替代品

> ID：10802235
> 
> 赞同：1
> 
> 时间：2012-05-29T15:31:59.107
> 
> 标签：c#, oracle, oledb, odp.net

由于`System.Data.OracleClient`在 .NET 4.0 中已弃用并且将在框架的未来版本中停止使用，因此我想尝试使用 OleDb 作为替代方案。

访问 Oracle 数据库之间`System.Data.OleDb`和访问时有什么区别？`System.Data.OracleClient`是否`System.Data.OracleClient`提供更多功能？

通过 OleDb 访问 Oracle 是否会继续使用未来的 .NET 框架版本？

注意：我尝试过 ODP.NET，但我遇到了“ [The provider is not compatible with the version of Oracle client](https://stackoverflow.com/questions/659341/the-provider-is-not-compatible-with-the-version-of-oracle-client) ”的问题并且没有设法解决它，这就是为什么我想知道 OleDb 是否可以替代。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:37:09.830

它仅被标记为已弃用，这意味着它将不再由 Microsoft 更新或开发，并且可能会在 .NET 框架的未来版本中被删除。但它仍然在 .NET 4.5 预览版中：

[http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/71e232a7-e845-442e-9e36-f203e14fa196/](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/71e232a7-e845-442e-9e36-f203e14fa196/)

所以在我看来，目前没有必要更改为（昂贵的）第 3 方组件。当然你可以尝试，但我会等到 .NET 4.5 或更高版本的发布，然后看看会有什么可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:49:20.697

您确实需要解决阻止您使用 ODP.Net 的 DLL 版本控制问题。我们在多个企业 Web 应用程序中使用 ODP.Net。除其他外，它是对实体框架的适当支持所必需的。我建议完全卸载并重新安装 Oracle 客户端。

# shell - 扫描以查找活动的工作网络服务器（nmap？）

> ID：10802237
> 
> 赞同：-1
> 
> 时间：2012-05-29T15:32:02.267
> 
> 标签：shell, unix, networking, nmap

我需要一个 nmap 命令或其他实用程序来查找开放站点，以便我可以对它们进行调查。问题是当我使用 nmap 时，它会找到不工作的站点的 IP：

```
nmap -iR 200 -p 80 > scan.txt 
```

我希望它显示在 Google 等结果网站中；亚马逊; 或者其他什么，它们只需要是带有一些内容的实际站点。

提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T15:24:59.060

我不确定我是否收到了您的问题，但是如果您将这些站点的列表存储在文件中，则可以使用以下命令：

```
nmap -iL yourfile -v -oX nmap.xml 
```

此命令会将结果存储在一个 XML 文件中，该文件应该可以帮助您收集所需的信息。

但是，如果您没有列表，并且只想找到“工作”的站点......在这种情况下，我不知道您如何使用 Nmap 做到这一点。Nmap 扫描一个目标。当您扫描 LAN 或 VPN 网络时，主机（站点？）发现工作，但由于站点应该在 Internet 上，因此您的问题没有多大意义。但是我再说一遍，我不太确定我是否理解您的问题。

编辑：好吧，也许现在我明白了你的意思，如果问题是 Nmap 给你错误的结果，你可以尝试使用一些更激进的参数来改进扫描，例如 -A 和 -v。请注意，通过 Internet 扫描随机计算机（尤其是在您进行激进扫描时）可能并不完全合法。老实说，我对此并不真正了解，但我建议您在扫描之前收集更多信息。

# ffmpeg - 使用 FFmpeg 在单独的轨道中创建水印

> ID：10802240
> 
> 赞同：1
> 
> 时间：2012-05-29T15:32:07.050
> 
> 标签：ffmpeg, quicktime

我有一个 PNG（alpha）文件和一个视频文件。我想创建一个视频，其中第一个轨道是图像，第二个轨道是视频（PNG over video）。问题是PNG不保留透明度。

我需要在视频轨道上使用 ffmpeg 在单独的轨道中创建水印 (PNG)。

```
ffmpeg -i base.mov -i logo.png -map 0 -map 1 output.mov 
```

我需要将水印单独放在轨道（流）上，以便使用 quicktime pro 启用或禁用它。

谢谢。

# php - 使用 strpos 查找美元符号

> ID：10802241
> 
> 赞同：0
> 
> 时间：2012-05-29T15:32:09.653
> 
> 标签：php

所以我试图在DOM元素返回的字符串中找到几个特殊字符，例如{，$

当我跑

```
if(strpos("$", $u) === FALSE AND strpos("{", $u) === FALSE AND $u != "#") {
echo "Attempting {$u} ecoded: ".urlencode($u)."<br/>";
return true;
} 
```

但是，当我运行它时，它会打印出来：

```
Attempting register.php ecoded: register.php
Attempting {$url} ecoded: %7B%24url%7D
Attempting $authUrl ecoded: %24authUrl
Attempting services.php ecoded: services.php 
```

所以我尝试使用 HEX 值和 ASCII 但仍然没有运气！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:48:08.217

您已经颠倒了 strpos 的论点。

`int strpos ( string $haystack , mixed $needle [, int $offset = 0 ] )`

只需交换它们，它应该可以按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:36:58.993

$ 是双引号字符串中的特殊字符。您需要使用反斜杠对其进行转义或使用单引号。

```
if(strpos("\$", $u) === FALSE AND strpos("{", $u) === FALSE AND $u != "#") { 
```

或者：

```
if(strpos('$', $u) === FALSE AND strpos("{", $u) === FALSE AND $u != "#") { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:48:24.030

```
$u = 'services.php';

if (preg_match('/[\#\$\{\}]/is', $u))
        echo "Attempting {$u} echoed: ".urlencode($u); 
```

不会有任何回应。

# gwt - 在 tomcat webapps 文件夹中创建临时文件

> ID：10802242
> 
> 赞同：1
> 
> 时间：2012-05-29T15:32:23.273
> 
> 标签：gwt, tomcat, web-applications, war

我有一个在开发模式下完美运行的 Google Web 项目。在这个项目的某个地方，我创建了一些 .xml 文件，我在解析后删除了这些文件。

当我在 Tomcat7 (var/lib/tomcat7/webapps) 中部署我的项目的 .war 文件时（我使用 tomcat 管理来部署它），项目无法创建任何文件。我已经尝试了 webapps 文件夹中所有可能的路径。我什至尝试过 context.getRealPath("/")+"/ROOT/tmp/" 但没有任何反应

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T17:15:24.480

您应该使用 temp 文件夹，而不是尝试直接写入 webapp 的部署目录：

```
ServletContext app = (servlet).getServletContext();
File tmpDir = (File)app.getAttribute("javax.servlet.context.tempdir");
File targetFile = new File(tmpDir, "mytempfile.xml");
... 
```

请记住在 try/catch 块中执行所有操作并在“finally”块中正确清理您的资源，否则您会很抱歉；）

# javascript - jQuery中列的总和

> ID：10802244
> 
> 赞同：6
> 
> 时间：2012-05-29T15:32:33.410
> 
> 标签：javascript, jquery

以下代码不起作用。[正如您在jsfiddle](http://jsfiddle.net/unKDk/)上看到的那样，我需要按列汇总所有内容。怎么了？

### HTML

```
<table id="sum_table" width="300" border="1">
    <tr>
        <td>Apple</td>
        <td>Orange</td>
        <td>Watermelon</td>
    </tr>
    <tr>
        <td class="rowDataSd">1</td>
        <td class="rowDataSd">2</td>
        <td class="rowDataSd">3</td>
    </tr>
    <tr>
        <td class="rowDataSd">1</td>
        <td class="rowDataSd">2</td>
        <td class="rowDataSd">3</td>
    </tr>
    <tr>
        <td class="rowDataSd">1</td>
        <td class="rowDataSd">2</td>
        <td class="rowDataSd">3</td>
    </tr>
    <tr class="totalColumn">
        <td class="totalCol">Total:</td>
        <td class="totalCol">Total:</td>
        <td class="totalCol">Total:</td>
    </tr>
</table> 
```

### Javascript

```
$(document).ready(function(){

   $(".rowDataSd").each(function() {
      newSum.call(this);
    });

});

function newSum() {
    var $table = $(this).closest('table');
    var total = 0;

    $(this).attr('class').match(/(\d+)/)[1];

$table.find('tr:not(.totalColumn) .rowDataSd').each(function()  {
        total += parseInt($(this).html());

});

$table.find('.totalColumn td:nth-child('')').html(total);
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T16:08:01.083

这是一个[jsffile](http://jsfiddle.net/unKDk/13/)。希望这可以帮助

```
 <table id="sum_table" width="300" border="1">
        <tr class="titlerow">
            <td>Apple</td>
            <td>Orange</td>
            <td>Watermelon</td>
        </tr>
        <tr>
            <td class="rowDataSd">1</td>
            <td class="rowDataSd">2</td>
            <td class="rowDataSd">3</td>
        </tr>
        <tr>
            <td class="rowDataSd">1</td>
            <td class="rowDataSd">2</td>
            <td class="rowDataSd">3</td>
        </tr>
        <tr>
            <td class="rowDataSd">1</td>
            <td class="rowDataSd">5</td>
            <td class="rowDataSd">3</td>
        </tr>
        <tr class="totalColumn">
            <td class="totalCol">Total:</td>
            <td class="totalCol">Total:</td>
            <td class="totalCol">Total:</td>
        </tr>
    </table> 
<script>
       var totals=[0,0,0];
        $(document).ready(function(){

            var $dataRows=$("#sum_table tr:not('.totalColumn, .titlerow')");

            $dataRows.each(function() {
                $(this).find('.rowDataSd').each(function(i){        
                    totals[i]+=parseInt( $(this).html());
                });
            });
            $("#sum_table td.totalCol").each(function(i){  
                $(this).html("total:"+totals[i]);
            });

        });
</script> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-29T15:48:05.963

## [jsFiddle 示例](http://jsfiddle.net/unKDk/11/)

为此，我们可以充分利用元素中的`thead`and`tfoot`标签`table`。通过细微的更改，我们有以下内容：

## HTML

```
<table id="sum_table" width="300" border="1">
    <thead>                
        <tr>
            <th>Apple</th>
            <th>Orange</th>
            <th>Watermelon</th>
        </tr>
    </thead>
    <tr>
        <td>1</td>
        <td>2</td>
        <td>3</td>
    </tr>
    <tr>
        <td>1</td>
        <td>2</td>
        <td>3</td>
    </tr>
    <tr>
        <td>1</td>
        <td>2</td>
        <td>3</td>
    </tr>
    <tfoot>
        <tr>
            <td>Total:</td>
            <td>Total:</td>
            <td>Total:</td>
        </tr>
    </tfoot>
</table>​​​​​​​​​​​​​​​ 
```

然后，这使我们能够更具体地定位我们想要的元素，即有多少列，以及“总”单元格是多少。

## JavaScript

```
$(document).ready(function()
{
    $('table thead th').each(function(i)
    {
        calculateColumn(i);
    });
});

function calculateColumn(index)
{
    var total = 0;
    $('table tr').each(function()
    {
        var value = parseInt($('td', this).eq(index).text());
        if (!isNaN(value))
        {
            total += value;
        }
    });

    $('table tfoot td').eq(index).text('Total: ' + total);
}​ 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-29T15:43:10.200

```
$('#sum_table tr:first td').each(function(){
   var $td = $(this); 

    var colTotal = 0;
    $('#sum_table tr:not(:first,.totalColumn)').each(function(){
        colTotal  += parseInt($(this).children().eq($td.index()).html(),10);
    });

    $('#sum_table tr.totalColumn').children().eq($td.index()).html('Total: ' + colTotal);
}); 
```

现场示例：http: [//jsfiddle.net/unKDk/7/](http://jsfiddle.net/unKDk/7/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-29T15:44:56.220

另一种方法：

```
$(document).ready(function(){   
    for (i=0;i<$('#sum_table tr:eq(0) td').length;i++) {
       var total = 0;
        $('td.rowDataSd:eq(' + i + ')', 'tr').each(function(i) {
           total = total + parseInt($(this).text());
        });            
        $('#sum_table tr:last td').eq(i).text(total);
    }

}); 
```

示例：http: [//jsfiddle.net/lucuma/unKDk/10/](http://jsfiddle.net/lucuma/unKDk/10/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-29T15:45:21.167

这很容易通过稍微调整表上的类来完成：

HTML：

```
<table id="sum_table" width="300" border="1">
    <tr>
        <td>Apple</td>
        <td>Orange</td>
        <td>Watermelon</td>
    </tr>
    <tr>
        <td class="col1">1</td>
        <td class="col2">2</td>
        <td class="col3">3</td>
    </tr>
    <tr>
        <td class="col1">1</td>
        <td class="col2">2</td>
        <td class="col3">3</td>
    </tr>
    <tr>
        <td class="col1">1</td>
        <td class="col2">2</td>
        <td class="col3">3</td>
    </tr>
    <tr>
        <td class="total">Total:</td>
        <td class="total">Total:</td>
        <td class="total">Total:</td>
    </tr>
</table>​ 
```

JS：

```
var getSum = function (colNumber) {
    var sum = 0;
    var selector = '.col' + colNumber;

    $('#sum_table').find(selector).each(function (index, element) {
        sum += parseInt($(element).text());
    });  

    return sum;        
};

$('#sum_table').find('.total').each(function (index, element) {
    $(this).text('Total: ' + getSum(index + 1)); 
}); 
```

[http://jsfiddle.net/unKDk/9/](http://jsfiddle.net/unKDk/9/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-29T19:12:46.443

我知道现在已经很好地回答了这个问题，但是在所有答案都出来之前我就开始研究这个解决方案，并想继续发布它。

此解决方案适用于您发布的 HTML，并假设 4 件事：1) 第一行是标题行，2) 最后一行是总计行，3) 每行具有相同的列，以及 4) 列包含整数。在这种情况下，只需要识别表。

```
$(document).ready(function(){
    totalRows("#sum_table");
});

function totalRows(tableSelector) {
    var table = $(tableSelector);
    var rows = table.find("tr");
    var val, totals = [];

    //loop through the rows getting values in the rowDataSd columns
    rows
        .each(function(rIndex) {
            if (rIndex > 0 && rIndex < (rows.length-1)) { //not first or last row
                //loop through the columns
                $(this).find("td").each(function(cIndex) {
                    val = parseInt($(this).html());
                    (totals.length>cIndex) ? totals[cIndex]+=val : totals.push(val);
                });
            }
        })
        .last().find("td").each(function(index) {
            val = (totals.length>index) ? totals[index] : 0;
            $(this).html( "Total: " + val );
        });
}
​
​ 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-29T16:12:42.363

先生给你！[http://jsfiddle.net/47VDK/](http://jsfiddle.net/47VDK/)

# windows-phone-7 - WP7 项目模板单击事件在折叠的 ExpanderView 上触发

> ID：10802249
> 
> 赞同：0
> 
> 时间：2012-05-29T15:32:53.250
> 
> 标签：windows-phone-7, silverlight-toolkit

我正在使用 Silverlight 工具包中提供的 ExpanderView 控件和一些自定义模板。这一切都很好，但是当 ExpanderView 折叠时，我单击展开 ExpanderView 时项目所在的 Header 下方的区域。该项目的点击事件触发。

我怎样才能解决这个问题？我是否应该在 ExpanderView 折叠时以某种方式删除点击命令或删除 ItemPanel 并在展开时再次添加它？

```
<DataTemplate x:Key="CustomItemTemplate">
        <Image delay:LowProfileImageLoader.UriSource="{Binding}" Width="156" Height="95" >
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="Tap">
                    <cmd:EventToCommand Command="{Binding Storage.ImageTapCommand, Source={StaticResource Locator}}" CommandParameter="{Binding}" />
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </Image>
</DataTemplate>

<toolkit:ExpanderView Grid.Column="1" Header="{Binding}"
                  Expander="{Binding}" IsExpanded="{Binding IsExpanded, Mode=TwoWay}"
                  ItemsSource="{Binding Files}" HeaderTemplate="{StaticResource CustomHeaderTemplate}"
                  ExpanderTemplate="{StaticResource CustomExpanderTemplate}"
                  ItemTemplate="{StaticResource CustomItemTemplate}" >
      <toolkit:ExpanderView.ItemsPanel>
             <ItemsPanelTemplate>
                    <toolkit:WrapPanel />
              </ItemsPanelTemplate>
      </toolkit:ExpanderView.ItemsPanel>
</toolkit:ExpanderView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T17:53:43.630

您可以在每次 ExpanderView 展开/折叠时更改每个扩展器项的根 UIElement 的 IsHitTestVisible 属性，也可以在最初绑定 ExpanderView 之后（连接到 ExpanderView.LayoutUpdated 可以正常工作）。这是一个为我解决问题的示例：

```
 private void FixExpanderItemsInteractivity(ExpanderView expanderView)
    {
        foreach (var item in expanderView.Items)
        {
            ContentPresenter contentPresenter = expanderView.ItemContainerGenerator.ContainerFromItem(item) as ContentPresenter;

            if (contentPresenter != null)
            {
                UIElement expanderItemRootElement = VisualTreeHelper.GetChild(contentPresenter, 0) as UIElement;
                if(expanderItemRootElement != null)
                {
                    expanderItemRootElement.IsHitTestVisible = expanderView.IsExpanded;
                }
            }
        }
    }

    private void Expander_Expanded(object sender, RoutedEventArgs e)
    {
        FixExpanderItemsInteractivity(sender as ExpanderView);
    }

    private void Expander_Collapsed(object sender, RoutedEventArgs e)
    {
        FixExpanderItemsInteractivity(sender as ExpanderView);
    }

    private void Expander_LayoutUpdated(object sender, EventArgs e)
    {
        FixExpanderItemsInteractivity(sender as ExpanderView);
    } 
```

# c# - 我可以在 firebug 中看到像 ajax 调用这样的实时 javascript 事件吗？

> ID：10802251
> 
> 赞同：1
> 
> 时间：2012-05-29T15:32:57.640
> 
> 标签：c#, javascript, jquery, asp.net, visual-studio

因此，当我执行 ajax POST 时，我可以看到在 firebug 中触发的东西，我可以看到正在运行的旋转图标，完成后的图标。我可以看到结果或错误等等，你们都知道这笔交易。

有没有办法让它在触发时向我显示每个 javascript 事件？因此，如果我的 Windows onload 中有这样的内容：

```
defaultJs.LoadImages();
defaultJs.CheckAccount(username);
vendorsJs.UpdateSearch(); 
```

理想情况下，我会看到其中的每一个发生，或者能够像您在使用 F10 和 F11 等附加到 WWW 进程时逐步通过 CS 文件一样逐步完成它们。

我的问题是，当我的任务是完成已转移到另一个项目的另一个开发人员的工作时，跟踪另一个人的代码需要多长时间。我基本上必须按照我描述的方式手动阅读代码，或者设置大量的 console.logs 来尝试将此类信息强制转换为我可以阅读的内容。

我希望firebug有一些我没有启用的功能，或者有一个像fiddler这样的程序（你可以看到实时加载的东西）可以为我做。

抱歉，如果这是一个重复的问题，经过一番搜索，我无法找到对我有用的答案。我很感激任何人承诺在这里帮助我。祝你有美好的一天。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:34:56.987

您可以使用 FireBug 调试 JS 代码

![在此处输入图像描述](../Images/079f328dca6f1f4fde1cec62936966f4.png)

[http://getfirebug.com/javascript](http://getfirebug.com/javascript)

# asp.net-mvc-3 - Partialview 不返回排序列表的模型

> ID：10802252
> 
> 赞同：0
> 
> 时间：2012-05-29T15:33:09.027
> 
> 标签：asp.net-mvc-3

我对 MVC 非常非常陌生，所以请耐心等待我的问题，我必须使用以下结构。我有以下型号，设施和地址。设施包含地址的排序列表，为了清楚起见，我减少了属性的数量，

```
public class AppFacility
{
    public AppFacility()
    {
        this.Addresses = new SortedList<string, AppAddress>();
    }

    public SortedList<string, AppAddress> Addresses { get; set; }

    [DisplayNameAttribute("Facility ID")]
    public int FacilityID { get; set; }

    [Required(ErrorMessage = "Facility Name is a required field")]
    [DisplayNameAttribute("Facility Name")]
    public string FacilityName { get; set; }

    [DisplayNameAttribute("Doing Business As")]
    public string Dba { get; set; }

    [DisplayNameAttribute("Nbr. Of Employees")]
    public int NbrOfEmployees { get; set; }
}

public class AppAddress
{
    [DisplayNameAttribute("City")]
    public string City { get; set; }

    [DisplayNameAttribute("State")]
    public string State { get; set; }

    [DisplayNameAttribute("Street Name")]
    public string StreetName { get; set; }
 } 
```

控制器：

```
[HttpPost]        
    public ActionResult FacilityCreate(AppFacility objFacility)
    {
        facilityManager = new Manager.AppFacilityManager();

            if (facilityManager.InsertAppFacility(objFacility))
            {
                return RedirectToAction("FacilityInfo", new { id = objFacility.FacilityID });
            }

        return View((AppFacility)Session["FacilityObject"]);
    } 
```

视图：设施创建

```
@model Model.CORE.BO.AppFacility
<table width="100%" align="center" border="0" class="SectionTables">
<tr>
    <td class="SubtitleHeader">
        Facility
    </td>
</tr>
<tr>
    <td class="SubtitleHeader1">
        Enter Facility Information
    </td>
</tr>
<tr>
    <td align="center">
        @Html.Partial(p_CreateEditAppFacility, Model)         
    </td>         
</tr> 
```

部分视图：p_CreateEditAppFacility：这也包含 p_CreateEditAddress 部分视图。

```
@model Model.CORE.BO.AppFacility 
@using (Html.BeginForm("FacilityCreate", "Form", FormMethod.Post, 
new { id = "saveForm",     name = "saveForm" }))
{      
@Html.ValidationSummary(true)
<div class="main">
    <fieldset>
        <legend>Operator Information</legend>
        <div class="editor-label">
            @Html.Label("Facility Name (Business Name of Operator to Appear): ")
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.FacilityName)
            @Html.ValidationMessageFor(model => model.FacilityName)
        </div>
        <div class="editor-label">
            @Html.Label("Owner's Business Name (If different from Business Name of Operator): ")
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Dba)
            @Html.ValidationMessageFor(model => model.Dba) 
        </div>
        <div class="editor-label">
            @Html.Label("No of Employees:")
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.NbrOfEmployees)
            @Html.ValidationMessageFor(model => model.NbrOfEmployees)
        </div>
    </fieldset>

    <fieldset>
        <legend>Address Information</legend> 
       @{ 
int i = 0;
foreach (KeyValuePair<string, Model.CORE.BO.AppAddress> addressRow in Model.Addresses)
{

        <div class="editor-field">
        @Html.Partial(p_CreateEditAddress, addressRow.Value, new ViewDataDictionary(Html.ViewDataContainer.ViewData) { TemplateInfo = new System.Web.Mvc.TemplateInfo { HtmlFieldPrefix = string.Format("objFacility.Addresses[{0}]", i) } })       
        </div>
    i++;
}
    }
  </fieldset>

    <p>            
        <input id="SaveFacility" name="SaveInfo" type="submit" value="Save Information" />
    </p>
</div> 
```

}

部分视图：p_CreateEditAddress

```
@model Model.CORE.BO.AppAddress
@Html.ValidationSummary(true)

<div class="editor-label">
    @Html.LabelFor(model => model.StreetName)
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.StreetName)
    @Html.ValidationMessageFor(model => model.StreetName)
</div>
<div class="editor-label">
    @Html.LabelFor(model => model.City)
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.City)
    @Html.ValidationMessageFor(model => model.City)
</div>
<div class="editor-label">
    @Html.LabelFor(model => model.State)
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.State)
    @Html.ValidationMessageFor(model => model.State)
</div> 
```

我的问题是，在控制器中，objFacility.Addresses 没有获取为模型 AppAddress 输入的值，它始终为空。AppFacility 被填充了。p_CreateEditAddress 后面的 html 看起来像这样

```
<div class="editor-field">
    <input class="text-box single-line" 
id="objFacility_Addresses_0__StreetName"  
name="objFacility.Addresses[0].StreetName" type="text" value="" />
    <span class="field-validation-valid" 
data-valmsg-for="objFacility.Addresses[0].StreetName" data-valmsg-replace="true"></span>
</div> 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T17:28:47.183

您只需要更改您的部分视图调用以获取正确的前缀。您不给它模型名称，因为默认模型绑定器将创建您的类的实例并查找与项目名称匹配的字段`Request.Form`集合中项目名称匹配的字段。它对您为模型提供的变量名称一无所知，只知道模型类的属性。

试试这个（我把换行符放在可读性中）：

```
@Html.Partial(p_CreateEditAddress, addressRow.Value,
    new ViewDataDictionary(Html.ViewDataContainer.ViewData) {
        TemplateInfo = new System.Web.Mvc.TemplateInfo { 
            HtmlFieldPrefix = string.Format("Addresses[{0}]", i) 
        } 
    }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T17:13:04.950

我猜生成的 HTML 不适合模型绑定。

不应该是`objFacility.Addresses[0].StreetName`但是`Addresses[0].StreetName`。

# asp.net-mvc - 防止文本区域中的二进制数据？

> ID：10802254
> 
> 赞同：1
> 
> 时间：2012-05-29T15:33:21.367
> 
> 标签：asp.net-mvc, asp.net-mvc-2

在管理面板用户发布新新闻和新闻内容用户可以从单词复制图像，该图像将作为二进制数据直接存储到数据库中。所以数据库大小会增加太多。

我想阻止用户输入二进制数据，我的意思是我想让用户只输入字符串，仅此而已。

如何实施？

*（我使用 ASP.NET MVC 2 并使用 [AllowHtml] 属性作为新闻实体的内容属性）*

TNX 前进 :)

# php - Android 从本地 PC 获取结果

> ID：10802255
> 
> 赞同：0
> 
> 时间：2012-05-29T15:33:26.187
> 
> 标签：php, android, android-emulator, localhost

```
InputStream in = null;
try {
    in = urlConnection.getInputStream();
}
BufferedReader reader =new BufferedReader(new InputStreamReader(in));
Log.d("before endfdfdfdtering loop"," ");
StringBuilder str = new StringBuilder();
String line=null;

try {
    str.append(reader.readLine());
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}

try {
    while((line=reader.readLine())!=null)
    {
        str.append(line);
    }
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}

try {
    in.close();
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}

String result=str.toString();

result=result.replaceAll(" ","");
Log.d("before entering loop"," "+result);

boolean flag;
if(result.equals("1"))
    flag = true;
else
    flag = false; 
```

上面写的是我从本地主机获取数据的代码，但我无法理解代码，有人可以解释一下，还告诉我在服务器端（PHP 语言）写什么以在 android 模拟器上发送数据。我已将数据从 android 模拟器发布到服务器，但不知道如何从服务器获取数据到模拟器。

我想将 2 个字符串从服务器发送到 android 模拟器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:54:40.980

我将从这里开始：

[http://developer.android.com/reference/java/lang/StringBuilder.html](http://developer.android.com/reference/java/lang/StringBuilder.html)

和

[http://developer.android.com/reference/java/io/BufferedReader.html](http://developer.android.com/reference/java/io/BufferedReader.html)

java（和androids java）的类有很好的文档记录，当我不确定某些东西是如何工作时，我总是从那里开始。

此外，您在这里拥有东西的方式似乎有点奇怪，但基本上 BufferedReader 将允许您一次从“in”一行读取。您没有在此处包含变量“in”所指的内容，因此很难说实际数据来自何处。但基本上使用 StringBuilder，您一次将一行字符串数据从 BufferedReader 附加到 StringBuilder 中，一旦读取了整个缓冲区，您就可以使用它来获取最终字符串。

也看看这个帖子，

[在 Android 上从服务器读取文本文件](https://stackoverflow.com/questions/2922210/reading-text-file-from-server-on-android)

这将使您了解如何连接到您的服务器并从特定脚本中获取数据。

- 肯

# asp.net-mvc-3 - 刷新 MVC 视图

> ID：10802260
> 
> 赞同：0
> 
> 时间：2012-05-29T15:33:44.747
> 
> 标签：asp.net-mvc-3, razor, page-refresh

我有一个最初请求用户 ID 的小应用程序。然后，此用户 ID 作为参数发送到从数据库返回值的存储过程。我希望这个应用程序每 30 秒刷新一次相同的值。我的问题是，当我刷新时，我丢失了用户 ID。我在这里缺少一些简单的东西吗？

```
public ActionResult Report()
{

  string operatorCode = Request.Form.GetValues("txtOperator")[0].ToString();

  ViewBag.operatorName = (from e in db.employees
                          where e.operator_code == operatorCode
                          select e.name).Max().ToString();            

  ViewData["operatorCode"] = operatorCode;            

  var results =  db.lex_sp_Select_Paintline_FinRew_Operator(operatorCode);

  Response.AddHeader("Refresh", "10");

  return View(results.ToList());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:57:25.233

如何存储在临时会话中，然后在丢失时从那里使用它？

```
 string operatorCode = Request.Form.GetValues("txtOperator")[0].ToString();
    TempData["operatorCode"] = operatorCode;

     if (!String.IsNullOrEmpty(operatorCode))
     {
        TempData["operatorCode"] = operatorCode;

         ViewBag.operatorName = (from e in db.employees
                          where e.operator_code == operatorCode
                          select e.name).Max().ToString();            

   ViewData["operatorCode"] = operatorCode;            

    var results =  db.lex_sp_Select_Paintline_FinRew_Operator(operatorCode);

    Response.AddHeader("Refresh", "10");

    return View(results.ToList());

     }
     else
     {
        var tempCode = TempData["operatorCode"]
        ViewData["operatorCode"] = tempCode;            

        var results =  db.lex_sp_Select_Paintline_FinRew_Operator(tempCode);

        Response.AddHeader("Refresh", "10");

        return View(results.ToList());
     } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:10:09.963

我认为 null 值的主要原因是您尝试刷新 HttpPost，而不是请求（刷新标头不适用于 POSTS）。作为替代方案，我建议您将流程更改为请求，这将导致只需要更改调用代码（获取）并将报告操作更改为：

```
string operatorCode = Request.QueryString["txtOperator"]; 
```

这应该会给你想要的结果，但代价是现在的动作是获取而不是发布。您还可以将 operatorCode 存储在 Session 中（这可能无法很好地扩展）。我可以看到的最后一个选项是在 setInterval() 上运行 ajax 请求并使用该进程向控制器操作发送 POST。

# view - oracle 视图 SYS.ALL_TAB_COLUMNS

> ID：10802263
> 
> 赞同：0
> 
> 时间：2012-05-29T15:33:54.240
> 
> 标签：view, oracle10g, etl

阿罗哈

这是我的目的：我需要在视图中收集有关我的 OracleDB 的一些基本信息。该怎么办 ？要在 ETL 中将其用作模式资源，我可以查询以限定我将翻译和认证的数据。

我没有以 SYS 身份登录。所以，这是我的观点：

```
 CREATE OR REPLACE FORCE VIEW "BRINDAVOINE".FME_SCHEMA_SIGE
   AS
   SELECT S.TABLE_NAME AS "feature_type",
          S.COLUMN_NAME AS "attribute_name",
          CASE S.DATA_TYPE
             WHEN 'BLOB'
             THEN
                'fme_buffer'
             WHEN 'CHAR'
             THEN
                CASE
                   WHEN S.DATA_LENGTH IS NULL THEN 'fme_char(400)'
                   ELSE 'fme_char(' || S.DATA_LENGTH || ')'
                END
             WHEN 'DATE'
             THEN
                'fme_date'
             WHEN 'NUMBER'
             THEN
                CASE
                   WHEN S.DATA_LENGTH IS NULL
                   THEN
                      'fme_decimal(400,'
                   ELSE
                         'fme_decimal('
                      || S.DATA_LENGTH
                      || ','
                      || CASE
                            WHEN S.DATA_PRECISION IS NULL THEN '2)'
                            ELSE S.DATA_PRECISION || ')'
                         END
                END
             WHEN 'VARCHAR2'
             THEN
                CASE
                   WHEN S.DATA_LENGTH IS NULL THEN 'fme_char(400)'
                   ELSE 'fme_char(' || S.DATA_LENGTH || ')'
                END
             WHEN 'NVARCHAR2'
             THEN
                CASE
                   WHEN S.DATA_LENGTH IS NULL THEN 'fme_char(400)'
                   ELSE 'fme_char(' || S.DATA_LENGTH || ')'
                END
             ELSE
                S.DATA_TYPE
          END
             AS "attribute_data_type",
          '' AS "geometry_type"
     FROM SYS.ALL_TAB_COLUMNS S
    WHERE     S.OWNER = 'A_REIMS'
          AND S.TABLE_NAME NOT LIKE '%RELATION'
          AND S.TABLE_NAME IN (SELECT NOM
                                 FROM A_DESIGN_REIMS.APICD_COMPOSANT
                                WHERE NUMERO_MODELE = 1 AND action != 2)
          AND NOT REGEXP_LIKE(S.COLUMN_NAME,
                              '(APIC_.*)|_([STXYLO]|S[GT]|[XY][12])$'); 
```

不幸的是，当我尝试查询时，我收到一条错误消息：错误的“ORA-04063：查看“BRINDAVOINE.FME_SCHEMA_SIGE”comporte des erreurs”。我尝试了 ALTER VIEW BRINDAVOINE.FME_SCHEMA_SIGE COMPILE，但它似乎没有改变。

这是我的问题：可以从 sys."view" 创建视图吗？如果是这样，为什么我不能创建这个视图？

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T17:09:07.770

您应该能够创建查询 SYSTEM 视图的视图。我能够通过删除对 A_DESIGN_REIMS.APICD_COMPOSANT 的引用来编译您的视图（这当然不存在于我的数据库中）。

通过使用 SQLPlus 命令“show errors”（在创建视图之后立即）或通过查询“user_errors”或“all_errors”视图来检查错误。我的猜测是 BRINDAVOINE 用户缺少必要的权限。

# php - 为了让图像出现在这个自定义帖子类型中，我需要添加到这个文件中的 php 代码是什么？

> ID：10802266
> 
> 赞同：-1
> 
> 时间：2012-05-29T15:34:06.513
> 
> 标签：php, wordpress, custom-post-type

我正在使用一个 wordpress 主题，它有一个名为“链接”的自定义帖子类型，它只生成一个帖子，其中标题链接到您指定的外部链接。它还在帖子的正文中包含一些文本。我也希望能够显示图像。现在它没有显示图像。

这是代码：

```
elseif ( has_post_format( 'link' )) {
         if(get_post_meta($post->ID, '_format_link_url', true)!=''){ 
            $link = get_post_meta($post->ID, '_format_link_url', true);
            }else{
            $link = ''; 
            }
        ?>
        <h2 class="entry-title">
        <a href="<?php echo $link; ?>" target="_blank" title="Follow this link">
        <?php the_title(); ?>
        </a> 
        </h2>
        <p> 
```

有什么我可以添加的让它显示图像和文本吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:59:35.430

I can't see anywhere on this example where you are using an tag to insert an image. The img tag has two required attributes, src and alt. Src is the path to your image, whereas alt is the alternate text for the image. So:

```
<img src="images/myImage.png" alt="This Is My Image"/> 
```

Hope that helps!

# matlab - 如何计算几个矩阵中的匹配？

> ID：10802269
> 
> 赞同：0
> 
> 时间：2012-05-29T15:34:24.770
> 
> 标签：matlab, matrix, count

进行二分法研究，我必须计算一个条件发生了多少次？
该研究基于两种矩阵，一种具有预测，另一种具有分析数据。
在预测和分析矩阵中，如果满足条件，我们将 1 添加到计数器。对分布在网格中的点重复此过程。MATLAB 中是否有任何函数可以帮助我进行计数或任何支持此过程的脚本？

多谢你们！

编辑：
该案例涉及登记和预测的降水量。当两者都超过阈值时，我认为它是成功的。我将欧洲划分为几个网格点，我必须计算预测正确的次数。我每年也有 50 个预测，因此结果（命中/未命中）必须是累积操作。
我尝试过使用`count`and`sum`函数，但它们减少了矩阵的空间维度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:01:50.283

很难准确地说出您要做什么，但以下内容可能会有所帮助。

```
 forecasted = [ 40 10 50 0 15];
 registered = [ 0 15 30 0 10];
 mismatch = abs( forecasted - registered );
 maxDelta = 10;
 forecastCorrect = mismatch <= maxDelta
 totalCorrectForecasts = sum(forecastCorrect) 
```

结果：

```
forecastCorrect =  

 0     1     0     1     1

 totalCorrectForecasts =

 3 
```

# android - 如何以编程方式打开默认 SMS 收件箱活动？

> ID：10802270
> 
> 赞同：2
> 
> 时间：2012-05-29T15:34:25.250
> 
> 标签：android, android-intent, sms, inbox

我想通过单击我的应用程序中的按钮打开 Android 中的默认短信收件箱。我不想创建自己的活动来显示收件箱消息。我搜索了很多链接，但找不到解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T15:44:23.617

看看这个问题：[launch sms application with an intent](https://stackoverflow.com/questions/2372248/launch-sms-application-with-an-intent)。您可以尝试许多响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T10:28:32.120

```
Intent intent = new Intent(Intent.ACTION_MAIN);
intent.addCategory(Intent.CATEGORY_LAUNCHER);
intent.setClassName("com.android.mms", "com.android.mms.ui.ConversationList"); 
```

# javascript - 在文件名的扩展名之前插入一个字符串

> ID：10802273
> 
> 赞同：34
> 
> 时间：2012-05-29T15:34:29.270
> 
> 标签：javascript, string, split

如何在图像文件名的扩展名之前插入字符串？例如，我需要转换它：

```
../Course/Assess/Responsive_Course_1_1.png 
```

对此：

```
../Course/Assess/Responsive_Course_1_1_large.png 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-29T15:39:13.183

如果我们假设扩展名是文件名中最后一个点之后的任何一系列字母、数字、下划线或破折号，那么：

```
filename = filename.replace(/(\.[\w\d_-]+)$/i, '_large$1'); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2015-07-03T11:34:55.340

**如果文件没有扩展名**，则所有答案都不起作用。这是适用于所有情况的解决方案。

```
function appendToFilename(filename, string){
    var dotIndex = filename.lastIndexOf(".");
    if (dotIndex == -1) return filename + string;
    else return filename.substring(0, dotIndex) + string + filename.substring(dotIndex);
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-05-29T15:39:26.200

使用 javascript lastIndexOf，类似于：

```
var s = "Courses/Assess/Responsive_Cousre_1_1.png";
var new_string = s.substring(0, s.lastIndexOf(".")) + "_large" + s.substring(s.lastIndexOf(".")); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-29T15:37:05.950

```
var s = '../Course/Assess/Responsive_Course_1_1.png'
s.replace(/\.png$/, '_large.png'); 
```

这将完成这项工作。顺便说一句，这里是晚上。:)

**更新：**

更一般的方法是：

```
var s = '../Course/Assess/Responsive_Course_1_1.png';
s.replace(/(\.[^\.]+)$/, '_large$1'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-21T01:46:19.440

$1 匹配没有扩展名的文件名或 $2 匹配扩展名。

```
filename = filename.replace(/^([^.]+)$|(\.[^.]+)$/i, '$1' + "_large" + '$2'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-18T05:25:28.907

对于没有扩展名的文件和包含扩展名的文件。谢谢@paul！

`filename = filename.replace(/^([^.]+)$|(\.[^.]+)$/i, '$1' + "-thumb" + '$2');`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-22T11:15:27.007

如果您不确定传入文件的扩展名是什么，那么这会有所帮助：

```
function renameFileA(imgUrl) {
  var extension = `.${imgUrl.split('.').pop()}`
  var [fileName] = imgUrl.split(extension);
  return `${fileName}_large${extension}`;
};

// this is clean but I don't understand what's going on till I do research ;)
function renameFileB(imgUrl) {
  return imgUrl.replace(/(\.[\w\d_-]+)$/i, '_large$1');
};

var valA = renameFileA('http//www.app.com/img/thumbnails/vid-th.png');
var valB = renameFileB('http//www.app.com/img/thumbnails/vid-th.jpg');

console.log('valA', valA);
console.log('valB', valB);
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-26T23:52:27.540

简单的正则表达式替换

`filename = filename.replace(/(\.[^.]+)$/i, '_large$1')`

# c# - c# 图片调整大小

> ID：10802278
> 
> 赞同：5
> 
> 时间：2012-05-29T15:34:43.600
> 
> 标签：c#, asp.net, image-processing, imageresizer

只是在我的 asp.net 4 Web 表单项目中处理图像上传器/调整器。有谁知道 C# 中用于调整上传图像大小的技术，可以帮助处理小于所需最小尺寸的图像？

显然，如果调整大小，质量会受到怀疑，那么有没有人找到一种方法来创建一个大小合适的新图像，可能是纯白色，然后将原始图像放在白色背景的顶部？

谢谢

**编辑**- 现在 ImageResizer.net 运行良好，但是当图像较小时可以调整大小。有关详细信息，请参阅爱尔兰酋长回答下方的评论：

**最后编辑################**

好吧，我发誓我昨晚试过了，但没有用，所以可能只需要一个干净的浏览器或重启 VS2010，但对于任何有兴趣的人来说，这是我的最终解决方案。关键是`scale=upscalecanvas`：

```
int maxWidth = 400;
int maxHeight = 200;

ImageBuilder.Current.Build(saveLocation, saveLocation, new ResizeSettings("width=" + maxWidth + "&height=" + maxHeight + "&mode=pad&bgcolor=DDDDDD&anchor=middlecenter&scale=upscalecanvas")); 
```

对 ImageResizer.net 的评价不够高 - 很棒的程序

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:36:59.573

最好的库是 ImageResizer。如果这没有帮助，那么您最终将手动尝试...

[在 asp.net 中标准化 jpeg 大小](https://stackoverflow.com/questions/10220781/standardizing-jpeg-size-in-asp-net/10220857#10220857)

# java - 多个安装：单个 pom.xml 中的安装文件

> ID：10802280
> 
> 赞同：17
> 
> 时间：2012-05-29T15:34:46.173
> 
> 标签：java, maven, maven-3

（在回答之前请至少阅读：这是一个*临时措施*！不，我们不想设置本地存储库管理器并手动运行脚本）

我们有一个带有一些依赖项的遗留项目，我们有一个本地副本，包括源代码和 javadoc，并且已被证明在生产中运行良好，但在 Central 中以相同的质量不可用。我们想使用我们已经拥有的那些罐子。

我发现我可以手动运行一个适当复杂的`mvn install:install-file`命令来将工件注入本地机器的存储库中，但我希望它作为我们各种模块的正常 maven 构建的一部分工作。

鉴于我有一个包含多个 jar 的其他空白模块，每个 jar 都需要插入一个`install:install-file` **我应该如何在我的 pom.xml 中执行此操作以完全符合正常的 Maven 构建？**

或者我可以附加多个罐子作为模块的输出并以某种方式附加javadoc和源代码）？

（并且，请不要建议提交到中央或设置本地存储库管理器。这是一个临时解决方案，直到我们有机会升级到更新版本的依赖项）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-29T16:51:41.760

我会想象这样的事情会起作用（这将在每个版本上安装它）：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-install-plugin</artifactId>
            <executions>
                <execution>
                    <id>inst_1</id>
                    <phase>initialize</phase>
                    <goals>
                        <goal>install-file</goal>
                    </goals>
                    <configuration>
                        <!-- config for file 1 -->
                    </configuration>
                </execution>
                <execution>
                    <id>inst_2</id>
                    <phase>initialize</phase>
                    <goals>
                        <goal>install-file</goal>
                    </goals>
                    <configuration>
                        <!-- config for file 2 -->
                    </configuration>
                </execution>
                <!-- execution file 3... -->
            </executions>
        </plugin>            
    </plugins>
</build> 
```

# vba - 基于下一个单元格值的 Excel VBA 条件格式

> ID：10802281
> 
> 赞同：0
> 
> 时间：2012-05-29T15:34:48.297
> 
> 标签：vba, excel

我正在尝试在 Excel 中对字体大小进行一些条件格式设置，但由于无法从格式菜单中完成，因此需要使用 VBA 完成。

我有一个 B6 到多行的范围，我想查看它旁边的单元格，看看它是否为空白（C 列）。如果是，则将单元格格式化为粗体和 11pt。如果它不是空白，那么它需要是正常的和 9pt。

我现在的代码只使最后一行粗体和 11pt 以及该列的其余部分，即使 C 列为空，也将是正常的 9pt。

出了什么问题？顺便说一句，我正在使用 Excel 2003

```
Dim c As Range, rng
Dim LASTROW As Long

LASTROW = Cells(Rows.Count, 1).End(xlUp).Row

Set rng = Range("B6:B" & LASTROW)
For Each c In rng
    If Len(c.Offset(1, 0)) = 0 Then
        c.Font.Bold = True
        c.Font.Size = 11
    Else
        c.Font.Bold = False
        c.Font.Size = 9
    End If
Next c 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T15:39:07.403

您的偏移参数是向后的。您正在检查当前单元格下方的单元格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T15:45:30.057

![就是这样](../Images/870c1d9f974cf7d616fcf04f2602db6f.png)

请注意，诀窍是使用单个规则，为左上角单元格编码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:40:56.590

这不需要宏 - 您可以使用条件格式中的公式来完成。

假设当 C 列中的单元格的值为“Red”时，您想将 B 列中的相邻单元格突出显示为红色：

```
=IF(C6="Red",TRUE,FALSE) 
```

然后像往常一样用填充手柄填充。

规则编辑器（2007）：

![在此处输入图像描述](../Images/ce57b413ead84610692291153611ad50.png)

# tridion - 如何在 DWT 中呈现组件链接字段？

> ID：10802283
> 
> 赞同：0
> 
> 时间：2012-05-29T15:34:51.777
> 
> 标签：tridion, tridion-2011

我有一个包含组件链接类型的多值字段的模式。

当我为此组件编写 DWT TBB 时，如何呈现此字段（组件链接及其模板）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T16:15:33.577

组件链接字段链接到组件 - 它不指定模板。因此，我假设您要指定要在 DWT 上使用的组件模板。

```
<!-- TemplateBeginRepeat name="Component.Fields.YourComponentLinkFieldName" -->
   @RenderComponentPresentation(Field, "tcm:1-2-32")@@
<!-- TemplateEndRepeat --> 
```

因此，这会遍历多值字段名称的所有值，`YourComponentLinkFieldName`并使用 Component Template 呈现链接到其中的 Component `tcm:1-2-32`。

所有这些主题都与您的问题相关：

1.  [在 Dreamweaver TBB 中检索链接组件的值 - 并将其设为 SiteEditable](https://stackoverflow.com/questions/10256744/retrieving-values-of-a-linked-component-in-dreamweaver-tbb-and-making-it-sitee/10259792#10259792)
2.  [如何在 SDL Tridion 2011 SP1 中处理 Dreamweaver TBB 中的嵌套重复区域](https://stackoverflow.com/questions/10309577/how-to-handle-nested-repeating-regions-in-dreamweaver-tbbs-in-sdl-tridion-2011-s/10322575#10322575)
3.  [在 Dreamweaver TBB 中检索链接组件的值 - 并将其设为 SiteEditable](https://stackoverflow.com/questions/10256744/retrieving-values-of-a-linked-component-in-dreamweaver-tbb-and-making-it-sitee/10259792#10259792)

我建议您阅读它们并应用您对它们的理解。

# objective-c - 如何从 appdelegate 加载选项卡

> ID：10802291
> 
> 赞同：1
> 
> 时间：2012-05-29T15:35:41.427
> 
> 标签：objective-c, ios

我的应用程序将收到推送通知，基本上在 AppDelegate.m 文件中的以下两个函数中，当用户收到推送通知时，我想在我的应用程序中启动或加载一个选项卡。我在应用程序上有几个选项卡，但想显示其中一个。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions

- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo 
```

任何帮助表示赞赏。

# visual-studio-2010 - Visual Studios 2010 发现窗口卡在打开状态

> ID：10802295
> 
> 赞同：0
> 
> 时间：2012-05-29T15:36:18.177
> 
> 标签：visual-studio-2010

出于某种原因，我的 Visual Studios 查找窗口卡在打开状态，我无法移动、调整大小、最小化或关闭它。顶部控制栏不见了。一切仍然有效，但无法最小化或关闭它是一个巨大的痛苦。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T17:53:02.230

想通了，我有双显示器，其中一个通过 USB 到 VGA 转换器连接。如果该监视器上有任何 Visual Studio 窗口，则它不会呈现。我不知道为什么，但解决方案就是不要把视觉工作室放在那个窗口上。

# javascript - 使用 jQuery/Javascript 解析 url

> ID：10802305
> 
> 赞同：-1
> 
> 时间：2012-05-29T15:36:58.967
> 
> 标签：javascript, jquery, parsing, url

我有一个这样的网址：

`/events/3*1*1*0*0*3*3*1/permalink/391013797602909/`

或者这个：

`/*o*i*z*r*g/posts/3804270420760`

我已经审查了事件 ID 和用户 ID。基本上我想获取事件 ID 和永久链接 ID（长号），以及用户 ID 和帖子 ID。我对如何使用 Javascript/jQuery 做到这一点感到困惑。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:40:20.110

使用 .split("/"); 在有问题的网址上。这将返回一个由斜杠分割的字符串数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:51:31.180

如果你有固定的格式，你可以使用 RegExp 来匹配你想要的模式：

```
'/events/3*1*1*0*0*3*3*1/permalink/391013797602909/'
    .match(new RegExp('/events/([0-9*]+)/permalink/([0-9]+)')) 
```

返回 3 个元素的数组，第 2 项是事件，第 3 项是永久链接

```
'/*o*i*z*r*g/posts/3804270420760'
    .match(new RegExp('/([0-9a-z*]+)/posts/([0-9]+)')) 
```

返回 3 个元素的数组，第 2 项是用户 ID，第 3 项是帖子 ID

假设`*`不会在那里，所以你可以从字符范围中删除它:)

# iphone - 更改视图时崩溃（并非总是如此）

> ID：10802310
> 
> 赞同：2
> 
> 时间：2012-05-29T15:37:11.860
> 
> 标签：iphone, xcode, crash, nib

我有一个问题，这是我第一次得到这个错误。我有一个带有数据库的基于导航的应用程序。该应用程序读取数据库并显示内容。有时，当我返回时，`navigationcontroller`我会收到此错误：

> 由于未捕获的异常'NSInternalInconsistencyException'而终止应用程序，原因：'无法在捆绑包中加载NIB：'NSBundle /Users/kikko/Library/ApplicationSupport/iPhone Simulator/5.1/Applications/2A14BA37-78AB-47A9-B92B-5166D6C76B50/FlagsQuiz。名为“Bandiera”的应用程序（已加载）

首先抛出调用堆栈：

> (0x15a1022 0x1732cd6 0x1549a48 0x15499b9 0x303638 0x1a91fc 0x1a9779 0x1a999b 0x1a8fec 0x1cff1d 0x1ba1cb 0x1d0df1 0x1d0ea9 0x3ca508 0x187401 0x18808b 0x3c9d6c 0x1b0857 0x1b09bc 0x1b09fc 0x7f19 0x15a2e99 0xe514e 0xe50e6 0x18bade 0x18bfa7 0x18b266 0x10a3c0 0x10a5e6 0xf0dc4 0xe4634 0x148bef5 0x1575195 0x14d9ff2 0x14d88da 0x14d7d84 0x14d7c9b 0x148a7d8 0x148a88a 0xe2626 0x2182 0x20f5 0x1) terminate called throwing an exception (lldb)

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T18:59:10.883

问题出在您的 NIB 或班迪埃拉班上。在您的目标中检查两次此文件。这是相关的问题[NSInternalInconsistencyException Could not load nib in bundle](https://stackoverflow.com/questions/5415252/nsinternalinconsistencyexception-could-not-load-nib-in-bundle)

# c# - 如何从母版页调用另一个页面中的静态方法

> ID：10802311
> 
> 赞同：0
> 
> 时间：2012-05-29T15:37:15.090
> 
> 标签：c#, asp.net, c#-4.0

我有一个包含这样的静态方法的页面：

```
public partial class _Default : System.Web.UI.Page
{
    [WebMethod(EnableSession = true)]
    public static string Aware()
    {
        return DateTime.Now.ToString();
    }
} 
```

如何从母版页调用此方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:40:06.727

`_Default.Aware()`至于任何其他静态方法

前任：

```
 public partial class About : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            _Default.Aware();
        }
    } 
```

# jquery - 显示 PNG 图像作为对 jQuery AJAX 请求的响应

> ID：10802312
> 
> 赞同：31
> 
> 时间：2012-05-29T15:37:21.020
> 
> 标签：jquery, ajax, image, header, request

是否可以在 HTML 的主流中显示由 jQuery AJAX 调用返回的图像？

我有一个脚本可以绘制带有标题的图像（图像/PNG）。当我在浏览器中简单地调用它时，就会显示图像。

但是当我在这个脚本上使用 jQuery 进行 AJAX 调用时，我无法显示干净的图像，我有很多奇怪的符号。这是我的脚本，它使图像带有标题（图像/PNG）。

```
#!/usr/bin/perl 

use strict;
use CGI;
use Template;
use CGI::Carp qw(fatalsToBrowser);
use lib qw(lib);
use GD;

my $cgi    = new CGI;

my $id_projet            =  $cgi   -> param('id_projet') ;      # 

# Create a new image
my $image = new GD::Image(985,60) || die;
my $red =  $image->colorAllocate(255, 0, 0);
my $black =  $image->colorAllocate(0, 0, 0);

$image->rectangle(0,0,984,59,$black);
$image->string(gdSmallFont,2,10,"Hello $id_projet ",$black);
# Output the image to the browser

print $cgi -> header({-type => 'image/png',-expires => '1d'});

#binmode STDOUT;

print $image->png; 
```

然后我的主脚本里面有一个 AJAX 调用：

```
 <script type="text/javascript" > 

  $(document).ready( function() { 

  $.ajax({
  type: "POST",
  url:'get_image_probes_via_ajax.pl',
  contentType: "image/png",
  data: "id_projet=[% visual.projet.id %]",
  success: function(data){
  $('.div_imagetranscrits').html('<img src="' + data + '" />'); },
 } );

 </script> 
```

在我的 HTML 文件中，我有一个`class="div_imagetranscrits"`要填充我的图像的 div。

我看不出我做错了什么。另一种解决方案是让我的脚本将图像写入磁盘并获取包含在 src 中的路径以显示它。但我认为可以直接从 AJAX 请求中获取带有图像/PNG 标头的图像。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-05-29T15:48:49.373

您需要将图像发送回 base64 编码，看看这个： http: [//php.net/manual/en/function.base64-encode.php](http://php.net/manual/en/function.base64-encode.php)

然后在您的 ajax 调用中将成功函数更改为：

```
$('.div_imagetranscrits').html('<img src="data:image/png;base64,' + data + '" />'); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-05-29T15:41:31.127

## 方法一

您不应该进行ajax调用，只需将img元素的src作为图像的url即可。

如果您使用 GET 而不是 POST，这将很有用

```
<script type="text/javascript" > 

  $(document).ready( function() { 
      $('.div_imagetranscrits').html('<img src="get_image_probes_via_ajax.pl?id_project=xxx" />')
  } );

</script> 
```

* * *

## 方法二

如果您想发布到该图像并按照您的方式进行操作（尝试在客户端解析图像的内容，您可以尝试以下操作：[http ://en.wikipedia.org/wiki/Data_URI_scheme](http://en.wikipedia.org/wiki/Data_URI_scheme)

您需要将其编码`data`为 base64，然后您可以放入`data:[<MIME-type>][;charset=<encoding>][;base64],<data>`img src

例如：

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="Red dot img" /> 
```

要编码为 base64：

*   在纯 javascript 中，请参阅[如何在 JavaScript 中将字符串编码为 Base64？](https://stackoverflow.com/questions/246801/how-can-you-encode-to-base64-using-javascript)
*   在 perl [http://perldoc.perl.org/MIME/Base64.html](http://perldoc.perl.org/MIME/Base64.html)
*   在 php [http://php.net/manual/en/function.base64-encode.php](http://php.net/manual/en/function.base64-encode.php)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-10-30T11:40:37.587

这允许您只获取图像数据并设置为 img src，这很酷。

```
var oReq = new XMLHttpRequest();
oReq.open("post", '/somelocation/getmypic', true );        
oReq.responseType = "blob";
oReq.onload = function ( oEvent )
{
    var blob = oReq.response;
    var imgSrc = URL.createObjectURL( blob );                        
    var $img = $( '<img/>', {                
        "alt": "test image",
        "src": imgSrc
    } ).appendTo( $( '#bb_theImageContainer' ) );
    window.URL.revokeObjectURL( imgSrc );
};
oReq.send( null ); 
```

基本思想是数据未经篡改地返回，它被放置在一个blob中，然后在内存中为该对象创建一个url。见[这里](https://stackoverflow.com/a/10646659/746754)和[这里](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Sending_and_Receiving_Binary_Data)。注意支持的浏览器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-08T10:55:27.537

感谢上面的答案，经过更多的搜索，能够为 Spring Boot 应用程序提供以下解决方案。

HTML

```
<div class="row">
     <div class="col-11" id='img_div'>
     </div>
</div> 
```

Javascript

```
function loadImage() {

        $.ajax({
            type: "GET",
            url: contextPath+"/loadImage",
            data: null,
            dataType: 'text',
            cache: false,
            timeout: 600000,
            success: function (data) {
                $('#img_div').html('<img id="img" src="data:image/png;base64,' + data + '" />');

            },
            error: function (e) {
                //handle error
            }
        });

    } 
```

控制器方法

```
@GetMapping("/loadImage")
@ResponseBody
private String loadImagefromExternalFolder(HttpServletRequest request){     
    String encodedString = "";

    try {       
        RandomAccessFile f =  new RandomAccessFile("C:\\your_folder_path\\your_img.PNG", "r");
        byte[] b = new byte[(int)f.length()];
        f.readFully(b);

        encodedString = Base64.getEncoder().encodeToString(b);

    }catch (Exception e) {
        // handle error
    }

    return encodedString;

} 
```

# google-places-api - 为什么更改传感器值时谷歌地方会返回不同的结果？

> ID：10802314
> 
> 赞同：0
> 
> 时间：2012-05-29T15:37:26.097
> 
> 标签：google-places-api, google-places

我读过场所请求中的传感器参数不会影响结果。但是，如果我使用 sensor=true 进行一次相同的调用，而在另一个使用 sensor=false 时，结果会有所不同。这里的调用是使用 [https://maps.googleapis.com/maps/api/place/search/json?location=46.769967,23.589501&radius=1245&types=establishment&sensor=true&key=YourApiKey](https://maps.googleapis.com/maps/api/place/search/json?location=46.769967,23.589501&radius=1245&types=establishment&sensor=true&key=YourApiKey)

谁能解释为什么会这样？

# ios - 移动到变换视图时保持原始视图方向

> ID：10802316
> 
> 赞同：1
> 
> 时间：2012-05-29T15:37:30.530
> 
> 标签：ios, uiview, cgaffinetransform

![在此处输入图像描述](../Images/33857363e7261073d6c0cac4eedfe09c.png)

![在此处输入图像描述](../Images/ed34f27203321a6c83e5ed92428d4a6a.png)

![在此处输入图像描述](../Images/33e3f1026beb1e92388842d3cb59fd21.png)

在图 1 中，我有一个名为 parentView1 的 UIView（它是灰色视图）。它有子视图（图片中的 4 个）。

在我将 CGAffineTransformRotate 应用到 parentView1 之前，我可以将一个视图（红色垂直）拖放到 parentView1 中，结果如图 2 所示。

但是，如果我首先在 parentView1 上执行 CGAffineTransformRotate（参见代码），然后拖放以将红色垂直视图添加到 parentView1 中，红色垂直视图也会在我下降时立即旋转到与 parentView1 相同的位置（图 3）垂直视图。我不希望它发生。在拖走之前，我需要红色垂直视图与原始视图保持相同的方向。

反过来，同样的效果也会发生：如果 parentView1 已旋转，则将子视图从 parentView1 移动到边界外。

有什么建议吗？

旋转 parentView1 的代码：

```
self.parentView1.transform = CGAffineTransformRotate(self.parentView1.transform, degreesToRadians(45)); 
```

将视图从父视图移动到另一个视图的代码：

```
-(void)getNewPosition2:(UIView *)viewToConvert parentView:(UIView *)parentViewx superParentView:(UIView *)superParentView
{
    CGPoint newPoint = [superParentView convertPoint:viewToConvert.center fromView:parentViewx];
//    viewToConvert.layer.position = newPoint;
    viewToConvert.center = newPoint;
    [viewToConvert removeFromSuperview];
    [superParentView addSubview:viewToConvert];
} 
```

调用上面的 getNewPostition2 方法：

```
[self getNewPosition2:recognizer.view parentView:self.view superParentView:self.parentView1]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T14:41:38.117

我想出了一个解决方案，方法是使用 parentView1 的变换矩阵来计算两种情况的角度：将对象移入和移出 parentView1。

将对象移动到 parentView1：

```
float angle = (2 * M_PI) - atanf(self.parentView1.transform.b / self.parentView1.transform.a );
viewToConvert.transform = CGAffineTransformRotate(viewToConvert.transform, angle); 
```

对于将对象移出 parentView1：

```
float angle = atanf(self.parentView1.transform.b / self.parentView1.transform.a);
viewToConvert.transform = CGAffineTransformRotate(viewToConvert.transform, angle); 
```

# haskell - 为什么即使 MVar 仍然可以访问，指向 MVar 的弱指针仍然是最终确定的？

> ID：10802322
> 
> 赞同：3
> 
> 时间：2012-05-29T15:38:06.727
> 
> 标签：haskell, weak-references

我看到混合 MVar 和 Weak 的问题：即使 MVar 仍然可以从函数的范围访问（并且主线程阻塞它），Weak 认为它应该最终确定。此行为似乎仅在启用优化的情况下编译时发生。

平台：64位Linux

使用 GHC 版本复制：6.10.4、6.12.3、7.0.4、7.2.2、7.4.1

```
module Main (main) where

import           Control.Concurrent
import           Control.Monad (forever, forM_)
import           Data.IORef
import           System.Mem
import           System.Mem.Weak

dispatchPendingCalls :: IORef [Weak (MVar ())] -> IO ()
dispatchPendingCalls ref = forever $ do
    threadDelay 100000

    pending <- atomicModifyIORef ref (\p -> ([], p))
    forM_ pending (\weak -> do
        maybeMVar <- deRefWeak weak
        case maybeMVar of
            Just mvar -> putMVar mvar ()
            Nothing -> putStrLn "dispatchPendingCalls: weak mvar is Nothing")

call :: IORef [Weak (MVar ())] -> IO ()
call ref = do
    mvar <- newEmptyMVar
    weak <- mkWeakPtr mvar (Just (putStrLn "call: finalising weak"))

    putStrLn "call: about to insert weak into list"
    atomicModifyIORef ref (\p -> (weak : p, ()))
    putStrLn "call: inserted weak into list"
    performGC
    takeMVar mvar
    putStrLn "call: took from mvar"

main :: IO ()
main = do
    pendingCalls <- newIORef []
    _ <- forkIO (dispatchPendingCalls pendingCalls)
    call pendingCalls 
```

预期输出：

```
$ ghc --make WeakMvar.hs
$ ./WeakMvar
call: about to insert weak into list
call: inserted weak into list
call: took from mvar
$ 
```

实际输出：

```
$ ghc --make -O2 WeakMvar.hs
$ ./WeakMvar
call: about to insert weak into list
call: inserted weak into list
call: finalizing weak
dispatchPendingCalls: weak mvar is Nothing
(never exits) 
```

为什么会这样？如果我`System.Mem.Weak`正确阅读了文档，那么该`takeMVar mvar`行应该使 mvar 保持活动状态，从而保持其弱指针有效。相反，弱指针认为 MVar在调用返回*之前*变得不可访问。`takeMVar`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-09T03:58:38.490

这几乎可以肯定是因为 GHC 的优化往往会删除终结器所附加的数据结构，从而导致终结器运行得太早。也就是说，终结器引用的是`MVar`数据构造函数，而不是底层的`MVar#`. 当前的[文档](http://www.haskell.org/ghc/docs/latest/html/libraries/base/System-Mem-Weak.html)对此有一些警告。如果我使用`Control.Concurrent.MVar.mkWeakMVar`，我会看到预期的输出（使用 ghc-7.6.3）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:08:54.533

尝试在in 中捕获`BlockedIndefinitelyOnMVar`（默认情况下会处理 IIR，因此您不会看到它）。我猜 using会让 GC 不会注意到你对in的引用，所以它会被垃圾收集？`takeMVar``call``Weak``MVar``dispatchPendingCalls`

# internet-explorer - 如何在 Internet Explorer 中旋转

> ID：10802323
> 
> 赞同：4
> 
> 时间：2012-05-29T15:38:07.183
> 
> 标签：internet-explorer, css, rotation, css-transforms

有没有办法在 IE 中旋转元素？我目前正在使用：

```
 -webkit-transform: rotate(-90deg);
  -moz-transform: rotate(-90deg);
  -ms-transform: rotate(-90deg);
  -o-transform: rotate(-90deg);
  transform: rotate(-90deg); 
```

旋转元素，除了 IE 之外，几乎所有浏览器都可以使用它，并且从我读过的内容来看，IE 不支持此功能。有没有其他选择？例如 JavaScript 或其他将启用旋转的 css 属性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:42:30.877

您可以使用：

```
filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1); 
```

旋转的值可以是 1、2、3 或 4。这些数字分别代表 90、180、270 或 360 度的旋转。

不幸的是，这种技术仅支持以 90 度为增量的旋转，这在尝试执行某些类型的动画或悬停在效果上时肯定很烦人。

您还可以查看不太容易使用的`matrix`过滤器以了解其他旋转效果。这是一个很好的翻译工具来帮助你：

[http://www.useragentman.com/IETransformsTranslator/](http://www.useragentman.com/IETransformsTranslator/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-20T14:04:11.717

我最近在 IE7 和 8 中需要这个，并决定通过编写一小段 JavaScript 来处理计算 IE 特定矩阵值和偏移量的麻烦。

脚本的想法和解释来自这些链接：

[http://www.boogdesign.com/examples/transforms/matrix-calculator.html](http://www.boogdesign.com/examples/transforms/matrix-calculator.html)

[http://extremelysatisfactorytotalitarianism.com/blog/?p=1002](http://extremelysatisfactorytotalitarianism.com/blog/?p=1002)

这是脚本（我使用节点运行它，但您也可以在浏览器的控制台中通过它）：

```
// --- initialization

var w = 712;  // object width
var h = 744;  // object height
var deg = 48; // object rotation in degrees

// --- utils

function deg2rad(deg) {
    return deg * (2 * Math.PI) / 360;
}

var rad = deg2rad(deg);

// --- from http://www.boogdesign.com/examples/transforms/matrix-calculator.html

var costheta = Math.cos(rad);
var sintheta = Math.sin(rad);

var a = parseFloat(costheta).toFixed(8);
var c = parseFloat(-sintheta).toFixed(8);
var b = parseFloat(sintheta).toFixed(8);
var d = parseFloat(costheta).toFixed(8);

console.log('-ms-filter: "progid:DXImageTransform.Microsoft.Matrix(M11=' + a + ', M12=' + c + ', M21=' + b + ', M22=' + d + ', sizingMethod=\'auto expand\')";');
console.log('filter: progid:DXImageTransform.Microsoft.Matrix(M11=' + a + ', M12=' + c + ', M21=' + b + ', M22=' + d + ', sizingMethod=\'auto expand\');');

// --- from http://extremelysatisfactorytotalitarianism.com/blog/?p=1002

// calculate bounding box width and height
var bb_w = Math.abs(h * Math.sin(rad)) + Math.abs(w * Math.cos(rad));
var bb_h = Math.abs(h * Math.cos(rad)) + Math.abs(w * Math.sin(rad));

// calculate offsets
var offset_left = Math.floor((w / 2) - (bb_w / 2));
var offset_top = Math.floor((h / 2) - (bb_h / 2));

console.log('left: ' + offset_left + 'px;');
console.log('top: ' + offset_top + 'px;'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T15:40:59.557

```
filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3); 
```

你可以在**[这里阅读](http://snook.ca/archives/html_and_css/css-text-rotation)**

![在此处输入图像描述](../Images/365b0b299bb0c26dcbe260d8a1d7987a.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-29T15:45:04.300

试试这个，

```
filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1); 
```

还有一个不错的 jQuery 插件，

[jQuery旋转](http://code.google.com/p/jquery-rotate/wiki/Reference)

***PS**代码限制为 90 度旋转但不是插件*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-29T15:41:24.927

您可以使用过滤器：

```
filter: progid:DXImageTransform.Microsoft.Matrix(...); 
```

Matrix 的优点是您可以旋转任意度数，但您需要矩阵值。幸运的是，有一个工具可以做到这一点：

[http://css3please.com/](http://css3please.com/)

编辑：如果你想用 JS 做一些花哨的东西，矩阵条目可以很容易地计算出来：

[http://msdn.microsoft.com/en-us/library/ms533014(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms533014(v=vs.85).aspx)

# c++ - 在 Linux 上的 C++ 应用程序中为 C 接口上的函数起别名

> ID：10802324
> 
> 赞同：1
> 
> 时间：2012-05-29T15:38:09.460
> 
> 标签：c++, c, linux, interface, alias

我正在我的库（GCC 4.4.4-14 ubuntu 5.1）上编译 ac 接口，它基本上看起来像这样

标题

```
extern "C" 
{
  int foo()
} 
```

执行

```
int foo()
{}

int bar() __attribute__((alias ("foo"))); 
```

这编译得很好，但是当我将共享对象链接到测试应用程序并尝试调用 bar() 时，无法识别该函数。

我尝试将别名行从实现移动到标题，然后出现编译器错误：

```
bar() aliased to undefined symbol foo 
```

为什么将别名移动到标头会导致此错误？以及如何让这一切正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:15:24.747

除了上面 booiljoung 的回答之外，您可能还会发现[gcc 网站上](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html)的以下信息很有用：

alias ("target") alias 属性导致声明作为另一个符号的别名发出，必须指定。例如， void **f () { /* 做某事。*/; } void f() _*属性****((weak, alias ("* _f")));

定义`f' to be a weak alias for`_f *'。在 C++ 中，必须使用目标的错位名称。**如果 `*** **_f' 没有在同一个翻译单元中定义，这是一个错误。**

并非所有目标机器都支持此属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:43:47.327

extern "C" 需要执行。

```
extern "C" 
{
  int foo();
}

extern "C" // <<< extern "C" also!!!
{
  int foo()
  {}
}

int bar() __attribute__((alias ("foo"))); 
```

# database - Percona 的 pt-table-sync：如何在多个表上运行？

> ID：10802326
> 
> 赞同：5
> 
> 时间：2012-05-29T15:38:10.817
> 
> 标签：database, percona

在命令行中，这将成功更新 table1：

```
pt-table-sync --execute h=host1,D=db1,t=table1 h=host2,D=db2 
```

但是，如果我想更新多个表，我不确定如何编写它。这也只会更新 table1 并忽略其他表：

```
pt-table-sync --execute h=host1,D=db1,t=table1,table2,table3 h=host2,D=db2 
```

这给了我一个错误：

```
pt-table-sync --execute h=host1,D=db1 --tables table1,table2,table3 h=host2,D=db2 
```

任何人都有一个如何列出'-tables'的例子......以便它成功更新列表中的所有表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-21T22:27:28.537

该`--tables`选项似乎与 DSN 表示法不兼容，您会收到以下错误：

> 您在 h=localhost,D=test 中指定了一个数据库，但没有指定一个表。
> 您是否尝试仅同步“测试”数据库中的表？
> 如果是这样，请改用“--databases test”。

如该错误消息中所建议的，您可以使用`--databases`，然后您可以`--tables`成功使用。

例如，我创建了表`test.foo`，并`test.bar`在每个表中填充了三行，然后从`test.bar`第二台服务器 dewey 中删除了这些行。

我跑了这个：

```
$ pt-table-sync h=huey h=dewey --databases test --tables foo,bar --execute --verbose

# Syncing h=dewey
# DELETE REPLACE INSERT UPDATE ALGORITHM START    END      EXIT DATABASE.TABLE
#      0       0      3      0 Chunk     15:26:15 15:26:15 2    test.bar
#      0       0      0      0 Chunk     15:26:15 15:26:15 0    test.foo 
```

它成功地将 3 个缺失的行重新插入到`test.bar`.

我数据库中的其他表`test`被忽略了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-21T22:00:07.387

这是一个老问题，但我到处寻找答案。pt-table-sync 只做一张表。没有工具可以对表列表或完整数据库模式执行相同的操作。具体来说，我想运行 Live 服务器并能够同步回 Staging 服务器，然后在 Staging 服务器中编辑代码和文件，而不必担心会弄乱 Live 或被 Live 覆盖......我希望它是免费的： )

我最终编写了一个名为 mysql_sync_live_to_stage.sh 的 shell 脚本，如下所示：

```
#!/bin/bash
# sync db live to staging

error_log_file='./mysql_sync_errors.log'
echo $(date +"%Y %m %d %H:%M") > $error_log_file

function sync_table()
{
    pt-table-sync --no-foreign-key-checks --execute 
        h=DB_1_HOST,u=DB_1_USER,p=DB_1_PASSWORD,D=$1,t=$3
        h=DB_2_HOST,u=DB_2_USER,p=DB_2_PASSWORD,D=$2,t=$3 >> $error_log_file
}

# SYNC ALL TABLES IN name_of_live_database
mysql -h "DB_1_HOST" -u "DB_1_USER" -pDB_1_PASSWORD -D "DB_1_DBNAME" -e "SHOW TABLES" | 
        egrep -i '[0-9a-z\-\_]+' | egrep -i -v 'Tables_in' | while read -r table ; do
    echo "Processing $table"
    sync_table "name_of_live_database" "name_of_staging_database" $table
done

# FIX Config Settings For Staging
echo "Cleanup Queries..."
mysql -h "DB_2_HOST" -u "DB_2_USER" -pDB_2_PASSWORD -D "DB_2_DBNAME" 
    -e "UPDATE name_of_staging_database.nameofmyconfigtable SET value='bar' 
    WHERE config_id='foo'"
mysql -h "DB_2_HOST" -u "DB_2_USER" -pDB_2_PASSWORD -D "DB_2_DBNAME" 
    -e "UPDATE name_of_staging_database.nameofmyconfigtable SET value='bar2' 
    WHERE config_id='foo2'"
echo "Done" 
```

这会从实时站点读取表名列表，然后通过 do 循环对每个表名执行同步。它按字母顺序遍历列表，因此我建议保留 --no-foreign-key-checks 标志。

它并不完美......它不会同步两个数据库中都不存在的表，但是当与“git pull -f origin master”结合使用时，我会在几分钟内完成同步。

# python - Python数据结构建议

> ID：10802332
> 
> 赞同：2
> 
> 时间：2012-05-29T15:38:45.570
> 
> 标签：python, dictionary, data-structures

我有一个关于 python 列表/字典的相当基本的问题，我希望得到一些帮助。

我有一些与具有不同特性的电动汽车有关的数据。每个 EV 都有：

*   ID 例如 12345
*   电池大小，例如 24
*   一天中每五分钟的充电状态，例如 00:05:00:1；00:10:00 : 0.95

我该怎么做才最好？我一直在尝试列表/字典的各种组合，但不能完全让它工作。我希望能够通过例如访问数据：

```
EV['ID'][2]['Batt']['SOC'][5] which would return e.g. 0.95 or
EV[12345]['Batt']['SOC'][5] 
```

我最近的尝试是：

```
EV = defaultdict(lambda: defaultdict(dict))

EV['ID']['Batt']['Time']=[]
EV['ID']['Batt']['SOC']=[]
EV['ID']['Batt']['Size'] = 24 
```

但是，这不允许输入另一个列表 admin['ID'] 中的多个 ID。它产生了：

```
{'ID': defaultdict....,{'Batt':{'SOC:[], 'Size':24, 'Time':[]}}}} 
```

我会很感激你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T15:53:22.373

```
from collections import defaultdict
import datetime

class ElectricVehicle(object):
    ev_by_id = {}
    ev_by_battery = defaultdict(list)

    @classmethod
    def find(cls, id=None, battery=None):
        if id is not None:
            return [cls.ev_by_id[id]]
        elif battery is not None:
            return cls.ev_by_battery[battery]
        else:
            return []

    def __init__(self, id, battery, states):
        self.id = id
        ElectricVehicle.ev_by_id[id] = self

        self.battery = battery
        ElectricVehicle.ev_by_battery[battery].append(self)

        self.states = list(states)

    def state_at(self, time):
        return self.states[(time.hour*60 + time.minute)/5]

ElectricVehicle(12345, 24, [0.99, 0.99, 0.99])
ElectricVehicle(12346, 30, [0.90, 0.90, 0.89])

evs = ElectricVehicle.find(battery=24)
for ev in evs:
    time = datetime.time(0,3,0)    # 00:03:00
    print("{}: {}".format(ev.id, ev.state_at(time)))

# will print "12345: 0.99" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T16:04:41.243

完全使用对象可能是一个更好的选择，但这可能取决于细节。要仅使用列表和字典执行此操作，我将执行以下操作：

有一个由车辆 ID 键入的字典，每个条目是一个包含两个条目的字典，`battery`并且`charge`. 该`battery`条目将仅包含电池的大小作为整数或任何需要的大小。该`charge`条目将是从 0 开始索引的电荷读数列表。

```
evs = {10001: {battery: 24, charge: [95, 90, ...]}, 11002: { ... }, ...} 
```

然后您可以从其 ID 中获取给定 EV 的电池大小：

```
evs[id]['battery'] 
```

或者获取给定 ID 在给定时间段内的费用读数：

```
evs[id]['charge'][120] # corresponds to 10:00:00 to 10::05:00 
```

显然，您可以像其他一些海报所建议的那样，制作一个很好的功能来进行时间/索引翻译。

# c# - 为什么 C# Parallel.Invoke 很慢？

> ID：10802333
> 
> 赞同：3
> 
> 时间：2012-05-29T15:38:47.113
> 
> 标签：c#, multithreading, task-parallel-library, task

我正在这样做：

```
 private static void Main(string[] args)
    {
        var dict1 = new Dictionary<int, string>();
        var dict2 = new Dictionary<int, string>();
        DateTime t1 = DateTime.Now;
        for (int i = 1; i < 1000000; i++)
        {
            Parallel.Invoke(
                  () => dict1.Add(i, "Test" + i), 
                  () => dict2.Add(i, "Test" + i) );
        }
        TimeSpan t2 = DateTime.Now.Subtract(t1);

        Console.WriteLine(t2.TotalMilliseconds);

        Console.ReadLine();
    } 
```

所以做一个 for 循环 100 万次并将项目​​添加到两个不同的字典中。问题是它需要 11 秒，是仅需要 2 秒的正常顺序方法（没有任务/线程）的 5 倍多。不知道为什么。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T15:56:35.793

就像其他人所说或暗示的那样，由于并行化的开销，并行代码并不总是更快。

话虽如此，您的代码*将一个项目并行添加到 2 个字典 1M 次*，而您应该*将 1M 项目并行添加到 2 个字典*。差异是微妙的，但最终结果是（在我的机器上）比您的顺序案例快约 10% 的代码。

```
Parallel.Invoke(() => FillDictionary(dict1, 1000000), () => FillDictionary(dict2, 1000000));

...

private static void FillDictionary(Dictionary<int, string> toFill, int itemCount)
{
    for(int i = 0 ; i < itemCount; i++)
        toFill.Add(i, "test" + i);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-29T15:43:13.247

使用并行调用存在一定的开销，并且在多个内核/CPU 之间分配工作的好处。在这种情况下，开销大于分配有用工作的实际收益，这就是您看到显着差异的原因。尝试使用更繁重的操作，您将看到不同之处。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-29T15:59:19.260

将其重写为：

```
Parallel.Invoke(
    () =>
    {
        for (int i = 0; i < 1000000; i++)
        {
            dict1.Add(i, "Test" + i);
        }
    },
    () =>
    {
        for (int i = 0; i < 1000000; i++)
        {
            dict2.Add(i, "Test" + i);
        }
    }
); 
```

这应该会快很多，因为这两个线程只被初始化一次，然后运行完成。在您的版本中，您将调用每个 lambda 表达式 1000000 次，每次都等待两者都完成，然后再继续。

`Parallel.Invoke`真的是为了用于长时间运行的操作。否则，设置并行任务并等待它们全部完成的开销只会扼杀并行运行任务所获得的任何性能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T15:44:56.860

[`Parallel.Invoke`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.parallel.invoke.aspx)意思是“执行所有这些任务并等待它们完成”。在这种情况下，您只会并行执行两个任务。因此，并行调用的开销大于并发的潜在收益。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T16:01:14.373

如果您要做的是将 100000 个项目添加到两个不同的字典中，那么您应该打破任务之间的工作量，而不是方法。此方法与您的代码相同，但在我的机器上比您的实现要快得多：

```
var dict1 = new ConcurrentDictionary<int, string>();
    var dict2 = new ConcurrentDictionary<int, string>();

    Parallel.Invoke(() =>
    {
        for(int i = 0; i < 500000; i++)
        {
            dict1[i] = "Test" +i;
            dict2[i] ="Test" +i;
        }
    },
    () =>
    {
        for(int i = 500000; i < 1000000; i++)
        {
            dict1[i] ="Test" +i;
            dict2[i] = "Test" +i;
        }
    }); 
```

# c++ - 通过引用C++中的类来传递整数

> ID：10802334
> 
> 赞同：2
> 
> 时间：2012-05-29T15:38:58.410
> 
> 标签：c++, pointers, reference

我有一个线程类**Buffer**（自己制作的类），以及许多派生类，如**BufferTypeA**、**BufferTypeB** ...

由于我必须按特定顺序同步它们，因此我给它们中的任何一个提供一个整数，表示运行特定任务的顺序。我还必须在每个线程 Buffer 中知道下一个运行任务的线程，所以我向每个 BufferType 传递一个对所有它们都必须共享的整数的引用，我不想让它成为全局的。

我在任何时候迷路了，我不知道在哪里。

首先，我从一个类中创建所有 BufferTypes，我还将共享整数定义为：

```
int currentThreadOrder; 
```

在创建 BufferTypes 时：

```
int position = 0;
    if (NULL == bufferA) {
            bufferA = new BufferTypeA(&currentThreadOrder, ++position,
                        waitCondition);
        }
        if (NULL == bufferB) {
            bufferB = new BufferPos(&currentThreadOrder, ++position,
                        waitCondition);
        }
        if (NULL == bufferC) {
            bufferC = new BufferRtk(&currentThreadOrder, ++position,
                        waitCondition);
        } 
```

然后，在 BufferTypeA 标头中：

```
class BufferTypeA: public Buffer {
public:
    BufferTypeA(int currentThreadOrder,
            int threadConnectionOrder = 0,
            QWaitCondition *waitCondition = NULL);
//..
} 
```

在 cpp 文件中：

```
BufferTypeA::BufferTypeA(int currentThreadOrder, int threadConnectionOrder, QWaitCondition *waitCondition):
        Buffer(currentThreadOrder, threadConnectionOrder, waitCondition) { } 
```

现在我将显示 Buffer 标头：

```
 class Buffer: public QThread {
    public:
        Buffer(int &currentThreadOrder,
                int threadConnectionOrder = 0,
                QWaitCondition *waitCondition = NULL);
    //...
protected:
    QWaitCondition *waitCondition;
    int threadConnectionOrder;
    int &currentThreadOrder; // Shared address
    } 
```

最后是cpp：

```
Buffer::Buffer(int &currentThreadOrder, int threadConnectionOrder, QWaitCondition *waitCondition) {

    this->threadConnectionOrder = threadConnectionOrder;
    this->waitCondition = waitCondition;
    this->currentThreadOrder = currentThreadOrder;
} 
```

我得到的错误是*error: uninitialized reference member **Buffer::currentThreadOrder***。

我不好意思问，因为这将是一个简单的指针和地址问题，但我看不出问题出在哪里，所以请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:44:46.080

当您使用作为引用的数据成员创建类时，需要在构造函数初始化程序列表中为该引用分配一个值。

引用在创建时必须被赋予一个值，它们不是指针。它们必须以一个值开头，并且该值不能更改（而该值指向的内容可以更改）。

本质上，您可以将引用视为现有变量的别名。 **如果你没有朋友，你不能给朋友起昵称:)**

**回应评论：**

您不会在对象之间“共享引用”。每个对象都有自己对同一个变量的引用。当您“按引用传递”时，您是在告诉编译器您希望函数中的变量实际上是外部范围内的变量，而不是按值创建新变量。这意味着您在一个内存位置只有一个变量。引用只是将您转发到同一内存位置的其他地方的内存。

可以将其视为呼叫转移……我可以在 15 个不同的国家/地区拥有 15 个电话号码。我可以将它们全部设置为将呼叫转移到我在美国的手机。所以，无论他们拨打哪个号码，人们都在给我打电话。

您的每个类都只有另一个引用来将“电话”或变量读/写转发到同一内存位置。因此，您不是在类之间共享引用，而是要确保每个类都具有对相同底层内存位置的引用。

回到比喻，每个班级不会有相同的电话，但每个班级的电话都会转发到相同的号码（变量），这让他们最终都设置/获得相同的值。

**回应二：**

这是一个简单的例子，让你开始思考，它很容易应用于你的课程。我没有编译它，但它应该可以在减去一两个错字的情况下工作。

```
class A
{
    public:
        A(int& shared) : m_shared(shared)
        {
            //No actions needed, initializer list initializes
            //reference above. We'll just increment the variable
            //so you can see it's shared in main.
            m_shared += 7;
        }

        void DoSomethingWithIt()
        {
            //Will always reflect value in main no matter which object
            //we are talking about.
            std::cout << m_shared << std::endl;
        }            

    private:

        //Reference variable, must be initialized in 
        //initializer list of constructor or you'll get the same
        //compiler error again.
        int& m_shared;
};

int main()
{
    int my_shared_integer = 0;

    //Create two A instances that share my_shared_integer.
    //Both A's will initialize their internal reference to
    //my_shared_integer as they will take it into their
    //constructors "by reference" (see & in constructor
    //signature) and save it in their initializer list.
    A myFirstA(my_shared_integer);
    A mySecondA(my_shared_integer);

    //Prints 14 as both A's incremented it by 7 in constructors.
    std::cout << my_shared_integer << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T15:48:29.147

您将指针`int*`作为第一个参数传递给`BufferTypeA`，它期望 and `int`，而您在问题中说您打算使用 a `int&`。为此， ctor`BufferTypeA`应该采用 a`int&`并将其初始化到初始化列表中（即不在`{ }`ctor 的部分内），例如

```
class BufferType {
  int &Ref;
public:
  BufferTypeA(int& ref) : Ref(ref) { /* ... */ }
}; 
```

并且在您的构造中，`BufferA`您不能传递地址，而是引用，即

```
int counter;
Buffer = new BufferType(counter); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T15:51:18.037

你想要这样的代码：

```
Buffer::Buffer(
    int &currentThreadOrder0,
    const int threadConnectionOrder0,
    QWaitCondition *const waitCondition0
) :
  threadConnectionOrder(threadConnectionOrder0),
  waitCondition(waitCondition0),
  currentThreadOrder(currentThreadOrder0)
{} 
```

原因与你不能写的原因有关

```
const double pi;
pi = 3.14; 
```

但可以写

```
const double pi = 3.14; 
```

引用通常以常量指针的形式实现，在初始化指针后无法为其分配地址。您的代码版本*分配，*如第一个`pi`示例中所示。我的代码版本*初始化，*如第二个`pi`示例所示。

# dynamic - 如何为 READ TABLE 设置动态键？

> ID：10802336
> 
> 赞同：8
> 
> 时间：2012-05-29T15:39:12.157
> 
> 标签：dynamic, abap, internal-tables

我正在尝试找出一种方法来读取必须动态创建的内部表。我创建了以下报告，该报告用数据填充动态内部表。

在最后一行，我试图用一个键（`mandt`例如）读取它，但我得到这个语法错误：

> 指定的类型没有结构，因此没有称为 MANDT 的组件

我已经调试过了，我可以看到`<any_tab>`已经成功填充并且表的结构（字段名称）是正确的。当我尝试将表格读入工作区时，问题就出现了。也许我做错了，但这似乎是应该可以做的事情，而且我觉得我错过了一些小东西。

我尝试这个的原因是我发现程序中发生了相同的选择，并希望在内存中缓冲记录并从那里读取它们以避免数据库访问。这很容易实现，但是当我尝试优化的 OPEN SQL 语句的表、`where`子句和子句是动态的时，我没有这样做。`into`

如何纠正语法错误？

```
DATA: t681_rep TYPE TABLE OF t681 , wa_681 LIKE LINE OF t681_rep,
      tabref TYPE REF TO data , waref TYPE REF TO data.

FIELD-SYMBOLS: <any_tab> TYPE ANY TABLE,
               <any_wa> TYPE ANY,
               <var1> TYPE ANY.
"fill t681_rep
SELECT *
  FROM t681
  INTO TABLE t681_rep
   UP TO 1 ROWS WHERE kotab = 'A002'.

READ TABLE t681_rep INTO wa_681 WITH KEY kotab = 'A002'.
IF sy-subrc = 0.

  "if A002 is found create a table of that type and fill it
  CREATE DATA tabref TYPE TABLE OF (wa_681-kotab).
  ASSIGN tabref->* TO <any_tab>.
  SELECT * UP TO 10 ROWS
    FROM (wa_681-kotab)
    INTO TABLE <any_tab>.

ENDIF.

CREATE DATA waref TYPE a002.
ASSIGN waref->* TO <any_wa>.

READ TABLE <any_tab> ASSIGNING <any_wa> WITH KEY mandt = '800'. <- problem area
IF sy-subrc = 0.
  "do stuff with <any_wa>...
ENDIF. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T17:53:40.687

您只需将字段名称放在括号中。

```
data: field type string.
field = 'MANDT'.
READ TABLE <any_tab> ASSIGNING <any_wa> WITH KEY (field) = '800'. 
IF sy-subrc = 0.
  "do stuff with <any_wa>...
ENDIF. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T15:54:16.200

AFAIK，你必须做到“很长的路要走”：

```
FIELD-SYMBOLS: <any_field> TYPE any.    
LOOP AT <any_tab> ASSIGNING <any_wa>.
  ASSIGN COMPONENT 'MANDT' OF STRUCTURE <any_wa> TO <any_field>.
  IF <any_field> <> 800.
   CONTINUE.
  ENDIF.
  " do stuff with <any_wa> - you will have to assign <any_field> again to access fields.
ENDLOOP. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T20:24:39.810

您试图在效率上击败数据库，这是一场失败的战斗。

只需转到 SE11，选择您的表，转到技术设置并更改技术设置（缓冲和缓冲类型），您不需要对象修改键。您还可以确保尺寸类别正确。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T13:19:05.420

您可以使用 RTTS 获取表键。

```
data table_name type string.
table_name = 'A002'.

" Dynamically create the table type
data the_table type ref to data.
create data the_table type table of (table_name).

" Use RTTS to get table keys
data typedescription type ref to cl_abap_tabledescr.
typedescription ?= cl_abap_tabledescr=>describe_by_data_ref( the_table ).
data keys type abap_table_keydescr_tab.
keys = typedescription->get_keys( ). 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-10T20:51:55.427

```
REPORT  y_test_dynamic_table.
DATA: table_name TYPE string,
 typedescription TYPE REF TO cl_abap_tabledescr,
 keys TYPE abap_keydescr_tab,
 ls_key TYPE abap_keyname.

table_name = 'ZYFRM_STG'.

" Dynamically create the table type
DATA the_table TYPE REF TO data.
CREATE DATA the_table TYPE TABLE OF (table_name).

" Use RTTS to get table keys

typedescription ?= cl_abap_tabledescr=>describe_by_data_ref( the_table ).

keys = typedescription->KEY.

loop at keys   INTO ls_key.
***
ENDLOOP. 
```

# symfony - 三重存储的数据库结构？

> ID：10802340
> 
> 赞同：2
> 
> 时间：2012-05-29T15:39:27.333
> 
> 标签：symfony, rdf, semantic-web, triplestore, rdflib

我想在我的 Symfony2 项目中使用 RDF / 三元组来组织事物（在我的例子中是标签）。

我会看到这样的东西：

```
ENTITY TAG  <-------------- TAG_TAG --------------> ASSOCIATION_TYPE
         ^                     |
         |---------------------/ 
```

领域：

```
TAG
  ID
  Tag (text)
  Description (text/html)

TAG_TAG
  ID
  *TAG1
  *TAG2
  *ASSOCIATION_TYPE
  ASSOCIATION_PARAM 
```

像这样，我将能够：

*   存储三重关联
*   设置不同的关联类型。例如，PHP**是**Programming_language ；stackoverflow.com**是一个**网站；但是地球**绕着**太阳转。
*   设置参数（允许在关联中提供更多信息）

`TAG_TAG`我们可以考虑在和之间设置多对多关系`ASSOCIATION_TYPE`。通过这样做，我们可以设置几个参数。

所以我有几个问题：

1.  您认为这是有效存储三元组的好方法吗？
2.  是否有任何 RDF 层可以提取现有的 RDF/三元组数据库并填充我自己的？
3.  我是否应该考虑使用诸如 Sesame 之类的 TripleStore 并将其与 Symfony 一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T12:03:41.953

要回答您的问题：

1）我不完全确定你在问什么。如果您问这是否是一种合理的数据*建模*方式，那可能没问题。但是您的图表不清楚，并且您对细节有点了解。最好的办法就是做一些可以开始的事情。您可以稍后改进建模，而不会有太多麻烦。

如果您要询问三元组的存储，请不要。请参阅我对#3 的回复。

2) 有许多 RDF 库可用，Java 中有[Jena](http://jena.apache.org/)和[Sesame](http://openrdf.org/) ， .Net 世界有[dotNetRdf](http://www.dotnetrdf.org/)，python 中[有 RDFLib ，C 有](http://librdf.org/)[redland](https://github.com/RDFLib)等。

3) 是的。不要试图重新发明轮子并建立自己的三重商店。这不是一个简单的项目，即使在任何合理的时间范围内，您都不会比现有的最差的三重商店做得更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-23T21:14:47.787

正如迈克尔所说 - 请不要建立自己的三重商店！PHP中有几种可用的解决方案：

*   [ARC2](https://github.com/semsol/arc2)提供基于 MySQL 的三元存储
*   librdf 扩展为标准 RDF C 库提供了一个 PHP 包装器
*   [Erfurt Library](http://erfurt-framework.org)是一个用于连接开源[Virtuoso Server](http://virtuoso.openlinksw.com)三元存储的抽象库，但也有自己的基于 Zend DB 的三元存储，可以与 MySQL 一起使用。

# access-token - 从 facebook.com 注销使我的应用程序中的访问令牌无效

> ID：10802341
> 
> 赞同：0
> 
> 时间：2012-05-29T15:39:30.570
> 
> 标签：access-token, facebook-ios-sdk

我刚刚意识到，如果我从 facebook.com 注销，我的应用程序中的访问令牌将不再有效（`fbSessionInvalidated`被调用）。

我不明白为什么从 Facebook**网站**注销会使**我的应用程序中**的访问令牌无效。这是正常行为吗？如果是，为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:42:42.647

这很正常，你需要问一个离线令牌。

但要小心，因为 5 月 2 日。

这是到位[http://developers.facebook.com/roadmap/offline-access-removal/](http://developers.facebook.com/roadmap/offline-access-removal/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:11:03.237

我刚刚在我的应用程序的高级设置中启用了“删除 offline_access 权限”，这个问题得到了解决（我现在也获得了 60 天的访问令牌）。

# sql - 在Oracle的同一张表中根据当前行查找另一行

> ID：10802345
> 
> 赞同：1
> 
> 时间：2012-05-29T15:40:08.053
> 
> 标签：sql, oracle, plsql, oracle9i

假设我有一个包含三列的表：

1.  事件ID (PK)
2.  标签名称
3.  标签值

我需要创建一个查询，结果如下：

1.  事件ID
2.  标签名称
3.  标签值
4.  上一个条件标签
5.  上一个条件值

其中 PreviousConditionTag/Value 来自上一行的 TagName 和 TagValue（按 EventID 排序时）。

在这个问题的一个更简单的版本中，PreviousConditionTag 始终与 TagName 相同——也就是说，我只需要检索当前 TagName 的先前值。我使用 Oracle 的 LAG 分析函数解决了这个问题，按 TagName 进行分区。

但是，我现在需要执行类似的操作，但对于 PreviousConditionTag 是通过另一个表与 TagName 相关的任意标记的情况，其中 TagName 和 PreviousConditionTag 之间的关系不是一对一的。

例如，如果给定行的 TagName 为“ABC”，则关系表可能会说我需要查找“IJK”或“XYZ”的先前值。

我能够在一个 Oracle 函数中提出这个逻辑，该函数对同一个表执行 SELECT 并查找与条件匹配的 MAX(EventID)。例如：

```
SELECT * FROM MyTable WHERE EventID = (
    SELECT MAX(EventID) FROM MyTable WHERE TagName IN (
        SELECT ConditionTagName FROM ConditionMappingTable WHERE TagName = [CurrentTagName]
    )
) AND EventID <= [CurrentEventId] 
```

但是，正如您可以想象的那样，由于此查询是在 MyTable 的每一行的函数中执行的，因此我担心它的性能。

我试图想办法再次使用 Oracle 的 LAG 分析，但我不确定如何为它提出 PARTITION 子句，因为分区似乎重叠。（例如标签ABC需要看IJK和XYZ，标签DEF需要看IJK和UVW）

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:56:59.317

这是答案的重写形式，现在我更好地理解了它。

您想要查找重叠的标签集并仍然获得先前的事件 ID。思路如下：

1.  将所有当前标签的标识添加到映射表（因此当前标签 = 条件标签）
2.  根据*条件*标签加入映射表，获取当前匹配的标签。因此，行将使用它们匹配的“当前”标签重新标记，您可以将其用于滞后。
3.  根据滞后逻辑获取最新的 EventId，按*当前*标签进行分区。
4.  选择当前和条件标签相同的结果。

    ```
    select t.*
    from (select t.*, mt.CurrentTagName, mt.ConditionTagName,
             lag(EventId, 1, NULL)
             over (partition by mt.CurrentTagName
                   order by EventId)
      from t join
           (select CurrentTagName, ConditionTagName
            from ((select CurrentTagName, ConditionTagName
                   from ConditionMappingTable mt
                  ) union all
                  (select distinct CurrentTagName, CurrentTagName
                   from ConditionMappingTable mt
                  )
                 ) mt
           )
           on mt.ConditionTagName = t.tagname
     ) t
    on CurrentTagName = ConditionTagName 
    ```

这似乎有悖常理，因为您是根据情况而不是当前情况来向后查找的。而且，您正在乘以正在处理的行数。但是，它可能仍然比您使用的连接解决方​​案更快。

# javascript - FancyBox 单击链接时如何关闭活动的fancybox并打开另一个fancybox？

> ID：10802347
> 
> 赞同：0
> 
> 时间：2012-05-29T15:40:20.437
> 
> 标签：javascript, jquery, fancybox

我已经有了这个来关闭活动的幻想框：

```
javascript:parent.$.fancybox.close(); 
```

添加到我的链接。

问题：单击该链接时，如何打开另一个fancybox 内容？

说：我通过fancybox打开了登录表单。有一个链接说：没有帐户。因此，如果单击该链接，我想加载注册表并关闭登录表单。这样做的最佳做法是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:48:35.197

关于这个主题似乎还有其他一些问题。例如： [如何在一个 Fancybox 关闭后打开一个 Fancybox？](https://stackoverflow.com/questions/1715986/how-do-i-open-one-fancybox-after-another-closes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T17:51:25.853

在此处不使用回调的另一种更简单的方法：[https](https://stackoverflow.com/a/10694032/1055987) ://stackoverflow.com/a/10694032/1055987 。

实际上，这涵盖了最新的 1.3.x 版本的 fancybox，而[另一个问题/答案](https://stackoverflow.com/q/1715986/1055987)是为更旧的版本编写的。

# google-maps-api-3 - 最近有人遇到过 KML 不透明问题吗？

> ID：10802348
> 
> 赞同：2
> 
> 时间：2012-05-29T15:40:23.600
> 
> 标签：google-maps-api-3, kml, opacity

我有一个基本的县（poygon）kml，上周它运行良好。今天我查看了我的网站，发现 kml 的不透明度在任何浏览器中都不起作用。我尝试在谷歌地球上打开它，它工作正常，但在我的网站上使用谷歌地图 api V3 的地图上，kml 并没有给我 100% 的不透明度。有谁知道我可以采取什么步骤来追踪我的 KML 发生了什么？

下载kml的链接是[http://www.gbnrtc.org/files/2813/3434/9208/GBNRTC_Boundary.kml](http://www.gbnrtc.org/files/2813/3434/9208/GBNRTC_Boundary.kml)

# entity-framework-4 - 在 EF 4.3.1 代码优先中映射继承层次结构总是使用 Map 方法失败

> ID：10802349
> 
> 赞同：0
> 
> 时间：2012-05-29T15:40:30.907
> 
> 标签：entity-framework-4, ef-code-first

使用 Julia Lerman 的 EF Code First 书中示例的简单测试项目。使用 Map 方法时，没有一个示例适用于 TPH、TPT 或 TPC，但没有任何示例都可以。EF 的所有其他方面（我有一个部分开发的应用程序）似乎都可以正常工作。我正在使用带有所有最新更新的 VS 2010/.NET 4，我什至在今天修复了 VS 安装。

以下 TPH 示例引发 InvalidOperationException -“针对类型 'Child' 多次调用 Map，并且至少有一个调用未指定目标表名称。”

```
using System.Linq;
using System.Data.Entity;

namespace ConsoleApplication1
{
    public class Program
    {
        static void Main(string[] args)
        {
            Database.SetInitializer(new DropCreateDatabaseIfModelChanges<Context>());
            var children = new Context().Set<Child>().ToList();
        }
    }

    public class Parent
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }

    public class Child : Parent
    {
    }

    public class Context : DbContext
    {
        DbSet<Parent> Parents { get; set; }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Entity<Parent>()
                .Map(m =>
                    {
                        m.Requires("EntityType").HasValue("Parent");
                        m.ToTable("Families");
                    })
            .Map<Child>(m => m.Requires("EntityType").HasValue("Child"));
        }
    }
} 
```

另一个示例，这次 TPT 抛出“'Child' 类型已经映射到表 'Children'。在单个 Map 调用中指定表的所有映射方面。”

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Entity<Parent>()
                .Map(m => m.ToTable("Families"))
                .Map<Child>(m => m.ToTable("Children"));
        } 
```

最后一个示例，TPC，抛出类似的“'Child' 类型已经映射到表 'Children'。在单个 Map 调用中指定表的所有映射方面。”

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Entity<Parent>()
                .Map(m => m.ToTable("Families"))
                .Map<Child>(m =>
                    {
                        m.ToTable("Children");
                        m.MapInheritedProperties();
                    });
        } 
```

我也尝试了许多其他示例，结果相似。要么我遗漏了一些非常基本的东西，要么我怀疑我有安装/配置问题。我的电脑也安装了 VS2008，几个月前我做了很多重新配置 SQL Server，因为我安装了 4 个不同的版本。我现在使用的是 2008 R2 Express。

有没有人看到过类似的情况或知道如何跟踪/调试 EF 中发生的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:47:41.040

在这里找到答案... [Entity Framework 4.3 - TPH 映射和迁移错误](https://stackoverflow.com/questions/9499702/entity-framework-4-3-tph-mapping-and-migration-error/)

...*这是 4.3 和 4.3.1 的一个已知问题。（我们发现将修复程序放入 4.3.1 为时已晚。）*

...*简而言之，您曾经能够在 4.1 中对单个 EntityConfiguration 进行链式映射调用。和 4.2*

值得庆幸的是，建议的调用 Map 的替代方法（即不链接）解决了我的所有问题。

# php - 更改图像背景

> ID：10802351
> 
> 赞同：3
> 
> 时间：2012-05-29T15:40:42.807
> 
> 标签：php

现在我得到了这张白色背景的图片，但想把它改成别的东西......

我试过使用[imagecolorset](http://php.net/imagecolorset/)，索引为 16777215 （白色），但它不起作用 D：

还有其他人有这个问题吗？更好的是，知道如何解决它？

代码：

```
$img = imagecreatefrompng("http://chart.apis.google.com/chart?cht=qr&chs=300x300&chl=hellow"); 
$index = imagecolorat($img, 0, 0);
imagecolorset($img, $index, 0, 0, 255);
header("content-type:image/png");
imagepng($img);
imagedestroy($img); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T17:16:09.863

谷歌图表 API 似乎正在创建真彩色图像。笔记：

```
[ghoti@pc ~]$ cat imgtest1.php 
<?php

$url = "http://chart.apis.google.com/chart?cht=qr&chs=300x300&chl=hello";
$img = imagecreatefrompng($url);

print "Colours before: " . imagecolorstotal($img) . "\n";
imagetruecolortopalette($img, FALSE, 2);
print "Colours after:  " . imagecolorstotal($img) . "\n";

[ghoti@pc ~]$ php imgtest1.php 
Colours before: 0
Colours after:  2
[ghoti@pc ~]$ 
```

因此，转换为调色板图像[`imagetruecolortopalette()`](http://www.php.net/manual/en/function.imagetruecolortopalette.php)似乎可以解决您的问题。

```
<?php

$url = "http://chart.apis.google.com/chart?cht=qr&chs=100x100&chl=hello";
$img = imagecreatefrompng($url);         # fetch the image
imagetruecolortopalette($img, FALSE, 2); # convert image from TC to palette
$bg = imagecolorat($img, 0, 0);          # get the bg colour's index in palette
imagecolorset($img, $bg, 0, 0, 255);     # make it blue

header("content-type:image/png");
imagepng($img);
imagedestroy($img); 
```

结果：

![在此处输入图像描述](../Images/7ff8bdda63724c2b0b695b7fe776b6a3.png)

# c# - 将 c# 对象保存到磁盘

> ID：10802355
> 
> 赞同：3
> 
> 时间：2012-05-29T15:40:58.453
> 
> 标签：c#, .net, serialization

我想在 c# 中将对象保存/读取到磁盘。它的一些属性没有用 [Serializable] 标记。有没有其他方法可以保存？我不关心磁盘上对象的格式，我只想将它转储到磁盘并读取它。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:29:00.287

建议的 XmlSerializer 的替代方案是[protobuf-net](http://code.google.com/p/protobuf-net/)。它是由 SO/StackExchange 自己的 Marc Gravell 编写的 Google protobuf 的 .net 实现。请注意，您必须有权访问这些对象，因为 protobuf-net 仅支持以下自定义类：

*   被标记为数据合同
*   有一个无参数的构造函数
*   对于 Silverlight：是公开的

如果这对您不起作用，您可以编写自己的解决方案，或者根据您的范围，使用像[eloquera](http://eloquera.com/)这样的对象数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:44:17.447

该类[`XmlSerializer`](http://msdn.microsoft.com/en-us/library/bdxxw552.aspx)不需要将对象标记为可序列化，但它只保存公共字段和属性。如果您需要序列化私有成员，除非您编写自己的序列化程序，否则您将不走运。

# ios - 无法在 MDM 中安装应用程序

> ID：10802357
> 
> 赞同：1
> 
> 时间：2012-05-29T15:41:10.167
> 
> 标签：ios, apple-push-notifications, mdm

它是使用 APNs 的 MDM。在组合配置文件中允许添加和删除应用程序。使用iOS5的iPhone。尽管“iTunesStore”的“免费应用程序”的安装是由iOS的MDM通过以下方法执行的，但它没有成功。这种方法有误吗？请教我正确的方法。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN""http://www.apple.com/DTDs/PropertyList-1.0.dtd">
       <?xml version="1.0" encoding="UTF-8"?>
    <plist version="1.0">
       <dict>
          <key>CommandUUID</key>
          <string>995761bc0ac0f311452f050a3e4be157ca2dda75</string>
          <key>Command</key>
          <dict>
             <key>RequestType</key>
             <string>InstallApplication</string>
             <key>iTunesStoreID</key>
             <number>338761996</number>
             <key>ManagementFlags</key>
             <integer>1</integer>
          </dict>
       </dict>
    </plist> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-19T06:46:32.120

将**数字**标签替换为**整数**。

IE，

```
 <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN""http://www.apple.com/DTDs/PropertyList-1.0.dtd">
    <plist version="1.0">
         <dict>
              <key>CommandUUID</key>
              <string>4424F929-BDD2-4D44-B518-393C0DABD56A</string>
              <key>Command</key>
                   <dict>
                        <key>RequestType</key>
                        <string>InstallApplication</string>
                        <key>iTunesStoreID</key>
                        <integer>464656389</integer>
                        <key>ManagementFlags</key>
                        <integer>4</integer>
                   </dict>
         </dict>
    </plist> 
```

这个问题花了我一周的时间，直到我**不小心**弄明白了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T22:33:01.863

我遇到了同样的问题，但刚刚找到了解决方案，这是问题所在，当我查看手册页时，我看到 CFNumber 被映射到，或者，一旦将其更改得太真实，它就像一个魅力 [https://developer.apple.com/library /mac/#documentation/Darwin/Reference/ManPages/man5/plist.5.html](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man5/plist.5.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-23T14:23:07.037

要安装企业 IPA，您可以使用以下 XML

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST      1.0//EN""http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
    <dict>
        <key>CommandUUID</key>
        <string>4424F929-BDD2-4D44-B518-393C0DABD56A</string>
        <key>Command</key>
            <dict>
              <key>RequestType</key>
              <string>InstallApplication</string>
              <key>ManifestURL</key>
              <string>https://company.com/manifest.plist</string>
              <key>ManagementFlags</key>
              <integer>4</integer>
             </dict>
     </dict>
</plist> 
```

下面是一个示例清单文件：

```
 <?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN"  "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
 <plist version="1.0">
 <dict>
     <key>items</key>
     <array>
     <dict>
        <key>assets</key>
        <array>
            <dict>
                <key>kind</key>
                <string>software-package</string>
                <key>url</key>
                <string>https://companyName/filename.ipa</string>
            </dict>
        </array>
        <key>metadata</key>
        <dict>
            <key>bundle-identifier</key>
            <string>com.company.appname</string>
            <key>bundle-version</key>
            <string>3</string>
            <key>kind</key>
            <string>software</string>
            <key>title</key>
            <string>appname</string>
        </dict>
      </dict>
   </array>
 </dict>
 </plist> 
```

# c++ - 全局静态动态分配对象 C++

> ID：10802360
> 
> 赞同：0
> 
> 时间：2012-05-29T15:41:19.117
> 
> 标签：c++, static, heap-memory, global

我对动态分配的静态全局对象有非常具体的问题。在我的项目中，我几乎没有需要在整个应用程序生命周期中跨线程从不同位置访问的对象。我想在应用程序初始化时创建并在应用程序退出时销毁。所以我尝试了以下，

头文件：MyObjectFactory.h

```
class MyObjectFactory{
   public:
      static MyObject* GetMyObject();
}; 
```

源文件：MyObjectFactory.cpp

```
static MyObject* gMyObject = 0;

MyObject* MyObjectFactory::GetMyObject(){
    if(gMyObject == 0)
    {
        gMyObject = new MyObject();
    }
    return gMyObject;
} 
```

这段代码似乎可以工作，但我想清除一些东西。

1.  对象只会被创建一次，然后将返回对对象的引用。（我想要这个，因为 MyObject 封装了一些系统资源，如文本文件）
2.  当应用程序退出时，MyObject 被销毁。
3.  对象创建堆（当我使用 new 时）或全局内存（当我使用静态时）会在哪里？还是我违反了任何 OOP 原则？
4.  可以从多个线程调用 MyObjectFactory::GetMyObject() 吗？
5.  这是实现有点类似于 Singleton 的好方法吗？

请让我知道您的意见。

太感谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:46:47.700

以最小的麻烦实现正确销毁和正确初始化的标准方法使用块局部静态，如下所示：

**foo.hpp：**

```
struct Foo
{
    static Foo & get();
    // ...
}; 
```

**foo.cpp：**

```
#include "foo.hpp"

Foo & Foo::get()
{
    static Foo impl;
    return impl;
} 
```

现在您可以`Foo::get()`在代码中的任何位置说。没有指针，没有动态分配，也没有任何东西被泄露。一个真正的静态单例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T15:46:24.340

> 对象只会被创建一次，然后将返回对对象的引用。（我想要这个，因为 MyObject 封装了一些系统资源，如文本文件）

*   `MyObject*`是指针类型，而不是引用类型。`gMyObject`是指向 的类型指针的变量`MyObject`。

> 当应用程序退出时，MyObject 被销毁。

*   它没有，没有人调用`delete`你的指针，所以你有泄漏。

> 对象创建堆（当我使用 new 时）或全局内存（当我使用静态时）会在哪里？还是我违反了任何 OOP 原则？

*   如果您正在使用`new`，则在*'heap'*中创建对象。`static`仅适用于指向您的对象的指针，而不适用于对象本身。

> 可以从多个线程调用 MyObjectFactory::GetMyObject() 吗？

*   不是，如果您有并发线程并且尚未构造对象，则可能会导致多次初始化。

> 这是实现有点类似于 Singleton 的好方法吗？

*   它不是。或者也许是这样，但是单例通常是实现某事的不好方法（我只说*通常*）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:55:14.790

> 对象只会被创建一次，然后将返回对对象的引用。

如果您的程序是单线程的，则可以（尽管在您的示例中它返回的是指针而不是引用）。否则存在两个线程创建对象的单独副本的危险；或者实际上发生了其他任何事情，因为在这种情况下行为是未定义的。

> 当应用程序退出时，MyObject 被销毁。

不，用 创建的对象`new`只会被 销毁`delete`，永远不会自动销毁，所以这个对象被泄露了。这是否是一个问题取决于它使用的所有资源是否都被系统自动回收。

> 对象创建堆（当我使用 new 时）或全局内存（当我使用静态时）会在哪里？

对象是从空闲存储区（又名堆）分配的；指向它的指针是静态的。

> 可以从多个线程调用 MyObjectFactory::GetMyObject() 吗？

仅当您可以确保在他们中的任何一个调用它之前已经创建了该对象。

> 这是实现有点类似于 Singleton 的好方法吗？

在 C++ 中没有很好的方法来实现这一点。最好的方法是完全避免全局可访问的对象；在某处创建它，并将引用传递给任何需要它的东西。

如果你真的想要一个全局对象，那么有几个选项，每个选项都有自己的死亡陷阱：

*   一个简单的全局对象。如果您有多个其中之一，并且它们之间存在依赖关系，请注意初始化顺序惨败。
*   一个包含静态对象的函数，返回对 this 的引用。这保证在您使用它时会被初始化，并且在符合 C++11 的实现上是线程安全的（在许多早期的实现上也是如此）。但是，在程序关闭期间，它可能会在其他仍在尝试访问它的静态对象之前被破坏 - 您可以通过动态分配和泄漏对象来避免这种情况，就像您的方法一样。确保线程安全的构造也可能会产生一些运行时开销。
*   一个延迟分配的动态对象（就像您拥有的那样），只要您确保在启动多个线程之前对其进行初始化，或者添加线程安全性（这并不完全简单，并且会增加运行时开销）。

# jasper-reports - 在 JasperReports Server 4.5 中管理计划

> ID：10802361
> 
> 赞同：1
> 
> 时间：2012-05-29T15:41:19.257
> 
> 标签：jasper-reports, jasperserver

我想知道是否有人想出了在*JasperReports Server*中管理计划报告的好方法。我们有一个多租户环境，可以有数百名用户能够安排报告。我希望能够查看当前计划的所有报告、提交报告的人、上次运行的时间、计划下次运行的报告，以及如果可能的话，它们当前是否处于活动状态（正在运行）。我知道*JR Server*目前没有通过它的 UI 提供任何东西来执行此操作，因此不确定有哪些选项可以帮助实现这种可见性。如果有人想出一个很好的方法来完成这个，我很想听听你是如何完成的。

谢谢，鲍勃

# asp.net-mvc - 无法将 VS 2010 ASP.Net MVC 3 Razor Web 应用程序发布到 IIS 6/7

> ID：10802362
> 
> 赞同：1
> 
> 时间：2012-05-29T15:41:20.103
> 
> 标签：asp.net-mvc, iis, razor, web

我一直试图通过构建一个链接到 SQL 2008 数据库的简单 CRUD Web 应用程序来熟悉 MVC。当我在 VS 中运行项目时，一切都很好，但是在尝试使用 IIS 6 或 7 成功发布应用程序失败后，我遇到了失败。

我已经用谷歌搜索了我的手指，尝试了各种修复和发布方法，但到目前为止，我一直在碰壁。我觉得必须有一些基本的东西我忽略了才能做到这一点，但我很难过。

我希望在这种环境中工作经验丰富的人能够提出一些我可能会犯的新手错误，或者任何关于首次发布 MVC Web 应用程序的提示。

在此先感谢帕特里克·肖恩·亨德森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:47:32.077

我们确实需要更多信息，但在这里做一些假设需要验证：

**假设：**

1.  IIS 7.x
2.  安装了正确的 .NET 版本
3.  VS2010 和 NuGet
4.  基于文件系统的部署

**建议：**

1.  确保包含所需的可部署程序集。
    *   在VS中右键单击MVC项目
    *   选择“包括可部署的程序集”
    *   检查所需的组件
2.  我会有更多的背景细节

尽可能发布更新！

布伦特

# character-encoding - 给定一个字符的十六进制码，如何在CL程序中将其转换为对应的字符？

> ID：10802370
> 
> 赞同：0
> 
> 时间：2012-05-29T15:41:40.133
> 
> 标签：character-encoding, ibm-midrange, hex, journal

现在我需要使用 CL 程序在日记中查找特定条目。我用来定位它的方法是 DSPJRNE 将日记条目放在输出文件中，然后使用 OPNQRYF 过滤所需的条目。该文件是唯一键控的，因此我的计划是将日记帐分录数据与键进行比较。问题是其中一个键是压缩十进制，因此在日记帐分录中，它被视为十六进制字符代码并显示为一些奇怪的符号。因此，为了比较字符串，我需要将打包的十进制键转换为相应的字符。如何在 CL 中实现这一点？如果无法使用 CL，那么 RPG 呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:28:42.170

要回答您的直接问题，CVTCH MI 指令会将十六进制转换为字符，但我不会走那条路；既不是 CL 也不是 RPG。相反，我会采取一些额外的步骤来采纳 James 的建议。

```
DSPJRNE OUTFILE(QTEMP/DSPJRNE)
QRY input file DSPJRNE, output file QRYJRNE, select only JOESD
CRTDUPOBJ PRODUCTION_FILE QTEMP/JRNF DATA(*NO)
CPYF QRYJRNE JRNF FMTOPT(*NOCHK) 
```

这将为您提供一个外部描述的文件，其布局与您的生产文件完全相同。你可以查询，等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:04:04.453

如果您要提取特定文件的日志条目，则可以巧妙地使用 SQL 将它们转储到外部描述的文件中：

```
CREATE TABLE QTEMP/QADSPJRN LIKE QSYS/QADSPJRN

ALTER TABLE QTEMP/QADSPJRN DROP COLUMN JOESD

CREATE TABLE QTEMP/DSPJRNE AS (SELECT * FROM QTEMP/QADSPJRN, FILE-LIB/FILE) 
WITH NO DATA

DSPJRNE ... OUTPUT(*OUTFILE) OUTFILFMT(*TYPE1) OUTFILE(QTEMP/DSPJRNE) 
ENDDTALEN(*CALC) 
```

# c# - Datetime.Today in GMT in c#

> ID：10802371
> 
> 赞同：60
> 
> 时间：2012-05-29T15:41:50.697
> 
> 标签：c#, datetime, timezone

我想转换`DateTime.Today`为 GMT 时间。

即，如果我在洛杉矶，现在是 2012 年 2 月 22 日晚上 11 点，我希望 DateTime.Today 是 2012 年 2 月 23 日，因为它将是格林威治标准时间的那一天。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2012-05-29T15:44:19.950

没有`DateTime.UtcToday`，但你可以试试`DateTime.UtcNow.Date`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T16:31:37.877

`DateTime.UtcNow`会给你当前的世界时间。

# ajax - Mediawiki 中的自动刷新内容

> ID：10802372
> 
> 赞同：1
> 
> 时间：2012-05-29T15:41:54.933
> 
> 标签：ajax, mediawiki

我向我的 mediawiki 添加了一个新标签 ( `<news />`) 以列出最后修改的页面。
不幸的是，除非我修改标签所在的页面，否则列表不会更新。
我正在寻找一种方法来做到这一点，我想到了 AJAX。但是我没有设法让 AJAX 刷新我的列表。
有谁知道在我的 Mediawiki 上添加自动刷新功能的简单方法？
这是我的扩展代码：

```
$wgHooks['ParserFirstCallInit'][] = 'replaceTags';

function replaceTags( Parser $parser ) {
    $parser->setHook( 'news', 'newsRender' );
    return true;
}

function newsRender( $input, array $args, Parser $parser, PPFrame $frame ) {
    // Titre =News=
    $output = $parser->parse( "=News=", $parser->mTitle, $parser->mOptions, false, false )->getText();

    $nb = 5;

    $querySQL = "SELECT page_namespace, page_title, page_id, page_latest, rev_timestamp
                FROM page, revision
                WHERE page.page_latest = revision.rev_id 
                AND page_namespace = 0
                ORDER BY rev_timestamp
                DESC LIMIT 0,$nb";

    $dbr = wfGetDB( DB_SLAVE );
    $res = $dbr->query( $querySQL );

    $count = $dbr->numRows( $res );
    if( $count > 0 ) {  
        $output .= "<ul>";
        while( $row = $dbr->fetchObject( $res ) )
        {
            $pageTitle = $row->page_title;
            $nicerPageTitle = str_replace("_", " ", $pageTitle);
            $pageNamespace = $row->page_namespace;
            $title = Title::makeTitleSafe( $pageNamespace, $pageTitle );
            $url = $title->getFullURL();

            $date = $row->rev_timestamp;
            $date = wfTimestamp( TS_RFC2822, $date );

            $output .= "<li><a href=\"$url\">$nicerPageTitle</a> $date</li>";
        }
        $output .= "</ul>";
    } else {
        $output .= "A l'ouest rien de nouveau !!!";
    }

    return $output;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:11:40.227

感谢nischayn22，我深入探讨了缓存问题。
我发现可以停用它：

```
$parser->disableCache(); 
```

我试过了，它有效！

[http://www.mediawiki.org/wiki/Extensions_FAQ#How_do_I_disable_caching_for_pages_using_my_extension.3F](http://www.mediawiki.org/wiki/Extensions_FAQ#How_do_I_disable_caching_for_pages_using_my_extension.3F)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T15:52:42.733

这可能是因为 MediaWiki 对页面使用缓存。你可以做的是为所需的功能制作一个 SpecialPage。AFAIK 特殊页面未缓存（在 irc #mediawiki 上确认）。此外，如果您搜索 Mediawiki.org 上存在的扩展，您可能已经发现有人完成了类似的实现。（否则我很乐意为您构建一个 :)

更新：您可以使用[动态列表（用于 wikinews）](http://www.mediawiki.org/wiki/Extension%3aDynamicPageList_%28Wikimedia)和[news](http://www.mediawiki.org/wiki/Extension%3aNews2)的扩展。如果您搜索 mediawiki.org，可能还有更多。

# php - 如何比使用序列化和 base64 更好地以 url 友好格式加密/编码数组

> ID：10802376
> 
> 赞同：0
> 
> 时间：2012-05-29T15:41:59.067
> 
> 标签：php, arrays, serialization, base64, mcrypt

我目前正在使用此代码从 Intranet 服务器生成 .xls 文件中的超链接。

这个 .xls 文件是我通过电子邮件提交给我的一个供应商的订单。

```
/* WEBSERVER1 */  
$ORDER=$_GET['ORDER'];
$EZAB=$_GET['EZAB'];
$IP=$_GET['IP'];

$ARRAY = array(
    "ORDER" => $ORDER,
    "EZAB" => $EZAB,
    "IP" => $IP);

$SERIAL=serialize($ARRAY);
$q=base64_encode($SERIAL);
$URL="http://mywebsite/?q=".$q
$EXCELHYPERLINK='=hyperlink("'.$URL.'")'; 
```

我希望我的供应商单击 .xls 文件中的链接以确认订单已处理，而不是回复原始电子邮件。

外部世界无法访问 Intranet 服务器，该链接指向托管以下代码的网络服务器。

```
/* WEBSERVER2 */
$q=$_GET['q'];
$SERIAL=base64_decode($q);
$ARRAY=unserialize($SERIAL);
// Do something... 
```

我宁愿不使用数据库。

你有没有想过我怎样才能让“$KEY”的内容不那么容易被发现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T09:48:16.290

mcrypt 允许我加密通过 GET 传输的数据。（感谢@dAm2K）

base64_encode 不足以使加密的日期 URL 友好，因为它包含（“+”、“/”和“=”字符）（感谢 @DavidThomas）

我使用 str_replace 替换了这 3 个字符，一切正常。

这是内网服务器的更正代码：

```
/* WEBSERVER1 */  
$ORDER=$_GET['ORDER'];
$EZAB=$_GET['EZAB'];
$IP=$_GET['IP'];

$ARRAY = array(
    "ORDER" => $ORDER,
    "EZAB" => $EZAB,
    "IP" => $IP);

$SERIAL=serialize($ARRAY);
$M=mcrypt_module_open('rijndael-256','','cbc','');
$KEY=md5("gi7aesawde2zomspgo8guvivmer8oici");
$IV=md5("dob1depatodop7lipdaig7bebeaion9d");
mcrypt_generic_init($M,$KEY,$IV);
$ENCRYPTEDDATA=mcrypt_generic($M,$SERIAL);
mcrypt_generic_deinit($M);
mcrypt_module_close($M);
$q=base64_encode($ENCRYPTEDDATA);
$q=str_replace(array('+','/','='),array('-','_','.'),$q);

$URL="http://mywebsite/?q=".$q;
$EXCELHYPERLINK='=hyperlink("'.$URL.'")'; 
```

对于网络服务器：

```
/* WEBSERVER2 */
$q=$_GET['q'];
$q=str_replace(array('-','_','.'),array('+','/','='),$q);
$ENCRYPTEDDATA=base64_decode($q);
$M=mcrypt_module_open('rijndael-256','','cbc','');
$KEY=md5("gi7aesawde2zomspgo8guvivmer8oici");
$IV=md5("dob1depatodop7lipdaig7bebeaion9d");
mcrypt_generic_init($M,$KEY,$IV);
$SERIAL=mdecrypt_generic($M,$ENCRYPTEDDATA);
mcrypt_generic_deinit($M);
mcrypt_module_close($M);
$ARRAY=unserialize($SERIAL);

// Do something... 
```

# android - 无法在 Android 应用程序中使用 libspotify 12

> ID：10802377
> 
> 赞同：1
> 
> 时间：2012-05-29T15:42:17.207
> 
> 标签：android, android-ndk, spotify

我正在尝试使用 NDK 在我的 android 应用程序中加载 libspotify。我正在使用库 libspotify++ 和 jlibspotify。一切似乎都已加载，但当 libspotify 尝试加载库“libspotify.so.12”时崩溃

我不能在 android 中使用符号链接。

代码：

```
public class Session {
    static {
        System.loadLibrary("spotify");
        System.loadLibrary("jlibspotify");
    }

} 
```

日志：

```
05-29 17:27:22.559: D/dalvikvm(32606): threadid=1: still suspended after undo (sc=1 dc=1)
05-29 17:27:25.527: D/dalvikvm(32606): Trying to load lib /data/data/se.warting.spotify/lib/libspotify.so 0x41692100
05-29 17:27:25.535: D/dalvikvm(32606): Added shared lib /data/data/se.warting.spotify/lib/libspotify.so 0x41692100
05-29 17:27:25.535: D/dalvikvm(32606): No JNI_OnLoad found in /data/data/se.warting.spotify/lib/libspotify.so 0x41692100, skipping init
05-29 17:27:25.543: D/dalvikvm(32606): Trying to load lib /data/data/se.warting.spotify/lib/libjlibspotify.so 0x41692100
05-29 17:27:27.637: W/dalvikvm(32606): Exception Ljava/lang/UnsatisfiedLinkError; thrown while initializing Lse/sony/tunefeud/spotiwrap/Session;
05-29 17:27:28.824: D/AndroidRuntime(32606): Shutting down VM
05-29 17:27:28.824: W/dalvikvm(32606): threadid=1: thread exiting with uncaught exception (group=0x40a421f8)

05-29 17:27:28.855: E/AndroidRuntime(32606): FATAL EXCEPTION: main
05-29 17:27:28.855: E/AndroidRuntime(32606): java.lang.ExceptionInInitializerError
05-29 17:27:28.855: E/AndroidRuntime(32606):    at se.warting.spotify.PocActivity.onCreate(PocActivity.java:18)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at android.app.Activity.performCreate(Activity.java:4465)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at android.app.ActivityThread.access$600(ActivityThread.java:123)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at android.os.Handler.dispatchMessage(Handler.java:99)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at android.os.Looper.loop(Looper.java:137)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at android.app.ActivityThread.main(ActivityThread.java:4424)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at java.lang.reflect.Method.invokeNative(Native Method)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at java.lang.reflect.Method.invoke(Method.java:511)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at dalvik.system.NativeStart.main(Native Method)
05-29 17:27:28.855: E/AndroidRuntime(32606): Caused by: java.lang.UnsatisfiedLinkError: Cannot load library: link_image[1936]:   118 could not load needed library 'libspotify.so.12' for 'libjlibspotify.so' (load_library[1091]: Library 'libspotify.so.12' not found)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at java.lang.Runtime.loadLibrary(Runtime.java:370)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at java.lang.System.loadLibrary(System.java:535)
05-29 17:27:28.855: E/AndroidRuntime(32606):    at se.warting.spotify.spotiwrap.Session.<clinit>(Session.java:6)
05-29 17:27:28.855: E/AndroidRuntime(32606):    ... 15 more 
```

这是我从 objdump 得到的：

```
$arm-linux-androideabi-objdump -p libs/armeabi/libjlibspotify.so  | grep NEEDED
  NEEDED               libspotify.so.12
  NEEDED               libstdc++.so
  NEEDED               libm.so
  NEEDED               libc.so
  NEEDED               libdl.so
$arm-linux-androideabi-objdump -p libs/armeabi/libspotify.so  | grep NEEDED
  NEEDED               libm.so
  NEEDED               libc.so
  NEEDED               libdl.so 
```

有谁知道该怎么做才能让它工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T13:15:49.137

I'll just break out my Java/JVM skills here and try applying them on Android/Dalvik.

1.  `System.loadLibrary()` expects a JNI library name as its argument. In this case libspotify is not (and never is) a JNI library, but libjlibspotify seems to be. Note how the first call whines in the log about the missing `JNI_OnLoad` function. This is usually a good hint. `System.loadLibrary()` does however accept any shared library as long as it can find it, and that's why the call doesn't fail in this scenario.

2.  Dependent libraries of a JNI library are loaded automatically by the platform's built-in shared library loading mechanisms. In this case, libjlibspotify depends on `libspotify.so.12`, so if there is such a file available in the loader's path, then this should be loaded automatically by the system whenever libjlibspotify is loaded.

    Hence, the proper Java code in this case should be:

    ```
    public class Session {
        static {
            System.loadLibrary("jlibspotify");
        }
    } 
    ```

    However, if the dependent library is not found as part of the `System.loadLibrary()` invocation, then that call will fail with an `UnsatisfiedLinkError` (see the log about the missing dependent `libspotify.so.12` file).

3.  libspotify 12 currently ships in the archive as `libspotify.so.12.1.45` (with some symlinks `libspotify.so` and `libspotify.so.12` pointing to that file). I don't know anything about how libjlibspotify has been built in this scenario, but if it is the case that the symlinks aren't relevant in the Android setting, then libjlibspotify should instead be built to load `libspotify.so.12.1.45` from the archive, no renaming needed.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T07:02:19.127

看来您需要更改创建 libspotify 的构建过程以获得正确的名称。

最简单的方法是使用 Android NDK 构建系统 - 它会正确编译和链接库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T07:43:32.757

Mārtiņš 的回答是正确的，它应该使用 Android 的 NDK 构建系统构建。当无法控制库时，有一种解决方法：

Instead of loading the library with System.loadLibrary( "JLibSpotify" ); i manualy copied /data/data/se.warting.spotify/lib/libspotify.so to /data/data/se.warting.spotify/libspotify.so.12 And then loaded the library with:

```
System.load("/data/data/se.warting.spotify/libspotify.so.12"); 
```

After that i could load jlibspotify as normal:

```
System.loadLibrary("jlibspotify"); 
```

# javascript - 如何在平行坐标可视化中为每个垂直轴设置标签？

> ID：10802383
> 
> 赞同：3
> 
> 时间：2012-05-29T15:42:37.630
> 
> 标签：javascript, d3.js, label, parallel-coordinates

我是 d3.js（和 stackoverflow）的新手，目前正在研究平行坐标示例。我目前正在为数据使用一个名为“行”的二维数组。每个垂直轴上方是标签“0”或“1”或“2”等。但是，我希望每个垂直轴都用 row[0][i] 中的文本标记。我相信数字 0,1,2 来自基准。关于如何使用 row[0][i] 中的标签的任何建议？我怀疑我做错了什么，这是非常基本的。这是相关的代码。谢谢 ！

```
 // Extract the list of expressions and create a scale for each.
    x.domain(dimensions = d3.keys(row[0]).filter(function (d, i) {
        return row[0][i] != "name" &&
            (y[d] = d3.scale.linear()
                .domain(d3.extent(row, function (p) { return +p[d]; }))
                .range([height, 0]));
    }));

    // Add a group element for each dimension.
    var g = svg.selectAll(".dimension")
                .data(dimensions)
                .enter().append("g")
                .attr("class", "dimension")
                .attr("transform", function (d) { return "translate(" + x(d) + ")"; });

    // Add an axis and title.
    g.append("g")
            .attr("class", "axis")
            .each(function (d) { d3.select(this).call(axis.scale(y[d])); })
            .append("text")
            .attr("text-anchor", "middle")
            .attr("y", -9)
            .text(String);//.text(String) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T15:39:15.220

如果您只有一组受控轴（如三轴），您可能只想单独设置它们，如下所示...

```
svg.append("text").attr("class","First_Axis")
    .text("0")
    .attr("x", first_x_coordinate)
    .attr("y", constant_y_coordinate) 
    .attr("text-anchor","middle");

svg.append("text").attr("class","Second_Axis")
    .text("1")
    .attr("x", first_x_coordinate + controlled_offset)
    .attr("y", constant_y_coordinate) 
    .attr("text-anchor","middle");

svg.append("text").attr("class","Third_Axis")
    .text("2")
    .attr("x", first_x_coordinate + controlled_offset*2)
    .attr("y", constant_y_coordinate) 
    .attr("text-anchor","middle"); 
```

但是，如果您动态放置了依赖于数据的轴，您可能希望使用保持 y 坐标常数的函数放置轴信息，同时根据固定的“偏移量”确定 x 坐标（即数据驱动轴放置） . 例如...

```
svg.append("text")
    .attr("class",function(d, i) {return "Axis_" + i; })
    .text(function(d,i) {return i; })
    .attr("x", function(d, i) { return (x_root_coordinate + x_offset_value*i); })
    .attr("y", constant_y_coordinate) 
    .attr("text-anchor","middle"); 
```

我希望这有帮助。

坦率

# forms - 在谷歌电子表格中将长行拆分为较短行的功能？

> ID：10802384
> 
> 赞同：0
> 
> 时间：2012-05-29T15:42:41.303
> 
> 标签：forms, function, split, rows, google-sheets

我有一个从表单接收数据的 Google 电子表格。此表单中的每个答案都会在我的电子表格中生成一个 224 列长的行。

我需要的是一个函数，它将这些行中的每一行分成几行，每行只包含 7 列。

这是一个实时表单，将继续在电子表格中添加更多行。因此我需要一个公式：

1.  将一行拆分为多行。
2.  对表单中的每一行执行此操作而不覆盖自身。
3.  对接收到的每一行新数据自动执行此操作。

由于我试图实现这个看似简单的事情几个小时而没有成功，我现在向互联网寻求帮助。如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T14:21:49.930

我怀疑常规的电子表格公式组合会做到这一点。您将需要 Google Apps 脚本，请阅读[指南](https://developers.google.com/apps-script/guide)和[教程](https://developers.google.com/apps-script/articles)以了解这不是很困难。

# coldfusion - 在 ColdFusion 10 中使用 CF_SQL_NVARCHAR 的细节是什么？

> ID：10802388
> 
> 赞同：12
> 
> 时间：2012-05-29T15:42:51.963
> 
> 标签：coldfusion, coldfusion-10

有关更新数据库的 ColdFusion 10 文档有一节介绍[ColdFusion 10 中与数据库相关的增强功能](http://help.adobe.com/en_US/ColdFusion/10.0/Developing/WSc3ff6d0ea77859461172e0811cbec0e02b-7ff3.html#WSe61e35da8d318518-9efe7cf1358680a71d-8000)。该页面提到现在有支持`CF_SQL_NVARCHAR`，但没有关于它们的详细信息。此外，[cfqueryparam 文档](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f6f.html)尚未更新以包含它们的存在。

[cfqueryparam](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f6f.html)的ColdFusion 9 文档提到`CF_SQL_VARCHAR`映射到`varchar`MSSQL。这是真的，除非 ColdFusion 管理员[数据源设置](http://help.adobe.com/en_US/ColdFusion/9.0/Admin/WSc3ff6d0ea77859461172e0811cbf364104-7fe5.html)`String Format`启用了该设置。在这种情况下`CF_SQL_VARCHAR`映射到`nvarchar`. 这个记录不充分的功能是一种 hack，它可能会导致ColdFusion出现[性能问题。](https://stackoverflow.com/questions/10543755/slow-query-with-cfqueryparam-searching-on-indexed-column-containing-hashes)

所以他们介绍了 很棒`CF_SQL_NVARCHAR`，但最好了解它是如何工作的。它只是`CF_SQL_VARCHAR`让它变得毫无意义的别名？它总是发送字符串`nvarchar`吗？如果是这样，是否`CF_SQL_VARCHAR`总是发送`varchar`？

我希望为了向后兼容，它是这样实现的：

如果`String Format`启用`CF_SQL_VARCHAR`并且`CF_SQL_NVARCHAR`两者都映射到`nvarchar`.

如果`String Format`禁用则`CF_SQL_VARCHAR`映射到`varchar`并`CF_SQL_NVARCHAR`映射到`nvarchar`。

这意味着任何 CF10 之前的站点都可以迁移到 CF10 并工作，具有与 CF10 之前相同的性能考虑。

新站点或重写所有查询以匹配`CF_SQL_VARCHAR`并`CF_SQL_NVARCHAR`与数据库设计相匹配的站点将不会受到 CF10 之前不可避免的性能损失。

任何人都可以确认是否是这种情况；如果有官方的东西更好？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-01T09:56:03.430

当你在等待更正式的东西时，我会投入我的 0.02 美元......

我做了一些挖掘，根据我的观察（使用 MS SQL 数据源），我相信：

*   `CF_SQL_NVARCHAR`不仅仅是`CF_SQL_VARCHAR`. 它映射到较新的[NVARCHAR jdbc 类型](http://docs.oracle.com/javase/6/docs/api/java/sql/Types.html#NVARCHAR)，它允许您在更精细的级别处理 unicode 值。

*   `CF_SQL_NVARCHAR`值始终被视为`nvarchar`

*   的处理`CF_SQL_VARCHAR`取决于[`String Format`](http://technet.microsoft.com/en-US/library/ms378857%28v=SQL.90%29.aspx)设置，与以前的版本相同。

**CF_SQL_NVARCHAR 测试/结果：**

如果启用数据源日志记录，您可以看到驱动程序在使用[`setNString`](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setNString%28int,%20java.lang.String%29)时调用特殊方法`CF_SQL_NVARCHAR`。所以最终值被发送到数据库作为`nvarchar`. （您可以使用 SQL Profiler 确认这一点）

```
 // Query
    SELECT  ID
    FROM    Test
    WHERE   NVarcharColumn = <cfqueryparam value="#form.value#" cfsqltype="cf_sql_nvarchar">

    // Log 
    spy(...)>> PreparedStatement[9].setNString(int parameterIndex, String value)

    // Profiler
    exec sp_prepexec @p1 output,N'@P1 nvarchar(4000)',N'SELECT  ID
            FROM    Test
            WHERE   NVarcharColumn = @P1 ',N'Стоял он, дум великих полн' 
```

**CF_SQL_VARCHAR 测试/结果：**

在 的情况下`CF_SQL_VARCHAR`，它在技术上被标记为`varchar`。但是，该`String Format`设置最终控制了数据库如何处理它。当设置启用时，它被处理为`nvarchar`。当它被禁用时，它被视为`varchar`. 同样，您可以使用 SQL Profiler 验证这一点。

最重要的是，到目前为止，我所看到的一切都表明您对实施的目标是正确的。

```
 // Query
    SELECT  ID
    FROM    Test
    WHERE   PlainVarcharColumn = <cfqueryparam value="#form.value#" cfsqltype="cf_sql_varchar">

    // Log
    spy(..)>> PreparedStatement[8].setObject(int parameterIndex, Object x, int targetSqlType)
    spy(..)>> parameterIndex = 1
    spy(..)>> x = ????? ??, ??? ??????? ????
    spy(..)>> targetSqlType = 12  (ie CF_SQL_VARCHAR)

    // Profiler (Setting ENABLED)
    exec sp_prepexec @p1 output,N'@P1 nvarchar(4000)',N'SELECT  ID
            FROM    Test
            WHERE   PlainVarcharColumn = @P1 ',N'Стоял он, дум великих полн'

    // Profiler (Setting DIS-abled)
    exec sp_prepexec @p1 output,N'@P1 varchar(8000)',N'SELECT  ID
            FROM    Test
            WHERE   PlainVarcharColumn = @P1 ','????? ??, ??? ??????? ????' 
```

# c# - 连接属性未初始化

> ID：10802389
> 
> 赞同：1
> 
> 时间：2012-05-29T15:43:03.073
> 
> 标签：c#, connection, oledb

我一直在为此尝试许多不同的命令和安排。这是一个用于将新联系人输入数据库的简单程序。我的第一个数据库东西。我有只接受字母的简单文本框，然后是只接受数字的邮政编码。不确定为什么我的“executenonquery()”会说“连接属性尚未初始化”。我错过了什么？

```
 string connection = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Documents and Settings\\Sales\\My Documents\\Google Drive\\Home\\Contacts\\Contacts.accdb";
        string command = "INSERT INTO [Contacts] (First Name, Last Name, Address, City, State/Province, ZIP/Postal Code) VALUES (@fname, @lname, @address, @city, @state, @zip)";
        OleDbConnection conn = new OleDbConnection(connection);
        OleDbCommand comm = new OleDbCommand();
        OleDbDataAdapter da = new OleDbDataAdapter();
        conn.Open();
        comm.Parameters.AddWithValue("@First Name", fname);
        comm.Parameters.AddWithValue("@Last Name", lname);
        comm.Parameters.AddWithValue("@Address", address);
        comm.Parameters.AddWithValue("@City", city);
        comm.Parameters.AddWithValue("@State/Province", state);
        comm.Parameters.AddWithValue("@ZIP/Postal Code", zip);
        comm.ExecuteNonQuery();
        conn.Close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T15:52:33.670

更改此行：

```
OleDbCommand comm = new OleDbCommand(); 
```

...到这两行：

```
OleDbCommand comm = new OleDbCommand(conn);
comm.commandText = command; 
```

您的命令对象需要引用一个打开的连接（我们通过使用带有连接对象的构造函数来获得），并且您的命令对象还需要设置其命令文本属性（否则系统不知道您查询什么'正在尝试运行）。

**编辑：**哎呀，有一段时间没有使用这些家伙了。你真正需要的是这一行：

```
OleDbCommand comm = new OleDbCommand(command, conn); 
```

# c# - 读取 SqlDataReader 时检查空白日期

> ID：10802395
> 
> 赞同：0
> 
> 时间：2012-05-29T15:43:14.577
> 
> 标签：c#, ado.net

我正在通过 sqlDataReader 使用来自数据库的结果填充我的对象，如下所示：

```
foreach (DataRow dr in dt.Rows)
{
  wt = new WorkTasksDto
  {
    CompletedBy = dr.IsNull("CompletedBy") ? (DateTime?)null : (DateTime?)dr["CompletedBy"]
  };
} 
```

正如您所看到的，我正在检查 DbNUll，但我的日期字段中的一条记录是空白的。不为空，就像一个空的 varchar 字段一样，当我尝试进行 DateTime 转换时，我得到一个无效的转换错误。

如何检查空白字段和​​ DbNull 字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:56:21.093

不是很干净，但这似乎有效。

```
foreach (DataRow dr in dt.Rows)                  
{                       
     DateTime myDate;
     if(dr.IsNull("CompletedBy")) 
         myDate = DateTime.MinValue;
     else
     {
         if(DateTime.TryParse(dr["CompletedBy"].ToString(), out myDate) == false)
             myDate = DateTime.MinValue;
     }
     wt = new WorkTasksDto                              
     {                                  
         CompletedBy = (myDate == DateTime.MinValue ? null : myDate);
     };         
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:01:25.660

如果列类型是`DateTime`值，则不能为“空白”。如果列类型为`string`，则应检查 null 和空白，而不是解析值而不是强制转换：

```
CompletedBy = dr["CompletedBy"] == null || dr["CompletedBy"] == "" ?
              null : 
              DateTime.Parse(dr["CompletedBy"], CultureInfo.InvariantCulture); 
```

如果您知道除了空白之外还有其他无法解析的值来代替`DateTime`使用`TryParse`

如果列类型是`object`并且您混合了不同的类型，则需要先验证类型，然后再进行强制转换。

```
CompletedBy = dr["CompletedBy"] != null && dr["CompletedBy"] is DateTime ?
              (DateTime)dr["CompletedBy"] : 
              null; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:45:38.207

使用`DateTime.TryParse()` [http://msdn.microsoft.com/en-us/library/system.datetime.tryparse.aspx](http://msdn.microsoft.com/en-us/library/system.datetime.tryparse.aspx)

```
DateTime completedDate;

DateTime.TryParse(reader["CompletedDate"].ToString(), out completedDate);

if(completedDate == DateTime.MinValue)
{

} 
```

# sql - 获取书面用户帖子和他推广的帖子

> ID：10802397
> 
> 赞同：1
> 
> 时间：2012-05-29T15:43:24.293
> 
> 标签：sql, blogs

目标有点难以解释，所以如果您需要更多信息，请通知我。

我正在创建一个博客，人们可以在其中发布文章，也可以宣传其他用户的帖子。用户帖子和推广帖子将出现在其个人资料页面中。

为了给你更多的信息，这件事已经在 tumblr 或 twitter（带有转推）中完成：在用户个人资料中，我们有它的推文，但也有他转发的推文。

以下是数据库表：

表“帖子”：

*   ID
*   author_id
*   标题
*   内容
*   创建

和“促销”表（人 X 提升职位 Y）：

*   ID
*   发起人 ID（推广帖子 Y 的用户 ID：X 先生）
*   post_id（提升的帖子：Y）
*   创建

给定一个用户 ID，我想检索他写的帖子和他推广的帖子。问题是：什么是 SQL（特别是 MySQL）查询？

并根据“创建”字段对列表进行排序。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:48:50.337

用户写的帖子很简单：

```
select * 
from posts 
where author_id=@your_user_id 
```

要获得用户推广的帖子，您可以执行以下操作：

```
select * 
from Promotions
where promoter_id =@your_user_id 
```

当然，您可能需要有关用户推广的帖子的信息，因此您必须加入两个表：

```
select p.title
from posts P join Propotions pro on pro.postId=p.id
where pro.promoter_id =@your_user_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T20:19:29.900

好的，我明白了。这是答案：

```
SELECT *
FROM Posts
LEFT JOIN Promotions ON Promotions.post_id = Posts.id
WHERE Posts.author_id = $userId
OR Promotions.promoter_id = $userId 
```

因此，当混合 LEFT JOIN 和 OR 条件时，魔术就会发生。

希望它会有所帮助。

PS。感谢所有参与者。

# android - Android PhoneGap - mwbrooks / cordova-plugin-menu

> ID：10802399
> 
> 赞同：0
> 
> 时间：2012-05-29T15:43:27.657
> 
> 标签：android, cordova, phonegap-plugins

我尝试安装以下插件，但没有成功： [https ://github.com/mwbrooks/cordova-plugin-menu](https://github.com/mwbrooks/cordova-plugin-menu)

我正在使用 PhoneGap 1.7.0

我有基本的 PhoneGap 项目设置并运行良好（Android 4.0.3）： [http ://docs.phonegap.com/en/1.7.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android](http://docs.phonegap.com/en/1.7.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android)

我不完全了解如何安装插件，但我做了以下操作：

```
1) Copied the \native\android\src\com\ to my project \src directory.
2) Copied the \native\android\libs\phonegap-1.0.0.jar to my project \libs\phonegap-1.0.0.jar 
```

当我作为 -> Android Project 运行时，出现以下错误：

```
Conversion to Dalvik format failed with error 1 
```

我是否正确安装了这个？如果我做了这个错误是什么？

如果没有，我该如何安装这个插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T17:40:52.503

`2) Copied the \native\android\libs\phonegap-1.0.0.jar to my project \libs\phonegap-1.0.0.jar`

`I'm using PhoneGap 1.7.0`

选一个。不能两者兼得...

# git - monodevelop 版本控制是如何工作的？

> ID：10802401
> 
> 赞同：18
> 
> 时间：2012-05-29T15:43:37.730
> 
> 标签：git, mono

我读到[v2.6 支持](http://monodevelop.com/Download/What%27s_new_in_MonoDevelop_2.6)带有 monodevelop 版本控制功能的 GIT，但在我安装的 monodevelop（稳定版 2.6）中找不到与版本控制有关的任何内容。

我尝试过右键单击项目，查看所有菜单选项等。事实上，我不能对与版本控制有关的任何内容进行单一引用，一般来说必须少用 git。

我必须遗漏一些东西，因为文档听起来很明显。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2015-04-16T11:04:18.047

如果您的 MonoDevelop 安装中缺少版本控制并且您正在运行 Linux，请尝试安装[monodevelop-versioncontrol](http://packages.ubuntu.com/lucid/monodevelop-versioncontrol)软件包。文档没有说明这一点。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-31T08:18:21.543

这是已经在 svn 或 git 版本控制（在我的 MonoDevelop 中）中的项目可以完成的操作： ![MonoDevelop 截图](../Images/722108223ebf4c51d4c812da89362830.png)

除了菜单选项之外，您还可以看到编辑器底部的栏，其中可以使用责备或日志等选项。

如果您的项目尚未受源代码控制，则可以选择发布它。您还应该能够从 MonoDevelop 主窗口签出存储库。

这都是来自 MonoDevelop 3.1，所以也许这些选项中的一些是后来引入的？不管真假，我还是建议你使用最新版本，代码完成**更好**，SCM 操作更快。更不用说很多其他的小修复了。

# .net - 是否可以使用按 2 列分组的数据创建“堆叠”条？

> ID：10802405
> 
> 赞同：1
> 
> 时间：2012-05-29T15:43:53.833
> 
> 标签：.net, charts

我有一个如下数据集

```
Col1        Col2       Col3
__________________________
Product1    Region1    23
Product1    Region1    34
Product1    Region2    45
Product2    Region1    12
Product2    Region2    33
Product2    Region1    33 
```

……

我想用 X 轴上的 Col1，Y 轴上的 SUM(Col3) 创建一个堆叠条，但是 Y 轴上的总和值必须由 Col2 堆叠。

我如何使用 ASP.NET 3.5 图表来管理它？

# c# - MVC URL 不重写

> ID：10802413
> 
> 赞同：0
> 
> 时间：2012-05-29T15:44:23.123
> 
> 标签：c#, asp.net-mvc, url, asp.net-mvc-routing, maproute

我正在尝试将用户浏览器中显示的 URL 从 Happy/Balloons 更改为 happy-times/balloon-pops。项目中有许多指向动作“Balloons”的链接，因此我不想更改这些链接，而是更改 global.asax，以便为同一动作显示不同的 URL。原始 MVC 路由如下所示：

```
routes.MapRoute(
            "Happy.Balloons",
            "Happy/Balloons/{groupId}/{paymentType}/{mortgageValue}/{province}",
            new { controller = "Happy", action = "Balloons" },
            new { groupId = "\\d+", paymentType = "\\d+", mortgageValue = "\\d+", province = "\\d+" }
        ); 
```

我已将代码更改为

```
routes.MapRoute(
            "Happy.Balloons",
            "happy-times/balloon-pops/{groupId}/{paymentType}/{mortgageValue}/{province}",
            new { controller = "Happy", action = "Balloons" },
            new { groupId = "\\d+", paymentType = "\\d+", mortgageValue = "\\d+", province = "\\d+" }
        ); 
```

我认为第二个参数是显示的 URL，但我得到一个：“您要查找的资源已被删除、名称已更改或暂时不可用。” 错误。有没有一种简单的方法可以通过修改 MapRoute 中的参数来做到这一点？如果是这样，怎么做？

问题跟进：[在 mvc 中更改操作的 URL](https://stackoverflow.com/questions/10803290/change-url-of-action-in-mvc)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:55:53.403

你这样做是错的。

更改路由映射不会更改控制器的名称。更改控制器和操作名称，并`{controller}/{action}`像默认一样映射您的路线。然后，您可以像以前一样设置默认控制器和操作。

然后你的控制器必须重命名为`happy-times`，你的动作重命名为`balloon-pops`

我应该注意到它看起来更像这样：

```
{controller}/{action}/{groupId}/{paymentType}/{mortgageValue}/{province} 
```

这是关于该主题的一个很好的资源。

[http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/asp-net-mvc-routing-overview-cs](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/asp-net-mvc-routing-overview-cs)

正如这篇 SO 帖子带给你的那样[https://stackoverflow.com/a/2375293/1178921](https://stackoverflow.com/a/2375293/1178921)

**看起来您可能正在尝试查看更多方法来做到这一点。

这篇文章讨论了您可以用来以不同方式路由 URL 的属性。 [ASP.NET MVC 通过方法属性路由](https://stackoverflow.com/questions/894779/asp-net-mvc-routing-via-method-attributes)

此外，您在映射中更改 url 的方式可以工作，但不是我认为您的意图。 在那种情况下，[扎克开发者已经死了这个。](https://stackoverflow.com/a/10802695/1178921)您的可选参数需要标记为`UrlParameter.Optional`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T16:01:23.457

这有效，（将 urlParameter.Optional 替换为默认值）

```
routes.MapRoute( _
            "Happy.Balloons", _
            "happy-times/ballons-pops/{groupId}/{paymentType}/{mortgageValue}/{province}", _
            New With {.controller = "happy", .action = "Balloons", .groupId = UrlParameter.Optional, .paymentType = UrlParameter.Optional, .mortgageValue = UrlParameter.Optional, .province = UrlParameter.Optional} _
    ) 
```

但是......这是一种不好的做法（真的很糟糕）

[你可以在这里](http://techjukebox.wordpress.com/2012/04/08/understanding-the-mvc-routing-process/)了解路线图

# asp.net - 在 HTML 中链接以转到 .aspx 页面

> ID：10802416
> 
> 赞同：0
> 
> 时间：2012-05-29T15:44:31.983
> 
> 标签：asp.net, html

我有一个链接到页面 default.aspx 的 html 页面 index.html，它们都在我的根目录中并且工作正常。index.html 包含一个 Flash 对象，该对象包含指向 default.aspx 的链接。但是，我想将索引页面替换为没有 flash 的普通 html 页面，并且我想将 default.aspx 的位置移动到安全目录。当我这样做时，default.aspx 页面不会加载，而是收到一条错误消息：

说明：解析服务此请求所需的资源时出错。请查看以下特定的解析错误详细信息并适当地修改您的源文件。

解析器错误消息：仅允许直接在包含内容控件的内容页面中使用内容控件。

源错误：

第 224 行：第 225 行：第 226 行：源文件：/mcc/default.aspx 行：226

有谁知道我必须做些什么来解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:50:32.070

根据我的猜测，您可能正在使用“母版页”，并且您在 aspx 页面中给出了“html/body”标签，这是不允许的。因此，要么使用母版页并在 aspx 页面中有一个 ContentPlaceHolder，要么删除母版页并将所有内容直接放在你的 aspx 页面中。我的建议是使用母版页。

希望这可以帮助！！

# python - 如何将 Excel 工作表另存为 CSV

> ID：10802417
> 
> 赞同：27
> 
> 时间：2012-05-29T15:44:35.387
> 
> 标签：python, excel, csv

我想编写一个 Python 脚本来读取 Excel 电子表格并将其一些工作表保存为 CSV 文件。

我怎样才能做到这一点？

我找到了用于从 Python 读取和写入 Excel 文件[的第三方模块](http://www.python-excel.org/)，但据我所知，它们只能以 Excel（即 *.xls）格式保存文件。如果我在这里错了，一些示例代码将不胜感激，这些示例代码显示了我正在尝试对这些模块执行的操作。

我还遇到了[一种](https://stackoverflow.com/questions/3730428/why-cant-i-save-as-an-excel-file-from-my-python-code)我不太理解的解决方案，但似乎是特定于 Windows 的，因此无论如何都对我没有帮助，因为我想在 Unix 中执行此操作。无论如何，我不清楚这个解决方案是否可以扩展为我想做的事情，即使在 Windows 下也是如此。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-05-29T16:36:26.100

使用这两个库的最基本示例逐行描述：

1.  打开 xls 工作簿
2.  参考第一个电子表格
3.  以二进制打开写入目标 csv 文件
4.  创建默认的 csv writer 对象
5.  遍历第一个电子表格的所有行
6.  将行转储到 csv

* * *

```
import xlrd
import csv

with xlrd.open_workbook('a_file.xls') as wb:
    sh = wb.sheet_by_index(0)  # or wb.sheet_by_name('name_of_the_sheet_here')
    with open('a_file.csv', 'wb') as f:   # open('a_file.csv', 'w', newline="") for python 3
        c = csv.writer(f)
        for r in range(sh.nrows):
            c.writerow(sh.row_values(r)) 
```

* * *

```
import openpyxl
import csv

wb = openpyxl.load_workbook('test.xlsx')
sh = wb.active
with open('test.csv', 'wb') as f:  # open('test.csv', 'w', newline="") for python 3
    c = csv.writer(f)
    for r in sh.rows:
        c.writerow([cell.value for cell in r]) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2017-07-25T08:09:21.183

使用`pandas`会更短一些：

```
import pandas as pd

df = pd.read_excel('my_file', sheetname='my_sheet_name')  # sheetname is optional
df.to_csv('output_file_name', index=False)  # index=False prevents pandas to write row index

# oneliner
pd.read_excel('my_file', sheetname='my_sheet_name').to_csv('output_file_name', index=False) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2020-09-28T09:32:26.690

**截至 2021 年 12 月和 Python 3：**

`openpyxl`API 已经发生了很大的变化（请参阅[https://openpyxl.readthedocs.io/en/stable/usage.html](https://openpyxl.readthedocs.io/en/stable/usage.html)），我已经通过@Boud（现在是@Zeugma？）更新了这部分答案，如下所示：

```
import openpyxl
import csv

wb = openpyxl.load_workbook('test.xlsx')
sh = wb.active # was .get_active_sheet()
with open('test.csv', 'w', newline="") as file_handle:
    csv_writer = csv.writer(file_handle)
    for row in sh.iter_rows(): # generator; was sh.rows
        csv_writer.writerow([cell.value for cell in row]) 
```

@Leonid 提出了一些有用的评论 - 特别是：

`csv.writer`提供了一些额外的选项，例如自定义分隔符：

```
csv_writer = csv.writer(fout, delimiter='|', quotechar='"', quoting=csv.QUOTE_MINIMAL) 
```

高温高压

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-29T15:47:00.430

使用[`xlrd`](https://secure.simplistix.co.uk/svn/xlrd/trunk/xlrd/doc/xlrd.html) or[`openpyxl`](http://packages.python.org/openpyxl/)模块分别读取 xls 或 xlsx 文档，使用[`csv`](http://docs.python.org/library/csv.html)模块进行写入。

或者，如果使用[Jython](http://jython.org/)，您可以使用[Apache POI](http://poi.apache.org/)库来读取`.xls`或`.xlsx`，并且本机 CSV 模块仍然可用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-01T17:30:17.987

首先将您的 Excel 电子表格读入 Pandas。`OrderedDict`下面的代码会将您的 Excel 电子表格作为包含所有工作表的文件导入 Pandas `DataFrames`。然后，只需使用`worksheet_name`as 键将特定工作表作为 a 访问，`DataFrame`并`csv`使用`df.to_csv()`. 希望这将适用于您的情况。

```
import pandas as pd
df = pd.read_excel('YourExcel.xlsx', sheet_name=None)
df['worksheet_name'].to_csv('output.csv') 
```

# python - 尝试打开现有文件时出现 IOError

> ID：10802418
> 
> 赞同：1
> 
> 时间：2012-05-29T15:44:35.357
> 
> 标签：python, file-io, ioerror, fileparsing

我编写的 python 程序有一个小问题，用于从特殊文本文件中提取一些信息。循环（下面的代码）需要`extract_zcoords()`在 500 个文件（1 个文件给出一个列表）上执行我的函数，以便我可以构建数据集。

```
import os

def extract_zcoord(filename): 
    f = open(filename, 'r')         
    ... # do something with f

### LOOP OVER DIRECTORY 
location = '/Users/spyros/Desktop/3NY8MODELSHUMAN/HomologyModels' 

for filename in os.listdir(location):
    extract_zcoord(filename) 
```

* * *

错误： IOException`No such file or directory`是发生的错误，因此由于某种原因 python 没有访问文件。我检查了目录路径名（位置）和文件权限，它们是正确的（读+写）。当文件确实存在并且路径名正确时，为什么会报告 IOError 的任何想法？

有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T15:52:50.557

可能，您应该在调用时使用 os.path.join

```
zdata.extend(extract_zcoord(filename)) 
```

像这样：

```
zdata.extend(extract_zcoord(os.path.join(location, filename))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T15:53:32.053

您需要将目录名和文件名加入一个完整的路径：

```
location = '/Users/spyros/Desktop/3NY8MODELSHUMAN/HomologyModels' 
for filename in os.listdir(location):
    filename = os.path.join(location, filename) 
```

# jquery - 仅当我有警报时更新才有效

> ID：10802422
> 
> 赞同：0
> 
> 时间：2012-05-29T15:44:46.830
> 
> 标签：jquery, alert

我编写了一个函数来对一列数字求和并更新表格下方的总数：

```
$(function () {
            function updateTotal() {

                var sum = 0;
                var totals = $('.drinkTotal')
                jQuery.each(totals, function () {

                    var rTotal = parseFloat($(this).text());
                    sum += rTotal;

                });

             //   alert();
                fSum = parseFloat(sum).toFixed(2);

                $("#MainContent_lblTotal").text(fSum);
            }
}); 
```

如果我取消注释警报，代码工作正常，但如果我删除它，标签不会更新。（它消失了？）

我如何在没有警报的情况下完成这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:07:15.563

从使用标签更改为标准 html 输入框解决了这个问题。

我猜这是因为控件被设置为在服务器上运行。（道歉 - 在问题中没有说清楚。）

# google-chrome - 谷歌浏览器扩展按钮弹出：如何使其持久化

> ID：10802428
> 
> 赞同：1
> 
> 时间：2012-05-29T15:45:12.253
> 
> 标签：google-chrome, google-chrome-extension, popup

我有一个非常简单的 Chrome 扩展程序，它会在屏幕右上角弹出一个气泡。在气泡中，我展示了我们网站的移动版本。

目前，当点击扩展图标时，气泡会弹出并加载移动主页。用户可以在气泡内四处点击并根据需要使用移动网站。

但是，一旦用户在气泡外单击，它就会关闭。再次单击重复上述过程。

我想知道是否有办法使气泡弹出/弹出持续存在？因此，当用户单击其他地方时它不会消失，而是会一直保持加载状态，直到用户再次单击扩展图标。这样，按钮充当开/关开关而不是单个事件触发器。

这可能吗，有人介意将我引导到可以帮助我做到这一点的代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T06:33:26.120

[如常见问题解答中所述](http://code.google.com/chrome/extensions/faq.html#faq-persist-popups)，这是不可能的。但是，[`chrome.windows.create`](http://code.google.com/chrome/extensions/windows.html#method-create)可能会满足您的需求。

# asp.net - 如何更新一对多关系

> ID：10802430
> 
> 赞同：0
> 
> 时间：2012-05-29T15:45:19.923
> 
> 标签：asp.net, entity-framework-4, one-to-many, insert-update

我有一个实体假设 [MainEntity]。这个主实体有一些子实体，如下所示：

```
MainEntity:
          -> ChildEntity1
          -> ChildEntity2
          -> ChildEntity3
          -> ChildEntity4
          -> ChildEntity5 
```

所有子实体与主实体具有一对多的关系。

在 UI 用户更新主实体和**前 3 个子实体**的数据。在 UI 中 ChildEntity1、ChildEntity2、ChildEntity3 分别由 GridView、ListBox 和 CheckListBox 表示。用户可以通过这些控件添加/更新子记录。插入/更新数据的示例代码如下：

```
BL class:
========
public class EntityManager
 {
      public EntityManager ()
      {
            MainEntityData = new MainEntity();
      }
      public MainEntity MainEntityData= { get; set; }

      public void InsertUpdate()
      {
            DAL.InsertMainEntityData(MainEntityData);

      }
}

UI Codes:
=========

EntityManager objEntityManager = new EntityManager();

if (lnkInsertUpdate.CommandArgument == "Update")
   objEntityManager.MainEntity.ID =                        
                         int.Parse(Request.QueryString["ID"].ToString());

objEntityManager.MainEntity.Name = txtName.Text;
objEntityManager.MainEntity.Description = txtDescription.Text;
-----------------------------------------
-----------------------------------

ChildEntity1 objChildEntity1 = null;
foreach (ListItem item in lstSelectedProduct.Items)
{
  objChildEntity1 = new ChildEntity();
  objChildEntity1.ClientProductID = int.Parse(item.Value);
  objChildEntity1.IsActive = true;
  objChildEntity1.CreatedBy = "Admin";
  objChildEntity1.CreatedDate = DateTime.Now;
  objEntityManager.MainEntity.ChildEntitys1.Add(objChildEntity1);
}

-----------------------------------
codes for childentity2,childentity3
--------------------------------
objEntityManager.InsertUpdate()

DALCodes:
=========
public static void InsertMainEntityData(MainEntity objMainEntity)
{
    using (TransactionScope ts = new TransactionScope())
    {
      try
      {
        using (DBEntities context = DatabaseFactory.GetContext())
        {
        if (objMainEntity.ID > 0)
        {
         MainEntity mainEntityToUpdate = 
 context.MainEntitys.Include("ChildEntity1").Include("ChildEntity2").Include("ChildEntity3").First(o => o.ID == objMainEntity.ID);

          mainEntityToUpdate = objMainEntity;
          context.MainEntitys.Attach(mainEntityToUpdate);
         context.ObjectStateManager.ChangeObjectState(mainEntityToUpdate, 
                       EntityState.Modified);
        }
       else
        {
                context.AddToMainEntitys(objMainEntity);
                context.SaveChanges();
                 ts.Complete();
           }
          catch (Exception ex)
          {
            ts.Dispose();
          }
           finally
           {
        }
} 
```

Insert new reord 工作正常，但在更新它时给出以下错误：

**ObjectStateManager 中已存在具有相同键的对象。ObjectStateManager 无法跟踪具有相同键的多个对象。**

请指导如何解决这个问题？？

谢谢，

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:12:00.147

您有此错误，因为您在此行中`mainEntityToUpdate`使用 detached覆盖加载：`objMainEntity`

```
mainEntityToUpdate = objMainEntity; 
```

然后你附加这个对象：

```
context.MainEntitys.Attach(mainEntityToUpdate); 
```

因为`mainEntityToUpdate`仍然附加到上下文（加载后），所以您有两个对象具有相同的键附加到上下文，这是被禁止的并导致异常。

您可以改为使用以下方法更新实体的标量属性：

```
MainEntity mainEntityToUpdate = context.MainEntitys
    .First(o => o.ID == objMainEntity.ID);

context.MainEntitys.ApplyCurrentValues(objMainEntity); 
```

但它只更新标量属性，而不是您的子集合 - 因为将状态设置为`Modified`也不会导致子集合的更新。

更新包含所有子集合的主实体实际上并不容易。您必须加载原始实体，包括数据库中的所有子集合（您开始加载主实体`Include("ChildX")`是正确的），然后将其与分离`objMainEntity`的集合及其更新的集合进行比较。“比较”意味着：您必须检测用户添加了哪些集合项，哪些已被删除，哪些仍然存在（但可能具有更改的属性值），然后相应地在原始集合中添加或删除项目。更改检测将跟踪这些更改，并在您调用时将相应的 SQL 语句写入数据库`SaveChanges`。

如何做到这一点的草图（对于`DbContext`/EF >= 4.1）在这里：[https ://stackoverflow.com/a/5540956/270591](https://stackoverflow.com/a/5540956/270591)

# java - javaj：输入/if语句出现故障

> ID：10802432
> 
> 赞同：-1
> 
> 时间：2012-05-29T15:45:21.730
> 
> 标签：java, console, readline, if-statement

以下代码块有一点问题：

```
newusr = c.readLine("New user? ");
if (newusr == "y") {
    System.out.println("IF");
    usnm = createNewUser();
    usnm = loginToClient();
}
else {
    System.out.println("ELSE");
    usnm = loginToClient();
} 
```

基本上，当我在提示中输入单个字符“y”时，它会将我带到 else 情况，从而直接进入 loginToClient 方法。这是怎么回事; “y”是不同的编码还是什么？

c 是一个控制台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:49:01.513

在java中使用equals来campare字符串，如下所示：

```
...
if (newusr.equals("y"))
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:49:00.540

你为什么不做一个`if(("y").equals(newusr))`检查？

`NullPointerException`如果您不输入值， 这也将避免。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T15:56:23.717

该代码`newusr == "y"`会将`newusr`变量的内存位置与`"y"`. 哪个会失败。

您应该使用`.equals()`方法比较对象。

# asp.net-mvc - 如何将 API 密钥从查询字符串移动到请求标头中？

> ID：10802442
> 
> 赞同：0
> 
> 时间：2012-05-29T15:46:04.443
> 
> 标签：asp.net-mvc, web-services, asp.net-mvc-4, api-key

我一直在研究随[本文](http://www.tugberkugurlu.com/archive/api-key-authorization-through-query-string-in-asp-net-web-api-authorizationfilterattribute)发布的示例代码。它有效，我可以按原样使用它。但是，我真的很想将 apikey 作为请求标头而不是查询字符串参数提交。这将使 URL 更清晰。

我看到了如何在 Fiddler 之类的工具中添加请求标头，但是如何修改代码以查看标头而不是查询字符串？

仅供参考，我正在使用 MVC 4 Beta ...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:11:15.343

如果您像“表单数据”（POST）那样发送它，则为表单提交插入查询字符串参数（GET）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T14:52:30.640

标头变量和 URL 参数是不同的，但通常在处理请求时您会在相同的数据结构中找到它们。我不熟悉 .NET，但您应该有一个可用的标头输入数组或哈希，就像您拥有 URL 参数一样。就像是

> System.Web.HttpContext.Current.Request.Headers["APIKey"];

似乎是候选人（更改 varname）

# javascript - 最小交叉口布局算法

> ID：10802443
> 
> 赞同：5
> 
> 时间：2012-05-29T15:46:07.903
> 
> 标签：javascript, graph, d3.js

我想知道是否有图形的最小交叉布局算法（不是基于力的）的任何示例，因此我可以将其调整为 d3.js。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T19:51:05.930

计算最小化边交叉的图的布局是 NP 难的，因此没有单一的算法；有不同的算法有不同的权衡。基于力的布局 ( [Fruchterman–Reingold](http://en.wikipedia.org/wiki/Force-based_algorithms_%28graph_drawing%29) ) 是一种方法，分层 ( [Sugiyama](http://en.wikipedia.org/wiki/Layered_graph_drawing) ) 是另一种方法。还有针对特定类型图的布局，例如树 ( [Reingold-Tilford](http://emr.cs.iit.edu/~reingold/tidier-drawings.pdf) ) 和小世界 ( [van Ham-van Wijk](http://www.research.ibm.com/visual/papers/smallworld.pdf) )。诸如 Dig-CoLa ( [Dwyer–Koren](http://www2.research.att.com/~north/papers_videos/pdf/DBLP-conf-infovis-DwyerK05.pdf) ) 之类的约束布局是另一类算法。

如果您想要一种专门寻求最小化边缘交叉数量的算法，您可以使用[模拟退火](http://en.wikipedia.org/wiki/Simulated_annealing)。虽然这最终会找到正确的答案，但它可能会很慢。

# jquery - 从 div 中关闭 div

> ID：10802447
> 
> 赞同：-1
> 
> 时间：2012-05-29T15:46:21.007
> 
> 标签：jquery, html

我创建了一个列表页面，其中每个列表都有自己的 div，该 div 的内容是通过 $.post 从单独的 php 脚本加载的

**我遇到的问题是试图隐藏列表，我认为问题可能与这条线有关**

$('div.close_listing')

只有我使用它才能让它工作

$('div.close_listing) （当我单击列表 div 中的任意位置时有效）

非常感谢任何帮助。

清单的 html 代码是：

```
<div id='listing'>
   <div id='loading'></div>
   <a name='13'><h3>Business1</h3></a> <h4 data-id=18-3-3>Name Of Business 1</h4>
    <div>
        <hr>
     *** content forbusiness1 appears here ***
          <div class='close_listing'>CLOSE this listing</div>
    </div>

   <a name='14'><h3>Business2</h3></a> <h4 data-id=19-3-3>Name Of Business 2</h4>
    <div>
        <hr>
     *** content for business2 appears here ***
          <div class='close_listing'>CLOSE this listing</div>
    </div>

</div> 
```

调用内容的代码如下：

```
$(document).ready(function() { 
$('div.listing> div').hide();  
$('div.listing> h4').click(function() {
$('div.listing> div').empty().html('<img src="loading_image.gif" /><br>Retrieving Details.....');
$.post("http://www.example.com/record.php", { id: $(this).attr('data-id') });

$.post('show.php',{ id: $(this).attr('data-id')}, function(data) {
$('div.listing> div').html(data); 

$('div.listing .close').visible();
});

var $nextDiv = $(this).next();
var $visibleSiblings = $nextDiv.siblings('div:visible');

if ($visibleSiblings.length ) {
  $visibleSiblings.slideUp('fast', function() {
    $nextDiv.slideToggle('fast');
  });
} else {
   $nextDiv.slideToggle('fast');
} 
});

// closes the listing down

$('div.close_listing').click(  
function() {
$('div.listing> div').hide(); 
}); 

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:17:56.997

我认为你应该这样做：

```
<a href="javascript:$(this).parent().hide();">CLOSE this listing</a> 
```

如果我没有误解你的目的。:D

# javascript - 跨域AJAX调用，授权对文件内容的所有请求？

> ID：10802449
> 
> 赞同：0
> 
> 时间：2012-05-29T15:46:29.207
> 
> 标签：javascript, ajax

我想为其他网站提供我网站的横幅，但我想将横幅保留在我的服务器上，并让它们包含在 javascript 中，就像 Facebook 插件/谷歌广告一样。

横幅托管在站点 A 上。站点 BI 具有以下代码：

```
<div id="bannerContainer"></div>
<script type="text/javascript" src="http://mysite.com/plugins/includebanner.js"></script> 
```

includebanner.js 执行 AJAX 调用以获取横幅并将其放置在bannerContainer 中，但出现错误：

```
Origin http://lventas.com is not allowed by Access-Control-Allow-Origin. 
```

如何允许所有网站包含横幅？是否有其他简单的方法可以包含来自其他站点的站点 A 中托管的横幅？

**编辑：**

```
This is the script that requests the content:

function ajax(url, id_contenedor)
{
    var pagina_requerida = false;
    if (window.XMLHttpRequest)
    {
        pagina_requerida = new XMLHttpRequest ();
    } else if (window.ActiveXObject)
    {
        try 
        {
            pagina_requerida = new ActiveXObject ("Msxml2.XMLHTTP");
        }
        catch (e)
        {
            try
            {
                pagina_requerida = new ActiveXObject ("Microsoft.XMLHTTP");
            }
            catch (e)
            {
            }
        }
    } 
    else
    return false;
    pagina_requerida.onreadystatechange = function ()
    {
        cargarpagina (pagina_requerida, id_contenedor);
    }
    pagina_requerida.open ('GET', url, true); // asignamos los métodos open y send
    pagina_requerida.send (null);
}
function cargarpagina (pagina_requerida, id_contenedor)
{
    if (pagina_requerida.readyState == 4 && (pagina_requerida.status == 200 || window.location.href.indexOf ("http") == - 1))
    document.getElementById (id_contenedor).innerHTML = pagina_requerida.responseText;
}

ajax('http://lujanventas.com/plugins/banner/index.php', 'banner-root'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:51:46.607

看来您遇到了正常的 JS 跨站点脚本限制。默认情况下，跨站点脚本功能对可以调用端点的对象和对象施加一些限制。您没有提供任何代码示例，但您可以查看此链接作为示例：http: [//jquery-howto.blogspot.com/2009/04/cross-domain-ajax-querying -with-jquery.html](http://jquery-howto.blogspot.com/2009/04/cross-domain-ajax-querying-with-jquery.html)

**编辑：**

查看 JavaScript 调用本身会有所帮助，但是如果您将错误插入 Google 或 Bing，对我来说，第一个结果是另一个 SO 帖子：[XmlHttpRequest 错误：Access-Control-Allow-Origin 不允许 Origin null](https://stackoverflow.com/questions/3595515/xmlhttprequest-error-origin-null-is-not-allowed-by-access-control-allow-origin)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:02:55.900

使用 javascript/jquery，您可以绘制 iframe 而不是 div，并将其 src 属性设置为横幅的 url。

```
$('<iframe />', {
    name: 'myFrame',
    id:   'myFrame',
    src:  'http://www.mywebsite.com/'
}).appendTo('body'); 
```

# javascript - 使用 JavaScript 和/或 jQuery 根据值搜索关联的多维数组（对象）的有效方法

> ID：10802450
> 
> 赞同：3
> 
> 时间：2012-05-29T15:46:29.473
> 
> 标签：javascript, jquery, search, object

我有一个看起来与此类似的对象：

```
var arr = {};

arr.planes = { prop1 : 'a', prop2 : 'b', prop3 : 'c' };
arr.trains = { prop1 : 'x', prop2 : 'y', prop3 : 'z' };
arr.autos = { prop1 : 'red', prop2 : 'orange', prop3 : 'blue' }; 
```

我正在尝试编写一个函数（快速且高效），它将基于嵌套在其中的键/值对返回最外层数组的键（或键的数组，如果有超过 1 个）。就像是：

```
function getKey(obj, prop, val) {
   // do some stuff...
   return key;
}

var myKey = getKey(arr, 'prop2', 'orange'); 
```

myKey 的值应该是“autos”。

我很确定这可以通过几个嵌套的 for 循环来完成，但是这些数组相当大，我认为，尤其是使用 jquery 的 grep()，必须有更好的方法......或者可能没有 -我现在只是难住了。

任何见解将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T17:50:26.577

除了像 chris 那样改变你的数据结构之外，这几乎是你唯一的选择：

```
function getKey(obj, prop, val) {
    var keys = [];

    for (var key in obj) {
        if (obj[key].hasOwnProperty(prop) && obj[key][prop] === val) {
            keys.push(key);                
        }            
    }

    return keys;
} 
```

不需要嵌套循环，您只需遍历每个数组元素一次.. 在我看来非常有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T17:47:19.900

在现代浏览器中，您可能会惊讶于 for 循环在数组上执行的速度有多快。

但是，您也可以为此维护不同的数据结构。
只需使用一些循环来构建一个像这样结构的新对象

```
var map = {
    prop1: {a: ["planes"], x: ["trains"], red: ["autos"]}
  , prop2: {...}
};

function getKey(prop, val) {
   return map[prop][val] || [];
} 
```

然后从那时起查找速度非常快。

我假设这些值是标量，否则这将不起作用，因为只有标量可以用作属性名称。

# iphone - ScrollView 中的 UIScrollView - 未显示 ScrollBars

> ID：10802454
> 
> 赞同：1
> 
> 时间：2012-05-29T15:46:39.550
> 
> 标签：iphone, objective-c, ios, ios4, uiscrollview

**背景故事**

我正在编写一个 ipad 应用程序，该应用程序具有使用 UIScrollView 水平滚动的图像。这工作正常。现在对于每个图像，我需要一个 UIScrollView ，其中包含某种解释图像的文本。这将是一个垂直滚动视图。垂直 ScrollView 出现，但随后滚动条不出现。知道为什么吗？下面的代码：

```
CGRect scrollViewFrame = CGRectMake(760, 70, 205, 320);
UIScrollView * contentScrollView = [[UIScrollView alloc]initWithFrame:scrollViewFrame];
[contentView addSubview:contentScrollView];
CGSize scrollViewContentSize = CGSizeMake(205, 100);
[contentScrollView setContentSize:scrollViewContentSize];
[contentScrollView setPagingEnabled:YES];
contentScrollView.delegate = self;

UILabel *titleLable = [[UILabel alloc] initWithFrame:CGRectMake(10, 10, 205, 40)];
UILabel *subtitleLable = [[UILabel alloc] initWithFrame:CGRectMake(10, 60, 205, 50)];
UITextView * mainContent = [[UITextView alloc]initWithFrame:CGRectMake(10, 110, 205, 230)];

[titleLable setText:storyTitle];
[subtitleLable setText:storySubTitle];
[contentView setUserInteractionEnabled:YES];
[mainContent setText:storyDescription]; 
```

此外，主 scrollView 已经使用 Interface Builder 添加并且工作正常。wnyone知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:56:34.093

滚动视图仅显示滚动条，并允许用户在内容大小大于滚动视图大小时滚动，正如我在您的代码中看到的那样，滚动视图大小为 (205, 320) 而内容大小仅为 (205, 100)。

# android - 何时会调用有界服务的 onServiceConnected？

> ID：10802456
> 
> 赞同：8
> 
> 时间：2012-05-29T15:46:42.447
> 
> 标签：android, service

我正在尝试从另一个服务绑定服务，如下所示：

```
public class ServiceA extends Service {
    private ServiceB mDataService;
    private boolean mIsBound;

    @Override
    public void onCreate(){
        super.onCreate();
        doBindService();
        /* ... */
    }

    @Override
    public void onStart(final Intent intent, final int startId){
        /*...*/
    }

    private ServiceConnection mConnection = new ServiceConnection() {
        public void onServiceConnected(ComponentName className, IBinder service) {            
            mDataService = ((ServiceB.LocalBinder)service).getService();
        }
        public void onServiceDisconnected(ComponentName className) {             
            mDataService = null;
        }
    };

    void doBindService() {          
        bindService(new Intent(ServiceA.this, ServiceB.class), mConnection, Context.BIND_AUTO_CREATE);          
        mIsBound = true;
    }

    void doUnbindService() {
        if (mIsBound) {                     
            unbindService(mConnection);
            mIsBound = false;
        }
    }       
} 
```

这是我从 goolge 的示例中获取的一个简单片段 :) 代码运行良好，并且 mDataService 包含对 ServiceB 实例的引用，但有一点我无法理解：`onServiceConnected`回调是在调用`onStart`. 正如我在 android 的文档上看到的，[回调在主线程上运行](http://developer.android.com/reference/android/content/ServiceConnection.html#onServiceConnected%28android.content.ComponentName,%20android.os.IBinder%29)- 但我可以指望它在我的情况下总是按这个顺序发生吗？onCreate -> onStart -> onServiceConnected ？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-29T22:00:26.937

如果官方开发指南（仍然）不清楚，**那么 Context.bindService() 确实是一个异步调用**。这也解释了为什么**`ServiceConnection.onServiceConnected()`**实现为回调。

查看[开发指南](http://developer.android.com/guide/topics/fundamentals/bound-services.html#Basics)：

> 客户端通过调用绑定到服务`bindService()`。当它这样做时，它必须提供一个实现`ServiceConnection`，它监视与服务的连接。
> 
> 的返回值`bindService()`指示请求的服务是否存在以及是否允许客户端访问它。
> 
> 当 Android 系统在客户端和服务之间建立连接时，它会调用`onServiceConnected()`. `ServiceConnection`该`onServiceConnected()`方法包括一个`IBinder`参数，然后客户端使用该参数与绑定的服务进行通信。

**`ServiceConnection.onServiceConnected()`**一旦正确建立到服务的连接，在将来的某个时间点在 UI 线程上调用（不是在调用 Context.bindService() 之后立即调用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T16:05:48.820

我不会依赖它。这取决于 ServiceA 和 ServiceB 是在相同的进程中运行还是在不同的进程中运行。它可能还取决于 ServiceB 是否已经启动。你应该编写你的代码，这样你就不会依赖于这个事件序列。

# java - JPA createQuery 和刷新/清除

> ID：10802457
> 
> 赞同：4
> 
> 时间：2012-05-29T15:46:43.773
> 
> 标签：java, jpa

以下代码有效，但是如果我删除了 flush() 和 clear() 调用，那么对 showTable() 的第二次调用不会显示更新后的名称“joan”，而是“john”。

在不调用flush（）和clear（）的情况下，实现这一目标的正确方法是什么？

```
import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.Query;

import org.junit.Test;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.AbstractTransactionalJUnit4SpringContextTests;
import org.springframework.test.context.transaction.TransactionConfiguration;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

import com.example.Customer;

@ContextConfiguration(locations = {"classpath:spring/test/spring-test.xml"})
@TransactionConfiguration(transactionManager = "txManager")
public class Test extends AbstractTransactionalJUnit4SpringContextTests {
    private final Logger log = LoggerFactory.getLogger(getClass());

    @PersistenceContext
    private EntityManager entityManager;

    @Test
    @Transactional(propagation = Propagation.REQUIRES_NEW)
    public void test() throws Exception {
        Customer customer = new Customer();
        customer.setName("john");

        entityManager.persist(customer);
        entityManager.flush();
        entityManager.clear();

        showTable();

        final Query query = entityManager.createQuery("update Customer c set c.name='joan'");
        int updateCount = query.executeUpdate();
        log.debug("Update count: " + updateCount);
        entityManager.flush();
        entityManager.clear();

        showTable();
    }

    public void showTable() {
        final Query query = entityManager.createQuery("select c FROM Customer c");
        List<Customer> list = query.getResultList();
        for (Customer customer: list) {
            log.info("customer name: " + customer.getName());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T17:20:56.737

第一个测试不需要刷新或清除，因为实体管理器必须检测到查询结果可能会受到尚未保存的未决更改的影响。因此，在执行查询之前，您不必刷新（），甚至不必清除（）。

然而，第二个测试是不同的。您正在执行更新查询，这些查询完全绕过一级缓存。他们在背后对数据库进行更改。这就是您需要清除的原因：如果您不清除，则选择查询将找到已经在缓存中的客户，并且将返回缓存（但已过时）的实体。

# database - 数据库调优和数据库查询优化有什么区别？

> ID：10802463
> 
> 赞同：2
> 
> 时间：2012-05-29T15:47:11.240
> 
> 标签：database, query-optimization, database-tuning

有人能告诉我数据库调优和数据库查询优化之间的确切区别吗？

我已阅读 Wikipedia 上的以下链接：

[http://en.wikipedia.org/wiki/Query_optimization](http://en.wikipedia.org/wiki/Query_optimization)

[http://en.wikipedia.org/wiki/Database_tuning](http://en.wikipedia.org/wiki/Database_tuning)

据我了解，似乎数据库调优不过是数据库查询优化。我还是一头雾水

两者之间究竟有什么区别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T16:02:04.253

数据库调优是指对数据库本身进行调优。它访问存储和内存。各种缓冲区和运行时参数的组织。以及使用索引优化模式、（反）规范化、模式对象上的存储参数等等。

查询优化一次只关注一条语句。它可能涉及重组语句、创建索引和物化视图、添加提示和更新统计信息。

虽然两者之间存在重叠（当数据库性能更好时，单个语句也可能更快），但它们的目标通常相互矛盾。如果您一次调整一条语句，您可能会创建大量索引，但每个索引都会为数据库增加一点额外的负载来写入该表，因此整体性能实际上可能会受到影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:54:09.450

我会说查询优化是数据库调优的一个子集。如果您查看任何有关性能调优的通用书籍，您通常只会看到与调优查询相关的一章。其他章节与分区、索引、负载测试、锁定和阻塞、硬件、内存、模式等有关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T15:59:43.283

我了解查询优化与查询本身有关，因此例如，您可以改进实现不佳的联接，删除不必要的字段等。仅会影响正在分析的查询的事情。

数据库调优涉及整个服务器，因为索引、查询负载，甚至与 IO 相关的事情，例如将数据库分区或拆分为不同磁盘中的不同文件组。

# python - Python HTTP Post 失败

> ID：10802464
> 
> 赞同：0
> 
> 时间：2012-05-29T15:47:12.087
> 
> 标签：python, http-post

在搜索了如何使用 python 发布大文件之后，我遇到了[这个](https://stackoverflow.com/questions/2502596/python-http-post-a-large-file-with-streaming)，并基于它编写了一个程序，但是当我运行它时，我收到以下错误消息：

```
 Traceback (most recent call last):
  File "Test3.py", line 187, in <module>
    main()
  File "Test3.py", line 184, in main
    do_upload(options, args)
  File "Test3.py", line 48, in do_upload
    response = urllib2.urlopen(request)
  File "C:\Python27\lib\urllib2.py", line 126, in urlopen
    return _opener.open(url, data, timeout)
  File "C:\Python27\lib\urllib2.py", line 400, in open
    response = meth(req, response)
  File "C:\Python27\lib\urllib2.py", line 513, in http_response
    'http', request, response, code, msg, hdrs)
  File "C:\Python27\lib\urllib2.py", line 438, in error
    return self._call_chain(*args)
  File "C:\Python27\lib\urllib2.py", line 372, in _call_chain
    result = func(*args)
  File "C:\Python27\lib\urllib2.py", line 521, in http_error_default
    raise HTTPError(req.get_full_url(), code, msg, hdrs, fp)
urllib2.HTTPError: HTTP Error 500: Internal Server Error 
```

这是我的代码，用于运行我使用的程序`--upload "path_to_file" [space] "filename"`。我是 python 编程的新手，所以大部分内容仍然让我感到困惑。

```
def do_upload(options, args):
    url = 'http://127.0.0.1/test_server/upload'

    path = args[0]
   # print path
    filename = args[1]
    if not os.access(args[0], os.F_OK):
                print "Directory/file Doesn't exist"
                exit(1)

    os.chdir(path)
    f = open(filename, 'rb')
    mmapped_file_as_string = mmap.mmap(f.fileno(), 0, access=mmap.ACCESS_READ)

    request = urllib2.Request(url, mmapped_file_as_string)
    contenttype = mimetypes.guess_type(filename)[0] 
    request.add_header(contenttype, 'application/octet-stream')
    response = urllib2.urlopen(request)

    #close everything
    mmapped_file_as_string.close()
    f.close() 
```

**更新**

我已经从上面更改了代码，现在我收到了一些套接字错误。

**更新代码**

```
def do_upload(options, args):

    host = 'http://localhost:80'
    selector = '/test_server/upload'
    url = 'http://localhost:80/test_server/upload'

    if len(args) == 2:
        print "len of args = 2"
        files = "File is " + str(args[1])
        print files
        path = args[0]
        print "Path is " + str(args[0])

    content_type, body = encode_multipart_formdata(files)
    h = httplib.HTTP(host)
    h.putrequest('POST', selector)
    h.putheader('content-type', content_type)
    h.putheader('content-length', str(len(body)))
    h.endheaders()
    h.send(body)
    errcode, errmsg, headers = h.getreply()
    return h.file.read()

    f = open(files, 'rb')
    mmapped_file_as_string = mmap.mmap(f.fileno(), 0, access=mmap.ACCESS_READ)
    request = urllib2.Request(url, mmapped_file_as_string)
    request.add_header('Content-Type', content_type)
    response = urllib2.urlopen(request)

    mmapped_file_as_string.close()
    f.close()

def encode_multipart_formdata(files):

    BOUNDARY = '----------ThIs_Is_tHe_bouNdaRY_$'
    CRLF = '\r\n'
    L = []

    for (filename) in files:
        L.append('--' + BOUNDARY)
        L.append('Content-Disposition: form-data;  filename="%s"' % (filename))
        L.append('Content-Type: %s' % get_content_type(filename))
        L.append('')
        #L.append(value)
    L.append('--' + BOUNDARY + '--')
    L.append('')
    body = CRLF.join(L)
    content_type = 'multipart/form-data; boundary=%s' % BOUNDARY
    return content_type, body

def get_content_type(filename):
    return mimetypes.guess_type(filename)[0] or 'application/octet-stream' 
```

**错误信息**

```
Traceback (most recent call last):
  File "Test3.py", line 208, in <module>
    main()
  File "Test3.py", line 205, in main
    do_upload(options, args)
  File "Test3.py", line 41, in do_upload
    h.endheaders()
  File "C:\Python27\lib\httplib.py", line 951, in endheaders
    self._send_output(message_body)
  File "C:\Python27\lib\httplib.py", line 811, in _send_output
    self.send(msg)
  File "C:\Python27\lib\httplib.py", line 773, in send
    self.connect()
  File "C:\Python27\lib\httplib.py", line 754, in connect
    self.timeout, self.source_address)
  File "C:\Python27\lib\socket.py", line 553, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
socket.gaierror: [Errno 11004] getaddrinfo failed 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T15:58:41.100

您正在设置一个不存在的标头而不是`Content-Type`标头：

```
request.add_header(contenttype, 'application/octet-stream') 
```

将其更改为：

```
request.add_header('Content-Type', contenttype) 
```

反而。

但是，您最大的问题是您没有上传分段 POST，而只是将文件本身作为 POST 正文，而您的服务器只需要分段上传。

看看这个 SO 答案，以非常简单的方式生成适当的多部分 POST 正文：[https](https://stackoverflow.com/a/681182/100297) ://stackoverflow.com/a/681182/100297 。请注意，您必须相应地调整 Content-Type 标头。

# javascript - navigator.onLine 连接不良

> ID：10802466
> 
> 赞同：0
> 
> 时间：2012-05-29T15:47:25.290
> 
> 标签：javascript, html

这与我之前的问题有关，但是如果连接不好，navigator.onLine 会起作用吗？例如，设备已连接到路由器，但不会加载任何页面，或者任何其他会带来错误，告诉用户检查其连接的情况。我知道 navigator.onLine 在完全禁用连接时可以工作，但是除非您遇到连接不良，否则没有办法模拟不良连接。如果它不起作用，我可以用javascript做任何测试来ping服务器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:52:25.243

[从文档中：](https://developer.mozilla.org/en/DOM/window.navigator.onLine)

> 在 Chrome 和 Safari 中，如果浏览器无法连接到局域网 (LAN) 或路由器，则它处于离线状态；所有其他条件都返回 true。因此，虽然您可以假设浏览器在返回 false 值时处于脱机状态，但您不能假设 true 值必然意味着浏览器可以访问互联网。

换句话说，一个坏的连接将返回`true`。

要回答您的第二个问题，是的，您可以通过对您的服务器的 AJAX 调用来 ping 服务器。如果成功（您得到响应），那么您知道浏览器在线。如果超时，用户可能会遇到连接错误。

# bash - Cygwin 和 Bash：标准输出重定向导致“。” 在文件的末尾？

> ID：10802472
> 
> 赞同：0
> 
> 时间：2012-05-29T15:47:38.370
> 
> 标签：bash, cygwin, stdout

如果我在 Cygwin 中重定向 linux 命令的输出，例如

```
ls -l > lsl.txt 
```

文件 lsl.txt 按预期创建

但是，如果我在 bash 脚本中执行相同操作并在 Cygwin 中调用它，则创建的是：

```
lsl.txt . 
```

大多数编辑器无法打开此文件，我假设对其进行操作或以编程方式对其进行解析会很麻烦。

是什么导致了这个'。附加到文件中，我该如何避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:56:30.520

这可能是由于 bash 脚本中的 Windows 行尾 (CR-LF) 造成的。确保您使用的是 Unix 换行符 (LF)。

# c++ - VS2010 致命错误 LNK1120: 1 未解决的外部

> ID：10802476
> 
> 赞同：1
> 
> 时间：2012-05-29T15:47:56.343
> 
> 标签：c++, visual-c++

我已经为此工作了一段时间，但我似乎无法弄清楚。我无法编译代码，因为它不断抛出以下错误。基本上我想要做的是创建一个向量，其中包含使用指针来自基类和派生类的对象。

Final Assignment.obj：错误 LNK2019：未解析的外部符号“public：__thiscall Product::Product(void)”(??0Product@@QAE@XZ) 在函数“public: __thiscall SaleProduct::SaleProduct(char,class std: :basic_string,class std::allocator >,int,double,double)" (??0SaleProduct@@QAE@DV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@ std@@HNN@Z)
致命错误 LNK1120: 1 未解决的外部

```
#include "stdafx.h"
#include <iostream>
#include <fstream>
#include <iomanip>
#include <vector>
#include <string>
using namespace std;

class Product
{

public:

Product();
Product(char iT,string des,int inv,double p,double dis)
{
invType = iT;
description = des;
inventory = inv;
price = p;
discount = dis;
}

char getInvType(){
return invType;
}

protected:
char invType ;
string description;
int inventory;
double price;
double discount;
};

class SaleProduct:public Product {

public:

//SaleProduct();
SaleProduct(char iT,string des,int inv,double p,double dis){

}

};

int main()
{
int choice = 0;
// SaleProduct* SaleProductOB;
// Product *productPoint = &ProductOB;
 vector<Product*> inventoryVec;

  char invType;
  string description;
  int inventory;
  double price;
  double discount = 0;

ifstream inFile("Inventory.txt");

if (inFile.is_open()){

while (inFile >> invType >> description >> inventory >> price >>discount){

      if (invType == 'S'){

           inventoryVec.push_back(new SaleProduct(invType,description,inventory,price,discount)  );
     }else{
    //inventoryVec.push_back(new Product(invType,description,inventory,price,discount)  );

      }

}
}else{
cout << "File is not ready!";
}

cout << inventoryVec.size() << endl;

while (choice != 3) {
        cout << "Please enter your choice:" << endl;
        cout << "1\. Print available items"  << endl;
        cout << "2\. Add item to cart"       << endl;
        cout << "3\. Print receipt and quit" << endl << endl;

        cin >> choice;
 }

//system("PAUSE");
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:55:24.200

您可能需要指定正确的构造函数（因为它正在尝试使用没有实际定义的默认构造函数）：

```
SaleProduct(char iT,string des,int inv,double p,double dis) : 
   Product(iT, des, inv, p, dis ){ 
```

# javascript - SQLite 和 JayData

> ID：10802478
> 
> 赞同：3
> 
> 时间：2012-05-29T15:47:58.740
> 
> 标签：javascript, html, sqlite, jaydata

是否可以使用 jaydata 在 html 5 css js 页面中直接读取 sqlite 数据库？这不使用 php 或 asp.net 引擎？

**编辑：http:** [//jaydata.org/](http://jaydata.org/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:58:42.460

因为它声称支持 webSQL（就在主页的顶部）……</p>

> JayData 是一个统一的数据访问库，供 JavaScript 开发人员查询和更新来自不同来源（如 webSQL、indexedDB、OData、Facebook 或 YQL）的数据。

……——是的（因为所有已知的 webSQL 实现都在底层使用 SQLite……这就是[W3C 建议](http://www.w3.org/TR/webdatabase/)停止工作的原因）。

（虽然需要注意的是，webSQL 在浏览器中运行，而不是存在于服务器上的*共享*数据库。将数据库服务器直接暴露给 WWW 通常是一个非常糟糕的主意™，而 SQLite 是一个纯文件数据库，而不是一个一台服务器，所以它需要直接访问服务器的文件系统到万维网，这超出了疯狂的范围）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T12:11:35.070

浏览器中的 HTML 页面无法访问本地数据库，因为它无法访问本地文件系统。如果你想做这样的事情，比如从 HTML 页面打开一个 sqLite 数据库文件，你必须将你的 HTML5 应用程序嵌入到一个原生的 shell 中，比如 phonegap。有了它，您只需使用 JavaScript 就可以在 HTML 页面中使用 JayData 处理 sqLite 数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T13:17:35.647

您可以在以下 URL 处将 PhoneGap 与 SQLLite 一起使用，这是一个工作示例。

[https://groups.google.com/group/phonegap/browse_thread/thread/07cf9f48e3cd0663?pli=1](https://groups.google.com/group/phonegap/browse_thread/thread/07cf9f48e3cd0663?pli=1)

问候....

# asp.net - asp.net 错误 svc.log 的远程日志报告？

> ID：10802479
> 
> 赞同：0
> 
> 时间：2012-05-29T15:48:01.967
> 
> 标签：asp.net, asp.net-mvc-3

我有几个 asp.net 应用程序和服务器（产品、测试版）在不同的盒子上运行，它们跟踪到不同的 svc.logs。

对于基于 Web 的远程日志查看器解决方案有哪些建议，以便支持人员无需映射驱动器或远程登录即可查看日志？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T15:52:25.047

也许您应该将日志写入具有快速写入功能的数据库，例如 MongoDB。

然后创建一个查询此数据库的应用程序。

不仅您将您的日志集中在一个独特的点，因此很容易查询；但您也将避免 Web 服务器上的额外负载（用于查询日志）。

Web 服务器可以简单地以推送和忘记的方式发送数据（消息队列有助于扩展）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-09T14:38:35.700

我建议您尝试[cloud4apps](https://www.cloud4apps.com)远程错误记录服务。它使用起来非常简单，并且可以与任何来源轻松集成。它在 Microsoft 云服务上运行，并为您的日志和广泛的报告功能提供聚合视图。

# c++ - 在结构上使用模板时遇到问题

> ID：10802480
> 
> 赞同：0
> 
> 时间：2012-05-29T15:48:03.467
> 
> 标签：c++, templates, struct

我是编程和 C++ 的初学者。我以前使用过模板，但方式非常有限，我不知道我做错了什么：

```
template <typename TElement>
struct list{    // if I try list<TElement> => list is not a template
    TElement data;
    struct list *next;
} node_type;    // also tried node_type<TElement>, other incomprehensible errors
node_type *ptr[max], *root[max], *temp[max]; 
```

我发现错误有点难以理解：`"node_type does not name a type"`
我做错了什么？

**我打算做什么：**
我想要一个类型列表（所以我可以在几个完全不同的抽象数据类型上使用它 - ADT），所以我想得到这样的结果：

```
Activities list *ptr[max], *root[max], *temp[max] 
```

如果这有任何意义（哪里`Activities`是一个类，但可以是任何其他类）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T15:50:35.587

试试这个：

```
template <typename TElement>
struct node{   
    TElement data;
    node* next;
};    

node<int>* ptr[max], *root[max], *temp[max]; 
```

另一个建议：避免在标准 C++ 库中的类型之后命名您的自定义类型（例如`list`, `vector`, `queue`... 它们都在 namespace 中`std`）。它令人困惑，并且可能导致名称冲突（除非您将其放置在您自己的命名空间中，您需要在放置的任何地方明确使用该命名空间`using namespace std;`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T16:17:31.467

不要试图通过反复试验和猜测语法来学习 C++，读一[本好书](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)。

```
template <typename TElement>
  struct list{ 
```

这声明了一个名为的结构模板`list`，它有一个模板参数 ，`TElement`它用作您实例化模板的类型的别名（仅在模板的主体内）。

如果您实例化`list<int>`然后`TElement`将参考`int`. 如果您实例化`list<char>`然后`TElement`将参考`char`. 等等

`TElement`因此，您实例化模板的类型将在您的模板定义中被替换。

您尝试时遇到的错误：

```
// if I try list<TElement> => list is not a template
template <typename TElement>
  struct list<TElement> { 
```

是因为这不是有效的语法，错误是告诉你`list`不是模板，因为在你写的时候`list<TElement>`你还没有完成声明`list`，所以编译器不知道它是什么，你不能有一个列表如果未定义列表模板，则为某些内容。

```
template <typename TElement>
  struct list{
    TElement data;
    struct list *next;
  }node_type; 
```

这试图声明一个 type 的对象`list`，类似于以下语法：

```
struct A {
  int i;
} a;        // the variable 'a' is an object of type 'A' 
```

但是在您的情况下`list`，它不是类型，而是模板。 `list<int>`是一个类型，但`list`它本身不是一个有效的类型，它只是一个模板，当你“填空”时可以从中创建一个类型，即提供一个类型来替代参数`TElement`

看起来您甚至都没有尝试声明变量，只是盲目地猜测语法。

```
// also tried node_type<TElement>, other incomprehensible errors 
```

这也无济于事，`node_type<TElement>`胡说八道，如果你想声明一个变量，它需要一个类型，例如`list<int>`. 参数`TElement`需要*替换*为类型，它本身不是类型。停止尝试将随机的语法串在一起，希望它会起作用。您可以先阅读[http://www.parashift.com/c++-faq/templates.html](http://www.parashift.com/c++-faq/templates.html)

在最后一行：

```
node_type *ptr[max], *root[max], *temp[max]; 
```

`node_type`不是一种类型，所以它不起作用。此外，您应该避免养成在一行中声明多个变量的坏习惯。写的更清楚：

```
int* p1;
int* p2; 
```

代替

```
int *p1, *p2; 
```

另外，你确定你想要指针数组吗？由于您显然不知道自己在做什么，因此使用为您工作的标准容器类型会更明智。

# java - 如何取两个 EditText 字段的值并执行简单的数学运算

> ID：10802484
> 
> 赞同：1
> 
> 时间：2012-05-29T15:48:17.243
> 
> 标签：java, android

我是 Android 开发新手，正在做一个简单的练习项目，用户在两个 EditText 字段中输入一个数字并按下标有“计算”的按钮，然后显示两个数字的总和。这是我到目前为止的代码，但我不知道如何添加两个字符串值并将其输出到名为“answer”的 TextView 字段：

```
public void calNumbers(View view) {
    EditText text = (EditText)findViewById(R.id.edit_number1);
    String value = text.getText().toString();       

    EditText text2 = (EditText)findViewById(R.id.edit_number2);
    String value2 = text2.getText().toString();              

    TextView answer = (TextView) findViewById(R.id.answer);      
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T15:51:51.490

您必须将它们转换为数字（int、float、long 等）来执行您的算术运算。然后将结果转换回字符串以显示在 TextView 中

```
int val1 = Integer.parseInt(value);
int val2 = Integer.parseInt(value2);

answer.setText(String.valueOf(val1 + val2)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T15:51:47.690

获取字符串的整数值：

```
final int myResult = Integer.parseInt(myString1) + Integer.parseInt(myString2); 
```

然后您可以执行添加并将结果存储在变量中。然后将结果显示为字符串：

```
answer.setText(Integer.toString(myIntResult)); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-29T15:53:09.443

将字符串转换为 long 或您需要的任何内容

```
public void calNumbers(View view) {
    EditText text = (EditText)findViewById(R.id.edit_number1);
    String value = text.getText().toString();       

    EditText text2 = (EditText)findViewById(R.id.edit_number2);
    String value2 = text2.getText().toString();              

    TextView answer = (TextView) findViewById(R.id.answer);      
    long l1 = Long.parseLong(text);
    long l2 = Long.parseLong(text2);

    long result = l1 + l2;
    answer.setText(Long.toString(result));
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-10T15:11:53.560

您可以通过多种方式从 EditText 中获取值，但如果您想要进行操作，请首先确保这些事情。在 EditText 的 XML 布局中确保`android:inputType`设置为`"number"`，`"numberSigned"`否则`"numberDecimal"`用户不会弄乱我们的应用程序。

现在，在 java 类上，根据您的预期输出将数字的参数全局初始化为 0，整数 (int) 用于整数之间的总和或减法（inputType 数字或 numberSigned）或更一般地作为所有操作的双精度数。

最后，您需要做的是解析信息，而不是将其作为文本字符串获取，因为它涉及两个不必要的转换。

```
public void wattSystemView(View view) {

/**
* decimal values entered in hor_editText and wh_editText
* number of days without sun of the system as a whole number at days_editText
*/

hours     = (EditText) findViewById(R.id.hor_editText);
wh        = (EditText) findViewById(R.id.wh_editText);
daysNoSun = (EditText) findViewById(R.id.nosun_days_editText);

/**
* conversion to double of the decimal values entered 
* conversion to integer of the number of days without sun of the system
*/
numh      = Double.parseDouble(hours.getText().toString());
numwh     = Double.parseDouble(wh.getText().toString());
nosundays = Integer.parseInt(daysNoSun.getText().toString());

    /**
    * simple math 
    */
    double wattDay = numh * numwh;
    double wattSys = wattDay*nosundays; 
```

# php - 重新加载时更改背景图片、标题和副本

> ID：10802489
> 
> 赞同：-1
> 
> 时间：2012-05-29T15:48:28.057
> 
> 标签：php, image, text, background, reload

是否可以使用 Jquery 或 PHP 创建一个具有不断变化的背景图像和重新加载时的标语/副本的主页。

我在客户网站上使用完整的图像背景，并且每个背景图像都有特定的标题和副本。我的计划是使用 4-6 张图片和标语/副本。

我不想让文本成为背景图像的一部分，因为这对搜索引擎没有好处。

我知道如何对其进行编码以更改重新加载或复制时的背景图像，但不能同时更改两者。而且我很难找到满足这两个要求的解决方案。

我真的是设计师而不是程序员，所以请放轻松，但如果有人知道解决方案，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:06:44.147

您希望在每次用户重新加载时随机选择背景图像和一些文本。这应该很容易。您可以使用 Javascript 或 PHP 来完成这一切。我要去PHP。

在文件顶部附近执行此操作：

```
<?php

    // Generate a random number.
    $random = rand(0, 2);

    // Set up messages, and fetch a random one.
    $messages = array(
        array("heading" => "foo", "body" => "123"), 
        array("heading" => "bar", "body" => "456"),
        array("heading" => "bad", "body" => "789")
    );
    $message = $messages[$random];

?> 
```

然后，在您的 HTML 中进一步向下查看 PHP 文件：

```
<body class="background-<?= $random ?>">
    <h1><?= $message['heading'] ?></h1>
    <p><?= $message['body'] ?></p>
</body> 
```

您可以在 CSS 中进行背景图像随机化：

```
body.background-0 { background: red; }
body.background-1 { background: green; }
body.background-2 { background: blue; } 
```

# c++ - 通过函数传递字符串流值，C++

> ID：10802493
> 
> 赞同：4
> 
> 时间：2012-05-29T15:48:42.670
> 
> 标签：c++, function, stringstream

我目前有一个日志系统，它需要一个 char* 和 var args，然后使用它们来执行 printf。这适用于 C 风格的字符串，但我想要一些更干净的东西。目前，如果我使用 std::stringstream 我必须在日志系统之外创建 stringstream，然后将 char* 用于 stringstream 给出的字符串。它看起来像这样：

```
std::stringstream strStream;
strStream << "The value of x is: " << x;
logging::print( strStream.str().c_str() ); 
```

我想要的是将参数传递给函数，就好像我直接将它们与字符串流一起使用一样。从用户的角度来看，这看起来像这样：

```
logging::printStream("The value of x is: " << x); 
```

或者可能像这样：

```
logging::printStream("The value of x is: ", x); 
```

有没有办法以这样的方式使用日志记录，我可以使用字符串流而不必在日志记录系统的功能之外创建它？

这一点尤其重要，因为我打算创建一个宏来防止任何函数参数在发布版本中编译。如果我必须在它之外创建字符串流并将其传入，该宏将毫无用处。从技术上讲，我可以制作一个宏来执行我在这个问题中所说的字符串流，但这很混乱，因为我不会总是在此日志记录中使用 stringstreams，因此我将有一个用于标准日志记录的宏，以及一个用于使用 stringstreams 的不同宏，它在其中调用标准日志记录的宏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:03:43.847

以下按预期工作（经过测试 - 用您的 logging::print 替换输出到 cerr）：

```
#include<sstream>
#include<iostream>

class StringstreamLogger {
private:
    std::stringstream s;

public:
    StringstreamLogger () : s (std::ios_base::out) {
    }

    ~StringstreamLogger () {
    std::cerr << s.str () << std::endl; // logging::print (s.str ().c_str ());
    }

    std::stringstream& out () {
    return s;
    }
};

int main () {
    StringstreamLogger ().out () << "My log message";
    std::cerr << "Some later output to test for prompt logging (to ensure that logging is not delayed until the end of a block)" << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:54:48.563

你可以这样写：

```
print(static_cast<std::ostringstream&>(std::ostringstream() << "The value of x is: " << x).str().c_str()); 
```

也许这更符合你的喜好？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T16:11:38.247

作为一个起点，你可以...

```
class Something {
public:
    std::ostream& error() const { ... code to return some std::ostream ... }
};

...

int main () {
    Something something;
    something.error() << "Frobnicate" << 4;
} 
```

稍后您可以使用重载的流运算符添加自己的代理对象（我认为这仍然比编写您自己的派生流更容易`std::ostream`）。

当然，已经有大量的日志框架了，首先看看它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T16:39:44.907

我想出了两个 HACK 解决方案，但它们应该可以工作。第一个不使用范围解析运算符并且更安全。第二个使用 noop int 变量来伪造范围。

```
#define logging_printStream(token) { std::stringstream o; o << token; logging::print(o.str().c_str()); }

namespace logging { int noop; }
#define printStream(token) noop = 0; { std::stringstream o; o << token; logging::print(o.str().c_str()); }

int main(int argc, const char** argv)
{
    int i = 1;

    // MORE SAFE
    logging_printStream(i)
    logging_printStream("is this magic? " << (i ? "yes" : "no"))

    // LESS SAFE
    logging::printStream(i)
    logging::printStream("is this magic? " << (i ? "yes" : "no"))
} 
```

* * *

由于 17.6.4.3.2，我将 logging__printStream 更新为 logging_printStream

> 17.6.4.3.2 全局名称 [global.names]
> 
> 某些名称和函数签名集始终保留给实现：
> 
> *   **每个包含双下划线 _**或以下划线后跟大写字母 (2.12) 的名称都保留给实现以供任何使用。
> *   每个以下划线开头的名称都保留给实现用作全局名称空间中的名称。

由于 3.6.1，我独自离开了 main 的声明

> 3.6.1 主函数[basic.start.main]
> 
> 一个程序应包含一个名为 main 的全局函数，它是程序的指定开始。独立环境中的程序是否需要定义主要功能是实现定义的。实现不应预定义主要功能。该功能不得重载。**它应该有一个 int 类型的返回类型，否则它的类型是实现定义的。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T02:59:14.707

重载输出流操作符的自定义类型怎么样？

```
struct logger
{
    std::stringstream ss_;

    template <typename T>
    friend logger& operator << (logger& l, T const& t) 
    {
    #ifdef DEBUG_MODE
        l.ss_ << t;
    #endif

        return l;
    }

    ~logger()
    {
    #ifdef DEBUG_MODE
        // output ss_.str().c_str() to your logger.
    #endif
    }
}; 
```

然后每当您需要记录输出时

```
logger log;
log << "Log this stuff: " << x << '\n'; 
```

# regex - 正则表达式删除字符串的一部分

> ID：10802494
> 
> 赞同：0
> 
> 时间：2012-05-29T15:48:42.697
> 
> 标签：regex, autoblogged

这是我的字符串`http://www.example.com/dl/r66h5icmsyrh`

我需要删除`http://www.example.com/dl/`

我正在使用自动博客的 wordpress 插件；可以处理帖子模板中的正则表达式

这是我尝试过的。

```
%regex("%link%", "http://www.example.com/dl/", "0")% 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:51:02.227

用这个：

```
%regex("%link%", "\\([^\\]+)$\", "0")% 
```

# c# - Monotouch.Dialog：在 RadioElement 表中选择后，如何更新依赖表？

> ID：10802499
> 
> 赞同：0
> 
> 时间：2012-05-29T15:48:51.677
> 
> 标签：c#, xamarin.ios, monotouch.dialog

我正在使用 Monotouch.Dialog 开发一个单位转换器，我有一个如下所示的主窗口：

![单位转换器主窗口](../Images/15fc364631d169d9efc9ef2db1366748.png)

当我点击 Quantity 元素，选择一个新的 Quantity 并返回到主窗口时，我想用与所选数量关联的单位表来更新 Unit 元素。

我最初的想法是在完成数量选择后调用的事件处理程序中更新单位。但是，当我从数量选择返回时，我无法在 MT.D API 中找到触发的事件。是否有这样的事件我可以采取行动，或者是否有其他方法可以进行单元更新？

从示意图上看，我的`AppDelegate.FinishedLaunching`方法现在看起来像这样：

```
public override bool FinishedLaunching (UIApplication app, NSDictionary options)
{
  _window = new UIWindow (UIScreen.MainScreen.Bounds);

  _quantityGroup = new RadioGroup("Qty", 0);
  _fromUnitGroup = new RadioGroup("FromU", 0);
  _toUnitGroup = new RadioGroup("ToU", 0);

  var quantityElem = new RootElement("Quantity", _quantityGroup) { 
      new Section() { new RadioElement("AbsorbedDose", "Qty") as Element, ... }};

  var fromUnitElem = new RootElement("Unit", _fromUnitGroup) { new Section() };
  var toUnitElem = new RootElement("Unit", _toUnitGroup) { new Section() }

  _rootElement = new RootElement ("Unit Converter")
  {
    new Section() { quantityElem }, 
    new Section("From") { new EntryElement(...), fromUnitElem },
    new Section("To") { new EntryElement(...), toUnitElem }
  };

  _rootVC = new DialogViewController(_rootElement);
  _nav = new UINavigationController(_rootVC);

  _window.RootViewController = _nav;
  _window.MakeKeyAndVisible();

  return true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T11:05:15.350

正如 Jason 在上面的评论中指出的那样，这个问题之前已经在 SO 上解决了，[here](https://stackoverflow.com/questions/8302306/monotouch-dialog-responding-to-a-radiogroup-choice)。

解决方案是扩展`RadioElement`类，其中继承类包含一个`OnSelected`事件，并且该`RadioElement.Selected`方法被一个调用`OnSelected`事件处理程序的方法覆盖。

# vb.net - 在 VB.net 中使用 Web 服务，将 API 密钥和其他信息发送到服务器。

> ID：10802500
> 
> 赞同：0
> 
> 时间：2012-05-29T15:48:57.637
> 
> 标签：vb.net, web-services, soap, wsdl, api-key

我是 VB.net 中 Web 服务的新手。我已将 WSDL 导入 Visual Studio 2010，但使用 .net 2.0“Web 引用”框架而不是新的“服务引用”。

我只需要学习如何通过 API 将我的 API 密钥和另一条信息传递给服务器。这就是我所拥有的。我需要添加什么代码

a) 发送 API 密钥 b) 发送数据库模式字符串

```
Public Sub Call_Web_Service_Method()
    Dim CallWebService As New PersonService.Header()
    Dim sPostAPIKEY As String = CallWebService.APIKey()
    Dim sPostDatabasemode As String = CallWebService.DatabaseMode

End Sub 
```

我一直在寻找两天来如何将 API 密钥发送到 VB.net 中的服务器，但我没有找到任何东西。请帮助一个新手。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T21:41:35.060

它是您自己的 Web 服务还是您无法控制的 Web 服务？您要调用 Web 服务上的什么方法？Web 服务可能有一种方法，您可以提供 api 密钥和数据库模式作为参数？

查看这些关于如何使用 VB.NET 中的 Web 服务的简单指南 [http://www.codeproject.com/Articles/2761/Consuming-Web-Services-from-a-Win-Forms-Applicatio](http://www.codeproject.com/Articles/2761/Consuming-Web-Services-from-a-Win-Forms-Applicatio) [http://www .fryan0911.com/2009/05/vbnet-how-to-consume-web-services.html](http://www.fryan0911.com/2009/05/vbnet-how-to-consume-web-services.html)

# jquery - jQuery循环如何在单击寻呼机时恢复暂停的循环

> ID：10802506
> 
> 赞同：0
> 
> 时间：2012-05-29T15:49:23.660
> 
> 标签：jquery, jquery-cycle

我有一个使用寻呼机运行的 jquery 循环。它会自动循环，并且它具有手动控制循环的寻呼按钮，使用寻呼按钮后它会恢复自动前进。现在我还构建了一个外部按钮来暂停循环。但是在使用此按钮暂停循环后，我希望它在单击寻呼机按钮时恢复循环......但这就是它不做的事情。

提示或技巧任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:53:21.603

您需要将事件连接到寻呼机以恢复循环：

```
$('#pager li').click(function() {
    $('#slideshow').cycle('resume');
});​ 
```

这是一个完整的例子：

[http://jsfiddle.net/lucuma/fg6d4/2/](http://jsfiddle.net/lucuma/fg6d4/2/)

每条评论更新：

或者，您可以绑定 mouseleave 并单击，它也应该解决悬停问题：

```
$('#pager li').on("mouseleave click",function() {
    $('#slideshow').cycle('resume');
});​ 
```

# javascript - 以编程方式隐藏不完整的元素

> ID：10802507
> 
> 赞同：2
> 
> 时间：2012-05-29T15:49:27.937
> 
> 标签：javascript, html, css

有没有办法可以隐藏边界框不完全可见的页面上的所有元素。

我有表格行列表，其中包含的元素具有动态高度，但隐藏了溢出。

有时列表中的一半项目与包含的元素边界重叠，我希望通过 CSS 或 JavaScript 可以隐藏这些。

希望一张图片能更好地解释这一点。在这里，我想隐藏框 24。

![重叠元素](../Images/76e3ae164b3b4efd41d829436e7e1457.png)

我的一个想法是遍历所有元素，找到它的边界，并检查它们是否与容器边界重叠。这似乎是一种重量级且混乱的方式（特别是因为这是一个滚动列表，我必须每秒计算一次）。有没有更好的办法？

谢谢，如果我需要澄清什么，请告诉我？

**更新：**

我希望这是通用的并且可以使用不同的标记结构，但是对于我正在使用的代码的一个简单示例（在这种情况下，我想只会显示第一个）：

```
<style>
  #parent {height: 100px; overflow: hidden; }
  .child {height: 75px;}
</style>

<div id='parent'>
  <div class='child'></div>
  <div class='child'></div>
  <div class='child'></div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:51:58.270

您可以计算`top offset + height`并检查结果值是否大于容器高度。如果是这样，则该元素和它之后的其余项目超出了容器的范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:52:57.263

我认为容器的 offsetHeight 给了你它的真实高度，所以你可以比较每行的 offsetTop+offsetHeight，最后在必要时隐藏它。只是一个想法......也许需要根据行有多少父容器进行一些调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T16:24:33.137

`document.elementFromPoint`在[http://jsfiddle.net/VhShD/](http://jsfiddle.net/VhShD/)玩了一会儿之后，我认为这不是一个好主意。

更好的方法是将滚动限制为特定的增量，这样无论何时您滚动它都会最小限度地滚动，因此至少有 1 个新项目被完全显示或隐藏。这至少在 WinAmp 播放列表中使用。

不幸的是，该`scroll`事件很糟糕，它不包含用户想要滚动的任何信息或阻止滚动发生的能力。您必须使用完全自定义的滚动解决方案，例如 jScrollPane。

# erlang - RabbitMQ：安装客户端库erlang

> ID：10802508
> 
> 赞同：2
> 
> 时间：2012-05-29T15:49:30.160
> 
> 标签：erlang, rabbitmq

我试图在我的 Archlinux 机器上安装 rabbitMQ。

我设法安装服务器并将其作为服务运行。

如何安装 rabbitMQ Erlang 客户端库？

[www.rabbitmq.com](http://www.rabbitmq.com)只有下载库的链接

*   [amqp_client-2.8.2.ez](http://www.rabbitmq.com/releases/rabbitmq-erlang-client/v2.8.2/amqp_client-2.8.2.ez)
*   [rabbit_common-2.8.2.ez](http://www.rabbitmq.com/releases/rabbitmq-erlang-client/v2.8.2/rabbit_common-2.8.2.ez)

知道把这些文件放在哪里吗？

来自 RabbitMQ 文档：

```
To gain access to these records, you need to include
the amqp_client.hrl in every module that uses the Erlang client:
-include("amqp_client.hrl"). 
```

这个文件应该放在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:57:33.853

我再次阅读了您的问题，但我第一次误读了它。关于如何使用带有 Rebar 的 Erlang RabbitMQ 库设置一个新项目， 有一个[很棒的迷你演练。](http://cartesianfaith.wordpress.com/2011/01/24/rabbitmq-client-examples-using-rebar/)[Rebar](https://github.com/basho/rebar)是用于 Erlang 项目的出色构建工具。

* * *

一般来说，hrl文件应该和需要它的erlang文件在同一个目录下。或者，您可以设置目录层次结构，其中一个目录中的源代码和另一个目录中的 hrl 文件，并使用相对路径引用 hrl 文件。例如，如果您具有以下目录结构，就像您使用基于钢筋的项目一样：

```
project
|
|----ebin
|    compiled_file.beam
|
|----src
|    srouce_file.erl
|
|----include
     include_file.hrl 
```

并且您想在 source_file.erl 中包含 include_file.hrl，将在 source_file.erl 的顶部写入：

```
-include("../include/include_file.hrl"). 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T17:19:19.960

见[http://www.erlang.org/doc/man/code.html](http://www.erlang.org/doc/man/code.html)

.ez 是一个普通的 ZIP 文件

# bash - bash 回声 >> 不起作用

> ID：10802511
> 
> 赞同：0
> 
> 时间：2012-05-29T15:49:44.663
> 
> 标签：bash, echo

我想将一个字符串写入文件，但它不起作用。我确信我错过了一些微不足道的事情。这些文件还不存在。为什么下面的脚本没有在文件中写入任何内容？甚至没有创建文件。

```
#!/bin/bash

j="nch"
temp_dir="~/temp_temp"
echo "$temp_dir/$j"
echo "c'mon" >> "$temp_dir/$j"
echo "c'mon" >> "~/temp_temp/pch" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T15:54:05.743

`~`不在带引号的字符串中展开。

```
temp_dir=~/temp_temp
echo "c'mon" >> ~/temp_temp/pch 
```

或者

```
temp_dir=~/"temp_temp"
echo "c'mon" >> ~/"temp_temp/pch" 
```

等等

# fonts - Webfont 被切断了

> ID：10802515
> 
> 赞同：1
> 
> 时间：2012-05-29T15:50:12.853
> 
> 标签：fonts

这对我来说很奇怪，我环顾四周，对我来说这甚至不是什么大问题。

发生的事情是“有时”当我的页面加载时它会切断字体的一些底部或顶部。我不知道为什么，但这里有一个示例，其中有一个链接显示悬停缺少顶部和底部？

![在此处输入图像描述](../Images/aab76894f1e4e1ea9104019c58a660e9.png)

# ffmpeg - How to change sample rate in FFMPEG

> ID：10802517
> 
> 赞同：5
> 
> 时间：2012-05-29T15:50:23.017
> 
> 标签：ffmpeg, flv, mp4, rate

I use FFMPEG since few moments now and after asking for help here a first time about that, i was able to discover this command line that i use since then, for the conversion of .MP4 video to .FLV : `ffmpeg -i namefile.mp4 -c:v libx264 -crf 19 destinationfile.flv` .

The results was simply amazing ! Perfect video and a lot less space needed. But i've try this same line for a new video and didn't work.

This is what appears to me :

```
[libmp3lame @ 03eaf5a0] flv does not support that sample rate, choose from (44100, 22050, 11025). 
```

After that, i've try theses commands lines

```
ffmpeg -i in.mp4 -c:v libx264 -b:v 500k -c:a copy out.flv 
ffmpeg -i in.mp4 -c:v libx264 -ar 22050 -crf 19 out.flv 
```

Without succes. So right now i just dont know what to do else to be able to convert this MP4 file to a FLV one, who is smaller in size and keep a perfect image, just like the others conversions made with the first code line before.

Thanks for your help !

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T18:41:48.170

You are having several issues and you already solved `flv does not support that sample rate` by including `-ar`. It took me several comments for clarification, but your other issue, if I understand you correctly, is that the output is still too big in file size.

You mentioned [FFmpeg: The ultimate Video and Audio Manipulation Tool](http://blog.superuser.com/2012/02/24/ffmpeg-the-ultimate-video-and-audio-manipulation-tool/) which explains:

> The CRF can be anything within 0 and 51, with the reasonable range being 17 to 23\. The lower, the better the quality, the higher the file size. In general, the best bet is to just try and see for yourself what looks good. Take into account the result file size you want and how much quality you can trade in for smaller file sizes. It’s all up to you.

What that means is that you need to choose the highest CRF value that still gives you the quality you want. So instead of 19, which is very high quality, try a higher value. That doesn't mean you have to encode the whole video to get a general idea of what a particular crf value will look like. Use the `-ss` and `-t` options to select random sections to encode. This example will skip the first 2 minutes and 30 seconds and encode a 10 second clip:

```
ffmpeg -ss 00:02:30 -i input -t 30 -c:v libx264 -preset medium -crf 24 output.mp4 
```

As shown in the example `-ss` and `-t` can accept either hours:minutes:seconds or just seconds.

Choosing to use crf means that you want your outputs to have a certain quality and file size is less of a concern. If the opposite is true, that you want your output to be a certain file size and quality is less of a concern then you need to use two-pass bitrate mode instead of crf. You can't easily know what the file size will be with crf, but a two-pass encode with `-b:v` can approximately let you choose the file size in advance. In this [example](https://stackoverflow.com/a/10035737/1109017) the desired output is 100 MB and the input is 671 seconds in duration (see the link for the math) so the command will be:

```
ffmpeg -i input -c:v libx264 -preset medium -b:v 1092k -pass 1 -an -f mp4 -y NUL
ffmpeg -i input -c:v libx264 -preset medium -b:v 1092k -pass 2 -c:a libfaac -b:a 128k output.mp4 
```

Personally, I rarely use a two-pass encode because I prefer my set of videos to be a similar quality (and therefore varying file sizes which I care less about).

As for the -3 (the current stackoverflow question rating), I assume readers thought your question was unclear since you did not explain "without success" so nobody knew what the actual problem was. Be direct, descriptive, and provide all useful information: especially the commands and console outputs with your next FFmpeg question and you will get better and faster answers.

# html - 在表中包装列

> ID：10802521
> 
> 赞同：1
> 
> 时间：2012-05-29T15:50:34.360
> 
> 标签：html, css, asp-classic, styles

我有一个包含 10 个固定宽度列的行的表格，在重新调整页面大小时调整表格的最佳方法是什么。

例如：如果我调整页面大小并且只有 5 列适合，我如何将剩余的 5 列换成新行？

我正在寻找什么是最好的方法来做到这一点的指针。任何建议将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T20:05:02.217

如果你想重排单元格，我猜你想要的不是表格，只是对齐的元素。为此，最好使用浮动，像这样......

```
<div style="overflow:auto">
    <div style="width:200px;float:left">A</div>
    <div style="width:200px;float:left">B</div>
    <div style="width:200px;float:left">C</div>
    <div style="width:200px;float:left">D</div>
    <div style="width:200px;float:left">E</div>
    <div style="width:200px;float:left">F</div>
    <div style="width:200px;float:left">G</div>
</div> 
```

（最好将样式放在 CSS 文件中，使用类等。我使用`div`了 s 但与样式相同的东西，`LI`除非您可能需要`display:block`在样式中添加 a）。`height`此外，如果单元格的内容可以具有不同的高度，您可能还必须添加 a 。

# tfs - TFS 2010 web - 访问被拒绝但用户已登录

> ID：10802524
> 
> 赞同：0
> 
> 时间：2012-05-29T15:50:42.793
> 
> 标签：tfs, tfs-web-access, tfs-2010

我有一个已安装在 D:\Program Files\Microsoft Team Foundation Server 2010 中的 TFS2010 服务器。但是当我登录到 (http:// localhost:8080）它通过了登录提示并说我已登录，但它显示访问被拒绝。

我正在使用应用程序池 Wss3AppPool，当我转到 IIS7 中的基本设置并单击测试设置时，我在授权下收到以下错误。

服务器配置为使用带有内置帐户的直通身份验证来访问指定的物理路径。但是，IIS 管理器无法验证内置帐户是否具有访问权限。确保应用程序池标识对物理路径具有读取权限。如果此服务器已加入域，并且应用程序池标识为 NetworkService 或 LocalSystem，请验证 \$ 是否具有对物理路径的读取访问权限。然后再次测试这些设置。

我可以使用 Visual Studio 很好地连接到 TFS，除了 Web 访问登录之外，一切似乎都正常。我们没有运行 sharepoint，而 Wss3AppPool 的应用程序池正在运行 v2 classic。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T13:17:01.300

请尝试使用带有身份验证的 ASP.NET 4.0 经典应用程序池 => Windows 身份验证打开 => 提供程序 => 删除协商 ASP.NET 模拟打开匿名身份验证关闭

# sql-server - SQL Server 复制 - 两个不同的数据库模型之间是否可能？

> ID：10802528
> 
> 赞同：0
> 
> 时间：2012-05-29T15:51:02.687
> 
> 标签：sql-server, replication, transactional

关于 SQL Server 复制的两个问题：

1）是否可以在数据库 A 和数据库 B（其中包含数据库 A 的一小部分表）之间配置事务复制？

2）当两个数据库之间的表和列名不同时，是否可以在数据库 A 和数据库 B 之间配置事务复制？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T17:36:36.047

是的，这是可以做到的。

1) 使用过滤器，您可以指定要发布的行的子集。看看[Filter Published Data](http://msdn.microsoft.com/en-us/library/ms151775.aspx)。

2）对于不同的源和目标模式，您需要在发布者上创建一个看起来像订阅对象的索引视图并复制它，或者考虑创建一个自定义复制存储过程来执行更新，也称为自定义同步对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:54:55.790

我认为这是不可能的，我唯一能想到的就是创建某种 ETL 包，该包会定期执行以将事物转移，但这不会为您提供事务复制。

# c# - 如何使用属性调用类的方法？

> ID：10802529
> 
> 赞同：2
> 
> 时间：2012-05-29T15:51:03.720
> 
> 标签：c#, .net, vb.net, reflection

我想在我引用的类上调用一个方法。我要调用的方法具有自定义属性。目前我可以找到这个属性并调用我的类属性的属性。

有没有办法调用该方法？

PS/ 项目是用vbnet写的，但是我觉得c#的解决方法是一样的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:58:37.590

如果你*能找到*我猜你有`MethodInfo`那个方法的属性。只需调用该`MethodInfo.Invoke`方法，您必须指定要使用的对象的实例（或者`null`如果它是静态方法）以及要传递给该方法的所有参数（按原型的相同顺序）。

例如，如果您必须使用此原型调用方法：

```
void Foo(string name, int value); 
```

你有一个函数可以找到那个方法（搜索给定的属性）：

```
MethodInfo FindMethodWithAttribute(Type attributeType, Type objectType); 
```

您可以使用以下代码找到并调用该方法（假设对象的`anObject`）：

```
MethodInfo method = FindMethodWithAttribute(
    typeof(MyAttribute), // Type of the "marker" attribute
    anObject.GetType()); // Type of the object may contain the method

method.Invoke(anObject, new object[] { "someText", 2 }); 
```

# windows - 在 64 位 Windows 应用程序中获取 TID（线程信息块）的最快方法是什么？

> ID：10802532
> 
> 赞同：2
> 
> 时间：2012-05-29T15:51:18.017
> 
> 标签：windows, 64-bit

我有一个计算密集型模块，我在其中添加了堆栈跟踪，以便能够找到特定的问题。尽管启用此堆栈跟踪时允许应用程序运行得更慢，但它的运行速度不得慢 10 倍。这就是为什么我没有使用 DBGHELP.DLL 中的 StackWalk 例程，而是我自己使用帧指针遍历堆栈（所以我不使用 Frame Pointer Omission 编译器选项）。

在大多数情况下，获取调用堆栈可以正常工作并且非常快，但在某些情况下，我的逻辑会失败，因为其中一个帧指针指向堆栈外部的地址（不多，只是一点点）。

我知道这可能是某个地方的错误，但是为了使我的代码更安全，我需要一种方法来检查帧指针是否指向当前线程堆栈中的内存位置。该应用程序是 64 位的，在 Windows 下运行。

[如何在 Windows 上获取线程堆栈信息中](https://stackoverflow.com/questions/3918375/how-to-get-thread-stack-information-on-windows)的代码？可能解决了这个问题，但是由于这调用了其他函数，它可能会使我的代码运行得更慢（老实说，我没有测试它）。

我还发现了一些应该执行技巧的内联汇编代码（[http://nasutechtips.blogspot.com/2011/01/thread-information-block-tib-and-fs.html](http://nasutechtips.blogspot.com/2011/01/thread-information-block-tib-and-fs.html)），但内联汇编不支持Microsoft 的 64 位 C++ 编译器。

此外，内在的 __readfsqword 似乎不适用于 64 位。

关于如何尽可能快地获得 64 位 TIB 的任何其他建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:07:02.007

找到了，下面的代码可以解决问题：

```
#include <windows.h>
#include <winnt.h>

struct _TEB
   {
   NT_TIB NtTib;
   // Ignore rest of struct
   };

void *startOfStack;
startOfStack = NtCurrentTeb()->NtTib.StackBase;
std::cout << "startOfStack = " << startOfStack << std::endl; 
```

我查看了 winnt.h 中 NtCurrentTeb() 的定义，看起来这是一个非常低级的函数，所以它可能足够快以获得我想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-11T09:25:40.907

它应该`__readgsqword`代替`__readfsqword`64 位。

# ruby - 使用 uwsgi 部署机架应用程序无法找到应用程序

> ID：10802534
> 
> 赞同：0
> 
> 时间：2012-05-29T15:51:20.247
> 
> 标签：ruby, uwsgi

我们正在使用 uWSGI 来部署几个 python 应用程序。我们想使用 uWSGI 来服务于我们的 ruby​​ rack 应用程序。在努力让 uWSGI 使用 bundler 获取应用程序之后（最终我需要将 bundler 安装到 bundle 本身），我终于让 uWSGI 来获取应用程序。我正在使用以下配置：

```
[uwsgi]
socket=/tmp/gearbox.sock
master=true
processes=1
post-buffering=4096
env=GEM_PATH=
env=GEM_HOME=/gearbox/vendor/ruby/1.8
uid=vagrant
gid=vagrant
rack=./config.ru
ruby-gc-freq=10
chdir=/gearbox
env=BUNDLE_GEMFILE=/gearbox/Gemfile 
```

我的 nginx 配置相当简单：

```
location / {
            include uwsgi_params;
            uwsgi_param SCRIPT_NAME /gearbox/config.ru;
            uwsgi_pass unix:///tmp/gearbox.sock;
} 
```

我通过以下方式启动它：uwsgi -i /apps/uwsgi/gearbox

启动输出如下所示：

```
[uWSGI] getting INI configuration from /apps/uwsgi/gearbox.ini
*** Starting uWSGI 1.2.3 (64bit) on [Tue May 29 15:46:15 2012] ***
compiled with version: 4.6.3 on 29 May 2012 15:44:06
detected number of CPU cores: 2
current working directory: /gearbox
*** running under screen session 5093.pts-0.precise ***
detected binary path: /usr/local/bin/uwsgi
your memory page size is 4096 bytes
detected max file descriptor number: 1024
lock engine: pthread robust mutexes
uwsgi socket 0 bound to UNIX address /tmp/gearbox.sock fd 3 
Python version: 2.7.3 (default, Apr 20 2012, 23:04:22)  [GCC 4.6.3]
*** Python threads support is disabled. You can enable it with --enable-threads ***
Python main interpreter initialized at 0x17feb20
ruby 1.8.7 (2011-06-30 patchlevel 352) [x86_64-linux]
your server socket listen backlog is limited to 100 connections
*** Operational MODE: single process ***
RACK app 0 loaded in 1 seconds at 0x1591 (GC frequency: 10)
spawned uWSGI master process (pid: 10035)
spawned uWSGI worker 1 (pid: 10036, cores: 1) 
```

所以，这对我来说看起来不错。但是，当我尝试连接到应用程序（通过 nginx）时，我收到：

```
vagrant@precise:~$ curl localhost
<h1>uWSGI Error</h1>Python application not foundvagrant@precise:~$ 
```

我很困惑，因为似乎我的配置正确。任何想法将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:12:58.537

您错过了在 nginx 配置中设置 uwsgi_modifier1 （并删除 SCRIPT_NAME 设置）

如果你想以“智能”的方式使用 bundler，你可以简单地添加：

```
rbrequire = rubygems
rbrequire = bundler/setup 
```

不弄乱 GEM_PATH/GEM_HOME 环境变量

# wpf - 具有多个内容的 WPF 应用程序布局，没有窗口

> ID：10802535
> 
> 赞同：2
> 
> 时间：2012-05-29T15:51:20.607
> 
> 标签：wpf

我有一个带有一些窗口的应用程序。每个窗口中都有一个网格，其中包含来自数据库、过滤器、操作等的数据。

问题是，我使用顶部菜单导航这些窗口，每次，我切换到另一个视图，当前窗口关闭，新窗口正在打开。它是虚拟的，窗口在屏幕上跳跃。

我宁愿将我的应用程序放在一个窗口中，只显示适当的内容。但是，如果我在一个窗口中拥有所有数据源和其他东西，那将是无效的。

你能给我一个线索，如何管理这样的应用程序？我喜欢 Roxio Creator 软件。例如。左侧有一些选项卡，内容动画就像每个激活的选项卡一样...

任何意见，将不胜感激。

谢谢，吉克拉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T17:27:48.100

如果您不需要一次打开所有窗口，您可以创建页面并使用 Frame 控件一次显示一个。这样每个页面都会有它自己的数据源和代码隐藏。要提供过滤、排序等功能，您可以使用接口，然后您可以访问窗口 DataContext 并在其中执行命令。如果您需要同时打开它们，您可以创建用户控件而不是窗口，并在 TabControl 内的 TabItems 中显示它们。

希望它有所帮助，迭戈·莫多洛·里贝罗

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T19:00:49.613

您可以使用 WPF 的框架概念，您需要定义一个框架元素并创建要显示到该框架元素中的页面。如果您希望这样做，只需将 window1 继承从窗口替换为页面并将对应更改更改为 XAML，然后在您的主页中创建框架控件，使用导航源托管这些页面。

[http://www.paulstovell.com/wpf-navigation](http://www.paulstovell.com/wpf-navigation)

另一种方法是在高级模式下创建平铺视图，因此如果您的窗口有限，则只需根据需要调整它们的大小。此链接可能对您有所帮助：

[http://happynet.codeplex.com/](http://happynet.codeplex.com/)

# java - 在 Eclipse 中排除源文件夹的问题

> ID：10802536
> 
> 赞同：0
> 
> 时间：2012-05-29T15:51:24.027
> 
> 标签：java, eclipse

我试图从构建过程中排除 Eclipse 中的整个文件夹，但 IDE 仍然显示这些文件的编译器错误。这是日食靛蓝。

我尝试分别排除文件夹和其中一个文件：

![在此处输入图像描述](../Images/914839ed906f2d81910c55ea43f33f7f.png)

但我仍然看到编译器错误：

![在此处输入图像描述](../Images/1c451dcbd172bfabc25e1f9115f545ce.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:06:09.347

一旦我尝试运行该应用程序，构建错误就消失了。我认为这迫使项目重建导致 Eclipse 识别新的构建设置。

# php - 在 foreach() 结束时更改其值的变量

> ID：10802537
> 
> 赞同：0
> 
> 时间：2012-05-29T15:51:26.817
> 
> 标签：php

我正在尝试将一些信息从数据库流入 HTML 以显示给我的用户。每次“行业”发生变化时，我都想打印新标签。我正在尝试使用一个名为 $last_industry 的变量来跟踪我当前迭代的行业是否等于最后一个，但我没有得到好的结果。我在下面粘贴了我的代码。$c['user_industries_title'] 是我需要监控的。

```
$last_industry = 'foo';

foreach($case_studies as &$c) {
  //If the last industry we iterated over is different than the one we're currently iterating over, close the last section and print a new section.
  if($last_industry != $c['user_industries_title']){
    echo "</section>"  
    echo "<section>";
    $changed = 1;
  }else {$changed = 0}

  $c = $last_industry;
  $last_industry = $c['user_industries_title'];
} 
```

此问题与 $last_industry 变量有关。为此，它需要将自身更新为最新的 $c['user_industries_title'] 以便在下一次迭代开始时重新使用，这不会发生。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:56:10.173

当值发生变化时，您需要更改 if() 中的 $last_industry 值，否则您始终以相同的行业值运行：

```
$last_industry = null;

foreach ($case_studies as $c) {
   if ($last_industry != $c['user_industries_title']) {
      echo '</section><section>';
      $last_industry = $c['user_industries_title'];
      $changed = 1;
   } else {
      $changed = 0;
   }
} 
```

此外，请注意制作 $ca 引用（`&`运算符）的一个陷阱 - 它在脚本的持续时间内仍然是一个引用，如果您依赖它在循环退出后保持其值，则可能会导致奇怪的副作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:57:09.943

看看最后两行，你覆盖了你的`$c`which 是一个数组，`$last_industry`它是你在最后一次迭代中使用的字符串。重命名`$c`最后第二行中的 或将其完全删除。

顺便说一句：如果您将 PHP error_reporting 设置设置为 E_ALL，您会收到通知，这`$c`不再是一个数组！

# assembly - 64 位模式下的地址覆盖前缀

> ID：10802538
> 
> 赞同：2
> 
> 时间：2012-05-29T15:51:29.807
> 
> 标签：assembly, x86-64, intel, virtual-address-space, amd-processor

在 64 位模式下，默认地址大小为 64 位。如果存在地址大小覆盖前缀 (67h)，则地址大小为 32 位。

我知道规范 64 位地址的第 63 位到实现的最高有效位全为 0 或全为 1。32 位地址（通过在 64 位模式下的指令前加上 67h 获得）是否需要采用规范形式？如果是，这种规范形式是如何定义的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T16:19:19.487

规范地址是通过对虚拟地址的有效部分（低 48 位）进行符号扩展而形成的；最高有效位被视为符号。

现在对此进行推测（不愿意查找 - 但这也没有必要回答你的问题） - 在 64 位模式下，32 位地址有两种可能的行为：

1.  CPU 将其视为使用 32 位寄存器/操作数，即零扩展到 64 位/隐式将高 32 位视为零
    。在这种情况下，*任何*32 位地址都是规范的，因为任何 64 位地址`0x00000000xxxxxxxx`都是规范的。
2.  CPU 将其视为“32 位有效”，并从 32 位地址的最高有效位符号扩展到 64 位。
    在这种情况下，*任何*32 位地址也是规范的，因为这样 32 位范围将映射从`0xffffffff80000000`... `0x000000007fffffff`- 再次，所有这些都是规范的。

由于结果（32 位地址总是隐含地采用规范形式）是相同的，因此 CPU 实际执行的操作并不重要 - 32 位地址是规范的，句号。

# javascript - 使用页面加载数据引导骨干收集的正确方法

> ID：10802547
> 
> 赞同：0
> 
> 时间：2012-05-29T15:51:57.933
> 
> 标签：javascript, backbone.js

我在初始页面加载时引导我的主干应用程序中的所有重要数据。这主要是收藏。我在调用的问题上被困了一段时间，但即使我知道存在具有传递 ID 属性的模型，`collection.get(id)`它也会返回。`undefined``ID`

然后，当我在控制台中检查集合时，我注意到`_byId`应该包含我的模型 ID 数组的数组是空的。

您可以从下面的控制台打印中看到该集合确实具有模型，并且这些模型具有 ID 属性。

```
window.campaigns
child
  _byCid: Object
  _byId: Object
    __proto__: Object
  _callbacks: Object
  length: 32
  models: Array[32]
  models: Array[32]
  0: child
    _callbacks: Object
    _escapedAttributes: Object
    _pending: Object
    _previousAttributes: Object
    _silent: Object
    attributes: Object
    DateCreated: "23/05/2012"
    DateScheduled: ""
    DateSent: ""
    Description: null
    From: null
    ID: 1
    IsAllowed: false
    Message: null
    Name: "Some name"
    __proto__: Object
    changed: Object
    cid: "c0"
    collection: child
    __proto__: ctor
  1: child
  2: child
  3: child
  4: child
  5: child
  length: 6
  __proto__: Array[0]
  __proto__: ctor 
```

我正在使用 JSON 对象数组引导数据，这些对象在页面加载时写入我的索引页面。我假设这就是你必须做的所有事情，Backbone 会假设一个名为“ID”的属性是模型的 ID，并会进行相应的解释。

我的想法错了吗/我这样做是否正确？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T16:15:12.113

我在您的模型中看到了这一点：

```
ID: 1 
```

JavaScript 区分大小写，因此[`id`](http://documentcloud.github.com/backbone/#Model-id)是`ID`不同的东西；`id`Backbone 在默认情况下正在寻找并且对`ID`.

如果你使用`id`，那么一切都会开箱即用：

```
​var M = Backbone.Model.extend({});
var C = Backbone.Collection.extend({
    model: M
});
​var c = new C([
    { id: 1, str: 'where'    },
    { id: 2, str: 'is'       },
    { id: 3, str: 'pancakes' },
    { id: 4, str: 'house?'   }
]); 
```

演示：http: [//jsfiddle.net/ambiguous/nzLEC/](http://jsfiddle.net/ambiguous/nzLEC/)

`id`或者你可以告诉你的模型使用不同的属性[`idAttribute`](http://documentcloud.github.com/backbone/#Model-idAttribute)：

> **idAttribute** `model.idAttribute`
> 
> 模型的唯一标识符存储在`id`属性下。如果您直接与使用不同唯一键的后端（CouchDB、MongoDB）通信，则可以设置模型`idAttribute`以透明地从该键映射到`id`.

描述的第一句话可能更好地表述为

> 模型的唯一标识符存储在`id` *属性*下。

避免 JavaScript 对象*属性*和 Backbone 模型*属性*之间的一些常见混淆。

例如：

```
var M = Backbone.Model.extend({
    idAttribute: 'ID'
});
var C = Backbone.Collection.extend({
    model: M
});
var c = new C([
    { ID: 1, str: 'where'    },
    { ID: 2, str: 'is'       },
    { ID: 3, str: 'pancakes' },
    { ID: 4, str: 'house?'   }
]); 
```

演示：http: [//jsfiddle.net/ambiguous/3NhGV/](http://jsfiddle.net/ambiguous/3NhGV/)

# algorithm - 使用边界查找前推数的算法？

> ID：10802555
> 
> 赞同：1
> 
> 时间：2012-05-29T15:52:29.193
> 
> 标签：algorithm

我想知道是否有一种算法可以告诉我，如果我正在寻找范围内的排列，我会得到多少结果。

我有一个寻找组合的程序。最好的解释方式是举个例子，假设您有 4 件商品要在商店购买：苹果、桃子、梨和橙子。您想知道每个篮子可以容纳多少百分比，但您告诉自己您想要一分钟。每个项目 20 个，每个项目最多 60 个（因此 apple:25、peach:25、pear:25 和 orange:25 效果很好，但不是 apple:0、peach:0、pear:50 和 orange: 50，因为我们将最小值设置为 25）。如果您运行此示例，则返回的正确项目数为 1771。

有没有办法提前计算而不是运行实际程序？我有一个程序需要进行预置，我正在尝试找到理想的组合，所以我想编写一个程序来给我正确的输出，然后我将对输入进行蒙特卡罗模拟以找到混合我喜欢的项目/范围。

这是我使用的程序（在我从未使用过最高频段的情况下它可以工作，但如果范围更窄，1-4 那么它就不起作用，因为它给了我组合而不考虑范围）：

```
import math

def nCr(n,r):
    f = math.factorial
    return f(n) / f(r) / f(n-r)

if __name__ == '__main__':
    print nCr(20+4-1,20)  #percent+buckets(items)-1, percent 
```

这给了我正确的答案（1771），因为它不需要考虑最大值（60），因为它从未达到（它只使用 20 作为输入）。但是有没有一种方法可以修改这个公式（或使用其他东西），它会告诉我如果我有 40 个范围为 2-5 的项目或其他东西（将最大值考虑在内的东西）会有多少结果好）。

有没有可以做我正在寻找的算法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:23:41.750

您可以根据包含排除原则找到数字。让`distributions(itemCount,bucketCount)`是`itemCount`项目到`bucketCount`桶的无限制分布的数量。我忽略了下限，因为这只是通过减去`bucketCount*lowerLimit`项目来处理。

将`itemCount`项目分配到`bucketCount`每个存储桶最多包含项目的存储桶的方式`upperLimit`的数量是无限制分布的数量减去至少一个存储桶包含多个`upperLimit`项目的不受限制的分布的数量。后者可以用包含排除原则计算如下：

*   可以`bucketCount`选择一个存储桶来至少包含`upperLimit+1`项目，还有`itemCount - (upperLimit+1)`一些项目要分配到`bucketCount`存储桶：

    ```
    bucketCount * distributions(itemCount - (upperLimit+1), bucketCount) 
    ```

    必须从无限制分布的数量中减去。

*   但是我们已经减去了两个桶包含两次以上`upperLimit`项目的分布，我们必须纠正它并添加

    ```
    nCr(bucketCount,2) * distributions(itemCount - 2*(upperLimit+1), bucketCount) 
    ```

    再次，因为有`nCr(bucketCount,2)`两个桶的选择。

*   但是我们已经减去了三个桶包含三次以上的分布`upperLimit`，并再次添加了三次（`nCr(3,2)`），所以我们必须减去

    ```
    nCr(bucketCount,3) * distributions(itemCount - 3*(upperLimit+1), bucketCount) 
    ```

    纠正这一点。等等

总而言之，数量是

```
 m
 ∑ (-1)^k * nCr(bucketCount,k) * distributions(itemCount - k*(upperLimit+1), bucketCount)
k=0 
```

在哪里

```
m = min { bucketCount, floor(itemCount/(upperLimit+1)) } 
```

（因为没有办法分配负数的项目）。

更正了您的要点中的代码，并使用函数的实现来计算根据上下限分配项目的方式：

```
import math

def nCr(n,r):
    f = math.factorial
    return f(n) / f(r) / f(n-r)

def itemCount_cal(target, items, minValue):
    return target- items*minValue

def distributions(itemCount, bucketCount):
    # There's one way to distribute 0 items to any number of buckets: all get 0 items
    if itemCount == 0:
        return 1
    # we can't distribute fewer than 0 items, and we need at least one bucket
    if itemCount < 0 or bucketCount < 1:
        return 0
    # If there's only one bucket, there's only one way
    if bucketCount == 1:
        return 1
    #get all possible solutions
    # The number of ways to distribute n items to b buckets is
    # nCr(n+b-1,n)
    f = math.factorial
    return f(itemCount + bucketCount-1)/(f(itemCount) *  f(bucketCount-1))

def ways(items,buckets,lower,upper):
    if upper < lower: # upper limit smaller than lower: impossible
        return 0
    if buckets*upper < items: # too many items: impossible
        return 0
    necessary = buckets*lower
    if items == necessary:  # just enough items to meet the minimum requirement
        return 1
    if items < necessary:   # too few items: impossible
        return 0
    # put the minimum required number in each bucket, leaving
    # items - necessary
    # to distribute
    left = items - necessary
    # We have put 'lower' items in each bucket, so each bucket can now take
    # at most (upper - lower) more
    # any more, and the bucket is overfull
    over = upper + 1 - lower
    # maximal number of buckets we can put more than upper in at all
    # after we fulfilled the minimum requirement
    m = left // over
    # We start with the number of ways to distribute the items disregarding
    # the upper limit
    ws = distributions(left,buckets)
    # Sign for inclusion-exclusion, (-1)**k
    sign = -1
    # Number of overfull buckets
    k = 1
    while k <= m:
        # Add or subtract the number of ways to distribute
        # 'left' items to 'buckets' buckets with
        # k buckets overfull
        #
        # nCr(buckets,k) choices of the buckets we overfill at the start
        #
        # That leaves (left - k*over) items to distribute.
        ws += sign * nCr(buckets,k) * distributions(left - k*over,buckets)
        # flip sign and increment number of overfull buckets
        sign = -sign
        k += 1
    return ws 
```

请注意，对于大量的项目和存储桶，`nCr`使用阶乘计算不是最好的方法，它会导致大量的中间结果并使用不必要的操作。

# java - Documentum 6.5 与 JBOSS 5.1 问题

> ID：10802568
> 
> 赞同：1
> 
> 时间：2012-05-29T15:53:19.457
> 
> 标签：java, documentum6.5

我正在尝试在已为 Documentum 6.5.0.038 配置的 JBOSS 5.1 独立版中部署我的 War 应用程序，但是当我执行以下代码时

IDfClient 客户端 = DfClient.getLocalClient();

我收到 java.lang.NoClassDefFoundError：无法初始化类 com.documentum.fc.client.DfClient。即使它存在 App/WEB-INF/lib。我也尝试使用 jboss-classloading.xml、jboss-deployment-structure.xml 没有帮助。添加到类路径中也不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T10:01:16.750

尝试使用以下参数运行 AS：

```
-Djboss.vfs.forceCaseSensitive=true -Djboss.vfs.forceVfsJar=true 
```

# android - 何时手动附加/分离 Android 片段？

> ID：10802570
> 
> 赞同：9
> 
> 时间：2012-05-29T15:53:22.047
> 
> 标签：android, android-fragments

我已经深入阅读了[Fragments 文档，但没有看到对](http://developer.android.com/guide/topics/fundamentals/fragments.html)[FragmentTransaction.attach()](http://developer.android.com/reference/android/app/FragmentTransaction.html#attach%28android.app.Fragment%29)或[FragmentTransaction.detach()](http://developer.android.com/reference/android/app/FragmentTransaction.html#detach%28android.app.Fragment%29)方法的任何引用。但是，我发现了多个教程和演示，它们实际使用它们（例如[FragmentTabs Demo](http://developer.android.com/resources/samples/Support4Demos/src/com/example/android/supportv4/app/FragmentTabs.html)）。我的问题是：

1.  *理论上，你应该什么时候手动*附加/分离碎片？
2.  当 Fragment 被附加/分离时会发生什么？（它是否被创建/销毁？暂停/恢复？等？）
3.  *手动*附加/分离碎片是一种好习惯吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:55:28.097

Android 开发团队正在推动 Fragments 作为前进的方向。他们介绍的原因在网络上的各个地方都有记录，我不会在这里讨论。引入它们的原因之一是允许开发人员将其应用程序的特定功能封装到（几乎）可以适当加载和卸载的独立模块中，并最大限度地扩大 Android 平台可用的设备屏幕范围。

不幸的是（以我的拙见）片段有一些微妙之处可以抓住粗心的开发者（我就是其中之一）。虽然我不能声称自己是 Fragments 的任何权威，但我可以传递我在使用它们时发现的东西。所以回答你的问题：

`attach()/detach()`我不相信当你应该手动碎片时有任何硬性规定。但是，在某些情况下，您可能想要分离一个片段而不是用另一个片段替换它。但是请注意，这不会破坏[文档中所述的片段](http://developer.android.com/reference/android/app/FragmentTransaction.html#detach%28android.app.Fragment%29)

> 从 UI 中分离给定的片段。这与它被放入回栈时的状态相同：片段从 UI 中移除，但其状态仍由片段管理器主动管理。当进入这种状态时，它的视图层次结构被破坏。

Fragment 对象被销毁但可见元素（如果有）是。当 Fragment 被重新连接时，`attach()`它的 View 层次结构被重新创建（[docs](http://developer.android.com/reference/android/app/FragmentTransaction.html#attach%28android.app.Fragment%29)）：

> 在之前使用 detach(Fragment) 将片段与 UI 分离后重新附加片段。这会导致其视图层次结构被重新创建、附加到 UI 并显示。

正如我发现的那样，如果您在后台的 Fragment 需要更新它的 View 层次结构，因此当您返回 View 时它会立即更新，这并不是特别有用。最终结果是你得到一个“丑陋”的片段重绘。我的意思是丑陋，因为它使您的应用程序看起来匆忙且不专业地重新绘制自己，而不是更令人向往的光滑的“准备就绪”的空气。

如果保持最新的 Fragment UI 至关重要，那么有一些方法可以避免这种重新绘制。[您可以简单地显示（）](http://developer.android.com/reference/android/app/FragmentTransaction.html#show%28android.app.Fragment%29)和[隐藏（）](http://developer.android.com/reference/android/app/FragmentTransaction.html#hide%28android.app.Fragment%29)它们，而不是附加和分离你的片段。这避免了重新创建 View 层次结构，但您必须小心，在 Fragment 隐藏时，View 中的任何内容都不会尝试重新绘制自己；这将导致异常（我认为。自从我修补这些东西以来已经有一段时间了）。

手动附加和分离 Fragments 并没有错，您可能应该认为这些方法是由 Android 开发人员提供的，“以防万一”您需要做这样的事情。此外，`replace()`无论如何，我都想像调用这些更“原子”的方法。

至于碎片何时被销毁，显然它们在应用程序关闭时被销毁，但否则我怀疑它们只是落入正常的垃圾程序（但不要引用我的话！）。即，如果没有对该对象的引用，则将其标记为销毁。

# cordova - 使用 Cordova/PhoneGap 在 Android 模拟器中更改页面时出现“网络错误”？

> ID：10802575
> 
> 赞同：0
> 
> 时间：2012-05-29T15:53:38.397
> 
> 标签：cordova, android-emulator

当我在模拟器中运行我的 Cordova 应用程序时，它加载正常（尽管速度非常慢，这显然是一个常见的抱怨）。我正在使用 jQuery Mobile，由于 JQM 的表单方法存在某些问题以及 JQM 和 Google Maps 之间的冲突，我的应用程序的结构使得某些页面会导致整个 DOM 重新加载，而不是 JQM 通常引起的 AJAX 转换。该应用程序完全被带到一个单独的 html 文件中。

这在 iOS 中运行良好，但是当我在 Android 模拟器中运行它时，我得到“应用程序错误：发生网络错误。(file:///android_asset/www/nameOfPageIWasGoingTo.html?parameter1=34¶meter2=true)”

这些页面中的每一页都重新包含了 Cordova，我放置了该行

```
super.setIntegerProperty("loadUrlTimeoutValue", 60000); 
```

在我的主 .java 文件中，现在 onCreate 看起来像：

```
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
super.setIntegerProperty("loadUrlTimeoutValue", 60000);
super.loadUrl("file:///android_asset/www/index.html");
} 
```

不过，我有这个错误。谁能解释一下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T18:59:21.037

如果您尝试在 URL 中传递参数，Android 中存在一个错误，即 WebView 无法加载页面。*当它应该加载“nameOfPageIWasGoingTo.html”*并将参数传递给页面时， Android*会将“nameOfPageIWasGoingTo.html?parameter1=34¶meter2=true”*视为文件名。同时，您应该使用 localStorage.setItem/getItem 在页面之间传递参数。

 *同时，您应该关注以下问题：

[https://code.google.com/p/android/issues/detail?id=17535](https://code.google.com/p/android/issues/detail?id=17535)

[https://code.google.com/p/android/issues/detail?id=17327](https://code.google.com/p/android/issues/detail?id=17327)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-05T18:34:22.480

您可能需要使用 IceCreamCordovaWebViewClient

```
@Override
    public void init() {
    super.init(webView, new IceCreamCordovaWebViewClient(this, webView), new CordovaChromeClient(this, webView));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-26T15:10:40.643

出现此网络错误的原因有多种，但我的猜测是您的 config.xml 正在寻找 index.html 并且您已将 html 页面命名为其他名称。("nameOfPageIWasGoingTo.html")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-26T16:58:17.837

不要使用查询字符串参数，而是使用 window.localStorage。有点晚了，但已确认 =)。*

# java - 如何将每条记录与同一个 List Java 中的所有其他记录进行比较？

> ID：10802577
> 
> 赞同：0
> 
> 时间：2012-05-29T15:53:48.960
> 
> 标签：java, list, foreach, arraylist, compare

我有一个清单：

```
List<BookDTO> bookList = libraryDTO.getBooks();

int bookCounter = 0;
for (BookDTO bookdto : bookList)
{
       if ((!errors.isEmpty() && !errors.containsKey("book[" + bookCounter + "].bookRefNo") || errors.isEmpty()) &&
           // do comparison for each record with other records in same list ) {

           errors.put("book[" + bookCounter + "].bookRefNo", messageSource.getMessage("bookRefNo.cannot.be.same", null, null));
        }

    bookCounter++;
    } 
```

现在，我不知道如何进行比较检查..基本上如果有匹配的记录（具有相同值的记录），我应该得到密钥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:58:46.120

我不明白如果有两本书具有相同的值会引发错误（看起来你的代码似乎如此），或者你是否只想在计数时跳过它。

**在任何情况下，如果不为每个元素循环整个集合（即O(n^2)**复杂度），您就不能使用不考虑键的数据结构来做到这一点。

你能用更合适的东西，比如一套吗？

```
List<BookDTO> bookList = libraryDTO.getBooks();
Set<BookDTO> bookSet = new HashSet<BookDTO>(bookList);

bookCounter = bookSet.size(); 
```

当然，这假设 和具有`BookDTO`正确的实现。您甚至可以使用类似的排序集，但这会假设.`equals(..)``hashCode()``TreeSet<BookDTO>``BookDTO implements Comparable<BookDTO>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:19:24.703

好的，我猜您的 BookDTO 有一个 bookRefNo 属性，并且您不想拥有多个具有相同 bookRefNo 的书。

一种解决方案是依靠[Set](http://docs.oracle.com/javase/6/docs/api/java/util/Set.html)不包含重复元素的事实，因此在您的循环中您可以执行以下操作：

```
Set<String> bookRefs = new HashSet<String>();
for (BookDTO bookdto : bookList)
{
    if (!bookRefs.add(bookDto.getBookRef()))
    {
        // if we are here we tried to insert the same bookRef more than once...
    }
} 
```

# objective-c - 增加 UITableView 的点击区域

> ID：10802581
> 
> 赞同：1
> 
> 时间：2012-05-29T15:53:56.587
> 
> 标签：objective-c, ios, uitableview

我正在尝试拥有一个分组样式的 UITableView，它占据了 iPad 宽度的 70% 左右，因为 100% 看起来并不好。这意味着两边大约有 150 像素。

这很好，但我想让屏幕的整个宽度都可以滚动。

我已经尝试过对内容视图和插图等进行各种处理，例如：

```
self.theTable.contentInset = UIEdgeInsetsMake(0, 150, 0, 150);
self.theTable.contentSize = CGSizeMake(self.theTable.contentSize.width + 300,  self.theTable.contentSize.height);
self.theTable.contentOffset = CGPointMake(-150, 0); 
```

但我不能让它像我想要的那样工作。

我需要能够点击任一侧的背景（150px 左右）并能够通过拖动来滚动表格视图。

从本质上讲，我猜这相当于将滚动视图的大小任一侧增加 150 像素，或者将表格视图的任一侧插入 150 像素。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T18:33:19.160

您可以覆盖`hitTest:withEvent:`tableView 的 superview 的方法并返回 tableView 以获得所需的点。

`hitTest:withEvent:`或者，您可以在 tableView中覆盖并检查那里的条件。

容器超级视图 hitTest 方法的示例。所有事件都将转发到 tableView。

```
- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event {
    if (![self pointInside:point withEvent:event]) {
        return nil;
    }
    UITableView *tableView = nil;
    for (UIView *v in self.subviews) {
        if ([v isKindOfClass:[UITableView class]]) {
            tableView = v;
            break;
        }
    }

    if (!tableView) {
        return self;
    }

    if (CGRectContainsPoint(tableView.frame, point)) {
        return [tableView hitTest:[self convertPoint:point toView:tableView] withEvent:event];
    } else {
        return tableView;
    }
} 
```

# eclipse - Eclipse RCP 应用程序中的简单文本控制台

> ID：10802583
> 
> 赞同：0
> 
> 时间：2012-05-29T15:54:02.477
> 
> 标签：eclipse, command-line, eclipse-plugin, console, eclipse-rcp

我想构建一个文本控制台，通过它我可以编辑在 GEF 编辑器中显示的模型。我想我可以为此扩展普通的 Eclipse 控制台。但我怎么能听呢？

我希望它像终端一样工作，所以我可以输入自定义命令（例如`+node text=hello`（对于“添加节点”）然后解析（？）它（检查它是否是`-node`or `+node`，并获取`text`值）并提供命令（`new CreateNodeCommand(text)`或类似命令）的内容。

感谢您提供有关从何处开始的任何提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T08:11:06.717

我还没有尝试过，但[在](http://book.javanb.com/eclipse-rich-client-platform-designing-coding-and-packaging-java-applications-oct-2005/ch16lev1sec1.html)第 16.1.2 节中。添加调试透视图和控制台视图描述了如何添加新控制台。他们创建了一个新的消息控制台，但在 org.eclipse.ui.console 中您可以找到最适合您的。

[这里](https://stackoverflow.com/questions/10533000/eclipse-rcp-custom-console)还有另一个类似的问题。

# android - 使用真机控制安卓模拟器

> ID：10802586
> 
> 赞同：2
> 
> 时间：2012-05-29T15:54:11.323
> 
> 标签：android, android-emulator

可以用真正的安卓设备来控制安卓模拟器吗？

例如，如果我点击实际设备屏幕上的某个点，点击也会发生在虚拟设备显示的等效位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T15:57:23.483

可能的？可能不知何故。可行的？并不真地。AFAIK 你必须开发整个系统才能自己工作。

您必须使用您编写的应用程序处理通信（可能是 USB 或蓝牙？）。

然后，您将不得不更改运行模拟器的固件，以允许从“侦听器”应用程序注入您自己的触摸事件，您还必须在模拟器上制作和运行该应用程序。

# ios - UIView 在加载 NIB 文件后立即显示？

> ID：10802588
> 
> 赞同：3
> 
> 时间：2012-05-29T15:54:16.447
> 
> 标签：ios, uiview, nib, addsubview

我尝试将 UIView 添加到我的应用程序中。它确实有效，但不如预期。我已经在我的标题中定义了 socialActionView 并在我的视图控制器中创建了一个 @synthesize。

当用户点击一个按钮时，会加载 nib 文件。我想我必须调用 addSubview 方法来显示视图。但即使我不这样做，它也会出现。

如果我调用 addSubView 方法，当我加载带有消息“警告：无法恢复先前选择的帧”的视图时，应用程序崩溃。

谁能解释这里发生了什么？我不明白。

```
- (IBAction)didTapOkSocialAction:(id)sender;
{
    self.socialActionView = [[[NSBundle mainBundle] loadNibNamed:@"SocialActionViewController" owner:self options:nil] objectAtIndex:0];
    //[self.view addSubview:socialActionView];
} 
```

编辑

在这种情况下，解决方案是将我的 SocialActionViewController.xib 的文件所有者设置为 ViewController.h。我还不知道如何从附加到另一个视图控制器类的 NIB 中添加 UIView，而不是加载视图的视图控制器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T17:44:43.707

如果我像这样以编程方式创建 UIView

```
- (IBAction)didTapOkSocialAction:(id)sender;
{
    UIView *myView = [[UIView alloc] initWithFrame:CGRectMake(20, 20, 100, 100)];
    myView.backgroundColor = [UIColor whiteColor];
    [self.view addSubview:myView];
    [myView release];
} 
```

那么 addSubView 是不可避免的。否则 myView 不会出现。我已经测试过了。但如果 UIView 是从笔尖加载的，似乎会有不同的行为。它立即出现。

在第二个测试中，我删除了属性，只剩下局部变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T16:00:05.687

您`socialActionView`已经绑定到其父视图中的视图占位符。

所以：它已经存在（它的引用已经添加为子视图），但`nil`直到你实际加载它。

编辑：目前尚不清楚您如何将所有东西连接在那里，但从您在下面添加的信息中我会做出一个疯狂的猜测。

试试这个代码：

```
- (IBAction)didTapOkSocialAction:(id)sender;
{
    UIView *loadedView = [[[NSBundle mainBundle] loadNibNamed:@"SocialActionViewController" owner:self options:nil] objectAtIndex:0];

    [self.view addSubview:loadedView];
} 
```

编辑：因为您想以编程方式从 .xib 加载视图控制器，您可以这样做（可能视图控制器在 MyViewController.h、.m、.xib 中定义）：

```
MyViewController *myViewController;  //as an ivar or a property in @interface

myViewController = [[ViewController alloc] initWithNibName:@"MyViewController" bundle:nil]; 
```

然后你可以添加它的视图：

```
[self.view addSubview: myViewController.view]; 
```

# r - 如何删除r中的相关或重复变量或个体

> ID：10802592
> 
> 赞同：3
> 
> 时间：2012-05-29T15:54:52.893
> 
> 标签：r, dataframe

我有以下类型（但是非常多的变量和 ind）数据：

```
 mydf <- data.frame (Inv = 1:6, varA = c(1,1,1,  0,1,1),
   varB = c(1,0,1,  0, 1,1), varC = c(1,0,0,  0,1,1), varD = c(1,1,1,  0,1,1), 
     varE = c(1,0,1,  0, 1,1), varF = c(1,1,1,  0, 1,1))

mydf
  Inv varA varB varC varD varE varF
1   1    1    1    1    1    1    1
2   2    1    0    0    1    0    1
3   3    1    1    0    1    1    1
4   4    0    0    0    0    0    0
5   5    1    1    1    1    1    1
6   6    1    1    1    1    1    1 
```

我想进行所有一对一的比较（变量和个人/主题），如果它们被重复并且重复的个人/变量的名称作为日志记录到不同的文件中，则只保留一个：

比如上面的数据：

在变量中：

```
varA is exactly same as varD and varF - so I will just keep varA only in new data

mydf$varA == mydf$varE
[1]  TRUE TRUE  TRUE  TRUE  TRUE  TRUE

varB and varE has exactly same data - so I will just keep varB
varC is unique 
```

Inv（即科目）中：

```
1, 5 and 6 are same  -> so just keep 1 
```

**因此生成的输出文件是**

```
 mydf <- data.frame (Inv = 1:4, varA = c(1,1,1,  0),
       varB = c(1,0,1,  0), varC = c(1,0,0,  0))
  Inv varA varB varC
1   1    1    1    1
2   2    1    0    0
3   3    1    1    0
4   4    0    0    0 
```

我可以通过相关矩阵找到重复：

```
cor(mydf[,-1])
          varA      varB      varC      varD      varE      varF
varA 1.0000000 0.6324555 0.4472136 1.0000000 0.6324555 1.0000000
varB 0.6324555 1.0000000 0.7071068 0.6324555 1.0000000 0.6324555
varC 0.4472136 0.7071068 1.0000000 0.4472136 0.7071068 0.4472136
varD 1.0000000 0.6324555 0.4472136 1.0000000 0.6324555 1.0000000
varE 0.6324555 1.0000000 0.7071068 0.6324555 1.0000000 0.6324555
varF 1.0000000 0.6324555 0.4472136 1.0000000 0.6324555 1.0000000 
```

我们可以自动化这个过程吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T09:52:10.113

您也可以[`findCorrelation`](http://rss.acs.unt.edu/Rdoc/library/caret/html/findCorrelation.html)从`caret`包中使用：

```
findCorrelation(x, cutoff = .90, verbose = FALSE) 
```

其中输出是一个索引向量，表示要删除的列。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-29T16:35:21.583

这应该可以解决问题：

```
dat <- mydf[-1]
cMat <- abs(cor(dat)) >= (1 - .Machine$double.eps^0.5)
whichKeep <- which(rowSums(lower.tri(cMat) * cMat) == 0)
cbind(mydf[1], mydf[whichKeep + 1])

  Inv varA varB varC
1   1    1    1    1
2   2    1    0    0
3   3    1    1    0
4   4    0    0    0
5   5    1    1    1
6   6    1    1    1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T16:31:29.353

这是一项非常可疑的统计工作，但不难识别该相关矩阵中为 1 且位于上三角形中的元素。

```
cmat <- cor(mydf[,-1])
hicorr <- which(row(cmat) < col(cmat) & cmat==1, arr.ind=TRUE)[,"col"]
hicorr
#varA varB varA varD 
#   4    5    6    6 

mydf[ , -hicorr]
  Inv varA varB varF
1   1    1    1    1
2   2    1    0    1
3   3    1    1    1
4   4    0    0    0
5   5    1    1    1
6   6    1    1    1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T16:30:30.107

我了解您正在尝试执行特征选择/降维。在这种情况下，请查看 CRAN 的[**FSelector**](http://cran.r-project.org/web/packages/FSelector/index.html)包。特别是，有几个基于相关性的过滤器，例如`linear.correlation(formula, data)`。有关详细信息，请参阅[此](http://en.wikibooks.org/wiki/Data_Mining_Algorithms_In_R/Dimensionality_Reduction/Feature_Selection)。

# scroll - 如何使用 Zepto.js 滚动 div？

> ID：10802596
> 
> 赞同：3
> 
> 时间：2012-05-29T15:55:12.263
> 
> 标签：scroll, zepto

我有一个 div，`overflow:scroll`现在我想以编程方式向下滚动该 div。Zepto.js 有可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T18:47:14.180

Zepto 不直接提供 API，但可以从较低级别的 DOM 访问它。

```
var $el = $('#scrolling-el');
var el = $el[0]; /* Actual DOM element */

/* Scroll to bottom */
el.scrollTop = el.scrollHeight - $el.height();

/* Scroll to top */
el.scrollTop = 0; 
```

动画滚动将是一个使用`setTimeout`. 你可以编写一个快速的 Zepto 插件。这是一个粗略的例子：

```
$.fn.scrollToBottom = function(duration) {
    var $el = this;
    var el  = $el[0];
    var startPosition = el.scrollTop;
    var delta = el.scrollHeight - $el.height() - startPosition;

    var startTime = Date.now();

    function scroll() {
        var fraction = Math.min(1, (Date.now() - startTime) / duration);

        el.scrollTop = delta * fraction + startPosition;

        if(fraction < 1) {
            setTimeout(scroll, 10);
        }
    }
    scroll();
}; 
```

# image - 如何在终端内递归地批量调整 Ubuntu 中的图像大小？

> ID：10802606
> 
> 赞同：39
> 
> 时间：2012-05-29T15:55:44.293
> 
> 标签：image, ubuntu, imagemagick, ubuntu-11.10

我有多个图像存储在一组有组织的文件夹中。我需要从它们的父目录**递归地**将这些图像重新调整为特定百分比。我正在运行 Ubuntu 11.10，我更喜欢直接从终端学习如何做到这一点。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-05-29T16:01:15.720

你可以使用[imagemagick](http://www.imagemagick.org/script/index.php)。例如，要将当前目录下的所有 JPG 图片调整为原始大小的 50%，您可以执行以下操作：

```
for f in `find . -name "*.jpg"`
do
    convert $f -resize 50% $f.resized.jpg
done 
```

结果文件的名称中将包含两次“.jpg”。如果这是一个问题，您可以检查以下替代方案。

对于遍历/查找要调整大小的文件，您也可以使用[xargs](http://en.wikipedia.org/wiki/Xargs)。例子：

```
find . -name "*.jpg" | xargs convert -resize 50% 
```

这将创建图像的副本。如果您只想将它​​们转换*到位*，您可以使用：

```
find . -name "*.jpg" | xargs mogrify -resize 50% 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-19T09:23:40.850

你也可以使用

```
sudo apt install imagemagick
sudo apt-get install nautilus-image-converter
nautilus -q 
```

用于调整当前文件夹中的图像大小/旋转图像。您只需安装，然后右键单击一个或多个图像，然后选择您想要的大小，就是这样。`nautilus -q`就是停止鹦鹉螺。只需再次启动 nautilus，您就可以使用图像转换器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-10-29T19:13:07.153

扩展来自@betabandido 的答案

如果图像所在的文件名或文件夹名称中有空格，则应将 -print0 与 find 一起使用，将 -0 与 xargs 一起使用，以避免任何解析错误。

```
find . -name "*.jpg" -print0 | xargs -0 convert -resize 50%
find . -name "*.jpg" -print0 | xargs -0 mogrify -resize 50% 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-30T13:42:23.203

如果您提供新的调整大小分辨率，它也可以工作：

```
convert $f.jpg -size 1024x768 $f.resized.png 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-28T13:00:56.193

您可以使用 imagemagick 工具进行批量调整大小。

它将保持纵横比

```
$ convert dragon.gif    -resize 64x64  resize_dragon.gif 
```

它不会保持纵横比

```
$ convert dragon.gif    -resize 64x64\!  exact_dragon.gif

$ cat resize.sh 
#!/bin/bash
for f in `find . -name "*.jpg"`
do
    convert $f -resize 45x60\!  $f.resize.jpg
done 
```

它将图像大小调整为 45x60，而不保持当前目录中的纵横比。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-12T00:10:57.990

有几个答案，例如：

```
find . -name "*.jpg" | xargs convert -resize 50% 
```

这将不起作用，因为它将像这样扩展列表： `convert -resize 50% a.jpg b.jpg c.jpg`它将调整`a.jpg`in `c-0.jpg`，`b.jpg`in`c-1.jpg`并`c.jpg`保持不变。

因此，您必须为每个匹配项执行调整大小命令，并给出输入文件名和输出文件名，例如：

```
find . -name "*.jpg" | xargs -n 1 sh -c 'convert -resize 50% $0 $(echo $0 | sed 's/\.jpg/-th\.jpg/')' 
```

的每个匹配项`find`都单独传递`xargs -n 1`给调整大小脚本：`sh -c 'convert -resize 50% $0 $(echo $0 | sed 's/\.jpg/-th\.jpg/')'`. 此脚本接收参数中的文件名`$0`，用于通过将原始后缀`sed`替换为 1 来生成输出文件名。它使用这两个文件名 运行命令。`.jpg``-th.jpg``convert`

这是没有`xargs`but的版本`find -exec`：

```
find -name '*.jpg' -exec sh -c 'convert -resize 50% $0 $(echo $0 | sed 's/\.jpg/-th\.jpg/')' {} \; 
```

# c# - LINQ to Sharepoint 中的查找字段有时无法检索

> ID：10802610
> 
> 赞同：1
> 
> 时间：2012-05-29T15:56:14.720
> 
> 标签：c#, linq, sharepoint

我正在尝试使用 LINQ to SharePoint 来检索和过滤带有查找字段的简单列表

```
 var list = _db.Leaves.Where(x =>x.Employee != null && x.Employee.Id == empId).ToList(); 
```

问题有时是随机的 Field Employee 是 null ！我不知道为什么！它是如此奇怪，以至于它随机发生，导致它抛出异常，有人知道为什么会这样吗？

```
<Field Type="Lookup" DisplayName="Employee" Required="True" EnforceUniqueValues="FALSE" List="Lists/Employees" ShowField="EnFullName" ID="{26183411-9bbf-48a1-b2f8-3388b98c7fef}" Name="Employee" ColName="int2" RowOrdinal="0" Indexed="TRUE" RelationshipDeleteBehavior="Restrict" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:04:51.240

如果没有为该字段分配值，则 Employee 将为 null。

仅仅因为它是必填字段并不意味着该字段将始终具有值。“必需”仅适用于该列表的 Web 表单表单，它不是对实际数据库本身的限制。例如，在代码中，您可以创建/编辑一个对象并将该字段设置为 null 而不会出现任何问题，即使它是必需的。如果您在上传文档时有一个文档库，它会创建列表项但不填充任何字段；直到项目稍后被编辑，查找才会是非空的（即使仅通过开箱即用的 Web UI 访问）。还有其他例子，但这个想法仍然存在。在 SharePoint 中，您需要对必填字段进行空检查。

# python - 各向异性扩散二维图像

> ID：10802611
> 
> 赞同：7
> 
> 时间：2012-05-29T15:56:19.053
> 
> 标签：python, c, image, matlab, filtering

我想在 2d 图像上使用各向异性扩散。

我想使用 python 但不介意使用 matlab 或 c。我可以使用他们的任何库作为第一步吗？我对这个主题进行了谷歌搜索，发现了 Panda3D 和 OpenGl。
基本上我想给一组图像让它应用过滤，然后将新图像输出到我想要的文件夹。

关于如何使用其中任何一种或您认为更好的方法的任何提示？

编辑：意思是扩散对不起！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-03T23:18:40.993

**[这是](http://pastebin.com/sBsPX4Y7)**我的 2D 和 3D 各向异性 (Perona-Malik) 扩散的 Python/numpy 实现。它不如 C 代码快，但它对我来说做得很好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-07-28T05:59:11.730

各向异性扩散自 2013 年起在[`medpy`包中提供](http://pythonhosted.org/MedPy/generated/medpy.filter.smoothing.anisotropic_diffusion.html)

```
import numpy as np
from medpy.filter.smoothing import anisotropic_diffusion

img = np.random.uniform(size=(32,32))
img_filtered = anisotropic_diffusion(img) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-27T04:13:40.203

```
import math
try:
    from cv2 import cv2
except:
    import cv2
import numpy as np

class anisodiff2D(object):

    def __init__(self,num_iter=5,delta_t=1/7,kappa=30,option=2):

        super(anisodiff2D,self).__init__()

        self.num_iter = num_iter
        self.delta_t = delta_t
        self.kappa = kappa
        self.option = option

        self.hN = np.array([[0,1,0],[0,-1,0],[0,0,0]])
        self.hS = np.array([[0,0,0],[0,-1,0],[0,1,0]])
        self.hE = np.array([[0,0,0],[0,-1,1],[0,0,0]])
        self.hW = np.array([[0,0,0],[1,-1,0],[0,0,0]])
        self.hNE = np.array([[0,0,1],[0,-1,0],[0,0,0]])
        self.hSE = np.array([[0,0,0],[0,-1,0],[0,0,1]])
        self.hSW = np.array([[0,0,0],[0,-1,0],[1,0,0]])
        self.hNW = np.array([[1,0,0],[0,-1,0],[0,0,0]])

    def fit(self,img):

        diff_im = img.copy()

        dx=1; dy=1; dd = math.sqrt(2)

        for i in range(self.num_iter):

            nablaN = cv2.filter2D(diff_im,-1,self.hN)
            nablaS = cv2.filter2D(diff_im,-1,self.hS)
            nablaW = cv2.filter2D(diff_im,-1,self.hW)
            nablaE = cv2.filter2D(diff_im,-1,self.hE)
            nablaNE = cv2.filter2D(diff_im,-1,self.hNE)
            nablaSE = cv2.filter2D(diff_im,-1,self.hSE)
            nablaSW = cv2.filter2D(diff_im,-1,self.hSW)
            nablaNW = cv2.filter2D(diff_im,-1,self.hNW)

            cN = 0; cS = 0; cW = 0; cE = 0; cNE = 0; cSE = 0; cSW = 0; cNW = 0

            if self.option == 1:
                cN = np.exp(-(nablaN/self.kappa)**2)
                cS = np.exp(-(nablaS/self.kappa)**2)
                cW = np.exp(-(nablaW/self.kappa)**2)
                cE = np.exp(-(nablaE/self.kappa)**2)
                cNE = np.exp(-(nablaNE/self.kappa)**2)
                cSE = np.exp(-(nablaSE/self.kappa)**2)
                cSW = np.exp(-(nablaSW/self.kappa)**2)
                cNW = np.exp(-(nablaNW/self.kappa)**2)
            elif self.option == 2:
                cN = 1/(1+(nablaN/self.kappa)**2)
                cS = 1/(1+(nablaS/self.kappa)**2)
                cW = 1/(1+(nablaW/self.kappa)**2)
                cE = 1/(1+(nablaE/self.kappa)**2)
                cNE = 1/(1+(nablaNE/self.kappa)**2)
                cSE = 1/(1+(nablaSE/self.kappa)**2)
                cSW = 1/(1+(nablaSW/self.kappa)**2)
                cNW = 1/(1+(nablaNW/self.kappa)**2)

            diff_im = diff_im + self.delta_t * (

                (1/dy**2)*cN*nablaN +
                (1/dy**2)*cS*nablaS +
                (1/dx**2)*cW*nablaW +
                (1/dx**2)*cE*nablaE +

                (1/dd**2)*cNE*nablaNE +
                (1/dd**2)*cSE*nablaSE +
                (1/dd**2)*cSW*nablaSW +
                (1/dd**2)*cNW*nablaNW
            )

        return diff_im 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T16:44:53.473

你不是说[各向异性扩散](https://en.wikipedia.org/wiki/Anisotropic_diffusion)？C 可能是最好的（比 matlab 和 python 更快）。但是matlab中有一个用于图像分析的工具箱：[matlabimagetoolbox](http://www.mathworks.se/products/image/)。我制作了一个在 c 中进行各向同性扩散的程序，我使用的唯一库是用于导入和导出图像的[libjpeg 。](http://ijg.org/)

# c# - 有没有办法缩短这么长的 if/else if 返回方法？

> ID：10802613
> 
> 赞同：4
> 
> 时间：2012-05-29T15:56:21.830
> 
> 标签：c#

我有这个很长的方法：

```
public decimal decDiscount(QuoteData quoteData)
    {
        if (TotalChapter7(quoteData) >= 7499)
            return 5300;
        else if (TotalChapter7(quoteData) >= 7449)
            return 5300;
        else if (TotalChapter7(quoteData) >= 7399)
            return 5250;
        else if (TotalChapter7(quoteData) >= 7349)
            return 5200;
        else if (TotalChapter7(quoteData) >= 7299)
            return 5200;
        else if (TotalChapter7(quoteData) >= 7249)
            return 5150;
        else if (TotalChapter7(quoteData) >= 7199)
            return 5100;
        else if (TotalChapter7(quoteData) >= 7149)
            return 5100;
        else if (TotalChapter7(quoteData) >= 7099)
            return 5050;
            //...
        else if (TotalChapter7(quoteData) >= 1199)
            return 1100;
        else if (TotalChapter7(quoteData) >= 1149)
            return 1100;
        else if (TotalChapter7(quoteData) >= 1099)
            return 1050;
        else if (TotalChapter7(quoteData) >= 1049)
            return 1000;
        else
            return 0;
    } 
```

它有一个反复出现的模式，可以用下面的 Excel 表来说明：

![Excel 工作表第 1 部分](../Images/5e5c194e35709e5dd27576fbae7501de.png) ……>>>> ![Excel 工作表第 2 部分](../Images/b9ffee9087ef005a7f1d4b89deb0dea0.png)

从最高的“费用”（7499）开始，每张报表的费用下降 50。但是，每 100 的回报（或“折扣价”）保持不变（两次 50 的费用下降），然后自己下降 50 以获得一次回报（一次 50 的费用下降），然后重复。

如您所见，我的方法很长（我在 7049 和 1249 之间遗漏了）。我能做些什么来缩短这个吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:27:26.550

你们真的太复杂了。任何试图使用整数算术解决这个问题的方法都是一个坏主意。看看一群真正聪明的人（我们都很聪明，不是吗？）甚至一开始就做对是多么困难。这真的很难发现，真的很难理解，很难正确，而且维护起来很糟糕。

您需要一种易于理解且易于维护的方法。查看您的原始帖子，您有该规则的英文描述。

> 但是，每 100 的回报（或“折扣价”）保持不变（两次 50 的费用下降），然后自己下降 50 以获得一次回报（一次 50 的费用下降），然后重复。

代码实际上是自己写的：

```
public int GetFeeFromQuoteData(QuoteData quoteData) {
    int fee = 5300;
    int difference = 7449 - TotalChapter7(quoteData);
    bool isTwoStep = true;

    while (difference > 0) {
        if (isTwoStep) {
            difference -= 50;
        }
        else {
            difference -= 100;
        }
        fee -= 50;
        isTwoStep = !isTwoStep;
    }
    return fee;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T16:14:24.697

**这些价格和折扣是*数据*！数据永远不应该被编译成代码**

我不会在代码中构建下降，我会构建基础定价结构（它们很可能会随着价格下降而发生变化，但不太可能改变整体定价结构）。

我会在反映此结构的易于更改的位置（例如数据库、xml 文件）中显示价格和相关折扣。

```
public class Pricing
{
     private List<Tuple<decimal, decimal>> pricePoints= new List<Tuple<int, decimal>> discountRanges();

    public Pricing()
    {
        // These hard coded values would be replaced by logic to load from file.
        pricePoints.Add(Tuple.Create(7499, 5300));
        pricePoints.Add(Tuple.Create(7399, 5250));
        pricePoints.Add(Tuple.Create(7349, 5200));
        pricePoints.Add(Tuple.Create(7249, 5150));
        . . .
        pricePoints.Add(Tuple.Create(1049, 1000));
    }

    public decimal GetDiscount(QuoteData quoteData)
    {
        var price = TotalChapter7(quoteData);
        foreach(var point in pricePoints)
        {
            if(price >= point.Item1)
                return point.Item2;
        }
        // If we're here it implies there were no matching points
        return 0;
    }
} 
```

如果你在代码中构建了drop，并且他们改变了drop，你就必须改变代码。
将数据放入文件中，在运行时加载文件一次，他们可以更改价格，您只需要更改文件。

**反驳“这显然是一个商业规则”评论**

不包括销售点的折扣（一次优惠 2 次，此商品 10% 的折扣等），基本上有三种方法可以计算总体费用或费用的折扣（其中任何一种都可以与首选客户折扣相结合）。

*   固定百分比（例如，始终为 10%）
*   不同价格点的不同百分比。
*   不同价格点的不同固定价格（这是我们在问题中看到的）

客户决定使用哪一个（或多个）是业务规则，是的，该规则需要在代码中表示。

但是，无论使用哪个规则，实际值都是数据，并且该数据**永远不**应该（除非*非常*特殊的情况）在代码中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T16:14:23.563

也许这会有所帮助：

```
 List<Tuple<int, int>> _FeeToPrice = new List<Tuple<int, int>> { 
                new Tuple<int,int>(7499,5300),
                new Tuple<int,int>(7399,5250),
                            ...
                new Tuple<int,int>(1049,1000)
            };

        public decimal decDiscount(QuoteData quoteData)
        {
            var processedQuoteData = TotalChapter7(quoteData);
            var tuple = _FeeToPrice.FirstOrDefault(x => processedQuoteData >= x.Item1);
            if (tuple != null)
                return tuple.Item2;

            return 0;                           
        } 
```

编辑： `_FeeToPrice`结构可以从文件或数据库或其他一些来源加载，这将允许更容易更正返回值

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T16:15:14.883

分析计算的工作公式如下：

```
int calcDiscount(int p)
{
  int s = (7500/50) - (p+1) / 50;
  int k = s / 3;
  int j = s % 3;

  return 5300 - 100*k - (j == 2 ? 50 : 0) 
} 
```

工作测试用例（Java）：

```
for (p = 7499; p >= 1000; p -= 50)
{
  System.out.println (p+ " " + calcDiscount(p));
} 
```

解释：首先你找到当前价格从最大值（7499）下降多少步，然后你知道你必须每三步将折扣值下降 100，但如果你在当前三元组的最后一步，你必须将它下降一个额外50。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T16:13:03.317

伪代码如下：

```
Dictionary<Int, Int> getDiscounts(int startFee, int startDiscount, int endFee)
{
    Dictionary <Int, Int> quoteDictionary = new Dictionary<Int, Int> ();
    for(int i = 0; i++; startFee >= endFee)
    {
         startFee -= 50;
         if(i != 0)
         {
             startDiscount -= 50;
         }
         if(i == 2)
         {
             i = -1;
         }
         quoteDictionary[startFee] = startDiscount;
    }
    return quoteDictionary;
} 
```

你可以这样称呼它：

```
Dictionary <Int, Int> prices = getDiscounts(7499, 5300, 1049);
int quote = TotalChapter7(quoteData);
int roundedQuote = quote - ((quote % 50) + 1);
int discountedFee = prices[roundedQuote]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-29T16:58:59.470

我不知道这是否对您有用，但您可以使用字典，并按照上面的示例按降序对键进行排序。

我还没有测试过，但这样的事情可能会奏效：

```
public int GetNumber(int value)
{
    //initialize a dictionary to hold pairs of numbers
    var ranges = new SortedDictionary<int, int>
    {
        { 25, 250 },
        { 50, 500 },
        { 75, 750 }
    };

    //sort the dictionary in descending order and return the first value
    //that satisfies the condition
    return ranges.OrderByDescending(p => p.Key)
        .FirstOrDefault(p => value >= p.Key).Value;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-05-29T16:11:20.837

尝试使用字典，尝试做一个例子，但我不经常使用 C#，所以纠正代码上的任何不正确的地方，试着理解一下：

```
public decimal decDiscount(QuoteData quoteData)
{
    int result = 0; //if it doesn't match to any value on the dictionary it will return 0
    Dictionary<int, int> quotes = new Dictionary<int, int();
    quotes.add(7499, 5300); // not sure if that's how you add values to a dictionary
    ...
    quotes.add(1049, 1000);

    for(Entry<int, int> element in quotes) //not sure about the enhanced for too hehehe, not using C# for a while
    {
        if(TotalChapter7(quoteData) >= element.key() && element.value > result)
        {
            result = element.value(); //don't break cause you have to test the entire list for acurracy
        }
    }

    return result;
} 
```

# javascript - css：在jquery load（）之后悬停不工作；

> ID：10802626
> 
> 赞同：0
> 
> 时间：2012-05-29T15:57:03.030
> 
> 标签：javascript, jquery, css

我正在使用 load() 函数将元素加载到 div 中。但是，css 中的 :hover 效果不再适用于 do 元素。

这是一个动态菜单，如下所示：

```
<div id='main-menu'>
<ul>
<li class='click-me hover-me'></li>
</ul>
</div>

<div id='alternative-menu'>
</div> 
```

然后我将一个新菜单加载到替代菜单中并在 js 中隐藏旧菜单：

```
$(document).on('click', '.click-me', function(){

    $('#alternative-menu').load('newmenu.php', function(){$('#main-menu').hide();});
}); 
```

新菜单的 html 代码如下所示：

```
echo "
    <ul>
    <li class='click-me hover-me'></li>
    </ul>"; 
```

在我的CSS中，我有：

```
.hover-me{
font-size:12px;
}

.hover-me:hover{
background-color:#eeeeee;
} 
```

任何想法如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:23:46.990

如果您在加载后尝试使用 jQuery 添加正确的 CSS 类会怎样。

也许是这样的：

```
$('#alternative-menu').load('newmenu.php', function() {
    $('#main-menu').hide();
}).children("li").addClass("hover-me"); 
```

# java - JMock - Expectations 块中的唯一方法子集

> ID：10802628
> 
> 赞同：1
> 
> 时间：2012-05-29T15:57:07.930
> 
> 标签：java, unit-testing, rhino-mocks, jmock

之前有使用 RhinoMocks 的经验，它区分了两种不同`Mockery`类型的类：一种是严格的，它执行与标准 JMock 模拟完全一样的检查，另一种是 normla，它根本不关心您未在期望中列出的方法。

例如，如果您想测试是否在您的对象上调用了方法 a()，但整个程序可能随后调用许多其他方法，在 JMock 中您必须明确列出所有内容，而 Rhino 只关心您实际列出的那些被称为。有没有办法在 JMock 中实现相同的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T07:11:10.967

```
but the whole program might subsequently invoke many other methods 
```

每当我觉得 JMock 需要更多“功能”时，我通常会发现我遇到了设计问题。您是否考虑过需要在同一个对象上调用许多不同的方法？您能否重构到您正在测试的行为只涉及对模拟的几次调用？

您可以使用`allowing(mockedInterface)`来允许模拟上的所有调用。

# javascript - 需要 js 主干 JS 全局模型

> ID：10802630
> 
> 赞同：7
> 
> 时间：2012-05-29T15:57:10.240
> 
> 标签：javascript, jquery, backbone.js, requirejs

我想创建一个 UserSession 模型，它使用 jQuery cookie 插件加载会话 ID 并将其保存到 cookie 中。

这是我的 UserSession 模型模块的代码：

```
define(['jQuery', 'Underscore', 'Backbone'],
function($, _, Backbone){

    var UserSession = Backbone.Model.extend({
        defaults: {
            'accessToken': null,
            'userId': null
        },
        initialize: function(){
            this.load();
        },
        authenticated: function(){
            return Boolean(this.get('accessToken'));
        },
        save: function(authHash){
            $.cookie('userId', authHash.id);
            $.cookie('accessToken', authHash.accessToken);
        },
        load: function(){
            this.userId = $.cookie('userId');
            this.accessToken = $.cookie('accessToken');
        }
    })

    return UserSession;
}); 
```

但是可以说我想在我的登录视图中访问它：

```
define(['jQuery', 'Underscore', 'Backbone', 'text!templates/login.html', 'models/UserLogin', 'models/UserSession'],
function($, _, Backbone, loginTemplate, UserLogin, UserSession){

    var LoginView = Backbone.View.extend({
        model: new UserLogin,
        el: $('#screen'),
        events: {
            'submit #frm-login': 'login'
        },
        login: function(e){
            e.preventDefault(); // Lets not actually submit.

            this.model.set({
                'username': $('#login-username').val(),
                'password': $('#login-password').val()
            });

            this.model.save(null, {
                success: function(nextModel, response){
                    // Do something here with UserSession model
                },
                error: function(){
                }
            });
        },

        render: function(){
            $(this.el).html(_.template(loginTemplate, {}));
            return this;
        }
    });

    return new LoginView;
}); 
```

问题是每次我在模块中访问 UserSession 模型（参见 model.save 成功回调函数）它使用默认值，所以我需要有某种 UserSession 模型的单例实例，我该怎么做？

我的第一个想法是在我们的 main.js （加载的第一个主模块）中使用 app 命名空间并在那里初始化 UserSession 模块，并且每次另一个模块访问该模块时，需要具有返回对象的主模块UserSession 实例。

怎样才能做到最好？

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-29T16:08:32.010

假设您想要在整个应用程序中使用单个全局 UserSession，我将只从 UserSession 模块返回一个实例化的 UserSession。这样，每当您在定义调用中使用 UserSession 时，您都会得到相同的对象。例如

```
define(['jQuery', 'Underscore', 'Backbone'],
function($, _, Backbone){
    var UserSession = Backbone.View.extend({ ... });

    return new UserSession();
}); 
```

然后在其他地方：

```
define(['UserSession'],
function( UserSession ){
    // UserSession in here will be the singleton you created in the UserSession module
    alert( UserSession.authenticated() );
}); 
```

Require.js 应该只运行 UserSession 模块一次，无论它在其他地方使用了多少次，因此您在其中实例化的 UserSession 对象实际上是一个单例。

# javascript - 一旦放置在高角度或低角度，相机的行为就会很奇怪

> ID：10802634
> 
> 赞同：1
> 
> 时间：2012-05-29T15:57:19.570
> 
> 标签：javascript, 3d, camera, three.js

我有一个简单的 Three.js 场景，我想围绕它移动相机。相机不仅需要能够移动，还需要能够改变围绕某个焦点的角度。焦点实际上是相机位置，在渲染时，我实际上只是将相机平移`cameraBuff`并将其放置在一个球体上，然后我告诉它看焦点。

在相机移动之前，一切正常，我可以旋转相机等等。但是，一旦我开始移动，似乎有什么东西坏了！在正常角度（垂直，0 < x < 180）它只是冻结并且根本不能围绕焦点旋转。一旦我将它向下移动一点，一切都会重新开始工作。详细说明一下，一旦`cameraBuff`点垂直于表面，问题就会发生。

这是我用来`cameraBuff`围绕焦点旋转矢量/点的代码：

```
//mouse.onDown* things are recorded once the mouse is initially pressed
theta = -((event.clientX - mouse.onDownPosition.x) * 0.5) + mouse.onDownTheta;
phi = ((event.clientY - mouse.onDownPosition.y) * 0.5) + mouse.onDownPhi;

phi = Math.min(180, Math.max(0, phi));

cameraBuff.x = radius * Math.sin(theta * Math.PI / 360 ) * Math.cos( phi * Math.PI / 360 );
cameraBuff.y = radius * Math.sin(phi * Math.PI / 360 );
cameraBuff.z = radius * Math.cos(theta * Math.PI / 360 ) * Math.cos( phi * Math.PI / 360 ); 
```

例如，一旦我更改`phi = Math.min(180, Math.max(0, phi));`为`phi = Math.min(160, Math.max(20, phi));`，一切正常，但我什至无法让相机垂直于表面，甚至无法降低它。

例如，按下 w 时会发生这种情况：

```
if (input.w)
{
    var speed = [game.direction.x*60, game.direction.z*60];

    game.camera.position.x -= speed[0]; //camera.position and focus are basically the same point all the time.
    game.focus.x -= speed[0];

    game.camera.position.z -= speed[1];
    game.focus.z -= speed[1];
} 
```

方向计算如下：

```
var c = Math.sqrt(cameraBuff.x*cameraBuff.x + cameraBuff.z*cameraBuff.z);
var rat = 1/c;

game.direction.x = cameraBuff.x*rat;
game.direction.z = cameraBuff.z*rat; 
```

有人可以解释我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:09:36.493

3D 相机需要一个矢量，因此它知道如何倾斜相机。这通常是向上的方向，并且是一个正 Y 向量。如果相机平行于向上的方向，它不知道什么是向上的，所以它会猜测，你不能倾斜相机。要让相机倾斜，您需要修改向上的方向。

我没有用过 Three.js，但我认为你可以使用 camera.up 向量。

您也可以通过将角度限制为 0.1 < x < 179.9 来使其工作

# c# - 序列化为 JSON（使用 Json.Net），同时忽略继承的成员

> ID：10802638
> 
> 赞同：4
> 
> 时间：2012-05-29T15:57:38.010
> 
> 标签：c#, json, serialization, .net-4.0, json.net

使用反射，我可以根据成员是否是继承、声明、公共、私有等来过滤成员。在使用 JSon.NET 序列化对象时，有什么方法可以进行相同类型的过滤吗？

我的代码目前是：

```
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;

public void addRequestParameters<T>(string key, T SerializableRequestParameters)
{
    //Serialize the object
    string json = JsonConvert.SerializeObject(SerializableRequestParameters, new JsonSerializerSettings
    {
        TypeNameHandling = TypeNameHandling.All,
        ReferenceLoopHandling = ReferenceLoopHandling.Ignore
    });
    //Add it to an existing request (unrelated to this question)
    ((JObject)JSONRequest).Add(key, JToken.Parse(json));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T17:49:29.770

我认为您可以使用自定义`ContractResolver`来实现您的目标。

> IContractResolver 接口提供了一种方法来自定义 JsonSerializer 如何将 .NET 对象序列化和反序列化为 JSON。
> 
> 实现 IContractResolver 接口，然后将实例分配给 JsonSerializer 可以让您控制对象是序列化为 JSON 对象还是 JSON 数组、应该序列化哪些对象成员、如何序列化它们以及调用什么。

无论如何，我在这里发现了同样的问题：[Using JSON.net, how do I prevent serializing properties of a derived class, when used in a base class context?](https://stackoverflow.com/questions/5872855/using-json-net-how-do-i-prevent-serializing-properties-of-a-derived-class-when)

# c# - 在 C# 中处理大量数据

> ID：10802639
> 
> 赞同：2
> 
> 时间：2012-05-29T15:57:39.847
> 
> 标签：c#, visual-studio-2008

如果我正在处理大量数据并且我将它最小化时表单会变成白色但当文件处理完成后它会恢复到它的原始表单时我该怎么办？

前任：

这就是我最小化表单时发生的事情。

![在此处输入图像描述](../Images/617ae1782af0fa66aec542eaf108c4ca.png)

这就是处理大量数据后发生的事情。它会恢复到原来的形式。

![在此处输入图像描述](../Images/e853c4456461cee2570be1e7a1175d59.png)

我想要做的是，即使我正在最小化表格，表格也不会变成白色并显示文件处理进度发生了什么。

我正在使用 Visual Studio 2008 和 C# 语言。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T16:02:03.627

正如 Massimiliano 的回答所暗示的那样，白色窗口的原因是您正在 UI 线程上执行处理。由于它忙于做任何事情（加密文件，从它的外观来看），线程不能自由地绘制窗口。

查看[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)类，了解如何在后台线程上进行处理的好例子。在上面的链接中，大约在页面的中间有一个示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T15:58:47.560

这是一个应该使用 MultiThread 的经典示例

看看下面：

[http://visualstudiomagazine.com/articles/2010/11/18/multithreading-in-winforms.aspx](http://visualstudiomagazine.com/articles/2010/11/18/multithreading-in-winforms.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T16:06:27.737

由于您还没有告诉我们您正在处理的内容是一个样本

```
//this starts the new thread
Task.Factory.StartNew( () =>
{

   //do you stuff here, I added a windows directory file search
   DirectoryInfo dir = new DirectoryInfo(@"c:\");

   //searches for all files on your computer, it will run for a while, stops after it finds 200
   foreach(var file in dir.EnumerateFiles("*" + textBox1.Text + "*.doc?", SearchOption.AllDirectories).Take(200))
   {
      this.BeginInvoke( new Action(() =>
         {
            //this sends information back to the main ui thread it can be any method at all
            Files.Add(file);
         }));
   }
 }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T16:01:53.330

让您的长时间运行的工作在后台线程（或工作线程）上执行，这样您的 UI 线程就会响应用户。您看到“白色”是因为您的 UI 线程在执行长时间运行的工作时被阻塞。

如果您在 Google 周围搜索，就会有很多示例，[这里](http://www.dotnetperls.com/backgroundworker)有一个示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T16:03:32.313

最**优雅**的解决方案可能是在不同的线程中完成冗长的过程。如果您这样做，请确保您暂时禁用用户界面（可能通过模态显示一个小的进度屏幕）。正如 Chris Shain 建议的那样，[Background Worker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)可能是要走的路。

如果您正在寻找**最短的**答案并且您可以访问 [en|de]cryption 算法中的一些进度事件，您可以定期调用[form.Refresh()](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.refresh.aspx)来重新绘制屏幕。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-29T16:04:30.553

BackgroundWworker 是一种多线程。我认为这比直接使用线程要容易一些。

[后台工作者](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)

Dowork 是您加密或解密的时间。并通过 DoWorkEventArgs e 中的争论（文件和加密模式）。在 RunWorkerCompleted 中，您可以显示一条消息，它已完成。或者有一个已完成文件的 ListView。您甚至可以在加密/解密工作时离开加密模式并热打开文件。然后在 RunWorkerCompleted 上启用 Encypt and Decrypt 按钮。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-29T16:05:27.683

直到您的应用程序正在计算 UI 线程才处理消息，所以您有一个白色的 from。

你有两种方法可以解决它：

1.  将所有计算移到单独的线程中。

2.  从您的计算代码中调用 Application.DoEvents()，这是不好的部分，但它可以工作

多线程示例：

```
private void ButtonClick(...)
{
  ((Action)Calculation).BeginInvoke(null, null);
}

private void Calculation()
{
  your calculations here
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-29T16:05:58.580

在 windows 窗体中，您应该使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)在后台工作，并且不要停止 de UI Thread

# android - 当只有一个标头时跳过 PreferenceActivity 中的标头

> ID：10802640
> 
> 赞同：25
> 
> 时间：2012-05-29T15:57:47.667
> 
> 标签：android, preferenceactivity

我在我的应用程序中添加了首选项标题，以便首选项屏幕在 Honeycomb 和平板电脑大小的 ICS 上看起来不会损坏。但是，我目前只有一个标题，因此您必须单击标题屏幕，在手机大小的设备上只有一个条目。当只有一个标题时，是否有一种简单的方法可以告诉 android 跳过标题屏幕，但仍然在大屏幕上显示它？

股票联系人应用程序似乎成功地做到了这一点，但我浏览了它的[源代码](https://github.com/android/platform_packages_apps_contacts)并且无法弄清楚它是如何做到的。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-06-09T11:45:12.327

您可以通过将您的 PreferenceFragments 之一设置为默认值来跳过标题。

当您查看[PreferenceActivity.java](http://source-android.frandroid.com/frameworks/base/core/java/android/preference/PreferenceActivity.java)源代码时，您会发现以下两个额外内容：

```
/**
 * When starting this activity, the invoking Intent can contain this extra
 * string to specify which fragment should be initially displayed.
 */
public static final String EXTRA_SHOW_FRAGMENT = ":android:show_fragment";

/**
 * When starting this activity, the invoking Intent can contain this extra
 * boolean that the header list should not be displayed.  This is most often
 * used in conjunction with {@link #EXTRA_SHOW_FRAGMENT} to launch
 * the activity to display a specific fragment that the user has navigated
 * to.
 */
public static final String EXTRA_NO_HEADERS = ":android:no_headers"; 
```

现在只需将这两个附加内容添加到调用您的 PrefenceActivity 的意图中，并指定默认情况下应显示的 PreferenceFragment 如下：

```
Intent intent = new Intent( this, Preferences.class );
intent.putExtra( PreferenceActivity.EXTRA_SHOW_FRAGMENT, PreferencesFragment.class.getName() );
intent.putExtra( PreferenceActivity.EXTRA_NO_HEADERS, true ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-12T04:55:35.223

利用`EXTRA_SHOW_FRAGMENT`jenzz 提到的，您可以操纵 Activity 的 Intent，如下所示：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
  // By default, show MainPreferences
  Intent intent = getIntent();
  if (intent.getStringArrayExtra(EXTRA_SHOW_FRAGMENT) == null) {
    getIntent().putExtra(EXTRA_SHOW_FRAGMENT, MainPreferences.class.getName());
  }

  super.onCreate(savedInstanceState);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-02-07T16:27:20.523

您可以在活动中删除此代码。

```
 public void onBuildHeaders(List<Header> target) {
        loadHeadersFromResource(R.xml.pref_general, target);
    } 
```

并替换您的片段：

```
public class SettingsActivity extends AppCompatPreferenceActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
           getFragmentManager().beginTransaction().replace(android.R.id.content,
                new GeneralPreferenceFragment()).commit();

    }

    @TargetApi(Build.VERSION_CODES.HONEYCOMB)
    public static class GeneralPreferenceFragment extends PreferenceFragment {
        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            addPreferencesFromResource(R.xml.pref_general);

        }

    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T14:51:51.843

我不知道您是否可以专门跳过标题，但这就是我所做的。

我创建了 2 个类，一个用于超大屏幕尺寸，一个用于其余的。EditPreferences.class 加载我正常的preferences.xml，EditPreferencesXLarge.class 加载preference-headers xml。

```
public boolean onOptionsItemSelected(MenuItem item) {
    final int SCREENLAYOUT_SIZE_XLARGE = 4;
    final int HONEYCOMB = 11;
    int screenSize = getResources().getConfiguration().screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK;

    switch(item.getItemId())
    {
        case R.id.item_prefs:
            if (Build.VERSION.SDK_INT < HONEYCOMB) {
                startActivity(new Intent(this, EditPreferences.class));
            }
            else if (screenSize < SCREENLAYOUT_SIZE_XLARGE) {
                startActivity(new Intent(this, EditPreferences.class));
            }
            else {
                startActivity(new Intent(this, EditPreferencesXLarge.class));
            }

            return true;
    }

    return (super.onOptionsItemSelected(item));
} 
```

# android - 强制设置执行溢出

> ID：10802641
> 
> 赞同：2
> 
> 时间：2012-05-29T15:57:50.867
> 
> 标签：android, android-layout, android-xml, android-actionbar, android-menu

我目前正在尝试将 aa 设置添加到我的应用程序中，但我不希望它出现在我的操作栏上，因为它在 android 开发人员文档中说设置应该始终位于底部的操作溢出中。我的问题是，即使酒吧里没有其他操作按钮和大量空间，你能否强制它进入操作溢出？我试过这样做

```
android:showAsAction="never" 
```

但这只是让你必须按下硬件菜单按钮。有没有一种我想念的简单方法？

任何帮助将非常感激

迪斯科

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T13:29:02.083

如果您在模拟器中测试`Honeycomb`（对于没有任何硬件按钮的平板电脑）“设置”菜单，它`showAsAction` *永远不会*被放置在溢出菜单中。我认为您看到的是带有菜单按钮的手机的默认行为，我不知道您是否可以修改它。

# c# - Android 2.1 bug 得到时间？

> ID：10802642
> 
> 赞同：0
> 
> 时间：2012-05-29T15:58:07.977
> 
> 标签：c#, datetime, xamarin.android

我在 Monodroid 上开发了一个应用程序，但遇到了以下错误。

当我这样做时`DateTime.Now`，该值被错误地保存在我的 Android 2.1 设备的数据库中。保存的时间始终对应于 GMT 时间，而不是设备的本地时间。另一方面，如果我在 Android 2.2 设备上运行我的应用程序，则保存在我的数据库中的时间是可以的。到底发生了什么？

我很感激一些帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T02:10:20.160

看起来像一个错误。

为了兼容性，使用`DateTime.UtcNow`. 它应该始终返回 GMT。

```
DateTime nowutc = DateTime.UtcNow;
DateTime now = TimeZoneInfo.ConvertTime(nowutc, TimeZoneInfo.Utc, TimeZoneInfo.FindSystemTimeZoneById(TimeZoneInfo.Local.Id)); 
```

# c++ - 对`pantheios_init`的未定义引用

> ID：10802643
> 
> 赞同：0
> 
> 时间：2012-05-29T15:58:15.610
> 
> 标签：c++, g++, pantheios

我正在尝试使用 pantheios，我阅读了本教程-> [http://binglongx.wordpress.com/2010/08/30/pantheios-logging-library-installation-and-use/](http://binglongx.wordpress.com/2010/08/30/pantheios-logging-library-installation-and-use/)

*make build*和*make test*没问题，我得到了很多“成功”

但是当我尝试包含这些文件时，我遇到了一些错误

```
#include <pantheios/pantheios.hpp>
#include <pantheios/inserters/integer.hpp>
#include <pantheios/inserters/pointer.hpp> 
```

**错误：**

```
/tmp/ccuzd4cD.o: In function `pantheios_initialiser::pantheios_initialiser()':
main.cpp:(.text._ZN21pantheios_initialiserC1Ev[pantheios_initialiser::pantheios_initialiser()]+0xd): undefined reference to `pantheios_init'
main.cpp:(.text._ZN21pantheios_initialiserC1Ev[pantheios_initialiser::pantheios_initialiser()]+0x1e): undefined reference to `pantheios_exitProcess'
/tmp/ccuzd4cD.o: In function `pantheios_initialiser::~pantheios_initialiser()':
main.cpp:(.text._ZN21pantheios_initialiserD1Ev[pantheios_initialiser::~pantheios_initialiser()]+0xd): undefined reference to `pantheios_uninit'
collect2: ld returned 1 exit status 
```

STLSOFT 没问题。

**g++编译**

```
g++ src/main.cpp -Wall -I./stlsoft-1.9.112/include -I./pantheios-1.0.1-beta213/include  -L./pantheios-1.0.1-beta213/lib -o test 
```

我的 gcc 版本是：gcc 版本 4.4.5 (Debian 4.4.5-8)，我构建了*gcc44.unix*目录。

我正在使用*pantheios-1.0.1-beta213*（最新）

是链接错误吗？

# php - 多个 instanceof 检查

> ID：10802645
> 
> 赞同：14
> 
> 时间：2012-05-29T15:58:32.943
> 
> 标签：php, instanceof

是否有一种更短的方法来检查一个对象是否是一组特定类的一部分？

使用`instanceof`会使`if`语句太长：

```
if($obj instanceof \Class1 || $obj instanceof \Class2 || $obj instanceof \Class3) 
```

这不起作用：

```
instance of \Class1 || \Class2 || \Class3 
```

它假设这`Class2`是恒定的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T16:15:11.500

> 使 IF 语句太长
> 
> [...]
> 
> 有没有更短的方法

当然。

只需**创建一个函数**：

```
function isOfValidClass($obj)
{
    $classNames = array('Class1', 'Class2');
    foreach ($classNames as $className) {
        if (is_a($obj, $className)) {
        return true;
    }

    return false;
} 
```

然后你可以在你的代码中使用它，而不必担心你的 if 语句“占用太多空间”（不是你应该考虑这个问题；语句应该只要它们需要）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-29T16:02:38.073

简而言之：没有

更长的答案：您可以创建变通方法，使用`get_parent_class()`递归来获取所有父类，然后用于[`array_intersect()`](http://php.net/array-intersect)找出您的一个或多个类名是否出现在那里。但是，似乎它们的类应该有一些共同点。将此放入接口中对此进行测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T16:01:59.820

我认为，最短的方法是将布尔表达式放在外部方法中并将其调用到 IF 语句中。

# validation - 验证总是返回错误

> ID：10802649
> 
> 赞同：0
> 
> 时间：2012-05-29T15:58:42.280
> 
> 标签：validation, cakephp

为什么我的模型每次尝试在数据库中输入两个名称时都始终返回 false。这是我的整个模型。我所做的只是检查关系表中是否存在 to/biller、partytwo/partyone。当我检查调试工具包时，它显示表单正在接受正确的变量，但是当我检查 this->validationErrors - 它什么都没有返回？请帮忙。

```
class Invoice extends AppModel{ 
        var $name='Invoice'; 
        public $useTable = 'invoices';
        public $primaryKey = 'id';
        public $belongsTo = array(
        'Relationship' =>array(
            'className' => 'Relationship',
            'foreignKey' =>'relationship_id',
            )
        ); 
        var $validate = array(
            'to' => array(
                'relationshipExists' => array(
                    'rule' => array(
                        'relationshipExists',
                        ),
                    'message' => 'sorry you dont have a relationship with that user.'
                    ),
                ),
            );

        public function relationshipExists($check){ 
            $relationshipExists=$this->Relationship->find('count', array('conditions' => array('Relationship.partyone','Relationship.partytwo'=>$check)));
                if ($relationshipExists == true) {
                    return TRUE;
                    }
                else
                    return FALSE;
                    }} 
```

-关系模型

```
<?php

class Relationship extends AppModel
{

    var $name = 'Relationship';
    public $useTable = 'relationships_users';
    public $hasMany = array(
        'Invoice' =>
            array(
                'className'              => 'Invoice',
                'joinTable'              => 'invoice',
                'foreignKey'             => 'invoice_id'));
    public $belongsTo = array(
        'User' =>array(
            'className' => 'User',
            'foreignKey' =>'partyone','partytwo',
            'associationForeignKey'  => 'username',
            )); 

    var $validate = array(
        'date' => array(
            'rule' => array(
                'datevalidation',
                'systemDate'
            ),
            'message' => 'Current Date and System Date is mismatched'
        ),
        'partytwo' => array(
            'userExists' => array(
                'rule' => array(
                    'userExists',
                ),
                'message' => 'That username doesnt exist.'
            ),
        ),
    );

    function datevalidation($field = array(), $compare_field = null)
    {
        if ($field['date'] > $compare_field)
            return TRUE;
        else
            return FALSE;
    }

    function userExists($check)
    {   
        $userExists = $this->User->find('count', array('conditions' => array('User.username'=>$check)));
        if ($userExists == 1) {
           return TRUE;
        }
        else
            return FALSE;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:21:27.100

你的发现会做一些有趣的事情......

```
$relationshipExists=$this->Relationship->find('count', array(
  'conditions' => array(
    'Relationship.partyone',
    'Relationship.partytwo' => $check
  )
)); 
```

这可能会产生类似于

```
SELECT COUNT(*) FROM relationships as Relationship 
  WHERE Relationship.partyone = 0
  AND Relationship.partytwo = Array; 
```

这是因为您没有将任何内容传递给Relationship.partyone，而将数组传递给partytwo。您需要将其更改为以下内容：

```
$relationshipExists=$this->Relationship->find('count', array(
  'conditions' => array(
    'Relationship.partyone <>' => null,
    'Relationship.partytwo' => current($check) // get the value from the passed var
  )
)); 
```

这会产生类似的东西

```
SELECT COUNT(*) FROM relationships as Relationship 
  WHERE Relationship.partyone IS NOT NULL
  AND Relationship.partytwo = 'fieldvalue'; 
```

调试`$check`以了解正在向您的验证消息发送什么值，并调试查找结果以查看结果。此外，查看 SQL 日志以查看它生成的 SQL。这应该让您更好地了解正在发生的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:04:06.027

您使用的是什么版本的 CakePHP？

无论如何，您不需要“public $useTable = 'invoices';”，因为您的表格名称是复数的模型名称。您也不需要“public $primaryKey = 'id';”，因为默认情况下它是 'id'。

[检查这个链接](http://book.cakephp.org/2.0/en/models/model-attributes.html)

# hibernate - 使用 Hibernate 在 JSF/PF 数据表中复制行

> ID：10802652
> 
> 赞同：2
> 
> 时间：2012-05-29T15:58:46.323
> 
> 标签：hibernate, jsf-2, primefaces

我在使用延迟加载的 PrimeFaces (3.2) 数据表时遇到问题，数据是使用 Hibernate (3.6) 从 MySQL 数据库加载的。

问题是我在数据表中得到了重复的结果。我对此做了很多研究，主要问题是使用“EAGER”-加载 OneToMany/ManyToOne/... 关系。我的实体有 5 个多对一和 1 个单对一关系。

结果是使用 DAO 加载的，应该返回 2 行。数据表按以下顺序显示 4 行：

1.  结果 1
2.  结果 2
3.  结果 1
4.  结果 2

count(*) 查询返回正确的行数 (2)。

直接使用当 hibernate 的“show_sql”开关设置为 true 时记录的 SQL 查询，它正确返回了 2 行。

虽然起初其中一些关系是预先加载的，但我将它们全部更改为延迟加载，但没有成功。我调试了正确返回 2 行的 DAO 方法。然后将数据加载到 primefaces 数据表中并在某处复制。

然后我使用另一个用户帐户尝试了相同的操作，发现没有重复的行。

然后我从数据库中删除了相关实体的所有记录，但没有成功。

我真的不知道这里可能有什么问题。我什至消除了所有的 ManyToOne/... 关系，并将外键直接映射为整数值，以避免任何连接并且没有任何改变。

我不知道代码的哪些部分可能对您有所帮助，但如果需要，我可以与您分享。

提前感谢您的帮助！

[编辑] 使用结果转换器并将实体映射到 Set 而不是 List 也无济于事，数据库因此休眠总是返回正确的行数，但在 DAO 和数据表。

[编辑 2] 经过更多调查，我意识到这只发生在分页的 pageSize 设置为 15 时（有 3 个可能的值可供选择：5、10 和 15）。

当设置为 10 时，一切都按预期工作。我真的不明白这有什么问题，因为具有不同实体的相同代码在另一个页面上工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-17T15:45:16.590

在我的情况下，如果我将列出的类的映射字段从 EAGER 更改为 LAZY，它就会起作用。更改 pageSize 没有区别（*编辑 2）。另外，我不得不添加到 web.xml

```
<filter>
    <filter-name>OpenSessionInViewFilter</filter-name>
    <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>
    <init-param>
        <param-name>singleSession</param-name>
        <param-value>false</param-value>
    </init-param>
</filter>
<filter-mapping>
    <filter-name>OpenSessionInViewFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

为了避免出现此错误 org.hibernate.LazyInitializationException...没有会话或会话已关闭

# javascript - 表内的Jquery依赖下拉列表

> ID：10802654
> 
> 赞同：0
> 
> 时间：2012-05-29T15:58:56.750
> 
> 标签：javascript, jquery, drop-down-menu

我有一张桌子。每个单元格内都有很多下拉列表。列数可能会有所不同。**并且每一行**的下拉列表内容都是相同的。我想要的是当我从一个下拉列表中选择一个值时，该值必须从**同一行的**所有其他下拉列表中删除。

这是我的桌子

```
<table>
    <tbody> 
        <tr class="row">
            <td>
                <select>
                    <option value="1">Option 1 of row 1</option>
                    <option value="2">Option 2 of row 1</option>
                    <option value="3">Option 3 of row 1</option>
                </select>               
            </td>

            <td>
                <select>
                    <option value="1">Option 1 of row 1</option>
                    <option value="2">Option 2 of row 1</option>
                    <option value="3">Option 3 of row 1</option>
                </select>               
            </td>

            .....
            .....
        <tr>
        <tr class="row">
            <td>
                <select>
                    <option value="a">Option a of row 2</option>
                    <option value="b">Option b of row 2</option>
                    <option value="c">Option c of row 2</option>
                </select>               
            </td>

            <td>
                <select>
                    <option value="a">Option a of row 2</option>
                    <option value="b">Option b of row 2</option>
                    <option value="c">Option c of row 2</option>
                </select>               
            </td>

            .....
            .....
        <tr>
    </tbody>   
</table> 
```

因此，当我选择“第 1 行的选项 1”时，必须从所有其他下拉列表中删除该选项。我如何使用 jquery 来实现这一点？

编辑：

如果用户第二次从已选择的下拉列表中选择另一个值，则应恢复先前替换的选项

编辑2：

我想出了如何使用 jquery id 选择器对一行执行此操作。我如何遍历所有行，即使用类选择器？下面是单行代码

```
$('#row_id td select').change(function(){

    var values = [];
    $('#row_id td select').each(function(){
        if(this.value.length > 0)
            values.push(this.value);
    });

    $('#row_id td select option').each(function(){   
        if($.inArray(this.value, values) > -1 && !this.selected)                
            $(this).attr("disabled","disabled");
        else
            $(this).removeAttr("disabled");
    });

});
 $('#row_id td select').change();//triggers initial change 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:17:04.667

干得好：

```
$('select').change(function() {
     $(this).closest('tr').find('select').not(this).find('option[value="'+ $(this).val() + '"]').remove();
});​ 
```

工作示例：http: [//jsfiddle.net/lucuma/7Mxzj/](http://jsfiddle.net/lucuma/7Mxzj/)

它根据 value 属性从其他行中删除选定的选项。我不确定考虑到可以继续选择和删除所有选项的功能如何，但它回答了您的问题。

**每个修改问题的更新答案**

更新每个问题的更新：现在根据所选项目显示和隐藏选项。 [http://jsfiddle.net/lucuma/7Mxzj/2/](http://jsfiddle.net/lucuma/7Mxzj/2/)

```
$('select').change(function() {
     $(this).closest('tr').find('select').find("option").show();
     $(this).closest('tr').find('select').not(this).find('option[value="'+ $(this).val() + '"]').hide();
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:48:10.263

得到答案。干得好

```
$('.row select').change(function(){

    var values = [];
    $(this).closest('tr').find('select').each(function(){
        if(this.value.length > 0)
            values.push(this.value);
    });

    $(this).closest('tr').find('select').find('option').each(function(){   
        if($.inArray(this.value, values) > -1 && !this.selected)                
            $(this).attr("disabled","disabled");
        else
            $(this).removeAttr("disabled");
    });

});
 $('.row select').change(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T16:18:41.283

有多种方法可以实现这一点，具体取决于您对动态网页开发的适应程度。首先，您应该为每个下拉列表提供不同的 id，以便您可以通过`$('#yourdropdownID')`或选择它们`document.getElementById(...)`。

在您的`<select>`身上，您将需要使用 onClick 或 onChange（取决于您希望它“外观”的方式），这将调用一个接受所选选项的函数。例如：`<select onClick='removeOption(this);'>`

你需要编写这个函数来做很多事情，假设你已经有了三个列表： 1\. 循环遍历你的三个列表。2\. 在此循环中，使用开关将接收到的值与其他两个选择的选项中的值进行比较。3\. 将这些值与从函数接收到的值进行比较，然后从选择中删除此选项。4\. 刷新当前选择下拉列表，让 JQuery 正确显示元素。

您可能需要对其进行几次测试以确保它运行顺利，JQuery 可能有点古怪，因此请确保在执行所有这些操作时进行调试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T16:14:07.510

您想要做的大部分事情之前已经在这个问题中介绍过：[Removing an item from a select box](https://stackoverflow.com/questions/375508/removing-an-item-from-a-select-box)

在您的情况下，您希望从表中单行内的选择框中删除选项。为了编写与这些选择匹配的 jQuery 选择器，您需要获取代表您的选择框的 jQuery 对象，并在调用`parent()`方法的结果上调用`parent()`方法。`parent()`在 select 上调用方法的结果是一个表格单元格，在表格单元格上调用`parent()`方法的结果是一个表格行。

给这只猫剥皮的方法不止一种，但以上内容应该可以帮助您入门。

# asp.net-mvc - 为什么 Request.Url 在其中包含查询字符串？

> ID：10802658
> 
> 赞同：0
> 
> 时间：2012-05-29T15:59:16.180
> 
> 标签：asp.net-mvc, asp.net-mvc-3, request

在我的一个页面上，我让用户根据他们从年龄下拉列表中选择的年龄来过滤内容。

这是我的代码。

```
$('#age').change(function () {
         var ageUrl = "@Request.Url?age=" + $(this).val();

         alert(ageUrl);
         window.location = ageUrl;
     }); 
```

这就是问题所在。我在应用程序页面上。

http://localhost:60627/apps

第一次，我选择一个年龄并被重定向，没问题。

http:// localhost:60627/apps?age=Middle_School

第二次，我再选一个。

http:// localhost:60627/apps?age=Middle_School?age=Preschool

在查询字符串中，年龄出现了两次。我尝试了 Request.Url 或 Request.RawUrl，总是包含查询字符串。我应该用什么来只获取没有查询字符串的页面 url。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T16:05:39.263

我以前没有真正使用过它，但它确实有效：

```
 Request.Url.GetLeftPart(UriPartial.Path) 
```

另一种选择是：

```
 String.Format("{0}://{1}{2}",Request.Url.Scheme, Request.Url.Authority, Request.Url.LocalPath) 
```

如果您知道您正在使用的控制器/操作（来自 ViewContext 的数据），您可以使用 @Url.Action 并指定重载以强制生成完整 url 的 http 模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:56:41.683

你为什么不尝试`Split`字符串方法？

```
Request.Url.ToString().Split('?')[0] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T17:11:25.503

为什么要自己构建 URL？让 MVC 为你做这件事：

```
@Url.Action("Action", "Controller", new { age = "Preschool" }) 
```

如果年龄不是路由的一部分，那么它将自动添加到查询字符串中：

```
http://localhost:12345/Controller/Action?age=Preschool 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T16:07:36.730

这不是 Request 的属性，但它可以为您提供解决方案。[https://stackoverflow.com/a/2541083/969829](https://stackoverflow.com/a/2541083/969829)

# html - Youtube电影没有加载

> ID：10802666
> 
> 赞同：2
> 
> 时间：2012-05-29T15:59:45.077
> 
> 标签：html, flash, youtube

为什么我的视频没有加载？我收到消息“电影未加载”。这是代码。

```
<div id="cel_2" class="youtube"><object width="600" height="600">
           <param name="movie" value="http://www.youtube.com/watch?v=yyy44xBlI44"></param>
           <param name="allowFullScreen" value="true"></param>
           <param name="wmode" value="transparent"></param>

           <param name="allowscriptaccess" value="always"></param>
           <embed
              src="http://www.youtube.com/watch?v=yyy44xBlI44"
              type="application/x-shockwave-flash"
              allowscriptaccess="always"
              allowfullscreen="true"
              wmode = "transparent"
              width="600"
              height="600">
           </embed>
        </object> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:06:41.263

您最好使用他们在共享选项下为您提供的 youtube 嵌入代码。

```
<iframe width="420" height="315" src="http://www.youtube.com/embed/yyy44xBlI44" frameborder="0" allowfullscreen></iframe> 
```

看看这是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:46:56.680

the `src` does not mean `swf` source but iframe source, your script will never work try using the given iframe, like the anwser of @Art Williams

# c# - 动态键入泛型类

> ID：10802668
> 
> 赞同：1
> 
> 时间：2012-05-29T15:59:51.787
> 
> 标签：c#, asp.net-mvc

我有一个由 WebAPI 自动序列化的对象，但我想包装它以为我的数据提供上下文。一个例子是：

```
public class SecureModel<T>
{
  public string Info { get; set; }
  public T Data { get; set; }
} 
```

这对我的 JSON 请求进行序列化/反序列化没有问题，一切都很好。但是，我想在允许请求完成执行之前验证其中的一些信息，所以我添加了一个 ActionFilter 来检索我的 POST 的参数。

```
public class MyAuth : System.Web.Http.Filters.ActionFilterAttribute
{
  public override void OnActionExecuting(HttpActionContext actionContext)
  {
    var arg = actionContext.ActionArguments.FirstOrDefault().Value;
    // arg: get the Info?
    // if the info isn't correct, return a specific Response.
  }
} 
```

当我检查参数时，这正是我所需要的，但是我无法弄清楚如何在不指定*实际*泛型类型的情况下将其弱类型化到 SecureModel。我觉得我应该能够将此案例应用于 SecureModel<object> 并正确访问根目录，但它不允许这样做。到目前为止，我只能使用以下方式获取我需要的数据：

```
var notStrongEnough = arg.GetType().GetProperty("Info"); 
```

但是，我不想为此使用反射，而且我很难在没有答案的情况下前进。在这种情况下，我的替代方法是将数据更改为字符串并手动序列化/反序列化 JSON 对象，但这违背了在 MVC3 上使用 Web API 的某些目的。

**注意：** 将设计更改为以 SecureModel 作为基类会给我在数据上执行的一些散列增加挑战，所以我也不想走这条路。

谢谢！

**编辑：**错误的标题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:42:02.300

C# 中此类问题的典型解决方案是创建泛型类型实现的非泛型接口。例如，与您的班级：

```
public class SecureModel<T>
{
    public string Info { get; set; }
    public T Data { get; set; }
} 
```

您可以定义一个接口，`ISecureModel`：

```
public interface ISecureModel 
{
    string Info { get; }
    object Data { get; }
} 
```

现在你可以在你的数据类中实现它：

```
public class SecureModel<T> : ISecureModel
{
    public string Info { get; set; }
    public T Data { get; set; }

    object ISecureModel.Data {
        get { return Data; }
    }
} 
```

我们在这里使用显式接口实现，因为非泛型 ( `object`) 和泛型 ( `T`) 版本的属性`Data`会发生冲突。

现在，要获取信息，您可以简单地转换为`ISecureModel`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:41:48.453

我个人会选择创建单独的无类型接口并实现它：

```
interface IObjectTypeSercureModel
{
    object GetData();
    string GetInfo();
} 
```

但是，如果您可以将 getter 和 setter 拆分为单独的接口，则可以使用 C# 模板[协](http://msdn.microsoft.com/en-us/library/dd799517.aspx)变特性：

```
public interface IReadModel<out T>
{
    T Data {get;}
    string Info { get; }
}
public interface IWriteModel<in T>
{
    T Data { set; }
    string Info { set; }
}
public class SecureModel<T> : IReadModel<T>, IWriteModel<T>
{
    public string Info { get; set; }
    public T Data { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        var m = new SecureModel<string>();
        m.Data = "test";

        IReadModel<object> genericRead = (IReadModel<object>)m;
        Console.WriteLine(genericRead.Data);
    }
} 
```

# forms - 多维数组作业

> ID：10802669
> 
> 赞同：1
> 
> 时间：2012-05-29T15:59:52.160
> 
> 标签：forms, function, vba, multidimensional-array

我有一个名为 txtBox1 的文本框、一个名为 txtbox2 的第二个文本框、一个标签和一个按钮。我需要创建一个函数

1.  接受 2 个整数参数并返回一个字符串。
2.  根据传入这些参数的整数创建一个二维数组。第一个整数参数将代表 txtbox1，第二个整数参数将代表 txtbox2。
3.  使用嵌套的 for 循环以从 1 开始的递增值填充数组元素
4.  作为循环结构的一部分，跟踪字符串变量中的所有元素值并用逗号分隔它们。例如，如果用户在 txtbox1 中输入 3，在 txtbox2 中输入 5 并单击按钮，我们将得到一个如下所示的数组：

    ```
    :Length=15
    (0,0): 1    
    (0,1): 2
    (0,2): 3
    (0,3): 4
    (0,4): 5
    (1,0): 6
    (1,1): 7
    (1,2): 8
    (1,3): 9
    (1,4): 10 
    (2,0): 11
    (2,1): 12
    (2,2): 13
    (2,3): 14
    (2,4): 15 
    ```

    元素中填充的值将是 1,2,3,4,5,6,7,8,9,10,11,12,13,14 和 15。

5.  传回的字符串格式为“数组为 3 x 5，数组元素中的值为 1,2,3,4,5,6,7,8,9,10,11,12,13,14 ,15”。
6.  使用此字符串值填充标签。

这是我到目前为止...

```
Shared Function myArray(int1 As Integer, int2 As Integer) As String

    Dim Array(int1 - 1, int2 - 1) As Integer
    Dim i As Integer
    Dim j As Integer
    Dim counter As Integer = 1

    For i = 0 To int1 - 1
        For j = 0 To int2 - 1
            Array(i, j) = counter
            counter += 1
        Next
    Next

    Return Array(i, j)

End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:49:48.817

Ok, so you almost had it. I am assuming you are stuck on only #4\. And please excuse me if I type the incorrect syntax, I have not done VB in a LONG time and I am doing this from memory.

let's take a look at what you had:

```
For i as integer = 0 To int1 - 1
    For j as integer = 0 To int2 - 1
        Array(i, j) = counter
        counter += 1 
```

Here you are using `counter` to populate the array with incremental values. You can just use this variable in another string variable, and just add commas between them:

first: add a string variable to the top:

```
Dim Array(int1 - 1, int2 - 1) As Integer
Dim i As Integer
Dim j As Integer
Dim counter As Integer = 1
Dim output as String = nothing 
```

Then, use that variable in your loop:

```
For i = 0 To int1 - 1
    For j = 0 To int2 - 1
        Array(i, j) = counter
        output += "" & counter & ", "
        counter += 1
    Next
Next 
```

last, change your `return` to send `output` instead of an element in your array

```
return output 
```

If you want to format the string so that the last ", " is not shown, look at the [Strings.Left](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.strings.left.aspx) function. It would go something like this:

```
output = Left(output, Len(output) - 2) 'I am not sure if this is a 2 or 3, run and test 
```

Ok, hope that helps. Feel free to ask for clarification or something.

# android - 加载位图并创建一个缩放的旋转图像

> ID：10802677
> 
> 赞同：0
> 
> 时间：2012-05-29T16:00:10.507
> 
> 标签：android, bitmap

我的问题是，当我从文件中加载图像作为位图并创建按比例缩小的缩略图时，图像总是水平而不是保持纵向或横向。

如何解决这个问题？

谢谢

# msmq - MassTransit MSMQ Pub 与多子。RuntimeServices 什么时候准备好？

> ID：10802678
> 
> 赞同：3
> 
> 时间：2012-05-29T16:00:13.873
> 
> 标签：msmq, publish-subscribe, masstransit

我设置了一个简单的测试，包括一个发布者和两个订阅者，所有订阅者都在使用 MSMQ 和 MassTransit (2.1.1) RuntimeServices 的单台机器上运行，后者使用本地 Sql Server 数据库。

我在下面包含了总线设置代码，因此您可以查看设置的内容。我正在手动和独立地启动每个组件，以尝试锻炼如果订阅者没有运行会发生什么。

我首先运行了两个订阅者，因此队列和订阅都已设置好，然后将它们都退出，而无需取消订阅消息。如果然后我自己运行发布者，它会尽可能快地在队列中转储 400 条消息，我可以看到两个订阅者队列有不同数量的消息等待。

我的假设是我在 RuntimeServices 能够自行设置两个目标队列之前发布。在总线设置和发布之间有 5 秒的延迟，我得到了我期望的 400 条消息在两个订阅者队列中等待，即一些消息没有发布到两个队列。

我的问题是这个；当发布者启动时，有没有办法判断 RuntimeServices 是否已准备好其数据库中已有的订阅者？

这是发布者代码

```
Bus.Initialize(sbc =>
        {
            sbc.SetCreateTransactionalQueues(true);
            sbc.ReceiveFrom("msmq://localhost/andy_publisher");
            sbc.UseSubscriptionService("msmq://localhost/mt_subscriptions");
            sbc.UseMsmq();
            sbc.VerifyMsmqConfiguration();
        });

        var bus = Bus.Instance;

        Thread.Sleep(5000); // this makes it all work :)

        int i = 0;
        foreach (string filename in System.IO.Directory.EnumerateFiles(@"C:\Users\andy.baker\Pictures\", "*.*", SearchOption.AllDirectories))
        {
            Console.WriteLine(filename);
            bus.Publish(new Messages.FileRegistered {FilePath = filename});
            i++;
        }

        Console.WriteLine("Published {0} messages", i);
        Console.ReadLine(); 
```

订阅者是这样配置的；

```
Bus.Initialize(sbc => {
                     sbc.UseMsmq();
                     sbc.VerifyMsmqConfiguration();
                     sbc.ReceiveFrom("msmq://localhost/andy_subscriber1");
                              sbc.UseSubscriptionService("msmq://localhost/mt_subscriptions");
                           }
            ); 
```

...和第二个订阅者...

```
Bus.Initialize(sbc =>
        {
            sbc.UseMsmq();
            sbc.VerifyMsmqConfiguration();
            sbc.ReceiveFrom("msmq://localhost/andy_subscriber2");
            sbc.UseSubscriptionService("msmq://localhost/mt_subscriptions");
        } 
```

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T18:03:51.347

您如何订阅您的消费者？为了在重启后存活，它们应该是永久性的。 [http://docs.masstransit-project.com/en/latest/configuration/sub_config_api.html](http://docs.masstransit-project.com/en/latest/configuration/sub_config_api.html)

```
s.Consumer<TConsumer>().Permanent(); 
```

# python - Django - 从生产中访问请求 META 数据

> ID：10802680
> 
> 赞同：1
> 
> 时间：2012-05-29T16:00:27.793
> 
> 标签：python, django, httprequest, production-environment

我正在尝试通过格式设置为其区域设置的 JSON 向客户端发送日期时间列表。

所以主要问题实际上是试图获取客户端的语言环境。

我尝试使用`request.META['LC_TIME']`（这似乎是客户首选的日期和时间语言环境）

此密钥在开发中，但不在生产中。

> 键错误：'LC_TIME'

怎么解释？我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T13:07:36.067

首先，让我们确定您在“生产环境”下的意思。在 DEV 环境下，浏览器直接连接到 Django Web 服务器，所有的 HTTP 头都直接发送给它。在 PRODUCTION 中，您通常有一个代理。这可能是 nginx 或其他类似软件。它们的主要目的是重定向，同时执行一些检查。您应该检查您的 PRODUCTION 环境，代理的实际设置是什么（如果有），以及它是否剥离了从客户端发送的任何 HTTP 标头（这似乎是您得到错误的正当原因）。

除了配置问题，建议使用默认值：

```
user_lc_time = request.META.get('LC_TIME', default_lc_time) 
```

# html - 如何在 plupload 的 HTML5 运行时过滤文件类型？

> ID：10802681
> 
> 赞同：3
> 
> 时间：2012-05-29T16:00:32.570
> 
> 标签：html, firefox, google-chrome, file-upload, plupload

我正在将 plupload 与我的 ASP.NET MVC3 应用程序集成，具有以下设置：

```
var uploaderSettings = {
    runtimes: "html5,silverlight,flash,html4",
    browse_button: "browse-button",
    container: "upload-ui",
    drop_element: "drag-drop-area",
    file_data_name: "file",
    multiple_queues: true,
    max_file_size: "10mb",
    url: '@Url.Action("Index", "Upload")',
    flash_swf_url: '@Url.Content("~/js/plupload/plupload.flash.swf")',
    silverlight_xap_url: '@Url.Content("~/js/plupload.silverlight.xap")',
    filters: [
        {title: "Excel Files", extensions: "xls,xslx,csv"}
    ],
    multipart: true,
    urlstream_upload: true,
    dragdrop: true,
    multipart_params: {
        token: "@AuthToken()"
    }
}; 
```

从哪个 plupload 生成属性`<input type="file">`中包含以下项目的`accept`（逗号分隔）：

*   `application/vnd.ms-excel`
*   `application/vnd.openxmlformats-officedocument.spreadsheetml.sheet`
*   `text/csv`

在 Firefox 12.0 中，它忽略过滤器并允许选择任何文件类型。

在 Chrome 21 中，它不适用于提到的文件扩展名，但如果我将过滤器更改为图像文件（jpg、png、gif），它会正确过滤“选择文件”对话框。

我在 Chromium 错误跟踪器上发现[了这个问题](http://code.google.com/p/chromium/issues/detail?id=54009)，这似乎是相关的，但在 2010 年 10 月被标记为已修复。

如果我将运行时优先级切换为 silverlight 或 flash 高于 html5，它可以正常工作，但我宁愿不这样做，因为我失去了拖放文件上传功能。

这仅仅是浏览器对accept属性的支持限制，我做错了什么，还是plupload中的一个错误？

**更新：**这似乎是一个[已知问题](https://github.com/moxiecode/plupload/issues/526)，归结为浏览器对 mime 类型过滤的支持。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T08:14:02.840

听起来这不是验证文件类型的好方法。

[输入文件中的接受属性不起作用](https://stackoverflow.com/questions/2505334/accept-attribute-in-input-file-is-not-working)

它仅用于提示操作系统过滤对话框中的文件类型。

当我使用 PL Upload 进行此操作时，我是基于扩展服务器端进行的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-19T13:56:42.373

```
filters: {
             max_file_size: '100mb',
             prevent_duplicates: true,
             **mime_types:** [title : "Image files", extensions : "jpg,jpeg,gif,png"]
         } 
```

# mysql - 根据列枚举值创建 SQL 语句

> ID：10802685
> 
> 赞同：0
> 
> 时间：2012-05-29T16:00:52.320
> 
> 标签：mysql, sql, database-design, architecture, enums

假设我有一个名为 normalize 的表，其中有一个名为 type 的枚举列

根据行（假设类型是 a、b 或 c），我想根据类型进行 LEFT JOIN。

因此，如果 type = a，则 LEFT JOIN ON 表 a .. 如果 type = B，LEFT JOIN ON 表 b ...等

这可以有效地完成吗？还是应该在应用层完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:25:26.753

是的，您应该能够执行以下操作：

```
SELECT *
FROM parent
    LEFT JOIN a ON (type = 'a' AND parent.id = a.id)
    LEFT JOIN b ON (type = 'b' AND parent.id = b.id)
    LEFT JOIN c ON (type = 'c' AND parent.id = c.id) 
```

您可能需要也可能不需要索引`type`，具体取决于实际数据和您的 DBMS 的智能程度（利用应该存在于 PK 下的索引）。无论如何，**测量**真实的数据量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:08:42.440

一种常见的方法是将类型存储为 1:1 关系。在这种方法中，没有类型枚举列。ID 出现在 1:1 扩展表中的事实表明了它的类型。

```
select  *
from    BaseTable b
left join
        Type1Table t1
on      t1.Id = b.Id
left join
        Type1Table t2
on      t2.Id = b.Id 
```

因此，具有in`b`和in`t1`条目的实体必须是类型 1。具有 in`b`和 in条目的实体`t2`属于类型 2。这样，信息只存储一次，并且表会显示“类型 1”但不一致没有匹配的行`t1`是不可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T16:19:40.267

问题是，即使您使用`SELECT table1.* FROM table1 LEFT OUTER JOIN table2`，引擎也会评估连接，即使您甚至不需要显示它们。

所以，在我看来，有两种选择：

*   第一：假设连接是有效的，使用正确的索引和可接受的 I/O，并使用以下查询：

** 见下文，在它的错误列表中 **

*   假设进行 n 次连接，n 是不同类型的数量（如果每种类型都有一个表），会产生很多开销，然后在应用层进行 2 个查询：第一个获取类型，然后另一个在 switch例如，case 语句从正确的表中检索数据。

解释计划也可以让你很好地了解你在做什么

询问：

```
SELECT
    IF(t.type = a, ta.value,
        IF(type = b, tb.value, IF(type = c, tc.value, td.value))
    )
FROM 
    table t
        LEFT JOIN type_a_table ta ON t.type = a AND ...
        LEFT JOIN type_a_table tb ON t.type = b AND ...
        LEFT JOIN type_a_table tc ON t.type = c AND ...
        LEFT JOIN type_a_table td ON t.type = d AND ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T16:20:12.780

不确定这是否有帮助，但我可能会使用联合来执行您正在寻找的内容

```
select * 
from BaseTable b left join TypeTableA a on b.id = a.id
union
select * 
from BaseTable b left join TypeTableB b on b.id = b.id 
```

# sharepoint - 在哪里可以找到 Sharepoint 2010 查询字符串参数的列表？

> ID：10802688
> 
> 赞同：1
> 
> 时间：2012-05-29T16:01:07.983
> 
> 标签：sharepoint, sharepoint-2010, query-string

毫无疑问，这个答案会引起很多 lmgtfy 响应——但我似乎真的找不到可用的 Sharepoint 2010 查询字符串参数列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T18:23:48.853

您可以在此处找到其中一些参数的列表：

[不应在 SharePoint 应用程序中使用的查询字符串参数](http://blogs.technet.com/b/stefan_gossner/archive/2009/01/30/querystring-parameters-you-should-not-use-in-your-sharepoint-application.aspx)

这篇文章是关于您应该避免为自己的参数使用的名称，但同时它为您提供了有关 SharePoint 使用的名称的信息 :)。

# c# - Facebook api 权限

> ID：10802692
> 
> 赞同：0
> 
> 时间：2012-05-29T16:01:15.637
> 
> 标签：c#, facebook, facebook-c#-sdk

对于几个网站，我有一个与当前 JS 库的 facebook 集成。登录按预期工作。

我将 Facebook C# api 与 JS 库 (v6) 一起使用。当 Facebook 用户通过 JS 调用成功通过身份验证时，它将向 C# 方法发送 ajax 调用：

```
FacebookClient facebookClient = new FacebookClient(accessToken);

var fbResult = facebookClient.Get("me");
if (fbResult.GetType().ToString() != "Facebook.JsonObject")
     return null;

IDictionary<String, Object> result = (IDictionary<String, Object>)fbResult;

if (result.ContainsKey("email"))
    email = (String)result["email"];
            else
throw new Exception("E-mail key not found") 
```

现在这工作正常，accessToken 被传递，c# 库使用它来获取用户的信息。

但是对于大约 100 个用户中的 1 个来说，抛出了异常！由于某种原因，电子邮件密钥未包含在“api”中。

在developers.facebook.com 上，我已在“Auth Dialog”中将我的应用程序设置为“Authenticated Referrals”：电子邮件和user_birthday。

但这怎么可能？我忽略了什么吗？用户如何在没有正确权限的情况下登录我的应用程序？

# vim - 如何在窗口中显示自定义标签列表，如：tag 或：ptag

> ID：10802694
> 
> 赞同：1
> 
> 时间：2012-05-29T16:01:18.457
> 
> 标签：vim, tags, taglist

我使用 taglist() 来获取标签列表。然后我做了一些过滤，只留下一些像这样有用的：

```
let tttlist = taglist("^List$")
"echo ttt
let newtttlist = []
for item in tttlist
   if item['kind'] == 'i' || item['kind'] == 'c'
       call add(newtttlist, item)
   endif
endfor
echo newtttlist 
```

但是如何在 vim 中像 :tag 和 :ptag 一样显示它们呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T17:31:49.710

我看不到使用您提到的其中一个命令来显示 tag***的***方法，因此解决方案是在列表中的第一项上`:execute`与`:ptag`/一起使用：`:tag`

```
execute 'ptag' fnameescape(get(newtttlist, 0, '')) 
```

. 此外，您无需在找到其中一个标签后处理标签列表：

```
let tttlist = taglist("^List$")
for item in tttlist
   if item.kind == 'i' || item.kind == 'c'
       execute 'ptag' fnameescape(item.name)
   endif
endfor 
```

. 如果您的意思是别的，请在此处发布您将如何制作`:ptag`/`:tag`显示标签列表：根据文档和观察到的行为，他们所做的只是跳转到第一个匹配项。

另请注意：如果字典的键仅包含拉丁字母、数字和下划线，那么您可以访问它`dict.key`而不是`dict['key']`. 当字典用于传递结构化数据时，它几乎总是正确的。

# jquery - 替换html元素字符串中的文本

> ID：10802700
> 
> 赞同：0
> 
> 时间：2012-05-29T16:01:36.373
> 
> 标签：jquery, html, string, dom, object

我有一个`.content`带有 HTML 表的 div 作为 JavaScript 字符串。在`.content`元素中，有一个 td`.quantity`我需要更新字符串。

我刚试过这个：

```
var content = $('.content').html();
content = $(content).parent().children('.quantity').text("6"); // []
content = $(content).parent().children('.quantity').text("6").html(); // null 
```

我只想输出带有更新值的字符串，有点像基于 DOM 的搜索和替换，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:04:09.840

> 在 .content 元素中，有一个 td .quantity 我需要更新字符串。

尝试`find()`方法：

```
var content = $('.content').html();
$(content).find('.quantity').text("6"); 
```

您也可以直接访问它：

```
$('.content').find('.quantity').text("6"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:37:39.607

你可以试试

```
var content = $('.content table');
$('.quantity', content).text('6').end(); // will return `table` 
```

**[演示](http://jsfiddle.net/thecodeparadox/uNQf9/2/)**

你可以试试这个来获取字符串

```
$('.quantity', content).text('6').end().parent().html(); 
```

[**演示**](http://jsfiddle.net/thecodeparadox/MYcCS/)

# javascript - Raphael.js - 具有原始宽度和高度大小的图像？

> ID：10802702
> 
> 赞同：14
> 
> 时间：2012-05-29T16:01:51.070
> 
> 标签：javascript, raphael

嗨 RaphaelJS 用户 =) ,

我可能有一个愚蠢的问题，但我似乎找不到答案，问题是，我正在尝试使用 Raphael 加载/创建图像，这很好，就像这样：

```
var image_1 = paper.image('/img/img1.jpg', 0, 0, 100, 100); 
```

但是正如您所看到的，您似乎总是必须给出“宽度”和“高度”属性，我已经检查了文档，但它总是很短而且不是很详细，我尝试给出空参数或空参数，但是它不起作用...

所以我想知道拉斐尔是否真的有直接的方法可以做到这一点，或者....**我之前是否必须始终获得这些值？？？**

我的意思是，像这样的东西？：

```
var imgURL = "../img/img1.jpg"

var myImg = new Image();
myImg.src = imgURL;

var width = myImg.width;
var height = myImg.height;

   //create the image with the obtained width and height:
    var image_1 = paper.image('/img/img1.jpg', 0, 0, width, height); 
```

这样我就可以加载图像的原始大小，这有点解决了我的问题，但是……Raphael内部没有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-22T01:18:21.843

现在......我想我必须用我自己的答案来回答我自己的问题，因为我似乎没有找到其他方法或者有人告诉我=P

```
var imgURL = "../img/img1.jpg"

var myImg = new Image();
myImg.src = imgURL;

var width = myImg.width;
var height = myImg.height;

   //create the image with the obtained width and height:
    var image_1 = paper.image('/img/img1.jpg', 0, 0, width, height); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-14T00:11:28.167

基于@drzaus 的出色答案，我遇到了一些问题，如果我加载到 Raphael 中的图像尚未在缓存中，则高度和宽度将设置为 0。要解决此问题：

```
(function(Raphael){
/// Plugin - replaces original RaphaelJS .image constructor
/// with one that respects original dimensions.
/// Optional overrides for each dimension.
/// @drzaus @zaus
/// based on http://stackoverflow.com/questions/10802702/raphael-js-image-with-its-original-width-and-height-size
/// modified 13/08/2013 by @Huniku to support asynchronous loads

var originalRaphaelImageFn = Raphael.fn.image;

Raphael.fn.imageAsync = function(url, x, y, w, h) {
    var dfd = new jQuery.Deferred();
    var done = false;
    var paper = this;
    // fix the image dimensions to match original scale unless otherwise provided
    if( !w || !h ) {
        //Create the new image and set the onload event to call
        //the original paper.image function with the desired dimensions
        var img = new Image();
        img.onload = function() {
            if(done)
                return;
            if( !w ) w = img.width;
            if( !h ) h = img.height;
            dfd.resolve(originalRaphaelImageFn.call(paper, url, x, y, w, h));
        };
        //Begin loading of the image
        img.src = url;

        //If the images is already loaded (i.e. it was in the local cache)
        //img.onload will not fire, so call paper.image here.
        //Set done to ensure img.onload does not fire.
        if(img.width != 0) {
            if( !w ) w = img.width;
            if( !h ) h = img.height;
            done = true;
            dfd.resolve(originalRaphaelImageFn.call(paper, url, x, y, w, h));
        }
    }
    else
        dfd.resolve(originalRaphaelImageFn.call(paper, url, x, y, w, h));
    return dfd.promise();
};
})(Raphael); 
```

这允许图像在查询宽度/高度之前加载，并且还支持图像已经在缓存中并且未触发 onload 事件的实例。要使用它，只需：

```
var dfd = paper.imageAsync("images/hello.png",0,0,false,false);
dfd.done(function( result ) {  //result is a Raphael element
    console.log('done');
    //do something with result
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-12T15:42:05.663

有同样的问题，谢谢你的提示——这是一个用尊重尺寸的插件替换现有图像功能的插件：http: [//jsfiddle.net/drzaus/dhkh7/](http://jsfiddle.net/drzaus/dhkh7/)

为了更安全，可能不应该覆盖原始图像函数，以防万一它发生变化，但你明白了。

```
;(function(Raphael){
/// Plugin - replaces original RaphaelJS .image constructor
/// with one that respects original dimensions.
/// Optional overrides for each dimension.
/// @drzaus @zaus
/// based on http://stackoverflow.com/questions/10802702/raphael-js-image-with-its-original-width-and-height-size

var originalRaphaelImageFn = Raphael.fn.image;
Raphael.fn.image = function(url, x, y, w, h) {
    // fix the image dimensions to match original scale unless otherwise provided
    if( !w || !h ) {
        var img = new Image();
        img.src = url;
        if( !w ) w = img.width;
        if( !h ) h = img.height;
    }
    return originalRaphaelImageFn.call(this, url, x, y, w, h);
};
})(Raphael); 
```

和用法：

```
window.onload = function() {
  var paper = new Raphael('canvas', '100%', '100%');

  // specify dimensions as before
  paper.image('http://www.stockfreeimages.com/Swiss-panorama-thumb6499792.jpg', 10, 10, 100, 50).attr('stroke', '#000');

  // original ratio
  paper.image('http://www.stockfreeimages.com/Swiss-panorama-thumb6499792.jpg', 10, 100).attr('stroke', '#f00');

  // specify width, height taken from original
  paper.image('http://www.stockfreeimages.com/Swiss-panorama-thumb6499792.jpg', 10, 200, 100).attr('stroke', '#0f0');

  // specify height, width taken from original
  paper.image('http://www.stockfreeimages.com/Swiss-panorama-thumb6499792.jpg', 10, 300, false, 100).attr('stroke', '#00f');
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-18T09:49:49.870

爱德华的评论对我有用，但我必须将它放在一个区间函数中，并等到定义宽度和高度后再添加图像（否则我得到一个 0x0 图像）。这是我使用的代码：

```
var imgURL = "/img/img1.jpg"
var myImg = new Image();
myImg.src = imgURL;

function loadImagAfterWidthAndHeightAreDefined(){
  width = myImg.width;
  height = myImg.height;

  if(myImg.width > 0 && myImg.height > 0){
    image_1 = paper.image(imgURL, 0, 0, width, height);
  }
  else{
    setTimeout(function(){
      loadImagAfterWidthAndHeightAreDefined();
    },250);
  }
}
loadImagAfterWidthAndHeightAreDefined() 
```

# c# - 连续播放提示 XNA

> ID：10802704
> 
> 赞同：1
> 
> 时间：2012-05-29T16:01:57.420
> 
> 标签：c#, xna

当我播放提示时，`cue.Play()`只有一种声音正在播放。如何一个接一个地播放提示中的所有声音？

先谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:17:46.243

[在我看来，App Hub 上的这篇](http://forums.create.msdn.com/forums/p/95150/568941.aspx)文章就是您正在寻找的答案。

> 不必尝试将多个声音添加到一个 Cue，您必须将多个波形文件添加到一个声音的一个音轨，然后将该一个声音添加到它自己的 Cue。

希望这可以帮助！

# asp.net - asp.net 会话在两个单独的 Firefox 实例之间共享 (12)

> ID：10802712
> 
> 赞同：1
> 
> 时间：2012-05-29T16:02:19.480
> 
> 标签：asp.net, session

一旦用户登录（Session [“loginuser”]）并使用Response.Redirect重定向到另一个页面，我就会设置一个会话变量。我正在两个单独的 Firefox 浏览器实例中对此进行测试。使用了两个不同的登录名。登录工作正常，但登录后如果我点击浏览器窗口 1 上的任何链接并点击浏览器窗口 2 上的任何其他链接，窗口 2 显示窗口 1 的用户名！

不知道是什么问题..有人可以帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:36:56.417

会话使用 cookie 保存在每个浏览器的基础上。这意味着当您在同一台计算机上使用相同的浏览器时，它们将被共享。这可能是也可能不是问题，因为它不会影响用户，除非必须能够在同一台计算机上登录多个帐户。

这篇文章将告诉您如何打开无 cookie 会话来解决您的问题：http: [//msdn.microsoft.com/en-us/library/ms972429.aspx](http://msdn.microsoft.com/en-us/library/ms972429.aspx)

您应该做的是转到您的 web.config 并找到如下所示的行并将 cookieless 更改为 true。

```
<configuration>
  <sessionstate 
  mode="inproc"
  cookieless="true" 
  timeout="20" 
  sqlconnectionstring="data source=127.0.0.1;user id=<user id>;password=<password>"
  server="127.0.0.1" 
  port="42424" 
 /> 
```

# .htaccess - mod_rewrite，规则重叠

> ID：10802715
> 
> 赞同：0
> 
> 时间：2012-05-29T16:02:37.750
> 
> 标签：.htaccess, mod-rewrite, overlapping, internal-server-error

我想这样当我输入[http://website.com/5/sometitle](http://website.com/5/sometitle)时它会打开 /displayvideo.php?id=5&title=sometitle，这目前适用于以下代码

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)/(.*)$ /displayvideo.php?id=$1&title=$2 [L] 
```

但是我也想这样当我去[http://website.com/5](http://website.com/5)时它会去 /displayvideo.php?id=5 我已经尝试通过添加

```
RewriteRule ^(.*)$ /displayvideo.php?id=$1 [L] 
```

但是，这最终会导致一堆奇怪的废话，例如无法打开实际文件，例如 /somefile.php，因为它会认为 somefile.php 应该是 rewriterule 的 id 标签

这样做也会导致其他重写规则变得无效，因为它会自动认为 /displayvideo.php?id=$1 是新规则的标记。

基本上网站上的每个页面都会变成 500 内部服务器错误

任何人都知道如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:11:05.943

这应该这样做。

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([0-9]+)/(.+)$ /displayvideo.php?id=$1&title=$2 [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([0-9]+)$ /displayvideo.php?id=$1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:10:34.563

优化您的正则表达式：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f

RewriteRule ^([0-9]+)$ /displayvideo.php?id=$1 [L]
RewriteRule ^([0-9]+)/(.*)$ /displayvideo.php?id=$1&title=$2 [L] 
```

# javascript - node.processTemplate ftl 可以使用 include 命令吗？

> ID：10802718
> 
> 赞同：0
> 
> 时间：2012-05-29T16:02:41.133
> 
> 标签：javascript, freemarker, alfresco

我正在尝试在使用Javascript API 的方法 proccessTemplate ( [http://wiki.alfresco.com/wiki/4.0_JavaScript_API#Transformation_API](http://wiki.alfresco.com/wiki/4.0_JavaScript_API#Transformation_API) )处理的 freemarker 模板中使用一个简单的**<#include "anotherFile.ftl"/>**针对特定节点。

它似乎不喜欢包含？！

错误信息如下

> 包装异常（带状态模板）：04305890 无法执行脚本“classpath *：alfresco/extension/templates/webscripts/myPath/myWebscript.get.js”：04305889 处理模板时出错“读取包含的文件字符串时出错：// fooy/foo.ftl'。请联系您的系统管理员。

正在处理的模板和可能包含的模板将存储在 Alfresco 的存储库之外，但现在它在里面。webscripts 也将在存储库之外和 Java 类路径内。

我试图包含 ftl，即使它在同一个目录中，但这不起作用。我试图获得一个 node.nodeRef （成功），但实际的包含不起作用，尽管这意味着将 ftl 存储在存储库中，我们无论如何都不会这样做。

我确实尝试在实际的 webscripts freemarker 本身上包含 ftl，但当然 node.processTemplate 在传递给 webscript freemarker 模板之前发生在 javascript 控制器中

我什至尝试对包含的内容进行硬编码并将其传递到 args 关联数组中，但正如预期的那样，它不起作用。

进一步调查表明这是一个错误 [https://issues.alfresco.com/jira/browse/ALFCOM-3364](https://issues.alfresco.com/jira/browse/ALFCOM-3364)

如果有人克服了这个问题，欢迎提出任何其他建议。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T08:35:34.533

如果它是一个网页脚本，那么我猜你的路径不正确。

例如：我有一个 webscript foo。它将出现在`alfresco/extension/templates/webscripts/org/test/` 所以我将拥有 foo.get.desc.xml、foo.get.js 和 foo.get.html.ftl。

我在 alfresco/extension/templates/webscripts/org/common/common.ftl 中有一个通用的 freemarker 模板

然后我需要将`<#include "/org/common/common.ftl" />`foo.get.html.ftl freemarker 放入。

所以你需要设置路径`alfresco/extension/templates/webscripts`

# backbone.js - 主干.js 引导嵌套资源

> ID：10802719
> 
> 赞同：1
> 
> 时间：2012-05-29T16:02:43.680
> 
> 标签：backbone.js, browser-history, nested-resources, bootstrapping

如果用户已添加书签或共享以下 URL，我的单页骨干.js 应用程序（使用 Backbone.Router）应如何检索所需数据以呈现完整视图？

[http://mydomain.example.com/menus#/menus/99/items/33/ingredients](http://mydomain.example.com/menus#/menus/99/items/33/ingredients)

[如果用户为http://mydomain.example.com/menus](http://mydomain.example.com/menus)添加了书签，我可以轻松地引导第一页菜单。

```
# Inline before </body>, in a <script> block
Menus.reset(<%= @menus.to_json %>); 
```

但是在我上面提到的情况下，需要 3 层引导，但由于这是#hashtag 导航，服务器不知道引导菜单、:menu_id 的菜单、项目、:item_id 的项目和第一页的成分。

```
# It would look like the following on a real page
# http://mydomain.example.com/menus/99/items/33/ingredients
# please see past the invalid syntax
Menus.reset(<%= @menus.to_json %>);
var menu = Menus.get(99);
menu.items.reset(<%= @menus.find(99).items.find(:all).to_json %>);
var item = Menus.items.get(33);
item.ingredients.reset(<%= @menus.find(99).items.find(33).ingredients.find(:all).to_json %>); 
```

是否有其他人用来完成此任务的模式？你能理解这个吗？

我强烈希望创建一个引导控制器，其唯一目的是获取绘制任何页面所需的所有模型和集合。/bootstrap?path=/menus/99/items/33/ingredients 然后让它返回一些 jsonp 到调用者页面[http://mydomain.example.com/menus#/menus/99/items/33/ingredients](http://mydomain.example.com/menus#/menus/99/items/33/ingredients)。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T11:29:22.223

如果我正确理解了您的问题，那么您的应用程序中间的深层链接会遇到无法合理构建视图的问题，因为未加载数据。

我认为在这里您需要意识到路线和视图之间不需要存在 1:1 的对应关系。

因此，当您的路由器检测到这种情况时，它可以显示一个通用的“加载”视图，开始获取数据，然后当数据到达时，显示预期的视图。

（这个机制也可以被链接起来——例如你可能想显示一个登录视图，然后是加载视图，然后是最终视图）。

所以我可能有一个像这样的实用函数：

```
awaitFoos = function (foos, callback) {
  var loadingView = new CommonLoadingView();

  if (foos.isFetched) {
    callback();
  } else {
    this.showPageView(loadingView);

    foos.fetch({success: callback});
  }
}; 
```

然后在路由器中，我将使用这个：

```
goFooView: function (fooid) {
  var self = this;

  this.appView.awaitFoos(function () {
    var model = self.getFoo(fooid),
        view = new FooView({model: model});

    self.appView.showPageView(view);
  });
} 
```

# php - 控制 RSS 样式

> ID：10802720
> 
> 赞同：0
> 
> 时间：2012-05-29T16:02:44.487
> 
> 标签：php, rss

目前我正在使用此代码从雅虎天气中提取 RSS 提要，但我想按照我想要的方式设置它的样式，但我不确定如何。

```
<?php
    $doc = new DOMDocument();
    $doc->load('http://xml.weather.yahoo.com/forecastrss/10013_f.xml');
    $channel = $doc->getElementsByTagName("channel");
    foreach($channel as $chnl)
    {
    $item = $chnl->getElementsByTagName("item");
    foreach($item as $itemgotten)
    {
    $describe = $itemgotten->getElementsByTagName("description");
    $description = $describe->item(0)->nodeValue;
    echo $description;
    }
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:18:30.053

有2个选项：

**选项1**

上一个答案的不同方法：如果您查看实际的 XML 文件，您还会看到相同的描述也包含在各个标签中：

```
<yweather:condition  text="Fair"  code="34"  temp="84"  date="Tue, 29 May 2012 6:49 pm EDT" />
<yweather:forecast day="Tue" date="29 May 2012" low="70" high="86" text="Partly Cloudy" code="30" />
<yweather:forecast day="Wed" date="30 May 2012" low="64" high="85" text="Scattered Thunderstorms" code="38" />
<yweather:forecast day="Thu" date="31 May 2012" low="56" high="75" text="Partly Cloudy" code="30" />
<yweather:forecast day="Fri" date="1 Jun 2012" low="63" high="69" text="Partly Cloudy" code="30" />
<yweather:forecast day="Sat" date="2 Jun 2012" low="59" high="70" text="Showers" code="11" /> 
```

您没有理由不能单独查询所有这些数据并将其全部包装在您想要的任何 HTML 标记中

例如，要从属性中获取`conditions`属性，这是有效的：

```
<?php
$doc = new DOMDocument(); 
$doc->load('http://xml.weather.yahoo.com/forecastrss/10013_f.xml'); 
$channel = $doc->getElementsByTagName("channel"); 
foreach($channel as $chnl){ 
  $item = $chnl->getElementsByTagName("item"); 
  foreach($item as $itemgotten) { 
    $nodes = $itemgotten->getElementsByTagName('condition')->item(0);
    if ($nodes->hasAttributes()) {
      foreach ($nodes->attributes as $attr) {
        $name = $attr->nodeName;
        $value = $attr->nodeValue;
        echo "Attribute '$name' :: '$value'<br />";
      }
    }
  }
}
?> 
```

**选项 2**

如果您确实选择了上一个答案中建议的方法，请不要忘记您只能使用描述中使用的 HTML 标签（除非您在 PHP 中进行各种字符串操作），但您仍然可以使用/设置这些标签的样式通过在 CSS 中使用级联样式：

```
div.description { /*general div styles*/ }
div.description b { /*styles for anything within a b tag in the description div*/ }
... 
```

...等等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:13:35.353

正如你所说的@Michael，一旦你改变了这样的代码：

```
$doc = new DOMDocument();
$doc->load('http://xml.weather.yahoo.com/forecastrss/10013_f.xml');
$channel = $doc->getElementsByTagName("channel");
foreach($channel as $chnl){
    $item = $chnl->getElementsByTagName("item");
    foreach($item as $itemgotten) {
        $describe = $itemgotten->getElementsByTagName("description");
        $description = $describe->item(0)->nodeValue;
        echo "<div class='description'>" . htmlspecialchars($description) . "</description>";
    }
} 
```

您必须创建必要的 CSS 以根据需要显示信息。

# wpf - 在 WPF 应用程序中显示来自 Sharepoint 列表的富文本字段

> ID：10802722
> 
> 赞同：0
> 
> 时间：2012-05-29T16:02:48.000
> 
> 标签：wpf, sharepoint, sharepoint-2010, richtext, sharepoint-clientobject

我有一个 WPF 应用程序，它使用客户端对象模型使用 SharePoint 列表。

客户希望能够使用富文本填写其中一个字段。这包括粗体/颜色/字体类型/等格式。它还包括超链接。

在我从 SharePoint 获得的信息中，存储在一个字符串中，看起来像这样：

> <div class=\"ExternalClass82C42B1E597D49188F88ECA8C4EEB083\"><p>Ticker Item 3 Body<span style=\"color:#000000\"></span>y<</p></div>

当我使用我在这里找到的建议时：[我可以将 HTML 绑定到 WPF Web 浏览器控件吗？](https://stackoverflow.com/questions/4202961/can-i-bind-html-to-a-wpf-web-browser-control)

它看起来像这样：

> 代码项目 3 身体â€‹</p>

结尾的小“â€‹”是怎么回事？是否有正确的方法在我的 WPF 应用程序中显示包含可点击的超链接和格式的富文本？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:21:30.390

对于任何来这里寻找解决方案的人来说，答案是双重的。

1) 提出了错误的问题。使用 Web 浏览器控件并不是最好的方法。您不能强制在 IE 中打开链接（至少，不容易），并且该窗口的行为类似于网络浏览器。按 F5 将刷新窗口，这将清空它，因为浏览器中没有地址。

无论如何，问题在于 WPF 没有使用正确的字符集。将此添加到您的 html 将解决浏览器问题：

```
html = String.Format("<html><META HTTP-EQUIV=\"Content-Type\" CONTENT=\"text/html; CHARSET=utf-8\"><body>{0}</body></html>", html); 
```

2) 你真正想做的是使用 FlowDocumentScrollViewer。有关如何执行此操作的说明在这里： [如何获取 FlowDocument 超链接以启动浏览器并转到 WPF 应用程序中的 URL？](https://stackoverflow.com/questions/2288999/how-can-i-get-a-flowdocument-hyperlink-to-launch-browser-and-go-to-url-in-a-wpf/10950628#10950628)

# c# - 如何使用 C# 在 XML 中检查具有特定属性值的元素

> ID：10802725
> 
> 赞同：2
> 
> 时间：2012-05-29T16:02:56.567
> 
> 标签：c#, c#-4.0, c#-3.0, linq-to-xml

我的 XML 文件如下

```
<?xml version="1.0" encoding="utf-8"?>
<BallList xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<Brand name="brand1">
 <BallName>brand1 ball</BallName>
</Brand
<Brand name="brand2">
 <BallName>brand2 ball</BallName>
</Brand>
</BallList> 
```

我需要检查具有名称属性的特定品牌，如果它不存在，则应使用 C# Linq 将其添加到 xml 文件中。任何人都可以在这方面帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:14:56.443

你可以使用 Linq To XMl

```
System.Xml.Linq

    var f = XDocument.Load("c:\\00.xml");

    var myBrand = f.Root.Elements("Brand")
        .Where(x => x.Attribute("name").Value == "MyBrand").FirstOrDefault();

    if (myBrand == null)
    {
        // insert here
        f.Root.Add(
            new XElement("Brand",  new XAttribute("name", "MyBrand"), 
                new XElement("BallName", "MyBrand Ballname"))
            );
        f.Save("c:\\00.xml");
    } 
```

这段代码产生了这个结果

```
<?xml version="1.0" encoding="utf-8"?>
<BallList xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Brand name="brand1">
    <BallName>brand1 ball</BallName>
  </Brand>
  <Brand name="brand2">
    <BallName>brand2 ball</BallName>
  </Brand>
  <Brand name="MyBrand">
    <BallName>MyBrand Ballname</BallName>
  </Brand>
</BallList> 
```

# android - Android中的声音合成

> ID：10802726
> 
> 赞同：0
> 
> 时间：2012-05-29T16:03:06.437
> 
> 标签：android, audio

首先，我想说明我在编程方面没有任何良好的经验。

所以我的问题是：

我可以在 android 应用程序中创建声音吗？

基本上，如果用户按下与音符对应的键，我如何重现声音？

我需要在我需要的所有声音之前注册，然后选择并重现用户按下的那个，或者有一种方法可以“编码”声音？

对不起，我对这个领域的无知，但我试着搜索了一下，但我很困惑......

# javascript - javascript中的全局变量

> ID：10802727
> 
> 赞同：-2
> 
> 时间：2012-05-29T16:03:18.497
> 
> 标签：javascript, global-variables

我在页面标题之后和包含所有 javascript 的代码之前定义了一个全局变量“模式”。

```
<?php require('header.php'); ?>

<script type="text/javascript">
    var mode = ""; // flag to set to clicks to external site
</script>

<?php require('mainpage.php'); ?> 
```

我在主页中定义了这样的功能。

```
<script type="text/javascript" src="channels.js"></script> 
```

然后我像这样访问全局变量。

```
function channels() {
        if ( mode == "external" ) {
            continue;
        }
} 
```

但这会导致脚本崩溃。似乎不知道全局变量。

我应该如何定义要在文件中访问的全局变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:17:49.457

```
window.mode = "something";

function channels() {
    // window.mode 
} 
```

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-05-29T16:05:19.420

var - 那不是全局变量。要定义它，请不要使用 var

```
 <script type="text/javascript">
    mode = ""; // flag to set to clicks to external site
</script> 
```

那么**模式**将是窗口对象的一个​​属性。

# .net - 存储独特路径的最佳集合

> ID：10802728
> 
> 赞同：1
> 
> 时间：2012-05-29T16:03:27.280
> 
> 标签：.net, memory-management, collections

我需要存储大量独特的路径，例如：`"C:\MyDir\MySubDir\myfile.txt"`.

我希望能够快速检查我的集合中是否包含路径，以及以上，以尽可能少地使用内存。

什么是最适合这项任务的[集合？](http://msdn.microsoft.com/en-us/library/0sbxh9x2)

是否可以存储一个代表唯一路径的值，而不是字符串本身，以使用更少的内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:07:21.007

看看[Trie](http://en.wikipedia.org/wiki/Trie)我们用 2000 万条路径做得非常有效

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T16:05:35.770

一个哈希集，如果您需要快速访问数据，即如果您想在 O(1) 时间内知道集合中是否存在某些东西。

在 .NET 4 中，使用[`HashSet`](http://msdn.microsoft.com/en-us/library/bb359438). 它就像一个哈希表，但只存储值，而不是键/值对。

```
HashSet<string> myStrings = new HashSet<string>();
myStrings.Add(@"c:\foo\bar.txt");
myStrings.Add(@"c:\foo\baz.gif");
myStrings.Add(@"c:\foo\bat.bin"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T16:08:44.280

这最适合[TRIE](http://www.cs.bu.edu/teaching/c/tree/trie/)。这是一个示例：[在 c# 中实现一个 trie](http://www.kerrywong.com/2006/04/01/implementing-a-trie-in-c/)。

要回答您的问题，**是的，TRIE 存储唯一路径而不是字符串本身。**

尝试对您的任务非常有效，无论是内存消耗还是执行速度。

**编辑：** 并不是说一个比另一个好，**TRIE 是为这种类型的存储/检索问题**而发明的，并且非常有效。 **散列也很快**。如果您想知道哪一个最适合您的需求，请同时实施。无论哪种方式，都不应该花很长时间。 **测量，测量，测量。**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-29T16:28:25.480

正如其他人所回答的那样，a`Trie`并且`HashSet`会提供快速的获取时间。
请注意，虽然 a`Trie`需要的内存少于 a `HashSet`，**但两者都需要比普通的旧内存更多的内存`List`**（请参阅[this](http://ejohn.org/blog/javascript-trie-performance-analysis/)）。

我不知道这是否真的[有必要](http://www.codinghorror.com/blog/2009/01/the-sad-tragedy-of-micro-optimization-theater.html)，但如果内存是一个真正的问题，您可以优化`Trie`实现，使用文件夹名称作为节点而不是字母（因为通常文件夹名称长于一个字母）。这样，您将使用路径的树结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T16:09:13.500

通常用于存储唯一数据点的数据结构是集合。您可以为此使用 .NET[`HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb359438.aspx)类。使用 HashSet，您不必在添加值之前检查值是否存在，并且您也可以快速查找。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-29T16:08:29.273

您为什么不使用 Dictionary/HashTable 来实现快速查找集合的目的。

“可以存储一个表示唯一路径的值..” - 想想这个，每次你必须检查集合中是否存在某个值时，你必须加密/解密你的字符串。不好的做法

**编辑：** 如果速度不是问题，为什么不将所有键存储在数据库中，然后您可以在表中快速循环以查看路径是否存在？

# php - 如何在 PHP 会话中存储 javascript 数组？

> ID：10802733
> 
> 赞同：1
> 
> 时间：2012-05-29T16:03:45.907
> 
> 标签：php, javascript, json, session, client-server

我的 javascript 函数中有一个数组，其中包含 1、2、3、4 等字符串值。我想将此数组存储在 PHP 的会话中。我搜索了它，他们说要使用 JSON，但我正在了解如何使用 JSON。

假设我的数组名称是：**myArray** ，我想做这样的事情：**$_SESSION['myArray'] = myArray;**

反正有这样做吗？如果可能，请提供一些工作代码示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T16:10:31.333

您的 JavaScript 在客户端上运行，您的 PHP 在服务器上运行。您需要通过 HTTP 发送数据。

要将数据从 JavaScript 数组获取到 PHP 会话，您需要：

1.  序列化数据（可以是表单中的输入集合，也可以是字符串。只要您没有 JSON 不支持的数据类型，[JSON 对象就可以帮助处理后者）。](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/stringify)
2.  将数据发送到 PHP（通过提交表单或使用 Ajax）
3.  用 PHP 读回数据（可能来自`$_POST`）
4.  可选择将其反序列化回数据结构
5.  将其存放在`$_SESSION`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:09:44.630

将JSON 对象*编码*为 php（关联）数组的方法是使用：`json_encode(JS_OBJECT_WHICH_IS_STRINGIFIED)`. 要*解码*JSON 对象，请使用`json_decode(PHP_ASSOC_ARRAY)`.

例如：

```
$arr = json_encode('{a:"b"}');  // will give $arr = ['a': 'b']
$js_object = json_decode($arr); // will return '{a:"b"}' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T16:09:56.013

查看 json_encode 和 json_decode。基本上用于`json_decode`将 javascript 数组转换为 php 数组并`json_encode`做相反的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T16:10:35.873

这取决于你想要完成什么。

如果您只是想在 PHP 中存储 JavaScript 中的某些内容，那么它会为 PHP 中的字符串文字分配数组的 JSON 表示形式。

如果您想要实际操作数组数据，那么您需要编写代码来从 JavaScript 解析数组，将其保存在内存中，然后再写出一些包含您的数组的 JavaScript 代码。这个过程称为序列化/反序列化。我在.net 中工作，.net 框架包含执行这些任务的内置类；我认为您的框架也可能这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T16:13:38.820

您应该将 JSON 编码的 JS 数组传递给 php 文件（通过 ajax 或简单形式），然后使用 json_decode(); 最后将其保存在会话中。所以，首先，在你的 JS 代码上是这样的：

```
var json_text = JSON.stringify(your_array, null); 
```

然后，传递`json_text`给您的 PHP 文件，以便您可以像这样保存它：

```
$_SESSION['myArray'] = json_decode($_POST['json_string']); 
```

当然`$_POST['json_string']`取决于您为参数指定的名称。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-05-29T16:12:43.340

将 myArray 转换为 json：

```
var s = "[" = myArray.join + "]" 
```

这只有在 myArray 包含不需要引号的东西时才有效，比如整数或浮点数。

您可以使用一些 javascript 框架来抽象化将值转换为脚本中的 json 的问题，不记得名称，但我听说它们可能是值得的。另一方面，这并不比您在上面看到的要难很多，具体取决于您正在处理的价值观类型。

获取 json 到服务器：

```
document.getElementById("someHiddenElement").value = s; 
```

然后您的服务器端php可以将值保存在会话中。

# java - 数据库增量备份和恢复（如何在 Perl 或 Java 中实现）

> ID：10802734
> 
> 赞同：0
> 
> 时间：2012-05-29T16:03:49.903
> 
> 标签：java, database, perl, backup, recovery

我有几个 Sqlite 数据库，每天都会更新。所以我需要每天做备份，以防万一发生崩溃，我可以恢复。但是，每天备份整个数据库的成本很高，所以我正在考虑进行增量备份（仅在两个不同日期之间备份这些信息）。

目前我的数据库更新过程是在 Perl 中完成的，所以我想知道：有谁知道如何使用脚本在 Perl/Matlab/Java 中执行增量数据库备份/恢复？

谢谢！

此致，乔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:32:01.217

1.  将每行更改时的时间戳存储在表中（称为`change_timestamp`列）。

2.  不要删除行 - 而是将它们标记为“D”已删除状态。这样您就不必费力地弄清楚自上次备份以来删除了哪些行。

3.  有一个“备份时间”表

4.  运行备份时：

    *   将当前运行时间保存到“备份时间”表中

    *   从“备份时间”表中检索最后 2 行（如果 <2 行，则进行完整备份）

    *   `change_timestamp`备份两个上次备份时间戳之间的主表行。

您可以明智地使用审计表来执行#1/#2，但这有点困难。

# android - Android SimpleAdaptor NPE

> ID：10802735
> 
> 赞同：0
> 
> 时间：2012-05-29T16:03:50.663
> 
> 标签：android, json, listview, hashmap, android-inflate

我在将 JSON 对象数据膨胀到我的 ListView 片段时遇到问题。

数据从数据库中提取并通过 PHP 转换为 JSON 数组，然后转换为 JSON 对象。到那时，一切都在工作（请参阅我的代码中的内联 Log.i()）。

我得到一个NPE如下：

> threadid=1：线程以未捕获的异常退出（组=0x40a781f8） 致命异常：com.andaero.app.NavigationListFragment$1.callback(NavigationListFragment 的 android.widget.SimpleAdapter.(SimpleAdapter.java:85) .java:97) 在 com.andaero.app.NavigationListFragment$1.callback(NavigationListFragment.java:1) 在 com.androidquery.callback.AbstractAjaxCallback.callback(AbstractAjaxCallback.java:440) 在 com.androidquery.callback.AbstractAjaxCallback.afterWork (AbstractAjaxCallback.java:1010) 在 com.androidquery.callback.AbstractAjaxCallback.run(AbstractAjaxCallback.java:804) 在 android.os.Handler.handleCallback(Handler.java:605) 在 android.os.Handler.dispatchMessage(Handler. java:92) 在 android.os.Looper.loop(Looper.java:137) 在 android.app.ActivityThread.main(ActivityThread.java:4424) 在 java.lang.reflect.Method.invokeNative(Native Method) 在 java.lang.reflect.Method.invoke(Method.java:511) 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit. java:787) 在 dalvik.system.NativeStart.main(Native Method) 的 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:554)

我不确定我有什么问题。请在您的答案中显示更正的方法，以便我可以更好地理解和学习。谢谢

```
public class NavigationListFragment extends ListFragment {
    Context context;
    private Activity c;
    final AQuery aq = new AQuery(c);
    private static String url = "http://192.168.1.17/Andaero/php/regulatory_list.php";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        final View view = inflater.inflate(R.layout.listview, container, false);
        Log.i("NavigationListFragment", "ListView Inflated!!");
        return view;
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        // AsyncTasks.getJSONArrays(context);// asynchronous task for getting
        // JSONarray
        aq.ajax(url, JSONArray.class, new AjaxCallback<JSONArray>() {
            // JSON Node names
            private static final String TAG_ID = "_id";
            private static final String TAG_LABEL = "label";
            private static final String TAG_TITLE = "title";
            private static final String TAG_DISCR = "description";
            private static final String TAG_GO2URL = "gotoURL";

            public void callback(String url, JSONArray json, AjaxStatus status) {
                if (json != null) {
                    // NavigationListFragment.jsonListCallback(json);
                    Log.i("NavigationListFragment", "Caught JSON: " + json.toString());
                    // Hashmap for ListView
                    List<HashMap<String, String>> mList = new ArrayList<HashMap<String, String>>();
                    try {
                        // Parse the string to a JSON object
                        for (int i = 0; i < json.length(); i++) {
                            JSONObject json_data = json.getJSONObject(i);

                            // Storing each json item in variable
                            String id = json_data.getString(TAG_ID);
                            String label = json_data.getString(TAG_LABEL);
                            String title = json_data.getString(TAG_TITLE);
                            String description = json_data.getString(TAG_DISCR);
                            String gotoURL = json_data.getString(TAG_GO2URL);

                            // creating new HashMap
                            HashMap<String, String> map = new HashMap<String, String>();

                            // adding each child node to HashMap key => value
                            map.put(TAG_ID, id);
                            map.put(TAG_LABEL, label);
                            map.put(TAG_TITLE, title);
                            map.put(TAG_DISCR, description);
                            map.put(TAG_GO2URL, gotoURL);

                            // adding HashList to ArrayList
                            mList.add(map);
                            Log.i("NavigationListFragment", "Hash: " + map);
                        }
                    } catch (JSONException e) {
                        Log.e("log_tag", "Error parsing data " + e.toString());
                    }

                    // create the grid item mapping
                    String[] from = new String[] {TAG_LABEL, TAG_TITLE, TAG_DISCR, TAG_GO2URL};
                    int[] to = new int[] { R.id.listLabel, R.id.listTitle, R.id.listDiscription, R.id.dummy };

                    // Updating parsed JSON data into ListView
                    SimpleAdapter adapter = new SimpleAdapter(c, mList, R.layout.list_item, from, to);??<--THIS IS LINE 97 

                    getListView().setAdapter(adapter);

                    // selecting single ListView item
                    ListView lv = getListView();

                    // Launching new screen on Selecting Single ListItem
                    lv.setOnItemClickListener(new OnItemClickListener() {

                        public void onItemClick(AdapterView<?> parent, View view,
                                int position, long id) {
                            //TODO
                        }
                    });

                }
                // Log any network/JSON Errors
                switch (status.getCode()) {
                    case AjaxStatus.TRANSFORM_ERROR :
                        Log.i("GetJSONArray", "TRANSFORM_ERROR");
                        break;
                    case AjaxStatus.NETWORK_ERROR :
                        Log.i("GetJSONArray", "NETWORK_ERROR");
                        // TODO Create Alert Dialog
                    case AjaxStatus.AUTH_ERROR :
                        Log.i("GetJSONArray", "AUTH_ERROR");
                        break;
                }
            }
        });

    }

    @Override
    public void onSaveInstanceState(Bundle outState) {
        // TODO
    }

    @Override
    public void onAttach(Activity activity) {
        super.onAttach(activity);
        // TODO
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T18:24:31.220

我[在这里找到了答案](https://stackoverflow.com/a/10821559/742030)

```
SimpleAdapter adapter = new SimpleAdapter(c, mList, R.layout.list_item, from, to); 
```

需要：

```
SimpleAdapter adapter = new SimpleAdapter(getActivity(), mList, R.layout.list_item, from, to); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T18:42:11.013

您的问题的答案可能在这里-> [https://stackoverflow.com/a/7493347/1149631](https://stackoverflow.com/a/7493347/1149631) 因为这似乎是您实现 SimpleAdapter 的问题。

# regex - Mercurial .ignore 过滤器辅助

> ID：10802737
> 
> 赞同：2
> 
> 时间：2012-05-29T16:03:56.820
> 
> 标签：regex, mercurial, glob, hgignore

> **可能重复：**
> [忽略 mercurial 中的文件夹](https://stackoverflow.com/questions/310117/ignoring-folders-in-mercurial)

我试图把我认为是一个简单的忽略过滤器的东西放在一起，但似乎无法让它工作。

我的代码中有一个 /database 目录，其中包含定期更改且不属于源代码的文件。我希望 Mercurial 忽略该目录（以及其中的所有文件）。

我怎样才能使这项工作？

我尝试添加以下内容：

```
^DATABASE/ 
```

并且不会忽略数据库目录。

```
C:\CDM_Dev\cdm>hg status
M .hgignore
M DATABASE\CDM001.MEM
M DATABASE\audittr.CDX
M DATABASE\audittr.DBF
M Program\librptte.FXP
M Program\libupdat.FXP
M Program\rpttenan.FXP 
```

还有其他想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T00:19:41.553

如输出所示，您的数据库文件*已由*Mercurial 控制。`hg status`Mercurial 忽略过滤器与 Subversion 的*提交时忽略不同*；也就是说，如果新文件出现在 下`DATABASE/`，它们将被忽略，但任何现有文件将继续被监视以进行更改。

如果下面的文件`DATABASE/`不是源的一部分，请将它们从控件中删除（`hg forget DATABASE/*`，然后提交）。他们将不再以未知的形式出现。

# silverlight - 从用户控件到应用程序中心的 Silverlight 弹出窗口

> ID：10802738
> 
> 赞同：2
> 
> 时间：2012-05-29T16:03:58.363
> 
> 标签：silverlight, popup, center

我在用户控件内部有一个带有“边框”500x500 的弹出窗口...当用户单击按钮打开此弹出窗口时，我希望边框显示在应用程序的中心（水平/垂直）而不是用户控件。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T17:22:25.637

您可以获得根视觉的当前大小并获取值。请记住，如果您可以控制 RootVisual，请进行正确的投射

```
Dim PrincipalObject = CType(Application.Current.RootVisual, System.Windows.UIElement)

Dim posY = (PrincipalObject.RenderSize.Height / 2) - (popup.Height / 2)
Dim PosX = (PrincipalObject.RenderSize.Width / 2) - (popup.Width / 2) 
```

C# 应该是..

```
System.Windows.UIElement PrincipalObject = (System.Windows.UIElement) Application.Current.RootVisual;
Double posY = (PrincipalObject.RenderSize.Height / 2) - (popup.Height /2)
Double posX = (PrincipalObject.RenderSize.Width / 2) - (popup.Width /2) 
```

# iphone - 如何正确使用 Apples Reachability 类来判断互联网是否有效？

> ID：10802745
> 
> 赞同：2
> 
> 时间：2012-05-29T16:04:22.210
> 
> 标签：iphone, ios, ipad, reachability, cfnetwork

> **可能重复：**
> [Apples Reachability 类是否有更复杂的替代方案？](https://stackoverflow.com/questions/10801527/are-there-more-sophisticated-alternatives-to-apples-reachability-class)

这是一个例子：

```
Reachability *reachability = [Reachability reachabilityForInternetConnection];    
NetworkStatus internetStatus = [reachability currentReachabilityStatus];
if (internetStatus != NotReachable) {
    // Internet is reachable. Start download in background.
} else {
    // Create UIAlertView and tell user there is no functional internet!
} 
```

问题：我听说在某些情况下 WiFi“**可能需要连接 VPN on Demand** ”。那么我应该如何正确地通知用户有关非功能性互联网连接的信息？我认为上面的代码不足以解决这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T16:46:08.793

Here is what I usually do, I didn't try it on VPN though! I create a standalone class for the checking the connection, say it is named `WifiCheckClass`.

In the .h file of the class:

```
#import <Foundation/Foundation.h>
#import "SystemConfiguration/SCNetworkReachability.h"

@interface UIDevice (DeviceConnectivity)
+(BOOL) cellularConnected;
+(BOOL) wiFiConnected;
+(BOOL) networkConnected;
@end 
```

In the .m file:

```
#import "WiFiCheckClass.h"

@implementation UIDevice (DeviceConnectivity)

+(BOOL) cellularConnected
{
    SCNetworkReachabilityFlags  flags = 0;
    SCNetworkReachabilityRef netReachability;
    netReachability = SCNetworkReachabilityCreateWithName(CFAllocatorGetDefault(), [@"www.google.com" UTF8String]);
    if(netReachability)
    {
        SCNetworkReachabilityGetFlags(netReachability, &flags);
        CFRelease(netReachability);
    }
    if(flags & kSCNetworkReachabilityFlagsIsWWAN) return YES;
    return NO;
}

+(BOOL) networkConnected
{
    SCNetworkReachabilityFlags flags = 0;
    SCNetworkReachabilityRef netReachability;
    BOOL  retrievedFlags = NO;
    netReachability = SCNetworkReachabilityCreateWithName(CFAllocatorGetDefault(), [@"www.google.com" UTF8String]);
    if(netReachability)
    {
        retrievedFlags  = SCNetworkReachabilityGetFlags(netReachability, &flags);
        CFRelease(netReachability);
    }
    if (!retrievedFlags || !flags) return NO;
    return YES;
}

+(BOOL) wiFiConnected
{
    if ([self cellularConnected]) return NO;
    return [self networkConnected];
}

@end 
```

Now using it is very straight forward:

```
if( [UIDevice wiFiConnected] || [UIDevice networkConnected] || [UIDevice cellularConnected] )
{
    //do what you want
} 
```

# java - char[] -> String -> bytes[] -> String... 我迷路了

> ID：10802746
> 
> 赞同：1
> 
> 时间：2012-05-29T16:04:24.373
> 
> 标签：java, hash, sha

我要做的是将输入的密码转换为 jPasswordField 为 SHA-256 哈希。如果我将密码保存为字符串，但我正在使用的字段正在返回 char[]，我四处游荡并找到了如何做到这一点，所以我最终只是猜测该怎么做......起初我得到了即使密码相同，结果也会不同，但现在我相信我更接近了，因为它是一个常数；但它仍然不是它的输出

```
echo -n 'abc' | sha256sum 
```

是

> ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad

而我的动作的输出（对于相同的输入）是

> 86900f25bd2ee285bc6c22800cfb8f2c3411e45c9f53b3ba5a8017af9d6b6b05

我的动作是这样的：

```
 private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {
        NoSuchAlgorithmException noSuchAlgorithmException = null;
        MessageDigest messageDigest = null;
        try {
            messageDigest = MessageDigest.getInstance("SHA-256");

        } catch (NoSuchAlgorithmException ex) {
            noSuchAlgorithmException = ex;
        }
        if (noSuchAlgorithmException != null) {
            System.out.println(noSuchAlgorithmException.toString());
        }
        else {
            UnsupportedEncodingException unsupportedEncodingException = null;
            byte[] hash = null;
            char[] password = jPasswordField1.getPassword();
            StringBuffer stringBuffer = new StringBuffer();
            for (char c : password) {
                if (c > 0 && c < 16) {
                    stringBuffer.append("0");
                }
                stringBuffer.append(Integer.toHexString(c & 0xff));
            }
            String passwordString = stringBuffer.toString();
            try {
                hash = messageDigest.digest(passwordString.getBytes("UTF-8"));
            } catch (UnsupportedEncodingException ex) {
                unsupportedEncodingException = ex;
            }
            if (unsupportedEncodingException != null) {
                System.out.println(unsupportedEncodingException.toString());
            }
            else {
                stringBuffer = new StringBuffer();
                for (byte b : hash) {
                    stringBuffer.append(String.format("%02x", b));
                }
                String passwordHashed = stringBuffer.toString();
                System.out.println(passwordHashed);
            }
        } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:07:33.463

你已经搞定了。`char[]`只是采取了从转换为`String`->的硬/错误方式`new String(password)`就是您所需要的。（提示，如果你发现自己在字节和字符之间手动转换，你可能做错了）。

附带说明一下，“抛出”异常是有原因的。这样可以轻松跳过引发异常时不应执行的以下代码。通过捕获异常并将其转换为“if”块，您可以使代码变得比需要的更复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:44:08.990

这将打印出与`sha256sum`

```
public static void main(String[] args) 
    throws NoSuchAlgorithmException, UnsupportedEncodingException {

    char[] password = new char[]{'a', 'b', 'c'};

    MessageDigest messageDigest = null;
    messageDigest = MessageDigest.getInstance("SHA-256");

    byte[] hash = null;

    // This is how you convert a char array into a String without reencoding it into a different set of characters.
    String passwordString = new String(password);

    hash = messageDigest.digest(passwordString.getBytes("UTF-8"));
    StringBuilder sb = new StringBuilder();
    for (byte b : hash) {
        sb.append(String.format("%02x", b));
    }
    String passwordHashed = sb.toString();
    System.out.println(passwordHashed);
} 
```

# uiview - 将 UIView 更改为 UIScrollView

> ID：10802749
> 
> 赞同：3
> 
> 时间：2012-05-29T16:04:32.990
> 
> 标签：uiview, uiscrollview

我在我的故事板中构建了这个“myView”视图控制器场景：

![在此处输入图像描述](../Images/c8ac195cbe2d4a8b9077384010f5456f.png)

我有一个包含 ImageView 和 UILabel 的简单视图（我通过 IBOutlets 在代码中引用）。

**我想要的是将此视图转换为滚动视图，我想知道是否可以为此目的调整情节提要中的内容。**

我还尝试以编程方式将视图更改为滚动视图，将以下内容添加到 viewController 的“ViewDidLoad”方法中：

```
CGRect fullScreenRect=[[UIScreen mainScreen] applicationFrame];
scrollView=[[UIScrollView alloc] initWithFrame:fullScreenRect];
scrollView.contentSize=CGSizeMake(320,600);

self.view=scrollView; 
```

但是如果我这样做，我将看不到我的 imageView 和我的标签。**为什么？** 我还尝试（在情节提要中）将视图（在“自定义类”面板内）分配给 UIScrollView 类，但这不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:24:08.580

好的，我找到了解决方案，我更改了视图类型（身份检查器），但 a 的`view`属性`UIViewController`不是 a `UIScrollView`。所以我通过将视图投射到 a 来解决这个问题`UIScrollView`：

```
[(UIScrollView *)self.view setContentSize:CGSizeMake(320, 1000)]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-01T08:14:07.603

将视图添加到控制器->*身份检查器*-> 类更改为*UIScrollView*

调整视图大小（self.urview as！UIScrollView）.contentSize = CGSizeMake(self.view.frame.width, self.view.frame.height)

# javascript - 拉伸文本...如果 Html5 Canvas 中的长度大于 10

> ID：10802750
> 
> 赞同：4
> 
> 时间：2012-05-29T16:04:38.957
> 
> 标签：javascript, jquery, html, canvas, html5-canvas

我最近正在使用 HTML5 Canvas。这是我的 JSFiddle ：

[http://jsfiddle.net/fknjz/17/](http://jsfiddle.net/fknjz/17/)

以下是我发现可能有用的内容：

[http://www.mono-software.com/blog/post/Mono/145/jQuery-dynamic-text-sizing/](http://www.mono-software.com/blog/post/Mono/145/jQuery-dynamic-text-sizing/)

我需要这样的东西：

如果 document.getElementById("nom").value.length > 10...那么每次输入一个字母时文本值会拉伸 -5%...所以如果有在 Canvas 的文本框中输入了 10 多个字母。

有谁知道我怎么能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T19:15:43.253

我不是 100% 确定这是否是你所追求的，因为这个问题有点模糊，但你知道有第四个参数`fillText`吗？它使文本适合最大宽度。我在这里更新了你的 jsFiddle [http://jsfiddle.net/fknjz/32/](http://jsfiddle.net/fknjz/32/)。

我还添加`clearRect`了清除文本下的区域，以便您可以更新视图而不会弄乱。

# sql-server - SQL Server 中的 XML 批量加载问题

> ID：10802753
> 
> 赞同：2
> 
> 时间：2012-05-29T16:04:46.347
> 
> 标签：sql-server, vbscript, sqlxml

我正在尝试使用 XML 批量加载（sql server 2008）。我快到了，但我认为我的架构文件是错误的。我得到的错误是：

![VBS 错误信息](../Images/10c9f6c7cd9f9a2b7988f6f3a821f606.png)

这是我所拥有的：

SQL表结构：

![SQL 表结构](../Images/6d3e65f747cb3efb51a841cd1f52f117.png)

架构文件：

```
<?xml version="1.0" ?>
<Schema xmlns="urn:schemas-microsoft-com:xml-data" 
    xmlns:dt="urn:schemas-microsoft-com:xml:datatypes"  
    xmlns:sql="urn:schemas-microsoft-com:xml-sql" > 

    <ElementType name="weight" dt:type="string" />
    <ElementType name="fwd" dt:type="float" />
    <ElementType name="aft" dt:type="float" />

    <ElementType name="CGs" sql:is-constant="1">
        <element type="gross" />
    </ElementType>

    <ElementType name="gross"  sql:relation="tblCGLimits">
      <element type="weight"  sql:field="weight" />
      <element type="fwd" sql:field="fwd" />
      <element type="aft"        sql:field="aft" />
   </ElementType>
</Schema> 
```

XML 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<CGs>
    <gross weight="8000">
        <fwd>196.5</fwd>
        <aft>208.88162</aft>
    </gross>
    <gross weight="8001">
        <fwd>196.495</fwd>
        <aft>208.8825148</aft>
    </gross>
    <gross weight="8002">
        <fwd>196.49</fwd>
        <aft>208.8834096</aft>
    </gross>
</CGs> 
```

我正在使用的 VBScript：

```
Set objBL = CreateObject("SQLXMLBulkLoad.SQLXMLBulkLoad")
objBL.ConnectionString = "provider=SQLOLEDB.1;data source=MyServer;database=MyDB;uid=MyUser;pwd=MyPW"
objBL.ErrorLogFile = "c:\XMLError.log"
objBL.Execute "c:\Schema.xml", "c:\CGLimits.xml"
Set objBL = Nothing 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:31:30.980

您的 XSD 文件指定权重值是元素，而不是属性，如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>
<CGs>
    <gross>
        <weight>8000</weight>
        <fwd>196.5</fwd>
        <aft>208.88162</aft>
    </gross>
    <gross>
        <weight>8001</weight>
        <fwd>196.495</fwd>
        <aft>208.8825148</aft>
    </gross>
    <gross>
        <weight>8002</weight>
        <fwd>196.49</fwd>
        <aft>208.8834096</aft>
    </gross>
</CGs> 
```

要纠正此问题，请更改

```
<element type="weight" sql:field="weight"/> 
```

到

```
<attribute type="weight" sql:field="weight"/> 
```

在 XSD 文件中。

# wcf - WCF - 集群环境中的静态变量

> ID：10802756
> 
> 赞同：2
> 
> 时间：2012-05-29T16:04:54.983
> 
> 标签：wcf, singleton

我想尝试在具有两个或更多集群和负载平衡 Web 服务器的生产环境中设置一些 WCF 服务。有人可以回答以下问题吗？

1.  在集群服务器环境中，如何使用单例对象和静态变量？
2.  EF 缓存提供程序（请参阅[http://code.msdn.microsoft.com/EFProviderWrappers-c0b88f32](http://code.msdn.microsoft.com/EFProviderWrappers-c0b88f32)）：可以在集群环境中使用吗？

# java - Java：UTC / GMT+0 的时区随机显示名称

> ID：10802767
> 
> 赞同：1
> 
> 时间：2012-05-29T16:05:44.193
> 
> 标签：java, timezone

我们目前遇到的问题是我们在 JAVA 中为同一时区获得不同的显示名称。

编码：

```
TimeZone.getDefault().getDisplayName(); 
```

我有两台机器在 UTC 运行：在一台机器上我得到“Greenwich Zeit”，在另一台机器上我得到“Koordinierte Universalzeit”。

我使用了来自[http://sanjaal.com/java/462/java-date-time-calendar/how-to-get-all-supported-timzone-ids-display-name-and-gmt-offset/](http://sanjaal.com/java/462/java-date-time-calendar/how-to-get-all-supported-timzone-ids-display-name-and-gmt-offset/)的代码获取所有时区 ID 及其显示名称和偏移量的列表。下面您会看到仅显示 GMT+0 结果的摘录。

出于某种原因，Java 似乎为这个时区随机选择了一个名称 (TimeZone.getDefault())

**问题：**有没有办法始终获得相同的一致显示名称？

```
Africa/Accra                    :Ghanaische Normalzeit                                 GMT+0:0
Africa/Bamako                   :Greenwich Zeit                                        GMT+0:0
Africa/Banjul                   :Greenwich Zeit                                        GMT+0:0
Africa/Bissau                   :Greenwich Zeit                                        GMT+0:0
Africa/Casablanca               :Westeuropäische Zeit                                  GMT+0:0
Africa/Conakry                  :Greenwich Zeit                                        GMT+0:0
Africa/Dakar                    :Greenwich Zeit                                        GMT+0:0
Africa/El_Aaiun                 :Westeuropäische Zeit                                  GMT+0:0
Africa/Freetown                 :Greenwich Normalzeit                                  GMT+0:0
Africa/Lome                     :Greenwich Zeit                                        GMT+0:0
Africa/Monrovia                 :Greenwich Zeit                                        GMT+0:0
Africa/Nouakchott               :Greenwich Zeit                                        GMT+0:0
Africa/Ouagadougou              :Greenwich Zeit                                        GMT+0:0
Africa/Sao_Tome                 :Greenwich Zeit                                        GMT+0:0
Africa/Timbuktu                 :Greenwich Zeit                                        GMT+0:0
America/Danmarkshavn            :Greenwich Zeit                                        GMT+0:0
Atlantic/Canary                 :Westeuropäische Sommerzeit                            GMT+0:0
Atlantic/Faeroe                 :Westeuropäische Sommerzeit                            GMT+0:0
Atlantic/Faroe                  :Westeuropäische Sommerzeit                            GMT+0:0
Atlantic/Madeira                :Westeuropäische Sommerzeit                            GMT+0:0
Atlantic/Reykjavik              :Greenwich Zeit                                        GMT+0:0
Atlantic/St_Helena              :Greenwich Zeit                                        GMT+0:0
Eire                            :Irische Sommerzeit                                    GMT+0:0
Etc/GMT                         :GMT+00:00                                             GMT+0:0
Etc/GMT+0                       :GMT+00:00                                             GMT+0:0
Etc/GMT-0                       :GMT+00:00                                             GMT+0:0
Etc/GMT0                        :GMT+00:00                                             GMT+0:0
Etc/Greenwich                   :Greenwich Zeit                                        GMT+0:0
Etc/UCT                         :Koordinierte Universalzeit                            GMT+0:0
Etc/UTC                         :Koordinierte Universalzeit                            GMT+0:0
Etc/Universal                   :Koordinierte Universalzeit                            GMT+0:0
Etc/Zulu                        :Koordinierte Universalzeit                            GMT+0:0
Europe/Belfast                  :Britische Sommerzeit                                  GMT+0:0
Europe/Dublin                   :Irische Sommerzeit                                    GMT+0:0
Europe/Guernsey                 :Britische Sommerzeit                                  GMT+0:0
Europe/Isle_of_Man              :Britische Sommerzeit                                  GMT+0:0
Europe/Jersey                   :Britische Sommerzeit                                  GMT+0:0
Europe/Lisbon                   :Westeuropäische Sommerzeit                            GMT+0:0
Europe/London                   :Britische Sommerzeit                                  GMT+0:0
GB                              :Britische Sommerzeit                                  GMT+0:0
GB-Eire                         :Britische Sommerzeit                                  GMT+0:0
GMT                             :Greenwich Zeit                                        GMT+0:0
GMT0                            :GMT+00:00                                             GMT+0:0
Greenwich                       :Greenwich Zeit                                        GMT+0:0
Iceland                         :Greenwich Zeit                                        GMT+0:0
Portugal                        :Westeuropäische Sommerzeit                            GMT+0:0
UCT                             :Koordinierte Universalzeit                            GMT+0:0
UTC                             :Koordinierte Universalzeit                            GMT+0:0
Universal                       :Koordinierte Universalzeit                            GMT+0:0
WET                             :Westeuropäische Sommerzeit                            GMT+0:0
Zulu                            :Koordinierte Universalzeit   

                     GMT+0:0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:13:59.490

JAVA 在`LOCALE`.

两台机器中的`Locale`值会有所不同，因此也会有所不同。

一种可能的解决方案是创建一个`Locale`对象并将其传递给您的方法，例如 -`TimeZone.getDefault().getDisplayName(localeObject);`

该`Locale`对象可以按如下方式创建 -

```
Locale(String language)
Locale(String language, String country)
Locale(String language, String country, String variant) 
```

# linker - 在 Ubuntu 下的 CodeBlocks 中将 gfortran 库链接到 c++ 程序

> ID：10802778
> 
> 赞同：0
> 
> 时间：2012-05-29T16:06:37.690
> 
> 标签：linker, g++, codeblocks, gfortran

我在 Vmware 下有一个 Ubuntu，并使用 Code::Blocks，因为我不是一个非常强大的命令行用户，并且更喜欢 IDE 而不是 Vim+console。

我正在尝试编译一个使用 c++ 包装器到 fortran 库的程序。但是编译给了我以下错误：

```
undefined reference to `_gfortran_compare_string' 
```

这种类型的错误有很多，还有很多其他类似的错误。

我有 gfortran 4.6.3。我发现搜索它可能是一个链接问题，人们说使用 -lgfortran 选项作为链接器。当我将它添加到 Code::Blocks 中的链接器选项时，它不会改变任何东西，错误仍然存​​在。所以，这里有一些问题：

1.  这是链接器的正确选择吗？
2.  可能我必须为链接器提供指向 fortran 库的直接路径吗？
3.  如何找到 fortran 库的安装位置？（我对linux不太了解（（（）
4.  我做错了什么以及如何解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:18:30.343

您是否将 gfortran 添加为库以链接到您的项目或 lgfortran？l 只是 g++ 的一个选项，用于将库 gfortran 链接到您的代码。我对 Code::Blocks 不熟悉，但您应该寻找一个可以输入要使用的库并直接添加 gfortran 的地方。我的猜测是 Code::Blocks 方面可以帮助你找到这个地方。

金库林

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:32:56.827

我的猜测类似于 /bin/lib /usr/lib 或 /usr/local/lib。看看你的文件系统。不幸的是，我没有在工作中使用 Linux。也许是其他人？

金库林

# scala - Scala 关于 Scalaz 的类型推断状态

> ID：10802780
> 
> 赞同：2
> 
> 时间：2012-05-29T16:06:42.143
> 
> 标签：scala, type-inference, scalaz

正如 Alexej[对此问题](https://stackoverflow.com/questions/7010512/scalaz-validation-and-list-monad)的回答所见，在 a 上运行序列时，`Seq[Validation[X, A]]`您需要一个样板显式类型参数`sequence[({type L[Y] = Validation[X, Y]})#L, Y]`。

其他数据类型/函数可能会发生同样的需求。

通过改进类型推断来消除对此类显式类型的需求的相关问题是：

*   理论上可以在Scala中做吗？

*   如果是，这是否在 Scala 路线图上？什么时候可以预期解决方案？

*   如果不在路线图上，那么解决方案是否容易/适中/难以实现？

*   一个普通人能做些什么来推进这个案子吗？

欢迎任何有关该问题的指示。

（[这里是一个稍微相关的问题](https://stackoverflow.com/questions/7234095/why-is-scalas-type-inference-not-as-powerful-as-haskells)，但不讨论未来的前景）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T19:25:34.223

retroonym 在这里说[什么是 Scala 中的类型 lambda，它们有什么好处？](https://stackoverflow.com/questions/8736164/what-are-type-lambdas-in-scala-and-what-are-their-benefits)未来版本的 scala 可以改善这一点。所以我想有可能改进语法。但是，据我了解，由于子类型化，我们在 Scala 中面临一些不可能

# macos - 无法让 NSForm 工作？

> ID：10802786
> 
> 赞同：1
> 
> 时间：2012-05-29T16:07:06.567
> 
> 标签：macos, cocoa, nsform

我有一个基本项目，它只包含一个`NSForm`. 我要做的就是向它添加一些行。据我了解，我应该能够以如下方式做到这一点：

```
- (void) awakeFromNib
{
    NSLog(@"Test: %p", form);
    [form addEntry: @"Hello World 1"];
    [form addEntry: @"Hello World 2"];
    [form addEntry: @"Hello World 3"];

    [form sizeToCells];
} 
```

我已经确认我的表单不为空（测试打印显示它的地址），但我的表单仍然只包含两个默认条目，当我将 NSForm 拖到我的视图上时显示的两个默认条目。

![在此处输入图像描述](../Images/470dba49505e53d6cd31a00493c9dff5.png)

我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:29:17.000

我刚刚花了一段时间玩这个，似乎问题出在`awakeFromNib:`.

在一个示例项目中，我在我的应用委托类中为 NSForm 创建了一个出口。然后我将你的代码粘贴到`applicationDidFinishLaunching:`. 它起作用了（尽管默认选择的单元格中存在图形故障）。

如果你真的需要逻辑进入`awakeFromNib:`，你可以把它放在自己的方法中并使用它来调用它`performSelector:afterDelay:`吗？

# php - 使用 android 从 web url 下载 mp3 失败

> ID：10802789
> 
> 赞同：0
> 
> 时间：2012-05-29T16:07:17.400
> 
> 标签：php, android, download, mp3

我有一个链接可以在他们可以阅读的所有移动设备上下载 mp3。我还有一个带有 Android 2.3.4 的 Acer E320，我想通过单击我的链接（网络服务器 Apache；这是该链接后面的一些 PHP 源代码）下载我的 mp3。

我用黑莓试了试，我得到了文件。我尝试使用带有 Android 的三星 Galaxy S 用户代理的 Firefox 浏览器，我得到了文件。我尝试使用具有相同 Android 2.3.4 的 Acer E320，然后……我没有得到文件。

我很确定这来自操作系统，我明天会尝试使用 Windows Phone，但我很确定这会奏效。

以下是我的下载来源：

```
 <?php
    // assume that all variables are correctly set
    header("Pragma: public");
    header("Expires: 0");
    header("Cache-Control:");
    header("Cache-Control: public");
    header("Content-Description: File Transfer");
    header("Content-Type: audio/mpeg");
    header('Content-Disposition: attachment; filename="'.$filename.'";');
    header("Content-Transfer-Encoding: binary");
    header('Content-Range: ' . $download_range);
    header('Content-Length: ' . $download_size);
    readfile($filename);
    ?> 
```

如果您知道为什么此代码在 Android 手机上不起作用，谢谢。

编辑：我尝试使用带有 Windows Phone 操作系统的 HTC。下载没有开始，但我可以在 apache 日志上看到我的命中...看来 Android 并不孤单...

第二次编辑：我终于找到了：Android 完成了一个预取，因为一次性令牌而终止了我的下载。谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T13:06:35.727

我终于找到了：

`Android`由于一次性令牌，有一个预取完成了我的下载。

谢谢大家。

# ios5 - UIWebView 不显示键盘

> ID：10802790
> 
> 赞同：0
> 
> 时间：2012-05-29T16:07:18.097
> 
> 标签：ios5, uiwebview

我一直在尝试调试 UIWebView 中一些奇怪行为的问题。我的应用程序使用 UIWebView 显示自定义表单以收集某些信息。当表单第一次加载、填写和提交时，一切都会正常运行。第一次提交后，重新加载表单时，键盘将不会显示（但内容会像滚动一样滚动）。

我遇到的唯一解决方案是[here](https://stackoverflow.com/a/6337936/620197)，但这似乎不是我的问题的解决方案，因为该行已经在我的应用程序委托中。

这是一个已知的问题？我什至不知道从哪里开始寻找调试这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T17:56:46.880

经过大量搜索 SO 和 Apple 论坛后，重新排列的是视图层次结构。在我的特殊情况下，进度指示器被添加为新窗口（由同事添加，所以我可以为此责怪其他人）。诀窍不是将此新设置为关键窗口，而只是操纵隐藏的属性

这只是一个快速修复，因为只有一行代码导致了这个主要问题。

# ruby-on-rails - Ruby on Rails - 具有相同模型和数据库的多个应用程序

> ID：10802793
> 
> 赞同：1
> 
> 时间：2012-05-29T16:07:30.020
> 
> 标签：ruby-on-rails, ruby, architecture

我正在使用 Rails 开发企业 Web 应用程序。我试图找出在 2-3 个 rails 应用程序之间使用相同模型和数据库的最佳方法。

我的项目由不同的应用程序组成，例如*用户应用程序、客户应用程序和管理应用程序*。所有这 3 个都将使用相同的数据库和几乎相同的模型。我想创建 3 个不同的 rails 应用程序并将它们部署到不同的服务器。

共享模型的最佳方式可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T11:37:15.040

构建一个包含您的模型和数据库的应用程序。让所有控制器返回 json（或 xml）。不为此应用程序创建任何视图。然后，创建您的其他应用程序，以便它们对第一个应用程序进行 http 调用。这使您可以根据需要将原始应用程序的模型/数据库/功能共享给尽可能多的其他应用程序。如有必要，未来的应用程序甚至可以使用自己的或补充的数据存储，因为它们仅将原始应用程序用作服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T17:53:44.870

在您的各种项目的 database.yml 文件中，让它们指向同一个数据库。然后在您的各种项目中使用相同的类名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T16:10:15.640

解决方案之一是编写自定义库或 gem 并将所有常用代码放在这里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-11T17:45:51.040

您可以构建 4 个 rails 应用程序。datastoreapp 包含数据模型，控制器返回 json（无视图）。userapp、custapp、adminapp 可以对 datastoreapp 进行 api 调用以获取合并数据。

# android - 适用于 Android 的 RTSP 上的 MJPEG 视频流

> ID：10802795
> 
> 赞同：2
> 
> 时间：2012-05-29T16:07:30.940
> 
> 标签：android, video-streaming, rtsp, android-videoview, mjpeg

我正在开发一个尝试从私人服务器流式传输视频的 android 应用程序。视频格式为 MJPEG。我想知道 RTSP 是否会帮助我显示该格式的视频。

要从服务器访问视频，用户需要连接到适当的 WIFI。我已确保已建立连接。我似乎无法让视频流式传输。我播放视频的代码如下：

```
 String vidLink = "rtsp://user:pwd@192.168.2.250/axis-cgi/mjpg/video.cgi";
    //set up video streaming
    MediaController mc = new MediaController(this);
    mc.setAnchorView(videoView);
    mc.setMediaPlayer(videoView);
    Uri video = Uri.parse(vidLink);
    videoView.setMediaController(mc);
    videoView.setVideoURI(video);
    videoView.requestFocus();
    videoView.start(); 
```

任何帮助，将不胜感激。谢谢

# spring - 具有参数属性的 Spring 数据 JPA 查询

> ID：10802798
> 
> 赞同：94
> 
> 时间：2012-05-29T16:07:37.497
> 
> 标签：spring, jpa, spring-data, spring-data-jpa

声明使用输入参数的属性作为查询参数的 Spring 数据 JPA 查询的最简单方法是什么？

例如，假设我有一个实体类：

```
public class Person {
    @Id
    private long id;

    @Column
    private String forename;

    @Column
    private String surname;
} 
```

和另一个类：

```
public class Name {
    private String forename;
    private String surname;

    [constructor and getters]
} 
```

...然后我想编写一个Spring数据存储库，如下所示：

```
public interface PersonRepository extends CrudRepository<Person, Long> {
    @Query("select p from Person p where p.forename = ?1.forename and p.surname = ?1.surname")
    findByName(Name name);
} 
```

...但是 Spring data / JPA 不喜欢我在`?1`参数上指定属性名称。

什么是最整洁的选择？

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2015-03-11T17:48:30.203

此链接将为您提供帮助：支持 SpEL 表达式的 Spring Data JPA M1。类似的例子是：

```
@Query("select u from User u where u.firstname = :#{#customer.firstname}")
List<User> findUsersByCustomersFirstname(@Param("customer") Customer customer); 
```

[https://spring.io/blog/2014/07/15/spel-support-in-spring-data-jpa-query-definitions](https://spring.io/blog/2014/07/15/spel-support-in-spring-data-jpa-query-definitions)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-06-02T05:42:38.087

使用签名定义查询方法，如下所示。

```
@Query(select p from Person p where p.forename = :forename and p.surname = :surname)
User findByForenameAndSurname(@Param("surname") String lastname,
                             @Param("forename") String firstname);
} 
```

有关更多详细信息，请查看[Spring Data JPA 参考](http://docs.spring.io/spring-data/data-jpa/docs/current/reference/html/jpa.repositories.html#jpa.query-methods.named-queries)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-29T17:14:45.107

你想要的是不可能的。您必须创建两个参数，并分别绑定它们：

```
select p from Person p where p.forename = :forename and p.surname = :surname
...
query.setParameter("forename", name.getForename());
query.setParameter("surname", name.getSurname()); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-12-22T11:47:22.793

您也可以使用接口默认方法解决它：

```
 @Query(select p from Person p where p.forename = :forename and p.surname = :surname)
User findByForenameAndSurname(@Param("surname") String lastname,
                         @Param("forename") String firstname);

default User findByName(Name name) {
  return findByForenameAndSurname(name.getLastname(), name.getFirstname());
} 
```

当然，您仍然可以公开看到实际的存储库功能......

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-11-13T16:04:12.490

你可以尝试这样的事情：

```
public interface PersonRepository extends CrudRepository<Person, Long> {
       @Query("select p from Person AS p"
       + " ,Name AS n"  
       + " where p.forename = n.forename "
       + " and p.surname = n.surname"
       + " and n = :name")
       Set<Person>findByName(@Param("name") Name name);
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-09-25T08:55:38.030

如果我们使用 JpaRepository，那么它将在内部创建查询。

**样本**

> findByLastnameAndFirstname（字符串姓氏，字符串名字）
> 
> findByLastnameOrFirstname（字符串姓氏，字符串名字）
> 
> findByStartDateBetween(日期 date1,Date2)
> 
> findById(int id)

**笔记**

如果假设我们需要复杂的查询，那么我们需要编写手动查询，例如

```
@Query("SELECT salesOrder FROM SalesOrder salesOrder WHERE salesOrder.clientId=:clientId AND salesOrder.driver_username=:driver_username AND salesOrder.date>=:fdate AND salesOrder.date<=:tdate ")
 @Transactional(readOnly=true)
 List<SalesOrder> findAllSalesByDriver(@Param("clientId")Integer clientId, @Param("driver_username")String driver_username, @Param("fdate") Date fDate, @Param("tdate") Date tdate); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-10T20:30:11.807

你也在和a一起工作`@Service`吗？因为如果您是，那么您可以`@Autowired`在`PersonRepository`服务`@Service`中调用`Name`该类并使用@CuriosMind ... 建议的形式：

```
@Query(select p from Person p where p.forename = :forename and p.surname = :surname)
User findByForenameAndSurname(@Param("surname") String lastname,
                         @Param("forename") String firstname);
} 
```

并且当从服务中的存储库调用方法时，您可以传递这些参数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-16T03:09:51.467

Spring Data JPA 的简单性在于它尝试从存储库中的函数名称进行解释，而无需指定任何额外的 @Query 或 @Param 注释。如果您提供完整名称，请尝试将其分解为名字和姓氏，然后使用类似这样的内容 -

```
HotelEntity findByName(String name); 
```

我的 HotelEntity 确实包含字段*名称*，因此 JPA 尝试自行解释以推断我尝试查询的字段的名称并在内部创建后续查询。来自 JPA 文档的更多证据 - [![在此处输入图像描述](../Images/173ad5d02c4ba0211b2b9fcf17aa9f9c.png)](https://i.stack.imgur.com/qFtRH.png)

更多细节 -[这里](https://docs.spring.io/spring-data/jpa/docs/1.5.0.RELEASE/reference/html/jpa.repositories.html)

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2018-05-20T22:03:03.750

```
 for using this, you can create a Repository for example this one:
    Member findByEmail(String email);

    List<Member> findByDate(Date date);
    // custom query example and return a member
   @Query("select m from Member m where m.username = :username and m.password=:password")
        Member findByUsernameAndPassword(@Param("username") String username, @Param("password") String password); 
```

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2017-11-04T09:40:35.650

```
@Autowired
private EntityManager entityManager;

@RequestMapping("/authors/{fname}/{lname}")
    public List actionAutherMulti(@PathVariable("fname") String fname, @PathVariable("lname") String lname) {
        return entityManager.createQuery("select A from Auther A WHERE A.firstName = ?1 AND A.lastName=?2")
                .setParameter(1, fname)
                .setParameter(2, lname)
                .getResultList();
    } 
```

# css - CSS - 属性前的“#”符号

> ID：10802800
> 
> 赞同：2
> 
> 时间：2012-05-29T16:07:44.287
> 
> 标签：css

> **可能重复：**
> [以井号 (#) 开头的 CSS 属性是否有效？](https://stackoverflow.com/questions/7161412/is-a-css-property-starting-with-a-hash-valid)

我尝试在 Stackoverflow.com 上四处寻找，但找不到与我的问题相关的任何内容。开放网络也没有任何改善，尽管 Yahoo! 上有答案。*答案除了“[`#`用于ID]”*之外，“答案”并没有真正说什么（当然不需要发布链接）。

这有点高级。

在查看同事的 CSS 代码时，我发现他`#`在几个 CSS 属性之前使用了这个标志。

财产前的`#`标志有什么作用？我假设这一定是一些针对 IE 的黑客攻击。

例如：

```
.selector { #property:value; } 
```

或者很好：

```
.headings { #margin-top:10px; } 
```

我以为我对 CSS 了解很多，但这个让我大吃一惊，尤其是在开放的网络上除了 Yahoo! 的答案之外没有任何关于这个案例的文档。答案。

非常感谢任何有关此的信息。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T16:10:03.410

**更新**

事实证明，这`#property`适用于 IE7 或更低版本，引用[Paul Irish](http://paulirish.com/2009/browser-specific-css-hacks/)的话：

> 2009.11.10 更新 – 添加了 #prop: value IE<=7 hack。我更喜欢它而不是 *prop。

* * *

放在`#`属性之前必须是某些浏览器的黑客攻击。其他类似的 hack 包括`_`（针对 IE6 及以下）、`*`（针对 IE8 及以下）等。

有关详细信息，请参阅：

*   [特定于浏览器的 CSS 黑客](http://paulirish.com/2009/browser-specific-css-hacks/)

# html - 菜单在 Internet Explorer 8 和 9 中无法正常工作

> ID：10802804
> 
> 赞同：1
> 
> 时间：2012-05-29T16:07:57.017
> 
> 标签：html, css, internet-explorer, internet-explorer-8, internet-explorer-9

我在 ie9 和 ie8 中的菜单有问题，在 ie7 中运行良好，但在 ie9 和 ie8 中无法运行。

访问该网站： http: [//geotopsa.futuraserveis.com/en/home.html](http://geotopsa.futuraserveis.com/en/home.html)

这是html代码：

```
<div id="menuContenidor">
            <ul id="menu">
            <li class="inici"><a href="<?php echo url_for($ruta_inici) ?>"><?php echo __(
        'Inici') ?></a></li>
            <li class="normal"><a href="<?php echo url_for($ruta_empresa) ?>"><?php echo __(
        'Empresa') ?></a></li>
            <li class="ample"><a href="#"><?php echo __('Serveis') ?></a>
                  <ul id="ambits">
                    <li><img class="corner_inset_left" alt="" src="/images/Menu/corner_inset_left.png"/>
                        <a href="<?php echo url_for($ruta_serveis_soterrats) ?>"><?php echo __(
        'Aixecament de serveis urbans') ?></a>
                        <img class="corner_inset_right" alt="" src="/images/Menu/corner_inset_right.png"/>
                                <li><a href="<?php echo url_for(
        $ruta_infraestructures) ?>"><?php echo __("Infraestructures vials") ?></a></li>                    </li>

                    <li><a href="<?php echo url_for($ruta_topografia) ?>"><?php echo __(
        'Topografia') ?></a></li>
                    <li><a href="<?php echo url_for($ruta_proteccio) ?>"><?php echo __(
        'Protecció del patrimoni') ?></a></li>
             <li><a href="<?php echo url_for($ruta_aplicacions_especials) ?>"><?php echo __(
        'Aplicacions especials') ?></a></li>

                    <li class="last">
                      <img class="corner_left" alt="" src="/images/Menu/corner_left.png"/>
                      <img class="middle" alt="" src="/images/Menu/dot.gif"/>
                      <img class="corner_right" alt="" src="/images/Menu/corner_right.png"/>                    </li>
                  </ul>
            </li>

                        <li class="ample"><a href="#"><?php echo __(
        'Mètodes de prospecció') ?></a>
                  <ul id="ambits">
                    <li><img class="corner_inset_left" alt="" src="/images/Menu/corner_inset_left.png"/>
                        <a href="<?php echo url_for($ruta_georadar) ?>"><?php echo __(
        'Georadar') ?></a>
                        <img class="corner_inset_right" alt="" src="/images/Menu/corner_inset_right.png"/>                    </li>
                    <li><a href="<?php echo url_for($ruta_tomografia) ?>"><?php echo __(
        'Tomografia elèctrica') ?></a></li>

                    <li class="last">
                      <img class="corner_left" alt="" src="/images/Menu/corner_left.png"/>
                      <img class="middle" alt="" src="/images/Menu/dot.gif"/>
                      <img class="corner_right" alt="" src="/images/Menu/corner_right.png"/>                    </li>
                  </ul>
            </li>
            <li class="normal"><a href="<?php echo url_for($ruta_projectes) ?>"><?php echo __(
        'Projectes') ?></a></li>
            <li class="normal"><a href="<?php echo url_for($ruta_clients) ?>"><?php echo __(
        'Clients') ?></a></li>
            <li class="normal"><a href="<?php echo url_for($ruta_contactar) ?>"><?php echo __(
        'Contactar') ?></a></li>                
            <li class="menuUltim"><a href="ftp://79.148.111.133" target="_blank"><?php echo __(
        'Ftp') ?></a></li>
        </ul>
    </div> 
```

和CSS：

```
#menu {
    font-size: 0.9em;
    margin: 0px;
    margin-left: 18px;
    padding: 0px;
    list-style: none;
    color: #fff;
    line-height: 30px;
    display: inline-block;
    float: left;
    z-index: 1000;
}

#menu a {
    color: #fff;
    text-decoration: none;
}

#menu>li {
    background: #202726 none repeat scroll 0 0;
    cursor: pointer;
    float: left;
    position: relative;
    padding: 0px 10px;
    width: 91px;
    border-top-color: #FFFFFF;
    border-right-color: #FFFFFF;
    border-bottom-color: #FFFFFF;
    border-left-color: #FFFFFF;
    border-top-width: thin;
    border-right-width: thin;
    border-bottom-width: thin;
    border-left-width: thin;
    text-align: center;
    border-right-style: solid;
}

#menu>li.inici {
    width: 55px;
}

#menu>li.normal {
    width: 106æpx;
}

#menu>li.ample {
    width: 169px;
}

#menu>li.menuUltim {
    background: #202726 none repeat scroll 0 0;
    cursor: pointer;
    float: left;
    position: relative;
    padding: 0px 10px;
    width: 38px;
    border-top-color: #FFFFFF;
    border-bottom-color: #FFFFFF;
    border-left-color: #FFFFFF;
    border-top-width: thin;
    border-bottom-width: thin;
    border-left-width: thin;
    border-right: none !important;
    text-align: center;
}

#menu>li a:hover {
    color: #948B52;
}

#menu .logo {
    background: transparent none repeat scroll 0% 0%;
    padding: 0px;
    background-color: Transparent;
}

/* sub-menus*/
#menu ul {
    padding: 0px;
    margin: 0px;
    display: block;
    display: inline;
}

#menu li ul {
    position: absolute;
    left: 0px;
    top: 0px;
    margin-top: 30px;
    width: 188px;
    line-height: 16px;
    background-color: #202726;
    color: #0395CC; /* for IE */
    display: none;
}

#menu li ul.ample {
    position: absolute;
    left: 0px;
    top: 0px;
    margin-top: 30px;
    width: 179px;
    line-height: 16px;
    background-color: #202726;
    color: #0395CC; /* for IE */
    display: none;
}

#menu li:hover ul {
    display: block;
}

#menu li ul li {
    display: block;
    margin: 5px 20px;
    padding: 5px 0px;
    border-top: dotted 1px #606060;
    list-style-type: none;
}

#menu li ul li:first-child {
    border-top: none;
}

#menu li ul li a {
    display: block;
    color: #727465;
}

#menu li ul li a:hover {
    color: #DFD7CB;
}
/* main submenu */
#menu #main {
    left: 0px;
    top: -20px;
    padding-top: 20px;
    background-color: #7cb7e3;
    color: #fff;
    z-index: 999;
}
/* corners*/
#menu .corner_inset_left {
    position: absolute;
    top: 0px;
    left: -12px;
}

#menu .corner_inset_right {
    position: absolute;
    top: 0px;
    left: 188px;
}

#menu .last {
    background: transparent none repeat scroll 0% 0%;
    margin: 0px;
    padding: 0px;
    border: none;
    position: relative;
    border: none;
    height: 0px;
}

#menu .corner_left {
    position: absolute;
    left: 0px;
    top: 0px;
}

#menu .corner_right {
    position: absolute;
    left: 170px;
    top: 0px;
}

#menu .middle {
    position: absolute;
    left: 18px;
    height: 20px;
    width: 152px;
    top: 0px;
} 
```

我能做些什么？问题出在哪里？

# r - 有没有办法以颜色将文本输出到 R 控制台

> ID：10802806
> 
> 赞同：57
> 
> 时间：2012-05-29T16:08:13.223
> 
> 标签：r, colors, console, output-formatting

我正在编写一个脚本，我想根据条件以不同的颜色将文本消息输出到控制台。例如：红色表示错误，蓝色表示警告等。

我正在使用 RStudio。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2015-04-21T18:23:53.937

查看新[`crayon`包](http://cran.r-project.org/web/packages/crayon/index.html)：

```
library(crayon)
cat(blue("Hello", "world!\n")) 
```

有关[GitHub 页面](https://github.com/gaborcsardi/crayon)的更多信息。

适用于 RStudio 1.2.360+

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T16:22:29.223

Romain Francoise的[**xterm256**软件包](http://romainfrancois.blog.free.fr/index.php?post/2009/04/18/Colorful-terminal%3A-the-R-package-%22xterm256%22)通常允许在任何理解 xterm256 中断的控制台上执行此类操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-29T17:03:42.110

在 Linux 或 Mac 上，您可以尝试[https://github.com/jalvesaq/colorout](https://github.com/jalvesaq/colorout) 它在 Windows 上不起作用。

# ajax - 使用 MVC 3 ajax 样式上传文件

> ID：10802816
> 
> 赞同：3
> 
> 时间：2012-05-29T16:09:04.937
> 
> 标签：ajax, asp.net-mvc-3, html

也许只是我，但我正在尝试使用 jQuery 对话框来捕获用户想要上传的文件。**它必须受 IE9 支持**。IE9 不支持在我遇到的许多示例和第 3 方工具中使用的 FormData 对象。因此，为了使我的请求不刷新整个页面，我必须将我的上传文件放入 iFrame 中？真的吗？我知道我可以得到一些 Flash 上传器，但我们的网站不支持 Flash，所以现在不可能。

请..请有人告诉我我做错了，有一种更简单的方法，因为我似乎找不到它.. 至少在 IE9 上不能工作。

形式

```
<form action="/ControllerName/ActionName" method="post" enctype="multipart/form-data">
    <label for="file">Filename:</label>
    <input type="file" name="file" id="file" />
    <input type="submit" name="submit" value="Submit" />
</form> 
```

然后进入这样的 iFrame

```
<iframe src="myUrl"></iframe> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:33:41.583

看法：

```
@using (Html.BeginForm("FileUpload","Message",FormMethod.Post,new { enctype="multipart/form-data"})) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Message</legend>

//your html here

                                <input type="file" name="files"/>

    </fieldset> 
```

控制器：

```
[HttpPost]
        public ActionResult FileUpload(FormCollection values, IEnumerable<HttpPostedFileBase> files)
        {
             //do what you want with form values then for files

           foreach (var file in files)
            {
                if (file.ContentLength > 0)
                {
                    byte[] fileData = new byte[file.ContentLength];
                    file.InputStream.Read(fileData, 0, file.ContentLength);

                   //do what you want with fileData
                }
            }
        } 
```

我提供多个文件上传，所以我使用

```
IEnumerable<HttpPostedFileBase> files 
```

如果你只想要一个文件，那么只使用

```
HttpPostedFileBase file 
```

并在您的视图中将输入类型更改为

```
<input type="file" name="file"/> 
```

就那么简单。问候

编辑：

看看更多好的例子：

[http://www.strathweb.com/2012/04/html5-drag-and-drop-asynchronous-multi-file-upload-with-asp-net-webapi/](http://www.strathweb.com/2012/04/html5-drag-and-drop-asynchronous-multi-file-upload-with-asp-net-webapi/)

[http://css.dzone.com/articles/implementing-html5-drag-drop](http://css.dzone.com/articles/implementing-html5-drag-drop)

问候

# javascript - Google Maps API v3：循环并添加折线到地图

> ID：10802819
> 
> 赞同：2
> 
> 时间：2012-05-29T16:09:29.937
> 
> 标签：javascript, google-maps, google-maps-api-3

我已经浏览了论坛试图寻找解决方案，并且我已经针对我遇到的几个问题调整了我的代码，但是这个问题让我望而却步。我正在尝试在地图上绘制多个点（有效），然后在这些点之间画线。每个标记都包含信息，例如纬度和经度，以及它的邻居（我想画线的点）。我也给它我想要的颜色，因为不同的“路线”可以有不同的颜色。我唯一能看到的问题是我画了一条线，将其设置在地图上，然后再次为下一个标记运行循环。

我的代码放置了标记，为每个标记放置了信息窗口，但没有在标记之间画线。任何人都可以看到我在哪里搞砸了，或者即使这可以按照我正在做的方式来做到这一点？

我将 drawMap 函数分开的原因是如果用户想要过滤掉可见数据，我需要动态地重新绘制地图。所以，我将标记列表保存在全局范围内，这样即使函数完成后我也可以引用它。

我的代码：

[http://www.nku.edu/~sweikatam1/nkuPhysicalMapTest.html](http://www.nku.edu/~sweikatam1/nkuPhysicalMapTest.html)

特别是这个问题的地方是函数drawMap，它传递了一个对象数组markerList，其中包含纬度、经度、颜色（用于折线）和其他数据位。线路位置：

```
 for(var j = 0; j < markerList.length; j++){
            if(markerList[j].name == markerList[i].neighbor){
                var targetDestination = new google.maps.LatLng(markerList[j].latitude,markerList[j].longitude);
                //alert(markerList[i].latitude + " " + markerList[i].longitude + " \r" + markerList[j].latitude + " " + markerList[j].longitude);
            }
        }
        //set the pathway for the two points
        var flightPlanCoordinates = [
            new google.maps.LatLng(markerList[i].latitude, markerList[i].longitude),
            new google.maps.LatLng(targetDestination)
            ];

            //alert("Color: " + markerList[i].routeColor);
        //set the line and color    
        var flightPath = new google.maps.Polyline({
            path:flightPlanCoordinates,
            strokeColor:markerList[i].routeColor,
            strokeOpacity:2,
            strokeWeight:5
            });
        //apply lines
        flightPath.setMap(map); 
```

整体功能：

```
 function drawMap(markerList){
    //alert("Starting drawMap");

    //create the map
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 15,
      center: new google.maps.LatLng(39.032253, -84.465015),
      mapTypeId: google.maps.MapTypeId.HYBRID
    });

    var marker; 
    for (var i = 0; i <markerList.length; i++){
        /*alert("markerList @ i: " + markerList[i].name);
        alert("Marker Data: " + "Name: " + markerList[i].name + "\r "
                            + "Latitude: " + markerList[i].latitude + "\r "
                            + "Longitude: " + markerList[i].longitude + "\r "
                            + "Content Type: " + markerList[i].contentType + "\r "
                            + "Image: " + markerList[i].image
                            + "Color: " + markerList[i].routeColor);*/
        var contentData = '<b>'+markerList[i].name +'</b>: '
                            + markerList[i].latitude + ' x ' 
                            + markerList[i].longitude + '<br/><p>'
                            + markerList[i].contentType 
                            +'</p><img src="' + markerList[i].image + " height=150 width=100>";

        //create the marker

        marker = new google.maps.Marker({
            position: new google.maps.LatLng(markerList[i].latitude,markerList[i].longitude),
            draggable: false,
            icon: markerList[i].icon,
            map:map,
            content: contentData,
            title:markerList[i].name
        });

        //find the neighbor for the current marker and set the destination coordinates
        for(var j = 0; j < markerList.length; j++){
            if(markerList[j].name == markerList[i].neighbor){
                var targetDestination = new google.maps.LatLng(markerList[j].latitude,markerList[j].longitude);
                //alert(markerList[i].latitude + " " + markerList[i].longitude + " \r" + markerList[j].latitude + " " + markerList[j].longitude);
            }
        }
        //set the pathway for the two points
        var flightPlanCoordinates = [
            new google.maps.LatLng(markerList[i].latitude, markerList[i].longitude),
            new google.maps.LatLng(targetDestination)
            ];

            //alert("Color: " + markerList[i].routeColor);
        //set the line and color    
        var flightPath = new google.maps.Polyline({
            path:flightPlanCoordinates,
            strokeColor:markerList[i].routeColor,
            strokeOpacity:2,
            strokeWeight:5
            });
        //apply lines
        flightPath.setMap(map);

        //handle open information windows
        google.maps.event.addListener(marker,'click', function(){
            closeInfos();
            var info = new google.maps.InfoWindow({content: this.content});
            info.open(map,this);
            infos[0]=info;
            });
            //alert("Marker " + markerList[i].name + " placed.");

    }
    //alert("drawMap complete. Drawing lines");

    <!-- DRAWING LINES COMPLETE -->
} 
```

如果这里有任何奇怪、令人困惑或需要澄清的地方，请告诉我。批评和做得更好的方法总是受欢迎的。多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:43:26.763

在定义中`flightPlanCoordinates`，第二个 LatLng 是从另一个 LatLng (targetDestination) 创建的。因此，只需删除该`new google.maps.LatLng`部分并直接使用 targetDestination 即可。随着这种变化，我看到地图上绘制了一个蓝色的锯齿形和一个红色的锯齿形。

```
var flightPlanCoordinates = [
    new google.maps.LatLng(markerList[i].latitude, markerList[i].longitude),
    targetDestination
]; 
```

# iphone - 如何在情节提要中启动 window.xib 文件？

> ID：10802820
> 
> 赞同：3
> 
> 时间：2012-05-29T16:09:33.447
> 
> 标签：iphone, ios5, ios4

我是 Xcode 的新手，正在构建我的第一个应用程序，我想合并一个 Twitter 提要，我的项目是在 Storyboard 中完成的，但 Twitter 提要代码使用 .xib，有没有在 Storyboard 中启动 .xib 的好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T19:32:19.447

没有真正需要在情节提要中启动 window.xib。只需以编程方式实例化作为 twitter 提要代码文件所有者的视图控制器，然后将其推送到导航控制器中。它不会引起任何问题。故事板基本上是对以前管理屏幕方式的扩展。您可以在情节提要中拥有所有“场景”，并以编程方式从情节提要外部推送视图控制器而不会出现任何问题并再次导航回来。

UINavigationController 是关键。它只关心它有一个 UIViewController。

# domain-driven-design - 领域驱动设计：应用服务中允许的逻辑

> ID：10802822
> 
> 赞同：1
> 
> 时间：2012-05-29T16:09:39.173
> 
> 标签：domain-driven-design

我有一个问题是如何更好地组织以下功能的实现。假设**用户**需要通过**唯一的**电子邮件和密码注册到系统（第一步），然后他应该确认注册（第二步）。**我有几种选择在应用程序服务/域服务/用户**实体之间构建第一步（注册）的实现，我不确定哪个更好。

**第一个选项：**

应用服务：

```
var existingUser = UserRepository.GetUserByEmail(email);

if (existingUser != null)
{
    throw new ValidationException(...);
}

var newUser = UserFactory.CreateUser();

newUser.Register(email, password);

UserRepository.Save(newUser);

// commit 
```

所以在这里，我们不使用任何域服务。我个人觉得不舒服的是，在应用程序服务中检查了电子邮件唯一性业务规则，这是一个业务规则。

**第二种选择：**

应用服务：

```
var user = UserRegistrationDomainService.RegisterUser(email, password);

UserRepository.Save(user);

// commit 
```

用户注册域服务：

```
User RegisterUser(email, password)
{
  var existingUser = UserRepository.GetUserByEmail(email);

  if (existingUser != null)
  {
    throw new ValidationException(...);
  }

  var newUser = UserFactory.CreateUser();

  newUser.Register(email, password);

  return newUser; 
```

}

我不喜欢这里的是，这个解决方案与第二步的实现不太对称，我们只是从存储库中获取用户并调用 User.ConfirmRegistration()。因此，对于注册确认，我们不需要任何域服务，而对于注册，在第二种选择中，我们使用此类服务​​。

哪个选项更好？第一个选项的应用程序服务是否可以包含电子邮件唯一性验证？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T07:21:56.383

就我个人而言，我认为验证存在于域中（服务的实体）。毕竟，由于业务规则，规则是必需的。

在选项 2 中，应用程序服务最好不负责保存用户，这会模糊职责范围，如果域服务处理它会更好。并且应用程序服务会简单地调用`UserRegistrationDomainService.RegisterUser(email, password)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T12:15:58.260

选项 1 表示唯一电子邮件规则是特定于应用程序的。换句话说，如果您将 Domain dll（或 jar、模块等）在另一个应用程序中重用，则该规则将不再存在。

由于我们可以合理地认为该规则与应用程序无关，因此我会选择选项 2。

另一种解决方案可能是在工厂中实现它。毕竟，这是您通常在创建用户时放置验证逻辑的地方（空/空名称检查、电子邮件格式验证等），那么为什么不将所有创建规则集中在同一个地方呢？

# java - JcomboBox 仅显示一项

> ID：10802825
> 
> 赞同：0
> 
> 时间：2012-05-29T16:09:45.050
> 
> 标签：java, swing, jdbc, jcombobox, recordset

我的代码有什么问题？即使数据库中有更多项目，第二个 JcomboBox 也仅显示一项。它应该是这样工作的：第一个 JcomboBox 填充数据库中的数据，这取决于用户对第一个组合框的选择，第二个填充，然后一些 Jlabels 填充数据，具体取决于从第二个 JcomboBox 中选择的项目。

我试过 if(o == comboBox2) 仍然是同样的问题。

```
@Override
public void actionPerformed(ActionEvent e) {
    Object o = e.getSource();
    if(o == comboBox1) {            
        Object matricule =  comboBox1.getSelectedItem();
        String sqll = "Select  * FROM clients WHERE matricule = " +matricule;               

            try {
                rs = stat.executeQuery(sqll);
                while(rs.next()) {
                    nom.setText(rs.getString("nom"));
                    prenom.setText(rs.getString("prenom"));
                    cin.setText(rs.getString("cin"));
                    adresse.setText(rs.getString("adresse"));                   
                }
            } catch (SQLException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }   

        comboBox2.removeAllItems();

        Object index = comboBox1.getSelectedItem();
        String sql = "Select  distinct p.code FROM parcelle p, clients c WHERE c.matricule = p.exploitant AND c.matricule = " +index;

            try {
                rs = stat.executeQuery(sql);
                while(rs.next()) {
                    System.out.println(rs.getInt("code"));
                    comboBox2.addItem(rs.getInt("code"));
                }
            } catch (SQLException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }           
        return;
    }       

         Object code =  comboBox2.getSelectedItem();  
         String sqll = "Select  * FROM parcelle WHERE code = " +code;  

         try {  
             rs = stat.executeQuery(sqll);                     

             while(rs.next()) {  
                 sau.setText(rs.getString("sau"));  
                 sol.setText(rs.getString("type_sol"));  
                 irrigation.setText(rs.getString("mode_irrigation"));  
                 exploitation.setText(rs.getString("type_exploitation"));                      
             }  

         } catch (SQLException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
        }       
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:17:22.623

您能否确认任何记录中的“代码”值都不为空？从事物的声音来看，第二条记录中“代码”的值为 null （或任何其他无法解析为 int 的值），这会导致异常。

# java - Web 应用程序和多线程

> ID：10802833
> 
> 赞同：3
> 
> 时间：2012-05-29T16:10:24.420
> 
> 标签：java, ajax, multithreading, web-applications

我正在将桌面应用程序 (WinForm) 移植到 Web 应用程序 (Java/Spring/JPA)。问题很多，我有点挣扎......

现在的问题是线程！

在执行从数据库导出某些数据的原始应用程序中，有一个进度条指示进程的进度。

我想将此进度条移植到新的 Web 应用程序中。为此，我想到了使用 AJAX 并使用单独的线程来运行数据导出。

主要担忧是：

*   我是否遵循正确的方法？在 Web 应用程序中使用多线程是否存在问题？
*   如果在导出过程中按下 F5 或刷新按钮，究竟会发生什么？我怎样才能停止这个过程？
*   如何定期更新进度条？我必须通过 ajax 调用服务器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:19:59.187

我主要是一名 ASP.Net 开发人员，但根据我对 HTTP 协议的了解，这并不是解决问题的方法。我已经看到了很多相当聪明的解决方案，但最终很清楚的是，HTTP 协议根本不是为了这样工作而设计的。

显然，您知道 Flash 或 Silverlight 应用程序可以做到这一点，但这也带来了一系列问题。

我自己更喜欢将所有奇怪的东西都保留在服务器上。过去，我不得不想出一种方法来通过 Web 应用程序发送数千封电子邮件，并让用户了解它的进展情况。我设计了一组表来充当队列。Web 应用程序将简单地将任何交付请求放在此队列中，进度条将由检查队列中项目状态的请求确定。在后台运行的是一个 Windows 服务，它也会检查这个队列，并且实际上负责传递邮件并在每个项目完成或失败时设置它的状态。

开发有点困难，因为 Windows 服务可能很棘手，但一旦启动并运行，它就非常流畅和可靠。根据您的情况，设置为每隔几分钟运行一次的简单计划任务可能会为您解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:26:31.337

我不一定会直接跳到为导出显式运行单独的线程。虽然这样做是理想的，但 Web 容器的能力将成为一个限制因素。您的传统 Java EE 应用程序服务器通常不鼓励为此生成线程（尽管您可以为此连接到线程池）。一些容器非常擅长在工作完成之前将线程从阻塞中释放出来（例如，使用 Jetty 和 Camel 的 Karaf），以便它们可以在导出发生时为其他 Web 请求提供服务。但我的猜测是，在收到响应之前，您可能对“开始导出”线程阻塞没有问题。

这个出口需要多长时间？几秒钟，还是我们在这里谈论接近几分钟？如果它更短，我认为只需在其上放置一个带有小圆形微调器的小“等待”图标（使用您最喜欢的 Ajax 库，无论如何）就足够了。

如果您真的想要一个定期刷新的真实状态栏，那么是的，您必须以某种频率轮询它。大概这可能是一个简单的请求，它将从该作业 ID 的数据库表中加载作业的某种进度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T16:20:26.727

在线查找我的答案

**我遵循正确的方法？在 Web 应用程序中使用多线程有问题**吗？

- 是的，你在正确的道路上。不，在 web 应用程序中的多线程中没有这样的问题，它就像在 WinForm 中一样简单。代替使用 Dispatcher 来更新 UI，您将进行 AJAX 调用并使用 javascript 进行 DOM 操作。

**如果在导出过程中按下 F5 或刷新按钮，究竟会发生什么？我如何停止这个过程？**

- 不幸的是，没有简单的方法。标准方式是，当此类处理完成并且用户点击 F5 时，您将显示一个对话框（在 javascript 的帮助下）并通知用户该作业仍在运行。如果用户仍然想刷新，那么您已经向服务器发出另一个请求以取消任务。（您需要将线程 ID 或取消令牌存储在某个地方以取消任务）

**如何定期更新进度条？我必须通过 ajax 调用服务器吗？**

- 标准方式是，通常您显示加载图像。如果您想显示上下文相关的进度条，则意味着您必须进行轮询。这是 Dino Espito 的一个例子。虽然它在 ASP.NET 中，但您可以理解 [Dino Espito的基本原理](http://msdn.microsoft.com/en-us/magazine/hh580729.aspx)

# javascript - 正则表达式 - 从文本输入中删除美元符号

> ID：10802836
> 
> 赞同：2
> 
> 时间：2012-05-29T16:10:31.650
> 
> 标签：javascript, html, regex, onkeyup

我有以下 onkeyup 命令来测试和删除字母逗号和美元符号：

```
onkeyup="if (/(?:[a-zA-Z]|\s|,|\$)+/ig.test(this.value)) this.value = this.value.replace(/(?:[a-zA-Z]|\s|,|\$)+/ig,'')" 
```

它适用于除美元符号之外的所有内容。

有人可以帮我吗？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:19:21.770

如果您试图将任意字符串清理为一个数字，您将通过用空字符串替换不是数字的所有内容（假设您想要一个整数）来减少边缘情况。

```
this.value = this.value.replace( /[^0-9]/, '' ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T16:14:20.110

**HTML**将您的反斜杠解释为转义内联 html 字符串，而不是正则表达式。以下代码打印`$`.

```
<body onload='alert("\$");'> // prints '$', not '\$' 
```

您需要转义两次，或将正则表达式移出内联 html 并移入函数中。

我相信正确的答案是替换`\$`为`\\$`，如下：

```
onkeyup="if (/(?:[a-zA-Z]|\s|,|\\$)+/ig.test(this.value)) this.value = this.value.replace(/(?:[a-zA-Z]|\s|,|\$)+/ig,'')" 
```

# security - 验证 PowerShell PSCredential

> ID：10802850
> 
> 赞同：11
> 
> 时间：2012-05-29T16:11:26.323
> 
> 标签：security, powershell

假设我`PSCrendential`在 PowerShell 中有一个使用`Get-Credential`.

如何针对 Active Directory 验证输入？

现在我找到了这种方式，但我觉得它有点难看：

```
[void][System.Reflection.Assembly]::LoadWithPartialName("System.DirectoryServices.AccountManagement")

function Validate-Credentials([System.Management.Automation.PSCredential]$credentials)
{
    $pctx = New-Object System.DirectoryServices.AccountManagement.PrincipalContext([System.DirectoryServices.AccountManagement.ContextType]::Domain, "domain")
    $nc = $credentials.GetNetworkCredential()
    return $pctx.ValidateCredentials($nc.UserName, $nc.Password)
}

$credentials = Get-Credential

Validate-Credentials $credentials 
```

**[编辑，两年后]**对于未来的读者，请注意`Test-Credential`or`Test-PSCredential`是更好的名称，因为`Validate`它不是有效的 powershell 动词（请参阅`Get-Verb`）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T16:33:00.490

我相信使用`System.DirectoryServices.AccountManagement`是不那么丑陋的方式：

这是使用 ADSI（更丑？）：

```
$cred = Get-Credential #Read credentials
$username = $cred.username
$password = $cred.GetNetworkCredential().password

# Get current domain using logged-on user's credentials
$CurrentDomain = "LDAP://" + ([ADSI]"").distinguishedName
$domain = New-Object System.DirectoryServices.DirectoryEntry($CurrentDomain,$UserName,$Password)

if ($domain.name -eq $null)
{
 write-host "Authentication failed - please verify your username and password."
 exit #terminate the script.
}
else
{
 write-host "Successfully authenticated with domain $domain.name"
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-26T07:53:27.717

我在安装程序时遇到了类似的问题，需要验证提供的服务帐户详细信息。我想避免在 Powershell 中使用 AD 模块，因为我不是 100% 会安装在运行脚本的机器上。

我使用下面的方法进行了测试，它有点脏，但确实有效。

```
try{
    start-process -Credential $c -FilePath ping -WindowStyle Hidden
} catch {
    write-error $_.Exception.Message
    break
} 
```

# nservicebus - NServiceBus 发送消息未出现在端点

> ID：10802858
> 
> 赞同：2
> 
> 时间：2012-05-29T16:12:01.473
> 
> 标签：nservicebus

我在 NServiceBus 3 中遇到问题。

我正在尝试将消息发送到端点。消息类型和端点在配置中配置为

```
<UnicastBusConfig>
    <MessageEndpointMappings>
        <add Messages="GatewayMessages.ProcessAttachmentCommand, GatewayMessages" Endpoint="Attachments"/>
    </MessageEndpointMappings>
</UnicastBusConfig> 
```

端点在其 EndpointConfig.cs 中具有以下配置：

```
 Configure
            .With()
            .DefineEndpointName("Attachments")
            .DefaultBuilder()
            .DBSubcriptionStorage()
            .XmlSerializer()
            .FileShareDataBus(@"C:\Attachments\nservicebus\databus")
            .MsmqTransport()
            .UnicastBus()
            .LoadMessageHandlers()
            .CreateBus()
            .Start(() => Configure.Instance.ForInstallationOn<NServiceBus.Installation.Environments.Windows>().Install()); 
```

我也有一个`IMutateTransportMessages`配置有的类

```
 Configure.Instance.Configurer.ConfigureComponent<TransportMessageCompressionMutator>(DependencyLifecycle.InstancePerCall); 
```

我遇到的问题是当使用 ProcessAttachmentCommand 调用 Bus.Send 时，端点没有收到任何东西。随着端点停止，我什至没有看到端点队列中出现任何消​​息。

`MutateOutgoing`在 I 的方法中有一个断点，`TransportMessageCompressionMutator`我可以看到传出消息，所以看起来调用`Bus.Send`是可以的，但它似乎没有到达端点。

除了我所包含的配置之外，还有其他可能影响消息传递的地方吗？有什么方法可以在消息级别查看它们被引导到哪里？

我的 NServiceBus 主机没有记录任何错误，就像消息正在消失一样。最混乱的！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T15:51:41.007

原来这是由于更改`MessageEndpointMappings`. 我在问题中发布的版本实际上并不是正在使用的版本。这是实际版本：

```
<UnicastBusConfig>
    <MessageEndpointMappings>
        <add Messages="GatewayMessages.ProcessAttachmentCommand, GatewayMessages" Endpoint="Attachments"/>
        <add Messages="GatewayMessages" Endpoint="Services.Saga"/>
    </MessageEndpointMappings>
</UnicastBusConfig> 
```

第二个`MessageEndpointMappings`已经进入，NSB 正在使用该配置来确定`GatewayMessages`程序集中所有消息类的目的地。

啊，人为错误！

# java - 如何将值传递给父 tabgroupactivity？

> ID：10802859
> 
> 赞同：0
> 
> 时间：2012-05-29T16:12:15.417
> 
> 标签：java, android, android-activity, activitygroup

我有一个 tabGroupActivity。在这个 tabGroupActivity 中，我以这种方式启动了一个名为“pideInformacion”的新活动：

```
Intent intent = new Intent(getParent(), pideInformacion.class);
TabGroupActivity parentActivity = (TabGroupActivity)getParent();
parentActivity.startChildActivity("pideInformacion", intent); 
```

然后，应用程序从 pideInformacion 类打开一个名为 verMapaGps 的新活动：

```
Intent intent = new Intent(this, verMapaGps.class);
TabGroupActivity parentActivity = (TabGroupActivity)getParent();
parentActivity.startChildActivity("verMapaGps", intent); 
```

我希望在 verMapaGps 中设置字符串值以返回 pideInformacion 类。

我看到这种访问父活动的方式，但我不知道如何访问父活动值来设置它。

```
Activity pideInfoActivity = (pideInformacion) getParent(); 
```

我无法使用 startActivityForResult，因为如果我使用这种方法，tabhost 会隐藏，而我想要的 tabbar 会显示在整个应用程序中。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T03:19:58.907

尝试将字符串作为静态变量并在父活动中使用。

# emacs - 在 emacs 中，如何在要突出显示的字符串中获取 ${VARIABLE} ？

> ID：10802864
> 
> 赞同：2
> 
> 时间：2012-05-29T16:12:31.597
> 
> 标签：emacs, syntax-highlighting

在终端中使用 emacs，在 BASH 中编程时，`${VARIABLE}`会突出显示：

```
#!/bin/sh
.
.
.
ls ${VARIABLE}
.
.
. 
```

但`"${VARIABLE}"`没有，如：

```
#!/bin/sh
.
.
.
ls "${VARIABLE}"
.
.
. 
```

在上面，`${VARIABLE}`仅作为字符串突出显示；也就是说，字符串内的变量没有以不同的方式突出显示。

我需要在我的 .emacs 文件中添加什么以确保它正确突出显示？

# python-3.x - Mint 10 上没有与 python 3.1.2 一起提供的 argparse 模块

> ID：10802865
> 
> 赞同：1
> 
> 时间：2012-05-29T16:12:34.420
> 
> 标签：python-3.x

为什么会这样：

```
$ python3
Python 3.1.2 (release31-maint, Dec  9 2011, 20:50:50) 
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import argparse
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named argparse 
```

我安装 python3 正是因为我想使用 argparse，它是 2.7 中的新功能，而 Ubuntu Server 10.04 上的默认版本是 2.6。我注意到的另一件事：Mint 10 带有 python 2.6.6，它*确实*包含 argparse，而 ubuntu-server 10.04 附带的确切版本是 2.6.5，它没有 argparse。另外，我注意到在我的 Ubuntu 12.04 机器上，python3 是 3.2.3，这确实带有 argparse。为什么这个模块不包含在 3.1.x 中？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:22:09.190

尽管`argparse`仅在 Python 2.7 和 Python 3.2 上将其纳入标准库，但对于较旧/其他版本，您仍然可以从[pypi](http://pypi.python.org/pypi/argparse)获取它。

请记住，尽管此版本可能不包括自 argparse 合并到标准库以来发生的所有更新（正如[原始项目网页上所](http://code.google.com/p/argparse/)解释的那样）。

# c# - 我可以冻结silverlight SolidColorBrush 吗？

> ID：10802866
> 
> 赞同：0
> 
> 时间：2012-05-29T16:12:37.140
> 
> 标签：c#, silverlight, system.windows.media

我有一个想要优化的 Silverlight 应用程序！

我是否正确地假设减少类型的新对象的数量`System.Window.Media.SolidColorBrush`可能是一个优势？（我说的是数千……）

我希望只使用几个实例，比如 16 种颜色。

此外，我想冻结画笔，但该选项不可用！而且我无法添加 PresentationCore dll。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T11:24:14.250

显然不是：

检查[http://www.charlespetzold.com/blog/2008/11/Text-on-a-Path-in-Silverlight.html](http://www.charlespetzold.com/blog/2008/11/Text-on-a-Path-in-Silverlight.html)以进一步阅读...

在银光下大失所望

# epub - 提取 ePub 摘录

> ID：10802868
> 
> 赞同：1
> 
> 时间：2012-05-29T16:12:43.097
> 
> 标签：epub

我已经阅读了有关 ePub 格式、标准、结构、阅读器、工具和可用的开发人员技术来操作/转换/创建 ePub，但是（到目前为止）还没有一个*神奇的功能*来提取特定长度的字符来创建该书的摘录。这正是我正在寻找的：一种提取 ePub 的前 X 个单词的方法。

*   我正在考虑的第一种方法（不是我最喜欢的顺便说一句）是创建一个解析器来读取所有 ePub 元数据并开始以正确的顺序解析 xml 文件，直到我有足够的单词来创建确定的 ePub 的摘录（我将不胜感激这个方向的一些反馈）

*   第二种方式（到目前为止我找不到）是一个现有的工具/函数或解析器（任何语言），它（希望）返回 ePub 的纯文本，这样我就可以收集前 X 个单词以创建我的摘抄。

你知道有什么工具可以帮助我实现第二种选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-16T21:26:34.207

你应该看看 Apache Tika：[http](http://tika.apache.org/) ://tika.apache.org/ 你可以从命令行使用它，或者作为一个 java 库，甚至在服务器模式下从 ePub 中提取文本。希望这会有所帮助，F.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T07:23:10.923

何塞，我不知道有任何工具可以做你想做的事。不过，让我评论一下您的第一种方法。如果你确实找到了一个工具，我希望这些评论能让你评估它。

我认为你的方法很好，如果你想做好创建提取的工作，你可能还是想拥有这一步。我建议你，

*   获取 OPF 文件并查找 GUIDE 部分。如果存在 GUIDE 部分，请检查给定的类型。有些可能与摘录无关（封面、标题页、版权页）。许多书籍不会明确说明类型，但这应该有助于它们的类型。
*   现在按顺序浏览 SPINE 部分中的文件，排除任何不相关的内容，并阅读足够多的 XHTML 文件以获取摘录。
*   而在 OPF 文件中，如果这与摘录相关，则获取一堆元数据（标题、创建者、日期是强制性的，我认为，一些作者还会放入一大堆其他元数据，例如关键字）。

如果您正在使用此摘录创建一个迷你 EPUB，您将需要选择在用于制作摘录的 XHTML 文件中引用的任何 CSS、音频、视频、图像和自定义字体文件。您甚至可以选择使用原始封面文件作为摘录 epub 的封面文件。

如果您使用带有朗读等有趣内容的固定版式书籍，并且您想创建一个迷你 EPUB 作为摘录，那么您最好使用页数而不是字数。不要忘记在您的摘录中包含任何 SMIL 文件并使其看起来不错：(i) 不要拆分两页的跨页和 (ii) 如果原始页面为奇数，请确保第一页是奇数页或者即使在原件中编号为偶数 - 为此您可能需要添加一个空白填充页（奇数/偶数错误，随后的两页跨页不会彼此面对）

我希望这会有所帮助。

# javascript - 为什么 Android WebView.loadDataWithBaseUrl() 无法渲染 JavaScript？

> ID：10802878
> 
> 赞同：4
> 
> 时间：2012-05-29T16:13:12.497
> 
> 标签：javascript, android, webkit

给定这个页面： http: [//music.10086.cn/newweb/qk/guoso/1C5DB9AC5C346441/t/6.html](http://music.10086.cn/newweb/qk/guoso/1C5DB9AC5C346441/t/6.html)

打开 JavaScript 的 WebView 可以使用 loadUrl() 正确打开它并呈现 JavaScript。

但是，如果页面内容是使用 HTTP 客户端单独加载的，并在设置了基本 URL 的情况下提供给 loadDataWithBaseUrl()，则 JavaScript 无法正常工作：

```
// store http://music.10086.cn/newweb/qk/guoso/1C5DB9AC5C346441/t/6.html into data

webView.loadUrl("http://music.10086.cn/", data, "text/html", "UTF-8", null); 
```

我怀疑远程脚本没有加载。我怎样才能让 WebView 记录这个？

这是在 Android Ice Cream Sandwich 4.0.3 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-21T11:04:08.640

有几件事需要仔细检查：

1.  您已包含`<uses-permission android:name="android.permission.INTERNET" />`在`AndroidManifest.xml`
2.  你打电话给`webView.getWebSettings.setJavaScriptEnabled(true);`
3.  您的 HTML 格式正确

以下代码对我有用，从[http://code.jquery.com/](http://code.jquery.com/)加载 jquery ：

```
@Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    setContentView(R.layout.main);
    mWebView = (WebView) findViewById(R.id.webview);
    WebSettings webSettings = mWebView.getSettings();
    webSettings.setJavaScriptEnabled(true);
    mWebView.setWebChromeClient(new MyWebChromeClient());
    String mimeType = "text/html";
    String encoding = "utf-8";
    String html = "<html>  "
      + "<script src='jquery-1.10.1.min.js'></script>"
      + "<script language='javascript'>"
      + "function sayHello() {       "
      + "alert(typeof($));    "
      + "}  </script>  "
      + "<body>    "
      + "   <a onClick='sayHello()'><div style='width:80px; "
      + "   margin:0px auto;  " + "  padding:10px;    "
      + "text-align:center;   " + " border:2px solid #202020;' > "
      + "<br> "
      + "    Click me!   " + "</div></a> " + " </body>" + " </html>";
    mWebView.loadDataWithBaseURL("http://code.jquery.com/", html, mimeType, encoding,null);
} 
```

# php - 用php调用命令行程序

> ID：10802881
> 
> 赞同：-1
> 
> 时间：2012-05-29T16:13:28.837
> 
> 标签：php, command-line

我有一个程序在我的命令行上运行。该程序允许输入用户名并返回一堆与该用户有关的信息。我假设可以从 php 访问该程序，甚至可以将信息存储在变量中。有人知道*怎么*做吗？

提前感谢您的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:16:22.107

尝试使用`system()`命令。

[http://php.net/manual/en/function.system.php](http://php.net/manual/en/function.system.php)

或者`exec()`

[http://www.php.net/manual/en/function.exec.php](http://www.php.net/manual/en/function.exec.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:16:40.847

阅读[system()](http://php.net/manual/en/function.system.php)和[exec()](http://php.net/manual/en/function.exec.php)的文档，它应该是你需要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T16:18:03.670

这个[链接](http://php.net/manual/en/function.exec.php)应该可以帮助你。一个简单的例子：

```
<?php
  $out = array();
  exec = ('ls /ver 2>&1', $out);
  print_r($out);
?> 
```

# php - 操作数类型冲突：datetime2 与 int (Between) 不兼容

> ID：10802882
> 
> 赞同：4
> 
> 时间：2012-05-29T16:13:29.520
> 
> 标签：php, sql, sql-server, codeigniter

我正在尝试获取两个日期之间的记录，但是当我运行 SQL 时，出现以下错误：

操作数类型冲突：datetime2 与 int 不兼容

```
SELECT M.Id, M.MTimeInt, M.Date, CAST(D.Name AS TEXT) as Name 
FROM C 
JOIN N ON C.N_Id=N.Id 
JOIN M ON M.N_Id=N.Id 
JOIN MDish ON MDish.M_Id=M.Id 
JOIN D ON D.Id=MDish.D_Id 
WHERE C.Id=110 AND M.Date BETWEEN 2012-05-28 AND 2012-06-08 
```

SQL 看起来是正确的，但我似乎无法弄清楚它为什么抱怨，知道吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T16:14:17.570

尝试：

```
BETWEEN '2012-05-28' AND '2012-06-08' 
```

否则它是`2012 minus 05 minus 28`，它等于`1979`并且是一个整数而不是日期。

# gtk - gtk_widget_grab_focus() 自动跳转到下一个字段？

> ID：10802885
> 
> 赞同：0
> 
> 时间：2012-05-29T16:13:35.383
> 
> 标签：gtk, gtkentry

我正在使用 glade 和 gtk 创建一个“C”项目。我想关注一个名为 txt_abc 的 gtkentry 字段，因此我调用了该函数：

```
gtk_widget_grab_focus (txt_abc); 
```

在 txt_abc 小部件命名为 txt_def 之后还有另一个 gtkentry 小部件。

我的问题是，当我运行应用程序时，光标自动聚焦在 txt_def 小部件上，而不是关注 txt_abc 小部件。

还有一件事，当我通过调用代码将焦点设置在 txt_def 小部件时：

```
gtk_widget_grab_focus (txt_def); 
```

控件再次集中在窗口上的下一个小部件上，即 txt_name。

我希望将焦点完全放在我正在设置抓取信号的小部件上。

如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T20:19:35.500

无法重现。写一个小测试用例来展示你的问题。Python 很容易进行实验。

```
import gtk

window = gtk.Window ()
box    = gtk.VBox ()

window.add (box)
for k in range (5):
   box.add (gtk.Entry ())

window.show_all ()
window.connect ('destroy', lambda *ignored: gtk.main_quit ())

box.children () [2].grab_focus ()  # <--- works fine

gtk.main () 
```

# java - Java 的 SHA1 哈希与 Perl 的不匹配

> ID：10802887
> 
> 赞同：1
> 
> 时间：2012-05-29T16:13:49.770
> 
> 标签：java, perl, sha1

如何让 Java 的 MessageDigest.digest() 结果与 Perl 的 sha1->digest 匹配？MessageDigest.digest() 采用 string.getBytes() 在 Perl 中我只是将一个字符串传递给 sha1 对象。这就是它失败的原因吗？

爪哇：

```
String mystring ="zWh9YZX3";
MessageDigest.getInstance("SHA-1").digest(mysrting.getBytes()) 
```

珀尔：

```
$mystring ="zWh9YZX3";  
$sha1 = Digest::SHA1->new;
$sha1->add($mystring);
$digest = $sha1->digest; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T16:39:28.870

我在 Perl 和 Java 上得到了同样的结果。

```
$ perl x.pl | od -t x1
0000000 f7 d4 ae 4d bd df 5a d3 61 65 bb f8 be 60 45 03
0000020 e4 82 9d b6
0000024

$ javac x.java && java x | od -t x1
0000000 f7 d4 ae 4d bd df 5a d3 61 65 bb f8 be 60 45 03
0000020 e4 82 9d b6
0000024 
```

`x.pl`：

```
use Digest::SHA1;
my $bytes ="zWh9YZX3";  
my $sha1 = Digest::SHA1->new;
$sha1->add($bytes);
print $sha1->digest; 
```

`x.java`：

```
import java.security.MessageDigest;

class x {
    public static void main(String[] args) throws Exception {
        MessageDigest sha1 = MessageDigest.getInstance("SHA-1");
        String mystring ="zWh9YZX3";
        byte[] bytes = mystring.getBytes();
        byte[] hash = sha1.digest(bytes);
        System.out.write(hash, 0, hash.length);
    }
} 
```

请注意，您不是在散列相同的东西。在 Perl 代码中，您正在对字节进行哈希处理`zWh9YZX3`。在 Java 代码中，您正在散列环境特定的字符编码`zWh9YZX3`。如果碰巧有大于 127 的字节，结果会有所不同。

上面 Java 的 Perl 等价物是：

```
use Digest::SHA1;
use Encode;
my $mystring ="zWh9YZX3";  
my $bytes = encode('???', $mystring);
my $sha1 = Digest::SHA1->new;
$sha1->add($bytes);
print $sha1->digest; 
```

`use utf8;`如果您的源代码使用 UTF-8 编码，请不要忘记使用。（否则，它实际上应该是 iso-8859-1。）

* * *

以十六进制形式处理摘要：

```
use strict;
use warnings;
use Digest::SHA1 qw( sha1_hex );

my $bytes = "zWh9YZX3";
my $digest_hex = sha1_hex($bytes);

print("INSERT INTO Foo VALUES (UNHEX('$digest_hex'))\n"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:27:25.693

检查字符串的编码，在 Java 中 string.getBytes() 将使用默认的平台编码，这可能与 perl 函数使用的编码不同。您必须确保对两个平台使用相同的编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T16:22:19.240

直观地比较哈希值。可能它们在框架上有所不同，这很容易看到和修复。如果代码完全不同，则检查输入数据的“盐”和/或二进制格式。

# qt - 在 Windows 上以管理员身份运行 Qt 应用程序

> ID：10802889
> 
> 赞同：6
> 
> 时间：2012-05-29T16:13:59.413
> 
> 标签：qt, exe, administrator

有没有办法以管理员身份运行 Qt 应用程序？我的应用程序有一个自动更新程序。它需要管理员权限才能替换 Program Files 文件夹中的文件，因此需要管理员权限。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-29T20:41:02.187

以管理员权限运行应用程序与 Qt 没有太大关系。有两种方法。

“简单”的一种是手动设置您的应用程序以管理员权限运行。您可以通过右键单击可执行文件来执行此操作。然后在“兼容性”选项卡上，您可以在“权限级别”下选择“以管理员身份运行此应用程序”。

但是，如果您想自动实现相同的目标，则必须将清单嵌入到您的应用程序中。您正在寻找的是设置`requestedExecutionLevel`to `requireAdministrator`。可以[在 MSDN](http://msdn.microsoft.com/en-us/library/bb756929.aspx)或[UAC 上的此 Wikipedia 条目](http://en.wikipedia.org/wiki/User_Account_Control)中找到更多信息。

对于您在 Qt Creator 中构建的应用程序，这意味着您需要通过在资源 (.rc) 文件中包含对它的引用来嵌入清单。然后可以通过指定 .pro 将此资源文件添加到您的 .pro 文件中`RC_FILE = myapp.rc`。关于这个问题的一篇信息丰富的博客文章[是这个](http://blog.strixcode.com/2010/08/embedding-application-manifest-and.html)，以及QtCentre 论坛上的[这篇文章。](http://www.qtcentre.org/threads/46917-How-to-run-application-in-qt-as-administrator)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-09-15T22:20:59.160

如果您使用的是`MSVC`工具包，一个非常简单的解决方案是将以下内容添加到项目文件中：

```
QMAKE_LFLAGS_WINDOWS += "/MANIFESTUAC:\"level='requireAdministrator' uiAccess='false'\"" 
```

我正在使用`Qt 5.12 msvc2017`.

我发现这非常简洁，正如我在 generated 中看到的那样`Makefile`，Qt 已经添加了一些与清单相关的链接标志，并且这种方法不会干扰已经嵌入的清单，因为从现有文件中手动添加清单。

可以轻松添加其他清单链接选项。您可以阅读 VS 编译器的文档，和/或您可以检查 Visual Studio IDE 必须提供的标志/选项`Project properties/Linker/Manifest File`，然后检查`Command Line`链接器的部分以查看它是如何添加它们的。

不确定这将如何在`gcc`或`clang`构建中完成，它可能需要@H Aßdøµ 和 @Bart 提供的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-28T00:19:09.800

从提到 @Bart 先生的文章中：

**应用清单**

首先，我们必须准备一个应用程序清单文件。以下这一项适用于不需要管理员权限的应用程序：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
  <assemblyIdentity version="2.0.2.0" processorArchitecture="X86" type="win32"/>
  <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
    <security>
      <requestedPrivileges>
        <requestedExecutionLevel level="asInvoker" uiAccess="false"/>
      </requestedPrivileges>
    </security>
  </trustInfo>
</assembly> 
```

其次，我们需要`MT.exe`来自 Microsoft Windows SDK 的工具来将此 XML 嵌入到我们的可执行文件中。为此，请使用以下命令：

```
mt.exe –manifest MyApp.exe.manifest -outputresource:MyApp.exe;1 
```

**自动清单嵌入**

每次编译后手动执行 mt 命令是一项繁琐的任务。说服 qmake 为我们做这件事怎么样？在研究了文档之后，看起来下面的行应该可以解决问题：

```
win32 {
    WINSDK_DIR = C:/Program Files (x86)/Microsoft SDKs/Windows/v7.0A
    WIN_PWD = $$replace(PWD, /, \\)
    OUT_PWD_WIN = $$replace(OUT_PWD, /, \\)
    QMAKE_POST_LINK = "$$WINSDK_DIR/bin/x64/mt.exe -manifest $$quote($$WIN_PWD\\$$basename(TARGET).manifest) -outputresource:$$quote($$OUT_PWD_WIN\\${DESTDIR_TARGET};1)"
} 
```

上述代码将自动从 WINSDK_DIR 执行 mt.exe 程序，并嵌入一个位于项目根目录并以项目目标命名的清单文件（即 MyApp.manifest）。这就是添加清单的全部内容，现在让我们继续并指定版本信息。

**原帖：http:** [//blog.strixcode.com/2010/08/embedding-application-manifest-and.html](http://blog.strixcode.com/2010/08/embedding-application-manifest-and.html)

# html - 放置一个总是在顶部而不是在中心的元素

> ID：10802895
> 
> 赞同：4
> 
> 时间：2012-05-29T16:14:20.613
> 
> 标签：html, css

我有一个有 2 列的表

```
<table border="2">
  <tr>
    <td>
        <div id="menupage" >
            ...
            ...
        </div>
    </td>

    <td align="center"  >   

        <div id="contentpage" >
            ...
            ...
        </div>

    </td>   
  </tr>
</table> 
```

`<div id="contentpage" >`如果尺寸很大，我想始终保持在顶部而不是中心

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-29T16:17:46.793

您可以使用该`CSS` `vertical-align`属性将`TD`内容对齐到`TOP`：

> 垂直对齐：顶部；

请参阅此工作[小提琴示例](http://jsfiddle.net/zuul/PSrcS/)！

**例如，**

```
<table border="2">
  <tr>
    <td style="vertical-align:top;">
      <div id="menupage">
        ...
      </div>
    </td>
    <td align="center" style="vertical-align:top;">   
      <div id="contentpage" >
        ...
      </div>
    </td>   
  </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T16:20:04.030

如果您要使用表格，那么您不妨只使用`valign`.

例如：`<div id="menupage" valign="top">`

如果你想使用 CSS，你可以使用`vertical-align`.

您可以像这样在样式表中设置所有 td：

```
td {
    vertical-align: top;
} 
```

我不知道您的经验等，所以我不会继续，但是您应该避免使用表格进行布局。你会为自己节省很多反对票和“不要使用表格”的评论。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T16:23:47.023

您可能正在查看`valign`或`vertical-align`。

```
<td align="center" valign="top">
    <div id="contentpage">
    </div>
</td> 
```

见[http://jsfiddle.net/nivas/Y84pS/](http://jsfiddle.net/nivas/Y84pS/)

请注意，这`valign`是一个[已弃用的属性](http://www.w3.org/TR/html4/struct/tables.html#adef-valign)（`align`和 和 也是如此`border`。有关完整列表，请参阅[属性索引](http://www.w3.org/TR/html4/index/attributes.html)。）。获得这些功能的推荐方法是通过 CSS，`vertical-align`使用`text-align`和`border`.

我的 jsfiddle 示例中的第二个表使用 CSS，并获得相同的功能。

# java - Java中的休眠映射

> ID：10802898
> 
> 赞同：0
> 
> 时间：2012-05-29T16:14:25.750
> 
> 标签：java, hibernate, hibernate-mapping

我有一个休眠映射类，它将现有的 java 类（比如 A）映射到一个表。java 类的属性之一是另一个 java 类（比如 AA ），它使用 hibernate 映射文件中的 component 属性进行映射。AA 类中只有一个属性，它映射到表中的一个属性。我想知道当该属性在表中为空时会发生什么。执行映射时，是否会在 A 类的最终对象中创建 AA 类的实例？在我的代码中，我看到没有创建实例，并且 A 类的属性仍然为空。有没有办法在休眠映射文件中指定一个参数来实例化对象（即使它的映射属性在表中为空）。

我正在使用 Java 1.6 和休眠 3

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:23:23.507

基于休眠指南，

```
The null value semantics of a component are ad hoc. When reloading the containing object, Hibernate will assume that if all component columns are null, then the entire component is null. This is suitable for most purposes. 
```

但作为一种潜在的解决方法，您可以为该属性添加一些 sql 公式，这样可以确保创建 AA 实例。

# ios - 绘制渐变作为视图的背景而不进行子类化

> ID：10802899
> 
> 赞同：0
> 
> 时间：2012-05-29T16:14:47.057
> 
> 标签：ios, cocoa-touch, core-graphics

我正在使用[此处描述](https://stackoverflow.com/questions/844710/make-background-of-uiview-a-gradient-without-sub-classing)的方法为 vanilla`UIView`实例设置渐变背景，而无需创建子类。然而，视图完全是黑色的。这是我的代码：

```
UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 315.0f, 44.0f)];

CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
CGContextRef context = CGBitmapContextCreate(NULL, 315.0, 44.0f, 8, 4 * 315, colorSpace, kCGImageAlphaNoneSkipFirst);

// Colors only for debugging purposes
CGColorRef startColor = (__bridge CGColorRef)[UIColor greenColor];
CGColorRef endColor = (__bridge CGColorRef)[UIColor redColor];
CFMutableArrayRef colors = CFArrayCreateMutable(kCFAllocatorDefault, 2, &kCFTypeArrayCallBacks);
CFArrayAppendValue(colors, startColor);
CFArrayAppendValue(colors, endColor);

CGGradientRef gradient = CGGradientCreateWithColors(colorSpace, colors, (const CGFloat []){0.25f, 0.75f});

CGContextDrawLinearGradient(context, gradient, CGPointZero, CGPointMake(0.0f, 44.0f), 0);

CGImageRef cgImage = CGBitmapContextCreateImage(context);

UIImage *backgroundGradient = [UIImage imageWithCGImage:cgImage];
[view setBackgroundColor:[UIColor colorWithPatternImage:backgroundGradient]];

CFRelease(colors);
CGGradientRelease(gradient);
CGImageRelease(cgImage);
CGColorSpaceRelease(colorSpace);
CGContextRelease(context);
return view; 
```

我相信上下文分配可能有问题，因为创建的图像返回所需大小（315x44）。我错过了什么？我还能检查什么可以帮助我调试这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:26:00.390

这不是你得到`CGColorRef`你需要做的事情的方式

```
[UIColor redColor].CGColor 
```

# iphone - 发送带有图像的 http post 请求时出错

> ID：10802900
> 
> 赞同：3
> 
> 时间：2012-05-29T16:14:53.830
> 
> 标签：iphone, ios, xcode, http, post

几天以来我一直陷入这个问题，我真的需要你的帮助。

我实际上是在尝试通过 php 脚本将文件从我的 iphone 应用程序上传到网络服务器。

这是我在 Xcode 中的方法：

```
-(void)sendPost{
    UIImageView *imageView = [[UIImageView alloc] init];
    imageView.image = [UIImage imageNamed:@"back.png"];

    NSData *imageData = UIImageJPEGRepresentation(imageView.image, 90);
    NSString *urlString = @"myscriptishere.php";
    NSMutableURLRequest *request = [[NSMutableURLRequest alloc]init];
    [request setTimeoutInterval:60.0];
    [request setURL:[NSURL URLWithString:urlString]];
    [request setHTTPMethod:@"POST"];

    NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
    [request addValue:contentType forHTTPHeaderField:@"Content-Type"];

    NSMutableData *body = [NSMutableData data];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];

    [body appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"userfile\";filename=\"myfile.png\"\r\n"] 
dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[NSData dataWithData:imageData]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];

    [request setHTTPBody:body];
    NSLog(@"%@",[[NSString alloc] initWithData:[NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil] encoding:NSUTF8StringEncoding]);
    // Do any additional setup after loading the view.

} 
```

我的php代码是：

```
<?php
    $domainpath = $_SERVER['DOCUMENT_ROOT'];
    $target = "./upload";
    $public = "/public/upload/";
    $target = $target.basename( $_FILES['userfile']['name']) ;
    $check = getimagesize($_FILES['userfile']['tmp_name']);

    if (move_uploaded_file($_FILES["file"]["tmp_name"],
                           $domainpath. $public . $_FILES["file"]["name"]))
    echo "YES";

    else
    echo "NO";

    ?> 
```

我总是收到（几秒钟后，所以我想我正在上传一些东西）服务器回复“不”。

我已经检查了我对要写入的文件夹的权限。

关于问题可能隐藏在哪里的任何想法？

提前感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:21:04.293

你的问题在这里：

```
NSString *urlString = @"myscriptishere.php";
NSMutableURLRequest *request = [[NSMutableURLRequest alloc]init];
[request setTimeoutInterval:60.0];
[request setURL:[NSURL URLWithString:urlString]]; 
```

您正在发布到一个文件名。您的`urlString`变量应包含完整地址，包括协议和域（如`@"http://localhost/myscriptishere.php"`）。

# linux - 龙芯CPU和MIPS组装？

> ID：10802908
> 
> 赞同：1
> 
> 时间：2012-05-29T16:15:17.620
> 
> 标签：linux, assembly, mips, mips64

我有一台 Gdium Liberty 1000 笔记本电脑（龙芯 2F 处理器）正在送我。我将主要使用它来探索 MIPS 汇编语言。龙芯的内部架构应该与 MIPS CPU 不同。它实际上是在没有修改的情况下运行 MIPS 程序集（MIPS64？）还是龙芯 2F 架构有什么特殊的怪癖？我意识到我可以在我的 Intel/AMD x86 处理器上将 SPIM（或 MARS）作为 MIPS 模拟器运行，尝试在本地运行它似乎很有趣。

它是否在没有修改的情况下运行 MIPS 程序集（MIPS64？）？

Gdium（它运行 Mandriva Linux 的一个版本）上有哪些工具可用于学习 MIPS 汇编？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T18:25:31.677

来自龙芯的[维基百科：](http://en.wikipedia.org/wiki/Loongson)

```
The current Loongson instruction set is a MIPS64,
but the internal microarchitecture is independently developed by ICT.
Early implementations of the family lacked four instructions
patented by MIPS Technologies to avoid legal issues. 
```

是的，在真实硬件上运行 MIPS 程序集当然很有趣（实际上，出于类似的原因，我给自己买了一台旧的 PowerPC Mac，因为这是获得像样的 PowerPC 处理器的绝佳选择）。

关于开发问题，我建议：

1.  设置对这个技术奇迹的远程访问（在那里运行'sshd'）
2.  为 MIPS 下载一些预编译的 gcc 工具链
3.  在本地编译二进制文件，使用“ssh”将它们部署到上网本。
4.  如果您想要远程调试或坚持广泛的日志记录，请在此处（在上网本上）设置“gdbserver”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T21:30:37.880

龙芯 2F 与*MIPS III 兼容*，这意味着您将能够编写 MIPS III 兼容程序集，编译并运行它。如果可用，原生工具链应该是比任何跨工具链更好的选择。

我建议阅读用户[指南](http://dev.lemote.com/files/resource/documents/Loongson/ls2f/Loongson2FUserGuide.pdf)，它会告诉您可用的说明。请注意，该芯片的指令集已经扩展了许多不同的整数/fp/媒体指令。

# r - R从ffdf对象创建样本

> ID：10802910
> 
> 赞同：1
> 
> 时间：2012-05-29T16:15:22.580
> 
> 标签：r

我有一个 ffdf 对象，它有约 1 亿行，我想创建一个约 500 万行的样本。

我使用了以下代码，但没有任何运气：

```
 > library(ffbase)
    > library(ff)
    > rowSamp1 <- c(1,3,5,7,9,11)
    > ff1 <- ff(runif(20))
    > ff2 <- ff(runif(20))
    > ff3 <- ff(runif(20))
    > ffdf1 <- ffdf(ff1, ff2, ff3)
    > dim(ffdf1)
    [1] 20  3
    > ffdf2 <- ffdf(ffdf1[rownames(ffdf1) %in% rowSamp1,])
    Error in as.hi.integer(x, maxindex = maxindex, dim = dim, vw = vw, pack = pack) : 
      NAs in as.hi.integer 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T19:53:49.713

ffdf1[大样本（x=100000000，大小=5000000，替换=假），]

# javascript - javascript 构造函数的细节

> ID：10802914
> 
> 赞同：1
> 
> 时间：2012-05-29T16:15:49.930
> 
> 标签：javascript, oop

假设我有一个纯构造函数（只包含 this.Bar = bar）

1）当我从另一个函数调用它时，我可以在调用时直接传递调用者函数的参数还是必须这样做`var myBar=new bar, myBar.Bar=thebar`，其中 bar 是调用者参数？

2）即使没有得到所有参数，构造函数是否仍会实例化？

3）如何检查其中一个参数是否唯一，即没有其他对象实例具有该属性的此值？具体来说，我想在创建时为每个对象分配一个唯一索引。也许阵列？

提前谢谢了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:21:07.010

> 假设我有一个纯构造函数（只包含 this.Bar = bar）

我假设你的意思是：

```
function MyConstructor(bar) {
    this.Bar = bar;
} 
```

*（注意：JavaScript 中压倒性的约定是属性名称以小写字母开头。所以`this.bar`，不是`this.Bar`。最初封顶的标识符通常保留给构造函数。）*

> 1）当我从另一个函数调用它时，我可以在调用时直接传递调用者函数的参数还是必须做 var myBar=new bar, myBar.Bar=thebar，其中 bar 是调用者参数？

您可以直接传递它们：

```
function foo(a, b, c) {
    var obj = new MyConstructor(b);
} 
```

> 2）即使没有得到所有参数，构造函数是否仍会实例化？

JavaScript 引擎不会检查传递的参数数量。调用函数时，您未传递的任何形式参数都将具有该值`undefined`：

```
function MyConstructor(bar) {
    console.log(bar);
}
var obj = new MyConstructor(); // logs "undefined" 
```

> 3）如何检查其中一个参数是否唯一，即没有其他对象实例具有该属性的此值？具体来说，我想在创建时为每个对象分配一个唯一索引。也许阵列？

一般来说，这通常不在构造函数的范围内。但是，是的，您可以使用数组或对象来执行此操作。

```
var knownBars = [];
function MyConstructor(bar) {
    if (knownBars.indexOf(bar) !== -1) {
        // This bar is known
    }
    else {
        // Remember this bar
        knownBars.push(bar);
    }
} 
```

当然，`indexOf`可能不是您想要的搜索，因此您可能需要使用其他方法`Array.prototype`或您自己的循环。

另一种方法是使用对象；这假设这`bar`是一个字符串或可以有用地转换为字符串的东西：

```
var knownBars = {};
function MyConstructor(bar) {
    if (knownBars.indexOf(bar) !== -1) {
        // This bar is known
    }
    else {
        // Remember this bar
        knownBars[bar] = 1;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:19:32.780

> 当我从另一个函数调用它时，我可以直接传递调用者函数的参数吗

`this.Bar = bar`如果你不能，那么在构造函数中就没有多大意义了。

> 即使没有得到所有参数，构造函数是否仍会实例化？

如果缺少参数，则假设其中没有任何内容会引发异常，是的。参数只得到`undefined`.

> 如何检查其中一个参数是否唯一，即没有其他对象实例具有该属性的此值？

您需要检查它们的共享存储。

例如：

```
var Constructor = (function () {
    var unique_check_store = {};
    function RealConstructor(bar) {
        if (typeof bar == 'undefined') {
            throw "You must specify bar";   
        }
        if (unique_check_store.hasOwnProperty(bar)) {
            throw "You have already created one of these called '" + bar + "'";
        }
        this.Bar = bar;
        unique_check_store[bar] = true;
    }
    return RealConstructor;
})();

var a, b, c;
try {
    a = new Constructor();    
} catch (e) {
    alert(e);
}
try {
    b = new Constructor("thing");    
} catch (e) {
    alert(e);
}
try {
    c = new Constructor("thing");    
} catch (e) {
    alert(e);
}
alert(a);
alert(b);
alert(c);

​ 
```

# scala - Scala while(true) 类型不匹配？scala中的无限循环？

> ID：10802917
> 
> 赞同：9
> 
> 时间：2012-05-29T16:15:59.563
> 
> 标签：scala, loops, infinite-loop

为什么下面的代码

```
def doSomething() = "Something"

var availableRetries: Int = 10

def process(): String = {
  while (true) {
    availableRetries -= 1
    try {
      return doSomething()
    } catch {
      case e: Exception => {
        if (availableRetries < 0) {
          throw e
        }
      }
    }
  }
} 
```

产生以下编译器错误

```
error: type mismatch;
 found   : Unit
 required: String
             while (true) {
             ^ 
```

?

这在 C# 中可以正常工作。while 永远循环，所以它不能终止，因此它不能产生字符串以外的结果。或者如何在 Scala 中进行无限循环？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-29T17:26:54.807

与基于语句的语言 C#（以及 Java、C 和 C++）不同，Scala 是基于表达式的语言。就可组合性和可读性而言，这主要是一个很大的优势，但在这种情况下，差异已经咬住了你。

Scala 方法隐式返回方法中最后一个表达式的值

```
scala> def id(x : String) = x
id: (x: String)String

scala> id("hello")           
res0: String = hello 
```

在 Scala 中，几乎所有东西都是一个表达式。看起来像语句的东西仍然是返回一个名为 Unit 的类型的值的表达式。该值可以写为 ()。

```
scala> def foo() = while(false){}
foo: ()Unit

scala> if (foo() == ()) "yes!" else "no"
res2: java.lang.String = yes! 
```

图灵等效语言的编译器无法检测到所有非终止循环（参见图灵停止问题），因此大多数编译器很少做任何工作来检测任何循环。在这种情况下，“while(someCondition){...}”的类型是 Unit，无论 someCondition 是什么，即使它是常量 true。

```
scala> def forever() = while(true){}
forever: ()Unit 
```

Scala 确定声明的返回类型 (String) 与实际返回类型 (Unit) 不兼容，后者是最后一个表达式的类型 (while...)

```
scala> def wtf() : String = while(true){}
<console>:5: error: type mismatch;
 found   : Unit
 required: String
       def wtf() : String = while(true){} 
```

答：最后加个异常

```
scala> def wtfOk() : String = {
     | while(true){}
     | error("seriously, wtf? how did I get here?")
     | }
wtfOk: ()String 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-29T17:39:54.677

定义无限循环的函数式方法是递归：

```
@annotation.tailrec def process(availableRetries: Int): String = {
  try {
    return doSomething()
  } catch {
    case e: Exception => {
      if (availableRetries < 0) {
        throw e
      }
    }
  }
  return process(availableRetries - 1)
} 
```

**`retry`没有内部函数的**肘部**`loop`函数：**

 **```
import scala.annotation.tailrec 
import scala.util.control.Exception._ 

@tailrec def retry[A](times: Int)(body: => A): Either[Throwable, A] = { 
  allCatch.either(body) match { 
    case Left(_) if times > 1 => retry(times - 1)(body) 
    case x => x 
  } 
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-29T16:52:34.497

不幸的是，编译器不够聪明，无法知道您不能退出 while 循环。但是，即使您不能明智地生成返回类型的成员，也很容易被欺骗——只需抛出异常即可。

```
def process(): String = {
  while (true) {
    ...
  }
  throw new Exception("How did I end up here?")
} 
```

现在编译器会意识到，即使它逃脱了while循环，它也不能在那里返回值，所以它不用担心while循环有返回类型`Unit`（即不返回值）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-29T20:07:52.733

```
import scala.annotation.tailrec
import scala.util.control.Exception._

def retry[A](times: Int)(body: => A) = {
  @tailrec def loop(i: Int): Either[Throwable, A] =
    allCatch.either(body) match {
      case Left(_) if i > 1 => loop(i - 1)
      case x => x
    }
  loop(times)
}

retry(10) {
  shamelessExceptionThrower()
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-29T16:26:37.133

**编辑：**我刚刚注意到实际的 return 语句。while 循环中的 return 语句将被忽略。例如，在 REPL 中：

```
scala> def go = while(true){return "hi"}
<console>:7: error: method go has return statement; needs result type
   def go = while(true){return "hi"}
                        ^ 
```

* * *

您告诉编译器该`process()`方法返回 a `String`，但您的方法主体只是一个`while`循环，它不返回任何内容（它是 a`Unit`或 Java `void`）。在 while 循环之后更改返回类型或添加字符串。

```
def process(): Unit = {
   while(true){...}
} 
```

或者

```
def process(): String = {
  while(true){...}
  "done"
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-30T08:32:23.957

基于我使用的[senia](https://stackoverflow.com/users/406435/senia)、[bowich](https://stackoverflow.com/users/947542/elbowich)和[dave](https://stackoverflow.com/users/115478/dave)的解决方案：

```
@annotation.tailrec
def retry[T](availableRetries: Int)(action: => T): T = {
  try {
    return action
  } catch {
    case e: Exception if (availableRetries > 0) => { }
  }
  retry(availableRetries - 1)(action)
} 
```

然后可以将其用作肘部和戴夫的解决方案：

```
retry(3) {
  // some code
} 
```**

# mercurial - 将 Mercurial UNIX 行尾转换为 Windows

> ID：10802918
> 
> 赞同：5
> 
> 时间：2012-05-29T16:16:19.550
> 
> 标签：mercurial, eol

如何克隆 Mercurial 存储库，以便我的工作副本始终具有 CRLF 行结尾？

这类似于这个问题 [在 Mercurial 中配置 eol 扩展的问题](https://stackoverflow.com/questions/3805432/problems-configuring-eol-extension-in-mercurial)

但我错过了一些它似乎在我的电脑上不起作用的东西。

我是 Mercurial 的新手，多年来一直使用 SVN (TortoiseSVN)。我安装了 TortoiseHG，我正在使用*Brian O'Sullivan 的 Mercurial: The Definitive Guide*书。

所以我做的第一件事就是在我的机器上克隆他的示例存储库，发现文件有 LF 结尾而不是 Windows CRLF 版本。

所以我试图像在 SVN 中那样找到处理这个问题的选项。

我使用以下内容在*%USERPROFILE%\Mercurial.ini*中创建了一个文件。

```
[extensions]
eol = 
```

我删除了存储库并再次检查了它。不用找了。

环顾四周，我发现我可能需要一个*.hgeol*文件。所以我在*%USERPROFILE%*文件夹中创建了一个

```
[patterns]
** = native 
```

删除并重新克隆存储库，该文件仍然有 LF 而不是 CRLF。

然后我再次尝试将*.hgeol*文件放在存储库的父目录中，最后将命令放在 Mercurial.ini 文件中。我也尝试用 CRLF 替换原生。

我必须遗漏一些东西，因为似乎这应该是我让它工作所需要的。也许我在这里缺少像 SVN 那样的自动转换的概念。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T10:14:50.937

该`.hgeol`文件应该是存储库根目录中的文件，而不是根目录的父目录、用户目录或 Mercurial.ini 文件中的文件。

要将其添加到现有克隆中，您可能应该首先使用`hg update null`（或`hg clone --noupdate`）删除现有的工作副本。然后，一旦您添加了`.hgeol`文件，您就可以使用 恢复您的工作副本`hg update`，此时 EOL 转换将生效。

我不认为您可以在不先将文件提交到您的存储库的情况下将其直接添加到克隆中。

# .net - VB.NET - 在命令行上传递命令

> ID：10802920
> 
> 赞同：0
> 
> 时间：2012-05-29T16:16:31.333
> 
> 标签：.net, vb.net, scheduled-tasks

我正在努力通过 Windows 计划任务将参数传递给 VB.NET 应用程序。它在 Visual Studio 中完美运行（通过项目属性传递命令行参数）。

如果我正在调用 VB6 应用程序，那么我将提供以下参数并且它可以工作：

运行：c:\progra~1\Test\Test.exe TestParameter Start In: c:\progra~1\Test\

但是，如果我在 VB.NET 中提供相同的参数，则程序在尝试在 Form.Load 中创建类的实例时会引发异常： System.NullReferenceException 无法创建对象的实例。

我还尝试了以下方法：

运行：c:\program files\Test\Test.exe TestParameter Start In: "c:\program files\Test\"

这次计划任务的状态变为“无法启动”。

在 VB.NET 程序的计划任务中指定命令行参数的正确方法是什么？

更新我在这个网页上找到了解决方案：http: [//forum.codecall.net/topic/47568-reading-command-line-arguments-in-vbnet/](http://forum.codecall.net/topic/47568-reading-command-line-arguments-in-vbnet/)。我仍然对为什么当我使用 8 位路径（即 progra~1）时程序不会创建对象的实例感到困惑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:27:55.200

我有兴趣查看构造函数（或 Form_Load 事件）中的代码，您将在其中获取空引用异常。progra~1 和“程序文件”之间的区别可能取决于其中的内容。

# magento - Magento 购物车“获取报价”和“更新总计”按钮重定向到购物车之外

> ID：10802924
> 
> 赞同：1
> 
> 时间：2012-05-29T16:16:47.073
> 
> 标签：magento, redirect, button

所以我的问题是，当客户在选择他们的国家、州、邮编后使用“获取报价”功能进行运输和税收时 - 当按下“获取报价”按钮时，它会将他们重定向到家网站的页面（索引）。报价确实成功出现在购物车中，但您必须在重定向后点击返回购物车才能看到它。其次，当您返回购物车时，在您选择运输方式（托运人的单选按钮）并单击“更新总计”后，同样的事情会发生 - 重定向到购物车之外。我在 shipping.phtml 文件中唯一更改的是标题，我从未更改任何 JS 代码或任何东西。

有任何想法吗？谢谢！

# nservicebus - NService 2.6 消费 Nservice 3.0 合约

> ID：10802925
> 
> 赞同：1
> 
> 时间：2012-05-29T16:16:49.083
> 
> 标签：nservicebus

我们的情况是我们的一个组件是在 Nservice bus 2.6 中开发的。我们目前正在使用 NSB 3.2 开发一个新的组件，该组件将从旧服务中使用。我们在从 NSB 3.2 到 NSB 2.6 组件共享合同时遇到问题。我们不能立即将旧系统迁移到 NSB 3.2，因为这将是很多工作。有没有人有类似的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:55:32.283

特别是如果您尝试对 3.2 消息合同使用[不显眼模式](http://andreasohlund.net/2011/12/15/support-for-running-nservicebus-in-unobtrusive-mode/)，您将遇到 NServiceBus 2.6 对引用 NServiceBus.dll 版本 2.6 以访问 IMessage 接口的硬性要求。

当然，2.6 也没有 IEvent 和 ICommand 的概念。

一种解决方案是为您的 3.2 消息合同程序集创建双重项目。

```
MyPublisher.Events-2-6.csproj
MyPublisher.Events-3-2.csproj 
```

每个项目将引用相同的 C# 文件，但 2.6 版本将引用 2.6 NServiceBus.dll，而 3.2 版本将引用 3.2 版本，或者如果使用 Unobtrusive，则可能包含一个附加文件来定义特定于程序集的 IEvent、ICommand , iMessage 接口。当然，您也可以在命名空间名称或其他一些指标上使用条件来定义这些并跳过该步骤。

那么您可能需要的最后一件事是`#if`在您的消息合约中使用一些块来指定版本之间的差异，例如：

```
#if NSBGT3
    public void MyEvent : IEvent
#else
    public void MyEvent : IMessage
#endif
    {
        // properties
    } 
```

完全披露：我自己还没有尝试过，我一直在想这就是我将如何去做。试一试并发布一些消息，然后检查它们并查看消息 XML 中关于消息适用的类型的内容。这将使您更好地了解 NServiceBus 2.6 是否会正确接受它们，尤其是在涉及多态消息处理的情况下。当然，您还需要使用 3.2 客户端和 2.6 客户端进行测试。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T06:29:52.110

我建议在新系统的解决方案中链接旧系统的类文件，这样它们将与较新的 NServiceBus 二进制文件一起编译，您将避免版本冲突。

# c# - c# switch 中的变量范围

> ID：10802926
> 
> 赞同：1
> 
> 时间：2012-05-29T16:16:50.320
> 
> 标签：c#, scope, switch-statement

我正在尝试发送一封电子邮件，其中发件人和收件人电子邮件地址（以及主题和正文内容）根据提供给该方法的值而变化。最好用代码本身来解释：

```
public void EmailNotification(int emailAction)
    {

        MailAddress to;
        MailAddress from;
        string subject;
        string body;

        switch (emailAction)
        {
            case 1:
                // Comment approved
                to = new MailAddress("someone@theirdomain.com");
                from = new MailAddress("no-reply@thisdomain.com");
                subject = "Comment approved";
                body = @"The comment you posted has been approved";
                break;
            case 2:
                // Comment rejected
                to = new MailAddress("someone@theirdomain.com");
                from = new MailAddress("no-reply@thisdomain.com");
                subject = "Comment rejected";
                body = @"The comment you posted has been rejected";
                break;
        }

        MailMessage message = new MailMessage(from, to);
        message.Subject = subject;
        message.Body = body;
        SmtpClient client = new SmtpClient();

        try
        {
            client.Send(message);
        }
        catch (Exception ex)
        {
            Console.WriteLine("Exception caught in EmailNotification: {0}", ex.ToString());
        }
    } 
```

所以问题是，由于范围如何与开关一起工作，to、from、subject 等的值在开关之外无法识别，即使我已经在开关之外声明了它们（可能是错误的？）。

我是 .NET 新手，因此对于如何完成此类事情的任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:19:43.527

问题是您没有初始化变量。如果 的值`emailAction`既不是`0`或，你的变量的值是`1`什么？它们将未初始化，这是非法的。所以要么初始化它们，要么`default:`在你的 switch 语句中添加一个抛出异常的子句。任何一个：

```
MailAddress to = null;
MailAddress from = null;
string subject = null;
string body = null; 
```

或者：

```
switch (emailAction)
{
    ...
    default: throw new InvalidOperationException("Action not recognized: " + emailAction);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:20:23.057

您需要将变量初始化为默认值，或者在`default`案例中初始化它们。不保证 switch case 会执行，因此编译器不知道这些值将被初始化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T16:29:11.503

我认为范围没有问题，但确保值被初始化的问题。

将“Case 2:”替换为“Default:”将允许代码编译，将空值设置为变量（将 MailAddresses 设置为 null，将字符串设置为 null 或“”），但我不建议这样做。

简而言之，它失败的原因是，如果 emailAction 等于 3 或 1 或 2 以外的任何值，则 switch 语句中不会执行任何操作，然后您将尝试在表达式中使用未初始化的变量。

有关什么是初始化的更多信息（对不起，如果这对您来说太低了），请尝试阅读： http: [//www.inf.unibz.it/~calvanese/teaching/06-07-ip/lecture-notes/uni02 /node18.html](http://www.inf.unibz.it/~calvanese/teaching/06-07-ip/lecture-notes/uni02/node18.html)。

# wpf - 为什么这些绑定没有按预期工作？

> ID：10802928
> 
> 赞同：0
> 
> 时间：2012-05-29T16:17:01.717
> 
> 标签：wpf, binding, menuitem, togglebutton

我有以下示例，它模仿具有菜单和状态栏按钮的应用程序做同样的事情。

如果我只从菜单执行命令，工具栏按钮会更新得很好，但是如果我开始使用工具栏按钮，菜单和工具栏就会不同步。如果我从工具栏按钮开始，菜单会更新，直到我第一次使用菜单，也会发生同样的情况。

我错过了什么？

C＃：

```
using System.ComponentModel;
using System.Windows.Input;
using Picis.Wpf.Framework.Commands;

namespace CheckTest
{
public partial class Window1 : INotifyPropertyChanged
{
    private bool _state;

    public ICommand ChangeStateCommand { get; private set; }

    public bool State
    {
        get
        {
            return _state;
        }
        set
        {
            if (_state != value)
            {
                _state = value;
                this.OnPropertyChanged("State");
            }
        }
    }

    public Window1()
    {
        this.ChangeStateCommand = new DelegateCommand<bool>(ExecuteChangeState);
        InitializeComponent();
        this.DataContext = this;
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void OnPropertyChanged(string name)
    {
        if (this.PropertyChanged != null)
        {
            this.PropertyChanged(this, new PropertyChangedEventArgs(name));
        }
    }

    #endregion

    private void ExecuteChangeState(bool state)
    {
        this.State = !state;
    }
}
} 
```

XAML：

```
<Window x:Class="CheckTest.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="300" Width="300">
<StackPanel>
    <Menu IsMainMenu="True">
        <MenuItem IsChecked="{Binding State, Mode=OneWay}" Command="{Binding ChangeStateCommand}" CommandParameter="{Binding State}" Header="Test" IsCheckable="True"  />
    </Menu>
    <ToggleButton IsChecked="{Binding State, Mode=OneWay}" Command="{Binding ChangeStateCommand}" CommandParameter="{Binding State}" Content="Test2" />
</StackPanel>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:32:44.633

您需要`CommandParameter="{Binding State}"`从您的`MenuItem`and中删除`ToggleButton`.

然后，将您的更改`ExecuteChangeState`为自行打开，而不是传入的参数：

```
private void ExecuteChangeState()
{
    this.State = !_state;
} 
```

这将确保开关始终打开 State 的当前值，并且应用程序的前端始终与 State 的变量值同步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T16:35:32.943

我已将您的代码导入到一个新项目中。我必须导入我的 Delegate 命令的实现，这基本上是 Josh Smith 的[中继命令](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)的非通用版本，并且一切正常（无论单击哪个顺序，这两个项目都保持同步）。

我对代码所做的唯一更新是以下内容，它基本上适应了我的委托命令版本是非通用的这一事实。

```
private void ExecuteChangeState(object parameter)
{
    bool s = (bool)parameter;
    this.State = !s;
} 
```

xaml 与您的帖子保持不变（我的理解是 Path 参数在绑定中是隐式的，因此无论是否指定它都没有区别）。

我怀疑问题可能是您正在使用的 DelegateCommand 的实现有问题。或者，您发布的示例可能会从您的实际应用程序中遗漏一些给您带来问题的东西。

您确定您发布的代码充分模拟了您遇到的问题吗？

# java - Java ArrayBlockingQueue 设计

> ID：10802933
> 
> 赞同：1
> 
> 时间：2012-05-29T16:17:19.817
> 
> 标签：java, collections

我刚刚在研究 JDK 1.6 时发现`ArrayBlockingQueue`- 构造函数调用了一种公共可重写方法！我认为这对于 API 来说是一种不好的做法。

```
 public ArrayBlockingQueue(int capacity, boolean fair,
                          Collection<? extends E> c) {
    this(capacity, fair);
    if (capacity < c.size())
        throw new IllegalArgumentException();

    for (Iterator<? extends E> it = c.iterator(); it.hasNext();)
        add(it.next()); // -> surprise:  add is public 
} 
```

我实际上是在尝试扩展`ArrayBlockingQueue`, 并添加一些 state 和 overrided ，当我调用构造函数时`add()`我立即得到了。我在这里错过了一些设计概念吗？`java.lang.NullPointerException``super(capacity,fair,col)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:21:02.640

这并没有什么不寻常的。本质上，您可以将其视为行的单行语法

```
ArrayBlockingQueue<E> queue = new ArrayBlockingQueue<E>(capacity, fair);
queue.addAll(c); 
```

这是可以覆盖的。调用可覆盖的方法通常不是一个好主意，但在这里它是完全合理的。

但是......也就是说，从`java.util`or扩展任何集合`java.util.concurrent`是一种邪恶。你应该装饰它们，而不是直接扩展它们。

# jquery - 试图从另一个 div 关闭一个 div

> ID：10802935
> 
> 赞同：0
> 
> 时间：2012-05-29T16:17:28.330
> 
> 标签：jquery, html

我创建了一个列表页面，其中每个列表都有自己的 div，该 div 的内容是通过 $.post 从单独的 php 脚本加载的

**我遇到的问题是试图隐藏列表，我认为问题可能与这条线有关**

$('div.close_listing')

只有我使用它才能让它工作

```
$('div.listing> div').click(  
function() {
$('div.listing> div').hide(); 
}); 
```

（当我单击列表 div 中的任意位置时有效）

非常感谢任何帮助。

清单的 html 代码是：

```
<div id='listing'>
   <div id='loading'></div>
   <a name='13'><h3>Business1</h3></a> <h4 data-id=18-3-3>Name Of Business 1</h4>
    <div>
        <hr>
     *** content forbusiness1 appears here ***
          <div class='close_listing'>CLOSE this listing</div>
    </div>

   <a name='14'><h3>Business2</h3></a> <h4 data-id=19-3-3>Name Of Business 2</h4>
    <div>
        <hr>
     *** content for business2 appears here ***
          <div class='close_listing'>CLOSE this listing</div>
    </div>

</div> 
```

调用内容的代码如下：

```
$(document).ready(function() { 
$('div.listing> div').hide();  
$('div.listing> h4').click(function() {
$('div.listing> div').empty().html('<img src="loading_image.gif" /><br>Retrieving Details.....');
$.post("http://www.example.com/record.php", { id: $(this).attr('data-id') });

$.post('show.php',{ id: $(this).attr('data-id')}, function(data) {
$('div.listing> div').html(data); 

$('div.listing .close').visible();
});

var $nextDiv = $(this).next();
var $visibleSiblings = $nextDiv.siblings('div:visible');

if ($visibleSiblings.length ) {
  $visibleSiblings.slideUp('fast', function() {
    $nextDiv.slideToggle('fast');
  });
} else {
   $nextDiv.slideToggle('fast');
} 
});

// closes the listing down

$('div.close_listing').click(  
function() {
$('div.listing> div').hide(); 
}); 

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:20:38.507

我猜你打算这样做

```
$('div.close_listing').click(function() {
        $(this).closest('.listing').hide(); 
    }); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:41:35.933

我发现您的问题有点难以理解，但是如果您想要关闭 close_listing 父 div，那么我已经像这样编辑了您的 html 标记

```
 <div id='listing'>
   <div id='loading'></div>
   <a name='13'><h3>Business1</h3></a> <h4 data-id=18-3-3>Name Of Business 1</h4>
    <div>
        <hr>
     content forbusiness1 appears here
          <a class='close_listing'  href="#">
            CLOSE this listing
          </a>
    </div>

   <a name='14'><h3>Business2</h3></a> <h4 data-id=19-3-3>Name Of Business 2</h4>
    <div>
        <hr>
      content for business2 appears here

           <a class='close_listing'  href="#">
            CLOSE this listing
          </a>
    </div>

</div> 
```

javascript应该是这样的

$('a.close_listing').bind('click', function () {

```
 $(this).parent().show().fadeOut(500);
            return false;
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T16:22:46.913

问题是这一行：

```
$('div.listing> div').hide(); 
```

它应该是

```
$('div#listing > div').hide(); 
```

但我认为你隐藏了很多（#listing 正下方的所有 div）。考虑以下：

```
$(this).parent().hide(); 
```

# java - 在 Java 中使用 QueryDSL 和 MongoDB 创建复杂查询

> ID：10802936
> 
> 赞同：2
> 
> 时间：2012-05-29T16:17:31.140
> 
> 标签：java, mongodb, spring-data, querydsl

我已经按照本教程设置了 MongoDB

[http://www.littlelostmanuals.com/2011/09/spring-mongodb-type-safe-queries.html](http://www.littlelostmanuals.com/2011/09/spring-mongodb-type-safe-queries.html)

一切都按预期工作，但现在我被困在我希望能够查询多个字段的地步。

目前，我为要保存的每种类型都有存储库接口，并且可以在单个字段上进行搜索。

```
public interface StartedEventRepository extends 
    MongoRepository<DatablockStartedEvent, String>,
    QueryDslPredicateExecutor<DatablockStartedEvent> { 

} 
```

下面是单个参数的查询。

```
 return startedEventRepo
            .findOne(QDatablockStartedEvent.datablockStartedEvent.searchId
                    .eq(searchId)); 
```

是否可以创建一个 Query 对象，我可以在其中说类似于以下内容。

```
if(someName != null){
    query.where(QMyClass.name.eq(someName));
}
if(someTime != null){
    query.where(QMyClass.time.eq(someTime));
}

List result = query.list(); 
```

我试过查看 MongodbQuery 但我无法让它工作。有任何想法吗？

我看到了一个例子[http://www.mkyong.com/mongodb/spring-data-mongodb-update-document/](http://www.mkyong.com/mongodb/spring-data-mongodb-update-document/)但这使用了mongoTemplate。有没有办法通过存储库来实现这一点，如果没有，它们没用吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T06:38:17.990

这应该是可能的。像这样的东西也许

```
BooleanBuilder builder = new BooleanBuilder();

if(someName != null){
    builder.and(QMyClass.name.eq(someName));
}
if(someTime != null){
    builder.and(QMyClass.time.eq(someTime));
}

repository.findAll(builder.getValue()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T18:02:49.050

在没有使用过 Spring Data 的情况下，我会从阅读这个[http://static.springsource.org/spring-data/data-document/docs/1.0.0.M2/reference/html/#mongodb.repositories.queries](http://static.springsource.org/spring-data/data-document/docs/1.0.0.M2/reference/html/#mongodb.repositories.queries)中猜测您只需在存储库中声明一个方法，其中方法名称告诉您的查询结构（同一站点上的示例 4.3 支持此猜测）。不确定是否可以生成动态查询，这是唯一一个快速搜索显示的查询。

# node.js - nodeJS-Express 或 Meteor 或 Derby

> ID：10802939
> 
> 赞同：18
> 
> 时间：2012-05-29T16:17:36.153
> 
> 标签：node.js, express, meteor, derbyjs

最近我有兴趣做关于nodejs、nosql（主要是mongodb、redis）的研究，并决定用这些现代技术（大学教授不会教我）做一个简单的博客。通过这个进步，我想我可以提高自己的 javascript 技能以及网络服务开发的许多方面。

一个简单的博客是一个好的开始，然后我发现 Github 上的 nodejs 和其他基于节点的 web 框架：express、locomotive、railway 等......问题是它们有太多的分叉。

当然，通过我的努力，我可以与其中一些人一起工作，因为 MVC 逻辑对所有人来说似乎都是一样的。关键是我想专注于一个框架，它是未来 1 年或更长时间的趋势。Express好像不错，说铁路、机车都是以Express为基础的，我最后还是跟着Express就好了，但是后来我发现了Meteor和Derby。现在它确实让我对选择感到困惑。人们说为自己的任务使用适当的工具，现在我有时间浪费在一些，但不是全部上。我想我应该通过提问来澄清我的一些想法：

1.  那流星和德比是nodejs的分支吗？

2.  我应该选择流星、德比还是机车、铁路，还是只是从头开始使用 express 来制作我自己的 MVC 设置？

3.  为什么人们将 Redis 与 Mongodb（或 CouchDB）一起用于会话？为什么我们不只使用 Mongodb 来处理会话和主要数据？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T19:14:44.817

1.  不
2.  我喜欢从 Express 开始，因为它为您提供了基本工具，并且您可以构建适合您的项目结构。
3.  Redis 非常快，但也有用于 mongodb 和 couchdb 的会话中间件。

# javascript - Javascript：想无限运行我的书签

> ID：10802940
> 
> 赞同：0
> 
> 时间：2012-05-29T16:17:36.420
> 
> 标签：javascript, loops, bookmarklet, bookmarks, infinite

我有一个 boomarklet，意思是 javascript 代码获取当前页面的源，搜索一个字符串（或者我可以说超链接）并将当前页面更改为收集的链接。

问题是

> 我想让它无限次运行，如果可能的话在两者之间暂停以让页面加载。

*这只是我正在玩的一个 RPG，我厌倦了一次又一次地点击那个交换花链接。* 而且它没有冒犯性，或者我可以说不道德，他们有很多书签可以做一些其他的工作，所以..

这是代码 `javascript:window.location.href=document.documentElement.innerHTML.substring(document.documentElement.innerHTML.indexOf("museum.php?rfc="),document.documentElement.innerHTML.indexOf("museum.php?rfc=")+18)+"&step=a2";`

不管怎么说，还是要谢谢你...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:35:24.237

似乎您在询问在页面加载时运行一些 javascript，因为脚本正在导航页面。像[Greasemonkey](https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/)（用于 Firefox）这样的工具就是为此而构建的。

对于谷歌浏览器，你可以试试[他的工具](http://sandbox.self.li/bookmarklet-to-extension/)，它将小书签转换为扩展。

# python - 如何在python中添加两个偏移量？

> ID：10802945
> 
> 赞同：2
> 
> 时间：2012-05-29T16:18:02.037
> 
> 标签：python, timezone, python-2.7

我从以下行获得了 pytz 库的偏移量：

```
 offset = datetime.datetime.now(pytz.timezone(timezone)).strftime('%z') 
```

首先我传递`US/Eastern`in`timezone`变量，然后传递`Asia/Kolkata`in`timezone`变量，它打印以下值

```
 local_utc = -0400
 user_utc = +0530 
```

获得这些值后，我通过以下代码将其从字符串转换为 int：

```
local_utc = int(local_utc)
user_urc = int(user_utc) 
```

除此之外，我还有一个时间表：

```
 hour, minute,days = (timezone_tuple.tm_hour, timezone_tuple.tm_min,
                        timezone_tuple.tm_mday) 
```

我想将差异添加`local_utc and user_utc`到上面的元组中，例如 -0400：`04`例如小时和`00`分钟。例如：差异将是 : `0930`。并且`09`将被添加到`timezone_tuple.tm_hour`并且`30`将被添加到`timezone_tuple.tm_min`

我没有发现任何情况。怎么可能？有没有办法与`spilit`方法有关

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T17:56:05.937

您的帖子展示了如何查找`local_utc`和`user_utc`作为整数。您可以只取差`local_utc-user_utc`来确定相对偏移量。

但是，`datetime`和`time`应该`pytz`为您提供操纵时间所需的所有工具，而无需解析偏移量并“手动”进行此类计算。

例如，

```
import pytz
import datetime as dt
import time

eastern = pytz.timezone('US/Eastern')
kolkata = pytz.timezone('Asia/Kolkata')

naive_timetuple = time.localtime(0)
print(naive_timetuple)
# time.struct_time(tm_year=1969, tm_mon=12, tm_mday=31, tm_hour=19, tm_min=0, tm_sec=0, tm_wday=2, tm_yday=365, tm_isdst=0) 
```

上面，我定义了一个简单的时间元组。下面，我将其“本地化”为美国/东部时间——也就是说，使其成为可感知时区的日期时间：

```
naive_datetime = dt.datetime(*naive_timetuple[:6])
print(naive_datetime)
# 1969-12-31 19:00:00

localized_datetime = eastern.localize(naive_datetime)
print(localized_datetime)
# 1969-12-31 19:00:00-05:00 
```

现在要将时区感知日期时间转换为任何其他时区，请使用以下`astimezone`方法：

```
kolkata_datetime = localized_datetime.astimezone(kolkata)
print(kolkata_datetime)
# 1970-01-01 05:30:00+05:30 
```

如果您需要将日期时间转换回时间元组，请使用 timetuple 方法：

```
kolkata_timetuple = kolkata_datetime.timetuple()
print(kolkata_timetuple)
# time.struct_time(tm_year=1970, tm_mon=1, tm_mday=1, tm_hour=5, tm_min=30, tm_sec=0, tm_wday=3, tm_yday=1, tm_isdst=0) 
```

# javascript - 更改整个 HTML 表格中特定单词的颜色

> ID：10802947
> 
> 赞同：2
> 
> 时间：2012-05-29T16:18:06.027
> 
> 标签：javascript, html, css

我有一个 HTML 表格，在整个表格的各个单元格中都使用了“是”这个词。我想在整个表格中将“是”的颜色更改为绿色。现在我显然可以将所有“是”词放在一个跨度标签中并给它一个类，将一种样式应用于该类，但我必须在每个是的词周围放置一个跨度标签......肯定在那里必须是一种节省空间和精力的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T16:24:26.070

jQuery 有很棒的 :contains 选择器：

[http://api.jquery.com/contains-selector/](http://api.jquery.com/contains-selector/)

```
$("td:contains('yes')").css("color", "red"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T16:26:10.593

实现此目的的唯一方法是将每个单词包装在一个跨度中，并对其应用样式以使颜色变为绿色。您可以使用如下正则表达式快速找到页面中的所有“是”词：

```
 /(?<!-)(\byes\b)(?!([^<]+)?>)(?!-)/ig 
```

这将找到 html 标记之外的所有“是”字。所以最终的代码会是这样的：

```
$('td').each(function(){
   $(this).html(
        $(this).html()
       .replace(
              /(?<!-)(\byes\b)(?!([^<]+)?>)(?!-)/ig, 
             '<span style="color:green;">$1</span>'
        )
    );
}); 
```

正则表达式的解释：

中间部分，`(\byes\b)`匹配作为子表达式的“是”的整个单词。正则表达式的第一位`(?<!-)`称为[lookbehind](http://www.regular-expressions.info/lookaround.html)，正则表达式的最后一位`(?!([^<]+)?>)(?!-)`称为[lookahead](http://www.regular-expressions.info/lookaround.html)。基本上它说找到我所有的单词“yes”，这些单词没有跟在一些非`'<'`字符和 a`'>'`之后，并且后面没有或前面没有连字符。这些外观可防止正则表达式匹配出现在标记或其属性中以及出现在连字符中的任何“是”。i 和 g 是标志，表示搜索不区分大小写（因此它匹配“是”和“是”），并使搜索全局（匹配字符串中的所有实例）。在替换字符串中，`$1`是一个反向引用，表示在此处插入第一个匹配的子表达式，在这种情况下，它是匹配字符串中出现的单词“yes”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-29T16:23:27.133

只是在 JS 中猜测

```
var tables = document.getElementsByTagName('td');
for(var i = 0; i < tables.length; i++)
{
    var s = tables[i].innerHTML;
    s = s.replace('yes', '<span style="color:green">yes</span>');
    tables[i].innerHTML = s;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T16:24:18.537

如果你使用 jquery，你可以使用类似的东西：

```
$('#tableID')
  .find('td')
    .each(function () {
      if ($(this).html() == 'yes') {
        $(this).addClass('MyClass');
      }
    }); 
```

仅当“是”或您在字符串中输入的内容是该字符串的整个 html 内容时才有效`<td>`

# c++ - 如何读取控制台应用程序的输出？

> ID：10802948
> 
> 赞同：1
> 
> 时间：2012-05-29T16:18:07.773
> 
> 标签：c++, winapi

我有一个 3rd 方控制台应用程序，它打印几行并立即退出（或等待按下一个键以关闭 - 取决于使用的参数）。我想从我自己的控制台程序运行这个应用程序并将它的输出放到我的缓冲区中。我已经尝试过这种方法，但它不起作用：

```
....    
HANDLE stdRead, stdWrite;
SECURITY_ATTRIBUTES PipeSecurity;
ZeroMemory (&PipeSecurity, sizeof (SECURITY_ATTRIBUTES));
PipeSecurity.nLength = sizeof (SECURITY_ATTRIBUTES);
PipeSecurity.bInheritHandle = true;
PipeSecurity.lpSecurityDescriptor = NULL;

CreatePipe (&stdRead, &stdWrite, &PipeSecurity, NULL)

STARTUPINFO sinfo;
ZeroMemory (&sinfo, sizeof (STARTUPINFO));
sinfo.cb = sizeof (STARTUPINFO);
sinfo.dwFlags = STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW;
sinfo.hStdInput = stdWrite;
sinfo.hStdOutput = stdRead;
sinfo.hStdError = stdRead;
sinfo.wShowWindow = SW_SHOW;
CreateProcess (NULL, CommandLine, &PipeSecurity, &PipeSecurity, TRUE, NORMAL_PRIORITY_CLASS | CREATE_NEW_CONSOLE | CREATE_UNICODE_ENVIRONMENT, NULL, NULL, &sinfo, &pi))

DWORD dwRetFromWait= WAIT_TIMEOUT;
while (dwRetFromWait != WAIT_OBJECT_0)
{
    dwRetFromWait = WaitForSingleObject (pi.hProcess, 10);
    if (dwRetFromWait == WAIT_ABANDONED)
        break;

    //--- else (WAIT_OBJECT_0 or WAIT_TIMEOUT) process the pipe data
    while (ReadFromPipeNoWait (stdRead, Buffer, STD_BUFFER_MAX) > 0)
    {
        int iLen= 0; //just for a breakpoint, it never breaks here
    }
}
....

int ReadFromPipeNoWait (HANDLE hPipe, WCHAR *pDest, int nMax)
{
DWORD nBytesRead = 0;
DWORD nAvailBytes;
WCHAR cTmp [10];

ZeroMemory (pDest, nMax * sizeof (WCHAR));
// -- check for something in the pipe
PeekNamedPipe (hPipe, &cTmp, 20, NULL, &nAvailBytes, NULL);
if (nAvailBytes == 0)
    return (nBytesRead); //always ends here + cTmp contains crap

// OK, something there... read it
ReadFile (hPipe, pDest, nMax-1, &nBytesRead, NULL); 

return nBytesRead;
} 
```

如果我删除 PeekNamedPipe，它只会挂在 ReadFile 上并且什么都不做。有什么想法可能是错的吗？不幸的是，管道不是我的一杯茶，我只是整理了一些在 Internet 上找到的代码。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:25:56.240

我将从一个简单的方法开始：

```
char tmp[1024];
std::string buffer;

FILE *child = _popen("child prog.exe", "r");

if (NULL == child)
    throw std::runtime_error("Unable to spawn child program");

while (fgets(tmp, sizeof(tmp), child))
   buffer += tmp; 
```

只有当你发现这不起作用时，才做一些更复杂的事情来解决你遇到的具体问题。

# php - 用 onClick="document.getElementById('form').submit()">SUBMIT 对 php 代码进行什么更改以提交表单？

> ID：10802954
> 
> 赞同：0
> 
> 时间：2012-05-29T16:18:43.810
> 
> 标签：php, forms, mailer

php邮件程序的两个问题：

第一个 • Mailer 不适用于：

```
<a class="button" href="javascript:" onClick="document.getElementById('form').submit()">SUBMIT</a> 
```

• 它适用于：

```
<input type="Submit" name="Submit" value="send" class="submitbutton"/> 
```

如果我用上面的输入替换按钮，那么它就可以工作。

但是我以前从未将它与单选按钮一起使用：提交了表单但未处理单选按钮，这是本文中的第 2 个问题；该脚本似乎是为多个替代复选框创建的，而不是为选择性单选按钮创建的。

必须更改什么以适应提交按钮和单选按钮？

形式

```
<form  class="form-1" id="form" method="POST" action="php/subscription.php">
<input type="text" id="name">
<input type="text" id="phone">
<input type="text" id="email">

<input type="checkbox" name="check[ ]" value="iwhishtoreceivemailing" >  WITH CHECKBOX VALUES ARE SUBMITTED  

<input type="radio" name="check[   ]" id="">  ?????????????  don´t know how to change the code for radiobuttons

<input type="text" id="message">

  <a class="button" href="javascript:" onClick="document.getElementById('form').submit()">SUBMIT</a>

how to make it work with this php script ??

MAILER.PHP (php code is pasted below)
<?php
if(isset($_POST['Submit'])) {
$to = "anything@whatever.com ";
$to2 = "johndoe@jackfrost.com"; 
$subject = "contact_form";
                    $name = $_POST['visitor_name'];
                    $phone = $_POST['one'];
                    $email  = $_POST['email'];
        $message = $_POST['message'];

        foreach( (array)$_POST['check'] as $value){
    $check_msg .= "Checked: $value\n";
} 

        $body = "Name: $name\n phone: $phone\n Email : $email\n Mailing: $iwhishtoreceivemailing\n Message: $message\n";

        header("Location: thankyoupage.html");
        mail($to, $subject, $body );
        mail($to2, $subject, $body);

} else {
        echo "error_invalid_function"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:22:36.940

代替 ：

```
if(isset($_POST['Submit'])) { 
```

做 ：

```
if(isset($_POST['email'])) { 
```

因为具有名称的提交按钮`Submit`不再存在

# c# - C#安装和运行.exe问题

> ID：10802955
> 
> 赞同：0
> 
> 时间：2012-05-29T16:18:44.997
> 
> 标签：c#, visual-studio-2010, executable

我有 ac# 控制台应用程序。它被发布到将执行它的 UNC 路径。当我从 UNC 中双击 setup.exe 时，我会收到应用程序安装安全警告。

无法验证发布者。您确定要安装此应用程序吗？

我单击“安装”按钮，它运行了 .exe 文件。我可以看到o / p。一切都很好。然后下次当我双击同一个 setup.exe 时，我既没有收到应用程序安装安全警告，也没有重复 setup.exe 给我的应用程序所期望的结果。

我正在使用 Visual Studio 2010。我想知道如何首先绕过应用程序安装安全警告？每次双击 setup.exe 时，它​​都会给我 o/pw/o 任何警告标志。现在我必须卸载程序，然后双击exe让它运行并给我的o/p。我相信一定有办法不卸载程序，然后双击.exe运行它。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:23:08.173

您应该研究代码签名。

[http://blogs.msdn.com/b/secureapps/archive/2007/01/25/code-signing.aspx](http://blogs.msdn.com/b/secureapps/archive/2007/01/25/code-signing.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:22:05.277

从网络共享安装，除非应用程序由安装在用户安装的受信任证书存储中的证书签名，否则将始终显示安全警告。尝试使用 Click-Once 部署安装应用程序，并在部署时指定每次都必须下载应用程序，而不是安装到控制面板中。这将防止用户将旧副本保留在他们的桌面上，并且不会发出任何安全警告。

**编辑 ClickOnce 问题和代码签名**

[单击 MSDN 上的一次信息](http://msdn.microsoft.com/en-us/library/t71a733d%28v=vs.80%29.aspx)

[来自 MSDN 的代码签名](http://msdn.microsoft.com/en-us/library/ms537361%28v=vs.85%29.aspx)

# iphone - 如何设置像素透明和不透明后

> ID：10802956
> 
> 赞同：1
> 
> 时间：2012-05-29T16:18:50.257
> 
> 标签：iphone, objective-c, ios

我有一个代码可以改变 UIImage 中的像素。我需要将触摸位置的像素设置为透明的，然后在我再次触摸那里时设置为不透明的。我该怎么做？？？

**代码**

```
//It create new image with changed pixels
- (UIImage*)fromImage:(UIImage*)source
          colorBuffer:(NSArray *)colors erase:(BOOL)eraser
{
    CGContextRef ctx;
    CGImageRef imageRef = [source CGImage];
    NSUInteger width = CGImageGetWidth(imageRef);
    NSUInteger height = CGImageGetHeight(imageRef);
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    byte *rawData = malloc(height * width * 4);
    NSUInteger bytesPerPixel = 4;
    NSUInteger bytesPerRow = bytesPerPixel * width;
    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height,
                                                 bitsPerComponent, bytesPerRow, colorSpace,
                                                 kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);

    CGContextDrawImage(context, CGRectMake(0, 0, width, height), imageRef);
    CGContextRelease(context);

    int byteIndex = 0;

    for (int ii = 0 ; ii < width * height ; ++ii)
    {
        if(eraser)
        {
            // SET PIXEL TRANSPARENT
        }
        else
        {
           //SET PIXEL NON-TRANSPARENT
        }
    }

    ctx = CGBitmapContextCreate(rawData,
                                CGImageGetWidth( imageRef ),
                                CGImageGetHeight( imageRef ),
                                8,
                                bytesPerRow,
                                colorSpace,
                                kCGImageAlphaPremultipliedLast ); 
    CGColorSpaceRelease(colorSpace);

    imageRef = CGBitmapContextCreateImage (ctx);
    UIImage* rawImage = [UIImage imageWithCGImage:imageRef];  
    CGImageRelease(imageRef);

    CGContextRelease(ctx);  
    free(rawData);

    return rawImage;
} 
```

# ruby-on-rails - 如何在它测试的 gem 中正确嵌入测试 Rails 应用程序？

> ID：10802958
> 
> 赞同：0
> 
> 时间：2012-05-29T16:18:54.920
> 
> 标签：ruby-on-rails, testing, gem

我有一个我创建的小 gem 和一个用于测试 gem 的单独的小 Rails 应用程序。

我一直在寻找有关如何将 test rails 应用程序嵌入到 gem 中的信息，以便将其打包为一个，以便我可以启动它来测试应用程序。

我目前已经在 test 的子目录中的 gem 树中得到它。我可以切换到该子目录并正常运行该应用程序，或者我可以使用 rake 运行它的测试。但这是正确的方法吗？

（如果有什么不同，这个 gem 和小测试应用程序适用于 Rails 2.x）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T17:54:45.913

我建议你看看 github 上的其他一些 gem 以及它们的作用。有些人可能不需要完整的 Rails 应用程序，但可以设计，例如在 /test/rails_app 中嵌入准系统 Rails 应用程序

[https://github.com/plataformatec/devise/tree/master/test/rails_app](https://github.com/plataformatec/devise/tree/master/test/rails_app)

# c - `char *array[size]` 和 `extern char **array` 的链接错误？

> ID：10802959
> 
> 赞同：6
> 
> 时间：2012-05-29T16:18:59.707
> 
> 标签：c, gcc, linkage

首先，看这个例子（我为了例子而编造了这个，它不是一个真正的程序）：

随便什么.h

```
#ifndef WHATEVER_H
#define WHATEVER_H

void fill(void);

#endif 
```

主程序

```
#include <stdio.h>
#include "whatever.h"

char *names[10] = {NULL};

int main()
{       
        int i; 
        fill(); 
        for (i = 0; i < 10; ++i)
                printf("%s\n", names[i]);
        return 0;
} 
```

随便什么.c

```
#include "whatever.h"

extern char **names;

void fill(void)
{
        int i;
        for (i = 0; i < 10; ++i)
                names[i] = "some name";
} 
```

当我使用以下方法制作这个程序时：

```
gcc -o test main.c whatever.c -Wall -g 
```

我没有收到任何错误或警告。但是，当我运行程序时，我看到 ,`fill`实际上`names`是`NULL`. 如果`whatever.c`我改变

```
extern char **names; 
```

到

```
extern char *names[]; 
```

那么一切都很好。

谁能解释为什么会这样？如果 gcc 无法`extern char **names;`与 in链接，`main.c`它不应该给我一个错误吗？如果它可以链接它们，为什么`names`最终会`NULL`在`whatever.c`？

另外，与 有何`extern char **names;`不同`extern char *names[];`？

* * *

我在 Linux 下使用 gcc 版本 4.5.1。

## 更新

为了进一步研究这一点，我将`names`in的定义更改`main.c`为：

```
char *names[10] = {"1", "2", "3", "4", "5", "6", "7", "8", "9", "10"}; 
```

（保留`extern char **names;`）`whatever.c`和`gdb`，我可以看到它`names`具有价值。如果我将该值转换为`char *`并打印它，它会给我`"1"`. （注意，不是`*names`，`"1"`而是`(char *)names`）

基本上，这意味着 gcc 以某种方式设法与in`extern char **names;`链接！`whatever.c``names[0]``main.c`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T16:54:28.423

每当您在不同的编译单元中为同一个变量使用不同的、不兼容的类型时（就像您在此处所做的那样），您会得到未定义的行为。这意味着它可能不起作用，您可能不会收到任何有关它的错误或警告消息。

为什么会发生这种情况（以及为什么规范说这是未定义的）是由于大多数链接器的工作方式。大多数链接器对类型一无所知。他们只了解名字和记忆。所以就链接器而言，变量只是从某个地址开始的一块内存。在您的（原始）程序中`main.c`定义`names`为引用一个足够大以容纳 10 个指针（可能是 40 或 80 个字节，取决于这是 32 位还是 64 位系统）的内存块的开始，所有这些都是空值。 `whaterver.c`，另一方面，假设`names`指的是一个足够大的内存块来保存一个指针，并且该指针指向一个由 10 个指针组成的数组。

# backbone.js - Requirejs 使用 shim

> ID：10802961
> 
> 赞同：9
> 
> 时间：2012-05-29T16:19:11.750
> 
> 标签：backbone.js, requirejs

通过 requirejs2 使用 shim，有一种方法可以告诉要求一个模块已经加载？

例子：

```
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="undescrore.js"></script>
<script type="text/javascript" src="require.js'"></script>
<script type="text/javascript">
    require.config({
        paths: {
            "backbone": '/vendor/js/backbone-min.js'
        },
        shim: {
            'backbone': {
                //These script dependencies should be loaded before loading
                //backbone.js
                deps: ['underscore', 'jquery'], // here I would like to load the already loaded library
            }
        }
    });
</script> 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-29T19:57:36.390

好吧，如果下划线已经加载并且可用，则根本不需要 shim。Backbone 将愉快地加载。如果没有，可能是因为下划线实际上*没有*加载。

然而，仅部分使用 require.js 听起来是错误的，您不妨将它们全部加载到 AMD 中。为此，您需要像这样更改垫片：

```
shim: {
    backbone: {
        deps: ["underscore", "jquery"],
        exports: "Backbone"
    },

    underscore: {
        exports: "_"
    }
} 
```

当然更新你的`paths`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-30T17:14:31.657

我不确定您是否能够为您的用例找到最佳方法。如果您真的 - 出于某种原因 - 需要添加其他脚本而不使用代码示例@js999 中的 RequireJS，那么您需要检查这些脚本的全局变量 (jQuery, _) 是否存在，然后将它们定义为模块. 从您的代码示例中，它看起来像这样：

```
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="undescrore.js"></script>
<script type="text/javascript" src="require.js'"></script>
<script type="text/javascript">
    // check for jQuery 
    if (window.jQuery) {
        define('jquery', [], function () {
            return window.jQuery;
        });
    }

    // check for underscore
    if (window._) {
        define('underscore', [], function () {
            return window._;
        });
    }

    require.config({
        paths: {
            // remove the file extension (.js)          
            "backbone": '/vendor/js/backbone-min'
        },
        shim: {
            'backbone': {
                deps: ['underscore', 'jquery']
            }
        }
    });
</script> 
```

# java - Eclipse 在哪里/如何存储用户库？

> ID：10802964
> 
> 赞同：23
> 
> 时间：2012-05-29T16:19:19.707
> 
> 标签：java, eclipse, jar

我正在 Eclipse 中开发一个 Java 项目。我创建了一个名为“Spring”的用户库，并将所有 Spring jar 添加到其中。我的问题是，Eclipse 将这个库存储在哪里？它是否将所有 jar 复制到磁盘上某处的新目录中？或者它是否在某些配置文件中维护有关哪些 jar 属于用户库的信息？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-05-29T17:33:43.237

Eclipse 不会复制用户库的任何内容，它只是一个具有特定于机器的绝对路径的容器。用户库定义存储在工作区中；具体来说，在`.metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.jdt.core.prefs`.

用户库背后的想法是，它是项目外部存在的 JAR 集合之上的抽象；每个工作空间都必须为自己声明内容，因为它们在 Eclipse 项目之外。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-11-21T21:48:03.827

您可以从创建它们的工作区中导出它们，然后将它们导入到您想要它们的工作区中。

旧：窗口 -> 首选项 -> Java -> 用户库 -> 导入/导出

新的（不确定引入了这个更改的 Eclipse 版本）：窗口 -> 首选项 -> Java -> 构建路径 -> 用户库 -> 导入/导出

如果这就是你想要做的（这就是我被引导到这个网页的方式）

感谢@Jorn Vernee 的新版本更正

# sockets - 发送控制台消息的 TCP/IP 默认端口？

> ID：10802970
> 
> 赞同：0
> 
> 时间：2012-05-29T16:19:34.313
> 
> 标签：sockets, networking, tcp, ip, port

是否有专门供客户端将基于文本的控制台输出发送到服务器的专用端口（低于 1024）？我已经广泛搜索，但无济于事。如果有的话，发送基于文本的控制台输出的最佳端口（低于 1024）是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:25:17.990

端口只是一个数字。您可以在 中查看[*众所周知的*](http://en.wikipedia.org/wiki/Well_known_port#Well-known_ports)端口分配`/etc/services`。

您需要一个服务器应用程序在给定端口上侦听以接受您的输入。有许多远程终端*协议*及其实现，其中有[Telnet](http://en.wikipedia.org/wiki/Telnet)（端口 23）和[Secure Shell](http://en.wikipedia.org/wiki/Secure_Shell)或 SSH（端口 22）。

测试您的套接字*客户端*的最简单方法是在服务器上设置[`netcat`](http://en.wikipedia.org/wiki/Netcat)以侦听您想要的任何端口（端口`777`在下面的示例中），然后尝试从其他地方连接到它：

```
server:~# nc -l -p 777 
```

然后

```
client:~$ nc server 777 
```

请注意，在 Unix 上，您通常需要超级用户 (root) 权限才能绑定“特权”端口，即 1024 以下端口。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-29T22:31:08.027

我将使用 telnet（端口 23），因为这最接近我想要的。从客户端向服务器发送控制台消息。好的，谢谢！

# php - 是否可以在 PHP ActiveRecord 中表示第五范式？

> ID：10802974
> 
> 赞同：1
> 
> 时间：2012-05-29T16:19:48.440
> 
> 标签：php, activerecord, database-normalization

是否可以在 PHP ActiveRecord 中表示第五范式？

IE

```
Person <=> (person_id) person_phone (phone_id) <=> Phone 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:30:06.717

第五个法线可以用“$has_many through”表示

[http://www.phpactiverecord.org/projects/main/wiki/Associations](http://www.phpactiverecord.org/projects/main/wiki/Associations)

```
has_many through (many to many)

This is a convenient way to configure a many-to-many association. 
```

在此示例中，订单通过其支付关联与用户关联。

```
 1 class Order extends ActiveRecord\Model {
 2   static $has_many = array(
 3     array('payments'),
 4     array('users', 'through' => 'payments')
 5   );
 6 }
 7 
 8 class Payment extends ActiveRecord\Model {
 9   static $belongs_to = array(
10     array('user'),
11     array('order')
12   );
13 }
14 
15 class User extends ActiveRecord\Model {
16   static $has_many = array(
17     array('payments')
18   );
19 }
20 
21 $order = Order::first();
22 # direct access to users
23 print_r($order->users); # will print an array of User object 
```

我在这里找到了答案：

您可以为联合表创建一个模型，然后通过连接表关联电话表！

[http://www.phpactiverecord.org/boards/4/topics/226](http://www.phpactiverecord.org/boards/4/topics/226)

还发现了这个： [http ://svn.phpontrax.com/wiki/ActiveRecordTableAssociations](http://svn.phpontrax.com/wiki/ActiveRecordTableAssociations)

# javascript - 使用本地 css 和 js 在 WebView 中加载 HTML

> ID：10802975
> 
> 赞同：2
> 
> 时间：2012-05-29T16:19:53.293
> 
> 标签：javascript, android, css, android-webview

我正在显示一个带有远程 html 内容的 webview 作为来自远程服务器的字符串。我将 html 存储在本地，以便在没有连接的情况下使用我的应用程序。

此外，我还在本地存储了一个 .js 脚本和一个 .css 样式文件。这些文件可以由服务器更新。

我将所有这些文件存储在以下路径：

```
context.getFilesDir()+"content.css"
context.getFilesDir()+"content.js" 
```

在 html 字符串中，css 和 js 的引用如下：

```
<link rel="stylesheet" href="/content.css" type="text/css" media="screen">                                            
<script src="/content.js"></script> 
```

我使用加载html

```
this.webView.loadDataWithBaseURL(getFilesDir().getAbsolutePath(), html, "text/html", "utf-8", "about:blank"); 
```

但是没有考虑到样式和js，所以我认为我用来引用它们的路径有问题，或者加载webView。那么这样做的方法是什么？我找到了许多使用“assets”文件夹的答案，但我不想使用它，因为我必须从服务器更新 css 和 js。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T15:21:56.230

最后我找到了解决方案：

*   使用此方法将 css（或 js）文件保存在本地：

    `public static void writeToFile(Context context, String content, String title) throws IOException {
    OutputStreamWriter osw = new OutputStreamWriter(context.openFileOutput(title,Context.MODE_WORLD_READABLE)); osw.write(content); osw.close(); }`

*   然后我在 html 文件中使用

    `<link rel="stylesheet" href="content.css" type="text/css" media="screen">
    <script src="content.js"></script>`

*   最后，我使用以下命令打开了 webview：

    `this.webView = (WebView) findViewById(R.id.webview); this.webView.getSettings().setJavaScriptEnabled(true); this.webView.getSettings().setPluginsEnabled(true); this.webView.setHorizontalScrollBarEnabled(false); this.webView.setVerticalScrollBarEnabled(true); this.webView.setScrollBarStyle(View.SCROLLBARS_INSIDE_OVERLAY); this.webView.setWebViewClient(this.controller.getWebViewClient()); String basePath = "file://"+getFilesDir().getAbsolutePath()+"/"; this.webView.loadDataWithBaseURL(basePath, data, "text/html", "utf-8", "about:blank");`

# ant - Ant JUnit 任务在 TeamCity 中不起作用

> ID：10802976
> 
> 赞同：0
> 
> 时间：2012-05-29T16:19:56.820
> 
> 标签：ant, junit, teamcity

有一部分带有junit任务的ant脚本：

```
...

<target name="test">
  <mkdir dir="path_to_report_dir">
  <junit fork="true" printsummary="true" showoutput="true" maxmemory="1024M">
    <classpath ... />
    <batchtest todir="path_to_report_dir">
        <formatter type="xml" />
        <fileset ... />
    </batchtest>
  </junit>
</target>

... 
```

该脚本适用于 Eclipse 和命令行。但它在 TeamCity 中不起作用。TeamCity 中的最后一条信息性消息是：[mkdir] Created dir: path_to_report_dir Process exit code: 0

看起来 junit 任务不起作用，并且它停止执行所有脚本。麻烦在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:33:19.827

The cause was in `<fileset>` file list. The TeamCity version of Ant doesn't work with strings like `"/test/"` (this mean [select all files recursively](http://ant.apache.org/manual/Types/fileset.html)); it only works with strings like `"**/test/*.class"`. The local version of Ant supports both variants.

Thanks.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T18:39:59.950

不知道这是否有帮助....但这是我的标准测试目标：

```
<target name="test" depends="compile-tests">
    <junit printsummary="yes" haltonfailure="yes">
        <classpath>
            <path refid="test.path"/>
            <pathelement path="${classes.dir}"/>
            <pathelement path="${test.classes.dir}"/>
        </classpath>
        <formatter type="xml"/>
        <batchtest fork="yes" todir="${test.reports.dir}">
            <fileset dir="${test.src.dir}">
                <include name="**/*Test*.java"/>
                <exclude name="**/AllTests.java"/>
            </fileset>
        </batchtest>
    </junit>
</target> 
```

构建输出：

```
test:
    [junit] Running org.demo.AppTest
    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.056 sec 
```

**笔记**

*   使用 Junit 4.10。

# c# - C# 中大型布尔数组的问题

> ID：10802978
> 
> 赞同：4
> 
> 时间：2012-05-29T16:20:03.700
> 
> 标签：c#, arrays, primes, boolean

我决定编写一个素数生成器作为一个简单的练习。代码非常简单：

```
static void generatePrimes (long min, long max)
    {

        bool[] prime = new bool[max + 1];

        for (long i=2; i<max+1; i++)
            prime [i] = true;

        for (long i=2; i<max+1; i++) {
            if (prime [i]) {
                if (i>=min)
                    Console.WriteLine (i);
                for (long j=i*2; j<max+1; j+=i)
                    prime [j] = false;
            }
        }

        Console.WriteLine ();

    } 
```

它适用于像 1..10000 这样的输入。但是，在 max=1000000000 左右，它开始工作非常缓慢；此外，单声道占用大约 1Gb 的内存。对我来说，这似乎有点奇怪： bool[1000000000] 不应该占用 1000000000 位，而不是字节吗？也许我犯了一些愚蠢的错误，我没有看到这使它变得如此无效？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T16:22:18.330

计算机可以寻址的最小信息单位是一个字节。因此 a`bool`被存储为一个字节。您将需要特殊代码将 8 个布尔值放在一个字节中。[`BitArray`](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)班级为你做这件事。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-29T16:22:05.960

没有。与 C++ 的相反`vector<bool>`，在 C# 中`bool`，数组是`bools`.

如果您希望打包您的值（每个布尔值 8 位），请使用 a`BitArray`代替。

# android - 在android应用程序的后台运行更新

> ID：10802980
> 
> 赞同：0
> 
> 时间：2012-05-29T16:20:06.410
> 
> 标签：android

我正在尝试运行一种在后台检查应用程序更新的方法，但出现以下错误，我想我缺少一些要导入的包，但我对此不太确定。在这方面我将非常感谢你。

```
Errors <br>
lastUpdateTime cannot be resolved to a variable
checkUpdate cannot be resolved 
Illegal modifier for the variable checkUpdate; only final is permitted
showUpdate cannot be resolved to a variable
Illegal modifier for the variable showUpdate; only final is permitted 
```

这是我的代码

```
 public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        SharedPreferences prefs = getPreferences(0);
        lastUpdateTime =  prefs.getLong("lastUpdateTime", 0);

        /* Should Activity Check for Updates Now? */
        if ((lastUpdateTime + (24 * 60 * 60 * 1000)) < System.currentTimeMillis()) {

            /* Save current timestamp for next Check*/
            lastUpdateTime = System.currentTimeMillis();            
            SharedPreferences.Editor editor = getPreferences(0).edit();
            editor.putLong("lastUpdateTime", lastUpdateTime);
            editor.commit();        

            /* Start Update */            
            checkUpdate.start();

            /* This Thread checks for Updates in the Background */
            private Thread checkUpdate = new Thread() {
                public void run() {
                    try {
                        URL updateURL = new URL("url to my company");                
                        URLConnection conn = updateURL.openConnection(); 
                        InputStream is = conn.getInputStream();
                        BufferedInputStream bis = new BufferedInputStream(is);
                        ByteArrayBuffer baf = new ByteArrayBuffer(50);

                        int current = 0;
                        while((current = bis.read()) != -1){
                             baf.append((byte)current);
                        }

                        /* Convert the Bytes read to a String. */
                        final String s = new String(baf.toByteArray());         

                        /* Get current Version Number */
                        int curVersion = getPackageManager().getPackageInfo("your.app.id", 0).versionCode;
                        int newVersion = Integer.valueOf(s);

                        /* Is a higher version than the current already out? */
                        if (newVersion > curVersion) {
                            /* Post a Handler for the UI to pick up and open the Dialog */
                            mHandler.post(showUpdate);
                        }                
                    } catch (Exception e) {
                    }
                }
            }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:26:35.460

我看到的一些问题：

1.  是否声明了 lastUpdateTime？
2.  checkUpdate 在声明之前被使用。
3.  在 checkUpdate 的声明中删除 private。

修复这些东西，然后看看是否还有更多错误。

# git - 文件更改时git可以自动提交吗？

> ID：10802983
> 
> 赞同：3
> 
> 时间：2012-05-29T16:20:17.597
> 
> 标签：git, bash, shell, photoshop

当我设计时，我正在尝试新的方法来跟踪我的 Photoshop 文件的变化，我想知道；是否可以创建一个脚本，该脚本在对文件进行更改（保存）时自动创建提交。

我使用像[Pixelapse](http://www.pixelapse.com/)这样的工具，但是有一些缺点，其中一个是恢复到以前的版本可能会很痛苦，因为你需要加载网站。

每次我在 Photoshop 中保存我的更改时，我都希望 git 创建一个提交。

自动发生这种情况我确信会产生一些不良影响，例如大量文件大小，但是我愿意接受其他建议。

**更新：**顺便说一句，如果有帮助的话，我正在使用 Mac OS X。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T19:41:26.570

您可以编写一个 shell 循环来检查自上次以来文件哈希是否更改，如果更改则提交。您可以在循环中添加睡眠，并将时间戳用作提交消息。

我个人认为这有点毫无意义，因为您应该提交有用的快照，而不是全部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T17:55:44.967

也许 inotify-tools 是一种选择。

我不知道它们是否也存在于 MacOS X 下。Linux 用户可以使用`yum install inotify-tools`(RedHat) 或`aptitude install inotify-tools`(Debian/Ubuntu) 安装它。

然后你可以使用`inotifywait`：

```
while [ true ]; do
  inotifywait -e modify test >/dev/null 2>&1
  echo "Do something"
done 
```

要将它带入背景，请以这种方式包装它：

```
{ while [ true ]; do inotifywait -e modify test >/dev/null 2>&1 ; echo "Do something" ; done }& echo $! > ~/inotitfy.something.pid 
```

它将无限循环并运行`inotifywait`，如果事件发生，它将退出`-e`，然后`echo`在此示例中运行。通过创建后台进程后`&`。后台进程 ID 将通过管道传输到`~/inotitfy.something.pid`.

通过以这种方式终止进程来停止它：

```
kill -15 `echo ~/inotitfy.something.pid` 
```

您还可以将第一个变体放入[screen](http://www.cyberciti.biz/tips/linux-screen-command-howto.html)。

请注意，也可能有一个`inotifyexec`（如在 Debian Squeeze 上），但并不是一直对我有用，并且并非在所有发行版上都可用（所以我总是使用我自制的方法）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-12T11:06:11.577

我正在寻找类似的东西，并根据[try-catch-finally](https://stackoverflow.com/users/1078886/try-catch-finally)的[回答](https://stackoverflow.com/a/14059002/801553)我想出了这个：

```
while git ls-files | inotifywait -q  -e modify --fromfile -; do 
  …something… (in your case probably git-commit)
done 
```

这样做的好处是只监视受版本控制的文件。此外，由于您大部分时间都在内部`inotifywait`，因此更容易杀死（如果您杀死`inotitfywait`它，它会“异常”退出并`while`退出）。

您还可以考虑其他事件，尤其是`move`and`move_self`并且可能`create`and `create_self`（然后您可能还想使用一些选项`git ls-files`）。

# url - 本机 Domino 链接和 XPage

> ID：10802986
> 
> 赞同：0
> 
> 时间：2012-05-29T16:20:33.700
> 
> 标签：url, xpages

用户通过旧格式的链接打开文档`http://server/db.nsf/VIEW_UNID/DOC_UNID`。表单的属性设置为改为打开 XPage。

这些链接的来源是“万能代理”生成的电子邮件通知。它只是将链接发送到文档。它不知道什么表单与什么 XPage 相关联，因此它生成通用链接而不是“/page.xsp&documentId=...”。

**问题**：在客户端计算的相对链接不起作用 -`< a href = "/page.xsp?params">`应该更有效 - 没有往返并且在页面加载时易于计算。他们评估为`http://server/db.nsf/0/page.xsp?params`，自然以错误 404 结尾。

XPage 包含“帮助”部分，什么是另一个具有包含文本、图像和链接的 RT 字段的文档。当从另一个 XPage - 视图 (/page.xsp) 打开 XPage 时，该 RT 字段中的相关链接有效，但从通知链接 (/0/UNID) 重定向时失败。

**问题**`http://server/db.nsf/page.xsp?documentId=DOC_UNID`：通过老式 URL 打开重定向的文档/视图后，如何有效地将浏览器的地址栏重置为扩展的 XPages 格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T08:19:57.997

主要问题是服务器端（在 SSJS 中评估）和客户端（通过浏览器评估）的相对链接存在差异。如果文档由老式链接打开，我已经通过简单的重定向解决了我的问题。

```
<?xml version="1.0" encoding="UTF-8"?>
    <xp:view xmlns:xp="http://www.ibm.com/xsp/core">
        <xp:eventHandler event="onClientLoad" submit="false">
            <xp:this.script><![CDATA[var url = "#{javascript:context.getUrl()}";
    var l = window.location;
    if (url != l) {
        window.location.replace(url);
    }
    ]]></xp:this.script>
    </xp:eventHandler>
</xp:view> 
```

简单地说，如果打开的 URL 与内部 URL 不同（由 XSP 引擎解析），浏览器将重定向到正确的 URL。这解决了我们在使用内联图像（图像资源）和附件时遇到的许多问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T05:38:49.950

您是否尝试在 XPage 中设置 pageBaseUrl 属性？这将有助于修复相对链接：

```
<xp:this.pageBaseUrl>
   <xp:baseUrl>
      <xp:this.href><![CDATA[#{javascript:"http://stackoverflow.com/"}]]></xp:this.href>
   </xp:baseUrl>
</xp:this.pageBaseUrl> 
```

另一个想法是，如果 URL 采用老式样式，则在 XPage中的*beforePageLoad事件中进行重定向。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T18:49:53.293

如果您想回到根目录，请尝试“./page.xsp¶ms”或 ../ - 我注意到 IBM 在他们的编码中也这样做了。希望这可以帮助。

# magento - Magento 模型覆盖

> ID：10802990
> 
> 赞同：0
> 
> 时间：2012-05-29T16:20:49.210
> 
> 标签：magento, model, overriding

尝试为自定义扩展扩展模型。很简单……但重写似乎不起作用。

我想重写以下模型，位于社区代码文件夹中的一个模块中：

**Belvg_Stores_Model_State**

使用我自己的，位于本地代码文件夹中的一个模块中：

**Myco_Storelocator_Model_State**

这是来自 Myco_Storelocator 的配置 xml。块重写正在工作......状态重写不是。

```
<?xml version="1.0"?>
<config>

<global>
    <modules>
        <myco_storelocator>
            <version>0.1.0</version>
        </myco_storelocator>
    </modules>
    <blocks>
        <storelocator><class>Myco_Storelocator_Block</class></storelocator>
        <stores>
            <rewrite>
                    <front>Myco_Storelocator_Block_Front</front>
            </rewrite>
        </stores>
    </blocks>
    <models>
        <stores>
            <rewrite>
                <state>Myco_Storelocator_Model_State</state>
            </rewrite>
        </stores>
    </models>
</global>   
<frontend>
  <layout>   
        <updates>   
            <storelocator>   
                <file>storelocator.xml</file>   
            </storelocator>   
        </updates>   
    </layout>
</frontend>   
</config> 
```

谢谢您的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T16:54:34.467

需要在相关模型重写中添加以下内容...与块重写部分相同：

```
<storelocator><class>Myco_Storelocator_Model</class></storelocator> 
```

...哦。

# javascript - 没有 jquery 的 javascript modal pop

> ID：10802992
> 
> 赞同：-1
> 
> 时间：2012-05-29T16:20:50.817
> 
> 标签：javascript, modalpopup

有没有办法创建一个纯粹的 javascript（不是 jquery）模式弹出窗口。有谁知道我可以说 Modal_ask (option1,option2,option3,...) 的库，它会停止 javascript 处理，直到返回一个值。

类似于确认，但选项数量可变。

谢谢

R

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-15T18:48:23.293

我的香草 JS 模态弹出脚本的无耻插件：[https ://github.com/cferdinandi/modals](https://github.com/cferdinandi/modals)

# javascript - Javascript更改iframe内的值

> ID：10802994
> 
> 赞同：0
> 
> 时间：2012-05-29T16:21:02.543
> 
> 标签：javascript, html, iframe, dom-events, cross-domain

我有我的网站

**[www.aplicatii-iphone.ro](http://www.aplicatii-iphone.ro)**

和另一个

**本地主机上的 page.html**

```
<html>
<head>
<title>Object References across Iframes</title>

<script type="text/javascript">

window.onload = function(){
    var form = document.getElementById('testForm');
    form.testBtn.onclick = sendData;
}

function notify() {
    //alert('iframe loaded');
    var iframeEl = document.getElementById('ifrm');
    if ( iframeEl && iframeEl.parentNode && document.createElement ) {
        var newTxt = document.createTextNode('The iframe has loaded and your browser supports it\'s onload attribute.');
        var newPara = document.createElement("p");
        newPara.className = 'demo';
        newPara.appendChild(newTxt);
        iframeEl.parentNode.insertBefore(newPara, iframeEl);
    }
}

function sendData() { // to form inside iframed document
    // frames array method:
   // window.frames['ifrm'].document.forms['ifrmTest'].elements['display'].value = this.form.testEntry.value;
    var ifrm = document.getElementById('ifrm');
    var doc = ifrm.contentDocument? ifrm.contentDocument: ifrm.contentWindow.document;
    var form = doc.getElementById('search-input'); // <------<< search input
    form.display.value = this.form.testEntry.value;
    form.submit();
}

// test in iframed doc
var counter = 0;

</script>
</head>
<body>

<form id="testForm" action="#">
<p><input type="text" name="testEntry" size="30" value="[enter something]" /> <input name="testBtn" type="button" value="Click Me" /></p>
</form>

<iframe name="ifrm" id="ifrm" src="http://www.aplicatii-iphone.ro" onload="notify()" width="900">Sorry, your browser doesn't support iframes.</iframe>

</body>
</html> 
```

每次我按下按钮`Click Me`时，我希望[www.aplicatii-iphone.ro](http://www.aplicatii-iphone.ro)的状态就像用户从 iframe 外部搜索写在“testEntry”中的值一样。

我在那里尝试了一些东西......但我无法弄清楚......有什么帮助吗？

我从这里[http://www.dyn-web.com/tutorials/iframes/refs.php](http://www.dyn-web.com/tutorials/iframes/refs.php)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:57:28.577

If you know you're using a modern browser, you could use postMessage to communicate between the frames. Here's a good write-up: [http://ajaxian.com/archives/cross-window-messaging-with-html-5-postmessage](http://ajaxian.com/archives/cross-window-messaging-with-html-5-postmessage)

If you need to support legacy browsers, you could use [Google Closure's](https://developers.google.com/closure/library/) [CrossPageChannel](http://code.google.com/p/closure-library/source/browse/trunk/closure/goog/net/xpc/crosspagechannel.js?r=1024) object to communicate between frames.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T16:51:51.777

[不幸的是，由于相同的原产地政策](http://www.dyn-web.com/tutorials/iframes/refs.php#access)，这是不可能的。只有当您尝试将子域与主域连接时
，更改-value 才会有所帮助。`document.domain`

**编辑** 如果您通过使用同一网站上的页面来避免相同的组织问题，这应该适合您：

```
window.frames['ifrm'].document.getElementById("search-input").value = document.getElementsByName("testEntry")[0].value;
window.frames['ifrm'].document.getElementById("cse-search-box").submit(); 
```

# asp.net - ASP.Net - 解决 MaxHttpCollectionKeys

> ID：10802998
> 
> 赞同：1
> 
> 时间：2012-05-29T16:21:04.980
> 
> 标签：asp.net, html

我有一个巨大的表格，单元格的数量可以达到 1000 以上。所有的单元格都包含一个文本框。单元被实现为用户控件。有验证限制，在任何给定时间可以填充大约 100 个单元格，不是一个确切的数字，但保证低于 1000 个。当我发布此表单时，我达到了 MaxHttpCollectionKeys 限制，因为空字段也被发回。

由于此应用程序的性质，在 web.config 中覆盖此限制是非常不可取的，尽管总比没有好。默认情况下，是否有一种聪明的方法可以不将文本框包含在回发中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:28:30.047

还有另一种使用 JavaScript 的变通方法。您可以滚动浏览文本框并创建更改的 json 对象。将其发布回来，然后刷新表格。

这里暗示的是您根本不通过普通按钮回帖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T05:51:55.970

这是最好的解决方案。创建所有没有名称属性的文本字段。这样，他们将永远不会被发回。这正是我需要的技巧。在回发过程中，将文本字段值保存为 JSON 并将其放在隐藏字段中，这将自动回发。然后可以使用正常的页面生命周期，包括回发。