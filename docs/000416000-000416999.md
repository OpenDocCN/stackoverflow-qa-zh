# StackOverflow 问答 000416000-000416999

# java - 我可以在 ShutDown Hook 中放置大量 CPU 和 IO 密集型代码吗

> ID：416004
> 
> 赞同：4
> 
> 时间：2009-01-06T10:11:19.053
> 
> 标签：java

我在关机钩子中有很多 CPU 和 IO 密集型代码。有时我看到他们没有得到正确执行。那么是否有任何限制，例如我们不应该在关闭挂钩中有很多代码。

谢谢 DL 库马尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T10:16:04.223

我在我的一个应用程序的关闭挂钩中放置了一些相当大量的代码，它在各种情况下在各种操作系统（Windows XP、Vista、AS400/iSeries/Systemi、Linux）上非常可靠地执行，包括sigterms 和 Windows 关闭。

但要注意任何系统的关机超时（ala Windows good ol' 这个程序没有响应对话框）。

还要注意真正的 O/S kill 命令，例如 Linux sigkill (?) 和 Windows 任务管理器的结束进程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T10:41:58.193

没有。仔细[阅读API](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread))，你会看到。关机时间有限。如果您延长此时间段，JVM 将简单地结束/终止，而不会发出通知。如果您正在写入数据，您将写下损坏的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T10:15:24.753

不保证关闭挂钩运行。进程中止`kill`或硬件故障导致的进程中止是未运行关闭挂钩的典型情况。

# django - 如何在 Django 中定义模型之间的多态关系？

> ID：416007
> 
> 赞同：15
> 
> 时间：2009-01-06T10:12:17.910
> 
> 标签：django, django-models, polymorphism, associations

我正在开发一个包含`Offer`模型的 Django 应用程序。实例`Offer`包含定价条件并指向产品定义。产品模型实际上是一个层次结构（我有一个`Television`模型，一个`Camcorder`模型等）。所以我希望`Offer`模型包含一个多态（或“通用”）关联来指向任何产品。

目前，我所发现的只是在[应用程序中使用](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#id1)[通用关联`ContentTypes`](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#id1)。这可能会，但我正在寻找替代品，如果有的话。

谢谢你的帮助。

（请每个答案一个解决方案）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-01-23T23:27:39.283

ContentTypes 是正确的方法。这是因为 ForignKey 只能指向一种类型的表，因此您需要通过中间表并根据不同的类型进行拆分。

所以类层次结构的模型继承，但外键的 ContentType。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T18:49:14.437

如果您只需要指向“任何产品”而不是任何模型，那么解决方案是拥有一个所有产品都继承自的 Product 模型（即，Television 和 Camcorder 都是 Product 的子类），并为您的 Offer 模型提供一个 ForeignKey产品。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-03-03T05:12:59.270

你不能在 Django 中做到这一点。使用[通用关系](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/)或添加此功能的 Django 应用程序，如[django_polymorphic](https://code.google.com/p/django-polymorphic-models/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-21T14:31:09.497

看看[django-polymorphic](https://github.com/chrisglass/django_polymorphic)，它实现了这个特性，内部也使用了 ContentTypes。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-01-06T10:15:46.470

您可能想看看[模型继承](https://docs.djangoproject.com/en/dev/topics/db/models/#model-inheritance)。

# cocoa-touch - iPhone 开发 - 未记录的 UIProgressHUD 类

> ID：416015
> 
> 赞同：7
> 
> 时间：2009-01-06T10:15:59.260
> 
> 标签：cocoa-touch

我只听说过 UIProgressHUD 类的作用，但我找不到此类的实现或任何文档。可以在“The iPhone Developer's Cookbook 1st Edition”一书和互联网上的其他文章中找到对此类的参考：

> [http://www.cocoadev.com/index.pl?UIProgressHUD](http://www.cocoadev.com/index.pl?UIProgressHUD)
> 
> [http://blogs.oreilly.com/iphone/2008/02/using-a-progress-heads-up-disp.html](http://blogs.oreilly.com/iphone/2008/02/using-a-progress-heads-up-disp.html)

......也许还有其他人。我只是想知道我是否还能以某种方式使用这个类。有人有 .h 和 .m 类文件吗？或者是否有任何其他类可以做 UIProgressHUD 应该做的事情（打开一个警报，如显示带有消息的进度指示器的窗口）。

谢谢。穆斯塔法

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-08T23:05:45.100

我已经创建了自己的“进度 HUD”，即 MBProgressHUD。我最近在我的博客上发布了代码。如果你愿意，你可以检查一下，看看它是否满足你的需求。

您可以在以下位置找到代码：http: [//github.com/matej/MBProgressHUD](http://github.com/matej/MBProgressHUD)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-06T11:03:17.700

不要使用私有 API。如果幸运的话，Apple 会批准您的应用程序，然后在操作系统更新中更改或删除 API，从而激怒您的客户。如果你不走运，Apple 会拒绝你的应用程序。

在 Mac 上，您可以摆脱它（至少暂时如此）。**在 iPhone 上，永远**不要使用私有 API 。

编辑：由于这个答案最初是写的，Apple 在 Mac 上添加了一个 App Store。同样的规则适用于那里：如果您想在 App Store 中分发您的应用程序，请不要使用私有 API，**EVER**。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-15T03:41:54.177

我认为 UIProgressView 是你现在应该使用的。

[http://www.iphonedevcentral.org/tutorials.php?page=ViewTutorial&id=43&uid=34167348](http://www.iphonedevcentral.org/tutorials.php?page=ViewTutorial&id=43&uid=34167348)

[如何将 NSURLConnection 与 UIProgressView 集成？](https://stackoverflow.com/questions/312796/how-to-integrate-nsurlconnection-with-uiprogressview)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T17:09:19.550

目前，唯一的选择是自己动手，或者找其他人做过同样的事情并愿意与你分享他们的代码。

# c# - 如何有效地生成 2 个字符的长词？

> ID：416027
> 
> 赞同：0
> 
> 时间：2009-01-06T10:22:34.753
> 
> 标签：c#, string

我一直在尝试制作一个脚本，以从我的语言中的给定字符集生成 2 个字符的单词。但是，由于我不打算重新发明轮子，你知道这样一个 C# 公开可用的脚本吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T10:31:06.627

我不确定我是否正确理解了您的问题，但这可能会有所帮助：

```
List<string> GetWords(IEnumberable<char> characters) {
    char[] chars = characters.Distinct().ToArray();
    List<string> words = new List<string>(chars.Length*chars.Length);
    foreach (char i in chars)
       foreach (char j in chars)
          words.Add(i.ToString() + j.ToString());
    return words;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T10:51:47.067

您是在谈论找到可以由字符列表的任意组合组成的真正的两个字符的单词吗？

在这种情况下，您需要编写一个算法，该算法可以从提供的字母中计算出所有可能的组合，并针对每个组合尝试（以及相反的）一个 IDictionary，它就像一个真实的两个字母单词的字典.

未经测试的代码：

```
IDictionary<string, string> dictionary = GetRealTwoLetterWordDictionary();
char[] availableChars = new char[] { 'a', 's', 't' };
string[] combinations = GetAllCombinations(availableChars);
IList<string> results = new List<string>();

foreach (string combination in combinations)
{
    if (dictionary.ContainsKey(combination)))
    {
        results.Add(combination);
    }

    string reversed = combination.Reverse();

    if (dictionary.ContainsKey(reversed)))
    {
        results.Add(reversed);
    }
} 
```

# asp.net - 如何获取使用 WebClient.UploadData 发送的数据

> ID：416034
> 
> 赞同：0
> 
> 时间：2009-01-06T10:26:14.997
> 
> 标签：asp.net, upload

我正在尝试将一些数据从 ActiveX 控件上传到网页。对我来说最好的方法是通过 WebClient.UploadData 在字节数组中。

我在寻找如何在页面加载时检索数据时遇到了一些麻烦……有很多关于如何发送数据的示例，但我还没有找到一个说明如何在 Web 服务器上获取数据的示例。 ..

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T12:08:33.013

Request.BinaryRead(Request.TotalBytes)

问题解决了 ;）

# iphone - iPhone NSNumberFormatter 设置格式：

> ID：416037
> 
> 赞同：11
> 
> 时间：2009-01-06T10:28:15.680
> 
> 标签：iphone, cocoa-touch, nsnumberformatter

看起来好像`NSNumberFormatter's`设置 custom 的方法`formatters`。`setFormat:`在 iPhone 上不可用...

所以这...使我的应用程序崩溃：

```
NSNumberFormatter *lengthFormatter = [[NSNumberFormatter alloc] init];
[lengthFormatter setFormatterBehavior:NSNumberFormatterBehavior10_4];
[lengthFormatter setNumberStyle:NSNumberFormatterDecimalStyle];
[lengthFormatter setFormat:@"#,##0.0M"]; 
```

有没有其他人发生过这种情况？

谢谢，

丹**在下面回答。`NSNumberFormatter`也有调用的方法`setPositiveFormat: setNegativeFormat:`来替换折旧的`setFormat:`**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T10:35:31.407

[是的，它在NSNumberFormatter 类参考](http://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSNumberFormatter_Class/Reference/Reference.html)中记录为注释（需要登录）。笔记说：

> iPhone OS 注意：iPhone OS 仅支持现代 10.4+ 行为。10.0 风格的方法和格式字符串在 iPhone OS 上不可用。

***编辑：添加了更多文本以支持后续问题。***

你可以重写你的类似的东西：

```
NSNumberFormatter *lengthFormatter = [[NSNumberFormatter alloc] init];
[lengthFormatter setNumberStyle:NSNumberFormatterDecimalStyle];
[lengthFormatter setPositiveSuffix:@"M"];
[lengthFormatter setNegativeSuffix:@"M"]; // assuming it can go negative 
```

我建议看一下我上面链接的文档。它专门用于 iPhone 版本的 NSNumberFormatter，因此没有任何会导致应用程序崩溃的方法。它还旨在比原始 NSNumberFormatter 更多地利用用户的本地化设置。有一些方法可以限制显示的内容等，同时仍然利用用户的偏好。不幸的是，已经没有`setFormat:`方法了。

# email - 使用 qmail 的电子邮件别名

> ID：416038
> 
> 赞同：0
> 
> 时间：2009-01-06T10:28:18.503
> 
> 标签：email, plesk, qmail

我正在尝试在 qmail 中设置电子邮件域别名（我在 Plesk 服务器上）。应该发生的是发送给用户@myalias.com 的电子邮件*被*发送给*用户*@realdomain.com（不管*用户*是什么）。我希望这种情况发生，而不必设置重定向并弄乱这类事情。

我已按照[此论坛帖子](http://forums.theplanet.com/lofiversion/index.php/t55333.html "这个论坛帖子")的详细信息进行操作，但成功有限。我只对 qmail 配置进行了更改，因为所有其他配置都已经存在并且正确，因为 myalias.com 域是通过 Plesk 设置的...

1.  修改 /var/qmail/control/virtualdomains
2.  添加 myalias.com:60（“60”对应于同一文件中 realdomain.com 的整数）
3.  重启qmail服务

日志显示 qmail 接受到 @myalias.com 的传入电子邮件，然后将其路由到 @realdomain.com。然后电子邮件丢失并且从未真正送达。

关于我可以在哪里/如何更深入地了解电子邮件发生了什么的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T10:29:49.280

只是跟进我的这个老问题。现在一切正常。我让 NOC 检查了服务器，他们为我更正了。与 remotehosts 文件有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T03:24:23.763

realdomain.com 的日志文件是否显示它甚至正在接受或看到传入的重定向？

尝试将电子邮件重定向到另一个域。如果它们最终到达另一个域，那么问题出在您尝试将其真正发送到的域上。

如果他们根本没有出现在那里，那么它会回到他们被重定向的方式，你可以专注于那部分。

# vector - 多边形到栅格 GIS

> ID：416041
> 
> 赞同：2
> 
> 时间：2009-01-06T10:30:12.057
> 
> 标签：vector, gis, raster

我有一个带有各州的印度 shapefile（可能是多边形）。我想将每个多边形转换为等分的单元格（“光栅”方式），并通过一个值填充（实际上着色）每个单元格，该值将从特定于单元格位置的算法计算得出。这应该对多边形中的所有单元格（以编程方式）完成，这样最后我就有了 shapefile，看起来像一个主题（我的算法计算的内容），光栅图像。我没有开始任何图像，因为信息实际上是从算法计算出来的值，而不是来自卫星图像或类似的东西。

换句话说，它不是植被或高程主题，而是类似于人口分布的东西，其中单元格的每个值（颜色）代表那里人口的平均值，完全显示为大尺度分布。

任何人都可以帮助如何使用任何开源应用程序来做到这一点吗？（既作为应用程序，也以编程方式使用Sharpmap之类的API）请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-10T20:39:15.717

GDAL 实用程序和脚本将是我的选择。

[http://www.gdal.org/index.html](http://www.gdal.org/index.html)

我不太明白您将如何根据位置确定单元格值，但请查看以下实用程序：

[http://www.gdal.org/gdal_grid.html](http://www.gdal.org/gdal_grid.html)

[http://www.gdal.org/gdal_rasterize.html](http://www.gdal.org/gdal_rasterize.html)

如果您无法从命令行获得所需的输出，则可以编写 GDAL 函数脚本（C++ 或 Python 的示例最多）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T11:11:06.293

一种简单的方法是使用[Mapnik](http://mapnik.org)及其 Python 绑定。有关[基本用法](http://trac.mapnik.org/wiki/XMLGettingStarted)及其[XML 配置模式](http://trac.mapnik.org/wiki/XMLGettingStarted)的教程，请参见他们的站点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T11:17:49.510

我已经使用 MapScript（来自 UMN 的 Mapserver）完成了这项工作。

[http://mapserver.org/mapscript/index.html#mapscript](http://mapserver.org/mapscript/index.html#mapscript)

它相当简单，并且有许多绑定（PHP、Ruby、Python、.NET 等），但所有绑定的 API 都是相同的。我上次使用时的那些绑定质量参差不齐，而且我不了解当前的质量

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-25T20:53:24.753

我按照此处概述的说明使用 python 和 GDAL 完成了此操作：

[http://proj.lis.ic.unicamp.br/webmaps/docs/calc_ndvi/](http://proj.lis.ic.unicamp.br/webmaps/docs/calc_ndvi/)

我希望这有帮助。

附言。该网站是葡萄牙语的，所以如果你不会说这种语言，你可能会发现谷歌翻译非常有用。祝你好运。

n

# delphi - Delphi中检测内存泄漏的最佳工具是什么

> ID：416046
> 
> 赞同：27
> 
> 时间：2009-01-06T10:33:41.020
> 
> 标签：delphi, memory-leaks

检测内存泄漏的最佳工具是什么。

既免费又不免费。

谢谢

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-06T10:50:29.707

FastMM 是一个免费的（可用源代码）内存泄漏检测器，已集成在最新的 Delphi 版本中。我从来不需要其他任何东西。

顺便说一句，在编码时限制内存泄漏的可能性要好得多，而不是在以后发现它们。一些技巧：

始终在代码中使用 try 和 finally 来释放创建的对象。最好立即编写此代码，然后编写代码以使用对象。更好地利用代码模板等 IDE 功能。

仅在绝对必要时使用返回动态分配对象的函数。通常将对象作为参数传递比创建并返回它们更好。例如这个

```
procedure getChoices(var AChoices: TStrings); 
```

会比

```
function getChoices: TStrings; 
```

因为没有意外泄漏创建的 TStrings 对象的可能性。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-06T20:53:16.760

我们在 Delphi 7 中的工作中使用 EurekaLog。它是一个异常处理程序组件，它提供有关异常（包括调用堆栈！环境变量等）的非常详细的信息，即使是访问冲突也是如此。但是另一个很棒的功能是，您也可以告诉它在内存泄漏时出错，它显示了内存/对象首先分配的确切代码行！它是一种商业产品，但我仍然强烈推荐它。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-06T11:04:12.347

[AQTime](http://www.automatedqa.com/products/aqtime/index.asp)非常好。它还执行其他操作，例如性能分析。它不需要对您的代码进行任何更改。当然，使用调试信息进行编译有助于提供更好的结果。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-06T13:06:26.327

我会推荐完整的 FastMM4 版本，而不是 Delphi 中包含的版本。完整版为您提供了记录到文件而不是对话框的完整而详细的报告。将其与自制的“memoryleak-logfile-differ”结合起来，您就可以进行现有的 bughunt 了。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-12-20T15:50:34.983

我总是使用 ReportMemoryLeaksOnShutdown := (DebugHook <> 0); 这样我只有在调试时才会报告泄漏。

ps想把它放在评论中，但我还没有权利..

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-06T20:46:26.820

您可能想看看这个 CodeRage 2 会议：[为傻瓜而战的内存泄漏](http://video.codegear.com/CodeRageIIArchives/Day4/FrancoisGaillard_MemoryLeaks_English.zip)。它主要展示了如何使用 FastMM 来防止/检测 Delphi 中的内存泄漏。适用于 D2007，但仍适用于 D2009。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-01-08T03:38:53.057

FastMM 非常好。我知道 Delphi 有 3 或 4 个免费的内存管理器。检查所有这些只需要不到一个小时，因为通常它们只需要 3 行代码就可以将它们嵌入到项目中。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-08-25T15:08:17.067

我使用[MadExcept](http://madshi.net/)是因为它可以免费供个人使用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-08-13T12:23:24.317

试试[UMLD 1.0](http://umangsoftware.com/Umang_MLD_Memory_Leak_Detector_Product_Software_Application.htm)我们已经尝试过了！！用于 Delphi 开发的无泄漏 Delphi 应用程序开发和错误报告工具的智能解决方案。

[http://www.torry.net/authorsmore.php?id=7616&sort=ID](http://www.torry.net/authorsmore.php?id=7616&sort=ID)

# ruby - Ruby 中不是对象的“事物”示例

> ID：416047
> 
> 赞同：19
> 
> 时间：2009-01-06T10:33:49.070
> 
> 标签：ruby, oop

“一切都是对象”是我了解 Ruby 的第一件事，但在 Peter Cooper 的《*Beginning Ruby: From Novice to Professional*》中，提到“***几乎***Ruby 中的一切都是对象”。

你能给我一些***在*****Ruby 中不是对象的****例子吗？**

 ** * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-06T11:18:16.700

最明显的跳入我脑海的是积木。`Proc`通过使用`&block`参数列表中的参数形式或使用`lambda`,或（在 Ruby 1.9 中）“stabby lambda”语法`proc`，可以轻松地将块具体化为对象。`Proc.new`但就其本身而言，它们不是对象。

另一个例子是运算符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T10:43:22.920

1.  如果
2.  别的
3.  {
4.  }

通用语言结构等...

我认为几乎所有其他东西（包括方法）都是对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T11:13:30.080

词法分析器将脚本拆分为有意义的标记后，一切都是对象。包括班级。甚至像字面量的常量`1`也是对象。有些对象的语法可能不是纯粹的 OO（即语法糖），但这主要是为了便于操作。虽然块不是严格的对象（但可以像有人说的那样转换成一个）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-04T06:49:32.553

在变量赋值的情况下，即 `product = 5 * 5` 变量不是对象......所以将它添加到列表中

# delphi - EXE、资源和代码减少

> ID：416049
> 
> 赞同：5
> 
> 时间：2009-01-06T10:35:04.463
> 
> 标签：delphi, memory, resources

如何减少应用程序中的资源？我尝试了一些技巧，我减少和重写代码，减少行数，减少注释，压缩最终的 EXE，但这不是我想要的方式，改进变量类型转换，删除 ICONs，BMP，JPG，从应用程序内部我需要我的应用程序在最终 EXE 和一般资源消耗上尽可能小。任何更多的想法，关于这个主题的任何好文章谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T10:55:17.060

如何在项目选项中关闭调试信息：

*   没有调试信息
*   没有运行时检查
*   如果可能，减少使用外部设备的数量。

但是调试信息是一个主要杀手。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-06T10:42:07.743

我不会花任何时间删除注释，编译器无论如何都会将它们删除

您可以从外部服务（例如 Amazon S3）引用您的图像

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-06T10:56:05.343

将程序多次使用的任何图像放入图像列表或 TGraphic 组件中，并将它们放入数据模块中。将使用这些字形的所有组件链接到图像列表。如果您使用 Object Inspector 将相同的字形添加到多个组件，您最终会得到它的多个副本，从而增加加载时间以及可执行文件和工作集的大小。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-06T16:24:55.647

[当重定位](http://en.wikipedia.org/wiki/Relocation_(computer_science))不是问题时，减小可执行文件大小（实际上是 PE 映像大小，因为这也适用于 DLL）的一个好技巧：

留下搬迁信息！

在 Delphi 中，您可以这样做：

```
// Remove relocation table (generates smaller executables) :
// (See http://hallvards.blogspot.com/2006/09/hack12-create-smaller-exe-files.html)
{$SetPEFlags 1} // 1 = Windows.IMAGE_FILE_RELOCS_STRIPPED 
```

干杯!

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-06T11:05:25.027

不要自动创建所有表单，即使 Delphi 现在为您提供了选项，并且在早期版本中无条件地为新表单执行此操作。仅创建主窗体，并使用以下（伪）代码显示模式对话框：

```
procedure TMainForm.OptionDialog(Sender: TObject);
var
  Dlg: TOptionDialog;
begin
  Dlg := TOptionDialog.Create(nil);
  try
    // prepare dialog
    if Dlg.ShowModal = mrOK then begin
      // apply changed settings
    end;
  finally
    Dlg.Free;
  end;
end; 
```

这将缩短应用程序加载时间并减少整体资源使用，尤其是对于具有许多控件的复杂对话框。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-06T11:53:41.390

删除 VCL 并使用 KOL 和 MCK： http: [//kolmck.net/](http://kolmck.net/)

这是激进且非常大的变化，但会减小 exe 的大小。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-06T16:37:55.433

先测量，再优化。您的应用程序有多大，您希望它有多大？

你是不是担心...

磁盘上应用程序 .EXE 文件的大小？然后...

*   **在**. _ 您将获得一个很小的 ​​.EXE，但还需要分发 .bpls。

应用程序使用的 RAM 内存？然后...

*   在关闭运行时包的情况下构建 - 链接器将忽略包中大部分未使用的部分。

应用程序安装程序的大小？然后...

*   **在关闭**运行时包的情况下构建
***   使用 Inno 设置*   上面的大部分建议？**

 **安装后应用程序 PLUS PACKAGES/DLLS 的大小？然后...

*   **在关闭**运行时包的情况下构建，并使用 UPX

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-06T16:49:30.497

```
Project -> Options -> Compiler:
===============================
Optimization ON
Debug Information OFF
Local Symbols OFF
Reference Info OFF
Use debug DCUs OFF

Project -> Options -> Packages:
===============================
Build with runtime packages ON (but you will have to distribute your BPLs!)
Note to non-delphi folks:
a BPL is just a DLL, but with magic Delphi dust to make it easier to use. 
```

[这篇文章可能对你有用。](http://delphi.about.com/od/objectpascalide/a/bpl_vs_dll.htm)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-06T10:54:31.460

这一切的麻烦真的值得吗？我们不再生活在 640 KB 内存时代。

如果您希望您的 EXE 更小，请使用包和库的动态链接。这提供了大部分的推动力。还将所有资源（图像、声音）放入单独的 DLL 中。通过删除注释并在一长行中编写所有代码，您不会保存任何内容。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-06T12:04:17.420

通常来说，如果您想要更小的 EXE 大小，请使用早期版本的 Delphi。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-06T12:27:09.933

我总是使用[UPX](http://upx.sourceforge.net/)来压缩 exe 文件。它工作得很好，通常会导致 2 倍压缩。当然，禁用所有调试信息将有助于减小文件大小。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-06T10:39:25.487

使用像[Red Gate 这样的](http://www.red-gate.com/products/ANTS_Profiler/memory_profiling.htm)内存分析器来实时查看运行时内存使用情况。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-09-26T18:38:24.637

UPX 和 ASPack 会因为防病毒误报而制造很多麻烦。卡巴斯基经常这样做！

# javascript - AVM2 和 ABC（Adobe 的 ActionScript 字节码格式）规范许可。我可以使用它吗？

> ID：416050
> 
> 赞同：2
> 
> 时间：2009-01-06T10:35:31.407
> 
> 标签：javascript, apache-flex, licensing, adobe, avm2

谷歌在这方面让我失望了。

假设我有一些 ECMA 脚本，我使用 Open Source Flex SDK 中的编译器将其编译为 ABC 字节码文件。

我是否在使用条款范围内（我似乎找不到）使用 adobe 的 AVM2 规范为这个文件创建一个新的解释器？

我能做到的最好的是维基百科中的一句话，说闪存规范“无限制”可用。不过，我不是在制作 Flash 播放器，而且 AVM2 规范与 SWF 规范是分开的。

有人知道我的意图是否合法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T19:27:19.867

Adobe 将 ActionScript 虚拟机作为一个名为[Tamarin](http://www.mozilla.org/projects/tamarin/)的 Mozilla 项目在 MPL/GPL/LGPL 三重许可下开源。如果我没记错的话，这个源代码还包括 ABC 字节码的文档。考虑到这一点，在我看来，您可以自由地构建自己的解释器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-03T20:17:01.750

您当然可以自由解释 ActionScript 字节码；关于他们的开源项目（和开放文档）的精彩部分是，您可以阅读可靠的参考手册和实施，而不受它的限制（没有 NDA，等等）。这与黑暗时代形成鲜明对比，在黑暗时代，字节码必须在“洁净室”环境中进行逆向工程。

我想指出 Thatcher Ulrich 和公司的非常好的公共领域项目，题为：GameSWF。它包括一个 ActionScript 字节码解释器以及许多其他非常好的东西。

它与 Tamarin 大不相同，因为它不建立 cpu 操作的缓存，它更简单，它使用 switch 语句。这意味着它在重型循环上的运行速度会比 Tamarin 慢。

GameSWF 正在积极开发中，可在 sourceforge 上的 tu-testbed 项目下使用。

# iphone - iPhone 上的文字转语音

> ID：416064
> 
> 赞同：56
> 
> 时间：2009-01-06T10:42:16.307
> 
> 标签：iphone, core-audio

有什么方法可以在 iPhone 应用程序中将文本转换为语音？是否可以使用 SDK？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-23T18:27:06.563

Flite 语音合成引擎可以在 iPhone 上运行，参考[http://artofsystems.blogspot.com/2009/02/speech-synthesis-on-iphone-with-flite.html](http://artofsystems.blogspot.com/2009/02/speech-synthesis-on-iphone-with-flite.html)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-06T10:54:54.767

我不认为 iPhone SDK 在内部提供任何 TTS 工具。您应该使用第三方 TTS 引擎或自己编写一个。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-06-23T07:05:52.080

[OpenEars](http://www.politepix.com/openears/)还在 iPhone 上进行文字转语音（注意：我是开发人员）。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-06-21T09:48:36.897

我可能碰到了一个死线程，但[Flite 文本到语音引擎](http://bitbucket.org/sfoster/iphone-tts/)为我创造了奇迹！

希望能帮助到你！

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-11-23T19:11:05.193

这是另一个文本到语音：

[https://bitbucket.org/sfoster/iphone-tts/](https://bitbucket.org/sfoster/iphone-tts/)

您需要下载它并作为 API 安装，然后您可以像这样使用它：

```
[fliteEngine speakText:@"Hi there"];                    // Make it talk
[fliteEngine setPitch:90.0 variance:50.0 speed:0.9];    // Change the voice properties
[fliteEngine setVoice:@"cmu_us_awb"];                   // Switch to a different voice
[fliteEngine stopTalking];                              // stop talking 
```

一旦您将其正确安装为 API，就非常容易使用。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-05-17T11:54:54.240

[http://github.com/KingOfBrian/VocalKit](http://github.com/KingOfBrian/VocalKit)

我写了一个关于袖珍狮身人面像和 flite 的包装，你应该可以很快地检查出来。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-11-10T00:51:58.157

Tomsoft 引擎仅在自定义语音时速度较慢。我不确定为什么。但是，如果您删除其他声音而只删除集成的基本 KAL 声音，它几乎会立即说话。如果您需要任何帮助，请使用我网站上的联系表给我发送电子邮件。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-04-04T23:23:00.423

对于文本到声音文件，我刚刚发现这些将研究上述文件

[http://www.ivona.com/online/editor.php](http://www.ivona.com/online/editor.php)

[http://www.acapela-box.com/](http://www.acapela-box.com/)

IVONA 也有 iPhone SDK

[http://www.ivona.com/developer.php](http://www.ivona.com/developer.php)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-19T21:57:45.083

Hoya VoiceText 是 TTS 引擎的原始提供者。美国的大多数商业公司都会围绕 VocieText 创建一个包装器并将其转售。

这是由被豪雅（一家大型日本公司）收购的宾得（LG 的衍生产品 - 韩国）开发的。

访问此处发送对 TTS 引擎的请求：http: [//voicetext.jp/blog/122.html](http://voicetext.jp/blog/122.html)

使用谷歌翻译英文网站。

Hoya 总部位于日本，但他们拥有[NeoSpeech](http://neospeech.com/)，这是他们在美国的 VoiceText 引擎供应商。查看他们的网站以获取演示。

# php - 与 Zend 框架相关的 MVC 是什么？

> ID：416066
> 
> 赞同：5
> 
> 时间：2009-01-06T10:42:45.603
> 
> 标签：php, model-view-controller, design-patterns, zend-framework

我正在学习[Zend 框架](http://en.wikipedia.org/wiki/Zend_Framework)，它使用 MVC 模型。

我仍然不明白 MVC*模型、视图、控制器*是什么。

这三个不同的领域是什么？程序流程会是什么样子？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T18:31:16.407

M - 模型 - 通常是最大的混乱来源。这些是您的应用程序中完成所有“繁重工作”的部分——它们处理数据库访问、执行复杂的应用程序特定逻辑并负责您的应用程序“所做”的大部分工作。与视图和控制器不同，Zend 框架没有模型的基类——这是因为它们所做的事情并没有真正的一致性。一些框架（如 Ruby on Rails）试图提供某种数据库包装器作为模型的基础，但也有很多情况（第 3 方提要/API、静态文件、非持久性计算、跨越多个表的概念...... .) 这充其量是一种误导性的做法。模型是应用程序的一部分，你仍然被迫编程，而框架可以'

V - 视图 - 是这里最简单的组件。它们应该是简单的 PHP/HTML 模板。他们获得视图对象、数组、字符串等，然后将它们放入页面中。这里不应该有太多（如果有的话）复杂的逻辑 - 循环这些，显示这个（如果定义），斑马条纹这个表等等。View Helpers 发生了一些神奇的事情（例如神奇地渲染 a 的助手`Zend_Form`），但这对于理解整个系统并不是必需的。

C - 控制器 - 从最广泛的意义上说，控制器负责接受用户请求，将它们发送到模型对象并准备模型以传递给视图。它是把所有东西粘在一起的胶水。如果您使用 Zend MVC，您会关心 2 个控制器 -`Zend_Controller_Front`和`Zend_Controller_Action`.

`Zend_Controller_Front`（如果您使用，您将获得“免费” `Zend_Layout::startMVC()`）是您的应用程序的单一入口点 - 它处理原始用户请求并将 URL 转换为要调用的操作。有很多地方可以“插入”它来处理诸如身份验证和访问限制之类的事情，但是，核心只是前门的“交通警察”指挥传入的请求。

`Zend_Controller_Action`是动作的基类 - 本质上，动作代表您的应用程序所做的事情（登录、列出博客条目、启动洲际弹道导弹、订购比萨饼......），但并不直接负责实际执行。动作控制器非常无聊——它们从表单和 URL 中提取值，调用模型类上的一些方法来实际执行动作并将结果推送到视图中。如前所述，它们是将模型和视图粘合在一起的“粘合剂”。

一个粗略的测试，看看你是否沿着正确的路线拆分事情是设想对你的网站进行重大更改。视觉重新设计几乎完全在视图中处理。移动你所有的 URL 会改变你的控制器。从 Web 应用程序转换为 GUI 应用程序将替换视图和控制器，但您的模型仍将基本保持不变。如果您重写模型，您将拥有一个全新的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T11:09:36.033

Stackoverflow 上还有其他几个问题可以解释 MVC 概念：

*   [什么是 MVP 和 MVC，有什么区别？](https://stackoverflow.com/questions/2056/what-are-mvp-and-mvc-and-what-is-the-difference)
*   [什么是 MVC（模型视图控制器）？](https://stackoverflow.com/questions/129921/what-is-mvc-model-view-controller)

可以在[Wikipedia](http://en.wikipedia.org/wiki/Model-view-controller)上找到对该概念的非常好的解释：

> 模型-视图-控制器 (MVC) 是一种用于软件工程的架构模式。该模式的成功使用将业务逻辑与用户界面考虑隔离开来，从而使应用程序更容易修改应用程序的视觉外观或底层业务规则，而不会影响另一个。在 MVC 中，模型代表应用程序的信息（数据）；视图对应于用户界面的元素，例如文本、复选框项目等；控制器管理数据的通信以及用于操作数据进出模型的业务规则。

关于**Zend 框架**：

*   *模型*通常由[`Zend_Db_Table`](http://framework.zend.com/manual/en/zend.db.table.html)类的扩展呈现
*   *视图*在定义的脚本文件夹中显示为`*.phtml`文件，由[`Zend_View`](http://framework.zend.com/manual/en/zend.view.html)类处理。
*   *控制器*由[`Zend_Controller_Action`](http://framework.zend.com/manual/en/zend.controller.action.html)类的扩展定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T10:55:35.077

Zend 框架有它自己非常好的[快速入门/教程](http://framework.zend.com/docs/quickstart)，其中特别介绍了 MVC。

从那里引用：

> 那么这个每个人都在谈论的 MVC 模式到底是什么，你为什么要关心呢？MVC 不仅仅是一个三字母的首字母缩写词 (TLA)，您可以在任何时候想要听起来很聪明，就可以将它拿出来；它已成为现代 Web 应用程序设计的标准。并且有充分的理由。大多数 Web 应用程序代码属于以下三个类别之一：表示、业务逻辑和数据访问。MVC 模式很好地模拟了这种关注点分离。最终结果是，您的演示代码可以合并到应用程序的一个部分中，业务逻辑在另一个部分中，您的数据访问代码在另一个部分中。许多开发人员发现这种定义明确的分离对于保持代码的组织性是必不可少的，

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-06T14:52:22.590

用尽可能少的词：

*   模型是数据库
*   视图就是你所看到的（页面）
*   控制器是胶水（逻辑）

您的模型知道如何访问包含您的数据的表；您的视图知道如何显示内容；并且您的控制器将它们粘合在一起（我显示什么视图？我应该使用什么模型？）。

# performance - 是否有任何工具可以优化 JMS 队列上的消费者和生产者线程的数量？

> ID：416067
> 
> 赞同：2
> 
> 时间：2009-01-06T10:42:46.507
> 
> 标签：performance, multithreading, jboss, jms

我正在开发一个分布在两个 JBoss 实例上并在多个 JMS 队列上生成/使用 JMS 消息的应用程序。

当我们配置应用程序时，我们必须确定我们将使用哪种线程模型，特别是每个队列的生产和消费线程数。我们以一种相当临时的方式完成了这项工作，但是在阅读了 Herb Sutter 在 Dobbs 博士的最新专栏（特别是[这个](http://www.ddj.com/cpp/211800538)）之后，我想以更严格的方式调整我们的线程大小。

是否有任何方法/工具来测量 JMS 队列（特别是 JBoss 消息队列）的吞吐量作为生产/消费线程数量的函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T19:39:00.627

我为您准备了完美的东西：IBM 提供了一个[名为 perfha​​rness 的免费命令行工具](https://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=1c020fe8-4efb-4d70-afb7-0f561120c2aa)。

它旨在对 JMS 提供程序进行基准测试，即在给定不同数量的生产或消费线程的情况下测量队列（单个或多个）的吞吐量。

一些特点：

*   以固定速率 (msg/s) 或队列上可能的最大速率发送和使用消息
*   使用特定数量的线程
*   使用 JMS 或本机 MQ
*   可以使用随机生成的数据或从文件中获取的数据
*   生成统计数据，准确告诉您队列的执行速度

唯一的缺点是它不是超级直观，因为它支持的操作数量。而且 IBM 还没有开源它，这是一种耻辱。但是，这听起来很适合您的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T12:00:57.100

这实际上与特定工具无关，但可能会有所帮助。

**消费者：**

不确定您的内部架构是什么，但让我们假设它是 MDB 读取消息。我断言，您对严格线程数大小的唯一要求是选择最大上限。如果您的 MDB 使用来自有限供应商（如 JDBC 连接池）的资源，请将最大上限视为您可以容忍使用的来自该资源的最大并发实例数。如果 MDB 的队列是远程的，您可能希望将远程连接（或技术上的 JMS 会话）视为有限资源。如果 MDB 的有限需求较少（并且队列是本地的），那么您的最大上限将变为线程数、使用的内存和/或工作线程消耗的 CPU 消耗量。这里的原因是 JBoss MDB 容器将简单地继续分配更多的 MDB 实例（以及因此线程），直到队列为空或达到最大上限。我能想到的唯一原因是，如果容器的运行时间或创建新实例的开销超出了您的容忍度，并且这些操作通常是非常小的土豆，那么您真的会为最小值感到痛苦。

**生产者**

消息传递的一般公理是生产者几乎总是胜过消费者。您可能会认为这是非常随意的，但这是我一直看到的一种模式，即使在广泛不同的消息传递场景中也是如此。无论如何，在不了解应用程序的情况下很难说线程应该如何为生产者工作，但是你基本上能够[无限地]按比例增加生产者线程的数量和生成的消息数量，或者你有一些额外线程根本不会产生更多消息的上限？我猜是后者，因为大多数有用的工作都有一些有限的数据或计算供应商。在我看来，这里的两个驱动因素是有序和坚持。

首先，如果您有严格的消息排序，其中消息必须以严格（FPFP）首先产生首先处理然后您处于一个绑定状态，因为您几乎必须下降到单线程吞吐量，除非您可以设计某种形式逻辑消息划分（例如，任何给定客户端的消息始终发送到同一个队列的客户端编号，但您可能有多个队列，每个队列由一个线程提供服务，因此每个客户端实际上都是 FPFP）。

撇开顺序不谈，持久性是下一个考虑因素，因为如果你有可靠和广泛的消息持久性，（或者对消息丢失有很高的容忍度），就让生产者线程去城里。消息将可靠地排队，最终消费者将 [希望] 赶上。但是，如果您的消息持久性消息计数或简单的队列深度可能会在它们变得过高时给您带来麻烦，那么这里可能会用到一个工具。如果您的生产者线程计数可以动态修改（它们可以在许多 Java ThreadPool 实现中），那么您可以对队列深度进行采样，并根据您定义的队列深度范围提高或降低生产者线程计数，可选到如果消费者基本上停滞不前，生产者也会停滞不前。我不知道执行此操作的特定工具，但在两个 JBoss 服务器之间，这很容易启动。选择你的队列深度——>生产者线程数会比较棘手。

说了这么多，我将实际阅读您链接到的文章.....

# .net - 向您的 .Net Web 应用程序添加许可证

> ID：416070
> 
> 赞同：1
> 
> 时间：2009-01-06T10:43:24.197
> 
> 标签：.net, asp.net, obfuscation

我目前正在考虑添加一些许可类型的软件来保护我的 .net Web 应用程序源代码。想知道你们是否有这方面的经验，并且可能知道提供此类实用程序的任何公司或来源？

所以我的主要目标是保护实际文件

即 Default.aspx Default.aspx.cs .... 将来会被复制，而我无法阻止他们使用它。

谢谢

编辑：通过阅读回复，我似乎认为混淆器似乎是要走的路。混淆器程序仅适用于 exe 或 dll 还是也适用于单个页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T12:51:11.460

我不会为混淆而烦恼：.Net 3.5 中最新的*syntax-sugar*、编译时技巧和优化已经让简单的逆向工程变得非常困难。

例如，每次您使用`yield`关键字时，它都会生成一个具有复杂结构和不可读名称的枚举类。

混淆会使逆向工程变得更加困难，但还不够。[要么使用reflector](http://www.red-gate.com/products/reflector/)的副本阻止基本黑客攻击，要么阻止或阻止坚定的专家破解者。

我会对你所有的程序集进行密钥签名——然后如果他们反转一个，他们必须全部反转。

我会将尽可能多的实际应用程序逻辑从 Web 项目中提取到引用的 DLL 中——您的 Web 项目实际上应该是关于 UI 的。这使得对底层逻辑进行单元测试变得更容易，并且如果您认为这是值得的，则更容易混淆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T11:10:25.610

您可以做的一个步骤是将其发布为 Web 应用程序而不是网站。

[这里与 asp.net 的区别](http://weblogs.asp.net/anasghanem/archive/2008/07/13/differences-when-registering-httpmodules-and-httphandlers-for-web-application-projects-and-website-project.aspx)

至于 Default.aspx，我不知道如何加密通过标准 Web 服务器提供的 html 页面，无论哪种方式，客户端都仍然可以查看源代码，除非您将整个页面写入JavaScript 写入（管理起来很糟糕）。

您最好的选择是不要在 aspx 中包含任何应用程序逻辑代码，并使用混淆器编译您的二进制文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T12:05:50.100

我想知道一个简单的预编译是否可以在您的 ASP.NET 应用程序中发挥作用，我们在公司就这样做了。我们发布预编译的 Web 模块，没有人会看到 aspx 代码中的内容，所有“代码隐藏”文件都被翻译成 DLL。

[在这里查看更多](http://msdn.microsoft.com/en-us/library/ms227976.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T12:45:12.750

除非您以某种方式对其进行混淆，因此付出的努力比值得的要多，或者您预编译我看不出如何阻止他们仅仅隔离许可证检查代码 - 并删除它。

您可以在源代码上运行混淆器并分发混淆版本，这有很多例子，特别是对于 javascript。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T11:14:45.710

您的网站可以在每次用户登录时向您发送一些服务器机器信息。如果机器信息错误，请取消登录。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T12:33:50.700

我想知道除了混淆器或预编译之外，是否还有其他方法可以保护您的恶意代码。

即你有一个页面列表 Default.aspx Default.aspx.cs web.config

您的主要目标是防止第 3 方在有权访问源代码的情况下获取您的代码？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-06T12:44:34.523

我认为你在这里混合了两种不同的东西。一个是法律保护（这就是许可证的用途），另一个是物理保护。如果每个人都遵守法律，那么就不需要人身保护。

我建议您选择适合您的许可证（其中有很多），然后以任何方式照顾物理保护。

# javascript - jQuery克隆重复ID

> ID：416081
> 
> 赞同：53
> 
> 时间：2009-01-06T10:46:32.383
> 
> 标签：javascript, jquery, html

我有一个 HTML 元素，其中包含大量无序列表。我需要克隆这个元素以放置在页面上的其他位置，并添加不同的样式（这很简单，使用 jQuery）。

```
$("#MainConfig").clone(false).appendTo($("#smallConfig")); 
```

然而，问题是所有列表及其关联的列表项都有 ID 并`clone`重复它们。有没有一种简单的方法可以在追加之前使用 jQuery 替换所有这些重复的 ID？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-06T18:28:59.687

如果您需要在克隆列表项后引用它们，则必须使用类，而不是 ID。将所有 id="..." 更改为 class="..."

如果您正在处理遗留代码或其他东西并且无法将 ID 更改为类，则必须在附加之前删除 id 属性。

```
$("#MainConfig").clone(false).find("*").removeAttr("id").appendTo($("#smallConfig")); 
```

请注意，您无法再引用单个项目。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-06-14T13:32:16.333

由于 OP 要求在附加它们之前替换所有重复的 id 的方法，也许这样的事情会起作用。假设您想在 HTML 块中克隆 MainConfig_1，例如：

```
<div id="smallConfig">
    <div id="MainConfig_1">
        <ul>
            <li id="red_1">red</li>
            <li id="blue_1">blue</li>
        </ul>
    </div>
</div> 
```

代码可能如下所示，以查找克隆块的所有子元素（和后代），并使用计数器修改它们的 id：

```
var cur_num = 1;    // Counter used previously.
//...
var cloned = $("#MainConfig_" + cur_num).clone(true, true).get(0);
++cur_num;
cloned.id = "MainConfig_" + cur_num;                  // Change the div itself.
$(cloned).find("*").each(function(index, element) {   // And all inner elements.
    if(element.id)
    {
        var matches = element.id.match(/(.+)_\d+/);
        if(matches && matches.length >= 2)            // Captures start at [1].
            element.id = matches[1] + "_" + cur_num;
    }
});
$(cloned).appendTo($("#smallConfig")); 
```

要像这样创建新的 HTML：

```
<div id="smallConfig">
    <div id="MainConfig_1">
        <ul>
            <li id="red_1">red</li>
            <li id="blue_1">blue</li>
        </ul>
    </div>
    <div id="MainConfig_2">
        <ul>
            <li id="red_2">red</li>
            <li id="blue_2">blue</li>
        </ul>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-06T11:26:26.233

```
$("#MainConfig")
    .clone(false)
    .find("ul,li")
    .removeAttr("id")
    .appendTo($("#smallConfig")); 
```

试穿它的大小。:)

[编辑] 修复了 redsquare 的评论。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-08-20T09:36:05.543

我使用这样的东西： $("#details").clone().attr('id','details_clone').after("h1").show();

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-10-26T03:28:04.673

这是基于罗素的回答，但对形式来说更具审美性和功能性。jQuery：

```
$(document).ready(function(){
   var cur_num = 1;    // Counter

    $('#btnClone').click(function(){

          var whatToClone = $("#MainConfig"); 
          var whereToPutIt = $("#smallConfig");

          var cloned = whatToClone.clone(true, true).get(0);
          ++cur_num;
          cloned.id = whatToClone.attr('id') + "_" + cur_num;                  // Change the div itself.

        $(cloned).find("*").each(function(index, element) {   // And all inner elements.
          if(element.id)
          {
              var matches = element.id.match(/(.+)_\d+/);
              if(matches && matches.length >= 2)            // Captures start at [1].
                  element.id = matches[1] + "_" + cur_num;
          }
          if(element.name)
          {
              var matches = element.name.match(/(.+)_\d+/);
              if(matches && matches.length >= 2)            // Captures start at [1].
                  element.name = matches[1] + "_" + cur_num;
          }

         });

       $(cloned).appendTo( whereToPutIt );

    });
}); 
```

标记：

```
<div id="smallConfig">
    <div id="MainConfig">
        <ul>
            <li id="red_1">red</li>
            <li id="blue_1">blue</li>
        </ul>
      <input id="purple" type="text" value="I'm a text box" name="textboxIsaid_1" />
    </div>
</div> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-02-04T20:38:00.737

FWIW，我使用了 Dario 的函数，但也需要捕获表单标签。

添加另一个这样的 if 语句：

```
if(element.htmlFor){
var matches = element.htmlFor.match(/(.+)_\d+/);
if(matches && matches.length >= 2)            // Captures start at [1].
  element.htmlFor = matches[1] + "_" + cur_num;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T11:42:20.460

如果您将在一个页面上有几个类似的项目，最好使用类，而不是 id。这样，您可以将样式应用于不同容器 ID 内的 uls。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-14T12:40:24.830

我相信这是最好的方法

```
var $clone = $("#MainConfig").clone(false);
$clone.removeAttr('id'); // remove id="MainConfig"
$clone.find('[id]').removeAttr('id'); // remove all other id attributes
$clone.appendTo($("#smallConfig")); // add to DOM. 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-10T06:06:56.443

这是一个带有 id 的解决方案。

```
var clone = $("#MainConfig").clone();
clone.find('[id]').each(function () { this.id = 'new_'+this.id });
$('#smallConfig').append(clone); 
```

如果你想动态设置 id，你可以使用 counter 而不是 'new_'。

# wpf - 使用 WPF 数据绑定将 NULL 值显示为“NULL”的最简单方法是什么？

> ID：416088
> 
> 赞同：6
> 
> 时间：2009-01-06T10:49:55.400
> 
> 标签：wpf, linq-to-sql, data-binding

我有这个遗留数据库，我正在使用 Linq to Sql 构建一个自定义查看器。

现在，表中的某些字段可以具有 NULL 值。在 DataTemplate 中使用普通数据绑定（为 ORM 设计器生成的类键入）

```
<TextBlock Text="{Binding Path=columnX}"/> 
```

如果 columnX 的值为 NULL，则不显示任何内容。（这似乎是 WPF 约定）如果值为 NULL，我想显示“NULL”。（相当于`column_value ?? "NULL"`）

我可以使用转换器

```
<TextBlock Text="{Binding Path=columnX, Converter={StaticResource nullValueConverter}}"/> 
```

转换器类

```
class NullValueConverter : IValueConverter
{
  public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
  {
    if (value == null)
      return "NULL";
    ... 
```

但这似乎工作量太大。此外，这个逻辑需要在现有的非平凡转换器中复制..

有没有一种快速的方法来实现这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-06T12:28:04.860

绑定类有一个名为***TargetNullValue***的属性，如果绑定返回 NULL 值，该属性可用于替换其他内容。你的例子变成： -

```
<TextBlock Text="{Binding Path=columnX, TargetNullValue=My Substitute Text}"/> 
```

Binding 类的另一个属性也很有用，称为***FallbackValue***。如果无法解析绑定表达式（即未找到），这将是要使用的替代值，例如，当您使用的路径（在您的示例中为 columnX）不是数据上下文或源的成员时。

更新（Gishu）：需要**[.NET Framework 3.5 SP1](http://www.microsoft.com/downloads/details.aspx?FamilyId=AB99342F-5D1A-413D-8319-81DA479AB0D7&displaylang=en)** 53MB 下载。没有它，上面的代码将无法编译。TargetNullValue 是 Binding 类的新增内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T11:12:15.060

右键单击 DBML 文件，单击查看代码。`partial class`为您要使用的表添加一个。添加属性返回`value ?? null`或类似的东西。诀窍是 LINQ to SQL 将类声明为部分类，因此您可以轻松扩展它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T11:46:37.143

我认为没有更清洁的方法可以做到这一点。您可以在样式模板中使用 DataTrigger 来获取空值，但是在使用 NULL 时数据触发器可能有点“有趣”，因此您可能仍然需要一个转换器。

# html - 如何使标准模式和怪癖模式一样工作？

> ID：416094
> 
> 赞同：2
> 
> 时间：2009-01-06T10:51:14.230
> 
> 标签：html, firefox, internet-explorer-8, internet-explorer-7, doctype

以下 Html 在 FireFox 或 IE7/8 中非常适合我（带或不带样式标签）

```
<!-- Deliberately no DocType to induce Quirks Mode -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <style type="text/css">
        Input.quirks
        {
            margin: 1px 0px 1px 0px;
            border: solid black 1px;
        }
    </style>
</head>
<body>
Should work in Quirks Mode <br />
    <input class="quirks" type="text" style="width: 300px;" /><br />
    <input class="quirks" type="text" style="width: 147px;" /><img src="./Graphics/SpacerPixel.gif" border="0" /><input class="quirks" type="text" maxlength="25" style="width: 150px;" /><br />
    <input class="quirks" type="text" style="width: 94px;" /><img src="./Graphics/SpacerPixel.gif" border="0" /><input class="quirks" type="text" style="width: 100px;" /><img src="./Graphics/SpacerPixel.gif" border="0" /><input class="quirks" type="text" value="DA8 1DE" style="width: 100px;" />
</body>
</html> 
```

但是我被告知，在上述 HTML 顶部缺少 DocType 导致两个浏览器都在“Quirks”模式下工作。

我被告知这很糟糕。

我已经尝试了几种 DocType，但没有找到在两种浏览器中都能产生正确呈现的 DocType/HTML 组合。

“Quirks”模式以外的任何东西都会导致浏览器对设置文本框宽度的尝试做出不同的反应。这似乎导致我可以更正我对 FF 或 IE 的指令，而突然另一个会失败。

一些细节...

1.> 这里的目标是，在每个浏览器中呈现时，3 行的宽度应该完全相同。渲染的宽度在浏览器中是否相同并不是必需的，只是它们在每个浏览器中正确对齐/对齐。

2.> 引用的图像是 3 像素宽和 1 高的间隔图像（对此的替代方案也很好）

3.> 如果可能的话，我不想介绍表格。

似乎 Quirks 模式是唯一在浏览器中保持一致的模式。但是我担心 IE8 的最终版本或确实在某些未来的浏览器中，怪癖模式不会成为默认模式。

**我该怎么办 ？如何指定一个 DocType（并且可能改变我的 html），这将在浏览器中创建一致的外观？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T12:25:18.813

“Quirks”和“Standards Compliance”模式之间的主要区别在于不同的“盒子模型”，这导致根据宽度/高度、填充、边距和边框设置计算尺寸的方式不同。在标准合规模式下，盒子的有效宽度和高度是通过添加所有这些参数来计算的（请搜索网络以获取更多详细信息）。

因此，由于您指定了 1 像素边框，您的第一个输入字段将是 302 像素宽（左右边框为 300 像素 + 2*1 像素）。您提到的FF和IE之间的不一致可能是由于“填充”设置的“默认值”不同造成的。我刚刚使用 DOCTYPE 测试了您的代码，并且没有为输入字段填充 - 两个浏览器都以相同的方式呈现它。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

现在，对于间隔图像：不要使用它们。你不需要它们。只需为间隙的输入字段使用“3px”的右边距。

```
input.quirks {
    margin: 1px 3px 1px 0px;  /* 3px right margin */
    border: solid black 1px;
    padding: 0px;             /* so that IE and FF use the same padding */
} 
```

然后进行数学计算以确定正确的“宽度”设置，以便每行中所有宽度（包括填充、边框和边距！）的总和相等，例如：

```
300px + 5px = 305px
145px + 150px + 2*5px = 305px
90px + 100px + 100px + 3*5px = 305px 
```

请注意，“5px”由 3px 右边距和 2 倍边框 (1px) 组成。

你去吧。如果您想使用不同的填充以获得更好的外观，只需将其包含在您的计算中！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T22:15:51.933

由于您的问题主要是由 IE 和 Firefox 中的不同默认值引起的，您可能对[重置 CSS](http://meyerweb.com/eric/tools/css/reset/)样式表感兴趣，其中包括诸如填充之类的值，有效地清除每个浏览器的默认值，以便它们都以相似的方式呈现。

# deployment - 跨平台项目自动化

> ID：416102
> 
> 赞同：1
> 
> 时间：2009-01-06T10:55:16.373
> 
> 标签：deployment, automation

我工作的网上商店同时进行 .Net 和 PHP/Linux 开发。我们希望开始使用可用于两者的通用系统来自动化更多的部署过程。你会推荐什么作为一个很好的通用脚本语言或自动化系统（如 Ant 或 Maven），它适用于 .Net 和 Linux 开发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T11:01:53.100

我没有使用 Maven 的经验，但是我们已经设法让 Ant 在多个平台上完成我们想要的一切，只是因为您可以使用任何 Java 程序对其进行扩展以执行 Ant 不包含的特殊任务应用程序本身。

然后，如果需要，Java 可以使用 Runtime.exec() 调用您想要的任何外部程序。失去了一点可移植性，但它是 Linux 和 Windows 下的一些命令行工具所必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T18:50:34.870

您可能想了解 Perl 如何实现跨平台自动化。Perl6 的设计，似乎设计得更好一些，但是 Perl5 的设计已经发展了很多年。

Perl 已被移植到许多不同的平台，而不仅仅是 Linux 和 Windows。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T11:12:05.263

[您可能会从Capistrano](http://capify.org/)获得一些里程。它以 Rails 为中心，但非常通用，我相信它也已扩展到做其他事情。不确定它在 Windows 和 .NET 上的表现如何，但值得一看。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-06T11:00:54.757

[您可以使用Mono](http://www.mono-project.com/Main_Page)在 linux 上开发 .net 。在该 linux 服务器上，您可以同时使用 .net 和 php。

# iphone - iPhone 应用程序是否支持垃圾收集？

> ID：416108
> 
> 赞同：12
> 
> 时间：2009-01-06T10:58:08.897
> 
> 标签：iphone, objective-c, cocoa-touch, ios, garbage-collection

iPhone是否支持垃圾回收？如果是这样，那么执行使用`+alloc`和`-init`组合执行的操作的替代方法是什么：

```
NSXMLParser *xmlParser = [[NSXMLParser alloc] initWithData:xmlData];
UIImage *originalImage = [[UIImage alloc] initWithData:data];
detailViewController = [[[DetailViewController alloc] initWithNibName:@"DetailView bundle:[NSBundle mainBundle]] autorelease]; 
```

...和其他命令。提前感谢您提供的任何帮助或指导。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-06T11:04:40.207

不可以。垃圾收集对于设备上有限的电池寿命等来说是太大的开销。

您必须始终`alloc/release`牢记一种模式进行编程。

```
NSXMLParser *xmlParser = [[NSXMLParser alloc] initWithData:xmlData];
...
[xmlParser release]; 
```

或（不适合所有情况）

```
NSXMLParser *xmlParser [[[NSXMLParser alloc] initWithData:xmlData] autorelease]; 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-06T11:04:09.633

不，iPhone 目前不支持垃圾收集。您需要使用`alloc`// `release`。`autorelease`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T07:01:27.173

请注意，缺少垃圾收集意味着也不支持弱引用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-13T07:00:16.873

Mono touch 具有垃圾收集功能并在 iPhone 操作系统上运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-15T07:43:46.603

In the entire discussion nobody says about the Java language, in Java the Garbage collection is in-built in the language so it is implicitly available in Android,J2ME and Blackberry :), where as in Objective-C it is optional, so in iPhone the GC is not available.

# networking - NFS 与 Microsoft 网络共享的文件传输速度？

> ID：416109
> 
> 赞同：0
> 
> 时间：2009-01-06T10:58:17.037
> 
> 标签：networking, operating-system, filesystems, nfs

我想知道，使用[NFS](http://en.wikipedia.org/wiki/Network_File_System_(protocol))代替标准 Microsoft 网络共享是否有任何性能差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T11:24:16.347

以我的经验，是的。但我想这与您的特定工作负载和网络设置有很大关系。[快速谷歌](http://www.google.com/search?q=NFS+SMB+speed+comparison)可能会产生一些有用的信息

# t4 - 如何将 t4 模板的结果保存在不同的文件夹中

> ID：416112
> 
> 赞同：0
> 
> 时间：2009-01-06T10:59:44.587
> 
> 标签：t4

当我尝试使用为生成的文件指定绝对路径时

```
someTemplate.RenderToFile("c:\\tmp\\filename.ext"); 
```

我收到以下错误

错误 263 运行转换：System.Runtime.InteropServices.COMException (0x80004005)：此文件夹中已存在同名文件。

即使文件夹是空的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T11:05:26.177

此功能在 T4 Toolbox 9.3 版中实现：[http ://t4toolbox.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25294](http://t4toolbox.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25294)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T12:10:21.153

维托尔，

您是否使用[T4Toolbox](http://www.codeplex.com/t4toolbox)中的 Template.RenderToFile 方法？如果是，则此方法目前不支持将文件保存到其他文件夹。这已经在我的待办事项清单上一段时间了。无论如何，你在生成什么？

# java - Groovy、Netbeans 和 Java EE

> ID：416116
> 
> 赞同：8
> 
> 时间：2009-01-06T11:03:07.917
> 
> 标签：java, netbeans, groovy, jakarta-ee

我想开发一个将 java 与 groovy 混合的 Web 应用程序（无框架）。我正在使用带有插件的 IDE Netbeans。

如果我启动一个新的 Java SE 项目并添加一个 groovy 类，它可以正常工作。但是当我创建一个新的 Java EE 项目并添加一个 groovy 类时，它无法编译并显示以下错误：

```
/home/webcodei/NetBeansProjects/testeGroovyWeb/src/java/pacote/Hello.java:23: cannot find symbol 

symbol  : class Hroovy
location: class pacote.Hello
            Hroovy h = new Hroovy();
/home/webcodei/NetBeansProjects/testeGroovyWeb/src/java/pacote/Hello.java:23: cannot find symbol
symbol  : class Hroovy
location: class pacote.Hello
            Hroovy h = new Hroovy();
2 errors
/home/webcodei/NetBeansProjects/testeGroovyWeb/nbproject/build-impl.xml:383: The following error         occurred while executing this line:
/home/webcodei/NetBeansProjects/testeGroovyWeb/nbproject/build-impl.xml:211: Compile failed; see     the compiler error output for details.
FALHA NA CONSTRUÇÃO (tempo total: 0 segundos) 
```

**有人知道如何在 netbeans 中启用 Java EE + Groovy 吗？**

ps：我知道Grails的存在

ps2：Groovy jar 在我的类路径中。

感谢你所做的一切！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T22:45:40.497

NetBeans 6.5 Java Webapp 项目管理器似乎没有 Java App 和 Java 类库项目中存在的“启用 Groovy”支持。

我可以想到两种解决方法：

首先，您可以将 Groovy 代码和测试作为 Java 类库放在一个单独的项目中。然后让 Java webapp 依赖于 Groovy 项目。NetBeans 将自动构建依赖项目，因此您几乎不会注意到它们位于不同的项目中。

其次，“启用 Groovy”并不神奇。它所做的只是在 /nbprojects 中编写一个 groovy-build.xml 并修改 build-impl.xml 以将其导入。groovy-build.xml 覆盖默认的“javac”宏来调用“groovyc”。如果您对 Ant 很熟悉，您可以从 Java 应用程序项目中复制一个 groovy-build.xml 并将其复制到您的 Java Web 项目中，然后从您的 build.xml 中导入它（在导入 build-impl.xml 之前） ）。groovy-build.xml 可能需要一些调整，因为 webapp 和类库之间的一些属性有点不同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T11:07:05.990

@戴夫史密斯，

这正是我所做的。我创建了一个 javase 项目和一个 webapp 并开始比较它们。几分钟后，我意识到唯一的区别是 groovy-build.xml。

所以我将 groovy-build.xml 复制到目录中，并将以下行插入到我的 build.xml 中：

```
<import file="nbproject/groovy-build.xml"/> 
```

就在常规赛之前

```
<import file="nbproject/build-impl.xml"/> 
```

然后调用groovy文件覆盖-init-macrodef-javac。

```
<target depends="-groovy-init-macrodef-javac" name="-pre-compile">

</target> 
```

我还需要将命名空间从 groovy-build.xml 更改为我的 ex：

```
<macrodef name="javac" uri="http://www.netbeans.org/ns/web-project/2"> 
```

并在几行之后将 j2ee 类路径 (${j2ee.platform.classpath}) 插入到属性中：

```
<attribute default="${javac.classpath}:${j2ee.platform.classpath}" name="classpath"/> 
```

之后，该项目成功运行！=D

感谢你所做的一切！

# apache-flex - Flex：更新树控件

> ID：416139
> 
> 赞同：6
> 
> 时间：2009-01-06T11:12:05.700
> 
> 标签：apache-flex, actionscript-3

我有一个带有复选框的树控件，它使用来自[http://www.sephiroth.it/file_detail.php?id=151#的控件](http://www.sephiroth.it/file_detail.php?id=151#)

不知何故，当我更改 dataProvider（即通过单击复选框）时，我无法更新控件，我可以让它更新的唯一方法是使用滚动条。如何强制更新？我已经尝试了我能弄清楚的所有可能的方法？（见下面的更新）

另外如何重置树（折叠所有节点，滚动到大树的顶部）？

```
package offerta.monkeywrench.components
{

    import offerta.monkeywrench.components.componentClasses.TreeCheckBoxItemRenderer;

    import mx.collections.ArrayCollection;

    import mx.events.TreeEvent;

    public class WatchTree extends TreeCheckBox
    {

        public var idProperty:String;

        public var watchFactory:Function;

        private var _wSet:Boolean = false;

        /* clientId: */

        private var _clientId:String;

        [Bindable]
        public function get clientId():String
        {
            return _clientId;
        }

        public function set clientId(value:String):void
        {
            this._clientId = value;
        }

        /* //clientId */

        /* watching: */

        private var _watching:ArrayCollection;

        [Bindable]
        public function set watching(value:ArrayCollection):void
        {
            this._watching = value;
        }

        public function get watching():ArrayCollection
        {
            return this._watching;    
        }

        /* //watching */

        override public function initialize() :void
        {
            super.initialize();
            addEventListener("itemCheck", onItemCheck, false, 0, true);
        }

        private function isWatching(id:String):Boolean
        {
            for each(var w:Object in this._watching)
            {
                if(w[this.idProperty]==id) return true;
            }
            return false;
        }

        private function onItemCheck(event:TreeEvent):void
        {
            var item:Object = event.item as Object;
            var currentValue:uint = (event.itemRenderer as TreeCheckBoxItemRenderer).checkBox.checkState;
            if(item.children==null)
            {
                currentValue==2 ? addWatch(item.Id) : removeWatch(item.Id);
            }
            else
            {
                for each(var x:Object in item.children)
                {
                    currentValue==2 ? addWatch(x.Id) : removeWatch(x.Id);
                }
            }
            updateParents(item, currentValue);
            updateChilds(item, currentValue);
            this.dataProvider.refresh();
            super.invalidateProperties();
            super.invalidateDisplayList();
            super.updateDisplayList(this.unscaledWidth, this.unscaledHeight);
        }

        private function updateParents(item:Object, value:uint):void
        {
            var checkValue:String = (value == ( 1 << 1 | 2 << 1 ) ? "2" : value == ( 1 << 1 ) ? "1" : "0");
            var parentNode:Object = item.parent;
            if(parentNode)
            {
                for each(var x:Object in parentNode.children)
                {
                    if(x.checked != checkValue)
                    {
                        checkValue = "2"
                    }
                }
                parentNode.checked = checkValue;
                updateParents(parentNode, value);
            }
        }

        private function updateChilds(item:Object, value:uint):void
        {
            var middle:Boolean = (value&2<<1)==(2<<1);

            if(item.children!=null && item.children.length>0&&!middle)
            {
                for each(var x:Object in item.children)
                {
                    x.checked = value == (1<<1|2<<1) ? "2" : value==(1<<1) ? "1" : "0";
                    updateChilds(x, value);
                }
            }
        }

        private function addWatch(id:String):void
        {
            if(isWatching(id)) return;
            this._watching.addItem(this.watchFactory(id, this.clientId));
        }

        private function removeWatch(id:String):void
        {
            for(var i:int=0, n:int=this._watching.length; i<n; ++i)
            {
                if(this._watching[i][this.idProperty]==id)
                {
                    this._watching.removeItemAt(i);
                    return;
                }
            }
        }

        public function update(__watching:ArrayCollection, __clientId:String):void
        {
            clientId = __clientId;
            watching = __watching;
            if(this.dataProvider!=null)
            {
                var ws:ArrayCollection = ArrayCollection(this.dataProvider);
                for each(var group:Object in ws)
                {
                    var count:int = 0;
                    for each(var child:Object in group.children)
                    {
                        if(isWatching(child.Id))
                        {
                            child.checked = "1";
                            count++;
                        }
                    }
                    group.checked = (count==0 ? "0" : (count==group.children.length ? "1" : "2"));
                }
                this._wSet = false;

                var dp:ArrayCollection = ArrayCollection(this.dataProvider);
                dp.refresh();
                super.invalidateProperties();
                super.invalidateDisplayList();
                super.updateDisplayList(this.unscaledWidth, this.unscaledHeight);

                //scroll up the list???

                //collapse? (doesn't work)
                this.expandItem(null, false);
            }
        }

    }       

} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-06T16:40:27.300

我发现 Flex 中的 Tree 控件有点棘手。我最终强制重绘的方式是断开 dataProvider 并重新连接它，然后强制验证，有点像这样：

```
private function forceRedraw(tree:Tree, dataProvider:Object):void
{
    var scrollPosition:Number = tree.verticalScrollPosition;
    var openItems:Object = tree.openItems;
    tree.dataProvider = dataProvider;
    tree.openItems = openItems;
    tree.validateNow();
    tree.verticalScrollPosition = scrollPosition;
}
```

我想这顺便回答了你问题的第二部分，因为你所要做的就是清空 openItems 集合并将verticalScrollPosition设置为0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T06:47:55.207

您可能还有另一个问题：每当您检查项目时，树都会滚动到顶部，这很烦人。要解决这个问题，您应该以这种方式更新 TreeCheckBox.as 文件：在函数 checkHandler: private function checkHandler( event: TreeEvent ): void;

评论 commitProperties(); 称呼。

现在它应该工作得很好。

干杯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T17:29:13.643

我对这个解决方案有一些小问题， var scrollPosition:Number = tree.verticalScrollPosition; 一直是0？？

# shell - Cron Job - 每天删除所有 .flv 文件的命令

> ID：416143
> 
> 赞同：1
> 
> 时间：2009-01-06T11:13:09.240
> 
> 标签：shell, command-line, file, cron, fedora

我有这个每天通过 cron 运行的命令：

```
find /home/get/public_html/videos -daystart -maxdepth 0 
-mtime +1 -type f -name "*.flv" |xargs rm -f 
```

问题是它不会删除 1 天或更长时间前的目录中的 .flv 文件。

如何更正上述命令？

编辑：保罗 - 命令“ls -l /home/get/public_html/videos”会产生 2000 多个文件，但这里有 2 个应该被删除：

```
-rw-r--r--  1 get get   3501188 Jan  4 15:24 f486cf0a2b6bb40e4c50c991785084131231104229.flv
-rw-r--r--  1 get get  10657314 Jan  4 17:51 f5f1490ddaa11a663686f9d06fb37d981231112941.flv 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T11:19:26.527

最好在 find 上使用 -print0 并在 xargs 中使用 -0 以防一个文件具有不常见的名称。

此外，您想使用 -maxdepth 1 在指定目录中实际查找某些内容。

-maxdepth 0 意味着它只会在命令行中列出的目录中找到，它不会检查这些目录的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T11:19:49.303

你的意思是，如果你有一个目录`/home/get/public_html/videos/foo`，它不会删除其中的文件？那是因为您`-maxdepth 0`设置了参数，它可以防止`find`下降到子目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T11:23:19.937

```
-maxdepth 1 
```

# tfs - TFS 显示我名下的一些待定更改，但我没有更改任何内容

> ID：416150
> 
> 赞同：3
> 
> 时间：2009-01-06T11:15:48.547
> 
> 标签：tfs

TFS 以我的名义显示一些待定更改，但我没有更改任何内容。当我签入并查看查看待定更改时，我看到了一些我从未进行过的更改，在其他用户下待定的更改可能会显示为我的待定更改。当我取消选择并签入我的更改时，这些更改仍然锁定在我的名下吗？这是由于自动结帐还是其他原因？（TFS 策略需要在签入前编译）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T12:36:02.457

这可能是由于 TFS 中的自动结帐功能。

TFS 使用原子签入过程，并且非常小心地记录谁做了什么。当您开始编辑文件（或 IDE 代表您编辑文件，例如 .csproj 或 .vbproj 文件）时，该文件将显示在您的待定更改列表中，以表明您已通过编辑签出该文件待办的。

要查看您的待定更改列表，请转到查看、其他窗口、Visual Studio 中的待定更改。

要签入任何未决更改，您可以右键单击解决方案资源管理器中的文件，也可以在未决更改视图中选择它。只有这样，更改才会提交到版本控制中。从待定更改视图中，您可以与服务器版本进行比较，以查看您所做的更改。

要查看已提交到服务器的更改，您可以右键单击文件或文件夹并选择“查看历史记录”。

如果您想删除挂起的更改并将文件恢复到编辑之前的状态，您可以右键单击该文件并选择“撤消挂起的更改”。

如果您想更改自动签出行为以在执行签出之前提示您，请转到工具、选项、源代码管理、环境并将保存和编辑的签入项目更改为“提示签出” 而不是默认的“自动签出”。

希望有帮助，

马丁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-03T08:30:46.587

我有一个类似的问题；TFS 仍然说我有待处理的更改，当我比较时声明它们是相同的。[这篇](http://thesoftwarecondition.com/blog/2011/05/01/tfs-pending-changes-ignoring-files-which-are-identical-to-the-originals/)文章提出了一种方法来删除所有相同的文件并只留下*实际*更改的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T15:33:03.547

该问题可能与您使用或可能在不同计算机上使用过的不同工作区有关。检查存在的工作区并查看文件是否已在其他任何地方签出。在这里，评论中提到的 Sidekick 工具可以提供帮助。

# sharepoint - 继承现有的 Web 部件并覆盖方法

> ID：416152
> 
> 赞同：3
> 
> 时间：2009-01-06T11:17:45.157
> 
> 标签：sharepoint, web-parts

在 SharePoint 中开发 Web 部件时，我可以从现有 Web 部件继承并覆盖它们的方法吗？

还是我总是需要从头开始。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T11:32:43.367

如果它们没有被密封，你可以继承它们。在实践中，它可能工作或不工作取决于您想要扩展的 Web 部件的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T19:29:01.343

大多数（全部？）OTB 部件都是密封的。

带有图标/无按钮的新工具栏听起来更像是一种设计解决方案。将 topnav 占位符放在底部的不可见面板中（因此页面不会崩溃）并在视觉上修改其余部分 (css+firebug)。假设我没有误解你的意思。

它很容易开始使用 webparts，[http:](http://blah.winsmarts.com//2006/05/14/writing-custom-webparts-for-sharepoint-2007.aspx) //blah.winsmarts.com//2006/05/14/writing-custom-webparts-for-sharepoint-2007.aspx应该告诉你如何。从那里你应该能够轻松地编写一个 RSS 阅读器。

# iphone - 在测试我的 iPhone 应用程序时跟踪内存管理的最佳方法是什么？

> ID：416160
> 
> 赞同：6
> 
> 时间：2009-01-06T11:20:32.423
> 
> 标签：iphone, cocoa-touch, memory-management

在开发我的应用程序时，我开始意识到我的大多数应用程序崩溃都是由于内存管理不善造成的。

我知道我可以通过 NSLog (@"retain count is:%d",[myInstance retainCount]) 打印或记录保留计数；

但是，难道没有更好、更少手动的方法吗？可能是您的对象和实例的视觉表示？

**回答。干杯，亚当和杰森。:-)**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T11:23:56.753

通过 XCode 使用泄漏和对象分配工具。

```
Run > Start with Performance Tool > ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T15:57:12.787

除了其他答案之外，我强烈建议您使用 clang 对您的代码进行静态内存分析。它不会捕获所有内存管理错误，但它确实捕获了很多。如果您的主要问题似乎来自内存管理错误，那么 clang 将有助于找到这些错误。Clang 是免费的，在[http://clang.llvm.org/](http://clang.llvm.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T11:34:30.757

正如 Adam 所建议的那样，Instruments 对于这类事情来说是一个非常有用的工具。它相当容易使用，但一开始可能会有点不知所措。我建议您在开始时仔细阅读[Instruments 用户指南。](http://developer.apple.com/documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/Introduction/chapter_1_section_1.html)在您使用 Instruments 一段时间之前，它非常容易理解并且很有帮助。然而，即使没有阅读指南，Instruments 仍然比使用 NSLog() 调用乱扔代码并尝试自己解析输出更容易和更直观；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T16:39:39.830

我还发现[NSZombie](http://www.cocoadev.com/index.pl?DebuggingAutorelease)技巧对于追踪过度释放对象的情况很有用。

基本上，该链接描述了一个“技巧”，以便释放的对象被 NSZombie 对象替换，如果它们再次被释放，则会引发异常。

然后，您可以使用[Instruments](http://www.corbinstreehouse.com/blog/index.php/2007/10/instruments-on-leopard-how-to-debug-those-random-crashes-in-your-cocoa-app/)追溯对象的分配位置。

# php - 使用 htmlentities 获取 €

> ID：416161
> 
> 赞同：3
> 
> 时间：2009-01-06T11:21:12.750
> 
> 标签：php, character-encoding, html-entities

我真的想展示 htmlentities 给了我什么，但它没有给 & euro; 对于 € 字符。

我在尝试

```
echo htmlentities(htmlentities("LISBOA-VIENA DESDE 99€ TAXAS INCLUÍDAS, RESERVE JÁ",ENT_COMPAT,ISO-8859-1),ENT_COMPAT,ISO-8859-1);
    echo '<br>';
    echo htmlentities(htmlentities("LISBOA-VIENA DESDE 99€ TAXAS INCLUÍDAS, RESERVE JÁ",ENT_COMPAT,UTF-8),ENT_COMPAT,UTF-8); 
```

对于这两个我得到

LISBOA-VIENA DESDE 99€ TAXAS INCLUÍDAS, RESERVE JÁ

LISBOA-VIENA DESDE 99€ TAXAS INCLUÍDAS, RESERVE JÁ

我从来没有得到&欧元；

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T12:58:26.843

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-06T11:35:37.167

使用`ISO-8859-15`而不是`ISO-8859-1`.

`ISO-8859-15 (ISO Latin 9)`不同于`ISO-8859-1 (ISO Latin 1)`并添加了欧元符号以及缺少的法语和芬兰字母`Latin-1 (ISO-8859-1)`。

```
echo htmlentities('Working htmlentities() now 99€ off!', ENT_COMPAT, 'ISO-8859-15'); 
```

应该返回

```
Working htmlentities() now 99&euro; off! 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T11:36:22.127

这在[这里](http://www.cs.tut.fi/~jkorpela/html/euro.html)讨论；似乎€ ( `&#8364;`) 经常起作用。

# c++ - 作为指针传递的函数内部的赋值？

> ID：416162
> 
> 赞同：5
> 
> 时间：2009-01-06T11:21:18.177
> 
> 标签：c++, function, pointers, parameters

```
ClassA* pa = NULL;
ClassA* pb = NULL;

void assignObject(ClassA* pa, ClassB* pb) 
{
  pa = new ClassA;
  pb = new ClassB;
} 
```

执行该函数的值`pa`和之后是什么？`pb`

如果 pa,pb 为 NULL，编辑如何作为指针传递是返回

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-06T11:35:28.710

正如其他答案中所指出的 - 通话后两者仍然为 NULL 。但是，这个问题有两种可能的解决方案：

1)**参考资料**

```
void assignObject(ClassA*& pa, ClassB*& pb)
{
    pa = new ClassA;
    pb = new ClassB;
}

ClassA* pa = NULL;
ClassA* pb = NULL;
assignObject(pa, pb); // both will be assigned as expected. 
```

2)**指针**

```
void assignObject(ClassA** pa, ClassB** pb)
{
    assert(pa != NULL); assert(pb != NULL);
    *pa = new ClassA;
    *pb = new ClassB;
}
ClassA* pa = NULL;
ClassA* pb = NULL;
assignObject(&pa, &pb); // both will be assigned as expected. 
```

大多数程序员可能会选择引用，因为这样他们就不需要断言任何东西（引用永远不能为 NULL）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T11:26:31.460

它们将为 NULL，因为您按值传递它们。如果你想通过引用传递它，你可以这样做：

```
ClassA* pa = NULL;
ClassA* pb = NULL;
assignObject(ClassA*& pa, ClassB*& pb)
{
    pa = new ClassA;
    pb = new ClassB;
} 
```

请注意，我不确定您要使用全局变量来完成什么。在此示例中从未使用它们，因为局部变量（函数参数）隐藏了它们。

我认为您还需要为您的函数声明一个返回值类型，以使其成为有效的 C++。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T11:25:43.940

```
ClassA* pa = NULL;
ClassA* pb = NULL;

void assignObject(ClassA* &pa,ClassB* &pb)
{
    pa = new ClassA;
    pb = new ClassB;
} 
```

或者：

```
ClassA* pa = NULL;
ClassA* pb = NULL;

void assignObject(ClassA** pa,ClassB** pb)
{
    *pa = new ClassA;
    *pb = new ClassB;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T11:23:31.090

NULL，因为您按值传递指针。

# .net - 我应该推出自己的 ParseInt32 版本吗？

> ID：416182
> 
> 赞同：2
> 
> 时间：2009-01-06T11:30:58.393
> 
> 标签：.net, performance, parsing

我正在编写一个高性能解析器，在我看来这`Int32.Parse`可能太慢了。我写了一个假设正确输入的简单版本，它的性能要好得多。那么我应该创建自己的版本吗？还是已经有另一种更快的方法可用？

我的方法是这样的：

```
// parse simple int, assuming relatively correct input (i.e. all digits)
public static int ParseInt32Simply(string str) {
    if (str == null) throw new ArgumentNullException("str");
    if (str.Length == 0) throw new ArgumentException("str is empty");

    int sign = 1, index = 0;
    if (str[0] == '-') { sign = -1; index = 1; }
    else if (str[0] == '+') { index = 1; }

    int result = 0;
    for (; index < str.Length; ++index) {
        result = 10 * result + (str[index] - '0');
    }

    if (result < 0) throw new OverflowException(str + " is too large for Int32");

    return result * sign;
} 
```

我的结果与内置等效项非常不同：

```
Int32.Parse      took 8.2775453 seconds
ParseInt32Simply took 0.6511523 seconds
Int32.Parse      took 6.7625807 seconds
ParseInt32Simply took 0.4677390 seconds 
```

（在我的机器上运行 2500 万次迭代；P4 3 GHz，运行 VS 2008 SP1）

那么，我应该使用我的版本吗？或者我可以使用另一种方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T11:33:12.240

您是否分析过您的代码以确定 ParseInt32 实际上是瓶颈？我不会替换你正在编码的环境的“标准库”的一部分，除非你确定你会看到好处。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T12:04:46.063

在.net`Int32.Parse`中非常*非常*快，当它成功时。

当它失败时，它会抛出一个异常——然后它非常慢，因为异常很慢。

您需要扩展您的测试 - 您需要检查与您需要它执行的操作相似的好字符串和坏字符串模式的时间。

如果您非常确定所有字符串都是有效的整数，那么`Int32.Parse`就是要走的路。如果您怀疑只有很少一部分是有效的，那么使用它会快得多`Int32.TryParse`，而不是`try-catch`循环中的 a 。

通常，如果您`try-catch`在循环使用之外`Int32.Parse`- 您将在第一次获得无效值时遇到异常并停止。

如果您`try-catch`在循环内，请`Int32.TryParse`改用。

两者都经过高度优化`Int32.Parse`并且`Int32.TryParse`相对成熟 - 我希望它们很难改进，除非您有专门的情况。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-06T11:46:07.580

我的观点是，如果您节省的时间很重要并且对您的应用程序有益，那么就去做吧。

我们在 XML 解析中遇到了一个类似的问题，出于性能原因选择手动进行，但它基于已知环境 - 我们正在提供 XML，因此我们可以相当安全地在解析中采取捷径。

显然，风险在于它不太可能作为标准库版本完整，因此团队的新开发人员需要意识到这一点，以免他们做一些事情来破坏它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-06T12:14:57.447

是的 - 只要您 100% 确定源数据是您可以控制的（因此始终符合您的 Int32 格式），您就可以使用您自己的解析 int 版本。此外，您应该使用与世界其他地方隔离的自己的代码，因为如果您在要发布的某个库中拥有此代码，人们可能希望拥有 Int32.Parse 的标准行为。如果你不能提供，那对他们没有好处。但是，正如这里的许多人所建议的那样，如果您想充分发挥自己的性能，您应该确定这是真正需要做的事情。但是，您可能比这里的任何人都更了解自己的代码。

我个人会尽量避免改变解析。如果还有其他瓶颈，那么这些可能值得首先调查。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-06T12:24:48.067

如果您的测试是可验证的，并且您确实需要性能提升（例如，您每秒调用数万次函数）而不是去追求它。

我只想更改名称...因为*ParseInt32Simply*不会告诉维护程序员任何事情。我认为像*TrustedSourceInt32Parse*或*GuaranteedInt32Parse*这样的名称或类似的名称是更好的名称。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-06T11:36:09.473

我认为这里的主要问题是您的句子*假定输入正确*。通过阅读您的代码，它似乎无法正确处理“12x”。

Int32.Parse 做了很多事情来验证输入，甚至可能会注意你的文化来处理一些文化差异，尽管我想不出任何专门针对 Int32 的东西。

您确定代码中的瓶颈是 Int32 吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T12:08:23.777

你如何测量速度？我试过这个：

```
Stopwatch sw = new Stopwatch();
Random rand = new Random();

for (int n = 0; n < 10; n++)
{
    sw.Start();
    for (int i = 0; i < 1000000; i++)
    {
        ParseInt32Simply(rand.Next().ToString());
    }
    sw.Stop();
    Console.WriteLine(sw.Elapsed.Ticks + " - ParseInt32Simply");
    sw.Reset();

    sw.Start();
    for (int i = 0; i < 1000000; i++)
    {
        int.Parse(rand.Next().ToString());
    }
    sw.Stop();
    Console.WriteLine(sw.Elapsed.Ticks + " - int.Parse");
    sw.Reset();
    Console.WriteLine();
} 
```

结果完全不同：

2932852 - ParseInt32Simply
4684522 - int.Parse

3003988 - ParseInt32Simply
4666928 - int.Parse

2892545 - ParseInt32Simply
4660209 - int.Parse

2888998 - ParseInt32Simply
4636007 - int.Parse

2955727 - ParseInt32Simply
4668501 - int.Parse

2929210 - ParseInt32Simply
4653799 - int.Parse

2893706 - ParseInt32Simply
4671503 - int.Parse

2899547 - ParseInt32Simply
4633957 - int.Parse

您的简单方法仍然更快，但不到 2 倍（这实际上是非常好的性能！）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-06T15:16:29.827

如果您解析一种您知道是有效数字的格式，您确实可以编写一个更快的自定义解析器。我曾经为了同样的目的写过一个 Double.Parse 函数。并且从最低有效数字开始更快。这样你就可以增加你解析的数字的力量。

我已经创建了一个快速实现，

```
public static Int32 ParseValidNumberAsInt32(string str)
{
    if (str == null) 
        throw new ArgumentNullException("str");
    if (str.Length == 0) 
        throw new ArgumentException("str is empty");
    Int32 result = 0;
    Int32 currentPower = 1;
    Boolean isNegative = str[0] == '-';

    for (int currentCharIndex = str.Length - 1; currentCharIndex > 0; currentCharIndex--)
    {
        result += (str[currentCharIndex] - '0') * currentPower;
        currentPower *= 10;
    }
    return isNegative ? -1 * result : result + ((str[0] - '0') * currentPower);
} 
```

如果你真的想要速度，你可以写一个不安全的实现..

如果您解析一个大文件，您可以将文件作为原始字节读取并使用它们。这将使它更快（不转换为 unicode 字符串，不将字符串拆分为行，不拆分子字符串中的行，不解析子字符串），但是您将失去可维护性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-06T16:36:18.713

看看这个博客条目： Karl Seguin 的[快速字符串到整数转换](http://codebetter.com/blogs/karlseguin/archive/2007/01/15/Fast-string-to-integer-conversion.aspx)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-06T11:39:15.880

对 null 和空字符串的验证是不够的，您应该检查参数是否为有效整数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-06T11:52:53.980

你的测试怎么样？看来你的测试不行。

当我循环 50000 次时，我只有很小的差异，然后我有大约 30K 滴答声的差异有利于您的自定义方法，但这对于普通方法的优势是可以忽略的

# java - 在 Java 关键部分中，我应该同步什么？

> ID：416183
> 
> 赞同：75
> 
> 时间：2009-01-06T11:31:02.213
> 
> 标签：java, multithreading, synchronized

在 Java 中，在代码中声明临界区的惯用方式如下：

```
private void doSomething() {
  // thread-safe code
  synchronized(this) {
    // thread-unsafe code
  }
  // thread-safe code
} 
```

几乎所有块都在 上同步 `this`，但这有什么特别的原因吗？还有其他可能性吗？关于要同步的对象是否有任何最佳实践？（例如`Object`? 的私有实例）

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-01-13T16:12:21.980

正如较早的回答者所指出的那样，最佳实践是在有限范围的对象上进行同步（换句话说，选择您可以摆脱的最严格的范围并使用它。）特别是，同步`this`是一个坏主意，除非您打算允许您班级的用户获得锁定。

但是，如果您选择在`java.lang.String`. 字符串可以（并且在实践中几乎总是）被实习。这意味着在**整个 JVM**中，每个内容相同的字符串在幕后都是相同的字符串。这意味着如果您在任何字符串上同步，另一个（完全不同的）代码部分也锁定在具有相同内容的字符串上，实际上也会锁定您的代码。

我曾经对生产系统中的死锁进行故障排除，并且（非常痛苦地）将死锁跟踪到两个完全不同的开源包，每个包在一个 String 实例上同步，其内容都是`"LOCK"`.

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-01-06T11:47:43.880

首先，请注意以下代码片段是相同的。

```
public void foo() {
    synchronized (this) {
        // do something thread-safe
    }
} 
```

和：

```
public synchronized void foo() {
    // do something thread-safe
} 
```

做**同样的事情**。除了代码可读性和样式外，对其中任何一个都没有偏好。

当你同步方法或代码块时，重要的是要知道你**为什么**要做这样的事情，你到底锁定**了什么对象，以及为了****什么目的**。

另请注意，在某些情况下，您可能希望*客户端同步*代码块，其中您要求的监视器（即同步对象）不一定`this`，例如在此示例中：

```
Vector v = getSomeGlobalVector();
synchronized (v) {
    // some thread-safe operation on the vector
} 
```

我建议您了解更多有关并发编程的知识，一旦您确切知道幕后发生的事情，它将为您提供很多帮助。你应该看看[Concurrent Programming in Java](https://rads.stackoverflow.com/amzn/click/com/0201310090)，一本关于这个主题的好书。如果您想快速深入了解该主题，请查看[Java Concurrency @ Sun](http://java.sun.com/docs/books/tutorial/essential/concurrency/)

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-01-06T11:35:59.130

我尽量避免同步，`this`因为这将允许外部引用该对象的每个人阻止我的同步。相反，我创建了一个本地同步对象：

```
public class Foo {
    private final Object syncObject = new Object();
    …
} 
```

现在我可以使用该对象进行同步，而不必担心任何人“窃取”锁。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-06T14:41:41.487

只是为了强调在 Java 中也有 ReadWriteLocks 可用，发现为 java.util.concurrent.locks.ReadWriteLock。

在我的大部分使用中，我将锁定分别为“用于阅读”和“用于更新”。如果您仅使用同步关键字，则对同一方法/代码块的所有读取都将被“排队”。一次只有一个线程可以访问该块。

在大多数情况下，如果您只是在阅读，您永远不必担心并发问题。当你在写的时候你担心并发更新（导致数据丢失），或者在写期间读（部分更新），你必须担心。

因此，在多线程编程期间，读/写锁对我来说更有意义。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-06T11:37:20.923

您需要在可以用作互斥锁的对象上进行同步。如果当前实例（*this*引用）合适（例如，不是单例），您可以使用它，因为在 Java 中任何对象都可以用作互斥体。

在其他情况下，您可能希望在多个类之间共享一个 Mutex，如果这些类的实例可能都需要访问相同的资源。

这在很大程度上取决于您工作的环境和您正在构建的系统类型。在我见过的大多数 Java EE 应用程序中，实际上并没有真正需要同步......

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-15T07:35:12.037

就个人而言，我认为坚持同步永远不会或很少正确的答案`this`是错误的。我认为这取决于您的 API。如果你的类是一个线程安全的实现并且你记录了它，那么你应该使用`this`. 如果同步不是为了使类的每个实例在调用它的公共方法时作为一个整体线程安全，那么您应该使用私有内部对象。可重用的库组件*通常*属于前一类——在不允许用户将 API 包装在外部同步中之前，您必须仔细考虑。

在前一种情况下， using`this`允许以原子方式调用多个方法。一个例子是 PrintWriter，您可能想要输出多行（例如到控制台/记录器的堆栈跟踪）并保证它们一起出现 - 在这种情况下，它在内部隐藏同步对象的事实是一个真正的痛苦。另一个这样的例子是同步的集合包装器——你必须在集合对象本身上同步才能进行迭代；由于迭代由多个方法调用组成，因此您**无法**在内部完全保护它。

在后一种情况下，我使用普通对象：

```
private Object mutex=new Object(); 
```

但是，看到许多 JVM 转储和堆栈跟踪说锁是“java.lang.Object() 的实例”，我不得不说，正如其他人所建议的那样，使用内部类通常可能更有帮助。

无论如何，这是我的两分钱。

编辑：另一件事，在同步时，`this`我更喜欢同步方法，并保持方法非常精细。我认为它更清晰，更简洁。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-06T12:26:53.520

Java 中的同步通常涉及在同一实例上同步操作。然后同步`this`是非常惯用`this`的，因为共享引用在类中的不同实例方法（或部分）之间自动可用。

例如，通过声明和初始化私有字段`Object lock = new Object()`来使用另一个专门用于锁定的引用，这是我从未需要或使用过的东西。我认为它仅在您需要对对象内的两个或多个未同步资源进行外部同步时才有用，尽管我总是会尝试将这种情况重构为更简单的形式。

无论如何，隐式（同步方法）或显式`synchronized(this)`使用很多，在 Java 库中也是如此。这是一个很好的习惯用法，如果适用，应该始终是您的首选。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-06-23T13:43:55.783

您同步的内容取决于可能与此方法调用发生冲突的其他线程可以同步的内容。

如果`this`是一个仅由一个线程使用的对象，并且我们正在访问一个在线程之间共享的可变对象，那么一个很好的候选者是在该对象上同步 - 同步`this`没有意义，因为修改该共享对象的另一个线程甚至可能不会知道`this`，但确实知道那个对象。

另一方面，`this`如果许多线程同时调用该对象的方法，则同步结束是有意义的，例如，如果我们处于单例中。

请注意，同步方法通常不是最佳选择，因为我们在方法运行的整个过程中都持有锁。如果它包含耗时但线程安全的部分，以及不那么耗时的线程不安全部分，则通过该方法进行同步是非常错误的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-04-19T16:21:43.500

> 几乎所有块都在此同步，但这有什么特别的原因吗？还有其他可能性吗？

此声明同步整个方法。

```
private synchronized void doSomething() { 
```

此声明同步了部分代码块而不是整个方法。

```
private void doSomething() {
  // thread-safe code
  synchronized(this) {
    // thread-unsafe code
  }
  // thread-safe code
} 
```

从 oracle 文档[页面](https://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)

使这些方法同步有两个效果：

*首先，同一对象上的同步方法的两次调用不可能交错*。当一个线程正在为一个对象执行同步方法时，所有其他为同一对象调用同步方法的线程都会阻塞（暂停执行），直到第一个线程处理完该对象。

> 还有其他可能性吗？关于要同步的对象是否有任何最佳实践？（比如对象的私有实例？）

同步有许多可能性和替代方案。您可以使用高级并发[API](https://docs.oracle.com/javase/tutorial/essential/concurrency/highlevel.html)（自 JDK 1.5 版本起可用）使您的代码线程安全

```
Lock objects
Executors
Concurrent collections
Atomic variables
ThreadLocalRandom 
```

有关详细信息，请参阅以下 SE 问题：

[同步与锁定](https://stackoverflow.com/questions/4201713/synchronization-vs-lock/34267717#34267717)

[在 Java 中避免同步（this）？](https://stackoverflow.com/questions/442564/avoid-synchronizedthis-in-java/36692190#36692190)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-05-10T01:01:47.063

最佳实践是创建一个对象仅提供锁：

```
private final Object lock = new Object();

private void doSomething() {
  // thread-safe code
  synchronized(lock) {
    // thread-unsafe code
  }
  // thread-safe code
} 
```

通过这样做，您是安全的，没有调用代码可以通过无意的行使您的方法死锁`synchronized(yourObject)`。

（*感谢@jared 和@yuval-adam，他们在上面更详细地解释了这一点。*）

我的猜测是`this`在教程中使用的流行来自早期的 Sun javadoc：[https ://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html](https://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-06-07T19:29:27.743

同步包括 3 个部分：原子性、可见性和排序

同步块是非常粗略的同步级别。它按照您的预期强制执行可见性和排序。但是对于原子性，它并没有提供太多的保护。原子性需要程序的全球知识而不是本地知识。（这使得多线程编程非常困难）

假设我们有一个`Account`具有方法`deposit`和的类`withdraw`。它们都是基于这样的私有锁同步的：

```
class Account {
    private Object lock = new Object();

    void withdraw(int amount) {
        synchronized(lock) {
            // ...
        }
    }

    void deposit(int amount) {
        synchronized(lock) {
            // ...
        }
    }
} 
```

考虑到我们需要实现一个处理传输的更高级别的类，如下所示：

```
class AccountManager {
    void transfer(Account fromAcc, Account toAcc, int amount) {
        if (fromAcc.getBalance() > amount) {
            fromAcc.setBalance(fromAcc.getBalance() - amount);
            toAcc.setBalance(toAcc.getBalance + amount);
        }
    }
} 
```

假设我们现在有 2 个帐户，

```
Account john;
Account marry; 
```

如果`Account.deposit()`和`Account.withdraw()`仅使用内部锁锁定。当我们有 2 个线程工作时，这将导致问题：

```
// Some thread
void threadA() {
    john.withdraw(500);
}

// Another thread
void threadB() {
    accountManager.transfer(john, marry, 100);
} 
```

因为两者都可以同时`threadA`运行`threadB`。并且线程B完成条件检查，线程A退出，线程B再次退出。这意味着即使他的账户没有足够的钱，我们也可以从约翰那里提取 100 美元。这将破坏原子性。

您可能会建议：为什么不添加`withdraw()`and`deposit()`呢`AccountManager`？但是根据这个提议，我们需要创建一个多线程保险箱`Map`，将不同帐户映射到它们的锁。我们需要在执行后删除锁（否则会泄漏内存）。我们还需要确保没有其他人`Account.withdraw()`直接访问。这将引入许多微妙的错误。

正确和最惯用的方法是在`Account`. 并让`AccountManager`使用锁。但是在这种情况下，为什么不直接使用对象本身呢？

```
class Account {
    synchronized void withdraw(int amount) {
        // ...
    }

    synchronized void deposit(int amount) {
        // ...
    }
}

class AccountManager {
    void transfer(Account fromAcc, Account toAcc, int amount) {
        // Ensure locking order to prevent deadlock
        Account firstLock = fromAcc.hashCode() < toAcc.hashCode() ? fromAcc : toAcc;
        Account secondLock = fromAcc.hashCode() < toAcc.hashCode() ? toAcc : fromAcc;

        synchronized(firstLock) {
            synchronized(secondLock) {
                if (fromAcc.getBalance() > amount) {
                    fromAcc.setBalance(fromAcc.getBalance() - amount);
                    toAcc.setBalance(toAcc.getBalance + amount);
                }
            }
        }
    }
} 
```

简而言之，私有锁不适用于稍微复杂的多线程程序。

# javascript - 如何捕捉 Flash 播放器的点击？

> ID：416185
> 
> 赞同：4
> 
> 时间：2009-01-06T11:31:38.313
> 
> 标签：javascript, flash

我在我的网页上使用 SWFObject 作为 Flash 播放器。播放器像往常一样有播放、停止、暂停等按钮。我需要抓住时刻，当我的用户点击任何按钮时，我需要在这段时间内执行一些 JS 功能。对不起我的英语，提前非常感谢。PS 我没有我的 swf 文件的来源。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T11:39:11.527

AFAIK，这是通过`getURL()`函数完成的。您需要在 flash 文件的操作脚本中定义以下内容：

```
this.onClick = function(){ 
    getURL("javascript:yourFunctionName();");
}; 
```

这意味着您不能只获取任何 flash 文件并使其调用 JS 函数，它必须在 flash 文件本身中定义。

如果我错了，我很想听听如何在不编辑 Flash 本身的情况下更通用地完成此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T11:41:35.343

从 Flash 调用 javascript 函数也可以使用[ExternalInterface](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html)来实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T21:24:33.793

唔...

冒着走投无路的风险，我实际上认为在跨浏览器 Javascript 的范围内没有任何方法可以像这样挂钩特定的 Flash 播放器活动。事实上，如果有的话，我确实会感到非常惊讶——尽管我很想从比我更有知识的人那里听到其他消息。:)

假设这是真的，除了通过某种组合（在页面上下文中运行的 Javascript 中）监听 ActiveX/插件对象本身引发的焦点和单击事件（这可能不是非常具体或可靠 - - 我什至不认为点击事件会引发），我怀疑你会有很多运气。

从我到目前为止所做的简短测试来看：

```
window.onload = function()
{
    document.onclick = function()
    {
        alert("Clicked the page!");
    }

    document.getElementById("mySWFObjectID").onfocus = function()
    {
        alert("Focused the player!");
    }

    document.getElementById("mySWFObjectID").onclick = function()
    {
        alert("Clicked the player!");
    }
} 
```

...播放器似乎没有将点击事件冒泡到页面；在 IE 中，焦点事件会触发，但在 Firefox 中不会，并且只有一次，当控件获得焦点时。因此，除了编写某种浏览器插件以使您获得比在 Javascript 级别公开的更低级别的访问权限之外，您可能在这方面不走运。

但是再一次，如果那里有人不知道...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T11:44:17.087

您可以使用 onPress 方法。

例子

[button_name].onPress = function(){

//这里就是你想做的事情

}

# image - 使用 Jython 获取图像属性

> ID：416190
> 
> 赞同：0
> 
> 时间：2009-01-06T11:33:54.253
> 
> 标签：image, jython

我正在使用 Jython 来移动图像并组织它们。我想从图像中提取一些信息，例如尺寸和文件大小。

我将如何使用 Jython 执行此操作？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T11:36:18.973

[Python 图像库](http://www.pythonware.com/products/pil/)。

# internet-explorer - W3C 验证的 CSS 是否自动意味着跨浏览器兼容性？

> ID：416206
> 
> 赞同：4
> 
> 时间：2009-01-06T11:39:25.503
> 
> 标签：internet-explorer, validation, cross-platform, cross-browser

我终于完成了我第一个支持 CSS 的网站的工作版本（感谢这个论坛上的一些非常有用的建议）并验证了 CSS。在我出去寻找（购买？）另一台机器（我是 Mac）来检查 IE 之前，有效的 CSS 在我曾经检查过的 IE 以及 Firefox、Safari 上是否真的有效？到目前为止我的代码？谢谢，帕特里克。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T11:41:18.997

不，W3C 根据 CSS 标准进行验证。不幸的是，流行的浏览器（阅读：MSIE 6.0）不是很符合标准；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T11:42:53.937

我认为这完全取决于你的 CSS 和布局有多复杂——如果它很复杂，那么我会毫不犹豫地说“不”。你最好的选择是在其他平台上检查它。

您可能想查看 BrowserCam - 他们在所有主要（和一些次要）浏览器中对网站进行屏幕截图，并且更昂贵的帐户允许您使用 VNC 在这些平台上实际进行交互。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T11:58:04.047

并非所有浏览器都完全、正确和一致地实现所有 CSS 功能，尤其是在涉及 CSS2 或即将推出的 CSS3 时。 [不过， W3Schools.com](http://www.w3schools.com/css/default.asp)可以为您提供帮助，因为它列出了哪些功能与哪些浏览器兼容——尽管我不确定这些信息的最新程度。

最后，在所有流行的浏览器上进行测试几乎没有替代品。我建议安装[Wine](http://wiki.winehq.org/MacOSX)、[Parallels](http://tinyurl.com/9xfcqz)或[VMWare](http://www.vmware.com/products/fusion/)并测试 IE 和[Chrome](http://www.google.com/chrome)。如果 Konqueror 可以在 OSX 上运行，那么测试它可能也不错。

如果安装其中一个过于 PITA（或者如果 IE 和 Chrome 无法在 Wine 或 Parallels 上运行——我不太确定——而且你没有要在 VMWare 上安装的 XP 副本），你可能有一个朋友运行你可以使用的 Windows。最坏的情况是，大多数库都有可以测试的 Windows 机器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T12:31:50.823

请记住，验证器只能查看您的语法是否正确。它无法理解您要实现的布局，因此您的页面验证*永远不会*表明它在所有浏览器中都能按您的意愿工作。它可能会，但验证本身不能告诉你。

但是，验证您的页面仍然是一个好主意。如果没有语法错误，一切正常工作的机会就会增加。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-20T07:46:06.467

To rescue the web designers from this aching job of testing browser compatibility in different browsers there are few websites which offer this service. On these websites you can check the compatibility of your website in all desired browsers. You can find these websites at [http://www.bestpsdtohtml.com/7-awesome-resources-to-test-cross-browser-compatibility-of-your-website/](http://www.bestpsdtohtml.com/7-awesome-resources-to-test-cross-browser-compatibility-of-your-website/)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-06T11:45:06.693

“有效的 CSS 是否真的有可能在 IE 以及 Firefox、Safari 上真正有效，到目前为止我用来检查我的代码？”

有效的？就像被浏览器接受一样？是的。

看起来一样？不必要。

如果您的页面足够简单并且避免了所有已知的 IE 不兼容问题，那么您就可以开始了。[我们尝试这样做：避免奇怪的东西，使用表格，接受一刀切的浏览器的限制。]

我的建议是你在你的页面上放一个“下载 Firefox”徽章，而不用担心 IE。

# java - 枚举的 JPA 映射集合

> ID：416208
> 
> 赞同：104
> 
> 时间：2009-01-06T11:40:19.293
> 
> 标签：java, jpa, jakarta-ee

JPA 中有没有办法在 Entity 类中映射枚举集合？或者唯一的解决方案是用另一个域类包装 Enum 并使用它来映射集合？

```
@Entity
public class Person {
    public enum InterestsEnum {Books, Sport, etc...  }
    //@???
    Collection<InterestsEnum> interests;
} 
```

我正在使用 Hibernate JPA 实现，但当然更喜欢实现无关的解决方案。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2009-03-13T13:50:47.250

使用休眠你可以做

```
@CollectionOfElements(targetElement = InterestsEnum.class)
@JoinTable(name = "tblInterests", joinColumns = @JoinColumn(name = "personID"))
@Column(name = "interest", nullable = false)
@Enumerated(EnumType.STRING)
Collection<InterestsEnum> interests; 
```

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2012-02-27T01:24:29.357

Andy 答案中的链接是在 JPA 2 中映射“非实体”对象集合的一个很好的起点，但在映射枚举时并不完整。这是我想出的。

```
@Entity
public class Person {
    @ElementCollection(targetClass=InterestsEnum.class)
    @Enumerated(EnumType.STRING) // Possibly optional (I'm not sure) but defaults to ORDINAL.
    @CollectionTable(name="person_interest")
    @Column(name="interest") // Column name in person_interest
    Collection<InterestsEnum> interests;
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-03-22T21:44:57.633

我能够以这种简单的方式完成此任务：

```
@ElementCollection(fetch = FetchType.EAGER)
Collection<InterestsEnum> interests; 
```

急切加载是必需的，以避免延迟加载初始化错误，如此[处](https://stackoverflow.com/questions/11746499/solve-failed-to-lazily-initialize-a-collection-of-role-exception)所述。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2020-04-18T00:41:18.090

tl; dr 一个简短的解决方案如下：

```
@ElementCollection(targetClass = InterestsEnum.class)
@CollectionTable
@Enumerated(EnumType.STRING)
Collection<InterestsEnum> interests; 
```

长答案是，使用此注释 JPA 将创建一个表，该表将保存指向主类标识符（在本例中为 Person.class）的 InterestsEnum 列表。

@ElementCollections 指定 JPA 在哪里可以找到有关 Enum 的信息

@CollectionTable 创建保存从 Person 到 InterestsEnum 关系的表

@Enumerated(EnumType.STRING) 告诉 JPA 将 Enum 持久化为字符串，可以是 EnumType.ORDINAL

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-01-27T22:27:11.570

我正在使用 java.util.RegularEnumSet 的轻微修改来获得持久的 EnumSet：

```
@MappedSuperclass
@Access(AccessType.FIELD)
public class PersistentEnumSet<E extends Enum<E>> 
    extends AbstractSet<E> {
  private long elements;

  @Transient
  private final Class<E> elementType;

  @Transient
  private final E[] universe;

  public PersistentEnumSet(final Class<E> elementType) {
    this.elementType = elementType;
    try {
      this.universe = (E[]) elementType.getMethod("values").invoke(null);
    } catch (final ReflectiveOperationException e) {
      throw new IllegalArgumentException("Not an enum type: " + elementType, e);
    }
    if (this.universe.length > 64) {
      throw new IllegalArgumentException("More than 64 enum elements are not allowed");
    }
  }

  // Copy everything else from java.util.RegularEnumSet
  // ...
} 
```

这个类现在是我所有枚举集的基础：

```
@Embeddable
public class InterestsSet extends PersistentEnumSet<InterestsEnum> {
  public InterestsSet() {
    super(InterestsEnum.class);
  }
} 
```

我可以在我的实体中使用该集合：

```
@Entity
public class MyEntity {
  // ...
  @Embedded
  @AttributeOverride(name="elements", column=@Column(name="interests"))
  private InterestsSet interests = new InterestsSet();
} 
```

*好处：*

*   使用代码中设置的类型安全且高性能的枚举（参见`java.util.EnumSet`描述）
*   该集合只是数据库中的一个数字列
*   一切都是普通的 JPA（没有提供者特定的*自定义类型*）
*   与其他解决方案相比，相同类型的新字段的简单（和简短）声明

*缺点：*

*   代码重复（`RegularEnumSet`和`PersistentEnumSet`几乎相同）
    *   您可以将结果包装`EnumSet.noneOf(enumType)`在您的`PersistenEnumSet`, 声明`AccessType.PROPERTY`并提供两种使用反射来读取和写入`elements`字段的访问方法
*   每个应该存储在持久集中的枚举类都需要一个额外的集类
    *   如果您的持久性提供程序支持没有公共构造函数的嵌入，您可以添加`@Embeddable`和`PersistentEnumSet`删除额外的类 ( `... interests = new PersistentEnumSet<>(InterestsEnum.class);`)
*   `@AttributeOverride`如果您的实体中有多个，则必须使用一个，如我的示例中所示`PersistentEnumSet`（否则两者都将存储到同一列“元素”）
*   在构造函数中`values()`使用反射不是最佳的（尤其是在查看性能时），但其他两个选项也有其缺点：
    *   类似的`EnumSet.getUniverse()`实现使用了一个`sun.misc`类
    *   提供值数组作为参数存在给定值不是正确值的风险
*   只支持最多 64 个值的枚举（这真的是一个缺点吗？）
    *   您可以改用 BigInteger
*   在条件查询或 JPQL 中使用元素字段并不容易
    *   如果您的数据库支持，您可以使用二进制运算符或具有适当功能的位掩码列

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T11:52:27.460

JPA 中的集合指的是一对多或多对多的关系，它们只能包含其他实体。抱歉，您需要将这些枚举包装在一个实体中。如果您考虑一下，无论如何您都需要某种 ID 字段和外键来存储此信息。那是除非你做一些疯狂的事情，比如在字符串中存储一个逗号分隔的列表（不要这样做！）。

# excel - 如何使用Excel中的条件将数据从sheet1复制到sheet2

> ID：416214
> 
> 赞同：1
> 
> 时间：2009-01-06T11:41:55.530
> 
> 标签：excel

在 excel 工作簿中，我试图将数据从 sheet1 复制到 sheet2，条件是 IF((Sheet1!B2:B80=Sheet2!A2:A80),Sheet2!D2) 我没有得到结果。请帮我解决这个问题。

我正在尝试从 sheet1 复制到 sheet2 的条件是，如果工作表 1 中的值 B 列等于 sheet2 列 A 中的值，则工作表 2 的 D 列中的值应复制到 sheet1 的 G 列

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T11:48:17.547

尝试**逐步调试它**。如果你改变你的公式会发生什么：

```
=IF((Sheet1!B2:B3=Sheet2!A2:A3),Sheet2!D2) 
```

?

或者

```
=IF((Sheet1!B2:B3=Sheet2!A2:A3),"the same values") 
```

也许并非所有值在 A 列和 B 列中都完全相同。或者 D2 不包含您期望的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T11:58:40.693

将以下公式放入 G 列的第一个单元格中

```
=IF((Sheet1!B1=Sheet2!A1), Sheet2!D1) 
```

然后根据需要复制此单元格。Excel 将为您更改所有单元格引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T19:19:16.840

=IF(精确(Sheet1!B1,Sheet2!A1),Sheet2!D1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T11:51:21.860

这应该做你所追求的。

> =IF(Sheet1!B1=Sheet2!A1,Sheet2!D1)

# .net - ASP.NET MVC 和 FubuMVC 之间的主要区别是什么？

> ID：416218
> 
> 赞同：30
> 
> 时间：2009-01-06T11:43:06.213
> 
> 标签：.net, asp.net-mvc, fubumvc, alt.net

我认识的一位开发人员刚刚向我展示了[FubuMVC](http://mvc.fubu-project.org/)，我们是否应该尝试在实际项目中使用它存在一些问题。到目前为止，当前的设计选择是 ASP.NET MVC。

我有兴趣了解的是：

ASP.NET MVC 和 FubuMVC 的核心区别是什么？

这两个框架的收益/损失是什么？

FubuMVC 准备好迎接黄金时段了吗？

您会在新项目中使用这两个中的哪一个？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-07T21:59:51.710

@maz 这取决于您的应用程序要做什么、它的时间范围、它的重要性等。

首先，我鼓励你把两者都搞砸。总体而言，两者都没有比另一个更好或更差，它们是不同的，并且每个都有你应该考虑的显着优势和劣势。

在这一点上，ASP.NET MVC 更加成熟，也有更多的测试人员和眼球关注它。因此，如果您正在做任何类型的严肃项目（即您为此获得报酬），我会鼓励您在这一点上使用 ASP.NET MVC，因为它会更快地“发布”并得到更多支持。

（**更新**[2011 年 2 月 26 日]）：FubuMVC 现在被多家公司和团队用于成熟的生产应用程序，这些应用程序已经有几个基于 FubuMVC 的主要发布版本。虽然文档仍然有些缺乏，但框架的质量现在已经确定为具有生产价值）

如果您正在开始一个爱好项目（即个人博客、个人/家庭相册等），那么我会邀请您拿起 FubuMVC 并开始使用它。请记住，这一点基本上是我、杰里米和其他一些人的爱好，因此无法保证时间表等。它还没有真正公开宣布（无论好坏，它都被泄露了）所以没有还没有大量的贡献。我希望随着它的成熟，我们达到第一个里程碑，然后向广泛的世界宣布它，贡献将会增加。

最后，使用其中任何一种都可能会鼓励更好的开发实践，比如 ASP.NET WebForms，并且熟悉一种会使您更容易更快地掌握另一种。

这实际上取决于您正在从事的项目的重要性，因此请负责任地选择。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-06T17:10:05.400

似乎主要区别在于 FubuMVC 实现了[前端控制器](http://msdn.microsoft.com/en-us/library/ms978723.aspx)模式。

如果 ASP.NET MVC 还没有准备好迎接黄金时间（它是 Beta 版），我会怀疑 FubuMVC 是否已经准备好，因为它是前者的一个分支。

不过，FubuMVC 背后的人非常好，Chad Myers 和 Jeremy D. Miller 在社区中非常受尊重，并且是 ALT.NET 的非常活跃的成员。但 ASP.NET MVC 背后的人 Phill Haack、Scott Hanselman& Co 也是如此。

如果你只是想开始，我会推荐 ASP.NET MVC，因为它背后有更多的人和资源，如果你不喜欢你看到的东西，那就去 Fubu。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T20:09:20.903

我没有使用 Fubu Mvc，但只是看着它。它还没有完成，但我可能会用它来部分重写现有的非 web winforms 项目。Asp.Net Mvc 仅适用于 Web 项目。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-23T10:39:42.213

FubuMVC 上1 月 13 日[Herding Code 的播客链接](http://herdingcode.com/?p=131)

# javascript - 按键上下文的 JavaScript 检测（表单历史选择与表单提交）

> ID：416220
> 
> 赞同：3
> 
> 时间：2009-01-06T11:43:39.567
> 
> 标签：javascript, keypress, input-history

我正在使用 jQuery 编写一个半通用表单插件，以加快我正在从事的项目的开发。

计划是[jTemplates](http://jtemplates.tpython.com/)模板包含字段，我的插件通过模板查找任何所需的多语言资源，从服务器请求它们，然后将所有内容打包成一个 JavaScript 对象，然后传递给自定义函数“提交”。

一切都运行良好，除了在伪造表单时需要执行的标准“当按下输入时，提交表单”代码：

```
opts.coreElement.find('input[type=text]').keypress(function(evt) {
    if ((evt.keyCode || evt.which) == 13) {
        opts.coreElement.find('.saveButton').click();
    }
}); 
```

问题是在 Firefox 中（至少；我还没有检查过其他浏览器），如果您之前在类似名称的文本框中输入了信息，您将获得表单历史记录。如果您随后通过按 Enter 选择这些建议值之一，它会提交表单。如果您在页面上的第一个输入上，那就不好了。实际上，真的很烦人。

显而易见的解决方案似乎是在字段周围插入一个表单元素，并停止通过 jQuery 提交任何可能的虚拟表单。幸运的是，当我在 ASP.NET MVC 中时，我有幸这样做，但如果我没有这样做呢？如果我的插件不知道它是否已经在一个表单中，所以必须保持自己的状态怎么办？如果我在标准的 WebForms ASP.NET 中并且*必须*手动将每个输入的返回键“定位”到正确的提交按钮怎么办？

有没有办法，也许通过事件对象本身，来检测按键的上下文，所以我可以过滤掉表单历史项目的选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T12:31:19.487

我发现为了防止 [enter] 或 [tab] 键事件的默认操作，您必须侦听 keydown 事件并处理/取消它。
当 keyup 或 keypress 被触发时，keydown 的默认值已经发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T00:14:23.817

将`autocomplete`文本字段中的属性设置为`off`：

```
opts.coreElement.find('input[type=text]').each(function() {
     $(this).attr('autocomplete', 'off');
}); 
```

这适用于所有主要浏览器（Safari、Firefox、IE）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-07T11:50:39.380

wulong 的答案有效，但没有完全回答问题。建议的解决方案是禁用输入文本字段的历史记录。但是有没有办法知道按键事件是来自输入文本还是来自历史？

# webclient.uploaddata - WebClient.UploadData 错误：（401）未经授权

> ID：416221
> 
> 赞同：1
> 
> 时间：2009-01-06T11:44:11.830
> 
> 标签：webclient.uploaddata

我收到此错误...令我困惑的是，我没有为我正在调用的页面启用任何类型的安全性...

```
WebClient myWebClient = new WebClient();
myWebClient.UploadData(myUrl,"POST", myByteArray); 
```

当我直接访问页面时（在 ie 上）它工作正常，使用 WebClient 它不工作。

任何人都知道什么是错的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T11:48:55.983

IE 支持集成安全，它将使用您当前的登录凭据作为用户名和密码，因此您不必手动输入。

如果您使用的是 IE，请使用 Firefox 并查看是否提示您输入用户名和密码。或者，在 IE 中，您可以转到工具、选项、高级，然后取消选中集成 Windows 身份验证。

最有可能的是，您必须将 Web 应用程序配置为支持匿名访问，或者您必须在 WebClient 中实现安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T11:54:29.203

如果您正在努力追根究底，[Fiddler](http://www.fiddlertool.com/)可能会有所启发。您必须手动编辑代码以通过 Fiddler 代理，但一旦完成，您可以将 IE 结果与代码一进行比较。

# unit-testing - 你如何说服别人写单元测试？

> ID：416231
> 
> 赞同：13
> 
> 时间：2009-01-06T11:50:09.773
> 
> 标签：unit-testing

我已经被测试感染了很长时间，但似乎与我一起工作的大多数开发人员要么从未尝试过，要么出于某种原因将其解雇，通常的论点是它增加了开发开销，或者他们不需要打扰。

最困扰我的是，当我来更改他们的代码时，我很难对其进行测试，因为我必须应用重构以使其可测试，有时最终不得不做*很多*工作这样我就可以测试我要写的代码了。

我想知道的是，你会用什么论据来说服其他开发人员开始编写单元测试？我介绍过的大多数开发人员都很好地接受了它，看到了它的好处并继续使用它。不过，这似乎总是*优秀*的开发人员，他们已经对提高代码质量感兴趣，因此可以看到单元测试是如何做到这一点的。

如何说服其他杂牌船员？我不是在寻找测试优势的列表，因为*我*已经知道这些是什么，而是您已经使用或将使用哪些技术来吸引其他人。关于如何说服管理层发挥积极作用的技巧也值得赞赏

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T11:56:13.630

质量不言自明。如果你比其他人更成功，这就是你需要说的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-06T12:13:11.317

使用测试覆盖工具。让它非常显眼。这样每个人都可以很容易地看到每个区域有多少代码通过、失败和未经测试。

然后你可能会开始一种文化，其中“未经测试”是糟糕编码的标志，“失败”是正在进行的工作的标志，“通过”是完成代码的标志。

如果你也做“测试优先”，这效果最好。然后“未经测试”变为“您忘记了第 1 步”。

当然，您不需要 100% 的测试覆盖率。但是在一个区域有 1% 的覆盖率和另一个有 30% 的区域中，您有一个指标来确定哪个区域最有可能在生产中失败。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-06T14:02:20.380

我猜这个问题不止一方面。我发现实际上说服开发人员开始使用测试并不难，因为使用测试的优势列表通常不言自明。话虽如此，实际上要开始学习还是一个很大的障碍，而且我发现学习曲线通常有点陡峭——尤其是对于新手编码人员。向那些对 C#、.Net 或一般编程都不熟悉的人扔测试框架、TDD 测试优先的心态和模拟框架，可能实在是太难处理了。

我是一名顾问，因此我经常必须解决在组织中实施 TDD 的问题。幸运的是，当公司雇用我时，通常是因为我在某些领域的专业知识，因此在引起人们注意方面我可能有一点优势。或者只是作为一个局外人，我更容易进入一个新团队并说“嗨！我在其他项目上尝试过 TDD，我*知道*它有效！” 或者也许是我的说服力/固执？:) 无论哪种方式，我经常发现说服开发人员开始编写测试并不难。我发现困难的是教他们如何编写好的单元测试。正如您在问题中指出的那样；留在正义的道路上。

但是我发现了一种我认为在教授单元测试方面效果很好的方法。我在[这里写过博客](http://www.kjetilk.com/2008/12/effectively-teaching-test-first-make-it.html)，但本质是坐下来做一些结对编程。在进行结对编程时，我首先开始编写单元测试。通过这种方式，我向他们展示了测试框架是如何工作的，我如何构建测试以及经常使用一些模拟。单元测试应该很简单，所以总而言之，即使对于初级开发人员来说，测试也应该相当容易理解。最难解释的部分通常是模拟，但使用易于阅读的模拟框架，如[Moq](http://code.google.com/p/moq/)有很大帮助。然后，当编写测试时（没有任何编译或通过），我将键盘交给我的同事编码，以便他可以实现功能。我只是告诉她/他；“让它变绿！” 然后我们继续下一个测试；我编写测试，我旁边的“即将测试感染的开发者”编写功能。

现在，重要的是要了解，此时您正在教的开发人员可能还不相信这是正确的编码方式。大多数开发人员似乎看到（绿灯）的点是当测试由于一些他们从未认为会破坏任何功能的代码更改而失败时。当涵盖该功能的测试失败时，您就可以在团队中拥有一个忠诚的 TDD'er。或者这至少是我的经验，但一如既往；你的里程会有所不同:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-06T12:38:51.330

**以身作则**。如果你能得到证据表明单元测试代码的回归比其他地方少。

获得 QA 和管理层的支持，以便您的流程要求进行单元测试。

**准备好帮助**其他人开始进行单元测试：提供帮助、提供框架以便他们可以轻松开始、运行介绍性演示。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-06T11:53:13.013

你只需要习惯这句口头禅“如果它没有经过测试，工作就没有完成！”

**编辑：**为了在我上面的滑稽评论中添加更多内容，如果他们没有测试他们的工作，他们怎么知道他们是否真的完成了？

请注意，如果在估计已开发代码的测试中不允许有时间，您将有一场说服他人的战斗。

编码和测试之间的一对一分配似乎是一个不错的数字。

高温高压

干杯，

抢

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-06T12:00:08.067

称赞一个人写了更多的测试并产生了良好的结果，并向其他人展示了最好的一个，并要求他们产生与此相同或更好的结果。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-06T12:52:34.250

没有一个或多个痛点，人（和流程）就不会改变。因此，您需要找到重要的痛点并展示单元测试如何帮助处理它们。

如果您找不到任何重要的痛点，那么单元测试可能不会为您当前的流程增加很多价值。

正如史蒂夫洛特暗示的那样，提供比其他团队成员更好的结果也会有所帮助。但如果没有痛点，我的经验是人们不会改变。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-06T12:15:44.137

两种方法：说服项目经理单元测试可以提高质量并总体上节省时间，然后让他强制执行单元测试。

或者在重要的发布日期之前等待开发紧缩，每个人都必须加班和周末工作以完成最后的功能并消除最后的错误，结果却发现他们刚刚引入了更多错误。然后指出，通过适当的单元测试，他们不必那样工作。

单元测试可以被证明是必不可少的另一种情况是，当一个版本实际交付时，由于最后一分钟的更改而包含一个严重的错误。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-06T11:57:15.233

可能是reefnet_alex 的回答对您有所帮助： [单元测试值得付出努力吗？](https://stackoverflow.com/questions/67299/is-unit-testing-worth-the-effort#67500)

> 我认为是 Fowler 说的：“经常运行的不完美测试比从未编写过的完美测试要好得多”。我将此解释为允许我在我认为它们最有用的地方编写测试，即使我的其余代码覆盖范围非常不完整。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-06T12:00:18.583

如果开发人员看到“成功”的开发人员正在编写单元测试，但他们仍然没有这样做，那么我建议单元测试应该成为正式开发生命周期的一部分。

例如，在编写和审查单元测试之前，什么都不能签入。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-06T14:27:15.620

您提到您的经理参与了单元测试。如果是这样，那他（她）为什么不执行呢？让其他人跟随或教他们不是你的工作，事实上，如果你试图强迫他们，其他开发人员通常会怨恨你。为了让你的开发人员编写单元测试，经理必须**强烈**强调它。它可能最终强调单元测试实施的教育，你可能最终成为教育者，这很好，但它的管理就是一切。

如果您处于由团队决定实施方式的环境中，那么您对团队动态应该如何拥有更多的发言权。如果您处于那种环境中，并且团队不想在您这样做时强调单元测试，那么您可能在错误的组/公司中。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-06T14:42:28.023

我发现“传福音”或讲道很少奏效。正如其他人所说，按照自己的方式编写代码，让人们知道你这样做了，但不要试图强迫别人这样做。如果人们询问它，请给予支持和帮助。提供一些午餐时间的研讨会或非正式的狗和小马表演。这不仅仅是向你的经理或其他开发人员抱怨你很难为他们编写的代码编写测试。

缓慢而稳定 - 它不会在一夜之间改变。

一旦我意识到在我工作的一个地方，同行评审的接受度大大提高了。我的团队就这样做了，不再试图让其他人这样做。最终人们开始询问我们是如何取得一些成功的。然后就更容易了。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-28T02:44:32.207

我们有一个测试框架，其中包括在任何人提交更改时自动运行测试套件。如果有人提交的代码未能通过测试，整个团队都会收到包含错误的电子邮件。

这导致引入的错误很快得到修复。

# c - 字符串可以用作数组索引吗？

> ID：416237
> 
> 赞同：7
> 
> 时间：2009-01-06T11:53:12.373
> 
> 标签：c, arrays, associative-array

字符串可以用作C中的数组索引吗？

例：字符串 对应值 "ONE" 1 "TWO" 2 "FIVE" 5 "TEN" 10

当将上述列表中的字符串传递给函数时，函数必须返回上述对应的值。这可以通过声明一个以字符串为索引的常量数组来实现吗

```
int *x;
x["ONE"]  = 1;
x["TWO"]  = 2;
x["FIVE"] = 5;
x["TEN"]  = 5;

return x["string received by the function"]; 
```

上述逻辑并没有按预期工作；是否有解决方法来实现上述逻辑以获得字符串索引数组？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-06T11:57:59.040

它可能会编译，但它不会工作。

目前尚不完全清楚您要达到的目标。我认为你想要一个[关联数组](http://en.wikipedia.org/wiki/Associative_array)，在这种情况下你应该找到一个的库实现。

如果您正在寻找更像[枚举类型](http://en.wikipedia.org/wiki/Enumerated_type)的东西，并且可以依赖[C89](http://en.wikipedia.org/wiki/C89_(C_version) "C89 标准的维基百科")，请查看以下内容：

```
enum cardsuit {
   CLUBS,
   DIAMONDS,
   HEARTS,
   SPADES
}; 
```

如果你不能依赖 C89，那么你应该尝试一些`typedef`诡计。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-06T14:39:14.830

There are other excellent answers to what you should do, so I thought I'd explain what you are doing and why it's compiling and not working.

In C, array reference is done by having an array or pointer and an integer of some sort. (in x[1], x is the array and 1 is the integer). As long as you're using some integral type, it'll work as you expect.

Suppose you have something that's not an integer. In that case, the C implementation will see if it can convert it to the appropriate type, so you wind up with array and integer. It's cases like this where you get into trouble (and slightly more sophisticated versions of this in C++ have confused more experienced people than you).

In C, a literal string like "one" is of type const char *, meaning pointer to characters you can't change. The actual value is the memory address of where the string actually resides in memory. Normally, you'd pay no attention to this pointer value, and look at the string value, but there's a gotcha here.

In C, any data pointer can be converted to some sort of integer, and will be automatically. Therefore, you've got a string like "one", and its value is whatever number that represents the memory address. Use it where C expects some sort of integer, and it'll get converted to some integral value or other.

Therefore, this is what's happening with x["ONE"]. The C system has to put the string "ONE" somewhere in memory, and it doesn't matter where. It's likely to be somewhere with a fairly large memory address, quite possibly in the billions. When it sees x["ONE"], it tries to convert that value to an integer, and uses it as a subscript. Therefore, you're trying to access the array x far, far beyond its bounds, and that's causing the problem. Either you're trying to use memory you're not allowed to, and the system just stops you, or you're mucking with a chunk of memory you should be leaving alone, and it's likely to fail in some mysterious way later.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-06T12:45:24.247

`bsearch()`您可以使用提供的功能轻松构建查找表`stdlib.h`。一个工作示例是这样的：

```
#include <string.h>
#include <stdlib.h>
#include <stdio.h>

#define count(ARRAY) (sizeof(ARRAY)/sizeof(*ARRAY))

struct item
{
    const char * name;
    int value;
};

static _Bool sorted;

static struct item items[] =
{
    { "one", 1 },
    { "two", 2 },
    { "three", 3 },
    { "ten", 10 }
};

static int compare(const void * p1, const void * p2)
{
    return strcmp(*((const char **)p1), *((const char **)p2));
}

int get(const char * name)
{
    if(!sorted)
    {
        qsort(items, count(items), sizeof(*items), compare);
        sorted = 1;
    }

    struct item * item = bsearch(&name, items, count(items), sizeof(*items),
        compare);

    return item ? item->value : 0;
}

int main(int argc, char ** argv)
{
    int i;
    for(i = 1; i < argc; ++i)
        printf("%i\n", get(argv[i]));

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T11:59:04.467

您将需要编写一个将字符串映射到整数的函数，或者在整个过程中使用枚举（然后可能是一个将枚举值映射到字符串的函数）。

一般来说，后者更好：传递整数，以便实现不依赖于可能在表示中使用的字符串的细节。例如，如果您需要使这些字符串对说不同语言的人来说是可口的，请考虑如何管理本地化（翻译）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T12:15:44.933

您正在寻找的可能相当于一个关联数组，不幸的是，它无法在 C 中提供相同的语法糖，但没有一些愚蠢的结果。

但是，如果您的数据符合键 -> 值对，您可以提供的是哈希图。您将需要一个适当的散列函数。

这里有一个简单的哈希表示例：

[http://www.cl.cam.ac.uk/~cwc22/hashtable/](http://www.cl.cam.ac.uk/~cwc22/hashtable/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T13:18:46.943

如前所述，您需要一个关联数组或哈希映射或等效项。此类代码的一个可能来源是 Hanson 的“ [C 接口和实现](https://rads.stackoverflow.com/amzn/click/com/0201498413)”（[Google Code](http://code.google.com/p/cii/)中的代码- 在使用之前仔细检查许可条款等。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-30T01:34:54.643

这是一个旧线程，但我认为这对于那些正在寻找实现的人来说可能仍然有用。不需要太多代码；我做了大约 100 行，没有像 Hank Gay 建议的任何额外的库。我称它为字典，因为它与（某种）python 数据类型平行。这是代码：

```
#include <stdlib.h>
#include <stdio.h>
#include <stdbool.h>

typedef struct hollow_list hollow_list;

struct hollow_list{
    unsigned int size;
    void *value;
    bool *written;
    hollow_list *children;
};

//Creates a hollow list and allocates all of the needed memory
hollow_list hollow_list_create(unsigned int size){
    hollow_list output;
    output = (hollow_list) {.size = size, .value = (void *) 0, .written = calloc(size, sizeof(bool)), .children = calloc(size, sizeof(hollow_list))};
    return output;
}

//Frees all memory of associated with a hollow list and its children
void hollow_list_free(hollow_list *l, bool free_values){
    int i;
    for(i = 0; i < l->size; i++){
        hollow_list_free(l->children + i, free_values);
    }
    if(free_values){
        free(l->value);
    }
    free(l);
}

//Reads from the hollow list and returns a pointer to the item's data
void *hollow_list_read(hollow_list *l, unsigned int index){
    if(index == 0){
        return l->value;
    }
    unsigned int bit_checker;
    bit_checker = 1<<(l->size - 1);
    int i;
    for(i = 0; i < l->size; i++){
        if(bit_checker & index){
            if(l->written[i] == true){
                return hollow_list_read(l->children + i, bit_checker ^ index);
            } else {
                return (void *) 0;
            }
        }
        bit_checker >>= 1;
    }
}

//Writes to the hollow list, allocating memory only as it needs
void hollow_list_write(hollow_list *l, unsigned int index, void *value){
    if(index == 0){
        l->value = value;
    } else {
        unsigned int bit_checker;
        bit_checker = 1<<(l->size - 1);
        int i;
        for(i = 0; i < l->size; i++){
            if(bit_checker & index){
                if(!l->written[i]){
                    l->children[i] = hollow_list_create(l->size - i - 1);
                    l->written[i] = true;
                }
                hollow_list_write(l->children + i, bit_checker ^ index, value);
                break;
            }
            bit_checker >>= 1;
        }
    }
}

typedef struct dictionary dictionary;

struct dictionary{
    void *value;
    hollow_list *child;
};

dictionary dictionary_create(){
    dictionary output;
    output.child = malloc(sizeof(hollow_list));
    *output.child = hollow_list_create(8);
    output.value = (void *) 0;
    return output;
}

void dictionary_write(dictionary *dict, char *index, unsigned int strlen, void *value){
    void *hollow_list_value;
    dictionary *new_dict;
    int i;
    for(i = 0; i < strlen; i++){
        hollow_list_value = hollow_list_read(dict->child, (int) index[i]);
        if(hollow_list_value == (void *) 0){
            new_dict = malloc(sizeof(dictionary));
            *new_dict = dictionary_create();
            hollow_list_write(dict->child, (int) index[i], new_dict);
            dict = new_dict;
        } else {
            dict = (dictionary *) hollow_list_value;
        }
    }
    dict->value = value;
}

void *dictionary_read(dictionary *dict, char *index, unsigned int strlen){
    void *hollow_list_value;
    dictionary *new_dict;
    int i;
    for(i = 0; i < strlen; i++){
        hollow_list_value = hollow_list_read(dict->child, (int) index[i]);
        if(hollow_list_value == (void *) 0){
            return hollow_list_value;
        } else {
            dict = (dictionary *) hollow_list_value;
        }
    }
    return dict->value;
}

int main(){
    char index0[] = "hello, this is a test";
    char index1[] = "hello, this is also a test";
    char index2[] = "hello world";
    char index3[] = "hi there!";
    char index4[] = "this is something";
    char index5[] = "hi there";

    int item0 = 0;
    int item1 = 1;
    int item2 = 2;
    int item3 = 3;
    int item4 = 4;

    dictionary d;
    d = dictionary_create();
    dictionary_write(&d, index0, 21, &item0);
    dictionary_write(&d, index1, 26, &item1);
    dictionary_write(&d, index2, 11, &item2);
    dictionary_write(&d, index3, 13, &item3);
    dictionary_write(&d, index4, 17, &item4);

    printf("%d\n", *((int *) dictionary_read(&d, index0, 21)));
    printf("%d\n", *((int *) dictionary_read(&d, index1, 26)));
    printf("%d\n", *((int *) dictionary_read(&d, index2, 11)));
    printf("%d\n", *((int *) dictionary_read(&d, index3, 13)));
    printf("%d\n", *((int *) dictionary_read(&d, index4, 17)));
    printf("%d\n", ((int) dictionary_read(&d, index5, 8)));
} 
```

不幸的是，您无法复制 list[x] 语法，但这是我想出的最佳选择。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-06T12:44:14.187

在“plain C”中，您可以模仿使用字符串作为索引，但不能以您想要的方式模仿。但是，这样做很少有用，而且主要是使您的代码不可读的好方法。您似乎想要的是能够将字符串键用于字典（或“哈希表”，如果您愿意），并且在 C 中没有内置的数据结构。确切的设计取决于您的想要（事实上，如果这是家庭作业的一部分，您甚至可能不需要使用成熟的哈希表实现，但可能会使用性能较差的静态编码）。

在 a[b] 构造的“索引位置”中使用字符串（OK，char 数组）的示例：

```
int main (void)
{
  char *str = "This is a test string";
  int x;

  for (x=0; x < 12; x += 3)
    putchar(x[str]);

  printf("\n");

  return 0;
} 
```

据我所知，以上是合法的 C，具有明确定义的输出（字符串“Tss ssi”）。它依赖于 a[b] 被定义为与 *(a+b) 相同的事实。

# c# - 在没有 SetSPN 的 Windows 域上查询/更改 SPN

> ID：416241
> 
> 赞同：3
> 
> 时间：2009-01-06T11:54:06.537
> 
> 标签：c#, configuration, kerberos

有人在 Windows 域上查询/更改 SPN 有什么运气吗？Google 上的大多数点击都与 SQL 相关：我自己找不到任何有关如何执行此操作的信息。最重要的事情是查询 SPN 配置并检查重复项。

根据 Arnout，我编写了以下代码：

```
static void Main(string[] args) {
    ValidateSPN("K2Server/jonathand-vpc:5252");
}

static void ValidateSPN(string spn) {
    const string queryFormat = "(ServicePrincipalName={0})";
    using (Domain localDomain = Domain.GetCurrentDomain()) {
        using (DirectorySearcher search = new DirectorySearcher(localDomain.GetDirectoryEntry())) {
            search.Filter = string.Format(queryFormat, spn);
            search.SearchScope = SearchScope.Subtree;
            SearchResultCollection collection = search.FindAll();
            if (collection.Count > 1)
                throw new Exception("Duplicate SPNs found.");
            else if (collection.Count == 0)
                throw new Exception("No such SPN");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T13:00:30.053

看起来此信息存储在`servicePrincipalName`AD 属性中。有关更多信息，请参阅[此页面](http://blogs.technet.com/tristank/archive/2006/05/08/spns-r-fn.aspx)，特别是“使用 LDIFDE 搜索”部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T03:52:59.517

您可以使用支持工具中的 Search.VBS 来搜索重复的 SPN：

```
"C:\Program Files\Support Tools\search.vbs" "LDAP://DC=Your,dc=Domain,dc=Here" /C:"(serviceprincipalname=K2Server/jonathand-vpc:5252)" /S:Subtree /P:DistinguishedName 
```

# sql-server - 如何在不安装 SQL Server 2008 客户端工具的情况下在构建机器上引用 SSIS？

> ID：416251
> 
> 赞同：0
> 
> 时间：2009-01-06T11:58:24.110
> 
> 标签：sql-server, configuration, ssis, build-automation

我需要在构建机器上构建 SSIS 包，并且不希望在这台机器上安装 SQL Server Management Studio 的开销。SQL Server 2008 SDK 将是理想的，但我找不到在哪里下载它。

我需要的 dll 是（例如）：

*   Microsoft.SQLServer.ManagedDTS
*   Microsoft.SqlServer.PipelineHost
*   Microsoft.SqlServer.DTSPipelineWrap
*   Microsoft.SQLServer.DTSRuntimeWrap

我可以尝试将它们单独复制到构建机器，但如果可能的话，我宁愿只使用 SDK。

我在哪里可以获得 SDK，或者有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T12:28:45.890

您可能可以手动复制内容并在 GAC 中注册，但客户端工具并不庞大，安装时间也不长，所以我不明白为什么它们会产生很大的开销？

据我所知，没有其他方法可以获取这些程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T19:56:03.083

我不了解 SQL 2008，但 SQL 2005 SSIS 包是在 Visual Studio 中开发的。

已编辑：当您为客户端工具运行安装时，可以选择将这些东西添加到 VS.NET，因此可以取消选择“客户端工具”（结束编辑）

SSMS 可用于管理和管理它们。

您还想使用什么其他编辑器...？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-03T12:43:10.393

我认为他正在尝试将 SSIS 包作为自动化持续构建过程的一部分来完成。我这样做的方法是在构建机器上拥有 SQL Server 和 SSIS 的快速版本，使用 BIDS 帮助程序编写用于部署包的 cmd 行文件的脚本，并使用 NANT 来使用此脚本。希望这有帮助。

# asp.net - ASP.NET - 丢失通过 javascript 填充的下拉列表的选择

> ID：416263
> 
> 赞同：7
> 
> 时间：2009-01-06T12:01:51.730
> 
> 标签：asp.net, javascript, drop-down-menu

我在一个页面上有两个 ASP.NET 下拉列表控件。第一个回调服务器并获得一个数组，该数组返回给客户端并用于通过 javascript 填充第二个下拉列表。但是，如果我在第二个（和新填充的）下拉列表中进行选择，然后进行回发，则第二个下拉列表的选择和内容将丢失。这是一个问题，因为我需要获取选定的值并在回发后保留列表的内容。

我该如何解决？我认为这是在回发之前的某个时间点更新视图状态的问题？

* * *

我正在填充的控件是 ASP.NET 下拉列表。这是我用来填充它们的javascript。

正在使用的代码如下（为简洁起见略有删减）：

**我正在填充的 ASP.NET 控件：**

<asp:DropDownList ID="ddlStateCounty" runat="server" OnSelectedIndexChanged="ddlStateCounty_OnSelectedIndexChanged" AutoPostBack="true" />

**获取逗号分隔值列表的回调代码：**

```
public void RaiseCallbackEvent(string eventArgument)
    {
    return "1, 2, 3";
} 
```

**Javascript人口代码：**

```
function ReceiveServerData(retValue)
{ 
    var statesArray = retValue.split(',');
    var statesList = document.getElementById('{0}');

    if (statesArray.length > 0 && statesList != null)
        {
                for (var j = 0; j < statesArray.length; j++)
            {
                    var newOption = document.createElement('OPTION');
                        statesList.options.add(newOption);
            newOption.value = statesArray[j].toString().trim();
                    newOption.innerText = statesArray[j];
                }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T12:34:40.587

您说您没有正确的 ViewState 是正确的，这就是当您将数据发布回服务器时未填充值的原因。

我**强烈**建议您迁移到在 ASP.NET AJAX 控件工具包（它同时具有 .NET 2.0 和 .NET 3.5 版本）中使用[Cascading Drop Down](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/CascadingDropDown/CascadingDropDown.aspx)，因为它可以满足您的需求，并且**通过**回发进行维护。

您的另一个选择是`onchange`在 JavaScript 填充的下拉列表中设置一个事件，然后在其中填充一个隐藏字段，因为该字段将被发送回服务器，并且提交的值将在发布的数据中维护，一些喜欢：

```
$addHandler('change', $get('dynamicDDL'), function () { $get('hiddenField').value = this.options[this.selectedIndex].value; }); 
```

*对于演示，我使用 MS AJAX 简写来添加事件等。关于我使用的方法的更多信息可以在这里找到：http: [//msdn.microsoft.com/en-au/library/bb397536.aspx](http://msdn.microsoft.com/en-au/library/bb397536.aspx)*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-03T05:06:34.017

Request.Form[Control.UniqueID] 为您提供选定的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T12:14:49.083

只需使用 response.forms 集合来获取所选值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T12:07:33.200

我猜“你不是用 asp.net 的方式做事”。

在我看来，如果您的 javascript 修改不是本机 asp.net，那么您填充的元素不是 asp.net 控件，因此您会在回发中丢失它们。asp.net 确实需要它的模型和实际页面之间的紧密绑定。

不过可能有点离谱-如果您可以发布一些代码会有所帮助。（JS 和代码隐藏方法）

**编辑新信息：**

是的 - 所以你基本上是通过基于 AJAXified 返回字符串（？）的 JS 来创建一个完全正常的 html 元素负载，asp.net 代码隐藏*没有任何概念*。如果没有自己设置测试应用程序，我不能 100% 确定这是问题所在，但这听起来是正确的。

然后检查 Request.Forms - 正如其他人所建议的那样 - 将是目前解决此问题的最简单方法，但您应该记住，asp.net 变得越来越痛苦，您越偏离按照它想要的方式做事你去。我认为值得研究如何从代码隐藏中添加这些新选项。

# cil - 从字节数组中获取 IL 的 API

> ID：416265
> 
> 赞同：11
> 
> 时间：2009-01-06T12:02:02.697
> 
> 标签：cil

MethodBody 类中有一个 GetILAsByteArray 方法，它给出了方法的主体。我正在寻找将此字节数组转换为更易于理解的 IL 指令（转换为 List 或类似的东西）。有哪些资源、开源代码或 api 可以帮助我理解和转换这个字节数组（或为我做）？

我发现了这一点，但它不适用于泛型。我非常期待在所有框架版本中转换理解这些字节的指导。

CLI 文档对于学习 IL 指令也很有帮助，但我看不出如何使用它来使这些字节有意义。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T09:00:57.643

我刚刚编写了一个扩展方法，以便使用 GetILAsByteArray 获得更易于理解的指令列表。这很简单，API 是这样的：

```
public static IList<Instruction> GetInstructions (this MethodBase self); 
```

[您可以在我的博客文章](http://evain.net/blog/articles/2009/04/30/reflection-based-cil-reader)中阅读更多关于实现的信息。或者你可以去[实现](http://github.com/jbevain/mono.reflection)并开始使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T16:25:46.670

看看 Mono.Cecil 库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T12:16:47.817

这是一项艰巨的任务。我写了一个 IL 阅读器的开头，它实现了相当多的操作码：但你*需要*完成它。

[http://svn.ensemble-os.org/tags/OldOCJ/CIL/](http://svn.ensemble-os.org/tags/OldOCJ/CIL/)

还有MONO Cecil，功能齐全。

# java - Java中的排序集合

> ID：416266
> 
> 赞同：166
> 
> 时间：2009-01-06T12:02:05.880
> 
> 标签：java, sorting, collections

我是Java的初学者。请建议可以/应该使用哪些集合来维护 Java 中的排序列表。我试过`Map`and `Set`，但它们不是我想要的。

* * *

## 回答 #1

> 赞同：193
> 
> 时间：2010-02-24T13:21:54.707

这来得很晚，但是 JDK 中有一个类只是为了有一个排序列表。它被命名（与其他`Sorted*`接口有点乱）“ `java.util.PriorityQueue`”。它可以排序`Comparable<?>`s 或使用`Comparator`.

与`List`sorted using的区别`Collections.sort(...)`在于，通过使用堆数据结构，这将始终保持部分顺序，具有 O(log(n)) 插入性能，而在 sorted 中插入`ArrayList`将是 O(n)（即，使用二分查找和移动）。

但是，与 a 不同的是`List`，`PriorityQueue`它不支持索引访问 ( `get(5)`)，**访问堆中项目的唯一方法是一次取出一个**（因此命名为`PriorityQueue`）。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-01-06T12:06:05.700

TreeMap 和 TreeSet 将按排序顺序为您提供对内容的迭代。或者您可以使用 ArrayList 并使用 Collections.sort() 对其进行排序。所有这些类都在 java.util

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-01-06T13:25:27.490

如果您想维护一个您将**经常修改的****排序列表**（即，除了排序之外，还允许重复并且其元素可以通过索引有效引用的结构），那么使用 ArrayList 但当您需要插入一个元素时，始终使用**Collections.binarySearch() 来确定添加给定元素的索引**。后一种方法告诉您需要插入的索引，以使您的列表保持排序。

 ***** * *

## 回答 #4

> 赞同：33
> 
> 时间：2011-04-21T14:21:14.387

使用 Google Guava 的[TreeMultiset](https://google.github.io/guava/releases/snapshot/api/docs/index.html?com/google/common/collect/TreeMultiset.html)类。[Guava](https://github.com/google/guava)有一个壮观的集合 API。

提供维护排序顺序的 List 实现的一个问题是在该`add()`方法的 JavaDocs 中做出的承诺。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-01-06T12:06:42.563

您需要[SortedSet](http://java.sun.com/javase/6/docs/api/java/util/SortedSet.html)实现，即[TreeSet](http://java.sun.com/javase/6/docs/api/java/util/TreeSet.html)。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-01-06T12:07:25.073

有几个选项。如果您不想重复并且您插入的对象具有可比性，我建议使用 TreeSet。

您也可以使用 Collections 类的静态方法来执行此操作。

有关详细信息，请参阅[Collections#sort(java.util.List)](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List%29)和[TreeSet](http://docs.oracle.com/javase/7/docs/api/java/util/TreeSet.html)。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-01-06T12:09:35.350

如果您只想对列表进行排序，请使用任何类型的[List](http://java.sun.com/j2se/1.5.0/docs/api/java/util/List.html)并使用[Collections.sort()](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collections.html#sort(java.util.List))。如果要确保列表中的元素是唯一的并且始终排序，请使用[SortedSet](http://java.sun.com/j2se/1.5.0/docs/api/java/util/SortedSet.html)。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-11-29T19:42:36.457

我所做的是实现 List 具有一个内部实例，其中包含所有委托的方法。

```
 public class ContactList implements List<Contact>, Serializable {
    private static final long serialVersionUID = -1862666454644475565L;
    private final List<Contact> list;

public ContactList() {
    super();
    this.list = new ArrayList<Contact>();
}

public ContactList(List<Contact> list) {
    super();
    //copy and order list
    List<Contact>aux= new ArrayList(list);
    Collections.sort(aux);

    this.list = aux;
}

public void clear() {
    list.clear();
}

public boolean contains(Object object) {
    return list.contains(object);
} 
```

之后，我实现了一个新方法“putOrdered”，如果元素不存在则插入适当的位置，或者以防万一它存在时替换。

```
public void putOrdered(Contact contact) {
    int index=Collections.binarySearch(this.list,contact);
    if(index<0){
        index= -(index+1);
        list.add(index, contact);
    }else{
        list.set(index, contact);
    }
} 
```

如果您想允许重复元素，只需实现 addOrdered 代替（或两者）。

```
public void addOrdered(Contact contact) {
    int index=Collections.binarySearch(this.list,contact);
    if(index<0){
        index= -(index+1);
    }
    list.add(index, contact);
} 
```

如果您想避免插入，您还可以在“add”和“set”方法上抛出不支持的操作异常。

```
public boolean add(Contact object) {
    throw new UnsupportedOperationException("Use putOrdered instead");
} 
```

...而且您必须小心使用 ListIterator 方法，因为它们可能会修改您的内部列表。在这种情况下，您可以返回内部列表的副本或再次抛出异常。

```
public ListIterator<Contact> listIterator() {
    return (new ArrayList<Contact>(list)).listIterator();
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-12-28T22:18:46.257

实现您想要的排序列表的最有效方法是实现一个可索引的跳过列表，如下所示：[Wikipedia: Indexable skiplist](https://en.wikipedia.org/wiki/Skip_list#Indexable_skiplist)。它将允许在 O(log(n)) 中进行插入/删除，并允许同时进行索引访问。它还允许重复。

Skiplist 是一个非常有趣的，我会说，被低估的数据结构。不幸的是，Java 基础库中没有索引的跳过列表实现，但您可以使用开源实现之一或自己实现它。有常规的 Skiplist 实现，例如[ConcurrentSkipListSet](https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentSkipListSet.html)和[ConcurrentSkipListMap](https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentSkipListMap.html)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-03-12T17:46:22.480

## 使用 LambdaJ

**如果您使用的是 Java 8 的早期版本，您可以尝试使用LambdaJ**解决这些任务。您可以在此处找到它：[http ://code.google.com/p/lambdaj/](http://code.google.com/p/lambdaj/)

这里有一个例子：

**排序迭代**

```
List<Person> sortedByAgePersons = new ArrayList<Person>(persons);
Collections.sort(sortedByAgePersons, new Comparator<Person>() {
        public int compare(Person p1, Person p2) {
           return Integer.valueOf(p1.getAge()).compareTo(p2.getAge());
        }
}); 
```

**使用 LambdaJ 排序**

```
List<Person> sortedByAgePersons = sort(persons, on(Person.class).getAge()); 
```

当然，这种美感对性能有影响（平均为 2 倍），但你能找到更可读的代码吗？

## 使用 lambda 表达式对 java 8 进行排序

```
Collections.sort(persons, (p1, p2) -> p1.getAge().compareTo(p2.getAge()));
//or
persons.sort((p1, p2) -> p1.getAge().compareTo(p2.getAge())); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-04-23T13:42:51.923

TreeSet 不起作用，因为它们不允许重复，而且它们不提供在特定位置获取元素的方法。PriorityQueue 不起作用，因为它不允许在特定位置获取元素，这是列表的基本要求。我认为您需要实现自己的算法来维护具有 O(logn) 插入时间的 Java 中的排序列表，除非您不需要重复项。也许解决方案可以使用 TreeMap ，其中键是覆盖 equals 方法的项目的子类，以便允许重复。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-11-01T00:21:23.817

PriorityQueue 的问题在于它由一个简单的数组支持，按顺序获取元素的逻辑由“queue[2*n+1] 和 queue[2*(n+1)]”这个东西完成。如果你只是从头上拉，它会很好用，但如果你试图在某个时候调用 .toArray ，它就会变得毫无用处。

我通过使用 com.google.common.collect.TreeMultimap 解决了这个问题，但我为值提供了一个自定义比较器，包装在 Ordering 中，从不返回 0。

前任。双倍：

```
private static final Ordering<Double> NoEqualOrder = Ordering.from(new Comparator<Double>() {

    @Override
    public int compare(Double d1, Double d2)
    {
        if (d1 < d2) {
            return -1;
        }
        else {
            return 1;
        }
    }
}); 
```

这样我在调用 .toArray() 时按顺序获取值，并且也有重复项。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-06-25T06:36:29.690

对于 Set，您可以使用 TreeSet。TreeSet 根据自然排序或传递给该特定对象的 Comparable 的任何排序顺序对其元素进行排序。对于地图，请使用 TreeMap。TreeMap 提供对键的排序。要将对象添加为 TreeMap 的键，该类应实现可比较接口，这反过来又强制实现包含排序顺序定义的 compare to() 方法。 [http://techmastertutorial.in/java-collection-impl.html](http://techmastertutorial.in/java-collection-impl.html)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-04-23T15:26:37.037

你想要的是一个二叉搜索树。它在为搜索、删除和插入提供对数访问的同时保持排序顺序（除非你有一个退化的树——那么它是线性的）。它很容易实现，你甚至可以让它实现 List 接口，但是索引访问变得复杂了。

第二种方法是有一个 ArrayList，然后是一个冒泡排序实现。因为您一次插入或删除一个元素，所以插入和删除的访问时间是线性的。搜索是对数和索引访问常量（对于 LinkedList，时间可能会有所不同）。您需要的唯一代码是 5 行，可能是 6 行冒泡排序。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-10-28T09:56:11.650

您可以使用 Arraylist 和 Treemap，正如您所说的，您也需要重复值，然后您不能使用 TreeSet，尽管它也已排序，但您必须定义比较器。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-01-18T05:31:42.420

为什么不自己做呢？

```
import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.Iterator;
import java.util.List;
import java.util.Random;

class SortedList<E extends Comparable<E>> extends ArrayList<E> {
    @Override
    public boolean add(E e) {
        int i = Collections.binarySearch(this, e);

        if (i < 0) i = ~i;
        super.add(i, e);
        return true;
    } // add(E e)

    @Override
    public void add(int index, E element) {
        this.add(element);
    } // add(int, E)

    @Override
    public boolean addAll(Collection<? extends E> c) {
        int oldSize = this.size();

        for (E element : c) this.add(element);
        return oldSize != this.size();
    } // addAll(Collection<? extends E>)

    @Override
    public boolean addAll(int index, Collection<? extends E> c) {
        int oldSize = this.size();
        Iterator<? extends E> it = c.iterator();

        for (int i = 0; i < index; ++i) it.next();
        while (it.hasNext()) this.add(it.next());
        return oldSize != this.size();
    } // addAll(Collection<? extends E>)

    @Override
    public E set(int index, E element) {
        E ret = this.get(index);

        this.remove(index);
        this.add(element);
        return ret;
    } // set(int, E)
} // SortedList<E> Class

public class Solution {
    public static void main(String[] args) {
        Random r = new Random(1);
        List<Integer> sortedList = new SortedList<>();
        List<Integer> unsortedList = new ArrayList<>();

        for (int i = 0; i < 50; ++i) {
            int next = r.nextInt(1000);

            sortedList.add(next);
            unsortedList.add(next);
        } // for (int i = 0; i < 50; ++i)

        System.out.println("unsortedList:");
        System.out.println(unsortedList);
        System.out.println("\nsortedList:");
        System.out.println(sortedList);
        sortedList.clear();
        sortedList.addAll(unsortedList);
        System.out.println("\ntest for addAll(Collection) method:");
        System.out.println(sortedList);
        sortedList.clear();
        sortedList.addAll(30, unsortedList);
        System.out.println("\ntest for addAll(int, Collection) method:");
        System.out.println(sortedList);
        sortedList.set(0, 999);
        System.out.println("\ntest for set(int, E) method:");
        System.out.println(sortedList);
    } // main(String[])
} // Solution Class 
```

输出：

```
unsortedList:
[985, 588, 847, 313, 254, 904, 434, 606, 978, 748, 569, 473, 317, 263, 562, 234, 592, 262, 596, 189, 376, 332, 310, 99, 674, 959, 298, 153, 437, 302, 205, 854, 800, 6, 363, 955, 689, 820, 75, 834, 415, 660, 477, 737, 477, 592, 220, 888, 500, 357]

sortedList:
[6, 75, 99, 153, 189, 205, 220, 234, 254, 262, 263, 298, 302, 310, 313, 317, 332, 357, 363, 376, 415, 434, 437, 473, 477, 477, 500, 562, 569, 588, 592, 592, 596, 606, 660, 674, 689, 737, 748, 800, 820, 834, 847, 854, 888, 904, 955, 959, 978, 985]

test for addAll(Collection) method:
[6, 75, 99, 153, 189, 205, 220, 234, 254, 262, 263, 298, 302, 310, 313, 317, 332, 357, 363, 376, 415, 434, 437, 473, 477, 477, 500, 562, 569, 588, 592, 592, 596, 606, 660, 674, 689, 737, 748, 800, 820, 834, 847, 854, 888, 904, 955, 959, 978, 985]

test for addAll(int, Collection) method:
[6, 75, 205, 220, 357, 363, 415, 477, 477, 500, 592, 660, 689, 737, 800, 820, 834, 854, 888, 955]

test for set(int, E) method:
[75, 205, 220, 357, 363, 415, 477, 477, 500, 592, 660, 689, 737, 800, 820, 834, 854, 888, 955, 999] 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-11-30T07:52:48.357

使用 sort() 方法对列表进行排序，如下所示：

```
List list = new ArrayList();

//add elements to the list

Comparator comparator = new SomeComparator();

Collections.sort(list, comparator); 
```

参考链接： [http ://tutorials.jenkov.com/java-collections/sorting.html](http://tutorials.jenkov.com/java-collections/sorting.html)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-08-14T05:06:00.537

使用 Java 8 比较器，如果我们想对列表进行排序，那么这里是世界上人口最多的 10 个城市，我们想按时间报告的名称对其进行排序。日本大阪。...墨西哥墨西哥城。... 中国北京。... 巴西圣保罗。...印度孟买。... 上海，中国。... 印度德里。... 日本东京。

```
 import java.util.Arrays;
 import java.util.Comparator;
 import java.util.List;

public class SortCityList {

    /*
     * Here are the 10 most populated cities in the world and we want to sort it by
     * name, as reported by Time. Osaka, Japan. ... Mexico City, Mexico. ...
     * Beijing, China. ... São Paulo, Brazil. ... Mumbai, India. ... Shanghai,
     * China. ... Delhi, India. ... Tokyo, Japan.
     */
    public static void main(String[] args) {
        List<String> cities = Arrays.asList("Osaka", "Mexico City", "São Paulo", "Mumbai", "Shanghai", "Delhi",
                "Tokyo");
        System.out.println("Before Sorting List is:-");
        System.out.println(cities);
        System.out.println("--------------------------------");

        System.out.println("After Use of List sort(String.CASE_INSENSITIVE_ORDER) & Sorting List is:-");
        cities.sort(String.CASE_INSENSITIVE_ORDER);
        System.out.println(cities);
        System.out.println("--------------------------------");
        System.out.println("After Use of List sort(Comparator.naturalOrder()) & Sorting List is:-");
        cities.sort(Comparator.naturalOrder());
        System.out.println(cities);

    }

} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-01-20T06:59:48.003

使用`TreeSet`which 以排序顺序给出元素。或`Collection.sort()`用于外部排序与`Comparator()`.

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-08-18T09:24:21.050

```
import java.util.TreeSet;

public class Ass3 {
    TreeSet<String>str=new TreeSet<String>();
    str.add("dog");
    str.add("doonkey");
    str.add("rat");
    str.add("rabbit");
    str.add("elephant");
    System.out.println(str);    
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-10-08T10:38:21.300

**根据用户定义的标准对 ArrayList 进行排序。**

模型类

```
 class Student 
 { 
     int rollno; 
     String name, address; 

     public Student(int rollno, String name, String address) 
     { 
         this.rollno = rollno; 
         this.name = name; 
         this.address = address; 
     }   

     public String toString() 
     { 
         return this.rollno + " " + this.name + " " + this.address; 
     } 
 } 
```

排序类

```
 class Sortbyroll implements Comparator<Student> 
 {         
     public int compare(Student a, Student b) 
     { 
         return a.rollno - b.rollno; 
     } 
 } 
```

主班

```
 class Main 
 { 
     public static void main (String[] args) 
     { 
         ArrayList<Student> ar = new ArrayList<Student>(); 
         ar.add(new Student(111, "bbbb", "london")); 
         ar.add(new Student(131, "aaaa", "nyc")); 
         ar.add(new Student(121, "cccc", "jaipur")); 

         System.out.println("Unsorted"); 
         for (int i=0; i<ar.size(); i++) 
             System.out.println(ar.get(i)); 

         Collections.sort(ar, new Sortbyroll()); 

         System.out.println("\nSorted by rollno"); 
         for (int i=0; i<ar.size(); i++) 
             System.out.println(ar.get(i)); 
     } 
 } 
```

输出

```
 Unsorted
 111 bbbb london
 131 aaaa nyc
 121 cccc jaipur

 Sorted by rollno
 111 bbbb london
 121 cccc jaipur
 131 aaaa nyc 
```

# c - 帮助了解基本线程概念/竞争条件

> ID：416273
> 
> 赞同：2
> 
> 时间：2009-01-06T12:04:43.923
> 
> 标签：c, multithreading, posix

我现在正在学习 POSIX 线程，但我想这只是一个关于多线程的一般问题，所以我希望任何人都可以帮助我。我正在研究的书中有这个例子，它演示了一个竞争条件：

```
void *thread_main(void *thread_number) {
    printf("In thread number %d.\n", *(int *)thread_number);
}

void main() {
    int i = 0;
    pthread_t thread;

    for( i = 0; i < 10; i++ ) {
        printf("Creating thread %d.\n");
        pthread_create(&thread, 0, thread_main, &i);
        printf("Created thread %d.\n");
    }
} 
```

关于这个，有几件事我不明白。首先，“在线程号 5 中”。被打印了很多次，即使它不应该在线程号 5 中。在书中，示例显示线程 8 被打印了很多次。我也不明白说的部分`*(int *)thread_number`。我尝试将其更改为仅 thread_number，但这只是一遍又一遍地给了我奇怪的数字。

这本书并没有真正解释这一点。有人可以清楚地解释这里发生了什么吗？我不明白为什么它不打印如下内容：

```
> Creating thread 1.
> In thread number 1.
> Created thread 1.
> Creating thread 2.
> In thread number 2.
> Created thread 2. 
```

我知道这是因为它是多线程的“在线程号 x 中”。部分将在不同的时间出现，但我真的不明白为什么我创建的每个线程都没有 10 个“在线程编号 x”中一行！

~德西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T12:13:29.803

在创建的 10 个线程中的任何一个有机会运行之前，for 循环可能会迭代 10 次。在这种情况下，每个线程的值`*thread_number`将是 10（因为它是指向具有单个值的单个内存位置的指针）。

如果您不传递指向 to 的指针`i`，`pthread_create`那么最终的值将`int`被视为地址，因此当您在 中取消引用它时`thread_main`，您正在访问某个任意内存位置，其内容可能未定义。你很幸运，在这种情况下你没有出现段错误。

如果您想`*thread_number`在每个线程中查看正确的值，则需要在调用之前`malloc`创建一个 new并将其分配给 的当前值，如下所示：`int``pthread_create``i`

```
for( i = 0; i < 10; i++ ) {
    int *thread_count = malloc(sizeof(int));
    *thread_count = i;
    printf("Creating thread %d.\n", i);
    pthread_create(&thread, 0, thread_main, thread_count);
    printf("Created thread %d.\n", i);
} 
```

当然，`free`当线程完成时你需要内存，如下所示：

```
void *thread_main(void *thread_number) {
    printf("In thread number %d.\n", *(int *)thread_number);
    free(thread_numbr);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T12:27:26.220

首先 *(int *)thread_number 是指针的东西——当你只有 thread_number 时，“奇怪的数字”是*主*函数中指向“i”的指针地址（除非我弄错了，否则它们都应该是程序的单次运行具有相同的编号（因此 10 个线程中的每一个都应该具有相同的“线程编号 [编号]”））。

您需要了解这些是重复的 5 的指针才有意义 - 每个线程都在使用来自*main*函数的相同底层 i - 它不是为每个新线程复制的，所以当 i 在*main*函数，这反映在*thread_main*函数中的 thread_number 上。

难题的最后一块是每个新线程的设置时间以及上下文切换（更改实际运行的线程）不是立即的，因此在您的情况下，for循环在新创建的线程实际运行之前运行 5 次（在本书的例子中，for 循环在上下文切换之前运行了 8 次），然后每个线程查看相同的底层 i 值，现在是 5。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T12:13:02.177

首先，竞争条件是一件坏事。该程序不应该像您期望的那样工作*。*竞争条件意味着程序旨在中断。

在这种情况下，您的所有线程似乎都在*共享*变量`i`。您正在向他们传递对单个共享变量的引用，当他们碰巧被安排时，他们会尝试报告该变量。

# java - 网络上的 Java 文件锁定

> ID：416285
> 
> 赞同：12
> 
> 时间：2009-01-06T12:08:25.087
> 
> 标签：java, file, networking

这可能与以前的帖子类似，但我想具体说明在网络上而不是在本地使用锁定。我想将文件写入共享位置，因此它很可能会在网络上运行（当然是 Windows 网络，也可能是 Mac）。我想防止其他人在写入该文件时读取它的任何部分。这将不是一个高度并发的过程，文件通常小于 10MB。

我已经阅读了`FileLock`文档和`File`文档，对于什么是安全的，什么不是，我感到有些困惑。我想锁定整个文件，而不是其中的一部分。

我可以使用`FileChannel.tryLock()`，它在网络上是安全的，还是取决于网络的类型？它是否可以在标准的 Windows 网络上运行（如果有的话）。

如果这样不行，最好创建一个零字节文件或目录作为锁文件，然后写出主文件。为什么该`File.createNewFile()`文档说不要将其用于文件锁定？我很欣赏这取决于比赛条件，并不理想。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T12:27:42.693

这不能在网络文件系统上可靠地完成。只要您的应用程序是访问该文件的唯一应用程序，最好实现某种协作锁定过程（可能在您打开文件时将锁定文件写入网络文件系统）。但是，不建议这样做的原因是，如果您的进程崩溃或网络出现故障或发生任何其他数量的问题，您的应用程序就会进入令人讨厌的肮脏状态。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T21:23:49.730

我发现了这个错误报告，它描述了为什么将有关文件锁定的注释添加到 File.createNewFile 文档中。

[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4676183](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4676183)

它指出：

> 如果您在调用 createNewFile*之前*将该文件标记为 deleteOnExit但该文件已经存在，则您可能会删除您未创建的文件并删除其他人的锁！另一方面，如果您在创建文件*后*对其进行标记，则会失去原子性：如果程序在文件被标记之前退出，它不会被删除并且锁将被“楔入”。

因此，看起来不鼓励使用 File.createNewFile() 进行锁定的主要原因是，如果 JVM 在您有机会删除它之前意外终止，您最终可能会得到孤立的锁定文件。如果您可以处理孤立的锁定文件，那么它可以用作简单的锁定机制。但是，我不推荐错误报告评论中建议的方法，因为它在读/写时间戳值和回收过期锁方面存在竞争条件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T12:30:13.310

您可以在要写入的服务器上拥有一个空文件。

当您想写入服务器时，您可以捕获令牌。只有当您拥有令牌时，您才应该写入位于服务器上的任何文件。

当您准备好进行文件操作或引发异常时，您必须释放令牌。

助手类看起来像

```
private FileLock lock;

private File tokenFile;

public SLTokenLock(String serverDirectory) {
    String tokenFilePath = serverDirectory + File.separator + TOKEN_FILE;
    tokenFile = new File(tokenFilePath);
}

public void catchCommitToken() throws TokenException {
    RandomAccessFile raf;
    try {
        raf = new RandomAccessFile(tokenFile, "rw"); //$NON-NLS-1$
        FileChannel channel = raf.getChannel();
        lock = channel.tryLock();

        if (lock == null) {
            throw new TokenException(CANT_CATCH_TOKEN);
        }
    } catch (Exception e) {
        throw new TokenException(CANT_CATCH_TOKEN, e);
    }
}

public void releaseCommitToken() throws TokenException {
    try {
        if (lock != null && lock.isValid()) {
            lock.release();
        }
    } catch (Exception e) {
        throw new TokenException(CANT_RELEASE_TOKEN, e);
    }
} 
```

你的操作应该看起来像

```
try {
        token.catchCommitToken();

        // WRITE or READ to files inside the directory
    } finally {
        token.releaseCommitToken();
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T14:43:46.647

与其实施一种锁定策略，这种策略很可能依赖读者遵守您的约定，但不会强迫他们遵守，也许您可​​以将文件写到一个隐藏的或命名模糊的文件中，这样读者实际上看不到它. 写入操作完成后，将文件重命名为预期的公共名称。

缺点是在没有额外 IO 的情况下隐藏和/或重命名可能需要您使用本机操作系统命令，但这样做的过程应该相当简单且具有确定性。

# sql-server - DTS DB2 连接问题

> ID：416292
> 
> 赞同：1
> 
> 时间：2009-01-06T12:10:23.710
> 
> 标签：sql-server, oracle, sql-server-2000, db2, dts

我想在 SQL Server 2000 中使用 DTS 将 Oracle 数据库复制到 DB2 数据库。

当我使用各自的驱动程序设置两个连接时，我可以读取两个数据库，并链接它们之间的复制操作。

但是当我想运行 DTS 包时，会出现一个错误，说“驱动程序不具备能力”。

这是日志，提前谢谢。

> 步骤“DTSStep_DTSDataPumpTask_1”失败
> 
> 步骤错误来源：Microsoft 数据转换服务 (DTS) 数据泵步骤错误描述：失败的行数超过了指定的最大值。（Microsoft OLE DB Provider for ODBC Drivers (80004005): [IBM][CLI Driver] CLI0150E Driver not able. SQLSTATE=S1C00） 步骤错误代码：8004206A 步骤错误帮助文件：sqldts80.hlp 步骤错误帮助上下文 ID：0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T02:51:27.503

您是否尝试过取消选中 DTS 包属性的“高级”选项卡上的“使用事务”复选框？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T14:49:41.797

我的建议是检查驱动程序信息，看看是否可以从 Microsoft 或 IBM 获得更新版本。您也可以尝试通过与机器 DSN 的 ODBC 连接。相信很多人在升级到 SQL Server 2000 的 SP 4 时都会遇到这个问题。

# c# - 使用 POST 的 HttpWebRequest 的性能

> ID：416306
> 
> 赞同：2
> 
> 时间：2009-01-06T12:15:48.817
> 
> 标签：c#, .net, performance, post, httpwebrequest

我有一个用于测试网络服务的小工具。

它可以使用 POST 或使用 GET 调用 web 服务。

使用 POST 的代码是

```
public void PerformRequest()
{
  WebRequest webRequest = WebRequest.Create(_uri);

  webRequest.ContentType = "application/ocsp-request";
  webRequest.Method = "POST";
  webRequest.Credentials = _credentials;
  webRequest.ContentLength = _request.Length;
  ((HttpWebRequest)webRequest).KeepAlive = false;

  using (Stream st = webRequest.GetRequestStream())
    st.Write(_request, 0, _request.Length);

  using (HttpWebResponse httpWebResponse = (HttpWebResponse)webRequest.GetResponse())
  using (Stream responseStream = httpWebResponse.GetResponseStream())
  using (BufferedStream bufferedStream = new BufferedStream(responseStream))
  using (BinaryReader reader = new BinaryReader(bufferedStream))
  {
    if (httpWebResponse.StatusCode != HttpStatusCode.OK)
      throw new WebException("Got response status code: " + httpWebResponse.StatusCode);

    byte[] response = reader.ReadBytes((int)httpWebResponse.ContentLength);
    httpWebResponse.Close();
  }      
} 
```

使用 GET 的代码是：

```
protected override void PerformRequest()
{
  WebRequest webRequest = WebRequest.Create(_uri + "/" + Convert.ToBase64String(_request));

  webRequest.Method = "GET";
  webRequest.Credentials = _credentials;
  ((HttpWebRequest)webRequest).KeepAlive = false;

  using (HttpWebResponse httpWebResponse = (HttpWebResponse)webRequest.GetResponse())
  using (Stream responseStream = httpWebResponse.GetResponseStream())
  using (BufferedStream bufferedStream = new BufferedStream(responseStream))
  using (BinaryReader reader = new BinaryReader(bufferedStream))
  {
    if (httpWebResponse.StatusCode != HttpStatusCode.OK)
      throw new WebException("Got response status code: " + httpWebResponse.StatusCode);

    byte[] response = reader.ReadBytes((int)httpWebResponse.ContentLength);
    httpWebResponse.Close();
  }
} 
```

如您所见，代码非常相似。如果有的话，我希望 GET 方法会稍微慢一些，因为它必须在 Base64 中编码和传输数据。

但是当我运行它时，我发现 POST 方法比 GET 方法使用了更多的处理能力。在我的机器上，我可以使用大约 5% 的 CPU 运行 GET 方法的 80 个线程，而 POST 方法的 80 个线程使用 95% 的 CPU。

使用 POST 有什么本质上更昂贵的东西吗？我可以做些什么来优化 POST 方法吗？我无法重用连接，因为我想模拟来自不同客户端的请求。

dotTrace 报告说，在使用 POST 时，65% 的处理时间花费在 webRequest.GetResponse() 中。

如果这有任何区别，则底层 Web 服务将使用 Digest-Authentication。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T12:41:34.333

那么，根据最终 uri 的复杂性，可能是“GET”请求被缓存了？默认情况下不缓存“POST”，但通常会缓存“GET”（因为它应该是幂等的）。您是否尝试过嗅探，看看这里是否有什么不同？

此外 - 您可能会发现`WebClient`更易于使用 - 例如：

```
using (WebClient wc = new WebClient())
{
    byte[] fromGet = wc.DownloadData(uriWithData);
    byte[] fromPost = wc.UploadData(uri, data);
} 
```

# windows - 如何在 Windows 中检测“切换用户”的 2 种状态

> ID：416313
> 
> 赞同：0
> 
> 时间：2009-01-06T12:20:32.240
> 
> 标签：windows, windows-xp

我想知道是否有人对 API 有任何经验，可以让您在 Windows XP 下检测“切换用户”进程。

我想知道如何检测到用户退出他的帐户以及他何时重新进入。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T12:26:45.970

我想你想看看[`WM_WTSSESSION_CHANGE`](http://msdn.microsoft.com/en-us/library/aa383828%28VS.85%29.aspx)消息。

# c# - 在没有打印对话框的情况下从 C# 中的 Windows 服务打印 html 文档

> ID：416314
> 
> 赞同：7
> 
> 时间：2009-01-06T12:20:49.867
> 
> 标签：c#, html, windows, service, printing

我正在使用 Windows 服务，我想在服务启动时打印一个 .html 页面。我正在使用此代码，并且打印效果很好。但是打印对话框来了，没有打印对话框怎么打印？

```
public void printdoc(string document)
{
    Process printjob = new Process();
    printjob.StartInfo.FileName = document;
    printjob.StartInfo.UseShellExecute = true;
    printjob.StartInfo.Verb = "print";
    printjob.StartInfo.CreateNoWindow = true;
    printjob.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;

    printjob.Start();
} 
```

有没有其他方法可以在不显示打印对话框的情况下打印它。

在此先感谢，阿努普帕尔

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-09-12T22:14:43.043

这里是圣杯。

利用 StaTaskScheduler（取自 Parallel Extension Extras（[在 Code Gallery 上发布](http://code.msdn.microsoft.com/ParExtSamples/Release/ProjectReleases.aspx?ReleaseId=4179)））。

特点：等待打印完成，不显示打印设置，希望可靠。

限制：需要 C# 4.0，使用默认打印机，不允许更改打印模板

```
 TaskScheduler Sta = new StaTaskScheduler(1);
    public void PrintHtml(string htmlPath)
    {
        Task.Factory.StartNew(() => PrintOnStaThread(htmlPath), CancellationToken.None, TaskCreationOptions.None, Sta).Wait();
    }

    void PrintOnStaThread(string htmlPath)
    {
        const short PRINT_WAITFORCOMPLETION = 2;
        const int OLECMDID_PRINT = 6;
        const int OLECMDEXECOPT_DONTPROMPTUSER = 2;
        using(var browser = new WebBrowser())
        {
            browser.Navigate(htmlPath);
            while(browser.ReadyState != WebBrowserReadyState.Complete)
                Application.DoEvents();

            dynamic ie = browser.ActiveXInstance;
            ie.ExecWB(OLECMDID_PRINT, OLECMDEXECOPT_DONTPROMPTUSER, PRINT_WAITFORCOMPLETION);
        }
    }

//--------------------------------------------------------------------------
// 
//  Copyright (c) Microsoft Corporation.  All rights reserved. 
// 
//  File: StaTaskScheduler.cs
//
//--------------------------------------------------------------------------

using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Linq;

namespace System.Threading.Tasks.Schedulers
{
    /// <summary>Provides a scheduler that uses STA threads.</summary>
    public sealed class StaTaskScheduler : TaskScheduler, IDisposable
    {
        /// <summary>Stores the queued tasks to be executed by our pool of STA threads.</summary>
        private BlockingCollection<Task> _tasks;
        /// <summary>The STA threads used by the scheduler.</summary>
        private readonly List<Thread> _threads;

        /// <summary>Initializes a new instance of the StaTaskScheduler class with the specified concurrency level.</summary>
        /// <param name="numberOfThreads">The number of threads that should be created and used by this scheduler.</param>
        public StaTaskScheduler(int numberOfThreads)
        {
            // Validate arguments
            if (numberOfThreads < 1) throw new ArgumentOutOfRangeException("concurrencyLevel");

            // Initialize the tasks collection
            _tasks = new BlockingCollection<Task>();

            // Create the threads to be used by this scheduler
            _threads = Enumerable.Range(0, numberOfThreads).Select(i =>
            {
                var thread = new Thread(() =>
                {
                    // Continually get the next task and try to execute it.
                    // This will continue until the scheduler is disposed and no more tasks remain.
                    foreach (var t in _tasks.GetConsumingEnumerable())
                    {
                        TryExecuteTask(t);
                    }
                });
                thread.IsBackground = true;
                thread.SetApartmentState(ApartmentState.STA);
                return thread;
            }).ToList();

            // Start all of the threads
            _threads.ForEach(t => t.Start());
        }

        /// <summary>Queues a Task to be executed by this scheduler.</summary>
        /// <param name="task">The task to be executed.</param>
        protected override void QueueTask(Task task)
        {
            // Push it into the blocking collection of tasks
            _tasks.Add(task);
        }

        /// <summary>Provides a list of the scheduled tasks for the debugger to consume.</summary>
        /// <returns>An enumerable of all tasks currently scheduled.</returns>
        protected override IEnumerable<Task> GetScheduledTasks()
        {
            // Serialize the contents of the blocking collection of tasks for the debugger
            return _tasks.ToArray();
        }

        /// <summary>Determines whether a Task may be inlined.</summary>
        /// <param name="task">The task to be executed.</param>
        /// <param name="taskWasPreviouslyQueued">Whether the task was previously queued.</param>
        /// <returns>true if the task was successfully inlined; otherwise, false.</returns>
        protected override bool TryExecuteTaskInline(Task task, bool taskWasPreviouslyQueued)
        {
            // Try to inline if the current thread is STA
            return
                Thread.CurrentThread.GetApartmentState() == ApartmentState.STA &&
                TryExecuteTask(task);
        }

        /// <summary>Gets the maximum concurrency level supported by this scheduler.</summary>
        public override int MaximumConcurrencyLevel
        {
            get { return _threads.Count; }
        }

        /// <summary>
        /// Cleans up the scheduler by indicating that no more tasks will be queued.
        /// This method blocks until all threads successfully shutdown.
        /// </summary>
        public void Dispose()
        {
            if (_tasks != null)
            {
                // Indicate that no new tasks will be coming in
                _tasks.CompleteAdding();

                // Wait for all threads to finish processing tasks
                foreach (var thread in _threads) thread.Join();

                // Cleanup
                _tasks.Dispose();
                _tasks = null;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-20T04:56:16.127

要添加到 Vadim 的限制，您可以在打印之前设置默认打印机，方法是：

```
 static void SetAsDefaultPrinter(string printerDevice)
    {
        foreach (var printer in PrinterSettings.InstalledPrinters)
        {
            //verify that the printer exists here
        }
        var path = "win32_printer.DeviceId='" + printerDevice + "'";
        using (var printer = new ManagementObject(path))
        {
            printer.InvokeMethod("SetDefaultPrinter",
                                 null, null);
        }

        return;
    } 
```

并稍微改变 PrintHtml 方法：

```
 public void PrintHtml(string htmlPath, string printerDevice)
    {
        if (!string.IsNullOrEmpty(printerDevice))
            SetAsDefaultPrinter(printerDevice);

        Task.Factory.StartNew(() => PrintOnStaThread(htmlPath), CancellationToken.None, TaskCreationOptions.None, _sta).Wait();
    } 
```

现在我不知道在繁重的打印环境中这将如何公平，考虑到大量更改默认打印机可能会出现并发问题。但到目前为止，这是我想出的最好的解决这个限制的方法。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-06T12:58:04.770

在 Windows 服务中，Microsoft Web 浏览器控件不起作用。我曾使用过该代码，它在 Windows 应用程序中运行良好，但是当我在 Windows 服务中使用时，程序会卡在这一行

axWebBrowser1.Navigate(@"C:\mydoc.html", ref 空, ref 空, ref 空, ref 空);

感谢您的回复，阿努普帕尔

# python - URL：二进制 Blob、Unicode 还是编码的 Unicode 字符串？

> ID：416315
> 
> 赞同：2
> 
> 时间：2009-01-06T12:22:10.020
> 
> 标签：python, mysql, database, url

我希望将 URL 存储在数据库中（在本例中为 MySQL）并在 Python 中处理它。尽管数据库和编程语言可能与我的问题无关。

在我的设置中，我在查询数据库中的文本字段时收到 unicode 字符串。但是 URL 实际上是文本吗？从 unicode 编码和解码到 unicode 是应该对 URL 执行的操作吗？还是将数据库中的列设置为二进制 blob 更好？

那么，你如何处理这个问题呢？

澄清：这个问题不是关于用百分比符号对非 ASCII 字符进行 urlencoding。这是关于 unicode 表示文本和字节字符串表示将此文本编码为字节序列的方法的区别。在 Python（3.0 之前）中，这种区别在于 unicode 和 str 类型。在 MySQL 中，它是 BLOBS 的 TEXT。因此，这些概念似乎在编程语言和数据库之间对应。但是在这个方案中处理 URL 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T13:01:10.190

相关答案可在[RFC 2396](http://www.ietf.org/rfc/rfc2396.txt)的第 2.1 节*URI 和非 ASCII 字符中找到*

* * *

对于不属于 US-ASCII 的字符，URI 和字符之间的关系一直是混淆的根源。为了描述这种关系，区分“字符”（作为可区分的语义实体）和“八位字节”（8 位字节）是有用的。有两种映射，一种是从 URI 字符到八位字节，另一种是从八位字节到原始字符：

URI字符序列->八位字节序列->原始字符序列

URI 表示为字符序列，而不是八位字节序列。这是因为 URI 可能通过不通过计算机网络的方式“传输”，例如打印在纸上、通过无线电读取等。

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T12:30:39.037

关于问题：“但 URL 真的是文本吗？”

这取决于上下文，在某些语言或库中（例如 java，我不确定 python），URL 可能在内部表示为对象。但是，URL 始终具有明确定义的文本表示。因此，存储文本表示比存储当前选择的任何语言使用的内部表示更便携。

很多标准、建议和实现都涵盖了 URL 语法和语义，但我认为解析和构造正确 URL-s 的最权威来源是[RFC 2396](http://www.ietf.org/rfc/rfc2396.txt)。

关于 unicode 的问题，第 2.1 节处理非 ascii 字符。

（编辑：将 rfc-reference 更改为最新版本，谢谢 S.Lott）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T15:37:53.590

请注意，Unicode Web 地址还有一个标准 IRI（国际化资源标识符）。[RFC 3987](http://www.ietf.org/rfc/rfc3987.txt)

# svn - 有没有办法阻止文件提交到 SVN 存储库

> ID：416322
> 
> 赞同：12
> 
> 时间：2009-01-06T12:26:24.037
> 
> 标签：svn, version-control

今天我遇到了一个问题，有人不小心将 proj.user 文件提交到了 SVN 存储库。当我来更新时，它显然引起了问题。

这让我想知道是否有任何方法可以阻止某些文件扩展名提交到存储库。

我确实意识到有一个忽略列表，但据我所知，这仍然依赖于将文件添加到忽略列表的人。理想情况下，我想集中控制它，以便存储库而不是人来控制。

这可能吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-06T12:31:23.653

是的，一般来说有两种方式。要么创建提交挂钩（这可能不是您想要做的），或者更容易地将 svn:ignore 属性添加到您的目录。由于属性与项目一起维护，这将影响每个人。例如，要忽略`*.user`文件，您可以将其添加到它们将出现的目录中：

```
svn propset svn:ignore '*.user' . 
```

然后像往常一样提交您的更改。从现在开始，该目录中的 *.user 文件将不再参与 stat、update、commit 等 svn 命令。但是，您必须将该属性添加到需要忽略字段的每个目录。它不会自动递归地作用于您的项目树。如果出于任何原因，您确实想要更新被忽略的文件，您可以将`--no-ignores`标志传递给命令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T12:34:32.273

您可能会添加一个颠覆预提交钩子以防止人们提交它们。这具有服务器端的优势，而不是每个客户端设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-23T18:02:02.583

关于这一点：

> 这实际上会阻止它被明确添加 $ svn 吗？– sirlancelot 2009 年 1 月 6 日 18:14
> 
> 不，如果您专门添加它，它将被添加，但对其的更新将被忽略。– Jason Coco 2009 年 1 月 6 日 20:08

我相信你不能用 svn:ignore 道具来做到这一点。根据 svnbook 1.5 手册：

> “Subversion 对可忽略文件模式的支持仅扩展到将无版本文件和目录添加到版本控制的一次性过程。一旦对象处于 Subversion 的控制之下，忽略模式机制就不再适用于它。换句话说，不要期望 Subversion 避免提交您对版本化文件所做的更改，因为该文件的名称与忽略模式匹配——Subversion 总是注意到它的所有版本化对象。”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-12T05:25:11.380

我不得不使用

```
svn propset svn:ignore '*.user' . 
```

为了使用上面接受的答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T12:38:07.337

您想在服务器端添加一个忽略列表吗？我认为这不是直接可能的，但您可以分析预提交挂钩中的文件（请参阅：[http](http://svnbook.red-bean.com/en/1.1/ch05s02.html#svn-ch-5-sect-2.1) ://svnbook.red-bean.com/en/1.1/ch05s02.html#svn-ch-5-sect-2.1 ) 并在名称/模式不正确时完全拒绝提交？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T12:28:50.367

在 SVN 中，您手动将文件添加到存储库。因此，拥有文件扩展名阻止列表是没有意义的。您可以使用 svn ignore 忽略特定文件，但同样，您需要手动添加和删除存储库中的文件。

另请参阅[如何在不删除 subversion 中的文件的情况下从版本控制中删除文件？](https://stackoverflow.com/questions/210933/how-do-you-remove-a-file-from-being-version-controlled-without-deleting-the-file)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T12:35:51.553

查看[svn:ignore](http://svnbook.red-bean.com/en/1.1/ch07s02.html#svn-ch-7-sect-2.3.3)属性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T12:38:58.147

除了设置[忽略属性](http://svnbook.red-bean.com/en/1.1/ch07s02.html#svn-ch-7-sect-2.3.3)之外，您还可以使用“ [global-ignore](http://svnbook.red-bean.com/en/1.1/ch07.html#svn-ch-7-sect-1.3.2) ”运行时配置选项来全局执行此操作。按照链接了解更多信息。我认为 global-ignore 功能是您可能正在寻找的。

# java - Java 接口？

> ID：416331
> 
> 赞同：7
> 
> 时间：2009-01-06T12:28:14.393
> 
> 标签：java, oop

一般来说，我真的需要关于接口的帮助......

你们有什么资源可以推荐给我吗？

### 有关的：

*   [Java 接口是如何实际使用的？](https://stackoverflow.com/questions/504904/how-are-java-interfaces-actually-used)
*   [Java接口和继承](https://stackoverflow.com/questions/1215437/java-interface-and-inheritance)
*   [Java 接口使用指南——接口中的 getter 和 setter 是否不好？](https://stackoverflow.com/questions/1130294/java-interface-usage-guidelines-are-getters-and-setters-in-an-interface-bad)
*   [为什么我不能在 Java 接口中定义静态方法？](https://stackoverflow.com/questions/512877/why-cant-i-define-a-static-method-in-a-java-interface)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T12:29:28.460

[什么是接口？](http://java.sun.com/docs/books/tutorial/java/concepts/interface.html)来自Java的官方教程

编辑：同一教程的第二个资源是[接口和继承](http://java.sun.com/docs/books/tutorial/java/IandI/createinterface.html)部分。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T12:41:18.047

一般来说：

您可以将接口视为两方之间的合同或协议。所以只要接口不变，他们就可以独立开发。

调用方知道哪些行为是可用的，而执行方知道要实现什么。

使用接口有很多优点。其中之一是很容易在实现之间切换。另一个是类可以有不同的（接口）面而不使用多重继承。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T12:49:50.353

您可能想看看 Bruce Eckel 的这本出色的书（电子版免费提供）： [Thinking in Java](http://mindview.net/Books/TIJ/DownloadSites)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-29T12:40:44.987

接口就像Java类，但它只包含抽象方法和最终属性。接口基本上用于实现“多态”行为。

[这是详细的编码示例](http://theprogrammingsintroduction.blogspot.com/2014/07/what-is-interface-in-java.html)

# c++ - 现代 C 和 C++ 中是否不推荐使用 f(void)？

> ID：416345
> 
> 赞同：68
> 
> 时间：2009-01-06T12:34:40.447
> 
> 标签：c++, c, refactoring, void

我目前正在重构/整理 C++ 项目中使用的一些旧 C 代码，并经常看到以下函数：

```
int f(void) 
```

我倾向于写成：

```
int f() 
```

是否有任何理由不在整个代码库中用 () 替换 (void) 以提高一致性，或者两者之间是否存在我不知道的细微差别？

更具体地说，如果 C++ 中的虚成员函数被描述为：

```
virtual int f(void) 
```

派生类包括一个成员函数：

```
int f() 
```

这是一个有效的覆盖吗？此外，我是否可能会遇到任何基于几乎相同签名的链接器问题？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-01-06T12:37:52.813

在 C 中，声明`int f(void)`是指返回不带参数的 int 的函数。声明`int f()`意味着一个返回 int 的函数，它接受任意数量的参数。因此，如果您有一个在 C 中不带参数的函数，则前者是正确的原型。

在 C++ 中，我认为`int f(void)`它已被弃用，并且`int f()`是首选，因为它特别意味着一个不带参数的函数。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-06T12:43:15.220

添加到[克里斯的回答](https://stackoverflow.com/questions/416345/is-fvoid-deprecated-in-modern-c-and-c/416354#416354)中，根据我的经验，在 C 中使用`int f()`是不好的做法，因为您失去了编译器将函数的声明与其定义进行比较的能力，以确保正确调用它。

例如，以下代码是符合标准的 C：

```
#include <stdio.h>

void foo();

void bar(void) {
    foo();
}

void foo(int a) {
    printf("%d\n", a);
} 
```

但它会导致未定义的行为，因为`a`没有传递给`foo`.

在 C++ 中，有两个版本`foo`：一个不带参数，另一个带`int`. 所以`bar`最终调用未定义的版本，这将导致链接器错误（假设`foo`任何地方都没有其他定义）。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-28T03:25:20.840

之前的答案非常正确，但我链接到 David Tribble 的优秀页面，因为它对这个问题和许多其他问题给出了[很好的解释。](http://david.tribble.com/text/cdiffs.htm#C99-empty-parm)

亮点：

> C 区分使用空参数列表声明的函数和使用仅包含 void 的参数列表声明的函数。前者是一个带有未指定数量参数的非原型函数，而后者是一个不带参数的原型函数。
> 
> 另一方面，C++ 不区分这两个声明，并认为它们都意味着一个不带参数的函数。
> 
> 对于打算编译为 C 或 C++ 的代码，此问题的最佳解决方案是始终使用显式 void 原型声明不带参数的函数。
> 
> 空函数原型在 C99 中是一个弃用的特性（就像在 C89 中一样）。

可能值得注意的是 func(void) 语法在 C++ 中*并未*被弃用，但它通常被认为更像是一种 C 风格的习语。我认为我遇到的大多数 C++ 程序员都喜欢空参数列表。

引用 C++ 标准，第 8.3.5 节，第 2 段：

“如果 parameter-declaration-clause 为空，则函数不接受任何参数。参数列表 (void) 等效于空参数列表。除了这种特殊情况，void 不应是参数类型（尽管类型派生自 void ，如void*，可以）。”

没有提到任何一种形式都已被弃用。再次感谢 Tribble 先生出色的网站将我指向标准的正确部分。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-04-25T08:36:56.697

**[C11 N1570标准草案](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)**

`void f()`已弃用，`void f(void)`推荐：

*6.11.6 函数声明器*：

> 1 使用带空括号的函数声明符（不是原型格式参数类型声明符）是一个过时的特性。

*简介*：

> 2 某些特性已经过时，这意味着它们可能会在本国际标准的未来修订版中被考虑撤销。由于它们的广泛使用，它们被保留，但不鼓励在新实现（用于实现特性）或新程序（用于语言 [6.11] 或库特性 [7.31]）中使用它们。

详细讨论：[https ://stackoverflow.com/a/36292431/895245](https://stackoverflow.com/a/36292431/895245)

[**C++11 N3337 标准草案**](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf)

既不`void f(void)`也不`void f()`被弃用。

`void f(void)`为与 C 兼容而存在。*附录 C“兼容性”C.1.7 第 8 条：声明符*：

> 8.3.5 更改：在 C++ 中，使用空参数列表声明的函数不接受任何参数。在 C 中，空参数列表意味着函数参数的数量和类型未知。

由于`void f()`在 C 中已弃用并被`void f(void)`推荐，`void f(void)`只要 C++ 想要保持兼容性，它就会存在。

`void f(void)`并且`void f()`在 C++ 中是相同的。因此，`void f(void)`只有在您关心编写可在 C 和 C++ 下编译的代码时，更长的时间才有意义，这可能不值得。

详细讨论：[https ://stackoverflow.com/a/36835303/895245](https://stackoverflow.com/a/36835303/895245)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-01-17T18:00:56.110

tl;博士：使用`void`。

考虑到 C++ 的向后兼容性，以及下面确定的一些模糊性，我断言我们一直回到 K&R 和 ANSI C 以获得结论性答案：

```
int getline(void);
int copy(void) 
```

> 由于 getline 和 copy 的特殊版本没有参数，逻辑会建议它们在文件开头的原型应该是`getline()`and `copy()`。但是为了与旧的 C 程序兼容，该标准将空列表作为旧式声明，并关闭所有参数列表检查；该词 `void`必须用于明确的空列表。[Kernighan & Richie，C 编程语言，1988 年，第 32-33 页]

和..

> 空参数列表的特殊含义是允许旧的 C 程序使用新的编译器进行编译。但是将它与新程序一起使用是个坏主意。如果函数接受参数，则声明它们；如果不带参数，请使用 void [ibid, Pg. 73]

我在这里将其余部分分解为单独的讨论： *[在不带参数的函数声明中指定使用 void 是否解决了最令人烦恼的解析？](https://stackoverflow.com/questions/41704561/does-specifying-the-use-of-void-in-the-declaration-of-a-function-that-takes-no-a)*

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-06T12:50:58.060

在 C++ 中，`int f(void)`确实是一个已弃用的声明，它 100% 等同于`int f()`. 这*是*同一个签名。在`void`这种情况下，与空白一样重要。这也意味着它们受单一定义规则（它们不会超载）和`Derived::f(void)`覆盖的约束`Base::f()`。

不过，不要乱用类似的东西`f(const void)`。这种怪异的含义并没有太多共识。

# bash - 如何抑制 Fortran 90 程序中的 SIGSEGV 或 SIGFPE 输出？

> ID：416351
> 
> 赞同：3
> 
> 时间：2009-01-06T12:37:10.600
> 
> 标签：bash, fortran, segmentation-fault

我有一个 bash 脚本，它运行一个用 Fortran 90 编写的模拟程序，所有输出都重定向到一个文件。如果程序完成没有问题，我设置一个成功参数。代码看起来像这样：

```
#!/bin/bash
...
echo -n "正在运行程序..."
./sim_program >& 文件 && 成功="true"
如果 [ $成功 ]; 然后
  回声“确定”
别的
  回声“不好”
菲
...

```

屏幕的输出应该是“正在运行的程序...OK”或“正在运行的程序...不OK”。在某些情况下，仿真程序会因浮点异常或分段错误而崩溃，并发送相应的信号（SIGSEGV / SIGFPE）。输出可能如下所示：

```
:~>execute_script
运行程序.../path/to/script: line 232: 15350 Floating Point Exception ./sim_program >& file && success="true"
不好

```

如何抑制由于 SIGFPE 或 SIGSEGV 导致的错误输出，以便我得到

```
:~>execute_script
运行程序...不行

```

即使有这样的错误？我已经研究过使用陷阱，例如

```
陷阱 "" SIGSEGV SIGFPE
./sim_program >& 文件 && 成功="true"
陷阱 SIGSEGB SIGFPE

```

但后来我仍然得到类似的东西

```
:~>execute_script
运行程序...浮点异常
不好

```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T13:06:24.580

该错误消息可能会发送到 stderr。

尝试将其放在脚本的开头：

```
#!/bin/bash
exec 2> /dev/null 
```

发送到 stderr 的任何内容都将发送到空设备而不是您的终端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T13:03:12.590

我相信你的错误信息是写在标准错误上的。您需要将其重定向到 /dev/null。

./sim_program 2>/dev/null

# iphone - 使用我的主 iPhone 进行 SDK 开发有什么问题吗？

> ID：416353
> 
> 赞同：8
> 
> 时间：2009-01-06T12:37:45.137
> 
> 标签：iphone, xcode

我总共拥有一部 iPhone。我想在真正的 iPhone 上测试我的应用程序，这意味着允许 Xcode 在我唯一的设备上获得它肮脏的小突起。那是明智的吗？使用同一部手机进行测试和普通手机/音乐/其他用途有什么问题吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-06T13:08:57.447

我只有一部 iPhone，我用它来进行所有测试。我认为使用或调试应用程序不太可能导致任何实际问题，即使您的主手机也是如此。当然，我没有看到任何我可以归因于它的问题。

拥有一部手机的主要问题是测试版。比如说，如果他们在今天的 MacWorld 上发布 iPhone 3.0 测试版会怎样。你愿意把它放在你唯一的手机上吗？请注意，您通常无法从较新版本的操作系统降级到原始版本，因此如果您在使用 beta 时遇到问题，您可能会被它卡住。

如果出现这种情况，可能值得深入您的银行帐户，看看您是否买得起 iPod touch。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T12:43:13.347

购买另一部仅用于测试的 iPhone 可能是值得的，而您将主要的 iPhone 用于正常/个人使用。如果无法做到这一点，请确保备份所有重要数据，包括联系人列表，并在 Iphone 上执行任何未知代码之前使用常识和直觉。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T12:44:08.197

我使用加载的开发配置文件和在我的主手机上加载的“临时”配置文件来执行此操作 - 到目前为止没有问题。

编辑：我不做的一件事是在手机上远程调试代码。我只是运行正常的操作系统。

另外，在任何情况下，iTunes 都可以从备份中恢复手机。我之前在升级操作系统时已经这样做了，所以我认为在手机上开发的恐惧说实话有点迷信。（触摸木头:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T17:40:22.623

我买了一个 iPod Touch 用于开发和测试，但我并不担心对我的 iPhone 做任何坏事。

*   我不希望调试会话被电话中断。
*   我有一个我正在开发和使用的应用程序，所以我希望能够在 Touch 上玩弄虚拟数据，而不用在我的 iPhone 上弄乱我的真实数据。
*   我不介意将 Touch 交给其他人（包括儿童）让他们测试应用程序。
*   这是验证应用程序是否可以在 iPhone 和 iPod Touch 上运行的好方法。
*   我不必担心不小心将我的 iPhone 留在办公室，连接到开发机器。
*   理论上，我可以在 Touch 上安装不同版本的固件，而不必担心功能丢失。（但我没有这样做。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T00:45:04.750

自从这个问题发布以来，iPhone OS 3.0 测试版已经在开发者的世界上发布了——这里的情况有所不同。如果您将 beta OS 安装在 iPhone 上，*您将无法将其移除*。iPod touch 并非如此，但也建议谨慎使用。OS 3.0 beta，在撰写本文时（现在是 beta 3），正在稳步改进，但仍然存在很多问题，所以你真的不想把它当作你的日常手机！

当然，一旦 3.0 上线，您就可以迁移到该版本 - 但由于基带差异，您无法回到 2.x。

# javascript - Javascript 函数应该在每次页面加载时运行

> ID：416363
> 
> 赞同：0
> 
> 时间：2009-01-06T12:41:17.830
> 
> 标签：javascript, jquery, ajax, asp.net-ajax

我正在查看我正在维护（但没有编写）的 asp.net 2 Web 应用程序。

页面加载时应该发生的一些事情不会发生，但只是有时，如果您在 VM 中使用 Firefox 3，似乎会发生这种情况。使用 JQuery 和 asp.net Ajax。

每次都应该运行（但不运行）的重要功能由以下 Javascript 附加：

```
<script type="text/javascript">
//<![CDATA[
$(document).ready(function(){ Sys.Application.add_load(ImportantFunction); });   
$(document).ready(function(){ Otherstuff(); });
$(document).ready(function(){ MoreStuff(); });
//]]>
</script> 
```

但是，如果我使用 firebug 在 ImportantFunction() 中设置断点，它不会在 firefox 3 中的页面加载时命中，但会在 ajax 更新时命中。

在页面中有多次调用 $(document).ready 因为它们来自它背后的 asp.net 代码的不同部分。是的，它们都执行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T13:10:51.887

有什么理由不能使用 ASP.NET AJAX pageLoad 函数而不是 $(document).ready()？

```
function pageLoad(sender, args)
{
     ImportantFunction();
     OtherStuff();
     MoreStuff();
} 
```

这是 ASP.NET AJAX 客户端页面生命周期的一部分，其中的所有 JavaScript 代码将在每次页面加载时执行，包括异步回发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T12:55:33.620

您正在使用 jQuery 附加一个“加载”方法，然后该方法又附加一个加载事件，我认为这就是您的问题所在。

`$(document).ready`并且`Sys.Application.add_load`几乎相同，或者我的理解是这样的。不过，我不确定浏览器将按什么顺序执行它们。

我建议删除`Sys.Application.add_load`包装器调用，`ImportantFunction`这样您就不会尝试附加到已经触发的事件堆栈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T12:46:12.953

根据[最近的博客文章](http://www.tvidesign.co.uk/blog/sys.application.add_load-in-Firefox-3.aspx)，这是 FireFox 3 中的一个错误（或至少是一个错误功能）。他建议命名您的重要功能`PageLoad`以使其跨浏览器工作，但我不确定这是否有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T13:00:42.347

试试这个：

```
<script type="text/javascript">
//<![CDATA[
$(document).ready(ImportantFunction);   
$(document).ready(Otherstuff);
$(document).ready(MoreStuff);
//]]>
</script> 
```

将调用放在.js 文件`Sys.Application.add_load`的主体中：`ImportantFunction`

```
function importantFunction()
{
   Sys.Application.add_load(ImportantFunction);
} 
```

**编辑：**我不确定是否可以添加多个函数以在`$(document).ready`事件中运行。如果您这样做可能会有所帮助：

```
<script type="text/javascript">
    //<![CDATA[
    $(document).ready(init);   
    //]]>
    </script> 
```

您可以在`init`其中包含对所有其他函数的调用，即：

```
function init()
{
   importantFunction();
   otherStuff();
   moreStuff();
   //Any other functions to be called upon page load go here
} 
```

它还将使代码更易于阅读:)

# mysql - 将 2 个计数与同一张桌子上的不同位置相结合

> ID：416368
> 
> 赞同：3
> 
> 时间：2009-01-06T12:42:25.970
> 
> 标签：mysql

有没有更好的方法来做到这一点？

```
SELECT
  (SELECT count(*) FROM `tbl` WHERE `status` = 0) as 'text1',
  (SELECT count(*) FROM `tbl` WHERE `status` > 0) as 'text2' 
```

text1 和 text2 是标题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T12:50:15.830

怎么样

```
select sum(if(status=0,1,0)) as zeros, 
       sum(if(status>0,1,0)) as greater 
from tbl; 
```

可能不一定更好，但它是一个有用的习语，可以放在你的精神武器库中！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T12:54:24.590

为了简单起见并提高代码可读性，我投票赞成使用两个不同的查询。当您可以通过两个查询获得相同的结果和更易读的代码时，使用巧妙的 hack 组合查询并没有太多好处，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T12:57:11.260

这是另一种方式：

```
SELECT
  COUNT(NULLIF(`status` = 0, 0)),
  COUNT(NULLIF(`status` > 0, 0))
FROM `tbl` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T12:51:59.773

这为您提供了不同的输出，但 sorta 有效：

```
SELECT `status` > 0 AS 'stat', COUNT( * )
FROM `tbl`
GROUP BY stat 
```

输出：

```
stat | COUNT(*)
-------------------------------
 0   | (count where status = 0)
 1   | (count where status > 0) 
```

# caching - 如果底层应用程序变得不可用，有什么好的缓存反向代理可以提供陈旧的内容？

> ID：416372
> 
> 赞同：3
> 
> 时间：2009-01-06T12:43:35.390
> 
> 标签：caching, reverse-proxy, squid, varnish

我正在寻找一个缓存反向代理（比如 squid 或 varnish），它能够很好地支持在发生故障时提供陈旧的内容 - 换句话说，如果我正在代理的应用程序消失或开始提供内部服务器错误我'希望缓存继续提供从后端保存的最后一个好的响应。本质上，我希望缓存服务器在出现问题时充当额外的保护层。

有没有人配置过 Squid 或类似的东西来做到这一点？知道开箱即用支持此功能的任何产品吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T22:03:29.357

Squid 在 2.7 版本中可以做到这一点。具体来说，使用*stale-if-error*指令。更多细节可以在以下位置找到：

[http://www.mnot.net/blog/2007/12/12/stale](http://www.mnot.net/blog/2007/12/12/stale)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T15:00:31.307

看起来 Varnish 还不能满足这个要求：http: [//varnish.projects.linpro.no/ticket/369](http://varnish.projects.linpro.no/ticket/369)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T22:02:42.343

这取决于“不可用”有多长时间。Squid 有一个配置“refresh_stale_hit”，它主要用于通过在缓存更新时允许提供稍微陈旧的内容来消除一些延迟。不过，很确定它不会覆盖从 Web 服务器获得错误响应。有一个完整的“离线”模式将继续提供缓存结果（设计用于......等待它......离线使用！）所以代码路径在那里：不确定是否可以将其配置为两个代理好的结果，忽略不好的结果。

# image-processing - 以编程方式修改图像以用文本替换细节？

> ID：416376
> 
> 赞同：2
> 
> 时间：2009-01-06T12:44:32.207
> 
> 标签：image-processing

如何以编程方式重现以下效果？[（来源：][[arttext.co.uk](http://www.artext.co.uk/images/twofonts%20typography%20ascii%201.gif)][）]

[![](https://i.stack.imgur.com/OQL77.gif)](https://i.stack.imgur.com/OQL77.gif)

如果可能的话，我想自动化这个过程，但对输出有一些控制（IE，反转调色板以产生深色图像的浅色背景等）。如果可能的话，以矢量格式生成结果也会很棒。

**更新：** 不仅仅是用 ASCII-art 重新创建，我还想指定用于重新创建图像的字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T12:48:54.677

很简单：用网格划分图像，计算每个网格单元上像素的平均颜色（或亮度或色调等），创建一个相同大小的图像，绘制与网格单元对应的字母发现颜色。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T15:50:25.013

我有点忙，但我终于破解了一个小[处理](http://Processing.org)草图来演示我的算法。

```
final int GRID_SIZE_H = 9;
final int GRID_SIZE_V = 9;
final int GRID_SIZE = GRID_SIZE_H * GRID_SIZE_V;
final String TEXT_TO_DISPLAY = "Picture yourself in a boat on a river With tangerine trees and marmalade skies";

void setup()
{
  size(600, 600);
  smooth();
  noStroke();
  background(0);

  PImage niceImage = loadImage("SomeImage.png");
  int niW  = niceImage.width;
  int niH = niceImage.height;
  int imgW = niW + 10;
  image(niceImage, 0, 0);

  PFont f = loadFont("Arial-Black-12.vlw");
  textFont(f);
  textAlign(CENTER);
  String textToDisplay = TEXT_TO_DISPLAY.toUpperCase().replaceAll("\\s", "");

  int pos = 0;
  niceImage.loadPixels();
  for (int j = 0; j < niH - GRID_SIZE_V; j += GRID_SIZE_V)
  {
    for (int i = 0; i < niW - GRID_SIZE_H; i += GRID_SIZE_H)
    {
      long avgR = 0, avgG = 0, avgB = 0;
      for (int x = 0; x < GRID_SIZE_H; x++)
      {
        for (int y = 0; y < GRID_SIZE_V; y++)
        {
          int c = niceImage.pixels[i + x + (j + y) * niW];
          avgR += (c >> 16) & 0xFF;
          avgG += (c >>  8) & 0xFF;
          avgB +=  c        & 0xFF;
        }
      }
      color clr = color(avgR / GRID_SIZE, avgG / GRID_SIZE, avgB / GRID_SIZE);
      fill(clr);
      char chr = textToDisplay.charAt(pos++);
      pos = pos % textToDisplay.length();
      text(chr, i + imgW, j + 12);
    }
  }
} 
```

应该更好地使用粗体（粗体）等宽字体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T12:56:31.137

mplayer 有两个驱动程序可以解决这个问题，一个是名为“libaa”/ascii-art 的 BW，另一个是“libcaca”：

两者都可以使用资源，我不记得在哪个许可证下。

查看这两个库的屏幕截图：http: [//liquidweather.net/howto/index.php ?id=74](http://liquidweather.net/howto/index.php?id=74)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-20T19:19:51.817

它甚至比 PhiLho 的答案更简单。只需将文本渲染为黑色背景上全白的相同大小的图像（如果您愿意，可以预先生成）并将此“文本掩码”图像与源图像相乘。如果您不希望小于字符的细节保持可见，则可能需要使用半径与文本大小相当的高斯模糊来模糊源图像。

# perl - 如何在 Perl 中计算双阶乘？

> ID：416377
> 
> 赞同：2
> 
> 时间：2009-01-06T12:45:11.660
> 
> 标签：perl, bignum

鉴于 Wikipedia 对[Double Factorial](http://en.wikipedia.org/wiki/Factorial#Double_factorial)的讨论，任何人都可以建议我在哪里可以找到 Perl 的 bignum 版本，或者建议如何编写它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T12:57:56.610

Perl 将处理您的 C 编译器可以处理的任何内容，对于任何更大的内容，您应该使用[Math::BigInt](http://perldoc.perl.org/Math/BigInt.html)。

我建议您阅读[perlnumber](http://perldoc.perl.org/perlnumber.html)。

双阶乘的定义（在 perl 高尔夫中）：

```
sub f{$_[0]&&$_[0]>=2?$_[0]*f($_[0]-2):1} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T21:48:02.907

这里有很多实现[快速阶乘函数](http://www.luschny.de/math/factorial/FastFactorialFunctions.htm)的替代方法。穷人算法对你来说可能是一个不错的选择，因为它不使用大整数库，并且可以很容易地用任何计算机语言实现，甚至可以快速达到 10000！。

翻译成 Perl 留给 OP 练习 :-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T22:09:14.563

Perl 5.8 和更高版本带有[bignum](http://perldoc.perl.org/bignum.html)包。只需将它用于您的脚本，剩下的就交给它了：

```
use bignum; 
```

当我在“Profiling”一章中使用阶乘时，我在[Mastering Perl](http://oreilly.com/catalog/9780596527242/)中谈到了这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T05:33:23.027

尽管 dsm 的答案是准确的，但在 Perl 中计算阶乘的*真正*方法，无论您是否使用 dsm 的算法（是否打高尔夫球）都是记忆*[它](http://perldoc.perl.org/Memoize.html)*。如果您要以任何频率调用它，您将需要记住任何递归数学函数。

```
use Memoize;
memoize( 'fact2' );

sub fact2 {$_[0]&&$_[0]>=2?$_[0]*fact2($_[0]-2):1} 
```

# java - JRE由什么组成？

> ID：416387
> 
> 赞同：2
> 
> 时间：2009-01-06T12:48:13.323
> 
> 标签：java

我知道 JDK 由所有 java 包组成。但是除了 java.exe 之外，JRE 还包括什么？我可以理解 JRE 中“bin”文件夹中事物的必要性，但是“lib”文件夹呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T12:55:53.680

查看 Sun 的 JDK 文档中的这个[JDK 和 JRE 文件结构](http://java.sun.com/javase/6/docs/technotes/tools/windows/jdkfiles.html)文档。

它特别说明了有关`lib`目录的以下内容：

> Java 运行时环境使用的代码库、属性设置和资源文件。例如：
> 
> *   rt.jar - 引导类（构成 Java 平台核心 API 的 RunTime 类）。
> *   charsets.jar -- 字符转换类。
> 
> 除了 ext 子目录（如下所述），还有几个额外的资源子目录在这里没有描述。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T13:15:31.660

JRE 由作为 Java 语言的运行时解释器的 JVM、类加载器、安全执行实现类、Java API（核心类、SE 类）和包括 Java Web Start 的 Java Web（部署）基础组成。

JRE 的 lib 部分是 Java 的库，其中包含为 JavaBeans 组件 (JBCL) 和通用集合 (GCL) 等特性奠定基础的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T12:52:12.377

它的其余部分具有运行时支持，包括标准类库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-18T07:51:31.913

JRE是一个Java运行时环境，它包含一组库+JVM使用运行时的其他文件。JRE为Java应用程序提供运行时环境。JVM的JRE实现。

# html - 使用 CSS 创建特定宽度的表格单元格，无需自动换行

> ID：416401
> 
> 赞同：6
> 
> 时间：2009-01-06T12:53:02.533
> 
> 标签：html, css, cross-browser, css-tables

在一个项目中，我需要渲染具有特定宽度列的表格，每个表格行只有一个 HTML 行（不换行）。我需要每个表格单元在顶部和底部有 1 个像素的填充，在左右有 2 个像素的填充。我能想出的*跨浏览器*的最佳方法是以这种方式将 div 放在表格内的 td 中：

```
<style>
  table.grid { border: none; border-collapse: collapse; }
  table.grid tbody tr td { padding: 1px 2px; }
  table.grid tbody tr td div { overflow: hidden; white-space: nowrap; }
  table.grid tbody tr td.one { width: 100px; }
  table.grid tbody tr td.two { width: 200px; }
</style>
<table class="grid">
  <tbody>
    <tr>
      <td class="one"><div>One</div></td>
      <td class="two"><div>Two</div></td>
    </tr>
    <tr>
      <td class="one"><div>Another One</div></td>
      <td class="two"><div>Another Two</div></td>
    </tr>
  </tbody>
</table> 
```

我希望能够消除添加额外 div 的需要。我花了很多时间在谷歌上搜索这个问题，但找不到替代方案。

有没有办法在不需要添加额外的 div 的情况下做我需要的事情？如果是，那是什么？

有没有办法在不使用表格的情况下获得所需的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T13:11:39.623

不幸的是，表格元素不尊重溢出，因此您需要将其应用于子元素。

编辑：我可能说得太早了，因为我可以使用 FF 在 FF 中创建这种效果，`max-width`而且我发现了[这个](http://www.blakems.com/archives/000077.html)可能适用于 IE 的东西。你每天都会学到一些东西。

edit2：是的，它至少适用于 IE7，但有一个严重的警告，文本中不能有空格，它们必须转换为`&nbsp;`. `<div>`为了清洁和兼容性，我认为您可能应该坚持使用该解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-22T20:08:10.247

其实，**你可以**。

通常，表会占用它需要的空间。如果您给出`table`100% 的宽度，它将占用 100% 的 with 并在单元格之间**共享****其内容**。

**表格中没有可用空间：在某些时候，一旦设置了其他单元格的大小，就必须有一个单元格占用剩余空间**。

要设置单元格的宽度，您需要将**a`width`和 a`max-width`赋予相同的 size**。对于具有 N 列的表，您可以对 N-1 列执行此操作，最后一列将占用剩余空间。

如果对 N-2 列执行此操作，则没有固定的两列将共享剩余空间。

有了这一切，您可以添加`white-space:no-wrap`和/或`text-overflow:ellipsis`如果您愿意。

这是一个图像示例（我的 RSS 阅读器）： [https ://i.stack.imgur.com/bPpKP.png](https://i.stack.imgur.com/bPpKP.png)

还有一个活生生的例子：[https ://codepen.io/lehollandaisvolant/pen/REVNLy?editors=1100](https://codepen.io/lehollandaisvolant/pen/REVNLy?editors=1100)

你可以看到它实际上是非常强大的。在codepen中，您可以看到：

*   一些单元格是固定宽度
*   一些单元格适合它包含的文本
*   一些单元格适合容器

您可以决定每个单元格的行为（只要有一个单元格适合容器）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-06T13:08:28.117

您不需要在每个表格单元格中嵌套一个 div。以下应该达到相同的效果。

```
<style>
  table.grid { border-collapse: collapse; }
  table.grid tbody tr td { overflow: hidden; white-space: nowrap; padding: 1px 2px; }
  table.grid tbody tr td.one { width: 100px; }
  table.grid tbody tr td.two { width: 200px; }
</style>
<table class="grid">
  <tbody>
    <tr>
      <td class="one"><span>One</span></td>
      <td class="two"><span>Two</span></td>
    </tr>
    <tr>
      <td class="one"><span>Another One</span></td>
      <td class="two"><span>Another Two</span></td>
    </tr>
  </tbody>
</table> 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-01-29T15:31:47.363

您也可以简单地用 div 替换 table。

然后你必须在 CSS 中定义列宽（这可能很难在所有浏览器上工作）。

示例：您的代码将如下所示：

```
<div class="mainBoxOfTable">
    <div class="Line">
      <div class="ColumnOne">One</div>
      <div class="ColumnTwo">Two</div>
    </div>
    <div class="Line">
      <div class="ColumnOne">another One</div>
      <div class="ColumnTwo">another Two</div>
    </div>
 </div> 
```

# python - 从列表中过滤掉附近的点

> ID：416406
> 
> 赞同：0
> 
> 时间：2009-01-06T12:54:57.800
> 
> 标签：python, algorithm, language-agnostic, bitmap, filtering

关于在位图中查找质量簇的问题，我[回答了一半](https://stackoverflow.com/questions/411837/finding-clusters-of-mass-in-a-matrix-bitmap#411855)。我说一半是因为我把它留在了位图中的所有点都按质量排序的条件下，然后留给读者过滤从同一簇中删除点的列表。

然后，当考虑这一步时，我发现解决方案并没有像我想象的那样跳出来。所以现在我向你们寻求帮助。我们有一个具有类似质量的点列表（一个 Python 元组列表，但您可以用任何语言表示它）：

```
[ (6, 2, 6.1580555555555554),
  (2, 1, 5.4861111111111107),
  (1, 1, 4.6736111111111107),
  (1, 4, 4.5938888888888885),
  (2, 0, 4.54),
  (1, 5, 4.4480555555555554),
  (4, 7, 4.4480555555555554),
  (5, 7, 4.4059637188208614),
  (4, 8, 4.3659637188208613),
  (1, 0, 4.3611111111111107),
  (5, 8, 4.3342191043083904),
  (5, 2, 4.119574829931973),
  ...
  (8, 8, 0.27611111111111108),
  (0, 8, 0.24138888888888888) ] 
```

每个元组的形式为：

```
(x, y, mass) 
```

请注意，列表在此处排序。如果您的解决方案不希望对它们进行排序，那完全可以。

[如果你还记得](https://stackoverflow.com/questions/411837/finding-clusters-of-mass-in-a-matrix-bitmap)的话，挑战是找到主要的质量群。集群的数量是未知的。但是您知道位图的尺寸。有时，一个簇中的几个点的质量比下一个（按大小）簇的中心大。所以我想要做的是从质量较高的点出发并删除同一簇中的点（附近的点）。

当我尝试这样做时，我最终不得不一遍又一遍地遍历列表的某些部分。我有一种感觉，我对此很愚蠢。你会怎么做？伪代码或真实代码。当然，如果您可以使用 Python 代码从我在该答案中留下的地方开始，那么我更容易尝试它。

下一步是计算位图中真正有多少簇。我仍在努力定义这个问题，所以我可能会带着一个问题回来。

**编辑：**我应该澄清一下，我知道这个问题没有“正确”的答案。问题的名称是关键。我的集群的第一阶段已经完成。**我正在寻找一种快速、准确“足够”的方法来过滤掉附近的点。**

如果您看到我如何使问题更清楚，请告诉我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T15:46:16.567

正如你所知道的，你正在寻求一个[不适定](http://en.wikipedia.org/wiki/Ill-posed)问题的解决方案：不存在明确的解决方案。没关系……它只是让它更有趣。你的问题是不适定的，主要是因为你不知道你想要多少个集群。聚类是机器学习的关键领域之一，多年来已经开发了很多方法。

正如 Arachnid 所指出的，[k-means](http://en.wikipedia.org/wiki/K_means)算法往往是一个很好的算法，而且很容易实现。结果主要取决于所做的初始猜测和所需集群的数量。为了克服初始猜测问题，通常使用随机初始化多次运行算法并选择最佳结果。您需要定义“最佳”的含义。一种度量是每个点到其聚类中心的均方距离。如果您想自动猜测有多少个集群，您应该使用整个集群数量范围运行该算法。对于任何好的“最佳”度量，更多的集群看起来总是比更少的更好，所以你需要一种惩罚集群太多的方法。[MDL](http://en.wikipedia.org/wiki/Minimum_description_length) _维基百科上的讨论是一个很好的起点。

K-means 聚类基本上是最简单的[混合模型](http://en.wikipedia.org/wiki/Mixture_model)。有时，升级到通过期望最大化学习的混合高斯是有帮助的（在刚刚给出的链接中描述）。这可能比 k-means 更健壮。理解它需要更多的努力，但是当你理解它时，它的实现并不比 k-means 难多少。

还有很多其他的[聚类技术](http://en.wikipedia.org/wiki/Data_clustering)，例如凝聚聚类和谱聚类。凝聚集群很容易实现，但选择何时停止构建集群可能很棘手。如果您进行凝聚聚类，您可能希望查看[kd 树](http://en.wikipedia.org/wiki/Kd-tree)以进行更快的最近邻搜索。smacl 的答案描述了一种使用 Voronoi 图进行凝聚聚类的方式略有不同。

有些模型可以自动为您选择集群的数量，例如基于[潜在狄利克雷分配](http://en.wikipedia.org/wiki/Latent_Dirichlet_allocation)的模型，但它们很难正确理解实现。

您可能还想查看[均值偏移](http://www.wisdom.weizmann.ac.il/~deniss/vision_spring04/files/mean_shift/mean_shift.ppt)算法，看看它是否更接近您真正想要的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T13:56:27.520

在我看来，您正在寻找[K-means](http://en.wikipedia.org/wiki/K_means)算法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T13:42:05.193

正如我在对您的问题的评论中提到的那样，答案取决于在这种情况下是否可以将质量视为标量。如果是这样，基于颜色的解决方案可能不会起作用，因为颜色通常不被视为标量。

例如，如果我有一个质量为 1 个点的给定区域，这与具有 10 个质量的 1/10 点的相同区域相同吗？如果这是真的，那么在这种情况下质量不是标量，我倾向于研究一种用于在空间上对类似的不可缩放值进行组合的算法，例如[voronoi 图](http://en.wikipedia.org/wiki/Voronoi_diagram)。

![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/Coloured_Voronoi_2D.svg/600px-Coloured_Voronoi_2D.svg.png)

在这种情况下，两个相邻的 voronoi 区域具有足够接近的质量匹配和距离，它们可以聚集在一起。您可以重复此操作以查找所有集群。

另一方面，如果您的质量是可扩展的，或者未知位置的质量可以从周围的点进行插值，我会倾向于对输入数据进行[三角剖分](http://en.wikipedia.org/wiki/Delaunay_trianglulation)和轮廓化，并使用轮廓之间的区域来查找质量相似的集群。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T13:02:17.553

这听起来像颜色量化，您可以减少图像中的颜色数量。一种方法是在空间中绘制颜色，并将集群组合到集群的中心（或加权平均值）。

触发此内存的算法的确切名称让我失望，但如果它弹出我会编辑答案，但与此同时，你应该看看颜色量化，看看一些算法是否有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T13:03:48.440

从“[凸壳](http://en.wikipedia.org/wiki/Convex_hull)”问题开始。您还在寻找一些类似“凸包”的集群。

请注意，“集群”是模糊的。你在你的领域有一个平均质量。有些点的质量高于平均水平，有些低于平均水平。高于平均水平多少意味着您找到了一个集群？节点必须相距多远才能成为集群或单独集群的一部分？

两个山峰和一个山脊有什么区别？

您必须计算“地形” - 将所有具有相等密度的点连接到区域中。这要求您选择一个点并从一个点径向计算出您想要的位置，定位密度相等的位置。您可以将这些点连接到区域中。

如果您明智地选择了初始点，则区域应该嵌套。选择起点很容易，因为您从当地的高点开始。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T13:21:28.060

既然您已经在谈论质量，为什么不使用基于重力的解决方案。一个简单的粒子系统不需要非常精确，而且您不必运行太长时间就可以更好地猜测集群的数量。

如果您对簇数有更好的了解，则 k-means 最近邻变得可行。

# iis-7 - 如何拒绝访问网站中的 .dll 文件（在 IIS 6 和 7 上）

> ID：416420
> 
> 赞同：1
> 
> 时间：2009-01-06T13:00:11.240
> 
> 标签：iis-7, iis-6, web-config

如果我使用像[http://mysite/myfolder/myfile.dll](http://mysite/myfolder/myfile.dll)这样的 URL ，我会看到一个对话框“你想打开还是保存这个文件”。当然，我不希望人们能够下载和反汇编我们的 dll。如何拒绝人们直接访问此类文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T13:08:25.963

通常默认情况下不允许这样做。如果您进入 IIS 管理器并编辑网站，则需要取消选中“脚本源访问”。DLL 也应该在被禁止的文件扩展名列表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T13:04:26.317

简短的回答是，不应该有您不想在 Web 根目录下提供的文件。

我个人不知道 IIS 6 或 7，但是在 Apache 下，一个目录被指定为 web 根目录，例如 \site\htdocs，并且它上面的任何东西都不能被外部访问。如果您将 DLL 文件保留在该层次结构之外，那么它们将无法访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T13:33:00.487

设置适当的 windows 文件安全和访问权限。

例如，当您使用 asp.net 时，您应该拒绝除 ASPNET 帐户之外的所有用户访问 .dll。

!IUSR_xxx 帐户应该对您的 .dll 没有任何权利！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T14:30:52.927

在 asp.net 站点中拒绝所有 dll 是非常激烈的，因为 Silverlight 等使用需要由客户端浏览器下载的客户端 dll。

您可以使用 IIS 管理控制台或管理 API 来禁用对 dll 文件或目录的身份验证。

只需取消选中所有身份验证选项，访问将被拒绝。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-27T14:44:36.317

如果由于某种原因无法更改 IIS 中的脚本映射，则可以使用[HttpForbiddenHandler](http://support.microsoft.com/kb/815152)

# javascript - 检查字符串是否是 Javascript RegExp 的前缀

> ID：416425
> 
> 赞同：14
> 
> 时间：2009-01-06T13:01:49.240
> 
> 标签：javascript, regex, prefix

在 Javascript 中，我定义了一个正则表达式，现在用户正在输入一个字符串。我想告诉他，如果他继续打字或者他已经走错了路，他的字符串是否仍然可以匹配正则表达式。例如：

```
var re = /a*b/;

"a".isPrefixOf( re ); // true
"x".isPrefixOf( re ); // false 
```

一个实现`isPrefixOf`看起来如何？

**更新：**感谢您的回答，按照布拉德的建议，使正则表达式前缀证明似乎是一个很好的解决方法。但我仍在努力寻找一个通用的解决方案。

也许是这样：我们创建一个新的正则表达式，用户输入后跟`.*`. 这个正则表达式描述了用户仍然可以输入的所有单词。如果这个创建的正则表达式和原始正则表达式的交集是空的，那么用户已经走错路了。如果不是，他过得很好。例如：

```
var re = /a*b/;
var sInput = "a";
var reInput = new RegExp( sInput + ".*" );

reIntersection = re.intersect( reInput );
reIntersection.isEmpty(); // false 
```

`intersect()``re`返回一个新的正则表达式，它只接受两个都接受的单词`reInput`。该功能尚不存在，但我们可以使用前瞻来实现它：

```
RegExp.prototype.intersect = function( pattern2 ) { 
    return new RegExp( '(?=' + this.source  + ')' + pattern2.source );
} 
```

保持开放的是`isEmpty()`功能。我们如何检查 Javascript 正则表达式是否匹配任何单词或者它是否为空？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T17:11:34.710

人们似乎对他们如何解释这个问题意见不一，所以我将通过一个 Java 示例来演示这个概念。

```
import java.util.regex.*;

public class Test
{

  public static void main(String[] args) throws Exception
  {
    tryMatch("^a*b+$", "a", "ab", "abc");
  }

  public static void tryMatch(String regex, String... targets)
  {
    Pattern p = Pattern.compile(regex);
    Matcher m = p.matcher("");
    System.out.printf("%nregex: %s%n", regex);
    System.out.printf("target | matches() | hitEnd()%n");
    for (String str : targets)
    {
      m.reset(str);
      System.out.printf("%-6s | %-9B | %-9B%n",
          str, m.matches(), m.hitEnd());
    }
  }
} 
```

输出：

```
regex: ^a*b+$
target | matches() | hitEnd()
a      | FALSE     | TRUE
ab     | TRUE      | TRUE
abc    | FALSE     | FALSE 
```

目标字符串“a”不匹配，因为正则表达式至少需要一个`b`，但它可能是成功匹配的前缀，因此`hitEnd()`返回`true`。`b`字符串 "ab" 具有匹配所需的所有内容，但如果我们在末尾添加更多 ' ，它也会匹配，所以`hitEnd()`仍然返回`true`。对于“abc”，匹配尝试在到达目标字符串末尾之前失败，因此正则表达式无法匹配任何以“abc”开头的字符串。

据我所知，Javascript 没有任何类似 Java 的`hitEnd()`方法，但有可能伪造它。如果有人知道怎么做，那就是那个臭名昭著的坏蛋，[史蒂文·利维森](http://blog.stevenlevithan.com/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T14:05:04.947

I think your best bet here is to make your Regex prefix-proof. For the example you gave, `/a*b/`, I think you could probably use `/a*b?/.test(userinput)`. For more complex patterns this could get increasingly difficult, but I still think it can be done by nesting each subexpression in a series of optional quantifiers (`?`). For instance:

```
/a*bcd*e/ 
```

The prefix regex could be:

```
/a*(b(c(d*e?)?)?)?/ 
```

Its a little messy, but will solve your problem rather well I think.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T13:54:24.343

非常有趣的问题。在我的快速搜索中，我没有找到任何可以解决这个问题的预定义（甚至在 Perl 中也没有）。

编辑：哎呀，似乎Java有类似的东西叫做hitEnd()——见Alan M的回答。hitEnd() 的作用是说 match() 的结果（真或假）可能会被额外的输入修改。“掌握正则表达式”一书说它不是很可靠（不知道为什么，谷歌书籍中没有第 392 页）。

根据您使用的正则表达式的哪些功能，快速破解，例如为您的正则表达式编写某种前缀：

例如，对于 a+a*b+c，您的前缀将是：

```
一个+
一个+一个*
a+a*b+
a+a*b+c

```

并尝试将它们中的任何一个与您的字符串匹配可能会起作用。如果您使用选择运算符、使用范围运算符 {n,m} 或反向引用，则此快速破解将变得困难。

话虽如此，我认为好的解决方案是稍微修改匹配算法。

通常采用的匹配算法是回溯算法（在实践中效果很好，即使最坏情况的行为是指数的）。只要到达正则表达式的末尾，该算法就会成功终止（即使没有消耗整个字符串）。您需要做的是修改终止条件，使其在消耗完所有输入后也成功终止。

话虽如此，您可能必须在 JavaScript 中实际实现该算法。希望这将成为 Jquery 等库的一部分。

有关该算法的更多参考资料和理论，请查看这篇文章：

[http://swtch.com/~rsc/regexp/regexp1.html](http://swtch.com/~rsc/regexp/regexp1.html)

（即使它反对回溯算法并建议使用基于 FA 的算法（但 FA 无法处理反向引用））。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-06T13:32:05.667

执行此操作的一种方法可能是连接到文本框的 onKeyUp 事件并**针对**正则表达式测试文本。 **我的假设当然是你想做一个正则表达式匹配。** 我不确定这是否正是您所需要的，实际上是您的代码：

```
"a".isPrefixOf( re ); // true 
```

永远不会匹配，因为它还需要有一个后续的“b”字符（您可能想要修改正则表达式）。例如，此代码将针对与此格式匹配的任何字符串进行测试：

```
a-n(n)-b 
```

这是代码，将其保存为页面并在浏览器中加载：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="it">
<body>
    <input type="text" size="20" id="txtData" onkeyup="showResult()" />
    <div id="dvResult" />
</body>
</html>
<script type="text/javascript">
//<![CDATA[

    theRegExp = /^a\-\d{1,2}\-b$/;

    function isPrefixOf( aText, aRegExp )
    {
        return aRegExp.test( aText );
    }

    function showResult()
    {
        res = document.getElementById( "dvResult" );
        res.innerHTML = isPrefixOf( document.getElementById( "txtData" ).value, theRegExp ) ? "Correct" : "Bad input";
    }

//]]>
</script> 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-06T13:09:05.993

首先，您将正则表达式定义为： var re = new RegExp(/^(regexp here)$/);

在 onKeypress 事件中，您可以像这样检查正则表达式：

text.match(regexp) - 其中文本是输入的字符串。

这清楚吗？

# java - 我有哪些选择来存储和查询大量重复的数据？

> ID：416432
> 
> 赞同：4
> 
> 时间：2009-01-06T13:04:44.367
> 
> 标签：java, database, hibernate, jdbc, compression

我正在评估 Java 中高效数据存储的选项。数据集是带有命名主键的时间戳数据值。例如

```
Name: A|B|C:D
Value: 124
TimeStamp: 01/06/2009 08:24:39,223 
```

可能是给定时间点的股票价格，所以我想它是一个经典的时间序列数据模式。但是，我真的需要一个通用的 RDBMS 解决方案，它可以与任何合理的 JDBC 兼容数据库一起使用，因为我想使用 Hibernate。因此，对 Oracle 等数据库的时间序列扩展并不是一个真正的选择，因为我希望实现者能够使用他们自己的支持 JDBC/Hibernate 的数据库。

这里的挑战仅仅是可以在短时间内积累的海量数据。到目前为止，我的实现主要集中在定义定期汇总和清除计划，其中原始数据被聚合到 DAY、WEEK、MONTH 等表中，但缺点是粒度的早期损失以及存储在不同的周期之间的周期不匹配的轻微不便聚合体。

挑战的选择有限，因为在保持数据的原始粒度的同时可以物理压缩多少数据是有绝对限制的，而使用关系数据库的指令和支持通用 JDBC 的指令加剧了这一限制.

借用经典数据压缩算法的概念概念，并利用同一命名键的许多连续值可以预期相同的事实，我想知道是否有方法可以通过将重复值合并为无缝减少存储记录的数量一个逻辑行，同时还存储一个计数器，该计数器有效地指示“下一个**n**记录具有相同的值”。实现这一点似乎很简单，但要权衡的是，现在使用标准 SQL 查询数据模型非常复杂，尤其是在使用任何类型的聚合 SQL 函数时。这显着减少了数据存储的有用性，因为只有复杂的自定义代码才能将数据恢复到“解压缩”状态，从而导致与数百个无法正确呈现此数据的工具的阻抗不匹配。

我考虑了定义自定义 Hibernate 类型的可能性，这些类型基本上可以“理解”压缩数据集并将其备份并返回带有动态创建的合成行的查询结果。（除了严格控制的输入流之外，数据库将只读给所有客户端）。除了原始 JDBC（例如 JasperReports）之外，我想到的一些工具将与 Hibernate/POJOS 集成，但这并不能真正解决聚合函数问题，并且可能还有许多其他问题。

因此，我可能不得不使用更专有的 [可能是非 SQL] 数据存储（任何建议表示赞赏），然后专注于编写伪 JDBC 驱动程序的可能不太复杂的任务，以至少简化与外部工具。

我听说过一种称为“*位压缩文件*”的东西作为实现这种数据压缩的机制的参考，但我不知道有任何数据库提供这个以及我想要做的最后一件事（或者可以做，真的...... ) 是写我自己的数据库。

有什么建议或见解吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T13:48:11.377

Hibernate（或任何 JPA 解决方案）不适合这项工作。

JPA/Hibernate 不是一个轻量级的解决方案。在大容量应用程序中，开销不仅很大，而且令人望而却步。您确实需要研究[网格和集群解决方案](https://stackoverflow.com/questions/383920/what-is-the-best-library-for-java-to-grid-cluster-enable-your-application#383929)。我不会在这里重复对各种技术的概述。

我在金融市场信息系统方面有很多经验。你说的几件事让我印象深刻：

*   你有很多原始数据；
*   您想对该数据应用各种聚合（例如打开/最高/最低/关闭每日摘要）；
*   高可用性可能是一个问题（在这类系统中总是存在）；和
*   低延迟可能是一个问题（同上）。

现在对于网格/集群类型的解决方案，我将它们大致分为两类：

1.  基于地图的解决方案，例如 Coherence 或 Terracotta；和
2.  基于 Javaspaces 的解决方案，例如 GigaSpaces。

我经常使用 Coherence，Map 解决方案可能很好，但也可能有问题。连贯图可以在它们上面有监听器，您可以使用这种东西来执行以下操作：

*   市场价格警报（用户可能希望在价格达到一定水平时收到通知）；
*   衍生品定价（例如，当标的证券改变最后交易价格时，交易所交易的期权定价系统将需要重新定价）；
*   交易匹配/预订系统可能希望匹配收到的交易通知以进行对账；
*   等等

所有这些都可以通过侦听器完成，但在 Coherence 中，例如侦听器必须便宜，这会导致诸如 Map 具有侦听器之类的事情，而不是向另一个 Map 写入内容，这可以链接一段时间。此外，修改缓存条目可能会出现问题（尽管也有处理此类问题的机制；我说的是关闭市场价格警报这样的情况，这样它就不会再次触发）。

我发现 GigaSpaces 类型的网格解决方案对于此类应用程序更具吸引力。读取（或破坏性读取）操作是一种非常优雅且可扩展的解决方案，您可以获得具有亚毫秒性能的事务性网格更新。

考虑两种经典的队列架构：

*   请求/响应：一条错误的消息会阻塞队列，虽然您可以有许多发送者和接收者（为了可扩展性），但扩大管道的数量并不总是那么简单；和
*   发布/订阅：这将发送者和接收者解耦，但缺乏可扩展性，因为如果您有多个订阅者，他们将各自收到消息（不一定是您想要的预订系统）。

在 GigaSpaces 中，破坏性读取就像一个可扩展的发布-订阅系统，而读取操作就像传统的发布-订阅模型。在网格之上构建了一个 Map 和 JMS 实现，它可以进行 FIFO 排序。

现在我听到你问持久性怎么样？坚持是决定所有其他事情的结果。对于这种应用程序，我喜欢[Persistence as a Service](http://natishalom.typepad.com/nati_shaloms_blog/2007/09/paas-persistenc.html)模型（讽刺的是，它是关于 Hibernate 的，但它适用于任何东西）。

基本上，这意味着您的日期存储命中是异步的，并且可以很好地处理汇总数据。就像您可以让服务监听交易通知并仅保留它感兴趣的通知（如果需要，在内存中聚合）。您可以通过这种方式进行开盘价/最高价/最低价/收盘价。

对于大量数据，您并不想将其全部写入数据库。反正不同步。持久存储加上数据仓库可能更适合您，但这又取决于需求、数量等。

这是一个复杂的话题，我只是真正接触过它。希望对您有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T16:13:23.610

我会看一个 [面向列的数据库](http://en.wikipedia.org/wiki/Column-oriented_DBMS "面向列的数据库")。对于这种应用程序来说会很棒

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-18T16:36:25.910

您可能会发现在 Money:Tech 上聆听[Michael Stonebraker 的演讲](http://itc.conversationsnetwork.org/shows/detail4009.html)很有趣。他谈到了您提到的一些需要，并说明了三大巨头（SQL Server、Oracle 和 DB2）如何永远无法满足滴答存储的需求（看起来您正在构建）。他超越了专栏商店，我同意这是正确的方向。他甚至讨论了压缩和速度，这对您来说都是问题。

这里还有一些您可能会感兴趣的链接：

*   [LucidDB](http://www.luciddb.org/) - 开源列存储
*   关于列存储与行存储的[学术论文](http://cs-www.cs.yale.edu/homes/dna/papers/abadi-sigmod08.pdf)
*   其他人[在博客上讲述了类似的斗争](http://www.cerebralmastication.com/?p=235)
*   [SQLStream](http://www.sqlstream.com/)值得了解

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T18:31:29.667

许多支持 JDBC 的数据库管理系统（例如 Oracle）在物理存储引擎中提供压缩。例如，Oracle 有一个没有解压缩开销的“压缩”表的概念：

[http://www.ardentperf.com/wp-content/uploads/2007/07/advanced-compression-datasheet.pdf](http://www.ardentperf.com/wp-content/uploads/2007/07/advanced-compression-datasheet.pdf)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T18:09:15.140

感谢您的回答。

Cletus，我很欣赏这个大纲，但我不能做出的权衡之一是放弃 DB 的灵活性和与 JDBC/Hibernate 的兼容性，以允许使用所有可用的工具。此外，虽然我没有明确说明这一点，但我不想强迫我的用户采用 [可能昂贵的] 商业解决方案。如果他们有数据库品牌 X，让他们使用它。如果他们不关心，我们推荐开源数据库品牌 Y。基本上，该应用程序有多个面孔，其中一个是传入数据的存储库，但另一个面孔是报告源，我*真的*不想进入撰写报告生成器的业务。

虽然我还没有真正对其进行负载测试，但我对[LucidDB](http://www.luciddb.org/)印象深刻。它是一个面向列的数据库，它提供了良好的查询性能和看似良好的数据压缩。它有一个 JDBC 驱动程序，但据我所知，它还没有 Hibernate 方言。它还支持用户定义的转换，简而言之，我认为这将使我能够无缝地实现将重复和连续值压缩到一个“行”中的想法，但在查询时将它们吹回到多个“合成”行中，所有这些都在无形中完成给查询调用者。最后，它支持外部表的这一漂亮特性，其他支持 JDBC 的数据库表可以放在 LucidDB 中。我认为这对于为其他数据库提供某种程度的支持可能是无价的。

感谢您的指点，Javaman。它把我划分到了 LucidDB 上。

# c++ - 在二进制数据文件的标头中放入什么

> ID：416436
> 
> 赞同：10
> 
> 时间：2009-01-06T13:06:34.907
> 
> 标签：c++, c, binaryfiles

我有一个模拟，可以读取我们创建的大型二进制数据文件（10 到 100 GB）。出于速度原因，我们使用二进制文件。这些文件是系统相关的，是从我们运行的每个系统上的文本文件转换而来的，所以我不关心可移植性。这些文件目前是许多使用 fwrite 编写的 POD 结构实例。

我需要更改结构，因此我想添加一个包含文件版本号的标头，该标头将在结构更改时递增。由于我正在这样做，我还想添加一些其他信息。我在考虑结构的大小、字节顺序，也许还有创建二进制文件的代码的 svn 版本号。还有什么有用的补充吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-06T13:59:16.847

以我的经验，事后猜测你需要的数据总是浪费时间。重要的是以可扩展的方式构建*元数据*。对于 XML 文件，这很简单，但二进制文件需要更多的思考。

我倾向于将元数据存储在文件末尾的结构中，而不是开头。这有两个优点：

*   很容易检测到截断/未终止的文件。
*   元数据页脚通常可以附加到现有文件中，而不会影响其阅读代码。

我使用的最简单的元数据页脚如下所示：

```
struct MetadataFooter{
  char[40] creatorVersion;
  char[40] creatorApplication;
  .. or whatever
} 

struct FileFooter
{
  int64 metadataFooterSize;  // = sizeof(MetadataFooter)
  char[10] magicString;   // a unique identifier for the format: maybe "MYFILEFMT"
}; 
```

在原始数据之后，写入元数据页脚，然后写入文件页脚。

读取文件时，寻找到最后 - sizeof(FileFooter)。阅读页脚，并验证 magicString。然后，根据 metadataFooterSize 回溯，读取元数据。根据文件中包含的页脚大小，您可以使用缺失字段的默认值。

正如[KeithB](https://stackoverflow.com/users/2298/keithb)指出的那样，您甚至可以使用这种技术将元数据存储为 XML 字符串，从而既具有完全可扩展的元数据的优点，又具有二进制数据的紧凑性和速度。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-06T15:22:48.033

对于大型二进制文件，我会认真研究 HDF5（谷歌）。即使它不是您想要采用的东西，它也可能为您在设计自己的格式时指明一些有用的方向。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-06T13:20:42.430

对于大型二进制文件，除了版本号之外，我倾向于添加记录计数和 CRC，原因是大型二进制文件比较小的二进制文件更容易随着时间或在传输过程中被截断和/或损坏。我最近发现 Windows 根本不能很好地处理这个问题，因为我使用资源管理器将大约 2TB 的数百个文件复制到连接的 NAS 设备，并发现每个副本上的 2-3 个文件已损坏（不完全复制）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T13:11:25.180

如果您稍后将其他结构写入二进制文件，则文件类型的标识符将很有用。也许这可能是一个短字符串，因此您可以通过查看文件（通过十六进制编辑器）查看它包含的内容。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-06T16:17:19.453

如果它们那么大，我会在文件开头保留一个健康的空间块（64K？），并将元数据以 XML 格式放在那里，后跟一个文件结尾字符（Ctrl-Z for DOS/ Windows，Unix 的 ctrl-D？）。这样，您就可以使用现有的各种 XML 工具集轻松检查和解析元数据。

否则，我会使用其他人已经说过的内容：文件创建的时间戳，创建它的机器的标识符，基本上是您可以想到的用于诊断目的的任何其他内容。理想情况下，您将包括结构格式本身的定义。如果您经常更改结构，那么维护正确版本的代码以读取各种格式的旧数据文件是一件很痛苦的事情。

正如@highpercomp 所提到的，HDF5 的一大优势是，只要您对名称和数据类型有一些约定，您就不必担心结构格式的变化。结构名称和数据类型都存储在文件本身中，因此您可以将 C 代码炸成碎片，没关系，您仍然可以从 HDF5 文件中检索数据。它让你更少担心数据的*格式*，而更多地担心数据的*结构*，即我不关心字节顺序，这是 HDF5 的问题，但我关心字段名称等。

我喜欢 HDF5 的另一个原因是您可以选择使用压缩，这需要非常短的时间，并且如果数据变化缓慢或几乎相同，除了一些有趣的错误亮点之外，它可以为您带来巨大的存储空间优势。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-06T13:25:08.350

@rstevens 说“文件类型的标识符”......合理的建议。按照惯例，这被称为幻数，在文件中，它不是滥用术语（与代码中的滥用术语不同）。基本上，它是一个数字——通常至少 4 个字节，我通常确保这些字节中至少有一个不是 ASCII——您可以使用它来验证文件是否属于您期望的类型，并且混淆的可能性很小. 您还可以在 /etc/magic（或本地等效项）中编写规则来报告包含您的幻数的文件是您的特殊文件类型。

您应该包含文件格式版本号。但是，我建议不要使用代码的 SVN 编号。当文件格式不变时，您的代码可能会更改。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T13:18:39.393

除了架构版本控制所需的任何信息之外，添加对问题进​​行故障排除时可能有价值的详细信息。例如：

*   文件创建和更新时间的时间戳（如果适用）。
*   构建中的版本字符串（理想情况下，您有一个在每个“官方”构建中自动递增的版本字符串......这与文件架构版本不同）。
*   创建文件的系统名称，以及可能与您的应用相关的其他统计信息

我们发现这非常有用 (a) 获取我们原本必须要求客户提供的信息和 (b) 获取正确的信息 - 令人惊讶的是，有多少客户报告他们正在运行不同版本的软件。数据索赔！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-06T16:03:10.870

您可能会考虑将文件偏移量放在标题中的固定位置，它会告诉您实际数据在文件中的开始位置。这将允许您在需要时更改标题的大小。

在某些情况下，我将值 0x12345678 放入标题中，以便检测文件格式是否与正在处理它的机器的字节序匹配。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-19T06:32:02.923

正如我在电信设备配置和固件升级方面的经验所表明的那样，您实际上只需要几个从版本（标题的固定部分）开始的预定义字节（这很重要）。标题的其余部分是可选的，通过指示正确的版本，您始终可以显示如何处理它。这里重要的是您最好将标题的“可变”部分放在文件末尾。如果您在不修改文件内容本身的情况下计划对标头进行操作。这也简化了应该重新计算可变标题部分的“附加”操作。

很高兴拥有固定大小标题的功能（在开始时）：

*   通用“长度”字段（包括标题）。
*   CRC32 之类的东西（包括标头）。

好的，对于可变部分 XML 或标题中一些相当可扩展的格式是个好主意，但它真的需要吗？我在 ASN 编码方面有很多经验……在大多数情况下，它的使用是过度的。

[好吧，当您查看诸如RFC 2126](https://www.rfc-editor.org/rfc/rfc2126#page-15)（第 4.3 章）中描述的 TPKT 格式之类的内容时，也许您会有更多的理解。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-06T13:12:06.457

如果您在标头中放置版本号，则可以在需要更改 POD 结构或向标头添加新字段时更改该版本。

所以现在不要在标题中添加东西，因为它可能很有趣。您只是在创建必须维护的代码，但没有什么实际价值。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-06T13:51:01.153

对于大文件，您可能想要添加数据定义，这样您的文件格式就可以自我描述了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-19T06:10:41.823

我的变体结合了 Roddy 和 Jason S 的方法。

总而言之 - 将格式化的文本元数据放在文件的末尾，以确定其存储在其他地方的长度。

1）在文件的开头放置一个长度字段，以便您知道最后的元数据长度，而不是假设一个固定长度。这样，要获取元数据，您只需读取该固定长度的初始字段，然后从文件末尾获取元数据 blob。

2) 使用 XML 或 YAML 或 JSON 作为元数据。如果在末尾附加元数据，这将特别有用/安全，因为读取文件的人不会自动认为它都是 XML，因为它以 XML 开头。

这种方法的唯一缺点是当您的元数据增长时，您必须同时更新文件的头部和尾部，但很可能其他部分无论如何都会更新。如果它只是像上次访问日期一样更新琐事，那么元数据长度不会改变，所以它只需要就地更新。

# regex - 正则表达式“包含”另一个正则表达式

> ID：416438
> 
> 赞同：8
> 
> 时间：2009-01-06T13:07:19.540
> 
> 标签：regex

有没有办法测试一个正则表达式是否“包含”另一个正则表达式？
例如：

```
RegEX1 = "a.*b";
RegEx2 = "a1.*b"; 
```

RegEX1“包含”RegEX2。

据我所知 - 这是不可能的，我错了吗？

* * *

好的，joel.neely 已经证明它可以在学术上完成（还没有读过......）。

可以用编程语言来完成，比如 C# 吗？
这会有多有效？测试 1000 对需要多长时间？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T13:20:29.170

是的。

[本文](http://www.w3.org/People/cmsmcq/2005/abdxsp.unicode.html)包含对该主题的详细讨论（参见第 4.4 节）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-10T12:41:52.077

将这两个表达式转换为等效的状态机，并检查两台机器中的所有路径是否允许相同的匹配，应该可以解决问题。显然应该注意抽水问题，因此请避免重新访问旧节点。

它只适用于“简单”的正则表达式（或真实的，你有什么，perls 递归表达式更具表现力）。

虽然状态机图可能有大量路径，但它仍然应该受到限制（尤其是如果表达式的来源是人类）。因此，您将找到 RegEX1 的所有允许路径，并依次检查它们在 RegEX2 中是否允许。如果所有路径都有效，则您会知道一个包含在另一个中。

# php - 使用 API/Function 调用或采用 Cron Job 方法 - 处理事务的调查 - 你将如何处理它？

> ID：416440
> 
> 赞同：1
> 
> 时间：2009-01-06T13:07:51.957
> 
> 标签：php, mysql, process, logic

我正在使用 PHP 和 MySQL 开始一个新项目，大致如下：

每分钟我都会从不同用户的 API 中获得一份待办事项列表。

例子：

```
user1 send $1 to user2
userx send $2 to usera
userw send $0.50 to user2

etc.. 
```

假设 user1 想向 user2 发送 $1。有两种可能，成功或不成功，因为资金不足或用户拼写错误的用户名。如果不成功，我会向用户发送一条消息。

我现在面临几个选择：

**选项1**

创建一个包含需要处理的事务的数据库表，并使用每分钟处理一次的 cronjob。这里的风险是脚本可能会因错误或超时而运行，而其他事务仍会在数据库表中显示 In Progress。所以我需要第二个脚本来检查时间戳。

**选项 2**

创建一个 API 或函数，在我收到它们并给我一个响应后，它会为每个事务调用。然后我可以调用另一个 API 或函数来处理该响应或继续下一个事务。但是，我仍然必须将它们放在数据库表中，因为如果脚本停止执行，我不能冒险丢失它们。所以它的工作原理如下：将所有事务放在数据库表中 - 开始事务 - 完成事务后从表中删除 - 开始事务 2。

* * *

*这两个选项都有缺陷，因为您不知道交易列表会有多长。如果它很长，PHP 绝对不是长时间运行的最佳选择 - 使用将超时设置为零是有风险的。我正在寻找一个可以与 PHP 一起扩展的解决方案。所以我在考虑选项3。*

* * *

**选项 3（最佳解决方案？）**

使用 API 返回 10 个事务。

在数据库中设置一个标志来说明它们被发送到一个脚本和时间戳来说明它们何时被发送

PHP 脚本从 API 检索 10 个事务 - 处理 10 个事务。

一旦事务完成 - 从该表中删除它并将其复制到已完成的事务表中。

如果发送时间大于 X 分钟（基于 10 个事务的执行时间的上限），则每 3 分钟检查一次 cronjob 脚本。如果它更大 - 将它们设置为不发送 - 这样它们就可以再次发送出去。

* * *

正如你所看到的，我写下了我对此的整个思考过程，并正在寻找输入。肯定有我错过的东西。另请注意，这些不是真正的金融交易——这只是我可以用来说明的最好的元数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-09T22:40:26.113

如果您想使用当前技术堆栈的最小差异来做到这一点，那么您就走在了正确的轨道上。本质上，您正在重新创建一个简单的 MQ 或作业服务器。

作业/任务/事务队列所需的最低功能是：

*   工作（用户 1 向用户 2 发送 2 美元）
*   状态（准备好、处理完毕、错误、完成）

你也可能想要

*   最后一个错误字符串（这样你就可以弄清楚到底发生了什么）
*   可能是重试计数（对于应该在失败之前重试的任务，任何可能由于瞬态错误而失败的任务）

如果您决定并行化处理 cron 作业，您将需要跟踪脚本的哪个实例有待处理的作业，尤其是在您开始处理大批量操作时。（如果你这样做，你会想要观察以确保任何给定的事务快速完成，或者你可以有效地将所有工作停在一个缓慢的工作之后）

无论您是从 API 获取还是直接从数据库获取，都是 6 个，6 个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T13:12:39.000

我建议在收到交易请求时处理每笔交易。

IE Bob 单击“汇款”按钮向 Alice 汇款 20 美元。我会调用一个函数来处理此事务，并向他们显示“事务成功”或“出现问题..”消息。

如果事务处理需要很长时间，您可以通过 AJAX 完成，在服务器端完成处理时向他们显示一个很好的进度条，显示“正在处理..”，然后将它们重定向到`yoursite.com/transactions.php?result=success&id=$id`或`yoursite.com/transactions.php?result=failure&id=$id`

# c++ - Symbian C++ - 从 .mbm 文件加载和显示图像

> ID：416451
> 
> 赞同：0
> 
> 时间：2009-01-06T13:11:50.047
> 
> 标签：c++, mobile, symbian, carbide

我有一个 .mbm 文件，我使用 .pkg 文件中的这一行将其复制到我的设备

```
"$(EPOCROOT)epoc32\data\z\resource\apps\MyApp.mbm" -"!:\resource\apps\MyApp.mbm" 
```

然后在我的容器的绘图功能中我这样做..

```
_LIT(KMBMFile , "\\resource\\apps\\MyApp.mbm" );
CFbsBitmap* iBitmap;

iBitmap->Load(KMBMFile, 0);
gc.BitBlt(Rect().iTl, iBitmap); 
```

但是该行`iBitmap->Load(KMBMFile, 0);`引发了 KERN-EXEC:0 PANIC

“当内核无法使用指定的对象索引号（原始句柄号）在当前进程或当前线程的对象索引中找到对象时，就会引发此恐慌。”

谁能发现我哪里出错了？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T14:02:03.453

您正在取消引用未初始化的指针，您也可以使用它：

```
// remember to include the EIK environemnt include file
#include <eikenv.h>

_LIT(KMBMFile , "\\resource\\apps\\MyApp.mbm" );
CFbsBitmap* iBitmap;

iBitmap = iEikonEnv->CreateBitmapL( KMBMFile, 0 );
gc.BitBlt( Rect().iTl, iBitmap ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T13:59:49.667

我已经解决了这个问题，所以会在这里为未来的观众发布答案..

使用这样的片段在您的 MMP 文件中创建一个 MBM 文件

```
START BITMAP    MyApp.mbm
HEADER
TARGETPATH      \resource\apps
SOURCEPATH      ..\gfx
SOURCE          c24 background.bmp
END 
```

**确保您的 .bmp 图像以 32 位格式保存在 Photoshop 或类似文件中**

然后确保您的 MBM 文件在您的 PKG 文件中复制到您的设备

```
"$(EPOCROOT)epoc32\data\z\resource\apps\MyApp.mbm" -"!:\resource\apps\MyApp.mbm" 
```

然后在容器的绘图功能中使用这样的代码..

```
_LIT(KMBMFile , "C:\\RESOURCE\\APPS\\MyApp.mbm" );
CFbsBitmap* iBitmap = new (ELeave) CFbsBitmap;
TInt retval = iBitmap->Load(KMBMFile, 0);
gc.BitBlt(Rect().iTl, iBitmap); 
```

这将在屏幕的左上角绘制您的位图（用于背景图像）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T08:29:49.660

`CCoeControl::Draw()`代码不应该失败，当然也不应该离开（它没有尾随 .. `L`）。在上面的代码片段中，有两个可能会产生错误的调用 -`iBitmap`构造函数和`iBitmap->Load()`. 位图应该是预先分配的，而不是分配的`Draw()`——如果有一个假，就会发生坏事。

此外，按照惯例，只有类成员变量以“i”开头，而`iBitmap`上面不是。

有关详细信息，请参阅[Symbian 编码标准](http://developer.symbian.com/wiki/pages/viewpage.action?pageId=530)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T10:15:22.053

您绝对不应该在 ::Draw 函数中创建 iBitmap，因为它可能会离开。最好在 CoeControl 的 ConstructL 中执行此操作。理论上 ::Load 调用可以在 ::Draw 中处理，因为它可能由于多种原因而失败，并非所有原因都可能是致命的。不过，您可以在创建控件时轻松执行此操作，因此最好考虑一下。我会说，如果控件基本上只是为了包含位图，那么您应该在 ConstructL 中进行操作。如果控件做了很多事情，那么您可能希望在 ::Draw 中处理它。

# .net - 使用列表的最佳方式 在键/值集合中？

> ID：416454
> 
> 赞同：2
> 
> 时间：2009-01-06T13:12:39.637
> 
> 标签：.net, .net-3.5, collections, dictionary

在键/值情况下保持集合对象（例如列表）的最佳方法是什么，其中键是 ID，值是 T 类型的集合？

这是唯一的选择还是.NET 3.5 中有更好的解决方案/另一个集合？

```
var x = new Dictionary<int, List<type>>(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T13:59:35.783

这是一个很好的解决方案，并且效果很好 - 您正在有效地使用 { key = int, value = 4 byte reference } 的字典对象。

当您通过键检索值时，您将取回`List<T>`对堆上的引用并能够使用它。对于您的明显问题，这将是一个非常有效且紧凑的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T13:38:49.100

我不知道这是否是你需要的，但我会尽力而为。

```
public Dictionary<int,List<T>> myFunction<T>()
{
    var returnvalue = new Dictionary<int,List<T>>();
    //Do some stuff with the collection.
    return returnvalue;
} 
```

然后你可以打电话

```
public void Main()
{
  var functionreturn = myFunction<String>();
} 
```

我不确定这是否会对您有所帮助，但它可能会帮助您改写您的问题。

注意：以上是空气代码，未经测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T13:55:09.833

我认为框架内没有任何内容，但我认为 PowerCollections 库中有一个 MultiDictionary 集合。你可以试试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T13:58:04.787

我认为您可能应该根据需要编写包装类。我的意思是，如果您需要存储预制列表的字典，`Dictionary<int, List<type>>`只要它只是一个私有属性就可以了。您不应该公开公开它，因为显然它会公开太多信息，并且`IDictionary<int, IList<T>>`由于缺乏协方差，您不能将其转换为或类似的东西。

你最好的选择是这样的：

```
class MyWrapper<T>()
{
    private Dictionary<int, List<T>> dictionary { get; set; }
    public MyWrapper() { dictionary = new Dictionary<int, List<T>>(); }

    // Adds a new item to the collection
    public void Add(int key, T item)
    {
       List<T> list = null;
       if (!dictionary.TryGetValue(key, out list))
       {
          // If dictionary does not contain the key, we need to create a new list
          list = new List<T>();
          dictionary.Add(key, list);
       }
       list.Add(item);
    }

    public IEnumerable<T> this[int key]     
    {
       get
       {
           List<T> list = null;
           // We just return an empty list if the key is not found
           if (!dictionary.TryGetValue(key, out list)) return new List<T>();
           else return list;
       }
    }
} 
```

显然，您的需求可能会有所不同，您可能需要实现几个接口等，但这是一般的想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T14:10:55.980

如果你的 ID 是你的类型的成员，你可以考虑实现一个[`System.Collections.ObjectModel.KeyedCollection<TKey, TItem>`](http://msdn.microsoft.com/en-us/library/ms132438.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T14:31:31.820

您是否正在寻找一个多值字典，即一个键控集合，其中每个键可以有多个值？[PowerCollections](http://www.codeplex.com/PowerCollections)有这样一个 MultiDictionary。

# .net - VB.NET- 测试空字符串时的性能

> ID：416456
> 
> 赞同：3
> 
> 时间：2009-01-06T13:12:59.077
> 
> 标签：.net, vb.net, string, vb6

在 VB6 中，有人告诉我，在测试空字符串时，通过使用以下方法验证字符串的长度来检查它会快得多：

```
If Len("ABC") = 0 then 'fast 
```

或者

```
If LenB("ABC") = 0 then 'even faster 
```

代替：

```
If "ABC" = "" then 'slower 
```

您是否有机会知道这在 VB.NET 中是否也是如此？谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T13:21:05.907

我不完全是 VB 的语法，但在 C# 中你可以使用 String 静态方法`IsNullOrEmpty`：

```
String.IsNullOrEmpty("ABC") 
```

当您调试此方法时，它会检查参数的 .Length。检查长度总是更快，因为在字符串比较时，编译器必须创建一个新对象进行比较（在本例中为“ABC”字符串）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T13:56:59.033

没必要不，我的意思是你在开玩笑吗？有多少人编写程序来比较一个字符串以查看它是否为零长度对性能有任何影响。即使字符串没有保留长度计数并且 VB 每次都进行 c 样式的 strcmp() 字符串比较，字符串比较函数也不需要很长时间才能确定其中一个字符串的长度为零，对吗？但是 .NET 字符串确实包含一个长度字段，因此当您进行字符串比较时，首先要检查的是长度是否不同，即直接 int 比较。如果是函数调用，并且只有在 JIT 内联 Len() 时，您自己执行此操作即可节省所有费用。

顺便说一句，在 VB.NET 中，您不需要调用 String.IsNullOrEmpty()，因为字符串之间的比较被转换为对 String.strcmp() 的调用，它将空值（VB 中的无）转换为对 String.EmptyString 的引用。然后它继续调用 Reflector 无法检查的本机函数，但我很确定它所做的第一件事是检查字符串的长度是否不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T13:18:07.350

你应该使用：

```
If ("Value").Length > 0 Then

End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-05T14:04:03.030

我认为等效于 IsNullOrEmpty 的 VB6 的最佳解决方案是

```
Public Function IsNullOrEmpty(ByRef s As Variant) As Boolean

  If IsNull(s) Then ' IsNull returns true if s is a Variant that is Null
    IsNullOrEmpty = True ' IsNull returns false if s is a Variant and s = vbEmpty
    Exit Function
  End If

  If LenB(s) = 0 Then ' never compare a string to "" - it's slow
    IsNullOrEmpty = True
    Exit Function
  End If

  If LenB(Trim(s)) = 0 Then
    IsNullOrEmpty = True
    Exit Function
  End If

  IsNullOrEmpty = False

End Function 
```

具有讽刺意味的是，如果您有设置为 vbEmpty 的字符串或变体，则此函数将返回 false，因为作为字符串的 vbEmpty 为“0”。因此，如果您不小心使用此版本，您可能会遇到一些奇怪的错误。

# wcf - WCF 合同返回接口可能导致序列化问题？

> ID：416457
> 
> 赞同：7
> 
> 时间：2009-01-06T13:13:09.887
> 
> 标签：wcf, serialization, interface

我正在尝试定义一个返回接口的 WCF 合同，如下所示：

```
[ServiceContract]
public interface IMyContracts
{
    [OperationContract]
    IMyInterface GetData(string request);
} 
```

为了让它工作，我认为我的接口（`IMyInterface`）必须实现`ISerializable`以确保实现我的接口的类可以被序列化。这意味着我必须为任何实现我的接口的类手动实现序列化。

如果使用不可序列化的类，我似乎要么使用我的接口并冒运行时错误的风险，要么我实现了接口`ISerializable`并有手动实现的相关麻烦。

我是否让自己感到困惑并遗漏了一些明显的东西？其他人如何使用 WCF 返回接口并避免此问题？

非常感谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T19:13:20.160

AFAIK，问题不在于序列化，而在于您返回抽象实体（一个接口）这一事实。抽象是一个 OO 概念，而不是 SOA 概念。因此，您的客户端的 wcf 堆栈可能不知道如何处理接口后面的类。如果客户端不知道接口背后的类怎么办。客户端的 WCF 堆栈必须反序列化它，并且要做到这一点，它必须知道类。

因此，您必须通过[KnownTypeAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.knowntypeattribute.aspx)将类作为合约的接口部分。

您也可以使用看起来更灵活的[ServiceKnownTypeAttribute类。](http://msdn.microsoft.com/en-us/library/system.servicemodel.serviceknowntypeattribute.aspx)不过，请记住客户端必须知道类型，否则您将得到异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-02T04:13:46.023

在这篇文章中，我将详细介绍如何使 WCF 用于接收和返回派生类和接口。

[http://codeonaboat.wordpress.com/2010/03/01/serializing-and-deserializing-derived-types-or-interfaces-in-wcf/](http://codeonaboat.wordpress.com/2010/03/01/serializing-and-deserializing-derived-types-or-interfaces-in-wcf/)

# c++ - 如果达到结束条件，是否可以在 C++ 中退出 for before time？

> ID：416464
> 
> 赞同：7
> 
> 时间：2009-01-06T13:16:00.537
> 
> 标签：c++, loops, label, nested-loops

我想知道当验证结束条件（不同于达到的正确迭代次数）时，是否可以在 C++ 中结束 for 循环。例如：

```
for (int i = 0; i < maxi; ++i)
    for (int j = 0; j < maxj; ++j)
        // But if i == 4 < maxi AND j == 3 < maxj, 
        // then jump out of the two nested loops. 
```

我知道这在 Perl 中是可能的，下一个 LABEL 或最后一个 LABEL 调用和标记的块，是否可以在 C++ 中做到这一点，或者我应该使用 while 循环？

谢谢你。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-01-06T13:33:03.527

您可以使用`return`关键字：将嵌套循环移动到子例程中，调用子例程以运行嵌套循环，并从子例程中“返回”以退出 [所有] 循环。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-01-06T13:45:19.213

尽管存在“`goto`被认为有害”的论点，但这似乎是`goto`. 这基本上就是您在 Perl 中所做的事情。说真的......考虑替代方案：

**额外的状态变量**

* * *

```
for (int i=0; i<maxi; ++i) {
    bool leaveLoop = false;
    for (int j=0; j<maxj; ++j) {
        if (i == 4 && j == 3) {
            leaveLoop = true;
            break; // leave the inner loop
        }
    }
    if (leaveLoop) {
        break; // leave the outside loop
    }
} 
```

**例外离开**

* * *

```
try {
    for (int i=0; i<maxi; ++i) {
        for (int j=0; j<maxj; ++j) {
            if (i == 4 && j == 3) {
                throw leave_loop();
            }
        }
    }
} catch (leave_loop const&) {
} 
```

**复杂逻辑**

* * *

```
int j = 0;
for (int i=0; i<maxi && !(i==4 && j==3); ++i) {
    for (j=0; j<maxj && !(i==4 && j==3); ++j) {
        // inner loop
    }
} 
```

**`goto`**

* * *

```
for (int i=0; i<maxi; ++i) {
    for (int j=0; j<maxj; ++j) {
        if (i==4 && j==3) {
            goto leave_loop;
        }
    }
}
leave_loop: 
```

最后一个不是很清楚吗？我不相信它是。是不是更脆弱了？恕我直言，与版本相比，其他版本非常容易出错且脆弱`goto`。很抱歉站在肥皂盒上，但这件事困扰了我一段时间；）

唯一需要注意的是，`goto`例外情况非常相似。他们都打开了泄漏资源的机会，并且小心对待他们。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-06T13:31:56.340

让我尽可能强调（但礼貌 ;-）这样说：类 c 语言中**的`for`构造与计数无关。**

确定是否继续的测试表达式可以是与循环目的相关的任何内容；更新表达式不必是“向计数器加一”。

```
for (int i = 0, j = 0; i < maxi && j < maxj && i != 4 && j != 3;) {
    if (j < maxj) {
        ++j;
    } else {
        j = 0;
        ++i;
    }
} 
```

将是一种（相当随意的）重写方式。

关键是，如果建立某些条件是交互的重点，通常可以编写一个循环（使用`while`or `for`）以更明确地说明继续/终止条件的方式。

（如果您可以发布实际发生的事情的描述，它可能会写出看起来不像上面那样随意的东西。）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-06T13:22:23.580

你不能用一条 break 指令跳出**两个**循环，但你可以使用 goto 从外面的内循环跳出。

如果 goto 是本地化的，并且意味着逻辑比其他情况少，我认为这是完全可以接受的代码。拥有额外的标志变量，或者将迭代器变量提升到内部循环之外，以便您可以在外部循环中比较它并不能更容易理解代码恕我直言。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-06T13:48:07.367

从上面的所有建议中，我会避​​免使用 try/catch 机制，因为应该为异常情况保留异常，而不是正常的控制流。

如果您可以适当地创建第二个条件，则可以使用两个中断。为此目的使用布尔值也很好，您甚至可以将其连接到每个 for 循环的条件中。例如：

```
bool exit_loops = false;
for (int a = 0; a < A && !exit_loops; ++a)
{
    for (int b = 0; b < B && !exit_loops; ++b)
    {
        if (some_condition) exit_loops = true;
    }
} 
```

虽然如果您使用两个以上的循环，将它们包装在一个函数中并使用 return 退出函数（以及所有循环）可能更合适。然后，您可以再次以一种可以消除除一个循环之外的所有循环的方式重构代码，例如通过调用函数来执行内部循环代码等。

最后不要害怕在这种情况下使用 goto，通常 goto 是糟糕的非结构化编程，但在某些情况下（像这样）它们非常有用。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-06T13:25:17.287

在 C/C++ 中你不能像这样跳出来：

```
for (...)
{
  for (...)
  {
    // from here...
  }
}
// ...to here 
```

不使用 goto。你需要一个像这样的结构：

```
for (...)
{
  bool
    exit = false;

  for (...)
  {
    if (do_exit)
    {
      exit = true; // or set outer loop counter to end value
      break;
    }
  }
  if (exit)
  {
    break;
  }
} 
```

或者，使用 throw 和 catch - 但这不是很好，因为 throw 真的应该用于异常而不是流控制。

一个干净的方法是使内循环成为一个函数：

```
bool F ()
{
  if inner loop terminates, return false else return true
}

void G ()
{
  for (...)
  {
    if (!F ())
    {
      break;
    }
  }
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-06T13:47:34.450

```
bool done = false;

for (int i = 0; i < maxi && !done; ++i)
    for (int j = 0; j < maxj && !done; ++j)
        if (i == 4 && i < maxi && j == 3 && j < maxj )
             done = true;
        else {
        } 
```

或者你可以直接去。或不 ：-）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-06T13:22:36.543

```
for (int i = 0; i < maxi; ++i)
{
    int j = 0;
    for (j = 0; j < maxj; ++j)
    {
         if (i == 4 && j == 3) // i < maxi and j < maxj otherwise we would not be here
             break; // exit inner loop
    }
    if (i == 4 && j == 3) // i < maxi and j < maxj otherwise we would not be here
        break; // exit outer loop
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-06T13:22:58.837

您可以使用[goto statement](http://msdn.microsoft.com/en-us/library/b34dt9cd(VS.80).aspx)，但这通常被认为是一种不好的做法。

你的另一个选择是做这样的事情

```
int i;
int j = 0;
for (i = 0; i < maxi && !(i==4 && j==3); ++i)
    for (j = 0; j < maxj && !(i==4 && j==3); ++j) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-06T15:11:43.470

阅读代码不应该像阅读侦探书（总是需要弄清楚）......

一个例子：

爪哇：

```
iterate_rows:
for (int i = 0; i < maxi; ++i)
{       
    for (int j = 0; j < maxj; ++j)
    {
        if (i == 4 < maxi && j == 3 < maxj) 
            break iterate_rows;
        else
            continue iterate_rows;
    }   
} 
```

您无需弄清楚 break iterate_rows 做了什么，您只需阅读即可。

C++：

```
//iterate_rows:
for (int i = 0; i < maxi; ++i)
{
    for (int j = 0; j < maxj; ++j)
    {
        if (i == 4 < maxi && j == 3 < maxj) 
            goto break_iterate_rows;
        else
            goto continue_iterate_rows;
    }

continue_iterate_rows:;
}
break_iterate_rows:; 
```

***goto break_iterate_rows***只是**break iterate_rows的****可见**版本

 **如果您将 goto 和标签的使用仅限于此类代码，您将无法弄清楚其意图。限制在这种代码上使用 goto 和标签将使您只阅读代码，而不是分析或弄清楚它。你不会被指责为邪恶的程序员。

如果你真的在这种代码中限制你的 goto，你将能够养成不需要弄清楚那些该死的 goto 在你的代码中做了什么的习惯。额外的好处是您不必引入布尔值并跟踪它们（恕我直言，这会导致您**检测代码**，使其有点不可读，这违背了避免 goto 的目的）

附言

将这些标签与注释配对（在循环之前），当您阅读这些带有 goto 语句的行时，您已经知道这些 goto 的意图

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-06T13:20:53.663

您可以使用标签，类似于：

```
Outer:
for(...)
{
    Inner:
    for(...)
    {
    if(condition)
        {
        goto End;
        }
    }
}
End: 
```

在Java中你可以传递标签来打破我认为？

编辑 - 将 goto 更改为 End 而不是 Outer，但我不认为负面代表是合理的。这个答案提供了最简单的方法。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-06T13:31:44.310

我有几个建议：

1.  throw .... 将两个循环放在“try {}”中，然后根据条件“捕获”“throw”。

2.  将两个循环放在一个方法中并返回条件。

3.  Goto 并不邪恶，人们也使用它......您可以使用“goto”它可以是最清晰的代码，尤其是在处理错误时。我已经 20 年没用过一台了。

托尼

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-06T14:02:59.507

我一直试图远离`goto`陈述（出于某种原因，它在学校和我的工作中总是被看不起）。我会使用类似 Daemin 建议的东西。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-06T18:36:58.877

完全重新考虑该构造的另一个原因`for`是它的作用域阻止了循环终止后对受控变量的访问。由于各种原因（例如，区分搜索中的成功与失败），循环中被变异的变量的值可能很有用，否则将需要额外的变量来在范围退出后保留该信息。`a`这是一个小例子，它搜索一个以值命名的方形数组`target`（假设它`SIZE`是非零的，否则不需要搜索！）：

```
int i = 0;
int j = 0;
while (i < SIZE && a[i][j] != target) { // still in array but not at target
    if (SIZE <= ++j) {                  // fallen off the end of a row
        j = 0;
        ++i;
    }
} 
```

随后的代码可以`i < SIZE`用来确定是否找到了所需的值。

上述的另一个优点是灵活性。假设我们现在被告知行中的值`a`是升序的，因此如果遇到大于 的值，则行的其余部分无关紧要`target`。很容易准确地知道要进行哪些更改以及在哪里进行更改。因为新信息允许我们放弃当前行，所以只有内部决策受到影响，变为：

```
 if (target < a[i][j] || SIZE <= ++j) { // can't be in row or fallen off end
    ... 
```

我看到更多的新语言（尤其是面向功能的语言）放弃了旧的“计数”循环结构；这可能是一件好事，因为它鼓励我们思考循环的*含义*，而不是简单地计数。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-06T19:26:56.887

[我见过的最好的方法](http://www.perlmonks.org/?node_id=126056)涉及宏和 goto，但它实际上非常好（链接到帖子的开头是谈论 Perl，但最后一段左右介绍了宏）。

它允许您编写如下代码：

```
named (LOOPS) for (i=1; i<10; i++) {
    for (j=1; j<10; j++) {
        for (j=1; j<10; j++) {
            /* Process data[i][j][k] here */
            if (data[i][j][k] < threshold) break(LOOPS);
        }
    }
} 
```

# .net - 使用 Assembly.LoadFrom 和 Assembly.Load 混合加载程序集时的奇怪行为

> ID：416468
> 
> 赞同：5
> 
> 时间：2009-01-06T13:17:28.847
> 
> 标签：.net, assemblies, assembly.load

`Assembly.LoadFrom`使用和混合加载程序集时的奇怪行为`Assembly.Load`：

`Assembly.LoadFrom`我在加载程序集时遇到了一个奇怪的行为`Assembly.Load`。我正在使用 加载程序集`Assembly.LoadFrom`，其中程序集位于一个文件夹中，该文件夹不是执行文件夹。

稍后在我的测试代码中，当我尝试使用 再次加载此程序集时`Assembly.Load`，尽管程序集已加载，但加载失败并显示`System.IO.FileNotFoundException`（“无法加载文件或程序集...”）。使用强名称和非强名称加载都失败（再次加载此程序集的最初原因是使用 a `BinaryFormatter`）。

但是，如果程序集位于执行文件夹中，则以后的加载在两种情况下都会成功，使用强名称和非强名称。在这种情况下，您可以看到从两个不同的位置加载了两个相同的程序集。

重现此问题的简单代码示例：

```
Assembly assembly1 = Assembly.LoadFrom(@"C:\a.dll");

// Loading with a strong-name fails
Assembly assembly2 = Assembly.Load(@"a, Version=1.0.0.0, Culture=neutral, PublicKeyToken=14986c3f172d1c2c");

// Also loading with a non-strong fails
Assembly assembly3 = Assembly.Load(@"a"); 
```

1.  任何解释为什么 CLR 忽略已加载的程序集？
2.  知道如何缓解这个问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T13:20:03.447

这并不奇怪。根据文档，使用 Load 和 LoadFrom 加载会将程序集放置在不同的上下文中。[这](http://blogs.msdn.com/suzcook/archive/2003/09/19/loadfile-vs-loadfrom.aspx)可能会有所帮助。

> 1.  任何解释为什么 CLR 忽略已加载的程序集？

因为他们所处的环境不同。

> 2.  知道如何缓解这个问题吗？

从同一上下文加载，或帮助 CLR 找到程序集，可能通过将处理程序附加到`AppDomain.AssemblyResolve`.

**选择**

如果您从中加载程序集的位置是 AppDomain.BaseDirectory 下的子文件夹，您可以简单地在 App.config 中添加一个条目：

```
<configuration>
   <runtime>
      <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
         <probing privatePath="bin;bin2\subbin;bin3"/>
      </assemblyBinding>
   </runtime>
</configuration> 
```

[http://msdn.microsoft.com/en-us/library/823z9h8w.aspx](http://msdn.microsoft.com/en-us/library/823z9h8w.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-06T14:06:09.513

@Kent Boogart：这似乎是正确的解释。对于完整的解释，Suzanne Cook 有这篇博客文章，它比你发布的原始文章更详细一点：http: [//blogs.msdn.com/suzcook/archive/2003/05/29/57143.aspx](http://blogs.msdn.com/suzcook/archive/2003/05/29/57143.aspx)

以下是利用 AppDomain.AssemblyResolve 的代码 -

```
 // register to listen to all assembly resolving attempts:
 AppDomain currentDomain = AppDomain.CurrentDomain;
 currentDomain.AssemblyResolve += new ResolveEventHandler(MyResolveEventHandler);

 // Check whether the desired assembly is already loaded
 private static Assembly MyResolveEventHandler(object sender, ResolveEventArgs args) {
    Assembly[] assemblies = AppDomain.CurrentDomain.GetAssemblies();
    foreach (Assembly assembly in assemblies) {
       AssemblyName assemblyName = assembly.GetName();
       string desiredAssmebly = args.Name;
       if (assemblyName.FullName == desiredAssmebly) {
           return assembly;
       }
    }

    // Failed to find the desired assembly
    return null;
 } 
```

# c# - 合并与空字符串连接

> ID：416473
> 
> 赞同：8
> 
> 时间：2009-01-06T13:18:52.807
> 
> 标签：c#, string, concatenation, coalesce

我的同事是 C# 新手，不知道 coalesce 运算符。于是，我看到他写了这样一行代码：

```
string foo = "" + str; 
```

这个想法是如果 str 为空，这个表达式将返回一个空字符串。当然，也可以改写成这样：

```
string foo = str ?? ""; 
```

而且我觉得这将更具可读性。但这真的有那么大吗？可读性的好处是否足以建议返回并使这些行看起来像第二行？或者这是我应该学会放手的事情之一（前提是我的同事受过教育，了解未来做这件事的最佳方式）？

**编辑**：请注意，我很欣赏效率评论，但这并没有真正用于任何性能至关重要的情况。因此，虽然这些信息很有趣，但不一定是我认为重要的信息。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T13:24:13.437

IMO，最好明确定义这样的逻辑，即不要使用字符串连接来避免空字符串并使用条件语句或？？操作员。

关于其他评论：

> 使用 null-coalescing 运算符还有一个性能优势，因为不需要进行连接（因此，不会不必要地创建额外的字符串实例）

不对。C# 编译器将 "" + string2 编译为与 string1 100% 相同的代码？？“”。此外，C# 编译器将 + 运算符转换为调用 string.Concat 方法，该方法又使用 string.IsNullOrEmpty 函数检查参数，并且在这种情况下不分配新字符串。

> 另外我建议使用 String.Empty 而不是 "" 因为它是一个常量并且不需要创建新的 String

.NET 框架支持[字符串实习](http://en.wikipedia.org/wiki/String_intern_pool)，因此 "" 和 string.Empty 指向同一个内存区域

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T13:27:32.807

我个人认为没有一个比另一个更具可读性。我更喜欢这个：

```
string foo = str ?? ""; 
```

只是因为我真的很喜欢？？操作员。

如果您是新手，我认为这会更容易理解：

```
string foo = str == null ? "" : str; 
```

或者

```
string foo = "";
if (str != null) foo = str; 
```

但是，您需要问自己：“您真的想变得多简单？”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T13:31:43.360

虽然从技术角度来看我更喜欢第二行，但第一行实际上对我来说更具可读性......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T13:25:11.157

我更喜欢你的第二个例子而不是第一个例子，因为它更积极地反对`str`为空并且更具表现力。 ~~此外，我建议使用`String.Empty`over `""`，因为它是一个常数，不需要创建一个新的`String`（是的，这是一个极端的挑剔，但需要注意）。~~

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T13:25:26.663

第二行对我来说看起来更具可读性，它清楚地表明了右侧表达式的意图。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T20:34:38.013

我会使用合并运算符或`foo = str == null ? "" : str;`出于两个原因：

1.  第一个示例在其他花括号语言（尤其是 Java 和 JavaScript）中没有相同的行为，其中将空引用附加到空字符串会生成包含 text 的字符串`null`。因此，第一个示例需要更多的脑力劳动来确保它会在所编写的语言中产生正确的行为。即使给出其他线索，它是 C#（例如小写类型`string`），任何需要开发人员放慢速度并思考“这段代码的意图是什么”的东西都会导致生产力下降。当从一种语言转移到另一种语言时，它还可能引入错误。

2.  第二个示例更清楚地表达了代码的*意图*，如原始问题中所述：

    `when str is null set foo to an empty string`

    与第一个示例相反，可以将其解读为：

    `set foo to an empty string with str appended (which may have the side effect of setting foo to an empty string when str is null)`

作为程序员，我们可能应该尝试表达代码的*意图*，而不是依赖其他操作的副作用来给我们想要的结果。

# salesforce - 在客户详细信息页面 (Salesforce) 上自定义自定义对象面板

> ID：416474
> 
> 赞同：1
> 
> 时间：2009-01-06T13:18:58.050
> 
> 标签：salesforce, apex-code

我创建了一个自定义对象，我让它自动出现在帐户详细信息页面上（想想报价示例）。

但是报价只有一个名称列，我如何让它显示其他字段？很像帐户面板上的机会面板。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T14:24:58.417

好的，真的很简单，这就是方法。

转到->自定义->帐户->页面布局

选择页面布局。

动作“编辑”

这会显示页面上的面板列表...向下滚动...

您会看到一个名为“相关列表部分”的部分

这些是我最初指的面板。

点击“列表？” 你想添加字段。（应该选蓝色）

点击“编辑属性”

等待对话博客..将要显示的字段添加到右侧。

保存...并保存更改的布局。

完毕...

希望有一天这可以帮助某人。

# .net - 选择一个 .Net Inversion of Control 容器作为依赖注入的第一次尝试

> ID：416475
> 
> 赞同：0
> 
> 时间：2009-01-06T13:18:58.503
> 
> 标签：.net, dependency-injection, inversion-of-control

哪个 IoC 容器最容易上手。这可能等同于哪些文档拥有最友好的文档。不太担心功能的数量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T14:30:35.487

看看 James Kovacs 的 DotNetRocks 插曲：http: [//www.dotnetrocks.com/default.aspx? showNum=362](http://www.dotnetrocks.com/default.aspx?showNum=362)

还有这个 DNRTV，他在其中推出了自己的 IoC： [http ://www.dnrtv.com/default.aspx?showID=126](http://www.dnrtv.com/default.aspx?showID=126)

基思

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T13:39:36.540

最简单的方法很大程度上取决于“你来自哪里”。但是，如果您熟悉 .Net 3.5 功能，例如 lambda 和扩展方法，我是 Autofac 的忠实粉丝。Autofac 大量使用 lambdas 和扩展方法来注册组件，而不是使用 xml 文件。这增加了您具有完全类型安全性并且在注册时获得智能的好处。它也是我喜欢的一个非常轻量级的容器。

Autofac 托管在 Google 代码 ( [http://code.google.com/p/autofac/](http://code.google.com/p/autofac/) ) 上，并且有一个非常好的带有文档的 Wiki。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T13:20:49.840

我将从[智能客户端软件工厂](http://msdn.microsoft.com/en-us/library/aa480482.aspx)或[Unity开始](http://msdn.microsoft.com/en-us/library/cc468366.aspx)

它们包括大量样本，以及 SCSF，包括一些其他的设计模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T13:26:28.377

我喜欢温莎城堡，在这里你可以找到一篇三部分的文章，描述你需要开始的一切。 [http://dotnetslackers.com/articles/designpatterns/InversionOfControlAndDependencyInjectionWithCastleWindsorContainerPart1.aspx](http://dotnetslackers.com/articles/designpatterns/InversionOfControlAndDependencyInjectionWithCastleWindsorContainerPart1.aspx)

StructureMap 和 Unity 也有很好的文档记录。BTW 请记住，几乎所有容器都以相同的方式工作，因此从一个容器传递到另一个容器非常简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T13:48:15.090

您想了解 IoC 吗？

如果是这样，我推荐[Oren Eini 的 15 行 IOC，](http://ayende.com/Blog/archive/2007/10/20/Building-an-IoC-container-in-15-lines-of-code.aspx)因为没有什么比一个带有完整源代码的非常简单的示例更能帮助您更快地学习的了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T13:51:52.850

我会推荐结构图。

非常容易设置并帮助您入门。

[http://structuremap.sourceforge.net/Default.htm](http://structuremap.sourceforge.net/Default.htm)

# wpf - 持久化数据绑定 WPF ObservableCollection 的首选方法？

> ID：416481
> 
> 赞同：3
> 
> 时间：2009-01-06T13:20:16.893
> 
> 标签：wpf, data-binding, persistence, save, observablecollection

我有一个继承自 ObservableCollection(Of MyObject) 的类，并且 MyObject 类按应有的方式处理 INotifyPropertyChanged。当用户通过绑定控件更新此数据时，集合将按预期更改。

我在表单上有一个“保存”按钮，旨在通过在每个项目上调用 MyObject.Save 将此集合作为 XML 保存到磁盘。这个逻辑是我写的。

我的问题是，这是持久化对象的首选方式，还是我缺少一个属性或接口来告诉 WPF 数据绑定/.Net 框架使用哪种方法来保存/加载数据？

我问是因为我看到的 WPF 示例省略了真实数据的保存和加载，所以我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T14:25:48.010

我不希望 WPF 提供任何超出 .Net 核心提供的数据加载/保存功能，例如标准序列化机制。

如果符合您的需求，您当前的方法似乎很好。

# sql-server-2005 - 使用 IMAP 将邮件附件提取到 SQL Server 2005

> ID：416490
> 
> 赞同：0
> 
> 时间：2009-01-06T13:21:57.857
> 
> 标签：sql-server-2005, ssis, imap

我需要从 Exchange 邮件服务器上的电子邮件数据源将数据导入我的 SQL Server 2005。这意味着当邮件被发送到特定的邮件地址时，我必须检索邮件主题和附件，然后我必须使用 IMAP 将这些数据导入我的 SQL Server 2005。

我可以使用 SSIS 执行此操作，还是必须用 C# 编写 Windows 服务？

我需要使用某种 IMAP API 库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T11:47:04.647

如果有人感兴趣：我自己使用包含在 Windows 服务中的开源 IMAP 库解决了这个问题。反正我没有使用 SSIS，因为 SQL Server 2005 中的 SSIS 不支持 IMAP 接口。

开源 IMAP 库称为“Koolwired.IMAP”。

以下是我发现有用的一些链接：

[http://koolwired.com/solutions/solutions.aspx?id=30](http://koolwired.com/solutions/solutions.aspx?id=30)

[http://sourceforge.net/projects/imapnet/](http://sourceforge.net/projects/imapnet/)

[http://www.codeplex.com/imapnet/Thread/List.aspx](http://www.codeplex.com/imapnet/Thread/List.aspx)

[http://www.imap.org/](http://www.imap.org/)

# java - 字符串比较：单独比较与附加字符串比较

> ID：416500
> 
> 赞同：2
> 
> 时间：2009-01-06T13:24:29.800
> 
> 标签：java, string, comparison

我有六个字符串变量，比如 str11、str12、str13、str21、str21 和 str23。

我需要比较这些变量的组合。

我必须检查的组合是 str11 -- str12 -- str13 作为一组，str21 -- str22 -- str23 作为另一组。我必须比较这两组。

现在我很困惑我应该使用哪种方法进行比较？

我可以附加相同组的字符串并进行比较，这只是一个比较说`( str11 append str12 append str13 ) eqauls ( str21 append str22 append str23 )`

或者

我应该进行个人 3 比较吗？

```
if( str11 equals str21 ) {

    if( str12 equals str22 ) {

        if( str13 equals str23 ) {

        }

    }

} 
```

当我进行字符串比较时，由于字符串长度而使我付出代价的性能因素是什么？让我们假设所有字符串的长度相同（大约）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T13:35:32.523

我会单独测试。

“AB”“CD”“EF”是否等于“ABC”“DE”“F”？

我认为没有。

PS如果是，那么这是一个非常特殊的情况，如果您决定以这种方式编码（作为串联比较），那么请注释掉它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-06T13:31:57.650

绝对没有必要将比较分成三个 if 语句。您也可以简单地对您的比较进行 AND，例如

```
if (  str11 equals str21
   && str12 equals str22
   && str13 equals str23) ... 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T16:51:15.483

您的变量名称表示主要的代码异味。听起来您应该有两个数组，而不是六个变量，每个数组包含三个字符串。换句话说，最初这样的事情会好得多：

```
String[][] strs = new String[2][3];
strs[0][0] = str11;
strs[0][1] = str12;
...
```

有可能根据您从哪里获得六个字符串，您不需要在比较之前立即手动执行此操作，但可能会以更友好的格式传递您的参数。

如果您确实希望通过比较字符串对象的数组来做到这一点，并且您使用的是 Java 1.5 或更高版本，请记住您可以访问 java.util.Arrays.equals() 方法来实现数组相等。尽可能多地使用库方法是避免重新发明轮子的额外工作和可能的实现错误的好方法（例如，到目前为止，两个提交的实现都有错误）。

您采取的确切路线可能取决于您正在编写的域 - 如果您的特定问题需要您始终比较 3 元组，那么编写代码来显式比较三个字符串的组并不是一个好主意，因为它会可能比比较任意长度数组的代码更容易理解。（如果你要走这条路，那么无论如何我们都是一个带有 && 条件的 if() 条件而不是嵌套的 if 块，正如 Adam Bellaire 所演示的那样）。

不过，一般来说，如果您将其设置为使用任意长度的数组，您将拥有一个更可重用的代码块。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T13:34:13.977

将字符串附加在一起并进行比较将不起作用。例如，字符串 1 和 2 可以为空，字符串 3 可以包含“gorps”，而字符串 4 包含“gorps”，而字符串 5 和 6 为空。附加结果的比较将返回 true，尽管这将是误报。你必须想出一个你保证不会包含在任何字符串中的分隔符才能让它工作，这可能会变得混乱。

我会按照您的方式进行比较。它易于阅读且简单明了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T14:11:47.723

对一个大 char[] 的迭代可能比对 n 个总长度相等的单独字符串的迭代更快。这是因为数据非常本地化，CPU 很容易预取数据。

但是，当您在 Java 中连接多个字符串时，您将使用 StringBuilder/Buffer，然后在某些情况下将 i 转换回字符串。由于 SB.append() 的工作方式和 Java String 是不可变的，这将导致内存分配增加，这反过来又会造成内存瓶颈并显着降低应用程序的速度。

我建议保持字符串不变并进行单独比较。由于较长的 char[] 所带来的性能提升很可能远低于您在较高分配率下可能遇到的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-13T16:22:56.497

恕我直言：我认为您的代码和问题不仅有点味道，而且几乎很臭（这里是大笑脸）。

1）变量名称表明实际上有字符串向量；如前所述
2) 个人比较与级联比较的问题引发了如何定义字符串元组相等性的问题；也已经提到了。

但最让我印象深刻的是：

3）对我来说，这看起来像是“过早优化”的典型案例，并且在错误的地方计算 CPU 周期。

如果您真的关心性能，请忘记 3 个人比较与单个比较的成本。反而：

创建两个连接字符串的额外开销如何？

```
 (str11 + str12 + str13) = (str21 + str22 + str23) 
```

让我们分析一下内存管理器和要完成的操作。在底层，这意味着 4 个额外的内存分配、2 个额外的 strcpy，以及另外 4 个额外的 strcat 或 strcpy（取决于 VM 的执行方式；但大多数会使用另一个 strcpy）操作。然后调用一次比较，它不首先使用 strlen 计算字符；相反，它要么预先知道大小（如果对象标头还包括字符数，这很可能），要么它只是运行到一个 0 字节。这被称为一次与 3 次。要比较的实际字符数大致相同（忘记额外的 0 字节）。这给我们留下了对 strcmp 的 2 次额外调用（几个 nS），而我上面描述的开销（几个 uS）。如果我们将 GC 回收开销（0 分配与 4）相加，我'

附加通知：
理论上，JITter 可以优化它或其中的一部分，并按照 Adam Bellaire 的建议实际生成代码，但我怀疑任何 JIT 开发人员都关心优化此类代码。顺便说一句，系统的字符串例程（又名字符串操作）通常比手动编码快得多，所以不要自己开始循环单个字符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T13:35:25.457

我会用简单的方法

动态运行两个数组的所有数组元素。

```
 boolean isEqual = true;
            for(int n = 0;n<str1.length;++n){
                isEqual &= str1[n].equals(str2[n]);
            }

            return isEqual; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T14:19:53.683

我会将这两个组添加到两个数组中，然后遍历数组以比较该数组中的各个字符串。Markus Lausberg 给出的答案已经是一个很好的例子。

我不会担心性能成本。只需以最易读的方式编写即可。Java 编译器在性能优化方面非常出色。

示例方法：

```
 public boolean compareGroups(String[] group1, String[] group2){
    if (group1.length != group2.length ){
        return false;
    }

    for (int i = 0; i < group1.length; i++) {
        if (!group1[i].equals(group2[i])){
            return false;
        }
    }

    return true;
} 
```

调用方法当然很简单：

```
 String[] group1 = new String[]{"String 1", "String 2", "String 3"};
    String[] group2 = new String[]{"String 1", "String 2", "String 3"};

    boolean result = compareGroups(group1, group2); 
```

# f# - F# 编译器错误 FS0030，值限制问题

> ID：416508
> 
> 赞同：3
> 
> 时间：2009-01-06T13:26:59.500
> 
> 标签：f#, units-of-measurement, value-restriction

我读过[StrangeLights](http://www.strangelights.com/fsharp/wiki/default.aspx/FSharpWiki/ValueRestriction.html)的简介，我读过 Expert F# 的[文章](http://books.google.com/books?id=NcrMkjVxahMC&printsec=frontcover&dq=FS0030+f%23)（第 119 页），但我看不出它们如何应用于我的代码：

对于我的测试，我想检查浮点数之间的相等性，并有一点宽容。我正在将所有内容转换为度量单位，但我希望能够成为“通用”：

```
let toleq (e:float<_>) a b = (abs ( a - b ) ) < e 
```

然后我可以使用它来检查不同“类型”浮点数的相等性，或者将其咖喱制作一个自定义的：

```
toleqm = toleq 1.0e-10<m> 
```

但我收到以下消息：

```
Type inference has inferred the signature
    val toleq : float<'u> -> float<'u> -> float<'u> -> bool
Either define 'toleq' as a simple data term, make it a function, or add a 
    type constraint to instantiate the type parameters. 
```

我看不出我还能做些什么来使它成为一个函数——我看不到任何隐式参数。

这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T13:31:50.410

好吧，我搞砸了一点，绝望地找到了解决方案，但我不确定我是否理解为什么......

```
let toleq (e:float<_>) (a:float<_>) (b:float<_>) = (abs ( a - b ) ) < e 
```

呃，它几乎和 C# 中的泛型声明一样丑陋。

# c# - C#为什么定时器频率非常关闭？

> ID：416522
> 
> 赞同：15
> 
> 时间：2009-01-06T13:33:16.133
> 
> 标签：c#, timer, frequency, deviation

两者都以`System.Timers.Timer`与`System.Threading.Timer`请求的间隔相当大的间隔发射。例如：

```
new System.Timers.Timer(1000d / 20); 
```

产生一个每秒触发 16 次的计时器，而不是 20 次。

为了确保没有太长的事件处理程序的副作用，我编写了这个小测试程序：

```
int[] frequencies = { 5, 10, 15, 20, 30, 50, 75, 100, 200, 500 };

// Test System.Timers.Timer
foreach (int frequency in frequencies)
{
    int count = 0;

    // Initialize timer
    System.Timers.Timer timer = new System.Timers.Timer(1000d / frequency);
    timer.Elapsed += delegate { Interlocked.Increment(ref count); };

    // Count for 10 seconds
    DateTime start = DateTime.Now;
    timer.Enabled = true;
    while (DateTime.Now < start + TimeSpan.FromSeconds(10))
        Thread.Sleep(10);
    timer.Enabled = false;

    // Calculate actual frequency
    Console.WriteLine(
        "Requested frequency: {0}\nActual frequency: {1}\n",
        frequency, count / 10d);
} 
```

输出如下所示：

要求：5 赫兹；实际：4,8 Hz
要求：10 Hz；实际：9,1 Hz
要求：15 Hz；实际：12,7 Hz
要求：20 Hz；实际：16 Hz
请求：30 Hz；实际：21,3 Hz
要求：50 Hz；实际：31,8 Hz
要求：75 Hz；实际：63,9 Hz
要求：100 Hz；实际：63,8 Hz
要求：200 Hz；实际：63,9 Hz
要求：500 Hz；实际：63,9 赫兹

实际频率与请求频率的偏差高达 36%。（而且显然不能超过 64 Hz。）鉴于微软推荐这个计时器是因为它的“更高的准确性” `System.Windows.Forms.Timer`，这让我感到困惑。

顺便说一句，这些不是随机偏差。它们每次都是相同的值。另一个计时器类的类似测试程序`System.Threading.Timer`显示了完全相同的结果。

在我的实际程序中，我需要每秒精确地收集 50 个样本的测量值。这还不需要实时系统。每秒获得 32 个样本而不是 50 个样本是非常令人沮丧的。

有任何想法吗？

@Chris：你是对的，间隔似乎都是 1/64 秒左右的整数倍。顺便说一句，在事件处理程序中添加 Thread.Sleep(...) 没有任何区别。考虑到使用线程池，这是有道理`System.Threading.Timer`的，因此每个事件都在空闲线程上触发。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-01T00:44:45.280

如果您使用 winmm.dll，您可以使用更多的 CPU 时间，但有更好的控制。

这是修改为使用 winmm.dll 计时器的示例

```
const String WINMM = "winmm.dll";
const String KERNEL32 = "kernel32.dll";

delegate void MMTimerProc (UInt32 timerid, UInt32 msg, IntPtr user, UInt32 dw1, UInt32 dw2);

[DllImport(WINMM)]
static extern uint timeSetEvent(
      UInt32            uDelay,      
      UInt32            uResolution, 
      [MarshalAs(UnmanagedType.FunctionPtr)] MMTimerProc lpTimeProc,  
      UInt32            dwUser,      
      Int32             fuEvent      
    );

[DllImport(WINMM)]
static extern uint timeKillEvent(uint uTimerID);

// Library used for more accurate timing
[DllImport(KERNEL32)]
static extern bool QueryPerformanceCounter(out long PerformanceCount);
[DllImport(KERNEL32)]
static extern bool QueryPerformanceFrequency(out long Frequency);

static long CPUFrequency;

static int count;

static void Main(string[] args)
{            
    QueryPerformanceFrequency(out CPUFrequency);

    int[] frequencies = { 5, 10, 15, 20, 30, 50, 75, 100, 200, 500 };

    foreach (int freq in frequencies)
    {
        count = 0;

        long start = GetTimestamp();

        // start timer
        uint timerId = timeSetEvent((uint)(1000 / freq), 0, new MMTimerProc(TimerFunction), 0, 1);

        // wait 10 seconds
        while (DeltaMilliseconds(start, GetTimestamp()) < 10000)
        {
            Thread.Sleep(1);
        }

        // end timer
        timeKillEvent(timerId);

        Console.WriteLine("Requested frequency: {0}\nActual frequency: {1}\n", freq, count / 10);
    }

    Console.ReadLine();
}

static void TimerFunction(UInt32 timerid, UInt32 msg, IntPtr user, UInt32 dw1, UInt32 dw2)
{
    Interlocked.Increment(ref count);
}

static public long DeltaMilliseconds(long earlyTimestamp, long lateTimestamp)
{
    return (((lateTimestamp - earlyTimestamp) * 1000) / CPUFrequency);
}

static public long GetTimestamp()
{
    long result;
    QueryPerformanceCounter(out result);
    return result;
} 
```

这是我得到的输出：

```
Requested frequency: 5
Actual frequency: 5

Requested frequency: 10
Actual frequency: 10

Requested frequency: 15
Actual frequency: 15

Requested frequency: 20
Actual frequency: 19

Requested frequency: 30
Actual frequency: 30

Requested frequency: 50
Actual frequency: 50

Requested frequency: 75
Actual frequency: 76

Requested frequency: 100
Actual frequency: 100

Requested frequency: 200
Actual frequency: 200

Requested frequency: 500
Actual frequency: 500 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T13:50:12.497

这些类不适合实时使用，并且受制于 Windows 等操作系统的动态调度特性。如果您需要实时执行，您可能希望查看一些嵌入式硬件。我不确定 100%，但我认为 .netcpu 可能是芯片上较小的 .NET 运行时的实时版本。

[http://www.arm.com/markets/emerging_applications/armpp/8070.html](http://www.arm.com/markets/emerging_applications/armpp/8070.html)

当然 - 您需要评估这些间隔的准确性有多重要，因为附加到它们的代码将在非实时操作系统上执行。除非这当然是一个纯粹的学术问题（在这种情况下 - 是的，这很有趣！：P）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-06T14:01:43.767

看起来您的实际计时器频率是 63.9 Hz 或其整数倍。

这意味着约 15 毫秒（或其整数倍，即 30 毫秒、45 毫秒等）的定时器分辨率。

这是基于“滴答”整数倍的计时器，这是可以预料的（例如，在 DOS 中，“滴答”的值为 55 毫秒/18 赫兹）。

我不知道为什么你的滴答计数是 15.65 mec 而不是 15 ms。作为一个实验，如果您在计时器处理程序中睡几个毫秒会怎样：我们是否会看到滴答之间有 15 毫秒，而您的计时器处理程序中每个滴答有 0.65 毫秒？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T14:01:52.347

Windows（以及因此在其上运行的 .NET）是一种抢先式多任务操作系统。任何给定的线程都可以随时被另一个线程停止，如果抢占线程的行为不正常，您将无法在需要或*需要*时获得控制权。

简而言之，这就是为什么您不能保证获得准确的时间，以及为什么 Windows 和 .NET 不适合某些类型的软件平台。如果生命处于危险之中，因为您无法在需要的时候获得控制权，请选择不同的平台。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-06T14:14:46.253

嗯，实际上我得到了不同的数字，最高可达 100 Hz，有一些很大的偏差，但在大多数情况下，更接近请求的数字（使用最新的 .NET SP 运行 XP SP3）。

System.Timer.Timer 是使用 System.Threading.Timer 实现的，因此这解释了为什么您会看到相同的结果。我想定时器是使用某种调度算法等实现的（它是内部调用，也许看看Rotor 2.0可能会对此有所了解）。

我建议使用另一个线程（或其组合）调用睡眠和回调来实现一种计时器。虽然不确定结果。

否则，您可能会查看[多媒体计时器](http://msdn.microsoft.com/en-us/library/ms713423(VS.85).aspx)(PInvoke)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-06T14:36:26.210

如果您确实需要跳转到实时环境，我过去曾在需要确定性采样（来自自定义串行设备）时使用 RTX，并且非常幸运。

[http://www.pharlap.com/rtx.htm](http://www.pharlap.com/rtx.htm)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-02-12T02:34:32.973

这是使用多媒体计时器的计时器的一个很好的实现 [http://www.softwareinteractions.com/blog/2009/12/7/using-the-multimedia-timer-from-c.html](http://www.softwareinteractions.com/blog/2009/12/7/using-the-multimedia-timer-from-c.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-06T13:42:12.963

定时器频率关闭的原因有很多。以硬件为例，同一个线程正忙于另一个处理，依此类推......

如果您想要更准确的时间，请使用 System.Diagnostics 命名空间中的 Stopwatch 类。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-06T14:18:39.113

部分问题是计时器有两个*延迟*要考虑。这可能会有所不同，具体取决于计时器在操作系统中的实现方式。

1.  您要求等待的时间
2.  #1 发生与进程进入调度队列之间的时间。

计时器对#1 有很好的控制，但对#2 几乎没有控制。它可以向操作系统发出信号，表示它想再次运行，但操作系统可以在需要时随意唤醒它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-01T00:48:50.400

根据您的评论，您根本不应该使用计时器。您应该使用带有秒表的循环来检查间隔和自旋锁，这样您就不会丢失量子。

# c# - 如何在.NET C#中以编程方式确定IP是否来自同一个LAN

> ID：416524
> 
> 赞同：4
> 
> 时间：2009-01-06T13:33:42.933
> 
> 标签：c#, .net, ip

我知道如果 IP 超出子网掩码 + 本地 IP 规则，则只能通过网关访问。问题是我不知道如何使用.NET 以编程方式获取本地IP 地址，也不知道本地子网掩码。你们中的任何人都可以帮助我吗？

我将使用这些信息从我的批处理 SQL 插入队列中获得最大性能。如果 SQL 服务器位于同一子网中，那么它将使用针对最小延迟优化的算法，否则我将使用针对高延迟优化的算法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T14:00:51.227

您可以使用 System.Net.NetworkInformation 命名空间中的类（在 .NET 2.0 中引入）：

```
 NetworkInterface[] interfaces = NetworkInterface.GetAllNetworkInterfaces();

        foreach (NetworkInterface iface in interfaces)
        {
            IPInterfaceProperties properties = iface.GetIPProperties();

            foreach (UnicastIPAddressInformation address in properties.UnicastAddresses)
            {
                Console.WriteLine(
                    "{0} (Mask: {1})",
                    address.Address,
                    address.IPv4Mask
                    );
            }
        } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T14:43:27.350

[使用NetworkInformation](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkinterface.aspx)类还有另一种方法：

```
public static void ShowNetworkInterfaces()
{
    // IPGlobalProperties computerProperties = IPGlobalProperties.GetIPGlobalProperties();
    NetworkInterface[] nics = NetworkInterface.GetAllNetworkInterfaces();

    if (nics == null || nics.Length < 1)
    {
        Console.WriteLine("  No network interfaces found.");
        return;
    }

    Console.WriteLine("  Number of interfaces .................... : {0}", nics.Length);
    foreach (NetworkInterface adapter in nics)
    {
        IPInterfaceProperties properties = adapter.GetIPProperties();
        Console.WriteLine();
        Console.WriteLine(adapter.Description);
        Console.WriteLine(String.Empty.PadLeft(adapter.Description.Length,'='));
        Console.WriteLine("  Interface type .......................... : {0}", adapter.NetworkInterfaceType);
        Console.WriteLine("  Physical Address ........................ : {0}", adapter.GetPhysicalAddress().ToString());
        string versions ="";

        // Create a display string for the supported IP versions.
        if (adapter.Supports(NetworkInterfaceComponent.IPv4))
        {
            versions = "IPv4";
        }
        if (adapter.Supports(NetworkInterfaceComponent.IPv6))
        {
            if (versions.Length > 0)
            {
                versions += " ";
            }
            versions += "IPv6";
        }
        Console.WriteLine("  IP version .............................. : {0}", versions);
        UnicastIPAddressInformationCollection uniCast = properties.UnicastAddresses;
        if (uniCast != null)
        {
            foreach (UnicastIPAddressInformation uni in uniCast)
            {
                Console.WriteLine("  Unicast Address ......................... : {0}", uni.Address);
                Console.WriteLine("     Subnet Mask  ......................... : {0}", uni.IPv4Mask);
            }
        }
    Console.WriteLine();
    }
} 
```

*代码示例是 Msdn 提供的示例的混搭形式，简化后仅显示您可能需要的信息。*

编辑：我花了太长时间（同时做太多事情:)）来发表这篇文章，米奇打败了我:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T13:50:11.763

这将为您提供主机名和 IP 地址。我假设您知道 LAN 中的 IP，因此您应该能够确定 IP 地址是否在 LAN 之外：

```
// Get the host name of local machine.
strHostName = Dns.GetHostName();
Console.WriteLine("Local Machine's Host Name: " + strHostName);

// Using the host name, get the IP address list.
IPHostEntry ipEntry = Dns.GetHostEntry(strHostName);
IPAddress[] addr = ipEntry.AddressList;

for (int i = 0; i < addr.Length; i++)
{
     Console.WriteLine("IP Address {0}: {1} ", i, addr[i].ToString());
} 
```

# sql-server-2005 - SQL查询：制作单个文件的最后权重列表，按文件名分组

> ID：416528
> 
> 赞同：0
> 
> 时间：2009-01-06T13:35:37.640
> 
> 标签：sql-server-2005

我需要以下 SQL 命令的帮助。

我有 2 张桌子：

带列的表权重：

*   称重标识
*   文件编号
*   我的日期时间

带有列的表格文件：

*   文件编号
*   姓名

Table Weighings 包含对指定文件进行称重时的信息。我需要列出单个文件的最后权重列表，按文件名分组。最终表格将包含 Weighing.Id、文件名 (File.Name) 和该文件上次称重时的第二列 MAX(Weighings.MyDateTime)。

可能存在具有不同 File.Id 的重复文件名，我需要将所有具有相同名称的文件分组（因此我不能对 File.FileId 进行分组）。

我试图使用这段代码，但它不起作用：

```
SELECT W.WeighingId AS WeighingId, MAX(W.MyDateTime) AS MaxMyDateTime
FROM Files F INNER JOIN Weighings W ON W.FileId = F.FileId
GROUP BY F.Name
ORDER BY F.Name 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T13:39:36.790

```
SELECT F.Name, 
       MAX(W.MyDateTime) AS MaxMyDateTime
FROM Files F INNER JOIN Weighings W ON W.FileId = F.FileId
GROUP BY F.Name
ORDER BY F.Name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T13:41:58.003

“最终表格将包含**具有文件名**(File.Name) 的第一列和上次对该文件进行 MAX(Weighings.MyDateTime) 称重时的第二列。”

您的 SQL 将 W.WeighingId 作为第一列，而不是 File.Name。

解决这个问题，它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T13:42:38.330

就像是：

```
select WeighingID
  , f.Name
  , f.FileID
  , MaxMyDateTime = (SELECT MAX(Weighings.MyDateTime) FROM Files F INNER JOIN Weighings ON Weighings.FileId = Files.FileId WHERE File.Name = f.Name)
from Weighings w
  inner join Files f
    on w.fileid=f.fileid 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T21:33:32.230

它应该是：

```
SELECT 
    F.Name, 
    (SELECT TOP 1 WeighingId FROM Weighings WHERE MyDateTime = MAX(W.MyDateTime)),
    MAX(W.MyDateTime) AS MaxMyDateTime  
FROM Files F 
    INNER JOIN Weighings W ON W.FileId = F.FileId
GROUP BY F.Name
ORDER BY F.Name 
```

您不需要 F.Name 出现在选择列表中（在您的示例中，WeighingId 不允许相反）。我想问题是如何聚合 WeighingId 来选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T13:46:25.950

我的请求，我需要获取最后一次称量的 Weighing.Id，所以最终表也应该包含 Weighing.WeighingId。

# regex - 正则表达式验证正则表达式

> ID：416532
> 
> 赞同：-1
> 
> 时间：2009-01-06T13:39:22.097
> 
> 标签：regex

> **可能重复：**
> [匹配有效正则表达式的正则表达式](https://stackoverflow.com/questions/362793/regexp-that-matches-valid-regexps)

[与有效正则表达式匹配](https://stackoverflow.com/questions/362793/regexp-that-matches-valid-regexps)的正则表达式副本

如何生成只匹配有效正则表达式的正则表达式？

例如：`"[hc]at"`将是有效的（匹配`"hat"`and `"cat"`），但`"[hcat"`将是无效的，因为它缺少`]`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T13:42:08.097

一般来说，不，因为嵌套的括号和括号对等是您需要递归后代解析器（或类似的）来处理的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T13:49:15.587

为工作使用正确的工具。更好的解决方案是使用您正在使用的语言的 RegEx 类。

就像是：

```
>  Regex rx = new Regex("[INVALID REGEX
> HERE");  if(rx.Valid())  {    ...  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T13:45:13.817

在 Java 中，您可以通过调用来检查正则表达式

```
// Create a pattern to match breaks
    Pattern p = Pattern.compile("[,\\s]+"); 
```

如果表达式的语法无效，编译方法会抛出 PatternSyntaxException

# asp.net - Ajax 和 ASP.NET MasterPages 是否混合使用？

> ID：416537
> 
> 赞同：4
> 
> 时间：2009-01-06T13:39:49.083
> 
> 标签：asp.net, ajax, master-pages

有没有人有过同时使用这两种技术的经验？让两者合作的主要困难是什么（如果有的话）？使用这些技术的站点与使用 Ajax 的普通 ASP.NET Web 应用程序有何不同？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-06T13:43:11.090

是的，他们一起工作得很好。

唯一需要注意的是，如果您在 Master 上有一个 ScriptManager，则不能在内容页面中声明另一个。

如果您想通过内容页面上的 ScriptManager 注册脚本和服务，则需要使用**ScriptManagerProxy**控件。它是专为 Master/Content 场景设计的控件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T13:52:07.280

我一起使用母版页和 ASP.NET AJAX 没有问题。您可以在内容占位符上使用脚本管理器，也可以在母版页中使用单个脚本管理器，但是您必须记住在内容区域中使用 ScriptManagerProxy 以获得正确的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T13:59:09.263

它取决于你在谈论什么 Ajax 框架，对于 ASP.NET AJAX，你需要弄乱 ScriptManager(Proxy) 这使它有点复杂，但不是那么困难......

[Ra-Ajax](http://ra-ajax.org)的[示例](http://ra-ajax.org/samples/)大多都使用 MasterPages，无需摆弄 ScriptManager 或 ScriptManagerProxy。但是 Ra-Ajax 建立在与 ASP.NET AJAX 完全不同的架构上......

顺便说一句，我与 Ra-Ajax 合作，很难被定义为“中立”......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T14:55:08.793

In addition to declaring the ScriptManager on the Master Page and ScriptManagerProxy on the content pages, it is a good practice to put all the JavaScript files in a separate dll so you have all your resources separate from the rest of the project. Having separate debug and release versions (with white spaces removed) of the Javascript files gives you a good performance boost.

# java - 值受键的类型参数限制的 Java 映射

> ID：416540
> 
> 赞同：48
> 
> 时间：2009-01-06T13:41:37.910
> 
> 标签：java, generics

Java中有没有一种方法可以使值的类型参数与键的类型参数相关联？我想写的是如下内容：

```
public class Foo {
    // This declaration won't compile - what should it be?
    private static Map<Class<T>, T> defaultValues;

    // These two methods are just fine
    public static <T> void setDefaultValue(Class<T> clazz, T value) {
        defaultValues.put(clazz, value);
    }

    public static <T> T getDefaultValue(Class<T> clazz) {
        return defaultValues.get(clazz);
    }
} 
```

也就是说，只要值的类型与 Class 对象的类型匹配，我就可以针对 Class 对象存储任何默认值。我不明白为什么不允许这样做，因为我可以确保在设置/获取值时类型是正确的。

编辑：感谢 cletus 的回答。我实际上并不需要地图本身的类型参数，因为我可以确保获取/设置值的方法的一致性，即使这意味着使用一些稍微难看的强制转换。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-01-06T13:56:52.967

您不是在尝试实现 Joshua Bloch 的类型安全异构容器模式吗？基本上：

> ```
> public class Favorites {
>   private Map<Class<?>, Object> favorites =
>     new HashMap<Class<?>, Object>();
> 
>   public <T> void setFavorite(Class<T> klass, T thing) {
>     favorites.put(klass, thing);
>   }
> 
>   public <T> T getFavorite(Class<T> klass) {
>     return klass.cast(favorites.get(klass));
>   }
> 
>   public static void main(String[] args) {
>     Favorites f = new Favorites();
>     f.setFavorite(String.class, "Java");
>     f.setFavorite(Integer.class, 0xcafebabe);
>     String s = f.getFavorite(String.class);
>     int i = f.getFavorite(Integer.class);
>   }
> } 
> ```

来自[Effective Java（第 2 版）](https://rads.stackoverflow.com/amzn/click/com/0321356683)和[此演示文稿](http://developers.sun.com/learning/javaoneonline/2006/coreplatform/TS-1512.pdf)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-28T14:58:14.733

这个问题和答案让我想出了这个解决方案：[Type-safe object map](http://blog.pdark.de/2010/05/28/type-safe-object-map/)。这是代码。测试用例：

```
import static org.junit.Assert.*;

import java.util.ArrayList;
import java.util.List;

import org.junit.Test;

public class TypedMapTest {
    private final static TypedMapKey<String> KEY1 = new TypedMapKey<String>( "key1" );
    private final static TypedMapKey<List<String>> KEY2 = new TypedMapKey<List<String>>( "key2" );

    @Test
    public void testGet() throws Exception {

        TypedMap map = new TypedMap();
        map.set( KEY1, null );
        assertNull( map.get( KEY1 ) );

        String expected = "Hallo";
        map.set( KEY1, expected );
        String value = map.get( KEY1 );
        assertEquals( expected, value );

        map.set( KEY2, null );
        assertNull( map.get( KEY2 ) );

        List<String> list = new ArrayList<String> ();
        map.set( KEY2, list );
        List<String> valueList = map.get( KEY2 );
        assertEquals( list, valueList );
    }
} 
```

这是 Key 类。请注意，此类`T`中从未使用过该类型！从地图中读取值时，这纯粹是为了进行类型转换。该字段`key`仅给键一个名称。

```
public class TypedMapKey<T> {
    private String key;

    public TypedMapKey( String key ) {
        this.key = key;
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = 1;
        result = prime * result + ( ( key == null ) ? 0 : key.hashCode() );
        return result;
    }

    @Override
    public boolean equals( Object obj ) {
        if( this == obj ) {
            return true;
        }
        if( obj == null ) {
            return false;
        }
        if( getClass() != obj.getClass() ) {
            return false;
        }
        TypedMapKey<?> other = (TypedMapKey<?>) obj;
        if( key == null ) {
            if( other.key != null ) {
                return false;
            }
        } else if( !key.equals( other.key ) ) {
            return false;
        }
        return true;
    }

    @Override
    public String toString() {
        return key;
    }
} 
```

TypedMap.java：

```
import java.util.Collection;
import java.util.HashMap;
import java.util.Map;
import java.util.Set;

public class TypedMap implements Map<Object, Object> {
    private Map<Object, Object> delegate;

    public TypedMap( Map<Object, Object> delegate ) {
        this.delegate = delegate;
    }

    public TypedMap() {
        this.delegate = new HashMap<Object, Object>();
    }

    @SuppressWarnings( "unchecked" )
    public <T> T get( TypedMapKey<T> key ) {
        return (T) delegate.get( key );
    }

    @SuppressWarnings( "unchecked" )
    public <T> T remove( TypedMapKey<T> key ) {
        return (T) delegate.remove( key );
    }

    public <T> void set( TypedMapKey<T> key, T value ) {
        delegate.put( key, value );
    }

    // --- Only calls to delegates below

    public void clear() {
        delegate.clear();
    }

    public boolean containsKey( Object key ) {
        return delegate.containsKey( key );
    }

    public boolean containsValue( Object value ) {
        return delegate.containsValue( value );
    }

    public Set<java.util.Map.Entry<Object, Object>> entrySet() {
        return delegate.entrySet();
    }

    public boolean equals( Object o ) {
        return delegate.equals( o );
    }

    public Object get( Object key ) {
        return delegate.get( key );
    }

    public int hashCode() {
        return delegate.hashCode();
    }

    public boolean isEmpty() {
        return delegate.isEmpty();
    }

    public Set<Object> keySet() {
        return delegate.keySet();
    }

    public Object put( Object key, Object value ) {
        return delegate.put( key, value );
    }

    public void putAll( Map<? extends Object, ? extends Object> m ) {
        delegate.putAll( m );
    }

    public Object remove( Object key ) {
        return delegate.remove( key );
    }

    public int size() {
        return delegate.size();
    }

    public Collection<Object> values() {
        return delegate.values();
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T13:52:36.843

不，你不能直接这样做。您需要编写一个包装类`Map<Class, Object>`来强制 Object 是`instanceof`Class。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-09T09:25:19.920

可以创建一个类，该类将安全键类型的映射存储到一个值，并在必要时进行强制转换。cast in`get`方法是安全的，因为在 using 之后`new Key<CharSequence>()`，不可能将其安全地强制转换为`Key<String>`or `Key<Object>`，因此类型系统强制正确使用类。

该类`Key`必须是最终的，否则`equals`如果两个不同类型的元素相等，用户可能会覆盖并导致类型不安全。`equals`或者，如果您想使用继承，尽管存在问题，也可以将其覆盖为 final。

```
public final class TypeMap {
    private final Map<Key<?>, Object> m = new HashMap<>();

    public <T> T get(Key<? extends T> key) {
        // Safe, as it's not possible to safely change the Key generic type,
        // hash map cannot be accessed by an user, and this class being final
        // to prevent serialization attacks.
        @SuppressWarnings("unchecked")
        T value = (T) m.get(key);
        return value;
    }

    public <T> void put(Key<? super T> key, T value) {
        m.put(key, value);
    }

    public static final class Key<T> {
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-05T09:57:42.407

您可以使用以下 2 个类，Map 类：***GenericMap***，Map-Key 类：***GenericKey***

**例如：**

```
// Create a key includine Type definition
public static final GenericKey<HttpServletRequest> REQUEST = new GenericKey<>(HttpServletRequest.class, "HttpRequestKey");

public void example(HttpServletRequest requestToSave)
{
    GenericMap map = new GenericMap();

    // Saving value
    map.put(REQUEST, requestToSave);

    // Getting value
    HttpServletRequest request = map.get(REQUEST);
} 
```

**好处**

*   它通过编译错误强制用户放置和获取正确的类型
*   它在里面为你做外壳
*   Generic Key 有助于避免每次调用***put(..)***或***get时编写类类型***
*   没有拼写错误，比如 key 是 'String' 类型

## 通用地图

```
public class GenericMap
{  
    private Map<String, Object> storageMap;

    protected GenericMap()
    {
        storageMap = new HashMap<String, Object>();
    }

    public <T> T get(GenericKey<T> key)
    {
        Object value = storageMap.get(key.getKey());
        if (value == null)
        {
            return null;
        }

        return key.getClassType().cast(value);
    }

    /**
     * @param key    GenericKey object with generic type - T (it can be any type)
     * @param object value to put in the map, the type of 'object' mast be - T
     */
    public <T> void put(GenericKey<T> key, T object)
    {
        T castedObject = key.getClassType().cast(object);
        storageMap.put(key.getKey(), castedObject);
    }

    @Override
    public String toString()
    {
        return storageMap.toString();
    }
} 
```

## 通用密钥

```
public class GenericKey<T>
{
    private Class<T> classType;
    private String key;

    @SuppressWarnings("unused")
    private GenericKey()
    {
    }

    public GenericKey(Class<T> iClassType, String iKey)
    {
        this.classType = iClassType;
        this.key = iKey;
    }

    public Class<T> getClassType()
    {
        return classType;
    }

    public String getKey()
    {
        return key;
    }

    @Override
    public String toString()
    {
        return "[classType=" + classType + ", key=" + key + "]";
    }
} 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-01-06T13:56:05.823

`T`作为类型必须在类实例中一般定义。以下示例有效：

```
public class Test<T> {

    private Map<Class<T>, T> defaultValues;

    public void setDefaultValue(Class<T> clazz, T value) {
        defaultValues.put(clazz, value);
    }

    public T getDefaultValue(Class<T> clazz) {
        return defaultValues.get(clazz);
    }

} 
```

或者，您可以使用 Paul Tomblin 的答案，并`Map`用您自己的对象包装，这将强制执行这种类型的泛型。

# wpf - WPF 的最佳 UI 组件集是什么？

> ID：416541
> 
> 赞同：14
> 
> 时间：2009-01-06T13:41:42.543
> 
> 标签：wpf, windows, silverlight, user-interface, uicomponents

寻找通用 WPF 工具集。目前正在研究 Telerik 和 Infragistics。那里有更好的选择吗？这两个，哪个更好？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-06T16:04:55.717

我仍然认为您不需要像我们在做 WinForms 项目时一样，在新的 WPF 项目中尽早获得第三方控件库。我不太确定您使用 WPF 的背景，您可能遇到了僵局并需要特定的控件，但通常您可以使用 XAML、样式和控件模板做的事情非常棒。

对于那些通常仅仅因为开箱即用的控件看起来太乏味而购买第三方库的人，请坚持使用 XAML，因为您将获得所需的所有自定义，并且您最终将学习如何创建如果您只是将现成的控件拖放到 UI 表面，您将永远无法获得令人惊叹的 UI。

对于具有非常特定行为的控件、DataGrid、日历控件和图表，我在 CodePlex 上找到了我所需要的一切。

正如前面文章中提到的，我还向那些不想在第三方控件库上大肆宣传的人推荐以下内容。

*   对于图表：- VisiFire（[www.visifire.com](http://www.visifire.com/)和[www.codeplex.com/visifire](http://www.codeplex.com/visifire)）
*   对于 DataGrid 和 Calendar 控件：- WPF Toolkit ( [www.codeplex.com/wpf](http://www.codeplex.com/wpf) )

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-06T14:11:21.547

也看看[DevExpress](http://www.devexpress.com)。他们的组件非常好

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-06T14:19:42.903

[Actipro](http://actiprosoftware.com/Products/DotNet/Default.aspx)有一个 WPF 功能区和一组组件（虽然没有 DataGrid 或 Charting）。

有几个供应商免费提供他们的 WPF Grid（他们的企业版的有限版本，请参阅 Xceed）。

出于制图目的，有[Visifire](http://www.visifire.com)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-06T16:12:53.050

[DevComponents](http://devcomponents.com/dotnetbar-wpf/)有一个很好的集合。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-06T13:47:55.993

我没有使用 Telerik 的经验，但如果有比 Infragistics*更糟糕*的东西，我会感到惊讶。不确定您到底要使用哪些组件 - 您看过[WPF Toolkit](http://www.codeplex.com/wpf)吗？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-06T16:13:25.263

我们正在为 WPF 使用 Telerik 控件。最初，我们开始使用自定义样式和模板滚动我们自己的网格、组合、树等，但是当需要完善所有内容时，我们需要 Telerik 提供的所有附加功能。我们对他们的某些控件感到失望，例如轮播，但我们正在与他们合作以改进控件。我们经常发现他们提供的支持（通常带有完整的编码示例）抵消了包的成本。它们很好地遵循 Microsoft 的命名约定，因此学习曲线并不太陡峭。

我们已经尝试过 ComponentOne，但不喜欢那些。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-06T13:51:44.333

组件一相当不错——有点贵，但还不错。我们正在将它用于我们当前的项目，为州卫生部门开发应用程序，并且到目前为止对它感到满意。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-06T16:36:11.927

我的公司拥有 Infragistics 控制套件的许可证，目前我远离对接管理器的所有控制例外，这非常好。

我们试图摆脱对 Grid 控件的依赖，并使用其他 UI 实现（如带有自定义数据模板的列表框）来避免被直接套入供应商特定的实现中。

在我们的 WinForms 时代，我们因依赖 Infragistics Grid 控件来处理所有事情而受尽折磨。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-07T02:32:06.297

如果您正在寻找 Ribbon 或 DataGrid 控件，那么 Microsoft 将在正常的 .NET Framework 版本之外发布一些控件。这些可在[http://www.codeplex.com/wpf](http://www.codeplex.com/wpf)

我更喜欢远离源代码不可用的第三方控件。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-12-23T23:27:41.003

有时间去 fps​​components.com 看看，有一些独特的 WPF 组件，特别是对于触摸屏应用程序，以及 WPF 的大部分标准组件包

# php - 将 SimpleXML 对象强制为字符串，无论上下文如何

> ID：416548
> 
> 赞同：79
> 
> 时间：2009-01-06T13:42:48.733
> 
> 标签：php, xml, simplexml

假设我有一些这样的 XML

```
<channel>
  <item>
    <title>This is title 1</title>
  </item>
</channel> 
```

下面的代码做了我想要的，它将标题作为字符串输出

```
$xml = simplexml_load_string($xmlstring);
echo $xml->channel->item->title; 
```

这是我的问题。下面的代码在该上下文中不将标题视为字符串，因此我最终在数组中使用 SimpleXML 对象而不是字符串。

```
$foo = array( $xml->channel->item->title ); 
```

我一直在这样解决它

```
$foo = array( sprintf("%s",$xml->channel->item->title) ); 
```

但这似乎很难看。

**无论上下文如何，将 SimpleXML 对象强制为字符串的最佳方法是什么？**

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-01-06T14:01:58.430

**将 SimpleXMLObject 类型转换为字符串：**

```
$foo = array( (string) $xml->channel->item->title ); 
```

上面的代码在内部调用`__toString()`了 SimpleXMLObject。此方法不公开，因为它会干扰 SimpleXMLObject 的映射方案，但仍可以通过上述方式调用它。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-04T20:06:57.537

你可以使用PHP函数

```
strval(); 
```

此函数返回传递给它的参数的字符串值。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-01T06:03:03.433

有本机 SimpleXML 方法[SimpleXMLElement::asXML](http://php.net/manual/en/simplexmlelement.asxml.php) 根据参数，它将 SimpleXMLElement 写入 xml 1.0 文件或仅写入字符串：

```
$xml = new SimpleXMLElement($string);
$validfilename = '/temp/mylist.xml';
$xml->asXML($validfilename);    // to a file
echo $xml->asXML();             // to a string 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-13T08:25:25.743

另一种丑陋的做法：

```
$foo = array( $xml->channel->item->title."" ); 
```

它有效，但它并不漂亮。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-09-07T16:24:21.027

接受的答案实际上返回一个包含字符串的数组，这不是 OP 所要求的（字符串）。要扩展该答案，请使用：

```
$foo = [ (string) $xml->channel->item->title ][0]; 
```

它返回数组的单个元素，一个字符串。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-07-11T21:27:17.870

要将 XML 数据放入 php 数组中，请执行以下操作：

```
// this gets all the outer levels into an associative php array
$header = array();
foreach($xml->children() as $child)
{
  $header[$child->getName()] = sprintf("%s", $child); 
}
echo "<pre>\n";
print_r($header);
echo "</pre>"; 
```

要得到一个孩子的孩子，然后这样做：

```
$data = array();
foreach($xml->data->children() as $child)
{
  $header[$child->getName()] = sprintf("%s", $child); 
}
echo "<pre>\n";
print_r($data);
echo "</pre>"; 
```

您可以通过每个级别扩展 $xml-> 直到获得所需的内容。您还可以将所有节点放入一个数组中，而无需级别或几乎任何其他您想要的方式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-07-04T15:04:59.330

试试 strval($xml->channel->item->title)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-09-29T15:40:07.397

不确定他们是否改变了`__toString()`方法的可见性，因为接受的答案是写的，但此时它对我来说很好：

```
var_dump($xml->channel->item->title->__toString()); 
```

**输出：**

```
string(15) "This is title 1" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-11-23T09:54:19.010

有本机 SimpleXML 方法 SimpleXMLElement::asXML 根据参数，它将 SimpleXMLElement 写入 xml 1.0 文件，是的

```
$get_file= read file from path;
$itrate1=$get_file->node;
$html  = $itrate1->richcontent->html;

echo  $itrate1->richcontent->html->body->asXML();
 print_r((string) $itrate1->richcontent->html->body->asXML()); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-05-03T15:36:07.823

只需输入''。在任何变量之前，它将转换为字符串。

$foo = array(''.$xml->channel->item->title);

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-07-17T19:26:56.683

以下是将所有单子元素类型转换为 a 的递归函数`String`：

```
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// FUNCTION - CLEAN SIMPLE XML OBJECT
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
function cleanSimpleXML($xmlObject = ''){

    // LOOP CHILDREN
    foreach ($xmlObject->children() as $child) {

        // IF CONTAINS MULTIPLE CHILDREN
        if(count($child->children()) > 1 ){

            // RECURSE
            $child = cleanSimpleXML($child);

        }else{

            // CAST
            $child = (string)$child;

        }

    }

    // RETURN CLEAN OBJECT
    return $xmlObject;

} // END FUNCTION 
```

# linq - 如何在 SqlServer Management Studio 2005 中显示总运行时间？

> ID：416549
> 
> 赞同：1
> 
> 时间：2009-01-06T13:43:07.407
> 
> 标签：linq, stored-procedures

我通常不使用 Sql Server Management Studio，我通常使用 Linqpad 来运行我所有的数据库查询。无论如何....我的老板似乎认为存储过程“比 linq 快得多”。

因此，为了测试这一点，我想运行一个简单的存储过程并显示针对相等的 linq 语句运行所需的时间。

关于如何实现这一目标的任何好主意？我相信你们（和女孩）以前遇到过这个问题。

关于如何将其与 linq 语句的运行时进行比较的任何想法？

**编辑：**让我澄清一些事情；首先，当我的老板说“linq”时，我只能假设她在谈论 Linq-to-Sql。其次，我愿意尝试一切可能的方法来检验这个理论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T13:55:18.430

你的老板是对的，因为存储过程就像编译代码，而 LINQ（使用 SQL）更像是解释代码。

但是......你失去了存储过程的灵活性。另外，您是否经常运行它们，例如每分钟超过 10,000 次？如果不是，那么您将不会真正注意到差异。

很多事情都会影响查询速度，其中最少的是存储过程与自由形式查询。在我担心将所有内容存储为过程之前，我会更担心数据库结构和索引之类的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T13:45:25.563

我通常为此创建一个变量。前任：

```
Declare @Start DateTime
Set @Start = GetDate()

Exec YourStoredProcedureHere

Select DateDiff(Millisecond, @Start, GetDate()) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T13:53:15.937

我认为他要求的不是记录时间的方法，而是更像是一些现实的、有效的测试，可以作为存储过程与 Linq 运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T13:49:36.740

您应该能够使用[SQL Profiler](http://msdn.microsoft.com/en-us/library/ms979207.aspx)来跟踪这两个查询并查看其中的差异。使用这种方法，您的计时将在同一个地方完成，而不是尝试将 TSql 计时与 C# 中的某些内容进行比较以进行 LINQ 查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T13:51:39.060

“存储过程比 LINQ 快得多”的论点有点模糊。我们是在谈论运行单个存储过程，还是使用相同的数据库连接运行多个存储过程？我们是在谈论使用游标还是事务？一些细节会很有帮助。

我的理解是，LINQ to SQL 对于处理从数据库服务器返回到您的应用程序的数据或使用更类似于 SQL 的语法向数据库服务器发出命令非常有用。操作的类型和数量可能会对一个与另一个的性能产生重大影响。

我本人认为（基于我有限的经验）存储过程应该总是更快，因为它们与数据本身一起驻留在本地，并且您消除了应用程序*重复*执行可能需要的任何网络流量的开销调用服务器。（建立连接时总会有一些要求。）但这可以通过优化来缓解。

正如我所说，需要澄清。

**编辑：**在我的帖子中，我指的是端到端性能，而不是 LINQ 生成的 SQL 与存储过程中的 SQL 的性能。

# networking - 为什么恰好一次语义不可行？

> ID：416551
> 
> 赞同：13
> 
> 时间：2009-01-06T13:43:16.720
> 
> 标签：networking, rpc, semantics

在 Erlang 寄希望于最好的 RPC 语义中，SUN RPC 至少一次和 Java RMI 最多一次但没有人有完全一次的语义。

为什么只有一次语义似乎不可行？

例如，如果客户端不断重新发送一个唯一标记的请求，直到收到回复，并且服务器跟踪所有处理的请求以便不重复请求。那不正是一次吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-06T14:51:33.400

考虑一下如果服务器在执行请求和记录它执行了请求之间崩溃会发生什么？

您最多可以通过记录请求然后执行它来获得一次。如果您在两者之间发生崩溃，那么您（错误地）将其记录为已执行，因此您不会再这样做了。因此最多一次

奇怪的是，这个（有超时）专利：[http](http://www.freepatentsonline.com/7162512.html) ://www.freepatentsonline.com/7162512.html 。除了我上面所说的，它不能保证完全一次。

您至少可以通过执行它然后记录它来获得一次。如果您在两者之间发生崩溃，如果重复请求，您将再次执行它。

但是在所有情况下都说“恰好一次”并不是真的可行

（网络错误也有类似的场景，而不是服务器崩溃）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T15:36:02.437

[像 IBM 的WebSphere MQ](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/index.jsp?topic=/com.ibm.mq.csqzau.doc/ts10840_.htm)这样的高端消息传递总线确实声称提供一次交付。事实上，这是默认行为（截至我上次使用 WMQ 时...）。他们通过[预写日志](http://en.wikipedia.org/wiki/Write_ahead_logging)和各种锁定技术来实现这一点。

当然，我不怀疑埋在他们的法律文件中的某个地方，“恰好一次”实际上被定义为“消息可能会或可能不会被传递，一次，不止一次。或很多。或少于零。” 为了掩盖他们的背部，但它在绝大多数情况下确实有效，包括踢掉电源线，将斧头带到网络基础设施等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T14:54:40.430

我认为答案是你需要无限的时间来获得这些语义，因为客户端必须等待来自服务器的明确结果，而这可能永远不会到来。这个要求在真实网络上是不切实际的。

如果客户端放弃尝试（或者如果服务器在完成事务之前或在发出信号完成之前长时间停机，这取决于它执行这些操作的顺序），那么客户端可能无法知道请求是否被接收和处理。在实践中，例如，RPC 系统可能希望遵守默认的 TCP 超时，因此不希望必须等待服务器确定的成功或失败。

不过这是一个猜测：我从未设计过 RPC 协议。

# php - Magento 的当前用户？

> ID：416553
> 
> 赞同：57
> 
> 时间：2009-01-06T13:43:42.837
> 
> 标签：php, magento

我正在自定义产品视图页面，我需要显示用户名。如何访问当前用户的帐户信息（如果他已登录）以获取名称等？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-01-16T22:51:18.563

在“app/code/core/Mage/Page/Block/Html/Header.php”下找到：

```
public function getWelcome()
{
    if (empty($this->_data['welcome'])) {
        if (Mage::app()->isInstalled() && Mage::getSingleton('customer/session')->isLoggedIn()) {
            $this->_data['welcome'] = $this->__('Welcome, %s!', Mage::getSingleton('customer/session')->getCustomer()->getName());
        } else {
            $this->_data['welcome'] = Mage::getStoreConfig('design/header/welcome');
        }
    }

    return $this->_data['welcome'];
} 
```

所以看起来`Mage::getSingleton('customer/session')->getCustomer()`会得到你当前登录的客户；）

获取当前登录的管理员：

```
Mage::getSingleton('admin/session')->getUser(); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-02-27T18:08:53.690

看看辅助类：**Mage_Customer_Helper_Data**

要简单地获取客户名称，您可以编写以下代码：-

```
$customerName = Mage::helper('customer')->getCustomerName(); 
```

有关客户的实体 ID、网站 ID、电子邮件等的更多信息，您可以使用**getCustomer**函数。以下代码显示了您可以从中获得什么：-

```
echo "<pre>"; print_r(Mage::helper('customer')->getCustomer()->getData()); echo "</pre>"; 
```

从 helper 类中，您还可以获取有关客户登录 url、注册 url、注销 url 等的信息。

从帮助类中的**isLoggedIn**函数中，您还可以检查客户是否已登录。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-12-16T09:20:53.060

您可以通过以下方式从会话中获取当前登录客户名称：

```
$customer = Mage::getSingleton('customer/session')->getCustomer(); 
```

这将返回当前登录客户的客户详细信息。

现在您可以通过使用获取客户名称`getName()`

```
echo $customer->getName(); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-12-12T16:45:39.120

对于电子邮件使用此代码

```
$email=$this->__('Welcome, %s!', Mage::getSingleton('customer/session')->getCustomer()->getEmail());

echo $email; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-09-23T11:46:26.063

```
$customer = Mage::getSingleton('customer/session')->getCustomer();
    $customerAddressId = Mage::getSingleton('customer/session')->getCustomer()->getDefaultBilling();
    $address = Mage::getModel('customer/address')->load($customerAddressId);
    $fullname = $customer->getName();
    $firstname = $customer->getFirstname();
    $lastname = $customer->getLastname();
    $email = $customer->getEmail();
    $taxvat = $customer->getTaxvat();
    $tele = $customer->getTelephone();
    $telephone = $address->getTelephone();
    $street = $address->getStreet();
    $City = $address->getCity();
    $region = $address->getRegion();
    $postcode = $address->getPostcode();

```

获取客户默认账单地址

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-06-21T17:04:45.650

对于用户名与一些修改相同：

```
$user=$this->__('Welcome, %s!', Mage::getSingleton('customer/session')->getCustomer()->getName());
echo $user; 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-07-22T07:30:04.027

通过以下方式，您可以访问登录用户的所有信息。

```
$customer_data=Mage::getSingleton('customer/session')->getCustomer();

echo "<pre>" print_r($customer_data); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-11-12T00:02:09.130

这边走：

```
$email = Mage::getSingleton('customer/session')->getCustomer()->getEmail();
echo $email; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-12-16T07:47:55.613

简单地，

```
$current_customer = $this->_getSession()->getCustomer(); 
```

这将返回客户对象，然后您可以从此客户对象中获取所有详细信息。

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2009-01-06T13:50:27.423

我不知道这一点，但在用户登录后查看显示用户名等的文件中的页面标题。如果您打开模板提示可能会有所帮助（请参阅[this教程](http://www.vimeo.com/1067069?pg=embed&sec=1067069)。

当您找到诸如 之类的行时`"Hello <? //code for showing username?>"`，只需复制该行并将其显示在您需要的位置

# c# - 远程对象上的 DynamicInvoke 是否异步工作？

> ID：416564
> 
> 赞同：2
> 
> 时间：2009-01-06T13:47:37.803
> 
> 标签：c#, vb.net, multithreading, delegates, remoting

我继承了一些我想在这里理解的主要意大利面条代码（组合 C#/VB）。

这似乎是一个非常奇怪的情况，其中有两个连续调用来触发远程对象的事件，这是通过调用委托的 DynamicInvoke 方法来完成的，形式如下：

```
delegate1.DynamicInvoke(args1);
// some code here
delegate2.DynamicInvoke(args2); 
```

delegate1 和 delegate2 都引用同一个远程“订阅者”对象中的方法。

根据我在[文档](http://msdn.microsoft.com/en-us/library/system.delegate.dynamicinvoke.aspx)中可以阅读的所有内容，DynamicInvoke 看起来应该是同步的。但是我可以看到，当我在远程进程中设置断点时，delegate1 和 delegate2 引用的方法在不同的线程中**同时运行。**

这是另一个微软“未记录的功能”吗？我应该预料到这一点吗？关于为什么会这样的任何解释？如果它打算异步运行，DynamicInvoke 怎么会有返回值呢？

谢谢！绍尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T14:15:29.683

DynamicInvoke is definately a synchronous operation. The problem though is that the delegate it points to make not be synchronous. For instance the following code will call Console.WriteLine() in an asynchronous fashion.

```
Action write = () => Console.WriteLine("foo");
Action del1 = () => { ThreadPool.QueueUserWorkItem(write); }
...
del1.DynamicInvoke(); 
```

del1 will be executed synchronously but it will create an asynchronous work item.

I would look for the code the delegate is executing and see if they are doing some asyc magic under the hood.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T15:41:07.857

我的主要建议是仔细检查两个进程中的调用堆栈。

您的“意大利面条”代码是否可能实际上有一个回调。你的第一个委托调用你的远程进程，它回调，你的第二个委托是从嵌套回调中调用的？

# sql-server-2005 - 多对多关系中的查询示例

> ID：416565
> 
> 赞同：10
> 
> 时间：2009-01-06T13:47:46.527
> 
> 标签：sql-server-2005, many-to-many

哇，很难找到这个话题的简单解释。简单的多对多关系。

三个表，tableA、tableB 和一个联结 tableA_B。

我知道如何用键和所有东西建立关系，但是当执行 INSERT、UPDATE 和 DELETE 查询时我有点困惑......

基本上，我正在寻找的是一个示例，它显示：

1.  如何根据TableB中的ID获取TableA中的所有记录

2.  如何根据TableA中的ID获取TableB中的所有记录

3 如何在 TableA 或 TableB 中插入，然后在联结表中进行适当的插入以建立连接..

我不是在寻找特定项目的解决方案，只是一些可以应用的一般示例。也许你周围有东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T14:12:56.817

我要做的第一件事是推荐使用像[Linq-To-Sql](http://msdn.microsoft.com/en-us/library/bb425822.aspx)或[NHibernate](http://www.hibernate.org/343.html)这样的 ORM ，这将为您提供数据模型的对象表示，从而使处理多对多 CRUD 操作等复杂事情变得更加简单。

如果 ORM 不是您的工具集的一部分，那么这就是它在 SOL 中的外观。

```
用户 UserAddresses 地址
======= =======================
身份证 身份证 身份证
名字 UserId 城市
姓氏 地址 ID 状态
                              压缩

```

我们的表是这样连接的：

```
   用户.Id -> UserAddresses.UserId
   Addresses.Id -> UserAddresses.AddressId

```

*   基于 Addresses.Id 的用户中的所有记录

```
选择用户。*
FROM 地址 INNER JOIN
                         UserAddresses ON Addresses.Id = UserAddresses.AddressId INNER JOIN
                         用户在 UserAddresses.UserId = Users.Id
哪里（地址.Id = @AddressId）

```

*   基于 Users.Id 的 Addresses 中的所有记录

```
选择地址。*
FROM 地址 INNER JOIN
                         UserAddresses ON Addresses.Id = UserAddresses.AddressId INNER JOIN
                         用户在 UserAddresses.UserId = Users.Id
WHERE (Users.Id = @UserId)

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T14:00:39.400

```
SELECT *
FROM a
WHERE id IN (SELECT aid FROM ab WHERE bid = 1234) 
```

或者

```
SELECT a.*
FROM a
JOIN ab ON a.id = ab.aid
WHERE ab.aid = 12345 
```

要插入，这取决于您的数据库（例如，主键是来自序列、自动生成还是以其他方式生成，或者只是复合键）。但你只需要：

对于该数据：

```
INSERT INTO a VALUES (...) 
```

对于关系：

```
INSERT INTO ab VALUES (...) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T15:05:00.923

要根据 B 中的键获取表 A 中的所有记录，用英语表示，您希望表 A 中的记录具有与该表 B 键的连接记录（假设表 A_B 有两个外键列，（TabAFK 和 TabBFK）

```
 Select * from TableA A
  Where pK In (Select Distinct TabAFK From tableA_B
                Where TabBFK = @TableBKeyValue) 
```

其他方向也一样

```
 Select * from TableB B
  Where pK In (Select Distinct TabBFK From tableA_B
                Where TabAFK = @TableAKeyValue) 
```

要插入新记录，请根据需要在 TableA 和 TableB 中进行正常插入...插入连接表 (tableA_B) 只是两个主表中的两个 pk

```
 Insert TableA (pk, [other columns]) Values(@pkValue,  [other data)
   Insert TableB (pk, [other columns]) Values(@pkValue,  [other data) 
```

* * *

-- 然后为每个存在的关联插入联接表...

```
 Insert tableA_B (TabAFK, TabBFK)  Values(@PkFromA,  @PkFromB) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T14:02:10.567

1) select tableA.* from tableA join tableA_B on tableA.id = tableA_B.idA where tableA_B.idB = somevalue

2) select tableB.* from tableB left join tableA_B on tableB.id = tableA_B.idB where tableA_B.idA = somevalue

3）insert取决于你的数据库，但是insert into a，insert into b，再insert into a_b；即使对表格有限制，它也应该以这种方式工作。

提示：不要将 IN 运算符用于 1/2

# ssis - 有人可以解释一下数据挖掘、SSIS、BI、ETL 和其他相关技术吗？

> ID：416566
> 
> 赞同：9
> 
> 时间：2009-01-06T13:47:55.590
> 
> 标签：ssis, business-intelligence, data-mining

昨天我和一位同事讨论了他使用 SSIS（或类似的东西）用 SSIS 包做一些非常酷的事情的情况，他通过了一个名字，比如“雷金纳德·威廉姆斯博士”。并且基于一些加权方案，系统足够聪明，可以弄清楚如何对其进行标记并将其存储在数据库中作为“Salutation-First Name-Last Name-Suffix”。他抛出了一些流行词，比如 BI、SSIS、ETL 和数据挖掘。我真的很想了解更多信息，但我什至不知道从哪里开始询问。

我是一名 .Net 开发人员，精通 C#、Vb.Net、WPF 等...，但我不知道这些技术是什么，如何将它们添加到我的技能中，以及它是否是我真的应该专注于。任何方向都会有所帮助。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-06T14:09:41.223

SSIS == SQL Server Integration Services，它是一个提取转换和加载 (ETL) 工具，它是 SQL7、SQL2K 时代的数据转换服务或 DTS 的卓越实现。它是表达工作流过程的绝佳工具，其中数据从 A 点移动到 B 点（以及 c 和 d 等）并通过该过程进行更改，例如整合到非规范化设计或数据清理。

BI 或商业智能是科技界整个类别的绰号，它是现在的好地方。BI 技能非常有价值且很难获得，原因之一是很难在实验室中重新创建真正的 BI 案例，因此教学几乎总是在真实世界的情况下进行。

从高层次上看，BI 项目通常涉及报告的终点。通常，作为开发人员，我们习惯于编写事务性报告，例如 PO 的详细信息，但 BI 可以进入涵盖数十年产品销售趋势并处理数亿条记录的非常广泛的报告。我们为应用程序设计数据库的方式对于这种报告并不理想，因此发明了其他工具和技术并在 BI 空间中使用。这些就是您经常听到的称为 OLAP 多维数据集的多维数据集。OLAP 多维数据集通常源自一个数据仓库，该数据仓库只不过是另一个数据库——但典型的仓库包含来自多个（通常是几十个）其他应用程序数据库的数据。您的库存应用程序、采购应用程序、HR 应用程序和一大堆其他应用程序都包含创建业务完整图景的点点滴滴的数据，BI 架构师将使用 SSIS 之类的工具从所有这些系统中提取数据，对其进行处理并将其存储在数据仓库中它采用不同类型的设计来更好地进行报告。一旦数据进入仓库，他将使用分析服务在该数据上创建多维数据集，并使用 Reporting Services 之类的工具向您显示有关该数据的报告。

编辑：抱歉，忘记了数据挖掘，它是另一个描述和概念或过程的非特定术语，而不是工具。在一个简单的例子中，它是一种识别数据模式的有条不紊的方法。过去，一个好的业务分析会通过数据查看趋势，但是对于现代数据库，您所谈论的数据集太大而无法手动梳理 - 数据挖掘允许您指示计算机梳理这些数据并识别感兴趣的模式.

希望有帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T14:13:58.140

您的同事所做的可能更好地描述为字符串的“智能解析”。这可以在许多复杂级别上完成——例如，使用统计模型给你“博士”的可能性。是称呼而不是名字。或者它可以只使用常见称呼的简单查找列表，在这种情况下，它只是常规的程序代码，仅此而已。

SSIS 是 SQL Server 集成服务的缩写。它基本上是类固醇上的[DTS ；](http://en.wikipedia.org/wiki/Data_Transformation_Services)有些人喜欢它，有些人讨厌它。单独使用它来做你正在谈论的那种事情会很棘手；它主要只是用于从各种来源获取数据并将其组合，转换并将其加载到其他地方。它可以做一些漂亮的事情，其中​​许多往往是数据挖掘之类的，但最终它是一种用于在一个方向或另一个方向填充数据的生产工具。它在数据挖掘社区中并不是特别受尊重。

[数据挖掘](http://en.wikipedia.org/wiki/Data_mining)是一门完整的学科，专注于使用一些（通常是大量的）数据来预测未来的答案或更好地理解现有数据中的模式。这绝对是一个很好的领域，但如果没有对数学和算法的深入研究，你就不能随便学。[这本是一](http://www-users.cs.umn.edu/~kumar/dmbook/index.php)本关于这个主题的好书。

“商业智能”实际上更像是一个流行词，而不是一种特定的技术，对不同的人来说可能意味着不同的东西。从根本上说，这个想法建议对业务数据做一些不那么愚蠢的事情，通常它指的是随着时间的推移分析趋势，通常使用 OLAP。它可能还包括数据挖掘或人工智能算法，但由于没有严格的定义，几乎任何想卖给你东西的人都会告诉你它提供“商业智能”，并希望你不要进一步挖掘。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T14:05:31.247

SSIS 是[SQL Server 集成服务，可用于执行 ETL（提取、转换和加载），这是许多数据仓库/](http://en.wikipedia.org/wiki/SQL_Server_Integration_Services)[商业智能](http://en.wikipedia.org/wiki/Business_intelligence)解决方案的前端，这些解决方案将数据集成到易于使用的维度模型中。SSIS 对于较小的项目也很有用，它是一种从其他存储库或文件加载旧数据或数据的便捷方式。

[数据挖掘](http://en.wikipedia.org/wiki/Data_Mining)通常意味着使用来自集成源的数据来推断交易数据中不明显的信息（通过集成多个源为数据提供更多“维度”。

BI 是一个很大的话题，所以除非你想进入那个领域，否则它可能不是值得关注的东西，但是 SSIS 在较小的项目中很有用，无论如何都值得学习。

# .net - .NET 解决方案下的部署工具

> ID：416573
> 
> 赞同：7
> 
> 时间：2009-01-06T13:48:16.010
> 
> 标签：.net, deployment, automated-deploy

我们都使用 Web 应用程序、Windows 应用程序、数据库、帮助文件、配置文件和注册表值编写代码，小型（如一个 .exe）或大型应用程序（完整解决方案）......

我的问题很简单，在我看来，现在我需要在一个安装设置中部署一个 Web 应用程序和一个 Windows 应用程序：

> 你用什么来部署你的应用程序，关于创建**帮助文件**，数据库脚本，以便我们可以**创建数据库和表**，为 Web 应用程序创建一个**虚拟目录，添加****注册表值**以使用我们的 Windows 应用程序？

我只是从 Visual Studio 2008 打开 Setup & Deployment，但是我还是它缺少很多这样的功能？有什么最糟糕的尝试吗？

我知道他们在公司使用的[Inno Setup](http://www.innosetup.com/)，但它并不能全部完成，我应该看看有什么好的教程吗？在我的搜索中，我在[Visual Studio Gallery中找到了](http://www.visualstudiogallery.com/)[一些产品](http://www.visualstudiogallery.com/Results.aspx?CategoryId=3f790e6a-d276-4f61-9f44-e99dda83288c)，但没有一个是一体的 :(

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-12T05:40:50.350

我写了一篇非常详细的博客文章，使用 TeamCity 和 Web 部署项目来自动化构建和部署，作为初学者在这里：

[http://www.diaryofaninja.com/blog/2010/05/09/automated-site-deployments-with-teamcity-deployment-projects-amp-svn](http://www.diaryofaninja.com/blog/2010/05/09/automated-site-deployments-with-teamcity-deployment-projects-amp-svn)

然后我添加到此以显示 FTP 添加

[http://www.diaryofaninja.com/blog/2010/09/21/continuous-integration-tip-1-ndash-ftp-deployment](http://www.diaryofaninja.com/blog/2010/09/21/continuous-integration-tip-1-ndash-ftp-deployment)

一个基本的流程非常简单：

*   使用我从我的 SVN 存储库下载的 teamcity 构建服务器
*   我构建站点并将其部署到构建服务器上的本地文件夹
*   我启动了一个支持脚本的命令行 FTP 客户端，称为
*   WinSCP 使用 MSBUILD 任务执行 ( [http://winscp.net/](http://winscp.net/) )
*   上传我的所有网站内容
*   有[插入饮料]的选择

然后，我确保我只部署我的 SVN 存储库的主干，并在合并之前开发和测试分支中的所有内容 - 这样只有经过测试的东西才会被部署。将自动化测试添加到您的构建周期中，您将获得天作之合。

一些很棒的免费工具是：

*   [Visual Studio Web 部署项目](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=89F2C4F5-5D3A-49B6-BCAD-F776C6EDFA63&amp%3Bdisplaylang=en)
*   [TeamCity（对 20 个以下的构建配置免费）](http://www.jetbrains.com/teamcity/)
*   [竹子](http://www.atlassian.com/software/bamboo/)

一些提供此功能的非免费在线服务：

*   [OnCheckin 持续部署](https://oncheckin.com)
*   [应用港](https://appharbor.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T14:02:51.517

我强烈推荐[NSIS ，你可以在](http://nsis.sourceforge.net/Main_Page)[论坛](http://forums.winamp.com/forumdisplay.php?s=&forumid=65)上得到很多帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T14:12:17.537

如果您自残，您可以查看 WiX ( [http://wix.sourceforge.net](http://wix.sourceforge.net) )。WiX 被微软的一些产品团队使用，实际上由微软员工维护，但它几乎是他们在 SourceForge 上唯一的开源项目。

它非常强大，并且具有可以做任何你想做的事情的功能，但它都是用 XML 完成的，而且开始起来可能有点棘手。好的一面是，一旦设置好，它就会与自动构建集成，因为它支持在 Visual Studio 内部（MSBuild 支持）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T13:53:36.857

我们在这里使用[FinalBuilder](http://www.finalbuilder.com/)和 FinalBuilder 服务器。允许您使用相对较好的构建界面构建复杂的构建过程，并从 Web 应用程序或计时器启动它们。

我们的“普通”项目将从 SVN 获取源代码，将修订号添加到版本并构建，获取数据库脚本并升级或重建数据库并部署到网络服务器，将其压缩以发送电子邮件，甚至为其创建 ISO .

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T14:16:01.227

过去，设置和部署项目为我提供了很好的简单设置，例如创建虚拟目录和打包文件（如文档等）。

如果您想要更多功能，请查看[WIX](http://wix.sourceforge.net/)

# c# - 如何在我希望指定其身份的地方插入带有 Linq To SQL 的实体 - 例如，在创建数据库时预填充表？

> ID：416581
> 
> 赞同：0
> 
> 时间：2009-01-06T13:50:18.440
> 
> 标签：c#, .net, linq-to-sql, identity

我正在编写一个使用 LinqToSql 进行数据访问的产品。在我们快速发展的同时，模型经常发生变化。这意味着我们在开发时会大量转储和重新加载数据库。因此，每次都涉及重新创建基线数据的开销。

恢复数据库备份的过程没有用，因为我们需要经常更新模型数据库；相同的开销（我认为，无论如何）。

所以，我想使用 DataContext.CreateDatabase，然后从 CSV 文件中提取一些数据。美好的。但我也想缝合关系，这意味着，理想情况下，提前知道主键是什么（否则，鉴于某些身份是 GUID，很难缝合我需要的链接）。

`SET IDENTITY_INSERT IdentityTable ON`Linq To SQL 中的（和 OFF）等价物是什么？有吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T16:26:37.180

你不需要提前知道主键，你只需要知道关系。

假设您要加载客户和订单，其中客户有许多订单。

首先将文件中的客户加载到内存中，使用文件中的假主键值作为 CustomerId（此值稍后将被数据库自动生成的值替换）。

```
Dictionary<int, Customer> customers = LoadCustomersFromFile(); 
```

其次，将您的订单从文件加载到内存中。对 OrderId 使用虚假的主键值。重新使用那些虚假的 CustomerId 来建立关系。将订单添加到其相关客户。

```
Dictionary<int, Order> orders = LoadOrdersFromFile();
foreach(Order o in orders.Values)
{
  customers[o.CustomerId].Orders.Add(o);
} 
```

对象图构造完成后，InsertOnSubmit 所有对象。

# project-management - 您如何将发布日期传达给客户？

> ID：416589
> 
> 赞同：2
> 
> 时间：2009-01-06T13:52:02.477
> 
> 标签：project-management

作为一个开发团队，我们（内部）承受着很大的压力，需要向我们的客户提供准确的发布日期。我们应该怎么做呢？

我们看到的问题在于准确定义每个版本所需的内容，并且不知道我们的优先级在发布期间可能会如何变化。我们正在使用 FogBugz 并认为我们可以利用基于证据的调度来帮助解决不确定性，但我们不希望我们的客户对置信度范围感到非常满意。

我看到 Fog Creek 有一项政策，即在实际完成之前不告诉客户什么时候可以发布。还有其他人采用这种方法吗？

编辑：感谢您的回复 - 很难选择一个接受的答案，所以我投票了其中一些给你业力。我选择了cowgod's作为我想要处理我们自己的发展的方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T14:02:56.743

对于我目前正在进行的项目，我们每周都会提供生产版本和质量保证 (QA) 版本。如果 QA 已批准前一周的部署，则该部署将投入生产，我们最新的错误修复和功能请求将打包发布给 QA。我们无限期地继续这个过程。

我们有一个文档 Wiki，它使用客户端能够查看的最新版本说明进行更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T14:21:27.970

只是给出一个不同的观点：

**我们得到了发布日期**！

对于大型企业，您只能在周末发布内部产品，这意味着您很快就会了解到：

a/ 其中只有 52 个
b/保留其中一个的竞争*非常*激烈（物流团队是竞争对手之一，用于服务器和/或网络升级，并阻止任何发布到生产中，因为服务器可以随时关闭）

所以我们没有发布日期的选择：我们一年只有几个，而且它们不太可能改变。

为了仍然提供有意义的发布，我们在发布日期前几周定义了一次“顶级内容”会议，以定义发布的*实际*内容（一些当前的开发不会包含在其中，因为事实证明它们也是复杂，或依赖于未准备好的其他部分，或任何其他“优先级”更改）

然后，发布经理确保所有团队在所有认证/UAT/预生产测试周期的测试环境中合并选定的开发。（我在这里跳过了很多细节）

然后我们交付。准时。（然后做一些补丁；））

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T14:02:44.623

如果您有压力让客户知道您何时发布，您可能会尝试一些 XP 技术，例如让客户决定他们首先想要哪些功能并进行 TDD。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T14:42:59.847

当我参与的项目准确地说明了发布日期时，我们通过将功能划分为“此版本必不可少”和“可以滑到下一个版本”来做到这一点，然后选择一个发布日期，这样我们就可以很舒服，我们可以完成所有必要的功能，并认为至少有一些机会完成所有非必要的功能。

当然，这反而提出了一个问题，为什么我们还要考虑无关紧要的功能，但在实际项目中，通常有几件事情可以朝一个方向或另一个方向移动，这取决于 (a) 客户是否了解提议的功能，如果喜欢，他们是否喜欢，(b) 预计下一个版本的发布时间以及客户升级的难易程度，(c) 您的业务计划如何分别受到可销售的影响现在的产品，或者明年的终极产品。

所以实际发生的是三个类别，“必要且预计将保持必要：如果不按时完成，我们将被迫延迟发布”，“目前被视为必不可少，但随着发布日期的临近，我们可能会改变主意”和“暂时不考虑这个版本，但如果时间允许，我们会推进它”。

不过，我参与的许多项目已经运行了很长时间，临时版本基本上是当前工作版本的快照。说你“给出了一个准确的发布日期”感觉像是在作弊，当实际发生的是客户要求更新时，你检查了该客户的活动错误列表，发现你有两个影响他们的突出问题，认为修复两者并进行验证需要一周的时间，并告诉他们“我们将在 1-2 周内给你一个下降”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T00:13:21.830

作为最经常要给出雾溪答案的人，我可以说我们[的闭嘴](http://www.joelonsoftware.com/articles/MouthWideShut.html)政策非常聪明，但需要一些管理。几个月来，在管理层的祝福下，我想出了一些对我有用的东西，让我不觉得自己是某个即将离任的总统政府的阻挠成员，并有助于为客户提供一些背景信息，而不会做出潜在的误导性承诺。

这是让客户知道我们在这个过程中所处的位置的问题。现在，我通常让他们知道我们现在正在积极编码，一旦我们完成代码，这还有一段路要走，我们仍然需要进行质量检查、错误修复、质量检查和错误修复，至少还有几个的贝塔。

如果您向我询问 FogBugz 7 的发布日期，您可能会得到以下示例：

对于 FogBugz 7，我们正在积极编码，但代码完成还需要一段时间。如果您有一个您担心的特定问题，请告诉我，我会尽力向工程师强调它，或者如果我们有一个状态，请给您一个状态。一旦我们进入代码完成阶段，我们仍然需要完成 QA、错误修复、重新 QA 和 beta 的过程。我们很高兴让您知道我们是否在每一步都处于此过程中，因此您可以跟踪我们的进度，但我们无法确定该过程何时完成。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T13:59:26.300

我们采取在完成之前不宣布发布日期的方法。如果客户更早需要它，那么我们会解释它的哪些部分已经完成，哪些尚未完成。有时他们只接受一个核心功能集，如果它是真正重要的功能，并且愿意等待其他功能。但根据我的经验，他们通常希望等到整个事情完成后再发布。

我很幸运碰巧身处一种文化中，我们没有太大的压力来提前知道我们何时发布。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T14:01:19.663

谷歌也这样做，但没有提供发布日期。

在一个项目中，关于版本，您可能会因以下三个因素而有所不同：

*   时间
*   金钱/资源
*   特征数量

关于它们的所有常规是/但是/如果（及时添加额外资源自然对您的项目没有帮助）。

如果您有固定的发布日期，则时间是固定的。这样，您只有在改变其他两种方式时才能正确管理您的项目：花费更多，或限制产品中的功能数量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T14:06:04.257

我们不提供日期。我们只是询问他们何时可以测试我们的版本。（这通常给了我们足够的时间来总结，因为没有人想测试，而且他们都有自己的工作要做。）

# wpf - 如何连接到 WPF 树视图的 BeforeNodeExpand 和 AfterNodeExpand？

> ID：416593
> 
> 赞同：3
> 
> 时间：2009-01-06T13:53:08.683
> 
> 标签：wpf, treeview

**意图：在填充节点的子节点的持续时间内显示忙/等待光标。**

似乎隐藏在 WPF 中。我记得在 Winforms Tree Control 中有某种事件，您可以在其中订阅 - 来实现这一点。

目前我有一个 TreeView，它有许多与其 SelectedItem 相关的列表视图。所有控件都是数据绑定的，并使用 DataTemplates 来显示项目。代码是功能性的。但是当我展开一个有很多子节点的树节点时，UI 变得迟缓.. 看起来点击没有注册.. 而我作为不耐烦的用户去 clickety-click 节点。

那么我该怎么做呢？我想将光标设置为在 BeforeExpand 中等待并在 AfterExpand 中重置。

代码涂鸦：

```
<HierarchicalDataTemplate DataType="{x:Type local:LinqToSqlNodeClass}" ItemsSource="{Binding Path=Children}">
  // visual representation
</HierarchicalDataTemplate>
// more typed data templates 

<TreeView ItemsSource="{Binding Path=Nodes}" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T23:32:46.983

ItemContainerGenerator 将在 Expanded 事件之后开始生成，因此您可以使用它来设置 Cursor，并在[ItemContainerGenerator.StatusChanged](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemcontainergenerator.statuschanged(VS.85).aspx)触发时将其设置回来以指示您的孩子已被填充。

由于[TreeViewItem.Expanded](http://msdn.microsoft.com/en-us/library/system.windows.controls.treeviewitem.expanded(VS.85).aspx)是一个路由事件，您可以在某个父级别订阅：

```
myTreeView.AddHandler(TreeViewItem.ExpandedEvent, new RoutedEventHandler(TreeViewItemExpanded)); 
```

TreeViewItemExpanded 在其他地方定义，如下所示：

```
private void TreeViewItemExpanded(object sender, RoutedEventArgs e)
{
    // we will only go through with this if our children haven't been populated
    TreeViewItem sourceItem = e.OriginalSource as TreeViewItem;
    if ((sourceItem != null)
        && (sourceItem.ItemContainerGenerator.Status != GeneratorStatus.ContainersGenerated))
    {
        // create a handler that will check our children and reset the cursor when the ItemContainerGenerator has finished
        EventHandler itemsGenerated = null;
        DateTime before = DateTime.Now;
        itemsGenerated = delegate(object o, EventArgs args)
        {
            // if the children are done being generated...
            if ((o as ItemContainerGenerator).Status == GeneratorStatus.ContainersGenerated)
            {
                (o as ItemContainerGenerator).StatusChanged -= itemsGenerated;  // we're done, so remove the handler
                sourceItem.Dispatcher.BeginInvoke(DispatcherPriority.DataBind, (ThreadStart)delegate    // asynchronous reset of cursor
                {
                    myWindow.Cursor = Cursors.Arrow;    // reset cursor
                    Debug.WriteLine("Expanded in " + (DateTime.Now - before));
                });
            }
        };
        sourceItem.ItemContainerGenerator.StatusChanged += itemsGenerated;  // add the handler
        myWindow.Cursor = Cursors.Wait;     // wait cursor
    }
    e.Handled = true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T15:19:52.703

**编辑 -**完成此操作的唯一方法是创建一个派生自 TreeViewItem 的类并覆盖 OnExpand 并在调用基础扩展之前设置一个新的扩展路由事件。然后，您将使用这个新类作为您的容器，而不是默认的 TreeViewItem。

然后你可以做类似的事情

```
<TreeView cust:CustomTreeViewItem.Expanding="TreeView_Expanding">....</TreeView> 
```

**上一个答案....**

我唯一能看到你使用的是[TreeViewItem上的](http://msdn.microsoft.com/en-us/library/system.windows.controls.treeviewitem.aspx)[Collapsed](http://msdn.microsoft.com/en-us/library/system.windows.controls.treeviewitem.collapsed.aspx)和[Expanded](http://msdn.microsoft.com/en-us/library/system.windows.controls.treeviewitem.expanded.aspx)事件。

您必须更改模板以使用 TreeViewItem，并定义事件。

这对您的目的有用吗？

# c# - 在 Windows XP 上，如何枚举系统显示的所有窗口（C#）

> ID：416600
> 
> 赞同：0
> 
> 时间：2009-01-06T13:54:34.123
> 
> 标签：c#, windows

我想最终得到所有可见（包括最小化）窗口的列表（或数组或其他）。

我发现了 2 个类似的问题，但这些问题并不能*完全*说明我在寻找什么：
-[找出 alt-tab 列表中的](https://stackoverflow.com/questions/210504/enumerate-windows-like-alt-tab-does)
窗口 -[列出另一个用户会话中的窗口](https://stackoverflow.com/questions/308135/how-can-i-enumerate-the-open-windows-enumwindows-of-another-user-session)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T14:08:02.070

I think that the blog entry by Raymond Chen pointed to in the first link gives you an idea of where you want to go. Basically, you would call EnumWindows and then apply that algorithm, except that you would take note of every window handle that is visible.

The question is a little vague, what is the purpose here (there might be a better way given more info).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T14:07:47.687

How about this to get a list of processes that would go into the alt-tab list. (Running processes that contain a window):

```
using System.Diagnostics.Process; 

List<Process> plist = new List<Process>();            

foreach (Process p in Process.GetProcesses())
{
 string title = p.MainWindowTitle;
 if (!String.IsNullOrEmpty(title))
 {
     plist.Add(p);
 }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T17:24:46.370

只需使用 EW() api（win32 常见问题解答）

# .net - 如何分析已部署给客户的 .NET 应用程序的性能？

> ID：416613
> 
> 赞同：3
> 
> 时间：2009-01-06T13:57:00.237
> 
> 标签：.net, winforms, deployment, profiler, dottrace

我有几个客户，我的 WinForms 应用程序在其他客户中的表现不如其他客户。我在办公室使用 JetBrain 的 dotTrace，但这并不能帮助我找到客户机器上的瓶颈。如何分析已部署给客户的 .NET 应用程序的性能？是否有任何带有可再分发组件的分析工具，可以让我生成无法使用的分析结果，直到我将结果（dotTrace 中的快照）带回完整的分析工具？

**更新：**由于[NProf](http://nprof.sourceforge.net/Site/Description.html)可以自由分发，我正在考虑将其部署到客户的工作站。我将在这里报告结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T16:09:08.317

我不熟悉 dotTrace，但我在 Visual Studio 的上下文中使用了 Visual Studio 2008 检测和分析工具，我相信它们是随 .NET 3.5 SDK 一起分发的。

VSInstr.exe 工具： http: [//msdn.microsoft.com/en-us/library/ms182402.aspx](http://msdn.microsoft.com/en-us/library/ms182402.aspx) 将检测部署的二进制文件。

VSPerfCmd： http: [//msdn.microsoft.com/en-us/library/ms182403.aspx](http://msdn.microsoft.com/en-us/library/ms182403.aspx) 可以从检测的应用程序中捕获性能数据。

我从来没有直接从命令行单独完成，所以我不能在那里为你提供太多帮助，但我认为这是你的另一个选择，至少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T16:11:01.680

所以我认为您可能需要一些衡量效果广告部署时间的方法。尽管它们很不优雅，但我可能会考虑将性能计数器添加到您的应用程序中。请参阅[System.Diagnostics](http://msdn.microsoft.com/en-us/library/system.diagnostics.aspx)。我已经广泛使用它来监视部署中的应用程序。我发现分析器虽然很棒，但有时会因为开销而隐藏某些问题。例如，如果您的应用程序遇到数据库并且磁盘很慢导致查询花费更长的时间，这在分析器中可能不明显，因为应用程序通常运行速度较慢。

对于客户端，如果您的应用在安装时不需要管理访问权限，我可能会将性能计数器作为“诊断模式”的一部分，因为安装它们需要管理员访问权限。您可能希望使用性能计数器来测量诸如数据库和服务调用的持续时间、可以增长的数据结构的大小以及发生的故障数量等。

我们已经知道您的代码可以正常工作，因为在某些客户设置上它可以正常工作。因此，请考虑在您的应用程序中添加仪器。这是编写可靠软件（如良好的日志记录）的那些乏味的赌注重要元素之一。这不好玩，但在我看来，它需要完成。它通常是唯一能让您了解应用程序在部署中所做的事情的方法。我正在处理的当前应用程序从 Rev 1 中的大约 20 个 perf 计数器增加到 Rev 2 中的大约 150 个。我不会一直监控它们中的大多数，但是为了提醒我性能和可靠性问题，它们非常值得花时间.

# delphi - 将 COM-DLL 从 Delphi 2007 移植到 Delphi 2009 后，如何诊断发生在 COM-DLL 中的内存损坏错误？

> ID：416614
> 
> 赞同：3
> 
> 时间：2009-01-06T13:57:16.193
> 
> 标签：delphi, debugging, memory-management, delphi-2009

我刚刚将我们的几个自制 Outlook COM 插件从 Delphi 2007 移植到 Delphi 2009，现在遇到了一些非常奇怪的错误（在你问之前：这些错误似乎都与字符串处理没有任何明显的关系），例如当一个人试图第二次调用它们时挂起 Outlook 的模态对话框（第一次似乎一切都很好），但只有当它们从一个特定的事件处理程序调用而不是在其他地方做同样的事情时才会挂起。当我将错误跟踪到特定的代码行并注释掉该行或用不同的代码替换它以达到相同的效果时（例如，通过将否则将通过函数直接调用的代码复制到调用站点），将出现错误走开——通常只是在以后再次出现一些（同样不显眼的）陈述。

在 Delphi 调试器中运行它时，我可以看到冻结通常在`GetMem.inc`. 至少所有这些问题都是 100% 可重现的……

不用说我们在 Delphi 2007 中编译这些插件时没有这些问题。

现在，我很茫然。我知道我很幸运，但即使我认为自己是一个相当有经验的程序员（虽然主要是在小众领域），但我以前从未真正处理过这类错误。正如这个问题的标题所说，我什至不知道从哪里开始。我可以随心所欲地单步执行代码，但无休止的汇编语句对我来说毫无意义，而且我也不擅长有效地使用 CPU 视图。

此外，我什至不确定这是否是我自己的代码开始的问题（在这种情况下，我实际上倾向于怀疑它）。我们正在大量使用许多第三方库（例如 JCL、ADX、Redemption）。特别是 ADX 仍将其 Delphi 2009 支持标记为“测试版”。

我也尝试使用 FastMM 的 FullDebugMode 并且确实以这种方式在 ADX 中发现了一些错误（例如，在被释放后被修改的块）但是所有这些也发生在我使用 Delphi 2007 编译时，所以它似乎还不是必须的这些最终是观察到的回归的原因。

那么，我该如何处理呢？- 或者更好：我在哪里可以找到一些学习如何处理这个问题的好资源？例如，关于使用 CPU 视图的教程或有效解释和执行 FastMM 报告的教程？这些是正确的工具吗？我还应该去哪里看？

**附录：**
在这种情况下我应该怀疑哪些类型的代码？什么样的代码甚至有可能在内存中造成如此严重的破坏？我能想到的唯一地方是我的代码执行任何远程接近显式内存操作的地方是在准备 WinAPI 调用时保留一些缓冲区空间。还要记住，我的所有代码在 Delphi 2007 和 Delphi 2009 版本之间都是相同的，而 Delphi 2007 版本没有出现此类问题。

**更新：**
很有可能促使我发布这个问题的问题现在已经解决了。请参阅下面我自己的答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T14:40:50.037

获得解决方案的最佳工具可能是内存断点。

调试内存损坏是很痛苦的，所以首先尝试让你的生活尽可能简单：找到一个精确的、保证可重复的、每次都有效的步骤。如有必要，模拟 Outlook 主机，这样您就不需要依赖 Outlook 时间问题或解决空间布局问题等。

**您必须获得一组可靠的可重现步骤，这些步骤会在可预测**的地址处导致 AV 或其他错误。

然后你要做的是重新启动进程，为引用该地址的任何内容创建一个内存断点集，并熟悉该内存块的生命周期。最小化和合理化您的复制步骤在这里会有所帮助。添加其他断点可能会有所帮助，并且仅在应用程序后期启用内存断点；或使用 D2009 断点的日志记录功能来记录内存值/调用堆栈等，而不是实际闯入调试对象。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-07T18:36:13.540

不完全是对更普遍的问题的答案，但很可能是对提示它的特定问题的解决方案：

我有 95% 的把握现在已经确定了问题所在！:)

这是我所做的：

*   我在编译器中启用了 RangeChecking 和 OverflowChecking
*   我追踪并修复了所有导致`ERangeError`或`EIntOverflow`异常
    的问题（每个都有一个）
*   我在启用 FastMM 和 FullDebugMode 的情况下再次运行程序
*   我终于能够在所有情况下确定问题的原因是对 JCL 函数的调用`GetWindowCaption`

似乎`GetWindowCaption`显然还没有检查 Unicode 兼容性：它使用从 API 函数`GetWindowTextLength`返回的值（返回字符数）作为输入`ReallocMem`（期望字节数）为`GetWindowText`（在 Delphi 2009 中返回 WideChars 的缓冲区）。繁荣！该函数为缓冲区分配的内存太少，但`GetWindowText`只是简单地覆盖了以下内存，从而破坏了块页脚。

我现在已将其作为[项目 #4648归档在 JCL 错误跟踪器中](http://homepages.codegear.com/jedi/issuetracker/view.php?id=4648)

我从中得出的底线是：**始终确保修复所有报告的错误！包括（看似）非关键错误，如范围和溢出错误。如果不出意外，它将使调试更加可预测。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T21:03:31.387

您在 D2007 中发现了双重释放错误，即使它在此版本中看起来确实工作正常，这意味着您需要修复这些错误，因为您很幸运 D2007 版本不需要像这样积极地回收内存由于内存中的“影子持久性”，D2009 版本和错误不会出现。
我会使用 FastMM fulldebugmode 来查找错误代码并尽可能修复它，然后按照 Barry 的建议解决内存使用问题。
有关如何使用集成调试器的功能，以及如何从非中断断点记录信息，您可能需要查看此 CodeRage 3 会话：[Delphi Debugging for Dummies](http://cc.codegear.com/Download.aspx?id=26446)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T19:41:56.920

我会关注系统内置的完整页面堆支持的方向。

在[这篇文章](https://stackoverflow.com/questions/374715/vc-6-0-access-violation-when-run-in-debugger#375124)中查看如何配置它。如果您的内存使用量不太大，这是最容易找到问题的方法。

当内存消耗较重时会变得很棘手 - 但就像我说的，首先尝试完全 peagheap。

# c# - 解析 C#，查找方法并将 try/catch 放入所有方法

> ID：416616
> 
> 赞同：1
> 
> 时间：2009-01-06T13:57:48.017
> 
> 标签：c#, parsing

我知道这听起来很奇怪，但我需要在每个方法中添加一个包装 try catch 块以捕获所有异常。我们有数千种方法，我需要以自动化的方式进行。你有什么建议？

我打算解析所有cs文件并检测方法并在应用程序中插入一个try catch块。你能给我推荐任何我可以轻松使用的解析器吗？或任何对我有帮助的...

每种方法都有其唯一编号，例如 5006

```
public static LogEntry Authenticate(....)
        {
            LogEntry logEntry = null;
            try
            {
                ....
                return logEntry;
            }

            catch (CompanyException)
            {
                throw;
            }

            catch (Exception ex)
            {
                logEntry = new LogEntry(
                    "5006",
                    RC.GetString("5006"), EventLogEntryType.Error,
                    LogEntryCategory.Foo);

                throw new CompanyException(logEntry, ex);
            }
        } 
```

我为此创建了这个； [http://thinkoutofthenet.com/index.php/2009/01/12/batch-code-method-manipulation/](http://thinkoutofthenet.com/index.php/2009/01/12/batch-code-method-manipulation/)

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-06T13:59:32.087

不要这样做。口袋妖怪（“必须抓住所有”）错误处理没有充分的理由。

编辑：几年后，稍作修改。我会说“至少不要手动执行此操作”。使用 PostSharp 或 Fody 等 AOP 工具或编织器将其应用于最终结果代码，但请确保考虑其他有用的跟踪或诊断数据点，例如捕获执行时间、输入参数、输出参数等。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-06T14:07:32.710

好吧，如果你必须这样做，那么你必须这样做。但是，您可能会尝试说服强迫您这样做的人让您使用[AppDomain 类的 UnhandledException 事件](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)。在报告给用户之前，它会给你一个关于任何方法中每个未捕获的异常的通知。由于您还可以从异常对象中获取堆栈跟踪，因此您将能够准确判断每个异常发生的位置。这是一个比在任何地方都使用异常处理程序来操纵代码更好的解决方案。

话虽如此，如果我*必须*这样做，我会使用一些正则表达式来识别每个方法的开始和结束，并使用它在任何地方插入一些异常处理程序。为这种情况编写正则表达式的技巧将是平衡组定义，在[此处](http://msdn.microsoft.com/en-us/library/bs2twtah.aspx)的 MSDN 文档中有更多解释。[这里](http://blogs.msdn.com/bclteam/archive/2005/03/15/396452.aspx)还有一个使用平衡组的相关示例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T14:13:25.117

也许提出这个要求的人不明白，您仍然可以捕获所有异常（在顶部），而无需在每个函数中都放置一个 try-catch。您可以在此处查看如何[捕获所有未处理异常](http://www.thescarms.com/dotnet/unhandled.aspx)的示例。我认为这是一个更好的解决方案，因为您实际上可以对异常做一些事情并报告它，而不是盲目地埋葬所有异常，从而导致极难追踪错误。

这类似于 Scott 的解决方案，但也向 Application.ThreadException 异常添加了一个事件处理程序，如果您使用线程，可能会发生这种情况。可能最好同时使用两者以捕获所有异常。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T14:15:16.937

请参阅我的答案[here](https://stackoverflow.com/questions/410558/why-are-exceptions-said-to-be-so-bad-for-input-validation#410709)，其中描述了如果您使用“必须抓住所有”异常处理，您将被迫接受的一些性能权衡。

正如斯科特所说，做几乎相同的事情的最佳方法是 UnhandledException 事件。我认为 jeff 实际上在早期的 SO 播客中讨论了这个问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-06T14:02:48.647

我和 StingyJack 在一起，别这样！

但是，如果必须执行高法令的神，那么请参阅我对这个问题的[回答](https://stackoverflow.com/questions/261741/get-a-methods-contents-from-a-cs-file#261861)[Get a method's contents from a cs file](https://stackoverflow.com/questions/261741/get-a-methods-contents-from-a-cs-file)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-06T14:11:08.100

首先，我支持 StingyJack 和 Binary Warrier。默认情况下不捕获异常是有充分理由的。如果您真的想捕获异常并更好地死掉，您可以在`Application.Run()`调用周围放置一个 try-catch 块并从那里开始工作。

在处理外部资源（文件、Internet 等）时，应该（通常）捕获某些异常（连接错误、文件丢失、等等）。然而，在我的书中，任何其他地方的异常都意味着 1）错误，2）有缺陷的逻辑，或 3）糟糕的数据验证......

总之，为了完全不回答您的问题，您*确定*要这样做吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T14:05:43.213

我不得不做一些有点类似的事情（在很多代码行中添加一些东西）；我使用了正则表达式。

我将创建一个正则表达式脚本，找到每个函数的开头，并在开头之后插入 try catch 块。然后，我将创建另一个正则表达式脚本来查找函数的结尾（通过在它之后找到函数的开头）并在末尾插入 try catch 块。这不会让你 100% 到达那里，但它可能会达到 80%，这可能会足够接近，以至于你可以在没有太多工作的情况下完成边缘情况。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-06T14:31:52.303

我想把它写成所有答案的答案，然后你可以通过问题 RSS 了解；需求来自我们的技术负责人：这是他的理由：我们不需要找出生产代码中哪个 func 有问题，任何问题都已报告为警报，我们将唯一代码放入 ecery catch 块中，我们会看到问题出在哪里是。他知道有一个全局错误处理，但在这种情况下没有帮助，并且堆栈跟踪在发布模式下不准确，所以他需要一个这样的 try catch 块：

```
everyMethod(...){
    try
    {
    ..
    catch(Exception e)
    {
       RaiseAlert(e.Message.. blabla)
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-06T15:19:05.797

如果您在每个方法中都调用 RaiseAlert，那么假设您重用方法，您收到的错误堆栈即使不是不准确的，也会非常混乱。日志记录方法实际上应该只需要在事件或最顶层的方法中调用。如果有人提出每个方法都需要处理异常的问题，那么他们就不了解异常处理。

几年前，我们实施了一种做法，即必须在每个事件中进行异常处理，并且一位开发人员将其理解为“每种方法”。当它们完成后，我们有数周的时间可以撤销，因为没有任何异常报告是可重现的。 **我假设他们知道得更好，就像你一样，但从未质疑过他们解释的有效性。**

实施 AppDomain.UnhandledException 是一个很好的备份，但您在该方法中唯一的办法是在记录异常后终止应用程序。您必须编写一个全局异常处理程序来防止这种情况。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-06T15:47:58.933

因此，对于那些想知道的人来说，这是一个示例；5006是这种方法独有的；

```
public static LogEntry Authenticate(....)
        {
            LogEntry logEntry = null;
            try
            {
                ....
                return logEntry;
            }

            catch (CompanyException)
            {
                throw;
            }

            catch (Exception ex)
            {
                logEntry = new LogEntry(
                    "5006",
                    RC.GetString("5006"), EventLogEntryType.Error,
                    LogEntryCategory.Foo);

                throw new CompanyException(logEntry, ex);
            }
        } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-06T14:13:57.423

我想您可以使用面向方面的编程，这是我想弄脏的东西。例如[http://www.postsharp.org/aopnet/overview](http://www.postsharp.org/aopnet/overview)

虽然这样的要求确实是邪恶的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-06T14:14:40.777

如果**真的**非要做，何必费心去修改源代码，什么时候可以直接修改编译好的可执行文件/库

看看 Cecil（参见[网站](http://www.mono-project.com/Cecil)），它是一个允许您直接修改字节码的库，使用这种方法，您的整个问题可以在几百行 C# 代码中解决。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-06T14:32:08.650

由于您在此处发布问题，我相信这是您必须做的事情之一。因此，与其将头撞在坚硬的墙上，不如按照 Scott 的建议使用 AppDomain 事件处理程序。您将满足要求，而无需花费数小时的高质量计费时间来完成繁重的工作。我敢肯定，一旦你告诉你的老板更新每个文件需要多少测试，使用事件处理程序将是一件轻而易举的事！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-06T14:42:50.643

因此，您并不是真的希望在每个函数中放置相同的确切 try-catch 块，对吗？您将不得不为每个函数定制每个 try-catch。哇！似乎“简化”调试还有很长的路要走。

如果用户在生产中报告错误，为什么不能启动 Visual Studio 并重现这些步骤并进行调试？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-06T14:45:16.003

如果您绝对必须将 try/catch 块添加到每个方法并且 scott 的答案 (AppDomain.UnhandledException) 还不够，您还可以查看拦截器。我相信 Castle 项目对方法拦截器的实现相当好。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-04-12T05:44:12.953

如果你真的必须这样做，每次包装异常的另一种方法是使用 Exception.Data 来捕获附加信息，然后**重新抛出原始异常**......

```
catch (Exception ex)
{
  logEntry = new LogEntry("5006",
                    RC.GetString("5006"), EventLogEntryType.Error,
                    LogEntryCategory.Foo);
  ex.Data.Add("5006",logEntry);
  throw;
} 
```

现在在顶层，您可以转储 ex.Data 的内容以获取您可能需要的所有其他信息。这使您可以在 .Data 集合中放置文件名、用户代理等各种有用信息，以帮助了解发生异常的原因。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-04-12T05:47:35.447

大约 2 年前，我做了一些需要解析 C# 代码的研究工作，发现 SharpDevelop 项目的源代码可以很好地做到这一点。如果您从源代码库中提取了 SharpDevParser 项目（这是两年前，不确定项目名称是否保持不变），您可以像这样使用解析器对象：

```
CSharpBinding.Parser.TParser = new CSharpBinding.Parser.TParser();
SIP.ICompilationUnitBase unitBase = sharpParser.Parse(fileName); 
```

这为您提供了 compUnit.Classes，您可以遍历每个类并在其中找到方法。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-10-17T00:47:56.850

我正在帮助一位朋友在他正在编写的 C# XNA 游戏中找到内存泄漏。我建议我们尝试检查每个方法被调用了多少次。为了保持计数，我编写了一个 python 脚本，添加了 2 行来更新字典的详细信息。

基本上我写了一个 python 脚本来修改一些 400~ 方法，需要 2 行。这段代码可以帮助某人做更多的事情，比如 OP 想要的奇怪的事情。

代码使用第 3 行配置的路径，并在处理 .cs 文件时递归迭代。它也有子目录。

当它找到一个 cs 文件时，它会查找方法声明，并尽可能小心。进行备份 - 如果我的脚本违反了您的代码，我概不负责！！！

```
import os, re

path="D:/Downloads/Dropbox/My Dropbox/EitamTool/NetworkSharedObjectModel"
files = []

def processDir(path, files):
    dirList=os.listdir(path)
    for fname in dirList:
        newPath = os.path.normpath(path + os.sep + fname)
        if os.path.isdir(newPath):
            processDir(newPath, files)
        else:
            if not newPath in files:
                files.append(newPath)
                newFile = handleFile(newPath)
            if newPath.endswith(".cs"):
                writeFile(newPath, newFile)

def writeFile(path, newFile):
    f = open(path, 'w')
    f.writelines(newFile)
    f.close()

def handleFile(path):
    out = []
    if path.endswith(".cs"):
        f = open(path, 'r')
        data = f.readlines()
        f.close()

        inMethod = False
        methodName = ""
        namespace = "NotFound"
        lookingForMethodDeclerationEnd = False
        for line in data:
            out.append(line)
            if lookingForMethodDeclerationEnd:
                strippedLine = line.strip()
                if strippedLine.find(")"):
                    lookingForMethodDeclerationEnd = False
            if line.find("namespace") > -1:
                namespace = line.split(" ")[1][0:-2]
            if not inMethod:
                strippedLine = line.strip()
                if isMethod(strippedLine):
                    inMethod = True
                    if strippedLine.find(")") == -1:
                        lookingForMethodDeclerationEnd = True
                    previousLine = line
            else:
                strippedLine = line.strip()
                if strippedLine == "{":
                    methodName = getMethodName(previousLine)
                    out.append('            if (!MethodAccess.MethodAccess.Counter.ContainsKey("' + namespace + '.' + methodName + '")) {MethodAccess.MethodAccess.Counter.Add("' + namespace + '.' + methodName + '", 0);}')
                    out.append("\n" + getCodeToInsert(namespace + "." + methodName))
                    inMethod = False
    return out

def getMethodName(line):
    line = line.strip()
    lines = line.split(" ")
    for littleLine in lines:
        index = littleLine.find("(")
        if index > -1:
            return littleLine[0:index]

def getCodeToInsert(methodName):
    retVal = "          MethodAccess.MethodAccess.Counter[\"" + methodName + "\"]++;\n"
    return retVal

def isMethod(line):
    if line.find("=") > -1 or line.find(";") > -1 or line.find(" class ") > -1:
        return False
    if not (line.find("(") > -1):
        return False
    if line.find("{ }") > -1:
        return False
    goOn = False
    if line.startswith("private "):
        line = line[8:]
        goOn = True
    if line.startswith("public "):
        line = line[7:]
        goOn = True
    if goOn:
        return True
    return False

processDir(path, files) 
```

# cocoa - 如何为 NSApp.dockTile 的创建绑定

> ID：416619
> 
> 赞同：2
> 
> 时间：2009-01-06T13:58:33.790
> 
> 标签：cocoa, key-bindings, key-value-observing, cocoa-bindings, nsdocktile

在 IB 中，很容易将标签或文本字段绑定到某个控制器的 keyPath。

NSDockTile（可通过 [[NSApp dockTile] setBadgeLabel:@"123"] 获得）未出现在 IB 中，我无法弄清楚如何以编程方式绑定其“badgeLabel”属性，就像您可能绑定标签/文本字段/表格列一样.

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T00:26:05.380

NSDockTile 没有任何绑定，因此您的控制器必须手动更新停靠图块。您可以使用 KVO 执行此操作，这与绑定它具有相同的效果。

创建一个全局上下文：

```
 static void* MyContext=(void*)@"MyContext"; 
```

然后，在您的 init 方法中：

```
 [objectYouWantToWatch addObserver:self forKeyPath:@"dockTileNumber" options:0 context:MyContext]; 
```

然后，您必须实现此方法以通知密钥路径的更改：

```
- (void) observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    if (context == MyContext) {
        [[NSApp dockTile] setBadgeLabel:[object valueForKeyPath:keyPath]];
    }
    else {
        [super observeValueForKeyPath:keyPath ofObject:object change:change context:context];
    }
} 
```

确保在控制器对象消失时移除观察者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T14:15:50.807

如果 NSDockTile 确实支持绑定，您可以使用该方法`bind:toObject:withKeyPath:options:`在 badgeLabel 属性上设置绑定。查看文档以获取有关使用哪些参数的详细信息。如果它不起作用，您可以在控制器类中实现键值观察并在每次值更改时更新标签，或者甚至覆盖 NSDockTile 以创建绑定兼容的子类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T20:37:53.110

我`bind:toObject:withKeyPath:options:`在 NSDockTile、控制器、数据源上尝试了很多变体。我想不出一个有效的组合。或者，有没有办法让 BatchController 对象绑定到数据源，然后更新徽章？如何获取 NSObject 并使其可绑定？

# sql - 为什么 SQL 强制我在 GROUP BY 子句中重复 SELECT 子句中的所有非聚合字段？

> ID：416625
> 
> 赞同：36
> 
> 时间：2009-01-06T13:59:34.100
> 
> 标签：sql, group-by

这困扰了我很长时间。

99% 的情况下，GROUP BY 子句是 SELECT 子句的精确副本，减去聚合函数（MAX、SUM 等）。
这打破了不要重复自己的原则。

GROUP BY 子句何时不能包含 SELECT 子句减去聚合函数的精确副本？

## 编辑

我意识到某些实现允许您在 GROUP BY 中拥有与 SELECT 中不同的字段（因此是 99%，而不是 100%），但这肯定是一个非常小的例外吗？
如果您使用不同的字段，有人可以解释应该返回什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-06T14:38:29.917

我倾向于同意你的观点——这是 SQL 应该具有稍​​微更智能的默认值以节省我们所有输入的许多情况之一。例如，想象一下这是否合法：

```
Select ClientName, InvoiceAmount, Sum(PaymentAmount) Group By * 
```

其中“*”表示“所有非聚合字段”。如果每个人都知道它是如何工作的，那么就不会有混乱了。如果你想做一些棘手的事情，你可以加入一个特定的字段列表，但是 splat 的意思是“所有的 'em”（在这种情况下意味着所有**可能**的）。

当然，“*”在这里的含义与 SELECT 子句中的不同，所以也许不同的字符会更好：

```
Select ClientName, InvoiceAmount, Sum(PaymentAmount) Group By ! 
```

在其他一些领域，SQL 就没有它可能的那样雄辩。但在这一点上，它可能过于根深蒂固，无法进行如此多的重大改变。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-06T14:05:47.130

因为它们是两个不同的东西，您可以按不在 select 子句中的项目分组

编辑：

另外，做出这样的假设是否安全？

我有一条 SQL 语句

```
Select ClientName, InvAmt, Sum(PayAmt) as PayTot 
```

服务器假设我想按 ClientName 和 InvoiceAmount 分组是否“正确”？我个人更喜欢（并且认为它更安全）拥有此代码

```
Select ClientName, InvAmt, Sum(PayAmt) as PayTot
Group By ClientName 
```

抛出错误，提示我将代码更改为

```
Select ClientName, Sum(InvAmt) as InvTot, Sum(PayAmt) as PayTot
Group By ClientName 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T14:09:31.957

我希望/期待我们很快会看到更全面的东西；有关该主题的 SQL 历史课程将很有用且内容丰富。任何人？任何人？布勒？

与此同时，我可以观察到以下情况：

SQL 早于 DRY 原则，至少在[The Pragmatic Programmer](http://www.pragprog.com/the-pragmatic-programmer)中有记载。

并非所有数据库都需要完整列表：例如，Sybase 会愉快地执行查询，例如

```
SELECT a, b, COUNT(*)
FROM some_table
GROUP BY a 
```

... 这（至少每次我不小心运行了这样一个怪物）经常导致如此庞大的无意记录集，以至于恐慌的请求很快接踵而至，请求 DBA 反弹服务器。结果是一种部分笛卡尔积，但我认为这可能主要是 Sybase 未能正确实施 SQL 标准。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T19:43:49.927

这样做的充分理由是，如果您没有指定所有列，您将经常得到不正确的结果。假设您有三列`col1`，`col2`和`col3`。

假设您的数据如下所示：

```
Col1  Col2 Col3
a      b    1
a      c    1
b      b    2
a      b    3 
```

`select col1, col2, sum(col3) from mytable group by col1, col2`
将给出以下结果：

```
Col1  Col2 Col3
a      b    4
a      c    1
b      b    2 
```

它会如何解释
`select col1, col2, sum(col3) from mytable group by col1`

我的猜测是

```
Col1  Col2 Col3
a      b    5
a      c    5
b      b    2 
```

这些显然是不好的结果。当然，查询越复杂，连接越多，查询返回正确结果或程序员甚至知道它们是否不正确的可能性就越小。

我个人很高兴这`group by`需要这些字段。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-06T20:25:54.320

也许我们需要一个速记形式——称之为 GroupSelect

```
GroupSelect Field1, Field2, sum(Field3) From SomeTable Where (X = "3") 
```

这样，如果您遗漏聚合函数，解析器只需要抛出错误。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-16T18:43:59.687

我同意 GROUP BY ALL、GROUP BY * 或类似内容。如原始帖子中所述，在 99%（可能更多）的情况下，您希望按所有非聚合列/表达式进行分组。

但是，出于向后兼容性的原因，这是一个需要 GROUP BY 列的示例。

```
SELECT 
  MIN(COUNT(*)) min_same_combination_cnt, 
  MAX(COUNT(*)) max_same_comb_cnt, 
  AVG(COUNT(*)) avg_same_comb_cnt, 
  SUM(COUNT(*)) total_records,
  COUNT(COUNT(*)) distinct_combinations_cnt
FROM <some table>
GROUP BY <list of columns> 
```

这适用于甲骨文。我用它来估计列的选择性。group by 应用于内部聚合函数。然后，应用外部聚集体。

如果对 SQL 标准的改进提出建议，那就太好了。我只是不知道这是怎么回事。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T14:03:33.297

实际上，这不是100％的时间吗？有没有一种情况，您可以在选择中拥有一个不在 GROUP BY 中的（非聚合）列？

虽然我没有答案。对于这门语言来说，这确实是一个尴尬的时刻。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-06T20:18:51.557

我同意 op 的观点，即重复有点烦人，特别是如果非聚合字段包含复杂的语句，如 if 和函数以及许多其他内容。如果 group by 子句中可以有一些速记，那就太好了——至少是一个列别名。按编号引用列可能是另一种选择，尽管它可能有自己的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-02-11T15:45:06.113

例如，您可能需要从所有分组的行中提取一个 id，以及它们的数量之和。在这种情况下，您将按名称对它们进行分组，而不将 id 分组。SQLite 似乎以这种方式工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-04T20:23:02.327

由于 group by 导致整个元组组的单个元组，因此其他非 group by 属性必须仅在聚合函数中使用。如果您在选择中添加非分组属性，则 sql 无法决定从该组中选择哪个值。

# javascript - 您曾经在 UL 标签上使用过 IFrame 垫片吗？

> ID：416631
> 
> 赞同：0
> 
> 时间：2009-01-06T14:00:48.310
> 
> 标签：javascript, html, iframe, shim

我有一个使用 UL 和 LI 元素从主菜单下拉的菜单结构。我遇到的问题（当然）是在 IE6 中，尽管有 z-index，但菜单仍落后于 SELECT 元素。我尝试将 IFram 垫片添加到 UL，其中包含作为菜单项的 LI 元素。问题是 Shim 位于 UL 顶部而不是在其后面，尽管事实上 shim 的 z-index 小于 UL 元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T14:22:30.823

有人[进行了修复](http://www.fabien-molinet.fr/index.php?option=com_content&task=blogsection&id=8&Itemid=9)，使用[Prototype](http://www.prototypejs.org)库自动完成所有这些工作。值得一看，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T19:32:08.857

我们看到的问题是由页面内容所在位置的“包装器”div 引起的：相对。一旦我们从该容器 div 中删除它，垫片就会放在 ul 后面但在下拉列表（选择）上方。

# asp.net-mvc - 我应该如何处理 ASP.NET MVC 中的删除情况

> ID：416646
> 
> 赞同：2
> 
> 时间：2009-01-06T14:03:23.793
> 
> 标签：asp.net-mvc

我应该如何从我的视图中启动删除操作？

为每个实体创建一个新的表单标签似乎并不正确:-)

```
<% foreach (var subscriber in group.Subscribers) { %>
        <tr>
            <td><%= subscriber.Email %></td>
            <td><%= Html.ActionLink("[edit]", "edit", "subscriber", new {id=subscriber.SubscriberId}, null) %></td>
            <td>
                <form id="delete-subscriber-form" method="post" action="<%= Url.Action( "delete", "subscriber", new { @subscriberId = subscriber.SubscriberId }) %>">
                    <input type="submit" value="Delete" />
                </form>
            </td>
        </tr>
        <% } %> 
```

你会怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T14:06:14.600

我通常在项目的一侧使用复选框。然后我可以拥有将操作应用于所选项目（例如删除）的操作链接（按钮等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T14:17:51.160

你可以使用 CSS 和 Javascript，为你想要删除的所有元素添加 'forDel' css 类，如果你要使用 jquery，你可以这样做：

```
 $(".element").each(function(){
      $(this).data("id","the id of the element in db")
    });

    $(".element").toggle(function(){
      $(this).addClass("forDel");
    },function(){
   $(this).removeClass("forDel");
   }); 
```

然后按下删除按钮：

```
var idsForDel;
    $(".forDel").each(function(){
   idsForDel = $(this).data("id"); + ";";
}) 
```

您可以将 idsForDel 传递给 Controller ...并将其拆分到服务器端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T14:20:35.663

这取决于具体情况，如果您正在执行 CRUD 操作，您通常会在`<form>`每个操作中使用一个标签（删除、编辑、新建）。但是，如果您正在显示一个列表并且您希望能够通过单击“多次删除”项目，那么您将不得不从不同的角度来处理它，因为您需要将所有必需的信息封装到一个表单中。

**编辑**

再次查看您上面的帖子后，我注意到您针对列表中的每个元素提供了一个“删除按钮”。对于像这样的原子操作（即用户希望在单击按钮后立即发生某些事情），我肯定会为每个项目使用一个表单。

我上面写的仍然适用...

# c# - 返回 IEnumerable 的迭代器方法之间有什么区别吗 和 IEnumerator ?

> ID：416651
> 
> 赞同：7
> 
> 时间：2009-01-06T14:05:37.037
> 
> 标签：c#, iterator

考虑两个具有相同主体的迭代器方法：

```
public static IEnumerable<int> It1() { 
    ...
}

public static IEnumerator<int> It2() { 
    ...
} 
```

是否有任何情况下 call`It2`与 call 不同`It1.GetEnumerator()`？

是否有充分的理由将迭代器定义为`IEnumerator<T>`over `IEnumerable<T>`？我唯一能想到的就是当你在实施`IEnumerable<T>.GetEnumerator()`.

编辑：迭代器方法是指使用`yield return`和`yield break`构造的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T14:13:36.270

如前所述，您不能`foreach`超过`IEnumerator<T>`. 因此，很难集成到代码中您想要迭代返回的内容的地方。

此外，这里的重要性在于它`IEnumerable<T>`是一个工厂，因此您可以生成`IEnumerator<T>`与`T`.

现在更重要的是 LINQ 的所有扩展方法都可以正常工作`IEnumerable<T>`，因此您将希望通过返回它来使您的枚举尽可能易于使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-14T07:42:27.603

如果你想负责编写`IEnumerable<T>`包装类，你会这样做。

假设您有一个要无限枚举的类：

```
public class EveryDateInTheFuture : IEnumerable<DateTime>
{
    public EveryDateInTheFuture() { this.StartDate = DateTime.Today; }

    public DateTime StartDate { get; set; }

    public IEnumerator<DateTime> GetEnumerator()
    {
         while (true)
         {
             yield return date;
             date = date.AddDays(1);
         }
    }
} 
```

# java - java webpart like asp.net?

> ID：416667
> 
> 赞同：0
> 
> 时间：2009-01-06T14:08:33.877
> 
> 标签：java, asp.net, web-parts, personalization

I was reading asp.net webpart technology which gives users some personalization abilities under some rules and tools of webparts.

are there something like webpart technology lib under java ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T14:25:57.447

There's always the ill-fated [Portlet](http://en.wikipedia.org/wiki/Portlet).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T14:49:52.250

我不知道有任何 JSF 或 JSP 实现，而且我认为它们甚至不存在。

但是，可以使用[Google](http://code.google.com/webtoolkit/)的 GWT和[GWT-Dnd](http://code.google.com/p/gwt-dnd/)创建这样的东西。这些允许您创建 javascript web 应用程序，但您使用 Java 编写它们。

这是一个使用 GWT-DND 创建的示例：http: [//www.wibokr.com](http://www.wibokr.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-23T07:37:53.200

还没有看到任何框架可以直接支持超出基本功能的此类功能，但是有很多框架可以让您根据需要开发这样的系统。从其他答案来看，到目前为止，只有 GWT 和 Portlet 的答案实际上是有效的。

如果您想找到兼容的东西，您应该开始搜索支持任一 Portlet API 规范的 Web 框架（[1.0 是 JSR-168，2.0](http://www.jcp.org/en/jsr/detail?id=168)是[JSR-286](http://www.jcp.org/en/jsr/detail?id=286)）。否则，您不妨根据您认为最适合使用的 Web 框架推出自己的框架，无论是[GWT](http://code.google.com/webtoolkit/)、[Seam](http://sfwk.org/)、[Wicket](http://wicket.apache.org/)、[Tapestry](http://tapestry.apache.org/)、[Vaadin](http://vaadin.com/home) ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-23T07:27:03.597

*   您可以使用以下内容：
    *   JSP
    *   JSF（或任何其他实现 - Icefaces、Richfaces、MyFaces 等）
    *   谷歌网络工具包
    *   春季MVC
    *   基于模板的解决方案（Freemarker 或 Velocity）

# sql - 带有 LINQ 和 SQL 数据库的 ASP.NET MVC TDD

> ID：416679
> 
> 赞同：6
> 
> 时间：2009-01-06T14:12:46.257
> 
> 标签：sql, asp.net-mvc, linq, tdd

我正在尝试通过测试开始一个新的 MVC 项目，我认为最好的方法是拥有 2 个数据库。1 用于测试，1 用于当我运行应用程序并使用它时（也真正测试，因为它还没有生产）。

对于测试数据库，我正在考虑将创建表脚本和填充数据脚本放在测试设置方法中，然后在拆卸方法中删除所有这些。

不过，我将使用 Linq to SQL，但我认为这不会允许我这样做？

如果我想这样做，我是否只需要走 ADO 路线？还是应该只使用模拟对象并将数据存储为数组或其他东西？

关于最佳实践的任何提示？

Jeff 是如何为 StackOveflow 做这件事的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T14:19:59.563

我所做的是为 DataContext 包装器定义一个接口，并为 DataContext 使用包装器的实现。这允许我在我的测试中使用一个替代的、假的 DataContext 实现（或者模拟它，如果更容易的话）。这完全从我的单元测试中抽象出数据库。[我在http://andrewtokeley.net/archive/2008/07/06/mocking-linq-to-sql-datacontext.aspx](http://andrewtokeley.net/archive/2008/07/06/mocking-linq-to-sql-datacontext.aspx)找到了一些入门代码，尽管我已经对其进行了扩展，以便它处理我实体上的验证实现类。

我还应该提到，我有一个单独的 QA 登台服务器，因此可以对整个系统进行实时测试。我只是在单元测试中不使用实际的数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T09:04:08.157

我查看了来自 tvanfosson 和 RikMigrations 的链接，在玩过它们之后，我最喜欢模拟数据上下文方法。我意识到我不需要一直创建表并删除它们。

经过更多研究后，我发现了 Stephen Walther 的文章[http://stephenwalther.com/blog/archive/2008/08/17/asp-net-mvc-tip-33-unit-test-linq-to-sql.aspx](http://stephenwalther.com/blog/archive/2008/08/17/asp-net-mvc-tip-33-unit-test-linq-to-sql.aspx)其中对我来说似乎更容易，更可靠。

所以我将使用这个实现。

谢谢您的帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T15:07:54.257

您可能希望找到其他方法来实际访问数据库以进行单元测试，因为这需要更多时间。话虽如此，您是否考虑过使用迁移来创建/删除表而不是使用 sql 脚本？[RikMigrations](http://www.rikware.com/RikMigrations.html)是我用来创建数据库的工具，因此我可以轻松地在一个地方修改我的所有代码。[Justin Etheredge](http://www.codethinked.com)有一篇关于[使用 RikMigrations](http://www.codethinked.com/post/2008/12/16/Migrations-in-C-using-RikMigrations.aspx)的精彩文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-14T12:20:21.033

在 DataContext 上考虑这些方法：

[http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.createdatabase.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.createdatabase.aspx)

[http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.executecommand(v=VS.100).aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.executecommand(v=VS.100).aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-17T17:56:37.840

我同意上述与单元测试有关的大部分内容。但是，我认为重要的是要指出使用 Mock Repositories 和单元测试不会为您提供与 DB 集成测试相同级别的测试。

例如，我们的数据库通常在模式中内置了级联删除。在这种情况下，删除聚合中的主要实体将自动删除所有子实体。但是，这不会自动应用于未由具有这些业务规则的物理数据库备份的模拟存储库（除非您将所有这些规则都构建到模拟中）。这很重要，因为如果有人出现并更改了我的架构设计，我需要它来破坏我的测试，以便我可以相应地调整代码/架构。我很欣赏这是集成测试而不是单元测试，但我认为值得一提。

我的首选选项是创建一个包含示例数据的主设计数据库（与您在 Mocks 中创建的相同类型的数据）。在每次测试运行开始期间，我都有一个自动化脚本，它创建 MasterDB 的备份并将其恢复到“TestDB”（我的所有测试都使用它）。这样，我在 Master 中维护一个干净的测试数据存储库，而不是在每次测试运行时重新创建自己。我的测试可以处理数据并测试所有需要的场景。

当我调试应用程序时，我有另一个脚本可以备份 Master DB 并将其还原到 DEV 数据库。我也可以在这里处理数据，而不必担心丢失我的样本数据。由于等待重新创建数据库的延迟，我通常不会在每个会话中运行此特定脚本。我可能每天运行一次，然后全天玩/调试应用程序。例如，如果我在调试过程中删除表中的所有记录，我会在完成后运行脚本来重新创建 DevDB。

这些步骤听起来会为流程增加大量时间，但实际上 - 它们不会。我们的应用程序目前有大约 3500 次测试，其中大约 3000 次在某个时间点访问数据库。每次测试运行开始时，数据库备份和恢复通常需要大约 10-12 秒。而且由于整个测试套件仅在 TFS 签入时执行，因此我们不介意是否必须再等一段时间。平均而言，我们的整个测试套件运行大约需要 15-20 分钟。

我赞赏并接受集成测试比单元测试慢得多（因为固有的需要使用真实的数据库），但它更接近地代表了“现实世界”的应用程序。例如，模拟存储库不返回数据库错误代码、不超时、不锁定、不耗尽磁盘空间等。

单元测试适用于简单计算、基本业务规则等，当然它们绝对是大多数不涉及数据库（或其他资源）访问的操作的最佳选择。但我不认为它们像集成测试那样有价值——人们经常谈论单元测试，但很少谈论集成测试。

我希望那些对单元测试充满热情的人会为此发火。没关系——我只是试图带来一些平衡，并提醒人们，充满通过单元测试的项目仍然可能在你在现场实施它们的那一刻严重失败。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-14T12:15:28.760

本文给出了使用 typemock 模拟 linq to sql 的示例。

[http://blog.benhall.me.uk/2007/11/how-to-unit-test-linq-to-sql-and.html](http://blog.benhall.me.uk/2007/11/how-to-unit-test-linq-to-sql-and.html)

# open-source - 有没有人找到一个好的开源 ajax 日历控件（不是弹出日期选择器）

> ID：416686
> 
> 赞同：4
> 
> 时间：2009-01-06T14:14:35.020
> 
> 标签：open-source, calendar

我们正在考虑更换专有的日历控件。我查看了 scal [http://scal.fieldguidetoprogrammers.com](http://scal.fieldguidetoprogrammers.com/)，但样式很弱，并且对于跨日事件或日视图中的并发事件来说功能不够。 [Feyasoft.com](http://www.feyasoft.com)有一个基于 ExtJs 的 ajax 日历，看起来很棒，但它不是开源的。

提前致谢

**更新：**这个问题正在寻找“像 Outlook Web Access 这样的日历项目的视图”，而不是用于选择日期的 UI 控件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T15:53:54.103

也许[DayPilot - 用于 ASP.NET 的开源类似于 Outlook 的日历/调度控件](http://www.daypilot.org/)会帮助你。

DayPilot的开源版本（DayPilot Lite）没有AJAX功能，但有日视图、工作周视图、周视图、营业时间高亮等功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T15:19:45.077

似乎有很多日期选择器——我根本不想要日期选择器。上面的两个答案都是日期选择器控件。

我正在寻找一个 ajax 控件，它可以呈现日历项目的视图，例如 Outlook Web Access 会做的事情（例如）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-28T19:30:28.107

我们使用这些人：[http ://arshaw.com/fullcalendar](http://arshaw.com/fullcalendar)

它是免费的、开源的并且易于实施——尽管您确实需要自己实施数据编辑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-31T00:30:06.823

您可以尝试删除开源 Ajaxy 群件项目之一的日历部分，例如[Zimbra](http://zimbra.com)、[Bongo](http://bongo-project.org)、[Horde](http://horde.org)或[Zarafa](http://zarafa.com)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-08T20:19:43.677

[Feyasoft.com](http://www.feyasoft.com/myCalendar)有一个非常棒的基于 extjs 的日历应用程序——似乎最近他们刚刚将其作为开源和可下载的。我只是尝试一下，似乎它对我很有效 - 看起来像谷歌日历。祝你好运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T14:16:15.110

我们使用[jQuery UI Datepicker](http://docs.jquery.com/UI/Datepicker)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T14:18:37.837

你看过[YUI Calendar Control](http://developer.yahoo.com/yui/calendar/)（来自 Yahoo）吗？它是开源的，似乎有很多功能。他们所有的控件都有很好的记录。

提问者要求提供完整的日历，而不仅仅是日期选择器。链接页面是这样说的：

> 您可能还会发现 Calendar 的基础类是开始更复杂的界面的好地方，这些界面可以直观地组织带有日期标签的信息（如约会、照片、事件等）。

我不知道有任何完整的 ajax 日历（如开源 Google 日历），但如果您想自己动手，这个控件似乎是一个不错的起点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T22:14:12.617

如果基于小部件（Web 服务）的解决方案可行，您可以考虑 InstantCal：http: [//instantcal.com](http://instantcal.com)

免责声明：我隶属于 InstantCal

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-25T01:12:07.160

使用[www.web2cal.com](http://web2cal.com)。它是自定义和创建 ajax 事件日历的最佳选择。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2011-11-30T23:30:02.820

试试这个：[http ://www.cubedrive.com/myCalendar](http://www.cubedrive.com/myCalendar)

我见过的最好的日历开源，它有我们需要的重复类型的事件（每天、每周、每月、每年等）。

# c# - 如何从用户控件引用母版页？

> ID：416691
> 
> 赞同：13
> 
> 时间：2009-01-06T14:15:22.320
> 
> 标签：c#, asp.net, master-pages, user-controls

我正在寻找一种方法来（最好）从用户控件中强烈键入母版页，该用户控件位于使用母版页的内容页中。

可悲的是，您不能在用户控件中使用它：

```
<%@ MasterType VirtualPath="~/Masters/Whatever.master" %> 
```

我正在尝试从用户控件访问母版页的属性，并且不想将属性从母版页传递到内容页到用户控件，因为多个内容页使用相同的用户控件。一个变化，一个地方什么的。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-06T14:24:05.377

试试`Page.Master`。

```
Whatever whatev = (Whatever)Page.Master; 
```

您必须确保将正确的`using`语句添加到文件顶部，或限定母版页类型内联。

一个潜在的问题是，如果此控件由其母版页类型不同的不同页面使用。这只会在运行时被捕获。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T14:23:08.093

您是否在用户控件上尝试过 Page.FindControl("name") ？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-25T16:58:30.390

我发现做到这一点的最佳方法实际上是构建一个基于 UserControl 的自定义类，给它一个带有 get 访问器的 Master 属性，该访问器可以遍历 this.Page.Parent 直到它停止遇到母版页（如果您正在嵌套，则此步骤是不必要的），然后将该 Web 控件作为您要使用的母版页的类型返回。然后，当您添加新的用户控件时，将其基类更改为您的自定义类的名称。.Master 属性将可以访问并正确转换为您希望它使用的母版页。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-17T07:43:08.013

在 VB 中，我需要做的就是改变这个：

```
Dim lAuthLevel As Integer = Master.MasterContact.AuthenticationLevel 
```

对此：

```
Dim lAuthLevel As Integer = CType(Me.Page.Master, main).MasterContact.AuthenticationLevel 
```

**所以Master**的所有引用都变成**了Ctype(Me.Page.Master, typeofMaster)**

在这种情况下，“主要”一词在哪里 - 从母版页顶部的声明中获取。例如

所以在这种情况下是“主要”:)

# c# - ASP.NET 和 C#.NET 之间的组件重用

> ID：416696
> 
> 赞同：0
> 
> 时间：2009-01-06T14:16:53.003
> 
> 标签：c#, .net, asp.net, portability, reusability

这似乎是一个荒谬的问题，因为我对 .NET 非常缺乏经验。

是否可以在 C# 中使用 .NET 构建组件，这些组件可以在 ASP.NET 中重用。例如，如果想将应用程序移植到网络上。

如果可能，它们的便携性如何？即可以在一定程度上重用GUI吗？是否有中间格式可用作基础格式，还是需要将 C# 组件用作二进制文件？

谢谢。

**编辑：**

感谢您的输入！我非常熟悉这个问题的设计方面，即如何为组件建模以供重用。但是，您让我意识到问题实际上是关于 - .NET 在 ASP 和 Windows 之间可重用的程度如何？是否可以说某些 .NET 组件包独立于环境而某些是特定于平台的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T14:24:00.883

绝对 - .NET 类可用于任何类型的 .NET 应用程序。但是，这取决于您正在谈论的应用程序的哪一部分。

通常，Windows 窗体用户界面不能作为 ASP.NET 用户界面重用，因为设计约束是如此不同（即 Web 浏览器仅支持少量控件，经常使用流（而非网格）布局等。类似地，事件是不同的（Web 表单按钮与 Windows 表单按钮等不同）。

但是，如果您正确地做事，您可以轻松重用的是业务逻辑。设计您的类，使它们在内部不知道它是 Windows 窗体还是 Web 窗体（或控制台应用程序或 Web 服务等）。也就是说，这些类应该是您的业务逻辑的纯实现。然后，您可以在任何您想要的上下文中使用这些类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T14:38:32.880

对您的问题的简短回答是肯定的 - 只需将您想要在两个视图之间共享的代码分离到一个独立于接口的类中，最好是在一个单独的程序集中，并包含该程序集。

长答案更复杂 - 执行此操作的能力将因应用程序和应用程序而异。您将能够为在幕后做不多的 UI 密集型应用程序（例如，某种图形游戏）分离出更少的代码，而不是为一个在幕后做很多事情的非常简单的 UI 应用程序分离出的代码场景（例如，由单个按钮组成的 UI，然后启动复杂的数据操作过程）。

最后 - .NET 为您提供了执行此操作的能力。您执行此操作的实际能力将在很大程度上取决于您自己的设计能力和您的特定要求。有很多关于这个主题的文章 - 我建议先看看设计模式（虽然原书用 C++ 编写示例，但我相信有人已经用 C# 编写了一本带有示例的书。但是，我不能说话它的质量。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T14:20:37.363

我以前从未这样做过，但我想你可以将公共代码放在一个单独的类上。UI 将需要复制，因为 Windows 窗体和 asp.net 具有完全不同的编程方法。

# java - Vehicle Tracking System[java/Java EE]

> ID：416708
> 
> 赞同：0
> 
> 时间：2009-01-06T14:20:18.050
> 
> 标签：java, jakarta-ee, struts

I am interested in building a vehicle tracking system using GPRS. However, I have some questions for anyone who has done this before:

*   Is GPRS the best technology to use? Any problems people are aware of?
*   I am planning on using Java/Java EE - is there any better technologies?
*   If someone has built this before - do you have some examples of what to see for system requirements?
*   What are some good web resources you've found working on this?
*   Is there a step-by-step guide anywhere to getting started?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T14:41:29.520

If you're just doing it for fun/personal use and Amateur Radio licenses are available where you are, look into APRS.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T14:51:01.000

您可以使用带有 GPS 接收器（内置或其他）的手机。外部接收器更易于使用，因为它们由较旧的 Java JSR ( [http://www.jsr82.com/](http://www.jsr82.com/) ) 寻址，因此在 Java ME 中得到了更好的支持。

在客户端（电话）上，您可以用 Java 编写 midlet（请参阅 JaveME）来访问设备的 GPS 位置，然后使用电话的数据连接（GPRS 或 3G）向服务器发出 HTTP 请求，该服务器将跟踪设备的位置。我看到的 GPRS/3G 的唯一替代方案是 SMS，但这会使服务器端的事情变得更加复杂（您需要通过 GSM 运营商访问 SMS 网关）。

对于构建 Java midlet 所需的 API，请在诺基亚注册 - 他们有一个开发人员网站，提供您需要的所有信息。当然，如果你使用其他类型的手机诺基亚的东西并没有多大帮助。

客户端有一些现有的解决方案 - TrekBuddy 的谷歌 - 可能可用于概念验证。

在服务器端，您可以编写一个 servlet，通过设备 ID 跟踪设备并记录手机发送的坐标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-07T12:14:35.623

> 如果有人以前构建过这个 - 你有一些关于系统要求的例子吗？

有些问题太笼统而无法回答，但要专门回答这个问题。这是一个例子。

通常，您需要的软件组件（和硬件组件）是：

1.  **GPS 跟踪设备**- 能够通过互联网（或 SMS）报告位置。XeXun TK102 兼容设备在 100 美元以下的类别中很常见，但还有很多其他选择。
2.  **服务器和数据库**- 用于存储位置/历史。Java EE 堆栈在这里是一个不错的选择。
3.  **基于地图的报告应用程序**- 用于查看和分析位置数据。通常是桌面、移动或 Web 应用程序。

这是一个简单的基于开源 Java EE / Spring 的车辆跟踪服务器、数据库和基于 Web 的移动地图应用程序（以上 2-3）。它使用与 TK102 兼容的 GPS/GPRS 跟踪设备 (1)：

[https://github.com/mstahv/tindratracker](https://github.com/mstahv/tindratracker)

# unit-testing - 设置 Mobile JUnit 测试以在 JUnit 下运行

> ID：416714
> 
> 赞同：3
> 
> 时间：2009-01-06T14:21:33.883
> 
> 标签：unit-testing, java-me, junit

我正在使用 Sony Ericsson 发布的 Mobile JUnit 对我的 J2ME 项目进行单元测试。我在文档中读到，可以借助一些包装类在常规 junit 下运行测试。事实上，如果您想为 CI 构建等生成报告，文档建议您这样做，这正是我想要的。

不幸的是，文档对如何做到这一点有点简洁。有没有人对 Mobile JUnit 的这方面有任何运气？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T20:46:44.927

我所做的（我并不是说这通常是一个好主意，但它适用于我的特定情况）是将代码库分离为库和 UI。该库不包含特定于 J2ME 的内容，也不包含 J2SE 所具有的 J2ME 所不具备的任何内容。因此，您可以在 NetBeans 中将其作为 J2SE 项目检出，并且可以编译。然后我在 J2SE 上下文中编写了 JUnit 测试。这无助于测试 UI，但它使测试库变得非常容易。

听起来您找到了一个更完整的解决方案来测试两者。你能详细说明你用的是什么微模拟器吗？

# sql-server-ce - 您会将 Sql Server Compact 用于桌面应用程序吗？

> ID：416716
> 
> 赞同：22
> 
> 时间：2009-01-06T14:22:23.397
> 
> 标签：sql-server-ce

将 SQL Server Compact 用于桌面应用程序是否有意义？

*   它可以处理多少数据？
*   是否可以与多个用户一起使用？有什么限制？
*   数据库文件损坏时会发生什么？是否可以以编程方式恢复或远程解决问题是否容易？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-06T14:28:04.820

我当然会（并且会）。SQL Compact (SQLCE) 在某些场景中具有明显的优势。现在它绝不意味着要替代 SQL Server。它不能扩展，它不能运行数千个并发连接，它不是为报告服务等而设计的。

但它的足迹*很小。*安装只是复制 DLL 的问题。备份它是一个简单的文件副本。如果您使用直接表或 BCP，它可以快速存储和检索。哦，它是免费的。如果您只需要一个应用程序的本地数据存储，那么 SQL Server 的部署和配置会很麻烦。SQLCE 很简单。此外，它可以作为复制订阅者在与完整 SQL Server 相同的沙箱中运行（大多数其他小型数据库不能）。

编辑：忘记回答您的具体问题：

*   它可以处理多少数据？在什么方面？数据库大小？吞吐量？桌子尺寸？行大小？我的经验是我已经将数据库运行到几百 MB 没有问题。我认为它可以容纳 4GB（截至 4.0）。吞吐量与您将数据放入或取出的方式直接相关。我们在一个解决方案中使用它，我们每秒可以毫无问题地捕获 1k 行。您可以有 1024 列和 8k 的最大行大小。
*   多个用户？好吧，它可以处理多个同时连接（从 3.5 开始），所以是的，应该可以。我使用了来自一个用户的多个连接，而不是来自多个。
*   损坏的数据库？定义“破碎”。发动机有一个“紧凑和修理”的方法。它和其他文件一样 - 如何修复损坏的可执行文件？如果这就是您要问的，我没有看到该领域的任何损坏（我们在一个存储卡损坏的 CE 设备上做过，但这不是引擎的错）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T14:28:38.237

如果您想要一个小型数据库，请使用 SQLLite 之类的东西。

但是这里有 [一篇关于在服务器上使用精简版的文章](http://blog.wharton.com.au/2007/10/sql-server-compact-edition-multi-user.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T14:32:10.273

我将它用于一个应用程序并且效果很好。我遇到的唯一问题是，出于某种原因，SQL Server 2005 Management Studio 不支持最新版本的 SQL Server CE 的所有设计器功能（例如，您不能编辑表）。我认为您必须使用2008版本。

它足够快，但不可否认，我将它用于小型数据集。

# c++ - C++中WinMain、main和DllMain的区别

> ID：416739
> 
> 赞同：25
> 
> 时间：2009-01-06T14:31:05.313
> 
> 标签：c++, windows, entry-point, winmain

这三个功能有什么区别以及何时使用它们？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-06T14:37:32.523

**main()**表示您的程序是一个[控制台应用程序](http://en.wikipedia.org/wiki/Console_application)。

**WinMain()**表示该程序是一个[GUI 应用程序](http://en.wikipedia.org/wiki/Graphical_user_interface)——也就是说，它显示窗口和对话框，而不是显示控制台。

**DllMain()**表示程序是一个[DLL](http://en.wikipedia.org/wiki/Dynamic-link_library)。DLL 不能直接运行，但供上述两种应用程序使用。

所以：

*   在编写要显示窗口等的程序时使用 WinMain。
*   编写 DLL 时使用 DLLMain。
*   在所有其他情况下使用 main。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-06T14:36:40.780

WinMain 用于应用程序（以 .exe 结尾）来指示进程正在启动。它将为进程提供命令行参数，并作为进程的用户代码入口点。WinMain（或不同版本的 main）也是必需的功能。操作系统需要调用一个函数才能*启动*一个进程运行。

DllMain 用于 DLL 以表示许多不同的场景。最值得注意的是，它会在什么时候被调用

1.  DLL被加载到进程中：DLL_PROCESS_ATTACH
2.  DLL 从进程中卸载：DLL_PROCESS_DETACH
3.  进程中启动了一个线程：DLL_THREAD_ATTACH
4.  一个线程在进程中结束：DLL_THREAD_DETACH

DllMain 是一个可选构造，并且有很多与之相关的隐式契约。例如，您不应该调用会强制加载另一个 DLL 的代码。一般来说，要正确使用它是相当困难的功能，除非您有非常特殊的需要，否则应该避免使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-05T08:17:44.760

[您问题的补充]

也不要忘记 DllEntryPoint：

*   当涉及加载时间时，入口点是 DllMain。
    （例如 COM 进程内服务器 DLL）。

*   当涉及运行时间时，入口点是 DllEntryPoint。
    （例如 LoadLibrary 被调用）。

# sql - SQL 连接问题

> ID：416740
> 
> 赞同：0
> 
> 时间：2009-01-06T14:31:25.953
> 
> 标签：sql, database, sql-server-2005

我有两个表，tblEntities 和 tblScheduling。

tbl实体：

```
EntityID  ShortName          Active
1         Dirtville          1
2         Goldtown           1
3         Blackston          0
4         Cornfelt           1
5         Vick               1 
```

tbl调度：

```
ScheduleID EntityID SchedulingYearID
1          1        20
2          1        21
3          2        20
4          3        19
5          5        20 
```

我需要一个查询来显示特定 ScheduleYearID 的**所有**活动实体及其计划信息。

输出应如下所示（在这种情况下，所需的 SchedulingYearID 为 20）：

```
EntityID ScheduleID
1        1
2        3
4        NULL
5        5 
```

到目前为止我写的查询是：

```
SELECT     tblEntities.EntityID, tblEntities.ShortName, tblScheduling.ScheduleID
FROM         tblScheduling RIGHT OUTER JOIN
                      tblEntities ON tblScheduling.EntityID = tblEntities.EntityID
WHERE     (tblScheduling.SchedulingYearID = @SchedulingYearID) 
AND (tblEntities.Active = 1)
ORDER BY tblEntities.EntityID 
```

我的问题是，使用此查询将不包括没有计划信息的活动实体（例如上面示例中的 EntityID 4）。我可以编写查询以很好地显示所有活动实体及其计划状态，但是一旦我开始通过 SchedulingYearID 限制它，我就会丢失那些特定实体。

有没有我明显缺少的解决方案而不必求助于子查询、游标等？如果不是，这没什么大不了的，我只是觉得我在这里遗漏了一些简单的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T14:37:22.713

试试这个......评估连接条件以生成中间连接结果集，然后（对于外部连接），在继续之前将“外部”端的所有行重新添加......评估条件的地方在所有连接完成后...

```
SELECT E.EntityID, E.ShortName, S.ScheduleID
FROM  tblEntities E 
     Left Join tblScheduling S 
        ON S.EntityID = E.EntityID
           And S.SchedulingYearID = @SchedulingYearID 
WHERE E.Active = 1
ORDER BY E.EntityID 
```

我更改了您的加入顺序，因为我更喜欢左加入...但这没关系

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T14:40:23.237

这是 where 子句中的条件： (tblScheduling.SchedulingYearID = @SchedulingYearID)

当没有 tblScheduling 信息时，这总是会失败。添加

(((tblScheduling.SchedulingYearID = @SchedulingYearID) OR (tblScheduling.SchedulingYearID 为空))

或者检查您的数据库使用的任何空条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T14:45:09.623

我认为问题在于 WHERE 子句过滤掉了 SchedulingYearID 为空的行。所以不要。

```
SELECT tblEntities.EntityID, tblEntities.ShortName, tblScheduling.ScheduleID
    FROM tblScheduling RIGHT OUTER JOIN
         tblEntities ON tblScheduling.EntityID = tblEntities.EntityID
    WHERE (tblScheduling.SchedulingYearID = @SchedulingYearID OR
           tblScheduling.SchedulingYearID IS NULL) 
      AND (tblEntities.Active = 1)
    ORDER BY tblEntities.EntityID; 
```

# javascript - Pre-Compile JavaScript from VS2008 IDE

> ID：416747
> 
> 赞同：2
> 
> 时间：2009-01-06T14:32:51.550
> 
> 标签：javascript

Is there a way for me to pre-compile my JS code when building my solution? I would like to be made aware of common problems before I get to the browser. Ideally I would build the sln and, if necessary, have a plugin or call from the build events examine the js code against a Java compiler. Thank you very much in advance!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T14:56:06.620

尽管许多其他发帖人说过，在许多情况下（包括在 Firefox 浏览器中发现的 Mozilla Spidermonkey 引擎），Javascript**实际上被**[编译成字节码](http://groups.google.com/group/comp.lang.javascript/browse_thread/thread/e39888fdf6a02189/6d82d3d25f7c56d2?hl=en#73b83524321d1d4e)，与 Java 中使用的有点相似（但不兼容）。您只是看不到编译器的输出，因为您永远无法使用它，只有 Javascript 字节码解释器才能使用它。也无法保存已编译的字节码以供重用（至少在 Web 浏览器上下文中；在 Spidermonkey 引擎的替代使用中，我确实认为可以将已编译的字节码保存在内存中以供重用，但不能以可以据我所知，保存到磁盘以供将来使用）。

我使用 Javascript shell [JSDB](http://www.jsdb.org)，它也使用 Spidermonkey 引擎；当您加载文件时，它会在运行一行代码之前抱怨语法错误。不过，这与 Java 的编译类型不同；Javascript 是一种松散类型的语言，因此它不会像Java 编译器那样捕捉问题（例如，抱怨它知道你没有做对的每一件事）。

话虽如此，我还是会选择 JSLint，因为它可能会捕获您的许多错误。

附带说明一下，[Rhino](https://developer.mozilla.org/en/Rhino_documentation)项目允许您将[Javascript 编译成 Java 类](https://developer.mozilla.org/en/Rhino_JavaScript_Compiler)；我从未尝试过，但听起来很有趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T15:09:53.130

我为我对“编译”一词的滥用表示歉意。我完全理解编译语言和解释语言之间的区别。我感兴趣的是在构建期间定期检查我的语法，以便标记拼写错误、无效的方法调用等。我将研究 Jason S 对此的建议。我也完全意识到 JavaScript 不是 Java，但之前读过你可以通过 Java 编译器运行 JS 代码以进行语法检查。我希望找到与 VS 更好地集成的东西。
非常感谢大家理解我请求的意图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T14:35:04.743

Javascript is an interpreted language, it's not compiled till runtime. Also, javascript has very, very little to do with Java. Netscape released JavaScript around the same time Sun released Java, and there was some sort of marketing deal between them. Otherwise, they're unrelated.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T14:36:39.610

Javascript isn't compiled, has nothing to do with Java but some shared syntax, and is best tested by loading your app into a browser.

There are some JS testing frameworks/tools available but I couldn't recommend any of them myself.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-11T15:19:29.273

试试[JSLint.VS](http://jslint.codeplex.com/)

# .net - How do you determine the values in a binding?

> ID：416748
> 
> 赞同：1
> 
> 时间：2009-01-06T14:33:40.800
> 
> 标签：.net, wcf, wcf-binding, performance

I have defined a binding that I use to connect to two different services. One I call my Master service that provides configuration information to my program and tells it which Local service to connect to. The Local service returns, along with other things, items that allow me to draw map lines and an MP3 as a file stream. The MP3 can be upto 10 MB and the Maplines can have 10,000 records that I zip and return as a byte array. I have increased most of the default binding settings to get the data to return, the audio was the bigest cause of the increase. I do not understand the various settings in the binding and have increased them very liberally. How do I determine the right size for these settings and am I taking a penatly by increasing them? Thanks.

```
<binding name="netTCPActivity" closeTimeout="01:30:00" openTimeout="01:15:00"
      receiveTimeout="01:10:00" sendTimeout="01:15:00" transactionFlow="false"
      transferMode="Buffered" transactionProtocol="OleTransactions"
      hostNameComparisonMode="StrongWildcard" listenBacklog="100"
      maxBufferPoolSize="152428800" maxBufferSize="50000000" maxConnections="30"
      maxReceivedMessageSize="50000000" portSharingEnabled="true">
      <readerQuotas maxDepth="32" maxStringContentLength="81920" maxArrayLength="6638400"
        maxBytesPerRead="4096" maxNameTableCharCount="563840" />
      <reliableSession ordered="true" inactivityTimeout="00:10:00"
        enabled="false" />
      <security mode="None" />
    </binding> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T23:35:08.753

就像任何限制和配额一样，它们的存在是为了防止坏事发生。例如，如果对同时连接或传入消息大小没有限制，则单个恶意或自私的用户可以占用资源。如果超时时间过长，服务器端错误可能会导致客户端程序等待很长时间。对于小规模使用，我认为您可以保留默认值，直到出现问题，并根据需要调整值。

# javascript - 使用 jQuery 选择复选框组的值

> ID：416752
> 
> 赞同：63
> 
> 时间：2009-01-06T14:35:07.320
> 
> 标签：javascript, jquery

我正在使用 Zend_Form 输出一组复选框：

```
<label style="white-space: nowrap;"><input type="checkbox" name="user_group[]" id="user_group-20" value="20">This Group</label> 
```

对于普通的 HTTP Post，这些值作为数组传递，但是当我对如何使用 jQuery 获取所有值感到有些困惑时。我想我可以使用以下方法选择组：

```
$("input[@name='user_group[]']").val() 
```

但这只是获取列表中第一个复选框的值，而不管它是否被选中。有任何想法吗？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-01-06T15:04:21.877

您可以使用选中的选择器仅获取选定的选择器（无需知道计数或自己遍历它们）：

```
$("input[name='user_group[]']:checked") 
```

使用这些选中的项目，您可以创建这些值的集合或对集合执行某些操作：

```
var values = new Array();
$.each($("input[name='user_group[]']:checked"), function() {
  values.push($(this).val());
  // or you can do something to the actual checked checkboxes by working directly with  'this'
  // something like $(this).hide() (only something useful, probably) :P
}); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-07-10T13:40:35.717

我不确定选择器中使用的“@”。至少对于最新的 jQuery，我必须删除 @ 才能使其与两个不同的复选框数组一起使用，否则会为每个数组选择所有选中的项目：

```
var items = [];
$("input[name='items[]']:checked").each(function(){items.push($(this).val());});

var about = [];
$("input[name='about[]']:checked").each(function(){about.push($(this).val());}); 
```

现在两个，项目和工作。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-07-11T09:25:22.037

使用`.map()`（改编自[http://api.jquery.com/map/](http://api.jquery.com/map/)的示例）：

```
var values = $("input[name='user_group[]']:checked").map(function(index,domElement) {
    return $(domElement).val();
}); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-01-11T09:01:06.907

使用`map`in 而不是`each`可以避免数组创建步骤：

```
var checkedCheckboxesValues = 
    $('input:checkbox[name="groupName"]:checked')
        .map(function() {
            return $(this).val();
        }).get(); 
```

从`map()`文档页面：

> 通过一个函数传递当前匹配集中的每个元素，生成一个包含返回值的新 jQuery 对象

`get()`将这些值转换为数组。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-07T12:12:14.840

mhata dzenyu mese。它实际上

```
var selectedGroups  = new Array();
$(".user_group[checked]").each(function() {
    selectedGroups.push($(this).val());
}); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-06T15:14:51.420

我只是缩短了我选择的答案：

```
var selectedGroups  = new Array();
$("input[@name='user_group[]']:checked").each(function() {
    selectedGroups.push($(this).val());
}); 
```

它就像一个魅力，谢谢！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T15:06:14.153

我不是 100% 完全确定你想如何“抓住”这些价值观。但是，如果您想遍历复选框，您可以使用 .each ，如下所示：

```
("input[@name='user_group[]']").each( function() {
    alert($(this).val());
}); 
```

当然有更好的选择器可用：

```
$(':checkbox') 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-12T13:19:43.790

```
var values = $("input[name='user_group']:checked").map(function(){
      return $(this).val();
    }).get(); 
```

这将为您提供数组中选中框的所有值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-06T14:40:52.847

您可以有一个 javascript 变量来存储发出的复选框的数量，即在`<head>`页面中：

```
<script type="text/javascript">
var num_cboxes=<?php echo $number_of_checkboxes;?>;
</script> 
```

因此，如果在 javascript 代码中有 10 个复选框，从`user_group-1`to开始`user_group-10`，您将通过以下方式获得它们的值：

```
var values=new Array();
for (x=1; x<=num_cboxes; x++)
{
   values[x]=$("#user_group-" + x).val();
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-10T02:03:49.500

```
$(document).ready(function(){
    		$('#btnskillgroup').click(function(){
              getCheckedGroups('skills');
            });
  	$('#btncitiesgroup').click(function(){
              getCheckedGroups('cities');
            });
         var getCheckedGroups = function(groupname){
               var result = $('input[name="'+groupname+'"]:checked');
              if (result.length > 0) {
              	var resultstring = result.length +"checkboxes checked <br>";
              	result.each(function(){
              		resultstring += $(this).val()+" <br>"; //append value to exsiting var
              	});
    			$('#div'+groupname).html(resultstring);
    		}else{
    			$('#div'+groupname).html(" No checkbox  is Checked");
    		}

         };
    	});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
Skills:<input type="checkbox" name="skill"  value="Java"> Java
    <input type="checkbox" name="skill" value="Jquery"> Jquery
    <input type="checkbox" name="skill" value="PHP"> PHP
<br>
<input type="checkbox" name="cities"  value="Pune"> Pune
    <input type="checkbox" name="cities" value="Baramati"> Baramati
    <input type="checkbox" name="cities" value="London"> London

    <input type="submit" id="btnskillgroup" value="Get Checked Skill group">
<input type="submit" id="btncitiesgroup" value="Get cities checked group">
    <div id="divskills"></div>
<div id="divcities"></div>
```

# c++ - Empty _ASSERTE Dialog Box from ISAPI Extension

> ID：416755
> 
> 赞同：2
> 
> 时间：2009-01-06T14:36:29.750
> 
> 标签：c++, c, iis

I have an ISAPI extension DLL written in C++ using Microsoft Visual Studio 2003 running in IIS 5.1 on XP Pro. Whenever an _ASSERTE fires I just get a an empty message box with 'Error' in the title bar and Abort/Retry/Ignore buttons. What I don't see is any of the expression text from the _ASSERTE macro. I've traced into the runtime library source code and I end up in crtmbox.c at a line which looks like it's calling a dynamically loaded MessageBoxA(). lpText (Debug Assertion Failed ...) and lpCaption (Microsoft Visual C++ Debug Library) are valid.

```
 return (*pfnMessageBoxA)(hWndParent, lpText, lpCaption, uType); 
```

If I'm debugging the IIS process then the Retry button breaks into the debugger. If I execute the same code from a Windows executable built from the same source then I get the Assert message box I would expect.

I'm sure I've seen this this working in the past. In fact, moving to Visual Studio 2003 originally helped as the 2003 runtime library correctly adds MB_SERVICE_NOTIFICATION to the MessageBox flags so that at least the resulting message box is visible on the console while debugging the service.

Anyone have any ideas?

JF

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T14:30:14.697

我没有给你的解决方案，只有一个调查建议。一旦您执行了重试以放入调试器，您是否查看了调用堆栈以查看断言发生的上下文？

哦，我仔细查看了 _ASSERTE，它依赖 _CRT_WIDE 来传递消息字符串。如果 _ASSERTE 的编译方式（使用宽字符串）和动态加载 pfnMessageBoxA（看起来像是“窄”字符串类型）之间存在不匹配，则消息字符串看起来像零长度字符串。DevStudio 2003 将其项目默认为您知道的宽字符串。

# java - 如何组织具有多个屏幕/面板的基于 MVC 的程序的控制器？

> ID：416760
> 
> 赞同：2
> 
> 时间：2009-01-06T14:37:16.723
> 
> 标签：java, model-view-controller, generics

我目前正在从事一个用 Java 编写的爱好项目，其中包含大约两个不同的 JFrame，每个 JFrame 大约有 3-4 个 JPanel。我面临的问题是我不太确定如何处理与控制器和不同视图类的交互。

例如，我有一篇 Sun 关于[Java App 的文章。使用 MVC 进行设计](http://java.sun.com/developer/technicalArticles/javase/mvc/)，他们在其中列出了让模型和视图之间的所有通信作为最现代的控制器通过控制器的选项，我也学过这种策略并且应该做得很好。但是，它并没有深入解释如何处理所有元素和不同面板所涉及的所有 ActionListener。

到目前为止，我被教导的“要走的路”是使用一个控制器并通过 getter 将 ActionListener 设置为各种对象并跟踪活动面板。我很棒的 Java 书给出的替代方案是只为每个视图类坚持内部类。任何一种方法似乎都会导致非常讨厌的代码，而我更喜欢一个或多个控制器尽可能地膨胀。

我的问题当然是；您将如何在保持控制器可用的同时尽可能简洁有效地分配 ActionListener？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-31T23:42:13.563

尽管 Markus 的解决方案仍然是我迄今为止看到的最简洁的解决方案，但我还是做了一些细微的改动，希望在原作者眼中也能有所改进 ;)。

如果您为响应事件而添加/删除列表中的项目，则有可能最终对列表进行并发更改；该事件已被处理，但如果在捕获事件之后还有更多项目，则循环将继续。

因此，需要使用稍微不同的方法。我决定使用 ListIterator.add() 方法，因为它支持在遍历列表项时修改列表。可能有更优雅的解决方案可用，但这个解决方案做得相当不错。

以防对他人有帮助；修改后的代码类似如下：

```
ListIterator<ActionListener> iterator = mActionListeners.listIterator();

public void actionPerformed(ActionEvent e)
{
    iterator = mActionListeners.listIterator();
    while (iterator.hasNext()) 
    {
        ActionListener actionListener = (ActionListener)iterator.next();
        actionListener.actionPerformed(e);
    }
}

public void addListener(ActionListener listener)
{
    iterator.add(listener);
}

public void removeListener(ActionListener listener)
{
    iterator.remove(listener);
} 
```

如果有更好的解决方案或改进，我也会很高兴听到这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T14:44:02.137

控制器可以实现 ActionListener 并包含一个 ActionListener 列表。

您必须添加到 3-4 顶部面板操作侦听器的控制器。现在，您可以将所需的任何 ActionListener 添加到控制器操作侦听器列表中。

```
public void addListener(ActionListener listener)
{
   mActionListeners.add(listener);
}

public void removeListener(ActionListener listener)
{
   mActionListeners.remove(listener);
} 
```

当调用控制器动作侦听器时，您必须调用控件列表中的所有动作侦听器。

```
public void actionPerformed(ActionEvent e) {
   List listeners = mActionListeners; // Edit 20090903
   for (Iterator iterator = listeners .iterator(); iterator.hasNext();) {
    ActionListener actionListener = (ActionListener)iterator.next();
    actionListener.actionPerformed(e);
   }
} 
```

# ssh - 创建用于设置 ssh 隧道的无密码辅助 ssh 密钥

> ID：416771
> 
> 赞同：5
> 
> 时间：2009-01-06T14:40:54.063
> 
> 标签：ssh, public-key, tunnel

我需要创建一个自动设置 ssh 隧道的脚本。我认为没有密码的专用 ssh 密钥是一个好的开始，但我找不到这是否可能以及如何做到这一点。此密钥应具有有限的权限（仅设置隧道），但我需要另一个私钥（带有密码）。

谢谢 ！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T15:10:06.127

好的，我找到了答案。

首先，`ssh-keygen -f theNewPrivateKey` 否则它将覆盖旧的私钥。其次，`ssh -i theNewPrivateKey me@mycomputer`该`-i`选项更改用于身份验证的私钥。

现在我可以试试我的脚本了。

* * *

编辑：我的新密钥如何具有有限的权限：

将公钥复制到目标计算机的 $HOME/.ssh/authorized_keys2 文件时，我添加了以下内容：

```
command="sleep 99999999999" ssh-dss AAAAB3NzaC1kc3MA...
(+ the rest of the key) 
```

那么唯一允许的命令就是永远等待。由于创建此密钥的目的是创建反向 ssh 隧道，因此应该没问题。然后我创建隧道：

```
ssh -T -R 7878:localhost:22 -i .ssh/mynewkey  me@myhomecomputer 
```

最后我可以从我的家用电脑登录：

```
ssh myworklogin@localhost -p7878 
```

我希望这没有安全问题。如果这是一件坏事，请告诉我！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T14:44:56.440

试试

`ssh-keygen`

命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T12:49:41.800

我有类似的情况，我必须自动同步服务器内容，而不必在我的 robocopy 脚本中提供密码。

这个[链接](http://kerneltrap.org/node/8178)帮助了我。

# c# - 通用运行时？

> ID：416772
> 
> 赞同：1
> 
> 时间：2009-01-06T14:40:56.463
> 
> 标签：c#, .net, vb.net, clr, runtime

我不清楚的东西，我知道 C# 和 VB.NET 之间存在差异（主要在指针的使用方面）但是为什么如果两者都有一个 Common CLR，那么 XNA（例如）是否只适用于 C# 而不是 VB .NET，还是 Visual Studio 的插件针对的是 C# 而不是 VB.Net，实际上语言扩展在这两种情况下都有效

抱歉，如果这是一个明显的问题，我想我会问

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T14:51:40.157

它是定义语言支持的工具集。例如，XNA 只是用 C# 完成了所有工作，并且只提供了对它的支持。您仍然可以在 VB.NET 中编写应用程序并从命令行手动编译它。只要您的应用程序没有编译为任何非法 IL（XNA 不支持的操作码），它仍然会运行。主要问题是资源——他们没有人力来对所有语言进行全面的开发和测试，所以他们选择了一种。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T15:41:36.763

CLR 已被移植到各种平台，但并非所有平台都是平等的。例如，Xbox 360 CLR[没有 Reflection.Emit 甚至没有完整 CLR 的所有 IL 操作](http://forums.xna.com/forums/p/2706/13402.aspx#13402)。因此，不同的编译器可能会发出在完整 CLR 上合法但在 Compact CLR 上非法的 IL 代码。

另一个问题是类库的可用性。完整的 BCL 包括[Microsoft.VisualBasic](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.aspx)命名空间，它由 VB.NET 编译器自动引用。它包含[VB6 兼容](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.compatibility.vb6.aspx)函数、[My 命名空间](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.myservices.aspx)特性以及一些[编译器辅助函数](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.compilerservices.aspx)，通常称为 VB.NET 运行时。

每当移植 CLR 时，都会移植某些程序集，而不会移植其他程序集。对于 Xbox，Microsoft.VisualBasic 没有被移植。这意味着您不能引用该命名空间中的任何内容。虽然不引用兼容性或 My 命名空间相当容易，但编译器服务可以插入到编译后的 IL 中，而无需显式调用它们。

在 VB.NET 8 中，您可以将[未记录且不受支持的 -novbruntimeref](http://www.codeproject.com/KB/vb/novbruntimeref.aspx)开关传递给 vbc.exe，以防止其引用 Microsoft.VisualBasic.dll。不幸的是，这有时会导致奇怪的编译器错误。在 VB.NET 9 中，它已被[记录和支持并重命名为 /vbruntime](http://msdn.microsoft.com/en-us/library/bb531259.aspx)。

第三种情况是插件和 Visual Studio 支持。这取决于各个包，它们是否支持每种语言的模板、代码生成等。我相信一些第 3 方已经发布了 XNA[的 VB.NET 模板，虽然它没有得到官方支持](http://forums.xna.com/forums/p/1464/7267.aspx#7267)。

我猜想，底线是技术问题（CLR 端口、BCL 可用性、编译器 IL 输出）和支持（测试、资助和其他语言的插件）的混合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T14:59:21.980

从所有方面来看，VB.NET 和 C# 在 CLR 方面都是 99.9999 等价的。但是有一些细微的差异可能会咬到你。另外，我记得在一些微软博客上读到，CLR 可以做的一些事情（还）不能被 VB.NET 或 C# 编程，必须由 IL 完成。确实很有趣。

# language-agnostic - 流畅接口的有趣用途？

> ID：416773
> 
> 赞同：1
> 
> 时间：2009-01-06T14:41:27.820
> 
> 标签：language-agnostic, fluent-interface

我想知道[流畅的界面](http://www.martinfowler.com/bliki/FluentInterface.html)在何时何地是个好主意，所以我正在寻找示例。到目前为止，我只发现了 3 个有用的案例，例如 Ruby 的集合，比如

```
unique_words = File.read("words.txt").downcase.split.sort.uniq.length 
```

和[Fest](http://code.google.com/p/fest/) (Java) 用于单元测试：

```
assertThat(yoda).isInstanceOf(Jedi.class)
    .isEqualTo(foundJedi)
    .isNotEqualTo(foundSith); 
```

和[JMock](http://www.jmock.org/)。你知道其他使用流畅界面的好例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T14:49:55.277

[jQuery](http://jquery.com/) . :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T16:03:02.680

StringBuilder： http: [//msdn.microsoft.com/en-us/library/system.text.stringbuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder(VS.71).aspx) (VS.71).aspx 或

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T18:54:35.500

[规范](http://rspec.info/)。来自主页的示例：

```
# bowling_spec.rb
require 'bowling'

describe Bowling do
  before(:each) do
    @bowling = Bowling.new
  end

  it "should score 0 for gutter game" do
    20.times { @bowling.hit(0) }
    @bowling.score.should == 0
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-20T16:23:38.650

1.  忍者：[http ://www.ninject.org](http://www.ninject.org)
2.  对于不是来自通用库的示例，我为配置向导构建了一个自动回归套件。我创建了一个状态机，它在向导页面上填写值，验证这些值是否可接受，然后转到下一页。状态机中每个步骤的代码如下所示：

    step.Filler().Fill().Verify().GoForward();

# c# - 用自定义滚动条替换面板滚动条

> ID：416795
> 
> 赞同：1
> 
> 时间：2009-01-06T14:46:07.750
> 
> 标签：c#, winforms

有没有办法注入带有自定义滚动条的面板？

当前滚动条存在以下问题：

*   我创建的软件必须适用于紧凑框架和完整框架
*   在 cf 上附加了一个触摸屏，并且默认滚动条不适合触摸屏
*   在完整的框架上，滚动条的行为有时很奇怪。
*   所有控件都可以在应用程序中设置皮肤，我当前的自定义滚动条也是如此，但默认滚动条的外观并不适合所有皮肤。

一种方法是将 2 个面板作为一个自定义控件并将一个移到另一个上，但我不希望以这种方式实现它，因为所有开销。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T07:58:37.743

使用这种方法，您必须承担一些开销。将 Panel 的“AutoScroll”属性设置为 false。设置一个 VScrollBar 并使用面板调整大小事件对其进行处理。

# html - 为什么页面锚有时会丢失？

> ID：416805
> 
> 赞同：18
> 
> 时间：2009-01-06T14:48:09.400
> 
> 标签：html, anchor

在 HTML 页面上，这样的链接：

```
<a href="#pagelocation">Location on Page</a> 
```

...应该导航到页面上的这个位置：

```
<a name="pagelocation"> 
```

但根据我的经验，它有时会丢失 - 特别是在从另一个页面链接时（如`<a href="somepage.html#pagelocation">`）。通过“未命中”，我的意思是它滚动到页面上的错误位置——可能接近，也可能没有。

通常，目标位置最终位于屏幕顶部。我知道如果锚下方没有足够的空间将其滚动到屏幕顶部，这可能会失败。

不然为什么会失败？它完全取决于布局吗？**我该如何解决？**

（我保持这个一般，因为我想要一个包罗万象的参考答案。）

## 更新 1

感谢迄今为止关于非显式图像大小的指针。但是在所有元素都有明确大小的页面上呢？（我现在正在处理一个。）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-06T14:52:29.873

在页面完成加载之前，通常会发生滚动。如果你的图片没有宽度和高度，页面会跳转，然后加载图片并自行重新布局，让你之前跳转的地方看起来不对。

编辑：任何其他可以改变页面布局的东西也应该被怀疑......这包括未加载的javascript和CSS `<head>`（不要介意所有CSS*都应该*加载到头部；并非总是如此）。

如果页面通过重定向反弹，我相信 IE 会滚动结束页面，但 Firefox 不会。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-03T11:38:24.807

**JS解决方案**

在准备好的文档上运行此功能。

```
 function goToAnchor() { 
    hash = document.location.hash;
    if (hash !="") {
        setTimeout(function() {
            if (location.hash) {
                window.scrollTo(0, 0);
                window.location.href = hash;
            }
        }, 1);
    }
    else {
        return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-06T14:51:07.600

我相信您看到的行为是浏览器在所有图像完成加载之前定位到页面上该位置的结果。一旦图像完成加载，页面的布局就会发生变化（例如，页面可能在垂直方向上更长），导致锚点的位置应该发生变化 - 但浏览器仍然认为它已经导航到那个位置锚。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T15:37:18.863

如上所述，这可能是由于图像延迟渲染并在加载时“调整”布局。

如果您可以指定图像的大小，则可以在渲染之前分配那么多空间，这应该可以防止出现问题。

作为旁注，我之前遇到过这个问题，即在图像需要重新加载的足够多的页面之间使用前进/后退的形式，导致我在渲染后最终出现在错误的位置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-29T21:20:36.210

当 JavaScript 在页面顶部创建下拉菜单时，我也看到了这种情况。然后，一旦菜单完成，它就会被隐藏，向上滚动下面的内容。

同时，浏览器已经在窗口顶部设置了目标位置。隐藏页面顶部的菜单会将目标位置从窗口顶部向上移动。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T15:15:34.040

请注意，您可以添加`id="pagelocation"`到几乎任何 HTML 元素，以获得相同的结果，这样您就可以为链接目标添加额外的锚点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-01T10:19:20.037

好的。我认为这是新的。使用 HTML5`autofocus`会导致失败，jQuery 的`focus()`方法也一样。花了 90 分钟的反复试验才发现这一点，因为我认为问题与图像有关 :)

# user-interface - 网络用户期望

> ID：416813
> 
> 赞同：7
> 
> 时间：2009-01-06T14:49:45.027
> 
> 标签：user-interface

**在设计一个好的 Web GUI 时，我们可以从最终用户那里得到什么期望？**

我想出了以下内容，但我想知道是否还有其他人可以建议..

*   如果我点击一个超链接，它将带我到另一个页面/该页面的一部分
*   如果我勾选/取消勾选一个复选框，它可能会改变页面状态（启用/禁用元素）
*   如果我点击一个按钮，我希望它会对数据做一些事情。
*   如果我单击一个按钮，我希望立即发生某些事情（到当前页面，或者让我被带到另一个页面）
*   如果我点击了一个超链接，它把我带到了另一个页面，我希望能够使用返回按钮回到上一个页面，状态类似于我离开它的状态
*   如果我更改表单中的某些内容，我可以在必要时将其更改回之前的值
*   除非我点击“提交”按钮，否则我的数据不会发生任何事情。
*   如果我为某个页面添加书签/收藏，那么每次访问它时它都应该显示相同的相关数据
*   如果文本带有下划线并且看起来像一个链接，它应该是一个链接并充当一个链接

这个问题背后的原因更像是一个“来自地狱的用户界面”。例如，我遇到过选中记录旁边的复选框将通过 ajax 立即删除它的页面。对我来说这似乎是错误的，复选框是一个切换 - 删除操作绝对不是！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T14:58:51.360

*   如果某些文本带有下划线，则应为链接。

*   如果我按下后退按钮，我将返回上一页，我将其识别为上一页。

*   如果某件事是异步发生的，那对我来说很明显它正在飞行，并且很明显它何时以何种状态完成。

*   如果我想扩大或缩小文本大小（ctrl++，ctrl+-），则不应以牺牲布局为代价。

*   在我希望选择多个项目的情况下，我不会看到一组无线电输入。

*   如果我想禁用 Javascript 或 Flash，我将被允许这样做，并且仍然可以访问网站的基本功能。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-06T15:03:51.910

*   如果表单未通过验证，我不希望在重试之前重新输入
*   如果一个控件被禁用，它应该是灰色的/以某种方式表示
*   当我按下返回时，我希望返回，而不是被抛出系统（血腥的银行网站）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T15:07:31.670

这个问题中嵌入了 UI 设计的基本原则。我强烈建议接触 UI 设计的每个人都应该至少阅读我们自己的 Joel 的[“控制环境让你快乐”](http://www.joelonsoftware.com/uibook/chapters/fog0000000057.html)，这是我几年前读过的一篇文章，至今仍与它一样重要是它写成的那一天。

我还推荐这本书[“别让我思考！”](https://rads.stackoverflow.com/amzn/click/com/0321344758) 作为关于良好 UI 设计原则的优秀资源，特别是关于约定的力量和重要性的资源。

你的清单都是关于约定的。

几条评论：

*   “后退”按钮一直（并且可能只要 Web 存在）一直存在争议。禁用它的使用有安全和可用性原因。重复提交在论坛上可能会令人烦恼，但对于购买股票的订单来说，这可能是一个代价高昂的错误。这可以使用其他技术（例如 POST+REDIRECT+GET 或覆盖浏览器历史记录）来处理，但要点仍然存在：后退按钮行为并不总是可取的，更不用说需要了；
*   为页面添加书签并期待结果有一些优点（例如，如果我为 GOOG 的报价添加书签，那么我应该返回那里获取当前报价，而不是我在添加书签时看到的报价，显然）但是页面结果也可以代价高昂，因此这可能并不总是合适的。

我将添加一对：

*   如果我可以点击它并且它不是一个按钮，那么当我的鼠标悬停在它上面时光标应该变成一只手；
*   相反，如果光标变成一只手，我应该能够点击它，它会做一些事情；和
*   如果有一个包含一些带有边框的文本的框并且它看起来像表单上的文本元素，那么我应该能够输入它，除非它表明它是“只读”或“禁用”（例如通过变灰出来）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T02:09:28.887

If an ad says i've won a million dollars, give me the money. If not, make the ad go away.

# visual-studio - 编译时出现签名不匹配错误，即使它在 VS.NET 2005 中匹配

> ID：416840
> 
> 赞同：0
> 
> 时间：2009-01-06T14:53:53.833
> 
> 标签：visual-studio, compiler-construction, reference

我将项目中的引用从指向特定的硬编码 DLL 更改为项目引用，现在我收到一个错误消息，告诉我某些事件处理程序的签名不匹配，即使它们匹配。

这是一个确切的消息：

方法“Private Sub ObjectsGrid_CellChange(sender As Object, e As Infragistics.Win.UltraWinGrid.CellEventArgs)”无法处理事件“公共事件 CellChange(sender As Object, e As Infragistics.Win.UltraWinGrid.CellEventArgs)”，因为它们没有相同的签名。

奇怪的是，如果我将控件放在 GUI 编辑器中并让 VS 自动创建处理程序，它仍然会产生相同的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T16:24:35.927

编译后的 dll、其各自的项目和用户项目是否都引用了相同版本的 Infragistics 程序集？从我所见，任何时候你有一个似乎匹配的签名，这样的错误意味着你引用了一个程序集的两个不同版本并试图使用一个来代替另一个。

# c# - 加入并包含在实体框架中

> ID：416847
> 
> 赞同：29
> 
> 时间：2009-01-06T14:57:40.533
> 
> 标签：c#, .net, sql, linq, entity-framework

我有以下关于 linq to entity 的查询。问题是它似乎没有加载“标签”关系，即使我已经为它添加了一个东西。如果我不加入标签，它工作正常，但我需要这样做。

```
 var items = from i in db.Items.Include("Tags")
                        from t in i.Tags
                        where t.Text == text
                        orderby i.CreatedDate descending
                        select i; 
```

有没有其他方法可以询问这个问题？可能是分开了还是怎么的？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-01-06T15:12:25.747

好吧，包含与 where 相矛盾。包括说，“加载所有标签。” where 表示“加载一些标签”。当 query 和 Include 之间存在矛盾时，query 总是会获胜。

**要从具有至少**一个标签 == 文本的**任何**项目返回**所有**标签：

 ****```
 var items = from i in db.Items.Include("Tags")
                    where i.Tags.Any(t => t.Text == text)
                    orderby i.CreatedDate descending
                    select i; 
```

（未经测试，因为我没有你的数据库/模型）

这是[一本关于 LINQ 的非常好的免费书籍](http://www.mindviewinc.com/Books/CSharp/Index.php "C# 3.0 中的 C# 查询表达式和支持功能")。

# perl - 如何从 PDF 文件中提取页面？

> ID：416851
> 
> 赞同：8
> 
> 时间：2009-01-06T14:59:07.940
> 
> 标签：perl, pdf

是否有任何 Perl 脚本可以从 PDF 文件中获取页面并将其转换为另一个 PDF 文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T15:03:27.153

[.pdf](http://www.accesspdf.com/pdftk/) _

```
~$ pdftk multi-page.pdf burst 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T05:10:32.700

您要求使用 Perl，所以这是通过[CAM::PDF](http://search.cpan.org/perldoc?deletepdfpage.pl)提供的一个很好的解决方案。假设您只想将 orig.pdf 的第 3-6 页保存到 new.pdf：

```
deletepdfpage.pl orig.pdf 1-2,7- new.pdf 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T16:45:51.737

正如*gnud*已经回答的那样，[pdftk](http://www.pdftk.com/)是完成这项工作的最佳工具。例如，要将第 5-10 页从**test.pdf**提取到**out.pdf** ，您可以编写：

```
pdftk test.pdf cat 5-10 output out.pdf 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T15:06:19.033

在 OS X 上，您可以在预览中执行此操作，方法是在缩略图视图中拖动页面。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-15T00:04:49.637

Andreas 给出的代码对我不起作用。如果使用[Pdftk](http://www.accesspdf.com/pdftk/)，在 Windows 上这个公式对我有用：

```
pdftk source.pdf cat 123-128 output out.pdf dont_ask 
```

Source 显然是源 pdf，123-128 是要提取的页面间隔，而 out.pdf 是新的 pdf。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-19T04:51:04.077

我相信实际代码...此代码可能对您有用：

使用 CAM::PDF；

我的 $file_name="abc.pdf";

我的 $pdf = CAM::PDF ->new($file_name); 我的 $no_pages=$pdf->numPages();

for(my $i=1;$igetPageText($i); print "$page\n"; # 你可以读取它一个数组/等...操作可以在这里完成 }

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T15:05:40.627

交互式地，有完整版的 Acrobat。以编程方式有来自 Adob​​e 的[Acrobat SDK](http://www.adobe.com/devnet/acrobat/index.html?navID=downloads)和许多第 3 方解决方案。谷歌[杂技API](http://www.google.com/search?q=acrobat+api)。

# compiler-construction - 我的 AST 应该是什么样子才能轻松转换？

> ID：416854
> 
> 赞同：1
> 
> 时间：2009-01-06T14:59:23.807
> 
> 标签：compiler-construction, abstract-syntax-tree

我有一种类似于 javascript 的最小玩具语言。我生成了一个 AST 来尝试一些优化技术，比如逃逸分析、类型推断。我尝试了一些方法，例如概括运算符标记而不是每个类/函数，在每个节点上保留类型信息......但我仍然不觉得我要去任何地方。工作很快就会变得笨拙......

我研究了 lua5、neko、v8，但是......好吧......我肯定不是周围最聪明的人之一。

有没有人有设计 AST 和在 AST 上实现转换的经验，这很容易处理？我会很感激让您的生活更轻松的提示和技巧？

（请不要叫我去看龙书，我已经有了。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T19:12:49.587

As Alan mentioned, the Appel books are great. I had *Modern Compiler Implementation in ML* for an undergraduate course on compilers.

I would personally avoid doing many transformations on an AST simply because of the number of different constructs you can have and the number of ways the same thing can be expressed. You will frequently have to write code that handles a large number of cases and sub-cases, and as you said, it gets unwieldly very quickly.

It is better to transform the AST to a more minimal representation such as basic blocks in a control flow graph. Each operation can then be written as a simple statement in a basic block. The set of possible operations should be kept small. Just make sure to keep enough information that you can still do all the transformations you want (in particular, don't throw away types). You can also use Single Static Assignment form, where each program variable gets assigned only once. This provides an invariant which simplifies a lot of transformations and analyses.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T15:05:22.250

我使用[ANLTR.org](http://antlr.org)，我觉得这很容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-12T10:09:51.137

ASTs represent the structure of program. For complex languages, your AST will necessarily be complicated. So don't assume this should be "easy".

Many folks assume that having an AST, life will be easier. But parsing is just the foothills of the Himalayas. ASTs don't represent the common inferences, such as the meaning of an identifier, what statement executes next, where this data is consumed. Unless you have all these available, you're not going to be able to do much with a real language, let alone do it easily.

It is best to make those inference results cached or explicit: symbol tables, control flows, data flows, ...

One can add pattern matching langauges to enable the recognition of syntax structures, or even to write transformation rules:

```
optimize_increment(x:exp):statement
= " \x=\x+1; " -->  " \x++ " if no_side_effects(x); 
```

Such rules need to draw on the cached inferences (eg., "side_effects").

Trying to build all this is really hard. One way to make this practical is to amortize the infrastructure cost across many lanuages and transformation applications. Our [DMS Software Reengineering Toolkit](http://www.semdesigns.com/Products/DMS/DMSToolkit.html) has all this machinery to varying degree for a wide variety of langauges, including C, C++, Java, C# and COBOL.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T03:26:06.140

Okay, I won't recommend the Dragon book, since you already have it. Can I recommend the [Appel](http://www.cs.princeton.edu/~appel/modern/) books? There is even some [source code](http://www.cs.princeton.edu/~appel/modern/java/project.html) demonstrating the concepts, among them using the Visitor pattern for translating Abstract Syntax Trees to Concrete Syntax Trees. Good luck, and enjoy!

# vba - 确定用户的组成员身份

> ID：416856
> 
> 赞同：10
> 
> 时间：2009-01-06T15:00:15.163
> 
> 标签：vba, security, ms-access

如何确定用户（例如 Access）是否是 Active Directory 安全组的成员？

我宁愿不在我的小 Access DB 中构建一个完整的身份验证系统。

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-06T15:22:30.390

艾伦在[网上找到了这个](http://my.advisor.com/doc/08691)

```
Function IsMember(strDomain As String, strGroup _
  As String, strMember As String) As Boolean
  Dim grp As Object
  Dim strPath As String

  strPath = "WinNT://" & strDomain & "/"
  Set grp = GetObject(strPath & strGroup & ",group")
  IsMember = grp.IsMember(strPath & strMember)
End Function 
```

您可以通过环境变量获取 Windows 帐户`USERDOMAIN`信息`USERNAME`：

```
Function GetCurrentUser() As String
    GetCurrentUser = Environ("USERNAME")
End Function

Function GetCurrentDomain() As String
    GetCurrentDomain = Environ("USERDOMAIN")
End Function 
```

把它们放在一起：

```
If IsMember(GetCurrentDomain, "AD Group", GetCurrentUser) Then
   DoStuff()
End If 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-05-24T16:07:04.180

我迟到了，但你需要的代码在下面。它为您获取用户名和域名。

请注意，我没有使用 objGroup.Ismember - 这实际上是使用正确的方法 - 我正在枚举用户所在的组列表，因为它更容易调试并且没有明显的性能损失。

...我从早期项目中提取了代码，在该项目中，我需要检查“读取报告”组、“编辑数据”组和“编辑系统数据”组的成员资格，以便我可以选择哪个要启用的控件以及以只读方式打开的表单。枚举组一次比三个单独的检查更快。

```
Public Function UserIsInGroup(GroupName As String, _
                              Optional Username As String, _
                              Optional Domain As String) As Boolean
'On Error Resume Next

' Returns TRUE if the user is in the named NT Group.

' If user name is omitted, current logged-in user's login name is assumed.
' If domain is omitted, current logged-in user's domain is assumed.
' User name can be submitted in the form 'myDomain/MyName' 
'                                        (this will run slightly faster)
' Does not raise errors for unknown user.
'
' Sample Usage: UserIsInGroup( "Domain Users")

Dim strUsername As String
Dim objGroup    As Object
Dim objUser     As Object
Dim objNetwork  As Object

UserIsInGroup = False

If Username = "" Then
    Set objNetwork = CreateObject("WScript.Network")
    strUsername = objNetwork.UserDomain & "/" & objNetwork.Username
Else
    strUsername = Username
End If

strUsername = Replace(strUsername, "\", "/")
If InStr(strUsername, "/") Then
    ' No action: Domain has already been supplied in the user name
Else    
    If Domain = "" Then
        Set objNetwork = CreateObject("WScript.Network")
        Domain = objNetwork.UserDomain
    End If        
    strUsername = Domain & "/" & strUsername        
End If

Set objUser = GetObject("WinNT://" & strUsername & ",user")    
If objUser Is Nothing Then    
    ' Insert error-handler here if you want to report an unknown user name
Else
    For Each objGroup In objUser.Groups
        'Debug.Print objGroup.Name
        If GroupName = objGroup.Name Then
            UserIsInGroup = True
            Exit For
        End If
    Next objGroup
End If

Set objNetwork = Nothing
Set objGroup = Nothing
Set objUser = Nothing

End Function 
```

希望这个迟到的提交对其他开发人员有用：当我第一次查找这个时，早在 2003 年，就像没有人在 Excel 或 MS-Access 中使用过 AD 组一样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T15:07:51.027

[在网上](http://my.advisor.com/doc/08691)找到这个

```
Function IsMember(strDomain As String, strGroup _
  As String, strMember As String) As Boolean
  Dim grp As Object
  Dim strPath As String

  strPath = "WinNT://" & strDomain & "/"
  Set grp = GetObject(strPath & strGroup & ",group")
  IsMember = grp.IsMember(strPath & strMember)
End Function 
```

现在，我只需要当前用户的帐户名。太糟糕了`Application.CurrentUser`，没有给我他们的域名帐户名称。

# gridview - ASP.NET：当列不可见时，GridView 值设置为 null

> ID：416861
> 
> 赞同：1
> 
> 时间：2009-01-06T15:02:31.757
> 
> 标签：gridview, asp.net-2.0

我使用对象列表作为我的 GridView 的数据源，当我将列设置为不可见时，更新失败，因为这些列的值更改为空（并且该列不允许空值）。当列可见时，这些值确实存在，但我真的不想显示这些列，因为在大多数情况下，它们是用户并不真正需要查看的 ID 列。

编辑：我已经尝试了隐藏字段选项，但它仍然将值设置为 null。我查看了页面源，隐藏字段存在并具有适当的值...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T19:42:32.440

我发现这个解决方案可以模拟 .Net 2.0 中的隐藏列：

实现 GridView.RowCreated 事件。

```
protected void GridView1_RowCreated(object sender, GridViewRowEventArgs e)
{
    e.Row.Cells[1].Visible = false;
    e.Row.Cells[2].Visible = false;
} 
```

这是链接： [http://www.beansoftware.com/ASP.NET-Tutorials/GridView-Hidden-Column.aspx](http://www.beansoftware.com/ASP.NET-Tutorials/GridView-Hidden-Column.aspx)

我猜在 2.0 中，当一列不可见时，该列的数据绑定失败，但此方法在链接建立后隐藏，因此它会欺骗系统（？）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-13T14:35:07.370

[Microsoft 建议使用 GridView 控件的 DataKeyNames 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.datakeynames.aspx)。

您可以从 GridView 中删除绑定字段并在 DataKeyNames 属性中指定它们，而不是使用代码隐藏来隐藏某些列：

```
<asp:GridView ID="GridView1" runat="server" 
        DataKeyNames="SalesOrderID,SalesOrderDetailID"
        DataSourceID="LinqDataSource1"> 
```

这样，字段不会显示给用户，但 GridView 知道要保留这些值以进行更新等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T15:07:01.763

如果您还没有这样做，我会考虑为您的数据使用模板列并执行“手动”数据绑定（“内联”或使用 RowDataBound 事件在页面后面的代码中）。这样，您可以测试 DBNull 并在值为 NULL 时简单地忽略将值放入列中。这也将允许正确隐藏列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T15:45:02.920

您可以使用隐藏字段来显示您不想显示的值。这样，您仍然可以像今天一样使用相同的数据绑定和其他功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-26T05:18:44.200

当 GridView 中的字段变为不可见时，其单元格值无法更容易访问，或者这些值为 null 或空。

为了解决这个问题，您只需通过执行将列名（隐藏字段）分配给 GridView 的 DataKeyNames 属性`DataKeyNames="colName1,colName2,colName3"`。

然后访问它们的单元格值`cellValue = GridView1.DataKeys[0]["ID"].ToString();`

我在[这里](http://aspdotnetcode.source-of-humor.com/TipsAndTricks/GridView/AccessGridViewHiddenFieldCellValues.aspx)写了一篇简单的文章来演示您的问题的解决方案。

# c# - 如何从 WebBrowser.ShowPageSetupDialog 获取对话框结果

> ID：416873
> 
> 赞同：0
> 
> 时间：2009-01-06T15:05:07.710
> 
> 标签：c#, .net, printing, webbrowser-control, dialogresult

我在我的 Visual C# (.net 2.0) 应用程序中使用 WebBrowser 控件。
现在我想添加一个打印按钮，它显示页面设置对话框，然后在用户按下 OK 按钮时直接打印，或者在用户按下取消按钮时取消打印。
但是 WebBrowser.ShowPageSetupDialog 不返回 DialogResult，而只是无效。
有没有我错过的东西或任何其他方式来了解用户的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T20:13:24.733

WebBrowser 控件的页面设置对话框设置注册表项。我过去所做的是在代码中为用户设置这些值，并且只给他们打印的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-12-01T17:03:12.223

我遇到了同样的问题，通过观察 IE 页面设置在 @"Software\Microsoft\Internet Explorer\PageSetup" 注册表中存储边距值的方式，能够找到一个花哨的解决方法。

当您在 IE 页面设置中按下 OK 按钮时，它将设置中写入的边距值存储为长度为 8 的字符串 (REG_SZ)，剩余空间用 0 填充。

> IE
> 
> 0.75 存储为 0.750000
> 
> 1.0 存储为 1.000000
> 
> 2 存储为 2.000000

当您使用 WebBrowser.Print() 时，它会将边距值转换为浮点数，因此将 0.75 或 0.750000 作为注册表中的边距值会产生相同的结果。

但是，如果将它们作为字符串进行比较，0.75 和 0.750000 将被视为不同。

诀窍来了：

1.  在调用 WebBrowser.ShowPageSetupDialog() 之前，删除注册表边距值中的尾随 0

> IE
> 
> 0.750000 -> 0.75
> 
> 0.500000 -> 0.5
> 
> 1.000000 -> 1

2.  将其中一个边距值存储在字符串变量中

3.  调用 WebBrowser.ShowPageSetupDialog()

4.  如果用户按下 OK，注册表中的边距值将用 0 填充回来。否则，它们将保持修剪，如第 1 点所述。

5.  将注册表中的边距值与变量中存储的边距值进行比较，如果它们相同，则用户按下“取消”，否则用户按下“确定”。

例子 ：

```
private void ie_DocumentCompleted(object _sender, WebBrowserDocumentCompletedEventArgs e)
{
    System.Windows.Forms.WebBrowser ie = (System.Windows.Forms.WebBrowser)_sender;

    string strKey = "Software\\Microsoft\\Internet Explorer\\PageSetup";
    bool bolWritable = true;
    RegistryKey ok = Registry.CurrentUser.OpenSubKey(strKey, bolWritable);

    ok.SetValue("margin_left", 0.75, RegistryValueKind.String);

    string reg_validation = (string) ok.GetValue("margin_left");

    ie.ShowPageSetupDialog();

    if (reg_validation.Equals((string)ok.GetValue("margin_left")))
    {
        MessageBox.Show("Cancel");
    }
    else
    {
        MessageBox.Show("OK");
        ie.Print();
    }
    ok.Close()
} 
```

# clearcase - 在 ClearCase 中创建一个新的子目录结构？

> ID：416875
> 
> 赞同：4
> 
> 时间：2009-01-06T15:05:35.480
> 
> 标签：clearcase

我是一个 ClearCase 新手，到目前为止，我已经习惯了 SVN。因此，我对创建包含多个 ClearCase 文件的新目录结构所需采取的步骤有点困惑。

因此，举例来说，ClearCase 中有一个现有的目录结构，如下所示：

```
\ParentDirectory
    \ChildDirectory1
        \File1
        \File2
    \ChildDirectory2
    \ChildDirectory3
        \File1
    \ChildDirectory4 
```

如果我想在这个结构中添加一个新的子目录 ChildDirectory5，它将包含许多其他文件，我该怎么做呢？从我一直在阅读的内容来看，我需要首先检查父目录，然后使用 mkelem 命令创建每个子目录和文件。

但是，我已经在本地机器上创建了必要的文件和目录，所以我只需要以某种方式将它们签入 ClearCase。使用 SVN，我需要做的就是将父文件夹复制到已签出的存储库中，然后对其执行添加和提交命令序列。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T21:14:52.737

正如[我如何使用 ClearCase 递归地“添加到源代码控制……”中解释的那样？](https://stackoverflow.com/questions/138321)，您必须使用 clearfsimport 执行您所说的操作（检查父目录，元素的 mkelem）

```
clearfsimport -preview -rec -nset c:\sourceDir\ChildDirectory5 m:\MyView\MyVob\ParentDirectory 
```

注意：

*   -preview 选项：它将允许在不实际执行任何操作的情况下检查会发生什么。
*   '*' 只在 Windows 环境下使用，为了导入目录的内容
*   -nset 选项（参见我之前关于 nset的[回答）。](https://stackoverflow.com/questions/138321#144310)

对于需要导入大量数据的初始化阶段，我建议使用**动态视图**：无需进行任何更新即可快速查看视图的外观（例如“不更新工作区”）：
ClearCase 允许以两种方式访问​​数据方法：

*   快照视图（类似于 SVN 工作区，除了所有 .svn 实际上都外部化在工作区外部的视图存储中）
*   动态视图：您的所有文件都通过网络可见（即时访问/更新）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-15T14:49:49.653

我使用了这个脚本的一个变体（我称之为“ctadd”）：

```
#!/usr/bin/perl

use strict;
use Getopt::Attrribute;

(our $nodo : Getopt(nodo));
(our $exclude_pat : Getopt(exclude_pat=s));

for my $i (@ARGV) {
  if ($i =~ /\s/) {
    warn "skipping file with spaces ($i)\n";
    next;
  }
  chomp(my @files = `find $i -type f`);
  @files = grep !/~$/, @files;  # emacs backup files
  @files = grep !/^\#/, @files; # emacs autosave files
  if (defined($exclude_pat)) {
    @files = grep !/$exclude_pat/, @files;
  }
  foreach (@files) {
    warn "skipping files with spaces ($_)\n" if /\s/ ;
  }
  @files = grep !/\s/, @files;
  foreach (@files) {
    my $cmd = "cleartool mkelem -nc -mkp \"$_\"";
    print STDERR "$cmd\n";
    system($cmd) unless $nodo;
  }
} 
```

cleartool mkelem 的 -mkpath 选项将自动创建和/或签出任何需要的目录。

对于这个脚本，-nodo 将让它简单地输出命令，而 -exclude 将允许您指定一个模式，任何匹配它的文件都将被排除在外。

请注意，Getopt::Attribute 不是标准 Perl 发行版的一部分，但它可以在您附近的 CPAN 镜像上使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T16:03:34.880

您必须**导入**本地目录结构。命令是[clearfsimport](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/clearfsimport.htm)。

# sql - 仅使用 SQL 将图片插入 SQL Server 2005 图像字段

> ID：416881
> 
> 赞同：73
> 
> 时间：2009-01-06T15:06:23.357
> 
> 标签：sql, sql-server, sql-server-2005, image

使用 SQL Server 2005 和 Management Studio 如何将图片插入到`Image`表的类型列中？

最重要的是如何验证它是否存在？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-01-06T15:16:48.747

```
CREATE TABLE Employees
(
    Id int,
    Name varchar(50) not null,
    Photo varbinary(max) not null
)

INSERT INTO Employees (Id, Name, Photo) 
SELECT 10, 'John', BulkColumn 
FROM Openrowset( Bulk 'C:\photo.bmp', Single_Blob) as EmployeePicture 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2010-03-23T09:15:56.117

对于更新记录：

```
 UPDATE Employees SET [Photo] = (SELECT
 MyImage.* from Openrowset(Bulk
 'C:\photo.bmp', Single_Blob) MyImage)
 where Id = 10 
```

**笔记：**

*   确保为您正在使用的登录添加“BULKADMIN”角色权限。
*   使用 SQL Server Management Studio 时路径未指向您的计算机。如果您在本地计算机上启动 SSMS 并连接到服务器 X 上的 SQL Server 实例，则文件 C:\photo.bmp 将指向服务器 X 上的硬盘 C:，而不是您的计算机！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-01T09:42:29.273

创建表：

```
Create Table EmployeeProfile ( 
    EmpId int, 
    EmpName varchar(50) not null, 
    EmpPhoto varbinary(max) not null ) 
Go 
```

插入语句：

```
Insert EmployeeProfile 
   (EmpId, EmpName, EmpPhoto) 
   Select 1001, 'Vadivel', BulkColumn 
   from Openrowset( Bulk 'C:\Image1.jpg', Single_Blob) as EmployeePicture 
```

这个 Sql 查询工作正常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-22T12:39:44.213

我实现了在数据库中插入多个图像的目标

```
INSERT INTO [dbo].[User]
           ([Name]
           ,[Image1]
           ,[Age]
           ,[Image2]
           ,[GroupId]
           ,[GroupName])
           VALUES
           ('Umar'
           , (SELECT BulkColumn 
            FROM Openrowset( Bulk 'path-to-file.jpg', Single_Blob) as Image1)
           ,26
           ,(SELECT BulkColumn 
            FROM Openrowset( Bulk 'path-to-file.jpg', Single_Blob) as Image2)
            ,'Group123'
           ,'GroupABC') 
```

# java - ExecutorService vs Swing Timer

> ID：416893
> 
> 赞同：4
> 
> 时间：2009-01-06T15:09:20.980
> 
> 标签：java, swing, timer

我最近一直在阅读[Filthy Rich Clients](http://filthyrichclients.org/)并注意到，虽然 Java 的版本是 6，但没有提到并发框架。所以，他们谈论 java.util.Timer 和 javax.swing.Timer 而不是 ExecutorService。

我在“ [Java Timer vs ExecutorService](https://stackoverflow.com/questions/409932/java-timer-vs-executorservice) ”这个问题中阅读了 ExecutorService 的优势，并决定使用后者而不是前者。但是这本书谈到了 javax.swing.Timer 以及它专门针对 Swing 开发的优势。

那么，这是否意味着，对于 Swing 开发（动画按钮等）来说，javax.swing.Timer 仍然是更好的选择，或者新的并发框架中是否有相关的类来替代它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T15:42:51.690

Swing Timer 至少在 EDT 上运行，因此您不必使用调用 invokeLater 来包装所有内容。它还与 Swing 很好地联系在一起，因为它使用 Actions、ActionListeners 和其他与 Swing 相关的类。

对于与 Swing 相关的任务，我会坚持使用 Swing Timer，并将新的并发包用于不涉及更新 GUI 的事情。

看看[在 Swing 应用程序中使用计时器，](http://java.sun.com/products/jfc/tsc/articles/timer/)因为它可能包含更多信息来做出决定（对不起）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T15:43:19.723

我想说，对于简单的挥杆相关的东西，更好的选择是因为[这里](http://java.sun.com/docs/books/tutorial/uiswing/misc/timer.html)`javax.swing.Timer`提到的优点。

> 请注意，Swing 计时器的任务是在事件调度线程中执行的。这意味着任务可以安全地操作组件，但也意味着任务应该快速执行。

另一方面，如果您需要执行非 Swing 相关或更复杂/冗长的处理操作，`ExecutorService`则非常健壮，绝对是要走的路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T16:05:16.403

只是一个详细说明 bruno 建议的建议，在不破坏 Swing 的情况下利用出色的 Java 1.5+ 并发实用程序的一种模式是让您`ExecutorService`完成所有繁重的工作（如 bruno 所说），但一旦完成，`ExecutorService`线程应该移交使用以下之一与 Runnable 中的 AWT 线程的实际 UI 组件交互：

*   `javax.swing.SwingUtilities.invokeAndWait(Runnable doRun)`
*   `javax.swing.SwingUtilities.invokeLater(Runnable doRun)`

这些方法传递可运行对象以由 AWT 线程执行。

# c# - 如何在 C# 中旋转标签？

> ID：416897
> 
> 赞同：12
> 
> 时间：2009-01-06T15:11:39.117
> 
> 标签：c#, winforms, text

我想显示一个旋转 90 度的标签（所以我可以将它们中的一堆放在表格的顶部作为标题）。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-06T15:16:33.507

您将需要编写自己的控件或使用自定义控件。

A您可以从[Code Project](http://en.wikipedia.org/wiki/The_Code_Project)文章开始使用*[C# 中的自定义文本 - 面向控件 - 第 I 部分（标签控件）](http://www.codeproject.com/KB/miscctrl/customtext.aspx)*。这包含额外的功能，因此如果您愿意，您应该能够将其修剪掉。

这里有一些有趣的代码：

```
/// <summary>
/// This is a lable, in which you can set the text in any direction/angle
/// </summary>

#region Orientation

//Orientation of the text

public enum Orientation
{
    Circle,
    Arc,
    Rotate
}

public enum Direction
{
    Clockwise,
    AntiClockwise
}

#endregion

public class OrientedTextLabel : System.Windows.Forms.Label
{
    #region Variables

    private double rotationAngle;
    private string text;
    private Orientation textOrientation;
    private Direction textDirection;

    #endregion

    #region Constructor

    public OrientedTextLabel()
    {
        //Setting the initial condition.
        rotationAngle = 0d;
        textOrientation = Orientation.Rotate;
        this.Size = new Size(105,12);
    }

    #endregion

    #region Properties

    [Description("Rotation Angle"),Category("Appearance")]
    public double RotationAngle
    {
        get
        {
            return rotationAngle;
        }
        set
        {
            rotationAngle = value;
            this.Invalidate();
        }
    }

    [Description("Kind of Text Orientation"),Category("Appearance")]
    public Orientation TextOrientation
    {
        get
        {
            return textOrientation;
        }
        set
        {
            textOrientation = value;
            this.Invalidate();
        }
    }

    [Description("Direction of the Text"),Category("Appearance")]
    public Direction TextDirection
    {
        get
        {
            return textDirection;
        }
        set
        {
            textDirection = value;
            this.Invalidate();
        }
    }

    [Description("Display Text"),Category("Appearance")]
    public override string Text
    {
        get
        {
            return text;
        }
        set
        {
            text = value;
            this.Invalidate();
        }
    }

    #endregion

    #region Method

    protected override void OnPaint(PaintEventArgs e)
    {
        Graphics graphics = e.Graphics;

        StringFormat stringFormat = new StringFormat();
        stringFormat.Alignment = StringAlignment.Center;
        stringFormat.Trimming = StringTrimming.None;

        Brush textBrush = new SolidBrush(this.ForeColor);

        //Getting the width and height of the text, which we are going to write
        float width = graphics.MeasureString(text,this.Font).Width;
        float height = graphics.MeasureString(text,this.Font).Height;

        //The radius is set to 0.9 of the width or height, b'cos not to
        //hide and part of the text at any stage
        float radius = 0f;
        if (ClientRectangle.Width<ClientRectangle.Height)
        {
            radius = ClientRectangle.Width *0.9f/2;
        }
        else
        {
            radius = ClientRectangle.Height *0.9f/2;
        }

        //Setting the text according to the selection
        switch (textOrientation)
        {
            case Orientation.Arc:
            {
                //Arc angle must be get from the length of the text.
                float arcAngle = (2*width/radius)/text.Length;
                if(textDirection == Direction.Clockwise)
                {
                    for (int i=0; i<text.Length; i++)
                    {
                        graphics.TranslateTransform(
                            (float)(radius*(1 - Math.Cos(arcAngle*i + rotationAngle/180 * Math.PI))),
                            (float)(radius*(1 - Math.Sin(arcAngle*i + rotationAngle/180*Math.PI))));
                        graphics.RotateTransform((-90 + (float)rotationAngle + 180*arcAngle*i/(float)Math.PI));
                        graphics.DrawString(text[i].ToString(), this.Font, textBrush, 0, 0);
                        graphics.ResetTransform();
                    }
                }
                else
                {
                    for (int i=0; i<text.Length; i++)
                    {
                        graphics.TranslateTransform(
                            (float)(radius*(1 - Math.Cos(arcAngle*i + rotationAngle/180*Math.PI))),
                            (float)(radius*(1 + Math.Sin(arcAngle*i + rotationAngle/180*Math.PI))));
                        graphics.RotateTransform((-90 - (float)rotationAngle - 180*arcAngle*i/(float)Math.PI));
                        graphics.DrawString(text[i].ToString(), this.Font, textBrush, 0, 0);
                        graphics.ResetTransform();
                    }
                }
                break;
            }
            case Orientation.Circle:
            {
                if (textDirection == Direction.Clockwise)
                {
                    for(int i=0;i<text.Length;i++)
                    {
                        graphics.TranslateTransform(
                            (float)(radius*(1 - Math.Cos((2*Math.PI/text.Length)*i + rotationAngle/180*Math.PI))),
                            (float)(radius*(1 - Math.Sin((2*Math.PI/text.Length)*i + rotationAngle/180*Math.PI))));
                        graphics.RotateTransform(-90 + (float)rotationAngle + (360/text.Length)*i);
                        graphics.DrawString(text[i].ToString(), this.Font, textBrush, 0, 0);
                        graphics.ResetTransform();
                    }
                }
                else
                {
                    for(int i=0;i<text.Length;i++)
                    {
                        graphics.TranslateTransform(
                            (float)(radius*(1 - Math.Cos((2*Math.PI/text.Length)*i + rotationAngle/180*Math.PI))),
                            (float)(radius*(1 + Math.Sin((2*Math.PI/text.Length)*i + rotationAngle/180*Math.PI))));
                        graphics.RotateTransform(-90 - (float)rotationAngle - (360/text.Length)*i);
                        graphics.DrawString(text[i].ToString(), this.Font, textBrush, 0, 0);
                        graphics.ResetTransform();
                    }

                }
                break;
            }

            case Orientation.Rotate:
            {
                //For rotation, who about rotation?
                double angle = (rotationAngle/180)*Math.PI;
                graphics.TranslateTransform(
                    (ClientRectangle.Width+(float)(height*Math.Sin(angle))-(float)(width*Math.Cos(angle)))/2,
                    (ClientRectangle.Height-(float)(height*Math.Cos(angle))-(float)(width*Math.Sin(angle)))/2);
                graphics.RotateTransform((float)rotationAngle);
                graphics.DrawString(text,this.Font,textBrush,0,0);
                graphics.ResetTransform();

                break;
            }
        }
    }
    #endregion
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-07-06T20:04:56.253

您还可以查看 Windows ToolStrip 控件。它有一个 TextDirection 选项，可以设置为 Vertical90 或 Vertical270，这将在适当的方向上旋转标签文本。

*   概述：[ToolStrip 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstrip.aspx)(MSDN)

*   [设置属性](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.toolstrip.textdirection?view=netframework-4.8)(docs.microsoft.com)

*   [枚举值](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.toolstriptextdirection?view=netframework-4.8)(docs.microsoft.com)

# c++ - C++ ATL 成员变量访问帮助

> ID：416904
> 
> 赞同：1
> 
> 时间：2009-01-06T15:13:02.437
> 
> 标签：c++, activex, atl, shockwave

我对此不熟悉，可以使用kick start。

我正在使用 ATL（非托管 C++）用户控件并希望使用 ShockWave ActiveX 对象。我需要知道如何声明它，以便我可以设置属性或调用方法。

例如，如果我可以为其分配一个变量，那么我想调用'variable->LoadMovie()'

我知道这太荒谬了……几乎不好意思在这里问。;） （几乎）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T15:23:41.043

如果您#import dll（我建议在使用 COM 时这样做，因为它使您的生活变得如此轻松），您可以使用与对象的 CLSID 配对的智能指针。请记住，智能指针类在接口名称之后具有后缀“Ptr”。

例如：

```
ISomeInterfacePtr pSomeInterface( CLSID_SomeComponent );
HRESULT hr = pSomeInterface->SomeMethod(); 
```

希望有帮助。

**编辑：**如果要检查分配的 HRESULT，可以执行以下操作：

```
ISomeInterfacePtr pSomeInterface = 0;
HRESULT hr = pSomeInterface.CreateInstance( CLSID_SomeComponent ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T15:20:49.350

我多次剪切和粘贴必要的代码，我不记得确切的语法，但你必须：

获取正确接口的 CComPtr<>，CreateInstance 对象 QueryInterface 以获取您想要的接口（假设您没有使用 CComPtr）

然后调用它的方法。

或者，您可以#import dll，然后编译器将为您生成一个包含所有方法和属性的 c++ 类。

# infragistics - 如何访问 Infragistics Web Grid 行的子行？

> ID：416911
> 
> 赞同：2
> 
> 时间：2009-01-06T15:14:52.933
> 
> 标签：infragistics, ultrawebgrid

我需要在扩展分层 Infragistics Web 网格时修改其子行的内容。我可以在以下代码中从“e.Row”获取父行。但是如何让其子行进行编辑？

就此而言，我怎样才能从带 0 以外的任何带中获取行？

```
protected void CustomerActivitiesGrid_ExpandRow(object sender, RowEventArgs e)
{
   UltraGridRow expandedRow = e.Row;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T15:23:46.673

这很容易，只需访问行的行。

```
foreach(UltraGridRow childRow in e.Row.Rows)
{
    // your code
} 
```

随后，您可以以相同的方式访问这些行的子行

```
childRow.Rows 
```

您还可以使用其键访问特定行

```
UltraGridRow specificChildRow = e.Row.Rows.FromKey("ChildRowKey"); 
```

# php - 优化 PHP 字符串连接

> ID：416914
> 
> 赞同：-6
> 
> 时间：2009-01-06T15:16:05.800
> 
> 标签：php, optimization

这篇文章并不是一个真正的问题，但分享一些编码技巧可能会很有用。

这是我想与您分享的一个。我将展示 4 个做同样事情的例子。但只有最后一个是最好的。

```
$foo = 'John SMITH';

echo "Hello $foo, welcome on my website.";

echo "Hello " . $foo . " welcome on my website.";

echo 'Hello ' . $foo . ' welcome on my website.';

echo 'Hello ', $foo , ' welcome on my website.'; 
```

我相信你们都知道那是`echo '$foo'`行不通的，但是我很确定你们使用双引号来显示一个简单的信息。 **这很糟糕**。

好吧，让我们开始吧：第一个不好（以及第二个），因为使用双引号会强制 php 扫描字符串以查找要完成的替换（我的意思是变量）。

第二个稍微好一点，因为 php 没有替代品。

第三个更好，因为简单的引用，这样语言知道他可以直接发送文本而无需处理，但“坏”的事情是使用连接（点运算符，如第二个示例）。

最后一个使用简单的引号和逗号运算符。为什么这个解决方案更好？

那么，当使用第三种解决方案时会发生什么？

php 创建一个包含 的字符串，`"Hello "`然后将其放大，以放入 foo 变量（“John SMITH”）的内容，然后再次将其放大以放入`" Welcome on my website."`句子。然后，`echo`可以使用它来...回显它:)

而在第四个中，唯一要做的`echo`就是发送“Hello”，然后是 $foo 的内容，然后是“Welcome on my website”。到输出，仅此而已！因为 echo 只需要发送文本，而不需要创建一个必须放大以包含整个文本的字符串（这本来是凹的，必须增长（因为连接）然后显示。

我会尝试找回一些基准并将它们放在这里。

请随意发表评论或做出反应，请原谅我的英语，这不是我的母语。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-06T15:24:22.743

**哪种解决方案性能更好完全无关紧要。**计算机速度极快，CPU 周期也很便宜，因此毫秒级的优化毫无意义。唯一真正的优化是帮助**您**更快地阅读代码的优化，因此您可以节省宝贵的时间并专注于实际交付工作代码。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-06T15:26:14.610

创建一个小（但仍然很糟糕：）基准并运行它会产生以下结果：

```
0.0022029876709
0.00211095809937
0.00213599205017
0.00551700592041 
```

最后一种方法显然是最慢的。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-06T15:29:28.457

优化的三个规则是：

1.  暂时不要优化。
2.  暂时不要优化。
3.  暂时不要优化。

仅在了解减速的位置后，将其保存为您做的最后一件事。

否则，可以这么说，您将本末倒置。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-06T15:23:56.050

在实践中，这几乎总是不会成为您的主要瓶颈。

[http://www.procata.com/blog/archives/2005/03/08/microbenchmarks-of-single-and-double-qouting/](http://www.procata.com/blog/archives/2005/03/08/microbenchmarks-of-single-and-double-qouting/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-06T15:23:32.917

这不值得。即使您设法使字符串连接速度提高了 30%，您的整个应用程序也可能会体验到 0.1% 的加速（不要从字面上理解；加速可忽略不计）。大部分时间将花在数据库查询或更复杂的逻辑上。

# database - SQLite 3 C API 事务

> ID：416924
> 
> 赞同：16
> 
> 时间：2009-01-06T15:19:07.917
> 
> 标签：database, sqlite, transactions

我正在使用 SQLite3 进行 iPhone 开发，并且尝试将一些插入语句包装到事务中。目前我有下面的代码可以正常工作，但是在阅读了关于 SO 的另一个问题后，我意识到将这些放在一个事务中而不是每个事务中会更好。我找不到开始和提交事务的 C API 调用。一些代码在 Objective-C 中，但我认为这与问题无关。

```
- (void)saveAnimals {
    //Insert all the animals into the zoo database
    int i;

    const char *sql = "insert into Animal(Zoo_ID, Animal_Num, Animal_Text) Values(?, ?, ?)";
    for (i = 0; i < ([[self animalArray] count] - 1); i++) {

        if(addStmt == nil) {
            if(sqlite3_prepare_v2(database, sql, -1, &addStmt, NULL) != SQLITE_OK)
                NSAssert1(0, @"Error while creating add statement. '%s'", sqlite3_errmsg(database));
        }
        int animalNum = [[[self animalArray] objectAtIndex:i] animal_Number];
        NSString *animalText = [[NSString alloc] initWithString:[[[self animalArray] objectAtIndex:i] animal_Text]];
        sqlite3_bind_int(addStmt, 1, zoo_ID);   
        sqlite3_bind_int(addStmt, 2, animalNum);    
        sqlite3_bind_text(addStmt, 3, [animalText UTF8String], -1, SQLITE_TRANSIENT);
        [animalText release];
        if(SQLITE_DONE != sqlite3_step(addStmt)) {
            NSAssert1(0, @"Error while inserting data. '%s'", sqlite3_errmsg(database));
        }

        //Reset the add statement.
        sqlite3_reset(addStmt);     
    }
} 
```

我认为需要做的是将 sqlite3_prepare_v2 命令从 for 循环中取出，启动事务，通过 for 循环，提交事务。但是，我不确定“开始交易”和“提交交易”的要求是什么。我还会使用 sqlite3_step 吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-06T17:41:36.477

开始交易：`sqlite3_exec(db, "BEGIN", 0, 0, 0);`

提交交易：`sqlite3_exec(db, "COMMIT", 0, 0, 0);`

# algorithm - 最小化列表中特殊函数的总和

> ID：416926
> 
> 赞同：8
> 
> 时间：2009-01-06T15:19:50.893
> 
> 标签：algorithm, language-agnostic, optimization

假设我有一个列表，我希望对其进行排列，以便在其连续元素上运行的某个函数的总和最小。

例如，考虑整个列表中连续对的列表`{ 1, 2, 3, 4 }`和总和。IE。. 经检查，当列表排列为) 时达到最小总和。`a^b``(a,b)``1^2 + 2^3 + 3^4 = 90``{ 2, 3, 1, 4 } => (2^3 + 3^1 + 1^4 = 12`

请注意， sum 不是循环的（即我不考虑`last^first`），并且 order 很重要`(2^3 != 3^2)`，也`a^b`可以是对任意数量的连续元素进行操作的任何函数。

这种算法有名称吗？是否有既定的实现方法？

**编辑：**我已经改写了这个问题，因为我错误地将其标记为排序问题。正如所指出的，这更像是一个优化问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T16:09:04.743

“排序”通常使用二进制比较运算符（“小于或等于”）定义。您正在寻找的是列表的“最佳”排列，其中“最佳”被定义为在整个列表上定义的标准（而“某些函数”是在相邻元素上定义的，整个列表的总和使其成为全局属性）。

如果我理解正确，“旅行推销员”就是你的问题的一个例子，所以你的问题无论如何都是 NP-complete ;-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T15:45:45.960

由于对使用的功能没有限制

> a^b 也可以是对任意数量的连续元素进行操作的任何函数。

如果使用了一个常量函数（比如一个 alwasys 返回 1 的函数），那么所有排序的总和将是相同的，但在查看所有排序之前，您不一定知道这一点。

所以我看不到任何比评估所有排列上的函数和和更快的方法。

（您可以记住每个元组的结果以加快评估速度，但我认为您仍然需要全部查看）

编辑：另外，因为它可能是一个作用于所有元素的函数，所以你可以有一个函数为除一个之外的所有排列返回 0，它返回 1。

因此，对于一般情况，您肯定需要评估所有排列的函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T15:48:35.657

看起来这是一个[优化问题](http://en.wikipedia.org/wiki/Optimization_problem)，而不是排序问题。

我敢打赌，只要做一点（或者可能很多）工作，就可以证明这在功能上等同于著名的 NP 完全问题之一。但是，对于某些特定功能（例如您的示例中的 a^b ），问题可能会更容易。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T17:15:45.873

那是家庭作业吗？

如果不是，那就是动态规划问题。要查看它，您应该使用您的示例作为基础将您的问题转换为以下问题。你在开始。您可以选择 {1,2,3,4} 之一。从那里您可以选择前往 {1,2,3,4}。这样做 4 次，你就拥有了列表 {1,2,3,4} 长度为 4 的所有排列。

现在您需要一个成本函数，其定义为：

```
f(prev, next) = prev ^ next
              = 0 if the solution is not valid for your original problem 
              = 0 if prev is the start 
```

总成本表示为

```
cost(i|a|X) = min(i in {1,2,3,4}, f(i, a) + cost(X)) 
```

请注意，它`i|a|X`表示以元素 a 开始的列表，然后是 i，列表的其余部分是 X。

查看`cost`函数，您应该认识到动态规划。

从那里你可以推导出一个算法。查看 wikipedia 以[了解动态编程的介绍](http://en.wikipedia.org/wiki/Dynamic_programming)。

您可以使用 PLT Scheme 测试的我的 Scheme 实现是：

```
(define (cost lst f)
  (if (null? lst)
      0
      (let ((h (car lst))
            (t (cdr lst)))
        (if (null? t)
            0
            (+ (f h (car t))
               (cost t f))))))

(define (solve lst f)
  (let loop ((s '()))
    (if (= (length s) (length lst))
        s
        (loop
         (let choose ((candidate lst)
                      (optimal #f)
                      (optimal-cost #f))
           (if (null? candidate)
               optimal
               (let ((c (car candidate)))
                 (if (memq c s)
                     (choose (cdr candidate) optimal optimal-cost)
                     (if (not optimal) 
                         (choose (cdr candidate) (cons c s) (cost (cons c s) f))
                         (if (<= (cost (cons c s) f)
                                 (cost optimal f))
                             (choose (cdr candidate) (cons c s) (cost (cons c s) f))
                             (choose (cdr candidate) optimal optimal-cost))))))))))) 
```

然后调用`(solve '(1 2 3 4) expt)`产生另一个最小解决方案'（3 2 1 4）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-06T17:29:35.377

我只看到一个解决方案：

# 蛮力

```
 public static int Calculate(Func<int, int, int> f, IList<int> l)
    {
        int sum = 0;
        for (int i = 0; i < l.Count-1; i++)
        {
            sum += f(l[i], l[i + 1]);
        }
        return sum;
    }

    public static IEnumerable<IEnumerable<T>> Permute<T>(IEnumerable<T> list, int count)
    {
        if (count == 0)
        {
            yield return new T[0];
        }
        else
        {
            int startingElementIndex = 0;
            foreach (T startingElement in list)
            {
                IEnumerable<T> remainingItems = AllExcept(list, startingElementIndex);

                foreach (IEnumerable<T> permutationOfRemainder in Permute(remainingItems, count - 1))
                {
                    yield return Concat<T>(
                        new T[] { startingElement },
                        permutationOfRemainder);
                }
                startingElementIndex += 1;
            }
        }
    }

    // Enumerates over contents of both lists.
    public static IEnumerable<T> Concat<T>(IEnumerable<T> a, IEnumerable<T> b)
    {
        foreach (T item in a) { yield return item; }
        foreach (T item in b) { yield return item; }
    }

    // Enumerates over all items in the input, skipping over the item
    // with the specified offset.
    public static IEnumerable<T> AllExcept<T>(IEnumerable<T> input, int indexToSkip)
    {
        int index = 0;
        foreach (T item in input)
        {
            if (index != indexToSkip) yield return item;
            index += 1;
        }
    }

    public static void Main(string[] args)
    {
        List<int> result = null;
        int min = Int32.MaxValue;
        foreach (var p in Permute<int>(new List<int>() { 1, 2, 3, 4 }, 4))
        {
            int sum = Calculate((a, b) => (int)Math.Pow(a, b), new List<int>(p));
            if (sum < min)
            {
                min = sum;
                result = new List<int>(p);
            }
        }
        // print list
        foreach (var item in result)
        {
            Console.Write(item);
        }
    } 
```

[我从Ian Griffiths 的博客](http://www.interact-sw.co.uk/iangblog/2004/09/16/permuterate)中窃取了排列代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T15:41:14.067

这就是我到目前为止所拥有的。我创建了一个 Calc 类，我可以将每个组合传递到该类中，然后它计算总数并具有 ToString() 方法，因此您不必担心迭代输出总和字符串和值。您可以获取构造函数中传入的总数和列表。然后，您可以将每个组合集添加到您可以在*inst* .Total... 中按 LINQ 排序的列表中，正如我所展示的那样。仍在研究生成每种组合的方法...

```
class Calc
{
    private int[] items;
    private double total;
    public double Total 
    { 
        get
        { 
            return total; 
        } 
    }
    public int[] Items
    {
        get { return items;  }
        set { total = Calculate(value); }
    }
    public static double Calculate(int[] n)
    {
        double t = 0;
        for (int i = 0; i < n.Length - 1; i++)
        {
            int a = n[i]; int b = n[i + 1];
            t += a^b;
        }
        return t;
    }
    public Calc(int[] n)
    {
        this.items = n;
        this.total = Calculate(n);
    }
    public override string ToString()
    {
        var s = String.Empty;
        for (int i = 0; i < items.Length - 1; i++)
        {
            int a = items[i]; int b = items[i + 1];
            s += String.Format("{0}^{1}", a, b);
            s += i < items.Length - 2 ? "+" : "=";
        }
        s += total;
        return s;
    }
} 
```

然后我们在计算中使用该类，并很快按每个排列的总数排序：

```
class Program
{
    static void Main(string[] args)
    {
        var Calculations = new List<Calc>();

        ////Add a new item to totals for every combination of...working on this
        Calculations.Add(new Calc(new int[] { 1, 2, 3, 4 }));
        //...

        //Grab the item with the lowest total... if we wanted the highest, we'd
        //just change .First() to .Last()
        var item = Calculations.OrderBy(i=>i.Total).First();
        Console.WriteLine(item);
        //Or if we wanted all of them:
        //Calculations.OrderBy(i=>i.Total).ForEach(Console.WriteLine);
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T15:55:14.270

这绝对不是一个排序列表。如果您有一个排序列表 [x~0~...x~n~]，则列表 [x~0~..x~i-1~, x~i+1~..x~n~] (即 x~i~ 删除）也将根据定义进行排序。在您的示例中，从子序列 100,0,100 中删除 0 很可能会取消对列表的排序。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-06T16:13:28.667

这是一个 NP 完全问题，因为算法是未知的（NB 对于给定的函数 a^b 它不是 NP 完全的，它可以在排序后通过单遍来完成，请参见下面的解决方案示例）

如果不计算列表的所有可能排列的给定函数的结果，则无法预先编写“排序算法”。

但是，一旦给定一个函数，您就可以（可能）为其设计一种排序方法，例如上面的 a^b，从而对列表进行排序（不将该函数应用于任何项目）“Max, min, next max, next min 。. .”并颠倒该顺序。

根据给定功能的复杂性，提供优化的排序例程将越来越困难。

谢谢，

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-06T15:41:30.803

嗯，这是一个有趣的问题。使用现有的排序构造 (IComparable) 将无法正常工作，因为您需要的信息比 compareTo 方法可用的信息多。

对此的解决方案将在很大程度上取决于您要用于排序的方法是什么。但是，乍一看，您可能必须遍历所有可能的订单才能找到最小订单。如果当前总和大于先前的总和，您可能会将其短路。

我将不得不试一试，看看我能想出什么。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-06T15:56:33.333

未经测试和证明：

1.  对列表进行排序
2.  从排序列表创建对，获取第一个数字和最后一个数字，然后是第二个和第二个到最后一个等（即 1,2,3,4 变为 1,4 和 2,3）
3.  对于每一对，保存它的 a^b 值。反向排序此列表
4.  将新列表中的 a^b 值替换为 a & b 值

我猜它不可能那么简单......但它适用于你的例子，这不是真正重要的吗？

# visual-studio-2005 - 如何在 Visual Studio 2005 的外部引用中导航到方法的源？

> ID：416942
> 
> 赞同：0
> 
> 时间：2009-01-06T15:23:34.100
> 
> 标签：visual-studio-2005

我在 VS 2005 中有一个 C# 项目，其中引用了 Foo.dll，这是一个 C++ .NET 代码库，位于 c:\Foo\Foo.dll。它在对象浏览器中正确显示了引用，但是对于给定的对象 + 方法，我无法弄清楚如何在 Visual Studio 中导航到它的源。

我自己在本地计算机上从源代码构建了 Foo.dll，而 Foo.pdb 与 Foo.dll 位于同一位置，位于 c:\Foo\Foo.dll.pdb。我正在使用的解决方案中没有 Foo 的项目。

查看来自我的 C# 应用程序的堆栈跟踪，我可以看到它确切地知道源在我的系统上的位置 - 我看到一行如下所示：

**在 c:\src\foo\src\SomeClass.cc 中的 mycompany.Foo.SomeClass.SomeMethod()：第 123 行**

这是该源文件的正确位置，但我根本不知道如何轻松地让 VS 打开 SomeClass.cc。Visual Studio 是否需要将 Foo 设置为我的解决方案中的项目才能轻松导航到源代码？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T15:36:10.643

您可以将项目包含在解决方案中并通过“项目参考”构建吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T16:19:43.863

您的应用程序是否从补丁 c:\Foo\Foo.dll 加载 Foo.dll？我猜你实际上在你的应用程序的 bin 文件夹中有一个 dll 的副本。如果是这种情况，.pdb 文件将需要位于同一位置。完成此操作后，您应该能够单步执行代码 - Visual Studio 应提示输入代码位置。

另一种想法 - 在工具 > 选项下，查看调试部分。在“常规”子部分下，查看是否选中了“仅启用我的代码（仅限托管）”。如果是，请取消选中它，然后尝试调试。

# xslt - 日期和时间转换

> ID：416944
> 
> 赞同：2
> 
> 时间：2009-01-06T15:23:45.147
> 
> 标签：xslt, date

我的问题是我收到例如一个连接格式的日期：

```
Ex: 20050728 
```

我必须通过我的 xslt 以可读格式检索它。

```
Ex. 28 July 2005 
```

关于时间，我也有类似的问题。

```
Ex: 0004 
```

显示为`00:04`

这是怎么做到的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T17:45:51.380

**使用[XPath](http://www.w3.org/TR/xpath)** [`substring()`](http://www.w3.org/TR/xpath#function-substring)****功能如下面的解决方案所示**：**

 **```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>
 <!--                                           -->
 <xsl:variable name="vrMonths">
   <m>January</m>
   <m>February</m>
   <m>March</m>
   <m>April</m>
   <m>May</m>
   <m>June</m>
   <m>July</m>
   <m>August</m>
   <m>September</m>
   <m>October</m>
   <m>November</m>
   <m>December</m>
 </xsl:variable>
 <!--                                           -->
 <xsl:variable name="vMonths" select=
  "document('')/*/xsl:variable[@name='vrMonths']/*"/>
<!--                                           -->
    <xsl:template match="date">
      <xsl:value-of select=
       "concat(substring(.,7), ' ',
             $vMonths[number(substring(current(),5,2))], ' ',
             substring(.,1,4))"
       />
    </xsl:template>
 <!--                                           -->
    <xsl:template match="time">
     <xsl:value-of select=
     "concat(substring(.,1,2),':',substring(.,3))"/>
    </xsl:template>
</xsl:stylesheet> 
```

**在此 XML 文档上应用上述转换时**：

```
<t>
 <date>20050728</date>
 <time>0004</time>
</t> 
```

**产生了想要的结果**：

```
 28 July 2005
 00:04 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T15:27:06.450

如果您可以使用 XPath 2.0，请参阅此[函数参考](http://www.w3schools.com/Xpath/xpath_functions.asp#datetime)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T15:28:17.867

xslt 有一些可用的[格式化功能](http://www.w3schools.com/XSL/func_formatnumber.asp)

# java - Swing 组件是轻量级的吗？

> ID：416947
> 
> 赞同：5
> 
> 时间：2009-01-06T15:23:56.567
> 
> 标签：java, swing, awt

每当我读到 Swing 时，他们都会说它们是轻量级组件。所以我只是用谷歌搜索了 Swing，发现这意味着 Swing 不依赖于本地同行。这就是他们被称为**“轻量级”**的原因吗？我的意思是轻量级，我认为 Swing 组件占用的内存可能比 AWT 组件少。不是这样吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-06T15:42:19.087

[Swing](http://java.sun.com/docs/books/tutorial/uiswing/)被认为是轻量级的，因为它完全用 Java 实现，无需调用本机操作系统来绘制图形用户界面组件。

另一方面，[AWT](http://en.wikipedia.org/wiki/Abstract_Window_Toolkit)（Abstract Window Toolkit）是重量级的工具包，因为它只是调用操作系统来生成它的 GUI 组件。

[来自AWT 和 Swing 中的绘画](http://java.sun.com/products/jfc/tsc/articles/painting/)文章的 Swing 绘画系统的[演变](http://java.sun.com/products/jfc/tsc/articles/painting/#background)部分解释了轻量级和重量级之间的区别：

> 在为 JDK 1.0 开发原始 AWT API 时，只存在重量级组件（“重量级”意味着该组件具有它自己的不透明本机窗口）。这允许 AWT 严重依赖每个本机平台中的绘制子系统。
> 
> [...]
> 
> 随着 JDK 1.1 中轻量级组件的引入（“轻量级”组件是重用其最接近的重量级祖先的本机窗口的组件），AWT 需要在共享 Java 代码中实现轻量级组件的绘制处理。

由于 Swing 是用 Java 实现的，它确实有一些性能劣势，但是，我听说最近的 Java 版本中性能有所提高。

Swing 的优势在于它有更多可用的组件，例如[`JTable`](http://java.sun.com/javase/6/docs/api/javax/swing/JTable.html)，[`JList`](http://java.sun.com/javase/6/docs/api/javax/swing/JList.html)这些组件比 AWT 中提供的组件更具图形化和可扩展性，允许开发更多图形丰富的应用程序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-06T15:27:57.807

轻量级与重量级是如何实现 UI 组件的问题。重量级组件包装操作系统对象，轻量级组件没有。它们在 JDK 中严格实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-18T09:21:51.680

这只是一个附录，在另一个上下文中解决了重量级与轻量级：编程模型。

In this context Swing is definitely heavyweight and complicated. It is not considered suitable for thin client implementation, and given the fact that today there are so many different devices, Swing is, in effect, dead technology, even though Oracle has not retired it...yet (also see JavaFX as an alternative).

# haskell - 是否可以使用 WinHugs 打印 Haskell 中的所有缩减？

> ID：416956
> 
> 赞同：6
> 
> 时间：2009-01-06T15:26:37.823
> 
> 标签：haskell, evaluation, lazy-evaluation

我编写了以下函数..并使用 WinHugs 执行

```
teneven =  [x | x <- [1..10], even x] 
```

我的输出：

```
Main> teneven
[2,4,6,8,10] :: [Integer] 
(63 reductions, 102 cells) 
```

反正有没有打印所有的减少..所以我可以了解 WinHugs 内部发生的核心评估？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T20:03:26.840

一些想法：

1.  调试命令行选项（您可以`:set +d`在 Hugs 中设置）提供信息，但非常冗长，并且没有显示 Haskell 语法的简化。

2.  试试[Hat - Haskell Tracer](http://www.haskell.org/hat/)。我只是在一个简单的程序上尝试过它，它非常酷。不过，我不在 Windows 上，而且我不知道让它运行起来有多么困难。这可能相当困难，这是一种耻辱，因为它很酷并且基本上是你想要的。如果你让它运行起来，你可以从 Hat 那里得到类似这样的信息：

    ```
    main = {IO}
    teneven = [2,4,6,8,10]
    _foldr (\..) [1,2,3,4,5,6,7,8, ...] [] = [2,4,6,8,10]
    (\..) 1 [2,4,6,8,10] = [2,4,6,8,10]
    (\..) 2 [4,6,8,10] = [2,4,6,8,10]
    (\..) 3 [4,6,8,10] = [4,6,8,10]
    (\..) 4 [6,8,10] = [4,6,8,10]
    (\..) 5 [6,8,10] = [6,8,10]
    (\..) 6 [8,10] = [6,8,10]
    (\..) 7 [8,10] = [8,10]
    (\..) 8 [10] = [8,10]
    (\..) 9 [10] = [10]
    (\..) 10 [] = [10] 
    ```

    那里有 lambda `even`。此外，如果您愿意，Hat 可以跟踪调用 of`foldr`和其他内部调用；默认情况下，它不会那样做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-09T21:39:41.657

这里有几个使用 Debug.Trace 和 Hugs.Observe 的示例。

```
import Debug.Trace
fact :: Integer -> Integer
fact 0 = trace "fact 0 ->> 1" 1
fact n = trace ("fact " ++ show n) (n * fact (n-1))

import Hugs.Observe
fact :: Integer -> Integer
fact 0 = observe "fact 0" 1
fact n = observe "fact n" (n *  fact (n-1)) 
```

希望这可以帮助您弄清楚如何使用 WinHungs 打印所有减少。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T15:26:47.090

相信我，你不想走这条路。

在每种特定情况下使用的减少集合（和顺序）将取决于特定的语言实现（拥抱可以用一种方式，ghci - 以另一种方式，jhc - 以另一种方式，等等）。

最好阅读一些关于为功能语言实现编译器/解释器/虚拟机的一般方法 - 例如 SECD 机器等。

几个链接：

*   维基百科，[*SECD机器*](http://en.wikipedia.org/wiki/SECD_machine)
*   Lambda the Ultimate，[*实现快速解释器*](http://lambda-the-ultimate.org/node/2884)

# windows - 从命令提示符更改快捷方式的目标

> ID：416957
> 
> 赞同：16
> 
> 时间：2009-01-06T15:26:49.493
> 
> 标签：windows, batch-file, shortcut

我通常是一个 Linux 人，但我需要在 Windows 上编写一个批处理脚本来更改一些快捷方式的目标。有没有命令可以做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-06T15:46:36.613

我怀疑有没有办法用批处理脚本来做到这一点。不过，它在 VBScript 中是[可行的。](http://msdn.microsoft.com/en-us/library/xk6kst2k(VS.85).aspx)

```
Set sh = CreateObject("WScript.Shell")
Set shortcut = sh.CreateShortcut("C:\Wherever\Shortcut.lnk")
shortcut.TargetPath = "C:\Wherever\Whatever.txt"
shortcut.Save 
```

将脚本保存在以 vbs 结尾的文件中，并使用`cscript whatever.vbs`.

（不要被名称所迷惑——`CreateShortcut`它既用于创建快捷方式，也用于修改快捷方式。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-06T15:52:34.370

没有 Windows 附带的本机程序来实现这一点。不久前，我在互联网上搜索了相同的功能，偶然发现了免费软件[XXMKLINK](http://www.xxcopy.com/xxcopy38.htm)。

> 使用 XXMKLINK，您可以编写一个批处理文件，用于由专门的安装程序完成的软件安装。基本上，XXMKLINK 是从命令行收集信息并将其打包成快捷方式。
> 
> XXMKLINK的命令语法：
> 
> ```
> xxmklink spath opath [ arg [ wdir [ desc [ mode [ icon[:n] ]]]]]
> 
> where 
> 
>   spath     path of the shortcut (.lnk added as needed)
>   opath     path of the object represented by the shortcut
>   arg       argument string (use quotes with space, see below)
>   wdir      path of the working directory (for "Start in")
>   desc      description string (shown in Shosrtcut's Properties)
>   mode      display mode (1:Normal [default], 3:Maximized, 7:Minimized)
>   icon[:n]  icon file [with optional icon index value n]
> 
>   In addition to the above, the following switches are supported
>   which can be placed in any position in the command line.
> 
>   /p        prompts before action
>   /q        no output when successful (quiet)
>   /e        checks error condition strictly 
> ```

缺点是您需要使用批处理脚本将 xxmklink exe 复制到每台计算机上。

链接页面底部有一个下载链接。

# iphone - 将 NSdata 从设备发送到桌面（邮件）？

> ID：416967
> 
> 赞同：0
> 
> 时间：2009-01-06T15:30:21.013
> 
> 标签：iphone, cocoa-touch

我有一个应用程序，其中包含一个名为 SwimmingPool 的类的实例数组。

目前，我的应用程序持久性是通过将所有内容编码到 NSData 并将其保存到 iPhone 来处理的。然后在每次应用程序启动时重新加载。

我有几个朋友用 SwimmingPool 实例填充他们的个人应用程序。我希望他们向我发送他们的申请信息。然后我会将它全部导入我的“主”应用程序，汇集每个人的 SwimmingPool 实例，最后我会将应用程序提交到 appStore。

我的问题是，我接收他们数据的最佳方式是什么？我的应用程序是否可以编码为 NSData 实例，然后将其导出到 iphone/ipod touch 上的邮件？（他们可以通过电子邮件发送给我）

然后，我将创建一个导入方法来将各个游泳池解析到我的主 NSData 中。

这可能吗？/最好的解决方案？

非常感谢所有回答我之前问题的人。我希望尽我所能为这个社区做出贡献。（不仅仅是问题！）

担

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T15:34:48.557

我会让应用程序通过 HTTP 将数据发布到服务器。

它是滑板爱好者定位空游泳池的应用程序吗？很棒的应用创意！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T21:22:53.940

您应该看一下`NSURLConnection`该类，它允许您将数据发布到 HTTP 服务器，或从中检索数据。

如果你不需要花哨的异步下载 HTTP 请求结果，你也可以看看 `[NSData +dataWithContentsOfURL:]`同步获取结果。

# c# - 获取xml中除了属性值之外的属性名称

> ID：416968
> 
> 赞同：6
> 
> 时间：2009-01-06T15:30:31.873
> 
> 标签：c#, xml

我正在接收动态 xml，我不知道属性名称，如果您查看 xml 和代码...我尝试做一个简单的示例，我可以获得属性值，即“myName”、“myNextAttribute” , 和“blah”，但我无法获得属性名称，即“name”、“nextAttribute”和“etc1”。任何想法，我认为它必须是我想念的简单的东西......但我肯定会想念它。

```
 static void Main(string[] args)
    {
        string xml = "<test name=\"myName\" nextAttribute=\"myNextAttribute\" etc1=\"blah\"/>";

        TextReader sr = new StringReader(xml);

        using (XmlReader xr = XmlReader.Create(sr))
        {
            while (xr.Read())
            {
                switch (xr.NodeType)
                {
                    case XmlNodeType.Element:
                        if (xr.HasAttributes)
                        {
                            for (int i = 0; i < xr.AttributeCount; i++)
                            {
                                System.Windows.Forms.MessageBox.Show(xr.GetAttribute(i));
                            }
                        }
                        break;
                    default:
                        break;
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-06T15:44:04.293

你可以在[MSDN](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.movetonextattribute(VS.80).aspx)中看到：

```
if (reader.HasAttributes) {
  Console.WriteLine("Attributes of <" + reader.Name + ">");
  while (reader.MoveToNextAttribute()) {
    Console.WriteLine(" {0}={1}", reader.Name, reader.Value);
  }
  // Move the reader back to the element node.
  reader.MoveToElement();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T15:50:44.530

您的开关是不必要的，因为您只有一个案例，请尝试将其滚动到您的 if 语句中。

```
if (xr.NodeType && xr.HasAttributes)
{
    ...
} 
```

请注意，&& 运算符按顺序计算，因此如果 xr.NoteType 为 false，则忽略其余参数并跳过 if 块。

# java - Hibernate 可以返回结果对象的集合而不是列表吗？

> ID：416970
> 
> 赞同：3
> 
> 时间：2009-01-06T15:30:49.343
> 
> 标签：java, hibernate

Hibernate API 是否支持 List 以外的集合形式的对象结果集？

例如，我有一个运行数十万次迭代的流程，以便为客户创建一些数据。此过程使用值表（例如）中的记录，以便为每次迭代创建此输出。

使用列表，我必须遍历整个列表才能找到某个值，这很昂贵。我希望能够返回一个 TreeMap 并以编程方式指定一个键，这样我就可以在集合中搜索我需要的特定值。Hibernate 可以为我做这件事吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T15:45:31.187

如果我理解正确，您将一堆数据从数据库加载到内存，然后通过在该列表中查找某些对象在本地使用它们。

如果是这种情况，我会看到 2 个选项。

1.  不要加载所有数据，但对于每次迭代，使用仅返回您需要的特定记录的查询访问数据库。这将进行更多的数据库查询，因此它可能会更慢，但内存消耗要少得多。通过添加缓存可以轻松改进此解决方案，以便快速获取大多数使用的值。它当然需要一些性能测量，但我通常更喜欢具有良好缓存的简单解决方案，因为缓存可以实现为交叉关注点并且对程序员非常透明。
2.  如果您真的想将所有数据加载到内存中（这实际上是一种缓存形式），那么与完整处理相比，将数据从列表转换为 TreeMap（或任何其他有效结构）的时间可能会很短。所以你可以自己做数据转换。

正如我所说，在一般情况下，我倾向于使用缓存的解决方案......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T15:45:43.340

我假设您指的是该[`Query.list()`](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/Query.html#list())方法。如果是这样：不，除了 a 之外，没有其他方法可以返回顶级结果`List`。如果您收到太多结果，为什么不对数据库发出更受约束的查询呢？如果查询难以约束，您可以`Map`使用 Hibernate 的内容填充您自己的内容，`List`然后丢弃该列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T15:36:20.643

来自[Java Persistence with Hibernate](http://www.amazon.ca/Java-Persistence-Hibernate-Christian-Bauer/dp/1932394885/ref=pd_bbs_sr_1?ie=UTF8&s=books&qid=1231256183&sr=8-1)：

*   java.util.Map 可以映射 `<map>`，保留键和值对。使用 a`java.util.HashMap`来初始化属性。
*   A`java.util.SortedMap`可以与`<map>`元素进行映射，并且 sort 属性可以设置为比较器或自然排序以进行内存排序。`java.util.TreeMap` 使用实例初始化集合。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T15:40:23.850

是的，这是可以做到的。

但是，您可能必须让您的域类实现`Comparable`；我不认为你可以使用比较器来做到这一点。

**编辑：** 好像我误解了这个问题。如果您正在谈论临时查询的结果，那么上述内容对您没有帮助。如果查询已修复，则可以通过将具有 TreeMap 属性的对象绑定到数据库视图来使其工作。

当然，您始终可以自己构建地图，只需很少的工作和处理开销。

# c++ - C 和 C++ 编程语言的最终链接是什么？

> ID：416974
> 
> 赞同：3
> 
> 时间：2009-01-06T15:33:23.427
> 
> 标签：c++, c

最近，所有现代编程语言都有一个权威的网站来支持、分发、学习编程语言，以及社区论坛、电子邮件列表等。Java 有 java.sun.com，python 有 python.org 等。

但是 C/C++ 似乎没有这样的站点。您使用哪个站点（例如在文档中）链接 C 或 C++ 编程语言？维基百科条目不算在内，尽管它们可能非常合适。

创始人的网站？还是有其他想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-06T15:35:51.800

[C 编程语言](http://cm.bell-labs.com/cm/cs/cbook/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T15:41:38.153

[Bjarne Stroustrup 在他的主页](http://www.research.att.com/~bs/)上保留了很多有趣的链接。[FAQ](http://www.research.att.com/~bs/bs_faq.html)和[C++ 词汇表](http://www.research.att.com/~bs/glossary.html)是很好的参考资料，但请确保您还检查了[您真的这么说吗？](http://www.research.att.com/~bs/bs_faq.html#really-say-that)有趣的阅​​读。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-06T16:29:26.933

C++ 的权威参考是[ISO/IEC 14882:2011](http://www.iso.org/iso/iso_catalogue/catalogue_ics/catalogue_detail_ics.htm?csnumber=50372)。这是定义语言、库及其语义的国际标准。它也可能远远超出你的需要，它的价格为 330 美元。[您可以在委员会网站](http://www.open-std.org/JTC1/SC22/WG21/)（和[其他地方](https://github.com/cplusplus/draft)）获得免费的标准[草案](http://www.dkuug.dk/jtc1/sc22/open/n3242/n3242.pdf)版本。

C 同样由国际标准[ISO/IEC 9899:2011](http://www.iso.org/iso/iso_catalogue/catalogue_ics/catalogue_detail_ics.htm?csnumber=57853)定义。与 C++ 一样， 可从[委员会网站获得](http://www.open-std.org/JTC1/SC22/WG14/)[草稿](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1494.pdf)版本。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-06T15:38:59.903

这些语言的存在时间比我们所知道的互联网要长。很多介绍性文本都是死树格式。大多数在线资料都是参考资料，但也有新闻组之类的（我不关注其中的任何一个）。

[*C 编程语言*](https://rads.stackoverflow.com/amzn/click/com/0131103628)

C 或 C++ 标准库的任何参考。

**C++ 特定：**

[C++ 常见问题解答精简版](http://www.parashift.com/c++-faq-lite/)

[促进](http://www.boost.org/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-06T15:49:42.677

对于 C++，有[cplusplus.com](http://www.cplusplus.com/reference/)和[SGI 的 STL 页面](http://www.sgi.com/tech/stl/)是很好的参考。但它们对学习语言本身并没有多大帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-06T16:52:41.707

*Usenet*怎么样：

*   `comp.lang.c++.moderated`（关于 C++ 编程的讨论，主持）
*   `comp.lang.c++`（关于 C++ 编程的讨论）

    [以上两个网址](http://groups.google.com/groups/dir?sel=gtype%3D0%2Cusenet%3Dcomp.lang.c%2B%2B%2C&hl=en&)

*   `comp.std.c++`（关于标准的讨论）

    [以上网址](http://groups.google.com/group/comp.std.c++/topics?hl=en&lnk)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-06T15:36:40.267

我想如果人们有圣经的话，他们可能不需要一个权威的网站:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T17:15:53.267

一些C资源：

*   C99 规范 TC3 ( [pdf](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf) )
*   comp.lang.c（[谷歌组](http://groups.google.com/group/comp.lang.c/topics)）
*   comp.lang.c.moderated（[谷歌组](http://groups.google.com/group/comp.lang.c.moderated/topics)）
*   [GNU libc 手册](http://www.gnu.org/software/libc/manual/)
*   [GNU libc 邮件列表](http://www.gnu.org/software/libc/resources.html#projectweb)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-06T18:33:06.573

很多关于 C 和 C++ 的好链接，涵盖网站和书籍，但一个被忽视的是我最喜欢的 C：

[哈比森和斯蒂尔](https://rads.stackoverflow.com/amzn/click/com/013089592X)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-06T19:15:36.940

总是有[Boost](http://boost.org)。

> Boost 提供免费的经过同行评审的可移植 C++ 源库。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-31T11:02:27.707

Zed the Sharkjumper 的教科书：[http ://c.learncodethehardway.org/](http://c.learncodethehardway.org/)

# subsonic - 自动更新 SubSonic 中的 AdditionalBy 和 EditedBy 字段

> ID：416976
> 
> 赞同：0
> 
> 时间：2009-01-06T15:34:24.827
> 
> 标签：subsonic

我有一个数据模型，其中包括常见的列，如 addedBy、editby（用户）、addDate、editedDate。

是否有我可以在 SubSonic 2.1 中使用的设置来适当地自动更新这些字段，而不必在每次更新中明确指定？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T19:56:10.430

查看[http://subsonicproject.com/setup/subsonic-conventions/](http://subsonicproject.com/setup/subsonic-conventions/)。SubSonic 在审核列时使用基于约定的方法。如果您可以将列名分别更改为 CreatedBy、ModifiedBy、CreatedOn 和 ModifiedOn，那么它们将自动更新。我认为没有办法在不更改 SubSonic 源代码的情况下更改这些名称。

# mysql - 存储只能知道年份的日期

> ID：416978
> 
> 赞同：1
> 
> 时间：2009-01-06T15:34:52.423
> 
> 标签：mysql, schema

存储在许多情况下可能只知道年份的日期值的最佳方法是什么？

MySQL 允许在日期部分中使用零，除非启用 NO_ZEROES_IN_DATE sql 模式，默认情况下不启用。是否有任何理由不使用日期字段，如果月份和日期可能为零，或者将其拆分为年、月和日的 3 个不同字段（年（4）、tinyint、tinyint）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T16:08:47.987

更好的方法是将日期拆分为 3 个字段。年月日。这为您提供了存储、排序和搜索的完全灵活性。

此外，在必要时将这些字段重新组合成一个真实的日期字段非常简单。

最后，它可以跨 DBMS 移植。我认为没有其他人支持将 0 作为日期值的有效部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T19:45:06.303

除非跨 DBMS 的可移植性很重要，否则我肯定会倾向于使用单个日期字段。如果您甚至需要中等复杂的与日期相关的查询，将日、月和年的值放在不同的字段中将成为一件苦差事。

MySQL 有丰富的日期相关函数 - **[http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)**。如果您只想返回年份值，请使用 YEAR(yourdatefield)，如果您想将其包含在查询的 WHERE 子句中，请使用相同的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T15:50:50.567

您可以在 Mysql 中使用单个日期字段来执行此操作。在下面的示例中，字段具有日期数据类型。

```
mysql> select * from test;
+------------+------+
| field      | id   |
+------------+------+
| 2007-00-00 |    1 | 
+------------+------+
1 row in set (0.00 sec)

mysql> select * from test where YEAR(field) = 2007;
+------------+------+
| field      | id   |
+------------+------+
| 2007-00-00 |    1 | 
+------------+------+ 
```

我会使用一个字段，它会使查询更容易。

是的，使用[日期和时间功能](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)会更好。谢谢布林[J](https://stackoverflow.com/users/29538/brynj)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T23:43:12.080

你可以试试 LIKE 操作员。如：SELECT * FROM table WHERE date_feield LIKE 2009；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T00:06:16.887

这取决于您如何使用结果数据。一个简单的答案是简单地存储那些只有年份被称为 1 月 1 日的日期。这种方法非常简单，允许您使用所有标准的内置日期函数按年份聚合。

如果月份或日期很重要，就会出现问题。例如，如果您尝试以天、周、月为单位确定记录的年龄，或者如果您想显示这个较小粒度级别的分布。但是，这个问题无论如何都存在。如果您有一些完整的日期和一些只有一年的日期，那么在这种情况下您希望如何表示它们。

# c# - XmlSerializer、sgen.exe 和泛型

> ID：416980
> 
> 赞同：1
> 
> 时间：2009-01-06T15:35:07.073
> 
> 标签：c#, .net, xml-serialization, sgen

我有一个通用类型：

```
public class Packet<T> where T : IContent
{
    private int id;
    public int Id { get { return this.id; } }

    private T content;
    public T Content { get { return this.content; } }
} 
```

我想从/到 XML 反序列化/序列化这种类型的实例。`IContent`是这样定义的：

```
public interface IContent
{
    XmlSerializer Serializer{get;}
} 
```

基本上，我希望`Packet`使用其内容提供的序列化程序来序列化和反序列化其内容成员。这个序列化器实际上是一个由 sgen.exe 生成的预编译 xml 序列化器的实例。

是否有可能不`Packet<T>`实施`IXmlSerializable`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T10:56:27.697

是的，您可以使用 IXmlSerializable 直接实现自定义类。
有关详细信息，请参阅[本文](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-25T10:21:07.357

如果您使用的是通用类型，则它无法生成预先完成的 XmlSerializer。

# tcl - 为什么从 tcl 调用 rpmbuild 时将 topdir 设置为默认值？

> ID：416983
> 
> 赞同：28
> 
> 时间：2009-01-06T15:35:53.890
> 
> 标签：tcl, rpm

我有一个 'exec' rpmbuild 的 tcl 脚本。这样做时，rpmbuild 使用的“topdir”是错误的。我的主目录中有一个 .rpmmacros 文件，如果我手动调用 rpmbuild，它可以正常工作，即。“topdir”不是默认的。

我在 tcl 脚本中添加了一个*[exec rpmbuild "--showrc" ]*来检查*topdir*的值，它显示 '-14: _topdir %{_usrsrc}/redhat' 这是默认值。

有人可以解释一下为什么会出现这种情况以及如何解决吗？

我宁愿不必用 --define 指定它，因为它实际上是在 makefile 中完成的，我不想碰它（如果没有其他选择，我会这样做）。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2010-06-21T00:34:53.573

有两种方法可以更改默认的 rpmbuild topdir：

1.  每个用户：通过在 $HOME/.rpmmacros 中配置 RPM topdir

    ```
    %_topdir    %{getenv:HOME}/rpmbuild 
    ```

2.  每个项目：通过在 Makefile 或命令行中配置 RPM topdir

    ```
    rpmbuild --define '_topdir build' -ba package.spec 
    ```

注意：在这两种情况下，您都需要确保您的 topdir 目录具有适当的目录（BUILD、SRPM、RPM、SPECS 和 SOURCES）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-12-29T17:00:18.010

在**RHEL6**中：

```
 rpm --showrc|grep topdir
  rpm --showrc|grep srcrpmdir 
```

看看正在使用的路径是什么！

进行此更改（我的 topdir 未设置为`/usr/src/`）：

```
vi  /usr/lib/rpm/macros
#       Path to top of build area.
#%_topdir               %{getenv:HOME}/rpmbuild
%_topdir                %{_usrsrc}/redhat

rpm --showrc|grep topdir    now shows   /usr/src/redhat/ as its BUILD dir 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T18:09:44.610

TCL 默认会在当前目录执行。您可以使用 TCL 命令[http://www.tcl.tk/man/tcl8.4/TclCmd/cd.htm](http://www.tcl.tk/man/tcl8.4/TclCmd/cd.htm) cd 更改当前目录，例如：

```
cd ~username 
```

如果 topdir 是环境变量，您可以像这样设置它[http://www.tcl.tk/man/tcl8.4/TclCmd/tclvars.htm#M4](http://www.tcl.tk/man/tcl8.4/TclCmd/tclvars.htm#M4)：

```
set env(topdir) whatever/you/want 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T07:36:08.870

我的第一个检查是确保您执行相同的操作。在命令行上执行这两个操作以确保别名或路径不会干扰任何内容。

```
which rpmbuild

echo 'puts [auto_execok rpmbuild]' | tclsh 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-12T21:49:14.797

就我而言，这是由于调用 rpmbuild 时未设置变量 $HOME 所致。
该变量用于搜索“/rpmmacros”文件。我建议使用命令'printenv'来验证。

# html - 无法在客户端机器上显示图像

> ID：416985
> 
> 赞同：0
> 
> 时间：2009-01-06T15:36:06.027
> 
> 标签：html

我有一个网络应用程序。我已经使用 html 标签将图像插入到我的 Web 应用程序主页中。它在服务器机器上运行良好。但是，当任何客户端访问我的网页时，Web 应用程序主页中的所有内容都会显示，但图像除外。而不是图像交叉标记显示在客户端机器上。

任何人都可以帮助我如何在客户端机器上显示图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T15:39:13.367

检查 img 标签中 src 属性中的路径。确保它是相对路径，而不是硬编码到硬盘驱动器上的路径。

# html - 无法在客户端机器上显示图像

> ID：416995
> 
> 赞同：-1
> 
> 时间：2009-01-06T15:38:21.670
> 
> 标签：html

[这是同一个人无法在客户端机器上显示图像](https://stackoverflow.com/questions/416985/unable-to-display-image-in-client-machine)的副本。

我有一个网络应用程序。我已使用 html 标签将图像插入到我的 Web 应用程序主页中。它在服务器机器上运行良好。但是，当任何客户端访问我的网页时，Web 应用程序主页中的所有内容都会显示，但图像除外。而不是图像交叉标记显示在客户端机器上。

任何人都可以帮助我如何在客户端机器上显示图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T15:41:45.373

我应该想象你没有指向服务器上图像的正确位置。例如，图像被硬编码为指向 localhost。也许还要检查 IIS 中的映射。如果您可以提供您正在使用的来源，那可能会有所帮助。

# java - Google Web Toolkit 对开发复杂的 JavaScript 有用吗？

> ID：416998
> 
> 赞同：6
> 
> 时间：2009-01-06T15:39:06.737
> 
> 标签：java, javascript, gwt

我是 javascript 框架的忠实粉丝，尤其是 jQuery。我一直想设计像“plurk.com”这样的网站，但我知道它需要非常大的 javascript 行。所以这让我很失望。但自从我开始了解 GWT，我真的很想测试一下，想问你开发复杂的东西是否比使用 javascript 或它的框架更容易。你更喜欢哪一个？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-06T22:01:12.690

我认为这个问题的一些答案是非常不知情的，我怀疑回答他们的人从未在大型项目中使用过 GWT。是的，GWT 是处理大型 AJAX 网站的好方法，对于涉及后端的大型复杂网站，它可以让 JQuery 之类的东西在公园里上下颠簸。我一直认为 javascript 本身非常适合做小型客户端的事情。当你需要做一些更复杂的事情（比如动态字段、弹出窗口、动画）时，你可以引入 JQuery 或 Prototype 之类的东西。当您想更进一步时，您可以选择 GWT。

人们认为因为你是用 Java 编写的，所以它是为后端开发人员设计的，用于进行前端开发。它不是。Java 只是他们选择的语言，主要是因为它被广泛使用，静态类型，并且有很多优秀的编辑器可以使用它。

我也不赞成泄漏抽象理论，它不会尝试完全抽象出 HTML 元素，因为如果您选择使用它们，它可以让您直接访问原生 javascript 和 DOM。

简而言之，我们已经在 GWT 中构建了非常复杂的站点（其中一个在 GWT 博客中有特色），并且还使用了 JQuery 等其他库。我可以 100% 自信地告诉你，一旦你开始了解 GWT，它就会杀死那些为复杂任务而死的其他框架。它还有一些很棒的内置功能，可以帮助让事情变得更好，甚至可以做一些其他框架不支持的事情（比如它可以用图像做的魔法）。有关更多详细信息，请参阅此博客文章：

[http://googlewebtoolkit.blogspot.com/2007/10/epo-builder-built-with-gwt.html](http://googlewebtoolkit.blogspot.com/2007/10/epo-builder-built-with-gwt.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-06T16:04:43.877

很少有事情像“生成的 Javascript”那样让我害怕。 [在这些情况下，泄漏抽象定律](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)必须是双重正确的。

编写有效的跨浏览器 javascript 是一个不断完善的棘手过程。试图破译一些生成的、模糊的 Javascript 出错的地方是一个令人头疼的问题。修复纯 JS 库中的错误已经够糟糕的了。

对我来说，GWT 是一个旨在让后端开发人员编写前端、浏览器内代码的技巧。不幸的是，现代 Web 应用程序的现实意味着您只需要了解 Javascript 和 DOM。有些东西会坏掉，你需要知道为什么。

我认为你最好选择一个好的 javascript 库，比如 jquery 或原型，然后好好学习。这些库抽象掉了应该被抽象掉并且不太可能在边缘情况下中断的东西，比如数组操作和 AJAX 请求。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-06T16:02:28.330

是的，确实如此，因为您将使用 Java 而不是 Javascript。

精湛的 IDE、静态代码分析、搜索和重构——所有这些都将使您在大型项目上的生活更加轻松。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T15:59:44.793

不，它没有。

它并没有消除复杂性，它只是让您可以从 Java 角度处理它。因为这为您提供了 Java 中可用的所有工具……仅此一项就值得。

不过，JavaScript IDE 越来越好，通常如果您使用 jQuery 或 Prototype 之类的框架，那么您可能会发现它比处理像 GWT 之类的重量级抽象层更容易。

我个人的偏好是采用纯 JavaScript 方法，但那是因为我喜欢能够更贴近金属地工作，而且我有足够的纪律来驯服我的 JavaScript 猫。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-06T15:43:13.500

使用 GWT，您实际上并不是在编写 JavaScript。它的整个价值主张是您可以编写 Java，它会为您编译成 JavaScript。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-06T17:32:00.567

我正在做一个使用 GWT 效果很好的项目。这对我们来说是一个不错的选择，因为我们都是主要从事内部工具的 Java 开发人员。我无法说它对大型最终用户网站有多大用处。

我特别欣赏的一个优点是无缝的对象序列化和反序列化。不仅 XML-RPC 的细节被抽象掉了，而且由于相同的 Java 代码被编译为服务器端的字节码和浏览器的 javascript，您几乎可以像服务器和客户端在不同的类加载器中运行一样编写代码。相同的JVM。例如，您可以在服务器上构造一个 Java 对象，将其作为 RPC 服务调用的返回值发送到浏览器，然后浏览器代码可以使用相同的 Java 类来操作您刚刚返回的对象。同样，RPC 调用的参数可以构造为 Java 对象，服务器在另一端接收相同的 Java 对象。所有这一切都没有涉及（反）序列化的细节。***************