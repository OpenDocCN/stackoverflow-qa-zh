# StackOverflow 问答 10645000-10645999

# php - 使用 CodeIgniter 登录用户

> ID：10645002
> 
> 赞同：0
> 
> 时间：2012-05-17T23:51:44.893
> 
> 标签：php, codeigniter, login

我已经在我的 CodeIgniter 应用程序中编写了注册页面。一切正常，它使用 PHPass 库进行密码散列。

现在，我想编写系统的登录部分，并且想知道我将如何使用 CodeIgniter 来执行此操作。我对正确（和最佳实践）的做法感到困惑。我是否只接受用户登录凭据，确定它们是否正确，如果正确，为该用户设置会话？他们需要饼干吗？该cookie是否需要加密？我是否需要在我的数据库中跟踪用户（CodeIgniter 可以为我执行此操作）并注意 IP 地址更改或主机名更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:35:52.957

有许多 auth 库，但由于您是初学者，我坚信最好自己制作一些东西（除非您的时间框架非常严格）。因为，正如我的同事曾经告诉我的那样，如果不犯错误，您将无法理解为什么更好的解决方案实际上更好。

回到你的实际问题。

> 我是否只接受用户登录凭据，确定它们是否正确，如果正确，为该用户设置会话？

嗯，是。没有其他合理的方法可以做到这一点，是吗？:)

> 他们需要饼干吗？

会话 ID 自动存储在 cookie 中。您可以将其他选项存储在 cookie 中，但请记住 cookie 可能会被盗（因此保存用户名/cookie 不是一个好主意）。此外，人们越来越多地使用不止一种设备（例如平板电脑和台式机），因此对使用 cookie 更加明智。

> 该cookie是否需要加密？

我相信我已经回答了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T00:15:33.767

您可能应该从这里开始：[http](http://codeigniter.com/wiki/Category:Libraries::Authentication) ://codeigniter.com/wiki/Category:Libraries::Authentication和[http://codeigniter.com/wiki/Category:Libraries::Authorization](http://codeigniter.com/wiki/Category:Libraries::Authorization)

> 来自 CI Wiki：身份验证与授权不同。身份验证回答了“这个用户是他们声称的那个用户吗？”这个问题。授权回答了“给定此用户，他们是否有权执行此操作？”的问题</p>

为什么不使用众多 CI 身份验证库之一？ [我应该如何为 CodeIgniter 选择认证库？](https://stackoverflow.com/questions/346980/what-codeigniter-authentication-library-is-best)

您可以查看 CI wiki 了解您所追求的所有特定细节：http: [//codeigniter.com/wiki/auth](http://codeigniter.com/wiki/auth)

# ruby - 如何确定方法选项的范围？

> ID：10645006
> 
> 赞同：3
> 
> 时间：2012-05-17T23:52:08.360
> 
> 标签：ruby

我有一个选项解析 gem，它提供了用于创建命令的 DSL。在实践中，它通常最终看起来像这样：

```
option :ints,    Integer, arity: [1, -1], on_multiple: :append
option :floats,  Float,   arity: [1, -1], on_multiple: :append
option :complex, Complex, arity: [1, -1], on_multiple: :append 
```

这些是类方法。如您所见，不是很干燥。写这样的东西会更好：

```
scope arity: [1, -1], on_multiple: :append do
  option :ints,    Integer
  option :floats,  Float
  option :complex, Complex
end 
```

将给定的选项散列`scope`与给定的散列透明地合并到`option`. 这就是我卡住的地方。我不确定在哪里存储常用选项，以便以后合并它们。

有任何想法吗？

* * *

`option`将所有内容转发到`Option#new`：

```
def option(*args, &block)
  # self is a class that represents a command
  self.options << Option.new(*args, &block)
end 
```

根据要求，这是代码，删除了支持宝石的使用：

```
def initialize(key, *args, &block)
  # Retrieve the options hash from the argument array.
  options = args.last.is_a?(Hash) ? args.pop : {}

  # The rest of the implementation...
  type = args.find { |arg| arg.is_a? Module }

  strings = args.flatten.select do |arg|
    arg.is_a? String
  end.group_by do |arg|
    arg =~ Parser::Regexp::SWITCH ? :switches : :description
  end

  self.key = key
  self.names = strings.fetch(:switches) { [ Option.name_from(key) ] }
  self.description = options.fetch :description, strings.fetch(:description, []).first
  self.on_multiple = options.fetch :on_multiple, :replace
  self.arity = options.fetch :arity, nil
  self.default = options.fetch :default, nil
  self.required = options.fetch :required, false
  self.type = type || String
  self.handler = block
end 
```

[GitHub 上的原创](https://github.com/matheusmoreira/acclaim/blob/master/lib/acclaim/option.rb#L72)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:01:44.623

查看 Rails 中的[Object#with_options](http://apidock.com/rails/Object/with_options)，然后将其滑动以供您自己使用。

# java - 读取标签之间的 XML 数据

> ID：10645010
> 
> 赞同：0
> 
> 时间：2012-05-17T23:52:26.347
> 
> 标签：java, xml, servlets, jdom

我有一个 XML，我正在为此编写一个 servlet 来从 XML 中获取内容。一个这样的标签是`<itunes:author>Jonathan Kendrick</itunes:author>`
我需要为此获得作者价值。因为**：**

我尝试使用命名空间并为**:**使用转义序列，但它对我不起作用。

对于其他 XML 元素，我只是在使用

```
String link=node.getChildText("link").toString(); 
```

我正在使用 Jdom 解析器

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T00:13:13.503

在您的 XML 中，序列 'itunes:author' 代表所谓的 Q-Namem 和“合格名称”。在 XML 中，它由一个“命名空间前缀”和一个“本地名称”组成。在您的示例中，命名空间前缀是“itunes”，“本地名称”是“作者”。

您想要的是名称空间中链接到前缀“itunes”的“作者”元素。实际的命名空间通常是一个完整的 URL。我相信您示例的完整 URL 可能是 xmlns:itunes="http://www.itunes.com/dtds/podcast-1.0.dtd"，但您应该检查一下。

所以，命名空间是“http://www.itunes.com/dtds/podcast-1.0.dtd”，它的前缀被声明为“itunes”（但它可能是别的东西——实际的前缀名称在技术上并不重要...)

您想在“http://www.itunes.com/dtds/podcast-1.0.dtd”命名空间中获取“作者”，因此您需要：

```
String author = node.getChildText("author", Namespace.getNamespace("http://www.itunes.com/dtds/podcast-1.0.dtd")); 
```

有关命名空间的更多信息，请查看：[http ://www.w3schools.com/xml/xml_namespaces.asp](http://www.w3schools.com/xml/xml_namespaces.asp)

# jquery - jquery最近的li不起作用

> ID：10645012
> 
> 赞同：0
> 
> 时间：2012-05-17T23:52:29.763
> 
> 标签：jquery

我有一个带有链接的 html 页面

当用户单击该链接时，应出现一个新的选择标签

# html代码

```
<div class="container" id="addCell">
    <ul class="containerUL">
        <li class="containerLI">
            <p>
                <label>Name</label>
                <input type="text" class="longInput1"/>
            <p>
            <p>
                <label>City</label>
                <select id="countrySelector">
                </select>
            </p>
        </li>
        <li class="containerLI">
            <p>
                <label>Inserted cells</label>
                <a href="#" class="smallLink" id="acaclink">new</a>
            </p>
        </li>
        <li class="containerLI">
            <input type="submit" class="button1" value="save"/>
        </li>
    </ul>
</div> 
```

# jQuery代码

```
$("#addCell").ready(function(){
    $("#addCell").on('click',"#acaclink",function(){
        $.getJSON("http://localhost/Mar7ba/Cell/getAllCells/TRUE",function(data){
            var options = '';
            options+="<option>select cell</option>";
            for(var i=0;i<data.length;i++){
                options += "<option>"+data[i]+"</option>";
            }
            $(this).closest('li').append('<p>\n\
            <label>Select Cell</label>\n\
            <select name="acSelect[]">\n\
             '+options+'\n\
</select>\n\
            </p>');
        });
    });
}); 
```

1-我正在检查 JSON 调用，没有错误 2-我是警报选项，它可以按我的意愿工作

我的问题是：当我用它替换`$(this).closes('li')`时，`$('ul').append` 它可以工作，但是当我放最接近的 li 时，它就不行了。请问错在哪里

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T23:54:31.937

那是因为`$(this)`内部匿名函数有另一个作用域并引用另一个对象

```
$("#addCell").ready(function(){
    $("#addCell").on('click',"#acaclink",function(){
        var me = this; // we use "me" as a closure to the object we clicked at

        $.getJSON("http://localhost/Mar7ba/Cell/getAllCells/TRUE",function(data){
            var options = '';
            options+="<option>select cell</option>";
            for(var i=0;i<data.length;i++){
                options += "<option>"+data[i]+"</option>";
            }
            $(me).closest('li').append('<p>\n\   // <---- here we use "me"
            <label>Select Cell</label>\n\
            <select name="acSelect[]">\n\
             '+options+'\n\
</select>\n\
            </p>');
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T23:54:54.390

`this``getJSON`在回调中具有不同的含义。

您可以在 外部保留引用`getJSON`，然后在内部使用它。

```
$("#addCell").ready(function(){
    $("#addCell").on('click',"#acaclink",function(){

        var that = this; // reference this

        $.getJSON("http://localhost/Mar7ba/Cell/getAllCells/TRUE",function(data){
            var options = '';
            options+="<option>select cell</option>";
            for(var i=0;i<data.length;i++){
                options += "<option>"+data[i]+"</option>";
            }

              // use it here
            $(that).closest('li').append('<p>\n\
            <label>Select Cell</label>\n\
            <select name="acSelect[]">\n\
             '+options+'\n\
</select>\n\
            </p>');
        });
    });
}); 
```

或使用`$.ajax`及其`context`属性。

```
 $.ajax({
        url:"http://localhost/Mar7ba/Cell/getAllCells/TRUE",
        context:this,
        dataType:'json',
        success: function(data){

          // your code
            $(this).closest('li').append('<p>\n\...'

        }
    }); 
```

这等效于您的代码，因为`getJSON`它只是对此的包装，但是您可以获得所有可用的选项，例如`context:`.

# facebook - 在行动中标记人

> ID：10645019
> 
> 赞同：0
> 
> 时间：2012-05-17T23:53:29.487
> 
> 标签：facebook, post, facebook-opengraph

[可以在打开的图形操作中标记人员。](https://developers.facebook.com/docs/opengraph/actions/#taggingpeople)

现在我的问题：

例如，我有“看电影”这个动作。当我在这个动作中标记朋友时，这是否意味着他/她也看过这部电影？

让我的朋友在他/她的时间线中也获得同一部电影的聚合“我看过的电影”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:26:28.927

当您在操作实例中标记用户时（通过发布 'tags=UID1,UID2' 等 - 就像您说他们和您一起执行了该操作。这意味着它像他们那样出现在他们的时间轴上。想象一下在签到时标记朋友。

如果用户确实也对您执行了操作，则您只能在操作中标记用户。该频道受到严密监控以防止滥用。如果您标记用户并且他们拒绝该标记，您的应用将受到处罚。

# php - 'relationship_status' 始终为空（未设置）

> ID：10645022
> 
> 赞同：1
> 
> 时间：2012-05-17T23:53:41.927
> 
> 标签：php, facebook

我已经要求这样的权限：

```
$config = array(
'facebook' => array(
    'appId' => 'xxxxxxx',
    'secret' => 'xxxx'
),
'fb_perms' => array('read_friendlists', 'friends_relationships', 'friends_photos'),
'picsize' => 'large', // avaiable options: small, normal, large, square

 ); 
```

但在这儿

```
do
{$f1_id = $friends['data'][rand(0, NUM_FRIENDS)];
$f1_api = $facebook->api("/{$f1_id['id']}");} 
while

    ( (!isset($f1_api['relationship_status']))||(
    ( isset($f1_api['relationship_status'])&&
(
($f1_api['relationship_status']== "Married")||
($f1_api['relationship_status']== "Engaged")||
($f1_api['relationship_status']== "In a relationship")
)   )
    )); 
```

做一个无限循环，因为 $f1_api['relationship_status'] 从未设置。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:10:11.800

```
'fb_perms' => array('read_friendlists', 'friends_relationship_details', 'friends_relationships', 'friends_photos') 
```

# module - 将 EasyGui 与 Cx_Freeze 一起使用

> ID：10645026
> 
> 赞同：0
> 
> 时间：2012-05-17T23:54:16.727
> 
> 标签：module, python-3.x, cx-freeze, easygui

我已经相对于我的另一个问题创建了这个问题 - 如何在 Cx_freeze 中包含模块，但我认为这对我当前的问题并不真实。

当我冻结使用easygui的程序时，我收到一大堆关于缺少模块的错误，是的-easygui安装了Python32，是的-Easygui在站点-包中，

任何帮助将不胜感激，仅供参考，我正在使用基本的 setup.py ;)

```
from cx_Freeze import setup, Executable

setup(
        name = "GUIproject",
        version = "0.1",
        description = "Sample Test easygui",
        executables = [Executable("GUIproject.py")]) 
```

它报告的模块缺失包括 PIL、S​​tringIO、Tkinter 和 tkFileDialog。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:08:14.707

可能没问题 - 请参阅[此答案](https://stackoverflow.com/a/10207432/434217)，了解为什么缺少模块不是问题。

在这种情况下，PIL 对于 Easygui 是可选的，另外 3 个是 Python 2 名称。Easygui 将改为导入 Python 3 名称（您正在运行 Python 3.2） - 如下所示：

```
try:
    import tkinter  # Python 3
except ImportError:
    import Tkinter as tkinter  # Python 2 
```

所以无论如何你都应该得到一个输出的 exe 文件——试着运行它，看看它是否有效。

# java - 游戏对象旋转制作椭圆形而不是圆形

> ID：10645032
> 
> 赞同：1
> 
> 时间：2012-05-17T23:55:05.587
> 
> 标签：java, animation, rotation, trigonometry

我有一个用java制作的简单游戏动画。它由三个围绕轴旋转的行星组成。每个行星都是该类的一个实例，`Planet`它们有一个更新方法，每次运行时，轨道的旋转角度都会增加，并且位置会根据角度和一些预定变量（例如与“太阳”的距离）进行更新。从这里，您可以用简单的三角法确定行星的位置。在这种情况下：

```
Sin(angle) = op/hyp = y/distance
therefore
Sin(angle)*hyp = op

Cos(angle) = ady/hyp = x/distance
therefore
Cos(angle)*hyp = ady 
```

其中，斜边是到太阳的距离，邻边和对边分别是 x 和 y 值。我认为这会起作用，直到我尝试过。它给了我一个椭圆的旋转。这是更新行星自转的代码（轨道中心是太阳的中心位置）：

```
position.x = ((Math.cos(orbitAngle) * orbitDistance) + orbitCenter.x);
position.y = ((Math.sin(orbitAngle) * orbitDistance) + orbitCenter.y); 
```

有什么问题？

**编辑：**

我通过将一个物体的中心放置在轨道中心指定的位置来实现这个问题

这是行星类的完整代码：

```
public class Planet
{
    protected Image image;

    protected Vector2 position;
    protected final Vector2 orbitCenter;
    protected float rotation;
    protected Vector2 imageSize;

    protected final float rotationSpeed;
    protected final float orbitDistance;

    protected float orbitAngle;
    protected final float orbitAngleSpeed;

    public Planet(Image image, float orbitDistance, float rotationSpeed, Vector2 orbitCenter, float orbitAngleSpeed)
    {
        this.image = image;
        this.position = new Vector2(orbitCenter.x, orbitCenter.y - orbitDistance);
        this.orbitCenter = orbitCenter;
        this.rotation = 0;
        this.imageSize = new Vector2(image.getWidth(null), image.getHeight(null));
        this.rotationSpeed = rotationSpeed;
        this.orbitDistance = orbitDistance;
        this.isMouseOver = false;
        this.isPressed = false;
        this.orbitAngle = 0;
        this.orbitAngleSpeed = orbitAngleSpeed;
    }

    public void Update()
    {
        orbitAngle += orbitAngleSpeed;
        if(orbitAngle > Math.PI * 2)
            orbitAngle %= Math.PI * 2;

        position.x = ((Math.cos(orbitAngle) * orbitDistance) + orbitCenter.x);
        position.y = ((Math.sin(orbitAngle) * orbitDistance) + orbitCenter.y);
    }

    public void Draw(Graphics2D g)
    {
        g.rotate(rotation, position.x + imageSize.x / 2, position.y + imageSize.y / 2);
        g.drawImage(image, (int)position.x, (int)position.y, null);
        g.rotate(-rotation, position.x + imageSize.x / 2, position.y + imageSize.y / 2);
    }
} 
```

这是测试行星类的类。你可以从这里下载它需要工作的 jar：foxtailgames.net/AppletSource.jar。这是测试器类（您可能必须导入一些东西，但如果您在 eclipse 或 netbeans 中执行它，它会给您导入）：

```
public class PlanetTest extends AppletCore
{
    public void resizeScreen() {resize(800, 800);}

    Image center;
    Planet p;

    public void LoadContent()
    {
        p = new Planet(loadImage("images/GameMenuCircles/Planet1.png"), 100f, 0.02f, new Vector2(400, 400), 0.005f);
        center = loadImage("images/GameMenuCircles/Center.png");
    }

    public void Update(GameTime gameTime)
    {
        p.Update();
    }

    public void Draw(Graphics2D g, GameTime gameTime)
    {
        g.drawImage(center, 400 - center.getWidth(null)/2, 400 - center.getWidth(null)/2, null);
        p.Draw(g);
        g.setColor(Color.green);
        g.drawLine(400, 400, 500, 400);
        g.drawLine(400, 400, 400, 500);
        g.drawLine(400, 400, 300, 400);
        g.drawLine(400, 400, 400, 300);
        g.setColor(Color.white);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T03:35:37.453

您的旋转在上面设置为 0，所以我假设您目前没有旋转图片。我认为正在发生的是您正在制作的轨道圈很好，但是您绘制行星的位置已经关闭。

下面是 Swing 如何绘制圆的图像，因此您遇到的重叠就是因为这个。

您需要将绘制圆的位置调整为宽度的一半，使其位于轨道中心。

![Swing 如何绘制的图像。](../Images/dada3ed51ce2bd9fcd7b3f927fc37ab7.png)

编辑：您已经更改了一些代码，但您需要更改的是他星球的绘制方法：

```
public void Draw(Graphics2D g) {
        g.rotate(rotation, position.x + imageSize.x / 2, position.y + imageSize.y / 2);
        g.drawImage(image, (int)position.x, (int)position.y, null); //here
        g.rotate(-rotation, position.x + imageSize.x / 2, position.y + imageSize.y / 2);
    } 
```

这条线需要：

```
g.drawImage(image, (int)position.x - imageSize.width, (int)position.y - imageSizee.height, null); //here 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T01:45:32.467

您可以将您的结果与[`AnimationTest`](https://stackoverflow.com/a/3256941/230513)使用相同[*的圆参数方程的*](http://en.wikipedia.org/wiki/Parametric_equation#Circle)结果进行比较。因为轨道半径是封闭面板尺寸的函数，所以轨道只有在`w`等于时才是圆形的`h`。调整框架大小或设置`HIGH = WIDE`以查看效果。

![动画测试](../Images/c53ac4793132208685bb16df8dec26e0.png)

# delphi - Richedit 样式格式会自行更改

> ID：10645033
> 
> 赞同：2
> 
> 时间：2012-05-17T23:55:12.750
> 
> 标签：delphi, styles, richedit

（如果您能更好地理解和定义我的问题，请编辑标题。）

我遇到的问题是 RichEdit 的样式格式“恢复”为默认的“无”，也就是`[]`我设置的任何内容，例如粗体或斜体。

有问题的东西 - 我假设，因为我不知道它是如何破坏的 - 是一个过程（REMainLinesCheck），它检查 RichEdit 中的行数并删除第一个直到达到某个点（显示一次最多 14 行），如下所示：

```
while REMain.Lines.Count > 14 do
  REMain.Lines.Delete(0); 
```

我在向 RichEdit 添加行的其他过程中出现了 6 次上述过程，但它们都没有改变`RichEdit.SelAttributes.Style`，只有一个，它只添加了一个粗体行，如下所示：

```
REMain.SelAttributes.Style := [fsBold];
REMain.Lines.Add('something');
REMainLinesCheck; 
```

所以我已经删除了除了那个之外的所有事件并开始四处寻找，没过多久就看到它实际上工作正常，正常添加的常规和粗体行以及被删除的多余行 - 没问题。但是，一旦我将 REMainLinesCheck 过程重新引入另一个过程（为了清楚起见，我们将其称为 Proc3Lines，因为它就是这样做的：添加 3 行，然后调用检查多余的行），此 Proc3Lines 后面的每一行都应该是粗体不是......从我在这里的经历看来，REMainLinesCheck 在 Proc3Lines 中做了一些事情，因为没有它一切都很好。

明明不是一圈程序互相调用，但是代码的其他部分和这个RichEdit没有任何关系，更何况我没有`RichEdit.SelAttributes.Style`为REMain改变任何地方，除了我展示的一个地方，有同一个单元中的另一个 RichEdit，我确实改变了它的线条样式，但这不可能以任何方式相关......可以吗？（不，它没有，我刚刚检查过。）

基本上：德尔福到底是什么？没有比这更简单的了，我仍然失败了，有人可以解释和/或解决这个问题吗？问问题，如果有不清楚的地方，我会尽可能详细地说明。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T00:43:07.777

要将格式应用于新添加的行，请使用以下命令：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  LineIndex: Integer;
begin
  LineIndex := RichEdit1.Lines.Add('Something');
  RichEdit1.SelStart := RichEdit1.Perform(EM_LINEINDEX, LineIndex, 0);
  RichEdit1.SelLength := RichEdit1.Perform(EM_LINELENGTH, RichEdit1.SelStart, 0);
  RichEdit1.SelAttributes.Style := [fsBold];
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T08:34:03.993

这对我有用：

```
procedure TformStart.Proc;
var
endtxtpos: integer;
begin
  endtxtpos := Length(REMain.Text);
  REMain.Lines.Add('something');
  REMain.SelStart := endtxtpos-(REMain.Lines.Count-1);
  REMain.SelLength := Length('something');
  REMain.SelAttributes.Style := [fsBold];
end; 
```

但是由于我不知道更好，请批评并建议我如何做得更好。

# c++ - 如何在 C++ 中更改拉丁 UTF-8 字符串的大小写？

> ID：10645040
> 
> 赞同：12
> 
> 时间：2012-05-17T23:56:28.580
> 
> 标签：c++, stl, utf-8

在 Objective-C 中，它非常简单：

```
NSLog(@"%@", [@"BAÑO" lowercaseString]);  // Outputs "baño". 
```

**在 C++ 中，等价物是什么？**任何人都可以为此提供产生相同输出的有效代码吗？有没有一种很好的 STL 方法可以在不依赖 ICU、Boost 或任何其他 3rd 方库的情况下做到这一点？

我目前的非解决方案是：

```
using namespace std;
string s = "BAÑO";
wstring w(s.begin(), s.end());
transform(w.begin(), w.end(), w.begin(), towlower);
// w contains "baÑo" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T00:38:16.940

这个问题在 C++ 中变得异常复杂。考虑到 unicode 规范化和其他 non-lower-128-ASCII 字符点问题，我知道只有一个库绝对正确。

[IBM的重症监护室](http://www-01.ibm.com/software/globalization/icu/)

它很大，但它做的一切都是正确的。不幸的是，toupper 和 tolower 在这个问题上达不到要求，并且没有其他可用的 C++ 构造。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T00:04:41.020

有[tolower](http://www.cplusplus.com/reference/std/locale/tolower/)，这是特定于语言环境的，但我认为它不适用于 UTF-8 字符串。

正确的解决方案总是特定于语言环境，因为大小写规则取决于语言。例如，“I”的小写版本并不总是“i”。

# java - 使用 XMLParser 将节点插入 GWT 客户端中的现有 XML 文档

> ID：10645045
> 
> 赞同：1
> 
> 时间：2012-05-17T23:57:42.170
> 
> 标签：java, xml, gwt

我有一个 xml 文档（使用 GWT 客户端的 XMLParser 库中的 Document 类），格式如下：

```
<document><node id="0">content</node><node id="1">more content</node></document> 
```

给定一个 ID，我需要在具有该 ID 的节点之后立即插入一个新节点。

到目前为止，我已经尝试使用[insertBefore](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/dom/client/Node.html#insertBefore%28com.google.gwt.dom.client.Node,%20com.google.gwt.dom.client.Node%29)（因为没有 insertAfter），但我必须错误地使用它，因为没有任何反应（除了 js 控制台中的 UmbrellaException）。我无法通过搜索引擎找到任何示例用法。

我的尝试如下（其中 n 是我要插入的节点）：

```
Node nNext = n.getNextSibling(); //To get the next sibling to use it with insertBefore
Element newNode = doc.createElement("node");
newNode.appendChild(doc.createTextNode("new content")); //seems to work up until here
n.insertBefore(newNode, nNext); //so this line could be the problem? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T01:30:04.690

`insertBefore`必须在父节点上调用，所以：

```
n.getParentNode().insertBefore(newNode, n.getNextSibling()); 
```

# tcl - 如何从 info globals 命令输出所有变量的值列表？

> ID：10645047
> 
> 赞同：4
> 
> 时间：2012-05-17T23:58:29.817
> 
> 标签：tcl

我正在尝试编写一小段代码来列出 info globals 命令中包含的所有变量及其值。我尝试了几次替换迭代，但无法让 Tcl 将变量名视为变量，并返回其值。下面是我开始的：

```
set fileid [open "c:/tcl variables.txt" w+]
foreach {x}  [lsort [info globals]]  {
    set y $x
    puts $fileid "$x  $y   "
} 
```

我可以得到

```
DEG2RAD DEG2RAD   
皮皮   
RAD2DEG RAD2DEG   
......

```

或者

```
DEG2RAD $DEG2RAD   
圆周率$圆周率   
RAD2DEG $RAD2DEG   
......

```

但我需要的是

```
DEG2RAD 0.017453292519943295   
PI 3.1415926535897931   
RAD2DEG 57.295779513082323   
……   

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T01:28:06.997

我认为您正在寻找 subst 命令：

```
set fileid [open "c:/tcl variables.txt" w+] 
foreach {x} [lsort [info globals]] {
  puts $fileid "$x [subst $$x] " 
} 
```

或者，您可以利用 set 返回正在设置的值的事实：

```
set fileid [open "c:/tcl variables.txt" w+] 
foreach {x} [lsort [info globals]] {
  puts $fileid "$x [set $x] " 
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T18:19:33.870

执行此操作的最简单方法（因为它避免使用临时变量乱扔输出）是使用帮助程序和[`upvar`](http://www.tcl.tk/man/tcl8.5/TclCmd/upvar.htm)命令：

```
proc listAllGlobals {filename} {
    set fileid [open $filename w+]
    foreach varname [lsort [info globals]] {
        upvar "#0" $varname var
        if {[array exists var]} continue;    # Skip global arrays...
        puts $fileid "$varname $var "
    }
    close $fileid
}
listAllGlobals "C:/tcl variables.txt" 
```

如果你有 Tcl 8.5，你可以在不创建过程的情况下做到这一点：

```
apply {{} {
    set fileid [open "C:/tcl variables.txt" w+]
    foreach varname [lsort [info globals]] {
        upvar "#0" $varname var
        if {[array exists var]} continue;    # Skip global arrays...
        puts $fileid "$varname $var "
    }
    close $fileid
}} 
```

这一切都有效，因为`upvar`所做的是将局部变量链接到另一个堆栈帧中的变量；`#0`是全局堆栈帧`$varname`的名称，是该上下文中变量的名称，并且`var`是要绑定到的局部变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-24T10:14:36.580

数组也是变量，仅供参考，这会输出所有变量（包括数组）：

```
proc ListAllGlobals {{?pattern? *}} {
    foreach {name} [lsort [info globals ${?pattern?}]] {
        upvar {#0} $name var
        if {[array exists var]} {
            foreach {key val} [array get var] {
                puts "${name}($key) [list $val]"
            }
        } else {
            puts "$name [list $var]"
        }
    }
}
ListAllGlobals
ListAllGlobals tcl_platform 
```

1.  我`list`用来增强值的可读性。
2.  可以为变量子集指定模式。它不适用于数组元素名称。
3.  与前面的示例保持一致，可以将输出写入打开的文件：`puts $fileid [ListAllGlobals]`

# c# - 有没有办法从 DVI 端口获取原始数据？

> ID：10645055
> 
> 赞同：1
> 
> 时间：2012-05-17T23:59:33.483
> 
> 标签：c#, .net, screen-scraping, hardware-interface, dvi

我没有看到其他人试图这样做。我完全有可能以错误的方式接近这个。基本上，我有一台带 DVI 输入的电脑。如果没有任何东西连接到 DVI 输入，则计算机上的程序会在屏幕上加载一些图像。如果输出源连接到 DVI 端口，那么我的程序应该停止写入图像并改用 DVI 视频馈送。

存在哪些机制来确定是否存在 DVI 输入，以及当前是否存在有效的视频信号？如何阅读视频流？

还是我以完全错误的方式解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T04:39:27.293

在硬件级别上，大多数模拟或数字视频输入子系统都能够检测输入信号的存在，或者至少能够检测具有许多特征的输入信号的存在。

对于数字标准，您可以在自己的线路上拥有实际的时钟数据，或者在串行数据流中进行编码。如果似乎有一个时钟，并且它的频率是否规律且合理，将是第一个测试（尽管对于某些标准，合理可以涵盖很大的频率范围）。

其次，视频（不仅是数字的，甚至是模拟的）具有行和场的重复结构，因此像素时钟应该有两个可识别的因数，一个对应于每行的开始或结束，另一个对应于开始或每个字段（屏幕）的结尾。同样，这些可能有自己的线路，可能有独特的编码方式（模拟情况下的特殊电压），或者可能代表像素数据中的时间间隙。即使没有同步和回溯时间，像素数据的统计分析也可能会提供 X 和 Y 维度的线索，因为图片中的许多特征会重复。

实际的视频输入子系统（想想平板显示器）可能有更复杂的检测和自适应电路 - 例如，它们可能会及时重新采样输入以改变每行点的分辨率，或者它们甚至可能将其放入帧缓冲区并在 X 和 Y 上缩放它。

视频捕获电路内部工作的哪些细节会暴露给消费者，甚至驱动级软件将在很大程度上取决于所使用的芯片组的细节——希望有数据表可用。尽管很可能某处有一个可读的寄存器位，该位指示输入是否正在捕获电路“认为”是视频信号的东西。您甚至可以读出 X 和 Y 分辨率以及扫描速率或像素时钟速率等参数。

类似地，从端口获取数据的能力将取决于芯片组，但如果端口对任何事情有用，那么大概有一个操作系统驱动程序为它提供某种有用的 API 到视频消费应用程序。

# java - 码头服务器挂起

> ID：10645058
> 
> 赞同：0
> 
> 时间：2012-05-17T23:59:49.670
> 
> 标签：java, jetty, threadpool

我的 Jetty 应用程序服务器有问题。从昨天开始，我们有一个大问题。有时，Jetty 似乎只是挂起并且不想进行任何 RPC 调用。如果我重新启动它，它会恢复到正常状态，但问题会在几个小时后再次出现。

我注意到当我们遇到问题时，Nginx 的日志会提示这个错误：

```
2012/05/17 17:00:47 [error] 14728#0: *506735 upstream timed out (110: Connection timed out) while reading response header from upstream, client: xx.xxx.xxx.xx, server: www.MY-SERVER.com, request: "POST /com.xxxx.xxxx.XXXX/Service HTTP/1.1", upstream: "http://127.0.0.1:8080/com.xxxx.xxxx.XXXX/Service", host: "www.MY-SERVER.com", referrer: "https://www.MY-SERVER.com/" 
```

即使运行良好，Nginx 也会提示此警告：

```
2012/05/17 17:04:44 [warn] 14728#0: *506906 a client request body is buffered to a temporary file /var/cache/nginx/client_temp/0000088415, 
```

客户端：xx.xxx.xxx.xx，服务器：www.MY-SERVER.com，请求：“POST /report HTTP/1.1”，主机：“www.MY-SERVER.com” 是不是很吓人？

我听说当 Jetty 像这样挂起时，可能是因为线程问题。我该如何验证呢？这是我的服务器线程池配置，可能有助于诊断问题。

```
<!-- =========================================================== -->
    <!-- Server Thread Pool                                          -->
    <!-- =========================================================== -->
    <Set name="ThreadPool">
      <!-- Default queued blocking threadpool -->
      <New class="org.eclipse.jetty.util.thread.QueuedThreadPool">
        <Set name="minThreads">10</Set>
        <Set name="maxThreads">200</Set>
        <Set name="detailedDump">false</Set>
      </New>
    </Set>

    <!-- =========================================================== -->
    <!-- Set connectors                                              -->
    <!-- =========================================================== -->

    <Call name="addConnector">
      <Arg>
          <New class="org.eclipse.jetty.server.nio.SelectChannelConnector">
            <Set name="host"><Property name="jetty.host" /></Set>
            <Set name="port"><Property name="jetty.port" default="8080"/></Set>
            <Set name="maxIdleTime">300000</Set>
            <Set name="Acceptors">2</Set>
            <Set name="statsOn">false</Set>
            <Set name="confidentialPort">8443</Set>
            <Set name="lowResourcesConnections">20000</Set>
            <Set name="lowResourcesMaxIdleTime">5000</Set>
          </New>
      </Arg>
    </Call> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:57:02.547

首先，您需要提及您正在处理的码头版本，这对于将情况与一些已知问题进行比较非常重要。

一般来说，我只能建议您更新到最新的 jetty 版本，7.6.3.v20120416 或 8.1.3.v20120416。

好吧，您需要进行线程转储以查看卡住的位置。虽然我们尝试修复 jvm 中的 nio 错误导致了一些问题，并且一些与半关闭相关的 ssl 问题在较新的浏览器中比以前更频繁地使用......服务器挂起的大多数问题是来自部署在码头本身的应用程序。因此，进行线程转储，或者理想情况下连续几个将有助于隔离您遇到问题的地方。

要检查的另一件事是您使用的 java 版本，java 6 补丁级别 2x 几乎都以某种方式使用 nio 和 ssl 都不好，只有最新的 3x 恢复了一些正常的外观。

因此，首先您确实需要进行一些线程转储以了解服务器中发生的情况，然后再查看它是否是特定于码头的问题。如果您可以发布一些显示明显码头问题的堆栈跟踪信息，那么您将到达某个地方。我数不清有多少次我看到这种情况只是为了进行线程转储并查看其数据库争用或类似情况。

# actionscript - 函数参数列表中的 Emacs ActionScript 缩进

> ID：10645061
> 
> 赞同：1
> 
> 时间：2012-05-18T00:00:23.063
> 
> 标签：actionscript, emacs

我正在使用 Austin Haas 的动作脚本模式和 Emacs 23.3.1。当我在 ActionScript 中编写一个带有很多参数的函数时，我喜欢将它分成几行。我希望它看起来像

```
public function foo(bar:Bar,
                    baz:Baz,
                    qux:Qux):void {...} 
```

但是随着动作脚本模式的缩进，它看起来像

```
public function foo(bar:Bar,
    baz:Baz,
    qux:Qux):void {...} 
```

这让我很恼火。有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T10:48:31.247

一个简短的回答是：我看不出有什么好方法可以做到这一点。今天缩进仅基于上一行，如果使用 E4X，或者嵌套对象字面量或数组字面量等，它就完全被打破了:(

但是，如果您不介意将一些手工应用于要修改的每个此类实例，则以下内容可能会对您有所帮助：

```
(defun as3-align-regex ()
  (interactive)
  (let ((align-to-tab-stop nil))
    (align-regexp (region-beginning) (region-end)
          "\\(\\s(\\|\\s-\\)\\(\\sw+\\)" 1 1 nil))) 
```

请注意，您需要以从第一个括号、括号或空格开始直到要对齐的最后一个术语的方式选择区域。这有点难看，但一个好的解决方案需要太多的努力。

# iphone - iphone 在 MapView 中检测选定的 MKPinAnnotation

> ID：10645062
> 
> 赞同：0
> 
> 时间：2012-05-18T00:00:35.287
> 
> 标签：iphone, ios4, mkmapview, mkannotation, mkannotationview

我有一个自定义的 MKPinAnnotation，我在其中添加了几个 peroperties，比如对象的 Id 和类型。我想要的是当有人在 MapView 中选择一个引脚来检测选择了哪个引脚并获取该数据时。

并在其视图上显示一个按钮以在按钮的操作中使用该数据。

有人能帮忙吗？我找不到如何检测是否（以及哪个）注释被选中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T00:10:30.697

已经有一种内置方法可以为您处理这种情况。您需要使用下面的方法。view.annotation 是被点击的注释。

```
- (void)mapView:(MKMapView *)mapView 
 annotationView:(MKAnnotationView *)view
calloutAccessoryControlTapped:(UIControl *)control
{
    NSLog(@"The annotation tapped is: %@", view.annotation.title);
} 
```

编辑：可以在这里找到，API 是你的朋友。

[https://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKMapViewDelegate_Protocol/MKMapViewDelegate/MKMapViewDelegate.html#//apple_ref/doc/uid/TP40008204](https://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKMapViewDelegate_Protocol/MKMapViewDelegate/MKMapViewDelegate.html#//apple_ref/doc/uid/TP40008204)

# .htaccess - .htaccess：如果请求了这些目录中的任何一个，则重写为脚本并将请求的目录作为变量传递

> ID：10645063
> 
> 赞同：0
> 
> 时间：2012-05-18T00:00:42.433
> 
> 标签：.htaccess, url-rewriting

我的网站上有很多不同的博客，即

mysite.com/news
mysite.com/blog
mysite.com/bits
等。

我在幕后使用相同的 php 脚本，并希望保持 url 整洁，所以我设置了这些规则：

```
# blogs
RewriteRule ^(bits|blog|news)(/?)$ news/?type=$1    
RewriteRule ^(bits|blog|news)/[a-zA-Z0-9_-]+/([0-9]+)(/?)$ news/article.php?type=$1&id=$2 
```

现在发生的事情是“类型”总是作为新闻出现？我不明白为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T03:59:37.120

我建议在您要重定向到的 URL 中添加前导“/” - 而且您不需要将尾随“/”括在括号中。

此外，在规则末尾放置一个 [L] 标志，以阻止它查看 .htaccess 的其余部分

试试这个：

```
RewriteRule ^(bits|blog|news)/?$ /news/?type=$1 [L]
RewriteRule ^(bits|blog|news)/[a-zA-Z0-9_-]+/([0-9]+)/?$ /news/article.php?type=$1&id=$2 [L] 
```

预先添加 .. 的 RewriteCond

```
RewriteCond %{QUERY_STRING} ^$ 
```

.. 对每个规则也将过滤掉任何带有解析查询字符串的 URL 的机会。

# sql - 运行总计结果不正确

> ID：10645064
> 
> 赞同：0
> 
> 时间：2012-05-18T00:00:49.007
> 
> 标签：sql, sql-server-2008, tsql

我有一个游标，它从不同的表中收集信息，然后更新摘要，这是让我头疼的代码片段。

我正在尝试通过输入正确的男性和女性信息来更新汇总表，这些信息将加起来等于患者总数。

```
BEGIN
    Set @MaleId =154
    set @Femaleid =655

    if @Category =@MaleId
    begin
        set @Males = @Value
    end
    if @Category = @Femaleid
    begin
        set @CummFemalesOnHaart =@Value
    end 

    Update Stats
       set Males =@Malest,Females =@Females
     where
           Category =@Category and
           periodType =@PeriodType AND StartDate =@Startdate and EndDate =@enddate 
```

问题：

## 结果不准确

```
organisation PeriodType  StartDate   EndDate     Deaths  Patients  Males  Females
------------ ----------  ----------  ----------  ------  --------  -----  -------
34           Monthly     2010-04-01  2010-04-30  NULL    6843      896    463
34           Monthly     2010-04-01  2010-04-30  NULL    10041     896    463
34           Monthly     2010-05-01  2010-05-31  NULL    10255     898    463 
34           Monthly     2010-05-01  2010-05-31  NULL    7086      898    461
34           Monthly     2010-06-01  2010-06-30  NULL    10344     922    461
36           Monthly     2010-03-01  2010-03-31  NULL    4317      1054   470
36           Monthly     2010-03-01  2010-03-31  NULL    5756      896    470
36           Monthly     2010-04-01  2010-04-30  NULL    4308      896    463
36           Monthly     2010-04-01  2010-04-30  NULL    5783      896    463 
```

男性和女性应该只更新加起来等于患者总数的单行，例如

```
Patients  Males  Females
--------  -----  -------
41        21     20 
```

有任何想法吗？

只是为了澄清一点

/*查询表*/

```
organisation  PeriodType  StartDate   EndDate     Males  Females 
------------  ----------  ----------  ----------  -----  -------
34            Monthly     01-02-2012  01-02-2012  220    205
34            Monthly     01-02-2012  01-02-2012  30     105 
```

/*更新语句*/

```
Update Stats 
   set Males =@Malest,Females =@Females 
 where 
       --Category =@Category and 
       periodType =@PeriodType AND StartDate =@Startdate and EndDate =@enddate 
```

统计表 /*输入前*/

```
organisation PeriodType  StartDate   EndDate     Deaths  Patients  Males  Females
------------ ----------  ----------  ----------  ------  --------  -----  -------
34           Monthly     01-02-2012  01-02-2012  0       425       null   null
34           Monthly     01-02-2012  01-02-2012  25      null      null   null   
34           Monthly     01-02-2012  01-02-2012  5       null      null   null 
34           Monthly     01-02-2012  01-02-2012  5       135       null   null 
```

/*如果您仔细查看期间类型、开始日期、结束日期的行，那么我不希望更新值影响除患者总数之外的任何其他行*/

统计表 /* 输出 */

```
organisation PeriodType  StartDate   EndDate     Deaths  Patients  Males  Females
------------ ----------  ----------  ----------  ------  --------  -----  -------
34           Monthly     01-02-2012  01-02-2012  0       425       220    205
34           Monthly     01-02-2012  01-02-2012  25      null      null   null   
34           Monthly     01-02-2012  01-02-2012  5       null      null   null 
34           Monthly     01-02-2012  01-02-2012  5       135       30     105 
```

我希望这能提供更多信息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:47:05.160

从我所见，您提出的建议总是冒着分配不正确数据的风险。如果您有两条记录，一条记录有 500 名患者（男性 250 名和女性 250 名），另一份记录有 500 名患者（但男性 300 名和女性 200 名），会发生什么情况？

然后使用哪个记录总数没有明确的区别，您最终可能会使用不正确的数据进行多次更新。

话虽这么说，我认为你应该做的是以下几点。

1.  创建一个 CTE，从统计表中选择患者，从查询表中选择男性/女性，其中患者 =（男性 + 女性）

2.  使用加入患者总数的 CTE 中的值在 stats 表上运行更新语句。

据我所知，这应该为您所追求的提供解决方案。

您可以在此处阅读有关 CTE 的更多信息：[MSDN Common Table Expressions](http://msdn.microsoft.com/en-us/library/ms175972.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T06:39:06.643

我也不确定我是否理解这个问题。但听起来你是说可以有多个记录具有相同的`periodType`,`startDate`和`endDate`，但数量不同`Patients`。您希望确保查询仅更新总数`Patients`与您计算的总数匹配的记录，即 total = `@Males + @Females`。

如果正确，请在患者值上添加过滤器：

```
 UPDATE Stats 
    SET    Males = @Males,
           Females = @Females 
    WHERE  Category = @Category 
    AND    periodType = @PeriodType 
    AND    StartDate = @Startdate 
    AND    EndDate = @enddate 
    AND    Patients = (@Males + @Females) 
```

尽管顺便说一句，游标通常比基于集合的替代方案效率低..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T00:54:10.183

我不完全确定我理解你的问题......但认为这就是你所追求的吗？

```
UPDATE Stats
SET Males = (SELECT COUNT(*) From <queryTable> WHERE Category = @MaleId and periodType =@PeriodType AND StartDate =@Startdate and EndDate =@enddate)
,SET Females = (SELECT COUNT(*) From <queryTable> WHERE Category = @FemaleId and periodType =@PeriodType AND StartDate =@Startdate and EndDate =@enddate) 
```

希望能帮助到你！

# ruby - 如何在 ruby 中创建自己的语法/重写现有语法？

> ID：10645065
> 
> 赞同：1
> 
> 时间：2012-05-18T00:00:49.707
> 
> 标签：ruby

例如，这是一个标准`if`语义：

```
if (condition)
     do stuff
end 
```

我想要做的是以`if`这样的方式重写，如果抛出异常，我可以做一些错误处理。

ruby 有办法重新定义预先存在的语法吗？如果是这样，怎么做？

编辑：让我们说在 if 条件下，在条件 nil 上调用一个方法`if(my_object.my_method)`。如果`my_object`没有定义，ruby 会抛出一个错误。如果行为能够捕获错误，我希望能够改变方式。（在我的具体情况下，它会将堆栈跟踪通过电子邮件发送给我......但通过电子邮件发送是很容易的部分）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:27:46.127

最*简单*的方法是用异常处理来包装你的脚本，我敢打赌，通过使用 load 或 require 可以毫不费力地完成。否则，您谈论的是 (a) 重写 Ruby 的工作方式，或 (b) 在加载时修改 AST。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T00:46:20.710

我认为没有必要重新定义 ruby​​ 行为。

确保您的应用程序具有某种 main 方法，因此您可以使用异常处理来包装它。

```
begin  
   # main method  
rescue => msg  # by default it will catch only StandartError
   # send email "hi, you have a problem in you application"  
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T00:56:14.700

不，您不能在 Ruby 程序中更改 Ruby 的语法或语义。您可能想改用 Perl6 或 Lisp。

# ubuntu - Cronjob 在手动启动时运行，但不是在每次重新启动时运行

> ID：10645066
> 
> 赞同：1
> 
> 时间：2012-05-18T00:00:57.550
> 
> 标签：ubuntu, cron, webmin

试图编写一个 cron 作业

这里是，

```
@reboot lynx -dump ft-server > /dev/null 
```

当我通过 webmin 手动运行作业时，一切都很好，按预期进行，没有错误。但是当我重新启动系统时，它什么也没做。

帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T23:15:52.933

我没有试图让 lynx 访问本地托管的网站，我所要做的就是运行 php 文件。

我的命令没有运行，因为 apache 还没有启动。

# php - $_SESSION['username'] 在进入 SQL 查询之前是否需要转义？

> ID：10645067
> 
> 赞同：1
> 
> 时间：2012-05-18T00:01:10.607
> 
> 标签：php, mysql

我想知道在 SQL 查询中使用 $_SESSION 数组中的任何内容之前是否需要对其进行转义。

请注意，我没有在我的应用程序中使用 cookie，因为我听说它们可以用于会话劫持（？）

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T00:09:09.260

您需要对传递给 sql 查询的**每个字符串进行转义，无论其来源如何。**

即使它是您从数据库中检索到的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T00:17:50.447

假设 PHP 中尚未发现漏洞，在您允许任何东西接触您的数据库之前，应该使用准备好的语句或 mysql_real_escape_string 对所有内容进行转义**。**

存储在 $_SESSION 中的数据并不总是干净的。对于多页表单，您可以将用户输入存储在 $_SESSION 中，直到您将其全部写入数据库时​​的最后一页。如果你养成任何认为 $_SESSION 是“干净”的习惯，你最终会给自己带来麻烦。

您绝对应该养成假设系统中的每条数据都是脏的习惯，直到您逃脱它为止。请注意，如果您使用的是动态表名，则转义对您没有帮助。 **永远不要**在查询中使用曾经靠近用户的任何地方的表名或列名。各种转义机制不会逃脱反引号。如果你有一个准备好的查询说：

```
"SELECT * FROM `:aTable`;" 
```

和 aTable 来自用户，用户输入类似

```
` WHERE id IN (DELETE FROM user); 
```

可能刚刚删除了您的所有用户记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T00:07:05.753

如果使用不正确，变量与变量`$_SESSION`相同`$_GET`，因此您的问题的答案是肯定的，如果您在会话中存储 RAW 用户输入（您不应该这样做），那么您需要转义它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T00:17:49.573

会话变量就像任何其他变量一样。那里的数据必须来自某个地方。如果您直接将发布的变量存储在那里，那么它基本上就像使用发布的变量一样。

唯一的区别是会话变量在不同的访问中持续存在，仅此而已。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-18T00:18:00.573

一个黄金法则是**永远不要相信用户输入**，除非数据来自您（即您的系统），否则它应该被视为“用户输入”，这当然包括会话数据。

它涉及为 SQL 转义会话数据，您可以并且应该有效地清理数据以供 sql 使用，例如使用 mysql_real_escape_string() 但根据会话中包含的数据，我还将根据您期望的内容来验证会话应该包含.

不太清楚您对 cookie / session 劫持评论的意思，我假设您的意思是您只使用 session 来存储数据？在典型的 php 安装会话中，仍然使用 cookie 纯粹作为指向用户会话的指针。

# persistence - 还有哪些其他语言可以让您将应用程序状态保存和恢复到磁盘，例如 sbcl 和 factor？

> ID：10645068
> 
> 赞同：0
> 
> 时间：2012-05-18T00:01:29.517
> 
> 标签：persistence

我知道的两个是：

*   [sbcl](http://www.sbcl.org/manual/Saving-a-Core-Image.html) : sb-ext:save-lisp-and-die
*   [因素](http://docs.factorcode.org/content/article-images.html)：保存图像并退出

还有其他人吗？我对在应用程序之外保存状态（外部资源、文件对象等的句柄）不感兴趣，只是数据和函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T01:03:44.260

Squeak(Smalltalk)：SmalltalkImage 当前快照：true and Quit：false。

与上述情况一样，Squeak Smalltalk 让开发人员/用户使用 sbcl（或其他 lisp 系统）之类的图像文件将应用程序状态保存/恢复到磁盘。

# javascript - d3.js - 在任一图形上使用滚轮/拖动时都放大和缩小/滚动的堆叠图形

> ID：10645069
> 
> 赞同：4
> 
> 时间：2012-05-18T00:01:39.910
> 
> 标签：javascript, d3.js

我有一对希望与 d3.js zoom() 功能相关联的图表。我查看了 d3.js API wiki，但还没有 zoom() 功能的文档。基本上，我希望在用户缩放或拖动任一图表时更新这两个图表。我看不到如何将缩放行为应用于两个不同的图表。

我创建了堆叠图的工作示例的 JSFiddle，但缩放功能仅适用于上图：http: [//jsfiddle.net/G6GPm/2/](http://jsfiddle.net/G6GPm/2/)

我希望在修改任何一个图形时都将缩放和拖动应用于两个图形。我知道我需要修改对 zoom() 行为的调用：

```
rect.call(d3.behavior.zoom().x(x).on("zoom", zoom)); 
```

我看到这种行为正在应用于 x(x) 轴，但我需要它也应用于下图的 x(x_sta) 轴。

我试图打破 zoom() 功能，但没有任何 API 文档，我猜测需要发生什么：

```
rect.call(d3.behavior.zoom()
  .x(x).on("zoom", zoom)
  .x(x_sta).on("zoom", zoom)
); 
```

这显然失败了。我已经看到了一些使用多个图表的 d3.js 交互的其他示例，但没有像这样（两个不同的图表具有自己的轴和数据等）。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T05:48:30.507

对于其他可能会在图表大小不同的情况下执行此操作的人，答案可能会更复杂，当它发生时我会回答这个问题。但幸运的是，答案很简单......

...对两个图表使用相同的 X 轴！在这里为你修好了。

[http://jsfiddle.net/G6GPm/11/](http://jsfiddle.net/G6GPm/11/)

另一个建议：不要在 javascript 中设置样式，更喜欢 CSS。尝试仅将 JS 用于 attr。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T20:12:43.713

缩放行为具有您可以设置的 .translate 和 .scale 属性。解决方案大致如下：

```
var zoomCallback = function() {
  // do stuff
  zoom1.scale(d3.event.scale).translate(d3.event.translate);
  zoom2.scale(d3.event.scale).translate(d3.event.translate);  
}

var zoom1 = d3.behavior.zoom().x(x).on("zoom", zoomCallback);
var zoom2 = d3.behavior.zoom().x(x_sta).on("zoom", zoomCallback);

rect1.call(zoom1);
rect2.call(zoom2); 
```

# windows-7 - IIS 7 主机头不工作

> ID：10645070
> 
> 赞同：2
> 
> 时间：2012-05-18T00:01:49.903
> 
> 标签：windows-7, iis-7, localhost, hostheaders

我在本地 Windows 7 机器上绑定网站时遇到问题。当我创建一个新网站时，我指定本地机器路径，然后我编辑绑定以添加 site1.com 的主机头。当我在浏览器地址栏中输入“http://site1.com”时，它会响应：

```
The connection has timed out
The server at site1.com is taking too long to respond. 
```

我推测这与我的 DNS 试图在网上检索 site1.com 的 IP 地址有关，而不是我的本地实现。如果我将主机头留空，绑定到端口 8080，然后在地址栏中输入“http://localhost:8080”，它可以正常工作。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T00:10:53.037

请务必修改`c:\windows\system32\drivers\etc\hosts`以包含您的 site1.com 域。

```
 127.0.0.1     site1.com 
```

# javascript - 无法使用 Chrome 开发工具检查元素

> ID：10645073
> 
> 赞同：7
> 
> 时间：2012-05-18T00:02:19.943
> 
> 标签：javascript, iframe, google-chrome-devtools

我有一个基本的 html 文件 (base.html)，其中包含一个使用 (iframe.html) 的 iframe。iframe 仅在单击某个菜单项时显示。它们都托管在同一个域上。

在 base.html 中，我包含了一个指向我使用的外部服务的脚本。包含脚本会返回一个存在于我的页面上的对象。

```
<script type="text/javascript" src="externalSite.com/myID.js"></script> 
```

在 iframe.html 中，我有另一个脚本，它根据返回的对象的某些属性构建菜单

```
<script type="text/javascript" src="my_list_builder.js"></script> 
```

my_list_builder.js 的代码如下所示：

```
var myList = parent.externalAPI.getItems()
var listBlock = "<div><ul>"

for (var i = 0; i < myList.length; i++) {
    listBlock += '<li><span>'+ myList[i].Name + '</span></li>';
}

listBlock += '</ul></div>'

$('someElement').append(listBlock); 
```

现在，此代码按预期执行并将 listBlock 添加到我想要它的页面，但是当我尝试在 Chrome 中检查 iframe 中的任何元素时，我无法这样做。iframe 是我可以检查的最低级别的元素，但它没有通常的下拉选项。如果我删除 my_list_builder.js，我可以毫无问题地检查 iframe 中的元素。

关于可能导致问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T19:16:20.920

尝试`debugger`在 iframe/非 iframe 脚本中使用关键字。简单地放在`debugger;`一行上，应该以编程方式在 Chrome 开发人员工具（也是 Firebug）中导致一个断点。更多信息：[https ://developer.mozilla.org/en/JavaScript/Reference/Statements/debugger](https://developer.mozilla.org/en/JavaScript/Reference/Statements/debugger)

# c# - 在 https://wserver:442/service1.svc 没有监听端点

> ID：10645074
> 
> 赞同：0
> 
> 时间：2012-05-18T00:02:28.867
> 
> 标签：c#, wcf, web-services

我正在尝试使用自签名 SSL 设置 WCF 服务。

我可以浏览到 HTTPS，它会显示元数据，我可以创建一个服务引用。

但是它抛出了异常：没有`https://wserver:442/service1.svc` 可以接受该消息的端点监听。

wserver 是我的服务器的名称，但我没有在任何地方使用它，所以我不知道它从哪里得到它？

我的服务器 Webhost.config （我认为问题可能出在哪里）是：

```
<?xml version="1.0"?>
<configuration>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding name="Binding1">
          <security mode="TransportWithMessageCredential">
            <message clientCredentialType="UserName"/>
          </security>
        </binding>
      </wsHttpBinding>

    </bindings>
    <services>
      <service behaviorConfiguration="ServiceBehavior" name="AutoSenderWCFService.AutoSenderService">
        <endpoint binding="wsHttpBinding" bindingConfiguration="Binding1"
          contract="AutoSenderWCFService.IService1" />
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
      </service>
    </services>

    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehavior">
          <serviceCredentials>

            <userNameAuthentication userNamePasswordValidationMode="Custom"
              customUserNamePasswordValidatorType="AutoSenderWCFService.MyValidator, AutoSenderWCFService"/>

          </serviceCredentials>

          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

</configuration> 
```

或者我在自签名 SSL 上犯了一个错误？

我的客户端只是：

```
 private void button1_Click(object sender, EventArgs e)
    {

        ServiceReference1.Service1Client client = new ServiceReference1.Service1Client();
        client.ClientCredentials.UserName.UserName = "test";
        client.ClientCredentials.UserName.Password = "testPassword";            
        ServiceReference1.Contact[] test = client.GetDrivers();

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T14:47:56.530

发生这种情况有几个原因。由于您有一个在 443 上运行的默认 https，因此您将端口 442 用于 https 为您的服务。

您是否在端口 442 上执行了有关 https 侦听的任何映射？您可以使用 netsh 命令执行此操作，如下所示：

```
C:\> netsh http add sslcert ipport=0.0.0.0:442 certhash=6797aea29440de9389bc636e15a35b741d8c22a3 appid={2e80948d-9ae6-42c9-ad33-294929333965} 
```

您的证书哈希需要是指纹 ID，而 appid 是 WCF 项目 dll 的哈希 ID，您将在您的 assembly.cs 文件中创建一个并包含在您构建项目之前。

接下来，您定义了一个 mex 端点，可以将其删除并将您的 serviceMetaData 元素更改为具有`httpsGetEnabled ="true"`和`httpGetEnabled="false"`

现在确保浏览到您的服务页面，看看是否正常。

接下来在您的客户端代码中调用 WCF 服务之前，您需要执行以下步骤以绕过证书验证检查：

```
 System.Net.ServicePointManager.ServerCertificateValidationCallback = (sender, cert, chain, error) =>
                                                                             {
                                                                                 return true;
                                                                             }; 
```

使用上述代码的原因是因为您使用的是自签名证书。如果您拥有由某个受信任的机构颁发的证书，那么您的客户端应用程序中不需要上述代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-10T16:09:52.523

如上所示，我在服务器端 Web.Config 文件的 WCF 服务中更改了 HTTPSEnabled 和 HTTPEnabled 属性。它可以正常工作而不会发出“没有端点正在监听...”问题。由于网站严格要求 SSL，因此 HTTPEnabled 属性应设置为 false。感谢您在上面发布解决方案。

# javascript - 触摸设备的事件监听器

> ID：10645076
> 
> 赞同：0
> 
> 时间：2012-05-18T00:02:36.957
> 
> 标签：javascript, mobile, user-agent

我试图弄清楚用户代理是否是触摸设备，如果是我想加载 addEventListener ...

```
if( (navigator.userAgent.match(/iPhone/i)) || 
    (navigator.userAgent.match(/iPad/i)) {
    document.addEventListener("touchstart", function() {},false);
}) 
```

另外，我如何检测 Android 设备和可能的其他触摸设备？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T03:06:07.020

[http://modernizr.github.com/Modernizr/touch.html](http://modernizr.github.com/Modernizr/touch.html)

这就是浏览器功能库modernizr 的做法。为什么不使用它们？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:54:07.260

我前段时间用来测试触摸事件的一个简单脚本是：

```
var hasTouch = (function(){
  if (document && document.createEvent) {
    try {
      document.createEvent('GestureEvent');
      document.createEvent('TouchEvent');
      return true;
    } catch (e) {
      return false;
    }
  }
})(); 
```

我已经有一段时间没有使用它了，所以可能有更好的方法，但上述方法仍然有效。

您还可以尝试 Kangax 的文章[Detecting event support without browser sniffing](http://perfectionkills.com/detecting-event-support-without-browser-sniffing/)，可能类似于：

```
 function isTouchEventSupported(eventName) {
    var el = document.createElement('div');
    eventName = 'on' + eventName;
    var isSupported = (eventName in el);

    if (!isSupported) {
      el.setAttribute(eventName, 'return;');
      isSupported = typeof el[eventName] == 'function';
    }
    el = null;
    return isSupported;
  }

  alert(isTouchEventSupported('touchstart'));  // false in IE 8 
```

# c# - 比较实体框架中的字符串编号范围

> ID：10645081
> 
> 赞同：1
> 
> 时间：2012-05-18T00:03:33.103
> 
> 标签：c#, entity-framework, linq-to-entities

长话短说，我需要根据范围（高/低值）获取项目，但是数据库中的列/属性是 a`string`并且我**不允许**更改它。那么我应该如何比较一个范围呢？

我似乎找不到将实体属性转换为的方法，`int`因此我可以进行比较。当然`Convert.toInt32`也不行。我看不出有什么`SqlFunctions`帮助，但也许我忽略了一些简单的事情。

我一直在玩它，但到目前为止没有运气。这是我最新的尝试，但不起作用：

```
var result = Repo.Query().Where(e => e.SerialNumber.Cast<int>().First() >= myIntLowVariable && e.SerialNumber.Cast<int>().First() <= myIntHighVariable); 
```

有什么建议么？

**更新**

用户输入两个序列号，我需要返回该范围内的所有记录，但`SerialNumber`它是一个`string/varchar`列/属性。

**数据**- 抱歉不知道如何在这里放一张桌子..

SN :: 描述
1 :: 牛奶
2 :: 鸡蛋
3 :: 面包
4 :: 奶酪
5 :: 培根
6 :: 酸奶
7 :: 芥末
8 :: 鸡肉
9 :: 比萨饼
10 :: 薯条

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:11:01.943

如果您在查询中调用 ToList()，那么您应该能够将您的字符串转换为 Int32。

```
var result = Repo.Query().ToList().Where(e => e.StringNumberField.Cast<int>().First() >= myIntLowVariable && e.StringNumberField.Cast<int>().First() <= myIntHighVariable); 
```

如果您无法投影整个查询，则可以执行以下操作：

在您的数据库中创建一个执行过滤的存储过程。这样的事情会做：

```
CREATE PROCEDURE spGetStuffBetween
(
    @min int,
    @max int
)
AS
BEGIN
    SELECT * from dbo.Stuff where Convert(int, SerialNumber) < @max and  Convert(int, SerialNumber) > @min;
END 
```

使用 EDM 工具使用新添加的存储过程从数据库中更新您的模型。在“添加”下，选择您刚刚创建的存储过程，然后选择“完成”。

更新模型后，您将无法看到存储过程，因此右键单击设计图面并选择“模型浏览器”。您将能够在存储过程节点下看到它。

双击模型浏览器中的存储过程。您可以在此处指定从存储过程返回的集合类型。

现在您可以调用以下代码来获得您想要的结果：

```
int myIntLowVariable = 1000;
int myIntHighVariable = 1000000;

var results= Repo.spGetAnimalsBetweenRange(myIntLowVariable , myIntHighVariable ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T02:46:50.820

[使用此处](https://stackoverflow.com/questions/121864/most-efficient-t-sql-way-to-pad-a-varchar-on-the-left-to-a-certain-length)的答案将字符串与前导零对齐并对输入字符串执行相同操作，现在您可以对所需范围进行字母比较。

您也可以尝试[这个问题](https://stackoverflow.com/questions/5754218/convert-string-to-int-in-ef-4-0)中的方法。

# ruby-on-rails-3 - Rails 中 cookie 的默认过期时间

> ID：10645083
> 
> 赞同：10
> 
> 时间：2012-05-18T00:03:46.893
> 
> 标签：ruby-on-rails-3, cookies

Rails (3.1.3)中[cookie](http://api.rubyonrails.org/classes/ActionDispatch/Cookies.html)的默认过期时间是多少？

我找到了有关如何设置、如何检索的文档，但我没有看到默认的过期时间。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-01T21:25:44.270

默认情况下，cookie 在会话结束时过期（即用户关闭浏览器时）。

# module - 通过模块使用 Tkinter

> ID：10645084
> 
> 赞同：0
> 
> 时间：2012-05-18T00:03:57.413
> 
> 标签：module, tkinter

我对 python 很陌生，在使用 tkinter 时我一直在尝试创建模块。我有一个要用于顶部菜单的主模块和另一个带有报告的模块，该报告也使用 tkinter 对象。

第一个脚本是 main.py 如下

```
 from Tkinter import *
       from wind import *
       menu=Tk()
       menu.geometry('200x200')
       Button(menu,text="push",command=wind.gui).pack()
       menu.mainloop() 
```

第二个脚本是wind.py，如下所示。

```
 from Tkinter import *

  class wind:
  @staticmethod
  def getting():
       print y2,y2.get()

  @staticmethod
  def gui():
      global y2
      main=Tk()
      main.geometry('300x300+100+100')
      y2=StringVar()
      Entry(main, textvariable=y2, width=40).pack()
      Button(main, text="Run", command=wind.getting).pack()
      main.mainloop() 
```

该代码似乎工作正常。但是，来自 tkinter 按钮的 y2 的值​​是空的。任何帮助将不胜感激！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:20:36.877

布莱恩就在那儿。你对两个主循环的使用对我来说有点奇怪。在某些情况下，您会在 Tkinter 中启动辅助循环，但不是这样。

也不确定你的 y2 是在哪里定义的，但是模块中的 global 是指该模块的全局空间，而不是整个程序的全局空间。至少我是这样解释关于 globals() 函数的[注释](http://docs.python.org/release/2.6.8/library/functions.html#globals)以及它可能与 global 关键字有关的方式。

我对wind.py做了如下修改，得到了程序更合理的响应：

```
from Tkinter import *

y2 = None

class wind:
    @staticmethod
    def getting():
        print y2, y2.get()

    @staticmethod
    def gui():
        global y2
        main=Toplevel()
        main.geometry('300x300+100+100')
        y2 = StringVar()
        Entry(main, textvariable=y2, width=40).pack()
        Button(main, text="Run", command=wind.getting).pack()
        #main.mainloop() 
```

请注意，我将 y2 设为 wind.py 模块的实际全局级别变量，将 main 设为 Toplevel() 小部件并在 gui() 末尾注释掉虚假的 mainloop() （因为您已经处于主循环中第一个窗口）。

# c++ - 使用模板类的成员类型作为类成员变量的类型

> ID：10645085
> 
> 赞同：0
> 
> 时间：2012-05-18T00:04:01.517
> 
> 标签：c++, templates

为什么以下内容无法编译（MSVC10 - 但我怀疑它不是有效的 C++），是否有解决方法？

```
template <typename M>
struct MyClass
{
    typedef std::vector<M>::iterator iteratorT;

    iteratorT myIterator;

}; 
```

错误是`error C2146: syntax error : missing ';' before identifier 'iteratorT'`。我已经尝试了一堆具有相同结果的变体：您可以将`std::vector<M>::iterator`其用作成员函数中的类型，但不能用作成员变量的类型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T00:06:35.993

这是一个案例`typename`。简短的回答，你需要这样做：

```
 typedef typename std::vector< M >::iterator iteratorT; 
```

长答案，编译器不知道什么`std::vector< M >::iterator`可以解析为`M`任何东西，并且可能有一个专门化`std::vector`的。具体来说，它无法判断`std::vector< M >::iterator`是类型还是值，它相信它是一个值。您必须通过插入来明确告诉编译器它的类型`typename`。

# c++ - pcl包括卷积不起作用

> ID：10645092
> 
> 赞同：0
> 
> 时间：2012-05-18T00:04:22.320
> 
> 标签：c++, point-cloud-library

我正在尝试在 pcl（点云库）中使用卷积库。高斯卷积页面的页面在[这里](http://docs.pointclouds.org/trunk/classpcl_1_1filters_1_1_gaussian_kernel.html)。它为此库引用了以下包含：

```
#include <pcl/filters/convolution_3d.h> 
```

但是当我包含上述文件时，我得到以下编译错误：

```
fatal error: pcl/filters/convolution_3d.h: No such file or directory 
```

过滤器文件中的其他包括：

```
#include <pcl/filters/radius_outlier_removal.h>
#include <pcl/filters/conditional_removal.h> 
```

工作得很好，为什么卷积库不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T05:44:06.447

该功能仅在主干版本 (1.6) 中，因此这可以通过仅安装 1.5.1 版本来解释，或者可能没有正确的 -I/-L 标志让编译器首先查看主干版本，假设你已经安装了。

# r - 将函数应用于 R 中的 data.frame 中的组

> ID：10645100
> 
> 赞同：14
> 
> 时间：2012-05-18T00:05:59.440
> 
> 标签：r, dataframe, apply

我正在尝试获取数据框中组（“a”和“b”）的变量（v）的累积和。如何将底部的结果（其行的偶数正确编号）放入我的数据框的 cs 列？

```
> library(nlme)
> g <- factor(c("a","b","a","b","a","b","a","b","a","b","a","b"))
> v <- c(1,4,1,4,1,4,2,8,2,8,2,8)
> cs <- rep(0,12)
> d <- data.frame(g,v,cs)

> d
   g v cs
1  a 1 0
2  b 4 0
3  a 1 0
4  b 4 0
5  a 1 0
6  b 4 0
7  a 2 0
8  b 8 0
9  a 2 0
10 b 8 0
11 a 2 0
12 b 8 0

> r=gapply(d,FUN="cumsum",form=~g, which="v")
>r

$a     
   v   
1  1   
3  2   
5  3  
7  5  
9  7  
11 9  

$b    
    v 
2   4 
4   8 
6  12 
8  20 
10 28 
12 36 

> str(r)
List of 2
 $ a:'data.frame':  6 obs. of  1 variable:
  ..$ v: num [1:6] 1 2 3 5 7 9
 $ b:'data.frame':  6 obs. of  1 variable:
  ..$ v: num [1:6] 4 8 12 20 28 36 
```

我想我可以想出一些费力的方法来将这些数据帧中的数据导入 d$cs，但是我缺少一些简单的调整。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T00:15:48.063

`split<-`是一只非常奇怪的野兽

```
split(d$cs, d$g) <- lapply(split(d$v, d$g), cumsum) 
```

导致

```
> d
   g v cs
1  a 1  1
2  b 4  4
3  a 1  2
4  b 4  8
5  a 1  3
6  b 4 12
7  a 2  5
8  b 8 20
9  a 2  7
10 b 8 28
11 a 2  9
12 b 8 36 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-18T00:35:41.277

我会用`ave`. 如果您查看 的来源`ave`，您会发现它基本上包含了 Martin Morgan 的[解决方案](https://stackoverflow.com/a/10645158/271616)。

```
R> g <- factor(c("a","b","a","b","a","b","a","b","a","b","a","b"))
R> v <- c(1,4,1,4,1,4,2,8,2,8,2,8)
R> d <- data.frame(g,v)
R> d$cs <- ave(v, g, FUN=cumsum)
R> d
   g v cs
1  a 1  1
2  b 4  4
3  a 1  2
4  b 4  8
5  a 1  3
6  b 4 12
7  a 2  5
8  b 8 20
9  a 2  7
10 b 8 28
11 a 2  9
12 b 8 36 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-18T00:13:19.790

我为这些事情选择的工具是**plyr**包：

```
require(plyr)
> ddply(d,.(g),transform,cs = cumsum(v))
   g v cs
1  a 1  1
2  a 1  2
3  a 1  3
4  a 2  5
5  a 2  7
6  a 2  9
7  b 4  4
8  b 4  8
9  b 4 12
10 b 8 20
11 b 8 28
12 b 8 36 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-29T14:15:24.903

```
> library(nlme)
> g <- factor(c("a","b","a","b","a","b","a","b","a","b","a","b"))
> v <- c(1,4,1,4,1,4,2,8,2,8,2,8)
> cs <- rep(0,12)
> d <- data.frame(g,v,cs)
> d <- d[order(d$g),]
> temp <- by(d$v,d$g,cumsum)
> d$cs <- do.call("c",temp)
> d
   g v cs
1  a 1  1
3  a 1  2
5  a 1  3
7  a 2  5
9  a 2  7
11 a 2  9
2  b 4  4
4  b 4  8
6  b 4 12
8  b 8 20
10 b 8 28
12 b 8 36 
```

使用 by 函数的另一种解决方案，但我必须先订购数据

# android - 服务启动android在启动时强制停止 - 怎么办？

> ID：10645106
> 
> 赞同：1
> 
> 时间：2012-05-18T00:06:52.523
> 
> 标签：android, service, boot

我想在启动时启动服务。我已经完成了一个广播接收器，从广播接收器启动了一个服务，所有这些都插入到了 xml 中。来自的教程`http://www.androidcompetencycenter.com/2009/06/start-service-at-boot/`对我帮助很大。结果：在模拟器上，就像在真实设备上发生的那样： - 服务启动，然后立即停止！我不知道为什么服务停止！

该服务肯定已启动，我可以读取日志和 toast msg。证明服务已启动。

同样在日志中，我可以看到一些消息，例如：

```
<u>
05-17 23:18:44.379: D/EAS SyncManager(247): !!! EAS SyncManager, onCreate
05-17 23:18:44.789: D/EAS SyncManager(247): !!! EAS SyncManager, onStartCommand
05-17 23:18:44.860: D/EAS SyncManager(247): !!! EAS SyncManager, stopping self
05-17 23:18:44.999: D/My Service(258): starting broadcast receiver
05-17 23:18:45.119: D/My Service(258): starting service in onCreate
05-17 23:18:45.985: D/Eas Debug(247): Logging: 
05-17 23:18:45.999: D/EAS SyncManager(247): !!! EAS SyncManager, onDestroy
05-17 23:18:46.299: I//system/bin/fsck_msdos(29): Attempting to allocate 998 KB for FAT
</u> 
```

EAS SyncManager 被销毁。我相信这就是我的服务被迫停止的原因。从我从[http://hi-android.info/src/com/android/exchange/SyncManager.java.html](http://hi-android.info/src/com/android/exchange/SyncManager.java.html)读到的内容来看，当 EAS SyncManager 被销毁时，启动时启动的服务会收到一个 StopSelf()默认。

我不知道这是不是真的。如果它是真的......我该如何解决它？直到现在还有人反对这个吗？请帮忙。

这是代码：

类

// 服务等级

```
public class Contacts_Service extends Service{

    @Override
    public IBinder onBind(Intent arg0) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public void onCreate() {
        Toast.makeText(this, "My Service Created", Toast.LENGTH_LONG).show();   
        Log.d("My Service", "onCreate");

        mPeriodicEventHandler = new Handler();      
                mPeriodicEventHandler.postDelayed(doPeriodicTask,13000);
    }

     private Runnable doPeriodicTask = new Runnable()
        {
            public void run() 
            {

                //your action here
                Log.d("My Service", "eeeevery 13000 ms");

                mPeriodicEventHandler.postDelayed(doPeriodicTask, 13000);
            }
        };

} 
```

// BroadcastReceiver 类在启动时启动服务

```
public class MyStartupIntentReceiver extends BroadcastReceiver{

    @Override
    public void onReceive(Context context, Intent intent) {

         if("android.intent.action.BOOT_COMPLETED".equals(intent.getAction())){

         Log.d("My Service", "starting broadcast receiver");
            Intent serviceIntent = new Intent();
            serviceIntent.setAction("com.Srv.mail.Contacts_Service");
            context.startService(serviceIntent);

            //serviceIntent.setAction("com.Srv.mail.SrvMailSettingsActivity");
            //context.startActivity(serviceIntent);

    }

    }

} 
```

还有 AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.Srv.mail"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="7" />
    <uses-permission android:name="android.permission.READ_CONTACTS"/>
    <uses-permission android:name="android.permission.INTERNET" />   
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />

<application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >

 <receiver android:name=".MyStartupIntentReceiver">
    <intent-filter>
        <action android:name="android.intent.action.BOOT_COMPLETED" />
        <category android:name="android.intent.category.HOME" />
    </intent-filter>
</receiver>

        <service android:enabled="true" android:name="Contacts_Service">
                <intent-filter>
                 <action android:name="com.Srv.mail.Contacts_Service" />
            </intent-filter>
            </service>  

        <activity
            android:name="com.Srv.mail.SrvMailSettingsActivity"
            android:label="@string/app_name" >
            <!-->intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />

            </intent-filter-->

        </activity>

    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T11:33:48.637

我不确定也试试这个..也许它有效

```
if (intent.getAction().equals(Intent.ACTION_BOOT_COMPLETED)) {
// Your code
} 
```

# ruby-on-rails-3 - Rspec Controller Passing Params

> ID：10645107
> 
> 赞同：2
> 
> 时间：2012-05-18T00:07:01.213
> 
> 标签：ruby-on-rails-3, rspec, controllers

Below is the problem I am having. I am not sure how to pass the correct params to this controller action.

## The code

```
def get_standards
   @standard_children, @temp = Standard.browse(params[:guid])
   @parent_standard = params[:guid]
   respond_to do |format|
     format.js
   end
end 
```

## The Rspec

```
describe "Get Standards" do
 it "should return correct values" do
   @stateOne = mock_model(Standard, description: "beta")
   Standard.stub!(:browse).and_return(@stateOne, "temp")     
   assigns(:standard_children).should == @stateOne
   assigns(:parent_standard).should == 'one'
   get :get_standards, :params => {guid: 'one'}
 end
end 
```

## The Error

```
 Failure/Error: assigns(:standard_children).should == @stateOne
 expected: #<Standard:0x3ffed4e53d88 @name="Standard_1001">
 got: nil (using ==) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T00:16:33.630

```
describe "Get Standards" do
 it "should return correct values" do
   @stateOne = mock_model(Standard, description: "beta")
   Standard.stub!(:browse).and_return(@stateOne, "temp")     

   get :get_standards, :guid => 'one'
   assigns(:parent_standard).should == 'one' 
   assigns(:standard_children).should == @stateOne             
 end
end 
```

# ruby-on-rails - 将嵌套表单错误消息渲染到不同的控制器

> ID：10645113
> 
> 赞同：1
> 
> 时间：2012-05-18T00:08:20.167
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有票，我有回复。票有很多回复，回复属于票。在我的票/演出页面顶部，我有一个更新一些票参数的票表。开始于

```
= form_for @ticket do |f| 
```

然后自行关闭。这种形式工作正常。

在同一页面上，我创建了一个“回复表单”

```
= form_for [@ticket, @ticket.replies.build] do |f| 
```

然后自行关闭。问题是，如果在回复表单上调用任何活动记录验证，rails 会重定向到带有错误消息的回复控制器，但我需要它重定向到我所在的当前页面。我这辈子都想不通。谷歌搜索，尝试在回复控制器中重新指向渲染无济于事。

欢迎任何帮助。

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:26:53.593

也许远程这样做会解决您的问题并带来一些用户友好性。

如果不是您的选择，请记住您应该`@reply || @ticket.replies.build`在表单中执行，否则如果有错误，它将不会显示在表单中。

渲染不起作用，因为它是一个不同的控制器，所以你有 2 个选项。

1.  在您的工单控制器上创建一个新操作以创建回复并在您的表单中指定它
2.  用于`redirect_to ticket_url(@ticket, @reply)`您的操作，并为此创建路线，它需要一个 :ticket_id 和 :reply_id

# jquery - Jquery Json输出特殊字符问题

> ID：10645119
> 
> 赞同：3
> 
> 时间：2012-05-18T00:10:03.830
> 
> 标签：jquery, special-characters, getjson, json

所以我正在开发一个系统来从网页获取元标记，以获取从链接嵌入的视频的信息（就像 facebook 一样）。

我还得到了页面的标题和描述来预填一些字段。这是我遇到问题的地方，描述工作正常，因为它是一个文本区域，所以我可以使用`.html()`，但标题是一个输入，所以我可以使用`.attr()`或`.val()`问题来自特殊字符，如 (é à è ö ä ü) .

这是我正在使用的代码。

这是我的 Jquery 动作脚本：

```
<script type="text/javascript" charset="utf-8">     
$(function(){
    $("#url").bind("change", function(){
        var url = $("#url").val();
        $.getJSON("/ajax/embed_video.php", { url: url }, function(json) {
            $(json.embed).appendTo("#feeds");
            $("#title").attr("value", json.title);
            $("#description").html(json.description);
         });
    });
});
</script> 
```

这是我用于导出 JSON 数据的 php 文件：

```
$url = $_GET['url'];
$result = getUrlData($url); //this get the metadata from the url
$description = $result['metaTags']['og:description']['value'];
$title = $result['metaTags']['og:title']['value'];

$img_name = basename($result['metaTags']['og:image']['value']);
copy(''.$result['metaTags']['og:image']['value'].'', "../".$path_video_temp.$img_name);

$embed = " "; //EMBED CODE

$data = array('title' => $title,'description' => $description, 'embed' => $embed, 'img' => '/'.$path_video_temp.$img_name);

header('Content-Type: application/json; Charset=UTF-8');
echo json_encode($data); 
```

当我的标题带有任何重音或任何特殊字符时，它会打印出来`&eacute;`等。

我尝试使用`html_entity_decode`和`htmlspecialchars_decode`

我希望有人知道问题出在哪里。

感谢您的宝贵时间，祝您有美好的一天

乔里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:56:46.157

您可以尝试使用 Ajax 请求来检索您的数据，而不是在 Ajax 请求中使用 getjson 您可以指定要检索的数据的字符编码 这是 Ajax 和 getjson 的比较

[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

以下是 Ajax 的设置方式

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

关于此方法的注意事项是 json 请求不是异步的，因此在 Ajax 中将 async 设置为 false

- -编辑 - -

抱歉，设置字符集只能与 jsonp 一起使用，您可以改用它吗？

---编辑2 ---

这个论坛帖子有帮助吗？

[如何使用 jQuery 解码 HTML 实体？](https://stackoverflow.com/questions/1147359/how-to-decode-html-entities-using-jquery)

希望这可以帮助 ！！

# mysql - 如何在 SQL 中为一个表创建索引，以便它可以从多个表中返回满足要求的结果？

> ID：10645121
> 
> 赞同：1
> 
> 时间：2012-05-18T00:10:14.367
> 
> 标签：mysql, sql, database

这是一个来自真实世界 SQL 应用程序问题的示例。我是 SQL 的新用户。

设计一个 (SQL)`SELECT`语句，返回居住在密歇根州的所有非测试帐户的名称列表，并包括它返回的内容。

```
Table: CustomerAcct_tab 

  id    first_name  last_name   address_id  account_type_code
 234    John        Smith       123         A
 342    Mary        Ryan        223         C
 210    Mark        Jackson     398         B
 678    Bill        Monroe      232         C
 789    JoAnne      Hill        300         D

 Table: Address_tab 

  id    State   
 123    MI  
 223    TX  
 398    CA  
 232    MI  
 300    CA  

 Table: AccountType_tab 

 code   is_test_account 
   A    TRUE    
   B    FALSE   
   C    FALSE   
   D    TRUE 
```

我的解决方案：

```
SELECT first_name, Last_name
FROM CustomerAcct_tab
INNER JOIN Address_tab ON CustomerAcct_tab.address_id = Address_tab.id 
INNER JOIN AccountType_tab ON CustomerAcct_tab.account_type_code = AccountType_tab.code 
WHERE is_test_account = FALSE AND Address_tab.State = MI 
```

但是，我认为这可能不正确。

我的同事建议我需要为 CustomerAcct_tab 创建一些索引，否则它是错误的，但我不知道如何以及为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:21:01.337

如果您询问如何以及在何处创建适合此查询的索引，我建议：

```
create index Address_tab_State_index on Address_tab(State);
create index CustomerAcct_tab_address_id_index CustomerAcct_tab(address_id); 
```

并重构查询以按对这些索引最有利的顺序选择表：

```
SELECT first_name, Last_name
FROM Address_tab
JOIN CustomerAcct_tab ON CustomerAcct_tab.address_id = Address_tab.id
JOIN AccountType_tab 
    ON CustomerAcct_tab.account_type_code = AccountType_tab.code 
    AND is_test_account = FALSE
WHERE Address_tab.State = MI 
```

此查询在执行期间尽可能早地过滤掉不匹配的行，从而加入来自后续表的最少行数。

请注意`is_test_account = FALSE`在`ON`子句中而不是在`WHERE`子句中使用条件，从而减少一点执行开销（避免在连接结果中进行过滤）。

另请注意，您可能*已经*定义了一个索引，`CustomerAcct_tab(address_id)`因为它是一个外键列。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-18T00:47:57.687

如果我正确理解您的问题，您的同事指出的问题是 account_type 代码应该是数字而不是字符或字符串。尽管可以将字符串索引为外键，但这并不常见。
这是正确的查询：

```
SELECT first_name, Last_name FROM CustomerAcct_tab

INNER JOIN Address_tab ON CustomerAcct_tab.address_id = Address_tab.id

INNER JOIN AccountType_tab ON CustomerAcct_tab.account_type_code = AccountType_tab.code

WHERE AccountType_tab.code <> 'A' AND Address_tab.State = MI 
```

# php - Smarty插件问题

> ID：10645122
> 
> 赞同：0
> 
> 时间：2012-05-18T00:10:21.273
> 
> 标签：php, iis, smarty

我目前正在使用 php、mysql 和 smarty 使用 IIS 服务器，但我遇到以下错误...

> 警告：include(\boswinfs02\home\users\web\b1811\ez.seonppca2008\includes\smarty\libs\plugins\modifier.capitalize.php) [function.include]: failed to open stream: No such file or directory in \boswinfs02\home\users\web\b1811\ez.seonppca2008\templates\cache\28797abee8c51cc9cd28bdc13b3f002e2a7a578a.file.header.tpl.php 在第 20 行

它在本地服务器上运行良好，但在实时服务器上抛出错误。请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T07:42:01.193

删除文件`boswinfs02\home\users\web\b1811\ez.seonppca2008\templates\cache`夹中的所有文件，而不是使该文件夹可写（777 权限）。

# sql-server-2005 - 选择第 n 个最高分

> ID：10645125
> 
> 赞同：-1
> 
> 时间：2012-05-18T00:10:45.757
> 
> 标签：sql-server-2005, greatest-n-per-group

我有一张桌子：

```
create table marks(stdName nvarchar(30), marks float)
insert into marks
select 'std1', 98
union all select 'std2', 96
union all select 'std3', 95
union all select 'std4', 97
union all select 'std5', 93 
```

我想创建存储过程来选择**第n个最高标记**的行作为给定的输入参数。假设如果输入参数是3，它应该显示'std2'，96或者如果输入参数是5，它应该显示'std5'，93 .

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:44:28.987

您可以使用带有功能的[cte](http://msdn.microsoft.com/en-us/library/ms175972.aspx)[`ROW_NUMBER`](http://msdn.microsoft.com/en-us/library/ms186734.aspx)：

```
WITH cte AS(
    SELECT  stdName
    ,       marks
    ,       ROW_NUMBER()OVER(ORDER BY marks DESC)As MarkRank
    from marks
)
SELECT stdName, marks
FROM cte
WHERE MarkRank = @rank 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-18T08:23:07.527

我已经解决了这个问题。感谢蒂姆的帮助。我对存储过程有点困惑。

```
create procedure showmarks
(@rank int)
as
    begin

WITH cte AS(
    SELECT  stdName
    ,       marks
    ,       ROW_NUMBER()OVER(ORDER BY marks DESC)As MarkRank
    from marks
)
SELECT stdName, marks
FROM cte
WHERE MarkRank = @rank
end 
```

# flash - Flex 4.6 TabbedViewNavigator应用程序导航器

> ID：10645129
> 
> 赞同：1
> 
> 时间：2012-05-18T00:11:05.203
> 
> 标签：flash, apache-flex, mobile, flex4.6

我是使用 Flex 进行移动开发的新手，有一条基本信息我找不到答案。

我的主要应用程序扩展了这个`<s:TabbedViewNavigatorApplication>`类。对于其他应用程序类，例如`<s:ViewNavigatorApplication>`，我可以执行以下操作来在`<s:View>`组件之间进行转换：

```
private function nextView(e:MouseEvent):void {
    navigator.pushView(package.component);
} 
```

但是，`<s:TabbedViewNavigatorApplication>`不会`navigator`像其他基类那样自动实例化。

有人可以提供一个简单的例子来说明如何从 a 中推送和弹出视图`<s:TabbedViewNavigatorApplication>`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T07:38:06.583

TabbedViewNavigatorApplication 每个选项卡包含一个 ViewNavigator，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<s:TabbedViewNavigatorApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
xmlns:s="library://ns.adobe.com/flex/spark">

<s:navigators>
    <s:ViewNavigator label="News" firstView="views.NewsView"/>
    <s:ViewNavigator label="Friends" firstView="views.FriendsView"/>
    <s:ViewNavigator label="Events" firstView="views.EventsView"/>
</s:navigators> 
```

每个 ViewNavigator 都维护自己的导航堆栈。ViewNavigator 方法 pushView() 和 popView() 作用于当前选定的 ViewNavigator。这些方法从选定选项卡的堆栈中添加/删除，而不是 TabbedViewNavigatorApplication。

同样，后退按钮在单个选项卡的堆栈中导航。它不会选择另一个选项卡。

*您可以通过将 TabbedViewNavigator.selectedIndex 属性设置为所需 ViewNavigator 的索引来在 ViewNavigator之间*导航（即选项卡之间），其中 0 是第一个部分（第一个选项卡），1 是第二个，等等。例如：

```
TabbedViewNavigator.selectedIndex = 2 
```

选择第三个选项卡（和第三个 ViewNavigator 堆栈）。

[您可以在Adob​​e 帮助页面](http://help.adobe.com/en_US/flex/mobileapps/WS77c1dbb1bd80d383527e1a6412a8a5d909a-8000.html)上阅读有关 TabbedViewNavigatorApplication 的更多信息。

# sql - SQL：按子句排序的case语句

> ID：10645131
> 
> 赞同：3
> 
> 时间：2012-05-18T00:11:12.207
> 
> 标签：sql, sql-server, sql-order-by, case

[http://msdn.microsoft.com/en-us/library/ms181765.aspx](http://msdn.microsoft.com/en-us/library/ms181765.aspx)

我从上面的链接看到下面的 sql：

```
SELECT BusinessEntityID, SalariedFlag
FROM HumanResources.Employee
ORDER BY CASE SalariedFlag WHEN 1 THEN BusinessEntityID END DESC
    ,CASE WHEN SalariedFlag = 0 THEN BusinessEntityID END;
GO 
```

这是我得到的一个结果：

> 业务实体 ID、SaliedFlag
> 
> 7,1
> 
> 5,1
> 
> 3,1
> 
> 1,1
> 
> 2,0
> 
> 4,0
> 
> 6,0
> 
> 8,0

谁能解释为什么具有相同 salariedFlag 的记录彼此相邻以及为什么 salariedFlag=1 块高于 salariedFlag=0 块？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T00:29:57.430

sort 子句等价于以下，可能会稍微明显一些：

```
ORDER BY CASE SalariedFlag WHEN 1 THEN BusinessEntityID ELSE null END DESC
        ,CASE WHEN SalariedFlag = 0 THEN BusinessEntityID ELSE null END; 
```

因此，当 SalariedFlag = 1 或 null 时，第一个排序字段是 BusinessEntityID。
这会将 SalariedFlag = 0 的所有行组合在一起，因为它们都有一个空的第一个排序字段。
SalariedFlag = 1 的行将按 BusinessEntityID 排序。看起来空值按降序排列在最后，所以所有 SalariedFlag != 1 排在最后。

这是主要排序，对于次要排序，发生的情况大致相同：
SalriedFlag = 0 的所有行都将按 BusinessEntityID 排序。由于它们的主要排序字段全部为空，它们最终将按 BusinessEntityID 排序。

并且 SalariedFlag != 0 的所有行将与 null 二级排序组合在一起。如果这些行的 SalariedFlag = 1，那么它们已经按主排序进行了排序。

如果 SalariedFlag 只能是 0 或 1，那么这种排序可以（稍微）简化为：

```
ORDER BY CASE SalariedFlag WHEN 1 THEN BusinessEntityID END DESC
        , BusinessEntityID; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T01:26:41.677

通过在 SELECT 子句中包含 CASE WHEN 条件，您可以轻松地想象它为什么以这种方式排序：

```
SELECT BusinessEntityID, SalariedFlag,

CASE SalariedFlag WHEN 1 THEN BusinessEntityID END AS A,
CASE WHEN SalariedFlag = 0 THEN BusinessEntityID END AS B

FROM Employee
ORDER BY CASE SalariedFlag WHEN 1 THEN BusinessEntityID END DESC
    ,CASE WHEN SalariedFlag = 0 THEN BusinessEntityID END; 
```

输出：

```
BUSINESSENTITYID  SALARIEDFLAG      A                 B
7                 1                 7                 (null)
5                 1                 5                 (null)
3                 1                 3                 (null)
1                 1                 1                 (null)
2                 0                 (null)            2
4                 0                 (null)            4
6                 0                 (null)            6
8                 0                 (null)            8 
```

SalariedFlag 0 保持在一起的原因是它们都落在 null 下（查看 A 列），如果 SalariedFlag 有另一个值，比如数字 2，那将是完全不同的事情，并且该查询将不再起作用，那些具有相同的flag 不一定彼此相邻。

NULL 先排序，如果指定DESC，则最后排序。

现场测试：[http ://www.sqlfiddle.com/#!3/1b849/13](http://www.sqlfiddle.com/#!3/1b849/13)

* * *

认识到查询的 CASE WHEN 的 THEN 使用的是整数类型的 BusinessEntityID，您可以执行以下查询以达到相同的效果；并且由于它使用 SalariedFlag 作为分隔符，因此以下查询***可能***会更快，因为您没有在 ORDER BY 上使用条件。您可以切换 SalriedFlag 并对其进行排序：

```
-- just to visualize things up
SELECT BusinessEntityID, SalariedFlag,

    A = BusinessEntityID * SalariedFlag,
    B = BusinessEntityID * (SalariedFlag ^ 1) 

FROM Employee
ORDER BY A DESC, B 

-- in actual you do this:

SELECT BusinessEntityID, SalariedFlag

FROM Employee
ORDER BY BusinessEntityID * SalariedFlag DESC, BusinessEntityID * (SalariedFlag ^ 1) 
```

鉴于此数据：

```
CREATE TABLE [Employee]
    ([BusinessEntityID] int, [SalariedFlag] int);

INSERT INTO [Employee]
    ([BusinessEntityID], [SalariedFlag])
VALUES
    (10, 1),
    (5, 1),
    (9, 1),
    (1, 1),
    (2, 0),
    (7, 0),
    (6, 0),
    (8, 0); 
```

这是输出：

```
BUSINESSENTITYID  SALARIEDFLAG      A                 B
10                1                 10                0
9                 1                 9                 0
5                 1                 5                 0
1                 1                 1                 0
2                 0                 0                 2
6                 0                 0                 6
7                 0                 0                 7
8                 0                 0                 8 
```

现场测试：[http ://www.sqlfiddle.com/#!3/e65ac/2](http://www.sqlfiddle.com/#!3/e65ac/2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T00:29:38.220

您首先`BusinessEntityID`在标志时订购`1`，然后`BusinessEntityID`在标志时解决关系`0`。这是因为第一个`CASE`表达式的计算结果为`null`when `SalariedFlag`is not `1`，因此所有带有 标志的记录`0`都被移到带有 标志的记录之后`1`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T00:21:28.273

尝试在您选择的值列表中包含 case 语句。它应该有助于澄清排序实际发生在哪些值上。

# web-services - RESTful API：仅用于验证的 METHOD/HEADER 组合

> ID：10645133
> 
> 赞同：8
> 
> 时间：2012-05-18T00:11:40.213
> 
> 标签：web-services, api, rest

我希望我的 API 有一个仅验证请求。例如，如果我有一个 URL，例如：

```
http://api.somesite.com/users/12345 
```

并且用户正在填写关于客户端的信息表格，我最终将 PATCH/PUT/POST 到该资源。当用户填写表格时，我可能希望定期将他们部分完成的更新表示发送到服务器，以便我可以显示他们输入的实时验证（例如，“那个用户名已经被占用”，“那个密码是太短”）。

似乎没有标准的 HTTP METHOD 或 HEADER 允许在同一资源上进行此行为。看来我的选择是：

1.  创建新的从属资源进行验证
2.  使用自定义标头（仅限 x-somesite-validation）和 PUT 指示我要验证但不保存

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T01:39:33.013

一些选项

1) 使用自定义标头
2) 在查询字符串中放入一些内容，指示仅验证
3) 使用 Action URl 例如 \IndividualClient\123\actions\Validate\Invoke {此处为第 19 节[http://restfulobjects.files.wordpress.com/2011 /11/restful-objects-spec-052.pdf](http://restfulobjects.files.wordpress.com/2011/11/restful-objects-spec-052.pdf) }
4) 分层 URL 例如 \IndividualClient\123\Validation

从这篇[文章中](https://stackoverflow.com/questions/1619152/how-to-create-rest-urls-without-verbs)我找到了这个建议

> 每当你必须做一些感觉像 RPC 的事情时使用 POST 使用 GET 进行计算等事情，除非你的输入很大，在这种情况下使用 POST
> 
> 关于您的具体问题，POST 应该用于#4 和#5。这些操作属于上述“类 RPC”指南。对于 #5，请记住 POST 不一定必须 > 使用 Content-Type: application/x-www-form-urlencoded。这可以很容易地成为 JSON 或 CSV >payload。

这是我正在考虑的：

这是资源的添加：
用户/验证
POST
请求：用户资源
响应：验证结果
响应代码200、400、404、500

这是资源
user/204/validation
POST
Request:UserResource,
Response:ValidationResult Response Codes 200, 400\. 404\. 500的更新

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T00:30:24.147

第三个选项是在客户端上实现验证功能。然后，此函数将在需要特定信息时发送特定请求。

例如，您实际上不需要发送请求来检查密码是否太短。但是您可以发送一个请求来检查用户名是否存在。

这就是使用 Ajax 进行验证的方式，顺便说一句，它使用的是 Restful API (HTTP):)

# python - Python：调用'curses'两次塞满我的终端

> ID：10645135
> 
> 赞同：2
> 
> 时间：2012-05-18T00:11:54.953
> 
> 标签：python, terminal, curses

我`curses`在终端游戏（Mac OSX，Python 2.6.5）中使用拼图。这个谜题涉及旋转一些表盘来打开锁。我的代码，有些简化（请原谅丑陋）：

```
import curses

dial = ["| -1  |","|-1/3 |","|  0  |","| 1/2 |","| 2/3 |","|  1  |"]

clear = "       "
pointer = "   ^   "
subdials = [clear,clear]

d = {'d0':{},'d1':{}}
d['d0'] = {'val':2,'disp':dial[2]}
d['d1'] = {'val':2,'disp':dial[2]}

def spin(scr):
    try:
        curses.curs_set(0)
    except:
        pass

    solved = 0
    p = 0
    subdials[p] = pointer
    dials = [d['d0']['disp'],d['d1']['disp']]

    maxy,maxx = scr.getmaxyx()

    newscr = scr.subwin(10,51,maxy-15,0)
    newscr.box(ord('|'),ord('-'))
    newscr.addstr(4,8,''.join(dials))
    newscr.addstr(6,8,''.join(subdials))
    newscr.refresh()

    while solved == 0:
        r = scr.getch()
        subdials[p] = clear
        currd = 'd'+str(p)

        if r == ord('q') or r == ord('Q'):
            break
        elif r == curses.KEY_LEFT:
            if p > 0 and p < 2:
                p -= 1
            else: pass
        elif r == curses.KEY_RIGHT:
            if p >= 0 and p < 1:
                p += 1
            else: pass
        elif r == curses.KEY_UP:
            if d[currd]['val'] >= 0 and d[currd]['val'] < 5:
                d[currd]['val'] += 1
                d[currd]['disp'] = dial[d[currd]['val']]
            else: pass
        elif r == curses.KEY_DOWN:
            if d[currd]['val'] > 0 and d[currd]['val'] <= 5:
                d[currd]['val'] -= 1
                d[currd]['disp'] = dial[d[currd]['val']]
            else: pass
        else: pass

        subdials[p] = pointer
        dials = [d['d0']['disp'],d['d1']['disp']]

        newscr.addstr(4,8,''.join(dials))
        newscr.addstr(6,8,''.join(subdials))
        newscr.refresh()

        if d['d0']['val'] == 5 and d['d1']['val'] == 3:
            solved = 1

    if solved == 0:
        scr.addstr(maxy-1,0,"You can't figure out the lock.")
    else:
        scr.addstr(maxy-1,0,"The lock is open!")
    scr.getch()
    scr.clear()
    return solved

def box():
    solved = curses.wrapper(spin)
    return solved 
```

退出“盒子”功能有两种方式：按“q”退出，或解谜。第一次退出诅咒（无论哪种方式）都没有问题。但是，如果我再次调用“box”，很快就会出现问题。

首先，在 curses 窗口中，我的函数被指示输入的任何键输入`pass`都会回显到屏幕上。其次，更糟糕的是，当你第二次退出谜题时——无论是退出还是获胜——`noecho`并且`cbreak`没有关闭，所以我的终端被塞满了，必须重新设置。

（注意：如果我继续调用“box”，则键盘输入不再在 curses 窗口本身中回显，但我的终端不会恢复正常。）

我一生都无法弄清楚导致这种行为的原因。帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T09:39:10.260

我将 Python 更新到 2.7.3，问题就消失了。嘘！

# android - 在android中实现数据库服务和活动的最佳方式？

> ID：10645136
> 
> 赞同：0
> 
> 时间：2012-05-18T00:12:23.413
> 
> 标签：android, database, sqlite, service

我基本上是在创建其中一个应用程序，您可以在其中设置对特定 SMS 的自动响应。这听起来很简单，但这里的问题是我正在将所有接收和发送的消息记录到数据库中。我有一张关于应用程序应该回复的数字的数据/设置表。将联系人添加到此表时，还会创建一个新表（用于传入和传出消息）。

我需要一个 BroadcastReceiver 来启动一个 Intent，然后服务就完成了。我被卡住的部分是用户单击应用程序以更改设置，将联系人添加/删除到列表中，并查看记录的消息，所以我不知道该采取什么方法。我是否应该有 2 个服务，一个在 SQLite 数据库上工作，另一个在回复？这两个可以连接吗？

另一个问题是，如果该人当前在应用程序中查看日志，我需要做什么才能更新日志视图？

另外，我在标题中说“活动”，因为应用程序中的第一个屏幕是所有已激活联系人的列表视图，然后创建一个新活动，其中另一个列表视图由所选联系人的日志填充。

组织所有这些的最佳方式是什么？我不要求代码或任何东西，但一些图表或 UML'ish 类型的图纸会有所帮助。

谢谢

# haskell - Haskell：非具体类型的 Num 实例

> ID：10645137
> 
> 赞同：1
> 
> 时间：2012-05-18T00:12:24.773
> 
> 标签：haskell, types, instance, typeclass

```
data Vector a = Vector a a a deriving (Eq, Show)

instance Functor Vector where
    fmap f (Vector x y z) = Vector (f x) (f y) (f z) 
```

到现在为止还挺好。

```
instance Num ((Num a) => Vector a) where
    negate = fmap negate 
```

不工作。我在第一行尝试了许多不同的变体，但 GHC 一直在抱怨。我想让*一个`Vector`包含数字*的实例成为`Num`; 当然这应该是可能的？否则我将不得不为`Int`, `Integer`, `Float`,`Double`等创建一个实例，所有这些都具有相同的定义。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T00:14:08.683

```
instance Num a => Num (Vector a) where
   negate = fmap negate 
```

考虑编写其他方法。

`deriving (Eq, Show, Functor)`（打开就可以写了`-XDeriveFunctor`。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T19:09:35.193

创建. `Vector`_ `Num`这是 的声明`Num`：

```
class Num a where
  (+) :: a -> a -> a
  (*) :: a -> a -> a
  (-) :: a -> a -> a
  negate :: a -> a
  abs :: a -> a
  signum :: a -> a
  fromInteger :: Integer -> a 
```

`+`和`-`和`negate`都没有问题。可以定义`*`为叉积，但仅限于 3 向量，这真的是在拉伸它。`abs`，`signum`并且`fromInteger`没有有意义的定义。

简而言之，可以硬塞`Vector`进去`Num`，但结果并不好。

您可能想要探索替代标准 Prelude 的替代类型类层次结构，例如[Numeric prelude](http://www.haskell.org/haskellwiki/Numeric_Prelude)。

# c# - 将 SQL 语句转换为 LINQ VS2010

> ID：10645139
> 
> 赞同：0
> 
> 时间：2012-05-18T00:13:12.820
> 
> 标签：c#, sql-server-2008, visual-studio-2010, linqer

我将不胜感激将以下 sql 语句转换为 linq 的帮助：

```
select *
from (
    select 
        *,
        rn = row_number() over (partition by ClientId order by VisitId)
    from
        Visit
) activityWithRn
inner join vw_MasterView on  vw_MasterView.VisitId = activityWithRn.VisitId
where activityWithRn.rn =3 
```

当我使用 Linqer（一个很棒的程序）时，我收到以下错误：

```
SQL cannot be converted to LINQ: Field [rn = row_number() over (partition by ClientId order by VisitId)] not found in the current Data Context. 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:45:19.047

我认为 LINQ 中没有任何相应的功能`row_number() over`，除了使用`Skip...Take`：

```
var q = (from v in Visit
            join mv in vw_MasterView on v.VisitId equals mv.VisitId 
            orderby v.VisitId
            select v).Skip(2).Take(1); 
```

# php - 循环结果显示在循环外

> ID：10645142
> 
> 赞同：0
> 
> 时间：2012-05-18T00:13:20.633
> 
> 标签：php

我试图让我的结果显示在循环内部，但由于某种原因，当我创建我的 = a = 并在最后添加 .$_str 时，它会一直显示在我的循环之外。但是，如果我将 .= 用于我的 = 并从字符串末尾删除 .$_str ，则它会显示在我的循环内部，但不会反转 foreach 循环的输出，这是我试图实现的平均目标。

我已经评论了我遇到问题的区域。请随意注释掉任何一行来测试，看看我在说什么，代码已经准备好进行测试了。

```
 <script type='text/javascript' src='http://www.google.com/jsapi'></script>
        <?php
        $file = file_get_contents("http://ichart.finance.yahoo.com/table.csv?s=GOOG&a=03&b=18&c=2004&d=04&e=17&f=2012&g=d&ignore=.csv");

            $stockcontent = str_replace('Date,Open,High,Low,Close,Volume,Adj Close', '',  $file);
            $stockcontent = trim($stockcontent);

            $stockcontentex = str_getcsv($stockcontent, "\n");

            $i = 0;
            $j = 0;

            $_str = '';  
            $_str .= "<script type='text/javascript'>
              google.load('visualization', '1', {'packages':['annotatedtimeline']});
              google.setOnLoadCallback(drawChart);
              function drawChart() {
                var data = new google.visualization.DataTable();
                data.addColumn('date', 'Date');
                data.addColumn('number', 'High');
                data.addColumn('number', 'Low');
                data.addRows([";
            foreach($stockcontentex as $stockexplode){
                $stockex = explode(',',$stockcontentex[$i++]);
                $stockexdate = explode('-', $stockex[0]);
                $stockYear = $stockexdate[0];
                $stockMonth = $stockexdate[1];
                $stockDay = $stockexdate[2];
                $stockHigh = $stockex[2];
                $stockLow = $stockex[3];

    //right here is where I am having the problem.
$_str = '[new Date('.$stockYear.', '.$stockMonth.', '.$stockDay.'), '.$stockHigh.', '.$stockLow.'],'. "\n".$_str;

    //$_str .= '[new Date('.$stockYear.', '.$stockMonth.', '.$stockDay.'), '.$stockHigh.', '.$stockLow.'],'. "\n";

                }

              $_str .= "]);

                var chart = new google.visualization.AnnotatedTimeLine(document.getElementById('chart_div'));
                chart.draw(data, {displayAnnotations: false});
              }
            </script>
            <div id='chart_div' style='width: 700px; height: 240px;'></div>";

                echo $_str;
        ?> 
```

感谢任何可以帮助我的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:33:51.823

```
 <script type='text/javascript' src='http://www.google.com/jsapi'></script>
    <?php
    $file = file_get_contents("http://ichart.finance.yahoo.com/table.csv?s=GOOG&a=03&b=18&c=2004&d=04&e=17&f=2012&g=d&ignore=.csv");

        $stockcontent = str_replace('Date,Open,High,Low,Close,Volume,Adj Close', '',  $file);
        $stockcontent = trim($stockcontent);

        $stockcontentex = str_getcsv($stockcontent, "\n");

        $i = 0;
        $j = 0;

        $_str = '';  
        $_str .= "<script type='text/javascript'>
          google.load('visualization', '1', {'packages':['annotatedtimeline']});
          google.setOnLoadCallback(drawChart);
          function drawChart() {
            var data = new google.visualization.DataTable();
            data.addColumn('date', 'Date');
            data.addColumn('number', 'High');
            data.addColumn('number', 'Low');
            data.addRows([";

        $tstr = "";
        foreach($stockcontentex as $stockexplode){
            $stockex = explode(',',$stockexplode); // no need to do this $stockcontentex[$i++]); here
            $stockexdate = explode('-', $stockex[0]);
            $stockYear = $stockexdate[0];
            $stockMonth = $stockexdate[1];
            $stockDay = $stockexdate[2];
            $stockHigh = $stockex[2];
            $stockLow = $stockex[3];

            //right here is where I am having the problem.
            $tstr = '[new Date('.$stockYear.', '.$stockMonth.', '.$stockDay.'), '.$stockHigh.', '.$stockLow.'],'. "\n".$tstr;

            }
         $_str = $_str.$tstr; // $x .= $xx; is just a shotcut for $x = $x.$xx;
         $_str .= "]); 

         var chart = new google.visualization.AnnotatedTimeLine(document.getElementById('chart_div'));
            chart.draw(data, {displayAnnotations: false});
          }
        </script>
        <div id='chart_div' style='width: 700px; height: 240px;'></div>";

        echo $_str;
    ?> 
```

# c# - WebBrowserControl：访问 Frame 的属性时出现 UnauthorizedAccessException

> ID：10645143
> 
> 赞同：6
> 
> 时间：2012-05-18T00:13:39.290
> 
> 标签：c#, .net, vb.net

我使用默认的 WebBrowser 控件在 C# 中编写了一个非常小的网站机器人。实际上，几乎所有东西都按照它应该的方式工作，但我似乎在自动化的最后一步遇到了问题。

该网站是使用多个 iframe 构建的。这没什么大不了的，因为我只是使用访问这些框架及其元素

```
webBrowser1.Document.Window.Frames[0].Document.GetElementById("element").InvokeMember("click"); 
```

但是，当 IFRAME 的源托管在与实际网站不同的域上时，这**不起作用。**当我在互联网上搜索我的问题的答案时，我偶然发现了一篇提到这个特定问题的 MSDN 文章，他们指的是针对跨站点脚本的安全措施，这可能是导致此错误的原因。

我真的找不到禁用此功能的方法，所以我继续并决定重新编码所有内容以使用 geckofx-12 而不是默认（基于 IE）的 Web 浏览器控件，但我遇到了类似的问题......

**我的问题是：**有什么办法可以绕过这种烦人的行为？我并不真正关心安全问题或是否正在使用 geckofx 或默认 Web 浏览器控件，我只想以编程方式访问托管在不同域上的站点的元素，而*不会*遇到 UnauthorizedAccessException。

我很想从那里的大师那里得到建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-02T11:06:08.800

您无法访问来自不同域的帧。这是一个安全功能。有一个小技巧：

```
 public class CrossFrameIE
{
    // Returns null in case of failure.
    public static IHTMLDocument2 GetDocumentFromWindow(IHTMLWindow2 htmlWindow)
    {
        if (htmlWindow == null)
        {
            return null;
        }

        // First try the usual way to get the document.
        try
        {
            IHTMLDocument2 doc = htmlWindow.document;                

            return doc;
        }
        catch (COMException comEx)
        {
            // I think COMException won't be ever fired but just to be sure ...
            if (comEx.ErrorCode != E_ACCESSDENIED)
            {
                return null;
            }
        }
        catch (System.UnauthorizedAccessException)
        {
        }
        catch
        {
            // Any other error.
            return null;
        }

        // At this point the error was E_ACCESSDENIED because the frame contains a document from another domain.
        // IE tries to prevent a cross frame scripting security issue.
        try
        {
            // Convert IHTMLWindow2 to IWebBrowser2 using IServiceProvider.
            IServiceProvider sp = (IServiceProvider)htmlWindow;

            // Use IServiceProvider.QueryService to get IWebBrowser2 object.
            Object brws = null;
            sp.QueryService(ref IID_IWebBrowserApp, ref IID_IWebBrowser2, out brws);

            // Get the document from IWebBrowser2.
            IWebBrowser2 browser = (IWebBrowser2)(brws);

            return (IHTMLDocument2)browser.Document;
        }
        catch
        {
        }

        return null;
    }

    private const int E_ACCESSDENIED = unchecked((int)0x80070005L);
    private static Guid IID_IWebBrowserApp = new Guid("0002DF05-0000-0000-C000-000000000046");
    private static Guid IID_IWebBrowser2 = new Guid("D30C1661-CDAF-11D0-8A3E-00C04FC9E26E");
}

// This is the COM IServiceProvider interface, not System.IServiceProvider .Net interface!
[ComImport(), ComVisible(true), Guid("6D5140C1-7436-11CE-8034-00AA006009FA"),
InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIUnknown)]
public interface IServiceProvider
{
    [return: MarshalAs(UnmanagedType.I4)]
    [PreserveSig]
    int QueryService(ref Guid guidService, ref Guid riid, [MarshalAs(UnmanagedType.Interface)] out object ppvObject);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-01-14T22:02:25.073

我更新了 Daniel Bogdan 稍微发布的 hack 以使用扩展方法，并为您提供了一种无需进入 mshtml 命名空间即可调用它的方法：

```
using mshtml;
using SHDocVw;
using System;
using System.Reflection;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace TradeAutomation
{
    public static class CrossFrameIE
    {
        private static FieldInfo ShimManager = typeof(HtmlWindow).GetField("shimManager", BindingFlags.NonPublic | BindingFlags.Instance);
        private static ConstructorInfo HtmlDocumentCtor = typeof(HtmlDocument).GetConstructors(BindingFlags.NonPublic | BindingFlags.Instance)[0];

        public static HtmlDocument GetDocument(this HtmlWindow window)
        {
            var rawDocument = (window.DomWindow as IHTMLWindow2).GetDocumentFromWindow();

            var shimManager = ShimManager.GetValue(window);

            var htmlDocument = HtmlDocumentCtor
                .Invoke(new[] { shimManager, rawDocument }) as HtmlDocument;

            return htmlDocument;
        }

        // Returns null in case of failure.
        public static IHTMLDocument2 GetDocumentFromWindow(this IHTMLWindow2 htmlWindow)
        {
            if (htmlWindow == null)
            {
                return null;
            }

            // First try the usual way to get the document.
            try
            {
                IHTMLDocument2 doc = htmlWindow.document;

                return doc;
            }
            catch (COMException comEx)
            {
                // I think COMException won't be ever fired but just to be sure ...
                if (comEx.ErrorCode != E_ACCESSDENIED)
                {
                    return null;
                }
            }
            catch (System.UnauthorizedAccessException)
            {
            }
            catch
            {
                // Any other error.
                return null;
            }

            // At this point the error was E_ACCESSDENIED because the frame contains a document from another domain.
            // IE tries to prevent a cross frame scripting security issue.
            try
            {
                // Convert IHTMLWindow2 to IWebBrowser2 using IServiceProvider.
                IServiceProvider sp = (IServiceProvider)htmlWindow;

                // Use IServiceProvider.QueryService to get IWebBrowser2 object.
                Object brws = null;
                sp.QueryService(ref IID_IWebBrowserApp, ref IID_IWebBrowser2, out brws);

                // Get the document from IWebBrowser2.
                IWebBrowser2 browser = (IWebBrowser2)(brws);

                return (IHTMLDocument2)browser.Document;
            }
            catch
            {
            }

            return null;
        }

        private const int E_ACCESSDENIED = unchecked((int)0x80070005L);
        private static Guid IID_IWebBrowserApp = new Guid("0002DF05-0000-0000-C000-000000000046");
        private static Guid IID_IWebBrowser2 = new Guid("D30C1661-CDAF-11D0-8A3E-00C04FC9E26E");
    }

    // This is the COM IServiceProvider interface, not System.IServiceProvider .Net interface!
    [ComImport(), ComVisible(true), Guid("6D5140C1-7436-11CE-8034-00AA006009FA"),
    InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIUnknown)]
    public interface IServiceProvider
    {
        [return: MarshalAs(UnmanagedType.I4)]
        [PreserveSig]
        int QueryService(ref Guid guidService, ref Guid riid, [MarshalAs(UnmanagedType.Interface)] out object ppvObject);
    }
} 
```

用法：

```
webBrowser1.Document.Window.Frames["main"].GetDocument(); 
```

正如我在上面的评论中提到的，您还需要添加对 SHDocVw 的引用。您可以在此处找到相关说明：[使用 Visual C# 2010 Express 在 C# 项目中添加参考“SHDocVw”](https://stackoverflow.com/questions/20845140/add-reference-shdocvw-in-c-sharp-project-using-visual-c-sharp-2010-express)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T03:23:48.710

我没有尝试过，但[更改文档域](http://madskristensen.net/post/iframe-cross-domain-javascript-calls)显然有效。

使用 geckofx 12 看起来这可能由 nsIDOMHTMLDocument.SetDomainAttribute 完成（GeckoDocument.Domain 没有设置器，但您可以轻松添加它）

`IE`. 如果您更改文档的域以匹配子框架，您可能能够访问它。

# ruby-on-rails-3 - Rails 3/Ruby 1.9.3 使用 Array#collect

> ID：10645147
> 
> 赞同：0
> 
> 时间：2012-05-18T00:14:32.893
> 
> 标签：ruby-on-rails-3, arraycollection

我的 Order 模型中有以下范围：

```
scope :trial_almost_up, lambda { where :date_finished => 27.days.ago.midnight..27.days.ago.end_of_day } 
```

每个订单都与一个用户相关联。因此，如果您运行 Order.trial_almost_up 并获取订单数组并运行以下命令：

```
o = Order.trial_almost_up
o.collect &:user 
```

collect 为与用户绑定的每个 Order 运行单独的 SQL 语句。

```
User Load (0.6ms)  SELECT `users`.* FROM `users` WHERE `users`.`id` = 11244 LIMIT 1
  User Load (0.3ms)  SELECT `users`.* FROM `users` WHERE `users`.`id` = 1970 LIMIT 1 
```

有没有办法把它组合成一个电话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T00:45:40.483

你可以这样做。我不知道是否有更好的方法，但这是我现在唯一能想到的方法。

```
User.includes(:orders).where("orders.date_finished" => 27.days.ago.midnight..27.days.ago.end_of_day) 
```

让我知道它是否有效，如果我找到更好的东西，我会编辑它

# bash - 将文件中的空行作为参数传递给 bash 脚本

> ID：10645149
> 
> 赞同：1
> 
> 时间：2012-05-18T00:14:37.340
> 
> 标签：bash, shell

如何将文件中的空行作为参数传递给另一个脚本中的 bash 脚本？

这是详细信息。脚本栏从输入文件中读取行，将它们存储在一个数组中，并将数组元素作为选项和/或参数传递给脚本 foo。输入文件看起来像这样：

```
-l file1
dirA

-c
-lc file2
file2

-cd file3
file4 
```

（等等）这就是发生的事情。脚本栏逐行读取文件并正确创建数组，包括空行的两个空元素。（我已经通过回显每个数组元素来检查这一点。）但是当 bar 在循环中遍历数组并将每个元素传递给脚本 foo 时，两个空元素被跳过。因此，脚本 foo 应该使用零参数和零选项调用的情况根本不会发生。脚本 foo 的所有其他运行都按预期运行。

我认为问题可能是因为输入文件除了换行符之外什么都没有，也许数组中的那些元素只是 null 而不是包含空字符串。所以我尝试在输入文件的“空白”行中放置空格，看看是否会有所不同，但结果是一样的。

当输入文件有一个空行，或者至少有一个只有空白字符的行时，我需要做什么才能让 bar 正确调用没有参数和选项的 foo？

我希望这个问题很清楚。谢谢你的帮助！

编辑。有人建议我发布脚本，所以这里是相关部分：

```
# read in input lines from file, add to array
index=0
while read line 
do
tests[index]=$line
(( index++ ))
done < $@

# run tests
for stuff in ${tests[@]}
do  
foo ${stuff} > /dev/null 2>&1
    # capture and process the exit status of each foo run
done 
```

我知道这看起来好像我没有设置 IFS。那是因为这只是我脚本的一部分。我很确定问题出在某个地方；该数组确实使用带有空行的两个元素正确构建，但这些元素在`for ... in`循环中被跳过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:33:30.083

如果在需要的地方添加双引号，它应该可以工作。（我只是在猜测，因为你没有展示你如何迭代这些行）。

```
#! /bin/bash
switches=('-n a'
    '-e "b\nc"'
    ''
    x)
for s in "${switches[@]}" ; do
    echo $s
done 
```

# android - Android - NDK/ARM：浮动参数大小

> ID：10645150
> 
> 赞同：1
> 
> 时间：2012-05-18T00:14:38.607
> 
> 标签：android, java-native-interface, arm

我尝试编写一个简单的 ARM 函数来添加两个数字（单精度）。这是代码的一部分：

```
fmsr s1, r0
fmsr s2, r1
fadds s1, s1, s2
fmrs r0, s1 
```

我使用 NDK 在 Android 中测试了这个 ARM 功能。C函数的原型是：

```
jfloat myFunction(jfloat a, jfloat b); 
```

问题是结果不正确。

我使用了调试器（DS-5），似乎我作为参数传递的两个数字（浮点数 a 和 b）被编码为 64 位而不是 32 位。因此，**a**的值存储在**r0 和 r1中，** **b**的值存储在**r2 和 r3**中。

您有解决问题的任何解释或提示吗？

我已经使用 Win32 函数（Windows Mobile 设备）测试了代码，一切都符合我的预期。

先感谢您！

# php - 如何在卸载前保存鼠标坐标？

> ID：10645151
> 
> 赞同：3
> 
> 时间：2012-05-18T00:14:49.290
> 
> 标签：php, javascript, jquery

我可以用这个动态跟踪鼠标坐标

```
$(document).ready(function()
{
  $().mousemove(function(e)
{
 $('p').html("X Axis : " + e.pageX + " | Y Axis " + e.pageY);
});
}); 
```

这样，每次鼠标移动时数字都会动态变化。我想要做的是保存所有坐标。它应该在卸载前保存它。如何保存所有号码？我正在考虑在 onbeforeunload 上附加一个 iframe，例如

save.php?coords=162x412-143x716-678x12

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T00:22:27.507

试试这个方法...

一种将这些坐标保存在隐藏变量中并在事件“onbeforeunload”上调用该隐藏变量值以获取它们并保存必要的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T00:26:02.423

尝试这样的事情

```
var moves = [];
$().mousemove(function(e){
    moves.push(e.pageX + "x" + e.pageY) 
}); 
```

然后

```
window.onbeforeunload = function() {
    $.post( your_url , moves.join('-'));
} 
```

# clojure - 在实现 Clojure 协议时，重载的方法可以调用其重载的对应物吗？

> ID：10645155
> 
> 赞同：3
> 
> 时间：2012-05-18T00:15:36.450
> 
> 标签：clojure

这是重载协议定义的一部分：

```
(defprotocol ClientProtocol
  (create-edge
    [this outV label inV] 
    [this outV label inV data]) 
```

这是其实现的一部分：

```
(ns bulbs.neo4jserver.client
  (:use [bulbs.base.client :only [ClientProtocol]]))

(deftype Neo4jClient [ns config]
  ClientProtocol

  (create-edge
    [this outV label inV data]
    (let [inV-uri (utils/normalize-uri (build-path neo4j-uri vertex-path inV))
          path (build-path vertex-path, outV, "relationships")
          params {:to inV-uri, :type label, :data (first data)}]
      (post config path params)))

  (create-edge
    [this outV label inV]
    ;; it doesn't like this call...
    (create-edge this outV label inV nil)) 
```

当第二种方法尝试调用第一种方法时，它会发出此错误：

```
java.lang.RuntimeException: Unable to resolve symbol: create-edge in this context 
```

当我使用第一个函数编译它然后返回并添加第二个函数时，我在 SLIME 中的两个定义都在早期工作。

但是当我将协议定义移动到一个单独的文件中并尝试重新编译整个东西时，当第二种方法尝试调用第一种方法时，它会引发错误，大概是因为第一种方法尚未定义。

Clojure`reify`文档有这样的评论：

> 如果一个方法在协议/接口中被重载，则必须提供多个独立的方法定义。

[http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/reify](http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/reify)

我想这些不是*独立*的定义。

解决这个问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T06:15:12.367

您的命名空间声明是错误的。

```
(ns bulbs.neo4jserver.client
  (:use [bulbs.base.client :only [ClientProtocol]])) 
```

协议函数是普通的 Clojure 函数，必须这样处理。因此，您必须将它们包含在您的`:only`条款中。

```
(ns bulbs.neo4jserver.client
  (:use [bulbs.base.client :only [create-edge ClientProtocol]])) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T00:38:42.980

这是一个适用于 clojure 1.4.0 的简化示例

```
(ns hello.core)
(defprotocol ClientProtocol
 (create-edge
    [this outV label inV] 
    [this outV label inV data]))

(deftype Neo4jClient []
  ClientProtocol

 (create-edge
   [this outV label inV data]
    4)

  (create-edge
    [this outV label inV]
    (create-edge this outV label inV nil)))

hello.core> (create-edge (Neo4jClient.) 2 3 4)
4

hello.core> (create-edge (Neo4jClient.) 2 3 4 5)
4 
```

* * *

这是一个相互递归的例子（没有基本情况）

```
(deftype Neo4jClient []
  ClientProtocol

  (create-edge
    [this outV label inV data]
    (println "OMG im in a looooooop...")
    (create-edge this 1 2 3))

  (create-edge
    [this outV label inV]
    (println "AHHH im in a looooooop...")
    (create-edge this 1 2 3 4)))

hello.core> (create-edge (Neo4jClient.) 1 2 3 4)
OMG im in a looooooop...
AHHH im in a looooooop...
OMG im in a looooooop...
AHHH im in a looooooop...
OMG im in a looooooop...
AHHH im in a looooooop...
OMG im in a looooooop...
AHHH im in a looooooop... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T18:59:47.063

你在这里做什么工作正常。

考虑这个例子：

```
(defprotocol ClientProtocol
  (create-edge
    [this outV label inV]
    [this outV label inV data]))

(deftype SampleClient []
  ClientProtocol

  (create-edge
    [this outV label inV]
      (create-edge this outV label inV {}))

  (create-edge
    [this outV label inV data]
      {:action :create-edge :this this :outV outV :label label :inV inV :data data})) 
```

运行时的行为符合预期：

```
; => (create-edge (SampleClient.) 1 2 3)
{:action :create-edge, :this #<SampleClient user.SampleClient@63a2cc03>,
 :outV 1, :label 2, :inV 3, :data {}}
; => (create-edge (SampleClient.) 1 2 3 4)
{:action :create-edge, :this #<SampleClient user.SampleClient@7144c1a4>,
 :outV 1, :label 2, :inV 3, :data 4} 
```

# css - 返回 jQuery UI 元素的 CSS 值

> ID：10645163
> 
> 赞同：0
> 
> 时间：2012-05-18T00:16:45.763
> 
> 标签：css, jquery-ui

我不确定这是否可以通过 jQuery 或其他方法实现，但我已将主题切换器小部件合并到我的网络应用程序中。我有一组可选的 UI 元素，我想在页面加载/主题切换时将它们的颜色与当前主题的 ui-state-highlight 颜色相同。我正在尝试将背景的值存储在 var 中，因此我可以使用 .css 来设置可选颜色以匹配。

`input = $('.ui-state-highlight').css('background')`

返回未定义，但如果我尝试

```
input = $('.ui-state-default').css('color') 
```

我可以返回一个值。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:28:30.200

您的第一个示例之前没有句点，`'ui-state-highlight'`因此您尝试选择类型为 ui-state-highlight 的元素（与 DIV、INPUT、SELECT 等类型相反）

```
 $('ui-state-highlight') 
```

您的第二个示例实际上选择了具有“ui-state-default”类的元素

```
 $('.ui-state-default') 
```

**编辑：**根据您的更正，我猜这里的问题是您可能正在尝试使用 ui-state-highlight 类获取任何元素的背景颜色，但您的页面上实际上并没有显示任何元素。

[根据使用 Javascript/jQuery 从外部样式表获取 CSS 值的](https://stackoverflow.com/questions/2707790/get-a-css-value-from-external-style-sheet-with-javascript-jquery)答案，尝试以下代码

```
var $p = $("<p class='ui-state-highlight'></p>").hide().appendTo("body"); 
input = $p.css("background"); 
$p.remove(); 
```

您临时创建一个新`<p></p>`的，然后在删除它之前从它身上获取背景颜色。

# ios - xib中的UINavigationController不显示

> ID：10645169
> 
> 赞同：1
> 
> 时间：2012-05-18T00:17:49.667
> 
> 标签：ios, xamarin.ios, uikit, interface-builder

我正在尝试使用 PresentModalViewController 通过 XIB 呈现 UInavigationController。我的 XIB 的结构如下：

```
UINavigationController
 -UIView 
```

第一响应者连接到 UIView。并且 UIVIew 被放入 UINavigationController

现在每次模态显示时只有视图是可见的，并且 NavigationController 始终为空。

如果我以编程方式初始化 UINavigationController 并且在我的 xib 中只有一个 UIVIew ，它可以正常工作，如下所示：

```
var registerView = new RegisterView();
UINavigationController navController = new UINavigationController(registerView);
registerView.Title="Register";
this.PresentModalViewController(navController,true); 
```

它表明我在我的 XIB 中错误地连接 UINavigationController，是否有任何我应该连接的插座等？

此外，问题与 PresentModalViewController 的模态显示无关，因为我曾尝试使用 AppDelegate 中的 xib，如下所示：

```
viewController = new RegisterView();
window.RootViewController = viewController;
window.MakeKeyAndVisible (); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T09:40:47.590

在 appdelegate 中尝试这样的事情：

```
 window = new UIWindow (UIScreen.MainScreen.Bounds);
        navcontroller = new UINavigationController ();
        navcontroller.PushViewController (new RegisterView(), false);
        window.RootViewController = navcontroller;
        window.MakeKeyAndVisible ();

        return true; 
```

需要添加导航的是rootviewcontroller，homeview推送到view上

# visual-c++ - CEdit::GetLine (MFC, VC++6) 在 Windows 7 中返回额外字符

> ID：10645171
> 
> 赞同：1
> 
> 时间：2012-05-18T00:17:56.437
> 
> 标签：visual-c++, windows-7, mfc, getline, cedit

m_editText 是 CEdit 类型（来自 MFC）。多年来，这在 WinXP（32 位）中的数百名用户中运行良好，但是当相同的可执行文件在 Win7（64 位）上时，一些用户（在 strText 中）获得额外的奇怪（即扩展，即垃圾）字符附加到文本他们在编辑框控件 (m_editText) 中键入。我无法重现问题。我验证了 GetLine 只复制了输入到编辑框中的字符（至少在我的机器上）。

```
TCHAR atchBuffer[256] = {0};  // initialize to all nulls
int nChrCount = m_editText.GetLine(0, atchBuffer, 255);
CString strText;
if (nChrCount!=0)
    strText = CString(atchBuffer); 
```

这是在 WinXP（32 位）上的 Visual C++ 6 中编译（调试构建），MFC 5 静态链接。提供的任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T09:01:20.957

像这样更改您的代码：

```
if (nChrCount!=0)
    strText = CString(atchBuffer, nChrCount); 
```

确保不会将任何垃圾/未初始化数据添加到 CString，只有控件中的字符。

# ruby - 在 ruby 中运行系统命令并与之交互

> ID：10645173
> 
> 赞同：9
> 
> 时间：2012-05-18T00:18:05.877
> 
> 标签：ruby, command-line, command-line-interface, pgp

我需要在命令行上运行一个要求用户响应的命令。如果它有帮助，命令是：

```
gpg --recipient "Some Name" --encrypt ~/some_file.txt 
```

当你运行它时，它会发出警告，然后询问：

> 还是使用这个键？（是/否）

响应'y'让它正确完成。我一直在尝试使用[open4 gem](https://github.com/ahoward/open4)，但我无法让它正确指定“y”。这是我尝试过的：

```
Open4::popen4(cmd) do |pid, stdin, stdout, stderr|
  stdin.puts "y"
  stdin.close

  puts "pid        : #{ pid }"
  puts "stdout     : #{ stdout.read.strip }"
  puts "stderr     : #{ stderr.read.strip }"
end 
```

我究竟做错了什么？我正在做的事情甚至可能吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-18T00:54:26.033

处理这些情况的 Unix 方法是使用[expect](http://en.wikipedia.org/wiki/Expect)，Ruby[内置支持](http://ruby-doc.org/stdlib-1.9.3/libdoc/pty/rdoc/IO.html#method-i-expect)：

```
require 'pty'
require 'expect'

PTY.spawn("your command here") do |reader, writer|
  reader.expect(/Use this key anyway/, 5) # cont. in 5s if input doesn't match
  writer.puts('y')
  puts "cmd response: #{reader.gets}"
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T00:24:22.077

`gpg`可能是直接打开终端设备来询问用户问题——这是一种常见的安全方法，可以防止完全从文件中驱动脚本。（有关类似内容，请参阅现已弃用的`getpass(3)`例程。）

如果您实际上不太关心阅读它的警告，您不妨使用`gpg`命令行选项`--yes`：

```
 --yes  Assume "yes" on most questions. 
```

# windows - FOSSIL（版本控制系统）不添加 .htaccess 文件。为什么？

> ID：10645176
> 
> 赞同：4
> 
> 时间：2012-05-18T00:18:28.103
> 
> 标签：windows, .htaccess, fossil

我有一个网站，里面有很多 .htaccess 文件。但是当我使用 addremove 时，化石并没有将它们保存在 repo 中。相反，我必须手动添加每个 htaccess 文件（使用 add 命令）。怎么了？

化石 1.22 (2012-03-17 17:53:25)，Win32。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T19:11:54.540

来自“addremove”命令的化石帮助：

> 名称以“.”开头的文件和目录 除非使用 --dotfiles 选项，否则将被忽略。

# ruby-on-rails - Rails 模型关联类型

> ID：10645178
> 
> 赞同：0
> 
> 时间：2012-05-18T00:18:49.973
> 
> 标签：ruby-on-rails, database, ruby-on-rails-3, activerecord, polymorphic-associations

我有以下表格：用户、朋友、兴趣和假期。这个应用程序的目的是记录用户的兴趣和他们庆祝的假期（包括朋友的生日、纪念日等）以及朋友的兴趣，以便我可以向他们发送相关内容的提醒。无论如何：

用户将有兴趣
用户将有朋友
朋友也会有兴趣
用户将有他们庆祝的假期（大约 10 个列表） -
如果选择母亲节、父亲节或情人节（在节假日）我将需要存储人名和他们的兴趣

所以我想知道如何设置这些。棘手的是兴趣和假期。

兴趣应该是多态的，以便用户和朋友都可以访问吗？或者有很多：通过？

假期呢？这些将如何记录姓名和个人利益？

谢谢！我真的为这个而苦苦挣扎，可能使事情过于复杂..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:46:29.743

现在我想我明白你想要做什么，这就是我将如何建模：

`User`：

```
has_many :friends
has_many :person_interests, :as => :person
has_many :interests, :through => :person_interests
has_many :user_holidays
has_many :holidays, :through => :user_holidays 
```

`Friend`：

```
belongs_to :user
has_many :person_interests, :as => :person
has_many :interests, :through => :person_interests 
```

`PersonInterest`：

```
belongs_to :interest
belongs_to :person, :polymorphic => true 
```

`Interest`：

```
has_many :person_interests
has_many :people, :through => :person_interests # may need an `inverse_of` here 
```

`UserHoliday`：

```
belongs_to :user
belongs_to :holiday 
```

`Holiday`：

```
has_many :user_holidays
has_many :users, :through => :user_holidays 
```

通过这些设置，您应该能够执行您需要执行的查询。

# android - 在三星 Android 手机上使用逗号/暂停拨打电话号码

> ID：10645182
> 
> 赞同：1
> 
> 时间：2012-05-18T00:20:00.010
> 
> 标签：android

我正在开发一个拨号器应用程序，我一直在我的摩托罗拉设备和我通过 SDK 管理器下载的仿真器图像上进行测试。

用户要么输入号码，要么从最近的通话或联系人中选择号码。然后我像这样启动呼叫（逗号在那里，因此在发送拨号音之前会有延迟）：

```
String url = "tel:" + preDial + " ,,, " + postDial;
Intent intent = new Intent(Intent.ACTION_CALL, Uri.parse(url));
startActivity(intent); 
```

在我的手机和模拟器上，手机应用程序会显示`preDial`其联系人姓名，并将其正常插入最近的通话记录中。然而，当我在朋友的 Samsung Charge 上对其进行测试时，它显示了 url 的内容（当然减去了“tel:”）。例如，如果`preDial = "15555555555"`电话`postDial = "1111"`应用程序将显示 15555555555,,,1111 并且由于联系人没有附加 ,,,1111 的号码，因此不会显示相应的联系人姓名。这也搞砸了通话记录，因为这个没有联系的尴尬号码存储在那里。我假设这是三星如何实现他们的手机的一个功能，我希望有办法解决它。

我可以通过从通话记录中删除来修复`LIKE preDial`通话记录，但电话应用程序中号码显示方式的问题仍然存在。有谁知道这是否是比三星更普遍的问题，是否有任何解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T10:39:05.073

我想说这就是摩托罗拉实现事物的方式，因为我从来没有想过在两者之间使用逗号。你只是尝试不使用逗号吗？`String url = "tel:" + preDial + postDial;`

**编辑：**检查[@RetoMeier 的解释/建议](https://stackoverflow.com/a/9089375/304270)。

希望它有所帮助，并且真的希望您的 UI 比我评论中的 UI 更好.. ;)

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T10:42:43.007

尝试这样的事情，

```
 String tel = preDial + " ,,, " + postDial;
// it will remove all things except number's
                tel = tel.replaceAll("\\D", "");
                Intent callIntent = new Intent(Intent.ACTION_CALL);
                callIntent.setData(Uri.parse("tel:" + tel));
                startActivity(callIntent); 
```

# c# - .NET 控制台在编写特定字符串时播放声音

> ID：10645183
> 
> 赞同：2
> 
> 时间：2012-05-18T00:20:16.920
> 
> 标签：c#, .net, console-application

我有一个作为控制台应用程序实现的 .NET 脚本。在执行期间，它将调试信息写入控制台。在脚本执行期间，应用程序偶尔会连续发出几次哔声。仔细观察，似乎每次打印某些字符时都会发生这种情况。

在.NET 中读入内存或打印到屏幕时，是否有任何特殊字符会导致系统发出哔哔声？

字符类似于：

> ×¨×>×'×ª ×"×¡×o×'×¡ ×¦'××¦'× ××?×'×? ×o××'×" ×'×¨××z× ×T ×" ×"×z××¤×¢ ×o×z×¦××? ×?×ª ×-××©×" ×''×¡×T×§×" ×¤×¨×"×T×T×- ×"×ª××?×¨ ×'×z×'× "×"×?×-×T×§××Y

还有这个

> é>┼ å╬¶æ%<è?½ç½' å¼æ-°ç-'å>¢ é>┼ å«£çº¢é?╬ä¸S å®³ç^¶ä»╬äº é>┼ å° ?å^?è¯^ç-。ä¸ºè§?å┼·è¡ é>┼ è?½çY³ç< æ<> è¿«ä¼-å±^æo é>┼ æ£æ^'åSªåS> è?¥æ'ä¼-äºº é>┼ ä¸ºåS©å┼·è¡ æ£æ^'å?-ä¼ é>┼ å┼·è¡?æ^?åSY å®Oæ^?ä»»åS é>┼ å"¿å?è¢«æ??è"¡äº¬ ç<'æ? é>┼ é"?æ%<æ??äºº è¯?æ?®ç¡®å╬ é>┼ã??æ- æƒ.åZYæ~¯ æ^?å®¶å?Z é>┼ è <¥é£zæ"¯æO? è¿½å'½å¼?è§ é>┼ æ- æƒ.æ£æ^' å?'çZ°çoYç> é>┼ è<¥é£zå¤±æ~Z é"?æ%<å¿ƒç -é>┼</p>

但是我没有通过尝试手动将它们写入控制台来让它们发出哔哔声。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T00:25:23.847

我猜您正在打印一个映射到 ASCII Bell 字符的字符： [MSDN 博客上的问题](http://blogs.msdn.com/b/oldnewthing/archive/2007/01/04/1411080.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T00:25:24.780

输出 ASCII BEL 字符 (0x07) 时，控制台会发出蜂鸣声。尝试：

```
Console.Write('\x07'); 
```

您将看不到屏幕上显示的那个字符。

# ruby - Rails 应用程序、MongoDB 和 EngineYard

> ID：10645184
> 
> 赞同：0
> 
> 时间：2012-05-18T00:20:30.490
> 
> 标签：ruby, ruby-on-rails-3, mongodb, jenkins, engineyard

如果我想在 EngineYard 上为我的 Rails 应用程序设置一个包含 MySQL、MongoDB 和**Jenkins**持续集成服务器的**测试环境，我是将所有这些设置为****单实例环境**还是多实例环境？我是否需要为 MongoDB 设置一个单独的实用程序实例，或者它们是否能够生活在同一个“单实例环境”中？

 ***** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:13:53.093

在单独的实例上运行它可以很好地进行测试，但是您可能会遇到性能问题。MongoDB mmaps 数据文件和 MySQL 为 InnoDB 缓冲区分配 RAM，因此根据数据集的大小，您可以轻松耗尽单个实例上的可用 RAM。

Engine Yard 提供了一个公共 repo，其中包含一些可以帮助您进行设置的方法（尤其是 MongoDB）。它们在这里可用： [https ://github.com/engineyard/ey-cloud-recipes](https://github.com/engineyard/ey-cloud-recipes)

免责声明：我在 Engine Yard 工作，但这不是官方支持。如果您想要其中的一些，请打开一张票！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:58:07.783

您可以在单独（即单实例）环境中设置它们。只要它们没有设置为位于冲突的端口或使用冲突的目录，就应该没问题。我有一个单独的环境，mysql、redis 和 cassandra 运行没有问题。****

# ruby-on-rails - 你怎么能把它映射到 Mongoid 或 MongoMapper

> ID：10645187
> 
> 赞同：0
> 
> 时间：2012-05-18T00:21:09.807
> 
> 标签：ruby-on-rails, mongoid, mongomapper

嗨，有人可以帮我将它映射到 Rails 和 Mongo，我有两天时间研究这个主题，但我似乎无法弄清楚，我的意思是在 Mongoid 或 MongoMapper 中为这两个集合制作模型。

```
Users collection

{ "_id" : ObjectId( "4fa883e45ddddbb60c4a6970" ),
   "username" : "joedoe",
   "name" : "joe",
   "created" : "2010-01-15 00:00:00",
   "suscribers" : [ 
      { "suscribe_id" : ObjectId( "4fa884a35ddddbb60c4a6971" ),
        "name" : "Mashable", 
        "tags" : ['Tech', 'News'], 
        "sort" : 0 
      }, 
      { "suscribe_id" : ObjectId( "4fa884a35ddddbb60c4a6972" ),
        "name" : "Joe", 
        "tags" : ['Tech'], 
        "sort" : 1 
      } 
   ] }

Suscribers collection
 { "_id" : ObjectId( "4fa884a35ddddbb60c4a6971" ),
   "name" : "Dan",
   "suscribers_count" : 0,
   "latest" : "2010-01-15 00:00:00" },
 { "_id" : ObjectId( "4fa884a35ddddbb60c4a6972" ),
   "name" : "Fer",
   "suscribers_count" : 0,
   "latest" : "2010-01-15 00:00:00" } 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:24:26.827

我在想这样的事情：

```
class User
  include Mongoid::Document

  field :username
  field :name
  embeds_many :user_subscribers
end

class UserSubscriber
  include Mongoid::Document

  embedded_in :user
  belongs_to :subscriber
  field :tags, type: Array
  field :sort, type: Integer
end

class Subscriber
  include Mongoid::Document

  field :name
  has_many :user_subscribers
end 
```

# python - 如何使垂直列表水平打印？

> ID：10645189
> 
> 赞同：1
> 
> 时间：2012-05-18T00:21:15.877
> 
> 标签：python, string

如果我有一个像这样垂直打印的变量：

```
h
e
l
l
o 
```

如何使这个变量像这样水平打印？：

```
hello 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T00:35:14.827

假设

```
text = 'h\ne\nl\nl\no' 
```

这是另一种方式。

```
''.join(text.split()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:18:08.300

听起来您正在从数组中创建一个字符串？或者也许是一个字符串中的一个字符串？

```
>>> from_list = ['h', 'e', 'l', 'l', 'o']
>>> print ''.join(from_list)
hello
>>> print ':'.join(from_list)
h:e:l:l:o 
```

字符串的*join()*函数接受一个列表并返回一个字符串，其参数位于每个项目之间。

您可能正在使用字符串：

```
>>> from_string = "h\ne\nl\nl\no"
>>> print from_string
h
e
l
l
o
>>> print from_string.split()
['h', 'e', 'l', 'l', 'o']
>>> print "".join(from_string.split())
hello
>>> print " (pause) ".join("one, two, three, five, no four!".split(","))
one (pause)  two (pause)  three (pause)  five (pause)  no four! 
```

这使用了字符串的*split()*函数，该函数将字符串拆分为项目列表。然后将结果连接回字符串。您可以拆分任何字符串，但默认为空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-25T09:54:41.357

用 加入列表项目的表示`', '`，

```
l = [3.14, 'string', ('tuple', 'of', 'items')]
print(', '.join(map(repr, l))) 
```

输出：

> ```
> 3.14, 'string', ('tuple', 'of', 'items') 
> ```

* * *

我不知道“垂直列表”是什么意思，因为 python 只有没有方向的列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-16T11:22:33.787

我可以建议的一个非常快捷的方法如下

```
str1 = "I love python"
for chars in str1:
  print( * [chars], end = ' ') 
```

**输出**

```
 I   l o v e   p y t h o n 
```

如果您不想要空格，只需删除单引号之间的空格即可
`print( * [chars], end = '')`

**输出**

```
 I love python 
```

# mysql - SQL在两个不同列中对按相同标识符分组的字段求和

> ID：10645194
> 
> 赞同：1
> 
> 时间：2012-05-18T00:21:52.623
> 
> 标签：mysql, sql

该表有 4 列 Match、Winning_Player_ID、Losing_Player_ID、Quantity_Points_Exchanged_for_that_match。我想在一个查询中显示每个玩家在所有比赛中赢得和获得的总积分。

这是桌子

```
M WIN LOSE QTY  
1 100 201 10  
2 201 100 05  
3 100 201 05  
4 302 100 05 
```

对于输出，我希望以这种方式在单个查询中对其进行总计，但无法弄清楚。

```
ID WIN LOSE
100 15 10
201 05 15
302 05 00 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:27:51.717

```
SELECT p.player ID,
       (SELECT SUM(QTY) FROM tbl WHERE WIN = p.player) WIN,
       (SELECT SUM(QTY) FROM tbl WHERE LOSE = p.player) LOSE
FROM
    (SELECT DISTINCT WIN player FROM tbl
    UNION
    SELECT DISTINCT LOSE FROM tbl) p 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T00:35:29.273

没有数据库可用于检查这一点，但可能是这样的：

```
SELECT player, SUM(winQty) AS WIN, SUM(loseQty) AS LOSE
  FROM ( SELECT win AS player, qty AS winQty, 0 AS loseQty
           FROM myTable
         UNION ALL
         SELECT lose AS player, 0 AS winQty, qty AS loseQty
           FROM myTable
       ) x
  GROUP BY player 
```

更新：将 UNION 更改为 UNION ALL

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T02:06:18.107

这是答案：

创建表：

```
CREATE TABLE table_name (
  m int,
  win int,
  lose int,
  qty int); 
```

插入数据：

```
INSERT INTO table_name (m, win, lose, qty)
values 
(1, 100, 201, 10),
(2, 201, 100, 05),
(3, 100, 201, 05),
(4, 302, 100, 05); 
```

查询：

```
SELECT id, sum(won), sum(lost) from (
    SELECT win as id, SUM(qty) as won, 0 as lost 
    FROM table_name W GROUP BY win
  UNION
    SELECT lose as id, 0 as won, SUM(qty) as lost
    FROM table_name W GROUP BY lose
  ) sums
GROUP BY ID 
```

结果：

```
+------+----------+-----------+
| id   | sum(won) | sum(lost) |
+------+----------+-----------+
|  100 |       15 |        10 |
|  201 |        5 |        15 |
|  302 |        5 |         0 |
+------+----------+-----------+ 
```

# google-chrome - Chrome、SVG 和最大高度

> ID：10645196
> 
> 赞同：2
> 
> 时间：2012-05-18T00:22:06.610
> 
> 标签：google-chrome, svg, responsive-design, css

我在使用 chrome 和 svgs 时遇到问题。

我希望 2 个 svg 是屏幕宽度的 100%，最大为 400 像素。因此，在移动屏幕上它们垂直对齐，然后在桌面上它们水平对齐。

这发生在我检查过的所有浏览器中，除了 chrome。我将在下面进行更多解释。

相关的 SVG

```
 viewport 0 0 400 150 
```

相关的 CSS

```
.svg{
margin-right:auto;
margin-left:auto;
width: 100%;
max-width: 400px;
background-color: aliceblue;
max-height: 150px;
} 
```

相关的javascript

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<script  type="text/javascript">
var imageWidth = 1*$(window).width();
var imageHeight = .425*$(window).width();
$("document").ready(function(){
        $(".svg").css("width", imageWidth);
        $(".svg").css("height",imageHeight);
});   
</script> 
```

相关的 HTML

```
 <object class="svg" type="image/svg+xml"  data="/svg/betterLearning1.svg" >
    </object>    
    <object class="svg" type="image/svg+xml"  data="/svg/betterLearning2.svg" >
    </object> 
```

当我查看 Chrome 中的检查元素时，我可以看到 css max-width 已经覆盖了 javascript 生成的宽度，但它没有改变高度，并且按照脚本保持不变。

编辑一个潜在的解决方法是在它们生成 css 之前限制 javascript 变量。

```
if (imageWidth > 400){
    imageWidth = 400;
 }
if (imageHeight > 150){
imageHeight = 150;
} 
```

# android - 将 Android 应用程序作为完成发送外发短信的默认应用程序

> ID：10645200
> 
> 赞同：0
> 
> 时间：2012-05-18T00:22:34.307
> 
> 标签：android, android-intent, sms

我想选择一个程序来完成短信的发送。例如，我在标准消息传递应用程序“Hello World”中键入一条消息，然后单击“发送”按钮，现在我希望它询问我要使用哪个应用程序完成此操作？这可能吗？

如果有人可以与我分享如何，我已经用 SENDTO 操作弄乱了意图过滤器，但这并没有达到预期的结果。任何帮助，将不胜感激？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T00:40:37.030

实际上，您可以使用意图过滤器来选择用于发送消息的应用程序（也可以编写它）。我认为您尝试做的事情是不可能的。

# algorithm - 我如何保证元胞自动机生成的迷宫是可解的/有趣的？

> ID：10645201
> 
> 赞同：2
> 
> 时间：2012-05-18T00:22:35.637
> 
> 标签：algorithm, maze, cellular-automata

我正在写一个迷宫生成算法，这篇维基百科文章引起了我的注意。我决定用java实现它，这很容易。我遇到的问题是，虽然生成了类似迷宫的图片，但迷宫通常是不可解决的，而且通常并不有趣。我所说的有趣是指有大量无法到达的地方，而且通常有很多解决方案。

我实施了 1234/3 规则（虽然它很容易改变，请参阅注释以获得解释），一开始的分布大约为 50/50。迷宫总是达到平衡，其中 t 步之间没有变化。

我的问题是，有没有办法从固定的起点和终点保证迷宫的可解性？此外，有没有办法让迷宫更有趣地解决（更少/一个解决方案和很少/没有无法到达的地方）？如果细胞自动机无法做到这一点，请告诉我。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T01:15:05.393

我认为不可能通过简单的元胞自动机来确保一个可解的、有趣的迷宫，除非有一些特定的标准可以放在起始状态上。细胞不知道整体形状的事实，因为每个细胞将无法与整个群体协调。

如果您坚持使用它们，您可以在生成完成后进行一些修改和寻路的组合，但其他方法（如维基百科文章或[此问题](https://stackoverflow.com/questions/38502/whats-a-good-algorithm-to-generate-a-maze)中显示的方法）更易于实现并且不会导致墙壁它占据了整个细胞（除非你想要那个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:00:38.977

问题的根源在于“迷宫质量”是一种全局度量，但您的自动机单元仅限于系统的非常局部的知识。

要解决此问题，您有三个选择：

1.  从外部添加全局信息。使用自动机和随机初始数据生成迷宫，然后测量迷宫质量（例如使用洪水填充或[一堆其他迷宫解决技术](https://en.wikipedia.org/wiki/Maze_solving_algorithm)）并重复，直到得到你喜欢的结果。

2.  使用一组更复杂的显式规则和状态。您可以制定一组规则/单元格值，这些规则/单元格值对墙壁的存在和路径的长度/质量进行编码。例如，-1 将是一堵墙，正值将是上方和左侧所有邻居的总和。然后正值大致编码从左上角的路径距离。这还不够，但它显示了总体思路……您需要在系统规则中“直接”编码关于迷宫的算法。

3.  使用不太复杂但仍然完整的规则集，并对初始状态下的迷宫生成规则进行编码。例如，您可以使用[康威的生命](https://en.wikipedia.org/wiki/Conway%27s_life)并构建一个初始状态，该状态是一个“程序”，通过滑翔机等实现迷宫生成。

如果它对您有帮助，您可以在上述内容和以下内容之间进行比较：

1.  [机器中的幽灵](https://en.wikipedia.org/wiki/Ghost_in_the_machine)/外部用户
2.  [FPGA](https://en.wikipedia.org/wiki/Fpga)
3.  对通用 CPU 进行编程

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T01:09:10.523

在其上运行寻路算法。Dijkstra 会给你一个可靠的方法来计算所有的解决方案。A* 会给你一个很好的解决方案。

迷宫的难度可以通过这些算法解决它的速度来衡量。

您可以添加一些死胡同以关闭某些解决方案。

# sql - SQL中必须转义什么？

> ID：10645211
> 
> 赞同：1
> 
> 时间：2012-05-18T00:24:54.217
> 
> 标签：sql, escaping, code-injection

将 SQL 与另一种语言结合使用时，必须转义哪些数据？我只是在[这里阅读问题](https://stackoverflow.com/questions/10645067/does-sessionusername-need-to-be-escaped-before-getting-into-an-sql-query/10645096#10645096)，据我了解，只有来自用户的数据必须被转义。

还必须转义所有 SQL 语句吗？例如插入、更新和选择

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:27:41.480

**SQL 中的每种**查询都必须正确转义。不仅是“用户”数据。如果您不小心，完全有可能注入您自己。

例如在伪代码中：

```
$name = sql_get_query("SELECT lastname FROM sometable");
sql_query("INSERT INTO othertable (badguy) VALUES ('$name')"); 
```

该数据从未接触过“用户”，也从未由用户提交，但它仍然是一个漏洞——考虑一下如果用户的姓氏是`O'Brien`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T00:37:27.130

大多数编程语言都提供了用于以统一方式连接数据库的代码（例如Java中的[JDBC和 Perl 中的](http://en.wikipedia.org/wiki/Java_Database_Connectivity "JDBC")[DBI](http://dbi.perl.org/ "DBI")）。[这些提供了使用Prepared Statements](http://en.wikipedia.org/wiki/Prepared_statement "准备好的报表")进行任何必要转义的自动技术。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T01:03:00.567

所有 SQL 查询都应该经过适当的清理，并且有多种方法可以做到这一点。您需要防止用户尝试使用 SQL 注入来利用您的代码。可以通过多种方式进行注入，例如通过用户输入、服务器变量和 cookie 修改。

给定如下查询：

```
"SELECT * FROM tablename WHERE username= <user input> " 
```

如果用户输入没有转义，用户可以执行类似的操作

```
' or '1'='1 
```

使用此输入执行查询实际上将使其始终为真，可能会将敏感数据暴露给攻击者。但是还有许多其他更糟糕的场景可以使用注入。

* * *

您应该查看[OWASP SQL 注入指南](https://www.owasp.org/index.php/SQL_Injection)。他们对如何防止这些情况以及处理它的各种方法有很好的概述。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T01:23:51.433

我还认为这在很大程度上取决于您认为“用户数据”是什么或确实源自什么。我个人认为用户数据是公共领域中可用的数据（即使这只是通过利用），即可以由“a”用户更改，即使它不是“the”用户。

Marc B 提出了一个很好的观点，但是在某些情况下您可能会弄脏自己的数据，所以我想对于 sql 数据而言，安全总比抱歉要好。

我会注意到，关于直接用户输入（即来自 Web 表单等），您应该始终在数据接近 sql 查询之前进行额外的服务器端验证。

# python - 在 python 中通过 Mysqldb 查询抛出的异常。它直接在 mySQL 上执行

> ID：10645212
> 
> 赞同：2
> 
> 时间：2012-05-18T00:25:13.920
> 
> 标签：python, mysql-python

我正在尝试调用一个函数来执行查询：

```
def run(self,query):       
        try:
            self.cursor = self.conn.cursor ()
            self.cursor.execute(query)
        except MySQLdb.Error, e:
            logger.info( "Run function with query: %s Error %d: %s" % (query,e.args[0], e.args[1]))
        except:
            logger.info( "Errorin Run function with query %s" % (query)) 
```

此功能适用于大多数查询。

我正在尝试运行一个查询：

```
insert into NewBooks (title,WikiLink) values
   ('Five Point Someone – What not to do at IIT!',
    'http://en.wikipedia.org/wiki/Five Point Someone – What not to do at IIT!') 
```

此查询引发异常，输出为`Errorin Run function with query %s" % (query)` Traceback 错误：错误：我得到的是 UnicodeEncodeError: 'latin-1' codec can't encode character u'\u2013' in position 120: ordinal not in range(256)

当我在 Mysql 命令行上复制并运行时，它起作用了。有人可以解释一下我可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:41:27.033

您在该查询中有一些特殊字符，并且您的默认语言环境是 latin-1 (iso-8859-1)。当 python 尝试打印出错误消息并包含您的查询时，它无法将您的 unicode 对象编码为字节（它必须这样做，因为您只能通过管道发送字节，而不是代码点）。

您可以尝试使用支持 utf-8 的终端运行，确保您的语言环境对 utf-8 友好，或者明确指定您希望如何编码查询数据以进行输出。

一个很好的快速更改是`%r`在该行上使用而不是`%s`.

```
logger.info( "Errorin Run function with query %r" % (query,)) 
```

这只会以您可以将其粘贴回 Python 的方式显示查询对象，因此特殊字符将被转义。

此外，您正在吞下应该显示的实际错误，方法是用一个裸露的“除外”捕获所有内容。你真的应该要么把它拿出来，让 Python 向你展示回溯本身，要么放

```
import traceback
traceback.print_exc() 
```

那最后光秃秃的下`except:`。

# c++ - 控制对类成员的访问

> ID：10645214
> 
> 赞同：0
> 
> 时间：2012-05-18T00:25:24.870
> 
> 标签：c++

```
class A
{
   private:
           int x;
   public:
           virtual void show()
           {
               cout<<"X: "<<x;
           }
};

class B: public A
{
    public:
           virtual void show()
           {
               cout<<"In class B\n";
               A::show();
           }
}; 
```

我的问题是关于成员函数的可访问性。在这个例子中，我们可以说 B 的成员函数（B 的 show()）可以访问类 A 中的 X。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:29:08.500

Since `x` is declared `private` in `A`, nothing in `B` can directly access it. Of course, it can be accessed indirectly -- `B` can call `A::show()` which can access `x`. But `B::show()` cannot access `x`, nor can anything else in `B`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T00:46:08.887

你不是真的在访问`A.x`，你是在访问`A.show()`。

要回答您的**问题**，`B::show()`不访问.**`x``A`**

 **这样做的原因是，`class A`可以更改功能`A::show()`并执行其他操作，并且`B`可以调用`A::show()`.

这是封装的要点。您可以告诉 A 做某事（如），但决定如何做*。*`show()``A`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T01:02:21.407

1.  A::show() 可以访问它自己的类 A 中的任何成员变量。
2.  B 类中的成员函数可以访问 A 类中的任何公共或受保护 成员*变量*。

3.  B 类中的成员函数可以访问 A 类中任何受保护的公共成员*函数*。

2 和 3 是可能的，因为 A 的“最易访问级别”被定义为公共。

```
Class B: public A 
```

具体来说，在您的代码中，可访问性级别`int x;`无关紧要，因为它永远不会直接从 B 类访问。**

# android - 在 Android/Java 中杀死一个 *unresponsive* 线程

> ID：10645216
> 
> 赞同：1
> 
> 时间：2012-05-18T00:25:27.133
> 
> 标签：android, multithreading, infinite-loop

我知道优雅地关闭线程的公认正确解决方案。

但是假设我的游戏应该是容错的，当一个新的游戏开始时，它会尝试优雅地关闭旧游戏的（现在暂停的）线程。如果它无法加入/关闭它（例如，因为旧线程有问题并且处于无限循环中），它会实例化新线程并启动它。但我不喜欢旧线程还在那里，吃资源的事实。

是否有一种公认的方法可以在不终止进程的情况下终止无响应的线程？在我看来，事实上，我在某处读到 Thread 也可能不会对 Thread.stop() 做出反应。

所以没有办法处理无限循环中的线程（例如由于错误），是吗？即使它对 Thread.stop() 做出反应，文档说 Thread.stop() 可能会使 Dalvik VM 处于不一致的状态......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:36:31.433

如果您需要此功能，则必须对其进行设计和实施。显然，如果你不设计和实现优雅的方式来关闭线程，那么就没有办法优雅地关闭线程。没有通用的解决方案，因为解决方案是特定于应用程序的。例如，它取决于线程可能持有的资源以及线程可能持有锁或已损坏的共享状态。

规范的答案是：如果您需要此功能，请不要使用线程。使用流程。

核心原因是线程的工作方式。您获取锁，然后操作共享数据。在您操作该共享数据时，它可能会进入不一致的状态。在释放锁之前将数据恢复到一致状态是线程的绝对责任。（例如，从双向链表中删除一个对象。您必须先调整正向链接或反向链接。在这两个操作之间，链表处于不一致状态。）

假设您有以下代码：

1.  获取锁或进入同步块。

2.  开始修改锁保护的共享状态。

3.  *漏洞*

4.  将锁保护的数据返回到一致状态。

5.  释放锁。

那么，现在，我们该怎么办？在第 3 步，线程持有一个锁，它遇到了错误并触发了异常。如果我们不释放它在步骤 1 中获得的锁，那么每个试图获得相同锁的线程将永远等待，我们注定要失败。如果我们确实释放了它在步骤 1 中获得的锁，那么每个获得锁的线程都会看到线程无法清理的不一致共享状态，因为它从未到达步骤 4。无论哪种方式，我们都注定要失败。

如果线程遇到应用程序程序员没有创建合理的处理方式的异常情况，则该进程注定要失败。

# sql - SQL Compact 4.0 工具

> ID：10645217
> 
> 赞同：1
> 
> 时间：2012-05-18T00:25:45.647
> 
> 标签：sql, sql-server-ce

只是想了解是否有人使用过或正在使用 Sql Compact 4.0 进行开发。基本上，我们正在寻找可以支持创建类似于我们在 Sql Server 2008 Management Studio 中的更改脚本的工具。

如果您不确定该功能是什么，基本上每当您进行架构更改时，您都可以简单地生成更改脚本以在其他地方运行。我还没有遇到任何可以为 Sql Compact 4.0 提供这种功能的工具。

有没有人遇到过这种工具？如果是这样，你能告诉我吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T16:18:03.880

您可以使用我的 SQL Server Compact Toolbox（VS 插件或独立）[http://sqlcetoolbox.codeplex.com](http://sqlcetoolbox.codeplex.com)来执行架构差异脚本

# jquery - jQuery：在前一个兄弟锚点中查找跨度

> ID：10645224
> 
> 赞同：0
> 
> 时间：2012-05-18T00:26:29.310
> 
> 标签：jquery, html, siblings

我有以下html结构：

```
<div class="divClass">
     <a class="aClass" href="#">
          <img src="xxxx.jpg"
          <span class="span01">
              xxxx
          </span>                    
     </a> 
     <span class="span02">xxxx</span>
</div> 
```

我想`span01`在悬停时显示`span02`。

我正在尝试使用 jQuery 来实现这一点：悬停时，转到上一个`<a>`，查找`span`with 类`.span01`并显示它。这是我得到的，但我知道我没有像我应该使用的那样使用 prevAll 和 :first ，而且我不知道如何找到 span02 因为它不是 span01 的兄弟姐妹（因为它在不同类型的元素中，锚）：

```
$("span.span02").live("mouseenter", function () {
$('a.aClass').prevAll('.span:first').delay(300).fadeIn();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:29:39.967

我只是遍历父项并从那里找到它：

```
$("span.postAuthorLabel").live("mouseenter", function() {
  $(this).parent().find('.span01').delay(300).fadeIn();
}); 
```

# c# - 将具有多个参数的函数作为参数传递

> ID：10645225
> 
> 赞同：5
> 
> 时间：2012-05-18T00:26:41.767
> 
> 标签：c#, parameters, func, stopwatch, measure

我有这段代码，它接受一个没有参数的函数，并返回它的运行时。

```
public static Stopwatch With_StopWatch(Action action)
{
    var stopwatch = Stopwatch.StartNew();
    action();
    stopwatch.Stop();
    return stopwatch;
} 
```

我想将其转换为带参数的非 void 函数。我听说过 Func<> 委托，但我不知道如何使用它。我需要这样的东西（非常伪）：

```
 public T measureThis(ref Stopwatch sw, TheFunctionToMeasure(parameterA,parameterB))
   {
       sw.Start(); // start stopwatch
       T returnVal = TheFunctionToMeasure(A,B); // call the func with the parameters
       stopwatch.Stop(); // stop sw
       return returnVal; // return my func's return val
   } 
```

*所以我必须得到传递函数的返回值，最后得到秒表。* 任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T00:29:51.077

您的原始代码仍然可以工作。人们如何称呼它是当你有参数时会发生什么变化：

```
With_Stopwatch(MethodWithoutParameter);
With_Stopwatch(() => MethodWithParameters(param1, param2)); 
```

您还可以使用第二种语法调用带有参数的方法：

```
With_Stopwatch(() => MethodWithoutParameter());
With_Stopwatch(() => MethodWithParameters(param1, param2)); 
```

*更新*：如果你想要返回值，你可以改变你的`measureThis`函数来`Func<T>`代替一个动作：

```
public T measureThis<T>(Stopwatch sw, Func<T> funcToMeasure)
{
    sw.Start();
    T returnVal = funcToMeasure();
    sw.Stop();
    return returnVal;
}

Stopwatch sw = new Stopwatch();
int result = measureThis(sw, () => FunctionWithoutParameters());
Console.WriteLine("Elapsed: {0}, result: {1}", sw.Elapsed, result);
double result2 = meashreThis(sw, () => FuncWithParams(11, 22));
Console.WriteLine("Elapsed: {0}, result: {1}", sw.Elapsed, result); 
```

# css - 有人可以帮我弄清楚如何让这个背景图像（和表单）正确调整大小吗？

> ID：10645227
> 
> 赞同：0
> 
> 时间：2012-05-18T00:26:50.937
> 
> 标签：css, widget, wordpress-theming, responsive-design

在我的[网站上](http://noahsdad.com/)，如果您一直滚动到侧栏的底部（在右侧），您会看到我正在尝试制作的电子邮件注册框（通过文本小部件。）我已经尝试了所有一天让它正常工作，但无法弄清楚。一件事起作用，另一件事坏了。我不确定我是否应该在我的文本小部件中发布它是什么，或者我的 style.css 中有什么，供大家查看。也许有人可以检查链接，看看他们是否能看到发生了什么。如果需要，我很乐意发布代码。该主题使用 Twitter 引导程序进行响应。

这是我的 custom.css（这是一个子主题）如果我需要更改任何内容，请随时告诉我。

```
/* ------------------------------------------------------------------------ Import Standard Styles */

@import url( '../standard3/style.css' );

/* ------------------------------------------------------------------------ Customizations */
#disqus_thread {
    clear: both!important;
    background: white;
    background: white;
    margin: 0 0 40px 0;
    position: relative;
    border-radius: 4px;
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    -webkit-box-shadow: inset 0 1px 2px 0 rgba(0, 0, 0, 0.2),transparent 0 0 0,transparent 0 0 0,transparent 0 0 0,transparent 0 0 0;
    -moz-box-shadow: inset 0 1px 2px 0 rgba(0, 0, 0, 0.2),transparent 0 0 0,transparent 0 0 0,transparent 0 0 0,transparent 0 0 0;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2),transparent 0 0 0,transparent 0 0 0,transparent 0 0 0,transparent 0 0 0;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    padding: 0 20px;
}

.dsq-comment-text p
{
color: black;
font-size: 13px;
font-weight: normal;
line-height: 18px;
}

.widget .signupForm {
    /* Box always has colour, pic always on right */
    background-color: #06d0d2;
    background-image: url(http://noahsdad.com/wp-content/uploads/2012/05/noah-side-bar1.jpg);
    background-position: right bottom;
    background-repeat: no-repeat;

    /* height ensures full pic is shown  */
    height: 300px;    

    /* allow us to position contents */
    position: relative;
}

/* Absolutely position the form within the widget */
.widget .signupForm form {
 position: absolute;
 right: 160px;  
 bottom: 70px;
}

.widget .signupForm form input {
 display: block;
}

//* now just resize the widget box and move the form */

    .widget .signupForm {
        width: 300px;
        height: 240px;
        background-size: 100%;    
    }

    .widget .signupForm form {
        right: 120px;   
        bottom: 50px;
    }
}

/* adjust slightly for larger sizes */
@media screen and (min-width: 980px) {
    .widget .signupForm {
        width: 343px;
        height: 275px;
        background-size: 100%;    
    }

    .widget form .signupForm {
        right: 160px;   
        bottom: 70px;
    }
}

/* ------------------------------------------------------------------------ Media Queries */

/* Smartphones */
@media (max-width: 480px) {

}

/* Tablet and Mobile */
@media (max-width: 979px) {    

}

/* Mobile to Tablet */
@media only screen and (max-width: 767px) {

}

/* Landscape Tablets */
@media (min-width: 768px) and (max-width: 979px) {

}

/* Desktop */
@media (min-width: 980px) {

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:38:11.473

答案很简单。您正在使用的`background-image`宽度为 370 像素，但`#sidebar`包含小部件的宽度仅为 300 像素。

**解决方案 1**
您需要使用成像软件将图像缩小到正确的宽度或增加`#sidebar`.

**解决方案2**
或者您可以更改背景的位置，使文本气泡不是被切断的部分。

```
.widget .signupForm{ background-position: -19px 0;} 
```

**解决方案 3**
您可以使用 CSS3 来适应`background-image`using `background-size`：

```
.widget .signupForm{ background-size: contain; } 
```

但支持有限：[https ://developer.mozilla.org/en/CSS/background-size](https://developer.mozilla.org/en/CSS/background-size)

**编辑：基于发布的 CSS**

您可以使用您拥有的原始尺寸图像。`background-size`由于这行 CSS ，已经声明的规则丢失了：

```
//* now just resize the widget box and move the form */ 
```

删除第一个正斜杠，所有 CSS 应该可以正常工作：

```
/* now just resize the widget box and move the form */ 
```

并将表格放置在图像之外，更改所有规则`.widget .signupForm form`：

```
.widget .signupForm form {
    bottom: 50px; /* change to 0 */
    right: 120px;
} 
```

# vb.net - 如何在 vb.net 中使用 Insert 键？

> ID：10645231
> 
> 赞同：1
> 
> 时间：2012-05-18T00:27:10.347
> 
> 标签：vb.net

我正在开发一个在游戏中显示菜单的项目。但是要打开菜单，您必须按插入键。我找到了两种方法来做到这一点，但它们都给了我错误。这是代码：

```
 Dim insert As Boolean = GetAsyncKeyState(Keys.Insert) 
```

或者

```
 GetAsyncKeyState(118) 
```

我得到的错误是`PInvoke restriction: cannot return variants`

我对这个东西不是很熟悉，所以请帮忙，我怎么做才能按插入键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:39:51.797

如果这是 WinForms，请将表单的 KeyPreview 设置为 true 并覆盖 OnKeyDown 方法：

```
Public Class Form1

  Public Sub New()
    InitializeComponent()
    Me.KeyPreview = True
  End Sub

  Protected Overrides Sub OnKeyDown(ByVal e As System.Windows.Forms.KeyEventArgs)
    If e.KeyCode = Keys.Insert Then
      MessageBox.Show("I'm inserting!")
    End If
  End Sub

End Class 
```

# linear-algebra - 如果我不知道 f(x) = y 的形式，如何对 x、y 值对列表进行盲拟合？

> ID：10645232
> 
> 赞同：3
> 
> 时间：2012-05-18T00:27:13.187
> 
> 标签：linear-algebra, polynomial-math, data-fitting

如果我有一个我不知道其形式的函数 f(x) = y，并且如果我有一长串 x 和 y 值对（可能有数千个），那么是否有一个程序/包/库会产生 f(x) 的潜在形式吗？

显然，任何 f(x) 的可能形式都存在很多歧义，因此产生许多非平凡的唯一答案（以简化的形式）的东西是理想的，但可以产生至少一个答案的东西也很好。

如果 x 和 y 来自观察数据（即实验结果），是否有程序可以创建 f(x) 的近似形式？另一方面，如果您事先知道 x 和 y 之间存在完全确定的关系（如伪随机数生成器的输入和输出），是否有程序可以创建 f(x) 的精确形式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T20:38:10.660

太好了，我找到了自己问题的答案。[康奈尔大学发布了一款名为Eureqa](http://creativemachines.cornell.edu/eureqa)的软件来进行这种盲试。它必须是我所见过的来自学术实验室的最精美的软件之一。这真的很漂亮。一探究竟：

![在此处输入图像描述](../Images/1af5f8ceb02a0f399741034fcd46d0bf.png)

它甚至与 Amazon 的 ec2 集群进行了交钥匙集成，因此您只需按一下按钮，就可以将一些繁重的计算工作从本地计算机转移到云上，而且费用非常合理。

我认为我将不得不学习更多关于 GUI 编程的知识，以便我可以窃取它的界面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T00:42:58.643

（这更像是一个数值方法的问题。）如果有某种可观察的模式（你可以看到函数），那么是的，有几种方法可以逼近原始函数，但它们就是这样，近似值。

你想要做的叫做*插值*。两种非常简单（也不是很好）的方法是**牛顿法**和**拉普拉斯插值法**。它们的工作原理相同，但实现方式不同（拉普拉斯是迭代的，牛顿是递归的）。

如果您的任何两个数据点之间没有太多的事情发生（即，实际函数没有任何“凸点”，其“峰值”未由您的数据点之一表示），那么[**插值的样条方法**](http://en.wikipedia.org/wiki/Spline_interpolation)是一种您可以做出的最佳选择。实现起来有点困难，但它产生了很好的结果。

**编辑：**有时，根据您的具体问题，上述这些方法可能是矫枉过正。有时，您会发现线性插值（只需用直线连接点）是解决问题的完美解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T00:32:22.637

It depends.

If you're using data acquired from the real-world, then statistical [regression techniques](http://en.wikipedia.org/wiki/Regression_analysis) can provide you with some tools to evaluate the best fit; if you have several hypothesis for the form of the function, you can use statistical regression to discover the "best" fit, though you may need to be careful about over-fitting a curve -- sometimes the best fit (highest correlation) for a specific dataset completely fails to work for future observations.

If, on the other hand, the data was generated something synthetically (say, you *know* they were generated by a polynomial), then you can use [polynomial curve fitting methods](http://en.wikipedia.org/wiki/Curve_fitting#Fitting_lines_and_polynomial_curves_to_data_points) that will give you the exact answer you need.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T00:41:57.943

如果您有一个完全随机的集合，则多项式插值是可行的方法

[http://en.wikipedia.org/wiki/Polynomial_interpolation](http://en.wikipedia.org/wiki/Polynomial_interpolation)

如果你的集合几乎是线性的，那么回归会给你一个很好的近似值。

从 X 和 Y 中创建精确的形式几乎是不可能的。

请注意，您要实现的目标是许多机器学习算法的核心，因此您可能会在一些专门的库中找到您正在寻找的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T00:35:08.750

是的，有这样的事情。

如果您绘制这些值并看到一些有意义的函数关系，您可以使用最小二乘拟合来计算最小化误差的参数值。

如果你不知道函数应该是什么样子，你可以使用简单的样条或插值方案。

您还可以使用软件来猜测该功能应该是什么。也许像[Maxima](http://maxima.sourceforge.net/documentation.html)这样的东西可以提供帮助。

Wolfram Alpha 可以帮助您猜测：

[http://blog.wolframalpha.com/2011/05/17/plotting-functions-and-graphs-in-wolframalpha/](http://blog.wolframalpha.com/2011/05/17/plotting-functions-and-graphs-in-wolframalpha/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-18T00:53:37.043

一个包含 N 项长度的 x/y 值列表总是可以由 N 次多项式生成（假设没有相同的 x 值）。有关更多详细信息，请参阅这篇文章：

[http://en.wikipedia.org/wiki/Polynomial_interpolation](http://en.wikipedia.org/wiki/Polynomial_interpolation)

一些列表还可能匹配其他函数类型，例如指数函数、正弦函数和许多其他函数类型。找到“最简单”的匹配函数是不可能的，但你能做的最好的事情是浏览一个常见的列表，如指数、正弦等，如果它们都不匹配，则对多项式进行插值。

不过，我不知道有任何软件可以为您做到这一点。

# javascript - Scrolling to show div elements

> ID：10645242
> 
> 赞同：0
> 
> 时间：2012-05-18T00:29:00.870
> 
> 标签：javascript, scroll, hide, show

I'm wanting to show two divs when the page has been scrolled, but once they've appeared not be hidden anymore. The following code works for showing the divs but once I scroll back to the top they hide.

```
$(window).scroll(function() {
    if ($(this).scrollTop() > 0) {
        $("#tip-2").show();
        $("#now-available").show();
    } else {
        $("#tip-2").hide();
        $("#now-available").hide();
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:32:40.193

How about...

```
var madeVis = false;

$(window).scroll(function() {
    if ($(this).scrollTop() > 0) {
        $("#tip-2").show();
        $("#now-available").show();
        madeVis = true;
    } else if (!madeVis) {
        $("#tip-2").hide();
        $("#now-available").hide();
    }
}); 
```

# java - Findbugs Maven plugin ignores threshold

> ID：10645245
> 
> 赞同：3
> 
> 时间：2012-05-18T00:29:16.503
> 
> 标签：java, maven, findbugs, pom.xml

I'm using the following in my project's pom.xml file. Running a `findbugs:check` goal still fails on all errors, even when no High priority errors are present. What am I doing wrong?

```
<plugin>
<groupId>org.codehaus.mojo</groupId>
<artifactId>findbugs-maven-plugin</artifactId>
<version>2.4.0</version>
<executions>
  <execution>
    <id>failing-on-high</id>
    <phase>process-test-resources</phase>
    <goals>
      <goal>check</goal>
    </goals>
    <configuration>
      <threshold>High</threshold>
      <onlyAnalyze>com.example.-</onlyAnalyze>
    </configuration>
  </execution>
</executions> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T09:21:42.363

查看[文档](http://mojo.codehaus.org/findbugs-maven-plugin/check-mojo.html)并在示例代码库上进行尝试，它看起来像`findbugs:check`目标

> 如果源代码中存在***任何***FindBugs 违规，则构建失败。

这似乎不依赖于[threshold](http://mojo.codehaus.org/findbugs-maven-plugin/check-mojo.html#threshold)的值。

另请查看[此博客条目](http://kohsuke.org/2011/08/23/my-epic-battle-with-findbugs-maven-plugin-and-how-i-utterly-lost/)，该条目似乎描述了一个相关问题。

# android - Intermittent Android NDK UnsatisfiedLinkError

> ID：10645249
> 
> 赞同：3
> 
> 时间：2012-05-18T00:29:44.583
> 
> 标签：android, android-ndk, java-native-interface

I have been getting sporadic, difficult to reproduce UnsatisfiedLinkErrors, most commonly when my application has been paused for a long time (i.e., hours). These errors occur on JNI calls that normally work.

Does Android sometimes unload a library without completely closing an application? I load my native library in one activity but also use it in another activity. Could Android be destroying the activity that loaded the library and unloading it, then failing to reload the library when the other activity that uses it is resumed?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T03:55:11.233

每次您使用这样的 Activity 加载库时，

```
 static {
        System.loadLibrary("gamescript");
    } 
```

然后库像本地静态成员一样在 Activity 类中加载，并且在应用程序处于活动状态之前不会被卸载。但是，我怀疑它是否可以从课堂外访问。

# html - css dynamic icon layout without refresh, similar to amazon's website

> ID：10645250
> 
> 赞同：0
> 
> 时间：2012-05-18T00:29:47.157
> 
> 标签：html, css, layout, dynamic, amazon

I'm fairly new to stylesheet so this maybe a very simple question. I noticed that Amazon's website has 2 really cool features that I would like to replicate.

1.  At the middle of the page, there is a grid that lay out icons horizontally for their recommendations and other stuff. Depending on the width of the page, it shows either 4 or 5, or 6 up to 8 icons/items horizontally. They do this without refreshing the page. I tried to read the source, but it looks like a bunch of stylesheet trick that is making this happen.

2.  The "Shop by Department" on the left is also very interesting. If your page is narrow, it disappears, but it shows up when you mouseover. If the page is wide, then it shows up.

If anyone can point me to the right direction or some sample code, it would be great. Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:58:14.763

问题一：

这不仅仅是CSS。

使用表格在每一行中存储您想要的任意数量的元素，然后为整个表格设置一般宽度。

使用 javascript/jquery 根据该表大小计算每个元素的宽度。

问题 2： [http](http://www.dynamicdrive.com/style/layouts/item/css-liquid-layout-31-fixed-fluid-fixed/) ://www.dynamicdrive.com/style/layouts/item/css-liquid-layout-31-fixed-fluid-fixed/ 你可能想看看那个。据我在亚马逊网站上看到的，侧边栏永远不会消失。

编辑：

1.假设你有一个 1000px 宽度的页面。2.为侧边栏设置左侧的前 200 像素。3.使用jQuery检查当前页面宽度。4.如果pageWidth<1000px, sidebar{display:none;}

但实际上，这些代码在网络上无处不在。

# java - 分页问题

> ID：10645252
> 
> 赞同：1
> 
> 时间：2012-05-18T00:29:51.807
> 
> 标签：java, graphics, pagination

我这里有一些用于打印的代码，它从每页一个数组中打印一个信息块。

```
 double x = pf.getImageableX() + 1;
    double y = pf.getImageableY();
    double xMax = pf.getImageableWidth();
    double yMax = pf.getImageableHeight();

    if ((pageIndex < generation.length)) {
    //Graphics code
    y += (height of index) + 10;
    return PAGE_EXISTS; 
} else {
    return NO_SUCH_PAGE;
}
} 
```

我想让索引不断增加，每页打印更多对象，直到 y 超过 yMax。那时，y 将重置，我可以继续在下一页上打印对象。

然而 print() 方法本身是递归的；因此，如果我尝试引入一个 for 循环，它只会一遍又一遍地打印相同的条目，直到 (pageIndex < generation.length)。

当 y > yMax 时如何打印新页面，同时还能打印数组中的所有元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:32:37.257

我不完全理解你的递归是如何工作的。也许看到电话会有所帮助。

如果此时 pageIndex 表示您所在的页面以及您在数组中的位置，则需要对其进行拆分。

```
int page; //what page you are on
int pageIndex; //where the element is on the page
int index; //where you are up to in the array 
```

您将需要另一个案例来了解您是否仍在页面上或页面是否已完成。

```
if ((index < generation.length)) {
//Graphics code
y += (height of pageIndex) + 10;
    if(y > yMax){
        y = 0;
        pageIndex = 0;
        page++;
        return PAGE_EXISTS; 
    } else {
        pageIndex++;
        return PAGE_NOT_FULL; 
    }
} else {
    return NO_SUCH_PAGE;
} 
```

同样，这可能不是您要寻找的，但这是我根据您的代码段做出的最佳猜测。

# api - Salesforce SOQL 查询以查找机会，给定其父帐户 ID？

> ID：10645254
> 
> 赞同：0
> 
> 时间：2012-05-18T00:30:20.530
> 
> 标签：api, salesforce, soql

给定其父帐户的帐户 ID，您如何编写 SOQL（Salesforce 查询语言）查询来查找机会？

我想做这样的事情（虽然不起作用）：

```
SELECT Id, Name FROM Opportunity WHERE AccountId = '003D000000f0gfH' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T01:42:24.630

您的查询很好，但您没有 AccountId，003 前缀 id 用于联系人。

# android - Conversion to Dalvik format failed with error 1 adt r18

> ID：10645262
> 
> 赞同：5
> 
> 时间：2012-05-18T00:31:30.530
> 
> 标签：android, adt, actionbarsherlock, acra

although there are many questions with a similar title, I could not find the solution to this issue.

I have an Android project in Eclipse which references ActionBarSherlock 4.0.2 as Android library. In addition, I have added the JARs for ACRA and Google Analytics in the /libs folder. The support v4 jar is taken from ABS libs.

The project's Java Build Path looks like this ![enter image description here](../Images/9079b9ddbeef2aabb9bed1ea9cedc432.png)

When exporting through the wizard I get the "Conversion to Dalvik format failed with error 1" error.

Cleaning, removing all Android Dependencies and clicking on Fix Project Properties and cleaning does all not work.

Any idea?

**EDIT:**

I missed some info: I'm doing this on Mac OS 10.6.8, Eclipse Indigo, Android SDK Tools r19 and ADT plugin v18\.

project.properties file includes the proguard.cfg file: commenting it does avoid the issue.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:04:38.450

我实际上设法克服了这个问题，如果它们对任何人有用，这里有一些详细信息：

我首先尝试了从清理到关闭/重新打开项目等的一切

我终于也[从 http://sourceforge.net/projects/proguard/files/](http://sourceforge.net/projects/proguard/files/)获得了最新的 proguard 测试版，并将 android-sdk-macosx/tools/proguard 中的 /lib 文件夹替换为 beta 版中的那个（proguard4.8beta1 ）和..它的工作原理！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T10:43:56.650

更新到 ADT 20（与 Jelly Bean 一起发布）后，我遇到了同样的问题，同样，所有旧的解决方案（清理、重建等）都没有帮助。从 omoling 的回答中得到线索，我将 Flurry jar 更新为他们网站上的最新版本……问题就解决了。

因此，如果您遇到此问题，请尝试更新您的项目使用的任何/所有外部库。

# cakephp - CakePHP 中的中间模型/关联表

> ID：10645263
> 
> 赞同：0
> 
> 时间：2012-05-18T00:31:40.323
> 
> 标签：cakephp, database-design, associations

我有一个场景，我正在努力寻找一个干净的解决方案。在我的 CakePHP 应用程序中，我有一个用户和调查模型。这个想法是管理员可以创建调查，并将它们分配给用户。然后，用户可以回复调查（多次）并存储这些回复。

现在，我打算制作一个响应模型，并通过 hasMany/belongsTo 将响应与用户相关联。简单的。问题在于将调查分配给用户。由于用户将能够回复多个调查，因此尝试将“survey_id”列添加到我的用户表以进行关联是没有意义的。

最有意义的是一个新的survey_assignments 表，它具有id、survey_id 和user_id 列。

问题是我不清楚如何干净地处理这种中介关联表，坚持使用 CakePHP 最佳实践。我需要做的是在直接的 php/mysql 中相当标准，但我想避免直接的 SQL 查询，并保持符合 CakePHP 约定。

在避免手动查询的同时，创建和使用（可能是无模型的）关联表的最简洁方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:04:32.133

当然，我在发布后找到了答案：

与连接表的 HABTM 关联！

# jquery - nicedit textarea width inside of jQuery UI accordion not working correctly

> ID：10645265
> 
> 赞同：3
> 
> 时间：2012-05-18T00:32:13.760
> 
> 标签：jquery, jquery-ui, textarea, jquery-ui-accordion, nicedit

I am using nicedit.js and jQuery UI accordion.
I have several accordions that contain these nicedit WYSIWYG text areas.

When I refresh the page the first accordion area opens up and displays the correct nicedit WYSIWYG area (Width is 100%).
When I select another accordion area it opens up and displays the nicedit WYSIWYG area but it is only 100px wide.

I did some digging around in the code and found that it uses 100% as a width throughout the building process. I have run into this with jQuery UI accordion not letting things render correctly before and have just destroyed the id and reinitialize it.

I am looking for a solution that will allow all nicedit WYSIWYG areas to render 100% or even a fixed width.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T11:12:07.423

我建议您订阅手风琴的*change*事件，并在这些事件上初始化 WYSIWYG 编辑器，如果它们之前没有被初始化的话。我不熟悉 nicedit 或他们的编辑器是如何构造的，但如果它动态计算大小，那么除非 HTML 容器可见，否则它不能这样做。因此，更改事件将使您使容器可见，以便正确计算大小。

# inno-setup - Inno Setup：排除目录及其文件

> ID：10645269
> 
> 赞同：7
> 
> 时间：2012-05-18T00:32:27.710
> 
> 标签：inno-setup

我在 Inno Setup 中使用“排除”标志，以便根据用户的体系结构从安装中排除子目录名称“Bin32”或“Bin64”。

我想要的只是不要安装无用的文件夹及其所有文件和子目录。

这是我目前的规则：

```
[Files]
Source: "Z:\Work\temp\*"; DestDir: "{app}"; Flags: ignoreversion recursesubdirs createallsubdirs

; Exclude
Source: "*"; Excludes: "\Bin64"; DestDir: "{app}"; Flags: recursesubdirs; Check: not Is64BitInstallMode
Source: "*"; Excludes: "\Bin32"; DestDir: "{app}"; Flags: recursesubdirs; Check: Is64BitInstallMode 
```

首先，我不太明白排除规则开头的“*”代表什么？其次，它适用于 Bin32/64 文件夹中的所有子目录，但文件仍然已安装，我无法找到不安装它们的方法......

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T14:11:36.967

每个条目都是一个单独的操作，不受任何其他条目的影响。考虑到这一点，会发生以下情况：

1.  第一行从`z:\work\temp`.
2.  第二行，如果在 32 位模式下，安装`SourceDir`除了`\Bin64`
3.  第 3 行，如果在 64 位模式下，安装所有内容，`SourceDir`除了`\Bin32`

我希望您的`SourceDir`（如果未指定脚本路径）与此相同`Z:\Work\Temp`，因此您基本上最终还是安装了所有东西。

如果您复制第一个条目，并将`Excludes`（不带 \ 前缀）和`Check`参数移到它上面，它应该可以按您的要求工作：

```
[Files]
Source: "Z:\Work\temp\*"; Excludes: "Bin64"; DestDir: "{app}"; Flags: ignoreversion recursesubdirs createallsubdirs; Check: not Is64BitInstallMode
Source: "Z:\Work\temp\*"; Excludes: "Bin32"; DestDir: "{app}"; Flags: ignoreversion recursesubdirs createallsubdirs; Check: Is64BitInstallMode 
```

# ruby-on-rails - CSS 属性不会消失

> ID：10645270
> 
> 赞同：1
> 
> 时间：2012-05-18T00:32:38.097
> 
> 标签：ruby-on-rails, css, stylesheet, assets

Rails 3.2.3 出现问题

我在 /assets/stylesheets 中有 3 个 CSS 文件：

*   application.css（有 require_self 和 require_tree 。）
*   引导程序.css
*   我的应用程序.css

在 localhost:3000 上运行 rails 服务器，一切正常

每当我更改 CSS 属性时，它都会在视图中更新（例如更改颜色）。但是，每当我删除 CSS 属性时，什么都没有发生。事实上，我可以从所有 CSS 文件中删除所有文本，并且什么都不会改变。

我试过重置一切：rails服务器，清除浏览器一切，重新启动所有程序，无济于事。

有谁知道出了什么问题？

编辑：这个问题是我跑后开始的

```
rake assets:precompile 
```

并且当我从静态 CSS 文件中删除属性时的“后备”CSS 样式（即默认设置）基于我上次运行 rake assets:precompile 时 CSS 文件的样子

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T03:05:12.837

```
Rake assets:clean 
```

将为您工作，因为您将在您的公共文件夹中编译 css 和 javascript 文件，因此通过删除这些您的问题将得到解决。

# c - c++库可以在c中运行吗？

> ID：10645273
> 
> 赞同：1
> 
> 时间：2012-05-18T00:33:12.043
> 
> 标签：c

如果这是一个基本问题，我很抱歉（我是 C/C++ 新手，但我对如何获得答案有点困惑 [。stxxl](http://stxxl.sourceforge.net/)是一个 C++ 库，但我的一些代码是 C 语言。我知道c++ 可以使用 c 代码（我的 c 代码嵌入在 c++ 中），但它是否可以反过来工作，所以 c 可以运行 c++ 代码？

他们的网站只提到了 c++，但我想知道是否可以做一些特别的事情来在 c 中运行 c++ 库？

抱歉，我读过的书都是关于在 c++ 中使用 c 代码的，而我读过的 c 书是在 c++ 出现之前写的。现在我的 c 函数正在向使用 c++ 库的 c++ 代码发送数据，然后将结果发回，所以我想如果我切断中间人（c++），我想测试性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:39:49.613

这是一个可以帮助您的链接： [如何混合 C 和 C++](http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T00:40:00.327

只有当 C++ 库被设计为从 C 中使用时，您才能从 C 链接到 C++ 库。具体来说，库提供的函数需要使用`extern "C" {}`块导出以避免名称修改，并且接口应该以某种方式设计可以从普通 C 中使用（即没有类或成员函数，只有无功能的结构和普通函数）。

值得一提的是，您可以使用 C++ 编译器编译您的 C 代码，而且大部分情况下都可以。这使您可以假装您的 C 代码是 C++ 代码，并且可以自由地混合通过 C++ 特定接口提供的功能。

# python - 重组文本中的全局包含

> ID：10645276
> 
> 赞同：1
> 
> 时间：2012-05-18T00:33:46.717
> 
> 标签：python, jekyll, restructuredtext, docutils, hyde

我正在为我的博客/网站使用 reStructuredText，并且我想添加一个全局包含文件。我可以访问并很高兴更改用于生成 html 输出的设置文件，但我无法弄清楚其中任何一个的语法：

1.  将默认包含文件添加到解析器
2.  在 python 中使用 docutils 在 python 中定义指令/内联角色等

我尝试阅读源代码和文档，但发现它有点难以理解。我希望我只是错过了一些非常明显的事情，但我想做类似以下的事情（第一部分就是已经存在的——**你可以[在 jekyll-rst 插件中看到文件的其余部分来源（指向它的链接）](https://github.com/xdissent/jekyll-rst/blob/master/transform.py)**

```
import sys
from docutils.core import publish_parts
from optparse import OptionParser
from docutils.frontend import OptionParser as DocutilsOptionParser
from docutils.parsers.rst import Parser

# sets up a writer that is then called to parse rst pages repeatedly
def transform(writer=None, part=None):
    p = OptionParser(add_help_option=False)

    # Collect all the command line options
    docutils_parser = DocutilsOptionParser(components=(writer, Parser()))
    for group in docutils_parser.option_groups:
        p.add_option_group(group.title, None).add_options(group.option_list)

    p.add_option('--part', default=part)

    opts, args = p.parse_args()

# ... more settings, etc

# then I just tell the parser/writer to process specified file X.rst every time
# (or alternately a python file defining more roles...but nicer if in rst) 
```

有没有一种简单的方法可以做到这一点？`defaults.rst`定义一个文件并每次都加载它会很棒。

编辑：这里有一些我希望能够全局包含的示例（自定义指令也很好，但我可能会在代码中编写这些指令）

```
.. role:: raw-html(raw)
   :format: html

.. |common-substitution| replace:: apples and orange

.. |another common substitution| replace:: etc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T08:02:03.440

我不太确定我是否理解这个问题。例如，您想在某个文件中定义一些替换，并在所有其他 reStructuredText 文件中使用这些替换，还是想在输出文件中包含一些常见的 HTML？你能澄清你的问题吗？

如果您想要的是前者，您可以使用该[`include`](http://docutils.sourceforge.net/docs/ref/rst/directives.html#include)指令，正如我在[此答案](https://stackoverflow.com/a/9785223/623518)中概述的那样。

或者，如果您希望在生成的输出中包含一些常见的 HTML，请尝试复制和编辑`template.txt`包含在模块中的文件`path/to/docutils/writers/html4css1/`。您可以在此文件中包含任意 HTML 元素并修改 Docutils 生成的 HTML 的布局。这些方法都不需要您修改 Docuitls 源代码，这始终是一个优势。

**编辑**：我认为不可能设置一个标志来使用 Docuitls 设置包含文件。但是，如果您可以使用基于 Docuitls 但具有大量扩展的[Sphinx](http://sphinx.pocoo.org/index.html)[`rst_prolog`](http://sphinx.pocoo.org/config.html#confval-rst_prolog) ，那么此软件包的设置正是您需要的（请参阅[此答案](https://stackoverflow.com/a/9707879/623518)）。`rst_prolog`是：

> 一个 reStructuredText 字符串，将包含在每个读取的源文件的开头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-28T20:15:44.410

我需要完全相同的东西：一种将一些全局 reStructuredText 文件自动导入到每篇 reStructuredText 文章中的方法，而无需每次都手动指定它们。

解决此问题的一种方法是以下插件：

```
import os
from pelican import signals
from pelican.readers import RstReader

class RstReaderWrapper(RstReader):
      enabled = RstReader.enabled
      file_extensions = ['rst']

      class FileInput(RstReader.FileInput):
          def __init__(self, *args, **kwargs):
              RstReader.FileInput_.__init__(self, *args, **kwargs)
              self.source = RstReaderWrapper.SourceWrapper(self.source)

      # Hook into RstReader
      RstReader.FileInput_ = RstReader.FileInput
      RstReader.FileInput = FileInput

      class SourceWrapper():
          """
              Mimics and wraps the result of a call to `open`
          """
          content_to_prepend = None

          def __init__(self, source):
              self.source = source

          def read(self):
              content = self.source.read()
              if self.content_to_prepend is not None:
                  content = "{}\n{}".format(self.content_to_prepend, content)
              return content

          def close(self):
              self.source.close()

def process_settings(pelicanobj):
      include_files = pelicanobj.settings.get('RST_GLOBAL_INCLUDES', []) or []
      base_path = pelicanobj.settings.get('PATH', ".")

      def read(fn):
          with open(os.path.join(base_path, fn), 'r') as res:
              content = res.read()
              return ".. INLCUSION FROM {}\n{}\n".format(fn, content)

      inclusion = "".join(map(read, include_files)) if include_files else None
      RstReaderWrapper.SourceWrapper.content_to_prepend = inclusion

def register():
signals.initialized.connect(process_settings) 
```

简而言之：

*   从上面的代码创建一个插件（最好从 GitHub克隆[存储库）](https://github.com/mhoff/pelican-global-rst-include)
*   导入插件（适配`PLUGINS`于`pelicanconf.py`）
*   通过将变量设置`RST_GLOBAL_INCLUDES`在`pelicanconf.py`

请注意，pelican 和 docutils 都不是为了允许这样做而设计的。既没有提供在处理开始之前提供对源文件原始内容的干净访问的信号，也没有可能拦截以“正常方式”读取文件的框架（如子类化、更改硬编码配置等） . 这个插件继承了内部类并设置了子类`FileInput`的**类引用**。python 文件对象也通过. 不过，这种方法对我有用，在日常工作流程中并不繁琐。`RstReader`**`RstReader.FileInput``SourceWrapper`**

 ***我知道这个问题来自 2012 年，但我认为这个答案仍然对其他人有帮助。***

# algorithm - 从未排序的数组生成二进制堆的时间复杂度

> ID：10645280
> 
> 赞同：1
> 
> 时间：2012-05-18T00:34:40.390
> 
> 标签：algorithm, data-structures, big-o

谁能解释为什么使用自下而上的堆构造从未排序的数组生成二进制堆的时间复杂度是 O(n) ？

（目前找到的解决方案：我在Thomas and Goodrich的书中发现构建堆时内部节点的路径大小总和为2n-1，但仍然不明白他们的解释）

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T12:18:34.420

用于从未排序的数组生成二进制堆的正常*BUILD-HEAP*过程实现如下：

```
BUILD-HEAP(A)
 heap-size[A] ← length[A]
  for i ← length[A]/2 downto 1
   do HEAPIFY(A, i) 
```

这里*HEAPIFY*过程需要 O(h) 时间，其中 h 是树的高度，并且有 O(n) 个这样的调用使得运行时间 O(nh)。考虑到 h=lg n，我们可以说 *BUILD-HEAP*过程需要 O(n lg n) 时间。

为了进行更严格的分析，我们可以观察到大多数节点的高度都很小。实际上，在任何高度 h，最多可以有 CEIL(n/ (2^h +1)) 个节点，我们可以很容易地通过归纳证明这一点。所以，*BUILD-HEAP*的运行时间可以写成，

```
lg n                     lg n
∑ n/(2^h+1)*O(h)  = O(n* ∑ O(h/2^h)) 
h=0                      h=0 
```

现在，

```
∞   
∑ k*x^k = X/(1-x)^2
k=0              
               ∞ 
Putting x=1/2, ∑h/2^h = (1/2) / (1-1/2)^2 = 2
               h=0 
```

因此，运行时间变为，

```
lg n                     ∞   
O(n* ∑ O(h/2^h))  = O(n* ∑ O(h/2^h))  = O(n)
h=0                      h=0 
```

因此，这给出了 O(n) 的运行时间。

注：分析取自[于此](http://mitpress.mit.edu/catalog/item/default.asp?tid=8570&ttype=2)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T01:41:49.930

查看维基百科：

构建堆：可以通过连续插入来构建堆。这种方法需要 O(n log n) 时间，因为每次插入需要 O(log n) 时间并且有 n 个元素。然而，这不是最佳方法。最佳方法首先将元素任意放在二叉树上，同时尊重形状属性。然后从最低层开始向上移动，像删除算法一样向下移动每个子树的根，直到恢复堆属性。

[http://en.wikipedia.org/wiki/Binary_heap](http://en.wikipedia.org/wiki/Binary_heap)

# android - 如何在android服务中启动长时间运行的后台任务

> ID：10645298
> 
> 赞同：7
> 
> 时间：2012-05-18T00:37:03.850
> 
> 标签：android, service, background

在阅读了开发人员网站和 stackoverflow 上关于 Android 服务的大部分可用文档后，我仍然对在单独的任务中运行服务的几个方面感到困惑。希望有人能让我走上正轨。

假设我们有繁琐的服务框架，例如

```
public class HliService extends Service {

    @Override
    public void onCreate() {
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        // If we get killed, after returning from here, restart
        return START_STICKY;
    }

    @Override
    public IBinder onBind(Intent intent) {
        // We don't provide binding, so return null
        return null;
    }

    @Override
    public void onDestroy() {
    }
} 
```

在清单中，我有

```
<service android:name=".HliService" android:process=":HLI_Comms"/> 
```

以便服务在自己的线程中运行。

该服务的目的是提供一个后台任务，该任务将使用 TCP 套接字与设备进行通信并执行一些其他操作。冒着忽略电池问题等的风险，基本上我希望它永远运行。

就像是

```
// Method that communicates using a TCP socket, and needs to send
// information back to the activity and receive messages from activity
// not shown here.
private void dummytask() {

    boolean keepGoing = true;
    while (keepGoing) {
        // do useful stuff in here
        // sets keepGoing false at some point
    }
    stopSelf();
} 
```

启动此方法/任务的最佳方法是什么？

我查看了使用消息处理程序和循环器的开发人员站点中的代码，我只是部分理解，但它似乎非常复杂，也许比我需要的更多？

我不相信我可以从中调用此方法，`onCreate()`或者`onStartCommand()`从那时起，从系统调用时都不会完成？我应该用计时器还是闹钟启动它？

我需要添加一个消息处理程序来与 gui 活动进行通信，但是由于我在另一个线程中启动服务（通过清单“进程”指令），我是否需要使用 AIDL 来代替？

我还研究过使用 AysnchTask 而不是扩展服务，但它似乎更适合运行任务然后终止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:53:30.237

> 以便服务在自己的线程中运行。

这将服务置于自己的*进程中*。这通常是要避免的，因为它会消耗额外的 RAM 和 CPU（对于 IPC）。您可以通过创建一个`Thread`或任意数量的其他方式来创建线程，其中大多数已经在 J​​ava 中使用了十年左右。

> 冒着忽略电池问题等的风险，基本上我希望它永远运行。

服务几乎不可能永远运行。用户或操作系统最终会摆脱您的服务。

> 启动此方法/任务的最佳方法是什么？

`dummytask()`从后台线程调用。

> 我需要改用 AIDL 吗？

不可以。您的服务可以广播`Intent`，或调用活动提供的 a ，或通过`PendingIntent`活动提供的 a 发送 a等。最好是使用Android 支持包中的 ，但这不能跨进程边界工作，迫使您选择更昂贵的通信选项。`Message``Messenger``LocalBroadcastManager`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:02:38.440

我认为您可以`IntentService`通过设置带有 a 的（常规）警报 ( `AlarmManager.setRepeating`) 来使用您运行的 a `PendingIntent`。您可以通过从 广播 Intent`IntentService`并通过在您的 UI 中接收它来通知 UI `BroadcastReceiver`。

# json - json-tinyurl - 超过可用的配额

> ID：10645299
> 
> 赞同：1
> 
> 时间：2012-05-18T00:37:21.323
> 
> 标签：json, tinyurl

当我尝试使用 json-tinyurl 时遇到了一些问题。当我使用[这个](http://json-tinyurl.appspot.com/?url=http://simonwillison.net/)

我收到这条消息：*foo({"ok": false, "error": "API 调用 urlfetch.Fetch() 需要的配额比可用配额多。"})*

[这里](http://json-tinyurl.appspot.com/?&callback=?)还有这条消息：“围绕*[TinyURL API](http://tinyurl.com/api-create.php?url=http://json-tinyurl.appspot.com/)**的 JSON（和 JSON-P）包装器。* ”

所以我的问题如下。我刚刚描述的意思是 a) 由于临时问题（配额不可用），我应该等待一段时间，问题将得到解决，或者 b) 我应该转移到被提议为“包装器”的 TinyURl API？

# ruby-on-rails - 乘客：RackEnv 还是 RailsEnv？

> ID：10645303
> 
> 赞同：0
> 
> 时间：2012-05-18T00:37:48.983
> 
> 标签：ruby-on-rails, ruby, passenger

我正在尝试设置一个未调用的自定义开发环境，`development`而是使用特定于该环境的配置扩展开发环境。创建此自定义环境可能不是一个好主意，因为可能有些地方将开发环境称为`development`. 无论如何，我正在尝试决定如何设置这个环境。在我的虚拟主机配置中，我最初指定`RackEnv`为开发，但这是一个 Rails 应用程序，所以我的问题是，我应该设置`RackEnv`还是`RailsEnv`我的新`customDevelopment`环境？我正在访问当前的 rails 环境，`Rails.env`如果这有所作为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:48:50.547

使用 RailsEnv。RackEnv 用于托管纯基于 Rack 的应用程序。

# jquery - 提交表单执行ReST服务然后提交

> ID：10645305
> 
> 赞同：0
> 
> 时间：2012-05-18T00:38:18.677
> 
> 标签：jquery, ajax, submit

我有一个表单，当您提交它时，它首先对 ReST 服务执行 Ajax 调用以进行验证

如果 ReST 返回成功，我想通过 POST 将表单提交到正确的页面

html

```
<form id="purchaseForm">....</form> 
```

jquery 使用验证后处理表单

```
$('#purchaseForm').submit(function(){

.... validation
then

data = ($('#purchaseForm').serialize());

          $.ajax({
              url: 'pp_order.php',
              type: 'POST',
              data: data,
              cache: false,
              dataType: 'json',
              success: function(ret){
                 if (ret.Status == 'Failure'){
                    pp_error();

                }
                else{
                    $('#purchaseForm').attr('action', 'user_profile.php')
                    form[0].submit();
                }
              }

              });
}); 
```

# objective-c - UIImage的线程安全

> ID：10645307
> 
> 赞同：7
> 
> 时间：2012-05-18T00:38:32.290
> 
> 标签：objective-c, ios, thread-safety

我知道 Apple 官方推荐 UIKit 只在主线程中使用。但是，我也听说 UIImage 自 iOS 4.0 以来是线程安全的。我找不到任何支持这一说法的文件。

有没有人有任何信息来支持这种说法？UIImage 作为一个用于存储数据和解码图像数据的类，如果设计得当，它应该是线程安全的。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2014-05-13T21:40:24.213

直接来自[Apple 的 UIImage 文档](https://developer.apple.com/library/ios/documentation/uikit/reference/UIImage_Class/Reference/Reference.html)

> 图像对象是不可变的，因此您无法在创建后更改它们的属性。这意味着您通常在初始化时指定图像的属性或依赖图像的元数据来提供属性值。**这也意味着图像对象本身可以安全地从任何线程使用。**更改现有图像对象的属性的方法是使用一种可用的便捷方法来创建图像的副本，但具有您想要的自定义值。

（强调我的）

因此，至少在截至 2014 年 5 月 13 日的当前 SDK 版本中，“图像对象本身可以安全地从任何线程使用。”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T00:55:08.227

确实，苹果建议在主线程上使用 UIKIt 中的元素：

> 注意：在大多数情况下，UIKit 类只能在应用程序的主线程中使用。对于从 UIResponder 派生的类或涉及以任何方式操作应用程序的用户界面的类尤其如此。

由于 UIImage 不是从 UIResponder 派生的，因此您实际上并没有在界面/屏幕上显示它。然后在另一个线程上对 UIImages 进行操作应该是安全的。

然而，这是基于我的经验，我还没有看到任何关于它的官方文档。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-03-21T06:31:07.773

自从此处发布了较早的答案以来，Apple 似乎已经更新了他们的文档。根据最新的文档，从任何线程创建和使用 UIImage 实例都是安全的：

> 由于图像对象是不可变的，因此您无法在创建后更改它们的属性。大多数图像属性是使用随附图像文件或图像数据中的元数据自动设置的。图像对象的不可变特性也意味着它们可以**安全地从任何线程创建和使用**。

[https://developer.apple.com/reference/uikit/uiimage](https://developer.apple.com/reference/uikit/uiimage)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-02T19:27:40.610

在[iOS 中的新增功能：iOS 4.0](https://developer.apple.com/library/ios/#releasenotes/General/WhatsNewIniPhoneOS/Articles/iPhoneOS4.html)发行说明中，UIKit 框架的增强包括以下内容：

> 在 UIKit 中绘制到图形上下文现在是线程安全的。具体来说：用于访问和操作图形上下文的例程现在可以正确处理驻留在不同线程上的上下文。字符串和图像绘制现在是线程安全的。现在可以安全地在多个线程中使用颜色和字体对象。

所以 UIImage 在 iOS 4.0 及更高版本上是线程安全的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-12T18:02:42.223

简而言之：UIImage 不是线程安全的，或者更好的是只在主线程上工作，正如我在调试后所经历的那样。

我希望这会有所帮助。我希望从 Apple 或更好的 UIImage 类中更清楚地了解这一点，它可以在不同的线程中呈现。应该不会太难...

编辑：经过一番研究，我发现它是“UIGraphicsGetImageFromCurrentImageContext();” 这导致了麻烦。这有点偏离主题，但也许这会有所帮助： [https ://coderwall.com/p/9j5dca](https://coderwall.com/p/9j5dca)

感谢扎卡里·沃尔多夫斯基。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-07-03T03:02:39.440

线程安全不是问题，因为任何线程都可以尝试同时（同时）访问上下文。而且，虽然这通常没问题，但在内存不足的情况下，例如 iOS 设备上的照片编辑扩展程序，访问一个上下文的两个线程可能会由于内存不足而导致应用程序崩溃。

将 Core Image 过滤器与 vImage 操作混合时会发生这种情况。两者都是线程安全的，但 ARC 不会在处理 Core Image 对象之前释放 vImage 缓冲区数据，因此您有时在内存中有两个图像副本。

因此，如果不了解线程和并发，你永远不会认为你对线程安全的了解是完整的——这对于任何关于线程安全的问题的答案都是加倍的。简而言之：正确的问题是，每当您谈论图像处理时，线程安全性如何应用于内存使用。

如果您只是在这里踢轮胎，则需要等到遇到真正的问题后再提出问题。但是，如果您正在计划下一步行动，您需要知道如何按顺序执行图像处理命令，并使用手动解除分配。您必须设计您的应用程序，以便在内存中只有一个正在处理的图像副本。永远不要依赖自动释放（线程安全与否）来为您进行调用。不起作用。

# javascript - JS 正则表达式匹配字符串与 $

> ID：10645311
> 
> 赞同：2
> 
> 时间：2012-05-18T00:38:43.887
> 
> 标签：javascript, regex

我正在尝试写一些可以查看推文并提取推文中提到的股票信息的东西。人们使用 $ 来引用 Twitter 上的股票代码，但我无法逃避 $。

我也不想匹配任何价格提及或类似的东西，所以基本上匹配 $AAPL 而不是 $1500

我在想它会是这样的

```
\b\$[a-zA-Z].*\b 
```

如果有多个匹配 id 喜欢以某种方式循环它们，比如

```
while ((tweet = reg.exec(sym_pat)) !== null) {
   //replace text with stock data.
} 
```

这个表达式给了我一个意外的非法令牌错误

```
 var symbol_pat = new RegExp(\b\$[a-z]*); 
```

如果您想查看我在 [$.each 范围内遇到 Javascript AJAX 范围的下一个问题，感谢您的帮助](https://stackoverflow.com/questions/10645706/javascript-ajax-scope-inside-of-each-scope)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:55:16.670

好的，您已经声明您想用它们的实际库存值替换匹配项。因此，您需要获取所有匹配的元素（股票代码名称），然后对于每个匹配项，您将用股票值替换它。

答案将与该句子非常相似地“阅读”。

假设有一个`tweet`变量是您要处理的特定推文的内容：

```
tweet.match(/\b\$[A-Za-z]+\b/g).forEach(function(match) {
    // match looks like '$AAPL'
    var tickerValue = lookUpTickerValue(match);
    tweet.replace(match, tickerValue);
}); 
```

这是假设您在某处有一些逻辑可以获取给定股票名称的股票代码值然后替换它（如果找不到匹配项，它可能应该返回原始值，因此您不会破坏可爱的推文，例如“芭芭拉史翠珊是 $ATAN")。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T00:53:10.910

```
var symbol_pat = new RegExp('\\b\\$[a-z]+\\b','gi');
// or
var symbol_pat = /\b\$[a-z]+\b/gi; 
```

此外，由于某种原因，JS 无法通过 计算单词的开头`\b`，它只会捕获末尾的单词。

**编辑：**如果您要替换股票代码，您可以`replace`通过函数使用基本方法并将该数据替换为预定义值：

```
var symbol_pat = /(^|\s)(\$[a-z]+\b)/gi;
var stocks = {AAPL:1,ETC:2}
var str = '$aapl ssd $a a$s$etc $etc';
console.log(str);
str = str.replace(symbol_pat, function() {
    var stk = arguments[2].substr(1).toUpperCase();
    // assuming you want to replace $etc as well as $ETC by using
    // the .toUpperCase() method
    if (!stocks[stk]) return arguments[0];
    return arguments[0].replace(arguments[2],stocks[stk]);
});
console.log(str); 
```

# visual-studio-2010 - Visual Studio 2010 中的 freeglut 问题

> ID：10645312
> 
> 赞同：0
> 
> 时间：2012-05-18T00:39:18.377
> 
> 标签：visual-studio-2010, opengl, freeglut, glew

我一直在尝试安装 glew 和 freeglut 以与 Visual Studio 2010 一起使用。我遵循了本[指南](http://openglbook.com/setting-up-opengl-glew-and-freeglut-in-visual-c/)并回溯了几次以确保我正确地遵循了它，但是当我尝试编译示例代码时仍然出现以下错误结束：

> 错误 1 ​​error LNK2019: unresolved external symbol _ *imp* _glutMainLoop@0 在函数 _main c:\Users\Esteban\documents\visual studio 2010\Projects\Chapter 1 Project\Chapter 1 Project\main.obj Chapter 1 Project 中引用
> 
> 错误 2 错误 LNK2019：未解析的外部符号_imp *_glutDisplayFunc* @4 在函数 _InitWindow c:\Users\Esteban\documents\visual studio 2010\Projects\Chapter 1 Project\Chapter 1 Project\main.obj Chapter 1 Project 中引用
> 
> 错误 3 error LNK2019: unresolved external symbol _ *imp* _glutReshapeFunc@4 referenced in function _InitWindow c:\Users\Esteban\documents\visual studio 2010\Projects\Chapter 1 Project\Chapter 1 Project\main.obj Chapter 1 Project
> 
> 错误 4 error LNK2019: unresolved external symbol _ *imp* _glutInitDisplayMode@4 referenced in function _InitWindow c:\Users\Esteban\documents\visual studio 2010\Projects\Chapter 1 Project\Chapter 1 Project\main.obj Chapter 1 Project

和更多类似的。我不知道它是否有问题，但最初我不小心抓住了 64 位版本。我意识到我的错误并用 32 位版本覆盖了文件，然后清理并再次尝试构建，结果相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:20:58.630

您确定您已正确完成链接指南中的“第 6 步：项目设置（链接器）”吗？链接器似乎无法找到在这些库（glew 和 glut32.lib）中定义的符号。还要确保 Visual Studio 知道在哪里可以找到这些库（项目-> 属性-> 配置属性-> VC++ 目录-> 库目录）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:58:00.140

所有未解析的外部符号都应在 freeglut.lib 中找到。你确定你正确链接到这个库吗？

您可以在其中一个头文件中插入以下代码行，而不是尝试在其中完成此操作：

```
#pragma comment(lib, "freeglut.lib") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T09:02:11.907

我也有这个问题。原来我使用的是 Visual Studio 的 express 版本，所以我必须下载 microsoft sdk 才能获得 64 位 openGL 库。基本上，我发现本指南更有帮助：[http ://www.cs.uregina.ca/Links/class-info/315/WWW/Lab1/GLUT/windows.html](http://www.cs.uregina.ca/Links/class-info/315/WWW/Lab1/GLUT/windows.html)

# php - iOS 5- 使用 NSURLRequest 发送 json 并通过 $_POST 在 php 中解析

> ID：10645317
> 
> 赞同：2
> 
> 时间：2012-05-18T00:40:10.167
> 
> 标签：php, objective-c, json

我已经查看了我能找到的所有类似问题，但似乎没有一个适合我的情况，这似乎很简单。

1.  我正在使用 POST 创建一个简单的 NSURLRequest，并使用 NSJSONSerialization 类将其主体设置为 NSDATA 构建。
2.  我正在测试一个非常简单的 php 脚本来捕获该数据。

3.  如果我使用 json_decode(file_get_contents('php://input'),1); 在 PHP 中获取值，则代码可以正常工作 但根本不使用 $_POST

4.  出于安全原因，我被告知服务器无法启用 file_get_contents() ...所以我正在寻找替代方案。

这是我创建请求的 Obj-C 代码：

```
 NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://www.techno-mac.org/dev101/jsonForm.php"]];
[request setHTTPMethod:@"POST"];

NSMutableDictionary *jsonDict = [[NSMutableDictionary alloc] init];
[jsonDict setValue:self.userNameField.text forKey:@"userName"];
NSLog(@"Dict: %@",jsonDict);

NSData *jsonData = [NSJSONSerialization dataWithJSONObject:jsonDict options:kNilOptions error:nil];
NSString *jsonString = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];
NSLog(@"JSON String: %@",jsonString);

//[request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
[request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
[request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];

[request setValue:@"json" forHTTPHeaderField:@"Data-Type"];
[request setValue:[NSString stringWithFormat:@"%d", [jsonData length]] forHTTPHeaderField:@"Content-Length"];
[request setHTTPBody: jsonData];
NSLog(@"jsonData: %@",jsonData);

self.postConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:true]; 
```

这是我运行它时的控制台日志，在 json 数据中编码的字段中键入“test”：

```
2012-05-17 20:26:19.417 RBWebServices[95037:f803] Dict: {
userName = test;
}

2012-05-17 20:26:19.418 RBWebServices[95037:f803] JSON String: {"userName":"test"}
2012-05-17 20:26:19.418 RBWebServices[95037:f803] jsonData: <7b227573 65724e61 6d65223a   22746573 74227d>
2012-05-17 20:26:19.464 RBWebServices[95037:f803] Received response from server, resetting data length to zero
2012-05-17 20:26:19.465 RBWebServices[95037:f803] Succeeded! Received 12 bytes of data 
```

这是我非常简单的 php 脚本，它可以工作：

```
$json_post = json_decode(file_get_contents('php://input'),1);

$myArray = $json_post["userName"];
print $myArray; 
```

和没有的代码（返回“数组”）

```
$json_post = json_decode($_POST);
print $json_post["userName"]; 
```

如果我在 php 中输入：

```
var_dump($_POST) 
```

我收到：

```
array(0){} 
```

因为第一个场景有效，我倾向于认为 $_POST 是空的，这是原因......或者我试图从中得到一些东西的方式，但它似乎完全是空的。

如果使用 $_POST 这是不可能的，也许还有另一种不使用 file_get_contents 的方法？

我根本不是一个 php 专家......如果这看起来微不足道，我很抱歉。

感谢您提出的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:23:46.750

使用以下脚本进行的快速测试并`curl`演示了`$_POST`仅在使用键/值对时才填充。否则，它被认为是原始输入。

### 脚本：

```
var_dump($_POST);
var_dump(file_get_contents('php://input')); 
```

### 执行（原始数据）：

```
curl -X POST -d "whatever" http://jason.local/dev/server.php 
```

### 输出（空`$_POST`）：

```
array(0) {
}

string(8) "whatever" 
```

### 执行（键/值对）：

```
curl -X POST -d "data=whatever" http://jason.local/dev/server.php 
```

### 输出：

```
array(1) {
  ["data"]=>
  string(8) "whatever"
}

string(13) "data=whatever" 
```

这可能确实是 HTTP 规范或 PHP 内部的一部分。我相信其他人可以验证这一点。尽管如此，快速而肮脏的解决方法是使用键/值对。

# database - iPhone应用程序的图像托管

> ID：10645327
> 
> 赞同：0
> 
> 时间：2012-05-18T00:41:36.093
> 
> 标签：database, image

我目前正在开发一个显示许多用户上传图像的 iPhone 应用程序。图像存储在 Redhat Apache 服务器上……但加载速度非常慢。它本身不是图像服务器。

对于最佳加载速度推荐的优质图像服务器（付费或无偿）有什么建议吗？我环顾了 Stack，但找不到任何看起来可靠的东西。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T06:32:04.847

1) 您的带宽和磁盘空间要求是多少？2）你的预算是多少？

如果您的网站访问者在地理上分散，对于图像/CSS 和静态内容托管，我强烈建议使用 CDN 托管解决方案。“CDN”为地理位置访问者提供最快的内容交付。

CDN 会有点贵，因此，如果您有来自任何特定大陆/地区的访问者，建议您选择该地区知名的云托管公司...

# html - 使块元素垂直填充容器而无需手动固定大小

> ID：10645328
> 
> 赞同：-1
> 
> 时间：2012-05-18T00:41:41.297
> 
> 标签：html, css, height

我有一个固定大小的外部元素，其下方有一个页脚。元素内部有两个部分；第一个应该是固定的高度，第二个应该扩展以填充另一个元素但不会溢出它。

[让我演示给你看。](http://dabblet.com/gist/2722518)

我该怎么做呢？设置`height: 100%`第二个元素会导致它溢出外部元素并超出页脚。我看到的唯一另一种选择是以像素为单位明确设置高度，这看起来会很混乱。

这样做的正确方法是什么？

***编辑：***设置`overflow-y: hidden`将在这个非常有限的示例中起作用，但它实际上并没有限制`section.inner2`，并且如果我想给出`section.inner2`一个边框半径

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T03:34:32.807

我能想到的最简单的解决方案（我想得不多）就是使用`position: absolute;`：http: [//jsfiddle.net/WLZmT/3/](http://jsfiddle.net/WLZmT/3/)。

**HTML**：

```
<div id="outer">
    <div id="fixed">
        Fixed.
    </div>
    <div id="fluid">
        Fluid.
    </div>
</div> 
```

**CSS**：

```
#outer {
    position: relative;
    background: rgb(255, 200, 200);
    padding: 10px;

    height: 400px;
}

#fixed {
    height: 100px;
    padding: 10px;

    background: rgb(200, 255, 200);
}

#fluid {
    padding: 10px;
    background: rgb(200, 200, 255);

    position: absolute;
    top: 100px;
    bottom: 10px;
    left: 10px;
    right: 10px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T00:46:36.673

像这样？

```
<!DOCTYPE HTML>
<html>
<head>

    <title></title>

    <style media="screen" type="text/css">
    html,
    body {
        margin:0;
        padding:0;
        height:100%;
    }
    #container {
        left:50%;
        min-height:100%;
        position:relative;
    }
    #header {
        background:#ff0;
        padding:10px;
    }
    #body {
        padding:10px;
        padding-bottom:60px; /* Height footer */
    }
    #footer {
        position:absolute;
        bottom:0;
        width:100%;
        height:60px;            /* Height of the footer */
        background:#6cf;
    }

    </style>
    <!--[if lt IE 7]>
    <style media="screen" type="text/css">
    #container {
        height:100%;
    }
    </style>
    <![endif]-->
</head>
<body>

<div id="container">
    <div id="header">
        head
        <!-- Header end -->
    </div>
    <div id="body">
        <!-- Body start -->

        <!-- Body end -->
    </div>
    <div id="footer">
        <!-- Footer start -->
footer
        <!-- Footer end -->
    </div>
</div>

</body>
</html> 
```

# magento - Magento 类别页面不显示任何产品

> ID：10645333
> 
> 赞同：1
> 
> 时间：2012-05-18T00:42:27.687
> 
> 标签：magento, e-commerce, magento-1.5

当我查看类别页面（即 url.com/category.html）时，该页面显示类别标题、描述但没有产品。似乎没有加载它们，因为我收到此消息“没有与选择匹配的产品”。

产品已启用，在目录和搜索中可见，有数量且有库存，产品类别列在名为“默认类别”的根类别下。我在主页上按类别 ID 列出了特色产品，这些产品显示精美，并且个别产品详细信息页面也应显示。

我尝试刷新缓存/索引并搜索谷歌都无济于事。我认为这可能是由我对主题进行的自定义引起的问题，但切换到默认主题并没有改变，所以看起来我必须在产品或类别配置中遗漏一些东西。

可能有关系？– 即使按产品名称搜索也始终不返回任何结果

我正在使用 magento 1.5.1 版

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-22T22:01:19.940

请检查您的产品是否已完成以下设置

1.  产品必须在目录中可见。
2.  产品必须启用。
3.  产品必须有库存数量。
4.  产品必须设置为有货。
5.  如果产品设置为不跟踪库存，它仍然需要有库存数量并设置为库存。
6.  产品必须分配到目标类别。
7.  如果使用多网站模式（或者如果您通过数据流导入产品），则必须将产品分配到目标网站。
8.  您必须刷新“var/Cache”并从 admin > system > index management 重建所有索引

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-18T21:24:53.173

下次如果你有同样的问题，你可以尝试两件事：

**1 - 重新索引目录和产品**

**2 - 检查用户权限** 如果您将数据库从一台服务器移动到另一台服务器或恢复数据库，您可能需要检查该`customer_group`表。更具体地说，您应该检查**“未登录”**记录及其 ID，如果不是，则该产品对于大多数 Magento 商店几乎所有用户的用户组都将不可见，则它应该为“0”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T15:02:19.283

你有多少属性？标记为“在产品列表页面上可见”的属性过多可能会破坏索引。catalog_product_flat_* 表中是否有记录？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T16:09:31.530

好的，在我查找记录并将我的主题的 list.phtml 文件替换为默认的（大约第 100 次）产品开始显示后。不知道发生了什么变化，但只要他们继续展示我很高兴。

# uitableview - 确定 UIWebView 内容的高度（嵌入在 UITableViewCell 中）

> ID：10645335
> 
> 赞同：2
> 
> 时间：2012-05-18T00:42:46.960
> 
> 标签：uitableview, uiwebview, uiscrollview, uiwebviewdelegate

我有一个 UITableView 持有`UIWebView`可变高度的 s，并且用户可以编辑每个 web 视图的内容。每个单元格（Web 视图）的内容都链接到一个`NSManagedObject`子类，该子类的内容高度存储为`contentHeight`. 当最初创建一组新内容时，它会填充一组具有设定高度的默认数据，因此没有问题。

当用户编辑网页视图的内容时，我的问题就出现了；我需要弄清楚新内容的高度并相应地更新表格视图。我已经设置了更新`contentHeight`相应对象的已保存变量的逻辑，但我找不到可靠的方法来确定新内容的高度。下面我列出了一些我尝试过但无法奏效的方法。*任何*帮助将不胜感激，我已经被难住了一个多小时了:(

**失败的方法：**

```
[[webView stringByEvaluatingJavaScriptFromString:@"document.documentElement.scrollHeight"] floatValue];

[[webView stringByEvaluatingJavaScriptFromString:@"document.body.scrollHeight"] floatValue];

[[webView stringByEvaluatingJavaScriptFromString:@"document.body.offsetHeight"] floatValue];

[[webView stringByEvaluatingJavaScriptFromString:@"document.getElementById('sdcontent').offsetHeight"] floatValue];

CGRect webViewFrame = [webView frame];
CGRect temp = webViewFrame;
webViewFrame.size.height = 1;
[webView setFrame:webViewFrame];
CGSize fittingSize = [webView sizeThatFits:CGSizeZero];
webViewFrame.size = fittingSize;
[webView setFrame:temp]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T10:59:11.690

它有效，但仅当

*   使 webview 变小（如 5px）
*   加载它并等待完成
*   然后调用 sizeToFit
*   获得尺寸 THEN

广告：：D 在 github 上查看我的 M42WebviewTableViewCell 类

# css - 并排比例宽度 div 上的空白问题

> ID：10645338
> 
> 赞同：1
> 
> 时间：2012-05-18T00:43:56.553
> 
> 标签：css, html

我目前有两个并排的 div，每个都设置为页面的宽度，以便我可以横向滚动。右侧的 div 需要准确地窥视左侧 40 像素，以便在页面加载时可见。我已经设法（在很多帮助下）使那部分正常 - 现在的问题是右侧 div 的边缘和页面边缘之间有 40px 的间隙 - 如下所示：

[jsFiddle](http://jsfiddle.net/NUWqE/1/)

关于如何摆脱它的任何想法？非常感谢您的帮助。“窥视”区域必须保持 40 像素，因此使用百分比似乎是个问题。哦，对于垂直形式的外观示例，这里有一个[示例。](http://jsfiddle.net/zdJXq/)

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:51:05.283

你能像这个**[jsFiddle 例子](http://jsfiddle.net/j08691/NUWqE/4/)**那样伪造它吗？

我将滚动右块 ( `<p>scroll right --></p>`) 移到了包装器之外（你没有提到是否需要在那里）。然后我将相同的颜色应用于包装并添加`overflow:auto;`到其中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T00:54:05.013

您的容器有 200% 的宽度并导致扩展问题。

你需要减小它的大小。这有点困难，因为您的宽度以 % 为单位，而您的负偏移量以 px 为单位。

您可以做的是将偏移量更改为百分比并将其从容器中取出。您还需要使用 margin-left 而不是 left。

这在 chrome 检查器中对我有用：

```
#wrapper {
  width: 199%;  /* change here */
  position: relative;
}

#right {
  float: right;
  width: 50%; 
  background-color:cyan;
  position: relative;
  margin-left: -1%; /* and here */
} 
```

小提琴：http: [//jsfiddle.net/hUyBq/](http://jsfiddle.net/hUyBq/)

**编辑：** 1% 是一个例子，你可能想要更多。相应地更新包装器

**编辑：**使用 JS 的解决方案：http: [//jsfiddle.net/bendog/wP4zb/](http://jsfiddle.net/bendog/wP4zb/)

# delphi - 如何检测表单调整大小何时开始和停止？

> ID：10645339
> 
> 赞同：15
> 
> 时间：2012-05-18T00:44:18.597
> 
> 标签：delphi, resize, delphi-xe2

我正在一个相当大的表格上进行一些实时绘图。当用户调整表单大小时，我不想在用户释放鼠标按钮之前将大小更改应用于我的图形渲染，因此调整大小完成。如何检测到这一点，并且仅在用户完成调整表单大小后才调整渲染大小？因为现在，如果我使用`OnResize`表单的事件，它会不断地为鼠标移动的每个像素重新渲染所有内容。

我已经尝试过鼠标向下/向上事件并对其进行跟踪，但是在调整表单大小时不会调用这些事件。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-18T01:07:54.413

要检测已开始移动或调整大小，请捕获[`WM_ENTERSIZEMOVE`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632622%28v=vs.85%29.aspx)消息。一旦用户单击窗口的标题栏或调整边框（使窗口进入移动或调整大小循环），它就会被发送到窗口。

要检测移动或尺寸调整是否完成，请捕获[`WM_EXITSIZEMOVE`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632623%28v=vs.85%29.aspx)消息。一旦用户释放窗口的标题栏或调整边框（使窗口退出移动或调整大小循环），它就会被发送到窗口。

您可以通过在表单级别声明（和实现）它们来捕获它们中的任何一个：

```
procedure WMEnterSizeMove(var Message: TMessage); message WM_ENTERSIZEMOVE;
procedure WMExitSizeMove(var Message: TMessage); message WM_EXITSIZEMOVE; 
```

# c - ARM 汇编程序 - 循环卡住

> ID：10645340
> 
> 赞同：3
> 
> 时间：2012-05-18T00:44:18.800
> 
> 标签：c, assembly, embedded, arm

我目前正在编写一些基本的 ARM 汇编程序。这个想法是在连接了应用板的 LPC2378 开发板上控制理论熔炉及其冷却/加热系统。

就识别来自设备的输入而言，我已经到了那里。但是，我无法正确设置循环，我希望你们能够指出为什么我的循环卡住了，即使在按下按钮 1 后，风扇也没有打开。我以前让风扇工作，但是当我开始尝试通过加热器的温度来控制风扇时，它似乎永远不会启动，并且加热器保持打开状态，在没有风扇冷却的情况下变得越来越热。

我猜这可能归结为我从 ADC 控制器读取温度的方式。

请不要犹豫，询问您是否需要更多信息来回答问题。

```
;=========================================================================
; MotorControl_1
;
; BUT1 turns motor ON and BUT2 turns motor OFF
;
; No interrupt support (except for Reset) - as simple as it gets!
;
; WDH, November 2008
;==========================================================================

; Set-up interrupt vectors and stack support
$ LPC2378InterruptVectors.s

; After a reset exception, execution starts here - the processor is in ARM
; mode and supervisor state with interrupts disabled

    SECTION .text:CODE:NOROOT(2)

    REQUIRE __vector  ; Forces reference to this symbol - required by linker

    ARM

; __iar_program_start - defined start symbol.
__iar_program_start:

; Include lpc2378 IO register definitions
#include "iolpc2378.h"

; Include Olimex LPC-2378-STK IO definitions
#include "OlimexLPC2378BoardDefs.h"

; Main entry point - required by debugger

;=========================================================================
; main starts here
;=========================================================================
main

;=========================================================================
; Stack setup
;
; Stack pointer (r13 or SP) is assigned the highest address in a 32kB
; section of on-chip SRAM - assumes a FULL descending stack convention
;=========================================================================

    ldr r13, = 0x40008000
    ldr r2, = 0x000050    ;Load the delay value
    ldr r3, = 0x028       ;Start set point at 40
    ldr r4, = 0x000       ;Start temp difference as 0
;        ldr r6, = 0x0f        ;Temp High Value (15)
;        ldr r7, = -0xF        ;Set r7 to -15\.   

; Initialise IO
  BL InitialiseARM_IO
  BL InitialiseApplicationsBoard_IO

; Initialise the devices and display
  BL FanOff
  BL errorLedOff
  BL systemLedOff
  BL heaterOff

LoopStart

  BL WaitBUT1
  BL heaterOn
  BL systemLedOn
  BL readTemp
  BL checkTemp
  CMP r0, #5
  BGT errorVal
  SUBS r7, r6, r4 ;Performs r7 = r6 - r4 and sets condition register
  BLT LoopStart ;Branches to label_bar if r7 < 0 (in which case r6 < r4)
  BGT heaterOff
  BGT errorLedOn
  BGT FanOn
  BGT LoopStart
  BL WaitBUT2
  BL FanOff
  BL errorLedOff
  BL systemLedOff
  BL heaterOff

        B LoopStart

  ;=========================================================================
  ; InitialiseARM_IO
  ;
  ; Initialise the ARM interface, as follows:
  ;
  ; Port0(13..14} GPIO Output to on-board LEDs
  ;    bit 13:      USB_LINK LED
  ;    bit 14:      USB_CONNECT LED
  ; Port0{18,29} GPIO Input from BUT1 and BUT2
  ;    bit 18:      BUT2 pressbutton input
  ;    bit 29:      BUT1 pressbutton input
  ; Port1{18,19} GPIO Inputs from joystick UP and DOWN
  ;    bit 18:      UP joystick inout
  ;    bit 19:      DOWN joystick input
  ;=========================================================================
  InitialiseARM_IO

  ; Define data direction for LEDs - the LEDs are connected
  ; to P0.13 and P0.14

  STMFD r13!,{r0,r5,r14}   ; Push r0, r5 and LR

  ;LEDs on ARM board:
  ; Assign GPIO on P0.13 and P0.14
  LDR R5, =PINSEL0         ; Address of PINSEL0
  LDR R0, [R5]             ; Read current PINSEL0
  BIC R0, R0, #0x3C000000  ; Clear bits 26..29
  STR R0, [R5]             ; Put back in PINSEL0

  ; Configure output for P0.13 and P0.14
  LDR R5, =IO0DIR          ; Address of IO0DIR
  LDR R0, [R5]             ; Read current IO0DIR
  ORR R0, R0, #0x6000      ; Set bits 13 and 14 - for P0.13 and P0.14
  STR R0, [R5]             ; Put back in IO0DIR

  ; Switches and Joystick inputs on ARM board
  ; Assign GPIO on P0.18 and P0.29
  LDR R5, =PINSEL1         ; Address of PINSEL1
  LDR R0, [R5]             ; Read current PINSEL1
  BIC R0, R0, #0x30        ; Clear bits 4..5
  BIC R0, R0, #0x0c000000  ; Clear bits 26..27
  STR R0, [R5]             ; Put back in PINSEL0

  ; Configure input for P0.18 and P0.29
  LDR R5, =IO0DIR          ; Address of IO0DIR
  LDR R0, [R5]             ; Read current IO0DIR
  BIC R0, R0, #0x20000000  ; Clear bits 18 and 29 - for P0.18 and P0.29
  BIC R0, R0, #0x00040000
  STR R0, [R5]             ; Put back in IO0DIR

  ; Assign GPIO on P1.18 and P1.19
  LDR R5, =PINSEL3         ; Address of PINSEL3
  LDR R0, [R5]             ; Read current PINSEL3
  BIC R0, R0, #0xF0        ; Clear bits 4..7
  STR R0, [R5]             ; Put back in PINSEL3

  ; Configure input for P1.18 and P1.19
  LDR R5, =IO1DIR          ; Address of IO1DIR
  LDR R0, [R5]             ; Read current IO1DIR
  BIC R0, R0, #0xc0000     ; Clear bits 18 and 19 - for P1.18 and P1.19
  STR R0, [R5]             ; Put back in IO1DIR

  LDMFD r13!,{r0,r5,r14}   ; Pop r0, r5 and LR
  mov pc, r14              ; Put link register back into PC

  ;=========================================================================
  ; InitialiseApplicationsBoard_IO
  ;
  ; Initialise the interface to the Applications Board, as follows:
  ;
  ; Port4{0..7} GPIO Output to LEDs, Motor and Heater
  ;    bits 0..4:   Temperature error LED indicators
  ;    bit 5:       Heater control
  ;    bits 6..7:   Motor control
  ; Port4(8..15} GPIO Input from ADC
  ;    bits 8..15:  Inputs from Application Board ADC
  ;
  ;=========================================================================
  InitialiseApplicationsBoard_IO

  ; Define data direction for LEDs - the LEDs are connected
  ; to P0.13 and P0.14

  STMFD r13!,{r0,r5,r14}   ; Push r0, r5 and LR

  ; Applications Board Interface via Port4
  ; Set FIO4MASK to allow access to all bits
  LDR R5, =FIO4MASK        ; Address of FIO4DIR
  LDR R0, [R5]             ; Read current IO4DIR
  MOV R0, #0x0             ; Clear all bits of FIO4MASK
  STR R0, [R5]             ; Put back in IO4DIR

  ; Configure output for P4.0 to P4.7
  LDR R5, =FIO4DIR         ; Address of FIO4DIR
  LDR R0, [R5]             ; Read current IO4DIR
  ORR R0, R0, #0xFF        ; Set bits 0..7 - for P4.0 and P4.7
  STR R0, [R5]             ; Put back in IO4DIR

  ; Configure input for P4.8 to P4.15
  LDR R5, =FIO4DIR         ; Address of FIO4DIR
  LDR R0, [R5]             ; Read current IO4DIR
  BIC R0, R0, #0xFF00      ; Clear bits 8..15 - for P4.8 and P4.15
  STR R0, [R5]             ; Put back in IO4DIR

  LDMFD r13!,{r0,r5,r14}   ; Pop r0, r5 and LR
  mov pc, r14              ; Put link register back into PC

  ;=========================================================================
  ; Wait for BUT1 to be pressed
  ;=========================================================================
  WaitBUT1
  STMFD r13!,{r0,r5,r14}   ; Push r0, r5 and LR

  WaitForBUT1Pressed
    ldr r0, = IO0PIN            ; Address of FIO0PIN register 
    ldr r1, [r0]                ; Read FIO0PIN in to r1
    ands r1, r1, # B1_MASK      ; Mask out BUT1
    beq BUT1Pressed             ; Exit LED toggle loop if button is pressed
    B WaitForBUT1Pressed
  BUT1Pressed

  LDMFD r13!,{r0,r5,r14}   ; Pop r0, r5 and LR
  mov pc, r14              ; Put link register back into PC

  ;=========================================================================
  ; Wait for BUT2 to be pressed
  ;=========================================================================
  WaitBUT2
  STMFD r13!,{r0,r5,r14}   ; Push r0, r5 and LR

  WaitForBUT2Pressed
    ldr r0, = IO0PIN            ; Address of FIO0PIN register 
    ldr r1, [r0]                ; Read FIO0PIN in to r1
    ands r1, r1, # B2_MASK      ; Mask out BUT1
    beq BUT2Pressed             ; Exit LED toggle loop if button is pressed
    B WaitForBUT2Pressed
  BUT2Pressed

  LDMFD r13!,{r0,r5,r14}   ; Pop r0, r5 and LR
  mov pc, r14              ; Put link register back into PC

  ;=========================================================================
  ; Turn Fan Motor ON
  ;=========================================================================
  FanOn
  STMFD r13!,{r0,r5,r14}      ; Push r0, r5 and LR
  LDR R5, =FIO4PIN            ; Address of FIO4PIN
  LDR r0, [r5]                ; Read current Port4
  ORR r0, r0, #0x80
  STR r0, [r5]                ; Output
  LDMFD r13!,{r0,r5,r14}      ; Pop r0, r5 and LR
  mov pc, r14                 ; Put link register back into PC

  ;=========================================================================
  ; Turn Fan Motor OFF
  ;=========================================================================
  FanOff
  STMFD r13!,{r0,r5,r14}      ; Push r0, r5 and LR
  LDR R5, =FIO4PIN            ; Address of FIO4PIN
  LDR r0, [r5]                ; Read current Port4
  BIC r0, r0, #0xc0
  STR r0, [r5]                ; Output
  LDMFD r13!,{r0,r5,r14}      ; Pop r0, r5 and LR
  mov pc, r14                 ; Put link register back into PC
  ;==============================================================================
  ; Turn On Error LED
  ;==============================================================================
  errorLedOn
  STMFD r13!,{r0, r5,r14}
  mov r0, # USB_LINK_LED_MASK
  ldr r5, = IO0CLR
  str r0, [r5]
  LDMFD r13!,{r0, r5, r14}
  mov pc, r14
  ;==============================================================================
  ; Turn Off Error LED
  ;==============================================================================
  errorLedOff
  STMFD r13!,{r0, r5,r14}
  mov r0, # USB_LINK_LED_MASK
  ldr r5, = IO0SET
  str r0, [r5]
  LDMFD r13!,{r0, r5, r14}
  mov pc, r14
  ;==============================================================================
  ; Turn On System LED   
  ;==============================================================================    
  systemLedOn
  STMFD r13!,{r0, r5,r14}
  mov r0, # USB_CONNECT_LED_MASK
  ldr r5, = IO0CLR
  str r0, [r5]
  LDMFD r13!,{r0, r5, r14}
  mov pc, r14
  ;==============================================================================
  ; Turn Off System LED
  ;==============================================================================
  systemLedOff
  STMFD r13!,{r0, r5,r14}
  mov r0, # USB_CONNECT_LED_MASK
  ldr r5, = IO0SET
  str r0, [r5]
  LDMFD r13!,{r0, r5, r14}
  mov pc, r14 
  ;==============================================================================
  ; Turn Heater On
  ;==============================================================================
  heaterOn
  STMFD r13!,{r0,r5,r14}      ; Push r0, r5 and LR
  LDR R5, =FIO4PIN            ; Address of FIO4PIN
  LDR r0, [r5]                ; Read current Port4
  ORR r0, r0, #0x20
  STR r0, [r5]                ; Output
  LDMFD r13!,{r0,r5,r14}      ; Pop r0, r5 and LR
  mov pc, r14                 ; Put link register back into PC     
  ;==============================================================================
  ; Turn The Heater Off
  ;==============================================================================
  heaterOff
  STMFD r13!,{r0,r5,r14}      ; Push r0, r5 and LR
  LDR R5, =FIO4PIN            ; Address of FIO4PIN
  LDR r0, [r5]                ; Read current Port4
  AND r0, r0, #0xDF
  STR r0, [r5]                ; Output
  LDMFD r13!,{r0,r5,r14}      ; Pop r0, r5 and LR
  mov pc, r14                 ; Put link register back into PC   
  ;==============================================================================
  ; Read Temperature
  ;============================================================================== 
  readTemp
  STMFD r13!,{r0,r5,r14}      ; Push r0, r5 and LR
  LDR r0, =FIO4PIN
  LDR r1, [r0]
  LSR r1, r1, #8
  AND r1, r1, #0xFF ; r1 now holds the temperature value
  LDMFD r13!,{r0,r5,r14}      ; Pop r0, r5 and LR
  mov pc, r14                 ; Put link register back into PC
  ;==============================================================================
  ; Implement Counter And Read Temperature
  ;==============================================================================
  checkTemp
  STMFD r13!,{r0, r14}     ; Push PC, r0, Lr
  LSR r1, r1, #8
  LDR r0, [r2]               ; Load delay value in r0.
  SUB r0, r0, #0x01         ; Minus 1 from delay.
  BEQ readTemp             ; Branch if timer counted down.

  errorVal
  STMFD r13!,{r0, r14}     ; Push PC, r0, Lr
  SUB r1, r3, r6           ; Subtract set point from temperature, into r6
  mov pc, r14                 ; Put link register back into PC

            END 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T19:15:17.327

看起来您已经将 BGT（如果大于则分支）与 BLGT（如果大于则分支和链接）混淆了。在你的主循环中间，你有这个：

```
 BLT LoopStart ;Branches to label_bar if r7 < 0 (in which case r6 < r4)
  BGT heaterOff
  BGT errorLedOn
  BGT FanOn
  BGT LoopStart 
```

如果条件为“大于”，您的代码将分支到**heatOff**，然后当该函数返回时，它将完全退出代码。函数**errorLedOn**和**FanOn**永远无法执行。

# c - 在 C 中，如何计算 unsigned long 的模数？

> ID：10645342
> 
> 赞同：4
> 
> 时间：2012-05-18T00:44:32.153
> 
> 标签：c, math

在我的功能中，我首先使用 mod 如下：

```
void function(int, int, unsigned int); 
```

调用：

```
function(100, 200, get_value() % 1024); 
```

将返回一个从0 到`get_value()`变化的无符号整数。在这种情况下，可能是一个非常大的数字，导致运行次数过多，所以我将其更改如下：`0x``0xffffffff``get_value() % 1024``1024``function()`

```
unsigned int num = get_value() % 1024;
function(100, 200, num); 
```

在这种情况下，`num`是可以的。我曾经`gcc`编译过。

那么这两种方法有什么区别，C如何计算模量`unsigned long`呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T00:52:28.177

您的原型是用于`function`，但您正在调用`function1`。在这种情况下，`function1`函数没有原型，所以最后一个参数被认为是一个`int`. 这就是为什么您没有获得预期的转换。

重命名原型应该可以解决它：

```
void function1(int, int, unsigned int); 
```

# java - 在 Android 之外使用 Android 对象

> ID：10645343
> 
> 赞同：1
> 
> 时间：2012-05-18T00:44:49.337
> 
> 标签：java, android, eclipse

在 Java 项目中，我使用的是 Android 项目中的类并使用 android View 对象。当我尝试在非 android 项目中使用该类时，我在运行时收到 no class found 错误。如何将 android.widget.view.View 导入非 android 项目？我可以将它添加到我的项目构建中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:34:03.523

如果没有 android 平台运行时，即.. DalvikVM 等......您将无法运行在 Java 项目中呈现“视图”所需的任何框架。有没有想过。。但要对其进行编码，您至少需要将 Android.jar 导入您的 Java 项目构建路径。它可能会找到 Widget 包，但 Widget 包会寻找 Android SDK 等...

android.widget.View 在 Android 环境之外给你什么？

# sql - 更新 Google Fusion Table 中的一行

> ID：10645344
> 
> 赞同：0
> 
> 时间：2012-05-18T00:45:04.413
> 
> 标签：sql, row, google-fusion-tables

我正在尝试按照[此](https://developers.google.com/fusiontables/docs/developers_guide#Updating)页面上的说明使用以下形式的 URL 更新 Google Fusion 表中的一行：

```
https://www.google.com/fusiontables/api/query/?sql=UPDATE<TABLEID>SET<COLUMN NAME>=<NEW VALUE>WHERE ROWID=<ROWIDVALUE> 
```

当我将其输入浏览器时，我会收到“找不到文件”消息。任何关于我可能做错的建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T20:52:57.623

需要 oauth2 来创建令牌。[在此处](http://code.google.com/p/gwt-oauth2/source/browse/trunk/samples/script/ScriptSample.html?r=40)和[此处](https://stackoverflow.com/questions/10996487/fusiontables-private-table-with-oauth2)查看详细信息
然后只需将该令牌添加到 URL

```
https://www.google.com/fusiontables/api/query/?sql=UPDATE<TABLEID>SET<COLUMN NAME>=<NEW VALUE>WHERE ROWID=<ROWIDVALUE>&access_token=<ACCESS TOKEN> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:06:49.467

为了使用旧 API 或新 API 更新表，您需要随请求一起发送授权标头。更多关于授权的信息可以在这里找到：

[https://developers.google.com/fusiontables/docs/developers_guide#Authentication](https://developers.google.com/fusiontables/docs/developers_guide#Authentication)

# php - 如何从自动增量字段中获取字段值

> ID：10645347
> 
> 赞同：0
> 
> 时间：2012-05-18T00:45:45.927
> 
> 标签：php, mysql

> **可能重复：**
> [（mysql，php）如何在插入数据之前获取 auto_increment 字段值？](https://stackoverflow.com/questions/2251463/mysql-php-how-to-get-auto-increment-field-value-before-inserting-data)

我有这张供用户使用的表格。这`user_id`是一个自动增量字段。我正在使用 PDO 连接并执行数据库。`user_id`添加新用户后如何获得价值？

我试过 user `mysql_insert_id()`，但什么也没发生。

```
 $sql = "INSERT INTO  `users` (`user_name` ,`user_password` ,) VALUES (?, ?)";

    $db = new DB; // create Database handler.       
    if($db->execute($sql,$this->name,$this->password))
    {
        $this->permission = new permission(mysql_insert_id()); // <--- HERE
        $this->permission->reset();
        $this->permission->insert();
    }
    return true; 
```

因为新类将基于一个`user_id`值构建。先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T00:54:55.217

mysql_insert_id() 不是 PDO。你有没有在 $db->e​​xecute 之后尝试过[$db->lastInsertId()](http://php.net/manual/en/pdo.lastinsertid.php)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:02:02.760

您可以使用以下 SELECT 查询获取最近添加的自动增量 ID：

```
SELECT LAST_INSERT_ID(); 
```

# regex - Perl：根据其键将散列分成几个？

> ID：10645350
> 
> 赞同：2
> 
> 时间：2012-05-18T00:46:12.680
> 
> 标签：regex, perl, hashtable

假设我有一个 hashref，其`Data::Dumper`输出如下所示：

```
    $VAR1 = {
        foo_0 => 'foo_zero',
        foo_1 => 'foo_one',
        bar_0 => 'bar_zero',
        bar_1 => 'bar_one'
    }

```

我想根据它的键将此哈希分成两部分，如下所示，但我不知道如何执行此操作：

```
    $VAR1 = {
        foo_0 => 'foo_zero',
        foo_1 => 'foo_one'
    },
    $VAR2 = {
        bar_0 => 'bar_zero',
        bar_1 => 'bar_one'
    }

```

第一个哈希的键匹配`/foo_[\d]/`，而第二个哈希的键匹配`/bar_[\d]/`。

如果您能告诉我如何做到这一点（或提示我一些搜索关键字），我将不胜感激。

问候，
克里斯托弗·史密斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T01:31:52.480

我假设您的哈希引用是`$foo_ref`. 您没有说明如果您的哈希键既不是 a 也不是 a 会发生`foo`什么`bar`。你可以做以下三件事之一：

*   您必须对引用进行哈希处理。键之一`foo`和所有其他键之一。
*   你扔掉既不是`foo`钥匙也不是钥匙的`bar`钥匙。（这就是我所做的）。
*   您有第三个散列，它存储所有非 foo 和非 bar 键。

下面的程序：

```
#! /usr/bin/env perl

use strict;
use warnings;
use feature qw(say);
use Data::Dumper;

my $foo_re = qr/^foo_/;
my $bar_re = qr/^bar_/;

my $foo_ref = {
    foo_0 => "foo_zero",
    foo_1 => "foo_one",
    bar_0 => "bar_zero",
    bar_1 => "bar_one",
};

my $bar_ref = {};
foreach my $key (keys %{$foo_ref}) {
    if (not $key =~ $foo_re) {

    # Remove if clause to store all non-foo keys in $bar_re
    $bar_ref->{$key} = $foo_ref->{$key} if $key =~ $bar_re;
    delete $foo_ref->{$key}
    }
}

say Dumper $foo_ref;
say Dumper $bar_ref; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T06:41:08.400

到目前为止发布的其他解决方案都有效，但又快又脏。当输入模式改变时它们需要改变，并且只假设两种模式。这个通用的解决方案不会受此影响：它不需要更改，并且可以使用任意数量的模式。

```
sub classify_hashref {
    my ($href, %p) = @_;
    my $r;
    for my $hkey (keys %{ $href }) {
        for my $pkey (keys %p) {
            $r->{$pkey}{$hkey} = $href->{$hkey}
                if $hkey =~ $p{$pkey};
        }
    }
    return $r;
}

my $h = {
    foo_0 => 'foo_zero',
    foo_1 => 'foo_one',
    bar_0 => 'bar_zero',
    bar_1 => 'bar_one'
};
classify_hashref($h, foo_like => qr/^foo_/, looks_like_bar => qr/^bar_/);
# {
#     looks_like_bar => {
#         bar_0 => 'bar_zero',
#         bar_1 => 'bar_one'
#     },
#     foo_like => {
#         foo_0 => 'foo_zero',
#         foo_1 => 'foo_one'
#     }
# } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T01:26:21.463

我假设您所有的哈希键都具有提供的两种模式之一。如果没有，那么您应该更准确地指定您拥有什么以及您期望什么。
如果您想处理*转储*的输出，我还假设它具有适合的正确格式`eval`。只需将您的输出放入`q(`并 `)`：

```
# ...

my $VAR1;

eval q(
    $VAR1 = {
        foo_0 => 'foo_zero',
        foo_1 => 'foo_one',
        bar_0 => 'bar_zero',
        bar_1 => 'bar_one'
    }
);

my $h1 = {};
my $h2 = {};

for my $k ( keys %{$VAR1} ) {
    if ( $k =~ /foo_\d/  ) {
        $h1->{$k} = $VAR1->{$k};
        next;
    }

    $h2->{$k} = $VAR1->{$k};  # the remaining  /bar_\d/ case
}

# use your new $h1 and $h2 hasrefs
# ... 
```

您将获得 2 个新的 hasrefs`$h1`和`$h2`.
如果您有除这 2 个以外的其他情况，则应将每个人都放在一个`if`中，而不仅仅是第一个。
这不是一个完整的脚本，只是一个片段。

# ios - 状态栏和导航栏后可用的视图大小

> ID：10645353
> 
> 赞同：1
> 
> 时间：2012-05-18T00:46:29.747
> 
> 标签：ios, ipad

我正在编写一个 iPad 应用程序，它需要知道视图的可用区域以进行绘图。视图被添加到导航控制器中，因此状态栏和导航控制器都占用了一定数量的像素。我的应用程序恰好处于横向模式，尽管我认为这无关紧要。

使用 didRotateFromInterfaceOrientation 旋转后，我能够获得正确的视图大小。但我不知道如何在不旋转屏幕的情况下做到这一点。

```
 - (void) didRotateFromInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    [self.view setFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
    NSLog(@"drfi %d %d", (int)self.view.frame.size.width, (int)self.view.frame.size.height);

} 
```

^^ 旋转后有效。不是以前。无法弄清楚如何获得准确的数字。我真的不想硬连线。

我还需要这个功能独立于设备——它应该适用于新 iPad 以及旧 iPad 分辨率。一旦我知道确切的可用区域，我就可以处理缩放问题。为什么这么难？帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-18T21:12:14.133

您可以通过将实例方法与类别方法相结合来动态获取：

**实例方法：**

这假设您的视图控制器（自身）嵌入在导航控制器中。

```
-(int)getUsableFrameHeight {
  // get the current frame height not including the navigationBar or statusBar
  return [MenuViewController screenHeight] - [self.navigationController navigationBar].frame.size.height;
} 
```

**类分类方法：**

```
+(CGFloat)screenHeight {
    CGFloat screenHeight;
    // it is important to do this after presentModalViewController:animated:
    if ([[UIApplication sharedApplication] statusBarOrientation] == UIDeviceOrientationPortrait ||
        [[UIApplication sharedApplication] statusBarOrientation] == UIDeviceOrientationPortraitUpsideDown){
        screenHeight = [UIScreen mainScreen].applicationFrame.size.height;
    } else {
        screenHeight = [UIScreen mainScreen].applicationFrame.size.width;
    }
    return screenHeight;
} 
```

在移除状态栏和导航栏后，以上内容将始终为您提供可用的框架高度，包括纵向和横向。

注意：类方法会自动减去状态栏的 20 pt - 然后我们只需减去导航标题变量高度（横向 32 pt，纵向 44 pt）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:56:30.130

您的应用程序看起来像：有一个启动视图，然后在此视图中您将加载主视图并将其添加到窗口中，对吗？然后您应该在主视图中执行以下操作：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        CGRect frame = self.view.frame;
        frame.origin.y = frame.origin.y + 20.0;
        self.view.frame = frame;
    }
    return self;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T00:59:21.250

我认为您不需要在 didRotateFromInterfaceOrientation 中指定框架的视图，我建议您为视图自动调整大小掩码设置一些属性，以便它根据您的视图方向自动调整大小。

例如，通过在加载视图时将其设置为您的视图（viewDidLoad 方法）：

```
self.view.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth; 
```

您指定您的视图将自动更改其宽度和高度，并且可以从那里获得您需要的正确值。

您应该阅读以下内容：http: [//developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/CreatingViews/CreatingViews.html#//apple_ref/doc/uid/TP40009503-CH5-SW1](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/CreatingViews/CreatingViews.html#//apple_ref/doc/uid/TP40009503-CH5-SW1) 以获得更好的iOS中视图的理解

**编辑**

此外，您可能想发现可以使用的设备的方向是什么`[[UIApplication sharedApplication] statusBarOrientation];`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-07T15:48:31.677

尝试这个。

```
CGRect frame = [UIScreen mainScreen].bounds;
CGRect navFrame = [[self.navigationController navigationBar] frame];
/* navFrame.origin.y is the status bar's height and navFrame.size.height is navigation bar's height.
So you can get usable view frame like this */
frame.size.height -= navFrame.origin.y + navFrame.size.height; 
```

# python - 我有 2 个应该有效但未被识别的表达式

> ID：10645354
> 
> 赞同：0
> 
> 时间：2012-05-18T00:46:32.643
> 
> 标签：python, regex

```
import re

cards1 = "'F'*4 + 'H'*10"; cards2 = 'FFHH'
def find_number_of_cards(cards):
    regexp = re.compile(r"(?P<FandH>[FH]+) | (('F')[*](?P<F>[0-9]+)\s*[+]\s*('H')[*](?P<H>[0-9]+))")
    result = regexp.search(cards)
    if result == None:
        return ("The expression given is not valid.")
    else:
        FnH = result.group('FandH')
        F = result.group('F')
        H = result.group('H')
        if FnH == None:
            return F, H
        else:
            return "Blank."

print(find_number_of_cards(cards1))
print(find_number_of_cards(cards2)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T00:52:11.587

改变这个：

```
regexp = re.compile(r"(?P<FandH>[FH]+) | (('F')[*](?P<F>[0-9]+)\s*[+]\s*('H')[*](?P<H>[0-9]+))") 
```

对此：

```
regexp = re.compile(r"(?P<FandH>[FH]+)|(('F')[*](?P<F>[0-9]+)\s*[+]\s*('H')[*](?P<H>[0-9]+))") 
```

它正在寻找字符串中不存在的空格。

# python-3.x - 如何有选择地运行 cpython 的回归测试？

> ID：10645357
> 
> 赞同：2
> 
> 时间：2012-05-18T00:47:05.833
> 
> 标签：python-3.x, cpython

如何运行 CPython3.3 自己的回归测试？

```
python3.3 -m test.regrtest packaging.tests.test_command_install_data 
```

提高`ImportError: No module named 'test.packaging'`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-04T16:46:30.207

```
python3 -m test.regrtest 
```

该命令有选项，“python3 -m regrtest --help”显示了广泛的帮助。您可以做的一件事是将特定测试模块的名称添加到命令行，名称应该是“测试”包中的模块。例如，“python3 -m test.regrtest test_socket”在模块“test.test_socket”中运行测试。

您使用的命令行有两个问题：

1.  您尝试运行不在 test 包中但在其他顶级包中的测试

2.  顶级包“打包”不是 Python 3.3（或任何其他 Python 版本）的标准库的一部分

# unit-testing - 在 TDD 中，我如何确保测试本身不会过时（并错误地报告成功）？

> ID：10645358
> 
> 赞同：4
> 
> 时间：2012-05-18T00:47:36.560
> 
> 标签：unit-testing, tdd

**具体来说，我担心这种情况：**

1) 我写了一个有 1 个成员变量和一个复制函数的类

```
class MyClass
{
private:
int grade;

public:
void setGrade(int x) { grade = x; }
int getGrade() { return grade; }
void copyFrom(const MyClass* src) { grade = src->grade; }
} 
```

2）按照这些思路编写单元测试

```
void testCopyFrom()
{
MyClass mc1;
MyClass mc2;
mc1.setGrade(-347);
mc2.setGrade(10);
mc2.copyFrom(&mc1);
TS_ASSERT_EQUALS(mc2.getGrade(), -347);
} 
```

3）几个月后，我添加了第二个成员变量

```
private:
int grade, extra; 
```

而且，（你猜对了！）忘记相应地更新 copyFrom() 函数。

在这种情况下，单元测试将***错误地报告成功***。我在测试设计上做错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T01:14:48.537

TDD 意味着**先测试**：在更改代码之前，您应该更新代码。在这种情况下，如果您决定添加`extra`，您应该为周围的 API 添加测试`extra`（到目前为止您还没有，但也许您会想要`getExtra()`等），然后，当您添加和修改测试时，您将请注意，您需要添加`setExtra()`并`getExtra()`调用`testCopyFrom()`.

在这个阶段，您的测试大多会失败（**红色**），然后您可以编写真正的代码以使它们通过（**绿色**），最后，清理和**重构**，使用您的测试作为您是否失败的指南任何事物。

阅读有关[red-green-refactor 的](http://jamesshore.com/Blog/Red-Green-Refactor.html)更多信息——它*是*TDD。

此外，您应该标记`getGrade()`为`const`，即

```
int getGrade() const { return grade; } 
```

这意味着您可以使用`const`指针或对`MyClass`实例的引用来获取成绩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:03:30.630

在这种特殊情况下，测试并**没有**错 - 它正在执行（并报告）您设置它执行的操作。单元测试不关心目标的实现——它不关心你是否添加了第二个属性。

*将*解决这个问题的是编写另一个测试来检查复制后的新属性。测试真正告诉你`copyFrom`的是，当你调用它时，copyFrom 操作似乎成功了——它不能保证复制操作的*范围*，因为你需要制作单独的测试。

另一种看待这个问题的方式：仅仅因为你调用了一个函数并且它没有抛出异常就返回了，这本身并不表示成功或失败——它只是返回给调用者。您需要更改`copyFrom`以返回成功/失败指示（或在失败时抛出异常），或者您需要对目标环境进行更多检查以确定成功或失败。

# xml - 将 XML 属性转换为元素 XSLT

> ID：10645359
> 
> 赞同：11
> 
> 时间：2012-05-18T00:47:52.510
> 
> 标签：xml, xslt

我正在尝试将属性转换为子元素，即打开以下内容：

```
<WP featured="yes" player="no" dancers="no" series="logos" archive="no" fanart="no" id="eclipse_logos_">
    <seriesName>LOGOS</seriesName>
    <selection>ECLIPSE</selection>
    <imgurl>http://www.nba.com/warriors/photos/eclipse_logos_</imgurl>
    <res>1024x1024r(iPad/iPhone)?1280x1024r(Regular)?1440x900r(Widescreen)?1920x1080r(HDTV)?1920x1200r(Widescreen)</res>
</WP> 
```

进入：

```
<WP>
    <featured>yes</featured>
    <player>no</player>
    <dancers>no</dancers>
    <series>logos</series>
    <archive>no</archive>
    <fanart>no></fanart>
    <id>eclipse_logos_</id>
    <seriesName>LOGOS</seriesName>
    <selection>ECLIPSE</selection>
    <imgurl>http://www.nba.com/warriors/photos/eclipse_logos_</imgurl>
    <res>1024x1024r(iPad/iPhone)?1280x1024r(Regular)?1440x900r(Widescreen)?1920x1080r(HDTV)?1920x1200r(Widescreen)</res>
</WP> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-18T01:07:32.563

尝试这个：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl"
>
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

  <xsl:template match="@*">
    <xsl:element name="{name()}"><xsl:value-of select="."/></xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T04:50:48.373

dradu 的代码是通用的，转换将适用于所有属性，下面的代码对 WP 元素更具体：只有那些在 WP 元素下的属性才会被转换为元素。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

  <xsl:template match="WP/@*">
    <xsl:element name="{name()}">
      <xsl:value-of select="."/>
    </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

# html - 垂直对齐内联列表项上的文本

> ID：10645360
> 
> 赞同：1
> 
> 时间：2012-05-18T00:47:53.963
> 
> 标签：html, html-lists, vertical-alignment, css

我有一个内联元素列表，列表中的元素有时可以是图像或文本。图像始终与列表高度相同，但是如何垂直对齐列表中的文本？

[http://jsfiddle.net/qvuCm/](http://jsfiddle.net/qvuCm/)

注意：标记不能更改。

只希望用 CSS 来做这件事，没有 JavaScript。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T01:43:26.310

进行了以下更改：

```
ul li a img{
    display:block;
}

a {
    color: #000;
    font-weight: 700;
    text-decoration: none;
    display:table-cell;
    vertical-align: middle;
    width:100px;
    height:80px;
} 
```

[http://jsfiddle.net/qvuCm/12/](http://jsfiddle.net/qvuCm/12/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:16:42.890

如果将`a`样式设置为`display: table-cell`，则可以使用`vertical-align` [(http://jsfiddle.net/whm8X/](http://jsfiddle.net/whm8X/) ) 例如：

```
a {
    display: block;
    height: 80px;
    width: 100px;
    display:table-cell;
    vertical-align:middle;
} 
```

# oop - 使用私有静态方法 OOP 概念

> ID：10645362
> 
> 赞同：0
> 
> 时间：2012-05-18T00:47:58.970
> 
> 标签：oop, methods, static, private

我在这里有一个疑问，经过这么多解释，我仍然没有真正明白这一点。为什么我们需要声明一个私有静态方法？由于该方法是私有的，因此只能由类本身访问，并且可以轻松调用内部函数而无需创建实例，不是吗？还是我对这个概念错了？我的意思是我可以理解为什么我们有一个私有方法（因为我们希望只保留类本身的逻辑）并且我也理解为什么我们需要一个静态方法（因为我们不需要实例来访问该方法）。所以，我的问题是为什么我们需要在私有时将其设为静态？好像我们不希望任何其他类访问它并且不能直接从代码中调用它（因为它是私有的）但我们仍然将它保持为静态？

对不起，我很困惑。谁能帮我解决这个概念？

最好的问候， 易莹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:55:31.847

您可能需要从静态公共调用您的静态私有。静态公共不能访问非静态私有！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T07:42:28.563

另一个原因可能是性能，具体取决于平台。对于 .NET 平台，在微软的静态代码分析工具[FxCop 的文档中](http://msdn.microsoft.com/en-us/library/ms245046%28v=vs.80%29.aspx)，可以找到以下语句：

> 不访问实例数据或调用实例方法的方法可以标记为静态（在 Visual Basic 中为共享）。将方法标记为静态后，编译器将向这些成员发出非虚拟调用站点。发出非虚拟调用站点将阻止在运行时对每个调用进行检查，以确保当前对象指针不为空。这可以为性能敏感的代码带来可衡量的性能增益。在某些情况下，无法访问当前对象实例代表了正确性问题。

# android - AlertDialog 没有出现（在后台）

> ID：10645364
> 
> 赞同：0
> 
> 时间：2012-05-18T00:48:14.717
> 
> 标签：android

我尝试使用下面的代码为我的电话应用程序显示一个 AlertDialog。当我的应用程序运行到入口点时，AlertDialog 没有向用户显示。

手机屏幕变成了深色被锁定。但是，我可以按手机的**后退**按钮让应用程序进入下一步，就像按下**取消**功能的行为一样。

AlertDialog 似乎隐藏在应用程序背景中。我想把它称为前台。

怎么做 ？

顺便说一句，LogCat 上没有显示错误消息。

有人可以指出我错在哪里或我可以提供什么其他信息吗？

谢谢 ！

```
AlertDialog.Builder builder1 = new AlertDialog.Builder(Mainx.this);
builder1.setTitle(getResources().getString(R.string.str_sel_player));
LayoutInflater inflater = LayoutInflater.from(this);
View functionListView = inflater.inflate(R.layout.dialog_pickitem_action,null); 
builder1.setView(functionListView);   
mlistView = (ListView) functionListView.findViewById(R.id.m_functions_listview); 
mlistView.setAdapter(new ArrayAdapter<String>(this,                 
    android.R.layout.simple_list_item_1, mPlayers)); 
selDialog = builder1.create();
selDialog.show(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T03:21:11.753

它很奇怪。

您可以尝试将 showDialog() 与 onCreateDialog() 一起使用

覆盖活动的

对话框 onCreateDialog(int id)

然后调用 showDialog(int id)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:46:20.080

这两行用于调用警报对话框方法

```
AlertDialog diaBox = makeAndShowDialogBox();
diaBox.show(); 
```

# 警报对话框代码

```
 private AlertDialog makeAndShowDialogBox(){
 AlertDialog myQuittingDialogBox =new AlertDialog.Builder(this) 
    //set message, title, and icon
    .setTitle(resource.getString(R.string.str_pick_app)) 
    .setMessage(resource.getString(R.string.savesettings)) 
    .setIcon(R.drawable.menu_settings)

    .setPositiveButton(resource.getString(R.string.ok), new DialogInterface.OnClickListener() {

        public void onClick(DialogInterface dialog, int whichButton) { 

            //write code as acc to your requirement

            dialog.dismiss();

        }   

    })

    .create();
//startActivity(intet);
    return myQuittingDialogBox;

} 
```

# android - 如何在 Android 测试项目（ant build）中引用库项目

> ID：10645366
> 
> 赞同：2
> 
> 时间：2012-05-18T00:48:54.887
> 
> 标签：android, testing, ant, jenkins, robotium

有3个项目：

1.  主要项目
2.  main 引用的一个库项目（ActionBarSherlock）
3.  一个机器人测试项目。

这三个项目由 Jenkins 签出到工作区中的 3 个文件夹中。

但是，Robotium 测试项目无法引用库项目：

*   如果只使用标准的“android update test-project”，那么测试项目将不会编译，因为它**间接**引用了库项目

    ```
    [javac] /home/jenkins_test/test/src/com/**********/test/core/**********TestCase.java:15: cannot access                com.actionbarsherlock.app.SherlockFragmentActivity
    [javac] class file for com.actionbarsherlock.app.SherlockFragmentActivity not found
    [javac]             ActivityInstrumentationTestCase2<Home> {
    [javac]                                             ^
    [javac] /home/jenkins_test/test/src/com/**********/test/core/**********TestCase.java:55: cannot find symbol
    [javac] symbol  : constructor Solo(android.app.Instrumentation,com.**********.activity.Home)
    [javac] location: class com.jayway.android.robotium.solo.Solo
    [javac]             solo = new Solo(getInstrumentation(), getActivity());
    [javac]                    ^ 
    ```

*   “android update test-project”不支持 --library 标志

*   如果 android.library.reference.1=../ActionBarSherlock 被添加到测试项目的 project.properties 中，那么测试项目可以编译但在运行时它会抱怨找不到主活动的类 (NoClassDefFoundError)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T05:48:18.857

不幸的是，这在 ant 中失败了，但测试可以由 Eclipse 构建和运行。您应该考虑的唯一一件事是在测试项目中检查***Java Build Path -> Order and Export中的 robotsium 库***

![在此处输入图像描述](../Images/9ece4de5ebe24fe5ec2afce4a667edf6.png)

并检查您的库项目是否未**在**测试项目的属性中引用

![在此处输入图像描述](../Images/5816b0b2a5edfc164422b49085032844.png)

如果您想*单独*测试库项目，可以按照[android: testing library projects](http://dtmilano.blogspot.ca/2012/04/android-testing-library-projects.html)中描述的说明进行操作。

我知道这可能不是解决方案，因为您使用的是 Jenkins，但至少它会让您从坚实的基础开始。

# c# - 字符串未被识别为有效日期时间

> ID：10645367
> 
> 赞同：0
> 
> 时间：2012-05-18T00:48:55.593
> 
> 标签：c#, asp.net, datetime, formatexception, datetime-parsing

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T00:51:50.143

尝试

```
DateTime.ParseExact(dtm.Text.Trim(), "dd/M/yyyy", System.Globalization.CultureInfo.InvariantCulture) 
```

[四个 y 而不是 3 和 InvariantCulture]

# for-loop - 打破与从 for 循环内部返回

> ID：10645369
> 
> 赞同：3
> 
> 时间：2012-05-18T00:49:32.133
> 
> 标签：for-loop, time-complexity, break, space-complexity

下面是两个片段。请注意程序之间的唯一区别是一个`break to return`和另一个`return`立即。我知道在方法中设置一个退出点是一种很好的设计实践。但我不担心这里的设计。如果我为使用支付额外费用，我需要支付`break`多少额外的计算/内存/时钟周期？

方案一：

```
public boolean doThis(String[] A){
  boolean indicator = false;
  for(int i=0; i<A.length; i++){
      if(A[i].equals("Taboo"))
        break;
      for(int x=0; x<=i; x++)
          //some work is done here. to make indicator true or false
  }
  return indicator;
} 
```

方案二：

```
public boolean doThis(String[] A){
  boolean indicator = false;
  for(int i=0; i<A.length; i++){
      if(A[i].equals("Taboo"))
        return false;
      for(int x=0; x<=i; x++)
          //some work is done here. to make indicator true or false
  }
  return indicator;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T02:04:51.507

如果您的编译器有任何好处，那么您为“return false”情况支付的费用会少一点。

您可能会认为“休息”很昂贵。使用一个糟糕的编译器，它是一个返回返回的单跳转指令。一个好的编译器会意识到跳转是多余的，如果您不介意扩展代码，可以将返回语句提升到中断点。

使“返回错误”的情况稍微便宜一些的原因是，“返回指示符”可能需要从内存中提取以将结果放置在编译器几乎普遍使用的调用约定结果返回寄存器中。"return false" 将常量加载到寄存器中（特别是结果返回寄存器）；在现代机器上，这总是比从内存中获取更快，因为文字嵌入在处理器已经获取的指令流中。

复杂的编译器可能会将所有变量保存在寄存器中。在这种情况下，“返回指示符”实际上可能更快，因为智能编译器可能已经计划将“指示符”放在结果返回寄存器中；无需任何工作即可加载该值。对于您使用 string equal 调用编写的程序，我怀疑编译器会尝试将所有变量保留在寄存器中；它只需要在调用equal时昂贵地将它们全部溢出。

除了所有这些细节之外，这不是您应该担心优化的事情。

# php - 在 PHP 应用程序中从 /dev/tty 端口读取数据无法读取错误

> ID：10645370
> 
> 赞同：2
> 
> 时间：2012-05-18T00:49:36.497
> 
> 标签：php, apache, serial-port, tty, infrared

我有一个连接到 tty 端口的 USB IR 模块，我可以很好地读取/写入数据。

现在我正在尝试运行一个可以从该端口读取数据的 PHP 应用程序，但由于某种原因，我在 Apache 上的 PHP 脚本似乎无法读取串行端口。我收到投诉“访问错误”用户（www-data）有权访问拨号组（在 /etc/group 中）：

```
...
dialout:x:20:jlumme,www-data
... 
```

如果我切换到 www-data 用户（su www-data），我可以从它所在的同一文件夹（与 PHP 脚本的同一文件夹）成功运行该程序。对 tty 的访问权限也应该没问题：

```
>ls -l /dev/tty
...
crw-rw---- 1 root dialout 166, 0 2012-05-03 19:10 ttyACM0
... 
```

我不知道该尝试什么..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:26:00.507

看起来我所要做的就是重新启动 linux 板，现在它工作正常。我不确定之前出了什么问题，可能重新启动 Apache 就可以了。

无论如何，只要确保正确的用户权限可以访问 /dev/tty 似乎就是答案！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T10:56:59.153

尝试：

```
<?php
system('whoami');
?> 
```

查看脚本是否作为 www-data 运行。

# c# - 以编程方式生成 WCF 客户端合同时重用类型

> ID：10645378
> 
> 赞同：5
> 
> 时间：2012-05-18T00:51:03.623
> 
> 标签：c#, wcf, generated

有一个带有插件的应用程序，它以编程方式生成 WCF 客户端合同，然后将其连接到插件接口，但是我正在努力弄清楚如何让生成的合同重用插件 dll 中的类型。

有谁知道如何设置 ServiceContractGenerator 以重用已定义程序集中的类型？

这是我用来生成合约代码atm的：

```
 public Assembly CreateProxy(String url)
    {
        MetadataExchangeClient mexClient = new MetadataExchangeClient(new Uri(url + "/mex"), MetadataExchangeClientMode.MetadataExchange);
        mexClient.ResolveMetadataReferences = true;

        MetadataSet metaDocs = mexClient.GetMetadata();
        WsdlImporter importer = new WsdlImporter(metaDocs);

        ServiceContractGenerator generator = new ServiceContractGenerator();

        generator.NamespaceMappings.Add("*", "NameSpace123");

        Collection<ContractDescription> contracts = importer.ImportAllContracts();
        ServiceEndpointCollection endpoints = importer.ImportAllEndpoints();

        foreach (ContractDescription contract in contracts)
            generator.GenerateServiceContractType(contract);

        if (generator.Errors.Count != 0)
            throw new Exception("There were errors during code compilation.");

        CodeDomProvider codeDomProvider = CodeDomProvider.CreateProvider("C#");
        CompilerParameters parameters = new CompilerParameters();

        parameters.CompilerOptions = string.Format(@" /lib:{0}", "\"C:\\Program Files\\Reference Assemblies\\Microsoft\\Framework\\v3.0\"");
        parameters.ReferencedAssemblies.Add("System.ServiceModel.dll");
        parameters.ReferencedAssemblies.Add("System.Runtime.Serialization.dll");

        parameters.GenerateExecutable = false;
        parameters.GenerateInMemory = true;
        parameters.IncludeDebugInformation = true;
        parameters.OutputAssembly = "WCFGenerated.dll";

        CodeCompileUnit codeUnit = generator.TargetCompileUnit;
        CompilerResults results = codeDomProvider.CompileAssemblyFromDom(parameters, codeUnit);

        foreach (CompilerError oops in results.Errors)
            throw new Exception("Compilation Error Creating Assembly: " + oops.ErrorText);

        //Must load it like this otherwise the assembly wont match the one used for the generated code below
        return Assembly.LoadFile(Directory.GetCurrentDirectory() + "\\WCFGenerated.dll");
    } 
```

编辑：我从来没有让它工作得很好，但是我确实设法将 exe 作为程序集加载并使用它来生成代理：

```
 try
        {
            Thread.CurrentThread.CurrentUICulture = CultureInfo.CurrentUICulture.GetConsoleFallbackUICulture();
            if (Console.OutputEncoding.CodePage != Encoding.UTF8.CodePage && Console.OutputEncoding.CodePage != Thread.CurrentThread.CurrentUICulture.TextInfo.OEMCodePage)
            {
                Thread.CurrentThread.CurrentUICulture = new CultureInfo("en-US");
            }

            var assembly = Assembly.LoadFile(Path.Combine(info.TempDir, SVCUTIL_EXE));

            var optionsType = assembly.GetType("Microsoft.Tools.ServiceModel.SvcUtil.Options");
            var runtimeType = assembly.GetType("Microsoft.Tools.ServiceModel.SvcUtil.ToolRuntime");

            //Options option = Options.ParseArguments(args);
            var options = optionsType.InvokeMember("ParseArguments", BindingFlags.Static | BindingFlags.NonPublic | BindingFlags.InvokeMethod, null, null, new object[] { info.Args });

            //ToolRuntime toolRuntime = new ToolRuntime(option);
            ConstructorInfo c = runtimeType.GetConstructor(BindingFlags.NonPublic | BindingFlags.Instance, null, new Type[] { optionsType }, null);
            var runtime = c.Invoke(new Object[] { options });

            //var runtime = Activator.CreateInstance(runtimeType, , null, options);

            //toolRuntime.Run();
            var exitCode = (int)runtimeType.InvokeMember("Run", BindingFlags.InvokeMethod | BindingFlags.NonPublic | BindingFlags.Instance, null, runtime, null);

            if (exitCode != 0)
                throw new Exception(String.Format("Failed to generate wcf contract code [Bad Result: {0}]", exitCode));
        }
        catch (Exception e)
        {
            if (e is TargetInvocationException)
                e = e.InnerException;

            info.E = e;
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T17:56:14.207

你已经知道 svcutil 支持这个选项（/reference 标志）。所以你只需要在反射器中打开 svcutil.exe 并执行与此方法相同的操作：Microsoft.Tools.ServiceModel.SvcUtil.ImportModule+InitializationHelper.InitReferencedContracts

```
internal static void InitReferencedContracts(Options options, WsdlImporter importer, ServiceContractGenerator contractGenerator)
{
    foreach (Type type in options.ReferencedTypes)
    {
        if (type.IsDefined(typeof(ServiceContractAttribute), false))
        {
            try
            {
                ContractDescription contract = ContractDescription.GetContract(type);
                XmlQualifiedName key = new XmlQualifiedName(contract.Name, contract.Namespace);
                importer.KnownContracts.Add(key, contract);
                contractGenerator.ReferencedTypes.Add(contract, type);
                continue;
            }
            catch (Exception exception)
            {
                if (Tool.IsFatal(exception))
                {
                    throw;
                }
                throw new ToolRuntimeException(SR.GetString("ErrUnableToLoadReferenceType", new object[] { type.AssemblyQualifiedName }), exception);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:02:40.420

如果您想要重用类型的程序集实际上被 web 服务的合同使用，那么像@peer 建议的那样添加它应该可以工作！所有 svcutil 应该需要的是 /reference 选项，它映射到他所说的内容。如果不是，则 svcutil.exe 认为程序集中的类型“A”和服务中的类型“A”不同。要么名称或名称空间存在细微差别，要么 - 在 XML 名称空间中（或架构实际上不同）。

请检查[添加服务引用时忽略“重用现有类型”](https://stackoverflow.com/questions/134064/reuse-existing-types-is-ignored-when-adding-a-service-reference) ——我的意思是，确保“现有程序集”中的“现有类型”确实映射到相同的模式领域。请注意，该合同属性必须在定义类型的程序集中！如果它是你的，只需添加并重新编译。

另外，您是否尝试过在控制台中手动运行 svcutil？您可能会在那里收到一些额外的错误/警告，也许他们会指出实际问题是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T05:05:48.920

这就是属性[ServiceContractGenerator.ReferencedTypes](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.servicecontractgenerator.referencedtypes.aspx)的用途。只需为合约添加相应的映射类型即可。

# java - 井字游戏 AI Java

> ID：10645381
> 
> 赞同：4
> 
> 时间：2012-05-18T00:51:08.383
> 
> 标签：java, artificial-intelligence, tic-tac-toe

所以这是一个大学作业，除了 AI 不知道如何“赢得胜利”，它的动作一开始并不像我想的那样随机，因为它们总是走上角。并努力下去。这项任务只需要人工智能的两条规则，即它可以“赢得胜利”或“阻止胜利”。

此外，当棋盘被填满时，游戏似乎并没有结束。它要求我选择我的行动。

我希望有些人可能对我如何改进它提出建议，或者指出我哪里出错了。

任何帮助将不胜感激。

这里是戏

```
import java.util.Scanner;

public class play {

    public static void main(String[] args) {

        System.out.println("Welcome to Tickle Tackle Toe!!! :D");
        System.out.println();

        //creat markers
        String marker1 = "x";
        String marker2 = "o";
        boolean playAgain = true;

        Scanner s = new Scanner(System.in);

        //create player objects
        Human human = new Human();
        Computer computer = new Computer();

        while(playAgain){
        //run board setup
        set Setup = new set();

        Setup.createBoard();
        Setup.printBoard();

        System.out.println("please choose your marker");
        System.out.println("type 1 for 'x' or 2 for 'o'");

        //set markers
        if(s.nextInt() == 1){
         // create player objects
         human.setMarker("x");
         computer.setMarker("o");
        } 
        else
        {
        human.setMarker("o");
        computer.setMarker("x");

        }

    // determine who goes first
    int first = (int) (Math.random() * 2);

    boolean won = false;
    int turns = 0;

   if(first == 0){
   System.out.println("You go first!");
    System.out.println();
   while(!won){
    human.takeTurn(Setup.getBoard());
    turns++;
    Setup.printBoard();
    if(Setup.hasWon(Setup.getBoard())){
        won = true;
        System.out.println("Congrats you won!");
        }
        if(turns == 9){
        won = true;
        System.out.println("Its a draw!");
        break;
        }
    if(!won){
        computer.takeTurn(Setup.getBoard(), human);
        turns++;
        System.out.println();
        Setup.printBoard();
        System.out.println();
        if(Setup.hasWon(Setup.getBoard())){
            won = true;
            System.out.println("You lost!");
            }
            if(turns == 9){
        won = true;
        System.out.println("Its a draw!");
        break;
        }
        }

   }  // close while 1
  }
  else {

    System.out.println("Computer goes first!");
    System.out.println();
    while(!won){
    computer.takeTurn(Setup.getBoard(), human);
    turns++;
    Setup.printBoard();
    if(Setup.hasWon(Setup.getBoard())){
        won = true;
        System.out.println("You lost!");
        }
    if(!won){
        human.takeTurn(Setup.getBoard());
        turns++;
        System.out.println();
        Setup.printBoard();
        System.out.println();
        if(Setup.hasWon(Setup.getBoard())){
            won = true;
            System.out.println("Congrats you won!");
            }
        }

   }  // close while 2

  }

  System.out.println("Would you like to play again? Type 1 for yes or 2 to quit");
   System.out.println();
   if(s.nextInt() == 2){
   playAgain = false;
   }

  }

}
} 
```

这是计算机课

```
class Computer extends player {

    public Computer(){

    }

    int boardsize = 3;

    public void takeTurn(String[][] board, Human human) {

    int vertical = 0;
    int horizontal = 0;
    int diagonal = 0;
    boolean mademove = false;

    // check if you can take a win horizontally
    for(int i = 0; i<3; i++){

        if(board[0][i].equals(board[1][i]) && board[0][i].equals(Marker)){

            if(board[2][i] != human.getMarker()){
            board[2][i] = Marker;
            mademove = true;
            return;
            }

        }

    }

    for(int i = 0; i<3; i++){

        if(board[2][i].equals(board[1][i]) && board[2][i].equals(Marker)){

            if(board[0][i] != human.getMarker()){
            board[0][i] = Marker;
            mademove = true;
            return;
            }

        }

    }

        // check if you can take a win vertically
    for(int i = 0; i<3; i++){

        if(board[i][0].equals(board[i][1]) && board[i][0].equals(Marker)){

            if(board[i][2] != human.getMarker()){
            board[i][2] = Marker;
            mademove = true;
            return;
            }

        }

    }

    for(int i = 0; i<3; i++){

        if(board[i][2].equals(board[i][1]) && board[i][2].equals(Marker)){

            if(board[i][0] != human.getMarker()){
            board[i][0] = Marker;
            mademove = true;
            return;
            }

        }

    }

    // check if you can take a win diagonally 

        if(board[0][0].equals(board[1][1]) && board[0][0].equals(Marker)){

            if(board[2][2] != human.getMarker()){
            board[2][2] = Marker;
            mademove = true;
            return;
            }
    }

        if(board[2][2].equals(board[1][1]) && board[2][2].equals(Marker)){

            if(board[0][0] != human.getMarker()){
            board[0][0] = Marker;
            mademove = true;
            return;
            }
    }

        if(board[0][0].equals(board[1][1]) && board[0][0].equals(Marker)){

            if(board[2][2] != human.getMarker()){
            board[2][2] = Marker;
            mademove = true;
            return;
            }
    }

        if(board[0][2].equals(board[1][1]) && board[0][2].equals(Marker)){

            if(board[2][0] != human.getMarker()){
            board[2][0] = Marker;
            mademove = true;
            return;
            }
    }

        if(board[2][0].equals(board[1][1]) && board[2][0].equals(Marker)){

            if(board[0][2] != human.getMarker()){
            board[0][2] = Marker;
            mademove = true;
            return;
            }
    }

    // BLOCKS!!!! //

    // check if you can block a win horizontally
    for(int i = 0; i<3; i++){

        if(board[0][i].equals(board[1][i]) && board[0][i].equals(human.getMarker())){
            if(board[2][i] != Marker){
            board[2][i] = Marker;
            mademove = true;
            return;
            }

        }

    }

    for(int i = 0; i<3; i++){

        if(board[2][i].equals(board[1][i]) && board[0][i].equals(human.getMarker())){

            if(board[0][i] != Marker){
            board[0][i] = Marker;
            mademove = true;
            return;
            }

        }

    }

    // check if you can block a win horizontally
    for(int i = 0; i<3; i++){

        if(board[i][0].equals(board[i][1]) && board[i][0].equals(human.getMarker())){

            if(board[i][2] != Marker){
            board[i][2] = Marker;
            mademove = true;
            return;
            }

        }

    }

    for(int i = 0; i<3; i++){

        if(board[i][2].equals(board[i][1]) && board[i][2].equals(human.getMarker())){

            if(board[i][0] != Marker){
            board[i][0] = Marker;
            mademove = true;
            return;
            }

        }

    }

    // check if you can block a win diagonally 

        if(board[0][0].equals(board[1][1]) && board[0][0].equals(human.getMarker())){

            if(board[2][2] != Marker){
            board[2][2] = Marker;
            mademove = true;
            return;
            }
    }

        if(board[2][2].equals(board[1][1]) && board[2][2].equals(human.getMarker())){

            if(board[0][0] != Marker){
            board[0][0] = Marker;
            mademove = true;
            return;
            }
    }

        if(board[0][0].equals(board[1][1]) && board[0][0].equals(human.getMarker())){
            board[2][2] = Marker;
            mademove = true;
            return;
    }

        if(board[0][2].equals(board[1][1]) && board[0][2].equals(human.getMarker())){

            if(board[2][0] != Marker){
            board[2][0] = Marker;
            mademove = true;
            return;
            }
    }

        if(board[2][0].equals(board[1][1]) && board[2][0].equals(human.getMarker())){

            if(board[0][2] != Marker){
            board[0][2] = Marker;
            mademove = true;
            return;
            }
    }

         // make random move if above rules dont apply
        for(int i = 0; i<3; i++){
        if(board[i][0] != "x" && board[i][0] != "o"){
            board[i][0] = Marker;
            return;
            }
        }
        for(int i = 0; i<3; i++){
        if(board[i][1] != "x" && board[i][0] != "o"){
            board[i][1] = Marker;
            return;
            }
        }
            for(int i = 0; i<3; i++){
        if(board[i][2] != "x" && board[i][0] != "o"){
            board[i][2] = Marker;
            return;
            }
        }

    }   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T12:15:55.027

如果您通过放置第九个棋子获胜，您将同时获得“你赢了”和“这是平局！” 消息，我认为这不是预期的行为。如果你在第九回合输了也一样。另一方面，当没有人获胜时，没有达到抽奖代码，这就是游戏没有结束的原因。这很容易解决：

```
if(!won){
    computer.takeTurn(Setup.getBoard(), human);
    turns++;
    System.out.println();
    Setup.printBoard();
    System.out.println();
    if(Setup.hasWon(Setup.getBoard())){
        won = true;
        System.out.println("You lost!");
    } else if (turns == 9){
        won = true;
        System.out.println("Its a draw!");
    }
} 
```

关于随机移动，您当前的代码循环遍历所有九个图块，在遇到的第一个空白点放置一个标记，然后返回。您想要的是列出所有空白点，然后随机选择其中一个。或者，继续生成 0 到 2 之间的 x 和 y 坐标，检查它是否为空，如果是则放置一个标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:02:30.450

所以我想我会在找到我为此做的旧代码并回答我是如何做到的之后回来的。

它可能离完美还很远，但已经非常接近了。

我从一个非常简单的播放器类开始，它可以获取和设置标记。

```
public class player {

    public String Marker;

    // set marker method

    public void setMarker(String marker){

        Marker = marker;

    }

    //get marker method 

    public String getMarker(){

        return Marker;

    }

} 
```

然后我添加了一个 set 类，它将在每次移动后设置和打印板。

```
import java.util.Random;
import java.util.Scanner;

public class set {

    // setup variables default board size and board
    private int N = 3;
    public String[][] board = new String [N][N];

    public boolean hasWon (String [] [] board){
        //horizontal 
        for(int i = 0; i<3; i++){
            if(board[i][0].equals(board[i][1]) && board[i][1].equals(board[i][2])){
                return true;
            }
        }
        //vertical
        for(int i = 0; i<3; i++){
            if(board [0][i].equals(board[1][i]) && board[1][i].equals(board[2][i])){
                return true;
            }
        }
        //diagonal
        if(board[0][0].equals(board[1][1]) && board[1][1].equals(board[2][2]) || board[2][0].equals(board[1][1]) && board[1][1].equals(board[0][2]))
            return true;
        return false;
    }

    int x = 1;

    public void createBoard(){
        for(int i = 0; i < board.length; i++){
            for(int j = 0; j < board.length; j++){
                board[i][j] = "" + (x);
                x++;
            }
        }
    }

    public void printBoard(){

        for(int i = 0; i < board.length; i++){
            for(int j = 0; j < board.length; j++){
                System.out.print("[" + board[i][j] + "]" + " ");

            }
            System.out.println();
        }

    }

    public String[][] getBoard(){

        return board;

    }

} 
```

带有 AI 的计算机课程。

```
class Computer extends player {

public Computer(){

}

int boardsize = 3;

public void takeTurn(String[][] board, Human human) {

    int vertical = 0;
    int horizontal = 0;
    int diagonal = 0;
    boolean mademove = false;

    // check if you can take a win horizontally
    for(int i = 0; i<3; i++){

        if(board[0][i].equals(board[1][i]) && board[0][i].equals(Marker)){

            if(board[2][i] != human.getMarker() && board[2][i] != Marker){
                board[2][i] = Marker;
                mademove = true;
                return;
            }

        }

    }

    for(int i = 0; i<3; i++){

        if(board[2][i].equals(board[1][i]) && board[2][i].equals(Marker)){

            if(board[0][i] != human.getMarker() && board[0][i] != Marker){
                board[0][i] = Marker;
                mademove = true;
                return;
            }

        }

    }

    // check if you can take a win horizontally
    for(int i = 0; i<3; i++){

        if(board[i][0].equals(board[i][1]) && board[i][0].equals(Marker)){

            if(board[i][2] != human.getMarker() && board[i][2] != Marker){
                board[i][2] = Marker;
                mademove = true;
                return;
            }

        }

    }

    for(int i = 0; i<3; i++){

        if(board[i][2].equals(board[i][1]) && board[i][2].equals(Marker)){

            if(board[i][0] != human.getMarker() && board[i][0] != Marker){
                board[i][0] = Marker;
                mademove = true;
                return;
            }

        }

    }

    // check if you can take a win diagonally bottom

    if(board[0][0].equals(board[1][1]) && board[0][0].equals(Marker)){

        if(board[2][2] != human.getMarker() && board[2][2] != Marker){
            board[2][2] = Marker;
            mademove = true;
            return;
        }
    }

    if(board[2][2].equals(board[1][1]) && board[2][2].equals(Marker)){

        if(board[0][0] != human.getMarker() && board[0][0] != Marker){
            board[0][0] = Marker;
            mademove = true;
            return;
        }
    }

    if(board[0][0].equals(board[1][1]) && board[0][0].equals(Marker)){

        if(board[2][2] != human.getMarker() && board[2][2] != Marker){
            board[2][2] = Marker;
            mademove = true;
            return;
        }
    }

    if(board[0][2].equals(board[1][1]) && board[0][2].equals(Marker)){

        if(board[2][0] != human.getMarker() && board[2][0] != Marker){
            board[2][0] = Marker;
            mademove = true;
            return;
        }
    }

    if(board[2][0].equals(board[1][1]) && board[2][0].equals(Marker)){

        if(board[0][2] != human.getMarker() && board[0][2] != Marker){
            board[0][2] = Marker;
            mademove = true;
            return;
        }
    }

    // BLOCKS!!!! //

    // check if you can block a win horizontally
    for(int i = 0; i<3; i++){

        if(board[0][i].equals(board[1][i]) && board[0][i].equals(human.getMarker())){
            if(board[2][i] != Marker && board[2][i] != human.getMarker()){
                board[2][i] = Marker;
                mademove = true;
                return;
            }

        }

    }

    for(int i = 0; i<3; i++){

        if(board[2][i].equals(board[1][i]) && board[0][i].equals(human.getMarker())){

            if(board[0][i] != Marker && board[0][i] != human.getMarker()){
                board[0][i] = Marker;
                mademove = true;
                return;
            }

        }

    }

    // check if you can block a win vertically

    for(int i = 0; i<3; i++){

        if(board[i][0].equals(board[i][1]) && board[i][0].equals(human.getMarker())){

            if(board[i][2] != Marker && board[i][2] != human.getMarker()){
                board[i][2] = Marker;
                mademove = true;
                return;
            }

        }

    }

    for(int i = 0; i<3; i++){

        if(board[i][2].equals(board[i][1]) && board[i][2].equals(human.getMarker())){

            if(board[i][0] != Marker && board[i][0] != human.getMarker()){
                board[i][0] = Marker;
                mademove = true;
                return;
            }

        }

    }

    for(int i = 0; i<3; i++){

        if(board[2][i].equals(board[1][i]) && board[2][i].equals(human.getMarker())){

            if(board[0][i] != Marker && board[0][i] != human.getMarker()){
                board[0][i] = Marker;
                mademove = true;
                return;
            }

        }

    }

    // check if you can block a win diagonally 

    if(board[0][0].equals(board[1][1]) && board[0][0].equals(human.getMarker())){

        if(board[2][2] != Marker && board[2][2] != human.getMarker()){
            board[2][2] = Marker;
            mademove = true;
            return;
        }
    }

    if(board[2][2].equals(board[1][1]) && board[2][2].equals(human.getMarker())){

        if(board[0][0] != Marker && board[0][0] != human.getMarker()){
            board[0][0] = Marker;
            mademove = true;
            return;
        }
    }

    if(board[0][0].equals(board[1][1]) && board[0][0].equals(human.getMarker())){
        if(board[2][2] != Marker && board[2][2] != human.getMarker()){
            board[2][2] = Marker;
            mademove = true;
            return;
        }
    }

    if(board[0][2].equals(board[1][1]) && board[0][2].equals(human.getMarker())){

        if(board[2][0] != Marker && board[2][0] != human.getMarker()){
            board[2][0] = Marker;
            mademove = true;
            return;
        }
    }

    if(board[2][0].equals(board[1][1]) && board[2][0].equals(human.getMarker())){

        if(board[0][2] != Marker && board[0][2] != human.getMarker()){
            board[0][2] = Marker;
            mademove = true;
            return;
        }
    }

    // make random move if above rules dont apply
    int rand1 = 0;
    int rand2 = 0;

    while(!mademove){

        rand1 = (int) (Math.random() * 3);
        rand2 = (int) (Math.random() * 3);

        if(board[rand1][rand2] != "x" && board[rand1][rand2] != "o"){
            board[rand1][rand2] = Marker;
            mademove = true;        

        }

    }

} 
```

}

人类阶级

```
import java.util.Scanner; 
```

类人类扩展玩家{

```
public Human(){

}

public void takeTurn(String[][] board) {

    Scanner s = new Scanner(System.in);

    boolean turn = true;

    while(turn){
        System.out.println("please enter row");
        int row = s.nextInt();
        System.out.println("please enter col");
        int col = s.nextInt();
        System.out.print("you entered "+row+" "+col);
        System.out.println();
        if(board[row - 1][col - 1] != "x" && board[row - 1][col - 1] != "o"){
            board[row - 1][col - 1] = Marker;
            turn = false;
        } // closes if
        else {
            System.out.println("Already Marker here! please guess again!");
        }
    } // ends while
} // ends method

} // ends class 
```

终于开始玩游戏了。

```
 import java.util.Scanner;

public class play {

    public static void main(String[] args) {

        System.out.println("Welcome to Tickle Tackle Toe!!! :D");
        System.out.println();

        //creat markers
        String marker1 = "x";
        String marker2 = "o";
        boolean playAgain = true;

        Scanner s = new Scanner(System.in);

        //create player objects
        Human human = new Human();
        Computer computer = new Computer();

        while(playAgain){
            //run board setup
            set Setup = new set();

            Setup.createBoard();
            Setup.printBoard();

            System.out.println("please choose your marker");
            System.out.println("type 1 for 'x' or 2 for 'o'");

            //set markers
            if(s.nextInt() == 1){
                // create player objects
                human.setMarker("x");
                computer.setMarker("o");
            } 
            else
            {
                human.setMarker("o");
                computer.setMarker("x");

            }

            // determine who goes first
            int first = (int) (Math.random() * 2);

            boolean won = false;
            int turns = 0;

            if(first == 0){
                System.out.println("You gots the winz!");
                System.out.println();
                while(!won){
                    human.takeTurn(Setup.getBoard());
                    turns++;
                    Setup.printBoard();
                    if(Setup.hasWon(Setup.getBoard())){
                        won = true;
                        System.out.println("Congrats you won!");
                    }
                    if(turns == 9){
                        won = true;
                        System.out.println("Its a bore draw!");
                        break;
                    }
                    if(!won){
                        computer.takeTurn(Setup.getBoard(), human);
                        turns++;
                        System.out.println();
                        Setup.printBoard();
                        System.out.println();
                        if(Setup.hasWon(Setup.getBoard())){
                            won = true;
                            System.out.println("You just got pwned by an A.I with an incomplete rule set. FACEPALM.");
                        }
                        if(turns == 9){
                            won = true;
                            System.out.println("Its a bore draw!");
                            break;
                        }
                    }

                }  // close while 1
            }
            else {

                System.out.println("Computer goes first!");
                System.out.println();
                while(!won){
                    computer.takeTurn(Setup.getBoard(), human);
                    turns++;
                    Setup.printBoard();
                    if(Setup.hasWon(Setup.getBoard())){
                        won = true;
                        System.out.println("You just got pwned by an A.I with an incomplete rule set. FACEPALM.");
                    }
                    if(turns == 9){
                        won = true;
                        System.out.println("Its a draw!");
                        break;
                    }
                    if(!won){
                        human.takeTurn(Setup.getBoard());
                        turns++;
                        System.out.println();
                        Setup.printBoard();
                        System.out.println();
                        if(Setup.hasWon(Setup.getBoard())){
                            won = true;
                            System.out.println("You gots the winz!");
                        }
                        if(turns == 9){
                            won = true;
                            System.out.println("Its a draw!");
                            break;
                        }
                    }

                }  // close while 2

            }

            System.out.println("Would you like to play again? Type 1 for yes or 2 to quit");
            System.out.println();
            if(s.nextInt() == 2){
                playAgain = false;
            }

        }

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-23T13:24:15.270

tttc 是我的 TicTacToeComputer 类的对象，
button[] 数组定义在 TicTacToeComputer，
TicTacToePlayer 是我的另一个具有静态 int 变量“count”的类，
TicTacToePlayer 具有三个布尔静态变量名称 winX、winY 和 win，

```
 static void move() // easiest way for move method for Artificial intelligence and study how its work and then you can use loops optimize for the code 
          {
            if ((tttc.button[0].getText().equals("O")) && (tttc.button[1].getText().equals("O")) && (tttc.button[2].getText().equals("")))
            {
              tttc.button[2].setText(TicTacToeComputer.letterO);
              tttc.button[2].setIcon(new ImageIcon("o.gif"));
              tttc.button[2].setEnabled(false);
            }
            else if ((tttc.button[3].getText().equals("O")) && (tttc.button[4].getText().equals("O")) && (tttc.button[5].getText().equals("")))
            {
              tttc.button[5].setText(TicTacToeComputer.letterO);
              tttc.button[5].setIcon(new ImageIcon("o.gif"));
              tttc.button[5].setEnabled(false);
            }
            else if ((tttc.button[6].getText().equals("O")) && (tttc.button[7].getText().equals("O")) && (tttc.button[8].getText().equals("")))
            {
              tttc.button[8].setText(TicTacToeComputer.letterO);
              tttc.button[8].setIcon(new ImageIcon("o.gif"));
              tttc.button[8].setEnabled(false);
            }
            else if ((tttc.button[1].getText().equals("O")) && (tttc.button[2].getText().equals("O")) && (tttc.button[0].getText().equals("")))
            {
              tttc.button[0].setText(TicTacToeComputer.letterO);
              tttc.button[0].setIcon(new ImageIcon("o.gif"));
              tttc.button[0].setEnabled(false);
            }
            else if ((tttc.button[4].getText().equals("O")) && (tttc.button[5].getText().equals("O")) && (tttc.button[3].getText().equals("")))
            {
              tttc.button[3].setText(TicTacToeComputer.letterO);
              tttc.button[3].setIcon(new ImageIcon("o.gif"));
              tttc.button[3].setEnabled(false);
            }
            else if ((tttc.button[7].getText().equals("O")) && (tttc.button[8].getText().equals("O")) && (tttc.button[6].getText().equals("")))
            {
              tttc.button[6].setText(TicTacToeComputer.letterO);
              tttc.button[6].setIcon(new ImageIcon("o.gif"));
              tttc.button[6].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("O")) && (tttc.button[2].getText().equals("O")) && (tttc.button[1].getText().equals("")))
            {
              tttc.button[1].setText(TicTacToeComputer.letterO);
              tttc.button[1].setIcon(new ImageIcon("o.gif"));
              tttc.button[1].setEnabled(false);
            }
            else if ((tttc.button[3].getText().equals("O")) && (tttc.button[5].getText().equals("O")) && (tttc.button[4].getText().equals("")))
            {
              tttc.button[4].setText(TicTacToeComputer.letterO);
              tttc.button[4].setIcon(new ImageIcon("o.gif"));
              tttc.button[4].setEnabled(false);
            }
            else if ((tttc.button[6].getText().equals("O")) && (tttc.button[8].getText().equals("O")) && (tttc.button[7].getText().equals("")))
            {
              tttc.button[7].setText(TicTacToeComputer.letterO);
              tttc.button[7].setIcon(new ImageIcon("o.gif"));
              tttc.button[7].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("O")) && (tttc.button[3].getText().equals("O")) && (tttc.button[6].getText().equals("")))
            {
              tttc.button[6].setText(TicTacToeComputer.letterO);
              tttc.button[6].setIcon(new ImageIcon("o.gif"));
              tttc.button[6].setEnabled(false);
            }
            else if ((tttc.button[1].getText().equals("O")) && (tttc.button[4].getText().equals("O")) && (tttc.button[7].getText().equals("")))
            {
              tttc.button[7].setText(TicTacToeComputer.letterO);
              tttc.button[7].setIcon(new ImageIcon("o.gif"));
              tttc.button[7].setEnabled(false);
            }
            else if ((tttc.button[2].getText().equals("O")) && (tttc.button[5].getText().equals("O")) && (tttc.button[8].getText().equals("")))
            {
              tttc.button[8].setText(TicTacToeComputer.letterO);
              tttc.button[8].setIcon(new ImageIcon("o.gif"));
              tttc.button[8].setEnabled(false);
            }
            else if ((tttc.button[3].getText().equals("O")) && (tttc.button[6].getText().equals("O")) && (tttc.button[0].getText().equals("")))
            {
              tttc.button[0].setText(TicTacToeComputer.letterO);
              tttc.button[0].setIcon(new ImageIcon("o.gif"));
              tttc.button[0].setEnabled(false);
            }
            else if ((tttc.button[4].getText().equals("O")) && (tttc.button[7].getText().equals("O")) && (tttc.button[1].getText().equals("")))
            {
              tttc.button[1].setText(TicTacToeComputer.letterO);
              tttc.button[1].setIcon(new ImageIcon("o.gif"));
              tttc.button[1].setEnabled(false);
            }
            else if ((tttc.button[5].getText().equals("O")) && (tttc.button[8].getText().equals("O")) && (tttc.button[2].getText().equals("")))
            {
              tttc.button[2].setText(TicTacToeComputer.letterO);
              tttc.button[2].setIcon(new ImageIcon("o.gif"));
              tttc.button[2].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("O")) && (tttc.button[6].getText().equals("O")) && (tttc.button[3].getText().equals("")))
            {
              tttc.button[3].setText(TicTacToeComputer.letterO);
              tttc.button[3].setIcon(new ImageIcon("o.gif"));
              tttc.button[3].setEnabled(false);
            }
            else if ((tttc.button[1].getText().equals("O")) && (tttc.button[7].getText().equals("O")) && (tttc.button[4].getText().equals("")))
            {
              tttc.button[4].setText(TicTacToeComputer.letterO);
              tttc.button[4].setIcon(new ImageIcon("o.gif"));
              tttc.button[4].setEnabled(false);
            }
            else if ((tttc.button[2].getText().equals("O")) && (tttc.button[8].getText().equals("O")) && (tttc.button[5].getText().equals("")))
            {
              tttc.button[5].setText(TicTacToeComputer.letterO);

              tttc.button[5].setIcon(new ImageIcon("o.gif"));
              tttc.button[5].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("O")) && (tttc.button[4].getText().equals("O")) && (tttc.button[8].getText().equals("")))
            {
              tttc.button[8].setText(TicTacToeComputer.letterO);
              tttc.button[8].setIcon(new ImageIcon("o.gif"));
              tttc.button[8].setEnabled(false);
            }
            else if ((tttc.button[4].getText().equals("O")) && (tttc.button[8].getText().equals("O")) && (tttc.button[0].getText().equals("")))
            {
              tttc.button[0].setText(TicTacToeComputer.letterO);
              tttc.button[0].setIcon(new ImageIcon("o.gif"));
              tttc.button[0].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("O")) && (tttc.button[8].getText().equals("O")) && (tttc.button[4].getText().equals("")))
            {
              tttc.button[4].setText(TicTacToeComputer.letterO);
              tttc.button[4].setIcon(new ImageIcon("o.gif"));
              tttc.button[4].setEnabled(false);
            }
            else if ((tttc.button[2].getText().equals("O")) && (tttc.button[4].getText().equals("O")) && (tttc.button[6].getText().equals("")))
            {
              tttc.button[6].setText(TicTacToeComputer.letterO);
              tttc.button[6].setIcon(new ImageIcon("o.gif"));
              tttc.button[6].setEnabled(false);
            }
            else if ((tttc.button[6].getText().equals("O")) && (tttc.button[4].getText().equals("O")) && (tttc.button[2].getText().equals("")))
            {
              tttc.button[2].setText(TicTacToeComputer.letterO);
              tttc.button[2].setIcon(new ImageIcon("o.gif"));
              tttc.button[2].setEnabled(false);
            }
            else if ((tttc.button[6].getText().equals("O")) && (tttc.button[2].getText().equals("O")) && (tttc.button[4].getText().equals("")))
            {
              tttc.button[4].setText(TicTacToeComputer.letterO);
              tttc.button[4].setIcon(new ImageIcon("o.gif"));
              tttc.button[4].setEnabled(false);
            }
            if ((tttc.button[0].getText().equals("X")) && (tttc.button[1].getText().equals("X")) && (tttc.button[2].getText().equals("")))
            {
              tttc.button[2].setText(TicTacToeComputer.letterO);
              tttc.button[2].setIcon(new ImageIcon("o.gif"));
              tttc.button[2].setEnabled(false);
            }
            else if ((tttc.button[3].getText().equals("X")) && (tttc.button[4].getText().equals("X")) && (tttc.button[5].getText().equals("")))
            {
              tttc.button[5].setText(TicTacToeComputer.letterO);
              tttc.button[5].setIcon(new ImageIcon("o.gif"));
              tttc.button[5].setEnabled(false);
            }
            else if ((tttc.button[6].getText().equals("X")) && (tttc.button[7].getText().equals("X")) && (tttc.button[8].getText().equals("")))
            {
              tttc.button[8].setText(TicTacToeComputer.letterO);
              tttc.button[8].setIcon(new ImageIcon("o.gif"));
              tttc.button[8].setEnabled(false);
            }
            else if ((tttc.button[1].getText().equals("X")) && (tttc.button[2].getText().equals("X")) && (tttc.button[0].getText().equals("")))
            {
              tttc.button[0].setText(TicTacToeComputer.letterO);
              tttc.button[0].setIcon(new ImageIcon("o.gif"));
              tttc.button[0].setEnabled(false);
            }
            else if ((tttc.button[4].getText().equals("X")) && (tttc.button[5].getText().equals("X")) && (tttc.button[3].getText().equals("")))
            {
              tttc.button[3].setText(TicTacToeComputer.letterO);
              tttc.button[3].setIcon(new ImageIcon("o.gif"));
              tttc.button[3].setEnabled(false);
            }
            else if ((tttc.button[7].getText().equals("X")) && (tttc.button[8].getText().equals("X")) && (tttc.button[6].getText().equals("")))
            {
              tttc.button[6].setText(TicTacToeComputer.letterO);

              tttc.button[6].setIcon(new ImageIcon("o.gif"));
              tttc.button[6].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("X")) && (tttc.button[2].getText().equals("X")) && (tttc.button[1].getText().equals("")))
            {
              tttc.button[1].setText(TicTacToeComputer.letterO);
              tttc.button[1].setIcon(new ImageIcon("o.gif"));
              tttc.button[1].setEnabled(false);
            }
            else if ((tttc.button[3].getText().equals("X")) && (tttc.button[5].getText().equals("X")) && (tttc.button[4].getText().equals("")))
            {
              tttc.button[4].setText(TicTacToeComputer.letterO);
              tttc.button[4].setIcon(new ImageIcon("o.gif"));
              tttc.button[4].setEnabled(false);
            }
            else if ((tttc.button[6].getText().equals("X")) && (tttc.button[8].getText().equals("X")) && (tttc.button[7].getText().equals("")))
            {
              tttc.button[7].setText(TicTacToeComputer.letterO);
              tttc.button[7].setIcon(new ImageIcon("o.gif"));
              tttc.button[7].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("X")) && (tttc.button[3].getText().equals("X")) && (tttc.button[6].getText().equals("")))
            {
              tttc.button[6].setText(TicTacToeComputer.letterO);
              tttc.button[6].setIcon(new ImageIcon("o.gif"));
              tttc.button[6].setEnabled(false);
            }
            else if ((tttc.button[1].getText().equals("X")) && (tttc.button[4].getText().equals("X")) && (tttc.button[7].getText().equals("")))
            {
              tttc.button[7].setText(TicTacToeComputer.letterO);
              tttc.button[7].setIcon(new ImageIcon("o.gif"));
              tttc.button[7].setEnabled(false);
            }
            else if ((tttc.button[2].getText().equals("X")) && (tttc.button[5].getText().equals("X")) && (tttc.button[8].getText().equals("")))
            {
              tttc.button[8].setText(TicTacToeComputer.letterO);
              tttc.button[8].setIcon(new ImageIcon("o.gif"));
              tttc.button[8].setEnabled(false);
            }
            else if ((tttc.button[3].getText().equals("X")) && (tttc.button[6].getText().equals("X")) && (tttc.button[0].getText().equals("")))
            {
              tttc.button[0].setText(TicTacToeComputer.letterO);
              tttc.button[0].setIcon(new ImageIcon("o.gif"));
              tttc.button[0].setEnabled(false);
            }
            else if ((tttc.button[4].getText().equals("X")) && (tttc.button[7].getText().equals("X")) && (tttc.button[1].getText().equals("")))
            {
              tttc.button[1].setText(TicTacToeComputer.letterO);
              tttc.button[1].setIcon(new ImageIcon("o.gif"));
              tttc.button[1].setEnabled(false);
            }
            else if ((tttc.button[5].getText().equals("X")) && (tttc.button[8].getText().equals("X")) && (tttc.button[2].getText().equals("")))
            {
              tttc.button[2].setText(TicTacToeComputer.letterO);
              tttc.button[2].setIcon(new ImageIcon("o.gif"));
              tttc.button[2].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("X")) && (tttc.button[6].getText().equals("X")) && (tttc.button[3].getText().equals("")))
            {
              tttc.button[3].setText(TicTacToeComputer.letterO);
              tttc.button[3].setIcon(new ImageIcon("o.gif"));
              tttc.button[3].setEnabled(false);
            }
            else if ((tttc.button[1].getText().equals("X")) && (tttc.button[7].getText().equals("X")) && (tttc.button[4].getText().equals("")))
            {
              tttc.button[4].setText(TicTacToeComputer.letterO);
              tttc.button[4].setIcon(new ImageIcon("o.gif"));
              tttc.button[4].setEnabled(false);
            }
            else if ((tttc.button[2].getText().equals("X")) && (tttc.button[8].getText().equals("X")) && (tttc.button[5].getText().equals("")))
            {
              tttc.button[5].setText(TicTacToeComputer.letterO);
              tttc.button[5].setIcon(new ImageIcon("o.gif"));
              tttc.button[5].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("X")) && (tttc.button[4].getText().equals("X")) && (tttc.button[8].getText().equals("")))
            {
              tttc.button[8].setText(TicTacToeComputer.letterO);
              tttc.button[8].setIcon(new ImageIcon("o.gif"));
              tttc.button[8].setEnabled(false);
            }
            else if ((tttc.button[4].getText().equals("X")) && (tttc.button[8].getText().equals("X")) && (tttc.button[0].getText().equals("")))
            {
              tttc.button[0].setText(TicTacToeComputer.letterO);
              tttc.button[0].setIcon(new ImageIcon("o.gif"));
              tttc.button[0].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("X")) && (tttc.button[8].getText().equals("X")) && (tttc.button[4].getText().equals("")))
            {
              tttc.button[4].setText(TicTacToeComputer.letterO);
              tttc.button[4].setIcon(new ImageIcon("o.gif"));
              tttc.button[4].setEnabled(false);
            }
            else if ((tttc.button[2].getText().equals("X")) && (tttc.button[4].getText().equals("X")) && (tttc.button[6].getText().equals("")))
            {
              tttc.button[6].setText(TicTacToeComputer.letterO);

              tttc.button[6].setIcon(new ImageIcon("o.gif"));
              tttc.button[6].setEnabled(false);
            }
            else if ((tttc.button[6].getText().equals("X")) && (tttc.button[4].getText().equals("X")) && (tttc.button[2].getText().equals("")))
            {
              tttc.button[2].setText(TicTacToeComputer.letterO);
              tttc.button[2].setIcon(new ImageIcon("o.gif"));
              tttc.button[2].setEnabled(false);
            }
            else if ((tttc.button[6].getText().equals("X")) && (tttc.button[2].getText().equals("X")) && (tttc.button[4].getText().equals("")))
            {
              tttc.button[4].setText(TicTacToeComputer.letterO);
              tttc.button[4].setIcon(new ImageIcon("o.gif"));
              tttc.button[4].setEnabled(false);
            }
            else if ((tttc.button[0].getText().equals("X")) && (tttc.button[4].getText().equals("O")) && (tttc.button[8].getText().equals("X")))
            {
              tttc.button[5].setText(TicTacToeComputer.letterO);
              tttc.button[5].setIcon(new ImageIcon("o.gif"));
              tttc.button[5].setEnabled(false);
            }
            else if ((tttc.button[2].getText().equals("X")) && (tttc.button[4].getText().equals("O")) && (tttc.button[6].getText().equals("X")))
            {
              tttc.button[3].setText(TicTacToeComputer.letterO);
              tttc.button[3].setIcon(new ImageIcon("o.gif"));
              tttc.button[3].setEnabled(false);
            }
            else if (tttc.button[4].getText().equals(""))
            {
              tttc.button[4].setText(TicTacToeComputer.letterO);
              tttc.button[4].setIcon(new ImageIcon("o.gif"));
              tttc.button[4].setEnabled(false);
            }
            else if (tttc.button[0].getText().equals(""))
            {
              tttc.button[0].setText(TicTacToeComputer.letterO);
              tttc.button[0].setIcon(new ImageIcon("o.gif"));
              tttc.button[0].setEnabled(false);
            }
            else
            {
              random();
            }
          }       

            static void random() // random method so that player and computer both have chance to win
                  {
                    if (TicTacToePlayer.count < 9)
                    {
                      int i = 0;
                      while (i == 0) {
                        i = (int)(Math.random() * 9.0D);
                      }
                      if (doRandomMove(tttc.button[i]))
                      {
                        tttc.button[i].setText(TicTacToeComputer.letterO);
                        tttc.button[i].setIcon(new ImageIcon("o.gif"));
                        tttc.button[i].setEnabled(false);
                      }
                      else
                      {
                        random();
                      }
                    }
                  }

                  public static boolean doRandomMove(JButton paramJButton)
                  {
                    if ((paramJButton.getText().equals("O")) || (paramJButton.getText().equals("X"))) {
                      return false;
                    }
                    return true;
                  }

    static void checkComputerWin()
      {
        if ((tttc.button[0].getText() == "X") && (tttc.button[1].getText() == "X") && (tttc.button[2].getText() == "X"))
        {
          TicTacToePlayer.winX = true;
        }
        else if ((tttc.button[3].getText() == "X") && (tttc.button[4].getText() == "X") && (tttc.button[5].getText() == "X"))
        {
          TicTacToePlayer.winX = true;
        }
        else if ((tttc.button[6].getText() == "X") && (tttc.button[7].getText() == "X") && (tttc.button[8].getText() == "X"))
        {
          TicTacToePlayer.winX = true;
        }
        else if ((tttc.button[0].getText() == "X") && (tttc.button[3].getText() == "X") && (tttc.button[6].getText() == "X"))
        {
          TicTacToePlayer.winX = true;
        }
        else if ((tttc.button[1].getText() == "X") && (tttc.button[4].getText() == "X") && (tttc.button[7].getText() == "X"))
        {
          TicTacToePlayer.winX = true;
        }
        else if ((tttc.button[2].getText() == "X") && (tttc.button[5].getText() == "X") && (tttc.button[8].getText() == "X"))
        {
          TicTacToePlayer.winX = true;
        }
        else if ((tttc.button[0].getText() == "X") && (tttc.button[4].getText() == "X") && (tttc.button[8].getText() == "X"))
        {
          TicTacToePlayer.winX = true;
        }
        else if ((tttc.button[2].getText() == "X") && (tttc.button[4].getText() == "X") && (tttc.button[6].getText() == "X"))
        {
          TicTacToePlayer.winX = true;
        }
        else if ((tttc.button[0].getText() == "O") && (tttc.button[1].getText() == "O") && (tttc.button[2].getText() == "O"))
        {
          TicTacToePlayer.winO = true;
        }
        else if ((tttc.button[3].getText() == "O") && (tttc.button[4].getText() == "O") && (tttc.button[5].getText() == "O"))
        {
          TicTacToePlayer.winO = true;
        }
        else if ((tttc.button[6].getText() == "O") && (tttc.button[7].getText() == "O") && (tttc.button[8].getText() == "O"))
        {
          TicTacToePlayer.winO = true;
        }
        else if ((tttc.button[0].getText() == "O") && (tttc.button[3].getText() == "O") && (tttc.button[6].getText() == "O"))
        {
          TicTacToePlayer.winO = true;
        }
        else if ((tttc.button[1].getText() == "O") && (tttc.button[4].getText() == "O") && (tttc.button[7].getText() == "O"))
        {
          TicTacToePlayer.winO = true;
        }
        else if ((tttc.button[2].getText() == "O") && (tttc.button[5].getText() == "O") && (tttc.button[8].getText() == "O"))
        {
          TicTacToePlayer.winO = true;
        }
        else if ((tttc.button[0].getText() == "O") && (tttc.button[4].getText() == "O") && (tttc.button[8].getText() == "O"))
        {
          TicTacToePlayer.winO = true;
        }
        else if ((tttc.button[2].getText() == "O") && (tttc.button[4].getText() == "O") && (tttc.button[6].getText() == "O"))
        {
          TicTacToePlayer.winO = true;
        }
        else
        {
          TicTacToePlayer.win = false;
          TicTacToePlayer.count += 1;
        }
        if ((!TicTacToePlayer.win) && (TicTacToePlayer.count > 8))
        {
          ImageIcon localImageIcon1 = new ImageIcon("cry.gif");
          JOptionPane.showMessageDialog(null, "The game was tie!", "Tie Game", 0, localImageIcon1);
          ImageIcon localImageIcon2 = new ImageIcon("newgame.gif");
          int i = JOptionPane.showConfirmDialog(null, "Start", "Do you want to start a New Game ?", 0, 0, localImageIcon2);
          if (i == 0)
          {
            TicTacToePlayer.count = 0;
            tttc.setVisible(false);
            new TicTacToeComputer("Wanna Play TicTacToe...!!!");
          }
          else
          {
            ImageIcon localImageIcon3 = new ImageIcon("bye.gif");
            JOptionPane.showMessageDialog(null, "Thank you " + TicTacToePlayer.x + " and " + TicTacToePlayer.z + " for playing", "Thank You", 1, localImageIcon3);
            System.exit(0);
          }
        }
        if (TicTacToePlayer.winX == true)
        {
          TicTacToePlayer.count = 0;
          tttc.setVisible(false);
          new AnimationComputerX();
          TicTacToePlayer.winX = false;
        }
        if (TicTacToePlayer.winO == true)
        {
          TicTacToePlayer.count = 0;
          tttc.setVisible(false);
          new AnimationComputerO();
          TicTacToePlayer.winO = false;
        }
      } 
```

快乐编码 :) RChadZ

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-12-06T02:39:50.040

```
//diagonal
if(board[0][0].equals(board[1][1]) && board[1][1].equals(board[2][2]) || board[2][0].equals(board[1][1]) && board[1][1].equals(board[0][2]))
       { return true;} // <<<<<you forgot the {} ^_^
    return false;
} 
```

# asp.net-mvc - MVC 助手 - 使用 @URL 作为图像 src？

> ID：10645382
> 
> 赞同：23
> 
> 时间：2012-05-18T00:51:24.717
> 
> 标签：asp.net-mvc, asp.net-mvc-3, html-helper

我正在使用 MVC3 并有一个简单的助手，它为状态应用程序绘制一个带有一些文本和图标的框。一个片段：

```
@helper Tile(string ID)
 {
 <div class="front defaulttile"> 
    <div class="notifybar" id="NotifyBarID" >
    <img alt="" src="@Url.Content("~/Images/img.jpg")" style="display: inline; margin-right: 5px;" />
    <p class="topstatusbartext" id="NotifyBarTextID" >Status bar text</p>
    </div>
etc... 
```

将 @Url.Content 用于图像 src 会很棒，但我收到一个错误，它不可用。有什么我可以添加或更改以使用它的吗？一旦应用程序在服务器上，我宁愿不需要处理路径并遇到问题。

谢谢！

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-18T21:07:26.380

好像有人问的比我好。看这个：

[在 ASP.NET MVC 中，如何使用来自 C# 代码的 Razor @Url.Content() 助手？](https://stackoverflow.com/questions/351937/in-asp-net-mvc-how-can-use-i-url-content-from-code)

您也可以在 MVC Helper中使用**@Href ，如下所示：**

```
src="@Href("../../Images/trend_up.png")" (whatever path is relative to the cshtml file)
-- or --
src="@Href("~/Images/trend_up.png")" 
```

以上是针对 MVC3 的。

在 MVC4 中，你会得到这个不错的快捷方式（注意 ~）：

```
<img id="img1" src="~/Images/trend_up.png" /> 
```

感谢 Rick Anderson、Jon Galloway 和 Eilon Lipton 的帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-06T01:08:46.337

```
 @helper Tile(string ID,UrlHelper url)
 {
 <div class="front defaulttile"> 
    <div class="notifybar" id="NotifyBarID" >
    <img alt="" src="@url.Content("~/Images/img.jpg")" style="display: inline; margin-right: 5px;" />
    <p class="topstatusbartext" id="NotifyBarTextID" >Status bar text</p>
    </div>
etc... 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-01T20:37:50.037

在 MVC4 中，能够再次使用波浪号绝对很有趣，如答案中所述：

```
src="~/Images/trend_up.png" 
```

请记住，在您的 CSS 文件中对这些图像的引用将无法识别`~`- MVC4。

然而，这不是同一个问题，因为 CSS url 中对图像的相对引用。
例如`background: url('../Images/menus/menu-left.png')`将相对于 CSS 文件的位置。因此，如果您可以设法让 CSS 文件相对于其他应用程序文件夹保持不变，那么您就可以了...

# python - 获取模式ae|ea|s3以替换python中字符串中的字符

> ID：10645383
> 
> 赞同：0
> 
> 时间：2012-05-18T00:51:35.577
> 
> 标签：python

我想给出编码指令'ae|ea|s3'，其中a被e替换，e被a替换，s被3替换为相同的字符串。但是我在编写一个程序来插入由 chr1|chr2 替换为 chr3|chr4 替换为 chr5 的模式 chr 时遇到问题。对于上述模式 chr，chr2 和 chr4 是我想用 chr1、chr3、chr5 和“|”替换的字符串中的字符 代表“和”。我搜索了谷歌，但找不到有关上述问题的任何提示。

```
def encode(filename):

  path = "C:\Users\user\Desktop"
  basename = "assgn2part1.txt"
  filename = path + "\\" + basename
  #file = open(filename, "rt")
  f = open(filename)
  contents = f.read()
  print contents ,"\n"
  chars = ["a","b","e","3","d","r","g","j","h","i"]

  newcontents = contents.translate(string.maketrans("aes","ea3"))

  print newcontents 
```

我得到的答案是：

```
 This is a message 

  Thi3 i3 e ma33ega 
```

这确实给出了结果，但我想在定义本身中插入模式

```
 encode("ae|ea|s3","C:\Users\user\Desktop\\assgn2part1.txt") 
```

给我结果，我应该能够用另一种类型的模式代替它

```
 encode("hc|m3|te","C:\Users\user\Desktop\\assgn2part1.txt") 
```

我已经非常努力但无法解决这个问题。请帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T01:03:58.360

使用它`"hc|m3|te"`变成翻译表：

```
def parse_into_translation_table(s):
    return string.maketrans(*map(''.join,zip(*map(list,s.split('|'))))) 
```

看到：

```
>>> map(''.join,zip(*map(list,"hc|m3|te".split('|'))))
['hmt', 'c3e'] 
```

是需要给的形式`string.maketrans`。

例子：

```
>>> parse_into_translation_table("hc|m3|te")
'\x00\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefgcijkl3nopqrseuvwxyz{|}~\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff' 
```

要显示如何在您的`encode`函数中使用它：

```
def encode(substitutions, filename):

   # ... file reading  ...

   newcontents = contents.translate(parse_into_translation_table(substitutions))

   return newcontents 
```

# iphone - 在移动 iPhone 上“点赞”Facebook 页面

> ID：10645384
> 
> 赞同：-1
> 
> 时间：2012-05-18T00:51:37.903
> 
> 标签：iphone, facebook, mobile

有谁知道是否有办法让 iPhone 上的用户“点赞”一个 Facebook 页面，而不必每次都通过浏览器重新登录？显然每个人都在使用该应用程序，那么有没有办法让他们只需单击“喜欢”该页面？提前致谢。

这个想法是让人们通过他们的移动浏览器点击 Facebook 页面，而无需再次登录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:06:03.913

Facebook 已经为“喜欢”页面内置了徽章。搜索了一下，发现了这个问题。 [在 iPhone 中添加 Facebook Like 按钮](https://stackoverflow.com/questions/2783803/adding-the-facebook-like-button-in-an-iphone-app)

我还发现这个可以实现单点登录[。Facebook iOS 开发者教程](http://developers.facebook.com/docs/mobile/ios/build/)

**更新：** 我正在做一些搜索，并意识到您可以使用自定义 URL 将用户发送到 Facebook 应用程序。尝试向按钮添加一个操作，该按钮发送到格式如下的 URL：`fb://page/YOURPAGEID`

# vb.net - 在线程之间共享信息

> ID：10645385
> 
> 赞同：1
> 
> 时间：2012-05-18T00:51:44.347
> 
> 标签：vb.net, multithreading

至少可以说我是一个业余爱好者，但我已经做了一些基本的程序。无论如何，我正在制作一个DVD更换机器人。硬件方面已经构建，并且可以通过串行端口很好地工作。为了使这件事发挥作用，我将不得不制作一个多线程应用程序，这是我的第一个。

该应用程序至少需要 4 个线程。2 个用于 2 个 DVD 刻录机，一个用于机器人控制，一个我正在调用一个导演，它将告诉其他 3 个线程该做什么。

我的问题是在这些线程之间共享数据的最佳方式是什么。我一直在研究共享类和线程锁，但我觉得我可能过于复杂了。我知道我可以使用数据库来传递数据并让每个线程每隔几秒钟检查一次数据库，但这对我来说并不是正确的方法。

感谢您的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T01:10:26.377

您可以将所需的任何数据传递给该`Thread.Start()`方法。这基本上是线程之间共享内容的首选方式。但是，在基本层面上，如果多个线程将访问其他线程也将访问的内容，则需要建立某种锁定机制以确保不会出现争用问题。

假设您有一个全局级别的类实例，在您的线程之间共享：

（这是 C# 但你明白了）

```
class GlobalData {

    public string SomeProperty {get; set; }
    public int SomeOtherProperty {get; set; }

} 
```

多个线程同时访问这些属性中的任何一个（或期望值在调用之间保持一致）的情况会很麻烦。所以最简单的方法是创建一个线程负责的锁定机制：

```
class GlobalData {

    public object Sentry = new object();

    public string SomeProperty {get; set; }
    public int SomeOtherProperty {get; set; }
} 
```

在运行线程的代码中，你会做这样的事情（假设`g_Data`是类的实例）：

```
void SomeMethodRunningOnAThread() {
    lock (g_Data.Sentry) {
        // do stuff    
    }
} 
```

（在 VB.NET 中相当于`lock`是`SyncLock`）

这是确保您不会陷入争用问题的最简单方法。每个线程负责确保它们在访问对象内容之前尝试锁定对象。

除此之外，当然还有一些方法可以解决这个问题，例如在包含全局数据的类中实现锁定逻辑。它并没有变得*不那么*复杂，所以如果你想最终实现更复杂的东西，你无论如何都必须阅读。

# backbone.js - Backbone.js 获取集合的一部分

> ID：10645394
> 
> 赞同：1
> 
> 时间：2012-05-18T00:53:17.647
> 
> 标签：backbone.js

我想从服务器获取列表/集合的一部分，如下所示：

```
// Model
FileItem = Backbone.Model.extend({});

// Collection
FileList = Backbone.Collection.extend({
  model: FileItem,
  url: function() {
    return '/me/file_list/' + this.id;
  }
}); 
```

但这不起作用。似乎我不能收集动态网址？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T19:56:46.833

检查[Backbone.Paginator](https://github.com/addyosmani/backbone.paginator) -`Backbone.Paginator.requestPager`可能正是您在这里寻找的。有一个很好[的使用示例](http://addyosmani.github.com/backbone.paginator/examples/netflix-request-paging/index.html)，包括`PaginatedCollection`用于您的集合的基类。

# vbscript - 在 vbscript 中为对象数组设置的替代方法

> ID：10645396
> 
> 赞同：0
> 
> 时间：2012-05-18T00:53:25.140
> 
> 标签：vbscript

您好，我已经在 vbscript 中设置了用于对象的关键字，但它不适用于数组是它们的替代方法吗？或者我只需要指定专门用于设置工作的数组类型？这是导致混乱的代码行：GenericHIDDev(i) = CreateObject("SoftHIDReceiver.HIDDevice.1")

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T18:49:17.617

在 VBScript 中，您应该[`Set Statement`](http://msdn.microsoft.com/en-us/library/4afksd44%28v=vs.84%29.aspx)在需要将对象引用分配给变量时使用。

```
Dim GenericHIDDev(0)
'GenericHIDDev(0) = CreateObject("SoftHIDReceiver.HIDDevice.1") ' wrong assignment
Set GenericHIDDev(0) = CreateObject("SoftHIDReceiver.HIDDevice.1") ' correct assignment 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T15:18:53.050

没有你的对象，但以下工作，所以使用 array(object)

```
GenericHIDDev = array(CreateObject("Scripting.FileSystemObject"))
wscript.echo GenericHIDDev(0).FileExists("c:\test.vbs") 
```

# python - Emacs 蟒蛇模式

> ID：10645401
> 
> 赞同：8
> 
> 时间：2012-05-18T00:53:47.497
> 
> 标签：python, emacs, configure, python-mode

[我正在尝试使用包python-mode.el-6.0.7](http://launchpad.net/python-mode)将 Emacs23.2 配置为与 python2.7.3 一起使用

在将这些 LISP 行添加到我的*.emacs*文件后，如安装说明中所示，...

```
(add-to-list 'load-path "PATH/TO/PYTHON-MODE/") 
(setq py-install-directory "PATH/TO/PYTHON-MODE/")
(require 'python-mode) 
```

...我打开一个文件*foo.py*，直到这里一切正常：python 被识别，语法被突出显示并且 emacs 运行良好。

但我怀疑我遗漏了什么或做错了什么......主要是因为在 python-mode 包中还有一些东西可以与 python&emacs 一起使用，比如 pycomplete、pymacs 等......看起来它们是当我打开 emacs & python 时不能一起操作。

有谁知道如何以正确的方式配置这个包，让一切正常工作？

欢迎任何（个人）建议，因为我不是 emacs 的专业人士......！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T01:36:45.473

（我想有人会提供更好的答案，但是......）

EmacsWiki 上有关 Python 支持的文档过去非常混乱，部分原因是有两种不同的主要模式可供选择，并且每种模式的信息都混合在同一个页面中。

自从我第一次遇到它以来，它显然已经被清理了很多，所以希望它不会太混乱，你会在以下之一中找到你需要的东西：

*   [http://emacswiki.org/emacs/PythonProgrammingInEmacs](http://emacswiki.org/emacs/PythonProgrammingInEmacs)
*   [http://wikemacs.org/wiki/Python](http://wikemacs.org/wiki/Python)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T19:29:33.857

当前的 python-mode.el 带有一个扩展菜单：PyEdit、PyExec 等。

[https://launchpad.net/python-mode/+下载](https://launchpad.net/python-mode/+download)

另请参阅 doc commands-python-mode.org 部分。命令-python-mode.rst

其余问题可能会在[https://answers.launchpad.net/python-mode中提交](https://answers.launchpad.net/python-mode)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-18T20:59:18.727

这是我的*init.el*中的相关行：

> (setq py-install-directory "~/.emacs.d/site-lisp/python-mode.el-6.1.1")
> 
> （添加到列表“加载路径 py 安装目录”）
> 
> （需要'python模式）

从 Launchpad下载最新版本的[python-mode](https://launchpad.net/python-mode/)并在您的 init.el 中告诉 Emacs 在哪里可以找到它。（看上面）

如果您的 Major-Mode`Py`显示您正在使用 pyhon-mode.el，如果它显示`Python`，那么您正在使用内置的 python.el 模式。

对于自动补全，你应该试试[Jedi](http://tkf.github.io/emacs-jedi/released/#manual-install)，这是一个非常好的 Python 补全库。

您可以通过非常全面的菜单条目或通过

`M-x customize-mode`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T12:15:11.707

在`python-mode`我只使用的高级功能中

```
(add-hook 'python-mode-hook (lambda ()
    (define-key python-mode-map (kbd "C-c |")
    'py-execute-region-ipython))) 
```

使用 .将区域发送到 ipython `C-c |`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-12T17:47:26.833

我可以全心全意地推荐[anaconda-mode](https://github.com/proofit404/anaconda-mode)。它为您提供自动完成、文档查找、跳转到 source++ 的功能。与 pyflakes、flymake、auto-complete-mode 和 projectile 一起，它使 Emacs 成为一个很棒的 Python 开发环境。

它也很容易设置，您可以从以下两行开始： `(add-hook 'python-mode-hook 'anaconda-mode) (add-hook 'python-mode-hook 'ac-anaconda-setup)`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-18T15:26:47.273

我建议使用其他 python-el ，例如

[https://github.com/fgallina/python.el](https://github.com/fgallina/python.el)

# javascript - Jquery插件hovercard在动态生成的内容中不起作用

> ID：10645402
> 
> 赞同：2
> 
> 时间：2012-05-18T00:54:03.357
> 
> 标签：javascript, jquery

Jquery 插件 Hovercard 在简单的 HTML 代码中运行良好，但当我在 javascript 代码中使用它时不起作用（通过 javascript 动态创建 html 代码）。或许这也是一个普遍的问题，jquery插件如何在js代码生成的内容中工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T05:52:03.317

我还没有看到你的任何代码，所以我不能确定这会有所帮助。但是使用 JS 动态添加 HTML 的问题是生成的 DOM 元素不会附加必要的事件处理程序（在 Hovercard 的情况下，`mouseover`可能`mouseout`还有其他）。解决方案是`$(...).hovercard({...})`在添加新添加的 DOM 元素*后*调用它们。例如

```
$("body").append("<a class='hovercard'>New element.</a>");
$("body a.hovercard").hovercard({...}); 
```

在此块之后，`a`标签将具有 Hovercard 效果。如果您调用`hovercard()`中的某些元素`$(document).ready()`，则*只有*`DOMContentLoaded`在事件触发时存在的那些元素才会生效（不是您以后添加的任何元素）。

# java - 你如何使用 setCurrentTab

> ID：10645405
> 
> 赞同：0
> 
> 时间：2012-05-18T00:54:24.857
> 
> 标签：java, android, tabs

你如何使用 setCurrentTab 命令？这是我现在拥有的代码......当我调试它时，我得到“C：Tab 3”所以保存方面工作正常，但标签仍然没有改变？对我有什么帮助吗？谢谢！

```
TabHost th = (TabHost)findViewById(R.id.tabhost);

        th.setup();
        TabSpec specs = th.newTabSpec("tag1");
        specs.setContent(R.id.tab1);
        specs.setIndicator("Zone Manager");
        th.addTab(specs);
        specs = th.newTabSpec("tag2");
        specs.setContent(R.id.tab2);
        specs.setIndicator("",res.getDrawable(R.drawable.ic_tab_vaccontrol));
        th.addTab(specs);
        specs = th.newTabSpec("tag3");
        specs.setContent(R.id.tab3);
        specs.setIndicator("Tab 3");
        th.addTab(specs);

        Tab = (settings.getInt("Tab", 1));
        Log.d("TabStuff", "C: Tab " + Tab);
        th.setCurrentTab(Tab); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T06:38:09.443

尝试使用`setCurrentTabByTag(String nameOfTheTabSpec)`方法而不是简单的 setCurrentTab

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T03:24:15.347

我建议遵循[Android 开发人员指南](http://developer.android.com/resources/tutorials/views/hello-tabwidget.html)。即使您不打算使用`TabActivity`. 你能发布 XML`R.id.tabX`吗？

# mysql - 使用嵌套子查询优化 mysql 查询

> ID：10645408
> 
> 赞同：1
> 
> 时间：2012-05-18T00:54:39.427
> 
> 标签：mysql, sql, subquery

长话短说，我有一些稍微复杂的查询（参见下面的示例），需要将它们的结果保存到一个表中，而不是每次都运行它们。我有大约 6 个月的 MYSQL 经验，所以我知道的足以让自己陷入困境。

背景：每个产品都有多个决定定价、运输等的规则。kitruleoptions 表将每个规则连接到它将应用的下拉选项——因此，如果客户选择“添加可选 X”，则应用与 X 相关的规则。选项集表将每个 ProductItemID 连接到与其关联的下拉选项。因此，仅当在该规则的下拉选项集中找到所有产品项的下拉选项时，该规则才应适用于特定产品项。换句话说，并不是每次选择 X 时都必须应用该规则，而是每次在下拉列表 A 中选择 X 并且在下拉列表 B 中选择 Y 或 Z 时都可能应用该规则，但如果在下拉列表中选择 W 则不是B.

下面是一个示例查询，它可以让我获得单个 ProductItemID 的总价。

```
SELECT ProductItemID, SUM(RulePrice * ItemQuantity) AS Price FROM 
(SELECT RuleGroups, ProductItemGroups, RulePrice, ItemQuantity, productitems.ProductItemID
FROM kitrules
LEFT JOIN productitems ON productitems.ProductID = kitrules.ProductID
LEFT JOIN (SELECT RuleID, GROUP_CONCAT(OptionGroupID ORDER BY OptionGroupID) AS RuleGroups 
    FROM kitruleoptions
    WHERE OptionGroupID IN (SELECT OptionGroupID FROM optionsets WHERE ProductItemID = %s)
    GROUP BY RuleID) AS k ON k.RuleID = kitrules.RuleID
LEFT JOIN (SELECT ProductItemID, GROUP_CONCAT(OptionGroupID ORDER BY OptionGroupID) AS ProductItemGroups
    FROM optionsets
    GROUP BY ProductItemID) AS o ON o.ProductItemID = productitems.ProductItemID
WHERE productitems.ProductItemID = %s AND RuleGroups = ProductItemGroups) AS x
GROUP BY x.ProductItemID 
```

目前，这个选择（或者更确切地说，一个更复杂的选择不仅仅是价格）进入一个 INSERT INTO 语句，有点像这样：

```
INSERT INTO pricelists (ProductItemID, Price) 
SELECT [the query above] 
WHERE ProductItemID = %s 
```

我正在尝试制定它，而不是像这样：

```
INSERT INTO pricelists (ProductItemID, Price)
SELECT [a new query that only requires ProductID]
WHERE ProductItemID IN (SELECT ProductItemID FROM productitems WHERE ProductID = %s) 
```

...并且只需要输入 ProductID 即可一次更新整个产品。这样，我将不再需要遍历 PHP 数组来执行此操作。在 kitrules 表和 productitems 表中都可以找到 ProductID，所以我觉得应该有办法，但我似乎找不到。所以我的问题是，如何将查询重新表述为只需要 ProductID？甚至可能吗？有没有办法在没有 GROUP_CONCAT 的情况下直接比较选项集和 kitruleoptions 集？另外，我将如何使用触发器进行设置，它应该触发什么？我以前从未做过触发器。

编辑：这是我的[SQL Fiddle](http://sqlfiddle.com/#!2/d55e9)，它有一个简单的示例说明表应该如何结束。我的想法是，我从一个设置开始，每个产品只有一个或多个项目，但是由于需求的后期变化（耶），我不得不添加生成工具包或组合项目的能力多种不同的物品，但套件本身就是物品。要求是套件的 ItemCost 是其所含物品的 ItemCosts 的总和，套件的 Price 是其包含的规则 RulePrices 乘以 ItemQuantity 的总和，其运输由其所含物品的运输信息的组合运输确定，但除此之外，套件只是另一件物品。提示三周的头痛和计数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T16:47:46.103

我最终想通了：

```
SELECT ProductItemID, SUM(RulePrice * ItemQuantity) AS TotalPrice FROM
(SELECT p.ProductItemID, k.RuleID, p_count, COUNT(k.RuleID) AS k_count,
RulePrice, ItemQuantity
FROM productitems
INNER JOIN optionsets o ON productitems.ProductItemID = o.ProductItemID
INNER JOIN (SELECT ProductItemID, COUNT(OptionGroupID) AS p_count 
        FROM optionsets
        GROUP BY ProductItemID) AS p ON p.ProductItemID = o.ProductItemID
LEFT JOIN kitruleoptions k ON k.OptionGroupID = o.OptionGroupID
LEFT JOIN kitrules ON k.RuleID = kitrules.RuleID
WHERE productitems.ProductID = %s
GROUP BY o.ProductItemID, k.RuleID
HAVING k_count = p_count) AS x
GROUP BY x.ProductItemID 
```

# antlr - 条件重写规则

> ID：10645414
> 
> 赞同：1
> 
> 时间：2012-05-18T00:55:37.820
> 
> 标签：antlr

采用以下伪规则：

```
rule: prefix? rest; 
```

我想根据前缀的出现重写 AST。

如果没有前缀，我希望将其重写为`rest`.

如果有前缀，我希望将其重写为`(PARENT prefix rest)`

```
PARENT 
-prefix
-rest 
```

换句话说，如果找到 0 或 1 替代项，我想让令牌出现在 AST 中。

[如何]这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T13:35:27.747

将其分为两个单独的选择：

```
rule
 : prefix rest -> ^(PARENT prefix rest)
 | rest        -> rest
 ; 
```

# internet-explorer - 响应式布局图像缩放 IE (w/twitter bootstrap)

> ID：10645415
> 
> 赞同：0
> 
> 时间：2012-05-18T00:56:02.553
> 
> 标签：internet-explorer, twitter-bootstrap, responsive-design, image-scaling

请不要被“只是另一个 IE 问题”吓倒。

我有一个使用 Twitter Bootstrap 构建的自定义布局，除了所有 IE（全部=6-8）之外，所有浏览器中的所有内容都可以正确缩放和缩放。我已经尝试了尽可能多的技巧来获得最大宽度以及在 IE 中工作的所有内容，但主背景图像 (id="bg") 无法在 IE 中缩放。有任何想法吗？

这是代码：

```
<html lang="en">
<!--[if lt IE 7]> <html class="ie6 oldie"> <![endif]-->
<!--[if IE 7]>    <html class="ie7 oldie"> <![endif]-->
<!--[if IE 8]>    <html class="ie8 oldie"> <![endif]-->
<!--[if gt IE 8]><!-->
<head>
<meta charset="utf-8">
<title>Alpha Marine Inc.</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">

<!--[if lt IE 9]>
<script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
<![endif]-->

<!-- Le styles -->
<link href="css/bootstrap.css" rel="stylesheet">
<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
  .sidebar-nav {
    padding: 9px 0;
  }
</style>
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/styles.css" rel="stylesheet">

<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/javascript">
function MM_changeProp(objId,x,theProp,theValue) { //v9.0
var obj = null; with (document){ if (getElementById)
obj = getElementById(objId); }
if (obj){
if (theValue == true || theValue == false)
  eval("obj.style."+theProp+"="+theValue);
else eval("obj.style."+theProp+"='"+theValue+"'");
}
}
</script>
</head>

<body>

<div class="container-fluid">
<div class="row-fluid">
        <ul class="pull-right" id="nav">
        <li><a href="#" id="home"></a>
        <li><a href="#" id="ourServices"></a>
        <li><a href="#" id="aboutUs"></a>
        <li><a href="#" id="insurance"></a>
        <li><a href="#" id="automobiles"></a>
        <li><a href="#" id="contactUs"></a>
        </ul>
</div>

<div class="row-fluid" id="banner">
    <div class="span12">
            <img id="bg" src="images/homepage.jpg" />
            <a href="#"><img id="logo" src="images/logo.jpg" /></a>
            <a href="#"><img id="splash" src="images/splash.jpg" /></a>
    </div>
</div>

<div class="row-fluid" id="sub">
    <div class="span12">
        <div style="float:right;">
        <div class="span199"><a href=""><img src="images/door2door.jpg" alt="Door to Door" onMouseOver="MM_changeProp('d2d','','backgroundPosition','bottom center','SPAN')" onMouseOut="MM_changeProp('d2d','','backgroundPosition','top center','SPAN')" /><span id="d2d" onMouseOver="MM_changeProp('d2d','','backgroundPosition','bottom center','SPAN')" onMouseOut="MM_changeProp('d2d','','backgroundPosition','top center','SPAN')"></span></a></div>
        <div class="span199"><a href=""><img src="images/door2port.jpg" alt="Door to Port" onMouseOver="MM_changeProp('d2p','','backgroundPosition','bottom center','SPAN')" onMouseOut="MM_changeProp('d2p','','backgroundPosition','top center','SPAN')" /><span id="d2p" onMouseOver="MM_changeProp('d2p','','backgroundPosition','bottom center','SPAN')" onMouseOut="MM_changeProp('d2p','','backgroundPosition','top center','SPAN')"></span></a></div>
        <div class="span199"><a href=""><img src="images/port2door.jpg" alt="Port to Door" onMouseOver="MM_changeProp('p2d','','backgroundPosition','bottom center','SPAN')" onMouseOut="MM_changeProp('p2d','','backgroundPosition','top center','SPAN')" /><span id="p2d" onMouseOver="MM_changeProp('p2d','','backgroundPosition','bottom center','SPAN')" onMouseOut="MM_changeProp('p2d','','backgroundPosition','top center','SPAN')"></span></a></div>
        <div class="span199"><a href=""><img src="images/port2port.jpg" alt="Port to Port" onMouseOver="MM_changeProp('p2p','','backgroundPosition','bottom center','SPAN')" onMouseOut="MM_changeProp('p2p','','backgroundPosition','top center','SPAN')" /><span id="p2p" onMouseOver="MM_changeProp('p2p','','backgroundPosition','bottom center','SPAN')" onMouseOut="MM_changeProp('p2p','','backgroundPosition','top center','SPAN')"></span></a></div>
        </div>
    </div>
</div>

<div class="row-fluid">
    <div class="span8">
    <ul id="foot">
    <li><img src="images/worldwide.jpg" alt="Worldwide" />
    <li><a href="#" id="africa"></a>
    <li><a href="#" id="asia"></a>
    <li><a href="#" id="australia"></a>
    <li><a href="#" id="europe"></a>
    <li><a href="#" id="nAmerica"></a>
    <li><a href="#" id="sAmerica"></a>
    </ul>
    </div>
</div>

<div class="row-fluid footerbox">
    <div class="span3">
    <ul id="subsub">
    <li><a href="#" id="priceQuote"></a>
    <li>|
    <li><a href="#" id="contact"></a>
    </ul>
    </div>
    <div class="span9">
    <ul class="pull-right" id="copy">
    <li><a href="">Terms &amp; Conditions</a> |
    <li>Copyright 2012 &copy; Alpha Marine, Inc. All Rights Reserved.
    </ul>
    </div>
</div>

</div><!-- end .container-fluid -->

</body>

</html> 
```

还有我的 css（我没有编辑任何 bootstrap 的 css）：

```
/* ============================== */
/* ! Layout for desktop version   */
/* ============================== */

/* page headers */
@font-face {
font-family: 'TrajanProBold';
src: url('/fonts/trajanpro-bold-webfont.eot');
src: url('/fonts/trajanpro-bold-webfont.eot?#iefix') format('embedded-opentype'),
     /*url('/fonts/trajanpro-bold-webfont.woff') format('woff'),*/
     url('/fonts/trajanpro-bold-webfont.ttf') format('truetype'),
     url('/fonts/trajanpro-bold-webfont.svg#TrajanProBold') format('svg');
font-weight: normal;
font-style: normal;
}

/* header nav anchors */
@font-face {
font-family: 'MyriadProSemibold';
src: url('/fonts/myriadpro-semibold-webfont.eot');
src: url('/fonts/myriadpro-semibold-webfont.eot?#iefix') format('embedded-opentype'),
     /*url('/fonts/myriadpro-semibold-webfont.woff') format('woff'),*/
     url('/fonts/myriadpro-semibold-webfont.ttf') format('truetype'),
     url('/fonts/myriadpro-semibold-webfont.svg#MyriadProSemibold') format('svg');
font-weight: normal;
font-style: normal;
}

body {
background-color:#eaeaea;
margin:0;
padding:0 33px;
}

#nav, #foot, #subsub, #copy {
list-style:none;
}
#nav {
height:20px;
margin:15px 0;
padding:0;
overflow:hidden;
}
#nav li {
height:20px;
overflow:hidden;
float:left;
margin:0;
padding:0;
}
#nav li a {
display:block;
height:20px;
background-repeat:no-repeat;
}
#nav li a#home {
background-image:url(../images/home.jpg);
background-position:top center;
width:51px;
}
#nav li a#ourServices {
background-image:url(../images/ourServices.jpg);
background-position:top center;
width:105px;
}
#nav li a#aboutUs {
background-image:url(../images/aboutUs.jpg);
background-position:top center;
width:79px;
}
#nav li a#insurance {
background-image:url(../images/insurance.jpg);
background-position:top center;
width:89px;
}
#nav li a#automobiles {
background-image:url(../images/automobiles.jpg);
background-position:top center;
width:110px;
}
#nav li a#contactUs {
background-image:url(../images/contactUs.jpg);
background-position:top center;
width:96px;
}
#nav li a#home:hover, #nav li a#ourServices:hover, #nav li a#aboutUs:hover, #nav li a#insurance:hover, #nav li a#automobiles:hover, #nav li a#contactUs:hover {
background-position:bottom center;
}

ul#nav li a, ul#nav li a:visited {
display: block;
text-decoration: none;
text-transform: uppercase;
font: normal 11pt "Myriad Pro", Arial, Helvetica, sans-serif;
height: 20px;
padding: 0 8px 0 0;
color: #1A3858;
letter-spacing: 0.2px;
}
#nav li a:hover, #nav li a:active {
color:#365D86;
}

#banner {
position:relative;
}
#row1 {
z-index:1111;
}
#row2 {
z-index:5555;
}
#row3 {
z-index:5555;
}
#banner {
height: auto;
overflow: hidden;
max-height: 90%;
}
#banner #bg {
width: expression( document.body.clientWidth < 907 ? "906px" : "auto" ); /* set min-width for IE */
height: expression( this.scrollHeight < 426 ? "425px" : "auto" ); /* sets min-height for IE */
min-height: 425px;
min-width: 906px;
}
#banner #splash {
position:absolute;
padding:0;
width:672px;
min-width: 672px;
max-width: 672px;
height:164px;
min-height: 164px;
max-height: 164px;
overflow:hidden;
bottom:35px;
right:25px;
}
#banner #logo {
display:block;
width:180px;
height:118px;
clear:both;
padding:0;
position:absolute;
top:25px;
left:35px;
text-decoration:none;
}
#banner #logo:hover {
text-decoration:none;
cursor:pointer;
}
#banner #logotext {
z-index:4444;
font-family:"Times New Roman", Times, serif;
color:#FFF;
}
#banner #logotext #first {
font-size:35px;
border-top: 2px solid #ffffff;
border-right: 2px none #ffffff;
border-bottom: 2px none #ffffff;
border-left: 2px none #ffffff;
padding:5px 0 0 0;
}
#banner #logotext #second{
font-size:20px;
border-top: 2px none #ffffff;
border-right: 2px none #ffffff;
border-bottom: 2px solid #ffffff;
border-left: 2px none #ffffff;
padding:0 0 5px 0;
}
#banner #logotext #first, #banner #logotext #second {
display:block;
text-transform:uppercase;
text-emphasis:none;
text-decoration:none;
font-style: normal;
font-variant: normal;
line-height:102%;
}

#sub {
padding:10px 0 10px 0;
min-width:419px;
}
#sub .span199 {
float: left;
width: 199px;
min-width: 199px;
max-width: 199px;
margin-left: 10px;
padding:0 0 3px 0;
border-top: 3px none #CED4DA;
border-right: 3px none #CED4DA;
border-bottom: 3px solid #CED4DA;
border-left: 3px none #CED4DA;
}
#sub div a img {
display:block;
margin:0 0 3px 0;
padding:1px 0 1px 0;
border-top: 4px solid #1a3858;
border-right: 4px none #1a3858;
border-bottom: 3px solid #CED4DA;
border-left: 4px none #1a3858;
}
#sub div span{
display:block;
height:19px;
width:97px;
}
#sub div span#d2d {
background-image:url(../images/d2d.jpg);
background-position:top center;
}
#sub div span#p2d {
background-image:url(../images/p2d.jpg);
background-position:top center;
}
#sub div span#d2p {
background-image:url(../images/d2p.jpg);
background-position:top center;
}
#sub div span#p2p {
background-image:url(../images/p2p.jpg);
background-position:top center;
}
#sub .span199 span#d2d:hover, #sub .span199 span#p2d:hover, #sub .span199 span#d2p:hover, #sub .span199 span#p2p:hover {
background-position:bottom;
}
#sub div a:link, #sub div a:visited {
color: #1A3858;
text-decoration: none;
padding: 5px 0;
font: bold 10pt/150% "Myriad Pro", Arial, sans-serif;
width: 100%;
}
#sub div a:hover, #sub div a:active {
color:#728DAA;
}

#foot {
margin: 0;
padding: 0;
display: block;
}
#foot li {
font-family: Arial, Myriad Pro, sans-serif;
color: #3f4c56;
padding: 0;
float: left;
font-size: 9pt;
text-decoration: none;
}
#foot li a {
display:block;
height:19px;
background-repeat:no-repeat;
}

#foot li a#africa {
width:45px;
background-image:url(../images/africa.jpg);
background-position:top center;
}
#foot li a#asia {
width:35px;
background-image:url(../images/asia.jpg);
background-position:top center;
}
#foot li a#australia {
width:73px;
background-image:url(../images/australia.jpg);
background-position:top center;
}
#foot li a#europe {
width:54px;
background-image:url(../images/europe.jpg);
background-position:top center;
}
#foot li a#nAmerica {
width:103px;
background-image:url(../images/nAmerica.jpg);
background-position:top center;
}
#foot li a#sAmerica {
width:103px;
background-image:url(../images/sAmerica.jpg);
background-position:top center;
}
#foot li a#africa:hover, #foot li a#asia:hover, #foot li a#australia:hover, #foot li a#europe:hover, #foot li a#nAmerica:hover, #foot li a#sAmerica:hover {
background-position:bottom center;
}
#foot li a, #foot li a:visited {
color: #3f4c56;
padding: 0 10px 0 0;
float: left;
text-decoration: none;
font: normal 9pt/36px Arial, "Myriad Pro", sans-serif;
}
#foot li a:hover, #foot li a:active {
color:#5D7282;
}

.footerbox {
border-top: 4px solid #CED4DA;
padding: 8px 0 0 0;
margin: 5px 0 0 0;
}
#subsub, #copy {
margin:0;
padding:0;
}
#subsub li, #copy li {
float:left;
margin:0 5px 0 0;
}
#subsub {
font-family:Arial, Arial, Helvetica, sans-serif;
font-size:9pt;
font-weight: normal;
color:#3f4c56;
line-height:30px;
}
#subsub li a {
display:block;
height:19px;
}
#subsub li a#priceQuote {
background-image:url(../images/priceQuote.jpg);
background-position:top center;
width:83px;
}
#subsub li a#contact {
background-image:url(../images/contact.jpg);
background-position:top center;
width:63px;
}
#subsub li a#priceQuote:hover, #subsub li a#contact:hover {
background-position:bottom center;
}
#subsub a, #subsub a:visited {
font-family:Arial, Helvetica, sans-serif;
font-size: 9pt;
font-weight: normal;
color: #3f4c56;
line-height: 30px;
}
#subsub a:hover, #subsub a:active {
color:#5D7282;
text-decoration: none;
}

#copy li, #copy a, #copy a:visited {
font-family:Arial, Helvetica, sans-serif;
font-size: 8pt;
color: #000;
line-height: 30px;
}
#copy a:hover, #copy a:active {
color:#5D7282;
text-decoration: none;
}

/* ============================= */
/* ! Layout for mobile version   */
/* ============================= */

@media handheld, only screen and (max-width: 767px) {

body {

}

}

/* ========================================== */
/* ! Provide higher res assets for iPhone 4   */
/* ========================================== */

@media only screen and (-webkit-min-device-pixel-ratio: 2) { 

/*  .logo {
    background: url(logo2x.jpg) no-repeat;
    background-size: 212px 303px;
}*/

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T18:49:37.700

Internet Explorer 8 及更低[版本不支持媒体查询](http://caniuse.com/css-mediaqueries)，因此您无法为它们进行开箱即用的响应式设计。但是，您可以使用 javascript polyfill 来启用它们。在这里你有几个：

*   [https://github.com/scottjehl/Respond](https://github.com/scottjehl/Respond)
*   [https://github.com/pyrsmk/mediatizr](https://github.com/pyrsmk/mediatizr)

希望能帮助到你！

# file - 如何在我的 drupal 7 站点上托管文件

> ID：10645416
> 
> 赞同：2
> 
> 时间：2012-05-18T00:56:05.683
> 
> 标签：file, upload, drupal-7, host

我需要上传一些文件（adobe illustrator 文件）并在 drupal 7 网站上发布下载链接。我有一个 drupal 界面的管理员帐户，但目前没有对托管该站点的服务器的 ftp 访问权限。

有没有办法通过drupal界面将文件上传到站点？这将是理想的。我只需要上传它们并链接到它们在服务器上的位置，这样我就可以创建一个带有这些链接的页面。

这是我需要 ftp 访问权限的事情吗？获得 ftp 访问权限需要几天时间……但如果我确实需要 ftp 访问权限，那么文件应该放置在 drupal 文件结构的哪个位置。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T05:17:54.300

您可以安装 IMCE 模块[http://drupal.org/project/imce](http://drupal.org/project/imce)。它为您提供了 Web 服务器上“文件”目录的文件浏览器。安装并激活它，然后您将浏览器作为您个人资料中的一个选项卡。

# c# - 如何将项目拆分为列 (MVC3)

> ID：10645419
> 
> 赞同：0
> 
> 时间：2012-05-18T00:56:37.930
> 
> 标签：c#, .net, asp.net-mvc-3

我无法弄清楚**如何将项目拆分为 N 列。** IE 分为 3 列。怎么可能做到？（不，我只是垂直做所有事情）

谢谢你的任何线索！！！

```
foreach (var answer in @question.Answers)
{
   @Html.CheckBox("answer_CheckBox_" + answer.ID.ToString(), false, new { @id = answer.ID });  
   <label style="margin-left: 0.5em;">@answer.Title</label>
   <br />                                                                                                         
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T00:59:47.880

使用模运算符将答案分成可被 3 整除的组：

```
int i = 1; 
@foreach (var answer in @question.Answers) {
   @Html.CheckBox("answer_CheckBox_" + answer.ID.ToString(), false, new { @id = answer.ID });  
   <label style="margin-left: 0.5em;">@answer.Title</label>

   i % 3 == 0 ? <br/> : ""
   i++
} 
```

*注意-如果我的剃刀语法不合理，请原谅...*

# c - C 中 strtol() 的奇怪崩溃

> ID：10645420
> 
> 赞同：4
> 
> 时间：2012-05-18T00:56:41.487
> 
> 标签：c, std, strtol

我正在使用 stdlib 库中的 strtol() 进行一些证明，因为我有一个总是崩溃的程序，我发现这非常有效：

```
main(){
char linea[]="0x123456",**ap;
int num;
num=strtol(linea,ap,0);
printf("%d\n%s",num,*ap);
} 
```

但是当我添加一个新声明时，无论它在哪里像这样崩溃

```
main(){
char linea[]="0x123456",**ap;
int num;
num=strtol(linea,ap,0);
printf("%d\n%s",num,*ap);
int k;
} 
```

只需添加最后的“int k;” 程序在执行 strtol() 时崩溃无法理解为什么。我在 Code::Blocks 上这样做

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-18T01:05:12.440

您会崩溃，因为您传递`strtol`了一个未初始化的指针，并`strtol`取消了它的引用。你不会因为纯粹的运气而第一次崩溃。

这不会崩溃：

```
main() {
    char linea[]="0x123456", *ap;
    int num;
    num = strtol(linea, &ap, 0);
    printf("%d\n%s", num, ap);
    int k;
} 
```

# c++ - C++ 程序内存计算

> ID：10645425
> 
> 赞同：1
> 
> 时间：2012-05-18T00:58:11.753
> 
> 标签：c++, visual-c++

**如何计算某个程序在运行时所花费的时间和使用的内存？**

我是 C++ 的初学者。对于我的问题，我已经看到了很多答案和不同的代码，但我都不明白。有没有简单的方法可以做到这一点？

如果有更复杂的方法，请包括解释。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T01:08:01.563

现在没有（也不会有）一个通用的工具可以告诉你一个任意程序在没有*实际*运行的情况下需要多长时间，在一般情况下这可能需要很长时间。这是一个值得思考的有趣的 CS 概念：

[http://en.wikipedia.org/wiki/Halting_problem](http://en.wikipedia.org/wiki/Halting_problem)

简而言之：您的程序运行时间无法提前知道，除非您在相当受限且数学严格的环境下运行，并且在提供某些保证的系统上对代码进行了适当的样式化：

[http://en.wikipedia.org/wiki/Real-time_operating_system](http://en.wikipedia.org/wiki/Real-time_operating_system)

如果您有经验，您可以通过查看数据结构的大小以及它们的数量来估计程序内存占用的规模*。*C++ 运算符`sizeof`可以帮助您确定任何单个对象消耗的具体字节数，但它不会告诉您有关用于“簿记”幕后的内存量的任何信息。

但是再一次，您通常只需要运行它并使用进程监视器来查看会发生什么。很难预测，您只需凭经验检查实践中发生的情况：

[跟踪每个进程的 CPU 和内存使用情况](https://stackoverflow.com/questions/69332/tracking-cpu-and-memory-usage-per-process)(Windows)

[在 Linux 中监控程序的内存使用情况](https://stackoverflow.com/questions/563168/monitor-a-programs-memory-usage-in-linux)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:17:49.480

如果您使用的是 Windows，内置的 Windows 任务管理器将在“进程”选项卡中显示您的内存使用情况。同样，Mac OSX 有“活动监视器”，它会显示你的内存使用情况。程序中的数字将随着您的程序更改状态以及分配/取消分配内存而实时更改。

至于测量执行时间，您可以使用计时器函数获取执行前后的当前系统时间，然后进行数学运算。

Windows 的[QueryPerformanceCounter](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644904%28v=vs.85%29.aspx)和[QueryPerformanceFrequency](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644905%28v=vs.85%29.aspx)以及mac/linux 机器上的[gettimeofday 。](http://linux.die.net/man/2/gettimeofday)

[如果您需要有关应用程序的更具体的性能相关信息， AMD CodeAnalyst](http://developer.amd.com/tools/CodeAnalyst/codeanalystwindows/Pages/default.aspx)等分析应用程序可以帮助您找出主要瓶颈所在。

# javascript - 在添加之前检查是否存在 css ref 链接

> ID：10645426
> 
> 赞同：3
> 
> 时间：2012-05-18T00:58:13.887
> 
> 标签：javascript, jquery, css, dynamic

我动态地将 .css 文件附加到页面。.css 文件是否已经在链接中是否重要？如何检查链接是否已经存在，我想用javascript检查头部。这是我附加课程的方式：

```
<script type="text/javascript">
(function(){
    var AppendNewStyle = document.createElement("link");
    AppendNewStyle.setAttribute("href", "/Content/Extras.css");
    AppendNewStyle.setAttribute("rel", "stylesheet");
    AppendNewStyle.setAttribute("type", "text/css");
    $('head')[0].appendChild(AppendNewStyle);
})();
</script> 
```

我可以在这里检查文件是否已经在头部，还是我不应该担心有两个链接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T01:00:37.363

[对链接元素的事件](http://www.quirksmode.org/dom/events/error.html)有模糊的支持，对[`load`事件](http://www.quirksmode.org/dom/events/load.html)的支持更糟。虽然可以通过这种方式动态加载，但这种方式并不可靠。[`error`](http://www.quirksmode.org/dom/events/error.html)

动态加载 CSS 样式的唯一可靠方法是通过 AJAX，利用 AJAX 成功和失败事件，并在成功的 AJAX 之后添加链接。

* * *

对于已经加载的样式，您可以检查所有链接元素的所有 url，并将它们与要加载的 CSS 进行比较。

```
var links = document.getElementsByTagName('link'),
    linksLen = links.length,
    i;

for(i=0;i<linksLen;i++){
    if(links[i].href.indexOf(urlToLoad) !== -1){
        //found
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T01:20:03.930

您应该能够像任何其他元素一样查询这些链接元素。由于您使用的是 Jquery：

```
var allLinks = $("link"); 
```

此外，您可以使用属性选择器来查找您关心的链接：

```
var myLink = $('link[href="' + url +'"]');  //Find the link that matches your URL 
```

如果您在应该位于链接标签下方的脚本标签中执行此操作，那么您应该不会真正遇到任何时间问题。

* * *

2017-04 编辑：

模板文字使这更加美味！

```
var myLink = $(`link[href="${url}"]`) 
```

对于所有讨厌 Jquery 的人：

```
var myLinks = document.querySelectorAll(`link[href="${url}"]`) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-21T13:46:43.450

我正在使用简单的方法来检查 css 文件是否已存在如果不存在则通过向 css 链接提供 ID 来加载

```
 var cssSelector = document.getElementById("uiCss");

    // Load UI CSS file
    if (!cssSelector) {
        var filename = 'http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css';
        var fileref = document.createElement("link");
        fileref.setAttribute("href", filename);
        fileref.setAttribute("rel", "stylesheet");
        fileref.setAttribute("type", "text/css");
        fileref.setAttribute("ID", "uiCss");
        document.getElementsByTagName("head")[0].appendChild(fileref);
    } 
```

# installation - 更改 NSIS MUI2 页面上窗口的 z-index

> ID：10645433
> 
> 赞同：0
> 
> 时间：2012-05-18T00:59:39.510
> 
> 标签：installation, nsis, modern-ui

**是否可以在 NSIS MUI2 页面上设置标题位图窗口的 z-index？**

我正在尝试使一个包含大位图的窗口位于 MUI2 页面 MUI_PAGE_WELCOME 和 MUI_PAGE_COMPONENTS 上的其他窗口（标签、复选框等）的后面。

*我已经看到我可以使用 SetWindowPos 但如何访问/查找与标题位图关联的 HWND？*

还有一种方法可以将静态、标签和复选框背景设置为透明吗？也许我可以使用 Win32 标志，还是应该使用透明位图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T05:15:00.497

这两种选择都是可能的。

要访问定义为 MUI_HEADERIMAGE_BITMAP 的位图，请使用它的 ID，即 1046（要查看这些 ID，请使用 ResHacker 在 NSIS\Contrib\UIs\ 文件夹中打开适当的 .exe 文件）

然后使用**GetDlgItem** OutputVar $HWNDPARENT 1046 来处理它。在 NSIS 中，所有 WinAPI 函数都运行良好。

1) 创建整个背景非常棘手 - 它需要大量编码。安装程序的窗口由外部对话框和内部对话框组成，因此您需要添加两个位图（每个对话框一个） 因为这是很多代码，我可以向您推荐这个解决方案：[NSIS 的图形安装程序，](http://graphical-installer.com/)用于创建看起来很酷的安装程序。

2)：使用**SetCtlColors ControlHwnd** TextColor 透明 这适用于大多数控件，但在 WinXP 上会出现一些问题。另一种方法是对每个控件进行子类化并覆盖它的 WM_PAINT 消息（编写简单的 C 插件）。

# php - 我应该坚持使用简单的 mysql_num_rows() 的 mysql_* 函数，并使用 PDO 进行更大的查询吗？

> ID：10645434
> 
> 赞同：0
> 
> 时间：2012-05-18T00:59:45.243
> 
> 标签：php, mysql

我正在将所有查询转换为 PDO，但我想知道是否应该将“简单”查询保留为 mysql_* 函数，例如：

`echo mysql_num_rows(mysql_query("SELECT id FROM users WHERE user_id='$user_id'"))`

我的意思是它只需要一行代码，如果我使用 PDO，则需要 4 行来编写。此查询的唯一目的是计算行数并回显结果。

对于那种小查询，我应该坚持使用 mysql_* 吗？另外，请注意，在我的脚本中，还有 10 个类似这样的查询。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T01:14:45.830

就我个人而言，我会将它们全部转换。我这么说的主要原因是因为每个请求都有 2 个到数据库服务器的连接。1 个用于旧`mysql_`功能，1 个用于 PDO。没什么大不了的，但是如果您的网站/变得非常大，那么您不需要的只是更多的内存和开销。如果您过载，而不是说与 MySQL 服务器的 500 个连接，您现在将其提高到 1000，这意味着更多的内存和更多的线程，并在不必要时将您推向资源限制。

除了您自己之外，我还可以看到未来开发人员的潜力，他们看到了两者的用法，但不理解在特定情况下使用其中一个或另一个的原因。这可能不是问题，但如果代码是并且永远是你来管理的。

# python - 以实例作为第一个参数的未绑定方法得到字符串但需要其他东西

> ID：10645444
> 
> 赞同：10
> 
> 时间：2012-05-18T01:01:14.763
> 
> 标签：python, oop, methods

```
#Maps.py
class Maps(object):

    def __init__(self):
        self.animals = []
        self.currently_occupied = {}

    def add_animal(self, name):
        self.animals.append(name)
        self.currently_occupied = {robot:[0, 0]}

#animal.py
class Animal(object):

    def __init__(self, name):
        import maps
        maps.add_animal(rbt)
        self.name = name

#Tproject.py
from Animal import Animal
Fred = Animal("Fred") 
```

给了我一个看起来像这样的错误

类型错误：必须使用 Maps 实例作为第一个参数调用未绑定的方法 add_animal()（改为获取 str 实例）

但我不知道这是什么意思，我无法通过谷歌或雅虎搜索:(

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T01:20:23.220

您需要一个 Maps 实例，而不是 Maps 类：

```
 maps.Maps.add_animal("Fred") # gives error

 mymap = maps.Map()

 mymap.add_animal("Fred") # should work 
```

因此，您应该在 Animal 类、每个 Animal 实例上或作为全局对象具有 mymap 属性（无论哪种方式最适合您的情况）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T01:13:05.067

您正在调用未绑定的方法，这意味着您正在从类本身访问方法，而不是通过实例（因此 Python 不知道应该将哪个实例用作`self`）。这段代码不应该给出如图所示的错误，但我假设你正在做类似的事情

```
maps.Maps.add_animal(rbt) 
```

目前尚不清楚您要做什么，或者我会就如何解决它提出建议。

# jquery - Jquery为表中的项目查找多个条件

> ID：10645445
> 
> 赞同：2
> 
> 时间：2012-05-18T01:01:35.900
> 
> 标签：jquery

嗨，我有一张像这样的桌子：

```
<table class="approvalstable"> 
  ... 
  <tr>
     <td class="projectapproval"> 
       <img src="../../Content/Images/stock_lock.gif" alt="locked" class="lockicon invisibleforprint" /> 
     </td>
     <td>
        <input type="checkbox" class="projectcheckbox approvalcheckbox" checked="checked" />
     </td> 
  </tr>
  <tr>
     <td class="projectapproval"> 
        <img src="../../Content/Images/stock_lock.gif" alt="locked" class="lockicon invisibleforprint" />
     </td>
     <td>
       <input type="checkbox" class="projectcheckbox approvalcheckbox" />
     </td> 
  </tr>
  <tr>
     <td class="projectapproval">
     </td>
     <td>
       <input type="checkbox" class="projectcheckbox approvalcheckbox" />
     </td>
  </tr> 
  ... 
</table> 
```

到目前为止，要获得其中没有锁定图像的行数，我有：

```
$('.approvalstable td.projectapproval:not(:has(img.lockicon))').length 
```

但是，我还有一个进一步的要求，即只获取其中没有锁定图像的行数，其中也有一个选中的复选框。

好的，要使用选中的复选框获取号码：

```
$('.projectcheckbox:checked').length; 
```

谁能告诉我如何组合它们？我正在尝试获取在同一行中的单元格中没有锁定图像和选中复选框的行数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:37:20.953

尝试：

```
$('tr').find('img.lockicon').parents('tr').find('input.projectcheckbox:checked').length 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/QrXsx/)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:10:05.573

`$('.approvalstable td.projectapproval:not(:has(img.lockicon))').filter('.projectcheckbox:checked').length`应该做的伎俩。

# setup-deployment - 命令行参数未压缩的自解压 EXE

> ID：10645450
> 
> 赞同：1
> 
> 时间：2012-05-18T01:02:23.890
> 
> 标签：setup-deployment, self-extracting, winzip

我目前正在使用 WinZip 创建自解压 EXE。过去，我不得不使用十六进制编辑器修改自解压 EXE 中的文件名，这很容易，因为 WinZip 将文件名存储为纯文本，根本没有压缩或编码。 **我想知道是否有人对 WinZip 等其他程序的格式足够熟悉，知道是否有任何人以易于使用十六进制修改的未压缩格式存储自解压完成后要运行的程序的命令行参数-编辑？** 从检查 WinZip 来看，参数似乎以一种奇怪的格式存储，因为我在生成的 EXE 中多次看到它们并且它们似乎不容易修改。

我并没有真正在十六进制编辑器中修改这些，我只是将其用作更容易理解的示例。我实际上在我的 Web 服务器上的 ASP.NET 代码中对此进行了修改，因为我流式传输文件以供下载，并注入一些特定于每个下载/会话的数据，我的应用程序稍后会在安装后使用这些数据。我知道我可以为每次下载在我的网络服务器上构建 EXE，但如果可以的话，我宁愿避免服务器上的开销......事实上，我已经必须读取文件，修改它，编写它退出，签名，然后让他们下载。所以我想压缩不会太多，但我宁愿避免像使用不同的应用程序来构建我的自解压 EXE 一样简单。

# plugins - 无法为 Eclipse 安装 ADT 插件

> ID：10645453
> 
> 赞同：0
> 
> 时间：2012-05-18T01:02:51.200
> 
> 标签：plugins, adt

我正在使用正确的存储库链接。我上次尝试安装 ADT 插件，但当它给我安全警告时我不小心停止了安装（当时我应该单击确定）。所以现在，我再次尝试，我无法安装 Android 开发工具。如果我选择安装它，它不会让我继续安装。

因为我不允许发布图片，所以[这里](http://s19.postimage.org/wwnct4spf/trouble.png)有一个图片链接来解释问题。注意灰色的下一步按钮，以及底部的错误。

现在，我不需要安装这些工具（我对此表示怀疑，但有可能），或者我需要从其他地方安装它们。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:38:07.317

启用***安装期间联系所有更新站点以查找软件***

![在此处输入图像描述](../Images/b007d2df5bfe15df76a564f4786b3d01.png)

并确保您还启用了 Eclipse 更新站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:05:59.913

尝试删除存储库并再次添加它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-04T23:21:15.180

我有同样的问题。您可能正在做的是使用您在 adt-bundle zip 文件中下载的 eclipse。要解决此问题，请删除 eclipse 文件夹，从 eclipse 自己的站点下载新的 eclipse 安装。将其提取到旧的位置并重复您一直在尝试的操作。

# python - 有人 SQL 会如何注入这个？

> ID：10645454
> 
> 赞同：4
> 
> 时间：2012-05-18T01:02:58.260
> 
> 标签：python, mysql, sql

我被告知以下是不安全的：

```
cursor.execute("""SELECT currency FROM exchange_rates WHERE date='%s'"""%(self.date)) 
```

为什么是`'%s'`坏的？有人会如何在这里实际进行 SQL 注入？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T01:07:31.653

想象一下，如果`self.date`是`"'; DROP TABLE exchange_rates --"`。然后你将执行：

`SELECT currency FROM exchange_rates WHERE date=''; DROP TABLE exchange_rates -- '`

和繁荣，你被冲洗了。您必须转义，`'`因此 的值`self.date`将完全包含在字符串中，而不是作为查询执行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-18T01:10:15.697

问题是当您应该*与查询分开传递值*时，您使用的是字符串格式。

例如，比较：

```
cursor.execute("SELECT currency FROM exchange_rates WHERE date=?", self.date) 
```

使用字符串格式化方法，有人可以将 a`;`放入值中（编辑：具体来说，用 a 关闭引号，`'`然后添加分号），然后尝试在此之后注入额外的查询，它将像那样执行。通过单独传递值，您可以确保*数据仅被视为数据*，而不是作为查询执行。

在这种情况下，一个额外的好处是，如果 self.date 是 python 日期或日期时间对象，则在发送时将自动以适合您的数据库的方式对其进行格式化。如果您尝试将 self.date 直接添加到查询字符串中，则必须使用日期格式来确保其输出完全符合数据库的预期。

# html - 插入html标签

> ID：10645459
> 
> 赞同：0
> 
> 时间：2012-05-18T01:03:45.600
> 
> 标签：html, vba, ms-word

我有数百个 Word 文档，我需要按以下方式插入 html 标签：

**粗体**短文本行

变成

`<b>`粗体短文`</b>`本行

有谁知道这样做的最简单和最有效的方法？

目前正在考虑做一个宏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:40:37.267

这是我找到的一个解决方案，用 Word 2010 测试过：

在搜索和替换对话框中，

将 Find what: 字段留空 在 Replace with: put`<b>^&</b>`
在 Format -> Font 部分，选择 Bold
Replace All

这会将标签放在您的粗体文本周围。然后，您可以将其复制到网页中。

### 编辑：

或者，您可以使用带有搜索和替换的通配符，使用模式`\<b\>(*)\</b\>`。

# r - R：使用 RCurl 和 postForm 检索数据

> ID：10645467
> 
> 赞同：3
> 
> 时间：2012-05-18T01:04:36.833
> 
> 标签：r, web-scraping, rcurl

我正在尝试从网站上抓取一些数据。这是我在 Perl 中通常会做的事情，但我真的很想摆脱 Perl。（我不是在贬低 Perl；它是一个很有价值的工具，但十多年后我仍然在为这门语言苦苦挣扎，这让我很苦恼。）由于我的需求很简单，而且性能对我来说很少成为问题，所以我想将我的网络抓取转移到 R。我知道一些 R，但我从未使用过 RCurl 或类似的库。

任务是抓取一个公开可用数据的数据库。这个问题因为我不知道如何传递参数而变得复杂，因为我只是在查看 JS 源代码并试图找出要包含在 RCurl postForm 请求中的内容。下面的代码不会抛出任何明显的错误，但也不会返回任何有用的东西。

问：我做错了什么？

[已编辑：反映建议的更改，但尚未解决]

```
require(RCurl)
## -----------> Form:
## http://jamaserv.jama.or.jp/newdb/eng/index.html
## -----------> Result:
## http://jamaserv.jama.or.jp/newdb/eng/prod4/prod4TsMkEntry.html

#POST /newdb/eng/prod4/prod4TsMkEntry.html makerCd=5&additionBase=1&additionInterval=1&chkSelCnd3=0&car4Cd=100005&termFrom=201103&termTo=201203&prod4TsMkEntryForm%3AdoAction=Server&prod4TsMkEntryForm%2Feng%2Fprod4%2Fprod4TsMkEntry.html=prod4TsMkEntryForm

#POST /newdb/eng/prod4/prod4TsMkEntry.html?pass chkSelCnd3=0&prod4TsMkEntryForm%2Feng%2Fprod4%2Fprod4TsMkEntry.html=prod4TsMkEntryForm&makerCd=5&additionBase=1&termTo=201203&prod4TsMkEntryForm%3AdoAction=Server&additionInterval=1&termFrom=201103&car4Cd=100005

x <- postForm('http://jamaserv.jama.or.jp/newdb/eng/prod4/prod4TsMkEntry.html?pass',
              chkSelCnd3 = '0',
              'prod4TsMkEntryForm/eng/prod4/prod4TsMkEntry.html' = 'prod4TsMkEntryForm',
              makerCd = '5',
              additionBase = '1',
              termTo = '201203',
              'prod4TsMkEntryForm:doAction' = 'Server',
              additionInterval = '1',
              termFrom = '201103',
              car4Cd = '100005',
              .opts = curlOptions(
              referer = 'http://jamaserv.jama.or.jp/newdb/eng/prod4/prod4TsMkEntry.html',
              verbose = TRUE,
              header = TRUE,
              followLocation = TRUE,
              useragent = 'Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13'
  )
) 
```

使用浏览器时，表单如下所示： ![在此处输入图像描述](../Images/8293b1a790e7a82091bcc167d6716c99.png)

以上设置返回（在单独的页面上）： ![在此处输入图像描述](../Images/bae81fd3bb3546391154d8416ba4add1.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T02:16:33.123

您可以添加一个`.opts`参数，以指定引用者（某些网站拒绝来自外部的查询），一个用户代理（某些网站拒绝未知的用户代理）并要求遵循重定向（这就是您的结果为空的原因）。如果您添加`verbose=TRUE`了更多信息：初始 POST 查询实际上失败，在发送表单内容之前，RCurl 尝试进行 GET 查询，而不是返回错误消息（“未选择类型（机动车辆）”）。

```
x <- postForm(
  ...,
  .opts = curlOptions(
    referer="http://jamaserv.jama.or.jp/newdb/eng/prod4/prod4TsMkEntry.html",
    verbose = TRUE, 
    followLocation = TRUE,
    useragent = "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13"
  )
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-17T08:30:36.290

结果证明这是一个比它最初出现的复杂得多的问题，涉及服务器端 Javascript 和各种东西。我在这个问题中使用的简单方法似乎不可行。所以，回答我自己的问题并继续...

# php - 管理问答网站上的用户积分

> ID：10645469
> 
> 赞同：1
> 
> 时间：2012-05-18T01:04:48.780
> 
> 标签：php, mysql, points

我正在制作一个类似于 Yahoo Answers 的问答网站。它将有一个积分系统，用户可以在其中对答案进行投票，但我不知道我是否应该删除用户在某个主题上获得的积分，如果它被删除（如果他们有任何问题，我应该把被删除的积分加回去票）。这引出了我的主要问题：最好的方法是什么？

我制作了一张`points`表格，每当用户获得积分时，它就会记录在`points`表格中，然后从`users`表格的总数中添加/减去。

但是，如果一个问题被删除，我将如何设法减去所获得的分数（并将因反对票而失去的分数加回来）？

我的表的结构`points`是（我刚刚做了一个`SHOW CREATE TABLE points`查询）：

```
CREATE TABLE `points` (
 `pid` int(11) NOT NULL AUTO_INCREMENT,
 `point_user` int(11) NOT NULL,
 `question_id` int(11) NOT NULL,
 `timestamp` int(25) NOT NULL,
 PRIMARY KEY (`pid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci 
```

和`users`表：

```
CREATE TABLE `users` (
 `id` int(11) NOT NULL AUTO_INCREMENT,
 `uid` int(11) NOT NULL,
 `fname` varchar(30) COLLATE utf8_unicode_ci NOT NULL,
 `lname` varchar(30) COLLATE utf8_unicode_ci NOT NULL,
 `username` varchar(15) COLLATE utf8_unicode_ci NOT NULL,
 `password` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
 `confirm_key` varchar(40) COLLATE utf8_unicode_ci NOT NULL,
 `email` varchar(80) COLLATE utf8_unicode_ci NOT NULL,
 `user_pic` varchar(300) COLLATE utf8_unicode_ci NOT NULL,
 `user_title` varchar(30) COLLATE utf8_unicode_ci NOT NULL,
 `moderator` varchar(5) COLLATE utf8_unicode_ci NOT NULL DEFAULT 'false',
 `deleted` varchar(4) COLLATE utf8_unicode_ci NOT NULL DEFAULT 'no',
 `suspended` varchar(4) COLLATE utf8_unicode_ci NOT NULL DEFAULT 'no',
 `points_count` int(11) NOT NULL DEFAULT 0,
 PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci 
```

我只是不知道如果它被删除，删除/归还问题上获得/丢失的分数是否是个好主意。

我知道 Stack Overflow 可以做到这一点，但他们有一个更先进的系统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:27:03.297

如果删除，我会做返回点。

在您的`users`情况下，我建议您进行两项更改：

```
`moderator` tinyint(1) COLLATE utf8_unicode_ci NOT NULL DEFAULT 0,
`deleted` tinyint(1) COLLATE utf8_unicode_ci NOT NULL DEFAULT 0,
`suspended` tinyint(1) COLLATE utf8_unicode_ci NOT NULL DEFAULT 0, 
```

我认为`tinyint`比`varchar`这种情况要好。

而且我还会在您的`points`表格`id`上添加`user`+1/-1 的问题，以便您可以在需要返还积分时跟踪用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:57:20.797

如果您想在删除问题时删除分数，我能想到的一种方法是使用[数据库触发器](http://dev.mysql.com/doc/refman/5.1/en/triggers.html)。

您可以在对表执行 DELETE 语句时触发触发器`points`，然后`users`使用适当的重新计算更新表，确保表中的`total`列`users`正确。

对于如果删除问题是否“合乎逻辑”修改用户点的问题，这是您的偏好，因为您是实施网站逻辑的人。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T01:25:01.133

我的想法是，仅仅因为行政变化，花时间回答问题的人仍然赢得了它......只是我的看法 - 我可能是错的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T01:41:58.097

我相信用户仍然应该因为发送帖子所花费的时间而获得奖励。此外，如果您的用户组认为答案应该被否决，则用户仍应受到“惩罚”。请记住，答案/问题站点中的积分系统是此类站点的决定因素。

话虽如此，如果您仍打算向/从在已删除帖子上获得积分的用户返回/获取积分，这是在 SQL 中执行此操作的方法

```
SELECT u.user_id, SUM(//points awarded)
FROM points p
JOIN users u ON p.point_user = u.user_id
Group By p.point_user 
```

# ios - Facebook 连接 - 集成到 iOS 应用程序错误

> ID：10645470
> 
> 赞同：0
> 
> 时间：2012-05-18T01:04:50.627
> 
> 标签：ios, facebook, xcode4, fbconnect

我目前正在尝试使用 Xcode 将 Facebook 集成到我的 iOS 应用程序中。我正在尝试遵循[https://developers.facebook.com/docs/mobile/ios/build/](https://developers.facebook.com/docs/mobile/ios/build/)上的 Facebook 教程， 但是当我尝试添加 Facebook 类时，我收到一个错误。我已成功将 fbconnect 文件夹添加到我的应用程序中，并将 src 目录添加到构建设置中的标题搜索路径中。我刚刚开始本教程，并且已经收到错误消息。请帮忙

这是我收到问题的代码... //AppDelegate.h

```
#import <UIKit/UIKit.h>
#import "FBConnect.h"

@class ViewController;

@interface AppDelegate : NSObject <UIApplicationDelegate,FBRequestDelegate,FBSessionDelegate,FBDialogDelegate>{

Facebook *fb; //This is where the error is

}

@property (strong, nonatomic) UIWindow *window;

@property (strong, nonatomic) ViewController *viewController;

@property(nonatomic,retain)Facebook *fb;   //This is where the error is
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:12:38.357

将这一行添加到代码的顶部怎么样？

" `#import "Facebook.h`"

# iis-7 - 发布 ASMX 请求时，在 Windows 7 上安装新的 IIS 7.5 会生成错误 500，但不记录详细信息

> ID：10645471
> 
> 赞同：1
> 
> 时间：2012-05-18T01:05:11.607
> 
> 标签：iis-7, asmx

在我刚刚安装 IIS 的新（ish）Windows 7 x64 开发笔记本电脑上，我正在尝试运行使用 .NET 4.0 编译并使用安装项目中的 MSI 安装的 .asmx Web 服务。但每当我尝试从 SoapUI 或从 .NET WCF 客户端执行服务时，我都会收到 HTTP 错误 500 响应。而且我找不到有关该错误的更多详细信息。这是进入 IIS 日志的内容：

```
2012-05-17 21:51:23 10.10.14.155 POST /CwtReservationPushService/ReservationPushService.asmx - 443 - 10.10.14.155 Jakarta+Commons-HttpClient/3.1 500 0 0 121 
2012-05-17 22:03:45 ::1 POST /CwtReservationPushService/ReservationPushService.asmx - 443 - ::1 - 500 0 0 131 
```

但我可以找到的系统事件查看器日志中没有记录任何内容；C:\Windows\System32\LogFiles\HTTPERR\httperr1.log 文件中没有关于错误 500 的内容。我安装了 Failed Request Tracing 并启用了它，但在生成的 XML 中似乎唯一相关的部分是：

```
ModuleName  ManagedPipelineHandler
Notification    16
HttpStatus  500
HttpReason  Internal Server Error
HttpSubStatus   0
ErrorCode   0
ConfigExceptionInfo     
Notification    MAP_REQUEST_HANDLER
ErrorCode   The operation completed successfully. (0x0) 
```

这是 SoapUI 得到的结果：

```
HTTP/1.1 500 Internal Server Error
Cache-Control: private
Transfer-Encoding: chunked
Content-Type: text/xml; charset=utf-8
Server: Microsoft-IIS/7.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Fri, 18 May 2012 01:00:14 GMT 
```

我还能在哪里查找导致此错误 500 的原因？广泛的谷歌搜索没有产生任何有用的信息。或者任何人都熟悉这个错误？

我应该提到，浏览到 .asmx 成功产生了通常的“支持以下操作。有关正式定义，请查看服务描述”页面，并且 SoapUI 和我的 .NET WCF 客户端都能够从中检索 WSDL URL 来建立他们的代理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:32:43.560

哦，伙计，有时只需要开车回家，吃一顿晚餐，和孩子们共度一个晚上，以及一个 Stackoverflow 帖子。

我突然想起了很久以前在某个旧版本的 Windows 上遇到的一个类似且完全神秘的问题：我所要做的就是安装或启用一些我震惊地发现默认情况下没有安装和启用的东西。事实上，我进入了程序和功能，打开或关闭 Windows 功能，浏览到 Internet 信息服务/万维网服务/应用程序开发功能，并选中了 .NET 可扩展性和 ASP.NET 旁边的复选框。

![所需功能](../Images/5df678dcb513804aa6b0e69cdfa82965.png)

现在我得到了一个漂亮的 SOAP 响应。

-1，大量失败，嘘声，不喜欢等，微软仍然不允许这个错误更加透明。

# java - 为什么调用构造函数时不需要泛型类型？

> ID：10645474
> 
> 赞同：0
> 
> 时间：2012-05-18T01:05:21.027
> 
> 标签：java, eclipse, generics

我了解围绕泛型的类型擦除，但我仍然惊讶地发现这段代码没有产生错误：

```
public class MyClass {
  private final HashMap<ClassA,ClassB> hashMap;

  public MyClass() {
    this.hashMap = new HashMap<>();
  }
} 
```

大多数情况下，我使用 Java 1.6 的 Java 标准版本的 Eclipse，当我选择自动完成的构造函数名称时，泛型类型会自动填充。我现在使用的是 Eclipse 和 Java 1.7 的 J2EE 版本，但它们不是。代码编译并且没问题。这是完全多余的信息，所以我不明白为什么需要它。但是你不必把它放出来就感觉不对。

为什么这不是必需的，或者我在这里完全遗漏了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T01:08:15.257

实际上，通过键入`<>`，您会说“嘿，编译器，为我完成工作并按照声明中的说明填写泛型。”

它被称为[钻石运算符](http://www.google.com/search?q=java+7+diamond+operator)，是 Java 7 的新手，请参阅[SO 上的这个问题](https://stackoverflow.com/questions/4166966/what-is-the-point-of-the-diamond-operator-in-java-7)或[官方教程](http://docs.oracle.com/javase/tutorial/java/generics/gentypes.html#diamond)。

如果您`this.hashMap = new HashMap();`改为编写，那么编译器应该会抱怨（并且通常会抛出警告）。

# java - 对于这三种特定情况，如何以及何时使用（或不使用）例外？

> ID：10645475
> 
> 赞同：1
> 
> 时间：2012-05-18T01:05:48.700
> 
> 标签：java, c++, exception, exception-handling, error-handling

这是一个面试问题，已经完成了。

以下哪种情况应该抛出异常？解释你的推理。

(1) 有人试图将 PackingBox 的容量设置为负值。

(2) 在对象用来设置其初始状态的配置文件中发现语法错误。

(3) 在字符串数组中搜索程序员指定的单词的方法找不到该单词的任何出现。

从 [何时以及如何使用异常处理？](https://stackoverflow.com/questions/4506369/when-and-how-should-i-use-exception-handling)

" 但是如果你从你自己的程序中得到一些无效的数据 - 不要抛出异常。如果你的问题来自你自己的错误代码，最好使用 ASSERT 来防范它。需要异常处理来识别问题程序无法处理并告诉他们有关用户的信息，因为用户可以处理它们。”

我认为：（1）应该使用异常，因为输入来自用户。错误不是从程序内部生成的。

(2) 和 (3) 不应使用异常，因为它们来自程序内部。而且，用户无能为力。所以，我们应该使用“assert”或“if”分支来处理程序本身的错误。

正确的 ？

任何帮助表示赞赏。

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T01:08:02.233

> (1) 有人试图将 PackingBox 的容量设置为负值。

这是一个编程错误，它应该触发一个断言而不是异常。这只是代码中的一个错误。如果负值来自用户输入，则错误不会验证它。

> (2) 在对象用来设置其初始状态的配置文件中发现语法错误。

这是一个特殊的情况。

> (3) 在字符串数组中搜索程序员指定的单词的方法找不到该单词的任何出现。

这不是特殊情况，未找到匹配项是预期结果。

# sql-server - 如何避免在 ms-sql select 语句中除以 0？

> ID：10645479
> 
> 赞同：2
> 
> 时间：2012-05-18T01:06:09.293
> 
> 标签：sql-server, select, null, divide-by-zero

我已经阅读了关于`nullif`，但无法整理出一个`SELECT`声明来正确使用它：

```
Select (num/total) as percent ... 
```

**如果总计为 0，我想返回 Null**。如何修改声明？

如果我说

```
select (num/nullif(total, 0)) as percent ... 
```

除以 Null 是什么意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T01:07:55.420

你可以使用[`CASE`](http://msdn.microsoft.com/en-us/library/ms181765.aspx)：

```
SELECT [percent] = CASE WHEN total = 0 THEN NULL ELSE (num/total) END 
FROM Table 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T21:04:34.787

要回答您问题的第二部分：

> 除以 Null 是什么意思？

使用`NULL`值的算术计算的结果是`NULL`，或者[换句话说](http://en.wikipedia.org/wiki/Null_%28SQL%29#Arithmetic_operations)：

> 因为 Null 不是数据值，而是未知值的标记，所以对 Null 使用数学运算符会导致未知值，用 Null 表示。

所以声明

```
select (num/nullif(total, 0)) as percent 
```

`NULL`如果.将返回`total = 0`。正如 Tim 所提出的，使用`CASE`是一种同样有效的处理问题的方法。

# c++ - 使用 c# 进行 c++ 单元测试

> ID：10645481
> 
> 赞同：1
> 
> 时间：2012-05-18T01:06:15.520
> 
> 标签：c++, testing

我有 MFC dll，我想使用 C# 对其进行测试。我想用 c++ 代码测试 c++ 更自然，但我宁愿尽可能在 C# 上工作。Visual Studio 中是否有内置解决方案，我可以在不安装 3rd 方框架的情况下使用？

任何指针将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-30T19:22:10.490

可能应该咬紧牙关并使用 CPP 测试框架：[https ://msdn.microsoft.com/en-us/library/hh419385.aspx](https://msdn.microsoft.com/en-us/library/hh419385.aspx)

现在假设您有理由避免使用 C++ 是好的，而不仅仅是担心会给您带来更多的痛苦而不是收获，我建议您使用 CLI 层。当然，你必须写那个..但它可能非常基本。当您运行测试时，您正在测试层和包装的方法，但这对于任何互操作层都是如此（因此为什么 CPP 测试框架应该是您的默认选择）。

我会避免 COM 互操作。PInvoke 可能也很混乱，但对于琐碎的情况可能是最简单的。

# list - 在序言中覆盖列表中的元素

> ID：10645482
> 
> 赞同：0
> 
> 时间：2012-05-18T01:06:28.177
> 
> 标签：list, prolog, overriding, element

我有以下问题：

我有一个包含 9 个位置的列表，我有这个功能 `putPiece(Piece, Board, Line, Column)` ，可以将一块放在位置线，板的列（9 个位置的列表）我试图检查是否有任何位置已经被填充，所以我不尝试在其中放入任何东西，因为这是不可能的（对吗？）你能帮我做一个`checkIfFree(Board, Line, Column)`检查板的位置（行，列）是否已经被占用的功能......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T07:20:18.850

假设一个自由位置由一个自由变量表示`var(X)`应该可以解决这个问题。

# c++ - glDrawArrays上的OpenGL Segfaulting

> ID：10645484
> 
> 赞同：4
> 
> 时间：2012-05-18T01:06:39.413
> 
> 标签：c++, opengl, segmentation-fault

我正在使用 Code::Blocks (C++) 和 MinGW 在 Windows 上的 OpenGL 中制作游戏。所有的绘图和逻辑都很好，游戏完美运行。直到，突然，它没有。一段时间后，游戏Segfaults **。**与 GL 段错误一样，堆栈跟踪是无用的。我得到的唯一一件事是段错误发生在供应商的 OpenGL 实现中。我已经在来自不同供应商的多个显卡上对此进行了测试，他们都这样做了，所以问题出在我这边。

我通过 gDEBugger 运行了程序，得到了同样无用的堆栈跟踪。哈哈。我也使用了 GLIntercept，但没有任何反应。因此，我着手以手动方式查找段错误（BuGLe 拒绝编译...），并且基本上将跟踪消息写入日志。我已将其范围缩小为对 glDrawArrays 的一次调用。我在互联网上做了很多探索，并尝试了很多我发现的修复程序。

因为这个游戏没有为可移植性而编码，所以我一直犹豫要在 wine 和 valgrind 中运行它。在我弄乱那个美妙的混乱之前，如果您能查看我的代码并找到错误，我将不胜感激。（我敢肯定这是显而易见的......）

（注意：为了便于阅读，我删除了所有的跟踪线）

```
void PlayerShip::Render()
{
    glPushMatrix(); //Save the current state

    glTranslatef(m_PosX, m_PosY, 0);
    glRotatef(vect.Rotation - 90, 0, 0, 1); //Matrixes are applied in reverse order

    double xl = m_SizeX / 2, yl = m_SizeY / 2; //Get values to add/subract to the midpoint for the corners
    glEnable(GL_TEXTURE_2D); //Redundant
    TextureManager::Inst()->BindTexture(TexIDs::Playership01); //Bind the texture

    glEnableClientState(GL_VERTEX_ARRAY); //These enables and disables are redundant here
    glEnableClientState(GL_TEXTURE_COORD_ARRAY); 
    glDisableClientState(GL_NORMAL_ARRAY);
    glDisableClientState(GL_COLOR_ARRAY);

    GLdouble* Verts;
    Verts = new GLdouble[12] { -xl, -yl, -.5,    xl, -yl, -.5,
                           xl,  yl, -.5,    -xl, yl, -.5}; //Calculate quad vertices
    GLdouble* Texs;
    Texs = new GLdouble[8] {0, 0,    1, 0,   1, 1,    0, 1}; //Calculate texture vertices

    glVertexPointer(3, GL_DOUBLE, 0, Verts);
    glTexCoordPointer(2, GL_DOUBLE, 0, Texs);

    glDrawArrays(GL_QUADS, 0, 12);

    delete [] Verts;
    delete [] Texs;

    glPopMatrix();
} 
```

有趣的是，这段代码可以工作......一段时间。我已经打印了所有变量的值，它们都是正确的，指针不为空，在整个代码中间隔的 glGetError 调用总是返回 NO_ERROR。坦率地说，我很茫然。

给任何建议我做一些不同事情的人的说明：我需要使用顶点数组来支持旧版 (1.4) GL 实现，并且我将我的数组声明为指针，以便我可以（将来）重用它们来绘制多个图元有一次（比如说，从船上排出废气）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T02:03:35.837

您对 glDrawArrays 的最后一个参数应该是 4（元素数），而不是 12（浮点数）。

您正在尝试绘制 12 个元素（= 36 个浮点数），并访问超出数组的边界。

# jquery - 当用户在上传文件对话框中选择文件时，facebook如何上传照片？

> ID：10645486
> 
> 赞同：0
> 
> 时间：2012-05-18T01:07:15.977
> 
> 标签：jquery, facebook, file-upload

当您在 facebook 上更新个人资料图片时，选择“上传图片”后，上传文件对话框打开。 **在对话框中选择文件后，您的个人资料图片就会更新。**

使用 jquery 我已经能够触发隐藏文件输入上的点击事件以打开上传文件对话框。我还能够在文件输入上传文件对话框（一旦用户选择文件时触发）上连接更改事件。如果我在更改事件中触发表单提交操作，IE 会拒绝访问并且文件永远不会上传。

我尝试了一个 Iframe 解决方案，其中文件输入位于另一个页面上，并从父页面调用了单击、更改和提交事件 - 文件仍未上传。

facebook 的上传个人资料图片功能如何解决这个问题？关于我应该从哪里开始的任何见解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:46:57.820

这是我见过的最好的之一。我在我当前的项目中使用它： [https ://github.com/blueimp/jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload)

# java - 我可以假设具有相同 System.identityHashCode 的两个对象是相同的吗？

> ID：10645494
> 
> 赞同：5
> 
> 时间：2012-05-18T01:07:54.653
> 
> 标签：java, hash-code-uniqueness

尽管两个不同的对象可能具有相同的哈希码，但是，`System.identityHashCode()`似乎返回了对象的内存指针。我想 32 位 JVM 实现也不例外，包括 Sun JDK、Open JDK。不过，我没有检查源代码。在实践中，我可以假设两个相同的对象`System.identityHashCode()`是相同的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T01:22:48.117

答案是不。

[System.identityHashCode()](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#identityHashCode%28java.lang.Object%29)只返回[Object.hashCode()](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#hashCode%28%29)。

> 为给定对象返回与默认方法 hashCode() 返回的相同的哈希码，无论给定对象的类是否覆盖 hashCode()。空引用的哈希码为零。

而对于`Object.hashCode()`

> 在合理可行的情况下，由 Object 类定义的 hashCode 方法确实为不同的对象返回不同的整数。（这通常通过将对象的内部地址转换为整数来实现，但 JavaTM 编程语言不需要这种实现技术。）

**但是**，Sun JDK 中存在一个[错误](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6321873)，表明两个对象可以返回相同的哈希码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T01:20:57.450

最简洁的答案是不。

根据[文档](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#identityHashCode%28java.lang.Object%29)，`System.identityHashCode(Object)`...

> 为给定对象返回与默认方法 hashCode() 返回的相同的哈希码，无论给定对象的类是否覆盖 hashCode()。

那么让我们检查...的 [文档](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#hashCode%28%29)`Object.hashCode()`

> 在合理可行的情况下，由 Object 类定义的 hashCode 方法确实为不同的对象返回不同的整数。（这通常通过将对象的内部地址转换为整数来实现，但**Java 编程语言不需要这种实现技术**。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T01:31:14.297

你的问题只有两点：

1.  返回什么`System.identityHashCode(Object)`。

    > 为给定对象返回与默认方法 hashCode() 返回的相同的哈希码，无论给定对象的类是否覆盖 hashCode()。空引用的哈希码为零。

2.  比较两个对象的相等性时，哈希码规则是什么。

    > 合同说，如果两个对象使用 equals(object) 方法相等，那么它们应该具有相同的哈希码，但如果两个对象具有相同的哈希码，它们不一定相等。

# coldfusion - 通过动态表单变量更新记录

> ID：10645496
> 
> 赞同：0
> 
> 时间：2012-05-18T01:07:59.633
> 
> 标签：coldfusion

我有一个表单，允许用户从整个集合中选择 4 条记录以特定顺序（1 到 4）出现。这些字段动态命名为 blah1、blah2 等。但是，更新查询不起作用，当我输出结果时，它们都默认为 1。

```
<cfquery name="allRecipes" datasource="#request.db#">
    SELECT id, name, homepage_order
    FROM tblrecipes
    ORDER BY name
</cfquery>

<cfquery name="getOnlySelected" dbtype="query">
    SELECT *
    FROM allRecipes
    WHERE homepage_order > 0
    ORDER BY homepage_order
</cfquery>

<cfloop from="1" to="4" index="i">
            <li>
                Position <cfoutput>#i#</cfoutput>: Current recipe published: <strong><cfoutput>#getOnlySelected['name']["#i#"]#</cfoutput></strong><br />
                Choose New:
                <cfselect name="position#i#" query="allRecipes" value="id" display="name" queryPosition="below" selected="#getOnlySelected['id']['#i#']#">
                    <option value="">-Select-</option>  
                </cfselect>
            </li>

        </cfloop> 
```

和表单提交查询：

```
<cfquery datasource="#request.db#">
        UPDATE tblrecipes
        SET homepage_order = 0
        WHERE 1=1
    </cfquery> //This query resets all the order values

    <cfif IsNumeric(form.position1)>
        <cfquery name="updateOrder1" datasource="#request.db#">
            UPDATE tblrecipes
            SET homepage_order = 1
            WHERE id = #form.position1#
        </cfquery>
    </cfif>

    <cfif IsNumeric(form.position2)>
        <cfquery name="updateOrder2" datasource="#request.db#">
            UPDATE tblrecipes
            SET homepage_order = 2
            WHERE id = #form.position2#
        </cfquery>
    </cfif>

    <cfif IsNumeric(form.position3)>
        <cfquery name="updateOrder3" datasource="#request.db#">
            UPDATE tblrecipes
            SET homepage_order = 3
            WHERE id = #form.position3#
        </cfquery>
    </cfif>

    <cfif IsNumeric(form.position4)>
        <cfquery name="updateOrder4" datasource="#request.db#">
            UPDATE tblrecipes
            SET homepage_order = 4
            WHERE id = #form.position4#
        </cfquery>
    </cfif> 
```

这是表单数据的示例转储。每个位置的值都是正确的。

```
FIELDNAMES  POSITION1,POSITION2,POSITION3,POSITION4,SUBMIT
POSITION1   81
POSITION2   82
POSITION3   80
POSITION4   78
SUBMIT  Update Order 
```

查询结果看起来一样，在表单提交之前和之后

```
HOMEPAGE_ORDER  ID  NAME
1   81  Okonomiyaki
1   82  Apple Chutney Cubes
1   80  Asparagus for the Family
1   78  Coconut Curry Sauce Cubes
CACHED  false
EXECUTIONTIME   0
SQL     SELECT * FROM allRecipes WHERE homepage_order > 0 ORDER BY homepage_order 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T06:03:41.737

你有没有尝试过：

1.  在正在提交的页面上。只是为了确认是发送的表单值还是代码服务器端的问题

2.  同样，添加一些内容以输出更新代码中的更新是否正在运行。您说它们都默认为 1，这让我认为代码正在运行。

3.  下载并安装[Fiddler](http://www.fiddler2.com/fiddler2/)并使用它来查看浏览器发送的值。

4.  阅读包含表单的页面的源代码。表单的正确位置实际上是否有标签，以便提交您期望的数据？

从您的代码的外观来看，更新查询可能将所有四个值设置为 1 的唯一方法是客户端发送的内容，所以我怀疑生成的页面中存在某些内容，尽管我刚刚重新创建了您的示例的骨骼在本地，并且看不到任何问题。

# equals - Java TreeSet 不存储唯一值

> ID：10645508
> 
> 赞同：1
> 
> 时间：2012-05-18T01:09:20.010
> 
> 标签：equals, hashcode, treeset

我有一个名为 Artifacts 的对象 TreeSet。我已经覆盖了对象中的等号和哈希码方法，如下所示：

```
 @Override
public int hashCode() {
    return new HashCodeBuilder(17, 31). // two randomly chosen prime numbers
        // if deriving: appendSuper(super.hashCode()).
        append(artifactId).
        toHashCode();
}

@Override
public boolean equals(Object arg0) {

    Artifact obj=(Artifact)arg0;

    if(this.getArtifactId().equalsIgnoreCase(obj.getArtifactId()))
    {

            return true;
    }

   return false;
} 
```

我已经将打印放在 equals 方法中，但它从未被调用过。我已经用一个如下所示的比较器实例化了 TreeSet：

```
 TreeSet<Artifact> syncedList = new TreeSet<Artifact>(new ArtifactComparator()); 
```

我已经读过 TreeSet 基于 equals 覆盖建立它的唯一性。

我在 TreeSet 中看到多个具有相同 ArtifactId 的对象，这不像我需要的那样唯一。

我的等号和哈希码方法中是否缺少某些内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:23:23.270

正如欧内斯特所说，你需要一种`compareTo()`方法。如果您考虑树结构，它不仅需要知道两个对象是否被认为彼此相等，还需要知道一个对象是“小于”还是“大于”，才能知道对象在树中的相对位置那些已经在那里的。即一棵树构建一个*有序*列表。

因此，您可以根据需要取消`ArtifactComparator`该类，只需让您的 Artifact 类实现`Comparable<Object>`，添加如下`compareTo`方法：

```
 @Override
 public int compareTo(Object arg0) {
     Artifact obj=(Artifact)arg0;
     return this.getArtifactId().compareToIgnoreCase(obj.getArtifactId());
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:15:09.200

`TreeMap`（和 this `TreeSet`）根本不使用您的`equals()`方法，除非您获取`entrySet()`or `keySet()`。如果有问题，它将在`ArtifactComparator.`That class's `compareTo()`must return`0`以指示两个`Artifact`s 相等。

# sql-server - 允许匿名用户创建 SQL Server 登录名和帐户的安全问题？

> ID：10645511
> 
> 赞同：0
> 
> 时间：2012-05-18T01:09:46.150
> 
> 标签：sql-server, azure-sql-database

我在用户 PC 上安装了一个富客户端程序，我想开始在 SQL Azure/SQL Server 上存储一些用户创建的数据。潜在的匿名用户将输入他们的姓名、电子邮件帐户和密码，这些密码将存储在 SQL Azure/SQL Server 上。然后他们将开始生成自己的数据。我预计可能有 1000 个用户。

有时这些用户希望对自己的数据运行自己的查询，但显然，我必须确保他们永远无法查看其他用户的数据。

我认为确保数据安全的最佳方法是为每个用户颁发自己的 SQL Azure 帐户和密码。我将设置一个只有我知道的 SQL Azure 用户和长密码，它只有权执行几个存储过程，并将适当的参数传递给那些将创建 SQL Server 帐户、登录并将用户添加到角色的 SP我创造了。

显然，运行调试工具的人可以找出用户名和密码，但我认为这没什么大不了的。如果该特定 SQL Azure 帐户所能做的就是执行一些 SP，那么如果恶意个人开始这样做怎么办。在我要求付款之前，我只允许上传非常有限的数据。

用户只能使用使用以下内容的存储过程插入记录：

```
SELECT @uName=SYSTEM_USER 
```

并且只选择适当的父记录。用户可以执行的所有存储过程都将具有上述要求，以确保他们只能使用自己的记录。

所有视图都将嵌入其中的 WHERE 子句，例如

```
WHERE tbLoginName = SYSTEM_USER. 
```

我是 SQL Server 的新手，所以我可能会遗漏一些基本概念，因此我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T06:37:59.680

我想指出您提到的方法中的一个潜在问题：您的主 SQL Azure 帐户需要有权创建新帐户并授予他们对特定表的访问权限。这意味着您的主账户本身也需要访问所有这些表。如果您将主帐户存储在客户端，聪明的用户将可以访问所有用户数据。

根据我的经验，直接从客户端应用程序连接到数据库几乎总是会降低您的解决方案的安全性。您可以出于测试目的这样做，但在现实世界的解决方案中，我建议您使用服务。您可以在 Windows Azure 中托管该服务。然后服务将访问数据库，客户端应用程序只能访问服务。通过这种方式，您可以使用您喜欢的任何机制（例如 ASP.NET 成员资格）对客户端进行身份验证。

此致，

明旭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T12:42:44.797

您实际上是在创建一个物理的两层数据库连接，允许客户端应用程序直接连接到数据库。这在许多方面都是一个问题，包括安全性和性能。从安全的角度来看，不控制客户连接的位置，您需要保持防火墙规则对世界上任何人都开放，以尝试破解每个客户的 uid/pwd。而不是只有 1 个用户 id 可以玩，黑客将拥有多达 1,000 个......

第二个问题是性能。您的应用程序将无法利用连接池，从而对数据库服务器造成过度压力，并可能在某些时候遇到限制问题。使用 Web 服务、具有 ASP.NET 成员资格来管理登录，并使用服务帐户（即相同的 uid/pwd）来获取数据，如果您保持所有请求的连接字符串相同，您将确保正确利用连接池.

借助 Web 服务层，您还可以轻松获得两层架构无法提供的大量新选项。这包括集中您的业务和数据访问逻辑、添加缓存以提高性能、在集中位置添加审计、允许对应用程序的某些部分进行更新而无需在客户位置重新部署任何内容等等……

在云中，您最好利用 Web 服务。

我的 2 美分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T08:00:38.847

[正如http://msdn.microsoft.com/en-us/library/ms189751.aspx](http://msdn.microsoft.com/en-us/library/ms189751.aspx)指出的那样，问题是：

在 SQL Azure 中，只有服务器级主体登录（由供应过程创建）或 master 数据库中 loginmanager 数据库角色的成员才能创建新登录。

这些帐户还能够更改和删除登录名。因此，如果您将这些帐户嵌入到客户端应用程序中，您实际上是在授予每个用户更改/删除其他用户帐户的权限。虽然普通用户不会这样做，但黑客会这样做。因此，您不能让客户端应用程序管理 SQL Azure 登录，除非只允许受信任的用户（例如您的 IT 管理员）使用该应用程序。

此致，

明旭。

# security - 使用非阻塞框架对 DoS/DDoS 的影响

> ID：10645512
> 
> 赞同：4
> 
> 时间：2012-05-18T01:09:55.713
> 
> 标签：security, nonblocking, ddos

在处理对运行 node.js 等非阻塞框架的应用程序的 DDoS 攻击时，是否有任何固有的优点或缺点？

据我了解，这些攻击通过大量请求使系统资源过载 - 导致它失败。非阻塞框架能够处理比阻塞请求更多的并发请求。这不应该意味着使用非阻塞框架本质上有助于减轻这些类型的攻击吗？

我意识到减轻这些攻击还涉及其他因素，但在所有其他条件相同的情况下，这是一个正确的假设吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-24T16:49:36.850

与阻塞服务相比，非阻塞服务通常会为用户提供更多的系统资源。在攻击耗尽所有系统资源之前，非阻塞服务将表现得更好，因为合法用户仍然可以在攻击发生时满足请求。也就是说，在系统开始处理合法请求之前，真实用户不必等待攻击者的虚假请求完成。但考虑到对系统资源的更多暴露，DDoS 攻击可能对非阻塞服务更有效。

例如，限制因素是数据库访问。与阻塞服务相比，非阻塞服务发出更多数据库请求的能力更强。因此，虽然非阻塞服务可能仍然接受合法用户请求，但他们将更难完成数据库访问，因为攻击者的请求能够更好地保持数据库处于负载状态。

所以我会说是的——非阻塞更好——但前提是你可以确保下游资源的大小合适。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-19T13:21:41.527

DDoS 攻击可以针对不同的服务，例如 ddns、web 服务器、数据库 ar 可以产生不同的效果，例如使服务器自身或 cpu 过载，或填满 ram，或尝试将许多文件写入磁盘以填满它（今天更罕见）或只是写更多可以写的数据。

DDoS 的一种非常常见的用途可以解释您的问题，其目标是创建比服务器可以处理的更多的并发连接。Web 服务器的典型默认值是 256（或在许多系统中为 512）并发尝试创建连接。在 linux 系统中，您可以在此处手动更改值，例如 /proc/sys/net/ipv4/tcp_max_syn_backlog。因此，通过建立更多的连接（发送带有同步标志的数据包），它会导致拒绝服务。所以你使用的框架一开始没有任何意义。

此外，非阻塞框架每秒发出比阻塞更多的请求，这在许多情况下有助于攻击者。在某些服务器和/或配置中，这将为每个请求创建一个实例，这将帮助更多的攻击者。

所以你的假设是错误的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T17:16:47.847

不幸的是，nodejs 对 DDoS 没有帮助，因为它可以像任何其他服务器一样简单地过载，而且事实是非阻塞并没有改变任何东西，实际上可以更快地杀死服务器，因为它会尝试处理更多请求而不排队它们。

# java - Java Applet Web 部署问题

> ID：10645518
> 
> 赞同：2
> 
> 时间：2012-05-18T01:10:51.077
> 
> 标签：java, swing, netbeans, japplet, cardlayout

我无法将使用 netbeans 的 JApplet 部署到工作的 Web 服务器中。发生的情况是它似乎加载了小程序，但加载后我只剩下一个空白屏幕，没有按钮。我认为这可能是因为我正在使用卡片布局设计，或者因为所需的库未包含在 .jar 中。我正在使用 Atmos 包装函数和一些外部 .jar 文件。

任何帮助都是极好的！如果您需要更多信息，请询问！

```
public void init() {

    // initialise any variable we have created
    cloud = new CloudClass();
    user = new User();
    sourceFiles = null;
    dest = null;

    /*
     * Set the Nimbus look and feel
     */
    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
    /*
     * If Nimbus (introduced in Java SE 6) is not available, stay with the
     * default look and feel. For details see
     * http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
     */
    try {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(ArFileJApplet.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(ArFileJApplet.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(ArFileJApplet.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(ArFileJApplet.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }
    //</editor-fold>

    /*
     * Create and display the applet
     */
    try {
        java.awt.EventQueue.invokeAndWait(new Runnable() {

            public void run() {
                // initialise any previously uninitialised variables
                initComponents();
                invalidLogin_label.setVisible(false);
            }
        });
    } catch (Exception ex) {
        ex.printStackTrace();
    }
} 
```

编辑：我稍微调整了一下，现在小程序页面只是在网页上出现了一个错误，上面写着“错误，点击查看详细信息”

点击它会说 com/emc/esu/api/EsuException 并点击 Details 按钮会给我一些调试选项，这可能对所有知识渊博的类型都有帮助。

c：清除控制台窗口 f：在终结队列中终结对象 g：垃圾收集 h：显示此帮助消息 l：转储类加载器列表 m：打印内存使用情况 o：触发日志记录 q：隐藏控制台 r：重新加载策略配置 s：转储系统和部署属性 t：转储线程列表 v：转储线程堆栈 x：清除类加载器缓存 0-5：将跟踪级别设置为

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T01:34:44.837

两个可能的问题似乎最有可能：

*   在类路径上找不到所需的 jar，因此它会因某种错误而爆炸。在这种情况下，您需要了解如何查看 ClassNotFoundException 并从那里解决它。
*   加载后，您的 UI 没有刷新/布局正确。请参阅：[Applet 工作，但摆动组件不会出现！](https://stackoverflow.com/questions/982324/applet-works-but-swing-components-wont-appear)

# android - 使用当前位置，ICS 系统崩溃

> ID：10645519
> 
> 赞同：0
> 
> 时间：2012-05-18T01:11:05.560
> 
> 标签：android, maps, location, android-mapview, android-4.0-ice-cream-sandwich

我正在尝试学习定位服务的基础知识并使用“大头针”来标记位置。

我不确定这是否是最好的方法，或者有什么替代方法。有什么更好的，或者只是更简单的方法呢？或者标准方法是什么？

此外，当我在 ICS 4.0.3 上运行此应用程序时，手机会在几分钟后冻结。起初它工作正常，并向我显示位置，但最终整个设备变得无响应。我已经检查了 logcat 和 last_kmsg，但我找不到任何关于导致此问题的提示。Gingerbread 2.3.6 运行代码没有问题（至少它没有崩溃超过 15 分钟，而 ICS 在 1~5 分钟内崩溃）。

这似乎不是一个例外，所以也许这是一些内存泄漏或内核恐慌？我不知道如何开始调试这个：\

任何帮助，将不胜感激！

我正在使用以下代码：

**映射器.java：**

```
public class Mapper extends MapActivity{

MapView mapView;
LocationManager lm;
LocationListener ll;
GeoPoint p;
MapController mc;
MapOverlay overlay;
List<Overlay> lol;

public void onCreate(Bundle x){
    super.onCreate(x);
    setContentView(R.layout.mapper);

    mapView = (MapView)findViewById(R.id.mapView);
    mapView.setBuiltInZoomControls(true);
    mc = mapView.getController();
    lol = mapView.getOverlays();
    overlay = new MapOverlay();
    lm = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
    ll = new MyLocationListener();

    mapView.invalidate();
}

private class MyLocationListener implements LocationListener{
    public void onLocationChanged(Location loc){
        if(loc!=null){
            int lat = (int)(loc.getLatitude() * 1E6);
            int lon = (int)(loc.getLongitude() * 1E6);
            p = new GeoPoint(lat,lon);

            mc.animateTo(p);
            mc.setZoom(18);

            lol.clear();
            lol.add(overlay);
        }
    }

    @Override
    public void onProviderDisabled(String provider) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onProviderEnabled(String provider) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
        // TODO Auto-generated method stub

    }
}

public void onResume(){
    super.onResume();

    lm.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, ll);
}

public void onPause(){
    super.onPause();

    lm.removeUpdates(ll);
}

protected boolean isRouteDisplayed(){
    return false;
}

private class MapOverlay extends com.google.android.maps.Overlay{
    public boolean draw(Canvas canvas, MapView mv, boolean shadow, long when){
        super.draw(canvas, mv, shadow);

        Point sp = new Point();
        mv.getProjection().toPixels(p, sp);
        Bitmap pic = BitmapFactory.decodeResource(getResources(), R.drawable.image1);
        canvas.drawBitmap(pic, sp.x, sp.y, null);
        canvas.drawBitmap(pic, sp.x+60, sp.y, null);
        canvas.drawBitmap(pic, sp.x-60, sp.y, null);
        canvas.drawBitmap(pic, sp.x, sp.y+60, null);
        canvas.drawBitmap(pic, sp.x, sp.y-60, null);
        return true;
    }
}
} 
```

**映射器.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   android:layout_width="fill_parent"
   android:layout_height="fill_parent"
   android:orientation="vertical" >

   <com.google.android.maps.MapView
      android:id="@+id/mapView"
      android:layout_width="fill_parent"
      android:layout_height="fill_parent"
      android:apiKey="mykeyworks"
      android:clickable="true" />

</LinearLayout> 
```

**AndroidManifest.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.jinworld"
android:versionCode="1"
android:versionName="1.0" android:installLocation="auto">

<uses-sdk android:minSdkVersion="10" />
<uses-permission android:name="android.permission.VIBRATE"/>
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>"

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <uses-library android:name="com.google.android.maps" />
    <activity
        android:name=".MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".SecondActivity"
        android:label="Second Activity" >
        <intent-filter>
            <action android:name="com.jinworld.SecondActivity" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name=".Notify"
        android:label="DEVELOPERS" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name=".Mapper"
        android:label="Locatio" >
        <intent-filter>
            <action android:name="com.jinworld.Mapper" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T09:47:41.600

您不需要太多代码来显示您的位置，谷歌已经为此提供了一个覆盖。试试这个，它可能会有所帮助：

```
public class Mapper extends MapActivity{
    com.google.android.maps.MyLocationOverlay myLocationOverlay;

    @Override
    protected void onResume() {
        super.onResume();
        myLocationOverlay.enableMyLocation();
    }

    @Override
    protected void onPause() {
        super.onPause();
        myLocationOverlay.disableMyLocation();
    }

    @Override
    public void onCreate(Bundle x){
        ...
        setupMyLocation();
        ...
    }

    protected void setupMyLocation(){
        myLocationOverlay = new MyLocationOverlay(this, mapView);
        myLocationOverlay.enableMyLocation();
        myLocationOverlay.runOnFirstFix(new Runnable() {
            public void run() {
                mapView.getOverlays().add(myLocationOverlay);
            }
        });
    }
} 
```

# mysql - 列出连接查询 MYSQL 中的选项

> ID：10645522
> 
> 赞同：0
> 
> 时间：2012-05-18T01:11:29.950
> 
> 标签：mysql

有关代码和输出，请参见下图。

vcoptionids 列有两个 voptionid。

我如何让它列出另一个选项值，即颜色？

[https://www.dropbox.com/s/wdfbpkk0q8lwbqw/Fullscreen%20capture%2018052012%20110530%20AM.bmp.jpg](https://www.dropbox.com/s/wdfbpkk0q8lwbqw/Fullscreen%20capture%2018052012%20110530%20AM.bmp.jpg)

# ios - 在哪里放置 ios 的 sqlite3_open 代码

> ID：10645523
> 
> 赞同：0
> 
> 时间：2012-05-18T01:11:46.003
> 
> 标签：ios, sqlite

在向用户显示的第一个视图中，我必须在一些文本字段中填充一些保存在手机上的信息。

苹果是否有关于应用程序启动序列的整个状态的图表？即，包括应用程序委托方法调用和视图委托方法调用？似乎不同iOS版本的事件顺序切换......

例如： [http](http://oleb.net/blog/2011/06/app-launch-sequence-ios/) ://oleb.net/blog/2011/06/app-launch-sequence-ios/ 假设您在 MainWindow.xib 中有一个自定义视图控制器，不会在 didFinishLaunchingWithOptions 之前调用 viewWillAppear 吗？

为了安全起见，我是否应该在我的所有 sqlite3 数据库函数周围快速调用，以在继续之前检查数据库是否打开，并在必要时打开它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:23:48.557

我在一个 iPhone 应用程序中使用了一个 SQL 数据库，如果它在一个名为 from 的 void 中关闭，则该数据库将打开`viewDidLoad`。这对应用程序的性能一点也不有害。虽然在一个较新的应用程序中，我需要在应用程序打开时获取一些首选项（这次不是在 SQL 数据库中），所以我创建了我的 ViewController 的一个实例，并从 App Delegate 的 -(void)applicationDidBecomeActive:(UIApplication *）应用; 方法（每次我的应用程序激活时重新运行该方法），如下所示：

```
- (void)applicationDidBecomeActive:(UIApplication *)application{
// Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.
ViewController *instanceOfVC = [[[ViewController alloc] init]autorelease];
[instanceOfVC checkPreferences];
} 
```

# c# - 在 EWL 中创建只读表单

> ID：10645524
> 
> 赞同：1
> 
> 时间：2012-05-18T01:11:46.377
> 
> 标签：c#, asp.net, enterprise-web-library

我正在使用 Enterprise Web Library 创建一些复杂的 Web 表单，我发现使用自动生成的表单项和`FormItemBlock`. 这对于有权处理这些数据的用户来说非常有用，但我目前的问题是针对没有权限的用户。我想与我的应用程序中有权查看数据的用户共享页面和显示的数据，而不是更改它。有没有办法轻松地将一些数据切换为只读？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T18:42:05.957

Development Utility 目前不生成任何生成只读控件的表单项 getter，但您可以使用通用 getter。例如，这行代码将创建一个带有文字控件的表单项：

```
GetMyFieldFormItem( true, ( value, label ) => value.GetLiteralControl(), value: currentValueFromDatabase ); 
```

我计划最终实施：

1.  单个只读表单项
2.  只读页面，所有表单项都自动为只读
3.  只读网站，所有页面上的所有表单项都自动为只读

# ios - 使用一个 UIToolBarItem 按钮关闭和打开 UIPopOver？

> ID：10645529
> 
> 赞同：0
> 
> 时间：2012-05-18T01:12:56.063
> 
> 标签：ios, xcode, ipad, uipopover

我想知道如何使用工具栏上的 1 个按钮来打开和关闭我的 UIPopOver。如果我现在继续点击按钮，另一个 PopOver 会与前一个重叠。我希望 ONE 按钮能够关闭并打开我的 PopOver。我点击一次，它会打开。我再次点击按钮，它消失了。请告诉我怎么做。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:59:19.293

在您的按钮点击动作事件中：

```
if (myPopover.popoverVisible)  //self.myPopover if using property
{
    [myPopover dismissPopoverAnimated:YES];
    return;
}

//continue code here to create/present your MyPopover… 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:06:58.330

快速的方法是在您的呈现视图控制器中定义一个 UIPopOverController 属性，并使用此属性来实例化您的弹出框（以及随附的内容视图控制器）。

在您的呈现视图控制器中，您将需要以下内容：

```
UIViewController *aViewController = [[UIViewController alloc]init];
self.popOverController = [[UIPopoverController alloc] initWithContentViewController:aViewController]; 
```

然后在您的按钮操作中切换 popOver 它应该执行以下操作：

```
 if(self.popOverController.popoverVisible) {
    [self.popOverController dismissPopoverAnimated:YES];
    } else { //Display the popover } 
```

希望有所帮助

# mysql - Rails：在模型中指定不同的数据库

> ID：10645532
> 
> 赞同：2
> 
> 时间：2012-05-18T01:13:39.593
> 
> 标签：mysql, ruby-on-rails-3, activerecord

我正在尝试设置 Rails (v3.2.2) 以使用多个数据库。我是基于这个[Connecting Rails 3.1 with Multiple Databases](https://stackoverflow.com/questions/6122508/connecting-rails-3-1-with-multiple-databases)做的。

我的模型：

```
class Category < ActiveRecord::Base                                                                                                                                                                                                                                                                                                
  establish_connection :category_database                                                                                                                                                                                                                                                                                                                       
  self.primary_key = "cat_id"                                                                                                                                                   

  validates_presence_of :name, :display_name, :description, :icon, :image, :parent_category_id, :create_time                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end 
```

数据库.yml：

```
category_database:                                                                                                                                                              
  adapter: mysql2                                                                                                                                                               
  encoding: utf8                                                                                                                                                                
  reconnect: false                                                                                                                                                              
  database: main_cat                                                                                                                                                         
  pool: 5                                                                                                                                                                       
  username: root                                                                                                                                                                
  password: blah                                                                                                                                                                    
  socket: /var/run/mysqld/mysqld.sock 
```

当我运行这个规范文件时：

```
require 'spec_helper'                                                                                                                                                           

describe Category do                                                                                                                                                            
  puts "ENV: #{Rails.env}"                                                                                                                                                      
  it { should validate_presence_of :name }                                                                                                                                      
  it { should validate_presence_of :display_name }                                                                                                                              
  it { should validate_presence_of :description }                                                                                                                               
  it { should validate_presence_of :icon }                                                                                                                                      
  it { should validate_presence_of :image }                                                                                                                                     
  it { should validate_presence_of :parent_category_id }                                                                                                                        
  it { should validate_presence_of :create_time }                                                                                                                               

end 
```

像这样：

```
>rspec /path/to/category_spec.rb 
```

我得到：

```
/home/user/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/activerecord-3.2.2/lib/active_record/connection_adapters/abstract/connection_specification.rb:45:in `resolve_hash_connection': database configuration does not specify adapter (ActiveRecord::AdapterNotSpecified) 
```

我也试过像这样设置建立连接：

```
 establish_connection(                                                                                                                                                         
    :adapter => "mysql2",                                                                                                                                                       
    :encoding => "utf8",                                                                                                                                                        
    :reconnect => false,                                                                                                                                                      
    :database => "main_cat",                                                                                                                                                 
    :pool => 5,                                                                                                                                                                 
    :username => "root",                                                                                                                                                        
    :password => "blah",                                                                                                                                                            
    :socket => "/var/run/mysqld/mysqld.sock") 
```

这导致相同的异常。（适配器未指定）

奇怪的是，如果我完全放弃建立连接并通过 database.yml 文件应用完全相同的连接配置，如下所示：

```
test:                                                                                                                                                                           
  adapter: mysql2                                                                                                                                                               
  encoding: utf8                                                                                                                                                                
  reconnect: false                                                                                                                                                              
  database: main_cat                                                                                                                                                         
  pool: 5                                                                                                                                                                       
  username: root                                                                                                                                                                
  password: blah                                                                                                                                                                    
  socket: /var/run/mysqld/mysqld.sock 
```

有用。

似乎 Rails 完全忽略了建立连接......我是否缺少一些应用程序级配置设置或其他东西？如何让 Rails 识别建立连接，以便我可以将不同的模型放在不同的数据库中？

非常感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T22:13:36.927

所以事实证明，Rails 需要默认配置。在这种情况下，database.yml 文件仍然需要一个测试数据库。否则，Rails 将抛出异常，因为它希望在模型初始化之前建立一些连接。一旦加载了默认配置，Rails 稍后会继续初始化模型，然后可以通过建立连接进行模型级数据库配置。

我希望这对其他人有帮助。我花了相当多的时间来运行调试器

activerecord-3.2.2/lib/active_record/connection_adapters/abstract/connection_specification.rb

弄清楚这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-11T04:49:41.270

由于几乎相同的原因，我遇到了同样的错误，但是我确实有一个测试：我的 database.yml 中的配置；但问题在于我在模型定义中提供了“建立连接”方法：

```
 establish_connection 'cm_inv_mgmt_' + Rails.env.downcase 
```

尽管我为生产/登台和开发环境提供了 database.yml 的部分，但我缺少 cm_inv_mgmt_test！

# php - php在javascript函数中生成数组

> ID：10645534
> 
> 赞同：0
> 
> 时间：2012-05-18T01:13:47.960
> 
> 标签：php, javascript, json

我正在尝试在 Google 的 Geochart 上绘制一些城市。这个函数工作得很好，可以绘制城市。

```
function drawMarkersMap() {
  var newInfo = google.visualization.arrayToDataTable([
   ['City'],
   ['San Diego'],
   ['Los Angeles'],
   ['San Jose']
  ]); 
```

虽然这很好，但我正在通过 php 从我的数据库中生成我的城市。所以，假设我们有这个 php 数组

```
<?php $city = array("San Diego", "Los Angeles", "San Jose"); ?> 
```

现在到了我正在挣扎的部分。我似乎无法让循环正常工作，以便我可以分别输出每个城市。

当我这样做时，只有数组中的第一个城市（圣地亚哥）会显示，我明白为什么......我只是表明这种方法至少会打印“一些东西”

```
function drawMarkersMap() {
  var newInfo = google.visualization.arrayToDataTable([
    ['City'],
    ['<?php foreach($city as $location){ echo json_encode($location); } ?>']
]);
//options here
} 
```

所以，我正在尝试使用javascript循环并打印数组中的每个项目，但我似乎没有正确的逻辑

```
function drawMarkersMap() {
  var newInfo = google.visualization.arrayToDataTable([
    ['City'],
    for(i=0;i<json_encode($city).count;i++){
     //some kind of print statement mixing php and javascript. I need help here please!
     }
]); 
```

这是整个页面

```
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Google Visualization API Sample</title>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>

<?
$city = array("San Jose","Los Angeles","San Diego");
foreach($city as $key=>$value) {
     echo "$value";
}  
?>
<script type="text/javascript">
 google.load('visualization', '1.1', {packages: ['geochart']});

function drawMarkersMap() {
  var newInfo = google.visualization.arrayToDataTable([
    ['City'],
['<?php echo json_encode($city);  ?>']
]);

var chart = new google.visualization.GeoChart(document.getElementById('chart_div'));

chart.draw(newInfo, {width: 556, height: 347, displayMode: 'markers', region: 'US-CA', resolution: 'provinces'});
}

google.setOnLoadCallback(drawMarkersMap);
</script>
</head>
<body style="font-family: Arial;border: 0 none;">
<div id="chart_div"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T01:24:48.950

```
<?php $city = array(array('City'), array('San Diego'), array('Los Angeles'), array('San Jose')); ?>

var newInfo = google.visualization.arrayToDataTable(<?php echo json_encode($city); ?>); 
```

这将重新创建与原始脚本完全相同的数组结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:36:52.730

你为什么不使用内[爆](http://tr.php.net/manual/en/function.implode.php)功能？

```
<script type="text/javascript">
<?php $city = array("San Diego", "Los Angeles", "San Jose"); ?>
    function drawMarkersMap() {
        var newInfo = google.visualization.arrayToDataTable([
        ['City'],
        ['<?php echo implode("'],\n\t\t['",$city) ?>']
        ]);
    }
</script> 
```

这将导致

```
<script type="text/javascript">
    function drawMarkersMap() {
        var newInfo = google.visualization.arrayToDataTable([
        ['City'],
        ['San Diego'],
        ['Los Angeles'],
        ['San Jose']]);
    }
</script> 
```

根据要求……</p>

```
<script type="text/javascript">
<?php $city = array("San Diego", "Los Angeles", "San Jose"); ?>
    function drawMarkersMap() {
        var newInfo = google.visualization.arrayToDataTable([
        ['City'],
        ['<?php foreach($city as &$c)$c=htmlspecialchars($c,ENT_QUOTES,'UTF-8'); echo implode("'],\n\t\t['",$city); ?>']
        ]);
    }
</script> 
```

..虽然我应该同意使用 JSON 非常实用的事实:)

# javascript - 在 div 容器中移动重复模式

> ID：10645535
> 
> 赞同：0
> 
> 时间：2012-05-18T01:14:29.247
> 
> 标签：javascript, jquery, html

我有一个`div`容器，它有一个重复的背景图像，形成一个图案，我想用 jQuery 对其进行动画处理，以便图案向西南方向移动。

如何才能做到这一点？

```
<head>

    <meta charset="utf-8">

    <link rel="stylesheet" type="text/css" href="content/main.css">

    <script src="content/jquery.js" type="text/javascript"></script>
    <script type="text/javascript">
    $(document).ready(function() {
        $("#container").animate({
            'background-position': '1110px 1110px'
        }, 1000, function () {
        });
    });
    </script>

</head>

<body>

    <div id="container">

    </div>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:17:47.030

看看[明快](http://spritely.net/)。它是一个 jQuery 插件，使背景图像的动画制作相当容易。

要平移（为背景图像设置动画），文档以以下代码为例：

```
$('#trees').pan({fps: 30, speed: 2, dir: 'left'}); 
```

* * *

如果您正在寻找一种更简单、更轻便的方法，[这个插件](http://www.protofunc.com/scripts/jquery/backgroundPosition/)可能是一个更好的解决方案。要为背景设置动画，请给它一个偏移量：

```
$('.elem').animate({backgroundPosition: '500px 150px'}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:20:13.243

像这样：

```
 $("#container").animate({
        'background-position': '1110px 1110px'
    }, 1000, function () {
 }); 
```

...

```
/**
* @author Alexander Farkas
* v. 1.22
*/

(function ($) {
    if (!document.defaultView || !document.defaultView.getComputedStyle) { // IE6-IE8
        var oldCurCSS = $.curCSS;
        $.curCSS = function (elem, name, force) {
            if (name === 'background-position') {
                name = 'backgroundPosition';
            }
            if (name !== 'backgroundPosition' || !elem.currentStyle || elem.currentStyle[name]) {
                return oldCurCSS.apply(this, arguments);
            }
            var style = elem.style;
            if (!force && style && style[name]) {
                return style[name];
            }
            return oldCurCSS(elem, 'backgroundPositionX', force) + ' ' + oldCurCSS(elem, 'backgroundPositionY', force);
        };
    }

    var oldAnim = $.fn.animate;
    $.fn.animate = function (prop) {
        if ('background-position' in prop) {
            prop.backgroundPosition = prop['background-position'];
            delete prop['background-position'];
        }
        if ('backgroundPosition' in prop) {
            prop.backgroundPosition = '(' + prop.backgroundPosition;
        }
        return oldAnim.apply(this, arguments);
    };

    function toArray(strg) {
        strg = strg.replace(/left|top/g, '0px');
        strg = strg.replace(/right|bottom/g, '100%');
        strg = strg.replace(/([0-9\.]+)(\s|\)|$)/g, "$1px$2");
        var res = strg.match(/(-?[0-9\.]+)(px|\%|em|pt)\s(-?[0-9\.]+)(px|\%|em|pt)/);
        return [parseFloat(res[1], 10), res[2], parseFloat(res[3], 10), res[4]];
    }

    $.fx.step.backgroundPosition = function (fx) {
        if (!fx.bgPosReady) {
            var start = $.curCSS(fx.elem, 'backgroundPosition');
            if (!start) {//FF2 no inline-style fallback
                start = '0px 0px';
            }

            start = toArray(start);
            fx.start = [start[0], start[2]];
            var end = toArray(fx.end);
            fx.end = [end[0], end[2]];

            fx.unit = [end[1], end[3]];
            fx.bgPosReady = true;
        }
        //return;
        var nowPosX = [];
        nowPosX[0] = ((fx.end[0] - fx.start[0]) * fx.pos) + fx.start[0] + fx.unit[0];
        nowPosX[1] = ((fx.end[1] - fx.start[1]) * fx.pos) + fx.start[1] + fx.unit[1];
        fx.elem.style.backgroundPosition = nowPosX[0] + ' ' + nowPosX[1];
    };
})(jQuery); 
```

# regex - 使用正则表达式前瞻，egrep

> ID：10645542
> 
> 赞同：27
> 
> 时间：2012-05-18T01:15:11.493
> 
> 标签：regex, grep, regex-lookarounds

如果您的文件包含

```
apples are good
apple cider is also good 
```

为什么会`egrep '(?=apples)app' file`不接任何线路？

在 MAC 上使用 egrep 2.5.1

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-18T01:38:57.877

扩展的正则表达式没有积极的前瞻功能。查看[正则表达式风味比较](http://www.regular-expressions.info/refflavors.html)

# javascript - 是否可以获得动态加载的javascript文件的下载进度？

> ID：10645546
> 
> 赞同：4
> 
> 时间：2012-05-18T01:17:04.410
> 
> 标签：javascript, asynchronous

我想为一个异步加载大型 javascript 文件（应用程序的核心）的网络应用程序加载一个基本主页。

我可以检索这个js文件的下载进度吗？

我想显示一个准确反映下载进度的加载栏，然后在脚本完成后启用“启动”按钮。

我通常使用 jquery，但对任何解决方案都很满意！如果有帮助，我将使用 php 后端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:38:19.517

这不适用于所有浏览器，但您可以`<progress>`在 HTML5 中使用该标签。

[http://blog.greweb.fr/2012/04/work-in-progress/](http://blog.greweb.fr/2012/04/work-in-progress/)

您还可以使用该`progress`事件进行连接。

[https://developer.mozilla.org/En/Using_XMLHttpRequest#Monitoring_progress](https://developer.mozilla.org/En/Using_XMLHttpRequest#Monitoring_progress)

# css - 是否可以将输入值属性用作 CSS 选择器？

> ID：10645552
> 
> 赞同：61
> 
> 时间：2012-05-18T01:17:50.693
> 
> 标签：css

是否可以使用 CSS 选择器来定位具有特定值的输入？

示例：我如何根据以下输入来定位`value="United States"`

```
<input type="text" value="United States" /> 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-05-18T01:23:58.560

## 动态值（哦不！D;）

正如 npup 在他的回答中解释的那样，一个简单的 css 规则将只针对属性`value`，这意味着这并不涵盖 html 节点的实际值。

***JAVASCRIPT 救援！***

*   丑陋的解决方法：http: [//jsfiddle.net/QmvHL/](http://jsfiddle.net/QmvHL/)

* * *

## 原始答案

是的，很有可能，使用 css 属性选择器，您可以通过它们的值以这种方式引用输入：

```
input[value="United States"] { color: #F90; }​ 
```

## [• jsFiddle 示例](http://jsfiddle.net/TYYNJ/)

> **从参考**
> 
> *   [att] 当元素设置“att”属性时匹配，无论该属性的值如何。
>     
>     
> *   [att=val] 当元素的“att”属性值正好是“val”时匹配。
>     
>     
> *   [att~=val] 表示具有 att 属性的元素，其值为以空格分隔的单词列表，其中一个恰好是“val”。如果“val”包含空格，它永远不会代表任何东西（因为单词是用空格分隔的）。如果“val”是空字符串，它也永远不会代表任何东西。
>     
>     
> *   [att|=val] 表示具有 att 属性的元素，其值要么正好是“val”，要么以“val”开头，紧跟“-”（U+002D）。这主要是为了允许语言子代码匹配（例如，HTML 中 a 元素上的 hreflang 属性），如 BCP 47 ([BCP47]) 或其后续版本中所述。对于 lang（或 xml:lang）语言子代码匹配，请参见 :lang 伪类。

*   [css 属性选择器参考](http://www.w3.org/TR/CSS2/selector.html#attribute-selectors)

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2015-04-13T18:43:48.783

如果您使用的浏览器支持 CSS[伪类](https://developer.mozilla.org/en-US/docs/Web/CSS/:valid)和[输入上的验证属性，](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-pattern)这***是***可能的——其中包括除 IE9 之外的大多数现代浏览器。[`:valid`](https://developer.mozilla.org/en-US/docs/Web/CSS/:valid)[`pattern`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-pattern)

例如，要在输入正确答案时将输入文本从黑色更改为绿色：

```
input {
  color: black;
}
input:valid {
  color: green;
}
```

```
<p>Which country has fifty states?</p>

<input type="text" pattern="^United States$">
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-10-26T07:32:22.087

是的，但请注意：由于属性选择器（当然）以元素的*属性*为目标，而不是 DOM 节点的*value 属性*（elem.value），因此在更新表单字段时它不会更新。

否则（有一些诡计）我认为它可以被用来做一个 CSS-only 替代“占位符”属性/功能。也许这就是OP所追求的？:)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-01-09T22:09:14.903

如前所述，您需要的不仅仅是一个 css 选择器，因为它不访问节点的存储值，因此绝对需要 javascript。这是另一种可能的解决方案：

```
<style>
input:not([value=""]){
border:2px solid red;
}
</style>

<input type="text" onkeyup="this.setAttribute('value', this.value);"/> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-05-18T01:24:29.387

当然，试试：

```
input[value="United States"]{ color: red; } 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/9mBfD/)**。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-05T12:14:28.610

您可以使用 Css3 属性选择器或属性值选择器。

/*这将使所有其值定义为红色的输入*/

```
input[value]{
color:red;
} 
```

/*这将根据输入值进行条件选择*/

```
input[value="United States"]{
color:red;
} 
```

还有其他属性选择器，例如属性包含值选​​择器，

```
input[value="United S"]{
color: red;
} 
```

这仍然会将美国的任何输入作为红色文本。

比我们属性值以选择器开头

```
input[value^='united']{
color: red;
} 
```

任何以“united”开头的输入文本都将具有红色字体

最后一个是属性值以选择器结尾

```
input[value$='States']{
color:red;
} 
```

任何以“States”结尾的输入值都将具有红色字体

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-11-20T11:24:59.800

刷新事件的属性是比每十分之一秒扫描一次值更好的方法......

[http://jsfiddle.net/yqdcsqzz/3/](http://jsfiddle.net/yqdcsqzz/3/)

```
inputElement.onchange = function()
{
    this.setAttribute('value', this.value);
};

inputElement.onkeyup = function()
{
    this.setAttribute('value', this.value);
}; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-02-09T09:48:06.503

在 Chrome 72 (2019-02-09) 中，我发现该`:in-range`属性出于某种原因应用于空`date`输入！

所以这对我有用：（我添加了`:not([max]):not([min])`选择器以避免破坏*确实*应用了范围的日期输入：

```
input[type=date]:not([max]):not([min]):in-range {
    color: blue;
} 
```

截屏：

* * *

[![在此处输入图像描述](../Images/87b8323e0f8e6ce81f69e45dff4c4d37.png)](https://i.stack.imgur.com/PeaW7.png)

* * *

这是一个可运行的示例：

```
window.addEventListener( 'DOMContentLoaded', onLoad );

function onLoad() {

    document.getElementById( 'date4' ).value = "2019-02-09";

    document.getElementById( 'date5' ).value = null;

}
```

```
label {
    display: block;
    margin: 1em;
}

input[type=date]:not([max]):not([min]):in-range {
    color: blue;
}
```

```
<label>
    <input type="date" id="date1" />
    Without HTML value=""
</label>

<label>
    <input type="date" id="date2" value="2019-02-09" />
    With HTML value=""
</label>

<label>
    <input type="date" id="date3" />
    Without HTML value="" but modified by user
</label>

<label>
    <input type="date" id="date4" />
    Without HTML value="" but set by script
</label>

<label>
    <input type="date" id="date5" value="2019-02-09" />
    With HTML value="" but cleared by script
</label>
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-07-29T12:01:42.517

在当前投票最多的答案之后，我发现使用数据集/数据属性效果很好。

```
//Javascript

const input1 = document.querySelector("#input1");
input1.value = "0.00";
input1.dataset.value = input1.value;
//dataset.value will set "data-value" on the input1 HTML element
//and will be used by CSS targetting the dataset attribute

document.querySelectorAll("input").forEach((input) => {
  input.addEventListener("input", function() {
    this.dataset.value = this.value;
    console.log(this);
  })
})
```

```
/*CSS*/

input[data-value="0.00"] {
  color: red;
}
```

```
<!--HTML-->

<div>
  <p>Input1 is programmatically set by JavaScript:</p>
  <label for="input1">Input 1:</label>
  <input id="input1" value="undefined" data-value="undefined">
</div>
<br>
<div>
  <p>Try typing 0.00 inside input2:</p>
  <label for="input2">Input 2:</label>
  <input id="input2" value="undefined" data-value="undefined">
</div>
```

# python - Python：如何引用字典中元组的元素

> ID：10645554
> 
> 赞同：0
> 
> 时间：2012-05-18T01:18:14.613
> 
> 标签：python

例如，我有一个 dict var 定义如下：

```
var{m:(a, b)} 
```

现在我想在 for 循环中引用 'a' 的值

假设 var 填充了一些实例，如下所示

```
var = {0: {'1a': (502, 2)}, 1: {'2b': (103, 3)}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:35:08.097

你可能想要，而不是：

```
for k, (v1, v2) in var.iteritems():
    print v1 
```

或者，如果不是所有的 dict 值都有两个项目（或者如果您的 Python 版本不进行多级元组解包）：

```
for k, v in var.iteritems():
    print v[0] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:20:40.463

对，所以你想要`v[0]['1a'][0]`

编辑：回应您的评论，您可能想要：

```
for key, value in v[k].items():
  print value[0] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T01:33:40.577

可能这就是你想要的：

```
var = {0: {'1a': (502, 2)}, 1: {'2b': (103, 3)}}

for m, elements in var.items():
    for a, b in elements.values():
        print a 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T01:37:55.710

让我们看看这个通用示例是否可以通过描述性地命名我们得到的项目来使其清楚。

```
var = {0: {'1a': (502, 2)}, 1: {'2b': (103, 3)}} 
```

您想迭代 var 包含的所有 dicts 并迭代它们包含的内容。

```
for number, innerdict in var.items(): # first time around number is e.g. 0 and innerdict is e.g. {'1a': (502, 2)}
    print number
    for numberletter, tup in innerdict.items(): # first time around numberletter is e.g. 1a and tup is e.g. (502, 2) 
        print numberletter, tup
        for tuplenumber in tup: # first time around tuplenumber is e.g. 502
            print tuplenumber 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T01:46:37.040

这是你想要的？

```
var = {'m':('a', 'b'), 'n': ('c','d')}

a_coords = [(k,v.index('a')) for k,v in var.iteritems() if 'a' in v ] 
```

结果：

```
>>> a_coords
[('m', 0)] 
```

`'m'`是与包含 a 的元组的值相关联的键，并且`0`是 a 所在的索引。

# php - PHP数组循环没有中断

> ID：10645555
> 
> 赞同：0
> 
> 时间：2012-05-18T01:18:16.190
> 
> 标签：php, arrays, loops, iteration

出于某种原因，使用以下方法循环数组会抵制其 break 语句并继续递归循环到数组的最大最后一个元素

```
function loop($target, $array) {
  if($this) {
    if(!isset($GLOBALS["loop"])) {
      $GLOBALS["loop"]+=1;
      $GLOBALS["arrayCount"] = count($array, COUNT_RECURSIVE);
    }
  }
  $keys = array_keys($array);
  $values = array_values($array);
  for($i=0;$i<count($array);$i++) {
    $GLOBALS["iteration"]+=1;
    if($keys[$i] === $target) {
      print "Found $target.<br>";
      break;
    }
    if(is_array($array[$i])) {
      loop($target, $array[$i]);
    }
    if($values[$i] === $target) {
      print "Found $target.<br>";
      break;
    }
    if($GLOBALS["iteration"] >= $GLOBALS["arrayCount"]) {
      print "Looped array.<br>";
      break;
    }
} 
```

任何帮助是极大的赞赏！

已解决：它需要附加一个退出语句，所以感谢神秘的评论，无论什么原因消失了！虽然，了解为什么 break 语句不足以停止递归循环会很有趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:29:16.483

我真的发现了这个问题...

以下代码：

```
if(is_array($array[$i])) {
  loop($target, $array);
} 
```

应该：

```
if(is_array($array[$i])) {
  loop($target, $array[$i]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T07:12:17.503

这是一个相当奇怪的循环。您可以避免使用内置类型编写自己的递归；我*认为*这就是你想要做的：

```
<? //PHP 5.4+

$loop = static function($target, array $array){
    $query = $array;
    $query = new \RecursiveArrayIterator($query);
    $query = new \RecursiveIteratorIterator(
        $query, 
        \RecursiveIteratorIterator::SELF_FIRST
    );
    foreach($query as $key => $value){
        if ($key === $target){
            return "Found $target (key)";
        } elseif ($value === $target){
            return "Found $target (value)";
        }
    }
};

$testData = [
 'key1' => 'value1',       
 'key2' => 'value2',
 'key3' => [
     'key4' => 'value4',
 ],      
];

echo
    $loop('key2', $testData), '<br/>',
    $loop('key3', $testData), '<br/>',
    $loop('key4', $testData), '<br/>',
    $loop('value4', $testData), '<br/>'
;
/*
Found key2 (key)
Found key3 (key)
Found key4 (key)
Found value4 (value)
 */
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T01:23:03.960

只是一个猜测，但也许这些陈述应该是`else if`s？除非是故意的，否则可能会导致一些奇怪的递归问题。

# android - Android - 如何确保标题适合所有按钮？

> ID：10645556
> 
> 赞同：0
> 
> 时间：2012-05-18T01:18:24.400
> 
> 标签：android, android-layout

我有一个正在处理的标题，我让按钮呈现在一行中，但是一个按钮不适合屏幕，并且按钮之间有一个空格。

到目前为止，这是我的标题布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent" 
android:layout_height="fill_parent">

 <Button android:id="@+id/home"
  android:layout_width="0dp" 
  android:orientation="horizontal"
  android:layout_height="10dp"
  android:layout_weight="1"
  android:text="Home"
/>

<Button android:id="@+id/questions"
 android:layout_width="0dp" 
 android:layout_height="10dp"
 android:orientation="horizontal"
 android:layout_weight="1"
 android:text="Questions"
android:layout_toRightOf="@+id/home"  />  

 <Button android:id="@+id/businesses"
  android:layout_width="0dp" 
  android:layout_height="10dp"
  android:orientation="horizontal"
  android:layout_weight="1"
  android:text="Businesses"
  android:layout_toRightOf="@+id/questions"
 />  

 <Button android:id="@+id/learn"
  android:layout_width="0dp" 
  android:layout_height="10dp"
  android:layout_weight="1"
  android:orientation="horizontal"
  android:text="Learn"
  android:layout_toRightOf="@+id/businesses"
 />  

 <Button android:id="@+id/extra_help"
  android:layout_width="0dp" 
  android:layout_height="10dp"
  android:orientation="horizontal"
  android:layout_weight="1"
  android:text="Help"
  android:layout_toRightOf="@+id/learn"
/>  
</LinearLayout> 
```

如何使每个按钮更小，并使其之间没有空间？另外，哪些设备的屏幕更窄？如何确保标题适合所有屏幕？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:21:02.323

您可以使用 a`LinearLayout`并将每个`Button`'s设置`layout_width`为`0dp`和`layout_weight`to `1`。这样，整个空间`LinearLayout`将平均分布在您`Button`的 s 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T03:52:29.863

使用`RelativeLayout`而不是`LinearLayout`. 比您拥有的任何屏幕都适合。

# video-streaming - 在 RTP UDP 上以 FU-A 模式打包 h264 流时出现问题

> ID：10645557
> 
> 赞同：0
> 
> 时间：2012-05-18T01:19:18.010
> 
> 标签：video-streaming, h.264, mp4, rtp

我在使用 SIP 和 RTP over UDP 打包 h.264 流时遇到了一些问题。我正在对 mp4 中的视频 avc 轨道使用 FU-A 打包模式。我花了一些时间来获得正确的分段，RTP 数据包上的持续时间时间戳，以及在分段单元上的最后一个数据包上设置标记位。有人可以看看我在链接下面发布的数据包，这些数据包流式传输下面指示的 mp4。您将需要使用 ssrc 0x1653 检查wireshark pcap 中的第一个h264 RTP 流，这是我要打包的流。正在接收流的视频电话不显示流，我正在尝试解决原因。感谢您的任何分析。保罗

[http://antinori.us/h264.packets.pcap](http://antinori.us/h264.packets.pcap)

[http://antinori.us/beck-videoplayback.mp4](http://antinori.us/beck-videoplayback.mp4)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T12:28:23.050

首先，我不知道 mp4 文件结构，但知道 H.264 打包。根据我的 H.264 分组知识，似乎有两个问题。

Fragmentation Unit 结构本身看起来不错。

在您的数据包文件“http://antinori.us/h264.packets.pcap”中，

1.  可能是 PPS (Packet #72) 不正确。该值与 SPS(Packet #71) 完全相同。让我们假设 PPS 是正确的。通常 PPS 比 SPS 短（在我的情况下只有 4 个字节 - H.264 Baseline profile 甚至 H.264 High Profile。）
2.  在 SDP（数据包 #67）中间，有一个字段“a”，参数为“profile-level-id”，值应该是 NAL IDR 之后的前 3 个字节，因此值应该是“42C01E”

为了您的信息，我制作了 SPS 的副本（序列参数集 - 数据包 #71）

`6742c01e924405017fcb080000030008000003018078b177ffffffffffffe0`

在第一个 NAL 单元序列参数集字节 (67) 之后，接下来的三个字节用于“profile-level-id”

# c# - 从 xml 中删除非法的 0x1f 字符

> ID：10645559
> 
> 赞同：2
> 
> 时间：2012-05-18T01:19:52.060
> 
> 标签：c#, xml

我有一个程序可以生成一些数据并将其保存为 xml，不幸的是，出于我的目的，我无法将其保存在允许 0x1f 之类的字符的较新 XML 中。因此，我需要从我的 xml 中删除这个字符。我所能找到的似乎就是这样做的[http://benjchristensen.com/2008/02/07/how-to-strip-invalid-xml-characters/](http://benjchristensen.com/2008/02/07/how-to-strip-invalid-xml-characters/)但我不知道java脚本，并且希望能够使用我能够理解的脚本。我知道基本的 C#，但不是很好。无论如何，过滤这个角色最简单的方法是什么？我确实认为这对在线社区来说是一个很好的问题，因为从 Google 中找到 C# 中的工作方法被证明是具有挑战性的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T18:51:43.807

来自这篇文章：[如何从字符串中去除非 ASCII 字符？（在 C# 中）](https://stackoverflow.com/questions/123336/how-can-you-strip-non-ascii-characters-from-a-string-in-c)

根据您的情况调整它：

```
string s = File.ReadAllText(filepath);
s = Regex.Replace(s, @"[\u0000-\u001F]", string.Empty);
File.WriteAllText(newFilepath, s); 
```

然后测试新文件。在您知道这是否有效之前，不要覆盖旧的。

# javascript - 由于 jquery 对话框，javascript 没有运行

> ID：10645563
> 
> 赞同：0
> 
> 时间：2012-05-18T01:20:15.203
> 
> 标签：javascript, jquery, html, javascript-events

我有一些代码用于创建一个下拉菜单，该菜单会根据检查的内容而变化。从页面分离的 javascript 和 html 工作正常，但是一旦它与 jquery 同时加载，并且所有内容都放入一个对话框中，我会收到一个类似这样的错误

我可以通过我的客户端上的萤火虫看到这个错误，但它似乎没有出现在 jsfiddle 但是当它出现时，下拉菜单不起作用......

```
document.form1a.damage is undefined
[Break On This Error]   
document.form1a.damage[i].options.length=0; 
```

我已经设法解决了这么多：它是由 jquery 代码的对话框部分引起的，而不是我正在使用的其他 jquery 并且一旦删除对话框，下拉菜单就可以正常工作。我已将所有代码上传到 JsFiddle

[提琴手](http://jsfiddle.net/9YTwv/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T12:43:49.923

问题是 jsFiddle 将您的代码包装在一个`$(window).load`函数中，`fill_damage`该函数在函数中定义了一个变量`$(window).load`。一旦`$(window).load`函数完成执行，该`fill_damage`函数就不再在作用域内，这意味着您不能使用`onchange`处理程序来引用它。

解决方案是：

1.  将它包含在您的中`$(function)` **，并**`click`使用 jQuery（推荐，因为您已经在使用它）或通过更传统的 JavaScript 方法（例如`addListener`（不推荐，因为您已经在使用 jQuery）将其分配给处理程序。
2.  或 将您的框架选择更改为`noWrap (head)`或`no wrap (body)`。

我重写了你的小提琴（有很多评论）。你可以在这里看到它：http: [//jsfiddle.net/9YTwv/7/](http://jsfiddle.net/9YTwv/7/)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:12:40.363

执行该代码时，您的表单为空。Jquery ui 对话框会将其整个 html 结构移动到其自己的 div 中（通常位于页面底部），其中包含所有应用的样式、类等。

要在 jsfiddle 中看到这一点，请将代码加载事件更改为`no wrap (head)`，它位于框架选择上方。你会得到你提到的错误。

使用 firebug/chrome 检查器查看当时的 html 结构。你有：

```
<form name="form1a" method="post" id="form1a"></form>
<div dialog1></div>
<div dialog2></div>
<div overlay></div> 
```

作为该问题的解决方案，请考虑为选择提供自己的 ID 并使用：

```
document.getElementById('selectDamage0').options.length = 0; 
```

...或继续使用按类名和索引等，而不是使用形式表示法。

**更新：**

这是一个展示另一种方法的jsfiddle，只需将onchange与jquery绑定并通过它设置选项。注释了一点以显示流程——函数在底部附近：

[http://jsfiddle.net/xCMU6/](http://jsfiddle.net/xCMU6/)

**更新 2：**

以这种方式在基本级别管理 id 的一种旧方法是使用公共前缀/后缀。所以你的第一个选择是`type-0`with `damage-0`。然后引用另一个你换掉单词（或拆分 - ）。

# python - 使用 pygame.transform.rotate() 时的奇怪移动

> ID：10645566
> 
> 赞同：0
> 
> 时间：2012-05-18T01:20:54.567
> 
> 标签：python, pygame

```
def rotate(self):
    #Save the original rect center
    self.saved_center=self.rect.center

    #Rotates a saved image every time to maintain quality
    self.image=pygame.transform.rotate(self.saved_image, self.angle)

    #Make new rect center the old one
    self.rect.center=self.saved_center

    self.angle+=10 
```

当我旋转图像时，尽管我保存了旧的矩形中心并使旋转的矩形中心成为旧的，但它还是会发生奇怪的变化。我希望它在正方形的中心旋转。

这是它的样子：http: [//i.imgur.com/g6Os9.gif](http://i.imgur.com/g6Os9.gif)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:20:58.920

您只是在计算新的 rect 错误。试试这个：

```
def rotate(self):
    self.image=pygame.transform.rotate(self.saved_image, self.angle)
    self.rect = self.image.get_rect(center=self.rect.center)
    self.angle+=10 
```

它告诉新的矩形以原始中心为中心（中心永远不会在这里改变。只是不断地传递）。

问题是 self.rect 从未正确更新。您只是在更改中心值。整个矩形随着图像的旋转而变化，因为它的大小会增大和缩小。所以你需要做的是每次都完全设置新的矩形。

```
self.image.get_rect(center=self.rect.center) 
```

这将计算一个全新的矩形，同时基于给定的中心。在计算位置之前，中心设置在矩形上。因此，您会得到一个以您的点为中心的矩形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-02T14:23:08.933

我有这个问题。我的方法有一点不同的目的，但我很好地解决了它。

```
import pygame, math

def draw_sprite(self, sprite, x, y, rot):
    #'sprite' is the loaded image file.
    #'x' and 'y' are coordinates.
    #'rot' is rotation in radians.

    #Creates a new 'rotated_sprite' that is a rotated variant of 'sprite'
    #Also performs a radian-to-degrees conversion on 'rot'.
    rotated_sprite = pygame.transform.rotate(sprite, math.degrees(rot))

    #Creates a new 'rect' based on 'rotated_sprite'
    rect = rotated_sprite.get_rect()

    #Blits the rotated_sprite onto the screen with an offset from 'rect'
    self.screen.blit(rotated_sprite, (x-(rect.width/2), y-(rect.height/2))) 
```

# ruby-on-rails - “找不到没有 ID 的 [model]” Rails 3.2.3

> ID：10645570
> 
> 赞同：2
> 
> 时间：2012-05-18T01:21:33.960
> 
> 标签：ruby-on-rails, forms, controller, associations, form-for

出于某种原因，我不断收到此错误。

> 找不到没有 ID 的专辑

但这没有意义，因为在我的 debug.params 中它说：

> > {"utf8"=>"✓",
> > 
> > "authenticity_token"=>"os9DVVZS6//bs3Ne2Xfrh4VnKXNtDXkZaE4s/3iQagE=",
> > 
> > "视频"=>{"url"=>"www.youtube.com/watch?v=yIRuri1AB0I",
> > 
> > "album_id"=>"1"},
> > 
> > “提交”=>“下一步”}

这是控制器：

> 类视频控制器 < 应用控制器
> 
> 包括专辑助手
> 
> before_filter :signed_in_user, only: [:create, :destroy] #稍后添加更新
> 
> before_filter :correct_user, only: :destroy

```
def show
    @video = Video.find(params[:id])
end

def new
    if signed_in?
        @album = Album.find(params[:album_id])
    @video = @album.build_video
end
end

def create 
    @album = Album.find(params[:album_id])
    @video = @album.build_video(params[:video])
    if @video.save 
        flash[:success] = "Success!"
        redirect_to new_small_reward_path(:album_id => @album)
    else
        render 'new'
    end
end 
```

> 结尾

我什至在表单中添加了一个隐藏字段，我认为我不应该这样做，但决定尝试：

在您单击提交之前，该 URL 会显示 /videos/new?album_id=1。

如果我用这个编写控制器，这个问题就完全消失了：

> 定义新
> 
> @@album = Album.find(参数[:album_id])
> 
> 结尾

然后在整个过程中继续使用类变量。但是有人告诉我不鼓励使用类变量。我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:56:15.560

> @album = Album.find(参数[:video][:album_id])

# jquery - jquery杀死元素，而不是隐藏

> ID：10645571
> 
> 赞同：0
> 
> 时间：2012-05-18T01:21:37.220
> 
> 标签：jquery, database, pdo

我有一个页面，有一个链接，如果用户点击链接，会出现一个新的选择标签，离开那个选择，会有一个删除链接，如果用户点击它，选择标签会消失。

我的问题是当我点击创建一个新的选择然后点击删除它时，它并没有被删除，它只是被隐藏了，我不希望提交后因为我检查是否设置了新的选择，所以我得到了真正的因为它只是隐藏而不是删除，请问如何解决

# html代码

```
<div class="container" id="addCell">
    <form method="POST" action="<?php echo URL; ?>Cell/addCell">
        <ul>
            <li>
                <p>
                    <label>Name</label>
                    <input type="text" name="name"class="longInput1"/>
                <p>
                <p>
                    <label>City</label>
                    <select id="countrySelector" name="city">
                    </select>
                </p>
            </li>
            <li>
                <p>
                    <label>Inserted cells</label>
                    <a href="#" class="smallLink" id="acaclink">new</a>
                </p>
            </li>
            <li>
                <input type="submit" class="button1" value="save"/>
            </li>
        </ul>
    </form>
</div> 
```

# 数据库代码

```
public function addCell() {
        $cellName = $_POST['name'];
        $cityName = $_POST['city'];
        $this->model->addCell($cellName, $cityName);
        if (isset($_POST['acSelect'])) {
            $cells = $_POST['acSelect'];
            $cellID = $this->model->getCellID($cellName);
            $this->model->insertIntersectionCells($cellID, $cells);
        }
        include_once 'Successful.php';
        $s = new Successful();
        $s->index("you inserted your cell");
    } 
```

$jquery代码#

```
$("#addCell").ready(function(){
    $("#addCell").on('click',"#acaclink",function(){
        var me = this;
        $.getJSON("http://localhost/Mar7ba/Cell/getAllCells/TRUE",function(data){
            var options = '';
            options+="<option>select cell</option>";
            for(var i=0;i<data.length;i++){
                options += "<option>"+data[i]+"</option>";
            }
            $(me).closest('li').append('<p>\n\
            <label>Select Cell</label>\n\
            <select name="acSelect[]">\n\
             '+options+'\n\
</select>\n\
<a href="#" class="removeA">delete</a>\n\
</p>');
        });
    });
});
$("#addCell").ready(function(){
    $("#addCell").on('click',".removeA",function (){
        $(this).closest('p').hide();
    });
}); 
```

我希望我能解释我的问题因为我的英语不好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T01:24:27.993

你可以使用[`remove()`](http://api.jquery.com/remove/)方法：

```
$("#addCell").ready(function(){
    $("#addCell").on('click',".removeA",function (){
        $(this).closest('p').remove();
    });
}); 
```

# java - 如何使用正则表达式在 Java 中进行搜索和替换

> ID：10645575
> 
> 赞同：2
> 
> 时间：2012-05-18T01:22:25.187
> 
> 标签：java, regex

处理字符串搜索和替换的一种明显方法是

```
String s = "This will go over well!";
s = s.replace("go", "not go"); 
```

我想知道..可以使用正则表达式包来完成同样的事情吗？使用它有什么好处吗？

可以存在类似的东西`s/go/not go/g`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:24:11.650

> 我想知道..可以使用正则表达式包来完成同样的事情吗？使用它有什么好处吗？

请查看 using`String#replaceAll(String regex, String replacement)`而不是，`String#replace(...)`因为这将正则表达式用于第一个参数。[String API](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html)会告诉你更多关于这个的信息。这确实提供了一些额外的灵活性和功能，但代价是（我相信 - 我没有对此进行分析）执行时间较慢。

> 可以存在类似于 s/go/not go/g 的东西吗？

我不确定我明白你在这里问什么。你能澄清一下吗？

# backbone.js - 解析主干中的嵌套集合

> ID：10645579
> 
> 赞同：0
> 
> 时间：2012-05-18T01:23:12.410
> 
> 标签：backbone.js

嗨，我有一个嵌套集合。

```
{"Categories":[{},{},{}],"Preference":[{},{},{}],"Users":[{},{},{}]} 
```

现在我将类别传递给另一个集合，将偏好传递给另一个集合，并将用户传递给另一个集合。是不是还很迷茫？我读过你可以在模型上做到这一点，但它会起作用吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T06:36:59.550

如果您可以控制后端，您可能想要做的是将集合的检索拆分为三个不同的 Ajax 调用：

```
var Categories = Backbone.Collection.extend({
    url: "/categories"
});
var Preferences = Backbone.Collection.extend({
    url: "/preferences"
});
var Users = Backbone.Collection.extend({
    url: "/users"
});
var categories = new Categories();
categories.fetch();
... 
```

如果由于某种原因无法更改服务器上的路由，则可以通过将数组传递给构造函数来手动创建模型：

```
var categories = new Categories(data["Categories"]); 
```

如果数据是 JSON 格式，您可以使用 jQuery 解析成 Javascript 对象： `jQuery.parseJSON(data);`

# ruby-on-rails - RSpec 的期望如何在 ROR 中工作

> ID：10645590
> 
> 赞同：16
> 
> 时间：2012-05-18T01:25:00.077
> 
> 标签：ruby-on-rails, ruby, rspec, capybara

在阅读 Michael Hartl 的 Ruby On Rails 教程时，在作者编写集成测试以验证他的注册页面的部分中，他使用了下面的代码尖峰。我得到了代码的作用，但无法理解“如何”部分，即无法理解执行顺序。

```
expect { click_button "Create my account" }.not_to change(User, :count) 
```

有人可以解释上述方法和块链的语义以及它们如何组合在一起吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-05-18T01:55:41.060

您将使用`expect ... change`来验证特定方法调用是否更改 - 或不更改 - 一些其他值。在这种情况下：

```
expect { click_button "Create my account" }.not_to change(User, :count) 
```

将导致 rspec 执行以下操作：

1.  运行`User.count`并记下返回的值。（这可以指定为接收器和方法名称，就像`(User, :count)`在您的示例中一样，也可以指定为任意代码块，例如`{ User.count }`.
2.  Run`click_button "Create my account"`这是一种模拟鼠标点击链接的 Capybara 方法。
3.  再跑`User.count`。
4.  比较#1 和#3 的结果。如果它们不同，则示例失败。如果它们相同，则通过。

其他使用方法`expect ... change`：

```
expect { thing.destroy }.to change(Thing, :count).from(1).to(0)
expect { thing.tax = 5 }.to change { thing.total_price }.by(5)
expect { thing.save! }.to raise_error
expect { thing.symbolize_name }.to change { thing.name }.from(String).to(Symbol) 
```

一些文档在[这里](https://www.relishapp.com/rspec/rspec-expectations/docs/built-in-matchers/expect-change)。

它是如何做到的有点神秘，而且完全没有必要了解它是如何工作的以便使用它。调用`expect`是定义一个结构供 rspec 执行，使用 rspec 自己的自定义 DSL 和“匹配器”系统。Gary Bernhardt 有一个相当简洁的[截屏视频](https://www.destroyallsoftware.com/screencasts/catalog/building-rspec-from-scratch)，他认为 rspec 的奥秘实际上是从像 ruby​​ 这样的动态语言中自然而然地消失的。这不是一个很好的*使用*rspec 的介绍，但如果你对它的工作原理感到好奇，你可能会觉得它很有趣。

**更新**

在看到您对另一个答案的评论后，我将添加一些关于操作顺序的信息。不直观的技巧是执行所有块的是*匹配器*（`change`在这种情况下）。`expect`有一个 lambda，`not_to`是一个别名，`should_not`其工作是将 lambda 传递给匹配器。在这种情况下，匹配器`change`知道执行一次它自己的参数，然后执行它传递的 lambda（来自 的那个`expect`），然后再次运行它自己的参数以查看是否有变化。这很棘手，因为该行看起来应该从左到右执行，但由于大多数片段只是传递代码块，它们可以并且确实将它们打乱成对匹配器最有意义的任何顺序。

我不是 rspec 内部的专家，但这是我对基本思想的理解。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T01:37:14.540

[这是Ryan Bates Railscast 关于 Request Specs 和 Capybara](http://asciicasts.com/episodes/257-request-specs-and-capybara)的摘录

```
require 'spec_helper'  

describe "Tasks" do  
  describe "GET /tasks" do  
    it "displays tasks" do  
      Task.create!(:name => "paint fence")  
      visit tasks_path  
      page.should have_content("paint fence")  
    end  
  end  

  describe "POST /tasks" do  
    it "creates a task" do  
      visit tasks_path  
      fill_in "Name", :with => "mow lawn"  
      click_button "Add"  
      page.should have_content("Successfully added task.")  
      page.should have_content("mow lawn")  
    end  
  end  
end 
```

[这是RSPec 期望文档](https://www.relishapp.com/rspec/rspec-expectations/v/2-0/docs/matchers/expect-change)的摘录

```
describe Counter, "#increment" do
  it "should increment the count" do
    expect{Counter.increment}.to change{Counter.count}.from(0).to(1)
  end

  # deliberate failure
  it "should increment the count by 2" do
    expect{Counter.increment}.to change{Counter.count}.by(2)
  end
end 
```

所以基本上，

```
expect { click_button "Create my account" }.not_to change(User, :count) 
```

是 RSpec 的一部分：

```
expect {...}.not_to change(User, :count) 
```

和部分水豚

```
click_button "Create my account" 
```

（这里是[Capyabara DSL 的链接](https://github.com/jnicklas/capybara)——你可以搜索`click_button`）

听起来您正在寻找他们两者的整体示例。这不是一个完美的例子，但它可能看起来像这样：

```
describe "Tasks" do  
  describe "GET /tasks" do  
    it "displays tasks" do  
      expect { click_button "Create my account" }.not_to change(User, :count)
    end  
  end 
end 
```

# jquery - jQuery识别表行之间何时更改

> ID：10645593
> 
> 赞同：2
> 
> 时间：2012-05-18T01:25:54.450
> 
> 标签：jquery, focus

我正在尝试编写一个小 jQuery 以在用户将输入框留在表中时触发操作，并检查他们是否已移动到另一个表或表外。

我遇到的问题是成功确定重点在哪里。由于我不会深入讨论的原因，这个项目使用的是**jQuery 1.2.6**，所以一些焦点识别选择器 (:focus) 不起作用。

问题是最接近的匹配**$(document.activeElement)**仅在某些时候有效，因为它经常将**<body>**标识为当前活动元素。

似乎**模糊**事件在**焦点**事件之前触发，所以我无法在那里检索它。

我在 JS Fiddle 上设置了一个工作示例：http: [//jsfiddle.net/t3YgZ/6/](http://jsfiddle.net/t3YgZ/6/)

代码的基础是：

```
var currentRow = -1;

$(document).ready(function() {

    var rows = $("table tr");

    // Set ID for each row on init
    rows.each(function(index) {
        $(this).attr("id", index);
    });

    // Attach a handler to leaving each input box
    rows.find("input").blur(function() {
        var leavingRow = $(this).parents("tr:first").attr("id");
        var newSelectedRow = $(document.activeElement).parents("tr:first").attr("id");
        if (newSelectedRow != null && leavingRow != newSelectedRow) {
            alert("row changed");
        }
    });

}); 
```

如何确定 jQuery 1.2.6 中的当前焦点元素？

# java - 我应该为 java 使用什么音频格式？

> ID：10645594
> 
> 赞同：3
> 
> 时间：2012-05-18T01:26:01.550
> 
> 标签：java, javasound, soundeffect

我正在制作一个基于 Java 的游戏，我想为其添加一些音效。我搜索并发现自己更加困惑。我知道编码因文件格式而异。我只需要一些声音——无论哪种格式。所以请建议我最简单的文件格式。代码片段将非常有帮助。

提供音效最简单的格式和方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-18T02:00:28.933

对于短声音，您应该使用 WAV 或 AU，WAV 是最知名的小声音格式。我刚刚完成了这个小程序，你需要做的就是有一个.wav 声音。

该程序生成一个带有按钮的窗口，每次单击该按钮时都会播放指定的声音。

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.IOException;
import java.net.URL;

import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.Clip;
import javax.sound.sampled.LineUnavailableException;
import javax.sound.sampled.UnsupportedAudioFileException;
import javax.swing.JButton;
import javax.swing.JFrame;

public class PlaySound extends JFrame{

    private Clip clip;

    public static void main(String [] args) {

        PlaySound app = new PlaySound();

    }

    public PlaySound() {
        JButton play = new JButton("Play");//here we make the button
        play.addActionListener(new ActionListener() {//here we tell what the button will do
        public void actionPerformed(ActionEvent e) {
            playTheSound();//when its clicked call this method
        }
    });

    this.add(play);
    this.pack();
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setVisible(true);
}

private void SoundEffect(URL url) {
    try {
        // Set up an audio input stream piped from the sound file.
        AudioInputStream audioInputStream = AudioSystem.getAudioInputStream(url);
        // Get a clip resource.
        clip = AudioSystem.getClip();
        // Open audio clip and load samples from the audio input stream.
        clip.open(audioInputStream);
    } catch (UnsupportedAudioFileException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } catch (LineUnavailableException e) {
        e.printStackTrace();
    }
}

// Play or Re-play the sound effect from the beginning, by rewinding.
public void playTheSound() {

    URL url = getClass().getResource("click.wav");//You can change this to whatever other sound you have
    SoundEffect(url);//this method will load the sound

    if (clip.isRunning())
        clip.stop();   // Stop the player if it is still running
    clip.setFramePosition(0); // rewind to the beginning
    clip.start();     // Start playing

    }

} 
```

您可以随时将“click.wav”更改为其他声音，包括 .au 文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-18T02:16:43.440

正如 mikera 和 Basilio German 所说，AU 和 WAV 都是游戏中使用的短音效的不错选择。当前的 JRE 支持返回的类型[`AudioSystem.getAudioFileTypes()`](http://docs.oracle.com/javase/7/docs/api/javax/sound/sampled/AudioSystem.html#getAudioFileTypes%28%29)，但我会坚持使用这两种类型中的一种。

该类[`Clip`](http://docs.oracle.com/javase/7/docs/api/javax/sound/sampled/Clip.html)提供了简单的方法来加载和播放声音字节。

作为一个例子，这里是来自[Java Sound info 的例子。页](https://stackoverflow.com/tags/javasound/info)。

```
import java.net.URL;
import javax.swing.*;
import javax.sound.sampled.*;

public class LoopSound {

    public static void main(String[] args) throws Exception {
        URL url = new URL(
            "http://pscode.org/media/leftright.wav");
        Clip clip = AudioSystem.getClip();
        // getAudioInputStream() also accepts a File or InputStream
        AudioInputStream ais = AudioSystem.
            getAudioInputStream( url );
        clip.open(ais);
        // loop continuously
        clip.loop(-1);
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                // A GUI element to prevent the Clip's daemon Thread
                // from terminating at the end of the main()
                JOptionPane.showMessageDialog(null, "Close to exit!");
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-18T01:44:01.757

Java 支持相当广泛的声音格式。

如果您只是使用基本的 Java Sound API（这对于基本效果很好），那么 Oracle 常见问题解答中的以下内容可能会有所帮助：

> *Java Sound 支持哪些音频格式？*
> Java Sound 支持以下音频文件格式：AIFF、AU 和 WAV。它还支持以下基于 MIDI 的歌曲文件格式：SMF 类型 0（标准 MIDI 文件，又名 .mid 文件）、SMF 类型 1 和 RMF。

我已经成功地使用了 AU 和 WAV。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-18T01:38:24.810

音频的文件格式都取决于您的需要。MIDI 文件使用音符等，因此适用于简单的背景音乐，但 MIDI 文件无法发出特定的声音，如爆炸、枪声等。将 MIDI 视为乐器的音乐，它不用于音效。这是 WAV 或 MP3 文件发挥作用的地方，因为它们以波的形式播放声音，它们可以真正播放任何声音。它们是较大的文件（未压缩的 WAV 甚至更大），但它们经常用于音效。还有其他格式也可以使用，只需四处搜索即可。您不应该将声音格式建立在最容易使用的基础上，它实际上取决于您使用它的确切用途（音乐与音效等）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-19T14:11:23.627

您可以使用 Clip 类并使用 .Wav 或 .Au 来制作短小的声音效果。如果您尝试播放 mp3 音乐，但您始终可以使用 javazoom 之类的 mp3 java 库。

# jscrollpane - Jscrollpane 和滑动选项卡组合不起作用

> ID：10645607
> 
> 赞同：1
> 
> 时间：2012-05-18T01:27:13.147
> 
> 标签：jscrollpane, jquery-slider

我有一个使用滑动标签的测试页面（http://www.maggies-bayfield.com/wp/temp/old/slider_no_jscroll.htm）。如果单击导航栏项目，页面将向下滚动到适当的位置。这正是我想要的。但是，Android 操作系统不支持溢出：自动等，我需要它在所有移动设备上工作。所以，我找到了 Jscrollpane 并在我的测试页面上实现了它。它工作得很好（滚动条出现在 android 上）但滑动标签现在被破坏了（http://www.maggies-bayfield.com/wp/temp/old/jscroll_breaks_slider.htm）。

任何人有任何想法或解决方案？非常感激！

再次：没有jscrollpane的滑动标签：http: [//www.maggies-bayfield.com/wp/temp/old/slider_no_jscroll.htm](http://www.maggies-bayfield.com/wp/temp/old/slider_no_jscroll.htm)

带有 jscrollpage 的滑动标签：http: [//www.maggies-bayfield.com/wp/temp/old/jscroll_breaks_slider.htm](http://www.maggies-bayfield.com/wp/temp/old/jscroll_breaks_slider.htm)

谢谢！八月

# solr - Solr CSV 导入具有非标准日期格式的字段

> ID：10645608
> 
> 赞同：2
> 
> 时间：2012-05-18T01:28:02.417
> 
> 标签：solr, lucene, dataimporthandler

我正在尝试导入几个 .csv 文件，其中包含一些日期格式为“yyyyMMdd”的字段。我很快发现 DataImportHandler 并不容易支持 csv 文件。在 DataImportHandler 中，可以使用 LineEntityProcessor，然后使用 RegexTransformer，但这很麻烦。我尝试的下一个方法是将文件发布到 CSVRequestHandler，但我还没有找到一种方法来指定使用什么 SimpleDateFormat 来解析该字段。我一直在寻找解决这个问题的方法，但我认为我注定要进行预处理步骤，或者使用 RegexTransformer。任何帮助将不胜感激。

编辑：我应该补充一点，我在 Solr 3.5 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T09:09:54.690

或者。留在 solr 内。在字符串字段中对其进行索引。并使用 UpdateProcessor 将其复制到正确格式的日期字段中。很容易

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T03:41:43.713

你看过[DateFormatTransformer](http://wiki.apache.org/solr/DataImportHandler#DateFormatTransformer)吗？

# cygwin - 用于 Windows 进程的 Cygwin 转储程序？

> ID：10645610
> 
> 赞同：1
> 
> 时间：2012-05-18T01:28:10.180
> 
> 标签：cygwin, coredump, procdump

Cygwin 包含一个程序`dumper.exe`

> dumper 实用程序可用于创建正在运行的 Windows 进程的核心转储。

```
Usage: dumper [OPTION] FILENAME WIN32PID

Dump core from WIN32PID to FILENAME.core 
```

然而，它似乎只适用于 Cygwin 进程

```
$ ps -Ws | grep calc
   3880 ?        20:22:02 C:\Windows\System32\calc.exe

$ dumper calc-dump 3880
Cannot attach to process #3880, error 50 
```

我已经使用[**ProcDump**](http://technet.microsoft.com/en-us/sysinternals/dd996900)有一段时间了，但我想改用 Cygwin 包中包含的程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T01:39:09.133

事实证明，这`dumper.exe` **将**适用于 Windows 进程，但仅适用于**32 位进程**。

```
$ C:/Windows/SysWOW64/calc.exe &
[1] 3660

$ dumper calc 3660 &
[2] 3500

$ ls -l
total 18688
-rw-r--r--+ 1 Steven None 19071028 Jun  7 20:38 calc.core 
```

# javascript - 为 Node.js REST API 转义特殊字符的正确方法是什么？

> ID：10645613
> 
> 赞同：0
> 
> 时间：2012-05-18T01:29:11.247
> 
> 标签：javascript, node.js

例如，如果我按如下方式发出 GET 请求

```
http://mydomain.com/username/James B. Smith 
```

只有“James B”被返回到服务器。我猜其余的被视为文件扩展名。我试过 encodeURI 和 encodeURIComponent 但它们没有正确编码'.'。

# algorithm - 什么是用于试验简单解释器的简单垃圾收集算法？

> ID：10645616
> 
> 赞同：6
> 
> 时间：2012-05-18T01:29:22.257
> 
> 标签：algorithm, garbage-collection, interpreter

我一直在尝试编程语言设计，并且已经到了需要实现垃圾收集系统的地步。现在首先想到的是引用计数，但这不会处理引用循环。我在搜索算法时遇到的大多数页面都是关于在现有语言（例如 Java）中调整垃圾收集器的参考资料。当我确实找到描述特定算法的任何内容时，我没有获得足够的实施细节。例如，大多数描述包括“当您的程序内存不足时...”，这在具有大量交换空间的 4 GB 系统上不太可能很快发生。所以我正在寻找一些具有良好实现细节的教程，例如如何调整何时启动垃圾收集器（即，

为了提供更多关于我正在尝试做的事情的详细信息，我开始编写一个类似于 Postscript 的基于堆栈的解释器，我的下一次尝试可能是基于其中一种 Lisp 方言的 S 表达式语言. 我在直接 C 中实施。我的目标既是自学，又是把各个阶段记录为“如何设计和编写解释器”教程。

至于我到目前为止所做的事情，我已经编写了一个简单的解释器，它实现了一种 C 风格的命令式语言，它被堆栈机器风格的 VM 解析和处理（参见 lang2e.sourceforge.net）。但是这种语言在进入任何函数时不会分配新的内存，也没有任何指针数据类型，所以当时真的不需要任何类型的高级内存管理。对于我的下一个项目，我正在考虑从非指针类型对象（整数、字符串等）的引用计数开始，然后在单独的内存池中跟踪任何指针类型对象（可以生成循环引用） . 然后，每当池比上一个垃圾回收周期结束时增长超过 X 个分配单元时，再次启动收集器。

我的要求是它不能太低效，而且易于实施和清楚地记录（请记住，我想将其发展成论文或书籍供其他人遵循）。我目前在前面得到的算法是三色标记，但看起来世代收集器会更好一些，但更难记录和理解。所以我正在寻找一些清晰的参考材料（最好是在线提供），其中包含足够的实现细节来帮助我入门。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T06:01:42.127

There's a great book about garbage collection. It's called *Garbage Collection: Algorithms for Automatic Dynamic Memory Management*, and it's excellent. I've read it, so I'm not recommending this just because you can find it with Google. Look at it [here](https://rads.stackoverflow.com/amzn/click/com/0471941484).

For simple prototyping, use mark-and-sweep or any simple non-generational, non-incremental compacting collector. Incremental collectors are good only if you need to provide for "real-time" response from your system. As long as your system is allowed to lag arbitrarily much at any particular point in time, you don't need an incremental one. Generational collectors reduce average garbage collection overhead with the expense of assuming something about the life cycles of objects.

我已经实现了所有（分代/非分代，增量/非增量）并且调试垃圾收集器非常困难。因为你想专注于你的语言设计，而不是调试一个更复杂的垃圾收集器，你可以坚持一个简单的。我很可能会去标记和扫描。

使用垃圾收集时，不需要引用计数。把它扔掉。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:39:51.777

何时启动分配器可能是完全开放的——您可以在内存分配失败时进行 GC，或者您可以在每次删除引用时进行 GC，或者在中间的任何地方进行 GC。

等到你别无选择可能意味着你永远不会 GC，如果运行的代码被很好地包含的话。或者，它可能会在您的环境中引入巨大的暂停，并完全破坏您的响应时间或动画或声音播放。

对每一个运行完整的 GC`free()`可以在更多操作中分摊成本，尽管整个系统可能会因此运行得更慢。你可能更容易预测，但总体上更慢。

如果你想通过人为地限制内存来测试这个东西，你可以简单地在非常严格的资源限制下运行。运行`ulimit -v 1024`，由该 shell 生成的每个进程将只有 1 兆字节的内存可供使用。

# php - PHP 表单向 MySQL 数据库提交重复条目

> ID：10645618
> 
> 赞同：0
> 
> 时间：2012-05-18T01:30:00.270
> 
> 标签：php, mysql, forms

我有一个数据库，其中包含通过 3 种不同形式写入的数据。好消息是表单确实会写入数据库。坏消息是，每次我点击其中一个表单上的提交按钮时，都会与第一个表单一起创建一个重复的条目。

这些表格在[http://digitaldemo.net/kickass/test.php](http://digitaldemo.net/kickass/test.php)在线。它没有连接到实时数据库，但我想把它放到网上，这样你就可以看到代码。

这是将表单数据写入数据库的 add_player.php 代码：

```
<?php

// contact to database
$connect = mysql_connect("localhost", "dariia", "celtic03") or die ("Error , check your server connection.");
mysql_select_db("football");

// Set up form variables //

//Get data in local variable
$Player=$_POST['Player'];
$Position=$_POST['Position'];
$Team=$_POST['Team'];

// check for null values
$query="INSERT INTO ff_projections(Player, Position, Team) VALUES('$Player','$Position','$Team')";
mysql_query($query)  or die(mysql_error());
echo "1 record has been entered.";

mysql_query($query) or die('Error, query failed');

?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T01:33:50.713

你执行了两次查询！！

```
mysql_query($query)  or die(mysql_error());

mysql_query($query) or die('Error, query failed'); 
```

# asp.net-mvc-3 - Azure/SSL 用于在生产中暂存终止角色

> ID：10645620
> 
> 赞同：0
> 
> 时间：2012-05-18T01:30:06.663
> 
> 标签：asp.net-mvc-3, ssl, azure

我生成了一个自签名证书，导出并上传到订阅。当我部署到登台时，当我导航到应用程序 (MVC) 时一切正常，它适当地重定向到 https，我收到警告，但当我继续访问该站点时一切正常。当我将相同的包部署到生产环境时，我的任何角色都没有响应 Web 请求或 tcp，我什至无法 RDP 进入 VM。

有任何想法吗？

编辑：我要说这是关闭的。我给了它一个小时（看电视让我头脑清醒）..它开始正常运行。也许只是花了很长时间来启动虚拟机。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T05:20:50.133

角色开始需要比预期更长的时间，如果您有兴趣了解我在以下 SO 问题中解释的原因：

[有没有办法减少 Azure 部署开始和调用角色 OnStart() 代码之间的时间？](https://stackoverflow.com/questions/10546624/is-there-a-way-to-reduce-time-between-azure-deployment-start-and-role-onstart/10555557#10555557)

想知道更多让我知道，我很想解释得更详细。

# iphone - 为什么“分配”全局变量应该是自动释放

> ID：10645621
> 
> 赞同：0
> 
> 时间：2012-05-18T01:30:09.103
> 
> 标签：iphone, objective-c, ipad, memory-management

一个简单的内存管理问题如下：

```
-(void)viewDidLoad
{
    ......
    self.label = [[[UILabel alloc] initWithFrame:labelFrame] autorelease];
    ......
} 
```

我认为label是一个全局变量，根据管理协议，如果你用“alloc”创建一个实例，你应该只是“dealloc”它，为什么要在这里“autorelease”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T02:08:32.737

> 我认为标签是一个全局变量......

不，`label`是包含您发布的代码的类的属性，如`self.label`语法所示。它由一个实例变量支持，无论是否显式声明。属性的设置器`label`负责确保传入的值被适当地保留。分配 UILabel 的代码`-viewDidLoad`负责释放它，调用会执行此`autorelease`操作。

> ...根据管理协议，如果您使用“alloc”创建一个实例，您应该只是“dealloc”它...

这是不正确的。您永远不会`-dealloc`直接调用 - 总是调用`-release`或`-autorelease`在使用完您创建的对象时调用。有关详细信息，请参阅[内存管理规则](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:36:33.510

```
self.label = [[[UILabel alloc] initWithFrame:labelFrame] autorelease]; 
```

相对

```
UILabel *temp = [[UILabel alloc] initWithFrame:labelFrame];
self.label = temp;
[temp release]; 
```

就正确的内存管理而言，它们本质上是相同的。内存将被正确清理，只是在不同的时间。

我会假设该标签的属性类似于`@property(nonatomic,retain)`因此标签继续存在，因为它在您调用时由属性保留`self.label`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T03:22:48.850

Self.label 是一个属性。

UILabel *tempLabel = [[UILabel alloc] initWithFrame:labelFrame] -> 保留计数为 1

self.label = tempLabel -> 现在保留计数为 2

但是你只使用 self.label，所以如果你不使用 autorelease 或释放你创建的标签，你会遇到内存泄漏问题；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T01:48:54.727

autorelease 正在将您的变量推送到池列表中以供将来发布：

```
NSAutoreleasePool* pool = [[NSAutoreleasePool alloc] init];
// your code
self.label = [[[UILabel alloc] initWithFrame:labelFrame] autorelease];
// your code
[pool release]; 
```

然后你不需要打电话

```
[self.label release]; 
```

因为变量是自动释放的。在代码行中

```
[pool release]; 
```

将成功发布。

这是用于漏水踢脚线

# javascript - 如何通过选择链接更改视频源 - HTML

> ID：10645623
> 
> 赞同：0
> 
> 时间：2012-05-18T01:30:31.420
> 
> 标签：javascript, html, dynamic

我正在尝试通过选择链接来更改视频的来源。因此，当在页面上选择链接时，它将视频开销更改为另一个视频的来源，有点像播放列表。这是我的 html 的代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/    DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Videos</title>
<link rel="stylesheet" href="VideosPage.css">

<script src="jquery-1.7.2.min.js" type="text/javascript"> </script>
<script type="text/javascript">

</script>

<video id="first_video" width="800" height="450" controls="controls" style="margin-left:380px;  padding:10px; border:1px solid black;">

<source src="video.mp4" type="video.mp4" />

</video>

 <br />

  <a> Other Video  </a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:38:48.580

查看 HTML 标准： http: [//www.whatwg.org/specs/web-apps/current-work/#video](http://www.whatwg.org/specs/web-apps/current-work/#video)。

您可以使用几种解决方案。一个是按顺序加载下一个视频，如播放列表：

```
<script type="text/javascript">
var nextVideo = "path/of/next/video.mp4";
var videoPlayer = document.getElementById('video');
videoPlayer.onend = function(){
    videoPlayer.src = nextVideo;
}
</script>
<video id="videoPlayer" src="path/of/current/video.mp4" autoplay autobuffer controls /> 
```

然后，创建一个链接来更改它就像（例如）一样简单：

```
$("a.change_link").click(function(){
    videoPlayer.src = nextVideo;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:43:20.167

为了实现您的要求，如果您将视频路径粘贴在链接的 alt 中，然后您可以引用它并使用一些简单的 jquery 将其粘贴到视频 onclick 的 src 中。

*   [jsfiddle](http://jsfiddle.net/mgwJ6/1/)

**修改后的html：**

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Videos</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<link rel="stylesheet" href="VideosPage.css">
<script src="jquery-1.7.2.min.js" type="text/javascript"> </script>
<script type="text/javascript">

</script>
<video id="first_video" width="800" height="450" controls="controls" style="margin-left:380px;  padding:10px; border:1px solid black;">
<source src="video.mp4" type="video/mp3" />
</video>
 <br />
 <a alt="video2.mp4" id="other"> Other Video </a>​ 
```

**一些jQuery：**

```
$('#other').click( function() { 
$('#first_video').children('source').attr('src',$(this).attr('alt'))
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T01:41:06.090

在行中`<source src="video.mp4" type="video.mp4" />`type="video.mp4" 是错误的，你不能在这里放置这种类型的值

这是类型的一些示例：video/mp3、video/ogg、video/wbem。

# asp.net - 在页面之间导航时防止闪烁的方法

> ID：10645624
> 
> 赞同：2
> 
> 时间：2012-05-18T01:30:39.290
> 
> 标签：asp.net, ajax, master-pages, flicker

我必须说我在最后 3 个小时的搜索中筋疲力尽。我知道这个问题之前已经调查过，我尝试了几种解决方案都无济于事。

我有一个带有母版页的 asp.net 网站，其中包含用于在不同页面之间导航的顶部导航菜单。当我在这些页面之间导航时，我想防止闪烁。我只是说明一下，这种闪烁发生在 IE 和 Chrome 中，而它不会发生在 Firefox 中。

我尝试过的方法：

*   使用几种元标记解决方案，例如：`<meta http-equiv="Page-Exit" content="Alpha(opacity=100)" />`

*   使用更新面板将内容占位符包装在母版页中

*   仅在更新面板中包装导航菜单。

这些方法都不起作用，我真的不认为使用 iframe 对我的情况来说是一个好的解决方案。

还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T13:05:51.110

问题似乎是我在 head 部分有很多 javascript 文件，所以当我将它移到底部时，就在结束 body 标记之前，闪烁大大减轻了。这个解决方案可以在[这个](https://stackoverflow.com/questions/3722611/page-load-white-flash-inbetween-pages)关于堆栈溢出的问题中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:43:47.193

这被称为 FOUC（无样式内容的闪存），可能是由 @import CSS 语句引起的。在某些情况下，它是特定于浏览器的，并且这些天不经常发生：

[https://en.wikipedia.org/wiki/Flash_of_unstyled_content](https://en.wikipedia.org/wiki/Flash_of_unstyled_content)

有时可以通过简单地确保首先加载 CSS 来解决此问题：

[https://www.techrepublic.com/blog/web-designer/how-to-prevent-flash-of-unstyled-content-on-your-websites/](https://www.techrepublic.com/blog/web-designer/how-to-prevent-flash-of-unstyled-content-on-your-websites/)

# php - 将非数字键值附加到数组

> ID：10645629
> 
> 赞同：0
> 
> 时间：2012-05-18T01:32:07.880
> 
> 标签：php

尝试在我的 DAO 中将数据库结果集作为数组返回：

`$retval`我想在下面的代码中将字符串键值附加到数组中。但是，数组在每次迭代时都会被覆盖，而不是被附加到。

所以在循环结束时，我最终得到 1 个键值而不是 n 对（从数据库中检索到 n 行）。我究竟做错了什么？

```
$retval = array();
while ($row = mysql_fetch_assoc($result)) {

    foreach($columns as $var) {
        $retval[$var]=$row[$var];
    }

}
var_dump($retval); 
```

`$retval`最终`["name"=>"Japan","capital"=>"Tokyo"]`不是预期的`["name"=>"Korea","capital"=>"Seoul"...."Japan"=>"Tokyo"]`列是名称和大写。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T01:37:56.897

我必须看看你的专栏是什么，但不应该是：

```
$retval = array();
while ($row = mysql_fetch_assoc($result)) {

  $retval[ $row['country'] ] = $row['capital'];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:35:20.860

这是因为您正在覆盖相同的值（此处为列名。）类似于：

```
$retval['a'] = 1;
$retval['a'] = 2;
// ... 
```

而是使用：

```
$retval[] = $row[$var]; 
```

HTH。

# svn - Bash 命令 - 目录删除

> ID：10645638
> 
> 赞同：0
> 
> 时间：2012-05-18T01:33:42.840
> 
> 标签：svn, jenkins, directory, hudson

我有一个非常奇怪的问题。在我使用 Hudson 部署的一个盒子上，工作副本文件夹（基本上是一个 SVN 结账）每晚都会不断被删除。不是一个大问题；大多是奇怪和烦人的。因此，每天早上，我都必须执行完整的结帐而不是更新/切换。据我所知，这不是 Hudson 的配置问题，我检查了每个 crontab 文件以确认不是这样。

在 Linux 中，是否有一个 bash 脚本或一些命令行魔法来监视一个文件夹，保存有关它何时被删除以及谁删除它的历史记录？这样，我可以缩小执行实际删除的范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:48:38.517

我遇到了类似的事情——我所做的是双重的。首先，我打开了完整的系统记帐——它记录了哪些进程被执行以及何时执行。您可以通过查看父目录的最后一次修改时间来缩小“时间”。

但我认为会计日志显示的细节不够多（进程参数、父进程等——这是在 Solaris 上，您可能会在 Linux 上获得更多日志记录选项）。所以我最终做的是重命名“rm”，并在记录输入参数、调用它的进程以及谁拥有调用进程之后，编写一个名为“rm”的 shell 脚本来调用真实的脚本。

如果一个进程正在调用 unlink 系统调用而不是 rm，那么您可能不得不求助于获取 C 库的源代码并将类似的日志记录功能添加到 unlink 调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T02:11:44.913

我不确定这个问题应该被标记为“bash”。许多事情可能会删除这个文件夹，而 bash 不包含任何自己的代码来实际删除内容。

跟踪正在发生的事情的一种选择是使其无法删除目录，然后查看 Hudson（或其他地方）中的某些内容是否抱怨错误。您可以在父文件夹或其中的任何文件上设置“不可变”标志，删除将失败。

在 BSD (FreeBSD/NetBSD/etc) 中，使用：

```
sudo chflags schg /path/to/directory_or_file 
```

在 Linux 中，使用：

```
sudo chattr +i /path/to/directory_or_file 
```

现在，确保你实际上*得到了*（而不是过滤或传递空值）你所有的 root 和 cron 消息，在 Hudson 中调高调试级别（如果有的话，我不知道），然后观察看看会发生什么.

请注意，如果您将不可变标志（或 schg）添加到文件夹，则不会保护子文件夹的内容。它只会使您无法删除该目录，或者向其中添加或删除文件。

```
[ghoti@pc ~]$ mkdir zzz zzz/foo
[ghoti@pc ~]$ touch zzz/bar
[ghoti@pc ~]$ sudo chflags schg zzz
[ghoti@pc ~]$ touch zzz/baz
touch: zzz/baz: Operation not permitted
[ghoti@pc ~]$ touch zzz/foo/baz
[ghoti@pc ~]$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T18:16:09.107

您可能会[遇到 JENKINS-8880](https://issues.jenkins-ci.org/browse/JENKINS-8880)，其中节点的**workspace/**目录中的自定义工作区每晚都会被删除。修复方法是升级到 1.427（或更高版本），或者将自定义工作区放在工作**区/**目录之外。

# c++ - 未定义的引用和分段错误

> ID：10645639
> 
> 赞同：0
> 
> 时间：2012-05-18T01:33:46.240
> 
> 标签：c++, g++, segmentation-fault, undefined-reference

好的，我正在编写一个程序，它使用几个不同的类，包括链接排序列表和二叉搜索树/节点类。当我在 Visual Studio 中编译时，它运行起来完全没有任何问题，100% 流畅，并且我已经在那里对其进行了完全调试，没有出现任何错误。但是，当我将它放入 Unix 中时，我必须打开它，然后用 g++ 对其进行测试，一切都变得糟糕透顶。如果我尝试访问的不仅仅是二叉树的根，我会得到一个“分段错误”。

当我使用命令“g++ main.cpp”时，我看到几十个对其他类的成员函数的“未定义引用”。现在，我确实拥有所有必要的#include 语句，以及使用“#ifndef/#define/#endif”语句。唯一给我带来问题的两个类是 Employee 和 SearchTreeNode 类。以下是这两个以及主要的：

```
 #include "LinkedSortedList.h"
    #include "LinkedNode.h"
    #include "Employee.h"
    #include "SearchTreeNode.h"
    #include <string>
    #include <ostream>
    #include <iostream>
    #include <fstream>

    using namespace std;

    int main() {

LinkedSortedList<Employee> mylist;  //create the LSL
SearchTree mytree;                  //create the BST

int searchCount = 0; //occasionally used to count recursive calls to function
bool _continue = true;
char command;

do{

    cout << "\nEnter your command: \n" << endl;
    cout << "(I)nsert\n(F)ind Employee from ID\n(D)elete Employee from ID\n(L)ast Name Search\n(S)ave to file\n(R)ead from file\n(Q)uit" << endl;

    cin >> command;

    if(command == 'I' || command == 'i'){
        //insert
        Employee* newEmployee = new Employee();
        newEmployee->create();
        mylist.insert(*newEmployee);
        mytree.insert(newEmployee);
        cout << "Employee Added\n----------\n" << endl;
        newEmployee->print();
        cout << "\n----------\n" << endl;
    }
    else if(command == 'L' || command == 'l'){
        //arbitrary pointer to undefined matches to be used in fetchAllMatches()
        LinkedSortedList<Employee>* matches;
        string name;
        cout << "Last Name to Search for: " << endl;
        cin >> name;
        Employee* search = new Employee();
        search->setLastName(name);

        int matchCount = mylist.fetchAllMatches(*search, matches, matchCount);
        cout << mylist.size() << " Records Searched.\n"<< matchCount << " Matches Found:" << endl;
        //Make sure that there is something to print to avoid errors
        if(matchCount > 0)
            matches->print();

    }
    else if(command == 'D' || command == 'd'){
        int IDnumber;
        cout << "Enter Employee ID to delete: " << endl;
        cin >> IDnumber;

        if(mytree.getRoot() != NULL) { // make sure there is a tree to search through
            Employee *x = mytree.find(IDnumber, searchCount, mytree.getRoot());

            if(x->getAddress() != "null"){
                mylist.remove(*x);
                mytree.remove(x->getId());
                cout << "\n" << x << "\n---------\n" << "File Deleted" << endl;
            }

        } else {
            cout << "Tree is empty" << endl;
        }
    }
    else if(command == 'F' || command == 'f'){
        int IDnumber;
        cout << "Enter Employee ID to find: " << endl;
        cin >> IDnumber;
        searchCount = 0;
        if(mytree.getRoot() != NULL) { // make sure there is a tree to search through
            Employee* x = mytree.find(IDnumber, searchCount, mytree.getRoot());

            if(x->getAddress() != "null"){
                    cout << "\n" << *x << "\n" << endl;
            } else {
                cout << "Employee not found!" << endl;
            }

        } else {
            cout << "Tree is empty" << endl;
        }
    }
    else if(command == 'S' || command == 's'){
        string file;
        cout << "Write Database to File Name: " << endl;
        cin >> file;
        mylist.printToFile(file, mylist);
    }
    else if(command == 'T' || command == 't'){
        mytree.print(mytree.getRoot());
    }
    else if(command == 'R' || command == 'r'){
        //read
        if(mylist.size() > 0) {
            mylist.clear();
            mytree.clearTree(mytree);
        }
        string line;
        string file;
        int intLine;
        cout << "File Name: " << endl;
        cin >> file;
        ifstream myfile(file.c_str());
        if (myfile.is_open())
        {
            getline (myfile,line);
            if(line != "<Records>"){
                cout << "Not a database file." << endl;
            }
            //make sure it's still ok
            while ( myfile.good() )
            {

                getline(myfile, line);
                if(line != "<END>"){

                    Employee* newEmployee = new Employee();

                    for(int i = 0; i < 10; i++){
                        switch (i){

                        case 0:

                            newEmployee->setLastName(line);
                            break;
                        case 1:
                            getline(myfile, line);
                            newEmployee->setFirstName(line);
                            break;
                        case 2:
                            myfile >> intLine;
                            newEmployee->setId(intLine);
                            break;
                        case 3:
                            myfile >> intLine;
                            myfile.get();
                            newEmployee->setSalary(intLine);
                            break;
                        case 4:
                            getline(myfile, line);
                            newEmployee->setDept(line);
                            break;
                        case 5:
                            getline(myfile, line);
                            newEmployee->setPhone(line);
                            break;
                        case 6:
                            getline(myfile, line);
                            newEmployee->setAddress(line);
                            break;
                        case 7:
                            getline(myfile, line);
                            newEmployee->setHireDate(line);
                            break;
                        case 8:
                            getline(myfile, line);
                            newEmployee->setEmail(line);
                            break;
                        case 9:
                            getline(myfile, line);//eat the dashes
                            break;
                        }

                    }
                    mylist.insert(*newEmployee);
                    mytree.insert(newEmployee);
                }
                else {
                    myfile.close();
                }
            }

        }
        else cout << "Unable to open file";     
    }
    else if(command == 'Q' || command == 'q'){
        return 0;
    }
    else if(command == 'P' || command == 'p'){
        mylist.print();
    }
}
while(_continue);

return 0;
}

    #include <iostream>
    using namespace std;

    #ifndef _EmployeeClass_
    #define _EmployeeClass_

    class Employee {

    public:

Employee(){
    firstName;
    lastName;
    department;
    email;
    dateHired;
    phoneNumber;
    homeAddress;
    employeeID = 0;
    salary = 0;

    //this->create();
}

Employee(string last, string first, int ID, int _salary, string dept, string phone, 
    string address, string hireDate, string _email){

        lastName = last;
        firstName = first;
        employeeID = ID;
        salary = _salary;
        department = dept;
        phoneNumber = phone;
        homeAddress = address;
        dateHired = hireDate;
        email = _email;

        employeeCount++;
}

void create();
//list of getter functions to return private variables, preventing direct access.
int getId();
int getSalary();
string getFirstName();
string getLastName();
string getDept();
string getHireDate();
string getEmail();
string getAddress();
string getPhone();

friend bool operator!= (Employee &x, Employee &y);
friend bool operator== (Employee &x, Employee &y);  
friend bool operator<= (Employee &x, Employee &y);
friend bool operator>= (Employee &x, Employee &y);
friend bool operator< (Employee &x, Employee &y);
friend bool operator> (Employee &x, Employee &y);

friend ostream& operator<<(ostream& output, Employee& x);
void print();

//list of setter functions to set values for the private variables, without allowing direct access.
void setPhone(string phone);
void setId(int ID);
void setSalary(int salary);
void setFirstName(string name);
void setLastName(string surname);
void setDept(string dept);
void setHireDate(string hireDate);
void setEmail(string email);
void setAddress(string address);

    private:

//private member variables dependant on input for each individual object
string firstName;
string lastName;
string department;
string email;
string dateHired;
string homeAddress;
string phoneNumber;
int employeeID;
int salary;

int employeeCount;

    };

    #endif 
```

这是员工类：

```
 #include <iostream>
    #include "Employee.h"

    #ifndef _SearchTreeNodeClass_
    #define _SearchTreeNodeClass_

    //this class makes a binary search tree of "search tree nodes" which contain 3                         pointers:
    //left: points to left child (value always less than node)
    //right: points to right child (value always greater than node)
    //data: points to an Employee object in memory.
    using namespace std;

    class SearchTreeNode
    {
    private:
SearchTreeNode( Employee* D,SearchTreeNode* L = NULL, SearchTreeNode* R = NULL )    // constructor
{ 
    data = D;
    left = L;  
    right = R; 
};
int         count;
Employee*   data;                           // node data
SearchTreeNode* left;                       // pointer to the left subSearchTree
SearchTreeNode* right;                      // pointer to the right subSearchTree

friend class SearchTree;                // give SearchTree complete access
    };
    #endif

    #ifndef _SearchTreeClass_
    #define _SearchTreeClass_

    using namespace std;

    class SearchTree
    {        
    public:
SearchTree();                           
virtual ~SearchTree();                  
SearchTree( const SearchTree& );        
SearchTree& operator=( SearchTree& );   
SearchTreeNode* getRoot();
SearchTreeNode* find(int, SearchTreeNode*);
Employee* find(int, int, SearchTreeNode* ); 
void insert( Employee* );               
void print();   
void destroy( SearchTreeNode* );        
void print( SearchTreeNode* );
void clearTree( SearchTree& );
void inorder( SearchTreeNode* );
void remove( int x );
    private:
SearchTreeNode* root;                       // pointer to the root of the search SearchTree                     
SearchTreeNode* copy( SearchTreeNode* );
void insert( SearchTreeNode*& root, Employee* );

    };
    #endif 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T03:00:16.407

您遇到的问题有很多可能的原因。想到的一个是当你在 Visual Studio 中编译时，你已经设置了包含路径——搜索头文件的路径。也有可能你没有在 Visual Studio 中设置，而是在你创建项目并从各个目录向项目中添加文件时，VS 默默地为你设置了它。

使用 g++，您必须自己提供包含目录。（如果您在 Linux 下使用了类似于 Visual Studio 的 IDE，那么这些包含目录将为您设置。因此，问题不在于 Windows 和 Linux 之间的区别，而在于在执行许多操作的 IDE 中进行开发在幕后并使用命令行进行编译。）

查看 g++ 的手册页。查看用于添加包含目录的 -I 选项和在链接期间用于库搜索的 -l 选项。（您很可能需要 -I 选项。）

鉴于您在 Windows 上取得了成功，我怀疑您的源代码有问题。唯一的另一种可能性是您使用了一个特定于 Visual Studio 的库函数，该函数在 g++ 中不存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T13:06:36.570

*每当您尝试读取或写入无效的内存地址时，就会出现*分段错误错误。*这可能有很多原因 - 请[**在此处**](http://en.wikipedia.org/wiki/Segmentation_fault#Common_causes)查看一些示例。*

 **当您无法链接所需的库和/或目标文件时，会发生*未定义的引用错误。*从简单的使用中`g++ main.cpp`，您既没有指定其他源文件，也没有指定任何链接所需的库。*

 *就像上面@Ray 说的那样，直接在命令行上编译时，您必须自己提供包含和链接目录，这就是我们通常有一个 Makefile 的原因。使用正确制作的 Makefile 比直接调用编译器要好，因为*make*检查哪些源文件发生了变化，调用编译器只重建所需的文件而不是所有文件（当你的项目很大时，这会产生很大的不同！）。

如果您对 Makefile 没有太多经验，我建议您使用[**CMake**](http://www.cmake.org/cmake/project/about.html)。它是一个为您制作 makefile 的构建系统。好在它甚至是多平台的，因此使用相同的*CMakeLists.txt*文件，您可以为 Windows 或 Linux 生成 makefile，而且语法非常简单。

如果您告诉我您拥有的所有源文件以及您可能使用的最终库，我可以为您提供一个准确的*CMakeLists.txt*示例，该示例应该为您编译所有内容，但它可以像以下那样简单（根据您的包含，我假设您的源文件是*main.cpp*、*LinkedSortedList.cpp*、*LinkedNode.cpp*、*Employee.cpp*和*SearchTreeNode.cpp*）：

```
cmake_minimum_required (VERSION 2.6)

project (employee_manager CXX)

set (SOURCES
  main.cpp
  LinkedSortedList.cpp
  LinkedNode.cpp
  Employee.cpp
  SearchTreeNode.cpp
  )

add_executable (employee_manager ${SOURCES}) 
```

您应该在源代码目录中创建此文件。要将编译输出与源代码分开，您可以创建一个构建目录，在那里运行 CMake，并参考父目录中的*CMakeLists.txt*文件，它将为您构建 Makefile。从那里，您只需要调用常规*make*来构建您的程序：

```
mkdir build
cd build
cmake ..
make 
```

这将为您提供可执行文件**employee_manager**到**构建**目录中。**

# javascript - Jasmine 固定装置和 jQuery .on()

> ID：10645641
> 
> 赞同：2
> 
> 时间：2012-05-18T01:34:00.697
> 
> 标签：javascript, jquery, coffeescript, jasmine, jasmine-jquery

我的 jasmine 套件和 jQuery 的新事件注册方法 .on() 的使用有问题。

这是我的夹具的简化版本：

```
<div id='rent_payment_schedule_container'>
  <select class="select optional" id="frequency_select" name="payment_schedule[frequency]">
    <option value="0">Monthly</option>
    <option value="1">Weekly</option>
    <option value="2">Bi-Weekly</option>
  </select>

  <div class="control-group select optional start-day-select" id="monthly_select"></div>

  <div class="control-group select optional start-day-select" id="weekly_select" style="display: none;"></div>
</div> 
```

这是咖啡脚本（在使用它的实际页面上工作得很好）：

```
$ ->
  $('#rent_payment_schedule_container').on 'change', '#frequency_select', (event) ->
    $('.start-day-select').hide()

    switch $(event.target).val()
      when '0'
        $('#monthly_select').show()
      when '1'
        $('#weekly_select').show()
      when '2'
        $('#weekly_select').show() 
```

这是规格：

```
describe 'The UI components on the payment schedule creation page', ->
  beforeEach ->
    loadFixtures 'payment_schedule'

  describe 'The toggling of the monthly and weekly day select options', ->

    it 'shows the weekly select div and hides the monthly select div when the weekly option is selected from the #frequency_select select box', ->
      $('#frequency_select option[value=1]').attr('selected', 'selected')
      $('#frequency_select').change()
      expect($("#weekly_select")).toBeVisible()

    it 'shows the weekly select div and hides the monthly select div when the bi-weekly option is selected from the #frequency_select select box', ->
      $('#frequency_select option[value=2]').attr('selected', 'selected')
      $('#frequency_select').change()
      expect($("#weekly_select")).toBeVisible()

    it 'shows the monthly select div and hides the weekly select div when the monthly option is selected from the #frequency_select select box', ->
      $('#frequency_select option[value=1]').attr('selected', 'selected')
      $('#frequency_select').change()
      $('#frequency_select option[value=0]').attr('selected', 'selected')
      $('#frequency_select').change()
      expect($("#monthly_select")).toBeVisible() 
```

而且每次都惨败。

但是，如果我不用`$('#rent_payment_schedule_container')`作 的接收器`.on()`，而是使用`$(document)`，那么整个事情就很好了。

```
$ ->
  $(document).on 'change', '#frequency_select', (event) ->
    $('.start-day-select').hide()

    switch $(event.target).val()
      when '0'
        $('#monthly_select').show()
      when '1'
        $('#weekly_select').show()
      when '2'
        $('#weekly_select').show() 
```

所以，我最好的猜测是，这与 jasmine 加载夹具然后运行测试的方式的顺序或速度有关，但我不能确定。谁能指出我正确的方向，为什么会发生这种情况以及如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T20:57:40.850

我的猜测是您将脚本与规范运行程序一起加载。当你的 DOM 准备好时，你的脚本就会执行。不过，此时夹具尚未加载。结果，`$('#rent_payment_schedule_container')`将不选择任何元素，您可能可以自己验证。

无论如何，您应该能够通过将脚本包装在可以在测试中调用的函数中来解决这个问题。

# adsl - 如何通过 ADSL 路由器/调制解调器发送短信

> ID：10645645
> 
> 赞同：0
> 
> 时间：2012-05-18T01:34:48.930
> 
> 标签：adsl

我只想知道如何通过ADSL调制解调器/路由器发送短信？？刚上网问了一些朋友。但没有得到答案......！请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:40:36.930

这是不可能的，因为您需要能够与蜂窝网络通信。您的 ADSL 调制解调器无法与此类网络进行通信。

最好的办法是使用诸如[clickatell](http://www.clickatell.com/)之类的 SMS 网关。有很多类似的服务，所以你需要做一些研究。

另一种选择是购买 GSM 网关并将其连接到您的服务器。[Hybertone](http://www.hybertone.com/en/)和各种公司出售这些。问题是您需要向移动服务提供商订阅 SIM 卡才能发送短信。接口也复杂得多，因为您需要一种与设备对话的方式。

在我看来，你最好的选择是注册一个 SMS 网关，因为收费会更便宜，传输也更可靠。实现也将更加简单，因为它们将提供 API 或某种 Web 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T01:42:34.740

某些网络允许您使用电子邮件转 SMS，但这取决于国家和网络。这方面的一个例子是[here](http://www.tech-recipes.com/rx/939/sms_email_cingular_nextel_sprint_tmobile_verizon_virgin/)

# c# - TCP 连接到 Azure 失败

> ID：10645656
> 
> 赞同：1
> 
> 时间：2012-05-18T01:37:05.817
> 
> 标签：c#, .net, tcp, azure

我最近在暂存环境中部署了一个 Azure 应用程序，该应用程序应该在端口 2993 中接受 TCP 数据包。在 Azure 模拟器中运行时，它可以很好地执行此操作，并且完全按照应有的方式执行。

但是，现在它在 Azure 的登台服务器上，每当我尝试连接到 TCP 端口时，我都会收到以下 SocketException：

> 连接尝试失败，因为连接方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应。

我的 Web 应用程序有两个实例，一个是工作角色（在其端点中配置了 2993）和一个 Web 角色（仅用于端口 80）。顺便说一句，端口 80 运行良好。Web 应用程序是使用 C# 中的 Visual Studio 创建的。为什么会发生这种情况，我该如何解决？

非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T03:15:47.730

看来问题与程序对服务器 IP 地址的检测有关。通过使用以下服务器代码，我设法解决了这个问题：

```
RoleInstanceEndpoint externalEndPoint = RoleEnvironment.CurrentRoleInstance.InstanceEndpoints["TCPin"];
        IPEndPoint localEndPoint = new IPEndPoint(externalEndPoint.IPEndpoint.Address, externalEndPoint.IPEndpoint.Port); 
```

然后可以将 IPEndpoint 与 tcpListener 套接字一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T05:43:27.130

我想解释一下问题是什么，以及为什么添加上面的代码可以解决这个问题，让其他人受益。

在您的工作角色中，您可以配置任何 TCP 端点以及任何端口号。当此 VM 启动时，VM 被配置为使用此端口，并且防火墙包含一个例外以提供对此端口的访问。当您准备好启动 Azure VM 时，您已经拥有 TCP/IP 地址并启用了配置的端口。

现在，当您的角色开始时，如果您有任何服务或应用程序需要访问此端口，您真的需要

例如，如果我在我的工作角色中配置了 Tomcat/Java，我必须在我配置的端口上创建一个 TCP 侦听器。这可以在我的工人角色开始时完成，如下所示：

1.  获取当前角色实例的IP地址和端口号
2.  创建一个 TCP 侦听器并在此 IP 地址和端口上启动
3.  在我的辅助角色 OnStart() 函数中添加代码以执行步骤 1) 和 2)。

代码如下所示：

```
TcpListener TomcatPortListener = new  TcpListener(RoleEnvironment.CurrentRoleInstance.InstanceEndpoints["TomcatWeb80"].IPEndpoint);
TomcatPortListener.Start(); 
```

在您的情况下，您所做的完全相同，您从中获得了 IP 地址和端口号，然后使用 IP/端口从套接字地址创建了一个端点：

```
RoleInstanceEndpoint externalEndPoint = RoleEnvironment.CurrentRoleInstance.InstanceEndpoints["TCPin"];
IPEndPoint localEndPoint = new IPEndPoint(externalEndPoint.IPEndpoint.Address, externalEndPoint.IPEndpoint.Port);
localEndPoint.Create(); 
```

对于创建 TCP 端点的任何 Web 或工作角色来说，这是必须设置的。

# java - Java/Android：ArrayIndexOutofBoundsException

> ID：10645657
> 
> 赞同：0
> 
> 时间：2012-05-18T01:37:12.870
> 
> 标签：java, android, arrays, sqlite

我有一个充满计算的表。每行包含基于个人债务的数字。例如：

第 1 行：Debt 1（名称）、7.9（APR）、1000（余额）、20（MinPayment）；

第 2 行：Debt 2（名称）、9.9（APR）、2000（余额）、40（MinPayment）；

ETC..

本次测试共有 6 行。我正在用几个数组做几个循环，我得到了上面的错误（在标题中）。

> 05-17 18:31:47.548: E/AndroidRuntime(2019): 由: java.lang.ArrayIndexOutOfBoundsException: length=6; 索引=6

哪个是奇怪的，因为长度是 6？

这是整个方法：

```
 public int payoffDebt(Double totalDebt) {
    Cursor c = database.rawQuery("SELECT *  FROM debt;", null);
    int monthTotal = 0; 
    double interestFee = 0;
    double interestFeeTotal = 0;

    String indBal[] = new String[c.getCount()];
    String indPay[] = new String[c.getCount()];
    String indApr[]  = new String[c.getCount()];
    double totalBal[]  = new double[c.getCount()];
    double totalInterestFees[]  = new double[c.getCount()];
    int rowCounter[] = new int[c.getCount()];

    int j = 0; int k = 0;   
    for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) {
        // get individual Bal, APR percent, Payment, store into three arrays;
        indBal[k++]  = c.getString(c.getColumnIndex("debt_total"));
        indPay[k++] = c.getString(c.getColumnIndex("payment"));
        indApr[k++] = c.getString(c.getColumnIndex("apr"));
        rowCounter[k++] = k;
    }
    c.close();

    while (totalDebt >= 0) {

        for (int i : rowCounter) {
            interestFee = (((Double.valueOf(indApr[i]) / 100) / 12) * Double
                    .valueOf(indBal[i]));
            totalDebt = totalDebt
                    - (Double.valueOf(indPay[i]) - interestFee);
            interestFeeTotal += interestFee; // sum of all Apr Fees CURRENT
                                                // month in while loop
        }

        totalBal[j++] = totalDebt; // record total debt for this after all
                                    // payments
        totalInterestFees[j++] = interestFeeTotal; // record total interest
                                                    // fees for this month
                                                      // from all debt

        // Increment month
        monthTotal += 1;

    }
    return monthTotal; 
```

问题是第 165 行：

```
indApr[k++] = c.getString(c.getColumnIndex("apr")); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T01:40:00.580

Java 数组从 0 开始，而不是 1。这意味着使用 访问数组的第一个元素，使用 访问`array[0]`第二个元素，依此类推`array[1]`。因此，要访问数组的最后一个元素，使用`array[array.length - 1]`. 使用`array[array.length]`是一个超出范围的索引，因此是例外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:41:00.327

其他人已经讨论过如何解决您的数组索引问题，但可能根本原因是您有五个单独的数组必须保持不同步。如果您创建了一个新类来保存五项数据：

```
public class Data{
    String indBal;
    String indPay;
    String indApr;
    double totalBal;
    double totalInterestFees;
} 
```

并且有一个数据数组，那么你的循环索引应该更容易跟踪。

# ruby - 在Ruby中，哈希中标识符后的冒号是什么意思？

> ID：10645668
> 
> 赞同：19
> 
> 时间：2012-05-18T01:38:34.790
> 
> 标签：ruby, syntax, hash

我正在学习工厂女孩，我看到了这段代码：

```
factory :post do
  association :author, factory: :user, last_name: "Writely"
end 
```

为什么在他们`factory`的`last_name`末尾有一个冒号？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-18T01:41:58.360

此上下文中的冒号表示文字哈希。

`factory`是`Hash`关键，`:user`是价值。

替代语法是`:factory => :user`. 他们的意思是一样的。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-18T01:54:07.507

Ruby 1.8 语法：

```
:factory => :user 
```

Ruby 1.9 语法：

```
factory: :user 
```

请注意，Ruby 1.8 语法也适用于 1.9。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-20T15:57:31.740

其他答案都是对的。关于这种新语法背后的基本原理有一些猜测。这种变化可能与 Javascript 以及其他语言如何处理对象字面量表示法有关。或许，需要让 ruby​​ 更符合这些语言处理对象创建的方式。

例如，在 JavaScript 中，我们可以这样做：

```
var person = {
    name: "John",
    age: 42,
    married: false
} 
```

所以说真的，当我们通过时`factory: :user`，我们真正在做的是通过`{factory: :user}`，也写成`{:factory => :user}`。1.9 语法旨在使执行以下操作变得更容易`{factory: "user"}`

# grails - gsp 中的 grailsApplication.controllerClasses 过滤器

> ID：10645672
> 
> 赞同：0
> 
> 时间：2012-05-18T01:38:44.473
> 
> 标签：grails, gsp, grails-2.0, grails-controller

我在stackoverflow中搜索`grailsApplication.controllerClasses`过滤器，然后我遵循正确的答案。

我写这样的代码。

```
 <g:each var="c" in="${grailsApplication.controllerClasses.each{GrailsClassUtils.isClassBelowPackage(it.clazz, ['com.posplus.product']) }.sort{ it.fullName } }">
      <li>
        <g:link controller="${c.logicalPropertyName}" action="list" data-pjax='#main'>
                   <g:message code="${c.logicalPropertyName}.label" default="${c.logicalPropertyName}"/>
        </g:link>
      </li>
 </g:each> 
```

它导致错误堆栈

```
 org.codehaus.groovy.grails.web.pages.exceptions.GroovyPagesException: Error applying layout : bootstrap
    java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    java.lang.Thread.run(Thread.java:680)
root cause

org.codehaus.groovy.grails.web.pages.exceptions.GroovyPagesException: Error processing GroovyPageView: Error executing tag <g:include>: Unable to execute include: Request processing failed; nested exception is org.codehaus.groovy.grails.web.pages.exceptions.GroovyPagesException: Error evaluating expression [grailsApplication.controllerClasses.each{GrailsClassUtils.isClassBelowPackage(it.clazz, ['com.posplus.product']) }.sort{ it.fullName }] on line [13]: null
    java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    java.lang.Thread.run(Thread.java:680)
root cause

org.codehaus.groovy.grails.web.taglib.exceptions.GrailsTagException: Error executing tag <g:include>: Unable to execute include: Request processing failed; nested exception is org.codehaus.groovy.grails.web.pages.exceptions.GroovyPagesException: Error evaluating expression [grailsApplication.controllerClasses.each{GrailsClassUtils.isClassBelowPackage(it.clazz, ['com.posplus.product']) }.sort{ it.fullName }] on line [13]: null
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_layouts_bootstrap_gsp$_run_closure2.doCall(bootstrap.gsp:13)
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_layouts_bootstrap_gsp.run(bootstrap.gsp:21)
    java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    java.lang.Thread.run(Thread.java:680)
root cause

org.codehaus.groovy.grails.web.servlet.mvc.exceptions.ControllerExecutionException: Unable to execute include: Request processing failed; nested exception is org.codehaus.groovy.grails.web.pages.exceptions.GroovyPagesException: Error evaluating expression [grailsApplication.controllerClasses.each{GrailsClassUtils.isClassBelowPackage(it.clazz, ['com.posplus.product']) }.sort{ it.fullName }] on line [13]: null
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_layouts_bootstrap_gsp$_run_closure2.doCall(bootstrap.gsp:13)
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_layouts_bootstrap_gsp.run(bootstrap.gsp:21)
    java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    java.lang.Thread.run(Thread.java:680)
root cause

org.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.codehaus.groovy.grails.web.pages.exceptions.GroovyPagesException: Error evaluating expression [grailsApplication.controllerClasses.each{GrailsClassUtils.isClassBelowPackage(it.clazz, ['com.posplus.product']) }.sort{ it.fullName }] on line [13]: null
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_layouts_bootstrap_gsp$_run_closure2.doCall(bootstrap.gsp:13)
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_layouts_bootstrap_gsp.run(bootstrap.gsp:21)
    java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    java.lang.Thread.run(Thread.java:680)
root cause

org.codehaus.groovy.grails.web.pages.exceptions.GroovyPagesException: Error evaluating expression [grailsApplication.controllerClasses.each{GrailsClassUtils.isClassBelowPackage(it.clazz, ['com.posplus.product']) }.sort{ it.fullName }] on line [13]: null
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_includes_subnav_gsp.run(subnav.gsp:13)
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_layouts_bootstrap_gsp$_run_closure2.doCall(bootstrap.gsp:13)
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_layouts_bootstrap_gsp.run(bootstrap.gsp:21)
    java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    java.lang.Thread.run(Thread.java:680)
root cause

java.lang.NullPointerException
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_includes_subnav_gsp$_run_closure3_closure8.doCall(subnav.gsp:13)
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_includes_subnav_gsp$_run_closure3.doCall(subnav.gsp:13)
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_includes_subnav_gsp.run(subnav.gsp:13)
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_layouts_bootstrap_gsp$_run_closure2.doCall(bootstrap.gsp:13)
    Users_wenhaoliu_Documents_workspace_posplus_grails_app_views_layouts_bootstrap_gsp.run(bootstrap.gsp:21)
    java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    java.lang.Thread.run(Thread.java:680) 
```

但是如果我将代码更改为

```
<g:each var="c" in="${grailsApplication.controllerClasses.each{GrailsClassUtils.isClassBelowPackage(it.class, ['com.posplus.product']) }.sort{ it.fullName } }">
       <li>
            <g:link controller="${c.logicalPropertyName}" action="list" data-pjax='#main'>
                  <g:message code="${c.logicalPropertyName}.label" default="${c.logicalPropertyName}"/>
            </g:link>
      </li>
</g:each> 
```

它列出了所有控制器。这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T05:44:51.093

我处理那个。因为`GrailsClassUtils.isClassBelowPackage`不能处理非包类。我写了一个函数来解决这个问题。

```
public static boolean isClassBelowPackage(Class<?> theClass, List<?> packageList) {
    if(theClass.package==null)return false
    String classPackage = theClass.package.name;
    for (Object packageName : packageList) {
        if (packageName != null) {
            if (classPackage.startsWith(packageName.toString())) {
                return true;
            }
        }
    }
    return false;
} 
```

在 gsp 中是：

```
<g:each var="c" in="${grailsApplication.controllerClasses.findAll{MyGrailsClassUtils.isClassBelowPackage(it.clazz, ['com.posplus.product']) }.sort{ it.fullName } }">
      <li>
        <g:link controller="${c.logicalPropertyName}" action="list" data-pjax='#main'>
                   <g:message code="${c.logicalPropertyName}.label" default="${c.logicalPropertyName}"/>
        </g:link>
      </li>
 </g:each> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-22T14:33:49.163

虽然我确信你的答案工作得很好，但我不明白你为什么不使用原来的`GrailsClassUtils`. 您需要做的就是导入它们。

这就是我所做的，它工作得非常完美。

*我无意使用答案进行回复，但由于缺乏声誉，我不得不这样做。*

# ios - 创建 UIManagedDocument 和初始 iCloud 同步

> ID：10645675
> 
> 赞同：1
> 
> 时间：2012-05-18T01:38:52.713
> 
> 标签：ios, core-data, ios5, icloud, uimanageddocument

我正在将 iCloud 同步添加到我的应用程序中。我的`UIManagedDocument`商店在沙箱中，它的更改日志在 iCloud 中（由 指定`NSPersistentStoreUbiquitousContentURLKey`）。**问题是，当我在第二**台设备上第一次安装和运行该应用程序时，初始同步需要几分钟时间（以提取第一台设备创建的更新）。这是一个真正的问题，因为同步显然发生在`UIManagedDocument:saveToURL:completionHandler`. 所以完成处理程序块需要很长时间才能被调用，如果我访问我的`UIManagedDocument`之前`UIManagedDocument:saveToURL`返回，我可以理解的是崩溃。

我想**快速**打开数据库，**然后**在后台进行同步。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-03T16:12:35.733

是的，第二台设备上的初始同步可能需要 90 秒或更长时间 (iOS 7)。我有一个创建 UIManagedDocument 实例的 iOS 7 应用程序的工作开源示例。请参阅：[https](https://github.com/DonBriggs/MultiDocumentPlusUUID) ://github.com/DonBriggs/MultiDocumentPlusUUID 。首先，查看在两台设备上运行的应用程序的屏幕截图。如果屏幕截图解决了您的问题，您可以自己尝试该应用程序并查看代码。我渴望得到反馈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T05:54:08.313

您提到“数据库”并用 CoreData 标记了这个问题。但是，您指的是 UIManagedDocument，它的同步方式与 CoreData 数据库不同。如果您的数据库是 CoreData，您将使用新的 NSManagedObjectContext 并发 API 对其进行初始化。看一眼：

```
[[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType]; 
```

我已经成功地使用它来异步同步 CoreData 数据库，但我不确定它如何适用于 UIManagedDocuments。

# php - 在页面右上角显示数据

> ID：10645677
> 
> 赞同：-1
> 
> 时间：2012-05-18T01:39:16.427
> 
> 标签：php, html, css

我有一个这样的 php 网站：

```
.---------------------.
|title          stats |
|                     |
|generate&display data|
|                     |
| show table of data  |
|                     |
| php generate stats  |
|_____________________| 
```

页面底部的 php 分析表中生成的数据，所有统计变量都在页面底部创建。

我想创建一个数据的快速摘要，例如“x 发生了多少次”等，并将其放在页面的右上角（统计信息），但是在底部生成表格*后*，该数据是已知的页。

在不重复代码的情况下，如何检索这些尚未生成的变量并将它们放置在页面的右上角？或者使用 CSS 或 HTML，我可以使框浮动或类似于页面的右上角吗？

解决这个问题的最佳方法是什么？

编辑：我不是在问如何生成统计信息，我已经在页面底部这样做了，但想在页面顶部显示它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:48:34.627

你在这里问两个不同的问题。

1.

`Using only HTML/CSS, I want to create a quick summary of the data like "how many times x occurred [...] but that data is known after the table is generated at the bottom of the page.`

为什么你只想用 CSS 做这个？一些简单的 jQuery JS (ex `$("element.class").size()`) 会告诉你`element.class`页面上的数量。但是，您对要显示什么样的“统计数据”*非常模糊。*或者，为什么要在前端做呢？使用 PHP，只需获取`count()`您正在计算的统计数据的数组元素的数量。

2.

`with CSS or HTML, can I make a box float or similar to the top right of the page?`

```
div.box{
    position:absolute;top:25px;right:25px;padding:10px;
} 
```

再一次，你对你想在这里做什么非常模糊。假设您希望统计信息在用户查看数据时保持在页面顶部，此代码将使其保持在距顶部和右侧 25px 的位置。

# 编辑：

使用我展示的 CSS 代码，然后使用 stats 制作底部的 div `display:none;`。然后，只需使用：

```
$("div.box").html($("div.stats").html()); 
```

# android - 在 sdcard android 中保存图像覆盖

> ID：10645690
> 
> 赞同：0
> 
> 时间：2012-05-18T01:40:46.050
> 
> 标签：android, image, sd-card, save, overwrite

我正在使用以下代码保存图像

```
 FrameLayout mainLayout = (FrameLayout) findViewById(R.id.frame);
            //  File root = Environment.getExternalStorageDirectory();
            //  File file = new File(root, "androidlife.jpg");
//              File file = new File(Environment.getExternalStorageDirectory()
//                        + File.separator + "/test.jpg");
                Random fCount = new Random();
                // for (int i = 0; i < 10; i++) { Comment by Lucifer
                  int roll = fCount.nextInt(600) + 1;
                  //System.out.println(roll);

                File file = new File(Environment.getExternalStorageDirectory()
                        + File.separator + "/test" + String.valueOf(roll) +".jpg" );

                Bitmap b = Bitmap.createBitmap(mainLayout.getWidth(),
                        mainLayout.getHeight(), Bitmap.Config.ARGB_8888);
                Canvas c = new Canvas(b);
                mainLayout.draw(c);
                FileOutputStream fos = null;
                try {
                    fos = new FileOutputStream(file);

                    if (fos != null) {
                        b.compress(Bitmap.CompressFormat.JPEG, 90, fos);
                        fos.close();
                    }
                } catch (Exception e) {
                    e.printStackTrace();
                }

            //  }  Comment by Lucifer 
```

它完美地保存了图像，但是当我按两次保存按钮时会覆盖...可能是什么问题？有什么建议吗？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T02:34:11.803

```
File file = new File(Environment.getExternalStorageDirectory()
                        + File.separator + "/test.jpg");
if(!file.exists()){
    try {
      file.createNewFile();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}else{
    file.delete();
    try {
        file.createNewFile();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}
Bitmap b = Bitmap.createBitmap(mainLayout.getWidth(),
mainLayout.getHeight(), Bitmap.Config.ARGB_8888);
Canvas c = new Canvas(b);
mainLayout.draw(c);
FileOutputStream fos = null;
try {
    fos = new FileOutputStream(file);
    if (fos != null) {
        b.compress(Bitmap.CompressFormat.JPEG, 90, fos);
        fos.close();
    }
} catch (Exception e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T02:43:29.823

您已经给出了一个静态文件名。

```
File file = new File(Environment.getExternalStorageDirectory()
                        + File.separator + "/test.jpg"); 
```

因此，每次它都会在同一位置创建一个名称为 test.jpg 的图像。您需要实现的唯一逻辑是将文件名更改为动态文件名。你可以这样试试

静态 int fCount = 0;

```
File file = new File(Environment.getExternalStorageDirectory()
                        + File.separator + "/test" + String.valueOf(fCount++) +".jpg" ); 
```

现在，上面的行将每次创建一个新文件，以名称 test0.jpg、test1.jpg ... 等开头。

但是，当您关闭应用程序并重新启动应用程序时，这可能会产生问题。因为它将从 0 计数器重新开始。

所以我建议你用随机数连接文件名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-06T10:11:29.640

sticker_view.setLocked(true);

```
 sticker_view.setDrawingCacheEnabled(true);
        Bitmap bitmap = sticker_view.getDrawingCache();
        Log.e("BITMAP", "onOptionsItemSelected: " + bitmap);

        String root = Environment.getExternalStorageDirectory().toString();
        File newDir = new File(root + "/Edited Image");
        newDir.mkdirs();

        Random gen = new Random();
        int n = 10000;
        n = gen.nextInt(n);
        String photoName = "Image-" + n + ".jpg";
        Log.e("PHOTONAME", "onOptionsItemSelected: " + photoName);

        File file = new File(newDir, photoName);
        String filePath = file.getAbsolutePath();
        Log.e("FILEPATH", "onOptionsItemSelected: " + filePath);

        if (!file.exists()) {
            try {
                file.createNewFile();
            } catch (IOException e) {
                e.printStackTrace();
            }
            Toast.makeText(EditActivity.this, "Image Already Exist.", Toast.LENGTH_SHORT).show();
        } else {
            file.delete();
            try {
                file.createNewFile();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        try {
            FileOutputStream out = new FileOutputStream(file);
            Log.e("OUT", "onOptionsItemSelected: " + out);
            bitmap.compress(Bitmap.CompressFormat.JPEG, 100, out);
            out.flush();
            out.close();
            bitmap.recycle();

            Toast.makeText(EditActivity.this, "Saved In Edited Image.", Toast.LENGTH_SHORT).show();
            item.setVisible(false);

            MediaScannerConnection.scanFile(EditActivity.this, new String[]{file.getAbsolutePath()},
                    null, new MediaScannerConnection.OnScanCompletedListener() {
                        public void onScanCompleted(String path, Uri uri) {
                            Log.i("ExternalStorage", "Scanned " + path + ":");
                            Log.i("ExternalStorage", "-> uri=" + uri);
                        }
                    });

            Intent intent = new Intent();
            intent.setAction("URI");
            intent.putExtra("uri", filePath);
            sendBroadcast(intent);
            finish();

        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-14T10:15:20.237

您只需添加`System.currentTimeMillis()`文件名即可获得完整的唯一文件名。这会将自纪元以来的当前时间（以毫秒为单位）添加到您的文件名中，除非您可以在一毫秒内创建多个文件，否则不会进行覆盖。

# jquery - JQuery - “文本框中的光标”的事件是什么？

> ID：10645693
> 
> 赞同：1
> 
> 时间：2012-05-18T01:41:06.040
> 
> 标签：jquery, if-statement, focus

我正在尝试做一些类似于 Twitter 用于他们的注册页面的事情：

[https://twitter.com/signup](https://twitter.com/signup)

我以前见过它，将光标放在文本框/输入字段中会更改它旁边的文本。这个活动叫什么？所以我可以在我的代码中使用“如果'教科书中的光标'那么......”。是“焦点”事件吗？或者是其他东西？因为我似乎无法让它工作。

并更进一步。我可以使用 Jquery 识别在文本框中输入的字符并将其定义为事件吗？即密码字段需要8个字母和至少一个数字和一个特殊字符。我可以使用 Jquery 来识别字段中的这些字符并生成适当的响应吗？如果不是，那么最好的方法是什么？

任何和所有的帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:47:08.743

这不是 NiftyDude 建议的悬停事件，它实际上是一个焦点事件。将鼠标悬停在该字段上不会在注册页面上执行任何操作，将光标放在该字段中，也就是聚焦到对象会导致文本出现。

[http://jsfiddle.net/Q87LE/](http://jsfiddle.net/Q87LE/)有一个很好的例子。

# python - 类如何在同一个文件中工作，但如果将它们分开然后正确导入，则会出现错误？

> ID：10645695
> 
> 赞同：7
> 
> 时间：2012-05-18T01:41:44.410
> 
> 标签：python

我是编程新手，我做了一个小程序来学习如何使用 python，我做了这个。

如果我将它放在一个文件中，它就可以正常工作，但是当我将它分成三个文件时，分别称为 Atlas.py、Robot.py 和 Test.py。

**我在初始化**行的机器人类中收到一个错误：“未定义的变量：Atlas” 。

我已经在上面的评论中评论了它所在的文件。

```
#Atlas.py
class Atlas:

def __init__(self):
    self.robots = []
    self.currently_occupied = {}

def add_robot(self, robot):
    self.robots.append(robot)
    self.currently_occupied = {robot:[]}

#Robot.py
class Robot():

def __init__(self, rbt, atlas = Atlas): #This is the main error:"Undefined Variable: Atlas" This happens after i separate the file
    self.xpos = 0
    self.ypos = 0
    self.atlas = atlas()
    self.atlas.add_robot(rbt)
    self.name = rbt

def walk(self, axis, steps=2):
    ....

#Test.py
robot1 = Robot("robot1") 
```

我将这些类放入相应的文件中，Test.py 现在看起来像这样：

```
#Test.py
import Robot
robot1 = Robot("robot1") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T01:47:15.610

在 Robot.py 中，您的第一行应该是（假设文件名为 Atlas.py）：

```
from Atlas import Atlas 
```

意思是“从 Atlas.py 文件（也称为 Atlas 模块）导入 Atlas 类”，因此 Atlas 变量在 Robot.py 文件（也称为 Robot 模块）中可用。

IOW，如果您需要另一个文件中的 Robot 类（并且它仍然存在于 Robot.py 的 Robot 模块中），您需要将“from Robot import Robot”添加到该新文件中。

我建议你尽可能多地阅读[Python 教程](http://docs.python.org/tutorial/)。否则，您当前的问题更直接与[modules](http://docs.python.org/tutorial/modules.html)相关，因此请阅读该部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T02:20:53.513

Python 在这方面很酷，因为理解会引导您了解为什么 Python 会随着您的学习而变得更简单。

**Python 只是在命名空间字典中从上到下执行脚本。**

在第一个示例中，您的代码如下所示：

```
a 10 line class statement adds Atlas to the default namespace
a 12 line class statement adds Robot to the default namespace
robot1 = Robot("robot1") 
```

最后一行真的被重写为函数调用：

```
robot1 = default_namespace.Robot.init("robot1") 
# plus a bit of magic to create an instance and grab the return value. 
```

这是因为 Robot 类是它自己的 Class 类型的命名空间。

当您分离文件并点击以下代码时：

```
import Robot 
```

它的意思是：

```
if we haven't already imported the module Robot:
    find the file named Robot.py
    execute it, line by line, and keep the kept_namespace
    default_namespace.Robot = kept_namespace 
```

所以，在我们的主线测试中：

```
>>> print type(Robot), dir(Robot)
<type 'module'>, [..., 'Robot']
>>> print type(Robot.Robot), dir(Robot.Robot)
<type 'classobj'>, [..., '__init__', 'walk']
>>> robot1 = Robot.Robot("robot1") 
```

为了让它更简单或更容易混淆，默认的命名空间、模块和类都是 dict 对象，带有一点打字魔法来减少编码错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T01:44:16.523

使用`import`，您正在将不同的命名空间导入到当前正在运行的脚本命名空间中。

以身份访问类`Robot.Robot("robot 1")`或使用`import robots as robots`.

# security - XOR加解密密钥

> ID：10645705
> 
> 赞同：2
> 
> 时间：2012-05-18T01:43:07.397
> 
> 标签：security, encoding, xor

是否可以使用 xor 获取用于加密字符序列的密钥？

# 例子

假设我有以下字符串：1456，所以：

*   1 - 49 ascii - 00110001 二进制
*   4 - 52 ascii - 00110100 二进制
*   5 - 53 ascii - 00110101 二进制
*   6 - 54 ascii - 00110110 二进制

钥匙：100

然后我执行以下操作：1 ^ 100（以二进制表示：00110001 ^ 01100100），并得到以下结果：“UPQR”，我怎么知道我使用 xor 中的密钥 100 加密“1456”得到“UPQR”作为结果。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T01:46:25.867

如果您知道原始序列和编码序列，那么对于每个组件，它必须是

```
original[i] ^ encoded[i] == key 
```

如果您不知道原始内容，那么您将不得不尝试使用每个可能的键，看看结果是否有意义（对于一些意义的定义）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:52:31.713

注意 Wikipedia 关于[XOR cipher的评论](http://en.wikipedia.org/wiki/XOR_cipher)

> 就其本身而言，使用恒定的重复密钥，一个简单的 XOR 密码可以通过[频率分析](http://en.wikipedia.org/wiki/Frequency_analysis)轻松破解。

尽管如果密钥是消息的大小（并且是随机的，并且只使用一次），那么您就有一个[一次性的 pad](http://en.wikipedia.org/wiki/One-time_pad)。那是牢不可破的，期间。虽然它对大多数人来说太麻烦了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T01:52:17.733

如果您处于密码破解的位置，那么您绝对应该查看[Sinkov 的基本](https://rads.stackoverflow.com/amzn/click/com/0883856220)密码分析和[盖恩斯的密码分析：密码及其解决方案的研究](https://rads.stackoverflow.com/amzn/click/com/0486200973)。这两本书都深入探讨了[Vigenère Cipher](http://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher)的密钥恢复，这与 XOR 操作的顺序应用非常相似。

# javascript - $.each 范围内的 Javascript AJAX 范围

> ID：10645706
> 
> 赞同：0
> 
> 时间：2012-05-18T01:43:12.577
> 
> 标签：javascript, ajax, jquery

所以我试图遍历一些元素并根据 ajax 调用的结果更改一些文本。问题是我无法从 ajax 回调中获取数据，而且我不确定如何将事件链接起来。我得到了一个股票报价值，如果我可以将该对象返回到先前的范围、匹配循环，然后在那里进行所有操作，那就太好了。

```
$(function(){
          var tweets = $('.tweet');
          var symbol_pat = /(^|\s\$)([a-z]+\b)/gi;
          $.each(tweets, function(){
            var tweet_html = $(this).html();
            tweet_html = tweet_html.replace(symbol_pat,function(){
               var symbol = arguments[2];
               var YAHOO_API_URL = 'http://query.yahooapis.com/v1/public/yql'
               var format = 'json'
               var query = 'select * from yahoo.finance.quotes where symbol in ("'+symbol+'")';
               var env = "store://datatables.org/alltableswithkeys";

               $.ajax({
                    'url':YAHOO_API_URL,
                    'async':false,
                    'method':'GET',
                    'data': {
                        'format':format,
                        'q':query,
                        'env':env
                    },
                    success: function(data){
                        var quote = data.query.results.quote;
                        var change = quote.Change;
                        var change_pct = quote.ChangeinPercent;
                        var quote_price = quote.LastTradePriceOnly;
                        var html_str = "";

                        if( change.indexOf("+") != -1 ){
                            html_str = '<span class="symWrap up">'+arguments[0]+'</span>';
                        }else{
                            html_str = '<span class="symWrap down">'+arguments[0]+'</span>';
                        }

                        tweet_html = arguments[0].replace(html_str);
                        $(this).html(tweet_html);
                    }
               });

            });
          });

        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T01:54:14.480

`$.ajax()`异步运行，因此您不能真正“等待”前一个范围内的成功。不过，您可以使用 jQuery promise 和 Deferred 来执行此操作。查看[http://www.erichynds.com/jquery/using-deferreds-in-jquery/](http://www.erichynds.com/jquery/using-deferreds-in-jquery/)和[http://joseoncode.com/2011/09/26/a-walkthrough-jquery-deferred-and-promise/](http://joseoncode.com/2011/09/26/a-walkthrough-jquery-deferred-and-promise/)

**编辑**：显示不需要承诺或延迟的替代解决方案：

```
$(function(){
  var tweets = $('.tweet');
  var symbol_pat = /(^|\s\$)([a-z]+\b)/gi;
  $.each(tweets, function(){
       var that = this;

       var symbol = arguments[2];
       var YAHOO_API_URL = 'http://query.yahooapis.com/v1/public/yql'
       var format = 'json'
       var query = 'select * from yahoo.finance.quotes where symbol in ("'+symbol+'")';
       var env = "store://datatables.org/alltableswithkeys";

       $.ajax({
        'url':YAHOO_API_URL,
        'async':false,
        'method':'GET',
        'data': {
        'format':format,
        'q':query,
        'env':env
        },
        success: function(data){
        var quote = data.query.results.quote;
        var change = quote.Change;
        var change_pct = quote.ChangeinPercent;
        var quote_price = quote.LastTradePriceOnly;
        var html_str = "";

        if( change.indexOf("+") != -1 ){
            html_str = '<span class="symWrap up">'+arguments[0]+'</span>';
        }else{
            html_str = '<span class="symWrap down">'+arguments[0]+'</span>';
        }

            var tweet_html = $(that).html();
                var tweet_html = arguments[0].replace(html_str);
            tweet_html = tweet_html.replace(symbol_pat,html_str);
        $(that).html(tweet_html);
        }
       });

    });
  });

}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-18T02:18:26.667

只要您的`replace`代码是正确的，我相信您的代码的以下返工应该可以工作（或者至少让您非常接近，因为这未经测试并且取决于您的代码的其余部分）：

```
$(function(){

    var YAHOO_API_URL = 'http://query.yahooapis.com/v1/public/yql'

    var tweets = $('.tweet');
    var symbol_pat = /(^|\s\$)([a-z]+\b)/gi;
    $.each(tweets, function(){
        var tweet_html = $(this).html();
        tweet_html = tweet_html.replace(symbol_pat, function(){
            var symbol = arguments[2];
            var format = 'json'
            var query = 'select * from yahoo.finance.quotes where symbol in ("'+symbol+'")';
            var env = "store://datatables.org/alltableswithkeys";
            var quoteHtml = getQuote(format, query, env, function(quote) {
                var change = quote.Change;
                var change_pct = quote.ChangeinPercent;
                var quote_price = quote.LastTradePriceOnly;
                var html_str = "";

                if( change.indexOf("+") != -1 ){
                    html_str = '<span class="symWrap up">'+arguments[0]+'</span>';
                }
                else{
                    html_str = '<span class="symWrap down">'+arguments[0]+'</span>';
                }
                return arguments[0].replace(html_str);
            });
            return quoteHtml;
        });
        $(this).html(tweet_html);
    });

    var getQuote = function(format, query, env, successCallback) {
       $.ajax({
            'url':YAHOO_API_URL,
            'async':false,
            'method':'GET',
            'data': {
                'format': format,
                'q': query,
                'env': env
            },
            success: function(data){
                var quote = data.query.results.quote;
                if(successCallback !== undefined && typeof successCallback == 'function') {
                    successCallback(quote);
                }
            }
       });
    };
}); 
```

# html - 尝试将文本与图像对齐

> ID：10645707
> 
> 赞同：0
> 
> 时间：2012-05-18T01:43:13.963
> 
> 标签：html, css, twitter-bootstrap, ruby-on-rails-3.2

我有一个使用 iWeb 开发的网站，您可以在其中拖动任何对象并制作非常好的网站。但是，它不适用于需要数据库的网站。因此，我正在使用 Ruby on Rails 3.2.3、CSS3、Bootstrap 2.0 等重写网站。

这是我正在重写的网站的链接。 [http://www.iktusnetlive.com/Home.html](http://www.iktusnetlive.com/Home.html)

我正在尝试复制带有黄色 LIVE 的蓝色相机在标题中的部分。我想将文本排列到相机镜头所在的位置。图形为 60X55。我已经尝试了几个小时使用 line-height、padding-top 和其他 CSS 选项，但我无法让文本向下移动。

这是我的 HTML 代码，其中包含我想与相机镜头对齐的图形和文本：

```
<p class="align-center"><span id="camera-text"><span id="text-bold"><%= image_tag("live_transparent.png", alt: "iktusNETlive") %>&nbsp;&nbsp;To view FREE LIVE STREAMING VIDEO, you will need to create a FREE ACCOUNT and be logged in.</span></span></p> 
```

这是我的 CSS 代码：

```
#camera-text {font-size: 15px; vertical-align: middle; color: @red;}

.align-center { text-align: center; }

#text-bold { font-weight: bold; } 
```

我想知道这是否是我能够做到的。如您所见，我有一个渐变作为我的页面背景。我不知道这是否可以使用 Bootstrap、CSS3 或 HTML5。我会在当天创建一个表格并使用单元格填充和其他显然在 HTML5 中不再可用的选项。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:51:10.020

您通常可以像这样在 CSS 中居中块级项目：

```
.some-class {
    display: block; /* needed if you'd like to center an inline element */
    margin: 0 auto;
} 
```

将左右边距设置为自动就可以了。

尝试[绝对定位](http://reference.sitepoint.com/css/absolutepositioning)当您需要非常具体时：

如果你正在构建一个基本的网站，Ruby on Rails 和 Twitter Bootstrap 是多余的，只会使事情复杂化。当你掌握它的窍门时，你可以试试 WordPress。

# android - 如何在 Android 的 EditTextPreference 中更改标题的字体大小？

> ID：10645712
> 
> 赞同：-2
> 
> 时间：2012-05-18T01:43:55.403
> 
> 标签：android, android-preferences

我想减小`EditTextPreference`. 有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:29:14.227

尝试这个，

```
<EditText 
    android:text="EditText" 
    android:layout_width="fill_parent" 
    android:layout_height="20dp" 
    android:background="#FFFFFF"
    android:style="@android:style/TextAppearance.Small"
/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-02T05:37:18.527

我是从[这里开始的](https://stackoverflow.com/questions/18787499/increasing-checkboxpreference-title-and-summary-text-size-and-glowing-of-an-pref)

偏好屏幕：

```
<PreferenceCategory
android:key="prefcategory1"
android:title="GENERAL SETTINGS..." >

<CheckBoxPreference
    android:defaultValue="false"
    android:enabled="true"
    android:key="checkBoxdelete"
    android:layout="@layout/mylayout"     <!--linking it to mylayout.xml -->
    android:summary="Deletes old messages as limits are reached"
    android:title="Delete old messages" />
</PreferenceCategory> 
```

和**mylayout.xml**

```
<TextView android:id="@+android:id/title"
android:layout_width="wrap_content" 
android:layout_height="wrap_content" 
android:paddingLeft="8dp"
android:textColor="#FFFFFF"
android:textSize="30px"
android:textStyle="bold"/>  

<TextView android:id="@+android:id/summary"
android:layout_width="wrap_content" 
android:layout_height="wrap_content" 
android:paddingLeft="8dp"
android:textColor="#FFFFFF"
android:textSize="20px"
android:textStyle="bold"/> 
```

通过使用此文本，您可以增加或减少字体大小

# c++ - 为什么我的 C++ 类变量会在范围外意外更改？

> ID：10645715
> 
> 赞同：0
> 
> 时间：2012-05-18T01:44:24.277
> 
> 标签：c++

我正在尝试逆向工程并修复引发未处理异常的 Win32 控制台应用程序。

我有 32 个在线程中运行的类实例。这些“服务”线程应该每个都定期创建/删除一个唯一的 CMessage 实例，并且这些 CMessage 对象中的每一个都在 Service 类中声明为私有的。

当我在调试器中运行应用程序时（我使用的是 Visual Studio 2005），CMessage 的监视窗口指示就在调用 CMessage 成员函数之前，CMessage 的地址更改为 0x00000000 - 异常的原因。

没有直接的解释可以解释为什么会发生这种情况。前一行代码和这一行之间似乎没有发生任何不愉快的事情，所以我怀疑在某些情况下，每个线程都错误地从其他线程之一引用了 CMessage 对象（如在线程生命周期中的某个时刻 CMessage该线程的对象被删除）。

我的问题是：确保这些 CMessage 对象绝对是线程安全的并且不能从任何地方修改/删除，除了当前类范围的最佳方法是什么？我认为这就是 private 的用途，但我现在不完全确定。我想做的一件事是引用 CMessage 对象，如下所示：

```
this->myCMessage; 
```

而不仅仅是：

```
myCMessage; 
```

这会有什么不同吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T10:46:12.727

那么类中的私有标签只是一个语法糖，它不会改变代码的生成方式。

如果您正在调用成员函数，然后类成员变为 NULL，则问题可能是成员函数以某种方式删除了 CMessage 对象。但请注意，如果 CMessage 对象是在堆栈中分配的，则问题可能并非如此。

另一个问题可能是 CService 对象在完成访问 CMessage 对象的当前函数之前被破坏（线程被终止）。

# jquery - 使用 jQuery 动画 wp_nav_menu

> ID：10645716
> 
> 赞同：0
> 
> 时间：2012-05-18T01:44:37.997
> 
> 标签：jquery, wordpress, drop-down-menu

我一直在努力弄清楚如何让我的下拉菜单使用 jQuery 进行动画处理。我正在使用 wp_nav_menu 和一个简单的脚本，但我不确定它为什么不起作用。

这是导航源：

```
<nav id="topNav">
  <div id="navwrap" class="menu-main-container">
    <ul id="menu-main" class="dropdown">
      <li id="menu-item-30" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-30"><a href="http://www.mysite.com/page1-2/">Page1</a>
        <ul class="sub-menu">
          <li id="menu-item-34" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-34"><a href="http://www.mysite.com/sub-page1-1/">Sub-Page1-1</a></li>
          <li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a href="http://www.mysite.com/sub-page1-2/">Sub-Page1-2</a></li>
        </ul>
      </li>
      <li id="menu-item-31" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-31"><a href="http://www.mysite.com/page2-2/">Page2</a>
        <ul class="sub-menu">
          <li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36"><a href="http://www.mysite.com/sub-page2-1/">Sub-Page2-1</a></li>
          <li id="menu-item-37" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37"><a href="http://www.mysite.com/sub-page2-2/">Sub-Page2-2</a></li>
        </ul>
      </li>
      <li id="menu-item-32" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32"><a href="http://www.mysite.com/page3-2/">Page3</a>
        <ul class="sub-menu">
          <li id="menu-item-38" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38"><a href="http://www.mysite.com/sub-page3-1/">Sub-Page3-1</a></li>
          <li id="menu-item-41" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-41"><a href="http://www.mysite.com/sup-page3-2/">Sup-Page3-2</a></li>
        </ul>
      </li>
      <li id="menu-item-33" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-33"><a href="http://www.mysite.com/page4-2/">Page4</a>
        <ul class="sub-menu">
          <li id="menu-item-39" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-39"><a href="http://www.mysite.com/sub-page4-1/">Sub-Page4-1</a></li>
          <li id="menu-item-40" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-40"><a href="http://www.mysite.com/sub-page4-2/">Sub-Page4-2</a></li>
        </ul>
      </li>
    </ul>
  </div>
</nav> 
```

这是我编写的用于使隐藏的 UL 上下动画的脚本：

```
<script type="text/javascript">
jQuery(function() {
    jQuery("#navwrap ul.dropdown li").hover(function() {
        jQuery(this).find('ul.sub-menu')
            .stop(true, true).delay(50).animate({ "height": "show", "opacity": "show" }, 200 );
    }, function(){
        jQuery(this).find('ul.sub-menu')
            .stop(true, true).delay(50).animate({ "height": "hide", "opacity": "hide" }, 200 );
    });

});
</script> 
```

关于为什么这不起作用的任何建议？我已经在这几个小时了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T21:57:26.970

我必须在页面加载时隐藏和显示子菜单才能让我的下拉菜单正常工作。

```
$(".sub-menu").hide(); // hide the submenu on page load
$(".current_page_item .sub-menu").show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T03:34:29.810

我用你的代码做了一个[jsfiddle 例子](http://jsfiddle.net/libinvbabu/wuUX3/)，它工作正常。***注意**：*我没有添加任何 CSS。*

因此，请检查您的代码中的以下问题：

1.  jQuery 是否正确链接。
2.  检查萤火虫或铬检查元素是否有任何错误。
3.  检查您的 CSS 是否有任何覆盖脚本的规则。

仍然有问题，请提供站点链接。

干杯！！！

# c - glibc 的 free() 的内部工作原理

> ID：10645722
> 
> 赞同：3
> 
> 时间：2012-05-18T01:45:45.097
> 
> 标签：c, heap-memory, free, glibc

对于 glibc 2.15，我正在查看 malloc.c，特别是 free() 函数，并对 unlink() 宏感到困惑。根据来源，使用中的块如下所示：

```
 chunk-> +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                  Size of previous chunk, if allocated            
           +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                  Size of chunk, in bytes                       
     mem-> +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                  User data starts here...                          .
    .                                                               .
    .             (malloc_usable_size() bytes)                      .
    .                                                               
nextchunk->+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
```

一个 free() 的块看起来像这样：

```
 chunk-> +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                         Size of previous chunk                    
            +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 `head:'           Size of chunk, in bytes                          
  mem->     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                  Forward pointer to next chunk in list             
            +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                  Back pointer to previous chunk in list            
            +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                  Unused space (may be 0 bytes long)                .
    .                                                               .
    .                                                               
nextchunk-> +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
```

当使用的块是 free()'d 时，它将接收到的 mem 指针作为参数并从中减去偏移量以获得块指针。中间有一堆检查，但在没有映射块的情况下，它通常向前或向后将它与另一个空闲块合并。由于 free() 的块已经在一个 bin 中，它只是在那个特定的 bin 中搜索块来合并它，对吗？在前向合并的情况下，`unlink()`宏被调用并应用于被释放（）的块之后的块。我不明白这一点，因为当下一个块（称之为'nextchunk'）被取消链接时，会发生以下代码：

```
 #define unlink(P, BK, FD) {                                            
    FD = P->fd;                                                          
    BK = P->bk;
    .
    .
    .
    FD->bk = BK;                                                       
    BK->fd = FD;
    .
    .
    .
                             } 
```

`BK->fd`考虑到 BK 指向被 free() 的块并且查看它的结构，它没有前向或后向指针，如何引用它。我一定错过了代码中将 fd 和 bk 字段添加到 free() 的块中的部分，但我不知道在哪里。任何人都可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T06:46:38.683

这一行在被释放的块中创建了一个前向指针：

```
BK->fd = FD; 
```

BK*曾经*是一大块用户数据，但*现在*它是一大块空闲数据，因此`malloc`可以随意在内存上随意涂鸦。

如果它有帮助，你可以把它想象成一个联合：

```
union {
    struct {
        chunk *fd;
        chunk *bk;
    } freed;
    unsigned char user_data[N];
}; 
```

在工会中，您可以*写入*任何工会成员，但您只能从最近写入的成员中*读取。*所以当`free`被调用时，数据被写入`fd`并且`bk`——这没关系，唯一的结果是现在`user_data`可能有垃圾。相比之下，当块包含用户数据（不是免费的）时，`fd`and`bk`指针是垃圾，因为它们是别名`user_data`。

（从技术上讲，你总是可以从`user_data`任何别名中读取，因为它是一个`unsigned char`，但这并不真正相关。）

**更新：**这是*低级*C 代码。您会期望在实现中使用低级 C 代码`malloc`。字段存在或不存在的想法在低级代码中没有意义，因为我们在不同类型之间进行转换并允许指针相互别名。

在低级代码中，字段只是内存偏移量。在我的系统上，该`fd`字段的偏移量可能为 0，而该`bk`字段的偏移量可能为 8 或 4，具体取决于我编译的体系结构。所以下面的代码：

```
BK->fd = FD; 
```

这意味着“将值 FD 写入内存位置 BK + 0”。如果您`BK->fd`仅将其视为内存中的一个位置，它可能会帮助您了解其`free`工作原理。（它实际上*不仅仅是*内存中的一个位置，因为在编译时还有类型信息和别名规则。）

**理解低级 C：** 如果你想理解低级 C 代码，那么理解汇编语言*会有很大帮助。*这不是必需的，但它有帮助。学习哪种汇编语言并不重要：x86、MIPS、PowerPC、ARM 等。您不需要学习太多汇编，只需一点点。你不需要学习 x86，即使你从不使用 MIPS，你也可以学习 MIPS。（事实上​​，MIPS 可能更容易学习。）

只需学习足够的汇编，您就可以将一小段 C 代码转换为汇编，这样您就可以了解它在幕后所做的事情。上面那一行 C 代码可能翻译成一行汇编代码，因为它是如此简单。

并且在编写 C 时尽量不要过多考虑汇编。当您*编写*C 时，编译器正在编写汇编，这意味着*您不是在*编写汇编。

# sql-server - 通过存储过程和 c# 从 SQL Server 返回输出参数

> ID：10645730
> 
> 赞同：2
> 
> 时间：2012-05-18T01:46:43.623
> 
> 标签：sql-server, c#-4.0, stored-procedures, output-parameter

我从 SQL Server 获取输出值时遇到了麻烦。

这是我的存储过程：

```
ALTER PROCEDURE [dbo].[Insert_UnknownCustomer_Quote_Document]
-- Add the parameters for the stored procedure here
@NewDocumentFileName nvarchar(100),
@NewDocumentWordCount int,
@NewQuoteAmount money,
@NewQuoteNumber int OUTPUT = 0

AS

DECLARE @Today datetime
SELECT @Today = GETDATE()

BEGIN TRANSACTION
BEGIN TRY

BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from interfering with SELECT statements.
SET NOCOUNT ON;

-- Insert statements for procedure here
INSERT INTO dbo.Customers(DateAdded)
VALUES (@Today)

INSERT INTO dbo.Quotes(CustomerID, QuoteAmount, QuoteDate)
VALUES (@@IDENTITY, @NewQuoteAmount, @Today)

SELECT @NewQuoteNumber = @@IDENTITY
INSERT INTO dbo.DocumentFiles(QuoteNumber, DocumentFileName, DocumentFileWordCount)
VALUES (@NewQuoteNumber, @NewDocumentFileName, @NewDocumentWordCount)

-- Return quote number
RETURN @NewQuoteNumber

END
COMMIT TRANSACTION
END TRY

BEGIN CATCH
ROLLBACK TRANSACTION
PRINT 'Transaction rolled back.'
END CATCH 
```

这是我的 C#：

```
SqlParameter returnQuoteNumber = new SqlParameter("@NewQuoteNumber", SqlDbType.Int);
        returnQuoteNumber.Direction = ParameterDirection.ReturnValue;
        newSQLCommand.Parameters.Add(returnQuoteNumber); 
```

这是我现在收到的错误：

```
Procedure or function 'Insert_UnknownCustomer_Quote_Document' expects parameter '@NewQuoteNumber', which was not supplied. 
```

我曾尝试将@NewQuoteNumber 从开头取出并将其放在带有 DECLARE 的 AS 之后，但这也会产生错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T01:49:12.697

你 `ParameterDirection.Output` 不想`ParameterDirection.ReturnValue`

也把它从return部分拿出来，return应该用来返回一个状态而不是一个值

如果你确实使用return，我会在事务提交之后而不是之前这样做

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T03:26:57.277

```
SqlCommand.Parameters.Add("@NewQuoteNumber", SqlDbType.Int).Direction = ParameterDirection .Output ;

<SqlCommand>.ExecuteNonQuery();

int NewQuoteNumber = int.Parse(SqlCommand.Parameters["@NewQuoteNumber"].Value .ToString ()); 
```

现在你可以在你的代码中使用这个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-30T13:33:10.717

这一行：

```
int NewQuoteNumber = int.Parse(SqlCommand.Parameters["@NewQuoteNumber"].Value .ToString ());<br /> 
```

应该：

```
int NewQuoteNumber = int.Parse(SqlCommand.Parameters["NewQuoteNumber"].Value .ToString ()); 
```

# python - 如何以编程方式在 Django 中的 ModelForm 中设置字段？

> ID：10645733
> 
> 赞同：4
> 
> 时间：2012-05-18T01:47:05.047
> 
> 标签：python, django-forms

从[这个问题](https://stackoverflow.com/questions/10642625/how-do-i-initiate-values-for-fields-in-a-form-for-editing-in-a-template)中，我想将我的表单从常规转换`Form`为，`ModelForm`以便我可以利用`instance`参数 in `ModelForm`。

这是我当前的表单代码：

```
class OrderDetailForm(forms.Form):
    def __init__(
        self,
        user,
        can_edit_work_type=None,
        can_edit_vendor=None,
        can_edit_note=None,
        *args,
        **kwargs
    ):
        super(OrderDetailForm, self).__init__(*args, **kwargs)

        if can_edit_work_type:
            self.fields['work_type'] = forms.ChoiceField(choices=Order.WORK_TYPE_CHOICES)
        if can_edit_vendor:
            self.fields['vendor'] = forms.ModelChoiceField(
                queryset=Vendor.objects.all(),
                empty_label="Choose a vendor",
            )
        if can_edit_note:
            self.fields['note'] = forms.CharField(widget=forms.Textarea)

    def clean(self):
        super(OrderDetailForm, self).clean()

        if 'note' in self.cleaned_data:
            if len(self.cleaned_data['note']) < 50:
                self._errors['note'] = self.error_class([u"Please enter a longer note."])

                del self.cleaned_data['note']

        return self.cleaned_data 
```

如您所见，我有一些`if`语句可以确定字段是否甚至在表单中显示（从逻辑上讲，这意味着某些用户只能编辑字段的某些部分）。

我该怎么做`ModelForm`？我知道`fields`是一个元组，所以它不能像我在`Form`. 所以我想做类似的事情

```
class OrderDetailForm(forms.ModelForm):
    class Meta:
        model = Order
        # fields = ('work_type', 'vendor', 'note') I can't do that since I need to be able to control it. See below.

        # Can I control widgets even if that field doesn't exist?
        widgets = {
            'note': forms.Textarea(),
        }

    def __init__(
        self,
        user,
        can_edit_work_type=None,
        can_edit_vendor=None,
        can_edit_note=None,
        *args,
        **kwargs
    ):
        super(OrderDetailForm, self).__init__(*args, **kwargs)

        fields = []

        if can_edit_work_type:
            fields.append('work_type')
        if can_edit_vendor:
            fields.append('vendor')
        if can_edit_note:
            fields.append('note')

        self.Meta.fields = tuple(fields) # Does this work?

    def clean(self):
        super(OrderDetailForm, self).clean()

        if 'note' in self.cleaned_data:
            if len(self.cleaned_data['note']) < 50:
                self._errors['note'] = self.error_class([u"Please enter a longer note."])

                del self.cleaned_data['note']

        return self.cleaned_data 
```

那可能吗？您如何控制 中的字段`ModelForm`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T04:04:21.493

另一种可能的方式是在视图中生成一个内联表单类，以根据请求排除字段，例如，为 Order 模型定义一个普通的模型表单，称为 OrderDetailForm：

```
class OrderDetailForm(forms.ModelForm):
    class Meta:
        model = Order
        fields = ('work_type', 'vendor', 'note') 
        widgets = {
            'note': forms.Textarea(),
        } 
```

在视图中，例如编辑订单，根据 OrderDetailForm 创建自定义表单：

```
def edit(request, order_id):
    order = Order.objects.get(pk=order_id)
    can_edit_work_type = bool(request.REQUEST.get('can_edit_work_type', False))
    can_edit_vender = bool(request.REQUEST.get('can_edit_vender', False))
    can_edit_note = bool(request.REQUEST.get('can_edit_note', False))

    exclude_fields = []

    if not can_edit_work_type:
        exclude_fields.append('work_type')

    if not can_edit_vender:
        exclude_fields.append('vender')

    if not can_edit_note:
        exclude_fields.append('note')

    class CustomizedOrderForm(OrderDetailForm):
        class Meta:
            model = Order
            exclude = tuple(exclude_fields)

    if request.method == 'POST':
        form = CustomizedOrderForm(instance=order, data=request.POST)
        if form.is_valid():
            form.save()
    else:
        form = CustomizedOrderForm(instance=order)
    return render(request, 'order_form.html', {'form': form}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T03:13:23.703

该`ModelForm`api 与常规的 api 非常相似`Form`。优点是除了默认小部件、实例 kwarg 和保存方法等便利之外，您现在还可以获得[模型验证](https://docs.djangoproject.com/en/dev/ref/models/instances/#validating-objects "模型验证")。

`fields` `attr`仍然`dict`像。[您可以在此处](https://github.com/django/django/blob/master/django/forms/models.py#L186)看到由元类构建的字段。然后，[通过](https://github.com/django/django/blob/master/django/forms/models.py#L368)继承和调用，我们到达[声明的字段](https://github.com/django/django/blob/master/django/forms/forms.py#L95)中的[a](https://github.com/django/django/blob/master/django/forms/models.py#L225)，[最初](https://github.com/django/django/blob/master/django/forms/forms.py#L29)是 a 。这对于和的两个子类很常见。`super()``BaseModelForm.__init__``deepcopy``SortedDict``Form``ModelForm``BaseForm`

将字段放在[排除](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#using-a-subset-of-fields-on-the-form)项中，并按照您在原始文件中的方式添加它们`__init__`。

以同样的方式清洁它们。

然后，您可以覆盖该`save`方法：您可以调用`super()`以取回对象并根据`cleaned_data`需要处理数据。

```
class OrderDetailForm(forms.ModelForm):
    # regular fields, not based on bools
    # ...

    class Meta:
        model = Order
        exclude = ('work_type', 'vendor', 'note')
        # or fields = (...other fields )

    def __init__(
        self,
        user,
        can_edit_work_type=None,
        can_edit_vendor=None,
        can_edit_note=None,
        *args,
        **kwargs,
    ):
        super(OrderDetailForm, self).__init__(*args, **kwargs)

        if can_edit_work_type:
            self.fields['work_type'] = forms.ChoiceField(
                                       choices=Order.WORK_TYPE_CHOICES)
        if can_edit_vendor:
            self.fields['vendor'] = forms.ModelChoiceField(
                queryset=Vendor.objects.all(),
                empty_label="Choose a vendor",
            )
        if can_edit_note:
            self.fields['note'] = forms.CharField(widget=forms.Textarea)

    def clean(self):
        # I never call super() in clean .. do I? .. hmmm
        # maybe I should or is sth magic going on?
        # alternately,
        # data = self.cleaned_data
        # let's call super though
        data = super(OrderDetailForm, self).clean()

        if 'note' in data:
            if len(data['note']) < 50:
                # I raise a validation error so .is_valid() comes back False
                # form.errors happens magically ...
                raise forms.ValidationError("Not long enough ...")

        return data

    def save(self, *args, **kwargs):
        data = self.cleaned_data
        # maybe do some stuff here
        # ...

        # commit=True or commit=False could be important
        order = super(OrderDetailForm, self).save(*args, **kwargs)

        if 'note' in data:
            order.note = data['note']

        # ... do other stuff

        # probably ...
        order.save()

        # respect how model forms work.
        return order 
```

# .net - 对 IIS 7 中的连接字符串进行故障排除 - 如何测试出了什么问题

> ID：10645736
> 
> 赞同：1
> 
> 时间：2012-05-18T01:47:20.720
> 
> 标签：.net, iis-7, database-connection

我有一个复杂的问题，我不确定是什么原因造成的。简而言之，我几乎可以测试我需要的任何东西，但我不确定在我的场景中解决数据库连接字符串问题的最佳方法。

我的开发环境与我的测试环境有很大不同。我的测试环境在 DMZ 中。我的开发环境与数据库服务器在同一个域内。

在我的开发环境中，我在桌面上运行并使用连接字符串进行连接并使用受信任的连接。

在 DMZ 中，我已将文件部署在 IIS 7 指向同一服务器的系统驱动器上。因为测试环境在 DMZ 上，所以我使用服务器的 IP 地址和必须在连接字符串中指定的特殊端口号。

我的 Web 应用程序不包含连接字符串。我将连接字符串保存在 .cs 文件中，并基于 .Net 中的 Evironment.machineName 变量，应用程序在运行时决定使用哪个连接字符串并将其存储到全局静态变量中，所以我基本上有：

```
public static readonly string strDBConnDev = "connection stuff here";
public static readonly String strDBConnTest = "connection stuff here";

public static String strDBConn; 
```

然后我有一个在运行的页面加载时触发的函数

```
public static void setEnvVars()
{

// This is psuedocode

if(environment.machinename = "mydevmachine")

{       
strDBConn = strDBConnDev;
        }

        if(environment.machinename = "mytestmachine")
        {
            strDBConn = strDBConnTest;
        }
} 
```

我在 dev 上建立了成功的连接。连接字符串或有关它的某些内容不正确。我正在使用 .Net 数据提供程序，使用 System.Data.SqlClient。我继续使用它很重要。我没有在 IIS 7 数据库部分配置任何连接字符串，因为在我们的其他环境中似乎不需要。

根据我发现的一篇文章：有两种格式。我的开发机器使用的那个

// .NET DataProvider -- 可信连接

使用 System.Data.SqlClient；

```
SqlConnection conn = new SqlConnection();
conn.ConnectionString =
"Data Source=ServerName;" +
"Initial Catalog=DataBaseName;" +
"Integrated Security=SSPI;";
conn.Open(); 
```

以及我需要在 dmz 中进行测试才能使用的通过 ip 的连接：

// .NET DataProvider -- 通过 IP 地址

```
using System.Data.SqlClient;

SqlConnection conn = new SqlConnection();
conn.ConnectionString =
"Network Library=DBMSSOCN;" +
"Data Source=xxx.xxx.xxx.xxx,[port number];" +
"Initial Catalog=DataBaseName;" +
"User Id=UserName;" +
"Password=Secret;";
conn.Open(); 
```

我的难题是我遇到了麻烦，以至于我知道在 DMZ 中设置了连接字符串变量。但是我的连接失败，但我没有收到错误。它只是悄悄地失败了。我检查了 DMZ 上的 IIS 日志，没有发现任何线索或提示的证据。我还检查了 Windows 应用程序日志，并没有发现任何东西，我认为这非常令人惊讶。

我觉得卡在这一点上，因为我觉得我需要故障排除的想法，以便我可以从我的 dmz 主机了解和测试数据库服务器的连接、可见性和凭据。

我如何部署的一点背景是我在我的机器上构建，然后将文件复制到我的 c# Web 应用程序到 dmz 主机上的文件夹中。代码运行良好，直到它尝试调用数据库。

我觉得我的“技能”需要一些帮助，基本上知道何时/如何进行故障排除以及向我的网络窥视者询问什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T05:18:47.513

这个问题没有反应，但问题已解决。我通过以下方式解决了连接问题：

1) 检查从 dmz web 主机到内部数据库服务器的可访问性

*   我在该端口上打开了一个到数据库主机的 telnet 会话，并确认它可以访问。
*   然后我成功创建了到该主机的 odbc 连接

2) 确定为什么我的 .net 应用程序中的连接字符串不起作用

*   我的代码周围有一个 try/catch 块，所以它静默失败，我无法对消息进行故障排除，因此一位同事建议在 dmz 主机上运行 LinqPad >>
*   我在该服务器上运行 LinqPad 并在 c# 中编写了一个非常小的数据库连接函数，我的运行方式与我的应用程序尝试连接的方式完全相同。LinqPad 给了我错误！

问题...我创建了一个数据库帐户（因为您不能使用受信任的连接或 Windows 通过身份验证从 dmz 到内部 db 主机）并且我没有为该帐户提供对数据库的任何选择访问权限。

通过确保我的数据库帐户设置正确，问题得以解决。这是我第一次听说 Linqpad，但它最终成为一个非常酷的故障排除工具，因为您可以运行一些 .net 脚本而无需启动项目或编译，因此它节省了一些时间。

# c++ - 显式模板函数和方法特化

> ID：10645738
> 
> 赞同：2
> 
> 时间：2012-05-18T01:48:19.750
> 
> 标签：c++, templates, template-specialization

我一直在寻找一个明确的答案，我只是从网络上捕捉点点滴滴。

我有一个函数，它需要根据类型变量采取不同的行动。该函数不接受任何参数，因此重载不起作用，导致模板特化。例如：

```
//Calls to this function would work like this:
int a = f();
int b = f<int>();
int c = f<char>();
//... 
```

首先，这在语法上是否可行？我觉得是的。继续。

我在定义这个函数时遇到了问题，因为我对显式专业化的语法很感兴趣。我尝试了许多不同的方法，但我什至还没有一个简单的例子可以工作。

其次，我试图（最终）将该模板函数变成（非模板）类的模板方法。当我到达那里时，我会越过那座桥。

谢谢，
伊恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T01:56:17.137

好吧，这是可能的，但不是更好的事情之一。显式模板函数特化有点暗角，但您可以这样做：

```
template< typename T > int f(){ ... }

template<> int f<int>(){ ... }
template<> int f<char>(){ ... } 
```

一些相关阅读：[http ://www.gotw.ca/gotw/049.htm](http://www.gotw.ca/gotw/049.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T02:02:56.953

> 首先，这在语法上是否可行？我觉得是的。

是的，但不要使事情过于复杂——这只需要简单的重载：

```
int f()
{
    return /* default, typeless implementation */;
}

template<typename T>
int f()
{
    return /* type-specific implementation */;
}

template<>
int f<char>()
{
    return /* char implementation */;
}

template<>
int f<int>()
{
    return /* int implementation */;
} 
```

# jquery - 如何从元素中动态克隆文本？

> ID：10645741
> 
> 赞同：1
> 
> 时间：2012-05-18T01:48:32.867
> 
> 标签：jquery

我正在使用一个系统，该系统在几乎没有自定义空间的表格中生成购物车摘要。我想做的是当购物车为“空”时显示“0”

当其中有数量时，显示该数字。

这是我**隐藏**的生成的 HTML ：

```
<span vertical="False" quote="False" id="catCartSummary">
   <table cellspacing="0" class="cartSummaryTable">
     <tbody>
       <tr>
         <td class="cartSummaryItem">3 item(s), Total: $115.00 <a href="/OrderRetrievev2.aspx?CatalogueID=0" class="cartSummaryLink">View Cart</a></td>
       </tr>
     </tbody>
   </table>
</span> 
```

如您所见，它目前有“3 个项目”。

这看起来像空的：

```
<span vertical="False" quote="False" id="catCartSummary">
   <table cellspacing="0" class="cartSummaryTable">
     <tbody>
       <tr>
         <td class="cartSummaryItem">Shopping cart is empty.</td>
       </tr>
     </tbody>
   </table>
</span> 
```

现在我在这里有一些简单的 HTML 设置：

```
<div class="cartsummary">
  <div class="cartitems">Shopping Cart <a href="#"><span class="cartTotal"></span> Item(s)</a></div>
</div> 
```

使用 jQuery，我想获取数量并将其添加到 .cartTotal 中，如果购物车中没有任何内容，则显示 0。

这种工作，但如果我向购物车添加一个新项目，它只会在页面刷新时更新值，而自动生成的更新是动态的。

```
if (jQuery('#catCartSummary .cartSummaryItem').html() != 'Shopping cart is empty.') {
   var summary = jQuery('#catCartSummary .cartSummaryItem').text().split(" ");
   var total = summary[0];
   jQuery('span.cartTotal').html(total);
}else{
   jQuery('span.cartTotal').html("0");
} 
```

一些额外的值得注意的：

1.  能够拥有 0 个“项目”、1 个“项目”、2 个“项目”会很棒。而不是总是“项目”
2.  在另一个跨度中单独显示总成本也很棒。也许.cartAmount。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T01:58:45.153

尝试：

```
var text = $('#catCartSummary .cartSummaryItem').text();
items = text.match(/(\d+) item/);
var num = 0;
if(items &&items.length > 0){
   num = items[1];
}
$(".cartItems").html('<div class="cartitems">Shopping Cart <a href="#"><span class="cartTotal">'+num+'</span> Item'+(num == 1 ? '' : 's') +'</a></div>'); 
```

一些指示：

*   使用 .text() 在`text`变量中不获取任何 html
*   使用正则表达式解析出项目数而不是拆分

# c# - 使用 windows 平台 5.3.8 PHP 的函数 DOTNET() 时崩溃

> ID：10645742
> 
> 赞同：1
> 
> 时间：2012-05-18T01:48:33.110
> 
> 标签：c#, php, .net, iis, fastcgi

我在 windows server 2008 上使用 IIS 7 运行 PHP 5.3.8 非线程安全版本。我有以下代码

```
<?php
echo "Started..<br/>";

$outStr = "";
 $stack = new DOTNET("mscorlib", "System.Collections.Stack");
 $stack->Push(".Net");
 $stack->Push("Hello ");
 echo $stack->Pop() . $stack->Pop();
 echo "<br/>".$_SERVER['REQUEST_TIME']."<br/>";
?> 
```

它每隔一段时间就会崩溃（工作，崩溃，工作，崩溃，....等）。向网络浏览器报告的错误是：

HTTP 错误 500.0 - 内部服务器错误 c:\php\php-cgi.exe - FastCGI 进程意外退出

我尝试了其他 .net 程序集（我用 C# 编写）并获得了相同的崩溃行为（每隔一次）。

请帮忙。

我正在使用 .net 4 。在我的 c:\php 目录中，我有一个 php-cgi.exe.config 文件，如下所示：

```
<?xml version="1.0"?>
<configuration>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
</configuration> 
```

但即使使用 .net 3.5，我也会遇到同样的崩溃行为。

如果我在命令行中运行 php 脚本如下，它似乎每次都可以工作，但我真的需要我的 php web 应用程序在没有崩溃的情况下工作（我没有 php.exe.config .. none）

```
\php\php.exe  testscript.php 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T17:32:35.197

此行为似乎是一个已知错误： [https ://bugs.php.net/bug.php?id=53140&edit=1](https://bugs.php.net/bug.php?id=53140&edit=1)

# php - jquery自动完成无响应脚本

> ID：10645748
> 
> 赞同：1
> 
> 时间：2012-05-18T01:48:47.373
> 
> 标签：php, jquery, mysql, jquery-ui, wordpress

我正在创建一个 wordpress 插件，我试图在其中使用 jquery 填充自动完成文本框，并且源来自数据库。

jQuery脚本

```
$( "#tags" ).autocomplete({
        source: "<?php echo WP_PLUGIN_URL.'/plugin-name/php-file.php'?>"
    }); 
```

html

```
<div class="ui-widget">
<label for="tags">Tags: </label>
<input id="tags"> 
```

php

```
global $wpdb;
$code = $wpdb->get_results(
        "SELECT suburb as label, post_code as code
        FROM Sheet1
        ",ARRAY_A
        );  
echo(json_encode($code)); 
```

但是当我运行它时，脚本崩溃了。

似乎是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:18:16.670

您没有设置查询过滤器：

```
global $wpdb;
$code = $wpdb->get_results(
    "SELECT suburb as label, post_code as code
    FROM Sheet1
    WHERE suburb like '%" . $_GET["term"] . "%'
    LIMIT 0,25
    ",ARRAY_A
    );  
echo(json_encode($code)); 
```

但当然，您需要对`$_GET["term"]`零件进行消毒。

# c# - 如何使richTextBox 滚动？

> ID：10645754
> 
> 赞同：2
> 
> 时间：2012-05-18T01:49:52.547
> 
> 标签：c#, winforms

我在richTextbox1 中添加了很多文本，我在右侧有一个滚动条，但里面的文本是添加所有时间滚动的行。只有当我用鼠标向下拖动右侧的栏时，我才会看到文本滚动。

一旦里面的文本到达richTextbox的底部，我想让它自动滚动。

我该怎么做 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T01:55:02.790

每当在 RichTextBox 控件中添加文本时，您应该执行这些语句以将光标移动到 RichTextBox 中文本的末尾。假设 RichTextBox 控件的名称是richTextBox，您将有如下语句。

```
richTextBox.SelectionStart = richTextBox.Text.Length;
richTextBox.ScrollToCaret(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T03:42:32.307

**此代码将完美运行：** ------

```
namespace CustomRTB
{
    public class CustomRTB : RichTextBox
    {
        #region API Stuff
        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        public static extern int GetScrollPos(IntPtr hWnd, int nBar);

        [DllImport("user32.dll")]
        private static extern int SetScrollPos(IntPtr hWnd, int nBar, int nPos, bool bRedraw);

        private const int SB_HORZ = 0x0;
        private const int SB_VERT = 0x1;
        #endregion
        public int HorizontalPosition
        {
            get { return GetScrollPos((IntPtr)this.Handle, SB_HORZ); }
            set { SetScrollPos((IntPtr)this.Handle, SB_HORZ, value, true); }
        }

        public int VerticalPosition
        {
            get { return GetScrollPos((IntPtr)this.Handle, SB_VERT); }
            set { SetScrollPos((IntPtr)this.Handle, SB_VERT, value, true); }
        }
    }
} 
```

您可以检查它包含的**RichTextBox 类**属性

公共 RichTextBoxScrollBars 滚动条 { 获取；放; }

此属性使您能够向 RichTextBox 控件的用户提供水平和垂直滚动条以启用滚动。

# php - 最佳日志数据库结构

> ID：10645756
> 
> 赞同：1
> 
> 时间：2012-05-18T01:50:40.857
> 
> 标签：php, mysql, performance, join

MYSQL/PHP，我想创建人们在网站上执行的活动的记录。

```
Table ADDED -> EventID, UserID, Time, IP

Table DELETED -> EventID, UserID, Time, IP

Table SHARED -> EventID, UserID, Time, IP. 
```

在查询以读取例如由 a 执行的最后 10 个操作时加入这些表是否更有效`USERID`，或者像这样的结构会更有效。

```
Table EVERYTHING -> EventID, EventType(eg ADDED, DELETED, SHARED), UserID, Time, IP 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T01:52:40.673

使用一个记录所有事件并区分事件类型的表，如您的第二个建议。

您在此处仅存储一种类型的数据，因此将其存储在一个表中是合适的。在早期阶段，您不必太担心表格会随着时间的推移而增长到多大。像这样的表中只有几列，在您甚至需要考虑对其进行分区之前，它很容易增长到数百万行。

如果您的事件类型数量有限，您可以考虑使用列[的`ENUM()`数据类型](http://dev.mysql.com/doc/refman/5.5/en/enum.html)`EventType`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T04:15:41.697

使用一张表是正确的做法，因为它已正确规范化。添加新事件类型不需要新表。维护参照完整性并利用索引为用户检索和排序所有事件也容易得多。（如果您将它们放在单独的表中，获取用户的所有事件并按时间排序可能比使用一张表要慢得多！）

但是，有一些方法可以使这些表更小，以节省空间并保持索引小：

*   使用 an`enum()`来定义您的事件类型。如果您有少量事件，则每行最多使用一个字节。
*   使用整数类型从相同数量的字节`UNSIGNED`中获取更多`EventID`和s。`UserID`
*   如果您不需要完整的日期范围（可能），请使用 TIMESTAMP 类型与 DATETIME 类型相比，每行节省 4 个字节。
*   如果您只使用 ipv4 地址，请将 IP 存储为无符号 4 字节整数并使用 INET_ATON() 和 INET_NTOA() 来回转换。这是最大的赢家：VARCHAR 类型至少需要 16 个字节，并且您可能会使用固定的行长度格式。

我推荐这样的表格格式：

```
CREATE TABLE Events (
    `EventID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
    `UserID` MEDIUMINT UNSIGNED NOT NULL COMMENT 'this allows a bit more than 16 million users, and your indexes will be smaller',
    `EventType` ENUM('add','delete','share') NOT NULL,
    `Time` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    `IP` INTEGER UNSIGNED NOT NULL DEFAULT 0,
    PRIMARY KEY (`EventID`),
    FOREIGN KEY (`UserID`) REFERENCES `Users` (`UserId`) ON UPDATE CASCADE ON DELETE CASCADE,
    KEY (UserID)
); 
```

如果您使用 MyISAM 存储它，您的行长度将为 16 字节，使用固定格式。这意味着每百万行需要 16MB 的数据空间，而索引可能需要一半的空间（取决于您使用的索引）。这非常紧凑，mysql 可能大部分时间都可以将表的整个工作部分保存在内存中。

然后是创建最常见操作所需的索引的问题。例如，如果您始终显示某个用户在某个时间范围内的所有事件，请替换`KEY (UserID)`为`INDEX userbytime (UserID, Time)`. 然后类似的查询`SELECT * FROM Events WHERE UserID=? AND Time BETWEEN ? AND ?`会非常快。

# spring - 添加 springsecurity.taglib.xml 时无法运行项目

> ID：10645758
> 
> 赞同：0
> 
> 时间：2012-05-18T01:50:51.410
> 
> 标签：spring, security, jsf, spring-security, glassfish

我在实现 spring security 和 jsf 2.0 时遇到问题，正是在 web.xml 中添加 springsecurity.taglib.xml

服务器：glassfish 服务器 3
springframework 3.0.2
jsf 2.0

库：
org.springframework.faces.sources 3

**web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app id="WebApp_ID" version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"          xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
<display-name>HelloWorldExampleWithSpring3MVCInEclipse</display-name>
<context-param>
    <param-name>javax.faces.FACELETS_LIBRARIES</param-name>
    <param-value>/WEB-INF/springsecurity.taglib.xml</param-value>
</context-param>
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/app-config.xml</param-value>
</context-param>
<context-param>
    <param-name>javax.faces.PROJECT_STAGE</param-name>
    <param-value>Production</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<servlet>
    <servlet-name>Spring MVC Dispatcher Servlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/app-config.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.jsf</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>Spring MVC Dispatcher Servlet</servlet-name>
    <url-pattern>*.htm</url-pattern>
</servlet-mapping>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<welcome-file-list>
    <welcome-file>faces/index.jsp</welcome-file>
</welcome-file-list> 
```

**springsecurity.taglib.xml**

```
<?xml version="1.0"?>
<!DOCTYPE facelet-taglib PUBLIC
"-//Sun Microsystems, Inc.//DTD Facelet Taglib 1.0//EN"
 "http://java.sun.com/dtd/facelet-taglib_1_0.dtd">
<facelet-taglib>
<namespace>http://www.springframework.org/security/tags</namespace>
<tag>
    <tag-name>authorize</tag-name>
    <handler-class>org.springframework.faces.security.FaceletsAuthorizeTagHandler</handler-class>
</tag>
<function>
    <function-name>areAllGranted</function-name>
    <function-class>org.springframework.faces.security.FaceletsAuthorizeTagUtils</function-class>
    <function-signature>boolean areAllGranted(java.lang.String)</function-signature>
</function>
<function>
    <function-name>areAnyGranted</function-name>
    <function-class>org.springframework.faces.security.FaceletsAuthorizeTagUtils</function-class>
    <function-signature>boolean areAnyGranted(java.lang.String)</function-signature>
</function>
<function>
    <function-name>areNotGranted</function-name>
    <function-class>org.springframework.faces.security.FaceletsAuthorizeTagUtils</function-class>
    <function-signature>boolean areNotGranted(java.lang.String)</function-signature>
</function>
<function>
    <function-name>isAllowed</function-name>
    <function-class>org.springframework.faces.security.FaceletsAuthorizeTagUtils</function-class>
    <function-signature>boolean isAllowed(java.lang.String, java.lang.String) </function-signature>
</function>
</facelet-taglib> 
```

**这是错误信息**

```
In-place deployment at D:\Project\Secret Project\Hobic Project EE\Yeah\build\web
deploy?path=D:\Project\Secret Project\Hobic Project     EE\Yeah\build\web&name=Yeah&force=true failed on GlassFish Server 3
D:\Project\Secret Project\Hobic Project EE\Yeah\nbproject\build-impl.xml:760: The module has not been deployed.
BUILD FAILED (total time: 1 minute 29 seconds) 
```

**服务器错误信息**

```
SEVERE: Exception while loading the app
SEVERE: Exception while loading the app : java.lang.IllegalStateException:    ContainerBase.addChild: start: org.apache.catalina.LifecycleException:   java.lang.RuntimeException: com.sun.faces.config.ConfigurationException: 
Source Document:     jar:file:/D:/Project/Secret%20Project/Hobic%20Project%20EE/Zest/build/web/WEB-  INF/lib/org.springframework.faces-2.0.4.RELEASE.jar!/META-INF/faces-config.xml
Cause: Class 'org.springframework.faces.webflow.FlowActionListener' is missing a  runtime dependency: java.lang.NoClassDefFoundError:  org/springframework/webflow/execution/RequestContext 
```

**你的建议是正确的**[java.lang.NoClassDefFoundError: org/springframework/webflow/execution/RequestContext]，我现在得到了新的错误:(

```
SEVERE: Exception while loading the app
SEVERE: Exception while loading the app : java.lang.IllegalStateException:  ContainerBase.addChild: start: org.apache.catalina.LifecycleException: org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Failed to import bean definitions from relative location [security.xml]
Offending resource: ServletContext resource [/WEB-INF/app-config.xml]; nested exception    is org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Unable to locate Spring NamespaceHandler for XML schema namespace [http://www.springframework.org/schema/security]
Offending resource: ServletContext resource [/WEB-INF/security.xml] 
```

**解决方案 [违规资源：ServletContext 资源 [/WEB-INF/security.xml]] **

```
![.jar needed][1] 
```

你能为我的问题提出建议吗？谢谢阿贡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T11:16:16.747

我不使用Netbeans，所以我不知道它的来龙去脉，但是这个错误信息似乎表明事先已经发生了一些错误/异常。构建日志中真的没有更多内容吗？

无论如何，不​​确定这是否解决了问题并且与具体问题有关，但引起我注意的一件事是，`<facelet-taglib>`当您使用捆绑了 Facelets 2.x 的 JSF 2.x 时，您被声明为符合 Facelets 1.x . Netbeans 可能已经为此倾倒了。

修复文件的根声明`.taglib.xml`如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<facelet-taglib
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facelettaglibrary_2_0.xsd"
    version="2.0"
>
    <!-- Config here. -->
</facelet-taglib> 
```

此外，Glassfish 是与 Servlet 3.0 兼容的容器，但您的`web.xml`根声明符合 Servlet 2.5。从技术上讲，这也不会立即引起问题，但是这样您会错过 Servlet 3.0 / EL 2.2 的优势。

我也会修复的根声明`web.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app 
    xmlns="http://java.sun.com/xml/ns/javaee" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" 
    version="3.0"
>
    <!-- Config here. -->
</web-app> 
```

* * *

**根据您的更新**进行更新，具体问题的根本原因似乎如下：

> java.lang.NoClassDefFoundError: org/springframework/webflow/execution/RequestContext

这`NoClassDefFoundError`意味着类路径中缺少消息中提到的类，而应用程序中的其他类（间接）需要它。解决方案是将类（或在这种特殊情况下，带有该类的 JAR 文件）添加到类路径中。提到的类是[Spring WebFlow](http://www.springsource.org/spring-web-flow)的一部分。您需要下载它并将其包含在类路径（IDE 调用它的构建路径）中，就像您为核心 Spring 框架和 Spring Security 所做的那样。

* * *

**根据您的第二次更新更新 2**，修复第一次后出现了一个新问题：

> 找不到 XML 模式命名空间的 Spring NamespaceHandler [http://www.springframework.org/schema/security] 违规资源：ServletContext 资源 [/WEB-INF/security.xml]

我不是 Spring 人，所以我无法从头顶回答这个问题，但[Google](https://www.google.com/search?q=Unable%20to%20locate%20Spring%20NamespaceHandler%20for%20XML%20schema%20namespace%20%5Bhttp://www.springframework.org/schema/security%5D)建议这个问题是由缺少[Spring Security Config](http://static.springsource.org/spring-security/site/index.html) JAR 文件引起的。

# java - 我如何知道我的代码在执行时间方面是否有效？

> ID：10645759
> 
> 赞同：0
> 
> 时间：2012-05-18T01:50:57.077
> 
> 标签：java, performance

只是一个一般的性能问题。1-7 秒对于构建扑克手、排序扑克手、分析然后返回每种扑克手类型（例如顺子、同花等）的程序来说是一个很好的构建时间吗？

我正在生成一只手，直到它返回手型，在此过程中，我将其从最低到最高排序。我为每一种扑克手类型都这样做。所以你可以想象要生成皇家同花顺和同花顺，它必须在敲击之前生成数千手牌。

我怎么知道进行分析所花费的时间是合理的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T01:54:26.447

我想说的太长了。除非您有一个复杂的 GUI...我建议您将与性能相关的问题提交给[CodeReview](https://codereview.stackexchange.com/)。给他们一个好的[SSCCE](http://www.sscce.org)，或者至少一两个你关注的方法，你很可能会得到一个很好的回应。

此外，您可以考虑进行基准测试。这是一个很好的[问题](https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java)。[Caliper](http://code.google.com/p/caliper/)是一个非常棒的基准测试框架，我也建议您研究一下（我在 CodeReview 上了解到它；D）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:52:08.487

不... 扑克没有太多选择，没有理由让这样的分析仪花费接近一秒，更不用说 7。大约 7 年前，我为 Brew (C) 手机编写了一个德州扑克游戏。它会立即（几乎）产生手。如果您使用的是 Java，那么您可能正在一台相当现代的（阅读速度非常快）机器上运行，无论它是现代手机还是服务器，生成和评估扑克牌并不是一项耗时的工作。

# c# - 本机 DLL 失败。HRESULT=0x80080014

> ID：10645761
> 
> 赞同：-2
> 
> 时间：2012-05-18T01:51:05.857
> 
> 标签：c#, wpf

用户代码未处理 InvalidOperationException。

本机 DLL 失败。HRESULT=0x80080014。

当我尝试运行程序时产生了错误。错误代码以粗体显示......

```
public PoseViewModel()
        {
            if (!IsInDesignMode)
            {
                _leftHandImage = DefaultleftHand;
                _rightHandImage = DefaultrightHand;
                _skeletons = new List<SkeletonData>();
                _runtime = new Runtime();

                _runtime.SkeletonFrameReady += RuntimeSkeletonFrameReady;
                _runtime.VideoFrameReady += RuntimeVideoFrameReady;
                **_runtime.Initialize(RuntimeOptions.UseSkeletalTracking | RuntimeOptions.UseColor);**
                _runtime.VideoStream.Open(ImageStreamType.Video, 2, ImageResolution.Resolution640x480, ImageType.Color);
                Messenger.Default.Register<CommandMessage>(this, ProcessSpeechCommand);
                SpeechController.Initialize();
                //IsTracking = true;
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:08:23.493

您的 Kinect 未连接到您的 PC：[http ://social.msdn.microsoft.com/Forums/en-CA/kinectsdknuiapi/thread/2e5c176d-4b84-4749-b010-5e1f7fd14bd1](http://social.msdn.microsoft.com/Forums/en-CA/kinectsdknuiapi/thread/2e5c176d-4b84-4749-b010-5e1f7fd14bd1)

# user-interface - Prolog 中的用户界面

> ID：10645763
> 
> 赞同：0
> 
> 时间：2012-05-18T01:51:10.290
> 
> 标签：user-interface, prolog

我最近开始使用 Prolog 进行编程，发现这种语言非常枯燥。有没有一种方法，在建立事实和规则的数据库之后，我们可以将它与用 PHP 或任何其他语言编写的网页接口，以便从网页触发查询，并在知道响应后给出它回到网页。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T05:56:48.313

如果您使用 ECLiPSe 作为 Prolog 系统，那么您可以使用 Andrea Montemaggio[在 PHP 和 ECliPSe-CLP 之间的通信层](https://code.google.com/p/php-eclipseclp/)。[或者您可以使用 ECLiPSe 的http-server 库](http://www.eclipseclp.org/doc/bips/lib/http_server/index.html)编写自己的 http 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T06:19:26.323

看看[SWI-Prolog HTTP 支持](http://www.swi-prolog.org/pldoc/package/http.html)；可能会派上用场。

# c++ - C++ 在类中使用函数时出错

> ID：10645773
> 
> 赞同：0
> 
> 时间：2012-05-18T01:52:50.897
> 
> 标签：c++, class, function, header, void

我不知道为什么会出现此错误：“未声明函数”。我仍然是编程的新手，但我正在努力学习它！所以这是我的代码，如果你能帮助我，我会非常感激：主要：

```
#include <iostream>
#include <vector>
#include "szovegkezelo.h"
using namespace std;

int main()
{
    string sz;

    beolvas(sz);
    kiir(sz);

    return 0;
} 
```

标题：

```
#ifndef SZOVEGKEZELO_H_INCLUDED
#define SZOVEGKEZELO_H_INCLUDED

#include <iostream>

using namespace std;

class szovegkezelo {
protected:
    string sz;

public:szovegkezelo
    void beolvas(string &sz);
    void kiir(string t);

};

#endif // SZOVEGKEZELO_H_INCLUDED 
```

cp:

```
#include "szovegkezelo.h"
#include <iostream>

void szovegkezelo::beolvas(string &sz)
{

    getline(cin, sz);

}
void szovegkezelo::kiir(string t)
{
     cout << "a beadott szoveg: " << t << endl;
     cout << "a string hossza: " << t.size() << endl;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T02:04:34.503

从它的样子来看，您正试图从“main”调用一个名为“beolvas”的类函数（方法），但因为它属于一个类，所以不能这样调用它，您需要创建一个实例类并调用该实例上的方法，或者使函数静态并从类中调用它。

您的第一个选择是创建类的实例，然后像这样调用类上的方法：

```
int main()
{
    string sz;
    szovegkezelo szov;

    szov.beolvas(sz);
    svoz.kiir(sz);

    return 0;
} 
```

您的第二个选择是将您的类中的函数设为静态，这样它们就不需要调用该类的实例：

```
int main()
{
    string sz;

    szov::beolvas(sz);
    svoz::kiir(sz);

    return 0;
}

static void szovegkezelo::beolvas(string &sz)
{

    getline(cin, sz);

}
static void szovegkezelo::kiir(string t)
{
     cout << "a beadott szoveg: " << t << endl;
     cout << "a string hossza: " << t.size() << endl;
} 
```

自从我在 C++ 中做任何静态的事情以来已经有一段时间了，所以如果我在第二个选项中做错了什么，请纠正我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T02:07:16.163

几件事：

1）在 main 中，您尚未实例化 的对象，`szovegkezelo`并且您正在尝试调用`beolvas`. 编译器正在寻找一个自由函数`beolvas`，而您已声明`beolvas`为成员函数

2)`public:szovegkezelo`如果您正在寻找一个不执行任何操作的默认构造函数，那么如果您需要对默认构造执行特定操作，则不具有该行，否则将其声明为 `szovegkezelo()`在标题中。

`using namespace std`3）如评论中所述，放入头文件或任何文件都不是一个好习惯 `using namespace`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T02:07:45.580

*   您的`two or more data types...`错误来自在公共访问说明符之后滥用...某事...。

    改变这个：

    ```
    public:szovegkezelo 
    ```

    对此：

    ```
    public: 
    ```

    如果您尝试创建构造函数，则需要像任何其他函数一样声明它，减去返回类型。

* * *

*   发生您的另一个错误是因为此函数声明不正确。

* * *

*   除此之外，您需要先创建一个对象，然后才能调用该类的函数。每个对象都有自己的一组变量，函数可以处理这些变量。我会认真推荐阅读一本好的初学者 C++ OOP 书籍。

    在 main 的某个地方，您需要创建一个对象：

    ```
    szovegkezelo myObject; 
    ```

    然后，用它来调用函数：

    ```
    myObject.kiir (sz); 
    ```

* * *

*   最后，请注意您的数据成员通常应使用`private`访问说明符声明。`protected`与不继承自的普通类无关。

# java - 在 JTree 中的行之间添加垂直填充/空间？

> ID：10645774
> 
> 赞同：6
> 
> 时间：2012-05-18T01:53:21.110
> 
> 标签：java, swing, padding, nodes, jtree

是否可以在 JTree 的节点行之间添加一些空格？我正在为节点图标使用自定义图像，我猜图像比标准节点图标大，因此节点图标非常靠近。如果有一点分离会更好看。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T13:03:52.377

要在树节点之间添加**实际**间距，您必须修改 UI 并返回适当的 AbstractLayoutCache 后继（默认情况下，JTree 使用两个类，具体取决于行高值：FixedHeightLayoutCache 或 VariableHeightLayoutCache）。

在节点之间添加一些间距的最简单方法是修改渲染器，因此它会有一些额外的边框，例如：

```
public static void main ( String[] args )
{
    JFrame frame = new JFrame ();

    JTree tree = new JTree ();
    tree.setCellRenderer ( new DefaultTreeCellRenderer ()
    {
        private Border border = BorderFactory.createEmptyBorder ( 4, 4, 4, 4 );

        public Component getTreeCellRendererComponent ( JTree tree, Object value, boolean sel,
                                                        boolean expanded, boolean leaf, int row,
                                                        boolean hasFocus )
        {
            JLabel label = ( JLabel ) super
                    .getTreeCellRendererComponent ( tree, value, sel, expanded, leaf, row,
                            hasFocus );
            label.setBorder ( border );
            return label;
        }
    } );
    frame.add ( tree );

    frame.pack ();
    frame.setLocationRelativeTo ( null );
    frame.setDefaultCloseOperation ( JFrame.EXIT_ON_CLOSE );
    frame.setVisible ( true );
} 
```

这仍然比仅设置静态行高（正如 Subs 在评论中提供给您的那样）要困难一些，但由于各种操作系统上可能存在不同的字体大小和样式，它会更好。因此，您不会在任何地方遇到尺寸问题。

顺便说一句，您还可以按照自己喜欢的方式更改节点选择表示，这样您甚至可以在视觉上伪造间距。

# delphi - 在这种情况下，为什么在调用 AviFileExit() 之前需要核对 IAviFile 指针？

> ID：10645775
> 
> 赞同：3
> 
> 时间：2012-05-18T01:54:05.773
> 
> 标签：delphi, access-violation, avi, vfw

我发现了一个 Stack Overflow 帖子，其中包含一个示例，展示了如何获取 AVI 文件的持续时间：

[获取 AVI 文件持续时间](https://stackoverflow.com/questions/1770078/getting-avi-file-duration)

我在我的 Delphi 6 应用程序中修改了它并创建了下面的代码。最初，我在调用 AviFileExit() 之前删除了核对 IAviFile 指针的行。但是当我这样做时，我在调用 AviFileExit() 时遇到了访问冲突。我恢复了线路，访问冲突消失了。

为什么在调用 AviFileExit() 之前需要核对 IAviFile 引用？这是内存泄漏吗？我认为正常的接口引用计数在这里可以正常工作，但显然不能。有没有另一种方法来消除错误，比如调用 AviStreamRelease() 之类的？

这是我的代码：

```
function getAviDurationSecs(theAviFilename: string): Extended;
var
    aviFileInfo : TAVIFILEINFOW;
    intfAviFile : IAVIFILE;
    framesPerSecond : Extended;
begin
    intfAviFile := nil;

    AVIFileInit;

    try
        // Open the AVI file.
        if AVIFileOpen(intfAviFile, PChar(theAviFilename), OF_READ, nil) <> AVIERR_OK then
            raise Exception.Create('(getAviDurationSecs) Error opening the AVI file: ' + theAviFilename);

        try
            // Get the AVI file information.
            if AVIFileInfoW(intfAviFile, aviFileInfo, sizeof(aviFileInfo))  <> AVIERR_OK then
                raise Exception.Create('(getAviDurationSecs) Unable to get file information record from the AVI file: ' + theAviFilename);

            // Zero divide protection.
            if aviFileInfo.dwScale < 1 then
                raise Exception.Create('(getAviDurationSecs) Invalid dwScale value found in the AVI file information record: ' + theAviFilename);

            // Calculate the frames per second.
            framesPerSecond := aviFileInfo.dwRate / aviFileInfo.dwScale;

            Result := aviFileInfo.dwLength  / framesPerSecond;
        finally
            AVIFileRelease(intfAviFile);
            // Commenting out the line below that nukes the IAviFile
            //  interface reference leads to an access violation when
            //  AVIFileExit() is called.
            Pointer(intfAviFile) := nil;
        end;
    finally
        AVIFileExit;
    end;
end; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T02:14:46.873

您必须手动清除变量，因为 Delphi 不知道`AVIFileRelease()`释放了该接口。 `AVIFileRelease()`没有`nil`为你设置变量，所以变量仍然有一个非零值。如果您不手动清除它，Delphi 将`Release()`在变量超出范围（调用**后**`AVIFileExit()`）并崩溃时尝试调用该变量。

该`IAVIFile`接口是一个`IUknown`后代，所以我不知道微软为什么`AVIFileRelease()`首先创建该功能。它会减少接口的引用计数并在计数降至零时执行清理。接口背后的实现可以简单地在内部处理，而不需要显式函数。所以这是微软的坏事。

# node.js - Node.js 和 express - 如何读取 cookie 但未定义

> ID：10645792
> 
> 赞同：20
> 
> 时间：2012-05-18T01:56:58.190
> 
> 标签：node.js, express

我使用以下内容使用 express 设置 cookie。

```
res.cookie('test', 'yes', { 
    expires: new Date(Date.now() + 365*2*24*60*60*1000), 
    httpOnly: true 
}); 
```

我正在使用中间件来尝试读取 cookie：

```
app.use(express.cookieParser());

var cookie_id = req.cookies.test; 
```

问题是 cookie_id 是未定义的，它会是“是”

```
Express server listening on port 8060 in development mode
TypeError: Cannot read property 'test' of undefined
    at /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/nodeServer/app.js:48:29
    at callbacks (/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/nodeServer/node_modules/express/lib/router/index.js:272:11)
    at param (/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/nodeServer/node_modules/express/lib/router/index.js:246:11)
    at pass (/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/nodeServer/node_modules/express/lib/router/index.js:253:5)
    at Router._dispatch (/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/nodeServer/node_modules/express/lib/router/index.js:280:4)
    at Object.handle (/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/nodeServer/node_modules/express/lib/router/index.js:45:10)
    at next (/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/nodeServer/node_modules/express/node_modules/connect/lib/http.js:204:15)
    at Object.methodOverride [as handle] (/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/nodeServer/node_modules/express/node_modules/connect/lib/middleware/methodOverride.js:35:5)
    at next (/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/nodeServer/node_modules/express/node_modules/connect/lib/http.js:204:15)
    at Object.bodyParser [as handle] (/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/nodeServer/node_modules/express/node_modules/connect/lib/middleware/bodyParser.js:88:61) 
```

我做错了什么？

```
Accept  text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding gzip, deflate
Accept-Language en-us,en;q=0.5
Connection  keep-alive
Cookie  test=yes
Host    127.0.0.1:8060
User-Agent  Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:12.0) Gecko/20100101 Firefox/12.0 
```

```
// Configuration
app.configure(function() {
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(app.router);
  app.use(express.static(__dirname + '/public'));
  app.use(express.cookieParser());
}); 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-18T08:35:15.563

`express.cookieParser()` **之前** 需要使用`app.router`；中间件*按顺序*运行，这意味着它甚至`cookieParser()`在您的路线执行之前永远不会到达。

尝试这个：

```
 app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser());
  app.use(app.router);
  app.use(express.static(__dirname + '/public')); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-01-02T12:58:39.057

大多数中间件（如 cookieParser）不再与 Express 捆绑，必须单独安装。

**安装 cookie 解析器**：

```
npm install cookie-parser 
```

**用法**

```
var express      = require('express')
var cookieParser = require('cookie-parser')

var app = express()
app.use(cookieParser()) 
```

[https://github.com/expressjs/cookie-parser](https://github.com/expressjs/cookie-parser)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-18T20:47:10.117

我通过`app.use(express.cookieParser());`在`app.router`.

# python - Flask SQLAlchemy 没有拾取更改的记录

> ID：10645793
> 
> 赞同：1
> 
> 时间：2012-05-18T01:57:12.410
> 
> 标签：python, flask-sqlalchemy

我看到 Flask-SQLAlchemy 出现了一些意外行为，但我不明白发生了什么：

如果我使用 MySQL Workbench 或 Sequel Pro 对记录进行更改，正在运行的应用程序（无论是在 Apache 上的 WSGI 下运行，还是从命令行运行）都不会接收到更改。如果我通过触摸 WSGI 文件或重新加载它（命令行）重新加载应用程序，我可以看到更改的记录。我已经通过`all()`在交互式 shell 中运行查询来验证这一点，它是相同的——在我退出 shell 并重新开始之前没有任何变化。我觉得我在这里遗漏了一些非常明显的东西——它是一个表，没有连接等——在 2.7.3 上运行 MySQL 5.5.19 和 SQLA 0.7.7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T04:03:07.927

您的应用程序的 SELECT 可能在其自己的事务/会话中，因此由另一个会话（例如 MySQL Workbench 连接）提交的更改对于您的 SELECT 尚不可见。您可以通过启用 mysql 常规日志或在 create_engine(...) 定义中设置“echo: false”来轻松验证它。您很有可能在 SET AUTOCOMMIT = 0 模式下启动 SQLAlchemy 会话，这需要显式提交或回滚（当您重新启动/重新加载时，Flask-SQLAlchemy 会自动为您完成）。尝试在 autocommit=true 模式下启动会话，或者在调用 SELECT 之前坚持显式提交/回滚。

# session - ServiceStack.SessionFeature 不可自定义

> ID：10645796
> 
> 赞同：1
> 
> 时间：2012-05-18T01:57:24.953
> 
> 标签：session, servicestack

一切都是可定制的，但 SessionFeature （也来自 IPlugin :) ）是强制性的。我想使用 MySessionFeature:IPlugin 但在 Controller,Attribute 中的任何地方......它被用作强类型。是设计使然还是别的什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T02:33:54.797

SessionFeature 包含有用的重载，并在响应上设置 ss-id、ss-pid 和 ss-opts cookie，这些 cookie 是 ServiceStack 中依赖 Session 像 IAuthSession/CustomUserSession 和身份验证一样工作的所有内容所需的。

您可以在没有 Authentication 的情况下注册 Session 插件，但是当您注册 Authentication 插件时，如果您还没有注册 Session 插件，它将自动注册。

# mysql - 选择时增加列

> ID：10645797
> 
> 赞同：2
> 
> 时间：2012-05-18T01:57:36.067
> 
> 标签：mysql, triggers

晚上，

我目前正在运行此查询：

```
SELECT `id`, `type`, `controller` FROM `urls` WHERE `url` = :url;
UPDATE `urls` SET `views` = `views` + 1 WHERE `url` = :url; 
```

我在加载页面并将视图列增加 1 时运行它。但是，我很想知道是否有一种方法（可能使用触发器之类的东西）可以自动增加视图列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T06:10:51.267

我找不到确切的重复项，但[Mysql PDO 中“RETURNING”子句的语法](https://stackoverflow.com/questions/2796244/syntax-for-returning-clause-in-mysql-pdo)和[Mysql 返回子句等效](https://stackoverflow.com/questions/9583353/mysql-returning-clause-equivalent)项可以为您提供所需的答案。

MySQL 没有等效的 Oracle 和 PostgreSQLs`returning into`子句。您必须使用两个单独的语句。

* * *

如果您希望进行大量更新，那么将视图数量保留在单独的表中*可能*会更好（有条件，可能不会），尤其是当您没有在查询中返回视图计数时。类似于以下内容：

```
insert into url_views values(url);

select `id`, `type`, `controller` from `urls` where `url` = :url; 
```

然后如果您需要查看次数：

```
select count(*)
  from url_views
where url = :url 
```

或使用 MySQLs[`insert ... select`语法](http://dev.mysql.com/doc/refman/5.5/en/insert-select.html)。

# python - logger.info(traceback.print_exc()) 出现在 python gui

> ID：10645798
> 
> 赞同：13
> 
> 时间：2012-05-18T01:57:50.367
> 
> 标签：python, logging

当我`logger.info(traceback.print_exc())` 在控制台而不是在日志文件中执行跟踪时，我`logger.propagate = False`也遇到了同样的问题

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-18T02:06:53.260

`print_exc`将堆栈跟踪打印到 stderr。

只需使用 exc_info=1 参数，它就会自动包含异常。

```
logging.exception("Exception") #or 
logging.error("exception ",exc_info=1) #or
logging.info("Exception has occured" ,exc_info=1) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-11-27T09:57:18.270

我正在使用 python 2.7，遗憾的是`exc_info=1`从来没有为我工作过，所以我不得不使用这个：

```
 import traceback
  ...

  log.debug(traceback.format_exc()) 
```

# c# - datagridview中的数据不显示C#？

> ID：10645799
> 
> 赞同：0
> 
> 时间：2012-05-18T01:57:52.530
> 
> 标签：c#, datagridview

我有一个字符串列表如下：

```
firstname midname lastname
aa        bbb     ccc
bb        lijb    hjhk 
```

我想在 datagridview 中显示。下面是我的代码：

```
 internal void add_names()
        {
             userInterface ui      = new userInterface();
             List_namez names      = new List_namez();  
             ui.lname.DataSource   = names.getnames().ToList();
             ui.ShowDialog();

        } 
```

我不确定为什么执行上述代码时我的列表没有显示。但是，当我尝试调试代码时，我发现 ui.lname.DataSource 数据就在那里。但它在 datagridview 中显示空白行。任何建议如何解决这个问题？？？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:36:05.753

取决于您对名称的定义。让我给你举个例子：

```
class Person
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public override string ToString( )
    {
        return "Person, name=" + FirstName + " Surname=" + LastName;
    }
}

...

public Form1( )
{
  InitializeComponent( );
  dataGridView1.RowsAdded += new DataGridViewRowsAddedEventHandler( dataGridView1_RowsAdded );
  dataGridView1.DataSource = new Person[]{ new Person{ FirstName= "Jarek", LastName= "Mitek"},
                                           new Person{ FirstName= "Tony", LastName= "Montana"}};
}

void dataGridView1_RowsAdded( object sender, DataGridViewRowsAddedEventArgs e )
{
  Console.WriteLine( "Rows added count: " + e.RowCount + " row index: " +e.RowIndex );
  Console.WriteLine( dataGridView1.Rows[ e.RowIndex ].DataBoundItem.ToString( ) );
} 
```

这将生成两列，每列的名称是 Person 类中的属性名称。这是最简单的方法。当数据添加到集合中时，您将获得显示您的调试行。这有帮助吗？

# android - 在指定时间和日期的 Android 通知

> ID：10645801
> 
> 赞同：0
> 
> 时间：2012-05-18T01:58:42.610
> 
> 标签：android, notifications

我希望我的应用程序提醒用户每周观看电视节目...是否可以每周在所需时间弹出通知？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:06:53.040

是的。设置您的日历以在问题的日期/时间进行提醒，然后将其设置为每周提醒。它是那里的一个选项。从网络版谷歌日历设置它可能更容易，但在手机上也同样简单。

# facebook - 如何在没有 api 的情况下自动发送 facebook 消息

> ID：10645804
> 
> 赞同：0
> 
> 时间：2012-05-18T01:58:52.550
> 
> 标签：facebook, message

伙计们

现在我知道如何在不使用 facebook api 的情况下发送消息，我可以使用 url 来填充 facebook 网站中的消息 textarea

www.facebook.com/messages/[user_id]?msg_prefill=XXX

但在这里我想知道如何自动发送此消息

四月，我找到了一种自动点击“发送”按钮的方法（在 html 文本中找到“发送”按钮并点击它），

但是现在 facebook 隐藏了这些 html 文本，所以我在 html 文本中找不到这个按钮。因此，任何人都可以提供一些方法或指向自动发送消息。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-19T12:11:51.637

使用浏览器中的控制台（通常是 F12 打开）firefox 控制台是最强大的，您的控制台应该有类似“元素检查”或类似的命令，使用此工具分析您想要的按钮，阅读您应该找到的代码像“点击”或类似的东西，在这之后你会发现一个java命令来按下按钮。无论如何要在没有程序员的情况下做这种事情，使用 selenium IDE，非常简单，仅适用于 firefox，您必须从 firefox 下载它作为附加组件。祝你好运！

# c# - 为什么在 linq to 实体中的 .ToList() 上耗时？

> ID：10645805
> 
> 赞同：1
> 
> 时间：2012-05-18T01:59:00.143
> 
> 标签：c#, asp.net-mvc, linq, linq-to-entities

我们有一个使用linq to entity的网站，最近发现速度很慢，经过故障排除，我发现每当我们使用linq to entity从数据库中搜索数据时，都会消耗非常多的CPU时间，比如`toList()`function。我知道这可能是因为我们在数据库中有大量数据导致响应缓慢，但我只是想知道是否还有其他可能导致此问题的原因？

我应该如何优化这些问题？以下是可能的原因：

1.  `ToList()`可能会加载所有对象的外来对象（外键），我怎样才能强制它只加载对象？

2.  我的连接池是否太小？

如果还有其他可能的原因，请告诉我，并为我指出解决此问题的正确方向。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T04:31:21.753

**在 Linq 中，查询在枚举查询时将**一系列操作的结果返回给源。

```
IQueryable<Customer> myQuery = ...

foreach(Customer c in myQuery)  //enumerating the query causes it to be executed
{

}

List<Customer> customers = myQuery.ToList();
  // ToList will enumerate the query, and put the results in a list.
  // enumerating the query causes it to be executed. 
```

执行查询需要一些东西（没有特定顺序）

*   从池中提取数据库连接。
*   查询由查询提供程序解释（在这种情况下，提供程序是 linq 到实体，解释是某种形式的 sql）
*   解释后的表格被传输到数据库，在那里它会做它所做的事情并返回数据对象。
*   必须生成一些方法来将传入的数据对象转换为所需的查询输出。
*   数据库连接返回到池中。
*   所需的查询输出可能会在返回到您的代码之前对其进行状态跟踪。

另外，数据库还有几个步骤，这里从查询sql server的角度列出：

*   接收查询文本并针对现有计划的查询计划缓存进行检查。
*   如果不存在计划，则由查询优化器创建一个新计划并将其放入计划缓存中。
*   执行查询计划 - IO/locks/CPU/Memory - 其中任何一个都可能是瓶颈
*   返回查询结果 - 网络可能是瓶颈，特别是在结果集很大的情况下。

所以 - 要找出您的查询问题出在哪里，您需要开始测量。我将按照我检查它们的顺序对这些目标进行排序。这不是一个完整的列表。

1.  获取查询的翻译后的 sql 文本。您可以为此使用 sql server profiler。您可以使用调试器。有很多方法可以解决它。确保查询文本返回您对对象的要求，不多不少。确保查询的表符合您的期望。运行查询几次。

2.  查看结果集。这是合理的还是我们正在查看 500 Gigs 的结果？当不需要整张桌子时，是否查询了整张桌子？是否意外生成了笛卡尔结果？

3.  获取查询的执行计划（在sql studio中，点击`show estimated execution plan`按钮）。查询是否使用您期望的索引？该计划是否看起来很奇怪（可能来自缓存的错误计划）？查询是否按照您期望的顺序在表上工作，并以您期望的方式执行嵌套/合并/散列连接？当查询不值得时（这是错误索引/ IO TONS 的标志），是否有并行化开始？

4.  测量查询的IO。（在 sql server 中，发出 SET STATISTICS IO ON）。检查每个表的逻辑 IO。哪张桌子脱颖而出？再次，查找错误的表访问顺序或可以支持查询的索引。

    如果您已经做到了这一点，那么您可能已经发现并解决了问题。不过我会继续，以防你没有。

5.  比较查询的执行时间和枚举的执行时间。如果存在很大差异，则可能是解释数据对象的代码很慢或者生成速度很慢。也可能是查询的翻译需要一段时间。这些都是需要解决的棘手问题（在 LinqToSql 中，我们使用编译查询来解决它们）。

6.  测量运行代码的机器的内存和 CPU。如果您被限制在那里，请使用代码分析器或内存分析器来识别和解决问题。

7.  查看机器上的网络统计信息，特别是您可能希望使用 TCPView 查看机器上的 TCP 套接字连接。套接字资源可能被误用（例如一分钟打开和关闭数千个）。

8.  检查数据库中其他连接持有的锁。

我想这就够了。希望我没有忘记任何明显的事情要检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T08:19:23.820

您可能会在 MSDN 上的[性能注意事项（实体框架）](http://msdn.microsoft.com/en-us/library/cc853327.aspx)中找到问题的解决方案。尤其是

> ## 返回正确的数据量
> 
> 在某些情况下，使用 Include 方法指定查询路径要快得多，因为它需要更少的数据库往返。但是，在其他情况下，额外往返数据库以加载相关对象可能会更快，因为具有较少连接的更简单查询会导致数据冗余较少。因此，我们建议您测试各种检索相关对象的方法的性能。有关详细信息，请参阅[加载相关对象](http://msdn.microsoft.com/en-us/library/bb896272.aspx)。
> 
> 为避免在单个查询中返回过多数据，请考虑将查询结果分页到更易于管理的组中。有关详细信息，请参阅[如何：浏览查询结果](http://msdn.microsoft.com/en-us/library/bb738702.aspx)。

# sql - SQL 分组查询

> ID：10645812
> 
> 赞同：1
> 
> 时间：2012-05-18T01:59:41.507
> 
> 标签：sql, oracle, group-by, union-all

我在两个结果集上有一个 UNION ALL。这导致如下所示。

总稳定

```
FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL
Brown          Dave           1234        500.00
Brown          Dave           1234        300.00
Smith          Frank          4321        123.00
Smith          Frank          4321        456.00 
```

我运行以下查询...

```
SELECT TOTALSTABLE.FAMILYNAME,
  TOTALSTABLE.FIRSTNAME,
  TOTALSTABLE.NUMBER,
  SUM(TOTALSTABLE.TOTAL) COMBINEDTOTAL
FROM TOTALSTABLE
GROUP BY TOTALSTABLE.FAMILYNAME,
  TOTALSTABLE.FIRSTNAME,
  TOTALSTABLE.NUMBER 
```

这给了我类似...

```
FAMILYNAME-----FIRSTNAME------NUMBER------COMBINEDTOTAL
Brown          Dave           1234        800.00
Smith          Frank          4321        579.00 
```

这就是我需要的。但是，我需要在尝试执行 UNION ALL 的结果中添加一个为空的附加列。

例子：

T1

```
FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL-------DATE
Brown          Dave           1234        500.00      01/01/2001
Smith          Frank          4321        123.00      01/01/2001 
```

T2

```
FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL-------DATE
Brown          Dave           1234        300.00      NULL
Smith          Frank          4321        456.00      NULL 
```

组合（联合所有）

```
FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL-------DATE
Brown          Dave           1234        500.00      01/01/2001
Brown          Dave           1234        300.00      NULL
Smith          Frank          4321        123.00      01/01/2001
Smith          Frank          4321        456.00      NULL 
```

我需要像第一个示例中那样使用不为空的日期来获得总和。

期望结果的示例。

```
FAMILYNAME-----FIRSTNAME------NUMBER------COMBINEDTOTAL----DATE
Brown          Dave           1234        800.00           01/01/2001
Smith          Frank          4321        579.00           01/01/2001 
```

谁能告诉我我需要在这里做什么？干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:03:38.063

听起来你只是想要

```
SELECT familyName,
       firstName,
       number,
       SUM(total) combinedTotal,
       MAX(date) date
  FROM (<<union all query>>)
 GROUP BY familyName,
          firstName, 
          number 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-18T02:19:00.410

如您所述，您可以尝试遵循代码

```
SELECT * FROM 
(SELECT c1, c2, c3 FROM T1
UNION ALL
SELECT c1, c2, c3 FROM T2 
) T
WHERE T.c3 IS NOT NULL
GROUP BY T.c1, T.c2, T.c3 
```

# winsock - Winsock2.h 在网络模型的哪一层（例如 OSI）发送返回？

> ID：10645814
> 
> 赞同：0
> 
> 时间：2012-05-18T01:59:57.513
> 
> 标签：winsock

我正在查看[send()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740149%28v=vs.85%29.aspx)的阻塞调用，并查看是否有一种方法可以测量在函数中花费的时间，同时能够知道在此期间发生了什么事件，以便可以对连接速度等进行定性分析.

有了这个，首先要知道的是函数在哪一层返回成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:15:49.070

如果有足够的缓冲区空间可用于保存数据*并且*路由表仍然显示将数据包路由到对等方的方式，`send()`API 将几乎立即返回成功。（它实际上*不必*能够到达对等点——只是机器必须有一个可用的下一跳......）如果它需要等待缓冲区空间释放，它会。[（使用Wireshark](http://en.wikipedia.org/wiki/Wireshark)应该可以很容易地观察在线上被确认或发送的数据。）

 **顺便说一句，OSI 层并不完美地应用于 TCP/IP 协议族。第 1 层和第 2 层非常吻合，第 3 层大致是 IP 路由，第 4 层大致是 TCP、UDP、SCTP、ICMP 等。但是第 5、6、7 层没有真正的类似物——基于 TLS 的 SMTP 可能被认为是第 7 层，或者 SMTP 是第 7 层，而 TLS 是第 6 层……这一切很快就变得非常模糊。

只谈论您感兴趣的 TCP/IP 协议栈中的特定层会更容易。`send()`与流、数据报和原始套接字一起使用，因此它可以跨越堆栈的多个层——您可以使用它来发送 TCP、UDP、SCTP 或 ICMP 数据包，或者如果您愿意，可以直接在线上涂鸦。**

# r - 与 as.POSIXct 相比，为什么 lubridate 函数这么慢？

> ID：10645815
> 
> 赞同：25
> 
> 时间：2012-05-18T01:59:58.717
> 
> 标签：r, lubridate

正如标题一样。为什么 lubridate 功能这么慢？

```
library(lubridate)
library(microbenchmark)

Dates <- sample(c(dates = format(seq(ISOdate(2010,1,1), by='day', length=365), format='%d-%m-%Y')), 50000, replace = TRUE)

microbenchmark(as.POSIXct(Dates, format = "%d-%b-%Y %H:%M:%S", tz = "GMT"), times = 100)
microbenchmark(dmy(Dates, tz ="GMT"), times = 100)

Unit: milliseconds
expr                                                            min         lq          median      uq          max
1 as.POSIXct(Dates, format = "%d-%b-%Y %H:%M:%S", tz = "GMT")   103.1902    104.3247    108.675     109.2632    149.871
2 dmy(Dates, tz = "GMT")                                        184.4871    194.1504    197.8422    214.3771    268.4911 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-05-18T13:43:34.640

For the same reason cars are slow in comparison to [riding on top of rockets](http://www.youtube.com/watch?v=R41U6-jeJHM). The added ease of use and safety make cars much slower than a rocket but you're less likely to get blown up and it's easier to start, steer, and brake a car. However, in the right situation (e.g., I need to get to the moon) the rocket is the right tool for the job. Now if someone invented a car with a rocket strapped to the roof we'd have something.

Start with looking at what `dmy` is doing and you'll see the difference for the speed (by the way from your bechmarks I wouldn't say that `lubridate` is that much slower as these are in milliseconds):

**`dmy` #type this into the command line and you get:**

```
>dmy
function (..., quiet = FALSE, tz = "UTC") 
{
    dates <- unlist(list(...))
    parse_date(num_to_date(dates), make_format("dmy"), quiet = quiet, 
        tz = tz)
}
<environment: namespace:lubridate> 
```

Right away I see `parse_date` and `num_to_date` and `make_format`. Makes one wonder what all these guys are. Let's see:

**`parse_date`**

```
> parse_date
function (x, formats, quiet = FALSE, seps = find_separator(x), 
    tz = "UTC") 
{
    fmt <- guess_format(head(x, 100), formats, seps, quiet)
    parsed <- as.POSIXct(strptime(x, fmt, tz = tz))
    if (length(x) > 2 & !quiet) 
        message("Using date format ", fmt, ".")
    failed <- sum(is.na(parsed)) - sum(is.na(x))
    if (failed > 0) {
        message(failed, " failed to parse.")
    }
    parsed
}
<environment: namespace:lubridate> 
```

**`num_to_date`**

```
> getAnywhere(num_to_date)
A single object matching ‘num_to_date’ was found
It was found in the following places
  namespace:lubridate
with value

function (x) 
{
    if (is.numeric(x)) {
        x <- as.character(x)
        x <- paste(ifelse(nchar(x)%%2 == 1, "0", ""), x, sep = "")
    }
    x
}
<environment: namespace:lubridate> 
```

**`make_format`**

```
> getAnywhere(make_format)
A single object matching ‘make_format’ was found
It was found in the following places
  namespace:lubridate
with value

function (order) 
{
    order <- strsplit(order, "")[[1]]
    formats <- list(d = "%d", m = c("%m", "%b"), y = c("%y", 
        "%Y"))[order]
    grid <- expand.grid(formats, KEEP.OUT.ATTRS = FALSE, stringsAsFactors = FALSE)
    lapply(1:nrow(grid), function(i) unname(unlist(grid[i, ])))
}
<environment: namespace:lubridate> 
```

Wow we got `strsplit-ting`, `expand-ing.grid-s`, `paste-ing`, `ifelse-ing`, `unname-ing` etc. plus a Whole Lotta Error Checking Going On (play on the Zep song). So what we have here is some nice syntactic sugar. Mmmmm tasty but it comes with a price, speed.

**Compare that to** `as.POSIXct`:

```
getAnywhere(as.POSIXct)  #tells us to use methods to see the business
methods('as.POSIXct')    #tells us all the business
as.POSIXct.date          #what I believe your code is using (I don't use dates though) 
```

There's a lot more Internal coding and less error checking going on with `as.POSIXct` So you have to ask do I want ease and safety or speed and power? Depends on the job.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-04-19T17:07:41.507

@Tyler 的回答是正确的。这里有一些更多信息*，包括让 lubridate 更快的提示*- 来自帮助文件：

> “ Lubridate 有一个内置的非常快的 POSIX 解析器，从 Simon Urbanek 的 fasttime 包移植。这个功能是可选的，可以通过选项激活（lubridate.fasttime = TRUE）。Lubridate 将自动检测 POSIX 字符串并改用快速解析器默认的 strptime 实用程序。"

# c#-4.0 - 在 Word Addin throws Collection 中动态添加 RibbonButtons 是只读的

> ID：10645822
> 
> 赞同：3
> 
> 时间：2012-05-18T02:02:38.863
> 
> 标签：c#-4.0, ms-word, office-interop, office-automation

我对 Word 插件相当陌生，并尝试添加功能区组。对于每个 RibbonGroup，我动态添加 RibbonMenu，然后将 RibbonButtons 添加到组内的菜单中。

我完成了艰苦的工作，看起来还不错，但是每当我访问任何收藏时

例如：group1.Items.add(new RibbonButton()); 它让我说 Collection 是只读的。

但是当我调试 Collection 的 IsReadOnly 标志设置为 False 时，这清楚地表明 Collection 不是只读的？

我错过了什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T18:52:23.573

加载功能区后，集合将变为只读。

要动态修改 Ribbon 控件，需要在 Ribbon 构造函数中进行。

请参阅[http://msdn.microsoft.com/en-us/library/bb608623.aspx#SettingReadOnlyProperties](http://msdn.microsoft.com/en-us/library/bb608623.aspx#SettingReadOnlyProperties)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T08:48:13.993

您是否要向 RibbonMenu 或 RibbonGroup 添加按钮？在您的描述中，您说过要向菜单添加按钮，但您引用的示例是尝试向功能区组添加按钮[我假设*group1*是组而不是菜单！]。

您应该能够向 RibbonMenu 添加按钮，但如果您想要的是 RibbonGroup，那么您就不走运了。
这是 RibbonGroup 中 Items 属性的代码注释：

> ```
> // Summary:
> //     Gets the controls in the group.
> //
> // Returns:
> //     The collection of controls in the group.
> //
> // Exceptions:
> //   System.InvalidOperationException:
> //     You try to add, remove, or replace a Microsoft.Office.Tools.Ribbon.RibbonControl
> //     after the Ribbon is loaded.
> IList<RibbonControl> Items { get; } 
> ```

这就是您收到错误的原因，这也是集合的 IsReadOnly 属性设置为 false 的原因。
Designer 在创建功能区时需要能够修改 RibbonGroup 中的项目，但是一旦加载，您就无法对其进行任何修改。

**注意：**如果您想在运行中向 RibbonMenu 添加按钮，请在 RibbonMenu 项目属性窗口中将*Dynamic*设置为 True（或者您可以将其放入 Designer 代码中），否则您将再次遇到相同的异常。

# linux - shmget() 返回带有 IPC_CREAT 的 ENOENT

> ID：10645823
> 
> 赞同：1
> 
> 时间：2012-05-18T02:02:39.220
> 
> 标签：linux, memory, pthreads, mutex, shared

我`shmget()`用来分配一个共享内存段，然后我用它`pthread_mutex_init()`来创建进程之间共享的互斥锁。通常，这可以按预期工作。不过，偶尔`shmget()`还会回来`ENOENT`。阅读手册页，这应该只发生在`shmflg`不包含的情况`IPC_CREAT`下，但我包括在内。这是我的代码的一个片段：

```
shmid_ = shmget( MYLOCK_KEY_ID, sizeof(pthread_mutex_t), IPC_CREAT | IPC_EXCL | 0666 );
if ( errno == ENOENT ) {
    // This should never occur since IPC_CREAT was specified
    std::cerr
       << "shmget() returned ENOENT (it thinks IPC_CREAT wasn't  specified).\n"
       << "This seems to be a bug in shmget()?" << std::endl;
    exit(1);
} 
```

我完全不知道会发生什么。我已经在几个系统（Linux 内核 2.6.32 和 3.3.5）上尝试过这个，但都表现出相同的行为。目前，当我获得这种故障模式时，我只是重复这个过程，它通常可以工作。但这似乎有点笨拙，我不知道这是一个错误`shmget()`还是我只是做错了什么。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:16:36.483

您的 if 语句没有检查返回值 - 手册页说检查 shmid_ 是否为 -1，然后检查 errno。

```
RETURN VALUE 
A valid segment identifier, shmid, is returned on success, -1 on error. 
```

您正在做的只是检查 errno - 在对其他一些失败的函数进行其他调用之后，它可能是 ENOENT 。

# android - 如何更改 FloatBuffer 的内容，保持性能？

> ID：10645826
> 
> 赞同：7
> 
> 时间：2012-05-18T02:02:50.653
> 
> 标签：android, opengl-es, floatbuffer

我试过使用

```
floatbuffer.put(float[]); 
```

但是当我处理 200 多个方块时，所有方块都有不同的纹理坐标，每帧都会更新，我的 fps 急剧下降，游戏变得太远而无法流畅。

y 认为 badlogicgames.com 上提到的方法，关于，而不是使用 floatbuffer，使用 intbuffer，但是，是同一件事，在缓冲区的“放置”方法时等于慢。

那么，我怎样才能以最佳性能更新我所有的浮动缓冲区呢？

编辑：我已经解决了我的问题，“put”方法本身并不慢，问题是当为每个浮点缓冲区初始化一个新的浮点数时，而不是那样，我只是更改浮点数组中包含的每个元素的值避免了许多 GC 活动.. 我认为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T02:17:20.463

有很多方法可以提高性能。简而言之，这里有一些：

**1) 初始化浮动缓冲区并在每一帧中应用一个变换：** - 如果您的方块在屏幕上移动，请将它们放在浮动缓冲区中一次，然后对每个正方形应用单独的矩阵变换。在这种方法中，您填充一次浮动缓冲区，然后每轮更新一次转换。

**2) 只在浮动缓冲区中放置唯一的形状**- 如果您的任何正方形彼此重复，则每帧调用相同的缓冲区以节省内存。

**3) 使用顶点缓冲区对象和索引缓冲区对象**- 听起来您可能已经这样做了，但是将数据存储在顶点缓冲区中，并使用数组的索引调用顶点。

如果您仍然遇到问题，我建议您查看本教程： http: [//www.learnopengles.com/android-lesson-one-getting-started/](http://www.learnopengles.com/android-lesson-one-getting-started/)

# android - 我们有方法在不同的手机中显示不同的视图吗

> ID：10645829
> 
> 赞同：0
> 
> 时间：2012-05-18T02:03:33.730
> 
> 标签：android, gridview

我有一台平板电脑和一部手机。平板电脑能正常显示2*3，手机能正常显示2*2吗？该活动仅包含一个网格视图。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:39:51.487

你的问题不清楚。有些片段可用于为您的应用程序制作/运行许多不同大小的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T04:04:56.530

您可以使用一些代码获取屏幕英寸。所以你可以分开标签和电话。

```
String inputSystem;
inputSystem = android.os.Build.ID;
Log.d("hai",inputSystem);
Display display = getWindowManager().getDefaultDisplay(); 
int width = display.getWidth();  // deprecated
int height = display.getHeight();  // deprecated
Log.d("hai",width+"");
Log.d("hai",height+"");
DisplayMetrics dm = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(dm);
double x = Math.pow(width/dm.xdpi,2);
double y = Math.pow(height/dm.ydpi,2);
double screenInches = Math.sqrt(x+y);
Log.d("hai","Screen inches : " + screenInches+""); 
```

# iphone - UIButton - 如何让它播放声音

> ID：10645839
> 
> 赞同：-2
> 
> 时间：2012-05-18T02:05:26.660
> 
> 标签：iphone, objective-c, ios5, xcode4.3

我在笔尖（xib）中有一个 UIButton，它喜欢在触摸时播放声音，需要遵循什么协议才能实现这一点？

** 大修问题** 在 Stack Overflow 上的这段时间里，我学到了很多东西，不仅仅是关于我通常需要帮助的内容（Objective-C，xCode），还有 Stack Overflow 的工作原理。我发现它提供了大量的信息和支持，并且我已经研究过我之前是如何提出这个问题的，但它完全没有任何意义。为了帮助未来的用户，我以其他人可以理解的方式编辑了我最初要求的内容，就像下面的 Naveen 所做的那样。道歉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T08:06:49.607

添加这个框架

```
AudioToolBox framework 
```

包含这个头文件 .h 文件

```
#include <AudioToolbox/AudioToolbox.h>
CFURLRef        soundFileURLRef;
SystemSoundID   soundFileObject; 
```

在 viewdidLoad 中添加此代码

```
NSURL *tapSound   = [[NSBundle mainBundle] URLForResource: @"Voice035"
                                            withExtension: @"amr"];

    // Store the URL as a CFURLRef instance
self.soundFileURLRef = (CFURLRef) [tapSound retain];

    // Create a system sound object representing the sound file.
AudioServicesCreateSystemSoundID (
                                  soundFileURLRef,
                                  &soundFileObject
                                  ); 
```

在按钮点击时，调用此方法

```
 AudioServicesPlayAlertSound (soundFileObject); 
```

在 dealloc 中释放

```
AudioServicesDisposeSystemSoundID (soundFileObject);
CFRelease (soundFileURLRef); 
```

欲了解更多信息：http: [//developer.apple.com/library/ios/#documentation/AudioToolbox/Reference/SystemSoundServicesReference/Reference/reference.html#//apple_ref/c/func/AudioServicesCreateSystemSoundID](http://developer.apple.com/library/ios/#documentation/AudioToolbox/Reference/SystemSoundServicesReference/Reference/reference.html#//apple_ref/c/func/AudioServicesCreateSystemSoundID)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T03:27:20.097

我想说，创建一个“观察者”类来播放所有按钮都连接到的声音。我将在下面举一个例子，它是一个单例类。它是一时兴起写的，没有经过测试，但会给你一个想法。

//SoundObserver.h

```
#include <AVFoundation/AVFoundation.h>

@interface SoundObserver {

    AVAudioPlayer *audioPlayer;
}
-(void)playSound;
+(SoundObserver*)sharedInstance;

@property (nonatomic, retain) AVAudioPlayer *audioPlayer;

@end

//SoundObserver.m

static SoundObserver *instance = nil;

@implementation SoundObserver

-(id)init {

    self = [super init];

    if(self) {

  //Get path to file.
  NSString *filePath = [[NSBundle mainBundle] pathForResource:@"sound"
                                                       ofType:@"wav"];

  // filePath to URL
  NSURL *fileURL = [[NSURL alloc] initFileURLWithPath:filePath];

  //Initialize the AVAudioPlayer.
  self.audioPlayer = [[AVAudioPlayer alloc]
                           initWithContentsOfURL:fileURL error:nil];

  // Preloads buffer and prepare for use.
  [self.audioPlayer prepareToPlay];

  [filePath release];
  [fileURL release];

    }

}

+(SoundObserver*)sharedInstance {

        @synchronized(self) {

        if (instance == nil)

            instance = [[self alloc] init];
    }

    return instance;
}

-(void)playSound {

    //make sure the audio resets to beginning each activation.

    [self.audioPlayer play];
}

-(void)dealloc {

    //Clean up
    [self.audioPlayer release];
    self.audioPlayer = nil;
    [super dealloc];
}

// User example.

In applicationDidFinishLaunching:

    [SoundObserver sharedInstance];

From here you can connect all buttons to the same function, or call it from anywhere in the App that #import's SoundObserver.h

-(IBOutlet)buttonClick:(id)sender {

    [[SoundObserver sharedInstance] playSound];
} 
```

# java - Spring 3 请求处理程序：何时返回值，何时不返回，何时重定向？

> ID：10645843
> 
> 赞同：0
> 
> 时间：2012-05-18T02:06:00.900
> 
> 标签：java, forms, spring, return, illegalstateexception

我正在学习春天。到目前为止，我已经编写了一些 Controller 类，并在这些控制器中编写了一些 RequestHandler 方法。我认为我没有完全理解我的代码所基于的一些示例，因为我似乎莫名其妙地得到了 IllegalStateExceptions。

我在谷歌搜索中发现了一些 RequestHandlers 的例子，

```
some return a String so that the DispatcherServlet can route it to a view ( JSP )
some return a String as above, but with a "redirect:" or "forward:" prefix
some just return a Model object 
```

我的直觉是，我对返回的内容、时间和原因缺乏了解是我的 IllegalStateExceptions 背后的原因。

如果 RequestHandler 正在向视图 (jsp) 发送数据，是否应该在 return 语句中使用“redirect:”前缀？是的？不？为什么？为什么不？

如果这在我错过的大量文档的角落中得到了解释，请随时通过 URL 向我发送 RTFM

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T07:28:00.063

**重定向：**和**转发：**就像我们在 jsp-servlet 中执行简单的**requestDispatcher.sendRedirect**和**requestDispatcher.forward一样。**

Spring 刚刚提供了更好的方法来做同样的事情，只需将*redirect*或*forward*关键字添加到您的字符串。

如需进一步了解，请参阅以下网址。

[Spring MVC 参考](http://static.springsource.org/spring/docs/1.2.x/reference/mvc.html)

并参考主题号。**13.5.3.2。**和**13.5.3.3。**

希望这对您有所帮助。

干杯。

# css - 自定义 google+ 关注按钮

> ID：10645845
> 
> 赞同：1
> 
> 时间：2012-05-18T02:06:02.723
> 
> 标签：css, google-plus

我使用以下代码在我的网站上添加了一个 google + followbutton：

```
 <g:plus href="https://plus.google.com/100827824854155199322" rel="publisher" width="250" height="69" theme="light"> 
```

我需要它的背景来匹配它所在容器的背景，但我不确定如何。我尝试查看它正在使用哪些类，然后使用 css 将它们设置为我的 bg 颜色，但它不起作用。

[您可以在我的网站http://www.beatmushroom.com/2012/05/phaeleh-afterglow-feat-soundmouse-akira.html#more](http://www.beatmushroom.com/2012/05/phaeleh-afterglow-feat-soundmouse-akira.html#more)上看到我的意思

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T02:20:56.983

有一个[开放的功能请求](https://code.google.com/p/google-plus-platform/issues/detail?id=162)允许自定义徽章背景颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:52:22.297

在使用 Google Chrome -> Inspect Element 并在您的网站上坐立不安之后，

我认为这将是您的解决方案

```
.yeb{ 
   background-color:<insert your colour code>;
} 
```

这将进入您的 css 文件。

# javascript - 使用不同的参数在循环中调用 jQuery 函数

> ID：10645847
> 
> 赞同：0
> 
> 时间：2012-05-18T02:06:15.633
> 
> 标签：javascript, jquery, asp.net-mvc-2, carousel, jcarousel

我正在尝试按照[此](http://www.egrappler.com/jquery-contentthumbnail-slder-v2-0-jscarousel-v2-0/)示例在一个页面中创建多个轮播。
我在 foreach 循环中创建轮播，并为每个轮播分配名称 c0、c1、c2 等。（每个轮播都是 a `<div>`）
现在，为了根据示例运行脚本，我应该运行每个轮播分别。
例如：

```
<script type="text/javascript">
    $(document).ready(function() {

        $('#c0').jsCarousel({ onthumbnailclick: function(src) { alert(src); }, autoscroll: true, masked: false, itemstodisplay: 3, orientation: 'v' });
        $('#c1').jsCarousel({ onthumbnailclick: function(src) { alert(src); }, autoscroll: false, masked: false, itemstodisplay: 5, orientation: 'h' });
        $('#c2').jsCarousel({ onthumbnailclick: function(src) { alert(src); }, autoscroll: true, masked: true, itemstodisplay: 5, orientation: 'h' });

    });       

</script> 
```

由于我的轮播是在 foreach 循环中创建的，我不知道我将拥有多少个，所以我尝试在 for 循环中调用该函数：

```
 for (int i = 0; i < counter; i++)
    {
        string cNum = "#c" + i.ToString();%>
        <script type="text/javascript">
            $(document).ready(function() {
                $(cNum).jsCarousel({ onthumbnailclick: function(src) { alert(src); }, autoscroll: true });
            });
        </script>
   <%} %> 
```

我检查了一下，这些`cNum`值没问题，它得到了 #c0、#c1 等值，但它无法将其识别为最初存在的 '#c0' 等值。

如何在函数中插入动态轮播名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:30:27.913

您的代码中的问题是`cNum`动态生成的 JavaScript 部分内部没有被解释为 ASP 变量。你可以用类似的东西来解决这个问题`$('<% cNum %>')`（还要注意 JavaScript 引号，没有 get 你会得到`$(#c0)`，这是错误的）。

但是，您的方法是错误的，请尽量避免像这样混合服务器/客户端代码。

正如 aquinas 已经指出的那样，最好的解决方案是向 div 添加一个类：

HTML：

```
<div class="carousel"> 
```

JavaScript：

```
$('div.carousel').jsCarousel({ ... }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:16:57.170

而不是这样做，只需给每个 div 一个类。像这样：

```
<div class="someClassThatIKnowIsACarousel"> 
```

然后你不需要循环：

```
$(".someClassThatIKnowIsACarousel").jsCarousel({ onthumbnailclick: function(src) { alert(src); }, autoscroll: true }); 
```

# javascript - 使用 CSS 或 JavaScript 的橡皮擦效果

> ID：10645849
> 
> 赞同：5
> 
> 时间：2012-05-18T02:06:25.907
> 
> 标签：javascript, css

有没有人知道任何css或javascript会产生逐渐擦除网页上文本的效果，就像黑板橡皮擦会擦除黑板上的文字一样？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-18T11:08:33.700

我做了一个小演示，它使用了渐变、盒子阴影和关键帧动画。[代码如下，您可以在http://dabblet.com/gist/2722829](http://dabblet.com/gist/2722829)看到它的运行情况

```
.parent {
  width: 400px;
  margin: 125px auto;
  padding: 8px;
  overflow: hidden;
  position: relative;
}
.eraser {
  left:-30%;
  top: 8px;
  height: 100%;
  width: 130%;
  border-radius: 135px/65px;
  box-shadow: 0 0 100px 50px rgba(255, 255, 255, .8);
  display: block;
  position: absolute;
  z-index: 2;
  background: radial-gradient(#fff, rgba(255, 255, 255, .95));
  animation: erase 4s ease-out;
}
@keyframes erase {
  from {left: -170%;}
  to {left: -30%;}
}
```

```
<div class="parent">
  <p>Biscuit danish icing halvah jelly beans jelly beans powder liquorice sugar plum. 
  Pie marzipan toffee donut chocolate dragée topping caramels. 
  Applicake wafer donut soufflé. Icing danish dessert icing carrot cake soufflé apple pie.
  </p>
  <div class="eraser"></div>
</div>
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T02:13:28.570

您可以使用`canvas`. 看：

*   [html5画布中的“擦除”](https://stackoverflow.com/questions/3328906/erasing-in-html5-canvas)
*   [HTML5 画布橡皮擦](https://stackoverflow.com/questions/3790211/html5-canvas-eraser)

只能在此处看到对文本的模拟退格效果：http: [//demos.frnzzz.com/typing/](http://demos.frnzzz.com/typing/)

自由擦除页面上的任何 DOM 元素是很困难的，因为你不能删除元素的一部分，也不容易只对元素的一部分应用颜色。

您可以通过将元素移动到可见区域之外或对其进行剪裁来模拟元素的部分移除。这可能一次只能使用一个轴。

最后，可能有一些[CSS 转换](https://developer.mozilla.org/en/CSS/Using_CSS_transforms)和/或[CSS 转换](https://developer.mozilla.org/en/CSS/CSS_transitions)的组合可以提供您正在寻找的效果，但目前浏览器支持`canvas`比转换/转换更好，因此使用`canvas`.

# java - 套接字异常：errno = 0x44

> ID：10645851
> 
> 赞同：2
> 
> 时间：2012-05-18T02:06:27.220
> 
> 标签：java, sockets, vxworks

当尝试在 vxWorks 系统上运行的 VM 中创建连接套接字时，我会间歇性地抛出一个相当奇怪的 SocketException。我无法隔离导致异常发生的原因。在不修改任何外部因素的情况下，成功的连接似乎是随机的。

这是堆栈跟踪的顶部（从它进入 java.net 的位置）：

```
(0000069317) java.net.SocketException: errno2: 68, 错误: errno = 0x44 for fd: 38
(0000069323) 在 java.net.PlainSocketImpl.socketConnect(Native Method)
（0000069326）在 java.net.PlainSocketImpl.doConnect（未知来源）
（0000069329）在 java.net.PlainSocketImpl.connectToAddress（未知来源）
（0000069366）在 java.net.PlainSocketImpl.connect（未知来源）
（0000069372）在 java.net.Socket.connect（未知来源）

```

抛出异常的块如下：

```
socket = new Socket();
socket.connect(addr, CONNECT_TIMEOUT); 
```

`addr`java.net.SocketAddress在哪里。

谁能提供一些关于 errno 0x44 是什么的见解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T07:30:43.033

vxWorks 的 errno 代码编号与 Unix 系统不同。

在 vxWorks 中，errno 0x44 (68) 是 EINPROGRESS。

EINPROGRESS 可以由以下例程设置：aio_read()、aio_return()、aio_write()

EINPROGRESS 通常不会出错。使用异步 IO，它只是表明某事已开始，但尚未完成。

也许 Java 将 68 错误地转换为 EADV。

尝试使用：

```
socket.connect(addr); 
```

代替

```
socket.connect(addr, CONNECT_TIMEOUT); 
```

也许这足以避免 AIO 和 EINPROGRESS。

# java - XMLHttpRequest() 是未定义的 Servlet

> ID：10645858
> 
> 赞同：0
> 
> 时间：2012-05-18T02:07:11.530
> 
> 标签：java, javascript, servlets, xmlhttprequest

你好，我得到了这个脚本，但我不知道为什么我总是得到那个 req = XMLHTTPRequest 是未定义的。你能告诉我我犯了什么错误吗？

```
var req;

function validate() {
//var idField = document.getElementById("name");
var wrt1 = document.getElementById("p1").value;
var wrt2 = document.getElementById("p2").value;
var data = eval(wrt1)+eval(wrt2);
//  var data = "name=" + encodeURIComponent(idField.value);
req = new XMLHttpRequest();
//  req = new XMLHttpRequest();
var url = "Serwlet";
req.open("POST", url, true);        
req.onreadystatechange = inserter;
req.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
req.send(data);
}

function inserter() {
if (req.readyState == 4) {
    if (req.status == 200) {
        var msg = req.responseText
        if (msg == "") {
            //document.getElementById("msg1").innerHTML = "<div style=\"color:red\">"+"COS NIE TAK"+"</div>";
            document.getElementById("msg1").value = '';
        }
        else
            //document.getElementById("msg1").innerHTML = "<div style=\"color:red\">"+wynik+"</div>";
            document.getElementById("msg1").value = "IT WORKS";
    }
} 
```

}

***编辑***

好的，我做了一些改进。现在唯一的问题是来自 JavaScript inserter() 的 msg 始终为空；/，不知道为什么，如果您查看 validate 方法，var 数据具有正确的值，则 msg 始终为空；/。

```
package Pakiet;

import java.io.IOException;
import java.io.PrintWriter;
import java.io.Writer;

import javax.servlet.ServletException;
import javax.servlet.ServletResponse;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import java.io.IOException;
import java.io.PrintWriter;
import java.io.Writer;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/Serwlet")
public class Serwlet extends HttpServlet {
private static final long serialVersionUID = 1L;
static String KOD =
/*

     out.print("<FORM ACTION=\"ExerciseE\" name=\"entryForm\">\n"+
                        "Name:<INPUT TYPE=\"TEXT\" NAME=\"name\"><BR>\n"+
                        "<INPUT TYPE=\"BUTTON\" VALUE=\"SUBMIT\"\n" +
                        " OnClick=\"validate()\">\n</FORM>");       
 */
"<html>"+
"<head>"+
 "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1250\">"+
"<title>Testowanie</title>"+
"<script type=\"text/javascript\" language=\"javascript\" src=\"servletD2Script.js\"></script>"+
"</head>"+
"<body>"+
"<div id=\"msg1\">Pierwsza suma</div>"+
"<div id=\"msg2\">Pierwsza suma</div>"+
"<center><h2>Testowanie parametrów</h2></center>"+
"<hr>"+
"<form method=\"get\" action=\"Serwlet\">"+
"p1<input type=\"text\" size=\"50\" name=\"p1\" onblur=\"validate()\"><br>"+
"p2<input type=\"text\" size=\"50\" name=\"p2\" onblur=\"validate()\"><br>"+
"<br><input type=\"submit\" value=\"Wyślij formularz by GET\">"+
"</form>"+
"</hr>"+
"<hr>"+
"<form method=\"post\" action=\"Serwlet\">"+
"p3<input type=\"text\" size=\"50\" name=\"p3\" onblur=\"funkcja()\"><br>"+
"p4<input type=\"text\" size=\"50\" name=\"p4\" onblur=\"funkcja()\"><br>"+
"<br><input type=\"submit\" value=\"Wyślij formularz by POST\">"+
"</form>"+
"</hr>"+

"</body></html>";

public Serwlet() {
    super();

}
static boolean raz = true;
private void serviceRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

      response.setContentType("text/html");
      response.setHeader("Cache-Control", "no-cache");
      PrintWriter out = response.getWriter();
      if(raz){out.print(Serwlet.KOD);raz = false;}
      String name = request.getParameter("name");   // dostaję nazwisko
      String org = ""; //jakas wartosc 
      out.write(org != null ?  org : "");    // zwracam organizację lub pusty napis, jesli nie znam nazwiska
}

protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    serviceRequest( request, response);
}

protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    serviceRequest( request, response);
}

} 
```

并且脚本//方法 FUNCKJA() 根本不重要

```
 function funkcja(){
var wrt1 = document.getElementById("p1").value;
var wrt2 = document.getElementById("p2").value;
var wynik = eval(wrt1)+eval(wrt2);
document.getElementById("msg1").innerHTML = "<div style=\"color:red\">"+wynik+"</div>";
var wrt3 = document.getElementById("p3").value;
var wrt4 = document.getElementById("p4").value;
var wynik2 = eval(wrt3)+eval(wrt4);
document.getElementById("msg2").innerHTML = "<div style=\"color:red\">"+wynik2+"</div>";
}

var req;

function validate() {
//var idField = document.getElementById("name");
var wrt1 = document.getElementById("p1").value;
var wrt2 = document.getElementById("p2").value;
var data = eval(wrt1)+eval(wrt2)+"";

if (typeof XMLHttpRequest != "undefined") {
    req = new XMLHttpRequest();
} else if (window.ActiveXObject) {
    req = new ActiveXObject("Microsoft.XMLHTTP");
}
var url = "Serwlet";
req.open("POST", url, true);      
req.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
alert("data = "+data);
req.send(data);
req.onreadystatechange = inserter;
}

function inserter() {
if (req.readyState == 4) {
    if (req.status == 200) {
        var msg = req.responseText;
        alert("msg = "+msg);
        if (msg == "") {
            document.getElementById("msg1").innerHTML = "<div style=\"color:red\">"+"COS NIE TAK"+"</div>";
            //document.getElementById("msg1").value = "blabla";
        }
        else
            document.getElementById("msg1").innerHTML = "<div style=\"color:red\">"+msg+"</div>";
            //document.getElementById("msg1").value = "COOOO JEST";
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:31:31.697

而不是`req = new XMLHttpRequest`试试这个：

```
if(window.XMLHttpRequest && !(window.ActiveXObject)) {  
        try {  
            req = new XMLHttpRequest();  
        } catch(e) {  
            req = false;  
        }  

    } else if(window.ActiveXObject) {  

        try {  
            req = new ActiveXObject("Msxml2.XMLHTTP");  
        } catch(e) {  
            try {  
                req = new ActiveXObject("Microsoft.XMLHTTP");  
            } catch(e) {  
                req = false;  
            }  
        }  
    } 
```

题外话：如果 ajax 是您的要求，您应该考虑使用一些库，例如 jQuery。

编辑：

根据评论：

```
if(raz){out.print(Serwlet.KOD);raz = false;} 
```

你能检查一下 raz 是真是假吗？

然后在写入流调用之后`out.flush();`

```
if(raz){ 
   out.print(Serwlet.KOD);
   raz = false;
}
String name = request.getParameter("name");   // dostaję nazwisko
String org = ""; //jakas wartosc 
out.write(org != null ?  org : "");
out.flush(); 
```

# php - 为复选框设置 cookie

> ID：10645859
> 
> 赞同：1
> 
> 时间：2012-05-18T02:07:12.450
> 
> 标签：php, javascript, cookies, forms

这是我正在尝试为表单中的复选框设置 cookie 的功能

```
function setCookie(c_name,value,exdays){    
    var exdate=new Date();
    exdate.setDate(exdate.getDate() + exdays);
    var c_value=escape(value) + ((exdays==null) ?
        "" : "; expires="+exdate.toUTCString());
    document.cookie=c_name + "=" + c_value;
}

function set_check(){
    var proceed = document.forms['form1']['proceed_opt[]'].checked;
    setCookie(proceed_opt[], proceed, 60*60*1);
    alert(proceed_opt[]);
} 
```

我表单中的复选框是这样的..

```
 <input type="checkbox" name="proceed_opt[]" value="I will upload new Image" onChange="set_check()";>
          Insert Option &quot;I will upload new Image&quot;
    </td>
</tr>
<tr>
    <td></td>
    <td colspan="2">
            &nbsp; 
          <input type="checkbox" name="proceed_opt[]" value="I approve this sample for a Night Light" onChange="set_check()";>
          Insert Option &quot;<font face="Arial, Helvetica, sans-serif" size="2">I approve this sample for a Night Light</font>&quot; 
    </td>
</tr>
<tr>
    <td></td>
    <td colspan="2">
            &nbsp; 
          <input type="checkbox" name="proceed_opt[]" value="Select One" onChange="set_check()";>
          Insert Option &quot;<font face="Arial, Helvetica, sans-serif" size="2">Select One</font>&quot; 
    </td>
</tr>     
<tr>
    <td></td>
    <td colspan='2'>
         &nbsp;
        <input type="checkbox" name="proceed_opt[]" value="other" onChange="set_check()">
          Insert Option &quot;Other See comments&quot;
    </td>
</tr> 
```

但是这里没有设置cookies...谁能告诉我如何为表单中的复选框设置cookies...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T03:02:11.597

您的代码存在一些问题。我稍微清理了一下，并做了一些假设。基本上，你把事情复杂化了。

您错误地引用了这些字段，并且出现了错误。这种方法更简单（虽然仍然不是理想的 - 但它有效）。

小提琴：http: [//jsfiddle.net/mAnUQ/](http://jsfiddle.net/mAnUQ/)

HTML：

```
<form name="form1">
<div>
<input type="checkbox" id="check1" name="proceed_opt[]" value="I will upload new Image" onChange="set_check(this)">
        <label for="check1">I will upload new Image</label>
    </div>
<div>
          <input type="checkbox" id="check2" name="proceed_opt[]" value="I approve this sample for a Night Light" onChange="set_check(this)">
    <label for="check2">I approve this sample for a Night Light</label>
    </div>
<div>              
          <input type="checkbox" id="check3" name="proceed_opt[]" value="Select One" onChange="set_check(this)">
    <label for="check3">Select One</label>
    </div>
    <div>
        <input type="checkbox" id="check4" name="proceed_opt[]" value="other" onChange="set_check(this)">
        <label for="check4">Other See comments</label>
    </div>
</form> 
```

JavaScript：

```
function setCookie(c_name,value,exdays){    
    var exdate=new Date();
    exdate.setDate(exdate.getDate() + exdays);
    var c_value=escape(value) + ((exdays==null) ?
        "" : "; expires="+exdate.toUTCString());
    document.cookie=c_name + "=" + c_value;
}

function set_check(me){
    setCookie(me.value, me.checked, 60*60*1);
    console.log(me.value);
    console.log(me.checked);
    console.log(document.cookie)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:25:57.267

看看这是否会引导您朝着正确的方向前进。这会设置一个名为“proceed_opt”的 cookie，其中包含复选框的值。

HTML：

```
<form name="form1"><table><tr><td></td><td>&nbsp; <input type="checkbox" name="proceed_opt[]" value="I will upload new Image" onclick="if(this.checked){set_check(this);}">
      Insert Option &quot;I will upload new Image&quot;</td></tr>
<tr><td></td><td colspan="2">
        &nbsp; 
      <input type="checkbox" name="proceed_opt[]" value="I approve this sample for a Night Light" onclick="if(this.checked){set_check(this);}">
      Insert Option &quot;<font face="Arial, Helvetica, sans-serif" size="2">I approve this sample for a Night Light</font>&quot; </td></tr><tr><td></td><td colspan="2">
        &nbsp; 
      <input type="checkbox" name="proceed_opt[]" value="Select One" onclick="if(this.checked){set_check(this);}">
      Insert Option &quot;<font face="Arial, Helvetica, sans-serif" size="2">Select One</font>&quot; </td></tr>     
 <tr><td></td><td colspan='2'> &nbsp;
 <input type="checkbox" name="proceed_opt[]" value="other" onclick="if(this.checked){set_check(this);}">
     Insert Option &quot;Other See comments&quot;</td></tr>?</table></form> 
```

JAVASCRIPT：

```
function setCookie(c_name,value,exdays)
{
var exdate=new Date();
exdate.setDate(exdate.getDate() + exdays);
var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
document.cookie=c_name + "=" + c_value;
}

function set_check(proceed){

var proceed_opt = proceed.value;
setCookie("proceed_opt", proceed_opt, 60*60*1);
alert (proceed_opt);
} 
```

# objective-c - 对于行 Objective-C

> ID：10645863
> 
> 赞同：-1
> 
> 时间：2012-05-18T02:07:26.890
> 
> 标签：objective-c, if-statement

我正在制作一个 iOS 代码解释器。我已经完成了所有检查，但到目前为止您只能输入一个命令。我希望用户能够在 UITextView 中输入多个命令。我计划对文本视图执行的操作是将每一行传递给我的 IF 语句行。

有谁知道一种说法，将每一行逐个传递到 if 语句行？

```
- (IBAction)runCommad:(id)sender {

    //Alert
    NSString *alertCheck = @"alert(";
    NSRange alertCheckRange = [code.text rangeOfString : alertCheck];
    //Logger
    NSString *logCheck = @"log(";
    NSRange logCheckRange = [code.text rangeOfString : logCheck];

    if (alertCheckRange.location != NSNotFound) {
//If the compiler sees alert()...
        NSString *commandEdit;
        commandEdit = code.text;
        commandEdit = [commandEdit stringByReplacingOccurrencesOfString:@"alert(" withString:@""];
        commandEdit = [commandEdit stringByReplacingOccurrencesOfString:@")" withString:@""];
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Syn0" message:commandEdit delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert show];

    }else  if (logCheckRange.location != NSNotFound) {
        //If the compiler sees log()...
        NSString *commandEdit;
        commandEdit = code.text;
        commandEdit = [commandEdit stringByReplacingOccurrencesOfString:@"log(" withString:@""];
        commandEdit = [commandEdit stringByReplacingOccurrencesOfString:@")" withString:@""];
        logFile = [NSString stringWithFormat:@"%@\n%@", logFile,commandEdit];
        logTextView.text = logFile;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:18:45.907

有两个建议，首先，如果您对块感到满意，您可以使用`NSString`'s：

```
(void)enumerateLinesUsingBlock:(void (^)(NSString *line, BOOL *stop))block 
```

此方法将调用块，按顺序将原始字符串中的每一行传递给它。`stop`如果您想在处理设置为的每一行之前停止`YES`。

或者，您可以使用`NSString`'s：

```
(NSArray *)componentsSeparatedByString:(NSString *)separator 
```

这会将字符串分解为基于`separator`. 在`for`枚举中使用它：

```
for(NSString *nextLine in [originalString componentsSeparatedByString:@"\n"])
{
   // process nextLine, break from loop to stop before processing each line
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T02:25:45.263

首先，让您的字符串组件进行评估：

```
NSString *text = [textView text];    
NSArray *components = [text componentsSeperatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]]; 
```

您不能将开关与字符串一起使用，因此您需要使用 if 检查每种情况：

```
for (NSString *string in components)
{
    if ([string isEqualToString:@"The first string you're matching"])
    {
        //Do something because you found first string
    }

    if([string isEqualToString:@"The second string you're matching"])
    {
        //Do something else
    }
} 
```

这就是想法。

# wpf - 无法调试 Collection 被修改；枚举操作可能无法执行 - VS2010

> ID：10645864
> 
> 赞同：0
> 
> 时间：2012-05-18T02:07:40.553
> 
> 标签：wpf, c#-4.0, visual-studio-debugging

我`Collection was modified; enumeration operation may not execute`在 VS2010 的 Framework 4.0 下的 WPF 应用程序中遇到错误。

此收集错误仅在我启动程序的已编译调试版本时发生。问题是我无法追踪错误，因为没有给出智能信息，而且我无法找到该错误与哪一行代码有关。

你会怎么做才能找到错误的代码？是否有一个选项可以切换以在调试 .exe 中启用智能？我有一条消息告诉我在 x86 中编译，但这已经在 x86 模式下编译。

* * *

### 资源

不确定我应该粘贴代码的哪一部分，但它提供了有关应用程序“模式”的想法。

这是我的 ListView，绑定到 <AudioFile> 的 List

```
<ListView AllowDrop="True" Drop="dropMP3" DragEnter="dropMP3Begin"
GridViewColumnHeader.Click="GridViewColumnHeaderClickedHandler"
ScrollViewer.VerticalScrollBarVisibility="Visible"  
ScrollViewer.HorizontalScrollBarVisibility="Disabled" UseLayoutRounding="False" 
ItemsSource="{Binding}" x:Name="myTracks" Margin="0" AlternationCount="2" 
Foreground="#FFEFEFEF" FontSize="13.333" VerticalAlignment="Top" 
SizeChanged="myTracks_SizeChanged" Background="Black" 
MouseDoubleClick="myTracksDoubleClick"> 
```

这些是我的专栏：

```
<GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Artist}">
    <TextBlock Text="Artist"></TextBlock>
</GridViewColumn>
<GridViewColumn Width="Auto" Header="Title" DisplayMemberBinding="{Binding Title}"/>
<GridViewColumn Width="Auto" Header="Album" DisplayMemberBinding="{Binding Album}"/>
<GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Length}">
    <Image Source="Icons\clock.png" Height="15"/>              
</GridViewColumn> 
```

应用程序启动时

```
myTracks.DataContext = songs; 
```

这是我的对象

```
public class AudioFile
{
    public String Artist { get; set; }
    public String Title { get; set; }
    public String Album { get; set; }
    public String fileLocation { get; set; }
    public String Length { get; set; }
    public String Track { get; set; }
} 
```

找到歌曲时：

```
void lm_SongFound(AudioFile file)
{
        songs.Add(file);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T02:10:52.957

这通常发生在您在`foreach`迭代期间修改集合时。

例如：

```
foreach(var item in items){
    items.Remove(item);
} 
```

如您所见，集合在迭代时正在修改。

您没有看到异常的事实可能并不意味着它不存在。也许它被困住了。这曾经发生在 WPF 绑定中。

# javascript - Ruby on Rails：从页面访问公共 javascript

> ID：10645866
> 
> 赞同：1
> 
> 时间：2012-05-18T02:08:21.177
> 
> 标签：javascript, ruby-on-rails, routes, public

我在从本地 Ruby on Rails 站点中的某些页面访问我的 javascript 时遇到问题。

我有位于 /public/javascripts 中的 jquery javascript 文件 这些脚本呈现嵌入在页面中的 instagram 提要

当我转到类似的页面`http://localhost:3000/users`时，脚本加载正常；但是，如果我转到特定用户， `http://localhost:3000/users/1`则脚本不会加载。

我觉得我缺少某种基本的路由技术。

脚本位于我的`views/layouts/application.html.erb`

它们的引用如下：

```
<script type="text/javascript" src="javascripts/jquery-1.6.1.min.js"></script> 
```

我错过了什么？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:11:07.143

使用jquery的绝对路径。

```
<script type="text/javascript" src="/javascripts/jquery-1.6.1.min.js"></script> 
```

`application.js`或者，如果您的铁轨不够旧，您可以在其中包含以下行。

```
//= require jquery 
```

# c - 符号无法解析

> ID：10645869
> 
> 赞同：1
> 
> 时间：2012-05-18T02:08:40.080
> 
> 标签：c, eclipse-cdt

我有一个程序在 eclipse C/c++ cdt 中告诉我“无法解析符号 xxxx”。

示例文件如下：

**头文件`s.h`：：**

```
#ifndef S_H_
#define S_H_

typedef enum {
    MSG_ID_INVALID_TYPE = 0,
    #include "s0.h"
} msg_type;

#endif /* S_H_ */ 
```

上述文件包括如下所示的头文件：

**头文件`s0.h`**

```
MSG_ID_COMMAND1,
MSG_ID_COOMAND2, 
```

**主文件`test.c`**

```
/*
 * test.c
 *
 *  Created on: 2012-5-18
 *      Author: js
 */
#include "s.h"

int i = MSG_ID_COMMAND1;

main()
{
    print ("%d",i);
} 
```

日食告诉我：`Symbol MSG_ID_COMMAND1 could not be resolved`

但是程序在vc2008下是可以的。

为什么？

// 答案：赛斯·卡内基。如果我们使用 i = MSG_ID_INVALID_TYPE，就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:39:23.003

改变

```
typedef enum {
    MSG_ID_INVALID_TYPE = 0,
    #include "s0.h" 
```

至

```
typedef enum {
    MSG_ID_INVALID_TYPE = 0,
#include "s0.h" 
```

一些预处理器会忽略不左对齐的标记。VS 没有，显然 Eclipse 有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:38:02.110

您创建的代码段无法编译，因为`print`函数不存在并且没有包含来定义它

# javascript - 为什么这个 emberjs 模板不更新？

> ID：10645876
> 
> 赞同：1
> 
> 时间：2012-05-18T02:10:54.927
> 
> 标签：javascript, ember.js

我正在学习 emberjs，我做了一个非常简单的例子。HTML 模板是：

```
<script type="text/x-handlebars">
    Hello <b>{{App.appOwner}}</b>
</script> 
```

然后javascript是：

```
App = Ember.Application.create({
  appOwner : 'Erik'
});

App.appOwner = 'Tom'; 
```

这几乎符合您的期望。emberjs.com 文档说模板是自动更新的——所以我添加了这个：

```
$(document).click(function() {
  console.log('HERE!');
  App.appOwner = 'Alphonse';
}); 
```

出乎意料地失败了。我添加了 console.log 只是为了确保点击处理程序被调用，它就是这样。为什么不更新？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T03:16:12.037

您需要使用`.set()`mutator 方法，因为 javascript 没有拦截直接属性更改的工具：

```
App.set('appOwner', 'Alphonse'); 
```

# java - 如何将碧玉预览添加到 JPanel

> ID：10645878
> 
> 赞同：2
> 
> 时间：2012-05-18T02:11:11.167
> 
> 标签：java, jasper-reports

我使用 jasper 报告创建了一个小报告，并使用 jasper 查看器进行了预览，如下所示，

```
con = JDBCConnectionPool.getInstance().checkOut();
            String fileName = getClass().getClassLoader().getResource("com/bio/ofm/mnu/views/reports/jasperReports/repAuditReport.jrxml").getFile();
            JasperReport report = JasperCompileManager.compileReport(fileName);
            JasperPrint print = JasperFillManager.fillReport(report, null, con);
            JasperViewer viewer = new JasperViewer(print);   
            viewer.setVisible(true); 
```

但我需要在 JPanel 中显示此报告，所以我尝试了，

```
JasperViewer.setDefaultLookAndFeelDecorated(true);
            JRViewer jrv = new JRViewer(print);
            jrv.setPreferredSize(new Dimension(getSize()));
            JScrollPane reportScroll = new JScrollPane(jrv);
           panel1.add(reportScroll); 
```

但报告没有按我的预期显示，请解释将碧玉预览添加到 JPanel 的正确方法是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T02:17:23.423

JasperViewer 扩展了 JFrame，您不想将 JFrame 添加到 JPanel。您也许可以将 JasperViewer 的 contentPane 添加到 JPanel。我在评论中讨论的其他问题仍未解决：

panel1 使用什么布局管理器？您是否在显示 GUI 后将 JScrollPane 添加到 JPanel？如果是这样，添加后是否在 JPanel 上调用 revalidate() 和 repaint()？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-21T12:22:17.663

这是我的代码，它可以工作

```
 JRViewer jr=new JRViewer(print); 
       jPanel1.setLayout(new BorderLayout());
       jPanel1.repaint();
       jPanel1.add(jr);
       jPanel1.revalidate(); 
```

# sql - 在 SQL Server 中自动循环遍历行并为每一列添加一个数字

> ID：10645879
> 
> 赞同：2
> 
> 时间：2012-05-18T02:11:15.377
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个超过 500 行的表，`ID`其中有一列名为 datetype `INT`。目前这些值都是`NULL`.

我想要实现的是`ID`用每行的增量数字填充列，比如 1、2、3、4、...、500 等。

请帮助我了解如何通过 SQL 脚本实现此目的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:39:55.890

在 CTE 中使用`ROW_NUMBER`是一种方法，但这是另一种方法；创建一个新`id1`列`int identity(1,1)`，然后复制到 id，然后删除 id1：

```
-- sample table
create table myTable(id int, value varchar(100));

-- populate 10 rows with just the value column
insert into myTable(value)
select top 10 'some data'
from sys.messages;
go

-- now populate id with sequential integers
alter table myTable add id1 int identity(1,1)
go
update myTable set id=id1;
go
alter table myTable drop column id1;
go
select * from myTable 
```

结果：

```
id          value
----------- -------------
1           some data
2           some data
3           some data
4           some data
5           some data
6           some data
7           some data
8           some data
9           some data
10          some data 
```

虽然您也可以`ID`作为身份删除和重新创建，但它会失去其序数位置，因此是临时`id1`列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:36:18.040

```
#create one temporary table
CREATE TABLE Tmp
(
  ID int NOT NULL
         IDENTITY(1, 1),
  field(s) datatype NULL
)

#suppose your old table name is tbl,now pull 
#Id will be auto-increment here
#dont select Id here as it is Null
INSERT  INTO Tmp (field(s) )
        SELECT  
                field(s)
        FROM    tbl

#drop current table
DROP TABLE tbl

#rename temp table to current one
Exec sp_rename 'Tmp', 'tbl'
#drop your temp table
#write alter command to set identitry to Id of current table 
```

祝你好运

# apache-flex - asdoc 错误“嵌套模板或函数调用过多”

> ID：10645880
> 
> 赞同：0
> 
> 时间：2012-05-18T02:11:22.853
> 
> 标签：apache-flex, asdoc

```
[asdoc] ���ڼ��������ļ���D:\4.5.0\frameworks\flex-config.xml��
[asdoc] Error at xsl:call-template on line 310 of fieldSummary.xslt:
[asdoc]   Too many nested template or function calls. The stylesheet may be looping.
[asdoc] Transformation failed: Run-time errors were reported 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T18:12:50.030

当 ASDoc 失败时，通常会在日志文件中对错误进行更具描述性的引用。

该错误消息的末尾可能是日志的路径，它将在其中明确说明更详细的错误。它将说明以下内容：

> 有关详细信息，请参阅 C:\flex\bin\framework-asdoc\validation_errors.log。

# php - 在一周之前/期间/之后一周获得生日

> ID：10645887
> 
> 赞同：0
> 
> 时间：2012-05-18T02:12:27.333
> 
> 标签：php, mysql

我有一个 facebook 应用程序，将用户生日作为 varchar 存储在 mysql db 中。我试图让所有用户的生日

1 周后，如果是在本周，如果生日是上周。

在我的 php 中，我得到生日并用 strtotime() 转换它们

我可以轻松检查生日是否是今天

```
if (date('m-d') == date('m-d', $bday)) {
    // today is your bday!!
} 
```

在比较日期时我迷失了 aahaha 我知道我可以使用 strtotime('nextweek') 或类似的东西，但我不确定

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:26:40.043

查询将类似于：

```
select * from table 
where bday between curdate() - INTERVAL 7 DAY and curdate() + INTERVAL 7 DAY 
```

上周和下周的范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T02:58:56.103

如果 bday 基于此人的出生年份，那么除非此人不到 7 天，否则我看不出与 curdate() 的比较将如何给您答案。=)

编辑：

你应该能够做到：

```
$bday_this_year = strtotime(date('Y')   . '-' . date('m-d', $bday));
$bday_last_year = strtotime(date('Y')-1 . '-' . date('m-d', $bday));
$bday_next_year = strtotime(date('Y')+1 . '-' . date('m-d', $bday));

$last_week = strtotime("-1 week");
$next_week = strtotime("+1 week");

if (($bday_this_year > $last_week && $bday_this_year < $next_week) || ($bday_last_year > $last_week && $bday_last_year < $next_week) || ($bday_next_year > $last_week && $bday_next_year < $next_week)) {
// Happy Birthday duders!
} 
```

计算不同年份的生日的原因是为了处理在 12 月下旬和用户的生日在 1 月，或者在 1 月初和用户的生日在 12 月下旬等边缘情况。

这个答案可能会被改进，但它应该可以工作。

# php - 在 mysql 查询中处理空/空白数据？

> ID：10645891
> 
> 赞同：0
> 
> 时间：2012-05-18T02:12:42.810
> 
> 标签：php, mysql, null

假设您的表单有一些字段，而有些字段可以由用户简单地留空以便稍后填写。

你们在处理 SQL 查询之前如何处理它？

我对 PHP 还是很陌生，这就是我的做法。

```
function checkVAR( $str )
{
  $val = htmlentities( $_REQUEST[$str] , ENT_QUOTES , "UTF-8" );
  if ( $val == "" )
    return "NULL";
  return "'" . $val . "'";
} 
```

所以稍后在我的查询中

```
$query = "INSERT INTO tblName ( idCol , col2 , col3 ) " .
  "VALUES (" . checkVAR('idcol') . "," . checkVAR('col2') . "," . checkVAR('col3') . ");" 
```

我发现我的方法仍然很乏味，我想知道是否还有其他更好的方法来处理这种情况。我的这个函数在返回数字方面做得不好，所以我有一个单独的函数，除了它返回`0`而不是`null`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:31:35.253

首先，您不应该在将数据输入数据库之前对 HTML 字符进行编码。如果您希望通过某种非 HTML 显示方式发送该数据会怎样？它可能看起来像狼吞虎咽的东西。您至少应该转义字符串数据并确保将数字数据类型转换为适当的类型。更好的是使用准备好的语句。

我将假设您正确使用了[mysqli](http://us3.php.net/manual/en/book.mysqli.php)扩展，因为旧的[`mysql_*`API 已被弃用](http://us3.php.net/manual/en/mysqlinfo.api.choosing.php)。您正在使用*改进*的扩展程序，对吗？对？行！

```
function getNullOrEscaped($string)
{
    // casting ensures that we are passing a string to mysqli_real_escape_string
    // and allows us to pass objects with __toString implemented
    $string = (string) $string;
    return ($string === '') ? null : mysqli_real_escape_string($string);
} 
```

但是，我可能会考虑使用[准备好的语句](http://us.php.net/manual/en/mysqli.prepare.php)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-18T02:20:13.007

这使您所做的更漂亮，并且可能更易于使用：

### 功能页面：

```
function check_post($var)
{
  $val = mysql_real_escape_string($_POST[$var]);
  return ($var== "") ? NULL : "'" . $var . "'";
} 
```

### 表单处理程序：

```
$value = check_post($var);
$query = "INSERT INTO `table` (id, col1) VALUES (" . $value . ")"; 
```

但是，您确实应该检查其他解决方案。我*强烈*推荐 IDIORM，一个简单的数据库 ORM (http://j4mie.github.com/idiormandparis/)。这使得插入值变得如此简单：

```
$object = ORM::for_table("table")->create();
$object->value = check_post($var);
$object->save(); 
```

# javascript - 向数组中添加一个元素

> ID：10645895
> 
> 赞同：0
> 
> 时间：2012-05-18T02:14:09.647
> 
> 标签：javascript, javascript-events

我有一个这样的数据数组，

```
tourGuide: [
    {"location": "london"},
    {"location": "paris"},
    {"location": "frankfurt"}
] 
```

我想重写 tourGuide 以便它也包含索引。所以它会变成这样：

```
tourGuide: [
    {"location": "london", "index":0},
    {"location": "paris", "index":1},
    {"location": "frankfurt","index":2}
] 
```

我试过这个，

```
var x, l=0;
for(x in tourGuide){
    tourGuide["index"] = l;
    l++;
} 
```

但这可能不是正确的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:16:32.047

```
var x, l=0;

for(x in tourGuide){

tourGuide[x]["index"] = l;
l++;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T02:16:41.500

试试这个：

```
for(var i=0;i<tourGuide.length;i++){
    tourGuide[i].index=i
}

//----or more simplified...----

var i=0;
for(;i<tourGuide.length;){
    tourGuide[i].index=i++
} 
```

**现场演示：http:** [//jsfiddle.net/DerekL/qvdzR/](http://jsfiddle.net/DerekL/qvdzR/)

但实际上，您实际上不必创建一个`index`，因为它们在一个数组中，它们*已经*有一个`index`值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T02:17:12.937

我建议你忘记这个`location`属性，只做一个简单的数组。除非您打算稍后添加更多属性，否则常规数组将为您提供数字索引。做就是了：

```
var output = array();
for (var i=0; i<tourGuide.length; i++) {
  // Just stick each of the locations onto a plain old array
  output.push(tourGuide[i].location;
}

console.log(output); 
```

# algorithm - voip 项目中最流行的压缩算法是什么？

> ID：10645896
> 
> 赞同：0
> 
> 时间：2012-05-18T02:14:23.653
> 
> 标签：algorithm, voip, voice

voip 项目中最流行的压缩算法是什么，或者互联网传输中最流行的语音压缩算法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:18:36.573

开源 speex 编解码器的使用似乎很常见。

# javascript - 未传递从 PDF 到 HTML 文档的 PDF Javascript 消息

> ID：10645897
> 
> 赞同：1
> 
> 时间：2012-05-18T02:14:43.123
> 
> 标签：javascript, jquery, pdf

我正在尝试让我的 PDF javascript 嵌入代码与其 HTML 容器页面进行通信。但我只能以一种方式使其工作（HTML-> PDF）

也许问题是对象标签是动态生成的（因为我需要即时加载pdf）

我的 pdf 文件中的 js（在 OPEN 操作中运行）：

```
this.hostContainer.messageHandler =
{
 onMessage: function(messageArray)
 {
   app.alert('msg received' + messageArray);
 },
 onError: function(error, messageArray){ },
 onDisclose: function() {return true;}
};

try{
  this.hostContainer.postMessage(["never", "delivered"]);  // this line doesn't work. :(
}
  catch(e){
  app.alert(e.message);
} 
```

我的 html 页面 js 代码：

```
function messageFunc(messageArray) {
    alert('finally!!');
}

 $j('#pdf_div').html("<object type='application/pdf' data='http://url.to.dinamically.generated.pdf' id='PdfObject'> </object>");

  $j("#PdfObject").ready(function() {
    document.getElementById('PdfObject').messageHandler = { onMessage: messageFunc };
  }); 
```

正如我所说，PDF 可以毫无问题地接收消息，但我无法将消息从 PDF 发送到 HTML 代码。

顺便说一句，我正在使用 JQuery。

任何帮助将非常感激。谢谢。

# ruby-on-rails - Mongoid：为 HABTM 关系保存父对象时禁用对逆对象的验证选项

> ID：10645898
> 
> 赞同：1
> 
> 时间：2012-05-18T02:14:44.370
> 
> 标签：ruby-on-rails, mongoid

我有以下内容：

```
def User 
  has_and_belongs_to_many: :following, class: "User", inverse: :followers 
  has_and_belongs_to_many: :followers, class: "User", inverse: :following 
end 
```

请注意，用户也是一个设计对象。这意味着当您保存用户时，它需要 :password 和 :password_confirmation 才能保存。

在使用 Devise 的 rails 应用程序的上下文中，我可以访问当前登录用户的 current_user：

```
following_user = User.find(following_id) 
current_user.following.push(following_user) 
```

“current_user” 保存正常，因为它已通过身份验证，但 following_user 未保存，因为它未通过缺少：password 和 :password_confirmation 的验证。

无论如何，我可以禁用对逆对象的验证吗？

我尝试将“验证：假”附加到逆的两侧，但没有任何区别。（在这种情况下，我是否理解 validate 选项？）

处理这种情况的推荐方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T03:02:32.773

在设计密码验证为

```
validates_presence_of     :password, :if => :password_required?
validates_confirmation_of :password, :if => :password_required? 
```

方法 password_required 是

```
def password_required?
   !persisted? || !password.nil? || !password_confirmation.nil?
end 
```

您可以使用所需的逻辑在用户模型中覆盖此方法。

# vb.net - 标记暂存站点以防止其被用作生产站点

> ID：10645901
> 
> 赞同：0
> 
> 时间：2012-05-18T02:15:23.670
> 
> 标签：vb.net, visual-studio-2008, testing, deployment, .net-2.0

抱歉标题太长了，我觉得很难总结。我被要求为我的公司维护几个仅供内部使用的 Web 应用程序。为了进行测试，在进行更改后，我创建了一些使用单独数据库的登台站点。因此，如果我的用户错误地将这个站点当作生产站点使用，他们可能会输入重要数据并想知道它“消失”在哪里，以为它是生产服务器。

我想在登台站点的顶部（仅出现在登台站点上）创建某种大横幅，以提醒我的用户他们在测试站点上。我想建议最好的方法来做到这一点，考虑到以下几点：

```
IDE: Visual Studio 2008
Server: Windows 2003 with IIS 6
Language: VB.NET 2.0 
```

谢谢 ;）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T02:23:09.987

我将创建一个 web.config 应用程序设置，其中包含暂存中的特定值。然后在您的母版页代码中（假设您正在使用它们）编写一些代码，将适当样式的 HtmlGenericControl（作为 div）插入到母版页标记中的 PlaceHolder 控件中。所有这一切都基于应用程序设置是否具有指示暂存环境的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:25:16.427

如果是我，我会让登台站点具有不同的颜色背景。

白色背景——公开和直播。
粉红色背景——暂存，随时可能重新格式化。

# java - 静态方法中的局部变量也是静态的吗？

> ID：10645914
> 
> 赞同：13
> 
> 时间：2012-05-18T02:16:46.383
> 
> 标签：java, memory-management, static, static-methods

我想知道如果我们在静态方法中声明所有局部变量是否都变为静态？

例如：

```
 public static void A(){
        int x [] = {3,2};
        changeX(x);

        for (int i = 0; i< x.length; i++){
             System.out.println(x[i]);   // this will print -1 and 1
        }
  }
  private static void changeX(int[] x){
        x[0] = -1;
        x[1] =  1;
  } 
```

据我了解，Java 总是按值传递，但是为什么在我们进行 changeX 调用后 X 的状态发生了变化？谁能解释一下？任何人都可以解释Java如何在内存分配方面处理静态变量吗？如果我们将静态变量作为参数传递给函数会发生什么（我知道人们通常不会这样做）

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-18T02:18:22.800

您大多数问题的答案是“与任何其他变量相同”。

静态方法中的局部变量只是静态方法中的局部变量。它们不是静态的，也没有任何特殊之处。

静态*变量*保存在附加到相应`Class`对象的内存中；静态引用变量引用的任何对象都只存在于常规堆中。

当您将静态变量作为参数传递给方法时……绝对不会发生任何有趣的事情。

*关于代码中的场景：*

1.  想象一下，您在字符串上有一个玩具气球（气球是您的数组对象，字符串是对它的引用`A()`。）
2.  现在您将*另一个*字符串系在气球上并将该字符串交给朋友（这正是您调用`changeX()`方法时发生的情况：字符串是方法的参数，它指向同一个对象。）
3.  接下来，你的朋友拉入绳子，拿一个黑色记号笔在气球上画一张脸（这就像`changeX()`修改数组的方法）。
4.  然后你的朋友解开他的绳子，只留下你的绳子附在气球上（方法返回，局部变量 in`changeX()`超出范围。）
5.  最后，您将绳子卷起来并查看气球：当然，您会看到脸部（您的`A()`例程会看到更改后的数组。）

真的就这么简单！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T02:22:30.440

正如其他人所指出的那样，METHOD 的局部变量与在任何其他方法中声明的任何其他变量相同——它们是动态分配的，并且可以在方法返回变量不再可见时被释放。

但是，如果您需要静态变量，则必须在方法之外将它们声明为类的普通静态变量。如果按照惯例，除非在该特定方法中，否则您不理会它们，则它们具有与静态和本地方法相同的效果。请务必为此添加评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T02:28:13.717

静态变量存储在堆的一个特殊区域，称为“永久代”。

在静态方法中声明的局部变量与在非静态方法中声明的局部变量没有任何区别。对象引用和原始变量放置在堆栈上。无论何时创建对象，执行该代码时都会在堆上分配存储空间。

# jquery - 什么jquery视频播放器，播放avi、mp4、mkv、wmv文件？

> ID：10645922
> 
> 赞同：2
> 
> 时间：2012-05-18T02:18:23.467
> 
> 标签：jquery, html5-video

我正在开发一个基于网络的媒体中心应用程序。作为在 linux 中运行媒体中心应用程序的轻量级替代方案。

我有一个 bash 脚本，它生成一个使用宝丽来显示的 html 文件，其中包含我下载的电影的所有海报。

[http://imageshack.us/photo/my-images/651/polaroidscreenshot.png](http://imageshack.us/photo/my-images/651/polaroidscreenshot.png)

单击电影海报后，我想转到第二页，该页面将播放本地托管的视频。

我曾尝试使用 jplayer，但在使用它附带的演示代码时遇到了问题。

是否有支持标准电影视频格式的 jquery 或 html5 视频播放器？比如avi、mp4、mkv和wmv？

还是我必须将它们转换为对播放器更有用的格式？

我宁愿不必转换它们，这是可行的，但会很耗时，并且可能会扭曲视频质量。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:23:01.017

***为什么？***，已经有视频的网络友好格式。`flv`,`mp4`,`webm`是很好的格式，也可以支持高质量。你不需要专注于创造这样的东西。

您可以使用网站上的媒体播放器小部件，如果客户端具有支持的编解码器来播放视频，则让视频播放。但是，由于这会将访问者缩小到 Windows 平台，我也不推荐它。

话虽如此，有一个名为[jQuery Media Plugin](http://jquery.malsup.com/media/)的插件可以提供您想要的有限内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-08T13:02:56.260

很久没问这个问题了，我只是在研究视频播放器的时候遇到的。你总是可以使用 ffmpeg 工具转换视频格式，但正如你所说，这会很耗时，并且可能会扭曲视频质量。现在有 HTML5 视频播放器，使用它们播放您提到的视频格式将是一个更好的解决方案。这是一篇关于 Open Web 上一些流行的 HTML5 视频播放器的博客文章。 [http://cloudinary.com/blog/html5_video_player](http://cloudinary.com/blog/html5_video_player)

# c# - .NET 的整数不只是简单地基于二进制补码系统吗？

> ID：10645936
> 
> 赞同：7
> 
> 时间：2012-05-18T02:19:50.333
> 
> 标签：c#, .net, vb.net

[MSDN](http://msdn.microsoft.com/en-us/library/system.int32.aspx)：

> > Int32 值以 31 位表示，其中 30 秒位用作符号位。**正值通过使用符号和大小表示来表示。**负值以二进制补码表示。

使用[符号和大小系统](http://en.wikipedia.org/wiki/Signed_number_representations)表示正值是否与使用[二进制补码系统](http://en.wikipedia.org/wiki/Two%27s_complement)表示正值相同？

所以它不应该被重写为：*“Int32 值（无论正负）都用二进制补码表示”*，

还是我误解了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T02:41:40.913

是的，你是对的。他们应该说它使用二进制补码系统，然后给出关于使用 31 位的定义，而不是将负数解释为“二进制补码”，只是解释负数的位表示。然后对按位运算符发出警告。

# camera - windows PC 摄像头图像捕获，不在视频流中拍摄一帧

> ID：10645940
> 
> 赞同：0
> 
> 时间：2012-05-18T02:20:41.237
> 
> 标签：camera, video-streaming, directshow

我遇到了一个使用 PC 摄像头（集成笔记本摄像头或网络摄像头）拍摄图像的问题。虽然我正在开发一个计算机视觉系统，其中高质量的图像捕获是关键问题，但当前的大多数方法是使用 VFW 或 directShow 来捕获视频流并将一帧捕捉为图像。

但是，这种方法无法获得高质量的图像（或耗尽相机的全部容量）。例如，我有一个 5 兆像素的网络摄像头。但视频流最大为 720P（USB 带宽问题？）。视频流正在浪费一些相机传感器。

我可以独立视频流和拍照吗？就像输入带有 640*480 视频流的视频并在流上渲染。然后用同一个cam拍一张1280*720的照片？我想这将是一个硬件问题？新的 HTC one X 相机？

简而言之，有一种PC系统拍照，充分利用传感器容量，无需视频流和捕获一帧的方法。这是硬件相关的问题吗？普通网络摄像头是否支持此功能？还是软件问题，我应该学DirectShow的东西？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T14:23:14.753

我隐约记得（某些）视频源同时提供捕获和静止图钉，我认为后者会为您提供更高的质量。您可以在 GraphEdit 中轻松地对此进行测试。如果它有效，那么是的，你必须学习 DirectShow。或者花钱请人为你编写代码。

# wpf - 拖放导致 WPF 内存泄漏

> ID：10645946
> 
> 赞同：4
> 
> 时间：2012-05-18T02:21:12.937
> 
> 标签：wpf

使用 Red-Gate 工具，我们检测到 System.Windows.DataObject 持有对拖拽对象（一个框架元素）的引用，该引用在操作完成后就一直挂着。

一旦 DragDrop.DoDragDrop，如何“清除”拖动对象？有没有办法通过这个传递一个空值并让它直接通过？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-20T06:39:53.787

我自己刚刚发现了这个 gem，我的解决方案是对被拖动的数据项使用 Wea​​kReference。

```
DataObject data = new DataObject(new WeakReference(this.draggedData));
DragDrop.DoDragDrop((DependencyObject)sender, data, DragDropEffects.Move); 
```

然后在下降

```
var draggedItem = e.Data.GetData(this.format.Name) as WeakReference;
if (draggedItem != null && draggedItem.IsAlive)
{
    ....
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-29T07:56:30.707

首先[非常感谢 Ian Oakes 的解决方案](https://stackoverflow.com/a/13966606/74612)。然而，我需要一个轻微的变体：我必须确保丢弃始终有效，即使垃圾收集器同时运行。这是解决方案：

```
public partial class DragDropDemo : Window
{
    private SomeDragDropData _dragDropData;

    private void OnMouseMove(object sender, MouseEventArgs e)
    {
        if (e.LeftButton == MouseButtonState.Pressed)
        {
            _dragDropData = new SomeDragDropData { Text = "Some drag data" };
            var dataObject = new DataObject("SomeObjectTypeId", new WeakReference<SomeDragDropData>(_dragDropData));
            DragDrop.DoDragDrop((DependencyObject)sender, dataObject, DragDropEffects.Move);
            _dragDropData = null;
        }
    }

    private void OnDrop(object sender, DragEventArgs e)
    {
        var weakReferenceData = e.Data.GetData("SomeObjectTypeId") as WeakReference<SomeDragDropData>;
        if (weakReferenceData != null && weakReferenceData.IsAlive)
            MessageBox.Show(weakReferenceData.Target.Text);
    }
}

public class SomeDragDropData
{
    public string Text;
} 
```

一些备注：

*   之所以可行，是因为 DoDragDrop 会一直阻塞，直到用户触发拖放操作。因此，只有在拖放操作完全完成后，_dragDropData 才会变为 null。
*   使 _dragDropData 成为成员变量非常重要。仅仅将其设为局部变量是不够的：当触发垃圾收集器时，对象*可能会*被释放。这导致了一个非常难以重现的错误，因为并不是因为垃圾收集器被触发，对象就必须被清理。据我所见，只有在分配和释放大量内存时才会清理它

# php - PHP 变量中的两种引号

> ID：10645950
> 
> 赞同：-1
> 
> 时间：2012-05-18T02:21:41.003
> 
> 标签：php

我以前知道这一点，但我想它溜走了。您在php中变量的开头和结尾放置的代码是什么，以允许两种引号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:23:16.693

我遵循的个人规则（不是灵丹妙药）：

1.  如果字符串中没有单引号 - 使用`'`
2.  如果字符串中有单引号 - 使用`"`
3.  如果字符串中有不同类型的引号 - 使用`'`或[HEREDOC](http://nz.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T02:24:14.587

我认为您正在考虑[heredocs](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)。

例子：

```
echo <<<EOT
Some text here '' ""'
This should print a capital 'A': \x41
EOT; 
```

# architecture - 进位标志过时了吗？

> ID：10645955
> 
> 赞同：1
> 
> 时间：2012-05-18T02:22:07.180
> 
> 标签：architecture, instruction-set, carryflag

进位标志似乎有两个主要用途。1) 它对于链接加法/减法指令以对大于本机大小的数字进行操作很有用。例如，在 8 位架构上添加 32 位整数。2）它用于条件分支。还有一些不太常见的用途（例如，我在 intel 上使用过 fcomi）。特别是，进位标志不是从 C 或任何其他常见的非汇编语言定义或访问的。由于 32 位和 64 位架构非常普遍，大多数用 CI 编写的软件都不得不怀疑：

进位标志过时了吗？如果没有它的新架构出现，谁会错过它？

我假设它不需要作为条件代码（例如，用谓词替换标志），因此 AFAICT 仅用于链接 add/sub/rot 并且移入/移出它的效果将消失。

# php - 带有 PHPExcel 致命错误的 CodeIgniter 无法重新声明类 IOFactory

> ID：10645957
> 
> 赞同：1
> 
> 时间：2012-05-18T02:22:28.600
> 
> 标签：php, codeigniter, phpexcel

我正在尝试将 PHPExcel 与 CodeIgniter 一起使用。

我的问题是当我想在下面使用这个方法时，我得到了**PHP Fatal Error : Cannot redeclare class IOFactory**

> 如果不确定文件类型，可以使用 IO 工厂的 identify() 方法来识别您需要的读取器，然后再使用 createReader() 方法实例化读取器对象。

下面是我的代码：

```
$this->load->library('PHPExcel');

$this->load->library('PHPExcel/IOFactory');

$path = $upload_data['full_path'];

$inputFileType = PHPExcel_IOFactory::identify($path);

$objReader = PHPExcel_IOFactory::createReader($inputFileType);

$objPHPExcel = $objReader->load($path);

$objWorksheet = $objPHPExcel->getActiveSheet(); 
```

我尝试查找 IOFactory 类是否已在某处创建但找不到。

仅供参考，我在撰写本文时使用的是最新版本的 CodeIgniter (2.1) 和 PHPExcel (1.7.6)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T06:11:01.083

不需要写

```
$this->load->library('PHPExcel'); 
```

刚开始

```
$this->load->library('PHPExcel/IOFactory'); 
```

**已编辑 :::**

在我的项目中，我通过这些方式完成了，

第一步：在`libraries\PHPExcel\Reader`

重命名`Excel5.php`为`PHPExcel_Reader_Excel5.php`

第2步：

```
$filePath = $dir.$uploadedfile;
$objReader = $this->load->library('PHPExcel/Reader/PHPExcel_Reader_Excel5', $filePath);
$objReader = new PHPExcel_Reader_Excel5();
$objPHPExcel = $objReader->load($filePath);     
$rowIterator = $objPHPExcel->getActiveSheet()->getRowIterator();                        
$sheet = $objPHPExcel->getActiveSheet();
$maxRowIndex = $sheet->getHighestRow();
$highestColumn = $sheet->getHighestColumn();
$maxColIndex = PHPExcel_Cell::columnIndexFromString($highestColumn); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T16:13:17.430

全部

我正在使用 PHPExcel 通过 CI 和grocery_CRUD 从 MySQL 中的 Excel 上传数据。这是我的方式：

// 我的 Excel CI 库

```
<?php

if (!defined('BASEPATH'))     exit('No direct script access allowed');
require_once APPPATH . "/third_party/PHPExcel/IOFactory.php";
/*
 * PHPExcel Lib For CI
 *
 * Class Excel
 *
 * Using PHP Excel Class
 */
class Lib_excel extends PHPExcel_IOFactory {
    public function __construct() {
    }
}
?> 
```

//我的 Excel CI 模型

```
<?php
// My CI Model for handling all Excel methods
if (!defined('BASEPATH'))     exit('No direct script access allowed');
// Class Model extend with CI Model
class Mod_excel extends CI_Model {
    function __construct() {
        // Call the Model constructor
        parent::__construct();
    }
    /**
     * Read data from Excel file
     * 

     * @input string $excelFileName
     * @input string $columnName (starting column point)
     * @input string $startRow (starting column point)
     * @return array $cellValues
     *
     * @example code
     *  $excelFileName = $_FILES['uploadedfile']['tmp_name'];
     *  $columnName = 'B';
     *  $startRow = '2';
     *  $cellValues = readWithExcel($excelFileName, $columnName, $startRow);
     *  $iterator = new RecursiveIteratorIterator(new RecursiveArrayIterator($cellValues));
     *  foreach($iterator as $value) {
     *      $insert_data[] = $value;
     *  }
     */
    function readWithExcel($excelFileName, $columnName, $startRow) {
        //load our new Lib Excel library as object excel
        $this->load->library('Lib_excel', null, 'excel');
        // load excel file
        $objPHPExcel  = $this->excel->load($excelFileName);
        // get active sheets
        $objWorksheet = $objPHPExcel->getActiveSheet();
        // get highest row column
        $lastRow      = $objWorksheet->getHighestRow();
        // check cell value empty or not
        for ($i = $startRow; $i < $lastRow; $i++) {
            $colB = $objPHPExcel->getActiveSheet()->getCell($columnName . $i)->getValue();
            if ($colB == NULL || $colB == '') {
                die('The Cell' . ' <strong>B' . $i . '</strong> is empty. Please, remove or fill with data');
            }
        }
        // get excel data with range e.g. (B2:B56)
        $cellValues = $objPHPExcel->getActiveSheet()->rangeToArray("$columnName$startRow:$columnName$lastRow");
        // return all data as array
        return $cellValues;
    }
}
?> 
```

// 我的控制器调用方法

```
<?php
// My Admin Controller with grocery CRUD createCouponCode method (URL: admin/createCouponCode)
if (!defined('BASEPATH'))     exit('No direct script access allowed');
class Admin extends CI_Controller {
    /**
     * Just construct method to load 
     */
    function __construct() {
        parent::__construct();
        // Load Model excel and use as object ModExcel
        $this->load->model('Mod_excel', 'ModExcel', true);
        // Load CRUD lib
        $this->load->library('grocery_CRUD');
    }
    /**
     * Upload Coupon Code from Excel
     */
    public function createCouponCode() {
        $crud = new grocery_CRUD();
        $crud->set_table('coupon_code');
        $crud->fields('coupon_no');
        $crud->columns('coupon_no');
        $crud->set_subject('Coupon');
        $crud->required_fields('coupon_no');
        $crud->set_field_upload('coupon_no', '../public/uploads/');
        $crud->callback_before_upload(array(
            $this,
            '_excel_uploaded_file'
        ));
        $output = $crud->render();
        $this->_example_output($output);
    }
    /**
     * Call back Function form CRUD Upload
     * @param array $files_to_upload
     * @param array $field_info
     * @return string
     */
    function _excel_uploaded_file($files_to_upload = array(), $field_info = array()) {
        $insert_data   = array();
        $ext           = '';
        $file_tmp_path = '';
        foreach ($files_to_upload as $value) {
            $ext           = pathinfo($value['name'], PATHINFO_EXTENSION);
            $file_tmp_path = $value['tmp_name'];
        }
        $allowed_formats = array(
            "xlsx"
        );
        if (in_array($ext, $allowed_formats)) {
            $excelFileName = $file_tmp_path;
            $columnName    = 'B';
            $startRow      = '2';
            $cellValues    = $this->ModExcel->readWithExcel($excelFileName, $columnName, $startRow);
            $iterator      = new RecursiveIteratorIterator(new RecursiveArrayIterator($cellValues));
            foreach ($iterator as $value) {
                $insert_data[] = array(
                    'coupon_no' => $value
                );
            }
            $this->output->enable_profiler(TRUE); //Turns on CI debugging
            $this->db->insert_batch('coupon_code', $insert_data);
            echo ($status) ? true : false;
        } else {
            return 'Error: Wrong file format. Use Excel 2007 format';
        }
    }
}
?> 
```

// 我在 CI 中放置 PHPExcel Lib 的文件夹

![在此处输入图像描述](../Images/c968066679b198d9b41183970e97b70b.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-08T06:58:47.453

你可以试试这个，它对我有用：

```
$filePath = "uploads/import/test.xlx";                                  
$this->load->library('PHPExcel');                         
$objReader = new PHPExcel_Reader_Excel5();                        
$objPHPExcel = $objReader->load($filePath);
$sheetData = $objPHPExcel->getActiveSheet()->toArray(null,true,true,true); 
```

# python - 如何从字符串中删除最后 n 个字符？

> ID：10645959
> 
> 赞同：17
> 
> 时间：2012-05-18T02:22:36.517
> 
> 标签：python

如果我有一个字符串并想删除它的最后 4 个字符，我该怎么做？

因此，如果我想从中删除`.bmp`以`Forest.bmp`使其成为`Forest` 唯一我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-05-18T02:24:14.420

这里有两个解决方案。

一般删除最后 4 个字符：

```
s = 'this is a string1234'

s = s[:-4] 
```

产量

```
'this is a string' 
```

更具体地说，针对文件名，考虑[os.path.splitext()](http://docs.python.org/library/os.path.html?highlight=splitext#os.path.splitext)用于将文件名拆分为其基础和扩展名：

```
import os 

s = "Forest.bmp"
base, ext = os.path.splitext(s) 
```

结果是：

```
print base
'Forest'

print ext
'.bmp' 
```

# knockout.js - knockout.js 和渲染表

> ID：10645971
> 
> 赞同：1
> 
> 时间：2012-05-18T02:24:00.110
> 
> 标签：knockout.js, html-table

是否可以在没有无容器控制流语法并具有有效 html 的情况下在下面呈现相同的内容？

```
<tbody data-bind="foreach: dates">
        <tr>
            <td class="empty"></td>
            <td class="date-container" data-bind="attr: { colspan: $parent.gymCourts().length }">
                <div class="date" data-bind="html: date"></div>
            </td>
        </tr>
        <!-- ko foreach: times -->
        <tr class="time-games">
            <td class="time-container">
                <div class="time" data-bind="html: time"></div>
            </td>
            <!-- ko foreach: games -->
            <td class="game-container">
                <div class="game">
                    <span data-bind="html: awayTeam.name"></span> vs. <span data-bind="html: homeTeam.name"></span>
                </div>
            </td>
            <!-- /ko -->
        </tr>
        <!-- /ko -->
    </tbody> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T02:45:56.147

您可以在一个表格中放置多个`tbody`元素，因此如果您能够将您`foreach`的元素放在`table`元素上，那么您可以执行以下操作：

```
​&lt;table data-bind="foreach: dates">
   <tr>
        <td></td>
        <td data-bind="html: date">

        </td>
   </tr>
   <tbody data-bind="foreach: times">
        <tr>
            <td></td>
            <td data-bind="html: time">

            </td>
        </tr>       
    </tbody>
</table>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T02:41:05.230

我不这么认为，但是如果您`<div>`在“表格模式”中使用标签，我认为您可以：

```
<div data-bind="foreach: dates">
    <div style="display: table-row">
        <div style="display: table-cell"></div>
        <div style="display: table-cell" data-bind="html: date"></div>
    </div>
</div>
<div data-bind="foreach: times">
    <div style="display: table-row">
        <div style="display: table-cell"></div>
        <div style="display: table-cell" data-bind="html: time"></div>
    </div>
</div> 
```

# java - Hibernate自定义验证器，如何设置propertyPath？

> ID：10645975
> 
> 赞同：3
> 
> 时间：2012-05-18T02:24:41.300
> 
> 标签：java, hibernate, validation, orm

我们已经实现了一个自定义验证器。

我们得到消息返回 OK，但不是 propertyPath，我们怎样才能把它拉回来？

在我们的对象中实现

```
@RequiredIfSet.List({
        @RequiredIfSet(propertyPath = "reporterFirstName", field = "isFillingOutForSomeoneElse", dependentField = "reporterFirstName", message = "Reporter First may not be null"),
        @RequiredIfSet(propertyPath = "reporterLastName", field = "isFillingOutForSomeoneElse", dependentField = "reporterLastName", message = "Reporter Last may not be null"),
        @RequiredIfSet(propertyPath = "reporterContactPhone", field = "isFillingOutForSomeoneElse", dependentField = "reporterContactPhone", message = "Reporter Contact Phone may not be null"),
        @RequiredIfSet(propertyPath = "reporterEmail", field = "isFillingOutForSomeoneElse", dependentField = "reporterEmail", message = "Reporter Email may not be null")
}) 
```

//约束类

```
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target({ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Constraint(validatedBy = RequiredIfSetValidator.class)
public @interface RequiredIfSet {
    String field();
    String dependentField();

    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
    String message() default "Field Required";
    String propertyPath() default "";

    @Target({ElementType.TYPE, ElementType.ANNOTATION_TYPE})
    @Retention(RetentionPolicy.RUNTIME)
    @Documented
    @interface List {
        RequiredIfSet[] value();
    }
} 
```

//我们遍历无效字段的地方

```
List<String[]> invalidFields = new ArrayList<String[]>();
        Iterator<ConstraintViolation<T>> iterator = cv.iterator();
        while(iterator.hasNext()) {
            ConstraintViolation<T> i = iterator.next();
            String property = i.getPropertyPath().toString();
            String message = i.getMessage();
            invalidFields.add(new String[] { property, message });
        }
        EntityValidationDTO EVDTO = new EntityValidationDTO();
        EVDTO.setStatus("fail");
        EVDTO.setInvalidFields(invalidFields);
        return EVDTO; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T09:58:03.627

在您的“RequiredIfSetValidator”中，在方法中`isValid`添加如下内容：

```
if( !valid ) {
        context.buildConstraintViolationWithTemplate(context.getDefaultConstraintMessageTemplate()).addNode("fieldName").addConstraintViolation();
} 
```

这是官方文档：[http ://docs.jboss.org/hibernate/validator/4.1/reference/en-US/html/validator-customconstraints.html#example-custom-error](http://docs.jboss.org/hibernate/validator/4.1/reference/en-US/html/validator-customconstraints.html#example-custom-error)

# eclipse - GEF 编辑器的 Eclipse 调试器

> ID：10645976
> 
> 赞同：1
> 
> 时间：2012-05-18T02:24:46.957
> 
> 标签：eclipse, eclipse-plugin, eclipse-gef

我有一个代表有限状态机的 GEF 编辑器。编辑器的输入（和输出）是 XML。我正在寻找的是一种直观地调试我的编辑器的方法。

编辑器的工作方式是您创建一个状态 Start->Email->End，创建的 XML 被发送到服务器并发生奇迹，当然 Email 对象具有您设置的属性：从电子邮件，到电子邮件，主题等.我正在寻找的是一种可以启动调试器并逐步执行每个步骤的方法。因此，例如，如果我在电子邮件步骤中断，我将能够看到消息是什么，它是给谁的，以及最后返回的服务器是什么。

这是可以完成的事情吗？如果可以，我需要阅读任何文章来熟悉如何创建这个调试器吗？

我发现了一些关于 Eclipse 调试器（[1](http://www.eclipse.org/articles/Article-Debugger/how-to.html)、[2](http://www.zdnet.com/blog/burnette/eclipsecon-day-1-tutorial-the-eclipse-debug-framework/35)）的讨论，但没有关于我感兴趣的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T08:49:10.950

这里有两个不同的问题。

一个是编写一个调试器引擎，它管理模型的执行，例如分步执行，允许查询变量/状态等，另一个是在编辑器中输出结果。

您链接的文章与第一个问题有关：创建一个在后台执行模型的引擎，并将引擎集成到 Eclipse 环境中，使用 1）启动框架以类似于 Java 程序执行它，以及 2）允许显示在文本编辑器中声明。

您想在图形编辑器中显示状态。因为图形编辑器的共同点要少得多，调试状态的反向注释必须手动完成（而不是对文本编辑器的通用支持）。基本上，我会创建设置断点的操作，并更新模型以便能够存储/查询执行状态，然后更新 GEF 视图以将其显示在 GUI 上。为此，您必须至少更改您的 Figures 和 EditParts，并且可能还需要更改其他地方。

# c++ - OpenFrameworks - 减去 GL 窗口

> ID：10645982
> 
> 赞同：1
> 
> 时间：2012-05-18T02:25:35.237
> 
> 标签：c++, opencv, openframeworks

我有一个项目，其中涉及 OpenCV 以及其他一些与媒体相关的功能，在使用 OpenFrameworks 之后，它似乎非常适合这项任务，几乎完美；）

这个项目实际上是一个 Flash 项目，我有一个与 C++ 的工作连接，用于所有图像处理以提高速度。问题是 OpenFrameworks 需要在 ofRunApp 之前初始化以下代码：

```
ofAppGlutWindow window;
ofSetupOpenGL(&window, 1024,768, OF_WINDOW); // <-------- setup the GL context 
```

有没有一种简单的方法可以在不打开任何窗口的情况下使用 OpenFrameworks 中的 OpenCV 相关功能？只是为了记录，我更喜欢使用 OpenFrameworks 而不是普通的 OpenCV 来获得 OF 的灵活性及其其他功能。

在此先感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T08:16:50.663

使用 openFrameworks 没有“官方”的方式来做到这一点。

由于 openFrameworks 具有可交换的渲染器，您可以编写一个来执行此操作。但这似乎需要做很多工作，因为许多 openFrameworks 内部依赖于窗口和 GL 上下文。

[您可以在此处](http://forum.openframeworks.cc/index.php/topic,1876.0.html)和[此处](http://forum.openframeworks.cc/index.php/topic,3253.0.html)找到解决此问题的最有希望的尝试。也许您可以自己搜索 openFrameworks 以找到更多信息。更好的是：随意开始一个新主题，让人们看到需要无头渲染。

# facebook - Facebook Auth Dialog Preview 与实际登录不同

> ID：10645983
> 
> 赞同：3
> 
> 时间：2012-05-18T02:25:44.020
> 
> 标签：facebook, user-interface

facebook Auth Dialog 预览显示

“该应用程序可能会在您的 behlaf 上发布......”

但是当我尝试登录时，该选项不存在，而用户可以登录。不会发帖。

为什么它们不同，我怎样才能代表我的帖子登录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T23:42:08.490

我遇到了这个问题，并通过使用请求正确权限的范围参数来解决它。

# python - 自定义排序python

> ID：10645986
> 
> 赞同：8
> 
> 时间：2012-05-18T02:25:57.413
> 
> 标签：python, sorting

我有一个问题：这是由 ElementTree 库形成的列表列表。

```
 [['word1', <Element tag at b719a4cc>], ['word2', <Element tag at b719a6cc>], ['word3', <Element tag at b719a78c>], ['word4', <Element tag at b719a82c>]] 
```

word1..4 可能包含 unicode 字符，即 (â,ü,ç)。

**我想按我的自定义字母表对这个列表列表进行排序。**

我知道如何从这里按自定义字母 [排序，在 python 中排序单词](https://stackoverflow.com/questions/3037407/sorting-words-in-python)

我也知道如何从这里按键排序[http://wiki.python.org/moin/HowTo/Sorting](http://wiki.python.org/moin/HowTo/Sorting)

问题是我找不到如何应用这两种方法对我的“列表列表”进行排序的方法。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-18T03:16:51.727

您的第一个链接或多或少地解决了问题。您只需要让 lambda 函数只查看列表中的第一项：

```
alphabet = "zyxwvutsrqpomnlkjihgfedcba"

new_list = sorted(inputList, key=lambda word: [alphabet.index(c) for c in word[0]]) 
```

如果您要对相当大的列表进行排序，我可能建议的一个修改是首先将字母结构更改为 dict，以便索引查找更快：

```
alphabet_dict = dict([(x, alphabet.index(x)) for x in alphabet)
new_list = sorted(inputList, key=lambda word: [alphabet_dict[c] for c in word[0]]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T03:14:39.543

如果我对您的理解正确，您想知道当键应该应用于对象的元素时如何应用键排序技术。换句话说，您希望将键功能应用于“wordx”，而不是您实际排序的 ['wordx', ...] 元素。在这种情况下，您可以这样做：

```
my_alphabet = "..."

def my_key(elem):
    word = elem[0]
    return [my_alphabet.index(c) for c in word]

my_list.sort(key=my_key) 
```

或使用第一个链接中的样式：

```
my_alphabet = "..."
my_list.sort(key=lambda elem: [my_alphabet.index(c) for c in elem[0]]) 
```

请记住， my_list.sort 将就地排序，实际上会修改您的列表。sorted(my_list, ...) 将返回一个新的排序列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T17:21:54.273

效果很好！！！感谢您的帮助这是我的故事：我有 xdxf 格式的土耳其-俄语词典。问题是对它进行排序。我在这里找到了解决方案[http://effbot.org/zone/element-sort.htm](http://effbot.org/zone/element-sort.htm)但它没有对 unicode 字符进行排序。这是最终的源代码：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import xml.etree.ElementTree as ET
import codecs
alphabet = u"aâbcçdefgğhiıjklmnoöpqrstuüvwxyz"
tree = ET.parse("dict.xml")
# this element holds the phonebook entries
container = tree.find("entries")
data = []
for elem in container:
    keyd = elem.findtext("k")
    data.append([keyd, elem])
data.sort(key=lambda data: [alphabet.index(c) for c in data[0]])
container[:] = [item[-1] for item in data]
tree.write("new-dict.xml", encoding="utf-8") 
```

dict.xml 的示例内容

```
<cont>
  <entries>
<ar><k>â</k>def1</ar>
<ar><k>a</k>def1</ar>
<ar><k>g</k>def1</ar>
<ar><k>w</k>def1</ar>
<ar><k>n</k>def1</ar>
<ar><k>u</k>def1</ar>
<ar><k>ü</k>def1</ar>
<ar><k>âb</k>def1</ar>
<ar><k>ç</k>def1</ar>
<ar><k>v</k>def1</ar>
<ar><k>ac</k>def1</ar>
  </entries>
</cont> 
```

感谢所有人

# php - 错误捕获 LOAD DATA LOCAL INFILE 的最佳方法？

> ID：10645988
> 
> 赞同：6
> 
> 时间：2012-05-18T02:26:02.683
> 
> 标签：php, mysql, csv

我是一个 MySQL 新手，完成了我的 webapp 的核心代码。该代码会导入一个 CSV 文件（本地），该文件由 FileMaker 生成和清理并保留。

鉴于这将很快投入生产（并且可能是一个低于 500mb 的数据库），我很想知道是否有更好的错误检查/捕获我可以做以防止出现问题或被提醒我的服务器设置。我已经阅读了有关临时日志等的内容，而我的 MySQL 管理还没有达到标准。

非常基本的代码是：

```
$m = mysql_connect('localhost', 'mytable', 'mypassword');
$db = 'mydb';
mysql_select_db($db) or die("Import Error - Couldn't select database: " . mysql_error());

$sql = 'load data local infile "inventory.csv"
        into table ibl_account_details_temp fields terminated by ","
        optionally enclosed by "\""
        lines terminated by "\r"
        (store_id, SKU, account, item_number, brand, description, size, category, price, qty, fees)
        ';

echo mysql_query($sql) or die(myqsl_error()); 
```

**PS 编辑：我也很想知道这种导入方法是否对 SQL 注入开放？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T02:42:02.967

不幸的是，加载数据文件的错误处理非常糟糕。我几乎每天都在使用它，将其导入某种临时表并使用 PHP 和 MySQL 的组合来验证导入的内容已成为简单的例程。有人可以说这是额外的工作，但它确实具有让我完全控制什么是“错误”的优势。简单地说，我使用它来尽可能高效地获取原始数据，然后在 php 脚本中构建我的错误检查和验证规则。

# ruby - Ruby：不能将枚举器强制为 Fixnum；与 Project Euler #5 斗争

> ID：10645993
> 
> 赞同：1
> 
> 时间：2012-05-18T02:26:52.120
> 
> 标签：ruby, fixnum

挑战在于找到满足以下`foo`条件的最小整数：

```
foo % 1..20 == 0 
```

我目前的尝试是蛮力

```
until foo % 1.upto(20) == 0 do
    foo++
end 
```

这会输出错误`unexpected keyword end`。但是，如果我不将`end`关键字放入 irb 代码将永远不会运行，因为该块没有关闭。

我做了一个空的测试用例来看看我的错误在哪里

```
until foo % 1.upto(20) == 0 do
end 
```

这会引发一个新错误：`enumerator can't be coerced to a fixnum`. 我想这意味着您不能直接在一个范围内执行模数并期望整个范围内都有一个简洁的布尔结果。但我不知道从这里去哪里。

我的第一次尝试不是蛮力，而是倾向于尝试更有效/优雅/切中要害的东西，如下所示：

```
foo = 1
1.upto(20) {|bar| foo *= bar unless foo % i == 0} 
```

给出了错误的答案。我不明白为什么，但我也对为什么感兴趣

```
foo = 1
20.downto(1) {|bar| foo *= bar unless foo % i == 0} 
```

输出不同的答案。

**编辑：**我会使用 for 循环（我在 ActionScript 中进行编程时弄湿了我的脚），但它们在 ruby​​ 中无法正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T02:37:48.937

您的第一个解决方案是错误的，因为`1.upto(20)`它是*enumerator*，即本质上是值 1 到 20 的迭代器，并且它不能用作模数或与另一个数字进行比较的数字，因为它本身不是数字。

你真的需要两个“循环”：

```
foo = 1
foo += 1 until (1..20).all? { |i| foo % i == 0 } 
```

第一个循环是`until`，然后[`all?`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-all-3F)是另一个循环，因为它确保块 ( `{ |i| foo % i == 0 }`) 对于调用它的范围内的每个元素都是正确的 ( `(1..20)`)。请注意，我使用的是单行“向后”语法（也适用于`if`, `unless`, `while`, ...）——以上等价于：

```
foo = 1
until (1..20).all? { |i| foo % i == 0 } do
  foo += 1
end
# foo => 232792560 
```

此外，这是非常低效的，Euler 项目通常涉及比编程更多的数学，并且非暴力解决方案可能会涉及更多的数学，但速度要快得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T02:34:08.047

试试这个：

```
until 1.upto(20).reject{|i| foo % i == 0 }.empty? do
  foo += 1
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-16T18:48:44.037

我知道这不是直接的 OP 问题，但这更容易实现：

```
puts (1..20).reduce(:lcm) 
```

它是如此简单，以这种方式解决它似乎不公平，但这正是为什么 Ruby 是我选择 Project Euler 的语言的原因。

另请参阅[此问题](https://stackoverflow.com/questions/10783538/getting-the-least-common-multiple-of-an-array-of-integers-in-ruby "在Ruby中获取整数数组的最小公倍数")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T02:41:40.757

如果这是我，我会定义一个函数来测试条件：

```
def mod_test(num)
  test = (1..20).map {|i| num % i == 0}
  test.all? # all are true
end 
```

然后循环尝试不同的值：

```
foo = 20
until mod_test(foo) do
  foo += 20
end 
```

（感谢[Dylan](https://stackoverflow.com/questions/10645993/ruby-enumerator-cant-be-coerced-to-fixnum-struggling-with-project-euler-5#comment13803436_10646022)的`+= 20`加速。）

我敢肯定，有一种聪明的方法可以使用 的知识`foo % 10 == 0`来暗示`foo % 5 == 0`and ，并且只对and`foo % 2 == 0`之间的素数执行测试，甚至可能使用该信息直接构造数字——但我的代码运行得足够快。`1``20`

# javascript - 如何使用 NodeJS 将 UTC 日期格式化为 `YYYY-MM-DD hh:mm:ss` 字符串？

> ID：10645994
> 
> 赞同：315
> 
> 时间：2012-05-18T02:27:30.130
> 
> 标签：javascript, node.js, date

使用 NodeJS，我想将 a 格式化`Date`为以下字符串格式：

```
var ts_hms = new Date(UTC);
ts_hms.format("%Y-%m-%d %H:%M:%S"); 
```

我怎么做？

* * *

## 回答 #1

> 赞同：668
> 
> 时间：2012-11-04T14:57:21.977

如果你使用 Node.js，你肯定有 EcmaScript 5，所以 Date 有一个`toISOString`方法。您要求对 ISO8601 稍作修改：

```
new Date().toISOString()
> '2012-11-04T14:51:06.157Z' 
```

所以只要删掉一些东西，你就可以了：

```
new Date().toISOString().
  replace(/T/, ' ').      // replace T with a space
  replace(/\..+/, '')     // delete the dot and everything after
> '2012-11-04 14:55:45' 
```

或者，在一行中：`new Date().toISOString().replace(/T/, ' ').replace(/\..+/, '')`

ISO8601 必然是 UTC（也由第一个结果的尾随 Z 表示），因此默认情况下您会得到 UTC（总是一件好事）。

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2012-05-23T09:25:50.433

2021-10-06 更新：添加了 Day.js 并删除了 @ashleedawg 的虚假编辑 2021-04-07
更新：@Tampa 添加了 Luxon。
更新 2021-02-28：现在应该注意 Moment.js 不再被积极开发。它不会很快消失，因为它嵌入了许多其他事物中。该网站提供了一些[替代](https://momentjs.com/docs/#/-project-status/recommendations/)建议并解释了原因。
更新 2017-03-29：添加了 date-fns，关于 Moment 和 Datejs 的一些注释
更新 2016-09-14：添加了 SugarJS，它似乎具有一些出色的日期/时间功能。

* * *

好的，由于没有人真正提供实际答案，这是我的。

图书馆无疑是以标准方式处理日期和时间的最佳选择。日期/时间计算中有很多边缘情况，因此能够将开发移交给库是很有用的。

以下是主要**Node**兼容时间格式化库的列表：

*   [**Day.js**](https://day.js.org/) [*添加于 2021-10-06* ] “具有相同现代 API 的 Moment.js 的快速 2kB 替代方案”
*   [**Luxon**](https://moment.github.io/luxon/index.html) [*于 2017 年 3 月 29 日添加，感谢 Tampa* ] “一个强大、现代且友好的 JavaScript 日期和时间包装器。” - MomentJS 使用不可变类型、链接等从头开始重建。
*   [**Moment.js**](http://momentjs.com/) [*感谢 Mustafa* ]“用于解析、操作和格式化日期的轻量级 (4.3k) javascript 日期库” - 包括国际化、计算和相对日期格式 - *2017-03-29 更新*：不太轻量级更多但仍然是最全面的解决方案，特别是如果您需要时区支持。- *2021-02-28 更新*：不再积极开发。
*   [**date-fns**](https://date-fns.org/) [*添加于 2017-03-29，感谢 Fractalf* ] 小，快，适用于标准 JS 日期对象。如果您不需要时区支持，则是 Moment 的绝佳替代品。
*   [**SugarJS**](https://sugarjs.com/) - 一个通用的帮助库，为 JavaScript 的内置对象类型添加了急需的特性。包括一些出色的日期/时间功能。
*   [**strftime**](https://github.com/samsonjs/strftime) - 正如它所说的那样，简单明了
*   [**dateutil**](https://github.com/borgar/dateutil) - 这是我在 MomentJS 之前使用的那个
*   [**节点格式日期**](https://github.com/dodo/node-formatdate)
*   [**TimeTraveller**](https://github.com/hgarcia/TimeTraveller) - “Time Traveler 提供了一组实用方法来处理日期。从加减法到格式化。Time Traveler 仅扩展它创建的日期对象，而不会污染全局命名空间。”
*   [**Tempus**](http://tempus-js.com/) [*感谢 Dan D* ] - 更新：这也可以与 Node 一起使用并与 npm 一起部署，请参阅文档

还有**非节点**库：

*   [**Datejs**](http://www.datejs.com/) [*感谢 Peter Olson* ] - 未打包在 npm 或 GitHub 中，因此与 Node 一起使用不太容易 - 不推荐，因为自 2007 年以来未更新！

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2013-08-29T10:50:21.683

有一个用于转换的库：

```
npm install dateformat 
```

然后写下你的要求：

```
var dateFormat = require('dateformat'); 
```

然后绑定值：

```
var day=dateFormat(new Date(), "yyyy-mm-dd h:MM:ss"); 
```

见[日期格式](https://github.com/felixge/node-dateformat)

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2012-05-18T05:41:14.340

总的来说，我对图书馆没有任何反对意见。在这种情况下，通用库似乎有点过头了，除非应用程序过程的其他部分过时了。

编写这样的小型实用程序函数对于初学者和成熟的程序员来说也是一个有用的练习，并且可以成为我们中间新手的学习经验。

```
function dateFormat (date, fstr, utc) {
  utc = utc ? 'getUTC' : 'get';
  return fstr.replace (/%[YmdHMS]/g, function (m) {
    switch (m) {
    case '%Y': return date[utc + 'FullYear'] (); // no leading zeros required
    case '%m': m = 1 + date[utc + 'Month'] (); break;
    case '%d': m = date[utc + 'Date'] (); break;
    case '%H': m = date[utc + 'Hours'] (); break;
    case '%M': m = date[utc + 'Minutes'] (); break;
    case '%S': m = date[utc + 'Seconds'] (); break;
    default: return m.slice (1); // unknown code, remove %
    }
    // add leading zero if required
    return ('0' + m).slice (-2);
  });
}

/* dateFormat (new Date (), "%Y-%m-%d %H:%M:%S", true) returns 
   "2012-05-18 05:37:21"  */ 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2016-03-14T22:27:50.483

无需使用任何库即可获得所需格式的时间戳的易于阅读和可定制的方式：

```
function timestamp(){
  function pad(n) {return n<10 ? "0"+n : n}
  d=new Date()
  dash="-"
  colon=":"
  return d.getFullYear()+dash+
  pad(d.getMonth()+1)+dash+
  pad(d.getDate())+" "+
  pad(d.getHours())+colon+
  pad(d.getMinutes())+colon+
  pad(d.getSeconds())
} 
```

（如果您需要 UTC 格式的时间，那么只需更改函数调用。例如“getMonth”变为“getUTCMonth”）

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2020-06-26T19:37:44.910

检查下面的代码和指向[MDN的链接](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date)

```
// var ts_hms = new Date(UTC);
// ts_hms.format("%Y-%m-%d %H:%M:%S")

// exact format
console.log(new Date().toISOString().replace('T', ' ').substring(0, 19))

// other formats
console.log(new Date().toUTCString())
console.log(new Date().toLocaleString('en-US'))
console.log(new Date().toString())
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2013-04-12T17:18:34.650

javascript 库 Sugar.js ( [http://sugarjs.com/](http://sugarjs.com/) ) 具有格式化日期的功能

例子：

```
Date.create().format('{dd}/{MM}/{yyyy} {hh}:{mm}:{ss}.{fff}') 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2018-07-11T00:52:01.430

我在 Nodejs 和 angularjs 使用[dateformat](https://github.com/felixge/node-dateformat)，非常好

安装

```
$ npm install dateformat
$ dateformat --help 
```

演示

```
var dateFormat = require('dateformat');
var now = new Date();

// Basic usage
dateFormat(now, "dddd, mmmm dS, yyyy, h:MM:ss TT");
// Saturday, June 9th, 2007, 5:46:21 PM

// You can use one of several named masks
dateFormat(now, "isoDateTime");
// 2007-06-09T17:46:21

// ...Or add your own
dateFormat.masks.hammerTime = 'HH:MM! "Can\'t touch this!"';
dateFormat(now, "hammerTime");
// 17:46! Can't touch this!

// You can also provide the date as a string
dateFormat("Jun 9 2007", "fullDate");
// Saturday, June 9, 2007
... 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-02-27T03:41:22.710

使用 Date 对象中提供的方法如下：

```
var ts_hms = new Date();

console.log(
    ts_hms.getFullYear() + '-' + 
    ("0" + (ts_hms.getMonth() + 1)).slice(-2) + '-' + 
    ("0" + (ts_hms.getDate())).slice(-2) + ' ' +
    ("0" + ts_hms.getHours()).slice(-2) + ':' +
    ("0" + ts_hms.getMinutes()).slice(-2) + ':' +
    ("0" + ts_hms.getSeconds()).slice(-2)); 
```

它看起来很脏，但它应该可以与 JavaScript 核心方法一起工作

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-10-10T13:32:21.723

```
new Date(2015,1,3,15,30).toLocaleString()

//=> 2015-02-03 15:30:00 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-04-29T13:12:04.783

替代#6233....

`toLocaleDateString()`将 UTC 偏移量添加到本地时间，然后使用对象的方法将其转换为所需的格式`Date`：

```
// Using the current date/time
let now_local = new Date();
let now_utc = new Date();

// Adding the UTC offset to create the UTC date/time
now_utc.setMinutes(now_utc.getMinutes() + now_utc.getTimezoneOffset())

// Specify the format you want
let date_format = {};
date_format.year = 'numeric';
date_format.month = 'numeric';
date_format.day = '2-digit';
date_format.hour = 'numeric';
date_format.minute = 'numeric';
date_format.second = 'numeric';

// Printing the date/time in UTC then local format
console.log('Date in UTC: ', now_utc.toLocaleDateString('us-EN', date_format));
console.log('Date in LOC: ', now_local.toLocaleDateString('us-EN', date_format)); 
```

我正在创建一个默认为当地时间的日期对象。我正在向它添加 UTC 偏移量。我正在创建一个日期格式对象。我正在以所需的格式显示 UTC 日期/时间：

[![在此处输入图像描述](../Images/3fa56e39f2671be54bee244c157839ba.png)](https://i.stack.imgur.com/ncxK5.png)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2020-03-20T07:18:32.587

对于日期格式，最简单的方法是使用 moment lib。[https://momentjs.com/](https://momentjs.com/)

```
const moment = require('moment')
const current = moment().utc().format('Y-M-D H:M:S') 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-05-31T01:35:01.477

在反映您的时区时，您可以使用它

```
var datetime = new Date();
var dateString = new Date(
  datetime.getTime() - datetime.getTimezoneOffset() * 60000
);
var curr_time = dateString.toISOString().replace("T", " ").substr(0, 19);
console.log(curr_time);
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-07-17T15:17:54.547

使用模块，它是[**x-class**](https://github.com/abdennour/xclass)[库](https://github.com/abdennour/xclass)`x-date`的子模块之一；[](https://github.com/abdennour/xclass)

 **```
require('x-date') ; 
  //---
 new Date().format('yyyy-mm-dd HH:MM:ss')
  //'2016-07-17 18:12:37'
 new Date().format('ddd , yyyy-mm-dd HH:MM:ss')
  // 'Sun , 2016-07-17 18:12:51'
 new Date().format('dddd , yyyy-mm-dd HH:MM:ss')
 //'Sunday , 2016-07-17 18:12:58'
 new Date().format('dddd ddSS of mmm , yy')
  // 'Sunday 17thth +0300f Jul , 16'
 new Date().format('dddd ddS  mmm , yy')
 //'Sunday 17th  Jul , 16' 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-05-17T21:25:19.850

我需要一个没有语言环境和语言支持的花里胡哨的简单格式库。所以我修改了

[http://www.mattkruse.com/javascript/date/date.js](http://www.mattkruse.com/javascript/date/date.js)

并使用它。见[https://github.com/adgang/atom-time/blob/master/lib/dateformat.js](https://github.com/adgang/atom-time/blob/master/lib/dateformat.js)

文档很清楚。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-02-11T20:04:55.840

Here's a handy vanilla one-liner (adapted from [this](https://stackoverflow.com/a/67767046/1166371)):

```
var timestamp = 
  new Date((dt = new Date()).getTime() - dt.getTimezoneOffset() * 60000)
  .toISOString()
  .replace(/(.*)T(.*)\..*/,'$1 $2')
console.log(timestamp)
```

Output: `2022-02-11 11:57:39`

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-07-15T07:35:51.183

这是我编写的一个轻量级库[simple-date-format ，适用于 node.js 和浏览器](https://github.com/riversun/simple-date-format)

**安装**

*   使用 NPM 安装

```
npm install @riversun/simple-date-format 
```

或者

*   直接加载（用于浏览器），

```
<script src="https://cdn.jsdelivr.net/npm/@riversun/simple-date-format/lib/simple-date-format.js"></script> 
```

**加载库**

*   ES6

```
import SimpleDateFormat from "@riversun/simple-date-format"; 
```

*   CommonJS (node.js)

```
const SimpleDateFormat = require('@riversun/simple-date-format'); 
```

**用法1**

```
const date = new Date('2018/07/17 12:08:56');
const sdf = new SimpleDateFormat();
console.log(sdf.formatWith("yyyy-MM-dd'T'HH:mm:ssXXX", date));//to be "2018-07-17T12:08:56+09:00" 
```

[在笔上运行](https://codepen.io/riversun/pen/zYrJjgj)

**用法2**

```
const date = new Date('2018/07/17 12:08:56');
const sdf = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssXXX");
console.log(sdf.format(date));//to be "2018-07-17T12:08:56+09:00" 
```

**格式化模式**

[https://github.com/riversun/simple-date-format#pattern-of-the-date](https://github.com/riversun/simple-date-format#pattern-of-the-date)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-01-16T00:05:43.383

```
new Date().toString("yyyyMMddHHmmss").
      replace(/T/, ' ').  
      replace(/\..+/, '') 
```

> 使用 .toString()，这变成了格式
> 
> 替换（/T/，''）。//将 T 替换为 ' ' 2017-01-15T...
> 
> replace(/..+/, '') //for ...13:50:16.1271

例如，请参见 var`date`和`hour`：

```
var date="2017-01-15T13:50:16.1271".toString("yyyyMMddHHmmss").
                    replace(/T/, ' ').      
                    replace(/\..+/, '');

                    var auxCopia=date.split(" ");
                    date=auxCopia[0];
                    var hour=auxCopia[1];

console.log(date);
console.log(hour);
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-01-03T16:47:58.850

从“日期格式”导入日期格式；var ano = 新日期（）

```
<footer>
    <span>{props.data.footer_desc} <a href={props.data.footer_link}>{props.data.footer_text_link}</a> {" "}
    ({day = dateFormat(props.data.updatedAt, "yyyy")})
            </span>
</footer> 
```

[罗达佩](https://i.stack.imgur.com/cdlC4.jpg)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-08-23T05:28:53.450

```
appHelper.validateDates = function (start, end) {
    var returnval = false;

    var fd = new Date(start);
    var fdms = fd.getTime();
    var ed = new Date(end);
    var edms = ed.getTime();
    var cd = new Date();
    var cdms = cd.getTime();

    if (fdms >= edms) {
        returnval = false;
        console.log("step 1");
    }
    else if (cdms >= edms) {
        returnval = false;
        console.log("step 2");
    }
    else {
        returnval = true;
        console.log("step 3");
    }
    console.log("vall", returnval)
    return returnval;
} 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2018-05-07T21:07:46.070

**我认为这实际上回答了你的问题。**

在 javascript 中使用日期/时间非常烦人。经过几根白发后，我发现这实际上很简单。

```
var date = new Date();
var year = date.getUTCFullYear();
var month = date.getUTCMonth();
var day = date.getUTCDate();
var hours = date.getUTCHours();
var min = date.getUTCMinutes();
var sec = date.getUTCSeconds();

var ampm = hours >= 12 ? 'pm' : 'am';
hours = ((hours + 11) % 12 + 1);//for 12 hour format

var str = month + "/" + day + "/" + year + " " + hours + ":" + min + ":" + sec + " " + ampm;
var now_utc =  Date.UTC(str); 
```

[这是一个小提琴](https://jsfiddle.net/jroel/7ohapqm1/)**