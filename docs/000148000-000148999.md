# StackOverflow 问答 000148000-000148999

# c++ - 查找数字数组中最大差异的算法

> ID：148003
> 
> 赞同：18
> 
> 时间：2008-09-29T08:55:56.423
> 
> 标签：c++, algorithm, statistics

我有几百万个数字的数组。

```
double* const data = new double (3600000); 
```

我需要遍历数组并找到范围（数组中的最大值减去最小值）。但是，有一个问题。我只想找到最小值和最大值在 1,000 个样本内的范围。

所以我需要找到最大值：range(data + 0, data + 1000), range(data + 1, data + 1001), range(data + 2, data + 1002), ...., range(data + 3599000，数据 + 3600000）。

我希望这是有道理的。基本上我可以像上面那样做，但是如果存在的话，我正在寻找一种更有效的算法。我觉得上面的算法是O(n)，但是我觉得可以优化。我正在玩的一个想法是跟踪最近的最大值和最小值以及它们有多远，然后只在必要时回溯。

我将在 C++ 中对此进行编码，但是在伪代码中使用一个不错的算法就可以了。另外，如果我要查找的这个号码有名字，我很想知道它是什么。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-29T09:14:24.210

这类问题属于称为流式算法的算法分支。它研究的问题不仅需要 O(n) 解决方案，还需要一次性处理数据。数据作为流输入到算法中，算法无法保存所有数据，然后永远丢失。算法需要得到一些关于数据的答案，例如最小值或中值。

具体来说，您正在寻找流上方窗口中的最大值（或更常见的文献中的最小值）。

[这是一篇文章的演示文稿](http://www.cs.tau.ac.il/~matias/courses/Seminar_Spring03/Estimating%20Rarity%20and%20Similarity%20over%20Data%20stream%20Windows.ppt)，该[文章](http://www-cs-students.stanford.edu/~datar/papers/esa02-streams.ps)提到这个问题是他们试图解决的问题的一个子问题。它可能会给你一些想法。

我认为解决方案的概要是这样的——在流上维护窗口，在每个步骤中，一个元素被插入到窗口中，一个元素从另一侧移除（滑动窗口）。您实际保存在内存中的项目并不是窗口中的 1000 个项目的全部，而是一个选定的代表，它们将成为最小值（或最大值）的良好候选者。

阅读文章。它有点复杂，但经过 2-3 次阅读后，您就可以掌握它的窍门。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-29T09:07:04.477

您描述的算法实际上是 O(N)，但我认为常数太高了。另一个看起来合理的解决方案是通过以下方式使用 O(N*log(N)) 算法：

```
* create sorted container (std::multiset) of first 1000 numbers
* in loop (j=1, j<(3600000-1000); ++j)
   - calculate range
   - remove from the set number which is now irrelevant (i.e. in index *j - 1* of the array)
   - add to set new relevant number  (i.e. in index *j+1000-1* of the array) 
```

我相信它应该更快，因为常数要低得多。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-29T09:21:26.937

这是**最小队列**的一个很好的应用- 一个队列（先进先出 = FIFO），它可以同时跟踪它包含的最小元素，并具有摊销的恒定时间更新。当然，max-queue 基本上是一样的。

一旦你有了这个数据结构，你可以考虑 CurrentMax（过去 1000 个元素）减去 CurrentMin，将其存储为 BestSoFar，然后推送一个新值并弹出旧值，然后再次检查。这样，不断更新 BestSoFar 直到最终值是您问题的解决方案。每一步都需要摊销的常数时间，所以整个事情是线性的，而且我知道的实现有一个很好的标量常数（它很快）。

我不知道有关 min-queue 的任何文档 - 这是我与同事合作提出的数据结构。您可以通过在内部跟踪数据的每个连续子序列中最少元素的二叉树来实现它。它简化了您只能从结构的一端弹出数据的问题。

如果您对更多细节感兴趣，我可以尝试提供。我正在考虑将这个数据结构写成 arxiv 的论文。另请注意，Tarjan 和其他人之前提出了一个更强大的 min-deque 结构，可以在这里工作，但实现要复杂得多。你可以在[谷歌上搜索“mindeque”](http://www.google.com/search?q=mindeque)来了解 Tarjan 等人的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T19:38:12.760

算法思路：

取数据的前 1000 个值并对它们进行排序 排序
中的最后一个 - 第一个是 range(data + 0, data + 999)。
然后从排序堆中删除值为 data[0] 的第一个元素
并添加元素 data[1000]
现在，排序中的最后一个 - 第一个是 range(data + 1, data + 1000)。
重复直到完成

```
// This should run in (DATA_LEN - RANGE_WIDTH)log(RANGE_WIDTH)
#include <set>
#include <algorithm>
using namespace std;

const int DATA_LEN = 3600000;
double* const data = new double (DATA_LEN);

....
....

const int RANGE_WIDTH = 1000;
double range = new double(DATA_LEN - RANGE_WIDTH);
multiset<double> data_set;
data_set.insert(data[i], data[RANGE_WIDTH]);

for (int i = 0 ; i < DATA_LEN - RANGE_WIDTH - 1 ; i++)
{
   range[i] = *data_set.end() - *data_set.begin();
   multiset<double>::iterator iter = data_set.find(data[i]);
   data_set.erase(iter);
   data_set.insert(data[i+1]);
}
range[i] = *data_set.end() - *data_set.begin();

// range now holds the values you seek 
```

您可能应该通过 1 个错误来检查它，但想法就在那里。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T19:59:55.390

```
std::multiset<double> range;
double currentmax = 0.0;
for (int i = 0;  i < 3600000;  ++i)
{
    if (i >= 1000)
        range.erase(range.find(data[i-1000]));
    range.insert(data[i]);
    if (i >= 999)
        currentmax = max(currentmax, *range.rbegin());
} 
```

**注意**未经测试的代码。

**编辑：**修正了一个错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T15:03:19.027

1.  读入前 1000 个数字。
2.  创建一个包含 1000 个元素的链表来跟踪当前的 1000 个数字。
3.  创建一个包含 1000 个元素的指向链表节点的指针数组，1-1 映射。
4.  根据链表节点的值对指针数组进行排序。这将重新排列数组，但保持链表不变。
5.  您现在可以通过检查指针数组的第一个和最后一个元素来计算前 1000 个数字的范围。
6.  删除第一个插入的元素，它是头部或尾部，具体取决于您制作链表的方式。使用节点的值对指针数组进行二分查找，找到要删除的节点的指针，然后将数组移动一格以删除它。
7.  通过执行插入排序的一步，将第 1001 个元素添加到链表中，并在数组中的正确位置插入指向它的指针。这将使数组保持排序。
8.  现在你有分钟。和最大。1 到 1001 之间的数字的值，并且可以使用指针数组的第一个和最后一个元素计算范围。
9.  现在应该很明显您需要对阵列的其余部分做什么。

该算法应该是 O(n)，因为删除和插入以 log(1e3) 为界，其他一切都需要恒定的时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T21:58:31.287

我决定看看我能想到的解决这个问题的最有效算法是使用实​​际代码和实际时间。我首先创建了一个简单的解决方案，一个使用循环缓冲区跟踪前 n 个条目的最小/最大值的解决方案，以及一个测量速度的测试工具。在简单的解决方案中，将每个数据值与一组最小值/最大值进行比较，这就是 window_size * count 测试（其中原始问题中的窗口大小为 1000，count 为 3600000）。

然后我在想如何让它更快。首先，我创建了一个解决方案，它使用 fifo 队列来存储 window_size 值和链表以升序存储值，其中链表中的每个节点也是队列中的一个节点。为了处理一个数据值，fifo 末尾的项被从链表和队列中删除。新值被添加到队列的开头，并使用线性搜索来查找链表中的位置。然后可以从链表的开头和结尾读取最小值和最大值。这很快，但不会随着 window_size 的增加（即线性）而很好地扩展。

所以我决定在系统中添加一棵二叉树来尝试加快算法的搜索部分。window_size = 1000 和 count = 3600000 的最终时间是：

```
Simple: 106875
Quite Complex: 1218
Complex: 1219 
```

这既是意料之中的，也是出乎意料的。预期使用排序链表会有所帮助，但意外的是拥有自平衡树的开销并没有抵消更快搜索的优势。我尝试了增加窗口大小的后两者，发现它们总是几乎相同，直到 window_size 为 100000。

这一切都表明，关于算法的理论化是一回事，实现它们是另一回事。

无论如何，对于那些感兴趣的人，这是我编写的代码（有很多！）：

范围.h：

```
#include <algorithm>
#include <iostream>
#include <ctime>

using namespace std;

//  Callback types.
typedef void (*OutputCallback) (int min, int max);
typedef int (*GeneratorCallback) ();

//  Declarations of the test functions.
clock_t Simple (int, int, GeneratorCallback, OutputCallback);
clock_t QuiteComplex (int, int, GeneratorCallback, OutputCallback);
clock_t Complex (int, int, GeneratorCallback, OutputCallback); 
```

主.cpp：

```
#include "Range.h"

int
  checksum;

//  This callback is used to get data.
int CreateData ()
{
  return rand ();
}

//  This callback is used to output the results.
void OutputResults (int min, int max)
{
  //cout << min << " - " << max << endl;
  checksum += max - min;
}

//  The program entry point.
void main ()
{
  int
    count = 3600000,
    window = 1000;

  srand (0);
  checksum = 0;
  std::cout << "Simple: Ticks = " << Simple (count, window, CreateData, OutputResults) << ", checksum = " << checksum << std::endl;
  srand (0);
  checksum = 0;
  std::cout << "Quite Complex: Ticks = " << QuiteComplex (count, window, CreateData, OutputResults) << ", checksum = " << checksum << std::endl;
  srand (0);
  checksum = 0;
  std::cout << "Complex: Ticks = " << Complex (count, window, CreateData, OutputResults) << ", checksum = " << checksum << std::endl;
} 
```

简单的.cpp：

```
#include "Range.h"

//  Function to actually process the data.
//  A circular buffer of min/max values for the current window is filled
//  and once full, the oldest min/max pair is sent to the output callback
//  and replaced with the newest input value. Each value inputted is 
//  compared against all min/max pairs.
void ProcessData
(
  int count,
  int window,
  GeneratorCallback input,
  OutputCallback output,
  int *min_buffer,
  int *max_buffer
)
{
  int
    i;

  for (i = 0 ; i < window ; ++i)
  {
    int
      value = input ();

    min_buffer [i] = max_buffer [i] = value;

    for (int j = 0 ; j < i ; ++j)
    {
      min_buffer [j] = min (min_buffer [j], value);
      max_buffer [j] = max (max_buffer [j], value);
    }
  }

  for ( ; i < count ; ++i)
  {
    int
      index = i % window;

    output (min_buffer [index], max_buffer [index]);

    int
      value = input ();

    min_buffer [index] = max_buffer [index] = value;

    for (int k = (i + 1) % window ; k != index ; k = (k + 1) % window)
    {
      min_buffer [k] = min (min_buffer [k], value);
      max_buffer [k] = max (max_buffer [k], value);
    }
  }

  output (min_buffer [count % window], max_buffer [count % window]);
}

//  A simple method of calculating the results.
//  Memory management is done here outside of the timing portion.
clock_t Simple
(
  int count,
  int window,
  GeneratorCallback input,
  OutputCallback output
)
{
  int
    *min_buffer = new int [window],
    *max_buffer = new int [window];

  clock_t
    start = clock ();

  ProcessData (count, window, input, output, min_buffer, max_buffer);

  clock_t
    end = clock ();

  delete [] max_buffer;
  delete [] min_buffer;

  return end - start;
} 
```

相当复杂的.cpp：

```
#include "Range.h"

template <class T>
class Range
{
private:
  //  Class Types

  //  Node Data
  //  Stores a value and its position in various lists.
  struct Node
  {
    Node
      *m_queue_next,
      *m_list_greater,
      *m_list_lower;

    T
      m_value;
  };

public:
  //  Constructor
  //  Allocates memory for the node data and adds all the allocated
  //  nodes to the unused/free list of nodes.
  Range
  (
    int window_size
  ) :
    m_nodes (new Node [window_size]),
    m_queue_tail (m_nodes),
    m_queue_head (0),
    m_list_min (0),
    m_list_max (0),
    m_free_list (m_nodes)
  {
    for (int i = 0 ; i < window_size - 1 ; ++i)
    {
      m_nodes [i].m_list_lower = &m_nodes [i + 1];
    }

    m_nodes [window_size - 1].m_list_lower = 0;
  }

  //  Destructor
  //  Tidy up allocated data.
  ~Range ()
  {
    delete [] m_nodes;
  }

  //  Function to add a new value into the data structure.
  void AddValue
  (
    T value
  )
  {
    Node
      *node = GetNode ();

    //  clear links
    node->m_queue_next = 0;

    //  set value of node
    node->m_value = value;

    //  find place to add node into linked list
    Node
      *search;

    for (search = m_list_max ; search ; search = search->m_list_lower)
    {
      if (search->m_value < value)
      {
        if (search->m_list_greater)
        {
          node->m_list_greater = search->m_list_greater;
          search->m_list_greater->m_list_lower = node;
        }
        else
        {
          m_list_max = node;
        }

        node->m_list_lower = search;
        search->m_list_greater = node;
      }
    }

    if (!search)
    {
      m_list_min->m_list_lower = node;
      node->m_list_greater = m_list_min;
      m_list_min = node;
    }
  }

  //  Accessor to determine if the first output value is ready for use.
  bool RangeAvailable ()
  {
    return !m_free_list;
  }

  //  Accessor to get the minimum value of all values in the current window.
  T Min ()
  {
    return m_list_min->m_value;
  }

  //  Accessor to get the maximum value of all values in the current window.
  T Max ()
  {
    return m_list_max->m_value;
  }

private:
  //  Function to get a node to store a value into.
  //  This function gets nodes from one of two places:
  //    1\. From the unused/free list
  //    2\. From the end of the fifo queue, this requires removing the node from the list and tree
  Node *GetNode ()
  {
    Node
      *node;

    if (m_free_list)
    {
      //  get new node from unused/free list and place at head
      node = m_free_list;

      m_free_list = node->m_list_lower;

      if (m_queue_head)
      {
        m_queue_head->m_queue_next = node;
      }

      m_queue_head = node;
    }
    else
    {
      //  get node from tail of queue and place at head
      node = m_queue_tail;

      m_queue_tail = node->m_queue_next;
      m_queue_head->m_queue_next = node;
      m_queue_head = node;

      //  remove node from linked list
      if (node->m_list_lower)
      {
        node->m_list_lower->m_list_greater = node->m_list_greater;
      }
      else
      {
        m_list_min = node->m_list_greater;
      }

      if (node->m_list_greater)
      {
        node->m_list_greater->m_list_lower = node->m_list_lower;
      }
      else
      {
        m_list_max = node->m_list_lower;
      }
    }

    return node;
  }

  //  Member Data.
  Node
    *m_nodes,
    *m_queue_tail,
    *m_queue_head,
    *m_list_min,
    *m_list_max,
    *m_free_list;
};

//  A reasonable complex but more efficent method of calculating the results.
//  Memory management is done here outside of the timing portion.
clock_t QuiteComplex
(
  int size,
  int window,
  GeneratorCallback input,
  OutputCallback output
)
{
  Range <int>
    range (window);

  clock_t
    start = clock ();

  for (int i = 0 ; i < size ; ++i)
  {   
    range.AddValue (input ());

    if (range.RangeAvailable ())
    {
      output (range.Min (), range.Max ());
    }
  }

  clock_t
    end = clock ();

  return end - start;
} 
```

复杂的.cpp：

```
#include "Range.h"

template <class T>
class Range
{
private:
  //  Class Types

  //  Red/Black tree node colours.
  enum NodeColour
  {
    Red,
    Black
  };

  //  Node Data
  //  Stores a value and its position in various lists and trees.
  struct Node
  {
    //  Function to get the sibling of a node.
    //  Because leaves are stored as null pointers, it must be possible
    //  to get the sibling of a null pointer. If the object is a null pointer
    //  then the parent pointer is used to determine the sibling.
    Node *Sibling
    (
      Node *parent
    )
    {
      Node
        *sibling;

      if (this)
      {
        sibling = m_tree_parent->m_tree_less == this ? m_tree_parent->m_tree_more : m_tree_parent->m_tree_less;
      }
      else
      {
        sibling = parent->m_tree_less ? parent->m_tree_less : parent->m_tree_more;
      }

      return sibling;
    }

    //  Node Members
    Node
      *m_queue_next,
      *m_tree_less,
      *m_tree_more,
      *m_tree_parent,
      *m_list_greater,
      *m_list_lower;

    NodeColour
      m_colour;

    T
      m_value;
  };

public:
  //  Constructor
  //  Allocates memory for the node data and adds all the allocated
  //  nodes to the unused/free list of nodes.
  Range
  (
    int window_size
  ) :
    m_nodes (new Node [window_size]),
    m_queue_tail (m_nodes),
    m_queue_head (0),
    m_tree_root (0),
    m_list_min (0),
    m_list_max (0),
    m_free_list (m_nodes)
  {
    for (int i = 0 ; i < window_size - 1 ; ++i)
    {
      m_nodes [i].m_list_lower = &m_nodes [i + 1];
    }

    m_nodes [window_size - 1].m_list_lower = 0;
  }

  //  Destructor
  //  Tidy up allocated data.
  ~Range ()
  {
    delete [] m_nodes;
  }

  //  Function to add a new value into the data structure.
  void AddValue
  (
    T value
  )
  {
    Node
      *node = GetNode ();

    //  clear links
    node->m_queue_next = node->m_tree_more = node->m_tree_less = node->m_tree_parent = 0;

    //  set value of node
    node->m_value = value;

    //  insert node into tree
    if (m_tree_root)
    {
      InsertNodeIntoTree (node);
      BalanceTreeAfterInsertion (node);
    }
    else
    {
      m_tree_root = m_list_max = m_list_min = node;
      node->m_tree_parent = node->m_list_greater = node->m_list_lower = 0;
    }

    m_tree_root->m_colour = Black;
  }

  //  Accessor to determine if the first output value is ready for use.
  bool RangeAvailable ()
  {
    return !m_free_list;
  }

  //  Accessor to get the minimum value of all values in the current window.
  T Min ()
  {
    return m_list_min->m_value;
  }

  //  Accessor to get the maximum value of all values in the current window.
  T Max ()
  {
    return m_list_max->m_value;
  }

private:
  //  Function to get a node to store a value into.
  //  This function gets nodes from one of two places:
  //    1\. From the unused/free list
  //    2\. From the end of the fifo queue, this requires removing the node from the list and tree
  Node *GetNode ()
  {
    Node
      *node;

    if (m_free_list)
    {
      //  get new node from unused/free list and place at head
      node = m_free_list;

      m_free_list = node->m_list_lower;

      if (m_queue_head)
      {
        m_queue_head->m_queue_next = node;
      }

      m_queue_head = node;
    }
    else
    {
      //  get node from tail of queue and place at head
      node = m_queue_tail;

      m_queue_tail = node->m_queue_next;
      m_queue_head->m_queue_next = node;
      m_queue_head = node;

      //  remove node from tree
      node = RemoveNodeFromTree (node);
      RebalanceTreeAfterDeletion (node);

      //  remove node from linked list
      if (node->m_list_lower)
      {
        node->m_list_lower->m_list_greater = node->m_list_greater;
      }
      else
      {
        m_list_min = node->m_list_greater;
      }

      if (node->m_list_greater)
      {
        node->m_list_greater->m_list_lower = node->m_list_lower;
      }
      else
      {
        m_list_max = node->m_list_lower;
      }
    }

    return node;
  }

  //  Rebalances the tree after insertion
  void BalanceTreeAfterInsertion
  (
    Node *node
  )
  {
    node->m_colour = Red;

    while (node != m_tree_root && node->m_tree_parent->m_colour == Red)
    {
      if (node->m_tree_parent == node->m_tree_parent->m_tree_parent->m_tree_more)
      {
        Node
          *uncle = node->m_tree_parent->m_tree_parent->m_tree_less;

        if (uncle && uncle->m_colour == Red)
        {
          node->m_tree_parent->m_colour = Black;
          uncle->m_colour = Black;
          node->m_tree_parent->m_tree_parent->m_colour = Red;
          node = node->m_tree_parent->m_tree_parent;
        }
        else
        {
          if (node == node->m_tree_parent->m_tree_less)
          {
            node = node->m_tree_parent;
            LeftRotate (node);
          }

          node->m_tree_parent->m_colour = Black;
          node->m_tree_parent->m_tree_parent->m_colour = Red;
          RightRotate (node->m_tree_parent->m_tree_parent);
        }
      }
      else
      {
        Node
          *uncle = node->m_tree_parent->m_tree_parent->m_tree_more;

        if (uncle && uncle->m_colour == Red)
        {
          node->m_tree_parent->m_colour = Black;
          uncle->m_colour = Black;
          node->m_tree_parent->m_tree_parent->m_colour = Red;
          node = node->m_tree_parent->m_tree_parent;
        }
        else
        {
          if (node == node->m_tree_parent->m_tree_more)
          {
            node = node->m_tree_parent;
            RightRotate (node);
          }

          node->m_tree_parent->m_colour = Black;
          node->m_tree_parent->m_tree_parent->m_colour = Red;
          LeftRotate (node->m_tree_parent->m_tree_parent);
        }
      }
    }
  }

  //  Adds a node into the tree and sorted linked list
  void InsertNodeIntoTree
  (
    Node *node
  )
  {
    Node
      *parent = 0,
      *child = m_tree_root;

    bool
      greater;

    while (child)
    {
      parent = child;
      child = (greater = node->m_value > child->m_value) ? child->m_tree_more : child->m_tree_less;
    }

    node->m_tree_parent = parent;

    if (greater)
    {
      parent->m_tree_more = node;

      //  insert node into linked list
      if (parent->m_list_greater)
      {
        parent->m_list_greater->m_list_lower = node;
      }
      else
      {
        m_list_max = node;
      }

      node->m_list_greater = parent->m_list_greater;
      node->m_list_lower = parent;
      parent->m_list_greater = node;
    }
    else
    {
      parent->m_tree_less = node;

      //  insert node into linked list
      if (parent->m_list_lower)
      {
        parent->m_list_lower->m_list_greater = node;
      }
      else
      {
        m_list_min = node;
      }

      node->m_list_lower = parent->m_list_lower;
      node->m_list_greater = parent;
      parent->m_list_lower = node;
    }
  }

  //  Red/Black tree manipulation routine, used for removing a node
  Node *RemoveNodeFromTree
  (
    Node *node
  )
  {
    if (node->m_tree_less && node->m_tree_more)
    {
      //  the complex case, swap node with a child node
      Node
        *child;

      if (node->m_tree_less)
      {
        // find largest value in lesser half (node with no greater pointer)
        for (child = node->m_tree_less ; child->m_tree_more ; child = child->m_tree_more)
        {
        }
      }
      else
      {
        // find smallest value in greater half (node with no lesser pointer)
        for (child = node->m_tree_more ; child->m_tree_less ; child = child->m_tree_less)
        {
        }
      }

      swap (child->m_colour, node->m_colour);

      if (child->m_tree_parent != node)
      {
        swap (child->m_tree_less, node->m_tree_less);
        swap (child->m_tree_more, node->m_tree_more);
        swap (child->m_tree_parent, node->m_tree_parent);

        if (!child->m_tree_parent)
        {
          m_tree_root = child;
        }
        else
        {
          if (child->m_tree_parent->m_tree_less == node)
          {
            child->m_tree_parent->m_tree_less = child;
          }
          else
          {
            child->m_tree_parent->m_tree_more = child;
          }
        }

        if (node->m_tree_parent->m_tree_less == child)
        {
          node->m_tree_parent->m_tree_less = node;
        }
        else
        {
          node->m_tree_parent->m_tree_more = node;
        }
      }
      else
      {
        child->m_tree_parent = node->m_tree_parent;
        node->m_tree_parent = child;

        Node
          *child_less = child->m_tree_less,
          *child_more = child->m_tree_more;

        if (node->m_tree_less == child)
        {
          child->m_tree_less = node;
          child->m_tree_more = node->m_tree_more;
          node->m_tree_less = child_less;
          node->m_tree_more = child_more;
        }
        else
        {
          child->m_tree_less = node->m_tree_less;
          child->m_tree_more = node;
          node->m_tree_less = child_less;
          node->m_tree_more = child_more;
        }

        if (!child->m_tree_parent)
        {
          m_tree_root = child;
        }
        else
        {
          if (child->m_tree_parent->m_tree_less == node)
          {
            child->m_tree_parent->m_tree_less = child;
          }
          else
          {
            child->m_tree_parent->m_tree_more = child;
          }
        }
      }

      if (child->m_tree_less)
      {
        child->m_tree_less->m_tree_parent = child;
      }

      if (child->m_tree_more)
      {
        child->m_tree_more->m_tree_parent = child;
      }

      if (node->m_tree_less)
      {
        node->m_tree_less->m_tree_parent = node;
      }

      if (node->m_tree_more)
      {
        node->m_tree_more->m_tree_parent = node;
      }
    }

    Node
      *child = node->m_tree_less ? node->m_tree_less : node->m_tree_more;

    if (node->m_tree_parent->m_tree_less == node)
    {
      node->m_tree_parent->m_tree_less = child;
    }
    else
    {
      node->m_tree_parent->m_tree_more = child;
    }

    if (child)
    {
      child->m_tree_parent = node->m_tree_parent;
    }

    return node;
  }

  //  Red/Black tree manipulation routine, used for rebalancing a tree after a deletion
  void RebalanceTreeAfterDeletion
  (
    Node *node
  )
  {
    Node
      *child = node->m_tree_less ? node->m_tree_less : node->m_tree_more;

    if (node->m_colour == Black)
    {
      if (child && child->m_colour == Red)
      {
        child->m_colour = Black;
      }
      else
      {
        Node
          *parent = node->m_tree_parent,
          *n = child;

        while (parent)
        {
          Node
            *sibling = n->Sibling (parent);

          if (sibling && sibling->m_colour == Red)
          {
            parent->m_colour = Red;
            sibling->m_colour = Black;

            if (n == parent->m_tree_more)
            {
              LeftRotate (parent);
            }
            else
            {
              RightRotate (parent);
            }
          }

          sibling = n->Sibling (parent);

          if (parent->m_colour == Black &&
            sibling->m_colour == Black &&
            (!sibling->m_tree_more || sibling->m_tree_more->m_colour == Black) &&
            (!sibling->m_tree_less || sibling->m_tree_less->m_colour == Black))
          {
            sibling->m_colour = Red;
            n = parent;
            parent = n->m_tree_parent;
            continue;
          }
          else
          {
            if (parent->m_colour == Red &&
              sibling->m_colour == Black &&
              (!sibling->m_tree_more || sibling->m_tree_more->m_colour == Black) &&
              (!sibling->m_tree_less || sibling->m_tree_less->m_colour == Black))
            {
              sibling->m_colour = Red;
              parent->m_colour = Black;
              break;
            }
            else
            {
              if (n == parent->m_tree_more &&
                sibling->m_colour == Black &&
                (sibling->m_tree_more && sibling->m_tree_more->m_colour == Red) &&
                (!sibling->m_tree_less || sibling->m_tree_less->m_colour == Black))
              {
                sibling->m_colour = Red;
                sibling->m_tree_more->m_colour = Black;
                RightRotate (sibling);
              }
              else
              {
                if (n == parent->m_tree_less &&
                  sibling->m_colour == Black &&
                  (!sibling->m_tree_more || sibling->m_tree_more->m_colour == Black) &&
                  (sibling->m_tree_less && sibling->m_tree_less->m_colour == Red))
                {
                  sibling->m_colour = Red;
                  sibling->m_tree_less->m_colour = Black;
                  LeftRotate (sibling);
                }
              }

              sibling = n->Sibling (parent);
              sibling->m_colour = parent->m_colour;
              parent->m_colour = Black;

              if (n == parent->m_tree_more)
              {
                sibling->m_tree_less->m_colour = Black;
                LeftRotate (parent);
              }
              else
              {
                sibling->m_tree_more->m_colour = Black;
                RightRotate (parent);
              }
              break;
            }
          }
        }
      }
    }
  }

  //  Red/Black tree manipulation routine, used for balancing the tree
  void LeftRotate
  (
    Node *node
  )
  {
    Node
      *less = node->m_tree_less;

    node->m_tree_less = less->m_tree_more;

    if (less->m_tree_more)
    {
      less->m_tree_more->m_tree_parent = node;
    }

    less->m_tree_parent = node->m_tree_parent;

    if (!node->m_tree_parent)
    {
      m_tree_root = less;
    }
    else
    {
      if (node == node->m_tree_parent->m_tree_more)
      {
        node->m_tree_parent->m_tree_more = less;
      }
      else
      {
        node->m_tree_parent->m_tree_less = less;
      }
    }

    less->m_tree_more = node;
    node->m_tree_parent = less;
  }

  //  Red/Black tree manipulation routine, used for balancing the tree
  void RightRotate
  (
    Node *node
  )
  {
    Node
      *more = node->m_tree_more;

    node->m_tree_more = more->m_tree_less;

    if (more->m_tree_less)
    {
      more->m_tree_less->m_tree_parent = node;
    }

    more->m_tree_parent = node->m_tree_parent;

    if (!node->m_tree_parent)
    {
      m_tree_root = more;
    }
    else
    {
      if (node == node->m_tree_parent->m_tree_less)
      {
        node->m_tree_parent->m_tree_less = more;
      }
      else
      {
        node->m_tree_parent->m_tree_more = more;
      }
    }

    more->m_tree_less = node;
    node->m_tree_parent = more;
  }

  //  Member Data.
  Node
    *m_nodes,
    *m_queue_tail,
    *m_queue_head,
    *m_tree_root,
    *m_list_min,
    *m_list_max,
    *m_free_list;
};

//  A complex but more efficent method of calculating the results.
//  Memory management is done here outside of the timing portion.
clock_t Complex
(
  int count,
  int window,
  GeneratorCallback input,
  OutputCallback output
)
{
  Range <int>
    range (window);

  clock_t
    start = clock ();

  for (int i = 0 ; i < count ; ++i)
  {   
    range.AddValue (input ());

    if (range.RangeAvailable ())
    {
      output (range.Min (), range.Max ());
    }
  }

  clock_t
    end = clock ();

  return end - start;
} 
```

# sql - 在 SQL Server 中找出调用存储过程

> ID：148004
> 
> 赞同：20
> 
> 时间：2008-09-29T08:56:14.223
> 
> 标签：sql, sql-server, database, stored-procedures, sql-server-2005

是否可以找出谁调用了存储过程？

例如，假设我在`proc3`. 从该过程中，我想知道它是否由`proc1`or调用`proc2`。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-29T09:06:28.550

如果这对您的逻辑很重要，我会使用额外的输入参数来指定源。

这也将使您的数据库更容易移植到另一个平台，因为您不依赖于一些晦涩的平台相关函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T09:15:41.540

您是否需要在运行时在 proc3 中知道导致错误的原因，还是只需要在调试时知道？

如果您只需要在调试/监视期间执行此操作，则可以使用[SQL Server 分析器。](http://msdn.microsoft.com/en-us/library/ms187929.aspx)

否则在 2005 年我不相信您有能力进行堆栈跟踪。

要解决它，您可以向 proc3、@CallingProc 或类似的东西添加额外的参数。

或者您可以将 try catch 块添加到 proc1 和 proc2。

```
BEGIN TRY
EXEC Proc3
END TRY
BEGIN CATCH
SELECT 'Error Caught'
SELECT
    ERROR_PROCEDURE()
END CATCH 
```

这里很好的参考：[http ://searchsqlserver.techtarget.com/tip/1,289483,sid87_gci1189087,00.html](http://searchsqlserver.techtarget.com/tip/1,289483,sid87_gci1189087,00.html)

当然总是[SQL Server 联机丛书](http://msdn.microsoft.com/en-us/library/ms130214.aspx)

但是，SQL Server 2008 确实具有通过过程进行调试的能力。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-29T11:09:59.877

没有很好的自动方法来做到这一点（唉）。因此，这实际上取决于您准备（重新）编写您的过程以便能够做到这一点的程度。

如果您有日志记录机制，您可能能够阅读日志并找出谁给您打电话。

例如，如果您通过插入表来实现日志记录，例如：

```
CREATE TABLE Log
(timestamp dattime, 
spid       int, 
procname   varchar(255), 
message    varchar(255) )

... text of proc ... 
INSERT INTO Log
SELECT get_date(), @@spid, @currentproc, 'doing something' 
-- you have to define @currentproc in each proc

-- get name of caller
SELECT @caller = procname 
FROM   Log
WHERE  spid = @@spid 
AND    timestamp = (SELECT max(timestamp) 
                    FROM   Log 
                    WHERE  timestamp < get_date() 
                    AND    procname != @currentproc ) 
```

这不适用于递归调用，但也许有人可以解决这个问题？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-29T09:16:14.360

您可以让 proc1 和 proc2 将它们的名称作为参数传递给 proc3。

例如：

```
CREATE PROCEDURE proc3
  @Caller nvarchar(128) -- Name of calling proc.
  AS
  BEGIN
    -- Produce error message that includes caller's name.
    RAISERROR ('Caller was %s.', 16,10, @Caller);
  END
  GO

  CREATE PROCEDURE proc1
  AS
  BEGIN
    -- Get the name of this proc.
    DECLARE @ProcName nvarchar(128);
    SET @ProcName = OBJECT_NAME(@@PROCID);
    -- Pass it to proc3.
    EXEC proc3 @ProcName
  END
  GO

  CREATE PROCEDURE proc2
  AS
  BEGIN
    -- Get the name of this proc.
    DECLARE @ProcName nvarchar(128);
    SET @ProcName = OBJECT_NAME(@@PROCID);
    -- Pass it to proc3.
    EXEC proc3 @ProcName
  END
  GO 
```

# sql - 如何使用 PostgreSQL 序列更新 SQL 中的唯一值？

> ID：148005
> 
> 赞同：13
> 
> 时间：2008-09-29T08:56:43.317
> 
> 标签：sql, postgresql, sequences

在 SQL 中，如何更新表，将每一行的列设置为不同的值？

我想更新 PostgreSQL 数据库中的一些行，将一列设置为序列中的数字，其中该列具有唯一约束。我希望我可以使用：

```
update person set unique_number = (select nextval('number_sequence') ); 
```

但似乎*nextval*只被调用一次，所以更新对每一行使用相同的数字，我得到一个“重复键违反唯一约束”错误。我应该怎么做？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-29T09:01:21.340

不要使用子选择，而是直接使用 nextval 函数，如下所示：

```
update person set unique_number = nextval('number_sequence'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T18:13:13.480

我认为 pg 的序列是一种 hack，并且表明增量整数不是键行的最佳方式。尽管 pgsql 直到 8.3 才获得对 UUID 的原生支持

[http://www.postgresql.org/docs/8.3/interactive/datatype-uuid.html](http://www.postgresql.org/docs/8.3/interactive/datatype-uuid.html)

UUID 的好处是组合几乎是无限的，不像随机数有一天会发生碰撞。

# plot - 如何使用非数字 X 轴绘制数据？

> ID：148020
> 
> 赞同：8
> 
> 时间：2008-09-29T09:01:55.533
> 
> 标签：plot, gnuplot

我有一系列性能测试，我想以图表的形式显示。我有一组测试（大约 10 个），我在一组组件（目前是 3 个）上运行，并获得吞吐量结果。

Y 轴是测试的吞吐量结果，X 轴应该是测试的缩写名称，以及我正在测试的各种组件的结果。因此，对于每个 X 标签（例如，retrieve20Items、store20Items），其上方将有 3 个不同的结果，一个用于我正在测试的三个组件中的每一个，每个组件都有颜色编码并在图例中引用。

这个非数字x轴是我可以用gnuplot做的吗？这是在 linux 平台上完成的，因此仅限 Windows 的工具对我不起作用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-29T09:13:04.993

请参阅[这个非常有用的页面](http://lowrank.net/gnuplot/tics-e.html)。本质上，您使用创建数字标签映射

```
set xtics ("lbl1" 1, "lbl2" 2, "lbl3" 3, "lbl4" 4) 
```

然后正常绘图。

# c++ - 为什么我的引用传递的参数没有在函数内修改？

> ID：148024
> 
> 赞同：0
> 
> 时间：2008-09-29T09:04:22.283
> 
> 标签：c++, c, parameters, linker, pass-by-reference

我在静态库中有一个 C 函数，我们称它为 A，具有以下接口：

```
int A(unsigned int a, unsigned long long b, unsigned int *y, unsigned char *z); 
```

这个函数将改变 y 和 z 的值（这是肯定的）。我在动态 C++ 库中使用它，使用 extern "C"。

现在，这让我感到震惊：

*   y 设置正确，z 没有改变。我的意思是，如果两者都使用（指向）值 666 进行初始化，则 y 指向的值将在调用后发生变化，但不会更改 z 指向的值（仍为 666）。
*   当从 C 二进制文件调用时，此函数可以无缝工作（修改 z 指向的值）。
*   如果我创建一个具有相同原型的函数的虚拟 C 库，并在我的动态 C++ 库中使用它，它工作得很好。如果我重新使用相同的变量来调用 A(..)，我会得到与以前相同的结果，z 不会改变。

我认为以上几点表明我的变量声明并不是一个愚蠢的错误。

我显然被卡住了，我无法更改 C 库。您对可能是什么问题有任何线索吗？我正在考虑 C/C++ 接口上的一个问题，例如 char* 的解释方式。

编辑：我终于发现了问题所在。请看下面我的回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-29T10:00:17.983

看起来 C 库和 C++ 编译器处理*long longs*的方式有所不同。我的猜测是 C 库可能是 C89 之前的标准，实际上将 64 位*长度*视为 32 位长度。您的 C++ 库正在正确处理它并将 64 位放置在调用堆栈上，因此破坏了 y 和 z。也许尝试通过 *int A(unsigned int a, unsigned long b, unsigned int *y, unsigned char *z)*调用该函数，看看你得到了什么。

只是一个想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-29T12:11:17.483

这是您所描述的内容没有明显错误的问题之一，但事情并没有按照您的预期进行。

我认为您应该**编辑**您的帖子以提供更多信息，以便获得一些明智的答案。特别是，让我们从：-

*   此代码适用于什么平台：Windows、Linux、嵌入式或...？
*   C静态库是用什么编译器构建的？
*   C++ 动态库是用什么编译器构建的？
*   可以成功调用构建的库的C是什么编译器？
*   您有源代码级调试器吗？如果是这样，您能否从 C++ 单步执行 C 代码*。*

除非您对 A 总是修改 Z 指向的数据有误，否则问题的唯一可能原因是参数传递约定之间的不兼容。“长长”的问题可能暗示事情并不像看起来那样。

作为最后的手段，你可以比较反汇编的 C++ 调用代码（你说失败）和 C 调用代码（你说成功），或者使用调试器单步执行 CPU 指令（是的，真的 - 你会学到良好的技能以及解决问题）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T09:11:20.877

据我所知， long long 不是标准 C++ 的一部分，也许这就是你问题的根源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T09:14:54.240

不知道。尝试调试步骤进入 A 看看会发生什么（汇编代码警告！）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T09:39:35.897

也许您可以将原始函数包装在您从 C++ 库中调用的 C 库中？

根据您的第 2 点和第 3 点，这似乎可行。

如果没有，它会为您提供另一个调试点以找到更多线索 - 查看故障首先出现在您的哪个库中，并检查为什么 2 和 3 工作，但这没有 - 最小的区别是什么？

您还可以尝试检查在每种情况下由您的函数调用设置的堆栈，以检查是否存在差异——考虑不同的调用约定。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-29T09:45:12.873

第 1 步：比较从 C++ 端传递的指针 y 和 z 与 C 函数接收到的指针。

PS我不想听起来很明显，但只是在这里仔细检查。我想当您说从 C 二进制文件调用时 z 被修改得很好时，您的意思是 z 指向的数据被修改得很好。指针 y 和 z 本身是按值传递的，因此您不能更改指针。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-29T12:15:56.537

另一个疯狂的猜测：你确定你在 C 库中链接了正确的函数实例吗？你的库中可能有几个这样的功能吗？在 C 中，链接器在决定如何解析函数时并不关心返回类型或参数列表——只有名称很重要。所以，如果你有多个同名的函数......

您可以以编程方式验证函数的身份。创建一个 C 库，它使用一些测试参数调用您的函数 A，并且工作正常并且打印指向函数 A 的指针。将该库链接到您的 C++ 应用程序。然后打印指向原始 A 函数的指针，如从 C++ 代码中看到的那样，并将指针与在同一进程中调用时 C 库看到的指针进行比较。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-29T12:24:29.977

再一次，一个明显的，但谁知道......你确定你调用的 C 函数是无状态的，这意味着它的输出只取决于它的输入吗？如果函数不是无状态的，那么当从 C++ 应用程序调用时，“隐藏”状态可能会导致函数的不同行为（不更改 指向的数据`z`）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-29T17:00:05.183

首先，我非常感谢大家的帮助。感谢您给我的无数想法和线索，我终于能够理清这个问题。你的建议帮助我质疑我认为理所当然的事情。

对我的问题的简短回答：问题是我的 C++ 库使用了旧版本的 C 库。这个旧版本错过了第四个参数。结果，第四个论点显然从未改变过。

现在我有点惭愧，我意识到这是问题所在。但是，我的代码编译良好这一事实误导了我。这是因为 C++ 库针对正确版本的 C lib 编译，但在运行时它使用与我正在使用的另一个库静态链接的旧版本。

```
C++ Lib (M) ---> dyn C++ lib (N) ---> C lib (P) v.1.0
     |
     ------> C lib (P) v.1.1 
```

(N) 是与 (P) 1.0 版静态链接的动态库。编译器接受了从 (M) 到具有 4 个参数的函数的调用，因为我链接到 (P) 版本 1.1，但在运行时它使用旧版本的 (P)。

随时编辑此答案或问题或要求我这样做。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-29T09:12:50.093

在您的 C++ 程序中，原型是否用`extern "C"`?

# perl - 将 CGI 迁移到框架的最佳方法是什么？

> ID：148039
> 
> 赞同：7
> 
> 时间：2008-09-29T09:10:16.170
> 
> 标签：perl, model-view-controller, cgi, catalyst

我有一个在 perl CGI 中运行的大型 Web 应用程序。它运行正常，写得很好，但是就像过去所做的那样，所有的 html 都是在 CGI 调用中硬编码定义的，所以你可以想象，它很难维护、改进等等。所以现在我想开始添加一些模板并与框架（催化剂或 CGI::application）集成。我的问题是：这里有人有这样的经历吗？有什么需要注意的吗？我知道使用这两个框架我都可以运行本机 CGI 脚本，所以这很好，因为我可以同时运行这两个（CGI 本机广告“框架化”代码）而不会造成任何创伤。有小费吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-29T09:23:36.777

首先编写测试（例如使用[`Test::WWW::Mechanize`](http://search.cpan.org/perldoc?Test::WWW::Mechanize)）。然后当你改变东西时，你总是知道是否有什么东西坏了，是什么坏了。

然后将 HTML 提取到模板中，并将常用的 subs 提取到模块中。之后，切换到框架是小菜一碟。

通常，请逐步进行，以便您始终拥有一个有效的应用程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-29T09:17:39.333

将 HTML 从 CGI 脚本中的处理逻辑中解脱出来。识别影响 HTML 输出的所有代码，因为这些是成为模板变量的候选者。将其分离到一个 HTML 文件中，用模板变量标记已识别的部分。最终，您将能够重构页面，以便所有处理都在代码开始时完成，而 HTML 模板只是在所有处理结束时调用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-29T09:27:12.807

在这种情况下，基本上从头开始重写，旧代码对于 A) 测试和 B) 设计细节很有用。理想情况下，您应该针对您想要复制的所有基本功能进行一组测试，或者至少对解析最终结果页面的测试进行测试，以便您可以看到新代码为相同的输入返回相同的信息。

代码中的设计细节可能毫无用处，这取决于框架自动处理的程度。如果您有一组好的测试，并且直接的转换效果很好，那么您就完成了。如果新的行为与旧的不匹配，您可能需要更深入地挖掘“为什么”？这可能看起来很奇怪，乍一看没有任何意义。

首先要记住要做的一件事是，找出是否有人在您使用的框架中做了类似的事情。您可以为自己节省大量时间和金钱。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-29T09:40:18.233

这是我使用 Python 而不是 Perl 的方法，但这无关紧要：

1.  将 HTML 和*代码*分离到不同的文件中。我为此使用了**模板引擎**。
2.  从呈现带有一组参数的*模板*的*代码*中创建*函数。*
***   以合理的方式组织*功能*（我称之为**视图**，受 Django 启发）。（管理员视图、用户视图等）所有*视图*都遵循**相同的调用约定**！*   重构了数据库和请求的东西，以便*视图*只**包含视图特定的代码**（阅读：处理 GET、POST 请求等，但没有低级！）。为此严重依赖现有的库。**

 **我现在在这里。:-) 下一个明显的步骤当然是：

*   编写一个将*URL*映射到您的*视图的***调度**程序。当然，这也将导致更好的 URL 和更好的 404 和错误处理。

 *** * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-30T08:18:24.087

框架做出的假设之一是 url 映射到代码。例如，在一个框架中，您经常会看到以下内容：

```
http://app.com/docs/list
http://app.com/docs/view/123 
```

通常虽然旧的 CGI 脚本不能这样工作，但您更有可能遇到以下情况：

```
http://app.com/docs.cgi?action=view&id=123 
```

要利用该框架，您可能需要更改所有 url。您是否可以做到这一点，以及如何保持旧链接正常工作，很可能构成您决定的很大一部分。

框架还提供对某种 ORM（对象关系映射器）的支持，它抽象了数据库调用并让您只处理对象。这[`Catalyst`](http://search.cpan.org/perldoc?Catalyst)通常是[`DBIx::Class`](http://search.cpan.org/perldoc?DBIx::Class). 您应该评估切换到此的成本是多少。

您可能会发现您想要完全重写，以旧代码作为参考平台。这可能比您预期的要少得多。但是，从一些玩具网站开始，以了解您决定使用的任何框架/orm/模板。

# python - 对 IF 语句使用 OR 比较

> ID：148042
> 
> 赞同：16
> 
> 时间：2008-09-29T09:12:24.933
> 
> 标签：python, comparison, boolean

在 Python 中使用 IF 语句时，您必须执行以下操作才能使“级联”正常工作。

```
if job == "mechanic" or job == "tech":
        print "awesome"
elif job == "tool" or job == "rock":
        print "dolt" 
```

检查“等于”时，有没有办法让 Python 接受多个值？例如，

```
if job == "mechanic" or "tech":
    print "awesome"
elif job == "tool" or "rock":
    print "dolt" 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-29T09:13:53.337

```
if job in ("mechanic", "tech"):
    print "awesome"
elif job in ("tool", "rock"):
    print "dolt" 
```

括号中的值是一个元组。`in`操作员检查左侧项目是否出现在右侧句柄元组内的某个位置。

请注意，当 Python 使用`in`运算符搜索元组或列表时，它会进行线性搜索。如果右侧有大量项目，这可能是性能瓶颈。这样做的更大规模的方法是使用[`frozenset`](http://docs.python.org/lib/types-set.html)：

```
AwesomeJobs = frozenset(["mechanic", "tech", ... lots of others ])
def func():
    if job in AwesomeJobs:
        print "awesome" 
```

如果在程序运行期间不需要更改出色作业列表，则首选使用`frozenset`over 。`set`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-29T09:15:53.847

您可以在：

```
if job  in ["mechanic", "tech"]:
    print "awesome" 
```

当检查非常大的数字时，可能还值得存储一组要检查的项目，因为这样会更快。例如。

```
AwesomeJobs = set(["mechanic", "tech", ... lots of others ])
...

def func():
    if job in AwesomeJobs:
        print "awesome" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T09:14:14.427

```
if job in ("mechanic", "tech"):
    print "awesome"
elif job in ("tool", "rock"):
    print "dolt" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T09:14:18.267

虽然我不认为你可以直接做你想做的事，但一种选择是：

```
if job in [ "mechanic", "tech" ]:
    print "awesome"
elif job in [ "tool", "rock" ]:
    print "dolt" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T16:31:06.687

具有常量项的元组本身作为常量存储在编译函数中。它们可以用一条指令加载。另一方面，列表和集合总是在每次执行时重新构建。

元组和列表都对 in 运算符使用线性搜索。Sets 使用基于散列的查找，因此对于更多的选项会更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-29T09:14:54.037

在其他语言中，我会使用 switch/select 语句来完成工作。[你也可以在 python 中做到这一点](http://simonwillison.net/2004/May/7/switch/)。

# java - 在基类中有对象实例化“钩子”可以吗？

> ID：148056
> 
> 赞同：2
> 
> 时间：2008-09-29T09:15:59.917
> 
> 标签：java, inheritance

[由于各种原因](https://stackoverflow.com/questions/144642/tree-directed-acyclic-graph-implementation)，我创建了自己的 Tree 实现，并提出了两个类，一个是“基”类，它是一个充满逻辑的通用树节点，另一个类扩展了更专业的类。

在我的基类中，某些方法涉及实例化新的树节点（例如添加子节点）。这些实例化在逻辑内部（例如在嵌套循环中），这使得逻辑难以与实例化分离。

因此，如果我不在特定类中覆盖这些实例，则会创建错误类型的节点。但是，我*不想*覆盖这些方法，因为它们还包含不应重复的共享逻辑！

问题可以归结为：

```
public class Foo {
    public String value() { return "foo"; }

    public Foo doStuff() {
        // Logic logic logic..
        return new Foo();
    }
}

class Bar extends Foo {
    public String value() { return "bar"; } 
}

new Bar().doStuff().value(); // returns 'foo', we want 'bar' 
```

突然出现在我脑海中的第一件事是有一个扩展类可以覆盖的“创建钩子”：

```
public Foo createFooHook(/* required parameters */) {
  return new Foo();
} 
```

现在。虽然这是一个很好的第一个想法，但从代码中散发出一股可怕的恶臭。有一些非常...*错*的地方。

这就像光着身子做饭一样——感觉很危险，也*没有必要*。

那么，**你会如何处理这种情况呢？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T09:44:04.387

[因此，在拿到我的设计模式](https://rads.stackoverflow.com/amzn/click/com/0201633612)副本并打开它之后，我确信这是我第一次发现我想要的东西。

它被称为[工厂方法](http://en.wikipedia.org/wiki/Factory_method)，它非常适合。它仍然有点难看，因为我的超类（`Foo`在上面的示例中）不是抽象的，这意味着子类不会被迫实现挂钩。

不过，这可以通过一些重构来解决，我最终会得到以下效果：

```
abstract class AbstractFoo {
    public String value() { return "Foo"; }

    public AbstractFoo doStuff() {
        // Logic logic logic
        return hook();
    }

    protected abstract AbstractFoo hook();
}

class Foo extends AbstractFoo {
    protected AbstractFoo hook() { return new Foo(); }
}

class Bar extends AbstractFoo {
    public String value() { return "Bar"; }

    protected AbstractFoo hook() { return new Bar(); }
}

new Bar().doStuff().value(); // Returns 'Bar'! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T09:56:50.800

除了工厂模式之外，我还要看一下复合模式——它往往很适合在基于树的情况下使用工厂。

[复合设计模式](http://en.wikipedia.org/wiki/Composite_pattern)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T09:22:06.623

我不认为有更好的方法。请注意不要从构造函数中调用这些钩子。

# command-line - 从命令行调用 Mathematica 程序，使用命令行参数、标准输入、标准输出和标准错误

> ID：148057
> 
> 赞同：18
> 
> 时间：2008-09-29T09:16:13.067
> 
> 标签：command-line, scripting, wolfram-mathematica

如果您在 foo.m 中有 Mathematica 代码，则可以使用`-noprompt` 和`-initfile foo.m` (or `-run "<<foo.m"`) 调用 Mathematica，并且可以使用命令行参数`$CommandLine`（其中包含额外的垃圾），但是有没有办法只使用一些 mathematica 代码，例如

```
#!/usr/bin/env MathKernel
x = 2+2;
Print[x];
Print["There were ", Length[ARGV], " args passed in on the command line."];
linesFromStdin = readList[];
etc. 
```

和 chmod 它可执行并运行它？换句话说，如何像使用任何其他脚本语言（Perl、Python、Ruby 等）一样使用 Mathematica？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-30T03:29:27.867

MASH -- Mathematica Scripting Hack -- 会做到这一点。

从 Mathematica 版本 6 开始，以下 perl 脚本就足够了：

[http://ai.eecs.umich.edu/people/dreeves/mash/mash.pl](http://ai.eecs.umich.edu/people/dreeves/mash/mash.pl)

对于以前的 Mathematica 版本，需要一个 C 程序：

[http://ai.eecs.umich.edu/people/dreeves/mash/pre6](http://ai.eecs.umich.edu/people/dreeves/mash/pre6)

更新：终于，Mathematica 8 通过“-script”命令行选项原生支持这一点：

[http://www.wolfram.com/mathematica/new-in-8/mathematica-shell-scripts/](http://www.wolfram.com/mathematica/new-in-8/mathematica-shell-scripts/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-08-14T19:48:05.003

这是一个不需要额外帮助脚本的解决方案。您可以使用以下 shebang 直接调用 Mathematica 内核：

```
#!/bin/sh
exec <"$0" || exit; read; read; exec /usr/local/bin/math -noprompt "$@" | sed '/^$/d'; exit
(* Mathematica code starts here *)
x = 2+2;
Print[x]; 
```

shebang 代码跳过脚本的前两行，并将其余部分作为标准输入提供给 Mathematica 内核。*sed*命令删除内核产生的空行。

这种 hack 不如[MASH](http://ai.eecs.umich.edu/people/dreeves/mash/)通用。*因为 Mathematica 代码是从标准输入*读取的，所以您不能将*标准输入*用于用户输入，即[Input](http://reference.wolfram.com/mathematica/ref/Input.html)和[InputString](http://reference.wolfram.com/mathematica/ref/InputString.html)函数不起作用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-11-01T20:32:43.407

假设您将 Mathematica 二进制文件添加到 ~/.profile 中的 PATH 环境变量中，

```
export PATH=$PATH:/Applications/Mathematica.app/Contents/MacOS 
```

然后，您只需在 Mathematica 脚本中编写此 shebang 行。

```
#!/usr/bin/env MathKernel -script 
```

现在你可以点斜线你的脚本。

```
$ cat hello.ma
#!/usr/bin/env MathKernel -script

Print["Hello World!"]

$ chmod a+x hello.ma
$ ./hello.ma
"Hello World!" 
```

使用 Mathematica 8.0 测试。

小错误：Mathematica 在 Windows 和 Mac OS X 中用引号包围 Print[s]，但在 Linux 中没有。怎么回事？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-29T09:26:02.637

尝试
-initfile *filename*
并将退出命令放入您的程序中

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-24T12:01:31.827

我找到了另一个对我有用的解决方案。

将代码保存在 .m 文件中，然后像这样运行它： MathKernel -noprompt -run “<

这是链接：[http ://bergmanlab.smith.man.ac.uk/?p=38](http://bergmanlab.smith.man.ac.uk/?p=38)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-16T07:06:39.547

对于数学 7

```
$ cat test.m
#!/bin/bash
MathKernel -noprompt -run < <( cat $0| sed -e '1,4d' )  | sed '1d'
exit 0
### code start Here ... ###
Print["Hello World!"]
X=7
X*5 
```

用法：

```
$ chmod +x test.m

$ ./test.m
"Hello World!"

7
35 
```

# security - 您将如何测试 SSL 连接？

> ID：148059
> 
> 赞同：24
> 
> 时间：2008-09-29T09:16:29.040
> 
> 标签：security, network-programming, openssl

我正在我的网络应用程序上试验 OpenSSL，我想测试发送的数据是否被加密并且不能被窃听者看到。

您可以使用哪些工具进行检查？这可以以编程方式完成，以便可以放在单元测试中吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-29T09:35:21.197

[openssl 有一个 s_client](http://www.mkssoftware.com/docs/man1/openssl_s_client.1.asp)，它是一个快速而肮脏的通用客户端，可用于测试服务器连接。它将显示服务器证书和协商的加密方案。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-09-09T09:08:34.467

我发现[本指南](http://prefetch.net/articles/debuggingssl.html)非常有帮助。以下是他使用的一些工具：

`$ openssl s_client -connect mail.prefetch.net:443 -state -nbio 2>&1 | grep "^SSL"`

`$ ssldump -a -A -H -i en0`

`$ ssldump -a -A -H -k rsa.key -i en0`

`$ ssldump -a -A -H -k rsa.key -i en0 host fred and port 443`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-29T09:21:39.590

查看钢丝鲨[http://www.wireshark.org/](http://www.wireshark.org/)

和 tcp 转储[http://en.wikipedia.org/wiki/Tcpdump](http://en.wikipedia.org/wiki/Tcpdump)

不确定将这些集成到单元测试中。他们会让你在一个非常低的层次上看到网络级别发生的事情。

也许对于单元测试，确定流看起来像未加密并确保加密流不相似

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-29T09:38:12.217

Franci Penov 回答了我的一个问题“[发送到网站的日志帖子参数](https://stackoverflow.com/questions/139409)”，建议我看看 Fiddler：[http ://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

如果您有兴趣查看 HTTP 请求，我试过了，它运行良好。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T09:28:39.497

是的 - Wire Shark ( [http://www.wireshark.org/](http://www.wireshark.org/) ) 非常酷（过滤器、报告、统计数据）。

至于测试，您可以将其作为集成测试的一部分进行（wireshark 中有一些命令行选项）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-29T09:22:20.523

为了快速检查，您可以使用[Wireshark](http://www.wireshark.org/)（以前称为 Ethereal）查看您的数据是否以纯文本格式传输。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T09:38:14.260

如前所述[http://www.wireshark.org/](http://www.wireshark.org/)，您还可以使用[cain & 能够](http://www.oxid.it/)将流量重定向到第三台机器并从那里对协议进行任何处理。

# php - 是否可以使用 jQuery 加密 AJAX 调用以进行身份 验证？

> ID：148068
> 
> 赞同：17
> 
> 时间：2008-09-29T09:20:39.000
> 
> 标签：php, jquery, ajax, security, https

我对 AJAX 方法相当陌生（不久前我才发现[jQuery](http://jquery.com/)）。我很想知道是否有在 PHP 设置上验证用户的方法；安全地。

jQuery 是否有任何特殊选项允许使用 HTTPS（或任何其他方式来加密我的 ajax 调用）？

是的，我可以很好地将数据发布回服务器，但这会破坏乐趣。:)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-29T09:23:04.890

要通过 HTTPS 使用 Ajax，您必须通过 HTTPS 加载原始页面。

[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)

所以，从某种意义上说，是的——但不是靠它自己。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-11-21T14:18:44.513

好吧，如果你感兴趣的话。有[AES JavaScript 实现](http://www.movable-type.co.uk/scripts/aes.html)。我玩得很开心:)。不过，这可能有点棘手......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T22:49:02.527

除非 jQuery 已经这样做了（我使用 MooTools，所以我不知道）我强烈建议您通过使用`$_GET`查询字符串中的变量将 AJAX 登录链接到 PHP 会话。这样，即使它通过 HTTPS，您仍然可以知道它与哪个会话相关联，以增加一层保护。

# c# - 在 OOXML 中使用大型二进制段的问题

> ID：148071
> 
> 赞同：7
> 
> 时间：2008-09-29T09:21:40.603
> 
> 标签：c#, .net, c++, com, openxml

**系统描述**

使用 OOXML 生成文档的绘图组件。

绘图组件由几个部分组成。除了 OOXML 文档的接口外，所有部分都用 C++ 编写为 exe + dll。后一个组件是在 C#/.NET 中创建的 COM 组件。主要原因是 .NET 框架包含*System.IO.Packaging*。这是一个非常方便的内置工具，用于处理 OOXML 文档。

我们从模板 OOXML 文档中创建一个文档，其中某些点点滴滴被它们的实际内容替换。

这些位之一是 OLE 服务器组件。基本上，这是 OOXML 文件中的二进制段。为了编写这个二进制段，Packaging 组件显然使用了隔离存储。

**问题**

写入大于 8MB 的段会导致抛出异常“无法确定域的身份”。

在 C++ 端，此异常包含错误 ISS_E_ISOSTORE (0x80131450)。

我们已经对此进行了分析，据我们所知，这是一项安全功能，可防止半不受信任的第三方组件通过编写大量文件来完全破坏您的 HD。

然后，我们在 .NET/COM 组件中尝试了很多东西（创建自定义 AppDomain，设置属性以获得最大许可，创建我们自己的 Streams 并将它们传递给 Packaging 组件），但每次都会引发相同的异常。

我们可以做些什么来完成这项工作？

难道当.NET组件被实例化为COM组件时，它的AppDomain总是不可信的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T12:35:42.357

您可以尝试自己解压缩包（而不是使用 .NET 包 API），直接写入代表二进制段的文件并再次压缩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T19:29:58.147

您应该更改该问题的标题，因为您的问题与 OOXML 无关。

除此之外：您正在使用什么系统处理 8MB 的数据块，这会导致硬盘驱动器总计的风险？

# c# - .NET 的 `Array.Sort()` 方法使用的排序算法是稳定的算法吗？

> ID：148074
> 
> 赞同：71
> 
> 时间：2008-09-29T09:22:39.183
> 
> 标签：c#, .net

.NET 的`Array.Sort()`方法使用的排序算法是[稳定](http://en.wikipedia.org/wiki/Stable_sort#Classification)的算法吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-09-29T09:24:31.953

来自[MSDN](http://msdn.microsoft.com/en-us/library/6tf1f0bc.aspx)：

> 此实现执行不稳定的排序；也就是说，如果两个元素相等，则可能不会保留它们的顺序。相反，稳定排序保留了相等元素的顺序。

该排序使用内省排序。（.NET 框架 4.0 和更早版本中的快速排序）。

如果您需要稳定的排序，可以使用[Enumerable.OrderBy](http://msdn.microsoft.com/en-us/library/bb534966.aspx)。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2008-09-29T09:44:06.743

添加到[Rasmus Faber 的答案](https://stackoverflow.com/questions/148074/net-is-arraysort-stable-sort#148081)......</p>

在 LINQ 中通过[Enumerable.OrderBy](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.orderby.aspx)和[Enumerable.ThenBy](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.thenby.aspx)进行排序是一种稳定的排序实现，可以用作[Array.Sort](http://msdn.microsoft.com/en-us/library/system.array.sort.aspx)的替代方案。来自[MSDN 上的 Enumerable.OrderBy 文档](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.orderby.aspx)：

> 该方法执行稳定排序；也就是说，如果两个元素的键相等，则保留元素的顺序。相反，不稳定的排序不会保留具有相同键的元素的顺序。

此外，任何不稳定的排序实现，例如 的`Array.Sort`，都可以通过使用源序列或数组中元素的位置作为附加键来充当平局断路器来稳定。下面是一个这样的实现，作为任何一维数组的通用扩展方法，它变成`Array.Sort`了一个稳定的排序：

```
using System;
using System.Collections.Generic;

public static class ArrayExtensions {

    public static void StableSort<T>(this T[] values, Comparison<T> comparison) {
        var keys = new KeyValuePair<int, T>[values.Length];
        for (var i = 0; i < values.Length; i++)
            keys[i] = new KeyValuePair<int, T>(i, values[i]);
        Array.Sort(keys, values, new StabilizingComparer<T>(comparison));
    }

    private sealed class StabilizingComparer<T> : IComparer<KeyValuePair<int, T>> 
    {
        private readonly Comparison<T> _comparison;

        public StabilizingComparer(Comparison<T> comparison) {
            _comparison = comparison;
        }

        public int Compare(KeyValuePair<int, T> x, 
                           KeyValuePair<int, T> y) {
            var result = _comparison(x.Value, y.Value);
            return result != 0 ? result : x.Key.CompareTo(y.Key);
        }
    }
} 
```

`StableSort`下面是从上面使用的示例程序：

```
static class Program 
{
    static void Main() 
    {
        var unsorted = new[] {
            new Person { BirthYear = 1948, Name = "Cat Stevens" },
            new Person { BirthYear = 1955, Name = "Kevin Costner" },
            new Person { BirthYear = 1952, Name = "Vladimir Putin" },
            new Person { BirthYear = 1955, Name = "Bill Gates" },
            new Person { BirthYear = 1948, Name = "Kathy Bates" },
            new Person { BirthYear = 1956, Name = "David Copperfield" },
            new Person { BirthYear = 1948, Name = "Jean Reno" },
        };

        Array.ForEach(unsorted, Console.WriteLine);

        Console.WriteLine();
        var unstable = (Person[]) unsorted.Clone();
        Array.Sort(unstable, (x, y) => x.BirthYear.CompareTo(y.BirthYear));
        Array.ForEach(unstable, Console.WriteLine);

        Console.WriteLine();
        var stable = (Person[]) unsorted.Clone();
        stable.StableSort((x, y) => x.BirthYear.CompareTo(y.BirthYear));
        Array.ForEach(stable, Console.WriteLine);
    }
}

sealed class Person 
{
    public int BirthYear { get; set; }
    public string Name { get; set; }

    public override string ToString() {
        return string.Format(
            "{{ BirthYear = {0}, Name = {1} }}", 
            BirthYear, Name);
    }
} 
```

下面是上述示例程序的输出（在安装了 Windows Vista SP1 和 .NET Framework 3.5 SP1 的机器上运行）：

```
{ BirthYear = 1948, Name = Cat Stevens }
{ BirthYear = 1955, Name = Kevin Costner }
{ BirthYear = 1952, Name = Vladimir Putin }
{ BirthYear = 1955, Name = Bill Gates }
{ BirthYear = 1948, Name = Kathy Bates }
{ BirthYear = 1956, Name = David Copperfield }
{ BirthYear = 1948, Name = Jean Reno }

{ BirthYear = 1948, Name = Jean Reno }
{ BirthYear = 1948, Name = Kathy Bates }
{ BirthYear = 1948, Name = Cat Stevens }
{ BirthYear = 1952, Name = Vladimir Putin }
{ BirthYear = 1955, Name = Bill Gates }
{ BirthYear = 1955, Name = Kevin Costner }
{ BirthYear = 1956, Name = David Copperfield }

{ BirthYear = 1948, Name = Cat Stevens }
{ BirthYear = 1948, Name = Kathy Bates }
{ BirthYear = 1948, Name = Jean Reno }
{ BirthYear = 1952, Name = Vladimir Putin }
{ BirthYear = 1955, Name = Kevin Costner }
{ BirthYear = 1955, Name = Bill Gates }
{ BirthYear = 1956, Name = David Copperfield } 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-09-29T09:40:29.700

正如其他答案所述， Array.Sort 不稳定。但是，LINQ OrderBy 方法（和 OrderByDescending 等）*是*稳定的，这非常有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-29T09:24:38.757

不，它[不是](http://msdn.microsoft.com/en-us/library/6tf1f0bc%28VS.80%29.aspx)：

> 此方法使用快速排序算法。此实现执行不稳定的排序

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-02-13T08:46:00.310

**更新：**此代码无法稳定 Array.Sort（确保元素始终按相同顺序排序）：

```
public static class ComparisonExtensions
{
    public static Comparison<T> WithGetHashCode<T>(this Comparison<T> current)
    {
        return (x, y) =>
        {
            var result = current(x, y);
            if (result == 0)
                return x.GetHashCode() - y.GetHashCode();
            return result;
        };
    }
} 
```

采用：

```
Comparison<Person> comparison = (x, y) => x.BirthYear.CompareTo(y.BirthYear);
Array.Sort(unstable, comparison.WithGetHashCode()); 
```

# c# - 如何在多线程上下文中使方法独占？

> ID：148078
> 
> 赞同：3
> 
> 时间：2008-09-29T09:23:37.527
> 
> 标签：c#, .net, multithreading, locking

我有一个应该以排他方式执行的方法。基本上，它是一个多线程应用程序，其中方法由计时器定期调用，但也可以由用户操作手动触发。

让我们举个例子：

1.  计时器到时，因此调用该方法。该任务可能需要几秒钟。

2.  紧接着，用户点击了某个按钮，这应该会触发相同的任务：BAM。它什么都不做，因为该方法已经在运行。

我使用了以下解决方案：

```
public void DoRecurentJob()
{
    if(!Monitor.TryEnter(this.lockObject))
    {
        return;
    }

    try
    {
        // Do work
    }
    finally 
    {
        Monitor.Exit(this.lockObject);
    }
} 
```

像这样声明的地方`lockObject`：

```
private readonly object lockObject = new object(); 
```

**编辑**：只有一个对象实例包含此方法，因此我将锁定对象更新为非静态。

有更好的方法吗？或者也许这个只是出于某种原因是错误的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-29T09:36:39.383

如果您只是对不让该方法并行运行感兴趣，这看起来很合理。没有什么可以阻止它立即运行，比如在计时器执行 Monitor.Exit() 后半微秒按下按钮。

并且将锁定对象设置为只读静态也很有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-29T09:36:53.297

您也可以使用`Mutex`，或者`Semaphore`如果您希望它跨进程工作（性能略有下降），或者如果您需要设置任何其他数量，而不是允许运行您的代码的同时线程之一。

还有其他可以工作的信号结构，但是您的示例看起来可以解决问题，并且以简单直接的方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-29T09:39:13.777

次要问题：如果 lockObject 变量是静态的，则“this.lockObject”不应编译。虽然这是一个实例方法，但它也具有明显的类型范围行为，这也让人感觉有点奇怪（并且至少应该有大量文档）。可能使它成为一个以实例为参数的静态方法？

它实际上是否使用实例数据？如果没有，请将其设为静态。如果是这样，您至少应该返回一个布尔值来说明您是否对实例进行了工作 - 我发现很难想象我想要对特定数据完成一些工作的情况，但我不关心是否因为使用不同的数据执行了一些类似的工作而没有执行该工作。

我认为它应该工作，但它确实感觉有点奇怪。我通常不喜欢使用手动锁定，只是因为它很容易出错 - 但这看起来不错。（您需要考虑“if”和“try”之间的异步异常，但我怀疑它们不会成为问题 - 我不记得 CLR 做出的确切保证。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-29T10:34:35.873

我认为微软[建议](http://msdn.microsoft.com/en-us/library/ms173179.aspx)使用[lock](http://msdn.microsoft.com/en-us/library/c5kehkcz(VS.80).aspx)语句，而不是直接使用 Monitor 类。它提供了更简洁的布局并确保在所有情况下都释放锁。

```
public class MyClass
{

  // Used as a lock context
  private readonly object myLock = new object();

  public void DoSomeWork()
  {
    lock (myLock)
    {
      // Critical code section
    }
  }
} 
```

如果您的应用程序需要锁来跨越 MyClass 的所有实例，您可以将锁上下文定义为静态字段：

```
private static readonly object myLock = new object(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T10:02:10.787

代码很好，但会同意将方法更改为静态，因为它可以更好地传达意图。奇怪的是，一个类的所有实例之间都有一个同步运行的方法，但该方法不是静态的。

请记住，您始终可以让静态同步方法受到保护或私有，使其仅对类的实例可见。

```
public class MyClass
{ 
    public void AccessResource()
    {
        OneAtATime(this);
    }

    private static void OneAtATime(MyClass instance) 
    { 
       if( !Monitor.TryEnter(lockObject) )
       // ... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-29T10:08:44.267

这是一个很好的解决方案，尽管我对静态锁并不满意。现在你不需要等待锁，所以你不会遇到死锁的麻烦。但是，让锁太显眼很容易让您在下次必须编辑此代码时遇到麻烦。这也不是一个非常可扩展的解决方案。

我通常尝试使我试图保护的所有资源不被多个线程访问为类的私有实例变量，然后也将锁作为私有实例变量。这样，如果您需要扩展，您可以实例化多个对象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-01T11:55:10.953

一种更具声明性的方法是在您希望同步访问的方法上使用[MethodImplOptions.Synchronized说明符：](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.methodimploptions.aspx)

```
[MethodImpl(MethodImplOptions.Synchronized)] 
public void OneAtATime() { } 
```

**但是，不鼓励使用此方法有**几个原因，其中大部分可以在[此处](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.methodimploptions.aspx)和[此处](http://blogs.msdn.com/bclteam/archive/2004/01/20/60719.aspx)找到。我发布了这个，所以你不会想使用它。在 Java 中，`synchronized`是一个关键字，因此在查看线程模式时可能会出现。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-31T20:23:07.900

我们有一个类似的要求，增加了一个要求，如果再次请求长时间运行的进程，它应该在当前循环完成后排队执行另一个循环。它类似于：

[https://codereview.stackexchange.com/questions/16150/singleton-task-running-using-tasks-await-peer-review-challenge](https://codereview.stackexchange.com/questions/16150/singleton-task-running-using-tasks-await-peer-review-challenge)

```
private queued = false;
private running = false;
private object thislock = new object();

void Enqueue() {
    queued = true;
    while (Dequeue()) {
        try {
            // do work
        } finally {
            running = false;
        }
    }
}

bool Dequeue() {
    lock (thislock) {
        if (running || !queued) {
            return false;
        }
        else
        {
            queued = false;
            running = true;
            return true;
        }
    }
} 
```

# c - 如何在扩展Guile的C代码中将字符串转换为bignum？

> ID：148079
> 
> 赞同：0
> 
> 时间：2008-09-29T09:23:56.387
> 
> 标签：c, guile

在 Guile 1.6.* 中，该函数`scm_istring2number(char *str,int strlen,int radix)`完成了工作。

但是，Guile 1.8 中不存在此功能。*. 如何在 Guile 1.8 中完成相同的任务。*?

这不是微不足道的，因为该函数`scm_string_to_number(SCM str,int radix)`不会转换大于 2 ^(31) -1 的数字（至少在 Guile 1.6.* 中）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T09:29:43.643

根据 1.8 ChangeLog，该功能已重命名`scm_c_locale_stringn_to_number`。

# asp.net - 如何以零停机时间部署 ASP.NET 应用程序

> ID：148084
> 
> 赞同：131
> 
> 时间：2008-09-29T09:25:41.607
> 
> 标签：asp.net, iis, deployment, redundancy

要部署我们网站的新版本，我们执行以下操作：

1.  压缩新代码，并将其上传到服务器。
2.  在实时服务器上，从 IIS 网站目录中删除所有实时代码。
3.  将新的代码压缩文件解压到现在为空的 IIS 目录中

这个过程都是脚本化的，并且发生得很快，但是当旧文件被删除并部署新文件时，仍然可能有 10-20 秒的停机时间。

关于 0 秒停机方法的任何建议？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-09-29T09:35:03.880

您需要 2 台服务器和一个负载均衡器。以下是步骤：

1.  开启服务器 2 上的所有流量
2.  在服务器 1 上部署
3.  测试服务器 1
4.  开启服务器 1 上的所有流量
5.  在服务器 2 上部署
6.  测试服务器 2
7.  打开两台服务器上的流量

问题是，即使在这种情况下，如果您使用“粘性会话”，您仍然会重新启动应用程序并丢失会话。如果您有数据库会话或状态服务器，那么一切都应该没问题。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2008-10-13T20:40:36.277

[Microsoft Web 部署工具](http://blogs.iis.net/msdeploy/archive/2008/05/13/web-deployment-tool-beta-1-go-live-just-released.aspx)在某种程度上支持这一点：

> 启用 Windows 事务文件系统 (TxF) 支持。当启用 TxF 支持时，文件操作是原子的；也就是说，它们要么成功，要么完全失败。这可确保数据完整性并防止数据或文件以“中途”或损坏状态存在。在 MS Deploy 中，默认情况下禁用 TxF。

事务似乎是针对整个同步的。此外，TxF 是 Windows Server 2008 的一项功能，因此此事务功能不适用于早期版本。

我相信可以使用文件夹作为版本和 IIS 元数据库来修改脚本以实现 0 停机时间：

*   对于现有路径/网址：
    *   **路径**：\web\app\v2.0\
    *   **网址**：[http://app](http://app)
*   将新的（或修改的）网站复制到服务器下
    *   \web\app\v2.1\
*   修改 IIS 元数据库以更改网站路径
    *   **从**\web\app\2.0\
    *   **到**\web\app\v2.1\

此方法提供以下好处：

*   如果新版本出现问题，您可以轻松回滚到 v2.0
*   要部署到多个物理或虚拟服务器，您可以使用脚本进行文件部署。一旦所有服务器都安装了新版本，您就可以使用 Microsoft Web 部署工具同时更改所有服务器的元数据库。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-11-08T06:04:01.723

通过将 IIS 中的应用程序请求路由用作不同端口上两个本地 IIS 站点之间的软件负载平衡器，您可以在单个服务器上实现零停机时间部署。这被称为**蓝绿色部署策略**，在任何给定时间，负载均衡器中只有两个站点中的一个可用。部署到“关闭”的站点，对其进行预热，然后将其带入负载均衡器（通常通过应用程序请求路由健康检查），然后将启动的原始站点从“池”中取出（再次通过使其健康检查失败）。

[完整的教程可以在这里找到。](https://kevinareed.com/2015/11/07/how-to-deploy-anything-in-iis-with-zero-downtime-on-a-single-server/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-11-19T02:39:24.707

我最近经历了这个，我想出的解决方案是在 IIS 中设置两个站点并在它们之间切换。

对于我的配置，我为每个 A 和 B 站点都有一个 Web 目录，如下所示：c:\Intranet\Live A\Interface c:\Intranet\Live B\Interface

在 IIS 中，我有两个相同的站点（相同的端口、身份验证等），每个站点都有自己的应用程序池。其中一个站点正在运行 (A)，另一个站点已停止 (B)。直播的也有直播主机头。

在部署到现场时，我只是发布到 STOPPED 站点的位置。因为我可以使用 B 站点的端口访问它，所以我可以预热站点，这样第一个用户就不会导致应用程序启动。然后使用批处理文件将实时主机标头复制到 B，停止 A 并启动 B。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-07T13:31:28.357

使用 Microsoft.Web.Administration 的 ServerManager 类，您可以开发自己的部署代理。

诀窍是更改 VirtualDirectory 的 PhysicalPath，从而在新旧 Web 应用程序之间进行在线原子切换。

请注意，这可能会导致新旧 AppDomain 并行执行！

问题是如何同步对数据库等的更改。

通过使用旧的或新的 PhysicalPaths 轮询 AppDomain 的存在，可以检测旧的 AppDomain 何时终止，以及新的 AppDomain 是否已启动。

要强制启动 AppDomain，您必须发出 HTTP 请求（IIS 7.5 支持自动启动功能）

现在您需要一种方法来阻止对新 AppDomain 的请求。我使用了一个命名互斥体 - 它由部署代理创建和拥有，由新 Web 应用程序的 Application_Start 等待，然后在数据库更新完成后由部署代理释放。

（我在网络应用程序中使用标记文件来启用互斥等待行为）一旦新的网络应用程序运行，我就会删除标记文件。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-01-09T12:01:30.827

好的，因为每个人都在反对我在 2008 年写的答案* ...

我会在 2014 年告诉你我们现在是如何做到的。我们不再使用网站，因为我们现在使用的是 ASP.NET MVC。

我们当然不需要负载均衡器和两台服务器来完成这项工作，如果您维护的每个网站都有 3 台服务器，那很好，但对于大多数网站来说，这完全是矫枉过正。

此外，我们不依赖微软最新的向导——太慢，隐藏的魔法太多，而且太容易改变它的名字。

我们是这样做的：

1.  我们有一个后期构建步骤，将生成的 DLL 复制到“bin-pub”文件夹中。

2.  我们使用 Beyond Compare（非常好**）来验证和同步更改的文件（通过 FTP，因为它得到了广泛的支持）到生产服务器

3.  我们在网站上有一个安全 URL，其中包含一个按钮，该按钮将“bin-pub”中的所有内容复制到“bin”（首先进行备份以启用快速回滚）。此时应用程序会自行重启。然后我们的 ORM 检查是否有任何表或列需要添加并创建它们。

那只是几毫秒的停机时间。应用程序重新启动可能需要一两秒钟，但在重新启动期间请求被缓冲，因此实际上停机时间为零。

整个部署过程需要 5 秒到 30 分钟不等，具体取决于更改了多少文件以及要查看多少更改。

这样，您不必将整个网站复制到不同的目录，而只需将 bin 文件夹。您还可以完全控制流程并准确了解正在发生的变化。

**我们总是快速关注我们正在部署的更改 - 作为最后一分钟的仔细检查，因此我们知道要测试什么，如果有任何问题我们准备好了。我们使用 Beyond Compare 是因为它可以让您轻松地通过 FTP 比较文件。如果没有 BC，我永远不会这样做，你不知道你在覆盖什么。

*滚动到底部以查看它:(顺便说一句，我不再推荐网站，因为它们构建速度较慢，并且可能会在编译一半的临时文件时严重崩溃。我们过去使用它们是因为它们允许逐个文件更敏捷部署。非常快速地解决一个小问题，您可以准确地看到您正在部署的内容（如果使用 Beyond Compare，当然 - 否则忘记它）。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-29T09:29:52.300

我能想到的唯一零停机方法涉及在至少 2 台服务器上托管。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-15T17:11:06.647

对于单个服务器，我会稍微改进一下 George 的答案，如下所示：

1.  使用 Web 部署项目将站点预编译为单个 DLL
2.  压缩新站点，并将其上传到服务器
3.  将其解压缩到具有站点正确权限的文件夹中的新文件夹，以便解压缩的文件正确继承权限（可能是 e:\web，带有子文件夹 v20090901、v20090916 等）
4.  使用 IIS 管理器更改包含站点的文件夹的名称
5.  将旧文件夹保留一段时间，以便在出现问题时回退到它

第 4 步将导致 IIS 工作进程进行回收。

如果您不使用 InProc 会话，这只是零停机时间；如果可以，请改用 SQL 模式（更好的是，完全避免会话状态）。

当然，当有多个服务器和/或数据库更改时，它会涉及更多......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-15T00:06:54.977

扩展 sklivvz 的答案，它依赖于某种负载平衡器（或只是同一服务器上的备用副本）

1.  将所有流量定向到站点/服务器 2
2.  （可选）稍等片刻，以确保尽可能少的用户在已部署的版本上有待处理的工作流
3.  部署到站点/服务器 1 并尽可能预热
4.  以事务方式执行数据库迁移（努力做到这一点）
5.  立即将所有流量定向到站点/服务器 1
6.  部署到站点/服务器 2
7.  将流量定向到两个站点/服务器

通过创建数据库快照/副本可以引入一些冒烟测试，但这并不总是可行的。

如果可能和需要使用“路由差异”，例如不同的租户 URL:s (customerX.myapp.net) 或不同的用户，首先部署到不知情的豚鼠组。如果没有任何问题，请发布给所有人。

由于涉及数据库迁移，因此通常不可能回滚到以前的版本。

有一些方法可以让应用程序在这些场景中运行得更好，例如使用事件队列和回放机制，但由于我们正在讨论将更改部署到正在使用的东西，所以真的没有万无一失的方法。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-03-07T12:34:03.773

我就是这样做的：

绝对最低系统要求：
1 台服务器

*   1 个负载均衡器/反向代理（例如 nginx）在端口 80 上运行
*   2 个 ASP.NET-Core/mono reverse-proxy/fastcgi chroot-jails 或 docker-containers 监听 2 个不同的 TCP 端口
    （或者甚至只是两个反向代理应用程序在 2 个不同的 TCP 端口上，没有任何沙箱）

工作流程：

开始事务 myupdate

```
try
    Web-Service: Tell all applications on all web-servers to go into primary read-only mode 
    Application switch to primary read-only mode, and responds 
    Web sockets begin notifying all clients 
    Wait for all applications to respond

    wait (custom short interval)

    Web-Service: Tell all applications on all web-servers to go into secondary read-only mode 
    Application switch to secondary read-only mode (data-entry fuse)
    Updatedb - secondary read-only mode (switches database to read-only)

    Web-Service: Create backup of database 
    Web-Service: Restore backup to new database
    Web-Service: Update new database with new schema 

    Deploy new application to apt-repository 
    (for windows, you will have to write your own custom deployment web-service)
    ssh into every machine in array_of_new_webapps
    run apt-get update
    then either 
    apt-get dist-upgrade
    OR
    apt-get install <packagename>
    OR 
    apt-get install --only-upgrade <packagename>
    depending on what you need
    -- This deploys the new application to all new chroots (or servers/VMs)

    Test: Test new application under test.domain.xxx
    -- everything that fails should throw an exception here
    commit myupdate;

    Web-Service: Tell all applications to send web-socket request to reload the pages to all clients at time x (+/- random number)
    @client: notify of reload and that this causes loss of unsafed data, with option to abort 

    @ time x:  Switch load balancer from array_of_old_webapps to array_of_new_webapps 
    Decomission/Recycle array_of_old_webapps, etc.

catch
        rollback myupdate 
        switch to read-write mode
        Web-Service: Tell all applications to send web-socket request to unblock read-only mode
end try 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-11-25T13:09:58.040

我经常使用的**没有停机时间**的解决方法是：

1.  将正在运行的 .NET 核心应用程序 dll 重命名为 filename.dll.backup

2.  上传新的 .dll（网络应用程序可用并在文件上传时为请求提供服务）

3.  上传完成后，回收应用程序池。需要 RDP 访问服务器或功能以在您的主机控制面板中回收应用程序池。

IIS 在回收时与应用程序池重叠，因此在回收期间通常不会有任何停机时间。因此，请求仍然会在不知道应用程序池已被回收的情况下进入，并且请求可以无缝地服务而不会停机。

我仍在寻找比这更好的方法..!! :)

* * *

## 回答 #12

> 赞同：-8
> 
> 时间：2008-11-20T09:07:01.637

我建议将旧文件保留在那里并简单地覆盖它们。这样，停机时间仅限于单个文件覆盖时间，并且一次只丢失一个文件。

不过，不确定这对“Web 应用程序”是否有帮助（我认为您是在说这就是您正在使用的），这就是我们总是使用“网站”的原因。此外，“网站”部署不会重新启动您的站点并删除所有用户会话。

# .net - "Colorizing" images in .NET

> ID：148086
> 
> 赞同：1
> 
> 时间：2008-09-29T09:26:17.317
> 
> 标签：.net, image-manipulation, episerver, colorize

Is there any simple way to programatically colorize images in .NET? Basically we have a black and white image and need to put a layer of say pink above it and reduce the opacity of that layer to make the picture colorized in pink.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T09:30:25.233

You should use the wonderful [ImageMagick](http://midimick.com/magicknet/) library. It has .NET bindings so no problem there.

Have fun! :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T09:33:19.437

Check out these links:

[http://www.codeproject.com/KB/GDI-plus/csharpgraphicfilters11.aspx](http://www.codeproject.com/KB/GDI-plus/csharpgraphicfilters11.aspx)

[http://www.codeproject.com/KB/GDI-plus/KVImageProcess.aspx](http://www.codeproject.com/KB/GDI-plus/KVImageProcess.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T09:30:47.960

The way that springs to mind is using the Drawing packages to draw a rectangle over the picture in a given colour (you can set alpha). It's not very efficient but, with caching, it wouldn't do any harm, even on a busy server.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T09:45:07.723

This is a little bit too custom for a .net framework method.. If you can't find a single method call solution.. I post something that could be something to look at.

If you have a WPF, you could load the image in a control. Have another control (Rectangle with Pink fill and Transparency) on top of it. (Use something like a Grid for layout so that both of them overlap perfectly) Next you could

```
RenderTargetBitmap bmp = new RenderTargetBitmap( imageWidth,imageHeight, 
  DPIHoriz, DPIVert, 
  PixelFormats.Pbrga32);
 // if you don't want to make the controls 'visible' on screen, you need to trigger size calculations explicitly. 
grid.Measure(new Size(imageWidth, imageHeight));
grid.Arrange(new Rect(0,0, imageWidth, imageHeight);
bmp.Render(grid); 
```

So you get whatever you see on screen, written into the Bitmap in memory. You could then save it off. If that doesn't work, you can go for pixel level control with WriteableBitmap class and do byte-labor.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T10:52:04.223

I think it will be a bit more complicated if you want to colorize an image rather than just putting a smi-transparent layer on top. If you want to have the same effect as the "screen" layer mode in PhotoShop then you have to replace all the shades black in the image with shades of the new color to keep the white parts white.

It can most definetly be done in .NET but I supose it wouldn't hurt to look into a library of some sort.

# asp.net - 通过脚本启用/禁用 asp.net Web 服务扩展

> ID：148097
> 
> 赞同：3
> 
> 时间：2008-09-29T09:31:34.637
> 
> 标签：asp.net, iis

在 IIS 6 中，我可以使用 Inetmgr 中的 Web Service Extensions 文件夹来允许/禁止 isapi 过滤器，例如 ASP.net。我希望能够以编程方式执行此操作（特别是从安装程序脚本/exe）。

![替代文字](https://i56.photobucket.com/albums/g192/assaflavie/misc/iis.png?t=1222681203)

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T09:48:52.893

[使用 Iisext.vbs 添加 Web 服务扩展文件](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/b686f5cf-f84f-44be-af43-33916de846a3.mspx?mfr=true)应该是您正在寻找的内容（链接的文章描述了如何添加新过滤器：如果您只需要启用它，请向下滚动并查看链接文章列表以了解确切信息关于如何实现这一点的说明）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-19T12:39:38.447

```
 Set iisinfo = GetObject("IIS://localhost/W3SVC/Info")
   If CInt(iisinfo.MajorIIsVersionNumber) >= 6 Then
      Set iisinfo = Nothing
      Set iis = GetObject("IIS://localhost/W3SVC")
      iis.EnableWebServiceExtension "ASP"
   End If 
```

# apache-flex - addChild 如何选择错误的插入索引？

> ID：148116
> 
> 赞同：1
> 
> 时间：2008-09-29T09:41:14.613
> 
> 标签：apache-flex, actionscript-3, debugging

因此，在 Flex 应用程序中，我通过创建并调用`parent.addChild()`. 但是在某些情况下，这会导致 Flex 内部出现错误。事实证明， addChild 实际上是：

```
return addChildAt(child, numChildren); 
```

在它中断的情况下， numChildren 以某种方式关闭了一个。导致这个错误：

> RangeError：错误 #2006：提供的索引超出范围。在 flash.display::DisplayObjectContainer/addChildAt() 在 mx.core::Container/addChildAt() 在 mx.core::Container/addChild() 。. 在 flash.events::EventDispatcher/dispatchEventFunction() 在 flash.events::EventDispatcher/dispatchEvent() 在 mx.core::UIComponent/dispatchEvent() 在 mx.controls::SWFLoader::contentLoaderInfo_completeEventHandler()

这是 Flex 中的错误还是我如何使用它？看起来它可能是一个线程错误，但由于 Flex 不支持线程，这有点令人困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T10:54:52.160

I have noticed that it most often occurs when re-parenting a UIComponent that is already on the display list. Are you re-parenting in this situation?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T11:36:23.407

numChildren 没有有效地引用子数组中的现有索引。AS3 中的数组从 0 开始索引。这意味着数组中的最后一项作为索引 numChildren - 1，而不是 numChildren。

尝试 addChildAt(child, numChildren - 1);

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T15:31:39.543

您是否有可能在组件完全初始化之前添加一个孩子？也许在 Event.COMPLETE 广播后尝试添加一个孩子？

它可能不支持线程，但它仍然是异步的......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-29T17:00:56.713

参看。[http://forums.devshed.com/flash-help-38/scroll-pane-scroll-bars-not-working-818174.html](http://forums.devshed.com/flash-help-38/scroll-pane-scroll-bars-not-working-818174.html) - 您需要做的是将子项添加到显示对象，然后设置源的滚动窗格成为显示对象。有点像这样...

代码：

```
var myDisplay : DisplayObject = new DisplayObject();

myDisplay.addChild(myChild1);
myDisplay.addChild(myChild2);
myDisplay.addChild(myChild3);
myDisplay.addChild(myChild4);

ScrollPane.source = myDisplay;
ScrollPane.update(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T00:29:15.250

好的，就像涂料一样，我试图将一个孩子添加到容器中，即使它已经存在，因此会出现令人困惑的“错误插入索引”消息。

# javascript - 您会推荐什么框架来为 Web 制作类似桌面的应用程序？

> ID：148118
> 
> 赞同：4
> 
> 时间：2008-09-29T09:43:10.583
> 
> 标签：javascript, web-applications, frameworks

最近出现了几个用于编写基于 Web 的类桌面应用程序的框架。例如[SproutCore](http://www.sproutcore.com/)和[卡布奇诺](http://cappuccino.org/)。你有使用它们的经验吗？你的印象是什么？我错过了其他一些框架吗？

我在 StackOverflow 上看到过[相关](https://stackoverflow.com/questions/68114/what-is-the-single-most-useful-general-purpose-javascript-library-for-rich-inte) [问题](https://stackoverflow.com/questions/913/what-javascript-library-would-you-choose-for-a-new-project-and-why)，但它们生成的大多是标准答案，例如“使用 jQuery 或 MochiKit 或 MooTools 或 Dojo 或 YUI”。虽然有些人给出[了非标准的](https://stackoverflow.com/questions/68114/what-is-the-single-most-useful-general-purpose-javascript-library-for-rich-inte#68564) [答案](https://stackoverflow.com/questions/913/what-javascript-library-would-you-choose-for-a-new-project-and-why#74111)，但他们似乎没有*使用*这个框架的经验。

任何人都可以分享为浏览器开发类似桌面的应用程序的真实经验吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-29T09:52:55.707

在我看来，卡布奇诺是不该做的一个例子。他们在 JavaScript 之上实现了另一种语言，这已经带来了速度缓慢，而浏览器开发人员已经在努力对抗，而且最糟糕的是，他们根本不依赖浏览器小部件，破坏了所有用户导航体验。例如，他们实现了自己的滚动条，主要缺点是无法再使用鼠标滚轮了！

我真的更喜欢 ExtJS 的方法，它为您提供丰富的小部件，同时使 UI 尽可能靠近浏览器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-29T10:54:08.120

由于这些高级框架对许多大型（例如：非平凡）应用程序造成的速度问题，我们只使用纯 jQuery。在我们的测试中，所有高级框架在有许多可拖动对象或许多放置目标的情况下，以及在屏幕上显示长列表（超过 1000 个条目）的情况下都会崩溃。

部分原因是 IE6 和 IE7 的问题（在 DOM 树达到一定复杂性后性能突然开始急剧下降），但部分原因是这些框架产生的开销。

所以我不会推荐任何高级框架。我的建议是使用 jQuery 并直接使用 DOM。

**一些提高性能的技巧：**

*   在可能的情况下，在服务器上呈现 HTML。
*   使 HTML 尽可能简单。
*   避免在 DOM 树中有很多元素。
*   避免递归表结构（IE 在相对较少的嵌套级别后突然停止显示它们）。
*   从 DOM 树中删除不可见的元素。
*   在更改它们之前从 DOM 树中删除它们，然后重新插入它们，而不是在它们在树中时更改它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-29T10:41:34.687

作为 Gizmo，我也推荐 EXT JS。他们的许可证已更改，它可能不适用于所有人，但如果您想做台式机之类的事情，它仍然是一个不错的选择。

这是他们的桌面环境示例页面： http: [//extjs.com/deploy/dev/examples/desktop/desktop.html](http://extjs.com/deploy/dev/examples/desktop/desktop.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T11:28:48.787

苹果正在证明 sproutcore 确实有效，尽管很难估计它的效果如何。目前，我使用自己开发的一组库构建 Web 应用程序，从我们的 Windows 软件套件中复制一组功能（但适用于 Web 界面）。到目前为止，我一直避免使用框架，特别是因为我不想要臃肿。这种方法的问题是我浪费了过多的时间来复制框架中已经存在的功能，而且我觉得随着时间的推移，我将接近类似于这些框架的东西。

正因为如此，我一直在尝试在 extjs 中实现一个 Web 应用程序，这是一次非常好的体验。性能非常好，并且易于开发，因为它们的组件集非常适合实际构建应用程序，而不仅仅是花哨的演示（Web 工具包中的常见问题）。如果您对构建类似桌面的 Web 应用程序感兴趣，我肯定会推荐它。

扩大规模的问题显然仍然存在，但老实说，我觉得在规模不那么重要的情况下使用工具包会更好，并且只在需要的地方回退到基本的 JavaScript（过早的优化是一切的根源邪恶的）。Extjs 可以在prototype 或jquery 之上分层，所以这种方法绝对可行。避免 DOM 中过多的内容通常是一种按需加载和卸载的方法。例如，extjs 网格类有一个第三方扩展，它允许通过巧妙地加载和卸载数据来滚动一百万行数据集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T11:45:37.310

如果您打算使用 Java，您可能会考虑使用[GWT-Ext （在下面使用 Ext）可能是一个非常干净的解决方案。](http://code.google.com/p/gwt-ext/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-29T11:55:15.883

我喜欢[qooxdoo](http://qooxdoo.org/)，虽然它采用 JS 的 OOP 方法而不是原型，但它是一个可靠的框架并且具有很多功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T09:48:54.937

我对 SproutCore 或 Capuccino 没有任何经验。但是已经尝试在 Django 之上使用 Dojo 来完成此类工作。只能告诉你它很慢而且有问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-26T09:27:12.977

extjs 可能会有所帮助。[http://dev.extjs.com/deploy/dev/examples/](http://dev.extjs.com/deploy/dev/examples/)

# database-design - 触发器与约束的性能注意事项

> ID：148129
> 
> 赞同：17
> 
> 时间：2008-09-29T09:47:57.187
> 
> 标签：database-design, triggers, constraints

我试图找出是否应该在数据库内部的触发器或约束中使用业务关键逻辑。
到目前为止，我已经在触发器中添加了逻辑，因为它让我可以控制接下来发生的事情，这意味着我可以提供自定义用户消息，而不是可能会混淆用户的错误。

在触发器上使用约束是否有任何显着的性能提升，以及确定使用哪个的最佳实践是什么。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-29T10:25:39.483

约束放手！

*   通过约束，您可以指定关系原则，即关于您的数据的事实。除非某些事实发生变化（即新要求），否则您将永远不需要更改约束。

*   使用触发器，您可以指定如何处理数据（在插入、更新等中）。这是一种“非关系”的做事方式。

用一个比喻来更好地解释我自己：编写 SQL 查询的正确方法是指定“你想要什么”而不是“如何得到它”——让 RDBMS 为你找出最好的方法。这同样适用于这里：如果你使用触发器，你必须记住各种事情，比如执行顺序、级联等……如果可能的话，让 SQL 为你做这件事。

这并不是说触发器没有用处。他们这样做：有时您不能使用约束来指定有关数据的某些事实。不过，这非常罕见。如果它经常发生在您身上，*那么*架构可能存在一些问题。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-29T10:10:27.663

**最佳实践**：如果您可以使用约束来做到这一点，请使用约束。

触发器并不像它们被抹黑的那么糟糕（如果使用得当的话），尽管我总是尽可能地使用约束。**在现代 RDMS 中，触发器的性能开销与约束相当**（当然，这并不意味着有人不能在触发器中放置可怕的代码！）。

有时需要使用触发器来强制执行“复杂”约束，例如想要强制填充表的两个外键字段中的一个且只有一个的情况（我在一些域模型中看到过这种情况）。

关于业务逻辑是否应该驻留在应用程序而不是数据库中的争论在一定程度上取决于环境；如果您有许多应用程序访问数据库，则约束和触发器都可以作为数据正确的最终保护。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-29T10:02:10.677

触发器可能会演变成性能问题。大约在发生这种情况的同时，它们也成为维护的噩梦。您无法弄清楚发生了什么**，并且**（奖励！）应用程序的行为不正常，出现“虚假”数据问题。[真的，它们是触发问题。]

没有最终用户直接接触 SQL。他们使用应用程序。应用程序以比触发器更智能、更易于维护的方式包含业务逻辑。将应用逻辑放在应用程序中。将数据放入数据库。

除非您和您的“用户”不使用共同语言，否则您可以向他们解释违反约束的情况。另一种选择——不解释——将一个简单的数据库变成一个问题，因为它将数据和应用程序代码混为一谈，成为一个无法维护的泥潭。

“我如何绝对保证每个人都在正确使用数据模型？”

两种（半）技术。

1.  确保模型是**正确**的：它与现实世界的问题域相匹配。没有只能通过复杂的挥手解释、存储过程和触发器来整理的黑客或解决方法或捷径。

2.  帮助定义应用程序的业务模型层。每个人共享和重用的应用程序代码层。

    一种。另外，确保模型层满足人们的需求。如果模型层有正确的方法和集合，那么绕过它直接访问底层数据的动机就会减少。一般来说，如果模型是正确的，这不是一个严重的问题。

触发器是等待发生的火车残骸。约束不是。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-12T23:01:03.350

除了使用约束的其他原因之外，Oracle 优化器还可以利用约束来发挥其优势。

例如，如果你有一个约束说`(Amount >= 0)`，然后你用`WHERE (Amount = -5)`Oracle 查询立即知道没有匹配的行。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-29T11:04:29.873

约束和触发器用于 2 个不同的事物。约束用于*约束*数据的域（有效输入）。例如，SSN 将存储为 char(9)，但具有 [0-9][0-9][0-9][0-9][0-9][0-9][ 0-9][0-9][0-9]（全数字）。

触发器是在数据库中执行业务*逻辑的一种方式。*再次使用 SSN，也许每当 SSN 发生更改时都需要维护审计跟踪 - 这将通过触发器来完成，

一般来说，现代 RDBMS 中的数据完整性问题可以通过约束的某些变化来处理。但是，您有时会遇到不正确的规范化（或更改的要求，导致现在不正确的规范化）阻止约束的情况。在这种情况下，触发器可能能够强制执行您的约束 - 但它对 RDBMS 是不透明的，这意味着它不能用于优化。这也是“隐藏”的逻辑，可能是一个维护问题。决定是重构模式还是使用触发器是此时的判断调用。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-29T09:59:30.420

一般来说，我更喜欢约束，我的代码会捕获 sql server 错误并为用户提供更友好的内容。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-01T21:43:42.347

@onedaywhen

您可以在 SQL Server 中将查询作为约束，您只需能够将其放入标量函数中：[http://www.eggheadcafe.com/software/aspnet/30056435/check-contraints-and-tsql。 aspx](http://www.eggheadcafe.com/software/aspnet/30056435/check-contraints-and-tsql.aspx)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-29T13:21:04.537

如果有可能使用约束。他们往往更快。触发器应该用于约束无法处理的复杂逻辑。触发器编写也很棘手，如果您发现必须编写触发器，请确保使用基于集合的语句，因为触发器针对整个插入、更新或删除操作（是的，有时会影响多个记录，计划在那！），而不仅仅是一次记录。如果可以避免，请不要在触发器中使用游标。

至于是否将逻辑放在应用程序中而不是触发器或约束中。不要那样做！！！是的，应用程序在发送数据之前应该进行检查，但是数据完整性和业务逻辑必须在数据库级别，否则当多个应用程序挂钩时，当在应用程序外部完成全局插入等时，您的数据会变得混乱。数据完整性是数据库的关键，必须在数据库级别强制执行。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-29T13:58:28.253

@Mark Brackett：“约束用于约束域......触发器是执行业务逻辑的一种方式”：在 SQL Server 中并不是那么简单，因为它的约束功能受到限制，例如尚未完整的 SQL-92。以时态数据库表中有序“主键”的经典示例为例：理想情况下，我会使用带有子查询的 CHECK 约束来防止同一实体的重叠时间段，但 SQL Server 不能这样做，所以我必须使用扳机。SQL Server 还缺少 SQL-92 延迟检查约束的能力，而是在每个 SQL 语句之后（实际上）检查它们，因此可能需要再次使用触发器来解决 SQL Server 的限制。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-02T10:11:03.050

@Meff：使用函数的方法存在潜在问题，因为简单地说，SQL Server CHECK 约束被设计为以单行作为工作单元，并且在处理结果集时存在缺陷。有关这方面的更多详细信息，请参阅：[ [http://blogs.conchango.com/davidportas/archive/2007/02/19/Trouble-with-CHECK-Constraints.aspx][1]](http://blogs.conchango.com/davidportas/archive/2007/02/19/Trouble-with-CHECK-Constraints.aspx][1])。

[1]：David Portas 的博客：CHECK 约束的问题。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-01-09T08:22:59.323

与斯克利兹相同。只是为了让您知道**触发器的规范用法**是审计表。如果许多程序更新/插入/删除您要审计的表（谁修改了什么以及何时），触发器是最简单的方法。一种方法是简单地在你的表中添加一个标志（活动/非活动与一些唯一性约束）并在审计表中插入一些东西。

如果您希望表不保存历史数据，另一种方法是复制审计表中的前一行...

许多人有很多方法可以做到这一点。但有一件事是肯定的，您必须为此表中的每个更新/插入/删除执行插入

**为了避免在十几个不同的地方写入插入，您可以在此处使用触发器。**

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-29T13:00:54.353

我同意这里的每个人关于约束的看法。尽可能多地使用它们。

存在过度使用触发器的趋势，尤其是对于新开发人员。我见过一个触发器触发另一个触发器的情况，该触发器触发另一个触发器，该触发器重复第一个触发器，从而创建一个绑定您的服务器的级联触发器。这是触发器的非最佳用户；o)

话虽如此，触发器有它们的位置，应该在适当的时候使用。它们特别适合跟踪数据的变化（正如 Mark Brackett 所提到的）。您需要回答“将我的业务逻辑放在哪里最有意义”的问题？大多数时候我认为它属于代码，但你必须保持开放的心态。

# java - 如何查看 InputStream 中的前两个字节？

> ID：148130
> 
> 赞同：33
> 
> 时间：2008-09-29T09:48:05.627
> 
> 标签：java, inputstream, bufferedinputstream

应该很简单：我有一个 InputStream，我想在其中窥视（不读取）前两个字节，即我希望 InputStream 的“当前位置”在我窥视后仍然为 0。最好和最安全的方法是什么？

**答案**- 正如我所怀疑的，解决方案是将其包装在提供可标记性的 BufferedInputStream 中。谢谢拉斯穆斯。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-09-29T09:51:05.900

对于一般的 InputStream，我会将其包装在 BufferedInputStream 中并执行以下操作：

```
BufferedInputStream bis = new BufferedInputStream(inputStream);
bis.mark(2);
int byte1 = bis.read();
int byte2 = bis.read();
bis.reset();
// note: you must continue using the BufferedInputStream instead of the inputStream 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-29T15:40:44.313

您可能会发现 PushbackInputStream 很有用：

[http://docs.oracle.com/javase/6/docs/api/java/io/PushbackInputStream.html](http://docs.oracle.com/javase/6/docs/api/java/io/PushbackInputStream.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-29T10:18:50.467

使用 BufferedInputStream 时，请确保 inputStream 尚未缓冲，双缓冲会导致一些严重难以发现的错误。此外，您需要以不同的方式处理 Reader，如果 Reader 被缓冲，则转换为 StreamReader 和 Buffering 会导致字节丢失。此外，如果您使用阅读器，请记住您不是在读取字节，而是在默认编码中读取字符（除非设置了显式编码）。一个缓冲输入流的例子，你可能不知道是 URL url；url.openStream();

我没有任何关于此信息的参考资料，它来自调试代码。对我来说发生问题的主要情况是从文件读取到压缩流的代码。如果我没记错的话，一旦您开始通过代码进行调试，Java 源代码中就会有一些注释表明某些事情并不总是正常工作。我不记得使用 BufferedReader 和 BufferedInputStream 的信息来自哪里，但我认为即使是最简单的测试也会立即失败。记住要测试这一点，您需要标记超过缓冲区大小（对于 BufferedReader 与 BufferedInputStream 不同），当正在读取的字节到达缓冲区末尾时会出现问题。请注意，源代码缓冲区大小可能与您在构造函数中设置的缓冲区大小不同。自从我这样做以来已经有一段时间了，所以我对细节的回忆可能有点不对劲。测试是使用 FilterReader/FilterInputStream 完成的，将一个添加到直接流中，并将一个添加到缓冲流中以查看差异。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-29T09:51:31.733

我在这里找到了 PeekableInputStream 的实现：

[http://www.heatonresearch.com/articles/147/page2.html](http://www.heatonresearch.com/articles/147/page2.html)

本文中显示的实现的想法是它在内部保留了一个“偷看”值的数组。当您调用 read 时，首先从 peeked 数组返回值，然后从输入流返回。当您调用 peek 时，会读取这些值并将其存储在“peeked”数组中。

由于示例代码的许可证是 LGPL，它可以附加到这个帖子：

```
package com.heatonresearch.httprecipes.html;

import java.io.*;

/**
 * The Heaton Research Spider Copyright 2007 by Heaton
 * Research, Inc.
 * 
 * HTTP Programming Recipes for Java ISBN: 0-9773206-6-9
 * http://www.heatonresearch.com/articles/series/16/
 * 
 * PeekableInputStream: This is a special input stream that
 * allows the program to peek one or more characters ahead
 * in the file.
 * 
 * This class is released under the:
 * GNU Lesser General Public License (LGPL)
 * http://www.gnu.org/copyleft/lesser.html
 * 
 * @author Jeff Heaton
 * @version 1.1
 */
public class PeekableInputStream extends InputStream
{

  /**
   * The underlying stream.
   */
  private InputStream stream;

  /**
   * Bytes that have been peeked at.
   */
  private byte peekBytes[];

  /**
   * How many bytes have been peeked at.
   */
  private int peekLength;

  /**
   * The constructor accepts an InputStream to setup the
   * object.
   * 
   * @param is
   *          The InputStream to parse.
   */
  public PeekableInputStream(InputStream is)
  {
    this.stream = is;
    this.peekBytes = new byte[10];
    this.peekLength = 0;
  }

  /**
   * Peek at the next character from the stream.
   * 
   * @return The next character.
   * @throws IOException
   *           If an I/O exception occurs.
   */
  public int peek() throws IOException
  {
    return peek(0);
  }

  /**
   * Peek at a specified depth.
   * 
   * @param depth
   *          The depth to check.
   * @return The character peeked at.
   * @throws IOException
   *           If an I/O exception occurs.
   */
  public int peek(int depth) throws IOException
  {
    // does the size of the peek buffer need to be extended?
    if (this.peekBytes.length <= depth)
    {
      byte temp[] = new byte[depth + 10];
      for (int i = 0; i < this.peekBytes.length; i++)
      {
        temp[i] = this.peekBytes[i];
      }
      this.peekBytes = temp;
    }

    // does more data need to be read?
    if (depth >= this.peekLength)
    {
      int offset = this.peekLength;
      int length = (depth - this.peekLength) + 1;
      int lengthRead = this.stream.read(this.peekBytes, offset, length);

      if (lengthRead == -1)
      {
        return -1;
      }

      this.peekLength = depth + 1;
    }

    return this.peekBytes[depth];
  }

  /*
   * Read a single byte from the stream. @throws IOException
   * If an I/O exception occurs. @return The character that
   * was read from the stream.
   */
  @Override
  public int read() throws IOException
  {
    if (this.peekLength == 0)
    {
      return this.stream.read();
    }

    int result = this.peekBytes[0];
    this.peekLength--;
    for (int i = 0; i < this.peekLength; i++)
    {
      this.peekBytes[i] = this.peekBytes[i + 1];
    }

    return result;
  }

} 
```

# sql - Oracle sql 查询，将文件与 CASE 部分连接起来

> ID：148136
> 
> 赞同：2
> 
> 时间：2008-09-29T09:51:22.170
> 
> 标签：sql, oracle, syntax, case, toad

我目前正在从多个表生成 SQL 插入语句，并且在生成的数据中我需要使用 CASE 语句，如下所示：

```
select 'INSERT INTO TABLE1 (f1, f2, f3, f4 ...) values ('
       ||t.f1||','
       ||CASE
             WHEN t.f2 > 0 THEN '1'
             ELSE '0'
         END CASE
  from table2 t , table3 t3 
```

但此时，如果我想继续我的语句，`... END CASE||','|| ....`我将无法再运行查询，因为 TOAD 抱怨找不到 FROM 关键字。

一个快速的解决方案是将输出分成多个字段，然后将其保存为文本并进行编辑，但必须有更好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T10:04:49.970

使用 END 而不是 END CASE

```
select 'INSERT INTO TABLE1 (f1, f2, f3, f4 ...) values ('
       ||t.f1||','
       ||CASE
             WHEN t.f2 > 0 THEN '1'
             ELSE '0'
         END||','||t.f2
  from table2 t , table3 t3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T10:00:03.210

对于一些类似的情况，“解码”功能效果很好。

您可以将表达式 (t.f2 > 0) 输入解码器，然后将“T”转换为“1”，将“F”转换为“0”。

我没试过这个。

# visual-studio - 有没有办法告诉 Visual Studio 在我加载解决方案时不要打开所有文档？

> ID：148143
> 
> 赞同：22
> 
> 时间：2008-09-29T09:56:29.227
> 
> 标签：visual-studio

当您在 Visual Studio 2008（或之前的版本）中打开解决方案时，它会打开您在关闭 Visual Studio 之前未关闭的所有文档。是否有关闭此功能或修复此行为的插件？加载打开 50 个文件的解决方案需要很长时间？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-29T10:10:36.837

您是否尝试过删除**.suo**文件？

这是一个隐藏文件，位于您的解决方案 (sln) 文件旁边。suo 是“解决方案用户选项”，包含您的最后配置，例如您上次处理项目时打开的选项卡，因此当您在 Visual Studio 中重新加载项目时它们会再次打开。

如果你删除它，一个新的“空白”suo 文件将被静默地重新创建。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-29T13:22:07.140

您可以通过为 EnvDTE.SolutionEvents 的 BeforeClosing 事件添加处理程序来自动关闭解决方案之前关闭所有文件的过程——这将在 VS 退出时被调用。

在 VS2005 中，在 EnvironmentEvents 宏模块中添加以下内容将关闭所有打开的文档：

```
    Private Sub SolutionEvents_BeforeClosing() 处理 SolutionEvents.BeforeClosing
        DTE.ExecuteCommand("Window.CloseAllDocuments")
    结束子

```

Visual Studio 2008 似乎支持相同的事件，所以我相信这也适用。

我敢肯定，如果需要，您也可以在处理程序中删除项目的 .suo 文件，但您可能需要 AfterClosing 事件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-10-02T13:45:42.773

从 Visual Studio 2017 Update 8 开始，项目和解决方案中有一个选项可用于启用此功能：

[![在此处输入图像描述](https://i.stack.imgur.com/w8TLg.jpg)](https://i.stack.imgur.com/w8TLg.jpg)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-13T16:33:58.400

ALT-WL

这是关闭所有打开的选项卡的组合键，可以在关闭项目之前按下它，除非您更喜欢单击 Window | 在关闭项目之前关闭所有文档。

——格斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T10:19:40.230

我不认为有这个选项（或者我找不到），但你可能会编写一个宏来为你在项目打开时执行此操作。

此链接有一些代码可以关闭您可以调整的打开文件：http: [//blogs.msdn.com/djpark/](http://blogs.msdn.com/djpark/)

我找不到这个特定问题的答案，但 ide 提示和技巧的一个很好的链接是：http: [//blogs.msdn.com/saraford/default.aspx](http://blogs.msdn.com/saraford/default.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-29T10:51:12.120

替代答案：

在关闭解决方案之前，按住`Ctrl+F4`，直到所有窗口都关闭。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T13:34:15.613

VS 尝试保存最后一个已知视图。除了上面提到的脚本之外，您可以在退出 VS 之前手动关闭所有文档

# sharepoint - Sharepoint 工作流修改未禁用

> ID：148157
> 
> 赞同：1
> 
> 时间：2008-09-29T10:03:55.417
> 
> 标签：sharepoint, workflow

我正在研究 Sharepoint Server 2007 状态机工作流程。到目前为止，我有一些状态和一个自定义关联/启动表单，它是使用 InfoPath 2007 创建的。此外，我还有一些修改表单。我在删除工作流状态页面中的修改链接时遇到问题。

我有一个状态，在这个状态的初始化块中，我的 EnableWorkflowModification Activity 出现了。因此，在状态开始时，修改处于活动状态。在相同的状态下，我有一个 OnWorkflowModification 活动，它捕获 EnableWorkflowModification 活动引发的事件。在此状态之后，我的修改结束，链接应该在状态页面中消失。但这种情况并非如此。两个活动都具有相同的相关令牌（修改）和相同的所有者（拥有状态）。有谁知道为什么链接没有被删除以及如何删除修改链接？

提前谢谢你，斯特凡！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T17:56:31.530

确保在 eventHandlingScopeActivity 中有 enableWorkflowModification 和 onWorkflowModified，并将其设置为每个的 OwnerActivityName。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T10:14:56.873

您是否检查过 OnWorkflowModification 事件处理程序实际上正在触发？尝试调试或添加一些事件日志跟踪以确保它是。我在 OnWorkflowItemChanged 事件处理程序中遇到了类似的问题。

# eclipse - 生成 getter 和 setter (Zend Studio for Eclipse)

> ID：148161
> 
> 赞同：0
> 
> 时间：2008-09-29T10:07:08.420
> 
> 标签：eclipse, code-generation, zend-studio

我正在使用 Zend Studio for Eclipse (Linux)，我正在尝试在 PHP 类中生成 getter 和 setter 方法。

我尝试这样做：http: [//files.zend.com/help/Zend-Studio-Eclipse-Help/creating_getters_and_setters.htm](http://files.zend.com/help/Zend-Studio-Eclipse-Help/creating_getters_and_setters.htm) 但我在源菜单中没有“生成获取器和设置器”选项，它错过了！

你能帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-29T13:21:38.157

就像 Omnipotent 说的，你可以使用模板来做到这一点。这是我使用的：

```
/**
 * @var ${PropertyType} 
 */
private $$m${PropertyName};
${cursor}

/**
 *  Getter for ${PropertyName}
 *
 * @author ${user}
 * @since ${date} ${time}
 * @return ${PropertyType} private variable $$m_${PropertyName}
 */
public function get${PropertyName}() 
{
  return $$this->m_${PropertyName};
}

/**
 * Setter for ${PropertyName}
 *
 * @author ${user}
 * @since ${date} ${time}
 * @param ${PropertyType} $$Value
*/
public function set${PropertyName}($$Value) 
{
  $$this->m_${PropertyName} = $$Value;
} 
```

要创建模板，只需转到首选项。然后在 PHP/Templates 中，您将拥有模板列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T10:10:35.777

它必须在菜单下 - Eclipse 中的源代码。您能否提供 Eclipse 的快照以进行验证。已编辑：我想在您的版本中无法自动生成 getter 和 setter，尽管您可以为其创建模板并根据您的要求使用它。万能的 (0 秒前)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-03T00:50:31.137

我还没有看到有人提到 Zend Studio ctrl+3 快捷方式/搜索：

ctrl+3 并搜索...

我输入“setters”，菜单上的第一个选项是“Generate Getters and Setters”向导。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T11:01:29.537

@Omnipotent It's Zend Studio v6.01, "generate getters and setters" feature should be available. I can see doc about it in Help Contents.

By the way i'll try updating to v6.1

Thanks anyway!

EDITED: Templates and Code Assist works fine but are not usefull as "Generate getters and setters".

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T10:16:08.553

如果有“重构”菜单，也请在那里检查。在 Eclipse 的更高版本中，其中许多方法已移至“重构”菜单，如果 Zend 最近更新了但未更新其文档，则这些项目可能遇到了未记录的移动。

# cakephp - 删除hasOne或hasMany关联时，是否应该将foreignKey设置为NULL？

> ID：148169
> 
> 赞同：1
> 
> 时间：2008-09-29T10:11:55.570
> 
> 标签：cakephp, associations, model-driven

给定：

> 组有很多人

但是关系是独立的（即个人可以不属于某个组而存在），删除组时是否应该将个人表中的外键（即group_id）设置为0（或NULL）？如果您不这样做，该人将尝试属于一个不存在的组。

我问的原因是这是 Cakephp 中的默认行为。如果将dependent 设置为true，它将删除关联的模型，但如果设置为false，它将保持关联的模型不变。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T10:21:01.273

是的，外键应设置为 NULL（或 0，如果这是您选择的“无组”值），否则您将失去参照完整性。如果您的数据库支持它，您应该能够在框架中设置“删除时”触发器或级联规则来强制执行此操作。CakePHP 中的行为似乎是正确的。如果该值是依赖的，则应在删除时将其删除。如果它不依赖，那么您需要为要采取的正确操作提供额外的行为逻辑（在这种情况下，您希望将所有值设置为 NULL。在其他情况下，您可能希望设置为“默认”组， ETC）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T10:16:58.897

一句话，是的。将外键留在persons 表上会导致数据库内的[参照完整性丢失。](http://en.wikipedia.org/wiki/Referential_integrity)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T10:32:35.800

*> 如果您不这样做，此人将尝试加入一个不存在的组。*

还有一个更糟糕的情况：未来可能会出现一个新的组 B，它会重用已删除的组 A 的 id。然后所有以前 A 组的用户都将“神奇地”加入到新的组 B 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-07T21:36:51.503

实现两个实体独立的情况的另一种更稳定的方法是完全从 Person 中删除外键并创建连接表 group_persons。这样，您在删除组时就不必担心引用的完整性。当您删除一个组时，该关联将从 group_persons 中删除。

桌子看起来像这样

```
id, group_id, person_id 
```

group_persons 模型看起来像这样

```
Person hasMany GroupPerson
Group hasMany GroupPerson
GroupPerson belongsTo Person, Group 
```

如果您希望 Person 一次只能在一个组中，请在 GroupPerson 中设置唯一的验证规则。

```
var $validate=array(
    'person_id'=>array(
        array(
        'rule'=>'isUnique',
        'message'=>'This person is already in a group.'
        )
    )
); 
```

# visual-studio-2008 - 奇怪的 MFC / VC++ 链接器错误 (std::list 已经定义）

> ID：148178
> 
> 赞同：3
> 
> 时间：2008-09-29T10:18:09.050
> 
> 标签：visual-studio-2008, mfc, linker

我收到了一条非常奇怪的错误消息，仅在我将以下行添加到我的项目时才会出现：

```
std::list<CRect> myVar; 
```

值得注意的是，它不一定是 std::list，它可以是 std::vector 或我假设的任何其他 STL 容器。

这是错误消息：

> 错误 1 ​​错误 LNK2005：“公共：__thiscall std::list
> 
> > ::list >(void)" (??0?$list@VCRect@@V?$allocator@VCRect@@@std@@@std@@QAE@XZ) 已在 SomeLowLevelLibrary.lib 中定义

错误消息中引用的低级库不知道我正在构建的项目，它只有核心的低级功能，不处理高级 MFC GUI。

如果我将代码行更改为：

```
std::list<CRect*> myVar; 
```

但我不想为了它而破解它。

此外，无论我是在堆栈还是堆上创建变量，我仍然会得到同样的错误。

有没有人对此有任何想法？我在 Vista Enterprise 上使用 Microsoft Visual Studio 2008 SP1。

**编辑：**上面的链接器错误是针对 std::list<> 构造函数的，我也收到析构函数、_Nextnode 和 clear 函数的错误。

**编辑：**在项目的其他文件中，std::vector 不会链接，在其他文件中它可能是 std::list。我无法弄清楚为什么有些容器可以工作，而有些则不能。MFC 链接在两个库中都是静态的。在低级库中，我们有 1 个继承自 std::list 的类。

**编辑：**低级库没有任何从 CRect 继承的类，但它确实使用了 STL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T14:18:48.773

您应该查看链接器设置，但我不能立即说出哪个。在多个文件中完成 STL 实例化是正常的。链接器应该选择一个。它们都是相同的（假设您*确实*具有一致的编译器设置）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-23T10:32:41.353

我最近在我们的项目中再次偶然发现了这个错误，并决定进行更彻底的调查，而不是像上次那样用 hack 修补它（交换 std::list for CArray）。事实证明，我们的一个低级库是从 std::list 继承的，例如

```
class LIB_EXPORT CRectList : public std::list<CRect>
{
}; 
```

这不仅是不好的做法，而且也是主应用程序中链接器错误的原因。我将 CRectList 更改为包装 std::list 而不是从它继承，并且错误消失了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T14:26:16.097

这听起来不像是确切的症状，但要确保您应该检查您的主项目和所有包含的库是否使用“C++：代码生成”下的相同“运行时库”设置。混合这些设置可能会产生运行时库链接错误。（在您的情况下让我感到困惑的是，您可以通过更改代码使其消失，但如果您还没有这样做，则值得检查。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T20:12:32.943

SomeLowLevelLibrary.lib 是否包含或使用任何名为 CRect 的类？它使用STL吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T14:25:51.177

该文件是否包含在可能被编译成两个单独的代码模块的标头中？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T20:55:38.860

今天另一个随机的可能性突然出现在我的脑海中。您当前的 DLL 和低级库是否有可能引用了两个不同版本的 MFC？远射。

# ruby-on-rails - 创建与 rails 请求分析器一起使用的脚本的最佳方法是什么？

> ID：148181
> 
> 赞同：5
> 
> 时间：2008-09-29T10:19:02.370
> 
> 标签：ruby-on-rails, performance, profiling

rails scirpt`script/performance/request`需要一个会话脚本，生成此会话脚本的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-29T10:19:56.970

将此代码添加到您的 application.rb 文件

```
before_filter :benchmark_log

  def benchmark_log
   File.open("request_log.txt","a") do |f|
      f.puts request.method.to_s + " '" + request.request_uri + "', " + params.except(:action).except(:controller).inspect.gsub(/(^\{|\}$)/,"")
    end
  end 
```

然后您可以在浏览器中访问多个页面，会话脚本将写入您的应用程序根目录下的 request_log.txt 文件中

# opengl - where can i download opengl for windows vista

> ID：148182
> 
> 赞同：2
> 
> 时间：2008-09-29T10:19:22.633
> 
> 标签：opengl, download

I've been searching and can't find the download files on opengl.org. can someone please point me to the right direction?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T10:23:40.783

OpenGL is just a standard. The implementations come with your graphics card drivers and are exposed using WGL extensions in Windows. There is a 'standard' implementation in the platform SDK that is accessed by including the OpenGL headers and the windows header, but this is a basic version (1.1 in XP. I think it's 1.4 in Vista).

If you want an easier method to gain access to all the features from your card's supported features and the basic set of features in the Windows standard OpenGL implementation then I'd suggest looking at GLEW (The openGL Extension Wrangler) which handles all the WGL calls to set up extensions for you.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-29T10:29:28.007

OpenGL 1.1 header files are included in the Platform SDK. If you need to work with a more recent version this may help: [Moving Beyond OpenGL 1.1 for Windows](http://www.gamedev.net/reference/articles/article1929.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T10:36:26.883

Windows (well, Visual Studio at least) comes with opengl, but only the older v1.1 - just

```
#include <windows.h> 
#include <GL/gl.h> 
#include <GL/glu.h> 
```

and link with opengl32.lib, and glu32.lib and you should be ok (its been a while, I may have missed a bit in there)

# php - 在 PHP 中定义的效率如何？

> ID：148185
> 
> 赞同：20
> 
> 时间：2008-09-29T10:20:15.830
> 
> 标签：php, c-preprocessor

C++ 预处理器`#define`完全不同。

PHP`define()`与仅仅创建一个var有什么不同吗？

```
define("SETTING", 0);  
$something = SETTING; 
```

对比

```
$setting = 0;  
$something = $setting; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-03-16T21:25:40.640

'define' 操作本身相当慢 - 由 xdebug profiler 确认。

[这是来自http://t3.dotgnu.info/blog/php/my-first-php-extension.html](http://t3.dotgnu.info/blog/php/my-first-php-extension.html)的基准：

*   纯 'define'
    380.785 fetches/sec
    14.2647 mean ms/first-response

*   用'hidef'扩展定义的常量 930.783
    fetches/sec
    6.30279 mean ms/first-response

* * *

**断链更新**

上面引用的博文已离开互联网。它仍然可以[通过 Wayback Machine 在这里](http://web.archive.org/web/20100504144640/http://t3.dotgnu.info/blog/php/my-first-php-extension.html)查看。这是另[一篇类似的文章](http://shwup.blogspot.com/2010/04/about-constants.html)。

作者引用的库可以在[此处 (apc_define_constants)](http://sg.php.net/manual/en/function.apc-define-constants.php)和[此处 (hidef extension)](http://pecl.php.net/package/hidef)找到。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-29T10:36:54.247

一般来说，常量的想法是在你的*程序中**保持常量*，（听起来很有趣，对吧？;)）。这意味着编译器（解释器）将在整个脚本中用 FOOBAR 的值替换“FOOBAR”。

 *理论和优势就这么多——如果你编译的话。现在 PHP 是非常动态的，在大多数情况下您不会注意到有什么不同，因为每次运行都会编译 PHP 脚本。[Afai 可以告诉您，除非您使用APC](http://php.net/apc)、[Zend Optimizer](http://www.zend.com/products/guard/optimizer/)或[eAccelerator](http://eaccelerator.net/)等字节码缓存，否则常量和变量之间的速度不会有显着差异。那么它就有意义了。

常量的所有其他优点/缺点已在此处注明，并可在[PHP 手册](http://php.net/constants)中找到。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-12-04T01:02:03.900

```
php > $cat='';$f=microtime(1);$s='cowcow45';$i=9000;while ($i--){$cat.='plip'.$s.'cow';}echo microtime(1)-$f."\n"; 
```

0.00689506530762

```
php > $cat='';$f=microtime(1);define('s','cowcow45');$i=9000;while ($i--){$cat.='plip'.s.'cow';}echo microtime(1)-$f."\n"; 
```

0.00941896438599

这是可重复的，结果相似。在我看来，常量的定义和/或使用比变量慢一些。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-29T10:23:02.080

[以下是手册](http://uk3.php.net/manual/en/language.constants.php)中的差异

*   常量前面没有美元符号 ($)；
*   常量只能使用 define() 函数来定义，不能通过简单的赋值；
*   可以在任何地方定义和访问常量，而无需考虑变量范围规则；
*   常量一旦被设置就不能被重新定义或取消定义；和
*   常量只能计算为标量值。

对我来说，主要的好处是全局范围。我当然不担心它们的效率——只要你需要一个不应该改变的全局标量值，就可以使用它们。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-11T01:16:09.747

它似乎没有效率。（我在这里的所有假设都基于 php.net 的一条评论，我自己还没有做过基准测试。）

调用一个常数，需要 2 倍于调用一个变量的时间。

检查常量的存在将需要 2ms 和 12ms 的误报！

这是来自 php 在线文档中定义页面的评论的基准。

> 在使用 defined() 之前，请查看以下基准：

```
true                                       0.65ms
$true                                      0.69ms (1)
$config['true']                            0.87ms
TRUE_CONST                                 1.28ms (2)
true                                       0.65ms
defined('TRUE_CONST')                      2.06ms (3)
defined('UNDEF_CONST')                    12.34ms (4)
isset($config['def_key'])                  0.91ms (5)
isset($config['undef_key'])                0.79ms
isset($empty_hash[$good_key])              0.78ms
isset($small_hash[$good_key])              0.86ms
isset($big_hash[$good_key])                0.89ms
isset($small_hash[$bad_key])               0.78ms
isset($big_hash[$bad_key])                 0.80ms 
```

> PHP 版本 5.2.6、Apache 2.0、Windows XP
> 
> 每条语句都执行了 1000 次，虽然 1000 次调用的 12 毫秒开销不会让最终用户大吃一惊，但与 if(true) 相比，它确实会产生一些有趣的结果：
> 
> 1) if($true) 几乎相同 2) if(TRUE_CONST) 几乎慢了一倍 - 我猜替换不是在编译时完成的（我必须仔细检查这个！） 3) defined() 是如果常量存在则慢 3 倍 4) 如果常量不存在，defined() 会慢 19 倍！5) isset() 非常高效，不管你扔什么（对于任何实现数组驱动事件系统的人来说都是个好消息——我！）
> 
> 可能想避免 if(defined('DEBUG'))...

来自 tfconsulting dot com dot au 的 tris+php 2009 年 3 月 26 日 06:40

[http://us.php.net/manual/en/function.defined.php#89886](http://us.php.net/manual/en/function.defined.php#89886)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-26T06:22:27.730

定义是简单的静态意义，这意味着它的值在运行时不能改变，而变量是动态意义，因为你可以在过程中自由地操纵它的值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-01T07:09:03.290

当我运行速度测试时，设置和转储的常量比设置变量和转储要快得多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-17T18:40:30.727

2020 年更新（PHP 7.2、AMD Ryzen9、Zend OpCache 已启用）

> **摘要**：重新定义相同的常数很慢。检查和定义常量与 $_GLOBALS 相比要慢 8 倍，检查未定义的常量稍微慢一些。*不要使用全局变量。*

*   注意：自动加载器和需要一次长路径可能比定义的问题大得多。（需要一次需要 php 来 stat(2) 路径中的每个目录来检查符号链接，这可以通过使用文件的完整路径来减少，因此 PHP 加载器只需 stat 文件路径 1x 并且可以使用 stat 缓存)

代码：

```
$loops = 90000;
$m0 = microtime(true);
for ($i=0; $i<$loops; $i++) {
   define("FOO$i", true);
}
$m1 = microtime(true);
echo "Define new const {$loops}s: (" . ($m1-$m0) . ")\n";
// etc... 
```

输出：

```
Define new const 90000s: (0.012847185134888)
Define same const 90000s: (0.89289903640747)
Define same super global 90000s: (0.0010528564453125)
Define new super global 90000s: (0.0080759525299072)
check same undefined 90000s: (0.0021710395812988)
check same defined 90000s: (0.00087404251098633)
check different defined 90000s: (0.0076708793640137) 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-29T10:25:16.397

主要区别：

*   定义是常量，变量是变量
*   他们不同的范围/可见性

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2008-09-29T10:25:25.757

不确定效率，但它不仅仅是创建一个var：

*   它是一个常数：您不能重新定义或重新分配此设置。
*   如果未找到定义，则将 $something 设置为“SETTING”，这很有用，例如在 i18n 中：如果缺少翻译（即对应的定义是本地化文件），我们会在大写，很明显...

# sql-server-2005-express - 远程 VB6 应用程序的 SQL2005 Express 速度慢

> ID：148190
> 
> 赞同：1
> 
> 时间：2008-09-29T10:22:57.493
> 
> 标签：sql-server-2005-express

我有一个使用 MSDE 构建的旧版 VB6 应用程序。

随着许多客户的数据库增长到 MSDE 2 GB 的限制，它们会升级到 SQL 2005 Express。

直到今天，这已被证明非常成功。

当通过“网络”连接 SQL 2005 Express 命名实例时，我花了一整天的时间对客户端网络进行故障排除，在该网络上我们的应用程序运行缓慢。

我说“网络”是因为它只有两台 XP SP2 机器——这里没有专用服务器。没有广告。

为了解决这个问题，我在两台机器上都安装了 SQL 2005 Express，并在两台机器上放置了我们数据库的副本。我什至使用我们现在拥有的 SQL2005 Express 安装例程完全重新安装了我们的应用程序。是恢复旧的 MSDE 数据库还是使用新创建的 SQL 2005 Express 数据库没有区别。

当运行我们的应用程序并连接到任何一台机器的本地服务器时，性能都很好。一旦您将任何一台 PC 上的应用程序连接到另一台 PC 上的服务器，它的速度就会非常慢。（无论组合如何）。

现在，我已经重建了统计数据（exec sp_updatestats），重建了所有索引，禁用（暂时）防火墙和病毒软件，并抓住了无数其他的稻草。

我求助于在两台机器上运行 FileMon 和 ProcessMon，甚至编写了一个小测试应用程序来简单地连接和查询数据库中的表。它也运行缓慢 - （连接大约需要 5 - 6 秒）。

当 SQL Server 写入日志文件 (c:\program files\microsoft sql server\mssql.1\log files\log_12.trc) 时，监视器（文件和进程）显示延迟。

但其他工具，如 SQL Management Studio Express 甚至 SSEUtil（我发现的一个 SQL Server Express 诊断实用程序）在从客户端连接到服务器时运行良好。查询（甚至是大查询）会按照您的预期运行。

我确信这个问题是环境问题，因为我们有这么多站点运行看起来相同的设置，没有这样的问题。

有人可以告诉我我应该做些什么来隔离这个问题，甚至提供任何可以帮助解决这个问题的线索或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T10:29:05.230

这可能是由于缓存的查询计划不代表数据，即使您已经重建了索引和刷新了统计信息。您描述的症状（即查询从 SSMS 运行良好但从应用程序运行良好）通常是由错误缓存的查询计划引起的。SSMS 在幕后发出“WITH RECOMPILE”。如果您正在调用存储过程，请暂时将“WITH RECOMPILE”添加到其定义中并检查结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T10:40:45.233

您是否尝试过从另一台机器连接到“服务器”PC？发生什么了？

您是否尝试过将“客户端”连接到另一台“服务器”机器？发生什么了？

问题可能只是像易碎的网卡或电缆一样平凡的东西。

在您进一步绞尽脑汁之前，可能值得检查一下...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T10:55:53.217

制作一个清单并系统地完成它：

在此处添加所有帖子的所有建议，并在下面添加一些建议：

1.  网线
2.  网络速度
3.  对硬盘进行碎片整理
4.  没有网络错误 - 执行 ping 并查找丢失的数据包
5.  每台机器的 RAM
6.  处理器
7.  病毒

等等等等，

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T11:23:58.453

您在“表面配置”工具中启用了哪些网络协议？您可以更改连接字符串以使用（临时）硬编码的 IP 地址吗？

# asp.net - 将 jQuery 集成到现有的 ASP.NET Web 应用程序中？

> ID：148202
> 
> 赞同：3
> 
> 时间：2008-09-29T10:27:08.590
> 
> 标签：asp.net, jquery, asp.net-2.0

微软[最近宣布](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)Javascript/HTML DOM 库**jQuery 将被集成**到 ASP.NET MVC 框架和 ASP.NET/Visual Studio 中。

**使用ASP.NET 2.0**采用 jQuery 的最佳实践或策略是什么？我想为 jQuery准备一个现有的大型 ASP.NET Web 应用程序（**不是MVC）。**我将如何处理版本控制和相关问题？

集成 jQuery 和**ASP.NET Ajax**有什么注意事项吗？还是Telerik 或 Intersoft 控件等**3rd 方组件？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T11:22:36.273

对我来说，使用 UpdatePanels 和 jQuery 时会出现问题（MVC 没有问题，它没有页面生命周期并且是真正无状态的）。例如，有用的 jQuery 习惯用法

```
 $(function() {
  // some actions
}); 
```

如果页面中有 UpdatePanel，用于增强 DOM 或将事件附加到 DOM 元素可能无法与 ASP.NET PostBack 模型很好地交互。到目前为止，我使用以下代码片段绕过它

```
 if (Sys.WebForms.PageRequestManager) {
  Sys.WebForms.PageRequestManager.getInstance().add_endRequest(function() {
    $('#updateListView1').trigger("gridLoaded");
  });
} 
```

`gridLoaded`将在 哪里替换`$(document).ready`。

我认为您必须格外小心并非常了解 ASP.NET 页面/控件生命周期才能混合使用这两种技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T10:50:55.117

David Ward 在这里提到了一个小问题：http: [//encosia.com/2008/09/28/avoid-this-tricky-conflict-between-aspnet-ajax-and-jquery/](http://encosia.com/2008/09/28/avoid-this-tricky-conflict-between-aspnet-ajax-and-jquery/)

但是对于将 jQuery 集成到现有应用程序中不应该有任何重大问题，除非您计划对现有代码进行大量更新/修改以利用 jQuery 的强大功能，否则您不会注意到主要优势。

# soap - logging soap requests in flex 3

> ID：148203
> 
> 赞同：1
> 
> 时间：2008-09-29T10:27:46.623
> 
> 标签：soap, flexbuilder

I'm trying to consume a SOAP webservice from an Adobe Flex 3 application, but the server tell me "Invalid SOAP Envelope. SOAP Body does not contain a message nor a fault". I already wrote other test clients (with both Delphi and C#) and I'm sure it's all ok on the server side, so I need to examine the SOAP envelope Flex is sending out to the server. How to do that? I think it should be some event to listen (in the BaseSys class?) to get the envelope before it will be sent.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T09:07:08.360

感谢您的回复，但问题是状态代码 500（[flex 只能处理代码 200](http://bugs.adobe.com/jira/browse/SDK-14803)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T19:05:42.667

最简单的方法是运行代理。Paros 是一个简单的，用 Java 编写的，因此本质上是多平台的：http: [//www.parosproxy.org/index.shtml](http://www.parosproxy.org/index.shtml)

另外，如果你还没有使用它，你应该安装 firebug：[https ://addons.mozilla.org/fr/firefox/addon/1843](https://addons.mozilla.org/fr/firefox/addon/1843)

网络监控选项卡应该适合您的需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T12:12:26.757

我有两个建议给你：

1.  如果您使用的是 Flex Builder，您可以尝试使用**Data菜单中的****Import Web Service**功能为您的 Web 服务生成一个客户端，然后直接使用它，或者只是调查生成的代码以获取线索。

***   查看来自 Flex SDK 的 Web 服务文档，因为它可能是受支持的 SOAP 版本的问题。检查 Flex SDK 和您的服务器是否使用兼容版本。** 

 **# java - Java：打印_r？

> ID：148204
> 
> 赞同：18
> 
> 时间：2008-09-29T10:28:40.910
> 
> 标签：java, data-structures

上次我问如何在[这里](https://stackoverflow.com/questions/144474/java-arrays-vectors)填充数据结构。现在我想知道 Java 中是否有某些东西，例如我在 PHP 中使用的[print_r](http://www.php.net/print_r)，来表示我在地图和列表中填充的内容，而无需执行我自己的算法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-29T10:39:59.323

在集合上调用 toString 应该返回一个包含所有元素字符串表示形式的字符串。

不过，这不适用于内置数组，因为它们没有 toString 覆盖，只会给你一个内存地址。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-05-11T09:32:29.353

java 中的 toString() 和 PHP 中的 print_r() 之间确实存在差异。请注意，php 中还有 __toString() ，它相当于 java 中的 toString()，所以这不是真正的答案。

当我们有一个对象结构并且我们希望快速查看对象及其值的完整图时，使用 print_r。

在java中为每个对象实现toString没有与print_r相比的能力。

而是使用 gson。它和 print_r 做同样的工作

> Gson gson = new GsonBuilder().setPrettyPrinting().create();
> System.out.println(gson.toJson(someObject));

通过这种方式，您不需要为需要测试它的每个对象实现 toString。

这是文档： [http ://sites.google.com/site/gson/gson-user-guide](http://sites.google.com/site/gson/gson-user-guide)

演示类（在 java 中）：

> 公共类 A {
> 
> ```
> int firstParameter = 0;
> B secondObject = new B(); 
> ```
> 
> }
> 
> 公共类 B {
> 
> ```
> String myName = "this is my name"; 
> ```
> 
> }

这是带有 print_r 的 php 中的输出：

> 对象
> （
> [firstParameter:private] => 0
> [secondObject:private] => B 对象
> （
> [myName:private] => 这是我的名字
> ）
> 
> )

这是带有gson的java中的输出：

> {
> "firstParameter": 0,
> "secondObject": {
> "myName": "这是我的名字"
> }
> }

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-29T22:52:04.570

根据您想要做什么，解决方案可能相当简单。以下不会产生 print_r 提供的格式化输出，但它允许您输出列表、数组和映射的结构：

```
 // Output a list
    final List<String> list = new ArrayList<String>();
    list.add("one");
    list.add("two");
    list.add("three");
    list.add("four");
    System.out.println(list);

    // Output an array
    final String[] array = {"four", "three", "two", "one"};
    System.out.println(Arrays.asList(array));

    // Output a map
    final Map<String, String> map = new HashMap<String, String>();
    map.put("one", "value");
    map.put("two", "value");
    map.put("three", "value");
    System.out.println(map.entrySet()); 
```

对于其他类型的对象，您可以使用[反射](http://java.sun.com/developer/technicalArticles/ALT/Reflection/index.html "使用 Java 反射")来为此创建[实用程序](http://www.google.com/search?q=java+reflection+tostring+utility "谷歌搜索")。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-29T10:45:50.293

您可以尝试旧的 Apache Commons Lang 的[ToStringBuilder](http://commons.apache.org/lang/api/org/apache/commons/lang/builder/ToStringBuilder.html#reflectionToString(java.lang.Object))。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-29T15:04:30.903

其他人提到了这种`toString()`方法。这只有在对象实现时才有用`toString()`。如果它没有被正确实施，你最终会得到这样的结果：`java.lang.Object@1b9240e`.

即使有点繁琐，`toString()`在你自己的类中实现它仍然很容易，但第三方类并不总是会实现它。你最好使用调试器。PHP 中甚至存在类似的东西的唯一原因`print_r`是缺少真正的调试器。我想你会发现能够设置断点而不是使用一堆诊断打印语句将导致更快的工作流程和更清晰的代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-10-25T16:11:16.657

我对类似 Java`print_r`的功能的看法是我编写的[RecursiveDump类。](https://github.com/stivlo/obliquid-lib/blob/master/src/main/java/org/obliquid/helpers/RecursiveDump.java)它并不完美，但对我来说效果很好。用法是：

```
String output = RecursiveDump.dump(...); 
```

它可以使用泛型来改进，我多年前写的，在我知道它们之前。此外，当它尝试处理某些 Collection 类型时，它只会调用 Objects`toString()`方法。

我想使用反射来提取没有适当的类的字段名称`toString()`，但是由于[Spring Roo](http://www.springsource.org/spring-roo) [@RooToString](http://static.springsource.org/spring-roo/org.springframework.roo.annotations/apidocs/org/springframework/roo/addon/tostring/RooToString.html)可以为您编写`toString()`方法......

当然，替代方法是使用调试器的检查器工具，但有时使用打印更快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T10:42:23.250

我不知道 java 中的 print_r 等价物。

但...

每个对象都有一个 toString() 方法的默认实现，如果您为它们调用 toString()，则列表和映射实现会打印它们的内容。

如果您需要打印出任何调试信息，toString() 可能就是您要查找的地方。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-29T10:49:13.810

Java 中没有 print_r 的等价物。

但是对于地图或列表，您可以像这样使用 foreach 循环：

```
List <String> list = …; // fills your list 

// print each list element 

for (String s : list) {

   System.out.println(s);

 } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-29T10:52:03.617

对于数组，最简单的方法是 Arrays.asList(array).toString() 。我通常在调试输出中喜欢的对象上实现 toString()。对于生成的对象（JAXB 等），虽然可能需要创建一个实用程序类来打印它。

# c# - ObjectDataSource Update method with dynamic parameters

> ID：148205
> 
> 赞同：5
> 
> 时间：2008-09-29T10:28:41.440
> 
> 标签：c#, objectdatasource

I have this DataTable that has a varying set of columns except for a sequence number.

| Sequence | Value | Tax | Duty | Total |

Any number of columns should be accepted with unique column names.

To display that table, I need to use an ObjectDataSource mapped to a presenter class with a Select method.

```
class Presenter {
    [DataObjectMethod(DataObjectMethodType.Select)]
    public DataView GetDutyAndTax() { ... }
} 
```

The ObjectDataSource is then bound to a GridView with AutoGenerateColumns set to true. Sequence is the data key.

So far, that works for selecting the table. The problem comes when I need to update the table. The ObjectDataSource keeps nagging me to have an update method with the exact same parameters with that of the columns in the table.

```
public void EditDutyAndTax(string Value, string Tax, string Duty, string original_Sequence) { ... } 
```

But I can not create a method like that because I don't know the set of columns needed.

I tried using a method with variable parameter list but it doesn't want to use it.

```
public void EditDutyAndTax(params object[] values) { ... } 
```

On idea I have now is to create a set of update methods like this in Presenter:

```
public void EditDutyAndTax(string value1, string original_Sequence) { ... }
public void EditDutyAndTax(string value1, string value2, string original_Sequence) { ... }
public void EditDutyAndTax(string value1, string value2, string value3, string original_Sequence) { ... }
//an so on... 
```

But I neither think that's gonna get through code review nor like the idea.

The other idea I have is to create a dynamic method and attach that (if possible) to the Presenter class or wherever at runtime, but I'm not really sure if that would work.

So if you guys have any solution, please help. Thanks so much!

Carlos

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T13:45:36.710

在我看来，您将不得不放弃使用 ObjectDataSource 声明性模型，并转到数据源的“老派”设置并在回发中手动绑定网格（或加载，视情况而定），然后手动处理编辑/更新。

DataSource 对象对您如何使用它们*非常*讲究——如果您尝试越界，它就不能很好地工作，如果有的话。

# asp.net - coordination between Design and Development

> ID：148208
> 
> 赞同：3
> 
> 时间：2008-09-29T10:30:55.647
> 
> 标签：asp.net

Background: I am developing a site in Asp.net 2.0 . Up until now i was handling both the design and development of the site. I used css for the design part. Now the company wants to outsource the design work to a web designer.

Question: How exactly are a designer and developer supposed to coordinate What specifications should i give to the web designer, Do i need to provide him with the aspx pages i have developed, does he also need to look at the code behind.

And how do i incorporate the designed pages in the existing aspx pages.

I would appreciate if someone who is experienced in this provides some insight

thanks.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-29T10:46:44.783

Mayn people may not like my answer, but in my experience it works best if the designer gives you the stylesheet together with a template for the HTML/XML page. Then you incorporate your ASP.NET into that template.

You can see this as one of the few cases where function follows form ;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T10:38:27.970

How will the designer deliver their designs? Will they just provide the necessary graphic elements or will they deliver a valid HTML page? I would suggest you both agree on the DOM for the page and work from there.If they just provide graphics you have full control of the DOM.

The code behind model for .Net was supposed to help separate design and development but IMHO nothing has yet managed a perfect separation because you can't always make a 100% distinction.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T11:46:42.470

确保设计师没有放置任何他认为花哨且动画效果好的东西。很多时候，除非你是 CSS 或 Javascript 的专业人士，否则在 ASP.net 中模拟这样的效果会变得很痛苦。

在我看来，设计师和开发人员之间的协调是必须的，所以我宁愿坐在设计师附近，直到页面的基本设计完成。

# visual-studio-2008 - Run macro in visual studio when solution is closed

> ID：148218
> 
> 赞同：0
> 
> 时间：2008-09-29T10:38:42.540
> 
> 标签：visual-studio-2008, macros

Is it possible to run a macro in Visual Studio 2008 the moment a solution is closed? I would like to delete the .suo-files of that solution, so that the current user settings are not presented to me the next time I open the solution.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T13:36:30.833

（C＃）

在新的 Addin 项目中使用 Connection 类中提供的 _applicationObject。

在 OnConnection 事件中，键入代码以添加新的事件处理程序，如下所示

_applicationObject.Events.SolutionEvents.AfterClosing += _applicationObject.Events.SolutionEvents.BeforeClosing +=

让 IDE 完成这些行并为您创建方法。在 beforeClosing 处理程序中，捕获解决方案文件的名称，并将其存储在类成员中。（例如 this._storeSolutionFile = _applicationObject.Solution.FileName;）

然后在 afterClosing 处理程序中，只需再次选择解决方案文件名（来自 this._storeSolutionFile），将扩展名更改为 sou，然后将其删除。

希望这可以帮助。

# c++ - 如何从一个 long long int 中提取四个 unsigned short int？

> ID：148225
> 
> 赞同：5
> 
> 时间：2008-09-29T10:41:43.017
> 
> 标签：c++, c, 64-bit, bit-manipulation

假设我有一个 long long int 并且想要取出它的位并从中构造四个 unsigned short int。

特定的顺序在这里并不重要。

我通常知道我需要移位并截断到 unsigned short int 的大小。但我想我可能会在某个地方犯一些奇怪的错误，所以我问。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-29T10:44:58.627

```
#include <stdint.h>
#include <stdio.h>

union ui64 {
    uint64_t one;
    uint16_t four[4];
};

int
main()
{
    union ui64 number = {0x123456789abcdef0};
    printf("%x %x %x %x\n", number.four[0], number.four[1],
                            number.four[2], number.four[3]);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T10:48:10.287

```
(unsigned short)((((unsigned long long int)value)>>(x))&(0xFFFF)) 
```

`value`你的`long long int`,是`x`0, 16, 32 或 48 对于四条短裤。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-29T10:45:57.187

```
union LongLongIntToThreeUnsignedShorts {
   long long int long_long_int;
   unsigned short int short_ints[sizeof(long long int) / sizeof(short int)];
}; 
```

那应该做你正在考虑的事情，而不必搞乱位移。

# sql - 从平面文件加载 SQL 表

> ID：148239
> 
> 赞同：3
> 
> 时间：2008-09-29T10:49:28.537
> 
> 标签：sql, sql-server-2005

我正在尝试从平面文件加载 SQL 表。我正在谈论的公寓是一个逗号分隔的文件。这具有填充表所需的所有数据，将每列用逗号“，”分隔。我需要一些方法来更快地将这些内容加载到表格中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-29T10:53:37.607

如果您使用的是 SQL Server，请使用[`BULK INSERT`](http://msdn.microsoft.com/en-us/library/ms188365.aspx)

如果您使用的是 Oracle，请[在此处查看我的答案](https://stackoverflow.com/questions/120001/load-excel-data-sheet-to-oracle-database#120021)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T11:10:03.620

无论您使用什么数据库管理系统，您都可以使用脚本语言（例如 perl 或 php）来建立与数据库的连接、解析文件，然后将数据插入到数据库中。当然，您必须了解脚本语言...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T11:16:36.957

使用mysqldump？

```
mysqldump -u username -p database_name < sql_file.sql 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T12:51:47.043

查看这些速度比较并确定最适合您的： [http ://weblogs.sqlteam.com/mladenp/archive/2006/07/22/10742.aspx](http://weblogs.sqlteam.com/mladenp/archive/2006/07/22/10742.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T16:53:39.223

对于 SQL Server 2005，另一个选项是集成服务 (SSIS)；使用 SSIS，您可以在导入过程中对数据做更多的工作（例如，在其他表中查找值、过滤掉行、导入多个表等）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-29T12:06:43.967

这听起来有点过时，但我使用的编辑器能够为此类作品录制和重放宏。

我为此使用 Textpad ( [www.textpad.com](http://www.textpad.com) )（是的，我购买了许可证），您也可以使用 UltraEdit ( [www.ultraedit.com](http://www.ultraedit.com) ) 或其他熟悉的东西。就像启动 maro 记录器一样简单，编辑第一行使其与 SQL 兼容，转到下一行并停止记录器。然后让编辑器将宏重复到文件末尾。

主要优点是：处理完文件后，您可以将其存储并放入版本控制中。如果处理得当，**它适用于每个**可以执行包括 SQL 命令在内的文件的数据库（或工具）。

# memory - 有什么方法可以在不打开计算机的情况下检查我的计算机使用哪种类型的 RAM？

> ID：148249
> 
> 赞同：2
> 
> 时间：2008-09-29T10:54:14.110
> 
> 标签：memory, windows-xp, hardware, system-information

我想在订购升级之前检查我的计算机使用的是哪种类型的 RAM。我相当确定它的 DDR2，但我想仔细检查一下。

有什么方法可以在 Windows XP 中检查这一点而无需打开机箱并查看？

*编辑* 内容警察似乎搞错了，我正在寻找一个软件或一个命令，可以让我检查这个。我觉得这使得这个问题对 StackOverflow 和其他程序员感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-29T10:58:51.277

[CPU-Z](http://www.cpuid.com/cpuz.php)可以告诉你。在 SPD 选项卡上，您可以查看 DIMM 特定信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T10:59:38.420

如果它是标准的香草盒，那么请前往 Crucial 并使用他们的内存选择器工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T10:56:05.027

从设备管理器中找出主板/芯片组，谷歌它，知道它需要什么。

正如 Greg Hewgill 所说，您需要编写一些脚本（以使其成为 SO 上的有效问题）-但您必须自己完成那部分 =）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T10:59:19.323

CPU-Z 可以告诉你类型以及当前的时钟速度和内存时序。

[http://www.cpuid.com/cpuz.php](http://www.cpuid.com/cpuz.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-02T11:02:36.297

让我知道是否有帮助：任务管理器 > 性能

[![在此处输入图像描述](https://i.stack.imgur.com/kXLaG.png)](https://i.stack.imgur.com/kXLaG.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-21T05:53:42.867

如果 CPUID 不显示 RAM 详细信息使用 HWiNFO，它将提供有关硬件的详细信息 [https://www.hwinfo.com/download/](https://www.hwinfo.com/download/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-26T18:03:31.037

试试这个：

**wmic 内存芯片列表已满**

在这你会得到 memorytype 如果它是 24 那么你正在使用 DDR3 如果它是 0 那么你有机会使用 DDR4

安什·夏尔马

# css - CSS居中技巧

> ID：148251
> 
> 赞同：12
> 
> 时间：2008-09-29T10:55:07.820
> 
> 标签：css, layout, positioning, center

我最喜欢的仅使用 CSS 使 xhtml 元素居中的方程式如下：

```
display: block;
position: absolute;
width: _insert width here_;
left: 50%;
margin-left: _insert width divided by two & multiplied by negative one here_ 
```

在支持它的浏览器中还有更简单的 margin:auto 方法。是否有其他人有巧妙的方法来强制内容在其容器中居中显示？（垂直居中的奖励积分）

编辑 - 哎呀，忘记了左侧边距中的“负”部分。固定的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-29T11:05:37.420

```
div #centered{
 margin: 0 auto;
} 
```

根据我的经验，似乎是最可靠的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-29T11:52:47.463

坚持保证金：0自动；用于水平对齐；如果您还需要垂直对齐，请使用 position: absolute; 最高：50%；边距顶部：-（宽度/ 2）像素；但是请注意，如果您的容器的宽度大于屏幕的宽度，则使用 Position: absolute 方法，它的一部分将在左侧从屏幕上脱落。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-29T11:00:14.157

好吧，我不得不说，这似乎是一种巨大的矫枉过正。我倾向于将容器设置`text-align:center;`为旧浏览器，`margin:auto;`现代浏览器，然后保持原样。然后在元素中重置文本对齐（如果它包含文本）。

当然，有些东西需要设置为块，宽度需要设置......但是你到底想要什么风格需要*这么*多的黑客攻击？

```
<div style="text-align:center">
     <div style="width:30px; margin:auto; text-align:left">
         <!-- this div is sitting in the middle of the other -->
     </div>
</div> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-29T11:11:59.467

只要您确保 IE 处于标准模式，Margin:auto 就可以在所有浏览器中使用。

它比其他的更挑剔，并且要求您的文档类型是文档中的第一个，这意味着它之前没有空格（空格、制表符或换行符）。

如果你这样做，margin:auto 就是要走的路！:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T11:17:39.670

请注意，margin:auto; 仅当浏览器可以计算要居中的项目的宽度和父容器的宽度时，该方法才有效。在许多情况下设置宽度：自动；有效，但在某些情况下无效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-29T11:35:55.400

使用 50% 方法的绝对定位具有严重的副作用，如果浏览器窗口比元素窄，那么某些内容将出现在浏览器的左侧 - 无法滚动到它。

坚持汽车利润——它们要可靠得多。

如果您在标准模式下工作（您应该这样做），那么您可能关心的所有浏览器都支持它们。

如果您确实需要支持 Internet Explorer 5.5 和更早版本，可以使用 text-align hack。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-29T11:53:09.337

这是一个方便的 CSS 技巧书签

[http://css-discuss.incutio.com/](http://css-discuss.incutio.com/)

[也](http://css-discuss.incutio.com/?page=CenteringAnImage)包含[许多](http://css-discuss.incutio.com/?page=CenteringBlockElement) [居中](http://css-discuss.incutio.com/?page=CenteringTextVertically)技巧。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-29T12:37:43.627

```
body {
    text-align: center;
}
#container {
    width: 770px;
    margin: 0 auto;
    text-align: left;
} 
```

这在所有常用的浏览器中都能很好地工作。如前所述`margin: 0 auto;`，不适用于所有 IE 的半当前版本。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-09-29T11:37:28.017

试试这个; 不知道它是否在 IE 中工作，但在 Fx 中工作正常。它仅使用 CSS（无 JavaScript）将 DIV 块居中在页面上，没有自动边距，并且 DIV 块中的文本仍然左对齐。我只是想知道垂直居中是否也可以这样工作，但到目前为止还没有成功。

```
<html>
<head>
<title>Center Example</title>
<style>
.center {
   clear:both;
   width:100%;
   overflow:hidden;
   position:relative;
}
.center .helper {
   float:left;
   position:relative;
   left:50%;
}
.center .helper .content {
   float:left;
   position:relative;
   right:50%;
   border:thin solid red;
}
</style>
</head>
<body>
<div class="center">
   <div class="helper">
      <div class="content">Centered on the page<br>and left aligned!</div>
   </div>
</div>
</body>
</html> 
```

# oracle - Oracle database startup problems

> ID：148262
> 
> 赞同：1
> 
> 时间：2008-09-29T10:59:32.477
> 
> 标签：oracle

In Oracle, I have set the `log_archive_dest1='D:\app\administrator\orcl\archive'` parameter and shutdown the database. When I tried to start up the db, I got the following error:

```
SQL> startup mount;

ORA-16032: parameter LOG_ARCHIVE_DEST_1 destination string cannot be translated

ORA-09291: sksachk: invalid device specified for archive destination

OSD-04018: Unable to access the specified directory or device.

O/S-Error: (OS 3) The system cannot find the path specified. 
```

Does anyone have any ideas of how I might fix this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T11:32:55.577

您可能需要在目录名称后面加上 \

即 D:\app\administrator\orcl\archive\

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T11:10:55.490

我从未使用过 Oracle，但您可能会尝试的一些事情是

*   确保您使用的文件路径的权限允许数据库读取/写入它？
*   确保路径中的所有文件夹都已存在
*   在 Windows 上，您可能会发现“\”字符会混淆数据库。您是否以相同的方式为 Oracle 指定其他路径？另一种方法可能是使用“/”而不是“\”。起源于 Unix 世界的不同程序以不同的方式处理 Windows 路径

# c# - 如何在透明窗口中绘制透明 DirectX 内容？

> ID：148275
> 
> 赞同：5
> 
> 时间：2008-09-29T11:05:53.067
> 
> 标签：c#, windows, directx, transparent, direct3d

我想绘制 DirectX 内容，使其看起来漂浮在桌面和任何其他正在运行的应用程序之上。我还需要能够使 directx 内容半透明，以便其他内容显示出来。有没有办法做到这一点？

我正在使用带有 C# 的托管 DX。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T08:57:30.467

从 OregonGhost 提供的链接开始，我找到了一个适用于 Vista 的解决方案。这是 C# 语法中的基本过程。此代码位于从 Form 继承的类中。如果在 UserControl 中，它似乎不起作用：

```
//this will allow you to import the necessary functions from the .dll
using System.Runtime.InteropServices;

//this imports the function used to extend the transparent window border.
[DllImport("dwmapi.dll")]
static extern void DwmExtendFrameIntoClientArea(IntPtr hWnd, ref Margins pMargins);

//this is used to specify the boundaries of the transparent area
internal struct Margins {
    public int Left, Right, Top, Bottom;
}
private Margins marg;

//Do this every time the form is resized. It causes the window to be made transparent.
marg.Left = 0;
marg.Top = 0;
marg.Right = this.Width;
marg.Bottom = this.Height;
DwmExtendFrameIntoClientArea(this.Handle, ref marg);

//This initializes the DirectX device. It needs to be done once.
//The alpha channel in the backbuffer is critical.
PresentParameters presentParameters = new PresentParameters();
presentParameters.Windowed = true;
presentParameters.SwapEffect = SwapEffect.Discard;
presentParameters.BackBufferFormat = Format.A8R8G8B8;

Device device = new Device(0, DeviceType.Hardware, this.Handle,
CreateFlags.HardwareVertexProcessing, presentParameters);

//the OnPaint functions maked the background transparent by drawing black on it.
//For whatever reason this results in transparency.
protected override void OnPaint(PaintEventArgs e) {
    Graphics g = e.Graphics;

    // black brush for Alpha transparency
    SolidBrush blackBrush = new SolidBrush(Color.Black);
    g.FillRectangle(blackBrush, 0, 0, Width, Height);
    blackBrush.Dispose();

    //call your DirectX rendering function here
}

//this is the dx rendering function. The Argb clearing function is important,
//as it makes the directx background transparent.
protected void dxrendering() {
    device.Clear(ClearFlags.Target, Color.FromArgb(0, 0, 0, 0), 1.0f, 0);

    device.BeginScene();
    //draw stuff here.
    device.EndScene();
    device.Present();
} 
```

最后，具有默认设置的表单将具有玻璃状的部分透明背景。将 FormBorderStyle 设置为“none”，它将 100% 透明，只有您的内容漂浮在所有内容之上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-01-18T13:02:53.523

您可以使用 DirectComposition、LayeredWindows、DesktopWindowManager 或 WPF。所有方法都有其优点和缺点：

-DirectComposition 是最有效的一种，但需要 Windows 8 并且限制为 60Hz。

-LayeredWindows 很难通过 Direct2D-interop 使用 DXGI 来处理 D3D。

-WPF 通过 D3DImage 相对容易使用，但也仅限于 60Hz 和 DX9 且没有 MSAA。通过 DXGI 与更高 DX 版本的互操作是可能的，当 MSAA-Rendertarget 解析为原生非 MSAA 表面时，也可以使用 MSAA。

-DesktopWindowManager 非常适合自 Windows Vista 以来提供的高性能，但 DirectX 版本似乎受到 DWM 使用的版本的限制（在 Vista 上仍然是 DX9）。更高 DX 版本的解决方法应该可以通过 DXGI（如果可用）来实现。

如果不需要每像素 aplha，也可以使用半透明形式的 opacity-value。

或者您对 Window 全局 alpha 使用本机 Win32 方法（请记住 0 的 alpha 不会捕获鼠标输入）：

```
SetWindowLong(hWnd, GWL_EXSTYLE, GetWindowLong(hWnd, GWL_EXSTYLE) | WS_EX_LAYERED);
COLORREF color = 0;
BYTE alpha = 128;
SetLayeredWindowAttributes(hWnd, color, alpha, LWA_ALPHA); 
```

我已经能够在 C# 和 SharpDX 中使用所有描述的技术，但在 DirectComposition、LayeredWindows 和本机 Win32 的情况下，需要一点 C++-Wrappercode。对于初学者，我建议通过 WPF。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-29T11:12:02.757

我猜如果不使用桌面窗口管理器，即如果你想支持 Windows XP，那将很难。不过，使用 DWM 似乎[相当容易](http://www.codeproject.com/KB/directx/umvistad3d.aspx)。

如果速度不是问题，您可以先渲染到表面，然后将渲染的图像复制到分层窗口。不要指望这会很快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T10:07:27.150

[WPF](http://learnwpf.com/)也是另一种选择。

> 由 Microsoft 开发的 Windows Presentation Foundation（或 WPF）是一种计算机软件图形子系统，用于在基于 Windows 的应用程序中呈现用户界面。

# word-automation - Word 拼写检查在 Word 2007/Vista 上运行缓慢

> ID：148279
> 
> 赞同：1
> 
> 时间：2008-09-29T11:07:47.417
> 
> 标签：word-automation

我编写了一个 DLL，它使用 MS Word 对 RichtextBox 的内容进行拼写检查。该项目使用*Microsoft Word 11.0 对象库*。我已经读到您可以在使用该版本 Word 或更高版本的机器上使用该参考资料，这似乎是正确的。

但是...当我在装有 Windows Vista 和 Word 2007 的机器上的测试应用程序中运行 dll 时，它运行速度非常慢。2007 版的 Word 对象库是否有任何不同，从而使其在自动化过程中变得非常慢？还是在运行时进行某种重新解释，使其表现得像这样？

我是否应该制作不同版本的 dll，一个用于 Word 2003 的机器，一个用于 Word 2007 的机器？这真的会使制作用于许多不同项目的拼写检查 dll 变得毫无意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T12:55:26.957

您应该像处理任何其他工程问题一样处理此问题： 1\. 分析代码以查看是否是您的错 2a。如果是你的错，请根据需要更正 2b。如果是那个特定的 .dll，请将您的拼写检查对象定义为接口或抽象类，并在运行时使用最适合您运行环境的该接口的具体实例。

# c++ - Eclipse C++ 漂亮的打印？

> ID：148281
> 
> 赞同：3
> 
> 时间：2008-09-29T11:08:18.803
> 
> 标签：c++, eclipse, printing, eclipse-cdt

我们从 Eclipse 打印 C++ 源代码时得到的输出相当难看。

是否有方法/插件可以漂亮地打印 C++ 源代码，例如使用 a2ps（可能正在使用另一个 C 源代码过滤器）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T11:25:22.147

请参阅这篇使用*enscript*作为漂亮打印引擎的[DDJ文章。](http://www.ddj.com/cpp/197002115?pgno=4)

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-29T19:05:00.653

我也用`enscript`这个。这是我经常使用的别名：

```
别名 cpp2ps='enscript --color --pretty-print=cpp --language=PostScript'

```

我像这样使用它：

```
cpp2ps -P main.ps main.cpp

```

还有其他几个很棒的选项，`enscript`包括旋转、2 列输出、行号、页眉/页脚等。查看[enscript 手册页](http://linux.die.net/man/1/enscript)。

此外，在 Mac 上，XCode 可以很好地打印 C++ 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:40:15.113

我想扩展 Windows 7 的响应，因为省略了一些关键步骤：

# 这适用于使用 Eclipse CDT 的 MinGW 用户

0) 如果您没有 python GDB，请打开 shell/命令并使用 MinGW-get.exe 来“安装”启用 Python 的 GDB，例如

```
 MinGw-get.exe install gdb-python 
```

[1a) 从http://python.org/download/](http://python.org/download/)获取 Python 2.7.x并安装

1b) 确保在您的环境中设置了 PYTHONPATH 和 PYTHONHOME：

```
 PYTHONPATH should be C:\Python27\Lib   (or similar)
 PYTHONHOME should be C:\Python27 
```

1c) 将 PYTHONHOME 添加到您的 PATH

```
 %PYTHONHOME%;... 
```

2a) 打开一个文本回车，输入以下语句。请注意，第 3 行指向 python 脚本所在的位置。请参阅下面的注释！

```
python
import sys
sys.path.insert(0, 'C:/MinGW/share/gcc-4.6.1/python')         
from libstdcxx.v6.printers import register_libstdcxx_printers
register_libstdcxx_printers (None)
end 
```

2b) 另存为 '.gdbinit' 注意：Windows 资源管理器不允许您命名以资源管理器中的句点开头的文件。大多数文本编辑（包括记事本）都可以。GDB 初始化文件就像 GDB 命令的“脚本”，GBD 将在加载时执行。

2c) '.gdbinit' 文件需要位于 GDB 的工作目录中（很可能这是您的项目根目录，但您的 IDE 可以告诉您。

3) 打开您的 Eclipse（或其他 IDE）首选项对话框。转到 C++ 调试器子菜单。

4) 配置 Eclipse 以`C:\MinGW\bin\gdb-python27.exe`用作调试器和您`.gdbinit`的配置文件。

5a) 重新创建所有调试启动配置（删除旧配置并从头开始创建新配置）。

```
--OR-- 
```

5b) 编辑每个调试配置并将其指向新的 gdb-python.exe 并将其指向。

## 如果您遇到问题：

--别忘了把上面python代码中的位置改成python目录！这个目录是由 MinGW 创建的，所以不要去下载漂亮的打印机，MinGW 在第 0 步就为你做了。只需转到您的 MinGW 安装目录、共享文件夹、GCC 文件夹（有版本号），您就会找到 python 文件夹。这个位置应该是 GDB 加载的 python 脚本中的位置。

--另外，.gdbinit 是一个 PITA，确保它的命名正确并且在 GDB 的工作文件夹中，这不一定是 gdb-python.exe 所在的位置！在加载 GDB 时查看您的 GDB 输出，以查看是否 a) 'python-enabled' 在加载过程中出现，以及 .gdbinit 中的语句是否出现。

--最后，我对系统变量有很多问题。如果 python 给你'ImportError'，那么很可能你没有设置 PYTHONPATH 或 PYTHONHOME。

--带有'gdb-python27'的目录（例如C:\MinGW\bin'）也应该在你的路径上，如果是的话，它会使设置eclipse更好一些，因为你不需要输入绝对路径. 但是，有时 .gbdinit 需要绝对路径。如果它有效，您将在调试器启动时看到来自 gbd (console->gdb 跟踪) 的输出：

```
835,059 4^done
835,059 (gdb) 
835,059 5-enable-pretty-printing
835,069 5^done
....
835,129 12^done
835,129 (gdb) 
835,129 13source C:\MinGW\bin\.gdbinit
835,139 &"source C:\\MinGW\\bin\\.gdbinit\n"
835,142 13^done
835,142 (gdb) 
```

# c# - 您如何为您的对象实施审计跟踪（编程）？

> ID：148291
> 
> 赞同：10
> 
> 时间：2008-09-29T11:16:08.473
> 
> 标签：c#, logging, object, audit

我需要在我的对象上实现添加/编辑/删除的审计跟踪，我正在使用 ORM (XPO) 来定义我的对象等。我实现了一个触发的审计跟踪对象

1.  节省
2.  删除

对于基础对象，我将更改存储在 Audit-AuditTrail (Mast-Det) 表中，用于字段更改。等使用一些方法服务调用。

您如何在 OOP 代码中实施审计跟踪？请分享您的见解？有什么图案之类的吗？最佳实践等？另一件事是如何在运行单元测试时禁用审计，因为我不需要审计它们，但因为基础对象有代码。

对对象的更改（编辑/添加/删除）以及需要审核哪些字段更改

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-29T11:42:28.550

如果可以的话，数据库触发器是首选的方式。

但是，最近我不得不在客户端代码中执行此操作，我最终编写了一个类，该类在打开对象进行编辑时创建了对象的深层（值）副本，并在保存时比较了两个对象（使用 ToString()仅）并将任何更改写入审计表。

编辑：我在每个我想考虑审计的属性上都有一个 [Audit] 属性，并使用反射来查找它们，使得该方法不特定于被审计的对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T16:17:42.303

我不知道它是否会与您的 ORM 无缝匹配，但我为 ERP 应用程序使用[了时间点数据库设计，并且非常推荐它。](http://www.simple-talk.com/sql/database-administration/database-design-a-point-in-time-architecture/)您会自动从此架构中获得历史记录和审计，以及其他好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T12:25:09.587

如果您创建一组用于与数据库交互的 DAO（数据访问对象），我更多地来自 SW 端而不是 DB 端。然后，我会将审计功能插入到需要跟踪的 DAO 中的相应功能中。

数据库触发器解决方案也是可行的，这取决于您喜欢将功能放在数据库中还是代码中

有很多 ORM（对象关系映射）工具可以为您创建 DAO 层。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T05:40:23.003

我已经在 Hibernate（另一个 ORM）中使用会话拦截器完成了这项工作。这样，审计代码与您的代码是分开的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-30T14:13:20.173

我们使用 AOP（aspectJ 实现）实现了类似的解决方案。使用这个特定的点可以被捕获并且可以执行特定的操作。

这可以在我们喜欢的时候插入和关闭。

如果您真的想在应用程序层中执行此操作，我建议您这样做。

希望能帮助到你..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-29T11:18:35.050

我知道这不能回答您的问题，但为了记录，我更喜欢在数据库中处理这种类型的审计逻辑。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-28T22:50:50.613

我们有一个表，所有审计跟踪条目都存储在其中。每个表上都有一个数据库触发器（它由存储过程放在那里，但这与这个答案无关）。更改值时，旧值将存储在审计跟踪中。我们的有点复杂，因为我们还有一个查找表，其中包含我们拥有的每个表的列表，另一个表包含每个表的每个字段。这使我们可以根据第一列中该表的 ID 在哪个表中查找审计跟踪中的条目。然后我们也可以根据第二个表的 ID 确切地知道我们要查找的字段。这使我们不必为表名和字段名存储字符串。为了显示它，我们的网格在删除按钮旁边有一个“审计跟踪”按钮。这将打开一个带有该记录历史的弹出网格。我们使用剑道网格，但这些实现都不是必需的。弹出窗口是引导弹出窗口。

# charts - 如何使用 Google Chart API 在点处打印值？

> ID：148295
> 
> 赞同：0
> 
> 时间：2008-09-29T11:18:26.937
> 
> 标签：charts

我已经阅读了他们的开发人员指南，但找不到在点（折线图的情况下）或条形图（条形图）之后打印值的方法。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T11:39:53.017

您可以使用标签来实现这一点，它[在文档中](https://developers.google.com/chart/interactive/docs/gallery/barchart#Labels)- 它有一个带有条形图的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T11:38:11.727

我认为目前这是不可能的。几天前，我自己查看了 Google Chart API。相反，我发现（并且可能会使用）FusionCharts Free pacakge。

它具有您需要的功能，而且这些点可以是交互式的。

# c++ - 如何检查是否相等？(0 == i) 或 (i == 0)

> ID：148298
> 
> 赞同：22
> 
> 时间：2008-09-29T11:20:44.983
> 
> 标签：c++, c, coding-style

好的，我们知道下面两行是等价的——

1.  `(0 == i)`
2.  `(i == 0)`

此外，过去鼓励使用第一种方法，因为如果您不小心使用了“=”而不是“==”，编译器会给出错误消息。

我的问题是——在当今这一代非常漂亮的 IDE 和智能编译器中，您仍然推荐第一种方法吗？

特别是，当我看到以下代码时，这个问题突然出现在我的脑海中——

```
if(DialogResult.OK == MessageBox.Show("Message")) ... 
```

在我看来，我永远不会推荐上述内容。有没有第二意见？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-09-29T11:23:50.373

我更喜欢第二个，(i == 0)，因为读起来感觉更自然。你问人们，“你 21 岁或以上吗？”，而不是“21 岁小于或等于你的年龄吗？”

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-29T11:26:14.407

在 C# 中将变量放在第一位还是最后都没有关系，因为赋值不会计算为 bool（或可转换为 bool），因此编译器会捕获任何错误，例如“if (i = 0) EntireCompanyData.Delete( )"

因此，至少在 C# 世界中，这是一种风格问题，而不是绝望。并且把变量放在最后对于说英语的人来说是不自然的。因此，对于更具可读性的代码，变量优先。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-29T11:25:10.073

如果您有一个无法通过开关很好地表示的 if 列表（可能是由于语言限制），那么我宁愿看到：

```
if (InterstingValue1 == foo) { } else
if (InterstingValue2 == foo) { } else
if (InterstingValue3 == foo) { } 
```

因为它可以让您快速查看哪些是您需要检查的重要值。

特别是，在 Java 中，我发现这样做很有用：

```
if ("SomeValue".equals(someString)) {
} 
```

因为 someString 可能为 null，这样你就永远不会得到 NullPointerException。如果您将知道永远不会为空的常量与可能为空的对象进行比较，这同样适用。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-29T12:24:28.217

1.  (0 == 我)

我会一直选这个。确实，当今大多数编译器都不允许在条件语句中分配变量，但事实是有些编译器允许。在今天的网络编程中，我必须在系统上使用无数种语言。通过使用 0 == i，我始终知道条件语句是正确的，并且我不依赖编译器/解释器来为我捕捉错误。现在，如果我必须从 C# 跳转到 C++ 或 JavaScript，我知道我不必在我的代码中跟踪条件语句中的赋值错误。对于这么小的东西并让它节省大量时间，这是不费吹灰之力的。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-29T15:29:03.093

我曾经坚信更具可读性的选项（i == 0）是更好的选择。

然后我们遇到了一个生产错误（幸好不是我的），问题是 ($var = SOME_CONSTANT) 类型的错误。客户开始收到本应发送给其他客户的电子邮件。敏感类型数据也是如此。

你可以争辩说 Q/A 应该抓住它，但他们没有，那是另一回事。

从那天起，我一直在推动 (0 == i) 版本。它基本上消除了问题。感觉不自然，所以你要注意，所以你不会犯错误。这里根本没有办法弄错。

发现有人在代码审查中没有反转 if 语句也比有人不小心在 if 中赋值要容易得多。如果格式是编码标准的一部分，人们就会寻找它。人们通常不会在代码审查期间调试代码，并且眼睛似乎会扫描 (i = 0) 和 (i == 0)。

我也是 java "Constant String".equals(dynamicString) 的忠实粉丝，没有空指针异常是一件好事。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-29T11:49:40.937

你知道，我总是使用条件的**if (i == 0)**格式，我这样做的原因是我用 C# 编写了我的大部分代码（无论如何都会标记另一个代码）并且我先进行测试无论如何，我的开发方法和测试通常都会发现这个错误。

我曾在他们试图强制执行 0==i 格式的商店工作过，但我发现它写起来很尴尬，记起来也很尴尬，而且它最终成为了那些正在寻找低垂果实的代码审查者的饲料。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-29T11:26:25.187

实际上，DialogResult 示例是我推荐这种风格的地方。如果可以看到，它将 if() 的重要部分放在左侧。如果它在右侧并且 MessageBox 有更多参数（很可能），您可能需要向右滚动才能看到它。

OTOH，我从未见过“（0 == i）”风格有多大用处。如果你记得把常数放在前面，你可以记得使用两个等号，

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-29T11:57:10.793

我一直在尝试使用第一种情况（0==i），这几次救了我的命！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-29T11:21:57.477

我认为这只是风格问题。它确实有助于意外使用赋值运算符。

我绝对不会要求程序员长大。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-29T11:45:30.290

我更喜欢（i == 0），但我仍然为自己制定一个“规则”来做（0 == i），然后每次都打破它。

“嗯？”，你想。

好吧，如果我有意识地决定在左侧放置一个左值，那么我会充分注意我正在输入的内容，以注意我是否为“==”输入了“=”。我希望。在 C/C++ 中，我通常将 -Wall 用于我自己的代码，这会在 gcc 上为大多数“=”生成警告，因为“==”错误无论如何。我不记得最近看到过那个警告，也许是因为我编程的时间越长，我对以前犯过的错误就越本能地偏执……

```
if(DialogResult.OK == MessageBox.Show("Message")) 
```

对我来说似乎被误导了。诀窍的重点是避免意外分配给某些东西。

但是谁能说 DialogResult.OK 是否比 MessageBox.Show("Message") 更可能评估为可分配类型？在 Java 中，方法调用不可能是可分配的，而字段可能不是最终的。因此，如果您担心为 == 键入 =，那么对于这个示例，在 Java 中实际上应该是相反的。在 C++ 中，两者都不能赋值。

(0==i) 之所以有用，是因为您绝对确定数字文字永远不可分配，而 i 可能是。

当比较的双方都是可分配的时，您无法以这种方式保护自己免受意外分配的影响，而当您不知道哪个是可分配的而不查找时也是如此。没有魔术说“如果你把它们放在反直觉的地方，你就会安全”。虽然我认为它引起了人们对这个问题的关注，就像我的“总是打破规则”规则一样。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-29T12:49:06.237

我使用 (i == 0) 的原因很简单，因为它读起来更好。它在我的脑海中产生了非常流畅的流动。当您出于调试或其他目的将代码通读给自己时，它就像阅读一本书一样简单，而且更有意义。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-29T11:25:10.417

我的公司刚刚从其编码标准中删除了执行 if (0 == i) 的要求。我可以看到它是多么有意义，但在实践中它似乎倒退了。有点遗憾的是，默认情况下 C 编译器可能不会给你一个关于 if (i = 0) 的警告。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-29T12:38:30.100

## 第三个选项 - 完全禁止在条件内赋值：

在高可靠性情况下，不允许（在前面的注释中没有很好的解释）在条件语句中分配变量 - 它完全消除了这个问题，因为您要么在编译器处关闭它，要么使用 LINT 并且仅在非常受控的情况下你可以使用它吗？

请记住，无论赋值发生在条件内部还是外部，通常都会生成相同的代码——这只是减少代码行数的捷径。*规则总是有*例外，但它永远不必在条件中 - 如果需要，您总是可以写出自己的方式。

因此，另一种选择只是禁止此类语句，并在需要时使用注释关闭 LINT 检查此常见错误。

-亚当

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-29T11:24:04.490

如果您尝试用简单（和模棱两可）的英语来表达一行，我会说 (i == 0) 听起来会更自然。这实际上取决于程序员的编码风格或他们需要遵守的标准。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-29T11:24:37.673

就我个人而言，我不喜欢（1）并且总是喜欢（2），但是在处理对话框和其他可能超长的方法时，为了可读性而反转。它看起来并不坏，但是如果您将 MessageBox 扩展到它的全长。您必须一直向右滚动才能确定返回的结果类型。

因此，虽然我同意您关于值类型的简单比较的断言，但我不一定认为它应该成为消息框之类的规则。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-29T11:27:57.383

两者都是相等的，尽管我更喜欢 0==i 变体。

比较字符串时，比较 "MyString".equals(getDynamicString()) 更容易出错

因为， getDynamicString() 可能会返回 null。为了更稳定，写 0==i

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-29T11:42:43.260

好吧，这取决于所讨论的语言和编译器。上下文就是一切。

在 Java 和 C# 中，除了比较两个布尔值的极少数情况外，“赋值而不是比较”拼写错误最终会导致无效代码。

我可以理解为什么人们可能想在 C/C++ 中使用“安全”形式——但坦率地说，如果你打错字，大多数 C/C++ 编译器都会警告你。如果你使用的编译器没有，你应该问自己为什么:)

在我看来，第二种形式（变量然后是常量）更具可读性——所以在任何绝对不会引起问题的地方，我都会使用它。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-09-29T13:09:42.350

所有编码标准的规则 0 应该是“编写其他人可以轻松阅读的代码”。出于这个原因，我使用（最快速变化的值）测试（不太快速变化的值或常数），即在这种情况下为“i == 0”。

即使这种技术很有用，规则也应该是“避免将左值放在比较的左边”，而不是“总是把任何常量放在左边”，这就是它通常的解释方式——例如，什么都没有从写作中获得

```
if (DateClass.SATURDAY == dateObject.getDayOfWeek()) 
```

如果 getDayOfWeek() 无论如何都返回一个常量（因此不是左值）！

我很幸运（至少在这方面），因为这些天我主要使用 Java 进行编码，并且如前所述，如果 (someInt = 0) 不会编译。

关于比较两个布尔值的警告有点像红鲱鱼，因为大多数时候你要么比较两个布尔变量（在这种情况下交换它们没有帮助），要么测试是否设置了一个标志，结果很糟糕**-betide-**如果我发现您在条件句中将任何内容与真假进行了明确的**比较**！呸！

 *** * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-29T15:32:26.967

在 C 语言中，是的，但是您应该已经打开了所有警告并且正在编译无警告，并且许多 C 编译器将帮助您避免该问题。

我很少从可读性 POV 中看到太多好处。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-29T16:33:29.800

对于大于几百行的代码，代码可读性是最重要的事情之一，而且绝对 i == 0 比相反的更容易阅读

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-29T11:24:26.957

也许不是你的问题的答案。我尝试使用 === （检查是否相同）而不是相等。这样就不会进行类型转换，它会强制程序员确保传递了正确的类型，

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-29T11:24:43.367

您说得对，将重要组件放在首位有助于提高可读性，因为读者倾向于主要浏览左列，将重要信息放在那里有助于确保它会被注意到。

但是，永远不要对同事低头说话，即使是开玩笑也暗示这将是你的行为不会让你在这里得到高分。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-29T11:27:23.750

我总是选择第二种方法。在 C# 中，编写

```
if (i = 0) {
} 
```

无论如何都会导致编译器错误（无法将 int 转换为 bool），因此您可能会犯错误实际上并不是问题。如果您测试布尔值，编译器仍会发出警告，您不应将布尔值与真或假进行比较。现在你知道为什么了。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-29T12:12:22.190

我个人更喜欢使用变量-操作数-值格式，部分原因是我使用它的时间很长，以至于感觉“自然”，部分原因是它似乎是占主导地位的约定。有一些语言使用赋值语句，例如：

```
:1 -> x 
```

因此，在这些语言的上下文中，即使它是有效的，看到以下内容也会变得非常混乱：

```
:if(1=x) 
```

所以这也是需要考虑的事情。我确实同意消息框响应是从可读性的角度来看使用值操作数变量格式效果更好的一种情况，但是如果您正在寻找恒定性，那么您应该放弃它的使用。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-29T12:36:35.020

这是我最大的烦恼之一。没有理由降低代码的可读性（如果 (0 == i)，什么？0 的值如何变化？）以捕捉过去 20 年编写的任何 C 编译器都可以自动捕捉的东西。

是的，我知道，大多数 C 和 C++ 编译器默认情况下不会打开它。查找正确的开关以将其打开。没有理由不了解您的工具。

当我看到它蔓延到其他通常会标记它的语言（C#、Python）时，我真的很紧张！

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2012-06-26T21:40:52.910

我相信唯一会迫使一个人超越另一个的因素是，如果工具链没有提供警告来捕捉表达式中的赋值。我作为开发人员的偏好无关紧要。通过清晰地呈现业务逻辑来更好地服务于表达式。如果 (0 == i) 比 (i == 0) 更合适我会选择它。如果不是我会选择另一个。

表达式中的许多常量由符号名表示。一些风格指南还限制了可用于标识符的词性。我使用这些作为指导来帮助塑造表达式的阅读方式。如果生成的表达式读起来像伪代码一样松散，那么我通常会很满意。我只是让表达自己表达，如果我错了，它通常会在同行评审中被抓住。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2008-09-29T12:00:57.553

我们可能会继续谈论我们的 IDE 有多好，但我仍然对降低 IDE 警告级别的人数感到震惊。

因此，对我来说，最好让人们使用 (0 == i)，因为你永远不知道哪个程序员在做什么。最好是“安全总比抱歉”

* * *

## 回答 #28

> 赞同：-3
> 
> 时间：2009-06-16T05:02:45.850

```
if(DialogResult.OK == MessageBox.Show("Message")) ... 
```

我*总是*建议以这种方式编写比较。如果 MessageBox.Show("Message") 的结果可能为空，那么如果比较是相反的，那么您将面临 NPE/NRE 的风险。

在包含 NULL 的世界中，数学和逻辑运算不是自反的。

# database-design - 管理配置数据的最佳方式

> ID：148305
> 
> 赞同：3
> 
> 时间：2008-09-29T11:24:09.827
> 
> 标签：database-design, configuration, saas

我正在开发一个 SaaS 应用程序，其中每个客户将根据他们购买的版本、他们购买的附加功能等具有不同的配置。例如，客户可能有 3 个自定义报告的限制。

显然我想将此配置存储在数据库中，但我不确定最好的方法。我们希望将来能够在不需要更改数据库架构的情况下添加其他功能，因此每个配置选项具有一列的单个表是不明智的。

可能的选项是一个表，每个客户一个条目，一个 XML 字段包含该客户的整个配置，但是当 XML 模式更改以添加其他功能时，这会增加复杂性。

我们可以使用带有键值对的表，并将所有配置设置存储为字符串，然后解析为正确的数据类型，但这似乎有点混乱，就像为字符串配置选项、整数配置选项提供单独的表一样，等等

人们正在使用的这种场景是否有一个好的模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-11T19:52:08.013

实际上，我认为这里不需要不同的配置。您需要的是授权级别和适当的用户界面，以不显示用户未付费的功能。

此类应用程序的良好授权数据模型将是基于角色的访问控制 (RBAC)。谷歌是你的朋友。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-29T20:58:37.340

如果您的数据库是 SQL Server 2005+，您的键/值表可以使用 SQLVARIANT 数据类型作为值字段 - 使用第三列存储您需要将其转换为使用的数据类型。

这样你就可以在同一个字段中插入不同大小的数字和文本值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T23:22:43.437

我认为这将取决于您的产品如何销售给客户。

如果你只卖包装...

```
PACKAGE 1 -> 3 reports, date entry, some other stuff.
PACKAGE 2 -> 6 reports, more stuff
PACKAGE 3 -> 12 reports, almost all the stuff
UBER PACKAGE -> everything 
```

我认为设置这些软件包的表格并链接到该表格会更容易。

如果您单独出售每个模块并带有变体...

```
Customer wants 4 reports a week with an additional report every other tuesday if it's a full moon. 
```

那我会——

```
Create a table with all the product features.
Create a link table for customers and the features they want.
In that link table add an additional field for modification if needed. 
```

顾客

```
customer_id (pk) 
```

模块

```
module_id (pk)
module_name (reports!) 
```

CUSTOMER_MODULES

```
module_id (pk) (fk -> modules)
customer_id (pk) (fk -> customers)
customization (configuration file or somesuch?) 
```

这对我来说最有意义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-02T13:31:55.140

为什么你这么害怕架构改变？当您更改应用程序时，您无疑将需要额外的配置数据。这将需要其他模式更改，那么为什么要害怕呢？

架构更改是您应该能够容忍的，将其纳入您的开发、测试和发布过程，并在未来的设计更改中加以利用。

架构更改发生；习惯它 ：）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T11:33:00.803

键值对表，但所有内容都存储为字符串，并使用另一列（如有必要）说明应将值转换为哪种类型。

```
CREATE TABLE configKVP(clientId int, key varchar, value varchar, type varchar) 
```

如果该值无法转换为类型，那么您就知道这是一个错误配置并且没有歧义。

# sap-enterprise-portal - 门户风格和主题

> ID：148314
> 
> 赞同：-1
> 
> 时间：2008-09-29T11:26:09.493
> 
> 标签：sap-enterprise-portal

我已将 SRM 5.0 集成到 Portal 中。大多数 iviews 都是 IAC 即，都是基于 ITS 的服务。

问题是门户主题在集成后不会反映在这些服务上。

当 BSP 或 Webdynpro 被集成时，应用程序会在从 Portal 执行时反映 Portal 主题，但 ITS 服务没有得到这个。

我尝试使用 SE80 并编辑 EBPApplication.css。在 BBPGLOBAL 中，我将所有颜色属性更改为自定义颜色，但没有效果。

我应该更改哪个属性以删除蓝色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T22:07:14.770

您的相应门户主题有一个 ITS 主题生成器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T14:49:29.870

您可以使用 FireFox 和[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)来确定 CSS 值的位置并在线测试它们。

# asp.net - 如何将文件从 ASP.NET 上传到另一个 Web 应用程序

> ID：148322
> 
> 赞同：4
> 
> 时间：2008-09-29T11:30:54.943
> 
> 标签：asp.net, file, upload

我有一个场景，我需要从一个 Web 应用程序上传文件并在另一个应用程序中使用它。我的设置如下。

*   一台服务器，在 IIS 中托管两个 Web 应用程序 - 两者都是 ASP.NET
*   其中一个应用程序用于管理另一个应用程序 + 更多东西
*   我需要从这个管理应用程序上传一个文件，通过 DAL 将路径保存在 DB 中，然后从另一个 Web 应用程序访问该文件，该应用程序将提供该文件以供下载
*   我将文件保存在磁盘上，只有 DB 中的路径

那么我可以在哪里以及如何上传文件，以便可以从两个 Web 应用程序访问它？我应该使用服务还是有其他方式？
以下是我发现的一些相关问题，但我认为它们并未涵盖我的特定场景：
[如何处理文件上传到专用图像服务器？](https://stackoverflow.com/questions/63146/how-to-handle-file-uploads-to-a-dedicated-image-server)
[如何将文件上传到 WCF 服务？](https://stackoverflow.com/questions/51256/how-to-upload-a-file-to-a-wcf-service)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-29T11:45:52.880

由于两个应用程序都在同一台服务器上，这应该很简单：

*   将上传的文件保存在服务器上的某处。
*   在任何需要公开指向物理路径的文件的应用程序中创建一个虚拟目录。
*   将虚拟路径保存在数据库中以获得灵活性

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-29T11:44:57.437

您可以在每个应用程序中设置一个新的虚拟目录，该目录指向服务器上将文件上传到的同一文件夹。假设您在 c: 驱动器上创建了一个名为“uploads”的新文件夹，即 c:\uploads。然后在 IIS 中设置一个名为“uploads”的新虚拟目录，该目录指向每个 Web 应用程序的 c:\uploads。这应该使两个站点都可以访问文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T11:38:20.417

请问您为什么不将文件保存在数据库中？这将使传递它更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T11:45:28.840

假设您放入数据库的文件路径可以从非管理员 Web 应用程序（听起来像是）访问，该文件只需要放在两个应用程序都有权访问的地方。只有管​​理员应用程序需要具有写入权限。

您可以在 IIS 管理控制台的网站属性 > 目录安全下配置 IIS 网站将运行的用户帐户。然后只需确保设置适当的目录权限。

# java - 如何为 apache commons httpclient 注册 url 处理程序

> ID：148350
> 
> 赞同：1
> 
> 时间：2008-09-29T11:41:51.047
> 
> 标签：java, httpclient

我希望能够使用 apache httpclient 访问自定义 URL。像这样的东西：

```
HttpClient client = new HttpClient();
HttpMethod method = new GetMethod("media:///squishy.jpg");
int statusCode = client.executeMethod(method); 
```

我可以以某种方式注册自定义 URL 处理程序吗？或者我应该只用Java注册一个，使用

```
URL.setURLStreamHandlerFactory(...) 
```

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T11:59:53.640

我们这样做：

```
 org.apache.commons.httpclient.protocol.Protocol.registerProtocol("ss-https", 
     new Protocol("ss-https",
     (ProtocolSocketFactory)new EasySSLProtocolSocketFactory(), 443)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T11:59:37.587

我认为在 commons httpclient 中没有办法做到这一点。它也没有多大意义，毕竟它是一个HTTP客户端并且“media:///squishy.jpg”不是HTTP，所以实现HTTP协议的所有代码可能无论如何都无法使用.

```
URL.setURLStreamHandlerFactory(...) 
```

可能是要走的路，但是您可能必须手动进行很多协议编码，具体取决于您的“媒体”协议。

# c# - 是否可以从 silverlight 创建图像文件并将其上传到 Web 服务器？

> ID：148354
> 
> 赞同：1
> 
> 时间：2008-09-29T11:43:27.300
> 
> 标签：c#, silverlight, image-manipulation, silverlight-2.0

我刚刚开始使用 silverlight 2 beta，找不到如何或是否可以将画布渲染为位图图像，然后将其上传到我的 Web 服务器？

这可能吗？如果可以，我将如何完成这项任务？

* * *

**更新：**现在可以在 silverlight 3 下使用可写位图将 XAML 保存为 JPEG，请参阅此处的博客文章：http: [//blog.blueboxes.co.uk/2009/07/21/rendering-xaml-to- a-jpeg-using-silverlight-3/](http://blog.blueboxes.co.uk/2009/07/21/rendering-xaml-to-a-jpeg-using-silverlight-3/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T11:57:45.657

您无法在 Silverlight 2 中将画布渲染为位图，但如果您可以生成画布的 XAML 版本，则可以将其传递给服务器并执行类似以下服务器端的操作：

[http://www.thedatafarm.com/blog/2008/01/31/ConvertingSilverlightInkPresenterImagesToAPNGFile.aspx](http://www.thedatafarm.com/blog/2008/01/31/ConvertingSilverlightInkPresenterImagesToAPNGFile.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T17:32:28.007

您现在唯一的选择（如果您希望在客户端的 Silverlight CLR 中完成）是从 fjcore 开始

[http://code.google.com/p/fjcore/](http://code.google.com/p/fjcore/)

这只是一个起点，您将不得不编写大量代码——它主要会给您一个图像表示和一个 JPEG 编码器。

你无法获得画布的像素，所以如果你需要它，那么我认为你不走运。但是 fjcore 会给你一个 Image 对象，你可以为它编写绘图例程，然后你必须在它上面绘图（不确定你想要做什么，但如果它很简单，它可能没问题）。

# hotfix - 您在哪里检查 Microsoft 的修补程序是否已应用于任何服务包？

> ID：148358
> 
> 赞同：1
> 
> 时间：2008-09-29T11:45:37.293
> 
> 标签：hotfix

我对Microsoft 已为其提供修补程序的已[报告错误](http://support.microsoft.com/kb/941132/en-us)感兴趣。在网站上查看时，我无法确定此修复程序是否包含在服务包中。有谁知道我在哪里可以找到这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T11:53:50.723

您没有提及您的产品，但是：

适用于 XP 的 Service Pack 1 中的修复列表：http: [//support.microsoft.com/kb/324720](http://support.microsoft.com/kb/324720)

XP 的 Service Pack 2 中的修复列表：http: [//support.microsoft.com/kb/811113](http://support.microsoft.com/kb/811113)

适用于 XP 的 Service Pack 3 中的修复列表：http: [//support.microsoft.com/kb/946480](http://support.microsoft.com/kb/946480)

Vista Service Pack 1 中的修复列表：[http ://technet.microsoft.com/en-us/library/cc749061.aspx](http://technet.microsoft.com/en-us/library/cc749061.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T12:28:12.637

对于与安全相关的补丁，请尝试 MBSA：[http ://technet.microsoft.com/en-us/security/cc184924.aspx](http://technet.microsoft.com/en-us/security/cc184924.aspx)

还可以尝试针对已安装的修补程序运行 WMI 查询。我相信服务包会注册捆绑的修补程序。

# javascript - 如何将键盘焦点赋予 DIV 并将键盘事件处理程序附加到它？

> ID：148361
> 
> 赞同：84
> 
> 时间：2008-09-29T11:46:09.103
> 
> 标签：javascript, events, keyboard

我正在构建一个应用程序，我希望能够单击由 DIV 表示的矩形，然后使用键盘通过列出键盘事件来移动该 DIV。

我可以在 DIV 级别侦听键盘事件，而不是在文档级别为这些键盘事件使用事件侦听器，也许通过给它键盘焦点？

这是一个简化的示例来说明问题：

```
<html>
<head>
</head>
<body>

<div id="outer" style="background-color:#eeeeee;padding:10px">
outer

   <div id="inner" style="background-color:#bbbbbb;width:50%;margin:10px;padding:10px;">
   want to be able to focus this element and pick up keypresses
   </div>
</div>

<script language="Javascript">

function onClick()
{
    document.getElementById('inner').innerHTML="clicked";
    document.getElementById('inner').focus();

}

//this handler is never called
function onKeypressDiv()
{
    document.getElementById('inner').innerHTML="keypress on div";
}

function onKeypressDoc()
{
    document.getElementById('inner').innerHTML="keypress on doc";
}

//install event handlers
document.getElementById('inner').addEventListener("click", onClick, false);
document.getElementById('inner').addEventListener("keypress", onKeypressDiv, false);
document.addEventListener("keypress", onKeypressDoc, false);

</script>

</body>
</html> 
```

单击内部 DIV 时，我尝试将其聚焦，但后续键盘事件总是在文档级别而不是我的 DIV 级别事件侦听器中获取。

我是否只需要实现特定于应用程序的键盘焦点概念？

我应该补充一点，我只需要它在 Firefox 中工作。

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2008-09-29T12:18:32.300

排序 - 我将 tabindex 属性添加到目标 DIV，这会导致它获取键盘事件，例如

```
<div id="inner" tabindex="0">
    this div can now have focus and receive keyboard events
</div> 
```

[从http://www.w3.org/WAI/GL/WCAG20/WD-WCAG20-TECHS/SCR29.html](http://www.w3.org/WAI/GL/WCAG20/WD-WCAG20-TECHS/SCR29.html)收集的信息

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-12-16T02:30:07.873

保罗的回答很好，但你也可以使用 contentEditable，像这样......

```
document.getElementById('inner').contentEditable=true;
document.getElementById('inner').focus(); 
```

在某些情况下可能更可取。

# c++ - 限制模板功能

> ID：148373
> 
> 赞同：16
> 
> 时间：2008-09-29T11:52:12.893
> 
> 标签：c++, templates

[我在http://codepad.org/ko8vVCDF](http://codepad.org/ko8vVCDF)上编写了一个使用模板函数的示例程序。

如何将模板函数限制为仅使用数字？（整数，双等）

```
#include <vector>
#include <iostream>

using namespace std;

    template <typename T>
T sum(vector<T>& a)
{
    T result = 0;
    int size = a.size();
    for(int i = 0; i < size; i++)
    {
        result += a[i];
    }

    return result;
}

int main()
{
    vector<int> int_values;
    int_values.push_back(2);
    int_values.push_back(3);
    cout << "Integer: " << sum(int_values) << endl;

    vector<double> double_values;
    double_values.push_back(1.5);
    double_values.push_back(2.1);
    cout << "Double: " << sum(double_values);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-29T15:17:52.900

这可以通过使用[SFINAE](https://en.wikipedia.org/wiki/Substitution_failure_is_not_an_error)来实现，并且通过使用来自 Boost 或 C++11 的帮助程序更容易

促进：

```
#include <vector>
#include <boost/utility/enable_if.hpp>
#include <boost/type_traits/is_arithmetic.hpp>

template<typename T> 
    typename boost::enable_if<typename boost::is_arithmetic<T>::type, T>::type 
        sum(const std::vector<T>& vec)
{
  typedef typename std::vector<T>::size_type size_type;
  T result;
  size_type size = vec.size();
  for(size_type i = 0; i < size; i++)
  {
    result += vec[i];
  }

  return result;
} 
```

C++11：

```
#include <vector>
#include <type_traits>

template<typename T> 
    typename std::enable_if<std::is_arithmetic<T>::value, T>::type 
        sum(const std::vector<T>& vec)
{
  T result;
  for (auto item : vec)
    result += item;
  return result;
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-29T12:01:06.337

你可以这样做：

```
template <class T>
class NumbersOnly
{
private:
    void ValidateType( int    &i ) const {}
    void ValidateType( long   &l ) const {}
    void ValidateType( double &d ) const {}
    void ValidateType( float  &f ) const {}

public:
    NumbersOnly()
    {
       T valid;
       ValidateType( valid );
    };
}; 
```

如果您尝试创建没有 ValidateType 重载的 NumbersOnly，您将收到错误消息：

```
NumbersOnly<int> justFine;
NumbersOnly<SomeClass> noDeal; 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-29T12:04:13.600

限制模板的唯一方法是使其使用您想要的类型中的某些内容，而其他类型没有。

因此，您使用 int 进行构造，使用 + 和 +=，调用复制构造函数等。

任何具有所有这些特性的类型都可以与您的函数一起使用——所以，如果我创建一个具有这些特性的新类型，您的函数就会在它上面运行——这很棒，不是吗？

如果您想对其进行更多限制，请使用更多仅为您想要的类型定义的函数。

实现这一点的另一种方法是创建一个特征模板——像这样

```
template<class T>
SumTraits
{
public:
  const static bool canUseSum = false;
} 
```

然后将其专门用于您想要的课程：

```
template<>
class SumTraits<int>
{
  public:
    const static bool canUseSum = true;
}; 
```

然后在你的代码中，你可以写

```
if (!SumTraits<T>::canUseSum) {
   // throw something here
} 
```

编辑：如评论中所述，您可以使用 BOOST_STATIC_ASSERT 使其成为编译时检查而不是运行时检查

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-29T12:25:20.070

你就是这样做的。

例如，注释 double 的模板特化。它不允许您使用 double 作为参数调用该函数。诀窍是，如果您尝试使用不属于 的特化的类型调用 sum ，`IsNumber`则调用泛型实现，并且该实现使某些事情不被允许（调用私有构造函数）。

`IsNumber`除非您将类重命名为听起来像错误消息的内容，否则错误消息并不直观。

```
#include <vector>
#include <iostream>

using namespace std;

template<class T> struct IsNumber{ 
 private:
 IsNumber(){}
 };

 template<> struct IsNumber<float>{
   IsNumber(){};
 };

 template<> struct IsNumber<double>{
   IsNumber(){};
 };

 template<> struct IsNumber<int>{
   IsNumber(){};
 };

template <typename T>
T sum(vector<T>& a)
{
 IsNumber<T> test;
 T result = 0;
 int size = a.size();
 for(int i = 0; i < size; i++)
 {
  result += a[i];
 }

 return result;
}

int main()
{
 vector<int> int_values;
 int_values.push_back(2);
 int_values.push_back(3);
 cout << "Integer: " << sum(int_values) << endl;

 vector<double> double_values;
 double_values.push_back(1.5);
 double_values.push_back(2.1);
 cout << "Double: " << sum(double_values);

 return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T11:54:31.063

在这种情况下，为什么要限制类型？模板允许“静态鸭子类型”，因此在这种情况下您的`sum`函数所允许的任何内容都应该被允许。具体来说，唯一需要的操作`T`是添加赋值和初始化为 0，因此任何支持这两个操作的类型都可以工作。这就是模板的美妙之处。

（如果您将初始化程序更改`T result = T();`为等，那么它也适用于数字和字符串。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-29T11:59:40.333

您可以查看类型特征（使用 boost，等待 C++0x 或创建您自己的）。

我在谷歌上找到了以下内容：http: [//artins.org/ben/programming/mactechgrp-artin-cpp-type-traits.pdf](http://artins.org/ben/programming/mactechgrp-artin-cpp-type-traits.pdf)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-29T12:02:55.177

事实上，没有必要让它更严格。在这里查看字符串版本（使用 Chris Jester-Young 建议的默认构造函数样式）[...](http://codepad.org/fMkc0zHx)

也要注意溢出 - 您可能需要更大的类型来包含中间结果（或输出结果）。欢迎来到元编程领域，然后:)

# iis - 漂亮的实时网络跟踪

> ID：148381
> 
> 赞同：2
> 
> 时间：2008-09-29T11:55:55.820
> 
> 标签：iis, logging

我正在寻找一个实时的网络日志观察器，它可以在访问者浏览不同的页面等时直观地显示他们。我希望它是一个网络应用程序，它将显示在办公室的大屏幕上。有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T12:24:31.040

查看 glTail.rb

[http://www.fudgie.org/](http://www.fudgie.org/)该网站也包含了它的运行视频。

这是一款外观精美的应用程序，我强烈推荐它的链接包含它的实际操作视频，在大屏幕上播放它确实是一件很棒的事情。

不是基于网络的，但我认为你会同意它很酷。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-29T12:25:05.077

您可以自己编写一个 - 只需使用服务器端数据库插入跟踪访问者，然后使用 ajax 定期刷新您的信息。

可以在很短的时间内编写一个简单的版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-29T13:35:54.067

有一个名为 EPiServer 的 CMS，它有一个非常好的应用程序，名为 EPiTrace ( [http://r.ep.se/projects/EPiTrace/](http://r.ep.se/projects/EPiTrace/) )，它与我想要的方法类似。此应用程序是开源的，但需要您拥有 CMS 的许可证才能运行它。我希望有一些具有类似方法的商业或开源应用程序。营销人员（他们将在他们的屏幕上显示此内容）对低级数字和协议不是很感兴趣。他们想知道谁在浏览这个网站，他们在哪里，他们去了哪里，等等。他们想以一种“易于理解”的方式实时查看它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T08:42:15.427

this is the easiest and quickest tool for web tracking live... [http://www.realtimevisits.com](http://www.realtimevisits.com)

no fancy stats very simple and effective.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T13:20:00.030

从来没有尝试过其他的，但是当我第一次在[Woopra](http://www.woopra.com/)看到我的网站时，我感到很惊讶。您不仅可以在用户浏览网站时看到他们（他们在哪里、持续了多长时间、他们来自哪里等），而且您甚至可以根据需要与他们交谈（通过会弹出的聊天客户端直接在网站上为您想与之交谈的用户 - 出于明显的原因从未尝试过此选项：D）现在唯一的缺点是您必须等待一段时间才能让您的网站获得批准（该应用程序仍在测试版；或者至少是在我注册我的网站时）。祝你好运！

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-29T12:08:20.797

[振兴](http://www.reinvigorate.net/)是一个很酷的。虽然不是基于网络的应用程序。您在要监控的文件中包含一个 js，并将其报告给他们的服务器，然后您可以下载一个显示每次访问的应用程序。

# asp.net - 如何检查 Asp.Net 请求管道？

> ID：148384
> 
> 赞同：2
> 
> 时间：2008-09-29T11:56:42.183
> 
> 标签：asp.net, iis

当我测量 Asp.Net 应用程序“内部”的请求时间并将其与应用程序“外部”的时间进行比较时，我得到不同的值——不时有 1000-5000 毫秒的奇怪开销。

也许请求正在 IIS 前排队？

或者 HttpModule 中发生了什么奇怪的事情？

问题：有没有办法检查请求管道以准确跟踪应用程序被击中之前花费的时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T13:17:02.940

正如 Dan 所说，您需要在应用程序级别（web.config）启用跟踪：

```
<!-- pageOutput enables trace output from the page itself -->
<system.web>
<trace enabled="true" pageOutput="true" traceMode="SortByTime"/>
</system.web> 
```

或者，您可以在页面级别启用跟踪。这可以通过在 Page 指令中设置 trace = "true" 来完成。

```
<%@ Page Language="C#" Trace="true" 
         Inherits="System.Web.UI.Page" CodeFile="Default.aspx.cs" %> 
```

可以从 http://localhost/appname/trace.axd 查看应用程序级别的跟踪。这将显示请求列表：

![](https://i.stack.imgur.com/HwBF6.png)

当您单击每个页面的详细信息时，您可以看到页面生命周期中每个事件所花费的时间。这应该可以帮助您确定您的页面究竟在哪里花费了超过预期的时间。

[图片来自 http://www.brainbell.com/tutorials/ASP/Built-in_Handlers.html]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T12:10:58.030

您可以创建自己的模块并将其注册到顶部以更准确地跟踪每个请求，但是一旦 IIS 将请求委托给 ASP.NET ISAPI 模块，该措施就会开始。要获得更高的准确性，您可以转到 IIS 日志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T12:41:52.260

您可以在 web.config 文件中打开跟踪。该行应该说类似`<trace enabled="true" pageOutput="true" />`. MSDN 页面在[这里](http://msdn.microsoft.com/en-us/library/6915t83k.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-15T19:04:16.440

您还想尝试[Glimpse](http://getglimpse.com/)。它允许您查看请求管道中的模块以及许多其他信息。

# sql - 总是使用 nvarchar(MAX) 有什么缺点吗？

> ID：148398
> 
> 赞同：364
> 
> 时间：2008-09-29T12:01:11.750
> 
> 标签：sql, sql-server, sql-server-2005

在 SQL Server 2005 中，将所有字符字段设为 nvarchar(MAX) 而不是明确指定长度，例如 nvarchar(255)，是否有任何缺点？（除了您无法在数据库级别限制字段长度的明显问题外）

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2008-09-29T12:25:44.703

在 MSDN 论坛上提出了同样的问题：

*   [Varchar（最大）与 Varchar（255）](https://social.msdn.microsoft.com/Forums/sqlserver/en-US/4d9c6504-496e-45ba-a7a3-ed5bed731fcc/varcharmax-vs-varchar255)

从原始帖子（那里有更多信息）：

> 当您将数据存储到 VARCHAR(N) 列时，这些值的物理存储方式相同。但是，当您将其存储到 VARCHAR(MAX) 列时，屏幕后面的数据将作为 TEXT 值处理。所以在处理 VARCHAR(MAX) 值时需要一些额外的处理。（仅当大小超过 8000 时）
> 
> VARCHAR(MAX) 或 NVARCHAR(MAX) 被视为“大值类型”。大值类型通常存储在“行外”。这意味着数据行将有一个指向另一个存储“大值”的位置的指针......

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-09-29T12:19:33.890

这是一个公平的问题，除了显而易见的问题之外，他确实陈述了......</p>

缺点可能包括：

性能影响查询优化器使用字段大小来确定最有效的执行计划

“1.数据库的extends和pages的空间分配是灵活的。因此，当使用update向字段添加信息时，如果新数据比以前插入的数据长，您的数据库必须创建一个指针。这数据库文件将变得支离破碎 = 几乎所有方面的性能都较低，从索引到删除、更新和插入。” [http://sqlblogcasts.com/blogs/simons/archive/2006/02/28/Why-use-anything-but-varchar_2800_max_2900_.aspx](http://sqlblogcasts.com/blogs/simons/archive/2006/02/28/Why-use-anything-but-varchar_2800_max_2900_.aspx)

集成影响 - 其他系统很难知道如何与您的数据库集成 不可预测的数据增长 可能的安全问题，例如您可能会因占用所有磁盘空间而导致系统崩溃

这里有一篇好文章： [http ://searchsqlserver.techtarget.com/tip/1,289483,sid87_gci1098157,00.html](http://searchsqlserver.techtarget.com/tip/1,289483,sid87_gci1098157,00.html)

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2016-02-03T13:04:14.710

根据接受的答案中提供的链接，看来：

1.  存储在一个字段中的 100 个字符与存储在一个`nvarchar(MAX)`字段中的 100 个字符没有什么不同`nvarchar(100)`- 数据将内联存储，您不会有“行外”读取和写入数据的开销。所以那里不用担心。

2.  如果大小大于 4000，则数据将自动“行外”存储，这正是您想要的。所以也不用担心。

然而...

3.  您不能在`nvarchar(MAX)`列上创建索引。您可以使用全文索引，但不能在列上创建索引来提高查询性能。对我来说，这敲定了交易……总是使用 nvarchar(MAX) 是一个明显的缺点。

结论：

如果你想在整个数据库中使用一种“通用字符串长度”，它可以被索引并且不会浪费空间和访问时间，那么你可以使用`nvarchar(4000)`.

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-06-08T19:33:13.917

有时您希望数据类型对其中的数据强制执行某种意义。

例如，假设您有一列确实不应该超过 20 个字符。如果您将该列定义为 VARCHAR(MAX)，则某些流氓应用程序可能会在其中插入一个长字符串，而您永远不会知道，或者有任何方法可以阻止它。

下次您的应用程序使用该字符串时，假设字符串的长度对于它所代表的域来说是适度且合理的，您将遇到不可预测且令人困惑的结果。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2014-09-30T12:12:39.280

我检查了一些文章并从中找到有用的测试脚本：[http](http://www.sqlservercentral.com/Forums/Topic1480639-1292-1.aspx) ://www.sqlservercentral.com/Forums/Topic1480639-1292-1.aspx 然后将其更改为比较 NVARCHAR(10) 与 NVARCHAR(4000) 与 NVARCHAR(MAX ) 并且在使用指定数字但使用 MAX 时我没有发现速度差异。你可以自己测试。希望这有帮助。

```
SET NOCOUNT ON;

--===== Test Variable Assignment 1,000,000 times using NVARCHAR(10)
DECLARE @SomeString NVARCHAR(10),
        @StartTime DATETIME;
--=====         
 SELECT @startTime = GETDATE();
 SELECT TOP 1000000
        @SomeString = 'ABC'
   FROM master.sys.all_columns ac1,
        master.sys.all_columns ac2;
 SELECT testTime='10', Duration = DATEDIFF(ms,@StartTime,GETDATE());
GO
--===== Test Variable Assignment 1,000,000 times using NVARCHAR(4000)
DECLARE @SomeString NVARCHAR(4000),
        @StartTime DATETIME;
 SELECT @startTime = GETDATE();
 SELECT TOP 1000000
        @SomeString = 'ABC'
   FROM master.sys.all_columns ac1,
        master.sys.all_columns ac2;
 SELECT testTime='4000', Duration = DATEDIFF(ms,@StartTime,GETDATE());
GO
--===== Test Variable Assignment 1,000,000 times using NVARCHAR(MAX)
DECLARE @SomeString NVARCHAR(MAX),
        @StartTime DATETIME;
 SELECT @startTime = GETDATE();
 SELECT TOP 1000000
        @SomeString = 'ABC'
   FROM master.sys.all_columns ac1,
        master.sys.all_columns ac2;
 SELECT testTime='MAX', Duration = DATEDIFF(ms,@StartTime,GETDATE());
GO 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-06-08T19:37:37.043

将其视为另一个安全级别。您可以设计没有外键关系的表 - 完全有效 - 并确保关联实体完全存在于业务层上。但是，外键被认为是良好的设计实践，因为它们添加了另一个约束级别，以防业务层出现问题。字段大小限制和不使用 varchar MAX 也是如此。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-06-08T20:36:18.377

不使用最大或文本字段的一个原因是您无法执行[在线索引重建](http://msdn.microsoft.com/en-us/library/ms188388(SQL.90).aspx)，即 REBUILD WITH ONLINE= ON 即使使用 SQL Server 企业版。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-29T12:11:17.047

我发现的唯一问题是我们在 SQL Server 2005 上开发应用程序，在一种情况下，我们必须支持 SQL Server 2000。我刚刚了解到，**SQL** Server 2000 不喜欢 varchar 的 MAX 选项或nvarchar。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-06-08T19:36:10.633

当您知道该字段将在一个设定范围内时（例如 5 到 10 个字符），这是个坏主意。如果我不确定长度是多少，我想我只会使用 max 。例如，电话号码永远不会超过一定数量的字符。

您能否诚实地说您不确定表中每个字段的大致长度要求？

我确实明白你的意思——有些字段我肯定会考虑使用 varchar(max)。

有趣的是，[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms176089.aspx)总结得很好：

> 当列数据条目的大小变化很大时，请使用 varchar。当列数据条目的大小变化很大并且大小可能超过 8,000 字节时，请使用 varchar(max)。

这里有[一个关于这个问题的有趣讨论](http://bytes.com/groups/asp/619211-will-i-burn-hell-using-all-varchar-max)。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-06-08T20:49:02.767

数据库的工作是存储数据，以供企业使用。使这些数据有用的一部分是确保它是有意义的。允许某人为他们的名字输入无限数量的字符并不能确保有意义的数据。

将这些约束构建到业务层是一个好主意，但这并不能确保数据库保持完整。保证不违反数据规则的唯一方法是在数据库中尽可能低的级别强制执行它们。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-08-29T20:40:14.920

如上所述，它主要是存储和性能之间的权衡。至少在大多数情况下。

但是，在选择 n/varchar(Max) 而不是 n/varchar(n) 时，至少还有一个其他因素需要考虑。数据是否会被索引（例如，姓氏）？由于 MAX 定义被视为 LOB，因此任何定义为 MAX 的内容都不可用于索引。如果没有索引，任何在 WHERE 子句中将数据作为谓词的查找都将被强制进行全表扫描，这是数据查找所能获得的最差性能。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-06-08T19:25:14.183

一个问题是，如果您必须使用多个版本的 SQL Server，MAX 并不总是有效。因此，如果您正在使用遗留数据库或涉及多个版本的任何其他情况，您最好非常小心。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2021-02-16T04:17:51.883

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-04-29T08:05:41.930

1) 在处理 nvarchar(max) 与 nvarchar(n) 时，SQL 服务器将不得不利用更多资源（分配的内存和 cpu 时间），其中 n 是特定于该字段的数字。

2）这对性能意味着什么？

在 SQL Server 2005 上，我从具有 15 个 nvarchar(max) 列的表中查询了 13,000 行数据。我反复对查询进行计时，然后将列更改为 nvarchar(255) 或更少。

优化前的查询平均为 2.0858 秒。更改后的查询平均在 1.90 秒内返回。这比基本的 select * 查询改进了大约 184 毫秒。这是一个 8.8% 的改进。

3) 我的结果与其他几篇文章一致，这些文章表明存在性能差异。根据您的数据库和查询，改进的百分比可能会有所不同。如果您没有很多并发用户或很多记录，那么性能差异对您来说不是问题。但是，性能差异会随着更多记录和并发用户的增加而增加。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-29T12:29:47.437

我有一个 udf 填充字符串并将输出放入 varchar(max)。如果直接使用它而不是为正在调整的列重新转换为适当的大小，则性能非常差。我最终将 udf 设置为带有大注释的任意长度，而不是依赖 udf 的所有调用者将字符串重新转换为更小的大小。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-06-08T19:39:22.813

遗留系统支持。如果您有一个正在使用数据的系统，并且预计它有一定的长度，那么数据库是强制执行该长度的好地方。这并不理想，但遗留系统有时并不理想。=P

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-06-08T19:59:10.400

如果一行中的所有数据（对于所有列）永远不会合理地占用 8000 或更少的字符，那么数据层的设计应该强制执行这一点。

数据库引擎效率更高，可以将所有内容排除在 Blob 存储之外。限制行越小越好。您可以在页面中塞入的行越多越好。当数据库必须访问更少的页面时，它的性能会更好。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-09-30T10:36:43.417

我的测试表明，选择时存在差异。

```
CREATE TABLE t4000 (a NVARCHAR(4000) NULL);

CREATE TABLE tmax (a NVARCHAR(MAX) NULL);

DECLARE @abc4 NVARCHAR(4000) = N'ABC';

INSERT INTO t4000
SELECT TOP 1000000 @abc4
    FROM
    master.sys.all_columns ac1,
    master.sys.all_columns ac2;

DECLARE @abc NVARCHAR(MAX) = N'ABC';

INSERT INTO tmax
SELECT TOP 1000000 @abc
    FROM
    master.sys.all_columns ac1,
    master.sys.all_columns ac2;

SET STATISTICS TIME ON;
SET STATISTICS IO ON;

SELECT * FROM dbo.t4000;
SELECT * FROM dbo.tmax; 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-11-12T17:46:29.757

有趣的链接：[为什么在可以使用 TEXT 时使用 VARCHAR？](http://www.eflorenzano.com/blog/post/why-use-varchar-when-you-can-use-text/)

它是关于 PostgreSQL 和 MySQL 的，所以性能分析是不同的，但“显性”的逻辑仍然成立：为什么要强迫自己总是担心一小部分时间相关的事情？如果您将电子邮件地址保存到变量中，您将使用“字符串”而不是“限制为 80 个字符的字符串”。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-04-17T17:21:02.227

我能看到的主要缺点是，假设你有这个：

哪一个为您提供了有关 UI 所需数据的最多信息？

这

```
 CREATE TABLE [dbo].[BusData](
                [ID] [int] IDENTITY(1,1) NOT NULL,
                [RecordId] [nvarchar](MAX) NULL,
                [CompanyName] [nvarchar](MAX) NOT NULL,
                [FirstName] [nvarchar](MAX) NOT NULL,
                [LastName] [nvarchar](MAX) NOT NULL,
                [ADDRESS] [nvarchar](MAX) NOT NULL,
                [CITY] [nvarchar](MAX) NOT NULL,
                [County] [nvarchar](MAX) NOT NULL,
                [STATE] [nvarchar](MAX) NOT NULL,
                [ZIP] [nvarchar](MAX) NOT NULL,
                [PHONE] [nvarchar](MAX) NOT NULL,
                [COUNTRY] [nvarchar](MAX) NOT NULL,
                [NPA] [nvarchar](MAX) NULL,
                [NXX] [nvarchar](MAX) NULL,
                [XXXX] [nvarchar](MAX) NULL,
                [CurrentRecord] [nvarchar](MAX) NULL,
                [TotalCount] [nvarchar](MAX) NULL,
                [Status] [int] NOT NULL,
                [ChangeDate] [datetime] NOT NULL
            ) ON [PRIMARY] 
```

或这个？

```
 CREATE TABLE [dbo].[BusData](
                [ID] [int] IDENTITY(1,1) NOT NULL,
                [RecordId] [nvarchar](50) NULL,
                [CompanyName] [nvarchar](50) NOT NULL,
                [FirstName] [nvarchar](50) NOT NULL,
                [LastName] [nvarchar](50) NOT NULL,
                [ADDRESS] [nvarchar](50) NOT NULL,
                [CITY] [nvarchar](50) NOT NULL,
                [County] [nvarchar](50) NOT NULL,
                [STATE] [nvarchar](2) NOT NULL,
                [ZIP] [nvarchar](16) NOT NULL,
                [PHONE] [nvarchar](18) NOT NULL,
                [COUNTRY] [nvarchar](50) NOT NULL,
                [NPA] [nvarchar](3) NULL,
                [NXX] [nvarchar](3) NULL,
                [XXXX] [nvarchar](4) NULL,
                [CurrentRecord] [nvarchar](50) NULL,
                [TotalCount] [nvarchar](50) NULL,
                [Status] [int] NOT NULL,
                [ChangeDate] [datetime] NOT NULL
            ) ON [PRIMARY] 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-08-04T16:05:51.343

一个缺点是您将围绕一个不可预测的变量进行设计，并且您可能会忽略而不是利用内部 SQL Server 数据结构，该结构逐渐由 Row(s)、Page(s) 和 Extent(s) 组成。

这让我想到了C 中的[数据结构对齐](http://en.wikipedia.org/wiki/Data_structure_alignment)，并且意识到对齐通常被认为是一件好事（TM）。相似的想法，不同的语境。

[页面和范围](http://msdn.microsoft.com/en-us/library/ms190969%28v=sql.90%29.aspx)的 MSDN 页面

[行溢出数据的](http://msdn.microsoft.com/en-us/library/ms186981%28v=sql.90%29.aspx)MSDN 页面

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-04-14T10:24:22.333

首先我想到了这个，但后来又想到了。存在性能影响，但同样它确实可以作为一种文档形式来了解字段的实际大小。当该数据库位于更大的生态系统中时，它确实会强制执行。在我看来，关键是要宽容，但仅限于合理范围内。

好的，这就是我对业务和数据层逻辑问题的感受。这取决于，如果您的数据库是共享业务逻辑的系统之间的共享资源，那么当然它似乎是执行此类逻辑的自然场所，但它不是最好的方法，最好的方法是提供 API，这允许要测试的交互并将业务逻辑保持在它所属的位置，它保持系统解耦，它保持系统内的层解耦。但是，如果您的数据库应该只为一个应用程序提供服务，那么让我们思考一下 AGILE，现在什么是真的？暂时设计。如果需要此类访问，请为该数据提供 API。

显然，这只是理想情况，如果您使用的是现有系统，则可能至少在短期内需要以不同的方式进行操作。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2008-09-29T12:32:35.527

这将导致性能问题，尽管如果您的数据库很小，它可能永远不会导致任何实际问题。每条记录将占用硬盘驱动器上的更多空间，如果您一次搜索大量记录，数据库将需要读取磁盘的更多扇区。例如，一个小记录可以容纳 50 个扇区，而一个大记录可以容纳 5 个扇区。您需要使用大记录从磁盘读取 10 倍的数据。

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2008-09-29T12:33:03.950

这将使屏幕设计更加困难，因为您将不再能够预测控件的宽度。

# c++ - UTF8 到/从 STL 中的宽字符转换

> ID：148403
> 
> 赞同：79
> 
> 时间：2008-09-29T12:03:23.227
> 
> 标签：c++, unicode, stl, utf-8, character-encoding

是否可以以独立于平台的方式将 std::string 中的 UTF8 字符串转换为 std::wstring ，反之亦然？在 Windows 应用程序中，我将使用 MultiByteToWideChar 和 WideCharToMultiByte。但是，代码是为多个操作系统编译的，我仅限于标准 C++ 库。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-02-11T09:47:17.693

5年前我问过这个问题。当时这个帖子对我很有帮助，我得出了一个结论，然后我继续我的项目。有趣的是，我最近需要类似的东西，与过去的那个项目完全无关。在研究可能的解决方案时，我偶然发现了自己的问题:)

我现在选择的解决方案是基于 C++11 的。[康斯坦丁在他的回答](https://stackoverflow.com/a/148665/22764)中提到的 boost 库现在是标准的一部分。如果我们用新的字符串类型 std::u16string 替换 std::wstring，那么转换将如下所示：

*UTF-8 到 UTF-16*

```
std::string source;
...
std::wstring_convert<std::codecvt_utf8_utf16<char16_t>,char16_t> convert;
std::u16string dest = convert.from_bytes(source); 
```

*UTF-16 到 UTF-8*

```
std::u16string source;
...
std::wstring_convert<std::codecvt_utf8_utf16<char16_t>,char16_t> convert;
std::string dest = convert.to_bytes(source); 
```

从其他答案中可以看出，有多种方法可以解决这个问题。这就是为什么我避免选择一个接受的答案。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-29T14:00:12.337

问题定义明确指出 8 位字符编码为 UTF-8。这使得这是一个微不足道的问题；它所需要的只是从一个 UTF 规范转换为另一个规范。

只需查看这些 Wikipedia 页面上[UTF-8](https://en.wikipedia.org/wiki/Utf-8)、[UTF-16](https://en.wikipedia.org/wiki/Utf-16)和[UTF-32](https://en.wikipedia.org/wiki/UTF-32)的编码。

原理很简单——通过输入并根据一个 UTF 规范组装一个 32 位 Unicode 代码点，然后根据另一个规范发出代码点。单个代码点不需要翻译，就像任何其他字符编码一样；这就是使这个问题变得简单的原因。

这是到 UTF-8 转换的快速实现，`wchar_t`反之亦然。它假设输入已经被正确编码 - 古老的说法“垃圾进，垃圾出”在这里适用。我相信验证编码最好作为一个单独的步骤来完成。

```
std::string wchar_to_UTF8(const wchar_t * in)
{
    std::string out;
    unsigned int codepoint = 0;
    for (in;  *in != 0;  ++in)
    {
        if (*in >= 0xd800 && *in <= 0xdbff)
            codepoint = ((*in - 0xd800) << 10) + 0x10000;
        else
        {
            if (*in >= 0xdc00 && *in <= 0xdfff)
                codepoint |= *in - 0xdc00;
            else
                codepoint = *in;

            if (codepoint <= 0x7f)
                out.append(1, static_cast<char>(codepoint));
            else if (codepoint <= 0x7ff)
            {
                out.append(1, static_cast<char>(0xc0 | ((codepoint >> 6) & 0x1f)));
                out.append(1, static_cast<char>(0x80 | (codepoint & 0x3f)));
            }
            else if (codepoint <= 0xffff)
            {
                out.append(1, static_cast<char>(0xe0 | ((codepoint >> 12) & 0x0f)));
                out.append(1, static_cast<char>(0x80 | ((codepoint >> 6) & 0x3f)));
                out.append(1, static_cast<char>(0x80 | (codepoint & 0x3f)));
            }
            else
            {
                out.append(1, static_cast<char>(0xf0 | ((codepoint >> 18) & 0x07)));
                out.append(1, static_cast<char>(0x80 | ((codepoint >> 12) & 0x3f)));
                out.append(1, static_cast<char>(0x80 | ((codepoint >> 6) & 0x3f)));
                out.append(1, static_cast<char>(0x80 | (codepoint & 0x3f)));
            }
            codepoint = 0;
        }
    }
    return out;
} 
```

上面的代码适用于 UTF-16 和 UTF-32 输入，只是因为范围是无效的代码点`d800`；`dfff`它们表明您正在解码 UTF-16。如果您知道这`wchar_t`是 32 位，那么您可以删除一些代码来优化功能。

```
std::wstring UTF8_to_wchar(const char * in)
{
    std::wstring out;
    unsigned int codepoint;
    while (*in != 0)
    {
        unsigned char ch = static_cast<unsigned char>(*in);
        if (ch <= 0x7f)
            codepoint = ch;
        else if (ch <= 0xbf)
            codepoint = (codepoint << 6) | (ch & 0x3f);
        else if (ch <= 0xdf)
            codepoint = ch & 0x1f;
        else if (ch <= 0xef)
            codepoint = ch & 0x0f;
        else
            codepoint = ch & 0x07;
        ++in;
        if (((*in & 0xc0) != 0x80) && (codepoint <= 0x10ffff))
        {
            if (sizeof(wchar_t) > 2)
                out.append(1, static_cast<wchar_t>(codepoint));
            else if (codepoint > 0xffff)
            {
                out.append(1, static_cast<wchar_t>(0xd800 + (codepoint >> 10)));
                out.append(1, static_cast<wchar_t>(0xdc00 + (codepoint & 0x03ff)));
            }
            else if (codepoint < 0xd800 || codepoint >= 0xe000)
                out.append(1, static_cast<wchar_t>(codepoint));
        }
    }
    return out;
} 
```

同样，如果您知道这`wchar_t`是 32 位，您可以从此函数中删除一些代码，但在这种情况下，它不应该有任何区别。该表达式`sizeof(wchar_t) > 2`在编译时是已知的，因此任何体面的编译器都会识别死代码并将其删除。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-09-29T14:42:30.987

[UTF8-CPP：UTF-8 与 C++ 的可移植方式](https://github.com/nemtrif/utfcpp)

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-09-29T13:36:25.920

您可以[`utf8_codecvt_facet`](http://www.boost.org/doc/libs/1_36_0/libs/serialization/doc/codecvt.html)从[Boost 序列化库](http://www.boost.org/doc/libs/1_36_0/libs/serialization/doc/index.html)中提取。

它们的用法示例：

```
 typedef wchar_t ucs4_t;

  std::locale old_locale;
  std::locale utf8_locale(old_locale,new utf8_codecvt_facet<ucs4_t>);

  // Set a New global locale
  std::locale::global(utf8_locale);

  // Send the UCS-4 data out, converting to UTF-8
  {
    std::wofstream ofs("data.ucd");
    ofs.imbue(utf8_locale);
    std::copy(ucs4_data.begin(),ucs4_data.end(),
          std::ostream_iterator<ucs4_t,ucs4_t>(ofs));
  }

  // Read the UTF-8 data back in, converting to UCS-4 on the way in
  std::vector<ucs4_t> from_file;
  {
    std::wifstream ifs("data.ucd");
    ifs.imbue(utf8_locale);
    ucs4_t item = 0;
    while (ifs >> item) from_file.push_back(item);
  } 
```

在 boost 源中查找`utf8_codecvt_facet.hpp`和文件。`utf8_codecvt_facet.cpp`

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-09-29T13:44:25.917

有几种方法可以做到这一点，但结果取决于`string`和`wstring`变量中的字符编码。

如果你知道`string`是 ASCII，你可以简单地使用`wstring`'s 的迭代器构造函数：

```
string s = "This is surely ASCII.";
wstring w(s.begin(), s.end()); 
```

但是，如果您`string`有其他编码，则会得到非常糟糕的结果。如果编码是 Unicode，您可以查看[ICU 项目](http://www.icu-project.org/)，它提供了一组跨平台的库，可以在各种 Unicode 编码之间进行转换。

如果您`string`在代码页中包含字符，那么 $DEITY 可能会怜悯您的灵魂。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-29T12:07:48.160

您可以使用[`codecvt`语言环境方面](http://en.cppreference.com/w/cpp/locale/codecvt)。定义了一个特定的专业化，`codecvt<wchar_t, char, mbstate_t>`它可能对您有用，尽管它的行为是系统特定的，并且不保证以任何方式转换为 UTF-8。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-06-02T13:09:27.250

为 utf-8 到 utf-16/utf-32 转换创建了我自己的库 - 但决定为此目的对现有项目进行分支。

[https://github.com/tapika/cutf](https://github.com/tapika/cutf)

（源自[https://github.com/noct/cutf](https://github.com/noct/cutf)）

API 适用于纯 C 和 C++。

函数原型如下所示：（完整列表见[https://github.com/tapika/cutf/blob/master/cutf.h](https://github.com/tapika/cutf/blob/master/cutf.h)）

```
//
//  Converts utf-8 string to wide version.
//
//  returns target string length.
//
size_t utf8towchar(const char* s, size_t inSize, wchar_t* out, size_t bufSize);

//
//  Converts wide string to utf-8 string.
//
//  returns filled buffer length (not string length)
//
size_t wchartoutf8(const wchar_t* s, size_t inSize, char* out, size_t outsize);

#ifdef __cplusplus

std::wstring utf8towide(const char* s);
std::wstring utf8towide(const std::string& s);
std::string  widetoutf8(const wchar_t* ws);
std::string  widetoutf8(const std::wstring& ws);

#endif 
```

utf转换测试的示例用法/简单测试应用：

```
#include "cutf.h"

#define ok(statement)                                       \
    if( !(statement) )                                      \
    {                                                       \
        printf("Failed statement: %s\n", #statement);       \
        r = 1;                                              \
    }

int simpleStringTest()
{
    const wchar_t* chineseText = L"主体";
    auto s = widetoutf8(chineseText);
    size_t r = 0;

    printf("simple string test:  ");

    ok( s.length() == 6 );
    uint8_t utf8_array[] = { 0xE4, 0xB8, 0xBB, 0xE4, 0xBD, 0x93 };

    for(int i = 0; i < 6; i++)
        ok(((uint8_t)s[i]) == utf8_array[i]);

    auto ws = utf8towide(s);
    ok(ws.length() == 2);
    ok(ws == chineseText);

    if( r == 0 )
        printf("ok.\n");

    return (int)r;
} 
```

如果这个库不能满足您的需求 - 请随时打开以下链接：

[http://utf8everywhere.org/](http://utf8everywhere.org/)

并在页面末尾向下滚动并选择您喜欢的任何较重的库。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-29T12:16:55.597

我不认为有这样做的便携方式。C++ 不知道其多字节字符的编码。

正如克里斯建议的那样，您最好的选择是使用 codecvt。

# c++ - 为什么下面的代码只在 a = 1 时返回 true？

> ID：148407
> 
> 赞同：13
> 
> 时间：2008-09-29T12:03:51.307
> 
> 标签：c++, conditional

为什么下面的代码只在 a = 1 时返回 true？

```
main(){
int a = 10;
if (true == a)
     cout<<"Why am I not getting executed";
} 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-09-29T12:08:55.383

当 Bool true 转换为 int 时，它始终转换为 1。因此，您的代码等效于：

```
main(){
   int a = 10;
   if (1 == a)
      cout<<"y i am not getting executed";
   } 
```

这是[C++ 标准](http://www.bond.id.au/~gnb/wp/cd2/conv.html)的一部分，因此您希望每个符合 C++ 标准的编译器都会发生这种情况。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-09-29T12:09:08.563

您的打印语句未执行的原因是您的布尔值被隐式转换为数字，而不是相反。即您的 if 语句等效于： if (1 == a)

您可以通过首先将其显式转换为布尔值来解决此问题：

```
main(){
int a = 10;
if (((bool)a) == true)
     cout<<"I am definitely getting executed";
} 
```

在 C/C++ 中，false 表示为 0。

其他一切都表示为非零。有时是 1，有时是其他值。所以你永远不应该测试相等（==）的东西是真的。

相反，您应该测试与错误的东西是否相等。由于 false 只有 1 个有效值。

在这里，我们正在测试所有非假值，其中任何一个都可以：

```
main(){
int a = 10;
if (a)
     cout<<"I am definitely getting executed";
} 
```

第三个例子只是为了证明将任何被认为是假的整数与假（只有0）进行比较是安全的：

```
main(){
int a = 0;
if (0 == false)
     cout<<"I am definitely getting executed";
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-29T12:06:27.930

您的布尔值被提升为整数，并变为 1。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-29T12:12:26.980

在 C 和 C++ 中，0 为假，除零以外的任何值都为真：

```
if ( 0 )
{
// never run
}

if ( 1 )
{
// always run
}

if ( var1 == 1 )
{
// run when var1 is "1"
} 
```

当编译器计算布尔表达式时，它必须产生 0 或 1。此外，还有一些方便的 typedef 和定义，它们允许您在表达式中使用“true”和“false”而不是 1 和 0。

所以你的代码实际上是这样的：

```
main(){
int a = 10;
if (1 == a)
     cout<<"y i am not getting executed";
} 
```

你可能想要：

```
main(){
int a = 10;
if (true == (bool)a)
     cout<<"if you want to explicitly use true/false";
} 
```

或者真的只是：

```
main(){
int a = 10;
if ( a )
     cout<<"usual C++ style";
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-29T12:06:25.187

因为 true 为 1。如果要测试 a 的非零值，只需编写 if(a)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-29T12:27:59.470

我建议你切换到一个警告你这个的编译器......（VC++ 产生这个：警告C4806：'=='：不安全操作：提升为'int'类型的'bool'类型的值不能等于给定的常量；我手头没有另一个编译器。）

我同意 Lou Franco - 你想知道一个变量是否大于零（或不等于它），测试一下。

如果你不知道最后的细节，编译器隐式完成的所有事情都是危险的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T12:35:22.150

这是大多数人编写此类代码的方式：

```
main(){
int a = 10;
if (a) // all non-zero satisfy 'truth'
     cout<<"y i am not getting executed";
} 
```

我也看过：

```
main(){
int a = 10;
if (!!a == true) // ! result is guaranteed to be == true or == false
     cout<<"y i am not getting executed";
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-29T12:07:21.737

我不希望定义该代码，并且您不应该依赖编译器给您的任何行为。可能 true 正在转换为 int (1)，并且 a 没有按照您的预期转换为 bool (true)。最好写出你的意思（a！= 0）然后依赖它（即使它被证明是定义的）。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-29T12:07:22.517

不同于 0 的东西（即假）不一定是真（即 1）

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-09-29T12:07:25.587

因为布尔值在 C/C++ 中有点，true 用 1 表示，false 用 0 表示。

更新：正如评论中所说，我原来的答案是错误的。所以绕过它。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2008-09-29T12:07:38.787

因为 true 等于 1。它是在 pre-proccesor 指令中定义的，所以所有带有 true 的代码在编译之前都会变成 1。

# asp.net - 显示进度时移除按钮

> ID：148421
> 
> 赞同：3
> 
> 时间：2008-09-29T12:08:13.090
> 
> 标签：asp.net, vb.net, ajax

我在 ASP.NET wep 应用程序表单上有一个按钮，单击时会关闭并发布第三方 Web 服务的信息。

我有一个与该按钮关联的 UpdateProgress。

如何在进度可见时禁用/隐藏按钮（即服务器尚未完成操作）

我正在考虑这样做以阻止用户在发送信息时再次点击（因为这会导致发送重复的信息）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T12:15:23.713

您必须将 javascript 方法连接到页面请求管理器 (Sys.WebForms.PageRequestManager.getInstance().add_initializeRequest)。这是我用来隐藏按钮的代码，我更喜欢禁用它们（请参阅底部链接中的操作方式）。

## ASP.NET

```
<div id="ButtonBar">
  <asp:Button id= ............
</div> 
```

## Javascript

```
<script language="javascript">
  // Get a reference to the PageRequestManager.
  var prm = Sys.WebForms.PageRequestManager.getInstance();

  // Using that prm reference, hook _initializeRequest
  // and _endRequest, to run our code at the begin and end
  // of any async postbacks that occur.
  prm.add_initializeRequest(InitializeRequest);
  prm.add_endRequest(EndRequest);

  // Executed anytime an async postback occurs.
  function InitializeRequest(sender, args) 
  {
    $get('ButtonBar').style.visibility = "hidden";
  }

  // Executed when the async postback completes.
  function EndRequest(sender, args) 
  {
    $get('ButtonBar').style.visibility = "visible";
  }
</script> 
```

请参阅[为什么我的 ASP.NET AJAX 表单从未由 Dave Ward 提交两次，以](http://encosia.com/2008/03/04/why-my-aspnet-ajax-forms-are-never-submitted-twice/)了解更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T12:10:40.977

最简单的方法是在整个页面上放置一个半透明的 png - 然后他们不能将事件发送到下面的页面。在我看来，它看起来也不错。

您可以在各种 AJAX 工具包的模态对话框实现和灯箱中看到这种情况。

如果您不喜欢该外观，您只需使其几乎完全透明（完全透明的 alpha 值 1 不明显）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T15:43:27.643

我还写了一篇关于此的博客文章，希望对您有所帮助： [http ://www.fitnessconnections.com/blog/post/2008/01/Disabling-a-submit-button-UpdatePanel-Update-method.aspx](http://www.fitnessconnections.com/blog/post/2008/01/Disabling-a-submit-button-UpdatePanel-Update-method.aspx)

干杯:)

> ID：148441
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# command-line - 如何使用 sed 仅替换文件中的第一个匹配项？

> ID：148451
> 
> 赞同：270
> 
> 时间：2008-09-29T12:22:33.710
> 
> 标签：command-line, sed, text-processing

我想在任何现有的#includes 之前使用额外的include 指令更新大量C++ 源文件。对于这类任务，我通常使用带有 sed 的小型 bash 脚本来重写文件。

如何`sed`只替换文件中第一次出现的字符串而不是替换每次出现的字符串？

如果我使用

```
sed s/#include/#include "newfile.h"\n#include/ 
```

它取代了所有#includes。

也欢迎实现相同目标的替代建议。

* * *

## 回答 #1

> 赞同：342
> 
> 时间：2012-02-26T13:27:07.140

`sed`仅将第一次出现的“Apple”替换为“Banana”的脚本

例子

```
 Input:      Output:

     Apple       Banana
     Apple       Apple
     Orange      Orange
     Apple       Apple 
```

这是简单的脚本：^(编者注：仅适用于*GNU* `sed`。)

```
sed '0,/Apple/{s/Apple/Banana/}' input_filename 
```

前两个参数`0`和`/Apple/`是范围说明符。这`s/Apple/Banana/`是在该范围内执行的内容。因此，在这种情况下，“在开头 ( `0`) 到 的第一个实例的范围内`Apple`，替换`Apple`为`Banana`。只有第一个实例`Apple`会被替换。

背景：在传统`sed`中，范围说明符[也是](https://www.gnu.org/software/sed/manual/html_node/Addresses.html)“从这里开始”和“从这里结束”（包括）。然而，最低的“开始”是第一行（第 1 行），如果“这里的结束”是一个正则表达式，那么它只会尝试匹配“开始”之后的下一行，所以最早可能的结束是行2.因此，由于范围包括在内，最小可能范围是“2 行”，最小起始范围是第 1 行和第 2 行（即，如果第 1 行出现，第 2 行的出现也将改变，在这种情况下不需要）。`GNU`sed 添加了自己的扩展，允许将 start 指定为“伪” `line 0`，以便范围的结尾可以是`line 1`，允许它的范围为“仅第一行”

或简化版本（类似空的 RE`//`表示重复使用之前指定的版本，因此这是等效的）：

```
sed '0,/Apple/{s//Banana/}' input_filename 
```

并且花括号对于命令是[可选](https://www.grymoire.com/Unix/Sed.html#uh-46)`s`的，所以这也是等价的：

```
sed '0,/Apple/s//Banana/' input_filename 
```

所有这些都只在 GNU 上工作`sed`。

您还可以使用 homebrew 在 OS X 上安装 GNU sed `brew install gnu-sed`。

* * *

## 回答 #2

> 赞同：168
> 
> 时间：2008-09-29T12:29:27.737

```
 # sed script to change "foo" to "bar" only on the first occurrence
 1{x;s/^/first/;x;}
 1,/foo/{x;/first/s///;x;s/foo/bar/;}
 #---end of script--- 
```

或者，如果您愿意：^(编者注：仅适用于*GNU* `sed`。)

```
sed '0,/foo/s//bar/' file 
```

[来源](http://www.linuxtopia.org/online_books/linux_tool_guides/the_sed_faq/sedfaq4_004.html)

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2010-08-17T12:30:50.230

```
sed '0,/pattern/s/pattern/replacement/' filename 
```

这对我有用。

例子

```
sed '0,/<Menu>/s/<Menu>/<Menu><Menu>Sub menu<\/Menu>/' try.txt > abc.txt 
```

^(编者注：两者都只适用于*GNU* `sed`。)

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2015-10-29T14:07:39.637

许多有用**的现有答案**的**概述**，并附有**解释**：

 ****^(此处的示例使用简化的用例：仅在第一个匹配行中将单词 'foo' 替换为 'bar'。
由于使用[ANSI C 引用的字符串 ( `$'...'`)](http://www.gnu.org/software/bash/manual/bash.html#ANSI_002dC-Quoting)来提供示例输入行，因此`bash`, `ksh`, 或被`zsh`假定为 shell。)

* * *

***仅限GNU* `sed`：**

[Ben Hoffstein 的回答](https://stackoverflow.com/a/148473/45375)向我们展示了 GNU 为 POSIX 规范提供了一个扩展，[它](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/sed.html)*允许*以下[2-address 形式](https://www.gnu.org/software/sed/manual/html_node/Addresses.html)：（在这里表示任意正则表达式）。[`sed`](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/sed.html)`0,/re/``re`

**`0,/re/`**也允许正则表达式***在第一行*****匹配***。换句话说：这样的地址将创建一个范围，从第一行到匹配的行（包括匹配的行`re`）——无论是`re`出现在第一行还是任何后续行。*

 **   将此与符合 POSIX 的表单进行对比，后者创建了一个从第一行到包括*后续***`1,/re/`**行匹配`re`的行的范围；换句话说：**如果匹配发生在*****第一*****行，这****将不会检测到匹配的第一次出现，**并且还会**阻止使用速记**来重用最近使用的正则表达式（见下一点）。^([1](https://www.gnu.org/software/sed/manual/html_node/Addresses.html))***`re`*****`//`****

 **如果您将`0,/re/`地址与使用*相同*正则表达式的`s/.../.../`（替换）调用结合起来，您的命令将有效地仅在匹配的*第一*行上执行替换。**为重用最近应用的正则表达式**提供了一种方便的快捷方式：***空*****分隔符对，** .**`re`
`sed`*****`//`*******

 *****```
$ sed '0,/foo/ s//bar/' <<<$'1st foo\nUnrelated\n2nd foo\n3rd foo' 
1st bar         # only 1st match of 'foo' replaced
Unrelated
2nd foo
3rd foo 
```

* * *

**仅 POSIX 功能，`sed`例如 BSD (macOS)`sed`**（也可与*GNU* `sed`一起使用）：

由于`0,/re/`不能使用并且表单`1,/re/`不会检测到`re`它是否恰好出现在第一行（见上文），**因此需要对第一行进行特殊处理**。

[MikhailVS 的回答](https://stackoverflow.com/a/11458836/45375)提到了这项技术，在这里举一个具体的例子：

```
$ sed -e '1 s/foo/bar/; t' -e '1,// s//bar/' <<<$'1st foo\nUnrelated\n2nd foo\n3rd foo'
1st bar         # only 1st match of 'foo' replaced
Unrelated
2nd foo
3rd foo 
```

笔记：

*   空的正则表达式`//`快捷方式在这里使用了两次：一次用于范围的端点，一次用于`s`调用；在这两种情况下，正则表达式`foo`都被隐式重用，使我们不必复制它，这使得代码更短且更易于维护。

*   POSIX`sed`在某些函数之后需要实际的换行符，例如在标签的名称之后，甚至在它的省略之后，就像`t`这里的情况一样；策略性地将脚本拆分为多个`-e`选项是使用实际换行符的替代方法：`-e`在通常需要换行符的地方结束每个脚本块。

`1 s/foo/bar/``foo`仅在第一行替换，如果在那里找到。如果是这样，`t`则分支到脚本的末尾（跳过该行上的剩余命令）。（`t`仅当最近的`s`调用执行了实际替换时，该函数才会分支到标签；在没有标签的情况下，就像这里的情况一样，脚本的结尾被分支到）。

发生这种情况时，`1,//`通常*从第 2 行开始*找到第一个匹配项的范围地址将*不*匹配，并且范围将*不会*被处理，因为在当前行已经是时评估地址`2`。

反之，如果第一行没有匹配，`1,//` *就会*被输入，并且会找到真正的第一个匹配。

最终效果与 GNU 相同：仅替换第一次出现，无论它出现在第一行还是其他任何地方`sed`。`0,/re/`

* * *

**非范围方法**

[potong 的回答](https://stackoverflow.com/a/17964220/45375)演示了**绕过 range 需求的*****循环*技术**；因为他使用*GNU*语法，所以这里是符合**POSIX 的等价物**： ***`sed`***

 *****循环技术 1：在第一次匹配时，执行替换，然后**进入一个简单地按原样打印剩余行的循环**：

```
$ sed -e '/foo/ {s//bar/; ' -e ':a' -e '$!{n;ba' -e '};}' <<<$'1st foo\nUnrelated\n2nd foo\n3rd foo'
1st bar
Unrelated
2nd foo
3rd foo 
```

循环技术 2，**仅适用于小文件**：**将整个输入读入内存，然后对其执行一次替换**。

```
$ sed -e ':a' -e '$!{N;ba' -e '}; s/foo/bar/' <<<$'1st foo\nUnrelated\n2nd foo\n3rd foo'
1st bar
Unrelated
2nd foo
3rd foo 
```

* * *

^([1](https://www.gnu.org/software/sed/manual/html_node/Addresses.html) [1.61803](https://stackoverflow.com/users/2167331/1-61803)`1,/re/`提供了使用、 使用和不使用后续会发生什么的示例`s//`：)

*   `sed '1,/foo/ s/foo/bar/' <<<$'1foo\n2foo'`产量`$'1bar\n2bar'`；即，*两*行都已更新，因为行号`1`与第一行匹配，并且正则表达式`/foo/`- 范围的结尾 - 然后仅从*下一*行开始查找。因此，在这种情况下，*两条*`s/foo/bar/`线都被选中，并且对它们都进行了替换。
*   `sed '1,/foo/ s//bar/' <<<$'1foo\n2foo\n3foo'` *失败*：使用`sed: first RE may not be empty`（BSD/macOS）和`sed: -e expression #1, char 0: no previous regular expression`（GNU），因为在处理第一行时（由于行号`1`开始范围），还没有应用正则表达式，所以`//`没有引用任何东西。
    除了 GNU`sed`的特殊`0,/re/`语法外，*任何以**行号*开头的范围都有效地排除了使用`//`.

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2008-09-29T12:29:39.887

您可以使用 awk 做类似的事情..

```
awk '/#include/ && !done { print "#include \"newfile.h\""; done=1;}; 1;' file.c 
```

解释：

```
/#include/ && !done 
```

当行匹配“#include”并且我们尚未处理它时，在 {} 之间运行操作语句。

```
{print "#include \"newfile.h\""; done=1;} 
```

这会打印 #include "newfile.h"，我们需要转义引号。然后我们将 done 变量设置为 1，因此我们不会添加更多包含。

```
1; 
```

这意味着“打印出一行” - 一个空操作默认打印出 $0，它会打印出整行。一个比 sed IMO 更容易理解的衬里 :-)

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2012-07-12T19:03:55.120

[关于linuxtopia sed FAQ](http://www.linuxtopia.org/online_books/linux_tool_guides/the_sed_faq/sedfaq4_004.html)的相当全面的答案集合。它还强调了人们提供的某些答案不适用于非 GNU 版本的 sed，例如

```
sed '0,/RE/s//to_that/' file 
```

在非 GNU 版本中必须是

```
sed -e '1s/RE/to_that/;t' -e '1,/RE/s//to_that/' 
```

但是，此版本不适用于 gnu sed。

这是一个适用于两者的版本：

```
-e '/RE/{s//to_that/;:a' -e '$!N;$!ba' -e '}' 
```

前任：

```
sed -e '/Apple/{s//Banana/;:a' -e '$!N;$!ba' -e '}' filename 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-09-29T12:41:52.137

```
#!/bin/sed -f
1,/^#include/ {
    /^#include/i\
#include "newfile.h"
} 
```

此脚本的工作原理：对于 1 和第一`#include`行（在第 1 行之后）之间的行，如果该行以 开头`#include`，则添加指定的行。

但是，如果第一个`#include`在第 1 行，那么第 1 行和下一个后续`#include`行都将在前面添加该行。如果您使用的是 GNU `sed`，它有一个扩展名`0,/^#include/`（而不是`1,`）会做正确的事情。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-09-29T12:30:36.453

只需在末尾添加出现次数：

```
sed s/#include/#include "newfile.h"\n#include/1 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-09-29T12:38:12.893

一个可能的解决方案：

```
 /#include/!{p;d;}
    i\
    #include "newfile.h"
    :a
    n
    ba 
```

解释：

*   读取行直到我们找到#include，打印这些行然后开始新的循环
*   插入新的包含行
*   进入一个只读取行的循环（默认情况下 sed 也会打印这些行），我们不会从这里回到脚本的第一部分

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2019-02-12T13:16:06.193

使用 GNU sed 的`-z`选项，您可以处理整个文件，就好像它只有一行一样。这样 a`s/…/…/`只会替换整个文件中的第一个匹配项。请记住：`s/…/…/`仅替换每行中的第一个匹配项，但使用该`-z`选项`sed`将整个文件视为单行。

```
sed -z 's/#include/#include "newfile.h"\n#include' 
```

在一般情况下，您必须重写您的 sed 表达式，因为模式空间现在包含整个文件而不是一行。一些例子：

*   `s/text.*//`可以改写为`s/text[^\n]*//`。`[^\n]`匹配*除*换行符以外的所有内容。`[^\n]*`将匹配之后的所有符号，`text`直到到达换行符。
*   `s/^text//`可以改写为`s/(^|\n)text//`。
*   `s/text$//`可以改写为`s/text(\n|$)//`。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2015-05-24T04:32:20.833

我知道这是一篇旧帖子，但我有一个曾经使用过的解决方案：

```
grep -E -m 1 -n 'old' file | sed 's/:.*$//' - | sed 's/$/s\/old\/new\//' - | sed -f - file 
```

基本上使用 grep 打印第一次出现并停在那里。另外打印行号，即`5:line`. 将其导入 sed 并删除 : 以及之后的任何内容，因此您只剩下一个行号。将其通过管道传输到 sed 中，将 s/.*/replace 添加到末尾编号，这会产生一个 1 行脚本，该脚本将通过管道传输到最后一个 sed 以作为文件上的脚本运行。

因此，如果 regex =`#include`和 replace =`blah`并且 grep 发现的第一次出现在第 5 行，那么通过管道传输到最后一个 sed 的数据将是`5s/.*/blah/`.

即使第一次出现在第一行也有效。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-18T02:24:04.540

我会用一个 awk 脚本来做到这一点：

```
BEGIN {i=0}
(i==0) && /#include/ {print "#include \"newfile.h\""; i=1}
{print $0}    
END {} 
```

然后用 awk 运行它：

```
awk -f awkscript headerfile.h > headerfilenew.h 
```

可能很草率，我是新手。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-04-28T12:52:54.713

作为替代建议，您可能需要查看该`ed`命令。

```
man 1 ed

teststr='
#include <stdio.h>
#include <stdlib.h>
#include <inttypes.h>
'

# for in-place file editing use "ed -s file" and replace ",p" with "w"
# cf. http://wiki.bash-hackers.org/howto/edit-ed
cat <<-'EOF' | sed -e 's/^ *//' -e 's/ *$//' | ed -s <(echo "$teststr")
   H
   /# *include/i
   #include "newfile.h"
   .
   ,p
   q
EOF 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-11-17T19:41:53.680

我终于让它在一个 Bash 脚本中工作，该脚本用于在 RSS 提要的每个项目中插入一个唯一的时间戳：

```
 sed "1,/====RSSpermalink====/s/====RSSpermalink====/${nowms}/" \
            production-feed2.xml.tmp2 > production-feed2.xml.tmp.$counter 
```

它仅更改第一次出现。

`${nowms}`是由 Perl 脚本设置的以毫秒为单位的时间，`$counter`是用于脚本内循环控制的计数器，`\`允许在下一行继续执行命令。

读入文件并将标准输出重定向到工作文件。

我理解它的方式`1,/====RSSpermalink====/`是通过设置范围限制告诉 sed 何时停止，然后`s/====RSSpermalink====/${nowms}/`是熟悉的 sed 命令将第一个字符串替换为第二个字符串。

就我而言，我将命令放在双引号中，因为我在带有变量的 Bash 脚本中使用它。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-05-16T10:45:24.420

使用**FreeBSD** `ed`并避免在要处理的文件中`ed`没有语句的情况下出现“不匹配”错误：`include`

```
teststr='
#include <stdio.h>
#include <stdlib.h>
#include <inttypes.h>
'

# using FreeBSD ed
# to avoid ed's "no match" error, see
# *emphasized text*http://codesnippets.joyent.com/posts/show/11917 
cat <<-'EOF' | sed -e 's/^ *//' -e 's/ *$//' | ed -s <(echo "$teststr")
   H
   ,g/# *include/u\
   u\
   i\
   #include "newfile.h"\
   .
   ,p
   q
EOF 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2013-07-31T07:31:24.987

这可能对您有用（GNU sed）：

```
sed -si '/#include/{s//& "newfile.h\n&/;:a;$!{n;ba}}' file1 file2 file.... 
```

或者如果内存不是问题：

```
sed -si ':a;$!{N;ba};s/#include/& "newfile.h\n&/' file1 file2 file... 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2017-07-20T03:43:05.760

如果有人来这里替换所有行中第一次出现的字符（比如我自己），请使用以下命令：

```
sed '/old/s/old/new/1' file

-bash-4.2$ cat file
123a456a789a
12a34a56
a12
-bash-4.2$ sed '/a/s/a/b/1' file
123b456a789a
12b34a56
b12 
```

例如，通过将 1 更改为 2，您可以只替换所有第二个 a。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-10-01T08:00:29.907

用例可能是您的事件分布在整个文件中，但您*知道*您唯一关心的是前 10、20 或 100 行。

然后简单地解决这些问题就可以解决*问题*——即使 OP 的措辞只考虑到第一。

```
sed '1,10s/#include/#include "newfile.h"\n#include/' 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-02-04T09:00:08.507

以下命令删除文件中第一次出现的字符串。它也删除了空行。它显示在 xml 文件中，但它适用于任何文件。

如果您使用 xml 文件并且想要删除标签，这很有用。在此示例中，它删除了第一次出现的“isTag”标签。

命令：

```
sed -e 0,/'<isTag>false<\/isTag>'/{s/'<isTag>false<\/isTag>'//}  -e 's/ *$//' -e  '/^$/d'  source.txt > output.txt 
```

源文件（source.txt）

```
<xml>
    <testdata>
        <canUseUpdate>true</canUseUpdate>
        <isTag>false</isTag>
        <moduleLocations>
            <module>esa_jee6</module>
            <isTag>false</isTag>
        </moduleLocations>
        <node>
            <isTag>false</isTag>
        </node>
    </testdata>
</xml> 
```

结果文件 (output.txt)

```
<xml>
    <testdata>
        <canUseUpdate>true</canUseUpdate>
        <moduleLocations>
            <module>esa_jee6</module>
            <isTag>false</isTag>
        </moduleLocations>
        <node>
            <isTag>false</isTag>
        </node>
    </testdata>
</xml> 
```

ps：它在 Solaris SunOS 5.10（相当旧）上对我不起作用，但它适用于 Linux 2.6，sed 版本 4.1.5

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-01-17T00:37:46.373

没有什么新东西，但也许是更具体的答案：`sed -rn '0,/foo(bar).*/ s%%\1%p'`

示例：`xwininfo -name unity-launcher`产生如下输出：

```
xwininfo: Window id: 0x2200003 "unity-launcher"

  Absolute upper-left X:  -2980
  Absolute upper-left Y:  -198
  Relative upper-left X:  0
  Relative upper-left Y:  0
  Width: 2880
  Height: 98
  Depth: 24
  Visual: 0x21
  Visual Class: TrueColor
  Border width: 0
  Class: InputOutput
  Colormap: 0x20 (installed)
  Bit Gravity State: ForgetGravity
  Window Gravity State: NorthWestGravity
  Backing Store State: NotUseful
  Save Under State: no
  Map State: IsViewable
  Override Redirect State: no
  Corners:  +-2980+-198  -2980+-198  -2980-1900  +-2980-1900
  -geometry 2880x98+-2980+-198 
```

提取窗口 ID`xwininfo -name unity-launcher|sed -rn '0,/^xwininfo: Window id: (0x[0-9a-fA-F]+).*/ s%%\1%p'`产生：

```
0x2200003 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-10-11T05:37:15.870

POSIXly（在 sed 中也有效），只使用**一个**正则表达式，只需要一行内存（像往常一样）：

```
sed '/\(#include\).*/!b;//{h;s//\1 "newfile.h"/;G};:1;n;b1' 
```

解释：

```
sed '
/\(#include\).*/!b          # Only one regex used. On lines not matching
                            # the text  `#include` **yet**,
                            # branch to end, cause the default print. Re-start.
//{                         # On first line matching previous regex.
    h                       # hold the line.
    s//\1 "newfile.h"/      # append ` "newfile.h"` to the `#include` matched.
    G                       # append a newline.
  }                         # end of replacement.
:1                          # Once **one** replacement got done (the first match)
n                           # Loop continually reading a line each time
b1                          # and printing it by default.
'                           # end of sed script. 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-12-03T01:43:04.907

这里一个可能的解决方案可能是告诉编译器包含标头而不在源文件中提及它。在 GCC 中有以下选项：

```
 -include file
       Process file as if "#include "file"" appeared as the first line of
       the primary source file.  However, the first directory searched for
       file is the preprocessor's working directory instead of the
       directory containing the main source file.  If not found there, it
       is searched for in the remainder of the "#include "..."" search
       chain as normal.

       If multiple -include options are given, the files are included in
       the order they appear on the command line.

   -imacros file
       Exactly like -include, except that any output produced by scanning
       file is thrown away.  Macros it defines remain defined.  This
       allows you to acquire all the macros from a header without also
       processing its declarations.

       All files specified by -imacros are processed before all files
       specified by -include. 
```

Microsoft 的编译器具有[/FI](https://docs.microsoft.com/en-us/cpp/build/reference/fi-name-forced-include-file?view=vs-2019)（强制包含）选项。

此功能对于一些常见的标头可能很方便，例如平台配置。Linux 内核的 Makefile`-include`用于此目的。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2020-02-26T09:23:12.037

```
sed -e 's/pattern/REPLACEMENT/1' <INPUTFILE 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2021-09-20T18:52:08.533

我将提出一个不完全是原始问题所要求的建议，但对于那些也想专门替换可能第二次出现的匹配或任何其他具体枚举的正则表达式匹配的人。使用 python 脚本和 for 循环，如果需要，从 bash 脚本中调用它。这对我来说是这样的，我正在替换包含字符串 --project 的特定行：

```
def replace_models(file_path, pixel_model, obj_model):
    # find your file --project matches
    pattern = re.compile(r'--project.*')
    new_file = ""
    with open(file_path, 'r') as f:
        match = 1
        for line in f:
            # Remove line ending before we do replacement
            line = line.strip()
            # replace first --project line match with pixel
            if match == 1:
                result = re.sub(pattern, "--project='" + pixel_model + "'", line)
            # replace second --project line match with object
            elif match == 2:
                result = re.sub(pattern, "--project='" + obj_model + "'", line)
            else:
                result = line
            # Check that a substitution was actually made
            if result is not line:
                # Add a backslash to the replaced line
                result += " \\"
                print("\nReplaced ", line, " with ", result)
                # Increment number of matches found
                match += 1
            # Add the potentially modified line to our new file
            new_file = new_file + result + "\n"
        # close file / save output
        f.close()
    fout = open(file_path, "w")
    fout.write(new_file)
    fout.close() 
```

# java - Java 2D 绘图最佳性能

> ID：148478
> 
> 赞同：34
> 
> 时间：2008-09-29T12:32:30.067
> 
> 标签：java, performance, graphics, java-2d

我正在编写 Java 2D 游戏。我正在使用内置的 Java 2D 绘图库，在我从 JFrame 中的 Canvas 的 BufferStrategy 获得的 Graphics2D 上绘图（有时是全屏的）。BufferStrategy 是双缓冲的。重绘是通过计时器主动完成的。不过，我遇到了一些性能问题，尤其是在 Linux 上。

Java2D 有很多方法可以创建图形缓冲区和绘制图形，我只是不知道自己是否做对了。我一直在尝试 graphics2d.getDeviceConfiguration().createCompatibleVolatileImage，它看起来很有希望，但我没有真正的证据证明如果我将绘图代码切换到它会更快。

根据您的经验，在 Java 1.5+ 中将 2D 图形渲染到屏幕上的最快方法是什么？请注意，该游戏非常领先，因此我不想切换到完全不同的绘图方法，例如 OpenGL 或游戏引擎。我基本上想知道如何以最快的方式使用 Graphics2D 对象将内容绘制到屏幕上。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-14T09:23:12.837

这篇文章的答案、[Consty 的](https://stackoverflow.com/questions/196890/java2d-performance-issues)答案以及我自己的研究的综合：

什么有效：

*   用于`GraphicsConfiguration.createCompatibleImage`创建与您正在绘制的内容兼容的图像。这是绝对必要的！
*   通过 使用双缓冲绘图`Canvas.createBufferStrategy`。
*   在可用的地方使用`-Dsun.java2d.opengl=True`以加快绘图速度。
*   避免使用变换进行缩放。相反，缓存您要使用的图像的缩放版本。
*   避免半透明图像！位掩码图像很好，但在 Java2D 中半透明非常昂贵。

在我的测试中，使用这些方法，我获得了 10 倍到 15 倍的速度提升，使正确的 Java 2D 图形成为可能。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-13T07:23:08.977

我和你有同样的问题，我想。在这里查看我的帖子：

[Java2D 性能问题](https://stackoverflow.com/questions/196890/java2d-performance-issues)

它显示了性能下降的原因以及如何修复它。但不能保证在所有平台上都能正常工作。你会在帖子中看到原因。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-01T11:50:38.310

这里有一些小窍门。如果您更具体并且您正在尝试做什么，我可能会提供更多帮助。听起来像是一场游戏，但我不想假设。

只画你需要的！不要一直盲目地调用 repaint()，尝试一些兄弟姐妹，如 repaint(Rect) 或 repaint(x,y,w,h)。

使用 alpha 混合要非常小心，因为混合图像/基元可能是一项昂贵的操作。

尝试尽可能多地预渲染/缓存。如果您发现自己一遍又一遍地以相同的方式绘制圆，请考虑将其绘制到 BufferedImage 中，然后仅绘制 BufferedImage。您正在为速度而牺牲内存（典型的游戏/高性能图形）

考虑使用 OpenGL，使用 LWJGL 的 JOGL。JOGL 更像 Java，而 LWJGL 在 OpenGL 访问之上提供更多游戏功能。OpenGL 可以比 Swing 绘制数量级（使用适当的硬件和驱动程序）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T19:11:00.203

我认为还有一个尚未提及的重要内容：尽可能缓存所有内容的图像。如果您有一个在屏幕上移动的对象，并且它的外观没有太大变化，请将其绘制到图像上，然后在每一帧的新位置将图像渲染到屏幕上。即使对象是一个非常简单的对象，也要这样做——您可能会惊讶于节省了多少时间。渲染位图比渲染图元快得多。

您可能还想查看显式设置渲染提示，并在质量考虑允许的情况下关闭抗锯齿等功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T12:50:44.563

我已经使用 Java 完成了一些基本的绘图应用程序。我没有做过任何图形密集型的工作，但我建议你好好处理所有的“重绘”调用。对父容器进行额外的重绘调用可能会使您的渲染量翻倍。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-30T14:28:58.687

我一直在看这个问题，希望有人能给你比我更好的答案。

与此同时，我发现了以下[Sun 白皮书](http://www.oracle.com/technetwork/java/perf-graphics-135933.html)，它是在 jdk 1.4 的 beta 版本之后编写的。这里有一些关于微调的有趣建议，包括运行时标志（在文章底部）：

" **Solaris 和 Linux 的运行时标志**

从 SDK 的 Beta 3 版本 1.4 开始，当 DGA 不可用时，Java 2D 默认将图像存储在像素图中，无论您是在本地还是远程显示环境中工作。您可以使用 pmoffscreen 标志覆盖此行为：

-Dsun.java2d.pmoffscreen=true/false

如果将此标志设置为 true，即使 DGA 可用，屏幕外像素图支持也会启用。如果将此标志设置为 false，屏幕外像素图支持将被禁用。**禁用屏幕外像素图支持可以解决一些渲染问题。**"

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T12:37:30.650

确保使用双缓冲，首先绘制到内存中的一个大缓冲区，然后在所有绘制完成后刷新到屏幕。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-29T13:17:21.800

您需要记住几件事

1) is refreshing [this link](http://java.sun.com/docs/books/tutorial/uiswing/misc/timer.html)显示了如何使用swingtimers，这可能是调用重绘的好选择。弄清楚重绘（正如之前的海报所说的那样很重要，所以你不会做太多的工作）。

2）确保您只在一个线程中进行绘图。从多个线程更新 UI 可能会导致令人讨厌的事情。

3) 双缓冲。这使得渲染更平滑。 [这个网站](http://gpwiki.org/index.php/Java:Tutorials:Double_Buffering)有一些更好的信息给你

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-17T05:22:21.263

如果您不想使用纯 Java 2D，另一种选择是使用 GTGE 或 JGame 等游戏库（在 Google 上搜索它们），然后提供对图形的轻松访问，并提供双缓冲和更简单的绘图命令。

# language-agnostic - 可链接方法的优缺点？

> ID：148493
> 
> 赞同：8
> 
> 时间：2008-09-29T12:38:14.437
> 
> 标签：language-agnostic

我真的很喜欢链接方法的哲学，比如库中的[jQuery](http://www.jquery.com) emphasys。我发现它非常优雅和清晰。

作为主要的 Java 开发人员，我一直想知道为什么这种做法在这种语言中没有更多地使用。例如，Collection 接口不是以那种方式设计的（用于添加/删除方法），我觉得这很可悲。

这种做法是否有真正的弊端，还是只是以前没有足够的“性吸引力”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T12:43:28.170

IMO 调试起来很痛苦，因为您往往没有可供检查的中间变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T14:52:25.453

可链接的方法和继承存在一个常见问题。假设您有一个类 C，其方法 F1()、F2() 等返回一个 C。当您从 C 派生类 D 时，您希望方法 F1、F2 等现在返回一个 D，以便 D 的可链接方法可以在链中的任何地方都可以调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T12:41:52.150

我也很喜欢这种方法。我能想到的唯一缺点是，有时在每种方法结束时“返回这个”似乎有点尴尬。例如，对于 JQuery，允许插件有点尴尬，因为你必须说“确保你不要忘记你的回报！！” 但是在编译时没有很好的方法来捕捉它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T12:43:21.337

唯一的缺点是你失去了返回类型，所以链式对于做事情的操作是有益的，但对于计算事情的操作是不利的。

另一个问题是，通过链接编译器不能轻易地确定用于内联的琐碎函数调用。但是正如我所说，如果您的链接执行操作而不是计算，那么编译器很可能无论如何都不会更改任何内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T12:43:23.083

JavaScript（或多或少）是一种函数式语言，具有一等公民的功能。
向对象添加/删除方法，将函数作为参数传递，所有这些对于这种语言来说都是很自然的。

另一方面，Java 是严格的 OO，函数不能存在于类之外。对于这种语言来说，使用继承、组合和接口是一种更自然的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-29T12:57:35.313

可链接方法是我们设计工具包中的另一个很棒的工具。只要确保您不会遇到常见的“我有一把锤子，因此每个问题都是钉子”的设计混乱。

并非每个设计问题都可以通过可链接的方法解决。有时它确实有助于使界面更易于使用（即您提到的收集问题）。有时它不会。诀窍在于找出适用的情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T13:23:29.243

Martin Fowler 在[http://www.martinfowler.com/bliki/FluentInterface.html](http://www.martinfowler.com/bliki/FluentInterface.html)上将此主题称为“流畅的界面” 。一个主要问题是流畅的界面是为人类设计的，因此像 Spring 这样的框架无法理解它们。简单地使用流畅的接口在某种意义上提供了可维护性（可读性），但在另一种意义上失去了可维护性（灵活性）。

# jquery - JQuery Flickr文件上传不起作用

> ID：148503
> 
> 赞同：1
> 
> 时间：2008-09-29T12:42:18.937
> 
> 标签：jquery, forms, flickr

我正在尝试使用 JQuery 将文件上传到 Flickr。我有一个使用表单插件提交的表单（如果我不使用 JQuery 则可以使用）。我的代码如下：

```
<html>

<head>
<title>Test Upload</title>
<script type="text/javascript" src="jquery-1.2.6.js"></script>
<script type="text/javascript" src="jquery.form.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#myForm').bind('submit', function() {
        $(this).ajaxSubmit({
            dataType: 'xml',
            success:  processXml
        });
        return false; // <-- important!
    });
});

function processXml(responseXML) {
    var message = $('message', responseXML).text();
    document.getElementById('output').innerHTML = message;
}

</script>

</head>

<body>

<form id="myForm" method="post" action="http://api.flickr.com/services/upload/" enctype="multipart/form-data">
<input type="file" name="photo" id="photo"/>
<input type="text" name="api_key" id="api_key" value="..snip.."/>
<input type="text" name="auth_token" id="auth_token" value="..snip.."/>
<input type="text" name="api_sig" id="api_sig" value="..snip.."/>
<input type="submit" value="Upload"/>
</form>
<div id="output">AJAX response will replace this content.</div>
</body>

</html> 
```

问题是我得到以下文本作为响应：

```
<rsp stat="fail">

    <err code="100" msg="Invalid API Key (Key not found)" />

</rsp> 
```

即使文件上传没有问题。这意味着我的 div 没有更新，因为它没有运行成功功能。有人有想法么。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T14:45:15.120

请参阅有关使用 AJAX 上传文件的其他线程：

[如何异步上传文件？](https://stackoverflow.com/questions/166221/how-to-upload-file-jquery)

我从未尝试过，但似乎您无法获得服务器响应（无论如何都不容易）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T12:51:02.300

您将无法通过这种方式通过 AJAX 上传文件。

由于 JavaScript 的安全限制，纯 AJAX 文件上传系统是不可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T12:59:37.287

我看到您正在使用**ajaxSubmit**。那是[jQuery 表单插件](http://malsup.com/jquery/form/)，对吧？问题可能与此有关吗？

您是否尝试过使用[jQuery.post](http://docs.jquery.com/Ajax/jQuery.post#urldatacallbacktype)代替？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-25T18:00:21.993

您可以做的是 - 在您的域上使用 proxy.php 文件。使用 ajax 将表单提交到 proxy.php。proxy.php 中的代码将使用 CURL 将表单提交到 flickr。您将在 php.net 或许多其他网站上获得 CURL 代码

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-25T17:56:33.140

ajax 不能跨域工作。您不能使用 ajax 从一个域向另一个域提交表单。

# c++ - 限制 C++ 中值类型的范围

> ID：148511
> 
> 赞同：25
> 
> 时间：2008-09-29T12:43:52.520
> 
> 标签：c++, templates

假设我有一个 LimitedValue 类，它保存一个值，并在 int 类型“min”和“max”上进行参数化。您可以将它用作保存只能在一定范围内的值的容器。你可以这样使用它：

```
LimitedValue< float, 0, 360 > someAngle( 45.0 );
someTrigFunction( someAngle ); 
```

这样“someTrigFunction”就知道保证提供了一个有效的输入（如果参数无效，构造函数将抛出异常）。

但是，复制构造和赋值仅限于完全相同的类型。我希望能够做到：

```
LimitedValue< float, 0, 90 > smallAngle( 45.0 );
LimitedValue< float, 0, 360 > anyAngle( smallAngle ); 
```

并在编译时检查该操作，因此下一个示例给出错误：

```
LimitedValue< float, -90, 0 > negativeAngle( -45.0 );
LimitedValue< float, 0, 360 > postiveAngle( negativeAngle ); // ERROR! 
```

这可能吗？有没有一些实用的方法可以做到这一点，或者有什么例子可以解决这个问题？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-05T18:49:50.440

好的，这是没有 Boost 依赖项的 C++11。

类型系统保证的所有内容都在编译时进行检查，其他任何内容都会引发异常。

我已经添加`unsafe_bounded_cast`了*可能*抛出的转换，以及`safe_bounded_cast`静态正确的显式转换（这是多余的，因为复制构造函数处理它，但提供了对称性和表达性）。

## 示例使用

```
#include "bounded.hpp"

int main()
{
    BoundedValue<int, 0, 5> inner(1);
    BoundedValue<double, 0, 4> outer(2.3);
    BoundedValue<double, -1, +1> overlap(0.0);

    inner = outer; // ok: [0,4] contained in [0,5]

    // overlap = inner;
    // ^ error: static assertion failed: "conversion disallowed from BoundedValue with higher max"

    // overlap = safe_bounded_cast<double, -1, +1>(inner);
    // ^ error: static assertion failed: "conversion disallowed from BoundedValue with higher max"

    overlap = unsafe_bounded_cast<double, -1, +1>(inner);
    // ^ compiles but throws:
    // terminate called after throwing an instance of 'BoundedValueException<int>'
    //   what():  BoundedValueException: !(-1<=2<=1) - BOUNDED_VALUE_ASSERT at bounded.hpp:56
    // Aborted

    inner = 0;
    overlap = unsafe_bounded_cast<double, -1, +1>(inner);
    // ^ ok

    inner = 7;
    // terminate called after throwing an instance of 'BoundedValueException<int>'
    //   what():  BoundedValueException: !(0<=7<=5) - BOUNDED_VALUE_ASSERT at bounded.hpp:75
    // Aborted
} 
```

## 异常支持

这有点样板，但提供了如上所述的相当可读的异常消息（如果您选择捕获派生的异常类型并可以用它做一些有用的事情，那么实际的最小值/最大值/值也会暴露出来）。

```
#include <stdexcept>
#include <sstream>

#define STRINGIZE(x) #x
#define STRINGIFY(x) STRINGIZE( x )

// handling for runtime value errors
#define BOUNDED_VALUE_ASSERT(MIN, MAX, VAL) \
    if ((VAL) < (MIN) || (VAL) > (MAX)) { \
        bounded_value_assert_helper(MIN, MAX, VAL, \
                                    "BOUNDED_VALUE_ASSERT at " \
                                    __FILE__ ":" STRINGIFY(__LINE__)); \
    }

template <typename T>
struct BoundedValueException: public std::range_error
{
    virtual ~BoundedValueException() throw() {}
    BoundedValueException() = delete;
    BoundedValueException(BoundedValueException const &other) = default;
    BoundedValueException(BoundedValueException &&source) = default;

    BoundedValueException(int min, int max, T val, std::string const& message)
        : std::range_error(message), minval_(min), maxval_(max), val_(val)
    {
    }

    int const minval_;
    int const maxval_;
    T const val_;
};

template <typename T> void bounded_value_assert_helper(int min, int max, T val,
                                                       char const *message = NULL)
{
    std::ostringstream oss;
    oss << "BoundedValueException: !("
        << min << "<="
        << val << "<="
        << max << ")";
    if (message) {
        oss << " - " << message;
    }
    throw BoundedValueException<T>(min, max, val, oss.str());
} 
```

## 价值等级

```
template <typename T, int Tmin, int Tmax> class BoundedValue
{
public:
    typedef T value_type;
    enum { min_value=Tmin, max_value=Tmax };
    typedef BoundedValue<value_type, min_value, max_value> SelfType;

    // runtime checking constructor:
    explicit BoundedValue(T runtime_value) : val_(runtime_value) {
        BOUNDED_VALUE_ASSERT(min_value, max_value, runtime_value);
    }
    // compile-time checked constructors:
    BoundedValue(SelfType const& other) : val_(other) {}
    BoundedValue(SelfType &&other) : val_(other) {}

    template <typename otherT, int otherTmin, int otherTmax>
    BoundedValue(BoundedValue<otherT, otherTmin, otherTmax> const &other)
        : val_(other) // will just fail if T, otherT not convertible
    {
        static_assert(otherTmin >= Tmin,
                      "conversion disallowed from BoundedValue with lower min");
        static_assert(otherTmax <= Tmax,
                      "conversion disallowed from BoundedValue with higher max");
    }

    // compile-time checked assignments:
    BoundedValue& operator= (SelfType const& other) { val_ = other.val_; return *this; }

    template <typename otherT, int otherTmin, int otherTmax>
    BoundedValue& operator= (BoundedValue<otherT, otherTmin, otherTmax> const &other) {
        static_assert(otherTmin >= Tmin,
                      "conversion disallowed from BoundedValue with lower min");
        static_assert(otherTmax <= Tmax,
                      "conversion disallowed from BoundedValue with higher max");
        val_ = other; // will just fail if T, otherT not convertible
        return *this;
    }
    // run-time checked assignment:
    BoundedValue& operator= (T const& val) {
        BOUNDED_VALUE_ASSERT(min_value, max_value, val);
        val_ = val;
        return *this;
    }

    operator T const& () const { return val_; }
private:
    value_type val_;
}; 
```

## 演员支持

```
template <typename dstT, int dstMin, int dstMax>
struct BoundedCastHelper
{
    typedef BoundedValue<dstT, dstMin, dstMax> return_type;

    // conversion is checked statically, and always succeeds
    template <typename srcT, int srcMin, int srcMax>
    static return_type convert(BoundedValue<srcT, srcMin, srcMax> const& source)
    {
        return return_type(source);
    }

    // conversion is checked dynamically, and could throw
    template <typename srcT, int srcMin, int srcMax>
    static return_type coerce(BoundedValue<srcT, srcMin, srcMax> const& source)
    {
        return return_type(static_cast<srcT>(source));
    }
};

template <typename dstT, int dstMin, int dstMax,
          typename srcT, int srcMin, int srcMax>
auto safe_bounded_cast(BoundedValue<srcT, srcMin, srcMax> const& source)
    -> BoundedValue<dstT, dstMin, dstMax>
{
    return BoundedCastHelper<dstT, dstMin, dstMax>::convert(source);
}

template <typename dstT, int dstMin, int dstMax,
          typename srcT, int srcMin, int srcMax>
auto unsafe_bounded_cast(BoundedValue<srcT, srcMin, srcMax> const& source)
    -> BoundedValue<dstT, dstMin, dstMax>
{
    return BoundedCastHelper<dstT, dstMin, dstMax>::coerce(source);
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-29T13:00:35.493

您可以使用模板来做到这一点——尝试这样的事情：

```
template< typename T, int min, int max >class LimitedValue {
   template< int min2, int max2 >LimitedValue( const LimitedValue< T, min2, max2 > &other )
   {
   static_assert( min <= min2, "Parameter minimum must be >= this minimum" );
   static_assert( max >= max2, "Parameter maximum must be <= this maximum" );

   // logic
   }
// rest of code
}; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-29T16:36:03.243

[**Boost 约束值库**](http://rk.hekko.pl/constrained_value/)^((1))允许您向数据类型添加约束。

但是，当您喜欢将它与浮点类型一起使用时（如您的示例所示），您必须阅读建议“[为什么 C++ 的浮点类型不应该与有界对象一起使用？ ”。](http://student.agh.edu.pl/~kawulak/constrained_value/constrained_value/rationale.html#constrained_value.rationale.no_floats)

^((1)) Boost 约束值库还不是官方的 Boost 库。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-10-28T11:37:01.013

这实际上是一个复杂的问题，我已经解决了一段时间......

现在我有一个公开可用的库，它允许您在代码中限制浮点数和整数，这样您就可以更加确定它们在任何时候都是有效的。

不仅您可以在最终发布版本中关闭限制，而且这意味着类型几乎与`typedef`.

将您的类型定义为：

```
typedef controlled_vars::limited_fauto_init<float, 0, 360> angle_t; 
```

当你不定义`CONTROLLED_VARS_DEBUG`and`CONTROLLED_VARS_LIMITED`标志时，你得到的和这个几乎一样：

```
typedef float angle_t; 
```

这些类是生成的，因此它们包含**所有**必要的运算符，以便您在使用它们时不会受到太多影响。这意味着您可以将您的`angle_t`几乎视为`float`.

```
angle_t a;
a += 35; 
```

将按预期工作（并抛出 if `a + 35 > 360`）。

[http://snapwebsites.org/project/controlled-vars](http://snapwebsites.org/project/controlled-vars)

我知道这是在 2008 年发布的……但我没有看到任何指向提供此功能的顶级库的好链接！？

* * *

对于那些想要使用这个库的人来说，我注意到在某些情况下，库会默默地调整值的大小（即`float a; double b; a = b;`和`int c; long d; c = d;`），这可能会导致代码中出现各种问题。小心使用图书馆。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-07-30T22:45:29.453

bounded::integer 库可以满足您的需求（仅适用于整数类型）。[http://doublewise.net/c++/bounded/](http://doublewise.net/c++/bounded/)

（为了充分披露，我是这个库的作者）

它与其他试图以显着方式提供“安全整数”的库不同：它跟踪整数边界。我认为这是最好的例子：

```
auto x = bounded::checked_integer<0, 7>(f());
auto y = 7_bi;
auto z = x + y;
// decltype(z) == bounded::checked_integer<7, 14>
static_assert(z >= 7_bi);
static_assert(z <= 14_bi); 
```

x 是介于 0 和 7 之间的整数类型。y 是介于 7 和 7 之间的整数类型。z 是介于 7 和 14 之间的整数类型。所有这些信息在编译时都是已知的，这就是为什么我们能够 static_assert在它上面，即使 z 的值不是编译时常量。

```
z = 10_bi;
z = x;
static_assert(!std::is_assignable<decltype((z)), decltype(0_bi)>::value); 
```

第一个分配 ,`z = 10_bi`未选中。这是因为编译器可以证明`10`落在`z`.

第二个赋值`z = x`检查 的值`x`是否在 的范围内`z`。如果不是，它会抛出一个异常（确切的行为取决于你使用的整数类型，有很多关于做什么的策略）。

第三行，`static_assert`，表明从完全没有重叠的类型进行分配是编译时错误。编译器已经知道这是一个错误并阻止您。

该库不会隐式转换为基础类型，因为这可能会导致您尝试阻止某些事情但由于转换而发生的许多情况。它确实允许显式转换。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-09-10T17:28:29.977

我编写了一个模仿 Ada 的功能的 C++ 类`range`。

它基于模板，类似于此处提供的解决方案。

如果要在实际项目中使用类似的东西，它将以非常基本的方式使用。细微的错误或误解可能是灾难性的。

因此，虽然它是一个没有大量代码的小型库，但在我看来，提供单元测试和清晰的设计理念非常重要。

请随意尝试，如果您发现任何问题，请告诉我。

[https://github.com/alkhimey/ConstrainedTypes](https://github.com/alkhimey/ConstrainedTypes)

[http://www.nihamkin.com/2014/09/05/range-constrained-types-in-c++/](http://www.nihamkin.com/2014/09/05/range-constrained-types-in-c++/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-29T12:53:58.330

目前，由于 C++ 关于如何调用方法（以及扩展的构造函数）的规则，即使使用常量参数也是不可能的。

在 C++0x 标准中，您可以使用 const-expr 来允许产生这样的错误。

（这是假设您希望它仅在实际值非法时才抛出错误。如果范围不匹配，您可以实现这一点）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-29T13:16:18.730

关于模板要记住的一件事是，每次调用一组唯一的模板参数最终都会生成一个“唯一”类，对其进行比较和赋值都会产生编译错误。可能有一些元编程大师可能知道如何解决这个问题，但我不是其中之一。我的方法是在具有运行时检查和重载比较和赋值运算符的类中实现这些。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-29T13:44:06.917

我想为 Kasprzol 的解决方案提供一个替代版本：建议的方法总是使用 int 类型的边界。通过这样的实现，您可以获得更多的灵活性和类型安全性：

```
template<typename T, T min, T max>
class Bounded {
private:
    T _value;
public:
    Bounded(T value) : _value(min) {
        if (value <= max && value >= min) {
            _value = value;
       } else {
           // XXX throw your runtime error/exception...
       }
    }
    Bounded(const Bounded<T, min, max>& b)
        : _value(b._value){ }
}; 
```

这将允许类型检查器捕获明显的未命中分配，例如：

```
Bounded<int, 1, 5> b1(1);
Bounded<int, 1, 4> b2(b1); // <-- won't compile: type mismatch 
```

但是，要检查一个模板实例的范围是否包含在另一个实例的范围内的更高级的关系在 C++ 模板机制中无法表达。

每个有界规范都成为一种新类型。因此编译器可以检查类型不匹配。它无法检查这些类型可能存在的更高级的关系。

# build-automation - nmake 有构建任务吗？

> ID：148513
> 
> 赞同：0
> 
> 时间：2008-09-29T12:44:39.383
> 
> 标签：build-automation, zip, nmake

使用[Ant](http://en.wikipedia.org/wiki/Apache_Ant)，我可以在继续构建之前解压缩档案......这可以使用 nmake 吗？我可以调用外部应用程序吗？甚至是批处理脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T13:11:34.937

make 上的任何变体都能够执行可以从命令行完成的任何任务。实际上，任何 makefile 的大多数构建功能都将依赖于外部进程的调用，例如编译器、链接器、图书馆员等。 make 唯一的缺点是语法有很多变体（nmake、borland make , GNU make 等），这使得编写单个跨平台 makefile 几乎是不可能的。

在回答您的特定问题时，请考虑以下事项：

> ```
> main.cpp：存档.zip
>         解压存档.zip
> 
> ```

这基本上表明 main.cpp 依赖于 archive.zip 并声明可以通过调用“解压缩”命令来满足这种依赖关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T13:04:59.053

您可以从 nmake Makefiles 调用外部应用程序，就像从任何其他 Makefile 调用一样。

然而，该叫什么？您需要安装 WinZip 命令行工具或其他工具，对吗？

我建议看[SCons](http://www.scons.org/)。它是一个很棒的构建引擎，完全支持 Windows 和 MSVC++，并且内置了解压缩功能。

# .net - 如何正则表达式搜索/替换.NET中字符串中的第一次出现？

> ID：148518
> 
> 赞同：30
> 
> 时间：2008-09-29T12:47:22.187
> 
> 标签：.net, regex

似乎 .NET Regex.Replace 方法会自动替换所有匹配项。我可以提供一个 MatchEvaluator 委托，它在第一次替换后返回匹配的字符串，不会呈现任何变化，但这对我来说效率很低。

第一次更换后停止的最有效方法是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-29T12:48:45.007

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.replace.aspx)：

```
Replace(String, String, Int32) 
```

> 在指定的输入字符串中，用指定的替换字符串替换与正则表达式模式匹配的指定最大数量的字符串。

这不是你想要的吗？

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-09-29T13:05:00.817

只是为了回答最初的问题......以下正则表达式仅匹配单词 foo 的第一个实例：

> `(?<!foo.*)foo`

此正则表达式使用否定的lookbehind (?<!) 来确保在匹配之前没有找到 foo 的实例。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-19T15:17:51.250

您可能正在使用静态方法。没有 (String, String, Int32) 重载。首先构造一个正则表达式对象并使用 myRegex.Replace。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-22T06:34:51.833

在这种情况下，您不能使用：

```
string str ="abc546_$defg";
str = Regex.Replace(str,"[^A-Za-z0-9]", ""); 
```

相反，您需要声明新的 Regex 实例并像这样使用它：

```
string str ="abc546_$defg";
Regex regx = new Regex("[^A-Za-z0-9]");
str = regx.Replace(str,"",1) 
```

注意**1**，它表示替换应该发生的次数。

# .net - Entlib 与 ACA.Net - ACA.Net 有什么优势吗？

> ID：148520
> 
> 赞同：2
> 
> 时间：2008-09-29T12:48:08.173
> 
> 标签：.net, frameworks

我的理解是 Entlib 已经从 ACA.Net 中提取并包含了概念。在新的 .net 项目上使用 ACA.Net 有什么意义吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T02:27:10.140

我们正在积极使用我工作的 ACA.NET 4.1。ACA.NET 实际上使用 EntLib 作为其核心，多年来，随着 EntLib 功能的追赶，埃维诺已经“淘汰”了其框架的一部分。

EntLib 没有做的一件事，而 ACA.NET 做得很好的是它在机器边界上使用 Aspects。我知道 EntLib 有策略注入，但这通过操纵本地对象（即服务）的实例化来工作。如果您想使用授权方面保护您的远程服务，那么声明为 ReceiversOnly 容器的 ACA.NET 方面将确保服务在服务运行的地方受到保护。如果您在任何这些服务调用上跨越物理层，ACA.NET 将完成这项工作，EntLib 还没有削减它。

如果您的应用程序不需要部署到多个物理层，那么 ACA.NET 的这种优势就会消失，您可以回退到仅使用 EntLib。

# java - 使用 java 1.4.2_07-b05 在 Tomcat 上具有长类名的 NoClassDefFoundError

> ID：148530
> 
> 赞同：0
> 
> 时间：2008-09-29T12:50:09.247
> 
> 标签：java, tomcat, noclassdeffounderror, classname

我有一个java类：

> it.eng.ancona.view.RuoliView$TabElaborazioneFattureValidazione$ElencoDettaglioElaborazioneFattureValidazione$RigaElencoDettaglioElaborazioneFattureValidazione

多个内部类太长了。

如果我在 Eclipse 上使用 1.4.2_07-b05 并调用这个类，一切都会好起来的。

如果我在 Tomcat 5.0 上使用 1.4.2_07-b05 它会抛出`NoClassDefFoundError`.

我尝试删除类名，之后一切正常。

我在网上搜索过，我发现一个类名的最大长度是 65000，所以长度应该是可以的。并在日食所有作品。

操作系统是 Vista。

有人知道这是一个错误还是其他什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T13:16:08.217

这可能是由 Windows 的最大路径长度引起的。尝试将 Tomcat 服务器移动到 C:\TC 之类的位置，看看是否还有问题。还要检查这个类应该在的罐子里是否真的有它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T13:26:12.153

这不是更多的类路径问题吗？

在 Eclipse 中，很容易获得正确的类路径，因为它管理自己的构建目录。

该类是否在您的 WAR（或自动部署文件夹，或您用来部署到 Tomcat 的任何东西）中？

# c++ - 创建我自己的迭代器

> ID：148540
> 
> 赞同：144
> 
> 时间：2008-09-29T12:54:06.163
> 
> 标签：c++, iterator

我正在努力学习 C++，所以如果这个问题表明缺乏基础知识，请原谅我，你看，事实是，我缺乏基础知识。

我需要一些帮助来解决如何为我创建的类创建迭代器。

我有一个“形状”类，它有一个点容器。我有一个类'Piece'，它引用了一个形状并定义了一个形状的位置。Piece 没有 Shape，它只是引用一个 Shape。

我希望它看起来像 Piece 是一个 Points 容器，它与它引用的 Shape 相同，但添加了 Piece 位置的偏移量。

我希望能够遍历 Piece 的点，就像 Piece 本身就是一个容器一样。我做了一些阅读，并没有找到任何对我有帮助的东西。我将非常感谢任何指示。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-09-29T13:05:40.330

/编辑：我明白了，这里实际上需要一个自己的迭代器（我首先误读了这个问题）。尽管如此，我仍然保留下面的代码，因为它在类似情况下很有用。

* * *

这里真的需要一个自己的迭代器吗？也许将所有必需的定义转发到包含实际点的容器就足够了：

```
// Your class `Piece`
class Piece {
private:
    Shape m_shape;

public:

    typedef std::vector<Point>::iterator iterator;
    typedef std::vector<Point>::const_iterator const_iterator;

    iterator begin() { return m_shape.container.begin(); }

    const_iterator begin() const { return m_shape.container.begin(); }

    iterator end() { return m_shape.container.end(); }

    const_iterator end() const { return m_shape.const_container.end(); }
} 
```

这是假设您在`vector`内部使用 a ，但可以轻松调整类型。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-09-29T15:34:12.457

你应该使用 Boost.Iterators。它包含许多模板和概念，用于为现有的迭代器实现新的迭代器和适配器。我写[了一篇关于这个主题的文章](http://accu.org/index.php/journals/1527)；它在 2008 年 12 月的 ACCU 杂志上。它为您的问题讨论了一个（IMO）优雅的解决方案：使用 Boost.Iterators 从对象公开成员集合。

如果您只想使用 stl，[Josuttis 书中](http://www.josuttis.com/libbook/)有一章介绍如何实现您自己的 STL 迭代器。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-05-08T14:37:05.757

在这里[Designing a STL like Custom Container](http://accu.org/index.php/journals/389)是一篇很棒的文章，它解释了如何设计类似 STL 的容器类及其迭代器类的一些基本概念。反向迭代器（有点难）虽然留作练习:-)

高温下，

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-09-29T13:09:48.277

你可以阅读这篇[ddj 文章](http://www.ddj.com/cpp/184401929)

基本上，从 std::iterator 继承来为您完成大部分工作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-06-01T15:36:56.737

用 C++ 编写自定义迭代器可能非常冗长且难以理解。

由于我找不到编写自定义迭代器的最小方法，所以我编写了这个可能有帮助的[模板头。](https://github.com/VinGarcia/Simple-Iterator-Template/blob/master/README.md)例如，要使`Piece`类可迭代：

```
#include <iostream>
#include <vector>

#include "iterator_tpl.h"

struct Point {
  int x;
  int y;
  Point() {}
  Point(int x, int y) : x(x), y(y) {}
  Point operator+(Point other) const {
    other.x += x;
    other.y += y;
    return other;
  }
};

struct Shape {
  std::vector<Point> vec;
};

struct Piece {
  Shape& shape;
  Point offset;
  Piece(Shape& shape, int x, int y) : shape(shape), offset(x,y) {}

  struct it_state {
    int pos;
    inline void next(const Piece* ref) { ++pos; }
    inline void begin(const Piece* ref) { pos = 0; }
    inline void end(const Piece* ref) { pos = ref->shape.vec.size(); }
    inline Point get(Piece* ref) { return ref->offset + ref->shape.vec[pos]; }
    inline bool cmp(const it_state& s) const { return pos != s.pos; }
  };
  SETUP_ITERATORS(Piece, Point, it_state);
}; 
```

然后您就可以将其用作普通的 STL 容器：

```
int main() {
  Shape shape;
  shape.vec.emplace_back(1,2);
  shape.vec.emplace_back(2,3);
  shape.vec.emplace_back(3,4);

  Piece piece(shape, 1, 1);

  for (Point p : piece) {
    std::cout << p.x << " " << p.y << std::endl;
    // Output:
    // 2 3
    // 3 4
    // 4 5
  }

  return 0;
} 
```

它还允许添加其他类型的迭代器，例如`const_iterator`or `reverse_const_iterator`。

我希望它有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-29T13:06:05.777

您的问题的解决方案不是创建您自己的迭代器，而是使用现有的 STL 容器和迭代器。将每个形状中的点存储在类似矢量的容器中。

```
class Shape {
    private:
    vector <Point> points; 
```

从那时起你做什么取决于你的设计。最好的方法是遍历 Shape 内部方法中的点。

```
for (vector <Point>::iterator i = points.begin(); i != points.end(); ++i)
    /* ... */ 
```

如果您需要访问 Shape 之外的点（这可能是设计缺陷的标志），您可以在 Shape 中创建将返回点的迭代器访问函数的方法（在这种情况下，还要为点容器创建一个公共 typedef）。有关此方法的详细信息，请查看 Konrad Rudolph 的答案。

# msbuild - 使用 MSBuild 在同一解决方案中访问第二个项目

> ID：148556
> 
> 赞同：0
> 
> 时间：2008-09-29T13:03:10.290
> 
> 标签：msbuild

我是 MSBuild 的新手，并且正在学习，因为我需要知道如何做事。目前，我正在使用从 Visual Studio 的 Web 部署项目扩展生成的 MSBuild 文件。我一直在通过创建以下 XML 块的属性来访问和操作直接在我的 Web 项目中的文件：

```
 <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>9.0.21022</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{0B9F9B60-7AD7-49F0-A168-9D4D29FB1A21}</ProjectGuid>
    <SourceWebPhysicalPath>..\ARP_FORMS</SourceWebPhysicalPath>
    <SourceWebProject>{7FCA4A38-0FEE-4D46-82EF-AD0089F9CAA2}|ARP_FORMS\ARP_FORMS.csproj</SourceWebProject>
    <SourceWebVirtualPath>/ARP_FORMS.csproj</SourceWebVirtualPath>
    <TargetFrameworkVersion>v3.5</TargetFrameworkVersion>
  </PropertyGroup> 
```

我需要创建属性来操作我的解决方案中其他项目的其他文件。谁能指出我的正确语法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T02:33:46.287

Sayed Ibrahim Hashimi很好地[回答了这个问题，他提供了示例源代码。](http://www.sedodream.com/PermaLink,guid,ed3a0c98-fdac-4467-9116-5b3bf6755abc.aspx)基本上，您创建一个执行其他 MSBuild 项目的 MSBuild 项目。

# java - 将数据库数据存储在文件中？

> ID：148568
> 
> 赞同：2
> 
> 时间：2008-09-29T13:07:43.180
> 
> 标签：java, database, file

我目前正在用java做一个学校项目，我正在编写一个数据库应用程序。类似于 MySQL Monitor 的东西，您可以在其中输入查询并获取结果/其他内容。

在我之前编写的应用程序中，我使用数据库来存储数据，例如用户配置文件、设置等。现在，很明显，我不能使用数据库来存储从这个学校项目生成的数据，否则有什么意义呢？

我正在考虑将数据存储在文件中，但这是我现在脑子里唯一的想法，而且我有点干涸......老实说，我不想开始敲代码然后我发现一种更好的方法。

因此，如果有人知道如何存储数据（比如 CSV？），或者对数据库应用程序如何在内部工作有一定的了解，请您解释一下？

- 编辑：为了更清楚，我不能使用数据库引擎来存储数据，这样说，我正在编写一个简单的数据库引擎。像 Galwegian、jkramer 和 Joe Skora 这样的想法是我正在寻找的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-29T13:17:52.347

当然，您可以使用文件系统创建自己的数据库，因为这是实际数据库的实现方式。例如，您可以决定将数据存储在固定或可变长度的原始数据文件中，然后创建一个单独的索引文件，其中包含指向该其他文件的文件指针，以便根据您要存储的索引信息类型对任何查询进行快速索引访问在您的索引文件中

所以，是的，看看创建 2 个文件 - 1 个用于存储数据，另一个用于将文件指针存储到该文件中，该文件由您想要提供快速索引访问的任何索引作为键控。

祝你好运——通过我打赌的这个项目，你会学到很多关于数据库构建的知识。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T13:12:37.803

您可能想要使用的是[随机访问文件](http://java.sun.com/docs/books/tutorial/essential/io/rafs.html)。一旦你有一组记录字段，你可以将它们作为一个块写入磁盘。您可以在内存中的磁盘上单独保存索引，并随时直接访问任何记录。希望这能给你足够的开始。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-29T13:13:25.010

我不确定我是否理解您的要求，但“ [SQLite](http://sqlite.org/) ”是否适合您（尽管它仍然是一个数据库引擎，这是您可能首先要避免的，所以我不太确定）？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-29T14:14:13.473

我将创建一个使用二进制表的数据库，每个表一个文件。看看非常方便的 DataInputStream 和 DataOutputStream 类。使用它们，您可以轻松地从二进制文件到 Java 类型来回切换。

我将为表格定义一个简单的结构：一个描述表格内容的标题，然后是行数据。在表头中定义表中的每一列 - 其名称、数据类型和最大长度。把事情简单化。仅使用 DataInput/OutputStream 的功能作为指导处理少数数据类型。使用简单的文件命名约定将表名与文件名相关联。

创建一个包含足够多列的测试表，以至少包含每种数据类型中的一种。然后，通过处理输入文件或通过控制台输入，创建一种用数据填充表的简单方法。最后，创建一个简单的方法来将整个表的内容显示到控制台。

之后，您可以添加一个非常简单的类似 SQL 的方言版本来进行查询。像这样的简单查询：

```
SELECT * FROM EMPLOYEES 
```

...将需要打开包含 EMPLOYEES 表的文件（通过您的表文件名命名约定），解析标题，并读取整个表，返回内容。

在您开始工作后，添加其他功能将很简单，例如处理简单的 WHERE 子句，仅返回符合特定条件的行（或行中的列）。

**如果不需要**这样的通用解决方案（任意数量的表、任意数量的列、实际的查询语言等），您可以简单地将方法添加到您的 API，例如：

```
Employee[] result = EmployeeDataManager.select("LASTNAME", "Smith"); 
```

...或类似的东西。如果你慢慢建立起来，按照我的建议将你的功能分成几个小任务，很快你就会实现你需要的所有功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-29T15:20:26.827

将记录存储在数据文件中的块中的基础已经存在了几十年。显然，一个主题有很多变体，所有这些变体都是为了解决我们拥有慢速磁盘驱动器的事实。

但基本面并不难。将固定长度的列与固定数量的列相结合可以让您非常快速地访问数据库中的任何记录。

从那里开始，一切都是偏移量。

让我们以包含 10 个 32 位整数的简单行为例。单行将是 40 个字节（每个整数 4 个字节 * 10）。如果你想要第 123 行，只需将它乘以 40。123 * 40，给你一个 4920 的偏移量。在数据库文件中寻找那么远，读取 40 个字节，瞧，你的数据库中有一行。

索引存储在 B+-Trees 中，树节点分布在磁盘上的块中。B+Tree 的强大之处在于您可以轻松地在树中找到单个键值，然后简单地遍历叶子节点以键顺序滚动数据。

对于一种有用且流行的简单格式，请考虑查找原始 DBase 格式——DBF 文件。多年来它已经发展了一些，但基础非常简单，有据可查，并且有很多实用程序可以在上面工作。这是一种完美可行的数据库格式，可以处理该问题的所有基本问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-29T13:10:19.713

我想您可以使用 xml 文件做一个非常简单的原则证明“数据库”应用程序，并可能使用 xpath 来查询它。

与数据库相比会非常慢（当然取决于文件大小和硬件），但可以工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-29T13:10:21.880

如果您使用 C#，您可能会考虑编写一个简单的 linq to xml 类型 ORM。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-29T13:11:38.960

您可以使用 YAML 之类的序列化格式，并存储一个哈希数组，其中每个哈希是一个表记录，每个哈希中的键是列名。然后，您可以将序列化文件加载到内存中，使用数组和哈希，然后将所有内容存储回来。

我希望这就是你的意思。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-29T13:14:12.790

您不能使用像[hsqldb](http://hsqldb.org/)这样的基于文件的数据库来存储您的用户设置等吗？这样，您就有了熟悉的数据接口，并能够将其存储在文件系统中。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-09-29T14:11:47.177

StackOverflow 不适用于家庭作业。

话虽如此，这里是一个高效、灵活的数据库的快速而肮脏的方法。

1.  设计一个漂亮的 Map（HashMap、TreeMap 等）来做你想做的事。通常，您将拥有一个包含数据的“记录”类，以及许多有效`Map<String,List<Record>>`集合的“索引”对象。（为什么是记录列表？在一个不太选择性的字段上的索引呢？）

2.  编写一个类来将您的集合序列化为文件。

3.  编写一个类来反序列化文件中的集合。

4.  围绕内存中的 Java 对象编写查询处理或任何内容。

内存数据库。

不喜欢Java的序列化？获取 JSON 或 YAML 库并使用这些格式进行序列化和反序列化。

“但内存数据库无法扩展，”纯粹主义者抱怨道。用 SQLite 解决这个问题，而不是我。我的电脑有 2GB 的 RAM，这是一个相当大的数据库。SQLite 有效。

# c++ - 在 CMake 中使用预编译的头文件

> ID：148570
> 
> 赞同：112
> 
> 时间：2008-09-29T13:08:17.237
> 
> 标签：c++, visual-studio, gcc, cmake, precompiled-headers

我在网上看到了一些（旧）帖子，这些帖子是关于在 CMake 中将一些对预编译头文件的支持结合在一起的。他们似乎都有点到处都是，每个人都有自己的做事方式。目前最好的方法是什么？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-03-23T11:46:22.170

有一个[名为“Cotire”的第三方 CMake 模块](https://github.com/sakra/cotire)，它可以自动为基于 CMake 的构建系统使用预编译的头文件，并且还支持统一构建。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2019-08-29T19:13:17.633

CMake 刚刚获得了对 PCH（预编译头文件）的支持，它应该在即将到来的 3.16 版本中可用，到期时间为 2019 年 10 月 1 日：

[https://gitlab.kitware.com/cmake/cmake/merge_requests/3553](https://gitlab.kitware.com/cmake/cmake/merge_requests/3553)

```
 target_precompile_headers(<target>
    <INTERFACE|PUBLIC|PRIVATE> [header1...]
    [<INTERFACE|PUBLIC|PRIVATE> [header2...] ...]) 
```

正在讨论支持在目标之间共享 PCH：[https ://gitlab.kitware.com/cmake/cmake/issues/19659](https://gitlab.kitware.com/cmake/cmake/issues/19659)

[https://blog.qt.io/blog/2019/08/01/precompiled-headers-and-unity-jumbo-builds-in-upcoming-cmake/](https://blog.qt.io/blog/2019/08/01/precompiled-headers-and-unity-jumbo-builds-in-upcoming-cmake/)提供了一些额外的上下文（动机、数字）

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-09-04T15:46:04.090

我使用以下宏来生成和使用预编译的头文件：

```
MACRO(ADD_MSVC_PRECOMPILED_HEADER PrecompiledHeader PrecompiledSource SourcesVar)
  IF(MSVC)
    GET_FILENAME_COMPONENT(PrecompiledBasename ${PrecompiledHeader} NAME_WE)
    SET(PrecompiledBinary "${CMAKE_CURRENT_BINARY_DIR}/${PrecompiledBasename}.pch")
    SET(Sources ${${SourcesVar}})

    SET_SOURCE_FILES_PROPERTIES(${PrecompiledSource}
                                PROPERTIES COMPILE_FLAGS "/Yc\"${PrecompiledHeader}\" /Fp\"${PrecompiledBinary}\""
                                           OBJECT_OUTPUTS "${PrecompiledBinary}")
    SET_SOURCE_FILES_PROPERTIES(${Sources}
                                PROPERTIES COMPILE_FLAGS "/Yu\"${PrecompiledHeader}\" /FI\"${PrecompiledHeader}\" /Fp\"${PrecompiledBinary}\""
                                           OBJECT_DEPENDS "${PrecompiledBinary}")  
    # Add precompiled header to SourcesVar
    LIST(APPEND ${SourcesVar} ${PrecompiledSource})
  ENDIF(MSVC)
ENDMACRO(ADD_MSVC_PRECOMPILED_HEADER) 
```

假设你有一个包含所有源文件的变量 ${MySources}，你想要使用的代码就是

```
ADD_MSVC_PRECOMPILED_HEADER("precompiled.h" "precompiled.cpp" MySources)
ADD_LIBRARY(MyLibrary ${MySources}) 
```

该代码在非 MSVC 平台上仍然可以正常运行。挺整洁的 ：）

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-11-03T23:47:56.673

这是一个代码片段，允许您为项目使用预编译的标头。将以下内容添加到您的 CMakeLists.txt 替换`myprecompiledheaders`并`myproject_SOURCE_FILES`酌情添加：

```
if (MSVC)

    set_source_files_properties(myprecompiledheaders.cpp
        PROPERTIES
        COMPILE_FLAGS "/Ycmyprecompiledheaders.h"
        )
    foreach( src_file ${myproject_SOURCE_FILES} )
        set_source_files_properties(
            ${src_file}
            PROPERTIES
            COMPILE_FLAGS "/Yumyprecompiledheaders.h"
            )
    endforeach( src_file ${myproject_SOURCE_FILES} )
    list(APPEND myproject_SOURCE_FILES myprecompiledheaders.cpp)
endif (MSVC) 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2010-06-02T09:28:27.277

我最终使用了 larsm 宏的改编版本。将 $(IntDir) 用于 pch 路径可将用于调试和发布构建的预编译头文件分开。

```
MACRO(ADD_MSVC_PRECOMPILED_HEADER PrecompiledHeader PrecompiledSource SourcesVar)
  IF(MSVC)
    GET_FILENAME_COMPONENT(PrecompiledBasename ${PrecompiledHeader} NAME_WE)
    SET(PrecompiledBinary "$(IntDir)/${PrecompiledBasename}.pch")
    SET(Sources ${${SourcesVar}})

    SET_SOURCE_FILES_PROPERTIES(${PrecompiledSource}
                                PROPERTIES COMPILE_FLAGS "/Yc\"${PrecompiledHeader}\" /Fp\"${PrecompiledBinary}\""
                                           OBJECT_OUTPUTS "${PrecompiledBinary}")
    SET_SOURCE_FILES_PROPERTIES(${Sources}
                                PROPERTIES COMPILE_FLAGS "/Yu\"${PrecompiledHeader}\" /FI\"${PrecompiledHeader}\" /Fp\"${PrecompiledBinary}\""
                                           OBJECT_DEPENDS "${PrecompiledBinary}")  
    # Add precompiled header to SourcesVar
    LIST(APPEND ${SourcesVar} ${PrecompiledSource})
  ENDIF(MSVC)
ENDMACRO(ADD_MSVC_PRECOMPILED_HEADER)

ADD_MSVC_PRECOMPILED_HEADER("stdafx.h" "stdafx.cpp" MY_SRCS)
ADD_EXECUTABLE(MyApp ${MY_SRCS}) 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2010-07-09T08:26:42.473

改编自 Dave，但更高效（设置目标属性，而不是针对每个文件）：

```
if (MSVC)
   set_target_properties(abc PROPERTIES COMPILE_FLAGS "/Yustd.h")
   set_source_files_properties(std.cpp PROPERTIES COMPILE_FLAGS "/Ycstd.h")
endif(MSVC) 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-02-02T14:44:04.203

如果您不想重新发明轮子，只需按照最佳答案的建议使用 Cotire 或使用更简单的一个 - **cmake-precompiled-header** [here](https://github.com/larsch/cmake-precompiled-header)。要使用它，只需包含模块并调用：

```
include( cmake-precompiled-header/PrecompiledHeader.cmake )
add_precompiled_header( targetName StdAfx.h FORCEINCLUDE SOURCE_CXX StdAfx.cpp ) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-05-13T17:27:35.520

### 使用 cmake 和 Visual Studio 2015 使用预编译头的示例

“stdafx.h”、“stdafx.cpp” - 预编译头文件名。

将以下内容放入根 cmake 文件中。

```
if (MSVC)
    # For precompiled header.
    # Set 
    # "Precompiled Header" to "Use (/Yu)"
    # "Precompiled Header File" to "stdafx.h"
    set (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /Yustdafx.h /FIstdafx.h")
endif() 
```

* * *

将以下内容放入项目 cmake 文件中。

“src” - 包含源文件的文件夹。

```
set_source_files_properties(src/stdafx.cpp
    PROPERTIES
    COMPILE_FLAGS "/Ycstdafx.h"
) 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-04-16T10:38:18.357

恕我直言，最好的方法是为整个项目设置 PCH，正如 martjno 建议的那样，结合在需要时忽略某些源的 PCH 的能力（例如生成的源）：

```
# set PCH for VS project
function(SET_TARGET_PRECOMPILED_HEADER Target PrecompiledHeader PrecompiledSource)
  if(MSVC)
     SET_TARGET_PROPERTIES(${Target} PROPERTIES COMPILE_FLAGS "/Yu${PrecompiledHeader}")
     set_source_files_properties(${PrecompiledSource} PROPERTIES COMPILE_FLAGS "/Yc${PrecompiledHeader}")
  endif(MSVC)
endfunction(SET_TARGET_PRECOMPILED_HEADER)

# ignore PCH for a specified list of files
function(IGNORE_PRECOMPILED_HEADER SourcesVar)
  if(MSVC)  
    set_source_files_properties(${${SourcesVar}} PROPERTIES COMPILE_FLAGS "/Y-")
  endif(MSVC)
endfunction(IGNORE_PRECOMPILED_HEADER) 
```

因此，如果您有一些目标 MY_TARGET 和生成的源列表 IGNORE_PCH_SRC_LIST，您只需执行以下操作：

```
SET_TARGET_PRECOMPILED_HEADER(MY_TARGET stdafx.h stdafx.cpp)
IGNORE_PRECOMPILED_HEADER(IGNORE_PCH_SRC_LIST) 
```

这种方法经过测试并且效果很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-22T16:03:42.770

好吧，当您每次更改任何项目文件中的一行时，在四核机器上构建需要 10 多分钟，它会告诉您是时候为 Windows 添加预编译头文件了。在 *nux 上，我只会使用 ccache 而不必担心。

我已经在我的主应用程序和它使用的一些库中实现了。在这一点上它工作得很好。还需要一件事是您必须创建 pch 源文件和头文件，并在源文件中包含您想要预编译的所有头文件。我在 MFC 上做了 12 年，但我花了几分钟才想起那件事。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-01-07T08:33:13.220

最干净的方法是将预编译选项添加为全局选项。在 vcxproj 文件中，这将显示为`<PrecompiledHeader>Use</PrecompiledHeader>`，而不是为每个单独的文件执行此操作。

然后您需要将该`Create`选项添加到 StdAfx.cpp。以下是我如何使用它：

```
MACRO(ADD_MSVC_PRECOMPILED_HEADER SourcesVar)
    SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /YuStdAfx.h")
    set_source_files_properties(StdAfx.cpp
        PROPERTIES
        COMPILE_FLAGS "/YcStdAfx.h"
        )
    list(APPEND ${${SourcesVar}} StdAfx.cpp)
ENDMACRO(ADD_MSVC_PRECOMPILED_HEADER)

file(GLOB_RECURSE MYDLL_SRC
    "*.h"
    "*.cpp"
    "*.rc")

ADD_MSVC_PRECOMPILED_HEADER(MYDLL_SRC)
add_library(MyDll SHARED ${MYDLL_SRC}) 
```

这是经过测试并适用于 MSVC 2010 并将创建一个 MyDll.pch 文件，我不介意使用什么文件名，所以我没有努力指定它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-09-08T09:42:35.447

由于预编译头选项不适用于 rc 文件，我需要调整 jari 提供的宏。

```
#######################################################################
# Makro for precompiled header
#######################################################################
MACRO(ADD_MSVC_PRECOMPILED_HEADER PrecompiledHeader PrecompiledSource SourcesVar)
  IF(MSVC)
    GET_FILENAME_COMPONENT(PrecompiledBasename ${PrecompiledHeader} NAME_WE)
    SET(PrecompiledBinary "$(IntDir)/${PrecompiledBasename}.pch")
    SET(Sources ${${SourcesVar}})

    # generate the precompiled header
    SET_SOURCE_FILES_PROPERTIES(${PrecompiledSource}
                                PROPERTIES COMPILE_FLAGS "/Zm500 /Yc\"${PrecompiledHeader}\" /Fp\"${PrecompiledBinary}\""
                                            OBJECT_OUTPUTS "${PrecompiledBinary}")

    # set the usage of this header only to the other files than rc
    FOREACH(fname ${Sources})
        IF ( NOT ${fname} MATCHES ".*rc$" )
            SET_SOURCE_FILES_PROPERTIES(${fname}
                                        PROPERTIES COMPILE_FLAGS "/Zm500 /Yu\"${PrecompiledHeader}\" /FI\"${PrecompiledHeader}\" /Fp\"${PrecompiledBinary}\""
                                                    OBJECT_DEPENDS "${PrecompiledBinary}")
        ENDIF( NOT ${fname} MATCHES ".*rc$" )
    ENDFOREACH(fname)

    # Add precompiled header to SourcesVar
    LIST(APPEND ${SourcesVar} ${PrecompiledSource})
  ENDIF(MSVC)
ENDMACRO(ADD_MSVC_PRECOMPILED_HEADER) 
```

编辑：这个预编译头文件的使用将我的主要项目的总体构建时间从 4 分钟 30 秒减少到 1 分钟 40 秒。这对我来说真的是一件好事。在预编译头文件中只有像 boost/stl/Windows/mfc 这样的头文件。

* * *

## 回答 #13

> 赞同：-15
> 
> 时间：2008-10-07T21:23:58.233

甚至不要去那里。预编译的头文件意味着每当其中一个头文件发生变化时，您都必须重新构建*所有内容*。如果你有一个能够实现这一点的构建系统，你就很幸运了。通常情况下，您的构建会失败，直到您意识到您更改了正在预编译的内容，因此您需要进行完全重建。你可以通过预编译你绝对肯定不会改变的头文件来避免这种情况，但是你也放弃了大部分的速度增益。

另一个问题是，您的命名空间被各种您不知道或不关心的符号污染，在许多您将使用预编译头文件的地方。

# emacs - 使用 emacs tramp 与 rsync 进行远程开发

> ID：148578
> 
> 赞同：12
> 
> 时间：2008-09-29T13:10:15.093
> 
> 标签：emacs, rsync, tramp

我一直在使用 emacs tramp 进行一些远程开发，发现它很慢。每次我保存一个文件，大约需要 10 秒才能完成保存。所以，现在我正在使用 rsync 远程传输文件，它的工作速度要快得多，大约需要一秒钟，而且来自 emacs 的本地保存是即时的。tramp 中是否有任何配置选项可以让它像 rsync 在命令行上一样快地运行？即使我看到性能如此糟糕，使用 tramp 而不是 rsync 有什么好处吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-29T13:59:03.557

虽然 tramp 可以配置为使用大量传输方法，但我想您正在使用 ssh 连接到远程服务器。

我相信完成操作所需的大部分时间来自建立连接和身份验证。如果您使用的是足够新的 OpenSSH 版本，则可以使用连接共享功能来帮助您，请参阅 ssh_config(5) 中的 ControlMaster。

我建议你试试

`ControlMaster auto`

看看这是否能改善情况。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-29T13:48:15.253

如果您将 tramp 用于 ssh/scp 功能，您会发现打开一个持久的 SSH 连接将使 tramp 操作更快：它们将重用现有连接而不是每次都创建一个新连接，从而减少很多在不影响安全性的情况下减少加密开销。请参阅这篇关于 SSH [ControlMaster](http://www.linux.com/articles/54498)功能的文章。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-19T00:52:14.993

有几个答案提到使**ControlMaster**能够保持*持久*的ssh 连接打开（这避免了昂贵的连接设置/握手，否则每次通过 ssh 的 Tramp 操作都需要），但您不需要在 Emacs 之外配置任何东西使用它——如果你查看`tramp-methods`变量，你会看到现有的方法可以启用 ControlMaster。

具体来说，`rsyncc`和`scpc`方法。

当然，连接的双方都需要支持 ControlMaster（例如 Cygwin 不能这样做，这对 Windows 用户来说是一种耻辱*），但我建议将其中一个设置为您的`tramp-default-method`.

没有持久连接会使扩展 Tramp 的使用变得非常痛苦，但有了它就非常有用（到了这样的程度，如果连接速度相当快，你几乎可以忘记它正在发生）。

在回答您问题的最后一部分时，是的，有很好的理由使用 Tramp 而不是手动同步文件。第一个是shell命令可以直接在远程服务器上执行，你甚至不必考虑它，因为Emacs会处理细节。

例如，从远程文件缓冲区中，`M-x` `shell` `RET`在远程服务器上打开一个 shell，以及类似的命令`M-x` `rgrep` `RET`将`M-x` `find-grep-dired` `RET`在远程服务器上运行 find + grep。我相信这通常适用于调用 shell 命令的函数。

对我来说，使用 Tramp 的理由绰绰有余（除非在远程服务器上安装 Emacs 并使用本地显示器是一种选择，在这种情况下，为了长期使用，我会考虑这样做）。

(*) 使用 Windows 时，我曾经在本地托管 Linux VM 并在其中运行 Emacs（Cygwin 提供 X 显示），*唯一*的原因是使用 ControlMaster for Tramp ( [https://stackoverflow.com/a/3049375/324105](https://stackoverflow.com/a/3049375/324105)）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-29T13:49:24.767

您是否知道 gnu.org 上的 tramp 文档中提到使用 rsync 的部分？它部分说：

> 5.3 外部传输方式
> 
> 外部传输方法通过多个通道运行，使用远程外壳连接进行许多操作，同时将文件传输委托给外部传输实用程序。
> 
> 这节省了使用内联方法通过一个连接进行多路传输的编码和解码开销。
> 
> ...
> 
> rsync — ssh 和 rsync 使用 ssh 命令安全连接到远程机器和使用 rsync 命令传输文件几乎与 scp 方法相同。
> 
> ```
> While rsync performs much better than scp when transferring files that 
> exist on both hosts, this advantage is lost if the file exists only on one side 
> of the connection.
> 
> The rsync based method may be considerably faster than the rcp based
> methods when writing to the remote system. Reading files to the local
> machine is no faster than with a direct copy.
> 
> This method supports the ‘-p’ hack. 
> ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-17T23:09:42.307

由于您之前说过您在特定服务器上遇到问题，因此请检查问题机器上的 sshd 配置文件。它可能类似于 /etc/ssh/sshd_config。

查找名为“UseDNS”的配置选项。将其设置为“否”。

看看这是否不会为您加快速度。如果是这样，那么 ssh 可能会在等待您可能不关心的反向 dns 查找时超时。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-18T11:56:29.833

最近我开始接受 sshfs，以便远程文件可以在本地编辑。适用于 Linux、Mac 和 Unix 系统，并将 ssh 部分放在一个命令中，而不是每次访问。并且完全存在于用户空间中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-18T23:56:02.557

如果您使用的是 ssh 方法，则可以尝试使用 sftp 方法，它（我相信）会打开与远程 ssh 服务器的持久 sftp 连接。此外，如果您使用的是 GNOME，您可以添加`sftp`以`tramp-gvfs-methods`使 TRAMP 使用 GNOME 的 GVFS 连接到 sftp 服务器，这可能会更快/更方便，也可能不会。

# .net - 有没有人写过一个线程安全的 BindingList ?

> ID：148587
> 
> 赞同：1
> 
> 时间：2008-09-29T13:11:40.363
> 
> 标签：.net, multithreading, thread-safety, bindinglist

我目前在多个线程上修改 IBindingList 时遇到异常。在我自己编写之前，有人有线程安全版本吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T13:28:46.517

我想你会发现这是一项非常困难的任务。更简单的方法是使用以下命令防止多线程访问`lock`：

```
void AddItemToList(object o)
{
    lock(myBindingList)
    {
        myBindingList.Add(o);
    }
} 
```

查看[lock 语句文档](http://msdn.microsoft.com/en-us/library/c5kehkcz.aspx)以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T23:21:25.467

才发现这个帖子……你的意思[是这样](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/msg/f12a3c5980567f06)吗？

# .net - .NET 计时器：在 X 秒内收到通知的最佳方式是什么？

> ID：148594
> 
> 赞同：5
> 
> 时间：2008-09-29T13:12:54.777
> 
> 标签：.net, asynchronous, timer

假设我有一个需要在 X 秒后引发的非重复事件，例如超时。直观地说，创建一个 System.Timers.Timer，将其间隔设置为 X*1000，将其刻度线连接到事件并启动它是有意义的。由于这是一个非重复事件，并且您只希望它在一次触发后才被触发，然后您必须在计时器计时结束后停止它。

然而，如果这确实是最好的方法，定时器本质上是重复的，这让我不信任。保存开始的时间会更好/更准确/更安全吗，将计时器设置为每秒（甚至毫秒）滴答，并在滴答时轮询系统时间并仅在必要时间过去后手动引发目标事件？

任何人都可以权衡哪种方法最好（也许我也没有想到另一种选择）。如果我需要等待的时间跨度以毫秒为单位，那么一种方法会变得比另一种更好吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-29T13:31:21.393

System.Threading.Timer 的这个[构造函数](http://msdn.microsoft.com/en-us/library/ah1h85ch.aspx)允许您指定一个**句**点。如果将此参数设置为 -1，它将禁用周期性信号并且只执行一次。

```
public Timer(
    TimerCallback callback,
    Object state,
    TimeSpan dueTime,
    TimeSpan period
) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-29T13:15:00.497

只需使用普通计时器并在它过去一次后将其禁用。那应该可以解决您的问题。

system.threading.timer 和 system.timers.timer 都支持这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-29T13:16:59.197

分拆一个新的 BackgroundWorker，休眠，关闭。

```
var worker = new BackgroundWorker();
worker.DoWork += delegate {
  Thread.Sleep(30000); 
  DoStuff();
} 
worker.RunWorkerAsync(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T21:10:42.443

您可以使用具有 AutoReset = true 的 System.Timers.Timer 或具有无限周期 (System.Threading.Timeout.Infinite = -1) 的 System.Threading.Timer 来执行一次计时器。

在任何一种情况下，如果您没有重复间隔，您都应该在完成后处理您的计时器（在 Timers.Timer 的事件处理程序或 Threading.Timer 的回调中）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T13:23:50.897

只需将其设置为在 X 秒后打勾，然后在打勾的代码中执行以下操作：

timer.enabled = false;

为我工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-29T14:02:46.967

如果您想要一个准确的时间度量，您应该考虑将计时器频率加倍并使用 DateTime.Now 与您的开始时间进行比较。Timers 和 Thread.Sleep 的时间测量不一定准确。

# java - 从 Apache Velocity 模板访问常量值？

> ID：148601
> 
> 赞同：15
> 
> 时间：2008-09-29T13:14:32.760
> 
> 标签：java, velocity

是否可以从 Velocity 模板访问常量值（即在 Java 类中定义的公共静态最终变量）？

我希望能够写出这样的东西：

```
#if ($a lt Long.MAX_VALUE) 
```

但这显然不是正确的语法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-17T22:11:44.610

有很多方法。

1）您可以将值直接放在上下文中。

2) 您可以使用[FieldMethodizer](http://velocity.apache.org/engine/devel/apidocs/org/apache/velocity/app/FieldMethodizer.html)使类中的所有公共静态字段可用。

3) 您可以使用在查找顺序中包含公共静态字段的自定义 Uberspect 实现。

4) 您可以使用 VelocityTools 的[FieldTool](http://velocity.apache.org/tools/devel/javadoc/org/apache/velocity/tools/generic/FieldTool.html)。

我推荐 1 用于一些值，2 用于一些类，3 用于大量类和值，如果您已经在使用 VelocityTools 并且将使用 1 或 2，则建议使用 4。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-29T13:31:43.263

Velocity 只能使用它在其上下文中找到的任何东西，例如

```
context.put("MaxLong", Long.MAX_VALUE); 
```

由于 Velocity 的查找工作方式，您不能在 Velocity 的上下文中使用静态或访问事物的静态成员（请参阅 Velocity 的[属性查找规则](http://velocity.apache.org/engine/devel/user-guide.html#propertylookuprules)）。最好的办法是在上下文中明确添加要检查的值。

* * *

**重新编辑 10 月 6**日，似乎可以访问静态成员。有关更多信息，请参阅velocity [Developer guide - Support for "Static Classes"](http://velocity.apache.org/engine/devel/developer-guide.html#supportforstaticclasses)。不过，我还没有尝试过。

# sharepoint - 将 MediaWiki 站点迁移到 Windows Sharepoint Services Wiki

> ID：148619
> 
> 赞同：6
> 
> 时间：2008-09-29T13:19:53.667
> 
> 标签：sharepoint, migration, wiki, mediawiki

有人找到将 MediaWiki 页面迁移到 WSS Wiki 的方法吗？我们刚刚安装了 Sharepoint 2007，虽然它似乎满足了我们的需求，但它似乎不是 Microsoft 提供的将 MediaWiki 页面迁移到 WSS wiki 的任何工具。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T07:41:54.463

创建 aspx 文件并在源代码中添加 wikipage 库页面的模板，然后迁移为 sharepoint 2007 或 2010 的 Wikipage 库

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T23:47:15.953

微软目前没有提供这样的工具。

[虽然SharePoint Community Kit](http://blogs.msdn.com/sharepoint/archive/2007/06/18/community-kit-for-sharepoint-2-0-pre-release-announcement.aspx)中正在开发一个。

> **维基导入/导出工具**
> 
> EWE 团队正处于为 SharePoint wiki 设计导入/导出工具的早期阶段。该工具的目标是能够从其他 wiki 产品（例如 FlexWiki、MediaWiki 和 TWiki 和 Confluence）以及 Word 和 OneNote 导入，以及通过 HTML（每页）和 MHTML（整个 wiki）导出到 Word ) 格式。
> 
> 对于这个 CKS 2.0 预发行版，EWE 团队正在提供一个相当稳定的 FlexWiki 导入工具版本，其源代码由 SharePoint 产品组的开发人员 Michael Cheng 慷慨捐赠。这是一个一次性工具，最终将转换为 Wiki Import/Export Tool 的插件，因此如果您当前正在使用 FlexWiki，请测试该工具并提供反馈。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T10:49:15.300

我已经设法让 Twiki 进入 SharePoint。最大的问题是以编程方式在 SharePoint 中创建主题/页面。我在这里记录了我的发现：[sites.google.com/site/sharepointwikiuploader](http://sites.google.com/site/sharepointwikiuploader/) 可能会节省一些时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-20T12:30:15.410

为此有一个商业工具：[Metalogix Migration Manager for Blogs and Wikis](http://www.metalogix.net/Products/Migration-Manager-for-Blogs-and-Wikis/)

还没有测试过，但是当我测试时会发布我的经验。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-18T22:45:11.550

我创建了一个 php 脚本，它读取由 Mediawiki 的 dumpBackup.php 创建的 xml 文件并转储出适合粘贴到新 Sharepoint wiki 页面的文本。我将它发布在一个[谷歌代码项目](http://code.google.com/p/wiki-to-sharepoint/)中。结合Grant Traynor 的方法，这可以解决问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-05-07T15:22:24.727

您不能指望这些导入的页面具有远程相似的功能。请参阅[http://wikiworks.com/enterprise-mediawiki-vs-sharepoint.html](http://wikiworks.com/enterprise-mediawiki-vs-sharepoint.html)，了解您可能要重新考虑这种迁移的原因。您将失去 1\. 可靠的无限版本控制和存档 2\. 轻松的多作者编辑 3\. mediawiki 扩展的所有功能，最后计数超过 2000 个。

在某些业务中，例如保险、律师事务所或会计，损失 1\. 可能会产生法律影响。

但是，如果您的意图是简单地使在 MediaWiki 中维护的页面在 SharePoint 中可见，那么您可以通过将 SharePoint 配置为在 mediawiki 中搜索来做到这一点 - 由 StackExchange 上的其他一些问题解决。

# svn - 如何使用 Subversion 获得主-主复制？

> ID：148625
> 
> 赞同：13
> 
> 时间：2008-09-29T13:21:35.737
> 
> 标签：svn, replication, git-svn

似乎是一个简单的问题：

*   我的防火墙内有一个 SVN 存储库。
*   我在防火墙外有一个 SVN 存储库。
*   我在防火墙内外都有用户。（没有VPN不是一个选项:(那太容易了）
*   防火墙内的机器可以与外部 SVN 服务器通信。但不是相反。
*   外部的 SVN 是暂时的——主要的 repo 总是在里面。

我想以某种方式（从内部，很可能）将所有更改合并到一个中，并将它们应用于另一个。反之亦然。听起来很简单，我假设喜欢的 GIT 可以做到这一点，但我们使用的是 SVN。

有人做过吗？我不介意这是一个手动过程——只有几个外部人员，他们不需要即时更新，一天两到三次就可以了。

我相信 apache.org 会这样做，但我找不到关于他们如何做到这一点的文档。有几种产品可以做到这一点（嗯，一个），但我很想知道是否有人有一种没有它们的好、干净的方法来做到这一点。svnsync 这样做，只是在一个方向（主从）

很高兴它可以在 Windows、Linux 或 Mac 上运行，因为我们拥有所有这些。不过，Windows 和 Mac 是首选。

帮助！:) :)

[更新] 经过 12 个月的混乱（最终不需要这个），在我看来，正确的答案是正确的。使用 git - 有一个从 SVN-A 提取的 repo，然后推送到一个新的 git repo，然后从那里推送到 SVN-B。应该管用 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-29T13:55:44.080

我推荐[SVK](http://svk.bestpractical.com/view/HomePage)或[git-svn](http://git-scm.com/docs/git-svn)。

这两者都允许您创建 svn 存储库的外部镜像，并允许外部开发人员直接提交到外部镜像。然后，您可以将此外部镜像中的更改拉取并推送到您的内部主存储库。

git-svn 会（我认为）要求外部开发人员使用 git。我更喜欢它，但我不愿意把它强加给其他人。

然而，SVK 允许外部开发人员继续使用 svn。由于内部存储库只能在内部访问，因此内部帐户或用户必须处理定期同步（cron 作业可能会起作用）。

这是 SVK wiki 上的扩展操作指南：[UsingSVKAsARepositoryMirroringSystem](http://svk.bestpractical.com/view/UsingSVKAsARepositoryMirroringSystem)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T13:26:39.983

简单通常是最好的方法，听起来您已经有了一个简单的解决方案：在防火墙外使用 SVN 存储库。

您已经说过防火墙内的机器可以访问它，显然外部的机器可以访问它......所以每个人都是如此，那么您有什么理由在防火墙内建立第二个 SVN 存储库？如果只是作为备份，那么只需备份外面的那个。

如果我缺少您的部分要求，请告诉我。

另一个想法……如果您同时拥有内部和外部 SVN 实例……有什么办法可以阻止它们同时出于不同的目的给出相同的变更列表 ID？如果您正在寻求去中心化的解决方案，您应该关注[GIT](http://git.or.cz/)而不是 SVN。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-11T16:05:28.143

VisualSVN 服务器企业版的功能之一是多*​​站点存储库复制*，它完全符合您的要求。

该功能基于 VisualSVN 分布式文件系统 (VDFS) 技术，该技术旨在实现跨地理分布站点的透明 Subversion 存储库复制。VDFS 的一些显着特点：

*   所有分布式 VDFS Subversion 存储库都是可写的，
*   VDFS 支持透明的双向数据复制，
*   VDFS 支持复制授权规则和高级身份验证机制，例如具有安全 SSL/TLS 加密的集成 Windows 身份验证 (NTLM/Negotiate)。
*   所有 VDFS 存储库都包含相同的数据集，
*   使用 VDFS 的 WAN 上的存储库复制比基于直写代理的复制快 10 倍，
*   VDFS 配置通过图形界面完成，无需任何复杂步骤。

值得注意的是，VDFS 遵循经典的*主从复制模型，相比**主*从复制模型具有显着优势，因为它更适合复制具有 FSFS fs 类型后端的 Subversion 存储库。VDFS 技术比 SVN 的主从复制解决方案可靠得多。

*   [VisualSVN 服务器 | 多站点存储库配置](https://www.visualsvn.com/server/features/multisite-replication/)，
*   [将 VDFS 与主-主复制解决方案进行比较](https://www.visualsvn.com/support/topic/00084/)。

![多站点 Apache SVN 存储库的 VDFS 配置界面](https://i.stack.imgur.com/DYV43.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T13:38:38.693

嗯……我认为，保持两个 repos 彼此同步并非易事。它基本上涉及将 SVN 转换为 Mercurial 或 Git。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-03T19:03:34.323

最无缝和可扩展的解决方案是使用 svnsync 的主/从复制，在 Subversion 书中描述：[http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.serverconfig.httpd。 extra.writethruproxy](http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.serverconfig.httpd.extra.writethruproxy)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-29T13:27:43.710

您可以尝试的一件事是在文件级别复制 repo。我正在使用 FolderShare ( [http://www.foldershare.com](http://www.foldershare.com) - 在 Windows 和 Mac 上运行) 用于类似的场景，尽管我只是出于备份目的复制它并且没有尝试使用 SVN 连接到副本。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-09-24T19:44:59.410

[http://wandisco.com/subversion/multisite/](http://wandisco.com/subversion/multisite/)

> Subversion MultiSite 利用 WANdisco 独特的复制技术来立即同步通过广域网 (WAN) 连接的 Subversion 存储库。每个位置的用户都可以体验到局域网 (LAN) 读写操作的速度性能。Subversion MultiSite 还提供连续热备份和自我修复功能，可自动进行灾难恢复，从而几乎消除了停机时间。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-09-16T07:17:36.517

如果您正在搜索有关使用 svnsync 进行主/从复制的分步说明，请按照[http://lasanthals.blogspot.com/2012/09/main-steps-of-configuring-svn_4.html](http://lasanthals.blogspot.com/2012/09/main-steps-of-configuring-svn_4.html)

# eclipse - 自定义 AntRunner 输出

> ID：148641
> 
> 赞同：1
> 
> 时间：2008-09-29T13:29:20.947
> 
> 标签：eclipse, ant, eclipse-pde, antrunner

我正在使用 Eclipse 的 AntRunner 构建一组插件，但在配置日志记录行为时遇到了麻烦。具体来说，我希望 AntRunner 不显示空任务。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T14:29:05.733

解决方案是传递以下 JVM 选项：

```
java -jar ... -logger org.apache.tools.ant.NoBannerLogger 
```

# c# - 在 OpenFileDialog 中过滤文件的正则表达式

> ID：148642
> 
> 赞同：3
> 
> 时间：2008-09-29T13:29:28.060
> 
> 标签：c#, regex, winforms

我想知道如何根据正则表达式在打开的文件对话框（在 winforms 中）中过滤文件。文件具有所有相同的扩展名 (.xml)。大文件被分成几个同名的文件，只用_1分隔......我们只想显示没有_1的文件（第一个数据文件）

打开文件对话框有一个属性过滤器，但我不知道如何以我们的文件名格式指定它，因此是正则表达式。

谢谢，尼基

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T13:36:12.287

**我不认为你可以**使用 OpenFileDialog 的 Filter 属性来做到这一点，它只是根据扩展名过滤文件列表。

我认为你必须让用户选择一个 xml 文件，如果它是 _1 文件，则验证然后再次弹出对话框。您可以在此验证中订阅 FileOK 事件和插槽。您可以在此处使用正则表达式来验证文件名。这是可以做到的最好的..我猜。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T00:48:36.973

本[CodeProject 文章中描述的 OpenFileDialogEx](http://www.codeproject.com/KB/dialog/OpenFileDialogEx.aspx?msg=3063147#xx3063147xx)是标准 OpenFileDialog 的扩展。该扩展的主要目的是修改对话框的显示，但还有一些额外的花里胡哨。例如，OFDEx 添加了一些事件，用于文件更改、文件夹更改等。

有人指出，CDN_INCLUDEITEM 通知似乎可以满足过滤对话框中显示的文件列表的愿望。似乎会，但事实并非如此。CDN_INCLUDEITEM 不会做您可能想或想要的事情。

根据[这篇 MSDN Mag 文章](http://msdn.microsoft.com/en-us/magazine/cc300464.aspx)，

> 如果您使用 OFN_ENABLEINCLUDENOTIFY 创建对话框，Windows 会针对它添加到打开列表的每个项目向您的挂钩过程发送 CDN_INCLUDEITEM 通知。如果您返回 FALSE，Windows 将排除该项目。**问题是，Windows 不会通知您普通文件，只会通知您命名空间扩展等伪对象。**当您通过放大镜阅读文档时，打印内容非常清晰：“对话框始终包含同时具有 SFGAO_FILESYSTEM 和 SFGAO_FILESYSANCESTOR 属性的项目，无论 CDN_INCLUDEITEM 返回的值如何。” 显然，Redmondtonians 出于自己的目的添加了 CDN_INCLUDEITEM，其中不包括过滤普通文件名。

换句话说，在响应 CDN_INCLUDEITEM 时，您不能为常规文件返回 FALSE，以将它们从对话框中排除。与文档相反，CDN_INCLUDEITEM 的响应对于常规文件会被忽略，根据我的经验，CDN_INCLUDEITEM*甚至不会*针对常规文件发送，至少在我的 Vista 机器上不会发送。

那么是否可以动态排除文件？嗯，是的，在 C++ 中；响应 CDN_FOLDERCHANGED 消息，您可以获取和设置包含文件的 CListCtrl 的内容。我还没有弄清楚如何在 C# 中设置这个列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-03T11:21:55.900

OpenFileDialog 不支持这一点。另一种方法是使用像[FileView](http://www.ssware.com/fileview/fileview.htm)这样的第 3 方控件，它允许您使用您希望的任何条件（例如正则表达式）过滤项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T03:34:26.857

您应该可以使用以下过滤器执行此操作：Data Files|*_1.xml

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-03T15:20:36.550

我不确定如何在 C# 中使用 WinForms，但在 C++ 中，您要做的是安装自定义挂钩程序并监听 CDN_INCLUDEITEM 通知。然后，根据您的正则表达式检查每个文件名。看[http://msdn.microsoft.com/en-us/library/ms646960(VS.85).aspx#_win32_Filters](http://msdn.microsoft.com/en-us/library/ms646960(VS.85).aspx#_win32_Filters)。

# sql-server - Oracle：是否有跟踪查询的工具，例如 Profiler for sql server？

> ID：148648
> 
> 赞同：91
> 
> 时间：2008-09-29T13:31:19.037
> 
> 标签：sql-server, oracle, profiler

我使用 sql server，但我必须迁移到使用 Oracle DB 的应用程序。为了跟踪我的应用程序查询，我在 Sql Server 中使用了很棒的 Profiler 工具。甲骨文有类似的东西吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-06-02T07:22:18.860

我找到了一个简单的解决方案

步骤1。使用 PLSQL 或 sqldeveloper 或任何其他查询接口与管理员用户连接到数据库

第2步。运行下面的脚本；在 S.SQL_TEXT 列中，您将看到已执行的查询

```
SELECT            
 S.LAST_ACTIVE_TIME,     
 S.MODULE,
 S.SQL_FULLTEXT, 
 S.SQL_PROFILE,
 S.EXECUTIONS,
 S.LAST_LOAD_TIME,
 S.PARSING_USER_ID,
 S.SERVICE                                                                       
FROM
 SYS.V_$SQL S, 
 SYS.ALL_USERS U
WHERE
 S.PARSING_USER_ID=U.USER_ID 
 AND UPPER(U.USERNAME) IN ('oracle user name here')   
ORDER BY TO_DATE(S.LAST_LOAD_TIME, 'YYYY-MM-DD/HH24:MI:SS') desc; 
```

唯一的问题是我找不到显示输入参数值的方法（用于函数调用），但至少我们可以在不使用特定工具的情况下查看 Oracle 中运行的内容及其顺序。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-29T14:40:35.750

您可以使用 Oracle 企业管理器来监视活动会话、正在执行的查询、其执行计划、锁、一些统计信息，甚至是较长任务的进度条。

请参阅：http: [//download.oracle.com/docs/cd/B10501_01/em.920/a96674/db_admin.htm#1013955](http://download.oracle.com/docs/cd/B10501_01/em.920/a96674/db_admin.htm#1013955)

转到实例 -> 会话并查看每个会话的 SQL 选项卡。

还有其他方法。企业经理只是用漂亮的颜色把已经在特殊视图中可用的东西放在这里记录的那些： [http ://www.oracle.com/pls/db92/db92.catalog_views?remark=homepage](http://www.oracle.com/pls/db92/db92.catalog_views?remark=homepage)

当然，您还可以使用 Explain PLAN FOR、TRACE 工具和大量其他工具化方式。企业管理器中有一些关于最昂贵的 SQL 查询的报告。您还可以搜索保存在缓存中的最近查询。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-04-11T01:54:32.623

```
alter system set timed_statistics=true 
```

- 或者

```
alter session set timed_statistics=true --if want to trace your own session 
```

-- 必须足够大：

```
select value from v$parameter p
where name='max_dump_file_size' 
```

-- 找出您感兴趣的会话的 sid 和序列号：

```
 select sid, serial# from v$session
 where ...your_search_params... 
```

-- 可以从 10046 事件开始跟踪，第四个参数设置跟踪级别（12 为最大）：

```
 begin
    sys.dbms_system.set_ev(sid, serial#, 10046, 12, '');
 end; 
```

--通过设置零级别关闭跟踪：

```
begin
   sys.dbms_system.set_ev(sid, serial#, 10046, 0, '');
end; 
```

/*可能的级别：0 - 关闭 1 - 最低级别。很像 set sql_trace=true 4 - 将绑定变量值添加到跟踪文件 8 - 添加等待 12 - 添加绑定变量值和等待事件 */

--same 如果你想用更大的级别跟踪你自己的会话：

```
alter session set events '10046 trace name context forever, level 12'; 
```

- 关掉：

```
alter session set events '10046 trace name context off'; 
```

--带有原始跟踪信息的文件将位于：

```
 select value from v$parameter p
 where name='user_dump_dest' 
```

-- 文件名(*.trc) 将包含 spid：

```
 select p.spid from v$session s, v$process p
 where s.paddr=p.addr
 and ...your_search_params... 
```

--也可以自己设置名称：

```
alter session set tracefile_identifier='UniqueString'; 
```

--finally，用于`TKPROF`使跟踪文件更具可读性：

```
C:\ORACLE\admin\databaseSID\udump>
C:\ORACLE\admin\databaseSID\udump>tkprof my_trace_file.trc output=my_file.prf
TKPROF: Release 9.2.0.1.0 - Production on Wed Sep 22 18:05:00 2004
Copyright (c) 1982, 2002, Oracle Corporation. All rights reserved.
C:\ORACLE\admin\databaseSID\udump> 
```

--查看跟踪文件使用的状态：

```
set serveroutput on size 30000;
declare
  ALevel binary_integer;
begin
  SYS.DBMS_SYSTEM.Read_Ev(10046, ALevel);
  if ALevel = 0 then
    DBMS_OUTPUT.Put_Line('sql_trace is off');
  else
    DBMS_OUTPUT.Put_Line('sql_trace is on');
  end if;
end;
/ 
```

只是有点翻译[http://www.sql.ru/faq/faq_topic.aspx?fid=389](http://www.sql.ru/faq/faq_topic.aspx?fid=389)原文更完整，但无论如何这比其他人发布的恕我直言

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-07-01T19:30:23.170

[GI Oracle Profiler v1.2](http://www.iacosoft.com/home/tools.asp#PROFILER)

它是一种用于 Oracle 的工具，用于捕获类似于 SQL Server Profiler 执行的查询。用于维护使用此数据库服务器的应用程序的不可或缺的工具。

您可以从官方网站 iacosoft.com 下载它

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-10-29T13:58:14.130

试试 PL/SQL Developer，它对分析器有一个很好的用户友好的 GUI 界面。试一试很不错。在处理 Oracle 数据库时，我对这个工具发誓。

[http://www.allroundautomations.com/plsqldev.html?gclid=CM6pz8e04p0CFQjyDAodNXqPDw](http://www.allroundautomations.com/plsqldev.html?gclid=CM6pz8e04p0CFQjyDAodNXqPDw)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-09-14T11:21:55.753

看到我刚刚将最近的一个问题投票为重复并指出了这个方向。. .

更多 - 在 SQL*Plus - SET AUTOTRACE ON - 将为每个执行的语句提供解释计划和统计信息。

TOAD 还允许进行客户端分析。

这两者的缺点是它们只告诉您语句的执行计划，而不是优化器如何到达该计划 - 因为您将需要较低级别的服务器端跟踪。

另一个需要理解的重要内容是 Statspack 快照——它们是查看整个数据库性能的好方法。解释计划等，擅长发现个别的 SQL 语句是瓶颈。Statspack 擅长识别您的问题是一个具有良好执行计划的简单语句在一分钟内被调用 100 万次这一事实。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-03-13T06:58:24.720

Catch 是捕获两个时间点之间运行的所有 SQL。就像 SQL Server 一样。

在某些情况下，捕获特定用户在数据库中运行的 SQL 很有用。通常您只需为该用户启用会话跟踪，但该方法存在两个潜在问题。

1.  首先是许多基于 Web 的应用程序维护一个在多个用户之间共享的持久数据库连接池。
2.  第二个是一些应用程序连接、运行一些 SQL 和断开连接非常快，这使得完全启用会话跟踪变得很棘手（在这种情况下，您当然可以使用登录触发器来启用会话跟踪）。

该问题的一个快速而肮脏的解决方案是捕获在两个时间点之间运行的所有 SQL 语句。

以下过程将创建两个表，每个表都包含数据库在特定点的快照。然后将查询这些表以生成在此期间运行的所有 SQL 的列表。

如果可能，您应该在安静的开发系统上执行此操作 - 否则您可能会获取太多数据。

1.  拍摄第一个快照 运行以下 sql 创建第一个快照：

    ```
    create table sql_exec_before as
    select executions,hash_value
    from v$sqlarea
    / 
    ```

2.  让用户在应用程序中执行他们的任务。

3.  拍摄第二张快照。

    ```
    create table sql_exec_after as
    select executions, hash_value
    from v$sqlarea
    / 
    ```

4.  检查结果 现在您已经捕获了 SQL，是时候查询结果了。

第一个查询将列出所有已执行的查询哈希：

```
select  aft.hash_value
from sql_exec_after aft
left outer join sql_exec_before bef
  on aft.hash_value  =  bef.hash_value 
where aft.executions > bef.executions
   or bef.executions is null;
/ 
```

这将显示哈希和 SQL 本身： set pages 999 lines 100 break on hash_value

```
select  hash_value, sql_text
from    v$sqltext
where   hash_value in (
    select  aft.hash_value
    from sql_exec_after aft
    left outer join sql_exec_before bef
      on aft.hash_value  =  bef.hash_value
    where aft.executions > bef.executions
       or bef.executions is null;
)
order by
    hash_value, piece
/ 
```

5\. 整理完成后不要忘记删除快照表：

```
drop table sql_exec_before
/

drop table sql_exec_after
/ 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-29T13:43:48.633

Oracle 与其他数据库一起分析给定查询以创建执行计划。此计划是检索数据的最有效方式。

Oracle 提供了 ' `explain plan`' 语句，它分析查询但不运行它，而是填充一个您可以查询的特殊表（计划表）。

语法（简单版本，还有其他选项，例如使用特殊 ID 标记计划表中的行，或使用不同的计划表）是：

```
explain plan for <sql query> 
```

该数据的分析留给另一个问题或您的进一步研究。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-09-16T08:13:09.053

有一个商业工具[FlexTracer](http://www.easymatica.com/flextracer/)可用于跟踪 Oracle SQL 查询

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-04-22T14:25:57.873

Apparently there is no small simple cheap utility that would help performing this task. There is however 101 way to do it in a complicated and inconvenient manner.

Following article describes several. There are probably dozens more... [http://www.petefinnigan.com/ramblings/how_to_set_trace.htm](http://www.petefinnigan.com/ramblings/how_to_set_trace.htm)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-29T13:46:32.260

这是一个 Oracle 文档，解释如何跟踪 SQL 查询，包括几个工具（SQL Trace 和 tkprof）

[关联](http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/sqltrace.htm#sthref2019)

# c# - 用另一个列表更新一个列表所需的最少代码量是多少？

> ID：148662
> 
> 赞同：2
> 
> 时间：2008-09-29T13:35:31.773
> 
> 标签：c#, generics, merge, generic-list

假设我有一个列表：

```
IList<int> originalList = new List<int>();
originalList.add(1);
originalList.add(5);
originalList.add(10); 
```

还有一个清单...

```
IList<int> newList = new List<int>();
newList.add(1);
newList.add(5);
newList.add(7);  
newList.add(11); 
```

如何更新 originalList 以便：

1.  如果 int 出现在 newList 中，保持
2.  如果 int 没有出现在 newList 中，删除
3.  将 newList 中的任何整数添加到 originalList 中尚不存在

因此 - 制作 originalList 的内容：

```
{ 1, 5, 7, 11 } 
```

我问的原因是因为我有一个带有一组孩子的对象。当用户更新这个集合时，而不是仅仅删除所有孩子，然后插入他们的选择，我认为如果我只对添加或删除的孩子采取行动，而不是拆除整个集合，然后插入newList children 就好像他们都是新的一样。

编辑-对不起-我写了一个可怕的标题...我应该写“最少的代码”而不是“高效”。我认为这抛弃了我得到的很多答案。他们都很棒……谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-29T13:41:54.287

```
originalList = newList; 
```

或者，如果您更喜欢它们是不同的列表：

```
originalList = new List<int>(newList); 
```

但是，无论哪种方式都可以满足您的需求。根据您的规则，更新后，originalList 将与 newList 相同。

更新：感谢大家对这个答案的支持，但是在仔细阅读了这个问题之后，我相信我的其他回答（如下）是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-29T16:01:56.663

如果你使用一些 LINQ 扩展方法，你可以分两行来做：

```
originalList.RemoveAll(x => !newList.Contains(x));
originalList.AddRange(newList.Where(x => !originalList.Contains(x))); 
```

这假设（与其他人的解决方案一样）您已经覆盖了原始对象中的 Equals 。但是如果由于某种原因你不能覆盖 Equals，你可以像这样创建一个 IEqualityOperator：

```
class EqualThingTester : IEqualityComparer<Thing>
{
    public bool Equals(Thing x, Thing y)
    {
        return x.ParentID.Equals(y.ParentID);
    }

    public int GetHashCode(Thing obj)
    {
        return obj.ParentID.GetHashCode();
    }
} 
```

然后上面的行变成：

```
originalList.RemoveAll(x => !newList.Contains(x, new EqualThingTester()));
originalList.AddRange(newList.Where(x => !originalList.Contains(x, new EqualThingTester()))); 
```

而且，如果您无论如何要传递 IEqualityOperator，则可以使第二行更短：

```
originalList.RemoveAll(x => !newList.Contains(x, new EqualThingTester()));
originalList.AddRange(newList.Except(originalList, new EqualThingTester())); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T13:49:16.937

对不起，在我看到你的最后一段之前写了我的第一个回复。

```
for(int i = originalList.length-1; i >=0; --i)
{
     if (!newList.Contains(originalList[i])
            originalList.RemoveAt(i);
}

foreach(int n in newList)
{
     if (!originaList.Contains(n))
           originalList.Add(n);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T13:50:00.147

如果您不担心最终的排序，Hashtable/HashSet 可能是最快的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T13:50:41.423

LINQ解决方案：

```
originalList = new List<int>(
                      from x in newList
                      join y in originalList on x equals y into z
                      from y in z.DefaultIfEmpty()
                      select x); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-29T13:44:08.057

我最初的想法是你可以调用 originalList.AddRange(newList) 然后删除重复项 - 但我不确定这是否比清除列表并重新填充它更有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T13:48:04.177

```
List<int> firstList = new List<int>() {1, 2, 3, 4, 5};
List<int> secondList = new List<int>() {1, 3, 5, 7, 9};

List<int> newList = new List<int>();

foreach (int i in firstList)
{
  newList.Add(i);
}

foreach (int i in secondList)
{
  if (!newList.Contains(i))
  {
    newList.Add(i);
  }
} 
```

不是很干净——但它有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-29T13:51:20.410

没有内置的方法可以做到这一点，我能想到的最接近的是 DataTable 处理新项目和已删除项目的方式。

@James [Curran](https://stackoverflow.com/questions/148662/what-is-the-bestefficient-way-to-update-one-list-with-another-list#148684)建议的只是将 originalList 对象替换为 newList 对象。它将转储oldList，但保留变量（即指针仍然存在）。

无论如何，您应该考虑优化这个时间是否值得。将值从一个列表复制到下一个列表所花费的大部分运行时间是否值得。如果不是，而是您正在做一些过早的优化，您应该忽略它。

在开始优化之前花时间完善 GUI 或分析应用程序是我的 0.02 美元。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-29T14:11:00.720

这是开发人员在编写 UI 以维护多对多数据库关系时遇到的常见问题。我不知道这有多有效，但我写了一个帮助类来处理这种情况：

```
public class IEnumerableDiff<T>
{
    private delegate bool Compare(T x, T y);

    private List<T> _inXAndY;
    private List<T> _inXNotY;
    private List<T> _InYNotX;

    /// <summary>
    /// Compare two IEnumerables.
    /// </summary>
    /// <param name="x"></param>
    /// <param name="y"></param>
    /// <param name="compareKeys">True to compare objects by their keys using Data.GetObjectKey(); false to use object.Equals comparison.</param>
    public IEnumerableDiff(IEnumerable<T> x, IEnumerable<T> y, bool compareKeys)
    {
        _inXAndY = new List<T>();
        _inXNotY = new List<T>();
        _InYNotX = new List<T>();
        Compare comparer = null;
        bool hit = false;

        if (compareKeys)
        {
            comparer = CompareKeyEquality;
        }
        else
        {
            comparer = CompareObjectEquality;
        }

        foreach (T xItem in x)
        {
            hit = false;
            foreach (T yItem in y)
            {
                if (comparer(xItem, yItem))
                {
                    _inXAndY.Add(xItem);
                    hit = true;
                    break;
                }
            }
            if (!hit)
            {
                _inXNotY.Add(xItem);
            }
        }

        foreach (T yItem in y)
        {
            hit = false;
            foreach (T xItem in x)
            {
                if (comparer(yItem, xItem))
                {
                    hit = true;
                    break;
                }
            }
            if (!hit)
            {
                _InYNotX.Add(yItem);
            }
        }
    }

    /// <summary>
    /// Adds and removes items from the x (current) list so that the contents match the y (new) list.
    /// </summary>
    /// <param name="x"></param>
    /// <param name="y"></param>
    /// <param name="compareKeys"></param>
    public static void SyncXList(IList<T> x, IList<T> y, bool compareKeys)
    {
        var diff = new IEnumerableDiff<T>(x, y, compareKeys);
        foreach (T item in diff.InXNotY)
        {
            x.Remove(item);
        }
        foreach (T item in diff.InYNotX)
        {
            x.Add(item);
        }
    }

    public IList<T> InXAndY
    {
        get { return _inXAndY; }
    }

    public IList<T> InXNotY
    {
        get { return _inXNotY; }
    }

    public IList<T> InYNotX
    {
        get { return _InYNotX; }
    }

    public bool ContainSameItems
    {
        get { return _inXNotY.Count == 0 && _InYNotX.Count == 0; }
    }

    private bool CompareObjectEquality(T x, T y)
    {
        return x.Equals(y);
    }

    private bool CompareKeyEquality(T x, T y)
    {
        object xKey = Data.GetObjectKey(x);
        object yKey = Data.GetObjectKey(y);
        return xKey.Equals(yKey);
    }

} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-29T17:17:13.300

如果您使用 .Net 3.5

```
var List3 = List1.Intersect(List2); 
```

创建一个包含两个列表交集的新列表，我相信这就是您要在这里拍摄的。

# c# - 带委托的局部变量

> ID：148669
> 
> 赞同：25
> 
> 时间：2008-09-29T13:38:14.560
> 
> 标签：c#, delegates, closures, heap-memory

这~~显然不是~~一个最佳实践。有人可以解释为什么这不是最佳实践或它是如何工作的吗？任何提供解释的书籍或文章将不胜感激。

```
//The constructor
public Page_Index() {

    //create a local value
    string currentValue = "This is the FIRST value";

    //use the local variable in a delegate that fires later
    this.Load += delegate(object sender, EventArgs e) {
        Response.Write(currentValue);
    };

    //change it again
    currentValue = "This is the MODIFIED value";

} 
```

输出的值是第二个值*"Modified"*。编译器魔术的哪一部分使这项工作起作用？这就像跟踪堆上的值并稍后再次检索它一样简单吗？

[编辑]：鉴于一些评论，改变原句一些......

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-29T13:42:57.247

currentValue 不再是局部变量：它是一个*捕获*的变量。这编译为：

```
class Foo {
  public string currentValue; // yes, it is a field

  public void SomeMethod(object sender, EventArgs e) {
    Response.Write(currentValue);
  }
}
...
public Page_Index() {
  Foo foo = new Foo();
  foo.currentValue = "This is the FIRST value";
  this.Load += foo.SomeMethod;

  foo.currentValue = "This is the MODIFIED value";
} 
```

Jon Skeet 在[C# in Depth中有一篇非常好的文章，并](http://www.manning.com/skeet/)[在此处](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)进行了单独（不那么详细）的讨论。

请注意，变量 currentValue 现在位于堆上，而不是堆栈上——这有很多含义，尤其是它现在可以被各种调用者使用。

这与 java 不同：在 java 中，变量的*值*被捕获。在 C# 中，*变量本身*被捕获。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-29T13:52:24.760

> 我想我要问的更多问题是它如何使用局部变量[MG编辑：“Ack - ignore this ...”后来添加]

这就是我想说的; 它真的*不再*是一个局部变量——至少，不是我们通常如何看待它们（在堆栈上等）。它看起来像一个，但它不是。

并且对于信息，“不是好的做法” - 匿名方法和捕获的变量实际上是一个非常强大的工具，*尤其是*在处理事件时。随意使用它们，但如果你走这条路，我建议你拿起 Jon 的书，以确保你了解实际发生的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T13:45:08.660

您需要在闭包/委托中捕获变量的值，否则可以修改它，就像您看到的那样。

将 currentValue 分配给委托的本地（内部）变量。

# jquery - 为什么微软决定支持 jQuery 如此重要？

> ID：148670
> 
> 赞同：30
> 
> 时间：2008-09-29T13:38:28.537
> 
> 标签：jquery, asp.net

我不明白微软决定在 ASP.NET MVC 中支持 JQuery 有什么大惊小怪的。

有迹象表明，思想开放的人在一段时间内开始在营销事务上有发言权。甚至 MS 开展业务的方式也开始发生变化。但它的核心仍然是响应客户的要求。

我不知道该怎么做，除了它将一个非常明显的产品带回微软的影响范围。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-09-29T13:41:45.503

*这是微软第一次发布他们没有用他们的产品编写*的开源组件。这似乎没什么大不了的，但它的影响几乎是核的。

想想看……他们在说“我们支持这个”。在 OSS 产品中，MS 无法控制代码。因此，他们将生计（以某种方式）交到了不为 MS 工作的人手中。

我认为 jQuery 的流行、它不是关键任务代码以及代码库如此之小的事实都为 MS 提供了有利的环境。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-29T14:09:40.817

Microsoft 将 jQuery 与 ASP.Net 一起提供的意义，尽管它是开源的，但与 Microsoft 支持外部开源软件几乎没有关系，几乎**与****建立**事实上的 javascript 框架标准有关。

 **考虑一下：目前至少有 1/2 打 javascript 工具包都非常好。这些工具包代表了对传统 JavaScript 开发的*巨大*改进。它们增加了功能并帮助解决浏览器不兼容问题。最终，您将很难找到一个不使用它的 Web 项目。有一天，它们甚至可能会被嵌入到您的浏览器中，以节省页面加载时间。每个 Web 开发人员都应该学习一个，并且大多数人都明白这一点。

但是哪一个？正如我所说，有几个是一个很好的技术选择。你如何选择？问题是，除非您全部学习，否则您并没有资格判断技术优点，而谁有时间呢？

在这种情况下，跟随人群会更容易、更安全。如果没有明显的技术优势，大多数开发人员将希望选择在其他志同道合的开发人员中获得最多采用的工具包，原因有四个：

*   保证以后技能有用
*   他们将能够在需要时为其提供帮助和支持。
*   他们相信他们的同行能够很好地选择技术上优越或至少技术上胜任的框架。
*   因为不同的选项都主要是开源的，所以随着时间的推移，最流行的也应该成为最好的技术选择。

**所以我们现在的情况是，每个人都在等着看其他人选择哪个框架。坦率地说，在各种工具包中缺乏明确的赢家已经损害了采用。**我知道这阻止了我个人冒险。

***直到现在*。** 现在 ASP.Net 开发人员有了明确的选择。如果您使用 ASP.Net，您可能想花时间学习 jQuery。 *不是原型。不是 MooTools。不是别的。* 你的自然选择是 jQuery。

其他工具也不错，但无论好坏，jQuery 在这里都取得了巨大的成功，这确实是一场人气竞赛。jQuery 在其他平台中的流行也意味着它正在迅速成为事实上的 javascript 框架标准。 **如果您不了解 jQuery，很快您将很难称自己为 Web 开发人员，而且很多人会回过头来说这是转折点。**

所以这里的真正意义与整个“微软使用开源”的事情无关。就我而言，jQuery 是否开源并不重要，尽管从长远来看它可能会有所帮助。重要的是，这将导致大量开发人员开始使用它，可能足以创造霸权。而这正是这个空间真正需要的。我们终于可以再次开始推进客户端 Web 开发了。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-29T21:46:57.363

You have a 500 Pound Gorilla whose official company politics always stood against open source suddenly deciding to actively include and support an Open Source component *for technical reasons*. jQuery is not some legal requirement put on them by US or EU Anti-Trust lawsuits. It's not forced on Microsoft through some standard or some "must-support" component. They are more or less solely choosing it for technical reasons instead of doing their usual "We reinvent the wheel, make it not as good as the free solutions and also not make it open source".

就像教皇在宣传避孕套，就像华盛顿奇才队赢得 NBA 总冠军，就像共和党人投票支持 7000 亿美元的计划，就像石油输出国组织支持太阳能和风能……这在以前似乎是不可想象的，即使坚持请注意，微软有一些最优秀的人才为他们工作。事实上，我仰慕的大多数人现在都在微软工作。

我只能想象要实现这一目标需要进行多少讨论和说服工作，我为微软内部已经证明理性有时会成功的人举起帽子。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-29T13:56:40.147

这是一笔大买卖！

MS 正在利用它没有开发的技术这一事实是一大步。

此外，他们没有购买或消费它的事实也是一个很大的进步。

就我个人而言，我发现在开发 ASP.NET MVC 时使用 jQuery 有很大帮助。它帮助我简化了我的视图，如果我没有 jQuery，我的视图会太复杂。

我认为这是朝着正确方向迈出的一大步。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-29T13:43:15.047

这主要是因为 JQuery 非常出色。现在微软“支持”它，很多从未听说过的人，因为它是“开源”而被指示不要使用它，或者因为它“不是微软”而被指示不要使用它现在都可以开始写精彩了基于浏览器的代码。

这都是好事。在计算机行业，很多人无法使用很多软件，这是一种令人遗憾的状况，但事实就是如此。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-29T13:56:55.637

它的一个重要方面是语法。jQuery 对 $() 的含义与原型和 ASP.NET AJAX 不同。这将迫使 javascript 库解决兼容性问题——首先由微软，然后由其他所有人。对于跨平台的网页设计师来说，这将是一个明确的优势。

更新：我只是在 John Resig 的[博客](http://jquery.com/blog/2008/09/28/jquery-microsoft-nokia/)上宣布：作为微软官方发布的一部分，这意味着微软将记录 jQuery！jQuery 的文档现在“对于 OSS 项目来说还可以”（也就是说，它们并没有那么糟糕），但是有了 MSDN 技术作家团队的支持，我们应该有一些真正有用的东西。

UPDATE2（回应评论）：这是胡说八道，并且比其他任何事情都显示出反 MSFT 的偏见。在 jQuery 中记录最好的部分（核心功能）中，该文档大致等于 MSDN 中给出的级别。那么，一个“非常好”而另一个“烂”怎么可能呢？如果 jQuery 文档的其余部分（尤其是插件，其中包括“官方”插件，如“UI”），那就太可怕了。以 UI/Tabs 为例，它显示了一大块 HTML，但没有解释哪些部分是必需的，哪些只是用于演示的样式。并且没有提及（或在某些版本中甚至包括）或多或少需要的 CSS 文件。或者，最新版本中的 UI/Autocomplete 怎么样，但在 UI 文档中完全缺失（并且在一些细微之处有所不同，

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-29T14:38:54.587

不管你喜不喜欢，微软是软件行业最大的参与者之一，所以它所做的任何事情都很重要。在这种情况下，这似乎是一件好事。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-29T13:42:40.943

这是。我们肯定需要更好的 Javascript 智能感知。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-29T13:49:26.950

对于那些已经使用 jQuery 和 ASP.NET 的人来说，这意味着我们可以期待未来有更好的工具支持它（例如 Visual Studio 中的智能感知支持），更重要的是这意味着（希望）微软不会做任何事情使用破坏 jQuery 的 ASP.NET。

就在 Microsoft 工具中采用（选择？）开源解决方案而言，这是否是涉水项目，还是一次性的，还有待观察。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-29T19:08:26.717

@Code Trawler - 这个问题与参与这项工作的微软部门密切相关。MS Dev Div 对开源非常友好，在过去的几年里从开源社区雇佣了很多人。分叉 JQuery 的举动只会进一步疏远开发社区，并且可能还会疏远他们最近雇用的许多操作系统。这将是一场公关噩梦。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-29T19:12:13.040

如果您在一个由于缺乏支持而不允许使用 OSS 的地方工作，这是巨大的，因为现在它拥有很好的 microsoft 批准印章，以一种公司开发人员永远无法做到的方式帮助赢得业务人员。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-29T13:52:55.523

请记住，Jquery 是由 MS 在 MIT 许可下发布的。这意味着，假设我正确理解了 MIT 许可证的条款，他们将来可以任意更改 jquery 并将其关闭，大概是在它作为 Visual Studio 的一部分被大众接受之后。

编辑：好的，我正在修改。有人可以发布并解释为什么他们认为我在这里的假设是错误的。我误解了麻省理工学院的许可证吗？

# visual-studio - 如何刷新数据集中的关系？

> ID：148672
> 
> 赞同：3
> 
> 时间：2008-09-29T13:38:35.137
> 
> 标签：visual-studio, dataset

我在 VisualStudio 2005 中工作。我已经有一个包含多个数据表的数据集。我不得不修改数据库以添加一个我忘记的新外键。我如何让视觉工作室认识到新的关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T13:53:07.190

.Net 不会自动将 FK 关系加载到您的 DataSet 中 - 但是，您可以使用[DataRelation](http://msdn.microsoft.com/en-us/library/system.data.datarelation.aspx) * 自己添加它们。

*如果您使用的是 LINQ，这可能不是真的 - 如果是，我不确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T07:46:01.370

右键单击 DataSet 页面，然后选择 Add->Relation?

如果您已在数据库中定义它，您始终可以将受影响的表重新拖回数据集中，然后重新输入您的查询。

# c# - 播放声音，等待它完成然后做点什么？

> ID：148676
> 
> 赞同：5
> 
> 时间：2008-09-29T13:40:04.600
> 
> 标签：c#, multithreading, audio, synchronization

我正在编写一个[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)应用程序，它应该播放三个声音文件，并且在每个声音文件的末尾，它是为了更改图像的来源。

我可以让它播放声音`System.Media.SoundPlayer`。然而，它似乎在不同的线程中播放声音，继续。

这样做的最终效果是只播放最后一个声音并且所有图像都发生了变化。

我试过`Thread.Sleep`了，但它让整个 GUI 都处于睡眠状态，并且在睡眠期之后，一切都会立即发生，并且它播放的最后一个声音。

**更新**

我认为 PlaySynch 正在工作，但它似乎冻结了我的 GUI，这不太理想。我还可以做些什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-29T13:44:20.253

您是否尝试[过 SoundPlayer.PlaySync 方法](http://msdn.microsoft.com/en-us/library/system.media.soundplayer.playsync.aspx)？从帮助：

> PlaySync 方法使用当前线程播放 .wav 文件，阻止线程在加载完成之前处理其他消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T13:46:46.300

不要使用 Play 方法，而是使用[PlaySync](http://msdn.microsoft.com/en-us/library/system.media.soundplayer.playsync.aspx)方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T21:23:38.393

使用此代码：

```
[DllImport("WinMM.dll")]
public static extern bool  PlaySound(byte[]wfname, int fuSound);

//  flag values for SoundFlags argument on PlaySound
public static int SND_SYNC        = 0x0000;      // Play synchronously (default).
public static int SND_ASYNC       = 0x0001;      // Play asynchronously.
public static int SND_NODEFAULT   = 0x0002;      // Silence (!default) if sound not found.
public static int SND_MEMORY      = 0x0004;      // PszSound points to a memory file.
public static int SND_LOOP        = 0x0008;      // Loop the sound until next sndPlaySound.
public static int SND_NOSTOP      = 0x0010;      // Don't stop any currently playing sound.
public static int SND_NOWAIT      = 0x00002000;  // Don't wait if the driver is busy.
public static int SND_ALIAS       = 0x00010000;  // Name is a registry alias.
public static int SND_ALIAS_ID    = 0x00110000;  // Alias is a predefined ID.
public static int SND_FILENAME    = 0x00020000;  // Name is file name.
public static int SND_RESOURCE    = 0x00040004;  // Name is resource name or atom.
public static int SND_PURGE       = 0x0040;      // Purge non-static events for task.
public static int SND_APPLICATION = 0x0080;      // Look for application-specific association.
private Thread t; // used for pausing
private string bname;
private int soundFlags;

//-----------------------------------------------------------------
public void Play(string wfname, int SoundFlags)
{
    byte[] bname = new Byte[256];    //Max path length
    bname = System.Text.Encoding.ASCII.GetBytes(wfname);
            this.bname = bname;
            this.soundFlags = SoundFlags;
            t = new Thread(play);
            t.Start();
}
//-----------------------------------------------------------------

private void play()
{
    PlaySound(bname, soundFlags)
}

public void StopPlay()
{
    t.Stop();
}

public void Pause()
{
    t.Suspend(); // Yeah, I know it's obsolete, but it works.
}

public void Resume()
{
    t.Resume(); // Yeah, I know it's obsolete, but it works.
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T13:54:48.217

您可能想要做的是做一个异步声音，然后以不响应用户响应的方式禁用您的 UI。然后，一旦播放了声音，您就可以重新启用您的 UI。这将允许您仍然像往常一样绘制 UI。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T14:03:15.827

我想出了怎么做。我使用了 PlaySynch，但我在一个单独的线程中对绘制 UI 的代码进行了播放。播放每个文件后，同一线程还会更新 UI。

# .net - 工具比较：Visual Assist X 和 Resharper

> ID：148678
> 
> 赞同：23
> 
> 时间：2008-09-29T13:40:20.077
> 
> 标签：.net, resharper, visual-studio-addins, visual-assist

.NET 开发人员在那里！在这里需要你的意见！

我现在正在使用[Visual Assist X](http://www.wholetomato.com)，确实是一款不错的软件。但是 .NET 博主似乎更喜欢[Resharper](http://www.jetbrains.com/resharper)。我可能想考虑换一个，但在此之前我想先听听你们的意见。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-29T13:45:36.443

Resharper 对于 C# 代码（据说是 VB.Net，但我没有尝试过）要好得多。不幸的是，不支持 C/C++，因此如果需要，您可能希望保留 Visual Assist。

不幸的是，它们不能很好地共存，因此在 C/C++ 和 C# 之间切换时，您可能需要先卸载一个，然后再加载另一个。

要了解 Resharper 的魔力，我建议您观看[“Resharper Jedi”视频](http://www.jetbrains.com/resharper/demos/presentation/codingSession/CodingSession.wmv)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-10-20T12:46:39.283

C/C++ = 视觉辅助 X。

对我来说，C# = ReSharper + Visual Assist X。

不用说，对于 C# 开发，ReSharper 比 VA 更强大。但是有一些功能，例如仅在建议列表中显示方法的能力，或者突出显示 VA 中最近的范围，但在 R# 中没有等价物。我两个都用。看起来他们相处得很好：我使用 VA 的默认设置，我必须选择 ReSharper-->Options-->IntelliSense-->General-->Visual Studio 来启用 IntelliSense 的 VA 版本，而不是 ReSharper 的。我还在 ReSharper 中自定义了标识符颜色，现在它们看起来像 VA 默认颜色，但显示了额外的信息（比如 Mutable Local Variables 是**粗体**的）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T08:20:41.500

我知道您只要求比较 Resharper 与 Visual Assist，但如果您正在进行 .NET 开发，您可能还需要考虑[“Refactor！Pro”](http://devexpress.com/Products/Visual_Studio_Add-in/Refactoring/)。

我记得几年前在进行 Visual C++ 开发时使用 VA（早于臭名昭著的 CodeWiz），但在 .NET 开发中，我得到的印象是大多数开发人员似乎都在使用 ReSharper 或 Refactor！。

重构！还集成了一个名为“CodeRush”的代码生成工具，我已经看到它们与 Testdriven.Net 一起非常有效地使用（查看[NHibernate 的夏季](http://www.summerofnhibernate.com/)截屏视频）。

我个人使用 Resharper，我对它提高了我的工作效率感到非常满意，但我相信你会从 Refactor! 中获得同样的好处。

# java - 在java中卸载类？

> ID：148681
> 
> 赞同：186
> 
> 时间：2008-09-29T13:40:59.187
> 
> 标签：java, classloader

我有一个自定义类加载器，以便桌面应用程序可以从我需要与之交谈的 AppServer 动态地开始加载类。我们这样做是因为这样做所需的罐子数量是荒谬的（如果我们想运送它们）。如果我们不在运行时从 AppServer 库动态加载类，我们也会遇到版本问题。

现在，我刚刚遇到了一个问题，我需要与两个不同的 AppServers 对话，并发现根据我首先加载的类，我可能会严重崩溃……有没有办法在不实际杀死 JVM 的情况下强制卸载类？

希望这是有道理的

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2008-09-29T13:46:52.463

可以卸载类的唯一方法是使用的类加载器是垃圾收集的。这意味着，对每个类和类加载器本身的引用都需要像渡渡鸟一样。

您的问题的一种可能的解决方案是为每个 jar 文件设置一个类加载器，并为每个 AppServers 设置一个类加载器，将类的实际加载委托给特定的 Jar 类加载器。这样，您可以为每个 App 服务器指向不同版本的 jar 文件。

不过，这并非微不足道。OSGi 平台努力做到这一点，因为每个包都有不同的类加载器，并且依赖关系由平台解决。也许一个好的解决方案是看看它。

如果您不想使用 OSGI，一种可能的实现可能是为每个 JAR 文件使用一个[JarClassloader类的实例。](https://docs.oracle.com/javase/tutorial/deployment/jar/jarclassloader.html)

并创建一个扩展 Classloader 的新 MultiClassloader 类。这个类在内部会有一个 JarClassloaders 数组（或 List），并且在 defineClass() 方法中将遍历所有内部类加载器，直到可以找到定义，或者抛出 NoClassDefFoundException。可以提供几个访问器方法来将新的 JarClassloaders 添加到类中。MultiClassLoader 在网上有几种可能的实现，因此您甚至可能不需要编写自己的实现。

如果您为与服务器的每个连接实例化一个 MultiClassloader，原则上每个服务器都可能使用同一类的不同版本。

我在一个项目中使用了 MultiClassloader 的想法，其中包含用户定义脚本的类必须从内存中加载和卸载，并且效果很好。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-09-29T13:59:35.413

是的，有一些方法可以加载类并在以后“卸载”它们。诀窍是实现您自己的类加载器，它位于高级类加载器（系统类加载器）和应用服务器的类加载器之间，并希望应用服务器的类加载器确实将类加载委托给上层加载器.

一个类由它的包、它的名称和它最初加载的类加载器定义。编写一个“代理”类加载器，它是启动 JVM 时加载的第一个。工作流程：

*   程序启动，真正的“主”类由这个代理类加载器加载。
*   然后正常加载的每个类（即不是通过可能破坏层次结构的另一个类加载器实现）将被委托给这个类加载器。
*   代理类加载器委托`java.x`给`sun.x`系统类加载器（这些类加载器*不能通过*系统类加载器以外的任何其他类加载器加载）。
*   对于每个可替换的类，实例化一个类加载器（它真正加载类并且不将其委托给父类加载器）并通过它加载它。
*   将类的包/名称作为键存储，将类加载器作为值存储在数据结构（即 Hashmap）中。
*   每次代理类加载器收到对之前加载的类的请求时，它都会从之前存储的类加载器中返回该类。
*   通过类加载器定位类的字节数组（或从数据结构中“删除”键/值对）并重新加载类以防万一您想要更改它应该足够了。

正确完成不应该出现[ClassCastException](https://docs.oracle.com/javase/7/docs/api/java/lang/ClassCastException.html)或[LinkageError](https://docs.oracle.com/javase/7/docs/api/java/lang/LinkageError.html)等。

有关类加载器层次结构的更多信息（是的，这正是您在此处实现的内容；-）请查看[Ted Neward 的“基于服务器的 Java 编程”](http://www.manning.com/neward3/) ——这本书帮助我实现了与您想要的非常相似的东西。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-07-06T15:33:22.387

我编写了一个自定义类加载器，可以从中卸载单个类，而无需对类加载器进行 GC。[Jar 类加载器](http://jcloader.sourceforge.net)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-29T13:46:13.777

类加载器可能是一个棘手的问题。如果您使用多个类加载器并且没有清晰和严格地定义它们的交互，您尤其会遇到问题。我认为为了真正能够卸载一个类，你必须删除对你试图卸载的任何类（及其实例）的所有引用。

大多数需要做这类事情的人最终都会使用[OSGi](http://en.wikipedia.org/wiki/OSGi)。OSGi 真的很强大，出奇的轻量级和易于使用，

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-29T13:44:39.503

您可以卸载 ClassLoader，但不能卸载特定的类。更具体地说，您无法卸载在不受您控制的 ClassLoader 中创建的类。

如果可能，我建议使用您自己的 ClassLoader，以便您可以卸载。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-29T15:19:31.460

类具有对其 ClassLoader 实例的隐式强引用，反之亦然。它们与 Java 对象一样被垃圾收集。如果不点击工具界面或类似界面，您将无法删除单个类。

与以往一样，您可能会出现内存泄漏。对您的类或类加载器之一的任何强引用都会泄漏整个事情。例如，这发生在 Sun 的 ThreadLocal 实现、java.sql.DriverManager 和 java.beans 中。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2017-10-15T18:56:33.453

如果您正在现场观看卸载类是否在[JConsole](http://docs.oracle.com/javase/7/docs/technotes/guides/management/jconsole.html)中起作用，请尝试 `java.lang.System.gc()`在类卸载逻辑的末尾添加。它显式地触发垃圾收集器。

# csv - iSeries 导出为 CSV

> ID：148689
> 
> 赞同：4
> 
> 时间：2008-09-29T13:43:02.567
> 
> 标签：csv, ibm-midrange, control-language

是否有 iSeries 命令将表格中的数据导出为 CSV 格式？

我知道 Windows 实用程序，但由于这需要自动运行，我需要从 CL 程序运行它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-30T17:35:26.417

您可以使用 CPYTOIMPF 并指定 TOSTMF 选项以将 CSV 文件放在 IFS 上。示例： CPYTOIMPF FROMFILE(DBFILE) TOSTMF('/outputfile.csv') STMFCODPAG(*PCASCII) RCDDLM(*CRLF)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T14:29:48.053

如果您希望将数据直接下载到 PC，您可以使用 IBM iSeries Client Access 的“从 iSeries 传输数据”功能来创建一个 .CSV 文件。在文件输出详细信息对话框中，将文件类型设置为`Comma Separated Variable (CSV)`.

您可以保存传输描述以供以后重复使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T23:32:30.270

你可以使用触发器。iSeries Client Access 软件不会这样做，因为那是一个 Windows 应用程序，我的理解是每次写入文件时都需要导出数据。检查[此链接](http://www.tylogix.com/Articles/TriggerTechniques.htm)以了解有关触发器的更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-21T01:57:58.413

您将需要 FTP 来执行该操作。如果您的 iSeries 商店使用 ZMOD/FTP，那么最短的解决方案是几行代码——确切地说是 3 行——这三行是 Start FTP、Put DBF，最后是 End FTP。

如果您不使用 ZMOD/FTP： - 您可以使用本机 FTP/400 来完成您需要做的事情，但它非常复杂！！！- 您可能需要使用 RPGLE 程序将数据解析、格式化和移动到“平面文件”中，然后使用本机 FTP/400 将文件通过 FTP 导出 - 是的，CL 需要作为包装器！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-30T19:18:32.463

您可以在一个非常简单的 CL 程序中完成所有操作：

*   CPYTOIMPF 文件 TOSTMF -> cvs 文件将在 IFS 中
*   将文件 FTP 到其他地方（到服务器或 PC）

它就像一个魅力

# wpf - 如何从 ContentTemplate 绑定到周围的自定义控件？

> ID：148704
> 
> 赞同：7
> 
> 时间：2008-09-29T13:46:16.007
> 
> 标签：wpf, xaml, binding, datatemplate

我有以下用户控制：

```
<TabItem 
    x:Name="Self"
    x:Class="App.MyTabItem"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:app="clr-namespace:App"
    >
    <TabItem.Header>
        <!-- This works -->
        <TextBlock Text="{Binding ElementName=Self, Path=ShortLabel, UpdateSourceTrigger=PropertyChanged}"/>
    </TabItem.Header>
    <TabItem.ContentTemplate>
        <DataTemplate>
            <!-- This binds to "Self" in the surrounding window's namespace -->
            <TextBlock Text="{Binding ElementName=Self, Path=ShortLabel, UpdateSourceTrigger=PropertyChanged}"/> 
```

这个自定义的 TabItem 定义了一个`DependencyProperty`“ShortLabel”来实现一个接口。我想从`TabItem`'s中绑定到 this 和其他属性`DataTemplate`。但是由于奇怪的交互，其中`TextBlock`的`DataTemplate`被绑定到 的**父容器**，该容器`TabItem`也称为“Self”，但在另一个 Xaml 文件中定义。

## 问题

为什么绑定在 TabItem.Header 中起作用，但在 TabItem.ContentTemplate 中不起作用，我应该如何继续从 DataTemplate 中获取用户控件的属性？

## 我已经尝试过的

*   `TemplateBinding`: 尝试在`TabItem`.
*   `FindAncestor, AncestorType={x:Type TabItem}`: 找不到`TabItem`父母。`MyTabItem`当我指定类型时，这也不起作用。
*   `ElementName=Self`: 尝试绑定到错误范围内具有该名称的控件（父容器，而不是`TabItem`）。我认为这给出了一个提示，为什么这不起作用：DataTemplate 不是在 XAML 中定义的位置创建的，而是显然是由父容器创建的。

我假设我可以替换整个`ControlTemplate`来实现我正在寻找的效果，但是由于我想保留默认外观`TabItem`而不必维护整体`ControlTemplate`，所以我非常不愿意这样做。

## 编辑

同时我发现问题是：如果包含s，则`TabControl`s 不能有（任何）`ItemsTemplate`（包括） 。[MSDN 论坛上](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/956eaba3-53bd-4683-b3dd-28b20e4b7526/)有一个帖子解释了原因。`DisplayMemberPath``ItemsSource``Visual`

由于这似乎是 WPF 的 TabControl 的一个基本问题，所以我要结束这个问题。感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-01T06:48:29.307

问题似乎是您使用的是 ContentTemplate 而没有实际使用 content 属性。ContentTemplate 的DataTemplate 的默认DataContext 是TabItem 的Content 属性。但是，我所说的都没有真正解释**为什么**绑定不起作用。不幸的是，我不能给你一个明确的答案，但我最好的猜测是，这是因为 TabControl 重用了 ContentPresenter 来显示所有选项卡项的内容属性。

因此，在您的情况下，我会将代码更改为如下所示：

```
<TabItem
    x:Class="App.MyTabItem"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:app="clr-namespace:App"
    Header="{Binding ShortLabel, RelativeSource={RelativeSource Self}}"
    Content="{Binding ShortLabel, RelativeSource={RelativeSource Self}}" /> 
```

如果 ShortLabel 是一个更复杂的对象而不仅仅是一个字符串，那么你会想要引入一个 ContentTemplate：

```
<TabItem
    x:Class="App.MyTabItem"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:app="clr-namespace:App"
    Header="{Binding ShortLabel, RelativeSource={RelativeSource Self}}"
    Content="{Binding ComplexShortLabel, RelativeSource={RelativeSource Self}}">
    <TabItem.ContentTemplate>
        <DataTemplate TargetType="{x:Type ComplexType}">
            <TextBlock Text="{Binding Property}" />
        </DataTemplate>
    </TabItem.ContentTemplate>
</TabItem> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T19:58:57.500

尝试这个。我不确定它是否会起作用，但是

```
<TabItem 
    x:Name="Self"
    x:Class="App.MyTabItem"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:app="clr-namespace:App"
    >
    <TabItem.ContentTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Path=ShortLabel}"/>
        </DataTemplate>
    </TabItem.ContentTemplate>
</TabItem> 
```

如果它不起作用，请尝试将此属性粘贴在 <TabItem/> 中：

```
DataContext="{Binding RelativeSource={RelativeSource self}}" 
```

# asp.net - ASP.NET 1.1 中的用户控制公共共享变量未按预期工作

> ID：148723
> 
> 赞同：0
> 
> 时间：2008-09-29T13:50:48.227
> 
> 标签：asp.net, controls

假设我有一个包含一些用户控件的 Web 表单。我的“主要”Web 表单的标题标签是在其中一个用户控件中生成的。将此数据传递给 Web 表单目前是这样完成的。

```
Public Sub SetPageValues(ByVal sTitle As String, ByVal sKeywords As String, ByVal sDesc As String)
    MySystem.Web.UI.Main.PageSettings(sKeywords, sDesc, sTitle)
End Sub 
```

Main 是 Web 表单的名称。这是在 Main 中设置该值的 sub。

```
 Public Shared Sub PageSettings(ByVal strKeywords As String, ByVal strDesc As String, ByVal strTitle As String)
    Dim _lblTitle As System.Web.UI.webcontrols.Literal = lblTitle
    Dim _lblMetaDesc As System.Web.UI.webControls.Literal = lblMetaDesc
    Dim _lblMetaKeywords As System.Web.UI.WebControls.Literal = lblMetaKeywords
    Dim _lblMetatitle As System.Web.UI.WebControls.Literal = lblMetaTitle
    _lblTitle.Text = strTitle
    _lblMetaDesc.Text = "<meta name=""description"" content=""" + strDesc + """>"
    _lblMetaKeywords.Text = "<meta name=""keywords"" content=""" + strKeywords + """>"
    _lblMetatitle.Text = "<meta name=""title"" content=""" + strTitle + """>"
End Sub 
```

在所有这些之后，我们正在运行池化内存并每 400 分钟回收一次，但是，页面标题会损坏并无法正确显示。除了迁移到新版本的 .net 之外，还有其他人有什么想法吗？

通过在用户控件中创建属性，现在可以正确传递值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T14:08:42.693

就个人而言，这就是我会做的。首先 - 将 TITLE 更改为 HTML.GenericControl 在 ASPX 端，它看起来像这样：

```
<title runat="server" id="title" /> 
```

然后，我将 META 标签修改为 html 通用控件

```
<meta name="description" content="description" id="description" runat="server" />
<meta name="keywords" content="keys" id="keywords" runat="server" /> 
```

此时，您可以像这样修改值：

```
title.InnerText = "This Title"
keywords.Attributes("content") = "key,word"
description.Attributes("content") = "A demonstration of Setting title and meta tags" 
```

# c# - ASP.NET MVC 输入验证

> ID：148725
> 
> 赞同：7
> 
> 时间：2008-09-29T13:51:04.577
> 
> 标签：c#, asp.net-mvc

我目前正在开发 ASP.NET MVC 中的博客应用程序。

我无法弄清楚如何处理我的输入验证！据我了解，视图本身无法了解输入验证！？那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-29T14:24:59.767

[Scott Guthrie](https://en.wikipedia.org/wiki/Scott_Guthrie)写了一些关于 ASP.NET MVC Preview 5 的文章，并发布了表单：

*[ASP.NET MVC Preview 5 和表单发布方案](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)*

这是一个很大的帖子，但它会引导您完成表单发布验证。请注意，这不是唯一的方法，但它是一种方法。

# java - 可滚动的 JDesktopPane？

> ID：148728
> 
> 赞同：12
> 
> 时间：2008-09-29T13:51:31.017
> 
> 标签：java, swing, user-interface, jscrollpane, jdesktoppane

我想将滚动功能添加到`javax.swing.JDesktopPane`. 但是包装 a`javax.swing.JScrollPane`不会产生所需的行为。

[在网上搜索](http://www.google.com/search?q=scrollable+jdesktoppane)表明，这已经是一个很长一段时间的问题了。有[一些](http://jscroll.sourceforge.net) [解决方案](http://www.javaworld.com/javaworld/jw-11-2001/jw-1130-jscroll.html)，但它们似乎已经很老了，我对它们并不完全满意。

您知道哪些**积极维护**的解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-29T13:56:10.210

我通过创建自己的方法使用了[JavaWorld 的解决方案](http://www.javaworld.com/javaworld/jw-11-2001/jw-1130-jscroll.html "可滚动的 JDesktopPane")`JScrollableDesktopPane.`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-16T16:22:50.000

Javaworld`JScrollableDesktopPane`在他们的网站上不再可用。我设法找到了它的一些副本，但它们都不起作用。

我得出的一个简单的解决方案可以通过以下方式实现。这不是最漂亮的，但它肯定比默认行为更好。

```
public class Window extends Frame {
    JScrollPane scrollContainer = new JScrollPane();
    JDesktopPane mainWorkingPane = new JDesktopPane();

    public Window() {
        scrollContainer.setViewportView(mainWorkingPane);

        addComponentListener(new ComponentAdapter() {
            public void componentResized(ComponentEvent evt) {
                revalidateDesktopPane();
            }
        });
    }

    private void revalidateDesktopPane() {
        Dimension dim = new Dimension(0,0);
        Component[] com = mainWorkingPane.getComponents();
        for (int i=0 ; i<com.length ; i++) {
            int w = (int) dim.getWidth()+com[i].getWidth();
            int h = (int) dim.getHeight()+com[i].getHeight();
            dim.setSize(new Dimension(w,h));
        }
        mainWorkingPane.setPreferredSize(dim);
        mainWorkingPane.revalidate();
        revalidate();
        repaint();  
    }
} 
```

这个想法是包装`JDesktopPane`在 a`JScrollPane`中，在主 Frame 上添加一个调整大小的侦听器，然后评估`JDesktopPane`on resize 的内容（或添加新元素）。

希望这可以帮助那里的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T14:11:51.143

我发现了这个：[http ://www.javaworld.com/javaworld/jw-11-2001/jw-1130-jscroll.html?page=1](http://www.javaworld.com/javaworld/jw-11-2001/jw-1130-jscroll.html?page=1)

这是一个很好的教程，有很多关于 Swing 的解释和信息，它允许创建一个包含很多东西的 JscrollableDesktopPane。

您将需要修改一些代码部分以满足您的要求。

享受 ！

# c# - 如何在 C# 中设置/更改/删除按钮上的焦点样式？

> ID：148729
> 
> 赞同：30
> 
> 时间：2008-09-29T13:51:43.730
> 
> 标签：c#, winforms, button, focus

我有几个按钮，我修改了它们的外观。我将它们设置为带有背景和自定义边框的平面按钮，因此它们看起来都很漂亮，不再像普通按钮了（实际上，它们现在看起来像 Of​​fice 2003 按钮 ;-)。按钮有一个像素的边框。

但是，当按钮被选中时（通过单击或键盘操作（如按 Tab 键）获得焦点），按钮会突然出现相同颜色的额外边框，因此使其成为两个像素的边框。此外，当我禁用一像素边框时，按钮不会获​​得一像素边框焦点。

在网上，这个问题很像“如何禁用按钮上的焦点”，但这不是我想要的：焦点应该仍然*存在*，只是不以现在的方式*显示*。

有什么建议么？:-)

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-09-29T14:16:01.347

这就是你想要的效果吗？

```
public class NoFocusCueButton : Button
{
    protected override bool ShowFocusCues
    {
        get
        {
            return false;
        }
    }
} 
```

您可以像使用常规按钮一样使用此自定义按钮类，但它不会为您提供额外的焦点矩形。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2011-01-25T21:08:24.730

我对烦人的双边框也有同样的问题，偶然发现了这个线程寻找答案......

我解决这个问题的方法是将**BorderSize设置为 0，然后在****OnPaint**中绘制我自己的边框

 *****注意：**不是整个按钮，*只是边框*

一个简单的例子是：

```
public class CustomButton : Button
{
    public CustomButton()
        : base()
    {
        // Prevent the button from drawing its own border
        FlatAppearance.BorderSize = 0;
        FlatStyle = System.Windows.Forms.FlatStyle.Flat;
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);

        // Draw Border using color specified in Flat Appearance
        Pen pen = new Pen(FlatAppearance.BorderColor, 1);
        Rectangle rectangle = new Rectangle(0, 0, Size.Width - 1, Size.Height - 1);
        e.Graphics.DrawRectangle(pen, rectangle);
    }
} 
```

就我而言，这就是我制作一个模仿 ToolStripButton 的按钮的方式，其中边框仅在您将鼠标悬停在按钮上时可见：

```
public class ToolButton : Button
{
    private bool ShowBorder { get; set; }

    public ToolButton()
        : base()
    {
        // Prevent the button from drawing its own border
        FlatAppearance.BorderSize = 0;

        // Set up a blue border and back colors for the button
        FlatAppearance.BorderColor = Color.FromArgb(51, 153, 255);
        FlatAppearance.CheckedBackColor = Color.FromArgb(153, 204, 255);
        FlatAppearance.MouseDownBackColor = Color.FromArgb(153, 204, 255);
        FlatAppearance.MouseOverBackColor = Color.FromArgb(194, 224, 255);
        FlatStyle = System.Windows.Forms.FlatStyle.Flat;

        // Set the size for the button to be the same as a ToolStripButton
        Size = new System.Drawing.Size(23, 22);
    }

    protected override void OnMouseEnter(EventArgs e)
    {
        base.OnMouseEnter(e);

        // Show the border when you hover over the button
        ShowBorder = true;
    }

    protected override void OnMouseLeave(EventArgs e)
    {
        base.OnMouseLeave(e);

        // Hide the border when you leave the button
        ShowBorder = false;
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);

        // The DesignMode check here causes the border to always draw in the Designer
        // This makes it easier to place your button
        if (DesignMode || ShowBorder)
        {
            Pen pen = new Pen(FlatAppearance.BorderColor, 1);
            Rectangle rectangle = new Rectangle(0, 0, Size.Width - 1, Size.Height - 1);
            e.Graphics.DrawRectangle(pen, rectangle);
        }
    }

    // Prevent Text from being set on the button (since it will be an icon)
    [Browsable(false)]
    public override string Text { get { return ""; } set { base.Text = ""; } }

    [Browsable(false)]
    public override ContentAlignment TextAlign { get { return base.TextAlign; } set { base.TextAlign = value; } }
} 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-12-02T11:55:57.927

制作一个自定义按钮：

```
public partial class CustomButton: Button
{
    public ButtonPageButton()
    {
        InitializeComponent();

        this.SetStyle(ControlStyles.Selectable, false);
    }
} 
```

那将摆脱那个烦人的边界！;-)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-11T20:55:05.037

另一种选择（虽然有点 hacktastic）是将事件处理程序附加到按钮的 GotFocus 事件。在该事件处理程序中，将 False 值传递给按钮的`NotifyDefault()`方法。因此，例如：

```
void myButton_GotFocus(object sender, EventArgs e)
{
  myButton.NotifyDefault(false);
} 
```

我假设这每次都会起作用，但我还没有对它进行广泛的测试。它现在对我有用，所以我对此感到满意。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T17:32:54.533

还有另一种适用于平面样式按钮的方法。不要使用按钮，而是使用标签。当您完全替换按钮的 UI 时，使用按钮控件还是标签并不重要。只需以相同的方式处理点击。

这对我有用，虽然不是很好的做法，但它是一个很好的技巧，只要你清楚地命名按钮（并评论源）其他编码人员就会接受这个想法。

瑞安

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-01T21:31:51.033

添加的第二个边框是 Windows 标准的“默认按钮”边框。您可能已经注意到，如果您在大多数带有多个按钮的对话框（例如任何控制面板属性窗口）中切换，原来的“双边框”按钮变成“正常”，而焦点按钮变成“双边框”。 "

这不一定是工作重点，而是按 Enter 键所采取的行动的视觉指示。

听起来，对我来说，就像你并不真正关心内部工作。您希望显示器没有两个边框——完全可以理解。内部工作是解释为什么你会看到这种行为。现在...尝试修复它。

我要尝试的第一件事——请记住，我还没有验证这一点——是一个 hack。当按钮获得焦点（从而获得双边框）时，关闭单边框。你可能会得到你想要的效果，而且很简单。（挂钩到 Focus 事件。更好的是，子类 Button 并覆盖 OnFocus，然后将该子类用于您未来的按钮。）

然而，这可能会引入新的、尴尬的视觉副作用。在这种情况下——因为黑客很少是最好的答案——我必须“正式”推荐其他人所说的：自定义绘制按钮。虽然这里的代码可能有点过头了，但[CodeProject 上的这个链接](http://www.codeproject.com/KB/cpp/PictureHoverButton.aspx)讨论了如何做到这一点（VB 链接；你需要翻译）。在完全自定义模式下，您应该能够完全摆脱第二个边框。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T14:01:46.077

当然，您可以自己绘制按钮。州旗之一是集中的。

因此，在绘制事件中，如果标志被聚焦，请继续按照您喜欢的方式绘制按钮，否则只需将其传递给基本方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-29T14:05:36.473

考虑为按钮实现您自己的绘图代码。这样你就可以完全控制。过去，我实现了自己的 Control 派生类，它自定义绘制按钮并实现所有按钮特性以满足我的目的，但您应该能够覆盖按钮的绘制并自己完成，从而控制它在每个状态下的绘制方式，包括专注时。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-15T04:47:49.253

如果你有一个文本框和一个按钮，那么在文本框的 textchange 事件上写`button1.focus();`

它会起作用的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-18T12:56:43.247

[在您的样式中将FocusVisualStyle](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.focusvisualstyle.aspx)依赖属性设置为 null，虚线边框将消失。

来自 MSDN：[控件中的焦点样式和 FocusVisualStyle](http://msdn.microsoft.com/en-us/library/bb613567.aspx)

> Windows Presentation Foundation (WPF) 提供了两种并行机制，用于在控件接收到键盘焦点时更改控件的视觉外观。第一种机制是对应用于控件的样式或模板中的 IsKeyboardFocused 等属性使用属性设置器。第二种**机制是提供一个单独的样式作为 FocusVisualStyle 属性的值；“焦点视觉样式”为在控件顶部绘制的装饰器创建单独的视觉树，** 而不是通过替换来更改控件或其他 UI 元素的视觉树。本主题讨论其中每种机制都适用的场景。

您看到的**额外边框**是由 FocusVisualStyle 定义的，而不是在控件模板中，因此您需要移除或覆盖样式才能移除边框。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-01-17T15:11:44.657

您还可以创建一个不可见的按钮，并在您按下另一个按钮时使其处于活动状态。

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2010-12-02T20:40:03.350

我很幸运，只是将按钮的 Focusable 属性设置为 false：

```
<Button HorizontalAlignment="Left" Margin="0,2" 
        Command="{Binding OpenSuspendedJobCommand, Mode=OneWay}"  
        Focusable="False"
        Style="{StaticResource ActionButton}" Content="Open Job..." /> 
```

# c# - 在 C# 中拦截 Windows Vista 关闭事件

> ID：148733
> 
> 赞同：7
> 
> 时间：2008-09-29T13:52:42.667
> 
> 标签：c#, windows, events, windows-vista

我希望能够在 C# 中为 Windows Vista 拦截关机事件。由于 Vista 的高级安全功能，调用关机命令后运行的任何应用程序都会停止并显示在列表中，提示用户对其进行操作。

有谁知道如何克服这个问题以及我需要在 Vista 中使用哪些事件。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-29T14:06:40.717

您可以使用 WPF 的应用程序对象并订阅其 SessionEnding 事件。然后，您可以查看[SessionEndingCancelEventArgs.ReasonSessionEnding](http://msdn.microsoft.com/en-us/library/system.windows.sessionendingcanceleventargs.reasonsessionending.aspx)枚举以确定会话结束的确切原因（LogOff 或 Shutdown）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-29T14:07:28.593

您可能想看看这里 - [Windows Vista 中的应用程序关闭更改](http://msdn.microsoft.com/en-us/library/ms700677.aspx)。基本上，对于您想要的，这一切都围绕着 WM_QUERYENDSESSION。

请注意，这在 .net 框架中公开 - 相反，您需要使用本机函数 (p/invoke) 并在代码中挂钩 wndproc 以响应 Windows 消息。

例如（显示不关机的原因），您可以查看[Windows Vista - ShutdownBlockReasonCreate in C#](http://community.bartdesmet.net/blogs/bart/archive/2006/10/25/Windows-Vista-_2D00_-ShutdownBlockReasonCreate-in-C_2300_.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T14:01:03.210

```
System.Environment.HasShutdownStarted 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T14:09:18.353

使用事件

WPF 的 Application.SessionEnding。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T14:11:25.727

Microsoft.Win32.SystemEvents 上的 SessionEnding / SessionEnded 事件可能是您正在寻找的。

# c# - 如何检测任何特定驱动器是否是硬盘驱动器？

> ID：148742
> 
> 赞同：13
> 
> 时间：2008-09-29T13:55:56.733
> 
> 标签：c#, hardware, hard-drive

在 C# 中，您如何检测特定驱动器是硬盘驱动器、网络驱动器、CDRom 还是软盘？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-29T14:09:34.500

GetDrives() 方法返回一个 DriveInfo 类，该类具有对应于 System.IO.DriveType 枚举的 DriveType 属性：

```
public enum DriveType
{
    Unknown,         // The type of drive is unknown.  
    NoRootDirectory, // The drive does not have a root directory.  
    Removable,       // The drive is a removable storage device, 
                     //    such as a floppy disk drive or a USB flash drive.  
    Fixed,           // The drive is a fixed disk.  
    Network,         // The drive is a network drive.  
    CDRom,           // The drive is an optical disc device, such as a CD 
                     // or DVD-ROM.  
    Ram              // The drive is a RAM disk.   
} 
```

下面是一个来自 MSDN 的稍微调整的示例，它显示了所有驱动器的信息：

```
 DriveInfo[] allDrives = DriveInfo.GetDrives();
    foreach (DriveInfo d in allDrives)
    {
        Console.WriteLine("Drive {0}, Type {1}", d.Name, d.DriveType);
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-29T13:57:33.357

[DriveInfo.DriveType](http://msdn.microsoft.com/en-us/library/system.io.driveinfo.drivetype.aspx)应该适合你。

```
DriveInfo[] allDrives = DriveInfo.GetDrives();

foreach (DriveInfo d in allDrives)
{
    Console.WriteLine("Drive {0}", d.Name);
    Console.WriteLine("  File type: {0}", d.DriveType);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-29T13:57:56.383

检查[System.IO.DriveInfo](http://msdn.microsoft.com/en-us/library/system.io.driveinfo.aspx)类和 DriveType 属性。

# frameworks - 框架和库有什么区别？

> ID：148747
> 
> 赞同：988
> 
> 时间：2008-09-29T13:56:50.317
> 
> 标签：frameworks, language-agnostic, libraries, terminology

***框架***和***库***有什么区别？

我一直认为库是一组对象和函数，专注于解决特定问题或应用程序开发的特定领域（即数据库访问）。另一方面，作为一个以特定方法（即 MVC）为中心并涵盖应用程序开发的所有领域的库的集合的框架。

* * *

## 回答 #1

> 赞同：582
> 
> 时间：2008-09-29T13:58:40.437

**库**执行特定的、定义明确的操作。

**框架**是一个骨架，应用程序通过填写骨架来定义操作的“内容”。骨架仍然有代码来连接各个部分，但最重要的工作是由应用程序完成的。

**库示例：**网络协议、压缩、图像处理、字符串实用程序、正则表达式评估、数学。操作是独立的。

**框架示例：** Web 应用系统、插件管理器、GUI 系统。框架定义了概念，而应用程序定义了最终用户关心的基本功能。

* * *

## 回答 #2

> 赞同：390
> 
> 时间：2008-09-29T14:17:09.723

实际上，这些术语可能意味着很多不同的东西，具体取决于它们使用的上下文。

例如，在 Mac OS X 上，框架只是库，打包成一个包。在捆绑包中，您将找到一个实际的动态库 (libWhatever.dylib)。裸库和 Mac 上的框架的区别在于，一个框架可以包含多个不同版本的库。它可以包含额外的资源（图像、本地化字符串、XML 数据文件、UI 对象等），除非该框架公开发布，否则它通常包含使用该库所需的必要 .h 文件。

因此，您将所有内容都包含在一个包中，您需要在应用程序中使用该库（没有 .h 文件的 C/C++/Objective-C 库非常没用，除非您根据某些库文档自己编写它们），而不是一堆要移动的文件（Mac 包只是 Unix 级别的目录，但 UI 将其视为单个文件，就像您在 Java 中拥有 JAR 文件一样，当您单击它时，通常看不到里面有什么，除非您明确选择显示内容）。

维基百科称框架为“流行语”。它将软件框架定义为

> 软件框架是软件系统（或子系统）的可重用设计。软件框架可能包括支持程序、代码库、脚本语言或其他软件，以帮助开发和粘合软件项目的不同组件。可以通过 API 公开框架的各个部分。

所以我想说图书馆就是这样，“图书馆”。它是对象/函数/方法的集合（取决于您的语言），您的应用程序“链接”它，因此可以使用对象/函数/方法。它基本上是一个包含可重用代码的文件，通常可以在多个应用程序之间共享（您不必一遍又一遍地编写相同的代码）。

框架可以是您在应用程序开发中使用的一切。它可以是一个库、许多库的集合、脚本的集合或创建应用程序所需的任何软件。框架只是一个非常模糊的术语。

这是一篇关于某个人关于“[库与框架](https://web.archive.org/web/20070504053354/http://www.ddj.com/blog/architectblog/archives/2006/07/frameworks_vs_l.html)”主题的文章。我个人认为这篇文章很有争议。他在那儿说的没有错，但是，他只是从框架的多个定义中挑选了一个，并将其与库的经典定义进行了比较。例如，他说您需要一个子类化框架。真的吗？我可以在库中定义一个对象，我可以链接它，并在我的代码中对它进行子类化。我不明白我如何需要一个“框架”。在某种程度上，他更愿意解释当今如何使用框架一词。正如我之前所说，这只是一个炒作的词。一些公司只发布一个普通库（在任何意义上的经典库）并称其为“框架”，因为它听起来更花哨。

* * *

## 回答 #3

> 赞同：326
> 
> 时间：2008-09-29T14:06:03.527

我认为主要区别在于框架遵循“[好莱坞原则](http://en.wikipedia.org/wiki/Hollywood_Principle)”，即“不要打电话给我们，我们会打电话给你”。

根据[马丁福勒](http://martinfowler.com/bliki/InversionOfControl.html)：

> **库**本质上是一组可以调用的函数，现在通常组织成类。每个调用都会做一些工作并将控制权返回给客户端。
> 
> **框架**体现了一些抽象设计，内置了更多行为。为了使用它，您需要通过子类化或插入您自己的类来将您的行为插入到框架中的各个位置。然后，框架的代码会在这些点调用您的代码。

* * *

## 回答 #4

> 赞同：274
> 
> 时间：2008-10-24T14:29:04.763

你打电话给图书馆。

框架调用你。

* * *

> 図书馆 助け
> 足场が痛い<br> 多くの涙

* * *

## 回答 #5

> 赞同：270
> 
> 时间：2013-03-24T16:23:12.333

* * *

## 回答 #6

> 赞同：121
> 
> 时间：2008-09-29T14:04:04.857

正如我一直描述的那样：

图书馆是一种工具。

框架是一种生活方式。

您可以使用任何可以帮助您的小部分的库。您必须将整个项目提交到的框架。

* * *

## 回答 #7

> 赞同：51
> 
> 时间：2014-12-23T07:45:53.893

从 Web 开发人员的角度来看：

1.  库可以很容易地被另一个库替换。但框架不能。

    如果您不喜欢 jquery 日期选择器库，您可以替换为其他日期选择器，例如引导日期选择器或 pickadate。

    如果您不喜欢构建产品的 AngularJS，则不能仅用任何其他框架替换。您必须重写整个代码库。

2.  与框架相比，大多数库的学习曲线要​​少得多。例如：underscore.js 是一个库，Ember.js 是一个框架。

* * *

## 回答 #8

> 赞同：46
> 
> 时间：2008-09-29T14:10:09.817

我喜欢 Cohens 的回答，但更专业的定义是：您的代码调用库。**框架调用您的代码**。例如，GUI 框架通过事件处理程序调用您的代码。Web 框架通过一些请求-响应模型调用您的代码。

这也称为*控制反转*- 突然框架决定何时以及如何执行您的代码，而不是像库那样相反。这意味着框架对您如何构建代码也有更大的影响。

* * *

## 回答 #9

> 赞同：30
> 
> 时间：2008-09-29T14:06:23.290

我忘记了我在哪里看到这个定义，但我认为它非常好。

库是您从代码中调用的模块，框架是调用您的代码的模块。

* * *

## 回答 #10

> 赞同：24
> 
> 时间：2016-06-28T11:17:24.677

一个框架可以由不同的库组成。让我们举个例子。

假设您要烹制咖喱鱼。然后，您需要**油**、**香料**和其他**实用程序**等成分。您还需要**鱼**，这是您准备菜肴的基础（这是您的应用程序的数据）。所有成分一起称为一个***框架***。现在你要一个一个地使用它们或组合使用它们来制作你的咖喱鱼，这是你的***最终产品***。将其与由**underscore.js**、**bootstrap.css**、**bootstrap.js**、**fontawesome**、**AngularJS等组成的****Web 框架**进行比较。例如，**Twitter Bootstrap v.35**************.************

 ******现在，如果你只考虑一种成分，比如**油**。你不能使用任何你想要的油，因为那样它会毁了你的鱼（数据）。您只能使用**橄榄油**。将其与**underscore.js**进行比较。现在你想用什么牌子的油取决于你。有些菜是用**美国橄榄油**(underscore.js) 或**印度橄榄油**(lodash.js) 制成的。这只会改变您的应用程序的口味。由于它们的用途几乎相同，因此它们的使用取决于开发人员的偏好，并且它们很容易更换。

[![在此处输入图像描述](https://i.stack.imgur.com/ZbR5p.png)](https://i.stack.imgur.com/ZbR5p.png)

* * *

> **框架**：为您的应用程序提供独特属性和行为的库的集合。（所有成分）
> 
> **库**：一组定义明确的指令，可为您的数据提供独特的属性和行为。（鱼油）
> 
> **插件**：为库（ui-router -> AngularJS）或许多库组合（date-picker -> bootstrap.css + jQuery）构建的实用程序，没有它，您的插件现在可以按预期工作。

* * *

PS AngularJS 是一个 MVC 框架，但它是一个 JavaScript 库。因为我相信库扩展了本机技术（在这种情况下为 JavaScript）的默认行为。

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2008-09-29T14:08:21.927

这就是我的想法（并且已经被其他人合理化了）：

库是包含在您的代码中的东西。框架是您的应用程序的容器。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2008-09-29T14:33:45.690

这里链接了[Joel Spolsky 的一篇苦涩文章](http://discuss.joelonsoftware.com/default.asp?joel.3.219431.12)，但包含工具箱、库、框架等之间的良好区别

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2021-01-12T14:57:17.870

## 我会试着像你五岁一样解释。（没有使用编程术语。）

假设您不久前在您的城市开了一家汉堡餐厅。但是你觉得作为一个初学者做汉堡太难了。您正在考虑一种为客户制作汉堡的简单方法。有人告诉你，如果你使用**framework**，你可以很容易地制作 bugger。你知道有**麦当劳汉堡框架**和**汉堡王汉堡框架。**

如果你使用**McDonald Burger Framework**，制作***巨无霸***汉堡就是这么简单。（但你不能制造 Whopper。）

如果你使用**BurgerKing Burger 框架**，那么制作***皇堡汉堡就是这么简单。***（但是，你不能做巨无霸）

不管怎样，最后，他们都是汉堡。这里重要的是，你必须遵循他们的框架规则来制作汉堡。否则，你会觉得更难做到或无法做到。

你还听说有一个叫做**Simple Burger-Patty Library**的东西。

如果你使用这个库，你可以很容易地制作任何汉堡肉饼（X2 速度）。使用 McDonald Burger Framework 或 BurgerKing Burger Framework 并不重要。无论哪种方式，您仍然可以使用这个**Simple Burger-Patty Library**。（即使你可以在没有框架的情况下使用这个库。）

您现在看到**框架**与**库**之间的区别了吗？

* * *

一旦你开始使用**McDonald Burger Framework**。**切换到BurgerKing Burger Framework**并不容易。因为你必须改变整个厨房。

但是图书馆，换别人会容易得多。或者你可以不使用它。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2008-09-29T14:00:01.590

库为范围狭窄的目的实现功能，而框架往往是为更广泛的功能提供支持的库的集合。例如，库 System.Drawing.dll 处理绘图功能，但它只是整个 .NET 框架的一部分。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2008-09-29T14:07:22.117

我认为库是一组实现目标的实用程序（例如，套接字、密码学等）。框架是库 + RUNTIME EINVIRONNEMENT。例如，ASP.NET 是一个框架：它接受 HTTP 请求、创建页面对象、调用 lyfe cicle 事件等。框架完成所有这些工作，您编写一些代码将在生命周期的特定时间运行当前请求！

无论如何，非常有趣的问题！

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2013-10-12T14:56:25.917

库是为了易于使用和提高效率。例如，您可以说 Zend 库通过其定义良好的类和函数帮助我们完成不同的任务。而框架通常会强制以某种方式实现解决方案，例如 MVC(Model -view-controller）[（参考）](https://stackoverflow.com/questions/7062775/is-jquery-a-javascript-library-or-framework)。它是一个定义良好的系统，用于分配任务，就像在 MVC 中一样。模型包含数据库端，视图用于 UI 接口，控制器用于业务逻辑。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2008-09-29T13:59:36.660

你的解释对我来说听起来很不错......一个**库**可以是任何经过编译和自包含以在其他代码中重用的东西，它的内容实际上没有任何限制。

另一方面，框架预计将具有一系列用于应用程序开发的某些特定领域的设施，就像您的示例 MVC一样**。**

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2008-09-29T14:00:32.663

我认为您很好地确定了区别：该框架提供了一个框架，我们可以在其中进行工作……不知何故，它比简单的库更具“约束力”。
该框架还应该为一组库添加一致性。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2008-09-29T14:03:43.297

库 - 可以用作客户认为适合完成特定任务的任何类或组件集。
框架 - 要求您将某些准则“插入”到比您更大的东西中。您只需以发布所需的方式提供特定于您的应用程序/要求的部分，以便“框架可以让您的生活变得轻松”

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2011-07-27T16:23:52.613

我不记得这个答案的来源（我想我是在互联网上的 .ppt 中找到的），但答案很简单。

库和框架是一组类、模块和/或代码（取决于编程语言），可用于您的应用程序并帮助您解决特定的“问题”。

该问题可能是在应用程序中记录或调试信息、绘制图表、创建特定文件格式（html、pdf、xls）、连接到数据库、创建应用程序的一部分或完整的应用程序或应用于[设计模式](http://en.wikipedia.org/wiki/Design_pattern_%28computer_science%29)。

*您可以拥有一个框架或一个库来解决所有这些问题以及更多问题，通常框架可以帮助您解决更复杂或更大的问题，但这是它们主要区别的连续性，而不是两者的主要定义。*

> **库和框架之间的主要区别在于它们自己的代码之间的依赖关系，换句话说，要使用框架，您需要使用固件中几乎所有的类、模块或代码，但是要使用库，您可以使用一个或您自己的应用程序中的库中的一些类、模块或代码**

这意味着，如果一个框架有，例如，为了在应用程序中使用框架有 50 个类，你需要在代码中使用，比如说，10-15 个或更多类，因为这就是框架的设计方式，有些类（该类的对象）是框架中其他类中方法的输入/参数。请参阅 .NET 框架、Spring 或任何 MVC 框架。

但是例如一个日志库，您可以在代码中使用 Log 类，并帮助您解决“日志记录问题”，这并不意味着日志库在他的代码中没有更多的类，如类处理文件，处理屏幕输出，甚至数据库，但你永远不会在代码中接触/使用这些类，这就是为什么是库而不是框架的原因。

而且还有比框架和库更多的类别，但这不是主题。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2021-07-16T21:37:18.497

基于Erich Gamma 等人在《[*设计模式》一书中给出的定义：*](https://rads.stackoverflow.com/amzn/click/com/0201633612)

*   **库：**一组相关的过程和类组成一个*可重用的实现；*
*   **框架：**一组具有模板方法的协作类，构成*可重用规范。*它设置控制流并允许通过在子类中覆盖框架类中的模板方法调用的钩子方法来挂钩该流，以针对特定问题定制框架。

特定问题的代码可以*使用*库并*实现*框架。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-03-25T21:59:47.290

**库与框架**

[Martin Fowler - InversionOfControl](https://martinfowler.com/bliki/InversionOfControl.html)

库和框架是您的代码的外部代码。它可以是文件（例如`.jar`）、系统代码（操作系统的一部分）等。

`Library`是一组有用的代码。主要关注您的代码。图书馆解决的任务范围很**窄**。例如 - 实用程序、排序、模块化

```
your code ->(has) Library API 
```

`Framework`或`Inversion of Control(IoC) container`[^([关于])](https://stackoverflow.com/a/67401178/4770877)更多。框架解决了**广泛**的任务（特定领域），您将此任务委托给框架。`IoC`- 您的代码取决于框架逻辑、事件......因此框架调用您的代码。它迫使你的代码遵守它的规则（实现/扩展协议/接口/合同），通过 lambdas ......例如 - 测试、GUI、DI 框架......

```
your code ->(has) and ->(implements) Framework API 
```

[[iOS 库与框架]](https://stackoverflow.com/a/59216151/4770877)

[[DIP vs DI vs IoC]](https://stackoverflow.com/a/67401178/4770877)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-12-28T17:59:31.517

我能够整合一些资源并想出这个，我希望这会有所帮助。

## 这是一个“短长”的描述

**什么是图书馆？**

库是由开发人员构建的代码块（可以是变量、函数、类、接口等形式）的集合，以简化其他开发人员发现其相关性的软件开发过程。

**什么是框架？**

参考库的定义，我们可以将框架定义为一种工具，通过在受控的开发环境中为开发人员提供必要的库，帮助开发人员解决大量特定领域的问题。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2021-09-09T17:06:30.547

实际上，这取决于您对术语的定义。那里可能有很多不同的定义。

我认为基于我认为该术语所指的内容，以下是很好的解释：

**确定性库**

确定性库包含基于 a) 函数输入或 b) 以某种方式跨函数调用维护的状态的确定性函数。

如果将逻辑依赖注入到确定性库中，则此类逻辑必须符合具体规范，以便库的输出不受影响。

示例：一个碰撞检测库，由于某种原因，它依赖于一个排序函数来帮助这些计算。这个排序函数可以被配置用于优化目的（例如，通过依赖注入、编译时链接等），但必须始终符合相同的输入/输出映射，以便库本身保持确定性。

**不确定性库**

不确定性库可以通过与它以某种方式获得访问权的其他外部不确定性库通信来保存不确定性函数。

我通常将不确定性库称为服务。

示例：一个扑克库，它依赖于随机数生成器服务来洗牌。这可能是一个不好的例子，因为出于架构目的，我们应该将这个库的不确定性方面推到外面。扑克图书馆可以通过接收预先洗好的一副牌来变得确定性和可单元测试，如果他们愿意，这个图书馆的用户现在有责任随机洗牌。

**框架**

框架介于确定性和不确定性库之间。

依赖注入到框架中的任何逻辑都必须对该函数实例的生命周期具有确定性，但不同逻辑的不同函数实例可以在框架函数的单独执行中注入。

`map`示例：对, `filter`, `sort`,等列表进行操作`reduce`的函数期望接收确定性但对于不同执行可能具有不同逻辑的函数。请注意，仅当这些列表操作将自己宣传为确定性时，才存在此要求。在大多数语言中，列表操作没有这个约束。此类框架的核心逻辑是确定性的，但允许接受不确定性逻辑，风险由用户承担。这通常是一个需要处理的混乱场景，因为由于框架的实现细节，输出可能会有很大差异。

# ruby-on-rails - Silverlight 和 Rails

> ID：148752
> 
> 赞同：2
> 
> 时间：2008-09-29T13:57:21.410
> 
> 标签：ruby-on-rails, silverlight

希望这不会引发一场宗教战争......

我们在 RoR 中有一个基于 Web 的应用程序，它基于我们在 .net 2.0 中构建的早期版本。因此，我们目前在内部拥有 .net 和 RoR 技能。

我们想添加一个与 rails web 应用程序交互的 RIA 应用程序。这应该能够正常运行，并具有一些（可能是相关的）持久性。考虑到我们的内部经验，我们倾向于利用 sliverlight 框架而不是 Flex 等。

将不胜感激您可能有的任何想法。

谢谢

多米尼克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T18:16:51.660

如果您需要应用程序离线运行，您将需要使用纯客户端技术。因此，您正在查看的不是 Silverlight 与 Flex，而是 WPF 与 AIR。

Silverlight 和 Flex 是瘦客户端技术，因此它们都不能很好地适应 RoR，除非您使用 RoR 来构建 Web 服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T14:23:12.500

Flex/Silverlight 之间的选择应该取决于您的技能以及您希望 RIA 做什么。

这里有一个公平的比较：http: [//extremeblue.wordpress.com/2008/04/28/flex-vs-silverlight-my-views/](http://extremeblue.wordpress.com/2008/04/28/flex-vs-silverlight-my-views/)

但我认为你也应该看看像[ExtJS](http://extjs.com)或[JQuery](http://jquery.com)这样的“纯”javascript 解决方案。我们在这两个库 + RoR 方面都有很好的经验。JS 现在很火。Javascript 引擎变得非常快，它是一种可爱的语言（在某些方面）。离线持久性可以通过 Google Gears 或 Adob​​e Air 实现。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-29T14:07:03.210

选择 SilverLight。这太酷了。;)

# vxworks - 有没有Vxworks 中常用的show 例程列表？

> ID：148764
> 
> 赞同：1
> 
> 时间：2008-09-29T13:59:49.907
> 
> 标签：vxworks

在 vxWorks shell 中，您可以使用许多例程来显示有关系统的信息。

这些例程通常被称为**表演**例程，因为它们往往具有“xxxShow”的形式。

是否有这些例程可用的列表？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T00:49:03.257

我使用 VxWorks 5.5 并使用符号查找函数“lkup”来查找我可能感兴趣的函数和/或变量。

执行以下命令，其中 ">" 是 VxWorks shell 提示符。

```
> lkup "Show" 
```

这将输出名称中包含“显示”的符号列表，包括所有“显示”功能。lkup 命令是交互式的，如果有多个控制台屏幕上的符号，它会在继续之前提示您。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T14:01:45.110

没有可用的所有表演例程的完整列表。这取决于您的内核配置和包含的组件。

这里有一些我过去发现有用的表演例程。

adrSpaceShow(details 0, 1) - 显示地址空间的详细信息，包括物理地址、用户区域地址和内核虚拟映射。

envShow(taskId) - 显示给定任务的环境

iosDevShow - 显示加载的 I/O 设备

iosDrvShow - 显示 I/O 设备驱动功能表

iosFdShow - 显示打开的文件描述符

memShow - 显示内存使用统计信息

moduleShow - 显示下载的模块

objShowAll - 显示系统中所有对象的列表（信号量、任务、msgQs 等...）

objShow (objectId) - 显示对象的详细信息

# c# - 如何移动数组中的项目？

> ID：148786
> 
> 赞同：1
> 
> 时间：2008-09-29T14:05:33.107
> 
> 标签：c#, data-structures

我有一系列时间敏感的项目。一段时间后，最后一个项目需要脱落，并在开始时放置一个新项目。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-29T14:08:22.427

我建议使用队列，只是数组或列表的一个特殊实例。当您的定时事件发生时，从队列中弹出最后一个项目，然后推送您的新项目。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-29T14:12:03.527

使用数组执行此操作的最简单方法可能是使用循环索引。与其总是查看 array[n]，不如引用 array[cIndex]（其中 cIndex 指的是数组中被索引的项目（cIndex 基于 arraySize (cIndex % arraySize) 递增）。

当您选择删除数组中最旧的项目时，您只需引用位于 ((cIndex + (arraySize - 1)) % arraySize) 的元素。

或者，您可以使用linkedList 方法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-29T14:06:51.823

请改用[队列](http://msdn.microsoft.com/en-us/library/system.collections.queue.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T14:08:09.137

通过使用队列，最好使用链表实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T14:08:32.723

看看[使用队列](http://www.functionx.com/csharp1/examples/linkedlist.htm)而不是简单的数组。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-29T14:09:00.787

如果有固定数量的项目，队列将起作用。

鉴于“时间量”是已知的，那么如何使用具有 DateTime 键的 SortedDictionary 并覆盖 Add 方法以删除所有具有太旧键的项目。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-29T14:09:34.220

[LinkedList<T>](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)具有应该可以完美运行的 AddFirst 和 RemoveLast 成员。

编辑：查看 Queue 文档，他们似乎使用了内部数组。只要实现使用循环数组类型的算法性能应该没问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-29T14:10:02.767

在 csharp 3 中，您可以执行以下操作：

```
original = new[] { newItem }.Concat(
    original.Take(original.Count() - 1)).ToArray() 
```

但是您最好使用专门的数据结构

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-29T14:11:58.737

`Queue`非常适合 FIFO 数组。例如，对于通用数组处理，使用[List(T)](http://msdn.microsoft.com/en-us/library/d9hw1as6.aspx)和 `Insert(0, x)`方法`RemoveAt(0)`在列表前面放置或删除项目。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-29T14:36:21.533

从技术上讲，您需要一个双端队列。队列仅在一端推送和弹出项目。双端队列在两端都是开放的。

大多数语言都允许数组操作，只需删除第一个元素并将另一个元素放在最后。

或者，您可以通过循环移动每个元素。只需用它的邻居替换每个元素（从最旧的开始）。然后将新项目放在最后一个元素中。

如果您知道您的双端队列不会超过某个大小，那么您可以将其设为圆形。你需要两个指针来告诉你两端在哪里。添加和删​​除项目将相应地增加/减少您的指针。您必须检测缓冲区溢出情况（即您的指针“交叉”）。而且您必须使用模运算，以便您的指针围绕数组转一圈。

或者您可以为数组中的每个元素加上时间戳，并在它们变得太“旧”时将其删除。您可以通过保持一个单独的数组以相同的方式索引来实现这一点，或者通过一个由两个元素数组组成的数组，并将时间戳存储在其中一个子元素中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-29T16:48:20.390

如果您正在寻找执行此操作的*最快*方法，它将是一个循环数组：您跟踪数组中的当前位置 (ndx) 和数组的末尾 (end)，因此当您插入一个项目，您隐式消除了最旧的项目。

循环数组是我所知道的固定大小队列的最快实现。

例如，在 C/C++ 中，整数看起来像这样（当你得到 0 时退出）：

```
int queue[SIZE];
int ndx=0;      // start at the beginning of the array
int end=SIZE-1;
int newitem;
while(1){
  cin >> newitem;
  if(!newitem)  // quit if it's a 0
    break;
  if(ndx>end)   // need to loop around the end of the array
    ndx=0;
  queue[ndx] = newitem;
  ndx++
} 
```

可以做很多优化，但如果你想自己构建它，这是最快的路线。

如果您不关心性能，请使用随附的 Queue 对象，因为它应该是通用的。

它可能会优化也可能不会优化，也可能不支持固定大小的列表，所以在使用之前一定要检查它的文档。

# .net - 在多个 DLL 中拥有命名空间有什么影响？

> ID：148790
> 
> 赞同：2
> 
> 时间：2008-09-29T14:06:32.337
> 
> 标签：.net, asp.net, namespaces

我继承了一个生成 2 个 DLLS 的 VB.net 项目：一个用于 Web 应用程序，另一个用于“业务层”。这是针对较大网站的子应用程序。（使用 VS2005）。

问题是 DLL 和命名空间结构的某些东西不正确，我想知道是否有任何性能影响。

主网络应用程序是“Foo”，并生成 Foo.dll。Foo.dll 包含命名空间 App.Foo，其中包含所有页面、用户控件等的类。

还有一个生成 FooLib.dll 的项目“FooLib”。FooLib.dll 还包含一个 App.Foo 命名空间，其中包含一堆类定义。还有一些其他命名空间，如 App.Foo.Data、App.Foo.Logic 等。

这有什么问题吗？运行时如何跨多个 DLL 找到一个类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T14:12:49.703

这没有任何问题，唯一可能的问题可能是 1) 看到“App.Foo.Something”的开发人员可能不知道在哪个程序集中查找 2) 如果在两者中使用相同的名称，则应用程序编译针对（在 c# 中最少) 将得到关于模棱两可的类型名称的错误。

至于运行时，类型由程序集和名称指定 - 命名空间只是类型名称的一部分。因此，运行时查找类型将毫无问题 - 当您编译有关要在哪个程序集中编译的信息时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T14:13:25.880

当您的程序被编译时，完整的类型名称与“证据”一起包括在内。该证据包括程序集的名称和版本信息。否则它不会知道您是否想要 1.0 或 1.1 或 2.0 版本的类。这个相同的系统允许它在不同程序集中的相同命名空间中找到不同的类。

就性能而言，没有太大的影响。从有利的方面来说，这意味着你的一些东西可以在不同的时间加载，这通常是想要的效果。

命名空间是以一种易于查找的方式打包功能。程序集是以一种高效加载的方式打包功能。有时它们并不相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T14:19:27.487

不，这没有什么问题。

考虑一下，我使用了许多自定义类库，几乎每个类库都具有以下命名空间结构：

> .Web.UI.Controls。

这与 System.Web.UI.Controls 类似（并由 MS 建议为最佳实践）。

问题是编译器将知道在您分配的尽可能多的 DLL 中存在正确的命名空间（它将在两个 DLL 中搜索它）。我犹豫以这种方式使它们完全相同的唯一原因是因为开发人员可能会**感到**困惑。另一个原因是，如果每个命名空间都有一个名为完全相同的类 - 这将抛出编译器错误，直到使用完全命名的命名空间声明解决它。

这是您可以使用别名命名空间的部分原因。别名将解决这两个概念。它的结构如下所示：

```
using Foo.App.Foo;
using FooLib = FooLib.App.Foo; 
```

因此，如果您在 Foo.App.Foo 和 FooLib.App.Foo 中都有一个 Bar 类，以访问您将使用的应用程序版本：

```
bar x = new bar(); 
```

对于您要使用的库版本：

```
FooLib.bar x = new FooLib.bar(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T14:11:00.767

不，覆盖的名称空间没有任何问题。看看覆盖了许多命名空间的 .net 框架本身。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T14:12:34.257

命名空间不存在于 IL 级别。运行时从一个伪全限定名中找到一个类，即以其命名空间为前缀的类型的名称。

我认为这样做不存在技术问题，事实上 .NET Framework 本身有时会跨多个物理程序集使用相同的命名空间。

命名空间不是 .NET 世界中的一等公民，对此我感到遗憾。

# sql - 检索表交集的标准 SQL 查询是什么？

> ID：148795
> 
> 赞同：6
> 
> 时间：2008-09-29T14:07:19.420
> 
> 标签：sql

选择工会：

```
select * from table1 
union 
select * from table1_backup 
```

选择交叉点的查询是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-29T14:08:33.410

在 SQL Server 中[相交](http://msdn.microsoft.com/en-us/library/ms188055.aspx)

> ```
> select * from table1 
> intersect
> select * from table1_backup 
> ```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-29T14:15:43.017

```
SELECT *
FROM table1
WHERE EXISTS
(SELECT *
FROM table1_backup
WHERE table1.pk = table1_backup.pk) 
```

作品

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T03:03:31.300

对于这样的问题，我倾向于回到这个视觉资源：

[SQL 连接的可视化解释](http://blog.codinghorror.com/a-visual-explanation-of-sql-joins/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T14:09:32.923

我认为内部连接：假设 T1 和 T2 具有相同的结构：

select T1.* from T1 inner join T2 on T1.pkField = T2.pkField

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T14:11:07.180

“相交”也是标准 SQL 的一部分。

内连接给出了不同的答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-06T23:30:50.360

这是mySQL的解决方案：

```
CREATE TABLE table1(
id INT(10),
fk_id INT(10),
PRIMARY KEY (id, fk_id),
FOREIGN KEY table1(id) REFERENCES another_table(id),
FOREIGN KEY table1(fk_id) REFERENCES other_table(id)
);

SELECT table1.* FROM table1 as t0
INNER JOIN table1 as a ON (t0.id = a.id and fk_id=1)
INNER JOIN table1 as b ON (t0.id = b.id and fk_id=2)
INNER JOIN table1 as c ON (t0.id = c.id and fk_id=3)
ORDER BY table1.id; 
```

基本上你有一个带有属性 id 的数学子集表（即 1={1, 2 ,3}, 2={3, 4, 2}, ... , n={1, 4, 7}），它是集合编号，fk_id 引用元素表的主键，即超集（表示大括号中数字的可能值）。对于那些不喜欢数学的人，让我们假设你有一个表，'other_table'，它是一个项目列表，还有另一个表，'another_table'，它是一个事务号列表，两个表形成一个多对-many 关系，从而产生'table1'。现在让我们假设您想知道 'another_ table' 中的 id，其中包含项目 1、2 和 3。这就是执行此操作的查询。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-15T11:37:15.357

可以通过以下方式在两个相同的表 a 和 b 上进行相交：

```
SELECT a.id, a.name
FROM a INNER JOIN b
USING (id, name) 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-12-29T14:16:06.890

子查询？！真的吗？

得到 table1 和 table2 的交集：

```
SELECT * FROM table1, table2 WHERE table1.pk=table2.pk; 
```

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2008-09-29T14:13:31.620

```
select distinct * from (select * from table1 union select * from table1_backup) 
```

# sql - 如何通过安装程序部署复杂的 SQL 解决方案？

> ID：148798
> 
> 赞同：2
> 
> 时间：2008-09-29T14:08:07.483
> 
> 标签：sql, database, installation

我正在开发的产品的部分安装程序会安装数据库更新实用程序。该实用程序检查用户数据库的当前版本，并（如有必要）执行一系列 SQL 语句，将数据库升级到当前版本。

此例程的两个主要特点：

*   启动后，无需用户交互即可运行
*   SQL 操作保持用户数据的完整性

目标是使最终用户的设置/数据库例程尽可能简单（目标受众是非技术人员）。但是，我发现在某些情况下，这两个功能是不一致的。例如，我想为我的一个表添加一个唯一索引——但现有数据可能已经违反了这个规则。我可以：

*   默默地为用户选择什么是“正确的”并丢弃（或归档）数据；或者
*   让用户了解什么是唯一索引，并让他们选择哪些数据去哪里

这两种选择听起来都不吸引我。我可以妥协，根本不创建唯一索引，但这很糟糕。我想知道其他人在这种情况下会怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T14:20:49.480

从 Red-Gate 查看 SQL Packager。我没有亲自使用过它，但是这些人总体上是很好的工具，这似乎可以满足您的需求。它让您修改脚本以自定义安装： [http ://www.red-gate.com/products/SQL_Packager/index.htm](http://www.red-gate.com/products/SQL_Packager/index.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T16:50:33.550

您永远不会丢弃用户数据。一种可能的选择是尝试创建唯一索引。如果索引创建失败，让他们知道它失败了，告诉他们需要研究什么，并为他们提供一个脚本，如果他们发现他们选择修复的数据错误可以运行。

# c++ - 如何在 Visual C++ 2008 中查找未使用的属性/方法

> ID：148807
> 
> 赞同：8
> 
> 时间：2008-09-29T14:09:24.017
> 
> 标签：c++, visual-studio, visual-studio-2008, visual-c++, static-analysis

有没有办法在 Visual C++ 2008 Professional 中识别未使用的属性/方法？如果默认情况下不可能，也非常感谢 3rd-party 工具的推荐。

谢谢，
弗洛里安

**编辑：** nDepend 仅适用于 .NET 程序集。我正在寻找可以与本机 C++ 应用程序一起使用的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-30T11:28:52.833

试试[PC-Lint](http://www.gimpel.com/)。它非常擅长查找冗余代码。我还没有尝试过版本 9。版本 8 确实需要一些时间来配置。尝试在线交互式演示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T09:18:56.187

我没有亲自使用过他们的生产力工具（我使用他们的 windows 控制套装），但看起来 DevExpress 有一个名为[Refactor 的 C++ refactor'er！对于 C++](http://www.devexpress.com/Products/Visual_Studio_Add-in/RefactorCPP/)。我没有立即发现您正​​在寻找的功能，但也许他们有？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T13:21:26.883

棘手的一点是 C++ 中的许多函数必须存在，即使它们没有被调用。Boost 尤其会导致这种情况，但即使是常规的 STL 代码也可以做到这一点。你的代码必须配合。您可能会定义一个复制 ctor，因为 std::vector 正式需要它。但是，如果您不实例化任何实际复制 T 的 std::vector 成员，则您的复制 ctor 将保持未使用状态。

即使他们不必这样做，他们也经常为了安全而存在。例如，声明私有复制构造函数可以防止对象意外复制。如果没有 private 声明，编译器将为您定义一个公共的、按成员的复制 ctor。现在，这是“未使用”吗？你想被警告吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T13:22:36.147

Coverage Validator 可以显示未使用的 C++ 代码（但不能显示属性）。它是动态执行的，因此您必须“执行”应用程序才能获得结果： [http ://successfulsoftware.net/2008/03/10/coverage-validator/](http://successfulsoftware.net/2008/03/10/coverage-validator/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T22:21:37.210

PC-Lint 非常强大，但很难精简。当然，这很好地描述了 C 和 C++，不是吗？

我认为非常棒的另一个工具是 Whole Tomato 的**Visual Assist X**，它直接集成到 IDE 中。

在搜索未引用的代码时，C++ 中有一些大问题：模板、回调和消息处理程序可能对您的项目很重要，但从不直接调用。例如，线程的处理程序不是直接调用的，而是创建新线程时的参数。MFC 或 WTL 项目中的“On_buttonpress”类型消息也将显示为未调用的方法。

找到它们后，您可以将 PC-Lint 配置为忽略这些，但第一次需要大量工作。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-29T14:22:30.350

[nDepend](http://www.ndepend.com/)会这样做，以及打扫你的房子和带狗去散步。有一个免费的 nagware 版本。

以下代码查询语言语句将为您提供未使用方法的列表

```
 WARN IF Count > 0 IN SELECT TOP 10 METHODS WHERE MethodCa == 0 AND 
   !IsPublic AND !IsEntryPoint AND !IsExplicitInterfaceImpl AND 
   !IsClassConstructor AND !IsFinalizer 
```

# asp.net - 使用选择器通过 ASP.NET 获取服务器上的文件列表

> ID：148817
> 
> 赞同：3
> 
> 时间：2008-09-29T14:10:10.100
> 
> 标签：asp.net

是否有可用的组件列表 FileUpload 显示服务器上的文件，而不是客户端？

我基本上是在寻找一个干净的对话框来选择服务器端文件，比如 FileUpload 中使用的那个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T14:29:38.693

没有。没有。也就是说，您可以使用列表框并将文件加载到其中。

```
public sub file_DatabindListbox(directoryPath as string)
   for each fName as string in io.directory(directorypath).getfilenames()
     dim li as new listitem 
     li.text = io.path.getfilename(fName)
     li.value = fName
     myFileListbox.Items.Add(li)
   next
end sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T20:16:50.247

您不能以与使用 FileUpload 组件相同的方式浏览服务器的文件夹，因为...所有文件都位于服务器上，而您所指的“干净对话框”是客户端。您可以编写自己的代码以在下拉列表中列出文件。但是，如果您的文件位于多个文件夹中，并且您想保留一些结构，则 TreeView 可能会使用以下方法来解决问题：

```
protected void Page_Load(object sender, EventArgs e)
{
        SetChildFolders(trvFiles.Nodes, @"C:\MyFolder");
}

    private void SetChildFolders(TreeNodeCollection nodes, string path)
    {
        foreach (string directory in Directory.GetDirectories(path))
        {
            DirectoryInfo dirInfo = new DirectoryInfo(directory);
            TreeNode node = new TreeNode(dirInfo.Name, dirInfo.FullName);

            SetChildFolders(node.ChildNodes, dirInfo.FullName);
            SetChildFiles(node.ChildNodes, dirInfo.FullName);

            trvFiles.Nodes.Add(node);
        }
    }

    private void SetChildFiles(TreeNodeCollection nodes, string path)
    {
        foreach (string file in Directory.GetFiles(path))
        {
            FileInfo fileInfo = new FileInfo(file);
            nodes.Add(new TreeNode(fileInfo.Name, fileInfo.FullName));
        }
    } 
```

您当然可以通过多种方式设置树视图的样式。

# java - 如何在 Java 中模拟 C# 作为运算符

> ID：148828
> 
> 赞同：55
> 
> 时间：2008-09-29T14:11:56.647
> 
> 标签：java, casting

在某些情况下，让类型转换返回空值而不是抛出 ClassCastException 是切实可行的。C# 具有`as`执行此操作的运算符。Java中是否有等效的东西，所以您不必显式检查ClassCastException？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-09-29T14:36:16.167

正如@Omar Kooheji 所建议的，这是as 的实现：

```
public static <T> T as(Class<T> clazz, Object o){
    if(clazz.isInstance(o)){
        return clazz.cast(o);
    }
    return null;
}

as(A.class, new Object()) --> null
as(B.class, new B())  --> B 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-29T14:15:04.657

我认为你必须自己动手：

```
return (x instanceof Foo) ? (Foo) x : null; 
```

编辑：如果您不希望您的客户端代码处理空值，那么您可以引入一个[空对象](http://en.wikipedia.org/wiki/Null_Object_pattern)

```
interface Foo {
    public void doBar();
}
class NullFoo implements Foo {
    public void doBar() {} // do nothing
}
class FooUtils {
    public static Foo asFoo(Object o) {
        return (o instanceof Foo) ? (Foo) o : new NullFoo();
    }
}
class Client {
    public void process() {
        Object o = ...;
        Foo foo = FooUtils.asFoo(o);
        foo.doBar(); // don't need to check for null in client
    }
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-09-29T14:14:14.333

您可以使用`instanceof`关键字代替 C# 的`is`，但没有`as`.

例子：

```
if(myThing instanceof Foo) {
   Foo myFoo = (Foo)myThing; //Never throws ClassCastException
   ...
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-29T14:33:19.247

您可以像这样编写静态实用程序方法。我认为它的可读性不是很强，但它是您尝试做的最好的近似值。如果你使用静态导入，它在可读性方面也不会太糟糕。

```
package com.stackoverflow.examples;
public class Utils {
    @SuppressWarnings("unchecked")
    public static <T> T safeCast(Object obj, Class<T> type) {
        if (type.isInstance(obj)) {
            return (T) obj;
        }
        return null;
    }
} 
```

这是一个测试用例，它演示了它是如何工作的（并且它确实有效。）

```
package com.stackoverflow.examples;
import static com.stackoverflow.examples.Utils.safeCast;
import static junit.framework.Assert.assertNotNull;
import static junit.framework.Assert.assertNull;

import org.junit.Test;

public class UtilsTest {

    @Test
    public void happyPath() {
        Object x = "abc";
        String y = safeCast(x, String.class);
        assertNotNull(y);
    }

    @Test
    public void castToSubclassShouldFail() {
        Object x = new Object();
        String y = safeCast(x, String.class);
        assertNull(y);
    }

    @Test
    public void castToUnrelatedTypeShouldFail() {
        Object x = "abc";
        Integer y = safeCast(x, Integer.class);
        assertNull(y);
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-02-12T08:00:33.277

在 java 8 中，您还可以将流语法与 Optional 一起使用：

```
Object o = new Integer(1);

Optional.ofNullable(o)
        .filter(Number.class::isInstance)
        .map(Number.class::cast)
        .ifPresent(n -> System.out.print("o is a number")); 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-09-29T14:16:45.730

我推测您可以适当地创建一个 as 运算符

就像是

```
as<T,Type> (left, right)  
which evaluates to 
if (typeof(left) == right)
   return (right)left
else
    return null 
```

我不知道你会怎么做，我现在是 ac#，自从我离开大学后，我的 Java 帽子变得有点尘土飞扬。

# clr - .Net 4.0 将包含新的 CLR 还是保留 2.0 版

> ID：148833
> 
> 赞同：14
> 
> 时间：2008-09-29T14:12:53.040
> 
> 标签：clr, .net-4.0, versioning, dynamic-language-runtime

.Net 4.0 会使用新版本的 CLR（v2.1、3.0）还是会继续使用现有的 v2.0？

补充：是否有可能继续使用 CLR v2.0 并添加 DLR v1.0？

更新：虽然这看起来像是一个无法回答的推测性问题，但 VS 团队似乎正在发布越来越多的关于 VS10 和 .Net 4.0 的信息，因此可能很快就不是这样了。（此处提供信息-> [http://msdn.microsoft.com/en-us/vstudio/products/cc948977.aspx](http://msdn.microsoft.com/en-us/vstudio/products/cc948977.aspx)）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-18T23:26:17.470

是的，.NET 4.0 将引入新版本的 CLR（也将是 4.0）。DLR 本质上将成为核心框架的一部分，但它仍将位于 CLR 之上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-29T14:16:41.503

4.0 将是我所读内容的另一个并行版本。

[http://blogs.msdn.com/wenlong/archive/2008/09/07/net-4-0-wf-wcf-and-oslo.aspx](http://blogs.msdn.com/wenlong/archive/2008/09/07/net-4-0-wf-wcf-and-oslo.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-17T00:58:55.490

换一种说法——根据微软的[Visual Studio 2010 和 .NET Framework 4 Training Kit](http://www.microsoft.com/downloads/details.aspx?familyid=752CB725-969B-4732-A383-ED5740F02E93&displaylang=en) ——4.0 将独立存在（即，***不会***像 3.0 或 3.5 那样位于 2.0 之上）。全新的框架和全新的 CLR。

就 DLR 而言，它就像 Linq、WinForms 和 WPF 一样位于 BCL 之上（即 DLR -> BCL -> CLR）

要查看详细介绍此内容的 PowerPoint 幻灯片，请单击“Overview”（右侧）->“Lap Around the .NET Framework 4”，然后单击同名的 PowerPoint 幻灯片。看第二张和第三张幻灯片。

# .net - 如何在 .NET 中通过网络更新应用程序？

> ID：148834
> 
> 赞同：4
> 
> 时间：2008-09-29T14:13:06.987
> 
> 标签：.net, vb.net, service

我需要在几台 PC 上安装一些 .NET 软件。

该软件每次重新启动时都需要检查服务器上是否存在更新的版本。

最终用户将拥有基本用户权限，因此无法将文件复制到“Program Files”目录。

如果存在较新版本，则应用程序关闭，更新程序从服务器复制文件，然后重新启动应用程序。

但是，我想构建我的更新程序，使其独立于应用程序。即，我会向更新程序发送一个 ID，告诉它要更新哪个应用程序。

然后，如果文件服务器名称被更改，我想让它仍然工作。

我想我可以使用具有管理员权限的服务来复制文件。

1.  有没有一个班级已经在做这种事情了？
2.  当我考虑使用已安装的服务时，我是否走在正确的轨道上？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-29T14:16:21.440

[.NET Framework 有一个名为clickonce](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx)的内置功能，它可以完全满足您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-29T14:18:55.477

查看[ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx)部署。它涵盖了您所要求的几乎所有内容。它不会按 ID 更新应用程序，但它确实确保每个应用程序都更新到最新，而无需您为每个应用程序编写任何更新代码。它不会自动处理文件服务器名称的更改，但您可以根据需要指向您的链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T14:15:27.823

[应用程序更新程序块](http://msdn.microsoft.com/en-us/library/ms978574.aspx)对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T14:20:22.430

1) 取决于您使用的 .NET 版本。>=2.0 您可以部署可以检查网络路径以获取更新版本的智能应用程序，然后在必要时进行更新。

2）如果你被困在 1.1（像我一样:-()，在登录时运行的服务或计划任务都可以正常工作，这就是我们在这里所做的。我们保留一些数据库表来跟踪谁拥有最新版本的什么。

-伊恩

# ruby-on-rails - 如何在 Windows 中为 Ruby on Rails 配置 Apache 2.2？

> ID：148838
> 
> 赞同：10
> 
> 时间：2008-09-29T14:13:48.890
> 
> 标签：ruby-on-rails, ruby, apache

我正在尝试开始编写一些 Ruby on Rails 应用程序并在 Mongrel 上取得了成功，但是我想将我的应用程序部署到 Windows 上的 Apache 2.2 实例？我发现的所有教程似乎都过时了，并且适用于旧版本的 Apache/Rails。

有谁知道为 Ruby on Rails 应用程序配置 Apache 2.2 的一个很好的当前教程？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-29T14:35:54.687

**编辑：**至少在有一个 Phusion 乘客获胜之前，Apache + Mongrel 是要走的路。您可以在没有 Mongrel 的情况下使用 Apache + FastCGI，但在实际负载下，您将获得（更多）僵尸进程和（更多）内存泄漏。

您还可以按照下面详述的相同方式查看代理到[Thin 。](http://code.macournoyer.com/thin/)但是，我在使用 Thin on Win 时遇到了一些不稳定性，尽管它明显更快。AB（Apache Benchmark）是您的朋友！

在 Windows 上配置 Apache + Mongrel 与 *nix 没有太大区别。

本质上，您需要将进入 Apache 的请求代理到 Mongrel。这归结为是这样的：

```
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
<VirtualHost localhost:80>
    ServerName www.myapp.comm
    DocumentRoot "C:/web/myapp/public"
    ProxyPass / http://www.myapp.com:3000/
    ProxyPassReverse / http://www.myapp.com:3000/
    ProxyPreserveHost On
</VirtualHost> 
```

把它贴在你的`httpd.conf`（或者`httpd-vhost.conf`如果你包括它的话）。

它假定您将在端口 3000 上运行 mongrel，您的 Rails 根目录位于 中`C:\web\myapp`，并且您将访问 www.myapp.com 上的应用程序。

要在生产模式下运行 rails 应用程序：

```
mongrel_rails start -p 3000 -e production 
```

走开（实际上 mongrel 默认为端口 3000，因此您可以`-p 3000`根据需要跳过）。

主要区别在于您不能在 Windows 上对 mongrel 进行守护程序（即使其在后台运行）。`mongrel_service`相反，您可以使用gem将其安装为服务。

此外，运行集群更复杂，您将无法使用 Capistrano。如果您想了解更多信息，请告诉我。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-30T16:45:59.790

我是 RoR 的新手，并且一直在 Windows Server 2008 上尝试同样的事情，这里有一些关于让 mongrel 成为服务的附加说明：

如果在安装 mongrel_service 时出现编译错误：

```
gem install mongrel_service 
```

通过指定您的平台尝试使用二进制文件：

```
gem install mongrel_service --platform x86-mswin32 
```

此外，要实际安装服务，您需要在 RoR 的应用程序目录中运行此命令：

```
mongrel_rails service::install --name MyApp -e production -p 3001 -a 0.0.0.0 
```

（或删除：

```
mongrel_rails service::remove --name MyApp 
```

)

然后您应该能够在 Windows 服务控制面板中启动/停止应用程序“MyApp”。

希望对某人有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-22T19:13:08.670

目前 Mongrel 不能在 Ruby 1.9 上正常工作，并且在执行命令 mongrel_rails 时会抛出“msvcrt-ruby18.dll not found”错误。

在这种情况下，薄似乎是目前唯一的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-13T20:26:43.437

我只是想将这篇文章添加到列表中。它解释了如何让 Apache 提供 ruby​​ 文件，而无需安装任何其他应用程序。

[http://editrocket.com/articles/ruby_apache_windows.html](http://editrocket.com/articles/ruby_apache_windows.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-16T10:16:17.297

你可能想试试[Bitnami RubyStack](http://bitnami.com/stack/ruby)

# asp.net-mvc - 带有 Ajax 的 ASP.net MVC

> ID：148839
> 
> 赞同：4
> 
> 时间：2008-09-29T14:14:03.053
> 
> 标签：asp.net-mvc, ajax

有人知道关于将 Ajax 与 ASP.net MVC 结合使用的最新教程吗？我能找到的大部分内容似乎都在谈论旧版本的 MVC，我怀疑这是一个最近发生了很多变化的领域。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T14:23:50.190

斯蒂芬沃尔特刚刚写了一篇关于这个的博客： [http ://weblogs.asp.net/stephenwalther/archive/2008/09/22/asp-net-mvc-application-building-forums-6-ajax.aspx](http://weblogs.asp.net/stephenwalther/archive/2008/09/22/asp-net-mvc-application-building-forums-6-ajax.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T14:32:30.107

Stephen Walter 的帖子“ [ASP.NET MVC 应用程序构建：论坛#6 – Ajax](http://weblogs.asp.net/stephenwalther/archive/2008/09/22/asp-net-mvc-application-building-forums-6-ajax.aspx) ”似乎专注于 Microsoft ASP.NET AJAX。

在 google 上快速搜索“ [ASP.NET MVC jquery](http://www.google.ca/search?q=asp.net+mvc+jquery&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a) ”会找到一些关于非 MS javascript 的资源。

我倾向于非 MS AJAX 演示和教程，因为它们展示了与平台无关的模式和实践。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T16:23:47.820

如果您正在 MVC 中寻找与表单相关的 Ajax 支持，请查看 Scott Hanselman 的帖子：

[http://www.hanselman.com/blog/ASPNETMVCPreview4UsingAjaxAndAjaxForm.aspx](http://www.hanselman.com/blog/ASPNETMVCPreview4UsingAjaxAndAjaxForm.aspx)

目前似乎对使用 Ajax 表单的端到端验证没有很好的支持。我读过的大多数文章都使用客户端库和服务器端数据注释的组合。我希望 MVC 的完整 beta 版本将包含更好的支持。

另外，请务必注意，Microsoft 会将 jQuery 作为 Ajax 开发的官方支持库包括在内。斯科特·格思里（Scott Guthrie）在以下位置宣布了这一点：

[http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)

# python - 在 urllib2 中缓存？

> ID：148853
> 
> 赞同：13
> 
> 时间：2008-09-29T14:17:13.530
> 
> 标签：python, caching, urllib2

使用我忽略的 urllib2 时，是否有一种简单的方法来缓存内容，或者我必须自己滚动？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-29T15:21:56.870

如果您不介意在稍低的级别上工作，httplib2 ( [https://github.com/httplib2/httplib2](https://github.com/httplib2/httplib2) ) 是一个包含缓存功能的优秀 HTTP 库。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-29T14:25:07.443

这个 ActiveState Python 配方可能会有所帮助： [http ://code.activestate.com/recipes/491261/](http://code.activestate.com/recipes/491261/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-29T18:03:38.260

您可以使用装饰器功能，例如：

```
class cache(object):
    def __init__(self, fun):
        self.fun = fun
        self.cache = {}

    def __call__(self, *args, **kwargs):
        key  = str(args) + str(kwargs)
        try:
            return self.cache[key]
        except KeyError:
            self.cache[key] = rval = self.fun(*args, **kwargs)
            return rval
        except TypeError: # incase key isn't a valid key - don't cache
            return self.fun(*args, **kwargs) 
```

并按照以下方式定义一个函数：

```
@cache
def get_url_src(url):
    return urllib.urlopen(url).read() 
```

这是假设您不关注 HTTP 缓存控制，而只是想在应用程序运行期间缓存页面

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-11-09T21:22:44.303

我一直在使用 httplib2（它在处理 HTTP 缓存和身份验证方面做得很好）和 urllib2（它位于 stdlib 中，具有可扩展的接口并支持 HTTP 代理服务器）之间纠结。

[ActiveState 配方](http://code.activestate.com/recipes/491261/)开始向 urllib2 添加缓存支持，但只是以非常原始的方式。它无法实现存储机制的可扩展性，无法对文件系统支持的存储进行硬编码。它也不支持 HTTP 缓存标头。

为了将 httplib2 缓存和 urllib2 可扩展性的最佳特性结合在一起，我调整了 ActiveState 配方以实现与 httplib2 中的大部分相同的缓存功能。该模块在 jaraco.net 中为[jaraco.net.http.caching](http://bitbucket.org/jaraco/jaraco.net/src/65af6e442d21/jaraco/net/http/caching.py)。链接指向在撰写本文时存在的模块。虽然该模块目前是较大的 jaraco.net 包的一部分，但它没有包内依赖项，因此请随意将模块拉出并在您自己的项目中使用它。

或者，如果你有 Python 2.6 或更高版本，你可以`easy_install jaraco.net>=1.3`使用 CachingHandler 和`caching.quick_test()`.

```
"""Quick test/example of CacheHandler"""
import logging
import urllib2
from httplib2 import FileCache
from jaraco.net.http.caching import CacheHandler

logging.basicConfig(level=logging.DEBUG)
store = FileCache(".cache")
opener = urllib2.build_opener(CacheHandler(store))
urllib2.install_opener(opener)
response = opener.open("http://www.google.com/")
print response.headers
print "Response:", response.read()[:100], '...\n'

response.reload(store)
print response.headers
print "After reload:", response.read()[:100], '...\n' 
```

请注意，jaraco.util.http.caching 没有为缓存的后备存储提供规范，而是遵循 httplib2 使用的接口。因此，httplib2.FileCache 可以直接与 urllib2 和 CacheHandler 一起使用。此外，为 httplib2 设计的其他后备缓存应该可供 CacheHandler 使用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-14T12:05:00.140

我正在寻找类似的东西，并遇到了danivo 发布[的“Recipe 491261: Caching and throttling for urllib2”](http://code.activestate.com/recipes/491261/)。问题是我*真的*不喜欢缓存代码（大量重复，大量手动加入文件路径而不是使用 os.path.join，使用静态方法，非常 PEP8'sih，以及我试图避免的其他事情）

代码稍微好一点（无论如何我认为），并且在功能上大致相同，只是添加了一些内容 - 主要是“recache”方法（示例用法[可以在此处查看](http://github.com/dbr/tvdb_api/blob/f72c4ad3e53a934c4bade21876b4f7185b645866/tvdb_api.py#L412-453)，或在`if __name__ == "__main__":`代码末尾的部分中查看）。

最新版本可以在[http://github.com/dbr/tvdb_api/blob/master/cache.py](http://github.com/dbr/tvdb_api/blob/master/cache.py)找到，我将它粘贴在这里以供后代使用（删除了我的应用程序特定的标头）：

```
#!/usr/bin/env python
"""
urllib2 caching handler
Modified from http://code.activestate.com/recipes/491261/ by dbr
"""

import os
import time
import httplib
import urllib2
import StringIO
from hashlib import md5

def calculate_cache_path(cache_location, url):
    """Checks if [cache_location]/[hash_of_url].headers and .body exist
    """
    thumb = md5(url).hexdigest()
    header = os.path.join(cache_location, thumb + ".headers")
    body = os.path.join(cache_location, thumb + ".body")
    return header, body

def check_cache_time(path, max_age):
    """Checks if a file has been created/modified in the [last max_age] seconds.
    False means the file is too old (or doesn't exist), True means it is
    up-to-date and valid"""
    if not os.path.isfile(path):
        return False
    cache_modified_time = os.stat(path).st_mtime
    time_now = time.time()
    if cache_modified_time < time_now - max_age:
        # Cache is old
        return False
    else:
        return True

def exists_in_cache(cache_location, url, max_age):
    """Returns if header AND body cache file exist (and are up-to-date)"""
    hpath, bpath = calculate_cache_path(cache_location, url)
    if os.path.exists(hpath) and os.path.exists(bpath):
        return(
            check_cache_time(hpath, max_age)
            and check_cache_time(bpath, max_age)
        )
    else:
        # File does not exist
        return False

def store_in_cache(cache_location, url, response):
    """Tries to store response in cache."""
    hpath, bpath = calculate_cache_path(cache_location, url)
    try:
        outf = open(hpath, "w")
        headers = str(response.info())
        outf.write(headers)
        outf.close()

        outf = open(bpath, "w")
        outf.write(response.read())
        outf.close()
    except IOError:
        return True
    else:
        return False

class CacheHandler(urllib2.BaseHandler):
    """Stores responses in a persistant on-disk cache.

    If a subsequent GET request is made for the same URL, the stored
    response is returned, saving time, resources and bandwidth
    """
    def __init__(self, cache_location, max_age = 21600):
        """The location of the cache directory"""
        self.max_age = max_age
        self.cache_location = cache_location
        if not os.path.exists(self.cache_location):
            os.mkdir(self.cache_location)

    def default_open(self, request):
        """Handles GET requests, if the response is cached it returns it
        """
        if request.get_method() is not "GET":
            return None # let the next handler try to handle the request

        if exists_in_cache(
            self.cache_location, request.get_full_url(), self.max_age
        ):
            return CachedResponse(
                self.cache_location,
                request.get_full_url(),
                set_cache_header = True
            )
        else:
            return None

    def http_response(self, request, response):
        """Gets a HTTP response, if it was a GET request and the status code
        starts with 2 (200 OK etc) it caches it and returns a CachedResponse
        """
        if (request.get_method() == "GET"
            and str(response.code).startswith("2")
        ):
            if 'x-local-cache' not in response.info():
                # Response is not cached
                set_cache_header = store_in_cache(
                    self.cache_location,
                    request.get_full_url(),
                    response
                )
            else:
                set_cache_header = True
            #end if x-cache in response

            return CachedResponse(
                self.cache_location,
                request.get_full_url(),
                set_cache_header = set_cache_header
            )
        else:
            return response

class CachedResponse(StringIO.StringIO):
    """An urllib2.response-like object for cached responses.

    To determine if a response is cached or coming directly from
    the network, check the x-local-cache header rather than the object type.
    """
    def __init__(self, cache_location, url, set_cache_header=True):
        self.cache_location = cache_location
        hpath, bpath = calculate_cache_path(cache_location, url)

        StringIO.StringIO.__init__(self, file(bpath).read())

        self.url     = url
        self.code    = 200
        self.msg     = "OK"
        headerbuf = file(hpath).read()
        if set_cache_header:
            headerbuf += "x-local-cache: %s\r\n" % (bpath)
        self.headers = httplib.HTTPMessage(StringIO.StringIO(headerbuf))

    def info(self):
        """Returns headers
        """
        return self.headers

    def geturl(self):
        """Returns original URL
        """
        return self.url

    def recache(self):
        new_request = urllib2.urlopen(self.url)
        set_cache_header = store_in_cache(
            self.cache_location,
            new_request.url,
            new_request
        )
        CachedResponse.__init__(self, self.cache_location, self.url, True)

if __name__ == "__main__":
    def main():
        """Quick test/example of CacheHandler"""
        opener = urllib2.build_opener(CacheHandler("/tmp/"))
        response = opener.open("http://google.com")
        print response.headers
        print "Response:", response.read()

        response.recache()
        print response.headers
        print "After recache:", response.read()
    main() 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-10-20T00:57:45.240

Yahoo Developer Network 上的这篇文章 - [http://developer.yahoo.com/python/python-caching.html](http://developer.yahoo.com/python/python-caching.html) - 描述了如何将通过 urllib 进行的 http 调用缓存到内存或磁盘。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-07T18:03:29.093

@dbr：您可能还需要添加 https 响应缓存：

```
def https_response(self, request, response):
    return self.http_response(request,response) 
```

# c# - 使用现有列向 datagridview 添加行

> ID：148854
> 
> 赞同：8
> 
> 时间：2008-09-29T14:17:23.123
> 
> 标签：c#, winforms, datagridview

我有`DataGridView`几个创建的列。我添加了一些行，它们可以正确显示；但是，当我单击一个单元格时，内容就会消失。

我究竟做错了什么？

代码如下：

```
foreach (SaleItem item in this.Invoice.SaleItems)
{
    DataGridViewRow row = new DataGridViewRow();
    gridViewParts.Rows.Add(row);

    DataGridViewCell cellQuantity = new DataGridViewTextBoxCell();
    cellQuantity.Value = item.Quantity;
    row.Cells["colQuantity"] = cellQuantity;

    DataGridViewCell cellDescription = new DataGridViewTextBoxCell();
    cellDescription.Value = item.Part.Description;
    row.Cells["colDescription"] = cellDescription;

    DataGridViewCell cellCost = new DataGridViewTextBoxCell();
    cellCost.Value = item.Price;
    row.Cells["colUnitCost1"] = cellCost;

    DataGridViewCell cellTotal = new DataGridViewTextBoxCell();
    cellTotal.Value = item.Quantity * item.Price;
    row.Cells["colTotal"] = cellTotal;

    DataGridViewCell cellPartNumber = new DataGridViewTextBoxCell();
    cellPartNumber.Value = item.Part.Number;
    row.Cells["colPartNumber"] = cellPartNumber;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-21T12:26:57.823

只是为了扩展这个问题，还有另一种方法可以将一行添加到 a `DataGridView`，特别是如果列总是相同的：

```
object[] buffer = new object[5];
List<DataGridViewRow> rows = new List<DataGridViewRow>();
foreach (SaleItem item in this.Invoice.SaleItems)
{
    buffer[0] = item.Quantity;
    buffer[1] = item.Part.Description;
    buffer[2] = item.Price;
    buffer[3] = item.Quantity * item.Price;
    buffer[4] = item.Part.Number;

    rows.Add(new DataGridViewRow());
    rows[rows.Count - 1].CreateCells(gridViewParts, buffer);
}
gridViewParts.Rows.AddRange(rows.ToArray()); 
```

或者，如果您喜欢 ParamArrays：

```
List<DataGridViewRow> rows = new List<DataGridViewRow>();
foreach (SaleItem item in this.Invoice.SaleItems)
{
    rows.Add(new DataGridViewRow());
    rows[rows.Count - 1].CreateCells(gridViewParts,
        item.Quantity,
        item.Part.Description,
        item.Price,
        item.Quantity * item.Price,
        item.Part.Number
    );
}
gridViewParts.Rows.AddRange(rows.ToArray()); 
```

显然，缓冲区中的值需要与列（包括隐藏列）的顺序相同。

这是我发现在`DataGridView`不将网格绑定到`DataSource`. 绑定网格实际上会大大加快速度，如果网格中有超过 500 行，我强烈建议绑定它而不是手动填充它。

绑定也带来了好处，你可以保持对象的完整性，如果你想对选定的行进行操作，你可以这样做是绑定了 DatagridView：

```
if(gridViewParts.CurrentRow != null)
{
    SaleItem item = (SalteItem)(gridViewParts.CurrentRow.DataBoundItem);
    // You can use item here without problems.
} 
```

建议您绑定的类确实实现了`System.ComponentModel.INotifyPropertyChanged`接口，这允许它告诉网格有关更改的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T09:24:39.790

*编辑：哎呀！在第二行代码上犯了一个错误。- 解决它。*

有时，我讨厌定义数据源属性。

我认为，每当您为“行”创建和设置新行时，出于某种奇怪的原因，旧值都会被处理掉。尝试不使用实例来保存您创建的行：

```
int i;
i = gridViewParts.Rows.Add( new DataGridViewRow());

DataGridViewCell cellQuantity = new DataGridViewTextBoxCell();
cellQuantity.Value = item.Quantity;
gridViewParts.Rows[i].Cells["colQuantity"] = cellQuantity; 
```

似乎单元格与单元格实例可以正常工作。我不知道为什么行不同。可能需要进行更多测试...

# c# - 正确使用 P/Invoke

> ID：148856
> 
> 赞同：1
> 
> 时间：2008-09-29T14:18:17.177
> 
> 标签：c#, windows, interop, pinvoke

我需要从 c# 调用一个外部 dll。这是标题定义：

```
enum WatchMode { 
   WATCH_MODE_SYSTEM = 0,          
   WATCH_MODE_APPLICATION  = 1 };  

LONG ADS_API WDT_GetMode ( LONG i_hHandle, WatchMode * o_pWatchMode ); 
```

我在 C# 中添加了枚举和调用：

```
public enum WatchMode
{
    WATCH_MODE_SYSTEM = 0,
    WATCH_MODE_APPLICATION = 1       
}
[DllImport("AdsWatchdog.dll")]
internal static extern long WDT_GetMode(long hHandle, ref WatchMode watchmode); 
```

这会生成 AccessViolationException。我知道 dll 正在“工作”，因为我还添加了一个`GetHandle`返回`hHandle`上述内容的调用。我试图将参数更改为`int`( `ref int watchmode`) 但得到相同的错误。有谁知道我如何 PInvoke 上述调用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-29T18:33:13.273

您遇到了 C# 和 C++ 之间的参数大小问题差异。在 C++/windows 世界中，LONG 是一个 4 字节有符号整数。在 C# 世界中，long 是一个 8 字节的有符号整数。您应该更改您的 C# 签名以采用 int。

ffpf 说你应该在这里使用 IntPtr 是错误的。它将在 32 位机器上解决此特定问题，因为 IntPtr 将编组为 int。如果您在 64 位机器上运行它，它将再次编组为 8 字节有符号整数并崩溃。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T03:11:22.370

托管、本机和 COM 互操作团队在 codeplex 上发布了 PInvoke 互操作助手。也许它可以创建正确的签名。 [http://www.codeplex.com/clrinterop/Release/ProjectReleases.aspx?ReleaseId=14120](http://www.codeplex.com/clrinterop/Release/ProjectReleases.aspx?ReleaseId=14120)

# parsing - “解析”的反义词是什么？

> ID：148857
> 
> 赞同：147
> 
> 时间：2008-09-29T14:18:21.280
> 
> 标签：parsing, language-agnostic, semantics, naming

我有一个函数 parseQuery，它将 SQL 查询解析为该查询的抽象表示。

我即将编写一个函数，该函数采用查询的抽象表示并返回 SQL 查询字符串。

我应该怎么称呼第二个功能？

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2008-09-29T14:19:46.987

我认为您想要的动词是“撰写”。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2008-10-02T15:44:37.227

**parse**的反面是**序列化**

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-12-27T08:18:34.817

在编译器术语中，相反的是“未解析”。具体来说，解析将令牌流转换为抽象语法树，而反解析将抽象语法树转换为令牌流。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2008-09-29T14:21:20.417

撰写？解析查询时，您将其分解为其组成部分（令牌等），相反会将这些部分组合成字符串查询。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2012-03-08T22:01:35.567

为了补充您现有的命名，**composeQuery**看起来最好。

但在一般情况下，parse的反义词是**ǝsɹɐd**

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2008-09-29T14:28:22.223

我会使用其中之一：

*   字符串（）
*   ToSQL()
*   使成为（）

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2008-09-29T14:25:45.320

我认为“序列化”可能是您想要的词。这意味着生成可以从程序中导出（和导入）的数据的文本表示。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2008-09-29T14:20:14.897

“分析”的反义词是“综合”。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2008-09-29T14:19:34.600

ToQueryString()

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2008-10-15T14:18:29.980

绝对渲染。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2008-09-29T14:19:32.837

我称之为constructQuery。

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2008-09-29T14:19:58.297

可能产生或发射。

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2008-09-29T15:56:06.273

只是为了添加一些东西。

当然 parse 是一个双向词。

您可以将摘要解析为查询。

您可以将查询解析为摘要。

问题应该是，您将方法的后半部分命名为什么，因为在这种情况下，您正在解析一个摘要以进行查询，您将调用它`parseAbstract`。

要回答这个问题，解析没有对立面。

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2008-09-29T14:19:30.560

生成查询，可能吗？创建查询？

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2012-03-14T20:43:56.183

任你选

*   产生
*   倾倒
*   连载
*   发射

它们各自的内涵略有不同。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2008-09-29T14:19:55.457

也许[prettyPrintQuery](http://en.wikipedia.org/wiki/Prettyprint)？

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2008-09-29T16:21:02.797

compose、construction、generate、render、condense、reduce、toSQL、toString 取决于类及其相关运算符的性质

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2008-09-29T17:17:22.613

传统的编译器有两部分：解析器和代码生成器。

所以你可以称它为“生成”。当然，这里有点不同，因为编译器不编写源代码。（除非它是预编译器）。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2008-09-29T14:19:31.120

可能是 Format()。还是您的实例中的 ToSQL()？

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2008-09-29T14:20:18.437

解解析（）？开个玩笑，我会选择 toQueryString()

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2008-09-29T15:00:01.447

压扁？

解析的查询对象可能表示条件层次结构，您将其“展平”回一维字符串。

但是鉴于您要从对象到字符串，实际上只需使用 toString 或 toSQL() 或类似的东西。此外，如果您设计得很好并且使用了正确的应用程序，您可以稍后重命名它，然后在评论中添加内容。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2008-09-29T19:29:37.257

我会说序列化和反序列化，而不是解析和...

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2009-10-20T19:02:01.753

我会选择 ToString()，因为您通常可以将它们链式嵌套（相反的函数，可让您从 Class1 传递到 Class2，反之亦然）

```
DateTime.Parse( DateTime.Parse( myDate.ToString() ).ToString() ); 
```

Serialize() 看起来是个不错的选择，但在 Deserialize() 中已经有了相反的选择。

正如其他人指出的那样，在您的特定场景中， ToSql() 是另一个不错的选择。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2012-03-11T15:57:42.727

我会使用渲染

```
> a = 'html': { 'head': {'title': 'My Page'}, 'body': { 'h1': 'Hello World', 'p': 'This is a Paragraph' } }

> b = render(a)

> console.log(b)

<html>
    <head>
        <title>My Page</title>
    </head>
    <body>
        <h1>Hello World</h1>
        <p>This is a Paragraph</p>
    </body>
</html> 
```

恕我直言，与 parse() 相反

```
> c = parse(b)

{ 'html': {
    'head': {
        'title': 'My Page'
    }
    'body': {
        'h1': 'Hello World',
        'p': 'This is a Paragraph'
    }
} 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2008-09-29T18:06:30.280

+1 用于生成，但附加您正在生成的内容，即 GenerateSQL()

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2008-09-29T19:22:39.550

我投票支持“撰写”，但如果您不喜欢，我也建议“构建”

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2011-05-27T15:20:55.003

asSQL() 甚至更多 asQuery() 呢？

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2012-05-10T04:44:21.720

INHO Serialize、synthesize 都是不错的选择。另外，正如您命名为 parseQuery，我将使用 codeQuery

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2014-04-12T02:33:56.900

我通常使用“解析”作为转换方法，因此，我找不到与“转换”相反的词。（您不能“取消转换”某些东西，因为“取消转换”本身就是一种转换）。

这样想，最好的解决方案（对我来说）是有两个接收不同参数的“解析”方法。示例（Java）：

```
public class FooBarParser{

    public Foo parse(Bar bar);
    public Bar parse(Foo foo); 
} 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2013-11-01T00:28:54.657

**去解析**

deparse就是解析，为：

*   decompile就是编译
*   分解是组合
*   反序列化就是序列化
*   degroovy 是 groovy :) ;)

解析/解析不是结构的改变，而是转换。等效文本和抽象语法树格式之间的精确转换，保持所有关系和结构。

“组成”是指结构的变化，所以不太对。它建议从单独的独立部分组合（通常是第一次）。正如“分解”建议拆分成独立的部分一样。他们改变形式，而不仅仅是格式。

快速搜索显示该术语在以下范围内使用：

*   Perl： http: [//perldoc.perl.org/B/Deparse.html](http://perldoc.perl.org/B/Deparse.html)
*   R：[http ://www.hep.by/gnu/r-patched/r-lang/R-lang_98.html](http://www.hep.by/gnu/r-patched/r-lang/R-lang_98.html)
*   通用 Lisp：[http ://www.clisp.org/impnotes/dffi.html#c-type-parse](http://www.clisp.org/impnotes/dffi.html#c-type-parse)
*   PostgreSQL：[http ://doxygen.postgresql.org/deparse_8c.html](http://doxygen.postgresql.org/deparse_8c.html)
*   日食： http: [//www.eclipse.org/forums/index.php/t/201883/](http://www.eclipse.org/forums/index.php/t/201883/)
*   Unix Korn Shell： http: [//www.sourcecodebrowser.com/ksh/93tplus-p/deparse_8c.html](http://www.sourcecodebrowser.com/ksh/93tplus-p/deparse_8c.html)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2008-09-29T19:19:02.273

写查询。解析是从字符串中读取它并创建对象（假设是“实际”）表示的行为。相反的是将对象写入字符串。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2011-04-15T03:00:22.397

`.GetSqlQuery()`将是我的选择

* * *

## 回答 #33

> 赞同：-6
> 
> 时间：2009-10-20T20:46:33.053

我相信您正在寻找的答案是：“首先不要解析 SQL 或组装 SQL。使用对象/关系映射器并停止通过解决已经解决了很长时间的问题来浪费雇主的钱。 "

# c# - 如何使用 c# API 移动 TFS 文件？

> ID：148867
> 
> 赞同：10
> 
> 时间：2008-09-29T14:19:49.840
> 
> 标签：c#, api, tfs

我一直在谷歌上搜索如何使用 C# 使用 TFS API 移动文件。这个想法是有一个文件夹，开发人员在其中放置数据库升级脚本，构建过程进入该文件夹会创建一个构建脚本，并将文件夹中的所有文件移动到具有我们刚刚创建的数据库构建版本的新文件夹。

我找不到任何关于在 TFS 中以编程方式移动文件的参考...（除了 cmd 命令行）

有人知道通过 c# 学习 TFS 源控制文件操作的良好指南/msdn 起点吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-29T15:04:27.830

它非常简单:)。

```
Microsoft.TeamFoundation.VersionControl.Client.Workspace workspace = GetMyTfsWorkspace();
workspace.PendRename( oldPath, newPath ); 
```

那么你当然需要CheckIn。使用“workspace.GetPendingChanges()”和“workspace.CheckIn()”方法来完成。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-29T15:12:10.463

这是一个快速而肮脏的代码示例，应该可以帮助您完成大部分工作。

```
using Microsoft.TeamFoundation.Client; 
using Microsoft.TeamFoundation.VersionControl.Client; 

public void MoveFile( string tfsServer, string oldPath, string newPath )
{
    TeamFoundationServer server = TeamFoundationServerFactory.GetServer( tfsServer, new UICredentialsProvider() ); 
    server.EnsureAuthenticated(); 
    VersionControlServer vcserver = server.GetService( typeof( VersionControlServer ); 
    string currentUserName = server.AuthenticatedUserName;
    string currentComputerName = Environment.MachineName;
    Workspace[] wss = vcserver.QueryWorkspaces(null, currentUserName, currentComputerName);
    foreach (Workspace ws in wss)
    {

        foreach ( WorkingFolder wf in wfs )
        {
            bool bFound = false; 
            if ( wf.LocalItem != null )
            {
                if ( oldPath.StartsWith( wf.LocalItem ) )
                {
                   bFound = true; 
                   ws.PendRename( oldPath, newPath ); 
                   break; 
                }
             }
            if ( bFound )
               break; 
        }
    }
} 
```

# mdx - 如何从获取更高级别成员的所有后代的 MDX 调用中排除某个成员

> ID：148875
> 
> 赞同：14
> 
> 时间：2008-09-29T14:20:22.633
> 
> 标签：mdx

在我使用的 OLAP 数据库中，有一个“位置”层次结构，由公司 -> 区域 -> 区域 -> 站点 -> 房间级别组成。我正在使用以下 MDX 在公司级别获取特定成员的所有后代。

```
DESCENDANTS([Location].[Test Company],[Location].[Site], SELF_AND_BEFORE) 
```

我现在需要从报告中排除一个名为“冗余”的特定区域。如何更改上述 MDX 以排除此特定区域（及其所有后代）？我知道这个区域将被称为“冗余”，但我不想硬编码任何其他区域名称，因为这些名称可能会改变。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-29T14:26:12.807

EXCEPT 功能将采用一个集合，并删除您不想要的成员。在您的情况下，您需要说：

```
EXCEPT(
{DESCENDANTS([Location].[Test Company],[Location].[Site], SELF_AND_BEFORE)},
{DESCENDANTS([Location].[Whatever].[Redundant],[Location].[Site], SELF_AND_BEFORE)}
) 
```

这为您提供了第一组中的所有内容，除了您在第二组中提到的内容。像这样更容易理解：

```
EXCEPT({the set i want}, {a set of members i dont want}) 
```

您不必担心第三个（可选）参数：http: [//msdn.microsoft.com/en-us/library/ms144900.aspx](http://msdn.microsoft.com/en-us/library/ms144900.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-09T13:22:34.750

在为您的层次结构返回成员时，只需使用“-”来排除您不想要的成员。这就是我排除未知成员的方式：

```
select
{[Module].[Hierarchy].[Module].Members - [Module].[Hierarchy].[Module].[Unknown]} on rows,
{[Date].[Month-day].[Day Of Month].Members - [Date].[Month-day].[Day Of Month].[Unknown]} on     columns
from [StatsView]
where {[Measures].[Maintainability Index]} 
```

# c# - 为什么我的 .NET 应用程序从网络驱动器运行时会崩溃？

> ID：148879
> 
> 赞同：31
> 
> 时间：2008-09-29T14:21:28.167
> 
> 标签：c#, .net, networking, securityexception, permissionset

我的 .NET 应用程序在从网络驱动器运行时会失败，即使相同的可执行文件从本地硬盘驱动器运行得非常好？

我尝试像这样检查“完全信任”：

```
try
{
    // Demand full trust permissions
    PermissionSet fullTrust = new PermissionSet( PermissionState.Unrestricted );
    fullTrust.Demand();

    // Perform normal application logic

}
catch( SecurityException )
{
    // Report that permissions were not full trust
    MessageBox.Show( "This application requires full-trust security permissions to execute." );
} 
```

但是，这没有帮助，我的意思是应用程序启动并且永远不会进入 catch 块。但是，调试版本显示抛出的异常是由 InheritanceDemand 引起的 SecurityException。有任何想法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-29T14:26:38.920

这确实与网络位置上的应用程序在本地硬盘上的可信度较低这一事实有关（由于 .NET 框架的默认策略）。

如果我没记错的话，微软终于在 .NET 3.5 SP1 中纠正了这个烦恼（在很多开发人员抱怨之后）。

我用谷歌搜索了它：[.NET Framework 3.5 SP1 允许从网络共享启动托管代码！](http://blogs.msdn.com/vancem/archive/2008/08/13/net-framework-3-5-sp1-allows-managed-code-to-be-launched-from-a-network-share.aspx)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-29T14:23:31.923

您是否尝试过使用[CasPol 完全信任共享](http://blogs.msdn.com/shawnfa/archive/2004/12/30/344554.aspx)？

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-29T14:26:14.320

您可能已经这样做了，但您可以使用 CasPol.exe 为指定的网络共享启用 FullTrust。

例如

```
cd c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727
CasPol.exe -m -ag 1.2 -url file:///N:/your/network/path/* FullTrust 
```

更多信息[在这里](http://blogs.msdn.com/shawnfa/archive/2004/12/30/344554.aspx)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-29T14:25:25.850

如果这是 .NET 2.0 或更高版本，则创建[ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx)是为了真正帮助解决此部署问题。我只使用它部署到网络共享。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T14:26:04.913

这是微软在 .net 框架中内置的安全性。这是一种阻止恶意软件以完全权限在本地运行的方法，因此您无法在代码中以编程方式更改它。

您需要做的是增加对特定程序集的信任。您可以在 .NET Framework 配置（控制面板->管理工具）中执行此操作，并且必须在每台计算机上完成。

与任何安全措施一样，这很痛苦，但会帮助世界减少感染等等……

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-06T16:15:08.333

我所要做的就是将文件标记为只读（可能不相关）并将除完全控制之外的所有权限授予经过身份验证的用户。我在这样做之前遇到了这个问题，当时我只为域用户设置了网络共享。

我发现了这个解决方法，因为管理员共享 (\server\C$) 和我自己的 PC 共享都没有这个问题。

**编辑：**应用程序面向 .NET 3.5，此处没有 SP1（版本 3.5.7283）

# c++ - 如何在不使用大量 CPU 的情况下快速将大量丰富的内容（图像、格式）附加到控件？

> ID：148881
> 
> 赞同：2
> 
> 时间：2008-09-29T14:22:17.963
> 
> 标签：c++, performance, wxwidgets

我正在使用 wxWidgets 和 Visual C++ 创建类似于在 GUI 中使用具有丰富格式（颜色、字体、图像）的 Unix“tail -f”的功能。我的目标是 wxMSW 和 wxMAC。

显而易见的答案是使用 wxTextCtrl 和 wxTE_RICH，调用 wxTextCtrl::SetDefaultStyle() 和 wxTextCtrl::WriteText()。

但是，在我的 3ghz 工作站上，以发布模式编译，我无法继续跟踪平均每行增长 1 毫秒的日志，最终落后。对于每一行，我都会招致：

1.  两次调用 SetDefaultStyle()
2.  两次调用两次 WriteText()
3.  调用 Freeze() 和 Thaw() 小部件

运行此程序时，在填充了大约 20,000 行之后，我的 CPU 使用 wxMSW 在一个内核上达到 100%。一旦达到某个阈值，程序就会明显变慢，进一步落后。

我愿意使用其他控件（wxListCtrl、wxRichTextCtrl 等）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T14:38:01.950

您是否考虑过限制视图中的行数？当我们遇到类似问题时，我们只是确保视图中的行数不超过 10,000 行。如果底部有更多行，我们将删除顶部的行。这不是使用 WxWidgets，而是在 Mac 上使用本机 Cocoa UI，但问题是一样的。如果样式化的文本视图（带有颜色、格式和漂亮的打印）变大，在底部添加更多数据会变得非常慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-02T15:37:06.887

听起来您正在使用的控件根本不是针对您投入的数据量而构建的。我会考虑构建一个自定义控件。以下是您可以考虑的一些事项：

1.  当有新行进入时，您不需要重新渲染以前的行......它们不会改变，布局也不会因为新数据而改变。
2.  尝试一次只在内存中保留可见部分和几个回顾屏幕。这会使它更轻一些......但是如果您希望用户能够比您的回看更远地向后滚动并使一切看起来是无缝的，那么您将必须进行自己的滚动管理。
3.  Don't necessarily update one line at a time. When there is new data, grab it all and update. If you get 10 lines really quickly, and you update the screen all at once, you might save on some of the overhead of doing it line by line.

Hope this helps.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-24T06:27:38.323

Derive from wxVListBox. From the docs:

> wxVListBox is a listbox-like control with the following two main differences from a regular listbox: it can have an arbitrarily huge number of items because it doesn't store them itself but uses OnDrawItem() callback to draw them (so it is a Virtual listbox) and its items can have variable height as determined by OnMeasureItem() (so it is also a listbox with the lines of Variable height).

# c# - 使用事件而不是异常来实现错误处理

> ID：148882
> 
> 赞同：10
> 
> 时间：2008-09-29T14:22:27.120
> 
> 标签：c#, design-patterns, exception, events

我正在编写一些代码，这些代码在其业务和数据层中使用一种模式，这些模式使用事件来表示错误，例如

```
resource = AllocateLotsOfMemory();
if (SomeCondition())
{    
    OnOddError(new OddErrorEventArgs(resource.StatusProperty));
    resource.FreeLotsOfMemory();    
    return;
} 
```

这看起来很奇怪，尤其是调用它的代码需要挂钩事件（有四五个不同的事件！）。

开发人员告诉我，这样他们可以在错误处理代码中引用已分配资源的属性，并且该层负责在错误后进行清理。

这有点道理。

替代方案可能类似于

```
resource = AllocateLotsOfMemory();
if (SomeCondition())
{   
    BigObject temporary = resource.StatusProperty;
    resource.FreeLotsOfMemory();
    throw new OddException(temporary);
} 
```

我的问题是：

1.  由于这个“ `BigObject`”在异常对象被释放时被释放，我们需要这个模式吗？

2.  有没有其他人经历过这种模式？如果有，你发现了什么陷阱？有什么优势？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-29T14:29:00.990

我也觉得很奇怪。有一些优点 - 例如允许多个“处理程序”，但语义与正常的错误处理有很大不同。特别是，它不会自动向上传播到堆栈这一事实让我感到担忧——除非错误处理程序本身抛出异常，否则逻辑将继续运行，就好像一切都还好，但它可能应该中止当前操作.

另一种思考方式：假设该方法旨在返回一个值，但您很早就发现了一个错误。你返回什么价值？异常传达了一个事实，*即*没有适当的值可以返回......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-29T14:25:15.600

如果您从“错误”和“警告”的角度来考虑，那么在为“警告”类别保留事件和为“错误”类别保留例外时，我很幸运。

这里的基本原理是事件是可选的。没有人拿着枪指着你的头强迫你去处理它们。这对于警告来说可能没问题，但是当您遇到真正的错误时，您希望确保更加认真地对待它们。*必须*处理异常，否则它们会冒泡并为用户创建令人讨厌的消息。

关于您的*大对象*问题：您绝对不会传递大对象，但这并不意味着您不能传递对大对象的*引用。*这样做的能力有很多。

*作为附录，除了*异常之外，没有什么可以阻止引发事件，但同样：如果你有一个真正的错误，你想要一些东西来强制客户端开发人员处理它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-29T14:31:27.787

这对我来说看起来很奇怪，首先 IDisposable 是你的朋友，使用它。

如果您正在处理错误和异常情况，您应该使用异常，而不是事件，因为它更易于掌握、调试和编码。

所以应该是

```
using(var resource = AllocateLotsOfMemory())
{
   if(something_bad_happened) 
   {
     throw new SomeThingBadException();
   }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-29T14:28:00.213

1）需要吗？没有绝对必要的模式

2) Windows Workflow Foundation 使用托管运行时内运行的工作流实例的所有结果来执行此操作。请记住，尝试引发该事件时可能会发生异常，并且您可能希望根据情况在 Dispose 或 finally 块上执行清理代码以确保其运行。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-29T14:32:06.317

老实说，指示错误的事件让我觉得很可怕。

关于返回状态代码和抛出异常，阵营之间存在分歧。简化（大大）：状态代码阵营说，抛出异常会使检测和处理错误的位置远离导致错误的代码。异常抛出上限表示用户忘记检查状态代码，异常会强制执行错误处理。

作为事件的错误似乎是这两种方法中*最糟糕的。*错误清理与导致错误的代码完全分开，错误通知完全是自愿的。哎哟。

对我来说，如果该方法没有履行它的隐含或显式契约（它没有做它应该做的事情），一个例外是适当的响应。在这种情况下，在异常中抛出您需要的信息似乎是合理的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-29T14:49:14.577

看看Udi Dahan 的[这篇文章](http://www.udidahan.com/2008/08/25/domain-events-take-2/)。它是一种用于调度域事件的优雅方法。上一张海报说你不应该使用事件机制来从致命错误中恢复是正确的，但它对于松散耦合系统中的通知来说是一种非常有用的模式：

```
public class DomainEventStorage<ActionType>
{
    public List<ActionType> Actions
    {
        get
        {
            var k = string.Format("Domain.Event.DomainEvent.{0}.{1}",
                                  GetType().Name,
                                  GetType().GetGenericArguments()[0]);
            if (Local.Data[k] == null)
                Local.Data[k] = new List<ActionType>();

            return (List<ActionType>) Local.Data[k];
        }
    }

    public IDisposable Register(ActionType callback)
    {
        Actions.Add(callback);
        return new DomainEventRegistrationRemover(() => Actions.Remove(callback)
            );
    }
}

public class DomainEvent<T1> : IDomainEvent where T1 : class
{
    private readonly DomainEventStorage<Action<T1>> _impl = new DomainEventStorage<Action<T1>>();

    internal List<Action<T1>> Actions { get { return _impl.Actions; } }

    public IDisposable Register(Action<T1> callback)
    {
        return _impl.Register(callback);
    }

    public void Raise(T1 args)
    {
        foreach (var action in Actions)
        {
            action.Invoke(args);
        }
    }
} 
```

并消费：

```
var fail = false;
using(var ev = DomainErrors.SomethingHappened.Register(c => fail = true) 
{
   //Do something with your domain here
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-17T08:07:02.707

第一个片段应该是

```
resource = AllocateLotsOfMemory();
if (SomeCondition())
{
    try
    {
        OnOddError(new OddErrorEventArgs(resource.StatusProperty));
        return;
    }
    finally
    {
        resource.FreeLotsOfMemory();
    }
} 
```

否则，当事件处理程序引发异常时，您将不会释放资源。

正如迈克布朗所说，如果第二个片段`resource.FreeLotsOfMemory()`与内容混淆`resource.StatusProperty`而不是将其设置为`null`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-29T14:32:01.450

我们有一个基本的错误对象和错误事件，我们在框架中使用命令模式来处理非关键错误（例如验证错误）。与异常一样，人们可以侦听基本的 ErrorEvent 或更具体的 ErrorEvent。

您的两个片段之间也存在显着差异。

如果 resource.FreeLotsOfMemory() 清除了 StatusProperty 值，而不是仅仅将其设置为 null，那么在创建和抛出 OddException 时，您的临时变量将持有无效对象。

经验法则是只应在不可恢复的情况下抛出异常。我真的希望 C# 支持 Throws 子句，这是我在 Java 中唯一真正怀念的东西。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-29T15:15:35.933

这种方法的另一个主要问题是并发问题。

对于传统的错误处理，当控制以一种受控的方式向上移动调用堆栈到错误处理程序时，锁将被释放。在这个方案中，当事件被调用时，所有的锁仍然会被持有。错误处理程序中发生的任何阻塞（如果有日志记录，您可能会期望一些阻塞）将是死锁的潜在来源。

# javascript - 有没有更好的方法在 JavaScript 中执行可选函数参数？

> ID：148901
> 
> 赞同：847
> 
> 时间：2008-09-29T14:27:08.543
> 
> 标签：javascript, function, arguments

我总是这样处理 JavaScript 中的可选参数：

```
function myFunc(requiredArg, optionalArg){
  optionalArg = optionalArg || 'defaultValue';

  // Do stuff
} 
```

有更好的方法吗？

有没有这样使用`||`会失败的情况？

* * *

## 回答 #1

> 赞同：1096
> 
> 时间：2008-09-29T14:30:34.013

如果 optionalArg 被传递，您的逻辑将失败，但评估为 false - 试试这个作为替代

```
if (typeof optionalArg === 'undefined') { optionalArg = 'default'; } 
```

或另一种成语：

```
optionalArg = (typeof optionalArg === 'undefined') ? 'default' : optionalArg; 
```

使用最能向您传达意图的成语！

* * *

## 回答 #2

> 赞同：180
> 
> 时间：2013-02-19T13:13:54.843

在**ECMAScript 2015**（又名“ **ES6** ”）中，您可以在函数声明中声明默认参数值：

```
function myFunc(requiredArg, optionalArg = 'defaultValue') {
    // do stuff
} 
```

有关它们的更多信息[，请参阅 MDN 上的这篇文章](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/default_parameters)。

目前[只有 Firefox 支持](https://kangax.github.io/compat-table/es6/#test-default_function_parameters)，但随着标准的完成，预计支持会迅速提高。

* * *

**编辑（2019-06-12）：**

现代浏览器现在广泛支持默认参数。
所有版本的 Internet **Explorer**都不支持此功能。但是，**Chrome**、**Firefox**和**Edge**目前支持它。

* * *

## 回答 #3

> 赞同：127
> 
> 时间：2011-11-14T21:23:59.627

我发现这是最简单、最易读的方式：

```
if (typeof myVariable === 'undefined') { myVariable = 'default'; }
//use myVariable here 
```

Paul Dixon 的回答（以我的拙见）比这更难读，但归结为偏好。

insin 的答案要先进得多，但对大功能更有用！

**编辑 2013 年 11 月 17 日晚上 9:33：**我为 Node.js 创建了一个包，可以更轻松地“重载”名为[parametric](https://npmjs.org/package/parametric)的函数（方法） 。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2008-09-29T14:34:33.300

如果您需要插入文字`NULL`，那么您可能会遇到一些问题。除此之外，不，我认为您可能走在正确的轨道上。

一些人选择的另一种方法是使用一个 assoc 变量数组来遍历参数列表。它看起来有点整洁，但我想它有点（非常少）有点更多的进程/内存密集型。

```
function myFunction (argArray) {
    var defaults = {
        'arg1'  :   "value 1",
        'arg2'  :   "value 2",
        'arg3'  :   "value 3",
        'arg4'  :   "value 4"
    }

    for(var i in defaults) 
        if(typeof argArray[i] == "undefined") 
               argArray[i] = defaults[i];

    // ...
} 
```

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2012-02-20T15:36:26.000

理想情况下，您将重构以传递一个对象并将其与默认对象[合并](https://stackoverflow.com/questions/171251/?answertab=votes)，因此传递参数的顺序无关紧要（请参阅下面的此答案的第二部分）。

但是，如果您只是想要快速、可靠、易于使用且不笨重的东西，试试这个：

* * *

## 一个干净的快速修复任意数量的默认参数

*   它可以优雅地扩展：每个新默认值的额外代码最少
*   您可以将其粘贴到任何地方：只需更改所需参数和变量的数量
*   如果要传递`undefined`给具有默认值的参数，这种方式，变量设置为`undefined`. 此页面上的大多数其他选项将替换`undefined`为默认值。

这是为三个可选参数提供默认值的示例（带有两个必需参数）

```
function myFunc( requiredA, requiredB,  optionalA, optionalB, optionalC ) {

  switch (arguments.length - 2) { // 2 is the number of required arguments
    case 0:  optionalA = 'Some default';
    case 1:  optionalB = 'Another default';
    case 2:  optionalC = 'Some other default';
    // no breaks between cases: each case implies the next cases are also needed
  }

} 
```

[**简单的演示**](http://jsbin.com/pecorogevi/1/edit)。这类似于[roenving 的答案](https://stackoverflow.com/a/148933/568458)，但可以轻松扩展任意数量的默认参数，更易于更新和[使用`arguments`not`Function.arguments`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)。

* * *

## 传递和合并对象以获得更大的灵活性

上面的代码，就像许多执行默认参数的方法一样，不能乱序传递参数，例如，传递`optionalC`但离开`optionalB`以回退到其默认值。

一个不错的选择是传递对象并与默认对象合并。这也有利于可维护性（只需注意保持代码的可读性，这样未来的合作者就不会猜测您传递的对象的可能内容）。

使用 jQuery 的示例。如果您不使用 jQuery，则可以使用 Underscore`_.defaults(object, defaults)`或[浏览以下选项](https://stackoverflow.com/questions/171251/?answertab=votes)：

```
function myFunc( args ) {
  var defaults = {
    optionalA: 'Some default',
    optionalB: 'Another default',
    optionalC: 'Some other default'
  };
  args = $.extend({}, defaults, args);
} 
```

这是[一个简单的例子](http://jsbin.com/yahuqocira/1/edit?html,js,output)。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-09-29T14:33:31.447

您可以为此使用一些不同的方案。我一直在测试arguments.length：

```
function myFunc(requiredArg, optionalArg){
  optionalArg = myFunc.arguments.length<2 ? 'defaultValue' : optionalArg;

  ... 
```

——这样做，它不可能失败，但我不知道你的方式是否有任何失败的机会，刚才我想不出一个场景，它实际上会失败......

然后保罗提供了一个失败的场景！-)

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-09-29T23:16:54.823

与 Oli 的回答类似，我使用了一个参数 Object 和一个定义默认值的 Object。加一点糖...

```
/**
 * Updates an object's properties with other objects' properties. All
 * additional non-falsy arguments will have their properties copied to the
 * destination object, in the order given.
 */
function extend(dest) {
  for (var i = 1, l = arguments.length; i < l; i++) {
    var src = arguments[i]
    if (!src) {
      continue
    }
    for (var property in src) {
      if (src.hasOwnProperty(property)) {
        dest[property] = src[property]
      }
    }
  }
  return dest
}

/**
 * Inherit another function's prototype without invoking the function.
 */
function inherits(child, parent) {
  var F = function() {}
  F.prototype = parent.prototype
  child.prototype = new F()
  child.prototype.constructor = child
  return child
} 
```

...这可以做得更好一点。

```
function Field(kwargs) {
  kwargs = extend({
    required: true, widget: null, label: null, initial: null,
    helpText: null, errorMessages: null
  }, kwargs)
  this.required = kwargs.required
  this.label = kwargs.label
  this.initial = kwargs.initial
  // ...and so on...
}

function CharField(kwargs) {
  kwargs = extend({
    maxLength: null, minLength: null
  }, kwargs)
  this.maxLength = kwargs.maxLength
  this.minLength = kwargs.minLength
  Field.call(this, kwargs)
}
inherits(CharField, Field) 
```

这种方法有什么好处？

*   您可以省略任意数量的参数 - 如果您只想覆盖一个参数的值，您可以只提供该参数，而不必显式传递`undefined`何时，比如有 5 个参数并且您只想自定义最后一个一，因为您必须使用建议的其他一些方法。
*   当为从另一个继承的对象使用构造函数时，很容易接受您继承的对象的构造函数所需的任何参数，因为您不必在构造函数签名中命名这些参数，甚至提供您自己的默认值（让父对象的构造函数为您执行此操作，如上面`CharField`调用`Field`的构造函数时所见）。
*   继承层次结构中的子对象可以根据需要为其父构造函数自定义参数，强制执行自己的默认值或确保*始终*使用某个值。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2015-05-15T13:46:57.200

***松散类型检查***

易于编写，但是`0`, `''`, `false`,`null`和`undefined`将被转换为默认值，这可能不是预期的结果。

```
function myFunc(requiredArg, optionalArg) {
    optionalArg = optionalArg || 'defaultValue';
} 
```

***严格的类型检查***

更长，但涵盖了大多数情况。只有当我们`undefined`作为参数传递时它错误地分配了默认值。

```
function myFunc(requiredArg, optionalArg) {
    optionalArg = typeof optionalArg !== 'undefined' ? optionalArg : 'defaultValue';
} 
```

***检查参数变量***

抓住所有情况，但写起来最笨拙。

```
function myFunc(requiredArg, optionalArg1, optionalArg2) {
    optionalArg1 = arguments.length > 1 ? optionalArg1 : 'defaultValue';
    optionalArg2 = arguments.length > 2 ? optionalArg2 : 'defaultValue';
} 
```

***ES6***

不幸的是，目前这对浏览器的支持很差

```
function myFunc(requiredArg, optionalArg = 'defaultValue') {

} 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2012-05-15T21:23:50.220

如果您广泛使用默认值，这似乎更具可读性：

```
function usageExemple(a,b,c,d){
    //defaults
    a=defaultValue(a,1);
    b=defaultValue(b,2);
    c=defaultValue(c,4);
    d=defaultValue(d,8);

    var x = a+b+c+d;
    return x;
} 
```

只需在全局 escope 上声明此函数。

```
function defaultValue(variable,defaultValue){
    return(typeof variable!=='undefined')?(variable):(defaultValue);
} 
```

使用模式`fruit = defaultValue(fruit,'Apple');`

*PS 您可以将`defaultValue`函数重命名为短名称，只是不要使用`default`它作为 javascript 中的保留字。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2014-03-13T06:27:04.113

我习惯于看到处理可选变量的一些基本变化。有时，轻松的版本很有用。

```
function foo(a, b, c) {
  a = a || "default";   // Matches 0, "", null, undefined, NaN, false.
  a || (a = "default"); // Matches 0, "", null, undefined, NaN, false.

  if (b == null) { b = "default"; } // Matches null, undefined.

  if (typeof c === "undefined") { c = "default"; } // Matches undefined.
} 
```

`a`例如，与变量一起使用的虚假默认值在[Backbone.js](https://en.wikipedia.org/wiki/Backbone.js)中广泛使用。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2016-02-01T11:09:53.710

使用 ES2015/ES6，您可以利用`Object.assign`哪些可以替换`$.extend()`或`_.defaults()`

```
function myFunc(requiredArg, options = {}) {
  const defaults = {
    message: 'Hello',
    color: 'red',
    importance: 1
  };

  const settings = Object.assign({}, defaults, options);

  // do stuff
} 
```

您还可以使用这样的默认参数

```
function myFunc(requiredArg, { message: 'Hello', color: 'red', importance: 1 } = {}) {
  // do stuff
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-09-22T23:59:46.110

如果你正在使用[Underscore](http://underscorejs.org/#defaults)库（你应该，它是一个很棒的库）：

```
_.defaults(optionalArg, 'defaultValue'); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-05-07T13:31:33.740

我不知道为什么@Paul 的回复被否决，但验证反对`null`是一个不错的选择。也许一个更肯定的例子会更有意义：

在 JavaScript 中，丢失的参数就像一个未初始化的声明变量（只是`var a1;`）。并且相等运算符将 undefined 转换为 null，因此这对值类型和对象都很有效，这也是 CoffeeScript 处理可选参数的方式。

```
function overLoad(p1){
    alert(p1 == null); // Caution, don't use the strict comparison: === won't work.
    alert(typeof p1 === 'undefined');
}

overLoad(); // true, true
overLoad(undefined); // true, true. Yes, undefined is treated as null for equality operator.
overLoad(10); // false, false

function overLoad(p1){
    if (p1 == null) p1 = 'default value goes here...';
    //...
} 
```

不过，有人担心最好的语义`typeof variable === 'undefined'`会稍微好一些。我不打算为此辩护，因为这是底层 API 如何实现函数的问题。它不应该让 API 用户感兴趣。

我还应该补充一点，这是物理上确保遗漏任何参数的唯一方法，使用`in`不幸的是不能与参数名称一起使用的运算符，因此必须传递`arguments`.

```
function foo(a, b) {
    // Both a and b will evaluate to undefined when used in an expression
    alert(a); // undefined
    alert(b); // undefined

    alert("0" in arguments); // true
    alert("1" in arguments); // false
}

foo (undefined); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-09-27T05:15:30.203

对 undefined 的测试是不必要的，并且不像它可能的那样健壮，因为正如 user568458 指出的那样，如果通过 null 或 false ，提供的解决方案将失败。API 的用户可能会认为 false 或 null 会强制方法避免使用该参数。

```
function PaulDixonSolution(required, optionalArg){
   optionalArg = (typeof optionalArg === "undefined") ? "defaultValue" : optionalArg;
   console.log(optionalArg);
};
PaulDixonSolution("required");
PaulDixonSolution("required", "provided");
PaulDixonSolution("required", null);
PaulDixonSolution("required", false); 
```

结果是：

```
defaultValue
provided
null
false 
```

最后两个可能很糟糕。而是尝试：

```
function bulletproof(required, optionalArg){
   optionalArg = optionalArg ? optionalArg : "defaultValue";;
   console.log(optionalArg);
};
bulletproof("required");
bulletproof("required", "provided");
bulletproof("required", null);
bulletproof("required", false); 
```

结果是：

```
defaultValue
provided
defaultValue
defaultValue 
```

这不是最佳的唯一情况是当您实际上有可选参数时，这些参数是布尔值或有意为空的。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-06-19T11:25:54.337

我尝试了此处提到的一些选项并对其进行了性能测试。此时逻辑或似乎是最快的。尽管这是随时间变化的主题（不同的 JavaScript 引擎版本）。

这些是我的结果（Microsoft Edge 20.10240.16384.0）：

```
Function executed            Operations/sec     Statistics
TypeofFunction('test');          92,169,505     ±1.55%   9% slower
SwitchFuntion('test');            2,904,685     ±2.91%  97% slower
ObjectFunction({param1: 'test'});   924,753     ±1.71%  99% slower
LogicalOrFunction('test');      101,205,173     ±0.92%     fastest
TypeofFunction2('test');         35,636,836     ±0.59%  65% slower 
```

这个性能测试可以很容易地复制到：http: [//jsperf.com/optional-parameters-typeof-vs-switch/2](http://jsperf.com/optional-parameters-typeof-vs-switch/2)

这是测试的代码：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script>
    Benchmark.prototype.setup = function() {
        function TypeofFunction(param1, optParam1, optParam2, optParam3) {
            optParam1 = (typeof optParam1 === "undefined") ? "Some default" : optParam1;
            optParam2 = (typeof optParam2 === "undefined") ? "Another default" : optParam2;
            optParam3 = (typeof optParam3 === "undefined") ? "Some other default" : optParam3;
        }

        function TypeofFunction2(param1, optParam1, optParam2, optParam3) {
            optParam1 = defaultValue(optParam1, "Some default");
            optParam2 = defaultValue(optParam2, "Another default");
            optParam3 = defaultValue(optParam3, "Some other default");
        }

        function defaultValue(variable, defaultValue) {
            return (typeof variable !== 'undefined') ? (variable) : (defaultValue);
        }

        function SwitchFuntion(param1, optParam1, optParam2, optParam3) {
            switch (arguments.length - 1) { // <-- 1 is number of required arguments
                case 0:
                    optParam1 = 'Some default';
                case 1:
                    optParam2 = 'Another default';
                case 2:
                    optParam3 = 'Some other default';
            }
        }

        function ObjectFunction(args) {
            var defaults = {
                optParam1: 'Some default',
                optParam2: 'Another default',
                optParam3: 'Some other default'
            }
            args = $.extend({}, defaults, args);
        }

        function LogicalOrFunction(param1, optParam1, optParam2, optParam3) {
            optParam1 || (optParam1 = 'Some default');
            optParam2 || (optParam1 = 'Another default');
            optParam3 || (optParam1 = 'Some other default');
        }
    };
</script> 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2015-10-09T14:19:21.863

**登陆这个问题，在 EcmaScript 2015 中**搜索默认参数，因此只是提到......

使用**ES6**我们可以做[默认参数](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/default_parameters)：

```
function doSomething(optionalParam = "defaultValue"){
    console.log(optionalParam);//not required to check for falsy values
}

doSomething(); //"defaultValue"
doSomething("myvalue"); //"myvalue" 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2016-03-23T10:52:48.300

在一个项目中，我注意到我在可选参数和设置方面重复了太多，所以我创建了一个类来处理类型检查并分配一个默认值，从而产生整洁且可读的代码。请参阅示例，让我知道这是否适合您。

```
var myCar           = new Car('VW', {gearbox:'automatic', options:['radio', 'airbags 2x']});
var myOtherCar      = new Car('Toyota');

function Car(brand, settings) {
    this.brand      = brand;

    // readable and adjustable code
    settings        = DefaultValue.object(settings, {});
    this.wheels     = DefaultValue.number(settings.wheels, 4);
    this.hasBreaks  = DefaultValue.bool(settings.hasBreaks, true);
    this.gearbox    = DefaultValue.string(settings.gearbox, 'manual');
    this.options    = DefaultValue.array(settings.options, []);

    // instead of doing this the hard way
    settings        = settings || {};
    this.wheels     = (!isNaN(settings.wheels)) ? settings.wheels : 4;
    this.hasBreaks  = (typeof settings.hasBreaks !== 'undefined') ? (settings.hasBreaks === true) : true;
    this.gearbox    = (typeof settings.gearbox === 'string') ? settings.gearbox : 'manual';
    this.options    = (typeof settings.options !== 'undefined' && Array.isArray(settings.options)) ? settings.options : [];
} 
```

使用这个类：

```
(function(ns) {

    var DefaultValue = {

        object: function(input, defaultValue) {
            if (typeof defaultValue !== 'object') throw new Error('invalid defaultValue type');
            return (typeof input !== 'undefined') ? input : defaultValue;
        },

        bool: function(input, defaultValue) {
            if (typeof defaultValue !== 'boolean') throw new Error('invalid defaultValue type');
            return (typeof input !== 'undefined') ? (input === true) : defaultValue;
        },

        number: function(input, defaultValue) {
            if (isNaN(defaultValue)) throw new Error('invalid defaultValue type');
            return (typeof input !== 'undefined' && !isNaN(input)) ? parseFloat(input) : defaultValue;
        },

        // wrap the input in an array if it is not undefined and not an array, for your convenience
        array: function(input, defaultValue) {
            if (typeof defaultValue === 'undefined') throw new Error('invalid defaultValue type');
            return (typeof input !== 'undefined') ? (Array.isArray(input) ? input : [input]) : defaultValue;
        },

        string: function(input, defaultValue) {
            if (typeof defaultValue !== 'string') throw new Error('invalid defaultValue type');
            return (typeof input === 'string') ? input : defaultValue;
        },

    };

    ns.DefaultValue = DefaultValue;

}(this)); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-11-29T21:04:58.937

这就是我最终的结果：

```
function WhoLikesCake(options) {
  options = options || {};
  var defaultOptions = {
    a : options.a || "Huh?",
    b : options.b || "I don't like cake."
  }
  console.log('a: ' + defaultOptions.b + ' - b: ' + defaultOptions.b);

  // Do more stuff here ...
} 
```

像这样调用：

```
WhoLikesCake({ b : "I do" }); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2014-04-13T20:53:23.117

伙计们——

在查看了这些和其他解决方案之后，我使用最初来自 W3Schools 的一段代码作为基础尝试了其中的一些。您可以在下面找到有效的方法。每个被注释掉的项目也可以工作，并且可以让您通过删除单个注释来进行实验。需要明确的是，没有定义的是“eyecolor”参数。

```
function person(firstname, lastname, age, eyecolor)
{
this.firstname = firstname;
this.lastname = lastname;
this.age = age;
this.eyecolor = eyecolor;
// if(null==eyecolor)
//   this.eyecolor = "unknown1";
//if(typeof(eyecolor)==='undefined') 
//   this.eyecolor = "unknown2";
// if(!eyecolor)
//   this.eyecolor = "unknown3";
this.eyecolor = this.eyecolor || "unknown4";
}

var myFather = new person("John", "Doe", 60);
var myMother = new person("Sally", "Rally", 48, "green");

var elem = document.getElementById("demo");
elem.innerHTML = "My father " +
              myFather.firstname + " " +
              myFather.lastname + " is " +
              myFather.age + " with " +
              myFather.eyecolor + " eyes.<br/>" +
              "My mother " +
              myMother.firstname + " " +
              myMother.lastname + " is " +
              myMother.age + " with " +
              myMother.eyecolor + " eyes."; 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2014-10-03T09:28:30.883

```
function Default(variable, new_value)
{
    if(new_value === undefined) { return (variable === undefined) ? null : variable; }
    return (variable === undefined) ? new_value : variable;
}

var a = 2, b = "hello", c = true, d;

var test = Default(a, 0),
test2 = Default(b, "Hi"),
test3 = Default(c, false),
test4 = Default(d, "Hello world");

window.alert(test + "\n" + test2 + "\n" + test3 + "\n" + test4); 
```

[http://jsfiddle.net/mq60hqrf/](http://jsfiddle.net/mq60hqrf/)

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2016-04-11T13:51:11.817

这是我的解决方案。有了这个，你可以留下任何你想要的参数。可选参数的顺序并不重要，您可以添加自定义验证。

```
function YourFunction(optionalArguments) {
            //var scope = this;

            //set the defaults
            var _value1 = 'defaultValue1';
            var _value2 = 'defaultValue2';
            var _value3 = null;
            var _value4 = false;

            //check the optional arguments if they are set to override defaults...
            if (typeof optionalArguments !== 'undefined') {

                if (typeof optionalArguments.param1 !== 'undefined')
                    _value1 = optionalArguments.param1;

                if (typeof optionalArguments.param2 !== 'undefined')
                    _value2 = optionalArguments.param2;

                if (typeof optionalArguments.param3 !== 'undefined')
                    _value3 = optionalArguments.param3;

                if (typeof optionalArguments.param4 !== 'undefined')
                    //use custom parameter validation if needed, in this case for javascript boolean
                   _value4 = (optionalArguments.param4 === true || optionalArguments.param4 === 'true');
            }

            console.log('value summary of function call:');
            console.log('value1: ' + _value1);
            console.log('value2: ' + _value2);
            console.log('value3: ' + _value3);
            console.log('value4: ' + _value4);
            console.log('');
        }

        //call your function in any way you want. You can leave parameters. Order is not important. Here some examples:
        YourFunction({
            param1: 'yourGivenValue1',
            param2: 'yourGivenValue2',
            param3: 'yourGivenValue3',
            param4: true,
        });

        //order is not important
        YourFunction({
            param4: false,
            param1: 'yourGivenValue1',
            param2: 'yourGivenValue2',
        });

        //uses all default values
        YourFunction();

        //keeps value4 false, because not a valid value is given
        YourFunction({
            param4: 'not a valid bool'
        }); 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2016-04-30T19:36:34.467

1.  `arg || 'default'`是一种很好的方法，适用于 90% 的情况

2.  当您需要传递可能是“虚假”的值时，它会失败

    *   `false`
    *   `0`
    *   `NaN`
    *   `""`

    对于这些情况，您需要更详细一些并检查`undefined`

3.  当你首先有可选参数时也要小心，你必须知道所有参数的类型

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2016-09-02T04:16:30.933

在 optionalArg 为假的所有情况下，您最终都会得到 defaultValue。

```
function myFunc(requiredArg, optionalArg) {
    optionalArg = optionalArg || 'defaultValue';
    console.log(optionalArg);
    // Do stuff
}
myFunc(requiredArg);
myFunc(requiredArg, null);
myFunc(requiredArg, undefined);
myFunc(requiredArg, "");
myFunc(requiredArg, 0);
myFunc(requiredArg, false); 
```

上面所有的log都是defaultValue，因为6个都是falsy。在第 4、5、6 种情况下，您可能对将 optionalArg 设置为 defaultValue 不感兴趣，但由于它们是虚假的，因此它会设置。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-02-21T02:03:10.320

如果我错了，请纠正我，但这似乎是最简单的方法（无论如何，对于一个论点）：

```
function myFunction(Required,Optional)
{
    if (arguments.length<2) Optional = "Default";
    //Your code
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-11-07T18:05:53.480

这些比 typeof 运算符版本短。

```
function foo(a, b) {
    a !== undefined || (a = 'defaultA');
    if(b === undefined) b = 'defaultB';
    ...
} 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2013-04-12T15:35:28.207

我建议你以这种方式使用[ArgueJS](https://github.com/zvictor/ArgueJs)：

```
function myFunc(){
  arguments = __({requiredArg: undefined, optionalArg: [undefined: 'defaultValue'})

  //do stuff, using arguments.requiredArg and arguments.optionalArg
  //    to access your arguments

} 
```

您还可以替换`undefined`为您希望收到的参数类型，如下所示：

```
function myFunc(){
  arguments = __({requiredArg: Number, optionalArg: [String: 'defaultValue'})

  //do stuff, using arguments.requiredArg and arguments.optionalArg
  //    to access your arguments

} 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2016-10-29T03:44:18.487

似乎最安全的方法 -在决定使用***默认值之前处理所有\任何******虚假类型***的提供*参数*- 是检查调用函数中*可选参数的存在\存在。*

 **依赖于参数对象成员的创建，如果参数丢失，它甚至不会被创建，不管它可能被声明，我们可以这样编写你的函数：

```
 function myFunc(requiredArg, optionalArg){
        optionalArg = 1 in arguments ? optionalArg : 'defaultValue';
  //do stuff
  } 
```

利用这种行为：只要我们需要确保函数获得其过程中所需的某个值，我们就可以安全地任意明确地检查参数列表中的任何缺失值。

在下面的演示代码中，我们将故意将*无类型*和无值的*undefined* 作为默认值，以便能够确定它是否可能在错误的参数值（例如 0 false 等）上失败，或者它的行为是否符合预期***。***

```
function argCheck( arg1, arg2, arg3 ){

       arg1 = 0 in arguments || undefined;
       arg2 = 1 in arguments || false;
       arg3 = 2 in arguments || 0;
   var arg4 = 3 in arguments || null;

   console.log( arg1, arg2, arg3, arg4 ) 
} 
```

现在，检查一些虚假的参数值以查看它们的存在是否被正确检测到，因此评估为***true***：

```
argCheck( "", 0, false, null );
>> true true true true 
```

这意味着 - 他们没有未能识别/作为预期的参数值。在这里，我们检查了所有参数是否丢失，根据我们的算法，即使它们是*falsy*也应该获取它们的默认值。

```
argCheck( );
>> undefined false 0 null 
```

正如我们所看到的，参数*arg1、arg2、arg3*和未声明的*arg4*正在按顺序返回它们的确切***默认***值。因为我们现在已经确定它可以工作，所以我们可以重写函数，它实际上可以像第一个示例中那样使用它们，方法是使用：***if***或*三元*条件。

在具有多个可选参数的函数上， - 循环，可能会为我们节省一些代码。但是由于参数***名称***如果没有提供它们的值就不会被初始化，即使我们以编程方式编写了默认值，我们也不能再通过名称访问它们，我们只能通过*arguments[index]*访问它们，这对代码的可读性无用。

但是除了这种在某些编码情况下可能完全可以接受的不便之外，对于多个和任意数量的参数默认值，还有另一个无法解释的问题。这可能而且应该被认为是一个错误，因为我们不能再跳过参数，因为我们曾经可以在不给出值的情况下使用如下语法：

```
argCheck("a",,22,{}); 
```

因为它会抛出！这使得我们不可能用我们想要的默认值的特定*虚假*类型来替换我们的论点。这是愚蠢的，因为*arguments 对象*是一个类似数组的对象，并且期望支持这种语法和约定，本机或默认！

由于这个短视的决定，我们不再希望编写这样的函数：

```
function argCheck( ) {
    var _default = [undefined, 0, false, null ],
        _arg = arguments;

 for( var x in _default ) {
         x in _arg ? 1 : _arg[x] = _default[x];
        }
    console.log( _arg[0],_arg[1],_arg[2],_arg[3] );
} 
```

在这种情况下，我们将能够在参数行中写入所需类型的每个默认值，并且至少能够通过 args.index 访问它们。

例如这个函数调用会产生：

```
argCheck();
>>undefined 0 false null 
```

在我们的默认参数值数组中定义。但是，以下仍然是可能的：

```
argCheck({})
>>Object {  } 0 false null

argCheck({}, [])
>>Object {  } Array [  ] false null 
```

但遗憾的是没有：

```
 argCheck("a",,,22);
 >>SyntaxError: expected expression, got ',' 
```

否则会记录：

```
>>a 0 false 22 
```

但那是一个更好的世界！但是-对于原始问题-最顶层的功能就可以了。例如：

```
function argCheck( arg, opt ) {
         1 in arguments ? 1 : opt = "default";
         console.log( arg, opt );
} 
```

ps：很抱歉在编写它们时没有在我的参数输入中保留所选默认值的*类型*。

* * *

## 回答 #28

> 赞同：-2
> 
> 时间：2014-04-09T02:03:42.667

```
function foo(requiredArg){
  if(arguments.length>1) var optionalArg = arguments[1];
} 
```

# svn - 如何正确分支提交后并在 svn 中恢复主干？

> ID：148902
> 
> 赞同：9
> 
> 时间：2008-09-29T14:27:36.437
> 
> 标签：svn, branch

我有一些我已经决定的提交，事后，将是更多的分支工作而不是主干工作。如何创建分支并恢复主干，同时仍确保以后合并不痛苦？

是否像将当前主干复制到分支并还原主干一样简单？或者这会在以后引起头痛吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-29T18:49:26.870

我认为飞利浦方法类似于以下，假设最后一个“好”版本是 100，而您现在是 130，以创建新分支：

```
svn copy -r100 svn://repos/trunk svn://repos/branches/newbranch
svn merge -r 100:130 svn://repos/trunk svn://repos/branches/newbranch 
```

请注意，这个想法是保留在这些修订中所做的更改，以便您可以将它们应用回主干。

恢复主干：

```
svn merge -r130:100 .
svn ci -m 'reverting to r100 (undoing changes in r100-130)' . 
```

（执行这些操作的顺序无关紧要，因此您可以在创建分支之前恢复主干。）

然后你可以切换到你在 repo 中创建的新分支：

```
svn switch svn://repos/branches/newbranch workdir 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T14:41:34.110

老实说，我复制我的更改，恢复主干、分支，然后将我的更改提交到分支。主要原因是以后易于合并（如果您稍后在分支点从主干合并到分支，合并将包含您初始更改的恢复）。

这可能不是“正确”的方式，因为您在合并时总是可以跳过修订，但以后对我来说通常不会那么头疼。免责声明：我不是 svn 大师，所以对我来说可能更容易，因为我做错了 - 但我确实经常使用 svn。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-29T14:31:31.653

遵循菲利普的方法并没有错，除了它在修订历史中留下了一些“粗糙”。如果您想为了整洁而删除它们，并且修订版位于 HEAD，您可以按照[这些说明](https://stackoverflow.com/questions/33778/how-do-i-delete-1-file-from-a-revision-in-svn#56724)将它们从存储库中删除。

**更新：**由于他所说的原因，菲利普的方法比问题中建议的方法要好。Mine 和 Philip 的方法将是相似的，除了我建议从修订历史中删除修订之外的恢复主干。（正如我所说，只有当您要删除的所有修订都位于存储库的 HEAD 时，才能这样做。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T16:09:39.967

我这里没有可用的 svn，但我会尝试这样做：

确定你开始犯下坏事的历史点（比如你在“130”时的修订“100”）

```
svn copy trunk branch # create your branch while preserving history
svn copy trunk@100 trunk #replace current revision with revision 100 
```

这应该绕过不良历史记录而不添加反向合并（实际上您正在绕过 100 到 130 之间的主干历史记录，但您在分支中保留了指向该历史记录的链接并访问主干，同时强制 rev 仍然会产生正确的历史记录）

然后

```
svn switch branch workdir 
```

如果您想从主干中完全删除更改，这应该可以工作。如果你想保留一些小的，你可以从分支到主干再次挑选它们（如果你使用 svn 1.5，它将跟踪合并点并避免虚假冲突）

# .net - DLR 是否能够编译客户端代码？

> ID：148903
> 
> 赞同：2
> 
> 时间：2008-09-29T14:27:59.417
> 
> 标签：.net, dynamic-language-runtime

DLR 是专门用于在分发之前编译代码，还是可能用于以 JIT 方式编译客户端 Javascript？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T14:46:51.447

CLR 已经编译和 JIT 代码，据我所知，DLR 将完全构建在 CLR*之上。*所以我想答案是“都不是”。

# asp.net-mvc - 在 ASP.NET MVC 中按优先级返回表单、查询字符串、cookie 值

> ID：148906
> 
> 赞同：2
> 
> 时间：2008-09-29T14:28:16.857
> 
> 标签：asp.net-mvc, forms, query-string, webrequest

我想知道为什么在从用户请求中获取值时首选查询字符串。在哪里？1) System.Web.Mvc.DefaultModelBinder 的代码如下所示（只是其中的一部分）：

```
HttpRequestBase request = controllerContext.HttpContext.Request;
    if (request != null)
    {
        if (request.QueryString != null)
        {
            values = request.QueryString.GetValues(modelName);
            attemptedValue = request.QueryString[modelName];
        }
        if ((values == null) && (request.Form != null))
        {
            invariantCulture = CultureInfo.CurrentCulture;
            values = request.Form.GetValues(modelName);
            attemptedValue = request.Form[modelName];
        }
    } 
```

2）如果我在控制器中有一个带有这个签名的方法：

```
public ActionResult Save(int? x, string y) {... 
```

参数 (x, y) 绑定到来自查询字符串的值，而不是来自表单。我希望 Request.From 中的值比 Request.QueryString 中的值具有更高的优先级。

编辑：我看到第二种情况是由第一种情况（DefaultModelBinder）引起的，对吗？

背后的动机是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T21:47:10.967

可能是一致性。

自原始 ASP 模型以来，查询字符串一直是默认值。如果您想获取数据，如果查询字符串上也有相同的名称，那么您总是需要从那里显式获取值。

# .net - 我应该使用哪个依赖注入工具？

> ID：148908
> 
> 赞同：38
> 
> 时间：2008-09-29T14:28:52.800
> 
> 标签：.net, dependency-injection, inversion-of-control, castle-windsor, ioc-container

我正在考虑在我们的用户界面中将 Microsoft Unity 用于我的依赖注入工具。

我们的中间层已经在使用 Castle Windsor，但我认为我应该坚持使用 Microsoft。

有人对最好的依赖注入工具有什么想法吗？

*   [自动法](http://www.autofac.org/)
*   [城堡微内核/温莎](http://www.castleproject.org/index.html)
*   [PicoContainer.NET](http://picocontainer.org/)
*   拼图.NFactory
*   [春天.NET](http://www.springframework.net/)
*   [结构图](http://structuremap.net/structuremap/)
*   [忍者](http://ninject.org/)
*   [统一](http://msdn.microsoft.com/en-us/library/dd203101.aspx)
*   [简单的喷油器](http://simpleinjector.codeplex.com)
*   [NauckIT.微内核](https://www.ohloh.net/p/5670)
*   [WINTER4NET](http://www.winter4.net/)
*   [对象构建器](http://objectbuilder.codeplex.com/)

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-12-06T15:37:46.053

最近增加了其中 6 种（[Windsor](http://www.castleproject.org/)、[Unity](http://www.codeplex.com/unity)、[Spring.Net](http://www.springframework.net/)、[Autofac](http://code.google.com/p/autofac/)、[Ninject](http://ninject.org/)、[StructureMap](http://structuremap.sourceforge.net/Default.htm)）的使用率，我可以提供一个快速总结，包括我们的选择标准和最终选择。

*注意：我们没有考虑 PicoContainer.Net，因为我们的团队之一认为 .Net 端口与 Java 版本相比非常差。我们也没有研究 ObjectBuilder，因为 Unity 是在 ObjectBuilder2 之上构建的，默认情况下被认为是更好的选择。*

首先，我可以说它们或多或少都非常相似，这真的归结为最适合你的东西，以及你的具体要求。我们的要求包括：

## 要求

*   基于构造函数的注入（我们**不**打算使用属性、字段或方法注入）
*   可编程配置（**不是**XML）
*   容器层次结构（每个应用程序、每个请求和每个会话一个，以更隐式地将组件生命周期范围绑定到容器）
*   组件生命周期管理（用于更精细的范围界定，例如瞬态/单例）
*   从接口注入到类型或具体实例（例如`ILogger -> typeof(FileLogger)`或`ILogger -> new FileLogger()`）
*   用于预/后初始化的高级组件创建/“创建事件机制”
*   正确处理`IDisposable`容器拆解上的组件
*   有据可查和/或在线信息随时可用

    *[注意：虽然性能是一项要求，但并未将其纳入选择因素，因为根据此基准](http://www.codinginstinct.com/2008/05/ioc-container-benchmark-rerevisted.html)，所有审查的容器似乎都相似*

## 测试

每个容器都用于典型的 Asp.Net webforms 项目（因为这是我们的目标应用程序类型）。我们使用带有单个简单用户控件的单个简单页面，每个控件分别继承自一个基本页面/基本控件。我们在`BasePage`“每个请求”范围容器上使用了 1 个容器，在 global.asax 上使用 1 个容器作为“应用程序”范围，并尝试将它们链接在一起，以便可以从两个容器中解决依赖关系。

每个 Web 应用程序共享一组人为的域对象，模拟多层次的依赖关系、范围类型（​​单例/瞬态）以及托管和非托管类（`IDisposable`必需）。“顶级”依赖组件是从`BasePage`.

## 结果

Windsor - 满足所有标准，并拥有良好的案例历史、博客社区和在线文档。易于使用，可能是事实上的选择。通过工厂设施创建高级组件。还允许链接单独创建的容器。

Spring.Net - 冗长且无用的文档以及不明显/易于可编程配置。不支持泛型。未选择

Ninject - 易于使用，文档清晰。强大的功能集满足了我们所有的要求，除了容器层次结构，所以很遗憾没有选择。

StructureMap - 记录不充分，虽然有一个满足我们所有要求的相当高级的功能集，但是没有用于容器层次结构的内置机制，尽管可以使用 for 循环一起破解，请参见[此处](https://stackoverflow.com/questions/336990/chaining-containers-with-structuremap) lambda 表达式流利的接口似乎有点过头了起初很复杂，尽管可以封装起来。

Unity - 有据可查，易于使用，符合我们所有的选择标准，并且有一个简单的扩展机制来添加我们需要的创建前/后创建事件机制。必须从父容器创建子容器。

Autofac - 有据可查且相对易于使用，尽管 lambda 表达式配置似乎有点过于复杂，但同样可以轻松封装。组件范围是通过“标记”机制实现的，并且所有组件都使用构建器预先配置，这有点不方便。子容器是从父容器创建的，并从“标签”分配组件。允许通用注入。

## 结论

我们最终的选择是在 Windsor 和 Unity 之间，而这一次我们选择了 Unity，因为它易于使用、文档、扩展系统以及处于“生产”状态。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-30T06:00:01.500

如果您的系统在设计时考虑了 IoC/DI，那么坚持使用一个容器并不是很重要。通过正确的方法，您可以轻松地更改 IoC 库。

当然，容器必须提供足够的灵活性来支持常见的广泛使用的场景（生命周期管理、适当的容器嵌套、XML 和代码配置、拦截、快速解析）。

我建议在 Castle（广泛使用并且有很多集成库）和 Autofac（轻量级、快速并且具有适当的容器嵌套，但不是那么广泛使用）之间进行选择

Hanselman提供了[一份 IoC 容器](http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx)的完整列表

PS：你不想使用 Unity

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-03T20:36:06.680

这是一篇比较 .NET IoC 容器的好文章。 [http://blog.ashmind.com/index.php/2008/08/19/comparing-net-di-ioc-frameworks-part-1/](http://blog.ashmind.com/index.php/2008/08/19/comparing-net-di-ioc-frameworks-part-1/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-07-15T22:03:49.973

我一年前开始使用[Autofac](http://code.google.com/p/autofac/)，从那以后就再也没有回头。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-29T14:33:54.783

我是 Autofac 的粉丝，但 Windsor 和 Unity 都会做得很好（尽管 Windsor 比 Unity 更有能力，并且不需要归因您的代码）。但是，在系统中坚持使用单个容器有很多很好的非技术原因。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-29T14:36:48.927

使用有效的方法。大多数都具有他们独有的功能，并且几乎所有功能都比 Unity 更丰富。如果你只需要统一，你当然可以使用它。

仅仅因为它来自微软就使用微软的统一性是一种糟糕的决策方式。考虑一下您需要什么以及为什么，然后选择适合您需要的那个。

但是，如果可能的话，我赞同坚持使用单个容器的概念。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-02-02T20:58:02.477

我一直在使用[Managed Extensibility Framework](http://mef.codeplex.com)，发现它很容易使用。它已[集成到 .NET 4](http://msdn.microsoft.com/en-us/library/system.componentmodel.composition(VS.100).aspx)中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-15T22:11:49.947

除非您已经对可能的 IoC 容器解决方案之一所使用的特定子技术有经验和个人偏好，否则它们都运行良好，我看不出有任何一个特别具有使其脱颖而出的“杀手级功能”从其他人。Unity 可能最适合已经使用 P&P Enterprise Library 4.x 的解决方案...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-22T06:03:23.297

[IoC Container Benchmark - 性能比较](http://www.palmmedia.de/blog/2011/8/30/ioc-container-benchmark-performance-comparison)具有 20 多种产品的性能和功能比较表，并保持最新。

文章的结论：

> SimpleInjector、Hiro、Funq、Munq 和 Dynamo 提供了最好的性能，它们非常快。试试看！
> 
> 特别是[Simple Injector](http://simpleinjector.codeplex.com/)似乎是一个不错的选择。它非常快，有很好的文档，还支持拦截和通用装饰器等高级场景。

# asp.net - 从 ASP.NET 网站将查询结果发送到 Excel

> ID：148945
> 
> 赞同：5
> 
> 时间：2008-09-29T14:35:23.360
> 
> 标签：asp.net, excel

我们让用户在我们的网站上创建临时查询。我们希望用户选择他们的标准，然后单击提交并将结果自动传输到 Excel。我让应用程序填充数据表，然后使用数据表创建制表符分隔的字符串。问题是让它变得优秀。

将数据流式传输到 Excel 的最佳方式是什么？最好，我们不必让用户在单击提交按钮后关闭一个空窗口。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-29T14:37:21.983

将页面的文件类型更改为 excel，并且仅将构建表格所需的 HTML 流式传输到页面。来自[这里的代码](http://www.eggheadcafe.com/tutorials/aspnet/6e1ae1a8-8285-4b2a-a89b-fafc7668a782/aspnet-download-as-wor.aspx)

```
//for demo purpose, lets create a small datatable & populate it with dummy data
System.Data.DataTable workTable = new System.Data.DataTable();

//The tablename specified here will be set as the worksheet name of the generated Excel file. 
workTable.TableName = "Customers";
workTable.Columns.Add("Id");
workTable.Columns.Add("Name");
System.Data.DataRow workRow;

for (int i = 0; i <= 9; i++)
{
workRow = workTable.NewRow();
workRow[0] = i;
workRow[1] = "CustName" + i.ToString();
workTable.Rows.Add(workRow);
}

//...and lets put DataTable2ExcelString to work
string strBody = DataTable2ExcelString(workTable);

Response.AppendHeader("Content-Type", "application/vnd.ms-excel");
Response.AppendHeader("Content-disposition", "attachment; filename=my.xls");
Response.Write(strBody); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T14:47:27.293

如果您创建的页面只是包含结果的表格并将页面的内容类型设置为“application/vnd.ms-excel”，则输出将在 Excel 中。

```
Response.ContentType = "application/vnd.ms-excel"; 
```

如果要强制保存，可以执行以下操作：

```
Response.AddHeader("Content-Disposition", "attachment; filename=somefilename.xls"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T19:56:44.523

我已经有了一个 utils 函数。将其放入数据表后，您可以使用 Response 将其导出

```
 public static void DataTabletoXLS(DataTable DT, string fileName)
    {
        HttpContext.Current.Response.Clear();
        HttpContext.Current.Response.Charset = "utf-16";
        HttpContext.Current.Response.ContentEncoding = System.Text.Encoding.GetEncoding("windows-1250");
        HttpContext.Current.Response.AddHeader("content-disposition", string.Format("attachment; filename={0}.xls", fileName));
        HttpContext.Current.Response.ContentType = "application/ms-excel";

        string tab = "";
        foreach (DataColumn dc in DT.Columns)
        {
            HttpContext.Current.Response.Write(tab + dc.ColumnName.Replace("\n", "").Replace("\t", ""));
            tab = "\t";
        }
        HttpContext.Current.Response.Write("\n");

        int i;
        foreach (DataRow dr in DT.Rows)
        {
            tab = "";
            for (i = 0; i < DT.Columns.Count; i++)
            {
                HttpContext.Current.Response.Write(tab + dr[i].ToString().Replace("\n", "").Replace("\t", ""));
                tab = "\t";
            }
            HttpContext.Current.Response.Write("\n");
        }
        HttpContext.Current.Response.End();
               } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T14:39:20.963

我建议使用[文件处理程序 (.ashx)](http://www.aspcode.net/Creating-an-ASHX-handler-in-ASPNET.aspx)唯一的问题是从 DataTable 创建 excel 文件。有很多第三方产品可以为您执行此操作（例如 Infragistics 提供了一个可以执行此操作的组件）。

我强烈建议反对的一件事是在您的服务器上使用 Excel 互操作......它非常重量级并且不受支持。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T15:06:07.110

拥有数据集后，您可以将其转换为 object[,] 并将其插入 Excel 文档。然后，您可以将文档保存到磁盘并将其流式传输给用户。

```
 //write the column headers
        for (int cIndex = 1; cIndex < 1 + columns; cIndex++)
            sheet.Cells.set_Item(4, cIndex, data.Columns[cIndex - 1].Caption);
        if (rows > 0)
        {

            //select the range where the data will be pasted
            Range r = sheet.get_Range(sheet.Cells[5, 1], sheet.Cells[5 + (rows - 1), columns]);

            //Convert the datatable to an object array
            object[,] workingValues = new object[rows, columns];

            for (int rIndex = 0; rIndex < rows; rIndex++)
                for (int cIndex = 0; cIndex < columns; cIndex++)
                    workingValues[rIndex, cIndex] = data.Rows[rIndex][cIndex].ToString();

            r.Value2 = workingValues;
         } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-29T15:24:48.843

我将使用 .xls 文件扩展名的处理程序和一个免费组件将 DataTable 转换为本机 xls 格式。该站点[http://www.csvreader.com/](http://www.csvreader.com/)中的组件比 URL 所暗示的更多。最新版本的 excel 将抱怨 HTML 格式的 XLS 文件。还要记住要返回的数据的大小。您的 Web 服务器应该对此扩展使用压缩，并且您的代码应该检查返回的行数是否大于 Excel 在一个工作表中可以显示的行数；可能需要多张纸。[http://www.mrexcel.com/archive2/23600/26869.htm](http://www.mrexcel.com/archive2/23600/26869.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-29T09:51:59.053

请使用此代码解决您的问题。此代码将 excel 表转换为文本格式。希望这能解决您的问题

```
 grdSrcRequestExport.RenderControl(oHtmlTextWriter);
    string s = "";
    s=oStringWriter.ToString().Replace("<table cellspacing=\"0\" rules=\"all\" border=\"1\" style=\"border-collapse:collapse;\">", "");
    s="<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta http-equiv=Content-Type content=\"text/html; charset=us-ascii\"><meta name=ProgId content=Excel.Sheet><meta name=Generator content=\"Microsoft Excel 11\"><table x:str border=0 cellpadding=0 cellspacing=0 width=560 style='border-collapse: collapse;table-layout:fixed;width:420pt'>"+s.ToString()+"</table></body></html>";
    //Byte[] bContent = System.Text.Encoding.GetEncoding("utf-8").GetBytes();
    Response.Write(s); 
```

# mysql - mysqldump --password 真的按照它说的做吗？

> ID：148951
> 
> 赞同：35
> 
> 时间：2008-09-29T14:36:25.760
> 
> 标签：mysql, mysqldump, mysql-error-1044

我正在尝试使用`mysqldump`转储模式，它主要工作，但我遇到了一个好奇心：`-p`or`--password`选项似乎在做其他事情而不是设置密码（正如`man`页面和`--help`输出所说的那样）。

具体来说，它似乎正在执行此处指示的操作：http: [//snippets.dzone.com/posts/show/360](http://snippets.dzone.com/posts/show/360) - 即将数据库设置为转储。

为了支持我有点古怪的说法，我可以告诉你，如果我不指定`--password`(or `-p`) 选项，该命令会打印使用语句并退出并出现错误。如果我确实指定了它，我会立即提示我输入密码 (!)，然后`--password`转储选项中指定的数据库（或者在通常情况下会给出错误，即指定的密码与任何数据库名称都不匹配）。

这是一个成绩单：

```
    $ mysqldump -u test -h myhost --no-data --tables --password lost
    输入密码：
    -- MySQL 转储 10.10
    mysqldump: 得到错误: 1044: Access denied for user 'test'@'%' to
    选择数据库时数据库“丢失”

```

那么，什么给了？这是应该的工作方式吗？它肯定看起来没有意义，也不符合官方文档。最后，如果这就是它的工作方式，我该如何指定要在自动化作业中使用的密码？使用`expect`？？？

我正在使用`mysqldump Ver 10.10 Distrib 5.0.22, for pc-linux-gnu (i486)`.

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-09-29T14:41:13.970

从人 mysqldump ：

> --password[=密码], -p[密码]
> 
> 连接到服务器时使用的密码。如果使用短选项形式 (-p)，则选项和密码之间不能有空格。如果您在命令行中省略了 --password 或 -p 选项后面的密码值，系统会提示您输入密码值。
> 在命令行上指定密码应该被认为是不安全的。请参阅第 6.6 节“保护您的密码安全”。

从语法上讲，您没有正确使用 --password 开关。因此，命令行解析器将您使用“lose”作为独立参数，mysqldump 将其解释为数据库名称，就像您尝试使用更简单的命令一样`mysqldump lose`

要更正此问题，请尝试使用`--password=lose`or`-plose`或简单地使用`-p`or`--password`并在出现提示时键入密码。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-29T14:45:27.813

另一种选择是创建文件**~/.my.cnf**（权限需要为 600）。

将此添加到 .my.cnf 文件

```
[client]
password=lose 
```

这使您可以作为需要密码的 MySQL 用户进行连接，而无需实际输入密码。您甚至不需要 -p 或 --password。

对于编写 mysql 和 mysqldump 命令的脚本非常方便。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-04-08T16:18:17.547

我发现如果您的密码中包含特殊字符，就会发生这种情况。这里的mysql密码有一个！在其中，所以我必须做 ==password='xxx!xxxx' 才能正常工作。注意 ' 标记。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-29T14:41:41.270

尝试在 --password lost 之间放置一个“=”，例如：

```
--password=lose 
```

如果使用-p，则-p 和密码之间不能有空格，即'-plose'。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-29T14:39:41.213

我不确定它是否适用于 --password 版本，但如果您使用 -p 您可以在之后立即指定密码（关键是不要包含空格）：

mysqldump -pmy密码...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-29T14:39:13.180

您是否尝试过 --password=whatever-password-is ？

也许我错过了这个问题，但这就是我运行该工具的方式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-29T14:46:40.573

如果您使用 -p 或 --password 不带参数，您将收到提示，要求插入密码。

如果要在命令行中指定密码，则必须使用 -pYOURPASSWORD 或 --password=YOURPASSWORD。请注意，-p 后面没有空格，--password 后面有一个“=”符号。

在您的示例中，mysqldump 要求输入密码，然后将“丢失”视为数据库名称。如果那是您的密码，您应该包含一个“=”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-29T14:40:07.093

-p 选项不需要参数。您只需输入 -p 或 --password 以表明您将使用密码来访问数据库。它转储数据库的原因是您在 -p 之后放置的任何名称是 mysqldump 的最后一个参数应该是您要转储的数据库的名称（或者 --all-databases 如果您想要它们全部）。

@Nathan 的回答也是正确的。*您可以在 -p 开关之后立即*指定密码（在脚本中很有用，在执行命令后您无法手动输入密码的情况下）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-29T14:42:28.507

--密码[=密码]

这是[文档](http://dev.mysql.com/doc/refman/5.0/en/mysqldump.html)

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-09-29T15:11:00.000

也许您的用户“测试”没有访问您的“丢失”数据库的权限？

# yui - Yui，如何删除 2 列布局的边距？

> ID：148955
> 
> 赞同：1
> 
> 时间：2008-09-29T14:36:34.090
> 
> 标签：yui, margins, yui-grids

我希望两列触摸即。删除边距，我该怎么做？

我的代码：

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
 <HEAD>
  <TITLE>testing</TITLE>
  <!-- css --> 
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.5.2/build/reset-fonts-grids/reset-fonts-grids.css"> 
<!-- js --> 
<script type="text/javascript" src="http://yui.yahooapis.com/combo?2.5.2/build/utilities/utilities.js"></script> 
<style>
.yui-b {
    background-color: #eeeeee;
}

</style>
 </HEAD>

 <BODY>
  <div id="doc3" class="yui-t1"> <!-- change class to change preset --> 
        <div id="hd">header</div> 

        <div id="bd"> 
          <div id="yui-main"> 
         <div class="yui-b">
             bd.main
             </div> 
          </div> 

          <div class="yui-b">bd.other</div>         
        </div> 

        <div id="ft">footer</div> 
    </div> 
 </BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T14:39:36.423

在右列添加一个类并将 margin-left 设置为 0。

如果这不起作用，您可能必须将宽度增加 1% 或 2%。您可以使用 firebug 检查应用的样式并即时更改它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T11:20:17.157

请注意，您使用的是 YUI（Yahoo UI）。

查找 YUI reset.css。每个浏览器都有可能不同的边距、填充、字体大小默认值。你真的应该用这样的 reset.css 文件来启动每个 web 应用程序，以使所有内容都有一个共同点。否则，您可能会发现您“修复”了问题，只是在从另一台机器/平台查看时再次出现。

希望您从所有没有边距或填充的块元素开始，然后您可以在需要的地方添加边距和填充。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T12:00:03.153

**请注意，您使用的是 YUI（Yahoo UI）。**

# python - 在长时间运行的任务期间保持 GUI 响应

> ID：148963
> 
> 赞同：12
> 
> 时间：2008-09-29T14:37:32.140
> 
> 标签：python, user-interface, wxpython

在应用程序执行一些 CPU 密集型处理时保持 GUI 响应是有效 GUI 编程的挑战之一。

这是关于如何在 wxPython 中执行此操作[的一个很好的讨论。](http://wiki.wxpython.org/LongRunningTasks)总结一下，有3种方式：

1.  使用线程
2.  使用 wxYield
3.  分块工作并在 IDLE 事件处理程序中完成

*您*发现哪种方法最有效？来自其他框架（如 Qt、GTK 或 Windows API）的技术也受到欢迎。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-29T14:40:08.217

线程。它们是我一直追求的，因为你可以在你需要的每个框架中做到这一点。

一旦你习惯了一种语言/框架中的多线程和并行处理，你就会在所有框架上都很好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-29T15:34:33.343

绝对是线程。为什么？未来是多核的。几乎任何新的 CPU 都有多个内核，或者如果它只有一个内核，它可能支持超线程，从而假装它有多个内核。为了有效地利用多核 CPU（英特尔计划在不久的将来达到 32 核），您需要多个线程。如果你在一个主线程中运行所有内容（通常 UI 线程是主线程），用户将拥有 8、16 和一天 32 核的 CPU，而你的应用程序永远不会使用超过一个，IOW 运行速度要慢得多比它可以运行。

实际上，如果您现在计划应用程序，我会摆脱经典设计并考虑主/从关系。你的 UI 是主人，它唯一的任务就是与用户交互。那就是向用户显示数据并收集用户输入。每当您的应用程序需要“处理任何数据”（即使是少量数据和更重要的大数据）时，创建任何类型的“任务”，将此任务转发到后台线程并让线程执行任务，向后台提供反馈UI（例如，它已经完成了多少百分比，或者任务是否仍在运行，因此 UI 可以显示“正在进行的工作指示器”）。如果可能，将任务拆分为许多小的、独立的子任务，并运行多个后台进程，为每个子任务提供一个子任务。

实际上，像苹果和微软这样的公司已经在计划如何让他们仍然最单线程的 UI 本身成为多线程的。即使采用上述方法，您也可能有一天会遇到 UI 本身就是瓶颈的情况。后台进程处理数据的速度比 UI 将数据呈现给用户或要求用户输入的速度要快得多。今天，许多 UI 框架都很少是线程安全的，许多根本不是线程安全的，但这将会改变。串行处理（一个接一个地完成一个任务）是一种垂死的设计，并行处理（一次完成许多任务）是未来的发展方向。看看图形适配器。如果仅查看 GPU 的处理速度（以 MHz/GHz 为单位），即使是最现代的 NVidia 卡的性能也很差。在 3D 计算方面，它怎么能打败 CPU？简单的：它不是一个接一个地计算一个多边形点或一个纹理像素，而是并行计算其中的许多（实际上是同时计算一大堆），这样它就达到了仍然让 CPU 哭泣的吞吐量。例如，ATI X1900（也是竞争对手的名字）有 48 个着色器单元！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-18T18:40:36.587

我认为`delayedresult`这是您正在寻找的：

[http://www.wxpython.org/docs/api/wx.lib.delayedresult-module.html](http://www.wxpython.org/docs/api/wx.lib.delayedresult-module.html)

有关示例，请参见 wxpython 演示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T14:47:14.283

线程或进程取决于应用程序。有时最好让 GUI 成为它自己的程序，并在它有工作要做时向其他程序发送异步调用。您最终仍将在 GUI 中使用多个线程来监视结果，但如果正在完成的工作很复杂并且没有直接连接到 GUI，它可以简化事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T18:53:30.743

线程 - 让我们使用一个简单的 2 层视图（GUI、应用程序逻辑）。

应用程序逻辑工作应该在一个单独的 Python 线程中完成。对于需要向上传播到 GUI 层的异步事件，使用 wx 的事件系统来发布自定义事件。发布 wx 事件是线程安全的，因此您可以想象从多个上下文中执行此操作。

在另一个方向工作（触发应用程序逻辑的 GUI 输入事件），我发现最好自制一个自定义事件系统。使用 Queue 模块以线程安全的方式推送和弹出事件对象。然后，对于每个同步成员函数，将其与将同步函数对象和参数推送到事件队列的异步版本配对。

如果一次只能执行一个应用程序逻辑级操作，则此方法特别有效。这个模型的好处是同步很简单——每个同步函数在它自己的上下文中从头到尾按顺序工作，而不用担心抢占或手工编码的让步。您不需要锁来保护您的关键部分。在函数结束时，向 GUI 层发布一个事件，指示操作已完成。

您可以扩展它以允许存在多个应用程序级线程，但通常会重新出现同步问题。

*编辑*- 忘了提到它的美妙之处在于可以将应用程序逻辑与 GUI 代码完全分离。如果您决定使用不同的框架或使用提供应用程序的命令行版本，模块化会有所帮助。为此，您将需要一个由 GUI 层实现的中间事件调度程序（应用程序级别 -> GUI）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-29T14:45:16.160

使用 Qt/C++ for Win32。

我们将主要工作单元划分为不同的流程。GUI 作为一个单独的进程运行，并且能够根据需要从“工作”进程命令/接收数据。在当今的多核世界中运行良好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T15:17:27.550

此答案不适用于 OP 关于 Python 的问题，而更多的是元响应。

简单的方法是线程。然而，并不是每个平台都有抢占式线程（例如 BREW，一些其他嵌入式系统）。如果可能，只需将工作分块并在 IDLE 事件处理程序中完成。

在 BREW 中使用线程的另一个问题是它不会清理 C++ 堆栈对象，因此如果您简单地终止线程，就很容易泄漏内存。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-29T15:17:47.300

我使用线程，所以 GUI 的主事件循环永远不会阻塞。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-29T15:20:07.450

对于某些类型的操作，使用单独的进程很有意义。过去，生成一个进程会产生大量开销。使用现代硬件，这种开销在屏幕上几乎不是一个亮点。如果您正在生成一个长时间运行的进程，则尤其如此。

一个（有争议的）优点是它是一个比线程更简单的概念模型，可能会导致更可维护的代码。它还可以使您的代码更易于测试，因为您可以编写执行这些外部过程的测试脚本，而无需涉及 GUI。有些人甚至可能认为这是主要优势。

对于我曾经编写过的一些代码，从线程切换到单独的进程导致净减少超过 5000 行代码，同时使 GUI 响应更快，代码更易于维护和测试，同时改进整体的整体表现。

# asp.net - 在 ASP .NET 2.0 和 SQL Server 2005 中加密工资值

> ID：148964
> 
> 赞同：7
> 
> 时间：2008-09-29T14:37:49.097
> 
> 标签：asp.net, sql-server, encryption

我有一个连接到 SQL Server 2005 数据库的 ASP .NET 2.0 网站。该网站非常简单，并存储有关员工的信息，包括薪水。

加密工资值的最佳方法是什么，这样除了使用网络应用程序的授权员工外，没有人（包括我自己）可以看到它是什么？

我不想在 SQL Server 上加密/解密，因为我可以运行 SQL Profiler 来查看信息，所以我假设加密/解密发生在 Web 服务器上的 BLL 中？

另外，我是否需要 SSL 来阻止有人在浏览器和 Web 服务器之间嗅探 HTTP 响应？

非常感谢！

安东尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-29T14:41:08.450

SSL 可能是阻止某人嗅探的最佳选择，但请注意它仍然是可能的。

至于另一点，SQL Server 2005 支持开箱即用的表级加密。[这是一篇关于它的文章](http://blogs.technet.com/keithcombs/archive/2005/11/24/sql-server-2005-data-encryption.aspx)。您可以创建一个链接到员工的 SALARY 表并保持该表加密。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T14:50:49.113

webapp 的开发人员仍然可以访问工资数据——这完全是信任问题。为了解决这个问题，您可以切换到在客户端进行加密/解密的模型，但这更加麻烦并且仍然不是 100% 安全的。安全性始终是与便利性的权衡。

您应该使用 TLS/SSL（即 HTTPS），以便更难窃听 HTTP 流量。

您可能会考虑的一种攻击是将您自己的加密工资数字替换为您感兴趣的人的数字，然后致电会计部门并询问您当前的工资数字是多少。消除攻击的一种方法是让加密的薪水字段的内容引用它所属的人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-29T14:44:01.297

您可以在代码中使用许多加密方法。确保您选择一个带有钥匙和“盐”的钥匙（而不是每次都使用相同的钥匙）。如果每次加密工资时使用相同的密钥（不加盐），那么两个具有相同工资的员工将在数据库中显示相同的加密值，从而损害工资信息的安全性。

您可以使用每个员工的唯一 ID 作为盐。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-29T14:45:46.487

您肯定需要 SSL 来防止嗅探敏感的 Web 流量（更不用说登录），但这并不能解决您的服务器端加密问题。

让您作为开发人员无法访问数据是一个难以破解的难题。为了让它真正起作用，所有的加密/解密只需要在你无权访问的机器上完成。从理论上讲，您必须制作某种浏览器扩展程序来解密客户端计算机上的工资数据。您的雇主必须足够信任您，以免在客户端代码中设置后门（或者至少让您有可能进行代码审计）。

在大多数情况下，更容易相信开发人员不会泄露数据。将其保持在需要知道的基础上是个好主意，但最终有些人需要知道。（例如，会计人员总是看到工资数据。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-29T14:47:06.483

您肯定想使用 SSL 来保证运输安全。您还可以为 Web 服务器和数据库服务器之间的传输设置 IPSec。

至于数据库中的安全，SQL Server 2005 有几个加密功能：

1) EncryptByAsymKey - [http://msdn.microsoft.com/en-us/library/ms186950.aspx](http://msdn.microsoft.com/en-us/library/ms186950.aspx)
2) EncryptByKey - [http://msdn.microsoft.com/en-us/library/ms174361.aspx](http://msdn.microsoft.com/en-us/library/ms174361.aspx)
3) EncryptByPassPhrase - [http://msdn.microsoft.com/en-us/library/ms190357.aspx](http://msdn.microsoft.com/en-us/library/ms190357.aspx)
4) EncryptByCert - [http://msdn.microsoft.com/en-us/library/ms188061.aspx](http://msdn.microsoft.com/en-us/library/ms188061.aspx)

显然，所有这些都具有相关的解密功能。

您可以将密钥或您选择的任何内容存储在 Web 服务器上（在 machine.config 或 web.config 或某处），然后将其传递给您的存储过程（或以某种方式与您的 sql 一起）进行加密。

# windows - Windows 批处理文件：.bat 与 .cmd？

> ID：148968
> 
> 赞同：836
> 
> 时间：2008-09-29T14:39:07.190
> 
> 标签：windows, batch-file, cmd

据我了解，`.bat`是旧的 16 位命名约定，`.cmd`适用于 32 位 Windows，即以 NT 开头。但是我继续在各处看到 .bat 文件，并且使用任一后缀它们的工作方式似乎完全相同。假设我的代码永远不需要在任何比 NT 更旧的东西上运行，那么我命名批处理文件的方式真的很重要，还是使用错误的后缀有一些问题在等着我**？**

* * *

## 回答 #1

> 赞同：509
> 
> 时间：2008-09-29T14:41:55.700

来自[Mark Zbikowski](http://en.wikipedia.org/wiki/Mark_Zbikowski)本人发布的[这个新闻组：](https://groups.google.com/group/microsoft.public.win2000.cmdprompt.admin/msg/ad9066638815812c)

> 就 CMD.EXE 而言，.CMD 和 .BAT 之间的区别在于： 启用扩展后，.CMD 文件中的 PATH/APPEND/PROMPT/SET/ASSOC 将设置 ERRORLEVEL 而不管错误。.BAT 仅在错误时设置 ERRORLEVEL。

换句话说，如果 ERRORLEVEL 设置为非 0，然后您运行这些命令之一，则生成的 ERRORLEVEL 将是：

*   在 .bat 文件中保持其非 0 值
*   在 .cmd 文件中重置为 0。

* * *

## 回答 #2

> 赞同：450
> 
> 时间：2008-09-29T18:03:44.077

以下是来自该线程中各种答案和引用的参考文献的经过验证的信息的汇编：

0.  `command.com`是 MS-DOS 中引入的 16 位命令处理器，也用于 Win9x 系列操作系统。
1.  `cmd.exe`是 Windows NT 中的 32 位命令处理器（64 位 Windows 操作系统也有 64 位版本）。`cmd.exe`从来都不是 Windows 9x 的一部分。它起源于 OS/2 版本 1.0，而 OS/2 版本`cmd`开始于 16 位（但仍然是一个完全成熟的保护模式程序，带有类似的命令`start`）。Windows NT 继承`cmd`自 OS/2，但 Windows NT 的 Win32 版本从 32 位开始。尽管 OS/2 在 1992 年变成了 32 位，但它`cmd`仍然是一个 16 位的 OS/2 1.x 程序。
2.  env 变量定义了`ComSpec`由脚本启动的程序。（从 WinNT 开始，默认为.）`.bat``.cmd``cmd.exe`
3.  `cmd.exe`向后兼容`command.com`.
4.  `cmd.exe`可以命名`.cmd`为防止在 Windows 9x 上意外执行而设计的脚本。这个文件扩展名也可以追溯到 OS/2 版本 1.0 和 1987。

以下是`cmd.exe`不支持的功能列表`command.com`：

*   长文件名（超过 8.3 格式）
*   命令历史
*   制表符补全
*   转义字符：（`^`用于`\ & | > < ^`：）
*   目录栈：`PUSHD`/`POPD`
*   整数运算：`SET /A i+=1`
*   搜索/替换/子字符串：`SET %varname:expression%`
*   命令替换：（`FOR /F`以前存在，已增强）
*   职能：`CALL :label`

执行顺序：

如果脚本（test.bat、test.cmd）的 .bat 和 .cmd 版本都在同一个文件夹中，并且您在没有扩展名的情况下运行脚本（test），则默认情况下，脚本的 .bat 版本将运行，即使在 64 位 Windows 7 上。执行顺序由 PATHEXT 环境变量控制。有关详细信息，请参阅[命令提示符执行文件](https://stackoverflow.com/questions/605101/order-in-which-command-prompt-executes-files-with-the-same-name-a-bat-vs-a-cmd-v)的顺序。

参考：

*   [命令文件](https://ss64.com/nt/syntax.html)
*   [命令网](http://gregvogl.net/courses/os/handouts/doscmdref.pdf "PDF格式")

维基百科：[命令外壳的比较](http://en.wikipedia.org/wiki/Comparison_of_computer_shells)

* * *

## 回答 #3

> 赞同：135
> 
> 时间：2012-08-17T18:13:01.143

这些答案有点太长了，而且侧重于交互使用。脚本的重要区别是：

*   `.cmd`防止在非 NT 系统上无意执行。
*   `.cmd`启用内置命令以在成功时将 Errorlevel 更改为 0。

不是那么令人兴奋，是吗？

过去在`.cmd`文件中启用了许多附加功能，称为命令扩展。但是，现在默认情况下对Windows 2000 和更高版本下的文件`.bat`启用它们。`.cmd`

*底线：*在 2012 年及以后，我建议`.cmd`只使用。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2008-09-29T14:41:26.140

不——一点也不重要。在 NT 上，.bat 和 .cmd 扩展名都导致 cmd.exe 处理器以完全相同的方式处理文件。

[有关来自 MS TechNet ( http://technet.microsoft.com/en-us/library/cc723564.aspx](http://technet.microsoft.com/en-us/library/cc723564.aspx) )的 WinNT 类系统上 command.com 与 cmd.exe 的其他有趣信息：

> 这种行为揭示了 Windows NT 非常重要的一个非常微妙的特性。Windows NT 附带的 16 位 MS-DOS 外壳 (COMMAND.COM) 是专门为 Windows NT 设计的。当这个 shell 输入一个命令来执行时，它实际上并没有执行它。相反，它会打包命令文本并将其发送到 32 位 CMD.EXE 命令外壳以执行。因为所有命令实际上都由 CMD.EXE（Windows NT 命令外壳）执行，所以 16 位外壳继承了完整 Windows NT 外壳的所有功能和功能。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2012-07-07T22:47:44.683

**RE：**显然，何时调用 command.com 有点复杂。

几个月前，在一个项目的过程中，我们不得不弄清楚为什么我们想在 CMD.EXE 下运行的一些程序实际上是在 COMMAND.COM 下运行的。有问题的“程序”是一个非常古老的 .BAT 文件，仍然每天运行。

我们发现批处理文件在 COMMAND.COM 下运行的原因是它是从 .PIF 文件（也很古老）启动的。由于只能通过 PIF 获得的特殊内存配置设置已变得无关紧要，因此我们将其替换为传统的桌面快捷方式。

从快捷方式启动的同一个批处理文件在 CMD.EXE 中运行。当您考虑它时，这是有道理的。我们花了这么长时间才弄明白的部分原因是我们忘记了它在启动组中的项目是 PIF，因为它从 1998 年就开始生产了。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2014-11-22T17:04:09.607

尽管如此，在 Windows 7 上，BAT 文件也有这个区别：如果您曾经在同一目录中创建文件 TEST.BAT 和 TEST.CMD，并在该目录中运行 TEST，它将运行 BAT 文件。

```
C:\>echo %PATHEXT%
.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC

C:\Temp>echo echo bat > test.bat

C:\Temp>echo echo cmd > test.cmd

C:\Temp>test

C:\Temp>echo bat
bat

C:\Temp> 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2014-02-05T14:46:29.333

由于原始帖子是关于使用 .bat 或 .cmd*后缀*的后果，因此不一定是文件中的*命令*......

.bat 和 .cmd 之间的另一个区别是，如果存在具有相同文件名和扩展名的两个文件，则：

*   在命令行输入*文件名*或*文件名*.bat 将运行 .bat 文件

*   要运行 .cmd 文件，您必须输入*文件名*.cmd

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-09-29T14:47:51.710

批处理中的所有工作都应该在 cmd 中工作；cmd 提供了一些用于控制环境的扩展。此外，cmd 由新的 cmd 解释器执行，因此随着 bat 在 NTVDM 模拟 16 位环境下运行，它应该更快（在短文件上不明显）和更稳定

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-29T17:40:39.000

我相信，如果您将 ComSpec 环境变量的值更改为`%SystemRoot%system32\cmd.exe`(CMD)，那么文件扩展名是`.BAT`还是`.CMD`. 我不确定，但这甚至可能是 WinXP 及更高版本的默认设置。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-10-18T14:14:07.180

.cmd 和 .bat 文件执行是不同的，因为在 .cmd 错误级别变量中，它可以在受命令扩展影响的命令上更改。就是这样。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-29T14:45:17.330

扩展没有区别。

`COMMAND.COM`处理文件与处理`CMD.EXE`.

* * *

## 回答 #12

> 赞同：-10
> 
> 时间：2010-04-03T20:22:22.120

区别：

.cmd 文件在执行之前被加载到内存中。.bat 文件执行一行，读取下一行，执行该行...

您可以在执行脚本文件时遇到此问题，然后在执行完成之前对其进行编辑。bat 文件会因此而混乱，但 cmd 文件不会。

# visual-studio - 用于自动添加所需的“使用”语句的 Visual Studio 键盘快捷键

> ID：148977
> 
> 赞同：259
> 
> 时间：2008-09-29T14:40:04.177
> 
> 标签：visual-studio, visual-studio-2008, keyboard-shortcuts

扩展小红线的键盘快捷键是什么，它为您提供菜单，您可以在其中选择将必要的`using`语句添加到文件顶部？

* * *

## 回答 #1

> 赞同：410
> 
> 时间：2008-09-29T14:42:42.563

`Ctrl`+`.`显示菜单。`Alt`我发现这比替代方法++更容易`Shift`输入`F10`。

这可以通过转到工具 > 选项 > 环境 > 键盘 > Visual C# > View.QuickActions 重新绑定到更熟悉的东西

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-09-29T14:41:17.560

`Alt`++将显示`Shift`与`F10`智能标签关联的菜单。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2010-02-24T08:15:25.197

我强烈建议您查看 Visual Studio 插件 ReSharper。它有一个 QuickFix 功能，可以做同样的事情（还有更多）。

但 ReSharper 不要求光标位于需要新命名空间的实际代码上。比如说，您将一些代码复制/粘贴到源文件中，只需单击几下`Alt`+ `Enter`，所有必需的使用都包括在内。

哦，它还确保将所需的程序集引用添加到您的项目中。例如，您创建了一个包含[NUnit](http://en.wikipedia.org/wiki/NUnit)单元测试的新项目。您编写的第一个类，您添加 [TestFixture] 属性。如果您的解决方案中已经有一个项目引用了 NUnit DLL 文件，那么 ReSharper 能够看到 TestFixtureAttribute 来自该 DLL 文件，因此它会自动将该程序集引用添加到您的新项目中。

它还为扩展方法添加了必需的命名空间。至少 ReSharper 版本 5 beta 可以。我很确定 Visual Studio 的内置解析功能不会这样做。

不利的一面是，它是一种商业产品，因此您必须为此付费。但是如果你使用商业软件，所获得的生产力（插件可以做很多其他很酷的事情）超过了价格标签。

是的，我是粉丝；）

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-07-24T05:51:30.460

**在 Visual Studio 2010 中，您将在名为View.ShowSmartTag**的命令中找到用于解析命名空间的键盘命令。我的也被映射到`Shift`++ `Alt`，`F10`这很麻烦——所以我通常会及时重新映射。

关于 Pete 对 ReSharper 的评论——是的，对于任何有预算的人来说，ReSharper 让生活成为一种绝对的乐趣。事实上，它足够智能地解决当前引用之外的依赖关系，并将它们添加为使用和引用，这不仅会为您节省无数时间，还会让您忘记所有框架类所在的位置 ;-) 这就是它的简单之处开发生活......然后我们甚至还没有开始 ReSharper 重构。

DevExpress 的[CodeRush](https://en.wikipedia.org/wiki/CodeRush)在这方面没有提供任何帮助；或者对我来说没有什么是显而易见的——非专家模式下的 DevExpress 在它想要为你做的事情上是非常即将到来的 :-)

最后的评论 - 这个解决依赖关系的 IDE 功能在 Java IDE 世界中是如此成熟和完善，以至于大部分 Internet 示例甚至不再显示导入（使用）。

这就是说，微软现在终于在这方面提供了一些东西，但我也很清楚，微软的开发（对于我们中的许多人）现在已经完成了一个完整的循环——关注点从源头到视觉设计师，再回到关注点再次在源代码上 - 这意味着您在源代码视图/无论是 C#、VB 还是 XAML 中花费的时间都在增加，而拖放到“表单”上的时间在减少。有了这个基本假设，很容易说微软应该开始专注于让编辑器更智能、键盘快捷键更容易、代码/错误检查和评估更好——愚蠢的编辑器让你在谷歌上搜索一个类来查找对于我们大多数人来说，它所在的图书馆已经消失（或者无论如何都应该消失）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-29T14:43:12.157

*   上下文菜单键（一个带有菜单的键，在右侧 Windows 键旁边）
*   然后从菜单中选择“解决”。这可以通过按“s”来完成。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-12T12:50:02.167

It's `ctrl` + `.` when, for example, you try to type `List` you need to type `<` at the end and press `ctrl` + `.` for it to work.

# actionscript-3 - 将一个函数传递给 Actionscript 3 中的另一个函数

> ID：148982
> 
> 赞同：11
> 
> 时间：2008-09-29T14:40:53.957
> 
> 标签：actionscript-3

我有一个将数组作为参数传递给另一个函数的函数，该数组中将有多种数据类型，但我想知道如何传递函数或对函数的引用，以便其他函数可以随时调用它.

前任。

功能一：

```
add(new Array("hello", some function)); 
```

功能 B：

```
public function b(args:Array) {
    var myString = args[0];
    var myFunc = args[1];
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-02T20:43:08.927

只需将函数名称作为参数传递，不，就像在 AS2 或 JavaScript 中一样？

```
function functionToPass()
{
}

function otherFunction( f:Function )
{
    // passed-in function available here
    f();
}

otherFunction( functionToPass ); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-29T14:41:51.240

这在 ActionScript 中非常简单：

```
function someFunction(foo, bar) {
   ...
}

function a() {
    b(["hello", someFunction]);
}

function b(args:Array) {
    var myFunc:Function = args[1];
    myFunc(123, "helloworld");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-07T20:28:53.507

您可以执行以下操作：

```
add(["string", function():void
{
trace('Code...');
}]); 
```

...或者...

```
...
add(["string", someFunction]);
...

private function someFunction():void
{
trace('Code...');
} 
```

# xsd - XML 模式中的递归？

> ID：148988
> 
> 赞同：47
> 
> 时间：2008-09-29T14:41:37.900
> 
> 标签：xsd

我需要创建一个 XML 模式来验证 XML 文档的树结构。我不确切知道树的出现次数或深度级别。

XML 示例：

```
<?xml version="1.0" encoding="utf-8"?>
<node>
  <attribute/>
  <node>
    <attribute/>
    <node/>      
  </node>
</node> 
```

验证它的最佳方法是什么？递归？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-09-29T14:45:42.323

如果您需要递归类型声明，这里有一个可能有帮助的示例：

```
<xs:schema id="XMLSchema1"
    targetNamespace="http://tempuri.org/XMLSchema1.xsd"
    elementFormDefault="qualified"
    xmlns="http://tempuri.org/XMLSchema1.xsd"
    xmlns:mstns="http://tempuri.org/XMLSchema1.xsd"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
>
  <xs:element name="node" type="nodeType"></xs:element>

  <xs:complexType name="nodeType">    
    <xs:sequence minOccurs="0" maxOccurs="unbounded">
      <xs:element name="node" type="nodeType"></xs:element>
    </xs:sequence>
  </xs:complexType>

</xs:schema> 
```

如您所见，这定义了一个递归模式，其中只有一个名为“node”的节点，其深度可以根据需要进行。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-09-29T14:44:07.210

XSD 确实允许元素的递归。这[是给你的样本](https://web.archive.org/web/20140421153734/http://www.stylusstudio.com/xmldev/200501/post80430.html)

```
<xsd:element name="section">
  <xsd:complexType>
    <xsd:sequence>
      <xsd:element ref="title"/>
      <xsd:element ref="para" maxOccurs="unbounded"/>
      <xsd:element ref="section" minOccurs="0" maxOccurs="unbounded"/>
    </xsd:sequence>
  </xsd:complexType>
</xsd:element> 
```

如您所见，section 元素包含一个类型为 section 的子元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-24T13:00:53.407

其他解决方案非常适合使根元素递归。但是，为了使非根元素递归而不在过程中将其变成有效的根元素，需要一种稍微不同的方法。

假设您要定义一种 XML 消息格式，用于在分布式应用程序中的节点之间交换结构化数据。它包含以下元素：

*   `<message>`- 根元素；
*   `<from>`- 消息的来源；
*   `<to>`- 消息的目的地；
*   `<type>`- 消息中编码的数据结构类型；
*   `<data>`- 消息中包含的数据。

为了支持复杂的数据类型，`<data>`是一个递归元素。这使得可以编写如下消息，例如[`geometry_msgs/TwistStamped`](http://docs.ros.org/melodic/api/geometry_msgs/html/msg/TwistStamped.html)向飞行的无人机发送消息，指定其线性和角（即旋转）速度：

```
<?xml version="1.0" encoding="utf-8"?>

<message xmlns="https://stackoverflow.com/message/1.0.0">
  <from>controller:8080</from>
  <to>drone:8080</to>
  <type>geometry_msgs/TwistStamped</type>
  <data name="header">
    <data name="seq">0</data>
    <data name="stamp">
      <data name="sec">1</data>
      <data name="nsec">0</data>
    </data>
    <data name="frame_id">base_link</data>
  </data>
  <data name="twist">
    <data name="linear">
      <data name="x">1.0</data>
      <data name="y">0</data>
      <data name="z">1.0</data>
    </data>
    <data name="angular">
      <data name="x">0.3</data>
      <data name="y">0</data>
      <data name="z">0</data>
    </data>
  </data>
</message> 
```

我们可以很容易地编写一个 XML 模式来验证这种格式：

```
<?xml version="1.0" encoding="utf-8"?>

<xs:schema
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  targetNamespace="https://stackoverflow.com/message/1.0.0"
  elementFormDefault="qualified"
  xmlns="https://stackoverflow.com/message/1.0.0"
>
  <xs:element name="data">
    <xs:complexType mixed="true">
      <xs:sequence>
        <xs:element ref="data" minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="name" type="xs:string" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="message">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="from" type="xs:string"/>
        <xs:element name="to" type="xs:string"/>
        <xs:element name="type" type="xs:string"/>
        <xs:element ref="data" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

上面架构的问题在于它创建`<data>`了一个根元素，这意味着它还验证了下面的文档：

```
<?xml version="1.0" encoding="utf-8"?>

<data xmlns="https://stackoverflow.com/message/1.0.0" name="twist">
  <data name="header">
    <data name="seq">0</data>
    <data name="stamp">
      <data name="sec">1</data>
      <data name="nsec">0</data>
    </data>
    <data name="frame_id">base_link</data>
  </data>
  <data name="twist">
    <data name="linear">
      <data name="x">1.0</data>
      <data name="y">0</data>
      <data name="z">1.0</data>
    </data>
    <data name="angular">
      <data name="x">0.3</data>
      <data name="y">0</data>
      <data name="z">0</data>
    </data>
  </data>
</data> 
```

为了避免这种副作用，我们不是`<data>`直接在全局级别定义元素，而是先定义一个`data`类型，然后`data`在内部定义该类型的元素`message`：

```
<?xml version="1.0" encoding="utf-8"?>

<xs:schema
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  targetNamespace="https://stackoverflow.com/message/1.0.0"
  elementFormDefault="qualified"
  xmlns="https://stackoverflow.com/message/1.0.0"
>
  <xs:complexType name="data" mixed="true">
    <xs:sequence>
      <xs:element name="data" type="data" minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
    <xs:attribute name="name" type="xs:string" use="required"/>
  </xs:complexType>

  <xs:element name="message">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="from" type="xs:string"/>
        <xs:element name="to" type="xs:string"/>
        <xs:element name="type" type="xs:string"/>
        <xs:element name="data" type="data" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

请注意，我们最终不得不定义`<data>`元素两次——一次在`data`类型内部，一次在内部`<element>`——但除了一些工作重复之外，这没有任何意义。

# vmware - 在 ESXi 上归档 VMware 映像

> ID：148999
> 
> 赞同：1
> 
> 时间：2008-09-29T14:43:20.627
> 
> 标签：vmware, archive, esxi

有没有办法在 ESXi 服务器上压缩 VMWare 映像以进行存档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T15:02:19.380

简单地使用您最喜欢的存档器/压缩器实用程序有什么问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T21:11:01.620

veeam fastscp 将其复制到您的管理站。之后随心所欲地对待...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T15:53:24.780

我同意[@Sec](https://stackoverflow.com/questions/148999/archiving-vmware-images-on-esxi#149059) - 我使用 .tar.gz 或 .tar.bz2。***************************************