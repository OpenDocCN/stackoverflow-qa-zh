# StackOverflow 问答 12098000-12098999

# ios - iOS 线程违规检测？

> ID：12098004
> 
> 赞同：0
> 
> 时间：2012-08-23T18:36:32.230
> 
> 标签：ios, cocoa-touch, objective-c-blocks, concurrent-programming

在 iOS 上，我想知道是否有任何类似于 NSZombies 标志的东西可以设置为在需要主线程时从后台线程调用 API 时检测/引发。

对于块，似乎很容易陷入这样一种情况，即人们要么做出错误的假设，要么错误地判断哪个线程正在做什么。可以检测何时从错误线程进行调用的调试标志对于查找这些情况非常有用。

我主要关心的是Apple的框架（Cocoa Touch）。

提交了错误报告，#12180446。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:45:32.470

在需要在主线程上的任何 API 中使用以下内容：

```
NSAssert([NSThread isMainThread], @"This must only be called on the main thread."); 
```

Apple 没有提供这样一个涵盖所有 UIKit 的东西。您需要在需要时调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T18:55:51.200

我做一些更实际的事情。当我调用块时。我用自定义方法来做。

```
+ (void) ensureDispatchOfBlock:(dispatch_block_t) block onQueue:(dispatch_queue_t) queue  async:(BOOL) async{
    if (queue == nil || dispatch_get_current_queue() == queue){
        block();
    }
    else {
        if (async){
            dispatch_async(queue, block);
        }
        else {
            dispatch_sync(queue, block);
        }
    }
}

+ (void) ensureDispatchOnMainThread:(dispatch_block_t) block async:(BOOL) async{
    [self ensureDispatchOfBlock:block onQueue:dispatch_get_main_queue() async:async];
} 
```

这使我能够“确保”正在提供的块的调度将在其预期的块上发生。

请记住`async:NO`非常谨慎地使用。

# android - 查询返回空指针异常

> ID：12098005
> 
> 赞同：0
> 
> 时间：2012-08-23T18:36:34.237
> 
> 标签：android, database, sqlite

您好，我的查询有问题。我想我错过了什么，但我不知道是什么，所以我需要你的帮助

它返回 java.lang.NullPointerException

```
 import android.annotation.TargetApi;
    import android.app.Activity;
    import android.database.Cursor;
    import android.database.sqlite.SQLiteDatabase;
    import android.os.Bundle;
    import android.widget.TextView;
    import android.util.Log;

    @TargetApi(16)
    public class logged extends Activity{
        public TextView msg;
        private SQLiteDatabase myDB = null;
        public void onCreate(Bundle savedInstanceState){
             super.onCreate(savedInstanceState);
             setContentView(R.layout.logged);
             msg = (TextView) findViewById(R.id.msg);
             myDB.openDatabase("data/data/com.example.login2/databases/aeglea", null, SQLiteDatabase.OPEN_READONLY);

             try{
//here is the problem. Both kind of queries return the same error
                 //Cursor cur = myDB.query("user_login", new String[] {"username"}, null, null, null, null, null);
                 Cursor cur = myDB.rawQuery("SELECT username FROM user_login", null);
                 msg.setText("Hello");
             }catch (Exception e1){
                 Log.e("DATABAZA","hola "+e1);
                 msg.setText("No Hello you creep");
             }

        }

    } 
```

我的数据库 OnCreate 是

```
public void onCreate(SQLiteDatabase db) {
        String CREATE_LOGIN_TABLE = "CREATE TABLE " + TABLE_NAME + "("
                + KEY_UID + " INTEGER PRIMARY KEY,"
                + KEY_NAME + " TEXT,"
                + KEY_LAST + " TEXT,"
                + KEY_EMAIL + " TEXT UNIQUE,"
                + KEY_USERNAME + " TEXT UNIQUE" + ")";

        db.execSQL(CREATE_LOGIN_TABLE);

    } 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T18:52:11.577

**改写**

```
private SQLiteDatabase myDB = null; 
```

`mDB`为空，您需要在引用它之前对其进行初始化。

尝试使用您的扩展 SQLiteOpenHelper 类：

```
Database openHelper = new Database(this);
myDB = openHelper.getWritableDatabase(); // or getReadableDatabase(); 
```

并删除：

```
myDB.openDatabase("data/data/com.example.login2/databases/aeglea", null, SQLiteDatabase.OPEN_READONLY); 
```

现在`mDB.query()`应该工作了！

# asp.net - 使用预先准备好的 HTML 模板作为电子邮件正文的 ASP.net 电子邮件附件

> ID：12098007
> 
> 赞同：2
> 
> 时间：2012-08-23T18:36:41.290
> 
> 标签：asp.net, email

我需要发送电子邮件附件作为电子邮件的正文。这就像向某人发送 E 卡一样。我在某处读到我们可以通过使用 HTML 模板并传递诸如 {name} 等值来做到这一点。有人能指点我这方面的教程或告诉我该怎么做吗？

我正在提交一个用户控件，并希望将用户控件中捕获的值传递给电子邮件附件。

提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:47:22.620

看看这个[`MailDefinition`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.maildefinition.aspx)类，它内置了对模板字段的支持。

```
Dear <%FirstName%>,

blah blah blah <%SomeOtherField%>

etc. 
```

# objective-c - Objective-C 的 NSMutableArray 是线程安全的吗？

> ID：12098011
> 
> 赞同：52
> 
> 时间：2012-08-23T18:36:52.977
> 
> 标签：objective-c, ios, multithreading, nsmutablearray

我已经尝试修复这个崩溃了将近一个星期。应用程序崩溃，没有任何异常或堆栈跟踪。在僵尸模式下通过仪器运行时，应用程序不会以任何方式崩溃。

我有一个在不同线程上调用的方法。修复崩溃的解决方案是更换

```
[self.mutableArray removeAllObjects]; 
```

和

```
dispatch_async(dispatch_get_main_queue(), ^{
    [self.searchResult removeAllObjects];
}); 
```

我认为这可能是一个时间问题，所以我尝试同步它，但它仍然崩溃：

```
@synchronized(self)
{
    [self.searchResult removeAllObjects];
} 
```

这是代码

```
- (void)populateItems
{
   // Cancel if already exists  
   [self.searchThread cancel];

   self.searchThread = [[NSThread alloc] initWithTarget:self
                                               selector:@selector(populateItemsinBackground)
                                                 object:nil];

    [self.searchThread start];
}

- (void)populateItemsinBackground
{
    @autoreleasepool
    {
        if ([[NSThread currentThread] isCancelled])
            [NSThread exit];

        [self.mutableArray removeAllObjects];

        // Populate data here into mutable array

        for (loop here)
        {
            if ([[NSThread currentThread] isCancelled])
                [NSThread exit];

            // Add items to mutableArray
        }
    }
} 
```

NSMutableArray 的这个问题不是线程安全的吗？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-08-23T18:43:51.183

不。

它不是线程安全的，如果您需要从另一个线程修改可变数组，您应该使用它`NSLock`来确保一切按计划进行：

```
NSLock *arrayLock = [[NSLock alloc] init];

[...] 

[arrayLock lock]; // NSMutableArray isn't thread-safe
[myMutableArray addObject:@"something"];
[myMutableArray removeObjectAtIndex:5];
[arrayLock unlock]; 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-07-31T22:16:30.340

正如其他人已经说过的， NSMutableArray 不是线程安全的。如果有人想在线程安全的环境中实现比 removeAllObject 更多的目标，我将提供另一种使用 GCD 的解决方案，而不是使用锁的解决方案。您要做的是同步读取/更新（替换/删除）操作。

首先获取全局并发队列：

```
dispatch_queue_t concurrent_queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0); 
```

供阅读：

```
- (id)objectAtIndex:(NSUInteger)index {
    __block id obj;
    dispatch_sync(self.concurrent_queue, ^{
        obj = [self.searchResult objectAtIndex:index];
    });
    return obj;
} 
```

对于插入：

```
- (void)insertObject:(id)obj atIndex:(NSUInteger)index {
    dispatch_barrier_async(self.concurrent_queue, ^{
        [self.searchResult insertObject:obj atIndex:index];
    });
} 
```

来自 Apple Doc 关于 dispatch_barrier_async：

> 当屏障块到达私有并发队列的前面时，它不会立即执行。相反，队列一直等到其当前正在执行的块完成执行。此时，屏障块自行执行。在屏障块完成之前，在屏障块之后提交的任何块都不会执行。

类似的删除：

```
- (void)removeObjectAtIndex:(NSUInteger)index {
    dispatch_barrier_async(self.concurrent_queue, ^{
        [self.searchResult removeObjectAtIndex:index];
    });
} 
```

**编辑**：实际上我今天找到了另一种更简单的方法来通过使用 GCD 提供的串行队列来同步对资源的访问。

从 Apple Doc [Concurrency Programming Guide > Dispatch Queues](http://developer.apple.com/library/ios/#DOCUMENTATION/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW1)：

> 当您希望任务以特定顺序执行时，串行队列很有用。串行队列一次只执行一个任务，并且总是从队列的头部拉取任务。您可以使用串行队列而不是锁来保护共享资源或可变数据结构。与锁不同，串行队列确保任务以可预测的顺序执行。只要您将任务异步提交到串行队列，队列就永远不会死锁。

创建您的串行队列：

```
dispatch_queue_t myQueue = dispatch_queue_create("com.example.MyQueue", NULL); 
```

将任务异步发送到串行队列：

```
dispatch_async(myQueue, ^{
    obj = [self.searchResult objectAtIndex:index];
});

dispatch_async(myQueue, ^{
    [self.searchResult removeObjectAtIndex:index];
}); 
```

希望能帮助到你！

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-09-07T12:05:10.350

除了`NSLock`可以使用`@synchronized`（*条件对象*）之外，如果您只想修改同一个数组实例的内容，您只需确保数组的每次访问都包含在一个`@synchronized`与充当*条件对象的对象*相同的对象中那么你可以使用数组本身作为*条件对象*，否则你将不得不使用其他你知道不会消失的东西，父对象，即 self，是一个不错的选择，因为它对于相同的数组。

atomic in `@property`attributes 只会使设置数组线程安全而不修改内容，即`self.mutableArray`= ... 是线程安全的，但`[self.mutableArray removeObject:]`不是。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-05-02T19:38:44.113

```
__weak typeof(self)weakSelf = self;

 @synchronized (weakSelf.mutableArray) {
     [weakSelf.mutableArray removeAllObjects];
 } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-02-18T23:54:21.950

由于提到了串行队列：对于可变数组，仅询问“它是否线程安全”是不够的。例如，确保 removeAllObjects 不会崩溃是好的，但是如果另一个线程试图同时处理数组，它会在删除所有元素*之前*或*之后*处理数组，你真的必须想想行为应该是什么。

创建一个负责该数组的类 + 对象，为其创建一个串行队列，并通过该串行队列上的类执行所有操作，这是最简单的方法，无需因同步问题而伤脑筋。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-17T15:23:45.927

所有 NSMutablexxx 类都不是线程安全的。包括get、insert、remove、add和replace在内的操作都应该和NSLock一起使用。这是苹果给出的线程安全和线程不安全类的列表：[线程安全总结](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/Multithreading/ThreadSafetySummary/ThreadSafetySummary.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-23T18:44:26.637

几乎 NSMutable 类对象不是线程安全的。

# java - 通过浏览器下载/上传文件到特定目标文件夹

> ID：12098013
> 
> 赞同：0
> 
> 时间：2012-08-23T18:36:55.110
> 
> 标签：java, web-applications, file-upload, activex, download

我正在开发一个需要从/向服务器下载/上传文件的 Web 应用程序。但是，此应用程序的用户群并不精通技术，因此我们希望他们单击​​指示“下载文件”（针对此记录）或“上传文件”（针对此记录）的按钮，而无需依赖用户“另存为”或指定目标文件夹。在以前的版本中，我们使用了 Software Artisan 的 SAXFile（一个 ActiveX 控件），但是这次我们试图避免使用 ActiveX。我们希望使应用程序浏览器不可知。

关于如何做到这一点的任何建议？我假设我们必须做一个 java 小程序，但如果有一个现有的开源项目或控件，我宁愿不自己动手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:13:32.887

这是一个安全问题，这就是为什么没有很多好的选择。写入任意目录的能力绝对不应该授予任何网页。

您可以选择 Java Applet、Flash、HTML5 或 ActiveX，但所有这些都需要用户授予权限或选择位置。您也可以使用 HTML5 Web 存储来完成此操作，它不需要用户权限，但在存储格式、浏览器支持和大小限制（大多数浏览器为 5 或 10 MB）方面都受到更多限制

# vim - 如何在 vim 中为缩进块分配特殊的语法荧光笔？

> ID：12098015
> 
> 赞同：1
> 
> 时间：2012-08-23T18:36:58.580
> 
> 标签：vim, syntax-highlighting, vim-syntax-highlighting

为了方便对 couchdb 函数进行分组，我创建了一种文件格式，使用 yaml 将单独的事物组合在一起

它基本上包含以下形式的条目，`name.ext: |` 后跟适合 .ext 的语言的预期代码块

为了更愉快的编辑，我想让 vim 为他们使用正确的语法荧光笔

*编辑*

根据要求提供一些代码示例

简单的：

```
map.coffee: |
  (doc) ->
    for item in doc.items:
     emit [doc.category, item], null
    return

reduce: _count 
```

更复杂：

```
map.coffee: |
  (doc) ->
    emit doc.category, {items: 1, val: doc.value}
    return

reduce.coffee: |
  (keys, values, rereduce) ->
    ret = {items: 0, val: 0}
    for v in values
      ret.items += doc.items
      ret.val += doc.val
    return ret 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:45:01.843

我相信您希望它利用 Vim 的语法区域 ( `:help syn-region`)。但是区域将分隔符作为参数。

您有一个明确定义的开始，但没有明确的结束，也许您可​​以通过在此处建立一些约定来解决问题，例如*"2 empty new lines at the end"*。

有类似的答案可能会为您提供有关如何实现解决方案的提示（包括文档），例如：[Embedded syntax highligting in Vim](https://stackoverflow.com/questions/519753/vimembedded-syntax-highligting)

同样有趣和类似的方法是这个 Vimtip：http: [//vim.wikia.com/wiki/Different_syntax_highlighting_within_regions_of_a_file](http://vim.wikia.com/wiki/Different_syntax_highlighting_within_regions_of_a_file)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T07:08:04.017

您必须编写自己的语法文件，并为每个条目定义一个语法区域。在该区域内，您可以在语法中包含您的`ext`. 阅读所有详细信息`:help :syn-include`。

如果这听起来太复杂，请查看我的 SyntaxRange 插件。它基于 alfredodeza 提到的 Vimtip。有了它，您可以快速将语法分配给一系列行，例如`:11,42SyntaxInclude perl`

# ssms - 为什么 SSMS 不遵守我的默认数据库设置？

> ID：12098021
> 
> 赞同：1
> 
> 时间：2012-08-23T18:37:20.793
> 
> 标签：ssms

出于某种原因，SSMS 不尊重我的默认数据库设置。我已经设置了我的默认数据库使用

```
Exec sp_defaultdb @loginame='[username]', @defdb='[database_name]' 
```

或使用 Security > Logins > [my login] > Properties > Default Database

这似乎是在我将默认数据库脱机然后无法登录时开始的。我不得不使用 sp_defaultdb 更改为另一个数据库，直到我可以将其重新联机。现在它只是转到master，即使当我打开我的登录属性时它被设置为我的默认数据库。有任何想法吗？

我正在使用 SSMS 2008 和 SQL Server 2008。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T19:31:17.390

新手错误：几周前，我在登录对话框（连接属性选项卡）上将“连接到数据库：”设置为主数据库。

# rest - 为什么在 REST 中没有存根？

> ID：12098022
> 
> 赞同：0
> 
> 时间：2012-08-23T18:37:29.513
> 
> 标签：rest, soap, rpc

**编辑**：我原来的标题是“在 RPC 中使用存根”；我编辑标题只是为了让其他人知道它不仅仅是那个问题。

我已经开始开发一些基于 SOAP 的服务，但我无法理解存根的作用。引用维基：

> 客户端和服务器使用不同的地址空间，因此必须执行函数调用中使用的参数的转换，否则这些参数的值无法使用，因为指向计算机内存的指针指向每台机器上的不同数据。即使对于简单的参数，客户端和服务器也可以使用不同的数据表示（例如，整数的大端与小端）。存根用于执行参数的转换，因此远程函数调用看起来像本地函数调用对于远程计算机。

这很愚蠢，但我“实际上”不明白这一点。我已经用 Java 进行了一些套接字编程，但是当我的 TCP/UDP 客户端与我的服务器交互时，我不记得任何“参数转换”步骤。（我假设使用 TCP/UDP 套接字的原始服务器-客户端通信确实属于 RPC）

我在 RESTful 服务开发方面有一些经验，但我也无法识别带有 REST 的 Stub 类似物。有人可以帮帮我吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:53:27.247

通过网络调用的存根（无论是 SOAP、REST、CORBA、DCOM、JSON-RPC 还是其他）只是帮助类，它们为您提供了一个处理所有底层细节的包装函数，例如：

*   初始化你的 TCP/UDP/任何传输层
*   找到正确的呼叫地址并在需要时进行 DNS 查找
*   连接到服务器应位于的网络端点
*   如果服务器未在侦听，则处理错误
*   检查服务器是否符合我们的预期（安全检查、版本控制等）
*   协商编码格式
*   以适合在网络上传输的格式（CDR、NDR、JSON、XML 等）对您的请求参数进行编码（或“编组”）
*   通过网络传输您的编码请求参数，根据需要处理分块或流量控制
*   接收来自服务器的响应
*   解码（或“解组”）响应详细信息
*   将响应返回到您的原始调用代码（或者如果出现问题则抛出错误）

没有“原始” TCP 通信之类的东西。如果您在请求/响应模型中使用它并从通过 TCP 连接发送的数据中推断出任何类型的含义，那么您已经在其中编码了某种形式的“参数”。您只是碰巧自己构建了存根通常会提供的东西。

存根试图让你的远程调用看起来像本地进程调用，但老实说，这是一件非常糟糕的事情。它们根本不一样，您的应用程序应该以不同的方式考虑它们。

# php - Codeigniter：仅在特定视图中运行代码

> ID：12098026
> 
> 赞同：0
> 
> 时间：2012-08-23T18:37:36.477
> 
> 标签：php, codeigniter

我需要向我添加一个第 3 方脚本（优化），所以我想把它放到我的主模板中。

但是，我只希望它在一页上运行，我的 /order 页面。如何将此脚本添加到头部以便它检查，如果 View = Order 则包含此 js 文件，否则不包含它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:44:28.827

在加载视图时，向它发送一个具有控制器名称的附加变量。

在视图中，您可以检查变量的值是否为顺序，然后您可以回显脚本。

代码大致如下所示：

```
// in your controller
$data = array();
// some code that will fill $data
$data['controller'] = get_class($this);
$this->load->view('your_view', $data);

// now, in your view,
if($controller == 'Order')
    echo "<script src='......'></script>"; 
```

# android - 如何创建一个显示可用 Wi-Fi 网络并在需要时连接到它们的应用程序？

> ID：12098027
> 
> 赞同：-1
> 
> 时间：2012-08-23T18:37:37.017
> 
> 标签：android, wifi, connect, android-wifi

如何创建一个显示可用 Wi-Fi 网络并在需要时连接到它们的应用程序？我是初学者，视频教程会容易得多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T23:10:24.720

我想你想使用[WifiManager](http://developer.android.com/reference/android/net/wifi/WifiManager.html "Wifi管理器")

这是 WifiManager 的示例：http: [//marakana.com/forums/android/examples/40.html](http://marakana.com/forums/android/examples/40.html)

如果需要，您还可以更改布局。

# knockout.js - 淘汰赛验证 - 如何显示错误消息

> ID：12098029
> 
> 赞同：18
> 
> 时间：2012-08-23T18:37:58.667
> 
> 标签：knockout.js, knockout-validation

我们正在使用 Knockout.js 和 Knockout-validation 插件。当用户返回存在验证错误的页面时，我们希望显示错误消息。有谁知道是否可以在不实际更改绑定答案的情况下触发淘汰赛验证？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-08-24T13:36:19.220

解决方案是调用 showAllMessages。如果视图模型有嵌套的 observables，请务必将 ko.validation.configure 设置为使用深度分组，因为默认值为 false。

例子：

```
viewModel.save = function()
{
    var result = ko.validation.group(viewModel, {deep: true});
    if (!viewModel.isValid()) 
    {
        alert("Please fix all errors before preceding");
        result.showAllMessages(true);

        return false;
    }

    //actually save stuff, call ajax, submit form, etc
} 
```

或者，您可以替换`!viewModel.isValid()`为`result().length > 0`

# php - 在 mysql 查询中使用 PHP 表单

> ID：12098031
> 
> 赞同：1
> 
> 时间：2012-08-23T18:38:02.183
> 
> 标签：php, html, forms

这里的另一个（基本）问题。我需要知道如何使用 html 表单来过滤使用 PHP 的 mysql 查询的结果。我一直在看 w3schools，我可以看到如何在一个页面上使用 $_POST 可以输出到另一个页面。但我无法确切了解如何将 $_POST 放入我的查询中。例如我有一页如下：

```
<form action="orderlist.php" method="post">
OrderNo: <input type="int" name="order_no" />
<input type="Submit" />
</form> 
```

这是一个用户可以输入 order_no 并单击提交的页面，该页面链接到“orderslist.php”页面。在该页面上，我有以下代码：

```
$result = mysql_query("SELECT * FROM orders");

echo "<table border='5'>
<tr>
<th>order_no</th>
<th>ord_date</th>
<th>est_completion_date</th>
<th>status</th>
<th>invoice_date</th>
<th>inv_amount</th>
<th>name</th>
<th>fName</th>
<th>lName</th>
</tr>";

// -- Use 'while' to check each row in $result in turn:
while($row = mysql_fetch_array($result))
  {
  echo "<tr>";
  echo "<td>" . $row['order_no'] . "</td>";
  echo "<td>" . $row['ord_date'] . "</td>";
  echo "<td>" . $row['est_completion_date'] . "</td>";
  echo "<td>" . $row['status'] . "</td>";
  echo "<td>" . $row['invoice_date'] . "</td>";
  echo "<td>" . $row['inv_amount'] . "</td>";
  echo "<td>" . $row['name'] . "</td>";
  echo "<td>" . $row['fName'] . "</td>";
  echo "<td>" . $row['lName'] . "</td>";
  echo "</tr>";
  }
echo "</table>"; 
```

这会将“订单”中的所有内容输出到表中，但我希望它只输出用户在上一页输入的 order_no 行。我该怎么做呢？是不是像：

```
$result = mysql_query("SELECT * FROM orders WHERE order_no = $_POST[order_no]"); 
```

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T18:50:35.083

对于初学者，您应该切换到 PDO 或 mysqli——这些`mysql_*`功能正在被弃用。

关于你的问题：是的，你就是这样做的，有一个`WHERE`子句。`$_POST`但是，在没有卫生条件的情况下直接连接变量是非常（非常非常非常）不安全的。

也就是说，您至少应该这样做：

```
mysql_query('SELECT * FROM orders WHERE order_no = '.mysql_real_escape_string($_POST[order_no])); 
```

另一件事......不要使用`SELECT *`. 您应该始终列出您希望从数据库中获取的列——这样，如果出现问题（例如列已更改），查询可以让您知道。随着`SELECT *`您取回一个神奇的数据包——您不知道它是什么，更重要的是，它是否具有您的代码所依赖的值。

所以，把它放在一起：

```
$pdo = new PDO("mysql:host=localhost;dbname=database", '-username-', '-password-');
$sth = $pdo->prepare('
    SELECT 
        `order_no`,
        `ord_date`,
        `est_completion_date`,
        `status`,
        `invoice_date`,
        `inv_amount`,
        `name`,
        `fName`,
        `lName`
    FROM 
        orders 
    WHERE 
        order_no = :order_no
');
$sth->execute(array(':order_no'=>$_POST[order_no]));
while ($order= $sth->fetch()) {
  echo "<tr>";
  echo "<td>" . $order->order_no . "</td>";
  echo "<td>" . $order->ord_date . "</td>";
  echo "<td>" . $order->est_completion_date . "</td>";
  echo "<td>" . $order->status . "</td>";
  echo "<td>" . $order->invoice_date . "</td>";
  echo "<td>" . $order->inv_amount . "</td>";
  echo "<td>" . $order->name . "</td>";
  echo "<td>" . $order->fName . "</td>";
  echo "<td>" . $order->lName . "</td>";
  echo "</tr>";
} 
```

**编辑**：最后一点，您使用的输入无效；`type="int"`不是可识别的输入类型。[这是 HTML 4 的类型](http://www.w3.org/TR/html401/interact/forms.html#input-control-types)列表和[HTML 5 的列表](http://www.w3.org/TR/html-markup/input.html#input)：

如您所见，HTML 5 确实有一个新的输入类型“数字”。它没有被完全采用，但如果你想使用它：

`<input type="number" name="order_no" />`

但是请注意，并非所有浏览器都会将输入限制为数字：[http ://caniuse.com/#feat=input-number](http://caniuse.com/#feat=input-number)

**文档**

*   mySql `SELECT`- [http://dev.mysql.com/doc/refman/5.0/en/select.html](http://dev.mysql.com/doc/refman/5.0/en/select.html)
*   `mysql_query`（**已弃用**）- [http://php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)
*   PDO - [http://www.php.net/manual/en/book.pdo.php](http://www.php.net/manual/en/book.pdo.php)
*   `PDO::prepare`- [http://www.php.net/manual/en/pdo.prepare.php](http://www.php.net/manual/en/pdo.prepare.php)
*   `PDOStatement::fetch`- [http://www.php.net/manual/en/pdostatement.fetch.php](http://www.php.net/manual/en/pdostatement.fetch.php)
*   `PDOStatement::execute`- [http://www.php.net/manual/en/pdostatement.execute.php](http://www.php.net/manual/en/pdostatement.execute.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T18:49:31.463

尝试这个：

```
$orderNumber = mysql_real_escape_string($_POST['order_no']);
$result = mysql_query("SELECT * FROM orders WHERE order_no = $orderNumber"); 
```

这需要它的价值`$_POST['order_no']`并在一定程度上对其进行消毒。然后将 的值`$orderNumber`应用于 MySQL。

但是，最好使用[PDO](http://php.net/manual/en/book.pdo.php)或[MySQLi](http://php.net/manual/en/book.mysqli.php)。两者都可以保护您（如果使用正确）免受 SQL 注入。目前，您的代码很容易受到 SQL 注入的影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T18:56:44.760

Without injection vulnerability (require 'mysql_connect' before) :

```
if(isset($_POST['order_no']))
{
    $orderNo = mysql_real_escape_string($_POST['order_no']);

    $result = mysql_query("SELECT * FROM orders WHERE order_no = $orderNo");

    echo "<table border='5'>";
    echo "  <tr>";
    echo "    <th>order_no</th>";
    echo "    <th>ord_date</th>";
    echo "    <th>est_completion_date</th>";
    echo "    <th>status</th>";
    echo "    <th>invoice_date</th>";
    echo "    <th>inv_amount</th>";
    echo "    <th>name</th>";
    echo "    <th>fName</th>";
    echo "    <th>lName</th>";
    echo "  </tr>";

    if(mysql_num_rows($result) == 0)
    {
        echo '<tr><td colspan="9">Order not found</td></tr>';
    }
    else
    {
        while($row = mysql_fetch_assoc($result))
        {
            echo "<tr>";
            echo "  <td>" . $row['order_no'] . "</td>";
            echo "  <td>" . $row['ord_date'] . "</td>";
            echo "  <td>" . $row['est_completion_date'] . "</td>";
            echo "  <td>" . $row['status'] . "</td>";
            echo "  <td>" . $row['invoice_date'] . "</td>";
            echo "  <td>" . $row['inv_amount'] . "</td>";
            echo "  <td>" . $row['name'] . "</td>";
            echo "  <td>" . $row['fName'] . "</td>";
            echo "  <td>" . $row['lName'] . "</td>";
            echo "</tr>";
        }
    }

    echo "</table>";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:05:26.040

你的表格应该是这样的：

```
<form action="orderlist.php" method="post">
    OrderNo: <input type="text" name="order_no" />
    <input type="Submit" value="Submit"/>
</form> 
```

要获取用户在表单中**键入的**任何值，您应该使用`type="text"`. `type="int"`在标准 HTML中没有任何东西。

不要混淆，HTML 中的输入类型与您在编程语言中用于声明数据类型的输入类型不同。这里的 TYPE 只是让浏览器知道它是一个文本字段/单选按钮等。要了解*有效输入类型*，最好阅读[w3.org](http://www.w3.org/TR/html401/interact/forms.html#adef-type-INPUT)关于 HTML 表单的建议。

您`orderlist.php`可以查询以检索所需的数据：

```
if(isset($_POST['order_no'])) {
    $orderNo = mysql_real_escape_string($_POST['order_no']);
    $result = mysql_query("SELECT * FROM orders WHERE order_no = $orderNo");
    while($row = mysql_fetch_array($result)) {
        //code to print table.   
    }
} 
```

### 笔记：

这类代码容易受到攻击，不建议将用户输入直接放入 SQL 查询中，应始终先过滤。

# android - 实时过滤ListView

> ID：12098033
> 
> 赞同：3
> 
> 时间：2012-08-23T18:38:10.933
> 
> 标签：android, android-listview, android-asynctask

我想`ListView`实时过滤一个。我有一个`EditText`，`ActionBar`每次用户写一个字符我想更新`ListView`过滤信息的光标。

我已经完成了`AsyncTask`查询，但我有两个问题：

1º）如果用户键入三个字符，我将创建三个`AsyncTasks`（一个用于搜索第一个字符，一个用于搜索前两个字符，最后一个用于搜索三个字符）。有没有一种简单的方法可以`AsyncTask`用新的任务替换以前的任务？

2º) 我怎样才能稍微延迟启动`AsyncTask`？因此，如果用户不停地键入三个字符，我将不会创建`AsyncTask`直到结束。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T19:57:34.527

嗯...不完全确定为什么您使用`AsyncTask`实时搜索。这就是我将如何（并且已经成功地）做到这一点。

添加一个`TextChangeListener`到你的`Edittext`：

```
editText.addTextChangedListener(new TextWatcher() {

        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            searchResults = myDbHelper.searchAll(s.toString());
            searchAdapter.notifyDataSetChanged();
        }

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count,
                int after) {

        }

        @Override
        public void afterTextChanged(Editable s) {
            // TODO Auto-generated method stub

        }
    }); 
```

每次用户按键时，我都在搜索 sqlite 数据库。My`searchResults`用于填充`ListView`，因此在我设置 get 搜索结果后，告诉列表适配器数据集已更改。

希望这可以帮助。

# xml - 将 XML 的结果树片段视为字符串并使用 . 作为分隔符

> ID：12098037
> 
> 赞同：2
> 
> 时间：2012-08-23T18:38:16.997
> 
> 标签：xml, xslt

如何转换存储在变量中的以下值。

```
<xsl:variable name="myvar">
There was a <b> super man </b> in the city. He was very brave.
</xsl:variable> 
```

至

```
<p>There was a <b> super man </b> in the city.</p>
<p>He was very brave.</p> 
```

使用 XSLT 1.0 模板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T13:26:10.390

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common" exclude-result-prefixes="ext xsl">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:variable name="vMarkup" select="/*/node()"/>

 <xsl:template match="/" name="split">
  <xsl:param name="pNodes" select="$vMarkup"/>

  <xsl:if test="$pNodes">
      <xsl:variable name="vTextWithDot" select="$pNodes[self::text()][contains(., '.')]"/>

      <xsl:choose>
        <xsl:when test="not($vTextWithDot)">
          <p><xsl:copy-of select="$pNodes"/></p>
        </xsl:when>
        <xsl:otherwise>
         <p>
          <xsl:copy-of select="$vTextWithDot/preceding-sibling::node()"/>
          <xsl:copy-of select=
          "concat(substring-before($vTextWithDot, '.'), '.')"/>
         </p>

         <xsl:if test="substring-after($vTextWithDot, '.')
                      or $vTextWithDot/following-sibling::node()">
             <xsl:variable name="vrtfNewNodes">
               <xsl:copy-of select="substring-after($vTextWithDot, '.')"/>
               <xsl:copy-of select="$vTextWithDot/following-sibling::node()"/>
             </xsl:variable>

             <xsl:call-template name="split">
               <xsl:with-param name="pNodes" select=
                  "ext:node-set($vrtfNewNodes)/node()"/>
             </xsl:call-template>
         </xsl:if>
        </xsl:otherwise>
      </xsl:choose>
  </xsl:if>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于此 XML 文档时**：

```
<t>There was a <b> super man </b> in the city. He was very brave.</t> 
```

**产生想要的正确结果**：

```
<p>There was a <b> super man </b> in the city.</p>
<p> He was very brave.</p> 
```

# perl - 从 postgresql 函数中检索异常消息

> ID：12098040
> 
> 赞同：2
> 
> 时间：2012-08-23T18:38:43.150
> 
> 标签：perl, postgresql, exception-handling, dbi, catalyst

我在插入运行的表上有一个触发器函数，在某些情况下会引发异常。

我维护一个在 Catalyst 上运行的旧 Perl 应用程序，它创建一个事务并在表上插入行。

当触发器函数引发异常时，我希望能够只打印出我抛出的错误消息，而不是任何调试信息（数据库操作、上下文、perl 文件等）。

例如，如果我的函数抛出类似：

```
raise exception 'Item with id % cannot be shipped at this time.', new.id; 
```

我只想看看

> id 为 13 的商品目前无法发货。

并不是

> DBIx::Class::Row::insert(): DBI 异常：DBD::Pg::st 执行失败：错误：ID 为 13 的项目此时无法发货。[对于 /home/../lib/Class/Controller/Inv.pm 第 260 行的语句“INSERT INTO ...

perl 代码目前类似于

```
$c->model('Class')->schema->txn_do(sub {
    ...
    eval {
        $shipment->insert;
        1;
    } or do {
        $error = $@;
        last;
    };

    if ($error) {
        $c->stash->{error} = $error;
    }
); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T18:49:57.097

也许这个替换：

```
my $error = $@;
$error =~ s/^.*ERROR: (.*) \[for Statement.*$/$1/; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T05:50:12.963

您可以访问数据库句柄的 errstr() 方法，这就是传递给 warn/die 的内容

```
 warn $c->model('Class')->schema->storage->dbh->errstr(); 
```

# codeigniter - 如何将 codeigniter 与 mySqlworkbench 连接

> ID：12098043
> 
> 赞同：0
> 
> 时间：2012-08-23T18:38:57.497
> 
> 标签：codeigniter, mysql-workbench

我是 php 编程的新手，目前正在开发一个库存控制系统作为我的任务。我想使用 Codeigniter 和 My SqlWorkbench。我想知道如何连接这两个？如何在 Codeigniter 中调用 SqlWorkbench DB？请帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:08:23.827

你不了解基本情况。

MySQL Workbench 是[DBMS](http://en.wikipedia.org/wiki/Database_management_system)，而不是数据库。它是控制数据库的接口，在这种情况下是 MySQL 数据库。还有其他选择，例如 phpMyAdmin、chive、HeidiSQL（Windows 桌面应用程序）和许多其他的。

您不会以任何方式连接 CodeIgniter 和 Workbench，它们都连接到 MySQL 数据库，这是在服务器上运行的独立服务。

启动运行的最快方法是在您的 PC 上设置[XAMPP](http://www.apachefriends.org/en/xampp.html)、[WAMP](http://www.wampserver.com/en/)或它们的替代品，这样您将拥有入门所需的一切 - Apache、PHP 和 MySQL。之后，您启动 MySQL Workbench 并可以控制您已创建并将在 MySQL 中使用的任何数据库及其表的内容和结构。

我可以建议，如果你问这样的问题，你不了解 PHP 编程的基础知识，而且 CodeIgniter 离你还很远，所以我建议你开始使用 MySQL 用纯 PHP 编写基本应用程序，因为你会不懂如何在 CodeIgniter 中操作东西，只会浪费你的时间。在您对这些东西更加熟悉和熟悉之后，您可能会转向 CodeIgniter 或其他框架。

# android - 为什么 gcc 发射代码与 ARM 指令集的 2 字节边界对齐？

> ID：12098044
> 
> 赞同：11
> 
> 时间：2012-08-23T18:38:57.873
> 
> 标签：android, c, gcc, android-ndk, arm

我正在检查我正在使用 GCC（Android NDK 中包含的版本）为 ARM Android 平台编译的 C 程序的汇编语言输出。

我指定了长度为 4 字节而不是 THUMB 的 ARM 指令集，但令人惊讶的是，emmited 汇编语言代码将函数对齐到 2 字节边界！

以下是生成的代码示例，显示了错误的 .align 指令：

```
.Ltext0:
    .global __aeabi_dmul
    .global __aeabi_d2iz
    .section    .text.InitializeFIRFilter,"ax",%progbits
    .align  2
    .global InitializeFIRFilter
    .type   InitializeFIRFilter, %function
InitializeFIRFilter:
    .fnstart 
```

根据[this document](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0204j/Babecdje.html)，正确的对齐方式应该是4，这是有道理的。

我试图通过使用 -falign-functions=4 来强制对齐，但它被忽略了。

这是我在 Android.mk 文件中指定的构建标志

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
    LOCAL_ARM_MODE  := arm
    LOCAL_MODULE    := nativeJadeMobile
    LOCAL_SRC_FILES := nativeJadeMobile.c fftasm.s
    LOCAL_LDLIBS    := -llog
    LOCAL_CFLAGS += -marm -ffast-math -O2 -march=armv6 -falign-functions=4 -save-temps -S 
    include $(BUILD_SHARED_LIBRARY) 
```

谁能发现我做错了什么，或者知道如何强制执行正确的代码对齐？非常感谢您！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-23T18:49:23.337

根据[汇编器的文档](http://sourceware.org/binutils/docs/as/Align.html#Align)，`.align`伪操作为 ARM 架构指定了 2 的幂。所以对齐是2^2=4字节，是正确的。

# mongodb - MongoDB - 具有许多排列的搜索引擎

> ID：12098045
> 
> 赞同：1
> 
> 时间：2012-08-23T18:39:05.487
> 
> 标签：mongodb, search-engine, database-indexes

我们有一个 mongo 集合，可以在许多领域进行搜索和排序。举个例子（对不起，由于保密，我不能放真正的收藏），我们采取：

```
MathProblem
{
    Creator : String,
    Difficulty : integer (from 0 to 4),
    Categorie : integer (from 0 to 40),
    NbOfQuestion : integer (less than 20),
    Likes : integer,
    Dislikes : integer,
    Succeeded : integer,
    Failures : integer
} 
```

我们可以搜索 Creator、Difficulty、Categorie、NbOfQuestion。并按喜欢、不喜欢、成功和失败进行排序。

前任：

*   给我难度 3 的问题，类别 20 按点赞数排序。
*   给我 5 个问题的问题，按失败排序。
*   给我难度为 1、类别 10、2 的问题，由 Einstein 创建。
*   给我所有按成功排序的问题。

等等......你得到的图片所有的排列都是可能的，我们可以选择在一个字段上排序。

这里的问题是我们有数百万条记录。索引花费我们至少 30 gig。另外，因为我们有这么多的索引，它压低了这个集合的写入速度。虽然它正在破坏写作，但它正在锁定阅读。所以我们读了很多，写的可能少了一点，但仍然很多。

我搜索“搜索引擎解决方案”，但我只能在“全文搜索”上找到东西，这不是我的情况。

我们还尝试将难度、Categorie 和 NbOfQuestion 合并到一个数组中（通过将值乘以 10 因子以保持它们之间的一致性）以仅在该数组上建立索引并节省一些空间。

任何事后诸葛亮将不胜感激！

谢谢，

查尔斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:50:00.613

查尔斯，

您的问题没有简单的解决方案。目前最好的解决方案可能是使用 MongoDB 的分片功能向外扩展。[http://www.mongodb.org/display/DOCS/Sharding+Introduction](http://www.mongodb.org/display/DOCS/Sharding+Introduction)

这里的目的是将您的工作集拆分到多台机器上，以减少一次写入会“粉碎”的数据量。此外，我可以建议升级到至少 MongoDB v 2.0.7，因为 2.X 分支中有许多新功能（例如 yield-on-long-operation 和 yield-on-page-fault），旨在减少写锁对系统的影响。有关 MongoDB 并发的更多信息，请参见[http://www.mongodb.org/display/DOCS/How+does+concurrency+work](http://www.mongodb.org/display/DOCS/How+does+concurrency+work)

干杯，

大卫

# android - 如何在 ImageView 上制作横幅？

> ID：12098046
> 
> 赞同：2
> 
> 时间：2012-08-23T18:39:14.360
> 
> 标签：android

我对此有点坚持。我在 FrameLayout 中有一个 ImageView 和 TextView，我正在尝试在 ImageView 上制作一个带有文本的自定义横幅。我似乎无法弄清楚如何使 textview 对角线和向左或向右。这是我能找到的最接近的表达我想要做的事情（但使用我自己的自定义文本）：

![在此处输入图像描述](../Images/768a4f0873d4935c78e7d33aff52da62.png)

有没有一种简单/有效的方法来做到这一点？

这是我当前的xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <ImageView
            android:id="@+id/icon"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:scaleType="centerCrop"
            android:src="@drawable/ic_launcher" />

        <TextView
            android:id="@+id/textView1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="#000000"
            android:ellipsize="none"
            android:text="TextView"
            android:textColor="#ffffff" />

    </FrameLayout>

</LinearLayout> 
```

编辑：请记住，我不希望能够将文本动态更改为我想要的任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:32:38.203

我建议你看看 ApiDemos 示例项目。您会在那里找到一个示例，沿路径绘制文本。`com.example.android.apis.graphics.TextAlign.java`

# android - 如何为 Android 应用程序创建自定义快捷方式？

> ID：12098047
> 
> 赞同：0
> 
> 时间：2012-08-23T18:39:14.667
> 
> 标签：android, android-intent, launcher

某些应用程序允许您选择通过长按启动器屏幕（“添加到主屏幕”-“快捷方式”）向应用程序添加自定义快捷方式。它们允许使用特定参数或其他东西启动应用程序，例如您已添加书签的页面的快捷方式，它会直接在浏览器中打开它。

如何添加与我的应用类似的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:45:27.250

您正在寻找“Android App Widgets”。请研究 Android App Widgets。请参阅以下链接[http://developer.android.com/guide/topics/appwidgets/index.html](http://developer.android.com/guide/topics/appwidgets/index.html)、 [http://www.vogella.com/articles/AndroidWidgets/article.html](http://www.vogella.com/articles/AndroidWidgets/article.html)然后启动相应的应用程序必须创建意图过滤器。希望这可以引导您朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:45:49.117

如果我理解正确，那么您在谈论[Android 小部件](http://developer.android.com/guide/topics/appwidgets/index.html)

# php - RSS 时间没有被正确读取？

> ID：12098049
> 
> 赞同：0
> 
> 时间：2012-08-23T18:39:27.703
> 
> 标签：php, date, time, rss

这个问题的答案可能很简单——但我很难过。

[我构建了一个从这个 RSS 提要 ( http://uvmbored.com/event/?feed=events](http://uvmbored.com/event/?feed=events) )中提取的幻灯片，并为每个事件显示一个框，标题为星期几、月份和日期。其次是事件的时间和事件的标题。

然而，时间总是显示在他们在 RSS 提要中的时间设置为**之前**的 4 小时（因此晚上 10 点的事件显示为下午 6 点）。最初我认为问题出在我用来将信息转换为 HTML 的阅读器上——但在检查 Firefox 中的标记时，我注意到了同样的问题。当浏览器读取标记时，它会错误地显示时间。但是，当您“查看源代码”并查看原始标记时，时间是正确的（24 小时格式除外）。

例如：

在尚普兰湖沉船之旅的[RSS 标记中，设置为：Sat, 25 Aug 2012 11:00:00 +0000；](http://uvmbored.com/event/?feed=events)但是 Firefox（以及我在抽出时间之前的幻灯片）将时间显示为上午 7:00，而不是应该的上午*11:00*。

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:52:19.557

“Sat, 25 Aug 2012 11:00:00 +0000”中的“+0000”表示时间以 UTC 表示（基本上是冬季的伦敦时间）。如果您的 PC（和运行 PHP 的服务器）位于不同的时区，则可以解释显示的差异。

# ios - 您可以使用 Apple 托管的应用内包的最大大小是多少？

> ID：12098052
> 
> 赞同：8
> 
> 时间：2012-08-23T18:39:44.240
> 
> 标签：ios, in-app-purchase

现在可以以 .pkg 文件的形式通过 Apple 托管您的应用内购买，这真是个好消息，因为这意味着 Apple 现在可以处理有关用户及其已购买内容的验证过程。

但是我的应用程序有一个额外内容的应用程序内购买，以非消耗品的形式，问题是我在那里有很多信息......照片（正常和视网膜版本），很多短视频剪辑和更多...

我的包文件可以有多大？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-23T18:39:44.240

Apple 将允许您上传最大**2GB 的**包文件。这也是您的应用程序的相同大小限制。

要上传 Apple 托管的应用内购买，您必须使用应用程序加载器。

有关更多详细信息，您可以查看 Apple 的以下指南：[使用 Application Loader](https://itunesconnect.apple.com/docs/UsingApplicationLoader.pdf)

该文件的第 30 页：

> 为 Apple 托管的非消耗性应用内购买发送内容包时，请记住以下几点：
> 
> 1.  **内容包的大小不能超过 2GB**。
> 2.  内容包不得包含任何指向内容目录之外的可执行代码或符号链接。
> 3.  一旦您的应用内购买上线，您就可以交付一个新的包裹。要使您的新内容上线，您必须在 iTunes Connect 中提交以供审核和批准。
> 4.  要删除文件，如果您的 In-App Purchase 不可用，请取消选中“Host Content with Apple”并重新发送您的包。一旦您交付了您的包裹并且您的应用内购买已上线，您将无法删除文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-01T20:41:59.360

虽然当我尝试上传多个此类单个文件时，单个托管文件的大小限制为 2GB（正好 20 亿字节），但我在单个应用程序中遇到了 Apple 托管内容的第二个未记录的 5 GB 总大小限制。我提交了错误报告，但尚未重新测试此限制以查看它是否已增加。

# django - 将 django form-wizard 添加到 urls.py 后出错

> ID：12098054
> 
> 赞同：0
> 
> 时间：2012-08-23T18:39:46.700
> 
> 标签：django, django-urls, django-formwizard

我在我的应用程序的 urls.py 中有这段代码：

```
urlpatterns = patterns('john_shop.checkout.views',
    (r'^wizard/$', ContactWizard.as_view([CheckoutForm, PaymentForm]),'checkout_wizard'),
) 
```

如果 FormWizard 保持未注释状态，我会收到此错误：

```
dictionary update sequence element #0 has length 1; 2 is requiredRequest Method:    GET
Request URL:    http://john-shop.ru/category/new-balance-501/
Django Version: 1.4
Exception Type: ValueError
Exception Value:    dictionary update sequence element #0 has length 1; 2 is required
Exception Location: /usr/local/lib/python2.6/dist-packages/Django-1.4-py2.6.egg/django/core/urlresolvers.py in _populate, line 258
Python Executable:  /usr/bin/python
Python Version: 2.6.6 
```

什么会导致这个问题？我知道 Error 没有说明 urls.py，但如果我注释掉该字符串，站点仍然可以正常运行。

PS我需要命名它以从购物车中获取重定向并继续用户结帐。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:41:42.960

你说错了。这是一个正确的：

```
urlpatterns = patterns('',
    (r'^ wizard/$', ContactWizard.as_view([CheckoutForm, PaymentForm])),
) 
```

[https://docs.djangoproject.com/en/dev/ref/contrib/formtools/form-wizard/#hooking-the-wizard-into-a-urlconf](https://docs.djangoproject.com/en/dev/ref/contrib/formtools/form-wizard/#hooking-the-wizard-into-a-urlconf)

# design-patterns - 向导用户界面的设计模式

> ID：12098057
> 
> 赞同：4
> 
> 时间：2012-08-23T18:39:50.837
> 
> 标签：design-patterns, user-interface, wizard

所以要求是为多步向导/单步向导创建一个通用接口。由于每个向导可能没有所有按钮（单步向导只有取消和提交，多步第一个屏幕有取消、下一步等）。

我应该为每个按钮创建一个单独的界面吗

```
interface CancelButton 
{
   void onCancelClick();
}

interface NextButton 
{
   void onNextClick();
} 
```

等等？每个向导只实现他们需要的那些？

这个用例有更好的设计模式吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T02:59:53.913

似乎您只需要一个简单的类层次结构。每个基本向导页面案例都有一些基本抽象`WizardPage`类和子类，例如`WizardWelcomePage`, `WizardLastPage`, `WizardIntermediatePage`. 然后将向导定义为向导页面的集合，并且每个页面都知道它应该显示哪些按钮。不是特定的设计模式，简单的 OOP。

这个想法的另一个变体，使事情更灵活，是使基础在其构造函数`WizardPage`中接受一组`WizardButton`实例（并且`WizardCancelButton`, `WizardAcceptButton`,`WizardNextButton`将是子类）。这将允许您为向导页面和向导按钮拥有单独的层次结构（变体）。我认为这可以被认为是一种桥模式。每个按钮子类都将在其构造函数中请求另一个接口，以便当它们被单击时，它们可以将此信息发送给`WizardEngine`将执行适当操作的按钮：移动到下一页、取消或接受。您可能还需要另一个事件链`WizardPage`来指示内容何时变为有效或无效，以便可以通过`WizardEngine`.

# javascript - Ajax textarea保存错误

> ID：12098060
> 
> 赞同：0
> 
> 时间：2012-08-23T18:39:55.190
> 
> 标签：javascript, json, jquery

我尝试做 ajax 编辑 textarea。当我单击“编辑”按钮时，我得到带有要编辑的文本的 textarea，当保存 textarea 时消失并且编辑的文本
必须出现在

```
 jQuery('.photocont #commeditCont').animate({opacity: 0}, timer, function()
    {
        if (id == 'commedit') jQuery(this).html('<textarea>'+jQuery(this).html().replace(/<br>/gi,"\n")+'</textarea>');
        else if (id == 'commsave') {

            var link = window.location.protocol + '//' + window.location.host + 'picture_edit';

            jQuery.ajax({
                type: "POST",
                url: link,
                data: { image : image, description : jQuery(this).html(jQuery(this).find('textarea').val()) },
                dataType: "json",
                context: this,
                success: function(data) {
                    jQuery(this).html(jQuery(this).find('textarea').val().replace(/\n/g,"<br>"));
                },
                error:function (xhr){
                    if (xhr.status == 401) {
                        window.location.href = link;
                    }
                }
            });

        }
}); 
```

在 ajax 中，`success: function`我尝试从 textarea 获取文本并用新的 div 替换。不幸的是我收到错误

```
NS_ERROR_XPC_BAD_CONVERT_JS: Could not convert JavaScript argument

...a[2]||k.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?...

jquery....min.js (line 16)

TypeError: jQuery(this).find("textarea").val() is undefined 

jQuery(this).html(jQuery(this).find('textarea').val().replace(/\n/g,"<br>")); 
```

错误来自控制台。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:49:09.940

`this`超出了成功函数的范围，因此未定义。尝试缓存这个并改用那个，如下所示：

```
jQuery('.photocont #commeditCont').animate({opacity: 0}, timer, function() {
    if ( id == 'commedit' ) {
        jQuery(this).html('<textarea>' + jQuery(this).html().replace(/<br>/gi, "\n") + '</textarea>');
    }
    else if ( id == 'commsave' ) {

        var link = window.location.protocol + '//' + window.location.host + 'picture_edit',
            self = this;

        jQuery.ajax({
            type    : "POST",
            url     : link,
            data    : { image: image, description: jQuery(this).html(jQuery(this).find('textarea').val()) },
            dataType: "json",
            context : this,
            success : function( data ) {
                jQuery(self).html(jQuery(self).find('textarea').val().replace(/\n/g, "<br>"));
            },
            error   : function( xhr ) {
                if ( xhr.status == 401 ) {
                    window.location.href = link;
                }
            }
        });

    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:24:20.947

看看你在这里做什么

```
description: jQuery(this).html(jQuery(this).find('textarea').val()) 
```

那是您要发送到服务器的内容吗？我想你想要文本

真正的问题是您的 this 在回调中的范围错误

```
 success: function(data) {
                jQuery(this).html(jQuery(this).find('textarea').val().replace(/\n/g,"<br>"));
            }, 
```

如果您不`jQuery(this)`一遍又一遍地继续使用，就不会有问题。您需要维护范围。

```
jQuery('.photocont #commeditCont').animate({
    opacity: 0
}, timer, function () {
    var div = jQuery(this);
    if (id == 'commedit') div.html('<textarea>' + div.html().replace(/<br>/gi, "\n") + '</textarea>');
    else if (id == 'commsave') {

        var link = window.location.protocol + '//' + window.location.host + 'picture_edit';

        jQuery.ajax({
            type: "POST",
            url: link,
            data: {
                image: image,
                description: div.html(jQuery(this).find('textarea').val()) //I still think this is not right
            },
            dataType: "json",
            context: this,
            success: function (data) {
                div.html(div.find('textarea').val().replace(/\n/g, "<br>"));
            },
            error: function (xhr) {
                if (xhr.status == 401) {
                    window.location.href = link;
                }
            }
        });

    }
}); 
```

# visual-studio-2012 - 引用项目的程序集未使用 VS 2012 部署到测试文件夹

> ID：12098062
> 
> 赞同：3
> 
> 时间：2012-08-23T18:39:58.107
> 
> 标签：visual-studio-2012

我最近切换到 vs2012 并且无法运行测试，因为引用项目的程序集没有部署到 TestResults 中的测试文件夹。我正在使用相同的 Local.testsettings 文件，该文件在 VS2010 中运行良好。我在 testsettings 文件的部署选项卡中添加了其他依赖项，并且这些依赖项已正确部署。我的测试程序集也正在部署，所以它只是没有部署的项目依赖项。

我尝试使用 vs2012 创建一个新的 Local.testsettings 文件，认为这两个版本之间可能略有不同，但这并没有解决我的问题。

有人知道 VS2012 在部署依赖程序集的方式上可能发生了一些变化吗？

谢谢

*   本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-15T11:46:42.417

关于这个问题有几个相关的已回答问题： Problem [with DeploymentItem attribute](https://stackoverflow.com/questions/883270/problems-with-deploymentitem-attribute) [C# DeploymentItem failed to copy file for MSTest unit test](https://stackoverflow.com/questions/2134099/c-sharp-deploymentitem-fails-to-copy-file-for-mstest-unit-test)

但是，在 VS 2012 中，MS 对 MSTest 进行了更改（不幸的是，我找不到他们针对这些更改所做的几篇博客文章的 URL - 他们在他们所做的其他新内容之间有所提及）所以现在当你有一个程序集作为部署项 - 无论是来自测试类、测试方法还是 TestSettings 文件，它都可能仍然被遗漏！

原因似乎是 mstest 从引用的程序集中查找类实例化。如果没有，则不会复制程序集。我们在使用框架的测试中遇到了这个问题，而框架又使用了 NewtonSoft.JSON。我们必须创建一个虚拟测试类和方法来实例化 NewtonSoft.JSON 库中的任何类，以便复制其 DLL。

试一试，祈祷它有效。

# java - 如何在 log4j 中获得不同的记录器？

> ID：12098068
> 
> 赞同：8
> 
> 时间：2012-08-23T18:40:19.920
> 
> 标签：java, log4j

如果我的 log4j.properties 看起来像这样

```
# General configuration
log4j.rootLogger = ERROR, ConsoleAppender

# Appender configuration
log4j.appender.ConsoleAppender = org.apache.log4j.ConsoleAppender
log4j.appender.ConsoleAppender.layout = org.apache.log4j.PatternLayout 
log4j.appender.ConsoleAppender.layout.ConversionPattern = %5p (%c) %m%n
#Other Loggers
log4j.logger.com.foo=INFO
log4j.logger.com.foo.Bar=DEBUG
log4j.logger.org.springframework=INFO 
```

有没有一种简单的方法来获取记录`com.foo`器`com.foo.Bar`、、、`root`和`org.springframework`。而不是已创建并继承级别的特定类（IE `com.foo.bar.Baz`？
出于我的目的，我想创建一个管理页面来显示这些记录器及其级别，但不是所有记录器，只是那些通过属性直接配置的记录器。目前，我正在向上遍历父层次结构，直到遇到一个与其父级具有不同级别的记录器，但是如果它们在层次结构中并设置与更高级别相同的级别，则可以隐藏一些已配置的记录器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T16:33:32.237

你可以做这样的事情。首先从日志管理器中获取所有记录器：

```
Enumeration<Category> loggers = LogManager.getCurrentLoggers(); 
```

然后您可以询问每个记录器的级别：

```
Level currentLevel = logger.getLevel(); 
```

`currentLevel``null`如果它从未被明确设置过。因此，如果记录器设置为 中的特定级别`log4j.properties`，您将获得一个非空值。否则你会得到一个`null`价值。根记录器总是报告一个级别，所以这是一种特殊情况。这样，您就不需要解析`log4j.properties`文件。

唯一的问题是，如果您在代码中的某处调用`setLevel()`记录器，它也会报告非空值并出现在您的列表中。那是因为 log4j 不知道一个级别是*如何*设置的，只有当它被设置时才知道。要区分这两种情况，您仍然需要解析`log4j.properties`.

另外，请记住，这仅适用于当前加载的记录器。因此，如果`com.foo.Bar`从未加载过，即使在`log4j.properties`. Log4J 不知道将来可能创建的不存在的记录器。同样，为此您需要解析`log4j.properties`.

# .net - .net 多线程 webclient.DownloadString，还是使用 DownloadStringAsync？

> ID：12098069
> 
> 赞同：0
> 
> 时间：2012-08-23T18:40:29.883
> 
> 标签：.net, vb.net, webclient

我试图了解加速在多个网站的源中搜索字符串的小程序的最佳方法。目前的程序如下：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
Dim urls() As String = TextBox1.Lines()
Dim stringstofind() As String = TextBox2.Lines()
For Each url As String In urls
    CheckForStrings(url, stringstofind)
Next

End Sub
Private Sub CheckForStrings(ByVal url As String, ByVal stringstofind() As String)
Dim wc As New WebClient()
Dim source As String = wc.DownloadString(url)
'MessageBox.Show(source)
For Each stringtofind As String In stringstofind
    If (source.IndexOf(stringtofind) <> -1) Then
        TextBox3.AppendText("url: " + url + " string: " + stringtofind + vbCrLf)
        Exit For
    Else
        TextBox3.AppendText("url: " + url + " string: " + "NOT FOUND" + vbCrLf)
    End If
Next

End Sub 
```

似乎可用的选项是： 使用 parallel.for each 为每个循环线程化初始值。除了一些避免跨线程问题和阻塞 GUI 的编辑之外，这似乎很简单，但似乎不是最好的方法。

使用 webclient.DownloadStringAsync 方法。这是我看到的第一件事，但我不知道如何从 DownloadStringCompleted 事件传回结果字符串。另外，如果我能解决这个问题，你如何限制同时发出的请求数量，以避免网络连接过载？

我还查看了一些使用 .net4.5 的 c# 示例，它们看起来很棒，但是该程序需要在 server2003 上运行，所以我想那是不可能的

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T00:28:11.943

我将发表评论作为答案，因为这并没有获得太多流量。

TPL 根据 CPU 分配线程，它不会处理不会很好地增加 CPU 负载的慢速连接。

一个简单的开始是 WithDegreeOfParallelism 来节流。[在此处输入链接描述](https://stackoverflow.com/questions/8869812/a-faster-way-to-download-multiple-files)

您可能会发现 100 是一个很好的 WithDegreeOfParallelism。

下一级优化变得更加复杂。如果是异步，线程池，或者组合。这将在很大程度上取决于网站的延迟。而且我不确定您是否会购买很多异步线程，因为空闲线程的开销并不大。

# java - Java - 如何检查除法是整数还是浮点数？

> ID：12098072
> 
> 赞同：10
> 
> 时间：2012-08-23T18:40:35.720
> 
> 标签：java, math, int, division, operation

想不出更好的标题。那么问题是：我有“int i”，它可以是任何值。**我的目标是将“int i”转换为可被16**整除的最接近的数字。

例如，我得到**i = 33**。然后我将变成**32** (16x2)。但是如果我得到**i = 50**，那么它将变成**48** (16x3)。

我尝试了很多东西，例如：

```
for (int x = i; x < 999; x++){
if ( (i - x)/16 *is an integer*){
i = i - x;
} 
```

但我不知道如何检查它是否为整数。所以也许我以前的代码可以工作，但我只需要找到一种方法来检查它是整数还是浮点数。所以..任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-23T18:44:02.463

使用 mod 运算符。Mod 为您提供除法运算的剩余部分。

```
public boolean isEvenlyDivisable(int a, int b) {
    return a % b == 0;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T18:42:56.267

`(i - x)/16`当余数为 0 时为整数。`(i - x)/16`使用 %(modulus) 运算符，如：

```
if((i - x)%16 == 0) {
   // (i-x)/16 is integer
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-23T20:01:00.533

由于所有可被 16 整除的整数都将其最后 4 位设置为 0。您可以在没有循环甚至 if 语句的情况下完成您想要的操作：

```
i &= 0xfffffff0; // Sets i to the greatest multiple of 16 less than i, or 0 for i < 16 
```

例如：

```
int i = 50;
i &= 0xfffffff0; // i == 48

i = 39;
i &= 0xfffffff0; // i == 32

i = 16;
i &= 0xfffffff0; // i == 16 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-23T18:53:59.580

您的原始代码存在许多引人注目的问题：

1.  如果四舍五入到最接近的 16 倍数，则可能需要减去的最高值是 15。因此，循环的上边界最多应为 15。
2.  正如其他人所指出的，您可以使用模运算符 ( `%`) 来确定要从给定值中减去的确切值，以将其向下舍入到最接近的 16 倍数。这完全消除了对循环的需要。
3.  但是由于 16 是 2 的幂，并且由于整数表示为具有 32 位（即 32 位）的二进制数，因此您可以更直接地计算该值，方法是使用位掩码将数字中小于 16 的任何数字归零。在 Java 中，您可以像这样使用二进制 & 运算符`i & 0xfffffff0`：这会将最后 4 位数字清零（代表：8-4-2-1），这有效地将您的数字向下舍入到可被 16 整除的最接近的值。
4.  如果您需要对数字进行整数除法并忽略任何余数，您只需将 ( `>>`) 移动 4 位即可。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T18:53:25.430

要确定一个数字是否将另一个数字整除，请查看其他答案，Modulo (%) 是这样做的方法。

要执行上述操作，您不需要循环：

```
public int nearestDivider(final int input)
{
    final int multiple = input / 16; // this will divide by 16 and it's integer math, so it loses the decimal
    return multiple * 16;
} 
```

如果你像你的例子一样给它 50，那将返回 48。

如果你真的想要*最近*，那么你将不得不做一些浮点除法

```
public int nearestDivider(final int input)
{
    final int multiple = Math.round((float) input / 16);
    return multiple * 16;
} 
```

现在 46 返回 48， 149 返回 144 等等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-06T15:57:58.927

为了检查随机除法是否导致整数或分数，您需要以下内容：

```
int n = 9;
int p = 3;

if (n % p == 0) {
    //the division results in an integer.
}
else
{
    //the division results in a fraction.
} 
```

您可以这样做：

```
if (n / p == Math.ceil((double) n / (double) p)) {
    //the division results in an integer.
}
else
{
    //the division results in a fraction.
} 
```

需要 Math.ceil() 而不是四舍五入或下限，因为整数除法几乎等于下限，而分数将向下取整并显示为“整数除法”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-23T19:54:50.947

如果您需要*最接近*的 16 的倍数，那么您有两种情况来处理 8 的奇数倍数。1\. 8 变为 16，24 变为 32 2\. 8 变为 0，24 变为 16

为了第一：

```
int j = ((i+8)/16)*16; 
```

在第二种情况下：

```
int j = ((i+7)/16)*16; 
```

如果你想一直向下取整（即 17 变为 16，15 变为 0）：

```
int j = (i/16)*16; 
```

如果你想总是向上取整（不是你的例子所说的），你会这样做：

```
int j = ((i+15)/16)*16; 
```

# javascript - 从前一个日期创建一个日期并添加到它

> ID：12098073
> 
> 赞同：1
> 
> 时间：2012-08-23T18:40:40.637
> 
> 标签：javascript, html, date, time

嗨，我有一个名为 myDate 的变量，它设置正确。如果你想看看我是怎么做到的......

```
var myDate=new Date();
var ev_num = parseInt(document.getElementById("leave").value)
myDate.setFullYear(sel_year.value,sel_month.value,sel_day.value); 
```

我有另一个名为 first_number 的变量。我正在尝试将其设置为 myDate 并简单地添加 31 天，但显示的日期不正确。这是我的代码。有人可以帮我解决它吗...

```
 var first_number = new Date();
    first_number.setDate(myDate.getDate() + 31); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:45:36.147

我认为您想`first_number`使用`myDate`, 而不是创建新的（当前） Date 对象进行初始化。为此，请使用

```
var first_number = new Date(myDate); 
```

# r - 在没有数据框的情况下跟踪因子水平

> ID：12098081
> 
> 赞同：2
> 
> 时间：2012-08-23T18:41:19.463
> 
> 标签：r, r-factor

免责声明：这个项目一开始是别人的代码，我敢肯定有非最佳的设计决策，但我的手比我自己的项目更受束缚。

我有一个机器学习算法，它使用经过训练的模型对象和一组评分数据来创建评分数据的数据框。模型对象是一个带有公式和数据框的列表。

模型数据框的作用之一是确保评分数据框具有与模型预期相同的列，并且这些列的因子水平相同。为了实现这一点，我们将任意一行的训练数据存储在`model$df`（数据框）中，因为没有行的数据框被迫没有因子级别。然后我们使用有点笨拙的线

```
scoring.set$df <- rbind(model$df, scoring.set$df)[-1, ] 
```

这会产生具有相同值但扩展因子水平的评分数据框。我的理解是，`rbind`强制两个数据帧的因子变量中的水平等于两个单独帧中水平的并集，所以这几乎完全符合我的需要。

但是，我确信这不是*正确*的方法。有什么建议吗？

提前致谢，我会等着详细说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:47:26.753

创建示例数据集

```
set.seed(23452)

##create 5 variables with 15 levels and 5 variables with 20 levels
nrowd <- 100
full <- data.frame(
    replicate(5,letters[sample(sample(1:24,15),nrowd,replace=TRUE) ]),
    replicate(5,LETTERS[sample(sample(1:24,20),nrowd,replace=TRUE) ])
)

###the following code represents a process that creates a dataframe with variables 
###that have no more levels than full but may have fewer levels
scoring.set <- data.frame(sapply(full[sample(1:nrow(full),10),],as.character))

#factor levels are not the same
identical(sapply(full,levels),sapply(scoring.set,levels)) 
```

以下是您可以如何修复因子水平。

```
##make it so the levels of scoring.set variables have the levels of full
scoring.set2 <- data.frame(
    mapply(scoring.set,lapply(full,levels), SIMPLIFY=FALSE,
       FUN=function(scoring.var, full.level){     
        factor(scoring.var, levels=union(full.level,levels(scoring.var))) 
     }) 
) 
```

变量仍然与以前相同，现在它们具有与 full 相同的级别

```
all(
    mapply(scoring.set,scoring.set2, FUN=function(x,y){
        identical(as.character(x),as.character(y))
    })
)

    identical(sapply(full,levels),sapply(scoring.set2,levels)) 
```

非因子变量的引入会使事情复杂化，但一般的想法是将子集化为仅因子变量`factor.vars <- scoring.set[,sapply(scoring.set, is.factor)]`，然后做一些事情，比如`data.frame(fixed.factor.vars, scoring.set[,!sapply(scoring.set,is.factor)])[,names(scoring.set)]`让所有东西以相同的顺序重新组合在一起。

# lucene - Lucene 4.0 中的词向量频率

> ID：12098083
> 
> 赞同：9
> 
> 时间：2012-08-23T18:41:29.213
> 
> 标签：lucene

我正在从 Lucene 3.6 升级到 Lucene 4.0-beta。在 Lucene 3.x 中，`IndexReader`包含一个方法`IndexReader.getTermFreqVectors()`，我可以使用它来提取给定文档和字段中每个术语的频率。

此方法现在被替换为`IndexReader.getTermVectors()`返回`Terms`。我如何利用这个（或可能的其他方法）来提取文档和字段中的词频？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-24T15:35:09.053

也许这会帮助你：

```
// get terms vectors for one document and one field
Terms terms = reader.getTermVector(docID, "fieldName"); 

if (terms != null && terms.size() > 0) {
    // access the terms for this field
    TermsEnum termsEnum = terms.iterator(null); 
    BytesRef term = null;

    // explore the terms for this field
    while ((term = termsEnum.next()) != null) {
        // enumerate through documents, in this case only one
        DocsEnum docsEnum = termsEnum.docs(null, null); 
        int docIdEnum;
        while ((docIdEnum = docsEnum.nextDoc()) != DocIdSetIterator.NO_MORE_DOCS) {
            // get the term frequency in the document 
            System.out.println(term.utf8ToString()+ " " + docIdEnum + " " + docsEnum.freq()); 
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T00:21:53.373

看这个[相关的问题](https://stackoverflow.com/questions/1844194/get-cosine-similarity-between-two-documents-in-lucene/14438826#14438826)，特别是

```
Terms vector = reader.getTermVector(docId, CONTENT);
TermsEnum termsEnum = null;
termsEnum = vector.iterator(termsEnum);
Map<String, Integer> frequencies = new HashMap<>();
BytesRef text = null;
while ((text = termsEnum.next()) != null) {
    String term = text.utf8ToString();
    int freq = (int) termsEnum.totalTermFreq();
    frequencies.put(term, freq);
    terms.add(term);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T04:46:34.757

有各种关于如何使用灵活索引 api 的文档：

*   [http://lucene.apache.org/core/4_0_0-BETA/MIGRATE.html](http://lucene.apache.org/core/4_0_0-BETA/MIGRATE.html)
*   [https://builds.apache.org/job/Lucene-Artifacts-4.x/javadoc/core/org/apache/lucene/index/package-summary.html#postings](https://builds.apache.org/job/Lucene-Artifacts-4.x/javadoc/core/org/apache/lucene/index/package-summary.html#postings)

访问文档术语向量的字段/术语与访问帖子列表所使用的 API 完全相同，因为术语向量实际上只是该文档的微型倒排索引。

因此，按原样使用所有这些示例是完全可以的，尽管您可以做一些捷径，因为您知道这个“微型倒排索引”中只有一个文档。例如，如果您只是想获得一个术语的频率，您可以寻找它并使用诸如 totalTermFreq 之类的汇总统计信息（请参阅[https://builds.apache.org/job/Lucene-Artifacts-4.x/javadoc/core /org/apache/lucene/index/package-summary.html#stats](https://builds.apache.org/job/Lucene-Artifacts-4.x/javadoc/core/org/apache/lucene/index/package-summary.html#stats)），而不是实际打开一个只会枚举单个文档的 DocsEnum。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T19:34:51.557

我有这个在我的 Lucene 4.2 索引上工作。这是一个适合我的小型测试程序。

```
try {
    directory[0] = new SimpleFSDirectory(new File(test1));
    directory[1] = new SimpleFSDirectory(new File(test2));
    directory[2] = new SimpleFSDirectory(new File(test3));
    directoryReader[0] = DirectoryReader.open(directory[0]);
    directoryReader[1] = DirectoryReader.open(directory[1]);
    directoryReader[2] = DirectoryReader.open(directory[2]);

    if (!directoryReader[2].isCurrent()) {
        directoryReader[2] = DirectoryReader.openIfChanged(directoryReader[2]);
    }
    MultiReader mr = new MultiReader(directoryReader);

    TermStats[] stats=null;
    try {
        stats = HighFreqTerms.getHighFreqTerms(mr, 100, "My Term");
    } catch (Exception e1) {
        e1.printStackTrace();
        return;
    }

    for (TermStats termstat : stats) {
        System.out.println("IBI_body: " + termstat.termtext.utf8ToString() +
            ", docFrequency: " + termstat.docFreq);
    }
} 
```

# apache-zookeeper - 是否可以监视 ZooKeeper 中所有后代节点上的事件？

> ID：12098084
> 
> 赞同：8
> 
> 时间：2012-08-23T18:41:32.943
> 
> 标签：apache-zookeeper

使用 ZooKeeper 时是否可以监视后代 znode 上的所有事件？

例如，如果我有：

```
 (/)
     /  \
   (/a)  (/b)
   /       \
(/c)       (/d) 
```

有没有办法观察根目录对 /a、/b、/c 和 /d 的更改？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-24T04:07:51.227

没有 ZooKeeper api 可以做到这一点，您必须自己编写。

如果您正在使用[Curator](https://github.com/Netflix/curator)，则可以使用[PathCache](https://github.com/Netflix/curator/wiki/Path-Cache)维护节点上的手表以及该节点的子节点。当您发现正在观察的根的后代时，您可以编写一些代码来创建更多的 PathCache。

如果您要推出自己的版本，实际上很难做到正确。这个[博客](http://www.pongasoft.com/blog/yan/entry/zookeeper_loss_of_events_problem)描述了一些问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-05T13:33:19.357

我知道这是一个老问题。我只是在这里发帖供像我这样的其他人参考。

我也在找这个。按照@sbridges 的提示，我想我可以这样做。

```
PathChildrenCache pathcache = new PathChildrenCache(client, "/some/path", true);

PathChildrenCacheListener listner1 = new PathChildrenCacheListener() {
    Map<String, PathChildrenCache> listener2s = new HashMap<String, PathChildrenCache>();
    @Override
    public void childEvent(CuratorFramework client, PathChildrenCacheEvent event) throws Exception {
        String path = event.getData().getPath();

        if(event.getType() == Type.CHILD_ADDED) {
            PathChildrenCache cache2 = new PathChildrenCache(client, path, true);
            cache2.getListenable().addListener(this);
            cache2.start();
            listener2s.put(path, cache2);
        }
        else if(event.getType() == Type.CHILD_REMOVED) {
            PathChildrenCache cache2 = listener2s.remove(path);
            if(cache2 != null) cache2.close();
        }

        System.out.println("" + Thread.currentThread().getId() + "\t" + event);
    }
};
pathcache.getListenable().addListener(listner1); 
```

如果有人发现有问题，请告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-12-23T19:44:52.630

使用[TreeCache](https://curator.apache.org/curator-recipes/tree-cache.html)而不是 PathCache

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-01T01:55:58.880

如果您将 zookeeper 版本升级到**3.6.0** ，则可以使用**Persistent, Recursive Watches**。参见[Persistent, Recursive Watches](https://issues.apache.org/jira/browse/ZOOKEEPER-1416)和[Zookeeper Watchers](https://zookeeper.apache.org/doc/r3.7.0/zookeeperProgrammers.html#ch_zkWatches)

 **还有[Curator Persistent Recursive Watcher](https://curator.apache.org/curator-recipes/persistent-watcher.html)支持。**

# java - 我可以从基于 GlassFish v3.1.2 服务器的应用程序访问 akka 远程参与者吗？

> ID：12098090
> 
> 赞同：1
> 
> 时间：2012-08-23T18:41:49.887
> 
> 标签：java, glassfish, akka

Akka 远程处理使用 netty 作为其客户端服务器框架。有谁知道我是否可以在 GlassFish v3.1.2 中运行这个（客户端）的一端？

注意：我目前对 Akka 2.0.3 感兴趣；在 jdk 1.6 下运行以及它的价值（我不介意在必要时在 1.7 下编译，因为 play-mini Java 可能需要）

# linux - 启动 .desktop 文件时如何包含我的 bash 路径

> ID：12098094
> 
> 赞同：0
> 
> 时间：2012-08-23T18:42:10.703
> 
> 标签：linux, bash, path, launcher

我有一个用于启动 PyQt 应用程序的小型 bash 脚本。PyQt 应用程序使用 python`os.system()`调用来运行其他命令。我曾经`gnome-desktop-item-edit`为在终端中运行的脚本创建一个启动器。不幸的是，当它执行时，它没有收到我的任何`.bashrc`路径修改。我该怎么做：

1.  使用我的路径修改导致启动器在 bash 中运行，或者
2.  以更通用的方式修改路径，以便我需要的修改将反映在启动器创建的终端中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:55:53.457

经过进一步研究，我[在超级用户网站上找到了一篇文章，](https://superuser.com/questions/183870/difference-between-bashrc-and-bash-profile/183980#183980)其中解释了路径编辑的一些细节。将我的路径修改切换到 .profile 而不是 .bashrc 就可以了。

# asp.net-web-api - 当请求具有不受支持的 Content-Type 时，如何配置 ASP.NET Web API 服务返回的状态代码？

> ID：12098097
> 
> 赞同：4
> 
> 时间：2012-08-23T18:42:34.490
> 
> 标签：asp.net-web-api, content-negotiation

如果向我的 Web API 服务发出请求，该请求的`Content-Type`标头包含该服务不支持的类型，它会返回一个`500 Internal Server Error`状态代码以及类似于以下内容的消息：

```
{"Message":"An error has occurred.","ExceptionMessage":"No MediaTypeFormatter is available to read an object of type 'MyDto' from content with media type 'application/UnsupportedContentType'.","ExceptionType":"System.InvalidOperationException","StackTrace":" at System.Net.Http.HttpContentExtensions.ReadAsAsync[T](HttpContent content, Type type, IEnumerable`1 formatters, IFormatterLogger formatterLogger)
   at System.Net.Http.HttpContentExtensions.ReadAsAsync(HttpContent content, Type type, IEnumerable`1 formatters, IFormatterLogger formatterLogger)
   at System.Web.Http.ModelBinding.FormatterParameterBinding.ReadContentAsync(HttpRequestMessage request, Type type, IEnumerable`1 formatters, IFormatterLogger formatterLogger)
   at System.Web.Http.ModelBinding.FormatterParameterBinding.ExecuteBindingAsync(ModelMetadataProvider metadataProvider, HttpActionContext actionContext, CancellationToken cancellationToken)
   at System.Web.Http.Controllers.HttpActionBinding.<>c__DisplayClass1.<ExecuteBindingAsync>b__0(HttpParameterBinding parameterBinder)
   at System.Linq.Enumerable.WhereSelectArrayIterator`2.MoveNext()
   at System.Threading.Tasks.TaskHelpers.IterateImpl(IEnumerator`1 enumerator, CancellationToken cancellationToken)"} 
```

相反，我更愿意`415 Unsupported Media Type`按照建议返回状态代码，例如，[here](http://brockallen.com/2012/05/14/http-status-codes-for-rest/)。

我如何配置我的服务来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:29:03.287

这是我为这个问题提出的解决方案。

它广泛基于[此处](http://blog.ploeh.dk/2012/04/24/VendorMediaTypesWithTheASPNETWebAPI.aspx)描述的用于在没有可接受的响应内容类型时发送 406 Not Acceptable 状态代码的方法。

```
public class UnsupportedMediaTypeConnegHandler : DelegatingHandler {
    protected override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request,
                                                           CancellationToken cancellationToken) {
        var contentType = request.Content.Headers.ContentType;
        var formatters = request.GetConfiguration().Formatters;
        var hasFormetterForContentType = formatters //
            .Any(formatter => formatter.SupportedMediaTypes.Contains(contentType));

        if (!hasFormetterForContentType) {
            return Task<HttpResponseMessage>.Factory //
                .StartNew(() => new HttpResponseMessage(HttpStatusCode.UnsupportedMediaType));
        }

        return base.SendAsync(request, cancellationToken);
    }
} 
```

在设置服务配置时：

```
config.MessageHandlers.Add(new UnsupportedMediaTypeConnegHandler()); 
```

请注意，这要求字符集也匹配。`MediaType`您可以通过仅检查标头的属性来放松此限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:20:27.997

没有会自动更改状态代码的配置标志。您可以创建一个 MessageHandler，它可能会检查“正在发送的响应”并将状态代码修改为 415。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-24T07:07:48.147

返回状态码的标准方法是从您的操作中返回 HttpResponseMessage。您可以将内容包装在 HttpResponseMessage 对象中，并像这样设置状态，而不是原始内容：

```
public System.Net.Http.HttpResponseMessage Getresponse()
    {
        return new System.Net.Http.HttpResponseMessage() { Content = new System.Net.Http.StringContent(done.ToString()), StatusCode = System.Net.HttpStatusCode.Conflict };
    } 
```

# android - 从 Android 中的 EditText 中删除过滤器？

> ID：12098099
> 
> 赞同：24
> 
> 时间：2012-08-23T18:42:35.600
> 
> 标签：android, android-edittext

可以通过执行以下操作在字段中添加 3 个字符的限制来在 Android 中添加过滤器：

```
editText.setFilters(new InputFilter[] { new InputFilter.LengthFilter(3) }); 
```

但是删除已经设置的过滤器怎么样？我的问题是我将根据用户的选择在字段上的 3 和 4 个字符的最大长度之间切换。只是运行上面的代码感觉它会给 GC 带来很多额外的工作。

我当然可以添加几个对应于每个过滤器的实例变量，并在需要时添加它们，然后我将只有两个过滤器，这对于这种情况来说很好。知道是否可以完全删除过滤器会很有趣。也许通过传入null？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2014-01-05T18:11:02.143

如果您确实只想删除过滤器，而不是用另一个替换一个，您可以使用

```
editText.setFilters(new InputFilter[] {}); 
```

# objective-c - 如何从xcode项目中的本地文本文件中获取文本

> ID：12098101
> 
> 赞同：-3
> 
> 时间：2012-08-23T18:42:48.813
> 
> 标签：objective-c, xcode4.2

我在支持文件中保存了一个文件。现在我想将该文件中的文本检索到 xcode 中的文本字段。请帮助我解决这个问题。如果可能，请发布任何代码。我使用了以下代码。但我无法访问。

```
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"iPhone.txt" ofType:@"txt"];    
NSString *textData = [NSString stringWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:nil];

NSLog(@"Some text from a file of %@", textData);
NSLog(@"The length of the string is %u",[textData length]); 
```

错误：

> *** 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“-[UIViewController _loadViewFromNibNamed:bundle:] 加载了“FirstInMacViewController”笔尖，但未设置视图出口。***首先抛出调用栈：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:48:42.120

该错误与您发布的代码无关。看起来您错误地断开了`view`笔尖的插座。打开您的笔尖并用鼠标右键从文件所有者拖动到顶层视图并连接`view`插座。

# unix - Emacs 自定义语言自动缩进

> ID：12098102
> 
> 赞同：2
> 
> 时间：2012-08-23T18:42:49.883
> 
> 标签：unix, emacs, programming-languages, elisp, indentation

我正在编写一个主要模式来使用 Emacs 编辑我的自定义语言源（虽然我不知道 Lisp）。语法高亮很容易实现，但现在我正在尝试设置自动缩进，但我做不到。

我已经测试[了这段代码](https://stackoverflow.com/a/4158816/972197)，它非常适合`'{'`,`'['`和字符。例如，在我的测试中，如果我将regex 更改为，它不会自动缩进. 为什么？我要疯了！`']'``'}'``"[[{]"``"[[:]"``':'`

我的真正目的是在`if`和`endif`关键字之间以及在`while`和`endwhile`关键字之间缩进块。例如：

```
if a > 0
    b = 2
    while b = 2
        a = 0
    endwhile
endif 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T04:18:59.693

很长一段时间，自动缩进并不像语法高亮那样简单。对缩进的通用支持很少。如果您使用的是最新的 Emacs，您可能想尝试使用 SMIE 包。也许尝试它的一个好方法是查看 octave-mod.el 如何使用它（例如在 Emacs-24 中）。但不要指望这很容易。

# javascript - 如何在不提交表单的情况下使用 jQuery.validate？

> ID：12098103
> 
> 赞同：14
> 
> 时间：2012-08-23T18:42:51.280
> 
> 标签：javascript, jquery, jquery-validate

我已经阅读了有关此的其他几篇文章，但仍然没有成功。试图保持简单。我需要在最终提交之前验证在 jQuery 手风琴中隐藏/显示的表单部分。我已经使用`jquery.validate.js`了很长时间，只要我验证`submit`一切都很好，但是现在当我尝试验证按钮`click` 时它不起作用。

```
 <script type="text/javascript">
jQuery().ready(function(){
    var demo = $(".demo").accordion({
        header: '.header',
        event: false
    });

    var nextButtons = $([]);
    $("h3.header", demo).each(function(index) {
        nextButtons = nextButtons.add($(this)
        .next()
        .children(":button")
        .filter(".next, .previous")
        .click(function() {
            demo.accordion("activate", index + ($(this).is(".next") ? 1 : -1))
        }));
    });

});
</script>
<script type="text/javascript">

$(".next").click(function(){
$("#test").validate({              
     rules: {
                     name: "required", // simple rule, converted to {required:true}
                     email: {// compound rule
                         required: true,
                         email: true
                     },
                     comment: {
                         required: true
                     }
                 },
                 message: {
                     comment: "Please enter a comment."
                 }
             });

});
</script>
    <div class="demo">
<form action="#" method="post" id="test">
  <fieldset>
<div id="accordion">
    <h3 class="header"><a href="#">Section 1</a></h3>
    <div class="sec1">
    <label for="name">Name:</label>
    <input type="text" id="name" placeholder="Enter your 
full name" class="required" />
<input type="button" class="next" value="NEXT" />
    </div>
    <h3 class="header"><a href="#">Section 2</a></h3>
    <div class="sec2">
    <label for="email">Email:</label>
    <input type="email" id="email" placeholder="Enter 
your email address" class="required" />
<input type="button" class="next" value="NEXT" />
<input type="button" class="previous" value="Previous"/>
    </div>
    <h3 class="header"><a href="#">Section 3</a></h3>
    <div class="sec3">
    <label for="message">Message:</label>
    <textarea id="message" placeholder="What's on your 
mind?" class="required"></textarea>
    <input type="submit" value="Send message" />
    <input type="button" class="previous" value="Previous"/>
    </div>
      </fieldset>
</form>

</div>
</div><!-- End demo --> 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-08-23T22:49:13.937

问题是您无法`validate()` *在*处理程序中进行初始化。您在内部初始化它`document.ready`并用于`.valid()`测试有效性。在这种情况下，不需要提交按钮来验证表单。

根据[这个答案](https://stackoverflow.com/a/11068130/594235)：

[`.validate()`](http://jqueryvalidation.org/validate/)是在您的`form`.

[`.valid()`](http://docs.jquery.com/Plugins/Validation/valid)返回`true`或`false`取决于您的表格目前是否有效。

因此，在您的`.click()`处理程序中，您将使用`.valid()`, not`.validate()`与`if`语句一起测试表单是否有效......

```
$(document).ready(function() {
    $("#test").validate({  // initialize plugin on the form
         rules: {
         ...
         }
         ...
         // etc.
    });

    $(".next").click(function(){  // capture the click
        if($("#test").valid()){   // test for validity
            // do stuff if form is valid
        } else {
            // do stuff if form is not valid
        }
    });
}); 
```

有关更多信息，请参阅[docs.jquery.com/Plugins/Validation/valid](http://docs.jquery.com/Plugins/Validation/valid)。

通常，您会`type="submit"`在容器中拥有一个按钮`form`，在这种情况下，不需要捕获任何点击，因为这一切都是自动完成的。`submit`这个答案是针对不使用传统按钮的 OP 的特定情况量身定制的。

**旁注：** 您的所有 JavaScript 都可以包含在一*组*标记`<script></script>`中。多组标签串在一起是不必要和多余的。

# c++ - 为什么不允许在构造函数之外初始化类成员？

> ID：12098109
> 
> 赞同：2
> 
> 时间：2012-08-23T18:43:10.177
> 
> 标签：c++

换句话说，为什么编译器会抱怨这样的事情：

```
class Integer {
  int i = 3;
}; 
```

尽管这是一个非常愚蠢的例子，但在许多情况下，类的成员可以默认初始化为某个值（例如，某些内部计数器始终默认初始化为零）。在类构造函数之外禁止这些默认初始化的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:51:20.900

因为有构造函数。

```
class InTeGeR
{
    Public:
           int i;
           InTeGeR()
            {
                i=3;
            }
 } 
```

在存在构造函数初始化的情况下：

```
class InTeGeR
{
    Public:
           int i=3;
           InTeGeR()
            {
                i=5;
            }
            //now, i could be 3 or 5\. Which one? 
            int j=i+1;
            //is j 4 or 6? Very confusing
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:58:44.063

正如评论中所说，在 C++11 中，你实际上可以像你展示的那样做。然而，它在 C++98/C++03 中仍然是非法的。

编辑：但是要回答你的问题：我不知道：p 也许语言设计者认为在发布 C++98 时没有人愿意这样做。无论如何，您现在当然可以使用 C++11 做到这一点。

# python - 如何在 Selector 中选择子元素

> ID：12098112
> 
> 赞同：0
> 
> 时间：2012-08-23T18:43:32.487
> 
> 标签：python, beautifulsoup, lxml, scrapy

我正在使用 HTMLXPathSelector 来解析 HTML 内容。并且目标网站有一个随机的 HTML 标签。例如：它的格式可能是：

```
<div class="doctor_ans">
  <h3>Title</h3>
  <p style="text-align: justify;">
    <span style="font-size: 12px;">
      <span style="font-family: arial,helvetica,sans-serif;">
        <font color="#000000">I would like to get contain here.</font>
      </span>
    </span>
  </p>    
</div> 
```

或者

```
<div class="doctor_ans">
  <h3>Title</h3>
  <p style="text-align: justify;">
    <span style="font-size: 12px;">
      <span style="font-family: arial,helvetica,sans-serif;">
        I would like to get contain here.>
      </span>
    </span>
  </p>    
</div> 
```

或者

```
<div class="doctor_ans">
  <h3>Title</h3>
  <p>
    <span style="font-size: 12px;">
      <span style="font-family: arial,helvetica,sans-serif;">
        <font color="#000000">I would like to get contain here.</font>
      </span>
    </span>
  </p>    
</div> 
```

或者

```
<div class="doctor_ans">
  <h3>Title</h3>
  <p>
    <span style="font-size: 12px;">
        I would like to get contain here.
    </span>
  </p>    
</div> 
```

等等。
请给我你的建议如何解析这个内容。HTML 标记随机出现。所以，我需要一种方法来获取子元素以找到最终元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:54:30.783

```
hxs = HtmlXPathSelector(response)
hxs.select('div[@class="doctor_ans"]/p[1]//text()').extract() 
```

`doctor_ans`将为您提供div第一段中每个单独文本的列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:34:43.470

我有更多使用 Selenium 的经验，但 xpath 部分应该是相同的。使用 xpath='.//span' 选择子元素，然后获取该元素的 .text。如果子元素为空，则丢弃，移动到下一个元素。

# asp.net-mvc - 控制使用视图模型生成的表单元素的默认值和格式

> ID：12098117
> 
> 赞同：0
> 
> 时间：2012-08-23T18:43:54.630
> 
> 标签：asp.net-mvc, vb.net, html-helper, asp.net-mvc-viewmodel

我正在使用模型类生成表单元素，如下所示

```
Public Class BookAppointment
    Property DoctorNin As Integer
    Property PatientNin As Integer
    Property BookingDate As Date

    Property Doctors As IEnumerable(Of SelectListItem)
End Class 
```

当我将此视图模型传递给视图页面时，一些值已经作为默认值存在，但它们是无效的。

喜欢`PatientNin`我用

```
<%= Html.TextBoxFor(Function(x) x.PatientNin)%> 
```

当表单被渲染时，它会得到`0`一个默认值，这是不需要的。如何控制这样的默认值？

在上述情况下，同样的情况发生`BookingDate`在我得到的文本框中`1/1/0001 12:00:00 AM`哪个格式不正确和不需要的默认值？

如何解决这样的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:53:45.110

`integer`类型的默认值为`zero`. 因此，如果您没有为其分配任何值。它将带零作为值。

如果您不想要默认的零值，您可以将您的属性切换为`Nullable`类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:56:11.063

Changes default value to 100 if its not greater than 0:

```
<%= Html.TextBoxFor(Function(x) If(x.PatientNin > 0, x.PatientNin, 100))%> 
```

# android - 以编程方式将 imageview 放在 imageview 下面

> ID：12098118
> 
> 赞同：0
> 
> 时间：2012-08-23T18:43:55.507
> 
> 标签：android, parameters, position, imageview

我正在尝试使用布局参数将图像视图放置在另一个图像视图下方，但它不起作用..我想做到这一点：http: [//imgur.com/eZfEI](http://imgur.com/eZfEI)

```
RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);
params.addRule(RelativeLayout.ALIGN_PARENT_RIGHT, RelativeLayout.TRUE);

                    iv_album[i] = new ImageView(main.this);
                    iv_album[i].setImageBitmap(resized_a_p);
                    iv_album[i].setPadding(0, 5, 5, 0);
                    iv_album[i].setId(i);
                    iv_album[i].setOnLongClickListener(main.this);
                    iv_album[i].setOnClickListener(main.this);
                    if (i>1){
                        params.addRule(RelativeLayout.BELOW, iv_album[i].getId() - 1);
                    } 
```

怎么了 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T02:10:46.560

为每个 ImageView 创建一个 LayoutParams 对我有用：

```
RelativeLayout layout = (RelativeLayout) this.findViewById(R.id.layoutConnection);

ImageView[] iv_album = new ImageView[8];
for (int i = 0; i < 8; i++) {

    RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);
    params.addRule(RelativeLayout.ALIGN_PARENT_RIGHT, RelativeLayout.TRUE);

    iv_album[i] = new ImageView(this);
    iv_album[i].setImageDrawable(this.getResources().getDrawable(R.drawable.ic_launcher));
    iv_album[i].setPadding(0, 5, 5, 0);
    iv_album[i].setId(i + 1); // BELOW id 0 doesn't work
    if (i > 0) {
        params.addRule(RelativeLayout.BELOW, iv_album[i - 1].getId());
    }

    layout.addView(iv_album[i], params);
} 
```

希望能帮助到你

# java - 使用 NDK 编写安卓游戏还需要 Java 吗？

> ID：12098119
> 
> 赞同：0
> 
> 时间：2012-08-23T18:43:56.950
> 
> 标签：java, android, c++, android-ndk

我想学习如何编写Android游戏，但我不会任何java，只会C++。我需要学习 Java 才能使用 NDK 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T18:49:07.220

如果您看一下[The Native Activity](http://developer.android.com/reference/android/app/NativeActivity.html)，您应该能够在不使用 Java 的情况下编写游戏。请注意，很多 Android 框架都使用 java，您可能需要 JNI 来处理事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:36:03.170

您可以使用 Cocos2d-X ( [http://www.cocos2d-x.org/](http://www.cocos2d-x.org/) ) 或类似的库并用 C++ 编写 99% 的游戏，但您仍然需要少量的 java 胶水代码。

# javascript - Jquery UI 可排序，自动移动项目

> ID：12098120
> 
> 赞同：3
> 
> 时间：2012-08-23T18:44:00.623
> 
> 标签：javascript, jquery, jquery-ui-sortable

我有两个可排序的链表，称它们为列表 1 和列表 2。

列表 1 是用户可以选择的所有可能项目的列表，他将它们拖到他的购物篮中，即列表 2。

我想要做的是在列表 2（购物篮）中的每个项目旁边有一个按钮（或链接），单击该按钮将项目移回列表 1，而用户实际上不必将其拖到那里。

我知道我可以很容易地实现这一点，只需使用 remove() 从列表 2 中删除项目，然后使用 append() 或 after() 等将其添加回列表 1，但我希望移动动画。

有没有一种方法可以实现这一点，以便项目自动从一个列表“拖动”到另一个列表？如果是这样怎么办？

我环顾四周，但无济于事，但如果可以的话，该网站会好得多。因此，您可以提供的任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T16:22:15.147

好的，我想出了答案，所以我想既然我问了这个问题，我应该把答案放在这里，以帮助其他需要知道的人。

我有点愚蠢地寻找一种通过 jquery ui 来做到这一点的方法，因为我的列表是可排序的这一事实是无关紧要的，我只需要用户 jquery 来移动元素并为其设置动画。

下面的函数对此非常有用：

```
function moveAnimate(element, newParent){
    var oldOffset = element.offset();
    element.appendTo(newParent);
    var newOffset = element.offset();

    var temp = element.clone().appendTo('body');
    temp    .css('position', 'absolute')
            .css('left', oldOffset.left)
            .css('top', oldOffset.top)
            .css('zIndex', 1000);
    element.hide();
    temp.animate( {'top': newOffset.top, 'left':newOffset.left}, 'slow', function(){
       element.show();
       temp.remove();
    });
} 
```

它是由 Davy8 在这个线程上提供的： [JQuery - animate move DOM element to new parent？](https://stackoverflow.com/questions/907279/jquery-animate-moving-dom-element-to-new-parent)

# wifi - 如何提高室内定位精度？

> ID：12098122
> 
> 赞同：10
> 
> 时间：2012-08-23T18:44:08.533
> 
> 标签：wifi, trilateration, indoor-positioning-system

我应该为某个地方开发一个室内定位系统，所以我从收集有关如何开发这样一个系统的信息开始，我现在的问题是：什么控制定位的准确性以及如何改进它？我发现了不同的API和项目，精度各不相同，例如：爱立信室内定位API提供10米以内的精度，而Qubulus API提供4米以内的精度，我遇到了一些像[iDOCNET](http://www.egr.msu.edu/classes/ece480/capstone/spring11/group02/index.html)这样的项目，声称提供1.2左右的精度。米。那么，控制精度的室内导航系统的主要组成部分是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-05T11:42:08.390

我正在做一个类似的项目，并测试了几个现有的工具。

您可以在此处找到有关 IPS 准确度/精度/分辨率的一些有趣信息：

[关于 IPS 分辨率的 Stackoverflow 线程](https://stackoverflow.com/questions/9726666/pinpointing-indoor-location-with-android-not-accurate-enough)

尤其要阅读 TRX Systems 的 Carol Politi 的答案。

简而言之，精度主要取决于用作参考信号的无线电信标的类型和密度（可以是 GSM/WDCMA/UMTS 网络单元、wi-fi 接入点、蓝牙加密狗/信标等）。因此，为了提高系统的精度，您必须使用所有现有/可用的无线电源（手机和 wi-fi 接入点），并且，也许，您必须添加/安装自己的参考点（很可能是 wi-无线路由器）。

只要我能够从迄今为止的实验中看到，您可以从此类基于无线电的系统中获得的实际精度如下。

*   电话网络：1至2公里
*   Wi-Fi：10 至 150 m（通常为 40 - 150 m）
*   蓝牙：4 到 10 m（使用诺基亚技术可能更好，使用 BT 3.0 和特殊信标）

一起使用不同的技术只会为您提供最佳技术的精确度。例如，当您使用手机和 wi-fi 接入点作为参考点时，您只会获得 10 到 150 m 的分辨率。没有什么比......好。

有关基于 wi-fi 指纹系统的示例/灵感，请查看：[Redpin](http://redpin.org/)。

仅使用无线电信号（无线电多点定位）获得房间级分辨率的唯一方法似乎是蓝牙。诺基亚为此开发了一些东西。

提高整个系统分辨率的有效方法是将基于无线电的定位系统（如 wi-fi 指纹识别）与基于地图的定位系统（谷歌的“寻路”：许多 2D 游戏中使用的相同地图导航技术）配对）。

这样，您可以强制您的整个系统精确定位您的用户，他/她实际上可以在哪里（在过道中，在房间内），避开不可步行的区域（如墙的内部或不可访问的部分）建筑物）。这使您计算的导航路径更加合理，但在长走廊和过道中，分辨率仍然很差（5 到 10 m 或更差）。

另一种方法称为“传感器融合”：将来自加速度计、指南针和其他内置在用户移动设备中的传感器的位置/运动知识添加到基于无线电的系统中。

此类混合系统已在市场上销售，无需安装任何辅助无线电信标，即可为您提供高达 2 - 4 m（房间级、过道级）的分辨率（此类系统也称为“无基础设施的室内定位系统”） . 其中一些系统也使用寻路算法。

例如/关于混合系统的灵感，请看：[Footpath](https://github.com/COMSYS/FootPath)。

有关更鼓舞人心的项目，请参阅杜克大学[的 UnLoc：Gizmag 的 UnLoc](http://www.gizmag.com/unloc-indoor-navigation-app/23106/)和[Duke](http://today.duke.edu/2012/06/unloc)的 UnLoc 。

如果您需要更好的分辨率，很可能您必须安装自己的蓝牙信标（和/或使用诺基亚技术）。

# mysql - 将 IF 子句从 MySQL 转移到 SQL Server 2005

> ID：12098124
> 
> 赞同：2
> 
> 时间：2012-08-23T18:44:18.883
> 
> 标签：mysql, sql, sql-server, sql-server-2005

如何将此 MySQL 查询转换为 SQL Server 等效项？

```
SELECT User.id, User.first, User.last,
IF (User.first = q1 OR User.first = q2, 1, 0) +
IF (User.last = q1 OR User.last = q2, 1, 0) as points
FROM users as User
ORDER BY points DESC 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T18:46:16.487

`IF`SQL Server 中的等价物是[`CASE`表达式](http://msdn.microsoft.com/en-us/library/ms181765%28SQL.90%29.aspx)。（或[`IIF`在 SQL Server 2012](http://msdn.microsoft.com/en-us/library/hh213574.aspx)中。）我还删除了在这种情况下似乎毫无意义的别名。

```
SELECT id, first, last, 
  CASE WHEN first IN (q1,q2) THEN 1 ELSE 0 END
  + CASE WHEN last IN (q1,q2) THEN 1 ELSE 0 END AS points
FROM dbo.users
ORDER BY points DESC; 
```

# javascript - 如何获取 XML 值，然后使用 javascript 将它们输出到 htm 文件中？

> ID：12098135
> 
> 赞同：0
> 
> 时间：2012-08-23T18:44:55.903
> 
> 标签：javascript, html, xml, ajax

谁能告诉我或提供一个完整（但简单）的示例，说明如何获取 XML 节点的值并将其绘制（输出）到特定的 HTML 元素中。

我花了几个小时试图查找这个，但对我没有任何用处，或者示例不完整。

另外，请注意，我既不需要也不希望使用“.each”方法或任何循环。我只想单独获取一个节点值并将其放入一个 html 元素中，但是我希望有一个示例，说明两个文件（xml 和 javascript）中的内容，以及如何打开 xml 文档。我已经看到了打开 xml 文档的示例，但是它们彼此不同，因此我无法知道哪个实际有效。

我也对此做了一些测试，但似乎无法让它绘制任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:14:55.193

好吧，您可以使用 Ajax 调用来读取文件，并在成功回调中操作从文件接收到的数据...

假设xml是这样的：

```
<nodeYouWant simpleAttr="JustAnExample">Text inside Node</nodeYouWant> 
```

要获取 XML 节点，您可以使用：

```
$.ajax({
    type: "GET",
    url: "pathToXML.xml",
    dataType: "xml",
    success: function(data){

        //this gets a node
        var node = data.getElementsByTagName("nodeYouWant");

        //this gets an attribute from the node you just got
        var attr = node.getAttribute("simpleAttr");

       //To put that attr on a html block:
       $(selector).html(attr);

      //or if you want the text content of the node do:
      var nodeText = $(node).text();
      $(selector).html(nodeText);

    }
}); 
```

$(selector) 它是一种 jQuery 方式来定义要放置文本的 html 块...

例子：

```
<div id="myID" class="myClass"></div> 
```

选择器可以是 $(".myClass") 或 $("#myID")

有关更多信息，请参阅[选择器。](http://api.jquery.com/category/selectors/)

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:17:51.550

您需要了解的主要内容是 DOM 是如何工作的。如果你不知道 DOM 是如何工作的，你可以[在这里找到一些信息](http://www.w3schools.com/htmldom/default.asp)

本质上，您正在处理父标签和子标签。使用 XML，您需要提取该信息，然后您可以从那里做任何您喜欢的事情。

如果您转到左侧栏，这里有很多关于如何操作 XML DOM 节点的示例和[教程](http://www.w3schools.com/dom/dom_nodes_get.asp)

不过，这里只是需要了解的几件事（我的教授教我这个，它们是有用的提示）

1.  您不能使用 id 或类。相反，您应该使用以下方式获取 XML 节点

    `var elements = node.getElementsByTagName("tagname");`

2.  您不能使用 innerHTML 来获取节点内的文本。您可以使用 HTML，但不能使用 XML。为此，您必须使用

    `var text = node.firstChild.nodeValue;`

3.  你不能`.attributeName`用来获取属性。你需要使用

    `var attrValue = node.getAttribute("attrName");`

希望这可以帮助。如果你还在苦苦挣扎，请问。

好吧，我一直在尝试使用 w3schools 上的示例，我希望这会有所帮助。如果它不只是问：

转到此[示例](http://www.w3schools.com/ajax/tryit.asp?filename=tryajax_responsexml)

我将尝试演练这个示例，但您应该对正在发生的事情有一个大致的了解。他们有一个名为[cd_catalog.xml](http://www.w3schools.com/ajax/cd_catalog.xml)的 XML 文件，其中包含他们需要的所有信息。当他们按下按钮时，它只是以 HTML 格式显示所有信息。如果您查看之前和之后的 HTML 代码，您会发现`myDiv`在 xml 文件中填充了所有艺术家。

现在让我们看一下代码。

```
function loadXMLDoc()
{
var xmlhttp;
var txt,x,i;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    xmlDoc=xmlhttp.responseXML;
    txt="";
    x=xmlDoc.getElementsByTagName("ARTIST");
    for (i=0;i<x.length;i++)
      {
      txt=txt + x[i].childNodes[0].nodeValue + "<br />";
      }
    document.getElementById("myDiv").innerHTML=txt;
    }
  }
xmlhttp.open("GET","cd_catalog.xml",true);
xmlhttp.send();
} 
```

需要指出的一些关键事项。一步一步他们有一个功能，所以当文档完全加载并且代码已经发送（这由检查`xmlhttp.status==200`）他将从 cd_catalog.xml 中提取所有 xml 数据并`xmlDoc`通过获取将其存储到`xmlhttp.responseXML`

因此，现在`xmlDoc`将 cd_catalog.xml 中的所有信息存储在一个方便的变量中。从那里，他用来`xmlDoc.getElementsByTagName("ARTIST");`获取 xml 文件中所有艺术家的数组，仅此而已。他将这个数组命名为 x。

现在他遍历这个称为 x 的巨大数组，对于每个索引`i`（表示为 x[i]），他得到了[childNodes](http://www.w3schools.com/dom/prop_element_childnodes.asp)，它返回一个数组，里面只有一个东西（文本），这就是为什么他引用`childNodes[0]`索引并且他得到它的`.nodeValue`。因此，现在他将最初存储在 xml 文件中的文本保存在一个名为的变量中`txt`，他只需添加一个`</br>`标签和他想要的任何其他 HTML 并将其放入，`document.getElementById("myDiv").innerHTML`以便将其翻译成 HTML 格式。对 xml 文件中的每个 ARTIST 标记重复此过程。

我希望这有帮助。如果您仍然感到困惑，请告诉我们。这确实需要您知道您正在处理的 xml 文件及其位置。

# web-services - 在 IIS 7 中托管的 Restful Web 服务不处理数据合同成员

> ID：12098136
> 
> 赞同：0
> 
> 时间：2012-08-23T18:45:09.857
> 
> 标签：web-services, iis-7, c#-3.0, datacontract, datamember

我需要创建一个托管在 IIS 7 中的简单 HTTP C# restful web 服务，该服务可以支持来自标注的 POST，并且 POST 数据的格式似乎没有得到正确处理。数据成员名称的要求是其中包含破折号，例如 custom-1。我的问题是自定义 10 或更高的数据成员名称只给我 null 数据。custom-1 到 custom-9 都可以。

如果有人可以提供帮助，我将不胜感激！！！

以下是 POST 数据所需的格式：

```
 <person-search-request xmlns="someurl"> 
    <person>
        <custom-1 />
        <custom-2 />
        <custom-3 />
        <custom-4 />
        <custom-5 />
        <custom-6 />
        <custom-7 />
        <custom-8 />
        <custom-9 />
        <custom-10 />
        <custom-11 />
        <custom-12 />
        <custom-13 />
        <custom-14 />
        <custom-15 />
        <custom-16 />
        <custom-17 />
        <custom-18 />
        <custom-19 />
        <custom-20 />
      </person>
     </person-search-request> 
```

我的 Web 服务数据契约如下所示：

```
 [CollectionDataContract(Name = "person-search-request", Namespace="")]
    public class PersonsRequest : List<Person>
    { }

    [CollectionDataContract(Name = "person-search-response", Namespace="")]
    public class PersonsResponse : List<Person>
    { }

    [DataContract(Name = "person", Namespace = "")]
    public class Person
    {
        public Person()
        {
            Custom14 = String.Empty;
            Custom13 = String.Empty;
            Custom15 = String.Empty;
            Custom16 = String.Empty;
            Custom17 = String.Empty;
            Custom18 = String.Empty;
            Custom19 = String.Empty;
            Custom20 = String.Empty;
            Custom7 = String.Empty;
            Custom8 = String.Empty;
            Custom9 = String.Empty;
            Custom1 = String.Empty;
            Custom10 = String.Empty;
            Custom11 = String.Empty;
            Custom12 = String.Empty;
            Custom3 = String.Empty;
            Custom4 = String.Empty;
            Custom5 = String.Empty;
            Custom6 = String.Empty;
        }

        [DataMember(Name = "custom-14")]
        public string Custom14 { get; set; }
        [DataMember(Name = "custom-7")]
        public string Custom7 { get; set; }
        [DataMember(Name = "custom-8")]
        public string Custom8 { get; set; }
        [DataMember(Name = "custom-9")]
        public string Custom9 { get; set; }
        [DataMember(Name = "custom-13")]
        public string Custom13 { get; set; }
        [DataMember(Name = "custom-15")]
        public string Custom15 { get; set; }
        [DataMember(Name = "custom-16")]
        public string Custom16 { get; set; }
        [DataMember(Name = "custom-17")]
        public string Custom17 { get; set; }
        [DataMember(Name = "custom-18")]
        public string Custom18 { get; set; }
        [DataMember(Name = "custom-19")]
        public string Custom19 { get; set; }
        [DataMember(Name = "custom-20")]
        public string Custom20 { get; set; }
        [DataMember(Name = "custom-10")]
        public string Custom10 { get; set; }
        [DataMember(Name = "custom-11")]
        public string Custom11 { get; set; }
        [DataMember(Name = "custom-12")]
        public string Custom12 { get; set; }
        [DataMember(Name = "custom-1")]
        public string Custom1 { get; set; }
        [DataMember(Name = "custom-2")]
        public string Custom2 { get; set; }
        [DataMember(Name = "custom-3")]
        public string Custom3 { get; set; }
        [DataMember(Name = "custom-4")]
        public string Custom4 { get; set; }
        [DataMember(Name = "custom-5")]
        public string Custom5 { get; set; }
        [DataMember(Name = "custom-6")]
        public string Custom6 { get; set; }
        /// <summary>

    } 
```

我的服务端点设置如下：

```
 [ServiceBehavior(IncludeExceptionDetailInFaults = true), AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed), ServiceContract]
public partial class Service
{

     [WebHelp(Comment = "Person POST")]
    [WebInvoke(UriTemplate = "person/v1.0/fetch", BodyStyle = WebMessageBodyStyle.Bare, ResponseFormat = WebMessageFormat.Xml, RequestFormat = WebMessageFormat.Xml)]
    [OperationContract]
    public PersonsResponse FetchPerson(PersonsRequest request)
    {
            ....
     } 
```

}

Post 数据如下所示（使用 Fiddler 进行测试）：

```
 <person-search-request> 
    <person>
        <custom-1>1</custom-1>
        <custom-2>2</custom-2>
        <custom-3>3</custom-3>
        <custom-4>4</custom-4>
        <custom-5>5</custom-5>
        <custom-6>6</custom-6>
        <custom-7>7</custom-7>
        <custom-8>8</custom-8>
        <custom-9>9</custom-9>
        <custom-10>10</custom-10>
        <custom-11>11</custom-11>
        <custom-12>12</custom-12>
        <custom-13>13</custom-13>
        <custom-14>14</custom-14>
        <custom-15 />
        <custom-16 />
        <custom-17 />
        <custom-18 />
        <custom-19 />
        <custom-20 />
     </person>
</person-search-request> 
```

数据以 10-20 个自定义标签中的空值进入端点。有谁知道为什么？？？:(

这是我从传递给方法的请求对象进行调试时看到的。

```
 Custom1    "1" string
    Custom10    null    string
    Custom11    null    string
    Custom12    null    string
    Custom13    null    string
    Custom14    null    string
    Custom15    null    string
    Custom16    null    string
    Custom17    null    string
    Custom18    null    string
    Custom19    null    string
    Custom2 "2" string
    Custom20  null  string
    Custom3 "3" string
    Custom4 "4" string
    Custom5 "5" string
    Custom6 "6" string
    Custom7 "7" string
    Custom8 "8" string
    Custom9 "9" string 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:34:16.750

我能够使用 order 属性解决此问题。仍然表现得不可预测。如果其他人有更好的解释，将不胜感激！！！

无论如何，这是修复（还有其他不重要的成员开始使用 1 和 2 插槽）：

```
 [DataMember(Name = "custom-1", Order = 3)]
        public string Unused1 { get; set; }
        [DataMember(Name = "custom-2", Order = 4)]
        public string Unused2 { get; set; }
        [DataMember(Name = "custom-3", Order = 5)]
        public string Unused3 { get; set; }
        [DataMember(Name = "custom-4", Order = 6)]
        public string Unused4 { get; set; }
        [DataMember(Name = "custom-5", Order = 7)]
        public string Unused5 { get; set; }
        [DataMember(Name = "custom-6", Order = 9)]
        public string Unused6 { get; set; }
        [DataMember(Name = "custom-7", Order = 10)]
        public string License { get; set; }
        [DataMember(Name = "custom-8", Order = 11)]
        public string LicenseState { get; set; }
        [DataMember(Name = "custom-9", Order = 12)]
        public string Tax { get; set; }
        [DataMember(Name = "custom-10", Order = 13)]
        public string Unused10 { get; set; }
        [DataMember(Name = "custom-11", Order = 14)]
        public string Unused11 { get; set; }
        [DataMember(Name = "custom-12", Order = 15)]
        public string Unused12 { get; set; }
        [DataMember(Name = "custom-13", Order = 16)]
        public string ProfDesignation { get; set; }
        [DataMember(Name = @"custom-14", Order = 17)]
        public string NPI { get; set; }
        [DataMember(Name = "custom-15", Order = 18)]
        public string Address1 { get; set; }

        [DataMember(Name = "custom-16", Order = 19)]
        public string Address2 { get; set; }

        [DataMember(Name = "custom-17", Order = 20)]
        public string Address3 { get; set; }

        [DataMember(Name = "custom-18", Order = 21)]
        public string City { get; set; }

        [DataMember(Name = "custom-19", Order = 22)]
        public string State { get; set; }

        [DataMember(Name = "custom-20", Order = 23)]
        public string Zip { get; set; } 
```

# shell - 在 tcsh 中打开最近的文件

> ID：12098145
> 
> 赞同：1
> 
> 时间：2012-08-23T18:45:47.160
> 
> 标签：shell, ls, tcsh

所以我正在尝试创建一个别名，该别名将在我们工作室的应用程序中直接打开最新文件。

我得到了最新的文件：

```
ls -t .ext | head -1 
```

当我只运行那条线时效果很好，但如果我尝试：

```
echo "ls -t .ext | head -1"
app "ls -t .ext | head -1" 
```

我得到这个返回而不是文件打开：

```
ls -t <all the files in the directory> | head -1 
```

有任何想法吗？非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:02:41.573

尝试

```
app `ls -t .ext | head -1` 
```

或者

```
app $(ls -t .ext | head -1) 
```

其中任何一个都获取输出`head`并将其替换到命令行中。

# android - 录制的视频上传到互联网后旋转 90 度

> ID：12098147
> 
> 赞同：18
> 
> 时间：2012-08-23T18:45:51.190
> 
> 标签：android, autorotate, video-recording

我发现以纵向模式录制的视频会旋转 90 度。因此，我在设置 mediaRecorder 时使用了以下代码来旋转它：

```
 if (this.getResources().getConfiguration().orientation !=Configuration.ORIENTATION_LANDSCAPE)
{
     mediaRecorder.setOrientationHint(270);
}
 else
{
     mediaRecorder.setOrientationHint(0);
}

mediaRecorder.setOutputFile(file_name);                  
mediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.DEFAULT);
mediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT); 
```

由于我在 surfaceCreated 方法中使用了以下代码，因此预览也处于正确的方向：

```
Camera.Parameters params = camera.getParameters();

if (this.getResources().getConfiguration().orientation
     !=Configuration.ORIENTATION_LANDSCAPE)
{   
  camera.setDisplayOrientation(90);

}
else
{   
  camera.setDisplayOrientation(0);                  
}

  params.setRotation(90);
  camera.setParameters(params); 
```

这样，录制的视频在设备上播放时方向正确。然而，视频上传到互联网后仍然是 90 度旋转。有人对此有建议吗？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-14T18:19:42.677

使用`mMediaRecorder.setOrientationHint(int)` 这绝对有效。您可能需要使用各种方向来获取纵向和横向所有相机的 int 值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-02T15:27:52.130

一些视频播放器在播放视频时会考虑方向提示。其他玩家没有。只需尝试在您的 PC 中使用 Windows Media Player、Quick Time 和 Real Player 播放此视频，然后查看差异。
问题可能不在于您的代码，而在于您用于查看视频的视频播放器。

# mysql - 请优化多连接查询

> ID：12098148
> 
> 赞同：1
> 
> 时间：2012-08-23T18:45:54.023
> 
> 标签：mysql, sql, query-optimization, average

我对 sql 进行了查询，但它真的很重，我真的不知道如何优化它，解释如下：

```
SELECT tyds.user_tyd, 
       tyds.product_tyd, 
       tyds.action_tyd, 
       products.price_product, 
       data_8, 
       data_9, 
       avg_8, 
       sum_9 
FROM   tyds 
       INNER JOIN products 
               ON tyds.product_tyd = products.id_product 
       INNER JOIN (SELECT product_tyd, 
                          Avg(data_tyd) AS avg_8 
                   FROM   tyds 
                   WHERE  action_tyd = 8 
                   GROUP  BY product_tyd) Agg_1 
               ON Agg_1.product_tyd = tyds.product_tyd 
       INNER JOIN (SELECT product_tyd, 
                          Sum(data_tyd) AS sum_9 
                   FROM   tyds 
                   WHERE  action_tyd = 9 
                   GROUP  BY product_tyd) Agg_2 
               ON Agg_2.product_tyd = tyds.product_tyd 
       INNER JOIN (SELECT product_tyd, 
                          data_tyd AS data_8 
                   FROM   tyds 
                   WHERE  user_tyd = 3 
                          AND action_tyd = 8) Agg_3 
               ON Agg_3.product_tyd = tyds.product_tyd 
       INNER JOIN (SELECT product_tyd, 
                          data_tyd AS data_9 
                   FROM   tyds 
                   WHERE  user_tyd = 3 
                          AND action_tyd = 9) Agg_4 
               ON Agg_4.product_tyd = tyds.product_tyd 
WHERE  tyds.user_tyd = 3 
       AND tyds.action_tyd = 1 
GROUP  BY tyds.product_tyd 
```

所有这些联合是因为我需要得到很多东西：我在 tyds.user_tyd = 3 tyds.action_tyd = 1 中定义了一个 id_user，因为我想按 tyds.product_tyd 分组，其中前一个 id_user 作为 tyds.action_tyd = 1。

然后我想要： -data_8 是 tyds.data_tyd 的值 WHERE user_tyd = 3 AND action_tyd = 8 -data_9 相同

- 对于 AVG 和 COUNT，我想跳过 tyds.user_tyd 条件，只按 id_product 分组。

实际上，这个查询正在工作，但我认为它真的很重并且选择太多......

一个月前我提出了一个类似的问题，但我不得不审查我的架构，所以我很抱歉......

非常感谢。

e1：我使用 MySQL

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:16:48.727

您实际上并不需要所有这些连接和子查询；[您可以通过使用表达式](http://dev.mysql.com/doc/refman/5.6/en/control-flow-functions.html#operator_case)`WHERE`将逻辑从-clauses移动到字段列表来消除其中的大部分：[`CASE`](http://dev.mysql.com/doc/refman/5.6/en/control-flow-functions.html#operator_case)

```
SELECT 3 AS user_tyd, tyds.product_tyd, 1 AS action_tyd,
       products.price_product,
       MAX(CASE WHEN user_tyd = 3 AND action_tyd = 8 THEN data_tyd END) data_8,
       MAX(CASE WHEN user_tyd = 3 AND action_tyd = 9 THEN data_tyd END) data_9,
       AVG(CASE WHEN action_tyd = 8 THEN data_tyd END) AS avg_8,
       SUM(CASE WHEN action_tyd = 9 THEN data_tyd END) AS sum_9
  FROM tyds
  JOIN products
    ON tyds.product_tyd = products.id_product
 WHERE tyds.product_tyd IN
         ( SELECT product_tyd
             FROM tyds
            WHERE tyds.user_tyd = 3
              AND tyds.action_tyd = 1
         )
 GROUP
    BY tyds.product_tyd
; 
```

（注意：`MAX(...)`第三行和第四行中的只是强制非空值优先于空值的一种方式。）

你必须测试看看这是否真的更快，但我敢打赌它是。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:17:22.317

简单示例，仅适用于第一个 Agg_%

```
create temporary table Agg_1
(
  product_tyd ...,
  avg_8 ...
)

insert into Agg_1
SELECT product_tyd, AVG(data_tyd) AS avg_8 FROM tyds WHERE action_tyd = 8 
GROUP BY product_ty

SELECT  tyds.user_tyd, tyds.product_tyd, tyds.action_tyd, products.price_product,
data_8, data_9, avg_8, sum_9 
FROM tyds 
INNER JOIN products 
ON tyds.product_tyd = products.id_product 
INNER JOIN Agg_1 ON Agg_1.product_tyd = tyds.product_tyd
... 
```

现在，我看到您正在使用 Mysql。我不确定它是否适用于 MySql，我不是 MySql 大师。但是，我确信它适用于 oracle 和 sybase。

# android - 在亚马逊应用商店中限制支持的屏幕尺寸

> ID：12098152
> 
> 赞同：2
> 
> 时间：2012-08-23T18:46:13.330
> 
> 标签：android, google-play, amazon-appstore

我即将发布一些适用于 Google Play 商店和 Amazon 应用商店的应用程序。这些应用程序中的一个应仅在应用商店中显示的屏幕尺寸被认为是`small`or `normal`，而另外两个应用程序应仅在应用商店中显示的屏幕尺寸被认为是`large`or `xlarge`。

我知道我可以`<compatible-screens>`将清单文件中的元素用于 Google Play 商店，但同样的技术是否适用于亚马逊应用商店？我浏览了整个亚马逊开发者网站，并阅读了[他们的常见问题解答](https://developer.amazon.com/help/faq.html)三遍，似乎找不到任何可以表明任何一种方式的东西。

如果该`<compatible-screens>`方法不适用于亚马逊应用商店，那么有什么方法对两者都适用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T22:36:45.103

收到亚马逊的回复，他们说

> 从应用程序清单的角度来看，当前表达式构建器使用给定 android 应用程序的部分和 sdk/os 版本来构建表达式。它不利用以下（较新的）部分提供有关应用程序兼容性的更有价值的输入。
> 
> <uses-feature> ：http: [//developer.android.com/guide/topics/manifest/uses-feature-element.html](http://developer.android.com/guide/topics/manifest/uses-feature-element.html)
> 
> <supports-screen>：http: [//developer.android.com/guide/topics/manifest/supports-screens-element.html](http://developer.android.com/guide/topics/manifest/supports-screens-element.html)
> 
> <兼容屏幕>：http: [//developer.android.com/guide/topics/manifest/compatible-screens-element.html](http://developer.android.com/guide/topics/manifest/compatible-screens-element.html)

# python - 如何根据用户的输入迭代循环？

> ID：12098155
> 
> 赞同：4
> 
> 时间：2012-08-23T18:46:15.037
> 
> 标签：python, user-interface, user-input

我是新来的，但经常来这里寻求帮助。无论如何，我正在尝试使用 tkSimpleDialog.askinteger() 来询问用户需要读入程序的文件数量。我想根据用户在 for 循环中输入的整数来读取文件。我会为文件名索引文件名 f[1] 到 f[n]。任何投入将不胜感激！

请在下面查看我想要了解的内容：

```
def callback2():
    NumDates = tkSimpleDialog.askinteger("NDates", "How many dates are there?")
    for dates in NumDates:
        filename[dates] = tkFileDialog.askopenfilename() 
        dates = dates + 1
        filenameDates.append(filename) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T18:48:05.363

假设`NumDates`是一个整数，您正在寻找 range 函数：

```
for dates in range(NumDates):
    ... 
```

在 python 2.x 中，您可以`xrange`改用。这不会创建一个中间列表，所以很多人都喜欢它。在 python 3 中，`xrange`已重命名`range`并删除了以前返回列表的范围函数——当列表很小时，我通常只是`range`为了兼容性而使用，但也有工具 ( `2to3`) 可以为您处理这些细节，所以不管怎样，这真的没什么大不了的。

*在旁边*

此外，正如所写，确实不需要`dates = dates + 1`（必要时最好写`dates += 1`）。

# php - 我可以从 php 调用 nodejs 应用程序吗？

> ID：12098160
> 
> 赞同：1
> 
> 时间：2012-08-23T18:46:49.140
> 
> 标签：php, node.js

我正在尝试做...

```
<?php $content = `echo 'h1 happy days' | jade`; ?> 
```

但它不返回任何东西。其他命令（例如`ls`）

我尝试将翡翠添加到路径中，创建一个`/bin`可以从命令行工作的链接，但不能在 php.ini 中工作。

我究竟做错了什么？

编辑：

从命令行：

```
bash-3.2$ pwd
/Users/billy/test/website-clear
bash-3.2$ echo 'h1 happy days' | jade
<h1>happy days</h1>bash-3.2$ which jade
/bin/jade
bash-3.2$ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:22:29.603

您还有两个可能非常适合您的选项： 1\. proc_open 如果您想要更多程度的控制：

```
 $handle = proc_open("jade", array( array("pipe", "r"), array("pipe", "w"), array("pipe", "w")), $pipes);
    fwrite($pipes[0], 'h1 happy days');
    fclose($pipes[0]);
    $result = stream_get_contents($pipes[1]);
    return $result; 
```

2.使用执行：

```
 exec("echo 'h1 happy days' | jade", $output, $retval);
    return $output; 
```

确保路径中有翡翠或使用翡翠可执行文件的完整路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:36:51.447

使用[系统](http://php.net/manual/en/function.system.php)功能。我相信您的外部调用由操作系统创建它自己的上下文，然后获得它自己的 stdin/stdout/stderr。改为这样做：

```
<?php $content = system("echo 'h1 happy days' | jade", $retval); ?> 
```

# algorithm - 当无法访问所有位置时，如何确定通过二维数组的路径中的最大和？

> ID：12098161
> 
> 赞同：3
> 
> 时间：2012-08-23T18:46:51.017
> 
> 标签：algorithm, 2d, dynamic-programming

我被卡住的问题是，一个人需要从包含整数的二维数组的左上角到右下角的位置，获得最大可能的分数，无论是向下还是向右移动。但是，如果位置 A[i][j] 小于 0，则此人不能移动经过它，并且每次该人访问该位置的邻域时，都会从分数中减去等于该负值的数量. 我知道这是一个标准的 DP 问题，我可以制作一个数组 T[][]，其中 T[i][j] 表示从 0,0 到位置 i,j 的最大分数。但是，我无法提出任何适当的实现条件，即人不应该越过标有负整数的单元格。例如，如果行=2；列=3；和

```
A= | 0  -4   8 |
   | 1   1   0 | 
```

那么我希望答案是 -6，即矩阵 T 应该是

```
 T=| 0  -4   X |
   | -3 -6  -6 | 
```

1.  鉴于在开始和结束位置，该人没有被“抢走”他的分数。
2.  X 表示该人无法到达相应的位置。在上述情况下，人不能越过 A[0][1] 去 A[0][2]
3.  T[row-1][column-1] 是问题的答案，即人从 A[0][0] 到 A[row-1][column-1] 可以获得的最高分

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:44:56.487

我遵循与[dwrd](https://stackoverflow.com/users/1074709/dvvrd)的答案中建议的相同思路，因此我尝试在 Python 中实现它。有一些事情需要考虑，我最初没有想到，但我想我终于让它工作了。

这是代码，它肯定需要一些修饰，但这是一个开始：

```
def get_score(M, i, j):
    "Get the final score for position [i, j.]"
    score = 0

    if M[i][j] < 0:
        score = -float('inf')
    else:
        score = M[i][j]
        score = score + penalty(M, i - 1, j - 1)
        score = score + penalty(M, i - 1, j + 1)
        score = score + penalty(M, i + 1, j - 1)
        score = score + penalty(M, i + 1, j + 1)
        score = score + penalty(M, i - 1, j)
        score = score + penalty(M, i, j - 1)
        score = score + penalty(M, i + 1, j)
        score = score + penalty(M, i, j + 1)

    return  score

def penalty(M, i, j):
    "Calculate the penalty for position [i, j] if any."
    if i >= 0 and i < len(M) and j >= 0 and j < len(M[0]):
        return (0 if M[i][j] > 0 else M[i][j])

    return 0

def calc_scores(M):
    "Calculate the scores matrix T."
    w = len(M[0])
    h = len(M)
    T = [[0 for _ in range(w)] for _ in range(h)]

    for i in range(h):
        for j in range(w):
            T[i][j] = get_score(M, i, j)

    T[0][0] = 0
    T[h - 1][w - 1] = 0

    return T

def calc_max_score(A, T):
    "Calculate max score."
    w = len(A[0])
    h = len(A)
    S = [[0 for _ in range(w + 1)] for _ in range(h + 1)]

    for i in range(1, h + 1):
        for j in range(1, w + 1):
            S[i][j] = max(S[i - 1][j], S[i][j - 1]) + T[i - 1][j - 1]

            # These are for the cases where the road-block
            # is in the frontier
            if A[i - 1][j - 2] < 0 and i == 1:
                S[i][j] = -float('inf')

            if A[i - 2][j - 1] < 0 and j == 1:
                S[i][j] = -float('inf')
    return S

def print_matrix(M):
    for r in M:
        print r

A = [[0, -4, 8], [1, 1, 0]]
T = calc_scores(A)
S = calc_max_score(A, T)

print '----------'
print_matrix(T)
print '----------'
print_matrix(S)
print '----------'

A = [[0, 1, 1], [4, -4, 8], [1, 1, 0]]
T = calc_scores(A)
S = calc_max_score(A, T)

print '----------'
print_matrix(T)
print '----------'
print_matrix(S)
print '----------' 
```

您会得到以下输出：

```
----------
[0, -inf, 4]
[-3, -3, 0]
----------
[0, 0, 0, 0]
[0, 0, -inf, -inf]
[0, -3, -6, -6]
----------

----------
[0, -3, -3]
[0, -inf, 4]
[-3, -3, 0]
----------
[0, 0, 0, 0]
[0, 0, -3, -3]
[0, 0, -inf, 1]
[0, -3, -6, 1]
---------- 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:30:31.743

这个想法是模拟无法移动到负无穷大结果的负单元格，该负无穷大结果永远不会被选为最大值。伪代码：

```
int negativePart(int i, int j)
{
    if (i < 0 || j < 0)
        return 0;
    return A[i, j] < 0 ? A[i, j] : 0;
}

int neighborInfluence(int i, int j)
{
    if (int == Height -1 && j == Width - 1)
        return 0;
    return negativePart(i-1, j-1) + negativePart(i-1,j)+// so on, do not think about negative indexes because it was already processed in negativePart method
}

int scoreOf(int i, int j)
{
    return A[i,j] < 0 ? <NegativeInfinity> : A[i,j] + neighborInfluence(i,j);
}

//.......

T[0,0] = A[0,0];
for (int i = 1; i < heigth; ++i)
{
    T[i, j] = T[i - 1, 0] + scoreOf(i, 0);
}

for (int i = 1; i < width; ++i)
{
    T[0, i] = T[0, i - 1] + scoreOf(0, i);
}

for (int i = 1; i < heigth; ++i)
{
    for (int j = 1; j < width; ++j)
    {
        T[i, j] = max(T[i - 1, j], T[i, j - 1]) + scoreOf(i, j);
    }
} 
```

# reporting - Business Objects Infoview - 导出到 Excel 无法正确自动调整单元格高度

> ID：12098163
> 
> 赞同：0
> 
> 时间：2012-08-23T18:47:06.933
> 
> 标签：reporting, business-objects, infoview

我在 Business Objects InfoView/Webi 报告中使用了来自 Remedy 的大量数据。报告导出到 Excel 以分发给部门管理人员。

我已经在 InfoView 中设置了所有格式，因此在将报告发送给当权者之前，无需在 Excel 中进行任何操作。我将所有表格单元格设置为自动调整大小，除了一列，因为它可以获得多长时间（Remedy 中的注释字段，它是一种 blob 数据类型）。但是，我确实将其设置为自动高度。

导出到 Excel 时，自动调整大小不太正确 - 它将单元格截断了大约两行文本。我能做些什么来使它在导出中表现出来？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T02:42:39.567

我在业务对象（我假设您的意思是版本 XI）中发现所有 excel 格式的分布式报告在转换过程中都会丢失它们的格式。我遇到了同样的问题，两个字段的大小和一个平均计算字段在 excel 更改后不会保持它的数字格式。它再次变得普遍。我也对此进行了研究，发现了这个问题的链接： [http ://www.google.com/url?q=http://www.csdw.status.dhhs.state.nc.us/BOXIUserGuides/user.pdf&sa= U&ei=1xl-UKTuCMbg2QXd1IHABw&ved=0CC0QFjAJ&usg=AFQjCNHVTN7vKzYNUMDID0mqCvOenfhkJw](http://www.google.com/url?q=http://www.csdw.status.dhhs.state.nc.us/BOXIUserGuides/user.pdf&sa=U&ei=1xl-UKTuCMbg2QXd1IHABw&ved=0CC0QFjAJ&usg=AFQjCNHVTN7vKzYNUMDID0mqCvOenfhkJw)

那是给向导的。

这段话是这样的： Excel 和 Excel（仅数据）之间的区别在于 Excel 尝试*保留*原始报告的外观，而 Excel（仅数据）仅保存数据，每个单元格代表一个字段。

我在其他一些网站上发现，虽然它试图保留它，但部分或全部格式可能会丢失。

# c# - Crystal Reports中出现“页眉加页脚对于页面来说太大”错误是什么原因造成的？

> ID：12098164
> 
> 赞同：11
> 
> 时间：2012-08-23T18:47:13.340
> 
> 标签：c#, .net, windows

我已将以下代码用于打印按钮：

```
Data.str = null;
//Data.str = textBox24.Text.ToString();
string s = "select * from temp_bond";
cn.ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + Application.StartupPath + "\\Real.mdb";
cn.Open();

DataSet ds = new DataSet();

OleDbDataAdapter da = new OleDbDataAdapter(s, cn);
ds.Clear();
da.Fill(ds);
Bond rpt = new Bond();
rpt.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, "BOND_" + Data.str + ".pdf");
System.Diagnostics.Process.Start("BOND_" + Data.str + ".pdf");
//r.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, "E:\\rep.pdf");
//crystalReportViewer1.ReportSource = r;
OleDbCommand cm1 = new OleDbCommand("delete * from temp_bond", cn);
cm1.ExecuteNonQuery();
cn.Close(); 
```

我在这段代码中遇到错误：

```
rpt.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, "BOND_" + Data.str + ".pdf"); 
```

错误是：

> 页眉和页脚对于页面来说太大了。文件 C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\temp_3f674868-8e5d-46ce-80eb-dce78bb2ba89 {17674136-B71E-4C6F-9E36-1CEB514B13BF}.rpt 中的错误：页眉或页脚长于页。

什么可能导致这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-02T14:41:23.733

我有一个已发布多年的应用程序，它使用 Crystal Reports 作为嵌入式文档生成工具。我的应用程序中包含的报告已经工作了多年，当我接到一位收到此确切错误消息的用户的支持电话时，我被难住了一段时间。

经过一番摸索和研究，我发现罪魁祸首是最终用户计算机上的默认打印机。 ***如果默认打印机当前配置为在比您生成的报表更小的不同尺寸的纸张上打印，Crystal Reports 将给您此错误消息。*** 此外，如果打印机设置为以不同于 CR 报告方向的方向打印，您将收到此消息。

这个错误的真正奇怪/设计不佳的问题是您将收到它，即使您向运行时声明只是创建一个 PDF。我假设 CR 正在使用一些默认打印机设置来初始化运行时。

你有几个选项来解决这个问题。首先，您可以将默认打印机更改为另一台设备。如果您的默认打印机具有不同的非典型外形（例如标签打印机），您可能必须这样做。如果标签比您的文档小，Crystal Reports 将不喜欢标签打印机。

选项二当然是重新配置您的打印机驱动程序以指定足够大以适合您的文档的纸张类型。此外，如前所述，请确保纸张打印首选项也设置为按照 Crystal Report 文档预期的正确方向（横向或纵向）打印。

最后，您可以将默认打印机更改为另一台打印机或从您的 PC 中删除该打印机。这不是最有利的答案，但它可能是让信息消失的最后必要步骤。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-23T21:41:33.920

我最近遇到了类似的问题，但我无法通过更改默认打印机或更改它们的设置来解决它。

我设法通过手动通过代码设置报告的参数来解决问题。

这是一个向您展示的示例。

```
dim crep As New CrystalDecisions.CrystalReports.Engine.ReportDocument
crep.PrintOptions.PaperOrientation = PaperOrientation.Portrait
crep.PrintOptions.PaperSize = PaperSize.PaperA4 
```

Saludos 一个待办事项！=)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-17T16:09:39.063

我遇到了同样的问题，我将默认打印机更改为 Microsoft XPS Writer。这更正了我的水晶报告显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-27T11:55:09.130

尝试通过右键单击报表设计-> 页面设置来更改水晶报表的页面大小...根据需要尝试使用 A4、横向和其他。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-13T11:40:59.333

经过长时间的搜索和尝试，我发现当水晶查看器加载页面设置时，四个边距（上、下、左、右）会自动更改。所以总是把它们写在你的代码中。它会解决你的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-23T18:53:37.487

在设计 -> 页面设置 -> 边距中关闭“自动调整”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-11T00:45:56.577

打印到部署在 Windows Server 2019 中的点阵打印机时，我遇到了类似的错误。

用户在尝试从使用 Crystal Reports 的 Terralink 数据库打印到 Epson FX-890 时会收到此错误。

错误：567 文件页眉或页脚长度超过一页的错误。

在阅读了上面的建议后，我通过在高级文档设置下返回用户的打印机设置并确保在这种情况下默认为 8.5x11 字母页面，成功摆脱了错误。

感谢您的帮助。

-拉吉

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-09T17:17:59.733

在 Windows Server 上由网络配置的 Zebra 标签打印机作为打印服务器时，我也遇到了这个问题。我不想尝试更改客户端默认打印机的设置，因为我不能确定哪个客户端会打印。相反，我在打印服务器（Windows Server 2008）的驱动程序设置（打印机默认设置）中修复了它。所以在打印服务器上：

1.  转到“设备和打印机”并选择受影响的打印机。
2.  右键单击并选择“打印机属性”。
3.  转到“常规”选项卡，然后单击底部的“更改属性”按钮。
4.  转到“高级”选项卡，然后单击“打印默认值...”按钮。
5.  转到“页面设置”选项卡并定义所需的设置（大小、方向）。
6.  根据需要多次单击“确定”保存并退出。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-09T06:31:28.873

我刚刚在我的 MS Dynamics 环境中运行多年没有问题的 Crystal Report 出现此错误。经过一番挠头和谷歌搜索后，我的一个用户说“哦，我猜你想让我删除订单上的所有注释”。

我的 Crystal 报表模板在报表的标题中有一个“注释”框。在设计中，它适合有 1 行笔记，表格适合 A4 页面。

[报价单]

用户在该框中输入了超过 40 行注释......因此它将其推到了页面边界之外。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-02T07:43:13.797

检查标题或其他对象。

设置属性：

```
can grow = False 
```

# c - 如何从用户空间 C 读取内核模块 (/dev) 文件

> ID：12098167
> 
> 赞同：0
> 
> 时间：2012-08-23T18:47:26.090
> 
> 标签：c, file-io, linux-kernel

在我的内核模块中，读取功能如下：

```
ssize_t aes_read(struct file *filp, char *buf, size_t count, loff_t *f_pos) { 

  unsigned long aes_reg[4];
  aes_reg[0] = leon_load_reg(output_mem_loc);
  aes_reg[1] = leon_load_reg(output_mem_loc+4);
  aes_reg[2] = leon_load_reg(output_mem_loc+8);
  aes_reg[3] = leon_load_reg(output_mem_loc+12);
  copy_to_user(buf, (char *)aes_reg, 16);
  .... 
```

它出现在`buf`正确设置的内核模块中。在用户空间方面，我写了这个：

```
int main(int argc, char* argv[]){
    FILE *fpaes;
    char *str;
    int buf[4];

    fpaes = fopen("/dev/aes", "r");
    fread(str, 16, 1, fpaes);
    p_long = (unsigned long *)str;
    .... 
```

但是`str`没有用我期望的值进行更新。我可以这样做`fread`吗？或者我可以离开吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T18:49:02.807

`str`未在您的程序中初始化。访问`*str`是未定义的行为。

# ios - uiscrollview 中的低分辨率图像直到屏幕上或后退一/加一

> ID：12098173
> 
> 赞同：1
> 
> 时间：2012-08-23T18:47:50.933
> 
> 标签：ios, uiscrollview

我有一个`uiscrollview`我发送一组低分辨率图像。当滚动视图滚动时，它应该检查当前页面，`+/-1`并用另一个数组中的高分辨率图像替换低分辨率图像。我的代码几乎完美地做到了这一点。

```
- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView {
pageCOntrolBeingUsed = NO;

//calculate the current page that is shown

CGFloat pageWidth = self.uis_valueScrollview.frame.size.width;
    int page = floor((self.uis_valueScrollview.contentOffset.x - pageWidth / 2) / pageWidth) + 1;
    self.uis_valuePageControl.currentPage = page;
    NSLog(@"page %i",page);

    // display the image and +/-1 for smoother scrolling

        CGRect frame;
        frame.origin.x = self.uis_valueScrollview.frame.size.width * page;
        frame.origin.y = 0;
        frame.size = self.uis_valueScrollview.frame.size;

        UIImageView *subview = [[UIImageView alloc] initWithFrame:frame];
        [subview setContentMode:UIViewContentModeScaleAspectFit];
        subview.image = [ebappdelegate.arr_highRezImages objectAtIndex:page];
        subview.tag = page+1;
        [self.uis_valueScrollview addSubview:subview];

     //remove image views except -1 and +1 of the current page

    for ( int i = 0; i < [ebappdelegate.arr_ValueImages count]; i++ ) {
          if ( (i < (page-1) || i > (page+1)) && [uis_valueScrollview viewWithTag:(i+1)] ) {
            [[uis_valueScrollview viewWithTag:(i+1)] removeFromSuperview];
              [[uis_valueScrollview viewWithTag:(i-1)] removeFromSuperview];
             [(UIImageView*)[uis_valueScrollview viewWithTag:page] setImage:[ebappdelegate.arr_lowrezImages objectAtIndex:page]];
            subview.tag = page+1;
            [self.uis_valueScrollview addSubview:subview];
            NSLog(@"remove");
        }
    }

} 
```

所以现在一个函数（不是这里）预先加载了lowrez图像数组。滚动后，我允许它访问 highrez 数组。一旦图像滚动关闭，`(+/-1)`我想用低分辨率替换更高的图像。

它会这样做，但有时会创建额外的图像视图（我记录`uiimageview` `iskindofclass`并且数字会上下移动，大于数组的计数，所以我知道正在创建额外的而不是删除。

任何指针？我认为这是一个很好的方法并且非常接近 - 但也会接受任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T05:05:52.270

代码没有错。你已经完美地完成了这些事情。您发现的计数增加是由于指示图像。

每个`UIScrollView`类都包含水平和垂直滚动指示器和阴影。这些成员是 type `UIImageView`。因此，当您记录`UIImageView`课程时，它也会计算这三个子视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T17:08:17.627

我认为这就是你正在寻找的[http://developer.apple.com/library/ios/#samplecode/ScrollViewSuite/Listings/3_Tiling_Classes_TiledScrollView_m.html](http://developer.apple.com/library/ios/#samplecode/ScrollViewSuite/Listings/3_Tiling_Classes_TiledScrollView_m.html)

这是一个来自苹果的演示应用程序，它完全可以满足您的需求......

# php - Protobuf-PHP：无法成功执行 protoc-gen-php

> ID：12098176
> 
> 赞同：8
> 
> 时间：2012-08-23T18:48:09.127
> 
> 标签：php, protocol-buffers

我克隆了我在[https://github.com/drslump/Protobuf-PHP找到的 Protobuf-PHP 存储库：](https://github.com/drslump/Protobuf-PHP) [https](https://github.com/drslump/Protobuf-PHP.git) ://github.com/drslump/Protobuf-PHP.git，我一直在安装和配置大约 12 小时的问题试图让 protoc-gen-php 将 proto 文件转换为 PHP 类。

我正在运行 PHP 版本 5.3.2，这就是我所做的：

1.  安装 PEAR v1.9.4
2.  安装 Console_CommandLine，并运行 PEAR_ENV.reg 来设置 PEAR 环境变量。
3.  我已经尝试了我能想到的所有排列来尝试让这个插件生成一个 PHP 类文件，但每一次尝试都失败了。

我在根文件夹中有一个与 C# 项目一起使用的 proto 文件，我在其中签出了 proto-gen-php 项目（见下文）。

```
 message AuditLogEntry {
        required int64 ID = 1;
        required int64 Date = 2;
        required string Message = 3;

        optional int32 User_ID = 4;
        optional string User_Username = 5;
        optional int32 ImpUser_ID = 6;
        optional string ImpUser_Username = 7;

        optional string RemoteIP = 8;
    }

    message AuditLogQuery {
        optional int64 DateRangeStart = 1;
        optional int64 DateRangeEnd = 2;
        optional string Search = 3;
        optional int32 UserID = 4;

        optional int32 Limit = 5;
        optional int32 Offset = 6;
    }

    message AuditLogResult {
        repeated AuditLogEntry LogEntries = 1;
        optional int32 TotalResults = 2;
    } 
```

这里只是我遇到的几个问题：

1.  当我尝试执行最基本的实现时：

    ```
    protoc-gen-php.bat AuditLog.proto 
    ```

    我收到此错误：

    > 无法打开输入文件：@bin_dir@\protoc-gen-php 文件名、目录名或卷标语法不正确。

    我在网上找不到有关此错误的任何信息。安装我正在使用的软件包之一是否存在配置问题？有任何想法吗？

2.  由于上面的错误，我在 protoc-gen-php 批处理文件中更改了这一行：

    ```
    "%PHPBIN%" -d display_errors=stderr -d log_errors=On -d error_log=Off "@bin_dir@\protoc-gen-php" %* 
    ```

    至

    ```
    "%PHPBIN%" -d display_errors=stderr -d log_errors=On -d error_log=Off "protoc-gen-php.php" %* 
    ```

现在，当我运行问题 1 中给出的相同命令时，我得到以下输出：

```
The filename, directory name, or volume label syntax is incorrect.
Protobuf-PHP @package_version@ by Ivan -DrSlump- Montes

C:\Development\SkedFlex\php-proto-buffers\AuditLog.proto: File does not reside within any path specified using --proto_path (or -I).  You must specify a --proto_path which encompasses this file.  Note that the proto_path must be an exact prefix of the .proto file names -- protoc is too dumb to figure out when two paths (e.g. absolute and relative) are equivalent (it's harder than you think).

ERROR: protoc exited with an error (1) when executed with:
  protoc \
    --plugin=protoc-gen-php="C:\Development\SkedFlex\php-proto-buffers\protoc-gen-php.php.bat" \
    --proto_path="C:\Development\SkedFlex\php-proto-buffers\library\DrSlump\Protobuf\Compiler\protos" \
    --php_out=":./" \
    "C:\Development\SkedFlex\php-proto-buffers\AuditLog.proto" 
```

我使用手册中指定的 -i, -o 尝试了命令的许多变体：http: [//drslump.github.com/Protobuf-PHP/protoc-gen-php.1.html](http://drslump.github.com/Protobuf-PHP/protoc-gen-php.1.html)，但似乎无法取得进展这个...

最后我尝试直接执行 protoc ：

```
protoc --plugin=protoc-gen-php --php_out=./build AuditLog.proto 
```

这是错误：

```
--php_out: protoc-gen-php: The system cannot find the file specified. 
```

我正处于被困的地步。有没有人有 protoc-gen-php 经验可以帮助我解决我遇到的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T09:02:03.763

.bat 文件从存储库中检出后不能直接使用，它在创建 Pear 包时被修改。因此，除非您想以某种方式修改库的源代码，否则您应该使用 Pear 安装 Protobuf-PHP。

```
pear channel-discover pear.pollinimini.net
pear install drslump/Protobuf-beta 
```

如果您不想从 Pear 安装，则必须手动修改`protoc-gen-php.bat`文件，将最后一行替换为类似以下内容：

```
C:\path\to\php.exe -d display_errors=stderr -d log_errors=On -d error_log=Off c:\path\to\protobuf-php\protoc-gen-php %* 
```

为了修复“文件不在指定的任何路径内...”错误，您必须确保作为参数给出的任何原始文件都驻留在定义*的包含路径*内。Google 的`protoc`编译器不会尝试猜测包含路径是什么，因此我们需要在所有情况下手动提供它们。

```
protoc-gen-php.bat -i . AuditLog.proto 
```

这应该允许您为您的 proto 消息生成 PHP 文件，尽管该脚本在 Windows 系统中的测试不如在 Linux 和 OSX 系统中的测试。如果您发现任何问题，如果您愿意，可以直接在[项目站点](https://github.com/drslump/Protobuf-PHP)上报告。

# php - 通过 AJAX 调用提示用户保存文件

> ID：12098178
> 
> 赞同：7
> 
> 时间：2012-08-23T18:48:12.543
> 
> 标签：php, javascript, ajax, csv, dhtmlx

我正在将我的 DHTMLX 网格导出到 csv 并成功地创建了 .CSV 文件。我遇到的问题是它没有提示用户保存/打开文件。我正在使用来自 javascript 的 $.post 调用将 CSV 字符串发送到 PHP，然后将该字符串写入 csv。由于某种原因，它没有为用户创建提示，但它成功地写入文件并保存在服务器上。下面是相关代码：

JS：

```
myGrid.csvParser = myGrid.csvExtParser;
myGrid.setCSVDelimiter('|');
myGrid.csv.row = "endOfRow";           
var gridCsvData = myGrid.serializeToCSV();

    $.post(
        "data/export.php", 
        { 
           csvdata: gridCsvData
        }
    ); 
```

PHP（导出.php）：

```
$csvData = $_REQUEST['csvdata'];

$csv = explode('endOfRow',$csvData);

$myfile = "grid.csv";

$fh = fopen($myfile, 'w') or die("can't open file");

foreach($csv as $line) {
    fputcsv($fh, explode('|',$line),',','"');
}

fclose($fh);

//Redirect output to a client's web browser (csv)
header("Content-type: application/csv");
header("Content-Disposition: attachment; filename=grid.csv");
header("Pragma: no-cache");
header("Expires: 0"); 
```

这段代码完美地工作在它完全按照我想要的方式导出网格并将其保存到“grid.csv”的意义上。问题是它没有提示用户保存文件。这是我的 PHP 标头的问题，还是我需要在 $.post 中添加一些内容以提示成功？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T18:55:47.603

您不能提示用户从 AJAX 调用下载文件。您可以做的一件事是，制作一个 iFrame，在其中放入一个表单，然后发布它。这样，它看起来就像一个 AJAX 调用，但会提示用户下载文件。

```
// Create iFrame
var iframe = document.createElement('iframe');
iframe.style.display = "none";
document.body.appendChild(iframe);

// Get the iframe's document
var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;

// Make a form
var form = document.createElement('form');
form.action = 'data/export.php'; // Your URL
form.method = 'POST';

// Add form element, to post your value
var input = document.createElement('input');
input.type = 'hidden';
input.name = 'csvdata';
input.value = gridCsvData;  // Your POST data

// Add input to form
form.appendChild(input);

// Add form to iFrame
// IE doesn't have the "body" property
(iframeDoc.body || iframeDoc).appendChild(form);

// Post the form :-)
form.submit(); 
```

PS您的PHP代码实际上并没有将CSV回显到屏幕上，它只是将其保存到一个文件中。

在标头调用之后，请确保您有：

```
readfile($myfile); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:50:21.870

在 HTML5 中执行此操作的正确方法是使用 File API。有关详细信息，请参阅： http: [//hackworthy.blogspot.com/2012/05/savedownload-data-generated-in.html](http://hackworthy.blogspot.com/2012/05/savedownload-data-generated-in.html)。

如果 HTML5 不是一个选项，那么采用这种方法。

执行 POST 后，使用以下命令生成文件的 GET 请求：

```
document.location = "file.csv"; 
```

根据浏览器的不同，文件将被保存 (Chrome)，或者将提示用户选择要另存为的文件名。当然，POST 处理程序必须将文件保存在某处。

```
$.ajax({
    type: "POST",
    url: "post.php",
    success: function() {
        console.log("Worked!");
        document.location = "test.csv";
    },
    error: function() {
        console.log("Failed!");
    }
}); 
```

# java - Java中的数据存储

> ID：12098183
> 
> 赞同：3
> 
> 时间：2012-08-23T18:48:53.857
> 
> 标签：java, database

我正在用 Java 做一个小小的编程练习，让我回到上学前的状态。我的程序将与视频游戏（军团要塞 2）相关，因此我需要存储有关大量武器的数据。

我当前的模型是我为每种武器设置了一个类（例如 Scout_Primary 或 Soldier_Secondary），我将根据选择的特定武器修改每个类中的变量。例如，如果 Scout_Primary 是“Scattergun”，我将相应地修改其基础伤害并重新加载速度。

如果你熟悉 TF2，你就会知道有大量的武器。如何在我的程序中存储所有武器的统计数据？我不希望为一个类别中的每个武器编写包含统计数据的巨大 switch 语句。我非常渴望更多地使用 SQL（我有一些经验但不是太多，我以前使用过 JDBC）。

是否可以创建一个数据库并将其与程序本身打包，这样我就不必担心托管？我唯一的经验是使用远程数据库。

我想做的是拥有该本地数据库并执行选择并将数据传递给构造函数。提前致谢。

编辑：我一直在看德比，这是正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:00:54.827

是的，SQL 可能适用于此。您应该研究一下[Apache Derby](http://db.apache.org/derby/)，它的主要优点是它是轻量级的并且很容易嵌入到 Java 应用程序中。你可以做你所说的——在本地使用它。

唯一的问题是将实际数据与您的应用程序捆绑在一起。我建议你从一个简单的文件开始，可能是 JSON 或 XML 编码，甚至只是 CSV - 基本上是你选择的任何东西。然后当程序启动时，您检查数据库是否存在。如果没有，则创建它，读取文件，并将文件中的数据存储到数据库中。然后，您就可以使用 SELECT 语句或您想要的任何其他语句进行查询了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:58:21.630

为什么每种武器都需要不同的等级？我想创建一个类武器会是更好的选择，或者更确切地说是一个可以被各种其他类别的武器扩展的抽象类。如何将武器存储在`collection`（列表，地图，根据您要执行的操作类型设置）中。如果您的目标是存储游戏统计数据并将游戏作为基于 Web 的应用程序启动，建议使用数据库

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T18:59:11.937

无论您选择什么，您很可能都必须使用某种数据库来保存您的武器。SQLite 是最小且最容易实现的一种，尽管它需要一些 SQL 背景知识。

您还可以将所有武器存储在 JSON 或 XML 格式的纯文本文件中……我会选择 JSON，因为它会减少您的输入，但 XML 也很容易做到（而且我很确定有XML 解析器已经可用）。然而，JSON 更容易实现，即使您仍然需要从 json.org 下载源代码。

```
{
"weapons": [
    { "name":"Scattergun" , "damage":"5" },
    { "name":"Flamethrower" , "damage":"8" , "pyro":"yes" }
]
} 
```

如您所见，我对TF2一无所知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T19:02:23.250

我建议使用数据库，特别是因为您提到有 JDBC 经验。

如果您不想担心在您的服务器上安装数据库引擎，例如 MySQL 或 Postgres，您可以使用[H2 数据库引擎](http://www.h2database.com/html/main.html)，它可以与您的 Java 应用程序一起分发。

H2 是用 Java 编写的，并且有一个 JDBC API。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T19:02:59.980

我认为一个简单的类武器可以做到这一点：

```
class Weapon {
  private WeaponType weaponType;
  private ClassType classType;
  private int damage;
  ...
}

enum WeaponType {
  PRIMARY, SECONDARY, ..
}

enum ClassType {
  SCOUT, SOLDIER, ...
} 
```

您还可以使用[Jackson](http://jackson.codehaus.org/)等库将其映射到/从 json 映射。如果您必须不时手动更新值，则 Json 与数据库相比要简单得多。

# ios - Phonegap/Cordova inAppPurchaseManager 无效的产品 ID

> ID：12098207
> 
> 赞同：0
> 
> 时间：2012-08-23T18:50:27.177
> 
> 标签：ios, cordova, in-app-purchase, phonegap-plugins

我正在将 Phonegap/Cordova 插件用于 In App Purchases：InAppPurchaseManager 和 Cordova 1.7，我似乎正在进入商店，但它没有找到产品。我已经使用正确的配置文件设置了应用程序，并且据我所知，我已经在 iTunes Connect 中正确地向该应用程序添加了产品。我已经搜索了高和低的错误消息，但在互联网上没有太多关于它的信息。我将其缩小到的最合理的解决方案是等待产品传播到所有服务器（虽然这似乎有点愚蠢）。

以前有没有人遇到过这个问题，您的解决方案是什么？

这是我在控制台中遇到的错误

*   得到了iap产品响应
*   com.lus.testapp.product.1 的测试应用程序 2.0[21619:707] 发送失败 ( **window.plugins.inAppPurchaseManager.callbackMap.f0.fail** ) js
*   测试应用程序 2.0 [21619:707] 完成 iap

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T13:53:35.360

这只是时间问题，第二天再次运行它并没有问题地工作。所有错误都消失了，我收到了正确的数据。

这很愚蠢，但是通过所有服务器传播数据需要花费很多时间。

如果您在进行应用内购买，请在创建应用时尽早设置它们，以便在您准备好将产品集成到应用中时，您可以使用数据。

# mysql - 索引和查询存储在 Mysql 中的 BLOBS

> ID：12098209
> 
> 赞同：0
> 
> 时间：2012-08-23T18:50:29.407
> 
> 标签：mysql, solr, indexing, blob

问候朋友，

开门见山。我在 Mysql DB 中存储了许多 BLOBS。这些主要是PDF（80%）和.doc。我在数据库中也有文本。到目前为止，我已经建立了索引并且可以查询文本，但我无法索引 BLOBS。我正在尝试制作一个集合（文档）-但很烂。有没有关于如何做这件事的秘诀？

**data-config.xml 的一部分：**

```
<?xml version="1.0" encoding="utf-8"?>

<dataConfig>

<dataSource type="JdbcDataSource"
  autoCommit="true" batchSize="-1"
  convertType="false"
  driver="com.mysql.jdbc.Driver"
  url="jdbc:mysql://127.0.0.1:3306/ktimatologio"
  user="root"
  password="********"
  name="db"/>

<dataSource name="fieldReader" type="FieldStreamDataSource" />  

  <document> 

    <entity name="aitiologikes_ektheseis"
    dataSource="db"
    transformer="HTMLStripTransformer"
    query="select id, title, title AS grid_title, model, type, url, last_modified, CONCAT_WS('_',id,model) AS solr_id, search_tag, CONCAT( body,' ',title)  AS content from aitiologikes_ektheseis where type = 'text'"
    deltaImportQuery="select id, title, title AS grid_title, model, type, url, last_modified, CONCAT_WS('_',id,model) AS solr_id, search_tag, CONCAT( body,' ',title)  AS content from aitiologikes_ektheseis where type = 'text' and id='${dataimporter.delta.id}'"
    deltaQuery="select id, title, title AS grid_title, model, type, url, last_modified, CONCAT_WS('_',id,model) AS solr_id, search_tag, CONCAT( body,' ',title)  AS content from aitiologikes_ektheseis where type = 'text' and last_modified &gt; '${dataimporter.last_index_time}'">
      <field column="id" name="ida" />               
      <field column="solr_id" name="solr_id" />
      <field column="title" name="title" stripHTML="true" />
      <field column="grid_title" name="grid_title" stripHTML="true" />
      <field column="model" name="model" stripHTML="true" />
      <field column="type" name="type" stripHTML="true" />
      <field column="url" name="url" stripHTML="true" />
      <field column="last_modified" name="last_modified" stripHTML="true"  />
      <field column="search_tag" name="search_tag" stripHTML="true" />
      <field column="content" name="content" stripHTML="true" />
    </entity>

    <entity name="aitiologikes_ektheseis_bin"
    query="select id, title, title AS grid_title, model, type, url, last_modified, CONCAT_WS('_',id,model) AS solr_id, search_tag, bin_con AS text from aitiologikes_ektheseis where type = 'bin'"
    deltaImportQuery="select id, title, title AS grid_title, model, type, url, last_modified, CONCAT_WS('_',id,model) AS solr_id, search_tag, bin_con AS text from aitiologikes_ektheseis where type = 'bin' and id='${dataimporter.delta.id}'"
    deltaQuery="select id, title, title AS grid_title, model, type, url, last_modified, CONCAT_WS('_',id,model) AS solr_id, search_tag, bin_con AS text from aitiologikes_ektheseis where type = 'bin' and last_modified &gt; '${dataimporter.last_index_time}'"
    transformer="TemplateTransformer"
    dataSource="db">         
      <field column="id" name="ida" />               
      <field column="solr_id" name="solr_id" />
      <field column="title" name="title" stripHTML="true" />
      <field column="grid_title" name="grid_title" stripHTML="true" />
      <field column="model" name="model" stripHTML="true" />
      <field column="type" name="type" stripHTML="true" />
      <field column="url" name="url" stripHTML="true" />
      <field column="last_modified" name="last_modified" stripHTML="true"  />
      <field column="search_tag" name="search_tag" stripHTML="true" />

      <entity dataSource="fieldReader" processor="TikaEntityProcessor" dataField="aitiologikes_ektheseis_bin.text" format="text"> 
          <field column="text" name="contentbin" stripHTML="true" />
      </entity>

    </entity>

       ...
       ...
  </document> 

</dataConfig> 
```

**schema.xml 的一部分（fieldTypes 和字段定义）：**

```
<fieldType name="text_ktimatologio" class="solr.TextField" positionIncrementGap="100">

<analyzer type="index">               
  <tokenizer class="solr.StandardTokenizerFactory"/>
  <filter class="solr.StopFilterFactory" ignoreCase="true" words="lang/stopwords_en.txt" enablePositionIncrements="true"/>
  <filter class="solr.LowerCaseFilterFactory"/>
  <filter class="solr.EnglishPossessiveFilterFactory"/>               
  <filter class="solr.StopFilterFactory" ignoreCase="true" words="lang/stopwords_el.txt" enablePositionIncrements="true"/>
  <filter class="solr.GreekLowerCaseFilterFactory"/>
  <filter class="solr.GreekStemFilterFactory"/>       
  <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
  <filter class="solr.PorterStemFilterFactory"/>
</analyzer> 

<analyzer type="query">
  <tokenizer class="solr.StandardTokenizerFactory"/>
  <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
  <filter class="solr.StopFilterFactory" ignoreCase="true" words="lang/stopwords_en.txt" enablePositionIncrements="true"/>               
  <filter class="solr.StopFilterFactory" ignoreCase="true" words="lang/stopwords_el.txt" enablePositionIncrements="true"/>               
  <filter class="solr.GreekLowerCaseFilterFactory"/>
  <filter class="solr.GreekStemFilterFactory"/>
  <filter class="solr.LowerCaseFilterFactory"/>
  <filter class="solr.EnglishPossessiveFilterFactory"/>
  <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
  <filter class="solr.PorterStemFilterFactory"/>
</analyzer>
</fieldType>

<fieldType name="text" class="solr.TextField" positionIncrementGap="100">
<analyzer type="index">
  <charFilter class="solr.HTMLStripCharFilterFactory"/>
  <tokenizer class="solr.StandardTokenizerFactory"/>
  <filter class="solr.StandardFilterFactory"/>   
  <filter class="solr.LowerCaseFilterFactory"/>                               
  <filter class="solr.StopFilterFactory" ignoreCase="true" words="lang/stopwords_el.txt" enablePositionIncrements="true"/>               
  <filter class="solr.GreekLowerCaseFilterFactory"/>
  <filter class="solr.GreekStemFilterFactory"/>
  <filter class="solr.HunspellStemFilterFactory" dictionary="dictionaries/el_GR.dic" affix="dictionaries/el_GR.aff" ignoreCase="true" />
</analyzer>

<analyzer type="query">
  <charFilter class="solr.HTMLStripCharFilterFactory"/>
  <tokenizer class="solr.StandardTokenizerFactory"/>
  <filter class="solr.StandardFilterFactory"/>
  <filter class="solr.LowerCaseFilterFactory"/>   
  <filter class="solr.LowerCaseFilterFactory"/>                               
  <filter class="solr.StopFilterFactory" ignoreCase="true" words="lang/stopwords_el.txt" enablePositionIncrements="true"/>               
  <filter class="solr.GreekLowerCaseFilterFactory"/>
  <filter class="solr.GreekStemFilterFactory"/>
  <filter class="solr.HunspellStemFilterFactory" dictionary="dictionaries/el_GR.dic" affix="dictionaries/el_GR.aff" ignoreCase="true" />
</analyzer>
</fieldType>

<fields>
  <field  name="ida" type="string" indexed="true" stored="true" multiValued="false"/>
  <field  name="solr_id" type="string" indexed="true" stored="true" multiValued="false"/> 
  <field  name="title" type="text_ktimatologio" indexed="true" stored="true"/>
  <field  name="grid_title" type="text_ktimatologio" indexed="true" stored="true"/>
  <field  name="model" type="string" indexed="true" stored="true" multiValued="false"/>
  <field  name="type" type="string" indexed="true" stored="true"/>
  <field  name="url" type="string" indexed="true" stored="true"/>
  <field  name="last_modified" type="string" indexed="true" stored="true"/>
  <field  name="search_tag" type="string" indexed="true" stored="true"/>
  <field  name="contentbin" type="text" indexed="true" stored="true" multiValued="true"/>
  <field  name="content" type="text_ktimatologio" indexed="true" stored="true" multiValued="true"/>     
</fields> 
```

我真的需要帮助！

尊重地，

汤姆

希腊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:36:07.757

你想“索引”一个 BLOB 吗？意味着您希望最终能够搜索它？我不确定我是否正确理解了您的问题。

我猜您可能想先[在 Solr 中使用 Apache Tika 之](https://wiki.apache.org/solr/ExtractingRequestHandler)类的东西转换您的 PDF 或 .doc ，然后让 Solr 为您编制索引。此外，如果您想让您的用户访问 PDF 或 doc，最好的地方是数据库并从那里检索它？

# javascript - 从 Rails 视图填充 HighChart 数据

> ID：12098220
> 
> 赞同：0
> 
> 时间：2012-08-23T18:51:46.303
> 
> 标签：javascript, ruby-on-rails, ruby, highcharts

我尝试了一些不同的东西，这是我能够得到的最接近的：

```
 <script type="text/javascript" charset="utf-8">
$(function () {
  new Highcharts.Chart({
    chart: { renderTo: 'orders_chart' },
    title: { text: 'Orders by Day' },
    xAxis: { type: 'datetime' },
    yAxis: {
      title: { text: 'Dollars' }
    },
    tooltip: {
      formatter: function () {
        return Highcharts.dateFormat("%B %e %Y", this.x) + ': ' +
          '$' + Highcharts.numberFormat(this.y, 2);
      }
    },    
    series: [{
      pointInterval: <%= 1.day * 1000 %>,
      pointStart: <%= 0.days.ago.at_midnight.to_i * 1000 %>,
      data: <%= @daily_count[0] %>
    }]
  });
});
</script> 
```

问题具体是：`data: <%= @daily_count[0] %>`这目前给了我一个数据点。我试过了，`<%= @daily_count %>`但这不起作用。我需要的是一种放置数组的方法，特别是`[daily_count[0], daily_count[1]...]`放入数据中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:02:45.427

尝试使用`to_json`

```
data: <%= @daily_count.to_json %> 
```

# matlab - 将 3D 矩阵绘制为 3D 条形图时出错

> ID：12098223
> 
> 赞同：0
> 
> 时间：2012-08-23T18:51:50.250
> 
> 标签：matlab, multidimensional-array, 3d, matrix

嗨，我有一个 3D 矩阵`daily_renewables_excess`，我正在尝试为轴中的 xy 和 z 维度绘制一个 3D 条形图。大小（daily_renewables_excess）是 11,7,10。所以我试图得到一个 3D 条形图，其中有 11 个 x 间隔 x、7 个 y 和 10 个 z。

但是，当我尝试

```
figure;
bar3(daily_renewables_excess(:,:,:)) 
```

我收到一条错误消息，提示“使用 bar3 时出错（第 39 行）输入必须是二维的。”

根据我对文档的理解，bar3 函数将绘制一个如上所示的 3D 条形图。我需要以某种方式重新排列矩阵吗？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:55:54.323

由于您有一个 3D 矩阵（体积），因此您不能同时显示 3 个间隔（3 轴）+ 条形的比例值（第 4 个变量）。这相当于绘制 4D 图（例如，使用颜色对第 4 维进行颜色编码，使用条形大小对其进行尺寸编码，甚至垂直堆叠）。

例如，以下体积`D`是大小的`[11x10x7]`，您可以`bar3`通过在第 3 (z) 维中进行索引来获得 7 个图

```
% random 3D input
D = randi(10, [11, 10, 7]);
[m,n,l] = size(D);
% plot bar for first z-
figure; bar3(D(:,:,1)); 
```

![在此处输入图像描述](../Images/40ac042cd99e17480f75b124d7490f7b.png)

相反，您可以做的是在一个或多个维度中重塑`x-`形状`y-`，排序（为了保持有序间隔的概念（在`x-`或`y-`分别）并用 bar3 绘制结果矩阵。

```
% reshape to x
Dx = reshape(D, m*l, n);
Dx = sort(Dx, 1, 'descend'); 
figure; bar3(Dx) 
```

![在此处输入图像描述](../Images/a89032fde0418be1c98ddda809f87131.png)

```
% reshape to y
Dy = reshape(D, m, n*l);
Dy = sort(Dy, 2, 'descend'); 
figure; bar3(Dy) 
```

![在此处输入图像描述](../Images/7cb0ff12046137ec0c368a7122901059.png)

# algorithm - 给定“随机播放”上的歌曲列表，一次随机随机播放所有歌曲还是每次选择一首随机歌曲更有效？

> ID：12098227
> 
> 赞同：0
> 
> 时间：2012-08-23T18:52:14.120
> 
> 标签：algorithm

时间复杂度是多少

(1) 随机打乱一个长度为 N 的列表？

(2) 从 N 个项目中随机选择一个项目 N 次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T18:57:33.620

取决于您的洗牌算法和预期的行为。例如，iTunes shuffle 会在您随机播放时创建一个备用播放列表顺序，从而立即随机播放所有歌曲，但也会创建一个可重复的播放列表顺序（如果您听了两次播放列表，相同的歌曲将相互跟随），但如果您想要您可以在每首歌曲之前选择一个新种子，并在您开始播放时通过选择真正随机播放曲目。然而，时间复杂度对于两者来说基本上是相同的，在任何一种情况下都可以忽略不计。

然而，理论上，它们都是 O(nr) 时间复杂度（其中 r 是随机数算法的时间复杂度）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:30:42.500

洗牌一个列表是 O(n)

从大小为 n 的列表中随机选择 n 个东西也是 O(n)

您可能最好在每次播放时随机选择一些东西，因为歌曲列表不一定会永远保持不变。在这种情况下，必须重做预计算。

# cuda - __syncthreads 在 CUDA 中不起作用

> ID：12098231
> 
> 赞同：2
> 
> 时间：2012-08-23T18:52:25.587
> 
> 标签：cuda

我编写了简单的内核来测试 CUDA 的功能`__syncthreads`。在内核中，如果更新的值对其他线程不可见，我已经设法从每个线程进行打印。理想情况下，没有线程应该打印`Not visible to me`错误消息，但某些线程最终会打印此消息。这里是内核。

```
__device__ int a=0;  
__global__ void kernel()  
{  

    isItOK=false;  
    if(threadIdx.x==0 && blockIdx.x==0)  
    {  
        atomicAdd(&a,1);  
        __threadfence();  
    }  
    __syncthreads();  
    if(atomicAdd(&a,0)==0)  
    {  
        cuPrintf("Not Visible to me\n");  
    }  

}  
int main()  
{  
    int *a;  
    cudaPrintfInit();  
    kernel<<<16,16>>>();  
    cudaPrintfDisplay(stdout,true);  
    cudaPrintfEnd();  
} 
```

请帮助我完成这个非常简单的测试程序，但仍然无法正常工作。我们需要设置一些编译器标志吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T02:34:52.377

`__syncthreads()`是一个同步屏障原语，仅同步同一块中的线程。

CUDA 没有跨线程块安全同步的机制。

不建议在线程块之间进行通信和同步，因为它破坏了具有不同数量多处理器的 GPU 之间的执行可扩展性，这也是首先使用线程块的原因。

# xml - 从动作返回 xml 数据 - CakePHP

> ID：12098232
> 
> 赞同：0
> 
> 时间：2012-08-23T18:52:26.880
> 
> 标签：xml, file, cakephp, get

我正在尝试返回从 xml 文件中检索到的一些数据，然后将其返回到视图页面。

xml 文件将在用户启动的某个操作期间更新，然后我会弹出一个对话框并显示 xml 文件的内容。xml 文件将在此操作期间更新。

在我看来，我想显示从读取 xml 文件的 php 操作返回的数据。

这是我获取更新的 xml 文件的操作。这将每秒调用一次以更新视图。

```
public function getUpdate()
    {
        $myFile = '/srv/www/xml-status/update_status.xml';
        $file = fopen($myFile, 'r');
        $data = file_get_contents($myFile);
        //debug($data);
        //print_r($data);

        //echo json_encode($data);
        //echo $data;
        return json_encode($data);
    } 
```

xml 文件的内容被检索并存储到`$data`变量中，但我不断收到 500 内部服务器错误。我尝试了很多不同的东西，但我不知道如何正确返回数据。

这是我显示信息的视图代码。

```
<script>
window.onload = timedRefresh(1000);

// Get the updated xml file every second
function timedRefresh(timeoutPeriod)
{
    // Do a get request to get the updated contents of the xml file
    $.get('/tools/getUpdate', function(data)
    {
        alert(data);
    });

    window.setTimeout('timeRefreshed(1000)', 1000);
}
</script>

<?php
if(false != $xml = simplexml_load_file($xmlFile))
{
    foreach ($xml->LogEvent->sequence as $temp)
    {
        echo 'Step: ', $temp['step'], ' ', 'Step Name: ', $temp['stepName'], ' ', 'd1: ', $temp['d1'], ' ',
        'd2: ', $temp['d2'], ' ', 'd3: ', $temp['d3'], ' ', 'Status: ', $temp['status'],'<br>';
    }
}
else
{
    echo '<br>Error: Update status can\'t be displayed<br>';
}
?> 
```

我无法弄清楚我做错了什么。如果我可以将数据变量返回到 get 请求，我可以解析并显示信息，但是我无法将数据从 php 获取到 javascript get 请求。任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T06:46:52.997

我认为你的行为会是这样的：

```
public function getUpdate()
{
    $myFile = '/srv/www/xml-status/update_status.xml';
    $file = fopen($myFile, 'r');
    $data = file_get_contents($myFile);
    //debug($data);
    //print_r($data);

    echo json_encode($data);
    exit;
} 
```

或者

```
 public function getUpdate()
{
    $this->autoRender = false;
    $myFile = '/srv/www/xml-status/update_status.xml';
    $file = fopen($myFile, 'r');
    $data = file_get_contents($myFile);
    //debug($data);
    //print_r($data);

    echo json_encode($data);

} 
```

# iphone - 访问 Plist 数组/节点 - Objective C

> ID：12098237
> 
> 赞同：1
> 
> 时间：2012-08-23T18:52:33.817
> 
> 标签：iphone, arrays, string, plist

我有一个用于存储问题和答案数据的属性列表文件。在这个文件中，我有一组数组，在这些数组中我存储了不同的类别和问题。但是我似乎无法访问这些数据？

属性文件；

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN"  "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>Category1</key>
<array>
    <array>
        <string>Question1</string>
        <string>Answer1</string>
    </array>
    <array>
        <string>Question2</string>
        <string>Answer2</string>
    </array>
    <array>
        <string>Question3</string>
        <string>Answer3</string>
    </array>
    <array>
        <string>Question4</string>
        <string>Answer4</string>
    </array>
</array>
</dict>
</plist> 
```

下面我使用两个简单的按钮来访问属性列表文件；

```
-(IBAction)nextleft {
    [self bingsound];
    if (questionCounter > 1) {
        questionCounter -= 1;
    }
    [self nextQuestion];
}

-(IBAction)nextright {
    [self bingsound];
     if (questionCounter < 20) {
         questionCounter += 1;
     }
     [self nextQuestion];
}

-(void)nextQuestion {
    NSArray *pair;
    pair = [categories objectAtIndex:questionCounter];
    plistQuestion = [pair objectAtIndex:0];
    plistAnswer = [pair objectAtIndex:1];
    abbreviation.text = plistQuestion;
} 
```

我正在填充类别数组，如下所示；

```
categories = [NSArray arrayWithContentsOfFile:@"questions.plist"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:13:26.660

您应该提供`arrayWithContentsOfFile:`plist 文件的完整路径。以下应该有效：

```
NSString* filePath = [[NSBundle mainBundle] pathForResource:@"questions" ofType:@"plist"];
categories = [NSArray arrayWithContentsOfFile:filePath]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T05:48:09.573

您的属性列表有一个字典作为根对象，而不是一个数组。

从顶部删除这些行：

```
<dict>
<key>Category1</key> 
```

最后一行：

```
</dict> 
```

此外，请遵循@murat 的建议并导出正确的文件路径而不是纯字符串。

一般来说，像这样的问题，调试器是你的朋友。在您的方法中放置一个断点，并在每个阶段（导出路径、提取数组）检查您得到的值。

# iphone - iPhone本地文件路径

> ID：12098238
> 
> 赞同：0
> 
> 时间：2012-08-23T18:52:37.717
> 
> 标签：iphone, objective-c, dropbox

我在我的应用程序中集成了 Dropbox。我已经完成了向用户显示文件的程度，他们可以选择要下载的文件。我知道我需要调用此行，但我不知道 iPhone 上的本地文件路径是什么。它只需要是临时的，因为一旦我有了文本文件，我就会处理它......我的问题是本地文件路径是什么。先感谢您。

```
[[self restClient] loadFile:[filePaths objectAtIndex:indexPath.row] intoPath:localPath] 
```

根据下面的答案更新:::Still NOT WORK

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
    NSString *localPath = [[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0] stringByAppendingString:[filePaths objectAtIndex:indexPath.row]];
    [[self restClient] loadFile:[filePaths objectAtIndex:indexPath.row] intoPath:localPath];
    NSLog(@"%@",[NSString stringWithContentsOfFile:localPath encoding:NSUTF8StringEncoding error:nil]);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T08:14:35.007

由于历史原因，早在 Objective-C 之前，Unix 中就存在对临时目录的需求。因此，在我们的语言中获取临时目录的方法是在使用 confstr 的现有 Unix 方法之上精心设计的。为了您的方便，它也在 NSPathUtilities 中。

```
NSString *tmpDirectory = NSTemporaryDirectory();
NSString *tmpFile = [tmpDirectory stringByAppendingPathComponent:@"temp.txt"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:47:30.847

您可能正在寻找：

```
NSString * tempPath = [NSSearchPathForDirectoriesInDomains(NSTemporaryDirectory(), NSUserDomainMask, YES) objectAtIndex:0];
NSString * yourFile = [filePaths objectAtIndex:indexPath.row];

if(yourFile != nil) {
    NSString * filePath = [tempPath stringByAppendingPathComponent:yourFile];
}
else {
    // Check your file
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:05:56.977

您通常只使用本地文档目录。

尝试这个：

`NSString *localPath = [[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0] stringByAppendingString:[filePaths objectAtIndex:indexPath.row]];`

# msbuild - 在 ccnet 生成标签之前运行 msbuild 任务

> ID：12098241
> 
> 赞同：0
> 
> 时间：2012-08-23T18:52:40.207
> 
> 标签：msbuild, continuous-integration, build-process, cruisecontrol.net

ccnet 操作的确切顺序（取自[此处](http://confluence.public.thoughtworks.org/display/CCNET/FAQ)）：

```
 1) Wait for the triggers to awaken.
   2) Ask the source control system for a list of the modifications since the last build.
   3) If any modifications were found or if the triggers said "force the build":
           3.1) Generate a label for the build.
           3.2) Run the prebuild tasks in the order specified, failing the build in case of error.
           3.3) Get the source code from the source control system.
           3.4) Run the build tasks in the order specified, failing the build in case of error.
           3.5) If the repository should be labeled:
                   3.5.1) Let the source control system apply the label.
           3.6) Run the publisher tasks.
   4) Go to 1. 
```

有没有办法在 ccnet 中执行步骤 3.1 之前运行一些 msbuild 任务。

**问题陈述**：

我正在使用“fileLabeller”在 ccnet 标签中显示文件的内容。如果文件存在，这很好用。但是假设文件不存在，那么我想调用一个 msbuild 任务来创建这个文件并设置一些虚拟文本。

我在预构建事件中调用了这个 msbuild 任务，但令我沮丧的是，这并没有成功，因为标签生成发生在预构建之前。

有没有办法在标签生成之前调用这个 msbuild 任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T06:56:25.360

Cruisecontrol.net 会将所有输出记录到具有特定标签的文件中。这意味着必须在其他任何事情发生之前确定标签。如果您需要运行 Msbuild 来构建标签，您可能需要编写自己的标签器。

# dependency-injection - 通过远程接口将单例 bean 注入会话 bean，对象始终为“null”

> ID：12098242
> 
> 赞同：1
> 
> 时间：2012-08-23T18:52:40.530
> 
> 标签：dependency-injection, ejb, jboss7.x

我需要将一个单例 bean 注入会话 bean。下面是对应的类。问题是注入的对象始终为空。我尝试了我的 JBoss 7.0.1 服务器在启动期间显示给我的**所有**JNDI 查找字符串（即*部署单元子部署中名为 GlobalBean 的会话 bean 的 JNDI 绑定..部署..如下：* ..）。我还尝试在 GlobalBean.java 中注释掉 @EJB 注释，并尝试在注入期间使用“ejb/GlobalBean”。然而，没有运气。可能是什么原因？谢谢。

**GlobalBean.java：**

```
@Startup
@Singleton
@Remote(GlobalBeanRemote.class)
@EJB(name="ejb/GlobalBean", beanName="GlobalBean", beanInterface=GlobalBeanRemote.class)  
@ConcurrencyManagement(ConcurrencyManagementType.CONTAINER)
public class GlobalBean implements GlobalBeanRemote
{
   // CODE
} 
```

**会话Bean.java：**

```
@Stateful
public class SessionBean extends ParentBean
{
      @EJB(name="java:module/GlobalBean!project.framework.interfaces.GlobalBeanRemote")
      private GlobalBeanRemote globalBeanAPI3;

      // CODE
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T23:31:21.500

在您的 SessionBean 类中，尝试将 @EJB 的名称属性更改为 mappedName。

```
@EJB(mappedName="java:module/GlobalBean!project.framework.interfaces.GlobalBeanRemote") 
```

当然，这仅在您的两个 bean 在同一个模块中时才有效。

**更新** 鉴于您的 bean 位于单独的模块中，请尝试使用 java:app 命名空间：

```
@EJB(mappedName="java:app ...") 
```

java:app 命名空间用于查找打包在同一应用程序中的本地企业 bean。也就是说，企业 bean 被打包在一个包含多个 Java EE 模块的 EAR 文件中。使用 java:app 命名空间的 JNDI 地址具有以下形式：

java:app[/模块名称]/企业bean名称[/接口名称]

还可以尝试删除 GlobalBean 的 @EJB 注释。@EJB 用于定义依赖项。

# actionscript-3 - Flash 开发调试编译器不做 File browseForOpen() 方法

> ID：12098244
> 
> 赞同：0
> 
> 时间：2012-08-23T18:52:58.200
> 
> 标签：actionscript-3, flash, air, adobe, flashdevelop

这个简单的代码在 Flash 开发中编译，但没有任何反应：

```
var f:File = new File();
f.browseForOpen("fsd"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T14:05:24.047

我可能与安全沙箱有关。

尝试将 browseForOpen 放在某个按钮的 MouseEvent.CLICK 处理程序中：

```
btn.addEventListener( MouseEvent.CLICK, browseOpen )

function browseOpen( e:MouseEvent ):void
{
    f.browseForOpen("fsd");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T08:08:52.443

该代码在 FlashDevelop 中对我来说很好用。您确定您的项目是 AIR 应用程序吗？File.browseForOpen 仅在 AIR 中可用：http: [//help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/filesystem/File.html#browseForOpen%28%29](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/filesystem/File.html#browseForOpen%28%29)

或者，正如他们的代码示例所建议的那样，您可以将其包装在 try 块中并查看是否出现错误：

```
 try 
        {
            fileToOpen.browseForOpen("Open", [txtFilter]);
            fileToOpen.addEventListener(Event.SELECT, fileSelected);
        }
        catch (error:Error)
        {
            trace("Failed:", error.message);
        } 
```

# c# - 如何跟踪异步/等待任务是否正在运行

> ID：12098245
> 
> 赞同：13
> 
> 时间：2012-08-23T18:52:59.083
> 
> 标签：c#, .net

我正在尝试从基于事件的异步模式转换，在该模式中我使用唯一 ID 和异步操作管理器跟踪运行方法。
由于这已从 Windows 8 应用程序中删除，因此我试图通过 Async/Await 获得类似的效果，但无法完全弄清楚如何。
我想要达到的目标是

```
private async Task updateSomething()
{
    if(***the method is already running***)
    {
        runagain = true;
    }
    else
    {
        await someMethod();
        if (runagain)
        {
            run the method again
        }            
    }
} 
```

我正在努力的部分是找出该方法是否正在运行。我尝试创建一个 Task 并查看它的状态和 async 方法的 .status ，但它们似乎不是正确的查看位置。谢谢

更新：这是我在 .net 4 中用于实现相同结果的当前代码。_updateMetaDataAsync 是一个基于基于事件的异步模式的类。

```
private void updateMetaData()
    {
        if (_updateMetaDataAsync.IsTaskRunning(_updateMetaDataGuid_CheckAllFiles))
        {
            _updateMetaDataGuid_CheckAllFiles_Again = true;
        }
        else
        {
            _updateMetaDataGuid_CheckAllFiles_Again = false;
            _updateMetaDataAsync.UpdateMetaDataAsync(_updateMetaDataGuid_CheckAllFiles);
        }
    }

private void updateMetaDataCompleted(object sender, UpdateMetaDataCompletedEventArgs e)
    {
        if (_updateMetaDataGuid_CheckAllFiles_Again)
        {
            updateMetaData();
        }
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T20:27:42.373

`async`/`await`本身旨在用于创建从 UI 线程异步执行的顺序操作。您可以让它执行并行操作，但通常这些操作会以某种结果“加入”回 UI 线程。（也有可能使用“即发即弃”类型的异步操作，`await`但不建议这样做）。即没有什么固有的`async`/`await`支持进度报告。

您*可以*`async`使用/获取代码的进度`await`；但是您需要使用新的进度界面，例如`IProgress<T>`. 有关使用`async`/进行进度报告的更多信息`await`，请参阅[http://blogs.msdn.com/b/dotnet/archive/2012/06/06/async-in-4-5-enabling-progress-and-cancellation-in-异步 apis.aspx](http://blogs.msdn.com/b/dotnet/archive/2012/06/06/async-in-4-5-enabling-progress-and-cancellation-in-async-apis.aspx)。迁移到这里应该只是调用`IProgress`委托而不是`Progress`事件的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T18:56:33.840

如果您使用的是`Task`您创建的，您可以检查任务的[状态](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.status.aspx)属性（或者如果完成是您感兴趣的唯一状态，则只查看[Task.IsCompleted ）。](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.iscompleted.aspx)

话虽如此，`await`在操作完成、引发异常或取消之前不会“返回”。您基本上可以放心地假设，如果您仍在等待“等待”，则您的任务尚未完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-17T04:39:47.260

```
SemaphoreSlim queueToAccessQueue = new SemaphoreSlim(1);
object queueLock = new object();
long queuedRequests = 0;
Task _loadingTask;
public void RetrieveItems() {
  lock (queueLock) {
      queuedRequests++;
      if (queuedRequests == 1) { // 1 is the minimum size of the queue before another instance is queued
        _loadingTask = _loadingTask?.ContinueWith(async () => {
          RunTheMethodAgain();
          await queueToAccessQueue.WaitAsync();
          queuedRequests = 0; // indicates that the queue has been cleared;
          queueToAccessQueue.Release()
        }) ?? Task.Run(async () => {
          RunTheMethodAgain();
          await queueToAccessQueue.WaitAsync();
          queuedRequests = 0; // indicates that the queue has been cleared;
          queueToAccessQueue.Release();
        });
      }
  }
}
public void RunTheMethodAgain() {
  ** run the method again **
} 
```

额外的好处是您可以看到队列中有多少项目！

# silverlight - 手动设置 Xaml 属性时在 RichTextBox 中显示花括号

> ID：12098250
> 
> 赞同：1
> 
> 时间：2012-08-23T18:53:31.933
> 
> 标签：silverlight, windows-phone-7, xaml, richtextbox

我目前正在为 Windows Phone 开发一个 Twitter 应用程序，其中 - 通过自定义`DependencyProperty`-`Xaml`每个属性都[`RichTextBox`](http://msdn.microsoft.com/en-us/library/system.windows.controls.richtextbox%28v=vs.95%29.aspx)绑定到推文的文本（包括以编程方式生成`Run`的所有文本元素）。在有花括号`{`和`}`文本之前，这已经足够好了。我尝试将它们替换为`&#123;`并转义，`{}`但无济于事。

奇怪的是，如果大括号出现在文本中间（更具体地说，在元素的`Text`属性中`Run`）一切都很好，只有当左大括号在开头**或*右大括号在`RichTextBox`崩溃的结局* 。我可以通过`&#8203;`在每个`Run`.

但是，如果在开头* 有一个左大括号，在结尾有一个右大括号*，这个问题就会变得更加*复杂*。在这种情况下，零宽度空格似乎不再起作用，因此唯一的解决方法是在文本的开头或结尾插入额外的“真实”字符，这显然是我做不到的。

正如两年前在[这个答案](https://stackoverflow.com/questions/2999782/silverlight-4-richtextbox-cant-restore-xaml-with-text-containing-curly-braces/2999864#2999864)`RichTextBox`中所承认的那样，这似乎确实是一个错误。显然，它还没有被修复。那么，有人知道我可以尝试的任何进一步的解决方法吗？

* 前面也可以只跟空格或后面只跟空格

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T13:12:55.443

好的，经过更多的修补，我找到了一个简单的解决方法。只需在每个. [_](http://en.wikipedia.org/wiki/Zero-width_non-joiner) _`&#8204;``&zwnj;``Run`

*显然，这个字符的处理方式与我之前使用的零宽度空间不同，如果你的文本在开头和*结尾都有花括号，它甚至可以工作。当然，还有更多具有相同效果的不可见字符（请查看[Wikipedia 上的此列表](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references)），但我认为零宽度非连接符应该具有最少的副作用。

# c# - 使用 Skype API 电话呼叫示例

> ID：12098252
> 
> 赞同：2
> 
> 时间：2012-08-23T18:53:41.187
> 
> 标签：c#, .net, asp.net-mvc-3, skype, skype4com

是否有一个很好的教程或示例可以通过 API 使用 C#/ASP.NET MVC3 发起 Skype 电话呼叫？我在网上进行了一些搜索，但找不到特定于通过 API 发起呼叫的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:03:03.263

你遇到过这个吗：http: [//www.codeproject.com/Articles/330778/Skypekit-NET](http://www.codeproject.com/Articles/330778/Skypekit-NET)

# php - 如何为单个文件上传脚本设置不同于 .ini 的 max_file_size

> ID：12098253
> 
> 赞同：1
> 
> 时间：2012-08-23T18:53:41.937
> 
> 标签：php, file-upload, upload

假设我已`max_file_size`设置为 20mb，但我只想在特定文件上将其限制为 4mb，我将如何实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T10:22:07.650

尝试这个。

```
$default_max_file_size = ini_get('upload_max_filesize');

if ($is_special_file) {
   ini_set('upload_max_filesize', '4M');

   // process your file

   // set it back to original value
   ini_set('upload_max_filesize', $default_max_file_size);
} 
```

# c# - MVC3 中的异步进度更新

> ID：12098258
> 
> 赞同：2
> 
> 时间：2012-08-23T18:53:59.883
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, asynchronous

我在 ASP.NET MVC3 中工作，我有一个长期运行的任务，我有一个用户启动，但我希望用户收到正在发生的事情的反馈，以防发生意外情况。

我知道 MVC3 支持异步控制器，但它似乎并不能与生成的线程很好地通信，所以通过它发送更新似乎很混乱。我想知道是否有提供此类反馈的标准技术或方法，或者我是否需要自己开发一些东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T23:48:26.187

这篇文章不是准确地描述了你所追求的吗？

[ASP.NET MVC 3：用于长时间运行任务的异步 jQuery 进度指示器](http://blog.janjonas.net/2012-01-02/asp_net-mvc_3-async-jquery-progress-indicator-long-running-tasks)

希望它会帮助你。

# jquery - 键入时在输入字段内动态添加 div

> ID：12098261
> 
> 赞同：1
> 
> 时间：2012-08-23T18:54:24.197
> 
> 标签：jquery, input, zendesk

我正在尝试模拟 Zendesk 在其子域的注册表单中所做的事情。当用户开始输入子域时，它会自动将“.zendesk.com”以不同的颜色添加到用户输入的内容中。

看起来它是另一个定位的 div，但我不知道他们是如何在用户键入输入后完美定位它的。

我正在使用 jQuery 1.7。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T19:48:33.860

一种简单的方法是在同一位置输入一个与用户正在输入的实际输入相匹配的输入，然后将字符串添加到更改值的末尾。

所以你有了

```
<input class="mirrorInput" disabled="disabled"></input>
<input class="realInput"></input>​ 
```

和

```
.realInput{
    position: absolute;
    left: 0;
    background: none;
}

.mirrorInput{
    position: absolute;
    left: 0;
    color: green;
    background: white;
} 
```

JS很简单

```
$(".realInput").on("keyup", function(event){
    $(".mirrorInput").val($(".realInput").val() + ".zendesk.com");
}) 
```

[这是一个小提琴，展示了它是如何工作的。](http://jsfiddle.net/digthedoug/x83vD/)

# android - 在android中创建渐变边框？

> ID：12098262
> 
> 赞同：5
> 
> 时间：2012-08-23T18:54:32.233
> 
> 标签：android, border

如何创建如下图所示的渐变边框？

![边界](../Images/dab46707d7963dab795547055439f447.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T20:20:19.353

您可以通过使用图层列表并弄乱填充来实现此目的。你需要3个元素：

1：一个border.xml形状，它只是一个边框颜色的实心形状：border.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="#ff0000"/>
</shape> 
```

2：“内部”形状，您希望边框出现的形状：inner.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="#00ff00"/>
</shape> 
```

3：图层列表，将这两个放在彼此的顶部。您可以通过在内部形状上设置填充来创建边框：layerlist.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
<item android:drawable="@drawable/border"/>
<item android:drawable="@drawable/inner" 
```

在此处指定您想要描边的位置（上、左、右、下）

```
android:top="3dp" android:right="0dp" android:bottom="3dp"
android:left="3dp" /> 
```

将其设置为 TextView、Layout 等的背景（您希望中风出现的位置）

或者只是创建一个带有边框的[9Patch](http://developer.android.com/tools/help/draw9patch.html)图像。

# c# - 使用 listview 插入时保留先前的值

> ID：12098266
> 
> 赞同：0
> 
> 时间：2012-08-23T18:54:42.310
> 
> 标签：c#, asp.net, listview

目前我有一个网格视图，当我单击选择时，它会在列表视图中填充值。我使用 selectedindexchanged 事件在代码后面处理这个问题。我什至在 insertitem 模板中为新条目填充了一个文本框。

```
protected void GridView9_SelectedIndexChanged(object sender, EventArgs e)
{
// this handles the transmittal costs
SqlDataSource29.SelectParameters.Clear();
SqlDataSource29.SelectParameters.Add("tc_t_id", App_id);        
SqlDataSource29.InsertParameters.Clear();
ListView1.Visible = true;
ListView1.DataBind();
((TextBox)ListView1.InsertItem.FindControl("tc_t_idTextBox")).Text = App_id; 
```

但是，当我进行插入时会出现问题。我失去了放入 listviews insertitem texbox tc_t_idTextBox 的价值。实际上，当我编辑和删除时，我也会失去价值。

必须有一种方法可以在插入之间保持该值。

```
<InsertItemTemplate>
    <tr style="">
        <td>
            <asp:Button ID="InsertButton" runat="server" CommandName="Insert" 
                Text="Insert" />
            <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" 
                Text="Clear" />
        </td>
        <td>
            <asp:TextBox ID="tc_dateTextBox" runat="server" Text='<%# Bind("tc_date") %>' />
        </td>
        <td>
            <asp:TextBox ID="tc_costTextBox" runat="server" Text='<%# Bind("tc_cost") %>' />
        </td>
        <td>
            <asp:TextBox ID="tc_typeTextBox" runat="server" Text='<%# Bind("tc_type") %>' />
        </td>
        <td>
            <asp:TextBox ID="tc_commentTextBox" runat="server" Text='<%# Bind("tc_comment") %>' />
        </td>
        <td>
            &nbsp;</td>
        <td>
            <asp:TextBox ID="tc_t_idTextBox" runat="server" 
                Text='<%# Bind("tc_t_id") %>' Enabled="false" Width="15"  />
        </td>
    </tr>
</InsertItemTemplate> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:21:34.640

通过`DataBind()`在每个 PostBack 上使用，每次用户执行和操作时都会重新加载 ListView。在`Page_Load`您的页面中，改为执行以下操作：

```
SqlDataSource29.SelectParameters.Clear();
SqlDataSource29.SelectParameters.Add("tc_t_id", App_id);        
SqlDataSource29.InsertParameters.Clear();
ListView1.Visible = true;
if(!IsPostBack)
{
    ListView1.DataBind();
}
((TextBox)ListView1.InsertItem.FindControl("tc_t_idTextBox")).Text = App_id; 
```

# c# - 如何在 C# 中获取调用函数的名称？

> ID：12098267
> 
> 赞同：4
> 
> 时间：2012-08-23T18:54:43.573
> 
> 标签：c#

我需要在 C# 中获取调用函数的名称。我阅读了有关 stackframe 方法的信息，但到处都说它不可靠并且会损害性能。

但我需要它用于生产用途。我正在编写一个自定义跟踪器，它将记录调用跟踪的方法的名称。

有人可以帮助提供一种有效的方法来获取调用函数名称吗？我正在使用 Visual Studio 2010。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-23T18:58:01.427

upgrade to c# 5 and use `CallerMemberName`

```
public void Method([CallerMemberName] string caller="")
{
} 
```

**EDIT**

Other nice things with c# 5

```
public void Method([CallerMemberName] string name="",
                   [CallerLineNumber] int line=-1,
                   [CallerFilePath] string path="")
{
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-23T08:24:09.433

您可以使用 LB 的答案中提到的 C# 4.5 属性与 .NET 3.5 或更高版本，只需声明它们（您需要使用 vs2012 或更高版本进行编译，否则**不会出现任何错误，但参数值将保持为空！**）：

```
namespace System.Runtime.CompilerServices
{
  [AttributeUsageAttribute(AttributeTargets.Parameter, Inherited = false)]
  public sealed class CallerMemberNameAttribute : Attribute
  {
  }

  [AttributeUsageAttribute(AttributeTargets.Parameter, Inherited = false)]
  public sealed class CallerFilePathAttribute : Attribute
  {
  }

  [AttributeUsageAttribute(AttributeTargets.Parameter, Inherited = false)]
  public sealed class CallerLineNumberAttribute : Attribute
  {
  }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-23T18:57:40.233

You can do something like:

```
 var stackTrace = new StackTrace();
 var name = stackTrace.GetFrame(1).GetMethod().Name; 
```

and it work with any version of the framework/language.

# objective-c - 测试我的数组在给定索引处是否为零？

> ID：12098271
> 
> 赞同：2
> 
> 时间：2012-08-23T18:55:06.337
> 
> 标签：objective-c, cocoa, nsarray

我正在尝试`NSMutableArray`在给定索引处创建一个包含另一个内容的内容。

如果前一个数组在索引处有任何内容，我将初始化新数组`initWithArray:`，否则使用普通`init`

此代码不起作用，但您应该能够从中得到想法：

```
NSMutableArray *typeCourseCutId;
if([self.typeCourseCut objectAtIndex:typeCourseIndex] != nil){
    typeCourseCutId = [[NSMutableArray alloc]initWithArray:[self.typeCourseCut objectAtIndex:typeCourseIndex]];
} else {
    typeCourseCutId = [[NSMutableArray alloc]init];
} 
```

这种测试有解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T18:57:25.617

有一个特殊的类称为[`NSNull`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSNull_Class/Reference/Reference.html)，它是专门为在集合中用作空指示符而创建的：

> 该类`NSNull`定义了一个单例对象，用于表示`null`集合对象中的值（不允许`nil`值）。

```
if([self.typeCourseCut objectAtIndex:typeCourseIndex] != [NSNull null]) ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T19:03:18.220

您可以检查数组的计数。如果计数大于您要获取的索引，则表示该索引处存在对象。

还要确保你`self.typeCourseCut`是一个`NSArray`对象数组，否则你`initWithArray:`会崩溃。

您还可以将空对象添加到数组中`[yourArray addObject:[NSNull null]];` ，最重要的是，如果没有索引 1 处的对象，则无法将对象添加到索引 2。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T18:58:25.803

数组在任何索引处都不应该为零。构建数组的方式是，一旦它到达一个 nil 对象。它被认为是数组的结尾。

您不能添加 nil 对象，也不能将现有对象更新为 nil。

如果您必须将某些内容设置为“Null”样式对象，则可以使用 NSNull 代替它。这是大多数 JSON 解析器对他们想要显示但为空的对象所做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-19T11:52:20.213

如果这可以帮助

```
 if([array objectAtIndex:0] != [NSNull null])
    {
       NSLog(@"INDEX 0);
    }
    else if([array objectAtIndex:1] != [NSNull null])
    {
         NSLog(@"INDEX 1);
    }
    else if([array objectAtIndex:2] != [NSNull null])
    {
         NSLog(@"INDEX 2);
    } 
```

# grails - 在 Geb 中，displayed 和 present 有什么区别？

> ID：12098273
> 
> 赞同：7
> 
> 时间：2012-08-23T18:55:11.710
> 
> 标签：grails, functional-testing, spock, geb

我正在编写功能测试并处理淡入淡出的模态窗口。

显示和呈现有什么区别？

例如我有：

```
settingsModule.container.displayed and settingsModule.container.present 
```

其中 settingsModule 代表我的模态窗口。

在测试我的模态窗口（来自 Twitter 引导程序的模态窗口）时，我通常这样做：

```
def "should do ... "() {
    setup:
    topMenu.openSettingsModal()     

    expect:
    settingsModule.timeZone.value() == "Asia/Hong_Kong"

    cleanup:
    settingsModule.closeSettingsModal()
}

def "should save the time zone"() {
        setup:
        topMenu.openSettingsModal()             
        settingsModule.timeZone = "Japan"

        when:               
        settingsModule.saveSettings()       

        then:
        settingsModule.alertSuccess.size() == 1
        settingsModule.alertSuccess.text() == "Settings updated"

        when:
        settingsModule.saveSettings()       

        then:
        settingsModule.alertSuccess.size() == 1

        cleanup:
        settingsModule.closeSettingsModal()
    } 
```

不断地。在我的模块中，我有：

```
 void openSettingsModal() {                  
        username.click()
        settingsLink.click()            
    }

void closeSettingsModal() {
        form.cancel().click()       
    } 
```

我总是抱怨：“必须显示元素才能点击”。

在我的 openSettingsModal 和 closeSettingsModal 中，我尝试了许多 waitFor 与时间间隔的组合以及是否使用存在......无法弄清楚。

任何指针将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T00:18:21.890

我认为主要区别在于 present 会检查你的 DOM 中是否有一个元素，而 display 会检查这个元素的可见性。

请记住，webdriver 模拟用户使用和使用鼠标单击网站的实际体验，因此如果元素对他们不可见，他们将无法单击它。

我想知道您的问题是否与首次加载页面时 settingsLink 不在 DOM 中有关。如果您正在等待弹出对话框并在此对话框中显示链接，那么您可能需要设置类似

```
content{
   settingsLink( required: false ) { $( '...' }
   settingsModal( required: false ) { $( '#modalDialog' ) }
} 
```

你的等待应该看起来像

```
username.click()
waitFor{ settingsModal.displayed }
settingsLink.click() 
```

我会坚持使用 geb 约定书，并且一直使用 display 。

[Geb 手册 - 确定可见性](http://www.gebish.org/manual/current/#determining-visibility)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-24T19:21:59.017

感谢您的回复。我实际上能够解决我的问题。

问题是模态窗口的动画为 500 毫秒。在我的测试中多次打开和关闭窗口使它们不一致地成功/失败。

我最终做的是挂钩插件提供的“显示”事件。我最终为模态添加了一个“显示”类，并在 1 秒内每 100 毫秒检查一次。

```
void openSettingsModal() {      
    username.click()
    settingsLink.click()
    waitFor (1, 0.1) { $("#settingsModal", class: "shown").size() == 1 }
}

void closeSettingsModal() {
    form.cancel().click()   
    waitFor (1, 0.1) { $("#settingsModal", class: "shown").size() == 0 }    
} 
```

作为旁注，测试在 Chrome 和 Firefox 中失败，但在 IE 中通过！我猜是因为 IE 8 不支持我的测试通过的动画。

现在一切都很好。

我希望有一天它会对某人有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-04T11:27:48.417

我们可以在哪里使用 `displayed`？

如果您要删除或删除的特定元素，如果它仍然存在于 DOM 中且未显示在页面中，则可以使用 assert`thatelement.displayed == false`确保该元素未显示在页面中（但它仍然存在于 DOM 中）

我们可以在哪里使用`present`？

同上例，移除后，如果在 DOM 中没有找到该元素，则应使用 present 进行验证

```
assert thatelement.present == false 
```

希望你能理解....

除了上述之外，present 在脚本执行中需要更多时间

# c# - ASP MVC 4.0 图表控件正确渲染图像

> ID：12098276
> 
> 赞同：0
> 
> 时间：2012-08-23T18:55:32.280
> 
> 标签：c#, asp.net-mvc, entity-framework, datavisualization.toolkit

我正在尝试使用 ASP MVC 4.0（VS 2012 RC 上的 .net 4.5）在我的页面上呈现 System.Web.UI.Datavisualization.Chart 控件。我意识到直接在 MVC 页面视图上使用 webforms 控件并不容易/标准做法，所以我试图在控制器中使用一个动作来返回视图可以显示的图表图像。

在 HomeController 我有：

```
public FileResult DataChart()
{
        Chart newChart = new Chart()
        {
            Width = 500,
            Height = 300
        };
        List<double> DataPoints = new List<double>();
        new LogModelContainer().Measurements.Select(i => i.MU).ToList().ForEach(i => DataPoints.Add(i));
        Series newSeries = new Series()
        {
            ChartType = SeriesChartType.Bar
        };
        newSeries.Points.Add(DataPoints.ToArray());
        newChart.Series.Add(newSeries);
        newChart.ChartAreas.Add(new ChartArea());
        var returnVal = new MemoryStream();
        newChart.SaveImage(returnVal);
        return File(returnVal.GetBuffer(), @"image/png");
 } 
```

注意：图表的数据来自链接到 SQL 数据库的 EF 5 模型（数据确实存在并正确加载）。

我正在尝试从 Index.cshtml 中使用它，如下所示：

```
 <img src="/HomeController/DataChart" alt="" /> 
```

这似乎等同于我在 CodePlex 上的示例中使用的内容（[MVC 图表控件示例 CodePlex](http://www.codeproject.com/Articles/125230/ASP-NET-MVC-Chart-Control)我在网上找到的，除了我不需要将参数传递给我的操作。

当我运行代码时，我得到的只是该图表所在页面上的损坏图像图标。我是一个完整的 ASP 菜鸟（这是我第一个使用该技术的项目），所以很可能我正在做一些愚蠢的事情。谁能告诉我怎么了？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:19:20.310

img src 不是 /Home 而不是 /HomeController 吗？（不确定它们是否等效，但我一直只使用控制器名称而不附加“控制器”一词）。话虽如此，使用 Chrome/FF 中的开发人员工具查看前端，看看图像源实际呈现为什么？

# jquery - 使用 JQ 或 CSS 为每个 X 元素添加一个 div

> ID：12098277
> 
> 赞同：0
> 
> 时间：2012-08-23T18:55:38.393
> 
> 标签：jquery, css, dynamic

我有很多 div，比如说 10 个，我想每隔 4 个元素添加一个具有特定类的新 div。谁能告诉我如何使用 JQ 或 CSS 来做到这一点？我更喜欢 JQ，因为我想让它充满活力。

提前谢谢！对不起我的英语不好...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:02:24.193

```
$('<div/>').addClass('someclassname').html('somehtml').insertAfter('div:nth-child(4n)');​ 
```

[工作演示](http://jsfiddle.net/rjW7u/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:46:04.367

@AshirvadSingh 解决方案是正确的，可能是最好的解决方案。不过，为了完整起见，您实际上可以使用纯 css 来完成。从技术上讲，您实际上并没有插入新的 div，但效果是相同的，并且您将拥有所有相同的样式选项。CSS看起来像这样：

```
div:nth-child(4n):after {
   content: 'b';
   display: block;
   color: green;   
} 
```

我更新了@AshirvadSingh fiddle 来演示：http: [//jsfiddle.net/rjW7u/1/](http://jsfiddle.net/rjW7u/1/)

jQuery 解决方案的优点是它可能在不支持我使用的伪选择器的旧浏览器中工作得更好。另一方面，css 解决方案仍然适用于禁用 js 的人。

# sql-server - 动态插入过程

> ID：12098281
> 
> 赞同：0
> 
> 时间：2012-08-23T18:55:56.960
> 
> 标签：sql-server, tsql

我有一个动态插入过程。实际上我试图用 C# 的一个按钮创建所有程序。无论如何，我创建了那个插入过程，但如果 isActive 为空，它看起来像那样。所以sql server报错。有没有办法替换这个 coma(,) 字符？或者有什么建议？

```
INSERT INTO category (  mainCatId,  catname, isActive, ) VALUES (  @mainCatId,  @catname, @isActive,  ) 
```

看起来是这样的。

```
declare @mainCatId int = 1, @catname nvarchar (50) = NULL, @isActive bit = NULL

DECLARE @sqlQuery nvarchar(4000); 
SET @sqlQuery =     'INSERT INTO category ( ';

IF ( @mainCatId IS NOT NULL )
 SET @sqlQuery = @sqlQuery + ' mainCatId, ';

IF ( @isActive IS NOT NULL )
 SET @sqlQuery = @sqlQuery + ' isActive, ';

SET @sqlQuery = @sqlQuery + ' )';

SET @sqlQuery = @sqlQuery + ' VALUES ( ';

IF ( @mainCatId IS NOT NULL )
 SET @sqlQuery = @sqlQuery + ' @mainCatId, ';

IF ( @catname IS NOT NULL )
 SET @sqlQuery = @sqlQuery + ' @catname, ';

IF ( @isActive IS NOT NULL )
 SET @sqlQuery = @sqlQuery + ' @isActive, ';

SET @sqlQuery = @sqlQuery + ' )';
SET @sqlQuery = @sqlQuery; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:29:39.470

我会这样做略有不同。它没有为每个值构建字符串，而是具有完整的 SQL 语句，您只需传入每个字段的值。：

```
declare @mainCatId int = 1, 
    @catname nvarchar (50) = NULL, 
    @isActive bit = NULL

declare @mainCatIdString nvarchar(10)
declare @catnameString nvarchar(50)
declare @isActiveString nvarchar(50) 

DECLARE @sqlQuery nvarchar(4000); 

If @mainCatId is not null
    set @mainCatIdString = cast(@mainCatId as nvarchar(10))
else 
    set @mainCatIdString = ''

If @catname is not null
    set @catnameString = @catname
else 
    set @catnameString = ''

If @isActive is not null
    set @isActiveString = Cast(@isActive as nvarchar(10))
else 
    set @isActiveString = 0

SET @sqlQuery = 'INSERT INTO category 
                (
                    mainCatId, 
                    catname, 
                    isActive
                ) 
                VALUES 
                (
                    ' + @mainCatIdString +',''' 
                        + @catnameString + ''',' 
                        + @isActiveString +')'
 print @sqlQuery 
```

编辑：我不完全明白为此使用动态查询的原因。这可以很容易地在与此类似的存储过程中执行。在此过程中，您会将所有三个参数传递给它，然后根据它们是否为`null`：

```
create procedure test
(
    @mainCatId int = 1, 
    @catname nvarchar (50) = null, 
    @isActive bit = null
)
AS
BEGIN                               
   INSERT INTO Category
   (
       mainCatId, 
       catname, 
       isActive
   ) 
   SELECT IsNull(@mainCatId, 1), 
      IsNull(@catname, ''), 
      IsNull(@isActive, 0)
END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:44:29.240

您为什么要费心使用动态 SQL，并动态构建此查询，而忽略具有 NULL 值的列？如果这些列可以为空，并且您想要存储`NULL`，为什么不直接说：

```
INSERT dbo.category(mainCatId,catname,isActive) 
  VALUES(@mainCatId,@catname,@isActive); 
```

这会将 NULL 值放入参数为 NULL 的列中。如果它们被指定为 NOT NULL 或者它们具有默认值，那么您可以更简单地构造动态 SQL：

```
declare @mainCatId int = 1, @catname nvarchar (50) = NULL, @isActive bit = NULL

DECLARE @sql NVARCHAR(4000);

SELECT @sql = N'';

SET @sql = N'INSERT dbo.category(mainCatId,catname,isActive) 
  VALUES(' + COALESCE(RTRIM(@mainCatId), 'DEFAULT')
   + ',' + COALESCE(N'''' 
   + REPLACE(@catname, '''', '''''') + '''', 'DEFAULT')
   + ',' + COALESCE(RTRIM(@isActive), 'DEFAULT')
   + ');';

EXEC sp_executesql @sql; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:21:03.280

不确定您的确切问题，但如果您只是移动逗号，则不会出现尾随逗号问题：

我还为您的值添加了引号（可能需要再次加倍，具体取决于您的动态语句的执行方式）

```
declare @mainCatId int = 1, @catname nvarchar (50) = NULL, @isActive bit = NULL

DECLARE @sqlQuery nvarchar(4000); 
SET @sqlQuery =     'INSERT INTO category ( ';

IF ( @mainCatId IS NOT NULL )
 SET @sqlQuery = @sqlQuery + 'mainCatId';

IF ( @catname IS NOT NULL )
 SET @sqlQuery = @sqlQuery + ',catname ';

IF ( @isActive IS NOT NULL )
 SET @sqlQuery = @sqlQuery + ',isActive ';

SET @sqlQuery = @sqlQuery + ' )';

SET @sqlQuery = @sqlQuery + ' VALUES ( ';

IF ( @mainCatId IS NOT NULL )
 SET @sqlQuery = @sqlQuery + ' '''+@mainCatId+''' ';

IF ( @catname IS NOT NULL )
 SET @sqlQuery = @sqlQuery + ' ,'''+@catname+''' ';

IF ( @isActive IS NOT NULL )
 SET @sqlQuery = @sqlQuery + ' ,'''+@isActive+''' ';

SET @sqlQuery = @sqlQuery + ' )';
SET @sqlQuery = @sqlQuery; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T19:27:34.660

如果您只想去除尾随字符，可以将其放在脚本中的适当位置：

```
SET @sqlQuery = LEFT(@sqlQuery, LEN(@sqlquery) - 1) 
```

这将删除尾随空格和之前的最后一个字符。

# windows - 是否有工具可以在 Windows 上将 UTF-8 文件名批量转换回 ISO-8859-1？

> ID：12098282
> 
> 赞同：1
> 
> 时间：2012-08-23T18:55:57.787
> 
> 标签：windows, unicode, character-encoding, filenames

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:38:13.260

在 PowerShell 中：

```
Get-ChildItem | ForEach-Object {
  $filename = Split-Path -Leaf $_
  $new = [Text.Encoding]::Utf8.GetString([Text.Encoding]::Default.GetBytes($filename))
  if ($_.Name -ne $new) {
    Rename-Item $_ $new
  }
} 
```

可能会奏效。整个`Rename-Item`调用可能会更容易完成，但我通常在不使用完整路径时遇到麻烦，所以我会谨慎行事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:03:16.130

使用 php：

```
foreach (glob("*.*") as $filename) {
    rename( $filename, mb_convert_encoding( $filename, "Windows-1252", "UTF-8") );
} 
```

# objective-c - Execute method on main thread from inside some other method executing on background thread?

> ID：12098285
> 
> 赞同：0
> 
> 时间：2012-08-23T18:56:18.457
> 
> 标签：objective-c, ios, multithreading, nsoperationqueue

This is what my code looks *like* now and I want to call these methods in a serial manner:

```
-(void) methodOnBackThread // this method will run on a background thread
{
    [runner runThisMethod]; // and this will run on the same background thread as well

    [runner runThisOtherMethod]; // and so will this one

    // but I want this one to run on the main thread :       
    [runner runThisMethodOnTheMainThreadUsing:thisParameter using:thisOtherParamater andUsing:thisOtherOneAsWell]; 

    [runner runThisOtherMethod]; // this one will run on the background thread as well

     // but I want this one to run on the main thread :       
    [runner runThisMethodOnTheMainThreadUsing:thisParameter using:thisOtherParamater andUsing:thisOtherOneAsWell]; 

    [runner runThisOtherMethod]; // this one will run on the background thread as well

    // etc..

} 
```

I believe I have to use `dispatch_get_main_queue` but I can't figure out how to implement this in the above case.

How do I submit `[runner runThisMethodOnTheMainThreadUsing:thisParameter using:thisOtherParamater andUsing:thisOtherOneAsWell];` to the Main Thread, then return to the execution of the rest of my background methods and then get the main thread again if the next method in line needs it?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:00:05.123

如果您的目标是 iOS4 及更高版本，请使用大中央调度。你可以这样做：

```
 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    //do some stuff here in the background
    dispatch_async(dispatch_get_main_queue(), ^{
        //do some stuff here in the main thread
        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
           //do some stuff here in the background after finishing calling a method on the main thread
    });
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:11:41.943

你可以`dispatch_get_main_queue`像这样使用：

```
dispatch_async(dispatch_get_main_queue(), ^{
        if (backgroundTask != UIBackgroundTaskInvalid)
        {
            [runner runThisMethodOnTheMainThreadUsing:thisParameter using:thisOtherParamater andUsing:thisOtherOneAsWell];
        }
    }); 
```

为了更好地理解`dispatch`检查这个[链接](http://mobileorchard.com/ios-advanced-programming-understanding-ios-4-multitasking/)

# javascript - Canvas tooltip to appear outside canvas?

> ID：12098286
> 
> 赞同：3
> 
> 时间：2012-08-23T18:56:24.530
> 
> 标签：javascript, html, canvas, d3.js, kineticjs

I have made the following using KineticJS and D3.js. I have used KineticJS to let me popup tooltips when the user hovers over one of the dots. However, the tooltip appears cut off because of the boundaries of the canvas. Is there a way I can make this appear without it getting clipped?

The entire code itself is pretty huge and contains a lot of unrelated stuff so I posted the relevant snippets:

```
 this.stage = new Kinetic.Stage({
        container: 'canvas',
        width: this.WIDTH,
        height: this.HEIGHT
    });

    this.circlesLayer = new Kinetic.Layer();
    this.tooltipLayer = new Kinetic.Layer();

    this.stage.reset();
    this.stage.clear();

    // Some d3 specific code
    this.xRange.domain([
        d3.min(this.data, function(d) {
        return d.x;
    }), d3.max(this.data, function(d) {
        return d.x;
    })]);

    this.yRange.domain([
        d3.min(this.data, function(d) {
        return d.y;
    }), d3.max(this.data, function(d) {
        return d.y;
    })]);

    var axes_transition = d3.select("#" + this.div).transition().duration(1000).ease("exp-in-out")

    // transition the axes
    axes_transition.select(".x.axis").call(this.xAxis);

    // Drawing the circles
    this.last = this.data.map(this.position);
    this.last.forEach(this.kineticCircle);

    // Setting up the tooltip
    this.tooltip = new Kinetic.Text({
      text: "",
      fontFamily: "Calibri",
      fontSize: 12,
      padding: 5,
      visible: false,
      fill: "black",
      //alpha: 0.75,
      textFill: "white"
    });

    this.tooltipLayer.add(this.tooltip);

    this.stage.add(this.circlesLayer);
    this.stage.add(this.tooltipLayer); 
```

![enter image description here](../Images/0d6bc0460765fb9633fa101b28457577.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T19:02:52.080

不幸的是，如果工具提示是在画布中绘制的，则不会。您当然可以使用 html 创建工具提示，或者改用画布上的 title 属性。

# c# - Windows Forms Remove Close Button

> ID：12098288
> 
> 赞同：0
> 
> 时间：2012-08-23T18:56:36.770
> 
> 标签：c#, winforms

I'm working on a Windows Forms app and I'm wanting to remove the close button from the top. I'm aware of the `ControlBox` option, but I'm wanting to provide a help button. Is there a way to have the Close button not visible while maintaining the help button?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T19:00:34.530

您可以简单地使用`Form.ControlBox = false`（或通过设计师在您的评论中相当消极地指出）然后**在表单上添加自定义帮助按钮**吗？

**编辑**：我的一位同事写了一个 Excel 插件，并要求`X`从某些表单中删除（例如不应关闭的进度条）。他找到了一个[由 Stephen Bullen 编写的函数](http://www.oaltd.co.uk/Excel/Default.htm)，可以做到这一点。我只在 VB 中看到过这个函数，但也许你可以从他使用 Windows API 解决问题的方法中得到一些想法或方向。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T20:01:58.460

您最好的选择可能是像这样订阅表单的 FormClosing 事件并取消关闭操作：

```
// In your code somewhere subscribe to this event
Form1.FormClosing += Form1_FormClosing;

void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    e.Cancel = true;
} 
```

这样做的好处是它可以防止用户从关闭按钮和任务栏关闭应用程序。

显然，您不想总是取消关闭表单。因此，您将需要设置某种类型的布尔标志，您将在事件侦听器中检查您是否希望允许关闭表单。例子：

```
void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    if (BlockClosing)
        e.Cancel = true;
} 
```

**编辑：** 如果您不想以这种方式解决问题，并且您确实打算完全删除关闭按钮，那么您最好的选择是创建自己的自定义标题栏。在这种情况下，您将表单的 FormBorderStyle 属性设置为 None。然后，您将自定义标题栏停靠在表单顶部。这是我不久前制作的一些示例代码：

```
using System;
using System.ComponentModel;
using System.Windows.Forms;

namespace Spectrum.UI
{
    public partial class TitleBar : UserControl
    {
        public delegate void EventHandler(object sender, EventArgs e);
        public event EventHandler MinButtonClick;
        public event EventHandler MaxButtonClick;
        public event EventHandler CloseButtonClick;

        #region Properties
        [Category("Appearance")]
        public string Title
        {
            get { return TitleLabel.Text; }
            set { TitleLabel.Text = value; }
        }

        [Category("Appearance")]
        public bool MinimizeEnabled
        {
            get
            {
                return minButton.Visible;
            }
            set
            {
                minButton.Visible = value;
            }
        }

        [Category("Appearance")]
        public bool MaximizeEnabled
        {
            get
            {
                return maxButton.Visible;
            }
            set
            {
                maxButton.Visible = value;
            }
        }
        #endregion

        public TitleBar()
        {
            InitializeComponent();
            ShowTitleBarImage = false;
        }

        #region Mouse Events
        private void TitleBar_MouseDown(object sender, MouseEventArgs e)
        {
            this.OnMouseDown(e);
        }

        private void TitleBar_MouseUp(object sender, MouseEventArgs e)
        {
            this.OnMouseUp(e);
        }

        private void TitleBar_MouseMove(object sender, MouseEventArgs e)
        {
            this.OnMouseMove(e);
        }
        #endregion

        #region Button Click Events
        private void minButton_Click(object sender, EventArgs e)
        {
            if (MinButtonClick != null)
                this.MinButtonClick.Invoke(this, e);
        }

        private void maxButton_Click(object sender, EventArgs e)
        {
            if (MaxButtonClick != null) 
                this.MaxButtonClick.Invoke(this, e);
        }

        private void closeButton_Click(object sender, EventArgs e)
        {
            if (CloseButtonClick != null) 
                this.CloseButtonClick.Invoke(this, e);
        }
        #endregion
    }
} 
```

![这就是我完成后自定义标题栏的样子](../Images/3453128aa3b4c9ca7cf24fa87a5e58a9.png)

从图片中可以看出，我还在控件中添加了背景图片。根据您的耐心和要求，您可以根据需要使用图像和 PictureBox 控件使其看起来像标准标题栏。

在上面的示例中，我在控件上放置了三个按钮，其中包含我在网上找到的图像来表示最小化、最大化和关闭。在您的情况下，您只需排除关闭按钮。我还在控件上放置了一个带有适当字体的字符串作为窗口的标题。

将自定义标题栏添加到表单很容易。

```
public TitleBar titleBar = new TitleBar();
titleBar.Dock = DockStyle.Top;
titleBar.MaximizeEnabled = true;
titleBar.MinimizeEnabled = true;
titleBar.Size = new System.Drawing.Size(10, 40); // Width doesn't matter - I wanted it 40 pixels tall
titleBar.Title = "Title Example";
titleBar.MinButtonClick += titleBar_MinButtonClick;
titleBar.Max ButtonClick += titleBar_MaxButtonClick;
this.Controls.Add(this.TitleBar); 
```

最后一步是为最小和最大按钮点击设置事件侦听器：

```
private void titleBar_MinButtonClick(object sender, EventArgs e)
{
    WindowState = FormWindowState.Minimized;
}

private void titleBar_MaxButtonClick(object sender, EventArgs e)
{
    WindowState = FormWindowState.Maximized;
} 
```

您可能还注意到，我在标题栏中包含了鼠标向下、向上和移动的事件。这样我就可以在表单中创建侦听器，以便在用户单击并拖动标题栏时移动表单。这是可选的，取决于您是否需要用户能够移动您的应用程序窗口。

这样做的额外好处是可以使用标题栏进行附加控件。例如，我的应用程序是自定义编写的，用于带有小型触摸屏显示器的笔记本式平板电脑。在我的应用程序中，有限空间的利用非常重要。我能够进一步修改我在这里描述的内容，还可以直接在标题栏上包含菜单栏样式控件。此外，我在支架左侧添加了更多按钮，最小化、最大化和关闭按钮。真的帮助我在我的应用程序中利用了每一平方英寸的屏幕。使用标准标题栏无法做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T18:59:07.363

此代码将禁用关闭按钮。我不确定你是否真的可以让它不可见。[http://www.codeproject.com/Articles/20379/Disabling-Close-Button-on-Forms](http://www.codeproject.com/Articles/20379/Disabling-Close-Button-on-Forms)

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-11T06:06:19.383

请尝试`this.ControlBox = false`。

# xml - Groovy Grails test case error when converting to xml

> ID：12098289
> 
> 赞同：1
> 
> 时间：2012-08-23T18:56:37.277
> 
> 标签：xml, unit-testing, grails, groovy, junit

I am trying to write a test case for this method, which works when it is hit from non test case code...

```
import grails.converters.XML
Class itemService(){

    def getData(Map){
        def helperBean = new HelperBean(Map)
        def requestXml = helperBean as XML
            -------- some code-------------
        return requestXml
        }
    } 
```

To test this method, I have a test case like this:

```
 void testGetData(){

            def service = new itemService()
            def id="123"
            def map = [id:id.toLong()]
            def result = service.getData(map)
            assertNotNull(result)
            assertEquals "123", result.id
        } 
```

But it keeps throwing this exception

```
org.codehaus.groovy.runtime.typehandling.GroovyCastException: Cannot cast object 'com.xyz.groovy.utils.helperBean@443acc67' with class 'com.xyz.groovy.utils.HelperBean' to class 'grails.converters.XML' 
```

at this line in the getData(Map method)

```
 def requestXml = userBean as XML 
```

Can anyone help me out with why it is throwing that exception when the getData(Map) is being hit from the test case only? It is working fine when that method is hit from non test case code.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-21T16:19:23.017

您的测试类（testGetData() 方法所在的位置）实现了 ControllerUnitTestCase 类，或者您在哪里使用注释 @TestFor(SomeController)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T14:33:53.810

Found the solution. Adding `addConverters(helperBean)` in the setup() method of the test case should solve the problem.

# php - Convert given URL to a base URL

> ID：12098293
> 
> 赞同：-1
> 
> 时间：2012-08-23T18:56:48.853
> 
> 标签：php, url, base

How can I convert a given url to a base url? That means if I have "http://test.com/folder/it.html?gsa=5", the script should return "http://test.com/folder/".

I tried:

```
preg_match('~.*/~', $cur_url, $match);
$base=($match[0]=='http://') ? $cur_url : $match; 
```

Doesn't work good.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:03:14.297

尝试`parse_url`

来自 php.net 的示例

```
<?php $url = 'http://username:password@hostname/path?arg=value#anchor';

print_r(parse_url($url));

echo parse_url($url, PHP_URL_PATH); ?> 
```

返回

```
Array
(
    [scheme] => http
    [host] => hostname
    [user] => username
    [pass] => password
    [path] => /path
    [query] => arg=value
    [fragment] => anchor
)
/path 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:33:35.413

好吧，如果您想从 url 中删除 $_GET 变量

`?hello=somethin&something=somethingelse`

以下可能有效：

```
$fullurl = $_SERVER['REQUEST_URI'];
$urlarray = explode($fullurl, "?");
$urlnoget = $urlarray[0]; 
```

这会将每个网址分解成位？没有？在实际的文件/fooledr 名称中，因此它将清除 $_GET url。

你考虑过使用 JavaScript 吗？

对不起，如果有更简单的方法，但这是我所知道的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:01:49.547

使用正则表达式字符串来保留 .com 的所有内容。只需设置它，以便可以使用任何可能的站点结尾。将很快更新示例字符串。

- 编辑 -

此 php 正则表达式字符串可用于从任何 url 获取基地址（经过测试）。

```
![a-zA-Z]+(.com/|.ca/|.gov/)! 
```

注意：此字符串设置为仅适用于 .com、.ca 和 .gov 域，但您可以将其他字符串添加到用 | 分隔它们的括号中。

- 编辑 -

重读您的帖子，如果您想要 url 中的所有内容，除了最后的文件，我已经设计了另一个字符串。

```
!([a-zA-Z]*+(.com/|.ca/|.gov/))+([a-zA-Z/]*[/])! 
```

注意：如果您将它与末尾没有文件的 url 一起使用，则该目录必须仍然有斜杠，否则最后一个目录也将被剪切。

# javascript - document and window height return the same value?

> ID：12098296
> 
> 赞同：1
> 
> 时间：2012-08-23T18:57:02.403
> 
> 标签：javascript, jquery, window, height, document

For some reason both document height and window height return the same value, so when subtracting window from document height it returns 0\. Anyone know why this might be happening?

```
console.log($(window).height());

console.log($(document).height()); 
```

The above both return the document height

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-11-07T02:41:40.550

您可能忘记了`<!DOCTYPE html>`页面开头的文档类型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T18:59:41.873

那是因为您的文档填充了视口（可用于显示文档的区域）。

从[文档中](http://api.jquery.com/height/)：

```
$(window).height();   // returns height of browser viewport
$(document).height(); // returns height of HTML document 
```

如果您的文档足够长以占用一页以上，则第二个值可能大于第一个值（至少如果文档位于 iframe 内，请查看[此演示](http://jsfiddle.net/GJ2EB/1/)）。可能还有其他情况会产生差异，但我现在没有想到。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-31T13:47:36.730

我有一个类似的问题，我能够解决。我找到

```
$(window).height(); 
```

在 FF 中返回页面的整个高度。最终我意识到我在页面的任何 html 之前输出了一个调试短语“test”。Doc 类型之前的 IE。

删除此“测试”文本后，视口高度将按预期返回。

# android - Android Camera - app passed NULL surface

> ID：12098298
> 
> 赞同：12
> 
> 时间：2012-08-23T18:57:21.517
> 
> 标签：android, camera, surfaceview, robot, surfaceholder

Whenever I run the cam_thread I get the error "app passed NULL surface". This code supposedly works on the HTC Incredible 1\. I've reconfigured it slightly to run on a droid x. However I still get this error.

```
public class Android_Activity extends Activity 
{       
    Main_thread simulator;
    ToggleButton togglebutton;
    EditText ip_text;
    SensorManager sm = null;
    SurfaceView view;
    Sensors_thread the_sensors=null;
    String IP_address;
    Android_Activity the_app;

    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {       
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        view = new SurfaceView(this);       
        sm = (SensorManager) getSystemService(SENSOR_SERVICE);
        ip_text = (EditText) findViewById(R.id.IP_edit_txt);
        togglebutton = (ToggleButton) findViewById(R.id.CameraButton);
        togglebutton.setOnClickListener(new btn_listener());        
        the_app = this;
    }

    @Override
    protected void onResume() 
    {
        super.onResume();
    }

    protected void onStop()
    {
        super.onStop();
        simulator.stop_simu();
        this.finish();
    }

    private class btn_listener implements OnClickListener 
    {
        public void onClick(View v) 
        {       
            // Perform action on clicks
            if (togglebutton.isChecked()) 
            {
                IP_address = ip_text.getText().toString(); 

                simulator = new Main_thread(the_app, view, sm, IP_address);
                the_sensors = simulator.the_sensors;    
                sm.registerListener(the_sensors, 
                        SensorManager.SENSOR_ORIENTATION |SensorManager.SENSOR_ACCELEROMETER,
                        SensorManager.SENSOR_DELAY_UI);

                simulator.start();

                Toast.makeText(Android_Activity.this, "Start streaming" + IP_address, Toast.LENGTH_SHORT).show();
            } else 
            {
                simulator.stop_simu();
                sm.unregisterListener(the_sensors);
                Toast.makeText(Android_Activity.this, "Stop streaming", Toast.LENGTH_SHORT).show();
            }
        }
    }
} 
```

Main Thread

```
package carl.IOIO_car;

import android.hardware.SensorManager;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class Main_thread extends Thread
{
    SurfaceView parent_context;
    SensorManager mSensorManager = null;
    Cam_thread the_cam;
    Sensors_thread the_sensors; 
    IOIO_Thread ioio_thread_;   
    String ip_address;
    Android_Activity the_app;

    public Main_thread(Android_Activity app, SurfaceView v, SensorManager m, String ip)
    {
        super();

        parent_context = v;     
        mSensorManager = m;
        ip_address = ip;
        the_app = app;
        Log.e("Debug Main", "IP is " + ip_address);
        the_cam = new Cam_thread(parent_context,ip_address);
        the_sensors = new Sensors_thread(mSensorManager,ip_address);
        ioio_thread_ = new IOIO_Thread(the_app, ip_address);
    }

    public void run() 
    {               
        //ioio_thread_.start(); 
        the_cam.start_thread();

    }

    public void stop_simu()
    {
        the_cam.stop_thread();
        the_sensors.stop_thread();
        //ioio_thread_.abort();
    }   
} 
```

Cam_Thread

```
package carl.IOIO_car;

import java.io.ByteArrayOutputStream;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.util.List;

import android.graphics.Bitmap;
import android.hardware.Camera;
import android.hardware.Camera.PreviewCallback;
import android.util.Log;
import android.view.SurfaceView;

public class Cam_thread
{
    Camera mCamera;

    public static int HEADER_SIZE = 5;
    public static int DATAGRAM_MAX_SIZE = 1450 - HEADER_SIZE;   
    int frame_nb = 0;
    int size_packet_sent = 0;   
    InetAddress serverAddr;
    DatagramSocket socket;  

    Bitmap mBitmap;
    int[] mRGBData;
    int width_ima, height_ima;
    private static final String TAG = "IP_cam";

    SurfaceView parent_context;

    private boolean STOP_THREAD;
    String ip_address;

    public Cam_thread(SurfaceView context, String ip)
    {
        parent_context = context;

        ip_address = ip;
    }

    private void init()
    {
        try 
        {            
            serverAddr = InetAddress.getByName(ip_address);
            socket = new DatagramSocket();
            if (mCamera!=null){
                Log.e(TAG, "Nulling camera");
                mCamera.stopPreview();
                mCamera.setPreviewCallback(null);
                mCamera.release();
                mCamera=null;
        }
            if(mCamera == null){
            mCamera = Camera.open();        
            Log.e(TAG, "Setting up camera");
            Camera.Parameters parameters = mCamera.getParameters(); 
            //get a list of supported preview sizes and assign one
            List<Camera.Size> previewSizes = parameters.getSupportedPreviewSizes();
            Camera.Size previewSize = previewSizes.get(0);
            parameters.setPreviewSize(previewSize.width, previewSize.height);
            //Set Frame rate
            parameters.setPreviewFrameRate(30);
            //Set Scene
            List<String> modes = parameters.getSupportedSceneModes();
            parameters.setSceneMode(modes.get(0));
            //Set focus mode
            List<String> focus = parameters.getSupportedFocusModes();
            parameters.setFocusMode(focus.get(0));
            //Apply parameters to camera object
            mCamera.setParameters(parameters);
            //Provide a surface
            if(parent_context.getHolder()==null)
                Log.e(TAG, "Its a null holder");
            Log.e("Debug", "Before");
            mCamera.setPreviewDisplay(parent_context.getHolder());          
            Log.e("Debug", "After");
            //Sets a call when preview data is available
            mCamera.setPreviewCallback(new cam_PreviewCallback());  
            Log.e(TAG, "Camera configured");
            //Start the preview
            Log.e(TAG, "Starting preview");
            mCamera.startPreview();
            /*
            parameters.setPreviewSize(320, 240);
            parameters.setPreviewFrameRate(30);
            parameters.setSceneMode(Camera.Parameters.SCENE_MODE_SPORTS);
            parameters.setFocusMode(Camera.Parameters.FOCUS_MODE_AUTO);
            parameters.setColorEffect(Camera.Parameters.EFFECT_NONE);
            mCamera.setParameters(parameters);
            mCamera.setPreviewDisplay(parent_context.getHolder());          
            mCamera.setPreviewCallback(new cam_PreviewCallback());           

            Log.e(TAG, "Starting preview");
            mCamera.startPreview();
            */
            }
        } 
        catch (Exception exception) 
        {

            Log.e(TAG, "Error: ", exception);
        }
    }

    public void start_thread()
    {
        Log.e("Cam", "Started the Cam thread");
        init();
    }

    public void stop_thread()
    {
        STOP_THREAD = true;
        if (mCamera!=null){
            mCamera.stopPreview();
            mCamera.release();
            mCamera=null;
        }
        socket.close();
    }

    public void send_data_UDP()
    {
        Log.e(TAG, "Started sending cam data");
        if(mBitmap != null)
        {
            int size_p=0,i;     
            ByteArrayOutputStream byteStream = new ByteArrayOutputStream(); 

            mBitmap.compress(Bitmap.CompressFormat.JPEG, 50, byteStream);   // !!!!!!!  change compression rate to change packets size

            byte data[] = byteStream.toByteArray();
            Log.e(TAG, "SIZE: " + data.length);

            int nb_packets = (int) Math.ceil(data.length / (float)DATAGRAM_MAX_SIZE);
            int size = DATAGRAM_MAX_SIZE;

            /* Loop through slices */
            for(i = 0; i < nb_packets; i++) 
            {           
                if(i >0 && i == nb_packets-1) size = data.length - i * DATAGRAM_MAX_SIZE;

                /* Set additional header */
                byte[] data2 = new byte[HEADER_SIZE + size];
                data2[0] = (byte)frame_nb;
                data2[1] = (byte)nb_packets;
                data2[2] = (byte)i;
                data2[3] = (byte)(size >> 8);
                data2[4] = (byte)size;

                /* Copy current slice to byte array */
                System.arraycopy(data, i * DATAGRAM_MAX_SIZE, data2, HEADER_SIZE, size);        

                try 
                {           
                    size_p = data2.length;
                    DatagramPacket packet = new DatagramPacket(data2, size_p, serverAddr, 9000);
                    socket.send(packet);
                    Log.e(TAG, "Sent a cam frame!");
                } catch (Exception e) { Log.e(TAG, "Error: ", e);}  
            }   
            frame_nb++;

            if(frame_nb == 128) frame_nb=0; 
        }
    }    

    /* function converting image to RGB format taken from project: ViewfinderEE368  
     * http://www.stanford.edu/class/ee368/Android/ViewfinderEE368/
     * 
     * Copyright (C) 2007 The Android Open Source Project
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *      http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
    static public void decodeYUV420SP(int[] rgb, byte[] yuv420sp, int width, int height) 
    {
        final int frameSize = width * height;

        for (int j = 0, yp = 0; j < height; j++) {
            int uvp = frameSize + (j >> 1) * width, u = 0, v = 0;
            for (int i = 0; i < width; i++, yp++) {
                int y = (0xff & ((int) yuv420sp[yp])) - 16;
                if (y < 0) y = 0;
                if ((i & 1) == 0) {
                    v = (0xff & yuv420sp[uvp++]) - 128;
                    u = (0xff & yuv420sp[uvp++]) - 128;
                }

                int y1192 = 1192 * y;
                int r = (y1192 + 1634 * v);
                int g = (y1192 - 833 * v - 400 * u);
                int b = (y1192 + 2066 * u);

                if (r < 0) r = 0; else if (r > 262143) r = 262143;
                if (g < 0) g = 0; else if (g > 262143) g = 262143;
                if (b < 0) b = 0; else if (b > 262143) b = 262143;

                rgb[yp] = 0xff000000 | ((r << 6) & 0xff0000) | ((g >> 2) & 0xff00) | ((b >> 10) & 0xff);
            }
        }
    }

    // Preview callback used whenever new frame is available...send image via UDP !!!
    private class cam_PreviewCallback implements PreviewCallback 
    {
        @Override
        public void onPreviewFrame(byte[] data, Camera camera)
        {
            if(STOP_THREAD == true)
            {
                mCamera.setPreviewCallback(null);
                mCamera.stopPreview();
                mCamera.release();
                mCamera = null;
                return;
            }

            if (mBitmap == null)        //create Bitmap image first time
            {
                Camera.Parameters params = camera.getParameters();
                width_ima = params.getPreviewSize().width;
                height_ima = params.getPreviewSize().height;                      
                mBitmap = Bitmap.createBitmap(width_ima, height_ima, Bitmap.Config.RGB_565);
                mRGBData = new int[width_ima * height_ima];
            }

            decodeYUV420SP(mRGBData, data, width_ima, height_ima);
            mBitmap.setPixels(mRGBData, 0, width_ima, 0, 0, width_ima, height_ima);

            send_data_UDP();
        }
    }

} 
```

Manifest

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="carl.IOIO_car"
      android:versionCode="1"
      android:versionName="1.0">
          <uses-sdk android:minSdkVersion="8" />

    <application android:icon="@drawable/icon" android:debuggable="true" android:label="@string/app_name">
        <activity android:name="carl.IOIO_car.Android_Activity"
                android:label="@string/app_name"
                  android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
                  android:screenOrientation="landscape">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
    <uses-permission android:name="android.permission.CAMERA" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE"></uses-permission>
<uses-permission android:name="android.permission.UPDATE_DEVICE_STATS"></uses-permission>
<uses-permission android:name="android.permission.CHANGE_WIFI_STATE"></uses-permission>
<uses-permission android:name="android.permission.CHANGE_WIFI_MULTICAST_STATE"></uses-permission>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-feature android:name="android.hardware.camera" />
    <uses-feature android:name="android.hardware.camera.autofocus" />
</manifest> 
```

This original code was written by Dr. Oros. [http://www.cogsci.uci.edu/~noros/android_car.html](http://www.cogsci.uci.edu/~noros/android_car.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-05-22T17:06:13.280

> 05-22 11:27:24.977 16750-16750/com.egomez.facedetection I/CameraActivity﹕切换相机 05-22 11:27:25.219 16750-16750/com.egomez.facedetection D/Camera﹕应用程序通过 NULL 表面

为了摆脱这个错误，我必须得到 SurfaceView 的持有者（在我试图修复的场景是从前置摄像头切换到后置摄像头，反之亦然）。

```
 public void switchCamera(){
    Log.i(TAG, "Switching Camera");
    if (mCamera != null) {
        mCamera.stopPreview();
        mCamera.release();
        //mCamera = null;
    }

    //swap the id of the camera to be used
    if (camId == Camera.CameraInfo.CAMERA_FACING_BACK) {
        camId = Camera.CameraInfo.CAMERA_FACING_FRONT;
    }else {
        camId = Camera.CameraInfo.CAMERA_FACING_BACK;
    }
    try {
        mCamera = Camera.open(camId);
        //mCamera.setDisplayOrientation(90);
        //You must get the holder of SurfaceView!!!
        mCamera.setPreviewDisplay(mView.getHolder());
        //Then resume preview...
        mCamera.startPreview();
    }
    catch (Exception e) { e.printStackTrace(); }
} 
```

希望它对遇到类似问题的人有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T15:12:35.940

这不是真的。只需使用 Handler 设置一个小延迟，它在 Nexus 上也可以正常工作。

我自己在这些设备上遇到了黑色图片的问题，但延迟 1 秒后一切正常

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T11:20:41.903

所有相机的东西和东西都必须从 Activity 创建，例如 OnCreate 或其他东西，拍照的信号可以从不同的上下文中推送。

# objective-c - 类型或属性 (NSUInteger (aka unsigned int)) 与 ivar (int) 的类型不匹配

> ID：12098302
> 
> 赞同：-2
> 
> 时间：2012-08-23T18:57:47.847
> 
> 标签：objective-c, nsuinteger

我想`NSInteger`在 ViewController 中声明一个变量，但出现错误。

在我的 ViewController.h 我有

```
@interface MainViewController : UIViewController{
    NSInteger currentSection;
    //Other stuff  
  }

  @property (assign,nonatomic) NSUInteger currentSection;
@end 
```

在我的 ViewController.m 我有：

```
@implementation MainViewController

//Other stuff
@synthesize currentSection; 
```

但我得到这个错误：

> 属性类型“currentSection”（“NSUinteger”（又名“unsigned int”））与 ivar 类型“currentSection”（“int”）不匹配

为什么我用一个简单的指令就会得到这个错误？
我正在使用带有 ARC 的 Xcode 4.4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:01:46.167

您要求编译器将`NSUInteger`属性与`NSInteger`ivar 合成。您必须决定属性的类型应该是什么，并相应地调整 ivar 的类型。

请注意，无符号整数不等同于（隐式带符号的）整数。将一个转换为另一个可能会给您带来意想不到的结果。

# perl - Perl：监视后台进程的输出而不等待它完成

> ID：12098304
> 
> 赞同：1
> 
> 时间：2012-08-23T18:57:54.557
> 
> 标签：perl, process, background, monitor

我正在尝试用 Perl 编写一个管理器来自动化我实验室一直在使用的生物信息学管道。（REPET 管道，任何感兴趣的人都可以使用。）管道有八个步骤，其中几个被分解为可以并行运行的子步骤。最值得注意的是，步骤 3 分为三个部分，步骤 4 分为三个相应的部分。step 3 的每个部分都可以独立运行，其对应的 step 4 部分可以在其 step 3 同伴完成后立即启动。我希望我的经理能够在三个并行线程中启动第 3 步，并且对于每个线程，在第 3 步完成后立即转到第 4 步。我能想到的最好方法是监控每个进程的输出。每个步骤的输出如下所示：

```
START TEdenovo.py (2012-08-23 11:20:10)
version 2.0
project name = dm3_chr2L
project directory = /home/<etc>
beginning of step 1
submitting job(s) with groupid 'dm3_chr2L_TEdenovo_prepareBatches' (2012-08-23 11:20:10)
waiting for 1 job(s) with groupid 'dm3_chr2L_TEdenovo_prepareBatches' (2012-08-23 11:20:10)
execution time per job: n=1 mean=2.995 var=0.000 sd=0.000 min=2.995 med=2.995 max=2.995
step 1 finished successfully
version 2.0
END TEdenovo.py (2012-08-23 11:20:25) 
```

这是第 1 步的输出，但是在第 3 步中，当“第 3 步成功完成”出现在输出中时，可以安全地继续进行第 4 步。问题已经成功地将其中三个进程的输出制表，因为它们运行在一次。本质上，这是我想要的行为（伪代码）：

```
my $log31 = `TEdenovo.py [options] &`;
my $log32 = `TEdenovo.py [options] &`;
my $log33 = `TEdenovo.py [options] &`;

while(1) {
    #start step 41 if $log31 =~ /step 3 finished successfully/;
    #start step 42 if $log32 =~ /step 3 finished successfully/;
    #start step 43 if $log33 =~ /step 3 finished successfully/;
    #monitor logs 41, 42, 43 similarly
    last if #all logs read "finished successfully"
    sleep(5);
}

#move on to step 5 
```

问题是用反引号调用一个进程会导致 perl 等到该进程完成才能继续前进。正如我发现的那样，它与 system() 不同，您可以在其中使用 & 将某些内容旋转到后台进程中，然后立即继续。据我所知，没有一个好的方法可以使用 system() 来获得我正在寻找的效果。我想我可以这样做：

```
system("TEdenovo.py [options] & > log31.txt"); 
```

然后定期轮询 log31.txt 以查看是否出现“已成功完成”，但这似乎不必要的混乱。

我还尝试在文件句柄中打开该进程：

```
open(my $step3, "TEdenovo.py [options] |");
my @log3;

while(1)
{
    push(@log3, <$step3>);
    last if grep("step 3 finished successfully", @log3);
    sleep(5);
} 
```

...但是，Perl 再一次等到进程完成才能继续前进（在这种情况下，在 push() 处）。我用 $| 尝试了上述方法 设置和取消设置。

所以，我的问题的本质是：有没有办法在 perl 中捕获正在运行的后台进程的标准输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:23:24.277

也许你可以试试

```
open(my $step3, "TEdenovo.py [options] |");

while(<$step3>)
{
    last if /step 3 finished successfully/;
} 
```

而不是 while(1) ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:28:19.900

使用`open`和读取管道句柄~~的~~方法是正确的方法。如果 Nahuel 在标量上下文中从句柄中读取的建议没有帮助，那么您可能仍然会受到缓冲的影响。

`$|`改变 Perl 输出的缓冲行为，但不会改变从 Perl 调用的任何外部程序的行为。您必须使用不缓冲其输出的外部程序。在这种情况下，我相信通过将`-u`选项传递给 python 是可能的：

```
open(my $step3, "|-", "python -u TEdenovo.py [more options]"); 
```

# sql - Inserting from a temporary table

> ID：12098307
> 
> 赞同：3
> 
> 时间：2012-08-23T18:58:03.103
> 
> 标签：sql, oracle11g

I have two tables, `sprockets` and `cogs`.

```
create table sprockets(
    id NUMBER
);

INSERT into sprockets VALUES (4);
INSERT into sprockets VALUES (8);
INSERT into sprockets VALUES (15);
INSERT into sprockets VALUES (16);
INSERT into sprockets VALUES (23);
INSERT into sprockets VALUES (42);

create table cogs(
    id NUMBER
); 
```

I want to take some ids from `sprockets` and put them into `cogs`.

```
insert into cogs select id from sprockets s where s.id < 40 and MOD(s.id, 3) != 0; 
```

This adds sprockets 4, 8, 16, 23 to `cogs` as expected.

```
4 rows inserted 
```

As my sprocket making business grows, the business logic for determining which sprockets require cogs will become much more complicated. So I would like to use a sequence of temporary tables that filter out non-candidate sprockets. I believe this is more maintainable than a one line statement with no comments.

```
--sprockets with ids greater than 40 are too big to frob, 
--so it's impossible to weld a cog to them
with frobbableSprockets as(
    select id from sprockets where sprockets.id < 40
),

--non-greppable sprockets have built-in harmonic oscillators, 
--so cogs are not required
greppableFrobbableSprockets as(
    select id from frobbableSprockets f where MOD(f.id,3) != 0
),

--not pictured: more filtering using arcane business logic, 
--including but not limited to:
--whether it is raining on a tuesday,
--and if the moon is in the seventh house.

--sprockets with ids less than 3 are from the legacy system and already have cogs
sprocketsRequiringCogs as(
    select id from greppableFrobbableSprockets f where f.id > 3
)

insert into cogs select id from sprocketsRequiringCogs 
```

This code is relatively readable, but unfortunately it does not work!

```
insert into cogs select id from sprocketsRequiringCogs 
Error at Command Line:18 Column:2
Error report:
SQL Error: ORA-00928: missing SELECT keyword 
```

If I change the last line to `select id from sprocketsRequiringCogs`, there is no error, so I know the problem must be in the insert statement and not in the declaration of the temporary tables.

The one-line insert statement works, and the multi-line insert statement does not work. The only difference I see is that the latter is getting its values from a temporary table.

**Why can't I insert rows from a temporary table?**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:23:34.607

这是一个猜测，我现在无法尝试，但这可能可行：

```
insert into cogs
with frobbableSprockets as(
    select * from sprockets where sprockets.id < 40
),
...
select * from sprocketsRequiringCogs 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:02:50.123

```
 insert into cogs (Id) select Id from sprocketsRequiringCogs 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:11:23.223

尝试用内联视图替换 WITH 子句，即在 from (select) 中使用您的 select 语句。

# python - 如何在 Django 中的表单提交中添加预填充字段？（如在管理员中）

> ID：12098319
> 
> 赞同：0
> 
> 时间：2012-08-23T18:58:42.390
> 
> 标签：python, django, forms, slug

我让表单呈现得很好，数据保存得很好，它只是不会像在管理员中那样创建 slug。我希望在提交表单时会自动创建 slug。谢谢你的帮助。

代码：

```
Models.py: 
class Post(TimeStampActivate):
   title = models.CharField(max_length=255,
                         help_text="Title of the post. Can be anything up to 255 characters.")
   slug = models.SlugField()
   excerpt = models.TextField(blank=True,
                             help_text="A small teaser of your content")
   body = models.TextField()
   publish_at= models.DateTimeField(default=datetime.datetime.now(),
                                 help_text="Date and time post should become visible.")
   blog = models.ForeignKey(Blog, related_name="posts")
   tags = TaggableManager()
   objects = PostManager()

def __unicode__(self):
    return self.title

@models.permalink
def get_absolute_url(self):
    return ('post', (), {
            'blog': self.blog.slug,
            'slug': self.slug
            })

class Meta:
    ordering = ['-publish_at','-modified', '-created']

 Views.py:
def add2(request):
    if request.method == "POST":
        form = BlogPostForm(request.POST)

        if(form.is_valid()):
           message =  "thank you for your feedback"
           form.save()
           return render_to_response('add.html',
                              {'success':message},
                              context_instance=RequestContext(request))

    else:
        return render_to_response('add.html',
                              {'form':BlogPostForm},
                              context_instance=RequestContext(request))

Forms.py:

class BlogPostForm(forms.ModelForm):

 class Meta:
     model = Post
     exclude = ('id', 'user', 'slug')

Admin.py: 
class PostAdmin(admin.ModelAdmin):
   prepopulated_fields = {"slug": ("title",)}
   list_display =('active', 'title', 'excerpt', 'publish_at')
   list_display_links=('title',)
   list_editable = ('active',)
   list_filter = ('modified', 'publish_at', 'active')
   date_hierarchy = 'publish_at'
   search_fields = ['title', 'excerpt', 'body', 'blog__name', 'blog__user__username']
   fieldsets = (
       (None, {
           'fields': ('title', 'blog'),
     }),
        ('Publication', {
         'fields': ('active', 'publish_at'),
          'description': "Control <strong>whether</strong> or not and when a post is visual to the world",
     }),
     ('Content', {
         'fields': ('excerpt', 'body', 'tags',),
      }),
      ('Optional', {
              'fields': ('slug',),
              'classes': ('collapse',)
        })
)

 admin.site.register(Post, PostAdmin) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:30:24.500

管理员中的 slug 由 javascript（客户端）预填充。如果你也想在你的表单中使用这个，你也必须使用一些 javascript（客户端），或者为你的 Post 模型编写一个自定义保存函数，它可以使用 djangos slugify 过滤器（服务器端）。

例如：

```
from django.template.defaultfilters import slugify
class Post(models.Model):
    #### define fields and other functions here ###
    def save(self, *args, ***kwargs):
        self.slug = slugify(self.title)
        super(Post, self).save(*args, **kwargs) 
```

# javascript - 如何在jquery中右键单击添加dbclick（）

> ID：12098327
> 
> 赞同：8
> 
> 时间：2012-08-23T18:59:11.173
> 
> 标签：javascript, jquery

嗨，我想在右键单击时使用 dblclick()，因为谷歌地图必须放大和缩小。有没有办法做到这一点。我已经编写了 dblclick，但现在它只需要左键单击即可工作。有关如何执行此操作的任何指示。这是我的代码

```
 $("div#demo1").dblclick(function(e) {
            //alert(e.getElementById());

            if( (!$.browser.msie && e.button == 0) || ($.browser.msie && e.button == 1) ) {
                alert("Left Mouse Button was clicked on demo1 div!");
                $("div.window").animate({
                'height':'+=20', 'width':'+=20'
                },0,function(){
                    jsPlumb.repaintEverything();
                    jsPlumb.repaintEverything();
                });
                // Left mouse button was clicked (all browsers)
            }
            else if( (!$.browser.msie && e.button == 2) || ($.browser.msie && e.button == 3) ) {
                alert("right click double");
            }
        }); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-03-22T06:58:37.793

还有另一种方法可以检测双击右键，它不涉及摆弄计时器或手动跟踪点击次数。在or事件中使用`.detail`事件对象的属性。保存[点击计数](http://www.w3.org/TR/DOM-Level-3-Events/#current-click-count)，它将告诉您最近发生了多少点击。如果是双击。[`mouseup`](https://developer.mozilla.org/en-US/docs/Web/Reference/Events/mouseup)[`mousedown`](https://developer.mozilla.org/en-US/docs/Web/Reference/Events/mousedown)`.detail``.detail === 2`

```
// suppress the right-click menu
$('#target').on('contextmenu', function (evt) {
    evt.preventDefault();
});

$('#target').mouseup(function (evt) {
  if (evt.which === 3) { // right-click
    /* if you wanted to be less strict about what
       counts as a double click you could use
       evt.originalEvent.detail > 1 instead */
    if (evt.originalEvent.detail === 2) { 
      $(this).text('Double right-click');
    } else if (evt.originalEvent.detail === 1) { 
      $(this).text('Single right-click');
    }
  }
}); 
```

您可能会注意到我正在使用`evt.originalEvent.detail`来访问该属性，而不仅仅是`.detail`. 这是因为 jQuery 提供了它自己的事件对象版本，它不包含`.detail`，但是您可以访问浏览器返回的原始事件对象`.originalEvent`。如果您使用纯 JavaScript 而不是 jQuery，您只需使用`evt.detail`.

这是一个[工作示例](http://jsfiddle.net/UselessCode/DqQ37/1/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T19:24:07.180

没有真正的方法可以做到这一点，您可以通过采用 IIRC 为 300 毫秒的默认双击计时器来模拟它：

```
function makeDoubleRightClickHandler( handler ) {
    var timeout = 0, clicked = false;
    return function(e) {

        e.preventDefault();

        if( clicked ) {
            clearTimeout(timeout);
            clicked = false;
            return handler.apply( this, arguments );
        }
        else {
            clicked = true;
            timeout = setTimeout( function() {
                clicked = false;
            }, 300 );
        }
    };
}

$(document).contextmenu( makeDoubleRightClickHandler( function(e) {
    console.log("double right click" );
})); 
```

[http://jsfiddle.net/5kvFG/2/](http://jsfiddle.net/5kvFG/2/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:25:47.210

因为右键单击对 javascript 范围之外的用户代理（上下文菜单）有意义，所以您将不得不做一些跳舞。

首先，您应该禁用目标元素上的上下文菜单：

```
document.getElementById('demo1').oncontextmenu = function() {
    return false;
}; 
```

现在，当我们右键单击时，不会有上下文菜单搞乱第二次单击。

接下来要明白“双击右键”一般来说是不存在的。即使您可以绑定`dblclick`事件，这也不是通用事件。根据定义，“双击”是用鼠标左键双击。

因此，我们将不得不使用该`mousedown`事件，检查右键单击了多少次，并在两次后做出反应。我创建了一个小型辅助函数，用于跟踪点击次数并在短时间内重置状态。

```
var RightClick = {
    'sensitivity':350,
    'count':0,
    'timer':false,
    'active':function () {
        this.count++;
        this.timer = setTimeout(
            this.endCountdown.bind(this),
            this.sensitivity
        );
    },
    'endCountdown': function () {
        this.count = 0;
        this.timer = false;
    }
};
$("div#demo1").mousedown(function(e) {
    if(e.which == 3) {
        RightClick.active();
        if (RightClick.count == 2)
            alert("right click double");
    }
}); 
```

在这里试试：http: [//jsfiddle.net/94L7z/](http://jsfiddle.net/94L7z/)

您可以调整灵敏度，允许更短或更长时间的双击，具体取决于您的偏好。

**文档**

*   `element.onContextMenu`在 MDN - [https://developer.mozilla.org/en-US/docs/DOM/window.oncontextmenu](https://developer.mozilla.org/en-US/docs/DOM/window.oncontextmenu)
*   `element.onMouseDown`在 MDN - [https://developer.mozilla.org/en-US/docs/DOM/element.onmousedown](https://developer.mozilla.org/en-US/docs/DOM/element.onmousedown)
*   `window.setTimeout`在 MDN - [https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)
*   jQuery `event.which`- [http://api.jquery.com/event.which/](http://api.jquery.com/event.which/)
*   UnixPapa.com 上的“Javascript Madness: Mouse Events”，一篇文章展示了一些与鼠标事件和左/右按钮相关的测试 - [http://unixpapa.com/js/mouse.html](http://unixpapa.com/js/mouse.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T19:24:35.330

问题是就JS而言，双击的概念只与鼠标左键有关。因此，无论您单击鼠标右键多少次，以多快的速度单击鼠标右键，它都只会注册为一堆单击。那么该怎么办？

1.  创建一个全局变量来跟踪点击次数
2.  检测一次右键单击，您似乎已经知道如何执行此操作
3.  设置触发一次右键单击的全局变量
4.  设置超时，所以如果在合理的时间内没有通过另一个右键单击被视为 dblclick，全局变量将重置为 0。我建议 300 毫秒，这似乎是最自然的
5.  每次右键单击寄存器检查该变量时，如果它不止一个，则触发您的双击右键处理程序。
6.  您可能希望将该全局变量设为对象，以便您可以跟踪哪个元素注册了右键单击并相应地使特定元素右键单击失效。如果他们在将鼠标移动到各种对象上时双击，这将允许您忽略它们。我认为这是可选的，因为用户不太可能遵循事件链，但根据您的应用程序可能会导致意外功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T19:25:53.130

用这个定义一个 jQuery 函数可能会更好（[试试看](http://jsfiddle.net/X64gz/)）：

```
var precision = 400;
var lastClickTime = 0;

$(document).ready(function()
{
    var div = $('#div');

    $(div).bind("contextmenu", function(e)
    {
        return false;
    }); 

    $(div).mousedown(function(event)
    {
        if (event.which == 3)
        {
            var time = new Date().getTime();

            if(time - lastClickTime <= precision)
            {
                // DOUBLE RIGHT CLICK
                alert('double click');
            }

            lastClickTime = time;
        }
    });
}); 
```

# android - 将微调器设置为未选中

> ID：12098329
> 
> 赞同：5
> 
> 时间：2012-08-23T18:59:20.317
> 
> 标签：android, spinner

我目前在我的应用程序中有一大堆微调器。我没有想太多，对于每个微调器，第一个索引都用`N/A`. 这没什么大不了的，但我希望让它更干净一些。

我想知道是否有一种方法可以代替调用`setSelection( index )`，我想知道是否有一种方法可以将 Spinner 设置为没有选择任何内容。

基本上，我希望微调器中有一个项目列表，但在单击它之前不显示它们。我也不希望顶部有一个空白索引。

我认为很有可能没有办法做到这一点，所以如果有人确定这一点，请告诉我。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T19:49:34.743

最好将第一个位置设置为空白，以便可以将其视为未选中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T19:34:09.243

微调器必须具有选定状态。我建议有一个“无选择”选项

另一种选择是选择底部按钮，然后将该按钮设置为不可见（我将最后一个按钮设置为选中的原因是这样您的应用程序中就没有一大块空白空间，因为这看起来有点垃圾）：

```
case SPINNER_OPTION_FIRST:
    yourSpinnerLabel.setVisibility(View.VISIBLE);
    yourTextField.setVisibility(View.VISIBLE);
    break;        

// do this for all your other ones if you want

case SPINNER_OPTION_LAST:
    yourSpinnerLabel.setVisibility(View.GONE);
    yourTextField.setVisibility(View.GONE); 
```

也许不是最有效的，但它有效，所以我希望能有所帮助（还是新的，所以让我放松一下）！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-21T19:25:29.137

修改保存数据的列表可能会导致大量错误或难以管理数据。您可以使用 NONE 项目在适配器中添加项目，而不是操作列表。像这样

```
 ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item);
    adapter.add("NONE");
    adapter.addAll(products);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    mSpinner.setAdapter(adapter); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2015-02-19T13:30:21.820

我试过

```
// getSelectedItemPosition() returns -1 if there is nothing selected
spinner.setSelection(-1); 
```

但它失败了[微调器正在设置列表中的第一个元素]。

我在模拟“未选择任何内容”的微调器数据中添加了“空位置”。请注意，“空位”在“下拉”列表中不可见。

顺便提一句。对不起 C#，希望这个概念清晰可见。

自定义适配器：

```
class CustomAdapter<T> : ArrayAdapter<T> {
    public override int Count {
        get { return base.Count - 1; }
    }
} 
```

初始化微调器：

```
var data = new List<string> { "elem 1", "elem 2", "" };
spinner.Adapter = new CustomAdapter<String>(this, Resource.Layout.SimpleSpinnerItem, data);
spinner.SetSelection(2); 
```

# ruby - 在 Windows 上安装 Chef 服务器

> ID：12098330
> 
> 赞同：2
> 
> 时间：2012-08-23T18:59:25.693
> 
> 标签：ruby, windows, gem, chef-infra

我正在尝试在 Windows 2008 Server 机器上启动和运行 Chef Server。

我在这里关注这个过程： [http ://wiki.opscode.com/display/chef/Installing+Chef+Server+Manually](http://wiki.opscode.com/display/chef/Installing+Chef+Server+Manually)

我刚刚安装了 Gecode，下一步是 ruby​​ 命令：

`gem install chef-server chef-server-api chef-server chef-solr`

但是，运行此命令会给出以下输出，表明未安装 Gecode。

```
C:\Users\Administrator>gem install chef-server chef-server-api chef-server chef-
solr
Temporarily enhancing PATH to include DevKit...
Building native extensions.  This could take a while...
ERROR:  Error installing chef-server:
        ERROR: Failed to build gem native extension.

        C:/opscode/chef/embedded/bin/ruby.exe extconf.rb
checking for main() in -lgecodesearch... no
================================================================================
=========
Gecode >3.5 must be installed (http://www.gecode.org/).

OSX:
  brew install gecode

For convenience, we have built Gecode for Debian/Ubuntu (<release> is lucid or m
averick):
  Add the following two lines to /etc/apt/sources.list.d/opscode.list:
    deb http://apt.opscode.com <release> main
    deb-src http://apt.opscode.com <release> main
  Then run:
    curl http://apt.opscode.com/packages@opscode.com.gpg.key | sudo apt-key add
-
    sudo apt-get update
    sudo apt-get install libgecode-dev

Other distributions can build from source.
================================================================================
=========
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
        --with-opt-dir
        --without-opt-dir
        --with-opt-include
        --without-opt-include=${opt-dir}/include
        --with-opt-lib
        --without-opt-lib=${opt-dir}/lib
        --with-make-prog
        --without-make-prog
        --srcdir=.
        --curdir
        --ruby=C:/opscode/chef/embedded/bin/ruby
        --with-gecodesearchlib
        --without-gecodesearchlib
extconf.rb:57:in `<main>': Gecode not installed (RuntimeError)

Gem files will remain installed in C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/
gems/dep_selector-0.0.8 for inspection.
Results logged to C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/dep_selector
-0.0.8/ext/dep_gecode/gem_make.out
Building native extensions.  This could take a while...
ERROR:  Error installing chef-server-api:
        ERROR: Failed to build gem native extension.

        C:/opscode/chef/embedded/bin/ruby.exe extconf.rb
checking for main() in -lgecodesearch... no
================================================================================
=========
Gecode >3.5 must be installed (http://www.gecode.org/).

OSX:
  brew install gecode

For convenience, we have built Gecode for Debian/Ubuntu (<release> is lucid or m
averick):
  Add the following two lines to /etc/apt/sources.list.d/opscode.list:
    deb http://apt.opscode.com <release> main
    deb-src http://apt.opscode.com <release> main
  Then run:
    curl http://apt.opscode.com/packages@opscode.com.gpg.key | sudo apt-key add
-
    sudo apt-get update
    sudo apt-get install libgecode-dev 
```

我使用默认选项安装了 3.7.3 版。

有人知道我该如何继续吗？我对 Ruby 或 Gecode 一无所知。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T23:27:18.350

Windows 不支持 Chef 服务器。

# python - 光栅化 matplotlib 中的多个元素

> ID：12098331
> 
> 赞同：12
> 
> 时间：2012-08-23T18:59:36.943
> 
> 标签：python, matplotlib

`rasterized=True`在使用 pdf 输出的关键字对绘图中的多行进行光栅化时遇到问题。一些版本信息：

*   matplotlib 版本 1.1.1rc
*   Ubuntu 12.04
*   蟒蛇2.7.3

这是一个演示我的问题的基本示例：

```
# Import matplotlib to create a pdf document
import matplotlib
matplotlib.use('Agg')
from matplotlib.backends.backend_pdf import PdfPages
pdf = PdfPages('rasterized_test.pdf')

import matplotlib.pylab as plt

# some test data
import numpy as np
ts = np.linspace(0,2*np.pi,100) * np.ones((200,100)) 
ts += (np.linspace(0, np.pi, 200)[np.newaxis] * np.ones((100,200))).T
ys = np.sin(ts)

fig = plt.figure() 
ax = fig.add_subplot(111)
ax.plot(ts[0], ys.T, color='r', lw=0.5, alpha=0.5, rasterized=True)
pdf.savefig()

pdf.close() 
```

从本质上讲，我有很多（在这种情况下为 200 条）紧密重叠的线，这使得生成的图形（未光栅化）过于难以加载。我想光栅化这些线，这样轴标签（和绘图的其他元素，未显示）保持矢量，而解决方案轨迹被展平为单个光栅背景。但是，使用上面的代码，图像仍然需要很长时间才能加载，因为每个轨迹都是独立光栅化的，从而产生了多个图层。（如果我用像inkscape这样的程序打开生成的pdf，我可以独立地操纵每个轨迹。）

是否可以将所有光栅化元素扁平化为单层，因此 pdf 大小会大大减小？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-24T03:43:16.790

将代码更改为：

```
ax = fig.add_subplot(111, rasterized=True)
ax.plot(ts[0], ys.T, color='r', lw=0.5, alpha=0.5) 
```

# python - 使用 Python 和 Rest 查询 Jira

> ID：12098333
> 
> 赞同：4
> 
> 时间：2012-08-23T18:59:39.883
> 
> 标签：python, rest, jira

我想提取 jira-users 组中的用户列表。据我了解，它可以通过 Python 使用 restkit 来完成。

有没有人有任何示例或链接可以举例说明？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-01-13T09:53:39.720

如果有人仍然需要解决方案，您可以安装 JIRA rest api lib [https://pypi.python.org/pypi/jira/](https://pypi.python.org/pypi/jira/)。只是您问题的一个简单示例：

```
from jira.client import JIRA

jira_server = "http://yourjiraserver.com"
jira_user = "login"
jira_password = "pass"

jira_server = {'server': jira_server}
jira = JIRA(options=jira_server, basic_auth=(jira_user, jira_password))

group = jira.group_members("jira-users")
for users in group:
    print users 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T20:11:00.013

Jira 有一个用于外部查询的 REST API，它使用 HTTP 协议进行请求和响应，并且响应内容形成为 JSON。因此，您可以使用 python`urllib`和`json`包来运行请求，然后解析结果。

这是 Atlassian 的 Jira REST API 文档：[http://docs.atlassian.com/jira/REST/latest/](http://docs.atlassian.com/jira/REST/latest/)，例如检查用户 API：[http ://docs.atlassian.com/jira/REST/latest/# id120322](http://docs.atlassian.com/jira/REST/latest/#id120322)

考虑到您应该在发送请求之前进行身份验证，您可以在文档中找到必要的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-20T01:50:36.283

```
import urllib2, base64
import requests
import ssl
import json
import os
from pprint import pprint
import getpass

UserName = raw_input("Ener UserName: ")
pswd = getpass.getpass('Password:')

# Total number of users or licenses used in JIRA. REST api of jira can take values of 50 incremental
ListStartAt = [0,50,100,150,200,250,300]
counter = 0
for i in ListStartAt:
    request = urllib2.Request("https://jiraserver.com/rest/api/2/group/member?groupname=GROUPNAME&startAt=%s" %i)

    base64string = base64.encodestring('%s:%s' % (UserName, pswd)).replace('\n', '')
    request.add_header("Authorization", "Basic %s" % base64string) 
    gcontext = ssl.SSLContext(ssl.PROTOCOL_TLSv1)
    result = urllib2.urlopen(request, context=gcontext)

    JsonGroupdata = result.read()
    jsonToPython = json.loads(JsonGroupdata)

    try:
        for i in range (0,50):
            print jsonToPython["values"][i]["key"]
            counter = counter+1
    except Exception as e:
        pass
print counter 
```

# uml - 用作用例的序列图

> ID：12098339
> 
> 赞同：0
> 
> 时间：2012-08-23T19:00:14.293
> 
> 标签：uml, diagrams

有没有人见过用作用例的序列图？我从来没有，它真的让我头疼。在我目前的公司，在所有文档和讨论中，术语“用例”用于标记序列图。我已经问过几次有关这种做法的问题，并且看起来很有趣，这看起来很正常。- 从 1990 年代后期开始，当 UML 首次（相当）被广泛讨论时，我一直是一名软件工程师并使用了很长时间。我不希望改变公司文化。我只是想问这种做法是否在其他任何地方以及相关评论中使用。- 谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T06:47:50.330

序列图通常用于描述具有通信的动作流示例。因此，序列图非常适合显示用例的示例。出于这个原因，将这样的图称为“用例”是正常的。

因此，您将为每个用例绘制多个序列图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:08:19.727

在我的大学里，我们了解到用例图和序列图都是不同的图，具有不同的含义。以我的经验，我从未听说有人将序列图称为用例图，反之亦然，所以我想这只是公司文化......

# openerp - 在 OpenERP 中，我如何确定采购中的库存如何分配给哪些制造订单？

> ID：12098340
> 
> 赞同：1
> 
> 时间：2012-08-23T19:00:14.683
> 
> 标签：openerp

# 概括

在我即将收到的一批原材料不足以满足我所有的发货和生产订单的情况下，我如何预测这些原材料将分配到哪些发货和生产订单？

# 细节

我有一个新的测试数据库，我做了以下操作：

## 设置

1.  创建要生产的产品，make_to_stock，（例如，“内阁”）
2.  创建要购买的产品，make_to_stock，（例如，'Wood'）
3.  将 BOM 添加到包含单个 BOM 行、一个“Wood”的橱柜产品
4.  将供应商添加到内阁
5.  添加一个订单点以将 Wood 的 VA 保持为零（即永远不要保留库存）

## 过程

1.  为内阁创建采购请求
2.  运行采购
3.  采购为橱柜创建了一个MO，找到了BOM，并为橱柜和木材创建了几条移动线，并为每个产品创建了一个采购
4.  确认从 MO 采购 Wood，并观察它是否进入异常状态。

此时，系统中有四种股票走势：

```
1\. Cabinet Stock->Stock, from initial procurement, in state 'confirmed' (waiting on #2)
2\. Cabinet Production->Stock, from MO, in state 'waiting' (waiting on #3)
3\. Wood Stock->Production, to be consumed by MO, in state 'waiting' (waiting on #4)
4\. Wood Stock->Stock, procurement reservation from MO input, in state 'exception' (no stock found) 
```

现在，继续：

1.  运行调度程序。这会为 Wood 创建一个新的采购，因为 VA < 0，基于我们定义的 orderpoint。它还确认并运行该采购，为 Wood 创建新的采购订单并设置草稿库存移动。
2.  确认将分配库存移动的采购订单。
3.  正是在这一点上，我们将等待木材交付。去接收产品，并确认库存移动。

此时，四个股票走势处于相同状态，Wood还有两个额外的，一个来自Suppliers->Stock，一个来自Stock->Stock。在最后一步中，我们确认进入 Stock->Stock。

目前我们有 1 个木材库存，1 个木材采购由于库存不足而异常。

我的问题是，我怎样才能确定这些木材将来会分配到哪里？如果这不可能（似乎不可能），那么在重试采购并看到它成功之后，我怎么知道最初分配库存移动的位置？

为了明确为什么需要这样做，我们将交付几种产品，我们希望将它们实际放置在库存中或直接放置在需要它的机器前面。也就是说，我们希望能够直接跟踪交货库存的移动，尽管它是在 MO 中分配的插槽。

作为参考，以下是重试木材采购后库存变动的情况：

```
#Initial Procurement
37787: 1.0 Base Cabinet (copy) [Stock -> Stock] (confirmed waiting for 37788) (procured from 16580)
#MO final product
37788: 1.0 Base Cabinet (copy) [Production -> Stock] (waiting waiting for 37789) (finished product of MO 7433)
#MO source product (has move history with 37790)
37789: 1.0 1/2ChinFPly1s (copy) [Stock -> Production] (assigned waiting for 37790) (to be consumed by 7433)
#Procurement for input, waiting for something in stock
37790: 1.0 1/2ChinFPly1s (copy) [Stock -> Stock] (done) (procured from 16581)

#------------------------------
#------------------------------

#Procurment from Orderpoint, putting something in stock (has move history with 37794)
37791: 1.0 1/2ChinFPly1s (copy) [Stock -> Stock] (done waiting for 37794) (procured from 16582)
37794: 1.0 1/2ChinFPly1s (copy) [Suppliers -> Stock] (done) (final move of PO line 3) 
```

似乎没有任何方法可以将前四个动作与后两个动作联系起来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T09:19:31.257

在 core openerp 中，没有任何功能可以告诉您从哪个订单分配给哪个订单的库存。您必须在互联网上实施或搜索可以帮助您的 fifo lifo 模块。供参考：[http ://www.youtube.com/watch?v=DfoxZLxagXQ](http://www.youtube.com/watch?v=DfoxZLxagXQ)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T19:51:37.043

看起来计划中较早的采购将优先选择您刚刚收到的任何货物。您可以通过在 MRP 计划程序运行之前手动重新运行采购或调整`date_planned`采购字段来覆盖它。

MRP 调度程序在收到您的货物后下次运行时，它将遍历所有处于异常状态的采购并尝试重新启动它们。在[调度程序代码](http://bazaar.launchpad.net/~openerp/openobject-addons/6.1/view/head:/procurement/schedulers.py#L64)中，您可以看到它按顺序处理它们`date_planned`。

```
if not ids:
    ids = procurement_obj.search(cr, 
                                 uid, 
                                 [('state', '=', 'exception')], 
                                 order="date_planned")
for id in ids:
    wf_service.trg_validate(uid, 'procurement.order', id, 'button_restart', cr) 
```

# iphone - 如何减小具有更多高质量音频文件的 iPhone 应用程序的大小？

> ID：12098342
> 
> 赞同：1
> 
> 时间：2012-08-23T19:00:31.093
> 
> 标签：iphone, ios5, ios4, audio-streaming

我正在开发与冥想相关的应用程序。因为有很多高质量的 .mp3 文件，这就是为什么应用程序大小增加得更接近 2GB。我搜索了压缩，但找不到音频文件，但 xcode 仅支持 .png 文件。

如果有人对此有所了解，请建议我。

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T18:41:14.560

MP3 是有损压缩。如果您愿意接受有损文件，MP3 的压缩效果要比使用常规数据压缩算法（例如 gzip）获得的要好得多。

我的建议是获取原始文件并使用 AAC 重新压缩，降低到使您的应用程序大小可以接受的比特率。AAC 在较低比特率下听起来更好，并且从原始压缩意味着您不会从已经有损压缩的 MP3 文件中获得任何伪影。

# asp.net-mvc - MVC WebApi 不使用 AutofacWebApiDependencyResolver

> ID：12098346
> 
> 赞同：10
> 
> 时间：2012-08-23T19:00:49.940
> 
> 标签：asp.net-mvc, asp.net-web-api, autofac

我有一个混合的 MVC 4 应用程序，其中一些控制器是常规实现，`Controller`而一些控制器是`ApiController`. 我也在使用 Autofac 进行 DI，但似乎 WebApi 控制器“激活器”机器（缺少更具体的术语）没有使用 Autofac 解析器（`AutofacWebApiDependencyResolver`），这导致我发出请求时抛出异常针对我的一个 api 控制器。这是错误：

```
<Error>
    <Message>An error has occurred.</Message>
    <ExceptionMessage>
        Type 'MyApp.Areas.Api.Controllers.MyController' does not have a default constructor
    </ExceptionMessage>
    <ExceptionType>System.ArgumentException</ExceptionType>
    <StackTrace>
        at System.Linq.Expressions.Expression.New(Type type) 
        at System.Web.Http.Internal.TypeActivator.Create[TBase](Type instanceType) 
        at System.Web.Http.Dispatcher.DefaultHttpControllerActivator.GetInstanceOrActivator(HttpRequestMessage request, Type controllerType, Func`1& activator) 
        at System.Web.Http.Dispatcher.DefaultHttpControllerActivator.Create(HttpRequestMessage request, HttpControllerDescriptor controllerDescriptor, Type controllerType)
    </StackTrace>
</Error> 
```

这是我的设置方式：

```
DependencyResolver.SetResolver(new AutofacDependencyResolver(container));
System.Web.Http.GlobalConfiguration.Configuration.DependencyResolver = new AutofacWebApiDependencyResolver(container); 
```

我对 Autofac.WebApi 集成的理解是，以上是让 WebApi 使用 Autofac 解析器的唯一要求，那么可能会发生什么？

*旁注*：我能想到的唯一愚蠢的部分可能是我在 MVC 区域中有 WebApi 控制器，该控制器不支持`DefaultHttpControllerSelector`，因此实现了一个自定义控制器（相对于[Andrew Malkov](http://netmvc.blogspot.com/2012/06/aspnet-mvc-4-webapi-support-areas-in.html%20%22Andrew%20Malkov%22%29)） . 不过，我不认为这会对解析器产生任何影响，因为选择器只返回一个稍后在激活中使用的类型。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-24T06:30:39.727

要为 Web.API 设置 Autofac，您需要做两件事：

1.  注册 Autofac 依赖解析器（在 App_Start 中）：

    ```
    GlobalConfiguration.Configuration.DependencyResolver = 
        new AutofacWebApiDependencyResolver(container); 
    ```

2.  并通过以下调用在容器构建器中注册您的 Api 控制器：

    ```
    containerBuilder.RegisterApiControllers(Assembly.GetExecutingAssembly()); 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:26:05.940

也许这个博客可以帮助你：http: [//blogs.msdn.com/b/roncain/archive/2012/07/16/dependency-injection-with-asp-net-web-api-and-autofac.aspx](http://blogs.msdn.com/b/roncain/archive/2012/07/16/dependency-injection-with-asp-net-web-api-and-autofac.aspx)

# c# - c#快速排序算法的问题

> ID：12098353
> 
> 赞同：0
> 
> 时间：2012-08-23T19:01:21.877
> 
> 标签：c#, sharepoint, sorting

我创建了两个使用冒泡排序对列表进行排序的函数，但我想将排序样式更改为快速排序。

我发现了这个快速排序算法

[http://snipd.net/quicksort-in-c](http://snipd.net/quicksort-in-c)

这是我的两个功能：

```
 protected void sort_by_section_name()
    {
        int num1, num2;
        for (var i = section_names.Count - 1; i > 0; i -= 1)
        {
            for (var j = 0; j < i; j += 1)
            {
                num1 = get_number_from_section(section_names[j]);
                num2 = get_number_from_section(section_names[j + 1]);
                if (num1 > num2)
                {
                    swap_list_strings(section_names, j, j + 1);
                    swap_object_items(item_group_list, j, j + 1);
                }
            }
        }
    }

    protected void sort_items()
    {
        int num1, num2;
        List<SPListItem> temp;
        for (var k = 0; k < item_group_list.Count; k += 1)
        {
            temp = (List<SPListItem>)item_group_list[k];
            for (var i = temp.Count - 1; i > 0; i -= 1)
            {
                for (var j = 0; j < i; j += 1)
                {
                    num1 = Convert.ToInt32((temp[j])[ORDER_BY_COLUMN]);
                    num2 = Convert.ToInt32((temp[j + 1])[ORDER_BY_COLUMN]);
                    if (num1 > num2)
                    {
                        swap_list_items(temp, j, j + 1);
                    }
                }
            }
        }
    } 
```

对于 sort_items，它是一个数组数组，所以冒泡排序的东西在一个 for 循环中。

我不明白如何将这两个功能更改为使用快速排序。

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:19:39.917

您无需在 .NET 中自己编写 - 您可以使用：

1.  [Array.Sort](http://msdn.microsoft.com/en-us/library/system.array.sort%28v=vs.71%29.aspx)用于基本项目数组
2.  LINQ -以[OrderBy](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.orderby.aspx)为例`List<string>`（确保在类的顶部使用 System.Linq）
3.  如果您喜欢冒险，请查看[IComparable](http://msdn.microsoft.com/en-us/library/system.icomparable.aspx)
4.  使用 myItems.Sort() 对它们进行就地排序。

对于您想要的，最简单的入门方法是使用 #2，这是一个示例：

```
List<SPListItem> myItems = GetSomeItems();
myItems = myItems.OrderBy(i => i["MyField"]).ToList();

foreach (var item in sortedItems)
    Console.WriteLine(item); 
```

在不知道您所追求的字段或关于 Sharepoint 对象的很多信息的情况下，在 .NET 中有大约 5 种不同的方法可以使用可比较的接口（更多信息[here](http://www.yetanotherchris.me/home/2009/9/27/icomparable-icomparer-equals-iequatablelttgt-iequalitycompar.html)）。由于您无法更改 SPListItem 类，因此 Sort 或 LINQ 可能最简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:22:13.147

所以你有一个`List<SPListItem>`并且你希望它们排序，使用基于某个字段的数值的有效排序算法（又名不是冒泡排序）。这很容易，并且不需要您重新实现快速排序。

```
List<SPListItem> list = ...;

var sortedData = list.OrderBy(item => Convert.ToInt32(item["fieldName"])); 
```

还值得注意的是，如果可能，通常最好在数据库上对数据进行排序，而不是在网络服务器上。您应该能够向`Order By`生成这些`SPListItem`s 的 CAML 查询添加一个子句并让它进行排序。

您似乎正在对两个“并行”的不同数据结构进行排序（两个结构的相同索引处的项目“属于”在一起）。这通常是不可取的。虽然有多种方法可以对这两种结构进行排序，但您真正应该做的是制作一个单一结构，以便每个项目都包含逻辑上代表该项目的所有内容。在许多情况下，这意味着创建一个新的`class`，它具有每个数据的属性。然后，您可以填充这个新复合类的集合并对其进行排序。

# regex - 如何使用正则表达式匹配两个变量的相等性？

> ID：12098354
> 
> 赞同：0
> 
> 时间：2012-08-23T19:01:28.733
> 
> 标签：regex

我有这样的线条：

```
1/1
3/5
5/5
7/10 
```

有没有办法匹配左侧数字与右侧数字匹配的行？

也就是说，我需要匹配第 1/1 行和第 5/5 行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T19:04:25.387

您可以使用[反向引用](http://www.regular-expressions.info/brackets.html#usebackrefinregex)：

```
^(\d+)/\1$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:06:16.493

这应该可以解决问题：

```
^(\d+)/\1$ 
```

我们匹配组中的 1 个或多个数字，然后坚持它们也出现在斜线之后。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:06:31.673

假设 match.txt 包含您的输入，并且您在 bash shell 中，

```
猫比赛.txt | sed -e 's+\(.*\)/\(.*\)+if [ \1 = \2 ]; 然后回显 \1/\2; 菲+' | 嘘

```

# python - 每当 GAE/Python 应用程序中有新会话时，如何触发函数？

> ID：12098358
> 
> 赞同：0
> 
> 时间：2012-08-23T19:01:46.957
> 
> 标签：python, google-app-engine

我是 Google App Engine 和 Python 的新手。

每当新用户访问该站点（无论他们最初访问哪个页面）时，我都想在 SessionSupplemental 表（种类）中创建一个条目。

我怎样才能做到这一点？

我可以想象在 GAE 中有一个标准事件触发器列表；我在哪里可以找到这些记录？我也可以想象有很多系统/应用程序属性；我在哪里可以找到这些文档以及如何使用它们？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T21:14:33.543

我想在这里很笼统，因为我不知道您是否使用默认用户服务，也不知道您如何将 SessionSupplemental 实体唯一地链接到用户，或者您是否有办法识别用户在此刻。我还假设您使用的是某个版本的 webapp，因为它是 App Engine 上的标准请求处理库。让我知道更多，我可以更新答案以更具体。

*   使用新类（例如 MyRequestHandler）子类化 webapp 中的默认 RequestHandler。
*   在您的子类中覆盖 initialize() 方法。
*   在您的新 initialize() 方法中，从您的会话系统（或用户服务或您正在使用的任何东西）获取当前用户。测试以查看该用户是否已存在 SessionSupplemental 实体，如果不存在则创建一个新实体。
*   对于所有其他请求处理程序，您现在想要继承 MyRequestHandler（而不是默认的 RequestHandler）。
*   每当请求发生时，webapp 都会自动调用 initialize() 方法。
*   这将花费您对每个请求的读取以及对新用户的每个请求的写入。如果您使用 ndb 库（而不是 db），那么很多请求只会命中 memcache 而不是数据存储。

现在，如果您刚刚开始创建新的 AppEngine 应用程序，我建议您使用 Python27 运行时和 webapp2 并尝试尽可能多地利用 webapp2 Auth 模块，这样您就不必自己编写太多会话内容。此外，ndb 可以比默认的 db 库好得多。

# ruby-on-rails - rails 3 routing 为帖子保留自定义 url

> ID：12098360
> 
> 赞同：0
> 
> 时间：2012-08-23T19:01:49.390
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-routing, rails-flash

我对 Rails 相当陌生，如果出现错误并且呈现“新”模板，我希望为登录的用户保持相同的 url

这是我的路线

```
resources :users, only: [:new, :create]
resources :sessions, only: [:new, :create, :destroy]

root to: 'pages#home'

match '/signin', to: 'sessions#new'
#match '/signin', to: 'sessions#create', via: :post, as: :post_session
match '/logout', to: 'sessions#destroy' 
```

这是会话控制器代码

```
def new
end

def create
    user = User.find_by_email(params[:session][:email])
    if user && user.authenticate(params[:session][:password])
        sign_in user
        redirect_to root_url
    else
        flash.now[:error] = 'Invalid email or password'
        render 'new'
    end
end 
```

正如你所看到的，我有一个自定义路由注释掉来捕捉帖子，以便渲染“新”调用保留 /signin url，但是当我这样做时，错误的 flash 消息不会在页面中呈现（它虽然没有那条路线）。我尝试在没有 now 方法的情况下使用 flash，但仍然没有看到我的消息显示。有任何想法吗？

编辑：

我尝试了以下建议，但仍然发现问题。查看访问日志后，应用程序正在路由到第一个登录路由，因为它是用 match 定义的，而不是 get。我的更新和工作路线文件现在看起来像这样

```
resources :users, only: [:new, :create]
#resources :sessions, only: [:new, :create, :destroy]

root to: 'pages#home'

match '/signin', to: 'sessions#new', via: :get
match '/signin', to: 'sessions#create', via: :post, as: :post_session
match '/logout', to: 'sessions#destroy', via: :delete 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:03:51.143

拿出现在，那不应该是必要的。您的路线可能有冲突。根据您设置匹配线的方式，您可以`resources :sessions`完全删除匹配线，然后取消注释匹配线。那应该照顾你所需要的。

此外，请确保返回您的其他问题并接受一些答案。0% 的接受率不太可能吸引答案。

**编辑**

根据您的评论，当您删除资源调用时，它可能只是不知道此时要呈现什么。尝试更改为：

```
render "sessions/new" 
```

# opencv - 测试基本矩阵

> ID：12098363
> 
> 赞同：4
> 
> 时间：2012-08-23T19:02:04.133
> 
> 标签：opencv, computer-vision, openframeworks, camera-calibration

我的问题是：

*   如何确定我的基本矩阵是否正确？
*   我在下面发布的代码是否对此做出了很好的努力？

我的最终目标是进行某种 3D 重建。现在我正在尝试计算基本矩阵，以便我可以估计两个相机之间的差异。我在 openFrameworks 中使用 ofxCv 插件执行此操作，但在大多数情况下，它只是纯粹的 OpenCV。由于 ofxCv 也在开发中，因此很难发布隔离问题的代码。

我的代码基本上读取了我的网络摄像头从稍微不同的位置拍摄的两个 640x480 帧（基本上只是水平滑动笔记本电脑一点点）。我已经有一个校准矩阵，它是从 ofxCv 的校准代码中获得的，它使用`findChessboardCorners`. 不失真示例代码似乎表明校准矩阵是准确的。它计算图片（`calcOpticalFlowPyrLK`或`calcOpticalFlowFarneback`）之间的光流，并将这些点对馈送到`findFundamentalMatrix`。

为了测试基本矩阵是否有效，我将其分解为旋转和平移矩阵。然后我将旋转矩阵乘以第二张图像的点，看看相机之间的旋转差异是多少。我认为任何差异都应该很小，但我得到了很大的差异。

这是我最后一个代码的基本和旋转矩阵，如果有帮助的话：

```
fund: [-8.413948689969405e-07, -0.0001918870646474247, 0.06783422344973795;
    0.0001877654679452431, 8.522397812179886e-06, 0.311671691674232;
    -0.06780237856576941, -0.3177275967586101, 1]
R: [0.8081771697692786, -0.1096128431920695, -0.5786490187247098;
    -0.1062963539438068, -0.9935398408215166, 0.03974506055610323;
    -0.5792674230456705, 0.02938723035105822, -0.8146076621848839]
t: [0, 0.3019063882496216, -0.05799044915951077;
    -0.3019063882496216, 0, -0.9515721940769112;
    0.05799044915951077, 0.9515721940769112, 0] 
```

这是我的部分代码，发生在拍摄第二张照片之后：

```
const ofImage& image1 = images[images.size() - 2];
const ofImage& image2 = images[images.size() - 1];

std::vector<cv::Point2f> points1 = flow->getPointsPrev();
std::vector<cv::Point2f> points2 = flow->getPointsNext();

std::vector<cv::KeyPoint> keyPoints1 = convertFrom(points1);
std::vector<cv::KeyPoint> keyPoints2 = convertFrom(points2);

std::cout << "points1: " << points1.size() << std::endl;
std::cout << "points2: " << points2.size() << std::endl;

fundamentalMatrix = (cv::Mat)cv::findFundamentalMat(points1, points2);
cv::Mat cameraMatrix = (cv::Mat)calibration.getDistortedIntrinsics().getCameraMatrix();
cv::Mat cameraMatrixInv = cameraMatrix.inv();
std::cout << "fund: " << fundamentalMatrix << std::endl;

essentialMatrix = cameraMatrix.t() * fundamentalMatrix * cameraMatrix;

cv::SVD svd(essentialMatrix);
Matx33d W(0,-1,0,   //HZ 9.13
          1,0,0,
          0,0,1);

cv::Mat_<double> R = svd.u * Mat(W).inv() * svd.vt; //HZ 9.19

std::cout << "R: " << (cv::Mat)R << std::endl;
Matx33d Z(0, -1, 0,
          1, 0, 0,
          0, 0, 0);
cv::Mat_<double> t = svd.vt.t() * Mat(Z) * svd.vt;
std::cout << "t: " << (cv::Mat)t << std::endl;

Vec3d tVec = Vec3d(t(1,2), t(2,0), t(0,1));

Matx34d P1 = Matx34d(R(0,0),    R(0,1), R(0,2), tVec(0),
                     R(1,0),    R(1,1), R(1,2), tVec(1),
                     R(2,0),    R(2,1), R(2,2), tVec(2));
ofMatrix4x4 ofR(R(0,0),    R(0,1), R(0,2), 0,
                R(1,0),    R(1,1), R(1,2), 0,
                R(2,0),    R(2,1), R(2,2), 0,
                0, 0, 0, 1);
ofRs.push_back(ofR);

cv::Matx34d P(1,0,0,0,
              0,1,0,0,
              0,0,1,0);

for (int y = 0; y < image1.height; y += 10) {
    for (int x = 0; x < image1.width; x += 10) {
        Vec3d vec(x, y, 0);

        Point3d point1(vec.val[0], vec.val[1], vec.val[2]);
        Vec3d result = (cv::Mat)((cv::Mat)R * (cv::Mat)vec);
        Point3d point2 = result;

        mesh.addColor(image1.getColor(x, y));
        mesh.addVertex(ofVec3f(point1.x, point1.y, point1.z));

        mesh.addColor(image2.getColor(x, y));
        mesh.addVertex(ofVec3f(point2.x, point2.y, point2.z));
    }
} 
```

有任何想法吗？我的基本矩阵看起来是正确的，还是我在测试它时有错误的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T06:00:59.130

如果你想知道你的基本矩阵是否正确，你应该计算误差。使用极线约束方程，您可以检查一张图像中检测到的特征与另一张图像的极线有多接近。理想情况下，这些点积的总和应为 0，因此，校准误差计算为绝对距离之和 (SAD)。SAD 的平均值报告为立体校准误差。基本上，您正在从相应的极线计算 image_left （可能是棋盘角）中的计算特征的 SAD。此误差以像素 ^ 2 为单位，低于 1 的任何值都是可以接受的。

OpenCV 有代码示例，请查看 Stereo Calibrate cpp 文件，它向您展示了如何计算此错误。 [https://code.ros.org/trac/opencv/browser/trunk/opencv/samples/c/stereo_calib.cpp?rev=2614](https://code.ros.org/trac/opencv/browser/trunk/opencv/samples/c/stereo_calib.cpp?rev=2614) 查看“avgErr”第 260-269 行

安库尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-26T17:21:38.930

我写了一个python函数来做到这一点：

```
def Ferror(F,pts1,pts2):  # pts are Nx3 array of homogenous coordinates.  
    # how well F satisfies the equation pt1 * F * pt2 == 0
    vals = pts1.dot(F).dot(pts2.T)
    err = np.abs(vals)
    print("avg Ferror:",np.mean(err))
    return np.mean(err) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-04T09:14:15.487

我认为您在使用 then 计算 F 之前没有删除不正确的匹配项。此外，我对如何验证 F 有一个想法，从 x'Fx=0，您可以替换公式中的几个 x' 和 x。

凯尔范

# javascript - JQuery 自动元标记描述

> ID：12098364
> 
> 赞同：0
> 
> 时间：2012-08-23T19:02:06.633
> 
> 标签：javascript, jquery

我正在尝试获取第一个类并将相同的文本应用到元描述中，但是元没有加载到 var get 中。有人可以看一下并调试吗？

谢谢！

```
$(document).ready(function() {
// add the class of first to any element to get the meta data to populate
var get = $('.first').html();
var myclone = $('meta[name=description]').attr("content");
$(get).appendTo(myclone);
//alert(get);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:11:10.697

我得到你想要做的，但我**不会**推荐它。您不能指望搜索引擎来运行您的 javascript，因此除非您将描述元信息用于与搜索引擎描述您的页面内容完全无关的内容，否则您可能会尝试在这里做一些浪费精力的事情。您的描述应该以原始 HTML 形式返回，而不是从 javascript 呈现。

话虽如此，如果你真的想继续做你正在做的事情......

```
$('meta[name=description]').attr("content", $('.first').text()); 
```

# db2 - 计算模式 - “最高频率行” DB2

> ID：12098370
> 
> 赞同：1
> 
> 时间：2012-08-23T19:02:36.087
> 
> 标签：db2

在 DB2 中使用连接计算跨表模式的最有效方法是什么？

我试图在给定日期获取给定列（ID - 连接表的候选键）的频率（计数）最高的值。

这个想法是从表中获取最常见的（值），该表对于某些帐户（对于相同的 ID 和日期）具有不同的（值）。我们需要使它在另一个表中使用是唯一的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:59:46.970

您可以使用由 表示的公用表表达式 [CTE's]`WITH`将逻辑分解为逻辑步骤。首先，我们将构建摘要行，然后为每个组中的行分配排名，然后挑选出记录数最多的行。

假设我们想知道每种商品的哪种口味在每个日期最常销售（也许假设记录是第一数量）。

```
WITH s as
( 
  SELECT itemID, saleDate, flavor, count(*) as tally
    FROM sales
    GROUP BY itemID, saleDate, flavor
), r as
( 
  SELECT itemID, saleDate, flavor, tally, 
         RANK() OVER (PARTITION BY itemID, saleDate ORDER BY tally desc) as pri
    FROM s
)
SELECT itemID, saleDate, flavor, tally
  FROM r
  WHERE pri = 1 
```

这里的名称“s”和“r”指的是它们各自 CTE 的结果集。然后可以使用这些名称来表示语句的另一部分中的表。

pri 列将在 itemID 和 saleDate 窗口内的第一部分“s”的摘要行上具有计数值的 RANK()。Tally 是递减的，因为我们首先想要最大值，这将获得 RANK() 为 1。然后在主 SELECT 中，我们只需选择那些在其分区中排在首位的摘要记录。

通过使用 RANK() 或 DENSE_RANK()，我们可以获得 itemID、saleDate 的多个风味，如果它们并列第一。这可以通过将 RANK() 替换为 ROW_NUMBER() 来消除，但它会任意选择一种并列的口味作为获胜者，这可能不是手头问题的正确答案。

如果我们在表中有一个销售数量列，我们可以将 COUNT(*) 替换为 SUM(salesqty) 并找出销量最多的产品。

# jquery - 阻止元素滚动到jQuery中的某个点

> ID：12098374
> 
> 赞同：1
> 
> 时间：2012-08-23T19:02:47.057
> 
> 标签：jquery, html, css, scroll

我目前正在为这个开发网站构建一个滚动共享栏：http: [//ossian.statenews.com/~matt/statenews-redesign-1.1/docs/article.html](http://ossian.statenews.com/~matt/statenews-redesign-1.1/docs/article.html)

如何让 jQuery 查找“相关故事”div 类并阻止它滚动过去？

这是我到目前为止所拥有的：

```
$(document).ready(function() {

var $sidebar   = $("#sharebox"),
$window    = $(window),
offset     = $sidebar.offset(),
topPadding = 50;

$window.scroll(function() {
if ($window.scrollTop() > offset.top) {
$sidebar.stop().animate({
marginTop: $window.scrollTop() - offset.top + topPadding
});
} else {
$sidebar.stop().animate({
marginTop: 0 

});
}
});
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:38:19.360

所以基本上你只希望滚动分享栏在你向下滚动到那个低点时“粘”到相关的故事上。你已经成功了一半。与您在开始时不滚动共享栏的方式相同，与您在结束时停止滚动的方式相似。

您只需要确定何时要冻结滚动共享。

```
$(document).ready(function() {

  var $sidebar   = $("#sharebox"),
      $window    = $(window),
      offset     = $sidebar.offset(),
      topPadding = 50;

  $window.scroll(function() {
    if($window.scrollTop() > $('.related-stories').offset().top) {
      // basically this is just saying, that if you've scrolled passed the related
      // stories, we are going to force you back in line with them.
      // Edit: This needs to be first because the "else if" case is always true when
      //       this would be true so it never actually fails and calls this code.
      $sidebar.stop().css('marginTop', $('.related-stories').offset().top);
    } else if ($window.scrollTop() > offset.top) {
      $sidebar.stop().animate({
        marginTop: $window.scrollTop() - offset.top + topPadding
      });
    } else {
      $sidebar.stop().animate({
        marginTop: 0 
      });
    }
  });
}); 
```

This should solve the problem for you. The code might be a little off and you may need to play with it a bit. I'll check again if you have any follow up questions but that won't be until this evening. Good luck!

# vb.net - 尝试压缩文件 VB.NET 2003 时出错

> ID：12098377
> 
> 赞同：0
> 
> 时间：2012-08-23T19:02:54.950
> 
> 标签：vb.net, com, zip, visual-studio-2003

我必须使用 Visual Studio 和 VB.NET 2003 制作一个简单的 zip 文件。

经过一番谷歌搜索后，我来到了这个页面：[http](http://www.digioz.com/tutorials/zip_unzip_vbNET/Zip_and_Unzip_VB_NET_1.html) ://www.digioz.com/tutorials/zip_unzip_vbNET/Zip_and_Unzip_VB_NET_1.html基本上为我提供了 3 个 DLL 以及准备压缩文件的类。当我尝试像教程告诉我那样创建类的实例时：

```
Dim zp As New CGZipLibrary.CGZipFiles 
```

我收到此错误：

```
COM object with CLSID {293364BA-43F8-11D3-BC2D-4000000A2806} is either not valid or not registered. 
```

想法？如果有人使用 VB.NET 2003 对 zip 文件有更好/更简单的方法，那也会很有帮助。

谢谢。

**编辑：**

感谢所有回答的人，但我使用了与建议的方法不同的方法来压缩我的文件。我使用了Microsoft.VisualBasic.Interaction 类的[Shell 函数，如下所示：](http://msdn.microsoft.com/en-us/library/xe736fyk%28v=vs.71%29.aspx)

```
Shell("zip -j " & fileName, AppWinStyle.Hide, True) 
```

再次感谢那些致力于帮助我的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:19:33.207

看起来您尝试使用的那个库是一个旧的 COM dll。这意味着您必须先使用 regsvr32.exe 注册 dll，然后才能使用它。但是，我建议使用本机 .NET（托管）库。除非它不能满足您的需要，否则我只是建议您查看`GZipStream`属于 .NET 框架的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:14:44.937

你试过这个吗？这非常好：[ionic.zip.reduced](http://dotnetzip.codeplex.com/)，一个 dotnetzip 库。

例子：

```
Using zip As ZipFile = New ZipFile()
     zip.AddFile("c:\photos\personal\7440-N49th.png")
     zip.AddFile("c:\Desktop\2008_Annual_Report.pdf")
     zip.AddFile("ReadMe.txt")
     zip.Save("MyZipFile.zip")
End Using 
```

[更多 Ionic.ZIP 的 VB.NET 示例](http://dotnetzip.codeplex.com/wikipage?title=VB-Examples&referringTitle=Examples)

更新：

您的问题是 VS2003 无法使用在较新（例如 VS2005）版本的 VS 中创建的 dll 的目标。对于许多尝试使用它的人来说，创建了一个工具，您可以[在此处](http://www.microsoft.com/en-us/download/details.aspx?id=11381)下载。如需更多信息，请访问[此](http://weblogs.asp.net/rmclaws/archive/2004/10/03/237179.aspx)网站。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:36:43.123

我在大多数项目中使用的另一个选项是#ZipLib (SharpZipLib)，可在此处下载：

[http://www.icsharpcode.net/opensource/sharpziplib/Download.aspx](http://www.icsharpcode.net/opensource/sharpziplib/Download.aspx)

VB 和 C# 的文档和示例可在同一站点获得。它具有适用于 .NET 框架 1.1 以及更高版本的特定二进制程序集 (dll)。您遇到的其他一些库很可能是为 .NET 2.0 或更高版本编译的，这在 VS2003 中不起作用。

不要让名字欺骗你——它是用 C# 编写的（因此得名），但编译的程序集在 VB.NET 中工作得很好。它支持 Zip、GZip、tar 和 BZip2 档案。

# wix - WIX 自定义操作作为 32 位进程运行

> ID：12098382
> 
> 赞同：0
> 
> 时间：2012-08-23T19:03:14.683
> 
> 标签：wix, wix3.6

我需要让我的自定义操作作为 x64 位进程运行并使用 Visual Studio 2010。当我运行 msi 时，我在详细日志文件中看到以下条目：

你好，我是你的 32bit Elevated 自定义动作服务器

并且自定义操作由于错误的处理器架构而失败（我通过批处理文件调用 DISM.exe）。我的项目相当简单：

```
 <DirectoryRef Id="APPLICATIONROOTDIRECTORY" >
        <Component Id="Launch.cmd" Guid="{423CD408-F053-496B-8FA7-6C329A2F53BB}" Win64="yes">
            <File Id="Launch.cmd" Name="Launch.cmd" Source="C:\Temp\Build\MSU Wrapper for SCUP\Launch.cmd" KeyPath="yes" Checksum="yes" ProcessorArchitecture="x64"/>
        </Component>
        <Component Id="KB977453.cab" Guid="{E8ABB2AE-6F57-4153-B44C-E1083D6702B1}" Win64="yes">
            <File Id="KB977453.cab" Name="KB977453.cab" Source="C:\Temp\Build\MSU Wrapper for SCUP\KB977453.cab" KeyPath="yes" Checksum="yes" ProcessorArchitecture="x64"/>
        </Component>
    </DirectoryRef>

    <Feature Id="MainApplication" Title="Main Application" Level="1">
        <ComponentRef Id="Launch.cmd" />
        <ComponentRef Id="KB977453.cab" />
    </Feature>

    <CustomAction Id="BatchCmd" Property="BatchRun" Value="&quot;[#Launch.cmd]&quot; KB977453" Execute="immediate"/>
    <CustomAction Id="BatchRun" BinaryKey="WixCA" DllEntry="CAQuietExec" Execute="deferred" Return="check" Impersonate="no" />

    <InstallExecuteSequence>
        <Custom Action="BatchCmd" Before="BatchRun">NOT Installed</Custom>
        <Custom Action="BatchRun" After="InstallFiles">NOT Installed</Custom>
        <ScheduleReboot After="InstallFinalize" />
    </InstallExecuteSequence>

</Product> 
```

我在 Visual Studio 的配置管理器中选择了 x64 版本。有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-20T08:37:29.323

为 x64 自定义操作设置 DllEntry= **"CAQuietExec64"**

[http://wix.sourceforge.net/manual-wix3/qtexec.htm](http://wix.sourceforge.net/manual-wix3/qtexec.htm)

# facebook - Facebook 需要扩展权限：publish_actions

> ID：12098386
> 
> 赞同：4
> 
> 时间：2012-08-23T19:03:27.230
> 
> 标签：facebook, facebook-graph-api, facebook-apps

我正在开发与竞赛和促销相关的 Facebook 应用程序，我的目的是在我公司的页面上创建一个选项卡，以提供对该应用程序的访问。

一旦他们，用户可以提名当地公司获奖。稍后的; 提名完成后，用户可以投票选出获胜者。

我已将 Open Graph 集成到我的应用程序中，以便我可以利用对象类型 ( `Organization`)、操作类型 ( `Nominate`, `Vote For`) 和聚合 ( `Nominations`)。我的主要目标是然后将这些操作转移到用户的时间线上。

我使用recipebox 示例作为我的基础。我提供了我的代码来演示身份验证和提交操作类型/对象类型组合所需的发布操作。

```
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US"> 
<head prefix="og: http://ogp.me/ns# og_<<app namespace>>: http://ogp.me/ns/apps/<<app namespace>>#"> 
    <meta property="fb:app_id" content="<<app id>>" /> 
    <meta property="og:type" content="<<app namespace>>:organization" /> 
    <meta property="og:title" content="Client 1" /> 
    <meta property="og:image" content="<<client image path>>" /> 
    <meta property="og:description" content="Client 1 description here ... " /> 
    <meta property="og:url" content="<<custom client URL>>">
    <script src="http://connect.facebook.net/en_US/all.js"></script>
    <script type="text/javascript">
        // Load the SDK Asynchronously
        (function(d){
            var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement('script'); js.id = id; js.async = true;
            js.src = "//connect.facebook.net/en_US/all.js";
            ref.parentNode.insertBefore(js, ref);
        }(document));

        // Init the SDK upon load
        window.fbAsyncInit = function() {
            FB.init({
                appId      : '<<app id>>', // App ID
                status     : true, // check login status
                cookie     : true, // enable cookies to allow the server to access the session
                xfbml      : true  // parse XFBML
            });

            // listen for and handle auth.statusChange events
            FB.Event.subscribe('auth.statusChange', function(response) {
                if (response.authResponse) {
                    // user has auth'd your app and is logged into Facebook
                    FB.api('/me', function(me){
                        if (me.name) {
                            document.getElementById('auth-displayname').innerHTML = me.name;
                        }
                    })
                    document.getElementById('auth-loggedout').style.display = 'none';
                    document.getElementById('auth-loggedin').style.display = 'block';
                } else {
                    // user has not auth'd your app, or is not logged into Facebook
                    document.getElementById('auth-loggedout').style.display = 'block';
                    document.getElementById('auth-loggedin').style.display = 'none';
                }
            });

            // respond to clicks on the login and logout links
            document.getElementById('auth-loginlink').addEventListener('click', function(){
                FB.login();
            });
            document.getElementById('auth-logoutlink').addEventListener('click', function(){
                FB.logout();
            });
        }       

        function nominate () {
            FB.api('/me/<<app namespace>>:Nominate&organization=<<custom client URL>>', 'post',  function(response) {

                if (! response || response.error) {
                    alert('Error occured');
                    console.log(response);
                } else {
                    alert('Post was successful! Action ID: ' + response.id);
                }
            });
        }
    </script>
</head> 
<body> 
    <div id="fb-root"></div>
    <div id="auth-status">
        <div id="auth-loggedout">
            <a href="#" id="auth-loginlink">Login</a>
        </div>
        <div id="auth-loggedin" style="display:none">
            Hi, <span id="auth-displayname"></span>  
            (<a href="#" id="auth-logoutlink">logout</a>)
        </div>
    </div>
    <h2>Client 1</h2> 
    <form>
        <input type="button" value="Nominate" onclick="nominate()" />
    </form> 
    <fb:activity actions="<<app namespace>>:nominate"></fb:activity>
</body> 
</html> 
```

测试用户遇到以下错误：

```
Requires extended permission: publish_actions 
```

我遇到了以下错误（我是这个应用程序的管理员）：

```
This method must be called with an app access_token 
```

第一个错误让我很困扰。我无法从中`publish_actions`选择`Apps | <My App> | Permissions | Extended Permissions`。此外，我遇到的补救措施建议我将我的应用程序重新分类为`Games`（这不起作用）并完成我的聚合（我做了；仍然不起作用）。

1.  我该如何克服这个错误？
2.  我能做些什么来修复*我的* `This method must be called with an app access_token`错误？

提前致谢，

麦克风

**编辑**

我相信`access_token`我遇到的错误是因为我直接在页面标签 URL 上测试/与应用程序交互；不是通过脸书。

我不再收到`Requires extended permission: publish_actions error`; 但是，我的测试人员和开发人员是。我知道我遇到了这个错误，因为在初始 facebook.com 登录提示中没有请求 publish_actions 权限。

如果我的开发人员/测试人员退出 Facebook，请使用我的提示重新登录：

```
FB.login(function (response) { }, { scope:'publish_actions'}); 
```

然后将此权限和应用程序集成到他们的 Facebook 会话中。

我的最后一个问题是 - 是否有一种事实上的首选方法来请求此权限而无需登录/退出 Facebook？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T17:18:43.737

我已经修复了我的两个错误。感谢那些向我提供反馈并让我走上正确道路的人。

这些错误已得到解决：

```
1\. Requires extended permission: publish_actions

2\. This method must be called with an app access_token 
```

首先，CBroe 是对的。由于我需要扩展权限，因此`(publish_actions)`我需要在回调函数之后指定这是我的选项对象，`FB.login()`如下所示：

```
FB.login(function (response) {
    if (response.authResponse) { // The user has authenticated
        authenticatedSoDoSomething();
    } 
    else { // The user has not authenticated
        notAuthenticatedSoDoSomethingElse(); 
    }
}, { scope:'publish_actions' }); 
```

最后，我没有成功使用 JavaScript SDK 通过`FB.api()`. 这是我使用的**代码**：

```
FB.api('/me/<<app namespace>>:<<my action>>&<<my object>>=<<a URL>>', 'post',
    function(response) {
        if (! response || response.error) {
            alert('Error occured');
        } else {
            alert('Post was successful! Action ID: ' + response.id);
        }
}) 
```

我忽略了包含应用程序访问令牌。应用程序访问令牌可以通过连接应用程序 ID、管道和应用程序密钥来构造。

我使用 PHP SDK 来完成这个请求，因为我想对我的 api 保密。这是我使用的 [大部分] 代码：

```
require_once('facebook-php-sdk/src/facebook.php');

$facebook = new Facebook(
    array(
        'appId' => '<<my app id>>', 
        'secret' => '<<my app secret>>'));

$user = $facebook->getUser();

if ($user) {
    try {
        $user_profile = $facebook->api('/me');
    } 
    catch (FacebookApiException $e) {
        error_log($e);
        $user = null;
        echo json_encode(array('success' => false));
    }
}

try {
    $facebook->api('/' . $user . '/<<app namespace>>:<<my action>>&<<my object>>=<<a URL>>', 'POST', array('access_token' => $facebook->getAppId() . '|' . $facebook->getApiSecret()));
}
catch (FacebookApiException $e) {
    echo var_dump($e->getResult());
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T00:15:01.460

对于第二个，使用您的[应用程序访问令牌](https://developers.facebook.com/docs/authentication/applications/)进行调用，就像错误所说的那样；如果您已经这样做并且失败了，请在 facebook App Dashboard 的应用程序设置中检查该应用程序是否设置为“本机/桌面”模式。如果是，则应用访问令牌不受信任，并且 API 的行为就像您没有提供它一样。

首先，您确定用户正在向您的应用授予 publish_actions 权限吗？使用用户的访问令牌调用`/me/permissions`将向您显示授予了哪些权限。请注意，经过身份验证的引荐/应用中心登录流程与您的应用的常规流程是分开的，用户最终通过经过身份验证的引荐或应用中心登录到那里，因此请检查您是否包含`publish_actions`在`scope`对 Oauth 对话框的调用中。

# c# - 字典的编码方法和使用

> ID：12098387
> 
> 赞同：2
> 
> 时间：2012-08-23T19:03:30.950
> 
> 标签：c#, dynamic, dictionary, key-value, key-value-coding

我有这组常量。

```
private const string A1KEY = 'a1';
private const string A1VALUE = 'AONE';
private const string B1KEY = 'b1';
private const string B1VALUE = 'BONE';
private const string C1KEY = 'c1';
private const string C1VALUE = 'CONE';
private const string D1KEY = 'd1';
private const string D1VALUE = 'DONE'; 
```

我收到了表格的输入。

```
string input = 'a1,b1,d1'; 
```

所以，根据这个输入......我的目标是生成一个动态脚本，该脚本将包含输入中接收到的键的相应值。

我打算 ，

1）将键值对添加到字典中。
2) 将字典键与输入字符串进行比较。
3) 为收到的键选择相应的值。
4）并将该列表发送到生成脚本的方法。

```
public string GenerateDynamicScript (...)
{
StringBuilder appndScript = new StringBuilder();

appndScript.Append ("alert('the value is <variable>'"); } 
```

这是一个正确的方法吗？代码示例会很有帮助。

处理这个目标的有效方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:08:07.843

```
Dictionary<string string> myDict = new Dictionary<string, string>();

// Add your values

string keys[] = input.split(',');

return myDict[keys[0]]; 
```

这不是整个实现，但这应该让你开始。

我的 C# 有点生疏，可能编译也可能不编译。

# html - 为精灵定位背景图像

> ID：12098389
> 
> 赞同：0
> 
> 时间：2012-08-23T19:03:45.380
> 
> 标签：html, css, css-sprites

我正在尝试使用精灵进行图像翻转，但出于某种原因，我使用的代码并没有改变背景的位置

这是我的代码

HTML

```
<div id="top-social">
<a class="top-facebook" href="#">Facebook</a>
<a class="top-twitter" href="#">Twitter</a>
</div> 
```

CSS

```
#top-social {
width:90px;
height:65px;
background-color:#FFF;
position:absolute;
z-index:9999;
margin-left:820px;
margin-top:-120px;
padding-top:15px;
padding-left:15px;
}

 #top-social a {
 display:block;
 text-indent: -9999px;
 height: 33px;
 width: 33px;
 background-image:url(images/social-icon-sprites.png);
 background-repeat: no-repeat;
 float:left;
 margin-right:8px;

 }

 #top-social .top-facebook a {background-position: 0px 0px;}
 #top-social .top-facebook a:hover {background-position: 0px -32px;}

 #top-social .top-twitter a {background-position: 32px 32px; }
 #top-social .top-twitter a:hover {background-position: 0px -32px;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:06:30.227

您的 css 规则中有错误：

改变

```
 #top-social .top-facebook a {background-position: 0px 0px;}
 #top-social .top-facebook a:hover {background-position: 0px -32px;} 
```

到

```
#top-social a.top-facebook {background-position: 0px 0px;}
#top-social a.top-facebook:hover {background-position: 0px -32px;} 
```

（对于以下其他 2 条规则也是如此）

您定义的规则意味着 a`a`必须在 class 的另一个元素中`top-facebook`。

# arrays - Numpy：重新排列矩阵以使每一行与其左/右上下文堆叠的最有效方法是什么？

> ID：12098391
> 
> 赞同：2
> 
> 时间：2012-08-23T19:04:07.767
> 
> 标签：arrays, numpy, reshape

让我通过一个小例子来解释它：

```
>>> x = np.array([[1,2], [3,4], [5,6], [7,8]])
>>> x
array([[1, 2],
       [3, 4],
       [5, 6],
       [7, 8]]) 
```

我想要一个具有以下形式的新数组

```
array([[0, 0, 1, 2, 3, 4],
       [1, 2, 3, 4, 5, 6],
       [3, 4, 5, 6, 7, 8],
       [5, 6, 7, 8, 0, 0]]) 
```

在这里，上下文的大小为 +/-1，但我想让它保持可变。

到目前为止，我正在做的是将零附加到原始数组：

```
>>> y = np.concatenate((np.zeros((1, 2)), x, np.zeros((1, 2))), axis=0)
>>> y
array([[ 0.,  0.],
       [ 1.,  2.],
       [ 3.,  4.],
       [ 5.,  6.],
       [ 7.,  8.],
       [ 0.,  0.]]) 
```

并通过读取新大小的行将值放入新数组中：

```
>>> z = np.empty((x.shape[0], x.shape[1]*3))
>>> for i in range(x.shape[0]): z[i] = y[i:i+3].flatten() 
```

那种作品，但我发现它缓慢，丑陋和不合时宜。你能想出一个更好的方法来进行这种重新排列吗？就地解决方案的额外赞许:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:55:41.983

There is the option of using `stride_tricks`, but I will not say that this is the best answer, because while it is "the most efficient way", that way is not always the best when considering readability and that it is playing with fire.

```
# We make it flat (and copy if necessary) to be on the safe side, and because
# it is more obvious this way with stride tricks (or my function below):
y = y.ravel()

# the new shape is (y.shape[0]//2-2, 6). When looking at the raveled y, the first
# dimension takes steps of 2 elements (so y.strides[0]*2) and the second is
# just the old one:
z = np.lib.stride_tricks.as_strided(y, shape=(y.shape[0]//2-2, 6),
                                       strides=(y.strides[0]*2, y.strides[0])) 
```

Note that `z` here is only a view, so use `z.copy()` to avoid any unexpected things before editing it, otherwise in your example all 1s will change if you edit one of them. On the up side, if you mean this by "in-place", you can now change elements in `y` and `z` will change too.

If you want to do more of this magic, maybe check out my `rolling_window` function from [https://gist.github.com/3430219](https://gist.github.com/3430219), which replaces the last line with:

```
# 6 values long window, but only every 2nd step on the original array:
z = rolling_window(y, 6, asteps=2) 
```

**Important:** `np.lib.stride_tricks.as_strided` by itself is generally *not* safe and must be used with care as it can create segmentation faults.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:35:15.160

索引应该工作：

```
y = np.concatenate(([0, 0], x.flat, [0, 0]))  # or use np.pad with NumPy 1.7
i = np.tile(np.arange(6), (4, 1)) + np.arange(4)[:, None] * 2
z = y[i] 
```

显然，如果您愿意，这是就地的！

要了解它是如何工作的，请查看`i`索引数组：

```
array([[ 0,  1,  2,  3,  4,  5],
       [ 2,  3,  4,  5,  6,  7],
       [ 4,  5,  6,  7,  8,  9],
       [ 6,  7,  8,  9, 10, 11]]) 
```

使其灵活：

```
context = 1
h, w = x.shape
zeros = np.zeros((context, w), dtype=x.dtype)
y = np.concatenate((zeros, x, zeros), axis=0).flat
i = np.tile(np.arange(w + 2 * context * w), (h, 1)) + np.arange(h)[:, None] * w
z = y[i] 
```

# xslt - XSLT 1.0 如何将一个字符串与另一个匹配，列出它，并在不同的标题下，列出不匹配的字符串（具体情况）

> ID：12098396
> 
> 赞同：0
> 
> 时间：2012-08-23T19:04:31.773
> 
> 标签：xslt, parameters, xslt-1.0, string-matching

我已经用 XSLT 训练自己大约 1.5 个月了。我已经制作了一个简化的较短版本，我无法弄清楚，并且非常感谢任何帮助，因为我被困在这个问题上。谢谢！

**基本情况：**

根属性中有一个字符串，其祖先元素定义为 xpath：

```
/v3:QualityMeasureDocument/v3:component/v3:dataCriteriaSection/v3:definition/v3:valueSet/v3:id/@root 
```

...当与带有元素条目祖先的 valueSet 属性的 id 匹配时，xpath：

```
/v3:QualityMeasureDocument/v3:component/v3:dataCriteriaSection/v3:entry/v3:observationCriteria/v3:value/@valueSet 
```

或者

```
/v3:QualityMeasureDocument/v3:component/v3:dataCriteriaSection/v3:entry/v3:observationCriteria/v3:code/@valueSet 
```

输出（需要并且当前确实）显示字符串及其必需的属性。

但是，当这些位置中的字符串不匹配时，还必须列出该字符串，并带有“未指定”标题。

**错误：** 即使所有现有字符串都匹配，也会列出“未指定”标头及其字符串。在这种情况下，应该只列出匹配的字符串。

**问题翻译器（XSL 文件）：**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
  xmlns:xalan="http://xml.apache.org/xalan"
  xmlns:v3="urn:hl7-org:v3"
  xmlns:rvs="urn:ihe:iti:svs:2008">  
  <xsl:output method="html" standalone="yes" omit-xml-declaration="no" indent="yes" xalan:indent-amount="2"/>    

  <xsl:template 
    match="/v3:QualityMeasureDocument">
    <html>
      <head>
        <title>Test 'I'</title>
      </head>
      <body>
        <ul>
          <xsl:apply-templates select="//v3:dataCriteriaSection" />
        </ul>
      </body>
    </html>  
  </xsl:template>

  <xsl:template
    match="v3:dataCriteriaSection">    
    <xsl:for-each select="//v3:entry">      
      <xsl:if test="*/v3:value/@valueSet">                    
        <xsl:call-template name="definitionValueSet">
          <xsl:with-param name="cur_valueSetID" select="*/v3:value/@valueSet"/> 
        </xsl:call-template>        
      </xsl:if>      
      <xsl:if test="*/v3:code/@valueSet">               
        <xsl:call-template name="definitionValueSet">
          <xsl:with-param name="cur_valueSetID" select="*/v3:code/@valueSet"/> 
        </xsl:call-template>        
      </xsl:if>      
      <xsl:if test="*/v3:participant/v3:roleParticipant/v3:code/@valueSet">                     
        <xsl:call-template name="definitionValueSet">
          <xsl:with-param name="cur_valueSetID" select="*/v3:participant/v3:roleParticipant/v3:code/@valueSet"/> 
        </xsl:call-template>        
      </xsl:if>                  
    </xsl:for-each>                
  </xsl:template>

  <xsl:template
    name="definitionValueSet">  
    <xsl:param name="cur_valueSetID"/>                     
    <xsl:for-each select="//v3:valueSet">                                
      <xsl:choose>    
        <xsl:when test="$cur_valueSetID != v3:id/@root or
        not( v3:text/v3:reference[starts-with(@value, 'https://') and contains(@value, $cur_valueSetID)] ) or
        not( v3:text/rvs:RetrieveValueSetResponse/rvs:ValueSet/@id = $cur_valueSetID )">   
          <xsl:if test="not($cur_valueSetID = '')">                                                    
            <li>
            <xsl:text>Not Specified</xsl:text>                                     
              <ul>
                <li>                       
                <xsl:text>ValueSet: </xsl:text>
                <xsl:value-of select="$cur_valueSetID"></xsl:value-of> 
                </li>
              </ul>
            </li>                 
          </xsl:if>
        </xsl:when>
        <xsl:when test="v3:id/@root = $cur_valueSetID"> 
          <xsl:if test="v3:text/v3:reference[starts-with(@value, 'https://') and contains(@value, $cur_valueSetID)]">
            <xsl:if test="v3:text/rvs:RetrieveValueSetResponse/rvs:ValueSet/@id = $cur_valueSetID">                 
              <li>       
                <xsl:text>Id: </xsl:text>
                <xsl:value-of select="v3:id/@root"/>                               
                <xsl:for-each select="v3:text/rvs:RetrieveValueSetResponse/rvs:ValueSet/rvs:ConceptList/rvs:Concept">
                  <ul>
                    <li>
                      <xsl:if test="not(@code = '')">
                        <xsl:if test="@code">
                          <xsl:text>code = </xsl:text>
                          <xsl:value-of select="@code"></xsl:value-of>
                          <xsl:text> </xsl:text>
                        </xsl:if>
                      </xsl:if>
                    </li>
                  </ul>        
                </xsl:for-each>
              </li>
            </xsl:if>
          </xsl:if>
        </xsl:when>    
      </xsl:choose>    
    </xsl:for-each>
  </xsl:template>                      
</xsl:stylesheet> 
```

**XML 输入文件 'I' xml：**

```
<?xml version="1.0" encoding="UTF-8"?>
<QualityMeasureDocument xmlns="urn:hl7-org:v3">
  <component>
    <dataCriteriaSection>
      <definition>
        <valueSet>
          <!-- Value Set for Race -->
          <id root='1.1.1.1.1.1.1' />
          <text>
            <reference
              value='https://localhost/RetrieveValueSet?id=1.1.1.1.1.1.1' />
            <RetrieveValueSetResponse xmlns="urn:ihe:iti:svs:2008">
              <ValueSet id="1.1.1.1.1.1.1">
                <ConceptList>
                  <Concept code="4" />
                  <Concept code="5" />
                  <Concept code="6" />
                </ConceptList>
              </ValueSet>
            </RetrieveValueSetResponse>
          </text>
        </valueSet>
      </definition>
      <definition>
        <valueSet>
          <id root='1.1.1.1.1.1.2' />
          <text>
            <reference
              value='https://localhost/RetrieveValueSet?id=1.1.1.1.1.1.2' />
            <RetrieveValueSetResponse xmlns="urn:ihe:iti:svs:2008">
              <ValueSet id="1.1.1.1.1.1.2">
                <ConceptList>
                  <Concept code="007.2" />
                  <Concept code="007.3" />
                </ConceptList>
              </ValueSet>
            </RetrieveValueSetResponse>
          </text>
        </valueSet>
      </definition>
      <entry>
        <observationCriteria>
          <code code="424144002" codeSystem="123123213"
            displayName="FEWFW" />
          <value>
            <low />
            <high />
          </value>
        </observationCriteria>
      </entry>
      <entry>
        <observationCriteria>
          <code code="DFHKJ" codeSystem="ASKJDHK" displayName="ASDNJK" />
          <value>
            <width />
          </value>
        </observationCriteria>
      </entry>
      <entry>
        <observationCriteria>
          <code code="FDSFD" codeSystem="JHBHJB" displayName="HJGJH" />
          <value valueSet="1.1.1.1.1.1.1" />
        </observationCriteria>
      </entry>
      <entry>
        <encounterCriteria>
          <code valueSet="1.1.1.1.1.1.2" />
        </encounterCriteria>
      </entry>
    </dataCriteriaSection>
  </component>
</QualityMeasureDocument> 
```

**预期的输出代码“I”HTML：**

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<html xmlns:xalan="http://xml.apache.org/xalan" xmlns:rvs="urn:ihe:iti:svs:2008" xmlns:v3="urn:hl7-org:v3">
  <head>
    <title>Test 'I'</title>
  </head>
  <body>
    <ul>
      <li>Id: 1.1.1.1.1.1.1
        <ul>
          <li>code = 4 </li>
        </ul>
        <ul>
          <li>code = 5 </li>
        </ul>
        <ul>
          <li>code = 6 </li>
        </ul>
      </li>
      <li>Id: 1.1.1.1.1.1.2
        <ul>
          <li>code = 007.2 </li>
        </ul>
        <ul>
          <li>code = 007.3 </li>
        </ul>
      </li>
    </ul>
  </body>
</html> 
```

通过 hack 或只是擦除代码来创建正确的输出很简单，但这需要在所有情况下都有效。例如，根本没有匹配项并且每次出现时只显示“未指定”标头及其字符串，或者两种情况的混合。该代码当前在没有匹配项的情况下工作，并在每次出现时显示“未指定”标题及其字符串。

似乎如果可以做到这一点，“如果它不匹配并且尚未列出”，它将解决问题。

希望有帮助。如果您想了解更多信息或更多文件，请告诉我。任何提示都会很棒！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:23:33.957

我认为您遇到的主要问题是在您的命名模板“definitionValueSet”中，您在其中使用**xsl:for-each****遍历 valueSet**元素

 **```
<xsl:for-each select="//v3:valueSet"> 
```

在此测试相关属性是否与当前参数匹配，如果找到匹配项，则输出列表。但是所有**valueSet**元素都会被搜索，所以即使一个匹配，你仍然会处理那些不匹配的元素，所以你的**xsl:if**也会被调用。这导致输出“未指定”。

您真正需要做的是仅匹配**valueSet**元素（如果存在），如果不存在匹配的元素，则输出您的“未指定”。

一种方法是首先创建一个变量来保存匹配的**valueSet**元素的唯一 id

```
<xsl:variable name="valueSet">
   <xsl:value-of select="generate-id(//v3:valueSet[v3:id/@root = $cur_valueSetID and v3:text/v3:reference[starts-with(@value, 'https://') and contains(@value, $cur_valueSetID)] and v3:text/rvs:RetrieveValueSetResponse/rvs:ValueSet/@id = $cur_valueSetID])"/>
</xsl:variable> 
```

然后，您可以测试是否已设置，如果已设置，则为该元素应用模板。如果未设置，您可以使用未指定的代码

```
<xsl:choose>
   <xsl:when test="$valueSet">
      <xsl:apply-templates select="//v3:valueSet[generate-id() = $valueSet]"/>
   </xsl:when>
   <xsl:otherwise>
      <!-- Not Specified -->
   </xsl:otherwise>
</xsl:choose> 
```

这是完整的 XSLT，它有望提供您需要的输出

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xalan="http://xml.apache.org/xalan" xmlns:v3="urn:hl7-org:v3" xmlns:rvs="urn:ihe:iti:svs:2008">
   <xsl:output method="html" standalone="yes" omit-xml-declaration="no" indent="yes" xalan:indent-amount="2"/>
   <xsl:template match="/v3:QualityMeasureDocument">
      <html>
         <head>
            <title>Test 'I'</title>
         </head>
         <body>
            <ul>
               <xsl:apply-templates select="//v3:dataCriteriaSection"/>
            </ul>
         </body>
      </html>
   </xsl:template>
   <xsl:template match="v3:dataCriteriaSection">
      <xsl:for-each select=".//v3:entry">
         <xsl:if test="*/v3:value/@valueSet">
            <xsl:call-template name="definitionValueSet">
               <xsl:with-param name="cur_valueSetID" select="*/v3:value/@valueSet"/>
            </xsl:call-template>
         </xsl:if>
         <xsl:if test="*/v3:code/@valueSet">
            <xsl:call-template name="definitionValueSet">
               <xsl:with-param name="cur_valueSetID" select="*/v3:code/@valueSet"/>
            </xsl:call-template>
         </xsl:if>
         <xsl:if test="*/v3:participant/v3:roleParticipant/v3:code/@valueSet">
            <xsl:call-template name="definitionValueSet">
               <xsl:with-param name="cur_valueSetID" select="*/v3:participant/v3:roleParticipant/v3:code/@valueSet"/>
            </xsl:call-template>
         </xsl:if>
      </xsl:for-each>
   </xsl:template>

   <xsl:template name="definitionValueSet">
      <xsl:param name="cur_valueSetID"/>
      <xsl:variable name="valueSet">
         <xsl:value-of select="generate-id(//v3:valueSet[v3:id/@root = $cur_valueSetID and v3:text/v3:reference[starts-with(@value, 'https://') and contains(@value, $cur_valueSetID)] and v3:text/rvs:RetrieveValueSetResponse/rvs:ValueSet/@id = $cur_valueSetID])"/>
      </xsl:variable>
      <xsl:choose>
         <xsl:when test="$valueSet != ''">
            <xsl:apply-templates select="//v3:valueSet[generate-id() = $valueSet]"/>
         </xsl:when>
         <xsl:otherwise>
            <li>
               <xsl:text>Not Specified</xsl:text>
               <ul>
                  <li>
                     <xsl:text>ValueSet: </xsl:text>
                     <xsl:value-of select="$cur_valueSetID"/>
                  </li>
               </ul>
            </li>
         </xsl:otherwise>
      </xsl:choose>
   </xsl:template>

   <xsl:template match="v3:valueSet">
      <li>
         <xsl:text>Id: </xsl:text>
         <xsl:value-of select="v3:id/@root"/>
         <xsl:for-each select="v3:text/rvs:RetrieveValueSetResponse/rvs:ValueSet/rvs:ConceptList/rvs:Concept">
            <ul>
               <li>
                  <xsl:if test="not(@code = '')">
                     <xsl:if test="@code">
                        <xsl:text>code = </xsl:text>
                        <xsl:value-of select="@code"/>
                        <xsl:text/>
                     </xsl:if>
                  </xsl:if>
               </li>
            </ul>
         </xsl:for-each>
      </li>
   </xsl:template>
</xsl:stylesheet> 
```

请注意，如评论中所述，小心使用 expression `//v3:entry`。这是一个绝对表达式，将匹配文档中的任何元素（即从根元素向下搜索）。如果您只想查看当前元素，请使用相对表达式`.//v3:entry`

编辑：对于这方面的轻微变体，作为查找**valueSet**元素的一种可能更有效的方法，您可以在 XSLT 文档的顶部定义一个键

```
<xsl:key name="valueSet" match="v3:valueSet" use="generate-id()" /> 
```

然后，而不是这样做来查找正确的**valueSet**元素

```
<xsl:apply-templates select="//v3:valueSet[generate-id() = $valueSet]"/> 
```

您可以改用密钥

```
<xsl:apply-templates select="key('valueSet', $valueSet)"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:40:23.577

以下是为理解而提供的简单替代解决方案（不使用 generate-id() 或 key() ）。它的效率可能不如 Tim C 的出色答案，也不应取代 Tim C 的出色答案。我只是提供这个让人们可以学习，并表明我全力以赴解决这个问题，而不是仅仅得到我需要的东西并继续前进。

解决方案是对原始“问题翻译器”的修复。唯一需要从该 XSL 文件中编辑（尽管很繁重）的部分是名为“definitionValueSet”的模板。

首先，我们需要创建一个变量**$valueSetData ，它一次性存储****v3:id/@root**的所有值，它们之间有一个“，”，以便以后单独引用。它就像一个新的临时数据库。
for-each 包含一个根据要求限制匹配的谓词。这些包含在声明中，因为它们是那里的本地节点。此外，这可以避免以后处理额外的条件检查。

```
<xsl:variable name="valueSetData">
   <xsl:for-each select="//v3:valueSet[
                           v3:text/v3:reference[starts-with(@value, 'https://') and contains(@value, $cur_valueSetID)] and 
                           v3:text/rvs:RetrieveValueSetResponse/rvs:ValueSet/@id = $cur_valueSetID]">       
     <xsl:value-of select="v3:id/@root"/>
     <xsl:text>,</xsl:text>
   </xsl:for-each>
</xsl:variable> 
```

接下来我们有选择语句，针对具体情况进行了编辑。该语句确定是否与**$valueSetData** “数据库”中的$ **cur_valueSetID匹配。**for-each 谓词限制重复匹配（由于上下文而具有错误值）。

 **```
 <xsl:choose>    
      <xsl:when test="contains($valueSetData, $cur_valueSetID)"> 
        <xsl:for-each select="//v3:valueSet[$cur_valueSetID = v3:id/@root]">
          <!-- Display found matches which meet all requirements -->
        </xsl:for-each>
      </xsl:when>
      <xsl:otherwise>
        <!-- Display Not Specified -->
      </xsl:otherwise>                                                                            
    </xsl:choose> 
```

完整的“definitionValueSet”模板：

```
 <xsl:template
    name="definitionValueSet">  
    <xsl:param name="cur_valueSetID"/>  
    <xsl:variable name="valueSetData">
       <xsl:for-each select="//v3:valueSet[
                               v3:text/v3:reference[starts-with(@value, 'https://') and contains(@value, $cur_valueSetID)] and 
                               v3:text/rvs:RetrieveValueSetResponse/rvs:ValueSet/@id = $cur_valueSetID]">       
         <xsl:value-of select="v3:id/@root"/>
         <xsl:text>,</xsl:text>
       </xsl:for-each>
    </xsl:variable>                                     
    <xsl:choose>    
      <xsl:when test="contains($valueSetData, $cur_valueSetID)"> 
        <xsl:for-each select="//v3:valueSet[$cur_valueSetID = v3:id/@root]">
          <li>       
            <xsl:text>Id: </xsl:text>
            <xsl:value-of select="v3:id/@root"/>                               
            <xsl:for-each select="v3:text/rvs:RetrieveValueSetResponse/rvs:ValueSet/rvs:ConceptList/rvs:Concept">
              <ul>
                <li>
                  <xsl:if test="not(@code = '')">
                    <xsl:if test="@code">
                      <xsl:text>code = </xsl:text>
                      <xsl:value-of select="@code"></xsl:value-of>
                      <xsl:text/>
                    </xsl:if>
                  </xsl:if>
                </li>
              </ul>        
            </xsl:for-each>
          </li>            
        </xsl:for-each>
      </xsl:when>
      <xsl:otherwise>
        <li>
          <xsl:text>Not Specified</xsl:text>                                     
          <ul>
            <li>                       
              <xsl:text>ValueSet: </xsl:text>
              <xsl:value-of select="$cur_valueSetID"></xsl:value-of> 
            </li>
          </ul>
        </li> 
      </xsl:otherwise>                                                                            
    </xsl:choose>   
  </xsl:template> 
```****

# javascript - 如何避免在更改其容器的 innerHtml 时清除画布元素

> ID：12098398
> 
> 赞同：3
> 
> 时间：2012-08-23T19:04:44.887
> 
> 标签：javascript, html, canvas, innerhtml

我正在使用 javascript 绘制到包含在包装器中的 div 内的画布元素。画布及其 div 是通过添加到包装器的 innerHTML 来动态生成的。目标是允许生成无限数量的画布

```
<div id="wrapper">
     <div id="container"><canvas id="previous"></canvas></div>
     <!-- infinite # of container divs & canvases -->
</div> 
```

但是，当我将新的 div 和画布添加到包装器的 innerHTML 时，绘制到前一个画布的任何内容都会丢失。

如果我在页面的其他地方添加新的画布，添加到容器外部的 div 或容器的子项：

```
<div id="wrapper">
     <div id="container"><canvas id="previous"></canvas></div>
</div>
<div id="wrapper2">
     <!-- newly inserted canvas: -->
     <div id="container"><canvas></canvas></div>
</div> 
```

或者：

```
<div id="wrapper">
     <div id="container"><canvas id="previous"></canvas></div>
     <div id="wrapperChild">
          <!-- newly inserted canvas: -->
          <div id="container"><canvas></canvas></div>
     </div>
</div> 
```

然后保留以前的画布。

据我所知，更改包装器的 innerHTML 或其父级会导致清除画布。关于如何避免清除画布的任何建议？我可以保留在其他地方绘制到画布上的内容并恢复它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T19:16:09.110

无论您的 javascript 方法（jQuery、其他方法或什么都没有），您都可以通过不使用 innerHTML 来做到这一点。基本上，当您附加到 innerHTML 属性时，您是在说“获取 innerHTML 的值，将其添加到这个新值（可能是 canvas 元素），然后将 innerHTML 设置为所有这些。换句话说，您是” t真的附加“就地”。你基本上是在添加你所拥有的所有东西的新版本，并且由于画布没有用子元素绘制它的内容，它们不会被这种方法带来。

而不是使用innerHTML，您应该使用DOM，将子节点作为节点而不是字符串附加到父节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:15:27.230

不要使用 innerHtml，而是使用 appendChild：

```
document.getElementById('wrapper').appendChild(NewNodeHere); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:11:35.187

听起来这是[jQuery](http://jquery.com/)的一个很好的用例。使用 jquery，您可以将`<canvas>`元素附加到任意容器中，并且避免与“innerHtml”交互。

例如：

```
var myCanvas = $("<canvas>").appendTo("#container"); 
```

这样做是向 id 为“容器”（您的 div）的元素添加一个新`<canvas>`元素。“#”是 ids 的 css 选择器。谷歌“css 选择器”，因为这是一个相当广泛的话题。

该`myCanvas`变量现在是一个 jQuery 数组，其中包含对您刚刚添加的画布的引用。`myCanvas[0]`将是您可以与之交互的实际 DOM 元素。

使用这种方法，您将永远不需要更改 div 的“innerHtml”，因此现有的画布将永远不会被触摸/清除。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-23T19:24:36.680

查看西蒙关于绘制形状的教程。 [http://simonsarris.com/project/canvasdemo/shapes.html](http://simonsarris.com/project/canvasdemo/shapes.html)

形状的所有属性和位置都存储在对象数组中。当像（单击形状）这样的事件发生时，画布的状态会发生变化（在这种情况下，形状正在被拖动），并且对于鼠标位置的每次变化，画布都会使用新的坐标和属性重新绘制。

现在，如果您还使用形状、图像、文本对象，您也可以将它们的属性存储在对象数组中。这样，您只需多次遍历数组，就可以以相同的方式在多个画布上绘制相同的形状。

因此，当您动态添加新的画布时，您可以简单地重绘之前的上下文。

这是西蒙教程中的相关代码：

您定义一个矩形形状（构造函数）

```
function Shape(x, y, w, h, fill) {
  this.x = x || 0;
  this.y = y || 0;
  this.w = w || 1;
  this.h = h || 1;
  this.fill = fill || '#AAAAAA';
} 
```

将此形状绘制到给定的上下文 Shape.prototype.draw = function(ctx) { ctx.fillStyle = this.fill; ctx.fillRect(this.x, this.y, this.w, this.h); }

将新形状添加到数组

```
CanvasState.prototype.addShape = function(shape) {
  this.shapes.push(shape);
  this.valid = false;
} 
```

遍历数组并相应地绘制所有形状

```
var l = shapes.length;
for (var i = 0; i < l; i++) {
  var shape = shapes[i];
  // We can skip the drawing of elements that have moved off the screen:
  if (shape.x > this.width || shape.y > this.height ||
      shape.x + shape.w < 0 || shape.y + shape.h < 0) continue;
  shapes[i].draw(ctx);
} 
```

# excel - 导出到 Excel 时将所有数据格式化为文本（非通用）

> ID：12098400
> 
> 赞同：1
> 
> 时间：2012-08-23T19:04:59.613
> 
> 标签：excel, ssrs-2008, reporting-services

我有一个没有列格式设置的 SSRS 报告。这是一张白纸。当我导出到 Excel 时，所有单元格都具有“常规”格式。

问题是我需要电子表格中的所有单元格都具有“文本”格式。我可以在 SSRS 方面做些什么，以便电子表格中的所有单元格都具有“文本”格式，而不是“常规”格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T14:09:24.623

您可以编辑报告中的数据以在第一个位置使用单引号 (')。
Excel 数字、日期和其他非文本 ('81111231456) 识别为文本。

# java - Eclipse Juno xml 错误

> ID：12098401
> 
> 赞同：0
> 
> 时间：2012-08-23T19:05:02.413
> 
> 标签：java, android

我已经安装了 Eclipse Juno 来创建 Android 应用程序，但是当我尝试导入任何项目时，在导入项目并尝试对其进行操作之后，它会生成另一个扩展名为 .out 的文件。

如果我只有一个名为“main.xml”的主要活动，当我尝试运行它时，它会给我一个错误 - 类似于“xml build”，它会在名为“main.out”的布局文件夹中创建另一个 XML 文件.xml”。该项目没有运行，但如果我删除该文件，重新启动 Eclipse，然后重新运行该项目，它运行得很好。

如果我在 XML 中编辑某些内容并尝试再次运行它，则重新创建该文件。谁能告诉我如何解决这个问题？为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:13:28.613

尝试右键单击项目，然后转到“运行方式”并选择 Android 设备。

# android - Android 操作栏：更改操作按钮的颜色

> ID：12098404
> 
> 赞同：4
> 
> 时间：2012-08-23T19:05:46.383
> 
> 标签：android, android-actionbar, android-4.0-ice-cream-sandwich, actionbarsherlock, android-theme

我有一个带有如下操作栏的应用程序：

![http://postimage.org/image/ozwy8o4x7/](../Images/61c9de392f3cac8ad2fb6807c690dcf4.png)

我希望菜单操作按钮“主页”和“注销”的文本也为白色。我怎样才能改变他们的文字颜色？

如果您想查看任何代码，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-23T19:27:20.930

据我所知，这是一个简单的属性，称为`android:actionMenuTextColor`.

要正确使用它，您应该创建自己的样式，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

    <style name="myTheme" parent="@android:style/Theme.Holo.Light">
        <item name="android:actionMenuTextColor">@color/actionBarText</item>
    </style>

    <style name="myTheme.ActionBar" parent="@android:style/Widget.Holo.Light.ActionBar">
        <item name="android:titleTextStyle">@style/myTheme.ActionBar.Text</item>
    </style>

    <style name="myTheme.ActionBar.Text" parent="@android:style/TextAppearance">
        <item name="android:textColor">@color/actionBarText</item>
    </style>

</resources> 
```

然后将@color/actionBarText 设置为您选择的颜色。您还可以在此处定义其他值，例如背景颜色。

# c++ - 在 C++ 中创建池概念

> ID：12098413
> 
> 赞同：0
> 
> 时间：2012-08-23T19:06:00.310
> 
> 标签：c++, linked-list, heap-memory, dynamic-memory-allocation

我有一个结构

```
struct Employee 
{ 
 char   uName  [255]; 
 struct   Employee *  next; 
 struct   Employee *  prev; 
}; 
```

我只想一次分配 100 个结构对象的内存，然后一个一个地使用它们，我制作一个链表。如果内存被完全消耗，那么我想再次分配 100 个对象内存

我正在分配

```
struct Employee * chunk=new struct Employee[100]; 
```

现在，当我想向链表添加一个新节点时，我想从这个已经分配的内存中获取对象。有人可以告诉我如何实现这一点

```
Employee * pEmployeeData=NULL;
for(long int i=1;i<=100;i++)
{
        pEmployeeData=EmployeePool+i;
        pEmployeeData->next=NULL;
        pEmployeeData->prev=NULL;
        InsertAtEnd(pEmployeeData);
} 
```

其中 InsertAtEnd 在链表末尾插入节点。请告诉如何实现这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:16:19.133

我强烈建议您不要尝试通过编写自己的链表来重新发明轮子，而是查看包含可供您使用的现成容器类型的 C++ 标准库。（例如`std::vector`和`std::list`）。

容器类型存在于 C++ 标准库中，用于存储数据/对象的集合。例如，您可以按照以下方式做一些事情

```
#include <iostream>
#include <vector>
#include <string>

struct Employee
{
    std::string name;
    int id;
};

int main()
{
    std::vector<Employee> my_employees;

    Employee fred = { "Fred", 1 };
    Employee bob = { "Bob", 2 };

    my_employees.push_back( fred );
    my_employees.push_back( bob );

    std::cout << my_employees[0].id << " " << my_employees[0].name << "\n"
              << my_employees[1].id << " " << my_employees[1].name << std::endl;
} 
```

标准容器易于使用和学习（你会发现大量描述如何使用它们的互联网资源——你的书也应该告诉你！）；如果您是 C++ 新手，那么在尝试创建自己的之前，最好先弄清楚如何使用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:15:42.487

您将为您的课程覆盖`new`and`delete`运算符。

`new`必须查看任何现有的池并查看是否有任何空闲对象，如果没有，则需要分配一个池。然后，它将返回从它分配的内存。

`delete`需要检查提供的对象被分配到的池中。如果仍然在其中分配了任何对象，则池保持不变，否则可以将其删除。

此外，由于您使用的是 C++，请考虑使用完整的类（尽管差别很小）

# c# - 比较图像 asp.net 的尺寸

> ID：12098414
> 
> 赞同：0
> 
> 时间：2012-08-23T19:06:02.097
> 
> 标签：c#, asp.net, image, compare, dimensions

我们有两个图像。

```
Image tempImage = new Image();
tempImage.width = 500;

Image tempImage2 = new Image();
tempImage2.width = 1000; 
```

我想比较这些图像的宽度并找到宽度更大的图像：

我试过以下：

```
if (tempImage.Width < tempImage2.Width) Response.write("width of tempImage2 is bigger");
else Response.write("width of tempImage1 is bigger"); 
```

编译器出错：无法比较这两个值。

我试过以下：

```
 Image1.Width = (int)Math.Max(Convert.toDouble(tempImage.Width),Convert.toDouble(tempImage2.Width));
Response.Write("max width is " + Image1.Width); 
```

编译器无法将宽度转换为双倍。

那么如何比较图像的宽度并找到宽度更大的图像呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:31:05.943

您收到错误是因为 Image 的 Width 属性是[Unit 结构](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.unit.aspx)类型，而不是标量，并且没有为它实现比较运算符。

```
if (i.Width.Value < j.Width.Value) 
```

[将起作用，但该比较仅在单元的类型](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.unittype.aspx)相同时才严格有效。在您的示例中，它默认为像素，但在更一般的情况下，您需要确保您正在比较相同单位的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:14:47.153

这对我有用：

```
protected void Page_Load(object sender, EventArgs e)
{
    Image tmp1 = new Image();
    Image tmp2 = new Image();

    tmp1.Width = new Unit(500);
    tmp2.Width = new Unit(1000);

    Response.Write(tmp1.Width.Value < tmp2.Width.Value);
} 
```

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:16:42.893

我会先将宽度放入 var 中，然后进行比较。

```
 int width1 = image1.Width.Value;
  int width2 = image2.Width.Value;

 if(width1 < width2){
  //apply code   } 
```

# php - 需要帮助查找错误，数据库中没有添加任何内容

> ID：12098415
> 
> 赞同：0
> 
> 时间：2012-08-23T19:06:03.233
> 
> 标签：php, mysql, insert

我即将创建一个简单的代码来添加新闻......（我的小项目）当我点击提交时，我得到一个成功文本，并重定向回页面，但没有添加数据，如果我将表单留空 -不出现错误消息。

...而且 mysql_real_escape_string 会给我省点麻烦吗？

```
<?php 
include('connect_db.php');
if(isset($_POST['submit']))
{
    $title = mysql_real_escape_string(htmlspecialchars($_POST['title']));
    $text = mysql_real_escape_string(htmlspecialchars($_POST['text']));

    if ($title == '' || $text == '')
    {

         // generate error message
         $error = 'ERROR: Please fill in all required fields!';
    }

    $result = mysql_query("INSERT INTO news ('id', 'date', 'title', 'text')
                           VALUES ('NULL', NOW(),'$title','$text')",$conn);

    echo "<b>Thank you!<br>You'll be redirected in (4) secs...";
    echo "<meta http-equiv=Refresh content=4;url=add.php>";

    } else {

    echo "<form method='post' action='add.php'>
          <legend>Add news</legend>
          <label>Title</label>
          <input type='text' name='title'>
          <label>Text</label>
          <textarea rows='5' name='text'></textarea>
          <br />
          <button type='submit' name='submit' class='btn'>Submit</button>
          </form>";
}?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:14:11.047

`NULL`是一个关键字，它不应该用引号引起来。

同样，字段名称应该用反引号```而不是单引号括起来`'`，并且您还应该将表名括在其中以保持一致性。

此外，它看起来`id`设置为`AUTO_INCREMENT`，因此您无需将其设置为`NULL`。如果`date`是`TIMESTAMP`（应该是），那么您也可以`DEFAULT CURRENT_TIMESTAMP`从查询中设置和删除它。

```
$result = mysql_query("INSERT INTO `news` (`title`,`text`) VALUES ('$title','$text')"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:23:37.200

您的代码有点未完成。

```
<?php 

// connect to the database
include('connect_db.php');

if(isset($_POST['submit']))

{

    // htmlspecialchars is needed when displaying HTML to the user from an input, not for inserting into a database. mysql_real_escape_string is plenty for this purpose.

    $title = mysql_real_escape_string($_POST['title']);
    $text = mysql_real_escape_string($_POST['text']);

    if ($title == '' || $text == '')

    {

        // You have generated an error but you are not displaying it anywhere.

        // generate error message
        echo 'ERROR: Please fill in all required fields!';

       // You will want to either send the error in a query string to this page again and display it above the form or re-echo the form here.

    }else{

        // Don't submit the data if there is an error.

        // ID should be auto-increment in your database, don't set it here even if you set it NULL, you can also have MySQL apply the current time rather than here.

        $result = mysql_query("INSERT INTO news (`title`, `text`)
        VALUES ('$title','$text')");

        echo "<b>Thank you!<br>You'll be redirected in (4) secs...";
        echo "<meta http-equiv=Refresh content=4;url=add.php>";

    }

} else {

    echo "<form method='post' action='add.php'>
    <legend>Add news</legend>
    <label>Title</label>
    <input type='text' name='title'>
    <label>Text</label>
    <textarea rows='5' name='text'></textarea>
    <br />
    <button type='submit' name='submit' class='btn'>Submit</button>
    </form>";

}
?> 
```

# javascript - 在选择更改时显示大于/小于的隐藏字段集

> ID：12098416
> 
> 赞同：0
> 
> 时间：2012-08-23T19:06:03.973
> 
> 标签：javascript, jquery, forms, show-hide

我有一个包含 4 个字段集的表单。用户必须至少填写 1 个字段集，但可以选择填写其他字段集。每个字段集的内容都是相同的。

我希望他们能够从下拉列表中选择要显示的多个字段集。从下拉列表中选择一个数字时，将显示相关的字段集数量。

因此，如果他们从数量下拉列表中选择 3，则应显示前 3 个字段集。如果他们改变主意并减少到 2 个字段集，那么第 3 个应该再次隐藏。

这是基本的 HTML。

```
<form>
    <select id="quantity" name="quantity">
        <option disabled="disabled">xx</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
    </select>

    <fieldset id="fieldset_name_1">Form Area 1</fieldset>
    <fieldset id="fieldset_name_2" style="display: none;">Form Area 2</fieldset>
    <fieldset id="fieldset_name_3" style="display: none;">Form Area 3</fieldset>
    <fieldset id="fieldset_name_4" style="display: none;">Form Area 4</fieldset>

</form>​ 
```

到目前为止，这是我**非常基本的 jQuery。**我对客户端的东西很陌生，通常把我的头埋在 php 中:)

```
var registerCount = function() {
    var qty = $(this).val();

    var fieldsets = $('fieldset');

    fieldsets.slice(0, qty ).show();  
}

$("#quantity").change(registerCount).keypress(registerCount); 
```

所以我已经正确地显示了字段集，我只是不确定如何在更改或再次按键时隐藏它们。

我确信这很简单，但我认为我对 PHP 的熟悉使我试图编写与 jQuery/javascript 方式完全不同的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:11:25.093

要隐藏未选中的，请在显示选中之前隐藏所有：

```
fieldsets.hide().slice(0, +qty).show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:21:40.067

您可以动态放置字段集以不隐藏它们。

```
$(function(){
    $('#quantity').change(function(){
        $('#fieldsets').html('');
        n = $(this).val();
        for (i=1; i<=n; i++){
            $('<fieldset/>', {
                id: 'fieldset_name_'+i,
                text: 'Form Area '+i
            }).appendTo('#fieldsets');
        }
    });
})​ 
```

演示：http: [//jsfiddle.net/JmeYZ/](http://jsfiddle.net/JmeYZ/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:27:43.120

这是答案，

[http://jsfiddle.net/mQ23q/](http://jsfiddle.net/mQ23q/)

希望它会有所帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T19:11:52.647

尝试先全部隐藏，然后根据选择显示：

样本：

```
var registerCount = function() {
    var qty = $(this).val();

    var fieldsets = $('fieldset');
    fieldsets.each(function (){
       $(this).hide();
    });

    fieldsets.slice(0, qty ).show();  
}

$("#quantity").change(registerCount).keypress(registerCount); 
```

# c++ - 与操作员混淆

> ID：12098419
> 
> 赞同：4
> 
> 时间：2012-08-23T19:06:17.257
> 
> 标签：c++, operators

当我尝试理解下面的代码时，我感到困惑。任何人都可以解释这个黑客：

```
a.*b 
```

或者 if`a`是一个指向类的指针：

```
a->*b 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T19:15:18.120

这两个运算符都用于取消引用指向成员的指针。与常规指针不同，指向成员的指针不能自行*取消引用*，而必须应用于该类型的实际对象。这些二元运算符选择左侧的对象（或指针）并将指向成员的指针应用于它。

```
struct test {
    int a, b, c;
};
int main() {
   int test::*ptr;
   ptr = &test::a;
   test t;
   t.*ptr = 5;         // set t.a to 5
   ptr = &test::b;
   test *p = &t;
   p->*ptr = 10;       // set t.b to 10 through a pointer
} 
```

# python - 无需在浏览器中进行身份验证即可自动发布到 Facebook 页面

> ID：12098425
> 
> 赞同：0
> 
> 时间：2012-08-23T19:06:42.520
> 
> 标签：python, facebook, facebook-graph-api

是否可以在不通过浏览器进行身份验证的情况下发布为页面（我是其管理员）？我已经看到，例如，[Facebook Python SDK](https://github.com/pythonforfacebook/facebook-sdk)允许您与 Facebook API 交互，但它需要通过浏览器获得授权。相反，我想自动执行此操作。

我已经创建了一个 APP，所以我有一个`APP_ID`,`USER_TOKEN`并且使用`'https://graph.facebook.com/oauth/access_token?grant_type=client_credentials&client_id=' + CLIENT_ID + '&client_secret=' + CLIENT_SECRET`我得到了一个 Oauth 访问令牌，但是我找不到一种方法来实现向我的页面发布消息的完全自动化，那么我该如何实现呢？

我刚刚阅读了有关[设备身份验证的](https://developers.facebook.com/docs/authentication/devices/)信息，但我仍然不确定这是否是我想要的。

谢谢！

# api - 尝试通过 http 访问 Google Analytics API 的身份验证错误（不使用 oAuth）

> ID：12098430
> 
> 赞同：0
> 
> 时间：2012-08-23T19:06:59.730
> 
> 标签：api, authentication, google-analytics, http-status-code-401

我正在尝试构建一个简单的脚本来导入通过我的 CMS 发布的文章的页面查看次数。我使用 Google Analytics API 查询构建器轻松构建了我的查询，它可以快速返回所需的结果。我的网络服务器上的计划作业将每天运行一次查询并更新和页面查看计数。

因为我只是在获取综合浏览量，所以我相信没有必要完成整个 oAuth 过程。此 Google 帐户只有一个网络资源和一个配置文件，因此无需例行程序即可获得它。

我注册了一个应用程序并创建了一个 API 密钥。我已确保为此配置文件启用了 Google Analytics。根据我对 API 的阅读，我相信我可以将此密钥作为 http 参数传递以正确授权查询。

当我通过 http 运行查询时，我收到授权错误 (401)。查询包括在下面：

```
https://www.googleapis.com/analytics/v3/data/ga?ids=ga%3A[MY ID]&metrics=ga%3Apageviews&start-date=2012-08-09&end-date=2012-08-23&max-results=50&key=[MY API KEY] 
```

我已经用谷歌搜索了很多这样的例子，但它们似乎都实现了一个非常复杂的（在我的用例中是不必要的）身份验证例程。但也许我错过了一些东西。

提前谢谢了。

*   克里斯，沮丧的谷歌员工

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T09:28:16.530

使用此示例修复 401 错误[http://dumitruglavan.com/ganalytics-class-access-google-analytics-data-api-with-php/](http://dumitruglavan.com/ganalytics-class-access-google-analytics-data-api-with-php/)

您需要授权：

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "https://www.google.com/accounts/ClientLogin");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, true);

$data = array(
    'accountType' => 'GOOGLE',
    'Email' => $email,
    'Passwd' => $password,
    'service' => 'analytics',
    'source' => ''
);

curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
$output = curl_exec($ch);
$info = curl_getinfo($ch);
curl_close($ch);

$auth = '';
if($info['http_code'] == 200) {
    preg_match('/Auth=(.*)/', $output, $matches);
    if(isset($matches[1])) {
        $auth = $matches[1];
    } else {
        throw new Exception('Login failed with message: ' . $output);
    }
} 
```

并在标头中授权发送授权令牌后：

```
$headers = array("Authorization: GoogleLogin auth=$auth");

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
$output = curl_exec($ch);
$info = curl_getinfo($ch);
curl_close($ch); 
```

# gnome - Gnome shell 恢复为 Gnome 2

> ID：12098431
> 
> 赞同：0
> 
> 时间：2012-08-23T19:07:01.383
> 
> 标签：gnome, ubuntu-11.10, gnome-3, gnome-shell

我无法运行 Gnome 3，只能运行 Gnome 2，即使我安装了 gnome-shell 并将其设置为默认窗口管理器。

这是我运行 gnome-shell --replace 后看到的内容

> (gnome-shell:3136): Gdk-WARNING **: 程序 'gnome-shell' 收到 X Window 系统错误。这可能反映了程序中的错误。错误是“BadRequest（请求代码无效或没有此类操作）”。（详情：serial 147 error_code 1 request_code 155 minor_code 19） （程序员注意：通常，X错误是异步报告的；也就是说，您会在导致错误后一段时间收到错误。要调试您的程序，请使用--同步命令行选项来更改此行为。如果您中断 gdk_x_error() 函数，您可以从调试器中获得有意义的回溯。）

我该如何解决？我正在运行 Ubuntu 11.10。我无法升级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-10T20:43:49.847

几年前我遇到了类似的问题，我修复了它更新 Catalyst 驱动程序。这是链接： http: [//ftp.de.debian.org/debian/pool/non-free/f/fglrx-driver/fglrx-driver_12-6+point-3_amd64.deb](http://ftp.de.debian.org/debian/pool/non-free/f/fglrx-driver/fglrx-driver_12-6+point-3_amd64.deb)

# ruby-on-rails - 什么可能导致 object_ids 中的跳过

> ID：12098433
> 
> 赞同：1
> 
> 时间：2012-08-23T19:07:15.363
> 
> 标签：ruby-on-rails, database, rake

在无意中用我的夹具测试数据（只有 2 行/表）覆盖了我的大约 100 行/表的开发数据库后，在每个模型中创建的下一个新对象从 id = 897600 开始。

是什么原因造成的？这是否意味着我创建了 897500 个在我的数据库中不可见的测试对象？不确定这是否是我应该关注的事情，但任何反馈都将不胜感激。

我正在使用带有 Rails 3.2 的 PostgreSQL 9.1

请让我知道哪些附加信息有助于澄清我的问题。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:15:45.810

Rails 夹具使用夹具键的哈希值来确定记录`id`。这允许所有[好东西](http://archives.ryandaigle.com/articles/2007/10/26/what-s-new-in-edge-rails-fixtures-just-got-a-whole-lot-easier)（介绍此功能时的一些旧文章）。为了让您的测试运行，在测试示例中创建的记录不需要与这些哈希 id 冲突，因此`ActiveRecord`将 PK 序列重置`max(id)+1`为它与夹具接触的每个表。以下是您的 PK 如何达到`897600`.

# go - 你能用 Go 在内存中“固定”一个对象吗？

> ID：12098435
> 
> 赞同：8
> 
> 时间：2012-08-23T19:07:18.537
> 
> 标签：go

我有一个 Go 对象，我想保持它在内存中的地址不变。在 C# 中，可以将对象的位置固定在内存中。有没有办法在 Go 中做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T19:29:30.247

An object on which you keep a reference won't move. There is no handle or indirection, and the address you get is permanent.

From [the documentation](http://golang.org/doc/effective_go.html) :

> Note that, unlike in C, it's perfectly OK to return the address of a local variable; the storage associated with the variable survives after the function returns

When you set a variable, you can read this address using the `&` operator, and you can pass it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-27T06:48:11.183

tl;博士不 - 但除非你试图做一些不寻常的事情，否则没关系。

值得注意的是，接受的答案部分不正确。

不能保证对象不会被移动——无论是在堆栈上还是在 Go 堆上——但只要你不使用`unsafe`它对你来说并不重要，因为 Go 运行时会透明地更新你的指针，以防万一对象被移动。

如果您使用 OTOH`unsafe`来获取`uintptr`、调用原始系统调用、执行 CGO 调用或以其他方式公开地址（例如`oldAddr := fmt.Sprintf("%p", &foo)`）等，您应该知道地址可以更改，并且编译器和运行时都不会神奇地为您修补东西。

虽然目前标准的 Go 编译器只移动堆栈上的对象（例如，当需要调整 goroutine 堆栈的大小时），但 Go 语言规范中没有任何内容阻止不同的实现在 Go 堆上移动对象。

虽然没有明确支持将对象固定在堆栈或 Go 堆中，但有一个[推荐](https://github.com/golang/go/issues/12416#issuecomment-136445979)的解决方法：在 Go 堆之外手动分配内存（例如 via `mmap`），并使用终结器在所有对它的引用后自动释放该分配被丢弃。这种方法的好处是在 Go 堆之外手动分配的内存永远不会被 Go 运行时移动，所以它的地址永远不会改变，但它仍然会在不再需要时自动释放，所以它不会泄漏.

# ruby-on-rails - Rails - 如何检查变量是否存在以及它是否在一个语句中具有特定值

> ID：12098438
> 
> 赞同：1
> 
> 时间：2012-08-23T19:07:46.153
> 
> 标签：ruby-on-rails, ruby, undefined

目前，如果它不存在，我会收到`undefined local variable or method`错误消息。

如何检查变量的值并说明它根本不存在。

我以为`&&`是交易，但是：

```
if defined? aaa && aaa == '123' then puts aaa end

NameError: undefined local variable or method `aaa' for main:Object 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T19:20:12.567

在这种情况下，您需要括号，`defined?(aaa)`否则它会像评估整个表达式`aaa && aaa == '123'`一样评估它`defined?(aaa && aaa == '123')`。所以你的代码真的是这样做的：

```
if defined?(aaa && aaa == '123') # returns "expression" string, and thus true
  puts aaa # the error comes from this part, since aaa is not defined.
end 
```

# ios - Xcode Instruments - Zombies - 我在寻找什么？

> ID：12098444
> 
> 赞同：13
> 
> 时间：2012-08-23T19:08:22.623
> 
> 标签：ios, xcode, instruments, nszombie, nszombieenabled

当我在 Xcode 中运行 Project/Profile 并选择“ **Zombies**`NSZombie detection` ”时，应用程序在启用了“”的模拟器中运行。但是我应该寻找什么来告诉我有问题？我所看到的只是分配工具正在运行和下面的统计数据。它实际上会在哪里向我显示`Zombie`检测到 a ？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-23T19:30:29.267

您将在对象分配栏上方获得泄漏。检查此图像； ![在此处输入图像描述](../Images/e3894f3d7a6c4df39254a5036c541ba3.png)

如需参考，请查看此[视频](http://www.youtube.com/watch?v=LQtPr8bkB3g)

# c# - 从可嵌入资源中提取/移动文件

> ID：12098448
> 
> 赞同：0
> 
> 时间：2012-08-23T19:08:57.623
> 
> 标签：c#

我有一些 exe 文件，我想在程序启动时存储它们。

到目前为止，我已经添加了一个可执行文件和 2 个 dll 作为资源。我还在那里的属性中将它们设置为“嵌入式资源”。有一个选项可以“复制到输出目录”但是我想将它们存储在另一个文件夹中

Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData

而不是我的程序启动的地方。

到目前为止，我已经阅读了一些论坛：

```
 Assembly _assembly;
    Stream _exemin;
    Stream _dllmin;
    Stream _dllmin2;

    _assembly = Assembly.GetExecutingAssembly();
    _exemin = _assembly.GetManifestResourceStream("LitecoinBN.minerd.exe");
    _dllmin = _assembly.GetManifestResourceStream("LitecoinBN.libcurl-4.dll");
    _dllmin2 = _assembly.GetManifestResourceStream("LitecoinBN.pthreadGC2.dll"); 
```

但是我不确定如何提取这些资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:57:33.857

查看`FileStream`和[Stream.CopyTo()](http://msdn.microsoft.com/en-us/library/system.io.stream.copyto.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:09:49.483

[Assembly.GetManifestResourceStream](http://msdn.microsoft.com/en-us/library/xc4235zt.aspx)返回一个[Stream](http://msdn.microsoft.com/en-us/library/system.io.stream.aspx)对象。

**.Net 4.0 及以上**

你可以用这个流做任何你想做的事情，比如把它写到一个文件中。如果您使用的是 .Net 4.0 或更高版本，则流类有一个[CopyTo](http://msdn.microsoft.com/en-us/library/dd782932.aspx)方法，允许您将一个流复制到另一个流。

**4.0以下**

如果您使用的是低于 4.0 的 .Net 版本，您可以看到[Jon Skeet的这个](https://stackoverflow.com/users/22656/jon-skeet)[答案](https://stackoverflow.com/a/411605/444610)，其中有一个将流复制到 FileStream 的示例，即：将其写入文件。

# javascript - clearSetTimeout，防止setTimeout的堆积

> ID：12098449
> 
> 赞同：0
> 
> 时间：2012-08-23T19:09:02.327
> 
> 标签：javascript, ajax, settimeout

我在递归中使用 setTimeouts 来模拟 setInterval，同时防止它自行运行，例如：

```
this.poll = function() {
    var self = this;
    if(self.timeout) {
          clearTimeout(self.timeout)
    }
    self.timeout = setTimeout(function(){
      self.request();
    }, 1000);
} 
```

`self.request();`包含 ajax 逻辑和调用`this.poll()`。

问题是当再次调用时它似乎并没有真正清除超时`this.poll`，我最终得到了大量的请求。

有没有更好的方法来处理这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:17:29.073

为什么要模拟**setInterval**而不是使用**标志**来防止同时运行两次？

```
this.poll = function(){
  if(this.running) return;
  this.running = true;
  var self = this;
  setIntervar(function(){
     var callback = function(){
        //your stuff 
        self.running = 0;
     };
     self.request(.....,callback);
  },1000)
} 
```

# inno-setup - 如何让 Inno 设置仅使用取消按钮显示消息，以便安装停止

> ID：12098453
> 
> 赞同：2
> 
> 时间：2012-08-23T19:09:18.413
> 
> 标签：inno-setup

我正在使用 Inno setup 来交付软件包。它会检测 Access 的版本并弹出一条消息。我想让消息告诉用户他们下载了错误的版本并停止安装。目前 Inno 脚本使用

```
itd_downloadafter(NoRuntimePage.ID); 
```

显示一条消息，告诉用户他们需要安装 AccessRuntime。当他们用户按下下一步时，它会下载 AccessRuntime 并继续。我想为我的新脚本更改此设置，以告诉用户他们的版本错误，然后在他们按下一步或取消时结束安装脚本。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T19:21:54.903

***为什么要使用 InitializeSetup ？***

如果要在向导启动之前有条件地退出设置，请不要使用带有异常引发[`InitializeWizard`](http://www.jrsoftware.org/ishelp/topic_scriptevents.htm)的事件函数。[`Abort`](http://www.jrsoftware.org/ishelp/topic_isxfunc_abort.htm)您将浪费时间，需要创建整个向导表单。请改用[`InitializeSetup`](http://www.jrsoftware.org/ishelp/topic_scriptevents.htm)事件函数。在那里，您可以引发[`Abort`](http://www.jrsoftware.org/ishelp/topic_isxfunc_abort.htm)异常或更好地将 False 返回到其布尔结果，并按预期退出函数 - 最终效果肯定是相同的。

在内部，当您从脚本中返回 False 时，该[`InitializeSetup`](http://www.jrsoftware.org/ishelp/topic_scriptevents.htm)函数只会引发此异常。[`Abort`](http://www.jrsoftware.org/ishelp/topic_isxfunc_abort.htm)与[`InitializeWizard`](http://www.jrsoftware.org/ishelp/topic_scriptevents.htm)事件相反，当[`InitializeSetup`](http://www.jrsoftware.org/ishelp/topic_scriptevents.htm)事件被触发时，向导表单还没有创建，所以你不会浪费时间，也不会使用系统资源。

***代码示例：***

在下面的伪代码中，您需要有一个函数`UserDownloadedWrongVersion`，如果您返回 True，则设置将终止，否则不会发生任何事情。

```
[Code]
function UserDownloadedWrongVersion: Boolean;
begin
  // make your check here and return True when you detect a wrong 
  // version, what causes the setup to terminate; False otherwise
end;

function InitializeSetup: Boolean;
begin
  Result := not UserDownloadedWrongVersion;
  if not Result then
  begin
    MsgBox('You''ve downloaded the wrong version. Setup will now exit!', 
      mbError, MB_OK);
    Exit;   // <-- or use Abort; instead, but there's no need for panic
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:20:42.487

** *TLama 的回答更准确。***

您可以使用 InitializeWizard 过程在开始时运行访问检查...如果失败，您应该能够显示您的消息框然后调用 Abort() 。

```
[code]
var CustomPage: TInputQueryWizardPage;

procedure InitializeWizard;
begin;
  {your checking Access version and message box}
  Abort();
end; 
```

# c# - 如何检测浮点数是否在 C# 中具有重复的十进制扩展？

> ID：12098461
> 
> 赞同：9
> 
> 时间：2012-08-23T19:10:08.740
> 
> 标签：c#, math, floating-point, design-patterns, period

我只需要知道如何检测浮点数中重复的十进制扩展。

例子：

0.123456789123456789

数字的重复部分将是 123456789。

我想在 C# 中自动化这个，有什么聪明的解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-24T01:03:48.000

计算给定浮点数的有理近似值有一个很好的技巧（基于欧几里得 GCD 算法的一些属性）。我们可以使用它来确定“最佳”近似值是否为 形式`A/(2^a 5^b)`，如果是，则浮点数终止（以 10 为底），如果不是，它将具有一些重复分量。棘手的一点是确定哪个近似值是正确的（由于浮点精度问题）。

所以这里是你如何获得近似有理表达式。

第一次迭代`x = 1/x - floor(1/x)`跟踪`int(x)`

```
x = 0.12341234
1/x = 8.102917
x <= 1/x - 8 = 0.102917
1/x = 9.7165
x <= 1/x - 9 = 0.71265277
1/x = 1.3956
x < 1/x - 1 = 0.3956
... 
```

接下来将 x 的 int 部分粘贴到该表的第一行，称它们为 k_i。的值`A_i = A_{i-2} + k_i * A_{i-1}`和相同的`B_i`。

```
 ||  8      |  9  | 1   | 2   | 1   |  1  |    8 |    1 |    1
A =    1 0 ||  1      |  9  | 10  | 29  | 39  |  68 |  583 |  651 | 1234
B =    0 1 ||  8      | 73  | 81  | 235 | 316 | 551 | 4724 | 5275 | 9999 
```

那么有理近似值是`A_n/B_n`。

```
1/8       = 0.12500000000000000     | e = 1.5e-3
9/73      = 0.12328767123287671     | e = 1.2e-4
10/81     = 0.12345679012345678     | e = 4.4e-5
29/235    = 0.12340425531914893     | e = 8.1e-6
39/316    = 0.12341772151898735     | e = 5.4e-6
68/551    = 0.12341197822141561     | e = 3.6e-7
583/4724  = 0.12341236240474174     | e = 2.2e-8
651/5275  = 0.12341232227488151     | e = 1.8e-8
1234/9999 = 0.12341234123412341     | e = 1.2e-9 
```

因此，如果我们在 1234/9999 阶段确定我们的误差足够低，我们注意到 9999 不能写成 2^a 5^b 的形式，因此我们的十进制扩展是重复的。

`x = 1/x - round(1/x)`请注意，虽然这似乎需要很多步骤，但如果我们使用（并改为跟踪 round(1/x)），我们可以获得更快的收敛速度 。在这种情况下，表格变为

```
 8  10    -4     2      9     -2
1 0  1  10   -39   -68   -651   1234
0 1  8  81  -316  -551  -5275   9999 
```

这以更少的步骤为您提供了先前结果的子集。

有趣的是，分数 A_i/B_i 总是使得 A_i 和 B_i 没有公因数，因此您不必担心取消因数或类似的事情。

为了比较，让我们看看 x = 0.123 的扩展。我们得到的表是：

```
 8   8   -3    -5  
 1 0  1   8  -23   123
 0 1  8  65 -187  1000 
```

那么我们的近似序列是

```
 1/8      = 0.125       e = 2.0e-3
 8/65     = 0.12307..   e = 7.6e-5
 23/187   = 0.12299..   e = 5.3e-6
 123/1000 = 0.123       e = 0 
```

我们看到 123/1000 正是我们想要的分数，因为 1000 = 10^3 = 2^3 5^3 我们的分数正在终止。

如果你真的想知道分数的重复部分是什么（什么数字和什么句点），你需要做一些额外的技巧。`(10^k-1)`这涉及分解分母并找到所有这些因素（除了 2 和 5）的最小数字，然后 k 将是您的周期。所以对于我们的顶级案例，我们发现 A = 9999 = 10^4-1 （因此 10^4-1 包含 A 的所有因素 - 我们在这里有点幸运......）所以重复部分的周期是 4 . 您可以[在此处](http://mathworld.wolfram.com/DecimalExpansion.html)找到有关此最后部分的更多详细信息。

此算法的最后一个重要方面是它不需要所有数字都将十进制扩展标记为重复。考虑 x = 0.34482，这有以下表格：

```
 3 -10 -156
1 0  1 -10   . 
0 1  3 -29   . 
```

我们在第二个入口处得到一个非常准确的近似值并停在那里，得出的结论是我们的分数可能是 10/29（因为它在 1e-5 内使用）并且从上面链接中的表格中我们可以看出它的周期将是 28位数。这永远无法通过对数字的简短版本进行字符串搜索来确定，这需要至少 57 位数字才能知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:14:17.387

您无法像示例中那样检测以 10 为基数的表示形式，浮点数的精度为 7 位。

[http://msdn.microsoft.com/en-us/library/aa691146%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/aa691146%28v=vs.71%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T00:48:33.337

你不能。

浮点具有有限精度。每个类型的值`float`都是 2.0 的整数幂 (X * 2 ^Y ) 的整数倍，其中 X 和 Y 是（可能是负数）整数）。由于 10 是 2 的倍数，因此每个类型的值`float`都可以用有限个十进制数字精确表示*。*

例如，尽管您可能希望`1.0f/3.0f`将其表示为重复的十进制（或二进制）数，但实际上`float`只能保持数学值的近似值，即*不是*重复的小数（除非您计算后面的重复`0`）非零数字）。存储的值很可能是精确的`0.3333333432674407958984375`；只有小数点后的前 7 位左右是有效的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T00:08:06.450

就我个人而言，我会将其转换为字符串，在句点之后捕获所有内容的子字符串，然后转换为您需要的数据类型。例如（我已经多年没有编写任何 C# 了，所以请原谅任何语法问题）：

```
float checkNumber = 8.1234567;
String number = new String( checkNumber ); // If memory serves, this is completely valid
int position = number.indexOf( "." ); // This could be number.search("."), I don't recall the exact method name off the top of my head
if( position >= 0 ){ // Assuming search or index of gives a 0 based index and returns -1 if the substring is not found
    number = number.substring( position ); // Assuming this is the correct method name to retrieve a substring.
    int decimal = new Int( number ); // Again, if memory serves this is completely valid
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T23:41:44.617

您可以像这样隔离数字的小数部分（期后）：

```
value - Math.Floor(value) 
```

如果您使用双精度值“1.25”执行此操作，您将得到值“0.25”。因此，您将隔离“期间右侧”的部分。当然，您会将它作为 0 和 1 之间的双精度数，而不是您的问题似乎需要的整数。

您的问题表明您需要“检测浮动周期”。如果您只需要确定*是否存在小数部分*，则以下代码将大致有效：

```
value != Math.Floor(value) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T19:26:18.387

我认为一般没有解决方案（至少，使用`float`/ `double`）：

*   周期可能太长`float`（甚至`double`）；
*   `float`/`double`是近似值。

例如，这是除法的结果`(double)1/(double)97`：

```
0.010309278350515464 
```

实际上，它是一个重复的小数，在句号中有 96 个重复数字。如果小数点后只有 18 位，如何检测？

即使`decimal`没有足够的数字：

```
0.0103092783505154639175257732 
```

# python - Python 多处理和目录创建

> ID：12098462
> 
> 赞同：1
> 
> 时间：2012-08-23T19:10:22.513
> 
> 标签：python, file, directory, multiprocessing

我正在使用 Python 多处理模块来抓取网站。现在这个网站有超过 100,000 个页面。我要做的是将检索到的每 500 页放入一个单独的文件夹中。问题是虽然我成功创建了一个新文件夹，但我的脚本只填充了前一个文件夹。这是代码：

```
global a = 1

global b = 500

def fetchAfter(y):

       global a

       global b

       strfile = "E:\\A\\B\\" + str(a) + "-" + str(b) + "\\" + str(y) + ".html"

       if (os.path.exists( os.path.join( "E:\\A\\B\\" + str(a) + "-" + str(b) + "\\", str(y) + ".html" )) == 0):

                f = open(strfile, "w")

if __name__ == '__main__':

       start = time.time()
       for i in range(1,3):
              os.makedirs("E:\\Results\\Class 9\\" + str(a) + "-" + str(b))

              pool = Pool(processes=12)
              pool.map(fetchAfter, range(a,b))
              pool.close()
              pool.join()
              a = b
              b = b + 500

       print time.time()-start 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:28:54.133

工作函数最好*只*依赖它获得的单个参数来确定要做什么。因为这是每次调用父进程时它从父进程获得的唯一信息。该参数几乎可以是任何 Python 对象（包括元组、字典、列表），因此您传递给工作人员的信息量并不受限制。

所以制作一个 2 元组的列表。每个 2 元组应包含 (1) 要获取的文件和 (2) 存储它的目录。将该元组列表提供给`map()`，然后让它撕裂。

我不确定指定要使用的进程数是否有用。池通常使用与您的 CPU 具有的内核一样多的进程。这通常足以最大化所有核心。:-)

顺便说一句，你应该只打电话`map()`一次。并且由于`map()`阻塞直到一切完成，因此无需调用`join()`.

**编辑：**在下面添加了示例代码。

```
import multiprocessing
import requests
import os

def processfile(arg):
    """Worker function to scrape the pages and write them to a file.

    Keyword arguments:
    arg -- 2-tuple containing the URL of the page and the directory
           where to save it.
    """
    # Unpack the arguments
    url, savedir = arg

    # It might be a good idea to put a random delay of a few seconds here, 
    # so we don't hammer the webserver!

    # Scrape the page. Requests rules ;-)
    r = requests.get(url)
    # Write it, keep the original HTML file name.
    fname = url.split('/')[-1]
    with open(savedir + '/' + fname, 'w+') as outfile:
        outfile.write(r.text)

def main():
    """Main program.
    """
    # This list of tuples should hold all the pages... 
    # Up to you how to generate it, this is just an example.
    worklist = [('http://www.foo.org/page1.html', 'dir1'), 
                ('http://www.foo.org/page2.html', 'dir1'), 
                ('http://www.foo.org/page3.html', 'dir2'), 
                ('http://www.foo.org/page4.html', 'dir2')]
    # Create output directories
    dirlist = ['dir1', 'dir2']
    for d in dirlist:
        os.makedirs(d)
    p = Pool()
    # Let'er rip!
    p.map(processfile, worklist)
    p.close()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:52:11.083

这是实现它的一种方法：

```
#!/usr/bin/env python
import logging
import multiprocessing as mp
import os
import urllib

def download_page(url_path):
    try:
        urllib.urlretrieve(*url_path)
        mp.get_logger().info('done %s' % (url_path,))
    except Exception as e:
        mp.get_logger().error('failed %s: %s' % (url_path, e))

def generate_url_path(rootdir, urls_per_dir=500):
    for i in xrange(100*1000):
        if i % urls_per_dir == 0: # make new dir
           dirpath = os.path.join(rootdir, '%d-%d' % (i, i+urls_per_dir))
           if not os.path.isdir(dirpath):
              os.makedirs(dirpath) # stop if it fails
        url = 'http://example.com/page?' + urllib.urlencode(dict(number=i))
        path = os.path.join(dirpath, '%d.html' % (i,))
        yield url, path

def main():
    mp.log_to_stderr().setLevel(logging.INFO)

    pool = mp.Pool(4) # number of processes is unrelated to number of CPUs
                      # due to the task is IO-bound
    for _ in pool.imap_unordered(download_page, generate_url_path(r'E:\A\B')):
        pass

if __name__ == '__main__':
   main() 
```

另请参阅[Python multiprocessing pool.map 以获取多个参数](https://stackoverflow.com/q/5442910/4279)和代码 [Brute force basic http authentication using httplib 和 multiprocessing](https://gist.github.com/0a8860f4f9a824561b51)[如何使 Python 中的 HTTP 更快](https://codereview.stackexchange.com/a/12661)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:25:33.713

顾名思义，多处理使用单独的进程。您使用您创建的进程`Pool`无权访问您在主程序中添加 500`a`的原始值。`b`请参阅[上一个问题](https://stackoverflow.com/questions/11109776/changing-global-variable-when-multiprocessing-in-python)。

最简单的解决方案是重构您的代码，以便您通过`a`and `b`to `fetchAfter`（除了通过`y`）。

# .net - 为 4.0 扩展 System.Data.Objects 3.5 方法（如 IObjectSet、CreateObjectSet、ContextOptions

> ID：12098463
> 
> 赞同：0
> 
> 时间：2012-08-23T19:10:31.003
> 
> 标签：.net, sharepoint-2010

我正在尝试扩展 System.Data.Objects 3.5 版本以包含一些 System.Data.Objects .Net 4.0 方法（例如 IObjectSet、CreateObjectSet、ContextOptions）。我被迫使用 EF v 1 在 Sharepoint 2010 项目中以 3.5 为目标。我的存储库是在 .Net 4.0 中构建的，如下所示。如何更正此问题以在 3.5 中工作，或扩展 System.Data.Objects 3.5 类以便使用新的 4.0 方法：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Data.Objects;
using System.Linq.Expressions;
using System.Data;
using System.Data.Objects.DataClasses;
using Workflowportal_LINQDAL.Repository.Interface;
using Workflowportal_LINQDAL.Repository.Specification;

namespace Workflowportal_LINQDAL.Repository.Repository
{
    public class Repository<TEntity> : IRepository<TEntity> where TEntity : class
    {
        private ObjectContext _context;
        private readonly IObjectSet<TEntity> _objectSet;

        public Repository(ObjectContext context)
        {
            _context = context;
            _objectSet = _context.CreateObjectSet<TEntity>();
            //_context.ContextOptions.LazyLoadingEnabled = true; Default!
        }

        public Repository(ObjectContext context, bool lazyLoading)
        {
            _context = context;
            _objectSet = _context.CreateObjectSet<TEntity>();
            _context.ContextOptions.LazyLoadingEnabled = lazyLoading;
        }

        public void SaveChanges()
        {
            _context.SaveChanges();
        }

        //public void SaveChanges(SaveOptions options)
        //{
        //    _context.SaveChanges(options);
        //}

        public void AcceptAllChanges()
        {
            _context.AcceptAllChanges();
        }

        public void Add(TEntity entity)
        {
            if (entity == null)
            {
                throw new ArgumentNullException("entity");
            }

            _objectSet.AddObject(entity);
        }

        public void Edit(TEntity entity)
        {
            _objectSet.Attach(entity);
            _context.ObjectStateManager.ChangeObjectState(entity, EntityState.Modified);
        }

        public void Delete(TEntity entity)
        {
            if (entity == null)
            {
                throw new ArgumentNullException("entity");
            }

            _objectSet.DeleteObject(entity);
        }
        public void Delete(Expression<Func<TEntity, bool>> predicate)
        {
            var records = Find(predicate);

            foreach (var record in records)
            {
                Delete(record);
            }
        }

        public void Delete(ISpecification<TEntity> specification)
        {
            throw new NotImplementedException();
        }

        public void DeleteRelatedEntities(TEntity entity)
        {
            if (entity == null)
            {
                throw new ArgumentNullException("entity");
            }

            var releatedEntities =
                ((IEntityWithRelationships)entity).RelationshipManager.GetAllRelatedEnds().SelectMany(
                    e => e.CreateSourceQuery().OfType<TEntity>()).ToList();
            foreach (var releatedEntity in releatedEntities)
            {
                _objectSet.DeleteObject(releatedEntity);
            }
            _objectSet.DeleteObject(entity);

        }

        public IEnumerable<TEntity> GetAll()
        {
            return _objectSet.AsEnumerable();
        }

        public IQueryable<TEntity> GetAllQuery()
        {
            return _objectSet.AsQueryable();
        }

        public IEnumerable<TEntity> GetAllPaged(int page, int pageSize)
        {
            return _objectSet.AsEnumerable().Skip(pageSize).Take(page);
        }

        public IEnumerable<TEntity> Find(Expression<Func<TEntity, bool>> predicate)
        {
            return _objectSet.Where(predicate).AsEnumerable();
        }

        public IQueryable<TEntity> FindQuery(Expression<Func<TEntity, bool>> predicate)
        {
            return _objectSet.Where(predicate).AsQueryable();
        }

        public IEnumerable<TEntity> Find(ISpecification<Func<TEntity, bool>> specification)
        {
            throw new NotImplementedException();
        }

        public IEnumerable<TEntity> FindPaged(int page, int pageSize, Expression<Func<TEntity, bool>> predicate)
        {
            return _objectSet.Where(predicate).Skip(pageSize).Take(page).AsEnumerable();
        }

        public TEntity Single(Expression<Func<TEntity, bool>> predicate)
        {
            return _objectSet.SingleOrDefault(predicate);
        }

        public TEntity Single(ISpecification<Func<TEntity, bool>> specification)
        {
            throw new NotImplementedException();
        }

        public TEntity First(Expression<Func<TEntity, bool>> predicate)
        {
            return _objectSet.FirstOrDefault(predicate);
        }

        public TEntity First(ISpecification<Func<TEntity, bool>> specification)
        {
            throw new NotImplementedException();
        }

        public int Count()
        {
            return _objectSet.Count();
        }

        public int Count(Expression<Func<TEntity, bool>> criteria)
        {
            return _objectSet.Count(criteria);
        }

        public int Count(ISpecification<TEntity> specification)
        {
            throw new NotImplementedException();
        }

        #region IDisposable
        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (!disposing) return;
            if (_context == null) return;
            _context.Dispose();
            _context = null;
        }
        #endregion
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T06:01:44.080

您应该尝试以下适用于 .Net 3.5 的方法

```
namespace Microsoft.Samples.Entity
{

    /// <summary>
    /// There are no comments for SalesOrdersEntities in the schema.
    /// </summary>
    public partial class SalesOrdersEntities : global::System.Data.Objects.ObjectContext
    {
        /// <summary>
        /// Initializes a new SalesOrderEntities object using the connection string found in the 'SalesOrderEntities' section of the application configuration file.
        /// </summary>
        public SalesOrdersEntities() :
            base("name=SalesOrdersEntities", "SalesOrdersEntities")
        {
            this.OnContextCreated();
        }
        /// <summary>
        /// Initialize a new SalesOrderEntities object.
        /// </summary>
        public SalesOrdersEntities(string connectionString) :
            base(connectionString, "SalesOrdersEntities")
        {
            this.OnContextCreated();
        }
        /// <summary>
        /// Initialize a new SalesOrderEntities object.
        /// </summary>
        public SalesOrdersEntities(global::System.Data.EntityClient.EntityConnection connection) :
            base(connection, "SalesOrdersEntities")
        {
            this.OnContextCreated();
        }
        partial void OnContextCreated();
        /// <summary>
        /// There are no comments for LineItemSet in the schema.
        /// </summary>
        public global::System.Data.Objects.ObjectQuery<LineItem> LineItemSet
        {
            get
            {
                if ((this._LineItemSet == null))
                {
                    this._LineItemSet = base.CreateQuery<LineItem>("[LineItemSet]");
                }
                return this._LineItemSet;
            }
        }
        private global::System.Data.Objects.ObjectQuery<LineItem> _LineItemSet;
        /// <summary>
        /// There are no comments for OrderSet in the schema.
        /// </summary>
        public global::System.Data.Objects.ObjectQuery<Order> OrderSet
        {
            get
            {
                if ((this._OrderSet == null))
                {
                    this._OrderSet = base.CreateQuery<Order>("[OrderSet]");
                }
                return this._OrderSet;
            }
        }
        private global::System.Data.Objects.ObjectQuery<Order> _OrderSet;
        /// <summary>
        /// There are no comments for LineItemSet in the schema.
        /// </summary>
        public void AddToLineItemSet(LineItem lineItem)
        {
            base.AddObject("LineItemSet", lineItem);
        }
        /// <summary>
        /// There are no comments for OrderSet in the schema.
        /// </summary>
        public void AddToOrderSet(Order order)
        {
            base.AddObject("OrderSet", order);
        }
    }
} 
```

# objective-c - UITableViewCell 崩溃 didReceiveMemoryWarning

> ID：12098465
> 
> 赞同：0
> 
> 时间：2012-08-23T19:10:37.370
> 
> 标签：objective-c, ios, uitableview, mfmailcomposeviewcontroller, didreceivememorywarning

我有一个自定义 UITableViewCell 扩展 UITableViewCell 并实现`MFMailComposeViewControllerDelegate`. （即`UITableViewCell<MFMailComposeViewControllerDelegate>`）。

当在自定义表格单元格中单击按钮时，我会呈现一个带有`presentModalViewController`. 然后用户可以键入电子邮件或取消，一切正常。

但是当`didReceiveMemoryWarning`mailController 存在时被调用，然后当 mailController 关闭时，应用程序崩溃。我收到此错误：

> “-[CustomCell respondsToSelector:]: 消息发送到已释放实例 0xf4988b0”

现在我很确定它是因为拥有 tablecell 的表视图已被释放，因此单元格已被释放，但有没有人有任何建议来解决这个问题？我的意思是我想我可以将 MailCompose 委托切换到表格单元格的表格视图的视图控制器，但我宁愿不这样做。我宁愿把它放在表格单元格中。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:19:41.497

您不应该将表格视图单元格用作 MFMailComposeViewControllerDelegate。由于单元格的性质及其重用，很难将特定实例固定为委托，尤其是在显示单元格的视图控制器之上的视图控制器的委托，在这种特殊情况下，内存警告可能会导致单元缓存的刷新。

MFMailComposeViewControllerDelegate 应该是单元格所在的表视图的委托。这也是一种更好的 MVC 模式。

# php - Google Drive 是否可以使用 POST 参数重定向，GET 参数会导致 403

> ID：12098466
> 
> 赞同：0
> 
> 时间：2012-08-23T19:10:39.463
> 
> 标签：php, google-drive-api

当 Google Drive 将文件打开事件重定向到我的 PHP 处理程序回调页面时，我的服务器响应 403 错误。我发现这是因为它无法处理 GET 参数中的 JSON，所以有什么方法可以清理这个重定向并告诉 Google Drive 通过 POST 参数发送它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T17:19:37.983

不幸的是，现在不可能 - 抱歉。为什么您在读取 ​​GET 参数中的 JSON 时遇到问题？您是否看过[PHP 示例](https://developers.google.com/drive/examples/php)以了解如何做到这一点？

# c++ - OpenCV 2.4.2：未定义的引用

> ID：12098470
> 
> 赞同：2
> 
> 时间：2012-08-23T19:10:48.757
> 
> 标签：c++, opencv, g++

*   libcv开发安装
*   10.04

关于以下定义的任何想法？

```
ahcarpenter@ahcarpenter-laptop:~$ g++ objectmarker.o -o objectmarker
objectmarker.o: In function `on_mouse(int, int, int, int, void*)':
objectmarker.cpp:(.text+0x12f): undefined reference to `cvCloneImage'
objectmarker.cpp:(.text+0x1d1): undefined reference to `cvRectangle'
objectmarker.cpp:(.text+0x1ea): undefined reference to `cvShowImage'
objectmarker.cpp:(.text+0x1f4): undefined reference to `cvReleaseImage'
objectmarker.o: In function `main':
objectmarker.cpp:(.text+0x391): undefined reference to `cvNamedWindow'
objectmarker.cpp:(.text+0x3aa): undefined reference to `cvSetMouseCallback'
objectmarker.cpp:(.text+0x4da): undefined reference to `cvLoadImage'
objectmarker.cpp:(.text+0x50f): undefined reference to `cvShowImage'
objectmarker.cpp:(.text+0x519): undefined reference to `cvWaitKey'
objectmarker.cpp:(.text+0x53f): undefined reference to `cvReleaseImage'
objectmarker.cpp:(.text+0x54e): undefined reference to `cvDestroyWindow'
objectmarker.cpp:(.text+0xd7f): undefined reference to `cvReleaseImage'
objectmarker.cpp:(.text+0xdf3): undefined reference to `cvDestroyWindow'
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-16T20:26:11.220

我试过这个，它对我有用：

```
sudo g++ -I/usr/include/opencv main.cpp -o main -lopencv_core -lopencv_imgproc
 -lopencv_highgui -lopencv_ml -lopencv_video -lopencv_features2d -lopencv_calib3d
 -lopencv_objdetect -lopencv_contrib -lopencv_legacy -lopencv_flann -I /lib/
 -I /home/ubuntu/micros/opencv_directory/include/opencv 
```

我是从：[https ://askubuntu.com/questions/239891/opencv-program-wont-compile-quantal](https://askubuntu.com/questions/239891/opencv-program-wont-compile-quantal)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T19:14:07.177

看来您没有链接到 OpenCV 库；根据[本指南](http://www.ozbotz.org/opencv-installation/)，编译 OpenCV 程序的一种方法（在正确配置 OpenCV 之后）是

```
g++ `pkg-config opencv --cflags` my_code.cpp  -o my_code `pkg-config opencv --libs` 
```

如果您的 C++ 代码是在单独的步骤中编译的，您可能会删除该`--cflags`部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:33:06.557

您需要包含使用 pkg-config 和 cflags 的库。

```
$ g++ -ggdb `pkg-config --cflags opencv` -o `basename filename.cpp .cpp` filename.cpp `pkg-config --libs opencv 
```

有关更多详细信息，请参阅此链接[http://www.jayrambhia.com/blog/2012/05/08/beginning-opencv/](http://www.jayrambhia.com/blog/2012/05/08/beginning-opencv/)

# objective-c - 在 UIImage 中编辑颜色字节

> ID：12098473
> 
> 赞同：0
> 
> 时间：2012-08-23T19:11:11.127
> 
> 标签：objective-c, ios, uiimage, bytearray, rgba

我对在字节级别上使用 UIImages 很陌生，但我希望有人能指出我关于这个问题的一些指南？

我最终希望根据某些参数（位置、颜色等）编辑字节的 RGBA 值，我知道我以前遇到过示例/教程，但我似乎找不到任何东西现在。

基本上，我希望能够将 UIImage 分解为其字节并对其进行迭代并单独编辑字节的 RGBA 值。也许这里的一些示例代码也会有很大帮助。

我已经在不同的图像上下文中工作并使用 CG 电动工具编辑图像，但我希望能够在字节级别上工作。

编辑：

抱歉，但我明白您不能直接编辑 UIImage 中的字节。我应该更清楚地问我的问题。我的意思是问如何获取 UIImage 的字节，编辑这些字节，然后从这些字节创建一个新的 UIImage。

[正如@BradLarson 所指出的，OpenGL 是一个更好的选择，这里](https://github.com/BradLarson/GPUImage)有一个很棒的库，由@BradLarson 创建。感谢@CSmith 指出！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:55:10.667

@MartinR 有正确答案，这里有一些代码可以帮助您入门：

UIImage *image = 你的图片；

```
CGImageRef imageRef = image.CGImage;
NSUInteger nWidth = CGImageGetWidth(imageRef);
NSUInteger nHeight = CGImageGetHeight(imageRef);
NSUInteger nBytesPerRow = CGImageGetBytesPerRow(imageRef);
NSUInteger nBitsPerPixel = CGImageGetBitsPerPixel(imageRef);
NSUInteger nBitsPerComponent = CGImageGetBitsPerComponent(imageRef);
NSUInteger nBytesPerPixel = nBitsPerPixel == 24 ? 3 : 4;

unsigned char *rawInput = malloc (nWidth * nHeight * nBytesPerPixel);

CGColorSpaceRef colorSpaceRGB = CGColorSpaceCreateDeviceRGB();
CGContextRef context = CGBitmapContextCreate(rawInput, nWidth, nHeight, nBitsPerComponent, nBytesPerRow, colorSpaceRGB, kCGImageAlphaNoneSkipFirst | kCGBitmapByteOrder32Big);
CGContextDrawImage (context, CGRectMake(0, 0, nWidth, nHeight), imageRef);          

// modify the pixels stored in the array of 4-byte pixels at rawInput
.
.
.

UIImage *imageNew = [[UIImage alloc] initWithCGImage:CGBitmapContextCreateImage(context)];

CGContextRelease (context);
free (rawInput); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:44:41.343

您无法直接访问 an 中的字节，`UIImage`也无法直接更改它们。

您必须将图像绘制到 a`CGBitmapContext`中，修改位图中的像素，然后从位图上下文中创建一个新图像。

# amazon-s3 - boto 上传“400 错误请求”超时

> ID：12098474
> 
> 赞同：0
> 
> 时间：2012-08-23T19:11:12.563
> 
> 标签：amazon-s3, boto

我从这个脚本开始：

> [http://zh.soup.io/post/114280923/Django-Media-on-Amazon-S3-Fabric-Deploy](http://zh.soup.io/post/114280923/Django-Media-on-Amazon-S3-Fabric-Deploy)

我可以查询存储桶对象的 URL，因此与 S3 的连接似乎有效。但是每次我尝试使用代码上传测试文件时

```
key.set_contents_from_file(fid)
key.set_acl('public-read') 
```

我得到了这个响应（注意`fid`顶部的打印）：

![在此处输入图像描述](../Images/2df16fcf0885e0af9238391fc07997fe.png)

有任何想法吗？谢谢...

# gwt - GWT MAP 3.8 (Google API) - 是否需要 onResize() 来隐藏“灰色背景”？

> ID：12098475
> 
> 赞同：5
> 
> 时间：2012-08-23T19:11:19.743
> 
> 标签：gwt, google-maps-api-3

我的问题：
- 我在弹出窗口中显示了一张地图，并且我已经卸载了瓷砖（灰色背景）。- 如果我缩小或缩小，那么地图将填满整个空间（不再有灰色背景）。

我的问题：
-您对我的问题有任何想法（我是否需要调整大小以隐藏“灰色背景”）？
- 我不知道我是否应该在 Runnable 回调（代码在上面）中调用 onResize() 或不？

谢谢，

我的实际代码：（我正在使用 javaxLoaderAPI）

// 入口点

> ```
>  GoogleMap map;
>   @UiField LayoutPanel gmap;
> 
>   public void AjaxLoader_MAP() {
> 
>           AjaxLoaderOptions options = AjaxLoaderOptions.newInstance();
> 
>           options.setOtherParms("key=***&sensor=false&language=es");
> 
>           Runnable callback = new Runnable() {
>              public void run() {
>                 gmap.onResize();         // Should I call onResize() here  ? 
>                 map = GoogleMap.create(gmap.getElement());    
>              };
>           }
> 
>           AjaxLoader.loadApi("maps", "3", callback, options);
>  } 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-29T17:25:48.477

可能与以下帖子有关 - [GWT Google Map Api V3 - 更改时损坏](https://stackoverflow.com/questions/15799547/gwt-google-map-api-v3-broken-when-changing-it)

我刚刚也发布了对该未答复帖子的答案。我相信它也回答了这一问题并提供了见解。

我知道这是一个旧帖子，但如果有帮助，请告诉我！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-13T01:38:19.600

当调用 mapWidget.triggerResize() 时，重要的是要延迟调用它 (Timer.schedule())，以便所有小部件都已重置，然后地图会调整大小。

这就是我触发它的方式：

```
@Override
protected void onReset() {
    super.onReset();
    Timer timer = new Timer() {
        @Override
        public void run() {
            triggerResize();
        }
    };
    timer.schedule(100);
} 
```

没有计时器，我仍然得到灰色瓷砖。希望有人仍然觉得它有用。

# jquery - 在formtastic中使用隐藏字段

> ID：12098477
> 
> 赞同：0
> 
> 时间：2012-08-23T19:11:22.623
> 
> 标签：jquery, ruby-on-rails, formtastic

我正在使用 formtastic，如果用户切换类型，则字段从选择切换到字符串输入。

```
=f.input :name, :collection => Item::NAMES, :as => :select
=f.input :name 
```

这可行，但我需要将这些更改写入隐藏字段并将其传回。

```
=f.input :name, :as => :hidden 
```

现在我正在尝试使用 jquery 来检测更改并将其写入隐藏字段。

```
$('#product_name').change(function(){
   ... write to field
}); 
```

如何写入隐藏字段？或简化在字段生成中使用的标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:15:58.150

更改隐藏字段的值

```
$('#name').val('somevalue'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:19:45.683

```
=f.input :name, :as => :hidden ,:id=> "name"

$('#product_name').change(function(){
  $('#name').val("xyzzz");
}); 
```

该字段将自动与其他参数一起发布。

# json - Netty HTTPRequest 未捕获发布的 JSOn

> ID：12098479
> 
> 赞同：2
> 
> 时间：2012-08-23T19:11:34.323
> 
> 标签：json, post, netty

我正在尝试在后端使用 Netty 构建 REST 服务。我需要能够将原始 JSON 发布到任何键/值参数之外的服务。Content-type=applicaiton/json 不形成多部分。

我能够让服务的初始部分接收请求，但是当我将 MessageEvent 内容转换为 HTTPRequest 时，它不再有任何与之关联的姿势数据。这让我无法取回 JSON 数据。

为了访问发布的 JSON，我是否需要使用不同的流程从 MessageEvent 中提取数据？

这是有问题的片段。

```
 @Override
public void messageReceived(ChannelHandlerContext ctx, MessageEvent e) throws Exception {
    System.out.println("The message was received");
    HttpRequest request = (HttpRequest) e.getMessage();
    if (request.getMethod() != POST) {
        sendError(ctx, METHOD_NOT_ALLOWED);
        return;
    }

    // Validate that we have the correct URI and if so, then parse the incoming data.

    final String path = sanitizeUri(request.getUri());
    decoder = new HttpPostRequestDecoder(request);
    System.out.println("We have the decoder for the request");
    List<InterfaceHttpData> datas = decoder.getBodyHttpDatas();
    for (InterfaceHttpData data : datas){
     System.out.println(data.toString());
    } 
```

我错过了什么导致这种情况？我需要使用 ChunkedWrite 部分吗？我是 Netty 的菜鸟，所以如果这是基本的，请原谅我。我发现了很多其他关于从 Netty 内部将原始 JSON 发布到其他 URL 的问题，但没有关于接收它的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T23:14:07.693

我只习惯于`HttpPostRequestDecoder`读取`application/x-www-form-urlencoded`或模拟数据。

尝试按照[snoop](https://github.com/netty/netty/blob/3/src/main/java/org/jboss/netty/example/http/snoop/HttpSnoopServerHandler.java)示例直接从请求中读取数据。

```
ChannelBuffer content = request.getContent();
if (content.readable()) {
    String json = content.toString(CharsetUtil.UTF_8);
} 
```

# android - 在 Android 上验证用户但在远程服务器上处理？

> ID：12098483
> 
> 赞同：1
> 
> 时间：2012-08-23T19:11:45.403
> 
> 标签：android, oauth-2.0, google-api-java-client

我想为我们的 Android 应用程序开发一个新选项，允许新用户使用他们的**Google**帐户登录。我们需要检索基本的用户信息（名字、姓氏、出生日期、电子邮件、国家等）并将它们存储在服务器上。它应该仅在用户第一次登录应用程序时发生，因此下次按钮所做的所有操作都是简单的身份验证以访问成员区域。

`oauth2`目前，我们的应用程序使用和提示权限，并且可以通过[oauth2 api](https://developers.google.com/apis-explorer/#p/oauth2/v2/oauth2.userinfo.get)`AccountManager`检索用户信息。我想在我们的服务器上做同样的事情。

所以在这里总结一下是我正在考虑的流程：

1.  用户选择使用**Google登录**
2.  如果他尚未授权该应用程序，请请求访问他的信息的权限；检索并将它们存储在服务器上并登录。如果他已经授权该应用程序，只需登录即可。

不过，我们仍然需要在他的 Android 设备上保存用户信息的本地副本，以便他可以查看自己的个人资料。

**注意：**我考虑在我们的服务器上进行数据导入过程的原因是为了加快应用程序的速度并节省一些带宽。但我也觉得用户可能想在保存到服务器之前修改他的数据。

我真的很困惑，oauth2 文档并没有太大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:27:30.807

我不明白这个问题。对不起。

只需从 OAuth api 检索有关客户的信息，通过 HTTP/HTTPS 发布请求将信息发送到服务器，并将其保存在那里。然后将相同的信息保存在手机中的 SQLite 数据库中，并在第一次启动应用程序后检查 SQLite 中的用户表是否存在客户。

这是一个很棒的例子：[http ://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/](http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-06T17:17:00.183

为此，您需要遵循Google提供的[跨平台单点登录](https://developers.google.com/+/mobile/android/sign-in#cross-platform_single_sign_on)和[跨客户端身份验证文档。](https://developers.google.com/accounts/docs/CrossClientAuth)本质上，您的流程应该是：

1.  检查用户是否已通过身份验证（可能最好作为远程系统的 POST），如果是，请继续您的主要活动。如果没有，请显示登录按钮。
2.  用户单击登录后，连接 GoogleApiClient，检索当前人员，将他们的信息保存在设备上（如果需要）。
3.  [通过GoogleAuthUtil.getToken](http://developer.android.com/reference/com/google/android/gms/auth/GoogleAuthUtil.html#getToken%28android.content.Context,%20java.lang.String,%20java.lang.String%29)为用户请求一个身份验证令牌。
4.  将令牌发送到您的 Web 服务器（必须是 https）。在您的 Web 服务器上，从令牌中检索用户信息，并将其保存到数据库中。

另外，我建议您为您的请求使用持久性 cookie 存储（我更喜欢 loop4j 的[Android Async-HttpClient](http://loopj.com/android-async-http/)）。这将允许您轻松保存会话，因此您不必过于频繁地进行身份验证。

# php - Symfony2 和 Doctrine：一对多关系

> ID：12098490
> 
> 赞同：3
> 
> 时间：2012-08-23T19:12:20.883
> 
> 标签：php, symfony, doctrine, doctrine-orm

我正在用 Symfony2 和 Doctrine 编写应用程序。以下是所有可能需要的代码：

[https://gist.github.com/3440325](https://gist.github.com/3440325)

此代码块工作正常并正确创建关系：

```
 $twitter->setUser($user);
        $skype->setUser($user); 
```

正常工作意味着它会在 users 表中创建一行，并在 handles 表中插入正确的用户 ID。

其中，此代码块无法按预期工作：

```
$user->addHandle($skype);
$user->addHandle($twitter); 
```

它成功插入了所有条目，但无法在句柄表中插入正确的用户 ID。事实上，user_id 列仍然是空的。

这里出了什么问题？我错过了什么吗？我的期望是不正确的还是在某些地方存在一些错误？

——马斯努

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:31:56.563

由于您具有双向的一对多关系，因此您需要同步设置双方的引用实体。

```
public function addHandle(\WeCodePHP\HomeBundle\Entity\Handle $handles)
{
    $this->handles[] = $handles;
    $handles->setUser($this);
} 
```

否则学说不会猜测句柄属于什么。

# jfreechart - 在 Jfreechart 甘特图中画一条水平虚线

> ID：12098491
> 
> 赞同：1
> 
> 时间：2012-08-23T19:12:35.747
> 
> 标签：jfreechart, gantt-chart

有谁知道如何在甘特图中的特定位置移动/绘制虚线？例如，我有如下图表：

[链接到图片](http://imageshack.us/f/834/81188251.png/)

并且很难看出任务 1 栏在哪里，任务 2 栏在哪里，任务 3 在哪里。

如果可以在整个系列之后而不是在 1,2,3 行中绘制水平线，以明确视觉分隔符。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:35:40.177

您可能想要其中之一，[`org.jfree.chart.annotations`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/annotations/package-summary.html)例如`CategoryLineAnnotation`.

# database - 如何清除火鸟查询缓存？

> ID：12098493
> 
> 赞同：5
> 
> 时间：2012-08-23T19:12:43.830
> 
> 标签：database, firebird, database-administration

如何清除 firebird 查询缓存以执行我的性能测试？

SqlServer 中的示例在[这里](http://www.mssqltips.com/sqlservertip/1360/clearing-cache-for-sql-server-performance-testing/)

Tks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:33:10.933

Andrei 是正确的——Firebird 严重依赖操作系统文件系统缓存。Firebird 将在内部缓存少量页面（检查数据库上的缓冲区属性），但它通常是非常少量的数据。经典默认为 75 页？我在其他地方看到了大约 1000 页的建议，根据页面大小，最终大小为 8 或 16 MB。

代替重新启动操作系统以清除文件系统缓存，您可以将数据库放在自己的挂载上。然后要完全清除缓存，您可以停止 Firebird，卸载/安装分区并再次启动 Firebird。这将使文件系统缓存无效。

这应该不会太痛苦——与其他数据库不同，Firebird 不必在启动时扫描数据文件并在事务日志中重放事务。翻译日志本质上是通过仔细写入与数据文件结合在一起的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:35:12.650

除了经常访问的数据页的内存缓冲区之外，Firebird 还依赖于操作系统文件缓存。重新启动服务器进程可以清空内存缓冲区，但要清除文件缓存，恐怕需要重新启动操作系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:19:01.417

我认为重新启动 Firebird 服务是最简单（唯一？）的方法。

# python - 测试失败，因为夹具不存在

> ID：12098494
> 
> 赞同：0
> 
> 时间：2012-08-23T19:12:45.913
> 
> 标签：python, django, unit-testing

Django 1.3 版。

我是 Django 单元测试的新手。我已经编写了我的第一个测试，但它失败了，因为我的登录不起作用。我很确定这样做的原因是数据库不包含我应该由`auth`夹具提供的用户帐户。

我写的代码是：

```
from django.test import TestCase
from django.test.client import Client

class OrderCreateTest(TestCase):
    fixtures = ['auth']

    def setUp(self):
        self.client = Client()

    def testSelectProduct(self):
        self.assertTrue(self.client.login(user='chris', password='password'),
            'Unexpected login failure.')

        response = self.client.get('/order/new/')

        print response

        self.client.logout()

    def tearDown(self):
        pass

    def runTest(self):
        pass 
```

我得到的测试失败是：

```
Creating test database for alias 'default' ('test_proj')...
Creating tables ...
...
Running post-sync handlers for application admin
...
Installing custom SQL ...
Installing indexes ...
Installing index for admin.LogEntry model
...
Running post-sync handlers for application admin
...
Loading 'initial_data' fixtures...
Checking '/usr/local/lib/python2.7/dist-packages/django/contrib/admin/fixtures' for fixtures...
No xml fixture 'initial_data' in '/usr/local/lib/python2.7/dist-packages/django/contrib/admin/fixtures'.
...
Checking absolute path for fixtures...
No xml fixture 'initial_data' in absolute path.
No xml fixture 'initial_data' in absolute path.
No xml fixture 'initial_data' in absolute path.
No xml fixture 'initial_data' in absolute path.
No json fixture 'initial_data' in absolute path.
No json fixture 'initial_data' in absolute path.
No json fixture 'initial_data' in absolute path.
No json fixture 'initial_data' in absolute path.
No yaml fixture 'initial_data' in absolute path.
No yaml fixture 'initial_data' in absolute path.
No yaml fixture 'initial_data' in absolute path.
No yaml fixture 'initial_data' in absolute path.
No xml fixture 'initial_data' in absolute path.
No xml fixture 'initial_data' in absolute path.
No xml fixture 'initial_data' in absolute path.
No xml fixture 'initial_data' in absolute path.
No json fixture 'initial_data' in absolute path.
No json fixture 'initial_data' in absolute path.
No json fixture 'initial_data' in absolute path.
No json fixture 'initial_data' in absolute path.
No yaml fixture 'initial_data' in absolute path.
No yaml fixture 'initial_data' in absolute path.
No yaml fixture 'initial_data' in absolute path.
No yaml fixture 'initial_data' in absolute path.
No fixtures found.
Destroying test database for alias 'default' ('test_proj')...
testSelectProduct (orpheus.orders.tests.ordercreate.OrderCreateTest) ... FAIL

======================================================================
FAIL: testSelectProduct (orpheus.orders.tests.ordercreate.OrderCreateTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/path/to/ordercreate.py", line 24, in testSelectProduct
    'Unexpected login failure.')
AssertionError: Unexpected login failure.

----------------------------------------------------------------------
Ran 1 test in 2376.829s

FAILED (failures=1)
Destroying test database for alias 'default' ('test_proj')... 
```

从我的数据库设置片段：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'project',
        'USER': 'project',
        'PASSWORD': 'projectdb',
        'TEST_NAME': 'test_project' } } 
```

我已经逐步完成了测试代码，我可以看到它正在找到我的夹具`auth`并且它正在保存它找到的数据......某处。我已暂停测试以放入 mysql 并查询相关表，但它们都保持为空（测试代码已跳过处理事务的部分，因此我确信我不应该等待提交）。

我在做什么或不做什么使我的固定装置无法正确加载？

**编辑：**我有一个绝妙的主意来测试加载夹具并且它成功了：

```
$ ./manage.py loaddata auth
Installed 8 object(s) from 1 fixture(s) 
```

但是，这并没有给我任何关于如何修复夹具加载的想法。

**编辑：**当他建议我尝试这个时，supervacuo 提供了一个线索：

```
./manage.py testserver -v 2 auth.json 
```

输出基本相同，只是它正确加载了fixture（mysql确认了它）：

```
...
Installed 8 object(s) from 1 fixture(s)
Validating models...
0 errors found

Django version 1.3, using settings 'project.settings'
Running django-devserver 0.1.4 
```

我不知道从那里去哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T20:29:39.357

问题与看起来完全不同。在我的测试中，我写道：

```
 self.assertTrue(self.client.login(user='chris', password='password'),
        'Unexpected login failure.') 
```

当关键字 arg 应该改为`username`. 我遵循了数据库中丢失数据的红鲱鱼，这是由[transactions](https://docs.djangoproject.com/en/1.3/topics/testing/#django.test.TestCase)解释的。

感谢 #django 中的 mlvin 的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:43:00.213

我想它与测试数据库有关（正如您最初的直觉所暗示的那样）。如果您查看[Django 的相关代码](https://github.com/django/django/blob/stable/1.4.x/django/test/testcases.py#L464)，它只是在`loaddata`内部运行：

```
# django/test/testcases.py
if hasattr(self, 'fixtures'):                                           
    # We have to use this slightly awkward syntax due to the fact   
    # that we're using *args and **kwargs together.                     
    call_command('loaddata', *self.fixtures,                            
                 **{'verbosity': 0, 'database': db}) 
```

因此，如果`loaddata`在测试之外工作（显然是这样），问题肯定出在其他地方。鉴于它适用于`./manage.py testserver`，我怀疑您的代码库中的某些内容正在检查`sys.argv`和`test`修改您的数据库设置，从而忽略了固定装置。你`grep`能把你的项目`test`放在意想不到的地方吗？我有一个`settings.py`这样的部分：

```
if 'test' in sys.argv:                              
    # Switch to sqlite for tests (it's *way* faster)                              
    DATABASE_ENGINE = 'sqlite3' 
```

# python - 我如何在理论上对秒表进行编程？

> ID：12098496
> 
> 赞同：2
> 
> 时间：2012-08-23T19:12:48.980
> 
> 标签：python, timer, sleep, stopwatch

这是我在 stackoverflow.com 上的第一个问题，所以请对我宽容:) 我有一个关于如何从理论上创建秒表程序的问题。用哪种语言编写对我来说并不重要。理论上可以吗？

```
a = 0
While 1 == 1:
    Print(a)
    Sleep(1s)
    a = a+1 
```

这对我来说应该没问题，但是在 Python 中运行类似的东西时，它不能准确地打印出来。用我的“现实生活”模拟秒表测量，有时不到 1 秒，有时超过 1 秒。我想知道的是如何仅在理论上创建秒表，我不需要实际的代码。我希望你能理解我的问题，等待回复:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T19:20:12.800

看看这个：[Python中的秒表](https://stackoverflow.com/questions/5890304/stopwatch-in-python)

所以，回答你的问题：是的，这是可能的。

至于你原始代码的准确性：[python的time.sleep()有多准确？](https://stackoverflow.com/questions/1133857/how-accurate-is-pythons-time-sleep)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:32:05.890

`sleep`, 不能保证在给定的确切时间内睡觉；它会睡大约那个时间，但它可能会有点偏离。当然，如果每次都偏离同一个方向，那会开始累积，最终你的答案会很偏离。

幸运的是，您的计算机带有一个不会很快漂移的时钟，您可以将其用作秒表。与其每次睡一秒钟，不如睡更短的时间（例如百分之一秒）。每次醒来，测试当前时间。如果距您的开始时间还有一秒钟，请打印它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:34:14.420

打印以非常规方式发生的原因可能是输出正在缓冲。如果您禁用标准输出的缓冲，它应该可以按预期工作；请参阅[禁用输出缓冲](https://stackoverflow.com/questions/107705/python-output-buffering)。

运行现有脚本时，您可以通过提供`-u`选项来实现`python`（至少在 Linux 上）。来自`man python`：

> -u 强制标准输入、标准输出和标准错误完全无缓冲。在重要的系统上，还将标准输入、标准输出和标准错误置于二进制模式。请注意，在 xreadlines()、readlines() 和文件对象迭代器（“for line in sys.stdin”）中有内部缓冲，不受此选项的影响。要解决此问题，您需要在“while 1:”循环中使用“sys.stdin.readline()”。

# mysql - 获取上周每个结果的计数摘要

> ID：12098502
> 
> 赞同：0
> 
> 时间：2012-08-23T19:13:14.717
> 
> 标签：mysql, sql, count

我目前有一个给定表格的前 X 个结果列表，对于给定的一天，其中“顶部”定义为具有最高聚合计数的结果。我希望能够看到的不仅仅是特定日期的计数，还有它与昨天计数的比较，以及上周计数的平均值。

这是我当前的查询：

```
SELECT foo, bar, SUM(count) as today
FROM tablename
WHERE col1 = 'asdf' and date = '2012-08-23'
GROUP BY foo, bar
ORDER BY count desc
LIMIT 5 
```

结果看起来像：

```
|foo        | bar        | today |
|something1 | something3 | 2345  |
|something2 | something4 | 1234  |
 .... 
```

但我想要的是这样的：

```
|foo        | bar        | today | yesterday | week_avg |
|something1 | something3 | 2345  | 2273      | 2193     |
|something2 | something4 | 1234  | 935       | 1001     |
 .... 
```

作为奖励积分，我不介意在某种 GROUP_CONCAT 结果中包含过去 20 天的所有日期（所以我可以轻松地用它制作迷你图）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:39:39.027

您可以获取上周的所有行，然后使用条件聚合（通过[`CASE`表达式](http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html#operator_case)）仅对`count`当天的`count`值和昨天的值求和：

```
SELECT   foo, 
         bar,
         SUM(CASE WHEN date = CURDATE() THEN count ELSE 0 END) AS today,
         SUM(CASE WHEN date = CURDATE() - INTERVAL 1 DAY THEN count ELSE 0 END) AS yesterday,
         AVG(count) AS week_avg
FROM     tablename
WHERE    col1  = 'asdf' AND
         date >= CURDATE() - INTERVAL 1 WEEK
GROUP BY foo,
         bar
ORDER BY today DESC
LIMIT    5 
```

最后，我们按今天的`count`值的总和排序，并根据该顺序选择前五名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:36:00.013

一旦您准备好包含日期和日期金额的汇总表，并假设您正在寻找与昨天的差异，您可以使用`COALESCE`. 下`tbl`表是指您的汇总表，如下所示：

```
SELECT date, foo, bar, SUM(count) as today
FROM tablename
WHERE col1 = 'asdf'
GROUP BY date, foo, bar
ORDER BY count desc
LIMIT 5 
```

**查询**

```
SELECT a.ddate, a.amount AS today, 
COALESCE(a.amount - 
  (SELECT b.amount 
   FROM tbl b 
   WHERE b.ddate = a.ddate - INTERVAL 1 DAY), a.amount) AS yesterday
FROM tbl a 
```

见[小提琴](http://sqlfiddle.com/#!2/59a9a/2)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:39:56.423

你的第一个问题。试试这个：

```
 SELECT day0.foo, day0.bar, 
        day0.addup as today, 
        day1.addup as yesterday, 
        week0.addup/7 as week_avg
   FROM 
  ( 
    SELECT foo, bar, SUM(count) as addup
      FROM tablename
     WHERE col1 = 'asdf'
       AND date >= CURDATE()
       AND date < CURDATE() + INTERVAL 1 DAY
  GROUP BY foo, bar
  ) day0
  JOIN ( 
    SELECT foo, bar, SUM(count) as addup
      FROM tablename
     WHERE col1 = 'asdf'
       AND date >= CURDATE() - INTERVAL 1 DAY
       AND date < CURDATE()
  GROUP BY foo, bar
  ) day1 ON (day0.foo = day1.foo AND day0.bar=day1.bar)
  JOIN ( 
    SELECT foo, bar, SUM(count) as addup
      FROM tablename
     WHERE col1 = 'asdf'
       AND date >= CURDATE() - INTERVAL 7 DAY
       AND date < CURDATE()
  GROUP BY foo, bar
  ) week0 ON (day0.foo = week0.foo AND day0.bar = week0.bar)
 ORDER BY day0.addup desc
    LIMIT 5 
```

它看起来很麻烦，但它是三个不同摘要查询的连接，每天一个。

你的第二个问题：

```
SELECT foo, bar, GROUP_CONCAT(addup)
  FROM (
    SELECT foo, bar, 
           DATEDIFF(CURDATE(),date) AS daysago, 
           SUM(count) as addup
      FROM tablename
     WHERE col1 = 'asdf'
       AND date >= CURDATE() - INTERVAL 20 DAY
       AND date < CURDATE() )A
  GROUP BY foo, bar, date
  ORDER BY foo, bar, date 
```

# c# - 如何从 JavaScript 调用 LinkBut ton OnClick 事件？

> ID：12098508
> 
> 赞同：1
> 
> 时间：2012-08-23T19:13:50.740
> 
> 标签：c#, javascript, jquery, asp.net

在我的情况下，页面上有一个 LinkBut​​ton：

```
<asp:LinkButton ID="LinkButton5" runat="server" OnClick="LinkButton5_Click">Delete</asp:LinkButton> 
```

当用户单击它时，选择的文件将被删除。为了便于使用，我添加了一个 HotKey JavaScript：

```
<script type="text/javascript" src="Java/Jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="Java/Jquery.hotkeys-0.7.9.js"></script>

<script type="text/javascript">
    function domo() {
        jQuery('#platform-details').html('<code>' + navigator.userAgent + '</code>');
        jQuery(document).bind('keydown', 'esc', function (evt) { alert("ESC"); return false; });
        jQuery(document).bind('keydown', 'space', function (evt) { alert("SPACE"); return false; });
        jQuery(document).bind('keydown', 'del', function (evt) { alert("DEL"); return false; });
    }

    jQuery(document).ready(domo);
</script> 
```

因此，您按下键盘上的删除按钮 JavaScript 会提醒您它已被点击。:) 我需要点击 Del 按钮 LinkBut​​ton5 应该被点击。我真的不知道如何连接 javascript 调用以下 OnClick 事件。请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T04:43:18.653

您可以使用以下代码..

警报后添加代码（'DEL'）；

```
var btn = document.getElementById('<%=LinkButton5.ClientID%>');
btn.click(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-05T04:34:20.683

```
document.getElementById('<%=LinkButton5.ClientID%>').click(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:21:30.347

尝试将此行添加到您的脚本文件

```
jQuery(document).bind('keydown', 'del', function (evt) { alert("DEL");$('#<%=LinkButton5.ClientID%>').trigger('click'); return false; }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T19:24:20.447

代替：

```
alert("DEL"); return false; 
```

和

```
<%= ClientScript.GetPostbackEventReference(LinkButton5, null) %> 
```

# android - android在将json对象从url解析到listview时面临空点异常

> ID：12098510
> 
> 赞同：0
> 
> 时间：2012-08-23T19:13:57.277
> 
> 标签：android, listview, android-arrayadapter, json

我正在尝试解析 json 对象以将其填充到列表视图中，但我遇到了一些问题，请帮忙

我收到 NullpointerException

这是我的完整代码：

我正在从以下 url 解析数据

[我正在解析的 URL 是](http://www.kaverisoft.com/careers/assignments/android/a1.json)

解析数据的代码

```
 public class JSONParser {

static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

public JSONParser(){

}

public JSONObject getJSONFromUrl(String url){

//making Http request
try{
//default httpclient    
DefaultHttpClient httpClient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost(url);

HttpResponse httpResponse = httpClient.execute(httpPost);
HttpEntity httpEntity = httpResponse.getEntity();
is = httpEntity.getContent();

}
    catch (UnsupportedEncodingException e) {
    e.printStackTrace();
    }
catch (ClientProtocolException e) {
    e.printStackTrace();

}
catch(IOException e){
    e.printStackTrace();
    }
    try{
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);

        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();
        json = sb.toString();
    } 
catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        jObj = new JSONObject(json);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jObj;

} 
```

}

```
here is activity code

public class AndroidJSONParsingActivity extends ListActivity {

// url to make request
private static String url = "http://www.kaverisoft.com/careers/assignments/android/a1.php";

// JSON NAme Node

private static final String TAG_BOOK = "book";
private static final String TAG_ID = "id";
private static final String TAG_TITLE = "title";
private static final String TAG_AUTHORS = "authors";
private static final String TAG_DESCRIPTION = "description";
private static final String TAG_PRICE = "price";

//Book JSONArray
JSONArray book = null;

@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    // HashMap for ListView

    ArrayList<HashMap<String, String>> bookList = new ArrayList<HashMap<String, String>>();

    // creating Json parser instance
    JSONParser jParser = new JSONParser();

    // getting Json String from url

    JSONObject json = jParser.getJSONFromUrl(url);

    try{
        // getting array of books

        book = json.getJSONArray(TAG_BOOK);

    // looping through all books

        for(int i=0;i<book.length();i++){

            JSONObject c = book.getJSONObject(i);

            // storing each json item in variable

            String title = c.getString(TAG_TITLE);
            String price = c.getString(TAG_PRICE);
            String authors = c.getString(TAG_AUTHORS);
            String id = c.getString(TAG_ID);
            String description = c.getString(TAG_DESCRIPTION);

            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();

            map.put(TAG_ID, id);
            map.put(TAG_TITLE, title);
            map.put(TAG_PRICE, price);
            map.put(TAG_AUTHORS, authors);
            map.put(TAG_DESCRIPTION, description);

            bookList.add(map);

        }

    }

        catch (JSONException e) {
            e.printStackTrace();    

        }

    // Updating Parsed Data into ListView

    ListAdapter adapter = new SimpleAdapter(this, bookList,
            R.layout.list_item,
            new String[]{TAG_TITLE,TAG_DESCRIPTION,TAG_AUTHORS } , new int[] {
            R.id.title,R.id.description,R.id.author });

setListAdapter(adapter);

// selecting single list view item

ListView lv = getListView();

 // Launching new screen on Selecting Single ListItem
    lv.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            // getting values from selected ListItem
            String title = ((TextView) view.findViewById(R.id.title)).getText().toString();
            String authors = ((TextView) view.findViewById(R.id.author)).getText().toString();
            String description = ((TextView) view.findViewById(R.id.description)).getText().toString();

            // Starting new intent
            Intent in = new Intent(getApplicationContext(), SingleMenuItemActivity.class);
            in.putExtra(TAG_TITLE, title);
            in.putExtra(TAG_AUTHORS, authors);
            in.putExtra(TAG_DESCRIPTION, description);
            startActivity(in);

        }
    });

} 
```

}

我正在尝试仅解析书籍对象

请解决我的问题。

LogCat 详细信息

```
08-24 00:56:48.202: W/dalvikvm(949): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
08-24 00:56:48.263: E/AndroidRuntime(949): FATAL EXCEPTION: main
08-24 00:56:48.263: E/AndroidRuntime(949): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.sree.androidjsonparser/com.sree.androidjsonparser.AndroidJSONParsingActivity}: java.lang.NullPointerException
08-24 00:56:48.263: E/AndroidRuntime(949):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
08-24 00:56:48.263: E/AndroidRuntime(949):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
08-24 00:56:48.263: E/AndroidRuntime(949):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
08-24 00:56:48.263: E/AndroidRuntime(949):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
08-24 00:56:48.263: E/AndroidRuntime(949):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-24 00:56:48.263: E/AndroidRuntime(949):  at android.os.Looper.loop(Looper.java:123)
08-24 00:56:48.263: E/AndroidRuntime(949):  at android.app.ActivityThread.main(ActivityThread.java:4627)
08-24 00:56:48.263: E/AndroidRuntime(949):  at java.lang.reflect.Method.invokeNative(Native Method)
08-24 00:56:48.263: E/AndroidRuntime(949):  at java.lang.reflect.Method.invoke(Method.java:521)
08-24 00:56:48.263: E/AndroidRuntime(949):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
08-24 00:56:48.263: E/AndroidRuntime(949):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
08-24 00:56:48.263: E/AndroidRuntime(949):  at dalvik.system.NativeStart.main(Native Method)
08-24 00:56:48.263: E/AndroidRuntime(949): Caused by: java.lang.NullPointerException
08-24 00:56:48.263: E/AndroidRuntime(949):  at com.sree.androidjsonparser.AndroidJSONParsingActivity.onCreate(AndroidJSONParsingActivity.java:62)
08-24 00:56:48.263: E/AndroidRuntime(949):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
08-24 00:56:48.263: E/AndroidRuntime(949):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
08-24 00:56:48.263: E/AndroidRuntime(949):  ... 11 more
08-24 00:56:53.812: I/Process(949): Sending signal. PID: 949 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:32:53.977

您的问题在于您的 JSONParser..that 并且从该站点返回的 JSON 格式不正确。您有一堆 JSONObjects，其中包含具有相似名称的 JSONObjects。我制定了一个快速简便的解决方案来处理它，但如果您控制生成 JSON 的代码，那么我建议将项目类别（书籍、音乐、相机）分组到它们自己的 JSONArrays 中

您从网站返回的 JSON 是带有 JSONObjects 的 JSONArray。您正在执行以下操作

jObj = 新的 JSONObject(json);

你应该做

jObj = 新 JSONArray(json);

然后你需要改变你的回报是 JSONArray 而不是 JSONObject

然后在主要活动中将“json”更改为 JSONArray 并摆脱“book”..只需循环遍历 JSONArray

还要将您的尝试移动到循环内部。

```
JSONParser jParser = new JSONParser();

            // getting Json String from url

            JSONArray json = jParser.getJSONFromUrl(url);

                // getting array of books

               //Get rid of this = book = json.getJSONArray(TAG_BOOK);

            // looping through all books

                 for(int i=0;i<json.length();i++){
                try{
                JSONObject parent = json.getJSONObject(i);
                JSONObject c  = parent.optJSONObject("camera");
                if(c == null)
                    c = parent.optJSONObject("book");
                if(c == null)
                    c = parent.optJSONObject("music");
                // storing each json item in variable

                String title = c.getString(TAG_TITLE);
                String price = c.getString(TAG_PRICE);
                String authors = c.getString(TAG_AUTHORS);
                String id = c.getString(TAG_ID);
                String description = c.getString(TAG_DESCRIPTION);
                // creating new HashMap
                HashMap<String, String> map = new HashMap<String, String>();

                map.put(TAG_ID, id);
                map.put(TAG_TITLE, title);
                map.put(TAG_PRICE, price);
                map.put(TAG_AUTHORS, authors);
                map.put(TAG_DESCRIPTION, description);

                bookList.add(map);

            }

            catch (JSONException e) {
                e.printStackTrace();    

            }
            } 
```

- - -编辑

正如我的评论中所建议的，您应该重做创建 JSON 输出的代码

简单来说，您需要一个包含每个“类别”的 JSONObjects 的主数组，然后这些类别中的每一个都将是 JSONArray 中的 JSONObject

JSON 应该如下所示

```
[
{ "camera" :
[
   {
   "picture":"http://qqq.com",
   "price":9.99
    },
 {
   "picture":"http://eee.com",
   "price":9.99
    }
]
},
{ "music" :
[
   {
   "picture":"http://aaa.com",
   "price":9.99
    },
 {
   "picture":"http://sss.com",
   "price":9.99
    }
]
},
{ "book" :
[
   {
   "picture":"http://fff.com",
   "price":9.99
    },
 {
   "picture":"http://ggg.com",
   "price":9.99
    }
]
}
] 
```

这样，您可以为不同的类别执行不同的操作（如果需要），并将类别中的任何类似 JSON 对象都组合在一起。

或者，如果无论是书、音乐还是相机，动作都是相同的，那么您可以在 JSON 对象中添加另一个字段以用于“类型”，然后在没有名称的数组 (JSON_array.put()) 中创建 JSONObject所以它会显示为

```
[
{
"type":"camera",
"picture":"http://img5.flixcart.com/image/camera/5/p/a/nikon-d90-slr-40x40-imacxmh3y6wmqh8b.jpeg",
"model":"D90 SLR with AF-S 18-105mm VR Kit Lens",
"make":"Nikon",
"price":57182.0
},
{
"type":"book",
"description":"This book is one of a series of texts written by faculty of the Electrical Engineering and Computer Science Department at the Massachusetts Institute of Technology. It was edited and produced by The MIT Press under a joint production-distribution arrangement with the McGraw-Hill Book Company.",
"authors":"Harold Abelson and Gerald Jay Sussman with Julie Sussman",
"price":469.0,
"id":51087,
"title":"Structure and Interpretation of Computer Programs"
}
] 
```

同样，您应该采取的路线取决于您之后将如何处理数据

# android - Nexus 7 微调器太大

> ID：12098511
> 
> 赞同：8
> 
> 时间：2012-08-23T19:14:01.327
> 
> 标签：android, spinner

我有一个 Nexus 7 用户反馈给我说我的应用程序屏幕显示正常，除了 my `Spinners`，它看起来比他们应该做的要大得多。

正常画面 [http://imgur.com/eG7b3](http://imgur.com/eG7b3)

Nexus 7 上的大型微调器 [http://imgur.com/X4Kqo](http://imgur.com/X4Kqo)

我有一个`Spinner` `TextView`布局：

```
<TextView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/textview"
    android:layout_height="36dip"
    android:layout_width="match_parent"
    android:textSize="24.5sp"
    android:textColor="#768766"
/> 
```

这是由此产生的`RelativeLayout`：

```
<Spinner
    android:id="@+id/spinner_weekday1"
    android:layout_below="@id/col1day"
    android:layout_height="wrap_content"
    android:prompt="@string/enterday"
    android:layout_width="200dip"
    android:entries="@array/weekdaylist"
    android:layout_marginRight="60dp"
    android:layout_marginBottom="20dip"
    android:textSize="24.5sp"
    android:textColor="#768766"
/> 
```

我的应用程序在一系列其他设备上运行，看起来还不错。任何想法为什么 Nexus 7 可能会`Spinners`以这种方式显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:07:03.347

好的，我已经找到了解决方案。

我在上面发布的 Spinner 布局实际上是来自 res/layout-xlarge 的 Spinner，而 Nexus 是一个大型设备。res/layout-large 包含以下 xml：

```
android:textSize="200sp" 
```

什么时候应该是：

```
android:textSize="20sp" 
```

这当然是微调器文本显得如此之大的原因。

我想这凸显了在没有物理测试设备的情况下尝试管理多种布局尺寸的困难。

# objective-c - txt 文件到字符串

> ID：12098514
> 
> 赞同：-4
> 
> 时间：2012-08-23T19:14:11.450
> 
> 标签：objective-c, ios

> **可能重复：**
> [在 iOS 中读取文本文件](https://stackoverflow.com/questions/6932162/reading-in-a-text-file-in-ios)

这是一个非常愚蠢的问题，但是一旦我在我的 iOS 应用程序的路径中有一个 txt 文件。如何将 txt 文件转换为可以放入 UITextView 的字符串。先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:17:10.757

你有没有尝试过

```
[NSString stringWithContentsOfFile:yourFilePath encoding:error:] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:26:14.790

```
 [NSString stringWithContentsOfFile:filename]; 
```

# java - 如何将 JButton 放在 JComboBox 中

> ID：12098521
> 
> 赞同：4
> 
> 时间：2012-08-23T19:14:49.390
> 
> 标签：java, swing, render, jbutton, jcombobox

我想在 JComboBox 中放置一个 JButton。此按钮允许用户浏览文件。用户选择的文件被添加到 JComboBox 列表中。我该怎么做呢？我是否使用某种渲染器？谢谢你。

**编辑：** 在阅读了有关 ListCellRenderer 的更多信息后，我尝试了以下代码：

```
JComboBox comboBox = new JComboBox(new String[]{"", "Item1", "Item2"});
ComboBoxRenderer renderer = new ComboBoxRenderer();
comboBox.setRenderer(renderer);

class ComboBoxRenderer implements ListCellRenderer {

    public Component getListCellRendererComponent(
            JList list,
            Object value,
            int index,
            boolean isSelected,
            boolean cellHasFocus) {

        JButton jbutton = new JButton("Browse");

        return jbutton;
    }
} 
```

上面的问题是按钮“浏览”将被添加 3 次，我希望它只显示一次，并在其下方显示 Item1 和 Item2 作为普通/常规组合框选择对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T21:29:17.807

我会避免`JButton`. 完全有可能`JButton`在您的组合框中获取 a 的图像，但它本身不会像按钮一样。您无法单击它，它永远不会在视觉上被“按下”或“释放”，...。简而言之，您的组合框将包含一个您的用户不熟悉的项目。

这样做的原因是您在`getListCellRendererComponent`方法中返回的组件不包含在`JCombobox`. 它们仅用作邮票。这也解释了为什么您可以（并且应该）重用`Component`您在该方法中返回的内容，而不是一直创建新组件。这一切都在`JTable`教程中关于[渲染器和编辑器](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)的部分进行了解释（解释了`JTable`但对所有其他使用渲染器和编辑器的 Swing 组件有效）。

如果您真的想要允许显示文件选择器的组合框中的项目，我会选择类似于以下 SSCCE 的内容：

```
import javax.swing.JComboBox;
import javax.swing.JFrame;
import java.awt.EventQueue;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;

public class ComboboxTest {

  public static void main( String[] args ) {
    EventQueue.invokeLater( new Runnable() {
      @Override
      public void run() {
        JFrame frame = new JFrame( "TestFrame" );
        JComboBox<String> comboBox = new JComboBox<>(new String[]{"Item1", "Item2"});
        final String browse = "<<BROWSE>>";
        comboBox.addItem( browse );
        comboBox.addItemListener( new ItemListener() {
          @Override
          public void itemStateChanged( ItemEvent e ) {
            if ( e.getStateChange() == ItemEvent.SELECTED && 
                browse.equals( e.getItem() ) ){
              System.out.println("Show filechooser");
            }
          }
        } );
        frame.add( comboBox );
        frame.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );
        frame.setVisible( true );
        frame.pack();
      }
    } );
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:07:59.027

在尝试了很多事情之后，我想我找到了答案，我相信当你看到它时它看起来会很容易：

```
 JComboBox comboBox = new JComboBox(new String[]{"Item1", "Item2"});
        ComboBoxRenderer renderer = new ComboBoxRenderer();
        comboBox.setRenderer(renderer);
        comboBox.addItem("<<BROWSE>>");

class ComboBoxRenderer implements ListCellRenderer {

        @Override
        public Component getListCellRendererComponent(JList list, Object value, int index,         boolean isSelected, boolean cellHasFocus) {
            if (value.equals("<<BROWSE>>")) {
                JButton btn = new JButton("Browse");
                return btn;
            } else {
                JLabel lbl = new JLabel(value.toString());
                lbl.setOpaque(true);
                return lbl;
            }
        }
    } 
```

您现在可以根据需要自定义按钮和标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:17:55.907

实际上，您将不得不使用[http://docs.oracle.com/javase/tutorial/uiswing/components/combobox.html#renderer](http://docs.oracle.com/javase/tutorial/uiswing/components/combobox.html#renderer)中解释的自定义渲染器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T19:59:25.623

根据您想要放置搜索按钮的位置，您可以查看[xswingx Prompt/Buddy API](http://code.google.com/p/xswingx/)。您可以使用它来“伙伴”与编辑器字段的浏览按钮

或者您可以简单地在组合框旁边添加一个浏览按钮。

# broadcastreceiver - Android C2DM 注册 BroadcastReceiver 停止工作

> ID：12098531
> 
> 赞同：0
> 
> 时间：2012-08-23T19:15:22.627
> 
> 标签：broadcastreceiver, android-c2dm

工作了几个月后，我的 C2DM 注册广播接收器停止接收到它的 onReceive 方法的广播。我知道谷歌正在转向 GCM。C2DM 服务是否仍在运行，还是因为 Google 将其关闭而无法运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:47:04.247

C2DM 仍在工作。我是从位置服务调用这个的。当在用户手机上关闭此功能时，没有注册推送令牌。

# twitter-bootstrap - Twitter Bootstrap Image Sprites（某些未显示）

> ID：12098541
> 
> 赞同：1
> 
> 时间：2012-08-23T19:16:03.633
> 
> 标签：twitter-bootstrap

使用带有 Rails 3.2 应用程序的 Bootstrap 并想知道这是否是一个已知问题——

某些图标字形有效，而某些则无效。

例如，工作正常：

```
 <i class="icon-volume-up"> </i> 
```

和，

```
 <i class=" icon-bullhorn"> </i> 
```

……没有。

[两者都是其网站](http://twitter.github.com/bootstrap/base-css.html)上列出的有效图像图标

这是一个已知的问题？

泰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:46:02.293

**[不是](http://jsfiddle.net/6wDp7/1/)**问题。然而，他们网站上的版本是指 Twitter Bootstrap **v2.1.0**，它使用最新的 Glyphicons sprite ( **1.6** )，它确实包含`icon-bullhorn`.

在 Twitter Bootstrap [v2.0.3 之前](https://github.com/twitter/bootstrap/blob/v2.0.3/img/glyphicons-halflings.png)，`icon-bullhorn`不[*存在*](https://github.com/twitter/bootstrap/blob/v2.0.2/img/glyphicons-halflings.png)，这就是你看不到它的原因。

确保您拥有最新版本的 Twitter Bootstrap，或者至少拥有最新版本的 `sprites.less`和`glyphicons-halflings.png`.

# android - 可展开列表视图中的滚动问题

> ID：12098546
> 
> 赞同：0
> 
> 时间：2012-08-23T19:16:26.200
> 
> 标签：android, sqlite, android-listview, scroll, expandablelistview

我正在使用可扩展的列表视图。当我单击父级时，它会正确显示子级信息。但是，当我在我的孩子仍然崩溃的情况下向下滚动时，我收到一个错误 - 对字段插槽 0,-1 numrows=3 numcolumns=3 的错误请求。当我向上滚动时，没有问题。或者如果我的孩子没有折叠，那么在任何地方滚动都没有问题。

我的simplecursorttree适配器代码：-

```
 Cursor cursor = db.rawQuery("SELECT _id,words from keywords", null);
        startManagingCursor(cursor);
                SimpleCursorTreeAdapter mAdapter = new SimpleCursorTreeAdapter(TestActivity.this,
                cursor, R.layout.exprow,
                new String[] { DbHandler.D_WORDS}, new int[] { R.id.textText},
      R.layout.row,new String[] {DbHandler.C_STATUS,DbHandler.C_CREATED_AT,DbHandler.C_USER}, new int[] {R.id.textStatus,R.id.textCreatedAt,R.id.textUser}) {

            @Override
            protected Cursor getChildrenCursor(Cursor groupCursor) {
                 dbhandler=new DbHandler(TestActivity.this);
                 SQLiteDatabase db = dbhandler.getReadableDatabase();
                    String get=groupCursor.getString(1);
                    Log.d("Post Operation", "Getting cursor for keyword = " +get);
                    String sql="SELECT status,created_at,user from tweets where words='"+get+"'" ;

                    Cursor cursor = db.rawQuery(sql, null);
                    startManagingCursor(cursor);
                    Log.d("TestActivity","Cursor got count"+cursor.getCount());

                   db.close();
                return cursor;
            }
        }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:40:56.250

我认为每个父母的数据都有问题。请检查

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T09:30:02.160

我通过在 getChildrenCursor 内的 sql 查询中添加 _id 解决了这个问题。我认为 _id 必须出现在表中。

# eclipse - Eclipse - 左移/右移一个空格

> ID：12098549
> 
> 赞同：4
> 
> 时间：2012-08-23T19:16:50.163
> 
> 标签：eclipse

在一台使用 Eclipse Indigo 的旧计算机上，我设置了键绑定，让我将选定的文本向左移动一个空格，向右移动一个空格（相对于一个制表符/一次 4 个空格）。我已经迁移到新计算机并安装了 Eclipse Juno。Shift Left 和 Shift Right 键绑定在那里，但它们一次将我的文本移动 4 个空格。我可以将其更改为使用单个空格，同时保持 4 空格 TAB 键吗？

# php - 为什么 rawurldecode 在解码 %D 时返回一个空字符串？

> ID：12098551
> 
> 赞同：0
> 
> 时间：2012-08-23T19:17:07.643
> 
> 标签：php

这真让我抓狂。我想知道为什么在这个 PHP 示例代码中：

```
$str = '<p>Delivery: %DELIVERY-STAMP%</p>';
$str = rawurldecode($str);
echo $str; 
```

结果是一个空字符串。但在这：

```
$str = '<p>Delivery: % DELIVERY-STAMP%</p>';
$str = rawurldecode($str);
echo $str; 
```

结果结果是

```
&lt;p&gt;Delivery: % DELIVERY-STAMP%&lt;/p&gt; 
```

唯一的区别是 %D 中的额外空间。换句话说，当字符串“%D”被传递给 rawurldecode() 时会发生一些非常糟糕的事情，因为我总是得到一个空字符串作为结果。这可能是一个错误？我在文档中找不到任何关于“%D”的参考资料。我在实际代码中使用 PHP 5.4.2，我无法避免运行 rawurldecode()。提前谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:23:26.190

因为它被解释`%DE`为文字字符并将其解码为某个字符（222）。从[文档](http://us3.php.net/manual/en/function.rawurldecode.php)：

> 返回一个字符串，其中带有百分号 (%) 符号后跟两个十六进制数字的序列已被替换为文字字符。

嗯，`D`并且`E`是有效的十六进制数字，所以，它被替换了。

真正的解决方案是[将您的字符串传递给`rawurlencode()`first](http://viper-7.com/qre5R1)，然后您可以使用 对其进行解码`rawurldecode()`，因为为了解码某些内容，需要对其进行正确编码。

```
$str = rawurlencode( '<p>Delivery: %DELIVERY-STAMP%</p>');
$str = rawurldecode($str);
echo $str; 
```

正确编码的输入字符串如下所示：

```
%3Cp%3EDelivery%3A%20%25DELIVERY-STAMP%25%3C%2Fp%3E 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:25:23.630

在黑暗中拍摄，但这是我最好的猜测：

你在没有告诉我们的情况下一直在`$str`运行`htmlspecialchars`。我之所以这么说是因为`rawurldecode("<")`不会给你`&lt;`。那么，考虑到这一点，`rawurldecode`实际上给出了什么？它给出了这个：

> <p>交货：ÞLIVERY-STAMP%</p>

它给出了这个，因为它认为`%DE`是一个 URL 编码的字符串并将其解码为`Latin Capital Letter Thorn`. 不过，这就是问题所在。该字符在 0-127 范围之外，因此在 UTF-8 中具有特殊含义，顺便说一下，这是`htmlspecialchars`PHP 5.4 中的默认值。

作为直接结果，您有“格式错误的 UTF-8”（实际上是完全有效的 Windows-1252），结果是一个空字符串。

我不知道你为什么首先使用`rawurldecode`它，因为如果你有一个编码字符串，它一开始就没有`<`（而是`%3C`）。所以试试这个：

```
$str = '<p>Delivery: %DELIVERY-STAMP%</p>';
echo htmlspecialchars(utf8_encode($str)); 
```

或者

```
echo htmlspecialchars($str,ENT_COMPAT,"ISO-8859-1"); 
```

# javascript - 基于 jQuery dataTables 类型的列过滤不起作用？img alt 过滤器/排序

> ID：12098553
> 
> 赞同：0
> 
> 时间：2012-08-23T19:17:12.317
> 
> 标签：javascript, jquery, jquery-datatables

到目前为止，我很喜欢 dataTables，但我遇到的只是一个问题......

我有一列“状态”图像，样式为：

```
<td><img class="status" alt="green" src="images/dt/greenStatus.png"></td> 
```

该列的 sType 为“alt-status”，我已向该列添加了自定义排序，以根据 alt 文本是红色、黄色还是绿色对它们进行排序。它工作完美，符合预期。这是代码：

```
jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "alt-status-pre": function ( a ) {
        switch(a.match(/alt="(.*?)"/)[1].toLowerCase()){
            case 'green': return 1;
            case 'yellow': return 2;
            case 'red': return 3;
            default: return 4;
        }
    },

    "alt-status-asc": function( a, b ) {
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));     
    },

    "alt-status-desc": function(a,b) {
        return ((a < b) ? 1 : ((a > b) ? -1 : 0));
    }
} ); 
```

现在，我也只想根据这个 alt 字段过滤它们。我尝试了一些不同的东西，但它们都不起作用。我试过了：

```
$.fn.dataTableExt.ofnSearch['alt-status'] = function ( sData ) {
    console.log(sData);
    return sData.replace(/\n/g," ").replace( /<.*?>/g, "" );
}; 
```

只是尝试从过滤器中删除 html，但这也不起作用。我仍然可以搜索`<img` ，它们都显示了。

据我所知，这个方法甚至没有被调用。任何人都有基于图像替代文本过滤的经验吗？

这个问题也发布在dataTable论坛上：http: [//goo.gl/79XXq](http://goo.gl/79XXq)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T15:00:34.060

正确的做法是现在使用 mData 而不是 ofnSearch。请参阅：[http ://datatables.net/usage/columns#mData](http://datatables.net/usage/columns#mData)

# python - PyTypeObject 的静态工厂

> ID：12098554
> 
> 赞同：0
> 
> 时间：2012-08-23T19:17:20.943
> 
> 标签：python, c, api

我正在使用 Python C API 并尝试创建一个函数，该函数将分配 PyTypeObjects 的新实例以在多个 C++ 类中使用。这个想法是每个类都有一个指向 PyTypeObject 的指针，它将被这个工厂实例化。指针必须是静态的。但是，我对这种方法有疑问。

1.  在包含指向 PyTypeObject 的指针的类中，当我尝试将该静态变量设置为等于工厂函数的结果（在另一个类中但是静态的）时，我得到“未定义的引用”链接器错误。我想这是有道理的，因为该功能要到运行时才会发生，但我不知道另一种方法可以做到这一点。
2.  我不知道如何动态设置 PyTypeObject 字段，因为第一个字段始终是一个宏：PyObject_VAR_HEAD。

希望这是有道理的。基本上，我试图让几个类不必静态地重新定义 PyTypeObject，而是可以从工厂函数实例化它们的 PyTypeObject 变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:26:03.910

试试这个：创建一个“模板”PyTypeObject，并使用结构复制（或 memcpy）来克隆基本模板。然后您可以在此之后填写必要的字段定义。这解决了 (2)，因为您只需声明完整的 PyTypeObject 一次。

对于您的第一点，您只需从模块 init 中设置静态变量，而不是在静态变量声明中进行设置。因此，在您的模块实际初始化之前不会设置它。

如果您打算经常这样做，可能值得一看 Boost::Python，它简化了从 C++ 类生成 CPython 包装器的过程。

# python - 谷歌答案如何使用 .py 文件？

> ID：12098559
> 
> 赞同：1
> 
> 时间：2012-08-23T19:17:47.887
> 
> 标签：python

谷歌如何设法在其网页 ( [https://support.google.com/mail/bin/answer.py?hl=en&answer=10313](https://support.google.com/mail/bin/answer.py?hl=en&answer=10313) ) 上有实际的 .py 脚本？似乎参数 'en' 和 '10313' 被传递给了 answer.py 脚本。我看过一个网站，它执行以下操作：answer.php?hl=en&answer=10313，但是您将如何以这种方式使用 python 脚本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T19:21:01.413

通过使用配置为运行 Python 脚本的应用程序服务器或网络服务器？[运行 Python](http://docs.python.org/howto/webservers.html)服务 Web 请求的选项有很多。

请注意，这些天扩展已不再意味着任何东西。扩展甚至可能是我们所有人的`.py`内部笑话，这些页面实际上是由 Haskell 提供的。

# python - 用python从字符串中去除所有空格和引号的最有效方法是什么？

> ID：12098561
> 
> 赞同：3
> 
> 时间：2012-08-23T19:17:51.273
> 
> 标签：python, regex, string

> **可能重复：**
> [从 Python 中的字符串中去除标点符号的最佳方法](https://stackoverflow.com/questions/265960/best-way-to-strip-punctuation-from-a-string-in-python)

我有一个字符串要放在 output 的 2 个双引号之间`"{{ var }}"`，所以我想确保从用户提供的字符串的末尾删除所有单/双引号。实现这一目标的最有效方法是什么？

输入/期望输出：

```
 """""""""" string here '''''''''''''''         => 'string here'
       string'''''''""""""''''''"""""  => 'string' 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T19:19:40.257

[`strip`](http://docs.python.org/library/stdtypes.html#str.strip)与包含您希望从末端剥离的字符的字符串一起使用：

```
s = s.strip(' "\'\t\r\n') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T19:23:48.623

```
from string import whitespace
new_string = string.strip(whitespace + '"\'') 
```

使用该[`strip`](http://docs.python.org/library/string.html#string.strip)方法，用[`whitespace`](http://docs.python.org/library/string.html#string.whitespace)常量开始你要删除的字符列表。

# haskell - ghc-gc-tune 0.2.1 是否适用于 ghc 7.4.1？

> ID：12098563
> 
> 赞同：4
> 
> 时间：2012-08-23T19:17:55.670
> 
> 标签：haskell, garbage-collection, ghc

ghc-gc-tune 0.2.1 是否适用于 ghc 7.4.1？似乎 ghc-gc-tune 已经有一段时间没有更新了，可能只适用于 ghc 6.x？我找不到任何可靠的信息。

我收到以下错误：

```
ghc-gc-tune: Can't parse GC stats: " ,(\"num_GCs\", \"320602\")\n ,(\"average_bytes_used\", \"105444\")\n ,(\"max_bytes_used\", \"131296\")\n ,(\"num_byte_usage_samples\", \"1677\")\n ,(\"peak_megabytes_allocated\", \"2\")\n ,(\"init_cpu_seconds\", \"0.00\")\n ,(\"init_wall_seconds\", \"0.00\")\n ,(\"mutator_cpu_seconds\", \"6.24\")\n ,(\"mutator_wall_seconds\", \"6.23\")\n ,(\"GC_cpu_seconds\", \"3.57\")\n ,(\"GC_wall_seconds\", \"3.58\")\n ]\n" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T18:25:21.530

我已经更新了该软件包以与 GHC 7 系列一起使用。

这是[关于 -cafe 的问题的结果](http://www.haskell.org/pipermail/haskell-cafe/2012-December/104956.html)

![在此处输入图像描述](../Images/0280f974bcf0de8a884a48cc6bf4ebeb.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T17:51:01.247

ghc-gc-tune.hs [1] 的第 485 行读取

```
Right str     -> return $! Just $! parse (unlines . drop 1 . lines $ str) 
```

这似乎正在修剪你的 GC 信息转储的开始，这不是有效的 Haskell 列表语法 - 三个选项按简单→硬顺序排列：

1.  让您的代码在启动时向 stderr 打印一个换行符（快速破解）

    ```
    main = hPutStrLn stderr "" >> do ...   -- untested... 
    ```

2.  修补 ghc-gc-tune.hs 以阻止它丢弃 1 行 stderr

    ```
    Right str     -> return $! Just $! parse str   -- untested... 
    ```

3.  修补 ghc-gc-tune.hs 以尝试当前方式，然后不删除 1 行，选择最成功的行

    ```
    -- code left as an exercise
    -- bonus points if it's submitted upstream as a patch 
    ```

可能早期版本的 GHC 在 stderr 上输出一个额外的标头，尝试类似：

```
./ghc-compiled-test-program +RTS -t --machine-readable -RTS 
```

检查输出。

[1] [http://code.haskell.org/~dons/code/ghc-gc-tune/ghc-gc-tune.hs](http://code.haskell.org/~dons/code/ghc-gc-tune/ghc-gc-tune.hs)

# javascript - 如何在javascript中表示2个父子下拉？

> ID：12098564
> 
> 赞同：-2
> 
> 时间：2012-08-23T19:18:04.517
> 
> 标签：javascript, jquery

我有 2 个下拉列表，当用户选择 dropdown#1 时，我需要使用与 dropdown#1 选择相关的选项更新 dropdown#2。

例如

Dropdown#1 有汽车制造商：福特、丰田、本田

Dropdown#2 将是该特定制造商的汽车。

我应该如何将这些数据存储在 javascript 中？

我希望我可以创建一个像某种字典或散列这样的集合，这样我就可以轻松地填充每个下拉列表。

我有来自数据库的实际数据，然后在服务器端我将创建创建此数据结构所需的 JavaScript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:53:19.397

从你的评论 `I don't want to make an ajax call, I want to store all the data client side in a javascript object, I am asking how to structure that data`

所以只是一个想法

**HTML**

```
<select id="cars_company">
    <option value="ford">Ford</option>
    <option value="toyota">Toyota</option>
</select>

<select id="cars">
    <option value="ford_car_one">Ford Car One</option>
    <option value="ford_car_two">Ford Car Two</option>
</select> 
```

**JS**

```
$(function(){
    cars={
        ford:{
            ford_car_one:'Ford Car One',
            ford_car_two:'Ford Car Two'
        },
        toyota:{
            toyota_car_one:'Toyota Car One',
            toyota_car_two:'Toyota Car Two'
        }
    };

    $('#cars_company').on('change', function(){
        $('#cars').html('');
        $.each(cars[$(this).val()], function(k, v){
            $('<option></option>').val(k).text(v).appendTo($('#cars'));
        });
    });
});​ 
```

[**演示**](http://jsfiddle.net/Tckm2/1/)。

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:24:34.423

通过下拉我想你的意思是一个选择框。最好的方法是使用静态 javascript ，但让它执行 ajax 调用来获取数据。第一个选择框已经填充了 html 中的数据（可以使用服务器端脚本使用数据库中的数据构建）在第一个选择框的更改事件中，您将让 ajax 调用发送值该框并基于您让服务器发回第二个选择框的数据。与一点点 jQuery 相比，您可以用检索到的数据填充第二个选择框。这是一个很常见的情况，所以如果你需要的话，你应该可以在网上找到一些 tut...

# gwt - 无法让 Storage 类为 GWT 工作？

> ID：12098565
> 
> 赞同：1
> 
> 时间：2012-08-23T19:18:14.063
> 
> 标签：gwt

我想将 Storage 类与 GWT 一起使用。我的 projectname.gwt.xml 文件中有这个：

```
<module rename-to='projectname'>
    <inherits name='com.google.gwt.user.User'/>
    <inherits name='com.google.gwt.storage.client.Storage' />

    ... 
```

但是在开发模式下启动项目会抛出：

```
Loading modules
  com.me.myproject
  Loading inherited module 'com.google.gwt.storage.client.Storage'
     [ERROR] Unable to find 'com/google/gwt/storage/client/Storage.gwt.xml' 
     on your classpath; could be a typo, or maybe you forgot to include a 
     classpath entry for source?
  [ERROR] Line 5: Unexpected exception while processing element 'inherits' 
```

是否有额外的罐子或我们需要包含的东西才能让它工作？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:15:00.820

用于存储的 gwt xml 文件位于：

```
<inherits name='com.google.gwt.storage.Storage' /> 
```

从您的导入中删除客户端，您应该没问题

# video - 使用 Google Apps 脚本在 Google 网站上嵌入 Google 云端硬盘视频只会给我一个灰色边框

> ID：12098572
> 
> 赞同：0
> 
> 时间：2012-08-23T19:18:44.457
> 
> 标签：video, google-apps-script, google-drive-api

我正在寻找一种程序化方式来在 Google 站点上包含来自 Google Drive 的视频。我目前的计划是使用每行的嵌入 URL 播种电子表格，然后通过 Google Apps 脚本进行挖掘以嵌入内容。

但是，在这个程序的核心，我相信我遇到了一个基于与[http://code.google.com/p/google-apps-script-issues/issues/detail?id=1649](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1649)相似性的已知问题这是在 Google 网站上嵌入 YouTube 视频的 Google 错误。

如下面的 URL 所示，我有一个非常小的 HTML 文件，可以播放我上传到 Google Drive 的 Apple 示例 MP4 文件，以便我可以嵌入它并按预期工作：

[http://www.pccc.com/downloads/junk/test/test.html](http://www.pccc.com/downloads/junk/test/test.html)

但是，如果我为 Apps 脚本复制相同的 HTML，我看到的只是灰色边框和添加的“这是一个测试”文本，以确认最新版本已发布：

```
function doGet(e) {
  var html = '<iframe src="https://docs.google.com/a/documentshare.com/file/d/0B7wNkTj2wH_TLTdwcWo2NW5SWnM/preview" width="640" height="385"></iframe> This is a test';
  return HtmlService.createHtmlOutput(html);
} 
```

任何指针表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T21:44:50.730

This is doable but in a different way. You can have full access to a sites page HTML including iframes via script. See the [doumentation](https://developers.google.com/apps-script/class_page). Do the edit first manually on the sites page: Insert > Video > Google docs. Then use the HTML generated as a template to write your own programmatically.

Edit: For example, follow these steps:

1.  Create a web page called TEST
2.  Edit the page and write "this is a test" and then Insert > Video > Google Docs Video (the url to paste is: [https://docs.google.com/a/documentshare.com/file/d/0B7wNkTj2wH_TLTdwcWo2NW5SWnM/preview](https://docs.google.com/a/documentshare.com/file/d/0B7wNkTj2wH_TLTdwcWo2NW5SWnM/preview)
3.  Save the page and run this code (authorise when prompted and rerun).
4.  Refresh your page in the browser.

The code will change the page programatically but you will still have a working video.

```
function myFunction() {
      //Change the domain and site to yours below
      var page = SitesApp.getSite('YOURDOMAIN', 'YOURSITE').getChildByName('TEST');
      var html = page.getHtmlContent();
      Logger.log(html);
      page.setHtmlContent(html.replace("test", "test at " + new Date()));
      var newhtml = page.getHtmlContent();
      Logger.log(newhtml);
      return;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T22:42:10.943

不幸的是 HtmlService 不支持 iframe。

# html - 如何将背景图像添加到带有表格的 twitter 引导页面？

> ID：12098576
> 
> 赞同：0
> 
> 时间：2012-08-23T19:19:16.280
> 
> 标签：html, css, twitter-bootstrap

我的网页上有一张桌子，我想添加一张背景图片。我仍然希望桌子保持白色背景，但在桌子周围我希望有一个背景图像。如果我只是更改中的背景图像`<head>`，则白色桌子的背景会更改为图像，这不是我想要的。

代码：

```
<link href="css/bootstrap.css" rel="stylesheet">
<style type="text/css">
body {
  padding-top: 60px;
  padding-bottom: 40px;
  background-image: url('file:///....Images/background.JPG');  
  background-repeat:repeat;
  -webkit-border-radius: 6px;  
  -moz-border-radius: 6px;  
  border-radius: 6px;   
}
</style>
<link href="css/bootstrap-responsive.css" rel="stylesheet"> 
```

我该如何以正确的方式做到这一点？顺便说一句，我对 bootstrap/html/css 完全陌生，显然？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:37:42.703

这样想：在设置背景之前，每个元素都是透明的。你只是设置身体背景。你需要做的是，在 CSS 中，给你的表格一个白色背景：

```
table {
    background-color: white;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T10:12:11.450

如果你已经添加`class="table"`到表格中（如果你还没有，那么你真的应该），Bootstrap 默认给它一个透明的背景。将背景颜色添加到它，它将起作用。

# android - TextView 中的值列表中的不同颜色

> ID：12098585
> 
> 赞同：0
> 
> 时间：2012-08-23T19:20:07.423
> 
> 标签：android, colors, textview

我的问题是我有一个`TextView`不同的值​​​，例如：-1.7 +5,8 -3,3 0,0 +7,7

使用我所做的代码，我只取了第一个负值，让我的颜色都是一样的。

这是我的代码：

活动：

```
 List<ParsedExampleDataSet5101> parsedExampleDataSetList = 
                myExampleHandler.getParsedData();

        for(ParsedExampleDataSet5101 parsedExampleDataSet : parsedExampleDataSetList){

            tv.append(parsedExampleDataSet.toString());
            tv1.append(parsedExampleDataSet.toString1());
                    tv2.append(parsedExampleDataSet.toString2());
            tv3.append(parsedExampleDataSet.toString3());   

            if (parsedExampleDataSet.toString2().contains("-")){
                tv2.setTextColor(Color.parseColor("#FF0000"));
            }else{
                tv2.setTextColor(Color.parseColor("#008000"));
            }

        } 
```

`ParsedExampleDataSet5101`是另一门课，我在这个课上有getter和setter`toString()`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:12:44.473

Ridcully 基本上是对的，尽管他的答案并不完整——而且 span 标签也不被支持。

您可以在 Textviews 中使用 HTML，但您必须创建一个包含格式信息的 Spanned（CharSequence 的子类）。

您可以使用 Html.fromHtml() 创建一个 Spanned。有关 TextViews 中 HTML 格式的详细信息，请参阅我的文章 [Formatting text with Html.fromHtml()](http://www.grokkingandroid.com/android-quick-tip-formatting-text-with-html-fromhtml/)

所以你可以做这样的事情：

```
 if (parsedExampleDataSet.toString2().startsWith("-")){
     tv2.append(Html.fromHtml("<font color=\"#ff0000\">" + parsedExampleDataSet.toString2() + "</font>"));
  }else{
     tv2.append(parsedExampleDataSet.toString2());
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:34:49.077

据我所知，您可以使用简单的 HTML 来格式化 TextView 中的文本，因此您可以尝试类似`<span style="color:#FF0000">first value</span><span style="color:#008000">next value</span>`.

```
StringBuffer s = new StringBuffer();
for(ParsedExampleDataSet5101 parsedExampleDataSet : parsedExampleDataSetList){
    if (parsedExampleDataSet.toString2().contains("-")) {
        s.append("<span style="color:#FF0000">")
    } else {
        s.append("<span style="color:#008000">")
    }
    s.append(parsedExampleDataSet.toString2());
    s.append("</span>");
}
tv.setText(s.toString()); // <-- supposing tv is your TextView object 
```

# wcf - WCF 配置错误 - 扩展名未注册

> ID：12098591
> 
> 赞同：1
> 
> 时间：2012-08-23T19:20:20.633
> 
> 标签：wcf, web-services, rest

我自托管使用自定义 BehaviorExtension 的 REST 服务。当我将行为扩展添加到 ServiceBehaviors 时，我收到以下错误：

> “配置中的元素无效。扩展名 'unityServiceBehavior' 未在 system.serviceModel/extensions/behaviorExtensions 的集合中注册。”

我的 App.Config 如下：

```
<?xml version="1.0"?>
<configuration>

    <system.serviceModel>

        <services>
            <service behaviorConfiguration="MyServiceTypeBehaviors"     name="My.Core.Services.PartyService">
                <endpoint behaviorConfiguration="RESTBehavior" binding="webHttpBinding"    name="PartyService" contract="My.Core.Services.IPartyService" />
                <endpoint address="mex" binding="mexHttpBinding"  contract="IMetadataExchange" />
                <host>
                   <baseAddresses>
                       <add baseAddress="http://localhost:8080/parties" />
                   </baseAddresses>
                </host>
             </service>
        </services>

        <behaviors>
            <serviceBehaviors>
                <behavior name="MyServiceTypeBehaviors" >
                    <serviceMetadata httpGetEnabled="true" />

                    <!--Adding this behavior causes the error />-->
                    <UnityServiceBehavior />
                </behavior>
            </serviceBehaviors>

           <endpointBehaviors>
               <behavior name="RESTBehavior">
                  <webHttp helpEnabled="true" />
               </behavior>
           </endpointBehaviors>
        </behaviors>

        <extensions>
           <behaviorExtensions>
               <add name="UnityServiceBehavior" type="My.Core.Services.UnityServiceBehavior,     My.Core.Services, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
           </behaviorExtensions>
        </extensions>  

    </system.serviceModel>

    <startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup>    </configuration> 
```

对此有任何想法吗？

编辑：我在某处读到，行为扩展需要在配置中注册才能加载。

我需要做一些特别的事情来使用配置注册扩展吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-13T14:19:58.840

添加上面已经很好的答案：我在将它添加到 machine.config 文件后遇到了这个错误。

后来我才注意到，在故障排除时，我的应用程序池的 .NET 版本与我改编 machine.config 文件的 .NET 版本不同。（v2.0 与 v4.0）。

将应用程序池设置为正确的版本为我修复了这个错误。

很明显，但对于没有 IIS 经验的人来说很容易错过（有时像我一样）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T13:42:59.010

最初我收到以下错误：

> “配置中的元素无效。扩展名 'unityServiceBehavior' 未在 system.serviceModel/extensions/behaviorExtensions 的集合中注册。”

我通过将行为剥离到 dll 中（现在称为 My.UnityWCF）并在 GAC 中注册自定义行为来克服这个错误。但是，现在我遇到了一个新的但类似的错误。

> 'My.UnityWCF.UnityServiceBehavior, My.UnityWCF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=ab794c43d4083d4c' 类型的扩展未在扩展集合 'behaviorExtensions' 中注册。

我使用 WCF 配置编辑器将行为添加到 behaviorExtensions 集合中。

```
<behaviorExtensions>
    <add name="unityWCF" type="My.UnityWCF.UnityServiceBehavior, My.unityWCF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" /> 
</behaviorExtensions> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T08:42:38.407

UnityServiceBehavior 类需要从 BehaviorExtensionElement 派生。

我也可以建议您更改行为的名称，如下所示：

```
 <serviceBehaviors>   
            <behavior name="MyServiceTypeBehaviors" >   
                <serviceMetadata httpGetEnabled="true" />   

                <!--Adding this behavior causes the error />-->   
                <unityServiceBehavior />   
            </behavior>   
        </serviceBehaviors> 

       <behaviorExtensions> 
           <add name="unityServiceBehavior" type="My.Core.Services.UnityServiceBehavior,     My.Core.Services, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" /> 
       </behaviorExtensions> 
```

由于您为元素赋予了与类相同的名称（即使是大小写），它也可能使问题变得模糊......

在从 BehaviorExtensionElement 派生的类中，您需要覆盖 CreateBehavior()

# c++ - 编译 __asm 代码所需的标志

> ID：12098593
> 
> 赞同：3
> 
> 时间：2012-08-23T19:20:33.300
> 
> 标签：c++, assembly, g++

使用内联汇编指令编译代码是否需要任何标志？

我正在尝试让 g++ 编译以下代码（从 SO 上的答案克隆）：

```
#include <iostream>

using namespace std;

inline unsigned int get_cpu_feature_flags()
{
    unsigned int features;

    __asm
    {                             // <- Line 10
        // Save registers
        push    eax
        push    ebx
        push    ecx
        push    edx

        // Get the feature flags (eax=1) from edx
        mov     eax, 1
        cpuid
        mov     features, edx

        // Restore registers
        pop     edx
        pop     ecx
        pop     ebx
        pop     eax
    }

    return features;
}

int main() {
    // Bit 26 for SSE2 support
    static const bool cpu_supports_sse2 = (get_cpu_feature_flags() & 0x04000000)!=0;
    cout << (cpu_supports_sse2? "Supports SSE" : "Does NOT support SSE");
} 
```

但我收到以下错误：

```
$ g++ t2.cpp 
t2.cpp: In function ‘unsigned int get_cpu_feature_flags()’:
t2.cpp:10:5: error: expected ‘(’ before ‘{’ token
t2.cpp:12:9: error: ‘push’ was not declared in this scope
t2.cpp:12:17: error: expected ‘;’ before ‘eax’
$ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T19:39:58.637

正如其他人已经暗示但未明确指出的那样，对于 gcc（它使用基于字符串的 asm("...") 语言而不是真正的内联汇编代码）和 gas（它使用 AT&T 语法而不是 Intel 语法）来说，这是不正确的语法）。

谷歌“gcc 内联汇编”拉出了这个教程，看起来不错：

[http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html](http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html)

您可以在此处找到 gcc 文档的相关部分：

[http://gcc.gnu.org/onlinedocs/gcc-4.7.1/gcc/Extended-Asm.html](http://gcc.gnu.org/onlinedocs/gcc-4.7.1/gcc/Extended-Asm.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:22:48.320

它是

```
__asm(
   //...
) 
```

不是

```
__asm{
   //...
} 
```

另外，请注意标准版本是`asm`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:42:23.490

对于`gcc`内联汇编，语法是`asm("<instructions>" : "<output constraints>" : "<input constraints>")`. 请注意使用括号而不是大括号，并且指令（和可选的约束子句）放置在字符串文字中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-19T21:41:57.803

我发现这种语法特定于 ARM 处理器和 MS asm。看

[http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0491c/BABFDCGD.html](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0491c/BABFDCGD.html)

如果它是另一个处理器或编译器（如 Keil），请查阅他们的支持页面。

# jquery - Jquery 插件 FormatCurrency 无法正常工作

> ID：12098594
> 
> 赞同：0
> 
> 时间：2012-08-23T19:20:35.253
> 
> 标签：jquery, asp.net-mvc-3

所以我使用名为 FormatCurrency 的 Jquery 插件（这应该很明显）以货币格式格式化一些数字。jQuery 函数对第一行数字非常有效，但第二行存在一些问题。

让我先解释一下我在做什么：

如果我单击树并展开我要选择的树的行，则会打开另外两行资本和费用。jQuery 在大写行上运行良好，使用格式并且行从 123456 更改为 $123,456，但费用行保持不变。

我还发现如果我点击不同的区域，Expense 行确实接受 formatCurrency 样式的更改，就像我用不同的数字展开另一行一样。所以 Jquery 正在工作，它只是没有完成样式更改，直到我单击另一行，如果我回到最初单击的原始行，样式更改仅在费用行上再次删除。我希望这一切都有意义。我已经在下面发布了我的代码，我会经常回来查看，所以请随时提出任何有助于解决问题的问题。感谢您的帮助！

```
pa_click = function (pa_label) {
            PA_ID = pa_label.getAttribute('pa_id');

            var pa_details = document.getElementById('pa-details-' + PA_ID);

            jQuery.getJSON('@Url.Action("getAjaxSCs")', { PA: pa_label.title }, function (SCS) {
                pa_details.innerHTML = "";
                jQuery.each(SCS, function (index, SC) {

                    months_html = '';
                    jQuery('.currency').formatCurrency({
                        colorize: true,
                        roundToDecimalPlace: -2,

                    });

                    for (var i = 0; i < 12; i++) {

                        index = index.replace(/\s/g, "-");
                        months_html +=
                                            '<div id="SC-' + index + '-' + months[i] + '" class="month-wrapper tree border-white currency">' + // This is where I add the currency class
                                            SC[i] + // This is the variable I need to replace with code to add currency to the amount  
                                            '</div>';
                    }

                    pa_details.innerHTML +=

                            '<div id ="Spend-Category-' + index + '" class="sc-wrapper tree border">' +
                                '<div id ="sc-title-' + index + '" class="sc-title">' +
                                    '<div class = "sc-label" title = "' + index + '" SC_id="' + index + '" onclick = "sc_click(this)">' + index + '</div>' +
                                    months_html +
                                '</div>' +
                                '<div id="sc-details-' + index + '" class = "pa-details" style = "display:none">' + index + '</div>' +
                            '</div>';
                })
            });
            jQuery('#pa-details-' + PA_ID).toggle('fast');

        }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:27:41.713

在将所有元素添加到 DOM`.formatCurrency` *后*调用 to 。

例如，您可以像这样重构：

```
pa_details.innerHTML = "";

jQuery.each(SCS, function (index, SC) {
  months_html = '';
  for (var i = 0; i < 12; i++) {
    ...
  }
  pa_details.innerHTML += "BIG CONCATENATION HERE";
});

jQuery('.currency').formatCurrency({
  colorize: true,
  roundToDecimalPlace: -2
}); 
```

这允许在尝试格式化元素之前所有元素都存在于 DOM 中。

# android - Native App 比 HTML5 更快

> ID：12098595
> 
> 赞同：3
> 
> 时间：2012-08-23T19:20:38.173
> 
> 标签：android, ios, html, native

我一直认为 HTML5 应用程序与原生应用程序相比应该没有弱点，但根据今天推出的新 facebook 应用程序，当他们切换到原生 iOS 代码而不是 Web 应用程序时，速度得到了提升。

> 这包括应用程序本身的更快打开、更流畅和更快的滚动，以及据说可以“立即”加载的照片——这些变化主要是由于从旧的 HTML5 代码切换到 iOS 的原生编程语言。

谁能保证这些速度改进？原生开发有那么快吗？

**iOS 版 Facebook 原生，告别 HTML 5** [http://www.theverge.com/2012/8/23/3262782/facebook-for-ios-native-app](http://www.theverge.com/2012/8/23/3262782/facebook-for-ios-native-app)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T19:29:34.573

我在您发布的链接中找到了一个链接，该链接在页面上有一个部分，为什么它更快

[幕后：为 IOS 重建 facebook](https://www.facebook.com/notes/facebook-engineering/under-the-hood-rebuilding-facebook-for-ios/10151036091753920)

该部分被命名为**（重新）建设速度**

> . 我们实现这一目标的一种方法是重新平衡我们执行某些任务的位置。例如，在 iOS 中，主线程驱动 UI 并处理触摸事件，所以我们在主线程上做的工作越多，应用程序就会感觉越慢。相反，我们注意在后台执行计算量大的任务。这意味着我们所有的网络活动、JSON 解析、NSManagedObject 创建和保存到磁盘都不会触及主线程

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T19:26:41.780

当然，它要快得多。HTML5 应用程序是用 Javascript 编写并由浏览器的 JavaScript 引擎解释的，而原生应用程序以原生机器代码 (iOS) 或至少作为编译字节码 (Android) 运行。此外，本机应用程序有更多的可能性通过操作系统提供的 API 访问它们正在运行的系统（如 GPS、相机、文件系统等传感器），而 HTML5 应用程序绑定到 HTML5 API，这是一个小子集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T00:40:55.507

我会想象在内存释放和 GPU 渲染方面，本机应用程序可以做一些 HTML5 应用程序无法做到的事情。

# php - Codeigniter - 内存耗尽

> ID：12098598
> 
> 赞同：1
> 
> 时间：2012-08-23T19:20:55.933
> 
> 标签：php, codeigniter

我目前正在使用 Codeigniter 和 MSSQL 数据库连接。有时，我收到此错误消息：

> PHP 致命错误：在第 0 行的 Unknown 中，允许的内存大小为 134217728 字节已用尽（尝试分配 139817425963032 字节）。

我对应用程序需要**139817425963032 字节**(130 Tb) 才能工作的想法感到不知所措。

有人能帮我吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T13:30:15.667

看起来像一个 64 位指针（现代 x86-64 上只有 48 位用于虚拟地址）被传递给 malloc()。

一定是某个扩展中的错误，如果它只是偶尔发生，它可能是例如缓冲区溢出。如果它一直发生，那么它是常规错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:24:40.877

这通常是由导致递归的操作、记录（例如`var_dump`）大块数据（如模型数组）等引起的。

# object - 为什么这些对象在 D 中默认不相等？

> ID：12098606
> 
> 赞同：7
> 
> 时间：2012-08-23T19:21:30.153
> 
> 标签：object, hash, d, equals

看看我正在构建的这个简单的类，作为存储字符串匹配算法结果的基础：

```
/** Match of a single pattern in full to a single text. */
class Match {
    uint Tpos;

    this(in uint Tpos) { this.Tpos = Tpos; }

    override string toString() {
        return text("Match: Text@",Tpos);
    }
} 
```

这就是事情变得奇怪的地方：

```
auto m1 = new Match(1), m2 = new Match(1);
writeln(m1.toHash());
writeln(m2.toHash());
writeln(m1 == m2); 
```

印刷

```
4464528
4464512
false 
```

我看不出为什么默认情况下这两个对象不应该被认为是相等的。我想我可以编写一个自定义`toHash()`和`opEquals()`函数，但这似乎有点矫枉过正。根据 Andrei Alexandrescu关于 D 编程语言的[书](http://erdani.com/index.php/books/tdpl/)（好书！），“默认情况下，哈希是通过使用对象的按位表示来计算的。” 有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T19:26:20.760

您必须自己实施`toHash`，因为`Object.toHash`取决于地址。如果我没记错的话，它只是一个`return cast(hash_t)cast(void*)this`.

**编辑：**是的，我没记错：[https ://github.com/D-Programming-Language/druntime/blob/master/src/object_.d#L88](https://github.com/D-Programming-Language/druntime/blob/master/src/object_.d#L88)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-23T19:29:43.070

从源代码（dmd2/src/druntime/src/object_.d）：

```
class Object
{
/* snip */
    /**
     * Compute hash function for Object.
     */
    hash_t toHash() @trusted nothrow
    {   
        // BUG: this prevents a compacting GC from working, needs to be fixed
        return cast(hash_t)cast(void*)this;
    }
/* snip */
    /**
     * Returns !=0 if this object does have the same contents as obj.
     */
    equals_t opEquals(Object o)
    {
        return this is o;
    }
} 
```

所以答案很简单，这就是代码的编写方式——他们进行身份检查而不是内容检查。为什么会这样？我真的不知道，但我的猜测是最初编写起来很简单，并且运行良好，以至于没有人费心回到它并更改它。

在新闻组上，有一些关于从 Object 中完全删除这些函数的讨论，所以如果你想要 == 在你的类上，你必须实现一些东西。但是当涉及到这样的事情时，新闻组谈话变成行动所需的时间通常很长。他们可能会改变主意。

目前和可能在可预见的将来使用类相等的最佳方法是在类中编写自己的 opEquals 方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-23T19:25:22.380

答案很简单：默认情况下，`opEquals`for objects 比较对象的地址。如果您想要值语义（或仅使用 a ） ，则*必须覆盖它。*`struct`

旁注：您的使用`in`不正确。`in`是`scope const`where的缩写，`scope`意思是“我不会在我的堆栈框架之外转义这个参数”（你可以通过将它分配给一个类字段来做到这一点）。不幸的是，编译器尚未强制执行此操作，这就是您没有收到错误的原因。

# ruby-on-rails - 创建/更新与上传图像相关的对象时缺少参数

> ID：12098610
> 
> 赞同：1
> 
> 时间：2012-08-23T19:21:42.827
> 
> 标签：ruby-on-rails, paperclip

编辑：将错误缩小到当我尝试通过回形针上传图像时

好吧，所以只是尝试添加/编辑我在 heroku 上的数据库的元素并开始出现错误。检查了heroku日志得到了这个

```
2012-08-23T19:10:42+00:00 app[web.1]: Completed 500 Internal Server Error in 363ms
2012-08-23T19:10:42+00:00 app[web.1]: 
2012-08-23T19:10:42+00:00 app[web.1]: NoMethodError (undefined method `[]' for nil:NilClass):
2012-08-23T19:10:42+00:00 app[web.1]:   app/controllers/apartments_controller.rb:68:in `new'
2012-08-23T19:10:42+00:00 app[web.1]:   app/controllers/apartments_controller.rb:68:in `create' 
```

如果我检查 apt 控制器的第 68 行上的内容，我会得到这个......

```
def create
@apartment = Apartment.new(params[:apartment]) 
```

不太确定为什么这会导致错误，直到不久前它一直运行良好，如果有人能提供帮助，将不胜感激。

新视图：

```
<div id="new"><center><h1>New apartment</h1>
<%= render 'form' %>
<br />
<%= link_to 'Back', apartments_path %></center>
</div> 
```

_form 视图：

```
<div id="formApt">
<%= form_for @apartment, :html => { :multipart => true } do |f| %>
  <% if @apartment.errors.any? %>
<div id="error_explanation">
  <h2><%= pluralize(@apartment.errors.count, "error") %> prohibited this apartment from being saved:</h2>
  <ul>
  <% @apartment.errors.full_messages.each do |msg| %>
    <li><%= msg %></li>
  <% end %>
  </ul>
</div>
  <% end %>
    <div class="field">
    <%= f.label :agent %><br />
   <%= f.collection_select :agent, Apartment::AGENTS, :to_s, :to_s, 
   :include_blank => true %><br />
         </div>
  <div class="field">
    <%= f.label :location %><br />
    <%= f.text_field :location %><br />
  </div>
    <div class="field">
    <%= f.label :availability %><br />
     <%= f.collection_select :availability, Apartment::AVAILSEL, :to_s, :to_s, 
   :include_blank => true %><br />
  </div>
  <div class="field">
    <%= f.label :Bed %><br />
    <%= f.number_field :Bed %><br />
  </div>
  <div class="field">
    <%= f.label :Bath %><br />
    <%= f.number_field :Bath %><br />
   </div>
  <div class="field">
    <%= f.label :Rent %><br />
    <%= f.text_field :Rent %><br />
  </div>
  <div class="field">
    <%= f.label :Pets %><br />
     <%= f.collection_select :Pets, Apartment::PETSSEL, :to_s, :to_s, 
   :include_blank => true %><br />
  </div>
   <div class="field">
    <%= f.label :Security_Deposit %><br />
     <%= f.text_field :Security_Deposit %><br />
  </div>
   <div class="field">
    <%= f.label :Parking %><br />
    <%= f.text_field :Parking %><br />
  </div>
  <div class="field">
    <%= f.label :Laundry %><br />
      <%= f.collection_select :Laundy, Apartment::LAUNDRYSEL, :to_s, :to_s, 
   :include_blank => true %><br />
  </div>
   <div class="field">
    <%= f.label :Owner %><br />
    <%= f.text_field :Owner %><br />
  </div>
  <div class="field">
    <%= f.label :Date_Avail %><br />
    <%= f.date_select :Date_Avail %><br />
  </div>
  <div class="field">
    <%= f.label :Type_Heat %><br />
    <%= f.collection_select :Type_Heat, Apartment::HEATSEL, :to_s, :to_s, 
   :include_blank => true %><br />
  </div>
  <div class="field">
    <%= f.label :AC %><br />
     <%= f.collection_select :AC, Apartment::ACSEL, :to_s, :to_s, 
   :include_blank => true %><br />
  </div><br />  
    <div class="field">
    <%= f.file_field :photo %><br />
     <%= f.file_field :photo2 %><br />
     <%= f.file_field :photo3 %><br />
      <%= f.file_field :photo4 %><br />
  </div>
    <div class="field">
    <%= f.label :Description %><br />
    <%= text_area "apartment", "description", "cols" => 60, "rows" => 10 %><br />
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
    <div class="field">
  <% f.fields_for :apartment_image do |apartment| %>
  <% if apartment.object.new_record? %>
  <p>
  <%= apartment.label :caption, "Image Caption" %>
  <%= apartment.text_field :caption %>
  </p>
  <p>
 <% end %>
  </p> 
   </div>
   <% end %><% end %>
</div> 
```

显示视图

```
<head>
<!-- First, add jQuery (and jQuery UI if using custom easing or animation -->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
  <%= javascript_include_tag "jquery.timers-1.2" %>
  <%= javascript_include_tag "jquery.easing.1.3" %>
  <%= javascript_include_tag "jquery.galleryview-3.0-dev" %>
 <%= stylesheet_link_tag "jquery.galleryview-3.0-dev", :media => "all" %>
<!-- Lastly, call the galleryView() function on your unordered list(s) -->
<script type="text/javascript">
    $(function(){
        $('#myGallery').galleryView({
    transition_speed: 2000,         //INT - duration of panel/frame transition (in milliseconds)
    transition_interval: 4000,      //INT - delay between panel/frame transitions (in milliseconds)
    easing: 'swing',                //STRING - easing method to use for animations (jQuery provides 'swing' or 'linear', more available with jQuery UI or Easing plugin)
    show_panels: true,              //BOOLEAN - flag to show or hide panel portion of gallery
    show_panel_nav: false,          //BOOLEAN - flag to show or hide panel navigation buttons
    enable_overlays: true,          //BOOLEAN - flag to show or hide panel overlays

    panel_width: 900,               //INT - width of gallery panel (in pixels)
    panel_height: 500,              //INT - height of gallery panel (in pixels)
    panel_animation: 'slide',       //STRING - animation method for panel transitions (crossfade,fade,slide,none)
    panel_scale: 'crop',            //STRING - cropping option for panel images (crop = scale image and fit to aspect ratio determined by panel_width and panel_height, fit = scale image and preserve original aspect ratio)
    overlay_position: 'bottom',     //STRING - position of panel overlay (bottom, top)
    pan_images: true,               //BOOLEAN - flag to allow user to grab/drag oversized images within gallery
    pan_style: 'drag',              //STRING - panning method (drag = user clicks and drags image to pan, track = image automatically pans based on mouse position
    pan_smoothness: 15,             //INT - determines smoothness of tracking pan animation (higher number = smoother)
    start_frame: 1,                 //INT - index of panel/frame to show first when gallery loads
    show_filmstrip: true,           //BOOLEAN - flag to show or hide filmstrip portion of gallery
    show_filmstrip_nav: true,       //BOOLEAN - flag indicating whether to display navigation buttons
    enable_slideshow: false,            //BOOLEAN - flag indicating whether to display slideshow play/pause button
    autoplay: false,                //BOOLEAN - flag to start slideshow on gallery load
    show_captions: true,            //BOOLEAN - flag to show or hide frame captions 
    filmstrip_size: 3,              //INT - number of frames to show in filmstrip-only gallery
    filmstrip_style: 'scroll',      //STRING - type of filmstrip to use (scroll = display one line of frames, scroll filmstrip if necessary, showall = display multiple rows of frames if necessary)
    filmstrip_position: 'bottom',   //STRING - position of filmstrip within gallery (bottom, top, left, right)
    frame_width: 164,               //INT - width of filmstrip frames (in pixels)
    frame_height: 80,               //INT - width of filmstrip frames (in pixels)
    frame_opacity: 0.5,             //FLOAT - transparency of non-active frames (1.0 = opaque, 0.0 = transparent)
    frame_scale: 'crop',            //STRING - cropping option for filmstrip images (same as above)
    frame_gap: 5,                   //INT - spacing between frames within filmstrip (in pixels)
    show_infobar: true,             //BOOLEAN - flag to show or hide infobar
    infobar_opacity: 1              //FLOAT - transparency for info bar
    });
});
</script>
<style type="text/css">
    body { 
        margin: 2em; 
        font-family: Arial, Helvetica, sans-serif;
}
</style>
</head>
<body>
<div id="new"><br /><br /><br /><br /><br /><br /><br /><br />
<br /><br />
    <ul id="myGallery">
        <li> <%= image_tag @apartment.photo.url (:large) %>
        <li> <%= image_tag @apartment.photo2.url (:large) %>
        <li> <%= image_tag @apartment.photo3.url (:large) %>
        <li> <%= image_tag @apartment.photo4.url (:large) %>
</ul>   
    <p>
  <b>Agent:</b>
   <%= @apartment.agent %>
</p>
 <p>
  <b>Location:</b>
  <%= @apartment.location %>
</p>
 <p>
  <b>Availability:</b>
  <%= @apartment.availability %>
</p>
 <p>
  <b>Bed:</b>
  <%= @apartment.Bed %>
</p>
<p>
  <b>Bath:</b>
  <%= @apartment.Bath %>
</p>
<p>
  <b>Rent:</b>
  $<%= @apartment.Rent %>
</p>
<p>
  <b>Pets:</b>
  <%= @apartment.Pets %>
</p>
<p>
  <b>Security deposit:</b>
  $<%= @apartment.Security_Deposit %>
</p>
<p>
  <b>Parking:</b>
  <%= @apartment.Parking %>
</p>
<p>
  <b>Laundy:</b>
  <%= @apartment.Laundy %>
 </p>
 <p>
  <b>Owner:</b>
  <%= @apartment.Owner %>
 </p>
  <p>
  <b>Date avail:</b>
  <%= @apartment.Date_Avail %>
 </p>
 <p>
  <b>Type heat:</b>
  <%= @apartment.Type_Heat %>
 </p>
<p>
  <b>Ac:</b>
  <%= @apartment.AC %>
 </p>
<p>
  <b>Description:</b>
  <%= @apartment.description %>
</p>

<center>
<nav2>

<span id="home2"> <%= link_to image_tag("home.png"), root_url %></span>
    <span id="apartments2"><%= link_to image_tag("apartments.png"), {:action =>'aptMenu', :controller => 'apartments'} %></span>
    <a href="http://livewellchicago.herokuapp.com/?cat=forms"> <%= image_tag("forms.png") %>            </a>
   <a href="http://livewellchicago.herokuapp.com/?cat=landlords">
    <%= image_tag("landlords.png")%>    </a>
    <a href="http://livewellchicago.herokuapp.com/?cat=contactUs">
    <%= image_tag("contactus.png") %>    </a>

</nav2>
</div>
</body> 
```

参数：

```
{"commit"=>"Create Apartment",
 "apartment"=>{"Laundy"=>"In Building",
 "availability"=>"RENTED",
 "Owner"=>"mike",
 "Date_Avail(1i)"=>"2012",
 "Date_Avail(2i)"=>"8",
 "agent"=>"Jason Gold",
 "Security_Deposit"=>"1200",
 "Date_Avail(3i)"=>"23",
 "Rent"=>"3232",
 "Bed"=>"3232",
 "Type_Heat"=>"Radiator",
 "location"=>"ewew",
 "Bath"=>"32323",
 "Pets"=>"Cats Only",
 "Parking"=>"no",
 "AC"=>"Window Unit",
 "photo"=>#<ActionDispatch::Http::UploadedFile:0x103e34c80 @content_type="image/jpeg",
 @tempfile=#<File:/var/folders/bg/dnbp4t6s12g5bh3_yrj6ntvr0000gn/T/RackMultipart20120823-62841-rogrlw-0>,
 @headers="Content-Disposition: form-data; name=\"apartment[photo]\"; filename=\"livingroom.jpg\"\r\nContent-Type: image/jpeg\r\n",
 @original_filename="livingroom.jpg">,
 "description"=>"description goes here"},
 "authenticity_token"=>"3KhQ0Bh3D+DZSTbPPPhWmgJLqTQ7HyOx45Coa23N4mI=",
 "utf8"=>"✓"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:30:50.463

好吧，基本上这是我自己的错。与公寓模型和 has_attached_file 语句的格式有关

```
 has_attached_file :photo, :styles => {:small => "150x150>", :large => "800x720>", :convert_options => { :all =>     '-auto-orient' }} 
```

本质上 :convert_options 部分导致图像的参数为零，这会阻止将任何内容添加到数据库中（除非您避免添加图片）。但感谢普鲁斯旺的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:45:18.413

```
<%= text_area "apartment" ... %> 
```

应该是：

```
<%= f.text_area ... %> 
```

编辑：这两个版本实际上基于[this](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for)是等效的，所以问题出在其他地方。

# jsf - 动态 JSF (2.0) commandButtons - 使用参数设置动作

> ID：12098611
> 
> 赞同：8
> 
> 时间：2012-08-23T19:21:43.547
> 
> 标签：jsf, dynamic, jsf-2, action

我正在尝试将 JSF`<h:commandButtons>`动态添加到我的网页中，到目前为止我已经显示了它们，但是我无法像在静态页面中那样使用参数设置操作：
`action="#{bean.function(parameter)}"`. （这当然是使用 EL-2.2）
环顾四周，我发现我必须创建一个`MethodExpression`，但这对我来说是模糊的，我还没有找到很多关于这方面的信息。如果有人能在迷雾中发光并解释如何做到这一点，将不胜感激。

编辑：所以现在我有了这个

```
public void displayNode( String childName ){
//lots of messy code instantiating JSF components

if( activeEmployee.getParent() != null ){
        HtmlCommandButton parent = new HtmlCommandButton();
        HtmlOutputText parentLabel = new HtmlOutputText();

        parentLabel.setId("label" + count++);  //I really hate having to use count
        parentLabel.setValue( "Parent: " );

        parent.setId("Parent" + count++); 
        String parentName = activeEmployee.getParent().getName();
        parent.setValue( parentName );
        MethodExpression expression = createMethodExpression("#{tree.displayNode('" + parentName + "')}",
                                                                null, String.class);
        parent.setActionExpression( expression );

        newDiv.getChildren().add( parentLabel );
        newDiv.getChildren().add( parent );
    } 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-23T19:55:41.830

使用[`ExpressionFactory#createMethodExpression()`](http://docs.oracle.com/javaee/6/api/javax/el/ExpressionFactory.html#createMethodExpression%28javax.el.ELContext,%20java.lang.String,%20java.lang.Class,%20java.lang.Class%5B%5D%29).

> ```
> public abstract MethodExpression createMethodExpression(
>                                       ELContext context,
>                                       java.lang.String expression,
>                                       java.lang.Class<?> expectedReturnType,
>                                       java.lang.Class<?>[] expectedParamTypes) 
> ```

这是一个方便的方法：

```
public static MethodExpression createMethodExpression(String expression, Class<?> returnType, Class<?>... parameterTypes) {
    FacesContext facesContext = FacesContext.getCurrentInstance();
    return facesContext.getApplication().getExpressionFactory().createMethodExpression(
        facesContext.getELContext(), expression, returnType, parameterTypes);
} 
```

以下动作方法示例：

```
public void submit1()
public String submit2()
public void submit3(String argument)
public String submit4(String argument)
public void submit5(String argument1, Long argument2)
public String submit6(Long argument1, String argument2) 
```

然后可以按如下方式创建：

```
createMethodExpression("#{bean.submit1}", null);
createMethodExpression("#{bean.submit2}", String.class);
createMethodExpression("#{bean.submit3('foo')}", null, String.class);
createMethodExpression("#{bean.submit4('foo')}", String.class, String.class);
createMethodExpression("#{bean.submit5('foo', 0)}", null, String.class, Long.class);
createMethodExpression("#{bean.submit6(0, 'foo')}", String.class, Long.class, String.class); 
```

请注意，EL 表达式与您在普通视图文件中使用的完全相同。

* * *

**更新**这里是一个 SSCCE，它适用于我在 Tomcat 7.0.27 上的 Mojarra 2.1.12。

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
>
    <h:head>
        <title>SO question 12098611</title>
    </h:head>
    <h:body>
        <h:form binding="#{bean.form}">
            <h:commandButton value="add" action="#{bean.add}" />
        </h:form>
    </h:body>
</html> 
```

```
@ManagedBean
@RequestScoped
public class Bean {

    private UIForm form;

    public void add() {
        String id = "button" + form.getChildCount();
        UICommand button = new HtmlCommandButton();
        button.setId(id);
        button.setValue(id);
        button.setActionExpression(createMethodExpression(String.format("#{bean.submit('%s')}", id), null, String.class));
        form.getChildren().add(button);
    }

    public void submit(String arg) {
        System.out.println("submit: " + arg);
    }

    public UIForm getForm() {
        return form;
    }

    public void setForm(UIForm form) {
        this.form = form;
    }

    public static MethodExpression createMethodExpression(String expression, Class<?> returnType, Class<?>... parameterTypes) {
        FacesContext facesContext = FacesContext.getCurrentInstance();
        return facesContext.getApplication().getExpressionFactory().createMethodExpression(
            facesContext.getELContext(), expression, returnType, parameterTypes);
    }

} 
```

* * *

**与具体问题无关**，以上都是不好的做法。另请参阅[JSF 中的“绑定”属性如何工作？何时以及如何使用它？](https://stackoverflow.com/questions/14911158/how-does-the-binding-attribute-work-in-jsf-when-and-how-should-it-be-used)

# php - 如何链接文件以下载用户在当前会话期间使用 wkhtmltopdf 生成的文件

> ID：12098612
> 
> 赞同：0
> 
> 时间：2012-08-23T19:21:50.147
> 
> 标签：php, wkhtmltopdf

我目前正在使用 wkhtmltopdf 生成 pdf 文件，我想链接最近生成的文件供用户下载，但在用户完成会话后删除它们。无论如何，甚至没有在服务器上生成文件就可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:51:13.470

```
<?php
exec("/path/to/binary/wkhtmltopdf   http://www.google.com /location/test.pdf");
$file = "/location/test.pdf";
$pdf = file_get_contents($file);

header('Content-Type: application/pdf');
header('Cache-Control: public, must-revalidate, max-age=0'); // HTTP/1.1
header('Pragma: public');
header('Expires: Sat, 26 Jul 1997 05:00:00 GMT'); // Date in the past
header('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT');
header('Content-Length: '.strlen($pdf));
header('Content-Disposition: inline; filename="'.basename($file).'";');
ob_clean(); 
flush(); 
echo $pdf;

unlink($file);

?> 
```

文件没有被删除可能存在问题，所以我会添加一个 cron 作业来删除旧文件。

# php - PHP会话ID问题

> ID：12098615
> 
> 赞同：-5
> 
> 时间：2012-08-23T19:22:12.350
> 
> 标签：php, session

我有一个网站，在我刷新页面之前，网站上的某些内容不会出现。

如果我删除我的 PHP 会话 ID，我在我的代码中发现了这个，`session_start();`我页面上的东西又消失了，看起来这个会话需要在第一页加载时设置……有人知道该怎么做吗？

顺便说一句，不会出现的是一个表格，一个 GET 表格。

谢谢

这是会话的代码

```
function wpsc_core_load_session() {
    if ( !isset( $_SESSION ) )
        $_SESSION = null;

    if ( ( !is_array( $_SESSION ) ) xor ( !isset( $_SESSION['nzshpcrt_cart'] ) ) xor ( !$_SESSION ) )
        session_start();
} 
```

他是什么没有出现

```
<form class="product_search" style="font-size:0px !important;" method="GET" action="<?php echo $pp_url?>/" >
                <input name="product_search" id="wpsc_search_autocomplete" class="wpsc_product_search wpsc_live_search_embed .wpsc_live_search" autocomplete="off" style="padding:0px !important; height:25px !important; vertical-align:top;" />
                <script type='text/javascript' > /* <![CDATA[ */
                    jQuery('#wpsc_search_autocomplete').keypress( function(e){
                        if ( e.keyCode == 13 ) {
                            var url = '<?php echo $pp_url ?>'+'?product_search='+jQuery(this).val();
                            url = encodeURI(url);
                            jQuery(window.location).attr('href', url);
                        }
                    });
                     /* ]]> */
                     </script>
                     <input type="submit" id="button" name="button" class="searchBtn" value="GO"/>
            </form> 
```

我打开了我的 Wordpress 调试器，结果就是这样

```
Warning: session_start() [function.session-start]: Cannot send session cookie - headers already sent by (output started at /home/content/19/9468119/html/wp-content/plugins/jquery-colorbox/jquery-colorbox.php:34) in /home/content/19/9468119/html/wp-content/plugins/wp-e-commerce/wpsc-core/wpsc-constants.php on line 13

Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /home/content/19/9468119/html/wp-content/plugins/jquery-colorbox/jquery-colorbox.php:34) in /home/content/19/9468119/html/wp-content/plugins/wp-e-commerce/wpsc-core/wpsc-constants.php on line 13 
```

当缺少的表单存在时，会出现此消息....

```
Notice: A session had already been started - ignoring session_start() in /home/content/19/9468119/html/wp-content/plugins/wp-e-commerce/wpsc-core/wpsc-constants.php on line 18 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:46:57.317

你有一个基本问题：

```
if ( !isset( $_SESSION ) )
    $_SESSION = null;

if ( ( !is_array( $_SESSION ) ) xor ( !isset( $_SESSION['nzshpcrt_cart'] ) ) xor ( !$_SESSION ) )
    session_start(); 
```

在会话开始之前，您无法访问它。尝试启动它，然后访问它...

xor 也是按位比较...我不确定这是否是您在这里寻找的东西，也许`||`是。

> 似乎此会话需要在第一页加载时设置...有人知道该怎么做吗？

通常，第一页加载由脚本的顶部或在输出标题之前运行的任何内容表示，但由于您的新页面，我只会在顶部说。试着把它放在那里。

很可能您收到错误并`display_errors`下车，因此我认为您会得到一个空白页。

# ruby-on-rails-3 - 在 Rails 3 中的模型中使用模块函数

> ID：12098618
> 
> 赞同：0
> 
> 时间：2012-08-23T19:22:25.347
> 
> 标签：ruby-on-rails-3, module, dry

我在每个模型中都有 4 个常用功能：

```
#Returns TRUE or FALSE depending on whether the column could be null or not
def self.null?(column)
  columns_hash[column].null
end

#Custom delete function to change a state (deleted is a field)
def custom_delete
  deleted = true
  save
end

def str_created_at(format = "%d/%m/%Y %I:%M %p")
  return created_at.in_time_zone.strftime(format)
end

def str_updated_at(format = "%d/%m/%Y %I:%M %p")
  return updated_at.in_time_zone.strftime(format)
end 
```

我试图将这 4 个函数（其中 1 个是抽象的：null？）移动到一个没有运气的模块：

```
#config/application.rb
config.autoload_paths += Dir["#{config.root}/lib/**/"]

#app/models/post.rb
class Post < ActiveRecord::Base
    include BaseModel
    default_scope where(:deleted => false)
end

#lib/base_model.rb
module BaseModel

    def self.included(base)
        base.extend ClassMethods
    end

    module InstanceMethods

        def custom_delete
            deleted = true
            save
        end

        def str_created_at(format = "%d/%m/%Y %I:%M %p")
            return created_at.in_time_zone.strftime(format)
        end

        def str_updated_at(format = "%d/%m/%Y %I:%M %p")
            return updated_at.in_time_zone.strftime(format)
        end
    end 

    module ClassMethods
        include BaseModel::InstanceMethods

        def self.null?(column)
            columns_hash[column].null
        end
    end

end 
```

在 Rails 控制台中：

```
> Post.null?("title")
> NoMethodError: undefined method 'null?' for #<Class:0x3f075c0>
> post = Post.first
> post.str_created_at
> NoMethodError: undefined method 'str_created_at' for #<Post:0x2975190> 
```

有没有办法让这些功能正常工作？我在 Stackoverflow 上找到了这段代码，但似乎没有用，至少 Rails3 没有

我希望有可能只用 1 行添加这些功能：包括 BaseModel

所以我也可以将它添加到其他模型中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:57:16.510

担忧是解决办法。能够模块化您的应用程序非常重要，无论是对于 Rails 应用程序还是对于库。请注意，这种方法在与引擎挂起时也很酷。

对于模型和控制器，关注点必须放在关注点文件夹中。请注意不要过多地使用它们。您必须主要在类之间共享功能以及想让模型变瘦时使用它。在最后一种情况下，请等待它真的很大，否则关注点将成为垃圾目录，您将失去它的作用。

# 配置应用程序.rb

在这里，您可以看到如何组织您的模型和控制器关注点。

```
module YourApp
  class Application < Rails::Application
    config.autoload_paths += %W(
      #{config.root}/app/controllers/concerns
      #{config.root}/app/models/concerns
    )
  end
end 
```

# 制造疑虑

`ActiveSupport::Concern`您可以使用类定义您的关注点。它简化了“包含”阶段（您不必`base`用作前缀），它会自动加载模块 ClassMethod 内部的类方法。

这里有一个改变的例子。

```
class Message < ActiveRecord::Base
  include Trashable
end

module Trashable
  extend ActiveSupport::Concern

  included do
    field :new
  end

  module ClassMethods
    # some class methods
  end

  # some instance methods
  end 
```

在这里你可以找到一篇很好的[文章](http://opensoul.org/blog/archives/2011/02/07/concerning-activesupportconcern/)，详细解释它们。

# php - 获取 $_SERVER['AUTH_USER'] 的空白值

> ID：12098621
> 
> 赞同：10
> 
> 时间：2012-08-23T19:22:40.460
> 
> 标签：php, active-directory, windows-server-2008

我有一个在 Windows 2008 服务器 R2 上运行的 PHP 应用程序，它使用 PHP 的 LDAP 库针对 Active Directory 对用户进行身份验证。

根据[这个答案](https://stackoverflow.com/questions/168610/can-you-get-a-windows-ad-username-in-php)，我正在寻找使用`$_SERVER['AUTH_USER']`，但我得到了一个空白值。`AUTH_TYPE`和相同`AUTH_PASSWORD`。变量已声明，但没有一个变量分配给它们任何值。

我已经启用了基本身份验证和 Windows 身份验证角色（通过服务器管理器），但都没有解决问题。

我正在使用 PHP 5.3.14、Zend Server CE 和 IIS 7.5。

我需要应用单点登录解决方案，但无法获取当前登录用户的凭据，我不知所措。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-23T21:23:45.613

我通过在 IIS 中禁用匿名身份验证并启用 Windows 身份验证来使其工作（我认为 Windows 身份验证已启用，但事实证明该角色只是安装了。）现在`$_SERVER['AUTH_USER']`并`$_SERVER['REMOTE_USER']`已填充。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:37:47.087

我相信经过身份验证的用户的正确索引是`$_SERVER['REMOTE_USER']`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:40:32.400

根据[PHP 文档](http://php.net/manual/en/features.http-auth.php)，正确的索引似乎是`PHP_AUTH_USER`.

尝试使用`$_SERVER['PHP_AUTH_USER']`.

# java - 多个 sql 查询与 Java 二进制搜索的效率

> ID：12098622
> 
> 赞同：2
> 
> 时间：2012-08-23T19:22:47.053
> 
> 标签：java, sql, ajax

我有一个问题，我有很多数据要绘制。图表的设置使得最初只绘制少量点，但您可以“放大”以获得特定日期范围的更多点（这通过对 Java 后端的 AJAX 请求发生）

我已经想到了两种方法，并希望得到一些反馈，说明哪种方法可能更有效：

*   只需对具有相关日期范围的每个请求执行新的 sql 查询或
*   将所有日期范围的所有记录预加载到我的 Java 框架中的 ORM 类中。将这些添加到二叉搜索树中。然后当用户提出请求时，只需执行二分查找。

我假设数据库已经有某种基于树的索引，但是通过第二种方法，我可以避免重复 db 调用的开销。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:26:19.793

最好的观察方法是分析这两种解决方案，但我的直觉是你的 DBMS 会比你做的快得多。DBMS 专门设计用于非常快速地处理这样的查询。他们的优化器可能比你在 Java 中实现的要好。

这是假设您的数据库已正确配置和优化以处理您描述的查询。我怀疑重复数据库调用的成本不足以抵消 DBMS 的性能。

让 DMBS 进行这种搜索也更简洁，因为它最大限度地减少了您需要自己编写的代码。

同样，确定的最佳方法是快速制作解决方案和配置文件的原型。

# ruby-on-rails - 在 rails form_for 中使用 JSON

> ID：12098624
> 
> 赞同：1
> 
> 时间：2012-08-23T19:23:00.073
> 
> 标签：ruby-on-rails, json, forms, api

我正在构建一个通过 JSON 与第三方 API 交互的表单。我的目标是能够根据输入到表单中的值创建 JSON 调用。如果 JSON 响应返回错误，我希望 form_fields 维护用于生成响应的值。

我应该如何构建表单并将 JSON 字段绑定到表单？

当绑定到模型时，我通常会有类似的东西：

```
<%= form_for @person do |f| %>
  <%= text_field_with_label f, :first_name %>
<% end %> 
```

在我的控制器中，我有：

```
def new
 @person = Person.new
end 
```

但是当没有模型时我将如何设置它。控制器上的新操作会是什么？一个空的 JSON 结构？我将如何设置输入字段，以便它们保留用于进行初始 JSON 调用的值（在出现错误时响应将用户带回表单的情况下）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:48:21.033

而不是使用 form_for 您将使用 form_tag 和其他 *_tag 方法。你上面的例子是：

```
<%= form_tag :controller => 'users', :action => 'myaction' %>
  First Name <%= text_field_tag :name, params[:name] %>
<% end %> 
```

然后您可以在您选择的控制器和操作中处理它。请记住，您还需要在 routes.rb 文件中为您的操作添加自定义路由：

```
get 'users/new'
post 'users/myaction' 
```

控制器动作的一般逻辑是：

```
def new
end

def myaction
  success = call_external_service_here
  if success
    redirect_to 'somewhere'
  else
    render 'new'
end 
```

您将在控制器中将新方法留空。text_field_tag 的第二个参数提供该字段的值，在新操作中该值将为空白，但如果外部服务调用导致失败，则在呈现表单页面时将插入该值。

# objective-c - 导航控制器子视图的属性未更新

> ID：12098627
> 
> 赞同：0
> 
> 时间：2012-08-23T19:23:18.007
> 
> 标签：objective-c, xcode, uitableview, uinavigationcontroller

我有一个 UITableView，当我使用此代码推送视图时（存在简化的“dic”）。第一次它将加载标记对象。但是当我回去打开一个不同的单元格时，它使用相同的标记对象。我应该使用后退按钮上的选择器来取消`self.ViewController`.

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{            
        if (!self.ViewController) {
            self.ViewController = [[TextViewController alloc] initWithNibName:@"ViewController" bundle:nil markup:[dic objectForKey:@"text"]];
        }
    [self.navigationController pushViewController:self.ViewController animated:YES];

} 
```

属性不会更新。为了确定，我尝试了不同的设置方法。

是否有我可以将标记属性放在上面的超弱设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:02:05.450

解决了。如果 self.ViewController 已经存在，我只是将其无效。我在代码的开头使用了它。

```
if (self.ViewController) {
    self.ViewController = nil;
} 
```

# javascript - 每个范围之外的“这个”（JQuery）

> ID：12098629
> 
> 赞同：1
> 
> 时间：2012-08-23T19:23:25.603
> 
> 标签：javascript, jquery

**我试图在这个实例中摆脱 ref 的那个讨厌的变量声明**，我确信有一种方法可以摆脱每个范围以获得待命的“this”。我只是不知道该怎么做。

```
$(document).on('click', '.item', function(){

    var ref = $(this).attr('data-id');

    $.each(t, function(){
        if(this.id == ref){
            //action
            return false;
        }
    });
} 
```

这不是真正的生死攸关，我只是想清理代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:36:13.763

有一种方法可以做到这一点：使用`event`自动传递给事件处理程序的引用。

```
$(document).on('click', '.item', function(e) {
    $.each(t, function(){
        if (this.id == $(e.target).attr('data-id')) {
            //action
            return false;
        }
    });
} 
```

但是，除了在代码运行时有更多时间做其他事情之外，这不会给您带来任何好处。;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T19:36:18.990

其实有什么可以做的。您可以将函数绑定到上下文。由于您已经在使用 jQuery，您可以使用 jQuery.proxy，它接受参数函数和上下文，将该函数绑定到该上下文并返回一个新函数。

阅读此内容，您会有所了解：[http ://www.robertsosinski.com/2009/04/28/binding-scope-in​​-javascript/](http://www.robertsosinski.com/2009/04/28/binding-scope-in-javascript/)

然后看看这个：[http ://api.jquery.com/jQuery.proxy/](http://api.jquery.com/jQuery.proxy/)

希望这个对你有帮助... ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:32:34.600

不确定您的意图是什么，但如果只是简单地引用这个原始元素：

```
$(document).on('click', '.item', function(){
    var that = this;
    $.each(function(){
       // use 'that' however you'd like
       if ($(that).data().id == 'whatever') ...
     }
}); 
```

您不能在 javascript 中“离开”范围，您只能引用父范围中的声明。

# c++ - getter 和 setter 方法有什么用？

> ID：12098636
> 
> 赞同：4
> 
> 时间：2012-08-23T19:23:51.600
> 
> 标签：c++, getter-setter

> **可能重复：**
> [为什么要使用 getter 和 setter？](https://stackoverflow.com/questions/1568091/why-use-getters-and-setters)

> 谁能告诉我getter/setter方法的用途是什么？

## 在一次采访中，有人让我写一个简单的类......所以，我写了一个如下所示的类：

```
class X
{
    int i;
public:

    void set(int ii){ i = ii;}
    int get(){ return i;}
}; 
```

现在，问题是这样的：

> > Q1。为什么将变量“i”声明为私有而不是公共？
> > 
> > 我的回答：Bcoz，数据总是敏感的，通过将其声明为私有，您将防止它暴露于外部世界。
> 
> 为了反驳我的推理，面试官说......“那么，你为什么要提供一个公共的 getter/setter 方法？？既然这些成员函数是公共的，所以变量 'i' 仍然暴露给外界，任何人都可以更改'i' 的值。”
> 
> 此外，面试官建议我重写我之前的课程如下：

```
class X
{
public:

    int i;
}; 
```

好处是：您可以更快地修改“i”的值……因为这次不需要函数调用。

不过，面试官的推理似乎很好......因为通过制作私有变量“i”和公共 get/set 方法，您无法保护您的数据。那么，我们为什么要编写 get()/set() 方法呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:28:53.317

目的是，如果需要（例如有效性检查），您始终可以使用更复杂的逻辑更改 setter 和 getter 方法。如果您不使用 getter/setter，则必须编写它们，然后在更改字段的任何地方更改代码，这可能会导致很难找到的错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T19:29:04.957

拥有访问器和修改器隐藏了用于访问该变量的逻辑。如果逻辑发生变化，您只需在成员函数中更改它，而不是在任何访问该公共变量的地方进行更改。这有助于保持内部状态数据对外界隐藏，因此您不必担心这些操作的实现细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:29:33.990

我们使用 getter/setter 和私有数据变量来确保[数据封装](http://www.tutorialspoint.com/cplusplus/cpp_data_encapsulation.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T19:29:52.450

好吧，您可以将这些访问器设为*私有*。客户端不需要知道类型的数据表示——这是抽象的一个组成部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T19:32:54.300

## 我的回答是：

> 我同意我们仍然可以将变量“i”声明为 public，并且我们可以删除 get/set 方法的使用。但这只有在您 100% 确定将来不会更改您的类变量时才能完成。
> 
> 因为...如果我们删除 get/set 方法，那么我们将直接在 100 个文件中使用 'i'。[比如：object.i = 10;] 如果有任何机会，您的变量 'i' 会更改为 ' j'，那么您的文件将开始失败。
> 
> 所以，为了克服这个问题......我们使用 get/set 方法。唯一需要更改的地方是在 X 类中，make 'i' --> 'j'。
> 
> 这是我能想到的 get/set 方法的唯一用途。

# php - php Facebook 提要

> ID：12098643
> 
> 赞同：-1
> 
> 时间：2012-08-23T19:24:24.597
> 
> 标签：php, facebook

嗨，我遇到了一些麻烦。我正在尝试从某个 facebook 页面获取我的提要，代码如下所示：

```
<?php
//Get the contents of the Facebook page
try
{    
$FBpage = file_get_contents('https://graph.facebook.com/hereihaveenteredcorrectpageid
/feed?access_token=hereihaveenteredcorrectaccesstoken');
}catch{
echo "Load Failed";       
}  
//Interpret data with JSON
$FBdata = json_decode($FBpage);
echo "$FBdata";
//Loop through data for each news item
foreach ($FBdata->data as $news ) {
//Explode News and Page ID's into 2 values
$StatusID = explode("_", $news->id);
echo '<li>';
//Check for empty status (for example on shared link only)
echo $news->message;
echo '</li>';
}
?> 
```

我检查了网址，当我输入网址时，我在浏览器中获得了正确的提要，但我的网站上没有显示任何内容。这段没有try catch的代码返回页面但根本没有提要，这段带有try catch的代码返回空白页（wordpress）。我不明白出了什么问题以及为什么我无法获得提要。

我试图在 json 之后回显 $FBpage 和 $FBdata，但它什么也不返回，就像提要是空的......没有错误消息。

所以问题出在某个地方的 get_file_contents ......它只是不起作用。请帮帮我，我不知道该怎么办。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:27:33.160

您有空白页的原因是您的`try {} .. catch {}`语句中有解析错误。它应该是：

```
}catch (Exception $ex){ 
```

# php - mongodb num_rows 等效 php

> ID：12098647
> 
> 赞同：3
> 
> 时间：2012-08-23T19:24:37.560
> 
> 标签：php, mongodb

我怎样才能得到结果的数量，相当于`num_rows`(mysqli) in `mongodb`？

如果我有

```
$db->$dbName->find(array("email" => $newemail, "password" => $newpass)); 
```

检查符合此标准的结果数量的最佳方法是什么？

在 mysqli 我会做类似的事情

```
$sql = "SELECT id FROM table WHERE email='%s' AND password='%s'";
$query = sprintf($sql, $newemail, $newpass);
$result = $conn->query($query);
$rows = $result->num_rows; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T19:34:46.933

像这样，我认为：

```
$collection = $connection->myDB->myCollection;
$cursor = $collection->find(array("email" => $newemail, "password" => $newpass));
$nResults = $cursor->count(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:35:44.810

我相信你正在使用的返回一个 MongoCursor 所以你可以使用它的方法[count](http://www.php.net/manual/en/mongocursor.count.php)来获取行数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:08:24.720

请注意，`count()`是标准而不是`skip`和`limit`。这与 PHP 中的 MySQLi 驱动程序略有不同，因为它考虑了这一点`LIMIT`。

如果您使用跳过和限制，为了了解真实计数，您将需要将光标实际转换为数组或再次使用 count() 函数在其签名中提供参数：[http ://www.php.net /manual/en/mongocursor.count.php](http://www.php.net/manual/en/mongocursor.count.php)将其设置为 true*应该*只会让你得到那些实际发现的结果，考虑到 sip 和 limit。

否则，对于您的示例，正​​如其他人所说，您可以`count`正常使用。对于您提供的示例，我可能实际上会使用`findOne`.

# mysql - 如何在 MySQL 表中查找所有大写字符串？

> ID：12098649
> 
> 赞同：9
> 
> 时间：2012-08-23T19:24:50.400
> 
> 标签：mysql, string, case-sensitive, uppercase

我最初认为这是微不足道的。然后认为“二进制”可能会做到这一点。在这一点上我不确定。

```
Name
----
John
MARY
Kin
TED 
```

我想只查询全部大写的 MARY 和 TED。我将如何查询这个？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-08-23T19:30:17.127

如果您的排序规则不区分大小写，那么您需要使用`BINARY`比较：

```
SELECT *
FROM yourtable
WHERE Name = BINARY UPPER(Name) 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/ea52e/1)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T19:27:42.170

您只需在字段上使用[UPPER()](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_upper)函数`Name`并将结果与​​原始值进行比较`Name`：

```
select Name from Table where Name = UPPER(Name) 
```

这边走

```
UPPER(Name)   ||  Name
---------------------------------------
JOHN          !=  John
MARY          ==  MARY
KIN           !=  Kin
TED           ==  TED 
```

只会返回您需要的行。

正如@mdoyle 在这里评论的那样，您应该使用正确的排序规则（区分大小写）定义列，否则就像其他人回答的那样，您需要[BINARY](http://dev.mysql.com/doc/refman/4.1/en/cast-functions.html#operator_binary)运算符来比较不区分大小写的列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T19:28:36.427

试试这个：

```
select name from table where name=upper(name); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T19:37:58.147

试试这个：

```
SELECT Name
FROM   table
WHERE  Name COLLATE latin1_general_cs LIKE UPPER(Name)
; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-24T07:09:08.260

下面使用：

```
SELECT name FROM table WHERE name = BINARY UPPER(column_name); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T19:29:10.717

这也将返回数值，但这看起来不是您的列名的问题。

```
SELECT * FROM names WHERE 

ASCII(name) = ASCII(Upper(name)) 
```

# java - 动态更新在休眠状态下不起作用

> ID：12098657
> 
> 赞同：2
> 
> 时间：2012-08-23T19:25:38.597
> 
> 标签：java, hibernate

我有一个客户表，其中有 3 列，即 id、name 和 age。

如果我创建一个没有年龄的客户对象，即我没有设置任何年龄值，那么如果表中存在相同的客户（由客户 ID 标识），则 saveOrUpdate() 将年龄列更新为 0。我我希望避免年龄列值被零或空值覆盖（如果表中已经存在）。例如，根据下面粘贴的代码片段，如果客户 ID 10 已经存在具有某些年龄值的行，那么在这种情况下，我的年龄不应该被零覆盖。

我在谷歌上搜索，发现我可以将 dynamicUpdate 设置为 true 来实现这一点。但是在执行代码时，我的年龄值仍然被 0 覆盖。我正在粘贴代码片段

```
@Entity
@Table(name = "CUSTOMER")
@org.hibernate.annotations.Entity(
        dynamicUpdate = true
)
public class Customer {

    @Id
    @GeneratedValue
    @Column(name = "CUSTOMER_ID")
    private int custId;

    @Column(name = "CUSTOMER_NAME")
    private String custName;

    @Column(name = "CUSTOMER_AGE")
    private int custAge;
        ............
        ...........

       Customer cust = new Customer();
       cust.setCustId(10);
       cust.setCustName("anand");       
       session.saveOrUpdate(cust);      
       tx.commit(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-07-21T05:52:34.050

要让 dynamicUpdate 工作，get 和 update 必须在同一个事务中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:29:09.547

第一：最好使用 an`Integer`而不是 an`int`作为 custAge 的类型。这样，您可以区分空值和有效 0 值。

然后，这`dynamicUpdate = true`对于您要执行的操作很有用，但您还需要将对象重新附加到会话（在更新情况下）。例如：

```
customer = session.get(Customer.class, id);
customer.set(...);
session.saveOrUpdate(customer); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-10T16:49:35.267

动态更新仅在我们首先使用 session.get(...) 获取值时起作用。在这种情况下，假设我们有 10 列并且我们想要更新 5 列，然后首先我们使用 id 获取对象，然后将新值设置为获取的对象，然后它工作得很好更多我们只为5列编写编码，如果我们从那5列更新一列，然后使用动态更新查询触发，如下所示

休眠：更新用户管理员集名称=？user_id=?

下面是我的代码，在这里我只从前端改了名字

```
Session session = sessionFactory.openSession();
    Transaction tran = session.beginTransaction();
    Usermaster obj = (Usermaster) session.get(Usermaster.class,
            usermaster.getUserId());
    obj.setUsername(usermaster.getUsername());
    obj.setName(usermaster.getName());
    obj.setContact(usermaster.getContact());
    obj.setEmail(usermaster.getEmail());
    obj.setUserStatus(usermaster.getUserStatus());
    obj.setUserType(usermaster.getUserType());
    session.update(obj); 
```

# ruby-on-rails - 即使在生产模式下从服务器运行时，Resque 也会写入开发数据库

> ID：12098661
> 
> 赞同：0
> 
> 时间：2012-08-23T19:25:44.917
> 
> 标签：ruby-on-rails, redis, resque

当我在生产中启动我的应用程序以在部署到服务器之前对其进行测试时，我注意到我的一个由 Resque.enqueue(worker) 调用的数据库操作是在错误的数据库上执行的！development.sqlite3 而不是 production.sqlite3。我正在使用零配置文件运行服务器和 resque。必须有某种方法可以在正确的环境中运行 redis 或 resque。

```
defaults: &defaults
host: localhost
port: 6379
development:
<<: *defaults
test:
<<: *defaults
staging:
<<: *defaults
production:
<<: *defaults 
```

我找到的这个redis配置文件可能是关键，但是redis不喜欢它，说

```
*** FATAL CONFIG FILE ERROR ***
 Reading the configuration file, at line 1
>>> 'defaults: &defaults'
Bad directive or wrong number of arguments 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:13:38.263

您是否在生产环境中启动了 resque worker ？你可以这样做，

```
$ RAILS_ENV=production QUEUE=* rake resque:work

```

# c# - 枚举表达式列表以过滤集合

> ID：12098676
> 
> 赞同：8
> 
> 时间：2012-08-23T19:26:28.550
> 
> 标签：c#, linq, lambda, expression

我在这里挑战了我在 c# 和 linq 方面的知识极限，所以如果我完全不理解我的示例或对 linq、c#、泛型类型、lambda 表达式、设计模式等的理解，请多多包涵。

我有一个包含两个集合的类，一个是要过滤的集合：`IEnumberable<InstagramUser>`第二个是要过滤的表达式集合：`IEnumerable<IInstagramFilter>`。

```
public class InstagramDisplay {

    public IEnumerable<InstagramUser> instagramUsers;
    public IEnumerable<IInstagramFilter> instagramFilters; 

    public InstagramDisplay() {
        instagramUsers = new List<InstagramUser>();
        instagramFilters = new List<IInstagramFilter>();
    }

    public IEnumerable<InstagramUser> display() {
        instagramFilters.ToList().ForEach(x => instagramUsers.Where(x.filter(instagramUsers)));
        return instagramFilters;
    }
}

public interface IInstagramFilter {
    Expression<Func<T, bool>> filter<T>(IQueryable<T> source); 
} 
```

我会让课程扩展`IInstagramFilter`。每个`IInstagramFilter`类都有一个属性（或函数 - 不确定什么是最好的），它将返回将`IEnumerable<InstagramUser>`在`display()`方法中应用的 lambda 表达式。

```
public class UserFilter : IInstagramFilter {
    public Expression<Func<T, bool>> filter<T>(IQueryable<T> source) {
        //return some expression - but how?
    }
} 
```

我正在努力理解一些事情：

1.  如何为每个`IInstagramFilter`类设置表达式，然后在`display()`方法中调用它？

2.  每个`IInstagramFilter`类都有一个用于过滤的 lambda，`IEnumerable<InstagramUser>`但由于 Filter 类不知道`IEnumerable<InstagramUser>`我将如何首先创建适当的 lambda？

3.  我认为这大致遵循装饰者模式，但也许有一个更好的设计，我不知道。

**更新代码**

根据 Olivier 的回答，这就是我现在所拥有的。在退货时，`display()`我在使用时遇到错误`.Where(filter)`

> `System.Linq.Enumerable.Where<TSource>(System.Collections.Generic.IEnumerable<TSource>, System.Func<TSource,bool>)`无法从用法中推断方法“ ”的类型参数。尝试明确指定类型参数。

```
public class InstagramDisplay {

    public IEnumerable<InstagramUser> instagramUsers;
    public List<Expression<Func<InstagramUser, bool>>> instagramFilters; 

    public InstagramDisplay() {
        instagramUsers = new List<InstagramUser>();
        instagramFilters = new List<Expression<Func<InstagramUser, bool>>>();
    }

    public void addFilter(Expression<Func<InstagramUser, bool>> filter) {
        instagramFilters.Add(filter);
    }

    public IEnumerable<InstagramUser> display() {
        return instagramFilters.SelectMany(filter => instagramUsers.Where(filter)).Distinct(); //error on this line
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T20:11:10.473

您必须决定是要执行某些操作还是要返回某些内容。`List<T>.ForEach()`对每个项目执行一个操作，但返回类型为 void，并且不返回任何内容。

这个`IInstagramFilter`界面对我来说似乎是多余的。您可以像这样声明一个过滤器列表

```
var userFilters = new List<Expression<Func<InstagramUser, bool>>>();
userFilters.Add(u => u.Name.StartsWith("A"));
userFilters.Add(u => u.Score >= 100); 
```

如果您有用户来源，您可以对所有过滤器返回的所有用户执行类似操作

```
IQueryable<InstagramUser> usersSource = ...; 
// Or IEnumerable<InstagramUser> for LINQ to objects
// if you drop the Expression<> part.

var users = userFilters.SelectMany(f => usersSource.Where(f)); 
```

`SelectMany`展平嵌套的枚举。该示例返回名称以“A”开头或得分 >= 100 的所有用户。这可能会返回一个用户两次，因此我建议附加一个`.Distinct()`

```
var users = userFilters
    .SelectMany(f => usersSource.Where(f))
    .Distinct(); 
```

# java - 无法将 App Engine 远程 API 与 Android 项目一起使用

> ID：12098679
> 
> 赞同：0
> 
> 时间：2012-08-23T19:26:50.250
> 
> 标签：java, android, google-app-engine

我正在尝试使用[远程 API](https://developers.google.com/appengine/docs/java/tools/remoteapi)连接到我的本地 App Engine 项目。

这是我的来源：

```
 public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        RemoteApiOptions options = new RemoteApiOptions()
        .server("192.168.1.5", 8888)
        .credentials("username", "password");
        RemoteApiInstaller installer = new RemoteApiInstaller();
        try {
            installer.install(options);

            DatastoreService ds = DatastoreServiceFactory.getDatastoreService();

        } catch(Exception e){
            System.err.println(e.toString());
        }finally {
            installer.uninstall();
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

我正在从[App Engine Java SDK](http://googleappengine.googlecode.com/files/appengine-java-sdk-1.7.1.zip)导入 appengine-api.jar、appengine-remote-api.jar 和 appengine-tools-api.jar 。

我在 Eclipse 和 IntelliJ 中都收到以下编译错误：

```
[2012-08-23 15:16:16 - Accident Map] Dx 
UNEXPECTED TOP-LEVEL EXCEPTION:
java.lang.IllegalArgumentException: already added: Lcom/google/appengine/repackaged/com/google/common/base/Absent;
    at com.android.dx.dex.file.ClassDefsSection.add(ClassDefsSection.java:123)
    at com.android.dx.dex.file.DexFile.add(DexFile.java:163)
    at com.android.dx.command.dexer.Main.processClass(Main.java:486)
    at com.android.dx.command.dexer.Main.processFileBytes(Main.java:455)
    at com.android.dx.command.dexer.Main.access$400(Main.java:67)
    at com.android.dx.command.dexer.Main$1.processFileBytes(Main.java:394)
    at com.android.dx.cf.direct.ClassPathOpener.processArchive(ClassPathOpener.java:245)
    at com.android.dx.cf.direct.ClassPathOpener.processOne(ClassPathOpener.java:131)
    at com.android.dx.cf.direct.ClassPathOpener.process(ClassPathOpener.java:109)
    at com.android.dx.command.dexer.Main.processOne(Main.java:418)
    at com.android.dx.command.dexer.Main.processAllFiles(Main.java:329)
    at com.android.dx.command.dexer.Main.run(Main.java:206)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.android.ide.eclipse.adt.internal.build.DexWrapper.run(DexWrapper.java:180)
    at com.android.ide.eclipse.adt.internal.build.BuildHelper.executeDx(BuildHelper.java:703)
    at com.android.ide.eclipse.adt.internal.build.builders.PostCompilerBuilder.build(PostCompilerBuilder.java:577)
    at org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:728)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:199)
    at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:321)
    at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:396)
    at org.eclipse.core.internal.resources.Project$1.run(Project.java:618)
    at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2344)
    at org.eclipse.core.internal.resources.Project.internalBuild(Project.java:597)
    at org.eclipse.core.internal.resources.Project.build(Project.java:124)
    at com.android.ide.eclipse.adt.internal.project.ProjectHelper.doFullIncrementalDebugBuild(ProjectHelper.java:1000)
    at com.android.ide.eclipse.adt.internal.launch.LaunchConfigDelegate.launch(LaunchConfigDelegate.java:147)
    at org.eclipse.debug.internal.core.LaunchConfiguration.launch(LaunchConfiguration.java:855)
    at org.eclipse.debug.internal.core.LaunchConfiguration.launch(LaunchConfiguration.java:704)
    at org.eclipse.debug.internal.ui.DebugUIPlugin.buildAndLaunch(DebugUIPlugin.java:1047)
    at org.eclipse.debug.internal.ui.DebugUIPlugin$8.run(DebugUIPlugin.java:1251)
    at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54) 
```

相同的代码可作为非 Android Java 项目进行，只需进行少量更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:40:07.737

嗯，我不认为你应该将**appengine-tools-api.jar**添加到你的项目中，因为文档没有提到它。您是否尝试删除它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:49:09.043

看起来你的 AE 设置是正确的。我没想到的是 Remote Api 可以在 Android 手机上运行。要通过远程 API 进行连接，请将其作为独立的 java 进程运行。

Android java 只是 Java 的一个子集，因此远程 API 可能会使用 Android 上不可用的东西（尽管这里似乎不是这种情况）所以你真的不是更好地[设置你的 Android 项目来连接到](https://developers.google.com/eclipse/docs/appengine_connected_android) AE它的意图。我的意思是你要做什么，发送你的密码来连接你的 apk 中的 AE 实例？不会有任何访问控制这样做，这肯定不是你想要的，或者我误解了你的目的。

编辑：

为什么不能在安卓上运行？也许可以。我看到的问题是：

1) [Android 白名单](https://developers.google.com/appengine/docs/java/jrewhitelist)可能不包含 Remote API 所需的所有类，即使现在包含，也不能保证将来的版本可以正常工作。

2）您将密码硬编码到您的android应用程序中。这为每个用户提供了执行所有操作的凭据...插入垃圾邮件，如果启用了计费，您将必须支付费用，删除您所有珍贵的数据等等等。好的，所以您的用户必须是恶意的并弄清楚，但是除非您真的可以信任您的用户并且不通过 Play 商店分发您的 apk，否则我认为 apk 被盗版是一个不争的事实，并且真的质疑您为什么要让盗版者访问您的数据存储凭据。我并不是说你不能那样做，只是指出，事实上，也许你不能。

如果您使用 rpc 调用（如上链接），您可以限制客户端能够对数据存储执行的操作。

# c - 为什么我使用 rb_funcall 调用 Hash#has_key 时会出现段错误？

> ID：12098683
> 
> 赞同：1
> 
> 时间：2012-08-23T19:27:21.607
> 
> 标签：c, ruby

我不确定我做错了什么。我有一个 Ruby 哈希值作为该函数的第三个参数传入，`Test::test()`.

```
static VALUE nm_test(VALUE self, VALUE str, VALUE from, VALUE options) {
  if (TYPE(options) != T_HASH) {
    // raises error
  }

  if (rb_funcall(options, rb_intern("has_key?"), 1, rb_intern("dtype")) == Qtrue) { // SEGFAULT
    // success
  }

  // other stuff
}

void Init_test() {
  cTest = rb_define_module("Test");

  rb_define_singleton_method(cTest, "test", nm_test, 3);
} 
```

我听说如果你尝试调用某个对象上不存在的函数，你会得到一个段错误。我还检查了对象是否响应`has_key?`：

```
if (TYPE(options) != T_HASH) {
  rb_raise(rb_eArgError, "third argument to repack must be hash");
} else if (!rb_respond_to(options, rb_intern("has_key?"))) {
  rb_raise(rb_eArgError, "hash does not respond to has_key?!");
} 
```

这不会触发错误。所以它绝对是一个 Hash，而且肯定有`Hash#has_key?`.

这是实际代码（不是上面的代码）的实际回溯。段错误`rb_funcall`在线。

```
Program received signal SIGSEGV, Segmentation fault.
rb_type (obj=44840) at ./include/ruby/ruby.h:1344
1344    ./include/ruby/ruby.h: No such file or directory.
(gdb) bt
#0  rb_type (obj=44840) at ./include/ruby/ruby.h:1344
#1  rb_any_hash (a=44840) at hash.c:83
#2  0x080fc570 in st_lookup (table=0x8fa0470, key=44840, value=0x0) at st.c:341
#3  0x08066ef8 in rb_hash_has_key (hash=144171660, key=44840) at hash.c:1516
#4  0x08157f7d in vm_call0 (th=0x8265b88, recv=144171660, id=5127, argc=1, argv=0xbfffdf60, me=0x82ce480)
    at vm_eval.c:79
#5  0x081587c4 in rb_call (scope=CALL_FCALL, argv=0xbfffdf60, argc=1, mid=5127, recv=144171660) at vm_eval.c:456
#6  rb_funcall (recv=144171660, mid=5127, n=1) at vm_eval.c:658
#7  0xb70933f8 in nm_rbstring_matlab_repack (self=142142600, str=144171680, from=12992526, options=144171660)
    at ../../../../ext/nmatrix/util/io.cpp:210 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:29:06.757

弄清楚了。似乎`rb_intern("whatever!")`返回一个`ID`，而 rb_funcall 需要一个`VALUE`. 所以调用`rb_funcall`应该是这样的：

```
rb_funcall(options, rb_intern("has_key?"), 1, ID2SYM(rb_intern("dtype"))); 
```

这很令人困惑，因为它`:has_key?`是一个 ID，并且工作得很好——但参数本身需要是 type `VALUE`。

# java - 如何在启动画面上加载主屏幕？

> ID：12098685
> 
> 赞同：1
> 
> 时间：2012-08-23T19:27:27.597
> 
> 标签：java, android, xamarin.android, splash-screen

我正在使用 monodroid 开发一个 android 应用程序，无论如何我注意到 monodroid 应用程序需要更长的时间来分层，所以我决定实现一个启动画面。现在我已经使用 monodroid 教程实现了启动画面，但是当我打开应用程序时，它在加载启动画面之前仍然显示黑屏，所以我决定实现一个 java 启动画面，我注意到加载时没有黑屏。

无论如何，我已经实现了 java 启动画面，但问题是现在主要活动在启动画面超时结束后开始，所以启动完成并显示黑屏几秒钟，然后显示主要活动。

在显示初始屏幕时，是否有在后台加载主要活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:41:35.583

使用像异步任务这样的后台线程。

参考链接

[http://eliasbland.wordpress.com/2011/03/11/an-example-of-how-to-run-a-background-task-and-report-progress-in-the-status-bar-using- asynctask-on-android/](http://eliasbland.wordpress.com/2011/03/11/an-example-of-how-to-run-a-background-task-and-report-progress-in-the-status-bar-using-asynctask-on-android/)

# c - 混合 2 种不同的数据类型以防止代码矢量化

> ID：12098687
> 
> 赞同：1
> 
> 时间：2012-08-23T19:27:31.093
> 
> 标签：c, sse, vectorization, icc

我花了数周时间尝试使用英特尔 SSE 内在函数正确地手动矢量化一段代码。但是每次我一直遇到以下消息（打开-vec-report3后）：

**（第 810 行）备注：循环未矢量化：语句无法矢量化。**

我终于发现这是因为我混合了 2 种数据类型 __m128（16 字节）和浮点数（4 字节）（下面代码中的数组**v**是浮点数*）。

这意味着由于左侧和右侧的数据类型不同，因此阻止了矢量化。

但是我不确定如何解决这个问题，因为对于 SSE 矢量化，我必须一次将 4 个浮点数加载到 __m128 变量中。同样，在第 818 行中将 4 个浮点数一起存储时，我也遇到了同样的问题。

```
 #pragma ivdep
    for ( i = 4; i < z - 4; i+=4 )
    {
      it = it2 + i;
      __m128 tmp22 = _mm_loadu_ps(&v[it]);    // Line 810 
      __m128 tmp23 = _mm_mul_ps(tmp22,tmp22);
      __m128 tmp24 = _mm_loadu_ps(&tmp2[i]);
      __m128 tmp25 = _mm_mul_ps(tmp23,tmp24);
      __m128 tmp26 = _mm_loadu_ps(&p2[it]);
      __m128 tmp27 = _mm_add_ps(_mm_mul_ps(tmp25,dt2_i),tmp26);
      __m128 tmp28 = _mm_add_ps(tmp27,tmp26);

      _mm_storeu_ps(&p1[it],_mm_sub_ps(tmp28,_mm_loadu_ps(&p1[it]))); // Line 818
     } 
```

有人可以请我指出正确的方向，以便在解决混合数据类型转换以促进代码矢量化时克服这样的问题。

# c - 检查 char **array 的值

> ID：12098691
> 
> 赞同：0
> 
> 时间：2012-08-23T19:27:34.673
> 
> 标签：c

我得到了一个`char **function`显然返回一个字符数组....问题是我不知道数组中填充了多少个字符串....`char *data[size_of_data];`一开始就设置了，但是该函数可能不需要所有数组字段....

假设我得到了`int size_of_data = 100`，但它只有 15 个字符串....如果我想在第 15 个字符串之后中断，我在 C 中需要哪个条件...我已经在 char ** 字段中获取了数据并尝试了类似的东西。 ...

```
 while(strcmp(data[i],'\0'))
{
    msg_send (session, para[0],data[i]);
    printf("------> %s \n",data[i]);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:34:30.863

在您的 char ** 函数中，您可以在数组末尾放置一个 NULL 指针。所以在这种情况下，在第 15 个字符串之后放置一个 NULL。然后在你的 while 循环中检查 data[i] == NULL，如果它就结束了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:36:00.667

执行此操作的正确方法是让函数将空指针 (0) 放入数据数组中第一个未使用的位置。

这可以通过检查当前指针是否为 0 来简单地测试：

```
for (i = 0; data[i]; i++) {
    puts(data[i]);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:48:38.727

您可以做的一件事是还提供数组的大小作为输出参数。你的函数签名看起来像这样

```
char ** function(size_t * num_strings); //num_strings is an out parameter 
```

然后你做这样的事情

```
size_t nstrings = 0;
char **strings = function(&nstrings);
size_t i = 0;
while (i < nstrings) {
    //do stuff
} 
```

知道大小是有好处的，而不是仅仅迭代直到你碰到一个空指针。假设您准备了一个 100 的数组`char*`。如果你全部使用它们会怎样？没有空指针，你会溢出你的缓冲区。当然，您可以在末尾添加一个额外的指针作为分隔符，但我个人喜欢有大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T19:50:06.030

基本上，您可以做两件常见的事情，或者使用空指针指示*数组结尾*的约定，或者返回`struct`包含附加`size_t`元素数量的 a。第二个版本还有一个变体，它使用了迭代器习语。

### 结束为空：

```
char** fun() {
  /* ... */
  char** array = /*...*/;
  unsigned end = 15;
  array[end] = NULL;
  return array;
} 
```

然后，调用者将在遇到`NULL`.

### 单独的尺寸

```
struct {
  size_t size;
  char** array;
} fun() {
   /* ... */
   char** array = /*...*/;
   unsigned end = 15;
   return {end,array};
} 
```

### 迭代器习语（借自 C++）

```
struct {
  char** begin;
  char** end;
} fun() {
   /* ... */
   char** array = /*...*/;
   unsigned end = 15;
   return {array,array+end};
} 
```

这具有可以在循环中很好地使用的优点：

```
for (struct {char** begin; char** end;} it = fun(); it.begin != it.end; ++it.begin) {
  printf("%s\n",it.begin);
} 
```

您还可以通过减法轻松确定大小`end - begin`。

# css - django：Context.render() 方法不渲染实际的 CSS 样式？

> ID：12098693
> 
> 赞同：0
> 
> 时间：2012-08-23T19:27:36.950
> 
> 标签：css, django, render

我正在使用 django 方法 Context.render() 将我的模板呈现为实际的 html 代码，并将代码存储到一个文件中，以便我可以将其转换为 pdf，并且我有存储所有布局的外部 css 文件。然而，当文件被渲染时，css代码并没有按原样展开，而是保持为“类”和“ids”。有没有一种方法可以渲染实际的 CSS 样式？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:31:05.170

动词“render”可能会令人困惑，但它基本上是将您的输出发送到浏览器。如果你想将你的样式与你的 HTML 结合起来，你需要在那里声明它们，或者编写一些自定义的东西来解析 CSS 并在渲染时内联添加规则。

# python - python-dbg调试时找不到Py_InitModule4

> ID：12098694
> 
> 赞同：3
> 
> 时间：2012-08-23T19:27:38.627
> 
> 标签：python, gdb, python-2.7, ubuntu-12.04

我正在尝试调试我在多线程 qt webkit 应用程序中遇到的段错误。我安装 python-dbg 是为了在 gdb 中给我漂亮的打印，并在启动时收到以下错误

```
python2.7-dbg node.py
Traceback (most recent call last):
  File "node.py", line 4, in <module>
    import msgpack
  File "/usr/lib/pymodules/python2.7/msgpack/__init__.py", line 3, in <module>
    from msgpack._msgpack import *
ImportError: /usr/lib/pymodules/python2.7/msgpack/_msgpack.so: undefined symbol: Py_InitModule4
Error in sys.excepthook:
Traceback (most recent call last):
  File "/usr/lib/python2.7/dist-packages/apport_python_hook.py", line 64, in apport_excepthook
    from apport.fileutils import likely_packaged, get_recent_crashes
  File "/usr/lib/python2.7/dist-packages/apport/__init__.py", line 1, in <module>
    from apport.report import Report
  File "/usr/lib/python2.7/dist-packages/apport/report.py", line 20, in <module>
    import apport.fileutils
  File "/usr/lib/python2.7/dist-packages/apport/fileutils.py", line 22, in <module>
    from apport.packaging_impl import impl as packaging
  File "/usr/lib/python2.7/dist-packages/apport/packaging_impl.py", line 20, in <module>
    import apt
  File "/usr/lib/python2.7/dist-packages/apt/__init__.py", line 21, in <module>
    import apt_pkg
ImportError: /usr/lib/python2.7/dist-packages/apt_pkg.so: undefined symbol: Py_InitModule4

Original exception was:
Traceback (most recent call last):
  File "node.py", line 4, in <module>
    import msgpack
  File "/usr/lib/pymodules/python2.7/msgpack/__init__.py", line 3, in <module>
    from msgpack._msgpack import *
ImportError: /usr/lib/pymodules/python2.7/msgpack/_msgpack.so: undefined symbol: Py_InitModule4 
```

当我运行不使用 msgpack 的脚本版本时，我得到了同样的结果......

```
Traceback (most recent call last):
  File "scraper.py", line 2, in <module>
    from planeswalker import PlaneswalkerParser
  File "/var/www/rails_projects/MCPro.com/lib/planeswalker/planeswalker.py", line 2, in <module>
    from PyQt4.QtCore import *
ImportError: /usr/lib/python2.7/dist-packages/PyQt4/QtCore.so: undefined symbol: Py_InitModule4
Error in sys.excepthook:
Traceback (most recent call last):
  File "/usr/lib/python2.7/dist-packages/apport_python_hook.py", line 64, in apport_excepthook
    from apport.fileutils import likely_packaged, get_recent_crashes
  File "/usr/lib/python2.7/dist-packages/apport/__init__.py", line 1, in <module>
    from apport.report import Report
  File "/usr/lib/python2.7/dist-packages/apport/report.py", line 20, in <module>
    import apport.fileutils
  File "/usr/lib/python2.7/dist-packages/apport/fileutils.py", line 22, in <module>
    from apport.packaging_impl import impl as packaging
  File "/usr/lib/python2.7/dist-packages/apport/packaging_impl.py", line 20, in <module>
    import apt
  File "/usr/lib/python2.7/dist-packages/apt/__init__.py", line 21, in <module>
    import apt_pkg
ImportError: /usr/lib/python2.7/dist-packages/apt_pkg.so: undefined symbol: Py_InitModule4

Original exception was:
Traceback (most recent call last):
  File "scraper.py", line 2, in <module>
    from planeswalker import PlaneswalkerParser
  File "/var/www/rails_projects/MCPro.com/lib/planeswalker/planeswalker.py", line 2, in <module>
    from PyQt4.QtCore import *
ImportError: /usr/lib/python2.7/dist-packages/PyQt4/QtCore.so: undefined symbol: Py_InitModule4 
```

在这两种情况下，它的外观 Py_InitModule4...python 专家有什么想法吗？使用普通 python 2.7 代码运行良好（除了段错误很晚）

如果有一种更简单的方法可以在 gdb 中进行漂亮的打印，我也愿意接受。基本上只是在寻找一个 python 风格的堆栈跟踪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T19:39:40.853

经过一番戳，过去的 ubuntu python-dbg 库中似乎存在与此相关的错误。我在诉讼中提出了一个错误，发现我只是没有阅读文档。需要安装 -dbg 版本的库（本例中为 MySQLdb 和 PyQT4）

没有消息包的版本，所以我发布了另一个关于如何做到这一点的问题

这是标记为无效的错误报告以供参考[https://bugs.launchpad.net/ubuntu/+source/python2.7/+bug/1040914](https://bugs.launchpad.net/ubuntu/+source/python2.7/+bug/1040914)

# oop - 依赖注入/配置对象

> ID：12098695
> 
> 赞同：0
> 
> 时间：2012-08-23T19:27:40.763
> 
> 标签：oop, design-patterns, dependency-injection

我有一个负责将文件导出到 csv 的对象。

它运作良好，但我正在寻找重构它的方法。

这个问题与构造函数有关，它带有许多参数，与如何导出 csv 有关：

例如文件名、分隔符等。

另外，最近我一直在阅读有关依赖注入的内容，但无法确定是否应该这样做：

A. 保持构造函数不变。B. 创建一个新类，该类传递给构造函数，该构造函数简单地保存文件名等的配置值 C. 完全是别的吗？

这是现有的构造函数（在 PHP 中）

```
 public function __construct($file,$overwriteExistingFile, $enclosure, $delim, $headerRow)
    {
        //set all properties here
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:57:55.623

这些值中的每一个都代表作为某个过程输入的数据。`$enclosure`、`$delimiter`和`$headerRow`与生成 CSV 内容有关，而`$file`和`$overwriteExistingFile`与将内容持久化到磁盘有关。

DI 风格重构的一个标志是识别各种职责（生成、持久化）并将它们封装*在*自己的类型中。这将重构从“我如何最好地获取这个类的值*？* ” 到“我如何*从*这个类中删除这些值的知识？”

为了回答这个问题，我们将定义两个新概念，每个概念都有一个职责，并将它们传递给现有的构造函数：

```
public function __construct($csvGenerator, $csvFileWriter)
{
    ...save dependencies...
}

...at some point, generate the CSV content and pass it to the file writer... 
```

通过这种方式，原始类成为生成和文件写入之间交互的协调者，而无需对任何一个活动都有深入的了解。我们将这个类提升到了更高的抽象层次，简化了它，并将它的职责隔离到了它的协作者中。

现在，您将定义两个*新*类，并使用相关参数构造它们：

**发电机**

```
public function __construct($enclosure, $delimiter, $headerRow) 
```

**文件编写器**

```
public function __construct($file, $overwriteExistingFile) 
```

有了这些元素，您可以通过创建生成器，然后是文件编写器，然后将两者传递给协调器来将它们组合在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:31:38.060

我将创建一个`CSVFormatter`您可以设置分隔符并独立对格式进行单元测试的工具。

将格式化程序注入到`CSVWriter`将格式化输出写入文件的 a 中。

您这样做的原因是对格式化逻辑进行单元测试，或者如果您需要进行多种格式化或写入不同类型的输出流。如果代码非常小而且简单，那么您不需要将它分成多个类。

# javascript - 如何在同源选项卡之间建立通信？

> ID：12098698
> 
> 赞同：4
> 
> 时间：2012-08-23T19:27:42.917
> 
> 标签：javascript

同源策略规定，只有当且仅当执行它们的页面位于具有相同协议、端口号和主机的位置时，才允许不同页面上的脚本相互访问。

给定两个在同一来源中*独立打开*的页面，这两个页面是否可以共享脚本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T19:33:06.107

`localStorage`对所有打开的源实例都是通用的，并且`storage`当其中一个实例更改`localStorage`. 通过这种方式，可以识别并向您站点的其他实例发送消息。

# r - 合并两个 xts 对象时出错

> ID：12098700
> 
> 赞同：2
> 
> 时间：2012-08-23T19:28:02.273
> 
> 标签：r, xts

我在网上找不到解决方案。两个 xts 对象在行数和列数上匹配。我仍然收到合并操作的以下错误 - **“要替换的项目数不是替换长度的倍数”。**

以下是 R 代码以及中间步骤的打印输出。我对 R 有点陌生。因此，如果您注意到程序中的任何步骤可以做得更好，那么您也可以就此向我提出建议。谢谢。

```
> # LOAD THE SPY DATA AND CREATE A DATA FRAME WITH RETURN COLUMN
> library(quantmod)
> library(PerformanceAnalytics)
> getSymbols("SPY", src='yahoo', index.class=c("POSIXt","POSIXct"), from='2002-01-01')
> SPY<-to.monthly(SPY)
> SPY.ret<-Return.calculate(SPY$SPY.Close)
> print(head(SPY.ret))
            SPY.Close
Jan 2002           NA
Feb 2002 -0.018098831
Mar 2002  0.029868840
Apr 2002 -0.059915390
May 2002 -0.005951292
Jun 2002 -0.080167070
> index(SPY.ret) = as.Date(index(SPY))  # Convert to Date format as xts index is a Date.
> colnames(SPY.ret) <- "SPY"
> print(head(SPY.ret))
                    SPY
2002-01-01           NA
2002-02-01 -0.018098831
2002-03-01  0.029868840
2002-04-01 -0.059915390
2002-05-01 -0.005951292
2002-06-01 -0.080167070

> #LOAD THE TRADE FILE & CREATE A DATA FRAME WITH PROFIT COLUMN
> trades = as.xts(read.zoo(file="Anvi/CSV/ARS_EW_R2_SPDR.csv", index.column="Exit.time", format="%m/%d/%Y", header=TRUE, sep=","))
Warning message:
In zoo(rval3, ix) :
  some methods for “zoo” objects do not work if the index entries in ‘order.by’ are not unique
> df = trades$Profit
> print(head(df))
           Profit        
2003-09-30 " 0.079734219"
2004-01-31 " 0.116722585"
2004-03-31 " 0.060347888"
2004-04-30 " 0.100379816"
2004-07-31 " 0.084048027"
2004-07-31 " 0.018710103"
> df$Profits = as.numeric(trades$Profit)
> df = df$Profit #Inefficent way to convert Profit column to numeric?
> print(head(df))
               Profit
2003-09-30 0.07973422
2004-01-31 0.11672259
2004-03-31 0.06034789
2004-04-30 0.10037982
2004-07-31 0.08404803
2004-07-31 0.01871010
> df = aggregate(df, by=index(df))
> colnames(df) = "Profit"
> print(head(df))
               Profit
2003-09-30 0.07973422
2004-01-31 0.11672259
2004-03-31 0.06034789
2004-04-30 0.10037982
2004-07-31 0.10275813
2004-11-30 0.02533904
> 
> #MERGE THE SPY RET AND TRADE RESULTS DATA FRAMES
> temp = head(df)
> temp1 = head(SPY.ret)
> print(temp)
               Profit
2003-09-30 0.07973422
2004-01-31 0.11672259
2004-03-31 0.06034789
2004-04-30 0.10037982
2004-07-31 0.10275813
2004-11-30 0.02533904
> print(temp1)
                    SPY
2002-01-01           NA      (Note: I tried replacing NA with 0 but still same error).
2002-02-01 -0.018098831
2002-03-01  0.029868840
2002-04-01 -0.059915390
2002-05-01 -0.005951292
2002-06-01 -0.080167070
> mdf = merge(x=temp, y=temp1, all=TRUE)
Error in z[match0(index(a), indexes), ] <- a[match0(indexes, index(a)),  : 
  number of items to replace is not a multiple of replacement length
> 
```

我在上面尝试做的是合并对象，使得结果对象的索引是一个 UNION 并且有两列“SPY”，“PROFIT”。合并对象中每一列的空单元格用 0 填充。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:07:23.757

`aggregate`返回一个 zoo 对象，而不是 xts 对象。这意味着`merge`正在调度 zoo 方法而不是 xts 方法。如果两个对象都是 xts 对象，则您的代码可以正常工作。

```
temp <- 
  structure(c(0.07973422, 0.11672259, 0.06034789, 0.10037982, 0.10275813, 
  0.02533904), .Dim = c(6L, 1L), index = structure(c(12325, 12448, 
  12508, 12538, 12630, 12752), class = "Date"), class = "zoo",
 .Dimnames = list(NULL, "Profit"))
temp1 <-
  structure(c(NA, -0.018098831, 0.02986884, -0.05991539, -0.005951292, 
  -0.08016707), .Dim = c(6L, 1L), index = structure(c(1009864800, 
  1012543200, 1014962400, 1017640800, 1020229200, 1022907600), tzone = "",
  tclass = "Date"), .indexCLASS = "Date", tclass = "Date", .indexTZ = "",
  tzone = "", .Dimnames = list(NULL, "SPY"), class = c("xts", "zoo"))
merge(temp, temp1)  # error
merge(as.xts(temp), temp1, fill=0)  # works, filled with zeros
#                Profit          SPY
# 2002-01-01 0.00000000           NA
# 2002-02-01 0.00000000 -0.018098831
# 2002-03-01 0.00000000  0.029868840
# 2002-04-01 0.00000000 -0.059915390
# 2002-05-01 0.00000000 -0.005951292
# 2002-06-01 0.00000000 -0.080167070
# 2003-09-30 0.07973422  0.000000000
# 2004-01-31 0.11672259  0.000000000
# 2004-03-31 0.06034789  0.000000000
# 2004-04-30 0.10037982  0.000000000
# 2004-07-31 0.10275813  0.000000000
# 2004-11-30 0.02533904  0.000000000 
```

# bash - Shell 脚本：如何在文件夹中递归查找和替换句子（不是单词）

> ID：12098704
> 
> 赞同：1
> 
> 时间：2012-08-23T19:28:28.703
> 
> 标签：bash, shell

问：考虑一个示例 file.txt：

> 世界你好世界你好地狱你好你好世界

如何查找句子“Hello World”并将其替换为“Hai Universe”

> 世界海宇宙 Hello Hell Hello Hai Universe

我想在文件夹内的所有匹配文件中递归地进行更改。

提前谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T19:31:22.710

尝试`find`使用`sed`：

```
find . -type f -exec sed -i 's|Hello World|Hai Universe|g' {} \; 
```

这将递归地直接在当前文件中查找所有文件，然后`sed`分别对每个文件执行查找+替换。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-11-22T17:16:54.487

你可以尝试这样的事情，`sed`在 Unix 中使用命令。

```
sed -i 's/Hello World/Hai Universe/g' filename 
```

# netbeans-7 - netbeans 从标准输入读取

> ID：12098706
> 
> 赞同：1
> 
> 时间：2012-08-23T19:28:39.457
> 
> 标签：netbeans-7

在 Java 程序中的 NetBeans IDE 7.2 中，我想从标准输入中读取。过去在输出底部有一个文本框

```
Scanner scanner = new Scanner(new BufferedInputStream(System.in));
int i = scanner.nextInt(); 
```

在此先感谢
Yiannis P。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-16T18:26:44.983

右键单击编辑器内的任何位置，然后选择运行文件，然后将输入粘贴到输出框中

# html - 访问表单之间的元素

> ID：12098707
> 
> 赞同：0
> 
> 时间：2012-08-23T19:28:46.517
> 
> 标签：html, ruby-on-rails, ajax, forms

我正在尝试以不同的形式访问元素的值。更具体地说，我有两种表单，一种是提交信息的普通 html 表单，另一种是更新数据库中的字段的 ajax 表单。我希望 ajax 表单以正常形式获取元素的值，但我不知道如何实现。这是我当前的设置：

消息视图

```
<%= form_for @message do |f| %>
    <%= f.text_field :to %>
    <%= f.text_area :body %>
    <%= f.submit "Send Message" %>
<% end %>
<%= form_for :save, :url => save_message_path(), :remote => :true do |f| %>
    <%= f.submit "Save" %>
<% end %> 
```

消息控制器

```
def save
    account.message = params[:body]
end 
```

但是 :body 参数是另一种形式，因此它将 account.message 设置为 nil，因为 ajax 表单没有 body 参数。我想要它，以便 ajax 表单可以提交 body 元素的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:05:33.367

由于表单是在客户端编辑的，因此您必须在 javascript 中编写此功能。

将消息体的值复制到隐藏字段中并提交 Ajax 表单相对简单。这最容易通过在 ajax 表单中添加一个 id 来完成，如下所示：

```
<%= form_for :save, :url => save_messages_path(), :remote => true, :id => 'ajaxform' %>
  <%= hidden_field_tag 'hidden_message' %> 
```

然后在javascript中，您可以执行以下操作：

```
$(document).ready(function(){
  $("#ajaxform").submit(function() {
    $("#hidden_message").val($("#message_body").val());
    return true;
  });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:03:55.243

`body`您可以在您的 ajax 表单中添加一个隐藏字段，并在发送 ajax 请求之前使用一个`onsubmit`事件使用普通表单中的字段值填充它。`body`它或多或少看起来像这样：

```
<%= form_for @message do |f| %>
    <%= f.text_field :to %>
    <%= f.text_area :body, :class => 'main_body_field' %>
    <%= f.submit "Send Message" %>
<% end %>
<%= form_for :save, :url => save_message_path(), :remote => :true, :id => 'ajax_form' %>
    <%= f.hidden_field :body, :class => 'hidden_body_field' %>
    <%= f.submit "Save" %>
<% end %> 
```

javascript（使用 jQuery）：

```
$(function() {
    $("ajax_form").submit(function() {
      // copy body value from first form to the second one
      $('.hidden_body_field').val($('.main_body_field').val());
      return true;
    }
} 
```

# python - 在 python 中不关闭的情况下编写

> ID：12098710
> 
> 赞同：-1
> 
> 时间：2012-08-23T19:28:53.770
> 
> 标签：python, text, io, python-2.7, overwrite

我想在不关闭的情况下写入文本文件，因为我不知道我会停止关闭什么，我将解释漏洞问题

我已经创建了名为 的文本`resume.txt`，所以在我的项目中的每个特定进程之后它都会覆盖，`resume.txt`所以每次我的项目启动时它都会检查该文件以了解最后的进程，所以每次写入后我的问题我必须关闭才能应用它，我真的不认为这很好我认为有更好的解决方案

此代码不起作用

```
wr = open('resume.txt','w')
login(usr,pas)
wr.write('login')
post(msg,con)
wr.write('post')
..so on 
```

问题是如何在不关闭的情况下编写，我不能`wr.close`在最后写，因为它可能被用户终止或连接超时..等

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T19:33:26.143

不确定这是否适用于您的代码，但是包装在一个`with`块中呢？

```
with open('resume.txt','w') as wr:
    login(usr,pas)
    wr.write('login')
    # This is hacky, but it will go to the beginning 
    # of the file and then erase (truncate) it
    wr.seek(0)
    # I think you wanted to do this after you tried an action, 
    # but you can move it to wherever you want
    post(msg,con)
    wr.truncate()
    wr.write('post') 
```

这将确保文件在错误时关闭。当您想关闭文件时，只需在与以下相同的级别启动下一个代码`with`：

```
with open('resume.txt','w') as wr:
    login(usr,pas)
    wr.write('login')
    wr.seek(0)
    post(msg,con)
    wr.truncate()
    wr.write('post')
    # wr.seek(0) ...

# Next steps... 
```

我还建议检查[日志](http://docs.python.org/library/logging.html)模块，看看它是否可以完成你想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T21:58:28.667

首先我要感谢 tMC

解决方案是

```
wr = open('resume.txt','w')
login(usr,pas)
wr.write('login')
wr.flush()
post(msg,con)
wr.seek(0)
wr.write('post')
wr.flush() 
```

我曾经`flush()`写作和申请以及`seek(0)`覆盖

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-23T19:32:05.423

试试[with 语句](http://effbot.org/zone/python-with-statement.htm)。理解起来有点复杂，但应该这样做。

# node.js - 上传进度——请求

> ID：12098713
> 
> 赞同：15
> 
> 时间：2012-08-23T19:29:05.780
> 
> 标签：node.js, coffeescript

我正在使用[`Request`](https://github.com/mikeal/request).

```
req = request.post url: "http://foo.com", body: fileAsBuffer, (err, res, body) ->
    console.log "Uploaded!" 
```

我如何知道实际上传了多少数据？是否有一些我可以订阅的事件，或者是否有`request`我可以投票的属性？

如果没有，上传数据并知道上传了多少数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2016-09-14T13:49:59.893

我花了几个小时寻找任何有效的来源[`request`](https://nodei.co/npm/request/)和`node`来源，最后找到了一种不同的方法，这对我来说感觉更正确。

我们可以依赖[`drain`](https://nodejs.org/api/stream.html#stream_event_drain)事件和[`bytesWritten`](https://nodejs.org/api/net.html#net_socket_byteswritten)属性：

```
request.put({
  url: 'https://example.org/api/upload',
  body: fs.createReadStream(path)
}).on('drain', () => {
  console.log(req.req.connection.bytesWritten);
}); 
```

或者，如果您需要处理文件字节的进度，使用流[`data`](https://nodejs.org/api/stream.html#stream_event_data)事件更容易：

```
let size = fs.lstatSync(path).size;
let bytes = 0;

request.put({
  url: 'https://example.org/api/upload',
  body: fs.createReadStream(path).on('data', (chunk) => {
    console.log(bytes += chunk.length, size);
  })
}); 
```

流缓冲区大小为`65536`字节，读/漏过程迭代运行。

这对我来说似乎很好用`node v4.5.0`and `request v2.74.0`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-08-20T20:34:37.037

我需要处理我的另一个项目的上传进度。

我发现您可以轮询`request`'`connection._bytesDispatched`属性。

例如：

```
r = request.post url: "http://foo.com", body: fileAsBuffer
setInterval (-> console.log "Uploaded: #{r.req.connection._bytesDispatched}"), 250 
```

**注意**：如果您正在管道到`r`，请改为轮询`r.req.connection.socket._bytesDispatched`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-03-07T13:24:14.997

```
var request = require('request');
    var fs = require('fs');  
    let path ="C:/path/to/file";
    var formData = {
        vyapardb: fs.createReadStream(path)
    };

    let size = fs.lstatSync(path).size;

    var headers = {
        'Accept' : 'application/json',
        'Authorization' : 'Bearer '+token,
    };

    var r = request.post({url:'http://35.12.13/file/upload', formData: formData,  headers: headers}, function optionalCallback(err, httpResponse, body) {
        clearInterval(q);

    });
    var q = setInterval(function () {
        var dispatched = r.req.connection._bytesDispatched;
        let percent = dispatched*100/size;
         console.dir("Uploaded: " + percent + "%");

    }, 250);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-25T03:43:17.803

我知道这很旧，但我刚刚发现了一个没有被提及的库“progress-stream”并且做得很好。[https://www.npmjs.com/package/progress-stream](https://www.npmjs.com/package/progress-stream)

```
const streamProg = require('progress-stream');
const fs = require('fs');
const request = require('request');

const myFile = 'path/to/file.txt';
const fileSize = fs.statSync('path/to/file.txt').size;
const readStream = fs.createReadStream(myFile);
const progress = streamProg({time: 1000, length: fileSize})
    .on('progress', state => console.log(state));

readStream.pipe(progress).pipe(request.put({url: 'SOMEURL/file.txt'})); 
```

同样，它也可以在下载的管道之间使用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-24T13:18:23.277

有人创建了一个很好的模块来完成此任务，该模块已在[transloadit](http://transloadit.com/)的生产堆栈中运行（因此它可靠且维护良好）。你可以在这里找到它：

[https://github.com/felixge/node-formidable](https://github.com/felixge/node-formidable)

代码应如下所示：

```
var formidable = require('formidable'),
    http = require('http'),

    util = require('util');

http.createServer(function(req, res) {
  if (req.url == '/upload' && req.method.toLowerCase() == 'post') {
    // parse a file upload
    var form = new formidable.IncomingForm();
    form.parse(req, function(err, fields, files) {
      res.writeHead(200, {'content-type': 'text/plain'});
      res.write('received upload:\n\n');
      res.end(util.inspect({fields: fields, files: files}));
    });
    return;
  }

  // show a file upload form
  res.writeHead(200, {'content-type': 'text/html'});
  res.end(
    '<form action="/upload" enctype="multipart/form-data" method="post">'+
    '<input type="text" name="title"><br>'+
    '<input type="file" name="upload" multiple="multiple"><br>'+
    '<input type="submit" value="Upload">'+
    '</form>'
  );
}).listen(80); 
```

然后，您可以使用[Socket.io将状态推送到客户端](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&frm=1&source=web&cd=1&cad=rja&ved=0CCAQFjAA&url=http://socket.io/&ei=Ln43UOTvPI_g6wG90YD4BQ&usg=AFQjCNG8kzehIcRMCwXVQUB46eWDrmNbdA&sig2=JggUfYS92gmWyNN8rZLm7g)

有趣的注释：这是导致 Node 创建的问题之一。在[这段视频](http://www.youtube.com/watch?v=SAc0vQCC6UQ)中，Ryan 谈到了 node 如何开始尝试寻找实时通知用户关于通过网络上传文件的状态的最佳方式......无论如何我离题了，但如果你是的话，这个视频值得一看对 Node 的历史感兴趣

# objective-c - NSArray 作为类中的私有数据？

> ID：12098724
> 
> 赞同：2
> 
> 时间：2012-08-23T19:29:44.427
> 
> 标签：objective-c, class, object, nsarray

我最近开始学习Objective-C。我决定创建一个名为“Student”的类，其属性包括年龄、姓名，重要的是，还有类。我把这些类放在一个充满 NSString 的 NSArray 中。我的问题是，如果我将它定义为 @property，它会自动为其创建一个 setter 和 getter 方法。我不想在我的课上这样。如何在类中将 NSArray 定义为私有数据，而不允许使用 setter 和 getter？

这是标题代码：

```
#import <Foundation/Foundation.h>

@interface Student : NSObject

@property NSString * Name;
@property unsigned short age;
@property BOOL isFullTime;
@property NSMutableArray * Classes;

@end 
```

[NSGreeterThanksGuys];

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T19:35:59.233

你有几个流行的选择。当然，您可以根据需要替换类型：

**A：**

将其放在标题中，并指定`@private`访问权限。

```
// Student.h
@interface Student : NSObject
{
@private // << note: protected is the default when declared in this scope.
   NSArray * ivar;
}
@end 
```

**乙：**

将它放在@implementation 块中。您可以指定访问权限，但这通常不是问题，因为它对任何其他翻译都不可见。

```
// Student.m
@implementation Student
{
@private // << note: private is the default when declared in this scope.
   NSArray * ivar;
}
@end 
```

**C：**

在类延续中声明它：

```
// Student.m
@interface Student ()
{
  NSArray * ivar;
}

@end 
```

**丁：**

在类延续中声明为属性：

```
// Student.m
@interface Student ()

@property (nonatomic, copy) NSArray * ivar;

@end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:34:57.110

```
@interface Student : NSObject {

    @private
    NSMutableArray * Classes;

}

@property NSString * Name;
@property unsigned short age;
@property BOOL isFullTime;

@end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:36:20.247

使用关键字@private

```
@interface Student : NSObject
{
    @private
    NSMutableArray * Classes;
}

@property NSString * Name;
@property unsigned short age;
@property BOOL isFullTime;

@end 
```

# c# - ThreadPool 可用线程显示非常高的数字

> ID：12098727
> 
> 赞同：2
> 
> 时间：2012-08-23T19:30:02.493
> 
> 标签：c#, threadpool

我们有一种情况，我们使用 ThreadPool.QueueUserWorkItem() API 从作业队列中的项目循环中生成多个线程来执行一些文件复制操作。作业队列包含大约 50 个项目（用于测试目的）。

我们期望最大没有。当系统无法腾出尽可能多的线程（使用更高的工作负载）时，会产生 50 个线程进行处理，甚至更少。但是当我们打印编号时。使用 ThreadPool.GetAvailableThreads(out _iWorkerThreads, out _ioThreads) 池中的可用线程，我们得到一个常量 1023（对于工作线程的作业大小 50）并且没有 I/O 线程的数据。

不知道为什么会产生这么多线程。ThreadPool.GetAvailableThreads 的输出可靠吗？设置线程池中的最大线程数会有所帮助吗？什么是评估平均数的可靠方法。池中的进程正在使用的托管线程数？

谁能指出我为什么在应用程序运行时 CPU 利用率会飙升到几乎 100%。该代码使用附加到每个作业的 WaitHandles，通常是 ManualResetEvents，用于向主线程发出作业完成的信号。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T19:38:21.667

这不是产生的线程数。这是在达到最大值之前可以产生的额外线程数。

MSDN：[ThreadPool.GetAvailableThreads 方法](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.getavailablethreads.aspx)

GetMaxThreads 减去 GetAvailableThreads 可能是您要查找的数字。

不做任何事情：

```
class Program
{
    static void Main(string[] args) {
        int workerThreads, completionPortThreads;
        ThreadPool.GetAvailableThreads(out workerThreads, out completionPortThreads);
        Console.WriteLine(workerThreads);
        Console.WriteLine(completionPortThreads);
        Console.ReadLine();
    }
} 
```

输出是：

```
1023
1000 
```

如果您确保在知道某些线程仍在工作时调用 ThreadPool.GetAvailableThreads，则该数字应该更低。

例子：

```
 static void Main(string[] args) {
        int workerThreads, completionPortThreads;
        ThreadPool.GetAvailableThreads(out workerThreads, out completionPortThreads);
        Console.WriteLine(workerThreads);
        Console.WriteLine(completionPortThreads);

        Console.WriteLine();
        ThreadPool.QueueUserWorkItem(o => Thread.Sleep(10000));

        ThreadPool.GetAvailableThreads(out workerThreads, out completionPortThreads);
        Console.WriteLine(workerThreads);
        Console.WriteLine(completionPortThreads);

        Console.ReadLine();
    } 
```

输出是：

```
1023
1000

1022
1000 
```

# java - 是否可以从两个不同的 Servlet 同时访问同一个数据库？

> ID：12098729
> 
> 赞同：0
> 
> 时间：2012-08-23T19:30:10.407
> 
> 标签：java, database, web-applications, servlets, concurrency

我正在开发一个基于数据库的 Web 应用程序。在我的应用程序中，我从两个不同的 Servlet 访问这个，并且这些访问可能是同时进行的。

我需要知道是否允许，如果不允许，我该怎么做？是否有一些技巧可以以线程安全的方式执行查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:36:00.987

数据库的主要设计要求之一是并发访问。事实是，您很可能已经在您的任何**一个**servlet 中执行此操作，因为它们可以并行处理多个请求，使用多个数据库连接。使用来自一个应用程序的两个连接（几乎）与使用来自两个应用程序的两个连接完全相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:32:44.907

可能以及如何处理将是基于数据库设置（隔离级别设置）的数据库责任。

以下是[SQL Server](http://msdn.microsoft.com/en-us/library/ms189122%28v=sql.105%29.aspx)中的隔离级别，这些级别可能因数据库而异。

```
1.Read uncommitted (the lowest level where transactions are isolated only enough to ensure that physically corrupt data is not read)

2.Read committed (Database Engine default level)

3.Repeatable read

4.Serializable (the highest level, where transactions are completely isolated from one another) 
```

# python - IE9 和 Python 问题？

> ID：12098732
> 
> 赞同：0
> 
> 时间：2012-08-23T19:30:20.500
> 
> 标签：python, windows, debugging, internet-explorer-9, pipeline

尝试在 IE9 中调试网站。我通过 Python 运行它。

在 chrome、safari、firefox 和 opera 中，站点会立即加载，但在 IE9 中，它似乎挂起并且从未真正加载。

这可能是http管道的问题吗？或者是其他东西？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:48:41.437

您需要指定您正在使用的 Python “Web 服务器”（例如，bottle？也许是 Tornado？CherryPy？），但更重要的是，当涉及 IE9 时，您需要提供哪些请求标头以及哪些 HTTP 响应进出。

您可以使用例如 ngrep 将它们从电线上取下，或者我认为您可以使用 IE9 中的开发人员工具（F12 键）。

IE9 最常见且通常不会打扰 Web 浏览器的怪癖是 Content-Length 不匹配（好吧，我上次查看时，这个 DID 困扰了 Safari），可能是 Content-Type（这反过来 - IE9 有时会正确收集 HTML mimetype，即使Content-Type 错误），连接：关闭。

所以是的，这可能是 HTTP 流水线的问题：特别是如果您使用无效的 Content-Length 甚至没有分块传输编码的请求，IE 可能会等待请求“完成”。这也会发生在 Web 浏览器中；但在 IE 中，这种行为可能会覆盖正在刷新和关闭的连接，而在 Web 浏览器中则不会。这两个假设可能与您观察到的症状相符。

要解决这个问题，您要么切换到分块传输编码，它以某种方式替换 Content-Length，要么正确计算其值。如何执行此操作取决于服务器。

为了快速验证，您可以发出一个内容长度肯定太短（例如 100 字节？）来查看这是否会导致 IE 取消挂起并显示部分网页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:02:19.147

使用[数据包嗅探器](http://en.wikipedia.org/wiki/Comparison_of_packet_analyzers)拦截和记录服务器与 IE 之间以及服务器与另一个浏览器之间的数据包。检查它们并比较它们，看看会发生什么。

# hadoop - Hadoop：在写入后修改输出文件

> ID：12098733
> 
> 赞同：0
> 
> 时间：2012-08-23T19:30:21.587
> 
> 标签：hadoop, hadoop-streaming

摘要：我可以在每个输出文件使用hadoop流编写后指定一些要执行的操作吗？

基本上，这是对 hadoop mapreduce问题[的最简单有效的压缩输出方法的](https://stackoverflow.com/questions/11988214/easiest-efficient-way-to-zip-output-of-hadoop-mapreduce/)后续。我希望将每个键`X`的值写入`X.txt`文件，压缩到`X.zip`存档中。但是当我们编写 zip 输出流时，很难说出结果文件的键或名称，所以我们最终得到`X.zip`包含`default-name.txt`.

重命名存档内容是非常简单的操作，但我可以将它放在哪里？我不想做的是从 S3 下载所有 zip，然后再上传它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T08:44:47.427

考虑使用自定义[MultipleOutputFormat](http://hadoop.apache.org/common/docs/current/api/org/apache/hadoop/mapred/lib/MultipleOutputFormat.html)：
**基本用例：**

*   此类用于具有至少一个 reducer 的 map reduce 作业。reducer 想要根据实际的键将数据写入不同的文件。假设键（或值）对实际键（值）和实际键（值）的所需位置进行编码。

*   此类仅用于地图作业。该作业希望使用一个输出文件名，该文件名要么是输入数据的输入文件名的一部分，要么是它的一些派生。

*   此类仅用于地图作业。该作业希望使用取决于键和输入文件名的输出文件名

您还可以控制哪个键进入哪个减速器（[分区](http://hadoop.apache.org/common/docs/current/api/org/apache/hadoop/mapred/lib/MultipleOutputFormat.html)器）

# entity-framework-4.1 - 在 T4 中检索列映射信息

> ID：12098739
> 
> 赞同：3
> 
> 时间：2012-08-23T19:30:55.723
> 
> 标签：entity-framework-4.1, mapping, t4

我正在研究一个基于实体模型生成 .cs 类的 T4 文件，而我想要做的事情之一是模型中的映射信息。具体来说，对于模型中的每个字段，我正在尝试检索它映射到的数据库字段名称。

我发现映射信息显然存储在 StorageMappingItemCollection 中，但是我很难弄清楚如何查询它并检索我需要的数据。有没有人参加过这门课，也许可以提供指导？

到目前为止，我的代码是这样的（我已将所有内容粘贴到有问题的行）：

```
 <# 
        System.Diagnostics.Debugger.Launch(); 
        System.Diagnostics.Debugger.Break();
    #>

    <#@ template language="C#" debug="true" hostspecific="true"#>
    <#@ include file="EF.Utility.CS.ttinclude"#>
    <#@ output extension=".cs"#><#

    CodeGenerationTools code = new CodeGenerationTools(this);
    MetadataLoader loader = new MetadataLoader(this);
    CodeRegion region = new CodeRegion(this, 1);
    MetadataTools ef = new MetadataTools(this);

    string inputFile = @"MyModel.edmx";
    EdmItemCollection ItemCollection = loader.CreateEdmItemCollection(inputFile);
    StoreItemCollection storeItemCollection = null;
    loader.TryCreateStoreItemCollection(inputFile, out storeItemCollection);
    StorageMappingItemCollection storageMappingItemCollection = null;
    loader.TryCreateStorageMappingItemCollection(
inputFile, ItemCollection, storeItemCollection, out storageMappingItemCollection);

    var item = storageMappingItemCollection.First(); 
```

storageMappingItemCollection 有 GetItem() 之类的方法，但我一辈子都不能让它返回我知道模型中存在的字段的数据。

提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:43:54.780

使用 Linq to XML 解析 MSL 并不难

```
string mslManifestResourceName = GetMslName(ConfigurationManager.ConnectionStrings["Your Connection String"].ConnectionString);
var stream = Assembly.GetExecutingAssembly().GetManifestResourceStream(mslManifestResourceName);
XmlReader xreader = new XmlTextReader(stream);
XDocument doc = XDocument.Load(xreader);
XNamespace xmlns = "http://schemas.microsoft.com/ado/2009/11/mapping/cs";

var items = from entitySetMap in doc.Descendants(xmlns + "EntitySetMapping")
            let entityTypeMap = entitySetMap.Element(xmlns + "EntityTypeMapping")
            let mappingFragment = entityTypeMap.Element(xmlns + "MappingFragment")
            select new
            {
                EntitySet = entitySetMap.Attribute("Name").Value,
                TypeName = entityTypeMap.Attribute("TypeName").Value,
                TableName = mappingFragment.Attribute("StoreEntitySet").Value
            }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T08:09:24.250

将 EDMX 文件解析为 XML 可能比使用 StorageMappingItemCollection 更容易。

# c# - 属性支持值范围

> ID：12098745
> 
> 赞同：18
> 
> 时间：2012-08-23T19:31:18.003
> 
> 标签：c#, properties

这样的事情可能吗？我假设不是，但对我来说*看起来不错*：

```
class MyClass {
    public int Foo {
        get { return m_foo; }
        set {
            // Bounds checking, or other things that prevent the use
            // of an auto-implemented property
            m_foo = value;
        }

        // Put the backing field actually *in* the scope of the property
        // so that the rest of the class cannot access it.
        private int m_foo;
    }

    void Method() {
        m_foo = 42;    // Can't touch this!
    }
} 
```

当然我知道这个语法是不正确的，这不会编译。为了清楚地描绘我的想法，它是假设的未来 C#。对于这个有点假设的问题，我深表歉意，但它对 Programmers.SE 来说太具体了。

可以在编译器中实现这样的事情，它有一个目的：只允许属性`get`和`set`访问器查看字段，本质上允许属性是自包含的（就像自动实现的属性一样），同时允许额外的获取/设置逻辑.

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-25T16:16:10.813

简短的回答是否定的，这在今天的 C# 中是不可能的。

我们经常收到这样的功能请求；这是一个更一般形式的好功能。更一般的形式是更清楚地使*局部*变量的*生命周期*与其*范围*正交。

 **只是为了确保这些术语清楚：*变量*是一个存储位置，可能命名。每个变量都有一个*生命周期*：在运行时保证变量引用有效存储的时间量。名称的*范围*是可以使用该名称的文本区域*；*它是一个编译时概念，而不是运行时概念。*局部*变量是*作用域*为*语句块*的变量。

在许多语言中，局部变量的生命周期与其范围密切相关：当控制在运行时逻辑地进入范围时，生命周期开始，当它离开范围时，生命周期结束。这在 C# 中是正确的，但有一些值得注意的警告：

*   *如果运行时可以确定这样做对当前线程上托管代码*的操作没有影响，则可以延长或截断本地的生命周期。其他线程（如终结器线程）和当前线程上的非托管代码的操作是实现定义的。

*   迭代器块、异步方法或匿名函数的封闭外部变量中的局部变量的生命周期可以扩展为匹配或超过使用它的迭代器、任务、委托或表达式树的生命周期.

显然，不需要*以*任何方式将本地的生命周期和范围捆绑在一起。如果我们可以显式地让局部变量具有实例或静态字段的生命周期，但具有局部变量的范围，那就太好了。C有这个特点；您可以制作一个“静态”局部变量。C# 没有。您的建议本质上是允许在具有实例生命周期但其范围仅限于块的属性块内使用局部变量。

我会将此功能归类为“不错”。我们有一个潜在的“好”功能列表，只要您的手臂，我们没有时间实施，所以我不希望这个功能很快成为列表的顶部。感谢您的反馈；它有助于我们在一定程度上优先考虑该列表。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T20:19:46.513

这是我的看法：

```
public class WrappedField<T>
{
    public class Internals
    {
        public T Value;
    }

    private readonly Internals _internals = new Internals();
    private readonly Func<Internals, T> _get;
    private readonly Action<Internals, T> _set;

    public T Value
    {
        get { return _get(_internals); }
        set { _set(_internals, value); }
    }

    public WrappedField(Func<Internals, T> get, Action<Internals, T> set)
    {
        _get = get;
        _set = set;            
    }

    public WrappedField(Func<Internals, T> get, Action<Internals, T> set, T initialValue)
        : this(get, set)
    {
        _set(_internals, initialValue);
    }
} 
```

用法：

```
class Program
{
    readonly WrappedField<int> _weight = new WrappedField<int>(
        i => i.Value,           // get
        (i, v) => i.Value = v,  // set
        11);                    // initialValue

    static void Main(string[] args)
    {
        Program p = new Program();
        p._weight.Value = 10;

        Console.WriteLine(p._weight.Value);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T19:54:21.393

根据 C# 4.0 语言规范。

> 但是，与字段不同，属性**不表示存储位置**。相反，属性具有指定在读取或写入其值时要执行的语句的访问器。

添加一个字段将需要一个内存位置。所以不，这是不可能的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-23T20:39:53.017

如果你想避免泛型，你总是可以隐藏`_backingField`私有内部类中的和边界检查。您甚至可以通过使外部类部分化来进一步隐藏它。当然，外部类和内部类之间必须进行一些委派，这很糟糕。代码来解释我的想法：

```
public partial class MyClass
{
    public int Property
    {
        get { return _properties.Property; }
        set { _properties.Property = value; }
    }

    public void Stuff()
    {
        // Can't get to _backingField...
    }
}

public partial class MyClass
{
    private readonly Properties _properties = new Properties();

    private class Properties
    {
        private int _backingField;

        public int Property
        {
            get { return _backingField; }
            set
            {
                // perform checks
                _backingField = value;
            }
        }
    }
} 
```

但这是很多代码。为了证明所有这些样板的合理性，最初的问题必须非常严重......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T19:33:30.037

不，唯一可以在属性主体内的是`get`and `set`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-23T20:11:35.137

好吧，它很难处理，可能不是很高效，也不是我真正会使用的东西，但从技术上讲，它是一种将支持领域与班级其他人隔开的方式。

```
public class MySuperAwesomeProperty<T>
{
    private T backingField;
    private Func<T, T> getter;
    private Func<T, T> setter;
    public MySuperAwesomeProperty(Func<T, T> getter, Func<T, T> setter)
    {
        this.getter = getter;
        this.setter = setter;
    }

    public T Value
    {
        get
        {
            return getter(backingField);
        }
        set
        {
            backingField = setter(value);
        }
    }
}

public class Foo
{
    public MySuperAwesomeProperty<int> Bar { get; private set; }

    public Foo()
    {
        Bar = new MySuperAwesomeProperty<int>(
            value => value, value => { doStuff(); return value; });

        Bar.Value = 5;

        Console.WriteLine(Bar.Value);
    }

    private void doStuff()
    {
        throw new NotImplementedException();
    }
} 
```**

# javascript - 在后台页面之间播放网站上的音频文件

> ID：12098750
> 
> 赞同：0
> 
> 时间：2012-08-23T19:31:38.097
> 
> 标签：javascript, html, flash, audio

嗨，是否可以在网站上播放背景音乐，并在多个页面之间播放或重新加载？

是否可以不在后台打开弹出窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:41:26.020

不是我在不同页面*之间知道的；*但是您可以首先让您的网站动态化，因为页面保持不变，但内容通过 JavaScript 发生变化。

就像是

```
<html>
<head>
<title>blah</title>

</head>

<body>
<a href="#" onclick="changecontent(1)">page1</a>
<a href="#" onclick="changecontent(2)">page2</a>
<a href="#" onclick="changecontent(3)">page3</a>

<div id="content"></div>

<!-- HTML code to play the audio file -->

<script type="text/javascript">
function changecontent(page)
{
 if (page == 1) {document.getElementById('content').innerHTML = 'page 1 stuff';}
if (page == 2) {document.getElementById('content').innerHTML = 'page 2 stuff';}
if (page == 3) {document.getElementById('content').innerHTML = 'page 3 stuff';}
}
</script>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:34:16.310

如果您的页面是由 AJAX 加载的，那么很有可能，或者如果站点位于框架中且音频位于框架之外，那么这也可以。除此之外，当页面更改时，无法继续播放音频。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:33:56.247

不，不是没有弹出窗口或使用框架。

# android - 可以通过浏览器访问哪些原生移动设备功能？

> ID：12098762
> 
> 赞同：2
> 
> 时间：2012-08-23T19:32:59.920
> 
> 标签：android, windows-phone-7, mobile, mobile-safari, mobile-website

我正在创建一个图表，其中列出了 iOS、Android 和 Windows 手机的本机功能，以及是否可以通过手机的移动浏览器访问这些功能。我只查看每个操作系统的最新版本。

任何人都可以确认或输入我到目前为止发现的准确度吗？我特别不确定 Windows 手机。

![设备能力图表](../Images/b41031c6c91fc755c84089feeba313d4.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:51:20.333

哇，这是一个非常有用的图表。很高兴你想到了！

我注意到的 iOS 事物

*   您可以使用锚标记上的 sms:// 协议处理程序为短信生成消息应用程序
*   ios浏览器具有完整的多点触控！
*   '快速图形 api' 含糊不清......但你的画布很迟钝。webgl 来啦！
*   “流体动画”可以通过 CSS 转换来实现
*   ios支持输入类型日期、日期时间、月份、时间、范围
*   推送通知是不可行的，但警报是
*   “与其他应用程序交互”也可以使用协议处理程序

安卓

*   作为 w/ ios，您可以使用 sms:// 协议生成短信应用程序
*   android系统浏览器多点触控；但它有一个只显示一次触摸的错误。chrome有适当的多点触控..
*   图形和动画根据 ios 是可行的
*   与应用程序交互也可能与协议处理程序（和意图）

视窗电话

*   准确，但是当 Windows Phone 8 出货时，这将在今年秋天改变

嘿，黑莓呢！

# c# - 为所有可能的增量表达式创建相同的标记

> ID：12098770
> 
> 赞同：2
> 
> 时间：2012-08-23T19:33:34.030
> 
> 标签：c#, antlr, grammar, antlr3

我正在为 C/C++ 源代码开发词法分析器语法。语法的目标是打击大学学生之间的剽窃。

为了提高语法的有效性，我希望 ANTLR 为学生可以增加变量的 4（？）不同方式创建相同的标记：

```
i++
++i
i += 1
(i = i + 1) [I doubt that this can be solved with ANTLR] 
```

这些表达式中的每一个都应导致令牌 INCREMENT。

到目前为止我想出的：（这里只复制了语法的必要部分）

```
options {
    language = CSharp3;
    filter = true;
    k = 2;
}

INCREMENT : IDENTIFIER (PLUSPLUS | ADDEQUAL '1') | PLUSPLUS IDENTIFIER ;
IDENTIFIER 
    :   LETTER (LETTER | DIGIT)*;

/*
 * covers both decimal and hex integer literals
 */
INTEGER_LITERAL : 
   DIGIT+ | '0x' HEX_DIGIT+;

ADDEQUAL            : '+=';
PLUSPLUS            : '++';

fragment
LETTER  :   'A'..'Z' | 'a'..'z';

fragment
HEX_DIGIT : DIGIT | 'a'..'f' | 'A'..'F';

fragment
DIGIT : '0'..'9'; 
```

测试此语法以`i += 1`获取令牌序列中的结果，`IDENTIFIER ADDEQUAL INTEGER_LITERAL`而不是`INCREMENT`.

这是为什么？据我了解，规则的优先级是从上到下加上`INCREMENT`“更大”的规则。

我需要对语法进行哪些调整才能获得预期的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:36:45.863

> 测试此语法以`i += 1`获取令牌序列中的结果，`IDENTIFIER ADDEQUAL INTEGER_LITERAL`而不是`INCREMENT`.
> 
> 这是为什么？

因为`"i += 1"`包含您在规则中未考虑的空格`INCREMENT`。

> 我需要对语法进行哪些调整才能获得预期的结果？

考虑空格（可能还有换行符）。

然而，单独创建一个词法分析器似乎不是这里的方法。你真的需要一个解析器，IMO。并且选项`k = 2;`集会提前查看解析器规则，而不是词法分析器规则：因此，如果您只坚持词法分析，您最好将其删除。

# perl - 使用 perl 就地删除文件中已找到的行块

> ID：12098771
> 
> 赞同：1
> 
> 时间：2012-08-23T19:33:38.033
> 
> 标签：perl

我希望能够在由 start 和 end 关键字确定的文件中找到一行行，然后删除该块。我正在使用“if (/START/../END/)”来定位此块，但不确定如何删除此块中的行。我可以在上面的“if”中使用什么语句来实现这一点？

注意：它不一定是真正的删除。我的意思是，它可以简单地用空白替换行。

PS：我是第一次使用 perl，如果这似乎是一个愚蠢的问题，请原谅我。我知道那里有很多类似的问题，但似乎没有人处理就地删除并建议选项，例如将整个文件打印到另一个文件，不包括所需的块。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T19:40:45.317

Perl 使这很容易。

一行，就地删除 和 之间的`pattern1`行`pattern2`：

```
perl -i -ne 'print unless /pattern1/../pattern2/' input_file 
```

查看[`perlrun`](http://search.cpan.org/perldoc?perlrun)了解 perl 的各种命令行开关

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:39:24.633

你可以颠倒你的逻辑：

```
use warnings;
use strict;

while (<DATA>) {
    print unless /START/ .. /END/;
}

=for output

foo
bar

=cut

__DATA__
foo
START
goo
END
bar 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:41:25.253

使用 sed：

```
sed '/START/,/END/d' input_file 
```

修改原始文件：

```
sed -i '/START/,/END/d' input_file 
```

# android - 缩放动画中的循环未执行？

> ID：12098772
> 
> 赞同：1
> 
> 时间：2012-08-23T19:33:41.520
> 
> 标签：android, android-mapview, android-handler

我在一个while循环内运行一个处理程序，针对一个纬度/经度跨度，所以如果我在某个跨度之外，该地图将自动放大。我正在使用完全相同的设置，比较缩放级别而不是跨度，它工作得很好。这就是我正在做的...

```
public static void smoothZoomToSpan(final MapController controller,
        MapView v, GeoPoint center, int latitudeSpan, int longitudeSpan) {

    final Handler handler = new Handler();
    final MapView mapView = v;

    final int currentLatitudeSpan = v.getLatitudeSpan();
    final int currentLongitudeSpan = v.getLongitudeSpan();

    final int targetLatitudeSpan = latitudeSpan;
    final int targetLongitudeSpan = longitudeSpan;

    controller.animateTo(center, new Runnable() {
        public void run() {

            int curLatSpan = currentLatitudeSpan;
            int curLngSpan = currentLongitudeSpan;
            int tarLatSpn = targetLatitudeSpan;
            int tarLngSpan = targetLongitudeSpan;

            long delay = 0;

                while ((curLatSpan - 6000 > tarLatSpn)
                        || (curLngSpan - 6000 > tarLngSpan)) {
                    Log.e("ZoomIn", "Thinks we should!");
                    handler.postDelayed(new Runnable() {
                        @Override
                        public void run() {
                            controller.zoomIn();
                            Log.e("ZoomIn", "Zoomed");
                        }
                    }, delay);

                    delay += 150; // Change this to whatever is good on the
                                    // device
                }
                Log.e("ZoomIn", "completed");
        }
    });
} 
```

执行此代码后，Logcat 输出“认为我们应该！” （基本上淹没原木）无休止。但它从来没有对我的处理程序做任何事情......实际的 zoomIn 调用永远不会触发，它只会永远循环，直到我强制关闭我的应用程序。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:43:42.537

您的处理程序和 while 循环都`Runnable`在 UI 线程上执行它们的 s。因此，您已经向 UI 线程处理程序发布了一个 bajillion 可运行文件，但这并不重要，因为 UI 线程正忙于执行您的 while 循环，并且永远不会到达可以执行您已发布到处理程序的可运行文件的地步. 您必须稍微修改您的控制流程才能使其正常工作 - 可能是这样的：

```
public static void smoothZoomToSpan(final MapController controller,
    MapView v, GeoPoint center, int latitudeSpan, int longitudeSpan) {
  controller.animateTo(center, new Runnable());
}

private class ExecuteZoom implements Runnable {
  static long delay;

  @Override
  public void run() {
    if ((curLatSpan - 6000 > tarLatSpn)
                    || (curLngSpan - 6000 > tarLngSpan)) {
       handler.postDelayed(new ExecuteZoom(), delay);
       delay += 150;
    }
  }
} 
```

显然不是一个完整的实现，您可能必须向可运行对象的构造函数传递一些变量等；但希望这对你来说会更好一些。

# asp.net-web-api - webapi 动作重载

> ID：12098773
> 
> 赞同：0
> 
> 时间：2012-08-23T19:33:45.607
> 
> 标签：asp.net-web-api, asp.net-routing

这是我的行动

```
public AddressModel[] Get()
{
    return addresses.ToArray();
}

public AddressModel Get([FromUri]GetAddressModelById model)
{
    return Addresses.FirstOrDefault(x => x.Id == model.Id);
}
...
public class GetAddressModelById
{
    public Guid Id { get; set; }
} 
```

网址看起来像这样

```
domain:port/api/controller
domain:port/api/controller/[guid] 
```

并且路由是默认路由。当我运行它时，我得到了异常`Multiple actions were found that match the request`。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T07:12:04.027

尝试 domain:port/api/controller/model=[guid]

如果你能这样做也很好：

public AddressModel Get([FromUri]Guid model) { ... }

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T21:56:06.110

您收到此错误的原因是，如果您请求 domain:port/api/controller，我们无法决定是将其分派到`Get()`还是`Get([FromUri]GetAddressModelById model)`将模型设置为 null。在这种情况下，您有以下两个选项

1.  使用普通的 Guid 类型参数而不是类包装器
2.  在正文中发布您的复杂类型，而不是通过 URI 发送

# javascript - 使用谷歌地图：返回未定义的自定义 javascript 函数

> ID：12098774
> 
> 赞同：0
> 
> 时间：2012-08-23T19:33:51.153
> 
> 标签：javascript

我正在尝试`coord`从 GetLocation 返回变量，但它只返回未定义的。任何帮助表示赞赏！

```
var coord = "";
function GetLocation(address) {

    var geocoder = new google.maps.Geocoder();

    geocoder.geocode( { "address": address }, function (results, status) {

        if (status == google.maps.GeocoderStatus.OK) {
            coord = ParseLocation(results[0].geometry.location);

            // This alert shows the proper coordinates 
            alert(coord);
        }
        else{ }

    });

    // this alert is undefined
    alert(coord);
    return coord;
}

function ParseLocation(location) {

    var lat = location.lat().toString().substr(0, 12);
    var lng = location.lng().toString().substr(0, 12);

    return lat+","+lng;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:38:40.403

当您`coords`从外部函数返回时，它实际上仍然是`undefined`. 内部函数稍后在异步操作（如果它不是异步的，API 只会正常地给你结果）完成时执行。

尝试传递回调：

```
function GetLocation(address, cb) {

    var geocoder = new google.maps.Geocoder();

    geocoder.geocode( { "address": address }, function (results, status) {

        if (status == google.maps.GeocoderStatus.OK) {
            cb(ParseLocation(results[0].geometry.location));
        }
        else{ }

    });
} 
```

然后你可以像这样使用它：

```
GetLocation( "asd", function(coord){
    alert(coord);
}); 
```

# java - 逐步构建对象，同时避免空值

> ID：12098778
> 
> 赞同：2
> 
> 时间：2012-08-23T19:34:02.617
> 
> 标签：java, oop, builder

我有一个刮板，它可以扫描网页中的特定信息并从中创建一个对象。其中一个属性是**id**，稍后用于**查询**新对象的剩余属性。

因为构建这个对象的责任被分成几个类（scraper 类和使用其中一个属性进行查询的类），我想避免使用传递一个**Builder**（此外，带有访问器的 Builder 模式似乎很奇怪我）。

同时，我想避免正在构建的对象中出现**空引用。**

*Guava 的 Optional*似乎也不太合适，因为在其构造的所有步骤完成后，对象的属性肯定不会为空。

我可以创建单独的类，如下所示：

```
class ScrapeablePersonImportPart {

    String surname;
    Year yearOfBirth;
    String externalId;

    // ... getters, constructor ...

}

class PersonImport extends ScrapeablePersonImportPart {

    SocialSecurityNumber ssn;
    Color favoriteColor;

    // ... getters, constructor ...

    PersonImport( ScrapeablePersonImportPart part, SocialSecurityNumber ssn, Color favoriteColor ) {
        this.surname = part.getSurname();
        this.yearOfBirth = part.getYearOfBirth();
        this.externalId = part.getExternalId();
        this.ssn = ssn;
        this.favoriteColor = favoriteColor;
    }

} 
```

或者我可以避免子类化并改用组合。

随着程序的发展，构造很可能**包括更多的步骤。**

**具有几个单独类的解决方案看起来合理吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:46:38.893

我会改用组合，因为您传递的是 a`ScrapeablePersonImportPart`您可以委托给它而不是从它继承。由于您可能有一个新`XYZPart`的传入，因此委托是有意义的，因为无论如何您都不能从两者继承。

如果这些只是用于保存动态数据字段的虚拟对象，我会很想使用`HashMap`.

# java - Java Play 2 - 作为 scala 中的参数的函数

> ID：12098783
> 
> 赞同：1
> 
> 时间：2012-08-23T19:34:29.217
> 
> 标签：java, templates, scala, playframework-2.0

我在 scala 中编写可重用代码时遇到问题。

如果我有类似的东西

```
@helper.form(action = routes.Guides.addComment(category,title)) { 
```

有没有办法用变量替换它？

伪代码

```
@(func : Function)
@helper.form(action = func) { 
```

编辑：

哦....现在有点明显了。函数本身应该返回一个字符串，所以我想我可以这样说

```
@(func :String)
.. 
```

.

```
return ok (form.render(routes.Guides.test())) 
```

现在测试它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:57:26.883

弄清楚了。

和

```
routes.Guides.test().url 
```

你得到了url，然后你可以把它用作参数

例如

```
@guidesComment((routes.Guides.addComment(ug.category,ug.title)).url) 
```

指南评论看起来像这样

```
@(func: String) 
```

然后像这样使用它

```
<form action="@func" method="POST"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T09:01:11.713

我可以建议一个替代方案吗？直接使用[呼叫](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/java/play/mvc/Call.java)。

```
@(route: Call)

@helper.form(action = route) {
  ...
} 
```

在 Scala 中，您甚至可以只传递部分路由并从控制器填充其余部分（在使用分页时非常有用）。

# xcode - Xcode 中的文件夹

> ID：12098788
> 
> 赞同：0
> 
> 时间：2012-08-23T19:34:54.273
> 
> 标签：xcode

在 Xcode 中有组和文件夹。组显示为黄色图标，文件夹显示为蓝色图标。我的问题是：

设法在 Xcode 项目中添加一个文件夹，但似乎只能将一个文件放入该文件夹中。已尝试将文件拖到文件夹但失败。将文件添加到 Xcode 中的文件夹的最佳方法是什么？

希望熟悉这方面的人可以帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:36:28.067

据我所知，文件夹有点奇怪。

通常我将文件夹添加为组。并且可以在其中移动物品。但是在 xcode 中移动文件时，它们不会转换为那些实际的文件夹。

如果我想在组中移动一个项目并代表文件夹结构中的移动。我会在查找器中移动项目，然后从该组中重新添加项目。

# asp.net - mvc3 到 mvc4 的问题

> ID：12098795
> 
> 赞同：3
> 
> 时间：2012-08-23T19:35:29.920
> 
> 标签：asp.net, asp.net-mvc-4

我刚刚把我的 mvc3 项目变成了一个 mvc4 项目。我做了一个新项目，没有修改任何配置文件，移动了我的控制器、视图和模型。然后我将mysql导入到项目中。

一切正常，但我在整个授权过程中遇到了问题。

如果我在我的视图中添加它：

```
 @if (User.Identity.IsAuthenticated)
        {
            // Something
        }
        else
        {
             // Another Thing
        } 
```

它总会触发一些东西。即使我不是，它也会认为我已通过身份验证（我检查了我的 cookie，但我没有）。

当然，我可以访问所有应该使用`[Authorize]`.

知道如何解决这个问题吗？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:12:08.450

我已经解决了我的问题。

问题来自于我创建了一个空项目。似乎根本没有进行任何配置。

您必须创建一个默认项目才能进行正确的设置。

# c# - void AjaxManager_AjaxRequest 可以将 JSON 数据发送回浏览器吗？

> ID：12098797
> 
> 赞同：2
> 
> 时间：2012-08-23T19:35:40.410
> 
> 标签：c#, asp.net, ajax, json, radajaxmanager

AjaxManager_AjaxRequest 是否可以仅修改其 UpdatePanels 中的控件，或者也可以在响应中发回 JSON 数据。理想情况下只是 JSON 数据。

所以在我的 ascx 我有

```
protected void Page_Load(object sender, EventArgs e)
{
    RadAjaxManager radAjaxManager = RadAjaxManager.GetCurrent(Page);

    if (radAjaxManager != null)
    {
        radAjaxManager.AjaxRequest += AjaxManager_AjaxRequest;
    }

}

private void AjaxManager_AjaxRequest(object sender, AjaxRequestEventArgs e)
{
   // Somehow tweak it so response is just a JSON object.
} 
```

我只是继承了一些遗留代码，这是我在不创建 Web 服务的情况下实现目标的最快方法。

反正有没有做我要求的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:19:53.020

是的，这可能。实际上存在两种可用的解决方案。第一个是使用 jQuery ajax 方法发送 ajax 请求（您可以使用 访问 jQuery 功能`$telerik.$`）。这种方法的唯一不足是目标服务器端方法必须是静态的，并且您不能访问页面的 ViewState 以及服务器控件的属性值。另一种方法是在方法中使用 ScriptManager 的`RegisterDataItem`方法`AjaxManager_AjaxRequest`将 JSON 序列化对象传递回客户端，并在`Sys.WebForms.PageRequestManager`客户端的 endRequest 事件处理程序中获取它。

```
<asp:ScriptManager ID="ScriptManager1" runat="server" />
<script type="text/javascript">
    Sys.WebForms.PageRequestManager.getInstance().add_endRequest(endRequestHandler);

    function endRequestHandler(sender, args) {
        var dataItems = args.get_dataItems();
        if (dataItems && dataItems["<%= RadAjaxManager1.UniqueID %>"]) {
            alert(dataItems["<%= RadAjaxManager1.UniqueID %>"].Response);
        }
    }
</script>
<telerik:RadAjaxManager ID="RadAjaxManager1" runat="server" />

void AjaxManager_AjaxRequest(object sender, Telerik.Web.UI.AjaxRequestEventArgs e)
{
    ScriptManager1.RegisterDataItem(radAjaxManager , new JavaScriptSerializer().Serialize(new { Response = "Hello, RadAjaxManager!" }), true);
} 
```

# c# - 如何使用 Mozilla ActiveX 控件 (axMozillaBrowser1) c#/.net

> ID：12098798
> 
> 赞同：0
> 
> 时间：2012-08-23T19:35:42.930
> 
> 标签：c#, .net, activex, webbrowser-control, mozilla

我正在尝试使用重新加载网页 3 次，`"axMozillaBrowser1(Mozilla ActiveX Control)"` 但 axMozillaBrowser1 控件未加载网页，它正在等待进程正在正常闪烁，但浏览器控件未加载网页。

请告诉我如何正确使用 axMozillaBrowser1 控件。提前谢谢。

这是我的程序代码：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        progressBar1.Maximum = 3;
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }

    private void button1_Click(object sender, EventArgs e)
    {
        do
        {
            axMozillaBrowser1.Navigate(textBox1.Text);
            while(axMozillaBrowser1.ReadyState != MOZILLACONTROLLib.tagREADYSTATE.READYSTATE_COMPLETE)
            {
                Application.DoEvents();
                if (axMozillaBrowser1.ReadyState == MOZILLACONTROLLib.tagREADYSTATE.READYSTATE_COMPLETE)
                { 
                    progressBar1.Value = progressBar1.Value + 1; 
                }
            }
        }while(progressBar1.Value != 3);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:13:19.833

为什么要导航 3 次？

但我的建议是：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        progressBar1.Maximum = 3;
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }

    private void button1_Click(object sender, EventArgs e)
    {
             progressBar1.Value = 0; 
            axMozillaBrowser1.Navigate(textBox1.Text);
    }

    private void webBrowser2_Navigated(object sender, WebBrowserNavigatedEventArgs e)
    {
        if ( progressBar1.Value < 3 )
        {
            axMozillaBrowser1.Navigate(textBox1.Text);
            progressBar1.Value = progressBar1.Value + 1; 
        }

    }
} 
```

# debugging - '单——跟踪我的应用程序'？

> ID：12098808
> 
> 赞同：1
> 
> 时间：2012-08-23T19:36:19.780
> 
> 标签：debugging, mono, ubuntu-12.04

Ubuntu 12.04，单声道 2.10.8.1-5

我已经构建了 MonoDevelop 默认创建的“hello world”控制台应用程序。它按预期运行。当我添加跟踪选项（是否定向到文件中）时，我得到如下内容：

```
[0x7f24da6eb740: 0.00000 0] ENTER: (wrapper runtime-invoke) <Module>:runtime_invoke_void__this___object (object,intptr,intptr,intptr)([System.OutOfMemoryException:0x7f24da52af60], 0x7fff953e6510, (nil), 0x40e79a70, )
[0x7f24da6eb740: 0.00012 1] ENTER: System.OutOfMemoryException:.ctor (string)(this:0x7f24da52af60[System.OutOfMemoryException monotracetest.exe], [STRING:0x7f24da551e70:Out of memory], )
[0x7f24da6eb740: 0.00021 2] ENTER: System.SystemException:.ctor (string)(this:0x7f24da52af60[System.OutOfMemoryException monotracetest.exe], [STRING:0x7f24da551e70:Out of memory], )
[0x7f24da6eb740: 0.00030 3] ENTER: System.Exception:.ctor (string)(this:0x7f24da52af60[System.OutOfMemoryException monotracetest.exe], [STRING:0x7f24da551e70:Out of memory], )
[0x7f24da6eb740: 0.00031 3] LEAVE: System.Exception:.ctor (string) 
```

..持续了近 900 行关于堆栈溢出、内存不足和看起来更无辜的事情。

除了“--help-trace”之外，我还没有找到任何关于跟踪选项的文档。我应该期待什么？这实际上是在报告问题吗？当我将 'console.writeline("hello world")' 包装在 try catch 块中时，不会引发异常。（当然，一个未处理的异常可能会使程序崩溃。）

我最初的程序是测试调用一个本地代码库，我将它简化为这个以查看它失败的地方。

如何将小麦与谷壳分开？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T07:07:37.103

那是预期的输出：没有抛出异常，但是运行时需要在启动时构建一些对象（例如 OutOfMemory 异常对象：当条件发生时，可能没有内存来分配它！）。

至于减少输出， --help-trace 有什么不清楚的地方？例如，如果您只想获取 System.IO 命名空间中的类和方法的跟踪，您将发出：

> 单声道--trace=N:System.IO program.exe

# css - 通过单击填充来定位 ahref

> ID：12098811
> 
> 赞同：0
> 
> 时间：2012-08-23T19:36:25.537
> 
> 标签：css, navigation, click, whitespace

新手问题在这里。我的所有 li 都有一个带有填充的导航栏，我希望能够在您单击填充时定位 ahref。这可以通过每个 li 的 onclick/javascript 来完成吗？还是有一个简单的 CSS 方法？

我还有一个搜索栏，我也想通过点击它的填充来关注它。我认为这需要类似的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:37:26.143

将填充设置为锚点而不是`li`.

请参阅[http://jsfiddle.net/FBsKH/](http://jsfiddle.net/FBsKH/)并进行比较。

关于搜索栏，您可以发布一些代码吗？

如果我向 a 添加填充`<input type="text" />`并在它的填充上单击它，它将获得焦点（在 Firefox 和 Chrome 上测试）。在这里看到它：http: [//jsfiddle.net/fnsRu/](http://jsfiddle.net/fnsRu/)

**编辑：**

啊，现在我明白了您对搜索栏的要求。

问题是使用 CSS 的 AFAIK 无法将焦点设置到元素。

那么你就可以：

*   删除填充：http: [//jsfiddle.net/fnsRu/3/](http://jsfiddle.net/fnsRu/3/)
*   使用 JavaScript：http: [//jsfiddle.net/fnsRu/4/](http://jsfiddle.net/fnsRu/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:39:57.080

也许你可以指定：

```
li.someclass a {
    display: inline-block; //or display:block;
    width: 100%;
    height: 100%;
} 
```

（记得指定父容器的宽度/高度）

不知道我是否说对了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:48:28.580

首先，您必须将其设置`display:inline-block`为链接的属性。然后，从列表项中删除填充并将其应用于链接。

您的 CSS 应反映以下内容：

```
li a {
 display: inline-block;
 padding: 10px; 
} 
```

[这是一个工作示例的小提琴](http://jsfiddle.net/JTFGL/)。

# hibernate - 即使有简单的例子，HQL LEFT JOIN 也能破解

> ID：12098814
> 
> 赞同：1
> 
> 时间：2012-08-23T19:36:37.267
> 
> 标签：hibernate, hql, left-join

这让我的一天很痛苦。

我是 HQL 的初学者，正在将 SQL 语句转换为 HQL。

SQL 语句没有那么复杂，大致是这样的。

```
SELECT t.teamworkerdid, COUNT(t.teamworkerdid), SUM(NVL(p.percentagework, 1)) 
FROM WORKER_TEAM t 
LEFT JOIN PARTIAL_WORK p 
ON (t.teamworkerdid = p.idworkerteam) 
WHERE 
( e.startwork <= CURRENT_DATE 
AND
e.finishwork >= CURRENT_DATE); 
```

表 WORKER_TEAM 具有所有工人 ID，这是 PARTIAL_WORK 表中的外键。但并非 W_T 中的所有团队工作人员都在 P_T 表中，因为 100% 工作的工作人员在部分工作表中没有条目。这就是 y 使用带 1 个选项的左连接和 NVL 的原因。

我做了数据库表名和 POJO 变量之间的所有转换。尝试使用上句的简化版本，一切顺利，例如 **SELECT** COUNT(t.teamworkerdid) **FROM** WORKER_TEAM t, PARTIAL_WORK p **WHERE** (t.teamworkerdid = p.idworkerteam) 但在 HQL 中（我不更改 var 名称因为会让每个人都感到困惑）。

好的，自然连接工作正常*强调文本*，因为我在控制台中激活 HQL 净化输出并获得工作正常的 SQL 语句。

当我尝试在 HQL 中执行 LEFT JOIN 时出现问题，仅使用 LEFT JOIN 更改隐式自然连接，使用 WITH 关键字而不是 ON SQL 关键字，程序崩溃并抛出异常。HQL 在生成 NULL 单元格时有任何问题是我做错了。

提前致谢。

PD 我知道 NVL 在 HQL 中不起作用，替代品是 *coalesce(column_name, 'asdf')*。

# mongodb - _id上的mongodb排序顺序

> ID：12098815
> 
> 赞同：80
> 
> 时间：2012-08-23T19:36:40.187
> 
> 标签：mongodb

我想知道 mongodb 在进行如下查询时如何比较“_id”字段：

```
db.data.find({"_id":{$gt:ObjectId("502aa46c0674d23e3cee6152")}}).sort({"_id":1}).limit(10); 
```

它是否纯粹基于 id 的时间戳部分？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-08-23T21:11:43.643

稍微扩展安德烈所说的话：

由于 ObjectID 时间戳只是第二个，因此可以轻松地创建两个（或更多）ObjectID，并使用相同的时间戳值（前 4 个字节）。如果它们是在同一台机器上创建的（机器 ID - 接下来的 3 个字节），由同一个进程（PID - 接下来的 2 个字节），那么唯一可以区分它们的是“inc”字段，即最后 3 个字节在最后。

**更新：2020 年 1 月**

这个答案仍然很受欢迎，所以值得更新一下。自 8 年前编写此答案以来，ObjectID 规范已经发展，时间戳后的 5 个字节现在只是随机的，这将大大降低任何冲突的可能性。最后三个字节仍然是递增的，但以随机值初始化，再次降低了冲突的可能性。ObjectID 现在包含更少的上下文（您不能轻易地知道它是在哪里生成的以及由什么过程生成的），但我猜想该信息没有以任何有意义的方式被使用，并且已被弃用，以支持更好的 ID 随机化。

**结束更新**

有关完整规格，请参见此处：

[https://docs.mongodb.com/manual/reference/method/ObjectId/#ObjectIDs-BSONObjectIDSpecification](https://docs.mongodb.com/manual/reference/method/ObjectId/#ObjectIDs-BSONObjectIDSpecification)

该“inc”字段要么是一个不断递增的字段（那么您可以合理地期望排序按照插入/创建顺序）或一个随机值（然后可能是唯一的，但不是有序的），当然假设规范是正确实现的. 请注意，ObjectID 可能由驱动程序或应用程序（或实际上是手动）而不是由 MongoDB 本身生成，因此除非您完全控制它们的生成方式，否则上述任何或全部都可能适用。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-08-23T19:51:36.167

在某种程度上你是正确的，如果你`_id`按插入时间排序，你将按插入时间排序。这并不意味着唯一的比较是在时间戳部分上完成的。ObjectID 本身就是一个 BSON 对象类型，它们可以直接相互比较。由于它们以时间戳开始，因此从逻辑上讲，过去的时间将少于未来的时间。

[您可以在文档](http://www.mongodb.org/display/DOCS/Optimizing+Object+IDs#OptimizingObjectIDs-Sortbyidtosortbyinsertiontime)中找到更多详细信息

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-07-22T11:51:08.213

从 Mongo 规范复制粘贴 [https://docs.mongodb.com/manual/reference/bson-types/#objectid](https://docs.mongodb.com/manual/reference/bson-types/#objectid)

**ObjectId 值的顺序与生成时间的关系在单秒内并不严格**。如果多个系统，或单个系统上的多个进程或线程生成值，在一秒钟内；ObjectId 值不代表严格的插入顺序。客户端之间的时钟偏差也可能导致非严格排序，即使对于值也是如此，因为客户端驱动程序生成 ObjectId 值，而不是 mongod 进程。

# ruby-on-rails - Rails 3：循环和提取项目的最佳实践

> ID：12098820
> 
> 赞同：0
> 
> 时间：2012-08-23T19:36:54.480
> 
> 标签：ruby-on-rails, arrays, ruby-on-rails-3

我正在开发一个允许用户将产品（或订阅）添加到他们的购物车的小应用程序。创建帐户后，新用户将被发送到“捆绑”页面，在该页面询问他们是否愿意以捆绑价格为不同的产品添加不同的订阅。

这是我卡住的地方：在提交用户的信用卡信息时，我在尝试设置捆绑定价以提交给 Authorize.net 时略微“迷失在翻译中”（我了解如何进行身份验证，而不是这里的问题）。

这是我到目前为止所拥有的：

```
current_order.products.includes(:client).each do |product|
          transaction = current_order.submit_order_to_authnet(product)

            if transaction.result_code == 'Ok'
          new_group = Group.create!(:name => "#{current_user.full_name} #{product.title}", :type => 'school', :start_date => Time.now, :status => 'active', :site_id => 1)
          primary = session[:primary_product_id].eql?(product.id) ? true : false

          # Add subscription to Group
          new_group.add_subscription(product, current_order, transaction.subscription_id, 'active', primary)
          # Add Subscription to CurrentOrder
          current_order.subscriptions << new_group.subscriptions.last
          # Add user to NewGroup
          current_user.groups << new_group
          # Create New Group Admin
          new_group.group_admins.create(:user_id => current_user.id)
          # Send success email
          OrderMailer.checkout_confirmation(current_user).deliver
        else
          errors << transaction.result_code
        end
      end 
```

在遍历用户中的每个产品时，我试图找出最佳解决方案，`current_order`因为用户购物车中的第二个订阅也是获得折扣的订阅。我知道我可以写这样的东西：

```
current_order.products.includes(:client).each do |product|
    if current_order.products.many? and product == current_order.products.last
        # run discount logic
    else
        # continue with authnet for single subscription
    end
end 
```

但我只是不确定这是否是最佳做法。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:45:41.540

所以唯一没有打折的订阅是第一个？为什么不这样写：

```
current_order.products.includes(:client).each do |product|
  if product == current_order.products.first
    # continue with authnet for single subscription
  else
    # run discount logic
  end
end 
```

# view - 在选取器视图中从多行中分离数据

> ID：12098822
> 
> 赞同：0
> 
> 时间：2012-08-23T19:37:05.910
> 
> 标签：view, row, rows, picker

我创建了 4 行的选择器视图，但所有行中的数据都是相同的。那么我如何从每一行中分离数据并将其用于计算呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T20:34:19.380

也许这可以解决您不显示数据的问题？不能真正告诉，因为我看不到你已经做了什么。

```
-(NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView{
    return 4;
}
-(NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent (NSInteger)component{

    return rowOneItems.count;
    return rowTwoItems.count;
    return rowThreeItems.count;
    return rowFourItems.count;
}
-(NSString*)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component{

    if(component == 1)
        return[rowTwoItems objectAtIndex:row];
    else if(component == 2)
        return[rowThreeItems objectAtIndex:row];
    else if(component == 3)
        return[rowFourItems objectAtIndex:row];
    else
        return [rowOneItems objectAtIndex:row];
} 
```

# objective-c - 为什么在 Safari 中打开 URL 时 UITableCell 不会立即取消选择？

> ID：12098830
> 
> 赞同：2
> 
> 时间：2012-08-23T19:37:52.463
> 
> 标签：objective-c, ios, uitableview

`UITableViewCell`我有一个应用程序在触摸a 时关闭并转到 Safari 打开 URL 。但是，当我返回应用程序时，仍会选择该单元格几秒钟。为什么不立即取消选择？它是一个错误吗？这是代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    [tableView deselectRowAtIndexPath:indexPath animated:NO];

    if (indexPath.section == 0 && indexPath.row == 0) {
        [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://www.example.com/"]];
    }

} 
```

我尝试移动`[tableView deselectRowAtIndexPath:indexPath animated:NO];`到顶部并关闭动画，但没有帮助。这没什么大不了的，但如果可能的话，我希望它立即取消选择。

这也发生`UIButton`了。返回应用程序后，它会保持突出显示状态一两秒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T20:12:13.533

诸如此类的更改`[tableView deselectRowAtIndexPath:indexPath animated:NO];`会在运行循环的下一次迭代中生效。当您退出时`openURL:`，会延迟下一次迭代，直到您切换回应用程序。切换回来是通过在您离开之前在屏幕图像中循环来实现的，然后片刻之后使应用程序再次交互。因此，所选图像仍然存在。

抛开实现的细节，逻辑是影响屏幕内容的东西被捆绑在一起并被原子化，这样当你进行视图调整时，你就不必总是想‘哦，不，如果框架现在重绘怎么办并且只完成到这里的更改？'。根据 iOS 多任务模型，在您返回应用程序之前不会发生调整界面的原子单元。

快速解决：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    // deselect right here, right now
    [tableView deselectRowAtIndexPath:indexPath animated:NO];

    if (indexPath.section == 0 && indexPath.row == 0) {
        [[UIApplication sharedApplication]
                    performSelector:@selector(openURL:)
                    withObject:[NSURL URLWithString:@"http://www.example.com/"]
                    afterDelay:0.0];

        /*
              performSelector:withObject:afterDelay: schedules a particular
              operation to happen in the future. A delay of 0.0 means that it'll
              be added to the run loop's list to occur as soon as possible.

              However, it'll occur after any currently scheduled UI updates
              (such as the net effect of a deselectRowAtIndexPath:...)
              because that stuff is already in the queue.
        */
    }

} 
```

# javascript - 读取文件时的异步问题

> ID：12098835
> 
> 赞同：1
> 
> 时间：2012-08-23T19:38:26.910
> 
> 标签：javascript, jquery, ajax, cordova

所以，我有以下代码：

```
function sortVitalsByDate(tx, results){
vitals_counter = 0;
showLoader();
if(results.rows.length > 0){
    for (var i=0;i<results.rows.length;i++){
        vitals_counter += 1;
        var record_id = results.rows.item(i).id;
        readData('clinicalObservation', record_id, populateVitalsDateList);//calls readData function, uses populateVitalsDateList as the success callback (below)
        //hideVitalsLoader();
    }
    console.log("< === sqlHostingArray == "+ sqlHostingArray); //sqlHostingArray is blank
}else{
    $("#vitals-measures-content").html('<div class="no-info">No Information Entered</div>');
    hideVitalsLoader();
}
console.log(arguments.callee.name + ", # rows: " + results.rows.length);
}

function populateVitalsDateList(tx, results){
var listItems = ""; 
for (var i=0;i<results.rows.length;i++){
    var data_element = results.rows.item(i).data_element;
    var heading;
    var label;
    var listItem;
    var value;
    var bpsVal;

    switch(data_element){
    case 'clinicalObservationDate': 
        label = null;
        value = null;
        listItem = null;
        var dateObj = new Date(parseInt(results.rows.item(i).field_value,10));
        //console.log("< == dateObj is " + results.rows.item(i).field_value);
        //heading = formatDate(dateObj);
        // v1.1.1 CRM date sorage callback
        storeDateTemporarily(dateObj);

        heading = decrypt(results.rows.item(i).field_label);
        sqlHostingArray.push(heading);
        break;  
    case 'bloodPressureSystolic':   
        label = "Blood Pressure";
        value = decrypt(results.rows.item(i).field_value);
        bpsVal = value;
        break;   

    case 'bloodPressureDiastolic':
        label = "Blood Pressure";
        value = decrypt(results.rows.item(i).field_value);
        if (value != "" && value != null && value != undefined){
            listItem = addDateLI(results.rows.item(i).record_id, label, bpsVal + "/" + value);
        }else{
            listItem = "";
        }
        break;

    case 'pulse':
        label = "Pulse";
        value = decrypt(results.rows.item(i).field_value);          
        if (value != "" && value != null && value != undefined){
            listItem = addDateLI(results.rows.item(i).record_id, label, value + " bpm");
        }else{
            listItem = "";
        }           
        break;
    case 'respRateValue':
        label = "Respiratory Rate";
        value = decrypt(results.rows.item(i).field_value);
        if (value != "" && value != null && value != undefined){
            listItem = addDateLI(results.rows.item(i).record_id, label, value + " bpm");
        }else{
            listItem = "";
        }
        break;
    case 'heightValue1':
        label = "Height";
        value = decrypt(results.rows.item(i).field_value);
        if (value != "" && value != null && value != undefined){
            listItem = addDateLI(results.rows.item(i).record_id, label, value + " cm");
        }else{
            listItem = "";
        }
        break;
    case 'weightValue':
        label = "Weight";
        value = decrypt(results.rows.item(i).field_value);
        if (value != "" && value != null && value != undefined){
            listItem = addDateLI(results.rows.item(i).record_id, label, value + " kg");
        }else{
            listItem = "";
        }
        break;
    case 'bmi':
        label = "BMI";
        value = decrypt(results.rows.item(i).field_value);
        if (value != "" && value != null && value != undefined){
            listItem = addDateLI(results.rows.item(i).record_id, label, value);
        }else{
            listItem = "";
        } 
        break;
    case 'tempBody':
        label = "Temperature";
        value = decrypt(results.rows.item(i).field_value);
        if (value != "" && value != null && value != undefined){
            listItem = addDateLI(results.rows.item(i).record_id, label, value + " &deg;C");
        }else{
            listItem = "";
        } 
        break;
    default:
        label = null; 
        listItem = null;
        break;        

    }

    if (label != null && label != "" && label != undefined && listItem != null && listItem != "" && listItem != undefined){
        listItems += listItem;
    }
    //console.log(arguments.callee.name + ", label: " + label + ", listItem: " + listItem + ", data_element: " + data_element);
    vitals_counter -= 1;
    hideVitalsLoader();
}
} 
```

这一切都很好，除了该行`console.log("< === sqlHostingArray == " + sqlHostingArray);`告诉我 console.log 在其正上方的 for 循环完成之前被调用。意思是，被推送到的变量`sqlHostingArray`在我需要使用它们的时候没有定义，即使它应该在之后执行。如果在循环内调用变量，它工作正常，但我绝对必须在循环完成后执行它。有谁知道修复它的方法？

**编辑**

好的，所以它是异步执行的......我如何保留我需要在 for 循环**之后**执行的部分，以等待循环完成。

# php - 向半径 15 英里范围内的地点广播

> ID：12098836
> 
> 赞同：0
> 
> 时间：2012-08-23T19:38:32.697
> 
> 标签：php, google-maps, geolocation, latitude-longitude

我真的不确定哪种方法最好，但我需要能够向位于 N 15 英里范围内的用户群广播。

因此，如果`userA`需要向会员群报告他们丢失了宠物，系统将向位于 15 英里半径范围内的会员发送电子邮件。`userA`

我很想使用谷歌地图，以及经度和纬度......我有`userA`邮政/邮政编码，所以也许我可以用它来查找它的经度和纬度，然后进行广播。

* * *

我的问题是：如果我有 ZIP / Postal Code 的`userA`，我如何利用 Google Maps API 向周围 15 英里范围内拥有 ZIP/Postal Code 的所有用户广播`userA`……我不需要知道 SQL 查询需要是什么……我只需要知道如何使用 Google API……需要什么参数，等等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T00:21:20.200

这是谷歌地理编码 API：

[https://developers.google.com/maps/documentation/geocoding/](https://developers.google.com/maps/documentation/geocoding/)

你可以用 调用它`file_get_contents`，然后`json_decode`响应......

这是一个示例调用：

[http://maps.googleapis.com/maps/api/geocode/json?address=60201&sensor=false](http://maps.googleapis.com/maps/api/geocode/json?address=60201&sensor=false)

但是如果你看看你得到的响应，你会得到一个 ZIP 的边界框（和中心点）......所以你必须决定如何定义你的搜索范围......如果一些假设的 ZIP每个维度是 15 英里，您是否会在该 ZIP 内向用户发送消息？而且，如果 ZIP 在每个维度上都是 100 英里，您将无法告诉 15 英里范围内的用户。

您可以说“我的邮政编码中的每个人，以及在该邮政编码周长 15 英里范围内的任何部分的那些邮政编码”……但如果您有两个非常大的邮政编码接触，那么您会打一个巨大的区域。

你看过[navigator.geolocation](http://www.w3.org/TR/geolocation-API/)吗？或者考虑合并一些其他数据收集选项，例如向您的系统报告用户位置的移动应用程序？或者，就此而言，只是让他们输入的不仅仅是 ZIP……为什么不输入完整地址？

# android - 在整个 Android 应用程序中使用多个静态 ArrayList

> ID：12098840
> 
> 赞同：1
> 
> 时间：2012-08-23T19:39:02.867
> 
> 标签：android, sqlite, arraylist, sharedpreferences, parcelable

我正在开发我的第一个 android 应用程序，并希望在这里得到一些提示。

我`JSONObject`从一个 url 中得到一个，然后将在一个`ArrayList<MyObject>`. 该列表将在多个选项卡中使用，并根据选项卡的需要进行过滤。用户可以修改这些列表中的对象，并且更改应与列表同步。

因此，为了加快加载时间，我创建了一个`DataHolder`作为单例的类，其中包含 7 个数组列表，基于`JSONObject`不同排序顺序和过滤条件的一个。这些列表中的对象是来自原始列表的引用。填充列表工作正常。

这些列表将用于不同的片段和活动。

现在的问题是：第二个活动包含带有片段的选项卡。初始化片段后......`DataHolder`计数中的所有arraylists 0！我必须保存`JSONObject`并`SharedPreferences`再次填充它才能获得`List`. 我无法再次加载 url，因为它会降低应用程序的速度，并且使用`SharedPreferences`不是一个选项（我认为），因为需要同步`Lists`. 我读过使用静态变量不是最佳解决方案，但它似乎是最简单的方法:(

我能做些什么来解决这个问题？我应该使用`Parcelable Objects`并总是`Lists`绕过吗？或者也许使用`SQLite`？还是有其他方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:46:18.730

使用静态列表进行本地操作。当用户离开该屏幕（活动）时，将更改保存到数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:34:53.013

SQLite 方式绝对是正确的方法，恕我直言。

您应该使用内部数据库来存储此类列表：http: [//developer.android.com/guide/topics/data/data-storage.html#db](http://developer.android.com/guide/topics/data/data-storage.html#db)

# c# - 没有外键的关联

> ID：12098841
> 
> 赞同：1
> 
> 时间：2012-08-23T19:39:10.263
> 
> 标签：c#, entity-framework-4, associations

我试图在 EF4 中关联两种实体类型，没有可用的外键。

有没有我可以做的手动调整，所以当我加载一个订单实例时，我会得到类似的东西：

```
order.orderID = 455
order.date = 2012-08-12
order.OrderItems = <List>OrderItem // OrderItem being the other entity I want to map on         order 
```

我想当我选择（）一个订单并设置它的 OrderItems 属性时，我必须手动执行此操作，因为没有可用的 FK。

我在正确的轨道上吗？

**编辑：

我能够在订单和订单项之间创建关联，这是我为订单提供的 Select() 方法：

```
 public Order Select(long orderID)
    {
        using (var ctx = new BillingSystemEntities())
        {
            var res = from n in ctx.Orders
                      where n.OrderID == orderID
                      select n;
                 if (res.Count() == 0)
                    return null;
                else
                    return  res.First();
         }
    } 
```

根据 SQL Profiler，EF 没有对 OrderItem 表执行任何 JOIN。我想我需要自己将它们加载到 OrderItems 导航属性中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:45:11.033

您只需要`OrderItems`在查询中包含：

```
public Order Select(long orderID)
{
    using (var ctx = new BillingSystemEntities())
    {
        var res = from n in ctx.Orders.Include("OrderItems")
                  where n.OrderID == orderID
                  select n;
        return res.FirstOrDefault();
    }
} 
```

Also `FirstOrDefault` is more appropriate here than your `Count()...First()` construct because it hits the database only once while `Count()` and `First()` will issue a separate query each.

You can write it even more compact with:

```
public Order Select(long orderID)
{
    using (var ctx = new BillingSystemEntities())
    {
        return ctx.Orders.Include("OrderItems")
            .FirstOrDefault(n => n.OrderID == orderID);
    }
} 
```

# wordpress - WooCommerce：在自定义模板中挂钩产品价格

> ID：12098844
> 
> 赞同：-1
> 
> 时间：2012-08-23T19:39:25.830
> 
> 标签：wordpress, woocommerce

我试图让一些产品价格显示在一个自定义模板中。是否有一个集成的 woocommerce 功能，给定 ID 会给我产品价格？

类似于：woocommerce_productprice(423)

基本上，我有一个自定义页面模板作为目录，我想将产品价格与该模板挂钩，因此每当有变化时，它会自动更改价格，而无需我更改自定义模板。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-09T23:48:05.007

WooCommerce 2.3 更新：

```
$product = we_get_product( $post_id );
echo $product->get_price(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-06T04:46:20.353

`$product = wc_get_product( $product_id ); $price = $product->get_price_html();`

woocommerce 3.x，它工作！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-25T00:57:25.097

这里试试这个

```
$product = new WC_Product( $post_id );
$price = $product->price;
echo $price; 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2016-11-10T06:03:15.540

实际上，上面的代码有一个错字，见下文：

```
$product = wc_get_product( $post_id );
echo $product->get_price();
```

# javascript - highcharts：个人意甲转变

> ID：12098845
> 
> 赞同：0
> 
> 时间：2012-08-23T19:39:26.753
> 
> 标签：javascript, highcharts

在 highchart 折线图中，给定两个数组 A 和 B，是否有可能在 A 之后显示 B？

例如：`A = [11,22,13,4,7], B=[6,11,45,7]`

在`A[0]`x=0，`A[1]`在 x=1 ...`B[0]`在 x=5，`B[1]`在 x=6 ...？

如果没有，我怎样才能为同一组数据设置两种样式（实线和虚线）？本质上我想建立一个实际数据和预测的图表，我希望预测以虚线显示

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:44:24.950

创建两个系列的数据 - 你的 A 和 B。按照你想要的方式设置 A 线颜色，然后按照它的方式设置 B 线颜色。用于`dashStyle`设置破折号。见[这里](http://api.highcharts.com/highcharts#series.data)：

```
series: [{
        name: 'A',
        color: '#0066FF',
        data: [...]
    },{
        name: 'B',
        color: '#FF0000',
        dashStyle: 'ShortDash',
        data: [...]
    }] 
```

至于如何设置从第 5 个 xAxis 位置开始的点。好吧，这里有很多剥猫皮的方法。但我所做的是为 B 中的前 4 个数据点传入空值。看看这个[例子](http://jsfiddle.net/zW6GN/)。

# c# - 使用绑定的 UI 反馈边框

> ID：12098849
> 
> 赞同：1
> 
> 时间：2012-08-23T19:39:55.447
> 
> 标签：c#, .net, wpf, xaml, data-binding

.NET/C#/WPF 菜鸟在这里。我正在尝试根据我可以绑定的变量（变量存储验证结果）为文本框提供边框。我的第一次尝试是这样的：

```
<Border ... Visibility="{Binding ServerName.IsValid, Converter={StaticResource BoolToVisibility}}">
    <TextBox ... />
</Border> 
```

但是，当可见性被隐藏时，这具有将文本框隐藏在其中的不良副作用。之后我查看了 DataTriggers，但它似乎不是我需要的。关于如何将边框绑定到该变量的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T19:44:27.060

你可以分层：

```
<Grid>
    <Border ... /> <!-- Bind as before -->
    <TextBox Margin="5"/> <!-- Margin to not completely hide border below -->
</Grid> 
```

（如果需要，您也可以通过切换顺序来覆盖边框）

* * *

您也可以使用 a `DataTrigger`，但您需要更改外观而不是完全隐藏它。

# bash - 如何指定 zeroeth 参数

> ID：12098853
> 
> 赞同：0
> 
> 时间：2012-08-23T19:40:07.030
> 
> 标签：bash

我正在编写一个 bash 脚本，它将 tcsh 解释器作为登录 shell 启动并让它执行`my_command`。tcsh 手册页说有两种方法可以启动登录 shell。第一个是不使用`/bin/tcsh -l`其他参数。不是一个选项，因为我需要 shell 来执行`my_command`. 第二个是指定一个破折号（`-` ) 作为第 0 个参数。

现在带有选项的 bash`exec`命令`-l`正是这样做的，事实上，以下内容完美地工作：

```
#!/bin/bash
exec -l /bin/tcsh -c my_command 
```

除了......我不能使用`exec`，因为我需要脚本回来然后做一些其他的事情！那么如何在不使用的情况下将其指定`-`为 zeroeth 参数？`/bin/tcsh``exec`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:23:37.063

您可以将`exec`命令包含在脚本的子 shell 中。

```
#!/bin/bash
(exec -l /bin/tcsh -c my_command)
# ... whatever else you need to do after the command is done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:44:44.970

您可以编写一个包装器 (w.sh) 脚本，其中包含：

```
#!/bin/bash
exec -l /bin/tcsh -c my_command 
```

并在您的主脚本中执行 w.sh 。

# sharepoint-2010 - 在 SharePoint 2010 中查找人员/组列

> ID：12098857
> 
> 赞同：1
> 
> 时间：2012-08-23T19:40:12.727
> 
> 标签：sharepoint-2010

我知道在另一个列表中使用人员列作为查找的限制之一，但是有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T14:57:28.193

我想出了一种在列表中使用 InfoPath 表单的方法。这有点涉及。你还有兴趣吗？

基础知识包括设置到查找列表的辅助数据连接并使用 InfoPath 中的规则来填充人员选取器字段（DisplayName、AccountID、AccountType）。

我还发现您必须隐藏人员选择器控件，直到其中有数据，否则即使基础字段中有数据，它们也不会显示任何内容。

如果您需要，我可以花一点时间记录该过程。

-道格

# jquery - 如何在悬停时用图标替换有序列表编号？

> ID：12098860
> 
> 赞同：1
> 
> 时间：2012-08-23T19:40:34.870
> 
> 标签：jquery, html, css, list

我有一个简单的有序列表：

```
<ol>
   <li>one</li>
   <li>two</li>
   <li>three</li>
</ol> 
```

我正在使用 jQuery 创建一个可排序的列表，您可以在其中拖放以重新排序列表中的项目。但我也希望用户能够通过单击“x”图标来删除列表项，其中有序列表编号通常悬停在该图标上。右侧已被“移动”图标（三个水平线）使用。

如果我将鼠标悬停在列表项 2 上，我希望看到：

```
1\. one
X  two     =
3\. three 
```

我需要将 2 替换为 an`X`并且它是可点击的。

（注意：`=`以上是为了象征移动悬停图标，通常是三个水平线。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:48:04.603

问题是您将无法将有序列表更改为无序列表（只需像那样将数字换成 X）。

取而代之的是一个无序列表，其中的数字排列在跨度标签中，我们可以将其换成 X（图像/任何你想要的）。这样也很容易将删除事件绑定到它上面！

**css** ul li { 列表样式类型：无；}

```
<ul>
    <li><span>1.</span> one</li>
    <li><span>2.</span> two</li>
    <li><span>3.</span> three</li>
</ul> 
```

[**jsFiddle 演示**](http://jsfiddle.net/8JAka/2/)

```
$('ul li').each(function () { 
    var this$ = $(this),
        _old = $(this).find('span').text();

    this$.on({
        mouseover: function () {
            this$.find('span').text('X');
        }, 
        mouseout: function () {
            this$.find('span').text(_old);
        }
    });

    this$.find('span').on('click', function () {
         if ( $(this).text() === 'X') {
            if (confirm('Are you sure you want to Delete?')) {
                $(this).closest('li').remove();
            }
        }
    });
});
​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:47:47.293

将图像用作列表项目符号有三种好方法：

1.  用来`list-style-image`更换子弹上的`:hover`。这种方法的缺点是图像无法真正定位，并且您受图像大小的限制。

    [http://jsfiddle.net/bnickel/tCTwJ/](http://jsfiddle.net/bnickel/tCTwJ/)

    ```
    li:hover {
        list-style-image: url(x.png);
    } 
    ```

2.  用于`list-style-type: none`隐藏项目符号并使用`:before`伪元素放置图像。这在 IE7 上不起作用。

    [http://jsfiddle.net/bnickel/LVsYW/](http://jsfiddle.net/bnickel/LVsYW/)

    ```
    li {
        position: relative;
    }

    li:hover {
        list-style-type: none;
    }

    li:hover:before {
        content: '';
        width: 50px;
        height: 50px;
        position: absolute;
        top: 50%;
        margin-top: -25px;
        left: -55px;
        background-image: url(x.png);
    } 
    ```

3.  与 2 类似，您可以仔细调整元素的边距和填充，并在其中放置不重复的背景图像。这可能是最可靠的方法，但它会将您限制在一组非常特定的样式中。

    [http://jsfiddle.net/bnickel/LXe4C/](http://jsfiddle.net/bnickel/LXe4C/)

    ```
    li:hover {
        list-style-type: none;
        background-image: url(x.png);
        background-position: 0 50%;
        background-repeat: no-repeat;
        margin-left: -55px;
        padding-left: 55px;
    }​ 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:55:49.707

您可以将您的图标放在一个跨度中并绝对定位它。然后只需在 LI 悬停时显示它。

[http://jsfiddle.net/S3Ph8/1/](http://jsfiddle.net/S3Ph8/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T19:56:59.660

您可以创建一个新的 css 类来删除项目

```
li.remove
{
 background-image: url(remove.gif);
 background-repeat: no-repeat;
 background-position: 0 50%;
 padding: 3px 0 3px 20px;
 margin: .4em 0;
} 
```

然后创建一个悬停事件处理程序以将该类添加到突出显示的 li

```
$('ul li').on('hover', function (){
  $(this).toggleClass('remove');
}).on('click', function(){
   alert($(this).text());    
//take some action
}) 
```

这是给你一个粗略的想法，你需要根据你的要求调整它，当然还有一个实际的 gif

# java - 如何使用 OpenJDK 在 Fedora 17 上编译为 Java 6

> ID：12098861
> 
> 赞同：4
> 
> 时间：2012-08-23T19:40:38.033
> 
> 标签：java, fedora, openjdk

我想在 Fedora 17 上使用 OpenJDK 编译到 Java 6。Fedora 17 有 OpenJDK7，而不是 OpenJDK6。我可以使用 -target 1.6 -source 1.6 从 Java 7 编译到 Java 6，但要正确执行（避免警告：[options] bootstrap class path not set with -source 1.6），我还需要 -bootclasspath 指向到 Java 6 rt.jar 文件。但是 OpenJDK7 不提供这个 Java 6 rt.jar 文件。如何在 FC17 上正确编译 Java 6？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-11T21:34:14.013

要从 Fedora 16 安装 Openjdk 1.6，请使用以下命令：

```
yum install java-1.6.0-openjdk --releasever=16 --nogpgcheck 
```

（`--nogpgcheck`因为`yum`抱怨没有 Fedora 16 的密钥，也许有更好的方法来解决这个问题）

但这表明，它`java-1.7.0-openjdk`已过时`java-1.6.0-openjdk`并跳过安装。它表明需要该软件包`xorg-x11-fonts-Type1`。所以我做了

```
yum install xorg-x11-fonts-Type1 
```

然后我使用了由于*过时警告*`yum`而下载但拒绝安装的openjdk包

 *```
rpm --nodeps -ihv /var/cache/yum/x86_64/16/updates/packages/java-1.6.0-openjdk-1.6.0.0-68.1.11.5.fc16.x86_64.rpm 
```

（--nodeps 用于覆盖*过时的警告*）

现在我的系统上有 java 1.6 和 java 1.7。Java 1.7 是我的默认设置。Java 1.6 在`/usr/lib/jvm/jre-1.6.0-openjdk.x86_64/bin/java`.

PS：同时安装1.7和1.6**不会有任何冲突。**从 Fedora 17 中删除 1.6 的原因是，OpenJDK6[在 2012 年 11 月之后将不再获得安全更新](http://comments.gmane.org/gmane.linux.redhat.fedora.general/414703)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:09:35.920

您将需要 OpenJDK 6。

我去了[OpenJDK 的安装说明页面](http://openjdk.java.net/install/)，他们建议使用`yum`

但是，我确实验证了这不是可用于 Fedora 17 的 OpenJDK 1.6 版本（我也在运行 FC17）：

```
yum list java*-openjdk
Loaded plugins: langpacks, presto, refresh-packagekit
Available Packages
java-1.7.0-openjdk.i686    1:1.7.0.5-2.2.1.fc17.9       updates
java-1.7.0-openjdk.x86_64  1:1.7.0.5-2.2.1.fc17.9       updates 
```

这是在 superuser.com 上发布的关于[在 Fedora 17 上安装较旧的 openjdk 1.6](https://superuser.com/questions/441757/how-install-older-openjdk-1-6-in-fedora-17)的相同问题。接受的答案基本上是手动下载和安装。

如果您只是想编译到 Java 6，而不是绝对使用 OpenJDK6，我可以帮助您逐步使用 Oracle 的 JDK 1.6.0_33。那是我在 Fedora 17 上使用的 JDK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:46:54.047

如果构建不存在，请检查 fedora koji。谷歌它并搜索包。*

# django - 如何区分Django中动词和名词的翻译？

> ID：12098863
> 
> 赞同：0
> 
> 时间：2012-08-23T19:40:39.643
> 
> 标签：django

我正在尝试本地化 Django 应用程序，但我找不到任何方法来区分动词和名词的翻译。

假设我有一个单词“order”，在一种情况下用作动词，在另一种情况下用作名词。在 .po 文件中，它显示为：

```
#: .\core\order.py:747
msgid "Order"
msgstr "" 
```

有什么提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:00:11.470

上下文标记应该完全符合您的要求：[https ://docs.djangoproject.com/en/dev/topics/i18n/translation/#contextual-markers](https://docs.djangoproject.com/en/dev/topics/i18n/translation/#contextual-markers)

# c# - 布局多张发票和打印问题

> ID：12098869
> 
> 赞同：1
> 
> 时间：2012-08-23T19:41:07.210
> 
> 标签：c#, asp.net

我正在处理 asp.net 项目，我需要在单个页面上布局多个选定的发票。单击打印按钮将打印所有发票，但每张发票应打印在单独的页面上。

在 asp.net 中是可能的，或者需要手动调整布局。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:03:06.817

是的，你可以，但你需要使用 CSS 来完成`@media print`。

像这样定义一个类：

```
@media print
{
  .page-break  { display:block; page-break-before:always; }
}

@media all
{
  .page-break  { display:none; }
} 
```

并且只需`<div class="page-break"></div>`在您要在单独页面上打印的每张发票之间添加。

# javascript - 为什么 innerHTML 不改变图像的 src？

> ID：12098876
> 
> 赞同：4
> 
> 时间：2012-08-23T19:41:35.690
> 
> 标签：javascript, image, element

我必须将一个 src 设置为图像对象。然后我改变它。

但是如果我在元素中添加一些东西（元素的内容），例如

```
meaning.innerHTML += ")"; 
```

（其中含义是图像的父元素），那么如果更改对象的 src 它不会影响文档。

示例：http: [//jsfiddle.net/WcnCB/3/](http://jsfiddle.net/WcnCB/3/)

你能解释一下它为什么会发生，以及如何解决它吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T19:44:37.980

`meaning.innerHTML += ')';`做的比你想象的要多。视觉上它只是附加一个`)`字符，但在幕后发生的是：

```
meaning.innerHTML = meaning.innerHTML + ')'; 
```

因此，您首先将 DOM 转换为字符串表示 (HTML)，然后添加一个`)`字符，最后将其从 HTML 转换回 DOM。HTML 表示的所有元素都被重新创建，`meaning`并被这些新元素替换。所以你的旧的被破坏了。

最简单的解决方案是使用`createTextNode`：http: [//jsfiddle.net/WcnCB/4/](http://jsfiddle.net/WcnCB/4/)。

```
meaning.appendChild(document.createTextNode(")")); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T19:44:21.997

通过编写`innerHTML += ...`，您将覆盖以前的 HTML 并销毁对它的每个引用 - 包括`actual_button`变量。

你为什么还要使用`innerHTML += ...`？你应该这样做：

```
meaning.appendChild(document.createTextNode("(Something")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:46:33.597

当您犯下最大的罪过时，即`.innerHTML +=`（特别是`innerHTML`与 结合`+=`，它们都不是单独的坏事），会发生什么：

*   将元素的 DOM 子树序列化为 html 字符串。
*   将一些内容连接到该 html 字符串中
*   **从目标元素中删除所有元素**
*   将上面生成的 html 解析为一个新的 DOM 子树。这意味着所有元素都是新的。
*   将其附加到目标元素中

因此，鉴于此，`actual_button`指的是分离的 dom 元素。不是通过解析 html 创建的另一个 img 元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T19:51:35.367

如果您设置图像 ID 并在更改 innerHTML 后获取它，则可以使用：

```
var meaning = document.getElementById('meaning');
meaning.innerHTML += 'Something ...';

var actual_button = document.createElement('img');
actual_button.id = 'actual_button';
actual_button.src = 'http://www.pawelbrewczynski.tk/images/add.png';
actual_button.className = 'add_word';

meaning.appendChild(actual_button);
meaning.innerHTML += " ... and another.";

var actual_button= document.getElementById('actual_button');
actual_button.src = 'http://www.pawelbrewczynski.tk/images/loading.gif'; 
```

[http://jsfiddle.net/j8yEG/1/](http://jsfiddle.net/j8yEG/1/)

# c - 字符数组 c k&r 书 1-17

> ID：12098878
> 
> 赞同：1
> 
> 时间：2012-08-23T19:41:44.627
> 
> 标签：c, arrays, kernighan-and-ritchie

我正在研究 K&R，我试图编写一个程序来打印所有大于 80 个字符的输入行。一旦我从终端自己运行程序，我什么也得不到。谁能告诉我哪里出错了？还有一个我不确定的部分是这条线`s[i] = '\0';`- 有人可以向我解释一下这是做什么的吗？

```
#include <stdio.h>
#define MAXLINE 1000
#define LENGTH 80

int get_line(char line[], int maxline);

/* program to print all lines longer than 80 characters */
main()
{
    int len;    /*current line length*/
    char line[MAXLINE]; /*current input line*/

    while((len = get_line(line, MAXLINE)) > 0)  /*while length of the line is greater than zero*/
            if (len > LENGTH) { /*if the length is greater than 80*/
                    printf("%s", line); /*print that line*/
                    return 0;               
            }
}

/* getline: read a line into s, return length */
int get_line(char s[], int lim)
{
    int c, i;

        for (i=0; i<lim-1 && (c=getchar())!=EOF && c!='\n'; ++i) /*if i is < 1000 & input is = EOF & input is != newline add one*/
            s[i] = c;   /*assign a value to each character*/
    if (c == '\n') {                            
            s[i] = c;
            ++i;
    }
    s[i] = '\0';    /*unsure what '\0' does*/               
    return i;   /*return the length*/
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:02:54.877

我在您的代码中看到的唯一问题是它在打印第一行后立即停止，发现超过 80 个字符。

如果你移动

```
return 0; 
```

在 if 语句之外，它将打印超过 80 个字符的所有行，而不仅仅是第一行。

您的“主要”方法将是

```
main()
{
    int len;                                /*current line length*/
    char line[MAXLINE];                         /*current input line*/

    while((len = get_line(line, MAXLINE)) > 0)              /*while length of the line is greater than zero*/
            if (len > LENGTH)                    /*if the length is greater than 80*/
                    printf("%s", line);                 /*print that line*/

    return 0;
} 
```

正如其他人所指出的，'\0' 字符是 C 字符串终止符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:50:16.513

线

```
s[i] = '\0'; 
```

将 nul 终止符附加到字符串。那是指示字符串结尾的C-ism。

至于你的问题，这个程序对我来说很好用。

```
$ cat line80.c | ./line80
  while((len = get_line(line, MAXLINE)) > 0)              /*while length of the line is greater than zero*/

$ ./line80 < line80.c
  while((len = get_line(line, MAXLINE)) > 0)              /*while length of the line is greater than zero*/ 
```

# java - Apache Lucene TokenStream 过滤器

> ID：12098879
> 
> 赞同：0
> 
> 时间：2012-08-23T19:41:48.693
> 
> 标签：java, lucene, machine-learning

我对 Apache Lucene 库有一些疑问：

1) 如何将两个 TokenStream 对象连接成一个 TokenStream 对象？

2) 哪个过滤器可用于从 TokenStream 对象中删除所有重复的令牌（具有相同的值）？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T08:48:27.873

至于从两个来源连接，只需将两个`Field`具有相同名称的实例添加到`Document`. 这保证与连接值的单个字段相同。

至于消除重复的术语，这并不是真正必要的。Lucene 只会计算文档的词频以便给它们打更高的分数。如果您不需要，您可以定义自己的`Similarity`实例，该实例实现`tf`为常量 1。

或者，如果您只需要禁用每个字段的词频，您可以实例化`Field`with `Field.TermVector.NO`。

# php - 在php中运行程序时内存不足

> ID：12098881
> 
> 赞同：1
> 
> 时间：2012-08-23T19:42:29.937
> 
> 标签：php, xml-parsing, simplexml

我正在运行两个几乎相同的程序，除了一个只需要查看最低价格，第二个需要查看最低 4 个价格并获得平均值。我的问题是，在运行第二个程序时，出现内存不足的 php 致命错误。我的托管服务提供商已为我设置了 3000M 的内存限制，但我仍然收到错误消息。这是第一个程序的代码：

```
 $parsed_xml = amazon_xml($isbn);

$current = $parsed_xml->ListMatchingProductsResult->Products->Product;
$asin = $current->Identifiers->MarketplaceASIN->ASIN;
//print_r($asin);

// get information based on the items ASIN
$price_xml = amazonPrice_xml($asin, $ItemCondition);
$currentPrice = $price_xml ->GetLowestOfferListingsForASINResult->Product->LowestOfferListings->LowestOfferListing;
$listPrice = $currentPrice->Price->ListingPrice->Amount;

// check to see if there are values
if(!empty($listPrice))
{  
            //print_r($listPrice); die;
//if($currentPrice->Price->ListingPrice->Amount > 0) {
    while(count($lowestPrices) < 2)
    {

            foreach($currentPrice as $offer){ 
                $totalFeedback = $offer->SellerFeedbackCount;

                $condition = $offer->Qualifiers->ItemSubcondition;

                //amazon condition matching algorithm (so we can match our condition up against amazons conditions)
                switch ($condition) {
                case "New":
                    $amazonCondition = 5;
                    break;
                case "Mint":
                    $amazonCondition = 4;
                    break;
                case "VeryGood":
                    $amazonCondition = 3;
                    break;
                case "Good":
                    $amazonCondition = 2;
                    break;
                case "Acceptable":
                    $amazonCondition = 1;
                    break;
                default:
                    $amazonCondition = 0;
                } // end of switch statement

            //echo $condition . "|" . $ourCondition . "|" . $amazonCondition . "|" . count($lowestPrices) . "|" . $totalFeedback . "|" . $merchantId . "<br/>";

            /* default lowest 1 */
                if(count($lowestPricesDefault[$a] <2)){
                $lowestPricesDefault[$a] = str_replace('$','',$offer->Price->ListingPrice->Amount);
                $a++;
                }

                if( ($ourCondition <= $amazonCondition) && ($totalFeedback >= 1500) &&  (count($lowestPrices) <2) )
                {
                $lowestPrices[$x] = str_replace('$','',$offer->Price->ListingPrice->Amount);
                $x++;
                }

            }
        $z++;
    }

    if(count($lowestPrices) > 0){
        $avgPrice = (array_sum($lowestPrices)/count($lowestPrices)) - .10;
        $source = "Amazon Condition Price";
    }else{
        //$avgPrice = $listPrice - ($listPrice * 0.25);
        $avgPrice = (array_sum($lowestPricesDefault)/count($lowestPricesDefault)) - .10;
        $source = "Default Pricing";
    }

    //make sure avg price is atleast 5.50, >236% of follett price, and >=200% of our cost
    if($avgPrice < ($follettPrice * 2.37)){
        $avgPrice = $follettPrice * 2.37;
        $source = "Follett Pricing";
    }
    if($avgPrice < ($row['cost'] * 2)){
        $avgPrice = $row['cost'] * 2;
        $source = "Double Cost";
    }
    if($avgPrice < 5.50){
        $avgPrice = 5.50;
        $source = "Lowest Base Cost";
    }

    //update Prices
    $conn->query("UPDATE inventory SET ourPrice = $avgPrice WHERE sku=" . $row['sku']); 
```

这是第二个程序：

```
 $parsed_xml = amazon_xml($isbn);

$current = $parsed_xml->ListMatchingProductsResult->Products->Product;
$asin = $current->Identifiers->MarketplaceASIN->ASIN;

// get information based on the items ASIN
$price_xml = amazonPrice_xml($asin, $ItemCondition);
$currentPrice = $price_xml ->GetLowestOfferListingsForASINResult->Product->LowestOfferListings->LowestOfferListing;
$listPrice = $currentPrice->Price->ListingPrice->Amount;

// check to see if there are values
if(!empty($listPrice))
{  
//if($price_xml) {
    while(count($lowestPrices) < 4 ) // changed count to 4 per loralee's email 5-1-2012
    {

        foreach($currentPrice as $offer){
            $totalFeedback = $offer->SellerFeedbackCount;

            $condition = $offer->Qualifiers->ItemSubcondition;

                //amazon condition matching algorithm (so we can match our condition up against amazons conditions)
                switch ($condition) {
                case "New":
                    $amazonCondition = 5;
                    break;
                case "Mint":
                    $amazonCondition = 4;
                    break;
                case "VeryGood":
                    $amazonCondition = 3;
                    break;
                case "Good":
                    $amazonCondition = 2;
                    break;
                case "Acceptable":
                    $amazonCondition = 1;
                    break;
                default:
                    $amazonCondition = 0;
                }

            //echo $condition . "|" . $ourCondition . "|" . $amazonCondition . "|" . count($lowestPrices) . "|" . $totalFeedback . "|" . $merchantId . "<br/>";

            /* default lowest 4 */
            if(count($lowestPricesDefault[$a] < 4)){ //changed to 4 per new pricing specs
                $lowestPricesDefault[$a] = str_replace('$','',$offer->Price->ListingPrice->Amount);
                $a++;
            }

            if( ($ourCondition <= $amazonCondition) && ($totalFeedback >= 99) &&  (count($lowestPrices) < 4) ) //changed to 4 per new pricing specs
            {
                $lowestPrices[$x] = str_replace('$','',$offer->Price->ListingPrice->Amount);
                $x++;
            } 
        }
        $z++;
    }

    if(count($lowestPrices) > 0){
        $avgPrice = array_sum($lowestPrices)/count($lowestPrices);
        $source = "Amazon Condition Price";
    }else{
        //$avgPrice = $listPrice - ($listPrice * 0.25);
        $avgPrice = array_sum($lowestPricesDefault)/count($lowestPricesDefault);
        $source = "Default Pricing";
    }

    //make sure avg price is atleast 5.50, >236% of follett price, and >=200% of our cost
    if($avgPrice < ($follettPrice * 2.37)){
        $avgPrice = $follettPrice * 2.37;
        $source = "Follett Pricing";
    }
    if($avgPrice < ($row['cost'] * 2)){
        $avgPrice = $row['cost'] * 2;
        $source = "Double Cost";
    }
    if($avgPrice < 5.50){
        $avgPrice = 5.50;
        $source = "Lowest Base Cost";
    }

    //update fillzPrice
    $conn->query("UPDATE inventory SET ourPrice = $avgPrice WHERE sku=" . $row['sku']); 
```

我在第二个程序的第 86 行收到错误，这是条件行 ($condition = $offer->Qualifiers->ItemSubcondition;) 有人知道为什么会这样吗？另外，有没有人有任何建议让它运行得更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T13:41:58.007

首先，两个代码审查点：

1.  您有变量`$a`、`$x`和`$z`，它们都没有初始条件，并且对于任何试图维护代码的人来说都是完全不透明的。单个`$i`作为循环计数器通常被认为是可以接受的，但是好的变量命名可以使调试更容易。
2.  使用 SimpleXML 时，始终将值转换为字符串：`$asin = $current->Identifiers->MarketplaceASIN->ASIN;`应该阅读`$asin = (string)$current->Identifiers->MarketplaceASIN->ASIN;`除其他事项外，忘记这样做将意味着`$asin`永远无法将其保存到会话中（因为 SimpleXML 对象无法序列化）。

至于你的代码为什么失败，我认为你的循环结构是错误的：

```
while(count($lowestPrices) < 4 )
{
    foreach($currentPrice as $offer)
    {
        // Do something which may add to `$lowestPrices`
        $z++;
    }
} 
```

首先，`$z`似乎没有用于任何事情。其次，可能会在循环`$lowestPrices`内部添加 0、1、4 甚至 100 次。`foreach`如果加到至少4次，`while`循环会立即退出（所以还不如不存在）；如果它被添加到少于 4 次，`foreach`循环将简单地在相同的数据上再次运行。我不清楚这是否会使其更有可能满足`while`循环条件，从而为您提供无限循环。

您内存不足的原因，而不仅仅是 CPU 时间，是额外的数组`$lowestPricesDefault`即使`$lowestPrices`没有增长，所以每次`while`循环（以及整个内部`foreach`循环）重复时它都会无限期地增长。

# apache-flex - 在 Flex 4 中修改 PasteOperation 的内容

> ID：12098884
> 
> 赞同：1
> 
> 时间：2012-08-23T19:43:06.320
> 
> 标签：apache-flex, flex4

我需要在我的 Flex 4 应用程序中捕获和修改粘贴操作的内容。我正在监听 TextOperation.CHANGING 事件，取出 PasteOperation，并设置它的 textScrap 属性。一切似乎都在工作，除了在我修改 textScrap 之后，在粘贴中添加了一个换行符。我创建了一些示例代码来说明问题的最简单版本。我实际上并没有更改副本，我正在获取现有的 textScrap 的 textFlow，用它创建一个新的 TextScrap，并将其设置在 PasteOperation 上。我这样做是为了排除创建 TextFlow 的问题：

```
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>

<fx:Script>
    <![CDATA[
        import flash.desktop.Clipboard;
        import flash.desktop.ClipboardFormats;

        import flashx.textLayout.edit.TextScrap;
        import flashx.textLayout.elements.TextFlow;
        import flashx.textLayout.operations.PasteOperation;
        import flashx.textLayout.tlf_internal;

        import spark.events.TextOperationEvent;

        use namespace tlf_internal;

        protected function textArea_changingHandler(event:TextOperationEvent):void
        {
            if (event.operation is PasteOperation)
            {
                var pasteOp:PasteOperation = event.operation as PasteOperation;

                pasteOp.textScrap = new TextScrap(pasteOp.textScrap.textFlow);
            }
        }

    ]]>
</fx:Script>
<s:TextArea id="textArea" changing="textArea_changingHandler(event)"/>
</s:Application> 
```

提前致谢，

格里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T19:53:51.340

这似乎是 Adob​​e 在 sdk 4.6 中修复的错误。

作为一些附加信息，将上面的 pasteOp.textScrap 行替换为：

pasteOp.textScrap = pasteOp.textScrap.clone() 用于抛出空指针异常，现在在 4.6 中也可以使用。

此外，此错误仅在 textarea / textinput 为空时出现。如果那里已经有东西，一切都会按预期进行。

# mongodb - 如何使用 c# 代码在 mongodb 服务器上运行排序和过滤

> ID：12098885
> 
> 赞同：1
> 
> 时间：2012-08-23T19:43:09.603
> 
> 标签：mongodb, mongodb-.net-driver

我找到了这样的 c# 代码（`Collection`是这里的类型`MongoCollection<T>`）：

```
Collection.AsQueryable()
   .OrderByDescending(i => i.SomeField)
   .Where(i => i.OtherField == "bla-bla") 
```

不像我预期的那样在服务器上同时运行排序（OrderBy）和过滤（Where），而是使用MongoDb引擎调用排序，并且所有进一步的过滤都在客户端处理，这需要相当多的时间。作为代码执行的结果，我在 Mongodb 分析器中发现的内容：

```
"query" : {
    "$query" : { },
    "$orderby" : {
       "SomeField" : -1
    }
 } 
```

注释`$query`为空。好吧，关于如何使它在数据库上工作（排序和过滤）有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:57:17.700

好吧，我刚刚找到的解决方案之一可能如下所示：

```
Collection.Find(
  Query.And(Query.EQ("OtherField", "bla-bla")).
  SetSortOrder(SortBy.Descending("SomeField").ToList() 
```

它完全符合我的需要：

```
"query" : {
    "$query" : {
       "OtherField" : "bla-bla"
     },
    "$orderby" : {
       "SomeField" : -1
     }
 } 
```

但是我不太喜欢这种方法，因为它让我对数据库字段名称进行硬编码。据推测，新的 c# 驱动程序 1.6 将允许您使用委托（如`i => i.OtherField == "bla-bla"`.

还有其他方法吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-08T20:37:33.193

要订购物品，必须检索所有物品，因此如果您将其指定为第一个操作，我希望您观察到的行为。所以你必须颠倒你的陈述（就像你在`IMongoQuery`语法中所做的那样）。这也可以在 LINQ 语法中完成，但由于`Where`返回`IEnumerable`，你需要一个额外的演员：

```
Collection.AsQueryable()
   .Where(i => i.OtherField == "bla-bla").AsQueryable()
   .OrderByDescending(i => i.SomeField) 
```

# wordpress - 通过 localtunnel 访问在 localhost 上运行的 WordPress 站点

> ID：12098886
> 
> 赞同：2
> 
> 时间：2012-08-23T19:43:22.363
> 
> 标签：wordpress, localhost, share, local, tunnel

我通过 localtunnel (http://progrium.com/localtunnel/) 共享静态站点没有问题，但我似乎无法让 WordPress 站点工作。

我的本地 WordPress 站点在 MAMP 服务器上运行，没有任何问题。

我也不确定是什么问题。我在想这可能与无法访问 MySQL 数据库有关？

谁能告诉我如何通过 localtunnel 访问在 localhost 上运行的 WordPress 站点？

谢谢阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T07:00:48.707

我在 localtunnel 方面没有大量经验，但 Forward 确实支持 WordPress，并且有一个关于如何使其工作的常见问题解答：[https ://forwardhq.com/support/faq#how-do-i-use-forward- with-wordpress](https://forwardhq.com/support/faq#how-do-i-use-forward-with-wordpress)，它可能会帮助您追踪您的问题......或者至少为您提供另一种选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-20T21:09:13.883

把它放在你的 wp-config 中：

```
/* THIS IS CUSTOM CODE CREATED AT ZEROFRACTAL TO MAKE SITE ACCESS DYNAMIC */
/* WORKS FOR LOCALTUNNEL!!!!!! */

$currenthost = "http://".$_SERVER['HTTP_HOST'];
$currentpath = preg_replace('@/+$@','',dirname($_SERVER['SCRIPT_NAME']));
$currentpath = preg_replace('/\/wp.+/','',$currentpath);
define('WP_HOME',$currenthost.$currentpath);
define('WP_SITEURL',$currenthost.$currentpath);
define('WP_CONTENT_URL', $currenthost.$currentpath.'/wp-content');
define('WP_PLUGIN_URL', $currenthost.$currentpath.'/wp-content/plugins');
define('DOMAIN_CURRENT_SITE', $currenthost.$currentpath );
define('ADMIN_COOKIE_PATH', './');
define('FS_METHOD', 'direct');
define( 'WP_ENVIRONMENT_TYPE', 'local' ); 
```

我在没有 WP_CONTENT_URL、WP_PLUGIN_URL 和 ADMIN_COOKIE_PATH 的情况下成功使用了它，但将它们包括在此处是因为它们位于此处的原始代码中：[https ://wordpress.stackexchange.com/questions/179559/relative-or-dynamic-site-可能的网址](https://wordpress.stackexchange.com/questions/179559/relative-or-dynamic-site-url-possible)

# sql - 为什么“Null Like X”和“Not (Null Like X)”相等？

> ID：12098887
> 
> 赞同：3
> 
> 时间：2012-08-23T19:43:36.733
> 
> 标签：sql, null, sql-like

我明白为什么这两个陈述是错误的

```
NULL LIKE 'X'
NULL NOT LIKE 'X' 
```

但是，我不明白为什么这些是：

```
NOT (NULL LIKE 'X')
NOT (NULL NOT LIKE 'X') 
```

例如，我认为这两个语句应该返回不同的值：

```
SELECT CASE WHEN NOT (NULL LIKE 'X') THEN 'True' ELSE 'False' END
SELECT CASE WHEN     (NULL LIKE 'X') THEN 'True' ELSE 'False' END 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T19:47:23.127

SQL 使用[三值逻辑](http://en.wikipedia.org/wiki/Null_%28SQL%29#Three-valued_logic_.283VL.29)。你说这些都是假的：

```
NULL LIKE 'X'
NULL NOT LIKE 'X'
NOT (NULL LIKE 'X')
NOT (NULL NOT LIKE 'X') 
```

但事实并非如此。它们都是空的，*既不是*真的*也不是*假的。

`WHEN`or子句拒绝非真值`WHERE`，这意味着空值和假值，所以看起来 null 与假相同，但正如您所注意到的，事实并非如此。:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:48:27.707

`NULL`总是`NULL`你无法将它与类似的东西进行比较。您正在寻找的答案不能是真或假。

就像您无法比较一样，这将始终返回零行，因为`NULL`它是一个未知值。

```
SELECT *
FROM yourTable 
WHERE yourCol = NULL 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T19:49:22.533

NULL 始终未定义。

所以价值

```
not (NULL like X) is undefined 
```

并且

```
not (NULL not like X) is undefined 
```

Undefined 的最佳近似值是 NULL，因此两个语句都评估为 NULL（不是，你明白，等于 NULL，我们不知道它们等于什么）

# java - Coq 作为持续集成的一部分

> ID：12098890
> 
> 赞同：5
> 
> 时间：2012-08-23T19:43:57.967
> 
> 标签：java, maven, continuous-integration, coq

在我当前的项目中，我们使用 Java 和 Coq。我们使用 maven 设置了持续集成。我们想检查 coq 文件作为其中的一部分。即我们需要：

*   如果未安装 coq，请在本地下载并安装它（就像 maven 对 gwt 等框架所做的那样）
*   检查 coq 文件是否正确

有人尝试设置这个吗？如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T10:28:01.897

我不建议从您的 CI 构建中自动执行该操作。相反，它看起来更像是机器配置依赖。

在这种情况下，值得依赖 Puppet 和 Vagrant 等工具来确保您的开发环境符合给定的上下文，因此您的代码需要将其作为一个前提来处理，或者——更好的是——确保它是在您的 PATH 中可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-09T14:04:32.897

我知道这是一个非常古老的问题，但我有不同的答案。

我有一个类似的 CI 设置，需要安装构建工具。在某些情况下，例如在 bitbucket 上，我会预先构建一个包含工具的 docker 映像，并在每次更新工具时更新构建配置。在 bitbucket 中，这很有效，因为正在构建的包的源代码指向用于构建它的特定 docker 镜像版本，这确保了旧版本仍然可以构建，假设旧的 docker 镜像被保留。

否则，我只是根据需要使用 wget 或 curl 编写工具安装脚本以下载。

# php - 使用 PHP/MySQL 和 JavaScript 填充几个 HTML Div

> ID：12098893
> 
> 赞同：1
> 
> 时间：2012-08-23T19:44:06.803
> 
> 标签：php, javascript, jquery, mysql, html

我注意到这里有几个线程，并通过谷歌搜索如何做到这一点，但我需要一些更具体的东西来满足我的需要，因为我对 PHP 还很陌生。希望有人可以提供帮助。

我有一个包含 5 个 Div 的页面（我们只称它们为 1-5）。我有一个名为“用户”的 MYSQL 数据库，其中包含“ID”（主键）、“成员”、“评论”和“位置”列。

我想用这个数据库中的行随机填充每个 Div 并显示来自上述列的信息。

任何人都可以指导我从哪里开始，或者可以给我满足上述标准的示例代码吗？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:13:38.210

这是一个普遍的答案：

1) 在 PHP 中建立与您的数据库的连接。像这样的东西：

```
$connection = mysql_connect($host,$username,$password); 
```

2）查询数据库：

```
mysql_select_db($schema, $connection);

$result = mysql_query("Put your sql query here..."); 
```

3）循环结果并将它们回显到屏幕上，

```
while($row = mysql_fetch_array($result))
{
    echo $row['mysql_column_name_here'];
} 
```

# three.js - 使用 Three.JS 为铺开的地毯制作动画 - 有什么想法吗？

> ID：12098897
> 
> 赞同：0
> 
> 时间：2012-08-23T19:44:27.800
> 
> 标签：three.js

我是初学者到中等技能，我可以创建具有许多多边形的网格，我需要对其进行纹理映射，我可以处理，但是，如何使其卷起和展开（我可以处理关键帧动画 - 但是，我只是不不知道怎么做才能使地毯展开或卷起。可以是地毯或纸巾卷，只需要知道如何制作效果？有教程如何使用 Cinema 4D 或 Maya 进行制作 - 但是，我想要在 Three.js 框架内的网站上做。有什么想法吗？？？或者有没有办法从 Blender 或 Maya 导出动画数据？
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T23:02:04.130

也许这个？

[http://mrdoob.github.com/three.js/examples/webgl_animation_cloth.html](http://mrdoob.github.com/three.js/examples/webgl_animation_cloth.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:39:27.030

您也可以尝试使用这个 as3mod 端口 for three.js 手动“滚动”飞机。[http://nikos-web-development.netai.net/blog/mod3-a-javascript-port-of-as3mod-for-three-js/](http://nikos-web-development.netai.net/blog/mod3-a-javascript-port-of-as3mod-for-three-js/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T23:32:04.220

1.  让我们在 youtube 上搜索在 Blender 或 Maya 中创建动画的教程（例如： [http](http://www.youtube.com/watch?v=tN_FZiTbaG0) ://www.youtube.com/watch?v=tN_FZiTbaG0 ）
2.  创建动画并将场景导出为 collada (.dae) 格式
3.  使用 collada 加载程序“webgl_loader_collada_keyframe.html”示例文件来运行您的动画。（在示例文件中将“pump.dae”替换为您刚刚导出的动画。）

# mysql - mysql选择30天范围内的日期

> ID：12098899
> 
> 赞同：7
> 
> 时间：2012-08-23T19:44:32.387
> 
> 标签：mysql, date

这一定很简单，但我摆弄它，并没有得到我想要的任何东西。我有以下代码：

```
SELECT id,title,start_date 
  FROM events 
 WHERE start_date > DATE_SUB(NOW(), INTERVAL 1 MONTH) 
  AND city = '$cityName' 
ORDER BY start_date DESC 
```

现在这会选择本月日期的事件，但查询中显示的本月定义与我需要的不同。我需要它在 30 天内向我展示事件，而不仅仅是本月，即 8 月。如果我在 8 月插入一个事件，它会显示结果。如果我确实插入了 9 月，即使距离它不到 30 天，它也不会插入。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-08-23T19:45:38.783

您应该更改`1 MONTH`为`30 DAY`：

```
WHERE start_date > NOW() - INTERVAL 30 DAY 
```

要将其限制为任一方向的 30 天：

```
WHERE start_date > NOW() - INTERVAL 30 DAY
AND start_date < NOW() + INTERVAL 30 DAY 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:51:53.027

像这样怎么样：

```
...WHERE DATE(start_date) BETWEEN DATE_SUB(NOW(),INTERVAL 30 DAY) and DATE_SUB(NOW(),INTERVAL 1 DAY) AND city... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-25T12:02:24.200

或者

`AND TIMESTAMPDIFF(DAY,YOURDATE,now()) < 30`

这为您提供了 30 天的跨度

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-17T10:21:59.710

我希望这也会有所帮助

```
SELECT id,title,start_date 
  FROM events 
 WHERE  city = "$cityName" AND 
TIMESTAMPDIFF(DAY,start_date,now()) < 30   
ORDER BY start_date DESC 
```

# haskell - 如何在我的 Traveler 实现中最好地表达这种关系

> ID：12098908
> 
> 赞同：4
> 
> 时间：2012-08-23T19:45:00.897
> 
> 标签：haskell, data-structures

我正在整理一个 Traveler 实现，并从定义我的数据结构开始。我在尝试定义`Ship`. 我从一些简单的`data`定义开始。

```
data Ship = Ship Cargo Hull Weapons Engines

data Cargo = WholeMagilla
           | MostOfIt
           | HalfOfIt
           | SomeOfIt

data Hull = Heavy
          | AboveAverage
          | Average
          | Meh

data Weapons = WarMonger
             | BadMofo
             | CautiousCarl
             | Pacifist

data Engines = WarpSuperFast
             | WarpFairlyFast
             | WarpFast
             | Turtle 
```

现在这是我的问题。我想根据其他类型的值来限制一个类型可以是什么值。示例：可能`Ship`是

```
Ship WholeMagilla Heavy Pacifist Turtle
Ship WholeMagilla Meh   WarMonger Turtle
Ship WholeMagilla Meh Pacifist WarpSuperFast 
```

因此，如果 a`Player`有足够`Credits`的值，它们最多可以有两种类型的最大值，代价是最小化其余的值。那么，在这两者之间有所有的可能性。我开始可视化一个图形，其路径由该路径中已有的节点决定。这有助于我思考问题，但不能帮助我编写一个能够得到我想要的结果的函数。有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:01:32.653

您可以将“信用”与您的对象相关联并使用智能构造函数。然后，将所有内容包装在一个模块中，只导出智能构造函数，而不导出构造`Ship`函数，这样用户就不会误用它。

这是代码（为简单起见，我已经剥离了您的构造函数）：

```
data Ship = Ship Cargo Hull deriving Show  

class Credit a where                                                       
    credit :: a -> Int   

instance Credit Cargo where
    credit WholeMagilla = 1        
    credit MostOfIt = 2

instance Credit Hull where 
    credit Heavy = 1       
    credit AboveAverage = 2       

data Cargo = WholeMagilla                                                  
           | MostOfIt deriving Show

data Hull = Heavy                                                          
          | AboveAverage deriving Show

max_credit :: Int
max_credit = 3

ship :: Cargo -> Hull -> Ship
ship c h                                                                   
    | credit c + credit h < max_credit = Ship c h 
    | otherwise = error "Too many credits"  

main :: IO ()                                                              
main = do                                                                  
    print $ ship WholeMagilla Heavy     
    print $ ship WholeMagilla AboveAverage 
```

# php - 有没有办法在 PHP 中的子进程执行结束时获取环境状态？

> ID：12098912
> 
> 赞同：1
> 
> 时间：2012-08-23T19:45:54.820
> 
> 标签：php

当我的 PHP 脚本运行一个子进程（使用任何相关函数，例如`exec()`, `system()`, `passthru()`, `popen()`, `proc_open()`, 以及我忘记的其他函数）时，我可以控制进程开始的环境变量的值（或者通过更改脚本的环境本身，或者，至少在 的情况下`proc_open()`，通过将所需的环境作为参数传递）。但是有没有办法让我的脚本获取进程完成的环境状态（即进程可能会更改环境，我希望我的脚本能够跟踪这些更改）。使用`getenv()`是无用的，因为脚本的环境不会被子进程改变。关于这是否可以做到以及如何做到的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T15:01:34.217

所以，我不喜欢它，但这就是我想出的：我编写了一个脚本，将整个环境输出为一行，我在调用过程之后立即调用它，作为一部分相同的命令。之后，我可以分析输出，从最后一行中提取环境，然后丢弃它，以便处理原始进程的输出。

有很多选项可以实现这一点。我所做的大致如下：

1) 创建一个 Python 脚本，命名它，例如`printenv`，它看起来像这样：

```
#!/usr/bin/python2.7
import os
print os.environ 
```

2）在调用我的流程时，而不是`<some command>`我调用`<some command> && printenv`.

当然，脚本不必是 Python 的，也不必以 Python 的`print`格式输出环境。（但这种格式相当方便，例如可以传递给 JavaScript 赋值。）

# css - 浮动 div 不会扩展正文宽度

> ID：12098919
> 
> 赞同：0
> 
> 时间：2012-08-23T19:46:24.573
> 
> 标签：css, html, document-body

我正在尝试开发一个具有固定高度和可变宽度的水平网页。

为了得到它，我需要一排浮动`<div>`的s来扩大`<body>`宽度。

```
|------------- body --------------|   /* variable width */
  |-div-| |-div-| |-div-| |-div-|     /*  fixed width   */ 
```

以下代码似乎不起作用：

```
body{
  height: 40px;
}

div{
    width: 2000px;
    height: 20px;
    background: red;
    margin: 10px;
    float: left;
 } 
```

[http://jsfiddle.net/7cS2R/12/](http://jsfiddle.net/7cS2R/12/)

是否可以在不使用 javascript 的情况下这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:57:19.097

块元素扩展到其父元素宽度的整个宽度。为了让他们尊重他们的孩子，您可以声明：

```
display: inline-block; 
```

或者

```
position:absolute; 
```

在你的身体元素上。

编辑：在你澄清你的问题之后 - 只需将`white-space`声明添加到你的身体：

```
white-space:nowrap; 
```

**[演示](http://jsfiddle.net/poikl/7cS2R/13/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:55:08.203

尝试这个：

```
body{
height: 40px;
display: inline-block;
} 
```

[http://jsfiddle.net/7cS2R/6/](http://jsfiddle.net/7cS2R/6/)

# c# - 如何在 .Net 中调整（缩小）EMF（元文件）的大小？

> ID：12098924
> 
> 赞同：7
> 
> 时间：2012-08-23T19:46:40.313
> 
> 标签：c#, .net, image, drawing

我有一个 EMF 文件。我想把它调整得更小。

我如何在.net（或任何工具）中做到这一点**而不会得到模糊的图像**？

生成的调整大小的图像将转换为另一种格式（png/jpg/whatever），我可以处理（我认为）。

我没有在.Net（或任何语言平台）中找到一个处理 emf/元文件的明确示例。

我查看了*使用 GDI+ 进行图形编程，*但它只介绍了元文件。

我已经尝试过 Image Magick，但您必须转换为另一种格式（无论如何我都需要这样做），结果是模糊的（例如，当缩小并转换为 png 时）。

我尝试过 Inkscape，但您只能导入 EMF 文件，而 Inkscape 将其*颠倒* 并不成比例地导入到现有绘图中。

另外，（别笑）我已经在 Window's Paint（少数几个可以打开 emf 的图像编辑软件程序之一）中打开它并调整了绘图的大小，但它又是模糊的。

更新：这是我用来调整大小的代码。

这可行，但生成的图像模糊。该代码只是一个通用的图像大小调整例程，并不特定于 EMF

```
private static Image resizeImage(Image imgToResize, Size size)
{
    int sourceWidth = imgToResize.Width;
    int sourceHeight = imgToResize.Height;

    float nPercent = 0;
    float nPercentW = 0;
    float nPercentH = 0;

    nPercentW = ((float)size.Width / (float)sourceWidth);
    nPercentH = ((float)size.Height / (float)sourceHeight);

    if (nPercentH < nPercentW)
        nPercent = nPercentH;
    else
        nPercent = nPercentW;

    int destWidth = (int)(sourceWidth * nPercent);
    int destHeight = (int)(sourceHeight * nPercent);

    Bitmap b = new Bitmap(destWidth, destHeight);
    Graphics g = Graphics.FromImage((Image)b);
    g.InterpolationMode = InterpolationMode.HighQualityBicubic;

    g.DrawImage(imgToResize, 0, 0, destWidth, destHeight);
    g.Dispose();

    return (Image)b;
} 
```

资料来源： [http ://www.switchonthecode.com/tutorials/csharp-tutorial-image-editing-saving-cropping-and-resizing](http://www.switchonthecode.com/tutorials/csharp-tutorial-image-editing-saving-cropping-and-resizing)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T20:14:34.907

我使用以下代码（类似于编辑后的代码）来调整 emf 图像的大小。它似乎并没有变得模糊。

```
var size = new Size(1000, 1000);

using(var source = new Metafile("c:\\temp\\Month_Calendar.emf"))
using(var target = new Bitmap(size.Width, size.Height))
using(var g = Graphics.FromImage(target))
{
    g.DrawImage(source, 0, 0, size.Width, size.Height);
    target.Save("c:\\temp\\Month_Calendar.png", ImageFormat.Png);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T20:16:13.433

.Net 可以加载和绘制 EMF：

```
Metafile myMetafile = new Metafile("SampleMetafile.emf");
graphics.DrawImage(myMetafile, 100, 100); 
```

如果结果图像模糊，请考虑另存为具有无损压缩的 PNG/GIF，或渲染为更大的图像。

如果结果仍然不够好，那么需要使用 GDI32 来加载和渲染。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-02T07:22:14.277

EMF 调整大小可能非常棘手。您可以在较小的位图中栅格化图像，但结果并不总是您所期望的。以下是视图策略的结果：

[![3种不同的策略](../Images/f9ee3d3f92ff24c4fc066c09f72f4c17.png)](https://i.stack.imgur.com/FYnhd.png)

对于我自己的项目，我决定使用最后一种策略：将 EMF 放大 4 倍于 EMF 大小的位图中，将其保存为 PNG，然后将 PNG 保存在一个较小的文件中。

我写了一篇关于这个主题的博客：[Rasterizing EMF files with .Net / C#](https://keestalkstech.com/2016/06/rasterizing-emf-files-with-net-c/)。我[在 GitHub 上创建了一个类](https://github.com/KeesCBakker/KeesTalksTech-Utility-Pack/blob/master/KeesTalksTech-Utility-Pack/KeesTalksTech.Utilities/Graphics/MetafileUtility.cs)来帮助调整 EMF 的大小，但它是一种稍微复杂的做事方式（带有边界框）。

# java - 将输入文件传递到转换器

> ID：12098933
> 
> 赞同：0
> 
> 时间：2012-08-23T19:47:19.757
> 
> 标签：java, xml, xslt

我希望能够使用单独的 main 方法将我的输入文件和输出文件传递到这个程序中。我的意图是通过 GUI 访问它。

```
public class SimpleTransform {
    public static void main(String[] args) throws TransformerException, TransformerConfigurationException, FileNotFoundException, IOException {  
        // Use the static TransformerFactory.newInstance() method to instantiate 
        TransformerFactory tFactory = TransformerFactory.newInstance();
        Transformer transformer = tFactory.newTransformer(new StreamSource("demiprocess.xsl")); 
        transformer.transform(new StreamSource("Anzer.xml"), new StreamResult(new FileOutputStream("lee.xml")));
        System.out.println("*The result is in birds.out ***");
    }
} 
```

这是我尝试过的，但我不断收到错误：

```
public class Simple {
    private String xmlFile ;
    private String xslFile;
    private String  outputFile;

    /**
     * Constructor for objects of class Simple
     */
    public Simple(String xmlFile, String xslFile,String outputFile) {
        this.xmlFile = xmlFile;
        this.xslFile = xslFile;
        this.outputFile= outputFile;
    }

    public String SimpleTransform() throws TransformerException,TransformerConfigurationException,FileNotFoundException, IOException {
        String mystring = "";
        TransformerFactory tFactory = TransformerFactory.newInstance();
        Transformer transformer = tFactory.newTransformer(new StreamSource(xslFile));
        transformer.transform(new StreamSource(xmlFile), new StreamResult(new FileOutputStream(outputFile)));
        return mystring = "***The result is in birds.out *****";
    } 
} 
```

我收到此错误“file:///C:/Users/Abiodun/Desktop/New%20system/new%20system/demiprocess.xsl；第 1 行；第 10 列；样式表需要属性：版本”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:58:45.513

您的 XSL 文件声明中似乎缺少 version 属性。它是从类似的东西开始的吗？

```
<?xml version="1.0" encoding="UTF-8"?><xsl:stylesheet 
  version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> 
```

# ios - UIImageView 内容模式和比例因子

> ID：12098937
> 
> 赞同：2
> 
> 时间：2012-08-23T19:47:41.833
> 
> 标签：ios, uiimageview, retina-display

我有一个以编程方式创建的 UIImage 图像，使用这种代码：

```
UIGraphicsBeginImageContextWithOptions(CGSizeMake(128, 128), NO, 0.0f);
// Render in context
UIImage *resultImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

由于我的上下文选项指定比例为 0，因此在视网膜设备上它将设置为 2，我可以在生成的 UIImage 比例属性上确认这一点。

现在，问题是该图像尺寸为 128x128，比例为 2。当我将其放入尺寸为 64x64 且 contentMode = Center 的 UIImageView 中时，它会将我的图像渲染到 imageview 之外，大概会渲染到 128x128 的盒子中而没有任何缩放。

我对视网膜图形的理解是，如果图像的比例因子为 2.0，则它应该以 1/2 大小渲染，从而导致更高的 DPI。所以我期待图像视图以视网膜质量渲染 64x64 图像。我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:55:17.227

图像将以您给定的尺寸渲染 - 128 x 128。比例因子意味着您将拥有更好的渲染曲线等，但图像仍将是 128 x 128 点。如文档中所述，大小参数为：

> 新位图上下文的大小（以磅为单位**）**。这表示 UIGraphicsGetImageFromCurrentImageContext 函数返回的图像的大小。

如果您想要视网膜质量的 64x64 图像，请为您的上下文使用 64x64 大小。

# php - 如何通过 RabbitMQ (amqp) 将 PHP 生产者与 NodeJS 消费者连接起来？

> ID：12098942
> 
> 赞同：0
> 
> 时间：2012-08-23T19:48:01.047
> 
> 标签：php, node.js, rabbitmq, amqp

我尝试了很多方法来做这个萌芽，但没有任何好的进展。所以我通过 pecl 为 php 安装了 amqp 扩展，为 nodejs 和 rabbitmq-server 安装 amqp 和 rabbit.js，一切都在单独工作:)

场景是：PHP -> 向 RabbitMQ 发送消息 -> NodeJS 消费者（守护进程） -> 接收消息

# windows - Windows 7 上的 Bonjour 服务器注册不会持续

> ID：12098944
> 
> 赞同：0
> 
> 时间：2012-08-23T19:48:04.653
> 
> 标签：windows, bonjour

在 Windows 7 上使用 Bonjour 注册服务，在大约 5 到 10 分钟左右的时间后，服务出现“活动”和“可发现”的问题。

已经用命令行工具重复了这个问题

```
dns-sd -R CMD-TEST  _test._tcp "" 4667 
```

使用 windows 和 IOS 上的各种工具（发现），服务将出现大约 5 分钟，然后使用命令行工具和/或代码消失。在具有相同代码的 IOS 上，它不会消失。

关于这个的任何提示/线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T20:26:27.243

必须为传入和传出 UDP 打开端口 5353。

# wcf - WCF 客户端对 DataContracts 的引用（“Datasources”自动生成）

> ID：12098945
> 
> 赞同：0
> 
> 时间：2012-08-23T19:48:07.790
> 
> 标签：wcf, datacontracts

我有一个引用两个程序集的客户端：一个 WCF 服务和包含 dataContracts 的 DLL。

同时，客户端使用 WCF Service 的 WSDL。问题是服务引用不代理 DataContracts（只是服务方法）。相反，它将 DataContracts 放入“Properties/DataSources/”文件夹中。每个都有一个扩展“数据源”打开时，我得到一个如下所示的 XML：

```
<?XML version="1.0" encoding="utf-8"?>
<!--
    This file is automatically generated by Visual Studio .Net. It is 
    used to store generic object data source configuration information.  
    Renaming the file extension or editing the content of this file may   
    cause the file to be unrecognizable by the program.
-->
<GenericObjectDataSource DisplayName="DataContractClass" Version="1.0" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
   <TypeInfo>MySolution.ContractClasses, MySolution, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</TypeInfo>
</GenericObjectDataSource> 
```

提前感谢您的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:16:16.427

好的，我现在明白了，这似乎是 WCF 的一个很酷的功能：它不是代理数据合同，而是重用（映射到）包含数据合同的 dll。

更新：我已经尝试过一个更大的解决方案，它就像一个魅力，我只有一个如果 DEBUG 而不是很多（命名空间）：

```
#if DEBUG
    static Service client = new Service();
#else
    static ServiceClient client = new ServiceClient();
#endif 
```

# asp.net - 如何从 vb.net 中的对象数组元素构建一个新数组？

> ID：12098953
> 
> 赞同：1
> 
> 时间：2012-08-23T19:48:44.323
> 
> 标签：asp.net, .net, vb.net, arrays

我正在使用`vb.net`我有以下对象数组，我想从给它一个名称中提取所有真实值并将其添加到数组中这是对象数组 ![在此处输入图像描述](../Images/db6c42b08c8a9193bb08234b162b6587.png)

这是我到目前为止所尝试的：

```
 Dim myarray() As String
        Dim number As Integer = 0
        If resultArray(0).BolComment Then

            myarray(number) = "comment"
            number = number + 1
        End If
        If resultArray(0).BolComplete Then

            myarray(number) = "complete"
            number = number + 1
        End If
        If resultArray(0).BolFinished Then

            myarray(number) = "Finished"
            number = number + 1
        End If
        If resultArray(0).BolOutCome Then

            myarray(number) = "OutCome"
            number = number + 1
        End If
        If resultArray(0).BolStatred Then

            myarray(number) = "Started"
            number = number + 1
        End If
        If resultArray(0).BolUser Then

            myarray(number) = "User"
            number = number + 1
        End If 
```

这给了我一个错误：*该变量之前已使用过*

**问题**我如何提取所有具有`true`价值的项目并将`push`其提取到一个新数组中`with`，给它一个新的`name` 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:59:14.293

我认为您的问题是您没有将数组初始化为特定大小，也没有在每次添加新项目时重新调整它的大小。但是，最好只使用`List(T)`该类：

```
Dim list As New List(Of String)()
If resultArray(x).BolComment Then
    list.Add("comment")
End If
If resultArray(0).BolComplete Then
    list.Add("complete")
End If
If resultArray(0).BolFinished Then
    list.Add("Finished")
End If
If resultArray(0).BolOutCome Then
    list.Add("OutCome")
End If
If resultArray(0).BolStatred Then
    list.Add("Started")
End If
If resultArray(0).BolUser Then
    list.Add("User")
End If 
```

然后，如果您需要它作为实际数组，请执行以下操作：

```
Dim myarray() As String = list.ToArray() 
```

# ruby - 2..-1 的范围是什么意思？（Ruby koans about_arrays.rb）

> ID：12098956
> 
> 赞同：6
> 
> 时间：2012-08-23T19:48:51.870
> 
> 标签：ruby

请有人解释一下范围对象的`2..-1`含义。

Ruby koans 在 about_arrays.rb 中有以下内容：

```
def test_slicing_with_ranges
  array = [:peanut, :butter, :and, :jelly]

  assert_equal [:peanut, :butter, :and], array[0..2]
  assert_equal [:peanut, :butter], array[0...2]
  assert_equal [:and, :jelly], array[2..-1]
end 
```

以下网站（从另一个答案中找到）解释了范围如何与切片一起使用： [Gary Wright，字符串/数组切片](http://www.ruby-forum.com/topic/1393096#990065) 由此，我明白为什么拆分给出了它的答案。我不明白的是范围对象所指的范围。对于正常范围，我可以这样做：

```
(1..3).each { |x| puts(x) } 
```

在 irb 中执行时给出以下输出：

```
1
2
3
=> 1..3e 
```

但是，`(2..-1).each { |x| puts(x) }`给出：

```
=> 2..-1 
```

那么范围`(2..-1)`是什么意思呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T19:51:22.217

负索引表示“从数组末尾开始计数”。`-1`数组中的最后一项也是如此。`2..-1`表示从第三项到最后一项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-06T16:11:08.503

数组 = [：花生，：黄油，：和，：果冻]

```
array[2..-1] => [:and, :jelly] 
```

(2..-1) 表示从第二个索引开始到数组的最后一项。

'..' 是包含范围。

# php - PHP/SQL 投票和计算结果

> ID：12098957
> 
> 赞同：1
> 
> 时间：2012-08-23T19:48:57.583
> 
> 标签：php, mysql, sql, vote

我正在为车展写剧本。用户选择车号并根据各种标准投票 1-5。有多个用户为同一辆车投票，但他们只能为每辆车投票一次，我检查一下。

现在我有一个唯一的 carNumber 表和每辆车的每个标准 1-5 票。

这是我如何找到每个用户投票的总分

```
SELECT carNum, exterior+interior+engine AS Score FROM Judge_Votes WHERE catagory = '$catNum' ORDER BY carNum

Reults 
CarNum: Score:
18  11
14  8
13  15
12  8
12  11
2   14 
```

我想将每个用户的总分加起来成为最终得分结果。IE car 12 总分 19 分。

我的问题。如何使用 sql 或 php 找到总分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T19:54:14.397

只需使用 SUM 和 ORDER BY：

```
SELECT carNum, SUM(exterior+interior+engine) AS Score 
    FROM Judge_Votes 
    WHERE catagory = '$catNum' 
    GROUP BY carNum 
```

这应该够了吧”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T19:54:18.327

```
SELECT carNum, sum(exterior + interior + engine) as Score 
FROM Judge_Votes 
WHERE gatagory = '$catNum' 
GROUP BY carNum 
ORDER BY carNum 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:53:18.657

以下应该可以解决我认为的问题。逻辑是您对每辆车的结果进行分组（GROUP BY carNum），然后使用 SQL 的内置 SUM 函数。

```
SELECT SUM(exterior+interior+engine) as totalScore, carNum 
FROM Judge_Votes 
WHERE catagory = '$catNum' 
GROUP BY carNum
ORDER BY carNum; 
```

# php - 长轮询：每个浏览器中的通知

> ID：12098960
> 
> 赞同：1
> 
> 时间：2012-08-23T19:49:18.057
> 
> 标签：php, javascript, ajax, long-polling

我正在为我网站的每个页面启动一个长轮询请求。它每秒都会查看数据库，如果有新内容，它会将其标记为已查看并输出通知。调用 JavaScript 然后开始一个新的 ajax 请求。

现在我在网站上打开多个标签时遇到了问题，因为只有一个会收到新通知。这也是同一个用户名跨浏览器登录的问题...

解决这个万无一失的最聪明的方法是什么？

比你的投入！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:02:53.780

我认为最好避免浏览器拉动。您将遇到浏览器问题，并且您的基础设施应该很大以支持它。

尝试像[Commet](http://en.wikipedia.org/wiki/Comet_%28programming%29)这样的服务器端推送技术，

> Comet 是一种 Web 应用程序模型，其中长期持有的 HTTP 请求允许 Web 服务器将数据推送到浏览器，而无需浏览器显式请求它。

其他方法可能是使用[WebSockets](http://en.wikipedia.org/wiki/WebSockets)。

# python - 从制表符分隔的文件中提取部分数据

> ID：12098964
> 
> 赞同：0
> 
> 时间：2012-08-23T19:49:34.620
> 
> 标签：python, bash, parsing, csv

我在维基百科编辑历史上有一个以文本分隔的文件。每一行都包含一个不同的维基百科编辑。该文件按页面标题排序，这样每个页面的每个编辑都是它自己的行（该行由制表符分隔，有 7 个不同的变量）。我需要的只是每个页面的第一次和最后一次编辑。我想要的是一个与此类似的文件，其中每个维基百科页面只有一行，这样每一行都包含该页面第一次和最后一次编辑的所有信息。本质上是文件中第一行和最后一个编辑行的组合。

我想知道是否有一个简单的 bash 脚本或简短的 python 代码（我可以在 mac osx 终端中运行的东西）可以通过 txt 文件并输出我想要的内容。

感谢您的任何帮助！

以下是文件的前几行，以了解它的外观：

```
6   233188  AmericanSamoa   2001-01-19T01:12:51Z    ip:office.bomis.com ip:office.bomis.com 1516
6   133180191   AmericanSamoa   2007-05-24T14:41:33Z    Ngaiklin    4477979 5
8   233189  AppliedEthics   2001-01-20T15:01:12Z    ip:pD950754B.dip.t-dialin.net   ip:pD950754B.dip.t-dialin.net   9
8   133180238   AppliedEthics   2007-05-24T14:41:48Z    Ngaiklin    4477979 6
10  233192  AccessibleComputing 2001-01-21T02:12:21Z    RoseParks   99  8
10  133180268   AccessibleComputing 2007-05-24T14:41:58Z    Ngaiklin    4477979 6
12  18201   Anarchism   2002-02-25T15:00:22Z    ip:Conversion_script    ip:Conversion_script    1214
12  19746   Anarchism   2002-02-25T15:43:11Z    ip:140.232.153.45   ip:140.232.153.45   1460
12  19749   Anarchism   2002-02-27T17:34:09Z    ip:24.188.31.147    ip:24.188.31.147    1474 
```

给定上述行的输出示例如下所示：（请记住，每个页面都有不同数量的编辑，从两个到数百个不等，我只想要每个页面的第一个和最后一个编辑。我想要输出类似于以下示例，其中每个页面都有一行包含第一个和最后一个编辑信息。

```
6   233188  AmericanSamoa   2001-01-19T01:12:51Z    ip:office.bomis.com ip:office.bomis.com 1516    2007-05-24T14:41:33Z    Ngaiklin    4477979 5
8   233189  AppliedEthics   2001-01-20T15:01:12Z    ip:pD950754B.dip.t-dialin.net   ip:pD950754B.dip.t-dialin.net   9    2007-05-24T14:41:48Z   Ngaiklin    4477979 6
10  233192  AccessibleComputing 2001-01-21T02:12:21Z    RoseParks   99  8   2007-05-24T14:41:58Z    Ngaiklin    4477979 6
12  18201   Anarchism   2002-02-25T15:00:22Z    ip:Conversion_script    ip:Conversion_script    1214   2002-02-27T17:34:09Z ip:24.188.31.147    ip:24.188.31.147    1474 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T08:15:53.850

您的示例输出有点不一致，因为第一行有两次文章名称。假设您实际上并不需要它，并且还假设文件已正确排序，则以下命令适用于您的示例：

```
sed -r ':r;$!{N;br};s/\n/#/g;s/(^|#)((\S+\s+){2})(\S+\s+)([^#]*).*#(\S+\s+){2}\4/\1\2\4\5/g;s/#/\n/g' history.txt 
```

另一个假设是您的文件不包含任何`#`字符，否则您需要更改`#`为文件中未遇到的其他内容。

我猜你需要一些解释，但首先我想确保它符合你的需要。请评论结果:)

PS 它一次处理整个文件，结果可能对你来说太慢了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T18:43:07.760

我会分两步做。

*   假设您的数据已组织为字符串列表（例如，带有`file.readlines()`），列表为`data`。我们开始构建一个以第一列为键的字典，其值是 2 个列表的列表，第一个是第一个条目，第二个是最后一个条目。

    ```
    results = {}
    for line in data.split("\n"):
        fields = line.strip().split("\t")
        tag = fields[0]
        if tag:
            tag = int(tag)
            if tag in results:
                # last entry: skip the first three fields
                results[tag][1] = fields[3:]
            else:
                # first entry: skip the first field
                results[tag] = [fields[1:], []] 
    ```

*   现在我们有了字典，只需对它进行排序、组合两个列表并漂亮地打印结果

    ```
    ordered_results = []
    for k in sorted(results.keys()):
        current = results[k]
        ordered_results.append(current[0]+current[1])
    print "\n".join("\t".join(row) for row in ordered_results) 
    ```

# php - 如何检索从 MySQL 数组中选中的复选框？

> ID：12098965
> 
> 赞同：0
> 
> 时间：2012-08-23T19:49:36.480
> 
> 标签：php, mysql

我有这样的mysql设置

## MySQL

**表：画廊**

```
+-------------+------------+
| galleryname | coverphoto |
+-------------+------------+ 
```

**表：多画廊**

```
+-------------+-----------+
| galleryname | galleries |
+-------------+-----------+ 
```

我正在使用 php 中的复选框数组将画廊放入`multigalleries.galleries`like `gallery1,gallery2,gallery3`. 所有这一切都很好，我唯一想不通的是，当我拉出列表`gallery.galleryname`并用它引用它时`multigalleries.galleries`，如果它存在于，我如何返回检查状态`multigalleries.galleries`？

任何帮助将不胜感激。

编辑// IM使用的实际代码，如果有帮助的话

```
$con = mysql_connect($host,$dbusername,$dbpassword);
if (!$con)
{
die('Could not connect: ' . mysql_error());
}
mysql_select_db($databasename, $con);
$query = "SELECT galleries.gallery, galleries.coverphoto, multigalleries.multigallery,            multigalleries.galleries FROM galleries, multigalleries";
$result = mysql_query($query);

while ($line = mysql_fetch_array($result, MYSQL_ASSOC)) {
echo '<div class="gallery" style="background-image:none">';
echo '<input type="checkbox" name="galleriesm[]" value="'.$line[gallery].'">'.      $line[gallery].'';
echo '</div>'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:12:12.740

尝试这个：

```
$a = mysql_query("
    SELECT g.galleryname FROM gallery AS g, multigalleries AS m
    WHERE g.galleryname = 'gallery1' AND FIND_IN_SET(g.galleryname, m.galleries)
");

$b = mysql_fetch_assoc($a);

echo '<input type="checkbox" name="whatever"';

if($b['galleryname'])
{
    echo ' checked="checked"';
}

echo '>'; 
```

## 编辑：

```
$result = mysql_query("
    SELECT g.galleryname, m.galleryname AS name FROM gallery AS g 
    LEFT JOIN (SELECT galleryname, galleries FROM multigalleries) AS m ON 
    FIND_IN_SET(g.galleryname, m.galleries)
");

while($row = mysql_fetch_assoc($result))
{
    $checked = '';

    if($row['name'])
    {
        $checked = ' checked="checked"';
    }

    echo '<input type="checkbox" name="galleriesm[]" id="'.$row['galleryname'].'" value="'.$row['galleryname'].'"'.$checked.'>
    <label for="'.$row['galleryname'].'">'.$row['galleryname'].'</label>';
} 
```

# java - java中字符代码0的正则表达式

> ID：12098967
> 
> 赞同：6
> 
> 时间：2012-08-23T19:49:45.083
> 
> 标签：java, regex

如何在java中编写一个正则表达式来匹配所有没有字符代码零的字符串？

我试过了：

```
Pattern.compile ("[^\0]"); 
```

和

```
Pattern.compile ("[^\u0000]"); 
```

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T19:52:50.047

您的第一个正则表达式几乎是正确的，但它只匹配一个不是`\0`. 尝试将其更改为：

```
Pattern.compile ("[^\0]+"); 
```

这应该匹配一个或多个 ( `+`) 字符，而不是`\0`。

# c - 将结构元素数组与另一个元素交换

> ID：12098971
> 
> 赞同：1
> 
> 时间：2012-08-23T19:50:06.960
> 
> 标签：c, arrays, struct, swap

我正在尝试交换一个结构数组，我认为按照类似的方式存储在临时文件中会像这样工作：

```
int temp ,a, b;
temp = a;
a = b;
b = temp; 
```

我的结构定义数组是这样的：

```
struct storage data[10]; 
```

我尝试交换结构数组，我尝试了这个：

```
struct storage temp[1];
temp = data[1];
data[1] = data[2];
data[2] = temp; 
```

不幸的是，它没有编译

我的错误如下：

错误 #2168: '=' 的操作数具有不兼容的类型 'struct storage[1]' 和 'struct storage'。

错误 #2088：需要左值。

错误 #2168: '=' 的操作数具有不兼容的类型 'struct storage' 和 'struct storage*'。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T19:53:14.873

在 C 中，数组不是可修改的左值。放下`[1]`，你就设置好了：

```
struct storage temp; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:56:35.480

你试图持有一个结构存储，当你说时你取消引用

温度=数据[1]；

You need to declare your temp variable as such to hold the dereferenced values from the array

struct storage temp;

# php - 使用 PHP 作为守护进程，大量网络活动，崩溃

> ID：12098976
> 
> 赞同：1
> 
> 时间：2012-08-23T19:50:36.497
> 
> 标签：php, request, response, daemon, fork

**背景：**

我目前有一个用 PHP 编写的守护进程。当我编写 PHP 时，我知道 PHP 并不是解决这个问题的最佳解决方案，但它是我当时可以访问的，而且我正在做的事情使 PHP 变得更加理想。

实际上，我在 PHP 中使用了两个守护进程。两者都是带有 set_time_limit(0) 的简单 while(true) 循环。一个人比另一个人更喜欢崩溃（这不是问题，因为我有一个 cron 可以在它崩溃时重新启动它），我猜这是因为网络活动增加。

**无论如何，守护进程：**

守护程序 1：该守护程序从外部服务器请求信息，非常密集地循环通过该数据（大约 10 多个 foreach 的）并将其插入数据库。它正在 24/7 执行此操作。这个守护进程每天晚上 11:59 运行是至关重要的。

守护进程 2：该守护进程请求相同的数据。但是，当它遍历该数据时，如果对找到的某些数据起作用，并且如果确实如此，则发出外部网络请求。它经常提出这样的请求。如果它运行正常，大概每隔几分钟就会发生一次（如果它崩溃并且需要重新启动或冻结，请求将会增加......）这个守护进程绝对喜欢崩溃。不过，崩溃没关系。这个守护进程也喜欢冻结它必须被杀死才能重新开始工作的地方。

**问题：**

好吧，两次请求相同的数据（目前每个脚本每秒两次）效率极低。我需要将它们合并为一个守护进程。但是，守护进程 1 很关键，需要完成它的工作。如果合并后有更多错误的守护进程导致守护进程崩溃，我可能会遇到问题。

**所以，问题：**

我想我可以创建新的守护进程来在脚本之外发出请求。我的意思是当新的守护进程需要发出网络请求时（这会真正减慢脚本并可能导致更多问题），它会调用另一个脚本（不会阻止主脚本）。例如，新的守护进程需要发出 20 个网络请求，它可以通过调用另一个脚本来同时发送这 20 个请求来处理它们。这需要守护进程的工作，可能会导致更少的崩溃，我不需要两次请求相同的数据。

# perl - Perl 分割字符串

> ID：12098978
> 
> 赞同：0
> 
> 时间：2012-08-23T19:50:49.623
> 
> 标签：perl

```
#!/usr/bin/perl
$command="lscpu | grep -i Architecture";
#$arch = system($command);
@SplitArch = split(/:/, system($command));
print @SplitArch[1]; 
```

我得到的结果是：

```
Architecture:          x86_64 
```

我希望唯一会显示的是：

```
x86_64 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T19:56:16.087

这并不像你认为的那样。[该`system`函数](http://perldoc.perl.org/functions/system.html)运行命令并返回其退出状态；所以在你的情况下，这个：

```
system($command) 
```

打印`Architecture: x86_64`，所以这个：

```
@SplitArch = split(/:/, system($command)); 
```

打印`Architecture: x86_64`并设置`@SplitArch`为`(0)`.

`print @SplitArch[1]`然后什么也不打印，因为`@SplitArch`只有一个元素。（顺便说一句，您可能打算写`$SplitArch[1]`而不是`@SplitArch[1]`，但这既不是这里也不是那里。）

由于您显然打算捕获 的输出`$command`，请使用[``...``或`qx/.../`](http://perldoc.perl.org/perlop.html#qx/STRING/)代替：

```
@SplitArch = split(/:/, `$command`); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:56:25.080

如果要获取命令的输出，则应使用`qx{}`运算符：

```
my @SplitArch = split /:/ qx{$command}; 
```

并且要打印数组索引 #1 处的值，您应该使用`$`Sigil，因为您期望一个标量值：

```
print $SplitArch[1], "\n"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:57:53.733

我相信 System 的返回值是命令的退出值，而不是输出。

你也许应该这样做：

```
$output = `$command`;
@SplitArch = split(/:/, $output); 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T19:58:59.113

已经给出的解释—— `system`没有返回你认为的结果——我只是提供了一个替代解决方案。

```
open(my $LSCPU, '-|', 'lscpu') or die $!;
while (<$LSCPU>) {
   chomp;
   my ($key, $val) = split(/:\s*/, $_, 2);
   if ($key eq 'Architecture') {
       print "$val\n";
       last;
   }
}
close($LSCPU); 
```

优点：

*   尽快退出。
*   不涉及外壳。
*   除了 shell 之外，还少了一个外部程序。
*   更精确地匹配所需线路。

# node.js - 尝试在 nodejs 子进程中执行 svn ls 命令返回错误

> ID：12098979
> 
> 赞同：0
> 
> 时间：2012-08-23T19:50:51.950
> 
> 标签：node.js, child-process

我想`svn ls <path>`在尝试时运行命令，但出现错误说明

```
svn: '.' is not a working copy
svn: Can't open file '.svn/entries': No such file or directory 
```

这是您尝试在没有路径且不受 SVN 版本控制的目录中运行命令时遇到的标准错误。但问题是，当我在执行命令之前 console.log 时，它特别说明了远程 SVN 存储库的完整、有效路径。

例如，`svn ls https://svn.example.com/this/is/a/valid/repo`

如果我将日志复制并粘贴到我自己的 bash 中，它会很好地列出目录。

这是我想要执行的代码

```
function svnls (path) {
    var cp = require('child_process'),
        command = 'svn ls ' + path;

    console.log(command);  // -> svn ls https://svn.example.com/this/is/a/valid/repo
    cp.exec(command, function (err, stdout, stderr) {
        console.log(stderr);
    });
} 
```

或者，我尝试了更详细的生成 bash 实例的方法：

```
function svnls (path) {
    var bash = require('child_process').spawn('bash');

    bash.stdout.on('data', function (data) {
        var buff = new Buffer(data),
            result = buff.toString('utf8');

        console.log(result);
    }); 

    bash.stderr.on('data', function (data) {
        var buff = new Buffer(data),
            error = buff.toString('utf8');

        console.log(error);
    }); 

    bash.on('exit', function (code) {
        console.log(code);
    });

    bash.stdin.write('svn ls ' + path);
    bash.stdin.end();
} 
```

它向控制台输出相同的错误以及退出代码（1）。

有谁知道为什么会失败？

# iphone - 使多个运动图像响应点击

> ID：12098980
> 
> 赞同：0
> 
> 时间：2012-08-23T19:51:07.213
> 
> 标签：iphone, objective-c, ios, ios5, core-graphics

在应用程序中，我有几张图像（形状和大小相同，颜色不同）在圆周上移动，有点像充当指南针的光标。我希望能够点击其中的每一个，然后根据被点击的内容显示一条消息，但我不确定哪种方法对此有好处。现在我正在尝试将它们放入 UIButtons，但这给我带来了很多麻烦。有没有办法用 UITapGestureRecognizer 做到这一点？我怀疑是否有可能在屏幕上显示其中一个，但让它跟踪 6 个不同的移动区域并让其他点击事件通过，我不认为添加 6 个不同的识别器是一个好主意，所以我只是想知道是否有人对如何解决这个问题有建议。我正在使用核心图形。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:56:43.293

实现此效果的最佳方法可能是将具有覆盖触摸的方法的 UIButton（如果您愿意，甚至是 UIControl）子类化。例如，如果你要继承 UIControl，你可以重写下面的方法来检测触摸并用它们做你想做的事情：

```
-(BOOL)beginTrackingWithTouch:(UITouch *)touch withEvent:(UIEvent *)event 
```

然后，无论您希望它看起来像什么，都可以在 drawRect: 方法中通过覆盖它（并取消注释它）来完成。子类中的任何子类化和跟踪触摸也是如此：UIButton、UIImageView、UIControl 等。

# html - 模拟 quirks 模式表渲染

> ID：12098989
> 
> 赞同：3
> 
> 时间：2012-08-23T19:52:21.720
> 
> 标签：html, css, height, quirks-mode

我们的应用程序大量使用表格进行布局和定位，并且过去仅是 IE（怪癖模式）。展望未来，我们正试图摆脱怪癖模式，并用 div 和更语义化的布局替换表格。

阻止我们的一件事是怪癖模式“功能”，它允许我们`height=100%`在表格行上进行设置，并让该行占据剩余的垂直空间。到目前为止，我们还没有找到一种在怪癖模式之外执行此操作的方法，无论是否使用表格。

这是我们在页面正文中使用的代码。这里没有显示样式，但效果还是一样的：

```
<table width="100%" height="100%" border="0">
    <tr>
        <td>
            <table width="100%" height="100%" border="1">
                <tr>
                    <th>This is my header bar</th>
                </tr>
            </table>
        </td>
    </tr>
    <tr height="100%">
        <td>
            <table width="100%" height="100%" border="1">
                <tr>
                    <td>This is my main section bar</td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td>
            <table width="100%" height="100%" border="1">
                <tr>
                    <td>This is my footer bar</th>
                </tr>
            </table>
        </td>
    </tr> 
```

这就是 Quirks 模式下的样子。请注意，中间行（带有`height="100%"`）已扩展以占用剩余的垂直空间：

![怪癖模式渲染](../Images/e7e8bdf33c84d120530707d5dc579f60.png)

标准模式呈现相同的代码，如下所示：

![标准模式](../Images/a3dd0f6b4acc21a1884e4501c8ea3b1a.png)

jsFiddle 与代码： http: [//jsfiddle.net/RBeWN/3/](http://jsfiddle.net/RBeWN/3/)（请注意，由于 iFrames 等，代码实际上不会在 jsFiddle 上以怪异模式呈现，但您可以使用开发工具强制它）。

我试图用`div`s 和一些 css 来做到这一点，但它不起作用：http: [//jsfiddle.net/BVMhR/3/](http://jsfiddle.net/BVMhR/3/)。将主 div 设置为`height: 100%;`与其父级*相同*的高度，而不是使其占用剩余空间。设置`box-sizing: border-box;`对此也没有任何影响。

有人可以帮我找到解决这个问题的方法吗？如果可能的话，我希望能够在没有 javascript 的情况下做到这一点，但如果需要 Javascript *，*它必须是一个可以在每个页面上运行的通用解决方案，这样设置它就不会产生太多的开发开销向上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T12:48:39.477

在尝试了很多不同的布局，并澄清了一些关于需求的细节之后，我找到了一种使用纯 CSS 的方法。

它确实涉及知道顶行和底行的高度（尽管它们可以以 % 指定），并且还涉及一些额外的 div 层。

我的例子可以[在这个 jsFiddle](http://jsfiddle.net/AZcZx/26/)中找到。请注意，在扩展/缩小窗口时，中间行会适当地重新调整大小。如有必要，也可以将其设置为滚动 div（使用`overflow: auto`），以便内容过长时滚动。

如果需要，请随时与我联系，询问有关此布局的任何其他问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:14:57.970

我认为这不能用纯 CSS 来解决。

[http://jsfiddle.net/AZcZx/10/](http://jsfiddle.net/AZcZx/10/)

这就是我使用 javascript 的方式...我根据您的 div 名称假设这是您的页面处理页眉、内容、页脚的方式，因此这应该足够通用。

我添加了边框/边距以显示那里存在边缘情况，jQuery 可以很好地帮助...我还假设您的 quirks-mode 示例中的内容垂直居中不是问题的一部分。

**编辑：**

我站得更正了。它可以用 CSS 来完成，虽然它会产生一个很难修复的宽度问题，所以这里是解决方法：

[http://jsfiddle.net/AZcZx/27/](http://jsfiddle.net/AZcZx/27/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T20:05:27.660

你知道页眉和页脚的高度吗？看看你的 div 小提琴示例，它们都有固定的高度。如果是这种情况，您可以将它们绝对定位到顶部和底部，并在#divMain 的顶部和底部添加边距。

您还需要将 html 和 body 设置为`height: 100%;`，并将 #divMain 设置为`min-height: 100%;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T19:54:45.527

您需要将正文和 HTML 扩展为 100% 才能正常工作。"height:100%" 使项目成为其父项的 100%。如果没有定义父级的大小，它只会与其子级一样大。

```
body, html {height:100%} 
```

# macos - 这个（while）循环是否导致emacs崩溃？

> ID：12098992
> 
> 赞同：1
> 
> 时间：2012-08-23T19:52:45.757
> 
> 标签：macos, emacs, elisp

我需要通过一个 XML 文件来寻找某些标签，其内容是人类可识别的但不是正则表达式可识别的，并处理这些标签。我整理了一个键盘宏来完成我需要的工作，然后尝试使用以下 elisp 让我逐步浏览文件，只需为每个标签按`y`或`n`，而不是在移动命令和宏执行之间来回切换。

```
(while t
  (progn
    (search-forward "<Name>")
    (move-beginning-of-line nil)
    (if (y-or-n-p "Problem? ")
        (call-last-kbd-macro)
      (next-line)
      ))) 
```

但是，当我`M-:`对此进行评估时，它到了`y-or-n-p`，然后 emacs 变得没有响应。我在 OS X 10.7 机器上使用 emacs。在 Activity Monitor 中，emacs 占用了正常数量的 RAM 和 CPU 时间，而不是不断升级的资源请求，所以我不认为我遇到了无限循环。Emacs 完全停止响应输入和点击，包括重复点击 Escape 或`C-g`. 一个额外的细节：`y-or-n-p`我得到的一个交互是一个对话框，而不是在 minibuffer 中，这很奇怪 - 我在上面单击是，对话框消失了，这是我在 emacs 消失之前能够与它进行的最后一次交互进入深空。

上面的 elisp 代码中是否存在本质上危险的东西？我的想法是，`(search-forward)`在缓冲区结束时会失败，发出错误信号，然后循环将结束。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:10:07.923

试试这个，以便搜索失败循环终止。如果 call-last-kbd-macro 在上一次搜索之前向后移动，则此代码仍可能永远循环。

```
(while (search-forward "<Name>" nil t)
  (progn
    (move-beginning-of-line nil)
    (if (y-or-n-p "Problem? ")
        (call-last-kbd-macro)
      (next-line)))) 
```

# c# - 在 Silverlight 中设置 Usercontrol 的父级

> ID：12098993
> 
> 赞同：0
> 
> 时间：2012-08-23T19:52:46.877
> 
> 标签：c#, silverlight, silverlight-5.0

我正在尝试使用用户创建的 UserControl 来实现类似布局的导航。

我有一个 Silverlight 页面，它通过将内容设置为框架元素来加载用户控件。

```
UserControl1 uc1 = new UserControl1();
this.Frame.Content = uc1; 
```

同样，我在每个 UserControl 中都有一个 Frame，其中内容设置为 Frame。

这很好用。

**问题：** 我有目前的情况

                       |用户控件1 | 用户控件2 | 用户控件3
------------------------------------------------ -------------------------
用户控件1 | | 儿童 |
用户控件2 | 家长 | |儿童
用户控制3 | |家长 |

所以现在我想要实现的是，当用户从 UserControl1 打开 UserControl2 时，我需要能够以**与之前相同的状态**从 UserControl2 移回父级（UserControl1） 。

这真的可能吗？如果是，那么应该怎么做？任何提示，代码，文章参考都表示赞赏......

**原因：**

我试图避免在页面查询中传递变量并使用用户控件。

**设想：**

例如，如果用户在 UserControl1 内的文本框中写入“Hello World”并按下按钮，则加载 UserControl2。在他按下 UserControl2 中的 OK 后，返回到 UserControl1，文本框仍显示“Hello World”

希望我很清楚。让我知道是否需要任何澄清。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:57:34.700

是的，这是可能的，但你的控件不应该是 UserControls，而是从[Page](http://msdn.microsoft.com/en-us/library/system.windows.controls.page%28v=vs.95%29)继承，你应该使用 Frame 的 Navigate 方法来设置第一页

```
this.Frame.Navigate(new Uri("Page1.xaml", UriKind.Relative)); 
```

然后从第 1 页导航到第 2 页，使用Page的[NavigationService](http://msdn.microsoft.com/en-us/library/system.windows.controls.page.navigationservice%28v=vs.95%29)

```
NavigationService.Navigate(new Uri("Page2.xaml", UriKind.Relative)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T06:21:19.547

这是一个示例，说明您可以如何做到这一点：

```
List<UserControl> navigationStack = new List<UserControl>();

public void NavigateTo(UserControl newUC)
{
  // when navigating to a new control, keep the old one in memory
  if (this.Frame.Content != null) 
    navigationStack.Add(this.Frame.Content as UserControl);
  this.Frame.Content = newUC;
}

public void NavigateBack()
{
  // when navigating back to an old control in memory, 
  // retrieve it off the navigation stack
  UserControl oldUC = navigationStack.LastOrDefault();
  if (oldUC != null)
  {  
     navigationStack.Remove(oldUC);
     this.Frame.Content = oldUC;
  }
} 
```

# java - Apache CXF 初始化上的调用方法

> ID：12098995
> 
> 赞同：2
> 
> 时间：2012-08-23T19:52:50.287
> 
> 标签：java, apache, cxf

我正处于“操作方法”阶段，`Apache CXF`想知道是否有办法在服务器启动时调用方法。

它将类似于`JSF`Web 应用程序，当我使用`@ApplicationScoped`托管 bean 时`eager=true`：当容器启动时，带注释的类被实例化，我可以从它的构造函数中调用我想要的任何东西。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T12:30:46.537

因此，如果您`CXF Servlet`用于服务`Web Service`请求，那么您可以创建`ServletContextListener`并`contextInitialized`在部署或服务器启动时调用方法（如果已部署应用程序）。

为此，创建将实现的类`ServletContextListener`：

```
public class YourContextListener implements ServletContextListener {

    @Override
    public void contextInitialized(ServletContextEvent sce) {      
        //This method is called by the container on start up
    }

    @Override
    public void contextDestroyed(ServletContextEvent sce) {        
    }   

} 
```

然后在您的`web.xml`：

```
<listener>
    <listener-class>your.package.YourContextListener</listener-class>
</listener> 
```

在该`contextInitialized`方法中，您可以使用以下方法获取 servlet 上下文：

```
ServletContext context = sce.getServletContext(); 
```

您可以设置任意数量的属性，以便在整个应用程序范围内可用。

# javascript - Mootools 选择器问题

> ID：12098996
> 
> 赞同：2
> 
> 时间：2012-08-23T19:52:51.593
> 
> 标签：javascript, mootools

现在我有一个动态字符串，将它的值分配给特定的 div 类。输出看起来像这样

```
 <div class="12923"></div> 
```

我想找到那个'randNumber' div，然后检查它是否有另一个类'x'

目前我现在所拥有的不起作用：

```
 var randNumber = 12923

  var lookingForYou = $$('.'+randNumber);
  if (lookingForYou.hasClass('XCLASS')){alert('XCLASS FOUND!');} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T20:58:31.330

$$ 返回一个 Elements 实例， Elements 无论如何都是一个类似数组的类，因为你基本上是在过滤，你可以告诉 Slick 你需要一个具有两个类的元素：

```
 var randNumber = 12923;
 if($$('.' + randNumber +'.XCLASS').length>0){
     alert('XCLASS FOUND');
 }else{
     //dostuff
 } 
```

或者您可以只使用其中一种 Elements 方法，我认为 .some 将是您的最佳选择：

```
 var randNumber = 12923

    var lookingForYou = $$('.' + randNumber);

    alert(lookingForYou.some(function(el){
        return el.hasClass('XCLASS');
    })) 
```

编辑：

添加一些链接：

[在 MooTools 博客上使用 Elements 的更好方法](http://mootools.net/blog/2010/03/19/a-better-way-to-use-elements/)

在我的第二个示例中，我使用了 some 方法，通过查看源代码并没有重载，它只是 Array.prototype.some 中的一个：

[Element.js 源码参考](https://github.com/mootools/mootools-core/blob/master/Source/Element/Element.js#L200-202)

[MDN 上的 Array.some](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/some "MDN 上的 Array.some")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T19:58:48.317

$$ 返回所有匹配元素的数组。不确定您是否可以在数组上执行 hasclass。可能必须做一个 .each() 然后去做。尝试 $('body').getElement('.'+randNumber).hasClass('XCLASS') 如果你不想弄乱数组，你可以抓住 1 个元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T20:00:39.433

这里：

```
if (lookingForYou.hasClass('XCLASS')){alert('XCLASS FOUND!');} 
```

`$$()`返回一个数组，并对数组`hasClass()`的每个元素执行检查，返回一个布尔数组。不幸的是，当您检查 时，*即使所有值都是*`if (...)`，返回数组也会被评估为因为它不是空的。*`false`*`true`

# vim - 如何在 Vim 中拉出当前行和它上面的行？

> ID：12098997
> 
> 赞同：3
> 
> 时间：2012-08-23T19:53:08.100
> 
> 标签：vim, yank

我需要的是拉出当前行和它上面的行。

例如，在以下示例中：

```
3   My test line
4   Line above current line
5   My current line |(cursor)
6   Line below current line 
```

当光标位于第 5 行时，如何拉出第 5 行和第 4 行？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T19:55:46.943

`y``k`应该这样做，就像在 *Yank 中向上一行的方向*一样，因为`y`将接受下一个击键作为一个动作，并且`k`单独表示向上一行的动作。

如果您需要光标返回其原始位置，只需添加一个`j`as `y``k``j`。您可能会看到光标在屏幕上不雅地移动，但它完成了工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-23T19:55:57.367

对于这个简单`yk`的案例，可以解决问题。这是 yank 后*跟上一行*的动作。

通常，使用`yNk`, 例如`y3k`拉出当前行和前 3 行。

如果需要在 yank 之后返回光标位置，设置一个标记并返回到 之后的标记`yk`：

```
mmyk`m 
```

如果您只需要保持在开始拉动的同一行，则光标位置*不*`ykj`一样，会更短。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-24T02:43:17.947

除了其他答案中已经提到的普通模式命令外，还可以`:yank`在相应的行范围内使用 Ex 命令。例如，要复制当前行及其上方的行（不移动光标）运行

```
:-,y 
```

# java - 动态 Java.swing 菜单

> ID：12098998
> 
> 赞同：0
> 
> 时间：2012-08-23T19:53:11.017
> 
> 标签：java, dynamic, menu

我在用 Java 编写动态菜单时遇到了一个特殊问题。

我想要什么：我想要一个查找特殊文件的菜单栏（例如：addon01_men.class）并将该文件的内容作为新项目添加到菜单中。

问题：要调用文件中的方法/类，我必须在主文件中调用它。但是在这种情况下需要插件类，因为 java 检查方法/类的存在。因此，如果缺少“addon01_men.class”，程序将无法启动。

我的解决方案不起作用（也许是我的错）： - 反思 - 覆盖

我不想使用动态类，因为必须在程序启动时进行编译——因为并非所有可以运行 java 的 PC 都可以编译 java。

当有人有一个可行的想法时，我会很高兴。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:33:13.520

你应该像这个例子一样使用反射开始简单：

[http://www.mkyong.com/java/how-to-use-reflection-to-call-java-method-at-runtime/](http://www.mkyong.com/java/how-to-use-reflection-to-call-java-method-at-runtime/) 如果你想要，你需要寻找一个包含像 addon01_men 这样的类文件的目录。类（认为它们是插件），加载它们并创建实例。