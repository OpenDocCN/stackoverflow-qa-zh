# StackOverflow 问答 12339000-12339999

# asynchronous - ServiceStack 和 OrmLite 中的异步支持

> ID：12339000
> 
> 赞同：6
> 
> 时间：2012-09-09T12:20:17.613
> 
> 标签：asynchronous, servicestack, async-await, ormlite-servicestack, micro-orm

目前存在一个 ServiceStack 的异步分支，这将使创建异步服务成为可能。但是要获得异步的所有好处，所有 IO 绑定操作都应该是异步的，因此所有数据库请求也应该是异步的。我目前正在将 OrmLite 与 Postgresql 一起使用，因此我想知道 OrmLite 是否支持异步查询/操作？如果没有，还有哪些其他 .Net Micro-Orms 支持异步操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T17:48:26.770

OrmLite has 1st class [Async support](https://github.com/ServiceStack/ServiceStack.OrmLite#async-api-overview) for all its [RDBMS Providers](https://github.com/ServiceStack/ServiceStack.OrmLite#ormlite-rdbms-providers) which support async ADO.NET provider implementations (inc. PostgreSQL/Npgsql), otherwise falls back "pseudo async" support over its sync ADO.NET provider APIs which allows using Async APIs in RDBMS providers that don't support it whilst able to benefit from async implementations when running against RDBMS providers that do.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-21T18:36:23.933

我最近开始研究[AsyncPoco ，它是流行的](https://github.com/tmenier/AsyncPoco)[PetaPoco](http://www.toptensoftware.com/petapoco)微 ORM的完全异步分支。它仍然需要一些测试~~和一些适当的文档/示例，并且目前还不支持 PostgreSQL。~~更新：AsyncPoco 现在有一些基本的文档和示例，并且现在支持 PostgreSQL！

无论如何，您询问了其他支持异步操作的 .NET micro-ORM，所以我想我会提到它以引起任何关注。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-24T12:57:43.980

对不起，如果我误解了这个问题

*但是为什么不能使用任务并行库 TPL 或等效的方法来包装调用呢？*

这就是我所做的，我对结果非常满意。归根结底，您只是在查询数据...

谢谢

# google-analytics - Google Analytics - 跟踪“添加到购物车”

> ID：12339007
> 
> 赞同：0
> 
> 时间：2012-09-09T12:20:32.573
> 
> 标签：google-analytics, google-analytics-api

我正在尝试在添加到购物车按钮上添加跟踪代码，但由于某种原因，数据没有发送到谷歌。

```
<button onclick="productAddToCartForm.submit(this); _gaq.push(['_trackEvent', 'Products', 'Add to Cart', 'skuproductcode', jQuery('select#qty').val()])">Add to Cart</button> 
```

有什么我做错了吗？我应该推送交易还是自动推送到 Google？

我已经在 Google Analytics 上激活了电子商务跟踪。还有什么我需要做的吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T09:38:15.823

您不需要电子商务跟踪来进行事件跟踪。您应该添加一个辅助函数

*   调用事件跟踪
*   引入了一个短暂的超时，因此在页面重定向到表单的目标 URL 之前，有时间将事件跟踪像素发送到谷歌服务器
*   然后提交表单。

并在您的点击事件中调用此辅助函数。

但是，如果您想“推送交易”，您应该在 Google Analytics（分析）文档中查找“交易跟踪”，因为这与事件跟踪完全不同。

# java - 在 Spring MVC 中绑定列表映射

> ID：12339013
> 
> 赞同：7
> 
> 时间：2012-09-09T12:21:37.850
> 
> 标签：java, jsp, spring-mvc, jstl

我不确定这是否是一个复杂的问题，但作为一个初学者，这对我来说似乎有点复杂。我有一个基于它的对象，我需要在 UI 上显示一些值并让用户选择其中一些，当用户单击提交按钮时，我需要将数据发送回另一个控制器。这是我的数据对象的结构

```
public class PrsData{
private Map<String, List<PrsCDData>> prsCDData;
}

public class PrsCDData{
  private Map<String, Collection<ConfiguredDesignData>> configuredDesignData;
}

public ConfiguredDesignData{
  // simple fields
} 
```

在显示视图之前，我已经在模型中设置了对象

```
model.addAttribute("prsData", productData.getPrData()); 
```

在表格中我有以下设置

```
<form:form method="post" commandName="prsData" action="${addProductToCartAction}" >
<form:hidden path="prsCDData['${prsCDDataMap.key}']
  [${status.index}].configuredDesignData['${configuredDesignDataMap.key}']
  [${configuredDesignDataStatus.index}].code"/>

<form:hidden path="prsCDData['${prsCDDataMap.key}']
  [${status.index}].configuredDesignData['${configuredDesignDataMap.key}']
  [${configuredDesignDataStatus.index}].description"/>

</form:form> 
```

这就是我所拥有的`AddProductToCartController`

```
public String addToCart(@RequestParam("productCodePost") final String code,
@ModelAttribute("prsData") final PrsData prsData, final Model model,
@RequestParam(value = "qty", required = false, defaultValue = "1") final long qty) 
```

在提交表单时，我收到以下异常

```
org.springframework.beans.NullValueInNestedPathException: Invalid property 'prsCDData[Forced][0]' 
of bean class [com.product.data.PrsData]: 
Cannot access indexed value of property referenced in indexed property path 'prsCDData[Forced][0]': returned null 
```

似乎它试图访问该控制器上的值，而我试图将值发送到该控制器并尝试使用选定的值创建相同的对象

谁能告诉我我做错了什么以及我需要注意什么

**编辑**

我做了一些更多的研究，才知道 Spring 不支持自定义对象的自动填充列表/映射，并且根据我尝试更改实现的答案，例如

```
public class PrsData{
    private Map<String, List<PrsCDData>> prsCDData;
    // lazy init
    public PrsData()
    {
           this.prsCDData = MapUtils.lazyMap(new HashMap<String, List<PrsCDData>>(),
                FactoryUtils.instantiateFactory(PrsCDData.class));
        }
    }

    public class PrsCDData{
      private Map<String, Collection<ConfiguredDesignData>> configuredDesignData;
      public PrsCDData()
    {

       this.configuredDesignData = MapUtils.lazyMap(new HashMap<String,  
                                      List<ConfiguredDesignData>>(),
            FactoryUtils.instantiateFactory(ConfiguredDesignData.class));

    }
    } 
```

但我得到以下异常

```
org.springframework.beans.InvalidPropertyException: 
Invalid property 'prsCDData[Forced][0]' of bean class [com.data.PrsData]:
Property referenced in indexed property path 'prsCDData[Forced][0]' 
is neither an array nor a List nor a Set nor a Map; 
returned value was [com.data.PrsCDData@6043a24d] 
```

我不确定我做错了什么，似乎我的 JSTL 表达式不正确

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-09T15:35:49.067

**说明：**如果在您的控制器中有`@ModelAttribute("user") User user`，并且您加载了包含 的相应页面，`<form:form commandName="user">`则会实例化一个空的 User 。

它的所有属性都为空，或者在 List 或 Map 的情况下为空。此外，它的空列表/地图已通过自动增长实现进行实例化。这是什么意思 ？假设我们有一个空的 autogrowth `List<Coconut> coconuts`。如果我这样做`coconuts.get(someIndex).setDiameter(50)`，它将起作用而不是抛出异常，因为列表会自动增长并为给定索引实例化一个椰子。
由于这种自动增长，提交具有以下输入的表单将像魅力一样工作：

```
<form:input path="coconuts[${someIndex}].diameter" /> 
```

* * *

**现在回到您的问题：** Spring MVC 自动增长与一系列对象一起工作得很好，每个对象都包含一个地图/列表（[参见这篇文章](https://stackoverflow.com/questions/9943386/bind-map-in-spring-mvc/9974851#9974851)）。但是考虑到您的例外情况，Spring 似乎不会自动增长自动增长的列表/地图所包含的可能对象。在`Map<String, List<PrsCDData>> prsCDData`中，它`List<PrsCDData>`只是一个没有自动增长的空列表，因此会导致您的异常。

所以解决方案必须使用某种 Apache Common 的[LazyList](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/list/LazyList.html)或 Spring 的[AutoPopulatingList](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/util/AutoPopulatingList.html)。
您必须实现自己的自动增长地图，该地图为给定索引实例化 LazyList/AutoPopulatingList。从头开始或使用某种 Apache Common 的[LazyMap](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/map/LazyMap.html) / [MapUtils.lazyMap](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/MapUtils.html#lazyMap%28java.util.Map,%20org.apache.commons.collections.Transformer%29)实现（到目前为止，我还没有找到 LazyMap 的 Spring 等效项）。

使用 Apache Commons Collections 的解决方案示例：

```
public class PrsData {

  private Map<String, List<PrsCDData>> prsCDData;

  public PrsData() {
      this.prsCDData = MapUtils.lazyMap(new HashMap<String,List<Object>>(), new Factory() {

          public Object create() {
              return LazyList.decorate(new ArrayList<PrsCDData>(), 
                             FactoryUtils.instantiateFactory(PrsCDData.class));
          }

      });
  }

} 
```

# java - Java Android：onTouchListener 不工作

> ID：12339028
> 
> 赞同：1
> 
> 时间：2012-09-09T12:23:24.193
> 
> 标签：java, android, ontouchlistener

我是为 Java 编写应用程序的新手。我设法构建了一个小测试应用程序，它带有一个在基于线程的循环中不断重绘的 SurfaceView。

现在我设法解决了所有这些图形的问题，尽管我想实现一个 onTouchListener。我按照 Google 的要求做了，并将其写入实现 OnTouchListener 并将 SurfaceView 设置为 OnTouchListener 的主要活动中（直接：`Panel.p.setOnTouchListener`和间接： View `view = findViewById(R.id.SurfaceView01);view.setOnTouchListener(this);)`。

我在这两种情况下都得到了结果。我的应用程序设置为“全屏”，XML 仅包含对面板的引用。

我不知道错误可能出在哪里，除了 onTouchListener 一切正常。我将在这里添加与问题相关的所有文件，希望有人知道我做错了什么。

**XML:**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<com.example.test.Panel android:id="@+id/SurfaceView01" android:layout_width="wrap_content"
android:layout_height="wrap_content" android:maxHeight="40dip">
</com.example.test.Panel> 
```

**主要活动：**

```
//'Constructor'
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.activity_main);
    //View view = findViewById(R.id.SurfaceView01);
    //view.setOnTouchListener(this);
    Panel.p.setOnTouchListener(this);
}

//Called when App's being closed
@Override
public void onPause(){
    super.onPause();
    CanvasThread._run = false;
}

//Touching - Somehow doesn't seem to want to do anything :(
@Override
public boolean onTouch (View v, MotionEvent event){
    int x = (int)event.getX();
    int y = (int)event.getY();
    CanvasThread.scene.bird.setDestination(x, y);
    //Pressing
    if(event.getAction()==MotionEvent.ACTION_DOWN){}
    //Releasing
    if(event.getAction()==MotionEvent.ACTION_UP){}
    //Moving
    if(event.getAction()==MotionEvent.ACTION_MOVE){}
    return false;
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
} 
```

**面板（SurfaceView）：**

```
CanvasThread canvasthread;
public static Panel p;

@Override
public void surfaceChanged(SurfaceHolder holder, int format, int width,int height) {
}

@Override
public void surfaceCreated(SurfaceHolder holder) {
    canvasthread.setRunning(true);
    canvasthread.start();
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
        boolean retry = true;
        canvasthread.setRunning(false);
        while (retry) {
                try {
                        canvasthread.join();
                        retry = false;
                } catch (InterruptedException e) {}
        }

}

public Panel(Context context, AttributeSet attrs) {
    super(context, attrs);
    getHolder().addCallback(this);
    canvasthread = new CanvasThread(getHolder(), this);
    setFocusable(true);
    p = this;
}

public void onDraw(Canvas canvas, Bitmap img, int x, int y) {
    Paint paint = new Paint();
    canvas.drawBitmap(img, x, y, null);
}

public void setBlack(Canvas canvas){
    canvas.drawColor(Color.BLACK);
}

//-----------Image Management----------------------
public Bitmap chest = BitmapFactory.decodeResource(getResources(), R.drawable.chest);
public Bitmap stairs = BitmapFactory.decodeResource(getResources(), R.drawable.stairs);
public Bitmap[][] blueBird = doubleCrop(BitmapFactory.decodeResource(getResources(), R.drawable.bluebird), 4, 2);
public Bitmap[] tileset = cropIt(BitmapFactory.decodeResource(getResources(), R.drawable.tileset), 10);

public Bitmap[] cropIt(Bitmap set, int length){
    int width = set.getWidth()/length;
    int height = set.getHeight();
    Bitmap[] array = new Bitmap[length];
    for(int c=0; c<length; c++){
        array[c] = Bitmap.createBitmap(set, c*width, 0, width, height);
    }
    return array;
}

public Bitmap[][] doubleCrop(Bitmap set, int yLength, int xLength){
    int width = set.getWidth()/xLength;
    int height = set.getHeight()/yLength;
    Bitmap[][] array = new Bitmap[yLength][xLength];
    for(int cy=0; cy<yLength; cy++){
        for(int cx=0; cx<xLength; cx++){
            array[cy][cx] = Bitmap.createBitmap(set, cx*width, cy*height, width, height);
        }
    }
    return array;
} 
```

**画布线程：**

```
 _surfaceHolder = surfaceHolder;
    _panel = panel;
    scene = new Scene(_panel);
}

public void setRunning(boolean run) {
    _run = run;
}

@Override
public void run() {
    Canvas c;
    while (_run) {
        try{Thread.sleep(FRAMEWAIT);}catch(Exception ex){}
        c = null;
        try {
            c = _surfaceHolder.lockCanvas(null);
            synchronized (_surfaceHolder) {
                scene.circle(_panel, c);
            }
        } finally {
            if (c != null) {
                _surfaceHolder.unlockCanvasAndPost(c);
            }
        }
    }
} 
```

非常感谢一些建议。

已经非常感谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:02:43.317

您可以将 onTouchListener 直接声明到 Panel 的构造函数中：

```
public class Panel extends SurfaceView{
      Panel(final Context context, AttributeSet attrs){

          setOnTouchListener(new View.OnTouchListener() {

            @Override
            public boolean onTouch(View v, MotionEvent event) {
                //put your logics here
            }
          }   
      }
} 
```

我还认为，由于 CanvasThread 只关心 Panel 上的绘图 - 除了 Panel 之外，什么都不应该知道 CanvasThread。

顺便说一句：在您的示例中，您只需要设置`return false`为`return true`Activity 的 onTouch 方法。我认为它应该可以解决问题。

```
@Override
public boolean onTouch (View v, MotionEvent event){
    //....
    return true; //not false
} 
```

# android - 在 Android 项目中导入 .jar 会导致 Binary XML 文件行错误

> ID：12339038
> 
> 赞同：2
> 
> 时间：2012-09-09T12:24:16.363
> 
> 标签：android, jar, picker

我正在尝试在我的项目中实现其他人库。我已经从 GitHub 下载了源代码，从库项目中创建了 .jar，将其导入到示例项目中，并且工作正常，全部调用。

现在，我以相同的方式将相同的 .jar 添加到我的项目中，当我在 XML 中调用该对象时，我得到了这个：

/AndroidRuntime(983): android.view.InflateException: Binary XML file line #12: Error inflating class net.simonvt.widget.NumberPicker

当我尝试从 .jar 文件打开我的项目中的 .xml 时，我无法做到这一点（也许没关系，到目前为止我从未尝试过，所以）。

我在这里阅读了一些解决方案并尝试将我的 .xml 视图更改为：

```
<view class="net.simonvt.widget.NumberPicker$number_picker"
    android:id="@+id/npAge"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" /> 
```

但同样，应用程序崩溃。

问题>

1.  如果正确构建，.jar 文件是否足够，或者应该以某种方式导入“源”？
2.  将某人的代码导出/导入到您的项目中的正确方法是什么。我认为创建 .jar 并添加到 libs 文件夹是正确的方法，但现在我不明白这个丢失的 .xml

如您所见，simonvt Number picker 是众所周知的，所以我认为我不是第一个尝试导入它的人。

寻求帮助。

编辑1：好的，似乎无论您将.jar 或链接项目链接为“库”项目，您都必须将某些布局.xml 从库复制到主项目，然后它有点工作，但冻结了应用程序。它显示，然后您可以看到对话框冻结和新的系统对话框弹出消息等待/停止应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:47:17.003

我相信您所指的 github 项目需要作为 Android 库项目导入。

基本上，您不能只从库源构建 .jar 文件，因为 Android 构建工具无法看到资源（res/ 目录中的文件）。

您需要做的是将该库作为**Android 库项目**引用。这很容易做到，只需按照此处的说明进行操作：http: [//developer.android.com/tools/projects/projects-eclipse.html#SettingUpLibraryProject](http://developer.android.com/tools/projects/projects-eclipse.html#SettingUpLibraryProject)

有关图书馆项目的更多信息，请查看：http: [//developer.android.com/tools/projects/index.html](http://developer.android.com/tools/projects/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:43:11.040

如果您有库代码的源代码，请将其放在单独的 Android 项目中，并将其指定为库项目（创建项目时有一个复选框可以这样做）。然后通过转到项目的Proprties -> Android，选择添加库（靠近底部）并选择您创建的库项目，将库项目导入您的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T17:06:50.463

在这里研究和阅读之后，我必须将所有 XML 文件复制到我的项目中。因此，当我复制 XML 时，它解决了这个问题。我必须承认我不明白这一点，因为在示例项目中显然不是这样，但我不再有问题了..

# javascript - 在javascript中的每次点击时删除svg行新的最后一个节点

> ID：12339039
> 
> 赞同：1
> 
> 时间：2012-09-09T12:24:34.730
> 
> 标签：javascript, dom, svg

我目前正在开发一个离线应用程序，我使用 Interactive svg。我的问题是在单击事件上删除最后一个节点的 svg 行。情况是......它在（第一次单击）时起作用，它删除了最后一个节点。但是当我再次尝试时..（第二次点击）它不再起作用了。我似乎找不到问题所在。

这是我创建 svg 线段的代码..

```
var glblLineNode;
var tempX=[], tempY=[], tempLine=[];

function drawRoad()
{   
       var path = glblGeogSorc.getElementsByTagName("path")
       for (var loop=0; loop<Slct.length; loop++)
       {
         path[loop].addEventListener("mousedown", function(e)
         {
            if(e.button == 0 &&  glblenblroad === true)
            {

                var mousex = e.clientX - matrixE;
                var mousey = e.clientY - matrixF;

                tempX.push(mousex), tempY.push(mousey);

                if(tempX.length > 1)
                {

                    var road = document.createElementNS("http://www.w3.org/2000/svg", "line");                          
                        road.x1.baseVal.value = tempX[tempX.length -1];
                        road.y1.baseVal.value = tempY[tempY.length -1];
                        road.x2.baseVal.value = tempX[tempX.length -2];
                        road.y2.baseVal.value = tempY[tempY.length -2];
                        road.setAttributeNS(null, "stroke", "#686968");
                        road.setAttributeNS(null, "stroke-width", "14.520");
                        road.setAttributeNS(null, "stroke-linecap", "round");
                        road.setAttributeNS(null, "fill", "none");
                        glblGeogSorc.getElementsByTagName("g")[0].appendChild(road);

                        tempLine.push(road);
                        glblLineNode = road;

                }

            }
        },false);

    }

} 
```

让我们假设函数 drawRoad() 已被执行，那么这是我从函数 drawRoad() 中删除创建的 svg 行的 lastnode 的代码

```
delLastNode.addEventListener("click", function()   //  delLastNode is a var for my button
{

   glblGeogSorc.parentNode.removeChild(glblLineNode);  //glblLineNode is global var prior to the line created
   tempLine.pop();                                    //as well as tempLine[]
   tempX.pop();                                       
   tempY.pop();                                       

},false); 
```

它适用于第一次单击 delLastNode(Button)，但是当尝试再次单击它时它不再起作用了。我的目标是每次我想单击 delLastNode(Button) 时删除每个新的最后一个节点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T20:44:29.010

`glblLineNode`在每个循环上都被覆盖，因此它只包含对最后一个变量的引用（因为循环结束）。当您删除元素时，该引用被破坏，这就是它只工作一次的原因。

您的功能应如下所示：

```
delLastNode.addEventListener("click", function()   //  delLastNode is a var for my button
{
   // .pop() returns the removed element, so let's store it. 
   var deleteElem = tempLine.pop(); 
   glblGeogSorc.parentNode.removeChild(deleteElem);
   tempX.pop();                                       
   tempY.pop();                                       
},false); 
```

不需要全局变量。

# scheme - 什么时候可以覆盖（R7RS）方案中的顶级绑定？

> ID：12339041
> 
> 赞同：2
> 
> 时间：2012-09-09T12:25:02.260
> 
> 标签：scheme, r7rs

[我已经阅读了即将发布的 R7RS 方案标准（小语言）](http://trac.sacrideo.us/wg/raw-attachment/wiki/WikiStart/r7rs-draft-6.pdf)的当前草案，但我不明白在什么情况下重新定义顶级绑定不是错误。

我想可以*定义*或*设置！*第二次在程序顶层引入的绑定。但是从外部库导入绑定呢？是否可以通过标准覆盖这些绑定？

在报告的第 26/27 页上，它说：

> 程序的顶层也可能包括导入声明。在库声明中，使用不同的绑定多次导入相同的标识符，或者使用 define、define-syntax 或 set! 重新定义或改变导入的绑定是错误的。但是，REPL 应该允许这些操作。

这是否意味着在导入绑定的库中确实发生重新定义时只是一个错误？

我知道如果编译器不知道说*+*是否仍然意味着内置添加或任何其他用户指定的错误，它会禁止编译器进行优化。但是从这个角度来看，在库级别限制禁止重新绑定是没有意义的，因为它（至少）对于程序中的导入绑定也是有意义的。

PS：因为这都是关于计划程序的环境：我是否正确地说环境不是一等公民，因为人们无法掌握当前的环境？（这反过来又允许编译的程序忘记选择的绑定名称。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T18:00:48.650

一般原则是在库中声明的绑定只能在同一个库中可移植地变异。如果一个库的绑定被导入一个程序（或另一个库），它们就不能在那里发生变异。因此，如果程序导入`(scheme base)`，则标识符`+`始终引用标准添加例程（当然，在它被 局部遮蔽的区域除外`lambda, let, let*`，或者你有什么）。

在 REPL 或由 REPL 执行的脚本中，此限制不适用。此外，实现可以通过解除限制来扩展标准语言。

与当前全局环境最接近的等价物是 的结果`(interaction-environment)`，它表示 REPL 的可变环境（如果有的话）。如果 REPL 未使用或不存在，您可以通过调用`environment`与当前导入集可能是对应的参数来模拟当前但不可变的环境。R7RS 和它的前辈一样，没有任何词汇环境的表示。

# web-applications - 如何在一个 apache 实例上运行多个站点

> ID：12339044
> 
> 赞同：50
> 
> 时间：2012-09-09T12:25:32.460
> 
> 标签：web-applications, configuration, apache2

按照我在网上可以找到的所有指南，我花了几个小时在圈子里转。

我想让两个站点在一个 apache 实例上运行，就像这样 - 192.168.2.8/site1 和 192.168.2.8/site2

我一直在兜圈子，但目前我在“可用站点（符号链接到启用站点）”中有两个 conf 文件，看起来像这样 -

```
<VirtualHost *:2000>

ServerAdmin webmaster@site1.com
ServerName site1
ServerAlias site1

# Indexes + Directory Root.
DirectoryIndex index.html
DocumentRoot /home/user/site1/

# CGI Directory
ScriptAlias /cgi-bin/ /home/user/site1/cgi-bin/

Options +ExecCGI

# Logfiles
ErrorLog /home/user/site1/logs/error.log
CustomLog /home/user/site1/logs/access.log combined

</VirtualHost> 
```

和

```
<VirtualHost *:3000>

ServerAdmin webmaster@site2.com
ServerName site2
ServerAlias site2

# Indexes + Directory Root.
DirectoryIndex index.html
DocumentRoot /home/user/site2/

# CGI Directory
ScriptAlias /cgi-bin/ /home/user/site2/cgi-bin/

Options +ExecCGI

# Logfiles
ErrorLog /home/user/site2/logs/error.log
CustomLog /home/user/site2/logs/access.log combined

</VirtualHost> 
```

http.conf 看起来像这样-

```
NameVirtualHost *:2000
NameVirtualHost *:3000 
```

目前我收到此错误-

```
[error] VirtualHost *:80 — mixing * ports and non-* ports with a NameVirtualHostaddress is not supported, proceeding with undefined results 
```

Ports.conf 看起来像这样——（尽管没有指南提到需要编辑它）

```
NameVirtualHost *:80

Listen 80
<IfModule mod_ssl.c>
# If you add NameVirtualHost *:443 here, you will also have to change
# the VirtualHost statement in /etc/apache2/sites-available/default-ssl
# to <VirtualHost *:443>
# Server Name Indication for SSL named virtual hosts is currently not
# supported by MSIE on Windows XP.
Listen 443
</IfModule>

<IfModule mod_gnutls.c>
Listen 443
</IfModule> 
```

任何人都可以给出一些简单的说明来让它运行吗？我发现的每一个指南都说要以不同的方式来做，每一个都会导致不同的错误。我显然做错了什么，但没有找到可能是什么的明确解释。

只希望一个站点可在端口 2000 上访问，而另一个站点可在端口 3000 上访问（或其他任何站点，只需选择这些端口进行测试）。

我正在运行 Ubuntu 服务器 12.04…</p>

==============

# 编辑

跟随另一个'指南'......

我现在已经在可用的站点中进行了设置：

```
<VirtualHost *:80>
    DocumentRoot "/home/user/site1/"
    ServerName 192.168.2.10/site1
</VirtualHost>

<VirtualHost *:80>
    DocumentRoot "/home/user/site2/"
    ServerName 192.168.2.10/site2
</VirtualHost> 
```

已在 apache2.conf 中设置：

```
ServerName site1
ServerName site2 
```

已将此添加到 ports.conf：

```
Listen 192.168.2.10:80 
```

===============

# 编辑

它现在可以工作了，我把它放在启用站点的 conf 文件中：

```
<VirtualHost *:81>
    DocumentRoot "/home/user/site1/"
    ServerName site1
</VirtualHost>

<VirtualHost *:82>
    DocumentRoot "/home/user/site2/"
    ServerName site2
</VirtualHost> 
```

我在ports.conf中有这个：

```
Listen *:80
Listen *:81
Listen *:82 
```

我在 apache2.conf 中有这个：

```
ServerName site1
ServerName site2 
```

我在任何指南中都没有找到这个，我只是通过一整天的反复试验让它工作，所以我不知道这是否是一个好的解决方案。但它至少现在按照我想要的方式工作。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-09-09T21:42:17.613

您的问题是混合了几个不同的概念。你开始说你想在同一台服务器上使用相同的域运行站点，但在不同的文件夹中。这不需要任何特殊设置。运行单个域后，您只需在该 docroot 下创建文件夹。

根据您的其余问题，您真正想要做的是在同一台服务器上使用自己的域名运行各种站点。

您会在该主题上找到的最佳文档是 apache 手册中的[虚拟主机](https://httpd.apache.org/docs/current/vhosts/)文档。

有两种类型的虚拟主机：基于名称的和基于 IP 的。基于名称允许您使用单个 IP 地址，而基于 IP 要求每个站点使用不同的 IP。根据您上面的描述，您想使用基于名称的虚拟主机。

您收到的最初错误是由于您使用的端口与`NameVirtualHost`线路不同。如果您确实希望从 80 以外的端口为站点提供服务，则需要`NameVirtualHost`为每个端口创建一个条目。

假设您从头开始，这比看起来要简单得多。

如果您使用的是 2.3 或更早版本，您需要做的第一件事是告诉 Apache 您将使用基于名称的虚拟主机。

```
NameVirtualHost *:80 
```

如果您使用的是 2.4 或更高版本，请不要添加 NameVirtualHost 行。Apache 2.4 版[弃用了该`NameVirtualHost`指令](https://httpd.apache.org/docs/current/new_features_2_4.html)，并将在未来的版本中将其删除。

现在您的虚拟主机定义：

```
<VirtualHost *:80>
    DocumentRoot "/home/user/site1/"
    ServerName site1
</VirtualHost>

<VirtualHost *:80>
    DocumentRoot "/home/user/site2/"
    ServerName site2
</VirtualHost> 
```

您可以在同一个端口上运行任意数量的站点。`ServerName`不同足以告诉 Apache 使用哪个虚拟主机。此外，该`ServerName`指令始终是域/主机名，并且永远不应包含路径。

如果您决定在 80 以外的端口上运行站点，则在访问站点时必须始终在 URL 中包含端口号。因此，您不必访问[http://example.com](http://example.com) ，而是必须访问[http://example.com:81](http://example.com:81)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-04-07T18:01:44.457

是的，使用虚拟主机，您可以拥有任意数量的并行程序：

打开

> /etc/httpd/conf/httpd.conf

```
Listen 81
Listen 82
Listen 83

<VirtualHost *:81>
    ServerAdmin webmaster@site1.com
    DocumentRoot /var/www/site1/html
    ServerName site1.com
    ErrorLog logs/site1-error_log
    CustomLog logs/site1-access_log common
    ScriptAlias /cgi-bin/ "/var/www/site1/cgi-bin/"
</VirtualHost>

<VirtualHost *:82>
    ServerAdmin webmaster@site2.com
    DocumentRoot /var/www/site2/html
    ServerName site2.com
    ErrorLog logs/site2-error_log
    CustomLog logs/site2-access_log common
    ScriptAlias /cgi-bin/ "/var/www/site2/cgi-bin/"
</VirtualHost>

<VirtualHost *:83>
    ServerAdmin webmaster@site3.com
    DocumentRoot /var/www/site3/html
    ServerName site3.com
    ErrorLog logs/site3-error_log
    CustomLog logs/site3-access_log common
    ScriptAlias /cgi-bin/ "/var/www/site3/cgi-bin/"
</VirtualHost> 
```

重启阿帕奇

`service httpd restart`

您现在可以参考 Site1 ：

```
http://<ip-address>:81/ 
http://<ip-address>:81/cgi-bin/ 
```

站点2：

```
http://<ip-address>:82/
http://<ip-address>:82/cgi-bin/ 
```

站点3：

```
http://<ip-address>:83/ 
http://<ip-address>:83/cgi-bin/ 
```

如果路径没有在任何脚本中硬编码，那么您的网站应该可以无缝运行。

# ios - 关于IOS中的全局队列。

> ID：12339046
> 
> 赞同：1
> 
> 时间：2012-09-09T12:25:47.923
> 
> 标签：ios, queue, block

关于 IOS 全局队列，这是一个好主意，我们可以通过子线程使用它来利用多核 CPU，但现在我的问题是如何在这些子线程从队列中分派后管理这些子线程？似乎Apple不提供这样的API。

例如，我创建了一个串行队列，如果一个作业由于某种原因被阻塞，那么整个队列也将被阻塞。事实上我们想管理这个工作，目前似乎没有找到方法。

任何讨论将不胜感激，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:36:20.343

一旦一个块被分派到一个队列中，它就会被执行。没有 API 可以阻止它。

您可以`suspend`使用队列，这将导致挂起的块在队列恢复之前不会执行。但是，没有办法阻止块。

常规方法是在您的代码中进行“检查”以查看运行块是否应该提前停止。

```
// return early from block
if (shouldStop) return; 
```

请注意，您所看到的“问题”是串行队列的确切定义。它只允许操作按照提交到队列的顺序进行处理。您必须等待前面的完成。

您还可以查看`NSOperationQueue`哪个提供了一种更简单的机制来取消在队列中等待的块，但停止正在执行的块的唯一方法是在您的块中实现该机制。

如果你发现你必须取消很多“阻塞”块，那么你的设计很可能有缺陷，你需要重新审视你的设计。

此外，如果正在等待的任务“后面”的任务确实不需要等待该任务，那么为什么要将它们放在串行队列中呢？使用并发队列，或单独的串行队列，或其他一些机制。

现在，让我声明你真的不应该使用调度队列来阻塞 I/O 操作。你可以做到，而且通常是最简单的，但如果你想要你的应用程序的最佳性能特性，你应该使用`dispatch_io`它将更好地与其他 CPU 密集型线程集成。

我想这里最大的收获应该是，而不是试图得到诸如“当当前运行的块被阻塞时如何在串行队列上运行一个块？”之类的答案。您应该问自己如何才能更好地设计您的应用程序，以免出现这种情况。

如果工作不必执行，则不要等待。如果工作必须完成，他们只需要等待......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:41:14.903

如果您需要更好地控制后台队列，而不是使用 GCD 和全局队列，请查看[`NSOperationQueue`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/NSOperationQueue_class/Reference/Reference.html)，它提供了一种[`cancelAllOperations`](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/NSOperationQueue_class/Reference/Reference.html#//apple_ref/occ/instm/NSOperationQueue/cancelAllOperations)方法。我假设您正在使用全局队列，因为您需要并发后台任务，在这种情况下，您可以查看[`setMaxConcurrentOperationCount`](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/NSOperationQueue_class/Reference/Reference.html#//apple_ref/occ/instm/NSOperationQueue/setMaxConcurrentOperationCount%3a)of `NSOperationQueue`，它可以让您将队列定义为并发。

有关操作队列的更多详细信息，请参阅[并发编程指南](https://developer.apple.com/library/ios/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationObjects/OperationObjects.html#//apple_ref/doc/uid/TP40008091-CH101-SW1)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-14T23:59:15.693

我认为您需要为您的任务创建自己的队列并使其并发并根据需要设置优先级。所以你的任务不会被阻止。

```
let queueAttr = dispatch_queue_attr_make_with_qos_class(DISPATCH_QUEUE_CONCURRENT, QOS_CLASS_USER_INITIATED, 0)

let callbackQueue = dispatch_queue_create("myqueue", queueAttr) 
```

# wpf - 强制 ContextMenu 使用系统资源

> ID：12339057
> 
> 赞同：0
> 
> 时间：2012-09-09T12:27:16.753
> 
> 标签：wpf, styles, controls, system, contextmenu

我在我的 app.xaml 文件中导入了控件样式，如

```
<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" /> 
```

但是对于 ContextMenu 控件，我想使用 wpf buildin 样式，我该如何覆盖它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:11:29.533

将`Style`你的设置`ContextMenu`为空：

```
<Window x:Class="WpfApplication11.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <StackPanel>
        <Button Content="A metro style button" Height="42" HorizontalAlignment="Left" Margin="12,12,0,0" Name="button1" VerticalAlignment="Top" Width="163">
            <Button.ContextMenu>
                <ContextMenu Style="{x:Null}">
                    <MenuItem Header="Item1"/>
                    <MenuItem Header="Item2"/>
                </ContextMenu>
            </Button.ContextMenu>
            </Button>
    </StackPanel>
</Window> 
```

如果您想隐式（而不是显式）设置所有 ContextMenus 以使用默认的非 MahApps 样式，请使用：

```
<StackPanel.Resources>
    <Style BasedOn="{x:Null}" TargetType="{x:Type ContextMenu}"/>
</StackPanel.Resources> 
```

不将 Style 设置为 Null。

![在此处输入图像描述](../Images/c15e753f3b73fc37aa3f7d0ec1025738.png)

将样式设置为空。

![在此处输入图像描述](../Images/dd4d0f3f513989836233af12aa97383c.png)

如果您还需要将`MenuItem`样式恢复为默认样式，请使用以下命令：

```
<StackPanel.Resources>
    <Style BasedOn="{x:Null}" TargetType="{x:Type ContextMenu}"/>
    <Style BasedOn="{x:Null}" TargetType="{x:Type MenuItem}"/>
</StackPanel.Resources> 
```

# facebook - Facebook like 按钮没有拾取正确的缩略图

> ID：12339062
> 
> 赞同：1
> 
> 时间：2012-09-09T12:27:50.403
> 
> 标签：facebook

当我在`og:image`元标记中指定图像时，我不知道为什么 facebook like 按钮会从网站主页上拉出随机图像。

这是html：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://ogp.me/ns/fb#">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Keeper Local</title>
    <meta name="description" content="Keeper Local"/>
    <meta name="keywords" content="Keeper Local"/>
    <meta property="og:title" content="KeeperLocal"/>
    <meta property="og:url" content="http://www.keeperlocal.com"/>
    <meta property="og:image" content="http://keeperlocal.com/images/keeperlocallogo.jpg"/>
    <meta property="og:description" content="Local shopping"/>
    <meta property="og:site_name" content="KeeperLocal.com"/>
    <meta property="og:type" content="website"/>
    </head>
    <body>
    <img src="http://keeperlocal.com/images/keeperlocallogo.jpg">
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
    <div id="page-wrap">
        <fb:like url="http://www.keeperlocal.com/test.html" send="false" layout="box_count" show_faces="false" width="50" height="40" action="like" colorscheme="light"></fb:like>
    </div>
    </body>
</html> 
```

如果您想实时查看此测试页面，[请访问 http://www.keeperlocal.com/test.html 。](http://www.keeperlocal.com/test.html)为什么`og:image`元标记被忽略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:08:54.293

你的图太小了。Facebook 要求 og:images 的一侧至少为 200 像素。查看调试器：[https ://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.keeperlocal.com%2Ftest.html](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.keeperlocal.com%2Ftest.html)

# mysql - 嵌套游标循环：列计数与第 1 行的值计数不匹配

> ID：12339064
> 
> 赞同：0
> 
> 时间：2012-09-09T12:28:10.650
> 
> 标签：mysql, loops, cursor, nested, nested-loops

这是我第一次在 MySQL 中处理游标和过程。我已经按照[MySQL 文档中关于 cursors](http://dev.mysql.com/doc/refman/5.0/en/cursors.html)和[roseindia.net](http://www.roseindia.net/mysql/mysql5/cursors.shtml)的示例进行操作，现在遇到错误：

> 列计数与第 1 行的值计数不匹配

以下是所涉及的表（这些表尚未标准化为 3NF，因为我收到它们时是这样，是的，我确实意识到我需要使用 Artists.id 而不是 Artists.name）：

```
CREATE TABLE `user_artists_rankings` (
  `user_id` varchar(50) NOT NULL DEFAULT '' COMMENT 'kpop_users.user_id',
  `artist_name` varchar(100) NOT NULL,
  `calculated_score` int(11) DEFAULT NULL,
  `last_calculated_score_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`user_id`,`artist_name`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;
CREATE TABLE `kpop_users` (
  `user_id` char(50) NOT NULL,
  `username` char(150) DEFAULT '',
  `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`user_id`) USING BTREE,
  KEY `name_idx` (`username`),
  KEY `twitter_id_idx` (`twitter_user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;
CREATE TABLE `artists` (
  `name` varchar(100) NOT NULL,
  `type` varchar(45) DEFAULT NULL,
  `official_twitter_screenname` varchar(45) DEFAULT NULL,
  `thumbnail_url` varchar(500) DEFAULT NULL,
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`id`),
  KEY `Index_2` (`official_twitter_screenname`)
) ENGINE=InnoDB AUTO_INCREMENT=164 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC; 
```

目标是在表 user_artists_rankings 中有 user-artist(n) 行，即：

```
user1 | artist1
user1 | artist2
user1 | artist3
user2 | artist1
user2 | artist2
user2 | artist3 
```

这是我创建的程序：

```
delimiter ;
drop procedure if exists testrun;
delimiter //
create procedure testrun()
begin
    declare d int default 0;
    declare user_id varchar(50);
    declare artist_name varchar(100);
    declare cur_users cursor for select user_id from kpop_users;
    declare cur_artists cursor for select name from artists;
    declare continue handler for sqlstate '02000' set d=1;
    declare continue handler for sqlstate '23000' set d=1;
    open cur_users;
    open cur_artists;
    lbl1: loop 
        if d=1 then 
            leave lbl1;
        end if;
        if not d=1 then
            fetch cur_users into user_id;
            lbl2: loop
                if d=1 then
                    leave lbl2;
                end if;
                if not d=1 then
                    fetch cur_artists into artist_name;
                    insert into user_artists_rankings values (user_id, artist_name);
                end if;
            end loop lbl2;
        end if;
    end loop lbl1;
    close cur_users;
    close cur_artists;
end
//
delimiter ;
call testrun(); 
```

任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:37:02.350

这行代码是错误的：

```
insert into user_artists_rankings values (user_id, artist_name); 
```

由于该表有 4 个字段，并且您仅将其中两个用于 INSERT，因此您需要指定使用哪些字段。它应该是：

```
insert into user_artists_rankings(`user_id`, `artist_name`) VALUES(user_id, artist_name); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T07:34:10.870

在 @Jocelyn 帮助的 INSERT 语句上的初始 boo-boo 之后，我发现我的嵌套循环是错误的。我还必须为嵌套循环添加另一个标签。这是更正后的循环：

```
delimiter ;
DROP procedure IF EXISTS firstrunUser_Artists_Rankings;
delimiter //
CREATE PROCEDURE firstrunUser_Artists_Rankings()
block1: BEGIN
    DECLARE d INT DEFAULT 0;
    DECLARE new_user_id VARCHAR(50);
    DECLARE new_artist_id INT(10);
    DECLARE cur_users CURSOR FOR SELECT `user_id` FROM kpop_users;
    DECLARE cur_artists CURSOR FOR SELECT `id` FROM artists;
    DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET d=1;
    DECLARE CONTINUE HANDLER FOR SQLSTATE '23000' SET d=1;
    OPEN cur_users;
    lbl1: LOOP 
        IF d=1 THEN
         SHOW ERRORS;
            LEAVE lbl1;
        END IF;
        IF NOT d=1 THEN
            FETCH cur_users INTO new_user_id;
            block2: BEGIN
             DECLARE e INT DEFAULT 0;
             DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET e=1;
       DECLARE CONTINUE HANDLER FOR SQLSTATE '23000' SET e=1;
             OPEN cur_artists;
             lbl2: LOOP
                 IF e=1 THEN
                     LEAVE lbl2;
                 END IF;
                 IF NOT e=1 THEN
                     FETCH cur_artists INTO new_artist_id;
                     INSERT INTO user_artists_rankings(`user_id`, `artist_id`) VALUES (new_user_id, new_artist_id);
                     INSERT INTO user_artists_rankings_raw(`user_id`, `artist_id`) VALUES (new_user_id, new_artist_id);
                 END IF;
             END LOOP lbl2;
             CLOSE cur_artists;
            END block2;
        END IF;
    END LOOP lbl1;
    CLOSE cur_users;
END block1;
//
delimiter ;
CALL firstrunUser_Artists_Rankings(); 
```

# javascript - 根据子标签定义父div标签宽度（使用css）

> ID：12339065
> 
> 赞同：0
> 
> 时间：2012-09-09T12:28:31.723
> 
> 标签：javascript, jquery, html, css

我有父 div 标签，他必须是几个子 div 标签，我希望子标签水平放置。计算孩子的 div 标签，不知道高级，在这个上，我不能用 css 设置宽度父 div 标签，为此我使用 js

```
var cnt = $("#parent div").length; // obtain children tags total count
var parent_width = cnt * 102 ;  // 100 is children tag width and 2 is left and right border sum : 100 + 1 + 1

$("#parent").css({
    width: parent_width+"px"
});

<div id="parent" style="height: 100px; background-color: #090">
    <div style="height: 100px; width: 100px; background-color: #009; border: 1px solid #ccc; float: left">
    </div>
    <div style="height: 100px; width: 100px; background-color: #009; border: 1px solid #ccc; float: left">
    </div>
</div> 
```

这行得通，但我认为这必须在没有js的情况下，只有css，请告诉如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:39:11.267

解决方案：

**HTML**

```
<div id="parent">
    <div></div>
    <div></div>
    <div></div>
</div>​ 
```

**CSS**

```
​#parent {
    float: left;
    height: 100px; 
    background-color: #090;  
}

#parent​ > div {
    height: 100px; 
    width: 100px; 
    background-color: #009; 
    border: 1px solid #ccc; 
    float: left;
}​ 
```

结果：http: [//jsfiddle.net/khEKS/](http://jsfiddle.net/khEKS/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:39:55.917

您可以对父元素使用以下 CSS：

```
#parent
{
  background-color:#090;
  height:100px;
  float:left;
} 
```

这样，父母`div`将自动获得适当的宽度，以便孩子可以适应它。

当然，`div`如果您希望它们在同一行中，您还必须在子元素上指定 float 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-18T05:42:04.153

> 显示：内联块；

会为你工作。

您可以对父元素使用以下 CSS：

```
#parent { 
    height: 100px; 
    background-color: #090  
    display: inline-block; 
}

#parent > div {
    height: 100px; 
    width: 100px; 
    background-color: #009; 
    border: 1px solid #ccc; 
}
```

```
<div id="parent">
    <div></div>
    <div></div>
    <div></div>
</div>
```

# java - Java中的编译器即服务

> ID：12339066
> 
> 赞同：5
> 
> 时间：2012-09-09T12:28:47.630
> 
> 标签：java, scala, compiler-construction

Microsoft Roslyn - 编译器即服务是 .NET 堆栈的一个很好的补充；我在 Java 世界中寻找类似的东西。我相信 Scala 有类似的编译器插件形式，但不确定它有多灵活。

我在 Java 世界中试图解决的问题是允许用户编写一些自定义语法，并且在内部它会被重新连接成不同的语法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:37:16.150

我从未使用过 Microsoft Roslyn，所以我不确定它提供了什么。但是，如果您希望能够在运行时编译类，您应该查看自 Java SE 6 以来一直是标准 Java 一部分的[JavaCompiler API](http://docs.oracle.com/javase/6/docs/api/javax/tools/JavaCompiler.html)。如果这不符合您的需求，您可能应该查看[Eclipse 的 ASTParser](http://www.ibm.com/developerworks/opensource/library/os-ast/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T14:20:57.647

Scala 将在下一个版本 (2.10) 中支持宏。您已经可以使用里程碑版本来检查它是如何工作的。基本上，它们允许在编译时修改 AST。因此，您可以在另一块 Scala 中重写任何一块 Scala。查看[scalamacros](http://scalamacros.org/)网站以获取示例和文档。

如果你想在运行时编译 Scala 源码，你可以`Eval`在[twitter/util](https://github.com/twitter/util)项目中寻找。

# .htaccess - 使用 htaccess 在不存在的文件夹中显示页面

> ID：12339069
> 
> 赞同：1
> 
> 时间：2012-09-09T12:29:11.933
> 
> 标签：.htaccess

在我的网站上，我有一个用户配置文件 php 文件，如果您在其中写入`http://www.youdomain.com/user.php?id=[user id]`，它将显示具有该 ID 的用户配置文件。

htaccess 中有没有一种方法，如果写入`http://www.youdomain.com/users/[user id]`，它将显示页面`http://www.youdomain.com?id=[user id]`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:31:55.537

这应该工作:)

```
<IfModule mod_rewrite.c>
Options +FollowSymLinks
RewriteEngine on
RewriteBase /
RewriteRule ^user/(.*)/$ /user.php?id=$1
RewriteRule ^user/(.*)$ /user/$1/ [R]
</IfModule> 
```

# asp.net-mvc - 提交按钮不发布页面

> ID：12339071
> 
> 赞同：0
> 
> 时间：2012-09-09T12:29:17.657
> 
> 标签：asp.net-mvc, razor

单击删除链接（这是一个按钮）没有任何反应。我的意思是没有发布表格。不确定为什么会发生。

```
@foreach (var item in Model) {
<tr>
    <td>
        @Html.DisplayFor(modelItem => item.RegistrationNo)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.FirstName)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.MiddleName)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.LastName)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.DateofBirth)
    </td>
    <td>
        @Html.ActionLink("Edit", "Edit", new { id=item.Id }) |
        @Html.ActionLink("Details", "Details", new { id=item.Id }) |
       <input type="submit" value="Delete" name="Delete" style="border: none; background: none; 
            text-decoration: underline; cursor: pointer;"> 
    </td>
</tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:36:20.757

这是你可以尝试的

```
@using (Html.BeginForm()) {
<table>

@foreach (var item in Model) {
<tr>
    <td>
        @Html.DisplayFor(modelItem => item.RegistrationNo)
        @Html.HiddenFor(modelItem => item.RegistrationNo)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.FirstName)
        @Html.HiddenFor(modelItem => item.FirstName)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.MiddleName)
        @Html.HiddenFor(modelItem => item.MiddleName)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.LastName)
        @Html.HiddenFor(modelItem => item.LastName)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.DateofBirth)
        @Html.HiddenFor(modelItem => item.DateofBirth)
    </td>
    <td>
        @Html.ActionLink("Edit", "Edit", new { id=item.Id }) |
        @Html.ActionLink("Details", "Details", new { id=item.Id }) |
       <input type="submit" value="Delete" name="Delete" style="border: none; background: none; 
            text-decoration: underline; cursor: pointer;"> 
    </td>
</tr>

</table>

} 
```

# c++ - 为什么允许在类之外指定默认值，但不允许在类中指定默认值？

> ID：12339072
> 
> 赞同：4
> 
> 时间：2012-09-09T12:29:23.953
> 
> 标签：c++, constructor, c++11, initialization, default-value

```
#include <atomic>
std::atomic<int> outside(1);
class A{
  std::atomic<int> inside(1);  // <--- why not allowed ?
}; 
```

[错误](http://ideone.com/hsYyW)：

```
prog.cpp:4:25: error: expected identifier before numeric constant
prog.cpp:4:25: error: expected ',' or '...' before numeric constant 
```

在 VS11 中

```
C2059: syntax error : 'constant' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-09T12:31:59.897

类内初始化器不支持`(e)`初始化的语法，因为设计它的委员会成员担心潜在的歧义（例如，众所周知的`T t(X());`声明将是模棱两可的，并且没有指定初始化，但声明了一个带有未命名参数的函数）。

你可以说

```
class A{
    std::atomic<int> inside{1};
}; 
```

或者，可以在构造函数中传递默认值

```
class A {
  A():inside(1) {}
  std::atomic<int> inside;
}; 
```

# delphi - 具有高级格式选项的列表框组件？

> ID：12339075
> 
> 赞同：4
> 
> 时间：2012-09-09T12:29:39.123
> 
> 标签：delphi, listbox, components, delphi-xe

我正在寻找一个提供高级文本格式选项的列表框样式组件。

我知道您可以使用 OnDrawItem 过程来绘制常规列表框，但是对于我需要的要求，我认为使用可能已经提供我正在寻找的控件会更好。

看这个示例截图：

![在此处输入图像描述](../Images/2053b24643909c9c333cba5cb2975ac0.png)

`Word Styling`- 允许单个字符/单词的样式不同。

`Text Links`- 某些输入到列表框中的项目可以被识别为链接（虽然不一定是 url 链接）。在此示例中，棕色狐狸被标记为链接，当鼠标移到棕色狐狸文本上时，字体变为下划线。选择此项可以执行任何操作，例如显示消息、打开表单等。

注意，选择列表项时，字体样式应保持不变。此外，如果列表框可以支持图像（尤其是连续的几个图像），那将是一个奖励。

我在想 HTML 列表框或类似的东西可能正是我所需要的。这将允许将项目输入到列表框中，例如带有标签的代码。

谁能推荐一个提供这种功能的组件？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T14:01:03.087

TMS Software的[THTMListbox](http://www.tmssoftware.com/site/htmlistb.asp)可以做到这一切。它可以支持图像甚至动画 gif。

但它不是免费的，实际上是捆绑包（HTML 控件包）的一部分。我认为它非常值得一看，而且支持是首屈一指的 + 你会收到完整的源代码。

# android - 来自另一个应用程序的 Android 调用方法

> ID：12339083
> 
> 赞同：13
> 
> 时间：2012-09-09T12:30:50.287
> 
> 标签：android, methods, static, package

我有 2 个安卓应用程序。两者都安装在手机上。假设两者的包名称是 com.android.test1 和 com.android.test2。如何`Main2method()`从 test1.Main 类中调用该方法？

test1 的类：

```
package com.android.test1;
import android.app.Activity;
import android.os.Bundle;

public class Main extends Activity {  

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
} 
```

测试2类：

```
package com.android.test2;
import android.app.Activity;
import android.os.Bundle;

public class Main2 extends Activity {  

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    public static void Main2method() {
        //do something..
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-09T13:11:40.790

也许你可以广播一个 Intent 来调用它。

```
Intent it = new Intent("com.android.test2.Main2method");
context.sendBroadcast(it) 
```

进入`BroadcastReceiver`以`com.android.test2.Main2`接收广播：

```
public class ActionReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        if ("com.android.test2.Main2method".equalsIgnoreCase(intent.getAction())) {
            Main2method();
        } 
    }
} 
```

`onCreate`在类的方法中注册接收者`Main1`：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    ...

    receiver = new ActionReceiver();
    IntentFilter filter = new IntentFilter();
    filter.addAction("com.android.test2.Main2method");
    registerReceiver(receiver, filter);
    ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T13:27:13.160

如果你想从 app1 向 app2 发送回调：

1.  您应该`Intent`使用 app1 中的数据自行处理。（看看`PendingIntent`）。
2.  进入您的 app2，您应该注册`BroadcastReceiver`将处理您的 app1 的`Intents`.
3.  `onReceive`每次当您的 Intent 被 app1 抛出并被 app2 捕获时，将调用广播接收器的 方法（在 app2 中）。（把你的逻辑放在那里）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-09T12:35:24.713

为了在不同的应用程序之间调用方法，您需要使用[Intent](https://developer.android.com/guide/components/intents-filters.html)

你也需要[intent-filter](https://developer.android.com/reference/android/content/IntentFilter.html) 和[BroadcastReceiver](https://developer.android.com/reference/android/content/BroadcastReceiver.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T13:24:06.337

您不能直接从另一个应用程序调用一个应用程序的方法。相反，您必须从另一个活动调用一个活动并使用 Intent 过滤器获取结果。

这些链接可能会对您有所帮助

[http://www.vogella.com/articles/AndroidIntent/article.html](http://www.vogella.com/articles/AndroidIntent/article.html)

[http://saigeethamn.blogspot.in/2009/08/android-developer-tutorial-for_31.html](http://saigeethamn.blogspot.in/2009/08/android-developer-tutorial-for_31.html)

# umbraco - 覆盖 umbraco 中的 PostAuthenticate 事件

> ID：12339090
> 
> 赞同：0
> 
> 时间：2012-09-09T12:32:02.067
> 
> 标签：umbraco

我想覆盖 PostAuthenticate 事件。在简单的 asp.net 中，我可以通过在 Global.asax 文件中覆盖/实现此方法来做到这一点。我花了一天时间寻找在 umbraco (umbraco v 4.7.1 (Assembly version: 1.0.4281.20201)) 中实现这一点的解决方案，但没有找到任何成功。

我编写了一个名为 CustomApplicationGlobal 的类，并从 umbraco.Global 基类继承它并将其放在 App_Code 文件夹中。我还从 bin 文件夹中删除了**App_Browsers.dll**和**App_global.asax.dll 。**但我观察到我的代码甚至没有执行/运行。

请帮助我，让我知道我该怎么做？在 umbraco 中是否有其他替代方法可以做到这一点？

在这方面的任何帮助都将非常有用。

问候，

/里兹万

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T17:35:14.063

从 Umbraco 4.8.0 起，不再需要 App_global.asax.dll，因此您可能需要考虑升级到更新的版本。

也就是说，您不想删除 App_Browsers.dll，它有助于 Umbraco 定位不同的浏览器功能。

除此之外，我对 PostAuthenticate 事件没有任何经验，但是 Umbraco 不会妨碍您自己的自定义 global.asax 代码。如果您删除 App_global.asax.dll，那么还要确保添加一个继承自您自己的类而不是 Umbraco 的 global.asax 文件，否则它将不会被使用。仅将类放在 App_Code 文件夹中可能还不够，请确保将其编译为 dll，这样您还可以附加调试器并查看它是否被命中以及为什么它没有执行您的代码。

您可以（对于 4.7.1）尝试继续您目前采取的路线，但留下 dll 并尝试这种方法： [http ://blog.mattbrailsford.com/2010/07/11/registering-an-应用程序启动事件处理程序在 umbraco/](http://blog.mattbrailsford.com/2010/07/11/registering-an-application-start-event-handler-in-umbraco/)

# javascript - 如何在 textarea 中显示数组值？

> ID：12339092
> 
> 赞同：0
> 
> 时间：2012-09-09T12:32:04.023
> 
> 标签：javascript, loops

我试图用 join() 分隔数组值，但它似乎不起作用，它只返回数组的最后一个值。如果我使用警报，它会同时显示值。

```
var span_text=100;
var val= [window["tma"+kj]; //input box values from input 1 - 20 e.g. tma1, tma2,......,tma20 
if(span_text<250){
    if(val>=5 && val<=10){
         $(div3).show();// dth div shown if the condition is met
         counter1++; // number of elements in found in the condition
         var once =[window["tma"+kj].toFixed(2)];//value of the input box in an array concatinated to two deciamal places
         var kl = new Array(once);
         var alphy= kl.join(',');
         $('#com').val(alphy);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:21:54.360

如果你的数组看起来像我下面的例子，你可以这样做：

```
<textarea id="ta" rows="5" column="5"></textarea> 
```

```
var a =[1,2,3,4,5];
for (var i=0; i<a.length; i++) {
    $('#ta').append(a[i]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:41:17.137

```
var once =[window["tma"+kj].toFixed(2)]; 
```

您现在有一个包含该特定 tma 输入的单元素数组。

```
var kl = new Array(once); 
```

您现在拥有相同的单元素数组的副本。

所以你正在创建一个只有一个元素的数组。其余的价值应该来自哪里？

如果要从所有 tma 框中收集值，可以执行以下操作：

```
var values = []
for (var i=0; i<20; ++i) {
    values[i] = window["tma"+(i+1)].toFixed(2)
} 
```

...假设`toFixed`甚至在首先在元素上调用时返回您想要的内容。这对我来说似乎很奇怪。

# java - Eclipse Juno 的 Websphere 6.1 插件

> ID：12339094
> 
> 赞同：2
> 
> 时间：2012-09-09T12:32:58.267
> 
> 标签：java, eclipse, eclipse-plugin, sts-springsourcetoolsuite, websphere-6.1

我正在努力寻找适用于 eclipse juno 的 Websphere 6.1 插件。

我在 IBM 网站上没有找到任何东西。

（我想安装 STS ide 。我知道这个 ide 是基于 eclipse juno 的）。

我将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T08:11:03.933

遗憾的是，任何 Eclipse 版本（除了 ibm 版本）中都不支持 WAS 6.1。

[Eclipse Helios 对 WAS 6.1 的支持](https://stackoverflow.com/questions/9015224/eclipse-helios-support-for-was-6-1)

# svn - SVN 的正确程序

> ID：12339095
> 
> 赞同：0
> 
> 时间：2012-09-09T12:33:52.207
> 
> 标签：svn, version-control, tortoisesvn

感谢之前对 SVN 的一些帮助，我已经开始在我们公司实施 SVN 方面取得一些进展。我正在使用 Tortoise SVN，只是有点不确定创建更新的正确工作程序。这是我目前遵循的程序，但有 3 个问题（以粗体显示）。

1.  当我第一次开发网站时，我创建了一个本地工作目录 D:\Sites{mywebsite}
2.  我发布了网站，将所有内容提交到主干并创建了一个名为 1.0 版的标签
3.  我现在需要创建一些更新，所以我从主干创建了一个名为 {my-branch} 的分支**问题 - 每当我想创建一个分支时，我是否必须将主干检出到本地工作目录，然后使用 brancg Tortoise 中的 /tag 选项？如果没有本地工作副本，似乎没有办法用乌龟做到这一点。**
4.  我已使用 switch 命令将本地工作目录从中继更改为 {my-branch}
5.  一旦我完成了对分支的所有更改并且我对一切都感到满意，我需要合并分支和主干。**问题 - 我不确定我应该在这里做什么 - 我是将主干合并到我的工作副本（现在是一个特定的分支）还是将我的分支合并回主干？**
6.  **问题 - 一旦我发布了更改，我是否应该创建另一个标签版本 1.1/2.0 等？**

根据阿克顿的非常好的反馈，我只是更新问题以澄清最后一点：

1) 1 月 1 日，我创建了一个名为“新上传器的实现”的分支。我将代码签出到我的工作副本并进行更改，直到 1 月 20 日（我去分支时签入）。

2）在此期间，两名团队成员创建了自己的分支，发布了更改并合并回主干。

3) 2 月 1 日，我准备发布。根据 Akton 的反馈，我将当前主干合并到我的工作副本（这是我的分支）中。我解决了任何问题，然后**将所有内容提交回我的分支**吗？现在这将包含我的两个同事也合并到分支中的两个代码更新。我不确定我的分支现在是否还应该包含来自其他团队成员的其他更新？

4）最后我将我的分支合并回主干 - 但这肯定应该非常简单，因为我的分支现在几乎是主干的镜像但现在也只包含我的更新？

如果我上面列出的理解是正确的，我想我明白了！

感谢你的帮助。

问候， 艾尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:08:57.310

> 问题 - 每当我想创建一个分支时，我是否必须将主干检出到本地工作目录，然后使用 Tortoise 中的 brancg/tag 选项？如果没有本地工作副本，似乎没有办法用乌龟做到这一点。

不，您不需要本地副本来创建分支。您可以在 Tortoise SVN“repo 浏览器”的右键菜单中进行操作。有关更多信息，请参阅[http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-repobrowser.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-repobrowser.html)。

> 问题 - 我不确定我应该在这里做什么 - 我是将主干合并到我的工作副本（现在是一个特定的分支）还是将我的分支合并回主干？

您可以将工作副本中的任何剩余更改合并回分支，然后将分支合并到主干。目标是将分支中的更改返回到主干。

[编辑：更改了以下段落] 但是，实际上，在将工作副本提交到分支之后，最好先合并主干 -> 工作副本并解决任何冲突，特别是如果从那时起对主干进行了许多更改分支已建立。一旦完成，工作副本 -> 分支 -> 主干合并应该很简单，并且对其他人造成的干扰最小。

> 问题 - 一旦我发布了更改，我是否应该创建另一个标签版本 1.1/2.0 等？

这取决于您的标记策略。请记住，每个提交都有一个唯一的修订号，您可以随时参考。标签允许您使用更易于理解的名称快速查找或引用修订。另请参阅[SVN 标签的最佳实践？](https://stackoverflow.com/questions/372321/best-practice-for-svn-tags).

[编辑：添加]

> 3) 2 月 1 日，我准备发布。根据 Akton 的反馈，我将当前主干合并到我的工作副本（这是我的分支）中。我解决了任何问题，然后**将所有内容提交回我的分支**吗？现在这将包含我的两个同事也合并到分支中的两个代码更新。我不确定我的分支现在是否还应该包含来自其他团队成员的其他更新？

是的。将更改提交回分支（以便将它们备份到源代码控制）并将更改合并回主分支。目的是确保合并回主干尽可能少地扰乱团队。您可以事先在分支外测试您的应用程序，以确保所有更改都按预期工作，并且没有无意中创建的错误。

# qt - 使用 Qt 时“缺少分隔符”出错是什么意思？

> ID：12339099
> 
> 赞同：2
> 
> 时间：2012-09-09T12:34:33.070
> 
> 标签：qt, makefile

我正在创建一个简单的 Qt 程序，当我运行时`make`，我得到以下信息：

```
make -f Makefile.Debug
make[1]: Entering directory `/c/Users/Ola/Desktop/gotocell'
Makefile.Debug:59: *** missing separator.  Stop.
make[1]: Leaving directory `/c/Users/Ola/Desktop/gotocell'
make: *** [debug] Error 2 
```

这些错误是什么意思？而且，如果`make`正确进行，我应该期待什么输出（即`.exe`）？

文件内容`.pro`如下：

**编辑**添加`target`

```
######################################################################
# Automatically generated by qmake (2.01a) Sun Sep 9 08:26:50 2012
######################################################################

TEMPLATE = app
TARGET = gotocell.exe
DEPENDPATH += .
INCLUDEPATH += .

# Input
FORMS += gotocelldialog.ui 
```

**编辑**

在中修改目标后`.pro`，我得到以下信息：

```
c:\QtSDK\Desktop\Qt\4.8.1\msvc2008\bin\qmake.exe -o Makefile gotocell.pro
make -f Makefile.Debug
make[1]: Entering directory `/c/Users/Ola/Desktop/gotocell'
Makefile.Debug:59: *** missing separator.  Stop.
make[1]: Leaving directory `/c/Users/Ola/Desktop/gotocell'
make: *** [debug] Error 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:41:25.497

项目配置失败时会出现缺少分隔符错误。

检查您的 .pro 文件并查看 qmake 输出的内容。

这是一个应该生成良好 Makefile 的 .pro 文件示例

```
######################################################################
# Automatically generated by qmake (2.01a) Sun Sep 9 08:26:50 2012
######################################################################

TEMPLATE = app
TARGET = myapp # I think that .exe is not neccessary
DEPENDPATH += .
INCLUDEPATH += .

SOURCES = main.cpp mainWindow.cpp
HEADERS = mainWindow.hpp

# Input
FORMS += gotocelldialog.ui 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-23T12:41:41.647

我遇到了同样的问题。而且我使用的是qt提供的“Qt 4.8.4 Command Prompt”。然后我在这个终端中使用“qmake -project”、“qmake”、“nmake”、“debug/hello.exe”。没关系。祝你好运:)

# c - C中的变量地址

> ID：12339105
> 
> 赞同：-1
> 
> 时间：2012-09-09T12:36:06.793
> 
> 标签：c, windows, winapi

这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
int main(){
    char *dd,aaa[500];
    strcpy(aaa,"test 1");
    dd=aaa;
    printf("1\. %s\n",dd);
    strcpy(aaa,"test 2");
    printf("2\. %s\n",dd);

system("pause");
return 0;
} 
```

当我通过字符串更改`aaa`变量时，也会更改，为什么？`test 2``dd`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T18:32:08.990

如果您说出您正在尝试做的事情以便其他人能够正确看待您的代码，那可能会很棒。

现在你似乎还没有很好地理解指针是如何工作的。由于您的代码不是很容易阅读，因此答案将是一般性的。

指针“持有”指向内存的地址。如果你有`ptr1`指向内存块的`A`指针和指向`ptr2`的指针`ptr1`，如果你改变了`ptr1`，自然`ptr2`会经历同样的变化。在您的第一个代码块中，您似乎不明白为什么`someVar`更改后`otherVar`更改。为了更明确地指出@dmp 所指出的，您已经告诉您程序（操作系统正在为您的程序管理内存）`someVar`将指向`otherVar[0]`. 现在，当`otherVar[0]`更改时，`someVar`将会更改，因为指针应该是这样工作的，它被称为取消引用指针 - 当您请求指针指向的值时 - 您会注意到事情发生了变化 pr`ptr2`. 因此，请再次阅读有关指针的内容。

在您的第二个代码块中，我不知道您要完成什么，但无论它是什么，它都会`SEGFAULT`。之所以如此，是因为您还没有理解指针、数组之间的关系以及动态内存分配的工作原理。例如，在`splittext`函数中你有这一行：

`wchar_t *arr[2],*loc = wcsstr(stri, del), buf[DEFAULT_BUFLEN];`

就在那里：您告诉操作系统`*arr`在您尚未为其分配内存的情况下检查第三个单元格的值。此外，在分配内存时，请记住：

1.  如果要分配内存`char`以获取字符串，则指针必须是指向`char`如下的指针：

`char* my_string = malloc( 256*sizeof(char))`

现在你想将内存分配给指向类型变量的指针`FILE*`。如果你写`FILE** my_files = malloc( NUMBER_OF_FILES*sizeof(FILE))`它会给你带来麻烦。而是写：

`FILE** my_files = malloc( NUMBER_OF_FILES*sizeof(FILE*))`

这与您如何为 say 分配内存有关`arr`。

1.  也不要强制转换的返回值`malloc`。它将隐藏编译器可能捕获的许多错误！

总而言之，首先尝试了解指针，然后再进一步了解指针、数组和内存分配的高级用法；其次，您不能输入不正确的代码（您会知道它不正确，要么它不编译，要么只是崩溃）并告诉其他人：“嘿，看看那个变量，这就是我的问题所在。” 尝试对问题进行更多研究，尝试了解哪些工具可以提供帮助——在这种情况下是调试器——这将提高你的问题的质量。第三也是最后一点，如果英语不是您的第一语言，您可以提及它，其他人将愿意协助您重新提出问题。

希望下次你会做得更好！

**更新**

OP编辑后，现在的问题更清楚了，OP的问题是关于指针的。

`dd`的值发生变化，因为：

`aaa`是这样的指针：`char aaa[500]`相当于`char* aaa = malloc(500*sizeof(char))`. 现在，当`dd=aaa`您告诉编译器`dd`将指向相同的内存地址时`aaa`。因此，每次修改`aaa` `dd`都会被修改，因为它们指向内存中的相同内容。

如果不清楚，请尝试重新阅读指针的定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T00:24:21.197

快速指针课程应该可以清除它：

这条线上会发生什么？字符 *dd = aaa;

您创建了一个指向名为 dd 的字符分配的指针，并将其指向存储 aaa 的内存地址。

aaa 的地址在堆栈上并且是静态的（您使用 aaa[500] 隐式创建了它）。

现在，当您将数据放入 aaa 时，aaa 在内存中的位置不会改变，只是存储在内存中该位置的数据。当您尝试打印 aaa 的“内容”时，您将获得存储在内存中的字符。当您将新数据复制到 aaa 时，内存中的位置仍然保持不变，因此 dd 仍然指向与 aaa 相同的内存空间。

如果这不比其他人更清楚，我很抱歉......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:40:41.880

但是，您的要求尚不清楚，C 中的指针是按值传递的（指针的副本指向同一位置）。如果取消引用指针并更改指向的值，调用者将看到更改。

# windows - Windows Server 2008 上的 .net 框架 4

> ID：12339112
> 
> 赞同：0
> 
> 时间：2012-09-09T12:36:47.220
> 
> 标签：windows, .net-4.0, windows-server-2008-r2

我遇到了一个问题，我就是不知道如何解决。我有一台装有 windows server 2008 和 .net frameork 4.5 的电脑。我试图在那里运行应用程序，即在.net framework 4.5 上运行，但它向我显示了一个错误.net framework 4 需要。我已经卸载了 NF4.5 并安装了 NF4 并且.... 错误仍然存​​在。我试图编译一个针对 .nf4 的不同应用程序（只是 VS 中的一个默认通知项目），它向我显示了在这台 PC 上运行的相同错误。搜索没有给我关于这个问题的结果......也许有人可以帮助我？

非常感谢您的关注，并为我糟糕的英语感到抱歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T21:58:32.293

我前段时间找到了解决方案，但没有时间在这里回答。我发现它是windows server 2008 RC，不是发布版本和.net framework 4或4.5可以安装在上面，但如果安装它永远不会通过检查。所以？这是一个错误，但仅限于 RC 版本，微软很长时间不支持。

# mysql - 用于地理空间搜索的 MySQL-Solr

> ID：12339114
> 
> 赞同：0
> 
> 时间：2012-09-09T12:37:07.063
> 
> 标签：mysql, solr, lucene, geospatial, postgis

该站点目前主要进行范围搜索（纬度和经度），并带有一些过滤`WHERE color = "red"`类型的子句。然而，使用带有地理空间索引的 MySQL 仍然很慢，我需要加快速度。

**问题：**使用 Solr 进行搜索是个好主意吗？

如果是这样，我应该只将 MySQL 中的范围列复制到 Solr 中，然后`WHERE`在 MySQL 中执行子句，还是在 Solr 中执行两种类型的查询？

我读过 Solr 不是用于存储数据库（即 MySQL）之类的数据。这是否意味着如果我的搜索可以发生在 10 个不同的列（或`field`用 Solr 术语），并且我复制 Solr 的 MySQL 表只有 11 个表，我仍然会保留 MySQL 表，即使它会用完几乎两次尽可能多的存储空间，其中一半是多余的？

看来我正在使用结构化数据（因为每一行都定义了很多列？）并将整个表存储在 Solr 中，而不是在 MySQL 上存储冗余数据，并且 Solr 将在写入时节省存储空间和数据库访问操作的数量。Solr 是一个不错的选择吗？

在速度方面，使用 PostGIS 或 Solr 会更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T15:01:52.010

Solr 具有非常快速的数字/日期范围查询。Solr 3 地理空间利用了这一点，我编写了一个做得更好[的插件。](https://github.com/dsmiley/SOLR-2155)我怀疑 MySQL 更快。

也就是说，如果您要解决的唯一问题是缓慢的地理空间查询，那么引入 Solr 可能会解决它，但会为您的系统增加很多整体复杂性，因为它并非旨在取代关系数据库——它与它们一起工作. 不要误会我的意思；Solr 很棒，特别是对于分面导航和文本搜索。但是您没有声明您想利用 Solr 的主要功能。

PostGIS 是迄今为止最成熟的开源 GIS 存储系统。我建议您尝试将其作为实验，看看它是否更好。我会尝试使用 lat + lon 对列的方法，就像您现在使用 MySQL 所做的那样，并且我也会尝试使用 PostGIS 本地地理空间方法来执行此操作，无论它到底是什么。

您可以在 MySQL 或 PostGIS 中尝试的一件事是将纬度和经度值四舍五入到小数位数以获得所需的适当精度水平，这肯定远低于双精度的完整精度。如果您将它们存储在浮点数而不是双精度数中，则精度上限为 2.37 米。如果要扫描的不同值较少，您使用的系统可能会更轻松地进行范围查询。

# javascript - 变量声明：对每个变量使用 var 关键字，还是逗号？

> ID：12339119
> 
> 赞同：3
> 
> 时间：2012-09-09T12:38:01.890
> 
> 标签：javascript, syntax, var, variable-declaration

在函数顶部声明变量时，这两种方式有区别吗？

```
var firstvar;
var secondvar;
var thirdvar; 
```

和

```
var firstvar,
    secondvar, 
    thirdvar; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T14:55:15.640

这里有一篇写得很好的博客文章，关于[多个 var 语句](http://benalman.com/news/2012/05/multiple-var-statements-javascript/)与单个语句。我不得不说我非常同意 Ben Alman：当我几年前开始使用 JS 时，我使用单语句，但出于维护和可读性的原因，我改用了多语句。当然，我仍然在有意义的地方使用单个 var 语句（例如，当我不必为这些变量赋值并且它们都在逻辑上相关时）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T12:42:47.920

常用的静态代码分析工具[JSLint](http://jslint.com/)会告诉您将它们全部组合成一个 var 语句。[在这个问题](https://stackoverflow.com/questions/810313/what-is-the-reason-behind-jslint-saying-there-are-too-many-var-statements)的答案中有一个公平的解释为什么这是一个好主意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-09T12:43:00.160

尝试在整个代码中保持一种风格。不管是哪一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-09T12:42:20.070

这纯粹是个人喜好问题。大多数人似乎都使用这种`var x, y, z`方式（每行一个变量）。

JSLint 还[建议](http://www.jslint.com/lint.html#scope)只使用一个`var`语句，但该工具的规则显然也受到其开发人员偏好的影响。

但是，我已经看到很多自动缩进工具（例如，Vim 可用的每个工具）在使用多变量`var`语句时在某些情况下会中断，所以如果你也是这种情况，你最好使用单独的`var`陈述。

# android - SQLiteDatabase.Query 方法中的多个 OrderBy

> ID：12339121
> 
> 赞同：4
> 
> 时间：2012-09-09T12:38:19.023
> 
> 标签：android, sqlite, sql-order-by

我正在使用的查询方法`SQLiteDatabase`。我需要有关此方法的*orderBy*参数的帮助。

`Cursor cursor = sqLiteDatabase.query(tableName, tableColumns, whereClause, whereArgs, groupBy, having, orderBy);`

```
public Cursor getAllCustomexp(int TID) throws SQLException 
{
    Cursor mCursor =
            db.query(false, CEXP_TABLE, new String[] {KEY_CEID, FLD_CETID, FLD_CEEID, FLD_CEMID,
            FLD_CEAMT, FLD_CESEL}, FLD_CETID + " = " + TID, null,
            null, null, FLD_CEEID, null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;
} 
```

问题1：在上述查询中，结果集将按`FLD_CEEID`升序还是降序排序？

问题2：如果我需要先对结果集进行排序`FLD_CEEID`，然后再`FLD_CEMID`按此查询的参数构造排序。

是否可以使用此方法进行多个订单？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T13:03:41.850

来自[SQLite 文档](http://www.sqlite.org/lang_select.html#orderby)：

> 如果返回多行的 SELECT 语句没有 ORDER BY 子句，则返回行的顺序是未定义的。或者，如果 SELECT 语句确实有 ORDER BY 子句，则附加到 ORDER BY 的表达式列表确定将行返回给用户的顺序。首先根据 ORDER BY 列表中最左边的表达式的计算结果对行进行排序，然后通过计算最左边的第二个表达式来打破平局，依此类推。返回所有 ORDER BY 表达式计算结果为相等值的两行的顺序未定义。每个 ORDER BY 表达式可以选择后跟关键字 ASC（首先返回较小的值）或 DESC（首先返回较大的值）之一。如果既没有指定 ASC 也没有指定 DESC，

答案 1：结果集将按升序排序。

答案 2：

```
String orderBy = FLD_CEEID + " ASC, " + FLD_CEMID + " ASC";
db.query(false, CEXP_TABLE, new String[] {KEY_CEID, FLD_CETID, FLD_CEEID, FLD_CEMID,
        FLD_CEAMT, FLD_CESEL}, FLD_CETID + " = " + TID, null,
        null, null, orderBy, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:42:53.843

它的工作方式类似于`SQL Select Order By`. 您可以在此处找到详细信息：[http](http://en.wikipedia.org/wiki/Order_by_(SQL) ://en.wikipedia.org/wiki/Order_by_(SQL )。

# google-app-engine - NDB 投影和缓存问题

> ID：12339126
> 
> 赞同：0
> 
> 时间：2012-09-09T12:38:42.340
> 
> 标签：google-app-engine, python-2.7, google-cloud-datastore

我对 NDB 投影查询的工作方式以及缓存在幕后的行为方式有一些疑问

所以给定一个类似的模型：

```
class Users(ndb.Model):
    user_name = ndb.StringProperty(required=True)
    user_email = ndb.StringProperty(required=True)
    user_password = ndb.StringProperty(required=True)

    @classmethod # THIS ONE DOES NOT WORK
    def get_profile_info(cls, id):
        return ndb.Key(Users, id).get(projection=[Users.user_name])

    @classmethod # THIS ONE WORKS
    def get_profile_info(cls, id):
        return Users.query(Users.key == ndb.Key(Users, id)).get(projection=[Users.user_name]) 
```

为什么第一个类方法会引发“TypeError：未知配置选项（'projection'）”？我不能简单地调用直接获取密钥的投影，而不必查询密钥吗？

其次，关于缓存，我不确定我是否正确理解了这个线程：[NDB Caching When Using Projected Queries](https://stackoverflow.com/questions/12128424/ndb-caching-when-using-projected-queries)

计划的查询没有被缓存吗？这是否意味着简单地调用 get() （并获取整个实例）以便缓存而不是投影更好？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:22:20.143

根据错误，使用 get 时投影没有意义。从文档中“它只获取投影中那些属性的值。它从查询索引中获取这些数据（因此，投影中的属性必须被索引）”。所以做 get 不是通过索引访问对象属性。请注意 gvr 在您引用的问题中对缓存的评论。

# c# - LINQ 在 long 和 long[] 类型属性上使用 Join（一对多变体）

> ID：12339132
> 
> 赞同：0
> 
> 时间：2012-09-09T12:39:18.133
> 
> 标签：c#, linq, join, lambda, one-to-many

我正在尝试找到一种更好的方法来使用 LINQ 和 Lambda 表达式编写有效的 JOIN，希望使用 Join 来处理以下类型：

```
public class Patent
{
    public string Title { get; set; }
    public string YearOfPublication { get; set; }
    public long[] InventorIds { get; set; }
}

public class Inventor
{
    public long Id { get; set; }
    public string Name { get; set; }
} 
```

后续数据是这样创建的：

```
public static class PatentData
{
    public static readonly Inventor[] Inventors = new Inventor[]
    {
        new Inventor(){
            Name="Benjamin Franklin", Id=1 },
        new Inventor(){
            Name="Orville Wright", Id=2},
        new Inventor(){
            Name="Wilbur Wright", Id=3}
    };
    public static readonly Patent[] Patents = new Patent[]
    {
        new Patent(){
            Title="Bifocals", YearOfPublication="1784",
            InventorIds=new long[] {1}},
        new Patent(){
            Title="Flying machine", YearOfPublication="1903",
            InventorIds=new long[] {2,3}}
    };
} 
```

为了遍历特定专利的所有发明者，我使用下面的代码。

```
IEnumerable<Patent> patents = PatentData.Patents;
IEnumerable<Inventor> inventors = PatentData.Inventors;

foreach(Patent p in patents)
{
    var iall = inventors.Where(i => p.InventorIds.Contains(i.Id));
    foreach (Inventor i in iall)
    {
        Debug.WriteLine(p.Title + ": " + i.Id);
    }
} 
```

虽然上面的代码运行良好，但我真的很想使用 LINQ Join 语句。显然，问题在于 LINQ Join 语句会抱怨不同的类型（long 和 long[]），它们分别是主键和外键。

我本来希望使用但似乎无法正常工作的代码如下：

```
Patent [] patents = PatentData.Patents;
Inventor [] inventors = PatentData.Inventors;

var result = patents.Join(inventors, patent => patent.InventorIds, inventor => inventor.Id, (patent, inventor) => new
{
    patent.Title,
    inventor.Name
}); 
```

这是失败的，非常正确，出现以下错误：

*错误 CS0411：无法从中推断方法“System.Linq.Enumerable.Join(System.Collections.Generic.IEnumerable, System.Collections.Generic.IEnumerable, System.Func, System.Func, System.Func)”的类型参数用法。尝试明确指定类型参数。*

所以，我的问题是：

与这两种类型结合使用时，如何修复出现错误的代码以使用 Join 语句；专利和发明人——根本不修改类型？甚至可能吗？

我很感激我可以更改类型以使它们结构更好，但请幽默一下。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T12:51:49.980

您需要为每个单独的专利加入：

```
var query = from patent in patents
            from inventorId in patent.InventorIds
            join inventor in inventors on inventorId equals inventor.Id
            select new { patent.Title, inventor.Name }; 
```

当然，如果您可以避免使用`Id`模型的一部分，而是将专利的发明人直接与`Inventor`对象联系起来，那会更简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:19:46.187

乔恩的答案正是您所需要的。但是，如果您真的想直接使用`Join()`(and `SelectMany()`，由第二个`from`) 方法表示，而不是隐藏在 LINQ 查询语法后面，您也可以这样做。虽然在这种情况下它要复杂得多：

```
patents.SelectMany(patent => patent.InventorIds,
                   (patent, inventorId) => new { patent, inventorId })
       .Join(inventors, x => x.inventorId, inventor => inventor.Id,
             (x, inventor) => new { x.patent.Title, inventor.Name }) 
```

# c# - 需要 GUI 应用程序中的控制台元素

> ID：12339142
> 
> 赞同：0
> 
> 时间：2012-09-09T12:42:06.003
> 
> 标签：c#, winforms, user-interface, console

我的问题很简短：

如何添加与控制台具有相同功能的元素，查看输出并进行输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:46:46.933

尝试使用[`RichTextBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox)或[`WebBrowser`](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser)控制。

如果您确实需要在*代码项目*`console control`中查看这篇文章（这个使用）：*`RichTextBox`*

 **   [在 C# 应用程序中嵌入控制台](http://www.codeproject.com/Articles/335909/Embedding-a-Console-in-a-C-Application)*

# spring - 将 CGLIB 代理与 Ehcache CacheManager 一起使用

> ID：12339143
> 
> 赞同：0
> 
> 时间：2012-09-09T12:42:09.933
> 
> 标签：spring, ehcache, spring-aop, cglib

我想在我的 Spring 应用程序中使用 Spring AOP。在创建 AOP 代理时`net.sf.ehcache.CacheManager`，spring 上下文初始化失败，出现以下异常：

```
nested exception is org.springframework.aop.framework.AopConfigException: Could not
generate CGLIB subclass of class [class net.sf.ehcache.CacheManager]: Common causes of 
this problem include using a final class or a non-visible class; nested exception is 
net.sf.cglib.core.CodeGenerationException: net.sf.ehcache.CacheException-->Another   
unnamed CacheManager already exists in the same VM. Please provide unique names for 
each CacheManager in the config or do one of following:
1\. Use one of the CacheManager.create() static factory methods to reuse same  
CacheManager with same name or create one if necessary
2\. Shutdown the earlier cacheManager before creating new one with same name.
The source of the existing CacheManager is: InputStreamConfigurationSource 
[stream=java.io.ByteArrayInputStream@955b34] 
```

这是我对这个问题的理解 - Spring 正在尝试为`net.sf.ehcache.CacheManager`.`__DEFAULT__`应用）。现在，如果我有多个缓存管理器，例如 'abcCacheManager' 和 'xyzCacheManager' （类型为 EhCacheManagerFactoryBean），Spring 会遇到多个`net.sf.ehcache.CacheManager`s 并尝试为所有这些管理器创建代理对象（类似于`net.sf.ehcache.CacheManager$$EnhancerByCGLIB$$b18c5958`），但是使用 EhCache >=2.5 版本，我们同一虚拟机下不能有多个同名缓存。

我正在使用 EhCache 2.5.1，并希望避免仅出于此目的回到 2.4。我不确定这是否真的是我如何克服这个问题的问题。

注意：请注意这是否会有所帮助，但我也从调试语句中注意到`CacheManager`无参数构造函数仅由 spring/CGLIB 代理生成器`xyzCacheManager`调用，并通过将配置作为参数传递来调用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T09:05:07.073

注意：我自己回答这个问题，因为它可能会帮助面临同样问题的其他人。

[jeha](https://stackoverflow.com/users/571271/jeha)对我的问题的评论是有道理的，因为我一开始就不应该需要那个代理，但是由于我是 Spring AOP 和代理的新手，我不知道自动代理机制是如何工作的。由于我修改了建议中的切入点表达式，之后我没有遇到上述问题。在此之前，几乎容器中的所有 bean 都被代理了，因此出现了问题。

# r - 当我在数组上运行函数时，我不断得到 inf 值

> ID：12339148
> 
> 赞同：1
> 
> 时间：2012-09-09T12:42:49.070
> 
> 标签：r, function, statistics

我正在用 R 编写一个函数，它将计算二项分布和正态分布之间的平方和，并将数据显示为`p`

这是我所拥有的：

首先，我生成概率为 p (n=100) 的随机二项式分布

`random_binom<-rbinom(100,100,p)`

`sqrt(np(1-p))`接下来，我根据正态分布找到某个随机元素等于或小于值 np（均值）和标准差的概率

`d_norm<-dnorm(random_binom,p*100,sqrt(100*p*(1-p)))`

然后根据二项式分布，分布中的随机值等于或小于均值的概率

`d_binom<-dbinom(random_binom,100,p)`

最后，我将两者相减，取平方并返回。

`result<-sum((d_norm-d_binom)^2)` `return(result)`

现在在控制台中，我为所有这些创建了一个函数：

我的功能：

```
function(p){
random_binom<-rbinom(100,100,p)
d_norm<-dnorm(random_binom,p*100,sqrt(100*p*(1-p)))
d_binom<-dbinom(random_binom,100,p)
result<-sum((d_norm-d_binom)^2)
return(result)
} 
```

我想为 p where 传递一个向量`p<-(c(0:99)/100)`，但是每当我这样做时，函数都会返回

`inf`

而不是一个值向量。我怎样才能让 R 返回一个值向量以便我可以绘制它们？我曾尝试使用 lapply 但它以一种奇怪的格式返回数据：

```
[[95]]
[1] 0.01064091

[[96]]
[1] 0.01418807

[[97]]
[1] 0.02647295

[[98]]
[1] 0.05065813

[[99]]
[1] 0.1179141

[[100]]
[1] 0.7342808 
```

这意味着每个元素都包含另一个元素，因此很难绘制图表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:48:56.727

问题是当`p`为 0 时，您的函数将有效地执行此操作：

```
dnorm(0, 0, 0)
[1] Inf 
```

也许你想要`p<-(c(1:99)/100)`？

* * *

`lapply`返回一个`list`。您可以使用`unlist`转换为数组。假设您将`lapply`调用的结果分配给`L`. 然后，你可以这样做

```
unlist(L) 
```

# css - 棘手的 Web 表单 - 添加占位符或值

> ID：12339153
> 
> 赞同：0
> 
> 时间：2012-09-09T12:43:08.007
> 
> 标签：css, forms

我正在开发一个包含扩展形式的小网站。我试图弄清楚它是否可能，当您单击展开表单的按钮时，当时是否会出现默认值。

你可以在这里看到主题：http: [//themes.premitheme.com/fullscene/](http://themes.premitheme.com/fullscene/)

单击右上角的放大镜，您会看到它展开。我希望文本以扩展形式出现，而不是在压缩时出现。如果我放置一个“占位符”，您会看到压缩形式的文本，并且它会越过放大镜图标。不漂亮。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T15:08:50.310

该`placeholder`属性非常适合您的问题。

你需要找到这个元素。

```
<input type="text" class="field" name="s" id="s" > 
```

它应该在 search.php 中（可能是 searchform.php ）。然后你想像这样添加你的占位符属性：

```
<input type="text" class="field" name="s" id="s" placeholder="your placeholder"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:03:16.187

在您的事件处理程序或动画结束回调方法（用于展开文本框的动画）中，只需设置`placeholder`属性，然后在/如果搜索框未展开时清除该属性。

# jquery - 动态内容在 jQuery Mobile 中未正确显示

> ID：12339154
> 
> 赞同：0
> 
> 时间：2012-09-09T12:43:09.903
> 
> 标签：jquery, cordova, jquery-mobile, jquery-selectors

我有一个使用 PhoneGap 和 jQuery Mobile 构建的移动应用程序。当用户单击链接时，应用程序会从 SQLite 数据库中获取动态内容。数据使用 jQM 的可折叠集（手风琴）进行格式化。这是代码。

用户导航到正确页面的菜单：

```
<!-- data-role="page" id="mainmenu" -->
<ul data-role="listview" data-theme="c">
  <li><a id="news_link" href="#"> News</a></li>
  <li><a id="news_link" href="#"> Jokes</a></li>
  <li><a id="news_link" href="#"> Rumours</a></li>
</ul>

<!-- data-role="page" id="mainmenu" -->
<div data-role="page" id="news" data-title="AreApp News" data-theme="c">
    <div data-role="header" data-theme="c"></div><!-- /header -->
    <div id="newscontent" data-role="content" data-content-theme="c"></div>
    <div data-role="footer"></div>
</div> 
```

下面我使用被点击元素的 id 进行点击事件检测，并调用数据库加载函数来获取内容并将其放入正确的 div。

```
$(function() {
    $('#news_link').click(function(){ // event handler of newslink
        loadNewsFromDB(function(){
            $.mobile.changePage( $("#news"), { transition: "slideup"} 
         );
    });
});

function loadNewsFromDB(callback){
    //DB-logic and html code generation here....
    $(htmlStr).appendTo( "#newscontent" ).trigger( "create" );
    $("#newscontent").html(htmlStr);
} 
```

当我第一次单击链接时，逻辑运行良好。但是当我按下手机的“返回”按钮，回到主菜单并再次单击链接时，内容格式不正确。我的意思是它显示新闻，但格式不好，因为它应该使用可折叠集，但事实并非如此。

我试图通过将函数的使用绑定到 jQuery 的 remove() 和 empty() 函数来清除内容

```
$(document).bind( "pagebeforechange", function( e, data ) {
    var obj = $.mobile.path.parseUrl( data.toPage );
    if(obj.hash=="#mainmenu"){
        $('#news-collapsible').empty().remove();
    }
}); 
```

但没有结果。我完全接受了挑战，如果有人能告诉我该怎么做，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T16:41:10.363

您需要刷新此可折叠集。

```
$('#newscontent').collapsibleset('refresh'); 
```

# django - Django站点框架国家分离

> ID：12339156
> 
> 赞同：2
> 
> 时间：2012-09-09T12:43:18.137
> 
> 标签：django, internationalization, country, sites

我正在使用 Django 开发一个网站，我们在其中列出产品和一些评论。我想为具有不同产品对象的每个国家/地区建立单独的站点。例如：

us.domain.com - 列出了美国的产品，页面为英文。

fr.domain.com - 列出了法国的产品，页面为法语等。

1）我想到的是根据中间件中请求的子域更改 settings.SITE_ID ，但这据说很危险。我还可以做些什么？我不想为每个国家/地区运行单独的实例或 settings.py 文件。

到目前为止我的解决方案：

```
class SubdomainMiddleware:
    def process_request(self, request):
        host = request.META.get('HTTP_HOST', '')
        try:
            site = Site.objects.get(domain=host)
        except:
            site = Site.objects.get(domain='www.domain.com')
        request.site = site

products = Product.objects.filter(site_id=request.site) 
```

在这里，下面不起作用，因为 CurrentSiteManager 使用 settings.SITE_ID，而不是 request.site：

```
on_site = CurrentSiteManager()

Product.on_site.all() 
```

我必须在每个查询中明确传递 site_id=request.site 。这是安全的，还是有其他选择？

2）如果我将 site = models.ForeignKey(Site) 字段添加到 Product 模型中，就足够了吗？或者我应该将该字段添加到所有其他模型，如评论等？

# php - 将数组从 PHP 文件传递 到 JS 文件

> ID：12339159
> 
> 赞同：0
> 
> 时间：2012-09-09T12:43:24.973
> 
> 标签：php, javascript, html, arrays

我想将我在 PHP 文件中的一个数组传递给另一个用 java 脚本编写的文件。这是我的数组：

```
$pictures = array(
"1" => array("caption" => "1920x1200px", "tag" => "wallpaper", "link" => "#"),
); 
```

在我的 java 脚本文件中，这是我要调用数组的地方：（在我编写 TAG、LINK 和 CAPTION 的代码中它们应该位于的地方。对不起，如果这是一个愚蠢的问题，但如你所见，我对 PHP 和 java 脚本一无所知）

```
F.helpers.title = {
    beforeShow: function (opts) {
        var text = F.current.title,
            type = opts.type,
            title,
            target;

        if (!isString(text) || $.trim(text) === '') {
            return;
        }

        title = $('<div class="fancybox-title fancybox-title-' + type + '-wrap"><h1>' + text + '</h1><p>CAPTION</p></div><div class="fancybox-title fancydownload" ><a href="LINK"><img src="../../../slider/img/download.png" alt=""/></a></div><div class="fancybox-title fancytag"><h2>TAG</h2></div>');

        switch (type) {
            case 'inside':
                target = F.skin;
            break;

            case 'outside':
                target = F.wrap;
            break;

            case 'over':
                target = F.inner;
            break;

            default: // 'float'
                target = F.skin;

                title
                    .appendTo('body')
                    .width(title.width()) //This helps for some browsers
                    .wrapInner('<span class="child"></span>');

                    //Increase bottom margin so this title will also fit into viewport
                    F.current.margin[2] += Math.abs(     getScalar(title.css('margin-bottom')) );
            break;
        }

        if (opts.position === 'top') {
            title.prependTo(target);

        } else {
            title.appendTo(target);
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T12:46:48.067

尝试使用 JSON。有很多可用的 JSON 解析器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T12:48:18.507

将其编码为 JSON 以将其转换为 JavaScript 文字，然后正常访问结果值。

```
var data = <?php echo json_encode(array('foo' => 'bar')); ?>;
console.log(data['foo']); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:48:28.083

PHP 脚本（在服务器端）的生命周期与 JS（在客户端）的生命周期不同。如果您想将一些信息从 PHP 传递到客户端，您可以执行以下操作之一：

1.  您应该使用模板引擎将此信息打印到服务器端本身的 HTML 文件中。
2.  您应该通过另一个 API 返回此信息，方法是将其转换为易于在 javascript 端浏览的 JSON 格式，并使用 AJAX 调用您的 API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T12:48:47.030

使用 ajax 调用，例如 $.post 将数组作为 json 数组，`echo json_encode($picture)`在 PHP 脚本的末尾添加一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T12:49:50.427

PHP 只是生成文件，然后您将其发送给客户端。JavaScript 在客户端执行。所以你应该在php中生成类似

```
var pictures = {'1': {caption: '1920x1200px', tag: 'wallpaper', link: '#'}}; 
```

例如，将其放在脚本标记中的 html 中。

作为一种变体，您可以这样做：

```
var pictures = <?= json_encode($pictures); ?>; 
```

# php - PHP 字符串操作

> ID：12339163
> 
> 赞同：1
> 
> 时间：2012-09-09T12:44:41.463
> 
> 标签：php

我有一个字符串，例如：

> "abc b, bcd vr, cd deb"

我想取这个字符串的第一个单词，直到在这种情况下每个点都会导致“abc bcd cd”。不幸的是，我的代码不起作用。你能帮助我吗？

```
<?php
$string= "abc b, bcd vr, cd deb";
$ay = explode(",", $string);
$num= count($ay); 
$ii= 0;
while ($ii!=$num){
$first = explode(" ", $ay[$ii]);
echo $first[$ii];
$ii= $ii+1;
} 
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:55:56.113

```
<?php
function get_first_word($string)
{
    $words = explode(' ', $string);
    return $words[0];
}

$string = 'abc b, bcd vr, cd deb';
$splitted = explode(', ', $string);
$new_splitted = array_map('get_first_word', $splitted);

var_dump($new_splitted);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:07:49.667

使用[`array_reduce()`](http://php.net/manual/en/function.array-reduce.php)：

```
$newString = array_reduce(
    // split string on every ', '
    explode(", ", $string), 
    // add the first word of every comma section to the partial string  
    function(&$result, $item){

        $result .= array_shift(explode(" ", $item)) . " ";

        return $result;

    }
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:55:42.663

```
<?php
$string= "abc b, bcd vr, cd deb";
$ay = explode(",", $string);
$num= count($ay); 
$ii= 0;
while ($ii!=$num){
$first = explode(" ", $ay[$ii]);
echo ($ii == 0) ? $first[0] . " " : $first[1] . " ";
$ii= $ii+1;
} 
?> 
```

您应该只`$first[$ii]`在获得第一个元素时才使用，因为`explode`在第一个元素的空间之前使用这个 whan。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T12:56:48.037

```
$string= "abc b, bcd vr, cd deb";
$ay = explode(",", $string);
foreach($ay as $words) {
    $words = explode(' ', $words);
    echo $words[0];
} 
```

# mysql - 飞行路线中的连接超时

> ID：12339164
> 
> 赞同：2
> 
> 时间：2012-09-09T12:44:43.570
> 
> 标签：mysql, timeout, migration, version, flyway

我正在使用flyway 1.5和`mysql Ver 14.14 Distrib 5.1.52, for unknown-linux-gnu (x86_64) using readline 5.1`

我写了以下迁移：

```
alter table table1 add column col_11 blob;
alter table table1 add column col_12 varchar(255) DEFAULT NULL;

alter table table2 add column col_21 blob;
alter table table2 add column col_22 varchar(255) DEFAULT NULL; 
```

Where`table1`很小，`table2`有 283,018 行。

迁移成功（列都添加到`table1`和`table2`）但版本更新失败（我得到了`com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: No operations allowed after connection closed.`）。

我的`my.cnf`文件包含下一行`wait_timeout=30`，我认为发生的事情是添加这两列`table2` 花费超过`wait_timout`- 这导致迁移“失败” - 现在我遇到了这种情况：迁移成功但版本未更新。但后来我运行了这个 sql 查询：

```
show variables like "%timeout%"; 
```

得到了这个：

```
+----------------------------+-------+
| Variable_name              | Value |
+----------------------------+-------+
| connect_timeout            | 10    |
| delayed_insert_timeout     | 300   |
| innodb_lock_wait_timeout   | 50    |
| innodb_rollback_on_timeout | OFF   |
| interactive_timeout        | 28800 |
| net_read_timeout           | 30    |
| net_write_timeout          | 60    |
| slave_net_timeout          | 3600  |
| table_lock_wait_timeout    | 50    |
| wait_timeout               | 28800 |
+----------------------------+-------+ 
```

这表明这`wait_timeout`是大约8小时......

所以我的问题是**为什么会发生这种连接超时？**

主要是-我该如何解决？

**编辑：** 应用程序和数据库都在同一台机器上。

这是完整的堆栈跟踪：

```
Current schema version: 12.9.3
Migrating to version 12.9.3.1

Error while extracting database product name - falling back to empty error codes
org.springframework.jdbc.support.MetaDataAccessException: Error while extracting DatabaseMetaData; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: No operations allowed after connection closed.
    at org.springframework.jdbc.support.JdbcUtils.extractDatabaseMetaData(JdbcUtils.java:296)
    at org.springframework.jdbc.support.JdbcUtils.extractDatabaseMetaData(JdbcUtils.java:320)
    at org.springframework.jdbc.support.SQLErrorCodesFactory.getErrorCodes(SQLErrorCodesFactory.java:216)
    at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.setDataSource(SQLErrorCodeSQLExceptionTranslator.java:140)
    at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.<init>(SQLErrorCodeSQLExceptionTranslator.java:103)
    at org.springframework.jdbc.support.JdbcAccessor.getExceptionTranslator(JdbcAccessor.java:99)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:407)
    at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:522)
    at com.googlecode.flyway.core.metadatatable.MetaDataTable.insert(MetaDataTable.java:149)
    at com.googlecode.flyway.core.migration.DbMigrator.applyMigration(DbMigrator.java:248)
    at com.googlecode.flyway.core.migration.DbMigrator$1.doInTransaction(DbMigrator.java:148)
    at com.googlecode.flyway.core.migration.DbMigrator$1.doInTransaction(DbMigrator.java:114)
    at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:128)
    at com.googlecode.flyway.core.migration.DbMigrator.migrate(DbMigrator.java:113)
    at com.googlecode.flyway.core.Flyway.migrate(Flyway.java:619)
    at com.googlecode.flyway.commandline.Main.main(Main.java:79)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: No operations allowed after connection closed.
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.Util.getInstance(Util.java:386)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1013)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:987)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:982)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:927)
    at com.mysql.jdbc.ConnectionImpl.throwConnectionClosedException(ConnectionImpl.java:1205)
    at com.mysql.jdbc.ConnectionImpl.checkClosed(ConnectionImpl.java:1197)
    at com.mysql.jdbc.ConnectionImpl.getMetaData(ConnectionImpl.java:3061)
    at com.mysql.jdbc.ConnectionImpl.getMetaData(ConnectionImpl.java:3056)
    at org.springfra
mework.jdbc.support.JdbcUtils.extractDatabaseMetaData(JdbcUtils.java:285)
    ... 15 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
The last packet successfully received from the server was 654,699 milliseconds ago.  The last packet sent successfully to the server was 17 milliseconds ago.
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1116)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3102)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2991)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3532)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2618)
    at com.mysql.jdbc.StatementImpl.executeUpdate(StatementImpl.java:1749)
    at com.mysql.jdbc.StatementImpl.executeUpdate(StatementImpl.java:1666)
    at org.springframework.jdbc.core.JdbcTemplate$1UpdateStatementCallback.doInStatement(JdbcTemplate.java:512)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:396)
    ... 9 more
Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
    at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:2552)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3002)
    ... 18 more
Application exception overridden by rollback exception
org.springframework.dao.RecoverableDataAccessException: StatementCallback; SQL [UPDATE schema_version SET current_version=0]; Communications link failure
The last packet successfully received from the server was 654,699 milliseconds ago.  The last packet sent successfully to the server was 17 milliseconds ago.; nested exception is com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
The last packet successfully received from the server was 654,699 milliseconds ago.  The last packet sent successfully to the server was 17 milliseconds ago.
    at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:97)
    at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:72)
    at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:80)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:407)
    at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:522)
    at com.googlecode.flyway.core.metadatatable.MetaDataTable.insert(MetaDataTable.java:149)
    at com.googlecode.flyway.core.migration.DbMigrator.applyMigration(DbMigrator.java:248)
    at com.googlecode.flyway.core.migration.DbMigrator$1.doInTransaction(DbMigrator.java:148)
    at com.googlecode.flyway.core.migration.DbMigrator$1.doInTransaction(DbMigrator.java:114)
    at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:128)
    at com.googlecode.flyway.core.migration.DbMigrator.migrate(DbMigrator.java:113)
    at com.googlecode.flyway.core.Flyway.migrate(Flyway.java:619)
    at com.googlecode.flyway.commandline.Main.main(Main.java:79)
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
The last packet successfully received from the server was 654,699 milliseconds ago.  The last packet sent successfully to the server was 17 milliseconds ago.
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1116)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3102)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2991)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3532)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2618)
    at com.mysql.jdbc.StatementImpl.executeUpdate(StatementImpl.java:1749)
    at com.mysql.jdbc.StatementImpl.executeUpdate(StatementImpl.java:1666)
    at org.springframework.jdbc.core.JdbcTemplate$1UpdateStatementCallback.doInStatement(JdbcTemplate.java:512)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:396)
    ... 9 more
Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
    at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:2552)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3002)
    ... 18 more
FlywayException: Migration failed !
Occured in com.googlecode.flyway.core.migration.DbMigrator in method migrate, line number 164
Caused by java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
Occured in com.mysql.jdbc.MysqlIO in method readFully, line number 2552 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-07T16:28:37.000

我们刚刚遇到了这个问题，并设法找到了适合我们的解决方案。Flyway 似乎至少使用了两种连接：一种用于锁定`schema_version`表，另一种用于实际运行更改。当更改需要足够长的时间以导致锁定`schema_version`表的连接超时时，会出现此问题。解决此问题的最简单方法是将 MySQL`wait_timeout`提高到相对较大的值。在我们的例子中，我们将其设置为 480 分钟（或 28800 秒）：

```
set global wait_timeout=28800; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T06:53:41.667

**一点分析：**

由于 Flyway 命令行工具在启动时会创建两个新连接，因此可以排除连接过时的情况。

然后 Flyway 将首先打开元数据表的连接并将其锁定。

然后它将打开第二个连接并执行迁移。我假设这一步需要很长时间（从日志开始 +- 11 分钟）。

迁移完成后，第二个连接上的事务提交，并通过第一个连接将新行添加到元数据表中。

这就是它爆炸的地方......但是通过通信而不是连接超时或锁定超时异常。

**可能是应用程序和数据库之间的某些网络设备（路由器/交换机/代理）正在丢弃非活动连接吗？**

# git - 如何在 Git 中打包所有松散的对象？

> ID：12339165
> 
> 赞同：3
> 
> 时间：2012-09-09T12:45:12.820
> 
> 标签：git

我有一个带有一些松散对象的裸 git 存储库。如何在不更换其他包装的情况下将所有松散的物品打包成一个新包装？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T03:06:04.830

`git pack-objects < object_list.txt`

其中 object_list.txt 有一个对象哈希列表，由 '\n' 分隔。

[git-pack-objects](http://www.kernel.org/pub/software/scm/git/docs/git-pack-objects.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T11:20:57.093

我可以想出：

```
$ git prune-packed
$ find objects/?? -type f | perl -pe 's@^objects/(..)/@$1@' |
  git pack-objects objects/pack/pack
$ git prune-packed 
```

有没有更简单的？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-03-10T18:34:32.530

警告，使用时[`git prune-packed`](https://git-scm.com/docs/git-prune-packed)。

在 Git 2.22（2019 年第一季度）之前，“ `git prune-packed`”没有注意到并抱怨命令行给出的过多参数，现在它确实如此。

请参阅[Ramsay Jones ( ) 的](https://github.com/jeffhostetler)[提交 9b0bd87](https://github.com/git/git/commit/9b0bd87ed2ae444fa0ecf55ba497e666b3911fbb)（2019 年 2 月 11 日[）](https://github.com/jeffhostetler)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([ebf846c 提交中](https://github.com/git/git/commit/ebf846c0086114714c0162c4dc8acbf344740c1d))^(，2019 年 3 月 7 日）)[`jeffhostetler`](https://github.com/jeffhostetler)
^([`gitster`](https://github.com/gitster))

如果`too many arguments`有任何参数传递给`git prune-packed`.

# php - 如何摆脱 PHP Undefined offset 错误？

> ID：12339166
> 
> 赞同：0
> 
> 时间：2012-09-09T12:45:13.823
> 
> 标签：php, arrays

如何摆脱错误：`Undefined offset: 1 on line 20`？我知道它发生是因为我调用的数组偏移量根本不存在。

用@ 屏蔽它似乎根本不对。

```
//create an array with all x, y
for ($x = 1; $x <= 5; $x++) $array_x[] = $x;
for ($y = 1; $y <= 5; $y++) $array_y[] = $y;

$IN_x = "'" . implode("', '", $array_x) . "'";
$IN_y = "'" . implode("', '", $array_y) . "'";

$pullMapInfo = "SELECT x, y, value FROM mapinfo WHERE id='{$id}' AND x IN ({$IN_x}) AND y IN ({$IN_y})";
$pullMapInfo2 = mysql_query($pullMapInfo) or die('error here');

//create an associative array x, y => value
while ($pullMapInfo3 = mysql_fetch_assoc($pullMapInfo2)) {
    $result[ $pullMapInfo3['x'] ][ $pullMapInfo3['y'] ] = $pullMapInfo3['value'];
}

//loop to display output
foreach ($array_x as $x) {
foreach ($array_y as $y) {
    if (array_key_exists($x, $result) && array_key_exists($y, $result)) {
        echo '<div class="castle_array" id="'.$x,'x',$y.'">'. $result[$x][$y] .'</div>
                ';
    } else {
        echo '<div class="castle_array" id="'.$x,'x',$y.'"></div>
                ';
    }
}
} 
```

2 for 循环似乎很尴尬

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:49:44.300

替换这一行：

```
if (array_key_exists($x, $result) && array_key_exists($y, $result)) { 
```

和：

```
if (isset($result[$x][$y])) { 
```

文档：[isset](http://php.net/isset)

对于 Joseph Silber：试试[这个 PHP fiddle](http://www.phpfiddle.org/main/code/0bg-vd4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:47:31.720

您的第二次调用`array_key_exists`应该传入`$result[$x]`：

```
if ( array_key_exists($x, $result) && array_key_exists($y, $result[$x]) ) {
    // Code goes here...
} 
```

# python - Kivy - 单击按钮时编辑标签

> ID：12339167
> 
> 赞同：3
> 
> 时间：2012-09-09T12:45:15.747
> 
> 标签：python, button, refresh, kivy

我希望 button1 在单击时编辑标签“etykietka”，但我不知道如何。你有什么想法吗？

```
class Zastepstwa (App):

def build(self):
    lista=WebOps().getList()
    layout = BoxLayout(orientation='vertical')
    etykietka = Label(text='aa', font_size=10)
    button1 = Button(text='aa')
    button1.bind(callback)
    layout.add_widget(etykietka)
    layout.add_widget(button)
    return layout

def callback (instance):
    newLabelText='kkk'
    #? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T21:58:24.533

你需要将你的标签传递给回调，一个很好的方法是使用部分函数

```
from functools import partial 
```

更改回调签名

```
def callback(label, instance, *args):
    label.text='kkk' 
```

然后像这样绑定回调

```
button1.bind(on_press=partial(callback, etykieta)) 
```

应该这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-25T12:46:47.450

此外，请确保您将回调函数缩进并直接在构建函数之后。否则回调函数将在绑定语句中被识别。

# matlab - 减少使用 randn 创建的随机矩阵中的行数

> ID：12339168
> 
> 赞同：0
> 
> 时间：2012-09-09T12:45:18.460
> 
> 标签：matlab, matrix

我有一个矩阵

```
x = [randn(30,1); 5+randn(30,1)]; 
```

它有 60 行。如何在不影响密度的情况下减少行数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T16:53:48.647

使用 reshape 函数更改矩阵的尺寸而不更改内容：

```
x=reshape(x,m,n) 
```

产生一个 mxn 矩阵。条目数不得更改，因此在您的情况下 m*n 必须等于 60。

# c# - 在 LSP 的上下文中，如何确保继承类不会破坏基类契约？

> ID：12339170
> 
> 赞同：0
> 
> 时间：2012-09-09T12:45:38.403
> 
> 标签：c#, oop, inheritance, liskov-substitution-principle

在 C# 中 - 但它可能适用于其他语言 - 在[LSP](http://www.objectmentor.com/resources/articles/lsp.pdf)的上下文中，我如何确保从另一个（可变）继承的类不会违反原始合同？

例如：如果我有`public`,`internal`或`protected`属性设置器，则存在继承类会破坏原始合同的风险。这同样适用于`virtual`方法。

如果父类和继承类的所有者不是同一个人，则尤其如此，因为这可能会导致合同和原始开发人员的意图缺乏知识。

不变性是唯一的解决方案还是有其他一些方法？我倾向于认为继承对应于“表现得像”-关系而不是“是”-关系。这是一个正确的逻辑保障吗？

为了便于说明，这里有一个示例：

```
public class Foo
{
    public virtual void DummyMethod(int dummyParameter)
    {
        if (dummyParameter > 10) { throw new ArgumentOutOfRangeException(); }
    }
}

public class Bar : Foo
{
    public override void DummyMethod(int dummyParameter)
    {
        if (dummyParameter < 0) { throw new InvalidOperationException(); }
    }
} 
```

我注意到有关此主题的其他一些问题（例如[此处](https://stackoverflow.com/questions/10778354/how-can-i-avoid-beaking-liskov-substitution-principle-lsp)），但我正在寻找通用解决方案或良好实践来避免提前面对这些问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T15:00:27.587

`sealed`您可以通过使用关键字来防止违反 LSP 。

这意味着您现在根本无法从该类继承，因此您必须决定您更喜欢哪一个：消除违反 LSP 的风险或继承和修改的自由。

感谢@Hans Passant 在评论中首次提及密封。

# c++ - 未定义对“_WSAStartup@8”的引用。如何将库与 NetBeans 链接？

> ID：12339171
> 
> 赞同：3
> 
> 时间：2012-09-09T12:46:29.473
> 
> 标签：c++, dll, netbeans, linker, winsock2

我使用带有 G++ 编译器的 NetBeans、Windows 和 Cygwin。

我正在检查 Windows Sockets 2。我做了所有在 MS[手册](http://msdn.microsoft.com/en-us/library/windows/desktop/ms737629%28v=vs.85%29.aspx)中写的事情。我有一个代码（主要来自本手册）：

```
#include <winsock2.h>
#include <ws2tcpip.h>

#include <cstdlib>
#include <iostream>

#pragma comment(lib, "Ws2_32.lib")

int main() {

  WSADATA wsaData;

  int iResult;

  // Initialize Winsock
  iResult = WSAStartup(MAKEWORD(2,2), &wsaData);
  if (iResult != 0) {
     printf("WSAStartup failed: %d\n", iResult);
     return 1;
  }
  else cout << "Initialization OK.";

  return 0;
} 
```

当我尝试运行项目时遇到问题：

```
undefined reference to `_WSAStartup@8' 
```

我明白那`Ws2_32.lib`是缺失的。这是因为我没有安装 Windows SDK。但在安装它之前，我想尝试一下 Cygwin 提供的工具。它有所有的`w32api`头文件，我把它们放在：

```
C:\cygwin\usr\include\w32api 
```

它在目录中有一些`w32api`几乎`.lib`文件：

```
C:\cygwin\lib\w32api 
```

但是所有这些 lib 文件都是不同的，它们具有`.a`扩展名和稍微不同的名称，例如：

```
libws2_32.a  // in Cygwin
   vs.
ws2_32.lib   // in Windows 
```

当我使用 Cygwin 终端创建`.exe`文件时，一切正常。我输入的命令是：

```
cd C:\\c++\\myProgram           // go to the dir
g++ myProgram.cpp -lws2_32      // compile using -l option to link libws2_32.a 
```

之后我得到`a.exe`文件。我运行它并且它有效：

```
./a.exe    // Initialization OK. 
```

但正如我所说，我使用的是 NetBeans。如果我尝试从 NB（`[F6]`按钮）运行项目，我总是有这个错误**undefined reference to '_WSAStartup@8'。**

我已经尝试了所有可以在 NB 论坛上找到的东西。我试图以`libws2_32.a`这种方式链接到我的项目。我去：

```
File -> Project Properties -> Linker -> Libraries 
```

并且有三个选项：

```
Add Library...
Add Library File...
Add Option... 
```

我都试过了。我试图将两者链接`Add Library...`起来`Add Library File...`。我还尝试在`Add Option...`按钮中添加这样的选项：

```
Add Option... -> Other option ->    // and I input here "-lws2_32" 
```

但无论我做什么，我都无法从 NB 运行该项目，我收到错误**未定义对“_WSAStartup@8”的引用。**

所以看起来这不是代码中的问题（错误）。似乎问题出在 NB 上，它有可能链接库。或者我做了错误的步骤将它们附加到项目中。

所以我的问题是：

1）我做错了什么？如何直接从 NB 运行项目？我没有尝试安装 Windows SDK，我想尝试使用 Cygwin 工具，因为它具有此类工具。

`.lib`2) Windows文件和 Cygwin文件有什么区别`.a`？安装 Windows SDK 并忘记这些`.a`文件会更好吗？到目前为止，我在 Cygwin 网站上能找到的关于它们的一切都是这样的：

> 导入库是一个常规的类 UNIX .a 库，但它只包含告诉操作系统您的程序如何与（“导入”）dll 交互所需的少量信息。此信息链接到您的 .exe。这也是由 dlltool 生成的。

3）是否可以使用`#pragma comment(lib, "libws2_32.a")`链接`.a`文件？我试过但没有得到成功的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T13:39:00.147

> 1）我做错了什么？如何直接从 NB 运行项目？我没有尝试安装 Windows SDK，我想尝试使用 Cygwin 工具，因为它具有此类工具。

试试这个：[http ://forums.netbeans.org/ptopic44959.html](http://forums.netbeans.org/ptopic44959.html)

> 2) Windows .lib 文件和 Cygwin .a 文件有什么区别？安装 Windows SDK 并忘记那些 .a 文件会更好吗？

在这种特殊情况下，这两个文件都称为“导入库”。导入库基本上是一个包含有效函数列表的文件，因此当您链接 exe 时，链接器知道这些函数将存在于某个特定的 DLL 中。因此，当您链接到 wsock32.lib 或 ws2_32.lib 时，链接器现在知道这些函数将存在于 wsock32.dll 和 ws2_32.dll 中。因此，它不会抱怨。现在，.lib 导入库格式是微软的格式。GCC/unix/linux/mingw/cygwin 等具有不同的格式，该格式的扩展名为**.a**。现在，cygwin/mingw 等提供了一个**ws2_32.a**以便在使用 cygwin/mingw/gcc 时，链接器可以以正确的格式读取导入库。cygwin/mingw/gcc 根本无法理解**.lib**. 微软在他们的 SDK 中提供了**.lib**文件，但我不确定这在这种情况下会有什么帮助。（虽然 SDK肯定*是*有用的，因为它为您可能需要的其他有用的东西提供了大量的*头文件*和 DLL，但是导入库是无用的，因为 gcc/mingw/cygwin 不会理解它们；除非您使用转换工具，就像您在[重复问题](https://stackoverflow.com/questions/12314779/ws2-32-lib-vs-libws2-32-a-whats-the-difference-and-how-to-link-libws2-32-to-n)中提到的那样）。

> 3) 是否可以使用 #pragma comment(lib, "libws2_32.a") 链接 .a 文件？我试过但没有得到成功的结果。

不，#pragma 链接注释是特定于 MSVC（丑陋的 IMO）的扩展。使用菜单中的链接器选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-21T07:21:34.387

日食，赛格温

属性 -> C/C++ 构建 -> 设置 -> Cygwin C 链接器

命令行模式

添加到 -lws2_32

例如）${COMMAND} ${FLAGS} ${OUTPUT_FLAG} ${OUTPUT_PREFIX}${OUTPUT} ${INPUTS} -lws2_32

# windows - 合并/加入文件 *.001、*.002、*.003.. 而不复制到新文件

> ID：12339172
> 
> 赞同：2
> 
> 时间：2012-09-09T12:46:34.617
> 
> 标签：windows, file, join

如何在不复制到新文件的情况下将文件合并为一个？
资料来源：我有 file.dd.001、file.dd.002、file.dd.003、file.dd.004 ...
任务：我有 600 个文件（1.5 Gb）。所有这些文件的容量：大约 900 GB。硬盘容量：1.5 TB。我无法使用 Total Commander 或 7-zip 或 WinRAR 加入这些文件，因为硬盘容量无法复制到新文件中（可用空间不足）。
需要：加入文件，可能会执行多次程序，但是：
1）加入 100 个第一个文件（150 GB）。删除拆分的文件（前 100 个）。
2) 将接下来的 100 个文件加入**到此合并文件 (150 GB)**中。删除这 100 个文件。
3) 将下 100 个文件加入合并文件 (300 GB)...
问题：谁能告诉我如何将文件合并（加入）到新的越来越大的文件中？也许软件存在，或者是用 C# 代码解决这个问题的最后机会。有任何想法吗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T12:51:08.270

自己写吧。

打开文件#1。寻求结束。打开文件#2，开始读取内容并附加到文件#1。

完成后，删除文件#2，然后继续处理文件#3。

在合理的脚本语言中应该小于 10 行。

我不了解 Windows，但在 unix 上你可以这样做：

```
for num in `seq -w 2 600`; do
    cat file.dd.$num >> file.dd.001
    rm file.dd.$num
done 
```

注意附加`>>`输出重定向的使用。

您可能可以通过使用`dd`而不是加快速度`cat`，它应该使用零拷贝传输（即让内核完成工作，而不是将文件读入内存并将其写入输出流）。

```
 dd if=file.dd.$num of=file.dd.001 conv=notrunc oflag=append bs=10M 
```

这应该让你接近你的硬盘可以在 IO 上提供的任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T14:11:54.850

感谢@Anony-Mousse 提供了有用的 Linux 代码示例
问题已经解决了……<br/> Windows 有 cmd 命令，我在**Harlan Harvey 所著的 Windows Forensic Analysis Dvd Toolkit 2E (2009)**一书中找到了该命令。448：

```
D:\Images>type image.001 >  image_all.img
D:\Images>type image.002 >> image_all.img
D:\Images>type image.002 >> image_all.img 
```

如果我有文件 300 Gb ( *image_all.img* )，我需要加入 50 个文件 (1,5 Gb)，我需要：

```
D:\Images>type image.200 >> image_all.img
D:\Images>type image.201 >> image_all.img
D:\Images>type image.202 >> image_all.img
D:\Images>type image.203 >> image_all.img
….
D:\Images>type image.498 >> image_all.img
D:\Images>type image.499 >> image_all.img 
```

或更好：

```
D:\Images>type image.* >> image_all.img 
```

并将文件夹中的所有文件（带掩码）连接到文件*image_all.img*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-04T12:26:09.573

我假设您想合并这些文件以简化处理，对吧？如果这是您的目标，那么更有效的方法是使用 FIFO 文件。在 *nix（linux、macos、*bsd 等）上，您可以使用 mkfifo 命令创建一个“表示”所有文件的 FIFO 文件，如下所示：

```
mkfifo mybigfile
cat file.dd.* > mybigfile &
{{process}} mybigfile 
```

**mybigfile**文件将包含您的 file.dd.{001,002,003...} 文件的所有内容，您可以将所有这些文件作为一个大文件处理。一旦您的进程完成读取文件，**mybigfile**将是空的，要“重新填充”它，您需要执行“ **cat file.dd.* > mybigfile &** ”命令

现在，原始问题包含许多微软 Windows 参考（C#、w​​inrar 和总指挥官），所以我认为作者需要一个 Windows 解决方案。我不是 Windows 人，但我相信以上内容可以在 cygwin 下或通过使用命名管道和 PowerShell 使用（但我可能完全错了）

# javascript - 如何使函数可用于其他 javascript 文件？

> ID：12339174
> 
> 赞同：1
> 
> 时间：2012-09-09T12:46:41.053
> 
> 标签：javascript, jquery

我有以下代码：

$(文档).ready(函数 () {

```
function loginLinkClick(e) {
    e.preventDefault();
    $('#loginLink').unbind('click', loginLinkClick);
    dialog(this);
}
function registerLinkClick(e) {
    e.preventDefault();
    $('#registerLink').unbind('click', registerLinkClick);
    dialog(this);
}

$('#loginLink')
    .bind('click', loginLinkClick);
$('#registerLink')
    .bind('click', registerLinkClick);
$('#logoutLink')
    .click(function (e) {
        window.location = $(this).attr('data-href')
    }); 
```

});

我想让我的 loginLinkClick 和 registerLinkClick 函数可用于其他 javascript 文件。有没有办法我可以做到这一点？我正在使用 jQuery，所以我应该将它们放入 jQuery 命名空间或类似的东西中吗？

还有一个问题。从性能或可维护性的角度来看，我是否应该在 $(document) 之外拥有类似的功能

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T12:48:51.907

使功能在该范围之外可用，而不是

```
function loginLinkClick(e) { } 
```

尝试将它们添加到窗口对象

```
window.loginLinkClick = function(e) { } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T12:48:34.890

从本地命名空间中删除它们并在“其他 javascript 文件”之前导入此文件，这些功能将可供它们使用。

[从这篇文章](https://stackoverflow.com/questions/2645344/functions-inside-or-outside-jquery-document-ready)中引用 Torok Gabor ：

> 把它放在里面，这样它就不会污染全局命名空间。由于 JavaScript 的作用域链，它还确保更快地解析函数名称。
> 
> 如果它是可重用组件，请将其放在外面，以便您可以轻松地将其移动到单独的文件中并从不同的上下文中调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-09T12:50:13.307

要么将函数添加到`window`对象中，要么将它们移出本地`function`范围。

```
$(document).ready(function () { 
    window.loginLinkClick = function (e) {
        e.preventDefault();
        $('#loginLink').unbind('click', loginLinkClick);
        dialog(this);
    };
}); 
```

或者：

```
function loginLinkClick(e) {
    e.preventDefault();
    $('#loginLink').unbind('click', loginLinkClick);
    dialog(this);
};

$(document).ready(function () { ... }); 
```

# .net - VB .Net 在按钮单击时添加动态控件

> ID：12339177
> 
> 赞同：1
> 
> 时间：2012-09-09T12:46:54.737
> 
> 标签：.net, vb.net, variables, dynamic-controls

*大家好，*

我正在创建一个程序，用户可以在其中监控他的预算。首先，用户输入使用的金额，然后用户应该详细说明他的费用。

例如，我使用了 20 美元，详细说明：

*   冰淇淋 2 美元
*   15 美元的食物
*   未指定 3 美元

用户应该能够单击“+”按钮，每次他这样做时，都会创建一个字段/自定义控件，用户可以在其中输入一个值。

理论上，用户应该能够创建无限数量的字段。我该如何做到这一点？我知道如何扫描用户*DirectCast*等的所有字段，我只是不知道如何动态创建这些字段。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:13:16.557

执行此操作的标准方法是使用`DataGridView`. 它是一种允许您动态添加行的表。您可以将 绑定`DataGridView`到各种数据（列表、数据集等）。

另一种方法是使用 a`TableLayoutPanel`并为其动态添加控件。但这需要更多编码才能跟踪添加的控件。

VB 电动工具有一个数据转发器控件（它也可以在 C# 中使用）。它基本上像数据网格一样工作，但对行使用模板，允许您以任何顺序在模板上放置任何控件，然后对每一行重复。

# mysql - 合并这两个查询

> ID：12339182
> 
> 赞同：3
> 
> 时间：2012-09-09T12:47:21.893
> 
> 标签：mysql, sql, merge

我将这两个查询单独列出，但现在我需要将结果放在同一个列表中。

现在我通过使用javascript按id排序项目来“修复”它。但是从服务器合并这些数据会很棒，这样我就可以对结果进行分页了..

数据库架构

桌友：

![在此处输入图像描述](../Images/8a68572ad9ba15eb91203f29c672142d.png)

表帮助

![在此处输入图像描述](../Images/c7ee681df7fcc8c7a3e26e582262c6ce.png)

查询 A（返回**当前用户**的结果）

```
 $sql = 'SELECT * FROM helps WHERE id_user ='.$value; 
```

查询 B（返回**当前用户好友的**结果）

```
$sql = 'SELECT
    h.*,
    f.* 
    FROM (
            SELECT
                     id  AS friendsId,
                     CASE followerid WHEN '.$value.' THEN followingid ELSE followerid END AS friend_id
                        FROM friends
                        WHERE acepted = 1
                        AND (followerid  = '.$value.' OR followingid = '.$value.')
                    ) AS f
                        INNER JOIN helps AS h ON h.id_user = f.friend_id
                        ORDER BY h.id DESC'; 
```

有没有办法合并这些查询？老实说，我不知道该怎么做。

-编辑-

考虑联合，但我不知道如何处理订单..

```
$sql = '(SELECT * FROM helps WHERE id_user = '.$value.')
                    UNION
                    (SELECT
                                h.*,
                                f.* 
                            FROM (
                                SELECT
                                    id  AS friendsId,
                                    CASE followerid WHEN '.$value.' THEN followingid ELSE followerid END AS friend_id
                                FROM friends
                                WHERE acepted = 1
                                AND (followerid  = '.$value.' OR followingid = '.$value.')
                            ) AS f
                                INNER JOIN helps AS h ON h.id_user = f.friend_id
                                ORDER BY h.id DESC)'; 
```

正如您在第二个查询中看到的，帮助表已重命名为 h。我怎样才能在第一次做同样的事情？（两个查询都以相同的格式返回数据）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T13:50:31.030

要合并这两个查询和订单记录的结果，您需要将[UNION ALL](http://dev.mysql.com/doc/refman/5.5/en/union.html)与`GROUP BY`. 试试这个查询：

```
SELECT h.id AS id, h.title, h.content, id_user, h.id_group,
       h.id_type, h.id_lic, h.avatar, h.attached, h.attached,
       h.fetcha, h.likes, h.lan, h.needsCount, h.receivedCount,
       MAX(h.fid) AS fid, MAX(h.friend_id) AS friend_id
FROM (   
      SELECT h.id AS id, h.title, h.content, id_user, h.id_group,
             h.id_type, h.id_lic, h.avatar, h.attached, h.attached,
             h.fetcha, h.likes, h.lan, h.needsCount, h.receivedCount,
             0 AS fid, 0 AS friend_id
      FROM helps h
      WHERE h.id_user ='.$value.'

      UNION ALL

      SELECT h.id, h.title, h.content, id_user, h.id_group,
             h.id_type, h.id_lic, h.avatar, h.attached, h.attached,
             h.fetcha, h.likes, h.lan, h.needsCount, h.receivedCount,
             f.id AS fid, f.friend_id
      FROM (
             SELECT id  AS friendsId,
                    CASE followerid WHEN '.$value.' THEN followingid
                                    ELSE followerid
                    END AS friend_id
             FROM friends
             WHERE acepted = 1
                   AND (followerid  = '.$value.' OR followingid = '.$value.')
            ) AS f
            INNER JOIN helps AS h
                ON h.id_user = f.friend_id
     ) h
GROUP BY h.id
ORDER BY h.id DESC; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T09:19:05.880

的基本规则`UNION`是

*   每个查询返回的列数必须相等，并且
*   数据类型必须相互匹配。

如您所见，我没有修改您制定的查询。只是我为每个查询添加了一个*虚拟列*。此列将用于对所有记录进行排序。查询被另一个包装，`select statment`因此虚拟列不会显示在结果列表中，但它将是对记录进行排序的基础。下面的查询结果包含最顶部的用户记录（*因为`ORDER BY OrderBy ASC`*），然后是按好友ID排序的用户好友记录。如果您想要任何澄清，请通知我。还有一件事，我`f.*`在您的第二个查询中删除了，因为它不是必需的，并且可能由于列（*number*）不匹配而导致您的语法错误。

```
SELECT  ID, Title, Content, ID_User, ID_Group, 
        ID_Type, ID_Loc, Avatar, Attached, Fecha, Likes, 
        Lan, NeedsCount, RecivedCount
FROM
    (
        SELECT *, 1 as OrderBy           -- first query you formulated
        FROM helps 
        WHERE id_user = '.$value.'
        UNION
        SELECT  h.*, 2 as OrderBy        -- second query you formulated
        FROM    (
                    SELECT  id  AS friendsId,
                            CASE followerid 
                                WHEN '.$value.' THEN followingid 
                                ELSE followerid 
                            END AS friend_id
                    FROM    friends
                    WHERE   acepted = 1 AND 
                            (followerid  = '.$value.' OR followingid = '.$value.')
                ) AS f
                    INNER JOIN helps AS h 
                        ON h.id_user = f.friend_id
    ) x
ORDER BY OrderBy ASC, ID DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:49:36.557

`UNION`如果两个查询的结果集相似，请尝试运算符

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T15:36:12.680

就像 Omesh 描述的那样做一个 UNION，然后处理排序，这样做：

```
SELECT * FROM
(
    ....Omesh's code....
) T
ORDER BY T.id DESC 
```

# android - Sherlock ActionBar onActivityResult 未在 Fragment 中调用

> ID：12339184
> 
> 赞同：2
> 
> 时间：2012-09-09T12:47:37.317
> 
> 标签：android, actionbarsherlock, fragment

在我的应用程序中，我有一个 SherlockFragmentActivity，它托管一个带有 4 个选项卡的操作栏。每个选项卡都是一个 SherlockFragment。从其中一个选项卡（比如说 Tab1）调用普通 Activity 与 startActivityForResult(myIntent1, 0) 一起工作正常；

但是我在 Tab1 中的 onActivityResult 永远不会被调用。在阅读了很多主题后，我了解到我的主要活动的 onActivityResult 是首先被调用的，这确实是。但是我无法将值传递给我的片段的 onActivityResult。

这是我的代码...

主要活动：

```
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    Fragment mFragment = Fragment.instantiate(this, Tab1.class.getName());
    mFragment.onActivityResult(requestCode, resultCode, data);
    super.onActivityResult(requestCode, resultCode, data);
} 
```

还尝试在第一行使用超级呼叫而没有超级呼叫。

分段：

```
public void onActivityResult(int requestCode, int resultCode, Intent data){
    //super.onActivityResult(requestCode, resultCode, data);
    Toast.makeText(context, String.valueOf(requestCode), Toast.LENGTH_SHORT).show();

    if(requestCode == 0) {
        if(resultCode == Activity.RESULT_OK) {
            //do some stuff here
        }
    }
} 
```

还尝试在开始和结束时使用超级呼叫。

每次我得到同样的错误：

```
09-09 14:33:34.230: E/AndroidRuntime(7408): FATAL EXCEPTION: main
09-09 14:33:34.230: E/AndroidRuntime(7408): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=65536, result=-1, data=null} to activity {com.BlubBlub.TimeMate/com.BlubBlub.TimeMate.TimeMateActivity}: java.lang.NullPointerException
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3267)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.app.ActivityThread.handleSendResult(ActivityThread.java:3310)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.app.ActivityThread.access$1100(ActivityThread.java:142)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1256)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.os.Looper.loop(Looper.java:137)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.app.ActivityThread.main(ActivityThread.java:4930)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at java.lang.reflect.Method.invokeNative(Native Method)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at java.lang.reflect.Method.invoke(Method.java:511)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at dalvik.system.NativeStart.main(Native Method)
09-09 14:33:34.230: E/AndroidRuntime(7408): Caused by: java.lang.NullPointerException
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.widget.Toast.<init>(Toast.java:92)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.widget.Toast.makeText(Toast.java:238)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at com.BlubBlub.TimeMate.Tab1.onActivityResult(Tab1.java:125)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at com.BlubBlub.TimeMate.TimeMateActivity.onActivityResult(TimeMateActivity.java:150)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.app.Activity.dispatchActivityResult(Activity.java:5192)
09-09 14:33:34.230: E/AndroidRuntime(7408):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3263) 
```

什么是让它工作的正确方法？我现在真的很绝望……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:13:31.037

您正在创建片段的新实例。此实例未附加到 Activity，因此 getActivity() 返回 null。它也不是当前显示在您的选项卡中的片段。

从 Fragment 启动 Activity 时，您必须使用[Fragment#startActivityForResult(Bundle, int)](https://developer.android.com/reference/android/app/Fragment.html#startActivityForResult%28android.content.Intent,%20int%29)。然后 FragmentActivity 将为您处理将其分派到正确的 Fragment。您不必手动执行此操作。

使用 startActivityForResult 时，请确保在执行任何操作之前始终检查 resultCode 是否与您传递给 startActivityForResult 的代码相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T14:13:20.827

试试 call `Fragment.startActivityForResult`，`Fragment.getActivity().startActivityForResult`如果你这样做了。请参阅 android 源代码并注意尊重。

```
//Fragment.java
////////////////
/**
 * Call {@link Activity#startActivityForResult(Intent, int)} on the fragment's
 * containing Activity.
 */
public void startActivityForResult(Intent intent, int requestCode) {
    if (mActivity == null) {
        throw new IllegalStateException("Fragment " + this + " not attached to Activity");
    }
    mActivity.startActivityFromFragment(this, intent, requestCode);
}

// FragmentActivity.java
////////////////////////
/**
 * Called by Fragment.startActivityForResult() to implement its behavior.
 */
public void startActivityFromFragment(Fragment fragment, Intent intent, 
        int requestCode) {
    if (requestCode == -1) {
        super.startActivityForResult(intent, -1);
        return;
    }
    if ((requestCode&0xffff0000) != 0) {
        throw new IllegalArgumentException("Can only use lower 16 bits for requestCode");
    }
    super.startActivityForResult(intent, ((fragment.mIndex+1)<<16) + (requestCode&0xffff));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:57:39.190

您的堆栈跟踪表明您在 Toast 类中有 NullPointerException，所以我认为准确接收`onActivityResult()`回调不是问题。

我的猜测是您将空上下文传递给`Toast.makeText()`调用

如果您从 Activity 中显示 Toast，请执行以下操作：

```
Toast.makeText(this, "Message", Toast.LENGTH_SHORT).show(); 
```

如果您显示 Toast 是一个片段：

```
Toast.makeText(getActivity(), "Message", Toast.LENGTH_SHORT).show(); 
```

如果这样做，则传递给的 Context`Toast.makeText()`不应为 null，并且您将避免此异常。

# javascript - Ajax 图像预览

> ID：12339187
> 
> 赞同：0
> 
> 时间：2012-09-09T12:47:48.607
> 
> 标签：javascript, jquery, ajax

我想做一个“更改头像”的东西，它不是基于上传的照片，而是基于带有外部链接的图片（类似于“http://google.com/img.jpg”），所以你可以在哪里实际上可以更改您的头像并在单击“进行更改”后显示您的新头像。我问是否有任何可能的方式，当您在单击“更改”之前将链接自动放入表单以可视化图像。我'我不太喜欢 JavaScript 和 AJAX，但我认为它会出现在 ajax 上。欢迎任何答案 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T12:59:41.740

Hey you need to use `onchange` of file upload to do something for ya. But i think you should go for this plugin. It works good.

[http://jquery.malsup.com/form/#getting-started](http://jquery.malsup.com/form/#getting-started)

# javascript - 如何添加动态自定义的 ShareThis 按钮？

> ID：12339196
> 
> 赞同：1
> 
> 时间：2012-09-09T12:48:52.100
> 
> 标签：javascript, social, sharethis

我想在我的网站上使用 ShareThis 并为同一服务添加多个按钮以共享多个对象。这是可能的，但我只能让按钮采用默认样式之一。如何通过 javascript 添加按钮并仍然使用自定义图像获取它们？

```
stWidget.addEntry({
            "service":"facebook",
            "element": $('.fb_custom').get(1),
            "url":"http://sharethis.com",
            "title":"sharethis",
            "type":"large", // one of the default styles
            "text":"ShareThis" ,
            "image":"http://www.softicons.com/download/internet-icons/social-superheros-icons-by-iconshock/png/256/sharethis_hulk.png", // image TO BE SHARED
            "summary":"this is description1"   
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:10:13.547

没问题，使用 type="custom" 就可以了。文档上没有，至少我找不到！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:18:18.160

只需创建新按钮并将它们放在您的服务器上。像这样：

```
"image":"http://www.MYOWNSERVER.com/images/myart.png 
```

# couchdb - 如何在两个（或更多）键上使用 CouchDB 视图进行过滤

> ID：12339198
> 
> 赞同：1
> 
> 时间：2012-09-09T12:49:05.037
> 
> 标签：couchdb

我在 couchdb 存储中有以下 json（简化）对象：

```
[{
    "_id": "5ea7a53e670b432e0fe22a7bc10024db",
    "_rev": "1-ae70c8906f7aa6d73539a89f7ad960ee",
    "type": "job"
}, {
    "_id": "5ea7a53e670b432e0fe22a7bc10041d9",
    "_rev": "4-fa0ba68c35ca548b497a7309389f9087",
    "type": "scan",
    "job_id": "5ea7a53e670b432e0fe22a7bc10024db",
    "number": 1
}, {
    "_id": "5ea7a53e670b432e0fe22a7bc100520e",
    "_rev": "4-3e6b1a028786c265ecb7362e245d049e",
    "type": "scan",
    "job_id": "5ea7a53e670b432e0fe22a7bc10024db",
    "number": 2
}] 
```

我想使用键 ["5ea7a53e670b432e0fe22a7bc10024db", 2] （作业 ID 和扫描号）发出一个发布请求。如何为视图制作地图功能以过滤出具有给定 id 的作业以及与 job_id 和数字匹配的测量值？

谢谢，拉杜

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T16:46:19.977

您期望的请求输出是什么？如果您只想进行扫描，请在`map`要搜索的键中发出：

```
function (doc) {
  if (type == "scan" && number) {
    emit([doc.job_id, doc. number], doc);
  }
} 
```

如果您需要两个文档 - 作业（完整文档，而不仅仅是）和扫描，请在请求的 URL中使用参数`id`将它们单独发出：`emit``include_docs=true`

```
function (doc) {
  if (doc.type == "scan" && doc.number) {
    emit([doc.job_id, doc. number], {scan: doc, _id: doc.job_id});
  }
} 
```

或在两个`emit`中：

```
function (doc) {
  if (doc.type == "scan" && doc.number && doc.job_id) {
    emit([doc.job_id, doc. number, "job"], {_id: doc.job_id);
    emit([doc.job_id, doc. number, "scan"], {_id: doc._id});
  }
} 
```

您将在 URL 中获得带有`startkey=["5ea7a53e670b432e0fe22a7bc10024db", 2]&endkey=["5ea7a53e670b432e0fe22a7bc10024db", 2, {}]&include_docs=true`（或）的两个文档。`keys=[]`

检查选项的[视图 API](http://wiki.apache.org/couchdb/HTTP_view_API#Querying_Options)。`include_docs`

# mysql - 显示第 0 - 9 行（总共 10 行，查询耗时 0.0002 秒）[LatestMoodTime: [BLOB - 10B] - [BLOB - 0B]]

> ID：12339201
> 
> 赞同：1
> 
> 时间：2012-09-09T12:49:27.353
> 
> 标签：mysql, sql

当有 10 个结果时显示 0-9 是什么意思？这导致 mysql_num_rows 出现问题

这是MYSQL：

```
SELECT * 
FROM  `members` 
WHERE (
LOWER(  `RealName` ) LIKE  '%hot%'
OR LOWER(  `UserName` ) LIKE  '%hot%'
OR LOWER(  `Location` ) LIKE  '%hot%'
OR LOWER(  `LatestMood` ) LIKE  '%hot%'
)
ORDER BY  `LatestMoodTime` DESC 
LIMIT 0 , 30 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T22:38:21.847

结果数组是从零开始的，所以“0-9”表示有 10 个元素，索引从 0 开始到 9 结束。

# javascript - JQuery 在表尾追加数据

> ID：12339202
> 
> 赞同：1
> 
> 时间：2012-09-09T12:49:27.920
> 
> 标签：javascript, jquery, html

```
<table id="myTable0" name="myTable0">
<tbody>
<tr>
</tr>
</tbody>
</table>

<table id="myTable1" name="myTable1">
<tbody>
<tr>
</tr>
</tbody>
</table> 
```

我需要一些 JQuery 来尝试将新的 html 附加到表的末尾并在 enter 键上执行此操作，它还将选择正确的表将其附加到，因为有许多表。

这是我的代码不起作用但尝试这样做：

```
for (i=0; i<2; i++)
  {
$("#newComment" + i).keyup(function(event){
    if(event.keyCode == 13){
        var $test= $('<tr><td>content here</td></tr>');
        $('#myTable '+ i + ' > tbody:last').append($test);
    }
} 
```

给我带来问题的行是 Jquery select，如下所示：

```
$('#myTable '+ i + ' > tbody:last').append($newdiv1); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T12:53:47.920

尝试这个：

```
$('#myTable' + i + ' > tbody:last').append($newdiv1); 
```

空间`$('#myTable '`是问题。。

您在#myTable 和 0.. 之间有空格。

你需要`#myTable0`的时候`#myTable 0`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T12:54:55.343

是的，这很简单，就像这样

```
$('#myTable'+ i).find('tr:last').append($test); 
```

这样就完成了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T12:57:50.780

有错别字吗？我认为您的意思是 $test 如果 $newdiv1 在有问题的行中。

我可以看到你只有一个`<tbody>`标签，所以 ':last' 选择器不是必需的。我觉得

```
$('#myTable' + i + ' tbody').append($test); 
```

会没事的。

编辑：是的，正如 Rajat Singhal 所说，在 #myTable 之后删除选择器中的空间。

# xml - F# 中的模式匹配 XML

> ID：12339205
> 
> 赞同：2
> 
> 时间：2012-09-09T12:49:42.717
> 
> 标签：xml, f#, pattern-matching, dsl, fparsec

### 新库：[XParsec](http://corsis.github.com/XParsec/)

这个问题导致了 F# 3.0 中与流和类型无关、非线性、可扩展的解析秒实现——受 FParsec 启发，从字符和线性流中解放出来并简化了：[http ://corsis.github.com/XParsec/](http://corsis.github.com/XParsec/)

* * *

## 图案

```
1 = < font=?'Bold' bbox=F'l ..' s      >                       ;       < ~s >*
2 = < font=!'Bold' bbox=F'l ..' s=?'(' > | [ 1.l < 2.l ]       ;       < ~s >*
3 = < font=!'Bold' bbox=F'l ..' s=?')' > | [ 1.l < 3.l ] 
```

在哪里

```
element names are left unspecified
font, bbox and s are attributes

V = string, N = string

?  :: V -> bool                -- value          contains string
!  :: V -> bool = not . (?)    -- value does not contain  string
~  :: N -> bool                -- value of attribute N is empty or whitespace
F  :: V -> [(N, float)]        -- extracts a list of named floats from value
RM :: V -> bool                -- value matches regular expression
[] :: [bool]                   -- list of conditions 
```

## 代码

```
open System.Xml.Linq
open System.Collections.Generic

let inline (-?-)  a b = (a : string).Contains b
let inline (~~) s = s |> String.IsNullOrWhiteSpace
let inline (!>) x = ( ^a : (static member op_Implicit : ^b -> ^a) x )

let inline (@)  (x : XElement) n   = let a = x.Attribute(!> n) in if a <> null then a.Value else String.Empty
let inline (@<) (x : XElement) n v = x.SetAttributeValue(!> n, v)

type XE = XElement IEnumerator

let inline bbox e    = (e @ "bbox") |> fun s -> s.Split [| ' ' |] |> Seq.map float |> Seq.toList
let inline left bbox = match bbox with l::_ -> l | _ -> nan

let mark n = let id = Guid.NewGuid() in Seq.iter <| fun e -> e @< "class-" + n <| id

let speaker  (n : XE) =
  let  c1 = n.Current
  if   c1 @? "font" <| "Bold"
  then let  l1 = c1 |> bbox |> left
       while n.MoveNext() && ~~(n.Current @ "s") do ()
       let  c2 = n.Current
       if  (c2 @ "font") -?- "Bold" |> not
       then let  l2 = c2 |> bbox |> left
            if   l1 < l2
            then let  s2 = c2 @ "s"
                 if        s2 -?- "("
                 then if   s2 -?- ")"
                      then [c1; c2] |> mark "speaker"
                      while n.MoveNext() && ~~(n.Current @ "s") do ()
                      let  c3 = n.Current
                      if  (c3 @ "font") -?- "Bold" |> not
                      then let  l3 = c3 |> bbox |> left
                           if   l1 < l3
                           then if   (c3 @ "s") -?- ")"
                                then [c1; c2; c3] |> mark "speaker"  

let test (x : XElement) =
  let spans = x.Descendants(!> "span") |> Seq.toArray
  for i = 29 to spans.Length - 1 do
    let n = (spans |> Seq.skip i).GetEnumerator()
    n.MoveNext() |> ignore
    speaker n 
```

## 输入

```
<doc>
<block bbox="63.2999 550.846 246.865 561.875">
  <line bbox="63.2999 550.846 246.865 561.875">
    <span bbox="63.2999 550.846 189.001 561.875" font="TimesNewRoman,Bold" size="9.96" s="Dr. Frank-Walter Steinmeier " />
    <span bbox="189 550.846 246.865 561.875" font="TimesNewRoman" size="9.96" s="(SPD)  . . . . . ." />
  </line>
</block>
<block bbox="63.2999 567.766 246.875 578.796">
  <line bbox="63.2999 567.766 246.875 578.796">
    <span bbox="63.2999 567.766 136.004 578.796" font="TimesNewRoman,Bold" size="9.96" s="Rainer Brüderle " />
    <span bbox="136.02 567.766 246.875 578.796" font="TimesNewRoman" size="9.96" s="(FDP) . . . . . . . . . . . . . . . . ." />
  </line>
</block>
<block bbox="63.2999 584.626 250.351 651.456">
  <line bbox="63.2999 584.626 246.826 595.656">
    <span bbox="63.2999 584.626 152.105 595.656" font="TimesNewRoman,Bold" size="9.96" s="Sahra Wagenknecht " />
    <span bbox="152.16 584.626 246.826 595.656" font="TimesNewRoman" size="9.96" s="(DIE LINKE)  . . . . . . ." />
  </line>
  <line bbox="63.2999 600.362 250.351 613.34">
    <span bbox="63.2999 601.546 139.327 612.576" font="TimesNewRoman,Bold" size="9.96" s="Siegfried Kauder " />
    <span bbox="139.38 601.546 247.762 612.576" font="TimesNewRoman" size="9.96" s="(Villingen-Schwenningen) " />
    <span bbox="247.861 600.362 250.351 613.34" font="Symbol" size="9.96" s=" " />
  </line>
  <line bbox="74.6404 612.526 246.911 623.556">
    <span bbox="74.6404 612.526 246.911 623.556" font="TimesNewRoman" size="9.96" s="(CDU/CSU) . . . . . . . . . . . . . . . . . . . . . . . ." />
  </line>
  <line bbox="63.2999 628.202 191.909 641.18">
    <span bbox="63.2999 629.386 126.374 640.416" font="TimesNewRoman,Bold" size="9.96" s="Jürgen Trittin " />
    <span bbox="126.419 629.386 189.433 640.416" font="TimesNewRoman" size="9.96" s="(BÜNDNIS 90/" />
    <span bbox="189.419 628.202 191.909 641.18" font="Symbol" size="9.96" s=" " />
  </line>
  <line bbox="74.6394 640.426 246.813 651.456">
    <span bbox="74.6394 640.426 246.813 651.456" font="TimesNewRoman" size="9.96" s="DIE GRÜNEN)  . . . . . . . . . . . . . . . . . . . . ." />
  </line>
</block>
</doc> 
```

## 输出

```
<doc>
<block>
  <line>
    <span font="TimesNewRoman,Bold" size="9.96" s="Dr. Frank-Walter Steinmeier " class-speaker="1f2e4dca-80d5-4c5e-91b6-6bd2e4a8acaf" />
    <span font="TimesNewRoman" size="9.96" s="(SPD)  . . . . . ." class-speaker="1f2e4dca-80d5-4c5e-91b6-6bd2e4a8acaf" />
  </line>
</block>
<block>
  <line>
    <span font="TimesNewRoman,Bold" size="9.96" s="Rainer Brüderle " class-speaker="eaa75d02-0ac6-4480-bcbe-f17bddfe6e81" />
    <span font="TimesNewRoman" size="9.96" s="(FDP) . . . . . . . . . . . . . . . . ." class-speaker="eaa75d02-0ac6-4480-bcbe-f17bddfe6e81" />
  </line>
</block>
<block>
  <line>
    <span font="TimesNewRoman,Bold" size="9.96" s="Sahra Wagenknecht " class-speaker="6b193f23-9b8b-4b37-9118-d8488fba25a2" />
    <span font="TimesNewRoman" size="9.96" s="(DIE LINKE)  . . . . . . ." class-speaker="6b193f23-9b8b-4b37-9118-d8488fba25a2" />
  </line>
  <line>
    <span font="TimesNewRoman,Bold" size="9.96" s="Siegfried Kauder " class-speaker="a0162e4e-1167-412a-ac11-ac13ef1aa46e" />
    <span font="TimesNewRoman" size="9.96" s="(Villingen-Schwenningen) " class-speaker="a0162e4e-1167-412a-ac11-ac13ef1aa46e" />
    <span font="Symbol" size="9.96" s=" " />
  </line>
  <line>
    <span font="TimesNewRoman" size="9.96" s="(CDU/CSU) . . . . . . . . . . . . . . . . . . . . . . . ." class-speaker="a0162e4e-1167-412a-ac11-ac13ef1aa46e" />
  </line>
  <line>
    <span font="TimesNewRoman,Bold" size="9.96" s="Jürgen Trittin " class-speaker="81fd6735-c57f-464b-a08f-7e7cb3bccfa8" />
    <span font="TimesNewRoman" size="9.96" s="(BÜNDNIS 90/" class-speaker="81fd6735-c57f-464b-a08f-7e7cb3bccfa8" />
    <span font="Symbol" size="9.96" s=" " />
  </line>
  <line>
    <span font="TimesNewRoman" size="9.96" s="DIE GRÜNEN)  . . . . . . . . . . . . . . . . . . . . ." class-speaker="81fd6735-c57f-464b-a08f-7e7cb3bccfa8" />
  </line>
</block>
</doc> 
```

* * *

## 问题

为了自动从简洁的模式声明转到运行代码，我正在考虑执行以下操作：

*   使用 FParsec 将模式声明解析为 AST
*   评估 AST

但在我做任何事情之前，我想知道：

1.  任何人都可以编写（应用）EDSL（/其中的一部分）来直接使用 F# 函数和组合来声明代码，而无需求助于 AST？
2.  是否有能够在 XML 上进行类似模式匹配的库？
3.  有人对我的方法有任何意见吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T08:57:03.560

我不完全确定问题是什么。您是否想使用一些现有的模式匹配语言来处理已经存在的 XML（如您的示例中所示），或者您是否通常询问有关 XML 处理的问题？

**LINQ to XML**正如 Jack P. 所说，在 F# 中处理 XML 的最佳选择可能是仅使用标准`Seq`函数。这有点长，但它是非常可读的。

**XPath**另一种选择是使用 XPath，它是在 XML 中选择节点的非常简洁（并且完全标准）的方式。例如，要选择一个具有指定属性值的节点，可以这样写：

```
#r "System.Xml.Linq"
open System.Xml.Linq
open System.Xml.XPath

let doc = XDocument.Parse("<r><a n=\"f\">foo</a><a n=\"b\">bar</a></r>")
doc.XPathSelectElement("//a[@*='f']").Value 
```

**特定领域的语言**如果您想编写自己的简洁语言，那么您不一定要使用自定义解析器等。仅以巧妙的方式使用 F# 运算符就可以取得相当大的进展。这个[F# 片段就是一个很好的例子](http://www.fssnip.net/U)。您可以编写如下内容：

```
printfn "Matches: %A" (!/foo/bar/(baz@=true)/quux/= x)
printfn "Doesn't Match: %A" (!/foo/bar/(baz@=false)/quux/= x)
printfn "Values: %A" (!/foo/bar/quux/(baz@=42)/! x) 
```

请注意，模式由 F# 编译器进行类型检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T14:40:56.077

IMO，你可以实现这样的最好方法是将它放在 Xlinq（LINQ-to-XML）之上。与“手动”实现所有模式匹配逻辑相比，它可能更易于编码、更易于维护并提供等效（如果不是更好）的性能。

请注意，您仍然可以使用 DSL 来定义要匹配的模式。基本上，您将使用 FParsec 将您的 DSL 解析为 AST，然后遍历 AST 并将其转换为等效的 LINQ 查询（请参阅参考资料[`System.Linq.Expressions namespace`](http://msdn.microsoft.com/en-us/library/system.linq.expressions.aspx)）。一旦获得了表示查询的 LINQ 表达式，您就可以将其应用于任意数量的`XDocument`s 以执行模式匹配。

您可能还对阅读 Erik Meijer 的论文[XLinq: XML Programming Refactored (The Return Of The Monoids)](https://research.microsoft.com/en-us/um/people/emeijer/Papers/XMLRefactored.html)感兴趣，该论文从功能设计的角度讨论了 XML 编程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T16:04:13.173

对于问题 2：

我不认为我理解 F# 代码，但我用 Pascal编写了一个 xml 模式匹配[库（](http://www.benibela.de/sources_en.html#internettools)[在线示例](http://videlibri.sourceforge.net/cgi-bin/htmlparserExampleCGI)、[cli 示例](http://videlibri.sourceforge.net/xidel.html)），您可能想查看它。（虽然我称这些模式为“模板”，它只选择 xml 节点，而不是修改它们）。

使用我的模板，这

```
<doc>
<block>
  <line>
    <span>{.}</span>*
  </line>*
</block>*
</doc> 
```

将匹配输入中的所有跨度。（会`<span>{.}</span>*`）

或者另一个例子：

```
<doc>
<block>
  <line>
    <span font="TimesNewRoman,Bold">{@s}</span>*
  </line>*
</block>*
</doc> 
```

将匹配包含说话者姓名的属性。

# c++ - 操作迷宫按钮关联和维度移动

> ID：12339209
> 
> 赞同：0
> 
> 时间：2012-09-09T12:49:51.913
> 
> 标签：c++, visual-studio-2010, multidimensional-array

假设我有一个二维数组。它有四行四列。现在我希望最初我在数组中的某个位置放置一些标记。比如说，array[x][y] = 1 -> 标记。我想通过使用按钮在 8 维数组中移动这个标记。就像，在上面，位置是 [x-1][y]。向下是 [x+1][y]。左边是 [x][y-1]。右边是 [x][y+1]。现在我有我的逻辑，这就是我要做的！

第一个问题：如何关联我的上下左右按钮在阵列中移动？

第二个问题：我将如何处理其他四个维度，因为我将使用两个按钮来进行其他复杂的 4 更改位置，因为 <^ 两个按钮被按下并且现在位置是 [x-1][y-1]！

请指导我或帮助我处理按钮关联。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:20:16.037

当按下箭头键时，您可以使用键盘挂钩来触发您的逻辑。您将定义一个回调函数，其中包含如下代码：

```
if (  WM_KEYDOWN == wParam && VK_UP == lParam )
    //do up logic
else if ( WM_KEYDOWN == wParam && VK_DOWN == lParam )
    //do down logic
else if .... 
```

对于对角线按钮，您可以使用键盘数字小键盘上的 home、pgup、pgdn 和 end 键（这需要带有数字小键盘的键盘）。这些按钮对应于像 <^ 这样的箭头组合，并且可以保持实现简单。

有关如何使用键盘挂钩的信息，请参阅这篇文章： [C++ Win32 键盘事件](https://stackoverflow.com/questions/1437158/c-win32-keyboard-events)

有关虚拟键代码（即 VK_UP）的列表，请参见此链接：http: [//msdn.microsoft.com/en-us/library/ms927178.aspx](http://msdn.microsoft.com/en-us/library/ms927178.aspx)

# android - 如果我在 Android 或 iOS 中制作 100% 基于 OpenGL 的用户界面，是否可以在其中嵌入 Google Map 小部件？

> ID：12339214
> 
> 赞同：1
> 
> 时间：2012-09-09T12:50:27.367
> 
> 标签：android, ios, android-layout, opengl-es, android-widget

我以前从来没有做过这样的事情。我问的原因是因为我正在考虑使用 OpenGL 制作自己的用户界面，这样它就可以在 Android、iOS 等平台上跨平台。这样做我将避免人们在制作跨平台应用程序时面临的跨平台问题在不同设备上使用本机小部件。PhoneGap 或 Appcelerator 等框架提供的 HTML5/JavaScript 解决方案缓慢且笨拙。HTML5/JavaScript 性能无法与 OpenGL 和本机小部件性能相比。

所以我的问题是（我打赌这可能是一个简单的问题）：如果我有自己的由 OpenGL 提供支持的用户界面，如果需要，我可以在其中嵌入一个原生小部件（即 Android 或 iOS 谷歌地图小部件)?

我计划尽量减少原生小部件的使用，但与简单的按钮或文本字段相比，创建 Google 地图小部件显然有点困难。我猜也许可以调用 Android 或 iOS 函数，这些函数可以在我的界面顶部覆盖一个小部件视图。这是一个很好的猜测吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T18:58:52.923

Android 将 a`GLSurfaceView`用于其所有 OpenGL 工作。它最终继承自`View`类，因此很容易与其他原生视图一起使用。

一个想法可能是将 a`FrameLayout`与其中的 the`GLSurfaceView`和其他视图一起使用。这就是他们建议进行相机叠加的方式，因此应该没有什么不同。

# asp.net - GridView 数据绑定不起作用

> ID：12339217
> 
> 赞同：3
> 
> 时间：2012-09-09T12:50:37.337
> 
> 标签：asp.net, linq, gridview

我正在使用 ASP.NET 成员资格和 Linq。我在这里有一个问题：我在具有删除按钮的网格视图中显示所有用户。看看这段代码：

```
<asp:GridView 
    ID="UsersGridView" 
    runat="server" 
    AutoGenerateColumns="False" 
    DataSourceID="UsersLinqDataSource" 
    AllowPaging="True">

    <Columns>
        <asp:BoundField DataField="UserName" HeaderText="UserName" ReadOnly="True" SortExpression="UserName" />
        <asp:BoundField DataField="LastActivityDate" HeaderText="LastActivityDate" ReadOnly="True" SortExpression="LastActivityDate" />
        <asp:TemplateField>
            <ItemTemplate>
                <asp:Button ID="DeleteButton" runat="server" CommandArgument='<%# Eval("UserName") %>' Text="Delete" OnClick="DeleteButton_Click"/>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView>

<asp:LinqDataSource 
    ID="UsersLinqDataSource" 
    runat="server" 
    ContextTypeName="TraceWeb.DataModel.DataContextDataContext" 
    EntityTypeName="" 
    Select="new (UserName, LastActivityDate)" 
    TableName="Users" 
    EnableDelete="True">
</asp:LinqDataSource> 
```

和删除按钮的事件处理程序：

```
protected void DeleteButton_Click(object sender, EventArgs e)
{
    String username = (String)((sender as IButtonControl).CommandArgument);
    Membership.DeleteUser(username, true);
    UsersGridView.DataBind();
} 
```

但问题是，在运行此代码并删除用户后，GridView 仍然显示该用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T13:34:00.353

发生这种情况是因为`Membership`并`UsersLinqDataSource`没有连接，如果您“刷新”`UsersLinqDataSource`状态然后重新绑定您的网格，所有内容都将正确显示。

```
protected void DeleteButton_Click(object sender, EventArgs e)
{
    String username = (String)((sender as IButtonControl).CommandArgument);
    Membership.DeleteUser(username, true);

    // first solution: may not work properly
    UsersLinqDataSource = yourLinqData;

    // second solution: work
    UsersLinqDataSource = null;
    UsersLinqDataSource = yourLinqData;

    UsersGridView.DataBind();
} 
```

# f# - 为什么 F# 计算表达式需要构建器对象（而不是类）？

> ID：12339223
> 
> 赞同：17
> 
> 时间：2012-09-09T12:51:30.097
> 
> 标签：f#, computation-expression

F# 计算表达式具有以下语法：

```
ident { cexpr } 
```

builder 对象在哪里`ident`（此语法取自[Don Syme 的 2007 年博客条目](http://blogs.msdn.com/b/dsyme/archive/2007/09/22/some-details-on-f-computation-expressions-aka-monadic-or-workflow-syntax.aspx)）。

在我见过的所有示例中，构建器对象都是单例实例，并且是无状态启动的。Don 给出了定义一个名为 builder 对象的示例`attempt`：

```
let attempt = new AttemptBuilder() 
```

**我的问题：**为什么 F# 不`AttemptBuilder`直接在计算表达式中使用该类？当然，这种表示法可以像实例方法调用一样容易地用于静态方法调用。

使用实例值意味着理论上可以实例化同一类的多个构建器对象，可能以某种方式参数化，甚至（天堂禁止）具有可变的内部状态。但我无法想象这将如何有用。

* * *

**更新：**我上面引用的语法表明构建器必须显示为单个标识符，这具有误导性，并且可能反映了该语言的早期版本。最新的[F# 2.0 语言规范](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec.html)将语法定义为：

```
expr { comp-or-range-expr } 
```

这清楚地表明，任何表达式（计算结果为构建器对象）都可以用作构造的第一个元素。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-09T15:14:17.803

你的假设是正确的；构建器实例可以被参数化，并且参数可以随后在整个计算中使用。

我使用这种模式为某个计算构建数学证明树。每个*结论*都是*问题名称*、*计算结果*和*基础结论*（引理）的 N 树的三元组。

让我提供一个小例子，删除一个证明树，但保留一个*问题名称*。我们称它为**注解**，因为它看起来更合适。

```
type AnnotationBuilder(name: string) =
    // Just ignore an original annotation upon binding
    member this.Bind<'T> (x, f) = x |> snd |> f
    member this.Return(a) = name, a

let annotated name = new AnnotationBuilder(name)

// Use
let ultimateAnswer = annotated "Ultimate Question of Life, the Universe, and Everything" {
    return 42
}
let result = annotated "My Favorite number" {
    // a long computation goes here
    // and you don't need to carry the annotation throughout the entire computation
    let! x = ultimateAnswer
    return x*10
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-09T14:27:19.537

这只是灵活性的问题。是的，如果 Builder 类被要求是静态的，这会更简单，但它确实会从开发人员那里获得一些灵活性，而不会在此过程中获得太多收益。

例如，假设您要创建一个与服务器通信的工作流。在代码的某处，您需要指定该服务器的地址（Uri、IPAddress 等）。在哪些情况下，您需要/想要在单个工作流程中与多个服务器进行通信？如果答案是“无”，那么使用构造函数创建构建器对象更有意义，该构造函数允许您传递服务器的 Uri/IPAddress，而不必通过各种函数连续传递该值。在内部，您的构建器对象可能会将值（服务器的地址）应用于工作流中的每个方法，从而创建类似于（但不完全是）Reader monad 的东西。

使用基于实例的构建器对象，您还可以使用继承来创建具有某些继承功能的构建器的类型层次结构。我还没有看到任何人在实践中这样做，但同样 - 灵活性是存在的，以防人们需要它，这是静态类型的构建器对象所没有的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-06-03T13:56:59.010

另一种选择是使用单例区分联合，如：

```
type WorkFlow = WorkFlow with
    member __.Bind (m,f) = Option.bind f m
    member __.Return x = Some x 
```

然后你可以直接使用它

```
let x = WorkFlow{ ... } 
```

# php - 剪切 http://somelink/withparams 并将其放入标签中

> ID：12339226
> 
> 赞同：0
> 
> 时间：2012-09-09T12:52:20.517
> 
> 标签：php, javascript

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T12:58:37.143

you can use something like this:

```
`function makeLink($text){
    $reg_exUrl = "/(http|https|ftp|ftps)\://[a-zA-Z0-9-.]+.[a-zA-Z]{2,3}(/\S*)?/";
    if(preg_match($reg_exUrl, $text, $url)) $text = preg_replace($reg_exUrl, '<a href="'.$url[0].'" target="_blank">'.$url[0].'</a>', $text);
    return $text;

}`
```

 `* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:06:11.093

尚未对其进行严格的测试，并且对 URL 结构不是很“挑剔”，但仍然可以工作（对于许多 URL，并且仅以 http(s) 开头）。

```
$urlRegex = '((https?://))([a-z0-9\.\-]{1,63})\.(([a-z]{2,3})\.?)+/?([^ ]+)';
$parsed = preg_replace('#'.$urlRegex.'#','<a href="$0">$0</a>',$text); 
````

# java - Java 字符串问题

> ID：12339230
> 
> 赞同：7
> 
> 时间：2012-09-09T12:53:15.847
> 
> 标签：java, string

我运行了以下程序，

```
 String firstString = "String";
    String secondString = "String";
    String thirdString = new String("String");
    System.out.println(firstString == secondString);
    System.out.println(firstString == thirdString);
    System.out.println(firstString.intern() == thirdString);
    System.out.println(firstString.intern() == thirdString.intern());
    System.out.println(firstString.intern().equals(thirdString.intern()));
    System.out.println(firstString == thirdString); 
```

我的输出是

```
true
false
false
true
true
false 
```

我了解到 jvm 将字符串与相同的字符串具有相同的内容。那正确吗？如果那是真的，那么为什么 firstString == thirdString 不返回假？jvm是否只汇集仅使用 :"" 而不是使用 new 运算符初始化的字符串？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T12:55:55.973

池化仅与字符串文字有关 - 因此`firstString`实际上`secondString`是同一个对象 - 正如`thirdString`您明确要求在堆上创建一个新对象一样。

我建议阅读[规范中关于字符串文字](http://docs.oracle.com/javase/specs/jls/se5.0/html/lexical.html#3.10.5)的部分。

它提供了有关如何以及何时合并字符串的更多信息。

另外，请注意本节末尾的这些项目符号：

> *   同一包 (§7) 中同一类 (§8) 中的文字字符串表示对同一 String 对象 (§4.3.1) 的引用。
> *   同一包中不同类中的文字字符串表示对同一 String 对象的引用。
> *   不同包中不同类中的文字字符串同样表示对同一 String 对象的引用。
> *   由常量表达式（第 15.28 节）计算的字符串在编译时计算，然后将其视为文字。
> *   在运行时通过连接计算的字符串是新创建的，因此是不同的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T13:04:34.023

对于 firstString 和 secondString，JVM 将查找字符串池并返回“String”的引用。

对于thirdString，JVM 不会查找字符串池，只会在堆中创建一个String 对象。

对于 OneString.intern()，JVM 会在字符串池中查找引用，如果其中不存在 OneString，则将 OneString 添加到字符串池中，并返回该引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T12:56:10.940

`thirdString`不是来自游泳池。它不是字符串文字，您使用`new`运算符动态创建它。

`secondString`另一方面 - 从池中获取（您为其分配了一个字符串文字），因此将相同的对象分配给`firstString`和`secondString`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T12:56:46.783

“firstString == thirdString”返回假。

方法实习生“返回字符串对象的规范表示。” 如果您分配实习字符串：

```
thirdString=thirdString.intern(); 
```

最后“firstString ==thirdString”返回真

# mongodb - 使用 MongoDB 的简单投票系统

> ID：12339233
> 
> 赞同：5
> 
> 时间：2012-09-09T12:53:46.960
> 
> 标签：mongodb

快速提问 我在 mongodb 中有一个文章列表，我希望用户能够对文章投赞成票或反对票。

我的第一种方法是在艺术收藏中有两行称为 upvote 和 downvote 他们会有像 upvote:360 downvote:102 这样的数字；

然后我需要通过汇总 upvote-downvote 来订购它，这将显示艺术作品的总喜欢。

我的问题是在 mongoDB 中这是最好的方法，还是我最好用一个“投票”然后通过投票来订购它。

谢谢你

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-09T13:06:01.370

当您这样做时，您不会跟踪哪个用户已经投票，因此用户可以多次投票。那肯定不符合你的利益。

出于这个原因，我会在每篇文章中添加一个数组“votes”，其中包含每个投票的对象，该对象唯一地标识出投票的用户：

```
votes: [ 
        { voter:"name or ID or IP address or some other unique identifier for the person who voted",
          vote:-1 },
        { voter:"someone else",
          vote:1 },
        { voter:"and someone entirely different",
          vote:-1 }
    ] 
```

当您在文章 ID 和 votes.voter 上创建唯一索引时，您已经确保没有人可以为一篇文章投票两次。

当您使用“-1”值表示反对票和“1”值表示赞成票时，您可以使用 $sum 聚合函数计算一篇文章的总分（它还可以让您稍后轻松引入加权投票，当您觉得喜欢它）。

# mysql - 选择数据库的列、约束、表的所有属性

> ID：12339238
> 
> 赞同：1
> 
> 时间：2012-09-09T12:54:46.483
> 
> 标签：mysql, sql, select, join, information-schema

我正在从 MySql 中的 information_schema 中获取表、列、约束的所有属性

```
select t.*,c.*,k.*
from information_schema.tables t
inner join information_schema.COLUMNS c on c.table_name=t.table_name
left outer join information_schema.key_column_usage k on 
c.column_name=k.column_name
and k.table_name=t.table_name and k.referenced_column_name is not NULL
where t.table_schema='test' order by t.table_name; 
```

1.  这个查询的问题是，如果我在任何其他数据库中有一个同名的表，我也会得到该表的列，即使我清楚这个特定数据库的 where 条件

2.  如果我不使用左外连接，我会发现很多列都丢失了，因为所有列都不是外键

我需要改进这个查询以及一些指导，但是一个完全不同的解决方案也是可以接受的。

改进查询结果的行数必须等于

```
select count(*) from information_schema.columns c where c.table_schema='test'; 
```

提前感谢您的帮助:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:05:38.917

您的`where`子句确保您只查看 schema 中的表`test`，但`join`/`on`子句中的任何内容都不能确保您的列与表来自相同的架构。（`on c.table_name=t.table_name`仅确保 所描述的列`c`来自与所描述的同名的表`t`。）并且，对于`key_column_usage`. 所以，你可以写：

```
select t.*,c.*,k.*
from information_schema.tables t
inner join information_schema.COLUMNS c
      on c.table_schema=t.table_schema
      and c.table_name=t.table_name
left outer join information_schema.key_column_usage k
      on k.table_schema=t.table_schema
      and k.table_name=t.table_name
      and k.column_name=c.column_name
      and k.referenced_column_name is not NULL
where t.table_schema='test'
order by t.table_name; 
```

也就是说，这仍然可以返回比您的`count(*)`报告更多的行，因为原则上单个列可以属于多个外键。为确保每列仅获得一行，即一列只有一个外键，您可以添加一个`GROUP BY`子句：

```
where t.table_schema='test'
group by t.table_schema, t.table_name, c.column_name
order by t.table_name; 
```

（我利用了[MySQL 对“隐藏”的 GROUP BY 列的支持](http://dev.mysql.com/doc/refman/5.6/en/group-by-hidden-columns.html)）。

# java - 将 DAO 与复合对象一起使用

> ID：12339241
> 
> 赞同：5
> 
> 时间：2012-09-09T12:55:03.880
> 
> 标签：java, database, design-patterns

我正在尝试重写一堆 DAO，这里是设置：

*   只有普通的 JDBC（没有 JPA、ORM）
*   没有使用接口
*   在插入对象之前进行大量检查
*   业务对象是强链接的

我的主要问题是：如何持久化/检索由多个其他对象组成的业务对象？例如，我的 CustomerDAO 是否知道 AddressDAO 并从那里检索客户地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:03:52.693

> 只有普通的 JDBC（没有 JPA、ORM） 业务对象是强链接的

不确定为什么在希望链接业务对象时不想使用 JPA，但至少您应该使用 Spring JDBC 模板，它可以让您从一些样板代码中解脱出来。

关于其他约束，我会这样做：

1.  我仍然会使用接口来定义`DAO`方法并在支持的 Spring JDBC 模板中实现它们`DAOImpl`。到处使用 DAO 并注入 DAOImpl。
2.  我的 DAO 将简单地一对一映射到基础表，每个 DAO 都不知道其他 DAO 的存在。
3.  我的 Manager 层将具有运行验证检查并准备需要持久化的对象集、调用适当的 DAO 和适当的方法 (CREATE/UPDATE/DELETE) 来持久化对象的所有业务逻辑。
4.  同样，管理器层将遵循基于接口的实现，而视图层将具有注入 ManagerImpls 的管理器类型。

我的两分钱！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:51:26.677

您可以考虑使用[JOOQ](http://www.jooq.org/)。它不是 JPA，但它可以很容易地用作替代解决方案。它足够轻巧。它还提供了一个逆向工程工具，用于将您的数据库实体构建为 DAO 对象。

我已将 JOOQ 嵌入到应用程序经过精心设计的相关情况中。我没有使用它的 DAO 功能，而是将其用作更高层以避免与 JDBC 层混淆。

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-15T23:13:13.813

复合实体是 DAO 之上的一层。如果要移除所有耦合，DAO 持久化的域对象应该是扁平的，没有关系。请参阅核心 J2EE 模式 CompositeEntity。

此外，最好不要通过将查找器放在另一个中来在 DAO 之间引入耦合。例如：

AddressDAO.findForCustomerId(id);

不如使用第三个 DAO 来管理关系。IE：

CustomerAddressRelDAO.findAddressForCustomer(id);

如果您使用关系 DAO，则地址和客户都不会相互依赖（或了解）彼此。

# android - 使用 ProGuard 后在 Android 中找不到应用程序类

> ID：12339242
> 
> 赞同：1
> 
> 时间：2012-09-09T12:55:06.103
> 
> 标签：android, exception, proguard

到目前为止，我的应用程序运行良好，没有任何错误。但最近我开始使用 ProGuard 来混淆代码，现在我在 Google Play 开发者控制台中看到以下错误报告：

```
java.lang.RuntimeException: Unable to instantiate application MYPACKAGE.MyApp: java.lang.ClassNotFoundException: MYPACKAGE.MyApp
at android.app.LoadedApk.makeApplication(LoadedApk.java:482)
at android.app.ActivityThread.handleBindApplication(ActivityThread.java:3950)
at android.app.ActivityThread.access$1300(ActivityThread.java:127)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1197)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4507)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.ClassNotFoundException: MYPACKAGE.MyApp
at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
at android.app.Instrumentation.newApplication(Instrumentation.java:945)
at android.app.LoadedApk.makeApplication(LoadedApk.java:477) 
```

`MyApp`显然是自定义应用程序类。到目前为止，只有一个关于该问题的错误报告，尽管有 10,000 多个活动安装。这是否意味着我不应该为这个问题而烦恼，或者这可能是一个严重的问题？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T21:37:29.570

ProGuard 只是用混淆的类名替换类名。如果处理后的代码适用于一台设备（或超过 10,000 台设备），则它应该适用于所有设备。

此外，如果您反汇编已处理的应用程序，您会看到 mypackage.MyApp 仍然存在，并具有其原始名称。Android 构建中 ProGuard 的默认集成负责保留活动、服务等，无需任何额外的 -keep 选项。

简而言之，这是某种侥幸，很可能与混淆无关。只需重新安装应用程序可能会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-09T12:57:24.960

尝试添加以下行：

```
-keep public class * extends android.app.Activity
-keep public class * extends android.app.Application 
```

到**proguard.cfg**文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T13:16:36.203

似乎 proguard 的混淆配置中缺少您的类名。`proguard.cfg`使用缺少的类名将以下内容添加到您的。

```
-keep public class your_missing_class_full_name 
```

# java - 从 Java 调用和传递参数到 JasperReport 服务器的示例代码或文档

> ID：12339247
> 
> 赞同：0
> 
> 时间：2012-09-09T12:55:45.440
> 
> 标签：java, jasper-reports, jasperserver

我正在开发一个名为*Joget的基于 Java 的开源**BPM*。我需要从这个 Java 应用程序传递参数并调用*JasperReport Server 。*

 **例如，我需要传递 (Date From , Date To) 等参数并在 Java 应用程序中显示报告。所以任何人都可以提到一些有用的文档或教程来完成我的任务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:02:29.573

如果您不了解`$`jasper 报告中的 CDATA 和用法，请查看这些链接

[文档](http://struts.apache.org/2.0.11.2/docs/jasperreports-tutorial.html) [博客](http://java-bytes.blogspot.in/2009/06/jasper-reports-example.html)**

# python - 正则表达式 - 检测单词是否包含小写字符

> ID：12339251
> 
> 赞同：0
> 
> 时间：2012-09-09T12:56:21.867
> 
> 标签：python, regex

我正在尝试编写一个正则表达式来确定 C 中宏声明的名称是否大写：

```
#define MY_MACRO 
```

为了仅检测大写单词（不考虑退格或连字符等特殊字符），我使用以下正则表达式：

```
"#define +[^A-Z]+" 
```

如果我的宏完全大写，它可以工作，但如果它像这样则失败：

```
#define Mymacro 
```

什么是能够确定这种情况的正则表达式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T12:59:09.120

To detect `#define MixedCase` but not match `#define ALLUPPERCASE` you need a negative lookahead assertion:

```
r'#define\s+(?![A-Z_]+\b)[A-Za-z_]+\b' 
```

`\b` matches the word boundary; the place where a word ends, perhaps because of whitespace after it, or the end of the line.

The `(?!..)` negative lookahead assertion checks that the next word is *not* all uppercase, before allowing a match on a mixed-case word.

Note that I've included the `_` underscore as well in the matching character class.

You may want to include digits in your macro names, they are legal, after all:

```
r'#define\s+(?![A-Z0-9_]+\b)\w+\b' 
```

The second character class can then be simplified to `\w`, which is the same as `[A-Za-z0-9_]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:30:09.663

正则表达式*是否*必须做所有事情？您可以将所有`#define`s 与正则表达式匹配，然后使用一些非常简单的 Python 代码测试宏名称的大写：

```
macro_defn = re.compile(r'#define\s+(\w+)')
for line in code_source:
    macro_match = macro_defn.match(line)
    if macro_match:
        macro_name = macro.group(1)
        if macro_name.upper() != macro_name:
            print line 
```

# javascript - 使用 regex 和 javascript 在 HTML 注释中查找模式

> ID：12339255
> 
> 赞同：2
> 
> 时间：2012-09-09T12:56:42.993
> 
> 标签：javascript, regex

我正在构建一个代码生成器/代码编辑器，我正在尝试做一种服务器端包含但客户端。我想，使用正则表达式和 javascript，在下面的行中解析出“文件属性”，将代码加载到“包含”文件中，然后用它替换整个注释。我不需要帮助来仅加载正则表达式魔术。:)

所以首先找到“文件属性”。然后用另一个字符串替换整个注释。

```
<!--#include file="footer.html" --> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T14:49:20.480

[http://jsfiddle.net/xLW83/](http://jsfiddle.net/xLW83/)

```
var replace = function (str, process) {
     var regex = /<!--\s*#include\s+file="(.+)".*-->/g;
     return str.replace(regex, process);
};

var processFile = function (comment, filePath) {
    return 'content of the file';
};

var result = replace(
    'some text <!--#include file="footer.html" --> something else',
    processFile
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T12:58:42.653

如果字符串总是这种简单的形式，你可以做

```
result = subject.replace(/<!--#include file="([^"]*)"\s*-->/g, "Another string with file name: $1"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T13:56:24.480

这是您获取文件名、加载其内容并生成字符串的方式：

```
$pattern = '/(.*<!--#include\s*file\s*=\s*")(.*?)("\s*-->.*)/s';
$subject = '<!--#include file="footer.html" -->';

if (preg_match($pattern, $subject, $regs)) {
    $prefix = $regs[1];
    $fileName = $regs[2];
    $suffix = $regs[3];

    // Load data from file (implement this by yourself).
    $fileData = loadDataFromFile($fileName)

    $myFinalCompleteString = $prefix . $fileData . $suffix;
} 
```

以下是模式的解释：

```
# (.*<!--#include\s*file\s*=\s*")(.*?)("\s*-->.*)
# 
# Options: dot matches newline
# 
# Match the regular expression below and capture its match into backreference number 1 «(.*<!--#include\s*file\s*=\s*")»
#    Match any single character «.*»
#       Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
#    Match the characters “&lt;!--#include” literally «<!--#include»
#    Match a single character that is a “whitespace character” (spaces, tabs, and line breaks) «\s*»
#       Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
#    Match the characters “file” literally «file»
#    Match a single character that is a “whitespace character” (spaces, tabs, and line breaks) «\s*»
#       Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
#    Match the character “=” literally «=»
#    Match a single character that is a “whitespace character” (spaces, tabs, and line breaks) «\s*»
#       Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
#    Match the character “"” literally «"»
# Match the regular expression below and capture its match into backreference number 2 «(.*?)»
#    Match any single character «.*?»
#       Between zero and unlimited times, as few times as possible, expanding as needed (lazy) «*?»
# Match the regular expression below and capture its match into backreference number 3 «("\s*-->.*)»
#    Match the character “"” literally «"»
#    Match a single character that is a “whitespace character” (spaces, tabs, and line breaks) «\s*»
#       Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
#    Match the characters “-->” literally «-->»
#    Match any single character «.*»
#       Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*» 
```

# iphone - iOS 获得声音响度

> ID：12339258
> 
> 赞同：2
> 
> 时间：2012-09-09T12:56:52.010
> 
> 标签：iphone, ios, audio

我正在开发一个需要实时声音处理的 iPhone 应用程序。我想要存档的是获取声音响度（来自麦克风），将其与阈值进行比较，并根据响度级别执行一些逻辑。iOS中是否有任何库可以让我做到这一点？iOS 是否有任何内置功能可以为我提供当前的声音响度级别？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:05:30.947

[这个 SO 问题](https://stackoverflow.com/questions/6183599/how-to-measures-noise-or-sound-and-displays-in-dba-in-iphone)看起来是一个很好的起点（也许它已经足够接近被骗了，但我想我还是会回答）。

# asp.net - 如果 href 具有动态组件 asp.net，则 Facebook 喜欢按钮不显示

> ID：12339262
> 
> 赞同：2
> 
> 时间：2012-09-09T12:57:46.440
> 
> 标签：asp.net, html, facebook-like

我有一个 asp.net 页面，上面有一个转发器列表，其中包含类似 Facebook 的按钮。如果所有类似按钮上的 href 在所有项目中都相同，则类似按钮在转发器项目中呈现正常，但如果我在 href 中放置查询字符串组件，它将仅显示转发器中的最后一项。

例如，将正确呈现控件的 URL [http://www.mysite.com/asppage.aspx](http://www.mysite.com/asppage.aspx) 但将查询字符串组件[http://www.mysite.com/asppage.aspx?querystring=uniqueID](http://www.mysite.com/asppage.aspx?querystring=uniqueID)其中唯一 id 是唯一编号每个中继器列表项

我遵循了所有的 facebook 指南，但没有解决这个问题我正在使用 HTML5 版本的 facebook like 按钮

```
lblFaceBookLikeButton.Text = "<div class='fb-like' data-href='http://www.mysite.com/asppage.aspx?querystring=uniqueID '  data-send='true' data-width='450' data-show-faces='true'></div>"; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T23:15:21.973

在 queryString 的末尾放置一个 & 符号可解决此问题

# php - PHP NumberFormatter 和 Currency，无法设置精度

> ID：12339264
> 
> 赞同：16
> 
> 时间：2012-09-09T12:57:52.140
> 
> 标签：php, intl, numberformatter

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-15T21:14:52.990

Michael Gallego 忘记更新此问题。查看他的错误报告和 php.net 上的回复。

*   [https://bugs.php.net/bug.php?id=63140](https://bugs.php.net/bug.php?id=63140)
*   [http://bugs.icu-project.org/trac/ticket/7667](http://bugs.icu-project.org/trac/ticket/7667)

> [2012-10-05 08:21 UTC] *jpauli@email.com*
> 
> 我确认这是 4.4.x 分支中的 ICU 错误。
> 考虑升级 libicu，4.8.x 给出正确的结果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T06:58:14.317

此函数使用语言环境信息将数字格式化为货币，我使用的格式是 '%#10n' for $ ：

```
/**
 * That it is an implementation of the function money_format for the
 * platforms that do not it bear.
 * The function accepts to same string of format accepts for the
 * original function of the PHP.
 * The function is tested using PHP 5.1.4 in Windows XP
 * and Apache WebServer.
 * 
 * format I am are using is '%#10n' for $;
 * 
*/
public static function money_format( $format, $number )
{
    $regex  = '/%((?:[\^!\-]|\+|\(|\=.)*)([0-9]+)?'.
            '(?:#([0-9]+))?(?:\.([0-9]+))?([in%])/';
    if (setlocale(LC_MONETARY, 0) == 'C') {
        setlocale(LC_MONETARY, '');
    }
    $locale = localeconv();
    preg_match_all($regex, $format, $matches, PREG_SET_ORDER);
    foreach ($matches as $fmatch) {
        $value = floatval($number);
        $flags = array(
                'fillchar'  => preg_match('/\=(.)/', $fmatch[1], $match) ?
                $match[1] : ' ',
                'nogroup'   => preg_match('/\^/', $fmatch[1]) > 0,
                'usesignal' => preg_match('/\+|\(/', $fmatch[1], $match) ?
                $match[0] : '+',
                'nosimbol'  => preg_match('/\!/', $fmatch[1]) > 0,
                'isleft'    => preg_match('/\-/', $fmatch[1]) > 0
        );
        $width      = trim($fmatch[2]) ? (int)$fmatch[2] : 0;
        $left       = trim($fmatch[3]) ? (int)$fmatch[3] : 0;
        $right      = trim($fmatch[4]) ? (int)$fmatch[4] : $locale['int_frac_digits'];
        $conversion = $fmatch[5];

        $positive = true;
        if ($value < 0) {
            $positive = false;
            $value  *= -1;
        }
        $letter = $positive ? 'p' : 'n';

        $prefix = $suffix = $cprefix = $csuffix = $signal = '';

        $signal = $positive ? $locale['positive_sign'] : $locale['negative_sign'];
        switch (true) {
            case $locale["{$letter}_sign_posn"] == 1 && $flags['usesignal'] == '+':
                $prefix = $signal;
                break;
            case $locale["{$letter}_sign_posn"] == 2 && $flags['usesignal'] == '+':
                $suffix = $signal;
                break;
            case $locale["{$letter}_sign_posn"] == 3 && $flags['usesignal'] == '+':
                $cprefix = $signal;
                break;
            case $locale["{$letter}_sign_posn"] == 4 && $flags['usesignal'] == '+':
                $csuffix = $signal;
                break;
            case $flags['usesignal'] == '(':
            case $locale["{$letter}_sign_posn"] == 0:
                $prefix = '(';
                $suffix = ')';
                break;
        }
        if (!$flags['nosimbol']) {
            $currency = $cprefix .
            ($conversion == 'i' ? $locale['int_curr_symbol'] : $locale['currency_symbol']) .
            $csuffix;
        } else {
            $currency = '';
        }
        $space  = $locale["{$letter}_sep_by_space"] ? ' ' : '';

        $value = number_format($value, $right, $locale['mon_decimal_point'],
                $flags['nogroup'] ? '' : $locale['mon_thousands_sep']);
        $value = @explode($locale['mon_decimal_point'], $value);

        $n = strlen($prefix) + strlen($currency) + strlen($value[0]);
        if ($left > 0 && $left > $n) {
            $value[0] = str_repeat($flags['fillchar'], $left - $n) . $value[0];
        }
        $value = implode($locale['mon_decimal_point'], $value);
        if ($locale["{$letter}_cs_precedes"]) {
            $value = $prefix . $currency . $space . $value . $suffix;
        } else {
            $value = $prefix . $value . $space . $currency . $suffix;
        }
        if ($width > 0) {
            $value = str_pad($value, $width, $flags['fillchar'], $flags['isleft'] ?
                    STR_PAD_RIGHT : STR_PAD_LEFT);
        }

        $format = str_replace($fmatch[0], $value, $format);
    }
    return $format;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T10:11:00.700

您必须提供正确的区域设置和货币组合。例如，fr-FR / fr-bh / fr-ch support €，这是 formatCurrency 函数中必须提供的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-17T11:17:09.463

我认为您必须使用支持目标货币的语言环境。所以 en_US 没有欧元。de_DE 有它，fr_FR 也有。所以fr_FR支持欧元也就不足为奇了。

看来这不是一个错误。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-06-04T02:42:13.260

您可以使用以下代码行格式化货币：-

```
$number = 1234.56;
setlocale(LC_MONETARY,"en_US"); // Sets the Default for money
echo money_format("%i", $number); 
```

它会输出你：

```
USD 1,234.56 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-06-02T05:35:52.033

在您可以使用的 php ini 中设置默认语言环境值：

> ini_set('intl.default_locale', 'de-DE');

要更改数字格式，请使用：

> setlocale(LC_MONETARY, 'de-DE');

# android - How can I make testing on the device faster?

> ID：12339271
> 
> 赞同：0
> 
> 时间：2012-09-09T12:59:11.357
> 
> 标签：android, testing, device

I have an application that is approximately 40 Mb.

Whenever I test my application on my Galaxy S I9000 it takes 1-2 minutes to download and another 1-2 minutes to install.

Can I upload only the part of code that I have changed?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:12:15.203

我猜在一个 40 MB 的应用程序中，大部分空间都被图像占用了。一种可能的解决方案是让您的应用在第一次运行时下载图像，而不是捆绑它们。这样，您的 apk 将只包含图标等代码和资源，因此大小会大大减小。此外，您无需在每次更新应用程序时不断重新下载图像。

当您发布应用程序时，您可以使用扩展 apk 在下载时分发图像，或者将它们托管在您自己的服务器上并下载它们。

# angularjs - Angular js未知提供者

> ID：12339272
> 
> 赞同：155
> 
> 时间：2012-09-09T12:59:28.250
> 
> 标签：angularjs

我正在尝试“自定义” mongolab 示例以适合我自己的 REST API。现在我遇到了这个错误，我不确定我做错了什么：

```
Error: Unknown provider: ProductProvider <- Product
    at Error (unknown source)
    at http://localhost:3000/js/vendor/angular.min.js:28:395
    at Object.c [as get] (http://localhost:3000/js/vendor/angular.min.js:26:180)
    at http://localhost:3000/js/vendor/angular.min.js:28:476
    at c (http://localhost:3000/js/vendor/angular.min.js:26:180)
    at d (http://localhost:3000/js/vendor/angular.min.js:26:314) 
```

这是我的控制器：

```
function ProductListCtrl($scope, Product) {
  $scope.products = Product.query();
} 
```

这是模块：

```
angular.module('productServices', ['ngResource']).
    factory('Product', ['$resource', function($resource){
      var Product = $resource('/api/products/:id', {  }, {
        update: { method: 'PUT' }
      });

      return Product;
    }]); 
```

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2012-09-09T13:58:56.157

您的代码看起来不错，实际上它在复制并粘贴到示例 jsFiddle 中时有效（除了调用本身）：http: [//jsfiddle.net/VGaWD/](http://jsfiddle.net/VGaWD/)

如果没有看到更完整的示例，很难说发生了什么，但我希望上面的 jsFiddle 会有所帮助。**我怀疑的是您没有使用“productServices”模块初始化您的应用程序**。它会给出同样的错误，我们可以在另一个 jsFiddle 中看到：http: [//jsfiddle.net/a69nX/1/](http://jsfiddle.net/a69nX/1/)

如果您打算使用 AngularJS 和 MongoLab，**我建议您为 $resource 和 MongoLab 使用现有适配器**：[https](https://github.com/pkozlowski-opensource/angularjs-mongolab) ://github.com/pkozlowski-opensource/angularjs-mongolab 它减轻了使用 MongoLab 的大部分痛苦，您可以在这里看到它的实际效果：http: [//jsfiddle.net/pkozlowski_opensource/DP4Rh/](http://jsfiddle.net/pkozlowski_opensource/DP4Rh/) 免责声明！我正在维护这个适配器（基于 AngularJS 示例编写）所以我在这里显然有偏见。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2013-08-05T15:38:29.827

我收到了这个错误，因为我向工厂定义传递了一个不正确的参数。我有：

```
myModule.factory('myService', function($scope, $http)... 
```

当我删除`$scope`并将工厂定义更改为：

```
myModule.factory('myService', function( $http)... 
```

如果您需要注入`$scope`，请使用：

```
myModule.factory('myService', function($rootScope, $http)... 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2012-11-14T17:42:09.077

我只是有一个类似的问题。错误在问题中说的一样，试图用pkozlowski.opensource和Ben G的答案来解决它，这两个都是正确和好的答案。

我的问题确实与相同的错误不同：

在我的 HTML 代码中，我有这样的初始化......

```
<html ng-app> 
```

再往下一点，我试图做这样的事情：

```
<div id="cartView" ng-app="myApp" ng-controller="CartCtrl"> 
```

我摆脱了第一个......然后它起作用了......显然你不能初始化 ng-app 两次或更多次。很公平。

我完全忘记了第一个“ng-app”并感到非常沮丧。也许有一天这会帮助某人......

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2012-11-20T01:32:30.420

确保您的 main`app.js`包含它所依赖的服务。例如：

```
/* App Module */
angular.module('myApp', ['productServices']). 
..... 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2012-11-13T14:06:59.467

pkozlowski 的回答是正确的，但以防万一这发生在其他人身上，我在错误地创建了两次相同的模块后遇到了同样的错误；第二个定义覆盖了第一个的提供者：

我通过做创建了模块

```
angular.module('MyService'...
).factory(...); 
```

然后在同一个文件中再往下一点：

```
angular.module('MyService'...
).value('version','0.1'); 
```

这样做的正确方法是：

```
angular.module('MyService'...
).factory(...).value('version','0.1'); 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-10-03T13:14:04.840

就我而言，我定义了一个新的提供者，比如说，`xyz`

```
angular.module('test')
.provider('xyz', function () {
    ....
}); 
```

当您要配置上述提供程序时，您必须将其注入并`Provider`附加字符串 --> `xyz`变为`xyzProvider`。

前任：

```
angular.module('App', ['test'])
.config(function (xyzProvider) {
     // do something with xyzProvider....
}); 
```

如果您在没有 'Provider' 字符串的情况下注入上述提供程序，您将在 OP 中得到类似的错误。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-06-01T17:41:20.330

在 JS 文件的末尾关闭我的工厂功能

`});`

代替

`}());`

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-04-02T08:04:32.217

这花了我太长时间才能找到。确保在指令中对控制器进行 minisafe。

```
.directive('my_directive', ['injected_item', function (injected_item){

  return {

    controller: ['DO_IT_HERE_TOO', function(DO_IT_HERE_TOO){

    }]
  }
} 
```

希望有帮助

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-02-21T22:40:18.800

为了在这里添加我自己的经验，我试图将服务注入我的模块配置函数之一。我最终找到的文档中的这一段解释了为什么这不起作用：

> 在应用程序引导期间，在 Angular 开始创建所有服务之前，它会配置并实例化所有提供程序。我们将此称为应用程序生命周期的配置阶段。在此阶段，服务无法访问，因为它们尚未创建。

这意味着您可以将提供程序注入到 module.config(...) 函数中，但不能注入服务，因为您需要等到 module.run(...)，或者公开可以注入模块的提供程序。配置

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-12-23T09:37:42.573

对我来说，这个错误是由运行我的 Angular 应用程序的缩小版本引起的。Angular 文档提出了一种解决此问题的方法。这是描述该问题的相关引用，您可以在[此处](http://docs.angularjs.org/tutorial/step_05 "角度文档")的文档中找到建议的解决方案：

> 关于缩小的注意事项 由于 Angular 从参数名称推断控制器的依赖关系到控制器的构造函数，如果你要缩小 PhoneListCtrl 控制器的 JavaScript 代码，它的所有函数参数也会被缩小，并且依赖注入器不会能够正确识别服务。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-09-30T21:04:55.687

由于这是目前 Google 上“angularjs unknown provider”的最高结果，这里还有另一个问题。使用 Jasmine 进行单元测试时，请确保您的`beforeEach()`函数中有以下语句：

```
module('moduleName'); 
```

否则，您将在测试中遇到同样的错误。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-09-17T15:20:37.963

还有一种会发生此错误的情况，如果您的服务是在单独的 javascript 文件中定义的，请确保您引用它！是的，我知道，菜鸟的错误。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-05-28T10:24:06.870

我忘记注入完全保存我的服务的文件。请记住在初始化应用程序模块时执行此操作：

```
angular.module('myApp', ['myApp.services', ... ]); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-03-30T16:05:53.887

就我而言，我使用匿名函数作为 angular 模块的包装器，如下所示：

```
(function () {
var app = angular.module('myModule', []);
...
})(); 
```

关闭括号后，我忘记通过如上所述再次打开和关闭括号来调用匿名函数。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-07-13T17:48:30.653

对我来说，问题是延迟加载；我加载控制器和服务较晚，因此它们在页面加载（和 Angular 初始化）时不可用。我用 ui-if 标签做到了这一点，但这无关紧要。解决方案是在已经加载页面的情况下加载服务。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-10-01T16:33:06.800

这是您可以看到此错误的另一种可能情况：

如果您使用 Sublime Text 2 和 angular 插件，它将生成像这样的存根

```
angular.module('utils', [])
.factory('utilFactory', [''
    function() {
        return {

        }
    }
]); 
```

注意空的 ' ' 作为 'utilFactory' 字符串之后的数组的第一个元素。如果您没有任何依赖项，请将其删除，如下所示：

```
angular.module('utils', [])
.factory('utilFactory', [
    function() {
        return {

        }
    }
]); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-08-21T18:49:37.093

由于这个问题是谷歌搜索结果，我将在列表中添加另一个可能的问题。

如果您使用的模块在依赖注入包装器上出现故障，它将提供相同的结果。例如，来自互联网的复制和粘贴模块可能依赖 underscore.js 并尝试在 di 包装器中注入 '_'。如果您的项目依赖提供程序中不存在下划线，当您的控制器尝试引用您模块的工厂时，它将在浏览器的控制台日志中为您的工厂获取“未知提供程序”。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-10-30T15:33:56.523

对我来说，问题是我创建了一些引用该服务的新 javascript 文件，但 Chrome 只看到旧版本。A CTRL + F5 为我修复了它。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-11-15T19:56:18.937

使用 Grunt 编译我的项目时，出现与 angular-mocks (ngMockE2E) 相关的“未知提供者”错误。问题是 angular-mocks 不能被缩小，所以我不得不从缩小文件列表中删除它。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-12-03T19:59:49.820

在我的 Ruby on Rails 应用程序中，我执行了以下操作：

```
rake assets:precompile 
```

这是在“开发”环境中完成的，该环境已缩小 Angular.js 并将其包含在`/public/assets/application.js`文件中。

删除`/public/assets/*`文件为我解决了这个问题。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-01-20T01:25:21.860

在也处理了这个错误之后，我可以用我自己的案例来支持这个答案列表。

它既简单又笨拙（对于像我这样的初学者来说可能不笨，但对于专家来说是的），对 angular.min.js 的脚本引用必须是 html 页面中脚本列表中的第一个。

这有效：

```
<script src="Scripts/angular.min.js"></script>
<script src="MyScripts/MyCartController.js"></script>
<script src="MyScripts/MyShoppingModule.js"></script> 
```

这不是：

```
<script src="MyScripts/MyCartController.js"></script>
<script src="MyScripts/MyShoppingModule.js"></script>
<script src="Scripts/angular.min.js"></script> 
```

注意 angular.min.js。

希望它可以帮助任何人！:)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2014-03-06T20:04:08.810

我的问题是 Yeoman，使用（大写）：

```
yo angular:factory Test 
```

制作文件（未大写）：

```
app/scripts/services/test.js 
```

但 index.html 文件包括（大写）：

```
<script src="scripts/services/Test.js"></script> 
```

希望这可以帮助某人。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-04-15T08:25:20.610

还有另一种可能。

我有`unknown Provider <- <- nameOfMyService`。该错误是由以下语法引起的：

```
module.factory(['', function() { ... }]); 
```

Angular 正在寻找`''`依赖项。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-07-10T16:03:41.080

我的场景可能有点晦涩难懂，但它可能会导致相同的错误，并且有人可能会遇到它，所以：

当使用 $controller 服务来实例化一个新控制器时（它期望 '$scope' 作为它的第一个注入参数），我将新控制器的本地范围传递给 $controller() 函数的第二个参数。这导致 Angular 试图调用一个不存在的 $scope 服务（*虽然，有一段时间，我实际上认为我会从 Angular 的缓存中删除 '$scope' 服务*）。解决方案是将本地范围包装在 locals 对象中：

```
// Bad:
$controller('myController', newScope);

// Good:
$controller('myController, {$scope: newScope}); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2015-06-09T16:14:00.887

上面的答案都不适合我，也许我做错了，但作为初学者，这就是我们所做的。

`div`为了得到一个列表，我正在初始化控制器：

```
 <div ng-controller="CategoryController" ng-init="initialize()"> 
```

然后使用`$routeProvider`将 URL 映射到同一个控制器。一旦我移除`ng-init`控制器，控制器就会与路线一起工作。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2015-06-18T22:03:50.367

我有同样的问题。我修复了使用`$('body').attr("ng-app", 'MyApp')`而不是`<body ng-app="MyApp">`boostrap 的问题。

因为我做到了

```
angular.element(document).ready(function () {        
    angular.bootstrap(document, [App.Config.Settings.AppName]);
}) 
```

用于架构要求。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-06-22T18:00:42.557

我今天遇到了类似的问题，问题真的很小

```
 app.directive('removeFriend', function($scope) {
return {
    restrict: 'E',
    templateUrl: 'removeFriend.html',
    controller: function($scope) {
        $scope.removing = false;
        $scope.startRemove = function() {
            $scope.removing = true;
        }
        $scope.cancelRemove = function() {
            $scope.removing = false;
        }
        $scope.removeFriend = function(friend) {
            var idx = $scope.user.friends.indexOf(friend)
            if (idx > -1) {
                $scope.user.friends.splice(idx, 1);
            }
        }
    }
}
}); 
```

如果你观察上面的代码块，你会在第一行看到我错误地注入了 $scope，这是不正确的。**我删除了不需要的依赖来解决问题。**

```
 app.directive('removeFriend', function() {
return {
    restrict: 'E',
    templateUrl: 'removeFriend.html',
    controller: function($scope) {
        $scope.removing = false;
        $scope.startRemove = function() {
            $scope.removing = true;
        }
        $scope.cancelRemove = function() {
            $scope.removing = false;
        }
        $scope.removeFriend = function(friend) {
            var idx = $scope.user.friends.indexOf(friend)
            if (idx > -1) {
                $scope.user.friends.splice(idx, 1);
            }
        }
    }
}
}); 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2018-09-24T12:00:20.803

创建新工厂并在组件中使用它后出现此错误，但我没有检查该组件的规格

> 因此，如果您的（规格）测试文件失败
> 
> 你需要添加 `beforeEach(module('YouNewServiceModule'));`

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2013-05-10T22:08:15.957

另一个“陷阱”：我在注入 $timeout 时遇到了这个错误，我花了几分钟才意识到我在数组值中有空格。这将不起作用：

```
angular.module('myapp',[].
  controller('myCtrl', ['$scope', '$timeout ', 
    function ($scope, $timeout){
      //controller logic
    }
  ]); 
```

发布以防万一其他人有这样的愚蠢错误。

* * *

## 回答 #30

> 赞同：-2
> 
> 时间：2014-01-28T15:49:02.430

我的案子是狡猾的打字

```
myApp.factory('Notify',funtion(){ 
```

函数有一个'c'！

# php - 添加“sDom”后数据表未加载数据

> ID：12339273
> 
> 赞同：3
> 
> 时间：2012-09-09T12:59:33.300
> 
> 标签：php, jquery, jquery-datatables

我使用 DataTables (datatables.net) 来显示我的数据，但是当我添加 sDom 元素时，没有数据加载到表中。

下面的代码有效

```
<script type="text/javascript" charset="utf-8">
            $(document).ready(function() {
                $('#table_main').dataTable( {
                    "bProcessing": true,
                    "bServerSide": true,
                    "sAjaxSource": "<?php echo base_url()?>datatable.php"

                });

            });
        </script> 
```

尽管创建了 sDom 中给出的标签，但没有从源加载任何数据。以及在 fnInitComplete 中给出的按钮样式也没有被应用

```
<script type="text/javascript" charset="utf-8">
            $(document).ready(function() {
                $('#table_main').dataTable( {
                    "bProcessing": true,
                    "bServerSide": true,
                    "sAjaxSource": "<?php echo base_url()?>datatable.php",
                    "sDom": "<'dtTop'<'dtShowPer'l><'dtFilter'f>><'dtTables't><'dtBottom'<'dtInfo'i><'dtPagination'p>>",
                         "fnInitComplete": function(){
                                $(".dtShowPer select").uniform();
                                $(".dtFilter input").addClass("simple_field").css({
                                    "width": "auto",
                                    "margin-left": "15px"
                            });
                         }

                });

            });
    </script> 
```

任何有关如何解决此错误的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T14:21:36.180

起初，文档没有说明子类插入，所以从工作起点尝试使用这样的代码（替换同一行）：

```
"sDom": '<"dtShowPer"l><"dtFilter"f><"dtTables">rt<"dtBottom"><"dtInfo"i><"dtPagination"p>', 
```

我没有任何带有数据的代码示例（但您可以在 pastebin.com 或其他网站上提供一些），并且代码似乎是正确的。所以只需在 sDom 中添加一条规则，并在检查它是否正常后逐条添加。

# objective-c - 使用 Interface Builder 的 XCode 项目中的随机图像

> ID：12339276
> 
> 赞同：0
> 
> 时间：2012-09-09T12:59:47.107
> 
> 标签：objective-c, uiimage, interface-builder

有没有办法在 XCode 中使用 Interface Builder 来显示随机图像？因此，假设我有三张图片，并且希望每次加载我的应用程序时随机显示一张。我是 XCode 的新手，所以我正在寻找最简单的方法，而 IB 似乎是要走的路。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:50:53.400

考虑了几秒钟后，我意识到答案是当然可以，但是太痛苦了，我怀疑您是否愿意。我想出了一种方法作为如何以这种方式使用 IB 的示例。

首先，子类 UIImageView，我称之为 MyRandomImageView。MyRandomImageView 的唯一成员是`@property (retain, nonatomic) NSString *randomImageJSON`.

接下来，将 UIImageView 添加到您的视图中。在 Identity Inspector 中，将自定义类从 UIImageView 更改为 MyRandomImageView。然后在 Identity Inspector 中，在 User Defined Runtime Attributes 下，将 randomImageJSON 设置为`[ "image1.png", "image2.png", "image3.png" ]`.

最后一部分是您遇到所有麻烦的地方。创建`-[MyRandomImageView setRandomImageJSON]`. 它需要设置`_randomImageJSON`iVar，用于`NSJSONSerialization`创建字符串数组，随机选择其中一个字符串，然后设置`self.image = [UIImage imageNamed:randomImage]`

这应该完全符合您的意愿，来自 Interface Builder 的随机图像。希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:43:48.587

您必须以编程方式执行此操作。还没有测试下面的代码，但我很确定它可以工作。

```
int imageNumber = arc4random() % 3;

imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:[NSString stringWithFormat:@"%i", imageNumber]]]; 
```

您应该首先在实现中声明它并将其链接到 Interface Builder 中的 UIImageView。

# windows - cannot access windows azure virtual machine

> ID：12339279
> 
> 赞同：1
> 
> 时间：2012-09-09T12:59:58.127
> 
> 标签：windows, azure, azure-virtual-machine

While configuring one of the subnet IP address (for virtual machine in windows azure), deleted Microsoft Virtual Machine Network Bus adapter and now cannot access the Virtual machine via RDP. Before this I was able to RDP into the virtual machine. Is there an alternate access to the virtual machine?

# arrays - 查找数组中元素的最大总和

> ID：12339280
> 
> 赞同：7
> 
> 时间：2012-09-09T13:00:06.780
> 
> 标签：arrays, algorithm

编写一个程序，通过给定的整数值数组（包含负整数）找到数组中连续元素的最大和。

例子：

> 2、3、-6、-1、2、**-1、6、4**、-8、8

给

> 11

我正在寻找比 O(N^2) 更快的解决方案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-09T13:12:08.700

我认为[Kadane 的算法](http://en.wikipedia.org/wiki/Maximum_subarray_problem)是你想要的

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-09T14:08:08.110

这实际上是我在大学学习的教科书问题（Mark Allen Weiss 在 C 中的数据结构和算法）......这是一个非常漂亮和优雅的解决方案，并且在 O(N) 中解决

```
int MaxSubsequenceSum(int A[])
{
    int sum = 0, maxSum = 0;

    for (int j = 0; j < A.Length; j++)
    {
        sum = sum + A[j];

        if (sum > maxSum)
            maxSum = sum ;
        else if (sum < 0)
            sum = 0;
    }
    return maxSum;
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2014-06-12T20:14:35.610

您可以首先按降序对给定数组进行排序，然后将数组的前三个元素通过 : `sum=arr[0]+arr[1]+arr[2]` 初始化`sum=0`并打印总和来求和。

# java - Play2 与日食

> ID：12339286
> 
> 赞同：2
> 
> 时间：2012-09-09T13:00:54.550
> 
> 标签：java, eclipse, scala, playframework-2.0

我现在在我的项目中很远〜大约 60 个不同的视图，我都是在没有 IDE 支持的情况下编写它们的。

现在我真的很想在eclipse中使用scala IDE

我用 eclipse helios indigo 和 juno 试过了，结果相同

我按照本教程[http://scala-ide.org/docs/tutorials/play20scalaide20/index.html](http://scala-ide.org/docs/tutorials/play20scalaide20/index.html)

现在我觉得这个教程有一个小错误 ![在此处输入图像描述](../Images/971aa7bba301db586b23969c3a36c257.png)

他选择了主文件夹，但我认为 src_managed 文件夹是正确的。但是，我尝试了两者都没有成功。

我的日食看起来像这样

![在此处输入图像描述](../Images/8b8c180323a4de361247b43fcf1d89be.png)

我试过`play clean`和`play compile` `play run`。`play ~run`

*   我只想在 .scala.html 中获得 scala 支持，这目前可能吗？

*   如果是，是否有可以格式化我的 .scala.html 文件的解决方案？

# c# - Can you help me parse this kml in c#?

> ID：12339290
> 
> 赞同：-3
> 
> 时间：2012-09-09T13:01:57.050
> 
> 标签：c#, xml, kml

i got this KML from a location weeb service and i need to parse it. i need to get all the PLACEMARK tags read i need just the name latitude and longitude from them. Thx for any help.

```
<?xml version="1.0" encoding="UTF-8" ?> 
 <kml xmlns="http://www.opengis.net/kml/2.2">
 <Document>
  <name>Lociraj.net (C) 2010</name> 
 <StyleMap id="highlighting">
 <Pair>
  <key>normal</key> 
  <styleUrl>#normalState</styleUrl> 
  </Pair>
 <Pair>
  <key>highlight</key> 
  <styleUrl>#highlightedState</styleUrl> 
  </Pair>
  </StyleMap>
 <Style id="highlightedState">
 <IconStyle>
  <scale>1.1</scale> 
 <Icon>
  <href>http://maps.google.com/mapfiles/kml/pal3/icon55.png</href> 
  </Icon>
  </IconStyle>
 <LabelStyle>
  <scale>1.1</scale> 
  </LabelStyle>
  </Style>
 <Style id="normalState">
 <IconStyle>
 <Icon>
  <href>http://maps.google.com/mapfiles/kml/pal3/icon63.png</href> 
  </Icon>
  </IconStyle>
  </Style>
 <Placemark>
  <name>Vaša lokacija</name> 
  <description /> 
 <LookAt>
  <longitude>15.976903</longitude> 
  <latitude>45.813182</latitude> 
  <altitude>0</altitude> 
  <range>500</range> 
  </LookAt>
 <Style>
 <IconStyle>
 <Icon>
  <href>http://lociraj.net/img/icon_map_your_location.png</href> 
  </Icon>
  </IconStyle>
  </Style>
 <Point>
  <coordinates>15.976903,45.813182,0</coordinates> 
  </Point>
  </Placemark>
 <Folder>
  <name>Bankomati</name> 
 <Placemark>
  <name>Raiffeisen</name> 
 <description>
 <![CDATA[ Ilica 1a, Zagreb<br><br>Raiffeisenbank<br>
<b>Udaljenost:</b> 65m<br>

  ]]> 
  </description>
 <LookAt>
  <longitude>15.9761</longitude> 
  <latitude>45.813</latitude> 
  <altitude>0</altitude> 
  <range>500</range> 
  </LookAt>
 <Style>
 <IconStyle>
 <Icon>
  <href>http://lociraj.net/img/icon_map_atm.png</href> 
  </Icon>
  </IconStyle>
  </Style>
 <ExtendedData xmlns:l="http://lociraj.net">
  <l:categoryID>1</l:categoryID> 
  <l:entryID>1782</l:entryID> 
  </ExtendedData>
 <Point>
  <coordinates>15.9761,45.813,0</coordinates> 
  </Point>
  </Placemark>
 <Placemark>
  <name>PBZ</name> 
 <description>
 <![CDATA[ Trg bana J. Jelačića 7, Zagreb<br><br><br>
<b>Udaljenost:</b> 66m<br>

  ]]> 
  </description>
 <LookAt>
  <longitude>15.9777218535</longitude> 
  <latitude>45.8133623448</latitude> 
  <altitude>0</altitude> 
  <range>500</range> 
  </LookAt>
 <Style>
 <IconStyle>
 <Icon>
  <href>http://lociraj.net/img/icon_map_atm.png</href> 
  </Icon>
  </IconStyle>
  </Style>
 <ExtendedData xmlns:l="http://lociraj.net">
  <l:categoryID>1</l:categoryID> 
  <l:entryID>921</l:entryID> 
  </ExtendedData>
 <Point>
  <coordinates>15.9777218535,45.8133623448,0</coordinates> 
  </Point>
  </Placemark>
 <Placemark>
  <name>Erste</name> 
 <description>
 <![CDATA[ Ilica bb, Zagreb<br><br>ZET okretište - Črnomerec<br>
<b>Udaljenost:</b> 68m<br>

  ]]> 
  </description>
 <LookAt>
 <longitude>15.976051</longitude> 
  <latitude>45.81303</latitude> 
  <altitude>0</altitude> 
  <range>500</range> 
  </LookAt>
 <Style>
 <IconStyle>
 <Icon>
  <href>http://lociraj.net/img/icon_map_atm.png</href> 
  </Icon>
  </IconStyle>
  </Style>
 <ExtendedData xmlns:l="http://lociraj.net">
  <l:categoryID>1</l:categoryID> 
  <l:entryID>309</l:entryID> 
  </ExtendedData>
 <Point>
  <coordinates>15.976051,45.81303,0</coordinates> 
  </Point>
  </Placemark>
 <Placemark>
  <name>Erste</name> 
 <description>
 <![CDATA[ Ilica 1, Zagreb<br><br>Prolaz - Neboder<br>
<b>Udaljenost:</b> 68m<br>

  ]]> 
  </description>
 <LookAt>
  <longitude>15.976051</longitude> 
  <latitude>45.81303</latitude> 
  <altitude>0</altitude> 
  <range>500</range> 
  </LookAt>
 <Style>
<IconStyle>
 <Icon>
  <href>http://lociraj.net/img/icon_map_atm.png</href> 
  </Icon>
  </IconStyle>
  </Style>
 <ExtendedData xmlns:l="http://lociraj.net">
  <l:categoryID>1</l:categoryID> 
  <l:entryID>300</l:entryID> 
  </ExtendedData>
 <Point>
  <coordinates>15.976051,45.81303,0</coordinates> 
  </Point>
  </Placemark>
 <Placemark>
  <name>ZaBa</name> 
 <description>
<![CDATA[ Ilica bb, Zagreb<br><br>ZET okretište - Črnomerec<br>
<b>Udaljenost:</b> 68m<br>

  ]]> 
  </description>
 <LookAt>
  <longitude>15.976051</longitude> 
  <latitude>45.81303</latitude> 
  <altitude>0</altitude> 
  <range>500</range> 
  </LookAt>
 <Style>
 <IconStyle>
 <Icon>
  <href>http://lociraj.net/img/icon_map_atm.png</href> 
  </Icon>
  </IconStyle>
  </Style>
 <ExtendedData xmlns:l="http://lociraj.net">
  <l:categoryID>1</l:categoryID> 
  <l:entryID>1519</l:entryID> 
  </ExtendedData>
 <Point>
  <coordinates>15.976051,45.81303,0</coordinates> 
  </Point>
  </Placemark>
  </Folder>
  </Document>
  <kml> 
```

Can you help me parse this

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T13:15:10.290

```
XDocument xDoc = XDocument.Load(....);
XNamespace ns = "http://www.opengis.net/kml/2.2";

var placemarks = xDoc
            .Descendants(ns + "Placemark")
            .Select(p => new
            {
                Name = p.Element(ns+"name").Value,
                Longitude = p.Element(ns+"LookAt").Element(ns+"longitude").Value,
                Latitude = p.Element(ns+"LookAt").Element(ns+"latitude").Value,
            })
            .ToArray(); 
```

# php - PHP RegEx 匹配部分数据

> ID：12339291
> 
> 赞同：0
> 
> 时间：2012-09-09T13:02:04.427
> 
> 标签：php, regex

我正在尝试使用 RegEx 解析 ESPN 底线提要，但有点短。它没有获得所有的 NFL 比赛，它只获得了大约一半。

这是 ESPN 返回的数据。

```
 &nfl_s_delay=120&nfl_s_stamp=0909064837&nfl_s_left1=^Dallas 24   NY Giants 17 (FINAL)&nfl_s_right1_count=0&nfl_s_url1=http://sports.espn.go.com/nfl/boxscore?gameId=320905019&nfl_s_left2=Indianapolis at Chicago (1:00 PM ET)&nfl_s_right2_count=0&nfl_s_url2=http://sports.espn.go.com/nfl/preview?gameId=320909003&nfl_s_left3=Philadelphia at Cleveland (1:00 PM ET)&nfl_s_right3_count=0&nfl_s_url3=http://sports.espn.go.com/nfl/preview?gameId=320909005&nfl_s_left4=St. Louis at Detroit (1:00 PM ET)&nfl_s_right4_count=0&nfl_s_url4=http://sports.espn.go.com/nfl/preview?gameId=320909008&nfl_s_left5=New England at Tennessee (1:00 PM ET)&nfl_s_right5_count=0&nfl_s_url5=http://sports.espn.go.com/nfl/preview?gameId=320909010&nfl_s_left6=Atlanta at Kansas City (1:00 PM ET)&nfl_s_right6_count=0&nfl_s_url6=http://sports.espn.go.com/nfl/preview?gameId=320909012&nfl_s_left7=Jacksonville at Minnesota (1:00 PM ET)&nfl_s_right7_count=0&nfl_s_url7=http://sports.espn.go.com/nfl/preview?gameId=320909016&nfl_s_left8=Washington at New Orleans (1:00 PM ET)&nfl_s_right8_count=0&nfl_s_url8=http://sports.espn.go.com/nfl/preview?gameId=320909018&nfl_s_left9=Buffalo at NY Jets (1:00 PM ET)&nfl_s_right9_count=0&nfl_s_url9=http://sports.espn.go.com/nfl/preview?gameId=320909020&nfl_s_left10=Miami at Houston (1:00 PM ET)&nfl_s_right10_count=0&nfl_s_url10=http://sports.espn.go.com/nfl/preview?gameId=320909034&nfl_s_left11=San Francisco at Green Bay (4:25 PM ET)&nfl_s_right11_count=0&nfl_s_url11=http://sports.espn.go.com/nfl/preview?gameId=320909009&nfl_s_left12=Seattle at Arizona (4:25 PM ET)&nfl_s_right12_count=0&nfl_s_url12=http://sports.espn.go.com/nfl/preview?gameId=320909022&nfl_s_left13=Carolina at Tampa Bay (4:25 PM ET)&nfl_s_right13_count=0&nfl_s_url13=http://sports.espn.go.com/nfl/preview?gameId=320909027&nfl_s_left14=Pittsburgh at Denver (8:20 PM ET)&nfl_s_right14_count=0&nfl_s_url14=http://sports.espn.go.com/nfl/preview?gameId=320909007&nfl_s_left15=Cincinnati at Baltimore (7:00 PM ET)&nfl_s_right15_count=0&nfl_s_url15=http://sports.espn.go.com/nfl/preview?gameId=320910033&nfl_s_left16=San Diego at Oakland (10:15 PM ET)&nfl_s_right16_count=0&nfl_s_url16=http://sports.espn.go.com/nfl/preview?gameId=320910013&nfl_s_count=16&nfl_s_loaded=true 
```

我正在使用两种 RegEx 模式，一种用于捕获已完成/正在进行的游戏：

```
preg_match_all('/nfl_s_left\d{1,2}=\^?(?P<awayteam>[a-zA-Z]+(?:\s+[a-zA-Z]+)*)\s+(?P<awayscore>\d+)\s+\^?(?P<hometeam>[a-zA-Z]+(?:\s+[a-zA-Z]+)*)\s+(?P<homescore>\d+)\s+(?P<time>\(.*?\))/', $content, $matches_in_progress, PREG_SET_ORDER); 
```

还有一个可以捕捉尚未开始的游戏：

```
preg_match_all('/nhl_s_left\d=\^?(?P<awayteam>[a-zA-Z]+(?:\s+[a-zA-Z]+)*)\s+(at)+\s+\^?(?P<hometeam>[a-zA-Z]+(?:\s+[a-zA-Z]+)*)\s(?P<time>\(.*?\))/', $content, $matches_upcoming, PREG_SET_ORDER); 
```

16场比赛中只有8场比赛，我不知道为什么。本周的比赛是`Dallas at NY Giants`, `Philadelphia at Cleveland`, `New England at Tennessee`, `Atlanta at Kansas City`, `Jacksonville at Minnesota`, `Washington at New Orleans`, 和`Buffalo at NY Jets`。

我非常感谢任何帮助让我的 RegEx 匹配本周和未来几周的所有 16 场比赛。

编辑：修改字符串以匹配，忘记在应用正则表达式之前我删除了 %20 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:12:25.130

您的正则表达式非常复杂。由于原始字符串被编码为 URL 参数，您可以使用它`parse_str`来获取 key => value 数组。然后使用正则表达式查找您想要的条目。

```
$string = "&nfl_s_delay=120&nfl_s_stamp=0909054449&nfl_s_left1=^Dallas%2024%20%20%20NY%20Giants%2017%20(FINAL)&nfl_s_right1_count=0&nfl_s_url1=http://sports.espn.go.com/nfl/boxscore?gameId=320905019&nfl_s_left2=Indianapolis%20at%20Chicago%20(1:00%20PM%20ET)&nfl_s_right2_count=0&nfl_s_url2=http://sports.espn.go.com/nfl/preview?gameId=320909003&nfl_s_left3=Philadelphia%20at%20Cleveland%20(1:00%20PM%20ET)&nfl_s_right3_count=0&nfl_s_url3=http://sports.espn.go.com/nfl/preview?gameId=320909005&nfl_s_left4=St.%20Louis%20at%20Detroit%20(1:00%20PM%20ET)&nfl_s_right4_count=0&nfl_s_url4=http://sports.espn.go.com/nfl/preview?gameId=320909008&nfl_s_left5=New%20England%20at%20Tennessee%20(1:00%20PM%20ET)&nfl_s_right5_count=0&nfl_s_url5=http://sports.espn.go.com/nfl/preview?gameId=320909010&nfl_s_left6=Atlanta%20at%20Kansas%20City%20(1:00%20PM%20ET)&nfl_s_right6_count=0&nfl_s_url6=http://sports.espn.go.com/nfl/preview?gameId=320909012&nfl_s_left7=Jacksonville%20at%20Minnesota%20(1:00%20PM%20ET)&nfl_s_right7_count=0&nfl_s_url7=http://sports.espn.go.com/nfl/preview?gameId=320909016&nfl_s_left8=Washington%20at%20New%20Orleans%20(1:00%20PM%20ET)&nfl_s_right8_count=0&nfl_s_url8=http://sports.espn.go.com/nfl/preview?gameId=320909018&nfl_s_left9=Buffalo%20at%20NY%20Jets%20(1:00%20PM%20ET)&nfl_s_right9_count=0&nfl_s_url9=http://sports.espn.go.com/nfl/preview?gameId=320909020&nfl_s_left10=Miami%20at%20Houston%20(1:00%20PM%20ET)&nfl_s_right10_count=0&nfl_s_url10=http://sports.espn.go.com/nfl/preview?gameId=320909034&nfl_s_left11=San%20Francisco%20at%20Green%20Bay%20(4:25%20PM%20ET)&nfl_s_right11_count=0&nfl_s_url11=http://sports.espn.go.com/nfl/preview?gameId=320909009&nfl_s_left12=Seattle%20at%20Arizona%20(4:25%20PM%20ET)&nfl_s_right12_count=0&nfl_s_url12=http://sports.espn.go.com/nfl/preview?gameId=320909022&nfl_s_left13=Carolina%20at%20Tampa%20Bay%20(4:25%20PM%20ET)&nfl_s_right13_count=0&nfl_s_url13=http://sports.espn.go.com/nfl/preview?gameId=320909027&nfl_s_left14=Pittsburgh%20at%20Denver%20(8:20%20PM%20ET)&nfl_s_right14_count=0&nfl_s_url14=http://sports.espn.go.com/nfl/preview?gameId=320909007&nfl_s_left15=Cincinnati%20at%20Baltimore%20(7:00%20PM%20ET)&nfl_s_right15_count=0&nfl_s_url15=http://sports.espn.go.com/nfl/preview?gameId=320910033&nfl_s_left16=San%20Diego%20at%20Oakland%20(10:15%20PM%20ET)&nfl_s_right16_count=0&nfl_s_url16=http://sports.espn.go.com/nfl/preview?gameId=320910013&nfl_s_count=16&nfl_s_loaded=true";
parse_str($string, $array);
var_dump($array); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:59:28.010

发现错误。我没有`d{1,2}`在第二个正则表达式中匹配 10-16 场比赛。而且我也没有`+(?:\.*)`迫使圣路易斯被跳过。

我的新工作正则表达式是：

```
/nfl_s_left\d{1,2}=\^?(?P<awayteam>[a-zA-Z]+(?:\.*)+(?:\s+[a-zA-Z]+)*)\s+(at)+\s+\^?(?P<hometeam>[a-zA-Z]+(?:\s+[a-zA-Z]+)*)\s(?P<time>\(.*?\))/ 
```

# sql-server - 存储过程和链接服务器

> ID：12339295
> 
> 赞同：1
> 
> 时间：2012-09-09T13:03:17.640
> 
> 标签：sql-server, sql-server-2005, stored-procedures

我有一个存储过程，其中包含一个简单的选择语句：

```
 ALTER PROCEDURE [dbo].[TransferAuditRecords] 
As
SET NOCOUNT ON
SET XACT_ABORT ON

Declare @UserCode As varchar(50)

DECLARE AuditCursor CURSOR FOR
        select top 1 UserCode from [AuditDatabaseServer].AuditDatabase.dbo.dbaudit where auditdate >= '2012-09-04'  
        Open AuditCursor
        FETCH NEXT FROM AuditCursor INTO @UserCode
        WHILE @@FETCH_STATUS = 0  
            BEGIN
                Print @Usercode
                FETCH NEXT FROM AuditCursor INTO @UserCode
            END

    Close AuditCursor 
    Deallocate AuditCursor 
```

缺少几行代码，我将其排除在外，因为它们与问题无关。

如果我在没有存储过程的情况下执行 SQL 语句，即在 SQL Studio Manager 2005 中，那么我得到的输出与我运行存储过程不同，即返回的顶部引用不同。为什么输出不同？

我相当确定这是因为 SQL Server 对编译代码使用不同的执行计划，这与 SQL Studio Manager 中运行的代码进行了比较。我想检查一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:49:32.667

使用 ORDER BY 子句可预测地指示选择了哪一行。

例如选择前 1... 按审计日期排序

Unrelated:: 您删除的部分代码是否需要使用游标？我猜是这样，否则一个更简单的“选择前 1 个 @UserCode = UserCode from ...”就足够了。

# image - 在 GAE 应用程序中维护横幅

> ID：12339302
> 
> 赞同：0
> 
> 时间：2012-09-09T13:04:50.820
> 
> 标签：image, google-app-engine

我打算部署一个 GAE 应用程序并想到一个问题：如果我的页面中有一组横幅，那么在应用程序本身之外维护此类图像/swf 文件的最有效方法是什么？目标不是仅仅因为某些图形文件发生更改而必须重新部署应用程序。

我的第一个意图是使用 Java，但如果它在这件事上有所作为，我愿意切换到 Go 或 Python。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:16:20.703

这取决于您将如何对其进行编程。如果横幅将成为您的静态文件的一部分，那么您每次想要更改横幅时都必须重新部署。但是，如果您打算以动态方式实现它，那么除非有更新，否则无需重新部署。您可以通过在应用程序中添加更改横幅的功能（例如上传新横幅或更改 URL）或将横幅存储在外部提供商中并覆盖它们来实现这一点。

如果您现在开始，我建议您使用[Python](https://developers.google.com/appengine/docs/python/gettingstartedpython27/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T00:39:30.567

您可以在任何提供 URL 的服务上托管横幅 SWF。然后您可以更改 URL 指向的文件。

如果您想在 App Engine 上托管它们，那么您可能需要使用 Blobstore。查看 Blobstore API。

# php - 在 Facebook 等 jomsocial 的墙上添加 href

> ID：12339303
> 
> 赞同：1
> 
> 时间：2012-09-09T13:04:56.390
> 
> 标签：php, javascript, jquery, facebook, joomla

> 在 Facebook Wall 中，如果您添加网站的 href 链接或 URL，Facebook 将抓取该特定链接的图像和描述并将其显示在帖子上。

如何在 Jomsocial 中实现这一点？

至少告诉如何使用普通的 PHP 和 Javascript 或 Jquery 来实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:14:07.373

我把这个放在身边。创建一个 id="showthumb" 的 div，创建一个 textarea.. 用作此函数中的 obj。

```
function getthumb ($obj)
{    
     $obj.keydown (function (e) //obj is the textbox
     {
    if (e.keyCode == 32 || e.charCode == 32) { //user pressed space.
        var t_content = $obj.val ();
        var t_urls = t_content.match (/https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w/_\.]*(\?\S+)?)?)?/);

        if (t_urls != null) {
            if (t_urls.length > 0) {
                $('#showthumb').html ('<img src='+t_urls['input']+'>');
            }
        }
    }
 });
} 
```

您可能可以将其设置在可编辑的 div.btw 中。我从[这里学到了这一点](http://youhack.me/2011/06/25/create-a-facebook-wall-system-using-php-and-jquery-part-1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T13:18:28.260

一个简单的方法是这样的：假设您有一个文本区域，用户可以在其中输入链接。

步骤 1：使用`onchange` event of`textarea`来了解是否有人输入了某些内容。

Step2：使用 Jquery 确定是否为 Url 。代码将是这样的。

一些正则表达式从这样的 textarea 中提取正确的 url

```
 var regex=/Your Regex to know url/ 
 var url= regex.mathc($('#textareaid').val()). 
```

第三步：现在你得到了 url 。使用它发送到服务器。

```
 $.ajax({
                       url:submit.php
                       type:'POST'
                       success:// do your dom mainpulation code here by geting the data from server. 
                           }); 
```

第 4 步：在您的 php 代码中进行 httpwebrequest 以获取该 url 的内容 html。您可以使用一些实用程序从您获得的 html 中提取图像和标题。将其作为对您发出的 ajax 请求的响应发送。

第5步：你完成了。在 ajax 请求成功时，您将从服务器发送的数据附加到您的 DOM。

# adobe - 什么是 Adob e Media Server IP 多播？

> ID：12339304
> 
> 赞同：0
> 
> 时间：2012-09-09T13:04:56.183
> 
> 标签：adobe, flash-media-server

我想知道如果我拥有具有 IP 多播功能的版本，它将如何使我的应用程序受益。请用简单的话给我解释一下。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T01:44:41.670

Adobe Media Server 支持 IP 多播流和将实时视频录制到 Flash Player 10.1 或更高版本。多播是一种高度优化的方法，可在需求增加时向大量观众提供高质量视频，而对服务器几乎没有影响。

Adobe Media Server 可以从任何实时 RTMP 流或来自服务器端播放列表的线性流生成多播广播。Flash Player 10.1 和更高版本的客户端不需要服务器连接来接收流。多播对于企业网络内的大规模广播非常有用。

使用 OSMF 开发的视频播放器将完全支持 IP 多播。

特定源多播 (SSM) 允许您生成和使用 SSM 和任意源多播 (ASM)，从而启用流复制、服务器端录制或通过单独的多播通道或 RTMFP 组重新广播。SSM 支持减少了对网络资源的需求，同时也提高了流的安全性。

# php - MYSQL 为 200 行生成 5 个随机字符（1-9，AZ）

> ID：12339305
> 
> 赞同：0
> 
> 时间：2012-09-09T13:05:25.673
> 
> 标签：php, mysql

有没有办法自动创建一个 200 行的表（id，密码），并使用 php/mysql 为 200 行生成 5 位密码（1-9，AZ）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:11:06.137

要在 MySQL 中生成 5 位密码，您可以使用如下内容：

```
SUBSTRING(conv(floor(rand() * 99999999999999), 20, 36), 1, 5); 
```

如果您想解决数据库级别的所有问题，您可以查看存储过程提供的循环语法。

```
CREATE PROCEDURE doiterate(p1 INT)
BEGIN
  label1: LOOP
    SET p1 = p1 + 1;
    IF p1 < 10 THEN
      ITERATE label1;
    END IF;
    LEAVE label1;
  END LOOP label1;
  SET @x = p1;
END; 
```

示例来自：[http ://dev.mysql.com/doc/refman/5.5/en/loop.html](http://dev.mysql.com/doc/refman/5.5/en/loop.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:09:36.257

```
<?php
function generate($length, $chars = '') {
    if (!$chars) $chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890';
    $ret = '';
    for ($x=0;$x<$length;$x++) {
        $ret .= $chars[rand(0,strlen($chars)-1)];
    }
    return $ret;
}

for ($x=0;$x<200;$x++) {
    Sql::exec('INSERT INTO users (id,password) VALUES (NULL,?)',generate(5)); // just replace with your own function to execute SQL
}
?> 
```

# css - 获得具有相同色调但另一种颜色的颜色？

> ID：12339310
> 
> 赞同：1
> 
> 时间：2012-09-09T13:06:05.017
> 
> 标签：css, colors

在我的 CSS 中，我将`#error`div 定义为：

```
#error {
    border-width:1px;
    border-style:solid;
    border-color: #DD3C10;
    background:#FFEBE8;
    /* Other settings */
} 
```

实际上，上面的代码不是我的——我使用了与 Facebook 相同的颜色。现在，我想对`#success`div 做同样的事情，但我不知道要使用哪种颜色。我想保持相同的色调（即“全彩”和“白色”之间的线上的位置），但不是绿色而不是红色。我该怎么做？有“公式”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:17:52.130

您关心颜色的 HSL 表示中的 L（亮度）分量。您可以在此处找到在线转换器（RGB/HEX 到 HSL）：[little link](http://serennu.com/colour/hsltorgb.php)。

HSL 为`#DD3C10`is `13° 86% 46%`，而`#FFEBE8`is `8° 100% 95%`。如您所见，亮度差异是`49%`.

假设您的绿色为`border`is `#00FF00`，它`120° 100% 50%`在 HSL 中。要计算新的亮度分量，只需添加`49%`. 因此，绿色`background`是`120° 100% 99%`哪个是`#FAFFFA`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:26:12.830

肯定有一个简单的方法。只需使用 HSL 颜色系统，而不是 RGB - 使用它来选择所需的颜色更加直观，它是为图像着色时选择使用的颜色系统。

然后您所要做的就是将基色表示为 HSL 颜色，然后只需更改饱和度或亮度，同时保持色相不变。

例如

*   边界科尔=#DD3C10；(rgb) ---- hsl(13,93%,87%)
*   背景=#FFEBE8；(rgb) --- hsl(8,9%,100%)

新的

*   边界线=#49DD10；(rgb) ---- hsl(103,93%,87%)
*   背景=#f0ffe8；(rgb) --- hsl(98,9%,100%)

# usb - Android USBHost 模式 - 为什么我的 IRDA 设备在 claimInterface 上失败？

> ID：12339312
> 
> 赞同：3
> 
> 时间：2012-09-09T00:42:54.137
> 
> 标签：usb

我有一个 Lindy IRDA USB 桥接器连接到我的 Xperia Neo (Cyanogen Mod 9)。我已经更改了功能以支持主机模式等。代码中一切看起来都很好。我检测到设备。我可以看到接口和两个端点（一进一出），但是一旦我尝试声明接口，它就会失败，无论我是否尝试强制声明。

似乎没有简单的方法可以找出索赔失败的原因。尽管 strace 给了我一个线索，因为对声明接口的 ioctl 调用失败并出现未找到设备错误。

忽略失败只会让我收到无法排队或发送的请求。

我的问题是（我认为）：-

1.  究竟缺少什么导致索赔失败？
2.  有没有办法解决这个问题，理想情况下不需要root？
3.  有没有办法以某种方式覆盖索赔？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T20:58:37.420

好的，所以我似乎已经在这里回答了我自己的问题，但是我看到很多人对 USB 主机的明显支持和可以观察到的“奇怪”行为感到困惑，所以希望这个答案可以帮助一些人你出去。

我提出了 3 个问题，我对 1 和 3 有一个明确的答案，但在这个阶段我对另一个问题不太确定。

1）究竟缺少什么，为什么这会导致错误的索赔？问题是主机（我的 Xperia Neo 手机）正在检测该设备，一个[lindy IRDA 加密狗](http://www.amazon.co.uk/gp/product/B0011DYG1O/ref=oh_details_o00_s00_i00)，但它支持的唯一配置是要求手机支持太多功率。

奇怪的是，这并不能阻止 a) 设备被 Android 库检测和枚举，或者 b) 设备似乎已通电（红色 LED 发光）

在任何系统库调用失败的 claimInterface() 时都没有报告，但是连接设备时运行的 dmesg|tail 提供了必要的洞察力。

```
dmesg | tail
<3>usb 1-1: device v066f p4200 is not supported
<6>usb 1-1: New USB device found, idVendor=066f, idProduct=4200
<6>usb 1-1: New USB device strings: Mfr=1, Product=2, SerialNumber=0
<6>usb 1-1: Product:  IrDA/USB Bridge
<6>usb 1-1: Manufacturer:  Sigmatel Inc
<6>usb 1-1: rejected 1 configuration due to insufficient available bus power
<4>usb 1-1: no configuration chosen from 1 choice 
```

进一步的调查表明，这个小设备声称需要 440mA，这似乎相当多，但似乎几乎没有什么可以做的。

问题 2 可以做任何不需要 root 的事情来解决这个问题吗？似乎没有。从理论上讲，我可以通过使用 USB Y 电缆或类似的黑客技术为设备提供外部电源，但我认为这不会改变手机拒绝需求的根本问题。即使使用 root 也不清楚是否可以做任何事情来覆盖电源配置文件。

问题 3，有没有办法覆盖 claimInterface() 失败并强制通信？这是一个直截了当的不。该设备根本不是由内核创建的，因此首先没有什么可以覆盖的。这确实让 Android 库为什么仍然提供它有点令人费解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:41:34.000

至于问题 2 和电源需求...

我遇到的大多数支持 Host/OTG 的 android 设备仅支持大约 100 mA 的最大电流消耗。你能通过一些内核源代码强制它工作吗？很可能，但您会冒着烧毁 android 设备中的 USB 支持电路的风险。这是因为此类设备用于为外部 USB 设备供电的升压转换器仅在物理上支持最大 100 mA 的电流消耗。

您可以使用 Y 型电缆从外部提供所需的电流吗？是的，我之前在没有升压转换器的设备上做过这个，但是你需要在内核中有一个解决方法来告诉它你有这样的外部电源，现在可以给设备供电了。

# ruby-on-rails - 发送带附件的电子邮件

> ID：12339314
> 
> 赞同：6
> 
> 时间：2012-09-09T13:06:35.327
> 
> 标签：ruby-on-rails, actionmailer, email-attachments, sendgrid, wicked-pdf

我有一个邮件，如下：

```
class Payments::LateNoticesMailer < AsyncMailer
  def notice(payment_id)
    @payment = PaymentDecorator.find(payment_id)
    @invoice = @payment.invoice
    template = "payments/invoices/#{@payment.made_with_type.downcase}/show"

    attachments["#{@payment.invoice_filename}.pdf"] =
      WickedPdf.new.pdf_from_string( render_to_string( pdf:      @payment.invoice_filename,
                                                       formats:  [:pdf],
                                                       template: template,
                                                       layout:   "layouts/pdf.html"))

    mail to:      @payment.payer_email,
         from:    '"RentingSmart" <no-reply@rentingsmart.com>',
         cc:      @payment.landlord_email,
         subject: "*** Your rent payment of #{@payment.amount_due} is overdue ***"
  end
end 
```

我使用 SendGrid 发送的。这是我的问题，如果我通过 Gmail 打开电子邮件，一切正常，电子邮件的文本在那里，附件已附加。但是，如果我使用 OSX 的 Mail.app 或在我的 iPhone 上打开它，我只会得到以下信息：

> 这是一条 MIME 格式的多部分消息...

有人有任何提示吗？我想我正确地遵循了 Rails 指南。

这是我打的电话`Payments::LateNoticesMailer.notice(payment.id).deliver`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T06:36:37.933

根据[ActionMailer::Base](http://api.rubyonrails.org/classes/ActionMailer/Base.html)的 api 文档，如果使用了多种模板类型，则它们都会被渲染，并且 mime-type 会自动设置为 multipart/alternative。

如果添加附件，则附件将放置在多部分/混合容器中。

第一个问题：你是在渲染其他类型，比如text和html吗？我不建议发送仅包含 pdf 部分的电子邮件。即使文本和 html 部分只是指示收件人打开附件，它们也应该在那里。理想情况下，text/html 部分中会有更多信息。

其次，您是否尝试查看 pdf 内联，而不是作为附件？

您能否查看电子邮件的原始来源并使用您看到的结构更新您的帖子？标题中将设置一个初始 mime 类型。它看起来像这样：

```
Mime-Version: 1.0
Content-Type: multipart/mixed;
 boundary="--==_mimepart_50596418be947_c7223fec9d834d3874256";
 charset=UTF-8
Content-Transfer-Encoding: 7bit 
```

这表示要遵循的部分不是相同信息的替代版本，而是指示电子邮件客户端清楚地显示它们。

稍后在电子邮件中，您的文本和 html 部分应按以下方式进行：

```
----==_mimepart_50596418be947_c7223fec9d834d3874256
Date: Wed, 19 Sep 2012 06:20:12 +0000
Mime-Version: 1.0
Content-Type: multipart/alternative;
 boundary="--==_mimepart_50596418be468_c7223fec9d834d38741a5";
 charset=UTF-8
Content-Transfer-Encoding: 7bit 
```

最后，编码的 pdf 部分应该有一个 mime 标头，例如：

```
----==_mimepart_50596418be947_c7223fec9d834d3874256
Date: Wed, 19 Sep 2012 06:20:12 +0000
Mime-Version: 1.0
Content-Type: application/pdf;
 charset=UTF-8;
 filename=terms.pdf
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename=terms.pdf 
```

通过我刚刚发送给自己的带有文本、html 部分和大 pdf 的简单测试电子邮件，我可以在我的 iphone 上查看电子邮件。它显示了 html 部分和一个让我下载 pdf 的图标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T05:58:21.053

某些电子邮件客户端可能要求电子邮件包含纯文本部分才能正确显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-26T22:57:11.750

我刚刚在将 Rails 应用程序从 2.3 转换为 3.2 时遇到此消息。我以为我正确转换了我的邮件程序，但`content_type: "multipart/mixed"`选项中指定了旧版本。但是，当我删除它时，我收到了附件以及正确呈现的 HTML 和纯文本。我认为在其中设置该设置会覆盖 Rails 为放入不同类型的内容所做的一切，这不是我想要的。感谢最初的答案引导我朝那个方向发展。

# ios - 使用 NSXMLParser 分块解析 XML

> ID：12339315
> 
> 赞同：0
> 
> 时间：2012-09-09T13:06:39.497
> 
> 标签：ios, xml, nsxmlparser

我想`NSXMLParser`用来解析一个大的 xml 文件。根级别有几千个元素，因此对于基于树的方法来说太大了。理想情况下，我想将这一千个元素中的每一个单独解析成一棵树，然后对它们进行一些（更复杂的）解析。我只需要这些根级元素的字符串值（包括 xml 标记），然后我可以将它们交给我已经存在的基于树的解析器。`NSXMLParser`如果可能的话，我无法找到如何使用.

想象一个像这样的xml文件

```
<start>
 <record>
  <title>The Title</title>
  <content>Some content</content>
 </record>
 <record>
  <title>The Title</title>
  <content>Some content</content>
 </record>
</start> 
```

对于每个`record`，我想得到一个包含`<title>The Title</title> <content>Some content</content>`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:24:42.580

我最终将所有内容都重写为 SAX 解析器。实现起来稍微复杂一些，而且相当严格，但就我而言，加速和内存使用确实值得。

# grails - 在测试中断言 SpringSecurity 编码的密码

> ID：12339316
> 
> 赞同：0
> 
> 时间：2012-09-09T13:06:54.627
> 
> 标签：grails, spring-security, encode

我想做类似的事情：

```
class MySpec extends Specification{
    def 'test'(){
        given: 'a user that has its password encoded by SpringSecurity'
            def user = new SecUser(username: 'blah', password: 'p').save(flush:true)
            MessageDigest md = MessageDigest.getInstance('MD5')
            md.update('p'.getBytes('UTF-8'))
        expect: 'the password should be encoded with MD5 algorithm'
            user.password == (new BASE64Encoder()).encode(md.digest())
    }
} 
```

在我的 Config.groovy 中，我添加了以下行：

grails.plugins.springsecurity.password.algorithm="MD5"

这不起作用（断言失败）。有任何想法吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T16:18:29.317

与其自己进行编码，不如尝试使用

```
springSecurityService.encodePassword(user.password) 
```

别忘了你的盐！如果你有一个（如果你没有，你应该考虑一个！）你可以将它作为第二个参数传入。

# wpf - 如何在 wpf 项目中使用 Elysium 主题

> ID：12339317
> 
> 赞同：0
> 
> 时间：2012-09-09T13:07:34.613
> 
> 标签：wpf, themes

我正在尝试使用 elysium 主题我通过 Nuget 添加它还手动添加了库但仍然无法正常工作，我找不到和文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T02:08:14.657

安装 Elysium 的分步指南 - [http://bizvise.com/2012/09/24/how-to-install-elysium-on-visual-studio-project/](http://bizvise.com/2012/09/24/how-to-install-elysium-on-visual-studio-project/)

此处回答了类似的问题 -[如何使用 Elysium 项目？](https://stackoverflow.com/questions/11704835/how-do-i-use-the-elysium-project)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T18:03:28.793

[您可以从官方网站](http://elysiumproject.net)下载文档。

# asp.net - Response.Redirect 正在进行的下载

> ID：12339322
> 
> 赞同：0
> 
> 时间：2012-09-09T13:07:57.633
> 
> 标签：asp.net, response.redirect

我有一个网站，用户可以选择观看第三方网站上的视频（无版权）。从用户选择它的那一刻起，它需要先下载到我的网络服务器上，然后用户才能访问它。我尝试在第 3 方网站上自动开始下载并使用此路径进行 response.redirect，但是当用户观看视频时，如果视频仅下载 10 秒，任何播放器/浏览器都会将此视频视为10 秒视频并在 10 秒后停止。

重定向流而不是文件的最佳做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:33:18.387

我发现这段代码正是我想要的。它在第三方网站上下载一个文件，并在流式传输文件时，将每个块写入响应中，以便完全混淆来源。因此，可以提供来自任何网站的任何文件，就好像我拥有它一样。

```
Private Sub SendFile(ByVal url As String)
    Dim stream As System.IO.Stream = Nothing
    Dim bytesToRead As Integer = 10000
    Dim buffer() As Byte = New Byte((bytesToRead) - 1) {}

    Try

        Dim fileReq As System.Net.WebRequest = CType(System.Net.HttpWebRequest.Create(url), System.Net.HttpWebRequest)
        Dim fileResp As System.Net.HttpWebResponse = CType(fileReq.GetResponse, System.Net.HttpWebResponse)
        If (fileReq.ContentLength > 0) Then
            fileResp.ContentLength = fileReq.ContentLength
        End If
        stream = fileResp.GetResponseStream
        Dim resp As System.Web.HttpResponse = HttpContext.Current.Response
        resp.ContentType = "application/octet-stream"
        resp.AddHeader("Content-Disposition", ("attachment; filename=\""" + ("mp3" + "\""")))
        resp.AddHeader("Content-Length", fileResp.ContentLength.ToString)
        Dim length As Integer = 1000000
        While (length > 0)
            If resp.IsClientConnected Then
                length = stream.Read(buffer, 0, bytesToRead)
                resp.OutputStream.Write(buffer, 0, length)
                resp.Flush()
                buffer = New Byte((bytesToRead) - 1) {}
            Else
                length = -1
            End If        
        End While
    Catch
        stream.Close()
    Finally
        If (Not (stream) Is Nothing) Then
            stream.Close()
        End If
    End Try
    Response.End()
End Sub 
```

# python - BeautifulSoup 中“findAll”和“find_all”的区别

> ID：12339323
> 
> 赞同：41
> 
> 时间：2012-09-09T13:08:00.570
> 
> 标签：python, xml-parsing, html-parsing, beautifulsoup

我想用 Python 解析一个 HTML 文件，我使用的模块是 BeautifulSoup。

据说功能`find_all`同`findAll`。我已经尝试过这两种方法，但我相信它们是不同的：

```
import urllib, urllib2, cookielib
from BeautifulSoup import *
site = "http://share.dmhy.org/topics/list?keyword=TARI+TARI+team_id%3A407"

rqstr = urllib2.Request(site)
rq = urllib2.urlopen(rqstr)
fchData = rq.read()

soup = BeautifulSoup(fchData)

t = soup.findAll('tr') 
```

谁能告诉我区别？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-09-09T13:21:17.457

在 BeautifulSoup 版本 4 中，方法完全相同；混合大小写版本（`findAll`、`findAllNext`、`nextSibling`等）已全部重命名以符合[Python 样式指南](http://www.python.org/dev/peps/pep-0008/)，但*旧*名称仍可使用以使移植更容易。有关完整列表，请参阅[方法名称](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#method-names)。

在新代码中，您应该使用小写版本，so`find_all`等。

但是，在您的示例中，您使用的是 BeautifulSoup*版本 3*（自 2012 年 3 月起停产，如果您能提供帮助，*请不要*使用它），只有在哪里`findAll()`可用。未知属性名称（例如`.find_all`，仅在 BeautifulSoup 4 中可用）被视为您正在搜索该名称的标签。`<find_all>`您的文档中没有标签，因此`None`为此返回。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-12-19T18:29:25.730

来自 BeautifulSoup 的源代码：

[http://bazaar.launchpad.net/~leonardr/beautifulsoup/bs4/view/head:/bs4/element.py#L1260](http://bazaar.launchpad.net/~leonardr/beautifulsoup/bs4/view/head:/bs4/element.py#L1260)

```
def find_all(self, name=None, attrs={}, recursive=True, text=None,
                 limit=None, **kwargs):
# ...
# ...

findAll = find_all       # BS3
findChildren = find_all  # BS2 
```

# python - Jinja2 默认页面标题

> ID：12339324
> 
> 赞同：4
> 
> 时间：2012-09-09T13:08:11.120
> 
> 标签：python, templates, flask, jinja2

我正在尝试为 Flask 应用程序中的所有页面设置默认页面标题。

我想将其插入到默认布局模板中。我的设置中有一个站点名称。

```
<title>{{title}}</title}} 
```

问题是，我似乎无法将站点名称从设置导入到布局模板。

```
<title>{{settings.SETTING}}</title}} 
```

和类似的变化不起作用。

是否有捷径可寻; 我不想在我的控制器中为每个动作设置标题，合乎逻辑的方法是从我的设置转到模板。我只是现在没有办法，任何意见表示赞赏。

编辑：

我不想编写扩展程序，我看到我的应用程序的另一部分正在使用扩展程序将变量拉入模板，但是编写整个扩展程序有点超出我当时的时间投入。

编辑：

```
def page_title(title):
    return settings.SITE_NAME

app.jinja_env.filters['page_title'] = page_title 
```

在模板中：

```
{{ title | page_title}} 
```

这很接近，我想设置标题或使用默认值覆盖，这是可行的第一步

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-09T13:19:53.663

使用块：

```
<title>{% block title %}{{ settings.SETTING }}{% endblock %}</title> 
```

然后，如果要更改标题，您可以简单地覆盖从基本模板继承的模板中的该块。

```
{% block title %}your custom title{% endblock %} 
```

# php - 如何在没有ajax的情况下将javascript动态数据发送到php变量

> ID：12339325
> 
> 赞同：1
> 
> 时间：2012-09-09T13:08:12.647
> 
> 标签：php, javascript

我有一个表格，带有 3 种输入类型的文本。

```
<input type="text" id="one" onkeyup="multiply()" name="one">
<input type="text" id="two" name="two">
<input type="text" id="three" name="three">

<script>
function multiply(){
    one = document.getElementById('one').value;
    two = document.getElementById('two').value;
    document.getElementById('three').value = one * two
}
</script> 
```

现在我在三个中没有价值，但它是一个动态的，当我提交论坛到（forumSubmit.php）然后我得到错误

```
undefiend index three 
```

我搜索并发现这可以用 ajax 完成，但我不想使用 ajax，我想刷新页面

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:17:09.607

你可以这样做：

**标记**

```
<!-- Use onkeyup on both inputs -->
<input type="text" id="one" onkeyup="multiply()" name="one">
<input type="text" id="two" onkeyup="multiply()" name="two">
<input type="text" id="three" name="three">
​ 
```

**JavaScript**

```
function multiply() {
   // Parse the values, and count it as 0 if the input is not a number
   // I also made the variables private to this function using the var keyword
   // There is no need to have them in the global namespace
   var one = parseInt(document.getElementById('one').value, 10) || 0;  
   var two = parseInt(document.getElementById('two').value, 10) || 0;
   document.getElementById('three').value= one * two;
}​ 
```

**工作示例**

整理一个demo：http: [//jsfiddle.net/DjQNx/](http://jsfiddle.net/DjQNx/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:16:57.590

```
<input type="text" id="one" onkeyup="multiply()" name="one" />
<input type="text" id="two" onkeyup="multiply()" name="two" />
<input type="text" id="three" name="three" />

<script type="text/javascript">
function multiply() {
    one = document.getElementById('one').value;
    two = document.getElementById('two').value;
    document.getElementById('three').value = one * two;
}
</script> 
```

# imagemagick - 定义 ImageMagick 转换的文件顺序

> ID：12339330
> 
> 赞同：13
> 
> 时间：2012-09-09T13:09:18.323
> 
> 标签：imagemagick, imagemagick-convert

我有一堆`PNG`名为`foo<bar>.png`我希望转换为 TIF 动画的文件。`<bar>`是一个数字，从 0 到 25 以 5 为单位变化。ImageMagick`foo5.png`在动画中排在最后，而它应该排在第二位。除了将文件重命名为`foo05.png`将其放置在正确的位置之外，还有其他方法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-09T20:12:59.667

如果您的输入图像多于输入的方便程度（例如 foo0..foo100.png），您可以这样做（在 Linux、Unix 和 Mac OS X 上）：

```
convert                                                  \
  -delay 10                                              \
   $(for i in $(seq 0 5 100); do echo foo${i}.png; done) \
  -loop 0                                                \
   animated.gif 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2019-01-11T00:25:59.487

简单易行，列出您的图像并对其进行排序：

```
convert -delay 10 -loop 0 $(ls -1 *.png | sort -V) animated.gif 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-09T15:10:53.710

您只需按照它们应该出现在动画中的顺序给出 PNG 文件的顺序。利用：

```
foo0.png foo5.png foo10.png foo15.png foo20.png foo25.png 
```

代替

```
foo*.png 
```

毕竟，只有 6 个不同的文件名应该很容易输入：

```
convert                                                      \
  -delay 10                                                  \
   foo0.png foo5.png foo10.png foo15.png foo20.png foo25.png \
  -loop 0                                                    \
   animated.gif 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-17T19:02:49.583

您可以将“查找”与“排序”一起使用：

```
convert -delay 10 $(find . -name "*.png" -print0 | sort -zV | xargs -r0 echo) -loop 0 animated.gif 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-22T16:01:09.427

比 ls 和 sort 更简单的是使用 ls 的内置 -v 选项：

`convert -delay 10 -loop 0 `ls -v *.png` animated.gif`

被``...``执行而不是解释为字符串。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-23T16:53:02.213

或者，如果您了解一点 python，那么您可以轻松地从 python shell 中利用它的帮助。

`python`通过在终端中输入来打开 python shell 。并应用以下魔法 -

```
# Suppose your files are like 1.jpeg, 2.jpeg etc. upto 100.jpeg
files = []
for i in range(1, 101):
    files.append('{}.jpeg'.format(i))
command = 'convert -delay 10 {} -loop 0 animated.gif'.format(' '.join(files))
from subprocess import call
call(command, shell=True) 
```

你的工作应该完成！

# macos - mac安装mongodb

> ID：12339334
> 
> 赞同：2
> 
> 时间：2012-09-09T13:09:42.283
> 
> 标签：macos, mongodb

我正在尝试在我的系统上安装 mongodb 并按照以下步骤（[http://docs.mongodb.org/manual/tutorial/install-mongodb-on-os-x/](http://docs.mongodb.org/manual/tutorial/install-mongodb-on-os-x/)）这样做。我已经安装了 Homebrew 和 MacPorts，并使用 Homebrew 和 MacPorts 安装了 mongodb。但是当我输入 mongod 时：

我明白了：

```
mongod --help for help and startup options
Sun Sep  9 20:58:35 [initandlisten] MongoDB starting : pid=6381 port=27017 dbpath=/data/db/ 64-bit host=Cs-MacBook-Pro.local
Sun Sep  9 20:58:35 [initandlisten] db version v2.0.7, pdfile version 4.5
Sun Sep  9 20:58:35 [initandlisten] git version: nogitversion
Sun Sep  9 20:58:35 [initandlisten] build info: Darwin Cs-MacBook-Pro.local 11.4.0 Darwin Kernel Version 11.4.0: Mon Apr  9 19:32:15 PDT 2012; root:xnu-1699.26.8~1/RELEASE_X86_64 x86_64 BOOST_LIB_VERSION=1_49
Sun Sep  9 20:58:35 [initandlisten] options: {}
Sun Sep  9 20:58:35 [initandlisten] exception in initAndListen: 10296 dbpath (/data/db/) does not exist, terminating
Sun Sep  9 20:58:35 dbexit: 
Sun Sep  9 20:58:35 [initandlisten] shutdown: going to close listening sockets...
Sun Sep  9 20:58:35 [initandlisten] shutdown: going to flush diaglog...
Sun Sep  9 20:58:35 [initandlisten] shutdown: going to close sockets...
Sun Sep  9 20:58:35 [initandlisten] shutdown: waiting for fs preallocator...
Sun Sep  9 20:58:35 [initandlisten] shutdown: lock for final commit...
Sun Sep  9 20:58:35 [initandlisten] shutdown: final commit...
Sun Sep  9 20:58:35 [initandlisten] shutdown: closing all files...
Sun Sep  9 20:58:35 [initandlisten] closeAllFiles() finished
Sun Sep  9 20:58:35 dbexit: really exiting now 
```

当我输入 mongo 时，我得到了这个：

```
MongoDB shell version: 2.0.7
connecting to: test
Sun Sep  9 20:58:39 Error: couldn't connect to server 127.0.0.1 shell/mongo.js:84
exception: connect failed 
```

在这方面需要一些帮助...

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-09T13:11:16.303

`/data/db/`在 中创建一个文件夹`/`。这是 MongoDB 存储其所有数据的地方。然后确保它可以被 MongoDB 读写使用`chown`or`⌘</kbd>`I` in the Finder.`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-25T21:46:49.953

我讨厌添加另一个答案，因为当前答案有效，但我无法评论该答案，所以..

您可以创建所需的数据目录并为其提供与您登录 OS X 的用户相同的权限，如下所示：

```
sudo mkdir -p /data/db
sudo chown `id -u` /data/db 
```

然后你可以使用启动 mongod

```
./path/to/mongod 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-01-26T10:39:25.360

其他答案没有我的数据目录（Mac OS Mavericks，Mongo（2.4.x）

Mac OS中的mongo数据目录位于

```
/usr/local/var/mongodb 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-07T05:57:50.407

上面的答案肯定足够好，但我也想在这里给一个小费。

我会做的是：

从 mongodb 站点的下载部分下载相应的二进制文件。将其解压缩到某个文件夹中，例如 /opt/mongo 然后通过在 .bashrc 文件中添加以下行来将路径添加到 $PATH 变量`PATH="$PATH:/opt/mongo/bin"`

现在您可以像任何其他命令一样从命令行启动 mongod 或 mongo 或 mongoexport 等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-04T12:34:11.813

替代方法：

如果您不喜欢默认的 /data/db 文件夹，只需使用 --dbpath 指定备用路径

```
$ mongod --dbpath /any-directory 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-28T22:20:51.167

这是帮助您在 Mac 上安装 mongodb 的步骤。

1.从服务器下载mongodb-osx-x86_64-3.2.6.tgz。

[https://www.mongodb.org/downloads#production](https://www.mongodb.org/downloads#production)

2.打开终端。

3.解压那个文件夹

$ tar xvf mongodb-osx-x86_64-3.2.6.tgz

4.转到那个文件夹

$ cd mongodb-osx-x86_64-3.2.6

5.$ 光盘箱

6.  现在进入根级别并输入密码

    $须藤重击

7.  然后创建数据文件夹

# 我是谁

根

# mkdir -p /data/db

# chmod 777 /数据/数据库

# ls -l /数据/数据库

# ls -ld /数据/数据库

drwxrwxrwx 2 根轮 68 Apr 28 15:04 /data/db

8.  然后退出那个根

# 出口

9.  所以现在你又在 bin 文件夹中了，所以执行这个命令

    $ ./mongod

因此，它将等待连接。

10.  现在您可以打开第二个新终端，转到 bin 文件夹

$ cd mongodb-osx-x86_64-3.2.6

$ 光盘箱

11.  然后尝试连接mongo

$ ./mongo

12.  它将连接您的数据库，因此您可以插入数据

> db.names.insert({'name':'piyush'})

另外，通过

> db.names.find()

[https://piyushkachariya111.wordpress.com/2016/04/28/installing-mongodb-on-a-mac/](https://piyushkachariya111.wordpress.com/2016/04/28/installing-mongodb-on-a-mac/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-05T14:13:29.013

即使我在运行 mongodb 服务器时也遇到了同样的问题。

进程 1：`activity monitor`为 mongodb 实例运行并查找并终止进程并再次运行命令。

或者

过程 2：找到 \data\db\`data-directory\mongod.lock`文件，将其删除并运行命令

```
mongod --repair 
```

之后，您将看到带有以下消息的信息日志

```
shutdown: removing fs lock... 
```

现在运行`mongodb`命令。

希望这会有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-05-24T07:45:22.610

这是在 MAC 中安装 MongoDB 的手动方法

1.下载mongodb“mongodb-osx-ssl-x86_64-3.6.5.tgz”文件

2.使用命令解压

```
$ tar -zxvf mongodb-osx-ssl-x86_64-3.6.5.tgz 
```

3.创建一个目录并将提取的内容复制到该目录

```
$ mkdir mongodb
$ cp -R -n mongodb-osx-ssl-x86_64-3.6.5.tgz/ mongodb 
```

4.在主目录中创建一个名为.bash_profile的文件，并将bin路径添加到相同的位置，如下所示

```
export PATH=<mongodb-install-directory>/bin:$PATH 
```

5.在任意根位置创建目录data/db，并使用chown为登录用户添加权限

```
$ sudo mkdir -p /data/db 
$ whoami
  LoggedInUser
$ sudo chown  LoggedInUser /data/db 
```

如果我们使用不同的 dbpath 而不是 /data/db（如果我们使用不同的位置，开发人员需要在每次执行时添加它）

```
mongod --dbpath <path to data directory> 
```

6.关闭并打开终端并使用mongod验证工作

```
$ mongod 
```

7.使用mongo命令连接mongo

```
$ mongo 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-04-17T07:40:36.463

您可以使用以下步骤在本地计算机上轻松安装 mongoDB：

1.  去mongoDB官网 [MongoDB下载中心](https://www.mongodb.com/download-center/community) [![在此处输入图像描述](../Images/b7be90370a1358d755390296a12bca0f.png)](https://i.stack.imgur.com/Sb4Sv.png)
2.  下载社区或企业服务器，但请确保为 mac 选择您的操作系统，它是 macOS x64
3.  下载包后，最好将其放在您选择的文件夹中按照步骤我在我的主目录中有下载的文件夹，如果你在其他地方有它，你需要相应地更改路径
4.  打开你的终端，确保它是 bash [![在此处输入图像描述](../Images/4a545f30216d0ff3ddc23f9de9924ca9.png)](https://i.stack.imgur.com/ljehA.png)
5.  在这一步中，您需要告诉您的机器在哪里可以找到您下载的 MongoDB 命令，您需要提供下载的 MongoDB 文件夹的路径，这很容易，只需在终端中运行，`sudo nano /etc/paths`路径的内容应该会显示到包含您的 MongoDB 文件夹的文件夹并右键单击此 MongoDB 文件夹并单击复制以将路径复制到此文件夹，然后转到终端并将复制的路径粘贴到路径文件中并在其末尾添加 /bin 因为 bin 将包含您将使用的所有 MongoDB shell 命令然后按 control + x 然后按 y（这意味着您正在告诉终端保存我的文件）保存更改，然后输入退出 nano。 [![在此处输入图像描述](../Images/6c94a7106cb0da722773a1718b1b2158.png)](https://i.stack.imgur.com/UmG58.png)
6.  关闭您的终端并重新打开它然后运行 ​​mongo --nodb 这应该启动您的 MongoDB shell，您将成功安装 MongoDB [![在此处输入图像描述](../Images/53921ecd66c84f4f6c6d8e83dd3d96b0.png)](https://i.stack.imgur.com/NPNA3.png)
7.  退出 MongoDB shell 写 exit 并按回车

# php - 在数据库中记录 PHP 错误

> ID：12339337
> 
> 赞同：0
> 
> 时间：2012-09-09T13:10:48.620
> 
> 标签：php, mysql

我正在管理面板中构建一个页面以显示发生的任何 php 异常。通过这种方式，它们可以对客人隐藏，但管理员仍然可以查看它们。

但我无法决定最好将它们存储在数据库中还是将它们存储到文件中？数据库肯定会更容易使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:22:25.523

就我个人而言，我会将它们存储在数据库中，以便于报告。

现在，如果错误本身正在连接到数据库，我会将其记录在一个文件中并提醒管理员（通过电子邮件），因为数据库关闭可能非常严重，需要尽快注意。

我会设计具有严重性级别的日志记录系统。低严重级别记录到数据库，严重记录到数据库、文件以及通过电子邮件发送给管理员

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:14:52.500

我个人会将它们写入文件。

在我看来，数据库服务器比系统上的文件处理程序更有可能失败并且不会将异常写入表中。

当然，如果您要记录多个错误类别，并且有时希望一次只显示一个类别，那么请使用数据库。它当然可以使处理更容易一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T13:20:20.660

我强烈建议您将其存储在文件中。只需确保无法通过 HTTP 访问文件（例如：[http://your.host/admin/ERRORS.txt](http://your.host/admin/ERRORS.txt)）。将其放置在具有“全部拒绝”的 .htaccess 文件的文件夹中，这样文件就不会通过 HTTP 加载。

然后，通过让 PHP 访问文件并输出它，让您的管理员可以选择查看这些错误文件。

为了帮助您的管理员缩小他们想要查看的错误文件的范围，请每天以不同的文件名记录错误。例如：ERRORS-12-09-09.TXT（2012 年 9 月 9 日）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-09T13:15:03.520

为什么要努力将它们存储在数据库中？用这种努力来修复它们。

使用文件。该文件的大小应该减小（因为您将修复这些错误？）。

# ruby-on-rails - Rail ajax 远程表单在提交时更新文本字段

> ID：12339338
> 
> 赞同：1
> 
> 时间：2012-09-09T13:10:52.077
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3

我要做的就是在提交 Rails 远程表单时使用值更新页面上的文本字段。

所有源代码都可以在 github 上找到[https://github.com/iamliamnorton/fasdac](https://github.com/iamliamnorton/fasdac)

表格在索引页上...

控制器代码...

```
def index

  @calculator = Calculator.new(params[:calculator])
  if @calculator.valid?
    respond_to do |format|
      format.html { redirect_to calculator_path(:calculator => params[:calculator]), :notice => 'Calculation was successfully completed.' }
      format.js
    end
  else
    respond_to do |format|
      format.html { redirect_to calculator_path(:calculator => params[:calculator]), :alert => "Calculation was not successfully completed. #{@calculator.errors.full_messages.to_sentence}" }
      format.js
    end
  end 
```

我的输入表单

```
<%= form_for(@calculator, :url => calculator_path, :remote => true) do |f| %>
...
<% end %> 
```

还有 index.js.erb

```
$("#result").value = "SUCCESS!"; 
```

我正在尝试使用名称和 id 'result' 更新输入文本字段。我无法使其正常工作，我在 index.js.erb 中尝试了许多不同的变体，但无法使其正常工作。我究竟做错了什么？

正如我在服务器控制台中看到的那样，看起来数据正在发送到控制器

```
...
Processing by CalculatorController#index as JS
... 
```

但我无法让文本区域更新

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:49:25.180

**index.js.erb**

```
$('#result').val("Success!"); 
```

# ruby-on-rails - 如何为 accept_nested_attributes_for 添加自己的验证消息？

> ID：12339339
> 
> 赞同：1
> 
> 时间：2012-09-09T13:10:53.983
> 
> 标签：ruby-on-rails, validation, nested-attributes

我有这两个模型：

**用户**

```
has_one :additional_data, :dependent => :destroy
accepts_nested_attributes_for :additional_data 
```

**附加数据**

```
belongs_to :user
validates :skype, :presence => {:message => 'cannot be blank.'} 
```

和形式：

```
<%= form_for@user do |f| %>
  <p>
    <%= f.label :email %><br />
    <%= f.text_field :email %>
  </p>
  <%= f.fields_for :additional_data do |ad| %>
        <p>
          <%= ad.label :skype, "Skype" %><br />
          <%= ad.text_field :skype %>
        </p>
  <% end %>
<% end %> 
```

如果我发送空表单，则不会显示有关丢失 Skype 数据的消息。我错过了什么？

另外，我想问一下，我是否可以根据 URL 中变量中的值验证`additional_data`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:48:12.683

查看[validates_associated](http://api.rubyonrails.org/classes/ActiveRecord/Validations/ClassMethods.html#method-i-validates_associated)。它验证关联的一个或多个对象本身是否都是有效的。

```
# user.rb
has_one :additional_data, :dependent => :destroy

validates_associated :additional_data

accepts_nested_attributes_for :additional_data 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T13:16:20.213

默认情况下，Rails 不会显示内联错误。

您可以使用我推荐的[简单表单](https://github.com/plataformatec/simple_form)之类的插件，也可以通过迭代在表单开头显示错误`@user.errors.full_messages`。

# android - 如何找到我的 Google+ OAuth 密钥？

> ID：12339341
> 
> 赞同：1
> 
> 时间：2012-09-09T13:11:07.167
> 
> 标签：android, oauth

根据本[教程](http://code.google.com/p/google-apps-manager/wiki/GettingAnOAuthConsoleKey)，密钥位于消费者 ID 下方，但我的控制台中只有消费者 ID。

如果我将 clientSecret 字段留空，则会 `GoogleAuthorizationCodeGrant(HttpTransport transport, JsonFactory jsonFactory, String clientId, String clientSecret, String code, String redirectUri)` 收到 400 bad request 错误

我在哪里可以找到密钥？

这是我的控制台的样子： ![在此处输入图像描述](../Images/5a4d6ffeeaa0d8564f17d88efcf4e4c4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:18:47.623

为什么不使用带有简单 API 访问密钥的[Android 的 AccountManager ？](https://developers.google.com/google-apps/tasks/oauth-and-tasks-on-android)

如果您想像示例中那样以手动方式执行此操作，只需为已安装的*Other*类型的应用程序生成客户端凭据。

将来，将会有[Google 的 Play 服务](https://developers.google.com/android/google-play-services/)，它将提供一种更安全的方式来使用应用程序的签名来访问 Google 的 API，并且不需要客户端机密。

# android - Android布局：一个在左边，一个在右边，一个在中间？

> ID：12339342
> 
> 赞同：-1
> 
> 时间：2012-09-09T13:11:14.337
> 
> 标签：android, layout, center

我需要这样的布局：

![在此处输入图像描述](../Images/58b4eba8395bfbfc808b4bcf46392f4d.png)

button1 在左边，button3 在右边，button2 在中间。并且它们都在垂直方向的中间。

如何实施？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T13:14:28.020

使用`RelativeLayout`.

按钮 #1 有

*   `android:layout_alignParentLeft="true"`
*   `android:layout_centerVertical="true"`.

按钮#2：有

*   `android:layout_centerInParent="true"`.

按钮 #3 有

*   `android:layout_alignParentRight="true"`
*   `android:layout_centerVertical="true"`.

# javascript - 仅从 DIV 中删除图像而不是整个站点

> ID：12339352
> 
> 赞同：0
> 
> 时间：2012-09-09T13:12:26.367
> 
> 标签：javascript, image, hide

我只想从内容 div 中删除图像，而不是整个站点。我尝试了以下方法：

```
var elements = document.getElementsByTagName('img');
    for (var i = 0; i < elements.length; i++) {
        elements[i].style.display = 'none';
    } 
```

这会删除每个图像。

```
var elements = document.getElementsById('content').document.getElementsByTagName('img');
    for (var i = 0; i < elements.length; i++) {
        elements[i].style.display = 'none';
    } 
```

那什么也没做。

有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T13:14:34.617

```
var elements = document.getElementsById('content').document.getElementsByTagName('img'); 
```

应该

```
var elements = document.getElementsById('content').getElementsByTagName('img'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T13:16:28.387

```
var elements = document.getElementsById('content').getElementsByTagName('img');
for (var i = 0; i < elements.length; i++) {
    elements[i].style.display = 'none';
} 
```

如果使用 jQuery

```
$('#content img').hide(); 
```

# javascript - 如何从客户端的数组中获取用户输入和返回值？

> ID：12339354
> 
> 赞同：2
> 
> 时间：2012-09-09T13:12:50.077
> 
> 标签：javascript, html, forms

刚开始涉足网络开发领域……所以我希望你能在这里帮助我……

我有一个非常简单的网页，上面有一个表单输入。我想要一个脚本，它将接受用户输入并根据数组上的 a 值生成响应。

会是这样的……

用户输入单词>>单击链接>>脚本获取姓氏的第一个字母>>脚本在与字母相关的数组中输出值。

这可能吗？我知道你可以用 onClick 做一些事情来进行交互，但我不知道从哪里开始。

任何帮助/建议都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:35:39.170

​顺便说一句，你还没有提到你的数组的内容

```
<input type="text" id="lastname" />
<input type="button" value="find In Array" onclick="findInArray()" />​

<script>    
var letters = new Array();
letters['m'] = 'meow';
letters['z'] = 'zoom';
letters['k'] = 'kiosk';

function findInArray()
{
    var inp = document.getElementById('lastname').value; //get textbox value
    var firstLetter = inp[0];  //get first character
    alert(letters[firstLetter]);  //display array content where key = firstletter
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T13:36:22.220

有几个不同的组件进入这样的功能。它们分为 HTML 和 Javascript。首先，我们需要一个文本输入框和一个“提交”按钮。然后我们需要某种方式来显示返回的值，这是基于用户的输入。

然后，对于 Javascript，我们需要一种方法来检测用户何时按下提交。然后我们需要检索他的输入，并从对应于该输入的数组中获取值。一些后备也很好。

所以，让我们从**HTML**开始：

```
<input type="text" id="nameField" placeholder="Please enter your name..."> </input> <br>
<button id="submitName" >Submit</button>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

非常简单的东西，我们只是设置输入和提交按钮。但是我们还需要一种显示数组返回值的方法，所以我们将添加一个`<p>`(paragraph) 元素，以便我们可以将其设置为稍后显示我们的文本：

```
<p id="valueDisplay"> </p> 
```

现在对于**Javascript**：

```
var arrayOfValues = {
    a: "1",
    b: "2",
    c: "3",
    d: "4",
    e: "5",
    f: "6",
    g: "7",
    h: "8",
    i: "9",
    j: "10",
    k: "11",
    l: "12",
    m: "13",
    n: "14",
    o: "15",
    p: "16",
    q: "17",
    r: "18",
    s: "19",
    t: "20",
    u: "21",
    v: "22",
    w: "23",
    x: "24",
    y: "25",
    z: "26"
};

$(document).ready(function() {
    // first we attach an onClick handler for the submit button
    $("#submitName").click(function() {
        // now we need to get the value from our textbox
        var name = $("#nameField").val();

        // check if the name's length is 0\. If it is, we can't do anything with it.
        if (name.length === 0) {
            alert("Please enter a name.");

            // cancel the function completely:
            return;
        }

        // set the name to lower case
        name = name.toLowerCase();

        // split the name into two words, so that we can do stuff with the first name
        name = name.split(" ");

        // create an empty string to hold our return value
        var returnValue = "";

        // here we're going to iterate through the letters of the first name
        for (var i = 0; i < name[0].length; i++) {
            // name[0] refers to the first part of the name
            var curLetter = name[0].charAt(i);
            returnValue += arrayOfValues[curLetter];
        }

        // display the new returnValue in our <p> element:
        $("#valueDisplay").html(returnValue);
    });
});​ 
```

上面的 Javascript 有点长，但在评论中有解释（我希望很清楚）。你可以在[这里](http://jsfiddle.net/3Qf37/4/)找到它的工作版本。当然，图中的数字`arrayOfValues`只是一个例子。你可以用你想要的任何值来替换它们——只要确保它们不是数字的话，就用引号*引起*来。`arrayOfValues`顺便说一句，它不是一个数组：它是一个用作关联数组的[对象。](http://www.quirksmode.org/js/associative.html)

最后，我使用流行的 Javascript 库[jQuery](http://jquery.com/)使上述脚本中的事情变得更简单一些。你的功能可以在没有 jQuery 的情况下创建，但它确实使事情变得简单得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T13:26:28.760

你可以使用js对象< [http://www.w3schools.com/js/js_objects.asp](http://www.w3schools.com/js/js_objects.asp) >

创建一个对象，其中包含一个数组，其中包含您要输出的值

```
var arrayOfValus = new Array('go','eat','drink','write','read');
function onSubmit(){
   //1- get the submited values
   //2- split or change to array of char to get first letter
   //3- use .match(submited value) to get the first matching value from the array
   //4- do what you want with find word print or alert
} 
```

希望能帮到你，祝好。

# android - 在 Android 上下载 YouTube

> ID：12339356
> 
> 赞同：0
> 
> 时间：2012-09-09T13:13:07.310
> 
> 标签：android, youtube

阅读此内容后：[从 Java、Android 上的 Youtube 下载视频的代码](https://stackoverflow.com/questions/7203047/code-for-download-video-from-youtube-on-java-android)

我找到了一种获取与此类似的 youtube 下载链接的方法： http: [//oo---preferred---lax02s10---v9---lscache4.c.youtube.com/videoplayback ?upn=7XKwMrZklvQ&sparams= cp%2Cid%2Cip%2Cipbits%2Citag%2Cratebypass%2Csource%2Cupn%2Cexpire&fexp=903903%](http://o-o---preferred---lax02s10---v9---lscache4.c.youtube.com/videoplayback?upn=7XKwMrZklvQ&sparams=cp%2Cid%2Cip%2Cipbits%2Citag%2Cratebypass%2Csource%2Cupn%2Cexpire&fexp=903903%)

我尝试使用下载视频

```
 public void DownloadFromUrl(String DownloadUrl, String fileName) {
    Log.i("DownloadFromUrl","DownloadFromUrl"+DownloadUrl);

       try {
               File root = android.os.Environment.getExternalStorageDirectory();               

               File dir = new File (root.getAbsolutePath() + "/youlike");
               if(dir.exists()==false) {
                    dir.mkdirs();
               }

               URL url = new URL(DownloadUrl); //you can write here any link
               File file = new File(dir, fileName);

               long startTime = System.currentTimeMillis();
               Log.d("DownloadManager", "download begining");
               Log.d("DownloadManager", "download url:" + url);
               Log.d("DownloadManager", "downloaded file name:" + fileName);

               /* Open a connection to that URL. */
               URLConnection ucon = url.openConnection();
               Log.i("URLConnection","URLConnection Succeed");

               /*
                * Define InputStreams to read from the URLConnection.
                */ 
               InputStream is = ucon.getInputStream();
               BufferedInputStream bis = new BufferedInputStream(is);
               Log.i("BufferedInputStream","BufferedInputStream Succeed");

               /*
                * Read bytes to the Buffer until there is nothing more to read(-1).
                */
               ByteArrayBuffer baf = new ByteArrayBuffer(5000);
               int current = 0;
               while ((current = bis.read()) != -1) {
                  baf.append((byte) current);
                  Log.i("ByteArrayBuffer","ByteArrayBuffer Succeed");

               }

               /* Convert the Bytes read to a String. */
               FileOutputStream fos = new FileOutputStream(file);
               Log.i("FileOutputStream","FileOutputStream initialized");
               fos.write(baf.toByteArray());
               Log.i("fos.write(baf.toByteArray());","fos.write(baf.toByteArray()); initialized");
               fos.flush();
               fos.close();
               Log.d("DownloadManager", "download ready in" + ((System.currentTimeMillis() - startTime) / 1000) + " sec");

       } catch (IOException e) {
           Log.d("DownloadManager", "Error: " + e);
       }

    } 
```

但它向我返回了一条错误消息：java.io.FileNotFoundException 我测试了 url，我确信它可以工作。谁能告诉我问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T02:13:01.703

您是否应该在打开 http 连接之前对您的 youtube 下载链接进行编码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:22:35.437

难道是你没有设置外部存储的写权限？[文件 mkdirs() 方法在 android/java 中不起作用](https://stackoverflow.com/questions/4543559/file-mkdirs-method-not-working-in-android-java)

# sql - 将字符串比较 where 子句添加到内部连接会对 SQLite 造成巨大的性能影响

> ID：12339362
> 
> 赞同：3
> 
> 时间：2012-09-09T13:14:15.277
> 
> 标签：sql, database, sqlite

我正在玩费城的交通数据，我有一个存储 gtfs 数据的 sqlite 数据库。我有这个查询寻找特定站点的出发时间：

```
SELECT "stop_time".departure_time FROM "stop_time"
 INNER JOIN "trip" ON "trip".trip_id = "stop_time".trip_id 

 WHERE 

 (trip.route_id = '10726' ) 
 -- AND (trip.service_id = '1') 
 AND (stop_time.stop_id = '220') 
 AND (time( stop_time.departure_time ) > time('08:30:45')) 
 AND (time( stop_time.departure_time ) < time('09:30:45')); 
```

将 service_id 与 1 匹配的子句当前已被注释掉。如果我现在按原样运行查询，而不匹配 service_id，则需要 2 秒。如果我取消注释 service_id 子句，则需要 30。我不知道为什么，因为我已经在查看 route_id 的行程表。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:20:08.517

如果在 service_id 上没有过滤器时使用的（route_id、stop_id 和离开时间）上定义了索引，通常会发生这种情况。一旦将其包含在`WHERE`子句中，由于它不存在于索引中，因此它需要 a `TABLE SCAN`，因此需要在执行时间中增加。如果您还包括`service_id`在索引定义中，则将`TABLE SCAN`替换为`INDEX SCAN`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:36:09.567

原因是您`service_id`选择了一个索引而不是另一个索引，*并且*没有很多不同的值`service_id`，因此使用索引并不是很有用，因为`service_id = '1'`.

# text-mining - 不常用词的相互信息

> ID：12339368
> 
> 赞同：2
> 
> 时间：2012-09-09T13:15:10.093
> 
> 标签：text-mining, information-theory

在使用大约 3000 字的大文档计算两个词之间的 MI 时，当我计算文档中第一个词重复次数不多的概率时，第二个词的概率很低，并且相同；这个低值会影响联合概率 =`p(x) * P(y)`导致互信息的值为零或 NaN。我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-09T16:44:24.590

你最好的选择可能是使用负对数概率——这将帮助你避免下溢。记住，`p(x) * p(y)`是一样的`-log(p(x)) + -log(p(y))`。有关更多信息，[请咨询您友好的社区 Wikipedia](https://en.wikipedia.org/wiki/Log_probability)。

# c++ - 引用 getters 与 getters by copy 的两个不同词

> ID：12339381
> 
> 赞同：-1
> 
> 时间：2012-09-09T13:17:14.953
> 
> 标签：c++, documentation, word, getter

考虑以下示例：

```
class MyClass
{
    // Getters by copy ?
    public:
        inline std::string fullName() const {return _firstName+_lastName;}

    // Getters by reference ?
    public:
        inline const std::string& firstName() const {return _firstName;}
        inline const std::string& lastName() const {return _lastName;}

    // Data members
    protected:
        std::string _firstName;
        std:::string _lastName;
} 
```

在我的代码文档中，我想通过引用区分 getter（直接访问类数据成员）和通过复制获取 getter（访问在类数据成员上构造的数据）。我可以用什么词来命名这两个不同的类别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:16:58.547

想到的第一个问题是为什么要区分名称中的操作。特别是因为这种分离意味着您正在向用户泄露您的实现细节并失去封装。

例如，在分析真实应用程序的过程中，您发现调用者有 90% 的时间使用`fullName()`并且不进行复制，那么您可能希望修改您的类型以*缓存*结果并避免成本：

```
class MyClass {
   // ...
   std::string _fullName;
public:
   const std::string& fullName() const {
      return _fullName;
   }
   // One of the options for caching: update on set
   // Could use other, like update on first request...
   void setName( std::string firstName ) {
      _firstName = std::move(firstName);
      _fullName = _firstName + _lastName;
   }
}; 
```

如果您的命名约定区分了这两种类型的函数，那么您要么必须在项目中寻找该函数的所有用途并替换它们以更改*实现*，否则您的函数将是*谎言*，因为命名意味着副本，但是实施没有。

话虽如此，我在过去看到过这样做，其中仅返回对成员的引用的访问器由 nember 或 命名`getMember`，而创建新对象的操作被命名为带有暗示构造的动词的句子：`composeFullName`暗示调用该操作会产生成本。我所看到的命名约定的这种变化是特定于执行*成本*很高的操作。

# php - Foreach 和 $_POST

> ID：12339386
> 
> 赞同：0
> 
> 时间：2012-09-09T13:17:58.773
> 
> 标签：php, html

我有：

```
<form action="save.php" method="POST">
<input type="text" name="test[one][]" value="a"><input type="text" name="test[two][]"  value="a"> <br />
<input type="text" name="test[one][]" value="s"><input type="text" name="test[two][]"  value="s"><br />
<input type="text" name="test[one][]"  value="d"><input type="text" name="test[two][]"  value="d"><br />
<input type="text" name="test[one][]"  value="f"><input type="text" name="test[two][]"  value="f"><br />
<input type="text" name="test[one][]"  value="g"><input type="text" name="test[two][]"  value="g"><br />

<input type="submit">
</form> 
```

在数据库中有：

```
 Table:
 id | one | two 
```

在 PHP 中我想做：

```
if($_POST){
   foreach($_POST['test'] as $post){
          $new = new Table();
          $new->setOne($post['one']);
          $new->setTwo($post['two']);
          $new->save(); 
   }
} 
```

但这不起作用......我不能将 POST 用于索引“一”和“二”——我必须使用两个循环 foreach。是否可以在 foreach 中使用一个 foreach 或 foreach？

print_r($_POST) 回复我：

```
[test] => Array ( [one] => Array ( [0] => a [1] => s [2] => d [3] => f [4] => g ) [two] => Array ( [0] => a [1] => s [2] => d [3] => f [4] => g ) ) ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:25:57.027

我会这样：

```
if (!empty($_POST)) {
  // now $_POST['test'] is array('one' => array(), 'two' => array()
  for ($i = 0, $c = count($_POST['test']['one']); $i < $c; ++$i) {
    $new = new Table();
    $new->setOne($_POST['test']['one'][$i]);
    $new->setTwo($_POST['test']['two'][$i]);
    $new->save();
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:26:07.673

```
if(is_array($_POST['test'])){ // also check that the user submitted an array
   foreach($_POST['test'] as $post){
          $new = new Table();
          foreach ($post['one'] as $item) { // $post['one'] and $post['two'] should have the same number of elements so looping through $post['one'] is sufficient to get entries for $post['two']
              $new->setOne($item);
              $new->setTwo($item);
              $new->save(); // each item is saved in the database now
          }
   }
} 
```

# php - PHP函数中的IF语句不起作用？

> ID：12339390
> 
> 赞同：-1
> 
> 时间：2012-09-09T13:18:00.733
> 
> 标签：php, function, variables, if-statement, isset

这是非常基本的，我知道 - 但我根本不明白为什么这段 PHP 代码对我不起作用？我试图在我的函数中发生一个 IF 语句，然后在我的文档的某处执行该函数，以便它返回“../”。

```
<?php $confirm = "yes"; ?>  

<?php
   function clientarea() {
      if (isset($confirm)) {
         if ($confirm == "yes") {
             echo "../";
         }
      }
   }
?>

<img src="<?php clientarea(); ?>images/logo.png" alt="Logo" /> 
```

任何想法为什么这段代码对我不起作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T13:19:18.290

这应该会更好：

```
<?php $confirm = "yes"; ?>  

<?php
   function clientarea($confirm) {
      if (isset($confirm)) {
         if ($confirm == "yes") {
             echo "../";
         }
      }
   }
?>

<img src="<?php clientarea($confirm); ?>images/logo.png" alt="Logo" /> 
```

您可以更好地使用布尔值而不是“是”或“否”......

我修改了你的代码：

```
<?php $confirm = true; ?>  

<?php
   function clientarea($confirm) {
      if ($confirm) {
             echo "../";
      }
   }
?>

<img src="<?php clientarea($confirm); ?>images/logo.png" alt="Logo" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-09T13:21:52.653

```
<?php $confirm = "yes"; ?>  

<?php
   function clientarea() {
      global $confirm; // $confirm is not accessible from here so either you declare this as global or follow one of the answers in putting $confirm as a parameter of this function
      if (isset($confirm)) {
         if ($confirm == "yes") {
             echo "../";
         }
      }
   }
?>

<img src="<?php clientarea(); ?>images/logo.png" alt="Logo" /> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-09T13:19:51.977

```
if (isset($confirm) { 
```

应该

```
if (isset($confirm)) { 
```

你错过了关闭的括号。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-09T13:20:29.120

您在 if 语句中忘记了大括号。你的代码是：

```
if (isset($confirm) { 
```

它应该是：

```
if (isset($confirm)) { 
```

休息一下。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-09T13:20:47.420

`IF`你在条件中缺少右括号

```
(isset($confirm) should be (isset($confirm)) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-09T13:31:48.393

在你的函数中使用全局

```
<?php $confirm = "yes"; ?>  

<?php
   function clientarea() {
      global $confirm; 
      if (isset($confirm)) {
         if ($confirm == "yes") {
             echo "../";
         }
      }
   }
?>

<img src="<?php clientarea(); ?>images/logo.png" alt="Logo" /> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-09T13:19:26.840

尝试这个

```
 function clientarea() {
      if (isset($confirm)) {
         if ($confirm == "yes") {
             echo "../";
         }
      }
   } 
```

缺少结束 ) 之后`isset($confirm)`

# c++ - 在免费主机上将数据保存到文件中

> ID：12339394
> 
> 赞同：0
> 
> 时间：2012-09-09T13:18:22.503
> 
> 标签：c++

我创建了一个具有“错误报告”功能的应用程序（某种“客户端”应用程序）。该功能由纯文本区域组成，文本应从该区域发送并保存到免费主机上的文本文件中。可能吗？如果是这样，哪个 c++ 库可以给我这样的能力？

编辑：

在我的意图中，它必须是用户在他自己的计算机上拥有的简单应用程序。在我的应用程序中发现一些错误后，应该有“错误报告”功能，允许他将数据（纯文本）发送到只有我可以到达的某个地方。我只是在考虑免费托管（因为它是......免费的），并将数据保存到那里的文本文件中。如果我的问题不恰当，我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:27:08.520

如果您的免费托管允许（并且您应该检查），您可以编写[CGI](http://en.wikipedia.org/wiki/Common_Gateway_Interface)程序或[fastCGI](http://en.wikipedia.org/wiki/Fastcgi)应用程序。有几个 C++ 库可能会有所帮助，例如[libcgicc](http://www.yolinux.com/TUTORIALS/LinuxTutorialC++CGI.html)等。

如果您负担得起 Web 服务器，则存在提供[HTTP](http://en.wikipedia.org/wiki/Http)服务的 C++ 库，特别是[Wt](http://www.webtoolkit.eu/wt)或（在 C 中）[Onion](https://github.com/davidmoreno/onion)等。

您还可以考虑其他技术，例如[OpaLang](http://opalang.org/)或[Ocsigen](http://ocsigen.org/)（但我不推荐 PHP，即使它被大量使用）。

也许你的主机启用`ssh`所以你可以使用`scp`....

如果您的应用程序是免费软件（例如 GPL 许可），一些免费软件托管（[freecode](http://freecode.com/)、[sourceforge](http://sourceforge.net/)、[github](http://github.com/)、[gitorious](http://gitorious.org/) ...）也可能提供错误数据库工具。

# c++ - 无法弄清楚区别-omnicppcomplete与clang

> ID：12339415
> 
> 赞同：1
> 
> 时间：2012-09-09T13:21:14.330
> 
> 标签：c++, vim, autocomplete, clang, omnicppcomplete

我正在着手设置具有更好自动完成功能的 VIM，主要用于课程。在我的谷歌研究中，我遇到了omnicppcomplete 和clang。我似乎无法弄清楚两者的优缺点。有人知道吗？

另外，在第三方系统上安装一个比另一个更容易吗？

任何反馈都会有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:34:18.970

Clang 真的“理解”c++。这意味着它可以区分名为的局部变量`foo`和名为的成员函数`foo`。如果你想完成`thisObject.fo...`，它不会给你`fooContainer`完成，而只会给你`Object::fooMethod`。

此外，Clang 可以处理 ctags 不能处理的所有 C 类型语言。

Omnicppcomlete 基于 ctags，它只是源代码树的文本索引。所以它会更密集，大部分时间会做你想做的事；有时它会不太准确。这不是一个真正的问题。

不过，我还没有安装 Clang 完成 :( 你可能必须自己构建 clang，而 ctags 很可能随你的发行版一起提供。

# php - php字符串处理

> ID：12339419
> 
> 赞同：1
> 
> 时间：2012-09-09T13:21:27.033
> 
> 标签：php

我需要`<p>`在字符串中找到标签。然后我想存储来自（包括）的字符串

标记到另一个变量中。

例如我有字符串名称 firstString;

第一个字符串 =`"<div id='tab-1'><p>This is first string</p></div>"`

我想要第二个字符串

第二个字符串 =`"<p>This is first string</p>"`

我只需要第一个`<p>`标签。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T13:28:34.963

`DOMDocument::loadHTML`. 也许不是最快的选择，但应该很简单。

```
$dom = new DOMDocument();
$dom->loadHTML($str);

$xp = new DOMXPath($dom);

$res = $xp->query('//p');

$firstParagraph = $res[0]->nodeValue; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:28:30.017

您可以使用简单的正则表达式来获取此子字符串。

```
$firstString = "<div id='tab-1'><p>This is first string</p></div>";
preg_match("#(<p>.+</p>)#", $firstString, $out);
echo $out[1]; 
```

如果您更准确地知道字符串是如何形成的，或者如果您希望提取多个子字符串，您可以使用其他方法`preg_match_all`来代替。

如果这是为了从 HTML*中*抓取一些东西，那么你应该使用像 DOMDocument 这样的专用系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T13:43:16.403

```
/* find opening tag */
$strPosBegin = strstr($firstString,"<p>");

if $strPosBegin != 0 {

    /* find position of closing tag */
    $strPosEnd = strstr($firstString,"</p>");

    /* adjust for the length of closing tag */
    $strPosEnd = $strPosEnd + 3;

    /* calculate difference, but need to add 1 */
    $strLength = $strPosEnd - $strPosBegin + 1;

     /* use substr to lift your search string out of $firstString
    $secondString = substr($firstString, $strPosBegin, $strLength);
} 
```

# web - 用新的内置赞操作替换网站上的 Facebook 赞按钮

> ID：12339420
> 
> 赞同：1
> 
> 时间：2012-09-09T13:21:36.903
> 
> 标签：web, facebook-opengraph

在我的网站上，我想跟踪（可能存储在数据库中）一个项目被 facebook 用户喜欢的次数。

我可以**使用 opengraph创建一个新的****类似操作**（内置类型）并将其**操作链接 URL**设置 为我的网站 URL，我可以在其中获取用户请求、处理然后将故事（针对对象）发布到用户的提要。我可以在我的网站上，在我使用点赞按钮的地方使用这个点赞操作功能吗？

# python - Python cvxopt 忽略约束

> ID：12339425
> 
> 赞同：1
> 
> 时间：2012-09-09T13:21:53.453
> 
> 标签：python, linear-programming

我根据以下示例使用 CVXOPT 进行线性规划：http://abel.ee.ucla.edu/cvxopt/examples/tutorial/lp.html [我](http://abel.ee.ucla.edu/cvxopt/examples/tutorial/lp.html) 很确定我表达了一个约束

```
X1 >= 0 
```

但是得到一个负值。怎么会？我收到“找到最佳解决方案”消息

```
A = matrix( [ [0.0, 0.0, 1.0, 1.0, -0.0, -0.0, -1.0, -1.0, -1.0, 0.0, 0.0], 
              [0.0, 1.0, 1.0, 0.0, -0.0, -1.0, -1.0, -0.0, 0.0, -1.0, 0.0], 
              [1.0, 0.0, 0.0, 1.0, -1.0, -0.0, -0.0, -1.0, 0.0, 0.0, -1.0]
              ]
            ) 
```

约束值（右侧）

```
b = matrix( [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0] ) 
```

最小化功能：

```
c = matrix( [-1.0, -1.0, -1.0] ) 
```

来电：

```
 sol=solvers.lp(c,A,b) 
```

但：

```
print (sol['x']): 
[-4.83e-09]
[ 1.00e+00]
[ 1.00e+00]

-4.83e-09>=0 
False 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T20:13:39.043

[根据用户指南，](http://abel.ee.ucla.edu/cvxopt/userguide/solvers.html#algorithm-parameters) *CVXOPT*中的默认可行性容差为 1.0e-7 。因此，您应该期望您的约束仅满足此精度级别。

**编辑**因此，为了确保您的“硬”约束得到满足，您需要将变量下限设置为等于您的“硬”约束（即在您的情况下为 0）*加上*可行性容差：

```
X1 >= 1.0e-7 
```

# jquery - 我可以在 jQuery 中组合两个选择器的绑定事件吗？

> ID：12339426
> 
> 赞同：0
> 
> 时间：2012-09-09T13:21:52.893
> 
> 标签：jquery

我有以下内容：

```
 $('#loginLink')
        .bind('click', accessLinkClick);
    $('#registerLink')
        .bind('click', accessLinkClick);

function accessLinkClick(e) {
    e.preventDefault();
    $('#registerLink').unbind('click', accessLinkClick);
    $('#loginLink').unbind('click', accessLinkClick);
    dialog(this);
} 
```

我是否有可能以某种方式组合 loginLink 和注册链接的选择器，所以我不需要指定它们两次。我看到了如何用函数而不是事件来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:24:14.047

是的，用逗号

```
$('#loginLink, #registerLink')
        .bind('click', accessLinkClick); 
```

供参考[阅读这里](http://api.jquery.com/multiple-selector/)

# google-app-engine - Goagent 通过短信验证用户。如何更改短信的电话号码设置？

> ID：12339431
> 
> 赞同：0
> 
> 时间：2012-09-09T13:22:34.260
> 
> 标签：google-app-engine

我刚换了手机。而且我的电话号码也变了。Goagent 通过短信验证用户。如果我不能更改为新号码，我将无法再登录外部网络。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T08:59:59.683

它不仅可以通过短信验证，还可以通过您的电子邮件进行验证。所以不用担心。

# c# - 绑定到 ObjectDataSource 的 GridView 的自定义分页，而不使用存储过程

> ID：12339433
> 
> 赞同：0
> 
> 时间：2012-09-09T13:23:07.340
> 
> 标签：c#, asp.net, sql, paging, objectdatasource

如何在不使用存储过程的情况下为绑定到 ObjectDataSource 的 GridView 实现自定义分页？

我有一个搜索屏幕，允许用户应用多个过滤器来创建自定义搜索。（几个 DropDownList 控件为每个选择了除“全部”以外的值的控件我需要在“where”子句中添加一个过滤器SQL 语句）。

我想动态构建 SQL 查询。通常我使用存储过程并使用 ROW_NUMBER() （[请参见此处](http://msdn.microsoft.com/en-us/library/bb445504.aspx)）但是如何在 c# 代码级别实现分页？

有没有办法这样做'或者是我在存储过程中实现动态 SQL 的唯一选择（[请参阅此处](http://www.codeproject.com/Articles/20815/Building-Dynamic-SQL-In-a-Stored-Procedure)）？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:32:24.277

基本上，如果您在`ListView`和 上启用分页`ObjectDataSource`，数据源会将当前页码以及页面大小传递给您的数据提供者类（您在 中配置的那个`ObjectDataSource`）。

这是一个工作示例：

[http://netpl.blogspot.com/2009/04/how-to-controll-aspnet-listview-page.html](http://netpl.blogspot.com/2009/04/how-to-controll-aspnet-listview-page.html)

具体来说，看一下数据提供者类，`PersonDataSource`.

```
public class PersonDataSource
{
    public IEnumerable<Person> Retrieve( int StartRow, int RowCount )
    {
        return DataModel.Instance.Persons.Skip( StartRow ).Take( RowCount );
    }

    public int CountItems()
    {
        return DataModel.Instance.Persons.Count;
    }
 } 
```

您可以自由实现提供程序，这意味着您可以从内存、数据库中检索您的对象，您可以使用 ORM 或创建一个`SqlCommand`. 没有限制。

我不会在应用程序级别实现分页，而是创建一个分页查询。应用程序级别的分页意味着您从数据库中检索数据并在应用程序级别进行过滤，这通常在性能方面比在数据库级别进行过滤更差。

如果您想制作自己的分页查询，那么至少有几种方法可以做到这一点，使用 ROW_NUMBER 或不使用。

# android - TableLayout边框问题Android

> ID：12339434
> 
> 赞同：0
> 
> 时间：2012-09-09T13:23:08.243
> 
> 标签：android, tablelayout, tablerow

我有一个表格，每个表格行都有一个边框。当一列中的文本进入第二行时，边框部分出现问题，而另一列中的文本没有。这会导致没有将文本包裹到第二行的行更短，并且第二行的背景为黑色。如何使该行与另一行的高度相同？

我的代码是：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="#013567" >

    <TableLayout
        android:id="@+id/tableLayout1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:shrinkColumns="*"
        android:stretchColumns="*" >

        <TableRow
            android:id="@+id/tableRow2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="#000" >

        <TextView
            android:id="@+id/textView2"
            android:layout_margin="2dip"
            android:background="#013567"
            android:gravity="center"
            android:text="long text abc 123 ong tex ong tex"
            android:textColor="#fff" >
        </TextView>

        <TextView
            android:id="@+id/textView3"
            android:layout_margin="2dip"
            android:background="#013567"
            android:gravity="center"
            android:text="short text"
            android:textColor="#fff" >
        </TextView>
    </TableRow>

    <TableRow
        android:id="@+id/tableRow2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#000" >

        <TextView
            android:id="@+id/textView2"
            android:layout_margin="2dip"
            android:background="#013567"
            android:gravity="center"
            android:text="short text"
            android:textColor="#fff" >
        </TextView>

        <TextView
            android:id="@+id/textView3"
            android:layout_margin="2dip"
            android:background="#013567"
            android:gravity="center"
            android:text="long text abc 123 ong tex ong tex"
            android:textColor="#fff" >
        </TextView>
    </TableRow>
</TableLayout>
</ScrollView> 
```

例子： ![在此处输入图像描述](../Images/45170b355dfd9a6431860358dfa0dd50.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T09:55:54.090

将以下属性添加到您的`TextView`，而不是您的`TableRow`：

`android:layout_height="match_parent"`

或者

`android:layout_height="fill_parent"`（已弃用）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:48:04.483

尝试将以下设置为您的`TableRow`：

```
android:layout_height="fill_parent" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T22:57:28.533

在“短文本”的 en 中添加新行

以编程方式：

*   `\n`

xml:

*   只需在您的 XML 代码中按 Enter

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T10:07:42.223

有几种方法可以解决这个问题，

使用 .在每个文本周围添加一个 FrameLayout `android:layout_height="match_parent"`。

或者

更改您的样式以应用于表格，例如

[如何在android中设置表格布局](https://stackoverflow.com/questions/3862136/how-to-style-a-tablelayout-in-android)

将表格背景设置为蓝色，边框设置为黑色。

# java - 谁在使用 gwt？

> ID：12339437
> 
> 赞同：-6
> 
> 时间：2012-09-09T13:23:23.850
> 
> 标签：java, gwt, web

我开始学习'gwt'。但我不知道它在软件行业的重要性。

谁能给我一些应用谷歌网络工具包的著名网站或网络应用程序？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:27:53.840

Google 肯定会使用它 :)[这是 2008 年的清单。](http://www.gwtsite.com/whos-using-gwt/) 以及[来自 google 的另一个列表](https://developers.google.com/web-toolkit/examples/)（我们还在项目中将 GWT 用于客户端组件）

# android - 从首选项打开的文件选择器意图

> ID：12339438
> 
> 赞同：7
> 
> 时间：2012-09-09T13:23:26.287
> 
> 标签：android, preference

我正在尝试了解设置 UI 构建，我在 android 文档中看到首选项可以是 Intent，但我现在想知道的是该 Intent 是否可以返回首选项值（例如通过启动文件选择的文件名选择器活动）？

或者，如果我想选择一个文件或目录名称作为我的首选项设置的一部分，我是否需要构建一个自定义首选项视图？在任何地方都有任何方便的例子吗？（似乎人们会对我做很多事情）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-09T16:57:10.313

[编辑] 首先在您的preference.xml 文件中创建一个首选项

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">

    <Preference
            android:title="Pick file"
            android:key="filePicker" 
    />
</PreferenceScreen> 
```

现在在偏好活动中执行以下操作

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    addPreferencesFromResource(R.xml.preferences);
    Preference filePicker = (Preference) findPreference("filePicker");
    filePicker.setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {
        @Override
        public boolean onPreferenceClick(Preference preference) {
            Intent intent = new Intent(......); //Intent to start openIntents File Manager
            startActivityForResult(intent, requestMode);
            return true;
        }
    });
} 
```

现在覆盖偏好活动中的 onActivityResult

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    //get the new value from Intent data
    String newValue = ....;
    SharedPreferences preferences = ......;
    SharedPreferences.Editor editor = preferences.edit();
    editor.putString("filePicker", newValue);
    editor.commit();
} 
```

# java - Java：返回对象的迭代方法

> ID：12339440
> 
> 赞同：4
> 
> 时间：2012-09-09T13:23:48.013
> 
> 标签：java, recursion, halting-problem

出于好奇，我开始编写以下方法：

```
public Object getObject() {
    return this.getObject();        
} 
```

为什么Java允许我写这个？此方法永远不会返回任何`Object`内容，并且会导致`StackOverflow Error`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T13:25:39.363

它不应该阻止你这样做——这只是无底递归，但它可能是一个普通的递归。编译器不需要去理解代码来猜测它是否正确定义了递归。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T13:28:49.430

像这样的事情总是在运行时（而不是编译时）导致错误。在许多情况下，可以完成*类似*的事情（就递归而言），这本来是完全有效的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T13:28:38.103

Java 不知道您的代码是否有意义。如果您决定要让一个方法在没有退出条件的情况下自行调用，它将递归，直到堆栈空间用完。

没有方法调用自身的能力，递归是不可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T13:27:38.160

稍微轻松一点，扩展具有此方法的类的理智开发人员可能会做一些有用的事情，因为该方法无论如何都是公共的。所以编译器不需要反对;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T14:19:29.993

**1.**我认为编译器**不会**反对您对上述代码进行许可..我认为它是如何`recursion`编写和使用的。

**2.**这里这段**代码在运行时会出问题**，`runtime`完全是程序员写的逻辑有问题，不会打扰编译器，但是运行时会报错……

**如果编译器能这么聪明......那么终结者电影就会接近现实......**

# objective-c - NSOpenPanel 不是一直打开？

> ID：12339442
> 
> 赞同：0
> 
> 时间：2012-09-09T13:24:02.800
> 
> 标签：objective-c, cocoa, nsopenpanel

好的，这是我的问题：

*   我有一个带有一个窗口的应用程序（`NSPanel`实际上是一个窗口）
*   我正在尝试打开`NSOpenPanel`并获得一些输入
*   在它打开之前，我可能需要按 2-3 次触发按钮......

**这是我的代码：**

```
- (IBAction)doExport:(id)sender 
{
    NSOpenPanel *openPanel  = [NSOpenPanel openPanel];
    [openPanel setCanChooseFiles:NO];
    [openPanel setCanChooseDirectories:YES];

    NSInteger rezult = [openPanel runModal];

    if (rezult == NSFileHandlingPanelOKButton)
    {
        NSString* dir = [[openPanel URL] path];

        // do the processing here

    }

} 
```

这是怎么回事？？？

# c# - 如何避免在按 Enter 之前将文本从自动完成列表插入到 textBox？

> ID：12339446
> 
> 赞同：0
> 
> 时间：2012-09-09T13:24:04.803
> 
> 标签：c#, winforms, autocomplete, enter

我正在编写一个在我写作时自动建议的文本框，但是当自动完成出现时，如果我按`Down`，我的 textBox1.Text 会发生变化，因此它会调用 TextChanged 函数，并且正在更新自动完成列表。

我想在我按下`Down`的同时，文本在我按下之前不会改变`Enter`。有什么办法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:29:40.533

关闭`Autocomplete`功能`textbox`

`<asp:TextBox Runat="server" ID="Textbox1" autocomplete="off"></asp:TextBox>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:37:37.853

除了实现您自己的自动完成功能（例如通过覆盖`OnTextChanged`和显示列表）之外，控制 WinForms 上自动完成功能的唯一选项`TextBox`由[AutoCompleteMode](http://msdn.microsoft.com/en-us/library/system.windows.forms.autocompletemode.aspx)属性和[同名枚举提供](http://msdn.microsoft.com/en-us/library/system.windows.forms.autocompletemode)。有关相关问题，请参阅[C# AutoComplete](https://stackoverflow.com/questions/796195/c-sharp-autocomplete)。

第三方文本框可能有更多选项，但我不知道有任何选项。

# silverlight - 如何使用 webClient.OpenReadCompleted 事件处理程序？

> ID：12339448
> 
> 赞同：0
> 
> 时间：2012-09-09T13:24:31.587
> 
> 标签：silverlight, silverlight-4.0

我正在使用以下代码，效果很好

```
private void somethingButton_Click(object sender, System.Windows.RoutedEventArgs e)
{
WebClient webClient = new WebClient();
webClient.OpenReadCompleted += webClient_OpenReadCompleted;
webClient.OpenReadAsync(new Uri(myUri));
}

void webClient_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
{
if(e.Error != null)
{
messageTextBlock.Text = e.Error.Message;
return;
}
using (Stream s=e.Result)
            {
                XDocument document = XDocument.Load(s);

                var q1 = from c in document.Descendants("result")
                        select new IndeedResult
                                {
                                    Title =((string)c.Element("title")).Trim(),
                                    ResultUri = ((string)c.Element("url")).Trim(),
                                    Date = ((string)c.Element("date")).Trim(),
                                };
myDataGrid.ItemsSource = q1;
} 
```

但我想添加另一个`WebClient`，`webClient2`它会做完全一样的但有不同的uri和不同的结构，所以我会有`webClient2_OpenReadCompleted`......

问题是最后我需要合并（或在合并之前做一些逻辑）`var q1`from `webClient_OpenReadCompleted`and `var q2`from `webClient2_OpenReadCompleted`and then

```
var mergedQs = q1.Union(q2).ToList();
myDataGrid.ItemsSource = mergedQs 
```

有没有简单的方法可以做到这一点？我不知道如何使用这些事件处理程序来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T17:15:24.570

好问题！是不是这样

```
 void webClient_OpenReadCompleted( object sender, OpenReadCompletedEventArgs e )
    {
        Stream stream = (Stream)e.Result;
        BinaryReader reader = new BinaryReader( stream );

        byte[] buffer = reader.ReadBytes( (int)stream.Length );
        Uri uri = (Uri)e.UserState;

        streams.Add( uri.AbsoluteUri, new MemoryStream( buffer ) );
    } 
```

请注意 UserState 的用法，以便在我的流字典中提供一个 unqiue 键。完美运行 :-) 这样您就可以处理任意数量的文件/图像/二进制数据！

看看这个看看它有多强大...... http://www.alansimes.com/warp3dsilverlighttestpage.html

# odbc - 如何访问 Tomcat 5.5 中的数据库？

> ID：12339454
> 
> 赞同：1
> 
> 时间：2012-09-09T13:25:05.860
> 
> 标签：odbc, tomcat5.5, jdbc-odbc

我目前正在接手一个 5 年前完成的 Web 开发项目。基本上，我被告知远程登录到运行 Windows Server 2003 的 Web 服务器并继续进行 Web 开发。

但是，我想访问后端数据库以执行 SQL 查询并查看我网站中的所有表。

我设法找到位于 C:\Program Files\Apache Foundation\Tomcat5.5\webapps\root 的 .html、.jsp 页面。我还设法获得了可能有帮助的代码片段。

--

```
<%@page language="java" import="java.sql.*" %>
<%@page import="javax.servlet.*"%>

<%
String sDBDriver="sun.jdbc.odbc.JdbcOdbcDriver";
String sConnStr="jdbc:odbc:tutoring";
Connection conn=null;
ResultSet rs=null;
String username="username";
String password="heyicanttelluthepassword";

conn=DriverManager.getConnection(sConnStr,username,password);
Statement stmt=conn.createStatement();
%> 
```

--

知道我怎么能访问数据库吗？我什至不知道它使用的是MS SQL服务器还是MYSQL ..哈哈..

# android - 在网络信息的情况下获取详细的网络状态，即细粒度状态/详细状态

> ID：12339456
> 
> 赞同：2
> 
> 时间：2012-09-09T13:25:14.637
> 
> 标签：android

我想访问详细状态。

```
ConnectivityManager cm = (ConnectivityManager) arg0.getSystemService(Context.CONNECTIVITY_SERVICE);

NetworkInfo mi = cm.getNetworkInfo(ConnectivityManager.TYPE_MOBILE);
NetworkInfo.DetailedState d11 = mi.getDetailedState(); 
```

但我总是只得到粗粒[度状态](http://developer.android.com/reference/android/net/NetworkInfo.State.html)

我想知道的是如何访问详细状态

# android - Android 如何重绘自定义视图

> ID：12339459
> 
> 赞同：-1
> 
> 时间：2012-09-09T13:25:53.170
> 
> 标签：android, android-layout, view, invalidation

我知道这个问题已经被问过其他时间了，但我无法解决我的问题！

我创建自己的视图（RadarView），扩展视图。但是id没有更新！我尝试使用“invalidate()”和“postInvalidate()”，但它们不起作用！

这是雷达视图的代码：

`公共类雷达视图扩展视图{

```
 private HashMap<Integer, RadarData> allNodes;
    private int myId;
    private double distance=0.0; //in degree
    private double meeterDistance =0.0; // in meeters
    private Paint paint,node,nodeText;

    public RadarView(Context context, HashMap<Integer,RadarData> allNodes, int myId){
        super(context);
        this.allNodes = allNodes;
        this.myId=myId;
        paint = new Paint();
        paint.setStyle(Paint.Style.STROKE);
        paint.setAntiAlias(true);           
        paint.setColor(Color.GREEN);

        node = new Paint();
        node.setStyle(Paint.Style.FILL);
        node.setAntiAlias(true);            
        node.setColor(Color.GREEN);

        nodeText = new Paint();
        nodeText.setStyle(Paint.Style.STROKE);
        nodeText.setAntiAlias(true);            
        nodeText.setColor(Color.BLACK);
    }

    @Override protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);       

        //here we draw the radar
        canvas.drawCircle(canvas.getWidth()/2, canvas.getHeight()/2, canvas.getWidth()/8, paint);
        canvas.drawCircle(canvas.getWidth()/2, canvas.getHeight()/2, canvas.getWidth()/4, paint);
        canvas.drawCircle(canvas.getWidth()/2, canvas.getHeight()/2, canvas.getWidth()/2.7f, paint);
        canvas.drawCircle(canvas.getWidth()/2, canvas.getHeight()/2, canvas.getWidth()/2, paint);
        canvas.drawLine(canvas.getWidth()/2, 0, canvas.getWidth()/2, canvas.getHeight(), paint);
        canvas.drawLine(0, canvas.getHeight()/2, canvas.getWidth(), canvas.getHeight()/2, paint);
        canvas.drawLine(canvas.getWidth() - canvas.getWidth()/4, canvas.getHeight()/10, canvas.getWidth() - canvas.getWidth()/4 +canvas.getWidth()/8, canvas.getHeight()/10, paint);

        //then we add nodes in the view, if at least one exist
        if(allNodes!=null){
            RadarData me = allNodes.get(myId);
            RadarData moreDistant = me;
            Set<Integer> set = allNodes.keySet();
            set.remove(myId);
            for (Integer key : set){
                RadarData element = allNodes.get(key);
                //calculate if it's the more distant, in that case variable "moreDistant" is updated
                if(distance<calculateDistance(element,me)){
                    distance=calculateDistance(element,me);
                    moreDistant=element;
                }
            }
            for (Integer key : set){
                drawNode(canvas,allNodes.get(key), me);
            }
            canvas.drawText("Unit: "+approximateDistance()/4+"degree", canvas.getWidth() - canvas.getWidth()/4, canvas.getHeight()/11,  paint);
        }
}

    private double approximateDistance(){
        int aux=(int) (distance*100);
        return aux/100;
    }
    private void drawNode(Canvas canvas,RadarData element, RadarData me) {
        int radius=canvas.getWidth()/2;
        double x=element.getLongitude()-me.getLongitude();
        double y=element.getLatitude() - me.getLatitude();
        int xInTheView=(int)(radius + x*radius/distance);
        int yInTheView=(int)(canvas.getHeight()/2 -y*radius/distance);

        canvas.drawCircle(xInTheView, yInTheView, radius/10, node);
        canvas.drawText(""+element.getId(), xInTheView, yInTheView, nodeText);
    }

    private double calculateDistance(RadarData element, RadarData me) {
        return Math.hypot(element.getLatitude()-me.getLatitude(), 
                element.getLongitude()-me.getLongitude());
    } 
```

} `

在主 Activity 中，当 gps 位置发生变化时我调用它：

```
private void updateRadarView(Location location) {
    if(location!=null){
        RadarData newState= new RadarData(myId, location.getLatitude(), location.getLongitude(), RadarData.RUNNING);
        allNodes = connectionHandler.request(newState);
        radarView = new RadarView(this,allNodes,myId);
        setContentView(radarView);
    }

} 
```

如您所见，我重新创建了radarView，然后使用setContentView 对其进行了更新，但我认为这不是一个好的解决方案。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:43:44.737

当您需要设置radarView的数据时，为什么不创建`setNodes(HashMap<Integer,RadarData> allNodes)`方法`RadarView`并每次调用它：我的意思是`radarView.setNodes(allNodes)`而不是每次都重新创建它？

# qt - 运行一个简单的 Qt 程序

> ID：12339465
> 
> 赞同：1
> 
> 时间：2012-09-09T13:26:46.653
> 
> 标签：qt, compiler-errors

我已经完成以下操作来运行一个简单的`Qt`程序：

*   创建了一个`hello`文件夹
*   创建了一个`hello.cpp`程序如下：

> ```
>  #include <QApplication>
>     #include <QLabel>
> 
>     int main(int argc, char* argv[])
>     {
>     QApplication app(argc, argv);
>     QLabel *label = new QLabel("Hello...");
>     label->show();
>     return app.exec();
>     } 
> ```

*   冉`qmake -project`
*   冉`qmake hello.pro`--->我明白了`Makefile`
*   Ran'make'，在这里，我得到了这样的东西，除非我停止它，否则它似乎会继续进行：

> c:\QtSDK\Desktop\Qt\4.8.1\msvc2008\bin\qmake.exe c:\Users\Ola\Desktop\hello\hell o.pro -o Makefile.hello make -f Makefile.hello make[1] : 进入目录`/c/Users/Ola/Desktop/hello' c:\QtSDK\Desktop\Qt\4.8.1\msvc2008\bin\qmake.exe c:\Users\Ola\Desktop\hello\hell o.pro -o Makefile.hello.hello make -f Makefile.hello.hello make[2]: Entering directory`/c/Users/Ola/Desktop/hello' c:\QtSDK\Desktop\Qt\4.8.1\msvc2008\bin\qmake.exe c:\Users\Ola\Desktop\hello\hell o.pro - o Makefile.hello.hello.hello make -f Makefile.hello.hello.hello make[3]：进入目录`/c/Users/Ola/Desktop/hello' c:\QtSDK\Desktop\Qt\4.8.1\msvc2008\bin\qmake.exe c:\Users\Ola\Desktop\hello\hell o.pro -o Makefile.hello.hello.hello.hello make -f Makefile.hello.hello.hello.hello make[4]: Entering directory`/c/Users/Ola/Desktop/hello' c:\QtSDK\Desktop\Qt\4.8.1\msvc2008 \bin\qmake.exe c:\Users\Ola\Desktop\hello\hell o.pro -o Makefile.hello.hello.hello.hello.hello make -f Makefile.hello.hello.hello.hello.hello make[ 5]：进入目录`/c/Users/Ola/Desktop/hello' c:\QtSDK\Desktop\Qt\4.8.1\msvc2008\bin\qmake.exe c:\Users\Ola\Desktop\hello\hell o.pro -o Makefile.hello.hello.hello.hello.hello.hello make -f Makefile.hello.hello.hello.hello.hello.hello make[6]: Entering directory`/c/Users/Ola/Desktop/hello' c:\QtSDK\Desktop\Qt\4.8.1\msvc2008\bin\qmake.exe c:\Users\Ola\Desktop\hello\hell o.pro -o Makefile。 hello.hello.hello.hello.hello.hello.hello make -f Makefile.hello.hello.hello.hello.hello.hello.hello make[6]: *** [sub-hello-pro-make_default] 中断 make[5 ]: *** [sub-hello-pro-make_default] 中断生成[4]: *** [sub-hello-pro-make_default] 中断生成[3]: *** [sub-hello-pro-make_default] 中断生成[2]: *** [sub-hello-pro-make_default] 中断生成[1]：*** [sub-hello-pro-make_default] 中断生成：*** [sub-hello-pro-make_default] 中断

如何运行程序？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T23:05:27.607

使用与 Qt 安装包一起安装的 Qt 命令提示符。然后，不要使用 ，而是`make`使用`mingw32-make`。

这个对我有用。

# iphone - 如何将 Sharekit 添加到现有项目

> ID：12339466
> 
> 赞同：2
> 
> 时间：2012-09-09T13:26:59.300
> 
> 标签：iphone, sharekit

如何将 sharekit 添加到现有项目以在社交网络上共享。

按照 sharekit wiki 的说明进行操作。

如果我将 sharekit.xcodeproj 添加到我的项目中，我在共享工具包中只看到一个目标，但在 sharekit wiki 中它显示了四个目标。

当尝试将 ShareKit 的目标作为依赖项添加到项目的构建阶段时：项目的应用程序目标 - 构建阶段 - 目标依赖项从 ShareKit 子项目中添加 2 个新目标：“静态库”和“资源包”。我没有找到任何静态库和资源包。

请帮助如何在项目中添加共享包。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T19:30:19.043

我做了什么来找到这些目标；

在 xCode 中右键单击您的项目导航器，然后选择 Add files to ... 然后选择项目文件夹中的子模块并添加。

![在此处输入图像描述](../Images/dca96275a3c86480cd4b8900a355c477.png)

之后，您将在目标依赖项中找到“静态库”和“资源包”。

# php - 复制 MySQL 与复制静态页面

> ID：12339474
> 
> 赞同：0
> 
> 时间：2012-09-09T13:28:19.160
> 
> 标签：php, mysql, caching, load, load-balancing

我正在尝试在两个地理分离的服务器之间进行负载平衡，并且我认为不是将整个包（即 MySQL 数据/PHP/HTML/图像）复制到两个服务器，而是生成静态页面（基于内容来自 MySQL）首先然后复制那些静态页面。这样服务器 A 和服务器 B 将只提供静态页面而无需任何 MySQL 连接。

最初我认为这会减少两台服务器的负载，因为在查看页面时不再使用 MySQL。我现在的问题是，在这种方法中我应该注意哪些缺点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:35:16.663

这取决于您数据的更新率，以及您是否关心某些人可能会在一段时间内看到它的陈旧版本。

您必须进行真正的性能测试才能确定这一点，但如果您经常更新 MySQL 数据库，则可能不值得在每次更新时生成新页面并将它们推送到不同的服务器。但是，如果您只是偶尔更新一次数据库，您可能会获得一些显着的节省。

无论哪种方式，您还必须考虑过时的数据。如果数据库在一台服务器上更新，但在另一台服务器上没有立即更新，如果一些访问者在更改传播时看到过时的数据，是否可以？

# actionscript-3 - Flash：动态文本字段会造成极大的延迟 - 为什么？

> ID：12339476
> 
> 赞同：0
> 
> 时间：2012-09-09T13:28:31.063
> 
> 标签：actionscript-3, flash, air

我正在 AIR 中创建一个 IOS 游戏，您必须在其中射击带有特定数字的鸟。每 5 秒左右会出现一只新鸟，穿过屏幕并在离开后被移除。我使用 TweenMax 以贝塞尔曲线对屏幕上的鸟进行补间。游戏使用 GPU 渲染。

这就是问题所在：当我向“鸟”MC 添加一个动态文本字段（这样我可以在鸟上放置一个数字）时，它使游戏无法玩：大约 20 秒后（屏幕上可能有 4 只鸟），游戏开始口吃并最终完全停止。这是在 iPad 1 上。

我发现了什么：

*   如果我从“鸟”MC 中删除文本字段，游戏运行良好。
*   如果我把它放回去，即使是代码永远不会改变的静态数字，它也会再次滞后——所以问题不是插入数字的代码。
*   如果我将文本字段放入，但将其留空并且从不添加文本，它运行正常，所以文本字段中存在文本就是问题所在。

我不知道问题是什么。我尝试将文本字段创建为影片剪辑的一部分并在运行时动态创建它 - 没有区别。除了数字，我不嵌入任何东西。我尝试过使用抗锯齿，无抗锯齿，设备字体 - 没有区别。

我不知道为什么 4-5 个动态文本字段的存在/补间会造成看起来像巨大的内存泄漏。有人听说过这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T15:38:07.647

在 GPU 模式下渲染矢量非常慢，尤其是文本（细而尖锐的形状也不会镶嵌）。我的建议是将[文本字段呈现为位图](http://www.indieflashblog.com/understanding-gpu-rendering-in-adobe-air-for-mobile.html)。

# php - 限制用户的功能/动作

> ID：12339483
> 
> 赞同：0
> 
> 时间：2012-09-09T13:29:30.117
> 
> 标签：php

您好，我的情况是，在特定日期，我的用户将能够更新数据，但只能将其更新限制为 3 次。到目前为止，这是我的代码。

```
if(date('m','d' == '04','01')){
     $sql="update tbl_enroll fields,fields,fields where student_id='".$_POST['student_id'] . "'";
     $pow = mysql_query($sql) or die (mysql_error());
} 
```

关于如何限制他的**更新**的任何想法？我的数据库结构有什么需要改变的吗？将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T13:31:49.133

在您的表中添加一个计数列，并在每次用户更新时递增。如果计数为 3，则不允许该操作并显示错误消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T13:37:29.133

按照@TigOldBitties 的建议将计数列添加到表中，并在 WHERE 子句的末尾添加`AND updateCount <= 3`

——你确定`if(date('m','d' == '04','01')){`是正确的吗？我认为应该是`if(date('m','d') == '04','01'){`

- 甚至`if(date('m','d') == '04','01'){`不可能是正确的，你在这里想要做什么？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-09T13:40:03.287

将“计数器”添加到 tbl_enroll。像这样的东西：

```
ALTER tbl_enroll ADD COLUMN counter SMALLINT UNSIGNED NOT NULL; 
```

然后，您的代码应该是这样的：

```
// check how many times has this user edited:
$sql = 'SELECT counter FROM tbl_enroll WHERE student_id=123';
$pow = mysql_query($sql) or die (mysql_eror());
$pow = mysql_fetch_assoc($pow);

$allowed = true;
if ($pow['counter'] >= 3) $allowed = false;

if (date('m') == '04' && date('d') == '01' && $allowed) { // allow edit only on april 1
    $sql = "UPDATE tbl_enroll SET something='something',other_field='',counter=(counter+1) WHERE student_id=123"; // this is just an example, please focus on "counter=(counter+1)"
    $pow = mysql_query($sql) or die (mysql_error());
} 
```

# php - Codeigniter 2 $this->ip_address() 不返回 IP 地址

> ID：12339486
> 
> 赞同：5
> 
> 时间：2012-09-09T13:30:02.083
> 
> 标签：php, codeigniter

好吧，我正在尝试记录用户登录历史记录，所以为此我需要跟踪用户的 IP 地址。我用了：

```
$this->input->ip_address(); 
```

`ip address`如果用户有有效的 ip，这应该返回机器的，或者如果用户没有有效的 IP，则应该返回`0.0.0.0`。但就我而言，它也没有返回。

它只是返回一种不寻常的格式。

```
::1 
```

PS我正在我的本地计算机上检查它。

**编辑 ：**

感谢所有评论的人。但在这里出来仍然是奇怪的事情。我在同一台机器上运行了两个独立的应用程序。这两个应用程序都是在 Codeigniter 2 中进行的。第一个记录`0.0.0.0`和第二个记录`::1`。两个应用程序不应该返回相同的东西吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T13:37:07.877

`::1` **是**一个有效的 IP 地址。

[http://en.wikipedia.org/wiki/IPv6](http://en.wikipedia.org/wiki/IPv6)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T23:23:14.700

可能值得检查 ::1 是否存在于您的主机文件中，并将其注释掉以查看您的两个应用程序的行为是否相同。

这个线程有一些有用的信息： [http ://codeigniter.com/forums/viewthread/205222](http://codeigniter.com/forums/viewthread/205222)

尤其

> 所以你的机器正在运行双栈（现在大多数现代操作系统都这样做），当它们运行时，他们更喜欢 IPv6 而不是 IPv4。
> 
> 从您的 localhost 界面中删除 IPv6，从您的本地网络服务器中删除 IPv6 支持（让它只听您的 v4 地址），[snipped]

# javascript - 切换、隐藏和显示问题 (Jquery)

> ID：12339490
> 
> 赞同：4
> 
> 时间：2012-09-09T13:30:52.207
> 
> 标签：javascript, jquery, css, show-hide, popupwindow

我一直在寻找可以解决以下问题的脚本：

[http://jsfiddle.net/k7E9V/3/](http://jsfiddle.net/k7E9V/3/)

1.  单击外部时关闭 div。
2.  单击另一个 div 时关闭一个 div。
3.  再次单击“更多信息”时关闭 div。

我想知道为什么当 div 处于活动状态时减号图标不会保持不变，以及如何在上述所有场景中恢复加号图标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:40:23.470

的功能与`:active`您的想法不同。为了能够切换图标，首先添加这样的 CSS 规则，而不是`:active`：

```
a.trigger.isshown{
    background:#fff url(http://icons.iconarchive.com/icons/deleket/sleek-xp-basic/24/Close-icon.png) 95% 65% no-repeat;
} 
```

现在，您可以使用`.toggleClass('isshown');`,`.removeClass('isshown');`以及`.addClass('isshown');`切换/隐藏/显示`div`面板的相同方式来更改图标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T13:45:05.233

## 最终版本： [***jsFiddle***](http://jsfiddle.net/ult_combo/k7E9V/11/)

我使`:active`选择器`.trigger`成为@Christopher 评论的子类，并修复了`.trigger`X 按钮的行为以相应地切换类：

```
$('.trigger').click(function(event) {
    event.preventDefault();
    var panel = $(this).next('.panel');
    $('.panel').not(panel).hide();
    panel.toggle("fast");
    $('.trigger').not(this).removeClass('active'); //remove active class from other X buttons
    $(this).toggleClass('active'); //toggle the clicked button's active class
}); 
```

这样，它将`active`从其他 X 按钮中删除该类，并根据请求切换当前一个。

要在单击`.panel`and外部时关闭这些框`.trigger`，请将其添加到 DOM Ready 处理程序中：

```
$(document).click('click', function(e) {
    if (!$('.panel').is(':visible')) return;
    var targ = $(e.target);
    //doesn't close the boxes if target is .panel/.trigger or their descendant
    if (targ.closest('.panel').length || targ.is('.panel')
       || targ.closest('.trigger').length || targ.is('.trigger')) return;
    $('.panel').hide('fast');
    $('.trigger').removeClass('active');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T13:48:29.500

[http://jsfiddle.net/dwZnG/](http://jsfiddle.net/dwZnG/) 试试这个大小。

```
a.trigger{
position: absolute;
text-decoration: none;
bottom:0; 
right: 0;
font-size: 17px;
letter-spacing:-1px;
font-family: verdana, helvetica, arial, sans-serif;
color:#333;
padding: 20px 30px 10px 15px;
font-weight: 600;
background:#fff url(http://icons.iconarchive.com/icons/deleket/sleek-xp-basic/24/Add-icon.png) 95% 65% no-repeat;
display: block;
}

/* Change active to a class name*/
a.trigger.active {
background:#fff url(http://icons.iconarchive.com/icons/deleket/sleek-xp-basic/24/Close-icon.png) 95% 65% no-repeat;
} 
```

然后你的JS：

```
$(document).ready(function() {
    $('.trigger').click(function(event) {
        event.preventDefault();
        var me = $(this);
        var panel = me.next('.panel');
        //If active is there, remove it
        if (me.hasClass("active")) {
            me.removeClass("active");
        }
        //If it ain't...add it
        else {
            me.addClass("active");
        }
        $('.panel').not(panel).hide();
        panel.toggle("fast");
        $(document).ready(function() {
            $('.panel').hover(function() {
                mouse_inside_div = true;
            }, function() {
                mouse_inside_div = false;
            });
            $('body').mouseup(function() {
                if (!mouse_inside_div) $('.panel').hide();

            });
        });
        });
    });​ 
```

基本上和Abody说的一样。完成此操作后，您应该能够弄清楚其余的功能。

# php - 如何在 PHP 中将 HTML 代码添加到 JSON？

> ID：12339497
> 
> 赞同：2
> 
> 时间：2012-09-09T13:32:21.537
> 
> 标签：php, json

我需要使用 PHP 将以下 html 代码添加到 JSON。

```
<a class="btn btn-mini btn-success" data-toggle="modal" href="#?page=customers-database-edit&id=$1">Edit</a> 
```

如果我直接添加它，则会破坏 JSON 代码，因为它包含双引号 (")。

所以我尝试使用以下代码：

```
if(is_string($result))
{
  static $jsonReplaces = array(array('\\', '/', '\n', '\t', '\r', '\b', '\f', '"'), array('\\\\', '\\/', '\\n', '\\t', '\\r', '\\b', '\\f', '\"'));
  return '"' . str_replace($jsonReplaces[0], $jsonReplaces[1], $result) . '"';
}
else
  return $result; 
```

上面的代码生成 html 是错误的方式：

```
<a class="\&quot;btn" btn-mini="" btn-success\"="" data-toggle="\&quot;modal\&quot;" href="\&quot;?page=customers-database-edit&amp;id=3\&quot;">Edit&lt;\/a&gt; \n</a> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T13:39:41.633

引号对于 json 没有问题。您只需要依赖编码功能。

我制作了这个简单的测试脚本，它编码一个数组并输出 json 编码字符串和再次解码字符串生成的数组。这证明你得到了你输入的东西，不管它是否包含引号。

测试脚本：

```
<?php
$test=array(
  1=>'one',
  2=>'<a class="btn btn-mini btn-success" data-toggle="modal" href="#?page=customers-database-edit&id=$1">Edit</a>',
  3=>'three'
);
$json=json_encode($test);
echo $json."\n\n";
echo print_r(json_decode($json));
?> 
```

输出：

```
{"1":"one","2":"<a class=\"btn btn-mini btn-success\" data-toggle=\"modal\" href=\"#?page=customers-database-edit&id=$1\">Edit<\/a>","3":"three"}

stdClass Object
(
    [1] => one
    [2] => <a class="btn btn-mini btn-success" data-toggle="modal" href="#?page=customers-database-edit&id=$1">Edit</a>
    [3] => three
) 
```

# objective-c - 自定义枚举 - 未知类型

> ID：12339500
> 
> 赞同：1
> 
> 时间：2012-09-09T13:32:28.350
> 
> 标签：objective-c, enums

继续我的游戏，我想增加一些难度等等。

从 C# 到 Objective-C，我希望我能有一些像这样的枚举

```
typedef enum GameTypes{
    Classic = 0,
    Unlimited,
    Timed,
    Expert,
} GameType;

typedef enum GameDifficultys
{
    Easy = 0,
    Medium,
    Hard,
} GameDifficulty; 
```

然后有这样的东西：

```
GameType gameType = GameTypes.Classic;
GameDifficulty gameDifficulty = GameDifficultys.Easy; 
```

但是我收到以下错误：

```
Unknown type name "GameType"/"GameDifficulty" 
```

这可能像在 C# 中一样吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:42:17.250

`C#`是发生过的最糟糕的事情之一`C`。

您的问题与 Objective-C 无关，这是一个普通的 C 问题。

```
typedef enum GameTypes{
    Classic = 0,
    Unlimited,
    Timed,
    Expert,
} GameType; 
```

该代码做了几件事情（我将只描述简单的事情）。首先，它声明了一个枚举类型，可以用作`enum GameTypes`. 例如：

```
enum GameTypes gameType = Classic; 
```

其次，它将这 4 个名称放入全局命名空间中，使得`Classic`、`Unlimited`、`Timed`、 和`Expert`可以使用，并且不能作为符号重复。

第三，它创建了一个名为的类型别名`GameType`，可以用作`enum GameTypes`.

因此，对于您的具体示例，您不应区分`enum GameTypes`和`GameType`。相反，您可能应该这样做：

```
typedef enum GameType {
    GameTypeClassic = 0,
    GameTypeUnlimited,
    GameTypeTimed,
    GameTypeExpert,
} GameType;

typedef enum GameDifficulty
{
    GameDifficultyEasy = 0,
    GameDifficultyMedium,
    GameDifficultyHard,
} GameDifficulty; 
```

进而...

```
GameType gameType = GameTypeClassic;
GameDifficulty gameDifficulty = GameDifficultyEasy; 
```

此外，您不必分配第一个元素，`0`因为枚举的第一个元素将始终获取`0`，除非它被显式覆盖。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T13:45:31.533

您似乎定义了错误的枚举。在 C 中，以下似乎是约定：

```
typedef enum {
    Classic = 0,
    Unlimited,
    Timed,
    Expert,
} GameTypes;

typedef enum
{
    Easy = 0,
    Medium,
    Hard,
} GameDifficulties; 
```

即便如此，在 Objective-C 中使用枚举时，我还是会坚持使用 Apple 的命名约定，这会导致如下结果：

```
typedef enum {
    GameTypeClassic = 0,
    GameTypeUnlimited,
    GameTypeTimed,
    GameTypeExpert,
} GameType;

typedef enum
{
    GameDifficultyEasy = 0,
    GameDifficultyMedium,
    GameDifficultyHard,
} GameDifficulty; 
```

现在您将能够像这样分配值：

```
GameType gameType = GameTypeClassic;
GameDifficulty gameDifficulty = GameDifficultyEasy; 
```

检查在 UITableView.h 中如何定义枚举以进行比较：[https ://github.com/enormego/UIKit/blob/master/UITableView.h](https://github.com/enormego/UIKit/blob/master/UITableView.h)

# tinymce - Tinymce 编辑器启用图片上传和媒体上传

> ID：12339502
> 
> 赞同：2
> 
> 时间：2012-09-09T13:32:41.037
> 
> 标签：tinymce

我已经安装了tinymce编辑器...我只能通过复制和粘贴一些网址来添加图像或添加媒体，我需要启用上传图像或媒体...而不仅仅是一个链接，请帮忙吗？我已将此代码用于我的文本区域：

```
<script type="text/javascript">
                    tinyMCE.init({
                            theme : "advanced",
                            mode : "specific_textareas",
                            editor_selector : "page_content",
                            plugins : "autolink,lists,spellchecker,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",
                            theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect,fontselect,fontsizeselect",
                            theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
                            theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
                            theme_advanced_buttons4 : "insertlayer,moveforward,movebackward,absolute,|,styleprops,spellchecker,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,blockquote,pagebreak,|,insertfile,insertimage",
                            theme_advanced_toolbar_location : "top",
                            theme_advanced_toolbar_align : "left",
                            theme_advanced_statusbar_location : "bottom",
                            theme_advanced_resizing : true,
                    });
                    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:35:13.657

默认情况下，tinymce 不提供从客户端计算机上传图像或媒体工具到您的服务器。但是有一个付费插件将为您提供所有这些便利。就这样吧。

[http://www.tinymce.com/enterprise/mcimagemanager.php](http://www.tinymce.com/enterprise/mcimagemanager.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:38:07.790

好 Q，对于 ASP.NET MVC 项目来说很简单，并且设置完全设置。跨浏览器工作没有问题...，试试这个开源项目[http://tinymcefckfilemanger.codeplex.com/](http://tinymcefckfilemanger.codeplex.com/)

# rest - 在 RESTful API 中聚合数据

> ID：12339504
> 
> 赞同：20
> 
> 时间：2012-09-09T13:33:12.760
> 
> 标签：rest

有一个有趣的 HTTP API 问题，我想要一些意见。我的 API 允许人们以 1-10 的等级对事物进行评分。我有一个`GET /ratings`列出用户评分的端点。我们还想要一种显示用户每天平均评分的方法。所以我的问题 - 摘要应该是相同的 url，like`/ratings?data=summary`还是应该是它自己的 url，比如`/ratingsummaries`or `/ratings/summary`？

通常情况下，我认为没有正确的答案。摘要是否只是评级的另一种观点，在这种情况下，它将是评级资源并且应该是其中的一部分`/ratings`？或者，评分摘要是它自己的资源，在这种情况下它应该有自己的 url，比如`/ratingsummaries`？ `/ratings/summary`看起来也不错，但它并不是真正的评级子资源。

期待您的反馈。谢谢大家！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T18:01:45.990

我的意见是，
`/ratings/`当你得到一个收视率列表时，它就像是一样。搜索参数通常以 给出`@QueryParam`。例如`ratings?offset=20&records=50&startDate=xx&endDate=yy`

`/ratings/{id}/`对于由 id 标识的一个特定评级。

`/ratings/{id}/votes`以获得对评级的投票。

评级摘要与评级是不同的实体，因此它是单独 url 的候选者，
`/ratingsummary?startDate=x&endDate=y`

或者您的路径可以以`/ratingsummary`; 可能就像
`/ratingsummary/ratings?offset=20&records=50&startDate=xx&endDate=yy` 在这种情况下，您有评分摘要，然后您可以深入到对摘要做出贡献的评分列表，然后是一个特定的评分，等等。

遵循类似`/entities/{idOfOneEntiity}/{attributeOfEntitiy}`等的模式是理想的。

# c# - Fullcalendar/Fetching JSON feed（已编辑）

> ID：12339508
> 
> 赞同：1
> 
> 时间：2012-09-09T13:34:19.990
> 
> 标签：c#, asp.net, json, jquery, fullcalendar

当我使用 ajax 从我的 JSON 提要中获取数据时，我的 fullCalendar 对象中的事件没有显示。我相信 JSON 格式是正确的，因为 JSON.aspx 的输出是：

[{"id":1,"title":"TESTTITLE","info":"INFOINFOINFO","start":"2012-08-20T12:00:00","end":"2012-08-20T12 :00:00","用户":1}]

我使用了 Firebug，似乎没有正确获取 JSON 提要？

当我直接在事件中添加上部 JSON-feed 时，它会正确显示。

**（编辑）JSON 响应现在正在工作，尽管事件仍未显示在完整日历中。**

JSON.aspx

```
public partial class JSON : System.Web.UI.Page
{
protected void Page_Load(object sender, EventArgs e)
{
    // Get events from db and add to list.
    DataClassesDataContext db = new DataClassesDataContext();
    List<calevent> eventList = db.calevents.ToList();

    // Select events and return datetime as sortable XML Schema style.
    var events = from ev in eventList
                 select new
                 {
                     id = ev.event_id,
                     title = ev.title,
                     info = ev.description,
                     start = ev.event_start.ToString("s"),
                     end = ev.event_end.ToString("s"),
                     user = ev.user_id
                 };

    // Serialize to JSON string.
    JavaScriptSerializer jss = new JavaScriptSerializer();
    String json = jss.Serialize(events);

    Response.Write(json);
    Response.End();
   }
} 
```

还有我的 Site.master

```
<link href="~/Styles/Site.css" rel="stylesheet" type="text/css" />    
<link href='fullcalendar/fullcalendar.css' rel='stylesheet' type='text/css' />
<script src='jquery/jquery-1.7.1.min.js' type='text/javascript'></script>
<script src='fullcalendar/fullcalendar.js' type='text/javascript' ></script>
<script type="text/javascript">
     $(document).ready(function () {
         $('#fullcal').fullCalendar({

            eventClick: function() {
                alert('a day has been clicked!');
            },
          events: 'JSON.aspx' 
         })
     });
</script> 
```

几天来我一直在扫描相关问题，但似乎没有一个能解决我的问题......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:12:02.697

为什么你的电话这么复杂？现在试试这个：

```
$('#fullcal').fullCalendar({     
    events: 'JSON.aspx',
    eventClick: function (calEvent, jsEvent, view) {
        alert('a day has been clicked!');
    }
}); 
```

# mysql - Mysql：如何从 id 获取其他表库中的值

> ID：12339509
> 
> 赞同：-3
> 
> 时间：2012-09-09T13:34:24.917
> 
> 标签：mysql

假设我的数据库上有 3 个表

```
Table:Category   
   category_id

Table:container   
   container_id
   category_id

Table:products

   container_id
   product_id 
```

如何根据 category_id 获取所有 product_id？

例如，我在上面的表格中有这些数据：

```
Table: category
    sour
    sweet
    Bitter

Table: container
    bottled
    sachet

Table: product
    sugar
    vinegar
    cocoa 
```

你如何获得所有`tb_product`类别（`tb_category`）是甜蜜的产品（）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:37:06.140

你可以用它`INNER JOIN`来解决你的问题。

```
SELECT  a.*
FROM    products a
        INNER JOIN container b
            on a.container_id = b.container_ID
        INNER JOIN Category c
            ON b.category_ID = c.categoryID
WHERE   c.categoryName = 'sweete' 
```

如您所见，我假设该`Category`表具有列`category_ID`和`categoryName`. 因此，在上面的示例中，我使用类别名称来搜索属于某个类别的所有产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:38:39.070

```
select p.*
from Category c
join container c2 on c2.category_id = c.category_id
join product p on p.container_id = c2.container_id
where c.name = 'sweet'; 
```

注意查询中表的顺序（应该比其他答案执行得更快！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T13:39:38.167

您可以像这样使用内部联接：

```
SELECT a.product_id FROM products AS a INNER JOIN  container AS b on a.container_id = b.container_Id INNER JOIN Category AS c on  b.category_Id = c.category_id where c.category_id = 'new' 
```

# php - 将 fetchAll 替换为 fetch 以避免内存限制

> ID：12339512
> 
> 赞同：0
> 
> 时间：2012-09-09T13:35:07.410
> 
> 标签：php, mysql, foreach, fetch, fetchall

我遇到了内存限制错误，`fetchAll`所以我试图`fetch`改用，但我找不到办法。有什么建议吗？在哪里/如何使用`while`代替`foreach`？

这是原始代码：

```
// We get all the data from the table
$Qselect = $pdo->prepare('SELECT * FROM '.$table_to_export.''); 
$Qselect->execute(array(''));
$results = $Qselect->fetchAll(PDO::FETCH_ASSOC); // Here is the problem
$countRmain = $Qselect->rowCount();

// We get the column names
$Qdescribe = $pdo->prepare('DESCRIBE '.$table_to_export.'');
$Qdescribe->execute();
$limit = $Qdescribe->rowCount()-1;      // Number of column in the table
$table_fields = $Qdescribe->fetchAll(PDO::FETCH_COLUMN); // No problem here

foreach($table_fields as $key => $fields){
    $outputCsv .= trim($fields).';';
}

// We remove the ; at the end
$outputCsv = rtrim($outputCsv, ';');

// Data
$outputCsv .= "\n";
if($countRmain > 0){
    foreach($results as $row){
            $column = 0 ;
        foreach ($row as $key => $val){         
            if (is_null($val)){
                $outputCsv .= 'NULL;';  // If the field id empty, we add NULL
            }
            else {
                $outputCsv .= $val.';'; // We add the value in the file
            }
            if ($column == $limit)
                $outputCsv .= "\n";
            $column ++;
        }
    }
}
    else
        exit('No data to export'); 
```

我试图将`foreach`循环包含在内，`while($results = $Qselect->fetch()){`但这需要很长时间（50000 行需要 10 分钟）

PS：如果我增加 PHP memory_limit 它适用于 fetchAll 但我不想要这个解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:35:12.607

试试这个。

```
1\. comment line 4
2\. Replace line 23:
    while($row = $Qselect->fetch(PDO::FETCH_ASSOC)){
3\. Skip (or Replace) checks on line 22 
```

想法很简单：你`$result`更早，但没有加载整个数组。您只需一步一步加载记录。即使对于 1M 行，这也不够慢，因为您将一段代码迭代循环替换为另一段**相同**的代码迭代。
如果您仍然遇到时间问题，请尝试重新组织\优化您的代码。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-09T13:37:31.027

我也遇到过这个问题。

增加以下变量，使您的页面执行不会停止：

```
max_input_time
memory_limit
max_execution_time 
```

或者你可以使用

```
while($row = $Qselect->fetch(PDO::FETCH_ASSOC)){ 
```

代替 fatchAll

# objective-c - 我的 plist 已更改，如何替换文档目录中更改的字符串

> ID：12339516
> 
> 赞同：0
> 
> 时间：2012-09-09T13:35:22.317
> 
> 标签：objective-c, ios

我的 plist 是一个`array with dictionaries`.

在启动时，如果 .plist不存在，则从`bundle`to复制它。`documents directory`

但是如果 plist 已经存在于`documents directory`：

**必须根据包中*更新的双字典*检查每个字典，以查找“District”字符串中的更改。**

当然，如果进行了更改，请替换字符串。

这是复制 plist 函数：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
[self copyPlist];
return YES;
}

- (void)copyPlist {

NSError *error;
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *path = [documentsDirectory stringByAppendingPathComponent:@"Wine.plist"];
NSString *bundle = [[NSBundle mainBundle] pathForResource:@"Wine" ofType:@"plist"];
NSFileManager *fileManager = [NSFileManager defaultManager];

if (![fileManager fileExistsAtPath: path]) {
    [fileManager copyItemAtPath:bundle toPath:path error:&error];
} else {
//I need to check if the "District" value has been changed in any of the dictionaries.
}
} 
```

关于如何做到这一点的任何建议，或有用的教程/示例代码？

我的猜测是我必须将 plist 的内容提取到 NSMutableArrays:`bundleArray`和`documentsArray`. 然后在数组中找到匹配的字典。可以通过查看“名称”字符串是否相等来完成。然后比较匹配字典中的两个“District”字符串并查找任何更改，并替换更改的。但我不知道应该怎么做，所以任何帮助都非常有用，因为这非常重要！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:51:54.240

我认为您的字典结构如下： Root as "Array"

1.  字典 1 与“地区作为关键之一”

2.  字典 2 与“地区作为关键之一”

您可以检查 Array 的特定索引处的两个**NSDictionary**是否相等，我在下面进行了编码。

```
NSArray *bundleArray=[[NSArray alloc] initWithContentsOfFile:@"path to .plist in bundle"];;
NSArray *documentArray=[[NSArray alloc] initWithContentsOfFile:@"path to .plist in DocumentDirectory"];
BOOL updateDictionary=NO;

for(int i=0;i<bundleArray.count;i++){
    NSDictionary *bundleDic=[bundleArray objectAtIndex:i];

    NSDictionary *documentDic=[documentArray objectAtIndex:i];

    if(![bundleDic isEqualToDictionary:documentDic])
    {
        /*
         *if there is any change between two dictionaries. 
         * i.e bundle .plist has changed so update .plist in document Directory
         */

        [documentDic setValue:[bundleDic objectForKey:@"District"] forKey:@"District"];
        updateDictionary=YES;

    }
}

//Update Dictionary
if(updateDictionary){
    [documentArray writeToFile:@"path to .plist in DocumentDirectory" atomically:YES];
} 
```

# c# - JS/C# 我如何知道我刚刚单击或操作的元素 id 或 xpath？

> ID：12339517
> 
> 赞同：2
> 
> 时间：2012-09-09T13:35:23.477
> 
> 标签：c#, javascript, browser-automation

如您所知，Selenium IDE 可以向您显示一个脚本并告诉您您刚刚操作了什么元素。

我不知道这背后发生了什么。每个自动化框架都可以知道您点击、输入或选择了什么元素。

我想要一个控制台输出并显示我刚刚在浏览器中操作的每个元素。

我该如何实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:43:15.203

使用 jQuery：

```
$("*").click(function(e) {
    console.log(this);
}.blur(function(e) {
    console.log(this);
}; 
```

只需在页面上的某个地方弹出它，它就会记录在单击或选择时被操纵的元素。我敢肯定还有其他操纵方式，但以上只是一个开始。添加更多处理程序将是微不足道的 -[`.change()`](http://api.jquery.com/change/)并且[`.hover()`](http://api.jquery.com/hover/)浮现在脑海中。

# php - 使用 Uploadify 发送 formData 不适用于大文件

> ID：12339519
> 
> 赞同：1
> 
> 时间：2012-09-09T13:35:50.120
> 
> 标签：php, jquery, upload

我正在使用这个 uploadify 插件。我正在发布变量，但是一切正常，但是当我上传大于 5mb 的文件大小时，它不会发布数据。这是我的代码和调试信息。我已经尝试更改大小限制，甚至设置为 0，这意味着没有限制。更改了 php.ini 中的上传限制设置，但它仍然无法正常工作

```
 //Upload Song#2

$('#upload_song2').uploadify({
     'auto'          : true,
     'multi'         : false,   
     'fileTypeDesc'  : 'Mp3 Files',
     'fileTypeExts'  : '*.mp3',
     'swf'           : 'uploadify.swf',
     'uploader'      : 'artist_music_process.php' ,
      'sizeLimit': 25600, // 25 MB

  'onUploadStart' : function(file) 
 {
     console.log(file);
     $('#upload_song2').uploadify("settings",
      "formData", {
      "column":'album_song_name2',
      'artist_id' : '<?php echo $artist_details['id']; ?>',
      'username' : '<?php echo $artist_details['username'];?>'

      });
  },

      'onUploadSuccess' : function(file, data, response) 

      {
          alert(data);
        $("#container").notify("create", {
        title: 'Success',
        text: file.name+' Uploaded with success'
         });      

        $('#txt_song2').val(file.name);
        $('#hid_song2').val(data);

      }
      // Your options here

    }); //uploadify ends 
```

这是我的调试代码。

```
 ---SWFUpload Instance Info---
                Version: 2.2.0 2009-03-25
                Movie Name: SWFUpload_0
                Settings:
                    upload_url:               /desi/artist_music_process.php
                    flash_url:                uploadify.swf?preventswfcaching=1347196919191
                    use_query_string:         false
                    requeue_on_error:         false
                    http_success:             
                    assume_success_timeout:   30
                    file_post_name:           Filedata
                    post_params:              [object Object]
                    file_types:               *.mp3
                    file_types_description:   Mp3 Files
                    file_size_limit:          0
                    file_upload_limit:        0
                    file_queue_limit:         999
                    debug:                    true
                    prevent_swf_caching:      true
                    button_placeholder_id:    upload_song2
                    button_placeholder:       Not Set
                    button_image_url:         /desi/
                    button_width:             120
                    button_height:            30
                    button_text:              
                    button_text_style:        color: #000000; font-size: 16pt;
                    button_text_top_padding:  0
                    button_text_left_padding: 0
                    button_action:            -100
                    button_disabled:          false
                    custom_settings:          [object Object]
                Event Handlers:
                    swfupload_loaded_handler assigned:  false
                    file_dialog_start_handler assigned: true
                    file_queued_handler assigned:       true
                    file_queue_error_handler assigned:  true
                    upload_start_handler assigned:      true
                    upload_progress_handler assigned:   true
                    upload_error_handler assigned:      true
                    upload_success_handler assigned:    true
                    upload_complete_handler assigned:   true
                    debug_handler assigned:             true

                ---SWFUpload Instance Info---
                Version: 2.2.0 2009-03-25
                Movie Name: SWFUpload_1
                Settings:
                    upload_url:               /desi/artist_music_process.php
                    flash_url:                uploadify.swf?preventswfcaching=1347196919200
                    use_query_string:         false
                    requeue_on_error:         false
                    http_success:             
                    assume_success_timeout:   30
                    file_post_name:           Filedata
                    post_params:              [object Object]
                    file_types:               *.mp3
                    file_types_description:   Mp3 Files
                    file_size_limit:          0
                    file_upload_limit:        0
                    file_queue_limit:         999
                    debug:                    true
                    prevent_swf_caching:      true
                    button_placeholder_id:    upload_song
                    button_placeholder:       Not Set
                    button_image_url:         /desi/
                    button_width:             120
                    button_height:            30
                    button_text:              
                    button_text_style:        color: #000000; font-size: 16pt;
                    button_text_top_padding:  0
                    button_text_left_padding: 0
                    button_action:            -100
                    button_disabled:          false
                    custom_settings:          [object Object]
                Event Handlers:
                    swfupload_loaded_handler assigned:  false
                    file_dialog_start_handler assigned: true
                    file_queued_handler assigned:       true
                    file_queue_error_handler assigned:  true
                    upload_start_handler assigned:      true
                    upload_progress_handler assigned:   true
                    upload_error_handler assigned:      true
                    upload_success_handler assigned:    true
                    upload_complete_handler assigned:   true
                    debug_handler assigned:             true

                ---SWFUpload Instance Info---
                Version: 2.2.0 2009-03-25
                Movie Name: SWFUpload_2
                Settings:
                    upload_url:               /desi/artist_music_process.php
                    flash_url:                uploadify.swf?preventswfcaching=1347196919207
                    use_query_string:         false
                    requeue_on_error:         false
                    http_success:             
                    assume_success_timeout:   30
                    file_post_name:           Filedata
                    post_params:              [object Object]
                    file_types:               *.jpg; *.png
                    file_types_description:   Image Files
                    file_size_limit:          0
                    file_upload_limit:        0
                    file_queue_limit:         999
                    debug:                    true
                    prevent_swf_caching:      true
                    button_placeholder_id:    upload_album_img
                    button_placeholder:       Not Set
                    button_image_url:         /desi/
                    button_width:             120
                    button_height:            30
                    button_text:              
                    button_text_style:        color: #000000; font-size: 16pt;
                    button_text_top_padding:  0
                    button_text_left_padding: 0
                    button_action:            -100
                    button_disabled:          false
                    custom_settings:          [object Object]
                Event Handlers:
                    swfupload_loaded_handler assigned:  false
                    file_dialog_start_handler assigned: true
                    file_queued_handler assigned:       true
                    file_queue_error_handler assigned:  true
                    upload_start_handler assigned:      true
                    upload_progress_handler assigned:   true
                    upload_error_handler assigned:      true
                    upload_success_handler assigned:    true
                    upload_complete_handler assigned:   true
                    debug_handler assigned:             true

                SWF DEBUG: SWFUpload Init Complete
                SWF DEBUG: 
                SWF DEBUG: ----- SWF DEBUG OUTPUT ----
                SWF DEBUG: Build Number:           SWFUPLOAD 2.2.0
                SWF DEBUG: movieName:              SWFUpload_0
                SWF DEBUG: Upload URL:             /desi/artist_music_process.php
                SWF DEBUG: File Types String:      *.mp3
                SWF DEBUG: Parsed File Types:      mp3
                SWF DEBUG: HTTP Success:           0
                SWF DEBUG: File Types Description: Mp3 Files (*.mp3)
                SWF DEBUG: File Size Limit:        0 bytes
                SWF DEBUG: File Upload Limit:      0
                SWF DEBUG: File Queue Limit:       999
                SWF DEBUG: Post Params:
                SWF DEBUG: ----- END SWF DEBUG OUTPUT ----
                SWF DEBUG: 
                SWF DEBUG: Event: fileDialogStart : Browsing files. Single Select. Allowed file types: *.mp3
                SWF DEBUG: Select Handler: Received the files selected from the dialog. Processing the file list...
                SWF DEBUG: Event: fileQueued : File ID: SWFUpload_0_0
                SWF DEBUG: Event: fileDialogComplete : Finished processing selected files. Files selected: 1\. Files Queued: 1
                SWF DEBUG: StartUpload: First file in queue
                SWF DEBUG: Event: uploadStart : File ID: SWFUpload_0_0
                SWF DEBUG: Global Post Item: username=basit
                SWF DEBUG: Global Post Item: column=album_song_name2
                SWF DEBUG: Global Post Item: artist_id=7
                SWF DEBUG: ReturnUploadStart(): File accepted by startUpload event and readied for upload.  Starting upload to /desi/artist_music_process.php for File ID: SWFUpload_0_0
                SWF DEBUG: Event: uploadProgress (OPEN): File ID: SWFUpload_0_0
                SWF DEBUG: Event: uploadProgress: File ID: SWFUpload_0_0\. Bytes: 4128768\. Total: 10070528
                SWF DEBUG: Event: uploadProgress: File ID: SWFUpload_0_0\. Bytes: 10070528\. Total: 10070528
                SWF DEBUG: Event: uploadSuccess: File ID: SWFUpload_0_0 Response Received: true Data: Array
                SWF DEBUG: (
                SWF DEBUG: )
                SWF DEBUG: Array
                SWF DEBUG: (
                SWF DEBUG: )
                SWF DEBUG: 
                SWF DEBUG: Event: uploadComplete : Upload cycle complete.
                SWF DEBUG: Event: fileDialogStart : Browsing files. Single Select. Allowed file types: *.mp3
                SWF DEBUG: Select Handler: Received the files selected from the dialog. Processing the file list...
                SWF DEBUG: Event: fileQueued : File ID: SWFUpload_0_1
                SWF DEBUG: Event: fileDialogComplete : Finished processing selected files. Files selected: 1\. Files Queued: 1
                SWF DEBUG: StartUpload: First file in queue
                SWF DEBUG: Event: uploadStart : File ID: SWFUpload_0_1
                SWF DEBUG: Global Post Item: username=basit
                SWF DEBUG: Global Post Item: column=album_song_name2
                SWF DEBUG: Global Post Item: artist_id=7
                SWF DEBUG: ReturnUploadStart(): File accepted by startUpload event and readied for upload.  Starting upload to /desi/artist_music_process.php for File ID: SWFUpload_0_1
                SWF DEBUG: Event: uploadProgress (OPEN): File ID: SWFUpload_0_1
                SWF DEBUG: Event: uploadProgress: File ID: SWFUpload_0_1\. Bytes: 5599328\. Total: 5599328
                SWF DEBUG: Event: uploadSuccess: File ID: SWFUpload_0_1 Response Received: true Data: Array
                SWF DEBUG: (
                SWF DEBUG:     [Filename] => Utay - Copy.mp3
                SWF DEBUG:     [username] => basit
                SWF DEBUG:     [column] => album_song_name2
                SWF DEBUG:     [artist_id] => 7
                SWF DEBUG:     [Upload] => Submit Query
                SWF DEBUG: )
                SWF DEBUG: Array
                SWF DEBUG: (
                SWF DEBUG:     [Filedata] => Array
                SWF DEBUG:         (
                SWF DEBUG:             [name] => Utay - Copy.mp3
                SWF DEBUG:             [type] => application/octet-stream
                SWF DEBUG:             [tmp_name] => C:\wamp\tmp\phpAB62.tmp
                SWF DEBUG:             [error] => 0
                SWF DEBUG:             [size] => 5599328
                SWF DEBUG:         )
                SWF DEBUG: 
                SWF DEBUG: )
                SWF DEBUG: basit_utay - copy.mp3
                SWF DEBUG: Event: uploadComplete : Upload cycle complete. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T13:44:59.587

尝试更新您的 php.ini 以上传大文件。您需要更改以下变量

```
file_uploadsile_uploads
    upload_max_filesize
    max_input_time
    memory_limit
    max_execution_time
    post_max_size 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T17:51:13.193

我和你有同样的问题。我的 php ini 文件信誉良好。我意识到我的 jpeg 图像扩展名是大写的 (.JPG)，我正在检查上传 php 脚本中的文件类型是否只有小写扩展名。我修改它以反映大写和小写，这解决了我上传大于 2mb 的文件的问题！

希望这对某人有帮助！

```
$fileTypes = array('jpg','jpeg','gif','png','JPG','GIF','JPEG','PNG'); // File extensions
$fileParts = pathinfo($_FILES['Filedata']['name']);

if (in_array($fileParts['extension'],$fileTypes)) { 
```

# safari - Safari 6 圆角故障

> ID：12339520
> 
> 赞同：0
> 
> 时间：2012-09-09T13:35:59.567
> 
> 标签：safari, css

![http://i.stack.imgur.com/pSvEf.png](../Images/ec2c1d1f2908e068531bc3818d0b3d77.png)

你好！正如您在图像上看到的，在 safari 6 中出现了一个带有圆角的奇怪行为

```
{ border-radius: 5px 5px 5px 5px; } 
```

当悬停在元素上时，当悬停次数越来越多时，会出现一条细线……第一个和第二个链接没有悬停，您可以看到由于将鼠标悬停在元素上几次而导致的不同线条。 ..

这只是野生动物园中的一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:17:28.220

我以前没有见过这种确切的行为，但我见过类似的。我假设您使用的是 Retina MBP？当然还有山狮。Safari*偶尔*会遇到边框半径和虚拟分辨率（这是视网膜显示的工作方式）的问题。

尝试退出 Safari，更改分辨率，然后再次打开它。如果一开始看起来更好，那么您只需要等待 Apple 的修复即可。

同时，您可能会幸运地确保所有边框样式都将其隐藏：

```
border-color: transparent;
border-style: none;
border-width: 0; 
```

希望有帮助！

-麦克风

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T14:52:15.887

这篇文章可能会回答您的问题[Safari 中的 CSS 圆角错误？](https://stackoverflow.com/questions/2224386/css-rounded-corners-bug-in-safari).

尝试使用：

```
-webkit-border-top-left-radius: 5px;
-webkit-border-top-right-radius: 5px;
-webkit-border-bottom-left-radius: 5px;
-webkit-border-bottom-right-radius: 5px; 
```

代替：

```
border-radius: 5px 5px 5px 5px; 
```

# entity-framework - 更改实体框架的架构

> ID：12339532
> 
> 赞同：1
> 
> 时间：2012-09-09T13:37:29.383
> 
> 标签：entity-framework, entity-framework-4

我正在开发的 ASP MVC 4 网站上使用 Entity Framework 5。因为我使用的是共享主机，它对我使用的数据库数量收费，所以我想在我的生产站点附近运行一个测试站点。

我有两个问题：

1）我使用代码优先和数据库迁移。迁移类似乎将模式*dbo*嵌入到表的名称中。

如何根据测试/生产标志更改架构

2) 如何更改 EF 从中选择数据的架构？

谢谢你，伊多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T20:00:30.993

迁移和 EF 都从映射中获取架构，因此如果要更改架构，则必须更新映射以使用：

```
modelBuilder.Entity<MyEntity>().ToTable("MyTable", "MySchema"); 
```

并控制`MySchema`来自配置的值，但这确实是个坏主意。有一天，您忘记更改值并中断生产。使用本地数据库进行开发和测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T20:16:30.703

如前所述：使用相同的数据库（结构上）进行开发、测试和生产。

模式的目标是对数据库对象进行分组，就像我们在 C# 中对命名空间所做的那样，或者简化数据库对象组的权限。不识别数据库阶段。通过将它们用于后者，如果不是不可能的话，您也更难适当地使用模式。例如，请参阅[此](http://msdn.microsoft.com/en-us/library/dd283095%28v=sql.100%29.aspx)MSDN 白皮书。

使用一些数据库名称约定来表明它们的目的要容易得多。

# php - PHP 即时创建文本文件 下载文件有可能吗？

> ID：12339537
> 
> 赞同：2
> 
> 时间：2012-09-09T13:38:12.860
> 
> 标签：php, fwrite

是否可以即时创建 file.txt 下载它？

该文件应该存储在其中，`backup/process/_pro_links_date.txt` 但是当我下载该文件时，它没有 `.txt` 扩展名，并且存储在我的文件夹中。

### HTML

```
<a href="?down=load">File</a> 
```

### PHP

```
if ( $_GET['down'] == 'load' ) {
$date = date( 'Y-m-d H:i:s' );

$myFile = "backup/process/_pro_links_$date.txt";
$fh = fopen($myFile, 'w') or die("can't open file");
$stringData = "Title - Url - Live Date - Process Date \r";
fwrite($fh, $stringData);
$sql = mysql_query("SELECT * FROM k_addlinks WHERE user_code = '".$_SESSION['user_code']."' ") or die (mysql_error());
while ($row = mysql_fetch_array($sql)){
$dated = date("m/j/y g:i",strtotime( $row["date"] ));
    if($row["spider_date"] == 'never'){
        $sdate = $row["spider_date"];
    }else{
        $sdate = date("m/j/y g:i",strtotime( $row["spider_date"] ));
    }
    $stringData = $row['pro_name'] . $row['customDomain'] . $dated . $sdate . '\r';
}
fwrite($fh, $stringData);
fclose($fh);

$path = "backup/process/_pro_links_$date.txt";
$name = "_pro_links_$date.txt";
header("Content-Type: text/plain");
header("Content-Length: " . filesize($path));    
header('Content-Disposition: attachment; filename='.$name);

readfile($path);
} 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:47:02.987

我看到了这个问题。在您的`Content-Disposition`标题中，您设置了文件名，但您的文件名包含空格，因为您使用`date("Y-m-d H:i:s")`. 因此，您需要在该标头中用引号将文件名括起来：

```
// $name contains a space, in the format _pro_links_Y-m-d H:i:s.txt
$name = "_pro_links_$date.txt";
// Surround the filename with quotes...
header('Content-Disposition: attachment; filename="'.$name . '"'); 
```

`$date`或者，在文件名中使用它之前删除空格：

```
$date = str_replace($date, " ", "_");
$name = "_pro_links_$date.txt"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T13:40:36.033

与其将其保存到文件中，不如在发送标头后回显它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-06T22:53:07.213

```
$content = "Hello world !!!";
$name = "name.txt";

$file = fopen($name,"wb");
fwrite($file, $content);
fclose($file);

header('Content-Type: charset=utf-8');
header("Content-disposition: attachment; filename=$name");

print $content; 
```

# android - 根据位置执行操作

> ID：12339538
> 
> 赞同：2
> 
> 时间：2012-09-09T13:38:17.597
> 
> 标签：android, geolocation, gps

我正在创建一个应用程序，当我在某个位置的某个半径范围内时，我需要执行一个操作。但我不想不断地轮询该位置，因为那会耗尽电池电量。

我想为用户提供一个选项来指定查询位置的频率。但是，我担心如果用户设置的时间过长，那么当我的应用靠近该位置时，它会错过执行该操作。

我在一个 Google IO 会话中，Pay With Square 有一个自动标签功能，我不确定他们是否在不断地轮询位置，设置查询位置之间的延迟，或者在不耗尽电池的情况下高效的第三个选项。

我想就如何处理这个问题征求建议。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T10:07:55.623

看起来您的问题实际上是：“如何在节省设备电池的同时获得准确的位置测量？”

省电和定位好主要有两种方式：

1.  不要使用 GPS（那是真正的耗电大户）
2.  在轮询操作之间设置较大的间隔

仅使用 wi-fi 和手机数据，您就可以获得相当好的定位（从 40 到 150m 半径，在许多情况下比 GPS 更好）。只需在您的代码中选择“ACCURACY_COARSE”、“ACCURACY_LOW”和/或“POWER_LOW”作为提供者选择标准。

请参阅 Google Developer 网站上的以下链接：

*   [选址策略](http://developer.android.com/guide/topics/location/strategies.html)
*   [位置和地图](http://developer.android.com/guide/topics/location/index.html)
*   [位置管理器](http://developer.android.com/reference/android/location/LocationManager.html)

特别是这两个：

*   [获取提供者](http://developer.android.com/reference/android/location/LocationManager.html#getProviders%28android.location.Criteria,%20boolean%29)
*   [标准](http://developer.android.com/reference/android/location/Criteria.html)

您可以根据测量的用户速度选择/设置节电轮询间隔。如果用户正在步行（小于 5 公里/小时），您可以使用 30 - 60 秒的间隔，而不会错过任何提醒。如果用户开车旅行（超过 50 公里/小时），您必须设置 1 - 10 秒的间隔。考虑到位置*空间*精度通常很差（100 m 左右），因此尝试以非常高的*时间*（速度）精度“捕捉”该点确实没有什么意义。

也请查看 Google 文档。

在任何情况下，Google 都明确建议不要尝试使用您自己的代码来节省电池电量，并为此依赖 getProviders 标准。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:04:34.543

如果我理解得很好，当设备的位置在某个位置的预定义半径内时，您想触发某个事件。如果这是一个问题，你有一个叫做 Proximity Alerts 的东西，它是一种自动化机制。所以只需谷歌它，或者试试这个[http://www.javacodegeeks.com/2011/01/android-proximity-alerts-tutorial.html](http://www.javacodegeeks.com/2011/01/android-proximity-alerts-tutorial.html)。我还没读过它，但乍一看它看起来不错

# android - 在真实设备上测试安卓应用

> ID：12339543
> 
> 赞同：2
> 
> 时间：2012-09-09T13:38:33.677
> 
> 标签：android, testing, user-interface

我有三星 s6102 和 s9100 以及我正在开发的一些应用程序。问题是我想在真实设备上测试我的应用程序，我想我们可以一起做一些事情。任何对他的应用程序如何在我的设备上运行有疑问的人，我都愿意接受测试。我也想知道我的应用程序如何在您的设备上运行。

也许这种类型的服务已经可用，但我没有找到。

关于如何在不购买设备的情况下在真实设备上测试我的应用程序的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:46:26.403

三星提供这样的[服务](http://developer.samsung.com/remoteTestLab.do)。

但是，这有相当多的限制。您最好的选择是购买一些涵盖大部分功能的设备。我个人拥有 5 款涵盖各种硬件规格和屏幕密度的 Android 设备。此外，如果您有使用 Android 设备的朋友，您可以查看他们是否愿意让您在他们上测试您的应用程序。您还可以与可能在聊天室或论坛中遇到的其他开发人员进行私人测试。

此外，如果您确实购买设备，请确保您从多个制造商处购买，并且有些设备是低端的，有些是高端的，有些是中档的，有些是大的，有些是小的。另外，我建议您至少购买一台 Nexus 设备。

# c++ - 使用 borland c++ v5.5 从 C++ 编程语言编译示例代码时出现编译错误

> ID：12339544
> 
> 赞同：-1
> 
> 时间：2012-09-09T13:38:33.563
> 
> 标签：c++

这是代码：

```
#include <string>
#include <iostream>

#include <vector>
#include <algorithm>

using namespace std;

struct Pair{
  string name;
  double val;
};

vector<Pair> pairs;

double& value(const string& s)
{
  for(int i=0; i < pairs.size(); i++)
    if(s == pairs[i].name)
      return pairs[i].val;

  Pair p = {s, 0};
  pairs.push_back(p);

  return pairs[pairs.size() - 1].val;
}

int main()
{
  string buf;
  while(cin>>buf) value(buf)++;

  for(vector<Pair>::const_iterator p = pairs.begin(); p != pairs.end(); ++p)
    cout << p->name << ": " << p->val << '\n';
  return 0;
} 
```

编译器总是抱怨 Line (Pair p = {s, 0};) 错误：
Borland C++ 5.5.1 for Win32 版权所有 (c) 1993, 2000 Borland
....\cpp\TEST.CPP:
Warning W8012 .. ..\cpp\TEST.CPP 18: 比较函数值中的有符号和无符号值
(const string &)
错误 E2291 ....\cpp\TEST.CPP 22: } 预期在函数值中(const string &)
错误 E2034 ....\cpp\TEST.CPP 22：无法在
函数值中将“const string”转换为“Pair”（const string &）
错误 E2141 ....\cpp\TEST.CPP 22：函数中的声明语法错误value( const
string &)
Error E2139 ....\cpp\TEST.CPP 22: Declaration missing ; 在函数值中（常量
字符串 &）
警告 W8070 ....\cpp\TEST.CPP 22: 函数应该在函数值中返回一个值
(const string &)
警告 W8004 ....\cpp\TEST.CPP 22: 'p' 被赋值为从未
在函数值中使用过(const string &)
Error E2190 ....\cpp\TEST.CPP 22: Unexpected }
Error E2238 ....\cpp\TEST.CPP 23: Multiple declaration for 'pairs'
Error E2344 .. ..\cpp\TEST.CPP 14：“对”的早期声明
错误 E2141 ....\cpp\TEST.CPP 23：声明语法错误
错误 E2040 ....\cpp\TEST.CPP 25：声明错误终止
错误 E2190 ....\cpp\TEST.CPP 26: Unexpected }
*** 10 个编译错误 ***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:06:46.457

该代码使用最新的编译器 (GCC 4.6.3) 编译时仅出现警告。您的编译器不能完全兼容。

有关 GCC 4.3.4 的编译，请参见[此处](http://ideone.com/g7oTM)。

# django - m2m_changed 不会触发自定义“通过”模型

> ID：12339547
> 
> 赞同：0
> 
> 时间：2012-09-09T13:38:49.787
> 
> 标签：django, django-models, django-signals

我在和`through`之间有一个用于 ManyToManyField 的自定义中介模型：`Wishlist``Product`

```
class Product(models.Model):
    name = models.CharField(max_length=255)
    created = models.DateTimeField(auto_now_add=True)

    class Meta:
        ordering = ('-created', )

    def __unicode__(self):
        return self.name

class Wishlist(models.Model):
    user = models.ForeignKey(User)
    name = models.CharField(max_length=255)
    created = models.DateTimeField(auto_now_add=True)
    products = models.ManyToManyField(Product, through='WishlistProduct', null=True, blank=True)

    class Meta:
        ordering = ('-created', )

    def __unicode__(self):
        return self.name

class WishlistProduct(models.Model):
    wishlist = models.ForeignKey(Wishlist)
    product = models.ForeignKey(Product)
    created = models.DateTimeField(auto_now_add=True)

    class Meta:
        ordering = ('-created', )

    def __unicode__(self):
        return u'%s in %s' % (self.product.name, self.wishlist.name) 
```

和一个`m2m_changed`信号：

```
@receiver(m2m_changed, sender=Wishlist.products.through, dispatch_uid='m2m_changed_wishlist_products')
def m2m_changed_wishlist_products(sender, instance, action, *args, **kwargs):
    print(sender)
    print(action) 
```

`m2m_changed`信号不通，为什么？

但是`post_save`WishlistProduct 的信号将被触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T14:58:55.297

您的信号可能正在被垃圾收集。传入*weak=False*来*连接*方法。

[https://docs.djangoproject.com/en/dev/topics/signals/#listening-to-signals](https://docs.djangoproject.com/en/dev/topics/signals/#listening-to-signals)

# xml - XSLT - 如何组合 XSLT 文件

> ID：12339548
> 
> 赞同：2
> 
> 时间：2012-09-09T13:38:54.717
> 
> 标签：xml, xslt

有没有一种简单的组合 XSLT 的方法。我是 XSLT 的新手，我掌握了如何创建它们以及使用它们的有趣方式来获得我想要的结果。但是目前我可以使用一个 XSLT 将我的输出转换为所需的输出；**但**紧接着我有另一个，另一个。每个 XSLT 将输出从一件事更改为另一件事。

例如，这些是用于说明问题的简单 XSLT：

XSLT 1：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:r="http://www.castiron.com/response" exclude-result-prefixes="r">

    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="/root">
        <xsl:element name="imageScene7Response"  xmlns="http://www.castiron.com/burberry/digitalcatalogue/response">
            <xsl:element name="rcode">0</xsl:element>
            <xsl:element name="rmessage">success</xsl:element>
            <xsl:copy-of select="@*"/>
            <xsl:apply-templates select="payload"/>
        </xsl:element>
    </xsl:template>

    <xsl:template match="/root/payload">
        <xsl:if test="not(productId = preceding-sibling::payload/productId)">

            <xsl:element name="payload" xmlns="http://www.castiron.com/burberry/digitalcatalogue/response">
                <xsl:element name="productId">
                    <xsl:value-of select="productId"/>
                </xsl:element>
                <xsl:for-each select="../payload[productId = current()/productId]">
                    <xsl:choose>
                        <xsl:when test="type = '0' and preceding-sibling::payload/type = type and productId = preceding-sibling::payload/productId">
                            <xsl:element name="alternativeImages">
                                <xsl:value-of select="url"/>
                            </xsl:element>
                        </xsl:when>
                        <xsl:when test="type = '0'">
                            <xsl:element name="mainImage">
                                <xsl:value-of select="url"/>
                            </xsl:element>
                        </xsl:when>
                        <xsl:when test="type &gt; '0' and type &lt; '70'">
                            <xsl:element name="alternativeImages">
                                <xsl:value-of select="url"/>
                            </xsl:element>
                        </xsl:when>
                        <xsl:when test="type = '70'">
                            <xsl:element name="video">
                                <xsl:value-of select="url"/>
                            </xsl:element>
                        </xsl:when>
                        <xsl:when test="type = '80'">
                            <xsl:element name="lookbookImages">
                                <xsl:value-of select="url"/>
                            </xsl:element>
                        </xsl:when>
                        <xsl:when test="type = 'sw'">
                            <xsl:element name="swatchImages">
                                <xsl:value-of select="url"/>
                            </xsl:element>
                        </xsl:when>
                    </xsl:choose>
                </xsl:for-each>
            </xsl:element>
        </xsl:if>
    </xsl:template>
</xsl:stylesheet> 
```

然后：

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match=
        "*[not(@*|*|comment()|processing-instruction()) 
        and normalize-space()=''
        ]"/>
</xsl:stylesheet> 
```

然后是其他 XSLT 中的一些其他逻辑。

是否像将模板一个接一个地放在一个组合的 XSLT 中一样简单？

***XML 片段***

```
<?xml version="1.0"?>
<root>
    <payload>
        <productId>11111</productId>
        <type>0</type>
        <url>https://11111</url>
    </payload>
    <payload>
        <productId>11111</productId>
        <type>1</type>
        <url>https://11111</url>
    </payload>
    <payload>
        <productId>11111</productId>
        <type>1</type>
        <url></url>
    </payload>
    <payload>
        <productId>22222</productId>
        <type>0</type>
        <url>https://22222</url>
    </payload>
    <payload>
        <productId>22222</productId>
        <type>1</type>
        <url>https://22222</url>
    </payload>
    <payload>
        <productId>22222</productId>
        <type>sw</type>
        <url>https://22222</url>
    </payload>
    <payload>
        <productId>22222</productId>
        <type>sw</type>
        <url></url>
    </payload>
</root> 
```

这不是最好的例子，但它会起作用！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:43:22.550

答案是：**这取决于**

如果您有多个 XSL 模板，那么可能打算将它们按顺序应用于 XML - 例如，如果您有 3 个 XSLT，则可能第一个应用于原始文档，第二个到第一次转换的结果，第三次到第二次转换的结果。

这被称为[管道方法](http://www.usingxml.com/Transforms/XslPipelines)- XML 沿着 XSLT 管道流动，被反复转换，直到结果从另一端出来，这是一种完全有效的方法。

如果 XSLT 被设计为按顺序应用，那么最好让它们保持这种状态 - 将它们混合成一个巨大的 XSLT 是可能的，但操作和维护可能非常棘手，因为您必须将 XML 节点集从模板传递到模板。[这里](http://www.gerixsoft.com/blog/xslt/pipeline)讨论了这种方法，尽管我不同意作者的结论，即这是一种更纯粹的方法。

在上面的示例中，您有 2 个明确的 XSLT。第一个显然是结构化的——它旨在将 XML 响应的结构转换为另一个 XML 文档。您拥有的第二个 XSLT 几乎是一个实用程序 XSLT - 它似乎旨在去除任何不是属性或属性的东西。在这种情况下，最好将它们应用到 XML 响应消息中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:35:05.840

在 XSLT 1.0 和 2.0 中，有两个用于组合样式表的本机指令：xsl:import 和 xsl:include。在 XSLT 3.0 中，还有第三种机制，我将在后面介绍。

导入指令看起来像这样......

```
<xsl:import href="my-other-transform.xsl" /> 
```

并且包含指令是相似的

```
<xsl:include href="my-other-transform.xsl" /> 
```

xsl:import 引用另一个样式表并使其模板可用，但优先级低于主样式表的模板。xsl:include 就像指令被包含的样式表的逐字副本替换一样。

一般来说，制作顶级样式表的首选技术非常适合您要解决的问题，并导入样式表，其中导入的样式表更通用和通用。

如果您在客户端使用 XSLT 1.0，我不知道，但我怀疑浏览器对 xsl:import 和 xsl:include 的支持会受到限制。如果您使用的是 XSLT 1.0 服务器端，那就太丢脸了！您没有理由不升级到 XSLT 2.0。

在 XSLT 3.0 中，您可以使用 xsl:package 指令声明一个自包含的模块集合，并对 API 点的可见性进行细粒度控制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T14:56:18.920

**有可能改进第一个转换，甚至可以消除第二个转换**。

一旦 OP 编辑​​问题并提供源 XML 文档，我将很高兴更新此答案。

**至于组合不同转换的一般方法**：

使用`<xsl:import>`是你的朋友。

看看**[FXSL](http://fxsl.sf.net)**库，它包含 150 多个样式表模块，其中许多都导入了其他模块。

**经验法则**：

每当包含在同一样式表模块中的模板或模板组包含可能在多个情况下使用的有用功能时，最好以这样的方式编写这些模板，以便其他人可以方便地导入它们，更具体的样式表模块，需要此功能，因此避免在每个不同的特定情况下重新实现此功能。

# ios - iOS 网络状态变化通知

> ID：12339549
> 
> 赞同：2
> 
> 时间：2012-09-09T13:39:15.823
> 
> 标签：ios, networking, wifi, reachability

我希望我的应用程序能够获取有关网络状态更改的异步通知，即网络完全关闭或手机从蜂窝网络切换到 Wi-Fi 时。

我知道如何使用 Reachability 同步测试这个，但是有没有办法获得异步通知？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T20:31:43.293

假设您使用的是 Reachability 2.x，您只需观察可达性更改通知：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(reachabilityChanged:)
                                             name:kReachabilityChangedNotification
                                           object:nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-31T16:47:50.583

您可以使用这个小型库，它会显示 HUD 通知并且非常易于使用 [http://huytd.github.io/datatify/](http://huytd.github.io/datatify/)

# java - Web Service wsse 安全实现

> ID：12339552
> 
> 赞同：4
> 
> 时间：2012-09-09T13:39:22.003
> 
> 标签：java, xml, web-services, jax-rpc

我正在使用 IBM JAX-RPC/JAX-WS 创建一个 Web 服务。我正在尝试实现 wsse 安全性，但无法弄清楚实现相同的确切步骤。我将为此 Web 服务使用 RSA 7.5 和 Websphere 7。

阅读文档，我完全迷失了，因为我是新手，对此一无所知。

有人可以列出如何为 Web 服务实现 wsse 安全性的步骤吗？

从过去几天开始，我一直在为此苦苦挣扎。

**编辑**

我希望在标头中完成身份验证，它应该如下所示：

```
<header>
    <authenticationInfo>
        <userID></userID>
        <password></password>
    </authenticationInfo>
</header> 
```

除了使用处理程序和更改标题内容之外，还有其他方法可以实现相同的目的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T13:36:40.710

对于 Web 服务（基于 SOAP），安全部分通常由[Web 服务处理程序处理](http://www.ibm.com/developerworks/webservices/library/ws-tipjax2/index.html)。处理程序适用于客户端和服务器端。对于典型的安全用例，

1.  在[客户端](http://www.mkyong.com/webservices/jax-ws/jax-ws-soap-handler-in-server-side/)，处理程序在发送到服务器之前[拦截](http://pic.dhe.ibm.com/infocenter/iicdoc/v1r4m0/index.jsp?topic=/com.ibm.iic.doc/security/sec_webserv_example.html)请求，并在 SOAP 消息中**插入安全标头。**
2.  在服务器端，处理程序拦截请求并**检查**SOAP 请求是否包含适当的安全标头。这发生在请求处理程序处理之前。

这是我遇到的关于[WS 安全性的](http://msdn.microsoft.com/en-us/library/ms977327.aspx)一个很好的链接。它不是 IBM 或 java 特定的，但它仍然是一个信息丰富的阅读。

为了回答您关于分步指南的问题，我找不到任何标准的 RSA 7.5 特定文章，但由于 JAX-RPC 是标准规范，它应该是相同的。这是一次这样的例子（[Part1](http://www.ibm.com/developerworks/websphere/library/techarticles/0803_chung/0803_chung.html)，[Part2](http://www.ibm.com/developerworks/websphere/library/techarticles/0804_chung/0804_chung.html)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T16:54:42.317

WebSphere 具有对 WS-Security 的内置支持。请参阅[http://publib.boulder.ibm.com/infocenter/radhelp/v7r5/topic/com.ibm.webservice.wsfp.doc/topics/csecurews.html](http://publib.boulder.ibm.com/infocenter/radhelp/v7r5/topic/com.ibm.webservice.wsfp.doc/topics/csecurews.html)。

# c# - 如何以编程方式（C#）确定 .docx 文件的页数

> ID：12339553
> 
> 赞同：7
> 
> 时间：2012-09-09T13:39:30.557
> 
> 标签：c#, ms-word

我有大约 400 个 .docx 格式的文件，我需要确定 #pages 中每个文件的长度。

所以，我想编写 C# 代码来选择包含文档的文件夹，然后返回每个 .docx 文件的#pages。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-09T13:59:39.700

为了说明如何做到这一点，我刚刚创建了一个基于 .NET 4.5 和一些 Microsoft Office 2013 COM 对象的 C# 控制台应用程序。

```
using System;
using Microsoft.Office.Interop.Word;

namespace WordDocStats
{
    class Program
    {
        // Based on: http://www.dotnetperls.com/word
        static void Main(string[] args)
        {
            // Open a doc file.
            var application = new Application();
            var document = application.Documents.Open(@"C:\Users\MyName\Documents\word.docx");

            // Get the page count.
            var numberOfPages = document.ComputeStatistics(WdStatistic.wdStatisticPages, false);

            // Print out the result.
            Console.WriteLine(String.Format("Total number of pages in document: {0}", numberOfPages));

            // Close word.
            application.Quit();
        }
    }
} 
```

为此，您需要引用以下 COM 对象：

*   Microsoft Office 对象库（在我的例子中是 15.0 版）
*   Microsoft Word 对象库（在我的例子中是 15.0 版）

这两个 COM 对象使您可以访问所需的命名空间。

有关如何引用正确程序集的详细信息，请参阅“3\. 设置工作环境：”部分：[http ://www.c-sharpcorner.com/UploadFile/amrish_deep/WordAutomation05102007223934PM/WordAutomation.aspx](http://www.c-sharpcorner.com/UploadFile/amrish_deep/WordAutomation05102007223934PM/WordAutomation.aspx)

有关通过 C# 进行 Word 自动化的快速和更全面的介绍，请参阅： http: [//www.dotnetperls.com/word](http://www.dotnetperls.com/word)

- 更新

`Document.ComputeStatistics`可以在此处找到有关可让您访问页数的方法的文档：http: [//msdn.microsoft.com/en-us/library/microsoft.office.tools.word.document.computestatistics.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.word.document.computestatistics.aspx)

如文档中所见，该方法采用一个`WdStatistic`枚举，使您能够检索不同类型的统计信息，例如页面总数。有关您可以访问的完整统计信息范围的概述，请参阅`WdStatistic`枚举的文档，可在此处找到：http: [//msdn.microsoft.com/en-us/library/microsoft.office.interop .word.wdstatistic.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.wdstatistic.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-09T14:07:47.713

使用 DocumentFormat.OpenXml.dll 你可以在 C:\Program Files\Open XML SDK\V2.0\lib 中找到 dll

示例代码：

```
DocumentFormat.OpenXml.Packaging.WordprocessingDocument doc = DocumentFormat.OpenXml.Packaging.WordprocessingDocument.Open(docxPath, false);
            MessageBox.Show(doc.ExtendedFilePropertiesPart.Properties.Pages.InnerText.ToString()); 
```

要使用 DocumentFormat.OpenXml.Packaging.WordprocessingDocument 类，您需要在项目中添加以下引用

DocumentFormat.OpenXml.dll & Windowsbase.dll

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-25T17:16:32.757

您可以使用 Spire.Doc 页数是免费的 :)

```
using Spire.Doc;
    public sealed class TestNcWorker
    {
        [TestMethod]
        public void DocTemplate3851PageCount()
        {
            var docTemplate3851 = Resource.DocTemplate3851;
            using (var ms = new MemoryStream())
            {
                ms.Write(docTemplate3851, 0, docTemplate3851.Length);
                Document document = new Document();
                document.LoadFromStream(ms, FileFormat.Docx);
                Assert.AreEqual(2,document.PageCount);
            }
            var barCoder = new BarcodeAttacher("8429053", "1319123", "HR3514");
            var barcoded = barCoder.AttachBarcode(docTemplate3851).Value;
            using (var ms = new MemoryStream())
            {
                ms.Write(barcoded, 0, barcoded.Length);
                Document document = new Document();
                document.LoadFromStream(ms, FileFormat.Docx);
                Assert.AreEqual( 3, document.PageCount);

            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-17T20:34:54.547

现代解决方案（基于[Jignesh Thakker 的回答](https://stackoverflow.com/a/12339771/653457)）：Open XML SDK 不再存在，但它已[发布在 Github 上](https://github.com/OfficeDev/Open-XML-SDK)，甚至支持 .NET Core。服务器/运行机器上不需要 MS Office。

安装[Nuget 包](https://www.nuget.org/packages/DocumentFormat.OpenXml)：

```
Install-Package DocumentFormat.OpenXml 
```

编码：

```
using DocumentFormat.OpenXml.Packaging;

private int CountWordPage(string filePath)
{
    using (var wordDocument = WordprocessingDocument.Open(filePath, false))
    {
        return int.Parse(wordDocument.ExtendedFilePropertiesPart.Properties.Pages.Text);
    }
} 
```

# ios - 核心数据未在 iOS 设备上加载

> ID：12339556
> 
> 赞同：0
> 
> 时间：2012-09-09T13:39:47.390
> 
> 标签：ios, core-data, device

我遇到了核心数据的问题。

简单的应用程序是创建文档，第一个视图控制器将显示我创建的所有文档，这些文档存储在核心数据数据库中。

当我在 iOS 模拟器上运行程序时，它运行良好。当我在将 iPad 与 mac 连接时在 iOS 设备上运行该应用程序时，它也可以正常工作。

但是当我断开 iPad 与 Mac 的连接，或者停止在 xCode 中运行程序时，该应用程序仍然可以在我的 iPad 上运行。但是之前创建的所有文档都没有加载。我仍然可以创建文档，并且它们正确显示在视图控制器上。但是当我停止应用程序并再次启动它时，书架仍然是空的......那些文档不是从核心数据数据库加载的。

你能帮我解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T17:50:36.693

If your app is deployed to iOS 5.1 or newer, then you should be using the "Documents/Application Support" folder, and also marking the documents if you do not want them backed up to iCloud. I am finding I need to create "Application Support" if its not there. This is the code I use:

```
 NSFileManager *manager = [NSFileManager defaultManager];
    NSString *appSupportDir = [self applicationAppSupportDirectory];
    if(![manager fileExistsAtPath:appSupportDir]) {
        __autoreleasing NSError *error;
        BOOL ret = [manager createDirectoryAtPath:appSupportDir withIntermediateDirectories:NO attributes:nil error:&error];
        if(!ret) {
            NSLog(@"ERROR app support: %@", error);
            exit(0);
        }
    }

- (NSString *)applicationAppSupportDirectory
{
    return [NSSearchPathForDirectoriesInDomains(NSApplicationSupportDirectory, NSUserDomainMask, YES) lastObject];
} 
```

# mysql - 如何在mysql表中插入西里尔符号？

> ID：12339559
> 
> 赞同：1
> 
> 时间：2012-09-09T13:40:04.287
> 
> 标签：mysql

我创建了一个表格，可以说示例。并插入值，如下：

```
insert into Example (column1)
values ('оарвыларфдл'); 
```

然后我尝试从表中选择数据，输出为：??????????

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:47:42.207

您在某处弄乱了字符集：表、连接、输出或这些的某种组合使用了不正确的字符集 - 所以请确保它们都匹配并使用可以代表您的字符的字符集 - UTF- 8 一般是最好的选择，因为它可以代表一切。

不可能比这更准确，因为您没有提供任何关于这些东西使用哪些字符集的信息。

# c# - 如何正确停止视频捕获设备

> ID：12339564
> 
> 赞同：1
> 
> 时间：2012-09-09T13:40:38.217
> 
> 标签：c#, emgucv

我正在使用 c# 项目。所以在这里我使用了 emguCV 图像处理库。这是我访问网络摄像头并停止的示例代码。此代码有效，但是当我停止视频设备时，它无法正常停止。

```
 private void btnStart_Click(object sender, EventArgs e)
    {
        if(capture==null){
            try
            {                    
                capture = new Capture();
            }
            catch(NullReferenceException ex){
                MessageBox.Show(ex.Message);
            }
        }

        if(capture!=null){
            if (captureInProgress)
            {
                btnStart.Text = "!Start";
                Application.Idle -= ProcessFrame;
            }
            else {
                btnStart.Text = "Stop";
                Application.Idle += ProcessFrame;
            }
        }
        captureInProgress = !captureInProgress;
    } 
```

我在这里错过了什么。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T03:05:19.840

```
private void btnStart_Click(object sender, EventArgs e)
    {
        if(capture==null){
            try
        {                    
            capture = new Capture();
        }
        catch(NullReferenceException ex){
            MessageBox.Show(ex.Message);
        }
    }

    if(capture!=null){
        if (captureInProgress)
        {
            btnStart.Text = "!Start";
            capture.Stop(); //you miss this
            Application.Idle -= ProcessFrame;
        }
        else {
            btnStart.Text = "Stop";
            capture.Start(); //you miss this
            Application.Idle += ProcessFrame;
        }
    }
    captureInProgress = !captureInProgress;
} 
```

# linux - 用于查找子字符串并将其移动到行尾的 linux 命令

> ID：12339565
> 
> 赞同：0
> 
> 时间：2012-09-09T13:40:44.547
> 
> 标签：linux, substring, edit

我需要在 Linux 中逐行读取文件，在每一行中找到一个子字符串，将其删除并将其放在该行的末尾。

例子：

原始文件中的行：

```
a,b,c,substring,d,e,f 
```

输出文件中的行：

```
a,b,c,d,e,f,substring 
```

如何使用 Linux 命令执行此操作？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:44:25.777

```
sed '/substring/{ s///; s/$/substring/;} ' 
```

将处理固定的子字符串。请注意，如果 substring 以 a 开头，则`,`可以很好地处理您的示例情况。如果子字符串不固定但可能是通用正则表达式：

```
sed 's/\(substring\)\(.*\)/\2\1' 
```

如果您正在寻找一般的 csv 解析，您应该重新表述这个问题。（如果您将输入视为逗号分隔的字段，则很难应用此解决方案在行首找到固定字符串。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:43:31.117

我总是喜欢使用 perl 的命令行来执行这样的正则表达式任务 - perl 足够强大，可以在我的大多数用法中涵盖 awk 和 sed，并且在 windows 和 linux 中都可用，它对我来说既简单又方便，所以解决方案在perl 就像：

```
perl -ne "s/^(.*?)(?:(?<comma>,)(?<substr>substring)|(?<substr>substring)(?<comma>,))(?<right>.*)$/$1$+{right}$+{comma}$+{substr}/; print" input.txt > output.txt 
```

或更简单的：

```
perl -lpe "if(s/(,substring|substring,)//){ s/$/,substring/ }" input.txt > output.txt 
```

**输入.txt**

> substring,a,b,c,d,e,f
> a,b,c,substring,d,e,f
> a,b,c,d,e,f,substring
> substring,a
> a,substring
> substring
> a

**输出.txt**

> a,b,c,d,e,f,子串
> a,b,c,d,e,f,子串
> a,b,c,d,e,f,子串
> a,子串
> a,子串 子
> 串
> a

您可以根据实际输入进行编辑：

*   如果单词和逗号之间有空格
*   如果您使用制表符作为分隔符

命令行的一些解释：

*   使用 perl 的 -n -e 选项： -n 表示在循环中逐行处理输入；-e 表示命令行中的一行程序
*   使用 perl 的 -l -p 选项： -l 表示处理多行；-p 表示总是打印
*   单行程序只是正则表达式替换和打印
*   (?:pattern) 表示分组但不捕获匹配项
*   (?<comma>) 是一个命名组，然后您需要使用 $+{comma} 哈希来访问它

# crash - EXC_BAD_ACES 购买应用内购买时，仅在第二次进入商店后

> ID：12339566
> 
> 赞同：0
> 
> 时间：2012-09-09T13:40:49.043
> 
> 标签：crash, in-app-purchase, exc-bad-access, payment

好的。我的应用程序中有应用内购买。我有一个视图控制器，它充当我的应用程序的商店，用户可以从中购买东西。

第一次进入商店时，您可以很好地买东西（想买多少就买多少），但是如果您退出商店，然后再回到那里，就会变得喜怒无常。有时它会继续工作一点，但所有时间它最终都会因“EXC_BAD_ACCESS”而崩溃。

它在添加付款行崩溃：

```
[[SKPaymentQueue defaultQueue] addTransactionObserver:self];
SKMutablePayment *payment = [[SKMutablePayment alloc] init];
payment.productIdentifier = @"uk.co.exampleEmail_name.MaxBuys";
[[SKPaymentQueue defaultQueue] addPayment:payment]; 
```

但有时也在 main.m 文件中：

```
int main(int argc, char *argv[])
{
@autoreleasepool {
    return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
}
} 
```

另一个类似的问题说这是因为它有其他代码添加了多个事务观察器，但这是我唯一称呼它的地方。但当然，每次购买尝试都会调用一次。我在视图中执行 productsrquest 委托命令确实加载了。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-14T11:01:20.970

错误消息表明消息正在发送到 InAppPurchaseManager 的已释放实例，即您的类。它发生在您打开视图（创建实例）、关闭视图（释放实例）、然后再次打开视图（创建第二个实例）之后。问题发生在 addPayment: 调用中。这表明框架仍然拥有旧的已发布实例的句柄，并且正在尝试向其发送消息。

您在调用时为框架提供了 loadStore 中对象的句柄

```
 [[SKPaymentQueue defaultQueue] addTransactionObserver:self]; 
```

我看不到您将自己作为观察者移除的任何地方。发出通知的对象通常不会保留其观察者，因为这样做会产生保留周期和/或内存泄漏。

在您的**dealloc**代码中，您需要清理并调用**removeTransactionObserver** :。那应该可以解决您的问题。

```
- (void)dealloc {

    [[SKPaymentQueue defaultQueue]removeTransactionObserver:self];

    [super dealloc];
} 
```

# c# - C# 从不同的类中获取对象

> ID：12339567
> 
> 赞同：0
> 
> 时间：2012-09-09T13:40:54.503
> 
> 标签：c#, winforms

我正在学习 C#，我正在尝试制作游戏，但遇到了问题。我有两个类，我称之为`Item`and `Weapon`，`Weapon`看起来像这样：

```
class Weapon : Item
{ 
    int damage; 
    int durability;

    public void asd()
    {
        Weapon shortSword = new Weapon();
        shortSword.dmg = 5;
        shortSword.durability = 20;
        Weapon woodenBow = new Weapon();
        woodenBow.dmg = 3;
        woodenBow.durability = 15;
    }
 } 
```

然后我有另一个包含不同方法的类，其中一个在玩家走在一个项目上时被调用，并且它应该随机化该项目。但是我无法`Weapon`从其他类中获取对象。我如何联系他们，或解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T13:45:12.377

你的设计有问题。创建武器的方法不应该是`Weapon`类的实例方法。它可能是一个静态方法，甚至可能是某个其他类的方法。

您的方法应该以集合或`IEnumerable`.

```
public class Weapon : Item
{
    public int Damage { get; set; }
    public int Durability { get; set; }

    // Consider moving this method to another class.
    public static IEnumerable<Weapon> CreateWeapons()
    {
        List<Weapon> weapons = new List<Weapon>();

        Weapon shortSword = new Weapon { Damage = 5, Durability = 20 };
        weapons.Add(shortSword);

        Weapon woodenBow = new Weapon { Damage = 3, Durability = 15 };
        weapons.Add(woodenBow);

        return weapons;
    }
} 
```

我还使用对象初始化器语法使代码更简洁，并整理了一些方法/属性命名。

# git - git(hub) 从合并中删除提交

> ID：12339568
> 
> 赞同：2
> 
> 时间：2012-09-09T13:41:08.947
> 
> 标签：git, merge, commit, rebase

我的问题类似于[git remove commit from a merge](https://stackoverflow.com/questions/5395793/git-remove-commit-from-a-merge)但我无法按照那里建议的说明进行操作，因为我的存储库的历史有点不同。

我正在 github 上开发一个开源存储库。几个月后，我想更新我的本地存储库，但我错误地做了一个无用的合并提交。历史如下所示：

```
* commit 3d542ddb64e6474a10dfface24defc69b713a295
| Author: TD
| 
|     fixed typo in dependency_injection/compilation chapter
|    
*   commit 34db3b8c08e5c5d3be4021076716ed90187fe5fb
|\  Merge: b8b73fb 7cc08f4
| | Author: TD
| | 
| |     Merge remote-tracking branch 'upstream/master'
| |   
| * commit 7cc08f476b7ac5610b1eb5b5db5182d18e35a9e9
| | Author: RW
| | 
| |     [#1654] Tweaking comments
... 
```

我的小改动应该只有一个提交，但有两个。我只想删除 34db3b8c0... 合并提交。我知道我应该尝试交互式 rebase，但我不知道如何设置它。当我尝试

```
git rebase -i HEAD~2 
```

我得到了一个巨大的过去提交列表：

```
pick bbfbddb Add the new "strict_requirements"
pick 31bb8a9 [reference] Tweaking note about strict_requirements
pick fb4d621 [Cookbook][Extension] Fixed typo in functions name
pick d8d1d86 Fixing index typo
# lots and lots of commits in the history here
pick c734436 Fixed indentation.
pick ca8d884 Update cookbook/logging/channels_handlers.rst
pick 7cc08f4 [#1654] Tweaking comments in channel handlers doc to point to reference
pick 3d542dd fixed typo in dependency_injection/compilation chapter: should be contAiner instead of continer

# Rebase b8b73fb..3d542dd onto b8b73fb
#
# Commands:
... 
```

但是当我尝试时：

```
git rebase -i HEAD~1 
```

（想要一个更短的列表）我只得到一个提交：

```
pick 3d542dd fixed typo in dependency_injection/compilation chapter: should be contAiner instead of continer 
```

据我了解，我应该使用交互式变基来压缩合并提交 34db3b8c08... ，对吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T14:54:31.383

试试`git rebase upstream/master`。因此，您的提交将应用于远程主机。合并提交将被丢弃为无用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-10T03:55:03.473

您想要做的是获取自合并以来的所有更改，并将它们重新定位到合并之前的提交：

```
git rebase --onto 34db3b8^ 34db3b8 master 
```

其中“34db3b8”是您要消除的合并提交，“master”是您要从中消除它的分支。这将重写分支，跳过合并提交并重播之后的所有内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-09T14:59:36.480

最简单的方法是将您的分支 HEAD 重置为上游 HEAD 并强制推送到原点

```
git reset --hard HEAD upstream/master

git push -f origin master 
```

# jakarta-ee - 如何通过 Netbeans 中的 Main 函数运行 javaweb 项目？

> ID：12339571
> 
> 赞同：0
> 
> 时间：2012-09-09T13:41:26.527
> 
> 标签：jakarta-ee, netbeans, main

我已经在 Netbeans7.2 中创建了一个 JavaWeb 项目，这本书遵循*使用 GlassFish3 第 2 版开始 JavaEE6 平台*。这本书在我使用 Netbeans 时使用 Maven 和命令行来编译和打包。

问题是它编写了一个主函数来测试一些函数（创建/更新 Book 实体并通过 System.out.println(info) 输出一些信息）。但我无法通过 Netbeans 中的 main 函数运行项目，它总是打开网络浏览器并显示 404....

如果我不想创建网页而只是通过 Netbeans 中的 javase 之类的 main 函数运行项目，我该怎么办？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:48:51.457

如果您想测试您添加的某些功能，请在[JUnit](http://junit.sourceforge.net/)测试中编写测试。仅测试您编写的代码并适当使用模拟对象，这提供了一种模拟您的代码依赖关系的好方法，即您的 web 应用程序的其他层，如 DAO、DTO 等。

另外，使用模拟对象可能非常好，因为您可以模拟行为的东西，例如测试您的代码是否可以优雅地处理一些异常。它变得非常方便您的代码取决于一些异常树。

一些模拟对象库：

*   [模拟](http://www.jmock.org/)
*   [EasyMock](http://www.easymock.org/)
*   [莫基托](http://code.google.com/p/mockito/)

忘记将测试包含在主要方法中的想法。这不是 Web 开发中的好习惯。

Maven 提供了很好的插件来在容器中进行测试。看cargo插件，或者war插件。但当然，您需要编写一些 JSP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:31:38.340

方法 1：在编辑器中打开文件的同时按 Shift + F6。

方法2：右键单击您的文件，选择“运行文件”

# php - PHP MySQL 构建 3 层多维数组

> ID：12339574
> 
> 赞同：0
> 
> 时间：2012-09-09T13:42:05.653
> 
> 标签：php, mysql, arrays, multidimensional-array, while-loop

所以我有我的查询，它的返回结果正如预期的一样膨胀，除了今天我的设计师在扳手中通过。这似乎让我有点偏离了我的游戏，也许是因为我累了谁知道呢，反正..

我要创建一个 3 层阵列

主要类别、子类别（每个主要类别可以有多个）以及每个子类别的项目列表，可以是 1 到 100 个项目。

我尝试过 foreach、while、for 循环。所有通常都从`$final = array();`下面的循环开始。

尝试构建数组，例如：

```
$final[$row['primary]][$row['sub']][] = $row['item]
$final[$row['primary]][$row['sub']] = $row['item] 
```

我已经尝试将它们分别定义为有自己的数组可以使用`array_push()`。以及其他各种策略，我都失败了。我需要一个头脑清醒的人来帮助我。从哪种类型的循环最适合我的需要，到我如何构建我的数组以按计划构建。

期望的结果是

```
array(
   primary = array
             (
                sub = array
                      (
                        itemA,
                        itemB,
                        itemC
                      ),
                sub = array
                      (
                        itemA,
                        itemB,
                        itemC
                      ),
             ),
   primary = array
             (
                sub = array
                      (
                        itemA,
                        itemB,
                        itemC
                      ),
                sub = array
                      (
                        itemA,
                        itemB,
                        itemC
                      ),
             ),
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:53:17.267

在处理您的请求期间这样的事情：

```
if (!array_key_exists($row['primary'], $final)) {
    $final[$row['primary']] = array();
}
if (!array_key_exists($row['sub'], $final[$row['primary']])) {
    $final[$row['primary']][$row['sub']] = array();
}
$final[$row['primary']][$row['sub']][] = $row['item']; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T13:46:26.857

像这样的东西......

```
$final = 
array(
    'Primary1'=>array(
        'Sub1'=>array("Item1", "Item2"),
        'Sub2'=>array("Item3", "Item4")
    ),
    'Primary2'=>array(
        'Sub3'=>array("Item5", "Item6"),
        'Sub4'=>array("Item7", "Item8")
    ),
); 
```

您可以使用它来做到这一点，`array_push`但这并不容易，因为您真的想要一个关联数组，而 array_push 不能很好地与键一起使用。您当然可以使用它将项目添加到您的子元素

```
array_push($final['Primary1']['Sub1'], "Some New Item"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T13:56:07.870

如果我理解正确，您想将几个数据库关系提取到 PHP 数组中。

这是一些示例代码，您可以如何解决该问题：

```
<?php

$output = array();

$i = 0;
// DB Query
while($categories) { // $categories is an db result

    $output[$i] = $categories;

    $ii = 0;
    // DB Query
    while($subcategories) { // $subcategories is an db result

        $output[$i]['subcategories'][$ii] = $subcategories;

        $iii = 0;
        // DB Query
        while($items) { // $items is an db result

            $output[$i]['subcategories'][$ii]['items'][$iii] = $items;

            $iii++;
        }
        $ii++;
    }
    $i++;
}

print_r($output);

?> 
```

# ruby - 红宝石赛璐珞和资源消耗

> ID：12339578
> 
> 赞同：2
> 
> 时间：2012-09-09T13:42:50.603
> 
> 标签：ruby, resources, consumption, celluloid

我是赛璐珞的新手，对池和期货有一些疑问。我正在构建一个简单的网络爬虫（参见底部的示例）。我的 URLS 数组有几十万个 URL，所以这个例子被剥离到几百个。

我现在要做的是分组到最大值。50 req/s 使用期货，获取他们的回调并进一步抓取 50 个 url 等。我对这段代码的问题：我希望它最多可以有 50 个线程，但在我的情况下它会产生多达 400 个甚至更多。如果输入数据增加，代码片段将完成，因为它无法产生更多请求（操作系统限制，在我的情况下为 OSX）。

为什么会产生这么多线程以及如何避免这种情况？我需要一个快速爬虫，它使用操作系统提供的所有资源，但不超过这个 :) 所以 2.000 个线程似乎是 OSX 的限制，所有超过这个值会让代码崩溃。

```
#!/usr/bin/env jruby

require 'celluloid'
require 'open-uri'

URLS = ["http://instagr.am/p/Clh2","http://instagr.am/p/EKpI1","http://instagr.am/p/G-PoDSS6zX","http://instagr.am/p/G5YjYMC4MW","http://instagr.am/p/G6sEojDvgy","http://instagr.am/p/G7LGzIjvMp","http://instagr.am/p/G9RQlkQAc9","http://instagr.am/p/HChQX4SMdy","http://instagr.am/p/HDRNwKojXS","http://instagr.am/p/HDjzB-RYMz","http://instagr.am/p/HDkLCGgSjX","http://instagr.am/p/HE2Xgjj0rn","http://instagr.am/p/HE5M9Lp0MC","http://instagr.am/p/HEW5I2RohI","http://instagr.am/p/HEzv41gS6m","http://instagr.am/p/HG2WCVTQwQ","http://instagr.am/p/HG5XWovFFa","http://instagr.am/p/HGwQvEiSmA","http://instagr.am/p/HH0navKTcf","http://instagr.am/p/HH2OzNQIn8","http://instagr.am/p/HH2kTskO2e","http://instagr.am/p/HH3GaNlTbd","http://instagr.am/p/HH3QbejSMF","http://instagr.am/p/HH3S17HnW5","http://instagr.am/p/HH3dQPqYmJ","http://instagr.am/p/HH3egLxVJU","http://instagr.am/p/HH3nVPS1i0","http://instagr.am/p/HH3zdlB3e-","http://instagr.am/p/HH40eevAr2","http://instagr.am/p/HH49zqInZc","http://instagr.am/p/HH4EMQNnpx","http://instagr.am/p/HH4KCKoc-7","http://instagr.am/p/HH4asXlbpp","http://instagr.am/p/HH4yNBydG2","http://instagr.am/p/HH5M5vCCWu","http://instagr.am/p/HH5MXqLQaz","http://instagr.am/p/HH5YeDpw88","http://instagr.am/p/HH5b89nlyH","http://instagr.am/p/HH61z-Fb-R","http://instagr.am/p/HH68sgJDZZ","http://instagr.am/p/HH69Tlt91p","http://instagr.am/p/HH6BwRgqe4","http://instagr.am/p/HH6E6aGS44","http://instagr.am/p/HH6EEYJgSo","http://instagr.am/p/HH6H7htWJo","http://instagr.am/p/HH6hBRzZZD","http://instagr.am/p/HH6xEExaco","http://instagr.am/p/HH6xcVscEg","http://instagr.am/p/HH70aWB1No","http://instagr.am/p/HH73nUMBMI","http://instagr.am/p/HH74ogvrX5","http://instagr.am/p/HH76mRwZnp","http://instagr.am/p/HH77CPmYE0","http://instagr.am/p/HH78hPNnzQ","http://instagr.am/p/HH7ADox4JO","http://instagr.am/p/HH7KFdOeTE","http://instagr.am/p/HH7KJNGDSG","http://instagr.am/p/HH7KJtpxyA","http://instagr.am/p/HH7KjwpM-J","http://instagr.am/p/HH7Q","http://instagr.am/p/HH7QCiqsOX","http://instagr.am/p/HH7R9er-Oq","http://instagr.am/p/HH7SoqgRYB","http://instagr.am/p/HH7YhZGA75","http://instagr.am/p/HH7aHSJd3D","http://instagr.am/p/HH7bPrMLTB","http://instagr.am/p/HH7bQUnKyn","http://instagr.am/p/HH7c2yADVv","http://instagr.am/p/HH7cEXSCTC","http://instagr.am/p/HH7dxAlxr4","http://instagr.am/p/HH7eJTwO8K","http://instagr.am/p/HH7efCKQ-0","http://instagr.am/p/HH7fczIMyr","http://instagr.am/p/HH7gVnBjad","http://instagr.am/p/HH7gYljc-0","http://instagr.am/p/HH7gYpMKH7","http://instagr.am/p/HH7hDMo_Za","http://instagr.am/p/HH7hfhighk","http://instagr.am/p/HH7hpVm92Q","http://instagr.am/p/HH7hssHUyN","http://instagr.am/p/HH7iS0on88","http://instagr.am/p/HH7j6It5zy","http://instagr.am/p/HH7j75jipU","http://instagr.am/p/HH7j76pkjl","http://instagr.am/p/HH7jMlQLaG","http://instagr.am/p/HH7kHaPbBn","http://instagr.am/p/HH7kKZopDN","http://instagr.am/p/HH7lOFkkOV","http://instagr.am/p/HH7lQtstCP","http://instagr.am/p/HH7l_Aurfu","http://instagr.am/p/HH7m0JDpOC","http://instagr.am/p/HH7m2POzdu","http://instagr.am/p/HH7mHPL0cI","http://instagr.am/p/HH7mL2BdJL","http://instagr.am/p/HH7mN3snzl","http://instagr.am/p/HH7mXJEJIt","http://instagr.am/p/HH7mZAKfdo","http://instagr.am/p/HH7mbxmSnp","http://instagr.am/p/HH7mkHIRM2","http://instagr.am/p/HH7ml5CcLM","http://instagr.am/p/HH7mnxEAJ8","http://instagr.am/p/HH7mqFk38v","http://instagr.am/p/HH7mqtAaOP","http://instagr.am/p/HH7mytlLQm","http://instagr.am/p/HH7n29K0Q1","http://instagr.am/p/HH7naXyW_g","http://instagr.am/p/HH7ncNPJOX","http://instagr.am/p/HH7ndmC0DH","http://instagr.am/p/HH7nifiLCI","http://instagr.am/p/HH7rWttci5","http://instagr.am/p/HH8--LwWs_","http://instagr.am/p/HH8-0DkaPE","http://instagr.am/p/HH8-2CLQEV","http://instagr.am/p/HH8-4gSIJo","http://instagr.am/p/HH8-4liH8g","http://instagr.am/p/HH8-5TCi2b","http://instagr.am/p/HH8-6AKI4j","http://instagr.am/p/HH8-8MtC6l","http://instagr.am/p/HH8-A-gpce","http://instagr.am/p/HH8-A-pXLv","http://instagr.am/p/HH8-BEFQb6","http://instagr.am/p/HH8-C9IxAs","http://instagr.am/p/HH8-CMRIT9","http://instagr.am/p/HH8-DMiDM3","http://instagr.am/p/HH8-Dwg_5V","http://instagr.am/p/HH8-DyHmmX","http://instagr.am/p/HH8-IEnIBo","http://instagr.am/p/HH8-KBCg0f","http://instagr.am/p/HH8-Kbm9Jb","http://instagr.am/p/HH8-LHryjV","http://instagr.am/p/HH8-LIKIXR","http://instagr.am/p/HH8-MdpM-m","http://instagr.am/p/HH8-N9pzfv","http://instagr.am/p/HH8-NbqDLG","http://instagr.am/p/HH8-NwoEwm","http://instagr.am/p/HH8-ODsfzo","http://instagr.am/p/HH8-OHE0p8","http://instagr.am/p/HH8-QFmasl","http://instagr.am/p/HH8-QaA7Rb","http://instagr.am/p/HH8-R-poCB","http://instagr.am/p/HH8-S5PDIy","http://instagr.am/p/HH8-SqHrOY","http://instagr.am/p/HH8-SzPREN","http://instagr.am/p/HH8-U1r5VK","http://instagr.am/p/HH8-UjEeXv","http://instagr.am/p/HH8-VaRadH","http://instagr.am/p/HH8-WFIPij","http://instagr.am/p/HH8-WHRwHP","http://instagr.am/p/HH8-X-SkFA","http://instagr.am/p/HH8-a5icLX","http://instagr.am/p/HH8-aSRpdn","http://instagr.am/p/HH8-aTm5g8","http://instagr.am/p/HH8-aatV6Q","http://instagr.am/p/HH8-azAmc5","http://instagr.am/p/HH8-bcLP_v","http://instagr.am/p/HH8-dGrMku","http://instagr.am/p/HH8-dKABGr","http://instagr.am/p/HH8-eFTTJ8","http://instagr.am/p/HH8-eLRwvK","http://instagr.am/p/HH8-ehmwGz","http://instagr.am/p/HH8-h-D72a","http://instagr.am/p/HH8-hhmEOT","http://instagr.am/p/HH8-ibSZTj","http://instagr.am/p/HH8-jospUb","http://instagr.am/p/HH8-kMpc2F","http://instagr.am/p/HH8-kNBmGm","http://instagr.am/p/HH8-lArilF","http://instagr.am/p/HH8-lWTDwj","http://instagr.am/p/HH8-mNnqZL","http://instagr.am/p/HH8-n4sGGS","http://instagr.am/p/HH8-n9xHbn","http://instagr.am/p/HH8-pYx3JZ","http://instagr.am/p/HH8-pppok3","http://instagr.am/p/HH8-qoy3LK","http://instagr.am/p/HH8-qvROzb","http://instagr.am/p/HH8-qytoRH","http://instagr.am/p/HH8-rOyW_y","http://instagr.am/p/HH8-s9KXi6","http://instagr.am/p/HH8-sVyS7K","http://instagr.am/p/HH8-sbnQEO","http://instagr.am/p/HH8-txJV-e","http://instagr.am/p/HH8-u0Mewa","http://instagr.am/p/HH8-u1BFJ-","http://instagr.am/p/HH8-uXBu_r","http://instagr.am/p/HH8-ujO2m1","http://instagr.am/p/HH8-v7pm7L","http://instagr.am/p/HH8-vBRADm","http://instagr.am/p/HH8-vkwQNF","http://instagr.am/p/HH8-x5R6u2","http://instagr.am/p/HH8-xArCJB","http://instagr.am/p/HH8-xOxnVQ","http://instagr.am/p/HH8-xrmqCf","http://instagr.am/p/HH8-y4Li29","http://instagr.am/p/HH8-yamwjM","http://instagr.am/p/HH802xDyEm","http://instagr.am/p/HH804Gw-Fe","http://instagr.am/p/HH804hAMqQ","http://instagr.am/p/HH805wBvVI","http://instagr.am/p/HH806SguSx","http://instagr.am/p/HH806rEtcY","http://instagr.am/p/HH809ClkbW","http://instagr.am/p/HH809kPN-5","http://instagr.am/p/HH80Cxst8p","http://instagr.am/p/HH80E3Ibo0","http://instagr.am/p/HH80ELOZpk","http://instagr.am/p/HH80EVFFIz","http://instagr.am/p/HH80FngJs0","http://instagr.am/p/HH80M0kiBG","http://instagr.am/p/HH80cKKQ_E","http://instagr.am/p/HH80gaBUzQ","http://instagr.am/p/HH80lSDT71","http://instagr.am/p/HH80mYOHwX","http://instagr.am/p/HH80nfAYsL","http://instagr.am/p/HH80pUNIO2","http://instagr.am/p/HH80sxRLtt","http://instagr.am/p/HH80vbDjj0","http://instagr.am/p/HH80w7xI-m","http://instagr.am/p/HH80wDHTN4","http://instagr.am/p/HH81-5RjEB","http://instagr.am/p/HH811fo-_e","http://instagr.am/p/HH813tkiVZ","http://instagr.am/p/HH813vkGMo","http://instagr.am/p/HH814RDHuG","http://instagr.am/p/HH814TOYiW","http://instagr.am/p/HH8179vxAg","http://instagr.am/p/HH81AwC6db","http://instagr.am/p/HH81BGyWUr","http://instagr.am/p/HH81FoFjxm","http://instagr.am/p/HH81H-IH_i","http://instagr.am/p/HH81MnoSaI","http://instagr.am/p/HH81MtN3bH","http://instagr.am/p/HH81O1Cfe7","http://instagr.am/p/HH81RprFKO","http://instagr.am/p/HH81Z2pq3V","http://instagr.am/p/HH81aCPRem","http://instagr.am/p/HH81aVTWZm","http://instagr.am/p/HH81bBo8cM","http://instagr.am/p/HH81k2xVJ4","http://instagr.am/p/HH81kERlbh","http://instagr.am/p/HH81vqHC0M","http://instagr.am/p/HH81vqyti3","http://instagr.am/p/HH81wbS-cj","http://instagr.am/p/HH81xfEjvZ","http://instagr.am/p/HH81zsrbsz","http://instagr.am/p/HH823tDEIP","http://instagr.am/p/HH823ytt2P","http://instagr.am/p/HH825MgnYc","http://instagr.am/p/HH827QrTPF","http://instagr.am/p/HH82AWzhzS","http://instagr.am/p/HH82EGE05q","http://instagr.am/p/HH82FDu8Mf","http://instagr.am/p/HH82HTmdze","http://instagr.am/p/HH82L-iG-U","http://instagr.am/p/HH82NpFsn7","http://instagr.am/p/HH82YTOqEF","http://instagr.am/p/HH82bpEdvj","http://instagr.am/p/HH82cShmmV","http://instagr.am/p/HH82czP-SU","http://instagr.am/p/HH82h9LhYy","http://instagr.am/p/HH82iizf4G","http://instagr.am/p/HH82jUw184","http://instagr.am/p/HH82mrnPeW","http://instagr.am/p/HH82t9u8Mg","http://instagr.am/p/HH82tPH1El","http://instagr.am/p/HH82wzhczs","http://instagr.am/p/HH82zzjj7W","http://instagr.am/p/HH83-3oaAb","http://instagr.am/p/HH83-AlcOq","http://instagr.am/p/HH8302rtlY","http://instagr.am/p/HH833ty-ck","http://instagr.am/p/HH834lswSl","http://instagr.am/p/HH835DFp5j","http://instagr.am/p/HH835FKCBP","http://instagr.am/p/HH835UmKXt","http://instagr.am/p/HH835qnQot","http://instagr.am/p/HH8383zIXz","http://instagr.am/p/HH8384ROzS","http://instagr.am/p/HH83AMP4a0","http://instagr.am/p/HH83B5B1Nt","http://instagr.am/p/HH83CqkA0O","http://instagr.am/p/HH83DpMRPq","http://instagr.am/p/HH83EjPNA_","http://instagr.am/p/HH83Frqolx","http://instagr.am/p/HH83KmM8EC","http://instagr.am/p/HH83RJuxBF","http://instagr.am/p/HH83WCuGEA","http://instagr.am/p/HH83XtGGIV","http://instagr.am/p/HH83ZKNcTS","http://instagr.am/p/HH83aNohKe","http://instagr.am/p/HH83bCudp9","http://instagr.am/p/HH83f0vFsx","http://instagr.am/p/HH83gsmWCm","http://instagr.am/p/HH83gyJWp5","http://instagr.am/p/HH83k0h0C3","http://instagr.am/p/HH83nDlyBo","http://instagr.am/p/HH83nSlA26","http://instagr.am/p/HH83nfnS7m","http://instagr.am/p/HH83puJ0UJ","http://instagr.am/p/HH83qGPaXH","http://instagr.am/p/HH83r9D_FK","http://instagr.am/p/HH83uAFKtr","http://instagr.am/p/HH83uJxZeV","http://instagr.am/p/HH83vcTWsX","http://instagr.am/p/HH83xtmDSU","http://instagr.am/p/HH841GGzT3","http://instagr.am/p/HH841UMarm","http://instagr.am/p/HH841VgcD4","http://instagr.am/p/HH8429HDTT","http://instagr.am/p/HH842SMBUn","http://instagr.am/p/HH842cRA6V","http://instagr.am/p/HH842nNboH","http://instagr.am/p/HH844ISVI_","http://instagr.am/p/HH844QPBbt","http://instagr.am/p/HH8460RADl","http://instagr.am/p/HH846VkDLB","http://instagr.am/p/HH846jSV9B","http://instagr.am/p/HH847YpeiM","http://instagr.am/p/HH848JoFPh","http://instagr.am/p/HH849dRQnD","http://instagr.am/p/HH84EBB-rW","http://instagr.am/p/HH84GXHQEN","http://instagr.am/p/HH84IOO6Hd","http://instagr.am/p/HH84K7vdZp","http://instagr.am/p/HH84O1vefu","http://instagr.am/p/HH84O2hj7y","http://instagr.am/p/HH84OALIqP","http://instagr.am/p/HH84PVk-tn","http://instagr.am/p/HH84RquusO","http://instagr.am/p/HH84TnhJKv","http://instagr.am/p/HH84WQH1En","http://instagr.am/p/HH84XPiGqI","http://instagr.am/p/HH84YLH5ty","http://instagr.am/p/HH84YpLGfC","http://instagr.am/p/HH84Ywvdk6","http://instagr.am/p/HH84ZdzhTA","http://instagr.am/p/HH84afzC-V","http://instagr.am/p/HH84ctJ5s1","http://instagr.am/p/HH84dTHX9F","http://instagr.am/p/HH84fXPKi5","http://instagr.am/p/HH84fhto0L","http://instagr.am/p/HH84geJyhL","http://instagr.am/p/HH84hUpz82","http://instagr.am/p/HH84iYKYQp","http://instagr.am/p/HH84kFDSyv","http://instagr.am/p/HH84nNH_1J","http://instagr.am/p/HH84o1D3Um","http://instagr.am/p/HH84ohtzcL","http://instagr.am/p/HH84pNDJcd","http://instagr.am/p/HH84pOH6TN","http://instagr.am/p/HH84pXMYZd","http://instagr.am/p/HH84qkJ0i3","http://instagr.am/p/HH84sTvixj","http://instagr.am/p/HH84tan8wH","http://instagr.am/p/HH84w1gm7Z","http://instagr.am/p/HH84yNv-z-","http://instagr.am/p/HH84zAoMEl","http://instagr.am/p/HH85-0RTj8","http://instagr.am/p/HH850YgA3T","http://instagr.am/p/HH850pPNBB","http://instagr.am/p/HH850tOWXm","http://instagr.am/p/HH851nnMar","http://instagr.am/p/HH851yhV8o","http://instagr.am/p/HH852bqPAx","http://instagr.am/p/HH852nDatV","http://instagr.am/p/HH852pxXn5","http://instagr.am/p/HH853TsOYx","http://instagr.am/p/HH854_ob--","http://instagr.am/p/HH854kL_yC","http://instagr.am/p/HH8563jp99","http://instagr.am/p/HH856HhpBi","http://instagr.am/p/HH857CEjxZ","http://instagr.am/p/HH857URkql","http://instagr.am/p/HH857UqVCN","http://instagr.am/p/HH8580SWLd","http://instagr.am/p/HH858wITqb","http://instagr.am/p/HH85AXKxP5","http://instagr.am/p/HH85CIL_yB","http://instagr.am/p/HH85CKCp4U","http://instagr.am/p/HH85DLn-09","http://instagr.am/p/HH85Dnljqy","http://instagr.am/p/HH85E0Jcj3","http://instagr.am/p/HH85EKR9fm","http://instagr.am/p/HH85EgBaHm","http://instagr.am/p/HH85ElD4b_","http://instagr.am/p/HH85HBm9f4","http://instagr.am/p/HH85HFrCl3","http://instagr.am/p/HH85JYunBd","http://instagr.am/p/HH85LVoMhr","http://instagr.am/p/HH85LWCbeC","http://instagr.am/p/HH85MKFbQt","http://instagr.am/p/HH85NJv80J","http://instagr.am/p/HH85NUvTvk","http://instagr.am/p/HH85NyufqK","http://instagr.am/p/HH85PZOR6d","http://instagr.am/p/HH85Q2M2uh","http://instagr.am/p/HH85T2Ofcs","http://instagr.am/p/HH85VUKVTZ","http://instagr.am/p/HH85VVKoly","http://instagr.am/p/HH85VdK6R1","http://instagr.am/p/HH85Vfmn0-","http://instagr.am/p/HH85VxIOrP","http://instagr.am/p/HH85WoR6Ls","http://instagr.am/p/HH85Ztrf-m","http://instagr.am/p/HH85aLrxjq","http://instagr.am/p/HH85bOR6u0","http://instagr.am/p/HH85cZLXr6","http://instagr.am/p/HH85ckD-JY","http://instagr.am/p/HH85d6JlSW","http://instagr.am/p/HH85dUwcKY","http://instagr.am/p/HH85fUuT6W","http://instagr.am/p/HH85fiAaOe","http://instagr.am/p/HH85gMJBEP","http://instagr.am/p/HH85gVFvEt","http://instagr.am/p/HH85hIveqD","http://instagr.am/p/HH85hZAKiO","http://instagr.am/p/HH85i8CyMs","http://instagr.am/p/HH85jQhUo7","http://instagr.am/p/HH85kBSD2v","http://instagr.am/p/HH85lsFy6K","http://instagr.am/p/HH85mLnJky","http://instagr.am/p/HH85oVROzU","http://instagr.am/p/HH85p9ylU4","http://instagr.am/p/HH85qENCWv","http://instagr.am/p/HH85qhNMcj","http://instagr.am/p/HH85s3N7vl","http://instagr.am/p/HH85sJSPSe","http://instagr.am/p/HH85tStObP","http://instagr.am/p/HH85txnKmv","http://instagr.am/p/HH85uAvobc","http://instagr.am/p/HH85x8rlE0","http://instagr.am/p/HH85xZuNO8","http://instagr.am/p/HH85yYQwXj","http://instagr.am/p/HH85z3wB35","http://instagr.am/p/HH86-kGL7D","http://instagr.am/p/HH860TiUwo","http://instagr.am/p/HH861PIkO2","http://instagr.am/p/HH862smvKU","http://instagr.am/p/HH863NxVJ5","http://instagr.am/p/HH863Zw3Z2","http://instagr.am/p/HH865_H-sk","http://instagr.am/p/HH865nxSRn","http://instagr.am/p/HH868cli0X","http://instagr.am/p/HH86AKRtq-","http://instagr.am/p/HH86CjRQTU","http://instagr.am/p/HH86D8sx0Q","http://instagr.am/p/HH86DqzgPd","http://instagr.am/p/HH86EkSO83","http://instagr.am/p/HH86FzO4D_","http://instagr.am/p/HH86G8MkDx","http://instagr.am/p/HH86GGwXA0","http://instagr.am/p/HH86Hwq8Nu","http://instagr.am/p/HH86HzG4HB","http://instagr.am/p/HH86HzJtHN","http://instagr.am/p/HH86IMLZYc","http://instagr.am/p/HH86IXyAMV","http://instagr.am/p/HH86IwQ8Qk","http://instagr.am/p/HH86KXQuR6","http://instagr.am/p/HH86LTkJJE","http://instagr.am/p/HH86NrLH5g","http://instagr.am/p/HH86SWRNOm","http://instagr.am/p/HH86TJI64M","http://instagr.am/p/HH86TtpBEQ","http://instagr.am/p/HH86UYKOhh","http://instagr.am/p/HH86VGlnpW","http://instagr.am/p/HH86ZfpEEw","http://instagr.am/p/HH86_NPrK2","http://instagr.am/p/HH86afDy4x","http://instagr.am/p/HH86afyFIQ","http://instagr.am/p/HH86bGLfNe","http://instagr.am/p/HH86btlKts","http://instagr.am/p/HH86c9u8Wq","http://instagr.am/p/HH86cSR3_L","http://instagr.am/p/HH86fEHdLt","http://instagr.am/p/HH86g5m-xm","http://instagr.am/p/HH86gKCqXT","http://instagr.am/p/HH86gQGfPG","http://instagr.am/p/HH86hlSkE9","http://instagr.am/p/HH86hzhSep","http://instagr.am/p/HH86inFZGd","http://instagr.am/p/HH86ipACWp","http://instagr.am/p/HH86jXw0gP","http://instagr.am/p/HH86l3lWdw","http://instagr.am/p/HH86lBIcoK","http://instagr.am/p/HH86lbyhFP","http://instagr.am/p/HH86maiG-V","http://instagr.am/p/HH86mgqMW3","http://instagr.am/p/HH86mqFBiB","http://instagr.am/p/HH86mwm5g5","http://instagr.am/p/HH86oeJWA2","http://instagr.am/p/HH86ofFMPU","http://instagr.am/p/HH86ohOsAZ","http://instagr.am/p/HH86olHu0A","http://instagr.am/p/HH86otvR1t","http://instagr.am/p/HH86pHTMXp","http://instagr.am/p/HH86qENjaU","http://instagr.am/p/HH86rtCd4L","http://instagr.am/p/HH86s0N3Ay","http://instagr.am/p/HH86sDPkW6","http://instagr.am/p/HH86tLMj5x"]

class Crawler
  include Celluloid

  def fetch(id)
    uri = URI("http://api.instagram.com/oembed?url=#{id}")
    req = open(uri).read
  end
end

URLS.each_slice(50).map do |idset|
  pool = Crawler.pool(size: 50)
  crawlers = idset.to_a.map do |id|
    begin
      pool.future(:fetch, id)
    rescue
      nil
    end
  end
  crawlers.compact.each do |resp|
    puts resp.value.size rescue nil
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T14:21:03.137

分班。维基上被告知永远不要在其中做一个工人池。

[https://github.com/celluoid/celluoid/wiki/Pools](https://github.com/celluloid/celluloid/wiki/Pools)

> Gotcha：不要在工人内部建立游泳池！
> 
> 在 MyWorker 中使用 MyWorker.pool 将导致工作线程的无限爆炸。

* * *

# 更新

如果你想限制你的池，只需在 each_slice 块之外创建它，这样你就可以使用我猜的相同线程。

```
pool = Crawler.pool(size: 50)    
URLS.each_slice(50).map do |idset|  
  crawlers = idset.to_a.map do |id|
    begin
      pool.future(:fetch, id)
    rescue
      nil
    end
  end
# ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T16:51:25.117

通过 50 的切片的每次迭代，您都会重置 pool 的值，这可能会取消引用您的 poolmanager。由于演员不会仅仅通过取消引用而被垃圾收集（你必须调用#terminate），你可能会堆积你的旧池。它*应该*可以只创建一个池，并一次创建所有期货（如果您保持返回值很小，那么未来对象本身就很小）。如果您确实发现必须进行切片，请在 each_slice 之外实例化您的池，它将继续使用同一个池，而不会每次都创建一个新池。如果出于某种其他原因您希望每次都获得一个新池，请在取消引用之前调用该池的终止。还要确保您使用的是赛璐珞 0.12.0+，因为它解决了池工作人员在池终止时没有被终止的问题。

当我围绕演员进行迭代时，我发现这一点日志记录对于确保我没有任何演员泄漏很有用：

```
logger.info "Actors left: #{Celluloid::Actor.all.to_set.length} Alive: #{Celluloid::Actor.all.to_set.reject { |a| a.nil? || !a.alive? }.length}" 
```

# python - 使用 PyMongo 通过“_id”查询不会在 Python 中返回 MongoDB 中的文件

> ID：12339583
> 
> 赞同：4
> 
> 时间：2012-09-09T13:43:40.477
> 
> 标签：python, django, mongodb, pymongo, gridfs

我在 Openshift 中使用 Python + MongoDB + PyMongo

```
import os
import gridfs
from django.http import HttpResponse
from pymongo.connection import Connection
from django.shortcuts import get_object_or_404, render_to_response
from django.http import HttpResponseRedirect, HttpResponse
from django.template import Context, RequestContext,loader

connection = Connection('mongodb://sbose78:XXXXXX@staff.mongohq.com:10068/BOSE')
db=connection['BOSE']
fs=gridfs.GridFS(db) 
```

当我通过 _id 查询文件时，这就是我得到的。

```
>>> fs.exists({"_id":'504a36d93324f20944247af2'})
False 
```

当我使用相应的文件名查询时：

```
>>> fs.exists({"filename":'foo.txt'})

True 
```

可能出了什么问题？

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-10T01:30:07.533

对于 pymongo 版本 < 2.2，您需要导入 ObjectId

```
from pymongo.objectid import ObjectId 
```

对于 2.2 及更高版本，导入是

```
from bson.objectid import ObjectId 
```

然后你可以像这样查询gridfs：

```
fs.exists(ObjectId('504a36d93324f20944247af2')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T13:49:35.850

```
fs.exists({"_id":ObjectId('504a36d93324f20944247af2')}) 
```

你需要使用`ObjectId`

# php - 可以让 PHP MYSQL 查询忽略 WHERE 子句中的空变量吗？

> ID：12339587
> 
> 赞同：7
> 
> 时间：2012-09-09T13:44:16.043
> 
> 标签：php, mysql, where-clause

不知道我该怎么做。基本上，我有使用组合框填充的变量，然后通过 where 子句传递以形成 MQSQL 查询的过滤器。我需要做的是允许用户将组合框留空，然后在 where 子句中忽略该变量。这可能吗？

即，从此代码。假设填充 $value1 的组合框为空，有什么方法可以忽略它并且只应用第二个过滤器。

```
$query = "SELECT * FROM moth_sightings WHERE user_id = '$username' AND location = '$value1' AND english_name = $value2 ";
$result = mysql_query($query) or die(mysql_error());
$r = mysql_numrows($result); 
```

谢谢你的帮助。C

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-09T13:52:04.030

采用

```
$where = "WHERE user_id = '$username'";

if(!empty($value1)){
$where .= "and location = '$value1'";
}

if(!empty($value2 )){
$where .= "and english_name= '$value2 '";
}

$query = "SELECT * FROM moth_sightings $where";
$result = mysql_query($query) or die(mysql_error());
$r = mysql_numrows($result); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-08-23T18:12:52.000

其他几个答案提到了 SQL 注入的风险，还有几个明确提到使用准备好的语句，但没有一个明确显示你可以如何做到这一点，这对初学者来说可能是一个很大的要求。

我目前解决此问题的首选方法使用 MySQL“IF”语句来检查有问题的参数是否为 null/empty/0（取决于类型）。如果它是空的，那么它将字段值与自身进行比较（`WHERE field1=field1`总是返回`true`）。如果参数不为空/null/零，则将字段值与参数进行比较。

所以这里有一个使用 MySQLi 准备好的语句的例子（假设 $mysqli 是一个已经实例化的 mysqli 对象）：

```
$sql = "SELECT * 
        FROM moth_sightings 
        WHERE user_id = ? 
            AND location = IF(? = '', location, ?)
            AND english_name = ?";
$stmt = $mysqli->prepare($sql);
$stmt->bind_param('ssss', $username, $value1, $value1, $value2);
$stmt->execute(); 
```

（我假设这`$value2`是一个基于字段名称的字符串，尽管 OP 的示例 SQL 中没有引号。）

MySQLi 中无法将同一个参数绑定到语句中的多个占位符，因此我们必须显式绑定`$value1`两次。MySQLi 在这种情况下的优势是参数的显式类型 - 如果我们`$value1`作为字符串传入，我们知道我们需要将它与空字符串进行比较`''`。如果`$value1`是整数值，我们可以像这样显式声明：

```
$stmt->bind_param('siis', $username, $value1, $value1, $value2); 
```

并将其与之进行比较`0`。

这是一个使用命名参数的 PDO 示例，因为我认为它们会产生更易读的代码和更少的计数：

```
$sql = "SELECT * 
    FROM moth_sightings 
    WHERE user_id = :user_id 
        AND location = IF(:location_id = '', location, :location_id)
        AND english_name = :name";
$stmt = $pdo->prepare($sql);
$params = [
    ':user_id' => $username,
    ':location_id' => $value1,
    ':name' => $value2
];
$stmt->execute($params); 
```

请注意，使用 PDO 命名参数，我们可以`:location_id`在查询中引用多次，而只需绑定一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T13:49:07.883

当然，

```
$sql = "";
if(!empty($value1))
  $sql = "AND location = '{$value1}' ";
if(!empty($value2))
  $sql .= "AND english_name = '{$value2}'";

$query = "SELECT * FROM moth_sightings WHERE user_id = '$username' {$sql} ";
$result = mysql_query($query) or die(mysql_error());
$r = mysql_numrows($result); 
```

注意 mysql_* 的 sql 注入和弃用，请改用 mysqli 或 PDO

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T13:49:37.633

```
if ( isset($value1) )
 $query = "SELECT * FROM moth_sightings WHERE user_id = '$username' AND location = '$value1' AND english_name = $value2 ";
else
 $query = "SELECT * FROM moth_sightings WHERE user_id = '$username' AND english_name = $value2 "; 
```

但是，您也可以创建一个函数来根据您的输入返回查询。并且不要忘记`$values`在生成查询之前转义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T13:53:00.207

1.) 不要使用简单的 mysql php 扩展，使用高级 mysqli 扩展或更安全的 PDO / MDB2 包装器。

2.）不要像那样指定完整的语句（除此之外你甚至不编码和转义给定的值......）。而是使用这样的东西：

```
sprintf("SELECT * FROM moth_sightings WHERE 1=1 AND %s", ...); 
```

然后使用包含您从表单中实际获得的所有值的数组填充该原始查询：

```
$clause=array(
  'user_id="'.$username.'"',
  'location="'.$value1.'"',
  'english_name="'.$value2.'"'
); 
```

您可以以任何方式操作此数组，例如测试空值或其他。现在只需将数组内爆以完成上面的原始问题：

```
sprintf("SELECT * FROM moth_sightings WHERE 1=1 AND %s", 
        implode(' AND ', $clause) ); 
```

大优势：即使子句数组完全为空，查询语法也是有效的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-09T13:53:33.287

首先，请阅读[SQL 注入](http://php.net/manual/en/security.database.sql-injection.php)。其次，$r = mysql_numrows($result) 应该是 $r = mysql_num_rows($result);

您可以在 MySQL 中使用 IF，如下所示：

```
SELECT * FROM moth_sightings WHERE user_id = '$username' AND IF('$value1'!='',location = '$value1',1) AND IF('$value2'!='',english_name = '$value2',1); -- BUT PLEASE READ ABOUT SQL Injections. Your code is not safe. 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-07T19:14:40.767

我想到了另外两种方法来解决这个问题：

```
SELECT * FROM moth_sightings
WHERE
      user_id = '$username'
      AND location = '%$value1%'

      AND english_name = $value2 "; 
```

这将仅返回`user_id`位置字段包含的 this 的结果`$value1`。**如果 $value1 为空**，这仍将返回 this 的所有行`user_id`，无论是否为空。

* * *

**或者**

```
SELECT * FROM moth_sightings
WHERE
      user_id = '$username'
      AND (location = '$value1' OR location IS NULL OR location = '')
      AND english_name = $value2 "; 
```

这将为您提供所有`user_id`具有`$value1`位置或具有空白值的行。

# c# - 在 Silverlight 中链接 WCF 异步方法

> ID：12339588
> 
> 赞同：0
> 
> 时间：2012-09-09T13:44:19.070
> 
> 标签：c#, wcf, silverlight, asynchronous

我正在开发一个 Silverlight 应用程序并使用 Async 方法使用 WCF 服务。但我无法让它工作。

在我的页面中，我有下面的代码。基本上我想先调用 LoginAsync 然后 GetTablesAsync 然后 GetPlayersAsync 同时我还需要调用客户端通知方法。我该如何安排？使用 Locks 还是有一种方法可以链接这些事件以确保它们能够正常运行？

```
public partial class Root : UserControl
{
    private object syncRoot = new object();
    ServiceClient client;

    ObservableCollection<Table> Tables { get; set; }
    ObservableCollection<Player> Players { get; set; }
    public Root()
    {
        InitializeComponent();

        Tables = new ObservableCollection<Table>();

        txtLogs.Text += "\n";

        client = Helpers.GetServiceClient();

        client.NotifyReceived += new EventHandler<NotifyReceivedEventArgs>(client_NotifyReceived);

        client.PublishCompleted += new EventHandler<AsyncCompletedEventArgs>(client_PublishCompleted);
        client.SubscribeCompleted += new EventHandler<AsyncCompletedEventArgs>(client_SubscribeCompleted);
        client.GetTableListCompleted += client_GetPokerTablesCompleted;

        this.Loaded += Root_Loaded;
    }

    void Root_Loaded(object sender, RoutedEventArgs e)
    {
        NewUser newUser = new NewUser();
        newUser.Closed += newUser_Closed;
        newUser.Show();
    }

    void newUser_Closed(object sender, EventArgs e)
    {
        NewUser n = sender as NewUser;
        player = new Player
        {
            PlayerName = n.txtPlayerName.Text,
        };

        lock (syncRoot)
        {

            try
            {
                client.GetTableListAsync();
            }
            catch (TimeoutException ex)
            {

            }
            catch (CommunicationException ex)
            {

            }
        }

        lock (syncRoot)
        {
            client.LoginCompleted += client_LoginCompleted;
            client.LoginAsync(player.PlayerName);
            // publish player logged in
            client.PublishAsync(String.Format("{0} is logged in", player.PlayerName));
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:03:16.837

你的意思是你要一个接一个地叫他们？您可以从 Login completed 处理程序中调用第二个（然后从处理程序中调用第三个以完成第二个等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T11:46:12.303

我发现 AsyncCTP 对于您描述的场景最有用。但是，如果您使用以下模式，则可以实现与大致 javascript 库大致相同的可读性：

```
NewUser newUser = new NewUser();
newUser.Show();
newUser.Closed += (object sender, EventArgs e) =>
{
    player = new Player
    {
        PlayerName = newUser.txtPlayerName.Text,
    };

    // you aren't going to be able to catch timeout
    // errors in async method calls
    client.GetTableListAsync();

    // we can initiate login even if TableList isn't loaded yet
    client.LoginAsync(player.PlayerName);
    client.LoginCompleted += (s2, e2) => {
        // publish player logged in
        client.PublishAsync(String.Format("{0} is logged in", player.PlayerName));
    }
} 
```

# android - 从android中的警报对话框调用AsyncTask

> ID：12339591
> 
> 赞同：1
> 
> 时间：2012-09-09T13:44:46.623
> 
> 标签：android, asynchronous, dialog, task, alert

我正在尝试`async task`在 android 中调用一个网络负载任务。

现在的问题是**我想确认点击按钮，**比如说

*   我希望用户询问他是否真的想从网络中获取数据。
*   单击按钮时，系统会询问用户是否要继续（这是通过警报对话框完成的）。
*   `alert dialog`现在异步任务在后台执行，并且从“是”确认中调用预执行。

请建议我该怎么做，因为预执行在我的实施中失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T09:48:43.467

在按钮单击事件中，添加一个侦听器（通常它将是一个 DialogInterface.OnClickListener()）。默认的 onClick() 函数将在那里。在 onClick(method) 中调用您的异步任务执行方法。

如果您有任何错误，请粘贴 LogCat 消息。那会有很大帮助。

# java - 从另一个线程向 ArrayList 添加内容

> ID：12339592
> 
> 赞同：0
> 
> 时间：2012-09-09T13:44:47.980
> 
> 标签：java

我有主线程和 ClientThread ...在主线程中，当用户连接到服务器时，它会调用 ClientThread 中的一个方法

```
 try {
        Socket socket = server.accept();
        clientThread.addClient(socket);
    } catch(Exception e) {
        e.printStackTrace();
    } 
```

ClientThread 中的方法将内容添加到 ArrayList

```
public void addClient(Socket socket) {
    clientSockets.add(socket);
} 
```

ClientThread 还在每一帧上运行此代码：

```
 for (Socket socket : clientSockets) {
            label.setText(socket.toString());
        } 
```

出于某种原因，我`java.util.ConcurrentModificationException`在这条线上得到了这个错误`for (Socket socket : clientSockets) {`......

问题：**为什么我会收到此错误，我该如何解决？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T13:49:58.533

您需要同步对 的访问`clientSockets`，因为不允许您更改`List`while 迭代它的结构。

一个简单的解决方案是创建`clientSockets`一个同步集合，然后在迭代之前显式同步它：

```
List<Socket> clientSockets = Collections.synchronizedList(new ArrayList<Socket>());

//...when setting the labels:
synchronized (clientSockets) {
    for ( Socket socket : clientSockets ) {
        label.setText(socket.toString());
    }
} 
```

无论您在哪里迭代列表，您都需要执行相同的操作。

您还可以考虑使用类似的东西`CopyOnArrayList`，它不需要您进行同步，但代价是使用更多内存并可能提供稍微陈旧的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:16:21.243

Javadoc 说“如果多个线程同时访问一个 ArrayList 实例，并且至少有一个线程在结构上修改了列表，那么它必须在外部同步。（结构修改是添加或删除一个或多个元素，或显式调整列表大小的任何操作）后备数组；仅设置元素的值不是结构修改。”。

只是设置标签不是结构修改，所以我不确定这是否是异常的原因。

# python - Windows、Linux 上的网络状态更改以及如何在 Python 中进行更改

> ID：12339594
> 
> 赞同：0
> 
> 时间：2012-09-09T13:44:58.543
> 
> 标签：python, network-programming, pyqt4

你好朋友和同事，

我正在尝试在 pyt4 上为我的程序创建一个功能 - 软电话应该确定网络计算机的状态。

如果网络失去了与 Internet 的连接，程序应该等到网络恢复并立即重新启动我的应用程序的核心，该应用程序自行连接到服务器

重新启动核心是通过“重新加载”方法完成的。

但我也想做跨平台

Windows、Linux、达尔文、

我发现类似于此链接的内容：[http ://www.themacaque.com/?p=751](http://www.themacaque.com/?p=751)

重载方法：

```
def reload(self):
    self.config = ConfigParser.RawConfigParser()
    self.config.readfp(getConfig())
    self.tray.setIcon(self.inactiveIcon)
    self.controller.core.restart_core() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T08:45:33.923

您展示的示例正在尝试使用本机实现，因为它的编写不依赖于 Qt4（我是该帖子的作者）。如果您在所有平台上使用 PyQt4 都没有问题，您应该考虑使用您可以在[QNetworkAccessManager中找到的](http://harmattan-dev.nokia.com/docs/library/html/qt4/qnetworkaccessmanager.html)[networkAccessibleChanged](http://harmattan-dev.nokia.com/docs/library/html/qt4/qnetworkaccessmanager.html#networkAccessibleChanged)信号。

如果这是不可能的，您将不得不根据您工作的平台编写要使用的同一接口的不同实现，例如：

*   Windows：使用我在博客上发布的代码。
*   Linux：您可以使用 NETworkManager 必须通知您连接状态的 DBus 信号。
*   Mac OS X：SystemConfiguration 框架作为一组类似的信号来告诉您连接的状态。

如果您的软件是开源的，并且您不关心/介意 canonical 拥有代码的版权，您可以在[此处查看](http://bazaar.launchpad.net/~ubuntuone-control-tower/ubuntu-sso-client/trunk/files/head:/ubuntu_sso/networkstate/)我们为 Ubuntu One 编写的实现。

# android - 没有网络连接

> ID：12339598
> 
> 赞同：2
> 
> 时间：2012-09-09T13:45:45.250
> 
> 标签：android

我在安卓设备上测试我的新应用程序“没有互联网连接”时遇到了这个错误，虽然我有良好的网络连接也互联网窗口提示选择浏览器来导航应用程序，我不需要这个窗口出现

显现

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.elarabygroup"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".ElarabyGroup"
            android:label="@string/title_activity_elaraby_group" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
<!-- 
        <receiver
            android:name="com.google.android.gcm.GCMBroadcastReceiver"
            android:permission="com.google.android.c2dm.permission.SEND" >
            <intent-filter>
                <action android:name="com.google.android.c2dm.intent.RECEIVE" />
                <action android:name="com.google.android.c2dm.intent.REGISTRATION" />

                <category android:name=".ElarabyGroup" />
            </intent-filter>
        </receiver>

        <service android:name=".GCMIntentService" />
        -->
    </application>

</manifest> 
```

活动

```
package com.example.elarabygroup;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.Intent;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.webkit.WebView;
import com.google.android.gcm.GCMRegistrar;

public class ElarabyGroup extends Activity {
    private String TAG;
    private String SENDER_ID = "222874571774";
    private WebView webView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_elaraby_group);
        /*
        GCMRegistrar.checkDevice(this);
        GCMRegistrar.checkManifest(this);

        final String regId = GCMRegistrar.getRegistrationId(this);
        if (regId.equals("")) {
            GCMRegistrar.register(this, SENDER_ID);
        } else {
            Log.v(TAG, "Already registered");
        }
*/
        try {

            ConnectivityManager con = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);

            if (con.getNetworkInfo(0).getState() == NetworkInfo.State.DISCONNECTED
                    || con.getNetworkInfo(1).getState() == NetworkInfo.State.DISCONNECTED) {
                AlertDialog.Builder builder = new AlertDialog.Builder(this);
                // builder.setMessage(con.getActiveNetworkInfo().getState().toString());
                builder.setMessage("No Internet connection");
                AlertDialog alert = builder.create();
                alert.show();

            }

            else

            {

                webView = (WebView) findViewById(R.id.webView1);
                webView.getSettings().setJavaScriptEnabled(true);
                webView.loadUrl("http://google.com");
            }

        } catch (Exception e) {

            AlertDialog.Builder builder = new AlertDialog.Builder(this);
            // builder.setMessage(con.getActiveNetworkInfo().getState().toString());
            builder.setMessage(e.getMessage().toString());

            AlertDialog alert = builder.create();
            /* alert.show(); */

            // String url =
            // "http://beta.elarabygroup.com/bug?bug="+e.getMessage().toString();
            String url = "http://google.com/";
            Intent i = new Intent(Intent.ACTION_VIEW);
            i.setData(Uri.parse(url));
            startActivity(i);

        }

    }

}
/*
 * @Override public boolean onCreateOptionsMenu(Menu menu) {
 * getMenuInflater().inflate(R.menu.activity_elaraby_group, menu); return true;
 * } }
 */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T07:27:15.053

首先，您需要获得许可才能知道设备是否已连接到网络。这需要在您的清单中，在元素中：

`<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />`

然后

`ConnectivityManager connec = (ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);`

```
if (connec != null && (connec.getNetworkInfo(1).getState() == NetworkInfo.State.CONNECTED) ||(connec.getNetworkInfo(0).getState() == NetworkInfo.State.CONNECTED)){ 
    //You are connected, do something online.
}else if (connec.getNetworkInfo(0).getState() == NetworkInfo.State.DISCONNECTED ||  connec.getNetworkInfo(1).getState() == NetworkInfo.State.DISCONNECTED ) {             
    //Not connected.        
    Toast.makeText(getApplicationContext(), "You must be connected to the internet", Toast.LENGTH_LONG).show();
} 
```

getNetworkInfo() 中的 1 和 0 代表 Wifi，而 3g/edge 我忘记了哪个是哪个，但我知道这段代码检查正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:05:48.750

问题在于以下情况：

```
 if (con.getNetworkInfo(0).getState() == NetworkInfo.State.DISCONNECTED
                || con.getNetworkInfo(1).getState() == NetworkInfo.State.DISCONNECTED) { 
```

Android 一次只允许您连接到一种类型的网络，并且默认情况下，只要屏幕打开，wifi 就会优先于移动数据。所以如果你打开wifi，移动网络会自动断开，当wifi关闭时，显然没有连接。

您的 if 语句所做的是“如果移动网络或 wifi 关闭，则显示错误对话框”。由于这每次都会返回 true，因此您遇到了问题。相反，请尝试使用：

```
 if (con.getNetworkInfo(0).getState() == NetworkInfo.State.DISCONNECTED
                && con.getNetworkInfo(1).getState() == NetworkInfo.State.DISCONNECTED) { 
```

# javascript - 对 Tumblr 的 API 调用没有回调

> ID：12339599
> 
> 赞同：2
> 
> 时间：2012-09-09T13:45:46.513
> 
> 标签：javascript, oauth, google-chrome-extension, tumblr

我正在制作一个 chrome 扩展，它需要获取当前用户的关注者。tumblr API 说我需要实现 oauth 并发送[此处](http://www.tumblr.com/docs/en/api/v2#blog-followers)列出的请求。我按照示例实现了 oauth，并在[此处](http://developer.chrome.com/extensions/tut_oauth.html)使用了 google 的库。

因此，结果是该`oauth.authorize`函数会运行，但`onFollowers`不会调用回调函数 ，这让我相信由于某种原因我没有收到来自 tumblr 的响应。

这是我最终得到的代码：

背景.html：

```
<html>
    <script type="text/javascript" src="chrome_ex_oauthsimple.js"></script>
    <script type="text/javascript" src="chrome_ex_oauth.js"></script>
    <script type="text/javascript" src="background.js"></script>
</html> 
```

背景.js：

```
var oauth = ChromeExOAuth.initBackgroundPage({
  'request_url' : 'POST http://www.tumblr.com/oauth/request_token',
  'authorize_url' : 'http://www.tumblr.com/oauth/authorize',
  'access_url' : 'POST http://www.tumblr.com/oauth/access_token',
  'consumer_key' : '[key provided]',
  'consumer_secret' : '[secret provided]',
  'app_name' : '[app name]'
});

var followers = null;
var baseHostname = localStorage.getItem('BaseHostname');

function onFollowers(text, xhr) {
    //parsing JSON response
}

function getFollowers() {
  oauth.authorize(function() {
    var url = "api.tumblr.com/v2/blog/"+baseHostname+"/followers";
    oauth.sendSignedRequest(url, onFollowers, {
      'parameters' : {
        'base-hostname' : baseHostname
      }
    });
  });
};

chrome.extension.onMessage.addListener(
  function(request, sender, sendResponse) {
    if (request.greeting == "getFollowers")
      console.log(baseHostname);
      getFollowers();
      sendResponse({farewell: "getFollowers function run success"});
  }); 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:13:05.713

请参阅此处： [在 Chrome 扩展中向 Tumblr 的 API 发出 POST 请求](https://stackoverflow.com/questions/10568812/making-a-post-request-to-tumblrs-api-inside-a-chrome-extension)

可能是你

> 发送签名请求

应该有相反的参数吗？第**一种方法**，比**url**？

# android - 自定义图库小部件 android

> ID：12339600
> 
> 赞同：0
> 
> 时间：2012-09-09T13:45:59.537
> 
> 标签：android, android-gallery, android-custom-view

我想创建一个与`Gallery`android中的小部件`View`相同`Gallery`的 -like ！如果我尝试使用默认`Gallery`的`Adapter`小列表`Bitmap`，它工作得很好！但是，有默认焦点`Gallery`（焦点`Bitmap`是屏幕中心的默认焦点），我不想要那个焦点！我想让我的`View`行为成为一个`Gallery`但没有`default`焦点的人！

总之，我想创建一个`Gallery`焦点`Item`可以在任何位置`Gallery`并且`Item`不会自动移动到屏幕中心的！我怎样才能做到这一点？我应该`inherit`来自`Gallery`小部件吗？或者我应该创建自己的`View`？

感谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T17:10:47.330

万一您还在等待，答案是[ViewPager](http://android-developers.blogspot.in/2011/08/horizontal-view-swiping-with-viewpager.html)。

# c# - C# 使用数据表在绑定数据网格上的 DataGridComboBoxColumn 上设置值

> ID：12339602
> 
> 赞同：1
> 
> 时间：2012-09-09T13:46:06.280
> 
> 标签：c#, datagridviewcombobox

使用 C#

使用 SQL，我使用查询结果填充数据表。

然后我创建了一个使用该数据表作为其源的数据网格。

数据网格已经配置了 DataGridViewComboBoxColumn 类型的列。

Combobox 的数据源是另一个 SQL 加载的数据表，每行有两个字符串。一个字符串是我需要的实际值，第二个字符串是用户可见字符串。

组合框使用来自第二个数据表的信息正确填充，并且值按需要工作。当我从数据表中保存数据时，我得到了组合框的正确信息。

当我尝试将保存的 SQL 信息加载回该数据网格时，问题就出现了。该值似乎没有绑定到数据表项。

数据网格定义：

```
 dgHeaders.DataSource = dtCSVHeaders;

        dgHeaders.Columns["nIndex"].Visible = false;

        if (!dgHeaders.Columns.Contains("colType"))
        {
            DataGridViewComboBoxColumn colType = new DataGridViewComboBoxColumn();
            colType.HeaderText = "DB Field";
            colType.DropDownWidth = 140;
            colType.Width = 140;
            colType.DataSource = dtFields;
            colType.DataPropertyName = "szDBField";
            colType.DisplayMember = "szVisualField";
            colType.ValueMember = "szDBField";
            colType.Name = "DB Field";
            colType.DefaultCellStyle.NullValue = "--Select--";
            dgHeaders.Columns.Add(colType);

        } 
```

首先，我尝试将列名 colType 设置为我在 dataRow 中填充的值，但这似乎不起作用。

由于我不知道如何让数据绑定工作，我决定尝试将单元格强制为我想要的值，所以我在数据加载上尝试了这个。

```
 ... SQL load

        foreach (DataRow drRow in dtLoad.Rows)
        {
            string szColumnName = drRow["szOrgColumnName"].ToString();
            string szMatchName = drRow["szMatchColumn"].ToString();
            DataRow drAdd = dtCSVHeaders.NewRow();
            drAdd["nIndex"] = nLoop;
            drAdd["szHeader"] = szColumnName;
            dtCSVHeaders.Rows.Add(drAdd);
            dgHeaders.Rows[nLoop].Cells[2].Value = szMatchName;
            nLoop++;
        } 
```

但遗憾的是，这仍然没有设置组合框的值。

我对此代码没有错误或警告。

我宁愿让数据绑定控制并做它的事情，而无需我专门为单元格设置值。但如果这是我需要做的，那就这样吧......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:16:49.437

嗯，你的代码（据我所知）看起来不错。我不知道你的“dtFields”对象到底是什么，但它应该是dataTable。我做了一个简单的例子来说明应该如何做。一探究竟：

```
public partial class Form1 : Form
{        
    public Form1()
    {
        InitializeComponent();
        dataGridView1.Columns.Add("column1", "Column name");
        dataGridView1.Columns.Add(CreateComboBox());
        //adding some rows:
        dataGridView1.Rows.Add("a");
        dataGridView1.Rows.Add("b");
    }

    private DataGridViewComboBoxColumn CreateComboBox()
    {
        DataGridViewComboBoxColumn combo = new DataGridViewComboBoxColumn();
        {
            combo.Name = "comboColumn";
            combo.HeaderText = "Selection";
            combo.DataSource = GetDataForComboBox();
            combo.DisplayMember = "Name";
            combo.ValueMember = "Id";
        }
        return combo;
    }

    private DataTable GetDataForComboBox()
    {
        //this is your method to get the data from database

        //in my exmaple I will simply add some example data:
        DataTable table = new DataTable("ExampleData");
        table.Columns.Add("Id", typeof(int));
        table.Columns.Add("Name", typeof(string));
        table.Rows.Add(1, "Name 1");
        table.Rows.Add(2, "Name 2");
        table.Rows.Add(3, "Name 3");
        return table;
    }
} 
```

此代码有效，并尝试执行相同操作，您只需从数据库中填充 dataTable。但是，如果您愿意，您只能尝试我的这个确切代码，您会看到它有效！

再见

# c# - 蓝牙 Brecham.Obex 32 英尺

> ID：12339603
> 
> 赞同：0
> 
> 时间：2012-09-09T13:46:17.787
> 
> 标签：c#, .net, 32feet

我已经阅读了 32feet 示例，它可以执行 folderListings 操作，并且我计划制作更多可以上传和下载文件的文件资源管理器，

我的问题是，我可以使用 Brecham.obex 库上传和下载包括其内容的整个文件夹吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T18:17:09.087

32feet.NET 包括基本的 OBEX 支持，但不包括文件夹列表等。但是他们的合作伙伴库 Brecham.Obex 库支持所有 OBEX 功能。见[http://alanjmcf.me.uk/thirdparty/Brecham.Obex%20library/](http://alanjmcf.me.uk/thirdparty/Brecham.Obex%20library/)

*   “该库提供非常广泛的客户端 OBEX 支持，不仅提供大多数库和应用程序支持的‘Put’操作，还提供完整的操作集：Connect、Put、Get、SetPath、Delete 和 Abort。这是通过基于会话的接口访问。..."

*   “支持 [...] 文件夹浏览服务使用的文件夹列表 XML 文档。”

另请参阅该页面中显示的 FolderExplorer2 示例。它显示文件夹浏览和下载等。

[在http://inthehand.com/files/folders/objectexchange/default.aspx](http://inthehand.com/files/folders/objectexchange/default.aspx)获取库下载

# powershell - 在代码中访问 EF 命令

> ID：12339604
> 
> 赞同：0
> 
> 时间：2012-09-09T13:46:23.377
> 
> 标签：powershell, entity-framework-4, migration

我正在寻找创建一个控制台应用程序，该应用程序使用我对数据库的更新吐出一个 sql 脚本，以便我可以在生产/测试中运行它。

有没有办法在代码中访问 powershell 命令？

所以我希望它生成我的迁移文件，然后生成一个脚本来更新相关的数据库，即产品或测试。这将作为参数传入，因此需要根据传入的参数与 prod db 或 test db 进行比较。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:55:27.357

这篇[博文展示了如何编写执行迁移的代码](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/)。代码是 C#，但如果你真的想要，你应该能够将它移植到 PowerShell。

# c - GtkTreeView - 将用户数据设置为一行

> ID：12339607
> 
> 赞同：1
> 
> 时间：2012-09-09T13:46:54.373
> 
> 标签：c, gtk, gtktreeview

有没有办法将用户数据存储在单行中`GtkTreeView`？就像它通常可以在任何具有功能的小部件上完成一样`g_object_set_data()`。我尝试存储数据，`GtkTreeIter`但它会产生

> 分段错误错误

我能想到的最好的方法就是创建一个额外的隐藏列。是不是应该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T11:39:41.573

是的，隐藏列是应该如何完成的。（`g_object_set_data()`仅适用于`GObject`- 派生类型，而`GtkTreeIter`不是一种。）

# python - 在 virtualenv 中安装 django 1.5（开发版）

> ID：12339608
> 
> 赞同：19
> 
> 时间：2012-09-09T13:46:58.260
> 
> 标签：python, django, virtualenv

我正在尝试使用 django 1.5 开始开发 Web 应用程序，但我不知道如何在其中安装 django 1.5，`virtualenv`因为 django 1.5 仍然是开发版本。

我试过安装它`easy_install`，`pip`但我得到的只是 django 1.4，因为它是官方版本。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-10-29T06:50:27.487

[Django 1.5 发布了！](https://www.djangoproject.com/weblog/2013/feb/26/15/). 要安装它，请使用：

```
pip install django 
```

要在没有 git 的情况下安装最新的开发版本，请自担风险使用：

```
pip install https://github.com/django/django/zipball/master 
```

~~[Django 1.5 Release Candidate 2 (RC2) 已发布](https://www.djangoproject.com/weblog/2013/feb/19/security/)，无需安装 git 即可使用 pip 安装：~~

 ~~```
pip install https://www.djangoproject.com/download/1.5c2/tarball/ 
```~~  ~~* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-09-09T13:50:36.643

直接来自 github 存储库。

```
pip install git+git://github.com/django/django.git@1.5b2 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-12-19T20:33:21.747

现在 github 版本是 1.6 'alpha' (atm)，要获取 1.5.x 分支，您可以：

```
pip install --upgrade git+http://github.com/django/django.git@stable/1.5.x#egg=django 
```

编辑：您可能需要`pip uninstall Django`删除以前的版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-09T13:52:27.853

[这是](https://www.djangoproject.com/download/)如何从 git 获取代码的说明。之后去你的虚拟环境

```
source ~/path/to/venv/bin/activate 
```

并转到下载的源并运行 setup.py：

```
python setup.py install 
```

现在你已经安装了最新的开发 Django。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-22T18:06:49.587

我认为这个链接可能有用：[https ://www.djangoproject.com/download/](https://www.djangoproject.com/download/)

选项1。

可以安装最新的官方版 Django：

```
pip install Django==1.6.3 
```

选项 2。

您可以试用测试版：

```
pip install https://www.djangoproject.com/download/1.7b2/tarball/ 
```

选项 3。

您可以获得最新的开发版本：

```
git clone https://github.com/django/django.git 
```~~

# mysql - 在不复制数据的情况下索引 varchars

> ID：12339613
> 
> 赞同：0
> 
> 时间：2012-09-09T13:47:17.010
> 
> 标签：mysql, database

我有以下格式的庞大数据集（约 10 亿条记录）

```
|KEY(varchar(300),UNIQE,PK)|DATA1(int)|DATA2(bool)|DATA4(varchar(10)| 
```

目前数据存储在 MySAM MYSQL 表中，但问题是关键数据（12G 表大小中的 10G）存储了两次——一次在表中，一次作为索引。（数据仅追加，表上永远不会有 UPDATE 查询）

有两个针对数据集的主要操作：

1.  contains - 简单检查是否找到密钥
2.  count - 根据数据字段的聚合（主要）功能

有没有办法只存储一次关键数据？

我的一个想法是将数据库放在一起，然后简单地创建 2-5 个字符的文件夹结构。这就是为什么分配给键“thesimon_wrote_this”的数据将存储在 fs 中的原因

```
~/data/the/sim/on_/wro/te_/thi/s.data 
```

这样，数据集将像 btree 一样运行，“包含”和数据检索功能几乎可以在 O(1) 中运行（具有明显的 HDD 限制）。

这使得备份非常容易（仅备份具有 A 属性的文件），但聚合功能变得几乎无用，因为我每次需要 grep 10 亿个文件。分配单元大小无关紧要，因为我可以调整文件结构，以便只占用 5% 的磁盘空间而不使用。

我很确定还有另一种更优雅的方法可以做到这一点，我无法谷歌搜索:)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T13:56:31.397

*考虑拥有一个固定宽度*的*整数*键，如 64 位整数，这似乎是一个非常好的主意。相比之下，存储*和*搜索 varchar 键非常慢！您仍然可以在列上添加额外的索引以`KEY`进行快速查找，但它不应该是您的主键。

# java - Java SSL 证书

> ID：12339616
> 
> 赞同：1
> 
> 时间：2012-09-09T13:47:36.600
> 
> 标签：java, security, ssl

我需要在两个桌面 Java 应用程序之间进行通信，最好的方法是使用 SSL（以防止嗅探器）。我控制客户端和服务器，所以自签名是可以的。

我的问题是是否可以通过编程方式从头开始制作和使用证书（即最终用户不必亲自做任​​何事情）。

如果这是可能的，你能给我一些指示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T17:47:47.393

> 我的问题是是否可以通过编程方式从头开始制作和使用证书（即最终用户不必亲自做任​​何事情）。

在考虑生成证书（以编程方式或非编程方式）之前，您需要决定如何验证它们。在两个桌面应用程序的上下文中，验证服务器证书的传统方法可能不适合。

证书的目的是提供一种验证远程方身份的方法，以防止中间人攻击。验证方使用它已经信任的东西进行验证；不这样做会使使用证书毫无意义。

在传统模型中（使用固定服务器），服务器证书是 PKI 的一部分，由 CA 颁发。客户端根据其信任的一组 CA 证书验证其真实性（通常使用[RFC 5280](https://www.rfc-editor.org/rfc/rfc5280)中描述的规则，并验证证书对于正在查找的主机名是否有效（如何完成取决于协议，但最好和历史实践在[RFC 6125](https://www.rfc-editor.org/rfc/rfc5280)中进行了描述）。这两个步骤都是防止 MITM 攻击所必需的。这类似于使用护照验证某人的身份：您想要检查护照是否真实并且来自您信任的权威，并且您想要检查该名称（或图片）与您正在寻找的名称（或您面前的脸）相匹配。

在两个桌面应用程序之间建立通信时，您肯定会遇到两个方面的问题：如何让客户端验证证书是由您信任的实体颁发的，并且是颁发给您要与之通信的实体的。如果您在任何一方都没有以编程方式生成证书，那么它肯定会是自签名的，如果没有其他交换方式（独立于此 SSL/TLS 通信），这将使从另一方验证其真实性变得困难。此外，桌面往往没有固定的主机名，因此基于 DNS（甚至是 IP 地址）的标识符在这种情况下可能不够用。

您需要想办法以远程方可以验证它信任它的方式发布证书，并考虑一种识别方案以确保证书属于正确的实体（这通常是证书的主题 DN 或主题备用名称扩展名）。

一旦你做出这些决定，你就可以使用[BouncyCastle](http://www.bouncycastle.org/)来`org.bouncycastle.x509.X509V3CertificateGenerator`生成你的证书（一个 X.509 v3 证书应该允许你为证书添加扩展，例如用于密钥使用目的，如果你需要的话）。[BouncyCastle wiki](http://www.bouncycastle.org/wiki/display/JA1/X.509+Public+Key+Certificate+and+Certification+Request+Generation)上有各种示例（对于 v1、v3 和/或自签名，即 Subject = Issuer）。我想说不幸的是，使用它很容易（信任的管理方面是最难的）。

如果这两个桌面应用程序实际上都是更集中的应用程序的一部分，则您可以根据应用程序中生成的证书请求 (CSR) 运行颁发此证书的服务。中央服务器将有效地运行您自己的 CA，并且您的桌面应用程序将信任该 CA。根据您组织的复杂性，有可用的工具来执行此操作，或者您也可以使用 BouncyCastle 来实现它，使用相同的类（如果您实现 CRL/OSCP 以便能够撤销证书，那就更好了）。在这种情况下，您可以让您的应用程序生成一个 CSR 并将其提交给您的中央 CA。可以使用 BouncyCastle 生成 CSR`PKCS10CertificationRequest`. 同样，您的 CA 如何使用外部信息验证 CSR 来自正确的一方，这也是一个管理问题，也许您可​​以将其与电子邮件验证方案或类似的东西联系起来。

生成证书后，您将能够使用[Java 的 JSSE](http://docs.oracle.com/javase/6/docs/technotes/guides/security/jsse/JSSERefGuide.html)作为您的 SSL/TLS 堆栈（通常使用`SSLSocket`）。您可能必须使用 custom`X509TrustManager`来实现证书验证（如果您无法使用传统的 CA 模型，则取决于您设计验证证书的方案的方式）。`check*`只要确保您不使用在他们的方法中不做任何事情的信任管理器；有很多这样的例子：在这种情况下，如果你不做任何事情来验证它们，你可能根本不使用证书（这会使连接容易受到 MITM 攻击）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:21:46.450

您可以使用基于 JCE 的解决方案和[SSLSocket、jdk6](http://java.sun.com/javase/6/docs/api/javax/net/ssl/SSLSocket.html)的文档及其实现：SSLSocketImpl。

Java SSL SSH：

您有[Jsch](http://www.jcraft.com/jsch/) lib 可以使用 SSH 协议连接到任何服务器。

SSL 的 Java 工具箱：

你有[充气城堡](http://www.bouncycastle.org)。查看他们的[资源](http://www.bouncycastle.org/resources.html)和[文档](http://www.bouncycastle.org/documentation.html)。wiki 提供了一些最新版本的[有用示例：](http://www.bouncycastle.org/wiki/display/JA1/BC+Version+2+APIs)

```
ContentSigner sigGen = ...;
PublicKey publicKey = ....;

Date startDate = new Date(System.currentTimeMillis() - 24 * 60 * 60 * 1000);
Date endDate = new Date(System.currentTimeMillis() + 365 * 24 * 60 * 60 * 1000);

X509v1CertificateBuilder v1CertGen = new JcaX509v1CertificateBuilder(
          new X500Principal("CN=Test"), 
          BigInteger.ONE, 
          startDate, endDate, 
          new X500Principal("CN=Test"), 
          publicKey);

X509CertificateHolder certHolder = v1CertGen.build(sigGen); 
```

# asp.net - 在不同参数的情况下如何定义动作？-asp.net mvc4

> ID：12339618
> 
> 赞同：1
> 
> 时间：2012-09-09T13:47:46.700
> 
> 标签：asp.net, asp.net-mvc-4

我尝试为 diff 参数定义操作，但它不起作用：

```
public class HomeController : Controller
  {
    public ActionResult Index()
    {
      return  View();
    }

    public ActionResult Index(string name)
    {
      return new JsonResult();
    }

    public ActionResult Index(string lastname)
    {
      return new JsonResult();
    }

    public ActionResult Index(string name, string lastname)
    {
      return new JsonResult();
    }
    public ActionResult Index(string id)
    {
      return new JsonResult();
    }
 } 
```

但我得到错误：

**当前对控制器类型“HomeController”的操作“Index”的请求在以下操作方法之间不明确......**

编辑：

**如果不可能，请建议最好的方法。**

谢谢，

约瑟夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:54:32.497

您可以使用以下[`ActionNameAttribute`](http://msdn.microsoft.com/en-us/library/system.web.mvc.actionnameattribute%28v=vs.108%29.aspx)属性：

```
[ActionName("ActionName")] 
```

然后，每个 Action 方法都有不同的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T13:54:55.043

当它们响应相同类型的请求（GET、POST 等）时，您不能重载操作方法。您应该有一个包含所有您需要的参数的公共方法。如果请求没有提供它们，它们将为空，您可以决定可以使用哪个重载。

对于这个单一的公共方法，您可以通过定义模型来利用默认模型绑定。

```
public class IndexModel
{
    public string Id { get; set;}
    public string Name { get; set;}
    public string LastName { get; set;}
} 
```

这是您的控制器的外观：

```
public class HomeController : Controller
{
    public ActionResult Index(IndexModel model)
    {
        //do something here
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T13:56:20.863

这两者不能在一起，因为编译器无法区分它们。重命名它们或删除一个，或者添加一个额外的参数。这适用于所有课程。

```
public ActionResult Index(string name) 
{ 
  return new JsonResult(); 
} 

public ActionResult Index(string lastname) 
{ 
  return new JsonResult(); 
} 
```

尝试使用具有默认参数的单个方法：

```
 public ActionResult Index(int? id, string name = null, string lastName = null)
    {
        if (id.HasValue)
        {
            return new JsonResult();
        }

        if (name != null || lastName != null)
        {
            return new JsonResult();
        }

        return View();
    } 
```

或者

```
 public ActionResult Index(int id = 0, string name = null, string lastName = null)
    {
        if (id > 0)
        {
            return new JsonResult();
        }

        if (name != null || lastName != null)
        {
            return new JsonResult();
        }

        return View();
    } 
```

# php - 使用 php 中的 dropbox api 在 Dropbox 中上传图像文件

> ID：12339630
> 
> 赞同：1
> 
> 时间：2012-09-09T13:49:23.097
> 
> 标签：php, dropbox-api

如何使用 CodeIgniter 的 Jimscode PHP Dropbox 组件将图像文件上传到 Dropbox？它使用`add()`上传文件的方法。它成功地将所有其他文件类型（例如 pdf）上传到 Dropbox。但是当我上传图像文件时，它会将空文件上传到 Dropbox。那是 0 字节，无法在 Dropbox 中预览该图像。我的代码：

```
public function add($dbpath, $filepath, array $params = array(), $root=self::DEFAULT_ROOT)
    {
        $dbpath = str_replace(' ', '%20', $dbpath);
        $filename = rawurlencode($filepath);
        $parstr = empty($params) ? '' : '&'.http_build_query($params);
        $uri = "/files_put/{$root}/{$dbpath}?file={$filename}{$parstr}";
        //$uri = reduce_double_slashes("/files/{$root}/{$dbpath}?file={$filename}{$parstr}");
        $specialhost = 'api-content.dropbox.com';
        return $this->_post_request($uri, array('file'=>'@'.$filepath), $specialhost);
    } 
```

有没有可以直接与 curl 和 PHP 一起使用的 API 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T04:25:35.003

我不确定您使用的是什么版本，但 reduce_double_slashes 行没有正常注释掉。这不会导致某些文件类型上传，但不会导致其他文件类型上传。是单张图片失败还是每张图片都上传失败。

您还可以将库中的 DEBUG const 设置为 true 并将调试信息写入错误日志。这可能会帮助您找出问题出在哪里。

# android - Android 游戏开发：帧率和碰撞

> ID：12339636
> 
> 赞同：1
> 
> 时间：2012-09-09T13:49:37.023
> 
> 标签：android, collision-detection, frame-rate

我创建了一个简单的碰撞检测脚本，它的工作方式是：当英雄和物体之间的距离为 x 像素时，英雄可以“走”x 像素，而他不会与物体发生碰撞（英雄 + 3px =没有碰撞）他移动了 5 个像素。但是我还必须考虑帧率，因此将他的速度乘以经过的时间/20 我的问题是，当某个时间的帧率非常低或高时，他只会移动一个额外的像素（1px）......机会是非常小，但它仍然可能发生。那么我能做些什么来防止这种情况呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:13:52.063

在碰撞后检查的末尾添加位置校正或在碰撞前检查的末尾添加速度校正。

碰撞后：物体被平移回碰撞点。

预碰撞：物体速度会暂时改变，因此在下一帧中它将处于碰撞点。

例子：

*   您的对象移动 75 个像素并穿过墙壁。该怎么办？您需要 1-iteration-back 的位置历史记录。查看历史，您会看到它实际上是在墙后面，然后是当前位置-->它现在经过墙 xx 像素。然后，您将在壁画旁边设置它的新位置`before`。
*   您无法知道它何时会落后于您的 android：需要更好的算法使其独立于 fps。如何？您可能只是暂停整个世界，直到 fps 再次稳定，或者在绘画之前存储接下来的几次迭代，然后在绘画之前计算事物。

# javascript - 搜索结果 - 拖放

> ID：12339639
> 
> 赞同：0
> 
> 时间：2012-09-09T13:49:54.720
> 
> 标签：javascript, html, drag-and-drop, textarea

我正在尝试开发一个应用程序，当我使用拖放功能搜索某些内容时，我可以使用它来保存我获得的所有链接。我试图通过坚持使用 HTML、JavaScript 来保持简单。

为了让我在 Google 中搜索时更清楚，我可以将 url 拖到文本区域中，但文本不附带它。请忽略我的无知和帮助！

谢谢迪亚斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T08:09:04.217

如果你用你想要的元素填充一个 div，你可以使用许多框架来简化拖放操作。看看这些链接以获得一些灵感：

[http://demos.kendoui.c​​om/web/dragdrop/events.html](http://demos.kendoui.com/web/dragdrop/events.html)

[http://www.sencha.com/products/extjs/examples/#sample-9](http://www.sencha.com/products/extjs/examples/#sample-9)

[http://jqueryui.com/demos/draggable/](http://jqueryui.com/demos/draggable/)

# php - 替换字符串中字符的位置

> ID：12339642
> 
> 赞同：2
> 
> 时间：2012-09-09T13:50:22.383
> 
> 标签：php

在 PHP 中，如何用`X`so替换字符串`string`的第二个和第三个字符`sXXing`？

字符串的长度将固定为六个字符。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T14:17:20.127

这取决于你在做什么。

在大多数情况下，您将使用：

```
$string = "string";
$string[1] = "X";
$string[2] = "X"; 
```

这会将 $string 设置为“sXXing”，以及

```
 substr_replace('string', 'XX', 1, 2); 
```

但是如果你想要一种完美的方式来进行这样的剪辑，你应该知道编码。

如果你的 $string 是我很喜欢重庆，你的输出将是“�XX 很喜欢”而不是“我 XX 欢重庆”。

避免编码问题的“完美”方法是使用[PHP MultiByte String extension](http://php.net/manual/en/book.mbstring.php)。

还有一个自定义的 mb_substr_replace 因为它尚未实现：

```
function mb_substr_replace($output, $replace, $posOpen, $posClose) {
    return mb_substr($output, 0, $posOpen) . $replace . mb_substr($output, $posClose + 1);
} 
```

然后，代码：

```
echo mb_substr_replace('我很喜欢重庆', 'XX', 1, 2); 
```

会告诉你我XX欢重庆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T13:55:21.383

简单的：

```
<?php
$str = "string";
$str[1] = $str[2] = "X";
echo $str;
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T10:29:25.570

```
function mb_substr_replace($string, $replacement, $start, $length=0)
{
    return mb_substr($string, 0, $start) . $replacement . mb_substr($string, $start+$length);
} 
```

与上面相同，但标准化为更像**substr_replace**（*-substr-*函数通常取*长度*，而不是结束位置）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-09T13:58:06.820

对于替换，使用函数

```
$str    = 'bar';
$str[1] = 'A';
echo $str; // prints bAr 
```

或者您可以将库函数 substr_replace 用作：

```
$str = substr_replace($str,$char,$pos,1); 
```

同样对于第三名

# css - MIME 类型和服务 svg 的问题：资源解释为 Image 但使用 MIME 类型 text/xml 传输

> ID：12339643
> 
> 赞同：1
> 
> 时间：2012-09-09T13:50:27.167
> 
> 标签：css, apache, .htaccess, svg, mime-types

我的目标是一些带有 CSS 的 SVG 图像用作一些元素的背景，并遇到一些奇怪的问题。[直接转到图像](http://www.thememoirproject.net/tiles/images/frames/frame-2.svg)时它工作正常，但是在 CSS 中使用时出现以下错误：

`Resource interpreted as Image but transferred with MIME type text/xml`

我已将 .htaccess 文件添加到使用以下代码提供图像的目录中，但它没有帮助：

```
AddType image/svg+xml svg 
```

建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:09:50.527

可能的解释是，以前 HTTP 标头指定了错误的内容类型，现在您已修复它，某些软件使用了缓存信息。（在使用 XML 文件时并不罕见。）检查的简单方法是创建 .svg 文件的副本并在 CSS 中使用新名称引用它。

当我测试您在简单`background`规则中提供的 URL 时，图像在 Firefox、IE、Chrome、Safari 上显示没有问题（在 Win 7 上测试）。但是当我测试它以便`Content-Type: text/xml`由服务器发送时，所有浏览器根本不显示背景图像；没有显示错误信息。所以我想你用一些特殊的浏览器或特殊的设置进行了测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-05T07:45:23.030

更新 .htaccess 对我不起作用。我添加了以下行`/etc/mime.types`并重新启动了 apache 服务器，清除了缓存并且它工作了。

```
image/svg+xml                   svg 
```

# java - 为什么自动完成不适用于 JSON 和 SPRING MVC

> ID：12339647
> 
> 赞同：0
> 
> 时间：2012-09-09T13:50:46.800
> 
> 标签：java, jquery, json, spring

我很困惑为什么自动完成不起作用。下面是 .jsp 代码中的表单：

```
<form:form method="post" action="save.html" modelAttribute="word">
    <table>
        <tr>
            <th>German word</th>
            <td><form:input path="german" id="german" /></td>
        </tr>
        <tr>
            <td colspan="2"><input type="submit" value="Save" /></td>
        </tr>
    </table>
    <br />
</form:form> 
```

这是 javascript 函数（在同一个 .jsp 文件中）

```
$(document).ready(function() { 
$( "#german" ).autocomplete({
    source: '${pageContext. request. contextPath}/get_word_list.html'
}); 
```

});

这是控制器的相关部分：

```
@Autowired
private WordService wordService;

@RequestMapping(value = "/goToDictionary", method = RequestMethod.GET)
public ModelAndView index() {

    Word word = new Word();
    return new ModelAndView("dictionary", "word", word);
}

@RequestMapping(value = "/get_word_list", method = RequestMethod.GET, headers = "Accept=*/*")
public @ResponseBody
List<String> getCountryList(@RequestParam("term") String query) {
    System.out.println(query);
    return getMatch(query);
}

public List<String> getMatch(String query) {
    query = query.toLowerCase();
    List<String> matched = new ArrayList<String>();
    for (Word v : wordService.getAllWord()) {
        if (v.getGerman().toLowerCase().startsWith(query)) {
            matched.add(v.getGerman());
        }
    }
    return matched;
} 
```

我确定 getMatch(String query) 被调用并正常工作。所以我想问题出在jsp上。文件

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T20:20:59.697

好的，我找到了解决方案。它在 spring-servlet.xml 文件中。它没有用，因为我没有添加这个。

```
xsi:schemaLocation="ttp://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd"> 
```

我添加了，现在一切正常

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:02:51.520

[对于 JSON 填充列表] 也许你应该看一下注解的`produces`属性。`@RequestMapping`它需要一个 String[] 作为值。从 Spring 3.1.x 版本开始可用。我目前使用的是 3.1.2，我可以`application/json`毫无问题地得到一些。

当然，您应该将产品添加到您所在国家/地区列表的数据提供者中。

[为 JavaScript 填写列表] 也许是 ${pageContext. 要求。contextPath} 未正确评估。您是否检查过您的 JSP 生成的代码，例如使用 Firebug。

# r - 为什么 `vapply` 比 `sapply` 更安全？

> ID：12339650
> 
> 赞同：86
> 
> 时间：2012-09-09T13:51:11.273
> 
> 标签：r, apply, r-faq

文件说

> `vapply`类似于`sapply`，但具有预先指定的返回值类型，因此使用起来更安全[...]。

您能否详细说明为什么它通常更安全，也许提供示例？

* * *

PS：我知道答案，我已经倾向于避免`sapply`。我只是希望这里有一个很好的答案，所以我可以向我的同事指出它。请不要“阅读手册”答案。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-09-09T16:41:48.843

如前所述，`vapply`做两件事：

*   速度略有提升
*   通过提供有限的返回类型检查来提高一致性。

第二点是更大的优势，因为它有助于在错误发生之前捕获错误并导致更健壮的代码。这种返回值检查可以通过使用来单独完成`sapply`，`stopifnot`以确保返回值与您的预期一致，但`vapply`更容易一些（如果更有限，因为自定义错误检查代码可以检查范围内的值等。 ）。

`vapply`这是确保您的结果符合预期的示例。这与我在 PDF 抓取时正在做的事情相似，其中`findD`将使用[正则表达式](/questions/tagged/regex "显示标记为“正则表达式”的问题")来匹配原始文本数据中的模式（例如，我有一个`split`由实体组成的列表，以及一个正则表达式来匹配每个实体中的地址。偶尔PDF 已被乱序转换，一个实体将有两个地址，这导致了错误）。

```
> input1 <- list( letters[1:5], letters[3:12], letters[c(5,2,4,7,1)] )
> input2 <- list( letters[1:5], letters[3:12], letters[c(2,5,4,7,15,4)] )
> findD <- function(x) x[x=="d"]
> sapply(input1, findD )
[1] "d" "d" "d"
> sapply(input2, findD )
[[1]]
[1] "d"

[[2]]
[1] "d"

[[3]]
[1] "d" "d"

> vapply(input1, findD, "" )
[1] "d" "d" "d"
> vapply(input2, findD, "" )
Error in vapply(input2, findD, "") : values must be length 1,
 but FUN(X[[3]]) result is length 2 
```

因为 input2 的第三个元素中有两个 d，所以 vapply 会产生错误。但是 sapply 将输出的类从字符向量更改为列表，这可能会破坏下游代码。

正如我告诉我的学生，成为程序员的一部分是将你的思维模式从“错误很烦人”转变为“错误是我的朋友”。

**零长度输入**
与此相关的一点是，如果输入长度为零，`sapply`则无论输入类型如何，都将始终返回一个空列表。比较：

```
sapply(1:5, identity)
## [1] 1 2 3 4 5
sapply(integer(), identity)
## list()    
vapply(1:5, identity, integer(1))
## [1] 1 2 3 4 5
vapply(integer(), identity, integer(1))
## integer(0) 
```

使用`vapply`，您可以保证具有特定类型的输出，因此您不需要为零长度输入编写额外的检查。

**基准**

`vapply`可以更快一点，因为它已经知道它应该期望结果的格式。

```
input1.long <- rep(input1,10000)

library(microbenchmark)
m <- microbenchmark(
  sapply(input1.long, findD ),
  vapply(input1.long, findD, "" )
)
library(ggplot2)
library(taRifx) # autoplot.microbenchmark is moving to the microbenchmark package in the next release so this should be unnecessary soon
autoplot(m) 
```

![自动绘图](../Images/ecd0817f4a2bd28699df48a2baea6fe2.png)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-09T18:05:47.700

所涉及的额外击键`vapply`可以节省您稍后调试令人困惑的结果的时间。如果您调用的函数可以返回不同的数据类型，`vapply`那么当然应该使用。

想到的一个例子是`sqlQuery`在`RODBC`包装中。如果执行查询时出错，此函数将返回`character`带有消息的向量。因此，例如，假设您尝试遍历表名向量`tnames`并从每个表中的数字列“NumCol”中选择最大值：

```
sapply(tnames, 
   function(tname) sqlQuery(cnxn, paste("SELECT MAX(NumCol) FROM", tname))[[1]]) 
```

如果所有表名都有效，这将产生一个`numeric`向量。但是如果其中一个表名在数据库中发生更改并且查询失败，则结果将被强制转换为 mode `character`。但是，使用`vapply`with`FUN.VALUE=numeric(1)`将在此处停止错误并防止它在某个地方弹出——或者更糟，根本不会。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-09-09T15:29:11.503

如果你总是希望你的结果是特别的……例如一个逻辑向量。 `vapply`确保发生这种情况，但`sapply`不一定这样做。

```
a<-vapply(NULL, is.factor, FUN.VALUE=logical(1))
b<-sapply(NULL, is.factor)

is.logical(a)
is.logical(b) 
```

# c++ - 新的定义

> ID：12339652
> 
> 赞同：1
> 
> 时间：2012-09-09T13:51:47.860
> 
> 标签：c++, memory, memory-leaks, detect

今天，我找到了一个关于内存泄漏检测的源代码，在他的头文件中，我找到了以下宏定义，有人能告诉我这是什么意思吗？谢谢！

```
#ifndef MC_NO_REDEFINITION
    #define new MC_NEW
    #define MC_NEW new(__FILE__,__FUNCTION__,__LINE__)
        #define mc_new new
else
//use defined function name instead of keyword new & delete
    #define debug_new new(__FILE__,__FUNCTION__,__LINE__)
#endif 
```

这意味着，new 表示`new(__FILE__,__FUNCTION__,__LINE__)`，如果这是真的，当我在代码中使用 new 时，编译器如何知道我真正想要调用的内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T14:00:36.777

提供这些宏的相同代码还必须提供适当的全局定义，该定义`operator new()`采用适当的附加参数，例如：

```
void * operator new(std::size_t n, char const * file, char const * func, char const * line)
{
    // log file, func, line

    return operator new(n);
} 
```

也应该有一个匹配的`operator delete()`。

请注意，这`new`是一个关键字，我认为用宏替换关键字实际上是不被标准所宽恕的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T16:30:37.467

> 注意 new 是一个关键字，我认为用宏替换关键字实际上是不被标准宽恕的。

绝对正确。它会导致未定义的行为。这是不应模仿的 Microsoft hack。

# javascript - Javascript哈希表与关联数组

> ID：12339653
> 
> 赞同：1
> 
> 时间：2012-09-09T13:51:55.923
> 
> 标签：javascript, arrays, hashtable, associative

我是 javascript 新手，我无法找到有关某些问题的答案，一个是：

当我们可以将对象用作易于使用且性能非常好的关联数组时，为什么在 js 中哈希表数据结构会很有用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:48:00.760

> 当我们可以将对象用作易于使用且性能非常好的关联数组时，为什么在 js 中哈希表数据结构会很有用？

我可以想象实现哈希表数据结构的唯一原因是如果您想保留元素的顺序。对象的`for…in`循环并不能向您保证属性（“键”）的返回顺序，即使您通常可以按时间顺序（最后添加，最后返回）获取它们。但这不是保证。例如，旧版本的 Opera 以明显随机的顺序返回属性。所以，如果你需要一个“有序”的哈希表，你需要自己去实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:06:52.610

javascript 哈希表和 javascript 关联数组（和 javascript 对象）在下划线实现中都是一样的。这些只是不同的语法。

所以 ：

```
var a = {};
a.id = "aa"; 
```

等同于：

```
var a = new Object();
a.id = "aa"; 
```

这与以下内容相同：

```
var a = {};
a["id"] = "aa"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-04T22:35:13.403

关联数组和哈希表是一样的。
这些表达式通常也具有相同的含义：字典、关联数组、hashmap、map、hashtable 和……不胜枚举。

不过，简单的 ARRAY 和 HASHTABLE 之间是有区别的。如果要搜索数组中的项目，其中的项目越多，搜索所需的时间就越长。例如，在具有 10000 个元素的数组中搜索项目可能比在具有 100 个元素的数组中花费的时间长 100 倍。使用哈希表，无论您有多少元素，性能都保持不变。（无论是 100 个元素还是 99999999 个元素......）

# mysql - phpmyadmin，如何替换所有表中的字符？

> ID：12339655
> 
> 赞同：2
> 
> 时间：2012-09-09T13:52:00.583
> 
> 标签：mysql, phpmyadmin

我需要替换一个字符，假设在我的数据库所有表的所有行中，所有“a”都应该替换为“b”。

有没有办法在 phpmyadmin 中做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T13:54:59.997

尝试使用**[`Replace()`](http://dev.mysql.com/doc/refman/5.0/en/replace.html)**函数，示例

```
UPDATE tableName
SET colName = Replace(colName, 'a', 'b') 
```

顺便说一句，`replace`是区分大小写的。

# java - 为 Swing 桌面应用程序制作 jar 时将资源放在哪里？

> ID：12339664
> 
> 赞同：1
> 
> 时间：2012-09-09T13:53:34.083
> 
> 标签：java, swing, embedded-resource, executable-jar

我想知道我应该在哪里保存我的资源，比如显示一些图像，播放一些媒体文件，同时制作可执行的 jar？我应该将它包含在可执行 jar 中还是应该保留在可执行 jar 之外？

如果我将资源保留在 jar 之外，我应该在程序中传递什么 URL 位置 URL 来访问图像？

实际上问题是我想制作我的 jar 文件的可分发副本。

如果我提供本地系统的位置以访问图像和媒体文件，它将在我的系统中工作，但是当我将它分发到其他系统时会怎样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T14:03:51.600

这取决于您的应用程序。

您可以将资源打包到 jar 中。通常，它适用于永远不会更改的资源：公司徽标、图标等。您可以使用`getClass().getResourceAsStream()`.

其他解决方案是从服务器下载文件（例如通过 HTTP）。此解决方案适用于您不想与应用程序打包在一起的媒体。例如，您要播放给用户的视频剪辑。或者，可能是上一个示例中的本地化图标或多语言应用程序的本地化消息。

您正在下载的资源可以被缓存。您可以使用用户的临时目录 ( `System.getProperty("java.io.tmpdir")`) 或有时使用[首选项 API](http://docs.oracle.com/javase/1.4.2/docs/guide/lang/preferences.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T14:05:17.803

这不是一个激进的答案，但本质上，您可以为图像、属性等（甚至媒体）创建一个资源项目。

然后，您可以将您的资源项目（以下称为“MyProjectWsResources”）作为子项目添加到您的代码项目（以下称为“MyProjectWsClient”）。由于 MyProjectWsResources 位于 MyProjectWsClient 的构建路径中，因此可以更轻松地引用您的资源。如果您不清楚将某些内容放入项目的构建路径需要什么，那么当它引用信息时，MyProjectWsResources 的 src 文件夹中的任何内容都在 MyProjectWsClient 中（只要您不使用绝对路径:)）

为什么要采用多个项目的方法？IMO，它将代码与资源分开，因此您可以单独下载资源和代码，并且当您的代码仅更新时，您的客户无需重复下载资源项目（我觉得代码更新比资源更新更频繁）。较小的服务器带宽（如果您使用 Java WS 或任何其他我现在意识到您可能不是的打包/系统很重要）.. 仍然希望这会有所帮助:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-09T23:36:28.807

> 我想制作我的 jar 文件的可分发副本。

拳头，我将解决您问题中唯一*不是*问题的句子。

通过单击网络上的链接将 Swing 桌面应用程序分发给多个用户的一种好方法是 [Java Web Start](https://stackoverflow.com/tags/java-web-start/info)。

使用 JWS 部署意味着资源需要在 Jar 中。为了获得 JWS 的“自动更新”性质的最佳结果，媒体的 Jar 将是：

*   从单独的沙盒扩展中引用，以便它们可以与其他应用程序共享，并单独和延迟加载/更新（根据需要）。
*   压缩：
    *   未压缩，用于视频、声音和图像
    *   压缩文本信息（HTML、RTF、CSV..）
*   在 Jar 中放入应用程序已知的路径。（例如`/resources/video/vidNNN.mp4`）

Jars 中的资源是[嵌入式资源](/questions/tagged/embedded-resource "显示标记为“嵌入式资源”的问题")，必须通过 URL 访问（或`InputStream`如 Alex 所述，但 URL 更健壮）。引用[信息。页](https://stackoverflow.com/tags/embedded-resource/info)。

```
URL urlToResource = this.getClass().getResource("/path/to/the.resource"); 
```

在开发过程中，通常最好安排一个构建，以最终用户获取资源的相同方式组装资源 - 构建应用程序。每次运行。

在其他情况下，您可能希望将资源留在服务器上的公共位置并根据需要访问它们，但这实际上使服务器成为运行应用程序的媒体相关部分所必需的。您的资源似乎既是静态的（用户不会更改它们）又是“应用程序资源”。

# zend-framework - Zend 框架：模型、映射器；映射器中的默认字段和模型中的字段操作？

> ID：12339665
> 
> 赞同：5
> 
> 时间：2012-09-09T13:53:36.857
> 
> 标签：zend-framework, orm, model, datamapper

我正在 Zend Framework 中创建一个简单的 ORM，以使用 DbTable/Mapper/Model 方法粗略地封装一个公共库应用程序。不过，我不确定我执行与用户相关的课程的方式是否正确，因为我`Mapper_User`在`Model_User`.

## 映射器_用户

```
<?php
class Mapper_Users {

/*
createModelObject would be called by a Controller handling a Form_Regsiter's
data, to create a new Model_User object. This object'd then be saved by the
same Controller by calling Mapper_Users->save();
*/
    public function createModelObject(array $fields) {
        if(!isset($fields['date_registered']))
            $fields['date_registered'] = date('Y-m-d H:i:s');
        if(!isset($fields['max_concurrent_rentals']))
            $fields['max_concurrent_rentals'] = 3;
        return new Model_User($fields);
    }
}
?> 
```

`Model_User`在从头开始创建新对象的方法中（例如，不是从数据库中提取记录，而是注册一个新用户），我`Model_User`使用表单提供的名称/用户名/密码实例化一个新对象，然后设置一些对象属性例如注册日期，“一次允许的最大书籍”等。该数据由 填充在`Model_User`中，然后在被调用`Mapper_User`时写入数据库。`Mapper_User->save();`Mapper 感觉是适合这个的地方 - 保持模型轻。

*这是正确的，还是应该在内部设置这样的默认字段`Model_User`？*

## 模型_用户

```
<?php
class Model_User {

    public function setPassword($value) {
        $this->password = md5($value);
    }
}
?> 
```

`Model_User->setPassword($value);`在设置用户对象的密码时，正如您所料，我在 中执行此操作，并`$this->password = md5($value);`在此方法中执行此操作。再一次，这感觉是对的 - 如果从数据库中提取一个，尝试在`Mapper_User->save();`方法中执行 md5 步骤会导致问题`Model_User`，因为密码字段显然已经被散列。

*这就是我产生困惑的地方*。在我看来，与“与用户有关的字段”有关的所有逻辑都应该存在于它的模型或映射器中，但这里我在映射器中有一些逻辑（默认字段），还有一些（字段操作）在模型。*这是正确的，还是我应该尝试以某种方式获取模型中的默认字段或映射器中的字段操作？*

感谢您抽时间阅读！

* * *

编辑@RockyFord：

`Mapper_User` *实际上*扩展了我写的摘要，因为我不喜欢在 500 个`Mapper_*.php`文件中编写相同的基本代码，因此有一些官僚作风，但它的*有效*__construct() 非常简单：

```
<?php
class Mapper_Users {

    public function __construct() {
        $this->_db = new DbTable_Users();
        if(!$this->_db instanceof Zend_Db_Table_Abstract)
            throw new Exception('Invalid table data gateway provided');
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T15:25:09.297

这可能需要一段时间才能完全回答，但我将从这个`setPassword`问题开始。

您当前的：

```
public function setPassword($value) {
        $this->password = md5($value);
    } 
```

现在，这与惯例或最佳实践无关，而是实用性。

问你自己：

*当您检索用户对象的数据库记录并且该数据库记录包含散列密码时会发生什么？*

**回答：**当您构造用户对象并调用`$this->setPassword($password);`或等效时，您将哈希应用于哈希。

因此，您几乎有义务在映射器的 save() 方法或用于更新密码的方法中对密码进行哈希处理。将数据库表中的哈希值视为密码，将输入表单字段的值视为该密码的占位符。

**下一部分：**

> *在我看来，与“与用户有关的字段”有关的所有逻辑都应该存在于其模型或映射器中*

这大多是正确的。

属于对象域 (Model_User) 的所有内容***都应***在域模型类 (Model_User) 中进行处理。

映射器仅将数据对象（*数据库行、json 字符串、xml 文件、平面文件、csv 文件 ... ）转换（**映射*）为可以实例化域对象 (Model_User) 的表单。

 *因此，您最终可能会得到一个以上的映射器可用于给定的域对象，或者一个映射器可能会映射到一个以上的数据源。

*如果您不再将数据视为“字段”，这可能会对您有所帮助，这可能会使您的头脑停留在数据库中，而是根据属性*或*特征*来考虑您的对象。

因为当你深入到最基本的层次时，一个`Model_User`对象就是：

```
class Model_User {
    protected $id;
    protected $name;
    protected $password;
    //continue....
} 
```

所有的 getter、setter、构造函数和其他方法都差不多，所以我们可以将值放入这些变量中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T15:28:58.390

The `DataMapper` is responsible for populating the object with its data, as well as persisting it. It seems like you're mixing things when you call `$user->save()` because you're putting persistence logic within your domain object. This is a common approach when you're using the `ActiveRecord` pattern instead of `DataMappers`, which is a bad thing.

Your `DataMapper` should be responsible for saving the object `$mapper->save($user);` and it needs to update just the changed properties. So, the password will be updated only if you set the new hash.

## UPDATE:

You said:

> [...] trying to do the md5 step in `Mapper_User->save();` method would cause issues if the `Model_User` were one pulled from the DB, as the password field would clearly already be hashed.

Creates a method called `setPasswordHash()` and use it when pulling from the database.

> Remember: [Don't look for things!](http://www.youtube.com/watch?v=RlfLCWKxHJ0)

Instead of looking for the database inside your mappers, you should ask for it.

```
public __construct(Zend_Db_Table $dbTable) {
    $this->dbTable = $dbTable;
} 
```

It's all about Dependency Injection.*

# javascript - 如何更改所选文本的颜色？

> ID：12339667
> 
> 赞同：8
> 
> 时间：2012-09-09T13:53:45.173
> 
> 标签：javascript, codemirror

我需要使用 codemirror 更改所选文本的背景颜色。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-09-07T07:55:29.920

上面的答案缺少必要的`!important`。你需要：

```
.CodeMirror-selected {background-color: #CCCCCC !important;} 
```

如果您还需要更改选择前景色，CodeMirror 有[插件`mark-selection.js`来](https://codemirror.net/addon/selection/mark-selection.js)实现。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-06T14:46:04.747

更改 .CodeMirror-selected {} 的背景颜色，该类位于 codemirror.css

```
.CodeMirror-selected {background:#CCCCCC;} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-03-14T12:59:11.183

我能够通过覆盖特定于 CodeMirror 主题的突出显示颜色来解决这个问题：

```
/** OVERRIDE SELECTED TEXT HIGHLIGHT COLOR FOR THEMES: **/

    /* isotope theme */
    .cm-s-isotope div.CodeMirror-selected {
        background: #0004FF !important;
    }
    /* colorforth theme */
    .cm-s-colorforth div.CodeMirror-selected {
        background: #0004FF !important;
    }
    /* 3024-night theme */
    .cm-s-3024-night div.CodeMirror-selected {
        background: #0004FF !important;
    }

/** - - - - - **/ 
```

此解决方案适用于 AngularJS 版本的 CodeMirror。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-15T22:43:23.037

您需要导入`mark-selection`添加并设置自定义背景颜色。

1.  导入'codemirror/addon/selection/mark-selection'；
2.  如果您需要将背景颜色重置为默认浏览器行为，请将其添加到您的样式中`background-color: highlight;`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-09T13:59:34.340

我相信这是一个 CSS 问题。请参考以下文章：

[使用 CSS 覆盖默认文本选择颜色](http://css-tricks.com/overriding-the-default-text-selection-color-with-css/)

# python - 如何将python脚本编译为二进制可执行文件

> ID：12339671
> 
> 赞同：131
> 
> 时间：2012-09-09T13:54:05.383
> 
> 标签：python, compilation, executable

我需要将 Python 脚本转换为 Windows 可执行文件。

我已将 Python 2.6 安装到`python26`.

我创建了一个脚本并将其保存在`C:\pythonscript`. 这个文件夹里面有两个文件

`Setup.py`和`oldlogs.py`（这个文件需要覆盖）

`setup.py`代码是

```
from distutils.core import setup
import py2exe

setup(console=['oldlogs.py']) 
```

如何将 oldlogs.py 转换为 exe 文件？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-09-09T14:02:04.560

或者使用[PyInstaller](https://www.pyinstaller.org/)作为[py2exe](https://www.py2exe.org/)的替代品。这是一个很好的[起点](https://pyinstaller.readthedocs.io/en/stable/usage.html)。PyInstaller 还允许您为 linux 和 mac 创建可执行文件...

以下是如何相当容易地使用 PyInstaller 来解决手头的问题：

```
pyinstaller oldlogs.py 
```

从工具的文档中：

> PyInstaller 分析 myscript.py 并：
> 
> *   将 myscript.spec 写入与脚本相同的文件夹中。
> *   如果脚本不存在，则在与脚本相同的文件夹中创建一个文件夹构建。
> *   在构建文件夹中写入一些日志文件和工作文件。
> *   如果脚本不存在，则在与脚本相同的文件夹中创建文件夹 dist。
> *   在 dist 文件夹中写入 myscript 可执行文件夹。
> 
> 在 dist 文件夹中，您可以找到分发给用户的捆绑应用程序。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-09-09T15:45:04.833

我推荐[PyInstaller](http://www.pyinstaller.org/)，一个简单的 python 脚本可以通过以下命令转换为 exe：

```
utils/Makespec.py [--onefile] oldlogs.py 
```

这将创建一个 yourprogram.spec 文件，该文件是用于构建最终 exe 的配置。下一个命令从配置文件构建 exe：

```
utils/Build.py oldlogs.spec 
```

更多可以在[这里找到](https://pyinstaller.readthedocs.io/en/stable/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-12-21T23:06:06.360

由于其他 SO 答案链接到这个问题，值得注意的是[PyOxidizer](https://github.com/indygreg/PyOxidizer)现在还有另一个选项。

[它是一个 rust 实用程序，其工作方式与 pyinstaller 相同，但这里](https://pyoxidizer.readthedocs.io/en/stable/comparisons.html#pyinstaller)有一些详细的附加功能，总结了关键功能：

*   默认情况下，所有包的单个二进制文件能够将模块零复制加载到内存中，而 pyinstaller 在使用`onefile`模式时将它们提取到临时目录
*   生成静态链接二进制文件的能力

（另一个优点是，如果您在 glibc 版本比目标系统新的系统上创建二进制文件`pyoxidizer`，它似乎不会遇到 pyinstaller 可能出现的问题）。`GLIBC_X.XX not found`

总体而言，pyinstaller 使用起来比 PyOxidizer 简单得多，后者通常需要一些复杂的配置文件，而且它的 Pythony 较少，因为它是用 Rust 编写的，并且使用 Python 世界中不太熟悉的配置文件格式，但 PyOxidizer 做了一些更高级的东西，特别是如果您希望生成单个二进制文件（这不是 pyinstaller 的默认设置）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-23T16:58:55.583

```
# -*- mode: python -*-

block_cipher = None

a = Analysis(['SCRIPT.py'],
             pathex=[
                 'folder path',
                 'C:\\Windows\\WinSxS\\x86_microsoft-windows-m..namespace-downlevel_31bf3856ad364e35_10.0.17134.1_none_50c6cb8431e7428f',
                 'C:\\Windows\\WinSxS\\x86_microsoft-windows-m..namespace-downlevel_31bf3856ad364e35_10.0.17134.1_none_c4f50889467f081d'
             ],
             binaries=[(''C:\\Users\\chromedriver.exe'')],
             datas=[],
             hiddenimports=[],
             hookspath=[],
             runtime_hooks=[],
             excludes=[],
             win_no_prefer_redirects=False,
             win_private_assemblies=False,
             cipher=block_cipher)
pyz = PYZ(a.pure, a.zipped_data,
             cipher=block_cipher)
exe = EXE(pyz,
          a.scripts,
          a.binaries,
          a.zipfiles,
          a.datas,
          name='NAME OF YOUR EXE',
          debug=False,
          strip=False,
          upx=True,
          runtime_tmpdir=None,
          console=True ) 
```

# c++ - 多项目解决方案的链接器选项

> ID：12339672
> 
> 赞同：0
> 
> 时间：2012-09-09T13:54:06.000
> 
> 标签：c++, visual-studio, linker, project, solution

大家好。我有一个问题想问你。

实际上，我非常熟悉为单项目解决方案设置链接器项目，所以我看错地方的可能性几乎不存在。

所以，关键是 - 当我尝试更改解决方案项目之一的属性时，链接器选项丢失，而当我对单项目解决方案执行相同操作时它存在

[多项目](http://i.stack.imgur.com/n0aKc.png)

[单项目](http://i.stack.imgur.com/p1m3Z.png)

所以，我想问的是是否有任何方法可以更改链接器选项？还是我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:04:15.090

在查看图像时，我看到了两个项目。其中一个是逻辑上没有链接器选项的库项目。

# java - FileOutputStream 在下载图像时因“打开失败：EISDIR（是目录）”错误而崩溃

> ID：12339673
> 
> 赞同：34
> 
> 时间：2012-09-09T13:54:15.053
> 
> 标签：java, fileoutputstream

我正在尝试从互联网上下载 iamge，这是代码：

```
try {
                String imgURL = c.imgURL;
                String imgPATH = c.imgPATH;
                URL url = new URL(imgURL);
                URLConnection conexion = url.openConnection();
                conexion.connect();
                int lenghtOfFile = conexion.getContentLength();
                try {
                    File f = new File(imgPATH);
                    f.mkdirs();

                    BufferedInputStream input = new BufferedInputStream(url.openStream());
                    BufferedOutputStream output = new BufferedOutputStream(new FileOutputStream(imgPATH), 8192); // CRASH HERE

                    byte data[] = new byte[8192];
                    long total = 0;
                    int count = 0;
                    int updateUILimiter = 0;
                    while ((count = input.read(data)) != -1) {
                        total += count;

                        if (updateUILimiter == 20)
                            // publishProgress((int) (total * 100 / lenghtOfFile));
                            updateUILimiter = 0;
                        else
                            updateUILimiter++;

                        output.write(data, 0, count);

                        if (isCancelled()) {
                            output.flush();
                            output.close();
                            input.close();
                            return null;
                        }

                    }
                    output.flush();
                    output.close();
                    input.close();
                } catch (Exception e) {
                    c.imgPATH = "";
                    return null;
                }

            } catch (Exception e) {
                c.imgPATH = "";
                return null;
            } 
```

这是错误消息：

> /mnt/sdcard/tmp/3.png：打开失败：EISDIR（是一个目录）

为什么是这样？

“/mnt/sdcard/tmp/”存在。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-09-09T14:14:30.150

`3.png`是一个目录，因为你通过调用`f.mkdirs();`. 试试`f.getParentFile().mkdirs()`吧。从[文档](https://docs.oracle.com/javase/7/docs/api/java/io/File.html#mkdirs())中：

> 创建*由此抽象路径名命名*的目录，包括任何必要但不存在的父目录。请注意，如果此操作失败，它可能已成功创建一些必要的父目录。

（强调我的）。换句话说，`File`实例中包含的整个路径`f`被视为目录名称，直到并包括最后一部分（`3.png`在示例输出中）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-03-11T04:39:32.147

问题是您正在使用该功能

```
f.mkdirs(); 
```

此函数将创建一个名为“3.png”的文件夹，而不是一个名为“3.png”的文件，因此请先删除此文件夹，

![在此处输入图像描述](../Images/198c8ce1d16775e25daab6d8aad75f34.png)

然后替换函数

```
f.mkdirs(); 
```

到

```
f.createNewFile(); 
```

希望这有帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-12-25T06:56:04.240

替换`f.mkdirs()`为`f.createNewFile().`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-08T16:37:48.447

## 您可以先制作目录，然后再进一步编写代码。

```
 URL downloadURL=null;
    HttpURLConnection urlConnection=null;
    InputStream inputStream=null;
    FileOutputStream fos=null;
    Uri uri=Uri.parse(url);
    try {
        downloadURL=new URL(url);
        urlConnection= (HttpURLConnection) downloadURL.openConnection();
        inputStream=urlConnection.getInputStream();
        File file=new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES).getAbsolutePath()+"/myAppImages/");
        if(!file.exists())
        {
            file.mkdirs();
        }
        File file1=new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES).getAbsolutePath()+"/myAppImages/"+uri.getLastPathSegment());
        fos=new FileOutputStream(file1);
        byte[] buffer=new byte[1024];

        int read=-1;
        while((read=inputStream.read(buffer))!=-1)
        {
           /* Message.L(""+read);*/
            fos.write(buffer,0,read);
        }

    } 
```

### 像这样你可以做

```
File file=new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES).getAbsolutePath()+"/myAppImages/");
        if(!file.exists())
        {
            file.mkdirs();
        }
        File file1=new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES).getAbsolutePath()+"/myAppImages/"+uri.getLastPathSegment());
        fos=new FileOutputStream(file1); 
```

# ios - JSON解析到Core Data有效，但我得到空对象

> ID：12339674
> 
> 赞同：2
> 
> 时间：2012-09-09T13:54:27.233
> 
> 标签：ios, parsing, core-data, json

我在尝试将 JSON 保存到 Core Data 时遇到的问题是我在列表视图中获得了空对象，而不是让它们填充了数据。这是我的 JSON 格式：

```
[{"nid":"23","name":"JN01"},{"nid":"24","name":"JN02"}] 
```

这是我的代码

```
jsonToArray.h

#define JSON_NAME @"name"
#define JSON_NID @"nid"
@interface JSONToArray : NSObject
@property (nonatomic, copy) NSString *nid;
@property (nonatomic, copy) NSString *name;
+ (void)showNetworkError:(NSString *)theMessage;
+ (NSArray*)retrieveJSONItems;

jsonToArray.m

+ (NSArray*)retrieveJSONItems { //skipped a few boring lines
NSArray *json = [NSJSONSerialization JSONObjectWithData:[NSData dataWithContentsOfURL:url]
                                                options:kNilOptions
                                                  error:&err];
return json;}

Job+Json.h //Job- my entity

+ (Job *)appsWithJSONInfo:(NSDictionary *) nbJSONInfo
inManagedObjectContext:(NSManagedObjectContext *)context;
+ (Job *)appsWithID:(NSString *)newID inManagedObjectContext:(NSManagedObjectContext *)context;

Job+Json.m

#import "Apps+JSON.h"
#import "JSONToArray.h"

@implementation Job (JSON)

+ (Job *)appsWithJSONInfo:(NSDictionary *) nbJSONInfo
inManagedObjectContext:(NSManagedObjectContext *)context {

Job *apps = nil;

NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Job"];
request.predicate = [NSPredicate predicateWithFormat:@"nid=%@", [nbJSONInfo objectForKey:JSON_NID]];
NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"name" ascending:YES];
request.sortDescriptors = [NSArray arrayWithObject:sortDescriptor];

NSError *error = nil;
NSArray *matches = [context executeFetchRequest:request error:&error];

if (!matches || ([matches count] > 1)) {
    [JSONToArray showNetworkError:@"There was an error retrieving the json Data."];
} else if ([matches count] == 0) {
    apps = [NSEntityDescription insertNewObjectForEntityForName:@"Job" inManagedObjectContext:context];
    apps.nid = NSLocalizedString([nbJSONInfo objectForKey:JSON_NID], nil);
    apps.name = NSLocalizedString([nbJSONInfo objectForKey:JSON_NAME], nil);

}else {
    apps = [matches lastObject];
}

return apps;
}

+ (Job *)appsWithID:(NSString *)newID
            inManagedObjectContext:(NSManagedObjectContext *)context
{
Job *app = nil;

NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Job"];
request.predicate = [NSPredicate predicateWithFormat:@"nid = %@", newID];
NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"name" ascending:YES];
request.sortDescriptors = [NSArray arrayWithObject:sortDescriptor];

NSError *error = nil;
NSArray *apps = [context executeFetchRequest:request error:&error];

if ([apps count] == 0) {
    app = [NSEntityDescription insertNewObjectForEntityForName:@"Job"
                                        inManagedObjectContext:context];
    app.nid = NSLocalizedString(newID, nil);
} else if ([apps count] >=1) {   
    app = [apps lastObject];
}
return app;
} 
```

最后是我的列表视图：

```
- (void)viewWillAppear:(BOOL)animated{
[self fetchJSONDataIntoDocument:self.managedObjectContext];}

- (void)fetchJSONDataIntoDocument:(NSManagedObjectContext *)managedObjectContext{    
NSArray * tempArray = [JSONToArray retrieveJSONItems];
for (NSDictionary *JSONInfo in tempArray) {
[Job appsWithJSONInfo:JSONInfo inManagedObjectContext:managedObjectContext];

}

NSError *error = nil;
if (![managedObjectContext save:&error]) {
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
}
} 
```

因此，在这种情况下，我在列表视图中看到了这两个对象，但它们为空，没有任何值。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:14:15.570

*   您正在为 > IOS5.0 开发吗？

*   我使用**NSJSONReadingMutableLeaves**而不是**kNilOptions**：

     **[NSJSONSerialization JSONObjectWithData:returnData 选项:NSJSONReadingMutableLeaves 错误:&error];**

# java-me - 使用 bouncycastle 和 LWUIT 进行混淆

> ID：12339675
> 
> 赞同：0
> 
> 时间：2012-09-09T13:54:30.160
> 
> 标签：java-me, obfuscation, lwuit, netbeans-7, bouncycastle

我已经构建了一个应用程序，它使用 LWUIT 进行 UI 和 bouncycastle 进行哈希和加密，并且在模拟器中一切正常但是当我尝试在真实设备上测试它时

1- 由于 bouncycastle 库而未正确安装应用程序需要高混淆级别才能在设备上运行而没有任何问题

2-所以我将混淆设置为高级别，但这对无法在应用程序中构建的 LWUIT 造成了很多问题

3-所以我将混淆级别降低到 8 并且项目构建成功，但 UI 现在无法正常工作，可能因为没有应用按钮操作等等

4-由于bouncycastle，应用程序也没有成功安装

我需要紧急帮助，我该怎么做才能解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T12:20:55.947

我已经成功地将充气城堡用于 lwuit 应用程序，所以我不认为这应该是一个问题，但是如果您在包含 bouncycastle javaME jar 时遇到问题，那么我建议您下载源文件并仅复制所需的类使用适当的包名称以及所有依赖项放入您自己的代码库中。

# sencha-touch-2 - WebStorm 项目模板

> ID：12339676
> 
> 赞同：1
> 
> 时间：2012-09-09T13:54:30.140
> 
> 标签：sencha-touch-2, webstorm

有没有办法拥有我们自己的项目模板。例如，我想将它与 sencha touch2 一起使用，并为创建的每个新项目自动创建 mvc 文件夹结构。欢迎任何经验或帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:12:19.583

我从未亲自使用过，但可能你觉得它很有[用 WebStorm IDE 的高效使用](https://stackoverflow.com/questions/5462285/efficient-usage-of-webstorm-ide/5900800#5900800)

干杯，奥列格

# jquery - jquery 同时淡入和淡出

> ID：12339679
> 
> 赞同：5
> 
> 时间：2012-09-09T13:54:41.263
> 
> 标签：jquery, fadein, fadeout

我想做一个像菜单一样的东西，所以每个菜单项都包含不同的内容，但我不想重新加载页面。所以我做了这样的东西。

```
$(document).ready(function() {
    var $hide = $('div#hide'),
        $home = $('div.home'),
        $download = $('div.download'),
        $about = $('div.about'),
        $contact = $('div.contact');

    $hide.css('display', 'none');

    $('a.home').on('click', function() {
        $hide.fadeOut();
        $home.delay(300).fadeIn(2000);
    });

    $('a.download').on('click', function() {
        $hide.fadeOut();
        $download.delay(300).fadeIn(2000);
    });

    $('a.about').on('click', function() {
        $hide.fadeOut();
        $about.delay(300).fadeIn(2000);
    });

    $('a.contact').on('click', function() {
        $hide.fadeOut();
        $contact.delay(300).fadeIn(2000);
    });
});​ 
```

现在......我相信这可能会更清洁和简化，但我想不出任何东西。我基本上是jQuery的新手......

一切正常，但是我有两个问题。1）你能让这个脚本更干净一点吗？2）你能告诉我如何同时加载内容吗？目前，当加载主页并单击下载时，它在淡入淡出时有点跳跃...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T13:58:20.973

您可以使用对象`preventDefault()`的方法`event`来阻止事件的默认操作。

```
$('a.home, a.download, a.about, a.contact').on('click', function(event) {
    event.preventDefault();
    var cls = this.className;
    $hide.fadeOut();
    $('.'+cls).delay(300).fadeIn(2000);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T14:04:59.363

由于您还没有发布您的 HTML，我只能猜测您在这里想要实现的目标，但基于此，这里有几个指针：

*   `div`包含您的内容（主页、下载、关于、联系人）的元素可能只存在一次，因此应该有 id 而不是类
*   挂钩[`click`](http://api.jquery.com/click/)事件时，请确保使用[`preventDefault`](http://api.jquery.com/event.preventDefault/)停止默认事件触发
*   CSS 类应该用于设置元素的样式，而不是定义 JavaScript 行为

考虑到上述情况，我创建了一个示例，该示例使用锚点`href`通过散列指向属性中的元素 id，然后使用它来确定要显示的元素。

### HTML

```
<nav>
    <a href="#home">Home</a>
    <a href="#download">Download</a>
    <a href="#about">About</a>
    <a href="#contact">Contact</a>
</nav>

<div id="container">

    <div id="home">
        Home
    </div>

    <div id="download">
        Download
    </div>

    <div id="about">
        About
    </div>

    <div id="contact">
        Contact
    </div>

</div> 
```

### JavaScript

```
$(function(){
    var $menuItems = $('nav a'),
        $container = $("#container");

    $menuItems.on('click', function(e) {
        e.preventDefault();
        $(this.hash, $container).delay(300).fadeIn(1000).siblings().fadeOut(1000);
    }).first().click();
});​ 
```

看看[这个小提琴](http://jsfiddle.net/mekwall/y4Ujd/)上面的工作原理。请注意，我已经删除了 hide 元素，因为我不知道它的用途。

# asp.net-mvc - 是否有模拟器或工具可以帮助测试桌面上的移动 asp.net-mvc 4 体验？

> ID：12339680
> 
> 赞同：0
> 
> 时间：2012-09-09T13:54:53.460
> 
> 标签：asp.net-mvc, jquery-mobile, asp.net-mvc-4

我正在玩[asp.net-mvc 4 和 jquery.mobile.mvc nuget package](http://msdn.microsoft.com/en-us/magazine/hh975347.aspx)。我想看看是否有一种方法可以在我的桌面上模拟 iphone 浏览器，这样我就可以看到它的外观而无需发布到我的网络服务器？

有没有免费的方法可以从我的桌面测试 asp.net-mvc 4 的浏览器体验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:00:55.363

您可以查看 Firefox 的[User Agent Switcher 插件](https://addons.mozilla.org/en-US/firefox/addon/user-agent-switcher/)。

# django - 如何使用 send_mail 和 django 在电子邮件中包含换行符？

> ID：12339683
> 
> 赞同：7
> 
> 时间：2012-09-09T13:55:13.160
> 
> 标签：django, email, newline

我想发送带有换行符的电子邮件。比方说，通过以下代码：

```
send_mail("subject", "Hi  George\n Thanks for registration", "from", "to") 
```

我预计：

嗨乔治

感谢注册

而我得到的是：嗨 George\n 感谢您的注册

如果重要，电子邮件将发送到 gmail 帐户。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T14:01:10.593

实现这一目标的最佳方法是将邮件文本放入模板中，并使用 django 模板加载器将其与上下文一起呈现。

```
from django.template.loader import render_to_string
context = {}  # Fill it with your context
send_mail(
    'Subject',
    render_to_string('core/emails/email.txt', context),
    'sender@mail.com',
    ['receiver@mail.com'],
    fail_silently=False) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-03T07:21:43.627

是的 "%0A" 对于新行它运行良好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-27T23:44:39.373

尝试使用：

`%0A` for a new line
`%26`for &
`%3f`for ?

# java - java.lang.ClassNotFoundException: org.apache.struts.action.ActionServlet

> ID：12339696
> 
> 赞同：4
> 
> 时间：2012-09-09T13:57:25.183
> 
> 标签：java

我得到以下 Tomcat 错误：

```
Sep 09, 2012 3:27:48 PM org.apache.catalina.core.AprLifecycleListener init
Information: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Products\jdk1.7.0_03\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:/Products/jdk1.7.0_03/jre/bin/client;C:/Products/jdk1.7.0_03/jre/bin;C:/Products/jdk1.7.0_03/jre/lib/i386;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Products\jdk1.7.0_03\jre\bin;c:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\DTS\Binn\;c:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\;c:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\;C:\Products\eclipse32;;.
Sep 09, 2012 3:27:48 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
Warnung: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:NAR_JDBC_DBO' did not find a matching property.
Sep 09, 2012 3:27:49 PM org.apache.coyote.AbstractProtocol init
Information: Initializing ProtocolHandler ["http-bio-80"]
Sep 09, 2012 3:27:49 PM org.apache.coyote.AbstractProtocol init
Information: Initializing ProtocolHandler ["ajp-bio-8009"]
Sep 09, 2012 3:27:49 PM org.apache.catalina.startup.Catalina load
Information: Initialization processed in 1359 ms
Sep 09, 2012 3:27:49 PM org.apache.catalina.core.StandardService startInternal
Information: Starting service Catalina
Sep 09, 2012 3:27:49 PM org.apache.catalina.core.StandardEngine startInternal
Information: Starting Servlet Engine: Apache Tomcat/7.0.27
Sep 09, 2012 3:27:49 PM org.apache.catalina.startup.TaglibUriRule body
Information: TLD skipped. URI: http://struts.apache.org/tags-html is already defined
Sep 09, 2012 3:27:49 PM org.apache.catalina.startup.TaglibUriRule body
Information: TLD skipped. URI: http://struts.apache.org/tags-bean is already defined
Sep 09, 2012 3:27:49 PM org.apache.catalina.startup.TaglibUriRule body
Information: TLD skipped. URI: http://struts.apache.org/tags-nested is already defined
Sep 09, 2012 3:27:49 PM org.apache.catalina.startup.TaglibUriRule body
Information: TLD skipped. URI: http://struts.apache.org/tags-logic is already defined
Sep 09, 2012 3:27:49 PM org.apache.catalina.core.ApplicationContext log
Information: Marking servlet action as unavailable
Sep 09, 2012 3:27:49 PM org.apache.catalina.core.StandardContext loadOnStartup
Schwerwiegend: Servlet /NAR_JDBC_DBO threw load() exception
java.lang.ClassNotFoundException: org.apache.struts.action.ActionServlet
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:525)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:507)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:124)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1136)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1080)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5015)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)

Sep 09, 2012 3:27:49 PM org.apache.coyote.AbstractProtocol start
Information: Starting ProtocolHandler ["http-bio-80"]
Sep 09, 2012 3:27:49 PM org.apache.coyote.AbstractProtocol start
Information: Starting ProtocolHandler ["ajp-bio-8009"]
Sep 09, 2012 3:27:49 PM org.apache.catalina.startup.Catalina start
Information: Server startup in 725 ms 
```

这是我的 web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app id="WebApp_ID" version="2.5"
 xmlns="http://java.sun.com/xml/ns/javaee"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
 <display-name>NAR_JDBC_DBO</display-name>
 <servlet>
  <servlet-name>action</servlet-name>
  <servlet-class>org.apache.struts.action.ActionServlet</servlet-class>
  <init-param>
   <param-name>config</param-name>
   <param-value>/WEB-INF/struts-config.xml</param-value>
  </init-param>
  <init-param>
   <param-name>validate</param-name>
   <param-value>true</param-value>
  </init-param>
  <load-on-startup>1</load-on-startup>
 </servlet>
 <servlet-mapping>
  <servlet-name>action</servlet-name>
  <url-pattern>*.do</url-pattern>
 </servlet-mapping>
 <welcome-file-list>
  <welcome-file>index.html</welcome-file>
  <welcome-file>index.htm</welcome-file>
  <welcome-file>index.jsp</welcome-file>
  <welcome-file>default.html</welcome-file>
  <welcome-file>default.htm</welcome-file>
  <welcome-file>default.jsp</welcome-file>
 </welcome-file-list>
 <jsp-config>
  <taglib>
   <taglib-uri>/WEB-INF/struts-bean.tld</taglib-uri>
   <taglib-location>/WEB-INF/struts-bean.tld</taglib-location>
  </taglib>
  <taglib>
   <taglib-uri>/WEB-INF/struts-html.tld</taglib-uri>
   <taglib-location>/WEB-INF/struts-html.tld</taglib-location>
  </taglib>
  <taglib>
   <taglib-uri>/WEB-INF/struts-logic.tld</taglib-uri>
   <taglib-location>/WEB-INF/struts-logic.tld</taglib-location>
  </taglib>
  <taglib>
   <taglib-uri>/WEB-INF/struts-nested.tld</taglib-uri>
   <taglib-location>/WEB-INF/struts-nested.tld</taglib-location>
  </taglib>
 </jsp-config>
</web-app> 
```

显然，来自 org.apache.struts.action.ActionServlet 的 Servlet Name 'Action' 存在问题。Unfurtunatley 我不知道我做错了什么。你有想法吗？提前很多。奥利

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-03T06:23:02.657

发生此错误是因为您的 servlet-core jar 不在运行时类路径中。如果您使用的是maven，

1.  打开您的 EAR/web 项目属性
2.  单击“部署程序集”
3.  点击“添加...”
4.  选择“Java 构建路径条目”
5.  点击“下一步”
6.  选择“Maven依赖项”
7.  点击“完成”

如果不是 maven，请确保放置 jar 的 lib 文件夹位于“部署程序集”上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T05:22:11.720

我认为您应该将 jar 文件保存到 /WEB_INF/Lib 文件夹中，这对您有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-05T05:31:08.957

我在使用 Tomcat 7 时遇到了同样的错误。我找到了解决方案。根本原因是struts jar 版本或jar 配置。Previsouly 我使用 struts.jar，现在我添加了适用于 Tomcat 7 的 struts-core-1.3.10.jar，并且 servlet-api jar 应该可用，并确保 jar 配置是否正确完成。最好删除当前项目和重新开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-01-25T00:05:55.677

我们需要添加一个额外的 jar：`struts-extras-1.3.9.jar`在`WEB/lib`. 正确地说是`org.apache.struts.actions.ForwardAction`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T07:43:33.383

我认为问题是由于 jar 文件，请确保 lib 文件夹中的 jar 文件。如果您使用的是 eclipse，则将所有 jar 文件复制到 lib 文件夹而不是配置构建路径

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-01T21:38:29.500

为避免此类问题，请将所有 struts jar 放在 web 应用程序的 lib 文件夹中。这将解决问题

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-02T07:11:30.697

这个问题是由于缺少罐子而已......将所有这些罐子放入 /WEB-INF/lib 文件夹中......

1.  antlr-2.7.2.jar
2.  commons-beanutils-1.8.0.jar
3.  commons-chain-1.2.jar
4.  commons-digester-1.8.jar
5.  commons-logging-1.0.4.jar
6.  commons-validator-1.3.1.jar
7.  oro-2.0.8.jar
8.  struts-core-1.3.10.jar
9.  struts-taglib-1.3.10.jar

如果我们只使用 struts-core.jar，那么我们将面临这个问题......因为还需要所有其他 jars。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-30T00:57:46.963

我有同样的问题。虽然我将 struts 库添加到项目 Build Path 并标记为导出，但 Eclipse 并没有在 WEB-INF/lib 中包含任何内容。与 Vivek Kothari 所说的非常相似，您可以让 Eclipse 添加它们。但如果您已经下载了 jar 文件并添加到项目构建路径（可能作为用户库），则可以在步骤 6 中选择您的库。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-08-14T21:01:31.037

org.apache.struts.actions.ActionServlet 不是 org.apache.struts.action.ActionServlet

# sql-server - 将可更新视图解析为 xml 列？

> ID：12339697
> 
> 赞同：0
> 
> 时间：2012-09-09T13:57:31.640
> 
> 标签：sql-server, xml, sql-server-2008

我有视图定义的以下部分

```
SELECT
   codedValue.value('Code[1]','nvarchar(max)') AS "Code",
   codedValue.value('Name[1]', 'nvarchar(max)') AS "Value"
  FROM GDB_ITEMS AS items 
  CROSS APPLY items.Definition.nodes
   ('/GPCodedValueDomain2/CodedValues/CodedValue') AS CodedValues(codedValue)
  WHERE items.Name = 'tlu_Loss_list' 
```

它查询应用程序生成的 xlm 列以获取“代码”和“值”。在这种情况下，我可以只读 xml 列中的代码和值。

理想情况下，我想让视图可更新，这样用户就可以输入他们自己的代码和值，这些代码和值将被复制到这个 xml 列。这可能吗？

这是 xml 列和表的相关部分：

xml 列中的现有数据：

```
<GPCodedValueDomain2 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:typens="http://www.esri.com/schemas/ArcGIS/10.0" xsi:type="typens:GPCodedValueDomain2">
  <DomainName>tlu_Loss_List</DomainName>
  <FieldType>esriFieldTypeString</FieldType>
  <MergePolicy>esriMPTDefaultValue</MergePolicy>
  <SplitPolicy>esriSPTDefaultValue</SplitPolicy>
  <Description>Loss_Reason</Description>
  <Owner>DBO</Owner>
  <CodedValues xsi:type="typens:ArrayOfCodedValue">
    <CodedValue xsi:type="typens:CodedValue">
      <Name>Abandoned</Name>
      <Code xsi:type="xs:string">AB</Code>
    </CodedValue>
    <CodedValue xsi:type="typens:CodedValue">
      <Name>Coyote</Name>
      <Code xsi:type="xs:string">CO</Code>
    </CodedValue>
  </CodedValues>
</GPCodedValueDomain2> 
```

保存 XML 的表：

```
CREATE TABLE [dbo].[GDB_ITEMS](
    [ObjectID] [int] NOT NULL,
    [UUID] [uniqueidentifier] NOT NULL,
    [Type] [uniqueidentifier] NOT NULL,
    [Name] [nvarchar](226) NULL,
    [PhysicalName] [nvarchar](226) NULL,
    [Path] [nvarchar](512) NULL,
    [Url] [nvarchar](255) NULL,
    [Properties] [int] NULL,
    [Defaults] [varbinary](max) NULL,
    [DatasetSubtype1] [int] NULL,
    [DatasetSubtype2] [int] NULL,
    [DatasetInfo1] [nvarchar](255) NULL,
    [DatasetInfo2] [nvarchar](255) NULL,
    [Definition] [xml] NULL,
    [Documentation] [xml] NULL,
    [ItemInfo] [xml] NULL,
    [Shape] [geometry]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T17:49:11.223

You might be able to do this with an "instead-of" trigger: [Designing INSTEAD OF triggers](http://msdn.microsoft.com/en-us/library/aa175158%28v=sql.80%29.aspx)

For examples of modifying XML, see [modify() Method](http://msdn.microsoft.com/en-us/library/ms187093.aspx) and [XML Data Modification Language](http://msdn.microsoft.com/en-us/library/ms177454)

# javascript - 为什么我的函数没有被调用？

> ID：12339699
> 
> 赞同：0
> 
> 时间：2012-09-09T13:57:45.233
> 
> 标签：javascript, jquery

我有一个这样的文件：

```
//function accessLinkClick(e) {
//    e.preventDefault();
//    $('#registerLink', '#loginLink')
//        .unbind('click', accessLinkClick);
//    dialog(this);
//}

function accessLinkClick(e) {
    alert("hi")
} 
```

另一个：

```
$(document).ready(function () {
$('#loginLink','#registerLink')
.bind('click', accessLinkClick);
}); 
```

我的 HTML 如下所示：

```
<a id="loginLink" class="button dialogLink" title="Login" data-href="/MyAccount/Access/Login" data-title="Admin" data-entity="n/a" data-dialog="UserAdmin" href="#">Login</a> 
```

我在第一个文件中更改了函数的名称，运行我的代码并得到一个错误，指出该函数不存在。所以这向我证明了 accessLinkClick 函数是已知的。然后我将函数名称改回 accessLinkClick。

我单步执行代码，我看到它进入了绑定事件，所以看起来函数正在被绑定。

但是，当我运行我的代码并单击 loginLink 时，什么也没有发生。

我在这里做错了吗？我应该带走函数的参数以使其工作吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-09T13:59:23.380

问题是您的选择器：

```
$('#loginLink','#registerLink') 
```

您需要一个字符串而不是两个：

```
$('#loginLink, #registerLink') 
```

原因是[jQuery 函数的第二个参数](http://api.jquery.com/jQuery/)是*context*。它查找与第一个参数匹配的元素，该元素`#loginLink`是第二个参数的后代。

# php - PHP 中的 strtotime() 函数

> ID：12339703
> 
> 赞同：0
> 
> 时间：2012-09-09T13:58:32.587
> 
> 标签：php, time, strtotime

我想在可变的周数后以秒为单位计算确切的时间。我正在使用`strtotime()`，但我只能使用硬编码的周数。我的代码：

```
$time = "Monday";  // any day
$weekDifference = 2;  // variable of week difference

$myTime = strtotime("+weekDifference week $time");  // it does not works
// strtotime("+2 week $time ") this works
echo $myTime;   // no value is printed 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T14:00:02.507

您忘记了 weekDifference 变量中的 $ 符号。

```
 $myTime = strtotime("+$weekDifference week $time"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:18:42.160

利用

$myTime = strtotime("+$weekDifference week $time");

它会工作

干杯

# java - 多线程初学者问题

> ID：12339704
> 
> 赞同：1
> 
> 时间：2012-09-09T00:14:18.840
> 
> 标签：java, multithreading

正如你所知道的，我是多线程的新手，有点卡在这里。对于我的程序，我需要一个线程（`PchangeThread`在下面的示例中），它可以在程序执行期间的任何时候从另一个线程打开和关闭。线程应该在启动时暂停，并在`pixelDetectorOn()`被调用时恢复。

这两个线程很可能不需要共享任何数据，除了开始/停止标志。无论如何，我还是包含了对主线程的引用，以防万一。

但是，在下面的代码中，唯一输出的消息是“进入循环之前”，这表明线程由于某种原因永远不会从 wait() 中唤醒。我猜这是某种锁定问题，但我无法弄清楚到底出了什么问题。`this.detector`从主线程锁定给了我相同的结果。另外我想知道`wait()`/`notify()`范式是否真的是挂起和唤醒线程的方法。

```
public class PchangeThread extends Thread {
  Automation _automation;
  private volatile boolean threadInterrupted;

  PchangeThread(Automation automation)
  {
    this._automation = automation;
    this.threadInterrupted = true;
  }

  @Override
  public void run()
  {
    while (true) {
      synchronized (this) {
        System.out.println("before entering loop");
        while (threadInterrupted == true) {
          try {
            wait();
            System.out.println("after wait");
          } catch (InterruptedException ex) {
            System.out.println("thread2: caught interrupt!");
          }
        }
      }
      process();
    }
  }

  private void process()
  {
    System.out.println("thread is running!");

  }

  public boolean isThreadInterrupted()
  {
    return threadInterrupted;
  }

  public synchronized void resumeThread()
  {
    this.threadInterrupted = false;
    notify();
  }
} 
```

`resumeThread()`通过以下方式从主线程调用：

```
public synchronized void pixelDetectorOn(Context stateInformation) {        
        this.detector.resumeThread();
} 
```

`detector`是对 的实例的引用`PchangeThread`。“检测器”线程通过以下方式在程序的主模块中实例化：

```
detector=new PchangeThread(this); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T04:12:32.047

正如您所说，您需要保护对共享标志的访问。您声明`threadInterrupted`了 volatile，但仍在使用同步。你只需要一个。我更喜欢只使用同步，因为它使事情变得更简单。多线程已经够复杂了，保持简单，除非你知道你需要更复杂的控件。这意味着任何时候`threadInterrupted`读取或写入，访问都应该同步。目前，您没有在`setThreadInterrupt()`and中这样做`isThreadInterrupted()`。

其次，您希望在尽可能小的代码块上进行同步。在 内部`run()`，您正在通过内部循环进行同步。实际上，您只需要在读取`threadInterrupted`. `isThreadInterrupted()`当如上所述固定的实现时，您可以直接使用它并从内部循环中删除同步块。

您在内部循环上同步的事实是导致您的代码永远不会打印“线程正在运行！”的错误。`PchangeThread`获取自己的锁并调用`wait()`挂起线程。但是，此时线程仍然持有锁。稍后，主线程调用`resumeThread()`以重新启动线程。但是，该方法无法开始执行，因为它必须首先等待获取锁。但是，在收到通知之前，它永远不会获得锁`PchangeThread`。

您提供了两种设置方法`threadInterrupted`，但是当值设置为 false 时，只有一种方法会通知线程。你真的需要`setThreadInterrupt()`吗？我希望你不会。`resumeThread()`如果你保留它，它应该与参数为假时的行为相同。

最后，最好锁定私有对象而不是实例本身。您可以完全控制私有锁对象。但是，任何引用您的线程实例的人也可以将其用作同步块的锁，这可能会导致难以找到的死锁。

您的代码已更改为使用我的编辑：

```
public class PchangeThread extends Thread {
  private final Object _lock = new Object();
  Automation _automation;
  private final boolean _threadInterrupted;

  PchangeThread(Automation automation)
  {
    _automation = automation;
    _threadInterrupted = true;
  }

  @Override
  public void run()
  {
    while (true) {
      System.out.println("before entering loop");
      while (isThreadInterrupted()) {
        try {
          wait();
          System.out.println("after wait");
        } catch (InterruptedException ex) {
          System.out.println("thread2: caught interrupt!");
        }
      }
      process();
    }
  }

  private void process()
  {
    System.out.println("thread is running!");

  }

  public boolean isThreadInterrupted()
  {
    synchronized (_lock) {
      return _threadInterrupted;
    }
  }

  public void resumeThread()
  {
    synchronized (_lock) {
      _threadInterrupted = false;
      notify();
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:11:22.530

在这种情况下，我个人会问自己以下问题：

> 被中断

仅由主线程设置的标志，例如工作线程只是读取它并根据标志决定是否等待但不会更新它。或者它可以由主线程和工作线程设置。

如果是前者 - 选择一个不稳定的布尔值。这样，工作线程就不会缓存 volatile 的值，而是始终从内存中读取它。这不会产生竞争条件，因为只有 1 个线程会更新它 - 主线程。将其视为发布/订阅方案。

如果您的场景属于后一类 - 使用 AtomicBoolean 变量。这两种情况都将比同步关键字更有效，因为您不会获取任何锁，但在 Atomic* 变量的情况下，您将使用比锁获取更轻量级的[CAS操作。](http://www.ibm.com/developerworks/java/library/j-jtp11234/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T13:51:46.517

您的代码没有错（尽管并不理想）。我运行了它，它打印了所有预期的消息。很可能，您只是不调用`resumeThread()`.

几个建议：

*   不要在 Thread 上同步，创建一个 Runnable 并在其上同步。

*   您想开始一些计算，但是要计算的数据是什么？看起来他们走的是不同的路。这是错误的根源。对数据和控制使用单通道。首选的方法是为这样的通道使用队列。例如，[LinkedBlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/LinkedBlockingQueue.html)已经以正确的方式同步。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T23:42:31.783

我怀疑有人会读到这篇文章，但以防万一有人有兴趣知道：

当我检查调试器日志时，我发现了一些奇怪的东西——它显示“调试在不可编译的源代码上停止：)Void;”。由于我想不出我的源代码中可能导致此错误的任何内容，我猜想 Netbeans 我正在使用的外部代码的某些部分存在问题（它不是由断点引起的，并且项目编译正常！） . 所以，我刚刚将我正在使用的第三方库更新为最新版本。瞧：在那之后，当我调用 resumeThread()! 时，我突然得到了一个空指针异常！我检查了我的其余代码并很快发现了错误（实际上对线程的引用为空）。

So, to sum it up: The strange behaviour was caused by a minor bug in my program, but something in the external jar led to the suppression of the exception that should have been thrown. Just out of curiosity I double checked by downgrading the jar and "unfixing" the bug and again, the exception was swallowed and the debugger exited with the above mentioned strange message.

Netbeans version 7.1.1

# r - panel$intname 中的错误：$ 运算符对原子向量无效

> ID：12339715
> 
> 赞同：3
> 
> 时间：2012-09-09T14:00:11.663
> 
> 标签：r

我正在研究 r 面板包。现在，如果我有一个使用 radiogroup 按钮的函数，并且如果我尝试从 rpanel 菜单中运行该函数，则会收到此错误：

```
Error in panel$intname : $ operator is invalid for atomic vectors 
```

但是，如果我不是从 rpanel 菜单内部运行该函数，而是通过独立调用它，则不会出现上述错误。这是一个简单的例子。尝试 2 种方法（1）运行整个代码并单击 Addition，然后单击菜单中的 Add（2）单独运行 add 函数并使用 add() 调用。前者会导致上述错误，而后者不会。另外，我看到这个错误只有在我的面板中有一个 rp.radiogroup 时才会出现。

[我在为什么 R 不允许原子向量上的 $ 运算符中](https://stackoverflow.com/questions/9824268/why-doesnt-r-allow-operator-on-atomic-vectors)看到帖子？但我该如何解决我的问题？我的示例代码如下：

```
install.packages(c("rpanel","tkrplot"))
my.menu <- function(panel) {

library(rpanel,tkrplot)

if (panel$menu=="Add"){
add()
  }
else 
panel
}

main.panel <- rp.control(title = "Main Menu",size=c(200,150))
rp.menu(panel = main.panel, var = menu,
    labels = list(list("Addition", "Add")),action = my.menu)

#  function to do adddition

add <- function(){

my.draw <- function(panel) {
 if(panel$vals=="numbers"){
  val<-as.numeric(panel$nmbr1)+as.numeric(panel$nmbr2)
 }
else if(panel$vals=="strings"){
  val <- paste(as.character(panel$nmbr1), "and" ,as.character(panel$nmbr2))
}
plot(1:10, 1:10, type="n", xlab="", ylab="",
axes=FALSE, frame = TRUE)
text(5, 5, paste("Result: ", val),cex=1.4)
panel
}

my.redraw <- function(panel) {
rp.tkrreplot(panel, my.tkrplot)
 panel
}

my.panel <- rp.control(title = "Addition")
rp.textentry(panel = my.panel, var = nmbr1,
 labels = "First:     ", action = my.redraw, initval="100")
rp.textentry(panel = my.panel, var = nmbr2,
           labels = "Second:", action = my.redraw, initval="200")
rp.radiogroup(panel = my.panel, var = vals,
            values = c("numbers", "strings"),
            action = my.redraw, title = "Type")
rp.tkrplot(panel = my.panel, name = my.tkrplot, plotfun = my.draw)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:10:29.363

您可以简单地使用 $: 更改

> 面板$vals

至：

> 面板[“vals”]

# html - 使用 JavaScript 设置 JQueryMobile Popup 的数据位置

> ID：12339724
> 
> 赞同：4
> 
> 时间：2012-09-09T14:01:10.603
> 
> 标签：html, jquery-mobile, popup

`$('#popupDiv').popup("open");`

这以编程方式打开了一个 JQueryMobile 弹出窗口，但我想知道是否可以更改或设置弹出窗口的设置，例如上面`data-position`的`data-transition`代码。谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-02T14:23:16.973

你可以做：

```
$('#popupDiv').popup("open", {positionTo: '#mydiv'}); 
```

不过，'origin' 在 1.2 版中对我不起作用。

见：http: [//jquerymobile.com/demos/1.2.0/docs/pages/popup/methods.html](http://jquerymobile.com/demos/1.2.0/docs/pages/popup/methods.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T18:29:02.747

直接来自[jQuery Mobile 文档](http://jquerymobile.com/demos/1.2.0/docs/pages/popup/index.html)：

> 定位选项 默认情况下，弹出窗口在您单击的内容（原点）上垂直和水平居中打开，这对于用作工具提示或菜单的弹出窗口很有用。该框架还应用了一些基本的碰撞检测规则，以确保弹出窗口出现在屏幕上，因此最终位置可能并不总是以原点为中心。
> 
> 对于像对话框或灯箱这样的情况，弹出窗口应该出现在窗口的中心而不是在原点上，将 data-position-to 属性添加到链接并指定 window 的值。
> 
> 除了 origin 和 window 之外，还可以指定任何有效的选择器作为 position-to 的值。例如，如果您添加 data-position-to="#myElement"，则弹出窗口将定位在 id 为 myElement 的元素上。

```
<a href="#positionWindow" data-rel="popup" data-position-to="window" data-transition="slideup">

    <div data-role="popup" id="positionWindow">
        <p>I am positioned to the window.</p>
    </div> 
```

您可以将`data-transition="slideup"`（或您选择的转换）添加到链接，以及我的答案顶部的文档链接中概述的其他定位选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-07T12:41:12.527

是的，正确的方法是像这样使用 event.target

```
$('#popup').off('taphold').on('taphold', function (e) {
     $('#popupDiv').popup("open", e.target);
}); 
```

顺便说一句，如果您点击按住按钮并且单击事件就像这样，则此代码会弹出一个弹出窗口，这意味着正常单击仍然有效

```
 $('#popup').on('tap', function (){
     var url = $(this).attr('url');
     window.open( url, '_parent');              
 }); 
```

注意：我`url='google.com'`在标记中添加了“”并制作了`href='#'`

# java - 使用 Apache DBCP 进行多线程

> ID：12339726
> 
> 赞同：10
> 
> 时间：2012-09-09T14:01:19.853
> 
> 标签：java, multithreading, connection-pooling, apache-commons-dbcp

我的应用程序在多个线程中执行多个查询。

现在我正在为每个查询创建新连接，我想使用池来提高效率。

Apache DBCP 池可以同时在多个线程中工作，还是会“阻塞”每个线程的某些同步方法？

如果它阻塞，我可以使用其他东西吗？

**更新**

在这篇文章中：[链接](http://docs.oracle.com/cd/B14117_01/java.101/b10979/tips.htm#i1005436) 说：

> 因为所有 Oracle JDBC API 方法都是同步的，如果两个线程尝试同时使用连接对象，那么一个线程将被迫等待，直到另一个线程完成使用。

所以我猜 DBCP 将无法处理这个问题？

我也意识到在这种情况下，池对我没有帮助，因为每个线程都会请求一个连接，并且线程每次都会生成一个新的连接（直到一些线程结束并将连接返回到池）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T15:05:29.547

线程从池中获取连接并独占使用它，直到完成，它不与其他线程共享连接。完成后，它将连接返回到池（通常连接会覆盖关闭方法以将其返回到池）。好处是不必为每次使用重新创建连接。但是您不应该有多个线程同时使用数据库连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T14:13:53.150

是的，Apache DBCP 可以同时在多线程中工作。“阻塞”发生在客户端代码`getConnection()`确保竞争条件下的正确行为时，例如，两个并发请求`Connection`不应获取一个实例。`getConnection()`之后，客户端代码处理`Connection`实例。

并发场景是服务器端池的主要关注点，例如流行的 Apache DBCP。所以我认为 DBCP 在多线程中表现良好，尽管我没有深入研究这个库。

而 Apache DBCP 只提供 JDBC 连接**池**，客户端代码必须`Connection`以正确的多线程方式使用实例，这是 DBCP 无法保证的。

# php - 自动将电子邮件从文本文件插入 SQL DB

> ID：12339727
> 
> 赞同：0
> 
> 时间：2012-09-09T14:01:24.557
> 
> 标签：php, sql, database, insert

我有一个纯文本文件，其中包含以下格式的电子邮件：

```
"Name Surname" <name.surname@exmaple.com>,  'Name2 Surname2" <name2.surname2@example.com>, ... 
```

**注意：**每个名称-电子邮件对之间有两个空格。整个文件在一行上。

我如何使用 PHP 提取数据（只需要电子邮件，但名称也不错）并将其插入 SQL 数据库（假设`$dbc`为 SQL 连接对象）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:04:43.147

```
$file = file_get_contents('emails.txt');
$file = explode(',',$file);
foreach ($file as $recipient) {
    $recipient = explode('<',$recipient);
    $name = trim($recipient[0]);
    $name = str_replace("'",'',$name); // remove apostrophes
    $name = str_replace('"','',$name); // remove double quotes
    $email = str_replace('>','',$recipient[1]); // remove ">"
    echo $name . ' ----- ' . $email . '<br />';
} 
```

# cloudbees - 在 Cloudbees 上部署 Liferay

> ID：12339728
> 
> 赞同：1
> 
> 时间：2012-09-09T14:01:31.057
> 
> 标签：cloudbees

我想在 Cloudbees 上部署 Liferay。我发现[这个博客“15 分钟到 cloudbees paas 上的 liferay”](http://blog.cloudbees.com/2011/09/15-minutes-to-liferay-on-cloudbees-paas.html)，其中包含有关如何操作的说明。我按照所有这些说明进行操作，实际部署似乎很顺利。日志中也没有错误消息。但是当我单击应该指向我的站点的链接（上面有 Liferay）时，我收到资源不可用的消息。有谁知道我可能做错了什么？

我自己的猜测是我在 portal-ext.properties 中没有正确的值，所以这里是：

```
jdbc.default.driverClassName=com.cloudbees.jdbc.Driver
jdbc.default.url=jdbc:cloudbees://liferay_db/liferay_db?useUnicode=true&characterEncoding=UTF-8&useFastDateParsing=false
jdbc.default.username=MyUserName
jdbc.default.password=MyPassword
#lucene.store.type=ram
#lucene.store.jdbc.auto.clean.up.enabled=true 
```

**[更新]** 我现在已经尝试了 Liferay Clickstart。现在，当我访问该站点时，我得到一个“502 Bad gateway”。但至少这次日志中有错误信息：

```
19:17:03,413 ERROR [main][JDBCExceptionReporter:76] Table 'liferay-po-12.portalpreferences' doesn't exist
19:17:03,565 ERROR [main][FileChecker:123] 
com.liferay.portal.kernel.exception.SystemException:  
com.liferay.portal.kernel.dao.orm.ORMException: 
org.hibernate.exception.SQLGrammarException: could not execute query
com.liferay.portal.kernel.exception.SystemException: 
com.liferay.portal.kernel.dao.orm.ORMException: 
org.hibernate.exception.SQLGrammarException: could not execute query
at 
com.liferay.portal.service.persistence.impl.BasePersistenceImpl.processException(BasePersistenceImpl.java:193)
at com.liferay.portal.service.persistence.PortalPreferencesPersistenceImpl.fetchByO_O(PortalPreferencesPersistenceImpl.java:600)
at com.liferay.portal.service.persistence.PortalPreferencesPersistenceImpl.fetchByO_O(PortalPreferencesPersistenceImpl.java:519)
at com.liferay.portal.service.impl.PortalPreferencesLocalServiceImpl.doGetPreferences(PortalPreferencesLocalServiceImpl.java:170)
at com.liferay.portal.service.impl.PortalPreferencesLocalServiceImpl.getPreferences(PortalPreferencesLocalServiceImpl.java:101)
at com.liferay.portal.service.impl.PortalPreferencesLocalServiceImpl.getPreferences(PortalPreferencesLocalServiceImpl.java:88)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at com.liferay.portal.spring.aop.ServiceBeanMethodInvocation.proceed(ServiceBeanMethodInvocation.java:122)
at com.liferay.portal.spring.transaction.TransactionInterceptor.invoke(TransactionInterceptor.java:71)
at com.liferay.portal.spring.aop.ServiceBeanMethodInvocation.proceed(ServiceBeanMethodInvocation.java:118)
at com.liferay.portal.spring.aop.ChainableMethodAdvice.invoke(ChainableMethodAdvice.java:57)
at com.liferay.portal.spring.aop.ServiceBeanMethodInvocation.proceed(ServiceBeanMethodInvocation.java:118)
at com.liferay.portal.spring.aop.ChainableMethodAdvice.invoke(ChainableMethodAdvice.java:57)
at com.liferay.portal.spring.aop.ServiceBeanMethodInvocation.proceed(ServiceBeanMethodInvocation.java:118)
at com.liferay.portal.spring.aop.ChainableMethodAdvice.invoke(ChainableMethodAdvice.java:57)
at com.liferay.portal.spring.aop.ServiceBeanMethodInvocation.proceed(ServiceBeanMethodInvocation.java:118)
at com.liferay.portal.spring.aop.ChainableMethodAdvice.invoke(ChainableMethodAdvice.java:57)
at com.liferay.portal.spring.aop.ServiceBeanMethodInvocation.proceed(ServiceBeanMethodInvocation.java:118)
at com.liferay.portal.security.pacl.PACLAdvice.invoke(PACLAdvice.java:51)
at com.liferay.portal.spring.aop.ServiceBeanMethodInvocation.proceed(ServiceBeanMethodInvocation.java:118)
at com.liferay.portal.spring.aop.ServiceBeanAopProxy.invoke(ServiceBeanAopProxy.java:211)
at $Proxy67.getPreferences(Unknown Source)
at com.liferay.portal.service.PortalPreferencesLocalServiceUtil.getPreferences(PortalPreferencesLocalServiceUtil.java:282)
at com.liferay.portal.util.PrefsPropsUtil.getPreferences(PrefsPropsUtil.java:250)
at com.liferay.portal.util.PrefsPropsUtil.getPreferences(PrefsPropsUtil.java:241)
at com.liferay.portal.util.PrefsPropsUtil.getString(PrefsPropsUtil.java:448)
at com.liferay.portal.deploy.DeployUtil.getAutoDeployDestDir(DeployUtil.java:64)
at com.liferay.portal.deploy.DeployManagerImpl.getInstalledDir(DeployManagerImpl.java:60)
at com.liferay.portal.kernel.deploy.DeployManagerUtil.getInstalledDir(DeployManagerUtil.java:48)
at com.liferay.portal.security.pacl.checker.FileChecker.afterPropertiesSet(FileChecker.java:119)
at com.liferay.portal.security.pacl.BasePACLPolicy.initChecker(BasePACLPolicy.java:111)
at com.liferay.portal.security.pacl.BasePACLPolicy.initCheckers(BasePACLPolicy.java:146)
at com.liferay.portal.security.pacl.BasePACLPolicy.<init>(BasePACLPolicy.java:48)
at com.liferay.portal.security.pacl.InactivePACLPolicy.<init>(InactivePACLPolicy.java:32)
at com.liferay.portal.security.pacl.PACLPolicyManager.<clinit>(PACLPolicyManager.java:200)
at com.liferay.portal.security.pacl.PACLAdvice.invoke(PACLAdvice.java:47)
at com.liferay.portal.spring.aop.ServiceBeanMethodInvocation.proceed(ServiceBeanMethodInvocation.java:118)
at com.liferay.portal.spring.aop.ServiceBeanAopProxy.invoke(ServiceBeanAopProxy.java:211)
at $Proxy48.clear(Unknown Source)
at com.liferay.portal.service.LockLocalServiceUtil.clear(LockLocalServiceUtil.java:267)
at com.liferay.portal.events.StartupAction.doRun(StartupAction.java:75)
at com.liferay.portal.events.StartupAction.run(StartupAction.java:52)
at com.liferay.portal.servlet.MainServlet.processStartupEvents(MainServlet.java:1306)
at com.liferay.portal.servlet.MainServlet.init(MainServlet.java:214)
at javax.servlet.GenericServlet.init(GenericServlet.java:212)
at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1206)
at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1026)
at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4421)
at org.apache.catalina.core.StandardContext.start(StandardContext.java:4734)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
at org.apache.catalina.startup.Embedded.start(Embedded.java:825)
at com.staxnet.appserver.TomcatServerBase.startContainer(TomcatServerBase.java:120)
at com.staxnet.appserver.TomcatServerBase.start(TomcatServerBase.java:190)
at com.staxnet.appserver.StaxAppServer.main(StaxAppServer.java:89)
at com.staxnet.appserver.SnazAppServer.main(SnazAppServer.java:26)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at net.stax.appserver.bootstrap.Bootstrap.invokeAppServerMain(Bootstrap.java:41)
at net.stax.appserver.bootstrap.Bootstrap.main(Bootstrap.java:30)
Caused by: com.liferay.portal.kernel.dao.orm.ORMException: 
org.hibernate.exception.SQLGrammarException: could not execute query
at com.liferay.portal.dao.orm.hibernate.ExceptionTranslator.translate(ExceptionTranslator.java:30)
at com.liferay.portal.dao.orm.hibernate.QueryImpl.list(QueryImpl.java:98)
at com.liferay.portal.dao.orm.hibernate.QueryImpl.list(QueryImpl.java:75)
at com.liferay.portal.service.persistence.PortalPreferencesPersistenceImpl.fetchByO_O(PortalPreferencesPersistenceImpl.java:575)
... 65 more
Caused by: org.hibernate.exception.SQLGrammarException: could not execute query
at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:92)
at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
at org.hibernate.loader.Loader.doList(Loader.java:2545)
at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2276)
at org.hibernate.loader.Loader.list(Loader.java:2271)
at org.hibernate.hql.classic.QueryTranslatorImpl.list(QueryTranslatorImpl.java:940)
at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:196)
at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1268)
at org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)
at com.liferay.portal.dao.orm.hibernate.QueryImpl.list(QueryImpl.java:86)
... 67 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table 'liferay-po-12.portalpreferences' doesn't exist
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
at com.mysql.jdbc.Util.handleNewInstance(Util.java:407)
at com.mysql.jdbc.Util.getInstance(Util.java:382)
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)
at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3603)
at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3535)
at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1989)
at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2150)
at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2626)
at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2119)
at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2281)
at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:208)
at org.hibernate.loader.Loader.getResultSet(Loader.java:1953)
at org.hibernate.loader.Loader.doQuery(Loader.java:802)
at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:274)
at org.hibernate.loader.Loader.doList(Loader.java:2542)
... 74 more
19:17:04,035 ERROR [main][JDBCExceptionReporter:76] Table 'liferay-po-12.lock_' doesn't exist 
```

还有一条关于日志文件不存在的消息：

```
log4j:ERROR setFile(null,true) call failed.
java.io.FileNotFoundException: /tmp/liferay/logs/liferay.2012-09-17.log (Permission denied)
at java.io.FileOutputStream.openAppend(Native Method)
at java.io.FileOutputStream.<init>(FileOutputStream.java:192)
at java.io.FileOutputStream.<init>(FileOutputStream.java:116)
at org.apache.log4j.FileAppender.setFile(FileAppender.java:294)
at org.apache.log4j.FileAppender.activateOptions(FileAppender.java:165)
at org.apache.log4j.rolling.RollingFileAppender.activateOptions(RollingFileAppender.java:179)
at org.apache.log4j.config.PropertySetter.activate(PropertySetter.java:307)
at org.apache.log4j.xml.DOMConfigurator.parseAppender(DOMConfigurator.java:295)
at org.apache.log4j.xml.DOMConfigurator.findAppenderByName(DOMConfigurator.java:176)
at org.apache.log4j.xml.DOMConfigurator.findAppenderByReference(DOMConfigurator.java:191)
at org.apache.log4j.xml.DOMConfigurator.parseChildrenOfLoggerElement(DOMConfigurator.java:523)
at org.apache.log4j.xml.DOMConfigurator.parseRoot(DOMConfigurator.java:492)
at org.apache.log4j.xml.DOMConfigurator.parse(DOMConfigurator.java:1001)
at org.apache.log4j.xml.DOMConfigurator.doConfigure(DOMConfigurator.java:867)
at org.apache.log4j.xml.DOMConfigurator.doConfigure(DOMConfigurator.java:815)
at com.liferay.util.log4j.Log4JUtil.configureLog4J(Log4JUtil.java:79)
at com.liferay.util.log4j.Log4JUtil.configureLog4J(Log4JUtil.java:57)
at com.liferay.portal.util.InitUtil.init(InitUtil.java:99)
at com.liferay.portal.spring.context.PortalContextLoaderListener.contextInitialized(PortalContextLoaderListener.java:149)
at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4206)
at org.apache.catalina.core.StandardContext.start(StandardContext.java:4705)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
at org.apache.catalina.startup.Embedded.start(Embedded.java:825)
at com.staxnet.appserver.TomcatServerBase.startContainer(TomcatServerBase.java:120)
at com.staxnet.appserver.TomcatServerBase.start(TomcatServerBase.java:190)
at com.staxnet.appserver.StaxAppServer.main(StaxAppServer.java:89)
at com.staxnet.appserver.SnazAppServer.main(SnazAppServer.java:26)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at net.stax.appserver.bootstrap.Bootstrap.invokeAppServerMain(Bootstrap.java:41)
at net.stax.appserver.bootstrap.Bootstrap.main(Bootstrap.java:30) 
```

[/更新]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T10:12:44.323

我建议使用新创建的 Liferay ClickStart，您可以在此处找到： [https ://github.com/CloudBees-community/liferay-clickstart](https://github.com/CloudBees-community/liferay-clickstart)

您必须单击“立即在 CloudBees 上部署”按钮，并且需要进行两项修改才能正常运行（也许这就是它最初不适合您的原因，因为 Tomcat 将返回“资源不可用”，如果它用完了 PermGen 空间）

*   使用以下命令设置更大的 PermGen 空间：

    ```
    bees app:update ACCOUNT/APP_NAME jvmPermSize=256 
    ```

*   使用 CloudBees Web 管理控制台将应用程序的大小更改为 Liferay 推荐的 1024MB。

# compiler-construction - Mac OS 应用程序无法运行

> ID：12339735
> 
> 赞同：10
> 
> 时间：2012-09-09T14:02:57.210
> 
> 标签：compiler-construction, loading

您好，我正在尝试构建一个简单的 Web 浏览器，当我尝试在 xcode 构建器中运行该程序时，它说构建成功，然后出现错误并停止加载

错误：

```
argv    char ** 0x00007fff5fbff7b8
*argv   char *  0x00007fff5fbff940
**argv  char    '/(My Directory>>>>)' 
```

输出：

```
2012-09-09 09:59:52.917 Snow Storm[29121:403] An uncaught exception was raised
2012-09-09 09:59:52.919 Snow Storm[29121:403] *** -[NSKeyedUnarchiver decodeObjectForKey:]: cannot decode object of class (WebView)
2012-09-09 09:59:52.924 Snow Storm[29121:403] (
    0   CoreFoundation                      0x00007fff85f6ef56 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff8cb2bd5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff85f6ed8a +[NSException raise:format:arguments:] + 106
    3   CoreFoundation                      0x00007fff85f6ed14 +[NSException raise:format:] + 116
    4   Foundation                          0x00007fff8d8bb705 _decodeObjectBinary + 2714
    5   Foundation                          0x00007fff8d8bc976 -[NSKeyedUnarchiver _decodeArrayOfObjectsForKey:] + 1193
    6   Foundation                          0x00007fff8d89345c -[NSArray(NSArray) initWithCoder:] + 486
    7   Foundation                          0x00007fff8d8bb797 _decodeObjectBinary + 2860
    8   Foundation                          0x00007fff8d8baab2 _decodeObject + 201
    9   AppKit                              0x00007fff8365cee6 -[NSView initWithCoder:] + 1051
    10  Foundation                          0x00007fff8d8bb797 _decodeObjectBinary + 2860
    11  Foundation                          0x00007fff8d8baab2 _decodeObject + 201
    12  AppKit                              0x00007fff8374dd1a -[NSWindowTemplate initWithCoder:] + 3998
    13  Foundation                          0x00007fff8d8bb797 _decodeObjectBinary + 2860
    14  Foundation                          0x00007fff8d8bc976 -[NSKeyedUnarchiver _decodeArrayOfObjectsForKey:] + 1193
    15  Foundation                          0x00007fff8d8bc377 -[NSSet(NSSet) initWithCoder:] + 519
    16  Foundation                          0x00007fff8d8bb797 _decodeObjectBinary + 2860
    17  Foundation                          0x00007fff8d8baab2 _decodeObject + 201
    18  AppKit                              0x00007fff83561871 -[NSIBObjectData initWithCoder:] + 2099
    19  Foundation                          0x00007fff8d8bb797 _decodeObjectBinary + 2860
    20  Foundation                          0x00007fff8d8baab2 _decodeObject + 201
    21  AppKit                              0x00007fff83560f1c loadNib + 235
    22  AppKit                              0x00007fff83560470 +[NSBundle(NSNibLoading) _loadNibFile:nameTable:withZone:ownerBundle:] + 217
    23  AppKit                              0x00007fff8356038b +[NSBundle(NSNibLoading) loadNibFile:externalNameTable:withZone:] + 141
    24  AppKit                              0x00007fff835602ce +[NSBundle(NSNibLoading) loadNibNamed:owner:] + 364
    25  AppKit                              0x00007fff837d106f NSApplicationMain + 398
    26  Snow Storm                          0x0000000100001472 main + 34
    27  Snow Storm                          0x0000000100001444 start + 52
)
2012-09-09 09:59:53.026 Snow Storm[29121:403] *** Terminating app due to uncaught exception 'NSInvalidUnarchiveOperationException', reason: '*** -[NSKeyedUnarchiver decodeObjectForKey:]: cannot decode object of class (WebView)'
*** First throw call stack:
(
    0   CoreFoundation                      0x00007fff85f6ef56 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff8cb2bd5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff85f6ed8a +[NSException raise:format:arguments:] + 106
    3   CoreFoundation                      0x00007fff85f6ed14 +[NSException raise:format:] + 116
    4   Foundation                          0x00007fff8d8bb705 _decodeObjectBinary + 2714
    5   Foundation                          0x00007fff8d8bc976 -[NSKeyedUnarchiver _decodeArrayOfObjectsForKey:] + 1193
    6   Foundation                          0x00007fff8d89345c -[NSArray(NSArray) initWithCoder:] + 486
    7   Foundation                          0x00007fff8d8bb797 _decodeObjectBinary + 2860
    8   Foundation                          0x00007fff8d8baab2 _decodeObject + 201
    9   AppKit                              0x00007fff8365cee6 -[NSView initWithCoder:] + 1051
    10  Foundation                          0x00007fff8d8bb797 _decodeObjectBinary + 2860
    11  Foundation                          0x00007fff8d8baab2 _decodeObject + 201
    12  AppKit                              0x00007fff8374dd1a -[NSWindowTemplate initWithCoder:] + 3998
    13  Foundation                          0x00007fff8d8bb797 _decodeObjectBinary + 2860
    14  Foundation                          0x00007fff8d8bc976 -[NSKeyedUnarchiver _decodeArrayOfObjectsForKey:] + 1193
    15  Foundation                          0x00007fff8d8bc377 -[NSSet(NSSet) initWithCoder:] + 519
    16  Foundation                          0x00007fff8d8bb797 _decodeObjectBinary + 2860
    17  Foundation                          0x00007fff8d8baab2 _decodeObject + 201
    18  AppKit                              0x00007fff83561871 -[NSIBObjectData initWithCoder:] + 2099
    19  Foundation                          0x00007fff8d8bb797 _decodeObjectBinary + 2860
    20  Foundation                          0x00007fff8d8baab2 _decodeObject + 201
    21  AppKit                              0x00007fff83560f1c loadNib + 235
    22  AppKit                              0x00007fff83560470 +[NSBundle(NSNibLoading) _loadNibFile:nameTable:withZone:ownerBundle:] + 217
    23  AppKit                              0x00007fff8356038b +[NSBundle(NSNibLoading) loadNibFile:externalNameTable:withZone:] + 141
    24  AppKit                              0x00007fff835602ce +[NSBundle(NSNibLoading) loadNibNamed:owner:] + 364
    25  AppKit                              0x00007fff837d106f NSApplicationMain + 398
    26  Snow Storm                          0x0000000100001472 main + 34
    27  Snow Storm                          0x0000000100001444 start + 52
)
terminate called throwing an exception(lldb) 
```

这是它所指的：

```
int main(int argc, char *argv[])
{
    return NSApplicationMain(argc, (const char **)argv);
} 
```

希望有人可以帮助

丹佛

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-05T06:20:08.873

您应该将 WebKit.framework 添加到您的项目中。

# c# - 林克。从多个表中选择

> ID：12339737
> 
> 赞同：19
> 
> 时间：2012-09-09T14:03:12.383
> 
> 标签：c#, sql, linq, select

在项目中我有这个表：

1.  产品（id，catalogId，manufacturerId...）
2.  目录
3.  制造商

还有`Product`型号`(id, name, catalogId, catalogTitle, manufacturerId, manufacturerName)`。

如果我想获取产品项目，如何在下面的 Linq 中编写这个 SQL 查询？

```
SELECT Product.Name, Product.CatalogId, Product.ManufacturerId, [Catalog].Name, Manufacturer.Name
FROM Product, [Catalog], Manufacturer
WHERE [Catalog].Id=Product.CatalogId AND Manufacturer.id=Product.ManufacturerId AND Product.Active=1 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-09-09T14:20:33.543

首先，我会回答您的问题..然后解决您对评论的回答。要回答您的问题，在 Linq 中您将执行以下操作：

```
from p in Product
join c in Catalog on c.Id equals p.CatalogId
join m in Manufacturer on m.Id equals p.ManufacturerId
where p.Active == 1
select new { Name = p.Name, CatalogId = p.CatalogId, ManufacturerId = p.ManufacturerId, CatalogName = c.Name, ManufacturerName = m.Name }; 
```

这将为您提供一个匿名对象，其中包含您请求的项目。如果您需要在其他地方使用它（并且您没有使用动态对象），我建议您创建一个视图模型，并在您的选择中实例化其中一个。

例子：

```
public class ProductInfoView 
{
     public string Name { get; set; }
     public int CatalogId { get; set; }
     public int ManufacturerId { get; set; }
     public string CatalogName { get; set; }
     public string ManufacturerName { get; set; }
}

from p in Product
join c in Catalog on c.Id equals p.CatalogId
join m in Manufacturer on m.Id equals p.ManufacturerId
where p.Active == 1
select new ProductInfoView() { Name = p.Name, CatalogId = p.CatalogId, ManufacturerId = p.ManufacturerId, CatalogName = c.Name, ManufacturerName = m.Name }; 
```

这将使引用您的查询结果不那么痛苦。

为了回答您的评论，如果您想要的只是产品，那么您正在做很多连接。您的标准只能确保三件事

1.  您的产品的活动标志为 1
2.  您的产品有一个现有的目录条目
3.  您的产品有一个现有的制造商条目

如果 #2 和 #3 是多余的并且您不一定需要名称，您可以简单地执行以下操作：

```
from p in Product
where p.Active == 1
select p 
```

如果 Product 是 CRUD 模型，您可能会对其进行深度加载以包含制造商/目录信息，或使用上述视图模型。

祝你好运！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-04-07T07:45:01.453

要在没有显式连接的情况下组合来自多个表的结果：

```
from p in Product
from c in Catalog
from m in Manufacturer
where c.Id == p.CatalogId && m.Id == p.ManufacturerId && p.Active == 1
select new 
    { 
        p.Name,
        p.CatalogId,
        p.ManufacturerId,
        c.Name,
        m.Name 
    }; 
```

# wordpress - 为什么无法使用 query_posts 检索自定义 post_type？

> ID：12339743
> 
> 赞同：1
> 
> 时间：2012-09-09T14:04:06.133
> 
> 标签：wordpress, wordpress-theming

我在 function.php 中声明了一个自定义帖子类型，如下所示：

```
register_post_type('movies', array(
    'label' => __("Movies", TEMPLATENAME),
    'singular_label' => __("Movie", TEMPLATENAME),
    'public' => true,
    'show_ui' => true,
    'exclude_from_search' => true,
    'publicly_queryable' => true,
    'capability_type' => 'post',
    'hierarchical' => false,
    'permalink_epmask' => EP_PERMALINK,
    'rewrite' => array('slug' => 'cine', 'with_front'=> false),
    'query_var' => 'movies',
    'show_in_nav_menus' => true,
    'menu_position' => 20,
    'description' => __("These Movies will be automatically displayed on the &laquo;&nbsp;Movies&nbsp;&raquo; page.", TEMPLATENAME),
    'labels' => array('add_new_item' => __( "Ajouter une movie", TEMPLATENAME), 'add_new' => __( "Ajouter une movie", TEMPLATENAME), 'edit_item' => __( "Modifier la movie", TEMPLATENAME), 'new_item' => __( "Nouvelle movie", TEMPLATENAME), 'view_item' => __( "Voir la movie", TEMPLATENAME), 'search_items' => __( "Chercher dans toutes les movies", TEMPLATENAME), 'not_found' => __( "Not Found", TEMPLATENAME), 'not_found_in_trash' => __( "No movie found in trash", TEMPLATENAME)),
    'supports' => array('title', 'editor', 'thumbnail',  'excerpt','custom-fields')
    //, 'register_meta_box_cb' => 'movies_box_fields'
)); 
```

然后我尝试在这样的模板文件中检索它们：

```
<?php query_posts(array ( 'post_type' => 'movies' )); ?> 
```

它不起作用，它检索正常的帖子。如果我使用 post_type 'event' 它可以工作（它从事件管理器插件中检索事件）。

怎么了 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T20:42:20.190

尝试：

`<?php $loop = new WP_Query( array( 'post_type' => 'movies', 'posts_per_page' => 10 ) ); ?>`

并且：

[http://codex.wordpress.org/Function_Reference/flush_rewrite_rules](http://codex.wordpress.org/Function_Reference/flush_rewrite_rules)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T14:00:11.347

我终于设法使用 get_posts() 获取帖子

```
$args=array(
    'post_type'=> 'movies',
    'numberposts'=> -1
    );

$myposts = get_posts( $args );

foreach( $myposts as $post ) :
    setup_postdata($post);
    ...
endforeach; 
```

# matrix - 如何将二维数组放入 numpy 中的二维数组？

> ID：12339744
> 
> 赞同：0
> 
> 时间：2012-09-09T14:04:09.757
> 
> 标签：matrix, numpy

我有以下代码

```
a_alpha_beta = zeros((2,  len( atime ) ))

for i in range( len( atime ) ):        
        alpha_beta = transf.clarke(signal[0][i], signal[1][i], signal[2][i])
        a_alpha_beta[0][i] = alpha_beta[0][0] 
        a_alpha_beta[1][i] = alpha_beta[1][0] 
```

如何优化上面的代码，例如如何复制`alpha_beta`到`a_alpha_beta`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T19:17:16.860

我不完全知道函数 transf.clarke 的作用，但是您可以按如下方式完成您想要的复制操作：

```
import numpy as np

# generate a test input
x = np.arange(0, 10).reshape((2, 5))
print x

# simply copy 2d array
y = x.copy()
print y

# some new data (i.e., alpha_beta in the original code)
z = np.array([[10, 11, 12],
              [13, 14, 15]])
print z

# replace the iteration by numpy slicing to obtain the same result
x[0, :] = z[0, 0]
x[1, :] = z[1, 0]
print x 
```

# wcf - 应用程序池回收后 WCF 服务不可用

> ID：12339746
> 
> 赞同：1
> 
> 时间：2012-09-09T14:04:24.287
> 
> 标签：wcf, web-services, castle-windsor, application-pool, recycle

我正在开发一个使用托管在不同应用程序池中的 WCF 服务的网站，每次 WCF 服务的应用程序池回收时，我在使用该网站时都会收到 503：

```
[WebException: The remote server returned an error: (503) Server Unavailable.]
   System.Net.HttpWebRequest.GetResponse() +6440728
   System.ServiceModel.Channels.HttpChannelRequest.WaitForReply(TimeSpan timeout) +55

[ServerTooBusyException: The HTTP service located at http://cr.genesis.dev/Genesis/RepositoryService.svc is unavailable.  This could be because the service is too busy or because no endpoint was found listening at the specified address. Please ensure that the address is correct and try accessing the service again later.]
... 
```

当我尝试直接在我的网络浏览器中访问该服务时，它第一次给了我一个 503，但之后它就起作用了（大概是它导致应用程序启动？）我想知道为什么网站没有唤醒Web 服务 - 即使我尝试多次加载页面，我仍然会收到 503...

如果这有什么不同，我将使用 Windsor WCF 集成，将 LifestylePerWebRequest 用于我的客户端，将 LifestylePerThread 用于我的服务。

这是我的服务配置：

```
<system.serviceModel>
        <services>
            <service name="Genesis.Repository.Service.RepositoryService" behaviorConfiguration="repositoryServiceBehaviour">
                <host>
                    <baseAddresses>
                        <add baseAddress="http://cr.genesis.dev/Genesis/" />
                    </baseAddresses>
                </host>
                <endpoint name="basicHttpBinding"
                    address="RepositoryService.svc"
                    binding="basicHttpBinding"
                    contract="Genesis.Repository.Service.IRepositoryService" />
            </service>
        </services>
        <behaviors>
            <serviceBehaviors>
                <behavior name="repositoryServiceBehaviour">
                    <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
                    <serviceMetadata httpGetEnabled="true" />
                    <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
                    <serviceDebug includeExceptionDetailInFaults="false"/>
                </behavior>
            </serviceBehaviors>
        </behaviors>
        <serviceHostingEnvironment multipleSiteBindingsEnabled="true" aspNetCompatibilityEnabled="true" />
    </system.serviceModel> 
```

和客户：

```
<system.serviceModel>
        <client>
            <endpoint name="basicHttpBinding"
                 address="http://cr.genesis.dev/Genesis/RepositoryService.svc"
                 binding="basicHttpBinding"
                 contract="Genesis.Repository.Service.IRepositoryService" />
        </client>
    </system.serviceModel> 
```

任何建议，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T18:33:47.630

看起来我让它变得比它需要的更复杂 - 我一直在说它无法监听，`http://+:80`这就是为什么我玩弄`netsh`权限并让它监听的原因`/Genesis`。

原来我可以让它监听`/`并在向 Windsor 注册时指定`.Hosted()`它告诉它让 IIS 托管它（这正是我安装之前的样子`WcfFacility`！）

吸取的教训，有时你只需要回到基础，事情就会按预期工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-13T09:05:27.223

如果您发现“（503）服务器不可用错误”，那么首先要检查的是服务器是否正在运行。为此，请转到 IIS 并检查网站是否打开。

# ubuntu - 延迟：名称服务器：gmail.com。：主机名查找失败

> ID：12339747
> 
> 赞同：0
> 
> 时间：2012-09-09T14:04:31.773
> 
> 标签：ubuntu, smtp, sendmail

我在本地机器上使用 zf 和 google 的 smtp，服务器花费的时间太长，然后检查日志消息我得到以下信息：

```
mymachinename sm-mta[20775]: q89DwF0X020757: to=<myaccountname@gmail.com>, ctladdr=<XXXXX@localhost.local> (1000/1000), delay=00:00:40, xdelay=00:00:20, mailer=esmtp, pri=120528, relay=gmail.com., dsn=4.0.0, stat=Deferred: Name server: gmail.com.: host name lookup failure 
```

SMTP 配置：

```
mail.smtp.host= "smtp.gmail.com"
mail.smtp.auth= "login"
mail.smtp.username="myusername@gmail.com"
mail.smtp.password="password"
mail.smtp.port="465"
mail.smtp.ssl="tls" 
```

有任何想法吗 ？

# android - 9-patch 背景图像的布局问题

> ID：12339751
> 
> 赞同：1
> 
> 时间：2012-09-09T14:04:47.570
> 
> 标签：android, image, layout, background, resize

我的布局有一个 9 补丁背景图像，当显示分辨率小于图像 (800x480px) 时，它可以正常工作。但是，当我在具有更大分辨率（例如 1280x800 像素）的设备上对其进行测试时，布局会被破坏。这里有两张图片：

[正常和破碎的布局](https://dl.dropbox.com/u/61662712/layout_broken.jpg)

[9 补丁图像](https://dl.dropbox.com/u/61662712/chalkboard.9.png)

这是相关的布局代码：

```
<LinearLayout
android:id="@+id/LinearLayout1"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:layout_weight="1"
android:background="@drawable/chalkboard"
android:gravity="top|center"
android:orientation="vertical" > 
```

总而言之，当图像放大时，9-patch 不起作用。但这是什么原因，我该如何处理呢？

最好的祝福！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T15:54:22.703

您也在拉伸框架。只是不要拉伸侧面的框架。这应该做的工作： ![在此处输入图像描述](../Images/56c25ead17c450c6cb99eec51d1d9611.png)

# android - 无法发送包含变音符号的短信（以编程方式）

> ID：12339760
> 
> 赞同：2
> 
> 时间：2012-09-09T14:06:03.453
> 
> 标签：android, sms, chars

我使用以下方法发送短信：

```
sendTextMessage(address, null, text, null, null); 
```

使用英文字符时一切正常，但如果文本包含至少一个变音字符，则不会发送短信。

请注意，我没有收到任何异常，似乎一切正常，但没有发送短信。

有没有办法解决这个问题？

# windows-8 - 如何结合必应地图和列表视图？

> ID：12339763
> 
> 赞同：1
> 
> 时间：2012-09-09T14:06:44.263
> 
> 标签：windows-8, windows-runtime, bing-maps, winrt-xaml

我的应用程序中有一个 bing 地图。我数据库中的所有存储位置都以图钉的形式显示在地图上。在地图的右侧，我有一个这个位置的列表。单击列表视图上的位置后，我需要做什么来更改地图上图钉的颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-18T12:18:06.430

为此，您需要某种数据将列表项链接到图钉。如果您有一个唯一的 ID 值，可以将其存储为列表项的属性（标签属性效果很好）。您还可以将 ID 值存储在图钉的 Tag 属性中。

然后，当您要设置选定的图钉时，循环遍历地图上的所有图钉并检查标签属性中的正确 id。想要将图钉的背景颜色设置为您想要的默认值，并且当您找到具有匹配 id 的图钉时，将背景颜色设置为突出显示颜色。

# php - php 从 mysql 数据库中删除项目

> ID：12339766
> 
> 赞同：0
> 
> 时间：2012-09-09T14:07:10.083
> 
> 标签：php, mysql, html, phpmyadmin

希望有人可以在这里帮助我，我想我的函数调用不正确。我正在尝试从我的数据库中检索一些数据，并在每个要检索的项目上附加一个删除链接，这样当我点击删除时，它将删除具有删除功能的特定项目。

我从数据库中检索项目的代码如下。

```
<?php
$con = mysql_connect("localhost","root","");
mysql_select_db("uloaku", $con);
$count = 1;
$y = mysql_query("SELECT * FROM transaction");
if(mysql_num_rows($y) != 0){

echo "<table bgcolor=\"white\" width=\"1000\" bordercolor=\"grey\" border=\"5\" >";
echo "<tr>
<td align=\"center\">No</td>
<td align=\"center\">Date</td>
<td align=\"center\">Current Balance</td>
<td align=\"center\">Avaliable Balance</td>
<td align=\"center\">Account Status</td>
<td align=\"center\">Delete Account</td>

</tr>";

while ($z = mysql_fetch_array($y, MYSQL_BOTH)){
        echo "<tr>
        <td align=\"center\">".$count++."</td>
        <td align=\"center\">".$z[1]."</td>
        <td align=\"center\">".$z[2]."</td>
        <td align=\"center\">".$z[3]."</td>
        <td align=\"left\" width=\"300\">".$z[4]."</td>
        <td><a href=\"delete.php\">delete</a></td>
        </tr>";
    }
    echo "</table>";
    }
?> 
```

还有我要删除的代码

```
<?php
session_start();
$con = mysql_connect("localhost","root","");
mysql_select_db("uloaku", $con);
$id = $_GET['id'];
$sql = mysql_query("DELETE FROM transaction WHERE id='$id' LIMIT 1") or die   (mysql_error());
header("Location: vacct.php");
?> 
```

我知道我错过了这里的逻辑，希望有人可以指导我或向我展示简单的出路。目前我可以成功地从数据库中检索我的项目，我唯一的问题是每次点击删除按钮时都能够应用删除功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:10:19.140

`id`当您点击删除链接时，您必须通过：

```
<a href=\"delete.php?id=$z[theIdKey]\"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:10:16.443

```
<td><a href=\"delete.php\">delete</a></td> 
```

您如何将要删除的 id 传递给您的 delete.php 脚本？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T14:12:18.940

改变：

```
<td><a href=\"delete.php\">delete</a></td> 
```

到：

```
<td><a href=\"delete.php?id=".$z[0]."\">delete</a></td> 
```

如果 $z[0] 是 ID。

在您的 delete.php 中，确保您还使用反引号对“事务”一词进行转义：

```
DELETE FROM `transaction` WHERE id=123 
```

这是因为“事务”是一个保留的 mysql 关键字。

另请阅读[SQL 注入](http://php.net/manual/en/security.database.sql-injection.php)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T14:15:57.763

使用下面的代码。我添加了验证和加密

```
<?php
$con = mysql_connect("localhost","root","");
mysql_select_db("uloaku", $con);
$count = 1;
$y = mysql_query("SELECT * FROM transaction");
if(mysql_num_rows($y) != 0){

echo "<table bgcolor=\"white\" width=\"1000\" bordercolor=\"grey\" border=\"5\" >";
echo "<tr>
<td align=\"center\">No</td>
<td align=\"center\">Date</td>
<td align=\"center\">Current Balance</td>
<td align=\"center\">Avaliable Balance</td>
<td align=\"center\">Account Status</td>
<td align=\"center\">Delete Account</td>

</tr>";

while ($z = mysql_fetch_array($y, MYSQL_BOTH)){
        echo "<tr>
        <td align=\"center\">".$count++."</td>
        <td align=\"center\">".$z[1]."</td>
        <td align=\"center\">".$z[2]."</td>
        <td align=\"center\">".$z[3]."</td>
        <td align=\"left\" width=\"300\">".$z[4]."</td>
        <td><a href=\"delete.php?id=".base64_encode($z[0])."\">delete</a></td>
        </tr>";
    }
    echo "</table>";
    }
?>

code to delete

<?php
session_start();
$con = mysql_connect("localhost","root","");
mysql_select_db("uloaku", $con);
$id = base64_decode($_GET['id']);
if(!empty($id)){
$sql = mysql_query("DELETE FROM transaction WHERE id='$id' LIMIT 1") or die   (mysql_error());
}
header("Location: vacct.php");
?> 
```

# c# - C# WinForms 用户管理

> ID：12339769
> 
> 赞同：1
> 
> 时间：2012-09-09T14:07:34.030
> 
> 标签：c#, winforms, forms

我正在开发我的第一个 C# 程序，到目前为止已经对数据库连接、用户表、添加新用户、使用盐哈希密码登录等进行了排序，但现在我陷入了如何管理用户的困境。

我的用户表有：

*   编号（整数）
*   名称 (nvarchar)
*   用户名 (nvarchar)
*   密码（nvarchar - 这是加盐的哈希）
*   管理员（位）

我想创建一个管理用户的表单，但不知道如何布局并创建最佳 UI。

只有当当前登录的用户是管理员时才能访问该表单，但这很容易解决，所以我不担心实现它。

如果有人能给我一些想法，甚至提供他们如何布置用户管理的示例表单视图，那将非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:53:13.367

这是一个示例（LightSwitch 应用程序的管理）：

![灯开关应用](../Images/4448e8181389ef3edb50a6399daa8923.png)

# html - content-type 和 enctype 有什么区别

> ID：12339770
> 
> 赞同：13
> 
> 时间：2012-09-09T14:07:36.807
> 
> 标签：html, forms, gwt

对于 HTML 表单。我很困惑，我正在尝试设置 enctype='application/octet-stream' 但服务器接收到 content-type ='application/x-www-form-urlencoded' （默认值）的请求。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-09T14:27:21.950

该`enctype`属性指定`Content-Type`浏览器在向服务器提交表单数据时使用的内容类型（以 HTTP 术语，如标头所示）。

但是，该[规范](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4)在此上下文中仅定义了两种内容类型，`application/x-www-form-urlencoded`（默认）和`multipart/form-data`, 并添加：“未指定其他内容类型的行为。” 实际发生的情况是浏览器会默默地忽略`enctype`具有其他值的属性，使用默认值。例如，如果您在 Firebug 中检查文档，您可以看到这一点：检查`form`元素，DOM 窗格包含属性`enctype`— 具有默认值。在 Web 浏览器中，对标记中的错误保持沉默是很常见的。

在这种情况下，该类型`application/octet-stream`不会很有用，因为如果浏览器发送此类信息，它实际上会说“这是一组未知（或未指定）结构的二进制数据”。

# assembly - 在 ARM 程序集中修改 RTSM 中的 timer-0 控制字段

> ID：12339773
> 
> 赞同：1
> 
> 时间：2012-09-09T14:08:14.927
> 
> 标签：assembly, timer, arm

我不知道如何修改 Timer-0 控制字段。到目前为止，我有以下内容：

```
ldr r0, =0x1C110000 @ defined in DUI0575D VE RTSM model memory map
control .req r1
ldrb control, [r0, #8] @ load Timer1Control byte with offset 8, as defined in DDI0271 
```

然后我总是得到一个`Data Abort Exception from S:0x00008064` 与数据表中定义的不同的解释似乎没有太多空间，这让我相当无能。

旁注：我尝试简单地输入`0x1C110008`DS-5 IDE 中的“内存”选项卡，它只是给出了一些红色的列......

# c# - Add folder files to listbox by LINQ

> ID：12339775
> 
> 赞同：-1
> 
> 时间：2012-09-09T14:08:31.207
> 
> 标签：c#, linq, file

I use the below code to get files with different extensions in the folder by LINQ, but no file is found.

```
var dirInfo = new DirectoryInfo(Application.StartupPath + "\\TextDocument\\");
var filteredFiles = (from fileDir in dirInfo.GetFiles()
                        where (fileDir.Extension == "*.jpg" || fileDir.Extension == "*.rtf")
                        select fileDir).ToList();

foreach (var item in filteredFiles)
{
    listBox1.Items.Add(item);
} 
```

I get `filteredFiles.count = 0` in the `foreach` loop. What's wrong in this code?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T14:11:09.730

Please try remove `*` from `*.jpg`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:38:45.540

Try with,

```
List<System.IO.FileInfo> oFileInfoList = new System.IO.DirectoryInfo(Application.StartupPath + "\\TextDocument\\").GetFiles().Where(o => o.Extension == ".jpg" || o.Extension == ".rtf").ToList<System.IO.FileInfo>(); 
```

FileInfo.Extension have extension without `*` i.e. .jpg, .png, .pdf

Hope It should Help.

# c# - 从其他线程添加 UserControl

> ID：12339778
> 
> 赞同：2
> 
> 时间：2012-09-09T14:09:09.780
> 
> 标签：c#, winforms, multithreading

我有我的用户控制权。我将这些用户控件（100 个或更多）的集合添加到面板中。而这个面板又被添加到主窗体中。所有这些都是在运行时完成的。由于有这么多用户控件，我的主窗体在添加这些用户控件之前没有响应。

我想知道我是否可以先将面板添加到表单中，然后从单独的线程创建我的用户控件并将它们添加到同一个面板，因此我的主表单始终可供用户使用。我所有的努力导致：

> “跨线程操作无效”错误。

如果有人可以帮助我，我会很高兴。

这是我现在正在做的事情

```
void main(){
    MyPanel pnlObj = new MyPanel();
    this.Controls.Add(pnlObj);
}

Class MyPanel{

    public void Panel()
    {
        MyUserControl uc1 = new MyUserControl();
        MyUserControl uc2 = new MyUserControl();
        this.Add(uc1);
        this.Add(uc2);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T14:12:26.790

您不能在非 UI 线程中使用视觉元素，对此感到抱歉。

但是您可以做的是在非 UI 线程中创建所有必要的数据，并将创建 UI 元素和更新 UI 委托给 UI 线程。

这看起来像这样：

```
// in background thread
ComputeDataSlowly();
MainForm.Invoke(() =>
{
    var control = CreateNewControlFromData();
    MainForm.Add(control);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T14:14:46.707

我不确定您的问题是否有解决方案。只有 GUI 线程可以更新控件，因此即使您确实使用了额外的线程，您仍然必须通过 将创建/添加控件的工作转发到 GUI 线程`Invoke/BeginInvoke`，这又会导致您原来的问题。

# objective-c - 重复符号

> ID：12339780
> 
> 赞同：0
> 
> 时间：2012-09-09T14:09:19.987
> 
> 标签：objective-c, symbols

仍在开发我的游戏，并且每个难度我都有一个“gameSpeed”，这取决于选择的难度。

但是，当尝试运行我的应用程序时，出现以下错误：

```
duplicate symbol _gameSpeed in:
/Users/Ashley/Library/Developer/Xcode/DerivedData/Whack-etfeadnxmmtdkgdoyvgumsuaapsz/Build/Intermediates/Whack.build/Debug-iphonesimulator/Whack.build/Objects-normal/i386/TimedGameLayer.o
/Users/Ashley/Library/Developer/Xcode/DerivedData/Whack-etfeadnxmmtdkgdoyvgumsuaapsz/Build/Intermediates/Whack.build/Debug-iphonesimulator/Whack.build/Objects-normal/i386/GameInfo.o
ld: 1 duplicate symbols for architecture i386
collect2: ld returned 1 exit status
Command /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/llvm-gcc-4.2 failed with exit code 1 
```

我只在一个位置使用 gameSpeed。

这是在这里：

```
[self schedule:@selector(tryPopMoles:) interval:gameSpeed]; 
```

这是在我的 TimedGameLayer.m 里面

gameSpeed 变量在我的 GameInfo.h 中

我像这样导入标题：

```
#import "GameInfo.h" 
```

我的 GameInfo.h 看起来像这样：

```
@interface GameInfo : NSObject
+(void)setupGame:(enum GameType)type withArg2:(enum GameDifficulty)difficulty;
+(void)resetGame;
+(void)togglePause;

@end

//Game Type
enum GameType gameType;
enum GameDifficulty gameDifficulty;

//Release Version
NSString *version;

//Settings
int gameSpeed = 1.5;

//Stats
int touches = 0;
int score = 0;
int totalSpawns = 0;

//usables
bool gamePaused = FALSE;

typedef enum GameType {
    GameTypeClassic = 0,
    GameTypeUnlimited,
    GameTypeTimed,
    GameTypeExpert,
} GameType;

typedef enum GameDifficulty
{
    GameDifficultyEasy = 0,
    GameDifficultyMedium,
    GameDifficultyHard,
} GameDifficulty; 
```

我的 setupGame 函数（在我的 GameInfo.m 文件中）如下所示：

```
+(void)setupGame:(enum GameType)type withArg2:(enum GameDifficulty)difficulty
{
    gameType = type;
    gameDifficulty = difficulty;

    switch(gameDifficulty)
    {
        case GameDifficultyEasy:
            gameSpeed = 1.5;
            break;
        case GameDifficultyMedium:
            gameSpeed = 1.0;
            break;
        case GameDifficultyHard:
            gameSpeed = 0.5;
            break;
    }
} 
```

我完全迷失在这里...

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:12:53.197

根据您在下面的评论和您的示例代码：

您在 .h 文件中声明了一系列变量，并且 .h 文件被多次包含，因此您有多个同名变量。您应该创建一个 constants.h 和 constants.m 文件并将该列表声明为常量文件中的常量。

```
constants.h:
extern const int gameSpeed;

constants.m:
const int gameSpeed = 1; 
```

顺便说一句，您将 gameSpeed 声明为 int 但为其分配了一个浮点值，因此 gameSpeed 将等于 1。请改用浮点类型。

# php - CakePHP 需要关于组织模型的建议

> ID：12339782
> 
> 赞同：1
> 
> 时间：2012-09-09T14:09:45.793
> 
> 标签：php, mysql, cakephp, database-design

我正在开发一个像“黄页”这样的网站，它的数据库比我以前经历过的更复杂。

例如：这个数据库有 3 个表： 1\. 组织 - 带有一些一般信息。2\. 服务 - 列出可以提供的所有服务。3.关系表。

组织表结构：

```
id    name         city       phone      etc.
1     CompanyName  Farewell   987-65-43 
```

服务表结构：

```
id    ServiceType  
1     purchase  
-----
2     sale  
-----
3     exchange 
```

等等..你明白了

和关系表结构：

```
id    OrganisationID   ServId      
1     1                2
----
2     1                3
----   
3     1                6
----
4     2                3 
```

在网站输出中，我需要列出所有组织及其提供的所有服务。

我不能完全理解（即使在阅读了 CookBook 中的 Linking Models Together 部分之后）我应该如何使用 Cake 的语法和约定来组合所有这些表。

如果有人可以为我提供 Cake 的模型/模型（我需要多少？）示例，并且能够检索这些数据，我会很高兴。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T14:47:08.700

我无法评论你的问题，所以我会在这里问......

组织可以有很多服务，而服务可以有很多组织？是`HABTM`关系吗？（只是检查...）

如果是，我会编辑它并尝试给你答案。:)

编辑：

**表格**

```
1\. table: organisations
2\. table: services
3\. table: organisations_services (sorted alphabetically)

1\. table: id, name, city...
2\. table: id, service_type
3\. table: id, organisation_id, service_id (singular, sorted alphabetically) 
```

**楷模**

组织 - 在您的组织模型中，您必须拥有：

```
var $hasAndBelongsToMany = array('Service'); 
```

服务 - 在您的服务模型中，您必须拥有：

```
var $hasAndBelongsToMany = array('Organisation'); 
```

就这样。其他一切都留给美丽的蛋糕。:) 如果您有不明白的地方，请随时提问，[在这里](http://book.cakephp.org/1.3/view/1044/hasAndBelongsToMany-HABTM)您可以获得更多信息。

# drupal - 如何从 drupal 7 连接活动目录记录？

> ID：12339784
> 
> 赞同：-1
> 
> 时间：2012-09-09T14:09:49.283
> 
> 标签：drupal

我的问题，这可能吗？我们可以在 drupal 7 中做到这一点吗？如果可能的话，您能否在 drupal 7 中推荐一些模块或一些示例站点。我打算在 Drupal 7 中做我的项目。我还需要在我的项目中实现一个 Intranet 设施。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:25:35.370

是的，这绝对是可能的。您将需要[LDAP 模块](http://drupal.org/project/ldap)：

> LDAP 项目允许您使用组织现有的启用 LDAP 的身份管理服务（例如 Active Directory）进行 Drupal 帐户配置。

有一些相当广泛的[文档](http://drupal.org/node/997082)可用，这可能是最好的起点。

# python - DeprecationWarning：不推荐使用结构整数溢出屏蔽

> ID：12339785
> 
> 赞同：1
> 
> 时间：2012-09-09T14:10:02.807
> 
> 标签：python, struct

我有以下问题。代码如下所示：

```
import  binascii, struct
def crc32up(data):
    # little endian!!
    bin = struct.pack ('<I', binascii.crc32 (data))
    return string.upper (binascii.hexlify (bin))

# Generate crc of time code.
#
timecrc_code = crc32up(time_code) 
```

警告是：

```
 DeprecationWarning: struct integer overflow masking is deprecated
 timecrc_code = crc32up(time_code) 
```

是什么导致了这个错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-09T14:23:30.690

您尝试打包到为它们分配的 4 个字节中的值太大：

```
>>> import struct
>>> n = 2 ** 32
>>> n
4294967296L
>>> struct.pack('<I', n - 1)
'\xff\xff\xff\xff'
>>> struct.pack('<I', n)
__main__:1: DeprecationWarning: struct integer overflow masking is deprecated
'\x00\x00\x00\x00' 
```

*较新的 python 版本 (>= 2.6) 也会给你一个关于接受的值的*警告：

```
>>> import struct
>>> struct.pack('<I', -1)
__main__:1: DeprecationWarning: struct integer overflow masking is deprecated
__main__:1: DeprecationWarning: 'I' format requires 0 <= number <= 4294967295
'\xff\xff\xff\xff' 
```

python 告诉你的是它必须屏蔽这个值以适应 4 个字节；你可以自己用`value & 0xFFFFFFFF`.

在 python 程序执行期间仅发出一次警告。

请注意，从 2.6 开始，该`binascii.crc32`值始终是带*符号*的4 字节值，您应该始终使用掩码来打包这些值。这在 2.6 之前并不总是一致的，并且取决于平台。有关详细信息，请参阅[文档](http://docs.python.org/library/binascii.html#binascii.crc32)。

# sql-server-2008 - SQL Server 2008 Express版中的数据插入后不显示？

> ID：12339791
> 
> 赞同：0
> 
> 时间：2012-09-09T14:10:33.483
> 
> 标签：sql-server-2008, linq-to-sql

我有一个 SQL Server 2008 Express 版数据库，我正在使用 Linq-to-SQL 通过 Windows 应用程序向其中插入数据。我知道数据存在于数据库中，因为当我查询数据库时，我得到了一些数据，但在 SQL Server Management Studio 中，当我右键单击表并单击偶数时：“编辑前 200 行”或“选择前 1000 行”我不能查看任何数据！有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T19:07:19.807

假设您使用的是*User Instance 和 AttachDbFileName=*方法 - 我认为这种方法存在严重缺陷。Visual Studio 将在`.mdf`文件周围进行复制，并且**很可能**，您的`INSERT`工作正常 - 但您最终只是查看了**错误的 .mdf 文件**！

如果您想坚持使用这种方法，请尝试在`myConnection.Close()`调用上设置断点 - 然后`.mdf`使用 SQL Server Mgmt Studio Express 检查文件 - 我几乎可以肯定您的数据在那里。

**我认为真正的解决**方案是

1.  安装 SQL Server Express（反正你已经完成了）

2.  安装 SQL Server Management Studio Express

3.  **在SSMS Express**中创建您的数据库，给它一个逻辑名称（例如`VictoryDatabase`）

4.  使用它的逻辑**数据库名称**（在服务器上创建它时给出）连接到它——不要乱用物理数据库文件和用户实例。在这种情况下，您的连接字符串将类似于：

    ```
    Data Source=.\\SQLEXPRESS;Database=VictoryDatabase;Integrated Security=True 
    ```

    其他一切都和以前**完全**一样......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T17:53:36.043

我相信 LinqToSql 有一个“保存”命令，它实际上将数据写入数据库。在此之前，您只是将其保存在内存中。

ETA：查看[这个问题及其答案](https://stackoverflow.com/questions/428715/how-do-i-save-my-object-back-into-my-database-in-linq-to-sql)

# mysql - MySQL：在多个列值上加入条件

> ID：12339795
> 
> 赞同：1
> 
> 时间：2012-09-09T14:12:07.990
> 
> 标签：mysql, jointable

这是查询：

```
 SELECT CONCAT(imp_us_storefront.model,'/',imp_us_storefront.chassis) AS rec_desc, 1 AS flag,asc_model.model_id AS model,asc_chassis.chassis_id AS chassis
    FROM imp_us_storefront 
      JOIN asc_model ON (asc_model.rec_desc = imp_us_storefront.model)
      JOIN asc_chassis ON (asc_chassis.rec_desc = imp_us_storefront.chassis)
      JOIN attr_notebook ON (asc_model.model_id != attr_notebook.model_id AND asc_chassis.chassis_id != attr_notebook.chassis_id)
    WHERE imp_us_storefront.mri_category = '11946'
    GROUP BY rec_desc ASC; 
```

对于此特定类别“11946”，所有机箱 ID 都具有相同的值，因此结果集为空。如果我消除约束

```
 asc_chassis_chassis_id != attr_notebook.chassis_id 
```

然后我得到了我需要的结果，但这不适用于其他类别。所以我的问题是我如何转换这条线

```
 JOIN attr_notebook ON (asc_model.model_id != attr_notebook.model_id AND asc_chassis.chassis_id != attr_notebook.chassis_id) 
```

只消除 model_id 和 chassis_id 的特定组合，这样如果我有以下值

model_id 底盘 ID

2 6

3 6

我可以消除 2,6 但不能消除 3,6

或者

model_id 底盘 ID

4 2

4 3

我可以消除 4,2 但不能消除 4,3？

提前致谢。

# java - 如何像谷歌潮流一样将网页调整为水平滚动视图？

> ID：12339801
> 
> 赞同：1
> 
> 时间：2012-09-09T14:12:24.990
> 
> 标签：java, android, jquery, ios, html

在 Google Currents 应用中，用户可以左右滑动浏览内容。我知道那个视图是一个网络视图。

但我不知道如何使网页适合移动高度，水平滚动流畅。

它是使用 HTML5、jQuery 还是仅使用本机代码来处理它？

# haskell - 图形模型编辑器的 Zipper 数据结构

> ID：12339805
> 
> 赞同：8
> 
> 时间：2012-09-09T14:12:56.257
> 
> 标签：haskell, data-structures, zipper

我正在为“模型”（即具有某种语义的框和线的集合，例如 UML，其细节在这里无关紧要）编写一个图形编辑器。所以我想要一个表示模型的数据结构和一个图表，其中对图表的编辑会导致模型发生相应的变化。因此，例如，如果模型元素的属性中有一些文本，并且我在图表中编辑文本，我希望更新模型元素。

该模型可能会表示为一棵树，但我希望图表编辑器尽可能少地了解模型表示。（我正在使用[图表](http://projects.haskell.org/diagrams/)框架，因此将任意信息与图形元素关联起来很容易）。如果我能弄清楚应该是什么，可能会有一个“模型”类来对接口进行编码。

如果我用命令式语言来做这件事，那将很简单：我只需从图表中的图形元素到模型元素的引用。理论上，我仍然可以通过从大量 IORef 集合中构建模型来做到这一点，但这将是在 Haskell 中编写 Java 程序。

显然，每个图形元素都将有某种 cookie 与之相关联，这将使模型更新发生。一个简单的答案是给每个模型元素一个唯一的标识符并将模型存储在 Data.Map 查找表中。但这需要大量的簿记以确保没有两个模型元素获得相同的标识符。我也觉得它是一个[“字符串类型”](http://www.globalnerdy.com/2010/05/09/new-programming-jargon/)的解决方案；您必须处理一个对象被删除但在其他地方有一个悬空引用的情况，并且很难说您的类型中模型的内部结构。

另一方面，[奥列格关于带有多个孔的拉链和具有清晰事务共享的光标的著作](http://okmij.org/ftp/continuations/zipper.html#zipper2)听起来像是一个更好的选择，如果我能理解的话。我了解了列表和树拉链的基本概念以及数据结构的差异化。图表中的每个元素都可以将光标放入模型的拉链中吗？因此，如果进行了更改，则可以将其提交给所有其他游标？包括树操作（例如将子树从一个地方移动到另一个地方）？

在这一点上，如果有某种关于定界延续的教程，以及它们如何使 Oleg 的多光标拉链工作的解释，这将特别有助于我，这比 Oleg 的帖子稍微不那么陡峭？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T05:57:29.633

我认为您目前正在设计模型树中的每个节点都由一个单独的图形小部件表示，并且这些小部件中的每一个都可以独立更新模型。如果是这样，我不相信多孔拉链会很实用。问题是拉链的复杂性会随着您希望支撑的孔的数量而迅速增长。当你超过 2 项时，拉链的尺寸会变得很大。从区分的角度来看，2孔拉链是1孔拉链上的拉链，因此复杂性随着链式法则的运算而增长。

相反，您可以从 MVC 中借用一个想法。每个节点仍然与一个小部件相关联，但它们不直接通信。相反，它们会通过一个中间控制器，该控制器维护一个拉链。当小部件更新时，它们会通知控制器，控制器会序列化所有更新并相应地修改拉链。

小部件仍然需要某种标识符来引用模型节点。我发现使用节点的路径通常是最容易的，例如`[0]`对于根，`[1,0]`对于根的第二个孩子等等。这有一些优点。确定路径所指的节点很容易，并且拉链也很容易计算从当前位置到给定节点的最短路径。对于树结构，它们在删除和重新插入之前也是唯一的。即使这通常不是问题，因为当通知控制器应该删除节点时，它可以删除相应的小部件并忽略任何相关的更新。只要小部件的生命周期与每个节点的生命周期相关联，路径就会足够独特以识别任何修改。

对于树操作，我可能会破坏然后重新创建图形小部件。

例如，我有一些代码可以[做这种事情](http://www.tiresiaspress.us/haskell/jaek/)。在此模型中，每个节点都没有单独的小部件，而是我使用图表呈现所有内容，然后根据单击位置查询图表以获取进入数据模型的路径。它远未完成，我也有一段时间没有看它，所以它可能无法构建，但代码可能会给你一些想法。

# javascript - 使用 Jinja2 为 JavaScript 转义字符串？

> ID：12339806
> 
> 赞同：22
> 
> 时间：2012-09-09T14:12:57.817
> 
> 标签：javascript, python, jinja2

如何使用 Jinja2 转义 HTML，以便它可以用作 JavaScript (jQuery) 中的字符串？

如果我使用 Django 的模板系统，我可以这样写：

```
$("#mydiv").append("{{ html_string|escapejs }}"); 
```

Django 的[`|escapejs`过滤器](https://github.com/django/django/blob/ebc773ada3e4f40cf5084268387b873d7fe22e8b/django/utils/html.py#L63)会转义`html_string`（例如引号、特殊字符）中可能破坏此代码块的预期用途的内容，但 Jinja2 似乎没有等效的过滤器（我在这里错了吗？）。

有没有比从 Django 复制/粘贴代码更干净的解决方案？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2018-11-18T07:20:20.297

Jinja2 有很好的过滤器[tojson](http://jinja.pocoo.org/docs/2.10/templates/#tojson)。如果从字符串生成 json，它将生成用双引号“”括起来的字符串。您可以在 javascript 中安全地使用它。而且您不需要自己加上引号。

```
$("#mydiv").append({{ html_string|tojson }}); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-09-19T17:07:29.080

这是一个`escapejs`过滤器，基于 Django 的过滤器，我编写用于 Jinja2 模板：

```
_js_escapes = {
        '\\': '\\u005C',
        '\'': '\\u0027',
        '"': '\\u0022',
        '>': '\\u003E',
        '<': '\\u003C',
        '&': '\\u0026',
        '=': '\\u003D',
        '-': '\\u002D',
        ';': '\\u003B',
        u'\u2028': '\\u2028',
        u'\u2029': '\\u2029'
}
# Escape every ASCII character with a value less than 32.
_js_escapes.update(('%c' % z, '\\u%04X' % z) for z in xrange(32))
def jinja2_escapejs_filter(value):
        retval = []
        for letter in value:
                if _js_escapes.has_key(letter):
                        retval.append(_js_escapes[letter])
                else:
                        retval.append(letter)

        return jinja2.Markup("".join(retval))
JINJA_ENVIRONMENT.filters['escapejs'] = jinja2_escapejs_filter 
```

模板中的安全用法示例：

```
<script type="text/javascript">
<!--
var variableName = "{{ variableName | escapejs }}";
…
//-->
</script> 
```

当 variableName 是 a`str`或时`unicode`。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-09T14:40:09.010

去年我也遇到过类似的问题。不确定您是否使用[bottle](http://bottlepy.org)，但我的解决方案看起来像这样。

```
import json

def escapejs(val):
    return json.dumps(str(val)) # *but see [Important Note] below to be safe

@app.route('/foo')
def foo():
    return bottle.jinja2_template('foo', template_settings={'filters': {'escapejs': escapejs}}) 
```

（我将 dict 包装`template_settings`在一个辅助函数中，因为我在任何地方都使用它，但在这个例子中我保持简单。）

不幸的是，它不像内置的 jinja2 过滤器那么简单，但我能够愉快地使用它——特别是考虑到我还需要添加其他几个自定义过滤器。

*重要提示*：向@medmunds 致敬，感谢他在下面的精明评论，提醒我们 json.dumps 不是 XSS 安全的。IOW，您不希望在面向 Internet 的生产服务器中使用它。建议是编写一个[更安全的 json 转义例程](https://github.com/dsissitka/khan-website/blob/master/templatefilters.py#L112-139)（或窃取 django 的——抱歉 OP，我知道您希望避免这种情况）并调用它而不是使用 json.dumps。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-09T10:11:12.897

我刚刚研究了这个问题，我的解决方案是定义一个过滤器：

```
from flask import Flask, Markup
app = Flask(__name__)
app.jinja_env.filters['json'] = lambda v: Markup(json.dumps(v)) 
```

并在模板中：

```
<script>
var myvar = {{myvar|json}} ;
</script> 
```

这有一个很好的功能，即*myvar*可以是任何可以被 JSON 序列化的东西

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-27T14:11:09.160

基于@tometzky，这里是我的 Python 3 版本：

```
_js_escapes = {
        '\\': '\\u005C',
        '\'': '\\u0027',
        '"': '\\u0022',
        '>': '\\u003E',
        '<': '\\u003C',
        '&': '\\u0026',
        '=': '\\u003D',
        '-': '\\u002D',
        ';': '\\u003B',
        u'\u2028': '\\u2028',
        u'\u2029': '\\u2029'
}
# Escape every ASCII character with a value less than 32.
_js_escapes.update(('%c' % z, '\\u%04X' % z) for z in range(32))

@register.filter
def escapejs(value):
    return jinja2.Markup("".join(_js_escapes.get(l, l) for l in value)) 
```

用法完全一样。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-07-06T23:05:05.123

您也可以使用 jinja2 的`autoescape`. 因此，例如，您可以在 Python 中将自动转义添加到您的 jinja2 环境中：

```
JINJA_ENVIRONMENT = jinja2.Environment(
    loader=jinja2.FileSystemLoader(os.path.dirname(__file__)),
    autoescape=True) 
```

或者，您可以使用 Jinja 2.4 中添加的 Autoescape 扩展来更好地控制在 HTML 中使用自动转义的位置。更多关于此[的](http://jinja.pocoo.org/docs/api/#autoescaping)信息和示例（在 Google App Engine 中）[在这里](https://developers.google.com/appengine/docs/python/gettingstartedpython27/templates)。

Python：

```
JINJA_ENVIRONMENT = jinja2.Environment(
    loader=jinja2.FileSystemLoader(os.path.dirname(__file__)),
    extensions=['jinja2.ext.autoescape']) 
```

HTML：

```
{% autoescape true %}
    <html>
        <body>
            {{ IWillBeEscaped }}
        </body>
    </html>
{% endautoescape %} 
```

# ruby-on-rails-3 - minitest 使用 example.com

> ID：12339808
> 
> 赞同：1
> 
> 时间：2012-09-09T14:13:06.600
> 
> 标签：ruby-on-rails-3, integration-testing, minitest

尝试使用 minitest 进行非常简单的集成测试，但它似乎没有正确设置 default_url_option，因此每当我尝试访问路径时，它都会尝试在 www.example.com 而不是我的应用程序上进行。

例如：

```
describe "Admin Architects Integration Test" do                                                                                                                                                                                                                                                                                                        
  it "should be able to view list of users grouped by architect status" do                                                                                                      
    visit admin_path                                                                                                                                                            
  end                                                                                                                                                                           
end 
```

试图带我去 www.example.com/admin

# asp.net - 当动作有参数时，如何将家庭控制器定义为根？ASP.MVC 4

> ID：12339811
> 
> 赞同：0
> 
> 时间：2012-09-09T14:13:20.043
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4

默认情况下，如果 url 是“mydomain”，它会转到控制器主页；行动=索引。

但是当索引操作有参数时，url 必须是：

```
mydomain/home/index?name=John 
```

想要得到：

```
mydomain?name=John 
```

创建这样的 url 应该定义什么？

谢谢，

约瑟夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:18:39.457

正确的网址如下：

```
http://mydomain.com/?name=John 
```

给定默认路由设置，这将调用控制器`Index`上的操作`Home`并传递`name`参数。

就您对`mydomain?name=John`url 的请求而言，这看起来不是一个格式良好的 url。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T15:18:33.930

您确定要在您的网站`mydomain/home/index?name=John`中`mydomain?name=John`使用您的网址吗？

如果您更正了您的路由引擎，您的路线可能是`mydomain/home/index/john`和`mydomain/john`，对我来说这会更正确。

这就是你的目的吗？

如果是这样，假设您有一个 Index 操作，在您的主控制器中接受名称的字符串参数，您可以修改 global.asax，并更改默认路由，并在标准默认路由下方添加一个路由，如下所示：

```
 routes.MapRoute(
       "Default", // Route name
       "{controller}/{action}/{id}", // URL with parameters
       new { controller = "Home", action = "Index", name= UrlParameter.Optional } // Parameter defaults
     );

     routes.MapRoute(
       "NameOnly", // Route name
       "{name}", // URL with parameters
       new { controller = "Home", action = "Index" } // Parameter defaults
     ); 
```

确保将仅名称路由放在底部，因为基于字符串的参数将匹配所有内容，因此您需要首先匹配更明确的参数。

# c++ - 返回字符串引用的函数c ++

> ID：12339812
> 
> 赞同：0
> 
> 时间：2012-09-09T14:13:26.930
> 
> 标签：c++

我是 C++ 中的指针和引用的新手，所以我想知道是否有人可以向我展示如何编写一个返回字符串引用的函数的示例，并且可能是正在使用的函数。例如，如果我想编写一个类似...的函数

```
//returns a refrence to a string
string& returnRefrence(){

    string hello = "Hello there";
    string * helloRefrence = &hello;

    return *helloRefrence;
}

//and if i wanted to use to that function to see the value of helloRefrence would i do something like this?

string hello = returnRefrence();
cout << hello << endl; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:16:32.327

一个函数如

```
string& returnRefrence(){} 
```

`string`只有在 is 可以访问超出其自身范围的a 的情况下才有意义。例如，这可以是具有`string`数据成员的类的成员函数，或者可以访问某个全局​​字符串对象的函数。在函数体中创建的字符串在退出该范围时被销毁，因此返回对它的引用会导致悬空引用。

另一个可能有意义的选项是，如果函数 tkaes 引用字符串，并返回对该字符串的引用：

```
string& foo(string& s) {
  // do something with s
  return s;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T18:35:30.487

您还可以将变量声明为静态：

```
std::string &MyFunction()
{
    static std::string hello = "Hello there";
    return hello;
} 
```

但是，请注意，每次调用都会返回完全相同的字符串对象作为引用。

例如，

```
std::string &Call1 = MyFunction();
Call1 += "123";

std::string Call2 = MyFunction(); //Call2 = "Hello there123", NOT "hello there" 
```

Call2 对象与 Call1 中引用的字符串相同，因此它返回其修改后的值

# javascript - 我如何分成3块？

> ID：12339813
> 
> 赞同：0
> 
> 时间：2012-09-09T14:13:30.737
> 
> 标签：javascript, jquery

我想用逗号分隔一组 3 个数字并将值设置为 textarea，我已经尝试过了，但它只是将值像这样“5.685.685.85”连接起来，我希望它看起来像这样“5.68, 5.68 , 5.85"

```
var once = window['tma'+kj].toFixed(2);
for (var li=0; li<once.length; ++li) {
    $('#comments').append(once[li]); //div tag, it shows concateneted
    $('#com').val(once[li]); //textarea id, brings blank
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:18:09.863

假设这`once`是一个数组：

```
$('#comments').val(once.join (', ')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:18:57.450

```
var once = window['tma'+kj];
var arr = [];
for (var li=0; li<once.length; ++li) {
    $('#comments').append(once[li]); //div tag, it shows concateneted
    arr.push(once[li].toFixed(2)); //textarea id, brings blank
}
$('#com').val(arr.join(',')); 
```

# c++ - 方法定义中的 C++ 模板参数

> ID：12339814
> 
> 赞同：1
> 
> 时间：2012-09-09T14:13:40.797
> 
> 标签：c++, templates

具有模板参数的类中的所有方法声明都需要使用该参数声明吗？编译器似乎想要类似下面的东西

```
// Queue.h
template <class ItemType>
class Queue
{
    Queue();
    ItemType dequeue();
    int count();
    /* ... other methods ... */
};
// Queue.cpp
template <class ItemType>
Queue<ItemType>::Queue()
{ /*...*/ }
template <class ItemType>
int Queue<ItemType>::count()
{/*...*/}
template <class ItemType>
ItemType Queue<ItemType>::dequeue()
{/* ... */} 
```

来自 Java/C#，这似乎有点多余——我觉得我应该能够像这样定义方法：

```
int Queue::count() 
```

签名没有引用 ItemType，所以我们可以省略它。

```
Queue::ItemType Queue::dequeue() 
```

签名引用了 ItemType，但编译器知道我们在谈论模板参数，因为我们用`Queue::`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T14:33:04.677

是的，您需要提供模板参数。请注意，虽然它可能看起来多余，但事实并非如此。C++ 模板是一个比 Java 泛型更强大的工具，并且它们允许专业化。这意味着对于一个基本模板`Queue`，可能有多个实现匹配不同的模板参数并具有不同的定义。或者，您可以拥有一个`Queue`模板，其中包含针对某些功能的多个专业化。这两种情况要求您同时提供`template`参数列表和类模板参数：

```
// Just member specialization
template <typename T>
struct X {
   void foo() { std::cout << "generic\n"; }
};
// specialize just this member for `int`
template <>
void X<int>::foo() { std::cout << "int\n"; }
int main() {
   X<double> xd; xd.foo();  // generic
   X<int>    xi; xi.foo();  // int
}

// Class template specialization
template <typename T>
struct X {
   void foo();
}
template <typename T>
struct X<T*> {
   void bar();
}
template <typename T>
void X<T>::foo() { std::cout << "generic\n"; }
template <typename T>
void X<T*>::bar() { std::cout << "ptr\n"; }
int main() {
   X<int > xi; xi.foo();       // generic
   X<int*> xp; xp.bar();       // ptr
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T14:19:21.873

是的，它们确实如此，而且它不是多余的，因为`Queue`它不是没有模板参数的类型。但是，您可以在类模板声明中提供函数定义：

```
template <class ItemType>
class Queue
{
    Queue();
    ItemType dequeue() { /* implementation */}
    int count() { /* implementation */ }
    /* ... other methods ... */
}; 
```

请记住，这

```
Queue<int> q;
int i = q.dequeue(); 
```

相当于

```
Queue<int> q;
int i = Queue<int>::dequeue(&q); 
```

换句话说，需要完整类型来限定函数名，即使函数本身没有引用模板参数（尽管在这种情况下，返回类型需要模板参数）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T14:20:09.243

是的。

> 当在类模板定义之外定义成员函数、成员类、成员枚举、静态数据成员或类模板的成员模板时，成员定义被定义为模板定义，其中模板参数是类模板的那些。成员定义中使用的模板参数名称可能与类模板定义中使用的模板参数名称不同。

# dependency-injection - 在 Umbraco 4.7 中扩展 global.asax 以进行依赖注入

> ID：12339820
> 
> 赞同：0
> 
> 时间：2012-09-09T14:14:19.963
> 
> 标签：dependency-injection, umbraco

我正在使用 umbraco v 4.7.1（程序集版本：1.0.4281.20201）并且有一个项目，我必须在其中扩展 global.asax 文件。

请不要以下

*   我试过这个，[http://blog.mattbrailsford.com/2010/07/11/registering-an-application-start-event-handler-in-umbraco/](http://blog.mattbrailsford.com/2010/07/11/registering-an-application-start-event-handler-in-umbraco/)，在 4.7 中不起作用
*   它是 Global.asax 我需要扩展，因为我正在使用依赖注入
*   我无法删除 App_global.asax.dll 文件（正如一些人可能建议的那样），因为每次我重新启动或重建我的项目时它都会重新生成

这是我的实现，

```
using Project.Umbraco.DependencyInjection;
using Project.Umbraco.IoC;
using Microsoft.Practices.Unity;
using System;
using System.Diagnostics;
using umbraco;

namespace Project.Umbraco.App_Start
{
    public class MyGlobal : Global, IContainerAccessor
    {
        /// 

        /// Returns the IoC container
        /// IContainerAccessor
        /// 

        public IUnityContainer Container
        {
            get
            {
                return MvcUnityContainer.Instance.Container;
            }
        }

        protected override void Application_Start(object sender, EventArgs e)
        {
            base.Application_Start(sender, e);
            Debug.WriteLine("Application start");
        }

        protected override void Application_BeginRequest(object sender, EventArgs e)
        {
            base.Application_BeginRequest(sender, e);
            Debug.WriteLine("Application start");
        }
        //protected void Session_Start(object sender, EventArgs e) {}
        //protected void Application_AuthenticateRequest(object sender, EventArgs e) {}
        //protected void Application_Error(object sender, EventArgs e) {}
        //protected void Session_End(object sender, EventArgs e) {}
        //protected void Application_End(object sender, EventArgs e) {}
    }
} 
```

该实现似乎应该可以工作，也许我只是将它放在错误的名称空间或其他什么地方？

谢谢你的帮助

吨

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T17:18:39.823

从 Umbraco 4.8.0 起，不再需要 App_global.asax.dll，因此您可能需要考虑升级到更新的版本。

不过在 4.7 中，您可以通过创建一个看起来有点像这样的类来简单地使用 PreApplicationStart 方法：

```
using System.Linq;
using System.Web.Routing;
using System.Web.Http;
using CustomerName.Extensions;

[assembly: System.Web.PreApplicationStartMethod(typeof(AppStart), "PreStart")]
namespace CustomerName.Extensions
{
    public static class AppStart
    {
        public static void PreStart()
        {
            RouteTable.Routes.MapHttpRoute(
               name: "DefaultApi",
               routeTemplate: "api/{controller}/{id}",
               defaults: new { id = RouteParameter.Optional }
           );
        }
    }
} 
```

当然，您可以插入 DI 代码，而不是定义 WebAPI 路由。

# haskell - 为什么 Haskell 的“翻转 id”有这种类型？

> ID：12339822
> 
> 赞同：49
> 
> 时间：2012-09-09T14:14:43.913
> 
> 标签：haskell

我对这个表达很好奇`flip id`（这不是家庭作业：我在`getOpt`文档中找到了它）。

我想知道为什么它有这种类型：

```
Prelude> :t (flip id)
(flip id) :: b -> (b -> c) -> c 
```

例如，`(flip id) 5 (+6)`给出`11`.

我知道为什么`id (+6) 5`给出 11，但我没有“得到”这个`flip id`东西。

我试图用笔和纸自己弄清楚这一点，但做不到。有人可以向我解释一下吗？我的意思是，怎么`flip id`会有类型`b -> (b -> c) -> c`？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-09-09T14:22:49.350

该`id`函数具有以下类型：

```
id :: a -> a 
```

当您替换为时，您将获得此类型的`a`实例`a -> b`：

```
id :: (a -> b) -> (a -> b) 
```

由于currying，它与以下内容相同：

```
id :: (a -> b) -> a -> b 
```

现在申请`flip`这个，你会得到：

```
flip id :: a -> (a -> b) -> b 
```

在`id (+)`实例的情况下是：

```
id :: (Num a) => (a -> a) -> (a -> a) 
```

Now `flip id` gives you:

```
flip id :: (Num a) => a -> (a -> a) -> a 
```

Side note: This also shows you how `($)` is the same as `id`, just with a more restricted type:

```
($) :: (a -> b) -> a -> b
($) f x = f x
-- unpoint:
($) f   = f
-- hence:
($)     = id 
```

# ruby-on-rails - 如果我的 ruby 版本正确，为什么在 Rails 控制台中出现语法错误？

> ID：12339824
> 
> 赞同：1
> 
> 时间：2012-09-09T14:15:00.500
> 
> 标签：ruby-on-rails, ruby-on-rails-3, gem, pry

我添加了 gem 'pry-rails'，当我运行 rails 控制台时，我收到以下错误：

```
Loading development environment (Rails 3.2.6)
/Users/rege/.rvm/gems/ruby-1.9.3-p194@network/gems/bundler-1.2.0/lib/bundler/dsl.rb:35:in `eval_gemfile': Gemfile syntax error: (Bundler::GemfileError)
/Users/rege/Code/Network/Gemfile:106: syntax error, unexpected ':', expecting $end
gem 'ruby-readability', require: 'readability'
                                ^
    from /Users/rege/.rvm/gems/ruby-1.9.3-p194@network/gems/bundler-1.2.0/lib/bundler/dsl.rb:7:in `evaluate'
    from /Users/rege/.rvm/gems/ruby-1.9.3-p194@network/gems/bundler-1.2.0/lib/bundler/definition.rb:18:in `build'
    from /Users/rege/.rvm/gems/ruby-1.9.3-p194@network/gems/bundler-1.2.0/lib/bundler.rb:144:in `definition'
    from /Users/rege/.rvm/gems/ruby-1.9.3-p194@network/gems/bundler-1.2.0/lib/bundler.rb:112:in `setup'
    from /Users/rege/.rvm/gems/ruby-1.9.3-p194@network/gems/bundler-1.2.0/lib/bundler/setup.rb:17

Frame number: 0/4
>> RUBY_VERSION
"1.9.3" 
```

我的宝石文件：

```
...
group :development do
  gem 'rack-mini-profiler'
  gem 'pry-rails'
end
...
gem 'ruby-readability', require: 'readability'
... 
```

当我更改为时`gem 'ruby-readability', require: 'readability'`，`gem 'ruby-readability', :require => 'readability'`我收到下一个错误：

```
Loading development environment (Rails 3.2.6)
/Users/rege/.rvm/gems/ruby-1.9.3-p194@network/gems/bundler-1.2.0/lib/bundler/definition.rb:364:in `validate_ruby!': Your Ruby version is 1.8.7, but your Gemfile specified 1.9.3 (Bundler::RubyVersionMismatch)
    from /Users/rege/.rvm/gems/ruby-1.9.3-p194@network/gems/bundler-1.2.0/lib/bundler.rb:112:in `setup'
    from /Users/rege/.rvm/gems/ruby-1.9.3-p194@network/gems/bundler-1.2.0/lib/bundler/setup.rb:17 
```

我的 rvm 信息

```
> rvm info                                                                                                                                                     /Users/rege/Code/Network 1.9.3p194 develop!@37a80c4

ruby-1.9.3-p194@network:

  system:
    uname:       "Darwin Darek-MacBook.local 11.4.0 Darwin Kernel Version 11.4.0: Mon Apr  9 19:32:15 PDT 2012; root:xnu-1699.26.8~1/RELEASE_X86_64 x86_64"
    bash:        "/bin/bash => GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin11)"
    zsh:         "/bin/zsh => zsh 4.3.11 (i386-apple-darwin11.0)"

  rvm:
    version:      "rvm 1.15.8 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]"
    updated:      "19 hours 59 minutes 37 seconds ago"

  ruby:
    interpreter:  "ruby"
    version:      "1.9.3p194"
    date:         "2012-04-20"
    platform:     "x86_64-darwin11.4.0"
    patchlevel:   "2012-04-20 revision 35410"
    full_version: "ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin11.4.0]"

  homes:
    gem:          "/Users/rege/.rvm/gems/ruby-1.9.3-p194@network"
    ruby:         "/Users/rege/.rvm/rubies/ruby-1.9.3-p194"

  binaries:
    ruby:         "/Users/rege/.rvm/rubies/ruby-1.9.3-p194/bin/ruby"
    irb:          "/Users/rege/.rvm/rubies/ruby-1.9.3-p194/bin/irb"
    gem:          "/Users/rege/.rvm/rubies/ruby-1.9.3-p194/bin/gem"
    rake:         "/Users/rege/.rvm/gems/ruby-1.9.3-p194@global/bin/rake"

  environment:
    PATH:         "/Users/rege/.rvm/gems/ruby-1.9.3-p194@network/bin:/Users/rege/.rvm/gems/ruby-1.9.3-p194@global/bin:/Users/rege/.rvm/rubies/ruby-1.9.3-p194/bin:/Users/rege/.rvm/bin:/usr/local/bin:/opt/local/bin:/opt/local/sbin/:/usr/bin:/bin:/usr/sbin:/sbin:/usr/X11/bin"
    GEM_HOME:     "/Users/rege/.rvm/gems/ruby-1.9.3-p194@network"
    GEM_PATH:     "/Users/rege/.rvm/gems/ruby-1.9.3-p194@network:/Users/rege/.rvm/gems/ruby-1.9.3-p194@global"
    MY_RUBY_HOME: "/Users/rege/.rvm/rubies/ruby-1.9.3-p194"
    IRBRC:        "/Users/rege/.rvm/rubies/ruby-1.9.3-p194/.irbrc"
    RUBYOPT:      ""
    gemset:       "network" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T17:28:41.960

根据[此](http://rubydoc.info/gems/ruby-readability/0.5.4/frames)文档，您应该指定如下

```
 gem "ruby-readability", :require => 'readability' 
```

您在第二种方法中已经完成了。您收到此错误

```
 Your Ruby version is 1.8.7, but your Gemfile specified 1.9.3 
```

因为从 Bundler 1.2 你有这个非常有用的新特性[`validate your Ruby version`](http://gembundler.com/v1.2/whats_new.html)所以如果你想使用 ruby​​ 1.8.7 在你的 Gemfile 顶部指定

```
ruby '1.8.7' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T11:37:13.010

问题是因为我在我的`pryrc`:`require 'pry-vterm_aliases'`从我的`pryrc`问题中删除后解决了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T14:21:40.643

你的环境怎么`rvm info`说？怎么样`ruby -v`？最后，`which ruby`? 我怀疑你没有运行正确的红宝石，也许你的路上还有另一个。

# tsql - 为什么 NAnt 以错误的顺序执行我的 sql 脚本？

> ID：12339825
> 
> 赞同：1
> 
> 时间：2012-09-09T14:15:11.080
> 
> 标签：tsql, nant

这是我的脚本：

```
<?xml version="1.0"?>
<project name="createAndPopulateDB" default="deploy">
    <property name="sql.connstring" value="Provider=SQLOLEDB;Server=G-PC\sqlexpress;Integrated Security=SSPI" />
    <property name="createDB" value="BuildTestDatabase.sql" />
    <property name="populateDB" value="CreateTables.sql"/>
<target name="deploy">
    <echo message="* Connecting to ${sql.connstring}"/>
    <foreach item="File" property="sql.script">
        <in>
            <items>
                <include name="${createDB}" /> 
                <include name="${populateDB}" />
            </items>
        </in>
        <do>
            <echo message="* Executing ${path::get-file-name(sql.script)}"/>
            <sql connstring="${sql.connstring}" delimiter="go" delimstyle="Line" batch="false" source="${sql.script}"/>
        </do>
    </foreach>
</target>
</project> 
```

NAnt 脚本应该调用两个 tsql 程序。第一个 tsql 旨在删除存在的数据库，如果不存在，则创建它。第二个检查表是否存在，如果存在，则将其删除。同样，如果不是，它会用一个简单的表填充创建的数据库。

我的问题是为什么它首先运行 populateDB 脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:57:17.190

我发现确定 tsql 程序运行顺序的最佳方法是通过附加到单独目标的依赖属性。如果 NAnt 脚本是存储库的一部分，这将按预定顺序运行它们，并且在逻辑上非常容易遵循。

# javascript - 谷歌电子表格的自定义 xml 解析函数

> ID：12339827
> 
> 赞同：1
> 
> 时间：2012-09-09T14:15:25.537
> 
> 标签：javascript, xml-parsing, google-apps-script, spreadsheet

我正在尝试替换 googledocs 的 importXML 函数，因为它只能使用 50 个项目。

当前的公式是：

```
=ImportXML($K$10,"sum(//row[@typeid='"B1&"']/@quantity)") 
```

其中 K10 单元格包含一个用于获取 XML 的 url，如下所示：

```
<eveapi version="2">
  <currentTime>2012-09-09 09:33:55</currentTime>
  <result>
    <rowset name="assets" key="itemID" columns="itemID,locationID,typeID,quantity,flag,singleton">
      <row itemID="1003898262197" locationID="31001059" typeID="17167" quantity="1" flag="0" singleton="1" rawQuantity="-1">
        <rowset name="contents" key="itemID" columns="itemID,typeID,quantity,flag,singleton">
      <row itemID="1003962719504" typeID="253" quantity="3" flag="0" singleton="0"/>
        </rowset>
      </row>
      <row itemID="1003898281453" locationID="31001059" typeID="17408" quantity="1" flag="0" singleton="1" rawQuantity="-1">
        <rowset name="contents" key="itemID" columns="itemID,typeID,quantity,flag,singleton">
      <row itemID="1003962379527" typeID="253" quantity="3" flag="0" singleton="0"/>
        </rowset>
      </row>
      <row itemID="1003908898633" locationID="31001059" typeID="17175" quantity="1" flag="0" singleton="1" rawQuantity="-1"/>
      <row itemID="1003908901859" locationID="31001059" typeID="17174" quantity="1" flag="0" singleton="1" rawQuantity="-1"/>
      <row itemID="1003908954610" locationID="31001059" typeID="17177" quantity="1" flag="0" singleton="1" rawQuantity="-1"/>
    </rowset>
  </result>
  <cachedUntil>2012-09-09 10:20:25</cachedUntil>
</eveapi> 
```

我正在尝试做的（正如您可能从 ImportXML 公式中看到的那样）是获取特定 typeID 的数量值的总和。typeID 将是函数的输入参数。

```
function _retrieveXML() {
  // https://api.eveonline.com/corp/AssetList.xml.aspx?keyID=688782&vCode=q52TpGFTqNCziMMmZ7TYgpXCoGa7U0VBxyH7LuS6Ubtdakbi5t5UDMyf1U5WLpZA&characterID=90127511
  var keyID = "xxxxxx"
  var vCode = "q52TpGFTqNCziMMmZ7TYgpXCoGa7U0VBxyH7LuS6Ubtdakbi5t5UDMyf1U5WLpZA"
  var characterID = "xxxxxxxx"
  var parameters = {
    method : "post",
    payload : "keyID=" + keyID + "&vCode=" + vCode + "&characterID=" + characterID
  };  
  var xmlFeed = UrlFetchApp.fetch("https://api.eveonline.com/corp/AssetList.xml.aspx",parameters);    
  var xmldoc = Xml.parse(xmlFeed.getContentText(), false);
  var records = xmldoc.eveapi.result.rowset.getElements("typeID");  
  var doc = SpreadsheetApp.getActiveSpreadsheet();
  var cell = doc.getRange('a1');
  var index = 0;  
  for (var i in xmldoc) {
    var row = xmldoc[i];
    cell.offset(index, 0).setValue(row[i]);
    }
    index++;
  } 
```

我不知道如何将信息转换为谷歌电子表格的可用格式。如何检索其中一个对象的某个值（如 typeID、数量）并使用它们检索同一行中的另一个值。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:28:37.860

这里的关键问题是自定义函数非常（一直滚动到底部）。您将无法从那里调用任何标准电子表格函数。您只能返回字符串和数组。

更好的方法可能是从用户操作触发。在电子表格中有一个触发相同脚本的绘图或菜单。

# wcf-ria-services - 阅读未提交的 Ria 服务

> ID：12339832
> 
> 赞同：0
> 
> 时间：2012-09-09T14:15:58.513
> 
> 标签：wcf-ria-services

是否可以在 ria 服务加载操作中未提交读取？或者我应该将我的加载操作转换为调用？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T22:01:27.880

如果 Read uncommitted 您在谈论 sql 事务隔离，答案是肯定的，没问题，这与 wcf ria 服务完全无关。这是您在服务器数据层中设置的内容。

# ios - Objective C 中的位掩码

> ID：12339833
> 
> 赞同：25
> 
> 时间：2012-09-09T14:15:59.383
> 
> 标签：ios, objective-c, bit-manipulation

我想学习位掩码。据我了解，这意味着将某种类型的二进制值存储到一个变量中。

如果上面的假设是真的，我想我可以做这样的事情：

```
typedef NSUInteger Traits;

enum
{
    TraitsCharacterHonest       = 0,
    TraitsCharacterOptimistic   = 1,
    TraitsCharacterPolite       = 4,
    TraitsCharacterDevious      = 8,
    TraitsPhysicalTall          = 16,
    TraitsPhysicalBeautiful     = 32,
    TraitsPhysicalFat           = 64,
    TraitsPhysicalBigEyes       = 128,
    TraitsPhysicalRedHair       = 256, 
};

#import <Foundation/Foundation.h>

@interface Person : NSObject

@property (strong, nonatomic) NSString  *name;
@property (assign, nonatomic) Traits    *traits;

@end 
```

**问题 1**是，我如何为一个人分配更多特征？

**问题 2**是，我是否必须将不断增加的数字添加到枚举项目中，或者有没有办法表明这一点？

最终我想实现这样的目标：

```
Person *john = [[Person alloc] init];

//here code that assigns john three traits: TraitsCharacterHonest,      
//TraitsCharacterOptimistic and TraitsPhysicalBeautiful. 
```

如果我理解正确，价值

john.traits 应该是 100011.，从右边读取，每个地方代表那个特定的枚举值/特征..并且 0 表示没有它，1 表示有它。

如果需要，您能否就语法提出建议并解释特定方面？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-09-09T15:43:56.500

我建议更改一些内容：

*   枚举值可以更改为左移一个。在我看来，让写作更容易一些。

*   你不需要 typedef 到 NSUInteger，你可以直接使用`typedef enum`.

*   而且，正如其他人所提到的，您的属性不应该是指向 Traits 类型的指针。

我的代码如下所示：

```
typedef enum
{
    TraitsCharacterHonest       = 1 << 0,
    TraitsCharacterOptimistic   = 1 << 1,
    TraitsCharacterPolite       = 1 << 2,
    TraitsCharacterDevious      = 1 << 3,
    TraitsPhysicalTall          = 1 << 4,
    TraitsPhysicalBeautiful     = 1 << 5,
    TraitsPhysicalFat           = 1 << 6,
    TraitsPhysicalBigEyes       = 1 << 7,
    TraitsPhysicalRedHair       = 1 << 8
} Traits;

#import <Foundation/Foundation.h>

@interface Person : NSObject

@property (strong, nonatomic) NSString  *name;
@property (assign, nonatomic) Traits     traits;

@end 
```

设置 John 的特征将如下所示：

```
Person *john = [[Person alloc] init];

john.traits = TraitsCharacterHonest | TraitsCharacterOptimistic | TraitsPhysicalBeautiful; 
```

然而，虽然位域对学习很有用，但调试起来确实很痛苦。如果你现在想去打印这个角色的特征，你必须编写如下代码：

```
NSMutableString *result = [NSMutableString string];

if (self.traits & TraitsCharacterHonest)
{
    [result appendString: @"Honest, "];
}
if (self.traits & TraitsCharacterOptimistic)
{
    [result appendString: @"Optimistic, "];
}
if (self.traits & TraitsCharacterPolite)
{
    [result appendString: @"Polite, "];
}
// etc... 
```

此外，删除特征等操作的语法令人困惑。你必须使用`&`和一个未编辑的常量，

```
// remove 'Tall' trait
john.traits = john.traits & ~TraitsPhysicalTall 
```

如果可以（并且性能不是太大问题），我更喜欢使用更高级别的功能。也许是一个带有字符串常量的 NSSet？例如

```
__unused static NSString *TraitsCharacterHonest = @"TraitsCharacterHonest";
__unused static NSString *TraitsCharacterOptimistic = @"TraitsCharacterOptimistic";
__unused static NSString *TraitsCharacterPolite = @"TraitsCharacterPolite";
// etc...

@interface Person : NSObject

@property (strong, nonatomic) NSString     *name;
@property (assign, nonatomic) NSMutableSet *traits;

@end 
```

然后你可以这样做：

```
// adding
[john.traits addObject: TraitsCharacterHonest];
// checking
[john.traits containsObject: TraitsCharacterHonest];
// removing 
[john.traits removeObject: TraitsCharacterHonest]; 
```

对我来说更有意义。更重要的是，您可以直接打印特征的描述

```
NSLog(@"John's traits: %@", john.traits); 
```

你会得到合理的输出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-09T14:59:25.683

您可能遇到的一个问题是，使用位掩码来指示集合内的成员资格可能会受到基础数据类型中的位数的限制。例如，一个 32 位的无符号长整数只能容纳 32 个不相交或不同的成员。如果您需要添加第 33 位，那么除非您使用 64 位无符号整数，否则您将不走运。

一种解决方法是使用字节数组。使用这种方法，您必须将您的位成员资格指定为两条数据，即字节的偏移量和用于特定位的位掩码。

我还看到人们使用字节数组作为单个成员，这样就使用了整个字节，而不是使用一个位。这可能会浪费内存，但它可能更灵活、更有用，而且浪费的内存量不是问题。

为了使用字节数组来保存位集，您可以考虑使用无符号长整数来表示集合的成员，其中最低有效字节是位掩码，其余字节用作无符号 3 字节偏移到字节数组中。然后，您将执行以下操作：

```
int getBitSet (unsigned char *bArray, unsigned long ulItem)
{
    unsigned long ulByteOffset = ((ulItem >> 8) & 0x00ffffff);
    unsigned char ucByteMask = (ulItem & 0x000000ff);

    return (*(bArray + ulByteOffset) & ucByteMask);
}

int setBitSet (unsigned char *bArray, unsigned long ulItem, unsigned long ulNewValue)
{
    unsigned char oldValue;
    unsigned long ulByteOffset = ((ulItem >> 8) & 0x00ffffff);
    unsigned char ucByteMask = (ulItem & 0x000000ff);

    oldValue = *(bArray + ulByteOffset) & ucByteMask;

    if (ulNewValue) {
        *(bArray + ulByteOffset) |= ucByteMask;  // set bit
    } else {
        *(bArray + ulByteOffset) &= ~ucByteMask;  // clear bit
    }

    return oldValue;
} 
```

然后，您可以使用一组函数来获取和设置字节，或者您可以使用宏。使用 C++，您可以为此功能创建自己的类并提供各种类型的逻辑操作，以便您可以创建各种类型的集合，然后对集合执行逻辑操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-09T14:24:17.053

你在这里的主要问题是做`traits`一个指针。放下指针，像在 C 中那样做：

```
john.traits |= TraitsCharacterOptimistic | TraitsCharacterOptimistic | TraitsCharacterOptimistic; 
```

请记住，您只需要在 Objective-C 中的几种情况下使用指针：

*   当您处理实际对象时（派生自`NSObject`）
*   当您需要通过引用传递原语（`int *`函数的参数以返回计数）时，在这种情况下，您获取局部变量的地址，并且该指针不会被函数保存。
*   当您需要一个原始类型数组时，在堆上动态分配（例如使用`malloc`＆friends）。

否则，只需使用堆栈分配的原始类型，因为您可以用它做很多事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-21T14:52:42.580

iOS 6 或以上，Mac OS X 10.8 及以上

你可以做：

```
typedef NS_OPTIONS(NSUInteger, Traits) {
    TraitsCharacterHonest,
    TraitsCharacterOptimistic,
    TraitsCharacterPolite,
    TraitsCharacterDevious,
    TraitsPhysicalTall,
    TraitsPhysicalBeautiful,
    TraitsPhysicalFat,
    TraitsPhysicalBigEyes,
    TraitsPhysicalRedHair
}; 
```

有关详细信息，请参阅[http://nshipster.com/ns_enum-ns_options/](http://nshipster.com/ns_enum-ns_options/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-09T14:31:48.190

首先改变：

```
...
typedef NSUInteger Traits;

enum
{
    TraitsCharacterHonest = 0, //cann't be a 0
    ...
};
...
@property (assign, nonatomic) Traits *traits; //you no need create a pointer to a primitive type 
```

到： ...

```
typedef NSUInteger Traits;

enum
{
    TraitsCharacterHonest = 1, 
    ...
};
...
@property (assign, nonatomic) Traits traits; 
```

对于分配，您应该遵循：

```
john.traits |= TraitsCharacterHonest | TraitsCharacterDevious; 
```

ObjC 中的按位运算与`C`语言中的相同。查看本教程[C 和 C++ 中的位运算符：教程](http://www.cprogramming.com/tutorial/bitwise_operators.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-03-13T18:59:05.317

假设：

`1 << 8`是一样的`100000000`：

```
john.traits = TraitsCharacterHonest | TraitsCharacterOptimistic | TraitsPhysicalBeautiful; 
```

与以下内容完全相同：

```
john.traits = 000000001 | 000000010 | 000100000; 
```

结果是：

```
john.traits = 000100011 
```

现在，当您要检查条件时：

```
if (self.traits & TraitsCharacterHonest) { ... } 
```

它相当于：

```
if (000100011 & 000000001) { ... } 
```

结果是：

```
if (000000001) { ... } 
```

而且，这实际上是`1`，`not zero`值是`true`，所以整个条件是`true`。享受：-）

# geometry - 获取位于直线 25% 处的点的位置？

> ID：12339836
> 
> 赞同：0
> 
> 时间：2012-09-09T14:16:13.903
> 
> 标签：geometry, line

我有一条线，有 2 分。我知道两点之间的距离。我还计算了线的角度。

我的目标是获得一个位于 25% 线外的点。

我用 (dist/100)*25 计算该点的 y。

我唯一的问题是计算点的 x。我怀疑我拥有所需的所有变量，但我似乎无法找到如何计算 x。有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T15:13:55.740

这只是简单的矢量数学，这里不需要任何角度或三角。

```
startPos = (0,0)
endPos = (10,10)

fratcion = 0.25

distX = endPos.x - startPos.x
distY = endPos.y - startPos.y

pos.x = startPos.x + fraction*distX
pos.y = startPos.y + fraction*distY 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T15:14:55.910

您有一个带有端点 P0（坐标 x0，y0）和 P1（x1，y1）的线段（不是线）。新点 P 位于此段和距离 |P0P| = 0.25 * |P0P1|，如果它们的坐标是：

```
x = x0 + 0.25 * (x1-x0)
y = y0 + 0.25 * (y1-y0) 
```

# c++ - 两个条件变量和避免死锁

> ID：12339837
> 
> 赞同：3
> 
> 时间：2012-09-09T14:16:16.610
> 
> 标签：c++, multithreading, thread-safety

我有两个条件变量：

```
CondVar1
CondVar2 
```

在这样的两个线程中使用（伪代码）：

```
// thread1 starts in 'waiting' mode, and then Thread2 signals
void Thread1()
{
    CondVar1->Wait();
    CondVar2->Signal();
}

void Thread2()
{
    CondVar1->Signal();
    CondVar2->Wait();
} 
```

这会导致死锁吗？意思是，thread1 等待，thread2 发出信号，然后thread1 可以在thread2 进入Wait() 之前发出信号，意思是thread2 永远不会返回？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T14:25:32.637

您通常不只是*等待*条件变量。常用模式是持有一个锁，检查一个变量，该变量决定你是否可以继续，以及你是否不能在条件下等待：

```
// pseudocode
void push( T data ) {
   Guard<Mutex> lock( m_mutex );   // Hold a lock on the queue
   while (m_queue.full())     // [1]
      m_cond1.wait(lock);         // Wait until a consumer leaves a slot for me to write
   // insert data
   m_cond2.signal_one();      // Signal consumers that might be waiting on an empty queue
} 
```

需要注意的一些事情：大多数库都允许条件变量中的虚假唤醒。虽然可以实现避免虚假唤醒的条件变量，但操作的成本会更高，因此要求用户在继续之前重新检查状态被认为是一种较小的邪恶（`while`循环 [1]）。

一些库，尤其是 C++11，允许您传递谓词，并将在内部实现循环：`cond.wait(lock, [&queue](){ return !queue.full(); } );`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T14:23:29.893

这里有两种情况可能导致死锁：

1.  在正常执行中，您描述的那个。有可能在线程到达对 的调用之前向变量发出信号`Wait`，因此信号丢失。
2.  可能会发生虚假唤醒，导致第一个线程`Wait`在实际发出信号之前离开调用，从而发出尚未等待的线程 2 的信号。

使用信号机制时，您应该按如下方式设计代码：

```
bool thread1Waits = true;
bool thread2Waits = true;

void Thread1()
{
    while(thread1Waits) CondVar1->Wait();
    thread2Waits = false; 
    CondVar2->Signal();
}

void Thread2()
{
    thread1Waits = false;
    CondVar1->Signal();
    while(thread2Waits) CondVar2->Wait();
} 
```

当然，这假设有锁保护条件变量，并且线程 1 在线程 2 之前运行。

# android - 从 SQLiteStatement 创建游标

> ID：12339841
> 
> 赞同：0
> 
> 时间：2012-09-09T14:16:55.680
> 
> 标签：android, sqlite, cursor, android-contentprovider

我想用`SQLiteStatement`我的`ContentProvider`而不是`rawQuery`其他标准方法之一。我认为 using`SQLiteStatement`会提供一种更自然、原生、高效且不易出错的查询方法。

问题是我看不到生成和返回`Cursor`. 我意识到我可以使用“调用”并返回 a `Bundle`，但这种方法要求我同时缓存并返回所有选定的行——这可能是巨大的。

我将开始查看 Android 源代码 - 我认为“查询”最终会使用`SQLiteStatement`并以某种方式生成`Cursor`. 但是，如果有人对此有任何指示或知识，我将非常感谢您的分享。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:24:45.293

> 我想在我的 ContentProvider 中使用 SQLiteStatement 而不是 rawQuery 或其他标准方法之一。我认为使用 SQLiteStatement 会提供一种更自然、原生、高效且不易出错的查询方法。

引用文档`SQLiteStatement`：

> 该语句不能返回多行或多列，但支持单值 (1 x 1) 结果集。

我不明白为什么你会`ContentProvider`为单行单列结果而烦恼，但是，嘿，这是你的应用程序......

> 问题是我看不到生成和返回光标的方法

创建一个`MatrixCursor`并填写单个结果。

# html - CSS 帮助定位 div 内联

> ID：12339843
> 
> 赞同：2
> 
> 时间：2012-09-09T01:38:36.600
> 
> 标签：html, css

我需要帮助解决经常发生的反复出现的问题。我想创建一个包含 3 个内联部分的标题。我使用以下 css 代码内联显示它们： `display: inline & float: left`问题是当我调整浏览器窗口的大小时，最后一个 div 被按下并且没有内联显示。我知道这听起来我很挑剔，但我不希望设计在访客改变监视器屏幕时扭曲。我在下面提供了我正在使用的 html 和 css 代码。希望我已经很好地解释了这一点。提前致谢。

**HTML**

```
<div class="masthead-wrapper">
&nbsp;
</div>

<div class="searchbar-wrapper">
&nbsp;
</div>

<div class="profile-menu-wrapper">
&nbsp;
</div> 
```

**CSS**

```
#Header {
  display: block;
  width: 100%;
  height: 80px;
  background: #C0C0C0;
}
.masthead-wrapper {
  display: inline;
  float: left;
  width: 200px;
  height: 80px;
  background: #3b5998;
}
.searchbar-wrapper {
  display: inline;
  float: left;
  width: 560px;
  height: 80px;
  background: #FF0000;
}
.profile-menu-wrapper {
  display: inline;
  float: left;
  width: 200px;
  height: 80px;
  background: #00FF00;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T09:40:13.710

> 使用以下 CSS 代码内联显示它们：`display: inline`&`float: left`

除了...您实际上是在浮动元素，而不是内联显示它。该`display:inline`规则在这里无关紧要，因为浮动元素隐式显示为*block*。

但无论如何，你的问题是你的部分都是固定宽度（200 + 560 + 200 = 960px），所以当浏览器窗口减小到接近这个宽度（960px加上你的页边距多一点）时，设计正在进行打破 - 你的容器包装。

如果您仍然希望这些容器具有固定宽度并简单地在较小的浏览器窗口上裁剪，那么您可以添加`overflow:hidden`到您的#Header。至少那时它不会将#Header 高度推低超过 80 像素（这似乎是您遇到的问题）。但内容将隐藏在较小的屏幕上。

或者，使所有列容器动态化并给它们百分比宽度，以便它们随着可用宽度弯曲。例如。分别为 20%、60% 和 20%。尽管这可能会使某些窗口尺寸的宽度过小或过大。您可以添加一个`min-width`和`max-width`（绝对数量）来限制这一点。但是在狭窄的宽度`height:80px`上是不够的，所以`min-height:80px`如果您的设计允许您的#Header 灵活，那么可能会更合适？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T18:48:38.140

使用百分比，请确保您的列上没有填充。填充将增加一些宽度。对于您的标题，您可以使用位置：固定，而对于 IE6 和 7，使用位置：绝对（位置：固定）对它们不起作用。对于列，您可以添加 clearfix 方法，该方法可以帮助您毫无问题地放置其余内容。您的 HTML 可以是这样的：

```
<div id="header" class="clearfix">
  <div id="col01">Column 01</div>
  <div id="col02">Column 02</div>
  <div id="col03">Colunm 03</div>
</div> 
```

和 CSS ：

```
 #header {
    position: fixed;
    height:80px;
    width:100%;
    }

    #col01,
    #col02,
    #col03 {
    float:left;
    }
    #col01,
    #col03 {
    width:20%;
    }
    #col02 {
    width:60%;
    }
    .clearfix:after {
        content: ".";
        display: block;
        clear: both;
        visibility: hidden;
        line-height: 0;
        height: 0;
    }

    .clearfix {
        display: inline-block;
    }

    html[xmlns] .clearfix {
        display: block;
    }

* html .clearfix {
    height: 1%;
} 
```

希望它对你有帮助:-)

# c# - 从 Excel OLE 对象 C# 获取图像（元文件）

> ID：12339845
> 
> 赞同：1
> 
> 时间：2012-09-09T14:17:16.453
> 
> 标签：c#, excel, clipboard, ole, metafile

我正在处理对 OLE 对象执行一些操作的 Add in To Excel。它需要从工作表中以编程方式嵌入的 OLE 对象中获取一些数据（从数学类型转换为 TeX 语言）。到目前为止，我已经处理了大部分问题，例如将其添加到 Excel 工作表、从 Math Type OLE 对象中获取方程并设置方程。但还有最后一件事要做。

我需要提取带有由数学类型 OLE 对象设置的方程的图像的元文件。我想提取图像并将其保存为内存位图，然后在某种控件中显示它。问题是 - 我有从 OLE 对象获取元文件的代码：

```
MTSDKDN.MathTypeSDK.IOleObject oleObject = null;
        oleDataObject = dataObject as IDataObject;

        oleObject = dataObject as MTSDKDN.MathTypeSDK.IOleObject;

        ConnectFORMATETC formatEtc = new ConnectFORMATETC();
        ConnectSTGMEDIUM stgMedium = new ConnectSTGMEDIUM();
        DataFormats.Format dataFormat;

        obj.Verb((Excel.XlOLEVerb)3);
        dataObject = obj.Object;

         formatEtc.cfFormat =(Int16)DataFormats.GetFormat(DataFormats.MetafilePict ).Id;

        formatEtc.dwAspect =  System.Runtime.InteropServices.ComTypes.DVASPECT.DVASPECT_CONTENT;

        formatEtc.lindex = -1;
        formatEtc.ptd = (IntPtr)0;
        formatEtc.tymed = TYMED.TYMED_MFPICT;

        stgMedium.unionmember=(IntPtr)0;
        stgMedium.tymed=TYMED.TYMED_NULL;
        stgMedium.pUnkForRelease=0;

        oleDataObject.GetData(ref formatEtc,out stgMedium);
        //from this point no idea what to do
        IntPtr ptr;
        ptr = stgMedium.unionmember;
        HandleRef handleRef = new HandleRef(null, ptr);
        IntPtr ptrToHandle = GlobalLock(handleRef);
        int Length = GlobalSize(handleRef); 
```

我不知道我是否在做正确的事情来获取元文件，最重要的是（假设可以通过这种方式获取元文件）：如何管理元文件以将图像数据作为位图保存在加载项的内存中.

我会非常感谢你的回答。

# cakephp - CAKEPHP 分页器自定义链接

> ID：12339847
> 
> 赞同：0
> 
> 时间：2012-09-09T14:17:32.303
> 
> 标签：cakephp, pagination

我想要我的分页器的自定义链接。我使用以下代码

```
$this->Paginator->options(array(
        'url'=>array(
            "/custom",24,"custom1"
        ),
        'escape'=>false
    )
); 
```

这会导致与链接前面的原始控制器的链接，如下所示：

```
 /controller/action/%2Fcustom/24/custom1 
```

我希望链接为 /custom/24/custom1。所以没有转义（/）并作为根。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T16:32:44.157

你试过了吗

```
'url' => '/custom/24/custom1' 
```

? 我认为您使用的语法无效。可用的格式有：

```
'url' => 'action' 
```

或者

```
'url' => '/controller/action' 
```

或者

```
'url' => array(
    'controller' => 'your_controller',
    'action' => 'your_action'
) 
```

请参阅[http://book.cakephp.org/1.3/en/view/1387/options-url](http://book.cakephp.org/1.3/en/view/1387/options-url)和[http://book.cakephp.org/1.3/view/1448/url](http://book.cakephp.org/1.3/view/1448/url)。

如果这些格式都不满足您的要求，您可以考虑创建自定义路由，请参阅[http://book.cakephp.org/1.3/view/948/Defining-Routes](http://book.cakephp.org/1.3/view/948/Defining-Routes)。

干杯

# java - 如何在 Linux Mint 中使用 OpenJDK 连接到 MySQL

> ID：12339848
> 
> 赞同：2
> 
> 时间：2012-09-09T14:17:45.203
> 
> 标签：java, mysql, jdbc, openjdk

我在尝试使用以下代码获取数据库连接时遇到问题：

```
import java.lang.*;
import java.sql.*;

public class Demo {
    public static void main(String[] args){
        try{
            Connection conn = DriverManager.getConnection("jdbc:mysql://127.0.0.1:3306/test?" + "user=test&password=123456");
        }catch(SQLException ex){
            System.out.println("SQLException: " + ex.getMessage());
            System.out.println("SQLState: " + ex.getSQLState());
            System.out.println("VendorError: " + ex.getErrorCode());
        }catch(Exception ex){
            System.out.println("Exception: " + ex.getMessage());
        }
    }                                             
} 
```

输出的错误信息是：

```
SQLException: No suitable driver found for jdbc:mysql://127.0.0.1:3306/test?user=test&password=123456
SQLState: 08001
VendorError: 0

java.lang.ClassNotFoundException: com.mysql.jdbc.Driver
at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:186)
at Demo.main(Demo.java:9) 
```

我的java版本如下：

```
java -> /usr/lib/jvm/java-6-openjdk-i386/bin/java
javac -> /usr/lib/jvm/java-6-openjdk-i386/bin/javac
javac.1.gz -> /usr/lib/jvm/java-6-openjdk-i386/man/man1/javac.1.gz
javadoc -> /usr/lib/jvm/java-6-openjdk-i386/bin/javadoc
javadoc.1.gz -> /usr/lib/jvm/java-6-openjdk-i386/man/man1/javadoc.1.gz
javah -> /usr/lib/jvm/java-6-openjdk-i386/bin/javah
javah.1.gz -> /usr/lib/jvm/java-6-openjdk-i386/man/man1/javah.1.gz
javap -> /usr/lib/jvm/java-6-openjdk-i386/bin/javap
javap.1.gz -> /usr/lib/jvm/java-6-openjdk-i386/man/man1/javap.1.gz
javaws -> /usr/lib/jvm/java-6-openjdk-i386/jre/bin/javaws
javaws.1.gz -> /usr/lib/jvm/java-6-openjdk-i386/jre/man/man1/javaws.1.gz 
```

从字面上看，我不知道如何解决此错误消息。数据库存在。用户名和密码存在。我目前没有向数据库中添加任何表，但我认为这不是问题，因为毕竟我只是建立连接......

驱动安装在 /usr/share/java 下

```
-rw-r--r-- 1 root root   822524 10月 20  2011 mysql-connector-java-5.1.16.jar
-rw-r--r-- 1 root root   827942  9月  9 22:40 mysql-connector-java-5.1.21-bin.jar
lrwxrwxrwx 1 root root       35  9月  9 22:40 mysql-connector-java.jar -> mysql-connector-java-5.1.21-bin.jar
lrwxrwxrwx 1 root root       24 10月 20  2011 mysql.jar -> mysql-connector-java.jar 
```

有谁知道如何解决它.. 感谢您的帮助！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:29:37.673

确保您的项目库中有 mysql 连接器驱动程序（即 jar 文件）。当没有合适的驱动程序时会出现此错误消息。

[您可以从此站点](http://www.mysql.com/downloads/connector/j/)下载 MySQL 连接器驱动程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-06T16:01:05.470

我遇到了同样的问题，[好奇的答案](https://stackoverflow.com/a/12339940/2075782)帮助我找到了一个新的解决方案。

注意：我使用的是 Maven。

所以我决定尝试这种依赖： http: [//mvnrepository.com/artifact/mysql/mysql-connector-java](http://mvnrepository.com/artifact/mysql/mysql-connector-java)

在我添加到`pom.xml`并运行`mvn compile exec:java`它之后。

# logging - 转换为 UI 的记录器条目不再随时间更新

> ID：12339853
> 
> 赞同：3
> 
> 时间：2012-09-09T14:18:02.967
> 
> 标签：logging, javafx, javafx-2

我有一个 javafx.concurrent.Task 在后台运行一些代码并使用 java.util.logging.Logger 来提供有关其状态的信息。我需要在主线程的 UI 中显示此日志条目。我怎样才能做到这一点？

这是我制作的一个简单的玩具项目，用于解决上下文中的问题

```
@Override
public void start(Stage primaryStage) {

    ListView<String> list = new ListView<>();
    final ObservableList<String> items =FXCollections.observableArrayList ();
    list.setItems(items);

    Task<String> task = new Task<String>() {

        @Override
        protected String call() throws Exception {
            doStuff();
            return "yey";
        }
    };

    new Thread(task).start();

    Scene scene = new Scene(list, 300, 250);

    primaryStage.setTitle("Hello World!");
    primaryStage.setScene(scene);
    primaryStage.show();
}

private void doStuff() {
    for (int i=0;i<10;i++) {
        try {
            Thread.sleep(1000);
        } catch (InterruptedException ex) {
            Logger.getLogger("LoggerUI").log(Level.INFO, "error");
        }
        Logger.getLogger("LoggerUI").log(Level.SEVERE, "whatever");
    }

[...]
} 
```

我试过这个，但它不起作用

```
public class LoggerUI extends Application {

@Override
public void start(Stage primaryStage) {
    System.out.println("UI"+ Thread.currentThread().getId());

    ListView<String> list = new ListView<>();
    final ObservableList<String> items =FXCollections.observableArrayList ();
    list.setItems(items);

    Logger.getLogger("LoggerUI").addHandler(new Handler() {

        @Override
        public void publish(LogRecord lr) {
            System.out.println("publish()"+ Thread.currentThread().getId());

            items.add(lr.getMessage());
        }

        @Override
        public void flush() {
            System.out.println("flush");
        }

        @Override
        public void close() throws SecurityException {
            System.out.println("close");

        }
    });

    Task<String> task = new Task<String>() {

        @Override
        protected String call() throws Exception {
            doStuff();
            return "yey";
        }
    };

    new Thread(task).start();

    Scene scene = new Scene(list, 300, 250);

    primaryStage.setTitle("Hello World!");
    primaryStage.setScene(scene);
    primaryStage.show();
}

private void doStuff() {

    System.out.println("doStuff()"+ Thread.currentThread().getId());
    for (int i=0;i<300;i++) {
        final int j =i;
        try {
            Thread.sleep(30);
        } catch (InterruptedException ex) {

            Logger.getLogger("LoggerUI").log(Level.INFO, "error");
        }

        Platform.runLater(new Runnable() {
                @Override
                public void run() {
                    System.out.println("runLater()"+ Thread.currentThread().getId());
                    Logger.getLogger("LoggerUI").log(Level.SEVERE, "whatever" +j);
                }
            });
    }

   [..]

}
} 
```

它显示前 20-30 个条目，然后停止更新 UI

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T20:06:34.410

更新：这实际上不是 JavaFX 问题，而是 java 日志记录的问题。

将 Logger 存储到变量中，因为`Logger.getLogger()`每次返回的 Logger 都不相同，它们被缓存，垃圾收集和填充。

```
private Logger logger = Logger.getLogger("LoggerUI"); 
```

并使用如下：

```
logger.addHandler(new Handler() { ... });

logger.log(Level.SEVERE, "whatever" +j); 
```

另外，我建议将`Platform.runLater()`调用移至`publish()`方法，以便您的记录器可以从任何线程工作。

# c# - Web 应用程序，将成员状态更新为其他成员

> ID：12339857
> 
> 赞同：0
> 
> 时间：2012-09-09T14:18:37.950
> 
> 标签：c#, javascript, web-applications, postback, observer-pattern

如果他在线或离线，我想制作类似朋友状态的东西。

c# 代码背后, javascript , html5

有一个类似的问题，但它使用.php，我对php一无所知。

无论如何，我在想，对于在线，您可以跟踪用户实际登录的时间。（将数据库中的字段转为在线为真）

但是，您如何将该信息发送给需要知道其他用户是否登录的人？代码隐藏或 js 可以像他上网时调用的接收函数/方法吗？（像观察者模式？）

然后当它更新时，我们不希望整个页面刷新，但页面的@flickering 最少。回邮？

最后，要跟踪用户是否离线，它可能就像一个 http 响应来检查在线用户是否仍然在线的响应。但是怎么做？:P

如果我们最终得到它离线，我们可以使用我们通知其他人他在线的相同接收功能/方法吗？

任何帮助将不胜感激。希望这可以成为类似线程的参考。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T17:20:00.087

> 但是，您如何将该信息发送给需要知道其他用户是否登录的人？

您无法将信息发送给用户。他必须自己获取信息。我的意思是http是一个“拉协议”，这意味着你不能向客户端推送信息，你只是给他他要求的东西。

现在，您想要的是客户端在没有注意到他的浏览器正在发送请求的情况下请求信息。最好的方法是在 javascript 中使用**Ajax向****Web 服务**发送请求。这样，您可以从服务器获取信息，而无需进行任何回发。然后，为了给实时信息留下印象，您需要在 setTimeout 中设置您的 ajax 调用，以在任何给定的时间间隔（30 秒、1 分钟，您的选择）中获取信息。

为了简化 - 很多 - 您的 ajax 调用，请查看[Jquery Ajax](http://api.jquery.com/jQuery.ajax/)。

如果您对此一无所知，请不要放弃，它可能看起来比实际更复杂。

> 最后跟踪用户是否离线

我的建议是您跟踪来自该用户的每个请求，并且在没有任何请求的一段时间后，您声明该用户已注销。

希望这可以帮助！

# spring - 在 Spring MVCf 3 中维护 mvc 架构

> ID：12339862
> 
> 赞同：0
> 
> 时间：2012-09-09T14:19:18.290
> 
> 标签：spring, spring-mvc

我有两个有关系的表

tbl_department，其实体是 dept_id 和 dept_name，其中 dept_id 是主键，下一个表是 tbl_employee，其实体是 emp_id、emp_name 和 dept_id，其中 dept_id 是引用 tbl_department 的 dept_id 的外键。现在，在我的 jsp 页面中，我想显示如下格式：

Emp_id|Emp_name|dept_name。

我正在使用 JSTL sql 标记在 JSP 页面中进行上述显示，我知道它违反了 MVC 架构，所以，我该如何解决这个问题，即如何在 Spring 中的 Model 或 Controller 中而不是在 JSP 中进行这种关系映射页。有没有针对此类问题的示例或教程

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T01:04:22.847

[首先，您必须决定使用Hibernate](http://www.hibernate.org)是否值得。您应该自己研究一下，以确定您的应用程序的其余部分是否会从使用它中受益（这个话题太大了，无法在这里讨论）。

假设您只想执行问题中概述的用例，我建议您使用 Spring 的[JDBC 支持](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/jdbc.html)并创建一个 Service （或只是一个[DAO](http://en.wikipedia.org/wiki/Data_access_object)）来执行您当前在 JSP 中使用的 SQL。我将创建一个简单的[DTO 类](http://en.wikipedia.org/wiki/Data_transfer_object)来保存`Emp_id|Emp_name|dept_name`数据并将其填充到您的服务/DAO 中，然后通过控制器将其传递给 JSP。

这个[Spring MVC 示例（骨架）应用程序](https://github.com/mikaelhg/springmvc-example)将是一个很好的起点，可以了解这些组件是如何创建和连接在一起的。

# cuda - CUDA fft -cooley tukey，如何利用并行性？

> ID：12339864
> 
> 赞同：5
> 
> 时间：2012-09-09T14:19:26.857
> 
> 标签：cuda, fft

我知道 FFT 实现是如何工作的（[Cooley-Tukey 算法](http://en.wikipedia.org/wiki/Cooley%E2%80%93Tukey_FFT_algorithm)），并且我知道有一个 CUFFT CUDA 库可以快速计算 1D 或 2D FFT，但我想知道在此过程中如何利用 CUDA 并行性。

它与蝴蝶计算有关吗？（就像每个线程将部分数据加载到共享内存中，然后每个线程计算偶数项或奇数项？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T09:48:22.963

我不认为他们使用 Cooley-Tukey 算法，因为它的索引置换阶段使得共享内存架构不太方便。此外，该算法适用于内存步长的二次幂，这也不利于内存合并。他们很可能使用 Stockham 自排序 FFT 的一些公式：例如[Bailey 算法](http://crd-legacy.lbl.gov/~dhbailey/dhbpapers/fftq.pdf)。

与实现有关的，你是对的，通常将一个大的 FFT 拆分成几个较小的 FFT，它们完全适合一个线程块。在[我的工作](http://dx.doi.org/10.1007/978-3-642-03644-6_11)中，我使用 512 点或 1024 点 FFT（当然完全展开）每个线程块有 128 个线程。通常，由于需要大量数据传输，您不会在 GPU 上使用经典的 radix-2 算法。取而代之的是，选择 radix-8 甚至 radix-16 算法，以便每个线程一次执行一个大“蝴蝶”。例如实现，您还可以访问[Vasily Volkov](http://www.cs.berkeley.edu/~volkov/)页面，或查看[这篇](http://research.microsoft.com/apps/pubs/default.aspx?id=131400)“经典”论文。

# c# - 将 int 变量转换为 double

> ID：12339868
> 
> 赞同：14
> 
> 时间：2012-09-09T14:20:04.703
> 
> 标签：c#, casting, type-conversion

我是一名初学者 C# 程序员，我正在尝试创建一个计算器。我似乎无法弄清楚如何将`int`变量转换为`double`. 这是我到目前为止所拥有的：

```
public void oImpartire() {
    if (rezultat % value == 0)
    {
        rezultat /= value;
    }
    else {
       (double)rezultat /= value;  // this should be double but I get an error
    }
} 
```

我怎样才能使这项工作？

编辑：`result`和`value`都是`int`变量。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-09T14:23:08.430

```
(double)rezultat /= ... 
```

不好。强制转换表达式的结果总是一个右值，即不能赋值的东西。相关：您不能更改表达式的类型（您可以强制转换它，但这不会真正改变它的类型，只是暂时充当另一种类型）。一旦您将变量声明为 an `int`，您将无法在其中存储双精度数 - 但是您转换除法等。它最终总是会被截断。

您很可能必须引入一个`double`临时变量来存储除法的结果。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-09T14:22:44.900

```
 Convert.ToDouble(int); 
```

[http://msdn.microsoft.com/en-us/library/system.convert.todouble.aspx](http://msdn.microsoft.com/en-us/library/system.convert.todouble.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-10T14:01:35.500

如果您的两个变量都不是`double`s，请将它们分配给一个`double`变量，然后除以。

```
VarDouble = (double)int.....; VarDouble /= VarDouble1 etc

(double)rezultat /= value 
```

我认为您正在尝试制作`rezultat`a`double`并且我认为它没有被声明为 one 并且您不能那样做。你得到的变量也`result`必须是 a `double`，否则你只会得到一个不四舍五入的整数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T14:30:31.267

这取决于`rezultat`变量的类型。如果是`double`，那么您不必做任何事情，在任何情况下都不会使用整数除法。但如果它是`int`，那么你的演员表没有任何意义，你不能将`double`值存储在`int`变量中。

因此，正确的解决方案取决于您到底想做什么。但是，如果您的目标是将实际除法的结果作为 a `double`，那么您将需要一些`double`变量。如果你有这个，你`if`就没有任何意义了，`double`在所有情况下都使用除法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T14:44:26.460

试试这个：

```
double rezultat = 1992;
rezultat /= value; 
```

`resultat`必须是 a`double`来存储 的结果`rezultat / value`。否则，如果两者都是和`resultat`，您将不会得到浮点数。例如，，但是。请注意，该值只是 a 。`value``int``5 / 3 = 1``(double)5 / 3 = 1.666667``1.6666667``double`

# html - 快速搜索的中心浮动左侧

> ID：12339869
> 
> 赞同：0
> 
> 时间：2012-09-09T14:20:06.453
> 
> 标签：html, css

我想通过几个问答将快速搜索的 div 居中，但没有运气。div 与背景图像一起向左浮动。

**HTML**

```
<div class="l-row">
  <div class="QuickSearch">
    <div class="loop"></div>
    <form action=><div class="quickSearchInputName">xxx</div></form> 
  </div>
</div> 
```

**CSS**

```
.QuickSearch {
  background: url(/templates/_system/main/images/job-search-bg.jpg) no-repeat top left;
  float:left;
  width:900px;
  height:170px;
  display:block;
  text-align:center;
  margin: 0px auto 0px auto;
}

.loop {
  /* background: url(quickSearch.png) no-repeat;*/
  width: 10px; height: 135px;
  display: block;
  float: left;
  margin: 0 0 0 2px;    
}

l-row {
  max-width:942px;
  width:100%;
  min-width:942px;
  text-align:center;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:30:55.130

好吧，你这里有一个固定大小的元素，所以我想你应该遵循经典：

```
.loop {
  width: 10px; height: 135px;
  ...
  position: absolute;
  top: 50%;
  left: 50%;
  margin-top: -67px;
  /* taking into account that margin-right: 2px in the original ruleset */
  margin-left: -3px; 
} 
```

检查[这个小提琴](http://jsfiddle.net/ft2Ja/2/)（必须稍微改变它，使用纯色而不是图像作为背景）。

# java - 使用 base 40 编码字符串有什么含义？

> ID：12339872
> 
> 赞同：1
> 
> 时间：2012-09-09T14:20:26.530
> 
> 标签：java, compression, redis, base64, base32

我已经看到它建议可以使用 Base 40 编码来压缩字符串（在 Java 中发送到 Redis 实例 FWIW），并且快速测试表明它对于我使用的某些数据比我使用的替代方法更有效考虑；小号。

有什么理由比 40 更喜欢 base 32 或 64 编码吗？有什么缺点，像这样的编码可能是无损的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T18:05:15.117

40 提供字母（可能是小写，除非您的应用程序在大多数情况下倾向于使用大写）和数字 36，然后再提供四个用于标点和移位。您可以通过将剩余的一个转义来使其无损，以便接下来的一个或两个字符表示一个不在其他 39 中的字节。还有一个好方法是使用一个在大写和小写之间切换的 shift-lock 字符，如果你往往有大写字符的字符串。

40 是一个方便的基数，因为三个基数为 40 的数字非常适合两个字节。40^3 (64000) 略小于 2^16 (65536)。

你应该使用什么取决于你的数据统计。

# python - 在 NoSQL 的应用层维护数据一致性的方法有哪些？

> ID：12339880
> 
> 赞同：1
> 
> 时间：2012-09-09T14:21:11.350
> 
> 标签：python, nosql, amazon-dynamodb

我的 Python Web 应用程序使用 DynamoDB 作为其数据存储，但这可能适用于在应用程序层完成索引一致性的其他 NoSQL 表。我正在对数据进行非规范化并在几个表中创建索引以方便查找。

例如，对于我的用户表：

```
* Table 1: (user_id) email, employee_id, first name, last name, etc ...
  Table 2: (email) user_id
  Table 3: (employee_id) user_id 
```

表 1 是我存储用户信息的“主表”。如果 user_id 已知，则可以在单个 GET 查询中检索有关用户的所有信息。

表 2 和表 3 支持通过电子邮件或employee_id 进行查找，需要先查询这些表以获取 user_id，然后再查询表 1 以检索其余信息。

我担心的是非规范化数据——处理表 1 中的删除以确保从表 2 + 3 中删除匹配数据的最佳方法是什么？还确保插入？

现在我的事件链是这样的：

```
1\. Insert row in table 1
2\. Insert row in table 2
3\. Insert row in table 3 
```

最后添加“检查”是否有意义？就像是：

```
4\. Check that all 3 rows have been inserted.
5\. If a row is missing, remove rows from all tables and raise an error. 
```

还有其他技巧吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T14:33:29.257

简短的回答是：**没有办法确保一致性**。**这是您在迁移到NoSQL**以换取性能和可扩展性时同意支付的价格。

DynamoDB-mapper 有一个“**事务引擎**”。事务对象是普通的 DynamoDB 项目，可以持久化。这样，如果一组逻辑操作（即事务）成功，我们可以通过查看持久状态来确定它。但我们无法确定它没有...

做一点广告:)，dynamodb-mapper 事务引擎支持

*   单个/多个目标
*   子交易
*   事务创建对象（尚未发布）

如果您正在滚动自己的映射器（这是一项令人愉快的任务），请随时查看我们的源代码：[https ://bitbucket.org/Ludia/dynamodb-mapper/src/52c75c5df921/dynamodb_mapper/transactions.py](https://bitbucket.org/Ludia/dynamodb-mapper/src/52c75c5df921/dynamodb_mapper/transactions.py)

免责声明：我是主要的 dynamodb-mapper 项目之一。随意贡献:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T16:34:09.817

**免责声明**：我实际上并没有使用过 DynamoDB，只是查看了数据模型和 API，所以请看它的价值。

您提供的用例是数据的一个主表，其他表用于手动索引。这听起来确实像是为 RDBMS 工作（可能需要一些分片以促进增长）。但是，如果这不会削减它，这里有几个想法可能对你有用，也可能不适合你。

A. 保持原样。如果您永远不会从索引表中提供数据，那么只要您首先处理主表，您就可以负担得起延迟删除和插入。假设发生这种情况：

```
1) Delete JDoe from Main table
xxxxxxxxxx Process running code crashes xxxxxxx
2) Delete from email index       // Never gets here
3) Delete from employee_id index // Never gets here 
```

好吧，如果有一个“电子邮件”查询，您将从索引中解析相应的 user_id（现在已经过时），但它不会显示在主表上。您知道出了点问题，因此您可以返回失败/错误并清理索引。换句话说，您只需处理一些陈旧的数据，并为自己省去麻烦，并在必要时对其进行清理。您必须弄清楚预期会有多少陈旧数据，并且可能编写一个脚本来每天进行一些内务处理。

B. 如果你真的想模拟锁和事务，你可以考虑使用 Apache Zookeeper 之类的东西，它是一个分布式系统，用于管理锁等共享资源。这将是更多的工作和开销，但你可以设置它来做你想做的事。

# android - 使用 ImageLoader 库时 GridView 中的重复项

> ID：12339881
> 
> 赞同：3
> 
> 时间：2012-09-09T14:21:13.700
> 
> 标签：android, android-gridview, universal-image-loader

我`GridView`用来显示`ImageView`s 的列表。图像是通过[ImageLoader](https://github.com/nostra13/Android-Universal-Image-Loader)库从 Internet 加载的。我还实现了一个自定义适配器（扩展`BaseAdapter`）：

```
public class ImagePreviewAdapter extends BaseAdapter {

    private Context mContext;

    private List<LastPost> mPosts = new ArrayList<LastPost>();

    private ImageLoader mImageLoader;

    private ImageLoadingListener mLoadingListener;

    public ImagePreviewAdapter(Context context, List<LastPost> posts, ImageLoadingListener listener) {
        this.mContext = context;
        this.mPosts = posts;
        this.mLoadingListener = listener;

        Activity activity = (Activity)mContext;
        this.mImageLoader = ((MeanwhileInRussia)activity.getApplication()).getImageLoader();
    }

    public int getCount() {
        return mPosts.size();
    }

    public LastPost getItem(int position) {
        return mPosts.get(position);
    }

    public long getItemId(int position) {
        LastPost post = mPosts.get(position);
        return Long.parseLong(post.getId());
    }

    public View getView(int position, View convertView, ViewGroup parent) {
    ImageView imageView;

        // if it's not recycled, initialize some attributes
        if (convertView == null) {
            imageView = new ImageView(mContext);
            imageView.setLayoutParams(new GridView.LayoutParams(125, 125));
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            imageView.setPadding(0, 0, 0, 0);

            String imageLink = mPosts.get(position).getImageurl();
            DisplayImageOptions displayImgOptions = ImageLoaderConfigUtil
                .getDisplayImageOptions(mContext);

            if (mLoadingListener != null) {
                mImageLoader
                    .displayImage(imageLink, imageView, displayImgOptions, mLoadingListener);
           } else {
                mImageLoader.displayImage(imageLink, imageView, displayImgOptions);
           }

        } else {
            ImageView restoringView = (ImageView)convertView;
            imageView = restoringView;
        }

        return imageView;
    }
} 
```

每次系统调用该`getView()`方法时，我都会创建一个新`ImageView`对象并要求 ImageLoader 将图像放入其中（如果 convertView == null 当然）。对于 URL 的第一部分，一切正常。但是我的问题从第二部分开始：没有新图像`GridView`，只有第一部分的副本......我已经意识到问题隐藏在某个地方`convertView == null`：对于所有理论上的新元素，此检查始终等于 FALSE！而不是创建新对象并从 URL 加载图像，我的代码将一些旧对象放入新位置。有趣的事实：`getItemId(position)`方法为我的 LastPost 对象返回正确的 ID。这是否意味着我在适配器中有正确的 LastPosts 对象的视图不正确？

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T15:52:01.937

尝试这个....

```
public class ImagePreviewAdapter extends BaseAdapter 
{

private Context mContext;

private List<LastPost> mPosts = new ArrayList<LastPost>();

private ImageLoader mImageLoader;

private ImageLoadingListener mLoadingListener;

/**
 * Constructor
 * 
 * @param context
 * @param posts
 * @param listener - using for showing loading progress
 */
public ImagePreviewAdapter(Context context, List<LastPost> posts, ImageLoadingListener listener) {
    this.mContext = context;
    this.mPosts = posts;
    this.mLoadingListener = listener;

    Activity activity = (Activity)mContext;
    this.mImageLoader = ((MeanwhileInRussia)activity.getApplication()).getImageLoader();
}

public int getCount() {
    return mPosts.size();
}

public LastPost getItem(int position) {
    return mPosts.get(position);
}

public long getItemId(int position) {
    LastPost post = mPosts.get(position);
    return Long.parseLong(post.getId());
}

/*
 * Create a new ImageView for each item referenced by the Adapter
 */
public View getView(int position, View convertView, ViewGroup parent) {
ImageView imageView;

    // if it's not recycled, initialize some attributes
    if (convertView == null) {
        imageView = new ImageView(mContext);
        imageView.setLayoutParams(new GridView.LayoutParams(125, 125));
        imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
        imageView.setPadding(0, 0, 0, 0);

    } 
   else 
      {
        ImageView restoringView = (ImageView)convertView;
        imageView = restoringView;
     }
        final String imageLink = mPosts.get(position).getImageurl();
        final DisplayImageOptions displayImgOptions = ImageLoaderConfigUtil
            .getDisplayImageOptions(mContext);

   if (mLoadingListener != null) 
    {
       mImageLoader.displayImage(imageLink, imageView,displayImgOptions,mLoadingListener);
       }
     else 
        {
            mImageLoader.displayImage(imageLink, imageView, displayImgOptions);
       }

    return imageView;
}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:35:32.020

尝试这个

```
public View getView(int position, View convertView, ViewGroup parent) {

   ViewHolder holder = null;
    // if it's not recycled, initialize some attributes
    if (convertView == null) {
        holder = new ViewHolder();
        holder.image = new ImageView(mContext);
        holder.image.setLayoutParams(new GridView.LayoutParams(125, 125));
        holder.image.setScaleType(ImageView.ScaleType.CENTER_CROP);
        holder.image.setPadding(0, 0, 0, 0);
        convertView.setTag(holder);
    } else {
        holder = (ViewHolder) convertView.getTag();
    }

    String imageLink = mPosts.get(position).getImageurl();
    DisplayImageOptions displayImgOptions = ImageLoaderConfigUtil.getDisplayImageOptions(mContext);
    mImageLoader.displayImage(imageLink, holder.image, displayImgOptions);

    return convertView;
}

protected class ViewHolder{
    ImageView image;
} 
```

# objective-c - 滚动时创建 uitableview 单元格

> ID：12339884
> 
> 赞同：0
> 
> 时间：2012-09-09T14:21:37.377
> 
> 标签：objective-c, ios5, ios4, uitableview

我正在使用 uitableview 并且我在 cellforrow 代表中遇到问题我使用此代码

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *CellIdentifier = @"mycell";
CustomCell *cell = (CustomCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
    NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"CustomCell" owner:self options:nil];
    cell =  (CustomCell *)[topLevelObjects objectAtIndex:2];
    cell.btn_Selected.hidden=YES;
    cell.btn_Selected.tag=indexPath.row+1;

    [array_btnContainer addObject:cell.btn_Selected];

} 
```

我的问题是，当我运行应用程序时，它会加载我的表格视图并创建单元格，但是当我滚动表格视图时，它会再创建一个单元格，为什么？？？？它必须重用已经创建的单元格而不是进入 (cell==nil) 块但是当我滚动它时它会创建一个单元格并重用另一个单元格为什么？？？？我被困住了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T15:00:24.420

在 CustomCell.m 中，您必须重写以下方法，如下所示。

```
-(NSString*) reuseIdentifier{
       return @"mycell";
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T09:48:01.220

这可以通过以下步骤来实现

1.  在 .h 文件中创建您的 CustomCell 的引用，您可以使用该文件来显示 tableview，无论它是什么，都可以将其称为 ShowTableView.h。IBOutlet CustomCell *cell;

2.  转到 CustomCell.xib 并选择文件所有者，然后将类属性设置为 ShowTableView。

3.  使用 CustomCell 附加单元格引用

4.  选择 CustomCell，然后使用 mycell 设置属性 Identifier 值

5.  现在转到您的 ShowTableView.m 文件和 cellForRowAtIndexPath 方法放置此代码：

    ```
     -(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:      (NSIndexPath *)indexPath
    {

    static NSString *kCellIdentifier = @"mycell";
    cell =(CustomCell *)[tableView dequeueReusableCellWithIdentifier:kCellIdentifier];
    if (!cell)
    {
    [[NSBundle mainBundle] loadNibNamed:@"CustomCell" owner:self options:nil];      
    }  
    } 
    ```

现在它将重用您以前的单元格

# java - 如何使 BufferedImage 与此图像一起使用？（爪哇）

> ID：12339894
> 
> 赞同：0
> 
> 时间：2012-09-09T14:22:41.847
> 
> 标签：java, swing, awt, bufferedimage

我有这张照片：![第一张图片](../Images/d4137a093c5f2ae8e950d58b0f9d2244.png)

把它想象成一个 4x4 的瓦片世界，每个瓦片是 32x32 像素。

然后看一下图片： ![另一个示例图片：](../Images/0d41801f62ab7befb6ea1ebdee06ab1c.png)

看看石砖，它的边缘在网格之外。我可以`bufferedImage`为此使用 a 还是需要做其他事情才能完成这项工作？

如果是这样，你能帮我解释一下吗，因为我不知道如何实现这是我的游戏？

另一个示例图片： ![另一个示例图片：](../Images/be56f6667c7d7bbb7142fe1a88b64148.png)

让我更清楚地解释一下……第一张图片 = 网格，第二张图片 = 瓷砖重叠网格……（这就是我想要的，因为它是一个新的瓷砖，我可以用它来让我的游戏看起来更好！）， 3d 图像 = 如何平铺的示例！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T17:43:58.107

要完全消除边界伪影，您可以使用[*Penrose 瓦片*](http://en.wikipedia.org/wiki/Penrose_tiling)。

[您可以使用anti-aliasing](http://en.wikipedia.org/wiki/Spatial_anti-aliasing)减轻边缘伪影。此[示例](https://stackoverflow.com/a/11556441/230513)使用`TexturePaint`每种颜色的三种不同色调：原始、较深和较浅。您可以尝试更多的色调以获得更好的效果。

![图片](../Images/4d94c9fb98d1981ba2c41dd40107da0f.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T14:24:13.127

只需使用`PhotoShop`将图像编辑为 32x32 像素大小....然后在您的游戏中使用它....

**////////////已编辑////////////////**

[如此处](https://stackoverflow.com/a/4216635/230513)所示，`AffineTransformOp`提供了选择插值类型的额外灵活性。

```
BufferedImage before = getBufferedImage(encoded);
int w = before.getWidth();
int h = before.getHeight();
BufferedImage after = new BufferedImage(w, h, BufferedImage.TYPE_INT_ARGB);
AffineTransform at = new AffineTransform();
at.scale(2.0, 2.0);
AffineTransformOp scaleOp = 
   new AffineTransformOp(at, AffineTransformOp.TYPE_BILINEAR);
after = scaleOp.filter(before, after); 
```

# .htaccess - 使用动态 URL 进行 301 重定向

> ID：12339896
> 
> 赞同：1
> 
> 时间：2012-09-09T14:22:46.477
> 
> 标签：.htaccess

我正在尝试重写我的 .htaccess 文件以将旧的动态 URL 重定向到新的。

到目前为止，我已经尝试过这些，但它们没有按预期工作。第二条规则似乎重定向到第一条。

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^mydomain.com$
RewriteRule ^(.*)$ "http\:\/\/www\.mydomain\.com\/$1" [R=301,L]

Redirect 301 /product.php?l=old-product-name1 http://www.mydomain.com/product.php?l=new-product-name1
Redirect 301 /product.php?l=old-product-name2 http://www.mydomain.com/product.php?l=new-product-name2 
```

谁能帮我正确重定向这些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T15:27:12.580

```
 RewriteEngine on
    RewriteBase /
    RewriteCond %{HTTP_HOST} ^mydomain.com$
    RewriteRule ^(.*)$ "http\:\/\/www\.mydomain\.com\/$1" [R=301,L]

    RewriteCond %{QUERY_STRING} =l=old-product-name1
    RewriteRule ^product.php$ http://www.mydomain.com/product.php?l=new-product-name1 [R=301] 
```

# c# - 附加到 MemoryStream

> ID：12339903
> 
> 赞同：7
> 
> 时间：2012-09-09T14:23:50.457
> 
> 标签：c#, arrays, stream

我正在尝试将一些数据附加到流中。这适用于`FileStream`，但不适用于`MemoryStream`固定缓冲区大小。

将数据写入流的方法与创建流的方法是分开的（我在下面的示例中对其进行了极大的简化）。创建流的方法不知道要写入流的数据的长度。

```
public void Foo(){
    byte[] existingData = System.Text.Encoding.UTF8.GetBytes("foo");
    Stream s1 = new FileStream("someFile.txt", FileMode.Append, FileAccess.Write, FileShare.Read);
    s1.Write(existingData, 0, existingData.Length);

    Stream s2 = new MemoryStream(existingData, 0, existingData.Length, true);
    s2.Seek(0, SeekOrigin.End); //move to end of the stream for appending

    WriteUnknownDataToStream(s1);
    WriteUnknownDataToStream(s2); // NotSupportedException is thrown as the MemoryStream is not expandable
}

public static void WriteUnknownDataToStream(Stream s)
{
   // this is some example data for this SO query - the real data is generated elsewhere and is of a variable, and often large, size.
   byte[] newBytesToWrite = System.Text.Encoding.UTF8.GetBytes("bar"); // the length of this is not known before the stream is created.
   s.Write(newBytesToWrite, 0, newBytesToWrite.Length);
} 
```

我的一个想法是向`MemoryStream`函数发送一个可扩展的，然后将返回的数据附加到现有数据中。

```
public void ModifiedFoo()
{
   byte[] existingData = System.Text.Encoding.UTF8.GetBytes("foo");
   Stream s2 = new MemoryStream(); // expandable capacity memory stream

   WriteUnknownDataToStream(s2);

   // append the data which has been written into s2 to the existingData
   byte[] buffer = new byte[existingData.Length + s2.Length];
   Buffer.BlockCopy(existingData, 0, buffer, 0, existingData.Length);
   Stream merger = new MemoryStream(buffer, true);
   merger.Seek(existingData.Length, SeekOrigin.Begin);
   s2.CopyTo(merger);
} 
```

有更好（更有效）的解决方案吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-09T14:53:28.200

一个可能的解决方案是首先不限制容量`MemoryStream`。如果您事先不知道需要写入的总字节数，请创建一个`MemoryStream`未指定容量的文件并将其用于两次写入。

```
byte[] existingData = System.Text.Encoding.UTF8.GetBytes("foo");
MemoryStream ms = new MemoryStream();
ms.Write(existingData, 0, existingData.Length); 
WriteUnknownData(ms); 
```

这无疑会比`MemoryStream`从 a初始化 a 性能要差`byte[]`，但是如果您需要继续写入流，我相信这是您唯一的选择。

# c++ - C++ 构造函数\析构函数中的奇怪行为

> ID：12339910
> 
> 赞同：1
> 
> 时间：2012-09-09T14:24:39.457
> 
> 标签：c++, visual-studio-2010, recursion, constructor, destructor

我正在使用 C++ 类构造函数递归地使用它来打印“真值表”。一切似乎都很正常，直到我决定“为什么不递归地使用析构函数？”。当我还使用析构函数实现打印“真相表”时，我注意到每次控件从对构造函数的递归调用返回时都会调用析构函数。

**输出片段**

```
Calling hello_world class constructor...
000
A destructor call within initialization has been terminated
001
A destructor call within initialization has been terminated
A destructor call within initialization has been terminated
010
...
... 
```

**班上**

```
#define MAX 3
class hello_world
{
    char *const buf;
    int stack_ptr, destructor_calls;
    bool init;
public:

    // The recursive constructor

    hello_world(char *const &str, int i = 0)
        : buf(str), stack_ptr(0), init(false), destructor_calls(0)
    {
        if (i == MAX)
        {
            buf[i] = '\0';
            cout << buf << endl;
        }
        else
        {
            buf[i] = '0';
            hello_world::hello_world(str, i + 1);
            buf[i] = '1';
            hello_world::hello_world(str, i + 1);
        }
    }

    // The recusive destructor

    ~hello_world()
    {
        ++destructor_calls;
        if (!init) { cerr << "A destructor call within initialization has been terminated" << endl; return; }

        int i = stack_ptr;
        if (i == MAX)
        {
            buf[i] = '\0';
            cout << buf << endl;
        }
        else
        {
            buf[i] = '0';
            ++stack_ptr; // since a destructor cannot take parameters
            hello_world::~hello_world();
            --stack_ptr;
            buf[i] = '1';
            ++stack_ptr;
            hello_world::~hello_world();
            --stack_ptr;

            // Printing total number of calls at final call
            if (i == 0) cout << endl << "\"destrucotr_calls\" = " <<
 destructor_calls << endl;
        }
    }

    void unlock()
    {
        init = true;
    }
}; // end of class hello_world 
```

我正在使用`int hello_world::stack_ptr`存储当前`i`参数数量，因为析构函数不能有参数。

我的问题是：**为什么每次控件离开对构造函数的递归调用时都会调用析构函数？**.

这是我的主要（）：

```
void main()
{
    char buf[MAX + 1];
    cout << "Calling hello_world class constructor..." << endl;
    hello_world h(buf);
    h.unlock();
    cout << "Calling hello_world class destructor..." << endl;
} 
```

我正在使用VS2010。您可以在此处查看完整的代码及其输出[。](http://ideone.com/jE8DA)

**添加**：我正在尝试使用 . 计算调用析构函数的总数`int hello_world::destructor_calls`。我发现打印真值表算法需要`2 * (2^MAX) - 1`调用，最后`destructor_calls`完全等于这个值。但是，当计算输出中的句子`"A destructor call within initialization has been terminated"`时，我们发现它已经输出了 14 次。所以 14（初始化中的调用）+ 15（打印真值表的自然调用）应该等于 29，而`destructor_calls`仅等于 15（好像在初始化时没有调用析构函数！！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T14:31:15.197

没有递归构造函数之类的东西。看起来像递归的东西实际上是创建一个新的临时对象。

可以直接调用析构函数，但是如果对同一个对象调用两次析构函数，则会得到未定义的行为，因此不能递归调用它。

您需要做的是在构造函数或析构函数中调用另一个成员函数。然后，您可以使这些其他函数递归：

```
class A {
  A()  { construct(); }
  ~A() { destruct(); }
  void construct(int i=0) { ... construct(i+1); ... }
  void destruct(int i=MAX) { ... destruct(i-1); ... }
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T14:31:59.793

你玩火...

```
hello_world::hello_world(str, i + 1); 
```

创建临时对象，然后将其销毁...

# c# - 在 C# 中声明这样的 JSON 结构的最佳方法是什么？

> ID：12339913
> 
> 赞同：0
> 
> 时间：2012-09-09T14:25:01.063
> 
> 标签：c#, json, object, dynamic, declaration

将解决方案导入 C# 代码，其中包含这样的一段代码。

```
public object data = 
{

    Background:
    [
        [1.45,2.85, 42.6,2.85, 42.6,44, 1.45,44]
    ]
    ,
    Wall1:
    [
        [8.35,7.05, 116.3,7.05, 116.3,938.8, 8.35,938.8]
    ]
    ,
    Wall2:
    [
        [0,0, 141,0, 141,455, 0,455]
    ]
    ,
    Floor:
    [
        [0.35,8.4, 1075.05,8.4, 1075.05,48.15, 0.35,48.15]
    ]
    .... a lot of other declaration.. 
```

在 c# 中声明这种对象的最佳方法是什么？

谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:29:13.107

`IDictionary<string, object>`如果事先不知道内容，将适合您的解决方案。如果直接结构是已知的，您可以为它创建一个强类型的类，这将更易于维护且不易出错，并具有性能提升的好处。

# serialization - JPA 2.0 和 ActiveMQ：延迟加载实体通过对象消息发送

> ID：12339915
> 
> 赞同：2
> 
> 时间：2012-09-09T14:25:31.890
> 
> 标签：serialization, jpa, lazy-loading, activemq

当我加载一个包含延迟加载字段的实体并且我想通过带有 ActiveMQ 的对象消息发送该实体时，我会收到：

1.  完整实体（加载了延迟加载字段）或
2.  发送的实体（没有加载延迟加载字段）？

在任何情况下，我都需要将 Serializable 标记放在我的实体中吗？

如果是答案 1，我需要做什么才能获得答案 2 中描述的实体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T12:01:52.307

假设您有一个带有一些延迟加载字段的实体，如下所示：

```
@Entity
public class Foo
{
    @Id
    private Long id;
    @OneToMany
    private List<Bar> bars;
} 
```

当您从数据库中收到此实体时，只会`id`加载该字段，因为该`bars`字段是延迟加载`OneToMany`的（默认为延迟加载）。现在，当您通过 JMS 传递此实体时，例如，该`bars`字段未初始化，因为`getBars()`未调用该方法。当远程端调用 getter 时，它将获得 a `LazyInitializationException`，因为实体已分离且集合未初始化。

但是，如果您希望远程端能够调用`getBars()`您需要以某种方式初始化集合的方法。您可以使用`@OneToMany(fetch = FetchType.EAGER)`. 另一种方法是使用单独的查询来预先加载实体（这是我个人的偏好）。

例子：

```
select f from Foo f join fetch l.bars 
```

如果您真的想疯狂并希望在远程端延迟初始化集合，您可以查看使用 RMI 的 Hibernate 远程延迟加载。我不打算解释这一点，因为它似乎超出了问题的范围。;-)

# c# - 实体框架生成 short 而不是 int

> ID：12339918
> 
> 赞同：5
> 
> 时间：2012-09-09T14:25:58.613
> 
> 标签：c#, .net, oracle, entity-framework, ef-database-first

我们将 Entity Framework 数据库优先用于我们的 Oracle 数据库。

由于某种原因`Number(5)`变成`Int16`-`short`

最大值`Number(5)`为**99999**
最大值`Int16`为**32767**

问题......有没有办法指示映射器翻译`Number(5)`成`int32`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T09:32:06.070

解决了，将此添加到 web.config 中：

```
<oracle.dataaccess.client>
<settings>
<add name="int16" value="edmmapping number(4,0)" />
<add name="int32" value="edmmapping number(9,0)" />
</settings>
</oracle.dataaccess.client> 
```

使用文件重新创建模型`*.edmx`并...

现在代替 和代替`Number(5)`_ _`Int32``Int16``Number(10)``Int64``Int32`

我希望它会在未来对其他人有所帮助......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:49:48.840

对我来说，带有 EntityFramework 的 Oracle 总是导致我必须在生成 edmx 文件后应用一张更改表。

除了更改列的数据类型之外，我建议在 edmx 文件中手动编辑行的类型，并且记住这是每次重新生成时都必须做的事情

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-28T06:23:09.967

对于`Oracle.ManagedDataAccess.Client`，我尝试了这项工作，并注意到顶部评论中的[问题：](http://stackoverflow.com/questions/13311092/convert-oracle-number5-in-int32-with-ef4)

```
<oracle.manageddataaccess.client>
    <version number="*"> 
      <edmMappings>
        <edmNumberMapping>
          <add NETType="int16" MinPrecision="2" MaxPrecision="4" DBType="Number" />
          <add NETType="int32" MinPrecision="5" MaxPrecision="9" DBType="Number" />
          <add NETType="int64" MinPrecision="10" MaxPrecision="19" DBType="Number" />
          <add NETType="bool" MinPrecision="1" MaxPrecision="1" DBType="Number" />
        </edmNumberMapping>
      </edmMappings>
    </version>
  </oracle.manageddataaccess.client> 
```

`

# java - 使用 Java Swing 打开 Finder/Explorer

> ID：12339922
> 
> 赞同：7
> 
> 时间：2012-09-09T14:26:15.373
> 
> 标签：java, macos, swing, runtime, desktop

我正在创建一个应用程序，在该应用程序中，用户实际上可以很容易地单击应用程序中的链接，该链接会在 Finder（在 Mac 中）/Windows 资源管理器中打开一个特定文件夹。这可能发生在链接或按钮的单击事件上。

有没有办法通过 Swing 打开这些本机操作系统应用程序（针对特定文件夹）？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-09T14:59:02.837

**简短的回答：**

```
if (Desktop.isDesktopSupported()) {
    Desktop.getDesktop().open(new File("C:\\"));
} 
```

**长答案：** 虽然读取它是什么操作系统然后运行特定于操作系统的命令会起作用，但它在一定程度上需要对需要完成的操作进行硬编码。

让 Java 处理每个操作系统应该如何打开目录。不应该让我们头疼。<3 抽象。

阅读[#open(File)](http://download.java.net/jdk7/archive/b123/docs/api/java/awt/Desktop.html#open%28java.io.File%29)方法文档表明它将在所有支持该操作的操作系统上打开链接。如果当前平台不支持打开文件夹或文件（比如无头环境？当然，我猜想为什么它不会打开），它会抛出一个`UnsupportedOperationException`. 如果用户无权读取该文件夹（Windows Vista/7/8，基于 Unix 的机器），您将获得一个`SecurityException`. 所以如果你问我，它处理得很好。

*更新：*在获取对象之前添加了一个 if 检查，`Desktop`以便您的代码免于[#getDesktop() Java 文档](http://download.java.net/jdk7/archive/b123/docs/api/java/awt/Desktop.html#getDesktop%28%29)中提到的讨厌`HeadlessException`和异常。`UnsupportedOperationException`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-09T14:32:47.917

用于`Runtime.getRuntime().exec("command here");`在运行 java 的系统中执行命令。

对于 explorer.exe，您可以简单地将文件夹的绝对路径作为参数传递，例如

```
Explorer.exe "C:\Program Files\Adobe" 
```

在 Mac OS X 中，您可以使用以下`open`命令：

```
open /users/ 
```

[您可以在此处](http://www.mkyong.com/java/how-to-detect-os-in-java-systemgetpropertyosname/)了解如何检测您正在使用的操作系统，以及要运行的代码。例如，如果您在 Windows 上，这将检查：

```
public static boolean isWindows() {

    String os = System.getProperty("os.name").toLowerCase();
    // windows
    return (os.indexOf("win") >= 0);

} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-05-24T16:00:30.720

这将从文件系统中获取一个文件：

```
public static File selectDirectory(JFrame frame, File file, JComponent component, String title) {

    File selectedFile = null;

    if ("com.sun.java.swing.plaf.windows.WindowsLookAndFeel"
            .equalsIgnoreCase(UIManager.getSystemLookAndFeelClassName())) {
        JFileChooser fc = new JFileChooser();
        fc.setFileSelectionMode(JFileChooser.FILES_AND_DIRECTORIES);
        String absPath = file.getAbsolutePath();
        fc.setSelectedFile(new File(absPath));

        int returnVal = fc.showOpenDialog(component);

        if (returnVal == JFileChooser.APPROVE_OPTION) {
            selectedFile = fc.getSelectedFile();
        }
    } else {
        System.setProperty("apple.awt.fileDialogForDirectories", "true");

        FileDialog fd = new FileDialog(frame, title, FileDialog.LOAD);
        String absPath = file.getAbsolutePath();
        fd.setDirectory(absPath);
        fd.setFile(absPath);

        fd.setVisible(true);

        if (fd.getFile() != null) {
            String selectedFileName = fd.getDirectory() + File.separator + fd.getFile();
            selectedFile = new File(selectedFileName);
        }
    }

    return selectedFile;
} 
```

# jquery - jquery中的ontouchstart和ontouchend？

> ID：12339923
> 
> 赞同：8
> 
> 时间：2012-09-09T14:26:23.090
> 
> 标签：jquery, css, html, touch

我目前正在为要更改触摸类的每个元素使用以下内容：

```
ontouchstart="$(this).addClass('select');" ontouchend="$(this).removeClass('select');" 
```

我想知道是否有这样的事情？：

```
$("#element").touchstart(function(){
    $(this).addClass('select');
},
function(){
   $(this).removeClass('select');
}); 
```

我将能够列出我想要拥有此属性的所有元素。我已经尝试了很多东西，但无法让它发挥作用。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-09T16:19:55.147

我最终只使用了这个：

```
$('#nav li').bind('touchstart', function(){
    $(this).addClass('select');
}).bind('touchend', function(){
    $(this).removeClass('select');
}); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-04-14T16:11:58.277

没有 JQUERY ：

```
element.addEventListener('touchstart',function(e) {
 e.currentTarget.className = "select";
}); 
```

使用 JQUERY

```
$('#nav ul li a').on('touchstart', function(){
    $(this).addClass('select');
}); 
```

实际上，on() 比 bind() 获得更好的性能，请查看[文档](https://api.jquery.com/on/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T14:29:20.813

我认为您需要使用[jQuery Mobile](http://jquerymobile.com/)。它有一些标准化事件，这很可能是您需要的。下面是来自 jQuery Mobile 的 API 参考的特殊事件列表：[little link](http://jquerymobile.com/test/docs/api/events.html)。

你关心那些：

> vmousedown
> 
> ```
> Normalized event for handling touchstart or mousedown events 
> ```
> 
> vmousemove
> 
> ```
> Normalized event for handling touchmove or mousemove events 
> ```
> 
> vmouseup
> 
> ```
> Normalized event for handling touchend or mouseup events 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T22:26:53.703

你为什么不`:hover`为此使用伪类？在我看来，这是对`nav_li`元素的 CSS 规则的临时更改。

# jquery - 样式菜单没有滑动

> ID：12339929
> 
> 赞同：0
> 
> 时间：2012-09-09T14:27:52.280
> 
> 标签：jquery, html, css, menu

我正在尝试使这种[风格变得有趣](http://buildinternet.com/live/smoothmenu/animated-menu.html)

我正在使用本[指南](http://buildinternet.com/2009/01/how-to-make-a-smooth-animated-menu-with-jquery/)制作 html 文件 - 只需将其制作在一个文件中

我的问题是它不是幻灯片。

Html 代码 - 我不认为 html 代码有错误：

```
<ul>
        <li class="green" id="dropper">
            <p><a href="#">Home</a></p>
            <p class="subtext">The front page</p>
        </li>
        <li class="yellow" id="dropper">
            <p><a href="#">About</a></p>
            <p class="subtext">More info</p>
        </li>
        <li class="red" id="dropper">
            <p><a href="#">Contact</a></p>
            <p class="subtext">Get in touch</p>
        </li>
        <li class="blue" id="dropper">
            <p><a href="#">Submit</a></p>
            <p class="subtext">Send us your stuff!</p>
        </li>
        <li class="purple" id="dropper">
            <p><a href="#">Terms</a></p>
            <p class="subtext">Legal things</p>
        </li>
    </ul> 
```

Jquery 代码 - 问题可能在这里：

```
 $(document).ready(function(){
        //Remove outline from links
        $("a").click(function(){
            $(this).blur();
        });

        //When mouse rolls over
        $("#dropper").mouseover(function(){
            $(this).stop().animate({height:'300px'},{queue:false, duration:600, easing: 'easeOutBounce'})
        });

        //When mouse is removed
        $("#dropper").mouseout(function(){
            $(this).stop().animate({height:'50px'},{queue:false, duration:600, easing: 'easeOutBounce'})
        }); 
```

CSS 代码 - 问题可能在这里：

```
 body{
    font-family:"Lucida Grande", arial, sans-serif;
    background:#F3F3F3;
}

ul{
    margin:0;
    padding:0;
}

li{
    width:100px;
    height:50px;
    float:left;
    color:#191919;
    text-align:center;
    overflow:hidden;
}

a{
    color:#FFF;
    text-decoration:none;
}

p{
    padding:0px 5px;
}

    .subtext{
        padding-top:15px;
    }

/*Menu Color Classes*/
.green{background:#6AA63B url('http://buildinternet.com/live/smoothmenu/images/green-item-bg.jpg') top left no-repeat;}
.yellow{background:#FBC700 url('http://buildinternet.com/live/smoothmenu/images/yellow-item-bg.jpg') top left no-repeat;}
.red{background:#D52100 url('http://buildinternet.com/live/smoothmenu/images/red-item-bg.jpg') top left no-repeat;}
.purple{background:#5122B4 url('http://buildinternet.com/live/smoothmenu/images/purple-item-bg.jpg') top left no-repeat;}
.blue{background:#0292C0 url('http://buildinternet.com/live/smoothmenu/images/blue-item-bg.jpg') top left no-repeat;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:43:44.123

您必须删除相同的 id（id 是唯一值），就像 Kuro 说的那样，

但另一个错误是缺少“});” 输入结束。

而这部分代码，是你可以删除添加一些CSS（如border：0;）

```
$("a").click(function(){
    $(this).blur();
}); 
```

您正在使用 Hosting24 并且他们在所有页面中创建了一个脚本...
要删除它，请查看这个问题[Webhoster inserts a javascript 这会破坏我的代码如何删除它？](https://stackoverflow.com/questions/2268868/webhoster-inserts-a-javascript-which-brokes-my-code-how-to-remove-it)
希望这对您有所帮助。

# iphone - 用于后台播放的流式音频播放器

> ID：12339930
> 
> 赞同：-2
> 
> 时间：2012-09-09T14:28:08.693
> 
> 标签：iphone, ios, cocoa-touch, media-player, mpmovieplayercontroller

目前，我正在开发一个需要播放流音频的应用程序。我`mpmovieplayercontroller`用来播放流媒体音频。它对我来说很好。但是，当设备进入睡眠模式或进入后台模式时，音频会停止。我也想在这两种模式下播放音频。如何在这两种模式下播放流音频？我也对另一位球员持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T15:13:50.010

我会查看 Matt Gallagher 的音频流媒体。我在音频流应用程序中使用它，并且效果非常好。它还支持后台流式传输，就像您正在寻找的那样：[https ://github.com/mattgallagher/AudioStreamer](https://github.com/mattgallagher/AudioStreamer)

# javascript - 鼠标光标 - 用于 wordpress 网站

> ID：12339931
> 
> 赞同：0
> 
> 时间：2012-09-09T14:28:16.927
> 
> 标签：javascript, jquery, wordpress, plugins, cursor

我目前在我的 wordpress 网站上使用插件（[http://wordpress.org/extend/plugins/cursor-trail/](http://wordpress.org/extend/plugins/cursor-trail/)）

但是，我可能更愿意对光标轨迹使用另一种方法，以便它看起来像这个站点上的光标轨迹（除了猫鼬）：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T20:20:46.920

如果你想实现这个，你可以使用 jQuery，正如 Tom 建议的那样。

这样做的代码是：

`

```
 $(document).ready(function() { 

    $(document).mousemove(function(e) {

            //create img elements having pointer.png in their src 
            pointer = $('<img>').attr({'src':'pointer.png'});

            //and append them to document
            $(document.body).append(pointer); 

            //show them at mouse position & fade out slowly
            pointer.css({
                    'position':'absolute',
                    top: e.pageY +2 ,    //offsets
                    left: e.pageX +2   //offsets
                }).fadeOut(1500);   
});
}); 
```

`

# mysql - 将 MySQL 数据库转储转换为 SQLite - INSERT 语法

> ID：12339933
> 
> 赞同：0
> 
> 时间：2012-09-09T14:28:38.473
> 
> 标签：mysql, sqlite

我正在尝试使用以下命令将我的数据库转储调整为 SQLite 格式： `cat db.sql | sqlite3 sqlite.db`

我收到以下错误： `Error: near line 82: near ",": syntax error` ，其中第 82 行代表：（ `INSERT INTO files (file_id,file_name) VALUES`以下格式的插入数据位于`(31, 'file_name.pdf'),`以下行中）。

根据[本教程](http://souptonuts.sourceforge.net/readme_sqlite_tutorial.html)，INSERT 是正确的 SQLite 语法。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T16:36:12.917

在一个 INSERT 命令中有多个记录不是标准 SQL。

如果使用此语法，则至少需要 SQLite 3.7.11。

# java - JAVA中的冒泡排序

> ID：12339939
> 
> 赞同：-5
> 
> 时间：2012-09-09T14:29:22.403
> 
> 标签：java

我正在尝试编写一个冒泡排序程序。它显示错误。但我不明白为什么？我是java新手

```
public static  void main(String[] args) {
    int []arr={12,23,43,34,3,6,7,1,9,6};
        {  
              int temp;
              for (int i=0;i<arr.length;i++)
              {  
                for (int j=0;j<arr.length-i;j++ )
                {
                  if (arr[j]>arr[j+1])
                 {  
                     temp=arr[j];
                     arr[j+1]=arr[j];
                     arr[j+1]=temp;
                  }
                }
              } 
            }
        for(int i=0; i<arr.length; i++)
         {
             System.out.print(arr[i] + " ");
         }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T14:33:32.877

有什么错误？

我怀疑是`IndexOutOfBoundsException`？这可能是您使用的语句`if`where `j + 1`when `j == arr.length - 1`。`i == 0`

由于这是家庭作业，我会留给你来解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:32:08.703

试试这个代码......

```
public class TestBubbleSort {
    public static void main(String[] args) {
        int unsortedArray[] = {10, 97, 6, 23, 0, -45, 697, -1000, 1, 0}; //Random set of numbers for example.
        int i;

        bubbleSort(unsortedArray, unsortedArray.length); //Pass the array to be sorted and its length.

        System.out.println("After sorting, the list elements are: "); //Just to show you it worked. :)

        for(i=0; i<unsortedArray.length; i++) {
            System.out.print(unsortedArray[i] + " ");
        }
    }

    private static void bubbleSort(int[] unsortedArray, int length) {
        int temp, counter, index;

        for(counter=0; counter<length-1; counter++) { //Loop once for each element in the array.
            for(index=0; index<length-1-counter; index++) { //Once for each element, minus the counter.
                if(unsortedArray[index] > unsortedArray[index+1]) { //Test if need a swap or not.
                    temp = unsortedArray[index]; //These three lines just swap the two elements:
                    unsortedArray[index] = unsortedArray[index+1];
                    unsortedArray[index+1] = temp;
                }
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-26T06:39:56.797

```
 public static void main(String[] args) {
        //insert random value in array
        Scanner sc=new Scanner(System.in);
        System.out.println("no of element");
        int noEle=sc.nextInt();
        int[] eleArr=new int[noEle] ;//storing element in this array
        for(int i=0;i<noEle;i++)
        {
            eleArr[i]=sc.nextInt();//enter element for storing 
        }
        for(int i=0;i<eleArr.length;i++)
        {
            for(int j=0;j<eleArr.length-1;j++)
        {
            if(eleArr[j]>eleArr[j+1])
            {//nothing but swaping logic without taking third variable
                eleArr[j]=eleArr[j]+eleArr[j+1];
                eleArr[j+1]=eleArr[j]-eleArr[j+1];
                eleArr[j]=eleArr[j]-eleArr[j+1];
            }
        }
        }
        //getting sorted elemen as bubblesort
        for(int i=0;i<noEle;i++)
        {
            System.out.print(eleArr[i]+" ");  
        }
        System.out.println();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-11T14:25:33.050

请试试这个代码，它是相反的顺序，但你会明白的。

```
public class SortArray 
{
    public static void main(String[] args)
    {
        int[] arr={4,6,4,2,764,23,23};
        sort(arr);
    }
    static void sort(int[] arr)
    {
        int k;
        for(int i=0;i<arr.length;i++)
        {
            for(int j=i;j<arr.length-1;j++)
                {
                    if(arr[i]<arr[j+1])
                    {
                        k=arr[j+1];
                        arr[j+1]=arr[i];
                        arr[i]=k;
                    }
                }
            System.out.print(arr[i]+" ");
        }   
    }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-06-22T04:08:00.307

您可以查看此代码：

```
public static void BubbleSort(int[] Array){

    for(int i = Array.length ; i>0 ; i--)
    {
            for(int j=0;j<i-1;j++){

                if(Array[j]>Array[j+1])
                    Swap(Array,j,j+1);
            }
    }

} 
```

# mysql - 并发 LOAD DATA INFILE 和 DELETE

> ID：12339941
> 
> 赞同：0
> 
> 时间：2012-09-09T14:29:38.513
> 
> 标签：mysql, performance, load-data-infile

我有一个`Calls`包含 3 列的表`messageType`：`callId`和`lastModified`。

对于每次调用，在 DB 中写入 4 行，每条消息一个。有 4 种类型的消息：**CALL-SETUP**、**CALL-PROGRESS**、**CALL-START**和**CALL-STOP**（代码 4）。

列`messageType`和`callId`组成主键。

我想删除以下行：

*   对应于终止呼叫的行。当 CALL-STOP 消息已写入 DB 时，呼叫终止。
*   自 4 小时以来未修改的行（例如）。

我使用了以下查询：

```
DELETE FROM Calls WHERE callId IN (SELECT * FROM (SELECT DISTINCT callId FROM Calls WHERE messageType=4 OR TIMESTAMPDIFF(SECOND,lastModified,NOW()) > 14400) AS tmp); 
```

我只使用这个语句来清理表。但是，与此同时，大文件（大约 30000 行）使用 也非常频繁地（例如每秒）填充该表`LOAD DATA INFILE`，我确实看到了仅加载数据和加载数据 + 清洁之间的性能差异。

我可以做些什么来提高性能？关于 SQL DELETE？在数据库本身？

我确切地说我使用MySQL。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T21:00:59.843

给你几个想法：

1) 我真的很讨厌 DISTINCT。每个呼叫是否只有一个 messageType 为 4？如果是这样，您将 DISTINCT 用于 OR 子句的修改部分。这个怎么样：

```
 WHERE messageType = 4
 OR (messageType = 1 and lastModified < datesub(now(), interval 4 hour) 
```

（因此您只会获得一个 ID，无需区分它们）。

2) 不要在日期列上运行公式 - 引擎不能使用索引！请参阅上面的 WHERE 子句，将公式移动到另一侧，在那里它可以使用索引并且可以缓存常量值。

3）你没有描述你的索引，但你可能想要一个复合索引（lastModified，messageType，callId）。

4) 正如其他人所说，发动机的选择确实很重要。myisam 锁定一切。试试innodb。

5) 有时 MySQL 不喜欢大范围日期的日期索引。尝试使用脚本删除小批量。

祝你好运！

# php - 在 PHP 中清理合法变量名的字符串

> ID：12339942
> 
> 赞同：3
> 
> 时间：2012-09-09T14:30:10.237
> 
> 标签：php, string, class, variables, sanitization

我有类似下面的代码，它声明了一个类，它的名称基于检索到的字符串。但问题是字符串可能包含 PHP 不接受作为类名的非法字符。那么有没有一种在将字符串用作类名之前对其进行清理的好方法？

```
$retrieved_string = 'some unformatted string; it may contain illegal characters to be passed as a class name.';

$strMyScript = basename(__FILE__, ".php"); 
$strMyScript = sanitize_variable($strMyScript);
$strClassName = sanitize_variable($retrieved_string);

eval('
    class ' . $strMyScript . '_' . $strClassName . ' extends AnotherClass {
        // some code here
    }
');

funaction sanitize_variable($string) {
    // sanitize the string
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:35:59.130

您可以使用以下方法检查字符串是否为有效标识符（类名、变量名或函数名）

```
if (preg_match("/^[_a-zA-Z][_a-zA-Z0-9]*$/", $received_string)) {
    // valid name
} else {
    // invalid name
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:34:37.037

PHP 作者提供了一个正则表达式，请参阅[类的手册条目](http://www.php.net/manual/en/language.oop5.basic.php)：

```
<?php

if (preg_match('/^([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*)$/', $strClasssName)) {
    // etc.
} 
```

函数名称或任何其他标签也是如此。

如果您要清理字符串，那么也许您需要删除所有不是的内容`[a-zA-Z0-9_\x7f-\xff]`然后进行验证`^([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*)$`（不同之处在于，虽然整数是允许的字符，但类/函数名称可能不以一个开头）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T14:45:11.817

首先决定你需要什么过滤器或验证器。验证器将返回真/假。然后您可以引发异常，为用户产生错误或忽略该文件。另一种选择是使用过滤器，它可以有效地从输入字符串中删除字符。

```
public function sanitize($input)
{
    $pattern = '/[^a-zA-Z0-9]/';

    return preg_replace($pattern, '', (string) $input);
} 
```

您可能还想检查 unicode。模式是：

```
public function sanitize($input)
{
    if (!@preg_match('/\pL/u', 'a'))
    {
        $pattern = '/[^a-zA-Z0-9]/';
    }
    else
    {
        $pattern = '/[^\p{L}\p{N}]/u';
    }
    return preg_replace($pattern, '', (string) $input);
} 
```

还需要考虑的问题：

*   是否要启用空白支持？在这种情况下，您需要在 $pattern 变量中添加一个空格。
*   文件名是否为英语以外的其他语言？然后，您将需要进行一些特定于语言环境的操作以使 $pattern 保持最新。

高温高压

# objective-c - 自定义 UITableViewCell 缺少行分隔符

> ID：12339943
> 
> 赞同：0
> 
> 时间：2012-09-09T14:30:17.337
> 
> 标签：objective-c, uitableview

我在 IB 中设置了 UITableView 的行分隔符样式和颜色，但是，当表格加载时，分隔线不可见。

我正在使用具有自定义超类的 UITableView `CustomTableView`- 这是`UITableView`. 在此表中，我还使用了自定义`UITableViewCell`.

我能想到的唯一问题是，如果我没有在我的`awakeFromNib`方法中调用“超级”实现——但我这样做了，所以不可能那样。

有任何想法吗？

**用代码编辑**

我的表格单元格如下 - CustomDefaultCell.h > CustomPlainCell.h > UITableViewCell

自定义默认单元格.m

```
- (void)awakeFromNib
{
    [super awakeFromNib];

    // Called when loaded from a nib.
    // Override all default cell behaviour here.
    //
} 
```

CustomPlainCell.m

```
- (void)awakeFromNib
{
    [super awakeFromNib];

    // Called when loaded from a nib.
    // Override all default cell behaviour here.
    //
    // Normal background view
    self.backgroundView = [[UIView alloc] initWithFrame:self.frame];
    self.backgroundView.backgroundColor = [UIColor whiteColor];

    // Selected background view
    self.selectedBackgroundView = [[UIView alloc] init];
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
    //
    // Background gradient
    CAGradientLayer *selectedViewGradientLayer = [CAGradientLayer layer];
    selectedViewGradientLayer.frame = CGRectMake(1.0f, 0.0f, 320.0f, CGRectGetHeight(self.frame) + 1.0f);
    selectedViewGradientLayer.colors = @[(id)[UIColor colorWithHue:0.0f saturation:0.0f brightness:0.57f alpha:1.0f].CGColor, (id)[UIColor grayColor].CGColor];

    [self.selectedBackgroundView.layer addSublayer:selectedViewGradientLayer];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-30T13:18:55.253

`[super layoutSubviews];`有同样的问题，并认为在单元原型类中覆盖该方法时我没有调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T18:15:31.227

最终我决定使用委托方法`tableView:willDisplayCell:forRowAtIndexPath:`，如果单元格是“CustomPlainCell”的子类，则添加一个 1pt 高`UIView`的背景色。

# php - 传递给php表单时javascript动态变量的未定义索引

> ID：12339945
> 
> 赞同：0
> 
> 时间：2012-09-09T14:30:40.970
> 
> 标签：php, javascript, html, variables

```
<form action="testing.php" method="POST" id="addreciept" name="addreciept">
Unit<input name="unit1" type="text" id="unit1" size="17" onkeyup="calc()"   value="0"/>
Rate<input name="rate1" type="text" id="rate1" size="17" value="0" onkeyup="calc()"  />
Amount<input name="amount1" type="text" id="amount1" size="17"  disabled="true"   />
Total Amount: <input type="text" name="totalamount" id="totalamount" disabled="true"   value=""> 
Amount Paid: <input type="text" name="amount_paid" id="amount_paid" onkeyup="calc_balance()" />
Balance: <input type="text" name="balance" id="balance" disabled="true"  value="0"> 
<center>
<input type="submit" value="Save " class="button" >
</center>
</form>

<script>
function calc()
{
unit=document.getElementById('unit1').value;
rate=document.getElementById('rate1').value;
amount=unit*rate;
document.getElementById('amount1').value=amount;
total_amount=document.getElementById('amount1').value;
document.getElementById('totalamount').value=total_amount;
}
function calc_balance()
{
tota_amount=document.getElementById('totalamount').value;
paid_amount=document.getElementById('amount_paid').value;
document.getElementById('balance').value=tota_amount-paid_amount;
}
</script> 
```

我最近测试了发布在 net 上的脚本，它可以工作，但我想我做错了什么:'( 我严重卡在其中，因为诸如 amount1、totalamount 和 balance 之类的动态变量导致未定义索引 amount1 等错误

请弄清楚:(

php很简单>>

```
<?php
echo $_POST['unit1'];
echo $_POST['rate1'];
echo $_POST['amount1'];
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:42:28.440

禁用时不会提交表单元素（禁用amount1，totalamount和balance）

改用只读属性

# autohotkey - 将热键发送到最小化的 chrome 窗口

> ID：12339949
> 
> 赞同：4
> 
> 时间：2012-09-09T14:31:29.220
> 
> 标签：autohotkey, minimized

我需要一个自动热键脚本，可以将 alt+backspace 发送到最小化的 chrome 窗口（而不最大化它）。

基本上，我有[一个我制作的网络播放器应用程序](http://player.highstrike.org/)，在一个较小窗口中打开的播放器窗口上，您可以按 alt+backspace，它会在窗口获得焦点时静音和取消静音。（JavaScript 事件）

活动窗口信息这样说：

```
>>>>( TitleMatchMode=slow Visible Text )<<<<
player.highstrike.org/play/ 
```

我希望脚本仅适用于该网址。我曾尝试将 cmds 发送到该窗口但无济于事，有人可以帮我吗？我真的很感激。谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-09T15:26:05.130

我正在寻找的代码是

```
SetTitleMatchMode, Slow
Return

$!BS::
KeyWait, BS
ControlSend,Chrome_RenderWidgetHostHWND1,!{Backspace},,player.highstrike.org/play/
Return 
```

# php - 触发 onclick 事件后没有任何反应

> ID：12339950
> 
> 赞同：0
> 
> 时间：2012-09-09T14:31:33.737
> 
> 标签：php, html, jquery

jquery 中的新手在这里：当我单击提交按钮时，我希望它会回显某些内容，但它没有。我不知道我的代码有什么问题。请帮忙

这是我的js

```
 <script src="http://code.jquery.com/jquery-1.8.1.js"></script>
        <script>
            function add_contact(){
            $.post( "add.php", { 
                "name": $("#txtName").val(),
                "contact": $("#txtContact").val(),
                "email": $("txtEmail").val()
                }, 
                function(msg){
                    $("#message").html(msg);
            });
            return false;
            }
        </script> 
```

这是我的html

```
 <label for="txtName">Name</label>
                    <input id="txtName" type="text">
                <label for="txtContact">Contact Number</label>
                    <input id="txtContact" type="text">
                <label for="txtEmail">E-mail</label>
                    <input id="txtEmail" type="text">
                <label id="message"></label>
                    <input type="submit" value="Save" onclick="return add_contact()"> 
```

这是我的 add.php

```
 <?php
    if(isset($_POST['name'])&&isset($_POST['contact'])&&isset($_POST['email'])){
        echo 'Good';
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T19:02:21.950

缺少#号！

```
"email": $("txtEmail").val() 
```

将其更改为

```
"email": $("#txtEmail").val() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T14:34:38.983

尝试

```
onclick="add_contact();" 
```

代替

```
onclick="return add_contact()" 
```

[编辑：]

我对这种情况进行了一些处理，并稍微修改了您的代码。查看[http://jsfiddle.net/Pbf2T/16/](http://jsfiddle.net/Pbf2T/16/)

这是JS

```
$(function(){
    var add_contact = function() {
        $.ajax({
            url: "add.php",
            data: {
                "name": $("#txtName").val(),
                "contact": $("#txtContact").val(),
                "email": $("#txtEmail").val()           
            },
            success: function(data) {
                alert("success");
                $("#message").html(data);
            },
            error: function(x,t,error) {
                alert("error: " + error);
                console.log(error);                
            }            
        })
    }

    $('input[type="submit"]').click(function(e){
        e.preventDefault();
        add_contact();
    })
}) 
```

如果您尝试此操作，请回复您看到的错误。

[EDIT2:] 好的，请尝试上述方法，然后报告。在成功处理程序中，我输入了返回的数据。​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T14:44:31.013

您不应该在通过邮件发送的数据周围加上引号，即`"name": $("#txtName").val()`应该只是. 而不是`name: $("#txtName").val()`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T14:44:40.417

尝试使用 type="button" 而不是提交

```
<input type="submit" value="Save" onclick="return add_contact()"> 
```

当您使用 ajax 进行提交时。

# postgresql - 查看一个函数正在运行什么命令是postgres

> ID：12339953
> 
> 赞同：0
> 
> 时间：2012-09-09T14:31:52.917
> 
> 标签：postgresql

假设我运行一个函数：`select somefunction()`我想知道它目前正在执行什么语句

`select * from t`没有帮助，因为它显示了“select somefunction()”行而不是确切的语句。

有什么办法可以查看是怎么回事吗？

谢谢，h

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T07:15:09.400

您可能想要使用[PL/PgSQL 调试器](http://pgfoundry.org/projects/edb-debugger/)- 它应该预装在大多数 PostgreSQL 安装中，并在`postgresql.conf`.

或者，考虑`RAISE NOTICE`在您希望了解的重要点在您的代码中添加语句。

据我所知，没有工具可以获取活动 SQL 语句的“堆栈跟踪”，包括（可能是嵌套的）函数调用。这会很好，但是AFAIK没有人实现过这样的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T06:11:07.840

这可以帮助你。

> CREATE FUNCTION somefunction() 返回 table(query text) as $$ select current_query::text from pg_stat_activity where current_query not like '% somefunction();' $$语言sql；

# php - 管理我的会话

> ID：12339955
> 
> 赞同：0
> 
> 时间：2012-09-09T14:32:06.747
> 
> 标签：php, session, login, session-variables

我在每次登录时创建会话变量，它是 $_SESSION['usr'] 和 $_SESSION['psw']。当我注销时，我正在使用以下代码销毁它们：

```
<?php
session_start();
session_destroy();
if(count($_SESSION) == 0)
{
$_SESSION=array();
session_destroy();
}
header("Location:home.php");
?> 
```

我要做的是限制某些页面仅供登录用户使用，所以我尝试使用这段代码：

```
<?php if(!$_SESSION['usr']){header('Location:home.php');} ?> 
```

我不明白为什么它不起作用，因为它完全有意义，但没有人知道为什么？谢谢你的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T16:25:32.543

您不应该尝试两次破坏会话。

它应该是：

```
<?php
  session_start();   
  $_SESSION = array();
  //Session Cookie
  if (ini_get("session.use_cookies")) {
      $params = session_get_cookie_params();
      setcookie(session_name(), '', time() - 42000,
        $params["path"], $params["domain"],
        $params["secure"], $params["httponly"]
      );
  }
  session_destroy();
?> 
```

[http://php.net/manual/en/function.session-destroy.php](http://php.net/manual/en/function.session-destroy.php)

无需检查是否设置了某些内容。检查应该是：

```
<?php if(!isset($_SESSION['usr'])) {
   //header() - see below
} ?> 
```

并且位置需要是一个绝对网址（例如`http://www.mydomain.com/home.php`）

# sqlite - SQLITE 和外键

> ID：12339959
> 
> 赞同：1
> 
> 时间：2012-09-09T14:32:28.530
> 
> 标签：sqlite, foreign-keys

我正在查看一些定义如下的数据库表：

这是第一张桌子——

```
CREATE TABLE Point 
(

    Position integer unique not null,  
    Name text not null,                
); 
```

第二个表是这样的：

```
CREATE TABLE namesPerPoint 
(

    PointKey integer not null,            -- unique ROWID in points table
    name text unique not null
); 
```

现在，我的问题是 sqlite db 如何知道 PointKey 在 Positions 表中引用 rowid。它只是在评论中提到，为了用户方便。如果我自己必须这样做，我会使用 FOREIGN KEY 约束。那么，这种语法正确吗？但这是大型成功运行系统的一部分，所有表都只是这样定义的。所以，我假设我错过了一些东西。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:40:14.127

不，除非您创建外键约束。但首先，您需要`turn on`外键支持

```
sqlite> PRAGMA foreign_keys = ON; 
```

向主表添加主键

```
CREATE TABLE Point 
(

    Position integer PRIMARY KEY,  
    Name text not null,                
); 
```

然后添加外键

```
CREATE TABLE namesPerPoint 
(
    PointKey integer not null,            -- unique ROWID in points table
    name text unique not null,
    FOREIGN KEY (PointKey) REFERENCES Point(Position)
); 
```

首要的关键

**[来源：SQLite 外键支持](http://www.sqlite.org/foreignkeys.html)**

# html - 无法通过 rake 资产预编译 Rails 应用程序中的所有 CSS：预编译

> ID：12339961
> 
> 赞同：0
> 
> 时间：2012-09-09T14:32:52.477
> 
> 标签：html, css, ruby-on-rails, ruby

我有一个 Rails 应用程序，现在尝试将它部署到我的本地 apache 服务器。

我尝试通过命令预编译 css、javascript 文件，但`rake assets:precompile`没有出现错误。

但是，我无法通过 localhost 正确访问该网站，并且我检查了生产日志文件。

错误 ：

> ActionView::Template::Error (scaffolds.css 未预编译): 3: 4: Pragprog Books Online Store 5: 6: <%= stylesheet_link_tag "scaffolds" %> 7: <%= stylesheet_link_tag "depot", :media => “全部” %> --> 8: <%= stylesheet_link_tag “分页” %> 9: app/views/layouts/application.html.erb:6:in `_app_views_layouts_application_html_erb__1763484413904368549_70243433398420'

看来scaffolds.css 不能用命令预编译。

我已将配置更改为`config.assets.compile = true`并且我的网站可以正常工作。:) 但我想知道为什么该命令无法预编译该 css。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-09T15:19:12.820

在您的 production.rb （或您正在使用的任何环境）中查看这些行，它们可能仍被注释掉：

```
# Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)
# config.assets.precompile += %w( search.js ) 
```

只需使用此选项指定要预编译的附加资产，例如：

```
config.assets.precompile += %w( *.js *.scss *.coffee *.css ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T18:10:17.250

出于好奇，您是否将其添加到您的 application.css 清单文件中？

# javascript - DOM 中基于像素的图像操作

> ID：12339963
> 
> 赞同：0
> 
> 时间：2012-09-09T14:33:00.300
> 
> 标签：javascript, jquery, html

作为我正在用 Javascript 开发的游戏的一部分，我想：

1.  从 URL 加载图像
2.  对其进行一些基于像素的操作（准确地说，对其进行一些颜色过滤器操作）
3.  将处理后的图像作为一个`<IMG>`节点放入 html 文档的 dom 中

我已经很清楚如何完成前两部分了——我只是要将图像绘制到一个不可见的画布上。但是我该怎么做最后一个？

我考虑从画布中提取原始二进制数据，然后将其转换为数据 URL。但这对我来说似乎很难。没有更直接的方法吗？当有帮助时，我有可用的 jQuery 和 jQueryUI。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-09T14:37:25.663

该`canvas`元素有一个[`toDataURL()`方法](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurl)，可以为您提供现成的数据 URL。

# html - 存储在 C:\ 中的图像作为 html 文档的背景

> ID：12339965
> 
> 赞同：0
> 
> 时间：2012-09-09T14:33:04.490
> 
> 标签：html, background-image

我有这个漂亮的小代码行

```
<html style="background-image:url(file:///C:\inetpub\wwwroot\lifehacks.png); background-repeat:repeat; background-attachment:fixed; overflow:scroll;"> 
```

我基本上是在整理一个练习网站来习惯 html。当我将背景作为指向包含此类图像的网站的链接时

```
style="background-image:url(http://a0.twimg.com/profile_images/1381375879/lifehacks10.png) 
```

它工作得很好。我将图像保存到我的 wwwroot 文件夹，其中包含我的 html 文档。为什么现在不显示图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T14:35:09.740

如果图像与您的 html 文档位于同一文件夹中，您可以这样做：

```
<html style="background-image:url(lifehacks.png); background-repeat:repeat; background-attachment:fixed; overflow:scroll;"> 
```

# android - 使用 CursorLoader 处理 ListView 中的不同查询

> ID：12339967
> 
> 赞同：1
> 
> 时间：2012-09-09T14:33:36.517
> 
> 标签：android, cursor, android-cursoradapter, android-cursorloader

我想在单个 ListView 的不同时间反映来自 sqlite 数据库中各种表的数据。

初始查询工作正常，如下所示：

*   我有一个自定义 CursorAdapter 类 ( `AutoCursorAdapter extends CursorAdapter`)，它可以显示来自游标的任意数据：
    *   `AutoCursorAdapter.newView()`询问游标并构造对应于列中数据类型的视图。
    *   AutoCursorAdapter.bindView() 从游标中获取数据并填充在 newView 中为游标中的每一行数据创建的视图。
*   我还在拥有的 Fragment 中实现了一个加载器，如下所示：

    ```
    public class MyFragment extends Fragment implements LoaderManager.LoaderCallbacks<Cursor>{
    ...
        public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
             ...
             mListView = ((ListView) view.findViewById(R.id.listview));
             mAdapter = new AutoCursorAdapter(getActivity());
             mListView.setAdapter(mAdapter);
             return view;
         }

         public void onStart() {
            super.onStart();
            // Prepare the loader.  Either re-connect with an existing one,
            // or start a new one.
            LoaderManager lm = getLoaderManager();
            Bundle args = getArguments();
            lm.initLoader(LOADER_ID, args, this);
        }

        public Loader<Cursor> onCreateLoader(int id, Bundle args) {
            CursorLoader CursorLoader = new CursorLoader(getActivity());
            setupLoader(CursorLoader); //Sets the URI, projection etc. depending on app state
            return CursorLoader;
        }

        public void onLoaderReset(Loader<Cursor> loader) {
            mAdapter.swapCursor(null);
        }
    } 
    ```

到现在为止还挺好。数据在初始运行时加载。假设它使用 URI_A 从表 A 中提取和显示数据。

**但现在的问题是**：如何处理我想切换到使用 URI_B 显示表 B 中的数据以响应用户操作的情况？

*   我可以使用单个 Loader 实例执行此操作吗？

    1.  如果有怎么办？例如`CursorLoader.setUri()`不会触发重新加载。
    2.  如果没有，我该如何正确管理多个加载器实例？
*   这是装载机可能不是可行的方法吗？

*注意：问题**不**在于表 A 中底层数据库的反映变化。这已经通过 NotifyChange 机制在 UI 中正确更新。这个问题是关于完全改变底层查询的性质。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T15:26:25.957

> 我可以使用单个 Loader 实例执行此操作吗？

我不会推荐它。`Cursor`加载器有足够的状态，试图像这样显着改变它们可能会很麻烦，并且当它们都返回相同的数据类型（例如， ）时，拥有多个加载器并不是什么大不了的事。

> 如果没有，我该如何正确管理多个加载器实例？

为它们使用不同的 ID（第二个参数 on ），并根据 ID`initLoader()`创建权限`Loader`。`onCreateLoader()`

# ios - zbar #ifdef iOS 中 minizip 的问题

> ID：12339969
> 
> 赞同：0
> 
> 时间：2012-09-09T14:33:50.283
> 
> 标签：ios, zip, conditional-compilation, zbar-sdk

我需要将#import "ZBarSDK.h" 写入#ifdef **OBJ**部分，因为如果在另一个地方有导入，Minizip 将不起作用！

```
#ifdef __OBJC__
#import <UIKit/UIKit.h>
#import <Foundation/Foundation.h>
#import "ZBarSDK.h"
#endif 
```

但后来我得到一个错误：

```
Undefined symbols for architecture armv7:
  "_OBJC_CLASS_$_ZBarReaderViewController", referenced from:
      objc-class-ref in ViewController.o
  "_ZBarReaderControllerResults", referenced from:
      -[ViewController imagePickerController:didFinishPickingMediaWithInfo:] in ViewController.o
  "_OBJC_CLASS_$_CIImage", referenced from:
      objc-class-ref in ImageViewController.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

有人可以帮忙吗？我的0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:43:13.270

前两条消息的原因可能是“ZBarSDK”提供了一个静态库 (ZBarSDK.a)，其中仅包含 ARMv6 代码（或者可能是 Intel i386）。您要么需要下载提供 ARMv7 目标代码的更新版本，要么下载其源代码并自行编译。

第三个错误来自于您没有将 CoreImage 框架添加到您的项目中。

# macos - 在 OSX x64 程序集中使用 RIP 相对寻址

> ID：12339972
> 
> 赞同：5
> 
> 时间：2012-09-09T14:34:44.000
> 
> 标签：macos, assembly, 64-bit, nasm, x86-64

我试图`printf`在 OSX 的 x86-64 汇编代码中制作一个基本示例，这是我的第一个版本：

```
section .data
msg db 'hello', 0Ah

section .text
extern _printf

global _main
_main:
  sub rsp, 8

  mov rdi, msg
  mov rax, 0
  call _printf

  add rsp, 8

  ret 
```

因此，这段代码将第一个参数的绝对地址移动`msg`到，然后 gcc 抱怨缺少与位置无关的代码。二进制文件仍然有效：`rdi``_printf`

```
→ nasm -f macho64 new.asm && gcc -m64 -o new new.o && ./new
ld: warning: PIE disabled. Absolute addressing (perhaps -mdynamic-no-pic) not allowed in code signed PIE, but used in _main from new.o. To fix this warning, don't compile with -mdynamic-no-pic or link with -Wl,-no_pie
hello 
```

因此，当我使用 nasm 语法更改代码以使用 RIP 相对寻址时，`[rel ...]`警告消失但可执行文件现在出现段错误：

```
section .data
msg db 'hello', 0Ah

section .text
extern _printf

global _main
_main:
  sub rsp, 8

  mov rdi, [rel msg]
  mov rax, 0
  call _printf

  add rsp, 8

  ret 
```

当我编译并运行它时：

```
→ nasm -f macho64 new.asm && gcc -m64 -o new new.o && ./new
zsh: segmentation fault  ./new 
```

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-09T15:39:19.540

问题是原来在汇编时`mov rdi, msg`加载了内存地址。`msg``rdi`

当它被更改为 时`mov rdi, [rel msg]`，这产生了使用值`msg`作为相对地址的代码，如调试时所见：

```
Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_INVALID_ADDRESS at address: 0x00000a6f6c6c6568 
```

`msg`请注意地址如何包含来自,的字节`0x00000a<olleh>`。

正确的解决方案是使用`lea`指令在运行时加载有效的 RIP 相对地址`msg`，如下所示：

```
lea rdi, [rel msg] 
```

# redirect - Nginx 从旧 URL 重定向到新 URL

> ID：12339977
> 
> 赞同：2
> 
> 时间：2012-09-09T14:35:11.027
> 
> 标签：redirect, nginx

我们正在为我们的属性搜索切换供应商，并且每个供应商的 URL 格式都略有不同。我们已经将 40,000 多个 URL 编入索引，并希望将用户 301 重定向到新 URL。

URL 的唯一区别是从下划线切换到连字符，以及从 /idx/ 切换到 /property/。

这是旧网址：[http ://www.mysite.com/idx/mls-5028725-10425_virginia_pine_lane_alpharetta_ga_30022](http://www.mysite.com/idx/mls-5028725-10425_virginia_pine_lane_alpharetta_ga_30022)

这是新网址：[http ://www.mysite.com/property/mls-5028725-10425-virginia-pine-lane-alpharetta-ga-30022](http://www.mysite.com/property/mls-5028725-10425-virginia-pine-lane-alpharetta-ga-30022)

任何想法如何在不知道 40,000 多个 URL 中的每一个是什么的情况下重定向所有这些 URL？

谢谢，基思

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T07:49:04.810

一种方法是使用 perl 子例程将下划线更改为连字符。您需要使用 perl 编译 nginx，除非它尚未包含在内。这不是一个完全有效的解决方案，但它可能会让你朝着正确的方向前进：

在 nginx.conf 的 http 部分中添加：

```
perl_modules  perl/lib;
perl_set $fix_uri 'sub {
        use File::Basename;
        my $req = shift;
        my $uri = $req->uri;
        $uri = basename($uri);
        # Do some magic here, probably more elegant than this
        $uri =~ s/idx/property/g;
        $uri =~ s/_/-/g;
        return $uri;
}'; 
```

然后在你可以调用子程序的位置：

```
 location ~ "/idx/(.*" {
            set $redirect_path $fix_uri;
            rewrite . $redirect_path;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T18:16:32.443

我自己更喜欢 ngx_lua 模块。

```
location /idx/ {
    rewrite_by_lua '
        local tempURI, n = ngx.re.gsub(ngx.var.uri, "_", "-")
        local newURI, m = ngx.re.sub(tempURI, "/idx", "/property", "i")
        return ngx.redirect(newURI, ngx.HTTP_MOVED_PERMANENTLY)
    ';
} 
```

第一行 (gsub) 将所有“_”更改为“-”

第二行（子）首先将“/idx”更改为“/property”

第三行很明显

# java - mysql数据库每天使用java代码备份

> ID：12339979
> 
> 赞同：-1
> 
> 时间：2012-09-09T14:35:12.243
> 
> 标签：java

嗨，我们是使用 spring、hibernate 和 mysql 数据库开发的 java web 应用程序。我想每天进行 mysql 数据库备份而不是手动进行我希望它在我们运行程序时自动备份，或者当我们当时设置时间或它应该自动备份的日期..

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T14:46:17.170

不要使用 java - 它是工作的错误工具。

对计划任务使用`cron`(if *nix) 或(if windows)。`at`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:51:23.570

Mysql 有一个带有命令的备份系统。使用 cron 将其自动化。涉及 java 没有任何好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T14:48:18.503

您可以考虑使用[Quartz Scheduler](http://www.quartz-scheduler.org/)。根据其文档：

> Quartz 是一种功能齐全的开源作业调度服务，可以与几乎任何 Java EE 或 Java SE 应用程序...最大的电子商务系统集成或一起使用。
> 
> Quartz 可用于创建简单或复杂的调度，以执行数十、数百甚至数万个作业；任务被定义为标准 Java 组件的作业，这些组件几乎可以执行任何您可以对其编程来执行的操作。Quartz Scheduler 包括许多企业级功能，例如 JTA 事务和集群。

[这是一个](http://www.quartz-scheduler.org/documentation/quartz-2.1.x/examples/Example3)如何使用调度程序和 cron 触发器来调度作业的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T14:38:39.290

**1.**使用 a`Thread`在特定时间或日期运行，这将备份您的数据库...

**2.**或者制作一个Java程序，点击哪个`thread starts`备份你的数据库.....

# opencv - 使用“命令行”输入以及 OpenCV 中显示的图像

> ID：12339986
> 
> 赞同：0
> 
> 时间：2012-09-09T14:36:13.653
> 
> 标签：opencv, computer-vision

这些是 OpenCV 包的分水岭演示中显示的一些“窗口”。

用户和应用程序之间的交互包括一些简单的离散输入字符，我几乎看不到任何类型的命令行输入。

我想让它只是更方便一点的交互。喜欢的东西：

funcA arg1 arg2Enter funcB arg1 ... Enter

“enter”后，运行命令

OpenCV中有类似的东西吗？

![OpenCV的分水岭演示](../Images/1a9bb8aad4fc12ee7ee6e565b3566ee2.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:39:00.187

演示的代码在您的 OpenCV 安装中可用。
你可以随意调整它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T18:33:36.863

您是说要在程序运行时调用程序的函数来处理图像吗？例如，当程序运行时，您调用`watershed(whatever, arguments)`?

我不认为你可以不付出一些努力就做到这一点。我没有尝试过类似的方法，但我想到的是使用单独的线程来获取输入，然后将该输入映射到一个函数。

**编辑：**如果这确实是您正在寻找的，另请参阅[此答案。](https://stackoverflow.com/questions/6171132/non-blocking-console-input-c)

# nsis - 如何制作一个没有窗口的安装程序，在 NSIS 的后台运行

> ID：12339987
> 
> 赞同：0
> 
> 时间：2012-09-09T14:36:22.787
> 
> 标签：nsis

我需要制作一个安装程序来为某个程序提供更新，我需要安装程序在后台运行，这样用户就不会知道它，所以他会知道退出它，

我该怎么办？

谢谢 ：）

* * *

编辑...

* * *

谢谢大家，我找到了答案:)

```
SetSilent silent 
```

在一个部分或一个函数中将解决问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T01:14:20.667

`SetSilent`可以在运行时切换状态，但如果安装程序总是静默，最好使用 SilentInstall 属性：`SilentInstall silent`

# .net - Entity Framework Code First 中的多列键，带有急切加载

> ID：12339999
> 
> 赞同：0
> 
> 时间：2012-09-09T14:38:52.847
> 
> 标签：.net, entity-framework, ef-code-first, many-to-many, dbcontext

我使用实体框架，并且在数据库中用户和框之间存在多对多关系，如下所示：

```
public class HistoryEntry
{
    public int BoxId { get; set; }
    public virtual Box Box { get; set; }

    public int UserId { get; set; }
    public virtual User User { get; set; }

    public int ResultBoxId { get; set; }
    public virtual Box ResultBox { get; set; }
} 
```

这个“HistoryEntries”表的键是一个多列键：它由 BoxId 和 UserId 组成：

```
 modelBuilder.Entity<HistoryEntry>().HasKey(entry =>
            new
            {
                BoxId = entry.BoxId,
                UserId = entry.UserId
            }); 
```

但是，我想关闭延迟加载和代理创建，因为我会将每个查询都用于急切加载。

如何以“渴望加载”的方式重写我的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T15:48:49.857

使用该`Include`方法预先加载导航属性。

```
var users = context.User.Include(u => u.HistoryEntries.Select(h => h.Box))
      .Where(/* */); 
```