# StackOverflow 问答 000174000-000174999

# apache-flex - 如何在 Flex 中格式化货币数据字段

> ID：174005
> 
> 赞同：3
> 
> 时间：2008-10-06T11:58:10.030
> 
> 标签：apache-flex, datagrid, currency, formatter

我有一个 xml 文件，为 Flex 2 中的数据网格提供数据，其中包括一个未格式化的价格字段（即：它只是一个数字）。谁能告诉我如何获取该数据字段并对其进行格式化-添加货币符号，放入千位分隔符等。谢谢。S。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T22:12:05.703

非常感谢您的回答...他们帮助很大。

最后，我找到了一个涉及以下三个要素的解决方案：

```
<mx:DataGridColumn headerText="Price" textAlign="right"  labelFunction="formatCcy" width="60"/>

public function formatCcy(item:Object, column:DataGridColumn):String
        {
         return euroPrice.format(item.price);
        }

<mx:CurrencyFormatter id="euroPrice" precision="0" 
    rounding="none"
    decimalSeparatorTo="."
    thousandsSeparatorTo=","
    useThousandsSeparator="true"
    useNegativeSign="true"
    currencySymbol="€"
    alignSymbol="left"/> 
```

我不知道这是否是正确的解决方案，但它似乎工作（目前），再次感谢，S ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T14:50:49.183

如上所述，一种简单的方法是将 labelFunction 添加到指定列并格式化其中的数据。

我经常发现使用对象比直接使用 XML 更容易，所以通常如果我从函数接收 XML，我会为该 XML 创建一个对象和解析器，如果你愿意，你也可以在解析器中格式化数据。

另一种处理方法是在 itemRenderer 中。例子：

```
<mx:DataGridColumn id="dgc" headerText="Money" editable="false">
    <mx:itemRenderer>
      <mx:Component>
         <mx:HBox horizontalAlign="right">
        <mx:CurrencyFormatter id="cFormat" precision="2" currencySymbol="$" useThousandsSeparator="true"/>
            <mx:Label id="lbl" text="{cFormat.format(data)}" />
         </mx:HBox>
      </mx:Component>
    </mx:itemRenderer>
</mx:DataGridColumn> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T12:22:07.440

CurrencyFormatter 类怎么样

有关 Flex 2 的文档，请参见[此处](http://livedocs.adobe.com/flex/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001087.html)。它非常易于使用。

您可以在 DataGrid 列上的 labelFunction 中使用其中之一来格式化您的数字。

# javascript - 是否值得将我的函数式 JavaScript 代码转换为面向对象的设计？

> ID：174008
> 
> 赞同：7
> 
> 时间：2008-10-06T12:00:47.513
> 
> 标签：javascript, software-design, web-applications

我目前正在构建一个包含大量 JavaScript 的小型 Web 应用程序。当我对最初的想法进行原型设计时，我只是将几个函数拼凑在一起，以展示应用程序最终将如何表现，并打算继续以面向对象的性质重新编写 JavaScript。

现在我进入了实现阶段，我发现为了面向对象而创建面向对象的 JavaScript 似乎有些矫枉过正——该项目未来不太可能需要进行任何重大修改，以保证和面向对象的设计。相反，我发现一组简洁、有凝聚力的函数运行良好。

那么，话虽如此，并试图坚持 KISS 原则，当一组函数为问题提供合适的解决方案时，是否还有其他理由值得考虑将我的代码转换为面向对象的设计？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T12:05:12.810

不，虽然我个人觉得 OOP 更好吃，但它是达到目的的一种手段，而不是目的本身。在许多情况下，过程编程比 OOP 更有意义，如您所说，为了转换而进行转换可能是矫枉过正。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-06T12:02:15.047

不，顺其自然，继续前进——在我看来，这样更有成效。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-06T12:13:46.707

如果您的代码结构良好、布局合理、注释完善，并且完成了所需的工作，那么除了添加功能之外，出于任何其他原因弄乱它是不明智的。

虽然说该程序非常适合 OOP 等可能会很好，但如果不需要更改它即可工作，那么我肯定会保持原样。

如果它没有坏，不要烦躁:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T13:07:46.740

如果此代码已经实现并且不需要维护或 - 更好的是 - 升级，请坚持使用它。如果您现在要实现它并且它可能会变得复杂，请考虑 OO 方法。

经验告诉我，在复杂性较低的情况下编写和维护过程代码非常容易，但是在一定的阈值之后，在使用过程编程时，增加复杂性的难度开始呈指数级增长，而 OOP 虽然更难开始，但保持复杂性要高得多可管理。

**底线：**如果任务足够简单或已经实施，请保持简单。如果它可能变得更复杂，请考虑 OOP。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T13:39:29.967

我会说在做出决定之前仍然值得审查您的代码。“重写”代码的明显缺点是需要测试成本来确保您的代码与以前一样工作。你有任何单元测试吗？如果没有，那么您的测试成本会更高。所以总的来说，我反对重写工作代码，除非它服务于另一个目的，这是为了让你更容易地编写现在需要的新功能（即重构常用功能等）

但是，任何时候有人说“我一起黑了”，我建议总是值得再看看你的代码。为什么它首先被黑客攻击在一起？我知道很多人说面向对象的代码本身并不是目的，但它是一种方法，之后也不必考虑。你只是自然而然地开始这样做。

也许您的 js 相对简单，因此 OO 脚手架确实是额外的开销。美好的。但我仍然建议您始终对您称为“被黑”的任何代码进行代码审查（尤其是让其他人审查）。也许这是弗洛伊德的失误……但它确实失误了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T12:18:42.593

从现在开始将其视为遗留代码。当您想更改某些内容时，请对其进行重构，以便代码在头脑中变得更容易。如果您需要一点 OOP，请使用它。如果你不这样做，不要。

OOP 是一把锤子，请不要把螺丝问题当作钉子。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T12:22:21.073

如果它有效，并且易于维护，我不会为了转换而费心转换它。一定有更多有趣的事情要做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T13:30:41.403

请记住，在 javascript 中创建对象相当昂贵。

将对象的构造保持在最低限度。

# c++ - 链接器内存不足 LNK1102

> ID：174013
> 
> 赞同：13
> 
> 时间：2008-10-06T12:03:02.733
> 
> 标签：c++, windows, visual-studio, linker

我和我的同事尝试构建一个包含数千个类的项目，但我们遇到了 LNK1102 错误（链接器内存不足）。我在网上看到了一些技巧，比如增加虚拟内存。我们试过了，但这没有帮助。我们还看到一些在编译代码时启用了不同的警告级别。一个人建议为警告启用 4 级。那怎么可能呢？还有其他建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-12-06T13:24:32.310

我在编译纯 C 时遇到了同样的问题：

```
"*LINK : fatal error LNK1102: out of memory*" 
```

我的解决方案是：删除所有 *.pdb (DEBUG) 文件。在那之后，一切都毫无问题地联系在一起。因此，在我的情况下，pdb 文件可能是缺陷 - 以一种有趣的方式缺陷导致此链接器错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-09-09T05:36:31.113

项目（右键）→属性→配置属性→链接器→优化→引用→更改为**保留未引用的数据**

在我的机器上工作！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T10:29:16.157

我怀疑链接器也需要很长时间才能完成。既然你说有数千个 c++ 类，我的第一个想法是检查是否有很多内联类方法。

尝试这个：

选择一堆使用最多的类，通过将所有内联方法从头文件移动到实现文件来使它们成为非内联方法。我经历了链接时间的巨大变化。我们的一个项目从 15 分钟的纯链接时间缩短到了 30 秒。这也应该影响链接过程的内存。

祝你好运！//马格纳斯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T12:09:04.843

如果项目太大，则将其拆分为几个组件。

这也可能有助于维护。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T12:10:38.117

如果您在 Windows 机器上运行此程序，请在链接时打开任务管理器并转到性能页面。如果您看到页面文件的使用量一直在增加，那么请将其大小增加到至少两倍您的内存。如果页面文件在引发错误之前没有填满，请确保机器上有足够的磁盘空间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-19T19:45:19.190

如果使用 Visual C++ 6.0，请避免从“subst”驱动器或“网络映射”驱动器加载工作区。将项目复制到“C:\temp\MyProject\”文件夹，并从该位置加载工作区，这次“LNK1102”错误对我来说消失了。

希望能帮助到你！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-10-04T20:05:14.583

我遇到了这个`fatal error LNK1102: out of memory`错误，并通过[使用 64bits compiler 和 linker](https://support.microsoft.com/en-gb/help/2891057/linker-fatal-error-lnk1102-out-of-memory)解决了它。您设置一个环境变量：

```
set PreferredToolArchitecture=x64 
```

然后运行 ​​Visual Studio。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T14:24:42.433

运行 64 位版本的链接器？缺点：你会得到一个 amd64 可执行文件。（与 32->64 交叉编译工具集不同，没有 64->32 位工具集）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-09T01:51:57.693

链接时通过任务管理器绝对监控实际内存使用情况。如果可能，关闭其他程序以增加可用物理内存并将页面文件的大小设置为 4092 mb。

此外，它可能有助于创建[链接 repro](https://support.microsoft.com/en-us/kb/134650)。这将允许其他人尝试在其他机器上重现您的链接问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-12T09:43:57.850

在 VS 2008 中增量构建大型项目时，我遇到了同样的错误。我刚刚清理了项目，删除了所有 *.ilk、*.dll、*.exe 和 *.pdb 文件并重新构建。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-08-12T13:24:28.117

[这里](https://support.microsoft.com/en-gb/help/2891057/linker-fatal-error-lnk1102-out-of-memory)多次提到的解决方案是使用 64 位主机编译器工具。

对于 CMake 生成的项目，这可以通过将变量设置[`CMAKE_GENERATOR_TOOLSET`](https://cmake.org/cmake/help/v3.15/variable/CMAKE_GENERATOR_TOOLSET.html)为 value来实现`host=x64`，无论是在`CMakeLists.txt`：

```
set(CMAKE_GENERATOR_TOOLSET "host=x64") 
```

或在 cmake 命令行上添加

```
-T host=x64 
```

**注意**：此设置仅适用于 Visual Studio 生成器。对于任何其他生成器，它将导致致命错误。

# java - 方法签名中的对象数组

> ID：174024
> 
> 赞同：5
> 
> 时间：2008-10-06T12:08:02.710
> 
> 标签：java, arrays, methods

考虑以下方法签名：

```
public fooMethod (Foo[] foos) { /*...*/ } 
```

和

```
public fooMethod (Foo... foos) { /*...*/ } 
```

*解释：前者接受一个 Foo 对象数组作为参数 - `fooMethod(new Foo[]{..})`- 而后者接受任意数量的 Foo 类型参数，并将它们呈现为方法内的 Foo:s 数组 - `fooMethod(fooObject1, fooObject2, etc...`)。*

如果两者都被定义，Java 会抛出一个 fit，声称它们是重复的方法。我做了一些侦探工作，发现第一个声明确实需要一个显式的 Foo 对象数组，这是调用该方法的唯一方法。第二种方式实际上既接受任意数量的 Foo 参数，也接受一个 Foo 对象数组。

所以，问题是，由于后一种方法似乎更灵活，是否有任何理由使用第一个示例，或者我错过了什么重要的东西？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T12:11:57.600

这些方法其实都是一样的。

此功能称为可变参数，它是一个编译器功能。幕后是翻译成以前的版本。

如果您定义了一个接受 Object... 的方法并且您发送了一个 Object[] 类型的参数，则会有一个陷阱！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T12:25:06.560

我想补充 Shimi 的解释，以补充 varargs 语法的另一个限制是 vararg 必须是最后声明的参数。所以你不能这样做：

```
void myMethod(String... values, int num); 
```

这意味着任何给定的方法只能有一个可变参数。如果你想传递多个数组，你可以只对其中一个使用可变参数。

在实践中，当您将参数视为任意数量的不同值而不是数组时，可变参数处于最佳状态。Java5 将它们映射到一个数组只是因为这是最方便的做法。

一个很好的例子是 String.format()。在这里，可变参数与第一个参数中的格式占位符匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T12:10:56.807

后者是在 Java 5 中引入的，并且现有的库正在逐渐被重新设计以支持它。您可能仍会使用前者来强调该方法需要 2+ 个输入，而且 ... 可以使用的位置存在限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T12:22:43.193

当然没有性能问题或类似的事情需要考虑，所以它归结为语义。

您是否希望您的方法的调用者手头有一个 Foo 数组？然后使用 Foo[] 版本。使用 varargs 变体来强调使用 Foo 的“一堆”而不是数组的可能性。

varargs 的经典示例是字符串格式（在 C# 中，不知道它在 Java 中是如何调用的）：

```
string Format(string formatString, object... args) 
```

在这里，您希望 args 具有不同的类型，因此拥有一组参数将非常不常用，因此使用 varargs 变体。

另一方面，像

```
string Join(string[] substrings, char concatenationCharacter) 
```

使用数组是完全合理的。

另请注意，您可以在参数列表的末尾有多个数组参数和一个可变参数参数。

# javascript - 你如何从 Flash 触发 javascript 函数？

> ID：174025
> 
> 赞同：9
> 
> 时间：2008-10-06T12:08:24.020
> 
> 标签：javascript, jquery, flash, actionscript, function

如何在 flash 中使用 actionscript 触发 javascript 函数？

目标是从 Flash 电影中触发 jQuery 功能

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-06T12:11:05.433

看看[ExternalInterface](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html) -Class。
来自 AS3 语言参考：

> ExternalInterface 类是 External API，它是一个应用程序编程接口，可以在 ActionScript 和 Flash Player 容器（例如，带有 JavaScript 的 HTML 页面）之间进行直接通信。Adobe 建议对所有 JavaScript-ActionScript 通信使用 ExternalInterface。

它是这样工作的：

```
ExternalInterface.addCallback("sendToActionScript", receivedFromJavaScript);
ExternalInterface.call("sendToJavaScript", input.text); 
```

您可以提交参数并接收回调......很酷，对吧？;)

据我所知，它也适用于 AS2 ......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T12:28:00.063

正如 Jochen 所说，ExternalInterface 是要走的路，我可以确认它适用于 AS2。

如果您打算触发导航或影响闪光灯所在区域的任何内容，请不要直接从您从闪光灯调用的函数中执行此操作。Flash 期望它调用的函数有一个返回值，如果函数完成时 Flash 对象不存在，则 Flash 插件将崩溃。

如果您需要导航或更改内容，您可以添加一个 setTimeout 调用（到您的 js 函数中）。这将创建一个新线程并为 flash 提供它期望的返回值。

# c# - 您建议将哪个数据库与 C# (.NET) 应用程序一起使用？

> ID：174059
> 
> 赞同：8
> 
> 时间：2008-10-06T12:22:25.287
> 
> 标签：c#, .net, database, local

我正在制定一个小项目计划，当我需要决定使用什么本地数据库系统时，我发现了这一点。

输入数据将存储在网络服务器（托管 - MySQL DB）上。这个想法是建立一个流程来下载所有必要的数据（例如在午夜）并处理它们。但是，会有很多输入和处理阶段，所以我需要使用某种本地数据库来存储应用程序的半产品

您建议使用哪种本地数据库系统来使用 C# (.NET) 应用程序？

编辑：最终产品（信息）应该很容易被导出回 Hosting MySQL DB。

正如威尔在他的回答中提到的那样——是的，我追求的是性能和使用的舒适度。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-06T12:28:40.733

我想说的是 Microsoft Sql 2005 Express，因为它（几乎）是在 .NET 中开发时的明显选择。

但这一切都取决于您以前拥有的数据库技能。如果您已经知道 MySql 并且正如您已经说过的，则应将数据导出回 MySql。为什么不一直使用MySql？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-06T12:30:08.703

为了快速和肮脏，我会选择[Sql Server Compact Edition。](http://www.microsoft.com/sql/editions/compact/default.mspx) 它是 Sql Server 的进程内实现，因此不需要您安装任何其他应用程序。

过去，您会使用 Access 数据库来处理这类事情。但是Access数据库有点打击。

将完成的数据上传回生产服务器并不需要太多。如果您正在寻找自动化该过程的解决方案，您可能需要考虑在本地托管 MySql 实例并使用它提供的任何复制服务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T13:01:53.100

我说使用 Sql Server Compact Edition。它与 SQL Server 的完整版本非常相似，并且 VS2008 内置了对设计表、查询等的支持（Management Studio 2008 也支持它）。最大的缺点是你失去了存储过程，但好处是很大的，因为不需要在本地用户机器上安装任何东西，而且它在选择数据方面工作得非常快。更酷的是，使用 SQL Metal，您可以像使用 Sql Server 一样创建 DBML 文件并使用 LINQ。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T12:49:32.110

使用 db4o 怎么样？这是一个可以嵌入到应用程序中的 OODB。还支持[复制](http://www.db4o.com/about/productinformation/drs/)。编辑：作为旁注 - 在我当前使用 db4o 的宠物项目中，我有一行（C# 3.5）：

```
IList<Users> list = Persistence.Database.Query<Users>(u => u.Name == "Admin"); 
```

使用强类型 lambda 表达式从数据库中获取（惰性）对象列表。它还使用索引来快速检索列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T12:23:25.720

MS SQL Server 支持开箱即用，无需任何其他驱动程序或设置。此外，MS SQL Server Express 是免费的。

您可以生成将数据导出到/从 MySQL 的脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T12:32:10.290

“显而易见”的选择是 MS SQL Server Express。VS 和 .net 本身都支持它，如果您已经使用过它（对于主数据库），我当然会很想坚持使用它（或其快速版本）。

但这肯定不是您选择的终点。我经常将 SQLite 用于跨平台应用程序和 Web 应用程序。[它的速度快得令人瞠目结舌，而且它确实通过System.Data.SQLite](http://sqlite.phxsoftware.com/)很好地集成了——尽管不像 MS SQL Server 那样紧密。

还有一个紧凑版的 SQL Server，与 SQLite 相比非常好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T12:59:09.407

我不知道一个与 MySQL 完全语法和类型兼容的好的进程内数据库。考虑到这一点，您有三个选择：

1.  选择 SQLlite、Access 或 SQL Server Compact 之类的东西。问题是您最终将使用其中任何一个编写一些复杂的转换逻辑，并且必须将所有查询编写两次。
2.  在本地安装 MySQL。然后，您必须忍受在本地系统上运行完整的数据库服务器。对于要运送给客户的任何东西，您肯定希望避免这种情况，但对于您自己的使用，它可能没问题。幸运的是，MySQL 不像其他一些现代数据库服务器那样使用那么多资源，但这仍然不够理想。
3.  在服务器上切换到 SQL Server Express 版本并在客户端使用 SQL Server Compact。它和 MySQL 一样便宜（甚至可能更便宜，因为您应该购买 MySQL 用于任何商业用途）。考虑到您在客户端使用 C#，您可能还希望在服务器端将其与 ASP.Net 一起使用。如果您使用的是 ASP.Net 服务器端，那么不难找到提供 SQL Server Express 的主机。现在您的数据库是类型兼容的，并且您为客户端编写的任何查询都可以保证也适用于您的服务器。

IMO，MS 数据库堆栈（不包括访问权限）的一大优势是，无论您在做什么，从桌面到多数据中心集群，它们都有一个兼容的解决方案。如果您的应用程序的规模发生变化，或者您需要在两个不同类别的应用程序之间传送数据，您的数据库层就会得到处理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T13:39:52.447

选择任何可用的东西，但只针对接口编写代码，这样您就可以轻松地在它们之间切换。

对于生产，我会说大型项目的 MS SQL（或中级项目的表达）仅仅是因为与 VS 和 Sqlite 的紧密集成用于小型项目。

鉴于描述，我认为 Sqlite 将是一个不错的选择，因为它是最简单/最低的开销。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T14:00:45.773

我最近一直在做一些测试，虽然我也推荐 SQL Server 2005（如果需要的话是 Express），因为它开箱即用，尽管 SQL Server 2008 是新的并且现在是 RTM。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T14:39:14.463

SQL Server 正如大多数人所提到的......我的原因是因为你可以使用源代码控制将测试用例从 C# 集成到数据库......

Team Foundation (TFS) 就是来自 Microsoft 的一种 GUI...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-06T15:01:49.863

因为这已经回答了。我必须提到，在使用 CLR 语言时，CLR/.NET Framework 集成将 MS SQL Server 2005/2008 与其他语言区分开来。以下摘录自[这里](http://www.microsoft.com/sql/prodinfo/overview/whats-new-in-sqlserver2005.mspx)。

> 通过使用 Visual Basic .NET 和 C# 等语言，您可以利用 CLR 集成来编写逻辑更复杂且更适合计算任务的代码。此外，Visual Basic .NET 和 C# 提供了面向对象的功能，例如封装、继承和多态性。您可以轻松地将相关代码组织到类和命名空间中，这意味着您在处理大量代码时可以更轻松地组织和维护代码投资。将代码在逻辑上和物理上组织到程序集和命名空间中的能力是一个巨大的好处，它使您能够更好地查找和关联大型数据库实现中的不同代码段。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-10-06T12:36:06.897

对于您所描述的，绝对是 MS SQL Server。性能好，工具好。自由。

# linux - 在linux中添加一个新的应用程序组

> ID：174069
> 
> 赞同：1
> 
> 时间：2008-10-06T12:25:32.720
> 
> 标签：linux, ubuntu, installation, menu

在 Java 或其他编程语言中，如何在 KDE 和 Gnome 的应用程序菜单中添加新程序组？

我正在使用 Ubuntu 和 Kubuntu 8 进行测试。在 ~/.config/menus/applications-merged 中放置一个简单的 .menu 文件在 Kubuntu 中有效，但相同的过程在 Ubuntu 中没有任何作用。

我的文件内容如下：

```
<!DOCTYPE Menu PUBLIC "-//freedesktop//DTD Menu 1.0//EN" "http://www.freedesktop.org/standards/menu-spec/1.0/menu.dtd">
<Menu>
<Menu>
  <Name>My Program Group</Name>
  <Include>
   <Filename>shortcut.desktop</Filename>
  </Include>
</Menu>
</Menu> 
```

请注意，.desktop 文件正确放置在 ~/.local/share/applications 中。

Ps：最初的问题没有指定我想要以编程方式解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T12:35:47.037

也许 xdg-desktop-menu 可以做到这一点？请参阅`man xdg-desktop-menu`或[http://manpages.ubuntu.com/manpages/hardy/en/man1/xdg-desktop-menu.html](http://manpages.ubuntu.com/manpages/hardy/en/man1/xdg-desktop-menu.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T16:54:16.657

谢谢，奥利弗。我使用了 xdg-desktop-menu，然后分析了它的输出。正确的菜单文件需要显式命名外层菜单（Applications），如下：

```
<!DOCTYPE Menu PUBLIC "-//freedesktop//DTD Menu 1.0//EN" 
    "http://www.freedesktop.org/standards/menu-spec/menu-1.0.dtd">
<Menu>
    <Name>Applications</Name>
<Menu>
    <Name>My Program Group</Name>
    <Include>
        <Filename>shortcut.desktop</Filename>
    </Include>
</Menu>
</Menu> 
```

这在 Kubuntu、Ubuntu 和 Fedora Core 9 中运行良好。但无法在 openSUSE 上运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T20:56:03.017

我建议您查看涵盖此内容的 freedesktop.org 标准。最新列表可在此处获得：

[http://www.freedesktop.org/wiki/Specifications/menu-spec](http://www.freedesktop.org/wiki/Specifications/menu-spec)

目前最新的是1.0：

[http://standards.freedesktop.org/menu-spec/1.0/](http://standards.freedesktop.org/menu-spec/1.0/)

Gnome、KDE ​​和 XFCE 遵循 FreeDesktop.org 标准，因此它应该适用于任何发行版。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T12:32:47.433

在 Gnome 中使用 System -> Settings -> Menu 然后选择 New Menu 或 New Entry。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T16:52:00.437

不确定“在 openSUSE 中 .directory 文件是强制性的，否则程序组不会显示”的确切含义；通常我认为您必须调用 xdg-desktop-menu 两次（一次用于程序组，一次用于程序本身），因此您还必须提供两个不同的 .directory 文件。如果程序组为空，则桌面将其隐藏是有道理的。

（但也许我在这里完全误解了你:-)而且我自己从来没有使用过 xdg-desktop-menu ）。

# java - .toArray(new MyClass[0]) 还是 .toArray(new MyClass[myList.size()])？

> ID：174093
> 
> 赞同：205
> 
> 时间：2008-10-06T12:38:00.417
> 
> 标签：java, performance, coding-style

假设我有一个 ArrayList

```
ArrayList<MyClass> myList; 
```

我想调用toArray，是否有性能原因使用

```
MyClass[] arr = myList.toArray(new MyClass[myList.size()]); 
```

超过

```
MyClass[] arr = myList.toArray(new MyClass[0]); 
```

?

我更喜欢第二种风格，因为它不那么冗长，而且我假设编译器会确保不会真正创建空数组，但我一直想知道这是不是真的。

当然，在 99% 的情况下，它不会以某种方式产生影响，但我想在我的正常代码和优化的内部循环之间保持一致的风格......

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2015-04-04T09:05:26.537

与直觉相反，Hotspot 8 上最快的版本是：

```
MyClass[] arr = myList.toArray(new MyClass[0]); 
```

我已经使用 jmh 运行了一个微型基准测试，结果和代码如下，表明具有空数组的版本始终优于具有预定义数组的版本。请注意，如果您可以重用正确大小的现有数组，结果可能会有所不同。

基准测试结果（分数以微秒为单位，更小 = 更好）：

```
Benchmark                      (n)  Mode  Samples    Score   Error  Units
c.a.p.SO29378922.preSize         1  avgt       30    0.025 ▒ 0.001  us/op
c.a.p.SO29378922.preSize       100  avgt       30    0.155 ▒ 0.004  us/op
c.a.p.SO29378922.preSize      1000  avgt       30    1.512 ▒ 0.031  us/op
c.a.p.SO29378922.preSize      5000  avgt       30    6.884 ▒ 0.130  us/op
c.a.p.SO29378922.preSize     10000  avgt       30   13.147 ▒ 0.199  us/op
c.a.p.SO29378922.preSize    100000  avgt       30  159.977 ▒ 5.292  us/op
c.a.p.SO29378922.resize          1  avgt       30    0.019 ▒ 0.000  us/op
c.a.p.SO29378922.resize        100  avgt       30    0.133 ▒ 0.003  us/op
c.a.p.SO29378922.resize       1000  avgt       30    1.075 ▒ 0.022  us/op
c.a.p.SO29378922.resize       5000  avgt       30    5.318 ▒ 0.121  us/op
c.a.p.SO29378922.resize      10000  avgt       30   10.652 ▒ 0.227  us/op
c.a.p.SO29378922.resize     100000  avgt       30  139.692 ▒ 8.957  us/op 
```

* * *

供参考，代码：

```
@State(Scope.Thread)
@BenchmarkMode(Mode.AverageTime)
public class SO29378922 {
  @Param({"1", "100", "1000", "5000", "10000", "100000"}) int n;
  private final List<Integer> list = new ArrayList<>();
  @Setup public void populateList() {
    for (int i = 0; i < n; i++) list.add(0);
  }
  @Benchmark public Integer[] preSize() {
    return list.toArray(new Integer[n]);
  }
  @Benchmark public Integer[] resize() {
    return list.toArray(new Integer[0]);
  }
} 
```

* * *

[*您可以在博文 Arrays of Wisdom of the Ancients*](https://shipilev.net/blog/2016/arrays-wisdom-ancients/)中找到类似的结果、完整的分析和讨论。总结一下：JVM 和 JIT 编译器包含一些优化，使其能够廉价地创建和初始化一个新的大小正确的数组，如果您自己创建数组，则无法使用这些优化。

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2008-10-06T12:57:28.773

从[Java 5 中的 ArrayList](http://java.sun.com/j2se/1.5.0/docs/api/java/util/ArrayList.html#toArray(T[]))开始，如果数组具有正确的大小（或更大），它将已经被填充。最后

```
MyClass[] arr = myList.toArray(new MyClass[myList.size()]); 
```

将创建一个数组对象，填充它并将其返回给“arr”。另一方面

```
MyClass[] arr = myList.toArray(new MyClass[0]); 
```

将创建两个数组。第二个是长度为 0 的 MyClass 数组。因此，会为将立即丢弃的对象创建对象。就源代码而言，编译器/JIT 无法优化这个，因此它不会被创建。此外，使用零长度对象会导致在 toArray() - 方法中进行强制转换。

查看 ArrayList.toArray() 的来源：

```
public <T> T[] toArray(T[] a) {
    if (a.length < size)
        // Make a new array of a's runtime type, but my contents:
        return (T[]) Arrays.copyOf(elementData, size, a.getClass());
    System.arraycopy(elementData, 0, a, 0, size);
    if (a.length > size)
        a[size] = null;
    return a;
} 
```

使用第一种方法，以便只创建一个对象并避免（隐式但昂贵的）强制转换。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2018-06-07T09:41:52.163

*来自 JetBrains Intellij Idea 检查：*

> 将集合转换为数组有两种方式：使用预先确定大小的数组（如**c.toArray(new String[c.size()])**或使用空数组（如**c.toArray(new String[ 0])**。
> 
> 在较旧的 Java 版本中，建议使用预先确定大小的数组，因为创建适当大小的数组所必需的反射调用非常慢。然而，由于 OpenJDK 6 的更新较晚，这个调用被内化了，使得空数组版本的性能与预先调整大小的版本相同，有时甚至更好。此外，传递预先确定大小的数组对于并发或同步集合也是危险的，因为在 **size**和**toArray** 调用之间可能存在数据竞争，如果在操作期间集合同时收缩，这可能会导致数组末尾出现额外的空值。
> 
> This inspection allows to follow the uniform style: either using an empty array (which is recommended in modern Java) or using a pre-sized array (which might be faster in older Java versions or non-HotSpot based JVMs).

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-10-06T13:17:25.830

现代 JVM 在这种情况下优化了反射数组的构造，因此性能差异很小。在这样的样板代码中将集合命名两次并不是一个好主意，所以我会避免使用第一种方法。第二个的另一个优点是它适用于同步和并发集合。如果要进行优化，请重用空数组（空数组是不可变的并且可以共享），或者使用分析器（！）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T12:46:40.103

toArray 检查传递的数组的大小是否正确（即，大到足以容纳列表中的元素），如果是，则使用它。因此，如果数组的大小比要求的小，则将自反地创建一个新数组。

在您的情况下，大小为零的数组是不可变的，因此可以安全地提升为静态最终变量，这可能会使您的代码更简洁，从而避免在每次调用时创建数组。无论如何，都会在方法内部创建一个新数组，因此这是一个可读性优化。

可以说，更快的版本是传递正确大小的数组，但除非您能*证明*此代码是性能瓶颈，否则在证明并非如此之前，更喜欢可读性而不是运行时性能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T12:44:46.393

第一种情况效率更高。

那是因为在第二种情况下：

```
MyClass[] arr = myList.toArray(new MyClass[0]); 
```

运行时实际上创建了一个空数组（大小为零），然后在 toArray 方法中创建另一个数组以适应实际数据。使用以下代码（取自 jdk1.5.0_10）使用反射完成此创建：

```
public <T> T[] toArray(T[] a) {
    if (a.length < size)
        a = (T[])java.lang.reflect.Array.
    newInstance(a.getClass().getComponentType(), size);
System.arraycopy(elementData, 0, a, 0, size);
    if (a.length > size)
        a[size] = null;
    return a;
} 
```

通过使用第一种形式，您可以避免创建第二个数组，也可以避免反射代码。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-08-20T00:36:42.027

第二个可读性稍强，但改进很小，不值得。第一种方法更快，在运行时没有缺点，所以这就是我使用的。但我是用第二种方式写的，因为这样打字更快。然后我的 IDE 将其标记为警告并提供修复它。只需一次击键，它将代码从第二种类型转换为第一种。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-10-06T12:43:58.847

将“toArray”与正确大小的数组一起使用会更好，因为替代方案将首先创建零大小的数组，然后创建正确大小的数组。但是，正如您所说，差异可能可以忽略不计。

另外，请注意 javac 编译器不执行任何优化。如今，所有优化都是由 JIT/HotSpot 编译器在运行时执行的。我不知道任何 JVM 中围绕“toArray”的任何优化。

那么，您的问题的答案主要是风格问题，但为了保持一致性，应该成为您遵守的任何编码标准的一部分（无论是记录还是其他）。

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2013-08-03T10:21:47.523

整数示例代码：

```
Integer[] arr = myList.toArray(new integer[0]); 
```

# architecture - 扩展应用程序

> ID：174106
> 
> 赞同：4
> 
> 时间：2008-10-06T12:44:12.120
> 
> 标签：architecture, distribution

我有一个需要扩展的应用程序（IP 会议服务）。它有很多独立的组件/应用程序，用不同的语言（主要是 C++ 和 PHP，一些 Perl）编写。目前，单个安装在 5 台机器上运行，1-2 个组件共享一个盒子。因此每个盒子的配置都是不同的，所以扩展整个东西是一件痛苦的事，更不用说维护了。

各个组件从媒体代理到消息代理和数据库各不相同，因此负载几乎是平衡的。

我正在考虑将所有组件放在一台机器上并添加更多盒子，同时在前面添加某种负载均衡器。其他人建议我以另一种方式扩展——在应用程序负载变高的地方添加专门的盒子——但这又导致了维护的噩梦。

你知道我应该从哪里开始的资源吗？理想情况下，我需要一些基准，哪种方法在性能方面更好？（大声思考，当我有 X 量的负载和 Y 量的内存和处理能力时，我如何分配它有什么关系？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T12:50:41.377

我会去虚拟化。这样，您可以拥有各种类似的配置机器，并根据需要在它们之间分配负载，即使您将模块保存在单独的 VM 中也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T12:54:14.177

您需要确定最高负载或瓶颈在哪里，否则很难正确规划。

我会再看一下虚拟化。它使您的应用程序： 快速部署 易于备份 发生故障时快速恢复

# unix - 为什么shell脚本比较经常使用x$VAR = xyes？

> ID：174119
> 
> 赞同：81
> 
> 时间：2008-10-06T12:50:21.343
> 
> 标签：unix, shell, autotools

我经常在使用自动工具（autoconf、automake）的项目的构建脚本中看到这一点。当有人想要检查 shell 变量的值时，他们经常使用这个成语：

```
if test "x$SHELL_VAR" = "xyes"; then
... 
```

与简单地检查这样的值相比，这样做有什么好处：

```
if test $SHELL_VAR = "yes"; then
... 
```

我想我经常看到这个肯定是有原因的，但我不知道它是什么。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2008-10-06T13:29:01.000

如果您使用的 shell 执行*简单*替换并且`SHELL_VAR`变量不存在（或为空白），那么您需要注意边缘情况。将发生以下翻译：

```
if test $SHELL_VAR = yes; then        -->  if test = yes; then
if test x$SHELL_VAR = xyes; then      -->  if test x = xyes; then 
```

其中第一个将产生一个错误，因为第一个参数 to`test`已经丢失。第二个没有这个问题。

您的案例翻译如下：

```
if test "x$SHELL_VAR" = "xyes"; then  -->  if test "x" = "xyes"; then 
```

`x`至少对于 POSIX 兼容的 shell，实际上是多余的，因为引号会导致空参数和包含空格的参数都被解释为单个对象。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-07T22:00:01.173

其他人尚未提及的另一个原因与期权处理有关。如果你写：

```
if [ "$1" = "abc" ]; then ... 
```

并且 $1 的值为 '-n'，测试命令的语法不明确；目前尚不清楚您在测试什么。前面的“x”可防止前导破折号造成麻烦。

您必须查看真正古老的 shell 才能找到 test 命令不支持`-n`or的 shell `-z`；版本 7 (1978)`test`命令包括了它们。这并不是完全无关紧要的——一些版本 6 的 UNIX 东西逃到了 BSD 中，但是现在，你很难找到当前使用的任何古老的东西。

正如许多其他人指出的那样，不在值周围使用双引号是危险的。确实，如果文件名有可能包含空格（MacOS X 和 Windows 在某种程度上都鼓励这样做，而 Unix 一直支持它，尽管像这样的工具`xargs`让它更难），那么每次使用文件名时也应该用双引号括起来。除非您负责该值（例如，在选项处理期间，并且您在启动时将变量设置为“否”，当命令行中包含标志时设置为“是”），否则使用不带引号的变量形式是不安全的直到你证明它们是安全的——你也可以为了许多目的一直这样做。或者记录如果用户尝试处理名称中包含空格的文件，您的脚本将严重失败。（还有其他字符也需要担心——例如，反引号也可能相当讨厌。）

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-06T13:41:06.670

我知道这个约定有两个原因：

[http://tldp.org/LDP/abs/html/comparison-ops.html](http://tldp.org/LDP/abs/html/comparison-ops.html)

> 在复合测试中，即使引用字符串变量也可能不够。[ -n "$string" -o "$a" = "$b" ] 如果 $string 为空，某些版本的 Bash 可能会导致错误。安全的方法是在可能为空的变量上附加一个额外的字符， [ "x$string" != x -o "x$a" = "x$b" ] （“x's” 取消）。

其次，在除 Bash 之外的其他 shell 中，尤其是较旧的 shell 中，不存在诸如“-z”之类的用于测试空变量的测试条件，所以虽然这样：

```
if [ -z "$SOME_VAR" ]; then
  echo "this variable is not defined"
fi 
```

在 BASH 中可以正常工作，如果您的目标是在各种 UNIX 环境中实现可移植性，在这些环境中您无法确定默认 shell 是否为 Bash 以及它是否支持 -z 测试条件，使用 if [ " 格式会更安全x$SOME_VAR" = "x" ] 因为这将始终具有预期的效果。本质上，这是一个用于查找空变量的旧 shell 脚本技巧，尽管有更简洁的方法可用，但它今天仍然用于向后兼容。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-06-30T05:04:47.263

我建议改为：

```
if test "yes" = "$SHELL_VAR"; then 
```

因为它消除了丑陋的`x`，并且仍然解决了[https://stackoverflow.com/a/174288/895245](https://stackoverflow.com/a/174288/895245)提到的问题，该问题`$SHELL_VAR`可能以选项开头`-`并被阅读。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T13:00:42.633

我相信这是由于

```
SHELLVAR=$(true)
if test $SHELLVAR  = "yes" ; then echo "yep" ; fi 

# bash: test: =: unary operator expected 
```

也

```
if test $UNDEFINEDED = "yes" ; then echo "yep" ; fi
# bash: test: =: unary operator expected 
```

和

```
SHELLVAR=" hello" 
if test $SHELLVAR = "hello" ; then echo "yep" ; fi
# yep 
```

但是，这通常应该有效

```
SHELLVAR=" hello"
if test "$SHELLVAR" = "hello" ; then echo "yep" ; fi 
#<no output> 
```

但是当它在其他地方抱怨输出时，我猜很难说出它在抱怨什么，所以

```
SHELLVAR=" hello"
if test "x$SHELLVAR" = "xhello" ; then echo "yep" ; fi 
```

效果一样好，但更容易调试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T12:51:46.770

当 SHELL_VAR 可能未定义时，我曾经在 DOS 中这样做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T13:01:05.130

如果你不做 "x$SHELL_VAR" 的事情，那么如果 $SHELL_VAR 是未定义的，你会得到一个关于 "=" 不是一元运算符或类似的错误。

# java - JKS保护

> ID：174131
> 
> 赞同：9
> 
> 时间：2008-10-06T12:54:15.080
> 
> 标签：java, security, encryption, jks

JKS（Java Key Store）文件是否加密？它们是否为加密密钥提供全面保护，还是我只需要依赖访问控制？
有没有办法确保密钥受到保护？

我对细节很感兴趣，包括算法、密钥管理等。这些可以配置吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T21:05:20.207

更准确地说：

*   JKS 文件中的 PrivateKeys 和 SecretKeys 使用它们自己的密码进行加密。
*   受信任证书的完整性通过使用密钥存储密码的 MAC 进行保护。
*   整个文件没有加密，攻击者可以在没有密钥存储密码的情况下列出其条目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T12:54:58.310

它们是加密的。

该算法取决于提供者。提供者将根据密码返回密钥/证书。如果您需要强大的安全性，请找到使用强加密的密钥库提供程序。

# sql-server - 计算 SQL Server 存储过程中删除的行数

> ID：174143
> 
> 赞同：51
> 
> 时间：2008-10-06T12:56:22.690
> 
> 标签：sql-server, tsql, audit, sql-delete

在 SQL Server 2005 中，有没有一种方法可以删除行并被告知**实际**删除了多少行？

我可以`select count(*)`在相同的条件下做一个，但我需要这个完全值得信赖。

我的第一个猜测是使用`@@ROWCOUNT`变量 - 但没有设置，例如

```
delete 
from mytable 
where datefield = '5-Oct-2008' 

select @@ROWCOUNT 
```

总是返回 0。

MSDN 建议[`OUTPUT`](http://msdn.microsoft.com/en-us/library/ms189835.aspx)构建，例如

```
delete from mytable 
where datefield = '5-Oct-2008' 
output datefield into #doomed

select count(*) 
from #doomed 
```

这实际上因语法错误而失败。

有任何想法吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-06T13:00:46.283

你试过`SET NOCOUNT OFF`吗？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-06T13:10:44.610

我在 SQL2000 中将@@ROWCOUNT 用于此目的，没有任何问题。确保在检查之前不会无意中重置此计数（BOL：'此变量由任何不返回行的语句设置为 0，例如 IF 语句'）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-01-11T10:07:15.323

只需这样做：

```
SET NOCOUNT off ;
SELECT @p1 = @@ROWCOUNT 
```

其中 p1 是您在存储过程中设置的输出参数。希望能帮助到你。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-06T13:03:56.480

在您的示例中`@@ROWCOUNT`应该可以工作 - 这是找出许多已删除行的正确方法。如果您尝试从应用程序中删除某些内容，那么您需要使用`SET NOCOUNT ON`

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms189837.aspx)，即使 SET NOCOUNT 为 ON，@@ROWCOUNT 函数也会更新，因为它`SET NOCOUNT`只会影响您在执行后收到的消息。

因此，如果您尝试使用`@@ROWCOUNT`来自例如 ADO.NET 的结果，那么`SET NOCOUNT ON`肯定会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-11T19:16:23.953

我发现了一个你不能使用的情况`@@rowcount`，比如当你想知道被删除的值的不同计数而不是总计数时。在这种情况下，您必须执行以下操作：

```
delete from mytable 
where datefield = '5-Oct-2008' 
output deleted.datefield into #doomed

select count(distinct datefield)
from #doomed 
```

OP 中的语法错误是因为在字段名称之前`output`没有包含。`deleted``datefield`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T15:18:59.717

出于好奇，您如何调用该程序？（我假设它是一个存储过程？）。我问的原因是存储过程的返回值（在本例中为 0）和行集结果之间存在差异——在本例中为单行和单列。在 ADO.Net 中，前者将通过参数访问，而后者通过 SqlDataReader 访问。您是否可能将过程的返回值误认为是行数？

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-06T13:00:46.253

创建具有一列 id 的临时表。

插入临时表，选择要删除的 id。这给你你的计数。

从 id 所在的表中删除（从临时表中选择 id）

# windows - 在 DB 中存储 X509 证书 - 是还是不是？

> ID：174149
> 
> 赞同：3
> 
> 时间：2008-10-06T12:59:05.650
> 
> 标签：windows, certificate, pki

我发现自己需要存储公钥证书和内部应用程序的单个私钥证书。

我们团队的一位成员建议将 X509 证书存储在数据库中，而不是像我们迄今为止所做的那样将其存储在 Windows 证书存储中。我不喜欢重新发明轮子，但我至少必须考虑这个想法。这意味着让我们的数据更加集中，这很好，我想。

我能看到的最初的障碍是：

*   私钥仍然需要存储在某个地方，我不知道将它硬塞到“公钥”表中是否是个好主意。我也不喜欢为单个元素设置表格的想法。也许只是将私钥保存为本地文件？（例如 .pfx 文件）。
*   吊销清单。我们可能必须建立一个流程来处理被撤销的公钥。

我对 X509 证书没有太多经验，所以，我的问题是：在数据库中存储公钥证书而不是使用 Windows 证书存储库时，我们可能会遇到其他问题吗？

值得牢记的是，该应用程序将部署到多个业务客户端服务器上，因此将所有数据保存在一个地方将使备份更容易。哦，有问题的内部应用程序是用 C# 开发的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T19:56:36.630

你申请的目的是什么？

如果您正在处理应用程序中的所有加密，并且可以引用 PKCS#12 证书 + 私钥文件，那么使用数据库路由可能没问题。

如果您需要使用 Windows Crypto API 来访问证书，那么您可能希望继续使用内置证书存储。您可以在这里获得一些优势，因为您可以保护外部设备上的私钥，例如智能卡或硬件安全模块 (HSM)。

如果您将所有内容存储在本地磁盘上，您将需要确保您付出了巨大的努力来保护私钥。请务必使用强密码并使用最佳实践来保护您的应用程序中的此密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T14:01:53.600

除非真的有必要，否则我不愿意将私钥移动到任何其他位置。如果密钥用于签名，则不需要它，并且仅当密钥用于解密并且您希望将其存档以备将来使用时才需要。即使在这种情况下，颁发证书的证书颁发机构通常也能够处理存档和恢复。对于 Microsoft 和 entrust 等更受欢迎的 CA 而言，情况当然如此。

如果您必须存储它，请使用 AES 和您能够在 HSM（硬件安全模块）或智能卡中保护的密钥对其进行加密。不要将此键保留为纯文本（在文件或注册表中）。

您还希望在其生成位置和中央数据库之间的传输过程中保护此密钥。SSL 或 VPN 等

在大多数环境中，撤销列表由证书颁发机构发布，通常发布到 LDAP 或目录或两者。

# c# - C# 中的前后递增/递减运算符

> ID：174153
> 
> 赞同：16
> 
> 时间：2008-10-06T12:59:55.990
> 
> 标签：c#

在 C# 中，有谁知道为什么会编译以下代码：

```
int i = 1;
++i;
i++; 
```

但这不会编译？

```
int i = 1;
++i++; 
```

（编译器错误：递增或递减运算符的操作数必须是变量、属性或索引器。）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-06T13:02:46.920

您正在对另一个结果运行其中一个操作数，增量/减量的结果是一个值 - 您不能对一个值使用增量/减量，它必须是一个可以设置的变量。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-06T13:13:11.657

出于同样的原因，你不能说

```
5++; 
```

或者

```
f(i)++; 
```

函数返回一个*值*，而不是一个变量。增量运算符也返回值，但不能应用于值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T13:04:22.127

我的猜测是 ++i 返回一个整数值类型，然后您尝试对其应用 ++ 运算符。看到你不能写入一个值类型（想想 0++，如果这有意义的话），编译器会发出一个错误。

换句话说，这些语句被解析为这个序列：

```
++i  (i = 2, returns 2)
2++  (nothing can happen here, because you can't write a value back into '2') 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-10-06T13:01:03.477

我的猜测：避免这种丑陋和不必要的结构。它还将使用 2 个操作（2x INC）而不是一个（1x ADD 2）。

是的，我知道......“但我想增加两个，我是 l33t g33k！”

好吧，不要成为一个极客，写一些看起来不像是无意错误的东西，就像这样：

```
i += 2; 
```

# c# - C#中的switch语句失败？

> ID：174155
> 
> 赞同：397
> 
> 时间：2008-10-06T13:00:15.553
> 
> 标签：c#, switch-statement

`switch`Switch 语句失败是我个人喜欢与`if/else if`构造的主要原因之一。这里有一个例子：

```
static string NumberToWords(int number)
{
    string[] numbers = new string[] 
        { "", "one", "two", "three", "four", "five", 
          "six", "seven", "eight", "nine" };
    string[] tens = new string[] 
        { "", "", "twenty", "thirty", "forty", "fifty", 
          "sixty", "seventy", "eighty", "ninety" };
    string[] teens = new string[]
        { "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen",
          "sixteen", "seventeen", "eighteen", "nineteen" };

    string ans = "";
    switch (number.ToString().Length)
    {
        case 3:
            ans += string.Format("{0} hundred and ", numbers[number / 100]);
        case 2:
            int t = (number / 10) % 10;
            if (t == 1)
            {
                ans += teens[number % 10];
                break;
            }
            else if (t > 1)
                ans += string.Format("{0}-", tens[t]);
        case 1:
            int o = number % 10;
            ans += numbers[o];

            break;
        default:
            throw new ArgumentException("number");
    }
    return ans;
} 
```

聪明的人之所以畏缩，是因为`string[]`s 应该在函数之外声明：嗯，他们是，这只是一个例子。

编译器失败并出现以下错误：

```
控制不能从一个案例标签（“案例 3：”）转移到另一个案例标签
控制不能从一个案例标签（“案例 2：”）转移到另一个案例标签

```

为什么？有没有办法在没有三个 s 的情况下获得这种行为`if`？

* * *

## 回答 #1

> 赞同：705
> 
> 时间：2008-10-06T13:13:18.647

（复制/粘贴[我在其他地方提供的答案](https://stackoverflow.com/questions/9033/hidden-features-of-c?answer=90432#90432)）

可以通过在 a (see ) 中没有代码或`switch`使用特殊的(see ) 或(see ) 形式来实现通过 -s：`case``case``case 0``goto case``case 1``goto default``case 2`

```
switch (/*...*/) {
    case 0: // shares the exact same code as case 1
    case 1:
        // do something
        goto case 2;
    case 2:
        // do something else
        goto default;
    default:
        // do something entirely different
        break;
} 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-10-06T13:13:42.797

“为什么”是为了避免意外跌倒，对此我很感激。这是 C 和 Java 中常见的错误来源。

解决方法是使用 goto，例如

```
switch (number.ToString().Length)
{
    case 3:
        ans += string.Format("{0} hundred and ", numbers[number / 100]);
        goto case 2;
    case 2:
    // Etc
} 
```

在我看来，开关/外壳的总体设计有点不幸。它离 C 太近了 - 可以在范围等方面进行一些有用的更改。可以说，可以进行模式匹配等的更智能的开关会有所帮助，但这确实从开关变为“检查一系列条件” - 在这一点上，可能需要一个不同的名字。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2013-12-09T12:15:29.340

为了补充这里的答案，我认为值得考虑与此相关的相反问题，即。为什么C首先允许失败？

当然，任何编程语言都有两个目标：

1.  向计算机提供指令。
2.  留下程序员的意图记录。

因此，任何编程语言的创建都是如何最好地服务于这两个目标之间的平衡。一方面，越容易转化为计算机指令（无论是机器码、像 IL 一样的字节码，还是在执行时解释的指令），那么编译或解释过程将更高效、可靠和输出紧凑。极端地说，这个目标导致我们只用汇编、IL 甚至原始操作码编写，因为最简单的编译是根本没有编译的地方。

相反，语言越多地表达程序员的意图，而不是为此而采取的手段，程序在编写和维护期间就越容易理解。

现在，`switch`总是可以通过将其转换为等效的`if-else`块链或类似的链来编译，但它被设计为允许编译为特定的通用汇编模式，其中一个值，计算一个偏移量（无论是通过查找表由值的完美散列索引，或由值的实际算术索引*）。在这一点上值得注意的是，今天，C# 编译有时会`switch`变成等价的`if-else`，有时会使用基于散列的跳转方法（对于 C、C++ 和其他具有可比语法的语言也是如此）。

在这种情况下，允许掉线有两个很好的理由：

1.  无论如何它都会自然发生：如果您将跳转表构建到一组指令中，并且较早的一批指令中的一个不包含某种跳转或返回，那么执行将自然地进入下一批。`switch`如果您将-using C 转换为 jump-table-using 机器代码，则允许掉线是“刚刚发生”的事情。

2.  用汇编编写代码的程序员已经习惯了这样的情况：在汇编中手动编写跳转表时，他们必须考虑给定的代码块是否会以返回、跳出表或继续到下一个街区。因此，让编码器`break`在必要时添加显式对编码器来说也是“自然的”。

因此，在当时，平衡计算机语言的两个目标是一种合理的尝试，因为它与生成的机器代码和源代码的表达性有关。

然而，四年过去了，情况并不完全一样，原因如下：

1.  今天的 C 语言编码人员可能很少或没有汇编经验。许多其他 C 风格语言的编码人员更不可能（尤其是 Javascript！）。任何“人们习惯于组装什么”的概念都不再相关。
2.  优化方面的改进意味着要么因为它被认为是最有效的方法而变成，`switch`要么变成`if-else`跳表方法的特别深奥的变体的可能性更高。高级和低级方法之间的映射不像以前那么强。
3.  经验表明，穿透往往是少数情况而不是常态（对 Sun 编译器的一项研究发现，3% 的`switch`块在同一块上使用了一个穿透而不是多个标签，人们认为使用 -这里的情况意味着这 3% 实际上远高于正常水平）。因此，所研究的语言使不寻常的语言比普通语言更容易迎合。
4.  经验表明，无论是在意外完成的情况下，还是在维护代码的人错过正确的失败的情况下，失败往往都是问题的根源。后者是对与失败相关的错误的微妙补充，因为即使您的代码完全没有错误，您的失败仍然会导致问题。

与最后两点相关，请考虑当前版本的 K&R 中的以下引用：

> 从一个案例到另一个案例并不稳健，在修改程序时容易解体。除了单个计算的多个标签外，应谨慎使用失败并进行注释。
> 
> 作为一种良好的形式，在最后一种情况（这里的默认值）之后放置一个中断，即使它在逻辑上是不必要的。有一天，当最后添加另一个案例时，这一点防御性编程将拯救你。

因此，从马的口中，C 中的失败是有问题的。始终使用注释记录失败被认为是一种很好的做法，这是对一般原则的一种应用，即应该记录一个人在哪里做了不寻常的事情，因为这会导致以后对代码的检查和/或使你的代码看起来像它当它实际上是正确的时，它有一个新手的错误。

仔细想想，代码如下：

```
switch(x)
{
  case 1:
   foo();
   /* FALLTHRU */
  case 2:
    bar();
    break;
} 
```

**正在**添加一些东西以使代码中的失败显式化，这不是编译器可以检测到的东西（或者可以检测到它的缺失）。

因此，在 C# 中必须明确表示 on 的事实并不会对用其他 C 风格语言写得很好的人造成任何惩罚，因为他们已经在他们的失败中明确表示。†< /p>

最后，`goto`这里的使用已经是 C 和其他此类语言的规范：

```
switch(x)
{
  case 0:
  case 1:
  case 2:
    foo();
    goto below_six;
  case 3:
    bar();
    goto below_six;
  case 4:
    baz();
    /* FALLTHRU */
  case 5:
  below_six:
    qux();
    break;
  default:
    quux();
} 
```

在这种情况下，如果我们希望将一个块包含在执行的代码中，而不是仅仅为前一个块带来一个值，那么我们已经不得不使用`goto`. （当然，有一些方法可以通过不同的条件来避免这种情况，但与这个问题相关的所有事情都是如此）。因此，C# 建立在已经很正常的方式上来处理一种情况，即我们想要在 a 中点击多个代码块`switch`，并且只是将其概括为也涵盖了失败。它还使这两种情况更方便和自我记录，因为我们必须在 C 中添加一个新标签，但可以`case`在 C# 中将其用作标签。在 C# 中，我们可以摆脱`below_six`标签并使用`goto case 5`更清楚地说明我们在做什么。（我们还必须添加`break`对于`default`，我省略了只是为了使上面的 C 代码明显不是 C# 代码）。

综上所述：

1.  C# 不再像 40 年前的 C 代码那样直接与未优化的编译器输出相关（现在 C 也没有），这使得失败的灵感之一无关紧要。
2.  C# 与 C 保持兼容，不仅具有隐式`break`，便于熟悉类似语言的人学习该语言，并且更容易移植。
3.  C# 删除了可能的错误来源或被误解的代码，这些代码在过去四年中已被充分记录为导致问题的原因。
4.  C# 使编译器可以强制执行现有的 C（文档失败）最佳实践。
5.  C# 使不寻常的情况具有更明确的代码，通常情况下具有代码的情况只是自动编写。
6.  C# 使用与 C 中使用的相同`goto`的基于 - 的方法从不同的`case`标签中点击相同的块。它只是将其推广到其他一些情况。
7.  通过允许语句充当标签， C# 使`goto`基于 - 的方法比在 C 中更方便、更清晰。`case`

总而言之，一个非常合理的设计决定

* * *

*某些形式的 BASIC 将允许人们做类似的事情`GOTO (x AND 7) * 50 + 240`，虽然它很脆弱，因此是一个特别有说服力的禁止案例`goto`，但确实有助于显示一种高级语言等价物，这种方式类似于低级代码可以基于这种方式进行跳转对一个值进行算术运算，当它是编译的结果而不是必须手动维护的东西时，这更合理。Duff 设备的实现尤其适用于等效的机器代码或 IL，因为每个指令块通常具有相同的长度，而无需添加`nop`填充符。

†Duff 的设备再次出现在这里，作为一个合理的例外。使用该模式和类似模式存在重复操作的事实有助于使跌倒的使用相对清晰，即使没有对此效果的明确评论。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2008-10-06T13:06:10.533

从历史上看，切换失败是现代软件中错误的主要来源之一。语言设计者决定强制在案例结束时跳转，除非您直接默认到下一个案例而不进行处理。

```
switch(value)
{
    case 1:// this is still legal
    case 2:
} 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-06T13:08:37.143

您可以“转到案例标签” [http://www.blackwasp.co.uk/CSharpGoto.aspx](http://www.blackwasp.co.uk/CSharpGoto.aspx)

> goto 语句是一个简单的命令，它无条件地将程序的控制权转移到另一个语句。该命令经常受到一些开发人员的批评，他们主张将其从所有高级编程语言中删除，因为它可能导致[*意大利面条式代码*](http://en.wikipedia.org/wiki/Spaghetti_code)。当有太多的 goto 语句或类似的跳转语句导致代码难以阅读和维护时，就会发生这种情况。然而，也有程序员指出，当仔细使用 goto 语句时，它可以为一些问题提供优雅的解决方案……

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-06T13:04:34.343

他们在设计上忽略了这种行为，以避免当它未被意志使用但引起问题时。

只有在 case 部分没有语句的情况下才能使用它，例如：

```
switch (whatever)
{
    case 1:
    case 2:
    case 3: boo; break;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-06T13:03:03.270

他们更改了 c# 的 switch 语句（来自 C/Java/C++）行为。我想原因是人们忘记了失败并导致了错误。我读过的一本书说使用 goto 来模拟，但这对我来说听起来不是一个好的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T13:03:34.110

> 在每个 case 块之后都需要一个跳转语句，例如 break，包括最后一个块，无论它是 case 语句还是 default 语句。除了一个例外（与 C++ switch 语句不同），C# 不支持从一个 case 标签到另一个 case 标签的隐式下降。一个例外是 case 语句没有代码。

-- [C# switch() 文档](http://msdn.microsoft.com/en-us/library/06tc147t(VS.80).aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-04T09:02:02.403

在每个 case 语句之后需要**break**或**goto**语句，即使它是默认情况。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-07-28T20:30:50.597

您可以通过 goto 关键字实现像 c++ 一样的失败。

前任：

```
switch(num)
{
   case 1:
      goto case 3;
   case 2:
      goto case 3;
   case 3:
      //do something
      break;
   case 4:
      //do something else
      break;
   case default:
      break;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-02-14T22:19:05.647

只需快速说明，Xamarin 的编译器实际上出错了，它允许失败。据说已修复，但尚未发布。在一些实际上失败的代码中发现了这一点，编译器没有抱怨。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-10-07T09:33:53.613

[开关（C# 参考）说](http://msdn.microsoft.com/en-us/library/06tc147t.aspx)

> C# 需要 switch 部分的结尾，包括最后一个，

所以你还需要在`break;`你的`default`部分中添加一个，否则仍然会出现编译器错误。

* * *

## 回答 #13

> 赞同：-12
> 
> 时间：2008-10-06T13:10:37.340

您忘记添加“break;” 在案例 3 中声明。在案例 2 中，您将其写入 if 块。因此试试这个：

```
case 3:            
{
    ans += string.Format("{0} hundred and ", numbers[number / 100]);
    break;
}

case 2:            
{
    int t = (number / 10) % 10;            
    if (t == 1)            
    {                
        ans += teens[number % 10];                
    }            
    else if (t > 1)                
    {
        ans += string.Format("{0}-", tens[t]);        
    }
    break;
}

case 1:            
{
    int o = number % 10;            
    ans += numbers[o];            
    break;        
}

default:            
{
    throw new ArgumentException("number");
} 
```

# entity-framework - 实体框架基本上是另一个 CRUD 代码生成器吗？

> ID：174163
> 
> 赞同：1
> 
> 时间：2008-10-06T13:01:06.097
> 
> 标签：entity-framework

实体框架只是另一个 CRUD 代码生成器的花哨名称吗？

或者还有更多？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T13:14:50.267

这有点像说面向对象编程基本上是经过一些修改的过程。虽然 EF 不被认为是对象关系映射的最佳示例，但它试图涵盖的原则已经使用了近 30 年。我建议阅读有关实体关系模型的 Raymond Chen 博士（他开发了它并有一篇论文。）维基百科也有一些信息。[http://en.wikipedia.org/wiki/Entity_relationship_model](http://en.wikipedia.org/wiki/Entity_relationship_model)。市场上这种方法的最佳工具是 LLBLGen。它有 5 年的成熟期，并围绕 MS EF 运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T06:31:59.110

实体框架适用于所有将受益于 ORM（对象关系映射）层的应用程序。Daniel Simmons 的帖子对此进行了详细介绍。[http://blogs.msdn.com/dsimmons/archive/2008/05/17/why-use-the-entity-framework.aspx](http://blogs.msdn.com/dsimmons/archive/2008/05/17/why-use-the-entity-framework.aspx)

通过使用部分类，EF 允许您拥有包含与持久性无关的业务逻辑的类（但是，这种方法并不特定于 EF）。

我们有复杂的域对象，它们进行验证并支持复杂的业务规则，这些规则也部分通过 EF 持久化，因此这不仅仅是 CRUD 的核心。

# python - Python - Py2exe 无法使用“电子邮件”模块构建 .exe

> ID：174170
> 
> 赞同：8
> 
> 时间：2008-10-06T13:02:03.287
> 
> 标签：python, winapi, py2exe

py2exe 不适用于标准电子邮件模块

你好。我正在尝试使用 py2exe 将脚本转换为 exe。构建过程显示了这一点：

* * *

似乎缺少以下模块

## ['email.Encoders', 'email.Generator', 'email.Iterators', 'email.MIMEBase', 'email.MIMEMultipart', 'email.MIMEText', 'email.Utils', 'email.base64MIME']

可执行文件不起作用。不包括引用的模块。我在网上对此进行了研究，我发现 py2exe 在标准 lib 电子邮件模块中使用的 Lazy import 存在问题。不幸的是，我没有成功找到解决此问题的方法。任何人都可以帮忙吗？

谢谢，

脚本中的 PS Imports 如下所示：

代码：select all import string,time,sys,os,smtplib from email.MIMEMultipart import MIMEMultipart from email.MIMEBase import MIMEBase from email.MIMEText import MIMEText from email import Encoders

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T13:05:01.487

看看这个问题[how-to-package-twisted-program-with-py2exe](https://stackoverflow.com/questions/169897/how-to-package-twisted-program-with-py2exe)它似乎是同样的问题。

给出的答案是将命令行上的模块显式包含到 py2exe。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T21:38:17.923

你使用的是什么版本的 Python？如果您使用的是 2.5 或 2.6，那么您应该像这样进行导入：

```
import string,time,sys,os,smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.base import MIMEBase
from email.mime.text import MIMEText
from email import Encoders 
```

我很确定如果您正确使用py2exe 的modulefinder 可以正确找到电子邮件包（即在Python 2.5+ 中使用上述名称，或在Python 2.4- 中使用旧名称）。当然，SpamBayes 安装脚本不需要显式包含电子邮件包，它包含电子邮件模块没有问题。

其他答案是正确的，因为如果您确实需要专门包含一个模块，则可以通过命令行使用“includes”选项，或者在调用 setup.xml 时将它们传入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T15:31:13.627

使用“包含”选项。见： http: [//www.py2exe.org/index.cgi/ListOfOptions](http://www.py2exe.org/index.cgi/ListOfOptions)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T13:09:26.687

如果您不必使用 py2exe，bbfreeze 效果更好，我已经尝试使用电子邮件模块。[http://pypi.python.org/pypi/bbfreeze/0.95.4](http://pypi.python.org/pypi/bbfreeze/0.95.4)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-23T21:52:10.183

我通过在 setup.py 中明确包含缺少的模块来使其工作：

旧的 setup.py：

```
setup(console = ['main.py']) 
```

新的 setup.py：

```
setup(console = ['main.py'], 
      options={"py2exe":{"includes":["email.mime.multipart","email.mime.text"]}}) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-28T14:56:32.663

在将我的应用程序从 py24 移植到 26 时，我遇到了同样的问题。

阅读[http://www.py2exe.org/index.cgi/ExeWithEggs](http://www.py2exe.org/index.cgi/ExeWithEggs)后 ，如果最终找到以下解决方案：

## 在我的 application.py 中：

```
import email
import email.mime.text
import email.mime.base
import email.mime.multipart
import email.iterators
import email.generator
import email.utils

try:    
    from email.MIMEText import MIMEText
except:    
    from email.mime import text as MIMEText 
```

## 在 setup.py 中：

```
import modulefinder
modulefinder.AddPackagePath("mail.mime", "base")
modulefinder.AddPackagePath("mail.mime", "multipart")
modulefinder.AddPackagePath("mail.mime", "nonmultipart")
modulefinder.AddPackagePath("mail.mime", "audio")
modulefinder.AddPackagePath("mail.mime", "image")
modulefinder.AddPackagePath("mail.mime", "message")
modulefinder.AddPackagePath("mail.mime", "application") 
```

为了让 py2exe 处理在运行时加载的包，主要的事情似乎是你在你的应用程序的某个地方显式地导入你的应用程序所需的模块。然后用 moudlefinder.AddPackagePath( , ) 给 setup.py 中的 py2exe 提示，在哪里搜索标准找不到的模块。内省。在应用程序中

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-03T22:16:01.253

这解决了我的问题：在 setup.py 中编辑

```
includes = ["email"] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-20T09:20:36.467

请试试这个。这适用于我的 py2exe 构建。只需将“project_name.py”替换为您的主脚本即可。EXTRA_INCLUDES 是您需要包含在构建中的包，例如电子邮件包。我也和你一起工作。

```
from distutils.core import setup
    import py2exe, sys, os

    sys.argv.append('py2exe')

    EXTRA_INCLUDES = [
        "email.iterators", "email.generator", "email.utils", "email.base64mime", "email", "email.mime",
        "email.mime.multipart", "email.mime.text", "email.mime.base",
        "lxml.etree", "lxml._elementpath", "gzip"
    ]

    setup(
        options = {'py2exe': {'bundle_files': 1, 'compressed': True, 'includes': EXTRA_INCLUDES,
                    'dll_excludes': ['w9xpopen.exe','MSVCR71.dll']}},
        console = [{'script': "project_name.py"}],
        zipfile = None,
    ) 
```

# maven - 在 Maven 项目中包含非 Java 源

> ID：174171
> 
> 赞同：8
> 
> 时间：2008-10-06T13:02:16.233
> 
> 标签：maven, maven-2

我正在着手一个项目，我预计该项目将包含大量非 Java 代码（主要是 shell 和 SQL 脚本）。

我仍然想用 Maven 管理这个项目。非 Java 源代码和 Maven 的最佳实践是什么？源头应该去哪里？他们在不同的生命周期阶段会发生什么？任何指向更多信息的指针或链接将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T08:12:00.360

如果您不想像 heckj 建议的那样将这些文件包含到 JAR 文件中，则不得将非 Java 代码放入资源中。位于资源中的所有内容都会自动复制到 JAR 文件中，我猜您不希望 shell 脚本和 SQL 脚本包含在 JAR 文件中，对吧？

所以 Maven 的方式是在 src/main 下创建额外的文件夹。例如，为您的 SQL 脚本创建一个**sql文件夹，为您的 shell 脚本创建一个****sh**文件夹等等。这是其他 Maven 插件也需要源的位置，例如 C++、Groovy 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-06T05:56:45.060

我保存在一个单独的文件夹 src/main/sql 中。检查[此](http://maven.apache.org/pom.html#Resources)链接以获取更多信息。

# oracle-apex - Oracle APEX 访问

> ID：174174
> 
> 赞同：2
> 
> 时间：2008-10-06T13:02:40.930
> 
> 标签：oracle-apex

Oracle Application Express 是否适合 Intranet 客户端/服务器应用程序？如果是这样，我应该怎么做才能使客户端访问应用程序？

* * *

好吧，我是一名 PowerBuilder/Oracle 开发人员，所以我熟悉客户端/服务器架构。我最近阅读了一篇关于 APEX 的文章，因此我想开发我的 PowerBuilder/Oracle 应用程序的 APEX 变体，它几乎是 HR 应用程序。它不应该是可访问 Internet 的应用程序，而只是一个小型网络中的几个 Windows 框。我在 PL/SQL 和 SQL 中开发应用程序没有问题（不过，我必须阅读和询问很多）。我只想知道 APEX 是否适合 Intranet 应用程序 - 它应该适合 Internet 应用程序 :) - 以及我应该如何让客户端的浏览器访问应用程序，因为没有像 http://www.appdomain 这样的东西。 com ? 我对胜利网络几乎一无所知:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T16:59:04.197

APEX*不是*客户端/服务器应用程序开发环境，因此答案显然是“否”。

Apex 是一个 n 层 Web 应用程序架构，其中 n=3：您的浏览器、Apex Web 应用程序服务器和数据库。在这种情况下，应用服务器有点滑稽，因为它实际上执行了数据库中的几乎所有代码，而不是中间层。

客户端/服务器是您在用户端部署应用程序的地方（与使用上述浏览器相反）并连接到服务器（例如 oracle db 服务器）。过去很常见的是连接到 Oracle 后端的 VB 前端。这些天没那么多了；）

如果您有 Oracle 商店，那么 APEX 就很棒。如果是小型应用程序，您可以使用“Oracle Database XE”，它是与 APEX 捆绑在一起的免费版本，但对 CPU 和存储有限制。

我猜您可能会问 Oracle 的 XE 数据库版本是否良好/稳定并且可以在客户端服务器应用程序设置中使用？恕我直言，绝对是开始或使用小型简单应用程序的好地方，但它在修复已知问题、错误等方面停留在原处。虽然这些往往是非常非常具体的情况，其中正确的组合的因素出现时，您不想设定许可证和支持将免费的期望，稍后您将不得不返回到数据库的完整企业版。也不是与 Oracle 销售人员讨价还价的最佳位置 :)

也许你可以用不同的方式表达你的问题？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T05:56:24.987

*“因为不会有像 http://www.appdomain.com 这样的东西”* 鉴于您熟悉客户端/服务器技术，我想您知道 TNSNAMES.ORA

您的 Apex 主机的定义方式与 tnsnames.ora 中定义数据库主机的方式类似。如果它说它被定义为 dbhost，那么您组织中已将 dbhost 映射到特定机器的任何人都可以为您的网络服务器执行相同的操作。唯一需要注意的是，有时您在浏览器中定义了特定代理，并且您的 apex 网络服务器可能需要添加为例外。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T04:45:51.910

伊戈尔，

我参加这个聚会**真的**很晚了，但你似乎没有得到你喜欢的答案。

Apex**绝对**是开发您所描述的小型内部 Web 应用程序的绝佳工具。这比在 PB 中做同样的事情（我也使用）要容易得多**。**如果您的网络上已经安装了 Oracle，那么请 DBA 也安装 Apex，它只安装在 Oracle 中（不需要外部的东西），这可以相当快地完成。（我在 Oracle XE 上的家用 PC 上运行 Apex。）安装后，DBA 必须告诉您 Apex 的 URL。

完成此操作后，请自行浏览为期 2 天的开发人员指南，了解 Apex 应用程序的开发方式，然后进行尝试。掌握它需要一点时间，但是一旦你做到了，它真的很有效。但是，如果您了解应用程序的数据和业务逻辑，您应该不会花很长时间。您还可以安装许多示例应用程序，然后查看它们的源代码以获取方法。

开始后，加入 Oracle Apex 用户论坛，这是一个供开发人员互相帮助的绝佳社区。你会经常在那里找到我。

祝你好运！

炖

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T14:06:51.330

Application Express 应用程序通过浏览器中的 URL 访问，URL 类似于：

```
http://www.mydomain.com/pls/mydad/f?p=MYAPP 
```

客户端/服务器应用程序必须启动浏览器窗口并传入适当的 URL。

# language-agnostic - 您将 REST api 放在哪一层？

> ID：174181
> 
> 赞同：4
> 
> 时间：2008-10-06T13:04:15.623
> 
> 标签：language-agnostic, rest

我们的应用程序的结构类似于：

UI <--> REST API <--> 工作流 <--> 业务逻辑 <--> DAL <--> DB

但是，我看到一些看起来人们正在做的例子

UI <--> 工作流 <--> REST API <--> 业务逻辑 <--> DAL <--> DB

这是我的想象吗？或者第二种选择是否被认为是可行的选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T22:58:19.683

这确实与您所说的工作流程有关。

作为应用程序状态引擎的超媒体将为您提供状态/资源的有向图。这些图不必形成工作流（例如，具有特定的起点和终点）。它们很可能形成一个循环，具有双向链接等等。我假设这个图是从业务逻辑中衍生出来的。

如果你在你的 UI 中包含你的工作流（通过图表从一个点到另一个点的特定路径），你会对 REST API 做出一些假设，因此将你的 UI 与业务逻辑紧密耦合，从而抛弃了 REST 的可发现性。

一般来说，将工作流（命令式编程）与 REST（声明式编程）混合是非常有问题的。最好的方法是拥有一个自适应 UI，它可以允许用户导航状态网络，而不是通过定制的、预定的工作流程来限制它们。无论如何，这就是浏览器的工作方式。

但是，如果您确实需要一些工作流程，您可以通过创建一个相互关联的资源链并将用户引导到第一个资源来实现它们。从这个意义上说，您的第一个选项将是有效的，尽管我发现业务逻辑和工作流的分离是一个灰色区域。工作流*是*业务逻辑的一部分，或者说得更好，是*从*业务逻辑派生的。

这些意见是我自己的，但是可以在此处找到有关该主题的良好相关文章：http: [//www.infoq.com/articles/webber-rest-workflow](http://www.infoq.com/articles/webber-rest-workflow)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T19:40:15.043

我现在才刚刚接触到 ReST 的真正含义，希望我不会在这里偏离基础，但据我所知，客户应该负责选择要转移到的状态（工作流程），所以是的，我认为 #2绝对有效。事实上，我很想知道你是如何在你的 ReST API 中实现工作流的。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-10-07T21:03:14.797

REST 是对资源的访问。问题是“什么是资源”？大多数答案是它是一条非常低级的信息。

复合应用程序或工作流依赖于一个或多个资源。

很难说资源依赖于工作流。并非不可能。但是很难。

在设计 RESTful 界面时，您只有可用的 CRUD 规则。最常见的期望是响应完全符合您的要求。当您发布一个 X 时，您期望唯一的状态变化是创建一个新的 X。而不是创建一个带有可选 Z 对的 X 和 Y。

I'd suggest that your second alternative puts REST in a better context -- access to stateful objects.

# ruby-on-rails - Recursive Rails Nested Resources

> ID：174190
> 
> 赞同：6
> 
> 时间：2008-10-06T13:05:37.163
> 
> 标签：ruby-on-rails, ruby

I have a Rails application for project management where there are Project and Task models. A project can have many tasks, but a task can also have many tasks, ad infinitum.

Using nested resources, we can have /projects/1/tasks, /projects/1/tasks/new, /projects/1/tasks/3/edit etc.

However, how do you represent the recursive nature of tasks RESTfully? I don't want go another level deep, so perhaps the following would do:

```
map.resources :tasks do |t|
    t.resources :tasks
end 
```

That would give me the following urls:

```
/tasks/3/tasks/new   
/tasks/3/tasks/45/edit 
```

Or perhaps when it comes to an individual task I can just use /tasks/45/edit

Is this a reasonable design?

Cam

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T13:28:55.073

超出单个嵌套路由的任何地方通常被认为是一个坏主意。

从**Rails Way**的第 108 页开始：

[” *Jamis Busk 是 Rails 社区中非常有影响力的人物，几乎和 David 本人一样。2007 年 2 月，在他的博客上，他基本上告诉我们深度嵌套是一个_坏_的事情，并提出了以下经验法则：资源**不应该**嵌套深度超过一层。* ”](http://weblog.jamisbuck.org/2007/2/5/nesting-resources)

现在有些人会对此提出异议（在第 109 页进行了讨论），但是当您谈论将任务与任务嵌套时，它似乎没有多大意义。

我会以不同的方式处理您的解决方案，就像上面提到的那样，一个项目应该有很多任务，但是对于一个有很多任务的任务来说似乎不正确，也许这些应该被重命名为子任务或类似的东西线。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T13:13:37.193

there's no reason they should have decendant URLS.

logically:

```
/projects/1  --> project 1 
/projects/1/edit ( etc )
/tasks/1     --> task 1 
/project/1/tasks --> task list for project 1 
/project/1/tasks/new 
/project/1/tasks/1/edit ->  /tasks/5/edit ( redundancy ) 
/project/1/tasks/1 -> redirect to /tasks/1 
/tasks/1/project -> redirect to /projects/1 
/tasks/3/tasks --> list of tasks that are children tasks of task 3
/tasks/3/tasks/5 -> redirect /tasks/5/    ( because you don't really need to have a recursive URL )
/tasks/5/parents -> list of tasks that are parents of tasks 3
/tasks/5/parents/3 -> redirect /tasks/3/ 

```

there's no reason IMHO to require the URLs be associative, you're not going to need to know that task 5 is a child of task 3 to edit task 5\.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T18:01:33.573

我目前正在做一个类似的项目。我使用的非常优雅的答案是我添加了一个指向另一个任务的 parent_id 列。在制作模型时，请确保执行以下操作：

```
belongs_to :project
belongs_to :parent, :class_name => "Task"
has_many :children, :class_name => "Task", :foreign_key => "parent_id" 
```

...然后您可以通过以下方式进行递归：

```
def do_something(task)
  task.children.each do |child|
    puts "Something!"
    do_something(child)
  end
end 
```

这样，您可以通过其父级或子级引用您的任务。在执行路线时，您将始终通过以下方式访问单个任务

```
/project/:project_id/task/:task_id 
```

即使它可能有父母或孩子。

只需确保您没有一个任务的父级与其子级相同，否则当您执行递归查找所有子级时，您将进入无限循环。您可以将条件添加到您的验证脚本以确保它没有。

另见：[acts_as_tree](http://api.rubyonrails.com/classes/ActiveRecord/Acts/Tree/ClassMethods.html)

# visual-studio - Visual Studio：是否有“将类移动到不同的命名空间”重构？

> ID：174193
> 
> 赞同：80
> 
> 时间：2008-10-06T13:07:19.313
> 
> 标签：visual-studio, refactoring

我正在做一些架构清理，包括将一堆类移动到不同的项目和/或命名空间中。目前我正在手动移动文件，构建，然后根据需要手动添加*使用 Foo*语句来解决编译错误。有人知道这样做的更聪明的方法吗？（我们是 CodeRush 和 Refactor！商店，但我很想知道 Resharper 是否对此提供支持）

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2019-04-21T12:20:13.543

Visual Studio 2019 提供至少 2 个内置选项：

['Move to namespace...'](https://docs.microsoft.com/en-us/visualstudio/ide/reference/move-type-to-namespace?view=vs-2019)重构可以在任何类上触发，VS 会提示输入目标命名空间。

当当前文件命名空间与文件夹结构不匹配时，会提供“将[命名空间更改为...”重构。](https://docs.microsoft.com/en-us/visualstudio/ide/reference/sync-namespace-and-folder-name?view=vs-2019)

这可用于通过以下方式将单个类移动到不同的命名空间：

1.  创建所需的文件夹结构
2.  移动文件
3.  应用上述重构（CTRL+. 将光标悬停在命名空间上）

这些操作确保所有引用都相应更新。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2010-07-29T07:37:38.020

Visual Studio 2010 可以重命名命名空间。将光标放在命名空间名称上并按`F2`。或者只是在代码中重命名它，然后在看到红色曲线出现后按`Shift`+ `Alt`+ 。`F10``Enter`

Reharper 还可以[重命名命名空间](http://www.jetbrains.com/resharper/documentation/help20/Refactoring/renaming.html#renameNamespace)。引用：

> 重**命名命名空间**重构允许用户重命名特定命名空间并自动更正代码中对该命名空间的所有引用。以下用法已重命名：
> 
> *   命名空间语句
> *   使用指令
> *   类型的限定名称

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-10-06T18:35:10.633

正如评论中提到的，这个答案现在已经过时了。请参阅[下面的最新答案](https://stackoverflow.com/a/55782663/479251)

* * *

Resharper 是我所知道的唯一具有此功能的工具。CodeRush 和 Refactor 中还缺少许多其他功能！

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-12-20T09:22:39.967

此答案至少适用于 Visual Studio 2013 和 2015 **，无需重新锐化**

1.  将类文件移动到新文件夹
2.  打开“查找和替换”
3.  选择“在文件中替换”
4.  在“查找内容”字段中键入*原始命名空间定义，例如。*`MyCorp.AppStuff.Api`
5.  在“替换为”字段中键入*新的命名空间定义，例如。*`MyCorp.AppStuff.Api.Extensions`
6.  使用“查找”字段的浏览按钮选择新文件夹`...`，或键入文件夹路径
7.  按下`Replace All`按钮

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-12-11T15:39:11.850

VS 2015 和 VS 2017 有部分解决方案，没有使用免费扩展的**Resharper 。**

我今天（2017 年底）喜欢的一个扩展是**Fix Namespace** VS Extension： [https ://marketplace.visualstudio.com/items?itemName=vs-publisher-599079.FixNamespace#overview](https://marketplace.visualstudio.com/items?itemName=vs-publisher-599079.FixNamespace#overview)

它分析您的解决方案的文件夹结构并使用它提供命名空间重构。不幸的是，它并不完美：它不能很好地跟踪依赖关系，但为我解决了大部分工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-10-27T09:29:12.720

使用 Resharper：`CTRL`+ `R`+`O`

然后按两次向下箭头键选择*Move Type To Another Namespace*。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-06T23:07:28.317

由于提供了上述答案（我猜），此功能已添加到 CodeRush。只需将克拉放在要移动的*类型*上，您就会在重构上看到*将类型移动到命名空间选项！*上下文菜单。这会将类型移动到新的命名空间并更新引用。不过，您可能仍希望将文件移动到与命名空间名称匹配的解决方案文件夹。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-07T20:56:07.723

这不是最好的结果，但可以在没有插件或工具的情况下完成，只能使用 Visual Studio。在整个解决方案中查找和替换，匹配大小写，匹配整个单词。查找内容：类名，替换为：New.Namespace.ClassName（完全限定的类名）。

如果您在旧命名空间中有 100 多个已移动类和其他类的引用，那么哪些没有被移动，这是我找到的唯一万无一失且免费的解决方案。导致错误的唯一情况是您在其他命名空间中具有相同的类名。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2017-06-23T17:13:38.947

如果您不能或不想使用 Re$harper，**Notepad++**是您的朋友：

1.  *确保您没有在 Visual Studio*中为需要移动到新命名空间的文件保留更改
2.  **在 Notepad++ 中打开所有**包含需要更改的命名空间的文件
3.  打开`**Find & Replace**`(CTRL + H)
4.  填写查找内容和替换为字段
5.  按`**Replace All in All Opened Documents**`
6.  **保存所有**文档中的所有更改（CTRL + SHIFT + S）
7.  切换到 Visual Studio 并**重新加载**所有文档（`**Yes to all**`在提示符处）

**完毕**

# c#-3.0 - C#3.0 自动属性，为什么不直接访问字段呢？

> ID：174198
> 
> 赞同：13
> 
> 时间：2008-10-06T13:07:54.990
> 
> 标签：c#-3.0, properties

使用在类的属性中获取/设置的新方法，如下所示：

```
public string FirstName {
        get; set;
    } 
```

为什么不简单地将属性 FirstName public 而不使用访问器？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-06T13:09:08.560

直接访问类内部变量（字段/属性）的两个大问题是：

1）您不能轻易地对字段进行数据绑定。

2）如果您从类中公开公共字段，则以后不能将它们更改为属性（例如：向设置器添加验证逻辑）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-06T13:09:03.710

因为，将来，如果您更改实现，使用当前接口的代码不会中断。

例如，您实现了一个带有公共字段的简单类，并开始在一些外部模块中使用您的类。一个月后，您发现需要在该类中实现延迟加载。然后，您需要将该字段转换为属性。从 ciew 的外部模块来看，它在语法上可能看起来相同，但事实并非如此。属性是一组函数，而字段是类实例中的偏移量。

通过使用属性，您可以有效地降低界面更改的风险。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T13:09:46.313

这主要归结为它已成为一种常见的编码约定。如果您愿意，可以轻松添加自定义处理代码。但是您是对的，从技术上讲，这没有真正的必要。但是，如果您稍后添加自定义处理，这将帮助您不破坏界面。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T13:38:30.730

当您混合 getter 和 setter 的可访问性时，这种表示法更有用。例如，您可以编写：

```
public int Foo { get; private set; } 
```

您还可以放置一个内部 setter，甚至将 getter 设为私有而将 setter 设为公开。

这种表示法避免了仅仅为了处理内部可写/外部可读值的经典问题而显式编写私有变量的需要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T13:39:45.737

关键是编译器将“引擎盖下”的属性转换为函数对，当您的代码看起来像是在使用该属性时，它实际上是在编译为 IL 时调用函数。

因此，假设您将其构建为一个字段，并在使用该字段的单独程序集中有代码。如果稍后实现发生更改，并且您决定将其设置为对其余代码隐藏更改的属性，则仍然需要重新编译和重新部署其他程序集。如果它从一开始就是一个属性，那么一切都会奏效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T13:13:11.313

我认为提问者在问为什么不做以下事情......

```
public string FirstName { } 
```

当您可以将其缩短到上述内容时，为什么还要打扰访问器。我认为答案是，通过要求访问器使阅读代码的人很明显它是标准的获取/设置。如果没有它们，您可以在上面看到很难发现这是自动实现的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T17:05:19.317

对于 99% 的情况，公开一个公共字段是可以的。

常见的建议是使用字段：“如果您从类中公开公共字段，则以后不能将它们更改为属性”。我知道我们都希望我们的代码是面向未来的，但是这种想法存在一些问题：

*   当您更改接口时，您的类的使用者可能会重新编译。

*   99% 的数据成员永远不需要成为重要的属性。这是[推测性的普遍性](http://c2.com/cgi/wiki?SpeculativeGenerality)。您正在编写很多可能永远不会有用的代码。

*   如果您需要跨版本的二进制兼容性，将数据成员添加到属性中可能还不够。至少，您应该只公开接口并隐藏所有构造函数，并公开工厂（参见下面的代码）。

* * *

```
public class MyClass : IMyClass
{
    public static IMyClass New(...)
    {
        return new MyClass(...);
    }
} 
```

这是一个难题，试图编写在不确定的未来可以工作的代码。真的很难。

[有没有人举例说明使用琐碎的属性保存了他们的培根？](https://stackoverflow.com/questions/205568/have-trivial-properties-ever-saved-your-bacon)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T17:18:41.083

当您遇到错误并且需要找出哪些方法正在修改您的字段以及何时修改时，您会更加关心。如果出现涉及您包裹的字段的错误，将轻量级属性访问器放在前面可以节省大量的心痛。我已经有几次遇到这种情况了，这并不令人愉快，尤其是当它被证明与重入有关时。

预先完成这项工作并在访问器上设置断点比其他方法容易得多。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-16T13:33:59.397

它保留了对象的封装性并减少了代码以更易于阅读。

# windows - Unlock Windows workstation programmatically

> ID：174225
> 
> 赞同：16
> 
> 时间：2008-10-06T13:13:28.240
> 
> 标签：windows, security, winapi

I would like to write a small application that unlocks the workstation. To put the specs of what I need very simple: Have an exe that runs and at a defined time (let's say midnight) unlocks the workstation. Of course the application knows the user and password of the logged on account.

I know of the LogonUser API and have tried using it but failed. Does anyone have a solution, code excerpt that actually works for this issue?

I am targeting NT5 OSes.

* * *

Well, since people started asking what is the reason: I am working on a desktop sharing application and I want to add the feature of unlocking the workstation. Having the very small and simple app to unlock the station at a defined time is in order to separate the problem and to avoid the integration details.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T13:26:42.923

这样您就有了答案，而不是人们留下可能更好的答案作为评论。

这当然是可能的，尽管很多人已经说过这并不明智，如果有人在电脑解锁时走过电脑会发生什么，他们要玩多长时间等等？

Anway，除了建议您有一项服务可以在计算机上完成您想要的任何工作，甚至远程连接到计算机进行工作之外，您还可以让用户使用以下信息。（至于“代码专家”，您可以自己制作）

[http://www.paralint.com/projects/aucun/](http://www.paralint.com/projects/aucun/)是一个 GINA 实现，即使其他人已经登录，它也可以授予您登录的权限。查看它可能是您正在寻找的东西，并且比在特定时间解锁工作站更安全。

作为替代方案，请考虑编写您自己的 GINA 实现，该实现将在预定时间进行解锁。

吉娜信息

[http://msdn.microsoft.com/en-gb/magazine/cc163803.aspx](http://msdn.microsoft.com/en-gb/magazine/cc163803.aspx)

[http://msdn.microsoft.com/en-us/magazine/cc163786.aspx](http://msdn.microsoft.com/en-us/magazine/cc163786.aspx)

在你解锁桌面后，我很确定你会想要再次锁定它。

[http://www.codeproject.com/win32/AntonioWinLock.asp](http://www.codeproject.com/win32/AntonioWinLock.asp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T13:31:55.893

只是为了添加另一个线索（没有任何判断），[autoit](http://www.autoitscript.com/autoit3/)（一种脚本 Windows 语言）可能有答案，如该线程中所述：

[如何解锁 Xp 桌面](http://www.autoitscript.com/forum/index.php?showtopic=53154&mode=threaded)

我刚刚发现了另[一种可能想要解锁桌面的场景](http://www.bauer-power.net/2007/06/use-autoit-and-stick-it-to-man.html)；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T13:20:33.030

让您的应用程序作为服务运行，然后您不需要用户/密码，因为这是使用服务设置的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-28T19:56:59.757

对于我的情况，我需要在断开终端会话后能够恢复控制台会话（我正在连接到带有触摸屏但没有键盘的 WinXPe 信息亭）。

这是我发现可行的命令行解决方案。我没有关闭会话窗口以断开连接，而是使用以下行运行批处理文件。我的会话已关闭，控制台会话已解锁。

*   在 WinXP 上的终端会话后自动解锁工作站

    ```
    tscon.exe 0 /dest:console 
    ```

*   对于 Windows Vista/7，控制台会话编号已从 0 更改为 1，因此您需要使用

    ```
    tscon.exe 1 /dest:console 
    ```

来源链接：[http ://arstechnica.com/civis/viewtopic.php?f=15&t=69113](http://arstechnica.com/civis/viewtopic.php?f=15&t=69113)

# email - 如何使用 .NET Compact Framework 打开新电子邮件并指定主题

> ID：174232
> 
> 赞同：7
> 
> 时间：2008-10-06T13:14:30.423
> 
> 标签：email, windows-mobile, compact-framework, pocketpc

基本上，我正在尝试完成与“mailto:bgates@microsoft.com”在 Internet Explorer Mobile 中所做的相同的事情。

但我希望能够从托管的 Windows Mobile 应用程序中执行此操作。我不想在后台以编程方式发送电子邮件。

我希望能够在 Pocket Outlook 中创建电子邮件，然后让用户完成其余的工作。

希望对您有所帮助，希望对我有所帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T13:36:37.633

我假设你使用 C#。添加对 System.Diagnostics 的引用，然后编写以下代码：

```
ProcessStartInfo psi = 
  new ProcessStartInfo("mailto:bla@bla.com?subject=MySubject", "");
Process.Start(psi); 
```

这将在您的移动设备上启动默认电子邮件客户端。

[mailto 协议定义](http://msdn.microsoft.com/en-us/library/aa767737(VS.85).aspx)也可能派上用场。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T14:44:27.913

您还可以像这样使用 Microsoft.WindowsMo​​bile.PocketOutlook.MessagingApplication.DisplayComposeForm：

```
OutlookSession sess = new OutlookSession();
EmailAccountCollection accounts = sess.EmailAccounts;
//Contains all accounts on the device  
//I'll just choose the first one -- you might want to ask them
MessagingApplication.DisplayComposeForm(accounts[0], 
    "someone@somewhere.com", "The Subject", "The Body"); 
```

DisplayComposeForm 方法有很多重载选项，包括附件选项等。

# asp.net - 在 ASP.NET 2.0/3.5 中向 aspx 页面发送数据的最佳方式？

> ID：174238
> 
> 赞同：0
> 
> 时间：2008-10-06T13:16:35.830
> 
> 标签：asp.net

哪种是将数据发送到 aspx 页面的最佳方式，**为什么**？

*   使用查询字符串
*   使用会话
*   使用跨页回发
*   别的东西

谢谢。

* * *

> 你想达到什么目的？更多信息。请

例如搜索表单和高级搜索表单或多步用户注册。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T13:33:35.580

这在很大程度上取决于您的用途。

*   使用查询字符串

查询字符串数据是一种发送数据的好方法，它对保持安全并不重要。这可能是传递用户应该能够看到的数据的最佳和最简单的方法，如果他们尝试更改查询字符串数据，这不是问题。分页数据和排序信息在这里很好。搜索参数和用户请求的信息可以很好地放在这里。

*   使用会话

会话是存放用户特定信息的最佳场所，在用户使用网站时将不止一次需要这些信息。它非常适合不需要非常安全但需要在用户访问站点期间与用户相关联的信息。

*   使用跨页回发

使用回发的一个危险是它会在幕后发送此信息。这是传递信息的好方法，但可能不是最好的。跨页回发要求下一页处理传递给它的信息。这会在页面之间创建脆弱的连接以及用户在刷新页面时必须重新发送发布的数据的问题。如果没有发布的数据，页面是否仍然有效？

*   别的东西

Cookie 可以工作，但它们绝不应该包含任何需要安全的信息。还有很多其他的应该在不同的时间使用。您可以阅读有关每种数据传递方式的整篇文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T13:24:35.737

取决于什么样的数据，以及接收到数据时采取什么样的动作。查询字符串是向服务器发送数据的最简单、最标准和最常用的方式。下一个问题是您使用 POST 或 GET 哪种方法。作为一般经验法则，您可以采取以下措施：当请求将导致更改服务器状态的操作时使用 POST，当您仅从服务器检索数据时使用 GET。

# c# - C# 默认范围解析

> ID：174239
> 
> 赞同：6
> 
> 时间：2008-10-06T13:16:44.363
> 
> 标签：c#, linker, alias, scope-resolution, name-clash

我继承了与 BCL 类“Windows.Forms.Button”冲突的 ac# 类“Button”（我无法更改）。通常，我很乐意去：

```
MyPackage.MyClass.Button; 
```

但是有大量或对此类的引用，这很痛苦，必须重新输入。

有没有办法让编译器（链接器？）默认使用自定义版本的 Button 而不是 BCL 版本？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-06T13:22:18.300

将此添加到文件顶部：

```
using MyButton = MyPackage.MyClass.Button; 
```

现在您可以使用不同的名称引用您的自定义按钮。如果您在同一文件中的任何位置使用股票按钮，您可能需要对股票按钮执行类似的操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T13:25:31.210

如果您想默认使用它，请替换

```
using Windows.Forms; 
```

和

```
using MyPackage.MyClass; 
```

如果这样做，则需要完全限定 Windows.Forms 中的所有按钮。

或者，如果您愿意，您可以为命名空间设置别名

```
using My = MyPackage.MyClass;
//... then
My.Button b = ... 
```

或者给按钮起别名

```
using MyButton = MyPackage.MyClass.Button; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T13:20:22.830

您可以`using Windows.Forms;`从代码顶部删除。这当然意味着您必须专门引用所有 Windows.Forms 项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T13:24:22.913

您至少可以通过“使用”使其不那么痛苦/罗嗦：

```
using MPMC = MyPackage.MyClass; 
```

那么你可以说：

```
MPMC.Button 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T13:30:07.130

看来我可以做到以下几点：

```
using Button = MyPackage.MyClass.Button; 
```

有效，它保留了代码中对 Button 的所有引用。尽管我很想不走这条路，因为它仍然模棱两可（至少对读者来说）正在使用哪个 Button。

# programming-languages - 为 Windows 脚本宿主 (WSH) 编写语言

> ID：174240
> 
> 赞同：6
> 
> 时间：2008-10-06T13:16:53.710
> 
> 标签：programming-languages, wsh, scripting-language

有没有人有过`WSH`以 , , 和（以及其他）方式进行定位的`VBScript`经验`JScript`，以便`PerlScript`可以从命令行使用该语言并嵌入到服务器端网页中？我该去哪里获得这样的信息？`xbScript``ForthScript`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T13:21:42.983

这些称为[Windows 脚本引擎](http://msdn.microsoft.com/en-us/library/xawadt95(VS.85).aspx)，通过 COM 公开引擎来实现。[MSDN](http://msdn.microsoft.com/en-us/library/t9d4xf28(VS.85).aspx)上有很多文档，实际的界面相当简单。

# firefox - 如何创建类似 Firebug 的底部窗口 Firefox 扩展

> ID：174243
> 
> 赞同：6
> 
> 时间：2008-10-06T13:17:18.700
> 
> 标签：firefox, firefox-addon, xul

一些扩展提供了一个“底部窗口”来查看它们的内容。Firebug 和 ScribeFire 是主要内容出现在浏览器底部的很好的例子。这似乎与浏览器中的侧边栏功能非常相似。

是否有在扩展程序中创建底部窗口的最佳实践/方法，因为浏览器没有“底部侧边栏”？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T15:50:07.877

您将使用 Overlay 创建扩展 UI。在叠加层中，您可以指定 UI 相对于主浏览器页面 browser.xul 的插入点。

摘自 Firefox 的主页 browser.xul 我们有

```
<vbox id="appcontent" flex="1">
    <tabbrowser id="content" disablehistory="true"
                flex="1" contenttooltip="aHTMLTooltip"
                contentcontextmenu="contentAreaContextMenu"
                onnewtab="BrowserOpenTab();"
                autocompletepopup="PopupAutoComplete"
                ondragdrop="nsDragAndDrop.drop(event, contentAreaDNDObserver);"
                onclick="return contentAreaClick(event, false);"
                />
  </vbox> 
```

并摘自之前版本的 Firebug 文件 browserOverlay.xul 我们有

```
<vbox id="appcontent">
    <splitter id="fbContentSplitter" collapsed="true"/>
    <vbox id="fbContentBox" collapsed="true" persist="height">
        <toolbox id="fbToolbox">
            <toolbar id="fbToolbar">
                <toolbarbutton id="fbFirebugMenu" type="menu">
                    <menupopup onpopupshowing="return FirebugChrome.onOptionsShowing(this);">
                        <menuitem label="&firebug.DisableFirebug;" type="checkbox"
                                  oncommand="FirebugChrome.onToggleOption(this)" option="disabledAlways"/>
                        <menuitem type="checkbox"
                                  oncommand="FirebugChrome.onToggleOption(this)" option="disabledForSite"/>
                        <menuitem label="&firebug.AllowedSites;" command="cmd_openFirebugPermissions"/>
                        <menuseparator/>

                        <menu label="&firebug.TextSize;">
                            <menupopup>
                                <menuitem label="&firebug.IncreaseTextSize;"
                                          oncommand="Firebug.increaseTextSize(1)"/>
                                <menuitem label="&firebug.DecreaseTextSize;"
                                          oncommand="Firebug.increaseTextSize(-1)"/>
                                <menuitem label="&firebug.NormalTextSize;" oncommand="Firebug.setTextSize(0)"/>
                            </menupopup>
                        </menu>

                        <menu label="&firebug.Options;">
                            <menupopup onpopupshowing="return FirebugChrome.onOptionsShowing(this);">
                                <menuitem type="checkbox" label="&firebug.AlwaysOpenInWindow;"
                                           oncommand="FirebugChrome.onToggleOption(this)"
                                           option="openInWindow"/>

                                <menuitem type="checkbox" label="&firebug.ShowTooltips;"
                                           oncommand="FirebugChrome.onToggleOption(this)"
                                           option="showInfoTips"/>

                                <menuitem type="checkbox" label="&firebug.ShadeBoxModel;"
                                          oncommand="FirebugChrome.onToggleOption(this)"
                                          option="shadeBoxModel"/>
                            </menupopup>
                        </menu>
                        <menuseparator/>

                        <menuitem label="&firebug.Website;" oncommand="Firebug.visitWebsite('main')"/>
                        <menuitem label="&firebug.Documentation;" oncommand="Firebug.visitWebsite('docs')"/>
                        <menuitem label="&firebug.Forums;" oncommand="Firebug.visitWebsite('discuss')"/>
                        <menuseparator/>
                        <menuitem label="&firebug.Donate;" oncommand="Firebug.visitWebsite('donate')"/>
                    </menupopup>
                </toolbarbutton>

                <toolbarbutton id="fbDetachButton" class="toolbarbutton-iconic"
                               tooltiptext="&firebug.DetachFirebug;" command="cmd_detachFirebug"/>

                <toolbarbutton id="fbCloseButton" class="toolbarbutton-iconic"
                               tooltiptext="&firebug.CloseFirebug;" command="cmd_toggleFirebug"/>
            </toolbar>
        </toolbox>

        <hbox id="fbPanelBox" flex="1"/>
        <hbox id="fbCommandBox"/>
    </vbox>
</vbox> 
```

请注意，XUL 标记的两个块都以

```
<vbox id="appcontent".../> 
```

这就是 Gecko 引擎用来确定覆盖如何与被覆盖的页面相匹配的方法。如果您查看 browserOverlay.xul，您还会看到其他插入点`commandset, statusbar`，等等。

有关详细信息，请参阅[Mozilla 开发人员中心](http://developer.mozilla.org/En)。

# database - 跟踪用户最近活动的策略

> ID：174248
> 
> 赞同：10
> 
> 时间：2008-10-06T13:19:07.527
> 
> 标签：database, database-design, user-input, n-tier-architecture

我们的客户想知道**谁**在线并且当前正在使用我们为他们编写的自定义应用程序。我和他们讨论过，这不需要很**准确**，更多的猜测会起作用。

所以我的想法是确定用户活动的 15 分钟时间间隔。我这样做的一些想法如下：

1.  每次他们执行访问数据库或请求网页的操作时，用他们上次活动的日期和时间标记他们的用户记录......虽然这可能是数据库密集型的。

2.  从我们的软件发送“谁在线请求”，寻找响应，这可以在预定的时间间隔内完成，然后在用户记录上标记我收到的每个响应的当前日期和时间。

你怎么认为？您将如何处理这种情况？

**澄清**

如果可能的话，我想为 Windows 或 Web 使用相同的架构。我有一个与多个用户界面交互的业务逻辑层，可以是 Windows 或 Web。

通过Windows，我的意思是客户端-服务器。

**澄清**

我使用的是 n 层架构，因此我的业务对象处理与表示层的所有交互。该表示层可以提供客户端-服务器 Windows 应用程序、Web 应用程序、Web 服务等。

它不是一个高流量的应用程序，因为它是为我们的一个客户开发的，最多可能有 100 个用户。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T18:11:51.010

我们的解决方案是除了我们的“会话”表（跟踪谁在这里）之外，还维护一个“事务”表（跟踪所做的事情）。UPDATE、INSERT 和 DELETE 指令都通过“事务”对象进行管理，一旦在数据库上成功执行，这些 SQL 指令中的每一个都将存储在“事务”表中（取决于更新的表：我们有可能专门遵循一些表格并忽略其他表格）。这个“Transaction”表还有transactiontType（I代表INSERT，D代表DELETE，U代表UPDATE）、transactionDateTime等字段，还有一个外键“sessionId”，最后告诉我们是谁发出了指令。甚至可以通过一些代码来确定谁在何时做了什么（Gus 在周一创建了记录，

此解决方案的优点是：

1.  您可以说出“谁和什么时候”，并将其展示给您的用户！（您需要一些代码来分析 SQL 语句）
2.  如果你的数据被复制了，并且复制失败了，你可以通过这个表重建你的数据库

缺点是

1.  每月 100 000 次数据更新意味着 Tbl_Transaction 中有 100 000 条记录
2.  最后，该表往往占数据库容量的 99%

我们的选择：每天早上自动删除所有超过90天的记录

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T13:22:23.497

我以前见过策略 1 的工作。当然，网站很小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T15:43:20.433

我想知道像 stackoverflow 这样的网站是如何做到的？

他们必须针对一个特定的事件，因为我只是在网站上使用工具，看看我的个人资料，仍然会说**8 分钟前最后一次看到**的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T13:23:42.447

我只是在数据库中删除一个日志记录表。

UserId int FK
Action char(3) ('in' or 'out')
Time DateTime

当有人登录或注销时，您可以在表中删除一条新记录，或者更新用户的最后一条记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T13:24:11.400

我已经使用过许多使用您列出的第一种方法的系统，经过一些仔细的计划，它可以以一种实际上没有太大影响的方式完成。

这完全取决于您尝试跟踪的时间/方式/内容。如果您需要跟踪多个会话，我通常会看到使用绑定到用户帐户的会话系统的人，然后在特定的经过时间之前该会话被认为是无效的。

如果您确实正在寻找当前在线，那么您的第一个选择是最好的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T13:24:52.197

如果您有会话数据，请使用它。大多数会话系统已经有时间戳，因此它们可以使未使用 x 分钟的会话过期。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T13:30:10.280

您可以在每次创建用户会话时增加一个全局变量，并在它被销毁时减少它。这样，您将**始终**知道在任何特定时刻有多少用户在线。

另一方面，如果您想随着时间的推移对其进行监控，我认为将会话开始和结束记录到数据库是最好的选择，并且您可以在事后通过简单的查询来计算用户活动。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T13:35:10.973

[免责声明 1 --- Java 解决方案]

如果给每个有意义的用户一个 Session，那么您可以编写自己的 SessionListener 实现来跟踪每个已创建和销毁的会话。

[免责声明 2 --- 代码未经测试或编译]

```
public class ActiveSessionsListener implements HttpSessionListener {
    public void sessionCreated(HttpSessionEvent e) {
        ServletContext ctx = e.getSession().getServletContext();
        synchronized (ctx) {
            Integer count = ctx.getAttribute("SESSION_COUNT");
            if (count == null) { count = new Integer(0); }
            ctx.setAttribute("SESSION_COUNT", new Integer(count.intValue() + 1);
        }
    }
    public void sessionDestroyed(HttpSessionEvent e) {
        ... similar for decrement ...    
    }
} 
```

并在您的 web.xml 中注册：

```
<listener-class>com.acme.ActiveSessionsListener</listener-class> 
```

希望这可以帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T13:45:30.797

Web 应用程序解决方案的唯一问题是您通常不知道何时有人退出。显然，如果您有登录/身份验证要求，您可以捕获某人何时登录，并且作为您的数据访问代码的一部分，您可以在某人访问数据库时进行登录。但是您将不得不接受当一个人注销时会有可靠的捕获方式 - 许多人会离开该站点而不采取“注销”操作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T13:48:26.033

我想使用触发器将是一个合理的选择，它可以使您不必处理 Web 和非 Web 环境（或任何其他环境）之间的任何逻辑差异。但是，这仅捕获对环境的更改，并且在执行 select 语句时不做任何事情。但是，如果您的应用程序中的所有命令都通过存储过程运行，则可以克服这一点。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-07T14:30:46.930

对于网络应用程序，“在线”的概念有点模糊。您真正能做的最好的事情是“在最后 X 分钟内提出请求”或者“在最后 X 分钟内通过身份验证”。

选择一组事件（发出请求、执行更新、已验证...），并将它们记录到数据库表中。

**将它们记录到单独数据库中的表中**

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-03-24T13:29:53.697

我刚刚为我的网站实施了最后一次看到的系统。您的第一个选项类似，但我仅每 +-5 分钟更新一次。它适用于我的情况，但大型网站可能需要一些额外的东西。

```
<?php
function updateLastSeen($user_ref, $session_id, $db) { /*Parameters: The user's primary key, the user's session id, the connection to the database*/
  $timestamp = date('Y-m-d H:i:s');
  if ($session_id !== '') {
    /*logged in*/
    $sql_check = "SELECT user_id FROM user_last_seen WHERE user_id = ?";
    $stmt_check = $db->prepare($sql_check);
    $stmt_check->bind_param('s', $user_ref);
    $result_check = $stmt_check->execute();
    $stmt_result_check = $stmt_check->get_result();
    if ($stmt_result_check->num_rows > 0) { /*If the user's last seen was previously recorded, update his record*/
      $sql = "UPDATE user_last_seen SET last_seen = ? WHERE user_id = ?"; 
    } else { /*Otherwise, insert a record for him*/
      $sql = "INSERT INTO user_last_seen (last_seen, user_id) VALUES (?,?)";
    }
    $stmt = $db->prepare($sql);
    $stmt->bind_param('ss', $timestamp, $user_ref);
    $result = $stmt->execute();
  }
}
if( !isset($_SESSION['lastSeen']) ){ /*User logs into the website or lands on the current page, create a lastSeen variable*/
  $_SESSION['lastSeen'] = time();
  updateLastSeen($user_ref, $session_id, $db);
} else {
  $last_seen_time_difference = (time() - $_SESSION['lastSeen']) / 60;
  if ($last_seen_time_difference > 5) { //if the difference between now and the lastSeen is 5 minutes or more, record his last seen.
    updateLastSeen($user_ref, $session_id, $db);   
    $_SESSION['lastSeen'] = time(); /*after updating the database, reset the lastSeen time to now.*/
  }/* else {
    //do nothing. Don't update database if lastSeen is less than 5 minutes ago. This prevents unnecessary database hits.
  }*/
} 
```

# .net - 使用 dotnet 加载和保存位图

> ID：174263
> 
> 赞同：2
> 
> 时间：2008-10-06T13:23:46.177
> 
> 标签：.net, graphics

这可能很简单，但 5 分钟的谷歌搜索并没有给我答案。如何使用 .Net 库保存和加载位图？

我有一个 Image 对象，我需要将它以某种格式（最好是 png）保存到磁盘并稍后再加载。AC# 的例子会很棒。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T13:26:56.527

这是一个非常简单的例子。

**代码文件顶部**

```
using System.Drawing; 
```

**在代码中**

```
Image test = new Bitmap("picture.bmp");
test.Save("picture.png", System.Drawing.Imaging.ImageFormat.Png); 
```

请记住向 ASPNET 用户授予要保存图像的文件夹的写入权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T13:27:16.323

嗨，使用 Image.Save() 方法。

可以在这里找到比我能提供的更好的解释和代码示例：

[MSDN](http://msdn.microsoft.com/en-us/library/system.drawing.image.save.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T13:26:03.567

大约 10 秒的 google 将我带到了[这个保存方法的例子](http://msdn.microsoft.com/en-us/library/9t4syfhh.aspx)，你可以为其他人多挖一点。

# visual-studio - 打开解决方案时如何防止VS 2008打开文件

> ID：174285
> 
> 赞同：3
> 
> 时间：2008-10-06T13:28:20.317
> 
> 标签：visual-studio

当我在 VS 2008 中打开一个解决方案时，我不希望它打开我上次打开的所有文件。我只是想让它打开解决方案。看不到这个配置选项，有可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T13:32:30.590

删除 .suo 文件...

请参阅[是否有告诉 Visual Studio 在我加载解决方案时不要打开所有文档？](https://stackoverflow.com/questions/148143/is-there-anyway-to-tell-visual-studio-not-to-open-all-the-documents-when-i-load)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T13:33:37.217

通过为 EnvDTE.SolutionEvents 的 BeforeClosing 事件添加处理程序，您可以在关闭解决方案之前自动关闭所有文件的过程——这将在 VS 退出时被调用。

在 VS2005 中，在 EnvironmentEvents 宏模块中添加以下内容将关闭所有打开的文档：

```
Private Sub SolutionEvents_BeforeClosing() Handles SolutionEvents.BeforeClosing
    DTE.ExecuteCommand("Window.CloseAllDocuments")
End Sub 
```

Visual Studio 2008 似乎支持相同的事件，所以我相信这也适用。

我敢肯定，如果需要，您也可以在处理程序中删除项目的 .suo 文件，但您可能需要 AfterClosing 事件。

# graphics - 动态（算法）图形技术

> ID：174289
> 
> 赞同：6
> 
> 时间：2008-10-06T13:29:06.040
> 
> 标签：graphics, user-interface, embedded, svg

我正在为[具有有限内存](http://www.microchip.com/stellent/idcplg?IdcService=SS_GET_PAGE&nodeId=2591)（512k 闪存，32k RAM）的 32 位处理器编写应用程序。

该设备上的[显示](http://www.newhavendisplay.com/index.cfm/page/ptype=product/product_id=524/category_id=240/home_id=165/mode=prod/prd524.htm)为 128x160 和 16 位颜色，如果我要在处理器上缓冲它，通常会消耗 40k 内存。我没有那么多内存，所以我正在寻找动态生成屏幕数据的技术、技巧、窍门和想法。

可能有帮助的事情：

*   也许您知道这种限制的资源
*   也许您已经动态生成了有吸引力的图形
*   在我扫描显示器时，是否有一种通用算法可以用来即时组合程序内存中的元素（包括 alpha 混合）
*   简单的矢量渲染技术（或免费（bsd/mit/apache）源码）
*   ？？？

我有一个乘法器，但没有浮点处理器。显示器本身有一个非常简单的控制器和用于显示器的内存——但是读取和写入很昂贵，所以如果可以避免的话，我不想将它用作我的工作区。

-亚当

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T13:41:14.423

在某种程度上，您与 Tandys、Spectrums 和早期 PC 时代的游戏开发人员几乎相同。所以，这是我的建议：

您应该阅读 Michael Abrash 关于计算机图形学的著作。它们是在浮点协处理器是可选硬件的时代编写的，它们描述了在旧的（据说是“糟糕的”）软件渲染时代使用的许多基本技术（Bresenham 线等） .

[你可以在这里](http://www.byte.com/abrash/)阅读他的大部分“黑皮书” 。

此外，您可能还可以在这里找到许多过去大多数人用来学习图形编程的旧 BBS[文件](http://www.textfiles.com/directory.html)。只需搜索图形、线条等等。

希望有帮助！

**更新：**我还记得在我第一次尝试在屏幕上绘制东西时使用它[。](http://tfpsly.free.fr/Docs/3dIca/3dica.htm)不知道我花了多少时间试图理解它背后的数学（好吧，公平地说，我当时像 15 岁）。非常好的（和简单的）3D 介绍，以及关于转换、多边形填充和插值的非常好的首映。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T13:44:55.557

你会在屏幕上显示什么样的数据？

如果不是摄影图像，您可以考虑使用调色板。例如：每像素使用 8 位的 256 调色板将需要 20kb，（加上查找表的 256 x 2 字节）至少优于 40kb。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T14:17:27.300

我相信处理这种情况的基本技术是将屏幕分成窄的水平条纹，并且只在 RAM 中缓冲两个这样的条纹。将显示一条条纹，同时向下渲染下一条。当扫描“光束”击中下一个条纹（并触发中断让您捕捉）时，您交换两者并开始绘制下一个条纹。

这样做的一个令人讨厌的副作用是，您对渲染每个条带所花费的时间有*严格的*时间限制。所以我想坚持一些无聊但具有可预测性能的东西会很诱人，比如精灵。

有点离题，但这就是 Nintendo DS 3D 硬件的工作原理。如果您尝试在同一 y 坐标周围渲染太多多边形，您可以看到它 - 当屏幕刷新超过渲染硬件时，多边形会随机闪烁并退出。

另外，我赞同另一张海报的建议，即您使用调色板渲染。在 16 位像素上进行快速数学运算非常困难，但如果您对如何布置调色板很聪明，则在 8 位像素上会更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-26T14:45:42.237

一些将漂亮的图形和低内存结合起来的想法：

*   将背景和精灵存储在 Flash 中。
*   使用调色板将动态生成的图形存储到 RAM 中的一半字节。
*   使用 LCD 驱动程序的窗口功能仅更新您需要的屏幕部分。

# arrays - 在 Perl 中从数组中删除值的最佳方法是什么？

> ID：174292
> 
> 赞同：83
> 
> 时间：2008-10-06T13:29:55.743
> 
> 标签：arrays, perl

该数组有很多数据，我需要删除两个元素。

下面是我正在使用的代码片段，

```
my @array = (1,2,3,4,5,5,6,5,4,9);
my $element_omitted = 5;
@array = grep { $_ != $element_omitted } @array; 
```

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-10-06T13:37:05.963

如果您已经知道要删除的元素的索引，请使用 splice。

如果您正在搜索，Grep 可以工作。

如果你需要做很多这些，如果你保持你的数组排序，你会得到更好的性能，因为你可以进行二进制搜索来找到必要的索引。

如果在您的上下文中有意义，您可能需要考虑对已删除的记录使用“魔术值”，而不是删除它们，以节省数据移动——例如，将已删除的元素设置为 undef。当然，这有其自身的问题（如果您需要知道“活动”元素的数量，则需要单独跟踪它等），但根据您的应用程序可能值得麻烦。

**编辑**实际上，现在我再看一遍——不要使用上面的 grep 代码。找到要删除的元素的索引，然后使用 splice 删除它会更有效（您的代码会累积所有不匹配的结果..）

```
my $index = 0;
$index++ until $arr[$index] eq 'foo';
splice(@arr, $index, 1); 
```

这将删除第一次出现。删除所有匹配项非常相似，只是您希望一次性获取所有索引：

```
my @del_indexes = grep { $arr[$_] eq 'foo' } 0..$#arr; 
```

剩下的留给读者练习——记住数组在拼接时会发生变化！

**Edit2** John Siracusa 正确地指出我的示例中有一个错误.. 已修复，对此感到抱歉。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-06T13:30:44.040

[splice](http://www.perlmonks.org/?node=perlfunc%3Asplice)将按索引删除数组元素。如您的示例所示，使用 grep 进行搜索和删除。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-06T13:47:56.017

这是你要做的很多事情吗？如果是这样，您可能需要考虑不同的数据结构。Grep 每次都会搜索整个数组，对于一个大数组可能会非常昂贵。如果速度是一个问题，那么您可能需要考虑使用 Hash。

在您的示例中，键是数字，值是该数字的元素计数。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-07T07:35:15.513

如果你改变

```
my @del_indexes = grep { $arr[$_] eq 'foo' } 0..$#arr; 
```

到

```
my @del_indexes = reverse(grep { $arr[$_] eq 'foo' } 0..$#arr); 
```

这通过首先从数组后面删除元素来避免数组重新编号问题。将 splice() 放入 foreach 循环中会清理 @arr。比较简单易读...

```
foreach $item (@del_indexes) {
   splice (@arr,$item,1);
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-11-20T19:34:52.423

您可以使用数组切片而不是拼接。Grep 返回您想要保留的索引并使用切片：

```
my @arr = ...;
# run through each item.
my @indicesToKeep = grep { $arr[$_] ne 'foo' } 0..$#arr;
@arr = @arr[@indicesToKeep]; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-04-19T12:52:59.373

我发现最好的是“undef”和“grep”的组合：

```
foreach $index ( @list_of_indexes_to_be_skiped ) {
      undef($array[$index]);
}
@array = grep { defined($_) } @array; 
```

这样就行了！费德里科

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-08-02T09:11:00.123

你可以简单地这样做：

```
my $input_Color = 'Green';
my @array = qw(Red Blue Green Yellow Black);
@array = grep {!/$input_Color/} @array;
print "@array"; 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-06T15:50:15.147

## 我认为您的解决方案是最简单和最可维护的。

这篇文章的其余部分记录了将元素测试转换为`splice`偏移量的困难。因此，使其成为更*完整*的答案。

看看你必须经历的***回转***才能有一个有效的（即一次性）算法来将列表项的测试转换为索引。而且它根本不是那么直观。

```
sub array_remove ( \@& ) { 
    my ( $arr_ref, $test_block ) = @_;
    my $sp_start  = 0;
    my $sp_len    = 0;
    for ( my $inx = 0; $inx <= $#$arr_ref; $inx++ ) {
        local $_ = $arr_ref->[$inx];
        next unless $test_block->( $_ );
        if ( $sp_len > 0 && $inx > $sp_start + $sp_len ) {
            splice( @$arr_ref, $sp_start, $sp_len );
            $inx    = $inx - $sp_len;
            $sp_len = 0;
        }
        $sp_start = $inx if ++$sp_len == 1;
    }
    splice( @$arr_ref, $sp_start, $sp_len ) if $sp_len > 0;
    return;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-08-10T16:50:44.123

如果数组，则删除所有出现的“某事”。

**基于 SquareCog 的回答：**

```
my @arr = ('1','2','3','4','3','2', '3','4','3');
my @dix = grep { $arr[$_] eq '4' } 0..$#arr;
my $o = 0;
for (@dix) {
    splice(@arr, $_-$o, 1);
    $o++;
}
print join("\n", @arr); 
```

每次我们从中删除索引时`@arr`，下一个要删除的正确索引将是`$_-current_loop_step`。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-02-08T05:41:21.533

我用：

```
delete $array[$index]; 
```

Perldoc[**删除**](http://perldoc.perl.org/functions/delete.html).

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-04-11T16:29:21.310

您可以使用非捕获组和要删除的项目的管道分隔列表。

```
 perl -le '@ar=(1 .. 20);@x=(8,10,3,17);$x=join("|",@x);@ar=grep{!/^(?:$x)$/o} @ar;print "@ar"' 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-02-15T20:29:40.133

只是为了确保我已经对 grep 和 map 解决方案进行了基准测试，首先搜索匹配元素的索引（要删除的元素），然后通过 grep 直接删除元素而不搜索索引。我看起来山姆在问他的问题时提出的第一个解决方案已经是最快的了。

```
 use Benchmark;
    my @A=qw(A B C A D E A F G H A I J K L A M N);
    my @M1; my @G; my @M2;
    my @Ashrunk;
    timethese( 1000000, {
      'map1' => sub {
          my $i=0;
          @M1 = map { $i++; $_ eq 'A' ? $i-1 : ();} @A;
      },
      'map2' => sub {
          my $i=0;
          @M2 = map { $A[$_] eq 'A' ? $_ : () ;} 0..$#A;
      },
      'grep' => sub {
          @G = grep { $A[$_] eq 'A' } 0..$#A;
      },
      'grem' => sub {
          @Ashrunk = grep { $_ ne 'A' } @A;
      },
    }); 
```

结果是：

```
Benchmark: timing 1000000 iterations of grem, grep, map1, map2...
  grem:  4 wallclock secs ( 3.37 usr +  0.00 sys =  3.37 CPU) @ 296823.98/s (n=1000000)
  grep:  3 wallclock secs ( 2.95 usr +  0.00 sys =  2.95 CPU) @ 339213.03/s (n=1000000)
  map1:  4 wallclock secs ( 4.01 usr +  0.00 sys =  4.01 CPU) @ 249438.76/s (n=1000000)
  map2:  2 wallclock secs ( 3.67 usr +  0.00 sys =  3.67 CPU) @ 272702.48/s (n=1000000)
M1 = 0 3 6 10 15
M2 = 0 3 6 10 15
G = 0 3 6 10 15
Ashrunk = B C D E F G H I J K L M N 
```

如经过的时间所示，尝试使用 grep 或 map 定义的索引来实现删除功能是没有用的。直接 grep-remove 即可。

在测试之前，我认为“map1”将是最有效的......我猜我应该更频繁地依赖基准测试。;-)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-06T13:41:38.153

如果你知道数组索引，你可以[delete()](http://perldoc.perl.org/functions/delete.html)它。splice() 和 delete() 之间的区别在于 delete() 不会对数组的剩余元素重新编号。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-03-13T09:13:52.343

我曾经写过一个类似的代码，用于从字符串数组中删除不以 SB.1 开头的字符串

```
my @adoSymbols=('SB.1000','RT.10000','PC.10000');
##Remove items from an array from backward
for(my $i=$#adoSymbols;$i>=0;$i--) {  
    unless ($adoSymbols[$i] =~ m/^SB\.1/) {splice(@adoSymbols,$i,1);}
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-04-24T01:02:17.397

这也很好用：

```
my @array = (1,2,3,4,5,5,6,5,4,9);
my $element_omitted = 5;
for( my $i = 0; $i < scalar( @array ); $i++ )
{
    splice( @array, $i ), $i-- if( $array[$i] == $element_omitted );
}
say "@array"; # 1 2 3 4 6 4 9 
```

# sql - Oracle：使用 to_lob 从 user_ind_expressions 转换 column_expression 时出现 ORA-00932

> ID：174297
> 
> 赞同：2
> 
> 时间：2008-10-06T13:30:41.530
> 
> 标签：sql, oracle, insert, ora-00932

尝试在 Oracle 10.2 上运行这两个简单的语句：

```
CREATE TABLE mytest
   (table_name varchar2(30), 
   index_name varchar2(30), 
   column_expression clob,
   column_position number);

INSERT INTO mytest 
  (table_name,
   index_name,
   column_expression, 
   column_position) 
SELECT table_name, index_name,
       to_lob(column_expression), column_position 
FROM user_ind_expressions EXPRA 
WHERE NOT EXISTS 
   (SELECT 1 FROM user_constraints 
    WHERE constraint_name = EXPRA.index_name 
    AND table_name = EXPRA.table_name); 
```

这会导致此错误：

第 1 行的错误：ORA-00932：不一致的数据类型：预期 - 得到 LONG

如果我像这样省略 WHERE NOT EXISTS：

```
INSERT INTO mytest 
   (table_name,index_name,column_expression, column_position) 
SELECT table_name,index_name,
       to_lob(column_expression), column_position 
FROM user_ind_expressions EXPRA; 
```

有用：

创建了 23 行。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T18:07:01.923

如果 Michel Cadot[说它](http://www.orafaq.com/forum/mv/msg/125912/352199/0/)是一个错误，那么几乎可以肯定它是一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T07:07:48.523

是的，好像是这样。

[http://www.orafaq.com/forum/m/352199/130782/#msg_352199](http://www.orafaq.com/forum/m/352199/130782/#msg_352199)

# java - 在同一个项目上同时使用 Eclipse 和 NetBeans

> ID：174308
> 
> 赞同：38
> 
> 时间：2008-10-06T13:34:39.117
> 
> 标签：java, eclipse, netbeans

Eclipse 是一个非常棒的编辑器，我更喜欢使用它，但是缺少 Eclipse 的 GUI 设计工具。另一方面，NetBeans 非常适合 GUI 设计。

使用 NetBeans 进行 GUI 设计和使用 Eclipse 进行同一项目中的其他所有操作是否有任何提示、技巧或陷阱？

**编辑：**我尝试了 Maven，但它似乎不起作用（对我的需要来说太复杂了）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-29T11:50:07.193

使用 Netbeans 创建您的 GUI。将 Eclipse .project 文件（如下所示）复制到项目文件夹中，更改 MyProjectName。打开 Eclipse 并将项目导入您的工作区，这样您就可以使用 Netbeans 从 Eclipse 工作区打开项目。现在您可以使用 Netbeans 创建和更改 GUI 并使用 Eclipse 编辑代码。

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
 <name>MyProject</name>
 <comment></comment>
 <projects>
 </projects>
 <buildSpec>
  <buildCommand>
   <name>org.eclipse.jdt.core.javabuilder</name>
   <arguments>
   </arguments>
  </buildCommand>
 </buildSpec>
 <natures>
  <nature>org.eclipse.jdt.core.javanature</nature>
 </natures>
</projectDescription> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T13:55:04.053

MyEclipse 提供了 Netbeans GUI 编辑器 (Matisse) 与 Eclipse 的集成。

见[http://www.myeclipseide.com/module-htmlpages-display-pid-5.html](http://www.myeclipseide.com/module-htmlpages-display-pid-5.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T15:23:17.230

回应@Tom 我会使用外部构建工具（Maven 2 是我的选择）。我以前在项目上做过这个，只要你不走遍 Eclipse 的 .Xxxx 文件和文件夹，你会没事的。然后，您将获得 Netbeans（与 Maven 2*非常*好地集成）或 Eclipse 的全部功能，并且还具有外部构建的附加值，它也可以由您的 CI 工具运行。每个人都赢了！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T04:02:16.060

Cloud Garden 制作了一个名为[Jigloo](http://www.cloudgarden.com/jigloo/)的 GUI 编辑器，如果您喜欢这类东西，它会非常好（而且价格非常非常合理）。如果这就是 Eclipse 所缺少的一切，我建议您看一下。Netbeans 用你不允许编辑的源代码做了大量的事情，等等......

我要提到的另一件事是：我使用了像 Matisse 和 Jigloo 这样的 GUI 编辑器来进行超快速原型设计。然而，在 3 或 4 次迭代中，我总是发现自己退回到手工编写布局。我还发现，当我进行快速原型设计时，当我将布局管理器更改为绝对布局并仅放置组件时，我几乎总是更有效率。一旦设计启动凝胶，使用良好的布局管理器（我强烈推荐[MiG Layout](http://www.miglayout.com/)）通过手动编码实现设计非常容易，并且可以提供更好的结果。

我知道拖放 GUI 布局确实很诱人——但 MiG Layout 对于手工布线 GUI 的效率非常高，而且我怀疑几乎所有开发人员在沿着这条路走下去的一周内都会更有效率。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-20T15:46:36.827

在netbeans中导入项目创建gui，然后再次在eclipse中打开项目

它可以正常工作

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T14:59:51.177

使用 Maven 定义项目依赖项，并使用它为 Netbeans 和 Eclipse 生成项目配置文件。

尝试为 Eclipse 和 Netbeans 保留单独的类目录，因为 Eclipse 不喜欢当外部工具接触它的类时。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T15:13:42.443

一些陷阱：

*   如果您尝试在没有任何插件/集成的情况下同时使用两者，则必须小心不要编辑标记为“请勿编辑”的区域，因为 Netbeans 会经常覆盖这些部分中的代码。
*   您应该使用“自定义...”命令为组件添加自定义初始化代码。
*   使用 Java 代码在表单上添加/创建新组件不会反映在 GUI 编辑器中。
*   必须阻止开发人员进入代码并添加摆动自定义，从而有效地绕过 GUI 编辑器。

另一个提示是，您可以使用 Eclipse 创建 Java Bean，然后将它们拖放到 Matisse 编辑器中。这允许您创建自定义 GUI 组件或非 GUI 组件（模型、侦听器等）并将其添加到 Matisse 表单。使用侦听器和模型，您可以指定组件以使用自定义侦听器/模型的实例而不是默认行为。您还可以拖放自定义 GUI 组件并像任何其他 GUI 小部件一样操作它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-20T00:53:00.460

对我来说，使用链接源文件夹效果很好。

我在独立的 NetBeans 项目中构建 GUI——如果他们需要一些简单的类或接口，我使用“链接源”（右键单击 NetBeans 中的项目，选择属性），将这些包含在 NetBeans 项目中。

我的主要项目在eclipse中。这里我再次使用链接源功能链接到 NetBeans 项目（在 eclipse 中右键单击项目，选择“构建路径”，然后选择“链接源”）。

编辑（感谢 Milhous :)）：在 eclipse 和 NetBeans 的两个项目中，所有必需的 JAR 文件都需要添加到构建路径（还有 NetBeans 添加的库：例如 beansbinding-1.2.1.jar、appframework-1.0\. 3.jar swing-worker-1.1.jar, ...)

现在可以在 eclipse 中重用 GUI 类。还导致需要将 GUI 和逻辑类完全解耦，这没什么不好。

# iphone - UITableView didSelectRow 在编辑时？

> ID：174309
> 
> 赞同：43
> 
> 时间：2008-10-06T13:35:07.730
> 
> 标签：iphone, cocoa-touch, uitableview

我正在构建一个界面，很像内置的 Weather 应用程序的反面视图，或处于编辑模式的 Clock 应用程序的 Alarms 视图。表格视图始终处于编辑模式，因此删除图标出现在每个单元格的左侧。

当表格视图处于编辑模式时，我的代表不会收到`didSelectRowAtIndexPath`通知。它接收`accessoryButtonTappedForRowWithIndexPath`通知，但这不是我想要做的。即使表格视图处于编辑模式，我也希望我的行保持可选状态。

关于我如何做到这一点的任何想法？

谢谢，

PS 万岁，取消 NDA。=)

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-10-06T14:49:09.717

设置`table.allowsSelectionDuringEditing`为`YES`。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-02-05T01:42:29.733

您也可以在属性检查器中进行设置。确保选择表格视图，而不是视图控制器，然后在编辑下拉菜单中选择“编辑期间的单选”：![在此处输入图像描述](https://i.stack.imgur.com/BcVgS.png)

# asp.net - asp:TextBox ReadOnly=true 还是 Enabled=false？

> ID：174319
> 
> 赞同：63
> 
> 时间：2008-10-06T13:38:30.687
> 
> 标签：asp.net, textbox, readonly, disabled-control

asp:TextBox 控件的 Enabled 和 ReadOnly-properties 有什么区别？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-10-06T13:39:54.613

如果一个控件是`disabled`它不能被编辑**并且**它的内容在提交表单时被排除。

如果一个控件是`readonly`它不能被编辑，但它的内容（如果有的话）仍然包含在提交中。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-01-17T22:01:13.237

另一种行为是`readonly = 'true'`控件将触发事件，例如`click`，按钮`Enabled = False`控件不会。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T13:39:29.170

Readonly 不会将文本框“变灰”，并且仍会在回发时提交该值。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-06T13:43:52.110

从浏览器的角度考虑它。对于只读，浏览器将发送一个变量/值对。对于残疾人，它不会。

运行这个，然后在你点击提交后查看 URL：

```
<html>
<form action=foo.html method=get>
<input name=dis type=text disabled value="dis">
<input name=read type=text readonly value="read">
<input name=normal type=text value="normal">
<input type=submit>
</form>
</html> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-08T12:59:12.683

Readonly 将允许用户从中复制文本。禁用不会。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-05-15T08:41:01.173

Asp.net 中的只读文本框

```
<asp:TextBox ID="t" runat="server" Style="margin-left: 20px; margin-top: 24px;"
Width="335px" Height="41px" ReadOnly="true"></asp:TextBox> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-09T18:09:18.070

我有一个执行地址查找服务器端的子 aspx 表单。然后，来自子 aspx 页面的值通过 javascript 客户端传递回父文本框。

尽管您可以看到文本框已更改，但 ReadOnly 或 Enabled 都不允许将值回发到父表单中。

# perforce - 如何从 Perforce 检索目录的大小？

> ID：174322
> 
> 赞同：18
> 
> 时间：2008-10-06T13:39:08.843
> 
> 标签：perforce

我想知道一个目录在从 Perforce 服务器带过来之前会消耗多少磁盘空间。除了获取文件并在文件管理器中查看目录的大小之外，我看不到任何其他方法。当然，这违背了目的。

有没有办法在不实际获取文件的情况下从 Perforce 获取文件大小信息？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-06T17:50:05.500

我不知道我是怎么错过这个命令的，但你是这样做的：

**p4 大小 -s //仓库/目录/...**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T13:42:32.737

[`p4 fstat`](http://www.perforce.com/perforce/doc.current/manuals/cmdref/fstat.html)

# maven-2 - xdoc和apt格式的比较优势

> ID：174325
> 
> 赞同：1
> 
> 时间：2008-10-06T13:39:41.200
> 
> 标签：maven-2, apt, xdoc

xdoc 和 apt 格式在编写 Maven 项目网站方面的相对优点是什么？一个比另一个更有表现力吗？有一个比另一个有更好的工具支持吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T13:50:35.247

XDOC 格式绝对是一种更丰富的文档创建机制，如果您想生成带有 TOC/TOF、页眉、页脚或脚注（以及其他文档属性）的文档，则需要 XDOC 格式，因为 APT 格式不支持这些。

话虽如此，我喜欢用 APT 格式编写几乎所有内部​​文档，因此我倾向于使用 APT 格式。与编写 XDOC（及其所有的 XML 优点）相比，APT 轻而易举。同样，当我编写生成内容的插件时，我倾向于使用 XDOC 格式，因为编写创建所需 XML 的软件非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T19:09:25.743

APT 格式易于使用。但是，它不支持自定义样式（例如设置字符或标题的样式）。可以与 APT 一起使用的最接近预格式化文本的是“逐字文本”，就像在 HTML 中一样，逐字文本是预先格式化的。与 HTML 不同，逐字文本被转义：在逐字显示中，标记不被 APT 处理器解释。

# security - 网络浏览器是否会通过 https 缓存内容

> ID：174348
> 
> 赞同：248
> 
> 时间：2008-10-06T13:46:28.970
> 
> 标签：security, https

通过 https 请求的内容是否仍会被 Web 浏览器缓存，或者他们是否认为这种不安全的行为？如果是这种情况，无论如何要告诉他们可以缓存吗？

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2008-10-06T14:30:32.670

截至 2010 年，**所有现代浏览器默认缓存 HTTPS 内容，除非明确告知不要这样做。**

*不需要*为此进行设置`cache-control:public`。

来源：[Chrome](https://web.archive.org/web/20160405131722/http://gent.ilcore.com/2011/02/chromes-10-caches.html?showComment=1297102528799#c5411401837359385517)、[IE](http://blogs.msdn.com/b/ieinternals/archive/2010/04/21/internet-explorer-may-bypass-cache-for-cross-domain-https-content.aspx)、[火狐](https://bugzilla.mozilla.org/show_bug.cgi?id=531801)。

* * *

## 回答 #2

> 赞同：134
> 
> 时间：2008-10-06T14:25:45.130

默认情况下，Web 浏览器应该像通过 HTTP 一样通过 HTTPS 缓存内容，除非通过收到的[HTTP 标头明确告知。](http://en.wikipedia.org/wiki/List_of_HTTP_headers)

[此链接](https://www.mnot.net/cache_docs/)很好地介绍了在 HTTP 标头中设置缓存设置。

> 无论如何告诉他们可以缓存吗？

这可以通过将标头中的`max-age`值设置`Cache-Control`为非零值来实现，例如

```
Cache-Control: max-age=3600 
```

会告诉浏览器这个页面可以缓存3600秒（1小时）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-08T22:25:32.473

默认情况下会缓存 Https。这是由应用程序定义的缓存指令无法覆盖的全局设置管理的。要覆盖全局设置，请在控制面板中选择 Internet 选项小程序，然后转到高级选项卡。选中“安全”部分下的“不将加密页面保存到磁盘”框，但单独使用 HTTPS 对 IE 是否决定缓存资源没有影响。

WinINet only caches HTTP and FTP responses not HTTPS response. [https://msdn.microsoft.com/en-us/library/windows/desktop/aa383928%28v=vs.85%29.aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/aa383928%28v=vs.85%29.aspx)

# c++ - 强制单参数构造函数在 C++ 中显式？

> ID：174349
> 
> 赞同：26
> 
> 时间：2008-10-06T13:46:42.307
> 
> 标签：c++

默认情况下，在 C++ 中，单参数构造函数可用作隐式转换运算符。这可以通过将构造函数标记为显式来抑制。

我更愿意将“显式”设为默认值，这样编译器就不能静默地使用这些构造函数进行转换。

有没有办法在标准 C++ 中做到这一点？如果做不到这一点，是否有一个编译指示（或类似的）可以在 Microsoft C++ 中工作来做到这一点？g++ 怎么样（我们不使用它，但它可能是有用的信息）？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-06T14:00:00.033

不，您必须手动完成所有操作。这很痛苦，但你当然应该养成明确单参数构造函数的习惯。如果您确实找到了解决方案，然后不得不将代码移植到另一个平台，我无法想象您会有多么痛苦。您通常应该回避这样的编译器扩展，因为它会使代码的可移植性降低。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T05:14:07.427

如果有一个编译指示或命令行选项在默认情况下使构造函数显式，你将如何声明一个不显式的？必须有另一个特定于编译器的标记或 pragma 才能声明隐式转换构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T14:17:15.240

对于您拥有的任何标题，这可能会相当讨厌。喜欢`<vector>`，或任何 Boost 标头。它还会导致很多错误的错误报告。所以，不，我不希望编译器添加这样的#pragma。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T18:06:07.620

据我所知，编译器中没有这样的选项。但是对于这种情况有一个 Lint 警告（参见[http://www.gimpel.com/lintinfo.htm](http://www.gimpel.com/lintinfo.htm)）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T13:52:11.487

我想答案是否定的！

抱歉，这不是一个非常有建设性的答案。我希望其他人可能会知道更多！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T13:53:40.297

标准 c++ 中没有这样的选项，我不相信 Visual Studio 中也没有。

# algorithm - 一维嵌套算法

> ID：174351
> 
> 赞同：6
> 
> 时间：2008-10-06T13:47:22.447
> 
> 标签：algorithm

将一维长度嵌套到预定义的库存长度的有效算法是什么？

例如，如果您需要以下数量和长度的钢筋，

*   5 x 2 米
*   5 x 3 米
*   5 x 4 米

这些可以从 10 米长的钢筋上切割下来。您如何计算切割 10m 钢筋的模式，以便使用最少的钢筋？

此外，您如何将多个库存长度合并到算法中？

* * *

我有一点时间来解决这个问题，所以我将写下我是如何解决它的。我希望这对某人有用。我不确定这样回答我自己的问题是否可以。如果更合适，版主可以将其更改为答案。

首先感谢所有回答的人。这为我指出了适当的算法；[切割库存问题](http://en.wikipedia.org/wiki/Cutting_stock_problem)。

这篇文章也很有用；[“计算边角废料最少的切割清单”](https://stackoverflow.com/questions/22145/calculating-a-cutting-list-with-the-least-amount-of-off-cut-waste)。

好的，进入解决方案。

我将在我的解决方案中使用以下术语；

*   库存：一段将被切成小块的材料
*   切割：从库存中切割出来的一段材料。可以从同一块库存中进行多次切割
*   浪费：所有切割完成后留在一块原料中的材料长度。

解决问题主要分为三个阶段，

1.  识别所有可能的切割组合
2.  确定可以从每个库存中提取哪些组合
3.  找到切割组合的最佳组合。

**第1步**

使用 N 个切割，有 2^N-1 个独特的切割组合。这些组合可以表示为二进制真值表。

其中 A、B、C 是独特的切割；

```
A B C | Combination
-------------------
0 0 0 | None
0 0 1 | C
0 1 0 | B
0 1 1 | BC
1 0 0 | A
1 0 1 | AC
1 1 0 | AB
1 1 1 | ABC 
```

带有一些位运算符的 for 循环可用于快速创建每个剪切组合的分组。

对于较大的 N 值，这可能会非常耗时。

在我的情况下，同一个剪辑有多个实例。这产生了重复的组合。

```
A B B | Combination
-------------------
0 0 0 | None
0 0 1 | B
0 1 0 | B (same as previous)
0 1 1 | BB
1 0 0 | A
1 0 1 | AB
1 1 0 | AB (same as previous)
1 1 1 | ABB 
```

我能够利用这种冗余来减少计算组合的时间。我将重复的剪辑组合在一起，并计算了该组的独特组合。然后，我将此组合列表附加到第二组中的每个唯一组合以创建一个新组。

例如，削减AABBC，过程如下。

```
A A | Combination
-------------------
0 1 | A 
1 1 | AA 
```

将此组称为 X。

将 X 附加到 B 的唯一实例，

```
B B X | Combination
-------------------
0 0 1 | A 
      | AA
0 1 0 | B
0 1 1 | BA
      | BAA
1 1 0 | BB 
1 1 1 | BBA
      | BBAA 
```

将此组称为 Y。

将 Y 附加到 C 的唯一实例，

```
C Y | Combination
-----------------
0 1 | A 
    | AA
    | B
    | BA
    | BAA
    | BB 
    | BBA
    | BBAA 
1 0 | C
1 1 | CA 
    | CAA
    | CB
    | CBA
    | CBAA
    | CBB 
    | CBBA
    | CBBAA 
```

此示例生成 17 个唯一组合，而不是 31 个 (2^5-1)。节省了将近一半。

一旦确定了所有组合，就该检查它是否适合库存。

**第2步**

此步骤的目的是将步骤 1 中确定的切割组合映射到可用的库存尺寸。

这是一个相对简单的过程。对于每个切割组合，

```
 calculate the sum of all cut lengths.
   for each item of stock, 
        if the sum of cuts is less than stock length,
            store  stock, cut combination and waste in a data structure.
            Add this structure to a list of some sort. 
```

这将产生一个有效嵌套剪切组合的列表。存储废料并不是绝对必要的，因为这可以根据切割长度和库存长度计算得出。但是，储存废物会减少步骤 3 中所需的处理。

**第 3 步**

在这一步中，我们将确定产生最少浪费的切割组合。这基于步骤 2 中生成的有效嵌套列表。

在一个理想的世界里，我们会计算所有的可能性并选择最好的一个。对于任何非平凡的削减集，都需要永远计算它们。我们只需要对非最优解决方案感到满意。有多种算法可以完成这项任务。

我选择了一种方法，它会寻找一个浪费最少的巢穴。它将重复此操作，直到计算完所有削减。

从三个列表开始

*   cutList：所有必需剪辑的列表（包括重复剪辑）。
*   nestList：步骤 2 中生成的巢列表。这是从最低废物到最高废物排序的。
*   finalList：最初为空，这将存储将输出给用户的剪切组合列表。

方法

```
pick nest from nestList with the least waste
  if EVERY cut in the nest is contained in cutList
     remove cuts from cutList
     copy this nest into the finalList
  if some cuts in nest not in cutList
      remove this nest from nestList             
repeat until cutlist is empty 
```

使用这种方法，我设法为一些典型的测试数据总共浪费了大约 2-4%。希望我能在某个时候重新审视这个问题，并尝试实现[延迟列生成](http://en.wikipedia.org/wiki/Delayed_Column_Generation)算法。这应该会产生更好的结果。

我希望这可以帮助其他遇到此问题的人。

大卫

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T14:30:08.133

实际上，还有一个更具体的问题适用：[切割库存问题](http://en.wikipedia.org/wiki/Cutting_stock_problem)：

> 下料问题是一个优化问题，或者更具体地说，是一个整数线性规划问题。它源于工业中的许多应用。想象一下，您在一家造纸厂工作，您有许多固定宽度的纸卷等待切割，但不同的客户需要不同数量的不同尺寸宽度的纸卷。你将如何切割面包卷以最大限度地减少浪费（剩余量）？

这比装箱问题更适用的原因是因为您正在尝试尽量减少浪费，而不是尽量减少“箱”的数量。从某种意义上说，装箱问题是切割库存问题的逆过程：在一定尺寸下，您将如何取一段钢并将它们重新组装成尽可能少的钢筋？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T13:49:21.397

[最低成本箱包装](http://www.nist.gov/dads/HTML/binpacking.html)

编辑：这是一个更好的链接：[http ://en.wikipedia.org/wiki/Bin_packing_problem](http://en.wikipedia.org/wiki/Bin_packing_problem)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T14:09:59.810

感谢您提出垃圾箱包装问题底座的建议。这导致我进入以下帖子， [计算具有最少切割废料的切割清单](https://stackoverflow.com/questions/22145/calculating-a-cutting-list-with-the-least-amount-of-off-cut-waste#23625)。这似乎很好地涵盖了我的问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T15:02:32.357

解决了与几年前类似的问题。我最终使用了遗传算法。对于小问题，这将是矫枉过正。回到 16 位时代，这个程序写起来有些有趣，但同时也不好玩。

首先，它列出了可以使用给定长度切割 10 英尺原材料的所有方式。记录每一种材料的浪费量。（虽然它是快速数学，但存储这些以供以后查找会更快。）然后它查看所需部分的列表。在一个循环中，它将从切割方式列表中选择一种切割方式，该方式不会切割超过所需尺寸的任何尺寸。贪心算法会选择一个浪费最少的算法，但有时可以通过放松这一点找到更好的解决方案。最终，遗传算法做出了选择，“DNA”是一些在过去的解决方案中表现良好的切割方法。

所有这一切都可以追溯到互联网之前的时代，被聪明和实验所破坏。这些天来，可能有一些 .NET 或 java 库的东西已经被黑盒化了——但这会减少乐趣和教育，不是吗？

# asp.net - 在 ASP.NET 中使用 ButtonField 或 HyperLinkField 编写 cookie

> ID：174352
> 
> 赞同：1
> 
> 时间：2008-10-06T13:47:46.907
> 
> 标签：asp.net, vb.net, cookies, detailsview, buttonfield

我目前在 ASP.NET 中有一个 DetailsView，它根据通过 QueryString 传递的 ID 从数据库中获取数据。我现在一直在尝试做的是在用户单击 ButtonField 或 HyperLinkField 时创建的新 cookie 中使用相同的 ID。

我在 .aspx 中的内容是：

```
<asp:DetailsView ID="DetailsView1" runat="server" AutoGenerateRows="False" DataKeyNames="ArtID"
    DataSourceID="AccessDataSource1" Height="50px" Width="125px">
    <Fields>
        <asp:ImageField DataAlternateTextField="Title" DataImageUrlField="FileLocation">
        </asp:ImageField>
        <asp:BoundField DataField="ArtID" HeaderText="ArtID" InsertVisible="False" ReadOnly="True"
            SortExpression="ArtID" />
        <asp:BoundField DataField="Title" HeaderText="Title" SortExpression="Title" />
        <asp:BoundField DataField="ArtDate" HeaderText="ArtDate" SortExpression="ArtDate" />
        <asp:BoundField DataField="Description" HeaderText="Description" SortExpression="Description" />
        <asp:BoundField DataField="FileLocation" HeaderText="FileLocation" SortExpression="FileLocation" />
        <asp:BoundField DataField="Medium" HeaderText="Medium" SortExpression="Medium" />
        <asp:BoundField DataField="Location" HeaderText="Location" SortExpression="Location" />
        <asp:BoundField DataField="PageViews" HeaderText="PageViews" SortExpression="PageViews" />
        <asp:HyperLinkField DataNavigateUrlFields="ArtID" DataNavigateUrlFormatString="Purchase.aspx?ArtID={0}"
            NavigateUrl="Purchase.aspx" Text="Add To Cart" />
        <asp:ButtonField ButtonType="Button" DataTextField="ArtID" Text="Add to Cart" CommandName="btnAddToCart_Click" />
    </Fields>
</asp:DetailsView> 
```

当使用调节器 asp.net 按钮时，例如：

```
<asp:Button ID="btnAddArt" runat="server" Text="Add To Cart" /> 
```

我会在VB中有这样的东西：

```
Protected Sub btnAddArt_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnAddArt.Click
    Dim CartArtID As New HttpCookie("CartArtID")
    CartArtID.Value = ArtID.DataField
    CartArtID.Expires = Date.Today.AddDays(0.5)
    Response.Cookies.Add(CartArtID)

    Response.Redirect("Purchase.aspx")
End Sub 
```

但是，我不知道如何将它应用到 ButtonField，因为 ButtonField 不允许我给它一个 ID。

我需要添加到 cookie 中的 ID 是第一个 BoundField 中的 ArtID。

非常感谢任何关于我将如何去做的想法/建议！

或者，如果我可以使用 HyperLinkField 或常规按钮执行此操作，那将同样好，但我无法使用常规按钮访问 DetailsView 中的 ID。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T16:13:26.287

使用 Button 类的 CommandName 和 CommandArgument 参数。指定 CommandName 将公开 ItemCommand 事件。从那里您可以检查CommandName，轻松获取CommandArgument（您的行或项目的ID），然后以这种方式将您需要的任何数据推送到您的cookie中。

更正式地说，您希望拥有这样的按钮：

```
<asp:Button ID="btnAddArt" CommandName="AddCard" CommandArgument="[ArtID]" runat="server" Text="Add To Cart" /> 
```

然后你的代码可以像这样运行：

```
Private Sub ProcessDetailsViewCommand(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewCommandEventArgs) Handles DetailsView1.ItemCommand

' Using Case statement makes it easy to add more custom commands later on.
Select Case e.CommandName

   Case "AddCard"
      Dim CartArtID As New HttpCookie("CartArtID")
      CartArtID.Value = Integer.Parse(e.CommandArgument.ToString)
      CartArtID.Expires = Date.Today.AddDays(0.5)
      Response.Cookies.Add(CartArtID)
      Response.Redirect("Purchase.aspx")

   End Select
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T13:59:21.143

我注意到您将密钥放入网格本身（DataKeyNames =“ArtID”）。您可以在事件处理程序中访问它——事件参数将为您获取当前索引，以便索引到网格上的数据键。

有道理？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T15:07:26.590

由于您设置了 DetailsView 控件的 DataKeyNames 属性，因此您可以使用 DetailsView1.DataKey(0) 访问显示项目的 ArtID。或者，您可以使用 DetailsView1.SelectedValue 来获得相同的结果。至于处理单击事件，您必须将 ItemCommand 事件处理程序添加到 DetailsView。

# winforms - 在 winforms 应用程序中调整主窗体大小时如何调整面板大小？

> ID：174355
> 
> 赞同：7
> 
> 时间：2008-10-06T13:49:10.353
> 
> 标签：winforms, resize

如果我的 winforms 应用程序的用户调整了主窗体的大小，我希望 2 个面板以及子控件也可以伸展。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-06T14:22:45.590

> 如果我的 winforms 应用程序的用户调整了主窗体的大小，我希望 2 个面板以及子控件也可以伸展。

您是[TableLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx) (MSDN) 的理想用例。如果您只是缩放面板，则 Dock 和 Anchor 将是合适的。但是由于您希望控件能够很好地扩展，因此您几乎处于 AutoLayout 世界中，并且可能是 TableLayoutPanel。（顺便说一下，我是这个的超级粉丝，尽管过度使用会对布局控件产生负面的性能影响。）

有关使用它来配置布局以进行缩放的一些有用链接：

*   [通过示例自动布局](http://blogs.msdn.com/permanenttan/archive/2006/03/07/545445.aspx)
*   [WinForms AutoLayout 基础：TableLayoutPanel](http://blogs.msdn.com/jpricket/archive/2006/04/05/winforms-autolayout-basics-tablelayoutpanel.aspx)
*   [TableLayoutPanel 上的视频培训](http://windowsclient.net/learn/video.aspx?v=12393)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T13:51:44.513

使用面板的**Dock**和**Anchor**属性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T14:05:07.810

您可以使用 TableLayoutPanel 并将列宽设置为 x%，这样您就可以将屏幕分成 2 部分。TableLayoutPanel 必须是 Dock 才能填充所有表单或 Anchor。

TableLayoutPanel 可以包含其他面板。或者您可以简单地使用您的面板并使用 Anchor（单击面板并进入 VS 的属性面板）。

# c - 在 C 中构建时断言表达式的方法

> ID：174356
> 
> 赞同：25
> 
> 时间：2008-10-06T13:49:17.403
> 
> 标签：c, refactoring, assert, static-assert

我正在整理一些旧代码，这些代码到处使用“幻数”来设置硬件寄存器，我想使用常量而不是这些数字来使代码更具表现力（实际上它们会映射到名称/values 用于记录寄存器）。

然而，我担心随着变化的数量，我可能会打破神奇的数字。这是一个简化的示例（寄存器集更复杂）：

```
const short mode0 = 0;
const short mode1 = 1;
const short mode2 = 2;

const short state0 = 0;
const short state1 = 4;
const short state2 = 8; 
```

所以而不是：

```
set_register(5); 
```

我们有：

```
set_register(state1|mode1); 
```

我正在寻找的是**构建时**版本：

```
ASSERT(5==(state1|mode1)); 
```

**更新**

@Christian，感谢您的快速响应，我也对 C / 非增强环境的答案感兴趣，因为这是驱动程序/内核代码。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-06T14:15:32.360

**新答案**：

在我的原始答案（如下）中，我必须有两个不同的宏来支持函数范围和全局范围内的断言。我想知道是否有可能提出一个适用于两种范围的单一解决方案。

我能够使用外部字符数组找到适用于 Visual Studio 和 Comeau 编译器的解决方案。但我能够找到适用于 GCC 的更复杂的解决方案。但是 GCC 的解决方案不适用于 Visual Studio。:( 但是添加一个'#ifdef __ GNUC __'，很容易为给定的编译器选择正确的宏集。

**解决方案：**

```
#ifdef __GNUC__
#define STATIC_ASSERT_HELPER(expr, msg) \
    (!!sizeof \ (struct { unsigned int STATIC_ASSERTION__##msg: (expr) ? 1 : -1; }))
#define STATIC_ASSERT(expr, msg) \
    extern int (*assert_function__(void)) [STATIC_ASSERT_HELPER(expr, msg)]
#else
    #define STATIC_ASSERT(expr, msg)   \
    extern char STATIC_ASSERTION__##msg[1]; \
    extern char STATIC_ASSERTION__##msg[(expr)?1:2]
#endif /* #ifdef __GNUC__ */ 
```

`STATIC_ASSERT(1==1, test_message);`以下是test.c 第 22 行报告的错误消息：

**海合会：**

```
line 22: error: negative width in bit-field `STATIC_ASSERTION__test_message' 
```

**视觉工作室：**

```
test.c(22) : error C2369: 'STATIC_ASSERTION__test_message' : redefinition; different subscripts
    test.c(22) : see declaration of 'STATIC_ASSERTION__test_message' 
```

**科莫：**

```
line 22: error: declaration is incompatible with
        "char STATIC_ASSERTION__test_message[1]" (declared at line 22) 
```

**原始答案**：

我做的事情与 Checkers 所做的非常相似。但我包含一条消息，该消息会出现在许多编译器中：

```
#define STATIC_ASSERT(expr, msg)               \
{                                              \
    char STATIC_ASSERTION__##msg[(expr)?1:-1]; \
    (void)STATIC_ASSERTION__##msg[0];          \
} 
```

对于在全局范围内（函数外）做某事，请使用：

```
#define GLOBAL_STATIC_ASSERT(expr, msg)   \
  extern char STATIC_ASSERTION__##msg[1]; \
  extern char STATIC_ASSERTION__##msg[(expr)?1:2] 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-02T13:01:35.467

[Ralf Holly](http://www.drdobbs.com/184401873)有一篇文章 研究了 C 中静态断言的不同选项。

他提出了三种不同的方法：

*   switch case 值必须是唯一的
*   数组不能有负维度
*   常量表达式除以零

他对最佳实施的结论是：

```
#define assert_static(e) \
    do { \
        enum { assert_static__ = 1/(e) }; \
    } while (0) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-06T13:50:31.240

Checkout boost 的[静态断言](http://www.boost.org/doc/libs/1_36_0/doc/html/boost_staticassert.html)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-06T13:55:12.807

如果您无权访问第三方库静态断言函数（如 boost），则可以滚动自己的静态断言：

```
#define STATIC_ASSERT(x) \
    do { \
        const static char dummy[(x)?1:-1] = {0};\
    } while(0) 
```

当然，缺点是该错误消息不会很有帮助，但至少它会为您提供行号。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-05-22T10:46:40.857

```
#define static_assert(expr) \
int __static_assert(int static_assert_failed[(expr)?1:-1]) 
```

它可以随时随地使用。我认为这是最简单的解决方案。

在使用之前，请使用您的编译器仔细测试它。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-06T15:24:11.580

此处列出的任何技术都应该有效，当 C++0x 可用时，您将能够使用内置[`static_assert`](http://en.wikipedia.org/wiki/C%2B%2B0x#Static_assertions)关键字。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-06T14:09:18.893

尝试：

```
#define STATIC_ASSERT(x, error) \
do { \
    static const char error[(x)?1:-1];\
} while(0) 
```

然后你可以写：

```
STATIC_ASSERT(a == b, a_not_equal_to_b); 
```

这可能会给你一个更好的错误信息（取决于你的编译器）。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-06T17:04:31.270

如果你有 Boost，那么使用`BOOST_STATIC_ASSERT`是要走的路。如果您使用 C 或不想获得 Boost，这是我的`c_assert.h`文件，它定义（并解释了其工作原理）一些宏来处理静态断言。

应该是有点复杂，因为在 ANSI C 代码中，您需要 2 个不同的宏 - 一个可以在您有声明的区域工作，另一个可以在正常语句所在的区域工作。还有一些工作可以使宏在全局范围或块范围内工作，还有一堆垃圾来确保没有名称冲突。

`STATIC_ASSERT()`可以在变量声明块或全局范围内使用。

`STATIC_ASSERT_EX()`可以在常规语句中。

对于 C++ 代码（或允许声明与语句混合的 C99 代码）`STATIC_ASSERT()`将在任何地方工作。

```
/*
    Define macros to allow compile-time assertions.

    If the expression is false, an error something like

        test.c(9) : error XXXXX: negative subscript

    will be issued (the exact error and its format is dependent
    on the compiler).

    The techique used for C is to declare an extern (which can be used in
    file or block scope) array with a size of 1 if the expr is TRUE and
    a size of -1 if the expr is false (which will result in a compiler error).
    A counter or line number is appended to the name to help make it unique.  
    Note that this is not a foolproof technique, but compilers are
    supposed to accept multiple identical extern declarations anyway.

    This technique doesn't work in all cases for C++ because extern declarations
    are not permitted inside classes.  To get a CPP_ASSERT(), there is an 
    implementation of something similar to Boost's BOOST_STATIC_ASSERT().  Boost's
    approach uses template specialization; when expr evaluates to 1, a typedef
    for the type 

        ::interslice::StaticAssert_test< sizeof( ::interslice::StaticAssert_failed<true>) >

    which boils down to 

        ::interslice::StaticAssert_test< 1>

    which boils down to 

        struct StaticAssert_test

    is declared. If expr is 0, the compiler will be unable to find a specialization for

        ::interslice::StaticAssert_failed<false>.

    STATIC_ASSERT() or C_ASSERT should work in either C or C++ code  (and they do the same thing)

    CPP_ASSERT is defined only for C++ code.

    Since declarations can only occur at file scope or at the start of a block in 
    standard C, the C_ASSERT() or STATIC_ASSERT() macros will only work there.  For situations
    where you want to perform compile-time asserts elsewhere, use C_ASSERT_EX() or
    STATIC_ASSERT_X() which wrap an enum declaration inside it's own block.

 */

#ifndef C_ASSERT_H_3803b949_b422_4377_8713_ce606f29d546
#define C_ASSERT_H_3803b949_b422_4377_8713_ce606f29d546

/* first some utility macros to paste a line number or counter to the end of an identifier
 * this will let us have some chance of generating names that are unique
 * there may be problems if a static assert ends up on the same line number in different headers
 * to avoid that problem in C++ use namespaces
*/

#if !defined( PASTE)
#define PASTE2( x, y) x##y
#define PASTE( x, y)  PASTE2( x, y)
#endif /* PASTE */

#if !defined( PASTE_LINE)
#define PASTE_LINE( x)    PASTE( x, __LINE__)
#endif /* PASTE_LINE */

#if!defined( PASTE_COUNTER)
#if (_MSC_VER >= 1300)      /* __COUNTER__ introduced in VS 7 (VS.NET 2002) */
    #define PASTE_COUNTER( x) PASTE( x, __COUNTER__)   /* __COUNTER__ is a an _MSC_VER >= 1300 non-Ansi extension */
#else
    #define PASTE_COUNTER( x) PASTE( x, __LINE__)      /* since there's no __COUNTER__ use __LINE__ as a more or less reasonable substitute */
#endif
#endif /* PASTE_COUNTER */

#if __cplusplus
extern "C++" {   // required in case we're included inside an extern "C" block
    namespace interslice {
        template<bool b> struct StaticAssert_failed;
        template<>       struct StaticAssert_failed<true> { enum {val = 1 }; };
        template<int x>  struct StaticAssert_test { };
    }
}
    #define CPP_ASSERT( expr) typedef ::interslice::StaticAssert_test< sizeof( ::interslice::StaticAssert_failed< (bool) (expr) >) >  PASTE_COUNTER( IntersliceStaticAssertType_)
    #define STATIC_ASSERT( expr)    CPP_ASSERT( expr)
    #define STATIC_ASSERT_EX( expr) CPP_ASSERT( expr)
#else
    #define C_ASSERT_STORAGE_CLASS extern                  /* change to typedef might be needed for some compilers? */
    #define C_ASSERT_GUID 4964f7ac50fa4661a1377e4c17509495 /* used to make sure our extern name doesn't collide with something else */
    #define STATIC_ASSERT( expr)   C_ASSERT_STORAGE_CLASS char PASTE( PASTE( c_assert_, C_ASSERT_GUID), [(expr) ? 1 : -1])
    #define STATIC_ASSERT_EX(expr) do { enum { c_assert__ = 1/((expr) ? 1 : 0) }; } while (0)
#endif /* __cplusplus */

#if !defined( C_ASSERT)  /* C_ASSERT() might be defined by winnt.h */
#define C_ASSERT( expr)    STATIC_ASSERT( expr)
#endif /* !defined( C_ASSERT) */
#define C_ASSERT_EX( expr) STATIC_ASSERT_EX( expr)

#ifdef TEST_IMPLEMENTATION
C_ASSERT( 1 < 2);
C_ASSERT( 1 < 2);

int main( )
{
    C_ASSERT( 1 < 2);
    C_ASSERT( 1 < 2);

    int x;

    x = 1 + 4;

    C_ASSERT_EX( 1 < 2);
    C_ASSERT_EX( 1 < 2);

    return( 0);
}
#endif /* TEST_IMPLEMENTATION */
#endif /* C_ASSERT_H_3803b949_b422_4377_8713_ce606f29d546 */ 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-06T14:04:11.790

常见的便携式选项是

```
#if 5 != (state1|mode1)
#    error "aaugh!"
#endif 
```

但在这种情况下它不起作用，因为它们是 C 常量而不是`#define`s。

您可以查看`BUILD_BUG_ON`处理您的情况的 Linux 内核宏：

```
#define BUILD_BUG_ON(condition) ((void)sizeof(char[1 - 2*!!(condition)])) 
```

当`condition`为真时，这变为`((void)sizeof(char[-1]))`，这是非法的，应该在编译时失败，否则变为`((void)sizeof(char[1]))`，这很好。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-04-26T15:55:46.953

确保使用足够新的编译器进行编译（例如`gcc -std=c11`）。

那么你的陈述很简单：

```
_Static_assert(state1|mode1 == 5, "Unexpected change of bitflags"); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-06-15T18:41:04.433

```
#define MODE0 0
#define MODE1 1
#define MODE2 2

#define STATE0 0
#define STATE1 4
#define STATE2 8

set_register(STATE1|STATE1); //set_register(5);
#if (!(5==(STATE1|STATE1))) //MY_ASSERT(5==(state1|mode1)); note the !
#error "error blah blah"
#endif 
```

这不像单行 MY_ASSERT(expr) 解决方案那样优雅。您可以在编译 C 代码之前使用 sed、awk 或 m4 宏处理器来生成 MY_ASSERT(expr) 到多行的 DEBUG 代码扩展或将它们删除以用于生产的 NODEBUG 代码。

# visual-studio - 如何使用 TFS 检测文件修改？

> ID：174365
> 
> 赞同：11
> 
> 时间：2008-10-06T13:51:23.420
> 
> 标签：visual-studio, tfs, version-control, winmerge

似乎当我使用工具（例如 winmerge）来更新我的代码库时……我的 Visual Studio Team System (VSTS) 与 Team Foundation Server (TFS) 的集成似乎没有成功。

我如何知道要签出和签入哪些文件？有什么我想念的吗？这是不属于 VSTS 和 TFS 的功能吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T13:58:52.953

首先，这可能是因为文件尚未签出。如果您在运行更新之前先执行此操作，TFS 将看到这些更改。

其次，您可以使用 TFS Power Tools（可从 MS 获得）查看本地存储库中无法识别的更改。如果发现差异，电动玩具会重置文件的状态，以便 Pending Changes 窗口看到更改。这不需要您签出文件，如果有差异，它会为您执行此操作。

很漂亮。

2008 年电动工具在这里：[http ://www.microsoft.com/en-us/download/details.aspx?id=15836](http://www.microsoft.com/en-us/download/details.aspx?id=15836)

并且您正在寻找“在线”命令：

“在线命令 - 使用在线命令在没有挂起编辑的可写文件上创建挂起的编辑。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T14:01:04.243

我假设您在 VS 之外的整个项目中应用更改。您必须先签出整个项目，然后应用更改并重新签入。未修改的文件实际上不会被签入，AFAIK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T14:01:07.193

您的问题听起来好像您还没有安装 Team Foundation Server 客户端。

如果您已安装 Visual Studio Team System 版本，则可以连接 Team Foundation Server。但要使集成正常工作，您还需要安装 Team Foundation Server 客户端。

完成此操作后，您的 Visual Studio 应在文件更改时通知您，然后自动签出文件。

# php - 如何在 phpBB3 中重用现有的数据库连接？

> ID：174375
> 
> 赞同：1
> 
> 时间：2008-10-06T13:54:44.913
> 
> 标签：php, database, connection, phpbb3

我正在为 phpbb3 论坛使用我自己的数据库，我希望将论坛中的一些数据插入到我自己的表中。现在，我可以建立自己的连接并运行我的查询，但是在尝试使用 $db 变量时（我认为这是您打算使用的？？）它给了我一个错误。

我希望有人向我展示我插入查询以便能够运行它的基本框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T13:59:42.343

嗯.. 您没有给我们太多信息，但是您需要做两件事来连接和查询数据库。

对于 phpbb，您可能需要阅读他们提供的文档：

[http://wiki.phpbb.com/Database_Abstraction_Layer](http://wiki.phpbb.com/Database_Abstraction_Layer)

以下是您如何执行查询的一般概述：

```
include($phpbb_root_path . 'includes/db/mysql.' . $phpEx);

$db = new dbal_mysql();
// we're using bertie and bertiezilla as our example user credentials. You need to fill in your own ;D
$db->sql_connect('localhost', 'bertie', 'bertiezilla', 'phpbb', '', false, false);

$sql = "INSERT INTO (rest of sql statement)";

$result = $db->sql_query($sql); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T14:07:17.850

我假设 phpBB 已经连接到我的数据库。所以我不打算用一个新的吗？我可以制作一个新的并将其命名为其他名称而不会出错吗？

并且 $resultid = mysql_query($sql,$db345);

其中 $db345 是我的数据库连接的名称

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-30T02:13:23.377

```
$db = new dbal_mysql();
// we're using bertie and bertiezilla as our example user credentials. You need to fill in your own ;D
$db->sql_connect('localhost', 'bertie', 'bertiezilla', 'phpbb', '', false, false);

$sql = "INSERT INTO (rest of sql statement)";
$result = $db->sql_query($sql); 
```

# java - Spring webflow：通过视图状态移动

> ID：174380
> 
> 赞同：3
> 
> 时间：2008-10-06T13:55:30.510
> 
> 标签：java, spring, spring-webflow

在 spring webflow 中，我需要实现一个导航栏，该导航栏将允许“后退”或将流恢复到前一个视图之一。

例如 ：

*   查看 1 = 登录
*   查看 2 = 我的信息
*   查看 3 = 我的消息
*   查看 4 = 关闭会话

对于此示例，我想从视图 4 页面返回视图 2。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T17:23:22.260

这取决于你如何去做这件事。如果您在单个流程中执行此操作，您将拥有如下内容：

```
<view-state id="loginView" view="login.jsp">
    <action-state bean="someBean" method="login" />
    <transition on="success" to="informationView" />
</view-state> 

<view-state id="informationView" view="information.jsp">
    <render-actions>
        <action-state bean="someBean" method="retrieveInformation" />
    </render-actions>
    <transition on="forward" to="messageView" />
    <transition on="back" to="loginView" />
</view-state>

<view-state id="messageView" view="message.jsp">
    <render-actions>
        <action-state bean="someBean" method="retrieveMessage" />
    </render-actions>
    <transition on="forward" to="closeView" />
    <transition on="back" to="informationView" />
</view-state>

<view-state id="closeView" view="logout.jsp">
    <transition on="jumpBack" to="informationView" />
</view-state> 
```

“closeView”上的“jumpBack”转换将跳转回视图状态#2，这是您的信息视图。

使用子流程很棘手。你需要链接它：调用一个子流，如果一个事件发出信号表明你需要以特定状态结束你的流，立即这样做。

例如，假设您的流程链是登录->信息->消息->关闭。

在关闭流程中，最终状态将是“returnToInformation”。

消息流在="returnToInformation" 到="returnToInformation" 上有一个转换。

“returnToInformation”也是消息流中的一个结束状态。

然后，信息流在="returnToInformation" 到="displayInformationPage" 上进行转换，然后重新显示信息页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-24T15:07:40.877

我通过定义一些代表选项卡的全局流来做到这一点。然后，我定义了一个对象，该对象表示流上的选项卡并指示当前选项卡是否处于活动状态。当用户在标签中移动时，我适当地更新了标签对象。

当用户点击其中一个选项卡时，它使用全局流来允许它们在选项卡之间移动（对于我的实现，我发现调用操作而不是查看状态更容易，因为您可能会发现视图可能会根据用户交互才能到达那里，因此您可能需要重新计算它们）。

对于标签栏本身，我将它放在一个 JSP 中，然后将其放在每个表单的顶部，这使得更新变得更容易。

它不是最好的解决方案，但它确实有效。

祝你好运。

# regex - 如何检查正则表达式中的两个子表达式中的至少一个是否匹配？

> ID：174381
> 
> 赞同：7
> 
> 时间：2008-10-06T13:55:55.643
> 
> 标签：regex, syntax

我正在尝试将浮点十进制数与正则表达式匹配。小数点前可能有也可能没有数字，小数点可能存在也可能不存在，如果存在，它后面可能有数字，也可能没有数字。（对于此应用程序，不允许使用前导 +/- 或尾随“E123”）。我写了这个正则表达式：

```
/^([\d]*)(\.([\d]*))?$/ 
```

正确匹配以下内容：

```
1
1.
1.23
.23 
```

但是，这也匹配空字符串或仅包含小数点的字符串，这是我不想要的。

目前，我在运行正则表达式后检查 $1 或 $3 的长度是否大于 0。如果不是，则它无效。有没有办法可以直接在正则表达式中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T13:59:21.470

我认为这会做你想要的。它要么以数字开头，在这种情况下，小数点和后面的数字是可选的，或者以小数点开头，在这种情况下，它后面必须至少有一个数字。

```
/^\d+(\.\d*)?|\.\d+$/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T14:03:55.143

为每种情况创建一个正则表达式，然后对它们进行 OR。然后你只需要测试表达式是否匹配。

```
/^(\d+(\.\d*)?)|(\d*\.\d+)$/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-29T15:01:52.560

一个很晚的答案，但喜欢回答，取自[regular-expressions.info](http://www.regular-expressions.info/floatingpoint.html)

```
[-+]?[\d]*\.?[\d]+? 
```

**更新**这`[\d]*\.?[\d]+?|[\d]+\.`将帮助您匹配`1.`

[http://regex101.com/r/lJ7fF4/7](http://regex101.com/r/lJ7fF4/7)

# java - 有谁知道 NetBeans 6.x 是否可以与 Leopard 上的 Java SE 6 一起使用？

> ID：174383
> 
> 赞同：1
> 
> 时间：2008-10-06T13:57:19.150
> 
> 标签：java, eclipse, netbeans, osx-leopard

Java SE 6（仅限 64 位）现在在 OS X 上，这是一件好事。据我了解，由于 Eclipse 仍然是 Carbon，因此是 32 位，它不能用于 Leopard 上的 1.6，只有 1.5。

有谁知道 NetBeans 6.x 是否可以在 Leopard 上利用其 JVM 与 Java SE 6 一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T14:35:19.760

是的，你应该可以。

许多博客报告了在 1.6 上运行 Netbeans 以及他们在早期版本的 NB 中遇到的问题。NB 问题跟踪器还修复了许多影响 Mac OS 1.6 的错误。

如果您无法运行它，您也可以尝试[Netbeans 论坛](http://www.nabble.com/Netbeans.org-f2602.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T14:35:41.303

Eclipse 适用于 java 1.6，有点。Ecplipse 使用 1.5 vm 运行，但它可以使用 1.6 java 编译器为 1.6 编译代码。我使用 netbeans 进行 1.6 开发，看起来还不错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T14:02:54.740

我还没有尝试过，但想不出任何不这样做的理由。

# c# - 为什么 RSACryptoServiceProvider.VerifyHash 需要 LDAP 检查？

> ID：174387
> 
> 赞同：6
> 
> 时间：2008-10-06T13:57:57.543
> 
> 标签：c#, .net, asp.net, encryption, rsacryptoserviceprovider

我最近遇到了一个奇怪的问题[`RSACryptoServiceProvider.VerifyHash`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsacryptoserviceprovider.verifyhash.aspx)。

我有一个使用它进行解密的 Web 应用程序。当运行 Web 服务的用户通过我们的 VPN 执行此操作时，它变得非常非常慢。当他们没有连接或互联网连接时，他们很好。

经过大量挖掘，我发现每次`RSACryptoServiceProvider.VerifyHash`调用它都会发出 LDAP 请求来检查`MyMachineName\ASPNET`。

我们的 WebDev（基于 cassini 的）服务器不会发生这种情况，因为它们以当前用户身份运行，而且它只是在 VPN 上真的很慢，但根本不应该发生。

出于以下几个原因，这似乎是错误的：

*   为什么要检查本地计算机用户的域控制器？
*   为什么在乎？加密/解密无论如何都有效。

有谁知道为什么会发生这种情况或如何最好地解决它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T14:04:37.030

从这个知识库看，它看起来像代码中需要排序的“皱纹”：

[http://support.microsoft.com/kb/948080](http://support.microsoft.com/kb/948080)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T14:25:32.963

谢谢（+1 & ans）

测试和工作。

来自知识库文章：

> SignData 或 VerifyData 方法始终执行发送到域控制器的 OID 查找查询，即使应用程序在本地用户帐户中运行也是如此。这可能会导致签名或验证数据时速度变慢。DC 上发生登录失败审核事件，因为域无法识别客户端计算机的本地用户帐户。因此，OID 查找失败。

这正是我们所看到的。

我们改变了这一行：

```
rsa.VerifyHash( hashedData, CryptoConfig.MapNameToOID( "SHA1" ), signature ); 
```

对此：

```
rsa.VerifyHash( hashedData, null, signature ); 
```

这解决了它。

# php - 为什么 getenv('REMOTE_ADDR') 给我一个空白 IP 地址？

> ID：174393
> 
> 赞同：0
> 
> 时间：2008-10-06T13:59:22.267
> 
> 标签：php, ip-address

这个 PHP 代码...

```
207    if (getenv(HTTP_X_FORWARDED_FOR)) {
208        $ip   = getenv('HTTP_X_FORWARD_FOR');
209        $host = gethostbyaddr($ip);
210    } else {
211        $ip   = getenv('REMOTE_ADDR');
212        $host = gethostbyaddr($ip);
213    } 
```

抛出这个警告......

> **警告：** gethostbyaddr() [function.gethostbyaddr]：地址不在**C:\inetpub...\filename.php中的 abcd 格式，第****212**行

 **似乎*$ip*是空白的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-06T14:09:50.497

在 php.net 上它说如下：

> 如果您的服务器 API 是 ASAPI (IIS)，则该功能`getenv`不起作用。所以，尽量不要使用`getenv('REMOTE_ADDR')`，但是`$_SERVER["REMOTE_ADDR"]`。

您是否尝试过这样做`$_SERVER`？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T14:08:39.050

你为什么不使用

```
$_SERVER['REMOTE_ADDR'] 
```

和

```
$_SERVER['HTTP_X_FORWARDED_FOR'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-28T15:05:32.100

已经给出了更好的解决方案。但仍然：

```
getenv('HTTP_X_FORWARD_FOR'); 
```

应该

```
getenv('HTTP_X_FORWARDED_FOR'); 
```

是的......有时计算机想要他们理解的字符串;-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T14:18:08.530

首先，getenv() 将字符串作为参数。在第 207 行，您应该使用：

```
getenv('HTTP_X_FORWARDED_FOR') 
```

...代替：

```
getenv(HTTP_X_FORWARDED_FOR) 
```

其次，通过 $_SERVER 访问这些变量是一种更可靠的解决方案，因为 getenv() 往往会在不同的平台上显示不同的行为。

此外，如果您通过 CLI 运行此脚本，这些变量可能不起作用。

试试 var_dump($ip); 并查看变量包含的内容。

# database - 在数据库字段名称中编码度量

> ID：174394
> 
> 赞同：6
> 
> 时间：2008-10-06T13:59:34.963
> 
> 标签：database, language-agnostic, coding-style

我有一个关于数据库中字段的问题，这些字段是可能以不同单位显示但仅存储在一个单位中的度量，例如“高度”。

应该在哪里说明“模式单位”？当然，在文档中，等等……但是我们都知道没有人会阅读文档，并且自记录的东西是可取的。

从实际的角度来看，你觉得在数据库字段（比如height_cm）中编码它是怎样的？

乍一看，我觉得这很奇怪，但我发现当不同的人直接处理数据库并且“模式单元”永远不会改变时，避免任何错误是很实用的。

你怎么看？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T14:03:33.507

height_cm 有什么奇怪的？对我来说看上去很好。

有时您会在两个单独的字段中看到度量和单位，这更加痛苦。

只要您知道单位不会改变，我认为 height_cm 是处理它的好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T14:12:36.873

大多数数据库都支持对列进行注释。例如，在 Postgres 中，您可以设置如下评论：

```
COMMENT ON COLUMN my_table.my_column IS 'cm'; 
```

以这种方式存储单元名称意味着您的数据库是自记录的。我还强烈建议使用标准科学单位（即公制）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T14:14:46.603

我同意，将单位添加到字段名称没有错。

我要说的唯一一件事是使命名约定在您的数据库中保持一致 - 即避免您同时拥有`height_cm`并存`mm_width`在于同一个数据库中的情况！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-15T19:05:43.000

警惕可能会改变的措施，如货币。在许多情况下，当度量值更改时，重命名数据库字段是不切实际的。

有一个名为的字段`amount_mk`过去包含以马克为单位的金额，但目前实际上包含以欧元为单位的金额，这是相当愚蠢的。

# c# - 使用 VS 2005 设计抽象表单

> ID：174400
> 
> 赞同：4
> 
> 时间：2008-10-06T14:00:41.267
> 
> 标签：c#, .net, visual-studio, winforms, designer

Visual Studio 中有一个著名的错误，它会阻止您在抽象表单的子类上使用表单设计器。

这个问题已经被[Urban Potato](http://www.urbanpotato.net/default.aspx/document/2001 "请阅读此页面以了解问题及其解决方案的描述。")最优雅地阐明和解决了；那不是我遇到麻烦的部分。麻烦的是，我已经复制了 Urban Potato 描述的技术，并将其包含在我的项目中（恰好相当大），现在每次我尝试打开我的派生形式的设计器时，我都会“可怕地得到微软”对不起，老家伙，但我现在要杀了你”消息（让人想起*A Fish Called Wanda*中的 Otto ），上面写着“Microsoft Visual Studio 2005 遇到问题，需要关闭。对于给您带来的不便，我们深表歉意。”

但**真正**的关键在于：如果您忽略该消息，并将其塞到屏幕右下角之外，您就可以继续工作，完全正常！只是不要单击“发送错误报告”或“不发送”按钮，因为 VS**会**关闭。

尽管如此，这种现象还是很烦人，我非常希望能够工作，而不会觉得我的 IDE 只是*在寻找*一些非常讨厌的方式来报复我，因为我现在就放弃它的明智建议——要不然。

更多有用的信息：同样的行为可以在我办公室的所有其他计算机上复制；这不是我的机器特有的。显然项目/代码中的某些东西让 IDE 感到不安，但至少我知道设计模式有效，因为在我忽略了崩溃消息之后，设计器工作得很好。我只是不知道从哪里开始寻找导致这个问题的东西。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T19:37:51.070

If it were me, I'd try attaching a debugger (maybe another instance of Visual Studio) to the instance that throws the error dialog, and see if the stack trace gives you any insights into what's causing the error.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T15:48:45.290

The reason your are getting this problem might be that your base form is an abstracted class. The reason why the IDE will crashes is because the IDE tries to create an instance of the the abstract class which it cannot do.

It might be that you accidentally marked the internal class as abstract too.

Regards,

JvR

# .net - .Net WebBrowser.DocumentText 没有改变！

> ID：174403
> 
> 赞同：42
> 
> 时间：2008-10-06T14:01:03.013
> 
> 标签：.net, html, browser

在我的 vb.net 程序中，我使用网络浏览器向用户显示 HTML 预览。我之前在服务器上获取 HTML，然后在异步线程上返回并引发事件以使用我返回的 HTML 字符串填充 WebBrowser.DocumentText。

现在我将其设置为获取客户端上的所有信息，而无需访问服务器，并且我正在尝试引发相同的事件。我看着代码通过，它有正确的 HTML 字符串和一切，但是当我尝试做

```
browser.DocumentText = _emailHTML 
```

DocumentText 的内容保持为“ `<HTML></HTML>`”

我只是想知道为什么没有设置 DocumentText。有人有什么建议吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-10-06T14:25:36.190

尝试以下操作：

```
browser.Navigate("about:blank");
HtmlDocument doc = browser.Document;
doc.Write(String.Empty);
browser.DocumentText = _emailHTML; 
```

我发现`WebBrowser`控件通常需要初始化为`about:blank`无论如何。在导航到不同类型的内容（如 text/xml 到 text/html）之间也需要做同样的事情，因为渲染器是不同的（mshtml 用于 text/html，其他内容用于 text/xml）。

（通过[http://geekswithblogs.net/paulwhitblog/archive/2005/12/12/62961.aspx](http://geekswithblogs.net/paulwhitblog/archive/2005/12/12/62961.aspx)）

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2013-03-04T19:48:02.580

我发现了以下内容，并且有效！

```
 webBrowser.Navigate("about:blank");
    webBrowser.Document.OpenNew(false);
    webBrowser.Document.Write(html);
    webBrowser.Refresh(); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-07-23T12:01:07.077

我找到了处理这个问题的最佳方法，如下所示：

```
if (this.webBrowser1.Document == null)
{
    this.webBrowser1.DocumentText = htmlSource;
}
else
{
    this.webBrowser1.Document.OpenNew(true);
    this.webBrowser1.Document.Write(htmlSource);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-10-25T21:52:27.097

这对我有用：

```
webBrowser.Navigate("about:blank");
webBrowser.Document?.Write(htmlString); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-23T09:08:06.780

确保您没有取消*WebBrowser*的关于**about:blank**页面的*导航*事件。*WebBrowser*在设置*DocumentText*之前导航到**about:blank**。因此，如果您想自己处理链接，则需要创建以下*导航*事件处理程序：

 *******```
private void webBrowser1_Navigating(object sender, WebBrowserNavigatingEventArgs e)
{
    if(e.Url.OriginalString.StartsWith("about:"))
    {
        return;
    }
    e.Cancel = true;
    // ...
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-19T03:42:54.717

刚刚在我们的一些旧代码中发现了这一点。

```
_webBrowser.DocumentText = builder.WriteToString( ... );

Application.DoEvents(); 
```

显然 DoEvents 也会让浏览器进入渲染状态

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-19T17:21:48.177

请参考这个答案[c# filenotfoundexception on webbrowser?](https://stackoverflow.com/questions/4737823/c-filenotfoundexception-on-webbrowser/4738244#4738244)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-14T14:56:56.883

在`Application.DoEvents()`WinForms 项目中修复它时，它在 WPF 项目中无关紧要。

我终于通过使用`webBrowser.Write( htmlContent )`（而不是`webBrowser.DocumentText = htmlContent`）让它工作了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-01T08:21:56.240

**这总是有效的**

```
using mshtml;

private IHTMLDocument2 Document
{
    get
    {
        if (Browser.Document != null)
        {
            return Browser.Document.DomDocument as IHTMLDocument2;
        }

        return null;
    }
}

if (Document == null)
{
    Browser.DocumentText = Contents;
}
else
{
    Document.body.innerHTML = Contents;
} 
```

# asp.net - Cookie 和对象

> ID：174412
> 
> 赞同：1
> 
> 时间：2008-10-06T14:04:06.920
> 
> 标签：asp.net

我无法弄清楚如何从编译对象访问 cookie。我正在尝试制作一个已编译的（DLL）对象，该对象将检查用户 cookie，然后将其与数据库进行比较以确认他们具有正确的访问权限。

我可以很好地传递 cookie 信息并且该组件将工作，但我试图让该组件也检查用户 cookie。我什至不确定要使用什么对象。我整个周末都在搜索，我看到了对 httprequest、httpcookie、cookie 和 cookiecollection 的引用。

我可以使用 Request.Cookies("inet")("user_id") 在页面本身上查找 cookie 值，但这在组件中不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T14:10:07.050

对象（App_Code/编译的dll）只能通过静态HttpContext.Current对象访问Request

```
HttpCookie cookie = HttpContext.Current.Request.Cookies["CookieName"]; 
```

（如果不是从 Web 应用程序调用，HttpContext.Current 为 null，因此在单元测试中运行时可能需要检查）（如果这不是 App_Code，则需要引用 System.Web）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T14:12:46.123

如果组件是与您的 Web 应用程序分开的 DLL，您需要传入对 Request 对象的引用。

这就是为什么不只是在调用 DLL 之前读取/检查 ASP.NET 代码中的 cookie 值。像这样将业务逻辑与 Web 层耦合并不是一个好主意。

# c# - Bass.dll 多次播放 PushStream

> ID：174416
> 
> 赞同：1
> 
> 时间：2008-10-06T14:05:13.127
> 
> 标签：c#, audio, bass.dll

我正在使用一个pushStream，它充满了音频数据。将所有数据推送到流后，我正在使用 Bass.BASS_ChannelPlay(playPushStream, false) 播放它，效果很好，但只有一次。我该怎么做才能多次播放（一个接一个）？

将位置重置为 0 并使用 Loop Basflag 什么也没做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T02:23:48.193

看起来这个问题已在 un4seen.com 论坛中提出并回答：

[多次播放 PushStream](http://www.un4seen.com/forum/?topic=9035.msg62456#msg62456)

# java - javadeps的现代等价物？

> ID：174417
> 
> 赞同：1
> 
> 时间：2008-10-06T14:05:44.907
> 
> 标签：java, command-line, dependencies, makefile

我正在寻找 javadeps 的替代品，我曾经用它来生成 Makefile 的各个部分，以指定哪些类依赖于哪些源文件。

不幸的是，javadeps 本身已经有一段时间没有更新了，并且无法解析泛型类型或静态导入。

到目前为止，我发现的最接近的是[Dependency Finder](http://depfind.sourceforge.net/)。它几乎可以满足我的需要，但不将非公共类与其源文件匹配（因为源文件名与类名不匹配。）我当前的项目有一个接口，其唯一的客户端是包私有类的内部类，所以这是一个重大问题。

或者，如果您不知道执行此操作的工具，您如何使用命令行工具在大型 Java 项目中进行增量编译？您是否一次编译整个包？

笔记：

1.  不要将 javadeps 与[jdepend](http://clarkware.com/software/JDepend.html)混淆，后者的用途非常不同。
2.  这个问题是对“[推断java项目依赖关系的工具](https://stackoverflow.com/questions/170025/tool-to-infer-dependencies-for-a-java-project)”的重写，这似乎被三分之二的响应者误解了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T14:16:55.977

我`<depend>`在 ant 中使用任务，这还可以，但不是 100% 值得信赖。据说[JavaMake](http://www.experimentalstuff.com/Technologies/JavaMake/index.html)可以做这个依赖分析，但是好像很少更新，下载页面只是偶尔可用。

# c# - 你能在 F# 中改进这种“代码行算法”吗？

> ID：174418
> 
> 赞同：3
> 
> 时间：2008-10-06T14:06:24.500
> 
> 标签：c#, algorithm, f#

我编写了一个小脚本来遍历文件夹中的文件以计算代码行数。

脚本的核心是计算空格、注释和代码行数的函数。（请注意，目前它是为 C# 量身定制的，不知道多行注释）。

它对我来说看起来不太好 - 有人有更清洁的版本吗？

```
// from list of strings return tuple with count of (whitespace, comments, code)
let loc (arr:List<string>) = 
    let innerloc (whitesp, comment, code) (l:string) = 
        let s = l.Trim([|' ';'\t'|]) // remove leading whitespace
        match s with
        | "" -> (whitesp + 1, comment, code)        //blank lines
        | "{" -> (whitesp + 1, comment, code)       //opening blocks
        | "}" -> (whitesp + 1, comment, code)       //closing blocks
        | _ when s.StartsWith("#") -> (whitesp + 1, comment, code)  //regions
        | _ when s.StartsWith("//") -> (whitesp, comment + 1, code) //comments
        | _ -> (whitesp, comment, code + 1)

    List.fold_left innerloc (0,0,0) arr 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T16:06:07.970

我认为你所拥有的很好，但这里有一些混合起来的品种。（此解决方案重复了您忽略尾随空格的问题。）

```
type Line =
    | Whitespace = 0
    | Comment = 1
    | Code = 2
let Classify (l:string) =         
    let s = l.TrimStart([|' ';'\t'|])
    match s with        
    | "" | "{" | "}" -> Line.Whitespace
    | _ when s.StartsWith("#") -> Line.Whitespace
    | _ when s.StartsWith("//") -> Line.Comment
    | _ -> Line.Code
let Loc (arr:list<_>) =     
    let sums = Array.create 3 0
    arr 
    |> List.iter (fun line -> 
        let i = Classify line |> int
        sums.[i] <- sums.[i] + 1)
    sums 
```

“分类”作为一个单独的实体可能在另一个上下文中很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T14:11:16.890

一个更好的站点可能是[refactormycode](http://refactormycode.com/) - 它是为这些问题量身定制的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T14:12:13.083

*除了您将带有尾随*空格的单个大括号视为代码而不是空格这一事实之外，看不出有什么问题。

# multithreading - 如何使用 Win32 API 实现类 java 同步（监视器）？

> ID：174423
> 
> 赞同：0
> 
> 时间：2008-10-06T14:08:50.547
> 
> 标签：multithreading, winapi, mutex, monitor, condition-variable

每个 Java 对象（及其类）都有一个关联的监视器。在 pthread 术语中，Java 监视器等同于可重入互斥锁和条件变量的组合。

对于锁定，Win32 API 提供 Mutex 对象（可重入但重量级）和关键部分（不可重入但轻量级）。它还提供了其他同步结构，例如信号量和事件，但没有明确的条件变量概念。

如果我正在编写一个 JVM，我如何使用这些 Win32 概念来实现 Java 监视器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T21:13:51.243

Windows 有 SignalObjectAndWait() ，它的使用非常类似于在监视器中等待条件变量。您可以使用一个事件（即重置）和一个互斥锁，然后使用 PulseEvent() 来做相当于发送条件变量的信号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T14:36:00.413

我建议您查看[OpenJDK](http://openjdk.java.net/)源代码，了解 ReentrantLock 类是如何实现的。

（我自己没有检查过，所以我不确定答案）。

util.concurrent 锁是使用原生 API 实现的。

# web-services - Log4Net“找不到架构信息”消息

> ID：174430
> 
> 赞同：62
> 
> 时间：2008-10-06T14:11:18.467
> 
> 标签：web-services, logging, schema, web-config, log4net

我决定使用[log4net](http://logging.apache.org/log4net/index.html)作为新 Web 服务项目的记录器。一切正常，但是对于我在其中使用的每个 log4net 标签，我都会收到很多如下所示的消息`web.config`：

> 找不到元素“log4net”的架构信息...

以下是我的相关部分`web.config`：

```
 <configSections>
    <section name="log4net" 
        type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
  </configSections>
  <log4net>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
      <file value="C:\log.txt" />
      <appendToFile value="true" />
      <rollingStyle value="Size" />
      <maxSizeRollBackups value="10" />
      <maximumFileSize value="100KB" />
      <staticLogFileName value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level: %message%newline" />
      </layout>
    </appender>
    <logger name="TIMServerLog">
      <level value="DEBUG" />
      <appender-ref ref="RollingFileAppender" />
    </logger>
  </log4net> 
```

解决了：

1.  将每个 log4net 特定标签复制到一个单独的`xml`文件中。确保`.xml`用作文件扩展名。
2.  将以下行添加到`AssemblyInfo.cs`：

```
[assembly: log4net.Config.XmlConfigurator(ConfigFile = "xmlFile.xml", Watch = true)] 
```

[尼莫](https://stackoverflow.com/users/20774/nemo)补充说：

> 只是向任何人发出警告，请遵循此线程中答案的建议。将 log4net 配置放在 web 服务根目录下的 xml 中可能存在安全风险，因为默认情况下任何人都可以访问它。请注意，如果您的配置包含敏感数据，您可能希望将其放在其他位置。

* * *

@wcm：我尝试使用单独的文件。我将以下行添加到`AssemblyInfo.cs`

```
[assembly: log4net.Config.XmlConfigurator(ConfigFile = "log4net.config", Watch = true)] 
```

并将处理 log4net 的所有内容都放在该文件中，但我仍然收到相同的消息。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-11-08T20:59:55.873

您可以在模式中绑定到`log4net`元素。有一些浮动，大多数都没有完全提供各种可用的选项。我创建了以下 xsd 以提供尽可能多的验证：http: [//csharptest.net/downloads/schema/log4net.xsd](http://csharptest.net/downloads/schema/log4net.xsd)

`log4net`您可以通过修改元素轻松地将其绑定到 xml 中：

```
<log4net 
     xsi:noNamespaceSchemaLocation="http://csharptest.net/downloads/schema/log4net.xsd" 
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-06T20:43:56.507

我有不同的看法，需要以下语法：

```
[assembly: log4net.Config.XmlConfigurator(ConfigFile = "log4net.xml", Watch = true)] 
```

这与 xsl 的上一篇文章不同，但对我来说有所不同。看看这篇[博文](https://web.archive.org/web/20160314225551/http://verysimple.com/2007/02/07/could-not-find-schema-information-for-the-element-log4net/)，它帮助了我。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-24T20:07:50.990

只是向任何人发出警告，请遵循此线程中答案的建议。将 log4net 配置放在 web 服务根目录下的 xml 中可能存在安全风险，因为默认情况下任何人都可以访问它。请注意，如果您的配置包含敏感数据，您可能希望将其放在其他位置。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-06T14:33:14.537

我相信您会看到该消息，因为 Visual Studio 不知道如何验证配置文件的 log4net 部分。您应该能够通过将 log4net XSD 复制到 C:\Program Files\Microsoft Visual Studio 8\XML\Schemas（或安装 Visual Studio 的任何位置）来解决此问题。作为额外的奖励，您现在应该获得对 log4net 的智能感知支持

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-02T15:23:15.440

在[罗杰的回答](https://stackoverflow.com/a/275197/64348)中，他提供了一个模式，这对我来说效果很好，除了评论者提到的地方

> 此 XSD 抱怨使用自定义附加程序。它只允许从默认集合（定义为枚举）中添加附加程序，而不是简单地将其设为字符串字段

我修改了具有`xs:simpletype`命名的原始模式`log4netAppenderTypes`并删除了枚举。相反，我将其限制为基本的 .NET 类型模式（我说基本是因为它只支持**类型名称**或**类型名称、程序集**——但是有人可以扩展它。

只需将`log4netAppenderTypes`XSD 中的定义替换为以下内容：

```
<xs:simpleType name="log4netAppenderTypes">
  <xs:restriction base="xs:string">
    <xs:pattern value="[A-Za-z_]\w*(\.[A-Za-z_]\w*)+(\s*,\s*[A-Za-z_]\w*(\.[A-Za-z_]\w*)+)?"/>
  </xs:restriction>
</xs:simpleType> 
```

如果他想将其包含在他的官方版本中，我会将其传回给原作者。在此之前，您必须下载和修改 xsd 并以相对方式引用它，例如：

```
<log4net
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="../../../Dependencies/log4net/log4net.xsd">
  <!-- ... -->
</log4net> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-07-24T09:16:56.837

实际上，您不需要坚持使用 .xml 扩展名。您可以在 ConfigFileExtension 属性中指定任何其他扩展名：

```
[assembly: log4net.Config.XmlConfigurator(ConfigFile = "log4net.config", ConfigFileExtension=".config", Watch = true)] 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-07T07:37:57.543

@steve_mtl：更改文件扩展名`.config`以`.xml`解决问题。谢谢你。

@Wheelie：我无法尝试您的建议，因为我需要一个适用于未修改的 Visual Studio 安装的解决方案。

* * *

总结一下，解决问题的方法如下：

1.  将每个 log4net 特定标签复制到一个单独的`xml`文件中。确保`.xml`用作文件扩展名。
2.  将以下行添加到`AssemblyInfo.cs`：

    `[assembly: log4net.Config.XmlConfigurator(ConfigFile = "xmlFile.xml", Watch = true)]`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-12T07:39:24.190

对于 VS2008，只需将 log4net.xsd 文件添加到您的项目中；VS 查看项目文件夹以及 Wheelie 提到的安装目录。

此外，使用 .config 扩展名而不是 .xml 可以避免安全问题，因为默认情况下 IIS 不提供 *.config 文件。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-06T14:21:32.423

您是否尝试过使用单独的 log4net.config 文件？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-07-31T11:22:44.490

我得到了一个测试 asp 项目，通过将 xsd 文件放入如上所述的 Visual Studio 架构文件夹中（对我来说它是 C:\Program Files\Microsoft Visual Studio 8\XML\Schemas），然后让我`web.config`看起来像这样：

```
<?xml version="1.0"?>
<!-- 
    Note: As an alternative to hand editing this file you can use the 
    web admin tool to configure settings for your application. Use
    the Website->Asp.Net Configuration option in Visual Studio.
    A full list of settings and comments can be found in 
    machine.config.comments usually located in 
    \Windows\Microsoft.Net\Framework\v2.x\Config 
-->
<configuration>
  <configSections>

    <section  name="log4net" 
              type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>

  </configSections>
  <appSettings>

  </appSettings>
  <connectionStrings>

  </connectionStrings>
  <system.web>
    <trace enabled="true" pageOutput="true"  />
    <!-- 
            Set compilation debug="true" to insert debugging 
            symbols into the compiled page. Because this 
            affects performance, set this value to true only 
            during development.
        -->
    <compilation debug="true" />
    <!--
            The <authentication> section enables configuration 
            of the security authentication mode used by 
            ASP.NET to identify an incoming user. 
        -->
    <authentication mode="Windows" />

    <customErrors mode="Off"/>
    <!--
      <customErrors mode="Off"/>

            The <customErrors> section enables configuration 
            of what to do if/when an unhandled error occurs 
            during the execution of a request. Specifically, 
            it enables developers to configure html error pages 
            to be displayed in place of a error stack trace.

    <customErrors mode="On" defaultRedirect="GenericErrorPage.htm">
      <error statusCode="403" redirect="NoAccess.htm" />
      <error statusCode="404" redirect="FileNotFound.htm" />
    </customErrors>
        -->

  </system.web>
    <log4net xsi:noNamespaceSchemaLocation="http://csharptest.net/downloads/schema/log4net.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <appender name="LogFileAppender" type="log4net.Appender.FileAppender">
      <!-- Please make shure the ..\\Logs directory exists! -->
      <param name="File" value="Logs\\Log4Net.log"/>
      <!--<param name="AppendToFile" value="true"/>-->
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%d [%t] %-5p %c %m%n"/>
      </layout>
    </appender>
    <appender name="SmtpAppender" type="log4net.Appender.SmtpAppender">
      <to value="" />
      <from value="" />
      <subject value="" />
      <smtpHost value="" />
      <bufferSize value="512" />
      <lossy value="true" />
      <evaluator type="log4net.Core.LevelEvaluator">
        <threshold value="WARN"/>
      </evaluator>
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%newline%date [%thread] %-5level %logger [%property] - %message%newline%newline%newline" />
      </layout>
    </appender>

    <logger name="File">
      <level value="ALL" />
      <appender-ref ref="LogFileAppender" />
    </logger>
    <logger name="EmailLog">
      <level value="ALL" />
      <appender-ref ref="SmtpAppender" />
    </logger>
  </log4net>
</configuration> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-03-07T23:16:49.430

无需修改您的 Visual Studio 安装，并考虑正确的版本控制/等。在团队的其他成员中，将 .xsd 文件添加到您的解决方案中（作为“解决方案项”），或者如果您只想将它​​用于特定项目，只需将其嵌入其中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-15T17:07:15.130

我注意到它有点晚了，但是如果您查看 log4net 提供的示例，您会看到它们将所有配置数据放入 app.config 中，不同之处在于 config 部分的注册：

```
<!-- Register a section handler for the log4net section -->
<configSections>
    <section name="log4net" type="System.Configuration.IgnoreSectionHandler" />
</configSections> 
```

将其定义为“System.Configuration.IgnoreSectionHandler”类型是否是 Visual Studio 未在 log4net 内容上显示任何警告/错误消息的原因？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-03-02T18:09:57.280

我跟着[Kit](https://stackoverflow.com/users/64348/kit)的回答[https://stackoverflow.com/a/11780781/6139051](https://stackoverflow.com/a/11780781/6139051)并且它不适用于像“log4net.Appender.TraceAppender，log4net”这样的 AppenderType 值。log4net.dll 程序集的 AssemblyTitle 为“log4net”，即程序集名称内部没有点，这就是 Kit 答案中的正则表达式不起作用的原因。我必须在正则表达式的第三个括号组之后添加问号，之后它就可以完美地工作了。

修改后的正则表达式如下所示：

```
<xs:pattern value="[A-Za-z_]\w*(\.[A-Za-z_]\w*)+(\s*,\s*[A-Za-z_]\w*(\.[A-Za-z_]\w*)?+)?"/> 
```

# sql - 查询显示多对多关系中的关联列表

> ID：174438
> 
> 赞同：1
> 
> 时间：2008-10-06T14:15:04.560
> 
> 标签：sql, sql-server, database

我有两个表**Book**和**Tag**，书籍使用关联表**BookTag**进行标记。我想创建一个包含书籍列表的报告，并为每本书创建一个书籍标签列表。标签 ID 就足够了，标签名称不是必需的。

例子：

```
Book table:
Book ID | Book Name
28      | Dracula

BookTag table:
Book ID | Tag ID
28      | 101
28      | 102 
```

在我的报告中，我想显示第 28 本书的标签为 101 和 102：

```
Book ID | Book Name | Tags
28      | Dracula   | 101, 102 
```

有没有办法在线执行此操作，而不必求助于函数或存储过程？我正在使用 SQL Server 2005。

*[请注意，在将子查询中的多个结果合并为单个逗号分隔值](https://stackoverflow.com/questions/111341/combine-multiple-results-in-a-subquery-into-a-single-comma-separated-value)中已经提出了相同的问题，但解决方案涉及创建一个函数。我在问是否有办法解决这个问题，而不必创建函数或存储过程。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T14:41:54.973

你几乎可以做到。我没有解决的唯一问题是逗号分隔符。这是一个关于使用空格分隔标签的类似结构的查询。

```
SELECT em.Code,
    (SELECT et.Name + ' '  AS 'data()'
        FROM tblEmployeeTag et
            JOIN tblEmployeeTagAssignment eta ON et.Id = eta.EmployeeTag_Id AND eta.Employee_Id = em.id
    FOR XML PATH('') ) AS Tags
FROM tblEmployee em 
```

编辑：

这是使用您的表格并使用逗号分隔符的完整版本：

```
SELECT bk.Id AS BookId,
        bk.Name AS BookName,
    REPLACE((SELECT LTRIM(STR(bt.TagId)) + ', '  AS 'data()'
        FROM BookTag bt
        WHERE bt.BookId = bk.Id         
        FOR XML PATH('') ) + 'x', ', x','') AS Tags
FROM Book bk 
```

我想为了将来的参考，我应该解释一下发生了什么。'data()' 列名是与 FOR XML PATH 语句相关的特殊值。它使 XML 文档被呈现，就好像您在生成的 XML 的根节点上执行了 .InnerText 一样。
REPLACE 语句是删除尾随逗号的技巧。通过将唯一字符（我随机选择'x'）附加到标签列表的末尾，我可以搜索逗号空格字符并将其替换为空字符串。这让我可以只去掉最后一个逗号。这假设您永远不会在标签中包含该字符序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T14:22:30.083

除非您知道标签 ID/名称是什么并且可以将它们硬编码到您的查询中，否则恐怕答案是否定的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T14:32:11.013

如果您知道一本书的最大标签数，您可以使用枢轴将它们放到同一行，然后使用 COALESCE，但总的来说，我不相信有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T14:41:04.133

最干净的解决方案可能是使用自定义 C# CLR 聚合函数。我们发现这非常有效。[您可以在http://dotnet-therapy.blogspot.com/2007/05/user-defined-aggregate-function-in-sql.html](http://dotnet-enthusiast.blogspot.com/2007/05/user-defined-aggregate-function-in-sql.html)找到创建说明

# java - Maven中的复杂配置文件

> ID：174439
> 
> 赞同：3
> 
> 时间：2008-10-06T14:15:07.820
> 
> 标签：java, maven-2, build-process

我一直在查看 Maven 中的配置文件以选择不同的依赖项集。当您想要构建与发布构建不同的调试构建时，这很好。我的问题是我想做的远不止这些。对于我的应用程序（J2ME 只是众多目标之一的移动 Java 应用程序），可能存在大量可能的构建变体组合。

使用一些虚构的命令行语法来说明我想看到的内容，我想输入类似的内容

```
mvn -Pmidp,debug,local-resources 
```

在这种情况下，Maven 所做的是构建三个不同的构建。我想要做的是使用这三个（或更多，或更少）开关来影响一个构建。所以我会得到一个带有“本地资源”的以 MIDP 为目标的调试版本（不管这对我意味着什么——我相信你可以想象出更好的例子）。

我能想到的唯一方法是拥有很多很多的个人资料，这会变得很成问题。在我的例子中，我有

```
-Pmidp-debug-localresources
-Pmidp-release-localresources
-Pmidp-debug-remoteresources
-Pmidp-release-remoteresources
... 
```

每个都有自己令人沮丧的相似的依赖项和构建标记集。

我不确定我是否已经足够好地解释了我的问题，但如果留下评论，我可以重新编写问题以澄清它。

**更新：**

这个问题实际上是无效的，因为我对 Maven 的工作方式做出了错误的假设。

```
-Pmidp,debug,local-resources 
```

不进行 3 次构建。事实上，它在一个构建中启用了这 3 个配置文件，具有讽刺意味的是，这正是我最初所寻找的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T14:27:00.417

Maven 方式是创建大量复杂度较低的工件。我想说你最好的选择是将每个构建的公共部分抽象为一个单独的工件，然后为每个构建创建一个项目来定义构建特定的部分。这会给你留下很多项目，但每个项目都会简单得多。

# excel - 如何自动将 Excel xls 文件转换为 Excel xml 格式？

> ID：174446
> 
> 赞同：5
> 
> 时间：2008-10-06T14:16:57.613
> 
> 标签：excel

我有大约 200 个标准 Excel 2003 格式的 Excel 文件。

我需要将它们全部保存为 Excel xml - 基本上与打开每个文件并选择**另存为...**然后选择**另存为类型相同：** *XML 电子表格*

你知道自动化该任务的任何简单方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T23:14:40.477

这是一个例程，它将转换单个目录中具有 .xls 扩展名的所有文件。

它采用直截了当的方法。工作簿中的任何 VBA 代码都将被删除，工作簿不会以 .xlsm 扩展名保存。不会显示任何不兼容警告，而是自动接受更改。

```
Sub Convert_xls_Files()

Dim strFile As String
Dim strPath As String

    With Application
        .EnableEvents = False
        .DisplayAlerts = False
        .ScreenUpdating = False
    End With
'Turn off events, alerts & screen updating

        strPath = "C:\temp\excel\"
        strFile = Dir(strPath & "*.xls")
'Change the path as required

    Do While strFile <> ""
        Workbooks.Open (strPath & strFile)
        strFile = Mid(strFile, 1, Len(strFile) - 4) & ".xlsx"
        ActiveWorkbook.SaveAs Filename:=strPath & strFile, FileFormat:=xlOpenXMLWorkbook
        ActiveWorkbook.Close True
        strFile = Dir
    Loop
'Opens the Workbook, set the file name, save in new format and close workbook

    With Application
        .EnableEvents = True
        .DisplayAlerts = True
        .ScreenUpdating = True
    End With
'Turn on events, alerts & screen updating

End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T14:27:24.317

您可以修改我在此处发布的代码：

[http://www.atalasoft.com/cs/blogs/loufranco/archive/2008/04/01/loading-office-documents-in-net.aspx](http://www.atalasoft.com/cs/blogs/loufranco/archive/2008/04/01/loading-office-documents-in-net.aspx)

它显示了如何保存为 PDF（Word 显示在博客中，但如果您下载解决方案，它有 Excel 和 PPT 的代码）。

您需要找到保存为新格式而不是导出的功能（可能最简单的方法是在Excel中记录自己的宏，然后查看代码）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T14:45:29.193

打开它们，然后按 ALT+F11 进入宏编辑器并输入如下内容：

```
Sub SaveAllAsXml()
    Dim wbk As Workbook
    For Each wbk In Application.Workbooks
        wbk.SaveAs FileFormat:=XlFileFormat.xlXMLSpreadsheet
    Next
End Sub 
```

然后按 F5 运行它。可能需要一些调整，因为我还没有测试过。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T21:27:22.050

听起来像是我最喜欢的最被低估的语言的工作：VBScript！

把它放在一个文本文件中，并制作扩展名“.vbs”：

```
set xlapp = CreateObject("Excel.Application")
set fso = CreateObject("scripting.filesystemobject")
set myfolder = fso.GetFolder("YOURFOLDERPATHHERE")
set myfiles = myfolder.Files
for each f in myfiles
   set mybook = xlapp.Workbooks.Open(f.Path)
   mybook.SaveAs f.Name & ".xml", 47
   mybook.Close
next 
```

我还没有测试过这个，但它应该可以工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T14:44:34.920

最简单的方法是为一个文件录制宏，然后手动编辑宏以使用循环对文件夹中的文件执行此类操作。在宏中，您可以使用标准 VB 函数来获取目录中的所有文件并过滤它们。您可以查看[http://www.xtremevbtalk.com/archive/index.php/t-247211.html](http://www.xtremevbtalk.com/archive/index.php/t-247211.html)了解更多信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-17T12:28:30.430

```
Const xlXLSX = 51

REM 51 = xlOpenXMLWorkbook (without macro's in 2007-2013, xlsx)
REM 52 = xlOpenXMLWorkbookMacroEnabled (with or without macro's in 2007-2013, xlsm)
REM 50 = xlExcel12 (Excel Binary Workbook in 2007-2013 with or without macro's, xlsb)
REM 56 = xlExcel8 (97-2003 format in Excel 2007-2013, xls)

dim args
dim file
dim sFile
set args=wscript.arguments

dim wshell
Set wshell = CreateObject("WScript.Shell")

Set objExcel = CreateObject("Excel.Application")

Set objWorkbook = objExcel.Workbooks.Open( wshell.CurrentDirectory&"\"&args(0))

objExcel.DisplayAlerts = FALSE

objExcel.Visible = FALSE

objWorkbook.SaveAs wshell.CurrentDirectory&"\"&args(1), xlXLSX

objExcel.Quit

Wscript.Quit 
```

# c++ - 对于 STL 或 !STL，这是个问题

> ID：174449
> 
> 赞同：41
> 
> 时间：2008-10-06T14:17:08.470
> 
> 标签：c++, stl, containers

毫无疑问，我会选择将 STL 用于大多数 C++ 编程项目。然而，最近有人向我提出了这个问题，“有没有什么情况下你不会使用 STL？”...

我想得越多，我就越意识到也许应该在某些情况下我选择不使用 STL ......例如，一个非常大的长期项目，其代码库预计将持续数年......也许精确满足项目需求的定制容器解决方案值得最初的开销吗？你怎么看，有没有什么情况下你会选择不使用 STL？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-10-06T14:28:59.883

不使用 STL 的主要原因是：

1.  您的 C++ 实现是旧的并且具有可怕的模板支持。
2.  您不能使用动态内存分配。

两者在实践中都是非常不常见的要求。

对于一个长期的项目来说，滚动你自己的与 STL 功能重叠的容器只会增加维护和开发成本。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-10-06T15:21:18.903

具有严格内存要求的项目（例如嵌入式系统）可能不适合 STL，因为它可能难以控制和管理从堆中取出和返回的内容。正如 Evan 所提到的，编写适当的分配器可以帮助解决这个问题，但是如果您要计算使用的每个字节或关注内存碎片，那么手动推出针对您的特定问题量身定制的解决方案可能更明智，因为 STL 已经过优化对于最一般的用法。

对于特定情况，您也可以选择不使用 STL，因为存在更多适用的容器，这些容器不在当前标准中，例如 boost::array 或 boost::unordered_map。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-06T14:33:13.227

使用 stl 有很多优点。对于长期项目，收益大于成本。

1.  新程序员从一开始就能够理解容器，这让他们有更多时间学习项目中的其他代码。（假设他们已经像任何有能力的 C++ 程序员一样了解 STL）
2.  修复容器中的错误会浪费时间，而这些时间可以用来增强业务逻辑。
3.  很可能您不会编写它们，因为无论如何都已实现 STL。

话虽如此，STL 容器根本不处理并发。因此，在需要并发的环境中，我会使用其他容器，例如 Intel TBB 并发容器。这些使用细粒度锁定要先进得多，这样不同的线程可以同时修改容器，而您不必序列化对容器的访问。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-06T14:22:01.877

通常，我发现最好的办法是使用带有自定义分配器的 STL，而不是用手动滚动的容器替换 STL 容器。STL 的好处是您只需为使用的内容付费。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-06T14:22:41.377

我认为这是典型的构建 vs 购买场景。但是，我认为在这种情况下，我几乎总是会“购买”并使用 STL - 或更好的解决方案（也许来自 Boost），然后再推出自己的解决方案。您应该将大部分精力集中在应用程序的功能上，而不是它使用的构建块上。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-06T14:30:18.397

我真的不这么认为。在制作我自己的容器时，我什至会尝试使它们与 STL 兼容，因为通用算法的力量太大了，不能放弃。至少应该在名义上使用 STL，即使您所做的只是编写自己的容器并为它专门化每个算法。这样，每个排序算法都可以调用 sort(c.begin(), c.end())。如果您专门排序以产生相同的效果，即使它的工作方式不同。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-07T01:05:13.233

Symbian 编码。

STLPort 确实支持 Symbian 9，因此反对使用 STL 的理由比以前弱（“它不可用”是一个非常有说服力的理由），但 STL 对所有 Symbian 库来说仍然是陌生的，所以可能比仅仅更麻烦以 Symbian 的方式做事。

当然，基于这些理由可能会争论说，为 Symbian 编码不是“C++ 编程项目”。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-06T14:44:08.183

我参与过的大多数项目的代码库都比任何真正可用的 STL 版本都老——因此我们选择现在不介绍它。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-06-27T14:34:43.093

**介绍：**

STL 是一个很棒的库，在许多情况下都很有用，但它肯定不能解决所有情况。回答 STL 或 !STL 就像回答“STL 是否满足您的需要？”

**STL 的优点**

*   在大多数情况下，STL 都有一个适合给定解决方案的容器。
*   有据可查
*   众所周知（程序员通常已经知道，进入项目的时间更短）
*   它经过测试并且稳定。
*   它是跨平台的
*   它包含在每个编译器中（不添加第三个库依赖项）
*   STL 已经实施并准备就绪
*   STL 是闪亮的，...

**STL的对比**

你需要一个简单的图形、红黑树或一个非常复杂的元素数据库，通过量子计算机管理并发访问，这并不重要。事实是，STL 不会，也永远不会解决所有问题。

以下方面只是几个例子，但它们基本上是这个事实的结果：STL 是一个有限制的真正库。

*   异常：STL 中继异常，因此如果出于任何原因您不能接受异常（例如安全关键），则不能使用 STL。对！异常可能被禁用，但这并不能解决 STL 在它们上中继的设计，最终会导致崩溃。

*   需要特定（尚未包括）的数据结构：图、树等。

*   复杂性的特殊限制：您可能会发现 STL 通用容器不是最适合您的瓶颈代码的。

*   并发注意事项：要么您需要并发，而 STL 不提供您需要的东西（例如，读写锁不能（容易）使用，因为双向`[] operator`）。您可以设计一个容器，利用多线程来更快地访问/搜索/插入/无论什么。

*   STL 需要满足您的需求，但反过来也是如此：您需要满足 STL 的需求。不要尝试`std::vector`在具有 1K 非托管 RAM 的嵌入式微控制器中使用。

*   与其他库的兼容性：可能是由于历史原因，您使用的库不接受 STL（例如 QtWidgets 大量使用它自己的 QList）。双向转换容器可能不是最佳解决方案。

* * *

**实现自己的容器**

读完之后，你可能会想：“*好吧，我相信我可能会为我的具体案例做一些比 STL 做得更好的事情。* ”等等！

正确地实现你的容器很快就变成了一项艰巨的任务：它不仅要实现一些可行的东西，你可能还必须：

*   深入记录，包括限制、算法复杂度等。
*   期待错误并解决它们
*   传入的额外需求：您知道，缺少此功能，类型之间的转换等。
*   一段时间后，您可能想要重构并更改所有依赖项（为时已晚？）
*   ……

> 像容器一样在代码深处使用的代码肯定需要时间来实现，并且应该小心谨慎。

* * *

**使用第三方库**

不是 STL 并不一定意味着定制。网络上有很多好的库，有些甚至具有许可的开源许可证。

添加或不添加额外的 3rd 方库是另一个主题，但值得考虑。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-06T17:15:11.340

可能发生这种情况的一种情况是，当您已经在使用已经提供了 STL 所需功能的外部库时。例如，我的公司在空间有限的区域开发了一个应用程序，并且已经将 Qt 用于窗口工具包。由于 Qt 提供了类似 STL 的容器类，因此我们使用它们而不是将 STL 添加到我们的项目中。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-06T14:31:53.963

我发现在多线程代码中使用 STL 存在问题。即使您不跨线程共享 STL 对象，许多实现也使用非线程安全的构造（例如 ++ 用于引用计数而不是互锁增量样式，或者具有非线程安全的分配器）。

在每种情况下，我仍然选择使用 STL 并解决问题（有足够的钩子来获得你想要的东西）。

即使您选择创建自己的集合，对迭代器遵循 STL 样式也是一个好主意，这样您就可以使用仅在迭代器上运行的算法和其他 STL 函数。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-06T15:30:55.077

我看到的主要问题是必须与依赖非抛出 operator new 的遗留代码集成。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-06T15:41:24.323

我大约在 1984 年左右开始编写 C 语言并且从未使用过 STL。多年来，我推出了自己的函数库，当 STL 还不稳定或缺乏跨平台支持时，它们已经发展壮大。我的通用库已经发展到包含其他人的代码（主要是 libjpeg、libpng、ffmpeg、mysql 等）和其他一些代码，我宁愿将其中的外部代码量保持在最低限度。我确信现在 STL 很棒，但坦率地说，我对我的工具箱中的项目感到满意，并且认为此时不需要加载更多工具。但我确实看到了新程序员可以通过使用 STL 实现的巨大飞跃，而无需从头开始编写所有代码。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-10-27T12:04:29.130

标准 C++ 反常地允许某些[迭代器操作的实现抛出异常](https://stackoverflow.com/questions/7902452/may-stl-iterator-methods-throw-an-exception)。在某些情况下，这种可能性可能会出现问题。因此，您可以实现自己的简单容器，保证不会为关键操作抛出异常。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-03-04T11:06:38.553

由于在我之前回答的几乎每个人似乎都对 STL 容器如此热衷，我认为从我自己遇到的实际问题中编制一份不使用它们的充分理由列表会很有用。

这些可以合理地分为三大类：

1）效率低下

STL 容器通常运行速度较慢并且为作业使用过多内存。造成这种情况的部分原因可以归咎于底层数据结构和算法的过于通用的实现，额外的性能成本源自与手头任务无关的大量 API 要求所需的所有额外设计约束。

鲁莽的内存使用和糟糕的性能齐头并进，因为 CPU 在缓存上以 64 字节的行寻址内存，如果您不使用引用的局部性来发挥您的优势，那么您会浪费周期和宝贵的 Kb 缓存内存.

例如，std::list 每个元素需要 24 个字节，而不是最佳的 4 个。

[https://lemire.me/blog/2016/09/15/the-memory-usage-of-stl-containers-can-be-surprising/](https://lemire.me/blog/2016/09/15/the-memory-usage-of-stl-containers-can-be-surprising/)

这是因为它是通过打包两个 64 位指针、1 个 int 和 4 个字节的内存填充来实现的，而不是像分配少量连续内存并单独跟踪正在使用的元素或使用指针 xor 这样基本的事情将两个迭代方向存储在一个指针中的技术。

[https://en.wikipedia.org/wiki/XOR_linked_list](https://en.wikipedia.org/wiki/XOR_linked_list)

根据您的程序需求，这些低效率可能而且确实会增加大量的性能损失。

2) 限制/爬行标准

当然，有时问题是您需要一些完全通用的函数或稍微不同的容器类，而这些容器类只是没有在 STL 中实现，例如优先级队列中的 reduce_min()。

一种常见的做法是然后将容器包装在一个类中，并使用容器外部的额外状态和/或对容器方法的多次调用自己实现缺少的功能，这可能会模拟所需的行为，但性能要低得多并且 O () 复杂性高于数据结构的实际实现，因为无法扩展容器的内部工作。或者，您最终将两个或多个不同的容器混在一起，因为您同时需要两个或多个在任何给定 STL 容器中根本不兼容的东西，例如 minmax 堆、trie（因为您需要能够使用不可知论的指针）， ETC。

这些解决方案可能很丑陋，并且会增加其他低效率，但语言发展趋势的方式是只添加新的 STL 方法来匹配 C++ 的特性蔓延，并忽略任何缺失的核心功能。

3）并发/并行

STL 容器不是线程安全的，更不用说并发了。在当今 16 线程消费 CPU 的时代，令人惊讶的是，现代语言的默认容器实现仍然需要您围绕每个内存访问编写互斥锁，就像 1996 年一样。对于任何非平凡的并行程序来说，这是一种重要的是，因为有内存屏障会迫使线程序列化它们的执行，如果这些发生的频率与 STL 调用相同，那么您可以告别并行性能。

简而言之，只要您不关心性能、内存使用、功能或并行性，STL 就很好。STL 当然仍然很好，因为很多时候您不受任何这些问题的约束，并且其他优先事项（如可读性、可移植性、可维护性或编码速度）优先。

# algorithm - 控制流的例外情况

> ID：174458
> 
> 赞同：4
> 
> 时间：2008-10-06T14:19:31.773
> 
> 标签：algorithm, exception, data-structures, control-flow

这里有一篇关于跨应用程序控制流的[有趣帖子。](https://stackoverflow.com/questions/134698/catching-exceptions-as-expected-program-execution-flow-control)

好吧，最近，我遇到了一个有趣的问题。在潜在（实际上）无限递归序列中生成第 n 个值。这个特定的算法将在它成功的时候至少有 10-15 个堆栈引用深度。我的第一个想法是抛出一个看起来像这样（C#）的 SuccessException：

```
class SuccessException : Exception
{
    public string Value
    { get; set; }

    public SuccessException(string value)
        : base()
    {
        Value = value;
    }
} 
```

然后做这样的事情：

```
try
{
    Walk_r(tree);
}
catch (SuccessException ex)
{
    result = ex.Value;
} 
```

然后我的想法又回到了这里，我一遍又一遍地听到从不使用异常进行流量控制。有没有借口？如果你要实现它，你将如何构建这样的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T14:22:46.150

在这种情况下，我将查看您的 Walk_r 方法，您应该有一些返回值的东西，抛出异常以指示成功，这不是一种常见的做法，并且至少会让任何看到代码的人感到非常困惑。更不用说与异常相关的开销了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T14:30:40.440

walk_r 应该在被击中时简单地返回值。这是一个非常标准的递归示例。我看到的唯一潜在问题是您说它可能是无穷无尽的，这必须在 walk_r 代码中通过保持递归深度的计数并停在某个最大值来补偿。

异常实际上使编码非常奇怪，因为方法调用现在抛出异常以返回值，而不是简单地返回“正常”。

```
try
{
    Walk_r(tree);
}
catch (SuccessException ex)
{
    result = ex.Value;
} 
```

变成

```
result = Walk_r(tree); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T15:00:06.963

我将在这里扮演魔鬼的拥护者并说坚持例外以表示成功。抛出/捕获可能很昂贵，但与搜索本身的成本相比可能微不足道，并且可能比提前退出该方法更容易混淆。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T14:26:09.310

将异常作为算法的一部分抛出并不是一个好主意，尤其是在 .net 中。在某些语言/平台中，抛出异常时非常有效，例如，当可迭代对象耗尽时，它们通常是有效的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T14:28:28.823

为什么不只返回结果值？如果它返回任何东西，假设它是成功的。如果返回值失败，则表示循环失败。

如果您必须从失败中恢复过来，那么我建议您抛出异常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T14:28:40.867

使用异常的问题是 tey （在事物的宏伟计划中）非常低效和缓慢。在递归函数中使用 if 条件在需要时返回肯定会很容易。老实说，由于现代 PC 上的内存量不大（尽管并非不可能），您只需少量递归调用（<100）就会出现堆栈溢出。

如果堆栈是一个真正的问题，那么可能需要“创造性”并实施“深度限制搜索策略”，允许函数从递归返回并从最后一个（最深的）节点重新开始搜索。

总结一下：异常应该只在特殊情况下使用，我认为函数调用的成功不符合这样的条件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T14:30:32.813

在我的书中，在正常程序流中使用异常是有史以来最糟糕的做法之一。考虑一下可怜的 sap，他们正在寻找被吞下的异常，并且正在运行一个调试器，该调试器设置为在发生异常时停止。那家伙现在生气了……而且他有一把斧头。:P

# windows-mobile - Windows Mobile 有哪些好的第三方控件？

> ID：174459
> 
> 赞同：0
> 
> 时间：2008-10-06T14:20:49.087
> 
> 标签：windows-mobile

我们正在开发一个 windows mobile 6.1 应用程序，并希望用户界面看起来比标准的战舰灰色更好。有没有人有任何使用 3rd 方控件的经验，可以使 Windows 移动应用程序看起来像 WPF/Silverlight/Iphone 一样的界面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-17T07:26:05.147

请检查：[http ://www.resco.net/developer/mobileformstoolkit/overview.aspx](http://www.resco.net/developer/mobileformstoolkit/overview.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T14:26:50.370

[在这个](https://stackoverflow.com/questions/35907/3rd-party-ui-components-for-net-compact-framework)问题中可能会有一些有用的回复。

# sed - 从多个文件中删除多行文本

> ID：174472
> 
> 赞同：3
> 
> 时间：2008-10-06T14:23:30.003
> 
> 标签：sed, grep, multiline

我有一堆 java 文件，我想从中删除带有许可证的 javadoc 行 [我在我的代码上更改它]。

我正在寻找的模式是

`^\* \* ProjectName .* USA\.$`

但跨行匹配

有没有办法 sed [或 Windows/Linux 中常用的编辑器] 可以搜索/替换多行模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T14:25:13.167

这是我最喜欢的 sed 教程中的[适当参考点](http://www.grymoire.com/Unix/Sed.html#uh-47)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-10T14:22:05.900

可能有人仍在不时寻找这样的解决方案。这是一个。

使用 awk 查找要删除的行。然后使用 diff 删除行并让 sed 清理。

```
awk "/^\* \* ProjectName /,/ USA\.$/" input.txt \
  | diff - input.txt \
  | sed -n -e"s/^> //p" \
  >output.txt 
```

警告说明：如果第一个模式存在而第二个不存在，您将丢失第一个模式下方的所有文本 - 所以首先检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T14:34:48.810

是的。您是否使用 sed、awk、perl 或其他工具来解决此问题？

大多数正则表达式工具允许您指定多行模式。请注意过于贪婪的正则表达式，否则它们会匹配注释之间的代码（如果存在）。

这是一个例子：

```
/\*(?:.|[\r\n])*?\*/
perl -0777ne 'print m!/\*(?:.|[\r\n])*?\*/!g;' <file> 
```

> 打印出所有一起运行的评论。(?: 符号必须用于非捕获括号。/ 不必转义，因为 ! 分隔表达式。-0777 用于启用 slurp 模式，-n 用于启用自动读取。

（来自： http: [//ostermiller.org/findcomment.html](http://http:/ostermiller.org/findcomment.html)）

# c# - C# 中的 JUnit 等价于什么？

> ID：174498
> 
> 赞同：8
> 
> 时间：2008-10-06T14:28:36.420
> 
> 标签：c#, unit-testing, junit

我来自 Java，目前正在从事 C# 项目。a) 对现有 C# 代码进行单元测试和 b) 为 C# 开发完成 TDD 的推荐方法是什么？

对于 Visual Studio 和 C# 代码，是否还有等效于 EMMA / EclEmma（免费但功能强大的代码覆盖工具）的工具？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-06T14:29:22.127

1 [Nunit](http://www.nunit.org/)
2 [NCover](http://ncover.org/)或
3 [PartCover](http://sourceforge.net/projects/partcover/)（我从未使用过）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-06T14:29:51.753

[NUnit](http://www.nunit.org/index.php)是在 JUnit 之后设计的，但如果您使用的是 Visual Studio 2008，那么请考虑内置的单元测试框架。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T14:32:34.430

单元测试框架：[NUnit](http://nunit.org)

单元测试运行器：各种，但我个人喜欢[ReSharper](http://jetbrains.com/resharper)中的那个。（ReSharper 需要花钱，但对于各种生产力的提高来说，这很值得。）

覆盖范围：[NCover](http://www.ncover.com/)（我认为这曾经是免费的，但现在需要花钱。嗯。）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-06T14:44:06.140

我强烈推荐使用[Gallio](http://www.gallio.org)（以前称为 mbUnit）进行单元测试，并（不幸的是不是免费的）NCover 进行代码覆盖。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T20:54:20.417

关于您关于单元测试框架的问题：

[NUnit](http://nunit.org/index.php) 1.0 是 JUnit 的直接端口。为了利用 .NET 平台，NUnit 2.0 放弃了 JUnit 语法。[xUnit.net](http://www.codeplex.com/xunit)是一个较新的单元测试框架（来自 Jim Newkirk - NUnit 2.0 开发人员之一 - 和 Brad Wilson），其目标是揭示“在 .NET 中尚未真正出现的其他单元测试库实现的进步”，其中我读作“跟上 JUnit”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T14:29:44.157

[NUnit](http://www.nunit.org/index.php)就是这样。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-06T14:30:23.280

NUnit，但 NCover 只是答案的一部分，因为它不是免费的。我在[别处](https://stackoverflow.com/questions/38360)问过这个问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-06T14:31:44.370

VS2008 Professional 内置了 Team System 单元测试功能。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-06T14:31:56.287

NUnit 是肯定的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-06T14:35:26.670

我会安装：

1.  NUnit 用于您的单元测试框架[http://www.nunit.org/index.php](http://www.nunit.org/index.php)
2.  用于运行测试的 Testdriven.net [http://www.testdriven.net/](http://www.testdriven.net/)
3.  Rhino Mocks 作为你的 mockign 框架[http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx)

顺便说一句，我觉得奇怪的是 NUnit 家伙似乎正在使用 php 来托管他们的主页......

# java - Java中的String to Int - 可能是坏数据，需要避免异常

> ID：174502
> 
> 赞同：37
> 
> 时间：2008-10-06T14:29:22.580
> 
> 标签：java, parsing, numbers

既然 Java 没有可空类型，也没有 TryParse()，那么如何在不引发异常的情况下处理输入验证？

通常的方式：

```
String userdata = /*value from gui*/
int val;
try
{
   val = Integer.parseInt(userdata);
}
catch (NumberFormatException nfe)
{
   // bad data - set to sentinel
   val = Integer.MIN_VALUE;
} 
```

我可以使用正则表达式来检查它是否可解析，但这似乎也有很多开销。

处理这种情况的最佳做法是什么？

编辑：理由：关于异常处理的讨论很多，一般的态度是异常应该只用于意外情况。但是，我认为糟糕的用户输入是意料之中的，并不罕见。是的，这确实是一个学术观点。

进一步编辑：

一些答案确切地说明了 SO 有什么问题。你忽略了被问到的问题，并回答了另一个与它无关的问题。问题不是询问层之间的过渡。如果数字不可解析，问题不是要返回什么。众所周知，val = Integer.MIN_VALUE; 对于这个完全无上下文的代码片段的应用程序来说，这正是正确的选择。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-05-22T18:24:34.060

我问[是否有开源实用程序库可以为您进行解析，](https://stackoverflow.com/questions/16698647/java-library-that-has-parseint-parselong-parsedouble-etc-that-accept-default)答案是肯定的！

从[Apache Commons Lang](http://commons.apache.org/proper/commons-lang/)你可以使用[NumberUtils.toInt](https://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/math/NumberUtils.html#toInt%28java.lang.String,%20int%29)：

```
// returns defaultValue if the string cannot be parsed.
int i = org.apache.commons.lang.math.NumberUtils.toInt(s, defaultValue); 
```

从[谷歌番石榴](http://code.google.com/p/guava-libraries/)你可以使用[Ints.tryParse](https://google.github.io/guava/releases/19.0/api/docs/com/google/common/primitives/Ints.html#tryParse(java.lang.String))：

```
// returns null if the string cannot be parsed
// Will throw a NullPointerException if the string is null
Integer i = com.google.common.primitives.Ints.tryParse(s); 
```

无需编写自己的方法来解析数字而不会引发异常。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-06T15:05:00.090

对于用户提供的数据， Integer.parseInt 通常是错误的方法，因为它不支持国际化。该`java.text`软件包是您的（详细）朋友。

```
try {
    NumberFormat format = NumberFormat.getIntegerInstance(locale);
    format.setParseIntegerOnly(true);
    format.setMaximumIntegerDigits(9);
    ParsePosition pos = new ParsePosition(0);
    int val = format.parse(str, pos).intValue();
    if (pos.getIndex() != str.length()) {
        // ... handle case of extraneous characters after digits ...
    }
    // ... use val ...
} catch (java.text.ParseFormatException exc) {
    // ... handle this case appropriately ...
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-06T14:32:07.723

差不多就是这样，尽管返回 MIN_VALUE 有点问题，除非您确定将其用于您本质上用作错误代码的内容是正确的。不过，至少我会记录错误代码行为。

可能也有用（取决于应用程序）记录错误输入，以便您可以跟踪。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-06T14:32:22.387

你的方法有什么问题？我不认为这样做会损害您的应用程序的性能。这是正确的做法。**不要过早优化**。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-06T14:38:13.920

我确定它是错误的形式，但是我在 Utilities 类上有一组静态方法，这些方法可以执行以下操作：`Utilities.tryParseInt(String value)`如果 String 不可解析，则返回 0，如果抛出异常`Utilities.tryParseInt(String value, int defaultValue)`，则允许您指定要使用的值。`parseInt()`

我相信有时候返回一个错误输入的已知值是完全可以接受的。一个非常人为的例子：您向用户询问格式为 YYYYMMDD 的日期，他们给了您错误的输入。做类似`Utilities.tryParseInt(date, 19000101)`或`Utilities.tryParseInt(date, 29991231);`取决于程序要求的事情可能是完全可以接受的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-07T03:54:15.233

我将重申 stinkyminky 在帖子底部提出的观点：

一种普遍接受的验证用户输入（或来自配置文件等的输入）的方法是在实际处理数据之前使用验证。在*大多数*情况下，这是一个很好的设计举措，即使它可能导致对解析算法的多次调用。

一旦您知道您已经正确验证了用户输入，*那么*就可以安全地对其进行解析并忽略、记录或转换为 RuntimeException NumberFormatException。

请注意，这种方法需要您从两部分考虑您的模型：业务模型（我们真正关心的是 int 或 float 格式的值）和用户界面模型（我们真正希望允许用户输入任何内容的地方）想）。

为了使数据从用户界面模型迁移到业务模型，它必须通过一个验证步骤（这可以逐个字段发生，但大多数场景需要对正在配置的整个对象进行验证） .

如果验证失败，则会向用户提供反馈，告知他们做错了什么，并有机会修复它。

像 JGoodies Binding 和 JSR 295 这样的绑定库使这种事情比听起来更容易实现 - 许多 Web 框架提供将用户输入与实际业务模型分开的构造，仅在验证完成后填充业务对象。

就配置文件的验证（某些评论中提出的另一个用例）而言，如果根本没有指定特定值，则指定默认值是一回事 - 但如果数据格式错误（有人键入 '哦'而不是'零' - 或者他们从 MS Word 复制并且所有反引号都有一个时髦的 unicode 字符），然后需要某种系统反馈（即使它只是通过抛出运行时异常而使应用程序失败） .

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-06T15:13:30.900

这是我的做法：

```
public Integer parseInt(String data) {
  Integer val = null;
  try {
    val = Integer.parseInt(userdata);
  } catch (NumberFormatException nfe) { }
  return val;
} 
```

然后 null 表示无效数据。如果您想要一个默认值，您可以将其更改为：

```
public Integer parseInt(String data,int default) {
  Integer val = default;
  try {
    val = Integer.parseInt(userdata);
  } catch (NumberFormatException nfe) { }
  return val;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T14:32:16.210

我认为最佳实践是您显示的代码。

由于开销，我不会选择正则表达式替代品。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-05T15:23:22.110

试试`org.apache.commons.lang.math.NumberUtils.createInteger(String s)`。这对我帮助很大。对于双打，多头等也有类似的方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T14:41:21.683

您可以使用整数，如果您的值不正确，可以将其设置为 null。如果您使用的是 java 1.6，它将为您提供自动装箱/拆箱。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-07-11T08:03:08.487

# 更清晰的语义（Java 8 OptionalInt）

对于 Java 8+，我可能会使用 RegEx 进行预过滤（以避免您提到的异常），然后将结果包装在一个原始可选中（以处理“默认”问题）：

```
public static OptionalInt toInt(final String input) {
    return input.matches("[+-]?\\d+") 
            ? OptionalInt.of(Integer.parseInt(input)) 
            : OptionalInt.empty();
} 
```

如果您有许多 String 输入，您可能会考虑返回 an`IntStream`而不是，`OptionalInt`以便您可以`flatMap()`.

# 参考

*   *基于[parseInt 文档的正则表达式](https://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html#parseInt-java.lang.String-)*

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-10-06T15:01:08.867

上面的代码很糟糕，因为它与以下代码等价。

```
// this is bad
int val = Integer.MIN_VALUE;
try
{
   val = Integer.parseInt(userdata);
}
catch (NumberFormatException ignoreException) { } 
```

该异常被完全忽略。此外，魔术令牌很糟糕，因为用户可以传入 -2147483648 (Integer.MIN_VALUE)。

通用的可解析问题没有好处。相反，它应该与上下文相关。您的应用程序有特定要求。您可以将您的方法定义为

```
private boolean isUserValueAcceptable(String userData)
{
   return (    isNumber(userData)    
          &&   isInteger(userData)   
          &&   isBetween(userData, Integer.MIN_VALUE, Integer.MAX_VALUE ) 
          );
} 
```

您可以在哪里记录需求，并且可以创建定义良好且可测试的规则。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-10-06T16:04:21.670

如果您可以像您所说的（isParsable()）那样通过预先测试来避免异常，那可能会更好——但并非所有库的设计都考虑到了这一点。

我用了你的把戏，这很糟糕，因为无论你是否捕捉到它们，我的嵌入式系统上的堆栈跟踪都会被打印出来:(

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-10-06T18:12:02.507

异常机制很有价值，因为它是获取状态指示符和响应值的唯一方法。此外，状态指示器是标准化的。如果有错误，你会得到一个异常。这样您就不必自己考虑错误指示器。争议不在于异常，而在于检查的异常（例如，您必须捕获或声明的异常）。

就个人而言，我觉得您选择了异常非常有价值的示例之一。用户输入错误值是一个常见问题，通常您需要返回给用户以获取正确值。如果您询问用户，您通常不会恢复为默认值；这给用户的印象是他的输入很重要。

如果您不想处理异常，只需将其包装在 RuntimeException（或派生类）中，它将允许您忽略代码中的异常（并在发生时终止您的应用程序；有时也可以）。

关于如何处理 NumberFormat 异常的一些示例： 在 Web 应用程序配置数据中：

```
loadCertainProperty(String propVal) {
  try
  {
    val = Integer.parseInt(userdata);
    return val;
  }
  catch (NumberFormatException nfe)
  { // RuntimeException need not be declared
    throw new RuntimeException("Property certainProperty in your configuration is expected to be " +
                               " an integer, but was '" + propVal + "'. Please correct your " +
                               "configuration and start again");
    // After starting an enterprise application the sysadmin should always check availability
    // and can now correct the property value
  }
} 
```

在 GUI 中：

```
public int askValue() {
  // TODO add opt-out button; see Swing docs for standard dialog handling
  boolean valueOk = false;
  while(!valueOk) {
    try {
      String val = dialog("Please enter integer value for FOO");
      val = Integer.parseInt(userdata);
      return val; 
    } catch (NumberFormatException nfe) {
      // Ignoring this; I don't care how many typo's the customer makes
    }
  }
} 
```

在 Web 表单中：将表单返回给用户，并提供有用的错误消息和更正的机会。大多数框架都提供了一种标准化的验证方式。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2010-12-03T12:18:07.427

Integer.MIN_VALUE 作为 NumberFormatException 是个坏主意。

您可以将提案添加到 Project Coin 以将此方法添加到 Integer

@Nullable public static Integer parseInteger (String src)...它将返回 null 输入错误

然后将您的提案的链接放在这里，我们都会投票赞成！

PS：看看这个 [http://msdn.microsoft.com/en-us/library/bb397679.aspx](http://msdn.microsoft.com/en-us/library/bb397679.aspx) 这可能是多么丑陋和臃肿

* * *

## 回答 #16

> 赞同：-5
> 
> 时间：2008-10-06T14:31:44.963

在它前面放一些 if 语句。如果（空！=用户数据）

# c# - 如何使用 C# 以编程方式复制 MS SQL 2000 数据库？

> ID：174515
> 
> 赞同：3
> 
> 时间：2008-10-06T14:31:08.740
> 
> 标签：c#, .net, sql-server, dts

我需要使用 C# (VS 2005) 在 SQL Server 2000 中将多个表从一个数据库复制到另一个数据库。调用需要参数化——我需要能够传入我将要复制这些表的数据库的名称。

我可以将 DTS 与参数一起使用，但我找不到任何从 C# 执行此操作的示例代码。

或者，我可以只使用

```
drop table TableName
select * into TableName from SourceDB..TableName 
```

然后重建索引等 - 但这**真的很**笨拙。

还有其他想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T16:32:57.400

对于 SQL Server 7.0 和 2000，我们为此提供了 SQLDMO。对于 SQL Server 2005，有 SMO。这允许您执行与管理数据库、脚本对象、枚举数据库等相关的几乎所有事情。IMO，这比尝试“自己动手”的方法要好。

SQL 2000： [开发 SQL-DMO 应用程序](http://msdn.microsoft.com/en-us/library/aa274758(SQL.80).aspx)

[转移对象](http://msdn.microsoft.com/en-us/library/aa276080(SQL.80).aspx)

SQL 2005：这里是 SMO 主页： [Microsoft SQL Server 管理对象 (SMO)](http://msdn.microsoft.com/en-us/library/ms162169(SQL.90).aspx)

这是传输功能： [传输数据](http://msdn.microsoft.com/en-us/library/ms162563(SQL.90).aspx)

[如何：在 Visual Basic .NET 中将架构和数据从一个数据库传输到另一个数据库](http://msdn.microsoft.com/en-us/library/ms162138(SQL.90).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T14:34:31.867

如果每次都删除目标表，那么为什么不执行 SELECT INTO 呢？看起来一点也不像杂牌。

如果它工作得很好并且满足了所有的需求，为什么还要花费一天的时间来开发代码来做同样的事情呢？

让 SQL 为您完成所有繁重的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T14:43:50.337

你可以把在这里找到的脚本（复制数据库）

[http://www.codeproject.com/KB/database/CreateDatabaseScript.aspx](http://www.codeproject.com/KB/database/CreateDatabaseScript.aspx)

进入应用程序。只需更换目的地。要实际移动整个数据库，请按照

[http://support.microsoft.com/kb/314546](http://support.microsoft.com/kb/314546)

但请记住，必须首先使数据库脱机。

谢谢

# sql - 在 SQL 中选择最大订单号

> ID：174516
> 
> 赞同：3
> 
> 时间：2008-10-06T14:31:09.957
> 
> 标签：sql, mysql

我有一个记录一系列操作的表，其中包含一个记录序列顺序的字段：

```
user    data    sequence
1       foo     0
1       bar     1
1       baz     2
2       foo     0
3       bar     0
3       foo     1 
```

使用 WHERE sequence = '0' 为每个用户选择第一个项目很容易，但是有没有办法在 SQL 中为每个用户选择最后一个项目？

我追求的结果应该是这样的：

```
user    data    sequence
1       baz     2
2       foo     0
3       foo     1 
```

如果有任何实现特定的骗子回答，我正在使用 MySQL。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T14:34:14.163

此 sql 将为每个用户返回具有最高序列值的记录：

```
select a.user, a.data, a.sequence
from table as a
    inner join (
        select user, max(sequence) as 'last'
        from table 
        group by user) as b
    on a.user = b.user and 
       a.sequence = b.last 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-11T00:16:01.013

```
select top 1 
       user
       ,data
       ,sequence
 from table
order
   by sequence 
```

# vba - 能否说服 Generic Type Mapper（MSSOAP 工具包）处理空数组

> ID：174517
> 
> 赞同：0
> 
> 时间：2008-10-06T14:31:38.817
> 
> 标签：vba, soap

我遇到了这里描述的问题：

[http://groups.google.com/group/microsoft.public.xml.soap/browse_thread/thread/029ee5b5d4fa2440/0895d73c5c3720a1](http://groups.google.com/group/microsoft.public.xml.soap/browse_thread/thread/029ee5b5d4fa2440/0895d73c5c3720a1)

我正在使用`Web Service`using `Office 2003 Web Services Toolkit`。这会为我的 Web 服务返回的所有数据生成类：其中一个类的属性是一个可能为空的数组。

当我调用 Web 服务时，通用类型映射器会引发错误：

```
array dimensions do not match definition 
```

有谁知道这个问题的解决方案，可以让我继续使用生成的类（我知道我可以只使用原始 XML）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-09T15:32:24.450

由于没有接受者，我将描述我迄今为止所做的事情，以防其他人遇到类似问题。

在我的客户端（使用 Office 2003 Web 服务工具包）上，我想接收一个对象集合，这些对象的属性本身就是对象集合。例如，来自 C# Web 服务的 Customer 对象的集合，其中 Customer 类如下所示：

```
public class Customer
{
    public string Name { get; set; }

    public Collection<Address> Addresses { get; }
} 
```

我遇到的问题是 Addresses 属性有时可能是一个空集合，而 SOAP30 GenericTypeMapper 无法处理这个问题。

在我的具体情况下，客户端实际上并不需要地址集合，我只是希望能够获取 Customer 类的其他属性。因此，我并不真正关心由 Web 服务工具包创建的“地址”变体属性中的内容。

我所做的是创建一个 VB6 ActiveX DLL，其中包含一个具有 ISoapMapper 的极简实现的类，该类始终返回一个未初始化的对象引用：

```
Implements ISoapTypeMapper
Private Function ISoapTypeMapper_Iid() As String
End Function
Private Sub ISoapTypeMapper_Init(ByVal par_Factory As MSOSOAPLib30.ISoapTypeMapperFactory, ByVal par_Schema As MSXML2.IXMLDOMNode, ByVal par_WSMLNode As MSXML2.IXMLDOMNode, ByVal par_xsdType As MSOSOAPLib30.enXSDType)
End Sub
Private Function ISoapTypeMapper_Read(ByVal par_soapreader As MSOSOAPLib30.ISoapReader, ByVal par_Node As MSXML2.IXMLDOMNode, ByVal par_encoding As String, ByVal par_encodingMode As MSOSOAPLib30.enEncodingStyle, ByVal par_flags As Long) As Variant
    Set ISoapTypeMapper_Read = Nothing
End Function
Private Function ISoapTypeMapper_SchemaNode() As MSXML2.IXMLDOMNode
 Set ISoapTypeMapper_SchemaNode = Nothing
End Function
Private Function ISoapTypeMapper_VarType() As Long
   ISoapTypeMapper_VarType = vbObject
End Function
Private Sub ISoapTypeMapper_Write(ByVal par_ISoapSerializer As MSOSOAPLib30.ISoapSerializer, ByVal par_encoding As String, ByVal par_encodingMode As MSOSOAPLib30.enEncodingStyle, ByVal par_flags As Long, par_var As Variant)
End Sub
Private Function ISoapTypeMapper_XsdType() As MSOSOAPLib30.enXSDType
    ISoapTypeMapper_XsdType = enXSDUndefined
End Function 
```

然后我修改了由 Web 服务工具包生成的 WSML，以将此实现用于适当的属性：

```
Dim str_WSML As String
str_WSML = "<servicemapping>"
str_WSML = str_WSML & "<service name='MyService'>"
str_WSML = str_WSML & "<using PROGID='MSOSOAP.GenericCustomTypeMapper30' cachable='0' ID='GCTM'/>"
str_WSML = str_WSML & "<using PROGID='SoapHelper.EmptyArrayMapper' cachable='0' ID='EATM'/>" ' <== Added this line
str_WSML = str_WSML & "<types>"
...
str_WSML = str_WSML & "<type name='ArrayOfAddress' targetNamespace='http://...' uses='EATM' targetClassName='struct_Address'/>"  '<== Added this line
str_WSML = str_WSML & "<type name='Address' targetNamespace='http://mynamespace.com/myapp/services/data' uses='GCTM' targetClassName='struct_Address'/>"
... 
```

这实现了我需要的这个应用程序。

在我看来，可以通过以下方式实现 ISoapMapper 来更普遍地实现对空数组的支持：

*   它检测并处理空数组的情况。

*   或者，如果数组不是空的，它会委托给标准的 GenericTypeMapper。

我仍然很想知道是否有人解决了一般问题。可能不是因为 SOAP 客户端已过时且 Microsoft 不再支持。

# c - 如何将文件的内容读入C中的字符串？

> ID：174531
> 
> 赞同：123
> 
> 时间：2008-10-06T14:32:57.673
> 
> 标签：c, string, file

用 C 语言打开文件并将其内容读入字符串（char*、char[] 等）最简单的方法是什么（最不容易出错，最少的代码行，但是你想解释它）？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2008-10-06T14:37:00.520

我倾向于将整个缓冲区作为原始内存块加载到内存中并自己进行解析。这样我就可以最好地控制标准库在多个平台上的作用。

这是我用于此的存根。您可能还想检查 fseek、ftell 和 fread 的错误代码。（为清楚起见省略）。

```
char * buffer = 0;
long length;
FILE * f = fopen (filename, "rb");

if (f)
{
  fseek (f, 0, SEEK_END);
  length = ftell (f);
  fseek (f, 0, SEEK_SET);
  buffer = malloc (length);
  if (buffer)
  {
    fread (buffer, 1, length, f);
  }
  fclose (f);
}

if (buffer)
{
  // start to process your data / extract strings here...
} 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-10-06T15:37:28.153

不幸的是，另一个高度依赖操作系统的解决方案是内存映射文件。好处通常包括读取性能和减少内存使用，因为应用程序视图和操作系统文件缓存实际上可以共享物理内存。

POSIX 代码如下所示：

```
int fd = open("filename", O_RDONLY);
int len = lseek(fd, 0, SEEK_END);
void *data = mmap(0, len, PROT_READ, MAP_PRIVATE, fd, 0); 
```

另一方面，Windows 稍微复杂一些，不幸的是我面前没有编译器来测试，但功能是由`CreateFileMapping()`and提供的`MapViewOfFile()`。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-06T15:24:23.233

如果“将其内容读入字符串”意味着文件不包含代码为 0 的字符，您还可以使用 getdelim() 函数，该函数要么接受一块内存并在必要时重新分配它，要么只为整个缓冲区分配您，并将文件读入其中，直到遇到指定的分隔符或文件结尾。只需传递 '\0' 作为分隔符即可读取整个文件。

此函数在 GNU C 库中可用，[http://www.gnu.org/software/libc/manual/html_mono/libc.html#index-getdelim-994](http://www.gnu.org/software/libc/manual/html_mono/libc.html#index-getdelim-994)

示例代码可能看起来很简单

```
char* buffer = NULL;
size_t len;
ssize_t bytes_read = getdelim( &buffer, &len, '\0', fp);
if ( bytes_read != -1) {
  /* Success, now the entire file is in the buffer */ 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-11-24T19:40:34.630

如果您正在读取标准输入或管道等特殊文件，您将无法使用 fstat 事先获取文件大小。此外，如果您正在读取二进制文件，fgets 会因为嵌入的 '\0' 字符而丢失字符串大小信息。读取文件的最佳方法是使用 read 和 realloc：

```
#include <stdio.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>

int main () {
    char buf[4096];
    ssize_t n;
    char *str = NULL;
    size_t len = 0;
    while (n = read(STDIN_FILENO, buf, sizeof buf)) {
        if (n < 0) {
            if (errno == EAGAIN)
                continue;
            perror("read");
            break;
        }
        str = realloc(str, len + n + 1);
        memcpy(str + len, buf, n);
        len += n;
        str[len] = '\0';
    }
    printf("%.*s\n", len, str);
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-08T21:02:07.590

如果文件是文本，并且你想逐行获取文本，最简单的方法是使用 fgets()。

```
char buffer[100];
FILE *fp = fopen("filename", "r");                 // do not use "rb"
while (fgets(buffer, sizeof(buffer), fp)) {
... do something
}
fclose(fp); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-01-06T00:48:52.780

注意：这是对上面接受的答案的修改。

这是一种方法，包括错误检查。

我添加了一个大小检查器以在文件大于 1 GiB 时退出。我这样做是因为程序将整个文件放入一个字符串中，这可能会使用过多的内存并使计算机崩溃。但是，如果您不关心这一点，您可以将其从代码中删除。

```
#include <stdio.h>
#include <stdlib.h>

#define FILE_OK 0
#define FILE_NOT_EXIST 1
#define FILE_TOO_LARGE 2
#define FILE_READ_ERROR 3

char * c_read_file(const char * f_name, int * err, size_t * f_size) {
    char * buffer;
    size_t length;
    FILE * f = fopen(f_name, "rb");
    size_t read_length;

    if (f) {
        fseek(f, 0, SEEK_END);
        length = ftell(f);
        fseek(f, 0, SEEK_SET);

        // 1 GiB; best not to load a whole large file in one string
        if (length > 1073741824) {
            *err = FILE_TOO_LARGE;

            return NULL;
        }

        buffer = (char *)malloc(length + 1);

        if (length) {
            read_length = fread(buffer, 1, length, f);

            if (length != read_length) {
                 free(buffer);
                 *err = FILE_READ_ERROR;

                 return NULL;
            }
        }

        fclose(f);

        *err = FILE_OK;
        buffer[length] = '\0';
        *f_size = length;
    }
    else {
        *err = FILE_NOT_EXIST;

        return NULL;
    }

    return buffer;
} 
```

并检查错误：

```
int err;
size_t f_size;
char * f_data;

f_data = c_read_file("test.txt", &err, &f_size);

if (err) {
    // process error
}
else {
    // process data
    free(f_data);
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-10-07T10:24:20.787

如果您正在使用`glib`，那么您可以使用[g_file_get_contents](https://developer.gnome.org/glib/stable/glib-File-Utilities.html#g-file-get-contents)；

```
gchar *contents;
GError *err = NULL;

g_file_get_contents ("foo.txt", &contents, NULL, &err);
g_assert ((contents == NULL && err != NULL) || (contents != NULL && err == NULL));
if (err != NULL)
  {
    // Report error to user, and free error
    g_assert (contents == NULL);
    fprintf (stderr, "Unable to read file: %s\n", err->message);
    g_error_free (err);
  }
else
  {
    // Use file contents
    g_assert (contents != NULL);
  }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-11-09T07:10:35.283

**刚刚从上面接受的答案修改。**

```
#include <stdio.h>
#include <stdlib.h>
#include <assert.h>

char *readFile(char *filename) {
    FILE *f = fopen(filename, "rt");
    assert(f);
    fseek(f, 0, SEEK_END);
    long length = ftell(f);
    fseek(f, 0, SEEK_SET);
    char *buffer = (char *) malloc(length + 1);
    buffer[length] = '\0';
    fread(buffer, 1, length, f);
    fclose(f);
    return buffer;
}

int main() {
    char *content = readFile("../hello.txt");
    printf("%s", content);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-05-15T17:49:49.693

```
// Assumes the file exists and will seg. fault otherwise.
const GLchar *load_shader_source(char *filename) {
  FILE *file = fopen(filename, "r");             // open 
  fseek(file, 0L, SEEK_END);                     // find the end
  size_t size = ftell(file);                     // get the size in bytes
  GLchar *shaderSource = calloc(1, size);        // allocate enough bytes
  rewind(file);                                  // go back to file beginning
  fread(shaderSource, size, sizeof(char), file); // read each char into ourblock
  fclose(file);                                  // close the stream
  return shaderSource;
} 
```

这是一个非常粗略的解决方案，因为没有针对 null 进行检查。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-07-07T16:59:00.283

我将根据这里的答案添加我自己的版本，仅供参考。我的代码考虑了 sizeof(char) 并添加了一些注释。

```
// Open the file in read mode.
FILE *file = fopen(file_name, "r");
// Check if there was an error.
if (file == NULL) {
    fprintf(stderr, "Error: Can't open file '%s'.", file_name);
    exit(EXIT_FAILURE);
}
// Get the file length
fseek(file, 0, SEEK_END);
long length = ftell(file);
fseek(file, 0, SEEK_SET);
// Create the string for the file contents.
char *buffer = malloc(sizeof(char) * (length + 1));
buffer[length] = '\0';
// Set the contents of the string.
fread(buffer, sizeof(char), length, file);
// Close the file.
fclose(file);
// Do something with the data.
// ...
// Free the allocated string space.
free(buffer); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-12-19T06:48:24.927

> 用 C 语言打开文件并将其内容读入字符串的最简单方法是什么（最不容易出错，最少的代码行，但是你想解释它）...？

可悲的是，多年后的答案很容易出错，而且许多答案都缺乏正确的*字符串格式*。

```
#include <stdio.h>
#include <stdlib.h>

// Read the file into allocated memory.
// Return NULL on error.
char* readfile(FILE *f) {
  // f invalid? fseek() fail?
  if (f == NULL || fseek(f, 0, SEEK_END)) {
    return NULL;
  }

  long length = ftell(f);
  rewind(f);
  // Did ftell() fail?  Is the length too long?
  if (length == -1 || (unsigned long) length >= SIZE_MAX) {
    return NULL;
  }

  // Convert from long to size_t
  size_t ulength = (size_t) length;
  char *buffer = malloc(ulength + 1);
  // Allocation failed? Read incomplete?
  if (buffer == NULL || fread(buffer, 1, ulength, f) != ulength) {
    free(buffer);
    return NULL;
  }
  buffer[ulength] = '\0'; // Now buffer points to a string

  return buffer;
} 
```

请注意，如果文本文件包含*空字符*，则分配的数据将包含所有文件数据，但字符串会显得很短。更好的代码还会返回长度信息，以便调用者可以处理它。

```
char* readfile(FILE *f, size_t *ulength_ptr) {
  ...
  if (ulength_ptr) *ulength_ptr == *ulength;
  ...
} 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2019-08-15T14:40:45.610

简单而整洁（假设文件中的内容少于 10000）：

```
void read_whole_file(char fileName[1000], char buffer[10000])
{
    FILE * file = fopen(fileName, "r");
    if(file == NULL)
    {
        puts("File not found");
        exit(1);
    }
    char  c;
    int idx=0;
    while (fscanf(file , "%c" ,&c) == 1)
    {
        buffer[idx] = c;
        idx++;
    }
    buffer[idx] = 0;
} 
```

# sql - 如何在表格中找到“洞”

> ID：174532
> 
> 赞同：20
> 
> 时间：2008-10-06T14:33:00.013
> 
> 标签：sql

我最近继承了一个数据库，其中一个表的主键由编码值 (Part1*1000 + Part2) 组成。
我对该列进行了规范化，但我无法更改旧值。所以现在我有

```
select ID from table order by ID
ID
100001
100002
101001
... 
```

我想在表格中找到新行的“洞”（更准确地说，是 100000 之后的第一个“洞”）。
我正在使用以下选择，但有更好的方法吗？

```
select /* top 1 */ ID+1 as newID from table
where ID > 100000 and
ID + 1 not in (select ID from table)
order by ID

newID
100003
101029
... 
```

数据库是 Microsoft SQL Server 2000。我可以使用 SQL 扩展。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-06T21:13:43.107

```
select ID +1 From Table t1
where not exists (select * from Table t2 where t1.id +1 = t2.id); 
```

不确定这个版本是否会比你最初提到的更快。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-06T14:38:47.117

```
SELECT (ID+1) FROM table AS t1
LEFT JOIN table as t2
ON t1.ID+1 = t2.ID
WHERE t2.ID IS NULL 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-16T23:44:44.690

该解决方案应该为您提供您正在寻找的“洞”的第一个和最后一个 ID 值。我在 Firebird 1.5 的 500K 记录表上使用它，虽然它确实需要一点时间，但它给了我想要的东西。

```
SELECT l.id + 1 start_id, MIN(fr.id) - 1 stop_id
FROM (table l
LEFT JOIN table r
ON l.id = r.id - 1)
LEFT JOIN table fr
ON l.id < fr.id
WHERE r.id IS NULL AND fr.id IS NOT NULL
GROUP BY l.id, r.id 
```

例如，如果您的数据如下所示：

```
ID
1001
1002
1005
1006
1007
1009
1011 
```

你会收到这个：

```
start_id   stop_id
1003       1004
1008       1008
1010       1010 
```

我希望我能完全相信这个解决方案，但我在[Xaprb](http://www.xaprb.com/blog/2005/12/06/find-missing-numbers-in-a-sequence-with-sql/)找到了它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-02T17:28:44.000

来自[如何使用 SQL 在运行计数器中找到“差距”？](https://stackoverflow.com/questions/1312101/how-to-find-a-gap-in-running-counter-with-sql/17431748#17431748)

```
select
    MIN(ID)
from (
    select
        100001 ID
    union all
    select
        [YourIdColumn]+1
    from
        [YourTable]
    where
        --Filter the rest of your key--
    ) foo
left join
    [YourTable]
    on [YourIdColumn]=ID
    and --Filter the rest of your key--
where
    [YourIdColumn] is null 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-14T17:27:48.967

最好的方法是构建一个包含所有 ID 的临时表

比左连接。

```
declare @maxId int
select @maxId = max(YOUR_COLUMN_ID) from YOUR_TABLE_HERE

declare @t table (id int)

declare @i int
set @i = 1

while @i <= @maxId
begin
    insert into @t values (@i)
    set @i = @i +1
end

select t.id
from @t t
left join YOUR_TABLE_HERE x on x.YOUR_COLUMN_ID = t.id
where x.YOUR_COLUMN_ID is null 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-10-22T16:12:59.377

最近考虑过这个问题，看起来这是最优雅的方法：

```
SELECT TOP(@MaxNumber) ROW_NUMBER() OVER (ORDER BY t1.number) 
FROM master..spt_values t1 CROSS JOIN master..spt_values t2 
EXCEPT
SELECT Id FROM <your_table> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-23T11:23:28.703

此解决方案不会给出表格中的所有漏洞，只有下一个免费的 + 表格上第一个可用的最大数量 - 如果你想填补 id-es 中的空白，+ 如果你没有空白，则获得免费的 id 号码。 .

```
select numb + 1 from temp
minus
select numb from temp; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-31T11:38:14.990

这将为您提供完整的图片，其中**“底部”**代表**间隙开始**，**“顶部”**代表**间隙结束**：

```
 select *
    from 
    ( 
       (select <COL>+1 as id, 'Bottom' AS 'Pos' from <TABLENAME> /*where <CONDITION*/>
       except
       select <COL>, 'Bottom' AS 'Pos' from <TABLENAME> /*where <CONDITION>*/)
    union
       (select <COL>-1 as id, 'Top' AS 'Pos' from <TABLENAME> /*where <CONDITION>*/
       except
       select <COL>, 'Top' AS 'Pos' from <TABLENAME> /*where <CONDITION>*/)
    ) t
    order by t.id, t.Pos 
```

**注意：第一个**和**最后一个**结果是***错误***的，不应该考虑，但是把它们去掉会使这个查询变得复杂很多，所以现在就这样做。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-17T04:46:13.367

前面的很多回答都很好。但是，它们都未返回序列的第一个值和/或未考虑下限 100000。它们都返回中间空洞，但不返回第一个空洞（如果缺失，则返回 100001）。

该问题的完整解决方案如下：

```
select id + 1 as newid from
    (select 100000 as id union select id from tbl) t
    where (id + 1 not in (select id from tbl)) and
          (id >= 100000)
    order by id
    limit 1; 
```

如果序列的第一个数字是 100001（如原始问题中所示），则使用数字 100000；否则要相应地修改“限制1”以便只有第一个可用数字而不是完整序列

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-23T08:22:17.023

对于使用 Oracle 的人，可以使用以下内容：

```
select a, b from (
  select ID + 1 a, max(ID) over (order by ID rows between current row and 1 following) - 1 b from MY_TABLE
) where a <= b order by a desc; 
```

# php - 谷歌地图叠加层

> ID：174535
> 
> 赞同：7
> 
> 时间：2008-10-06T14:33:18.750
> 
> 标签：php, javascript, google-maps, overlays

我正在尝试找到可以从 KML 和/或 KMZ 数据生成 Google 地图叠加层的东西，最好是 F/OSS。

我们正在开发一个活动网站，去年需要容纳约 16,000 个地点标记，今年可能至少还会有这么多。去年，完成该网站的公司只是将 KML 数据直接提供给 gMaps API，并让它放置所有的标记客户端。显然，这变成了一场性能噩梦，并倾向于使旧版浏览器“冻结”（或至少一次冻结几分钟）。

理想情况下，此服务器端脚本将采用 KML、地图的纬度/经度中心和地图缩放级别，并将所有可见的地点标记适当地合并到单个 GIF 或 PNG 覆盖中。

对此的任何指导或建议将不胜感激。

**2008 年 10 月 8日更新**- 我在这里和其他地方遇到的大多数信息似乎表明减少地图上的点数是可行的方法（即，从更高的高度/缩放级别）。虽然在某些情况下这可能是一个好方法，但在这里行不通。我们正在寻找带有数千个标记的美国地图的视觉冲击力。我探索过的一个选项是一个名为[PushPin的服务](http://www.pushpin.com/)，当输入（大概）KML 将在服务器端创建一个叠加层，该叠加层将所有可见点（基于中心纬度/经度和缩放级别）渲染到单个图像上，而不是在客户端执行数千个 DOM 操作，我们将所有这些标记合并到单个图像服务器端，并在客户端执行单个 DOM 操作。PushPin 服务真的很灵巧，如果没有相关成本，肯定会工作。*我们*真的在寻找可以在服务器端运行以自己生成覆盖的 F/OSS。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T14:49:58.933

您可能想查看[Geoserver](http://geoserver.org/display/GEOS/Welcome)或[Mapserver 之](http://mapserver.gis.umn.edu/)类的东西。它们是谷歌地图的复制品，还有更多。

您可以生成您喜欢的叠加层，Geoserver（我认为 mapserver 也可以）可以为您提供 KML、PDF、png 和其他输出来混合您的地图，或者您可以自己生成整个地图，但这需要时间.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T15:29:04.020

不确定为什么要转到 GIF/PNG 叠加层，您可以直接在 KML 中执行此操作。我假设您的大部分性能问题是由用户当前视图之外的点引起的，即用户正在查看纽约，但您在洛杉矶有一些点正在浪费内存，因为它们不可见。如果您真的有 16,000 个点对于典型的一次都可见，那么是的，您需要采取不同的策略。

如果上述情况适用，则程序如下：

1.  确定地图的中心和范围
2.  鉴于您应该能够计算地图左上角和右下角的纬度/经度。
3.  遍历您的点数据库并根据两个角检查每个位置。经度需要大于（有符号！）左上经度且小于右下经度。纬度需要小于左上纬度（有符号！）并且大于右下纬度。只是简单的比较，这里不需要花哨的计算。
4.  将匹配点输出到用户的临时 KML。
5.  您可以将[KML 直接输入谷歌地图](http://maps.google.com/maps?f=q&hl=en&geocode=&q=http:%2F%2Fwhatstheharm.net%2Fmaps%2Fhomeopathy.kml&ie=UTF8&ll=9.031205,-128.873246&spn=177.2351,360&z=1)并让它映射，或者您可以使用[Javascript 地图 API](http://googlemapsapi.blogspot.com/2007/03/kml-and-georss-support-added-to-google.html)通过 KML 加载点。

它可能无法在这里解决您的确切问题，但对于相关问题，您也可以查看[Google Static Maps API](http://code.google.com/apis/maps/documentation/staticmaps/)。这允许您创建一个带有地标的静态图像文件，该文件将非常快速地加载，但不会具有常规 Google 地图的交互性。然而，由于 API 的设计方式，它也无法处理接近 16,000 个点的任何地方，因此您仍然必须过滤到视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T14:57:33.570

我不知道你的项目有多好，但也许你可以看看[GeoDjango](http://www.geodjango.org)？这个修改后的 Django 版本包括各种存储位置的工具；转换坐标和显示地图，简单的方法。当然，您需要一些 Python 经验和运行它的服务器，但是一旦您掌握了 Django 的窍门，它就会运行得又快又好。

如果您只是想为您的问题找到一个解决方案，请尝试以较低的缩放级别对结果进行分组，可以在[此处](http://www.moviq.nl/zoeken/woningen?q=Amsterdam)找到此实现的一个很好的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T14:47:57.817

这是困难的一个。您可以[在 Google Maps 中使用自定义](http://code.google.com/apis/maps/documentation/overlays.html#Tile_Overlays)图块集，但您仍然需要一些方法来生成图块（手动除外）。

恐怕这就是我所拥有的一切=/

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T15:26:10.907

[OpenLayers](http://www.openlayers.org)是多个地图服务或您自己的地图服务器的出色 javascript 前端。2.7 版刚刚发布，它添加了一些非常棒的功能和控件。

# maven-2 - 在 Maven 中共享测试代码

> ID：174560
> 
> 赞同：196
> 
> 时间：2008-10-06T14:38:27.633
> 
> 标签：maven-2, testing

你如何依赖 Maven 中另一个模块的测试代码？

例如，我有 2 个模块：

*   根据
*   主要的

我想要 Main 中的测试用例来扩展 Base 中的基本测试类。这可能吗？

更新：找到了一个[可接受的答案](https://stackoverflow.com/questions/174560/sharing-test-code-in-maven#174670)，其中涉及创建一个测试 jar。

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2008-10-06T16:06:42.400

我建议使用[类型而不是分类器](https://maven.apache.org/pom.html#Dependencies)（另请参阅：[分类器](http://maven.apache.org/plugins/maven-deploy-plugin/examples/deploying-with-classifiers.html)）。它更明确地告诉 Maven 你在做什么（我发现 m2eclipse 和 q4e 都更喜欢它）。

```
<dependency>
  <groupId>com.myco.app</groupId>
  <artifactId>foo</artifactId>
  <version>1.0-SNAPSHOT</version>
  <type>test-jar</type>
  <scope>test</scope>
</dependency> 
```

* * *

## 回答 #2

> 赞同：192
> 
> 时间：2008-10-06T15:06:38.747

感谢基本模块的建议。但是，我宁愿不为此目的创建一个新模块。

[在Surefire Maven 文档](http://maven.apache.org/guides/mini/guide-attached-tests.html)和[博客](https://www.waltercedric.com/index.php?option=com_content&view=article&id=1349&catid=129&Itemid=332)中找到了可接受的答案。另请参阅“[如何创建包含测试类的 jar](https://maven.apache.org/plugins/maven-jar-plugin/examples/create-test-jar.html) ”。

这会`src/test/java`使用[jar 插件](https://maven.apache.org/plugins/maven-jar-plugin/)创建代码的 jar 文件，以便带有测试的模块可以共享代码。

```
<project>
  <build>
    <plugins>
     <plugin>
       <groupId>org.apache.maven.plugins</groupId>
       <artifactId>maven-jar-plugin</artifactId>
       <version>2.4</version>
       <executions>
         <execution>
           <goals>
             <goal>test-jar</goal>
           </goals>
         </execution>
       </executions>
     </plugin>
    </plugins>
  </build>
</project> 
```

为了使用上面创建的附加测试 JAR，您只需使用指定的测试分类器指定对主工件的依赖项：

```
<project>
  ...
  <dependencies>
    <dependency>
      <groupId>com.myco.app</groupId>
      <artifactId>foo</artifactId>
      <version>1.0-SNAPSHOT</version>
      <type>test-jar</type>
      <scope>test</scope>
    </dependency>
  </dependencies>
  ...
</project> 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-06T14:44:45.747

我们通过使用测试代码作为 src/main/java 并将以下依赖项添加到项目中创建一个 maven 项目来解决这个问题：

```
 <dependency>
        <groupId>foo</groupId>
        <artifactId>test-base</artifactId>
        <version>1</version>
        <scope>test</scope>
    </dependency> 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-10-06T14:43:18.043

是的......只需将 Base 模块作为依赖项包含在 Main 中。如果您只继承测试代码，那么您可以使用范围标记来确保 Maven 在部署时不会将代码包含在您的工件中。像这样的东西应该工作：

```
<dependency>
    <groupId>BaseGroup</groupId>
    <artifactId>Base</artifactId>
    <version>0.1.0-SNAPSHOT</version>
    <scope>test</scope>
</dependency> 
```

# c# - 帮助部署 Crystal Report Embedded Visual Studio 2008 网站

> ID：174567
> 
> 赞同：4
> 
> 时间：2008-10-06T14:41:35.927
> 
> 标签：c#, asp.net, visual-studio-2008, crystal-reports

我一直在尝试解决这个错误一天，但运气不佳。我有一个使用嵌入式 Crystal Reports 的 VS 2008 项目，它当然在本地运行良好，但是当部署到我的远程服务器时，报表将不再运行。

我推测这是因为我的服务器上没有安装正确的 Crystal Reports 组件。所以我尝试将 dll 文件直接添加到我的项目中，这确实解决了我的一些错误，但它们仍然是一个缺失的参考。

缺少的参考位于我的 GAC 中的“CrystalDecsions.ReportAppServer.ClientDoc”上。

除了在服务器上安装 msi 文件之外，还有其他方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T22:59:25.203

不久前我在 2005 中遇到了类似的问题，我要解决这个问题的唯一方法是在服务器上安装可再分发的水晶报告。您是否有任何理由对在您的服务器上安装 MSI 犹豫不决？

# c# - 如何在 aspx 页面中将属性设置为 Guid

> ID：174570
> 
> 赞同：0
> 
> 时间：2008-10-06T14:42:59.760
> 
> 标签：c#, asp.net

我的一个 aspx 页面中有以下代码：

```
<% foreach (Dependency dep in this.Common.GetDependencies(this.Request.QueryString["Name"]))
   { %>
        <ctl:DependencyEditor DependencyKey='<%= dep.Key %>' runat="server" />
<% } %> 
```

当我运行它时，我收到以下错误：

```
解析器错误消息：无法从“DependencyKey”属性的字符串表示“<%= dep.Key %>”创建类型为“System.Guid”的对象。
```

有什么方法可以创建控件并在 aspx 页面中传入 Guid？我真的很讨厌不得不循环并在后面的代码中创建这些控件只是因为...

注意： Dependency 对象上的 Key 属性*是*一个 Guid。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T14:55:55.617

Dependency 对象的 key 属性可能是 Guid，但是 DependencyEditor 的 DependencyKey 属性也是 Guid 吗？如果不是，它应该是，否则正确的 TypeConverter 将不会在分配时被调用。

如果我没记错的话，你也可以使用 dep.Key.ToString() 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T14:56:34.367

您的控件是否获取值并假设其为 GUID？您是否尝试过使用该值实例化 GUID？看起来这是一个演员表问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T16:05:27.020

好的，这是交易...尝试使用 # 符号而不是 = 符号。我复制了您的问题，并且解决了编译问题。

它应该看起来像这样“<%# dep.Key %>”

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T05:00:44.690

假设 dep.Key 是 guid 的字符串表示形式......并且 DependencyKey 是 Guid 类型的属性

```
 <ctl:DependencyEditor DependencyKey="<%= new Guid(dep.Key) %>" runat="server" /> 
```

# sql - 如何使用 SQL 重命名数据库表中的列？

> ID：174582
> 
> 赞同：126
> 
> 时间：2008-10-06T14:44:41.723
> 
> 标签：sql, database, rename

如果我希望使用 SQL 简单地重命名 SQL 数据库中的列（不更改其类型或约束，仅更改其名称），我该怎么做？还是不可能？

这适用于任何声称支持 SQL 的数据库，我只是在寻找一个特定于 SQL 的查询，该查询无论实际数据库实现如何都可以工作。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2008-10-06T14:45:23.750

专门针对 SQL Server，使用[`sp_rename`](http://msdn.microsoft.com/en-us/library/ms188351.aspx)

```
USE AdventureWorks;
GO
EXEC sp_rename 'Sales.SalesTerritory.TerritoryID', 'TerrID', 'COLUMN';
GO 
```

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2008-10-06T14:57:15.753

在 PostgreSQL（和许多其他 RDBMS）上，您可以使用常规`ALTER TABLE`语句来完成：

```
=> SELECT * FROM Test1;
 id | foo | bar 
----+-----+-----
  2 |   1 |   2

=> ALTER TABLE Test1 RENAME COLUMN foo TO baz;
ALTER TABLE

=> SELECT * FROM Test1;
 id | baz | bar 
----+-----+-----
  2 |   1 |   2 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2015-06-04T22:45:49.640

在 MySQL 中，语法是[`ALTER TABLE ... CHANGE`](http://dev.mysql.com/doc/en/alter-table.html)：

```
ALTER TABLE <table_name> CHANGE <column_name> <new_column_name> <data_type> ... 
```

请注意，您不能只重命名并保持类型和约束不变；您必须在列的新名称之后重新键入数据类型和约束。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2013-10-25T01:56:21.313

不幸的是，对于独立于数据库的解决方案，您需要了解有关该列的所有信息。如果它在其他表中用作外键，则也需要对其进行修改。

```
ALTER TABLE MyTable ADD MyNewColumn OLD_COLUMN_TYPE;
UPDATE MyTable SET MyNewColumn = MyOldColumn;
-- add all necessary triggers and constraints to the new column...
-- update all foreign key usages to point to the new column...
ALTER TABLE MyTable DROP COLUMN MyOldColumn; 
```

对于最简单的情况（没有约束、触发器、索引或键），它将采用上述 3 行。对于任何更复杂的事情，当您填写缺失的部分时，它会变得非常混乱。

但是，如上所述，如果您提前知道需要修改哪个数据库，则可以使用更简单的数据库特定方法。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2015-07-31T07:09:27.247

我认为这是更改列名的最简单方法。

```
SP_RENAME 'TABLE_NAME.OLD_COLUMN_NAME','NEW_COLUMN_NAME' 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-10T22:05:30.587

在 Informix 中，您可以使用：

```
RENAME COLUMN TableName.OldName TO NewName; 
```

这是在 SQL 标准解决该问题之前实现的——如果它在 SQL 标准中得到解决的话。我的 SQL 9075:2003 标准副本并未将其显示为标准（除其他外，RENAME 不是关键字之一）。我不知道它是否真的在 SQL 9075:2008 中。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2016-10-13T11:04:08.377

在 sql server 中你可以使用

```
exec sp_rename '<TableName.OldColumnName>','<NewColumnName>','COLUMN' 
```

或者

```
sp_rename '<TableName.OldColumnName>','<NewColumnName>','COLUMN' 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-04-06T02:55:22.563

您可以使用以下命令重命名 SQL Server 中任何表的列：

```
exec sp_rename 'TableName.OldColumnName', 'New colunmName' 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-06T15:02:19.673

ALTER TABLE 是标准 SQL。但它并没有在许多数据库系统中完全实现。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-10T22:10:30.450

标准是`ALTER TABLE`，但您可能遇到的每个 DBMS 不一定都支持它，因此如果您正在寻找一种包罗万象的语法，那么您可能会不走运。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-11-13T10:27:57.907

或者`SQL`，您可以在 Microsoft SQL Server Management Studio 中的表设计面板中执行此操作。

第一种方式

慢速双击该列。列名将成为一个可编辑的文本框。

第二种方式

> SqlManagement Studio>>DataBases>>tables>>specificTable>>Column Folder>>右键单击列>>Reman

第三条路

表格>>右键>>设计

# .net - 最佳开源 LINQ 提供商

> ID：174585
> 
> 赞同：10
> 
> 时间：2008-10-06T14:45:22.797
> 
> 标签：.net, linq, open-source

什么是最好的开源 LINQ 提供程序（就完整性而言）？

我自己正在开发一个开源 LINQ 提供程序，我想尽可能多地借鉴一些想法，避免常见的陷阱等。

不要将自己局限于数据库 LINQ 提供者，欢迎提供任何提供者建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-13T21:39:54.563

还有另一种实现“re-linq”。

看看这里：

*   [http://www.re-motion.org/blogs/team/archive/2009/04/23/introducing-re-linq-a-general-purpose-linq-provider-infrastructure.aspx](http://www.re-motion.org/blogs/team/archive/2009/04/23/introducing-re-linq-a-general-purpose-linq-provider-infrastructure.aspx)
*   [http://www.codeproject.com/KB/linq/relinqish_the_pain.aspx](http://www.codeproject.com/KB/linq/relinqish_the_pain.aspx)

希望它有帮助，帕特里克

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-29T13:03:11.690

我们的对象数据库[db4o](http://www.db4o.com)带有一个开源 LINQ 提供程序。我们甚至提供了 CompactFramework 的实现。据我所知，这是唯一可用于 CompactFramework 的 LINQ 提供程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T14:47:42.713

LINQ 到亚马逊网络服务。

[http://linqinaction.net/files/folders/linqinaction/entry1952.aspx](http://linqinaction.net/files/folders/linqinaction/entry1952.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T14:47:58.113

查看[LINQExtender](http://www.codeplex.com/LinqExtender)以获取可扩展的 IQueryable 实现的示例。它不仅提供了一个很好的开源示例，而且您可能会发现您可以使用它而不是从头开始开发 IQueryable 实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T15:25:42.967

我有一个伪 LINQ 提供程序：“ [Push LINQ](http://msmvps.com/blogs/jon_skeet/archive/2008/01/04/quot-push-quot-linq-revisited-next-attempt-at-an-explanation.aspx) ”。它与并行扩展类似，因为它改变了现有内存数据源的使用方式，而不是让另一个实际数据源发挥作用​​。

这些位作为我的[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)项目的一部分提供。如果您参与其中并想了解更多信息（或提出建议），最好私下联系我。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T16:55:48.870

DbLinq项目正在为其他数据库提供 linq2sql 支持，现在[正在](http://linq.to/db)[与 Mono 项目](http://tirania.org/blog/archive/2008/Oct-01-2.html)合作以成为完整的 System.Data.Linq 实现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T02:10:14.097

我们在[Signum 框架中有一个完整的 linq 提供程序](http://www.signumframework.com/DatabaseQuery.ashx)

[你也可以在这里](http://signum.codeplex.com/SourceControl/changeset/view/25903#510381)找到源代码。（所有 Linq 子树）。

我还要看看任性的[博客](http://blogs.msdn.com/mattwar/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T12:12:33.370

[LinqExtender](http://www.codeplex.com/LinqExtender)提供了一种无需执行复杂的表达式树解析即可开始使用 LINQ 的方法。它提供了或多或少简单的数据结构，而不会牺牲诸如投影、位置、排序等之类的东西。它仍在开发中，起点可能是[LinqToFlickr](http://www.codeplex.com/linqflickr)。

希望你觉得它有用并且对任何建议都持开放态度

# visual-studio - 您可以将文档和电子表格添加到 Visual Studio 项目吗？

> ID：174593
> 
> 赞同：4
> 
> 时间：2008-10-06T14:47:42.480
> 
> 标签：visual-studio, file, projects, external-application

在 Eclipse 中，我经常在项目中包含所有与项目相关的材料（包括 PDF、Microsoft 和 OpenDocument 格式的文档）。这对 Visual Studio 是否可行，特别是如果我尝试从 Visual Studio 内部打开文件，它将在外部应用程序中打开？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T14:48:57.627

是的，只需在解决方案资源管理器中右键单击您的项目，然后转到添加 > 现有项目...

虽然 - 我建议创建一个新文件夹来保存它。

是的，您可以确保当您打开它时，它会使用正确的应用程序打开。将文件添加到解决方案资源管理器后，只需右键单击该文件，然后选择“打开方式...”，并确保从该点开始设置默认应用程序，您只需双击文件即可。

如果您可以通过源代码控制使用 Sharepoint 服务，那也会让生活变得更轻松，感谢克里斯提醒我！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T15:16:55.870

我不想从乍得的回答中拿走。但是，我要补充一点，TFS 有特定的区域供项目文档存储在 sharepoint 中。

# sql - 在 Oracle 数据库中，ROWNUM 和 ROW_NUMBER 有什么区别？

> ID：174595
> 
> 赞同：26
> 
> 时间：2008-10-06T14:47:45.570
> 
> 标签：sql, oracle, row-number, rownum

`ROWNUM`和 和有什么不一样`ROW_NUMBER` ？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-06T14:56:31.167

ROWNUM 是一个“伪列”，它为查询返回的每一行分配一个数字：

```
SQL> select rownum, ename, deptno
  2  from emp;

    ROWNUM ENAME          DEPTNO
---------- ---------- ----------
         1 SMITH              99
         2 ALLEN              30
         3 WARD               30
         4 JONES              20
         5 MARTIN             30
         6 BLAKE              30
         7 CLARK              10
         8 SCOTT              20
         9 KING               10
        10 TURNER             30
        11 FORD               20
        12 MILLER             10 
```

ROW_NUMBER 是一个分析函数，它根据在一组行中的顺序为每一行分配一个数字：

```
SQL> select ename, deptno, row_number() over (partition by deptno order by ename) rn
  2  from emp;

ENAME          DEPTNO         RN
---------- ---------- ----------
CLARK              10          1
KING               10          2
MILLER             10          3
FORD               20          1
JONES              20          2
SCOTT              20          3
ALLEN              30          1
BLAKE              30          2
MARTIN             30          3
TURNER             30          4
WARD               30          5
SMITH              99          1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T14:58:14.723

**从一点点阅读来看，ROWNUM 是 Oracle 自动分配给行集的值（在评估 ORDER BY 之前，因此永远** 不要`ORDER BY ROWNUM`使用 a 或将 a与 a`WHERE ROWNUM < 10`一起使用`ORDER BY`）。

[ROW_NUMBER()](http://download.oracle.com/docs/cd/B10500_01/server.920/a96540/functions105a.htm)似乎是一个函数，用于将行号分配给子查询或分区返回的结果集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T09:47:48.930

除了答案中提到的其他差异外，您还应该考虑性能。这里有一份非权威但很有趣的报道，比较了各种分页方式，其中使用了`ROWNUM`compare to `ROW_NUMBER() OVER()`：

[http://www.inf.unideb.hu/~gabora/pagination/results.html](http://www.inf.unideb.hu/~gabora/pagination/results.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-06T15:01:11.033

[rownum](http://www.adp-gmbh.ch/ora/sql/rownum.html)是一个伪列，可以添加到任何选择查询中，对返回的行进行编号（从 1 开始）。它们根据何时被识别为最终结果集的一部分进行排序。( [#ref](https://stackoverflow.com/users/6742/david-aldridge) )

[row_number](http://www.adp-gmbh.ch/ora/sql/analytical/row_number.html)是一个分析函数，可用于按照 row_number() 函数规定的顺序对查询返回的行进行编号。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-06-07T13:53:42.500

Rownum 以 1 开始 ..在条件评估结果为 true 后增加。因此 rownum >=1 返回表中的所有行

# ruby-on-rails - rails in_place_edit：如何传递真实性令牌？

> ID：174598
> 
> 赞同：2
> 
> 时间：2008-10-06T14:48:02.620
> 
> 标签：ruby-on-rails, ajax, token, in-place-edit, authenticity

我正在尝试进行编辑工作，但遇到了这个错误：

ActionController::InvalidAuthenticityToken (ActionController::InvalidAuthenticityToken)

我知道 Rails 现在想要防止伪造，我需要传递一个表单真实性令牌，但我不清楚如何使用 in_place_edit 插件来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T15:25:56.430

这不是一个~~完整~~的测试答案，但我查看了[插件代码](http://svn.rubyonrails.org/rails//plugins/in_place_editing/lib/in_place_macros_helper.rb)，看起来您可以使用该`:with`选项将真实性令牌附加到请求参数的末尾。类似于以下内容：

```
in_place_editor("my_element", :with => "form.serialize() + '&authenticity_token=#{form_authenticity_token}';") 
```

（我没有测试过上面的代码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T09:12:44.840

我找到了解决方案。我把说明放在[这里](http://blog.ennuyer.net/?p=299)。查看有关修补 in_place_edit 的部分。

# sql-server - 有没有办法为特定的执行范围禁用 SQL Server 触发器？

> ID：174600
> 
> 赞同：36
> 
> 时间：2008-10-06T14:48:39.173
> 
> 标签：sql-server, tsql, triggers

在 SQL Server 2005 中，触发器是否有办法找出负责触发触发器的对象？我想用它来禁用一个存储过程的触发器。

有没有其他方法可以仅为当前事务禁用触发器？我可以使用下面的代码，但如果我没记错的话，它也会影响并发事务——这将是一件坏事。

```
DISABLE TRIGGER { [ schema_name . ] trigger_name [ ,...n ] | ALL } ON { object_name | DATABASE | ALL SERVER } [ ; ]

ENABLE TRIGGER { [ schema_name . ] trigger_name [ ,...n ] | ALL } ON { object_name | DATABASE | ALL SERVER } [ ; ] 
```

如果可能的话，我想避免在我的表中使用“NoTrigger”字段并执行 的技术`NoTrigger = null`，因为我想让表尽可能小。

我想避免触发的原因是因为它包含对手动更新表很重要的逻辑，但我的存储过程会处理这个逻辑。因为这将是一个高度使用的过程，所以我希望它很快。

> 触发器在服务器上施加了额外的开销，因为它们启动了一个隐式事务。一旦执行触发器，就会启动一个新的隐式事务，并且事务中的任何数据检索都将锁定受影响的表。

来自：[http ://searchsqlserver.techtarget.com/tip/1,289483,sid87_gci1170220,00.html#trigger](http://searchsqlserver.techtarget.com/tip/1,289483,sid87_gci1170220,00.html#trigger)

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-10-07T12:22:26.550

我刚刚在 SQL Server Central 时事通讯上看到了这篇文章，它似乎提供了一种在连接上使用 Context_Info 可能有用的方法：

[http://www.mssqltips.com/tip.asp?tip=1591](http://www.mssqltips.com/tip.asp?tip=1591)

* * *

Terrapin 编辑：

上面的链接包括以下代码：

```
USE AdventureWorks;  
GO  
-- creating the table in AdventureWorks database  
IF OBJECT_ID('dbo.Table1') IS NOT NULL  
DROP TABLE dbo.Table1  
GO  
CREATE TABLE dbo.Table1(ID INT)  
GO   
-- Creating a trigger  
CREATE TRIGGER TR_Test ON dbo.Table1 FOR INSERT,UPDATE,DELETE  
AS  
DECLARE @Cinfo VARBINARY(128)  
SELECT @Cinfo = Context_Info()  
IF @Cinfo = 0x55555  
RETURN  
PRINT 'Trigger Executed'  
-- Actual code goes here  
-- For simplicity, I did not include any code  
GO 
```

如果要阻止执行触发器，可以执行以下操作：

```
SET Context_Info 0x55555 
INSERT dbo.Table1 VALUES(100) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T15:33:48.987

如果您的触发器导致应用程序出现性能问题，那么最好的方法是删除对表的所有手动更新，并要求所有更新都通过包含正确更新逻辑的插入/更新存储过程。然后您可以完全移除触发器。

如果没有其他方法，我建议拒绝表更新权限。

这也解决了重复代码的问题。在更新 SP 和触发器中复制代码违反了良好的软件工程原则，并且将成为维护问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T15:13:28.403

ALTER TABLE tbl 禁用触发器 trg

[http://doc.ddart.net/mssql/sql70/aa-az_5.htm](http://doc.ddart.net/mssql/sql70/aa-az_5.htm)

我不明白你第一段的意思

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T15:38:09.337

由于您指示触发器包含处理所有更新（甚至是手动更新）的逻辑，所以这应该是逻辑所在的位置。您提到的示例，其中存储过程“将处理此逻辑”意味着重复代码。此外，如果您想确保无论作者如何，每个 UPDATE 语句都应用了这个逻辑，那么触发器就是它的地方。当有人编写程序但又忘记复制逻辑时会发生什么？当需要修改逻辑时会发生什么？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-25T11:32:23.730

不确定这是否是一个好主意，但它似乎对我有用。禁用触发器时，事务应防止从其他进程插入表。

```
IF OBJECT_ID('dbo.TriggerTest') IS NOT NULL
 DROP PROCEDURE dbo.TriggerTest
GO

CREATE PROCEDURE [dbo].[TriggerTest]
AS
BEGIN TRANSACTION trnInsertTable1s
;
DISABLE TRIGGER trg_tblTable1_IU ON tblTable1
;
BEGIN -- Procedure Code
    PRINT '@@trancount'
    PRINT @@TRANCOUNT
    -- Do Stuff

END -- Procedure Code
;
ENABLE TRIGGER trg_tblTable1_IU ON tblTable1

IF @@ERROR <> 0 ROLLBACK TRANSACTION
ELSE COMMIT TRANSACTION 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T15:17:08.163

不要禁用触发器。您是正确的，它将禁用任何并发事务。

为什么要禁用触发器？它有什么作用？为什么触发器会导致问题？从数据完整性的角度来看，禁用触发器通常是个坏主意。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T15:58:32.930

如果性能是问题，请考虑重写触发器以提高性能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T19:53:47.700

我对此有点犹豫。一方面，我非常反触发，主要是因为除了问题帖子中链接的文章中所述的原因之外，我还有一个地方可以查找针对我的表执行的代码。

另一方面，如果您有执行稳定和不可变业务规则或跨表操作（如维护历史表）的逻辑，那么将其放入触发器会更安全，因此程序作者和程序员不需要处理有了它 - 它只是工作。

所以，我的建议是把必要的逻辑放在你的触发器中，而不是放在这个 proc 中，因为它不可避免地会增长到几个具有相同豁免的 proc。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T16:00:00.057

我同意其他一些答案。不要禁用触发器。

这是纯粹的观点，但我避免像瘟疫这样的触发因素。我发现很少有使用触发器来强制执行数据库规则的情况。在我的经验中有明显的边缘案例，我只有我的经验可以做出这样的声明。我通常看到触发器用于插入一些关系数据（应该从业务逻辑中完成），用于将数据插入报告表中，即非规范化数据（可以通过事务外部的流程完成），或用于转换数据某种程度上来说。

触发器有合法用途，但我认为在日常业务编程中它们很少而且相差甚远。这可能对您当前的问题没有帮助，但您可能会考虑完全删除触发器并以其他方式完成触发器正在执行的工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-05T04:02:39.040

我刚刚遇到了同样的问题，并提出了以下解决方案，这对我有用。

1.  创建一个永久数据库表，其中包含您要禁用的每个触发器的一条记录（例如 refTriggerManager）；每行包含触发器名称（例如strTriggerName = 'myTrigger'）和一个位标志（例如blnDisabled，默认为0）。

2.  在触发器主体的开头，在 refTriggerManager 中查找 strTriggerName = 'myTrigger'。如果 blnDisabled = 1，则返回而不执行其余的触发代码，否则继续触发代码直到完成。

3.  在要禁用触发器的存储过程中，执行以下操作：

* * *

开始交易

更新 refTriggerManager SET blnDisabled = 1 WHERE strTriggerName = 'myTrigger'

/* 更新拥有“myTrigger”但您希望禁用的表。由于 refTriggerManager.blnDisabled = 1，'myTrigger' 在不执行其代码的情况下返回。*/

更新 refTriggerManager SET blnDisabled= 0 WHERE triggerName = 'myTrigger'

/* 触发触发器的可选最终更新代码。由于 refTriggerManager.blnDisabled = 0，'myTrigger' 完全执行。*/

提交交易

* * *

所有这些都发生在一个事务中，因此它与外界隔离，不会影响目标表上的其他 UPDATE。

有人看到这种方法有什么问题吗？

账单

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-12-10T16:12:10.557

您可以使用 ' ***Exec*** ' 函数来禁用和启用存储过程中的触发器。例子： `EXEC ('ENABLE TRIGGER dbo.TriggerName on dbo.TriggeredTable')`

# sharepoint - CAML 查询以定位嵌套在文档库树中的特定 SPFolder

> ID：174602
> 
> 赞同：0
> 
> 时间：2008-10-06T14:49:04.133
> 
> 标签：sharepoint, caml

在搜索 SPFolders 而不是文件时，或者在搜索自定义内容类型时，使用 CAML 和 SPQuery 进行搜索似乎不适用于自定义元数据。我一直在使用 U2U 来测试各种查询，但没有任何结果。该文档的主题不是很完整，谷歌也没有提供帮助。

在一项测试中，我试图在树中找到任何属于特定自定义内容类型的 SPFolders。如果我正确理解 CAML，这应该有效：

```
<Query>
    <Where>
        <Eq>
            <FieldRef Name='ContentType' />
            <Value Type='Text'>CustomTypeName</Value>
        </Eq>
    </Where>
</Query> 
```

在另一个测试中，我试图找到任何将自定义元数据属性设置为特定值的 SPFolder。

```
<Query>
    <Where>
        <Eq>
            <FieldRef Name='CustomProp' />
            <Value Type='Text'>SpecificPropValue</Value>
        </Eq>
    </Where>
</Query> 
```

在这两种情况下，我都将搜索的根设置为包含文件夹的文档库，其中包含文件夹，其中包含文件夹（唷。）此外，我将 SPQuery 设置为递归搜索。

我正在搜索的文件夹向下两步是树中最远的文件夹。我不想一直迭代以手动找到有问题的文件夹。

**编辑**知道我同时使用带有 SPQuery 作为参数的 SPList.GetItems 和带有 SPSiteDataQuery 作为参数的 SPWeb.GetSiteData 也可能会有所帮助。目前，这些查询中的任何一个的搜索集中似乎都不包含文件夹。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T20:12:20.767

After more research, I'm answering my own question.

Apparently the methods that I'm using to query don't return SPFolders as items in the result set. Only list items are returned, basically just documents.

My fix was to execute a CAML query for all the documents with a certain metadata tag/value, and then using the parent folder of the first one as the representative folder for the set. Works well enough for my needs.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T20:10:44.217

尝试将[SharePoint 管理器](http://www.codeplex.com/spm)和[Stramit CAML 查看器](http://www.codeplex.com/SPCamlViewer)添加到您的工具集中。

I have found both to be very important for figuring out CAML problems.

# c++ - size_t 类型变量的跨平台格式字符串？

> ID：174612
> 
> 赞同：32
> 
> 时间：2008-10-06T14:51:51.317
> 
> 标签：c++, c, cross-platform, printf, size-t

在跨平台的 c/c++ 项目（Win32、Linux、OSX）上，我需要使用 *printf 函数来打印一些 size_t 类型的变量。在某些环境中 size_t 是 8 个字节，而在其他环境中是 4 个。在 glibc 上我有 %zd，在 Win32 上我可以使用[%Id](http://msdn.microsoft.com/en-us/library/tcxf1dw6.aspx)。有没有一种优雅的方法来处理这个？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-06T15:17:47.240

`PRIuPTR`宏（来自 <inttypes.h>）为 定义了十进制格式，`uintptr_t`它应该总是足够大，以至于您可以`size_t`在不截断的情况下对其进行转换，例如

```
fprintf(stream, "Your size_t var has value %" PRIuPTR ".", (uintptr_t) your_var); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-08-24T20:19:26.247

这里真的有两个问题。第一个问题是三个平台的正确 printf 说明符字符串是什么。请注意，这`size_t`是一个无符号类型。

在[Windows](http://msdn.microsoft.com/en-us/library/tcxf1dw6%28VS.71%29.aspx)上，使用“ `%Iu`”。

在[Linux](http://linux.die.net/man/3/printf)和[OSX](http://developer.apple.com/documentation/Darwin/Reference/Manpages/man3/printf.3.html)上，使用“ `%zu`”。

第二个问题是如何支持多个平台，因为每个平台上的格式字符串等内容可能不同。正如其他人指出的那样，使用`#ifdef`很快就会变得丑陋。

相反，为每个目标平台编写单独的 makefile 或项目文件。然后通过源文件中的某个宏名称引用说明符，在每个 makefile 中适当地定义宏。特别是，GCC 和 Visual Studio 都接受一个“D”开关来在命令行上定义宏。

如果您的构建系统非常复杂（多个构建选项、生成的源代码等），维护 3 个单独的 makefile 可能会变得笨拙，并且您将不得不使用某种高级构建系统，例如 CMake 或 GNU 自动工具。但基本原理是相同的——使用构建系统定义特定于平台的宏，而不是将平台检测逻辑放在源文件中。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-06T15:07:12.940

我唯一能想到的，是典型的：

```
#ifdef __WIN32__ // or whatever
#define SSIZET_FMT "%ld"
#else
#define SSIZET_FMT "%zd"
#endif 
```

然后利用常量折叠：

```
fprintf(stream, "Your size_t var has value " SSIZET_FMT ".", your_var); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-06T17:42:36.903

Dan Saks 在 Embedded Systems Design 中写了一篇文章来讨论[这个](http://www.embedded.com/columns/programmingpointers/201803576?pgno=2)问题。根据 Dan 的说法， %zu 是标准方式，但很少有编译器支持这一点。作为替代方案，他建议使用 %lu 以及将参数显式转换为 unsigned long：

> ```
> size_t n;
> ...
> printf("%lu", (unsigned long)n); 
> ```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T19:25:42.717

Use `boost::format`. It's typesafe, so it'll print `size_t` correctly with `%d`, also you don't need to remember to put `c_str()` on `std::string`s when using it, and even if you pass a number to `%s` or vice versa, it'll work.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T15:01:35.323

我不知道任何令人满意的解决方案，但您可能会考虑使用专门的函数将 size_t 项目格式化为字符串，然后打印该字符串。

（或者，如果你能摆脱它， boost::format 可以轻松处理这种事情。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-25T03:29:54.237

您只需找到具有最大存储类的整数类型，将值转换为它，然后为较大的类型使用适当的格式字符串。请注意，此解决方案适用于任何类型（ptrdiff_t 等），而不仅仅是 size_t。

您要使用的是 uintmax_t 和格式宏 PRIuMAX。对于 Visual C++，您将需要下载与 c99 兼容的 stdint.h 和 inttypes.h 标头，因为 Microsoft 不提供它们。

另见

[http://www.embedded.com/columns/technicalinsights/204700432](http://www.embedded.com/columns/technicalinsights/204700432)

本文更正了 Frederico 引用的文章中的错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-16T19:01:55.593

我对这个问题的选择是简单地将 size_t 参数转换为 unsigned long 并在任何地方使用 %lu - 当然，这仅适用于预计值不会超过 2^32-1 的情况。如果这对您来说太短，您总是可以转换为 unsigned long long 并将其格式化为 %llu。

不管怎样，你的琴弦永远不会尴尬。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-01T22:32:21.990

# 选项1：

由于在大多数（如果不是全部？）系统上，`PRIuPTR` [printf 格式字符串](http://www.cplusplus.com/reference/cstdio/printf/)来自也足够长来容纳一个类型，我建议对printf 格式字符串`size_t`使用以下定义。`size_t`

*但是，重要的是您要验证这是否适用于您的特定架构（编译器、硬件等），因为标准并未强制执行此操作。*

```
#include <inttypes.h>

// Printf format strings for `size_t` variable types.
#define PRIdSZT PRIdPTR
#define PRIiSZT PRIiPTR
#define PRIoSZT PRIoPTR
#define PRIuSZT PRIuPTR
#define PRIxSZT PRIxPTR
#define PRIXSZT PRIXPTR 
```

示例用法：

```
size_t my_variable;
printf("%" PRIuSZT "\n", my_variable); 
```

# 选项 2：

然而，在可能的情况下，只使用`%zu`“z”长度说明符，[如此处所示](http://www.cplusplus.com/reference/cstdio/printf/)，用于`size_t`类型：

[![在此处输入图像描述](https://i.stack.imgur.com/XvzKt.png)](https://i.stack.imgur.com/XvzKt.png)

示例用法：

```
size_t my_variable;
printf("%zu\n", my_variable); 
```

*然而，在某些系统上，例如使用 gcc 作为编译器的 STM32 微控制器，`%z`不一定实现长度说明符，并且执行类似的操作`printf("%zu\n", my_size_t_num);`可能最终会打印出文字“%zu”（我亲自对此进行了测试并发现它是真的）而不是你的`size_t`变量的值。*

# 选项 3：

但是，在您需要它**绝对保证工作**的地方，或者在您不确定您的特定架构的地方，只需将其转换为 a 并打印即可`uint64_t`，因为这可以保证工作，但需要额外的转换步骤。

示例用法：

```
#include <stdint.h>    // for uint64_t
#include <inttypes.h>  // for PRIu64

size_t my_variable;
printf("%" PRIu64 "\n", (uint64_t)my_variable); 
```

# 引用来源：

1.  [http://www.cplusplus.com/reference/cstdio/printf/](http://www.cplusplus.com/reference/cstdio/printf/)
2.  [http://www.cplusplus.com/reference/cinttypes/](http://www.cplusplus.com/reference/cinttypes/)
3.  [http://www.cplusplus.com/reference/cstdint/](http://www.cplusplus.com/reference/cstdint/)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-07-31T17:58:07.720

`size_t`是至少 16 位的*无符号类型。*经常看到 32 和 64 的宽度。

```
printf("%zu\n", some_size_t_object); // Standard since C99 
```

以上是前进的最佳方式，但如果代码还需要移植到 C99 之前的平台，请将值转换为某种宽类型。 `unsigned long`是合理的候选人，但可能缺乏。

```
// OK, yet insufficient with large sizes > ULONG_MAX
printf("%lu\n", (unsigned long) some_size_t_object); 
```

或使用条件代码

```
#ifdef ULLONG_MAX
  printf("%llu\n", (unsigned long long) some_size_t_object); 
#else
  printf("%lu\n", (unsigned long) some_size_t_object); 
#endif 
```

最后考虑`double`。[考虑到摩尔定律](https://softwareengineering.stackexchange.com/q/38213/94903)，在 2030-2040 年左右之前，它应该处理所有古老和新平台的效率有点低，那时`double`可能缺乏精确的结果。

```
printf("%.0f\n", (double) some_size_t_object); 
```

# regex - 正则表达式：匹配 (aa|bb) (cc)？

> ID：174633
> 
> 赞同：3
> 
> 时间：2008-10-06T14:57:21.680
> 
> 标签：regex

我的正则表达式需要能够找到字符串：

1.  视觉工作室 2008
2.  视觉工作室速成版 2008
3.  视觉基础 2008
4.  Visual Basic 速成版 2008
5.  视觉 C++ 2008
6.  视觉 C++ 速成版 2008

以及许多其他类似的变体，将被这个单个字符串替换

> 视觉工作室 2005

我试过“Visual (Basic|C++|Studio) (Express)?2008”，但它不起作用。有任何想法吗？

***编辑****：现在我尝试了“Visual (Basic)|(C++)|(Studio) (Express)?2008”，但是对于输入“Visual Basic Express 2008”，替换的行变为“Visual Studio 2005 Express 2008”。*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T15:06:38.543

它应该是

```
"Visual (Basic|C\+\+|Studio)( Express)? 2008"

>>> import re
>>> repl = 'Visual Studio 2005'
>>> regexp = re.compile('Visual (Studio|Basic|C\+\+)( Express)? 2008')
>>> test1 = 'Visual Studio 2008'
>>> test2 = 'Visual Studio Express 2008'
>>> test3 = 'Visual C++ Express 2008'
>>> test4 = 'Visual C++ Express 1008'
>>> re.sub(regexp,repl,test1)
'Visual Studio 2005'
>>> re.sub(regexp,repl,test2)
'Visual Studio 2005'
>>> re.sub(regexp,repl,test3)
'Visual Studio 2005'
>>> re.sub(regexp,repl,test4)
'Visual C++ Express 1008' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T15:03:08.520

在没有快递的情况下，您正在寻找一年前的 2 个空间。那不好。试试这个：

```
"Visual (Basic|C\+\+|Studio) (Express )?2008" 
```

根据输入，使用它可能就足够了：

```
"Visual [^ ]+ (Express )?2008" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T14:59:43.690

您需要转义特殊字符（如 +）。'express'位也应该在两边都有一个空格。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T15:04:57.080

这个怎么样：

```
Visual (Basic|C\\+\\+|Studio) (Express )?2008 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T15:14:40.320

除非您的示例输入充满了关键字的各种排列，否则您可以通过以下方式极大地简化它：

```
Visual .+? 2008 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T15:40:15.777

我认为这应该有效

```
/visual (studio|basic|c\+\+)? (express)?\s?2008/i 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T15:09:32.093

尝试：

```
Visual (Basic|C\+\+|Studio)( Express)? 2008 
```

即引用'C++'的'+'并在“Express”中包含空格

由于它是 Python 并且您不需要带括号的部分：

```
Visual (?:Basic|C\+\+|Studio)(?: Express)? 2008 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T15:10:10.267

这对空格更明确：

```
Visual\s(Basic|C\+\+|Studio)(\sExpress)?\s2008 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-10-29T13:59:29.200

一个很晚的答案，但喜欢回答。你可以简单地试试这个

```
/Visual.*2008/g 
```

[http://regex101.com/r/fI0yU1/1](http://regex101.com/r/fI0yU1/1)

# c# - Wiimote 示例程序

> ID：174653
> 
> 赞同：13
> 
> 时间：2008-10-06T15:02:06.117
> 
> 标签：c#, user-interface, wiimote, wii

我想在各种应用中使用 Wiimote（加速度计、陀螺仪、红外摄像机等）。

这是一个蓝牙设备，我知道其他人已经将它连接到他们的计算机。

*   在我的软件中开始使用它的最简单方法是什么 - 例如，是否有 C# 库？
*   我希望我的软件可用且易于安装 - 当前将 wiimote 连接到计算机的最简单方法是什么？我可以将该过程作为我的软件安装的一部分吗？

-亚当

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-06T15:07:05.780

你看过[Johnny Chung Lee 的“拖延症”博客](http://procrastineering.blogspot.com/)吗？他写了很多关于使用wii遥控器的文章，并且有一些很棒的演示视频。**[编辑]**我刚刚发现李先生做[了一个 TED 演讲](http://www.ted.com/index.php/talks/johnny_lee_demos_wii_remote_hacks.html)，很好地介绍了他所做的事情......

[Wiibrew.org](http://wiibrew.org)上有大量信息-如果您想超越 c#，请查看他们的[Wiimote 库页面以了解其他一些 API。](http://wiibrew.org/wiki/Wiimote_Library)作为一个狂热的 Python 粉丝，我很想玩[pyWiimote 库](http://code.google.com/p/pywiimote/):-)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-06T15:05:10.917

Coding4Fun 有一个托管的 C# 库，可以让您与它进行交互，但他们的网站似乎现在已经关闭。虽然我认为他们使用了 Robotics Studio，所以这可能是一个开始的地方。

找到它... [http://www.codeplex.com/WiimoteLib](http://www.codeplex.com/WiimoteLib)

哦，我忘了发布我很久以前看过的这些视频的链接。 [http://www.cs.cmu.edu/~johnny/projects/wii/](http://www.cs.cmu.edu/~johnny/projects/wii/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-05T03:22:19.330

如果您使用 WiimoteLib（来自另一个答案中提到的 Coding4Fun），则有一个名为 WiimoteTest 的示例应用程序。这会测试所有 Wiimote 输入和输出，包括同时测试多个 Wiimote，因此它是您自己的 Wiimote 代码的一个很好的起点，因为它为您提供了一个示例，说明如何做几乎任何您想做的事情。

对于您问题的第二部分，将 Wiimote 连接到计算机与连接任何其他蓝牙设备几乎相同。我不知道在安装时完成此操作是否非常合适，因为它可能会经常连接和断开连接，特别是因为如果一段时间不使用 Wiimote 会自行关闭。但是，这几乎是按照标准 Windows 向导连接到它的问题，所以这并不难。这假设您有一个可以与 Wiimote 一起使用的蓝牙驱动程序 - 更多信息可在 Coding4Fun 网站上找到。它适用于我笔记本电脑附带的默认驱动程序，但如果它不适合你，他们推荐的是 BlueSoleil。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-15T18:58:55.150

> 当前将wiimote连接到计算机的最简单方法是什么？

我在我的软件中没有找到连接wiimote的解决方案，您必须手动连接到Windows，但是在Windows上注册蓝牙设备非常耗时，尝试东芝蓝牙堆栈更方便。

# algorithm - 计算在基于瓦片的游戏中哪些瓦片被点亮（“光线追踪”）

> ID：174659
> 
> 赞同：46
> 
> 时间：2008-10-06T15:02:47.817
> 
> 标签：algorithm, raytracing, lighting

我正在编写一个基于图块的小游戏，我想为此支持光源。但是我的算法fu太弱了，所以我来找你帮忙。

情况是这样的：有一个基于瓦片的地图（以 2D 数组的形式保存），其中包含一个光源和几个站在周围的物品。我想计算哪些瓷砖被光源照亮，哪些在阴影中。

大概的样子的视觉帮助。L 是光源，X 是阻挡光线的物品，0 是点亮的瓷砖，-s 是阴影中的瓷砖。

```
0 0 0 0 0 0 - - 0
0 0 0 0 0 0 - 0 0
0 0 0 0 0 X 0 0 0
0 0 0 0 0 0 0 0 0
0 0 0 0 L 0 0 0 0
0 0 0 0 0 0 0 0 0
0 0 0 X X X X 0 0
0 0 0 - - - - - 0
0 0 - - - - - - - 
```

当然，分数系统会更好，其中由于部分被遮挡，瓷砖可能处于半阴影中。该算法不必是完美的——只是没有明显错误并且相当快。

（当然，会有多个光源，但这只是一个循环。）

有接盘侠吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-06T15:35:42.633

roguelike 开发社区有点痴迷于视线、视野算法。

这是关于该主题的 roguelike wiki 文章的链接： [http ://roguebasin.roguelikedevelopment.org/index.php?title=Field_of_Vision](http://roguebasin.roguelikedevelopment.org/index.php?title=Field_of_Vision)

对于我的 roguelike 游戏，我在 Python 中实现了阴影投射算法 ( [http://roguebasin.roguelikedevelopment.org/index.php?title=Shadow_casting )。](http://roguebasin.roguelikedevelopment.org/index.php?title=Shadow_casting)组合起来有点复杂，但运行效率相当高（即使在纯 Python 中）并产生了不错的结果。

“Permissive Field of View”似乎也越来越受欢迎： [http ://roguebasin.roguelikedevelopment.org/index.php?title=Permissive_Field_of_View](http://roguebasin.roguelikedevelopment.org/index.php?title=Permissive_Field_of_View)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-06T15:18:20.173

您可以通过计算遮挡等来解决各种复杂问题，或者您可以使用简单的蛮力方法：对于每个单元格，使用线条绘制算法（例如[Bresenham Line Algorithm](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)）来检查当前单元格和光线之间的每个单元格来源。如果任何已填充的单元格或（如果您只有一个光源）已经测试并发现处于阴影中的单元格，则您的单元格处于阴影中。如果你遇到一个已知被点亮的牢房，你的牢房同样会被点亮。对此的一个简单优化是将沿线遇到的任何单元格的状态设置为最终结果。

这或多或少是我在[2004 年 IOCCC 获奖作品中](http://www0.us.ioccc.org/years.html#2004)使用的。不过，显然这并不是很好的示例代码。;)

编辑：正如 loren 指出的那样，通过这些优化，您只需要选择沿地图边缘的像素即可进行追踪。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T15:24:56.947

在我看来，这里介绍的算法所做的计算比我认为需要的要多。我没有对此进行测试，但我认为它会起作用：

最初，将所有像素标记为点亮。

对于地图边缘的每个像素：正如 Arachnid 建议的那样，使用 Bresenham 追踪从像素到灯光的线。如果该线碰到障碍物，则将从边缘到障碍物之外的所有像素标记为处于阴影中。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-06T15:09:28.693

又快又脏：

（取决于数组的大小）

*   循环遍历每个图块
*   给光画一条线
*   如果线的任何部分击中 X，则它在阴影中
*   （可选）：计算线穿过的 X 的数量并做一些花哨的数学来确定阴影中瓷砖的比例。注意：这可以通过在阈值处理过程中对瓦片和灯光之间的线进行抗锯齿处理（因此沿着返回光源的路线查看其他瓦片）来完成，这些将显示为小的异常。根据所使用的逻辑，您可能会确定瓷砖在阴影中的程度（如果有的话）。

您还可以跟踪哪些像素已经过测试，因此稍微优化解决方案而不是重新测试像素两次。

如果线条是半透明的并且 X 块又是半透明的，则可以通过使用图像处理和在像素（图块）之间绘制直线来很好地实现圆顶。您可以对图像设置阈值以确定该线是否与“X”相交

如果您可以选择使用 3rd 方工具，那么我可能会接受它。从长远来看，它可能会更快，但您对游戏的了解会更少。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-06T16:19:16.900

这只是为了好玩：

如果您首先将瓷砖转换为线条，则可以在 2D 中复制 Doom 3 方法。例如，

```
- - - - -
- X X X -
- X X - -
- X - - -
- - - - L 
```

...将减少为三条线，连接三角形中固体对象的角。

然后，做 Doom 3 引擎所做的事情：从光源的角度，考虑每一个面向光的“墙”。（在这个场景中，只考虑对角线。）对于每条这样的线，将其投影成一个梯形，其前边缘是原始线，其边位于从光源到每个端点的线上，其背面是远远的，过去的整个场景。所以，它是一个“指向”光的梯形。它包含了墙壁投下阴影的所有空间。用黑暗填充这个梯形中的每一块瓷砖。

遍历所有这些线条，您将最终得到一个“模板”，其中包括从光源可见的所有瓷砖。用浅色填充这些瓷砖。当您远离源（“衰减”）或做其他花哨的事情时，您可能希望稍微点亮瓷砖。

对场景中的每个光源重复此操作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-06T15:12:09.157

要检查瓷砖是否处于阴影中，您需要将一条直线画回光源。如果该线与另一个被占用的图块相交，则您正在测试的图块处于阴影中。光线跟踪算法对视图中的每个对象（在您的情况下为图块）执行此操作。

维基百科上的[光线追踪文章](http://en.wikipedia.org/wiki/Ray_tracing_(graphics)#Algorithm:_classical_recursive_ray_tracing)有伪代码。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-07-24T17:14:27.513

Here is a very simple but fairly effective approach that uses linear time in the number of tiles on screen. Each tile is either opaque or transparent (that's given to us), and each can be visible or shaded (that's what we're trying to compute).

We start by marking the avatar itself as "visible".

We then apply this recursive rule to determine the visibility of the remaining tiles.

1.  If the tile is on the same row or column as the avatar, then it is only visible if the adjacent tile nearer to the avatar is visible and transparent.
2.  If the tile is on a 45 degree diagonal from the avatar, then it is only visible if the neighboring diagonal tile (towards the avatar) is visible and transparent.
3.  In all other cases, consider the three neighboring tiles that are closer to the avatar than the tile in question. For example, if this tile is at (x,y) and is above and to the right of the avatar, then the three tiles to consider are (x-1, y), (x, y-1) and (x-1, y-1). The tile in question is visible if **any** of those three tiles are visible and transparent.

In order to make this work, the tiles must be inspected in a specific order to ensure that the recursive cases are already computed. Here is an example of a working ordering, starting from 0 (which is the avatar itself) and counting up:

```
9876789
8543458
7421247
6310136
7421247
8543458
9876789 
```

Tiles with the same number can be inspected in any order amongst themselves.

The result is not beautiful shadow-casting, but computes believable tile visibility.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-06T15:23:17.230

TK 的解决方案是您通常用于此类事情的解决方案。

对于部分照明场景，您可以使用它，这样如果一个图块导致处于阴影中，那么该图块会被分成 4 个图块，并且每个图块都经过测试。然后，您可以根据需要将其拆分多少？

编辑：

您也可以通过不测试与灯光相邻的任何瓷砖来对其进行一些优化 - 我猜当您有多个光源时，这样做会更重要......

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-30T23:57:39.027

实际上，我最近才将此功能写入我的一个项目中。

```
void Battle::CheckSensorRange(Unit* unit,bool fog){
    int sensorRange = 0;
    for(int i=0; i < unit->GetSensorSlots(); i++){
        if(unit->GetSensorSlot(i)->GetSlotEmpty() == false){
            sensorRange += unit->GetSensorSlot(i)->GetSensor()->GetRange()+1;
        }
    }
    int originX = unit->GetUnitX();
    int originY = unit->GetUnitY();

    float lineLength;
    vector <Place> maxCircle;

    //get a circle around the unit
    for(int i = originX - sensorRange; i < originX + sensorRange; i++){
        if(i < 0){
            continue;
        }
        for(int j = originY - sensorRange; j < originY + sensorRange; j++){
            if(j < 0){
                continue;
            }
            lineLength = sqrt( (float)((originX - i)*(originX - i)) + (float)((originY - j)*(originY - j)));
            if(lineLength < (float)sensorRange){
                Place tmp;
                tmp.x = i;
                tmp.y = j;
                maxCircle.push_back(tmp);
            }
        }
    }

    //if we're supposed to fog everything we don't have to do any fancy calculations
    if(fog){
        for(int circleI = 0; circleI < (int) maxCircle.size(); circleI++){
            Map->GetGrid(maxCircle[circleI].x,maxCircle[circleI].y)->SetFog(fog);
        }
    }else{

        bool LOSCheck = true;
        vector <bool> placeCheck;

        //have to check all of the tiles to begin with 
        for(int circleI = 0; circleI < (int) maxCircle.size(); circleI++){
            placeCheck.push_back(true);
        }

        //for all tiles in the circle, check LOS
        for(int circleI = 0; circleI < (int) maxCircle.size(); circleI++){
            vector<Place> lineTiles;
            lineTiles = line(originX, originY, maxCircle[circleI].x, maxCircle[circleI].y);

            //check each tile in the line for LOS
            for(int lineI = 0; lineI < (int) lineTiles.size(); lineI++){
                if(false == CheckPlaceLOS(lineTiles[lineI], unit)){
                    LOSCheck = false;

                    //mark this tile not to be checked again
                    placeCheck[circleI] = false;
                }
                if(false == LOSCheck){
                    break;
                }
            }

            if(LOSCheck){
                Map->GetGrid(maxCircle[circleI].x,maxCircle[circleI].y)->SetFog(fog);
            }else{
                LOSCheck = true;
            }
        }
    }

} 
```

如果您将其改编为自己使用，则其中有一些额外的东西是您不需要的。为了方便起见， Place 类型只是定义为 x 和 y 位置。

The line function is taken from Wikipedia with very small modifications. Instead of printing out x y coordinates I changed it to return a place vector with all the points in the line. The CheckPlaceLOS function just returns true or false based on if the tile has an object on it. There's some more optimizations that could be done with this but this is fine for my needs.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-06-17T13:38:40.447

I know this is years old question, but for anyone searching for this style of stuff I'd like to offer a solution I used once for a roguelike of my own; manually "precalculated" FOV. If you field of view of light source has a maximum outer distance it's really not very much effort to hand draw the shadows created by blocking objects. You only need to draw 1/8 th of the circle (plus the straight and diagonal directions); you can use symmerty for the other eigths. You'll have as many shadowmaps as you have squares in that 1/8th of a circle. Then just OR them together according to objects.

The three major pros for this are: 1\. It's very quick if implemented right 2\. You get to decide how the shadow should be cast, no comparing which algorith handles which situation the best 3\. No weird algorith induced edge cases which you have to somehow fix

The con is you don't really get to implement a fun algorithm.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-03-14T17:04:16.857

i have implemented tilebased field of view in a single C function. here it is: [https://gist.github.com/zloedi/9551625](https://gist.github.com/zloedi/9551625)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-06T15:14:50.320

如果您不想花时间重新发明/重新实现它，那里有很多游戏引擎。 [Ogre3D](http://www.ogre3d.org/)是一个开源游戏引擎，完全支持灯光，以及声音和游戏控制。

# c# - 正确处理自动属性的 AC# 到 VB.Net 转换实用程序？

> ID：174662
> 
> 赞同：3
> 
> 时间：2008-10-06T15:04:06.630
> 
> 标签：c#, vb.net, automatic-properties

我希望这不会被认为是重复的，因为它比类似的问题更尖锐（我很好奇 C# 到 VB.net 转换实用程序的特定弱点）。

我一直在考虑使用像这样的[.net 代码转换器](http://www.developerfusion.com/tools/convert/csharp-to-vb/)之类的工具将类库转换为 VB，因为我是我小组中唯一一个熟悉 C# 的人。我遇到的问题是它没有为自动属性生成正确的 VB。它创建空的 get/set 例程。

所以这：

```
public string TransactionType { get; private set; } 
```

变成这样：

```
Public Property TransactionType() As String
    Get
    End Get
    Private Set(ByVal value As String)
    End Set
End Property 
```

[这里](https://stackoverflow.com/questions/102956/c-vbnet-conversion "这里")和[这里](https://stackoverflow.com/questions/88359/what-is-the-best-c-to-vbnet-converter)链接的工具有类似的问题 - 有些创建有效的属性，但他们不尊重设置例程的访问级别。

附带问题 - 如果您要在 DeveloperFusion 上修复转换器，您会让它返回这样的东西吗？

```
Private _TransactionType As String
Public Property TransactionType() As String
    Get
        Return _TransactionType
    End Get
    Private Set(ByVal value As String)
        _TransactionType = value
    End Set
End Property 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T15:43:52.067

我们现在更新了代码生成器以支持这种情况。如果您发现其他我们做得不好的地方，请给我留言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T15:08:57.400

我建议编译代码并使用 Red-Gate 的反射器[http://www.red-gate.com/products/reflector/index.htm](http://www.red-gate.com/products/reflector/index.htm)之类的东西来处理转换。现在它不是“完美的”，我不确定它是否处理自动属性（尽管我想它会）。

使这成为可能的是，当您将 .NET 语言编译为 IL 时，它们完全相同。语言只是在此之上的另一层。因此，在其本机语言中看起来相同的 2 个属性编译为完全相同的 IL 代码。因此，使用 Reflector 之类的东西将其转换为其他语言既简单又快捷。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T16:57:26.180

我在寻找一种使用反射器自动翻译代码的方法时偶然发现了这一点（因为它有几个插件可以生成其他语言的代码（甚至是 PowerShell）），但你让我想知道，所以我试了一下。将兼容性设置为 .Net 3.5，它将您的示例转换为：

```
Property TransactionType As String
  Public Get
  Private Set(ByVal value As String)
End Property 
```

如果你深入研究，它确实报告说有编译器生成的方法，它不会在 VB.Net 或 C# 中导出，具有 3.5 的兼容性……但是，如果你将它切换到 2.0，相同的代码将生成这个：

```
Property TransactionType As String
    Public Get
        Return Me.<TransactionType>k__BackingField
    End Get
    Private Set(ByVal value As String)
        Me.<TransactionType>k__BackingField = value
    End Set
End Property

<CompilerGenerated> _
Private <TransactionType>k__BackingField As String 
```

PS：如果您尝试使用像 Reflector 这样的反汇编程序来生成代码，请记住保留 .pdb 文件，以便获得变量的正确名称；）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T15:16:43.500

作为对您的附带问题的回答：是的，该代码几乎正是我要生成的代码。您无法让它完全按照 C# 代码所做的那样做，即使变量的名称“不可描述”（即无法在代码中引用），但这可能已经足够接近了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T15:17:05.980

我建议查看[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)（有时写为#develop）。它是一个开源 .NET IDE，除其他外，它可以将（有一些问题）从 C# 转换为 VB.NET，反之亦然。

# c# - 作为字符串的运算符

> ID：174664
> 
> 赞同：19
> 
> 时间：2008-10-06T15:04:25.287
> 
> 标签：c#

我需要评估在 C# 中作为字符串呈现给我的数学表达式。示例点头，但将字符串作为表达式的要点。

我需要评估然后填充一个int。

C# 中没有 Eval() 就像在其他语言中一样...

```
String myString = "3*4"; 
```

编辑：

我在VS2008

尝试了 Microsoft.JScript。= 其已弃用的方法（但仍符合 - 警告）

然而，我所做的 Microsoft.JScript dll 工作

> public object InvokeMember(string name, BindingFlags invokeAttr, Binder binder, object target, object[] args);

抱怨缺少“；” 去搞清楚...

编辑 2

解决方案 - 是 codeDom 之一 - 因为没有安全问题，它起作用了 - 只有我会运行代码。非常感谢您的回复...

还有新龙书的链接真棒

编辑 3

Matt dataTable.Compute() 也可以工作——对于安全意识来说甚至更好。（注意参数检查）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-06T17:19:08.930

所有其他答案都可能矫枉过正。

如果您只需要简单的算术，请执行此操作。

```
 DataTable dummy = new DataTable();
        Console.WriteLine(dummy.Compute("15 / 3",string.Empty)); 
```

编辑：更多信息。查看 MSDN 文档以了解该类的`Expression`属性`System.Data.DataColumn`。“表达式语法”上的内容概述了除算术运算符之外您可以使用的命令列表。（例如 IIF、LEN 等）。感谢大家投票支持我第一个发布的答案！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-06T15:19:32.370

在我看来，您有两个选择 - 使用表达式评估器或构造，即时编译和运行 C# 代码。

我会使用表达式评估器库，因为您不必担心任何安全问题。也就是说，您可能无法在中等信任环境（例如大多数共享托管服务器）中使用代码生成。

这是生成代码以评估表达式的示例： [http ://www.vbforums.com/showthread.php?t=397264](http://www.vbforums.com/showthread.php?t=397264)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-06T21:46:30.250

几周前，我在 C# 中将其作为个人练习。

这是相当多的代码，并且在某些地方没有得到很好的评论。但它确实适用于很多测试用例。

享受！

```
using System;
using System.Collections.Generic;
using System.Text.RegularExpressions;

namespace StackOverflow
{
    class Start
    {
        public static void Main(string[] args)
        {
            Evaluator ev;
            string variableValue, eq;
        Console.Write("Enter equation:  ");
        eq = Console.ReadLine();

        while (eq != "quit")
        {
            ev = new Evaluator(eq);
            foreach (Variable v in ev.Variables)
            {
                Console.Write(v.Name + " = ");
                variableValue = Console.ReadLine();
                ev.SetVariable(v.Name, Convert.ToDecimal(variableValue));
            }

            Console.WriteLine(ev.Evaluate());

            Console.Write("Enter equation:  ");
            eq = Console.ReadLine();
        }
    }
}

class EvalNode
{
    public virtual decimal Evaluate()
    {
        return decimal.Zero;
    }
}

class ValueNode : EvalNode
{
    decimal value;

    public ValueNode(decimal v)
    {
        value = v;
    }

    public override decimal Evaluate()
    {
        return value;
    }

    public override string ToString()
    {
        return value.ToString();
    }
}

class FunctionNode : EvalNode
{
    EvalNode lhs = new ValueNode(decimal.Zero);
    EvalNode rhs = new ValueNode(decimal.Zero);
    string op = "+";

    public string Op
    {
        get { return op; }
        set
        {
            op = value;
        }
    }

    internal EvalNode Rhs
    {
        get { return rhs; }
        set
        {
            rhs = value;
        }
    }

    internal EvalNode Lhs
    {
        get { return lhs; }
        set
        {
            lhs = value;
        }
    }

    public override decimal Evaluate()
    {
        decimal result = decimal.Zero;

        switch (op)
        {
            case "+":
                result = lhs.Evaluate() + rhs.Evaluate();
                break;

            case "-":
                result = lhs.Evaluate() - rhs.Evaluate();
                break;

            case "*":
                result = lhs.Evaluate() * rhs.Evaluate();
                break;

            case "/":
                result = lhs.Evaluate() / rhs.Evaluate();
                break;

            case "%":
                result = lhs.Evaluate() % rhs.Evaluate();
                break;

            case "^":
                double x = Convert.ToDouble(lhs.Evaluate());
                double y = Convert.ToDouble(rhs.Evaluate());

                result = Convert.ToDecimal(Math.Pow(x, y));
                break;

            case "!":
                result = Factorial(lhs.Evaluate());
                break;
        }

        return result;
    }

    private decimal Factorial(decimal factor)
    {
        if (factor < 1)
            return 1;

        return factor * Factorial(factor - 1);
    }

    public override string ToString()
    {
        return "(" + lhs.ToString() + " " + op + " " + rhs.ToString() + ")";
    }
}

public class Evaluator
{
    string equation = "";
    Dictionary<string, Variable> variables = new Dictionary<string, Variable>();

    public string Equation
    {
        get { return equation; }
        set { equation = value; }
    }

    public Variable[] Variables
    {
        get { return new List<Variable>(variables.Values).ToArray(); }
    }

    public void SetVariable(string name, decimal value)
    {
        if (variables.ContainsKey(name))
        {
            Variable x = variables[name];
            x.Value = value;
            variables[name] = x;
        }
    }

    public Evaluator(string equation)
    {
        this.equation = equation;
        SetVariables();
    }

    public decimal Evaluate()
    {
        return Evaluate(equation, new List<Variable>(variables.Values));
    }

    public decimal Evaluate(string text)
    {
        decimal result = decimal.Zero;
        equation = text;
        EvalNode parsed;

        equation = equation.Replace(" ", "");

        parsed = Parse(equation, "qx");

        if (parsed != null)
            result = parsed.Evaluate();

        return result;
    }

    public decimal Evaluate(string text, List<Variable> variables)
    {
        foreach (Variable v in variables)
        {
            text = text.Replace(v.Name, v.Value.ToString());
        }

        return Evaluate(text);
    }

    private static bool EquationHasVariables(string equation)
    {
        Regex letters = new Regex(@"[A-Za-z]");

        return letters.IsMatch(equation);
    }

    private void SetVariables()
    {
        Regex letters = new Regex(@"([A-Za-z]+)");
        Variable v;

        foreach (Match m in letters.Matches(equation, 0))
        {
            v = new Variable(m.Groups[1].Value, decimal.Zero);

            if (!variables.ContainsKey(v.Name))
            {
                variables.Add(v.Name, v);
            }
        }
    }

    #region Parse V2

    private Dictionary<string, string> parenthesesText = new Dictionary<string, string>();

    /*
     * 1\.  All the text in first-level parentheses is replaced with replaceText plus an index value.
     *      (All nested parentheses are parsed in recursive calls)
     * 2\.  The simple function is parsed given the order of operations (reverse priority to 
     *      keep the order of operations correct when evaluating).
     *      a.  Addition (+), subtraction (-)                   -> left to right
     *      b.  Multiplication (*), division (/), modulo (%)    -> left to right
     *      c.  Exponents (^)                                   -> right to left
     *      d.  Factorials (!)                                  -> left to right
     *      e.  No op (number, replaced parentheses) 
     * 3\.  When an op is found, a two recursive calls are generated -- parsing the LHS and 
     *      parsing the RHS.
     * 4\.  An EvalNode representing the root node of the evaluations tree is returned.
     * 
     * Ex.  3 + 5                   (3 + 5) * 8
     *           +                          *
     *          / \                        / \
     *         3   5                      +   8
     *                                   / \ 
     *      3 + 5 * 8                   3   5
     *            +
     *           / \
     *          3   *
     *             / \
     *            5   8
     */

    /// <summary>
    /// Parses the expression and returns the root node of a tree.
    /// </summary>
    /// <param name="eq">Equation to be parsed</param>
    /// <param name="replaceText">Text base that replaces text in parentheses</param>
    /// <returns></returns>
    private EvalNode Parse(string eq, string replaceText)
    {
        int randomKeyIndex = 0;

        eq = eq.Replace(" ", "");
        if (eq.Length == 0)
        {
            return new ValueNode(decimal.Zero);
        }

        int leftParentIndex = -1;
        int rightParentIndex = -1;
        SetIndexes(eq, ref leftParentIndex, ref rightParentIndex);

        //remove extraneous outer parentheses
        while (leftParentIndex == 0 && rightParentIndex == eq.Length - 1)
        {
            eq = eq.Substring(1, eq.Length - 2);
            SetIndexes(eq, ref leftParentIndex, ref rightParentIndex);
        }

        //Pull out all expressions in parentheses
        replaceText = GetNextReplaceText(replaceText, randomKeyIndex);

        while (leftParentIndex != -1 && rightParentIndex != -1)
        {
            //replace the string with a random set of characters, stored extracted text in dictionary keyed on the random set of chars

            string p = eq.Substring(leftParentIndex, rightParentIndex - leftParentIndex + 1);
            eq = eq.Replace(p, replaceText);
            parenthesesText.Add(replaceText, p);

            leftParentIndex = 0;
            rightParentIndex = 0;

            replaceText = replaceText.Remove(replaceText.LastIndexOf(randomKeyIndex.ToString()));
            randomKeyIndex++;
            replaceText = GetNextReplaceText(replaceText, randomKeyIndex);

            SetIndexes(eq, ref leftParentIndex, ref rightParentIndex);
        }

        /*
         * Be sure to implement these operators in the function node class
         */
        char[] ops_order0 = new char[2] { '+', '-' };
        char[] ops_order1 = new char[3] { '*', '/', '%' };
        char[] ops_order2 = new char[1] { '^' };
        char[] ops_order3 = new char[1] { '!' };

        /*
         * In order to evaluate nodes LTR, the right-most node must be the root node
         * of the tree, which is why we find the last index of LTR ops.  The reverse 
         * is the case for RTL ops.
         */

        int order0Index = eq.LastIndexOfAny(ops_order0);

        if (order0Index > -1)
        {
            return CreateFunctionNode(eq, order0Index, replaceText + "0");
        }

        int order1Index = eq.LastIndexOfAny(ops_order1);

        if (order1Index > -1)
        {
            return CreateFunctionNode(eq, order1Index, replaceText + "0");
        }

        int order2Index = eq.IndexOfAny(ops_order2);

        if (order2Index > -1)
        {
            return CreateFunctionNode(eq, order2Index, replaceText + "0");
        }

        int order3Index = eq.LastIndexOfAny(ops_order3);

        if (order3Index > -1)
        {
            return CreateFunctionNode(eq, order3Index, replaceText + "0");
        }

        //no operators...
        eq = eq.Replace("(", "");
        eq = eq.Replace(")", "");

        if (char.IsLetter(eq[0]))
        {
            return Parse(parenthesesText[eq], replaceText + "0");
        }

        return new ValueNode(decimal.Parse(eq));
    }

    private string GetNextReplaceText(string replaceText, int randomKeyIndex)
    {
        while (parenthesesText.ContainsKey(replaceText))
        {
            replaceText = replaceText + randomKeyIndex.ToString();
        }
        return replaceText;
    }

    private EvalNode CreateFunctionNode(string eq, int index, string randomKey)
    {
        FunctionNode func = new FunctionNode();
        func.Op = eq[index].ToString();
        func.Lhs = Parse(eq.Substring(0, index), randomKey);
        func.Rhs = Parse(eq.Substring(index + 1), randomKey);

        return func;
    }

    #endregion

    /// <summary>
    /// Find the first set of parentheses
    /// </summary>
    /// <param name="eq"></param>
    /// <param name="leftParentIndex"></param>
    /// <param name="rightParentIndex"></param>
    private static void SetIndexes(string eq, ref int leftParentIndex, ref int rightParentIndex)
    {
        leftParentIndex = eq.IndexOf('(');
        rightParentIndex = eq.IndexOf(')');
        int tempIndex = eq.IndexOf('(', leftParentIndex + 1);

        while (tempIndex != -1 && tempIndex < rightParentIndex)
        {
            rightParentIndex = eq.IndexOf(')', rightParentIndex + 1);
            tempIndex = eq.IndexOf('(', tempIndex + 1);
        }
    }
}

public struct Variable
{
    public string Name;
    public decimal Value;

    public Variable(string n, decimal v)
    {
        Name = n;
        Value = v;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T15:08:59.363

您可以使用 jscript 解释器。一篇很棒的文章在这里：[http ://www.odetocode.com/Articles/80.aspx](http://www.odetocode.com/Articles/80.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T15:10:09.503

当您说“像其他语言一样”时，您应该说“像动态语言一样”。

对于像 python、ruby 和许多*解释*语言这样的动态语言，Eval() 函数是一个自然元素。事实上，实现你自己的可能甚至是微不足道的。

然而，.Net 的核心是一个静态的、强类型的、*编译*的平台（至少在动态语言运行时获得更多支持之前）。这具有难以忽视的代码注入安全性和编译时类型检查等天然优势。但这意味着 Eval() 函数不太合适——它希望能够提前编译表达式。在这种平台中，通常还有其他更安全的方法来完成相同的任务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T16:10:25.247

退房[逃离](http://codeplex.com/Flee)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T03:38:34.420

MS 有一个名为 Dynamic Query Library 的示例。它由 LINQ 团队提供，用于动态构建 LINQ 查询，例如： Dim query = Northwind.Products.Where("CategoryID=2") 您可以检查它是否提供基本的数学功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T15:10:48.673

在解释语言中，您可能有机会使用解释器评估字符串。在 C# 中，您需要一个用于编写字符串的语言（数学表达式的语言）的解析器。这是一个不平凡的练习。如果您想这样做，请使用递归下降解析器。“Dragon Book”的早期章节（编译器：Aho、Sethi 和 Ullman 的设计等 - 1977 年第 1 版或 2007 年第 2 版）很好地解释了您需要做什么。

另一种方法可能是在您的项目中包含一个用 perl 编写的组件，该组件现在应该可用于 .NET，并使用 perl 进行评估。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T15:12:06.083

[jscript 解释器](http://www.odetocode.com/Articles/80.aspx)可以做，或者如果表达式很简单，您可以编写自己的解析器（请注意，它变得非常复杂）。

我很确定 C# 中没有直接的“Eval(string)”方法，因为它没有被解释。

请记住，尽管代码解释会受到代码注入的影响，但要格外小心 :)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T15:12:32.197

计算表达式时是否需要访问其他变量的值？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-06T15:30:38.103

经过一番谷歌搜索，我发现可以使用 CodeDom 即时创建和编译代码。（见[教程](http://www.csharpcorner.com/UploadFile/mgold/CodeDomCalculator08082005003253AM/CodeDomCalculator.aspx)）。

我个人认为这种方法不是一个好主意，因为用户可以输入他想要的任何代码，但这可能是一个需要探索的领域（例如，只验证输入，只允许数字和简单的数学运算） .

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-06T19:33:24.557

其他一些建议：

*   Mono 2.0（今天出来）有一个 eval 方法。
*   您可以轻松地在 boo 中编写一个特定的小型域。
*   您可以创建一个老式的递归下降 EBNF 解析器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-17T19:20:27.350

我已经在我的网站上发布了一个超紧凑（1 类，< 10 KiB）Java 数学评估器的源代码。将它移植到 C# 应该很简单。还有其他的可能会做得更多，但这非常有能力，而且*很小*。

# asp.net - 我应该为 ASP.net 创建一个 JQuery 服务器控件以便在我的应用程序中最好地使用它吗？

> ID：174672
> 
> 赞同：5
> 
> 时间：2008-10-06T15:06:52.037
> 
> 标签：asp.net, javascript, jquery, webforms

我在组织内推广 JQuery 方面相当成功。靠它自己可不是小事。然而，为了使它成为我们应用程序的一部分，这里提出的一个想法是创建一个 ASP.net 服务器端控件。（在可预见的未来，我们将坚持使用 WebForms。）

我对这种方法并不太狂热，因为当几个脚本标签可以完成这项工作时，这似乎有点过头了。我们在网上找到了[一篇文章](http://www.west-wind.com/WebLog/posts/167052.aspx)，涉及的代码量似乎并不能证明其合理性。但是，我确实听说在脚本缓存或生成服务器控件时会产生一些好处。

我的问题：

*   有没有其他人编写过 ASP.net 服务器控件来提供 JQuery js 代码？
*   有没有其他人认为避免编写 JQuery 或 Javascript 代码是一个疯狂的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T15:14:03.053

我知道微软（连同诺基亚）正在“主流化” jQuery，并将把它与 Visual Studio 的未来版本集成。您可能想探索他们将如何正式使用它，以便您现在可以定制您的设置，并希望在以后轻松过渡到“官方 MS jQuery”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T15:17:51.687

我同意你的看法。不值得花时间创建和创建控件以添加 JQuery 脚本位置。

更好的解决方案是拥有 1 个 .js 文件，其中包含在页面上加载所需的所有链接。如果这是团队的问题，那可以消除分配的 .js 链接。

唯一一次我会原谅创建自定义控件以仅链接 JavaScript 是出于某种原因，您不想将 JavaScript 复制到服务器并希望将其嵌入到 .dll 中。但是，您不会阻止人们在页面上看到 JavaScript，因为如果您将文件嵌入到 .dll 中，您必须在标头中将它们注册为完整的脚本文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T23:35:29.343

使用服务器控件注入 JavaScript 引用的一个原因是更容易控制将哪些 JavaScript 文件添加到页面。想象一个场景，你使用 jQuery 核心，加上 jQuery UI 和一些其他插件。根据您对该控件的编码方式，您可以让开发人员轻松选择特定页面所需的功能，而无需担心所需的特定脚本。这种方法可以为您的应用程序分段提供很大的灵活性：例如，服务器控件可能被母版页、子页、用户控件或其他服务器控件使用。如果母版页注册了对一个 jQuery 库的要求，但子页或用户控件之一需要其他库，那么拥有统一的 API 会使这变得简单。亲自，

底线是您希望每个开发人员重新发明轮子或使用通用、易于使用的 API 来强制您的应用程序的一致性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T15:35:41.260

我找到了 Scott Hanselman 的[博客文章](http://www.hanselman.com/blog/jQuerytoshipwithASPNETMVCandVisualStudio.aspx)，其中包含一个具有 ASP.net AJAX + JQuery 的示例应用程序。这是一个简单的应用程序，但它包含所有带有脚本标签的 javascript。我没有看到任何建议使用服务器控件来提供脚本。

# php - 使用 PHP 写入 OS X 的日志数据库？

> ID：174699
> 
> 赞同：1
> 
> 时间：2008-10-06T15:14:14.410
> 
> 标签：php, macos, logging

是否存在任何支持从外部源写入 OS X 日志数据库的应用程序/包。除了您可以从控制台应用程序查看其内容之外，我对数据库的细节不太熟悉。我什至不确定它是否只是一些简单数据库（如 SQLite）的一个版本，或者它是否是某种专有/内部/无法访问的东西。

到目前为止，我最好的猜测是以下两种情况之一是可能的：

*   看起来它会接受来自本机运行的应用程序的日志条目，所以也许使用在后台运行的某种守护程序可以接受文本输入并将其中继到日志数据库会起作用吗？

*   想到的另一种选择是是否有某种方法可以直接访问数据库，在这种情况下，PHP 脚本可以简单地连接到它以创建日志条目。

如果哪位有知识的人能补充一下，我将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T15:20:12.477

我从未使用过 OS X，但您可能想查看[syslog](http://www.php.net/syslog)功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-25T00:14:33.180

在你的 PHP 中做一个**syslog(LOG_WARNING, "whatever");**

在终端类型**syslog -w**

它将输出**警告：无论**

然后它将打印出系统日志。您还将在 syslog 中收到系统消息。-w 帮助只列出最近的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T18:46:40.500

日志文件是纯文本，可在 (~)/Library/Logs 中找到。OS X 和大多数 *nix 系统一样使用 syslogd 进程，您可以使用 RoBorg 提到的 syslog 登录到该进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T18:19:12.977

OS X 确实使用 SQLite 作为 CoreData 的一部分。我的印象是它是使用 OS X 在本地存储数据的主要方式，所以我希望它也能与它一起记录。

# visual-studio - Visual Studio 2005 未加载

> ID：174702
> 
> 赞同：0
> 
> 时间：2008-10-06T15:14:42.130
> 
> 标签：visual-studio, visual-studio-2005, development-environment

在 Visual Studio 2005 显示启动画面后，它锁定在我身上。没有错误，没有 cpu 利用率，只是一个冻结的启动画面。我在 /safemode 和 /resetsettings 都试过了

我确定这是我机器上的一项服务，只是想知道是否有其他人遇到过问题并可以帮助我进行搜索？

顺便说一句，它在同一台机器上的虚拟机中工作。

更新：我终于尝试了一些新的东西，我在 Windows 兼容 2000 模式下启动了 VS2005，它启动然后立即关闭。我将它重置为不在兼容模式下运行，它会立即启动。呸呸呸

我认为这可能是个人资料问题，但根本原因仍未解决。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T15:16:40.363

您是否尝试过在[安全模式下](http://msdn.microsoft.com/en-us/library/xee0c8y7(VS.80).aspx)运行它- 如果这不能让您解决问题，您可以尝试 /resetsettings 开关，它过去曾为我解决过类似的问题。

/resetuserdata 也可以提供帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T15:23:31.097

查看您机器的事件日志，看看 VS 是否在其中抛出了任何有用的信息；您可能需要卸载并重新安装

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T08:20:32.790

我的机器上安装了 VMWare。这是我的问题的原因！

我按照上面的建议在 Windows 兼容 2000 模式下启动了 VS2005 - 它启动然后立即关闭。然后我在没有兼容模式的情况下运行，VS2005 现在运行完美！

我浪费了半天时间试图解决这个问题！

谢谢你的文章！

:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T18:17:35.563

尝试使用 log 命令启动：

```
devenv.exe /Log c:\vs.log 
```

看看里面有没有写什么。

要尝试的另一件事是在临时用户帐户中运行 VS，以查看问题是完全出在您的用户环境还是系统范围内。看到[这个帖子](https://stackoverflow.com/questions/851477/visual-studion-2008-exits-as-soon-as-i-open-it/853198#853198)。

# tfs - AssemblyInfo.cs 文件的自动更新和签入偶尔会导致部分失败

> ID：174705
> 
> 赞同：2
> 
> 时间：2008-10-06T15:14:54.143
> 
> 标签：tfs, msbuild, assemblies

我们将 TFS 2008 构建设置为签出项目中的所有 AssemblyInfo.cs 文件，使用 AssemblyInfoTask 更新它们，然后根据构建是否通过来撤消签出或签入。不幸的是，当两个构建紧密排列在一起时，这会导致构建部分完成，因为 AssemblyInfo.cs 文件似乎是在先前签入的早期版本中签出的。

为了解决这个问题，我认为我可以使用“获取”任务将 AssemblyInfo.cs 文件强制为最新版本，然后再更新它们，但这似乎没有效果。有任何想法吗？

```
<Target Name="AfterGet" Condition="'$(IsDesktopBuild)'!='true'">
<Message Text="SolutionRoot = $(SolutionRoot)" />
<Message Text="OutDir = $(OutDir)" />
<!-- Set the AssemblyInfoFiles items dynamically -->
<CreateItem Include="$(SolutionRoot)\Main\Source\InputApplicationSln\**\$(AssemblyInfoSpec)">
  <Output ItemName="AssemblyInfoFiles" TaskParameter="Include" />
</CreateItem>

<Message Text="$(AssemblyInfoFiles)" />

<!-- When builds are queued up successively, it is possible for the next build to be set up before the AssemblyInfoSpec is checked in so we need to force 
    the latest these versions of these files to be got before a checkout -->
<Get Condition=" '$(SkipGet)'!='true' " TeamFoundationServerUrl="$(TeamFoundationServerUrl)" Workspace="$(WorkspaceName)" Filespec="$(AssemblyInfoSpec)"  Recursive="$(RecursiveGet)" Force="$(ForceGet)" />

<Exec WorkingDirectory="$(SolutionRoot)\Main\Source\InputApplicationSln"
          Command="$(TF) checkout /recursive $(AssemblyInfoSpec)"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-06T18:14:57.600

您的构建是否重写了 AssemblyInfo 文件，然后重新签入？还是您只是在本地修改 AssemblyInfo 文件。就我个人而言，我更喜欢后一种方法——正如 TFSBuild 食谱网站上所记录的那样：

[http://tfsbuild.com/AssemblyVersioning%20.ashx](http://tfsbuild.com/AssemblyVersioning%20.ashx)

我从来没有真正坐下来检查过，但我想知道如果您检查了 AssemblyInfo 文件，那么可能会发生以下情况，这可能会导致您的问题......

1.  请求构建，当前变更集 = 42
2.  变更集 42 的构建 1 开始运行
3.  请求构建，当前变更集 = 42（仍然）
4.  为变更集 42 排队的构建 2
5.  Build 1 检查新的 assemblyinfo 文件，当前变更集 = 43
6.  构建 1 完成
7.  变更集 42 的构建 2 开始，获取变更集 42 意味着 AssemblyInfo 文件是折叠文件。

正如我所说，不确定何时为构建确定变更集编号 - 在排队时或在运行时。不过，在排队的时候会更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T07:14:12.833

改变：

```
<Get Condition=" '$(SkipGet)'!='true' " TeamFoundationServerUrl="$(TeamFoundationServerUrl)" Workspace="$(WorkspaceName)" Filespec="$(AssemblyInfoSpec)"  Recursive="$(RecursiveGet)" Force="$(ForceGet)" /> 
```

到：

```
<Get Condition=" '$(SkipGet)'!='true' " TeamFoundationServerUrl="$(TeamFoundationServerUrl)" Workspace="$(WorkspaceName)" Filespec="$(AssemblyInfoSpec)"  Recursive="True" Force="True" /> 
```

已强制用树顶覆盖 AssemblyInfo.cs 文件。到目前为止，它一直在工作，但更像是一种 hack，而不是优雅的东西。

# vb6 - 比较 VB6.exe

> ID：174706
> 
> 赞同：2
> 
> 时间：2008-10-06T15:16:18.087
> 
> 标签：vb6, migration, compare

我们正在经历一个大规模的迁移项目，并试图验证部署到现场的代码是否与我们在源代码控制中的代码相匹配。

显然 .net 代码很容易比较，因为我们可以反汇编。由于编译方式，我不相信这在 vb6 exes 中是可能的。

有没有人对我如何验证源代码和编译的可执行文件与我在 Live 中的文件匹配有任何想法。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T15:36:24.660

Visual Basic 有（有）两种编译方式，一种是编译器（称为 P 代码），它会生成更小的二进制文件，另一种是生成“常规”windows .exe 文件（称为本机），因为它被引入应该比 p 码快；尽管使用此选项会增加编译文件的大小。如果您的编译使用 p 代码，理论上可以恢复源代码。

无论哪种方式都很难做到，但有些工具声称他们可以部分做到这一点，我知道的一个（从未尝试过，但有试用版）是 VB-decompiler [http://www.vb-decompiler.org /](http://www.vb-decompiler.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T15:18:59.750

不幸的是，这几乎是不可能的。请记住，在不同机器上编译的 VB6 代码会有不同的 exe 大小和部署要求。

这就是为什么老 VB'ers 有一台专门的机器来编译他们的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T15:37:27.623

这不会帮助您处理已经部署的项目，但是如果您在每次编译时都增加了修订号（有一个项目设置可以自动为您执行此操作），那么您可以轻松比较版本号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T15:41:21.857

我的旧公司购买了该 VB-Decompiler 的副本，并且如前所述 VB5/6 生成额外的 P-Code，该工具确实生成了一些代码，如果不是可以“读取”的汇编代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T17:22:28.410

如果您拥有编译的所有代码，您可以将该代码的 CRC 与现场部署的内容进行比较。但是，如果您没有原始编译代码，则取决于您如何编译代码（如果您使用 P 代码而不是本机代码，您可能能够反汇编，但反汇编看起来与您的源代码完全不同）。我怀疑您是否会将 PDB 与 exe 一起发布，但如果您这样做了，您当然可以使用它们与您的存储库中的源代码进行比较。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T19:47:10.863

拥有一台可以检查您制作的各种库和 exe 并自动编译它们的受信任的计算机。将它们保存在只读但可访问的位置。然后在部署的站点和您的比较站点之间进行二进制比较。

但是，我不确定拆卸已编译单元的逻辑。我的公司和我所知道的大多数其他地方都使用构建计算机和单元测试的组合。在我们公司，我们制作的 EXE 是一堆库中的一个非常薄的外壳。例如，按钮单击将传递给执行实际处理的 UI Active X DLL。我们在构建之后要做的是运行一个特殊的 EXE 来执行我们的单元测试列表。如果他们都通过了，我们就知道我们的库（我们 90% 的代码所在的位置）是好的。至于实际的EXE，我们有一个大约需要两个小时才能完成的手动程序，然后我们就很好了。I在EXE中很少发生任何错误。

# php - LAMP 服务器的 Linux 用户和组

> ID：174715
> 
> 赞同：6
> 
> 时间：2008-10-06T15:17:17.757
> 
> 标签：php, linux, apache, lamp

就 linux 用户和组而言，设置 LAMP 服务器的最佳实践是什么？如果在同一台服务器上托管多个站点，最好让一个用户拥有与 apache 位于同一组中的所有站点源文件（和上传） - 还是每个站点都有不同的用户（这样每个站点都有自己的 crontab）？还是完全不同的东西？

出于某种原因，我遇到的 PHP/MySQL/Linux 书籍似乎从未解决过这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T15:38:45.887

On our platform each site's htdocs etc has it's own user. This means if one site is compromised, the others should be fine.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T15:44:06.407

If this is a small number of large sites, you may find that splitting your server into multiple VMs using something like Xen is a better option than simply segregating by user. This will improve the isolation of your sites, and make it easier to move a site to its own hardware if, in future, one starts to become much heavier on resource usage than the others.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T18:40:16.007

我假设您不想发疯并为 cPanel 获得 WHM，并且可能希望以低廉的价格执行此操作。

我认为让每个用户从他们自己的用户名和组访问他们的空间是一个最佳实践 - 特别是如果不相关的用户可能正在使用网络服务器。

如果您有超过 10 个域和用户，并且希望将帐户隔离到自己的空间，我会考虑使用 Webmin 并在服务器上安装 VirtualMin。这很容易在一个不错的免费安装中处理这些类型的问题。否则，您将不得不购买商业产品或手动处理所有事情 - 真的很痛苦，但可以做到（不推荐用于商业企业）。

此外，Xen 和 VMS 可能有点矫枉过正，但也不像 Webmin/VirtualMin 那样易于管理 10-100 多个帐户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-02T16:00:05.067

最好的选择是使用 Apache 和 suPHP 模块为每个域创建 VirtualHost。通过这种方式，每个站点将归一个用户所有，并在该用户的许可下运行。每个站点的 webroot 都应该放在用户的 homedir 下，以防止本地攻击。

如果您为每个网站使用相同的用户，这意味着来自 websiteA 的用户可以读取/写入 websiteB 的文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-20T19:05:53.880

几年来，我做了某种小型托管，我的回答是“视情况而定”。

首先Apache Module（mod_php）是有区别的。CGI 和 FastCGI。可以在这里找到一个包含所有优点和缺点的好列表： [Apache php 模式](http://blog.layershift.com/which-php-mode-apache-vs-cgi-vs-fastcgi/)

在安全性方面，所有模式都有利有弊。

由于我们只托管了相对少量的流量适中的域，我决定继续使用 mod_php 并使用 vhost 配置。

我还为每个虚拟主机根目录使用了不同的 FTP 用户（当然）。

配置虚拟主机（每个客户一个）允许您以简单的方式关闭域，而无需通过一个可笑的大 httpd.conf 并在途中产生错误。

# svn - 将配置文件保存在 SVN 下的最佳方法？

> ID：174719
> 
> 赞同：12
> 
> 时间：2008-10-06T15:18:26.100
> 
> 标签：svn, version-control, configuration

将配置文件（例如 httpd.conf、my.cnf、.bashrc ...）置于版本控制之下的最佳方式是什么？除了版本控制的好处之外，我希望该解决方案也可以用作备份，这样我就可以带来一个全新的服务器并直接从 SVN 中检出（或导出）配置文件

一个好的方法是存储配置文件的原始路径。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T15:35:26.143

我对我的配置文件进行修订控制，但我使用[git](http://git.or.cz/)而不是 svn（当你有多台机器时这更容易）。我有一个 bash 脚本（称为`install.sh`），也在存储库下，它将文件复制或符号链接到机器上的适当位置。

因此，如果我需要在新机器上进行设置，我只需对存储库进行 git clone（相当于 svn checkout）并运行 my`install.sh`以在适当的位置设置我的配置文件。有`install.sh`周围意味着我还存储了配置文件的原始路径，正如你所指出的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T15:55:40.800

This is what I have implemented:

I have a server that does rsync of all the configs into one directory (say /data/configs/hostname/{etc,httpd}.

I have an rsync running every hour to transfer the changes. as soon as rsync is complete, there is an svnautocommit script that does autocommit of the changes. This way, I can roll back to any change or any version I want to.

You might need to plan the SVN directory structure based on your requirements.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T15:57:05.617

As you want a central store anyway, you may go for something slightly more complicated like **[Slack](http://code.google.com/p/slack/)**. You administer and version control the files at a push server, then rsync it to the clients. The [explanation of subroles](http://code.google.com/p/slack/wiki/Subroles) has some examples on how to structure the tree.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T15:34:52.900

我为几台机器执行此操作，从旧的 Solaris 8 机器到 Mac OS X，我有一个非常简单的布局：

在我的存储库中，我有以下内容：

```
<root>/common
  /.emacs.d
  /.bash_common
  /scripts # platform-independent binary tools

<root>/linux
  .bashrc
  .emacs
  ...

<root>/solaris
  .bashrc
  .emacs
  ...

<root>/osx
  .bashrc
  .emacs
  ... 
```

每个操作系统主目录都有一个 svn:externals 对 .emacs.d、.bash_common 和脚本的引用，因此不会重复。

此外，我在 linux 和 solaris 目录中有一个 .bash_hostconfig 具有特定于主机的路径配置等，因为我在工作中的设置与我在家里的设置非常不同（FC5-8 和 RHEL3-5，取决于我在哪里是）。

因此，在这些事情之间，我有一个在新机器上启动和运行的非常简单的过程：我只需将 /$platform 检出到一个临时目录中，然后用这些文件覆盖 $HOME 中的所有内容。我不需要存储原始路径，因为它总是以这种方式相对于 $HOME 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T15:37:02.163

我们使用 CVS 将配置存储在一个尽可能扁平的目录结构中。这种技术很容易扩展到 SVN。

然后我们设置了一个 Makefile 以使用 CVS 导出到：

1.  创建没有 CVS 组件的 CVS 目录结构的副本，
2.  在本地目录中创建目标机器所需的目录结构，就像在目标机器的根目录中一样，例如 ./my_cvs_dir/etc/.. 和 ./my_cvs_dir/usr/local/newapp/..，
3.  将文件从 CVS 结构复制到目标目录结构，
4.  为目标目录结构创建一个 tarball，以及
5.  将 tarball 部署到目标计算机。

我们还设置了这些 tarball 以增加专业化，例如 Sol10、Apache、特定应用程序等。

高温高压

干杯，

抢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T15:37:04.660

好吧，您可以将所有配置文件存储在特定的目录树下，每个应用程序一个子目录。由于大多数应用程序应该有一个指令来指定配置路径，因此这是每个服务器唯一需要更改的内容（或者如果您有硬编码的配置文件，可能支持 include 之类的东西）。

然后可以将这棵树检查到您喜欢的任何 VCS 中。

对于部署，您可以编写一个 shell 脚本或类似的东西来初始化所有内容以使用您的配置文件树。

# oracle - 发现什么进程/查询正在使用 oracle 临时表空间

> ID：174727
> 
> 赞同：12
> 
> 时间：2008-10-06T15:20:39.217
> 
> 标签：oracle, debugging, performance, statistics, oracleinternals

Oracle FAQ 对临时表空间的定义如下：

> 临时表空间用于管理数据库排序操作和存储全局临时表的空间。例如，如果您连接两个大表，而 Oracle 无法在内存中进行排序，则会在临时表空间中分配空间来进行排序操作。

这很好，但我需要更多关于究竟是什么在使用该空间的详细信息。由于应用程序设计的怪癖，大多数查询都会进行某种排序，因此我需要将其缩小到客户端可执行文件、目标表或 SQL 语句。

本质上，我正在寻找线索来更准确地告诉我这个（相当大的应用程序）可能有什么问题。任何类型的线索都可能有用，只要它比“排序”更精确。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-06T15:30:37.357

我不确定您已经提交了哪些信息，但使用以下查询将指出哪些程序/用户/会话等当前正在使用您的临时空间。

```
SELECT   b.TABLESPACE
       , b.segfile#
       , b.segblk#
       , ROUND (  (  ( b.blocks * p.VALUE ) / 1024 / 1024 ), 2 ) size_mb
       , a.SID
       , a.serial#
       , a.username
       , a.osuser
       , a.program
       , a.status
    FROM v$session a
       , v$sort_usage b
       , v$process c
       , v$parameter p
   WHERE p.NAME = 'db_block_size'
     AND a.saddr = b.session_addr
     AND a.paddr = c.addr
ORDER BY b.TABLESPACE
       , b.segfile#
       , b.segblk#
       , b.blocks; 
```

一旦你发现哪个会话造成了损害，然后看看正在执行的 SQL，你应该走在正确的道路上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-22T08:24:12.770

感谢 Michael OShea 的回答，

但是如果您有 Oracle RAC 多个实例，那么您将需要这个...

```
SELECT   b.TABLESPACE
       , b.segfile#
       , b.segblk#
       , ROUND (  (  ( b.blocks * p.VALUE ) / 1024 / 1024 ), 2 ) size_mb
       , a.inst_ID
       , a.SID
       , a.serial#
       , a.username
       , a.osuser
       , a.program
       , a.status
    FROM gv$session a
       , gv$sort_usage b
       , gv$process c
       , gv$parameter p
   WHERE p.NAME = 'db_block_size'
     AND a.saddr = b.session_addr
     AND a.paddr = c.addr
     -- AND b.TABLESPACE='TEMP2'
ORDER BY a.inst_ID , b.TABLESPACE
       , b.segfile#
       , b.segblk#
       , b.blocks; 
```

这是生成终止语句的脚本：请查看您将要终止的会话...

```
SELECT  b.TABLESPACE, a.username , a.osuser , a.program , a.status ,
       'ALTER SYSTEM KILL SESSION '''||a.SID||','||a.SERIAL#||',@'||a.inst_ID||''' IMMEDIATE;'
    FROM gv$session a
       , gv$sort_usage b
       , gv$process c
       , gv$parameter p
   WHERE p.NAME = 'db_block_size'
     AND a.saddr = b.session_addr
     AND a.paddr = c.addr
     -- AND b.TABLESPACE='TEMP'
ORDER BY a.inst_ID , b.TABLESPACE
       , b.segfile#
       , b.segblk#
       , b.blocks; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T23:28:36.220

一条经验法则是，几乎所有耗时超过一秒的查询都可能使用一些 TEMP 空间，而且这些不仅仅是涉及 ORDER BY 的查询，还包括：

1.  GROUP BYs（10.2 之前的 SORT GROUPBY 和 10.2 之后的 HASH GROUPBY）
2.  HASH JOIN 或 MERGE JOIN
3.  全球临时表（显然）
4.  索引重建

有时，临时表空间中的已用空间不会被 Oracle 释放（错误/怪癖），因此您需要手动从表空间中删除一个文件，从文件系统中删除它并创建另一个文件。

# php - 在 PHP 中验证信用卡的最佳方法是什么？

> ID：174730
> 
> 赞同：73
> 
> 时间：2008-10-06T15:21:39.200
> 
> 标签：php, validation, e-commerce, numbers, credit-card

给定一个信用卡号并且没有其他信息，PHP 中确定它是否是有效号码的最佳方法是什么？

现在我需要一些适用于 American Express、Discover、MasterCard 和 Visa 的东西，但如果它也适用于其他类型可能会有所帮助。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2008-10-06T15:25:26.507

卡号的验证分为三个部分：

1.  **PATTERN** - 它是否与发行人模式匹配（例如 VISA/万事达卡/等）
2.  **CHECKSUM** - 它实际上是否校验和（例如，不仅仅是“34”之后的 13 个随机数使其成为 AMEX 卡号）
3.  **确实**存在 - 它实际上是否有关联帐户（如果没有商家帐户，您不太可能获得此帐户）

## 图案

*   MASTERCARD 前缀=51-55，长度=16（Mod10 校验和）
*   VISA 前缀=4，长度=13 或 16 (Mod10)
*   美国运通前缀=34 或 37，长度=15 (Mod10)
*   Diners Club/Carte Prefix=300-305, 36 or 38, Length=14 (Mod10)
*   发现前缀=6011,622126-622925,644-649,65, 长度=16, (Mod10)
*   等（[前缀的详细列表](http://en.wikipedia.org/wiki/Bank_card_number#Issuer_identification_number_.28IIN.29)）

## 校验和

大多数卡片使用 Luhn 算法进行校验和：

[维基百科上描述的 Luhn 算法](http://en.wikipedia.org/wiki/Luhn_algorithm)

Wikipedia 链接上有许多实现的链接，包括 PHP：

```
<?
/* Luhn algorithm number checker - (c) 2005-2008 shaman - www.planzero.org *
 * This code has been released into the public domain, however please      *
 * give credit to the original author where possible.                      */

function luhn_check($number) {

  // Strip any non-digits (useful for credit card numbers with spaces and hyphens)
  $number=preg_replace('/\D/', '', $number);

  // Set the string length and parity
  $number_length=strlen($number);
  $parity=$number_length % 2;

  // Loop through each digit and do the maths
  $total=0;
  for ($i=0; $i<$number_length; $i++) {
    $digit=$number[$i];
    // Multiply alternate digits by two
    if ($i % 2 == $parity) {
      $digit*=2;
      // If the sum is two digits, add them together (in effect)
      if ($digit > 9) {
        $digit-=9;
      }
    }
    // Total up the digits
    $total+=$digit;
  }

  // If the total mod 10 equals 0, the number is valid
  return ($total % 10 == 0) ? TRUE : FALSE;

}
?> 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-10-06T15:31:43.530

在[PHP 中你不能没有的 10 个正则表达式](http://web.archive.org/web/20080918014358/http://www.roughguidetophp.com/10-regular-expressions-you-just-cant-live-without-in-php/)：

```
function check_cc($cc, $extra_check = false){
    $cards = array(
        "visa" => "(4\d{12}(?:\d{3})?)",
        "amex" => "(3[47]\d{13})",
        "jcb" => "(35[2-8][89]\d\d\d{10})",
        "maestro" => "((?:5020|5038|6304|6579|6761)\d{12}(?:\d\d)?)",
        "solo" => "((?:6334|6767)\d{12}(?:\d\d)?\d?)",
        "mastercard" => "(5[1-5]\d{14})",
        "switch" => "(?:(?:(?:4903|4905|4911|4936|6333|6759)\d{12})|(?:(?:564182|633110)\d{10})(\d\d)?\d?)",
    );
    $names = array("Visa", "American Express", "JCB", "Maestro", "Solo", "Mastercard", "Switch");
    $matches = array();
    $pattern = "#^(?:".implode("|", $cards).")$#";
    $result = preg_match($pattern, str_replace(" ", "", $cc), $matches);
    if($extra_check && $result > 0){
        $result = (validatecard($cc))?1:0;
    }
    return ($result>0)?$names[sizeof($matches)-2]:false;
} 
```

样本输入：

```
$cards = array(
    "4111 1111 1111 1111",
);

foreach($cards as $c){
    $check = check_cc($c, true);
    if($check!==false)
        echo $c." - ".$check;
    else
        echo "$c - Not a match";
    echo "<br/>";
} 
```

这给了我们

```
4111 1111 1111 1111 - 签证

```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-02T18:06:03.780

最好不要在最后验证代码。将卡信息直接发送到您的支付网关，然后处理他们的响应。如果您不先进行 Luhn 检查之类的操作，它可以帮助他们检测欺诈行为——让他们看到失败的尝试。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-06T15:25:10.220

**PHP 代码**

```
function validateCC($cc_num, $type) {

    if($type == "American") {
    $denum = "American Express";
    } elseif($type == "Dinners") {
    $denum = "Diner's Club";
    } elseif($type == "Discover") {
    $denum = "Discover";
    } elseif($type == "Master") {
    $denum = "Master Card";
    } elseif($type == "Visa") {
    $denum = "Visa";
    }

    if($type == "American") {
    $pattern = "/^([34|37]{2})([0-9]{13})$/";//American Express
    if (preg_match($pattern,$cc_num)) {
    $verified = true;
    } else {
    $verified = false;
    }

    } elseif($type == "Dinners") {
    $pattern = "/^([30|36|38]{2})([0-9]{12})$/";//Diner's Club
    if (preg_match($pattern,$cc_num)) {
    $verified = true;
    } else {
    $verified = false;
    }

    } elseif($type == "Discover") {
    $pattern = "/^([6011]{4})([0-9]{12})$/";//Discover Card
    if (preg_match($pattern,$cc_num)) {
    $verified = true;
    } else {
    $verified = false;
    }

    } elseif($type == "Master") {
    $pattern = "/^([51|52|53|54|55]{2})([0-9]{14})$/";//Mastercard
    if (preg_match($pattern,$cc_num)) {
    $verified = true;
    } else {
    $verified = false;
    }

    } elseif($type == "Visa") {
    $pattern = "/^([4]{1})([0-9]{12,15})$/";//Visa
    if (preg_match($pattern,$cc_num)) {
    $verified = true;
    } else {
    $verified = false;
    }

    }

    if($verified == false) {
    //Do something here in case the validation fails
    echo "Credit card invalid. Please make sure that you entered a valid <em>" . $denum . "</em> credit card ";

    } else { //if it will pass...do something
    echo "Your <em>" . $denum . "</em> credit card is valid";
    }

} 
```

用法

```
echo validateCC("1738292928284637", "Dinners"); 
```

**更多理论信息可以在这里找到：**

[信用卡验证 - 校验位](http://www.beachnet.com/~hstiles/cardtype.html)

[校验和](http://en.wikipedia.org/wiki/Luhn_algorithm)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T15:27:50.230

[luhn 算法](http://en.wikipedia.org/wiki/Luhn_algorithm)是一个校验和，可用于验证许多信用卡格式的格式（以及加拿大社会保险号码......）

维基百科文章还链接到许多不同的实现；这是一个PHP：

[http://planzero.org/code/bits/viewcode.php?src=luhn_check.phps](http://planzero.org/code/bits/viewcode.php?src=luhn_check.phps)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-07T11:56:40.360

有一个 PEAR 包可以处理许多财务号码的验证，以及信用卡验证： http: [//pear.php.net/package/Validate_Finance_CreditCard](http://pear.php.net/package/Validate_Finance_CreditCard)

顺便说一下，这里有一些PayPal[测试的信用卡帐号](http://www.paypal.com/en_US/vhelp/paypalmanager_help/credit_card_numbers.htm)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-12T14:28:09.397

只需添加一些其他人可能会觉得有用的代码片段（不是 PHP 代码）。

**PYTHON**（单行代码；可能效率不高）

验证：

```
>>> not(sum(map(int, ''.join(str(n*(i%2+1)) for i, n in enumerate(map(int, reversed('1234567890123452'))))))%10)
True
>>> not(sum(map(int, ''.join(str(n*(i%2+1)) for i, n in enumerate(map(int, reversed('1234567890123451'))))))%10)
False 
```

要返回所需的校验位：

```
>>> (10-sum(map(int, ''.join(str(n*(i%2+1)) for i, n in enumerate(map(int, reversed('123456789012345')), start=1)))))%10
2
>>> (10-sum(map(int, ''.join(str(n*(i%2+1)) for i, n in enumerate(map(int, reversed('234567890123451')), start=1)))))%10
1 
```

* * *

**MySQL 函数**

函数“ccc”和“ccd”（信用卡支票和信用卡数字）

请注意，“ccc”函数有一个额外的检查，如果计算的总和为 0，则返回的结果将始终为 FALSE，因此全零的 CC 数字永远不会验证为正确（在正常行为下，它会正确验证）。可以根据需要添加/删除此功能；可能有用，具体取决于具体要求。

```
DROP FUNCTION IF EXISTS ccc;
DROP FUNCTION IF EXISTS ccd;

DELIMITER //

CREATE FUNCTION ccc (n TINYTEXT) RETURNS BOOL
BEGIN
  DECLARE x TINYINT UNSIGNED;
  DECLARE l TINYINT UNSIGNED DEFAULT length(n);
  DECLARE i TINYINT UNSIGNED DEFAULT l;
  DECLARE s SMALLINT UNSIGNED DEFAULT 0;
  WHILE i > 0 DO
    SET x = mid(n,i,1);
    IF (l-i) mod 2 = 1 THEN
      SET x = x * 2;
    END IF;
    SET s = s + x div 10 + x mod 10;
    SET i = i - 1;
  END WHILE;
  RETURN s != 0 && s mod 10 = 0;
END;

CREATE FUNCTION ccd (n TINYTEXT) RETURNS TINYINT
BEGIN
  DECLARE x TINYINT UNSIGNED;
  DECLARE l TINYINT UNSIGNED DEFAULT length(n);
  DECLARE i TINYINT UNSIGNED DEFAULT l;
  DECLARE s SMALLINT UNSIGNED DEFAULT 0;
  WHILE i > 0 DO
    SET x = mid(n,i,1);
    IF (l-i) mod 2 = 0 THEN
      SET x = x * 2;
    END IF;
    SET s = s + x div 10 + x mod 10;
    SET i = i - 1;
  END WHILE;
  RETURN ceil(s/10)*10-s;
END; 
```

然后可以在 SQL 查询中直接使用函数：

```
mysql> SELECT ccc(1234567890123452);
+-----------------------+
| ccc(1234567890123452) |
+-----------------------+
|                     1 |
+-----------------------+
1 row in set (0.00 sec)

mysql> SELECT ccc(1234567890123451);
+-----------------------+
| ccc(1234567890123451) |
+-----------------------+
|                     0 |
+-----------------------+
1 row in set (0.00 sec)

mysql> SELECT ccd(123456789012345);
+----------------------+
| ccd(123456789012345) |
+----------------------+
|                    2 |
+----------------------+
1 row in set (0.00 sec)

mysql> SELECT ccd(234567890123451);
+----------------------+
| ccd(234567890123451) |
+----------------------+
|                    1 |
+----------------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-06T15:23:31.783

这只是为了确保使用一些基本的 RegEX 模式的数字是有效的。

请注意，这不会检查号码是否被某人使用。

[http://www.roscripts.com/How_to_validate_credit_card_numbers-106.html](http://www.roscripts.com/How_to_validate_credit_card_numbers-106.html)

# vb6 - 如何集成 VSS 6 以便 VB 6 在编辑时自动检出？

> ID：174733
> 
> 赞同：2
> 
> 时间：2008-10-06T15:22:53.750
> 
> 标签：vb6, visual-sourcesafe

我正在使用 Visual Studio 6.0 和 Visual Basic 6.0。

我已经集成了它们，但是当我签出一个项目然后尝试编辑该项目中的一个模块时，它被锁定，我必须手动右键单击它并执行签出以解锁它。

我认为有一种方法可以让 VSS 自动签出文件进行编辑。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T19:38:37.730

我同意克里斯的观点。现在我知道一群人说你的“软件很臭”并没有真正回答你的问题。但是签出风格的源代码控制和像 Source safe 这样的文件锁定系统之间存在天壤之别。普遍的共识是 Checkout 系统要优越得多。

通过签出，您所做的就是从存储库中签出项目。所有文件都是可编辑的。你像往常一样处理你的项目。然后在您签入之前进行另一次更新。如果您团队中的任何其他人进行了更新，该软件将自动将更改合并到您的代码中。您将有机会查看合并并解决任何冲突。更新后，您可以签入其他人可以检索的更改。

最可怕的部分是合并部分。当 CVS 和 subversion 只是命令行工具时，它有点吓人，因为检索合并时发生的事情很痛苦。但是对于今天的工具，比如 Tortoise，都是可视化的。在过去的几年里，我想不出任何自动合并失败的例子。任何冲突（基本上是两个人编辑同一行代码）都会显示在这里供您解决。

[颠覆](http://subversion.tigris.org/)

[乌龟SVN](http://tortoisesvn.tigris.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-03T18:46:18.703

SourceSafe 中的“本地文件”选项卡下有一个选项标记为“对未签出的文件使用只读标志”。默认情况下选择此选项，但如果取消选择它，您将能够编辑项目中的任何文件而无需将其签出。

取消选中该选项后，您可以获得最新版本的项目以从所有文件中删除只读标志。

当您签出文件时，系统会警告您在工作文件夹中有该文件的可写副本，此时您可以将其替换为 SourceSafe 数据库中的版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T15:34:52.293

我从来没有想出办法做到这一点。这总是一个巨大的痛苦。很抱歉发布了否定的答案，但我想您可能想知道您并不是唯一一个讨厌这个的人，但没有一个直接和明显的答案。我会和你一起关注这个问题，以防有人知道解决方案......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T17:30:55.180

我认为不可能做到这一点（至少八年前我们使用 VSS 时不是这样），但是当您正在经历检查式源代码控制的痛苦时，运行 - 不要走路，一些真实的、非锁定风格的源代码控制解决方案。SVN、CVS、Git、Mecruial，任何不锁定文件并且不会将您的源代码留在专有文件系统中的东西。我们在八年前切换到 CVS，因为由于 VSS 故障，我们丢失了所有源历史记录（代码已检出，因此可以检索）。我们做过的最好的事情是让协作变得容易十倍。现在 CVS 不是最好的解决方案（它是当时 Windows 最合理的解决方案），但任何东西都比 VSS 好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T15:10:07.613

我找到的最佳解决方案是检查所有文件。花了一点时间来弄清楚如何做到这一点。方法如下： [如何从 VSS 中检出所有 VB6 项目文件？](https://stackoverflow.com/questions/176822/how-to-check-out-all-vb6-project-files-from-vss#176824)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T15:24:18.087

> 当我签出项目然后尝试编辑该项目中的模块时，它被锁定，我必须手动右键单击它并执行签出以解锁它

不管你喜不喜欢，它的设计都是这样工作的，即你可以检查所有的文件，但你必须明确地选择这样做，而不是成为默认选项。我猜这是因为检查所有模块（类模块、表单、用户控件等）会锁定整个项目中的所有其他用户，这在团队协作环境中通常是不可取的。

# c# - 单击 ListView 列标题时将文本添加到剪贴板 - C#

> ID：174745
> 
> 赞同：1
> 
> 时间：2008-10-06T15:24:50.940
> 
> 标签：c#, listview, clipboard

当单击列标题之一时，是否存在激活 ListViews 的事件？计划是在用户单击列标题时将一些文本添加到用户的剪贴板。有什么简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T15:31:43.250

有关列标题单击事件，请参见下面的链接，您可以在其中向用户的剪贴板添加一些文本。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.columnclick.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.columnclick.aspx)

# hibernate - 带有鉴别器的休眠映射

> ID：174748
> 
> 赞同：8
> 
> 时间：2008-10-06T15:25:13.497
> 
> 标签：hibernate

我有一个表，其中一个字段可以根据描述符值（Project、TimeKeep 或 CostCenter）指向其他 3 个表之一中的外键。通常这是用子类实现的，我想知道我有什么下面将起作用。 **注意子类名称与父类相同，并且 noteObject 属性映射到 java.lang.Object 类型的实例变量，**因此只要我们转换为，它应该接受 Project、TimeKeep 或 CostCenter 对象正确的类型。hibernate 会允许这样做吗？谢谢。

```
<hibernate-mapping package="com.tlr.finance.mappings">

 <class name="AdminNotes" table="admin_notes">
    <id name="adminNoteId" column="admin_note_id" type="integer">
      <generator class="identity" />
    </id>

<discriminator column="note_type" type="string" />

<!-- make this property an enumerated type.  It is the discriminator -->
<property name="adminNoteType" column="note_type" type="string" not-null="true" />
<property name="adminNote" column="note" type="string" not-null="true" />
<property name="adminNoteAdded" column="note_date" type="timestamp"
  not-null="true" /> 

<subclass name="AdminNotes" discriminator-value="project" >
  <many-to-one name="noteObject" column="object_id" class="PsData" /><!-- Project -->
</subclass>

<subclass name="AdminNotes" discriminator-value="user" >
  <!-- rename timekeep to user -->
  <many-to-one name="noteObject" column="object_id" class="Timekeep" /><!-- user -->
</subclass>

<subclass name="AdminNotes" discriminator-value="costCenter" >
  <!-- rename timekeep to user -->
  <many-to-one name="noteObject" column="object_id" class="CostCenter" /><!-- cost center -->
</subclass>

  </class>

</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T16:28:31.997

鉴别器用于将类层次结构存储在单个表中。你所拥有的是一个具有多种含义的类。

[http://docs.jboss.org/hibernate/core/3.5/reference/en-US/html/mapping.html#mapping-declaration-discriminator](http://docs.jboss.org/hibernate/core/3.5/reference/en-US/html/mapping.html#mapping-declaration-discriminator)

> 使用 table-per-class-hierarchy 映射策略的多态持久性需要该元素，并声明表的鉴别器列。鉴别器列包含标记值，这些值告诉持久层为特定行实例化哪个子类。

我认为您不能对每个不同的含义使用单个 AdminNote 类。鉴别器在数据库级别用于帮助区分一个子类和另一个子类——它实际上不是 java 对象模型的一部分。

您需要定义多个 AdminNote 子类，每个子类对应一个鉴别器值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-07T12:23:31.527

### 鉴别器为整数

通常，如果在子类中将鉴别器值指定为整数，则会出现错误

> 无法使用 (...) 将鉴别器值 'TYPE' 格式化为 SQL 字符串

如果您希望将鉴别器用作整数值，您首先需要通过在类元素中设置鉴别器值属性将基类指定为整数：

```
<class name="AdminNotes" table="admin_notes" abstract="true" discriminator-value= "-1"> 
```

这将替换在未找到值时鉴别器是类名的默认行为。

```
<hibernate-mapping package="com.tlr.finance.mappings">

    <class name="AdminNotes" table="admin_notes" abstract="true" discriminator-value= "-1">
        <id name="adminNoteId" column="admin_note_id" type="integer">
            <generator class="identity" />
        </id>
        <discriminator column="note_type" type="integer" />

        <!-- Make this property an enumerated type. It is the discriminator. -->
        <property name="adminNoteType" column="note_type" type="string" not-null="true" />
        <property name="adminNote" column="note" type="string" not-null="true" />
        <property name="adminNoteAdded" column="note_date" type="timestamp"
                  not-null="true" />

        <subclass name="AdminNotes" discriminator-value="0" entity-name="project">
            <many-to-one name="noteObject" column="object_id" class="PsData" /><!-- Project -->
        </subclass>

        <subclass name="AdminNotes" discriminator-value="1" entity-name="user">
            <!-- Rename timekeep to user -->
            <many-to-one name="noteObject" column="object_id" class="Timekeep" /><!-- user -->
        </subclass>

        <subclass name="AdminNotes" discriminator-value="2" entity-name="costCenter">
            <!-- Rename timekeep to user -->
            <many-to-one name="noteObject" column="object_id" class="CostCenter" /><!-- cost center -->
        </subclass>
    </class>
</hibernate-mapping> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-10T12:48:02.390

AFAIK，如果您使用实体名称，则可以将 Java 类名称重用于子类映射。

试试下面的映射。这里的超类映射本身是抽象的。子类使用相同的 Java 类和每个子类的实体名称。您可能需要将实体名称放入超类映射。但是，我个人会为每个子类映射使用单独的 Java 子类，就像实体名称一样，当您需要通过 Session [API](http://en.wikipedia.org/wiki/Application_programming_interface)持久化对象时，您必须提供实体名称，或者在 Tuplizer 中实现实体名称解析（[Hibernate](http://en.wikipedia.org/wiki/Hibernate_%28Java%29) 3.3 .2) 基于 adminNoteType 字段。

```
<hibernate-mapping package="com.tlr.finance.mappings">

    <class name="AdminNotes" table="admin_notes" abstract="true">
        <id name="adminNoteId" column="admin_note_id" type="integer">
          <generator class="identity" />
        </id>

        <discriminator column="note_type" type="string" />

        <!-- Make this property an enumerated type. It is the discriminator. -->
        <property name="adminNoteType" column="note_type" type="string" not-null="true" />
        <property name="adminNote" column="note" type="string" not-null="true" />
        <property name="adminNoteAdded" column="note_date" type="timestamp"
          not-null="true" />

        <subclass name="AdminNotes" discriminator-value="project" entity-name="project">
            <many-to-one name="noteObject" column="object_id" class="PsData" /><!-- Project -->
        </subclass>

        <subclass name="AdminNotes" discriminator-value="user" entity-name="user">
            <!-- rename timekeep to user -->
            <many-to-one name="noteObject" column="object_id" class="Timekeep" /><!-- user -->
        </subclass>

        <subclass name="AdminNotes" discriminator-value="costCenter" entity-name="costCenter">
            <!-- rename timekeep to user -->
            <many-to-one name="noteObject" column="object_id" class="CostCenter" /><!-- cost center -->
        </subclass>
    </class>
</hibernate-mapping> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-28T21:16:23.920

与其尝试使用继承功能来获取对正确类的引用，不如考虑使用`<any/>`映射类型`note_type`来确定`object_id`引用的类型，从而将`noteObject`值设置为正确的对象引用。

有关详细信息`<any/>`，请参阅[NHibernate文档中的“](http://en.wikipedia.org/wiki/NHibernate)[任何类型映射](http://www.nhforge.org/doc/nh/en/#mapping-types-anymapping)”和博客文章*[NHibernate 映射](http://ayende.com/Blog/archive/2009/04/21/nhibernate-mapping-ltanygt.aspx)*。

# java - Netbeans 错误：“无法添加一个或多个标签库”

> ID：174749
> 
> 赞同：2
> 
> 时间：2008-10-06T15:25:14.887
> 
> 标签：java, jsp, netbeans

我正在使用 Netbeans 6.1 和 Tomcat 6.0.1.6。

我对一个正在运行的项目进行了一些非常小的更改，现在我收到以下错误：

com.sun.rave.web.ui.appbase.ApplicationException: org.apache.jasper.JasperException: 无法添加一个或多个标签库。

我所做的唯一更改是对支持 bean 方法，没有新的 UI 组件、jsp 等。

任何方向将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T03:31:56.773

我知道 Netbeans 重新生成/更新了您项目中的 web.xml 或 sun-web.xml 文件。也许有人对 Netbeans 更新这些文件时被覆盖的文件之一进行了一些更改。

为了证明这一点，请还原您的更改并查看错误是否仍然存在。如果是这样，请备份这些文件，进行代码更改，重建或其他任何操作，然后将这些备份的文件复制到 Netbeans 修改后的文件并构建。

# javascript - 检查 DOM 元素是否具有焦点

> ID：174752
> 
> 赞同：12
> 
> 时间：2008-10-06T15:25:49.220
> 
> 标签：javascript, internet-explorer

我有一个灯箱文本框，它使用来自 ASP.NET UpdatePanel 的 AJAX 调用显示。显示灯箱时，我使用灯箱`focus()`中的文本框的方法立即将焦点带到文本框。

在 Firefox 中，文本框毫无问题地获得焦点。在 IE 中，除非我使用，否则文本框不会获得焦点

```
setTimeout(function(){txtBx.focus()}, 500); 
```

我假设在加载 DOM 元素之后稍微稍后触发 focus 方法。

问题是，在该行的正上方，我已经在检查元素是否为空/未定义，因此如果对象到达该行，它应该已经存在，它只是不允许自己立即获得焦点原因。

显然，设置一个计时器来“修复”这个问题并不是解决这个问题的最佳或最优雅的方法。我希望能够执行以下操作：

```
var txtBx = document.getElementById('txtBx');

if (txtPassword != null) {
    txtPassword.focus();
    while (txtPassword.focus === false) {
        txtPassword.focus();
    }
} 
```

有没有办法告诉文本框有焦点所以我可以做上面的事情？

还是我看错了？

**编辑**
为了澄清，我没有在页面加载时调用代码。该脚本**位于**页面顶部，但它位于一个函数内部，该函数在 ASP.NET 的异步回发完成时调用，而不是在页面加载时调用。

因为这是在 Ajax 更新之后显示的，所以应该已经加载了 DOM，所以我假设 jQuery 的`$(document).ready()`事件在这里没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T20:27:05.807

There are several things in IE, that does the trick:

1.  If focusing element has different `z-index` - you can quickly set `z-index` to that of currently focused element (possibly setting `hidden` attribute), set focus, and then set it back to original `z-index`.

2.  Try to `blur()` currently focused element.

3.  If element is 'shimmed' - focus the 'shim' element.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T16:01:43.220

you could try something like this [IE Specific]. (untested)

```
theAjaxCreatedElement.onreadystatechange = function() {
    if ( this.readyState != "complete" ) 
        return;
    this.focus();
}; 
```

Another way might be to change the background color of the element with onfocus, then retrieve it with js check if it is what it should be, if not: refocus the element.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T15:32:45.713

尝试将设置焦点的 javascript 放在页面末尾而不是开头，或者在页面加载事件之后触发。这将有助于确保在设置焦点之前完全加载 DOM。

我为此使用[了 FastInit](http://tetlaw.id.au/view/javascript/fastinit)。 [JQuery](http://jquery.com/) $(document).ready() 也可以。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T18:48:19.657

你可以试试这个：

1.  使用[PageRequestManager的](http://www.asp.net/AJAX/documentation/live/ClientReference/Sys.WebForms/PageRequestManagerClass/default.aspx)[endRequest](http://www.asp.net/AJAX/documentation/live/ClientReference/Sys.WebForms/PageRequestManagerClass/PageRequestManagerEndRequestEvent.aspx)事件。一旦 Ajax 更新完成，该事件就会触发。
2.  在事件处理程序中聚焦文本框

这是一些示例代码：

```
<script type="text/javascript">
    function onRequestEnd()
    {
     var txtBx = $get('txtBx');
     txtBx.focus();
    }  
    Sys.WebForms.PageRequestManager.getInstance().add_endRequest(onRequestEnd);
</script> 
```

要首先关注文本框，您可以使用[pageLoad函数（](http://www.asp.net/AJAX/Documentation/Live/overview/AJAXClientEvents.aspx)[应用程序](http://www.asp.net/AJAX/Documentation/Live/ClientReference/Sys/ApplicationClass/default.aspx)客户端对象的[加载](http://www.asp.net/AJAX/Documentation/Live/ClientReference/Sys/ApplicationClass/SysApplicationLoadEvent.aspx)事件的快捷方式）：

```
<script type="text/javascript">
function pageLoad()
{
    var txtBx = $get('txtBx');
    txtBx.focus();
}
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-25T09:36:13.063

您是否尝试将`autofocus="autofocus"`属性添加到您通过 Ajax 调用的文本框元素？

通常，当我需要某些额外的 JavaScript 功能来在动态内容上运行时，我会简单地将该 JavaScript 添加到被调用的内容中。

该 JavaScript 在添加到 DOM 后也会执行。我认为将 JavaScript 写入您的父文件然后“监听”对 DOM 的更改是没有意义的。就像您提到的那样， setTimeout() 比其他任何东西都更像是一种黑客攻击：)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-20T18:09:24.867

似乎 IE 直到脚本完成运行后才更新 DOM。因此，焦点循环测试将不允许 DOM 更新。使用`setTimeout`可能是唯一可行的解​​决方案。

您的示例`.focus()`是一个众所周知的示例，请参见例如[this answer](https://stackoverflow.com/questions/2600186/focus-doesnt-work-in-ie)。

# .net - TFS 2008 中的自定义页面

> ID：174755
> 
> 赞同：1
> 
> 时间：2008-10-06T15:25:56.913
> 
> 标签：.net, sharepoint, tfs

我们能否扩展团队站点以托管我们自己的页面。即 TFS 是否允许您添加由我们开发的页面/Web 部件。我在谷歌中发现了一些线索，但没有人能正确地详细说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T18:02:31.480

是的 - TFS Sharepoint 站点几乎是一个标准的 WSS 站点。如果您愿意，您实际上可以将 TFS 指向不同的 WSS 或 MOSS 服务器，但请记住，在 TFS2008 中，项目站点都必须像

**http://**wssserver** /sites/**TeamProjectName

祝你好运，

马丁。

# apache-flex - 我需要帮助在 Flex 中设置 FormItem 组件的样式

> ID：174762
> 
> 赞同：0
> 
> 时间：2008-10-06T15:29:49.353
> 
> 标签：apache-flex

我有一个我想设计的表格。特别是我想改变表单项标签的背景颜色。（backgorundColor 属性同时改变标签和输入的背景颜色）

IE

```
 <mx:Form>
    <mx:FormItem label="username:">
        <mx:TextInput />
    </mx:FormItem>
</mx:Form> 

```

我想让带有“用户名：”的标签具有不同的背景颜色，但文本输入仍然是默认背景颜色。

这可能与 FormItem 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T20:38:26.720

formitem 有一个用于显示标签的对象，称为 FormItemLabel，此对象的目的是让您可以设置表单项标签的样式。

在 flex 2 中改变样式你可以尝试：

```
FormItemLabel {

} 
```

但是，我查看了 flex 2 lang ref，似乎您无法更改标签的背景颜色。[单击此处获取语言参考链接](http://livedocs.adobe.com/flex/2/langref/mx/controls/FormItemLabel.html#styleSummary)

如果您使用 flex 3，更改 FormItem 标签的所需方法是通过 formitems labelStyleName

```
FormItem {
  labelStyleName: newStyle;
} 
```

然而，我再一次不相信他们增加了改变标签本身背景颜色的能力。 [单击此处获取语言参考链接](http://livedocs.adobe.com/flex/3/langref/mx/controls/FormItemLabel.html)

如果需要，最好的操作选择是扩展 formitem 类，除非其他人有任何想法。

希望这可以帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-28T14:38:09.077

正如我看到的问题“悬而未决”两年......我需要完全相同的功能 - 标签侧的背景颜色不同。

我正在使用 Flex3。我尝试了表格背景-改变了整个表格。然后尝试了 FormItem - 如果你只有文本输入 - 它确实覆盖了背景，但如果你的按钮很少，它们之间的间隙也是相同的颜色。然后，您需要具有其他背景的额外 HBox。而且标签背景和输入控件之间也没有差距。

我不想重写 FormItem 控件。

似乎我需要使用我的祖先风格：网格而不是表单和 GridItem 而不是 FormItem。然后，您可以为每个单元格设置任何颜色的样式。:o(

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-06T16:35:39.690

尝试使用 flex 样式浏览器来创建您想要的样式：

*   [Flex 3 风格浏览器](http://examples.adobe.com/flex3/consulting/styleexplorer/Flex3StyleExplorer.html)

*   [Flex 2 风格浏览器](http://examples.adobe.com/flex2/consulting/styleexplorer/Flex2StyleExplorer.html)

我在样式资源管理器中使用了 TextArea 并格式化了背景颜色，它给出了以下 css 输出：

```
TextArea {
   backgroundColor: #0000ff;
} 
```

您可以将其更改为以下内容以包含在您的样式表中：

```
.formLabel {
   backgroundColor: #0000ff;
} 
```

然后在 FormItem 标签中：

```
<FormItem label="Label" styleName="formLabel" /> 
```

有关 Flex 样式表的更多信息： [Flex 样式表](http://www.adobe.com/devnet/flex/quickstart/styling_components/)

这些示例将表明您可以在 mxml 样式标记中声明样式，而不是根据需要在外部样式表中声明样式。

# c# - 如何移动 ClickOnce 部署包

> ID：174764
> 
> 赞同：11
> 
> 时间：2008-10-06T15:30:28.243
> 
> 标签：c#, clickonce, manifest

我在网络驱动器上的发布文件夹中有一组 ClickOnce 包，需要将它们全部移动到另一台服务器（我们的 DR 机器）。

复制/粘贴整个目录并在新机器上运行设置后，我收到一条错误消息，指出它找不到旧路径：

> ...MyClickOnceApp.application 的激活导致异常。检测到以下故障消息：
> 
> + 下载文件：//oldMachine/c$/MyClickOnceApp.application 没有成功。
> 
> + 找不到路径“\\oldMachine\c$\MyClickOnceApp.application”的一部分。

一旦我将安装[URL](http://en.wikipedia.org/wiki/Uniform_Resource_Locator)更改为指向我的新机器，我会收到另一个错误：

> 清单 XML 签名无效。
> 
> + 对象的数字签名未经验证。

我尝试使用[MageUI.exe](http://msdn.microsoft.com/en-us/library/xhctdw55.aspx)来修改部署 URL，但它要求提供我没有的证书。

我做错了什么以及如何成功移动已发布的 ClickOnce 包？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-07T10:39:38.143

我找到了一个解决方案：

首先，使用 MageUI，我更改了“部署选项”下的“开始位置”。保存时，它提示我使用我在那里创建的密钥进行签名。然后我运行该`setup.exe`文件，它没有失败。

在检查了哪些文件发生了变化后，我意识到它只是一个文件：应用程序清单文件 ( `myAppName.application`)。文件中唯一更改的是***部署提供程序***和***签名***（这是我在 MageUI 中更改的）。

一旦我意识到这是怎么做的，我就使用了 MageUI 的命令行版本`Mage.exe`，它是 SDK 附带的。

下面是我为在命令行上执行所有这些操作而创建的批处理文件：

> REM 设置环境
> 调用“C:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat”
> 
> REM 更新部署提供程序 URL
> mage -Update %1.application -pu %2
> 
> REM 使用我们的密钥
> 法师签署清单 -Sign %1.application -CertFile C:\AppKey.pfx -Password myPw

我现在可以使用它以快速简便的方式运行我所有已发布的应用程序。我希望这有帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-06T16:53:30.590

无需过多详细说明，这应该可以让您继续前进。

出于安全原因，ClickOnce 清单必须使用证书进行签名。您可以购买代码签名证书或生成测试证书。测试证书的主要缺点是您的应用程序发布者将显示为“未知”而不是您公司的名称。

在 Visual Studio 中，打开项目的属性并转到“签名”选项卡，选择“签署 ClickOnce 清单”和“创建测试证书”。接下来，单击“更多详细信息”以弹出一个对话框，然后单击“安装证书”。这将引导您通过一个向导在您的商店中获取您的测试证书。确保将其放在“个人”商店中。

现在您可以使用 MageUI 来编辑您的清单。任何时候保存它都会提示您签署清单，但您现在应该能够选择刚刚存储的测试证书。始终在编辑/签署部署清单之前编辑/签署应用程序清单。这很令人困惑，因为应用程序清单*不是*扩展名为**.application**的文件。

祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T15:41:07.117

我希望必须执行以下操作：

*   将当前文件夹内容复制到新位置
*   对于每个应用程序：-
    *   将“安装文件夹”更改为新位置
    *   作为新版本发布
    *   将“发布文件夹”更改为新位置
    *   作为新版本发布

从新文件夹运行的新设置应该可以工作，现有的应该更新以查看正确的位置。

所有这些都未经测试，但我很确定这就是我之前所做的......

编辑：

显然，您必须在一定时间内并行运行它们，但由于它是一个内部应用程序，当您最终切换到新位置时最糟糕的情况是您必须通知用户获取“固定”应用程序的新位置

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T15:39:35.497

我相信你确实有证书。您需要一个来创建 ClickOnce 部署。Visual Studio 可能已经为您自动创建了一个自签名的。我对这个过程不太熟悉，希望有更明确答案的人会参与进来。另外，您是否尝试过 MageUI 工具，也许使用 GUI 需要做的事情会更明显。

# svn - SVN 网址格式

> ID：174773
> 
> 赞同：8
> 
> 时间：2008-10-06T15:31:58.023
> 
> 标签：svn

我安装了 TurtoiseSVN 和 ankhSVN。我在我的计算机上创建了一个存储库.. "C:\Documents and Settings\user1\My Documents\Subversion\Repository\"

我正在尝试从我的同事计算机连接到此存储库。这个 URL 应该是什么？

任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-06T15:39:47.710

您将需要在您的计算机上运行 svnserve 守护程序，或运行具有必要模块的 apache 服务器，以允许您的同事访问这个本地存储的存储库。对于像这样的简单案例，我建议使用 svnserve，它应该更易于配置和运行。

网址将是：

```
svn://<your_ip>/<repository_name> 
```

与 apache 和基于本地文件系统的存储库的 http 或文件协议 URL 相反。

阅读此页面以获取有关如何在 Windows 上设置 svnserve 的详细信息：

[http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup-svnserve.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup-svnserve.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T15:37:51.663

```
file:///\\COMPUTERNAME\SharedFolderName\ 
```

我可能没有正确的斜线，但它就像那样疯狂。

哦，他必须创建一个文件夹共享。那将是最简单的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T15:34:55.443

试试 svn://xxx.xxx.xxx.xxx/Repository/

如果您要配置防火墙，则默认端口为 3690。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T15:36:05.270

从我的头顶上...

svn://YOURCOMPUTERNAME/repository/project/trunk

或者

svn://xxx.yyy.zzz.www/repository/project/trunk

如果您在 WindowsXP 上运行，请不要忘记打开防火墙。

# java - Java：是否可以通过 Object(In|Out)putStreams 在阻塞的 SocketChannel 上进行并发读写？

> ID：174774
> 
> 赞同：9
> 
> 时间：2008-10-06T15:31:58.460
> 
> 标签：java, sockets, nio

我在阻塞上创建了一个`ObjectInputSteam`and并试图同时读取和写入。我的代码是这样的：`ObjectOutputStream``SocketChannel`

```
socketChannel = SocketChannel.open(destNode);
objectOutputStream = new ObjectOutputStream(Channels.newOutputStream(socketChannel));
objectInputStream = new ObjectInputStream(Channels.newInputStream(socketChannel));

Thread replyThread = new Thread("SendRunnable-ReplyThread") {
    @Override
    public void run() {
        try {
            byte reply = objectInputStream.readByte();//(A)
            //..process reply
        } catch (Throwable e) {
            logger.warn("Problem reading receive reply.", e);
        }
    }
};
replyThread.start();

objectOutputStream.writeObject(someObject);//(B)
//..more writing 
```

问题是行 (B) 处的写入阻塞，直到行 (A) 处的读取完成（阻塞返回的对象`SelectableChannel#blockingLock()`）。但是应用程序逻辑规定，在所有写入完成之前，读取不会完成，因此我们有一个有效的死锁。

`SocketChannel`javadocs说支持并发读写。

当我尝试常规的 Socket 解决方案时，我没有遇到这样的问题：

```
Socket socket = new Socket();
socket.connect(destNode);
final OutputStream outputStream = socket.getOutputStream();
objectOutputStream = new ObjectOutputStream(outputStream);
objectInputStream = new ObjectInputStream(socket.getInputStream()); 
```

但是，我无法利用`FileChannel#transferTo(...)`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T15:41:00.267

This seems to be a bug in `java.nio.channels.Channels` (thanks to Tom Hawtin; post it as an answer next time). A good description and workaround are described [here](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4774871) (actually a duplicate of the bug Tom listed):

I tested the workaround and it works.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T15:45:30.897

错误报告中的解决方法对我有用。值得注意的是，只有*一个*输入或输出需要被包装以使解决方法起作用 - 因此，如果性能在一个方向上特别重要，那么您可以包装不太重要的一个，并确保另一个将获得所有可用的优化它。

```
public InputStream getInputStream() throws IOException {
    return Channels.newInputStream(new ReadableByteChannel() {
        public int read(ByteBuffer dst) throws IOException {
            return socketChannel.read(dst);
        }
        public void close() throws IOException {
            socketChannel.close();
        }
        public boolean isOpen() {
            return socketChannel.isOpen();
        }
    });
}

public OutputStream getOutputStream() throws IOException {
    return Channels.newOutputStream(socketChannel);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T16:23:53.677

如果您想同时使用 InputStream 和 OutputStream 与 SocketChannel，从查看源代码来看，您似乎需要调用 SocketChannel.socket() 并使用行为略有不同的流。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T18:43:11.070

有趣的错误！你说你不能使用 FileChannel#transferTo。在传递给 FileChannel#transferTo 之前，如何使用 Channesl#newChannel 将非 NIO 套接字的 I/O 流包装到通道中？

# php - 有任何 PHP -> jQuery 库吗？

> ID：174777
> 
> 赞同：2
> 
> 时间：2008-10-06T15:32:42.233
> 
> 标签：php, javascript, jquery

是否为 PHP 开发了任何提供对 jQuery 框架的访问的桥接库？理想情况下，最好有一些相当可扩展的东西，这样使用 PHP 代码创建基于 jQuery 的内容将相当容易和可定制。这样的事情还存在吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T15:36:50.930

1.  [查询](http://ajaxian.com/archives/pquery-php-and-jquery)
2.  [jqpie](http://ajaxian.com/archives/jqpie-jquery-php-interface-extension)
3.  [jQuery-php](http://jquery.hohli.com/)

有一个热身清单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T15:34:06.600

到目前为止，我找到了一个似乎符合描述的。我还没有尝试过，所以如果有人对此或其他有任何反馈或经验，请不要犹豫发布！

[查询](http://ajaxian.com/archives/pquery-php-and-jquery)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T15:34:46.177

[jQPie](http://ajaxian.com/archives/jqpie-jquery-php-interface-extension)可能是您所追求的。

> jQPie 能做什么？
> 
> *   使用 $.getJSON 从 php 轻松请求和处理数据
> *   使用 $.(element).load 将 php 生成的 html 注入到元素中
> *   使用 $.jqpie 直接从您的网页调用 php 函数
> *   从 php 调用 jQuery 以响应 $.jqpie 调用
> *   使用 jqpie_complete 的高级自动完成

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T06:09:13.567

QueryPath ( [http://querypath.org](http://querypath.org) ) 是 jQuery 的 jQuery DOM/XML/HTML 部分的完整实现。QueryPath 有完整的 CSS 3 选择器支持（包括 jQuery 没有的东西，比如 XML 命名空间支持）。它还带有 DB 工具，您可以在其中运行查询并将结果插入到查询对象中。它也有一个模板引擎。像 jQuery 一样，您可以非常轻松地编写自定义扩展。

但它绝对利用了它的服务器端状态。

主项目页面位于[https://fedorahosted.org/querypath](https://fedorahosted.org/querypath)。您可以在那里下载它（并查看许多示例，包括 RSS 和 SVG 操作）。

然后，通过将多种 XML 数据发送到 jQuery，可以轻松地与 jQuery 集成。（您也可以发送 JSON ......从未尝试过。）而且由于服务器端代码和客户端代码看起来相同，因此不需要学习两个完全不同的工具包。

# linq - LINQ - LINQ 通常应该属于哪一层，DAL？

> ID：174780
> 
> 赞同：4
> 
> 时间：2008-10-06T15:33:23.513
> 
> 标签：linq, frameworks, data-access-layer

只是想收集关于 LINQ 应该（以及为什么）属于哪个层的不同想法和观点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T15:52:35.407

LINQ = 语言集成查询。这是查询扩展，允许您查询从数据库到列表/集合再到 XML 的任何内容。查询语言在任何层都很有用。

但是，很多人将 LINQ to SQL 称为“LINQ”。在这种情况下，当您使用 L2S 时，组合 BLL/DAL 是有意义的，这就是您对数据库执行 LINQ 查询的地方。这当然不排除在更高层的新（Linq to objects）查询中针对相同查询的结果进行后续查询......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T15:35:50.560

这取决于你想用 linq 做什么。使用 linq2sql 时，我会推荐 DAL，但 Linq 不仅仅是数据库访问。您可以使用它来操作列表、业务对象的可枚举等等... Linq 本身在您的应用程序中的任何地方都非常有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T15:41:39.783

我将您的 DataContext 派生对象视为您的 DAL 层本身，而 LINQ 只是一个非常灵活的接口。因此，我直接在业务层中使用 LINQ 查询。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T15:45:46.530

两个都。DataContext 是 DAL，在使用设计器时，映射到 SQL 对象（表、视图）的自动生成的部分类可以被视为业务层的一部分。我实现了部分类，这些类实现了一些部分方法，以根据需要执行验证和安全性。一些业务规则不直接映射到 DB 对象，而是通过其他类处理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T15:11:36.237

我认为如果你在做 Linq to Sql，你应该总是在你的 DAL 中做。但是，如果您正在对只是过滤的对象进行 Linq，则可以使用不同的对象进行处理，那就是 BL 层。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T15:35:08.423

我认为 LINQ 应该是非常低级的（DAL），我认为它应该被包装到 BLL 中。

我知道很多人喜欢使用 LINQ to SQL 生成的模型的部分可访问性，但我认为你应该有明确的兴趣分离（看看我在那里做了什么？）。我认为，如果您要拥有业务逻辑，则需要将其与数据访问逻辑完全分离。

我认为让它变得棘手的是您可以在代码中有 using System.Linq 行的任何地方继续链接这些 LINQ 扩展方法。同样，尽管我认为 LINQ 属于定义，并且应该处于尽可能低的级别。当您将 LINQ 的使用包装在 BLL 中时，它还使 TDD/单元测试变得更加容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T15:35:52.510

我在传统的“数据访问层”或“数据访问对象”中使用 linq。这允许代码模块化，在一个地方推广数据代码（而不是在几个不同的地方剪切和粘贴相同的代码），并允许相对容易地开发不同的前端。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T15:40:37.227

这取决于您的应用程序的架构，并且表示模型与数据模型的匹配程度有很大的不同。我同意将业务逻辑操作从 LINQ 创建的数据对象和访问方法中分离出来。我还倾向于将所有数据级操作包装在管理器类中，这样我就可以使数据上下文成为内部类。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T15:40:42.343

我认为 Linq 的重点是它取代了你的 DAL。

与您的旧 DAL 等效的是 DBML 文件后面的所有自动生成的代码 + Linq 不能由您添加的任何额外代码。

# iis - 你最喜欢的 LogParser 脚本是什么？

> ID：174784
> 
> 赞同：4
> 
> 时间：2008-10-06T15:34:23.557
> 
> 标签：iis, logging, scripting, logparser, iis-logs

您最喜欢针对 IIS 日志和事件日志运行的 LogParser 2.2 脚本是什么？

我将一个脚本列表放在一起，以针对我们的生产环境运行，以主动查找问题并在隔离性能问题时提供帮助。

你有你使用的 LogParser 2.2 脚本的特定列表吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T16:51:25.093

我喜欢运行查询来识别请求的热门页面、“花费时间”总和最高的页面以及平均“花费时间”最高的页面。

有了这些，它有助于识别重负载部分，有时会导致可以通过缓存 ETC 改进的区域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T16:36:53.197

我们通常将很多东西拉回 SQL 服务器，然后从那里查询我们想要的东西。我为共享主机工作，我们寻找的一件事是 IIS 日志中的过多脚本错误和记录到事件日志中的 ASP.NET 异常。在有 1200 个站点的共享框上，如果不加以控制，这些可能会使它崩溃，异常和错误总是代价高昂。然后，我们使用这些数据让罪魁祸首知道他们的网站需要修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T16:31:07.553

本身不是脚本，但我喜欢对应用程序事件日志使用 LogParser，并在其中查找前 10 个应用程序错误。

# compact-framework - Compact Framework 的水印文本框

> ID：174796
> 
> 赞同：1
> 
> 时间：2008-10-06T15:35:56.347
> 
> 标签：compact-framework

有谁知道是否有人为紧凑框架制作了带水印的文本框控件？

我已经看过以下内容，但没有看到。

[组件一 手机](http://www.componentone.com/SuperProducts/StudioMobile/)

[掌上电脑控制](http://www.pocketpccontrols.com/)

[Resco 移动表单工具包](http://www.resco.net/developer/mobileformstoolkit/overview.aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T17:06:22.107

Daniel Moth 有一篇关于如何在此处执行此操作的非常好的博客文章：

[带有提示横幅的文本框支持 Windows Mobile](http://www.danielmoth.com/Blog/2006/07/textbox-with-cue-banner-support-for.html)

最重要的是它简单且免费！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T15:55:56.307

我从来没有见过一个。 [这个项目](http://www.codeproject.com/KB/miscctrl/WaterMark.aspx)展示了如何自己做——不确定它是否适用于 CF，但我在示例中没有看到任何明显的非 CF 支持的东西。

# html - 如何将 HTML 转换为 Textile？

> ID：174800
> 
> 赞同：11
> 
> 时间：2008-10-06T15:36:24.927
> 
> 标签：html, textile

我正在抓取一个静态 html 站点并将内容移动到数据库支持的 CMS 中。我想在 CMS 中使用 Textile。

是否有将 HTML 转换为 Textile 的工具，所以我可以抓取现有网站，将 HTML 转换为 Textile，并将该数据插入数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-23T14:55:43.397

我知道这是一个老问题，但前几天我发现自己试图这样做并且没有找到任何有用的东西，直到我找到[Pandoc](http://johnmacfarlane.net/pandoc/)。它也可以转换大量其他标记格式——非常棒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T06:59:14.997

这是一个[转换 html 2 Textile 的 c# lib](http://blog.zunama.com/2008/12/23/html2markup-convert-html-to-textile-in-c)。虽然它是带有添加物的纺织品。不是纯纺织品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-25T02:55:11.400

由于没有javascript实现，我写了一个： [https ://github.com/cmroanirgo/to-textile](https://github.com/cmroanirgo/to-textile)

目前它有点原始，因为它是“to-markdown”等价物的盲端口，但应该可以完成工作。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-03-23T15:13:44.080

试试这个简单的java代码希望它对你有用

```
import java.net.*;
import java.io.*;

class Crawle
{

public static void main(String ar[])throws Exception
{

URL url = new URL("https://www.google.co.in/#q=i+am+happy");
InputStream io =  url.openStream();
BufferedReader br = new BufferedReader(new InputStreamReader(io));
FileOutputStream fio = new FileOutputStream("crawler/file.txt");
PrintWriter pr = new PrintWriter(fio,true);
String data = "";
while((data=br.readLine())!=null)
{
pr.println(data);
System.out.println(data);
}

}
}
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-06T20:03:13.797

这是一个简单的标记替换，没有什么是好的正则表达式无法解决的。

我推荐 Perl、LWP::Simple 和一些正则表达式来完成整个事情（爬取、剥离设计和菜单、转换为纺织品，然后发布到数据库。）

# user-interface - 您使用什么 LogParser UI？

> ID：174803
> 
> 赞同：8
> 
> 时间：2008-10-06T15:37:00.713
> 
> 标签：user-interface, scripting, logparser

我刚开始使用[Log Parser Lizard](http://www.lizardl.com/PageHtml.aspx?lng=2&PageId=18)来检查我的 IIS 和事件日志。

您在 LogParser 2.2 之上使用什么 UI 工具来查看生产中的日志文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-03-18T03:31:30.443

Microsoft Exchange 团队刚刚发布了一个新工具，

[http://blogs.technet.com/b/exchange/archive/2012/03/07/introducing-log-parser-studio.aspx](http://blogs.technet.com/b/exchange/archive/2012/03/07/introducing-log-parser-studio.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-03-21T17:17:49.553

[Log Parser Lizard](http://www.lizard-labs.net/log_parser_lizard.aspx) GUI，当前版本 2.5，及其功能（即使是免费版本）仍然是市场上可用的 MS Logparser 引擎的最佳 GUI，原因有很多：

*   查询组织：将查询组织在多个组中以便快速访问。
*   查询编辑器：语法高亮、智能感知和工具提示、撤消/重做、代码片段和查询常量（类似于 C/C++ 中的宏定义）
*   漂亮的 Office 2010 样式 GUI - 选项卡式结果允许运行和比较多个查询
*   高级网格：Excel 样式的过滤功能以及动态执行平均值、计数、最大值、最小值和求和方程的能力。列排序、行分组、显示数据的不同视图而无需重新运行查询（处理千兆字节日志时可节省大量时间）。还支持 Excel 样式公式和条件格式。
*   用于构建图表并以各种图表类型（折线、饼图、条形、柱形、甜甜圈、面积、2D 和 3D 图表等）显示结果的简单界面
*   打印日志解析器报告 - 从 GUI 更改命令行参数 - 支持多行 (log4net) 和正则表达式（正则表达式）输入格式以及 Т-SQL (OLEDB) 查询，以通过单个工具维护您的 SQL 服务器。还支持 Facebook FQL（如果您作为 Facebook 开发人员使用该工具，则很有用）。
*   内联 Visual Basic .Net 代码（用于提示用户输入）。使用 VB.Net 代码更改查询。例如，此查询将提示用户输入 EventID（来自 Lizard Labs 网站的示例）：

    > select top 100 * from Application where EventID=<% return Microsoft.VisualBasic.Interaction.InputBox("请输入事件ID","事件ID","1053") %>

如果您真的喜欢它，您可以以极低的价格获得附加价值和更多功能，例如将结果导出到 Excel 2007、创建 PDF 报告、将查询保存在集中式 SQL Server 数据库中以便于用户之间进行剪切等......因此我相信您使用 Log Parser Lizard 做出了很好的选择。我相信它是比 Microsoft Log Parser Studio 和 Visual Log Parser 或我使用过的任何其他 logparser GUI 更好的软件。

我希望有一天微软会发布 Logparser 3.0（我们都喜欢 v2.2），支持更多的输入格式（Exchange、Sharepoint 等）并具有更强大的功能，而不是发布 Log Parser Studio GUI（这在之后还不错）除了用户之外，所有用户都必须了解更好的替代方案，例如此处的 Log Parser Lizard）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T15:50:35.897

Sadly when it comes to Log Parser, I do it CLI, not GUI. I have not had great need to do lots of parsing (though I probably should since resource utilization is occasionally a problem) so I've always used the SQL-like syntax of LogParser straight up.

Other app teams at my work use [Log4Net Dashboard](http://www.l4ndash.com/), which apparently parses log4net logs, event viewer, and other stuff in one web based interface. I've not gotten around to checking it out, but other people seem to like it.

For web logs I'm actually starting to look at [awstats](http://awstats.sourceforge.net/) for my parsing needs so I can see my data in a more visual format.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T15:42:55.350

我一直在使用[http://en.serialcoder.net/logiciels/visual-logparser.aspx](http://en.serialcoder.net/logiciels/visual-logparser.aspx)

# svn - 在一个非常大的网站上使用颠覆

> ID：174806
> 
> 赞同：6
> 
> 时间：2008-10-06T15:37:05.330
> 
> 标签：svn

我是一个超级颠覆粉丝，即将接管一个大网站（大约 200MB）我已经将主网站从 500MB 的原始大小缩减了！！

我即将将此站点签入一个新的颠覆存储库。问题是，我的 subversion 存储库是远程托管的，因此另一位同事也可以在该站点上工作。

我担心每次我必须对网站进行更新时都必须签入和签出 200MB。

开发非常活跃，因此会有很多事情不断变化。

假设我检查一切正常，颠覆会确保每次我进行新的结帐时它只下载新的/修改的文件/文件夹，还是每次都等待 200MB 下载？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T15:38:48.073

Unless I'm mistaken after the first check in/out you only handle .diff files so you only have to download/upload the changes (not the whole file just the lines that have been changed as long as the file is ASCII) that exists between the files on the client/server.

The first comit/update will be horrendous though.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T16:29:52.743

要记住的另一件事是，您可以制作已签出文件夹的副本，它们仍然是有效的工作副本：

```
svn checkout http://server/path/to/repos my_working_copy
cp -a my_working_copy another_working_copy
svn status another_working_copy 
```

如果您需要多个工作副本，这可以节省大量时间/带宽。它还使分支和切换更快

```
svn checkout http://server/path/to/trunk my_trunk
cp -a my_trunk my_branch
cd my_branch
svn switch http://server/path/to/branches/stable 
```

正如其他回复中所指出的，您只需下载主干和分支之间的差异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T15:58:44.973

As said before, commit/update transfers diffs only and is quite fast. Checkouts are more time consuming - use svn switch to jump between branches quickly.

Also, the HTTP/WEBDAV transport protocol is not very efficient, especially when dealing with lots of small files (e.g. source code :) ) - you could consider using svnserve instead.

200 MB of data should not be too much trouble for Subversion - but if disk space and efficient data transfer are really a problem you could also look into git or mercurial. Especially git is much more efficient, but you'll probably need a little more time to wrap your head around the concepts of distributed source control, and you have to live without fancy GUI tools for now (also the command line tools have become much more usable lately).

This link might be interesting, too: [Website Auto Update](http://subversion.tigris.org/faq.html#website-auto-update)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T15:59:58.310

I run sites that are totally around 5 GB or more. (and a build system that makes changes to many many files for each build). So, the delta would be around 200MB easily (and to a remote site). SVN handles it perfectly fine. It also depends on how good your apache can hold (if you are using apache).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T15:38:54.483

If lots of changes are being made frequently, why not have a cron entry that does a subversion update to keep your local copy up to date, say every 6 hours?

That way you're getting recent diffs (or none if it hasn't updated in a few hours) rather than the whole shebang.

**EDIT**: for clarification, if lots of changes are happening, but only on a few pages at a time, any given commit/update will be small; if they're being made to all/most of the site, then frequently keeping up to date will be important.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T15:39:10.410

it will only send the changes when you update or comment. You should be fine.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T15:39:54.577

Subversion only gets diffs/updates, so you only have the full checkout the first time you get it. Later updates you'll only get changes.

To assist in merges, it might be good to have two working copies - one pointed to the main codeline, one pointed at your task branch. That way you don't have to switch your working copy from one Subversion codeline to another - that can be expensive, like checking out the code to begin with.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T15:40:04.823

It will only download the files that have been touched between that time. However if you are going to be branching (as you should be) then you might be waiting a long time.

How much of the project is actually needed? I doubt that there is 200mb of source. If a lot of the data is resources that change very infrequently (ie images) then you might think about splitting the repositories into smaller projects.

# linux - 克隆 Debian/Ubuntu 安装

> ID：174839
> 
> 赞同：13
> 
> 时间：2008-10-06T15:44:28.140
> 
> 标签：linux, ubuntu, operating-system, debian, apt

**有没有一种简单的方法可以克隆整个已安装的 debian/ubuntu 系统？**

我希望在已安装的软件包和尽可能多的设置方面进行相同的安装。

我研究了 aptitude、apt-get、synaptic 的选项，但一无所获。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-11-25T21:25:11.000

如何镜像 apt-get 安装。

初级系统

```
dpkg --get-selections > installed-software
scp installed-software $targetsystem:. 
```

目标系统

```
dpkg --set-selections < installed-software
dselect" 
```

完毕。

对此帖子 +1

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-06T15:51:44.740

[本指南应回答您的直接问题](http://www.debianadmin.com/clone-your-ubuntu-installation.html)

但我会推荐[Rsync](http://samba.anu.edu.au/rsync/)并简单地克隆整个 /root。唯一贵的是第一次。

您还可以创建自己的软件包存储库，并让您的所有机器从您的存储库运行它们的每日更新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T16:10:41.317

假设您想在多个相同的系统上安装 Ubuntu，您可以尝试使用[自动安装](https://help.ubuntu.com/7.10/installation-guide/ia64/automatic-install.html)功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T05:46:54.470

您可以为此使用 rsync，并且在 ubuntuforms 上有一个有趣的线程： [ubuntuforms](http://ubuntuforums.org/showthread.php?t=35087)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T15:51:38.420

有 RSYNC 可让您在安装之间同步文件。所以你可以只同步你的整个发行版，或者至少是包含程序和配置文件的目录。

另外，我不知道这是否是您要问的，但是您可以将现有安装转换为 ISO 映像，这将允许您将其安装在其他地方，从而有一个副本。

希望有帮助

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T15:54:36.497

如果驱动器和系统相同，您可以考虑使用 dd 将源计算机复制到目标计算机。

启动新机器时唯一需要进行的更改是更改主机名。

复制机器后，请按照其他答案的建议进行操作，然后查看 rsync。但是，您不会想要对所有内容进行 rsync：系统日志文件等应该不理会。

此外，根据对任一系统进行“更改”的频率（从书签到下载的 ISO），您可能需要在守护程序模式下运行 rsync，并使其几乎不断更新。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T19:31:50.737

[SystemImager](http://wiki.systemimager.org/index.php/HOWTO_Net_Boot_Ubuntu) [FAI](http://www.informatik.uni-koeln.de/fai/)

我们的 systemimager 与 RHEL 和 CentOS 配合得很好。还没在Debian上试过。不过，Luka 链接的技巧在 debian 上效果很好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T19:45:55.657

好吧，这一切都取决于规模，以及您想使用它的频率，使用 systemimager 基本上是 rsync 类固醇，它有一些脚本可以轻松创建图像并允许您进行网络设置等。这可以在您需要的地方轻松使用创建一个网络服务器群或一个邮件服务器群，安装之间只有很小的差异，您可以通过网络启动一个空白系统并完全安装它。这样做的好处是它几乎是完全自动化的，一个脚本会学习你的分区布局并自动应用它。

当您只需要一个系统副本时，请保持简单，从 livecd 启动，创建分区，使用 rsync 通过网络复制，安装引导加载程序，一切都会好起来的。

# c# - WPF 数据绑定和 IValueConverter

> ID：174841
> 
> 赞同：14
> 
> 时间：2008-10-06T15:45:00.400
> 
> 标签：c#, wpf, data-binding, converter

为什么当我在 WPF 中的绑定表达式中使用转换器时，更新数据时值不会更新。

我有一个简单的 Person 数据模型：

```
class Person : INotifyPropertyChanged
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

我的绑定表达式如下所示：

```
<TextBlock Text="{Binding Converter={StaticResource personNameConverter}" /> 
```

我的转换器如下所示：

```
class PersonNameConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        Person p = value as Person;
        return p.FirstName + " " + p.LastName;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

如果我在没有转换器的情况下绑定数据，效果很好：

```
<TextBlock Text="{Binding Path=FirstName}" />
<TextBlock Text="{Binding Path=LastName}" /> 
```

我错过了什么？

编辑：为了澄清一些事情，Joel 和 Alan 对于需要实现的 INotifyPropertyChanged 接口都是正确的。实际上我确实实现了它，但它仍然不起作用。

我不能使用多个 TextBlock 元素，因为我正在尝试将 Window Title 绑定到全名，并且 Window Title 不采用模板。

最后，添加复合属性“FullName”并绑定到它是一个选项，但我仍然想知道为什么当绑定使用转换器时不会发生更新。即使我在转换器代码中放置了一个断点，当对基础数据进行更新时，调试器也不会到达那里:-(

谢谢，乌里

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-07T10:36:26.763

您还可以使用 MultiBinding.. 绑定到 Person 对象，FirstName 和 LastName。这样，只要 FirstName 或 LastName 引发属性更改事件，该值就会立即更新。

```
<MultiBinding Converter="{IMultiValueConverter goes here..}">
    <Binding />
    <Binding Path="FirstName" />
    <Binding Path="LastName" />
</MultiBinding> 
```

或者，如果您只使用 FirstName 和 LastName，则将 Person 对象从绑定中剥离，如下所示：

```
<MultiBinding Converter="{IMultiValueConverter goes here..}">
    <Binding Path="FirstName" />
    <Binding Path="LastName" />
</MultiBinding> 
```

MultiValueConverter 看起来像这样：

```
class PersonNameConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
            return values[0].ToString() + " " + values[1].ToString();
    }

    public object ConvertBack(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
            throw new NotImplementedException();
    }
} 
```

但是，当然，选择的答案也可以，但是 MultiBinding 可以更优雅地工作......

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-06T16:29:48.937

**（见下面的编辑；最新：#2）**

它没有更新，因为您的`Person`对象无法通知任何值`FirstName`或`LastName`已更改的内容。[看到这个问题](https://stackoverflow.com/questions/159088/dependencyproperty-and-databinding)。

这就是你如何实现`INotifyPropertyChanged`. （**更新，见编辑2**）

```
using System.ComponentModel;

class Person : INotifyPropertyChanged {
    public event PropertyChangedEventHandler PropertyChanged;

    string _firstname;
    public string FirstName {
        get {
            return _firstname;
        }
        set {
            _firstname = value;
            onPropertyChanged( "FirstName", "FullName" );
        }
    }

    string _lastname;
    public string LastName {
        get {
            return _lastname;
        }
        set {
            _lastname = value;
            onPropertyChanged( "LastName", "FullName" );
        }
    }

    public string FullName {
        get {
            return _firstname + " " + _lastname;
        }
    }

    void onPropertyChanged( params string[] propertyNames ) {
        PropertyChangedEventHandler handler = PropertyChanged;

        if ( handler != null ) {
            foreach ( var pn in propertyNames ) {
                handler( this, new PropertyChangedEventArgs( pn ) );
            }
        }
    }
} 
```

**编辑 1**

实际上，由于您在更新名字和姓氏之后，`Path=FirstName`并且这样的工作正常，我认为您根本不需要转换器。多个`TextBlocks`同样有效，并且当您本地化为从右到左的语言时实际上可以更好地工作。

**编辑 2**

我已经想通了。没有通知属性已更新，因为它绑定到对象本身，而不是这些属性之一。即使我做`Person`了 a `DependencyObject`and made `FirstName`and `LastName` `DependencyProperties`，它也不会更新。

您*将*不得不使用一个`FullName`属性，我已经更新了`Person`上面类的代码以反映这一点。然后就可以绑定了`Title`。（**注意：**我已将`Person`对象设置为`Window`'s `DataContext`。）

```
Title="{Binding Path=FullName, Mode=OneWay}" 
```

如果您正在编辑 a 中的名称`TextBox`并希望立即更改名称而不是在失去焦点时反映`TextBox`，您可以这样做：

```
<TextBox Name="FirstNameEdit"
    Text="{Binding Path=FirstName, UpdateSourceTrigger=PropertyChanged}" /> 
```

我知道您不想使用`FullName`属性，但是任何可以实现您想要的东西都可能有点像 Rube Goldberg 设备。例如实现类本身`INotifyPropertyChanged`的`Person`属性，监听事件以触发'事件，并使用如下的相对绑定。当然，您还可以在设置属性之前设置属性或在设置属性之后触发它，以便它显示出来。（否则它将在期间并且需要知道它何时是。）`Window``Window``PropertyChanged``Window``PropertyChanged``Person``InitializeComponent()``PropertyChanged``Person``null``InitializeComponent()``Person`

```
<Window.Resources>
    <loc:PersonNameConverter
        x:Key="conv" />
</Window.Resources>
<Window.Title>
    <Binding
        RelativeSource="{RelativeSource Self}"
        Converter="{StaticResource conv}"
        Path="Person"
        Mode="OneWay" />
</Window.Title> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T16:47:02.177

为了更新绑定，您的人员类需要实现 INotifyPropertyChanged 以让绑定知道对象的属性已更新。您还可以通过提供 fullName 属性来避免额外的转换器。

```
using System.ComponentModel;

namespace INotifyPropertyChangeSample
{
    public class Person : INotifyPropertyChanged
    {
        private string firstName;
        public string FirstName
        {
            get { return firstName; }
            set
            {
                if (firstName != value)
                {
                    firstName = value;
                    OnPropertyChanged("FirstName");
                    OnPropertyChanged("FullName");
                }
            }
        }

        private string lastName;
        public string LastName
        {
            get { return lastName; }
            set
            {
                if (lastName != value)
                {
                    lastName = value;
                    OnPropertyChanged("LastName");
                    OnPropertyChanged("FullName");
                }
            }
        }

        public string FullName
        {
            get { return firstName + " " + lastName; }
        } 

        #region INotifyPropertyChanged Members

        public event PropertyChangedEventHandler PropertyChanged;

        protected void OnPropertyChanged(string name)
        {
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs(name));
        }

        #endregion
    }
} 
```

您的绑定现在将如下所示：

```
<TextBlock Text="{Binding Person.FullName}" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T06:20:52.503

我还没有检查，但你也可以尝试以下

```
<TextBlock Text="{Binding Path=/, Converter={StaticResource personNameConverter}}" /> 
```

# visual-studio-2008 - 语法高亮VS插件

> ID：174847
> 
> 赞同：1
> 
> 时间：2008-10-06T15:46:45.637
> 
> 标签：visual-studio-2008, syntax-highlighting, visual-studio-addins

有哪些工具可以与该产品竞争？

[代码假名](http://www.codekana.com/)

我知道 ReSharper 改进了语法高亮。能和这个比吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T15:50:58.297

[CodeRush](http://www.devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/)和 ReSharper都提供方式模式，而不仅仅是语法高亮，但如果这是您正在寻找的，那就去吧，它们都是出色的工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T15:52:32.600

[VisualAssistX 也在](http://www.wholetomato.com/)竞争。支持VC6+，也支持C#和VB.NET。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T15:49:23.450

Resharper 不仅提供语法高亮显示，它还是 Visual Studio 的最佳重构工具。时期。

它还具有在 IDE 中运行单元测试的内置功能。

总体来说只是一个很棒的工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T16:31:33.147

当然，如果您使用 C++，Resharper 也无济于事。

# c# - ASP.NET Routing with Web Forms

> ID：174849
> 
> 赞同：16
> 
> 时间：2008-10-06T15:47:01.393
> 
> 标签：c#, asp.net, url, url-routing

I've read [ASP.NET Routing… Goodbye URL rewriting?](http://chriscavanagh.wordpress.com/2008/03/11/aspnet-routing-goodbye-url-rewriting/) and [Using Routing With WebForms](http://haacked.com/archive/2008/03/11/using-routing-with-webforms.aspx) which are great articles, but limited to simple, illustrative, "hello world"-complexity examples.

Is anyone out there using ASP.NET routing with web forms in a non-trivial way? Any gotchas to be aware of? Performance issues? Further recommended reading I should look at before ploughing into an implementation of my own?

**EDIT** Found these additional useful URLs:

*   [How to: Use Routing with Web Forms (MSDN)](http://msdn.microsoft.com/en-us/library/cc668202.aspx)
*   [ASP.NET Routing (MSDN)](http://msdn.microsoft.com/en-us/library/cc668201.aspx)
*   [How to: Construct a URL from a Route(MSDN)](http://msdn.microsoft.com/en-us/library/cc668176.aspx)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-11-21T16:22:19.053

如何在 ASP.NET 中使用路由的简单示例

1.  创建空 Web 应用程序
2.  添加第一个表单 - Default.aspx
3.  添加第二种形式 - Second.aspx
4.  添加第三种形式 - Third.aspx
5.  添加到 default.aspx 3 个按钮 -

    ```
    protected void Button1_Click(object sender, EventArgs e)
    {
        Response.Redirect("Second.aspx");
    }

    protected void Button2_Click(object sender, EventArgs e)
    {
        Response.Redirect("Third.aspx?Name=Pants");
    }

    protected void Button3_Click(object sender, EventArgs e)
    {
        Response.Redirect("Third.aspx?Name=Shoes");
    } 
    ```

6.  在第三页读取查询字符串

    ```
    protected void Page_Load(object sender, EventArgs e)
    {
        Response.Write(Request.QueryString["Name"]);
    } 
    ```

现在，如果您运行该程序，您将能够导航到第二种和第三种形式。这就是过去的样子。让我们添加路由。

7.  使用 System.Web.Routing 添加新项目 - Global.aspx；

    ```
    protected void Application_Start(object sender, EventArgs e)
    {
        RegisterRoutes(RouteTable.Routes);
    }
    void RegisterRoutes(RouteCollection routes)
    {
        routes.MapPageRoute(
            "HomeRoute",
            "Home",
            "~/Default.aspx"
        );
        routes.MapPageRoute(
            "SecondRoute",
            "Second",
            "~/Second.aspx"
        );
        routes.MapPageRoute(
            "ThirdRoute",
            "Third/{Name}",
            "~/Third.aspx"
        );
    } 
    ```

8.  在 default.aspx 中修改 protected void Button1_Click(object sender, EventArgs e) { // Response.Redirect("Second.aspx"); Response.Redirect(GetRouteUrl("SecondRoute", null)); }

    ```
    protected void Button2_Click(object sender, EventArgs e)
    {
        //Response.Redirect("Third.aspx?Name=Pants");
       Response.Redirect(GetRouteUrl("ThirdRoute", new {Name = "Pants"}));
    }

    protected void Button3_Click(object sender, EventArgs e)
    {
       // Response.Redirect("Third.aspx?Name=Shoes");
        Response.Redirect(GetRouteUrl("ThirdRoute", new { Name = "Shoes" }));
    } 
    ```

9.  在third.aspx中修改页面加载

    ```
    protected void Page_Load(object sender, EventArgs e)
    {
        //Response.Write(Request.QueryString["Name"]);
        Response.Write(RouteData.Values["Name"]);
    } 
    ```

运行程序，请注意 url 看起来更干净 - 里面没有文件扩展名（Second.aspx 变成了 Second）

10.  传递不止一个参数

    *   使用以下代码向 default.aspx 添加新按钮：

        ```
        protected void Button4_Click(object sender, EventArgs e)
        {
            Response.Redirect(GetRouteUrl("FourthRoute", new { Name = "Shoes" , Gender = "Male"}));
        } 
        ```

    *   将以下代码添加到 global.asax

        ```
         routes.MapPageRoute(
              "FourthRoute",
              "Fourth/{Name}-{Gender}",
              "~/Fourth.aspx"
          ); 
        ```

    *   使用以下页面加载创建 Fourth.aspx 页面：

        ```
        protected void Page_Load(object sender, EventArgs e)
        {
        Response.Write("Name is: " + RouteData.Values["Name"] + " and Gender is " + RouteData.Values["Gender"]);
        } 
        ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T15:51:27.780

Not sure if this is your answer but this may get you in the right direction it's Scott Hanselman (MSFT) showing how to get ASP.NET WebForms, ASP.NET MVC and ASP.NET Dynamic Data -- oh and AJAX to work together in harmony.

[http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-03-26T15:40:28.277

.net 4.0 和 ASP.net 路由的两个非常有用的链接

*   [演练：在 Web 窗体应用程序中使用 ASP.NET 路由](http://msdn.microsoft.com/en-us/library/dd329551.aspx)

*   [ASP.net 路由](http://msdn.microsoft.com/en-us/library/cc668201.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T09:40:14.083

I saw this podcast linked to from ScottGu's blog the other day which might be useful to you

[http://morewally.com/cs/blogs/wallym/archive/2008/10/08/asp-net-podcast-show-125-routing-with-webforms.aspx](http://morewally.com/cs/blogs/wallym/archive/2008/10/08/asp-net-podcast-show-125-routing-with-webforms.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T11:02:49.763

Mike Ormond 的使用 ASP.NET 设置 URL 路由的分步指南非常好（[Getting ASP.NET Routing Up and Running - The Definitive Guide](http://blogs.msdn.com/mikeormond/archive/2008/11/06/getting-asp-net-routing-up-and-running-the-definitive-guide.aspx)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-07T12:34:43.083

您可以在以下文章中找到以简单方式解释的 URL 路由。它提供诸如在路由上发送请求、在目标页面上检索 URL 参数、设置参数的默认值等信息。

[ASP.Net Web 表单中的 URL 路由第 1 部分](http://karmic-development.blogspot.in/2013/10/url-routing-in-aspnet-web-forms-part-1.html)

[ASP.Net Web 表单中的 URL 路由第 2 部分](http://karmic-development.blogspot.in/2013/10/url-routing-in-aspnet-web-forms-part-2.html)

# python - 通过 fork() 运行多个子进程的最佳方法是什么？

> ID：174853
> 
> 赞同：10
> 
> 时间：2008-10-06T15:47:59.333
> 
> 标签：python, linux

python 脚本需要通过 fork() 生成多个子进程。所有这些子进程都应该同时运行，父进程应该等待所有子进程完成。能够为“慢”孩子设置一些超时会很好。收集所有孩子后，父进程继续处理脚本的其余部分。

解决它的最佳方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-06T16:26:25.433

简单的例子：

```
import os
chidren = []
for job in jobs:
    child = os.fork()
    if child:
        children.append(child)
    else:
        pass  # really should exec the job
for child in children:
    os.waitpid(child, 0) 
```

让一个缓慢的孩子超时需要更多的工作。您可以使用`wait`instead of `waitpid`，并从子列表中剔除返回的值，而不是依次等待每个值（如此处）。如果您设置了`alarm`一个`SIGALRM`处理程序，您可以在指定的延迟后终止等待。这都是标准的 UNIX 东西，不是特定于 Python 的......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-07T04:31:40.993

*Ephemient*：代码中的每个孩子在他的工作结束后都将留在 for 循环中。他会一次又一次地分叉。此外，当 children[] 不为空时开始的孩子将尝试在循环结束时等待他们的一些兄弟。最终会有人崩溃。这是一种解决方法：

```
import os, time

def doTheJob(job):
    for i in xrange(10):
        print job, i
        time.sleep(0.01*ord(os.urandom(1)))
        # random.random() would be the same for each process

jobs = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J"]
imTheFather = True
children = []

for job in jobs:
    child = os.fork()
    if child:
        children.append(child)
    else:
        imTheFather = False
        doTheJob(job)
        break

# in the meanwhile 
# ps aux|grep python|grep -v grep|wc -l == 11 == 10 children + the father

if imTheFather:
    for child in children:
        os.waitpid(child, 0) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T16:16:41.397

你看过[pyprocessing](http://pyprocessing.berlios.de/)模块吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T16:17:28.417

与子进程通信的传统 UNIX-y 方式是打开通往其标准输入/输出的管道，并使用`select()`系统调用多路复用父进程中的通信（在 Python 中可通过...`select`模块获得）。

如果您需要杀死一个运行缓慢的子进程，您可以保存它的进程 ID（由`os.fork()`调用返回），然后`os.kill()`在不再需要时使用它来杀死它。当然，能够显式地与子进程通信并*告诉它*自己关闭可能会更干净。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-19T16:23:04.847

我已经用 perl 做过一两次了。学习python并想复制该功能。未知数量的分叉任务的调度程序必须跟踪正在运行的任务、已结束的任务和返回码。此代码包括 SIGCHLD 处理程序、父任务和简单子任务的代码。

```
#!/usr/bin/env python3
import signal, traceback
import os, subprocess
import time
#
#   sigchild handler for reaping dead children
#
def handler(signum, frame):
#
#   report stat of child tasks  
    print(children)
#
#   use waitpid to collect the dead task pid and status
    pid, stat = os.waitpid(-1, 0)
    term=(pid,stat)
    print('Reaped: pid=%d stat=%d\n' % term)
#
#   add pid and return code to dead kids list for post processing
    ripkids.append(term)
    print(ripkids)
    print('\n')
#
#   update children to remove pid just reaped
    index = children.index(pid)
    children.pop(index)
    print(children)   
    print('\n')

# Set the signal handler 
signal.signal(signal.SIGCHLD, handler)

def child():
   print('\nA new child ',  os.getpid())
   print('\n')
   time.sleep(15)
   os._exit(0)  

def parent():
#
# lists for started and dead children
   global children
   children = []
   global ripkids
   ripkids = []

   while True:
      newpid = os.fork()
      if newpid == 0:
         child()
      else:
         pidx = (os.getpid(), newpid)
         children = children+[newpid]
         print("parent: %d, child: %d\n" % pidx)
         print(children)
         print('\n')
      reply = input("q for quit / c for new fork")
      if reply == 'c': 
          continue
      else:
          break

parent() 
```

# css - 只需几个步骤即可从 Web 打印

> ID：174856
> 
> 赞同：2
> 
> 时间：2008-10-06T15:49:08.817
> 
> 标签：css, jakarta-ee, printing

我需要向我的基于 J2EE 的 wep 应用程序添加功能： 1) 获取一些页面，可能带有表单控件，将其转换为某种打印机友好格式。2) 打印此渲染格式 a) 不显示和 b) 不显示打印对话框。

我不太担心1，但不知道2a和2b是否可能。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T15:51:35.580

您可以设置特定的 CSS 打印样式。并且相信您的用户可以有效地使用他们的打印屏幕按钮。:)

这是eric meyer 关于这个主题的[文章](http://meyerweb.com/eric/articles/webrev/200001.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T15:51:17.953

我认为2b将成为真正的症结所在。2a 应该能够通过“媒体”类型使用 CSS 来完成......

[http://www.w3.org/TR/CSS2/media.html](http://www.w3.org/TR/CSS2/media.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T15:52:32.867

1.  打印实现您的打印要求的媒体样式表。
2.  浏览器中的打印按钮
3.  可以对默认打印机进行“快速打印”的浏览器功能。

# .net - 如何关闭 VS 2005 中没有 xml 注释的警告

> ID：174863
> 
> 赞同：4
> 
> 时间：2008-10-06T15:50:36.427
> 
> 标签：.net, visual-studio, visual-studio-2005, settings

在某个时间点，我在 Visual Studio 2005 中打开了一个设置，当方法/类没有与之关联的 xml 注释时会产生警告。我想关闭它，但似乎无法再次找到该设置。有谁知道这是哪里？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-06T15:55:41.563

右键单击您的项目并转到属性。

选择左侧的构建选项卡。

在抑制警告下输入... 1591,1592,1573,1571,1570,1572。

虽然我不推荐这样做，因为生成文档的全部意义在于将其记录在案。如果您不喜欢这些警告，您可以在 VS 的错误列表窗格中取消选择警告选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T15:57:07.363

如果您有一个 .NET 项目，则该设置位于项目属性 > 构建选项卡上。在靠近底部的输出部分，有一个标记为“XML 文档文件”的复选框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T15:53:25.657

我知道的唯一方法是关闭 XML 文档生成。这可以在项目属性/编译/生成 XML 文档文件下完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T15:57:28.720

您可以在项目属性中关闭整个项目的文档生成（您需要为每个构建配置执行此操作），您可以在项目属性中禁用整个项目的警告，或者您可以禁用警告使用[“#pragma warning”指令](http://msdn.microsoft.com/en-us/library/441722ys(VS.80).aspx)在单个代码块上。

# .net - 在 MDI Parent 中禁用滚动条

> ID：174869
> 
> 赞同：1
> 
> 时间：2008-10-06T15:51:37.157
> 
> 标签：.net, vb.net

当您将 Mdichild 拖动到 vb.net 中 Mdiparent 的边界之外时，是否可以防止出现滚动条？我希望解决方案不涉及检查子表单的位置，因为要更改的表单太多。

显然 autoscroll 在 mdiparent 上设置为 false 并且将 VScroll 和 HScroll 设置为 false 不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-06T22:30:57.257

我发现了一种可能有效的解决方案：[“我将如何禁用 MDI 父级中的滚动条”](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2491816&SiteID=1)。

但是，我会更改代码，以便仅在移动或调整其中一个子窗口的大小时调用该方法，而不是挂钩到 WndProc，这非常昂贵，并且如第三条注释所述，会导致闪烁。

# unit-testing - Ratio of time spent on coding versus unit testing

> ID：174880
> 
> 赞同：9
> 
> 时间：2008-10-06T15:53:42.440
> 
> 标签：unit-testing, estimation

What is a typical estimate for coding unit tests given an estimate for coding new functionality? Is this different for estimates to maintain code?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T16:02:06.340

我的时间在单元测试时间和功能代码时间之间大致相等。

有些人会认为这是浪费时间，但如果您唯一的选择是运行应用程序并逐步检查应用程序可以采用的所有可能路径，那么单元测试所花费的时间实际上少于您将花费在开发人员测试上的时间。当然，如果您不做太多的开发人员测试，那么您将花时间修复来自 QA 的错误。

无论哪种方式，编写单元测试所花费的时间实际上都节省了我在项目上花费的时间。

当需要维护代码时（微小的更改，功能的少量添加），可能会有所不同。如果正在更改的代码已经完全覆盖并且您的更改不需要更改测试，那么您的时间是 0。否则显然不是，可能再次接近相等。

但是，您在测试时间上节省的时间要大得多；您已经创建了涵盖其余代码的测试，因此您无需任何新代码或运行应用程序即可发现因更改而产生的任何偶然更改。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-06T16:04:04.760

我想说我花了大约 50% 的时间编写单元测试。除了个人经验之外，很难衡量它的收益，但我发现它提供了 3 个主要好处：

*   迫使您更多地考虑您的设计，因此您倾向于编写更好的代码
*   允许您重新考虑/维持数月/数年，而不会害怕您会破坏一切
*   减少了整个项目花费的时间，因为您不会浪费时间寻找单元测试会发现的琐碎错误

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T16:04:46.320

我发现它根据您正在使用的代码而有很大差异 - 当从头开始编写测试驱动的东西时，实现该功能可能需要与没有测试相同的时间，但是您可以在数量上节省更长的时间将发现的错误数量，以及维护和扩展该代码库的难易程度。有人可能会争辩说，在这种情况下使用测试编写会更快，因为您可以避免那些令人头疼的时刻，即代码的行为与预期不符，并且您必须使用调试器来找出正在发生的事情，范围更广比 TDD 通常允许的更改集。

当您尝试在现有的“遗留”代码库（正如 Michael Feathers 定义的遗留代码）之上实现功能时，由于必须进行大量仔细的重构，因此通过测试实现该功能通常比不使用该功能需要更长的时间在编写测试之前完成通常是可能的。在这种情况下，编写单元测试仍然会带来长期利益，但您必须额外考虑这种长期利益是否适合直接成本。

一般来说，我总是会推动某种形式的自动化测试，无论是单元测试还是功能测试，尽管遗留代码库会产生额外成本。没有它，您可能会发现自己的代码库很难维护，需要不断重复的手动测试以确保它继续运行，并且经常出现回归。

# java - How to mock the InitialContext class with jmockit?

> ID：174881
> 
> 赞同：2
> 
> 时间：2008-10-06T15:53:54.593
> 
> 标签：java, jndi, mocking, jmockit

I'm using jmockit with my tests and with one class I wish to test, uses `InitialContext` directly. So I have the following:

```
public class MyClass {
  public void myMethod() {
    InitialContext ic = new InitialContext();
    javax.mail.Session mailSession = ic.lookup("my.mail.session");

    // rest of method follows.....
  } 
```

In my test case, I call this to use my "mocked" `InitialContext` class:

```
Mockit.redefineMethods(InitialContext.class, MockInitialContext.class); 
```

What is the best way to mock the `InitialContext` class with jmockit.

I've already tried a few ways (such as using my own `MockInitialContextFactory`), but keeping stumbling into the same error:

```
NoClassDefFoundError: my.class.MockInitialContext 
```

From what I can see on Google, mocking with JNDI is quite nasty. Please can anyone provide me with some guidance, or point me to a solution? That would be much appreciated. Thank you.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-27T22:47:06.810

我现在距离有人在这里发帖已经一年了，但最近我一直在使用 JMockit 模拟 EJB 调用，我觉得分享是正确的。（即使我没有测试它的代码应该非常相似）

您可以在 TestCase 中将一些 Mocked 对象定义为字段，例如：

```
@Mocked InitialContext mockedInitialContext;
@Mocked javax.mail.Session mockedSession; 
```

然后在您的 testXXX 方法中，您可以定义您的 Expectations()，这样做之后只需调用您想要测试的方法即可。

```
public void testSendindMail(){
     new Expectations(){
        {
    mockedInitialContext.lookup("my.mail.session");returns(mockedSession);    
     }
      };
    MyClass cl = new MyClass ();
    cl.MyMethod();//This need JNDI Lookup
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T17:02:51.710

通常，要模拟 JNDI，您需要使用一个框架，例如 EJBMock，它可以提供一个模拟容器来部署您的 bean。

另一种选择是重构从代码中创建上下文以便传入（这是依赖注入重构），然后您应该能够随意替换模拟。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T20:04:47.377

您收到 NoClassDefFoundError 因为 my.class.MockInitialContext 不存在。如果要将其作为参数传递给 Mockit.redefineMethods()，则需要创建该类。您的 MockInitialContext 类只需要一个名为 lookup() 的方法，该方法接受一个字符串参数并返回一个 javax.mail.Session。

我喜欢[JMockit 注释](https://jmockit.dev.java.net/#annotations)，但您可以查看该页面的其余部分以了解如何使用 JMockit 的其他示例。

# arrays - 如何在VB中连接两个多维数组？

> ID：174885
> 
> 赞同：0
> 
> 时间：2008-10-06T15:55:40.427
> 
> 标签：arrays, ms-access, vba, concatenation

我有这个代码：

```
rs1 = getResults(sSQL1)
rs2 = getResults(sSQL2) 
```

rs1 和 rs2 以及二维数组。第一个索引表示列数（静态），第二个索引表示行数（动态）。

我需要加入这两个数组并将它们存储在 rs3 中。我不知道 rs1 和 rs2 是什么类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T15:58:18.063

你确定这些列会匹配吗？因为如果不是这种情况，我不知道您将如何以任何语言以通用方式进行操作。如果是这种情况，那么您可能可以*非常*简单地这样做：

```
rs1 = getResults(sSQL1 & " UNION " sSQL2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T16:15:20.387

我已经想通了。事实证明我一直都在做正确的事情，我只差一个。您也不需要第三个数组。

```
 aRS_RU = rowsQuery(sSQL & ", 'RU'")
        aRS_KR = rowsQuery(sSQL & ", 'KR'")

        uboundRU1 = UBound(aRS_RU, 1)
        uboundRU2 = UBound(aRS_RU, 2)
        uboundKR2 = Ubound(aRS_KR, 2)

        ' Redim original array
        ReDim Preserve aRS_RU(uboundRU1, uboundRU2 + uboundKR2 + 1 )
        uboundRU2 = UBound(aRS_RU, 2)

        ' Add the values from the second array            
        For m = LBound(aRS_KR, 1) To UBound(aRS_KR, 1)      'Loop for 1st dimension
            For n = LBound(aRS_KR, 2) To UBound(aRS_KR, 2)  'Loop for 2nd dimension
                aRS_RU(m, uboundRU2 + n) = aRS_KR(m,n)
            Next
        Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T19:26:18.090

我知道这篇文章很旧，但我修改了代码以修复我在执行过程中遇到的一些错误。以下代码示例适用于我：

```
Sub ConcatRecordSets(ByRef avFirstRS As Variant, ByRef avSecondRS As Variant)

    Dim lIndex1 As Long, lIndex2 As Long
    Dim lFirstRSSize As Long, lSecondRSSize As Long

    ' Redim original array
    lFirstRSSize = UBound(avFirstRS, 2) - LBound(avFirstRS, 2) + 1
    lSecondRSSize = UBound(avSecondRS, 2) - LBound(avSecondRS, 2) + 1
    ReDim Preserve avFirstRS(LBound(avFirstRS, 1) To UBound(avFirstRS, 1), LBound(avFirstRS, 2) To UBound(avFirstRS, 2) + lSecondRSSize)

    ' Add the values from the second array
    For lIndex1 = LBound(avSecondRS, 1) To UBound(avSecondRS, 1)      ' Loop for 1st dimension
        For lIndex2 = LBound(avSecondRS, 2) To UBound(avSecondRS, 2)  ' Loop for 2nd dimension
            avFirstRS(lIndex1, lFirstRSSize + lIndex2) = avSecondRS(lIndex1, lIndex2)
        Next lIndex2
    Next lIndex1

End Sub 
```

# asp.net - ASP.NET/IIS6：如何搜索服务器的 MIME 地图？

> ID：174888
> 
> 赞同：11
> 
> 时间：2008-10-06T15:55:52.233
> 
> 标签：asp.net, iis, mime, mime-types

我想从代码隐藏文件中找到 IIS ASP.NET Web 服务器上给定文件扩展名的 mime 类型。

我想搜索服务器本身在提供文件时使用的相同列表。这意味着将包括 Web 服务器管理员添加到*Mime Map*的任何 mime 类型。

我可以盲目使用

```
HKEY_CLASSES_ROOT\MIME\Database\Content Type 
```

但这没有记录为 IIS 使用的相同列表，也没有记录*Mime Map*的存储位置。

我可以盲目地调用[FindMimeFromData](http://msdn.microsoft.com/en-us/library/ms775107(VS.85).aspx)，但这没有记录为 IIS 使用的相同列表，我也不能保证 IIS *Mime Map*也会从该调用中返回。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-02-10T22:28:28.390

这是另一个类似的实现，但不需要添加 COM 引用 - 它通过反射检索属性并将它们存储在 NameValueCollection 中以便于查找：

```
using System.Collections.Specialized; //NameValueCollection
using System.DirectoryServices; //DirectoryEntry, PropertyValueCollection
using System.Reflection; //BindingFlags

NameValueCollection map = new NameValueCollection();
using (DirectoryEntry entry = new DirectoryEntry("IIS://localhost/MimeMap"))
{
  PropertyValueCollection properties = entry.Properties["MimeMap"];
  Type t = properties[0].GetType();

  foreach (object property in properties)
  {
    BindingFlags f = BindingFlags.GetProperty;
    string ext = t.InvokeMember("Extension", f, null, property, null) as String;
    string mime = t.InvokeMember("MimeType", f, null, property, null) as String;
    map.Add(ext, mime);
  }
} 
```

您可以非常轻松地缓存该查找表，然后稍后引用它：

```
Response.ContentType = map[ext] ?? "binary/octet-stream"; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-06T16:17:22.940

这是我之前做的一个：

```
public static string GetMimeTypeFromExtension(string extension)
{
    using (DirectoryEntry mimeMap = 
           new DirectoryEntry("IIS://Localhost/MimeMap"))
    {
        PropertyValueCollection propValues = mimeMap.Properties["MimeMap"];

        foreach (object value in propValues)
        {
            IISOle.IISMimeType mimeType = (IISOle.IISMimeType)value;

            if (extension == mimeType.Extension)
            {
                return mimeType.MimeType;
            }
        }

        return null;

    }
} 
```

在 COM 选项卡下添加对`System.DirectoryServices`和对的引用。`Active DS IIS Namespace Provider`扩展名需要有前导点，即`.flv`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T16:14:08.673

IIS 将 MIME 信息存储在它自己的数据库中。在互联网上搜索“MimeMap IIS”将揭示如何阅读甚至更改它。例如，请参阅[C# - 如何从 IIS 实例向控制台显示 MimeMap 条目。](http://blog.crowe.co.nz/archive/2006/06/02/647.aspx)

# python - 如何使用 ElementTree 输出 CDATA

> ID：174890
> 
> 赞同：44
> 
> 时间：2008-10-06T15:56:07.537
> 
> 标签：python, xml

我发现 cElementTree 比 cElementTree 快大约 30 倍`xml.dom.minidom`，我正在重写我的 XML 编码/解码代码。但是，我需要输出包含 CDATA 部分的 XML，而 ElementTree 似乎没有办法做到这一点。

可以做到吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-06T16:41:48.007

经过一番努力，我自己找到了答案。查看 ElementTree.py 源代码，我发现对 XML 注释和预处理指令进行了特殊处理。他们所做的是为特殊元素类型创建一个工厂函数，该函数使用特殊（非字符串）标记值将其与常规元素区分开来。

```
def Comment(text=None):
    element = Element(Comment)
    element.text = text
    return element 
```

然后在`_write`实际输出 XML 的 ElementTree 函数中，对注释进行了特殊情况处理：

```
if tag is Comment:
    file.write("<!-- %s -->" % _escape_cdata(node.text, encoding)) 
```

为了支持 CDATA 部分，我创建了一个名为 的工厂函数`CDATA`，扩展了 ElementTree 类并更改了`_write`函数以处理 CDATA 元素。

如果您想用 CDATA 部分解析 XML，然后用 CDATA 部分再次输出它，这仍然没有帮助，但它至少允许您以编程方式创建带有 CDATA 部分的 XML，这是我需要做的。

该实现似乎适用于 ElementTree 和 cElementTree。

```
import elementtree.ElementTree as etree
#~ import cElementTree as etree

def CDATA(text=None):
    element = etree.Element(CDATA)
    element.text = text
    return element

class ElementTreeCDATA(etree.ElementTree):
    def _write(self, file, node, encoding, namespaces):
        if node.tag is CDATA:
            text = node.text.encode(encoding)
            file.write("\n<![CDATA[%s]]>\n" % text)
        else:
            etree.ElementTree._write(self, file, node, encoding, namespaces)

if __name__ == "__main__":
    import sys

    text = """
    <?xml version='1.0' encoding='utf-8'?>
    <text>
    This is just some sample text.
    </text>
    """

    e = etree.Element("data")
    cdata = CDATA(text)
    e.append(cdata)
    et = ElementTreeCDATA(e)
    et.write(sys.stdout, "utf-8") 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-14T17:43:57.693

[lxml](http://lxml.de/)支持[CDATA](http://lxml.de/api.html#cdata)和 API，如 ElementTree。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-01-18T18:03:56.590

这是适用于 python 3.2 的 gooli 解决方案的变体：

```
import xml.etree.ElementTree as etree

def CDATA(text=None):
    element = etree.Element('![CDATA[')
    element.text = text
    return element

etree._original_serialize_xml = etree._serialize_xml
def _serialize_xml(write, elem, qnames, namespaces):
    if elem.tag == '![CDATA[':
        write("\n<%s%s]]>\n" % (
                elem.tag, elem.text))
        return
    return etree._original_serialize_xml(
        write, elem, qnames, namespaces)
etree._serialize_xml = etree._serialize['xml'] = _serialize_xml

if __name__ == "__main__":
    import sys

    text = """
    <?xml version='1.0' encoding='utf-8'?>
    <text>
    This is just some sample text.
    </text>
    """

    e = etree.Element("data")
    cdata = CDATA(text)
    e.append(cdata)
    et = etree.ElementTree(e)
    et.write(sys.stdout.buffer.raw, "utf-8") 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-05-03T21:27:30.930

**解决方案：**

```
import xml.etree.ElementTree as ElementTree

def CDATA(text=None):
    element = ElementTree.Element('![CDATA[')
    element.text = text
    return element

ElementTree._original_serialize_xml = ElementTree._serialize_xml
def _serialize_xml(write, elem, qnames, namespaces,short_empty_elements, **kwargs):
    if elem.tag == '![CDATA[':
        write("\n<{}{}]]>\n".format(elem.tag, elem.text))
        if elem.tail:
            write(_escape_cdata(elem.tail))
    else:
        return ElementTree._original_serialize_xml(write, elem, qnames, namespaces,short_empty_elements, **kwargs)

ElementTree._serialize_xml = ElementTree._serialize['xml'] = _serialize_xml

if __name__ == "__main__":
    import sys

text = """
<?xml version='1.0' encoding='utf-8'?>
<text>
This is just some sample text.
</text>
"""

e = ElementTree.Element("data")
cdata = CDATA(text)
root.append(cdata) 
```

**背景：**

我不知道以前版本的提议代码是否运行良好以及 ElementTree 模块是否已更新，但我在使用此技巧时遇到了问题：

```
etree._original_serialize_xml = etree._serialize_xml
def _serialize_xml(write, elem, qnames, namespaces):
    if elem.tag == '![CDATA[':
        write("\n<%s%s]]>\n" % (
                elem.tag, elem.text))
        return
    return etree._original_serialize_xml(
        write, elem, qnames, namespaces)
etree._serialize_xml = etree._serialize['xml'] = _serialize_xml 
```

这种方法的问题在于，在传递了这个异常之后，序列化程序再次将其视为普通标签。我得到了类似的东西：

```
<textContent>
<![CDATA[this was the code I wanted to put inside of CDATA]]>
<![CDATA[>this was the code I wanted to put inside of CDATA</![CDATA[>
</textContent> 
```

当然，我们知道这只会导致大量错误。为什么会这样呢？

答案就在这个小家伙身上：

```
return etree._original_serialize_xml(write, elem, qnames, namespaces) 
```

如果我们已经捕获了我们的 CDATA 并成功地通过了它，我们不想通过原始的序列化函数再次检查代码。因此，在“if”块中，只有当 CDATA 不存在时，我们才必须返回原始序列化函数。在返回原始功能之前，我们缺少“else”。

此外，在我的版本 ElementTree 模块中，序列化函数拼命要求“short_empty_element”参数。所以我推荐的最新版本看起来像这样（也带有“tail”）：

```
from xml.etree import ElementTree
from xml import etree

#in order to test it you have to create testing.xml file in the folder with the script
xmlParsedWithET = ElementTree.parse("testing.xml")
root = xmlParsedWithET.getroot()

def CDATA(text=None):
    element = ElementTree.Element('![CDATA[')
    element.text = text
    return element

ElementTree._original_serialize_xml = ElementTree._serialize_xml

def _serialize_xml(write, elem, qnames, namespaces,short_empty_elements, **kwargs):

    if elem.tag == '![CDATA[':
        write("\n<{}{}]]>\n".format(elem.tag, elem.text))
        if elem.tail:
            write(_escape_cdata(elem.tail))
    else:
        return ElementTree._original_serialize_xml(write, elem, qnames, namespaces,short_empty_elements, **kwargs)

ElementTree._serialize_xml = ElementTree._serialize['xml'] = _serialize_xml

text = """
<?xml version='1.0' encoding='utf-8'?>
<text>
This is just some sample text.
</text>
"""
e = ElementTree.Element("data")
cdata = CDATA(text)
root.append(cdata)

#tests
print(root)
print(root.getchildren()[0])
print(root.getchildren()[0].text + "\n\nyay!") 
```

我得到的输出是：

```
<Element 'Database' at 0x10062e228>
<Element '![CDATA[' at 0x1021cc9a8>

<?xml version='1.0' encoding='utf-8'?>
<text>
This is just some sample text.
</text>

yay! 
```

我希望你有同样的结果！

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-06T16:21:58.530

这是不可能的 AFAIK ......这很遗憾。基本上，ElementTree 模块假定阅读器 100% 兼容 XML，因此它们是否将部分输出为 CDATA 或生成等效文本的其他格式并不重要。

有关更多信息，请参阅Python 邮件列表上的[此线程。](https://web.archive.org/web/20141015120050/https://mail.python.org/pipermail/python-list/2005-June/304602.html)基本上，他们推荐使用某种基于 DOM 的 XML 库。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-26T14:28:21.533

实际上这段代码有一个错误，因为你没有捕捉`]]>`到出现在你作为 CDATA 插入的数据中

根据[有没有办法在 xml 中转义 CDATA 结束令牌？](https://stackoverflow.com/questions/223652/is-there-a-way-to-escape-a-cdata-end-token-in-xml)

在这种情况下，您应该将其分成两个 CDATA，将`]]>`两者分开。

基本上`data = data.replace("]]>", "]]]]><![CDATA[>")`
（不一定正确，请核实）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-06-05T15:37:11.197

这最终在 Python 2.7 中为我工作。类似于阿莫里的回答。

```
import xml.etree.ElementTree as ET

ET._original_serialize_xml = ET._serialize_xml

def _serialize_xml(write, elem, encoding, qnames, namespaces):
    if elem.tag == '![CDATA[':
        write("<%s%s]]>%s" % (elem.tag, elem.text, elem.tail))
        return
    return ET._original_serialize_xml(
         write, elem, encoding, qnames, namespaces)
ET._serialize_xml = ET._serialize['xml'] = _serialize_xml 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-10-15T10:38:06.667

您可以覆盖 ElementTree`_escape_cdata`功能：

```
import xml.etree.ElementTree as ET

def _escape_cdata(text, encoding):
    try:
        if "&" in text:
            text = text.replace("&", "&amp;")
        # if "<" in text:
            # text = text.replace("<", "&lt;")
        # if ">" in text:
            # text = text.replace(">", "&gt;")
        return text
    except TypeError:
        raise TypeError(
            "cannot serialize %r (type %s)" % (text, type(text).__name__)
        )

ET._escape_cdata = _escape_cdata 
```

请注意，您可能不需要传递额外的`encoding`参数，具体取决于您的库/python 版本。

现在您可以将 CDATA 写入`obj.text`如下：

```
root = ET.Element('root')
body = ET.SubElement(root, 'body')
body.text = '<![CDATA[perform extra angle brackets escape for this text]]>'
print(ET.tostring(root)) 
```

并清除 CDATA 节点：

```
<root>
    <body>
        <![CDATA[perform extra angle brackets escape for this text]]>
    </body>
</root> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-01-03T01:04:33.330

我发现了一个让 CDATA 使用评论工作的技巧：

```
node.append(etree.Comment(' --><![CDATA[' + data.replace(']]>', ']]]]><![CDATA[>') + ']]><!-- ')) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-04T06:53:24.177

DOM 具有（至少在第 2 级）接口 DATASection 和操作 Document::createCDATASection。它们是扩展接口，仅当实现支持“xml”特性时才支持。

从 xml.dom 导入 minidom

my_xmldoc=minidom.parse(xmlfile)

my_xmldoc.createCDATASection(数据)

现在你有 cadata 节点添加它你想要的任何地方....

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-01-02T06:56:08.993

接受的解决方案不能与**Python 2.7**一起使用。但是，还有另一个名为[lxml](http://lxml.de/)的包（虽然速度稍慢）与`xml.etree.ElementTree`. `lxml`能够写和解析`CDATA`。文档[在这里](http://lxml.de/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-09-10T17:40:44.133

对于 python3 和 ElementTree，您可以使用下一个收据

```
import xml.etree.ElementTree as ET

ET._original_serialize_xml = ET._serialize_xml

def serialize_xml_with_CDATA(write, elem, qnames, namespaces, short_empty_elements, **kwargs):
    if elem.tag == 'CDATA':
        write("<![CDATA[{}]]>".format(elem.text))
        return
    return ET._original_serialize_xml(write, elem, qnames, namespaces, short_empty_elements, **kwargs)

ET._serialize_xml = ET._serialize['xml'] = serialize_xml_with_CDATA

def CDATA(text):
   element =  ET.Element("CDATA")
   element.text = text
   return element

my_xml = ET.Element("my_name")
my_xml.append(CDATA("<p>some text</p>")

tree = ElementTree(my_xml) 
```

如果你需要 xml 作为 str，你可以使用

```
ET.tostring(tree) 
```

或下一个 hack（与里面的代码几乎相同`tostring()`）

```
fake_file = BytesIO()
tree.write(fake_file, encoding="utf-8", xml_declaration=True)
result_xml_text = str(fake_file.getvalue(), encoding="utf-8") 
```

并得到结果

```
<?xml version='1.0' encoding='utf-8'?>
<my_name>
  <![CDATA[<p>some text</p>]]>
</my_name> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-05-03T22:27:49.483

这是我的版本，它基于上面 gooli 和 amaury 的答案。它适用于 ElementTree 1.2.6 和 1.3.0，它们使用非常不同的方法来执行此操作。

请注意，gooli 不适用于 1.3.0，这似乎是 Python 2.7.x 中的当前标准。

另请注意，此版本也不使用 gooli 使用的 CDATA() 方法。

```
import xml.etree.cElementTree as ET

class ElementTreeCDATA(ET.ElementTree):
    """Subclass of ElementTree which handles CDATA blocks reasonably"""

    def _write(self, file, node, encoding, namespaces):
        """This method is for ElementTree <= 1.2.6"""

        if node.tag == '![CDATA[':
            text = node.text.encode(encoding)
            file.write("\n<![CDATA[%s]]>\n" % text)
        else:
            ET.ElementTree._write(self, file, node, encoding, namespaces)

    def _serialize_xml(write, elem, qnames, namespaces):
        """This method is for ElementTree >= 1.3.0"""

        if elem.tag == '![CDATA[':
            write("\n<![CDATA[%s]]>\n" % elem.text)
        else:
            ET._serialize_xml(write, elem, qnames, namespaces) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-12-17T17:39:44.043

我来这里是为了寻找一种“用 CDATA 部分解析 XML，然后用 CDATA 部分再次输出它”的方法。

我能够做到这一点（也许自从这篇文章以来 lxml 已经更新？）具有以下内容：（这有点粗糙 - 抱歉 ;-)。其他人可能有更好的方法以编程方式查找 CDATA 部分，但我太懒了。

```
 parser = etree.XMLParser(encoding='utf-8') # my original xml was utf-8 and that was a lot of the problem
 tree = etree.parse(ppath, parser)

 for cdat in tree.findall('./ProjectXMPMetadata'): # the tag where my CDATA lives
   cdat.text = etree.CDATA(cdat.text)

 # other stuff here

 tree.write(opath, encoding="UTF-8",) 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-06-30T18:40:31.980

# 使用 CDATA 部分制作 .xml 文件的简单方法

主要思想是我们将元素树转换为字符串并在其上调用[unescape](https://docs.python.org/3.8/library/xml.sax.utils.html#xml.sax.saxutils.unescape)。一旦我们有了字符串，我们就使用标准 python 将字符串写入文件。

基于： [如何使用 ElementTree 将未转义的字符串写入 XML 元素？](https://stackoverflow.com/questions/53691955/how-to-write-unescaped-string-to-a-xml-element-with-elementtree)

## 生成 XML 文件的代码

```
import xml.etree.ElementTree as ET
from xml.sax.saxutils import unescape

# defining the tree structure
element1 = ET.Element('test1')
element1.text = '<![CDATA[Wired & Forbidden]]>'

# & and <> are in a weird format
string1 = ET.tostring(element1).decode()
print(string1)

# now they are not weird anymore
# more formally, we unescape '&amp;', '&lt;', and '&gt;' in a string of data
# from https://docs.python.org/3.8/library/xml.sax.utils.html#xml.sax.saxutils.unescape
string1 = unescape(string1)
print(string1)

element2 = ET.Element('test2')
element2.text = '<![CDATA[Wired & Forbidden]]>'
string2 = unescape(ET.tostring(element2).decode())
print(string2)

# make the xml file and open in append mode
with open('foo.xml', 'a') as f:
    f.write(string1 + '\n')
    f.write(string2) 
```

## 输出 foo.xml

```
<test1><![CDATA[Wired & Forbidden]]></test1>
<test2><![CDATA[Wired & Forbidden]]></test2> 
```

# javascript - 在 JavaScript 中处理事件监听

> ID：174891
> 
> 赞同：7
> 
> 时间：2008-10-06T15:56:17.973
> 
> 标签：javascript, firebug, event-listener

经过上周左右的修补和测试，上周我们在大量网站上发布了 Omniture 的分析代码。

在我们几乎所有的网站模板上，它都能正常工作。在一些分散的、不可预测的情况下，会出现*严重的浏览器崩溃体验*，*可能*会拒绝一些用户。

我们目前无法看到崩溃模板之间的关系，虽然有*很多*方法可以解决问题，但让我们感到困惑的是与事件侦听器有关。

单击这些模板上的任何锚点时，站点会崩溃。没有任何内联 JS，并且当我们通过 HTML 的属性触发时，我们找不到会导致这种情况的可辨别的循环或问题。（当我们进行故障排除时，您可以[在此处](http://dv1.gatehousemedia.com/dev/omniture/index.html)亲自体验[**警告**！单击页面中的任何链接将导致您的浏览器崩溃！]）

**你如何确定一个对象是否有监听器？您如何确定触发事件时会触发什么？**

> 仅供参考，我很想设置断点，但是 *在 Omnitures 悲惨地混淆代码和反复浏览器崩溃之间*，我想更彻底地研究如何解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T16:51:05.697

我用 firebug 在那个页面的链接上做了一个“检查元素”，在 DOM 选项卡中它说有一个 onclick 函数（匿名），还有一些其他的函数叫做“s_onclick_0”。

我哄着萤火虫放一块手表

```
alert(document.links[0].onclick) 
```

提醒我omniture（我猜）附加到链接的onclick功能：

```
function anonymous(e) {
  var s = s_c_il[0], b = s.eh(this, "onclick");
  s.lnk = s.co(this);
  s.t();
  s.lnk = 0;
  if (b) {
     return this[b](e);
  }
  return true;
} 
```

也许以同样的方式，您可以在所有这些混淆之后看到它真正运行的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T16:34:31.797

DOM 没有提供任何方法来通过与节点关联的事件侦听器的集合进行内省。

唯一可以识别侦听器的情况是通过在元素上设置属性或属性添加它时 - 检查 onxxx 属性或属性。

最近在 W3 的 WebAPI 小组上有一个关于是否添加此功能的讨论。专家似乎反对这一点。我同意他们的论点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T16:43:12.543

给页面分析实施者的一组建议：

*   仅使用文档级事件捕获，这几乎在所有情况下（除了更改/提交事件）就足够了

*   不要在处理程序中执行计算密集型代码（以及任何 IO 操作），而是通过超时推迟执行

如果考虑到这两个简单的规则，我敢打赌你的浏览器会存活下来

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T17:44:28.257

在回家的路上，我找到了一个解决方案，该解决方案允许对使用 AddEventListener 添加的元素进行事件处理程序的内省。在包含分析代码之前运行代码。如果代码有效，则未验证该代码，但我想这个想法很清楚。它在 IE 中不起作用，但是您也可以在那里应用类似的技术（重写 API 成员）。

```
(function(){
  var fAddEventListener = HTMLElement.prototype.addEventListener;
  HTMLElement.prototype.addEventListener = function() {
   if (!this._listeners)
      this._listeners = [];
   this._listeners.push(arguments);
   fAddEventListener.apply(this, arguments);
  }
})(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T04:29:27.703

我对 Omniture 有一些经验，并查看了您的 s_code.js，您在“链接跟踪”区域中发生了几件事，例如：

```
 /* Link Tracking Config */
s.trackDownloadLinks=true
s.trackExternalLinks=true
s.trackInlineStats=true
s.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx"
s.linkInternalFilters="javascript:,gatehousemedia.com"
s.linkLeaveQueryString=false
s.linkTrackVars="None"
s.linkTrackEvents="None" 
```

我会咨询 Omniture 的人员并验证您的链接跟踪配置是否设置正确。

具体来说，这个模板和里面的链接似乎属于morningsun.net，但morningsun.net 不在s.linkInternalFilters 设置中。如果您对多个域使用相同的 s_code.js 文件，则可以使用 javascript 为此类设置配置值（例如基于 document.location.hostname）。

我个人没有链接跟踪配置的经验，或者我会给你更多关于如何配置它的细节:)

# sql - Oracle中的唯一与不同的关键字

> ID：174912
> 
> 赞同：5
> 
> 时间：2008-10-06T16:02:09.023
> 
> 标签：sql, oracle

我对这些词的用法有点困惑。我有一张桌子，上面有以下列：SITE，LAT，LONG，NAME，......

我想要具有独特（或不同）LAT、LONG 的结果。我如何实现这一目标？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-06T16:11:58.100

```
select unique colA, colB from atable

select distinct colA, colB from atable 
```

在这种情况下，独特和不同意味着同一件事。

然而，ANSI 标准是不同的，而唯一不是。

请注意，在其他领域的索引创建等中使用时，unique 还有许多其他含义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T16:11:06.773

UNIQUE 用于定义可以存储在表中的数据的约束。

DISTINCT 在查询中用于从结果集中删除重复项，而不影响基础表数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T16:17:29.710

我总是喜欢查看每个独特项目的数量，所以我会：

按 lat,long 从表组中选择 lat,long,count(lat) 但这只是我

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T16:07:39.573

AFAIR 两者的意思相同。要从您的表中获得独特的 vel 不同 LAT 和 LONG，只需执行以下操作：

SELECT DISTINCT LAT, LONG FROM 表；

# java - 在 JBoss 4.2.x 上升级到 Quartz 1.6

> ID：174914
> 
> 赞同：0
> 
> 时间：2008-10-06T16:02:16.980
> 
> 标签：java, jboss, upgrade, quartz-scheduler

有没有推荐的方法来升级 JBoss 4.2.x 中的 Quartz？

JBoss 捆绑了quartz 1.5.2，但我遇到了我想避免的问题（ [QUARTZ-399](http://jira.opensymphony.com/browse/QUARTZ-399)、[QUARTZ-520 ）。](http://jira.opensymphony.com/browse/QUARTZ-520)

我不想仅仅为了解决错误而在 JBoss 中修补quartz.jar，而是提供一个新的quartz.jar（加上相关的配置工件）。[Quartz 1.6 迁移说明](http://www.opensymphony.com/quartz/wikidocs/Quartz%201.6.0.html#Quartz1.6.0-MigrationNotes)仅包含特定于 Quartz的信息，在搜索过程中我找不到任何其他信息。

将新的quartz.jar 放到EAR 文件中似乎不起作用，因为旧版本是在服务器级别加载的（在服务器的lib 目录中）。

我很确定有人已经尝试过了，并希望此人可以分享或提供一些链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T16:13:27.863

您可以在 WAR 或 EAR 中包含 Quartz 1.6，而您的应用程序将使用它。但是，只有该 WAR 或 EAR 中的应用程序组件会使用新的 JAR，这可能是一个问题或一个优势，这取决于您如何设置部署。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T10:05:31.800

在尝试遵循 skaffman 的评论后，我找到了一个非常简单的解决方案，它不涉及更改 JBoss 的类加载行为。只需用quartz 1.6 替换quartz.jar`${jboss.server.dir}/lib`就可以了，我还没有遇到任何问题。

重新启动显示以下输出：

```
[QuartzScheduler] Quartz Scheduler v.1.6.0 创建。
[RAMJobStore] RAMJobStore 已初始化。
[StdSchedulerFactory] ​​Quartz 调度程序“QuartzScheduler”从外部提供的属性实例初始化。
[StdSchedulerFactory] ​​Quartz 调度器版本：1.6.0

```

# php - 哪些 PHP / MySQL 驱动程序或数据库抽象层支持准备好的语句？

> ID：174915
> 
> 赞同：0
> 
> 时间：2008-10-06T16:03:19.600
> 
> 标签：php, pdo, prepared-statement, database-abstraction

我正在开发一个基于默认 PDO 和 PDOStatement 类的扩展版本的项目，因此它使用 PDO 样式命名参数而不是“？” 变量的占位符。

但是，客户现在要求我们考虑使用不同的驱动程序，因为他们的 OS X Web Server 版本显然无法轻松安装此驱动程序。那么是否有人知道任何其他数据库抽象库或数据库访问驱动程序，我可以很容易地使用我们当前的一组功能来扩展它们，这些功能像 PDO 一样采用命名参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T16:22:16.970

PDO 和 ADODB 都支持prepared statements，但是API 不是很好。大多数框架都提供了其中一个的抽象。

我正在使用 Zend 框架中的 Zend_Db，我强烈推荐它。它有一个用于组合查询的选择类（当针对数据库适配器进行查询时会变成准备好的语句），一个用于处理 CRUD 操作的表类——我将其用作我的大多数模型的基础等等。

[在这里](http://framework.zend.com/manual/en/zend.db.html)查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T16:07:52.413

我使用过 PEAR::MDB2 以及 PDO。MDB2 的文档有点不稳定，但是一旦您完成了所有工作，它就会成为您的梦想。

[http://pear.php.net/package/MDB2](http://pear.php.net/package/MDB2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T16:13:54.850

我认为[克里奥尔语](http://creole.phpdb.org)提供了所要求的功能......但我没有尝试过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T16:17:06.263

[ADODB](http://adodb.sourceforge.net/)支持[准备好的语句](http://phplens.com/adodb/reference.functions.prepare.html)。

# asp.net - 如何在 ASP.NET WebForms 中指定内容类型？

> ID：174916
> 
> 赞同：9
> 
> 时间：2008-10-06T16:03:34.620
> 
> 标签：asp.net, webforms, content-type, xhtml-1.0-strict

我将我的 doctype 指定为 xhtml strict，但它作为 text/html 的内容类型通过网络发送。我想指定内容类型是 application/xhtml+xm，但我不知道在哪里或者是否可以在我的应用程序中配置它

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-06T16:05:50.857

您可以在@页面属性部分中指定它，如下所示：

```
<%@ Page ContentType="application/xhtml+xm" %> 
```

...更多关于[MSDN](http://msdn.microsoft.com/en-us/library/ydy4x04a(v=vs.100).aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T16:06:16.830

在文件后面的代码中，在 Page_Load 事件期间，尝试添加以下代码：

```
Response.Clear()
Response.ContentType = "application/xhtml+xm" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-03T20:21:02.593

=========aspx================

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs"
Inherits="_Default" %>

<asp:literal runat="server" id="dt"></asp:literal>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server"> 
```

==============后面的代码=========

```
protected void Page_Load(object sender, EventArgs e)
{
this.dt.Text= "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0
Transitional//EN\"
\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">";

} 
```

# .net - 保存 - .NET (C#) 中的操作顺序

> ID：174923
> 
> 赞同：2
> 
> 时间：2008-10-06T16:04:56.630
> 
> 标签：.net, save

我的代码隐藏中有一个 btnSave_Click() 函数。如果用户单击我创建的保存按钮（图像），它会调用此函数：

```
protected void btnSave_Click(object sender, EventArgs e)
{
this.saveForm();
txtMessages.Text = "Save Complete";
} 
```

saveForm() 函数显然保存了表单（通过存储过程）。.NET 会等到保存完成后再显示“保存完成”消息，还是我应该做其他事情让用户知道保存何时完成。

这类事情的最佳教程是什么（即微调器和保存完成时的通知）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T16:07:25.207

这是一种同步方法。它会等到 saveForm() 方法返回（退出）完成后才能继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T16:07:09.013

是的，除非您在“SaveForm”方法中启动辅助线程，否则在整个 saveForm 方法完成之前不会呈现下一行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T16:06:35.333

一旦上一个操作完成，它只会显示“保存完成”。

我通常将这些类型的消息放在状态栏中。但这实际上取决于您的应用程序和 UI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T16:06:47.330

是的。它是自上而下的。

我可以补充一点，如果您的保存表单逻辑可能需要一段时间，最好将其旋转到后台线程中以防止锁定 GUI。这是一些很好的背景阅读。[http://www.yoda.arachsys.com/csharp/threads/](http://www.yoda.arachsys.com/csharp/threads/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T16:07:41.867

除非您特别尝试使其异步，否则您将在 .Net 框架内执行的几乎所有操作都是同步的。

这意味着该步骤将等待返回（并且存储的 proc 调用将等待 SQL 的返回），然后再进行下一步。

# ruby - 如何在不按 Enter 的情况下获取单个字符？

> ID：174933
> 
> 赞同：44
> 
> 时间：2008-10-06T16:06:20.747
> 
> 标签：ruby, getch

如何在不按 Enter 的情况下使用 Ruby 从终端获取单个键盘字符？我试过`Curses::getch`了，但这对我来说真的不起作用。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2014-11-19T16:23:17.430

从 ruby​​ 2.0.0 开始，stdlib 中有一个具有此功能的“io/console”

```
require 'io/console'
STDIN.getch 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-10-06T16:14:35.223

[http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/2999](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/2999)

```
#!/usr/bin/ruby

begin
  system("stty raw -echo")
  str = STDIN.getc
ensure
  system("stty -raw echo")
end
p str.chr 
```

（在我的 OS X 系统上测试，可能无法移植到所有 Ruby 平台）。请参阅[http://www.rubyquiz.com/quiz5.html](http://www.rubyquiz.com/quiz5.html)了解一些其他建议，包括针对 Windows 的建议。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-01-25T17:49:12.170

@Jay 给出了一个很好的答案，但是有两个问题：

1.  你可以搞乱默认的 tty 状态；
2.  您忽略控制字符（^C 表示 SIGINT 等）。

一个简单的解决方法是保存以前的 tty 状态并使用以下参数：

*   `-icanon`- 禁用规范输入（ERASE 和 KILL 处理）；
*   `isig`- 启用对特殊控制字符 INTR、QUIT 和 SUSP 的字符检查。

最后，您将拥有这样的功能：

```
def get_char
  state = `stty -g`
  `stty raw -echo -icanon isig`

  STDIN.getc.chr
ensure
  `stty #{state}`
end 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-11-25T21:13:36.517

不幸的是，原始模式 ( `stty raw -echo`) 导致 control-C 作为字符而不是 SIGINT 发送。因此，如果您想像上面那样阻塞输入，但允许用户在等待时按 control-C 来停止程序，请确保这样做：

```
Signal.trap("INT") do # SIGINT = control-C
  exit
end 
```

如果你想要非阻塞输入——也就是说，定期检查用户是否按下了一个键，但与此同时，去做其他事情——那么你可以这样做：

```
require 'io/wait'

def char_if_pressed
  begin
    system("stty raw -echo") # turn raw input on
    c = nil
    if $stdin.ready?
      c = $stdin.getc
    end
    c.chr if c
  ensure
    system "stty -raw echo" # turn raw input off
  end
end

while true
  c = char_if_pressed
  puts "[#{c}]" if c
  sleep 1
  puts "tick"
end 
```

请注意，非阻塞版本不需要特殊的 SIGINT 处理程序，因为 tty 仅在短时间内处于原始模式。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2010-10-21T01:51:51.917

### 注意：这是旧答案，该解决方案不再适用于大多数系统。

但是对于其他方法不起作用的某些环境，答案仍然可能有用。请阅读下面的评论。

* * *

首先你必须安装highline：

```
gem install highline 
```

然后尝试 highline 方法是否适合您：

```
require "highline/system_extensions"
include HighLine::SystemExtensions

print "Press any key:"
k = get_character
puts k.chr 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-30T21:43:09.570

如果你正在构建**curses**应用程序，你需要调用

```
nocbreak 
```

[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/curses/rdoc/Curses.html#method-c-cbreak](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/curses/rdoc/Curses.html#method-c-cbreak)

# linux - strace应该如何使用？

> ID：174942
> 
> 赞同：291
> 
> 时间：2008-10-06T16:07:41.040
> 
> 标签：linux, debugging, strace

一位同事曾经告诉我，当在 Linux 上调试一切都失败时，最后一个选择是使用[strace](http://man7.org/linux/man-pages/man1/strace.1.html)。

我试图学习这个奇怪工具背后的科学，但我不是系统管理员，我并没有真正得到结果。

所以，

*   它到底是什么，它有什么作用？
*   应该如何以及在哪些情况下使用它？
*   应该如何理解和处理输出？

简而言之，*简单来说*，这些东西是如何工作的？

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2008-10-06T16:16:16.297

**Strace 概述**
strace 可以看作是一个轻量级的调试器。它允许程序员/用户快速了解程序如何与操作系统交互。它通过监视系统调用和信号来做到这一点。

 **当您没有源代码或不想被打扰去真正阅读它时**使用很好。**
此外，如果您不想打开 GDB，但只想了解外部交互，这对您自己的代码很有用。**

 ****一个很好的小介绍**
前几天我遇到了这个关于 strace 使用的介绍：[strace hello world](http://timetobleed.com/hello-world/)

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2008-10-06T16:17:29.273

简而言之，strace 跟踪程序发出的所有系统调用及其返回码。考虑诸如文件/套接字操作之类的事情以及更多晦涩的事情。

如果您对 C 有一定的应用知识，这是最有用的，因为这里的系统调用将更准确地代表标准 C 库调用。

假设您的程序是 /usr/local/bin/cough。只需使用：

```
strace /usr/local/bin/cough <any required argument for cough here> 
```

或者

```
strace -o <out_file> /usr/local/bin/cough <any required argument for cough here> 
```

写入“out_file”。

所有 strace 输出都将转到 stderr（请注意，它的庞大数量通常要求重定向到文件）。在最简单的情况下，您的程序将因错误而中止，您将能够在 strace 输出中看到它与操作系统的最后一次交互在哪里。

更多信息应通过以下方式获得：

```
man strace 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2008-10-06T16:11:42.047

strace 列出了它所应用的进程完成的所有**系统调用。**如果您不知道系统调用的含义，那么您将无法从中获得很多好处。

不过，如果您的问题涉及文件或路径或环境值，则在有问题的程序上运行 strace 并将输出重定向到文件，然后为您的路径/文件/env 字符串 grepping 该文件可能会帮助您查看程序**实际**尝试的内容做，与你所期望的不同。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-10-07T05:04:14.017

Strace 是一种用于调查生产系统的工具，您无法在调试器下运行这些程序。特别是，我们在以下两种情况下使用了 strace：

*   程序 foo 似乎处于死锁状态并且变得没有响应。这可能是 gdb 的目标；但是，我们并不总是拥有源代码，或者有时正在处理不能直接在调试器下运行的脚本语言。在这种情况下，您在已经运行的程序上运行 strace，您将获得正在执行的系统调用列表。如果您正在研究客户端/服务器应用程序或与数据库交互的应用程序，这将特别有用
*   调查程序运行缓慢的原因。特别是我们刚刚迁移到一个新的分布式文件系统，系统的新吞吐量非常慢。您可以使用 '-T' 选项指定 strace，它会告诉您在每个系统调用中花费了多少时间。这有助于确定文件系统导致速度变慢的原因。

有关使用 strace 进行分析的示例，请参阅我对[这个问题](https://stackoverflow.com/questions/186338/why-is-requireonce-so-bad-to-use#194959)的回答。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2015-05-04T15:33:22.080

我一直使用 strace 来调试权限问题。该技术是这样的：

```
$ strace -e trace=open,stat,read,write gnome-calculator 
```

`gnome-calculator`您要运行的命令在哪里。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-08-03T18:21:55.877

Strace 可以用作调试工具，也可以用作原始分析器。

作为调试器，您可以看到给定的系统调用是如何被调用、执行的以及它们返回什么。这非常重要，因为它不仅可以让您看到程序失败，还可以看到程序失败的原因。通常这只是糟糕的编码没有捕捉到程序的所有可能结果的结果。其他时候，它只是硬编码的文件路径。如果没有 strace，您就可以猜测出问题的地方和方式。使用 strace，您可以获得系统调用的细分，通常只需查看返回值即可告诉您很多信息。

剖析是另一种用途。您可以使用它来单独或作为聚合来计时每个系统调用的执行时间。虽然这可能不足以解决您的问题，但它至少会大大缩小潜在嫌疑人的范围。如果您在单个文件上看到很多 fopen/close 对，那么您可能在每次执行循环时都不必要地打开和关闭文件，而不是在循环之外打开和关闭它。

Ltrace 是 strace 的近亲，也非常有用。你必须学会​​区分你的瓶颈在哪里。如果总执行时间是 8 秒，而你只在系统调用上花费了 0.05 秒，那么跟踪程序对你没有多大好处，问题出在你的代码中，这通常是逻辑问题，或者程序实际上需要跑那么久。

strace/ltrace 最大的问题是读取它们的输出。如果您不知道调用是如何进行的，或者至少不知道系统调用/函数的名称，那么就很难理解其含义。了解函数返回的内容也非常有益，尤其是对于不同的错误代码。虽然破译很痛苦，但它们有时真的会返回一颗知识的珍珠；一旦我看到我的 inode 用完了，但没有用完可用空间，因此所有常用的实用程序都没有给我任何警告，我就是无法创建新文件。从 strace 的输出中读取错误代码为我指明了正确的方向。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-06-19T14:44:31.823

strace -tfp PID 将监控 PID 进程的系统调用，因此我们可以调试/监控我们的进程/程序状态。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2019-03-28T12:07:01.997

**最小可运行示例**

如果一个概念不清楚，有一个你没见过的更简单的例子来解释它。

在本例中，该示例是 Linux x86_64 程序集独立式（无 libc）hello world：

你好.S

```
.text
.global _start
_start:
    /* write */
    mov $1, %rax    /* syscall number */
    mov $1, %rdi    /* stdout */
    mov $msg, %rsi  /* buffer */
    mov $len, %rdx  /* buffer len */
    syscall

    /* exit */
    mov $60, %rax   /* exit status */
    mov $0, %rdi    /* syscall number */
    syscall
msg:
    .ascii "hello\n"
len = . - msg 
```

[GitHub 上游](https://github.com/cirosantilli/x86-assembly-cheat/blob/22966270399e7759aae4f1703a26daff9800cd6b/x86-64/gas/linux/hello_world.S).

组装并运行：

```
as -o hello.o hello.S
ld -o hello.out hello.o
./hello.out 
```

输出预期：

```
hello 
```

现在让我们在该示例中使用 strace：

```
env -i ASDF=qwer strace -o strace.log -s999 -v ./hello.out arg0 arg1
cat strace.log 
```

我们用：

*   `env -i ASDF=qwer`控制环境变量：[https ://unix.stackexchange.com/questions/48994/how-to-run-a-program-in-a-clean-environment-in-bash](https://unix.stackexchange.com/questions/48994/how-to-run-a-program-in-a-clean-environment-in-bash)
*   `-s999 -v`在日志中显示更完整的信息

`strace.log`现在包含：

```
execve("./hello.out", ["./hello.out", "arg0", "arg1"], ["ASDF=qwer"]) = 0
write(1, "hello\n", 6)                  = 6
exit(0)                                 = ?
+++ exited with 0 +++ 
```

有了这样一个最小的例子，输出的每一个字符都是不言而喻的：

*   `execve`行：显示如何`strace`执行`hello.out`，包括 CLI 参数和环境，如记录在`man execve`

*   `write`line：显示了我们所做的 write 系统调用。`6`是字符串的长度`"hello\n"`。

    `= 6`是系统调用的返回值，如中所述，它`man 2 write`是写入的字节数。

*   `exit`line: 显示我们所做的退出系统调用。没有返回值，因为程序退出了！

**更复杂的例子**

strace的应用当然是看复杂程序实际做了哪些系统调用来帮助调试/优化你的程序。

值得注意的是，您可能在 Linux 中遇到的大多数系统调用都有 glibc 包装器，[其中许多来自 POSIX](https://stackoverflow.com/questions/1780599/what-is-the-meaning-of-posix/31865755#31865755)。

在内部，glibc 包装器或多或少像这样使用内联汇编：[How to invoke a system call via sysenter in inline assembly?](https://stackoverflow.com/questions/9506353/how-to-invoke-a-system-call-via-sysenter-in-inline-assembly/54956854#54956854)

您应该学习的下一个示例是 POSIX `write`hello world：

主程序

```
#define _XOPEN_SOURCE 700
#include <unistd.h>

int main(void) {
    char *msg = "hello\n";
    write(1, msg, 6);
    return 0;
} 
```

编译并运行：

```
gcc -std=c99 -Wall -Wextra -pedantic -o main.out main.c
./main.out 
```

这一次，您将看到 glibc 之前`main`进行了一系列系统调用，以便为 main 设置一个良好的环境。

这是因为我们现在使用的不是独立程序，而是更常见的 glibc 程序，它允许 libc 功能。

然后，在每一端，`strace.log`包含：

```
write(1, "hello\n", 6)                  = 6
exit_group(0)                           = ?
+++ exited with 0 +++ 
```

因此我们得出结论，`write`POSIX 函数使用了 Linux`write`系统调用，令人惊讶！

我们还观察到`return 0`导致`exit_group`调用而不是`exit`. 哈，我不知道这个！这就是为什么`strace`这么酷。`man exit_group`然后解释：

> 这个系统调用等价于 exit(2)，除了它不仅终止调用线程，而且终止调用进程的线程组中的所有线程。

这是我研究使用哪个系统调用的另一个示例`dlopen`：[https ://unix.stackexchange.com/questions/226524/what-system-call-is-used-to-load-libraries-in-linux/462710#462710](https://unix.stackexchange.com/questions/226524/what-system-call-is-used-to-load-libraries-in-linux/462710#462710)

在 Ubuntu 16.04、GCC 6.4.0、Linux 内核 4.4.0 中测试。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-06T16:22:19.607

Strace 是一个工具，可以告诉您应用程序如何与操作系统交互。

它通过告诉您应用程序使用的操作系统系统调用以及调用它们的参数来做到这一点。

因此，例如，您会看到程序尝试打开哪些文件，并判断调用是否成功。

您可以使用此工具调试各种问题。例如，如果应用程序说它找不到您知道已安装的库，那么 strace 会告诉您应用程序在哪里寻找该文件。

而这只是冰山一角。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-08-03T17:27:28.500

strace 是一个很好的工具，用于了解您的程序如何进行各种系统调用（对内核的请求），并且还报告失败的系统调用以及与该失败相关的错误值。并非所有的失败都是错误。例如，尝试搜索文件的代码可能会收到 ENOENT（没有此类文件或目录）错误，但这可能是代码逻辑中可接受的场景。

使用 strace 的一个很好的用例是在临时文件创建期间调试竞争条件。例如，可能通过将进程 ID (PID) 附加到某些预先确定的字符串来创建文件的程序在多线程场景中可能会遇到问题。[PID+TID（进程 ID + 线程 ID）或更好的系统调用，如 mkstemp 将解决此问题]。

它也适用于调试崩溃。您可能会发现[这篇（我的）关于 strace 和调试崩溃的文章](http://mohit.io/blog/strace-those-crashes-on-linux/)很有用。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-09-17T13:34:05.527

以下是我如何使用 strace 挖掘网站的一些示例。希望这会有所帮助。

检查第一个字节的时间，如下所示：

```
time php index.php > timeTrace.txt 
```

看看有多少百分比的动作在做什么。很多`lstat`并且`fstat`可能表明是时候清除缓存了：

```
strace -s 200 -c php index.php > traceLstat.txt 
```

输出 a`trace.txt`这样您就可以准确地看到正在进行的调用。

```
strace -Tt -o Fulltrace.txt php index.php 
```

使用它来检查是否有任何东西需要`.1`一`.9`秒钟才能加载：

```
cat Fulltrace.txt | grep "[<]0.[1-9]" > traceSlowest.txt 
```

查看`strace`. 这将输出很多涉及我们系统的内容——唯一相关的部分涉及客户的文件：

```
strace -vv php index.php 2>&1 | sed -n '/= -1/p' > traceFailures.txt 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-08-24T21:59:42.073

我喜欢其中一些答案，它读取`strace`检查您如何与操作系统交互。

这正是我们可以看到的。系统调用。如果对比一下`strace`，`ltrace`差别就更明显了。

```
$>strace -c cd
Desktop  Documents  Downloads  examples.desktop  Music  Pictures  Public  Templates  Videos
% time     seconds  usecs/call     calls    errors syscall
------ ----------- ----------- --------- --------- ----------------
  0.00    0.000000           0         7           read
  0.00    0.000000           0         1           write
  0.00    0.000000           0        11           close
  0.00    0.000000           0        10           fstat
  0.00    0.000000           0        17           mmap
  0.00    0.000000           0        12           mprotect
  0.00    0.000000           0         1           munmap
  0.00    0.000000           0         3           brk
  0.00    0.000000           0         2           rt_sigaction
  0.00    0.000000           0         1           rt_sigprocmask
  0.00    0.000000           0         2           ioctl
  0.00    0.000000           0         8         8 access
  0.00    0.000000           0         1           execve
  0.00    0.000000           0         2           getdents
  0.00    0.000000           0         2         2 statfs
  0.00    0.000000           0         1           arch_prctl
  0.00    0.000000           0         1           set_tid_address
  0.00    0.000000           0         9           openat
  0.00    0.000000           0         1           set_robust_list
  0.00    0.000000           0         1           prlimit64
------ ----------- ----------- --------- --------- ----------------
100.00    0.000000                    93        10 total 
```

另一方面是`ltrace`跟踪功能。

```
$>ltrace -c cd
Desktop  Documents  Downloads  examples.desktop  Music  Pictures  Public  Templates  Videos
% time     seconds  usecs/call     calls      function
------ ----------- ----------- --------- --------------------
 15.52    0.004946         329        15 memcpy
 13.34    0.004249          94        45 __ctype_get_mb_cur_max
 12.87    0.004099        2049         2 fclose
 12.12    0.003861          83        46 strlen
 10.96    0.003491         109        32 __errno_location
 10.37    0.003303         117        28 readdir
  8.41    0.002679         133        20 strcoll
  5.62    0.001791         111        16 __overflow
  3.24    0.001032         114         9 fwrite_unlocked
  1.26    0.000400         100         4 __freading
  1.17    0.000372          41         9 getenv
  0.70    0.000222         111         2 fflush
  0.67    0.000214         107         2 __fpending
  0.64    0.000203         101         2 fileno
  0.62    0.000196         196         1 closedir
  0.43    0.000138         138         1 setlocale
  0.36    0.000114         114         1 _setjmp
  0.31    0.000098          98         1 realloc
  0.25    0.000080          80         1 bindtextdomain
  0.21    0.000068          68         1 opendir
  0.19    0.000062          62         1 strrchr
  0.18    0.000056          56         1 isatty
  0.16    0.000051          51         1 ioctl
  0.15    0.000047          47         1 getopt_long
  0.14    0.000045          45         1 textdomain
  0.13    0.000042          42         1 __cxa_atexit
------ ----------- ----------- --------- --------------------
100.00    0.031859                   244 total 
```

虽然我查了几次手册，但我没有找到名称的来源，`strace`但很可能是系统调用跟踪，因为这很明显。

有三个更大的注意事项要说`strace`。

注1：这两个函数`strace`都`ltrace`使用系统调用[`ptrace`](http://man7.org/linux/man-pages/man2/ptrace.2.html)。所以`ptrace`系统调用是有效的`strace`工作方式。

> ptrace() 系统调用提供了一种方法，一个进程（“跟踪器”）可以通过该方法观察和控制另一个进程（“跟踪者”）的执行，并检查和更改跟踪者的内存和寄存器。主要用于实现断点调试和系统调用跟踪。

注意 2：您可以使用不同的参数`strace`，因为`strace`可能非常冗长。我喜欢实验，`-c`这就像对事物的总结。根据`-c`您可以选择一个系统调用，例如`-e trace=open`您只会看到该调用的位置。如果您正在检查在您正在跟踪的命令期间将打开哪些文件，这可能会很有趣。当然，您可以将`grep`用于相同目的，但请注意，您需要像这样重定向`2>&1 | grep etc`以了解在发出命令时引用了配置文件。

注意 3：我发现这个非常重要的注释。您不限于特定的架构。`strace`会让你大吃一惊，因为它可以追踪不同架构的二进制文件。 [![在此处输入图像描述](https://i.stack.imgur.com/oKope.jpg)](https://i.stack.imgur.com/oKope.jpg)

# frameworks - 您是否需要一个框架来为 Web 编写 Ruby 或 Python 代码？

> ID：174948
> 
> 赞同：6
> 
> 时间：2008-10-06T16:10:10.067
> 
> 标签：frameworks

每次我看到在 Web 开发的上下文中讨论 Ruby 或 Python 时，总是有一个框架（Ruby 的 Rails，Python 的 Django）。这些框架有必要吗？如果不是，那为什么这些语言经常在框架中使用，而 Perl 和 PHP 却没有呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T16:13:50.437

我只能谈论 Ruby - 但是，不，您不需要一个框架来在 Web 上运行基于 Ruby 的页面。您确实需要启用 ruby​​ 的服务器，例如运行 eruby/erb 的 Apache。但是，一旦你这样做了，你就可以像 RoR 一样创建 .rhtml 文件，它在其中处理内联 ruby​​ 代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T16:14:29.233

“需要”是一个强有力的词。你当然可以在没有 Python 的情况下编写 Python，但我不想这样做。

Python 并非设计为（例如 PHP）作为直接的 Web 脚本语言，因此连接到数据库等常见的 Web 类东西不是原生的，框架很方便。

**编辑**： Apache 存在 mod_python，所以如果您只是想编写一些脚本，那么 Python 不需要框架。如果您想构建一个完整的*站点*，我建议您使用一个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T16:21:12.153

**简短的回答是否定的，它们不是必需的**。在 ruby​​ 中，您拥有 .erb 模板，可以以与使用 PHP 页面类似的方式使用这些模板。您可以使用多种技术（类似 Rails 的框架、模板甚至直接与 HTTP 库对话并构建 CGI 样式的页面）用 ruby​​ 或 Python 编写站点。

像 Python 的 Django 或 Ruby 的 Rails（有很多）这样的 Web 框架只是提高了 PHP 或 ASP 的抽象级别，并自动化了几个过程（如登录、数据库交互、REST API），这总是一件好事。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-10T13:26:53.183

从 Pythonic 的角度来看，您绝对希望使用其中一个框架。是的，没有它们也可以编写一个 Web 应用程序，但它不会很漂亮。以下是您（可能）最终会从头开始编写的一些内容：

*   模板：除非您正在编写一个非常快速的 hack，否则您不希望在 Python 代码中生成所有 HTML——这是一个非常糟糕的设计，成为可维护性的噩梦。

*   URL 处理：拆分 URL 并确定要运行的代码并非易事。Django（例如）提供了一种奇妙的机制来从一组正则表达式映射到一组视图函数。

*   身份验证：滚动您自己的登录/注销/会话管理代码很痛苦，尤其是当已经有预先编写（和测试）的代码可用时

*   错误处理：框架已经有一个很好的机制来 a) 帮助你调试你的应用程序，b) 帮助重定向到正确的 404 和 500 页面。

除此之外，所有框架库都经过严格测试（并经过防火测试）。此外，有些社区正在使用相同的代码库进行开发，因此如果您有任何问题，您可能会找到帮助。

总之，您不必这样做，但除非您的项目是“一个新的 Web 框架”，否则您最好使用现有的一个。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T16:28:23.993

框架？哎呀，如果您使用 Python，您甚至不需要 Web 服务器，您可以编写大约三行代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T16:16:19.773

至于**为什么**：

我能想到的最合理的事情是 Perl 和 PHP 是在为 Web 应用程序使用框架的概念流行之前开发的。因此，“旧”的做事方式一直存在于这些文化中。Ruby和Python是在框架流行之后才流行起来的，因此它们一起发展。如果你的语言有一个很好的框架（或者不止一个），并且社区很好地支持，那么没有太多理由去尝试编写一个没有框架的 Web 应用程序。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T16:17:29.243

框架本身并不是必需的，但它肯定可以加速开发并帮助您编写“更好”的代码。在 PHP 中，肯定有像[CakePHP](http://www.cakephp.org/)这样的框架被使用，在 Perl 中也有很多像[Mason](http://www.masonhq.com/)和[Catalyst](http://www.catalystframework.org/)这样的框架。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T16:19:46.040

框架不是必需的。然而，许多开发人员认为框架通过自动化很多事情来简化开发。例如，Django 将根据您的数据库结构为您创建一个生产就绪的后端。如果您愿意，它还可以让您合并各种插件。我对 Rails 或 Perl 框架了解不多，但 PHP 框架如 Zend、Symfony、Code Igniter、CakePHP 等被广泛使用。

在我工作的地方，我们推出了自己的 PHP 框架。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-06T11:31:05.557

> 这些框架有必要吗？

不，它们与任何“框架”一样，只是为了加快开发时间并使程序员的工作更轻松。

> 如果不是，那为什么这些语言经常在框架中使用，而 Perl 和 PHP 却没有呢？

在使用框架的想法出现之前，PHP 和 Perl 是用于构建网站的流行语言。像 Rails 这样的框架是 Ruby 的追随者。我不确定 Python 或 Ruby 在得到框架支持之前是否像 Web 语言那样普遍。

如今，即使是 PHP/Perl Web 开发也应该由一个框架（现在有很多）支持。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T16:15:02.367

绝不需要这些开发框架。但是与大多数开发环境一样，如果您有一个受支持的框架来引用和构建您的应用程序，您的生产力将成倍提高。如果其他人已经对您使用的框架有核心理解，它还可以减少使其他人快速了解您的应用程序所需的培训。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-06T16:15:06.783

任何可以“打印”的语言都可以用来生成网页，但框架会为您处理大量的 HTML 生成。它们使您可以更多地关注内容，而不是对原始 HTML 进行编码的细节。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-06T16:15:07.080

对于 python，答案是不，你不必这样做。你可以很容易地直接在你的 web 服务器后面编写 python，看看 mod_python 是怎么做的。

很多人喜欢框架，因为它们以可靠的形式提供了大量样板代码，因此您不必自己编写。但是，就像任何代码项目一样，您应该根据自己的问题选择工具和框架。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-06T16:15:58.637

您当然可以用任何一种语言编写 CGI 脚本并“原始”地做事。

框架（理想情况下）省去了为其他人已经处理过的事情（会话处理等）编写一堆代码的麻烦。

该决定可能归结为您需要做什么。如果该框架具有您需要的功能，为什么不使用它。如果框架需要大量修改，那么推出自己的东西可能会更容易。或者查看不同的框架。

python 库有许多用于执行 cgi、解析 html、cookie、WSGI 等的模块：

[http://docs.python.org/library/index.html](http://docs.python.org/library/index.html)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-10T13:12:11.200

PHP 有很多框架。可能比大多数还要多。在 Ruby 中，大多数人使用 Rails，所以这就是你所听到的，而 Django for Python 被提及的次数更多，而不是没有。但是对于 PHP，您有很多选择。

[Web 应用程序框架列表](http://en.wikipedia.org/wiki/List_of_web_application_frameworks#PHP)

# parameters - 多少参数太多了？

> ID：174968
> 
> 赞同：228
> 
> 时间：2008-10-06T16:14:48.670
> 
> 标签：parameters, language-agnostic

例程可以有参数，这不是新闻。您可以根据需要定义任意数量的参数，但过多的参数会使您的例程难以理解和维护。

当然，您可以使用结构化变量作为解决方法：将所有这些变量放在一个结构中并将其传递给例程。事实上，使用结构来简化参数列表是 Steve McConnell 在*Code Complete*中描述的技术之一。但正如他所说：

> *细心的程序员避免捆绑数据超出逻辑上的必要。*

因此，如果您的例程有太多参数，或者您使用结构体来伪装一个大参数列表，那么您可能做错了什么。也就是说，您不会保持耦合松散。

我的问题是，**我什么时候可以认为参数列表太大了？**我认为超过5个参数，太多了。你怎么看？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2008-10-06T16:25:52.597

尽管第一修正案保证言论自由，什么时候被认为如此淫秽以至于可以监管的东西？根据波特斯图尔特法官的说法，“我一看到就知道了。” 这里也一样。

我讨厌制定这样的硬性规则，因为答案的变化不仅取决于项目的大小和范围，而且我认为它甚至会变化到模块级别。根据您的方法正在做什么，或者该类应该代表什么，很可能 2 个参数太多并且是过多耦合的症状。

我建议通过首先提出问题，并尽可能多地限定你的问题，你真的知道这一切。这里最好的解决方案不是依赖一个硬性和快速的数字，而是在你的同行中进行设计评审和代码评审，以确定你的内聚度和紧密耦合度较低的领域。

永远不要害怕向您的同事展示您的工作。如果你害怕，那可能是你的代码有问题的更大迹象，而且你*已经知道了*。

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2008-10-06T16:37:25.257

如果某些参数是多余的，则函数只能有太多参数。如果使用了所有参数，则该函数必须具有正确数量的参数。拿这个常用的功能：

```
HWND CreateWindowEx
(
  DWORD dwExStyle,
  LPCTSTR lpClassName,
  LPCTSTR lpWindowName,
  DWORD dwStyle,
  int x,
  int y,
  int nWidth,
  int nHeight,
  HWND hWndParent,
  HMENU hMenu,
  HINSTANCE hInstance,
  LPVOID lpParam
); 
```

那是 12 个参数（如果将 x、y、w 和 h 捆绑为一个矩形，则为 9 个），还有从类名派生的参数。你会如何减少这个？你想把这个数字减少到更重要的程度吗？

不要让参数的数量困扰您，只需确保它是合乎逻辑且有据可查的，并让智能感知^*帮助您。

^*其他编码助手可用！

* * *

## 回答 #3

> 赞同：106
> 
> 时间：2008-10-06T16:25:53.453

在[Clean Code](https://rads.stackoverflow.com/amzn/click/com/0132350882)中，Robert C. Martin 用了四页纸来讨论这个主题。这是要点：

> 函数的理想参数数量为零（niladic）。接下来是一个（单子），紧随其后的是两个（二元）。应尽可能避免使用三个参数（三元）。超过三个（多元）需要非常特殊的理由——然后无论如何都不应该使用。

* * *

## 回答 #4

> 赞同：79
> 
> 时间：2008-10-06T16:28:52.417

我过去使用过的一些代码使用全局变量只是为了避免传递太多参数。

请不要那样做！

（通常。）

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2008-10-06T16:19:35.667

如果您开始在心里计算签名中的参数并将它们与调用相匹配，那么是时候重构了！

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2008-10-06T21:14:36.770

非常感谢您的所有回答：

*   发现有人也认为（像我一样）5 个参数是代码健全性的一个很好的限制，这有点令人惊讶。

*   通常，人们倾向于同意 3 到 4 之间的限制是好的经验法则。这是合理的，因为人们通常很难计算超过 4 件事情。

*   正如[**米兰**指出](https://stackoverflow.com/questions/174968/how-many-parameters-are-too-many#175333)的那样，平均而言，人们一次可以在脑海中保留或多或少的 7 件事。但我认为你不能忘记，当你在设计/维护/研究一个例程时，你必须记住的不仅仅是参数。

*   有些人认为例程应该有尽可能多的参数。我同意，但仅适用于少数特定情况（调用 OS API、优化很重要的例程等）。我建议尽可能通过在这些调用之上添加抽象层来隐藏这些例程的复杂性。

*   **尼克**对此有[一些有趣的想法](https://stackoverflow.com/questions/174968/how-many-parameters-are-too-many#175034)。如果您不想阅读他的评论，我为您总结：简而言之，**这取决于**：

    > 我讨厌制定这样的硬性规则，因为答案的变化不仅取决于项目的大小和范围，而且我认为它甚至会变化到模块级别。根据您的方法正在做什么，或者该类应该代表什么，很可能 2 个参数太多并且是过多耦合的症状。

    这里的寓意是不要害怕向你的同行展示你的代码，与他们讨论并尝试*“找出你的低内聚和紧密耦合的领域”*。

*   最后，我认为**wnoise**非常同意尼克的观点，并以这种对编程艺术的[诗意愿景（见下文评论）结束了他的讽刺贡献：](https://stackoverflow.com/questions/174968/how-many-parameters-are-too-many#175002)

    > 编程不是工程。代码的组织是一门艺术，因为它取决于人为因素，对于任何硬性规则来说，人为因素都过于依赖上下文。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2008-10-06T16:27:43.950

此答案假定为 OO 语言。如果您不使用一个 - 跳过这个答案（换句话说，这不是一个与语言无关的答案。

如果您传递的参数超过 3 个左右（尤其是内在类型/对象），并不是因为它“太多”，而是您可能错过了创建新对象的机会。

寻找传递给多个方法的参数组——即使是传递给两个方法的组也几乎可以保证你应该在那里有一个新对象。

然后你将功能重构到你的新对象中，你不会相信它对你的代码和你对 OO 编程的理解有多大帮助。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2008-10-06T16:22:34.723

似乎除了数量之外还有其他考虑因素，这里有一些我想到的：

1.  与功能的主要目的与一次性设置的逻辑关系

2.  如果它们只是环境标志，捆绑会非常方便

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2008-10-06T17:59:40.923

Alan Perlis 著名的编程警句之一（在 1982 年 9 月的 ACM SIGPLAN Notices 17(9) 中叙述）指出“如果您有一个包含 10 个参数的过程，您可能会遗漏一些参数。”

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2008-11-25T23:48:44.693

根据 Steve McConnell 在*Code Complete*中的说法，你应该

> 将例程的参数数量限制为大约七个

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2008-10-06T16:17:46.870

对我来说，当列表在我的 IDE 上越过一行时，那就是一个参数太多了。我想在不中断目光接触的情况下在一行中查看所有参数。但这只是我个人的喜好。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2008-10-06T16:18:13.483

我一般同意 5，但是，如果在某种情况下我需要更多并且这是解决问题的最清晰的方法，那么我会使用更多。

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2010-12-18T03:57:59.627

短期记忆中的七件事？

1.  函数名称
2.  函数的返回值
3.  函数的目的
4.  参数 1
5.  参数 2
6.  参数 3
7.  参数 4

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2010-03-02T08:07:55.030

在[Worst 5 Code Snippets 中](https://kababji.wordpress.com/2009/09/07/worst-5-code-snippets-till-now/ "最差的 5 个代码片段")，检查第二个“Is this a constructor”。它有超过 37 ⋅ 4 ≈ 150 个参数：

> 在这里，一个程序员写了这个构造函数[...你们中的一些人可能认为是的，它是一个很大的构造函数，但他使用了 eclipse 自动代码生成工具[.] NOO，在这个构造函数中我发现了一个小错误，这让我得出结论，这个构造函数是手工编写的。（顺便说一句，这只是构造函数的顶部，它不完整）。
> 
> ![具有超过 150 个参数的构造函数](https://i.stack.imgur.com/Hltui.jpg)

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2008-10-06T16:35:44.337

比必要的多一个。我不是说油嘴滑舌，但有些功能必然需要很多选项。例如：

```
void *
mmap(void *addr, size_t len, int prot, int flags, int fildes, off_t offset); 
```

有 6 个论点，每一个都是必不可少的。此外，它们之间没有共同的联系来证明捆绑它们是合理的。也许您可以定义“struct mmapargs”，但这会更糟。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2008-10-06T16:18:42.080

根据**Perl Best Practices**，3 还可以，4 太多了。这只是一个指导方针，但在我们的商店中，这是我们努力坚持的。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2008-10-06T16:24:29.027

我自己会在 5 个参数处绘制公共函数的限制。

恕我直言，长参数列表仅在私有/本地辅助函数中可接受，这些辅助函数仅用于从代码中的几个特定位置调用。在这些情况下，您可能需要传递大量状态信息，但可读性并不是一个大问题，因为只有您（或将维护您的代码并应该了解模块基础知识的人）需要关心调用该函数。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2008-10-28T13:42:38.057

您应该考虑的一个相关问题是例程的[凝聚力。](http://en.wikipedia.org/wiki/Cohesion_(computer_science))大量参数可能是一种气味，它告诉您例程本身正在尝试做太多事情，因此它的凝聚力值得怀疑。我同意硬而快速的参数数量可能是不可能的，但我猜想高内聚例程意味着参数数量少。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2011-06-01T23:35:16.660

[97听起来差不多。](https://stackoverflow.com/questions/2244860/when-a-method-has-too-many-parameters/2244978#2244978)

再少一点，你就会失去灵活性。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2008-10-06T16:24:28.743

作为一般经验法则，我停在三个参数上。现在是时候传递参数数组或配置对象了，这也允许在不更改 API 的情况下添加未来的参数。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2008-10-06T16:34:53.357

参数列表的长度限制只是又一个限制。而限制意味着施加暴力。这听起来很有趣，但即使在编程时你也可以不暴力。让代码决定规则。很明显，如果你有很多参数，函数/类方法的主体将足够大以使用它们。大的代码片段通常可以重构并分成更小的块。因此，您可以获得针对将许多参数作为免费奖励的解决方案，因为它们被拆分为较小的重构代码片段。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2010-10-26T07:46:48.543

从性能的角度来看，我要指出的一件事是，根据您将参数传递给方法的方式，按值传递大量参数会减慢程序速度，因为必须复制每个参数然后将其放入堆栈中。

使用单个类来包含所有参数会更好，因为通过引用传递的单个参数会更优雅、更简洁、更快！

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2008-11-25T23:41:07.923

根据我的说法，在某些情况下您可能会超过 4 或某个固定数字。需要注意的事情可能是

1.  您的方法做得太多，您需要重构。
2.  您可能需要考虑使用集合或某些数据结构。
3.  重新考虑你的类设计，也许有些东西不需要传递。

从易于使用或易于阅读代码的角度来看，我认为当您需要对您的方法签名进行某种“自动换行”时，这应该会让您停下来思考，除非您感到无助并且所有使签名更小的努力都会导致没有结果。过去和现在一些非常好的图书馆使用超过 4-5 个婴儿车。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2009-10-24T13:08:39.860

我的经验法则是，我需要能够记住参数足够长的时间来查看调用并了解它的作用。因此，如果我不能查看该方法，然后转而调用一个方法并记住哪个参数做了什么，那么就太多了。

对我来说，这相当于大约 5，但我没那么聪明。你的旅费可能会改变。

您可以创建一个具有属性的对象来保存参数并在超出您设置的任何限制时将其传入。请参阅 Martin Fowler 的[Refactoring](http://books.google.co.uk/books?id=1MsETFPD3I0C&lpg=PA271&ots=pKQ4n4WIgc&dq=martin%20fowler%20create%20parameter%20object&pg=PA271#v=onepage&q=&f=false)书和有关使方法调用更简单的章节。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-10-06T16:22:38.843

这在很大程度上取决于您工作的环境。以 javascript 为例。在 javascript 中，传递参数的最佳方式是使用带有键/值对的对象，这实际上意味着您只有一个参数。在其他系统中，最佳位置将是三到四。

最后，这一切都归结为个人口味。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-10-06T16:25:02.003

我同意 3 是可以的，4 作为指导方针太多了。使用超过 3 个参数，您不可避免地要做不止一项任务。一个以上的任务应该被分成不同的方法。

但是，如果我查看我从事的最新项目，就会发现异常情况很多，而且大多数情况下很难减少到 3 个参数。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-10-06T17:02:08.637

如果我在一个例程中有 7-10 个参数，我会考虑将它们捆绑到一个新类中**，但**如果该类只是一堆带有 getter 和 setter 的字段 - 新类必须*做*一些事情，而不是在和出去。否则我宁愿忍受长长的参数列表。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2008-10-06T17:38:58.343

众所周知，平均而言，人们一次可以在脑海中保留 7 +/- 2 件事情。我喜欢将这个原则与参数一起使用。假设程序员都是高于平均水平的聪明人，我会说所有 10+ 的人都太多了。

顺便说一句，如果参数在任何方面都相似，我会将它们放在向量或列表中，而不是结构或类中。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2008-10-07T00:28:28.080

我会根据调用函数的频率来回答。

如果它是一个只被调用一次的初始化函数，那么让它需要 10 个参数或更多，谁在乎呢。

如果它每帧被调用很多次，那么我倾向于创建一个结构并只传递一个指向它的指针，因为这往往更快（假设你不是每次都重建结构）。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-10-07T00:45:09.093

根据亚马逊名人杰夫贝索斯的说法，最多只能吃[两个比萨饼](http://www.fastcompany.com/magazine/85/bezos_4.html)：

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2009-11-17T06:50:13.823

我同意 Robert Martin 在 Clean Code 中的[引用（如上所述](https://stackoverflow.com/questions/174968/how-many-parameters-are-too-many/175035#175035)）：参数越少越好。超过 5-7 个参数和方法调用变得非常难以理解。如果某些参数是可选的（因此采用空值），或者如果所有参数都具有相同的类型（使得找出哪个参数是哪个参数变得更加困难），情况就会变得特别糟糕。如果您可以将参数捆绑到像客户和帐户这样的内聚域对象中，那么您的代码将更加令人愉快。

有一个极端情况：如果您有一个方法调用，它采用可变数量的参数*形成一个逻辑集*，那么拥有更多参数的认知开销就会减少。例如，您可能需要一个方法，以重试之间的毫秒数来指定 HTTP 请求的重试次数。以 1s、2s 和 3s 为间隔的 3 次重试可以指定为：

```
retries(1000, 2000, 3000) 
```

在这种有限的情况下，向调用添加更多参数并不会增加太多的心理负担。

另一个考虑因素是您的语言是否支持命名参数列表并允许您省略可选参数。较大的命名参数列表比较大的未命名参数列表更容易理解。

但是我仍然会在更少而不是更多参数方面犯错。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-10-06T16:24:56.670

我想说，只要你有 2-4 的重载，如果你需要它，你就可以升得更高。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-10-06T16:25:32.207

我认为实际数字实际上取决于函数上下文的逻辑意义。我同意大约 4-5 个参数开始变得拥挤。

在设置标志的情况下，处理这种情况的一个好方法是枚举这些值并将它们组合在一起。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-10-06T16:49:21.330

IMO，长参数列表的理由是数据或上下文本质上是动态的，想想 printf(); 使用可变参数的一个很好的例子。处理这种情况的更好方法是传递流或 xml 结构，这再次最大限度地减少了参数的数量。

机器肯定不会介意大量参数，但开发人员会考虑维护开销、单元测试用例的数量和验证检查。设计师也讨厌冗长的参数列表，更多的参数意味着接口定义的更多更改，无论何时要进行更改。关于耦合/凝聚力的问题来自以上几个方面。

# ide - Windows 上的 Mono IDE

> ID：174981
> 
> 赞同：14
> 
> 时间：2008-10-06T16:16:29.760
> 
> 标签：ide, mono

是否有任何用于在 Windows 平台上编码单声道的 IDE？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-09T03:21:28.247

MonoDevelop 现已发布 Windows 安装程序。您不再需要从源代码构建它。它可从[MonoDevelop 网站获得](http://monodevelop.com/Download/Windows_Preview)

但是在 Windows 上，它在 .NET Framework 上运行，而不是 Mono - 它使用 .NET 调试器而不是 Mono 调试器。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-06T16:17:58.587

[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)和 Visual Studio 都可以工作。您还可以使用 Windows 版本的[MonoDevelop](http://www.monodevelop.com/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T16:19:36.930

我会推荐[#develop](http://www.icsharpcode.net/OpenSource/SD/)或查看将[MonoDevelop](http://www.monodevelop.com/MonoDevelopWin32)（#develop 的一个分支）移植回 Windows 的状态。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T16:19:40.097

SharpDevelop 浮现在我的脑海中......我找到了这个快速的方法来使用它和 Mono 和 windows 设置开发环境：http: [//yacoding.blogspot.com/2006/04/howto-mono-sharpdevelop-and-firebird .html](http://yacoding.blogspot.com/2006/04/howto-mono-sharpdevelop-and-firebird.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-23T09:45:01.290

使用德尔福棱镜 2010

# flash - 如何更改动作脚本中文本区域的颜色？

> ID：174986
> 
> 赞同：2
> 
> 时间：2008-10-06T16:17:07.120
> 
> 标签：flash, actionscript, skinning

我在 actionscript 中创建了一个 TextArea：

```
var textArea:TextArea = new TextArea(); 
```

我希望它有黑色背景。我试过了

```
textArea.setStyle("backgroundColor", 0x000000); 
```

我试过了

```
textArea.opaqueBackground = 0x000000; 
```

但 TextArea 保持白色。我该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T19:53:35.220

TextArea 是由 TextField 和其他 Flash 内置类和 UIComponents 构建的 UI 组件。与大多数 Adob​​e UI 组件一样，设置属性时似乎没有任何东西。要设置 TextArea 中文本后面区域的颜色，您需要使用 textField 属性实际设置其内部 TextField 的不透明背景：

```
var textArea:TextArea = new TextArea()
textArea.textField.opaqueBackground = 0x000000; 
```

当然现在背景是黑色的，文字不可能也是黑色的，所以我们用一个新的TextFormat来改变它的颜色：

```
var myFormat:TextFormat = new TextFormat();
myFormat.color = 0xffffff;
textArea.setStyle("textFormat",myFormat); 
```

然后只需设置文本并添加到阶段：

```
textArea.text = "hello";
addChild(textArea); 
```

另外，如果你想要更多的控制，这里有一个很好的扩展类，它修复了 TextArea 的很多问题：

[http://blog.bodurov.com/Post.aspx?postID=14](http://blog.bodurov.com/Post.aspx?postID=14)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-19T14:06:29.193

这是对我有用的方法，这是我在查看更新的 AC3 文档后自己发现的

**TextArea - 背景颜色，2011 AC3**

让我永远意识到，在 AC3 中，截至目前（2011 年），他们正式告诉你使用 spark TextArea 而不是 mx

（`s:TextArea`而不是`mx:TextArea`）

```
<s:TextArea
id="joy_text"
color="0xFF0000"
contentBackgroundColor="0x000000"
text = "joy"
/> 
```

**请注意**

颜色 = 字体颜色

确保包含在您的命名空间中：（在 .mxml 文件的顶部）

```
xmlns:s="library://ns.adobe.com/flex/spark" 
```***********