# StackOverflow 问答 10253000-10253999

# php - PHP：如何使用 :: 而不是 \ 访问命名空间类？

> ID：10253001
> 
> 赞同：2
> 
> 时间：2012-04-20T20:18:45.717
> 
> 标签：php, oop, namespaces, php-5.3, spl-autoload-register

我`namespace`在下面这样的课程中使用，

class_tidy.php,

```
namespace foo;

class tidy {
    public function hello() {
        echo 'Hello';
    }
} 
```

索引.php,

```
class MyAutoloader
{
    public static function load($className)
    {
        $parts = explode('\\', $className);
        require 'classes/class_'.end($parts) . '.php';
    }
}

spl_autoload_register("\MyAutoloader::load");

$test = new foo\tidy();
$test->hello(); 
```

它工作得很好，但我想知道我是否可以访问该课程，而不是，

```
$test = new foo\tidy(); 
```

但，

```
$test = new foo::tidy(); 
```

哪个看起来更漂亮。但有了这个错误，

> 解析错误：语法错误，意外的 T_STRING，期待 T_VARIABLE 或 '$' ...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T20:25:18.847

你不能。PHP 语法`\`用于命名空间。

事实上，php 使用 T_PAAMAYIM_NEKUDOTAYIM（这是他们的双冒号名称）仅用于一件事，在类名之后使用它来指定您想要该类的成员。

我确实相信它的工作方式有一些晦涩的细节，这也阻止了 PHP 将其用作命名空间分隔符，但我不知道是哪一个。（问题是，这意味着即使您从官方 php 分支并制作了自己的版本，您也必须进行大量工作才能获得所需的细微语法更改。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:25:45.623

php 团队选择 \ 作为命名空间分隔符。即使您认为 :: 更好，您也无法更改它。我可以问你为什么会这样吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T20:28:44.993

阅读官方手册：[http](http://php.net/language.namespaces.nested) `::` ://php.net/language.namespaces.nested不支持作为命名空间分隔符，因为它已经被用作（因此被保留）作为[范围解析运算符](http://php.net/language.oop5.paamayim-nekudotayim)

```
Foo::$bar; 
```

也很有趣：相应的 RFC [https://wiki.php.net/rfc/namespaceseparator](https://wiki.php.net/rfc/namespaceseparator)

# .net - 通用集合不起作用

> ID：10253003
> 
> 赞同：0
> 
> 时间：2012-04-20T20:18:52.547
> 
> 标签：.net, generics, collections

我将从代码开始

```
class LocData 
{
    public virtual TypeA Copy () { ... }
    ...
}

class LocDataCollection<T> : List<T> where T: LocData
{
    public LocDataCollection<T> Copy() 
    {
        LocDataCollection<T> locDatas = new LocDataCollection<T>();
        foreach (T locData in this)
        {
            T locData2 = locData.Copy() as T;
            locDatas.Add(locData2);
        }
        return locDatas;
    }
  ...
} 
```

和

```
class TypeA : LocData
{
  public new TypeA Copy () { ... }
  ...
}

class TypeACollection : LocDataCollection<TypeA>
{
} 
```

测试代码：

```
TypeACollection typeAs = new TypeACollection();
...
TypeACollection typeAs2 = typeAs.Copy(); 
```

编译消息：

“无法将类型 'LocDataCollection' 隐式转换为 'TypeACollection'。存在显式转换（您是否缺少演员表？）”

我必须改为

```
TypeACollection typeAs2 = typeAs.Copy() as TypeACollection; 
```

编译通过，但在运行时出错。即使 typeAs 不为 null，typeAs2 也会返回 null。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T20:23:08.403

`typeAs.Copy()`返回一个`LocDataCollection<TypeA>`。但是您不能将其中一个分配给 a`TypeACollection`因为`TypeACollection`比`LocDataCollection<TypeA>`.

你也许可以通过让你的复制方法接收一个来解决这个问题`LocDataCollection<T>`：

```
class LocDataCollection<T> : List<T> where T: LocData
{
    public void CopyTo(LocDataCollection<T> dest) 
    {
        ....
    }
} 
```

然后在呼叫站点：

```
TypeACollection typeAs = new TypeACollection();
TypeACollection typeAs2 = new TypeACollection();
typeAs.CopyTo(typeAs2); 
```

当然，这不会复制任何`TypeACollection`特定的东西，除非您添加了覆盖该效果。

但是我对您的问题的了解还不够，无法确信这是一个合适的解决方案。

# c# - Windows Phone 7 循环导航

> ID：10253011
> 
> 赞同：-1
> 
> 时间：2012-04-20T20:19:17.527
> 
> 标签：c#, windows-phone-7

假设我的应用中有四个页面。假设它们是 Acs.xaml、MainPage.xaml、Home.xaml 和 Weather.xaml。（因为我正在使用访问控制服务 (ACS) 来执行身份验证功能）。

现在，经过身份验证后，ACS 将我重定向到 MainPage.xml 和 MainPage.xaml 上有两个按钮，其中一个将用户带到 Home，而另一个将用户带到 Weather。

现在，当我在主页上时，我想要另一个按钮将它们带到天气。同样，当我在 Weather 时，我想要一个按钮将它们带回家。（在 Home.xaml 和 Weather.xaml 中，我正在使用图表，使用数据可视化工具包的图表 [Silverlight）

我已经浏览了 windowsteamblog（循环导航），但没有任何工作正常......当我到达 MainPage.xaml 并单击任何按钮时，我得到一个错误，比如导航失败，我也尝试了全景但无法解决问题。

登录页面代码：-

```
namespace PhoneApp1.Pages
{
using System;
using System.Windows;
using System.Windows.Navigation;
using Microsoft.Phone.Controls;
using Microsoft.WindowsAzure.Samples.Phone.Identity.AccessControl

public partial class LoginPage : PhoneApplicationPage
{
    private readonly SimpleWebTokenStore swtStore = Application.Current.Resources["swtStore"] as SimpleWebTokenStore;

    public LoginPage()
    {
        this.InitializeComponent();

        this.PageTransitionReset.Begin();
        this.SignInControl.RequestSimpleWebTokenResponseCompleted +=
            (s, e) => 
            {
                // The ACS token was successfully received and stored in the "swtStore" application resource.
                // TODO: Navigate to your main page i.e.:
                this.NavigationService.Navigate(new Uri("/MainPage.xaml", UriKind.Relative));
            };
    }

    protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        if ((e.NavigationMode == NavigationMode.New) && this.swtStore.IsValid())
        {
            // There is a valid ACS token already in the "swtStore" application resource.
            // TODO: Navigate to your main page i.e.:
            this.NavigationService.Navigate(new Uri("/MainPage.xaml", UriKind.Relative));
        }
        else
        {
            // There is not a valid ACS token in the "swtStore" application resource.
            // The token may be expired or it is the first time the user logs in.
            this.PageTransitionIn.Begin();
            this.SignInControl.GetSimpleWebToken();
        }
    }

    protected override void OnNavigatedFrom(NavigationEventArgs e)
    {
        this.PageTransitionReset.Begin();
    }
} 
```

}`

主页代码：

```
using System;
using System.Collections.Generic;

using System.Linq;
using System.Net;
using System.Windows;

using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using Microsoft.Phone.Controls;

using System.Windows.Controls.DataVisualization.Charting;

namespace Chart
{

public partial class MainPage : PhoneApplicationPage
{

// Constructor
        public MainPage()
        {

InitializeComponent();

    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        this.NavigationService.Navigate(new System.Uri(@"/Home.xaml", UriKind.RelativeOrAbsolute));
    }

    private void button2_Click(object sender, RoutedEventArgs e)
    {
        this.NavigationService.Navigate(new System.Uri(@"/Weather.xaml", UriKind.RelativeOrAbsolute));
    }
}
}` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:21:28.343

如果我理解正确，听起来你最好使用允许用户循环浏览屏幕的[`Panorama`控件](http://create.msdn.com/en-US/education/quickstarts/Panorama_and_Pivot_Controls)，而不是让他们按下按钮从一个到另一个。

如果您对按钮完全死心，那么当按下时，使用[`NavigationService`](http://msdn.microsoft.com/en-us/library/system.windows.navigation.navigationservice.aspx)来到达另一个页面。

```
NavigationService.Navigate(new Uri("/Weather.xaml", UriKind.Relative)); 
```

要返回，他们会直观地按下设备上的“返回”按钮，但同样，如果您死心于提供自定义按钮，您可以以编程方式向后导航。

```
NavigationService.GoBack(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T01:03:20.453

听起来你在描述一个非线性导航周期——微软意识到可能会在最初的 SDK 发布后出现，并发布了它的配方。您可以在 Windows Phone 团队博客上找到一篇博文[解决 Windows Phone Silverlight 应用程序中的循环导航问题。](http://windowsteamblog.com/windows_phone/b/wpdev/archive/2010/12/13/solving-circular-navigation-in-windows-phone-silverlight-applications.aspx "解决 Windows Phone Silverlight 应用程序中的循环导航问题")它链接到[Recipe: Non-Linear Navigation Service for Windows Phone 7](http://create.msdn.com/en-us/education/catalog/article/nln-serv-wp7 "秘诀：Windows Phone 7 的非线性导航服务")，其中包含示例代码供您下载。

# ruby-on-rails - 它 { should respond_to(:reverse_relationships) } 在测试时失败，但在沙箱中可以

> ID：10253012
> 
> 赞同：0
> 
> 时间：2012-04-20T20:19:23.193
> 
> 标签：ruby-on-rails, testing

[http://ruby.railstutorial.org/chapters/following-users?version=3.2](http://ruby.railstutorial.org/chapters/following-users?version=3.2)

有一个用户模型的测试

```
it { should respond_to(:reverse_relationships) } 
```

失败：

> 失败：
> 
> 1) User ←[31mFailure/Error:←[0m ←[31mit { should respond_to(:reverse_relationships) }←[0m ←[31mNoMethodError:←[0m ←[31mundefined 方法`it' for #<RSpec::Core::ExampleGroup::Nested_3:0x32 6c310>←[0m ←[36m # ./spec/models/user_spec.rb:36:in`块(2级) in '←[0m
> 
> 23秒内完成←[31m131个例子，1个失败←[0m
> 
> 失败的例子：
> 
> ←[31mrspec ./spec/models/user_spec.rb:35←[0m ←[36m#用户←[0m

同时，在 rails console --sandbox 看起来还不错：

> irb(main):014:0> user.respond_to?(:reverse_relationships) => true

怎么可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:28:05.260

堆栈跟踪显示错误是方法“it”在当前上下文中未定义。

这是因为您在第 22 行缺少一个右大括号，而在第 24 行有两个右大括号。

# php - 输入标签中的换行符，来自mysql的数据

> ID：10253017
> 
> 赞同：0
> 
> 时间：2012-04-20T20:19:37.137
> 
> 标签：php, mysql, html, input, nl2br

我的`<input>`标签正在打印`<br />`而不是实际产生换行符？我有一种感觉，我忽略了一些简单的事情......

我不应该`$bio`从 MySQL 数据库调用该变量，并将其设置为“longtext”
（我怀疑这可能是一个因素）

```
 <form>
<input 
style="position:relative;left:10px;min-height:270px;width:40%;border:solid 2px black;top:20px;"
type="text" 
name="bio" 
value ="<?php echo nl2br($bio);?>"
readonly="readonly" 
/>
 </form> 
```

输出确实显示 `<br/>`

但是我的 php 似乎并没有将其转换为实际的换行符。

谁能想到会发生这种情况的原因？（我唯一想到的是检查`htmlspecialchars()`，但`$bio`变量没有。

谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T20:21:55.640

在常规`input`标签中，浏览器不会显示换行符。

`textarea`如果您需要显示可编辑的文本，您可以使用。

# payment-gateway - Paypal 定期付款基于事件而不是基于期间

> ID：10253019
> 
> 赞同：1
> 
> 时间：2012-04-20T20:19:44.830
> 
> 标签：payment-gateway, paypal

我想通过贝宝实现定期付款。但根据我的研究，贝宝定期付款是基于时间段，即每周、每月或每年。

我不希望按时付款，而是按事件付款。请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:38:14.697

您需要的称为参考事务：

[https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECReferenceTxns](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECReferenceTxns)

~~但是您必须注册 PayPal Pro。~~

# java - android活动不会显示

> ID：10253021
> 
> 赞同：0
> 
> 时间：2012-04-20T20:19:50.423
> 
> 标签：java, android, icons

我在菜单中添加了一个图标。但是在单击带有图标的选项后，会弹出异常。

04-20 20:17:20.623: 错误/AndroidRuntime(309): android.content.ActivityNotFoundException: 找不到明确的活动类 {jusbrz.bakalauras/jusbrz.bakalauras.AllCourseUsers}; 您是否在 AndroidManifest.xml 中声明了此活动？

活动已声明。我应该在添加图标后添加一些东西来显示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:21:51.207

活动需要在清单中声明为

```
<activity android:name=".AllCourseUsers" /> 
```

# java - Java中的类型声明

> ID：10253022
> 
> 赞同：-4
> 
> 时间：2012-04-20T20:20:03.397
> 
> 标签：java

说`Iterator<Integer> sth = sth2.sfunc;`

我想知道`<Integer>`这里有什么？它是指迭代器的整数列表还是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T20:26:32.927

这是一个使用[泛型](http://en.wikipedia.org/wiki/Generics_in_Java)来提高[类型安全性](http://en.wikipedia.org/wiki/Type_safety)的例子。`Iterator`是参数化类型，在这种情况下，`Integer`用作其类型参数。

效果很简单，编译器知道`next()`an 的方法`Iterator<Integer>`总是返回 an `Integer`，所以你不必显式地强制转换它（编译器会为你做），如果你不小心尝试了，你会得到一个编译器错误将其转换为- 使用其方法返回this`String`的预泛型，直到运行时才会被注意到。`Iterator``next()``Object`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:22:37.443

它`generics`在java中用于`type safety`集合......所以在你的情况下，你只能`<Integer>`从集合中添加和检索值......并且`Iterator<Integer>`总是返回一个整数......

看到这里.... [http://docs.oracle.com/javase/tutorial/java/generics/index.html](http://docs.oracle.com/javase/tutorial/java/generics/index.html)

# php - php数组仍然得到空白和空值

> ID：10253024
> 
> 赞同：0
> 
> 时间：2012-04-20T20:20:06.993
> 
> 标签：php, arrays

试图从一个数组中获取两个单词短语，但我一直在单词之前或之后得到一个带有空格的单词短语。

```
$text = preg_replace(array('/\s{2,}/', '/[\t\n]/'), ' ', $text);
$textarray = explode(" ", $text);
array_filter($textarray);
$textCount = array_count_values($textarray);
arsort($textCount);
$twoWords = array();
for ($i = 0; $i<=count($textarray); ++$i) {
    if ($textarray[$i]<>"  ") {
        $twoWords[$i] = $textarray[$i]." ".$textarray[$i + 1];
    } else {
        $twoWords[$i] = "blah";
    }
}
foreach ($twoWordsCount as $tey => $val2) {
    if ($tey == null || $tey == "" || $tey == "\r\n"  || $tey == "\t"  || $tey == "\r"  || $tey == "\n" || $tey == "&nbsp;" || $tey == "  " || $tey == " ") {
        //do nothing
    } else {
        echo $val2."\n";
    }
} 
```

并且由于某种原因，这只是返回值，例如空格 Hello 或 Test 然后是空格，但我希望它返回 hello test

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:30:09.140

不知道脚本的后半部分应该做什么，但第一部分可以简化为一个 preg_split() 代码行

```
<?php
foreach( array('hello world', ' hello world', 'hello world ', '  hello     world     ') as $input ) {
    $w = preg_split('!\s+!', $input, -1, PREG_SPLIT_NO_EMPTY);
    var_dump($w);
} 
```

印刷

```
array(2) {
  [0]=>
  string(5) "hello"
  [1]=>
  string(5) "world"
}
array(2) {
  [0]=>
  string(5) "hello"
  [1]=>
  string(5) "world"
}
array(2) {
  [0]=>
  string(5) "hello"
  [1]=>
  string(5) "world"
}
array(2) {
  [0]=>
  string(5) "hello"
  [1]=>
  string(5) "world"
} 
```

编辑：也许你正在寻找这样的东西

```
<?php
$input = getData();
$w = preg_split('![\s[:punct:]]+!', $input, -1, PREG_SPLIT_NO_EMPTY);
$w = array_count_values($w);
arsort($w);
$ci = new CachingIterator( new ArrayIterator( $w ) );
foreach( $ci as $next=>$cnt ) {
    printf("%s(%d) %s(%d)\n",
        $next, $cnt,
        $ci->getInnerIterator()->key(), $ci->getInnerIterator()->current()
    );
}

function getData() {
    return <<< eot
Mary had a little lamb,
whose fleece was white as snow.

And everywhere that Mary went,
the lamb was sure to go.

It followed her to school one day
which was against the rules.

It made the children laugh and play,
to see a lamb at school.

And so the teacher turned it out,
but still it lingered near,

And waited patiently about,
till Mary did appear.

"Why does the lamb love Mary so?"
the eager children cry.

"Why, Mary loves the lamb, you know."
 the teacher did reply.
eot;
} 
```

哪个打印

```
the(8) lamb(5)
lamb(5) Mary(5)
Mary(5) was(3)
was(3) And(3)
And(3) to(3)
to(3) It(2)
It(2) school(2)
school(2) so(2)
so(2) Why(2)
Why(2) did(2)
did(2) it(2)
it(2) teacher(2)
teacher(2) children(2)
children(2) a(2)
a(2) waited(1)
waited(1) patiently(1)
patiently(1) about(1)
about(1) till(1)
[...]
white(1) went(1)
went(1) (0) 
```

见[http://docs.php.net/class.cachingiterator](http://docs.php.net/class.cachingiterator)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:39:57.577

这将提取前两个单词，无论有多少空格、制表符或换行符

```
$text = trim(preg_replace('/[\s\t\r\n]+/', ' ', $text));
$firstTwoWords = substr($text, 0, strpos($text, ' ', strpos($text, ' ') + 1)); 
```

# scala - 具有不同特征的元素的类型检查集合

> ID：10253025
> 
> 赞同：1
> 
> 时间：2012-04-20T20:20:09.510
> 
> 标签：scala, types, typechecking, traits

有什么方法可以强制执行返回某些内容的方法（以正则表达式表示）：

```
(T with A) (T with A with B)+ (T with B) 
```

如果我返回`Traversable[T]`，它会丢弃绑定的特征。同样，我不能 return `Traversable[T with A with B]`，因为这对于第一个和最后一个元素是不准确的。

我不知道如何解决这个问题。它在我的程序中引入了一些隐式条件，我觉得我正在通过使用`.asInstanceOf[]`强制转换来滥用类型系统。也许我使用了错误的数据结构？

这是我正在编写的代码示例，作为我的意思的示例。我正在寻求执行该`route`方法。该类`User`扩展了 type `T`，我省略了代码，因为有很多。

```
trait Producer extends User {
  def send(file: Data)
}

trait Consumer extends User {
  def receive(file: Data)
}

...

def route(sender: T with Producer, receiver: T with Consumer): Traversable[T]

def transfer(sender: T with Producer, receiver: T with Consumer, file: Data) {
  val path = route(sender, receiver)
  if (!path.isEmpty) {
    sender send file

    val nextHop = route(sender, receiver).tail.head

    nextHop.asInstanceOf[T with Consumer] receive file

    if (nextHop != receiver) {
      transfer(nextHop.asInstanceOf[T with Producer], receiver, file)
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:23:58.803

你绝对应该避免使用`.asInstanceOf[]`.

Scala 可以使用元组轻松地从一个方法返回多个值，那么为什么不返回一个 3 元组类型`(T with A, Traversable[T with A with B], T with B)`呢？

这是一个例子：

```
trait A
trait B
class T

def f(): (T with A, Traversable[T with A with B], T with B) = {
  (new T with A, List(new T with A with B), new T with B)
}

val (a, abs, b) = f() 
```

# sql - 长 SQL 文件运行 SQL Server 内存不足（22,000 行）

> ID：10253027
> 
> 赞同：8
> 
> 时间：2012-04-20T20:20:30.370
> 
> 标签：sql, sql-server-2008, memory, out-of-memory

我有一个`.sql`大约 22,000 行长的文件。它是由其他东西生成的，但基本上每行只包含一个更新语句。

在 SQL Server Management Studio 中运行文件时出现此错误。

> 资源池“内部”中的系统内存不足，无法运行此查询

我想我只需要拆分这个查询文件，但我不确定最好的方法。我可以将文件切成 2000 行块或我想的东西。

这似乎是一个简单的问题，我会经常这样做，我想提出一个好的解决方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T20:28:16.693

您可能希望通过[SQLCMD](http://msdn.microsoft.com/en-us/library/ms162773%28v=sql.105%29.aspx)而不是通过 SSMS GUI 界面运行脚本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-17T08:23:03.497

[我遇到了类似的问题，在博客](http://www.diaryofaninja.com/blog/2009/09/25/running-large-mssql-scripts-amp--resulting-memory-errors)的命令提示符下运行命令救了我。

```
 sqlcmd -S YOURSQLSERVER\INSTANCENAME -i "C:\Your Script.sql" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-20T20:45:56.253

您可能遇到了批处理大小的限制，因此 SQL Server 在解析批处理时遇到了问题。如果您可以运行大约 5000 行块（突出显示，执行），那么这将证实我的理论。

一旦你知道正确的批量大小，你可以：

1.  在两者之间插入 GO 语句，以强制执行新批处理
2.  拆分为多个文件

一个小shell脚本应该足够了。[split](http://unixhelp.ed.ac.uk/CGI/man-cgi?split)、[head](http://unixhelp.ed.ac.uk/CGI/man-cgi?head)和[tail](http://unixhelp.ed.ac.uk/CGI/man-cgi?tail)的[UnxUtils](http://unxutils.sourceforge.net/)应该很有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-24T02:49:52.833

我在 SQL Management Studio 上运行时遇到了同样的问题，我所做的是在命令行中执行它 osql –S localhost –d mydb –E –i .\hugescript.sql

[http://tutewall.com/cannot-execute-script-insufficient-memory-error-sql-server/](http://tutewall.com/cannot-execute-script-insufficient-memory-error-sql-server/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-21T16:33:29.343

您可以使用以下解决方案为服务器分配更多内存：

1.  在对象资源管理器中，右键单击服务器并选择属性。
2.  单击内存节点。
3.  在服务器内存选项下，为最小服务器内存和最大服务器内存输入所需的数量。

最大值的默认值为 2147483647 ，我将其更改为 9147483647 ，我的问题就解决了。

# c# - .NET 中是否有 Object1.CopyTo(Object2) 方法？

> ID：10253030
> 
> 赞同：0
> 
> 时间：2012-04-20T20:20:49.480
> 
> 标签：c#, .net, copy

> **可能重复：**
> [在 C# 中克隆对象](https://stackoverflow.com/questions/78536/cloning-objects-in-c-sharp)

我想要做的是将类中的值从一个对象复制到另一个对象。浅拷贝就好了。但是，我**不想丢失对象对列表**/array/ienumerable 的引用。另外，我**也不想**这样做：

```
public static void EditEvent(EventModel editEvent)
{
    EventModel changingEvent = EventRepository.getEvent(editEvent.EventID);
    changingEvent.Subject = editEvent.Subject;
    changingEvent.EventDate = editEvent.EventDate;
    changingEvent.EventDesc = editEvent.EventDesc;
    changingEvent.DayCode = editEvent.DayCode;
} 
```

反而：

```
public static void EditEvent(EventModel editEvent)
{
    EventModel changingEvent = EventRepository.getEvent(editEvent.EventID);
    changingEvent.CopyFrom(editEvent);
    //or
    editEvent.CopyTo(changingEvent);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:29:48.593

你可以这样做

```
public class MyClonableClass : ICloneable
{
    public object Clone()
    {
        return this.MemberwiseClone();
    }
} 
```

如果您更喜欢使用强类型方法，只需忘记接口

```
public class MyClonableClass
{
    public MyClonableClass Clone()
    {
        return (MyClonableClass)this.MemberwiseClone();
    }
} 
```

* * *

这不会将一个对象的字段复制到另一个对象，而是创建一个与原始对象完全相同的新对象。它制作了一个浅拷贝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:32:32.823

这是我今天写的代码。它通过了简单的测试。我想你可以用它来开始。

这是测试：

```
 /// <summary>
    ///A test for MapProperties
    ///</summary>
    public void MapPropertiesTestHelper<S, T>(S source, T target1, bool failIfNotMatched)
    {
        Cake.Common.Mapper<S, T> target = new Cake.Common.Mapper<S, T>();
        target.MapProperties(source, target1, failIfNotMatched);
    }

    [TestMethod()]
    public void MapPropertiesTest()
    {
        var source = new Source {
            OneTwo = 10,
            ThreeFour = "foo"
        };

        var target = new Target {
            OneTwo = 10,
            ThreeFour = "bar"
        };

        MapPropertiesTestHelper<Source, Target>(source, target, true);

        Assert.AreEqual(source.OneTwo, target.OneTwo);
        Assert.AreEqual(source.ThreeFour, target.ThreeFour);
        Assert.AreEqual(source.five_six, target.FiveSix);
    }

    public class Source
    {
        public int OneTwo { get; set; }
        public string ThreeFour { get; set; }
        public bool five_six { get; set; }
    }

    public class Target
    {
        public int OneTwo { get; set; }
        public string ThreeFour { get; set; }
        public bool FiveSix { get; set; }
    } 
```

这是代码：

```
public class MapperItem
{
    public MapperItem(MemberInfo member, object o)
    {
        this.Member = member;
        this.Object = o;
    }

    public MemberInfo Member 
    { 
        get; 
        set; 
    }

    public object Object
    {
        get;
        set;
    }

    public Type Type
    {
        get
        {
            return this.Member.UnderlyingType();
        }
    }

    public object Value
    {
        get
        {
            if (this.Member is PropertyInfo)
            {
                return (this.Member as PropertyInfo).GetValue(this.Object, null);
            }
            else if (this.Member is FieldInfo)
            {
                return (this.Member as FieldInfo).GetValue(this.Object);
            }
            else
            {
                throw new Exception("sourceMember must be either PropertyInfo or FieldInfo");
            }
        }
    }

    public object Convert(Type targetType)
    {
        object converted = null;

        if (this.Value == null)
        {
            return converted;
        }
        else if (targetType.IsAssignableFrom(this.Type))
        {
            converted = this.Value;
        }
        else
        {
            var conversionKey = Tuple.Create(this.Type, targetType);
            if (Conversions.ContainsKey(conversionKey))
            {
                converted = Conversions[conversionKey](this.Value);
            }
            else
            {
                throw new Exception(targetType.Name + " is not assignable from " + this.Type.Name);
            }
        }

        return converted;
    }

    public void Assign(object value)
    {
        if (this.Member is PropertyInfo)
        {
            (this.Member as PropertyInfo).SetValue(this.Object, value, null);
        }
        else if (this.Member is FieldInfo)
        {
            (this.Member as FieldInfo).SetValue(this.Object, value);
        }
        else
        {
            throw new Exception("destinationMember must be either PropertyInfo or FieldInfo");
        }
    }

    public static Dictionary<Tuple<Type, Type>, Func<object, object>> Conversions = new Dictionary<Tuple<Type, Type>, Func<object, object>>();
}

public class Mapper<S, T>
{
    private List<string> ignoreList = new List<string>();
    public List<string> IgnoreList
    {
        get { return ignoreList; }
        set { ignoreList = value; }
    }

    public void MapProperties(S source, T target, bool failIfNotMatched = true)
    {
        foreach (PropertyInfo property in source.GetType()
                                                      .GetProperties()
                                                      .Where(c => !IgnoreList.Contains(c.Name)))
        {
            try
            {
                var sourceField = new MapperItem(property, source);
                var targetField = new MapperItem(MatchToTarget(property), target);
                targetField.Assign(sourceField.Convert(targetField.Type));
            }
            catch (TargetNotMatchedException noMatch)
            {
                if (failIfNotMatched)
                {
                    throw noMatch;
                }
            }
        }
    }

    private MemberInfo MatchToTarget(MemberInfo member)
    {
        List<MemberInfo> members = new List<MemberInfo>();
        members.AddRange(typeof(T).GetProperties());
        members.AddRange(typeof(T).GetFields());

        var exactMatch = from c in members where c.Name == member.Name select c;

        if (exactMatch.FirstOrDefault() != null)
        {
            return exactMatch.First();
        }

        var sameAlphaChars = from c in members
                             where NormalizeName(c.Name) == NormalizeName(member.Name)
                             select c;

        if (sameAlphaChars.FirstOrDefault() != null)
        {
            return sameAlphaChars.First();
        }

        throw new TargetNotMatchedException(member, typeof(T));
    }

    private static string NormalizeName(string input)
    {
        string normalized = input.Replace("_", "").ToUpper();
        return normalized;
    }
}

public class TargetNotMatchedException : Exception
{
    public TargetNotMatchedException(MemberInfo member, Type type)
        : base("no match for member named " + member.Name + " with type named " + type.Name)
    {
        this.Member = member;
        this.Type = type;
    }
    public MemberInfo Member { get; set; }
    public Type Type { get; set; }
}

public static class ReflectionExtensions
{
    public static Type UnderlyingType(this MemberInfo member)
    {
        Type type;
        switch (member.MemberType)
        {
            case MemberTypes.Field:
                type = ((FieldInfo)member).FieldType;
                break;
            case MemberTypes.Property:
                type = ((PropertyInfo)member).PropertyType;
                break;
            case MemberTypes.Event:
                type = ((EventInfo)member).EventHandlerType;
                break;
            default:
                throw new ArgumentException("MemberInfo must be if type FieldInfo, PropertyInfo or EventInfo", "member");
        }
        return Nullable.GetUnderlyingType(type) ?? type;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:28:51.480

你需要[Object.MemberwiseClone 方法](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx)

# android - Android 按钮的文本未以指定的颜色显示

> ID：10253043
> 
> 赞同：0
> 
> 时间：2012-04-20T20:21:56.103
> 
> 标签：android, button, text, spannable

我有一个非常简单的问题。我正在使用活动中的方法创建几个按钮。然而，文本颜色只是保持标准颜色（灰色）。我在我的方法中定义了以下内容：

```
Button b = new Button(this);
b.setTextColor(R.color.red);
b.setText("Some text"); 
```

有人知道这个问题并且可以帮助我吗？通过谷歌搜索，我阅读了某事。关于可扩展的。但是，这似乎不适用于按钮的文本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:25:40.537

`R.color.red`是一个资源标识符（在他们使用的 Android 中`Integers`）。您需要像这样使用该代码：

```
Resources res = getResources();
int red = res.getColor(R.color.red);

Button b = new Button(this);
b.setTextColor(red);
b.setText("Some text"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T20:24:13.530

你需要先打电话`getResources()`告诉它你想要什么颜色。

```
getResources().getColor(color) 
```

# sql - SQL 查询未获取所有内容

> ID：10253049
> 
> 赞同：0
> 
> 时间：2012-04-20T20:22:17.833
> 
> 标签：sql, database

我正在尝试从两个表中获取数据，但它似乎并没有提取所有符合条件的记录。

这是我的查询：

```
SELECT Parts."Part Number",Parts."Description",Parts."Location",Parts."Qty In Stock",Parts."LastCost",Parts."Cost Price",Parts."Retail Price",Transact."Type"
FROM Transact
INNER JOIN Parts
ON Transact."PartNumber"=Parts."Part Number"
WHERE Transact.Type = 'Non-stock Purch' 
```

我正在尝试提取每条具有“非库存采购”的记录，然后从零件数据库中提取该零件的描述，因此我包含了“描述”、“成本”、“最后成本”等.

我在查询中做错了什么，这意味着它不会获取所有需要的信息，如果我运行：

```
select * from transact x
where x.Type = 'Non-stock Purch'
order by x.PartNumber 
```

这将返回 268 条记录，我之前的查询*应该*返回相同的数字，但实际上只返回 111，我知道它们必须存在于另一个表中（我也检查过（以防出现问题））。

此外，如果我错误地编写了这些查询或格式不正确，请告诉我！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:31:21.727

Parts 表可能没有与 Transact 表中的记录匹配的记录。您正在执行 INNER JOIN；如果 Parts 中没有记录的部件号出现在 Transact 的记录中，则不会返回任何行。

如果您想要 Transact 中的所有记录，以及 Parts 中的数据（如果存在），您可以执行 LEFT JOIN；如果没有匹配项，则 Parts 中的所有列都将在结果中为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:56:34.093

我认为您的表可能没有与 Transact 表中的记录匹配的记录。

# database - 如果 C# ASP.NET (VS 2008) DB 包含希伯来语字符，则它会忽略 INSERT

> ID：10253053
> 
> 赞同：0
> 
> 时间：2012-04-20T20:22:33.817
> 
> 标签：database, visual-studio-2008, encode

目前我正在为学校做一个项目，但我无法解决这个问题。

我有一个表格，如果您向其中插入英文字符，它可以正常工作并且信息被插入到数据库中，但是如果我插入希伯来字符（@form），什么也不会发生。

现在，澄清一下，我已经测试了 100%，即使我插入希伯来字符，它也会进入包含 sql 插入的“if”块。

整个项目由 Visual Studio Web Developer 2008 管理。

如果我手动插入希伯来语写入值，数据库能够存储它们并输出，但是当尝试更新这些单元格（@form）时，希伯来语中的所有字符都会变成问号。

谁能帮我？我真的很感激。

谢了，兄弟们

编辑：

这是我的插入查询：（错误是一个`List<string>`，接下来是 MyAdoHelper.cs）

```
if (Errors.Count == 0)
{
      string Add_Member = "INSERT INTO members (name, password, email, gender, registration_date) VALUES ('" + Nickname + "', '" + Password + "', '" + Email + "', '" + Gender + "', '" + DateTime.Now.ToString() + "')";

      MyAdoHelper.DoQuery(GlobalVar.DatabaseName, Add_Member);

      Errors.Add(GlobalVar.GlobalStatus["Register_Success"]);
} 
```

MyAdoHelper.cs：

```
public class MyAdoHelper
{
    public MyAdoHelper()
    {
    }

    public static SqlConnection ConnectToDb(string fileName)
    {
        string path = @"C:\Users\Guy\Desktop\Project\App_Data\";
        path += fileName;
        string connString = @"Data Source=.\SQLEXPRESS;AttachDbFilename=" +
                             path +
                             ";Integrated Security=True;User Instance=True";
        SqlConnection conn = new SqlConnection(connString);
        return conn;
    }

    public static void DoQuery(string fileName, string sql)
    {
        SqlConnection conn = ConnectToDb(fileName);
        conn.Open();
        SqlCommand com = new SqlCommand(sql, conn);
        com.ExecuteNonQuery();
        com.Dispose();
        conn.Close();
    }

    public static int RowsAffected(string fileName, string sql)       
    {
        SqlConnection conn = ConnectToDb(fileName);
        conn.Open();
        SqlCommand com = new SqlCommand(sql, conn);
        int rowsA = com.ExecuteNonQuery();
        conn.Close();
        return rowsA;
    }

    public static bool IsExist(string fileName, string sql)
    {
        SqlConnection conn = ConnectToDb(fileName);
        conn.Open();
        SqlCommand com = new SqlCommand(sql, conn);
        SqlDataReader data = com.ExecuteReader();
        bool found;
        found = (bool)data.Read();

        conn.Close();
        return found;
    }

    public static DataTable ExecuteDataTable(string fileName, string sql)
    {
        SqlConnection conn = ConnectToDb(fileName);
        conn.Open();
        SqlDataAdapter tableAdapter = new SqlDataAdapter(sql, conn);
        DataTable dt = new DataTable();
        tableAdapter.Fill(dt);
        return dt;
    }

    public static void ExecuteNonQuery(string fileName, string sql)
    {
        SqlConnection conn = ConnectToDb(fileName);
        conn.Open();
        SqlCommand command = new SqlCommand(sql, conn);
        command.ExecuteNonQuery();
        conn.Close();
    }

    public static int CountTableRows(string TableName)
    {
        SqlConnection Conn = MyAdoHelper.ConnectToDb(GlobalVar.DatabaseName);
        Conn.Open();
        string TotalRows = "SELECT COUNT(*) FROM " + TableName;
        SqlCommand Cmd = new SqlCommand(TotalRows, Conn);
        return (int)Cmd.ExecuteScalar();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:41:50.737

我认为，您在数据库中将 nvarchars 用于希伯来字符字段...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:55:27.807

如果您使用 microsoft sql server，请尝试类似的操作。

```
INSERT INTO tabelle (Spalte) VALUES (N'äüö'); 
```

并确保您使用`nvarchar`

# php - CodeIgniter 电子邮件在配置文件中不起作用

> ID：10253061
> 
> 赞同：0
> 
> 时间：2012-04-20T20:23:16.760
> 
> 标签：php, email, codeigniter, configuration

事实证明，当我在名为 email.php 的配置文件中拥有 SMTP 的信息时，CodeIgniter 电子邮件不起作用

但是，当我这样做时，它确实可以正常工作：

```
$config = array(*smtp info*);
$this->load->library('email', $config); 
```

并且与我在配置文件中尝试的相同服务器具有完全相同的信息。谁能给我一个线索为什么会这样？

Ion auth 现在不会发送电子邮件，所以我更愿意让这个配置文件正常工作。我想这也是问题所在。

**编辑：** 不知何故它现在工作，不知道为什么。我尝试更改自动加载并创建了一个新的 email.php 配置文件。我将传出服务器更改为另一台本地服务器，并且可以正常工作。但是在我直接使用 lib 加载加载配置之前，它仍然可以正常工作。不知道为什么会这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T07:05:07.367

如果您在 config/email.php 中设置配置选项，然后在控制器中调用：

```
$this->load->library('email'); 
```

它应该工作。

但是，正如我所怀疑的，如果您在 config/email.php 中设置配置选项，然后在您的控制器中调用：

```
$this->load->library('email', $config) 
```

它不起作用，因为您正在使用空的 $config 数组“覆盖”电子邮件库配置。

# android - 活动回到surfaceview“工作”出现错误

> ID：10253062
> 
> 赞同：1
> 
> 时间：2012-04-20T20:23:25.593
> 
> 标签：android, android-intent, surfaceview

所以我在一个网站上找到了一个游戏，我试图用一些功能来扩展它，但我遇到了一些问题。

首先，我得到了一个表面视图、线程和一个游戏结束活动。游戏结束后，我重定向到游戏结束活动：

```
 synchronized (holder){
                    Intent gameOverScreen = new Intent();
                    gameOverScreen.setClassName("packagename", "packagename.GameOverScreen");
                    ((Activity) context).startActivity(gameOverScreen); 
```

在游戏结束活动中，我有一个“重试”按钮，它重定向回游戏视图，但随后弹出一个错误并要求我强制关闭我的应用程序，当我按下强制关闭按钮时，它会重定向，因为代码如下所示：

```
 public void onClick(View v){
            Intent i = new Intent();
            i.setClassName("packagename", "packagename.GameView");
            startActivity(i);
            finish();
        } 
```

所以我的问题是如何避免这个错误，因为代码“有效”，但我需要按下弹出的强制关闭按钮。我是 Java 和游戏开发的新手。

提前致谢！

编辑日志猫：

```
04-20 20:58:02.022: D/Main(1484): Stopping...
04-20 20:58:08.843: D/AndroidRuntime(1484): Shutting down VM
04-20 20:58:08.843: W/dalvikvm(1484): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
04-20 20:58:08.843: E/AndroidRuntime(1484): Uncaught handler: thread main exiting due to uncaught exception
04-20 20:58:08.888: E/AndroidRuntime(1484): android.content.ActivityNotFoundException: Unable to find explicit activity class {com.edu4java.android.killthemall/com.edu4java.android.killthemall.GameView}; have you declared this activity in your AndroidManifest.xml?
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1404)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1378)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.app.Activity.startActivityForResult(Activity.java:2749)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.app.Activity.startActivity(Activity.java:2855)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at com.edu4java.android.killthemall.GameOverScreen$1.onClick(GameOverScreen.java:19)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.view.View.performClick(View.java:2364)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.view.View.onTouchEvent(View.java:4179)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.widget.TextView.onTouchEvent(TextView.java:6541)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.view.View.dispatchTouchEvent(View.java:3709)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1659)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1107)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.app.Activity.dispatchTouchEvent(Activity.java:2061)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1643)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1691)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.os.Looper.loop(Looper.java:123)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at android.app.ActivityThread.main(ActivityThread.java:4363)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at java.lang.reflect.Method.invokeNative(Native Method)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at java.lang.reflect.Method.invoke(Method.java:521)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-20 20:58:08.888: E/AndroidRuntime(1484):     at dalvik.system.NativeStart.main(Native Method)
04-20 20:58:08.903: I/dalvikvm(1484): threadid=7: reacting to signal 3
04-20 20:58:08.903: E/dalvikvm(1484): Unable to open stack trace file '/data/anr/traces.txt': Permission denied
04-20 20:58:16.883: I/Process(1484): Sending signal. PID: 1484 SIG: 9 
```

# java - JTA CMT 事务管理

> ID：10253074
> 
> 赞同：1
> 
> 时间：2012-04-20T20:24:16.303
> 
> 标签：java, jakarta-ee, jboss, jta, java-transaction-service

在 JBoss 5.1 环境中，我有一个 EJB 客户端，它通过查找远程 UserTransaction 接口来启动事务。服务器上的 EJB bean 处理几个客户端调用，然后客户端执行 ut.commit(); 在一个全局事务中完成的所有操作。

我试图了解它是如何在幕后工作的——服务器知道通过 EJB RMI 连接的 clientId 并且每个调用都使用相同的事务。这是否意味着连接池将基于某些上下文数据将相同的物理数据库连接返回到该会话？在这种情况下，什么样的资源被标记为忙碌，比如当客户端在一个事务中执行 10 次调用时，服务器资源将被阻塞（据我所知，至少有一个数据库连接）

什么是最好的参考资源。我知道 EJB 规范是其中之一，但它没有提供足够的信息来实现应该如何工作，第二个来源显然是源代码和调试器......还有什么？

# sql-server - SQL Server 中特定时区的当地时间

> ID：10253082
> 
> 赞同：4
> 
> 时间：2012-04-20T20:24:51.787
> 
> 标签：sql-server, azure-sql-database

我正在移植现有应用程序以在 Windows Azure 上运行。我们当前的解决方案在很大程度上依赖于 Windows 在 SQL Server 上设置的时区。我们`GETDATE()`在存储过程和视图中使用得非常频繁。问题是 SQL Azure 使用 UTC 时区运行。我正在尝试用方法调用替换`GETDATE()`方法调用，该方法调用将根据数据库中的时区设置获取时间。我遇到的问题是夏令时。有没有人用 SQL 编写过可以返回当前日期/时间并正确调整 DST 的方法？

我猜我会得到一些答案，说我应该全面使用 UTC 时间。由于我不想解释的原因，这似乎不是一个选择。

您能给我的任何帮助/建议将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T20:34:57.777

我们决定将相关列更新`DateTimeOffset`为`DateTime`.

感谢所有回复的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T07:34:34.083

我不知道这是否会帮助你。但这会在 SERVER 注册表上执行注册表读取。在本地上下文中，您可以确定服务器时区和 GMT 之间的差异，并从那里执行您需要的必要计算。我从其他论坛帖子中学到的一个有用的小技巧（信用就在那里）。

```
Use Master
Go

DECLARE @ZONEDIFF INT

EXECUTE dbo.xp_regread 'HKEY_LOCAL_MACHINE','SYSTEM\CurrentControlSet\Control\TimeZoneInformation','ActiveTimeBias', @ZONEDIFF OUT

SELECT getdate() AS MyTime, dateadd(minute, @ZONEDIFF, getdate() ) as SERVERZONE 
```

让我知道它是否有帮助或者我对您的理解不正确。

苹果电脑

# html - 浏览器窗口缩小时防止网站“折叠”

> ID：10253087
> 
> 赞同：2
> 
> 时间：2012-04-20T20:24:34.527
> 
> 标签：html

我有一个顶部有水平 ul/li 按钮的站点。如果有人缩小窗口，按钮就会折叠成两排。这有点丑。

我举了一个例子：

[http://www.redolog.com](http://www.redolog.com)

我想知道是否有一个布局指令说“看，你必须至少有 800 宽，否则，你必须滚动”并在底部创建一个滚动条而不是“折叠”网站？

那有意义吗？还是我傻？:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T20:26:36.947

把它放在你的CSS中：

```
body { min-width: 800px } 
```

# ruby-on-rails - 为什么'cap deploy:migrations'不像'before :deploy'那样调用我的回调？

> ID：10253093
> 
> 赞同：0
> 
> 时间：2012-04-20T20:25:51.173
> 
> 标签：ruby-on-rails, capistrano

cap deploy:migrations 应该运行与“cap deploy”加迁移相同的东西。但它不会触发我的回调，例如'before :deploy'。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T05:20:24.133

这是一个错误（或未实现，取决于您如何看待它），您可以在此处找到更多信息：[https ://github.com/capistrano/capistrano/issues/198](https://github.com/capistrano/capistrano/issues/198)

# java - 在 GUI 中显示时间

> ID：10253097
> 
> 赞同：1
> 
> 时间：2012-04-20T20:25:58.707
> 
> 标签：java, swing, timer, jlabel

我正在做一个非常简单的个人项目，但这是一个更大项目的一部分。任何帮助表示赞赏。这是我的代码，输出错误，当我运行它时，它显示一个大窗口和一个单独的小窗口显示时间。正确的方法应该是在 JLabel 的大框架中显示时间。

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
//package Employees;

import java.text.SimpleDateFormat;
import java.util.Date;
import javax.swing.JFrame;
import javax.swing.JLabel;

public class DateShowAPII extends javax.swing.JFrame {

/**
 * Creates new form DateShowAPI
 */
public DateShowAPII() {
    initComponents();
}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">
private void initComponents() {

    JLabel = new javax.swing.JLabel();
    jLabel2 = new javax.swing.JLabel();

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

    jLabel2.setText("Time");

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addGap(104, 104, 104)
            .addComponent(jLabel2)
            .addGap(28, 28, 28)
            .addComponent(JLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addContainerGap(179, Short.MAX_VALUE))
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING,    layout.createSequentialGroup()
            .addContainerGap(139, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                .addComponent(JLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(jLabel2))
            .addGap(132, 132, 132))
    );

    pack();
}// </editor-fold>

/**
 * @param args the command line arguments
 */
public static void main(String args[]) {

    JFrame frame = new JFrame();

    String date = new SimpleDateFormat("hh:mm:ss").format(new Date());
    JLabel l = new JLabel(date);

    frame.getContentPane().add(l);

    frame.pack();
    frame.setLocationRelativeTo(null);
    frame.setVisible(true);

    java.awt.EventQueue.invokeLater(new Runnable() {

        public void run() {
            new DateShowAPII().setVisible(true);
        }
    });
}
// Variables declaration - do not modify
private javax.swing.JLabel JLabel;
private javax.swing.JLabel jLabel2;
// End of variables declaration
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:31:28.483

`DateShowAPII`是一个框架（那是大框架），主要是，您创建另一个框架（并打包它）——随着时间的推移，那是小的框架。

相反，不要创建另一个框架并将 JLabel 添加到`DateShowAPII`您创建的新框架中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T20:34:14.723

1）你声明了两个`JFrames`

> DateShowAPII 扩展 javax.swing.JFrame

和

> JFrame 框架 = 新的 JFrame();

看起来和内容一样

2) 使用[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)并从[Swing Action](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)开火`JLabel#setText(date)`

3) 不要使用 resered Java 方法名作为变量或类名，意思是

```
JLabel = new javax.swing.JLabel(); 
```

重命名为

```
myJLabel = new javax.swing.JLabel(); 
```

# java - 是个 需要参数吗？

> ID：10253098
> 
> 赞同：3
> 
> 时间：2012-04-20T20:26:13.043
> 
> 标签：java, deployment, jnlp, java-web-start

我有一个应用程序的有效 webstart 部署。 [这篇文章](https://stackoverflow.com/questions/8388360/java-how-to-get-ip-address-automaticallly-in-jnlp-file)说我可以省略 codebase 参数。 [文档](http://docs.oracle.com/javase/6/docs/technotes/guides/jweb/applet/codebase_determination.html)说 codebase 参数是可选的。

当我省略代码库参数或使用

```
codebase="" 
```

我的 Web 启动应用程序无法启动，因为它正在下载 .jnlp 文件的目录中查找可执行的 .jar 文件。

我想省略 codebase 参数，因为这个特定的 webstart 应用程序将部署到几个不同的服务器上，我不想为每个服务器自定义 .jnlp 文件。

jnlp 代码库参数的正确故事是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T06:55:24.520

那个帖子不正确。唯一可以省略文档库的 JNLP 是那些用于部署**嵌入式小程序**的 JNLP 。在这种情况下，代码库将默认位于包含 HTML 的同一目录中。

*框架或自由浮动小程序的启动文件需要代码库。*

* * *

`codebase=""`

顺便说一句，这是一个具有空值的属性，而不是省略的属性/值对。对于上面提到的嵌入式小程序，您根本不会包含它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-16T04:16:41.617

从 Java SE 7 开始，来自[这里](https://docs.oracle.com/javase/tutorial/deployment/deploymentInDepth/deployingWithoutCodebase.html)的规范：

> 从 Java SE 7 版本开始，您不必为 Java Web Start 应用程序的 Java 网络启动协议 (JNLP) 文件中的代码库属性指定绝对路径。您可以在不同的环境中开发和测试您的应用程序，而无需修改代码库属性中的路径。如果未指定代码库，Java Web Start 软件假定代码库与启动 Java Web Start 应用程序的网页相关。

***如果未指定代码库，Java Web Start 软件假定代码库与启动 Java Web Start 应用程序的网页相关。***

# ruby - 在 Ruby 中动态创建多维哈希

> ID：10253105
> 
> 赞同：8
> 
> 时间：2012-04-20T20:26:38.987
> 
> 标签：ruby, hash

我是一名 PHP 开发人员，正在尝试精通 Ruby。我现在正在努力的一个项目是一个源代码审计工具，它可以扫描 webapp 文件以查找几种 web 编程语言中的潜在危险功能。找到匹配项后，脚本会将相关信息保存在`poi`（兴趣点）类中，以便稍后显示。

该类的示例实例如下所示（以 YAML 建模）：

```
poi:
    file_type: "php"
    file: "the-scanned-file.php"
    line_number: 100
    match: "eval()"
    snippet: "echo eval()" 
```

在展出时，我想像这样组织这些兴趣点：

```
- file_type
-- file
--- match (the searched payload) 
```

因此，在演示之前，我试图将一个平面`poi`对象数组构造成一个哈希镜像上面的结构。这将允许我简单地遍历散列中的项目以生成所需的屏幕组织。（或者至少，这是计划。）

现在，对于我的问题：我如何在 Ruby 中做到这一点？

在 PHP 中，我可以很容易地做这样的事情：

```
<?php

$sorted_pois = array();
foreach($points_of_interest as $point){
    $sorted_pois[$point->file_type][$point->file][$point->match][] = $point;
}

?> 
```

我试过像这样将这种想法从 PHP 翻译成 Ruby，但无济于事：

```
sorted_pois = {}
@points_of_interest.each_with_index do |point, index|
    sorted_pois[point.file_type.to_sym][point.file.to_sym][point.match.to_sym].push point
end 
```

我在这上面花了几个小时，此时我有点把头撞在墙上，所以大概我离基地很远。在 Ruby 中处理这个问题的正确方法是什么？

**更新：**

作为参考，这是我定义的精确方法：

```
# sort the points of interest into a structured hash
def sort
  sorted_pois = {}
  @points_of_interest.each_with_index do |point, index|
    sorted_pois[point.file_type.to_sym][point.file.to_sym][point.match.to_sym].push point
  end
end 
```

这是我在运行代码时收到的错误：

```
./lib/models/vulnscanner.rb:63:in `sort': undefined method `[]' for nil:NilClass (NoMethodError)
    from /usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `each_with_index'
    from ./lib/models/vulnscanner.rb:62:in `each'
    from ./lib/models/vulnscanner.rb:62:in `each_with_index'
    from ./lib/models/vulnscanner.rb:62:in `sort'
    from ./webapp-vulnscan:69 
```

第 62 行（正如您可能推断的那样）尤其是这一行：

```
@points_of_interest.each_with_index do |point, index| 
```

作为附加参考，以下是转换为 YAML 时的（一段）`@points_of_interest`外观：

```
- !ruby/object:PoI 
  file: models/couponkimoffer.php
  file_type: php
  group: :dangerous_functions
  line_number: "472"
  match: `
  snippet: ORDER BY `created_at` DESC
- !ruby/object:PoI 
  file: models/couponkimoffer.php
  file_type: php
  group: :dangerous_functions
  line_number: "818"
  match: `
  snippet: WHERE `company_slug` = '$company_slug'
- !ruby/object:PoI 
  file: models/couponkimoffer.php
  file_type: php
  group: :dangerous_functions
  line_number: "819"
  match: `
  snippet: ORDER BY `created_at` DESC 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-20T20:48:54.497

@John 的`Enumerable#group_by`建议是解决您需求的一种好方法。另一种方法是创建一个自动激活的哈希（就像你在 PHP 中看到的那样），如下所示：

```
hash = Hash.new{ |h,k| h[k] = Hash.new(&h.default_proc) }
hash[:a][:b][:c] = 42
p hash
#=> {:a=>{:b=>{:c=>42}}} 
```

请注意，如果您访问不存在的密钥，这种自动激活可能是“危险的”，因为它会为您创建它们：

```
p hash["does this exist?"]
#=> {}

p hash
#=> {:a=>{:b=>{:c=>42}}, "does this exist?"=>{}} 
```

如果您先测试钥匙，您仍然可以使用激活`default_proc`而不遇到这种危险：`key?`

```
val = hash["OH NOES"] if hash.key?("OH NOES")
#=> nil

p hash
#=> {:a=>{:b=>{:c=>42}}, "does this exist?"=>{}} 
```

* * *

FWIW，你得到的错误说，*“嘿，你把`[]`评估为 的东西放在后面`nil`，并且`nil`没有`[]`方法。”* 具体来说，您的代码...

```
sorted_pois[point.file_type.to_sym] 
```

评估为`nil`（因为散列还没有这个键的值），然后你试图要求

```
nil[point.file.to_sym] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-20T20:43:12.667

您可能对[group_by](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-group_by)感兴趣。

示例用法：

```
birds = ["Golden Eagle", "Gyrfalcon", "American Robin",
         "Mountain BlueBird", "Mountain-Hawk Eagle"]
grouped_by_first_letter = birds.group_by { |s| s[0] }

# { "G"=>["Golden Eagle", "Gyrfalcon"], "A"=>["American Robin"],
#   "M"=>["Mountain BlueBird", "Mountain-Hawk Eagle"] } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T20:42:24.383

上面示例的明显问题是您尝试使用的嵌套哈希和数组不存在。试试这个：

```
sorted_pois = {}
pois.each do |point|
  # sanitize data - convert to hash of symbolized keys and values
  poi = Hash[ %w{file_type file match}.map do |key| 
    [key.to_sym, point.send(key).to_sym]
  end ]

  # create nested hash/array if it doesn't already exist
  sorted_pois[ poi[:file_type] ] ||= {}
  sorted_pois[ poi[:file_type] ][ poi[:file] ] ||= {}
  sorted_pois[ poi[:file_type] ][ poi[:file] ][ poi[:match] ] ||= []

  sorted_pois[ poi[:file_type] ][ poi[:file] ][ poi[:match] ] << point
end 
```

# c# - 如何阻止文本框中的第一个字符为“。”？

> ID：10253107
> 
> 赞同：0
> 
> 时间：2012-04-20T20:26:55.210
> 
> 标签：c#, .net, winforms, textbox, keypress

这是我目前拥有的代码：

```
private void textBox_KeyPress(object sender, KeyPressEventArgs e)
{
    e.Handled = !char.IsDigit(e.KeyChar) && !char.IsControl(e.KeyChar) && e.KeyChar != '.';
    if (e.KeyChar == '.' && (sender as TextBox).Text.IndexOf('.') > -1) e.Handled = true; 

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T20:34:35.623

KeyPress 不足以进行这种验证。绕过它的一种简单方法是使用 Ctrl+V 将文本粘贴到文本框中。或者上下文菜单，根本没有关键事件。

在这种特定情况下，TextChanged 事件将完成工作：

```
 private void textBox_TextChanged(object sender, EventArgs e) {
        var box = (TextBox)sender;
        if (box.Text.StartsWith(".")) box.Text = "";
    } 
```

但是验证数值还有很多。您还需要拒绝 1.1.1 或 1.-2 等内容。请改用 Validating 事件。在表单上放置一个 ErrorProvider 并像这样实现事件：

```
 private void textBox_Validating(object sender, CancelEventArgs e) {
        var box = (TextBox)sender;
        decimal value;
        if (decimal.TryParse(box.Text, out value)) errorProvider1.SetError(box, "");
        else {
            e.Cancel = true;
            box.SelectAll();
            errorProvider1.SetError(box, "Invalid number");
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:43:51.013

您可能想要使用 TextChanged 事件，因为用户可以粘贴值。为了获得满足要求的最佳体验，我建议简单地删除所有前导`.`字符。

```
void textBox1_TextChanged(object sender, EventArgs e)
{
  if (textBox1.Text.StartsWith("."))
  {
    textBox1.Text = new string(textBox1.Text.SkipWhile(c => c == '.').ToArray());
  }
} 
```

这并没有解决仅使用数字的要求 - 如果是这种情况，问题中并不清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:10:55.400

这也适用于复制和粘贴。

```
 private void textBox1_KeyUp(object sender, KeyEventArgs e)
    {
        int decimalCount=0;
        string rebuildText="";
        for(int i=0; i<textBox1.Text.Length; i++)
        {
            if (textBox1.Text[i] == '.')
            {
                if (i == 0) break;
                if (decimalCount == 0)
                    rebuildText += textBox1.Text[i];
                decimalCount++;
            }
            else if ("0123456789".Contains(textBox1.Text[i]))
                rebuildText += textBox1.Text[i];
        }
        textBox1.Text = rebuildText;    
        textBox1.SelectionStart = textBox1.Text.Length;

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T21:54:22.787

你可以试试这个：

```
private void TextBox_TextChanged(object sender, EventArgs e)        
{        
        TextBox.Text = TextBox.Text.TrimStart('.');        
} 
```

# ios - 使用 iphone 在 Mac 上触发事件

> ID：10253108
> 
> 赞同：0
> 
> 时间：2012-04-20T20:27:04.823
> 
> 标签：ios, cocoa-touch, cocoa, remote-access, launchd

是否有任何示例代码/开源代码可用于说明如何在带有 iOS 设备的 Mac 上触发事件？我想要说的是单击 iOS 应用程序上的一个按钮，这会触发 MAC 上的一些事件，该事件可能正在运行一个守护进程来监听这个触发器？有任何想法吗 ？我有兴趣写这个只是为了学习目的。我的思路可能是我需要设计我自己的小协议，让守护进程和 iOS 应用程序都可以理解，然后相互通信。还有其他推荐的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T02:26:09.420

您可以设置一个小型 Web 服务器进程以在 Mac 上运行并通过自定义的基于 REST 的 API 接受调用。

# c# - 包含页面的 OnLoadComplete 后触发 ASP 用户控件事件

> ID：10253110
> 
> 赞同：1
> 
> 时间：2012-04-20T20:27:15.763
> 
> 标签：c#, asp.net, visual-studio-2010

我有一个用户控件“UserApplianceControl”，我需要将其动态添加到asp 页面。

我正在使用以下代码这样做：

用户.aspx.cs

```
protected override void OnLoadComplete(EventArgs e)
    {

        base.OnLoadComplete(e);
        A5Lib.User u;
        UserServiceReference.UserServicesClient myProxy = new UserServiceReference.UserServicesClient();
        u = myProxy.GetUser("user1");

        if (listOfAppliances != null)
        {

            foreach (A5Lib.Appliance str in u.Appliances)
            {
                UserApplianceControl uac = (UserApplianceControl)LoadControl("UserApplianceControl.ascx");
                uac.setAppliance(str);
                Panel1.Controls.Add(uac);
            }
        }
    } 
```

在 UserApplianceControl 中，我有几个按钮。但是，每当我按下按钮时，用户控件的按钮处理程序都不会被调用。实际上，首先调用 OnLoadComplete(above)，因此在最后一次加载页面时填充的那些控件被重新创建，并且在处理事件之前我丢失了旧的。

为什么事件没有在 OnLoadComplete 之前触发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:46:22.553

您在页面生命周期中重新创建控件为时已晚。

动态添加的控件必须在 onInit 之前出现（加载），才能使任何视图状态/回发功能正常工作。

将您的代码移动到页面的 OnInit 事件。这将确保在视图状态恢复之前重建所有控件，并且页面完成所有按钮/事件连接。

# c# - 反射字符串时抛出的参数计数不匹配

> ID：10253111
> 
> 赞同：3
> 
> 时间：2012-04-20T20:27:18.407
> 
> 标签：c#, reflection

我有一个适用于我的大多数自定义类型的通用方法。今天我正在构建单元测试。扩展失败，类型为`string`。string 提供了两个公共实例属性，`Length`并且`Chars`. 当我称它为`GetValue`“参数计数不匹配”时。

我不需要允许字符串。我可以向我的泛型添加足以解决问题的约束吗？

代码片段

```
public static DataTable ToDataTable<T>(this List<T> items){...

    //List<T> generally works...just found it failing out with string
    List<string> items = new List<string> { "cookie", "apple", "whatever" };
    System.Reflection.PropertyInfo[] props = typeof(string).GetProperties(System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.Instance);

    foreach (var item in items)
    {
        var values = new object[props.Length];
        for (var i = 0; i < props.Length; i++)
        {
            values[i] = props[i].GetValue(item, null);
        }
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T20:37:37.490

`Chars`是 C# 术语中的*索引器*- 但 .NET/CLR 术语中的“带有索引参数的属性”......所以你*只能*通过指定参数来获取值。所以在这种情况下，它代表这里使用的索引器：

```
char c = text[3]; 
```

在`Dictionary<TKey, TValue>`索引器中，您将获得`dictionary[key]`.

如果您只想要“普通”属性，请按[PropertyInfo.GetIndexParameters()](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.getindexparameters.aspx)返回空数组的属性列表进行过滤。

# php - 将纯文本转换为数组

> ID：10253113
> 
> 赞同：0
> 
> 时间：2012-04-20T20:27:24.700
> 
> 标签：php

如果我从 mysql（或其他）获得以下文本字符串，如何使用 PHP 将其转换为实际数组？

```
array("foo" => "bar","honey" => "pops") 
```

我知道我可以将数组保存为序列化状态，但这正是我在这里要避免的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:30:44.130

使用`eval`，但它太危险了....**我不建议你使用这样的**

```
$string = '$array = array("foo" => "bar","honey" => "pops");' ;
eval($string);
var_dump($array); 
```

输出

```
array(2) {
    ["foo"]=>
    string(3) "bar"
    ["honey"]=>
    string(4) "pops"
} 
```

## 推荐

使用标准格式，例如

`JSON` [http://php.net/manual/en/book.json.php](http://php.net/manual/en/book.json.php)

`XML` [http://php.net/manual/en/book.simplexml.php](http://php.net/manual/en/book.simplexml.php)

`Serialized PHP` [http://php.net/manual/en/function.serialize.php](http://php.net/manual/en/function.serialize.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:36:14.563

答案是“不要这样做”。 *永远不要*把 PHP 代码放在你的数据库中。数据库用于*数据*，而不是代码。

*正确*的方法是存储一个序列化数组（不知道为什么要避免这种情况）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:30:46.867

您可以使用以下`eval`功能：

[http://php.net/manual/en/function.eval.php](http://php.net/manual/en/function.eval.php)

尝试这样的事情：

```
$my_string = 'array("foo" => "bar","honey" => "pops")';

eval("\$result=$my_string;"); 
```

# language-agnostic - 如何实现数据执行（好像是脚本源码）

> ID：10253115
> 
> 赞同：0
> 
> 时间：2012-04-20T20:27:29.300
> 
> 标签：language-agnostic, code-generation, metaprogramming

假设有一种称为 ScriptCode 的脚本语言具有以相同语言执行代码的能力。

//这个ficticius程序执行一个简单的常量代码。

```
main()
{
    ScriptCode sc=new ScriptCode ( "print \"Hello\"");

    execute(sc); 

    print (" world");
} 
```

//这个ficticius程序将从stdin读取10个程序，然后全部执行。

```
main()
{

     ScriptCode programs[10] 

     String input;

     for(int i=0;i<10; i++)   
      {
          input =readInput();
          program[i] = new ScriptCode(input);
      }

   for( SriptCode p : programs)
       execute( p );

} 
```

问题是：

“ScriptCode”可能是哪种现有的程序语言？或者如何实现这种软件？

（我希望它不是 LISP 唯一的选择，但如果是这样的话......我将不得不面对它。）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T00:44:16.077

您的`execute`例程传统上称为`eval`. 关于 eval的[维基百科文章](https://en.wikipedia.org/wiki/Eval)列出了许多具有“eval”的语言，包括 JavaScript、ActionScript、Lisp、Perl、PHP、Lua、PostScript、Python、D、ColdFusion、REALbasic、Ruby、Forth、VBScript、Visual Basic for Applications 和短暂聊天。下面的评论中也提到了 SQL（谢谢）。

通常，实现使用与语言本身相同的代码（以减少重复）。所以解释语言调用解释器，编译语言调用编译器。由于解释器*必须*包含在解释程序中，但编译器通常不包含在编译程序中，因此此功能在解释语言中更为常见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T00:37:52.240

就像是：

```
#!/bin/bash 
# ohai, I'm bash, this is test
i=3
while ((i--)); do
    read -ra prog
    ${prog[@]}
done 
```

得到一个命令，运行它。测试用例

```
$ bash test
echo foo
foo
mpc play
65daysofstatic - The Conspiracy of Seeds
printf %s\n heh
heh 
```

我想，在某种程度上，大多数解释语言都适合。

现在如果输入是一个文件，你甚至可以编译它并运行可执行文件，即使是简单的`C`程序。

这个游戏的规则是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T01:55:23.653

小话回复：

编译器评估：'3 + 4'

==> 7

# mysql - 存储播放列表中视频的顺序

> ID：10253116
> 
> 赞同：1
> 
> 时间：2012-04-20T20:27:36.243
> 
> 标签：mysql, database-design, video, playlist

我正在开发一个**带有播放列表功能的简单视频数据库**。在这样的播放列表中，可以按照用户指定的顺序放置视频。

所以我想我给`number_in_playlist`每个`video_id`. 这样做的问题是，如果稍后将视频 19 移动到视频 2 和 3 之间的位置，则另外`number_in_playlist`需要更新其间的所有视频。

现在这强烈地让我想起了**Array vs Linked List**。所以我认为链表可以解决这个问题，即为每个视频记录存储类似于`previous_video_id_in_playlist`和的内容。`next_video_id_in_playlist`但是，在这种情况下，我不确定如何（按顺序）获取播放列表中的所有视频？

这一定是别人之前遇到过的问题，所以想问问有没有标准推荐的解决方案？

PS：我正在使用 MySQL，我非常喜欢简短、快速的查询（我认为这与链表解决方案背道而驰？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:47:06.127

如果您将`playlist.number_in_playlist`列设为**double**，则可以先用整数对视频进行排序。当播放列表中的项目移动到新位置时，您将新`number_in_playlist`值设置为（可能是小数）数字，该数字介于前面和后面的视频之间。这使您可以在很长一段时间内移动视频，而不必担心重新排序整个播放列表。

重新排序的触发器是当您的新计算值等于您的一个端点（即与前面或后面的视频相同的值）时。出于实际目的，除非您的用户花费更多时间重新排序视频而不是观看视频，否则这种情况很少会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:47:30.680

你能不能不做类似的事情：

```
SELECT *
FROM videos
WHERE playlist_id = 1
ORDER BY next_video_id_in_playlist ASC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:59:21.080

列表通常不会太长吗？写入性能不是问题吗？在这种情况下，我只使用 number_in_playlist 解决方案。每次写入时，基本上都需要更新所有数字。

关系数据库中的链接列表闻起来会导致不可预见的问题。就像由错误引起的循环一样。

# javascript - 使用新的嵌入代码（小型视频播放器）以高清格式嵌入 YouTube 视频

> ID：10253117
> 
> 赞同：0
> 
> 时间：2012-04-20T20:27:48.797
> 
> 标签：javascript, html, youtube

如果嵌入式播放器很大，最新的 YouTube 嵌入代码只会播放高清视频。我的嵌入式播放器很小。有没有办法让它以高清播放？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:56:08.027

这可能有点过时了，因为我从网站上找到的图片*与 YouTube 上目前的图片不匹配，但见鬼，值得一试，对吧？

简而言之，您必须使用旧的嵌入代码并进行一些小改动：

```
<object width="640" height="360">
<param name="movie" value="http://www.youtube.com/v/VIDEO_ID?hl=en_US&rel=0&hd=1"></param>
<param name="allowFullScreen" value="true"></param>
<param name="allowscriptaccess" value="always"></param>
<embed src="http://www.youtube.com/v/VIDEO_ID?hl=en_US&rel=0&hd=1" type="application/x-shockwave-flash" width="640" height="360" allowscriptaccess="always" allowfullscreen="true"></embed>
</object> 
```

当然，您应该将 VIDEO_ID 换成您想要的视频 ID。希望这可以帮助。

似乎在这里工作：http: [//jsfiddle.net/h9eRM/](http://jsfiddle.net/h9eRM/)

*通过[http://www.h3xed.com](http://www.h3xed.com)[直接链接并嵌入高清 YouTube 视频](http://www.h3xed.com/web-and-internet/link-directly-to-and-embed-hd-youtube-videos)

# ios - 停止在 xcode/cordova 1.6.1 中打开 youtube 应用程序的 youtube 视频

> ID：10253120
> 
> 赞同：3
> 
> 时间：2012-04-20T20:27:55.817
> 
> 标签：ios, xcode, cordova, youtube

我正在使用适用于 ios 的 Cordova/phonegap 框架在 xcode 中构建一个应用程序，该框架显示一些 html，其中包含一些嵌入的 youtube 播放器代码。iOS 在点击此 youtube 播放器时似乎会将用户重定向到 youtube 应用程序。在科尔多瓦 1.5.0 中，以下代码有效，但在 1.6.1 中似乎没有。任何想法为什么或需要改变什么才能让它发挥作用？

阻止 youtube 打开的代码和行为自我的链接

```
- (BOOL)webView:(UIWebView *)theWebView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    NSURL *url = [request URL];

    // Intercept the external http requests and forward to Safari.app
    // Otherwise forward to the PhoneGap WebView

    NSString* urlString = [url absoluteString];
    if([urlString rangeOfString:@"http://www.youtube.com/embed"].location != NSNotFound) {
        return [ super webView:theWebView shouldStartLoadWithRequest:request navigationType:navigationType ];
    }
    else if (([[url scheme] isEqualToString:@"http"] || [[url scheme] isEqualToString:@"https"])) {
        [[UIApplication sharedApplication] openURL:url];
        return NO;
    }
    else {
        return [ super webView:theWebView shouldStartLoadWithRequest:request navigationType:navigationType ];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T14:00:14.347

看看[http://apiblog.youtube.com/2009/02/youtube-apis-iphone-cool-mobile-apps.html](http://apiblog.youtube.com/2009/02/youtube-apis-iphone-cool-mobile-apps.html) 这可能会有所帮助。

它说这样做：

```
NSString *htmlString = @"<html><head>
<meta name = \"viewport\" content = \"initial-scale = 1.0, user-scalable = no, width = 212\"/></head>
<body style=\"background:#F00;margin-top:0px;margin-left:0px\">
<div><object width=\"212\" height=\"172\">
<param name=\"movie\" value=\"http://www.youtube.com/v/oHg5SJYRHA0&f=gdata_videos&c=ytapi-my-clientID&d=nGF83uyVrg8eD4rfEkk22mDOl3qUImVMV6ramM\"></param>
<param name=\"wmode\" value=\"transparent\"></param>
<embed src=\"http://www.youtube.com/v/oHg5SJYRHA0&f=gdata_videos&c=ytapi-my-clientID&d=nGF83uyVrg8eD4rfEkk22mDOl3qUImVMV6ramM\"
type=\"application/x-shockwave-flash\" wmode=\"transparent\" width=\"212\" height=\"172\"></embed>
</object></div></body></html>";

[webView loadHTMLString:htmlString baseURL:[NSURL URLWithString:@"http://www.your-url.com"]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T19:35:58.630

我会在方法的开头为 url 登录，然后在 if/elseif/else 的每个子句中添加一个 log 语句，这样您就可以看到拦截了哪些 url 以及该方法对每个 URL 做了什么。

也许 youtube 请求的字符串不再匹配硬编码的“http://www.youtube.com/embed”？值得一看。

# c# - 只执行 ThreadPool 的最后一个线程

> ID：10253121
> 
> 赞同：0
> 
> 时间：2012-04-20T20:27:59.780
> 
> 标签：c#, threadpool, task-parallel-library

我正在创建一个自动完成控件，该控件会随着用户键入文本而更新。每次用户键入一个键时，都会触发一个新线程以过滤结果。结果来自网络并且很多，因此过滤大约需要 1 分钟。这与我所拥有的类似：

```
 object _lock = new object();
    volatile static bool isThreadRunning=false ;
    private void textBox1_TextChanged(object sender, TextChangedEventArgs e)
    {

        var text = textBox1.Text.ToUpper();
        ThreadPool.QueueUserWorkItem((o) =>
        {

            lock (_lock) // avoid multiple threads to be running at the same time
            {
                isThreadRunning = true;

                // do work in here

                isThreadRunning=false;
            }

        },text);
    } 
```

如您所见，如果我在哪里快速键入“Hello”，那么将创建 5 个线程，其中 4 个必须等待第一个线程完成。一旦该线程完成，下一个线程将继续执行，依此类推。

如果存在 4 个线程等待执行，我只想执行最后一个。线程也以随机顺序进入锁。我怎么能确定哪个是最后一个。如果一个新线程触发并且一个线程当前正在执行，也许我可以以某种方式取消该线程，这样顺序将始终正确。我该如何实现该算法？

* * *

## 编辑

这是我制定的：

```
 class DoWorkOnce
    {

        static object _lock = new object();
        static Stack<Action> Work = new Stack<Action>();

        public static void Add(Action task)
        {
            Work.Push(task);
            DoSomeWork();                
        }

        private static void DoSomeWork()
        {                
            Task.Factory.StartNew(() =>
            {
                lock (_lock) // ensure that the following block of code is only executed at once
                {
                    if (Work.Count == 0) // if there is no items in the stack return
                        return;

                    Work.Pop()(); // get the last item in the stack and execute it

                    // remove the bottom of the stack by poping everything exept the top item
                    Action temp=null;
                    if(Work.Count>0)
                        temp = Work.Pop();

                    while (Work.Count > 0)
                        Work.Pop();

                    if (temp != null)
                        Work.Push(temp);
                }
            });
        }
    } 
```

我可以将该类用作：

```
 string[] simulationOfTyping = new string[] { "H", "He", "Hel", "Hell", "Hello", "Hello ", "Hello W", "Hello Wo", "Hello Wor", "Hello Worl", "Hello World" };

        // simulate user typing
        foreach(var text in simulationOfTyping)
        {
            Thread.Sleep(50);
            DoWorkOnce.Add(() =>
            {
                Console.WriteLine(text);
                Thread.Sleep(1000);
            });
        }

        // the last item should execute always. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:35:24.087

除了 mellamokb 的评论，听起来你根本不想要一个线程*池*——你想要一个*线程*，有一个*“*下一个要执行的任务”——如果已经有一个任务要执行，它会被新的一。本质上就像一个生产者/消费者队列，但只有一个被覆盖的“槽”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:47:04.110

在 TPL 数据流中，这正是[`BroadcastBlock`](http://msdn.microsoft.com/en-us/library/hh160447%28v=vs.110%29.aspx)它所做的：它始终只记住发布到它的最后一个项目。如果将其链接到`ActionBlock`容量限制为 1 的容量，则该`ActionBlock`操作将按照您想要的方式执行。

尽管仅为此使用 TPL 数据流可能没有多大意义。

# c - 在每个页面错误上获取信号

> ID：10253139
> 
> 赞同：5
> 
> 时间：2012-04-20T20:29:01.807
> 
> 标签：c, linux, x86-64

我想在我的应用程序中设置一个信号处理程序，以便内核在处理页面错误陷阱时发送一个信号。当然我可以使用`SIGSEGV`信号处理程序，但我真正感兴趣的是捕获写时复制时发生的页面错误。例如，在 fork 之后（不跟随 exec），如果原始进程尝试写入某个页面，它将获得页面错误。我想收到有关此类页面错误的通知。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T02:15:16.767

页面错误是由 do_page_fault() 处理的中断

```
http://www.stillhq.com/pdfdb/000446/data.pdf 
```

信号也会产生中断。不同之处在于缺页中断被引导至代码。对代码的作用进行了解释。IMO，总是在中断处理程序中产生另一个中断是一个坏主意。

告诉我们：你想要完成什么？不是你认为应该怎么做。

# gwt-mvp - 具有可交换子演示者的演示者

> ID：10253141
> 
> 赞同：0
> 
> 时间：2012-04-20T20:29:14.867
> 
> 标签：gwt-mvp

使用带有 MVP 的 GWT 2.4，我有一个演示者，其中顶部可以在一组数据的只读演示者或该数据的编辑器之间交换，具体取决于您到达页面的方式。

如果不使用 GWTP，我如何在这两个演示者和底层视图之间进行交换？

目前，这些类如下所示：

```
public class MainPagePresenter implements Presenter, MainPageView.Presenter, ParentPresenter {

    private MainPageViewview;
    private final ClientFactory clientFactory;
    private StaticDataPresenter staticPresenter;
    private SomeOtherPresenter otherPresenter;

} 
```

我希望 StaticDataPresenter 成为某种结构，可以容纳 StaticDataPresenter 或允许您编辑的 DynamicDataPresenter。

感谢您的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T16:44:15.823

您的 MainPageView 可以有一个 DeckPanel，其中包含 StaticDataPresenter 的视图和 SomeOtherPresenter 的视图。

然后 MainPagePresenter 可以告诉 MainPageView 根据您的需要切换显示的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T15:16:16.633

```
public interface DataPresenter {
  void handleEdit();
}

public class StaticDataPresenter implements DataPresenter {
  @Override
  public void handleEdit() {
    // Do nothing.
  }
}

public class DynamicDataPresenter implements DataPresenter {
  @Override
  public void handleEdit() {
    // Do something.
  }
}

public class MainPagePresenter implements Presenter, MainPageView.Presenter, ParentPresenter {

  private MainPageView view;
  private final ClientFactory clientFactory;
  private DataPresenter dataPresenter;
  private SomeOtherPresenter otherPresenter;

  ...

  public void switchDataPresenter(DataPresenter dataPresenter) {
    this.dataPresenter = dataPresenter;
    DataPresenterView dataPresenterView = view.dataPresenterView();
    dataPresenterView.setPresenter(dataPresenter);
  }    
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T14:45:17.723

我最终做的是将两个编辑器都放在页面上，然后打开和关闭演示者的可见性。

感谢您的建议。他们帮助了。

# javascript - 有没有办法检测加载瓷砖何时失败？

> ID：10253143
> 
> 赞同：3
> 
> 时间：2012-04-20T20:29:32.170
> 
> 标签：javascript, openlayers

有没有办法检测何时无法与 OpenLayers 联系切片服务器？我想显示“找不到瓷砖服务器”失败消息，而不仅仅是那些丑陋的“找不到图像”红色 X 瓷砖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T23:26:21.290

作为对任何需要这样做的人的仅供参考，我使用以下代码解决了这个问题（放置在我创建地图、图层等之前）：

```
OpenLayers.Util.onImageLoadError = function () {
    this.src = "images/noTile.png";
} 
```

其中 images/noTile.png 是我用作“未找到瓷砖”图像的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T15:04:59.753

OpenLayers.Util.onImageLoadError 似乎不再可用。他们似乎已使用 .olImageLoadError 选择器将其替换为缺失图块的 css 样式。检测一个或多个瓦片故障的任何替代方法？

# synchronization - 使用信号量实现监视器

> ID：10253150
> 
> 赞同：2
> 
> 时间：2012-04-20T20:30:11.203
> 
> 标签：synchronization, operating-system, semaphore, locks

我被问到以下问题，我不确定正确答案是什么：

```
If monitors are implemented by replacing condition variables with semaphores 
(counters set to 0) with down() and up() as wait and signal, respectively,
would the monitors work correctly? 
```

我很想说这是一个正确的实现，因为信号量和条件变量可以相互替换，对吗？有更好的解释吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:43:16.273

您正在询问初始化为 1 的信号量，它也称为**二进制信号量**。

答案取决于这些原语的特定实现（或定义），但是典型的区别是监视器具有线程所有权而信号量没有。这会影响各种场景。

*   对于一个信号量来说，一个线程完成所有的上升而另一个线程完成所有的下降是完全正常的。监视器不应该允许这样做。
*   假设您有一个具有私有状态和多个公共方法的类，所有这些方法在进入时锁定一个公共监视器并在退出时解锁以保护该状态。还假设公共方法在`A`内部调用公共方法`B`。然后，递归监视器将正确地允许调用方法`A`（这涉及序列 lock-lock-unlock-unlock），而与信号量实现的监视器相同，在第二次尝试使用同一线程锁定时会导致死锁。
*   假设一个线程获取了一个命名的系统范围的监视器并崩溃了。由于线程所有权，可以自动解锁监视器并允许任何等待的线程获取它。使用二进制信号量这是不可能的，并且这种情况通常在重新启动之前永远不会令人满意地解决。[**编辑**：请注意，即使在互斥体的情况下，所描述的恢复机制也可能不需要或默认启用，因为受保护资源或数据结构的状态在中途崩溃后基本上是未定义的。是否重新获取或以不同方式恢复的决定通常留给应用程序代码。]

因此，二进制信号量类似于监视器，但不要期望它的行为相同。

# c# - 使用 LINQ 进行高效的图遍历 - 消除递归

> ID：10253161
> 
> 赞同：9
> 
> 时间：2012-04-20T20:31:15.743
> 
> 标签：c#, .net, linq, recursion, graph

今天我打算实现一种方法来遍历任意深度的图并将其展平为单个可枚举。相反，我先做了一点搜索，发现了这个：

```
public static IEnumerable<T> Traverse<T>(this IEnumerable<T> enumerable, Func<T, IEnumerable<T>> recursivePropertySelector)
{
    foreach (T item in enumerable)
    {
        yield return item;

        IEnumerable<T> seqRecurse = recursivePropertySelector(item);

        if (seqRecurse == null) continue;
        foreach (T itemRecurse in Traverse(seqRecurse, recursivePropertySelector))
        {
            yield return itemRecurse;
        }
    }
} 
```

从理论上讲，这看起来不错，但在实践中，我发现它的性能比使用等效的手写代码（随着情况的出现）来遍历图表并执行任何需要做的事情要差得多。我怀疑这是因为在这种方法中，对于它返回的每个项目，堆栈都必须展开到任意深度。

我还怀疑如果消除递归，这种方法会更有效地运行。我也恰好不擅长消除递归。

有谁知道如何重写这个方法来消除递归？

谢谢你的帮助。

编辑：非常感谢所有详细的回复。我尝试对原始解决方案与 Eric 的解决方案进行基准测试，而不是使用枚举器方法，而是使用 aa lambda 递归遍历，奇怪的是，lambda 递归比其他两种方法中的任何一种都要快得多。

```
class Node
{
    public List<Node> ChildNodes { get; set; } 

    public Node()
    {
        ChildNodes = new List<Node>();
    }
}

class Foo
{
    public static void Main(String[] args) 
    {
        var nodes = new List<Node>();
        for(int i = 0; i < 100; i++)
        {
            var nodeA = new Node();
            nodes.Add(nodeA);
            for (int j = 0; j < 100; j++)
            {
                var nodeB = new Node();
                nodeA.ChildNodes.Add(nodeB);
                for (int k = 0; k < 100; k++)
                {
                    var nodeC = new Node();
                    nodeB.ChildNodes.Add(nodeC);
                    for(int l = 0; l < 12; l++)
                    {
                        var nodeD = new Node();
                        nodeC.ChildNodes.Add(nodeD);
                    }
                }
            }
        }            

        nodes.TraverseOld(node => node.ChildNodes).ToList();
        nodes.TraverseNew(node => node.ChildNodes).ToList();

        var watch = Stopwatch.StartNew();
        nodes.TraverseOld(node => node.ChildNodes).ToList();
        watch.Stop();
        var recursiveTraversalTime = watch.ElapsedMilliseconds;
        watch.Restart();
        nodes.TraverseNew(node => node.ChildNodes).ToList();
        watch.Stop();
        var noRecursionTraversalTime = watch.ElapsedMilliseconds;

        Action<Node> visitNode = null;
        visitNode = node =>
        {
            foreach (var child in node.ChildNodes)
                visitNode(child);
        };

        watch.Restart();
        foreach(var node in nodes)
            visitNode(node);
        watch.Stop();
        var lambdaRecursionTime = watch.ElapsedMilliseconds;
    }
} 
```

其中 TraverseOld 是原始方法， TraverseNew 是 Eric 的方法，显然 lambda 是 lambda。

在我的机器上，TraverseOld 需要 10127 毫秒，TraverseNew 需要 3038 毫秒，lambda 递归需要 1181 毫秒。

这是典型的枚举器方法（带有收益返回）可能需要 3 倍的时间而不是立即执行吗？还是这里发生了其他事情？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-20T21:10:21.063

首先，您是绝对正确的；如果图有 n 个平均深度为 d 的节点，那么朴素的嵌套迭代器会产生一个时间为 O(n*d) 的解，而堆栈中的解为 O(d)。如果 d 是 n 的很大一部分，那么这可以变成 O(n ² ) 算法，如果 d 很大，那么你可以完全破坏堆栈。

如果您对嵌套迭代器的性能分析感兴趣，请参阅前 C# 编译器开发人员 Wes Dyer 的博客文章：

[http://blogs.msdn.microsoft.com/wesdyer/2007/03/23/all-about-iterators](http://blogs.msdn.microsoft.com/wesdyer/2007/03/23/all-about-iterators)

dasblinkenlight 的解决方案是标准方法的一种变体。我通常会这样编写程序：

```
public static IEnumerable<T> Traverse<T>(
    T root, 
    Func<T, IEnumerable<T>> children)
{
    var stack = new Stack<T>();
    stack.Push(root);
    while(stack.Count != 0)
    {
        T item = stack.Pop();
        yield return item;
        foreach(var child in children(item))
            stack.Push(child);
    }
} 
```

然后，如果您有多个根：

```
public static IEnumerable<T> Traverse<T>(
    IEnumerable<T> roots, 
    Func<T, IEnumerable<T>> children)
{
    return from root in roots 
           from item in Traverse(root, children)
           select item ;
} 
```

现在，请注意，如果您有高度互连的图或循环图，则*不需要遍历！*如果您有一个带有向下箭头的图表：

```
 A
         / \
        B-->C
         \ /
          D 
```

那么遍历是 A、B、D、C、D、C、D。如果你有一个循环图或互连图，那么你想要的是*传递闭包*。

```
public static IEnumerable<T> Closure<T>(
    T root, 
    Func<T, IEnumerable<T>> children)
{
    var seen = new HashSet<T>();
    var stack = new Stack<T>();
    stack.Push(root);

    while(stack.Count != 0)
    {
        T item = stack.Pop();
        if (seen.Contains(item))
            continue;
        seen.Add(item);
        yield return item;
        foreach(var child in children(item))
            stack.Push(child);
    }
} 
```

这种变化只会产生以前没有产生过的物品。

> 我也恰好不擅长消除递归。

我写了许多关于消除递归的方法以及一般的递归编程的文章。如果您对此主题感兴趣，请参阅：

[http://blogs.msdn.com/b/ericlippert/archive/tags/recursion/](http://blogs.msdn.com/b/ericlippert/archive/tags/recursion/)

尤其是：

[http://blogs.msdn.com/b/ericlippert/archive/2005/08/01/recursion-part-two-unrolling-a-recursive-function-with-an-explicit-stack.aspx](http://blogs.msdn.com/b/ericlippert/archive/2005/08/01/recursion-part-two-unrolling-a-recursive-function-with-an-explicit-stack.aspx)

[http://blogs.msdn.com/b/ericlippert/archive/2005/08/04/recursion-part-three-building-a-dispatch-engine.aspx](http://blogs.msdn.com/b/ericlippert/archive/2005/08/04/recursion-part-three-building-a-dispatch-engine.aspx)

[http://blogs.msdn.com/b/ericlippert/archive/2005/08/08/recursion-part-four-continuation-passing-style.aspx](http://blogs.msdn.com/b/ericlippert/archive/2005/08/08/recursion-part-four-continuation-passing-style.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-20T20:42:40.563

你是对的，在代码中递归地遍历树和图`yield return`是效率低下的一大来源。

通常，您使用堆栈重写递归代码 - 与通常在编译代码中实现的方式类似。

我没有机会尝试一下，但这应该可行：

```
public static IEnumerable<T> Traverse<T>(this IEnumerable<T> enumerable, Func<T, IEnumerable<T>> recursivePropertySelector) {
    var stack = new Stack<IEnumerable<T>>();
    stack.Push(enumerable);
    while (stack.Count != 0) {
        enumerable = stack.Pop();
        foreach (T item in enumerable) {
            yield return item;
            var seqRecurse = recursivePropertySelector(item);
            if (seqRecurse != null) {
                stack.Push(seqRecurse);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T20:40:02.920

您总是可以通过复制递归如何与堆栈一起工作的基础知识来消除递归。

1.  将第一项放在栈顶
2.  当堆栈不为空时，从堆栈中弹出一个项目
3.  如果当前节点有子节点，则将它们添加到堆栈中
4.  Yield 返回当前项目。
5.  转到第 1 步！

疯狂聪明的理论答案：[https ://stackoverflow.com/a/933979/29093](https://stackoverflow.com/a/933979/29093)

[http://cs.saddleback.edu/rwatkins/CS2B/Lab%20Exercises/Stacks%20and%20Recursion%20Lab.pdf](http://cs.saddleback.edu/rwatkins/CS2B/Lab%20Exercises/Stacks%20and%20Recursion%20Lab.pdf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T20:38:14.143

您可以在代码中使用队列。队列可以初始化为一个列表，其中一个元素等于顶部节点。然后，您必须从第一个元素开始遍历列表的每个元素。如果第一个元素包含子节点，则将它们全部附加到队列的末尾。然后移动到下一个元素。当您到达队列末尾时，您的图表将完全变平。

# c# - 依赖注入可选参数

> ID：10253169
> 
> 赞同：8
> 
> 时间：2012-04-20T20:31:29.160
> 
> 标签：c#, asp.net-mvc, dependency-injection, optional-parameters

在使用带有构造函数注入的依赖注入框架时使用可选参数是否被认为是一种不好的做法？

例子：

```
public class ProductsController
{
    public ProductsController(IProductService productService = null, IBackOrderService = null)
    {
    }
} 
```

我已将这两个参数都指定为可选参数，但我的 DI 框架将始终注入这两个依赖项。如果我向我的控制器添加一个需要新依赖项的新操作，那么将新依赖项设为可选是否会很糟糕？即使现有的测试不需要新的依赖项，我也可能会破坏数十个单元测试。

**编辑**
人们似乎对我的问题感到困惑。我从不在我的 Web 应用程序中手动构建 ProductsController。这由控制器工厂（自动注入依赖项）处理。

我不喜欢这样的单元测试：

```
[Test]
public void Test1()
{
    var controller = new ProductsController(new MockProductService(), new MockBackOrderService());
} 
```

现在我决定向我的控制器添加一个新的操作方法。此新操作需要新的依赖项，但现有操作都不需要。现在我必须回去修改 100 个不同的单元测试，因为我添加了一个新参数。我可以通过使参数可选来避免这种情况，但我想知道这是否是一个坏主意。我的直觉说不，因为它唯一影响的是单元测试。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2019-03-29T15:00:07.090

**我完全同意**所有情况下的公认答案，即定义一个依赖意味着没有它实现将无法工作。

**但是，如果**您有一些不一定需要依赖项但您希望能够在该依赖项已加载的情况下配置某些东西的情况。好的...？这听起来有点奇怪，但它是一个有效的元编程用例——你认为工厂模式可能会有所帮助..但即使是工厂**也可能需要一些、没有或全部依赖项**，所以工厂不能解决这个问题。

> 特征标志的现实世界问题。如果关闭了某个功能，则您不需要该依赖项..或者甚至无法创建它，因为没有具体的实现。所以它关闭了。它编译，一切正常。但是后来有人打开了这个功能，突然间我们需要这种依赖。

我找到了一种方法来做到这一点——最好的部分是我通过学习另一种不太知名的依赖注入技术才意识到如何做到这一点（我正在使用 Microsoft.Extensions.DependencyInjection）

**为单个接口注入多个具体实现**

```
services.AddTransient<IWarehouseRepo, ActionRepository>();
services.AddTransient<IWarehouseRepo, EventRepository>();
services.AddTransient<IWarehouseRepo, AuditRepository>();
services.AddTransient<IWarehouseRepo, ProRepository>();
services.AddTransient<IWarehouseRepo, SuperWarehouseRepository>();
services.AddTransient<IWarehouseRepo, InferiorWarehouseRepository>();
services.AddTransient<IWarehouseRepo, MonthlyStatisticsRepository>(); 
```

我最近才知道这是完全有效的，但要让它工作，你的构造函数需要看起来像这样..

```
public WarehouseHandler(IEnumerable<IWarehouseRepo> repos) 
```

所以这太酷了！我可以根据任何标准选择我需要的存储库。但这**对可选依赖项有何帮助？**

因为这种类型的构造函数**会给你0**个或更多的依赖。因此**，如果您不添加任何依赖项**，您可以使用条件语句在构造函数中分支

```
 if (repos.Count() == 0)
    return; 
```

这是空引用安全的，不需要默认值，易于调试，易于阅读且易于实现。

您现在也可以将此技术用作功能切换机制！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-20T20:56:14.903

我不认为这是一个好主意。构造函数注入意味着**依赖项是必需**的。如果参数之一为空，您甚至应该添加引发的警戒线。

我认为问题在于您的单元测试。例如，我只有一个地方创建控制器并模拟支持对象（controllerContext、HttpContext、Request、Response 等）。然后，如果我在构造函数中添加一个新参数，我只需要在单元测试中的一个地方更改它。

也许您应该考虑在单元测试中编写一个通用基类，或者为测试使用“设置”例程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-30T10:29:05.760

考虑使用[测试数据生成器模式](http://defragdev.com/blog/?p=147)。

以最简单的形式，它可以作为静态测试辅助方法来完成

```
public ProductsController BuildControllerWIthMockDependencies ()
{
    var controller = new ProductsController(new MockProductService(), new MockBackOrderService());
return controller;
} 
```

您可以将[AutoFixture 用作通用测试数据生成器](http://blog.ploeh.dk/2009/07/01/AutoFixtureAsTestDataBuilder/)。

可以在测试数据构建器中找到使用测试数据构建器的更多技术[：对象母模式的替代方案](http://www.natpryce.com/articles/000714.html)

# linux - 检查非默认加载程序的共享库

> ID：10253170
> 
> 赞同：9
> 
> 时间：2012-04-20T20:31:38.670
> 
> 标签：linux, shared-libraries, ldd

`ldd`是检查给定可执行文件正在或将要使用的共享库的好方法。但是，它并不总是按预期工作。例如，请参阅以下 shell 片段，该片段演示了如何在 python 二进制文件中“失败”找到 libreadline“依赖项”

我尝试了许多其他发行版，但我是从 Tikanga 复制的

```
$ lsb_release -a
LSB Version:    :core-4.0-amd64:core-4.0-ia32:core-4.0-noarch:graphics-4.0-amd64:graphics-4.0-ia32:graphics-4.0-noarch:printing-4.0-amd64:printing-4.0-ia32:printing-4.0-noarch
Distributor ID: RedHatEnterpriseServer
Description:    Red Hat Enterprise Linux Server release 5.6 (Tikanga)
Release:        5.6
Codename:       Tikanga 
```

查看`ldd`默认安装的内容`python`（来自官方存储库）。

```
$ which python
/usr/bin/python
$ ldd `which python`
    libpython2.4.so.1.0 => /usr/lib64/libpython2.4.so.1.0 (0x00000030e6200000)
    libpthread.so.0 => /lib64/libpthread.so.0 (0x00000030e0e00000)
    libdl.so.2 => /lib64/libdl.so.2 (0x00000030e0a00000)
    libutil.so.1 => /lib64/libutil.so.1 (0x00000030ee800000)
    libm.so.6 => /lib64/libm.so.6 (0x00000030e0600000)
    libc.so.6 => /lib64/libc.so.6 (0x00000030e0200000)
    /lib64/ld-linux-x86-64.so.2 (0x00000030dfe00000)
$ ldd `which python` | grep readline
$ 
```

没有找到关于 readline 的信息。现在我从交互式使用中确实知道这个二进制文件确实具有实时功能，所以让我们不要尝试查看它的来源。

```
$ python &
[1] 21003
$ Python 2.4.3 (#1, Dec 10 2010, 17:24:35) 
[GCC 4.1.2 20080704 (Red Hat 4.1.2-50)] on linux2
Type "help", "copyright", "credits" or "license" for more information.

[1]+  Stopped                 python 
```

在后台启动交互式 python 会话（pid 21003）

```
$ lsof -p 21003
COMMAND   PID    USER   FD   TYPE DEVICE     SIZE    NODE NAME
python  21003 ddvento  cwd    DIR   0,33    16384  164304 /glade/home/ddvento/loader-test
python  21003 ddvento  rtd    DIR    8,3     4096       2 /
python  21003 ddvento  txt    REG    8,3     8304 6813419 /usr/bin/python
python  21003 ddvento  mem    REG    8,3   143600 8699326 /lib64/ld-2.5.so
python  21003 ddvento  mem    REG    8,3  1722304 8699327 /lib64/libc-2.5.so
python  21003 ddvento  mem    REG    8,3   615136 8699490 /lib64/libm-2.5.so
python  21003 ddvento  mem    REG    8,3    23360 8699458 /lib64/libdl-2.5.so
python  21003 ddvento  mem    REG    8,3   145824 8699445 /lib64/libpthread-2.5.so
python  21003 ddvento  mem    REG    8,3   247544 6821551 /usr/lib64/libreadline.so.5.1
python  21003 ddvento  mem    REG    8,3    15840 8699446 /lib64/libtermcap.so.2.0.8
python  21003 ddvento  mem    REG    8,3  1244792 6833317 /usr/lib64/libpython2.4.so.1.0
python  21003 ddvento  mem    REG    8,3    18152 8699626 /lib64/libutil-2.5.so
python  21003 ddvento  mem    REG    8,3 56446448 6832889 /usr/lib/locale/locale-archive
python  21003 ddvento  mem    REG    8,3    21808 6965997 /usr/lib64/python2.4/lib-dynload/readline.so
python  21003 ddvento  mem    REG    8,3    25464 6901074 /usr/lib64/gconv/gconv-modules.cache
python  21003 ddvento    0u   CHR  136,1                3 /dev/pts/1
python  21003 ddvento    1u   CHR  136,1                3 /dev/pts/1
python  21003 ddvento    2u   CHR  136,1                3 /dev/pts/1
$ lsof -p 21003 | grep readline
python  21003 ddvento  mem    REG    8,3   247544 6821551 /usr/lib64/libreadline.so.5.1
python  21003 ddvento  mem    REG    8,3    21808 6965997 /usr/lib64/python2.4/lib-dynload/readline.so 
```

答对了！这里是readline！

但是，此技术仅在库被有效加载时才有效，因此例如，`/usr/lib64/libtcl8.4.so`直到 python 进程不运行类似`from Tkinter import *`

所以我有两个问题：

1.  我认为问题`ldd`在于它假设使用标准加载器，而 python 很可能正在使用它自己的特殊加载器（这样您就不必每次安装新的非纯 python 模块时重新链接可执行文件python 但有一些 c/c++/fortran 代码）。它是否正确？

2.  显然，如果一个可执行文件使用它自己的加载器，那么“如何找到这个可执行文件可能加载的所有可能的库”这个问题没有明显的答案：这取决于加载器的作用。但是有没有办法找出 python 可以加载哪些库？

PS：与 1 相关。如果您遇到这个问题，您应该已经知道以下内容，但如果不知道，您应该：看看完全弄乱`ldd`输出是多么简单（仅部分弄乱它有点难）：

```
$ cat hello.c 
#include <stdio.h>

int main() {
  printf("Hello world.\n");
  return 0;
}

$ gcc -static hello.c -o loader
$ gcc -Wl,--dynamic-linker,./loader hello.c -o hello
$ ./hello 
Hello world.
$ ldd ./hello
Hello world. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T20:41:40.233

Python、Perl 和其他解释语言确实使用`dlopen()`. （这与替换标准加载器不同；他们仍在使用它，实际上`dlopen()`是基于 ELF 系统上标准加载器的挂钩。）

可加载模块没有标准注册表。Python 使用自己的规则来确定可以从哪里加载扩展模块（查看`sys.path`），包括那些具有关联共享对象的模块。Perl 使用不同的规则。Apache 使用仍然不同的规则等。

因此，总结一下您的问题的答案：

1.  不完全是

2.  不

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T16:06:11.667

作为旁注，完成我在问题 2 中想要的一种可能的方法是：

*   创建一个空的 chroot 环境

*   在那里重新编译python，手动添加任何缺少的东西，一个接一个

根据您的目标，这可能是也可能不是一个好的解决方案（实际上对于我的目标来说并不算太糟糕 - 从问题中听起来可能很奇怪）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-17T23:57:53.910

使用 ldd -v 也可以转储库依赖项。这是一个例子：

```
ave-ssh-test:tmp# ldd -v /sbin/coop.bin
        linux-vdso.so.1 =>  (0x00007fffd45f0000)
        libstdc++.so.6 => /lib64/libstdc++.so.6 (0x0000730cace67000)
.
.
.
Version information:

/lib64/libstdc++.so.6:
                ld-linux-x86-64.so.2 (GLIBC_2.3) => /lib64/ld-linux-x86-64.so.2
                libm.so.6 (GLIBC_2.2.5) => /lib64/libm.so.6
                libgcc_s.so.1 (GCC_4.2.0) => /lib64/libgcc_s.so.1
                libgcc_s.so.1 (GCC_3.3) => /lib64/libgcc_s.so.1
                libgcc_s.so.1 (GCC_3.0) => /lib64/libgcc_s.so.1
                libc.so.6 (GLIBC_2.14) => /lib64/libc.so.6
                libc.so.6 (GLIBC_2.4) => /lib64/libc.so.6
                libc.so.6 (GLIBC_2.3) => /lib64/libc.so.6
                libc.so.6 (GLIBC_2.3.2) => /lib64/libc.so.6
                libc.so.6 (GLIBC_2.2.5) => /lib64/libc.so.6 
```

# javascript - FB.api 贴到墙上：访问令牌？

> ID：10253174
> 
> 赞同：1
> 
> 时间：2012-04-20T20:32:11.237
> 
> 标签：javascript, facebook, sdk, token

我正在尝试使用 javascript sdk 发布到已连接用户的 facebook 墙上，这是我的代码：

```
 var connecter=false;
  window.fbAsyncInit = function() {
    FB.init({
      appId      : 'xxxxxxx', // App ID
      oauth      : true,
      channelUrl : '//www.streamazing.net/js/channel.html', // Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });

    FB.Event.subscribe('auth.login', function (response) {
               window.location.reload();
            });

    FB.Event.subscribe('auth.logout', function (response) {
               window.location.reload();
            });

    FB.getLoginStatus(function(response) {
            if (response.status === 'connected') {
                connecter=true;
                FB.api('/me', function(user) {
                var user2=user;
                console.log(user2.name);

                });

            }
        else connecter=false;
        });

    var body = 'This is a test';
                FB.api('/me/feed', 'post', { message: body }, function(response) {
                    if (!response || response.error) {
                        console.log(response.error);
                    } else {
                        alert('Post ID: ' + response.id);
                    }
                });
}; 
```

这是控制台日志：

```
code: 2500
message: "An active access token must be used to query information about the current user."
type: "OAuthException" 
```

我正在使用此代码请求许可：

```
<fb:login-button autologoutlink='true'  scope='email,user_birthday,status_update,publish_stream'></fb:login-button> 
```

我不明白为什么 facebook 向我询问访问令牌，有人可以帮助我吗？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-19T13:00:54.507

调用 FB.init(); 在声明了所有 fb sdk 函数之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:43:01.270

如果您想使用 Javascript SDK 发布到用户的提要，请改用 FB.ui。 [http://developers.facebook.com/docs/reference/javascript/FB.ui/](http://developers.facebook.com/docs/reference/javascript/FB.ui/)

否则，publish_stream 扩展权限所需的访问令牌存储在 response.authResponse.accessToken 下的 FB.getLoginStatus 方法中。 [http://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/](http://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T21:18:42.993

您需要使用 access_token= 向所有 FB URL 发出请求。

# coldfusion - 关闭连接并继续执行

> ID：10253175
> 
> 赞同：0
> 
> 时间：2012-04-20T20:32:25.910
> 
> 标签：coldfusion, cfhttp

如何在不中止脚本执行的情况下返回 400 状态代码并关闭连接？我正在寻找使用`<cfhttp>`但不等待脚本结束后再返回来启动脚本的执行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T20:35:45.007

您需要在连接关闭后在不同的线程上运行要继续运行的脚本部分。

[这是](http://www.bennadel.com/blog/749-Learning-ColdFusion-8-CFThread-Part-II-Parallel-Threads.htm)有关如何在 Coldfusion 中启动新线程的教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T13:48:13.740

如果您想在另一个请求中触发一个新请求而不等待，只需将 cfhttp 超时设置为 0，它将立即返回而无需等待响应。在返回一个单独的线程后继续执行脚本可能是一个更好的主意，但是如果您在服务器之外遇到一些问题或者确实需要一个单独的请求，那么 cfhttp timeout=0 应该可以解决问题。

# jquery - jQuery Autocomplete，如何允许用户提交与源中的值不匹配的输入

> ID：10253178
> 
> 赞同：4
> 
> 时间：2012-04-20T20:32:33.850
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

我有一个自动完成功能。我想让用户选择从源中选择一个项目，这是标准功能。但我也想让用户能够输入任何值，并且当源中匹配 0 个项目时，允许用户提交新值。

我一直在尝试以下方法：

```
 $("#rwF1, #rwF2").autocomplete({
        source: itemshere,

        select: function(event, ui) {
           console.log('selection made'); 

        }

    }).bind('keydown', function() {
        var key = event.keyCode;
        if (key == $.ui.keyCode.ENTER || key == $.ui.keyCode.NUMPAD_ENTER) {
            console.log('user submitted content');
        }
    }); 
```

对于绑定 keydown，问题是即使进行了选择，它也总是会触发。如果用户没有从自动完成中选择一个项目，我怎样才能使绑定 keydown 只触发？有没有一种方法可以检测用户是否选择了一个项目？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T00:32:00.710

您可以将一个变量存储在`data-*`每个属性的属性中，该属性`input`包含一个值，该值指示是否选择了一个值。

这适用于一个警告，我将在代码之后解释：

```
$("#rwF1, #rwF2").autocomplete({
    source: itemshere,
    select: function(event, ui) {
        $(this).data("selected", true);
    }
}).bind("keydown", function(e) {
    var $this = $(this);

    /* Use e.which, jQuery has normalized it across browsers */
    if (e.which === $.ui.keyCode.ENTER || 
        e.which === $.ui.keyCode.NUMPAD_ENTER) {

        /* If they selected an item... */
        if (!$this.data("selected")) {
            console.log("new item");
        } else {
            console.log('existing');
        }
    } else {
        $this.data("selected", false);
    }
}); 
```

**示例：http:** [//jsfiddle.net/aAD6W/2/](http://jsfiddle.net/aAD6W/2/)

我提到的警告是，如果用户在列表中键入一个项目*而不*选择它，`select`则不会被触发。如果这对你来说是一个破坏者，我可以提供一个解决方案（我没有在这里包括它，因为它会增加代码的复杂性）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:39:28.910

我一直在寻找相同的方法，因此提出了以下 解决
方案

```
 $(function() {
                    (function( $ ) {
                $.widget( "ui.combobox", {
                        _create: function() {
                            var self = this,
                                select = this.element.hide(),
                                selected = select.children( ":selected" ),
                                value = selected.val() ? selected.text() : "";
    // Change 1  Added selector instead of actual HTML so you can use this with any input                       
    var input = this.input = $( "#input_id" )    // your input box
                                .insertAfter( select )
                                .val( value )
                                .autocomplete({
                                    delay: 0,
                                    minLength: 0,
                                    source: function( request, response ) {
                                        var matcher = new RegExp( $.ui.autocomplete.escapeRegex(request.term), "i" );
                                        response( select.children( "option" ).map(function() {
                                            var text = $( this ).text();
                                            if ( this.value && ( !request.term || matcher.test(text) ) )
                                                return {
                                                    label: text.replace(
                                                        new RegExp(
                                                            "(?![^&;]+;)(?!<[^<>]*)(" +
                                                            $.ui.autocomplete.escapeRegex(request.term) +
                                                            ")(?![^<>]*>)(?![^&;]+;)", "gi"
                                                        ), "<strong>$1</strong>" ),
                                                    value: text,
                                                    option: this
                                                };
                                        }) );
                                    },
                                    select: function( event, ui ) {
                                        ui.item.option.selected = true;
                                        self._trigger( "selected", event, {
                                            item: ui.item.option
                                        });
                                    },
                                    change: function( event, ui ) {
                                        if ( !ui.item ) {
                                        var matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( $(this).val() ) + "$", "i" ),
                                            valid = false;
                                            select.children( "option" ).each(function() {
                                            if ( $( this ).text().match( matcher ) ) {
                                            this.selected = valid = true;
                                            return false;
                                            }
                                            });
// Change 2 Commented this block so that user can enter value other than select  options                                            
//if ( !valid ) {
                                                // remove invalid value, as it didn't match anything
                                                //$( this ).val( "" );
                                                //select.val( "" );
                                                //input.data( "autocomplete" ).term = "";
                //return false;
                    //                      }
                                        }
                                    }
                                })
                                .addClass( "ui-widget ui-widget-content ui-corner-left" );

                            input.data( "autocomplete" )._renderItem = function( ul, item ) {
                                return $( "<li></li>" )
                                    .data( "item.autocomplete", item )
                                    .append( "<a>" + item.label + "</a>" )
                                    .appendTo( ul );
                            };

                            this.button = $( "<button type='button'>&nbsp;</button>" )
                                .attr( "tabIndex", -1 )
                                .attr( "title", "Show All Items" )
                                .insertAfter( input )
                                .button({
                                    icons: {
                                        primary: "ui-icon-triangle-1-s"
                                    },
                                    text: false
                                })
                                .removeClass( "ui-corner-all" )
                                .addClass( "ui-corner-right ui-button-icon" )
                                .click(function() {
                                    // close if already visible
                                    if ( input.autocomplete( "widget" ).is( ":visible" ) ) {
                                        input.autocomplete( "close" );
                                        return;
                                    }

                                    // work around a bug (likely same cause as #5265)
                                    $( this ).blur();

                                    // pass empty string as value to search for, displaying all results
                                    input.autocomplete( "search", "" );
                                    input.focus();
                                });
                        },

                        destroy: function() {
                            this.input.remove();
                            this.button.remove();
                            this.element.show();
                            $.Widget.prototype.destroy.call( this );
                        }
                    });
                })( jQuery );
                    $( "#combobox" ).combobox();
                    $( "#toggle" ).click(function() {
                        $( "#combobox" ).toggle();
                    });
                }); 
```

HTML

```
<select id="combobox">
    <option value="">Select one...</option>
    <option value="ActionScript">ActionScript</option>
    <option value="AppleScript">AppleScript</option>
    <option value="Asp">Asp</option>
        <option value="BASIC">BASIC</option>
</select> 
```

无需使用`Id`任何 css 类`input`，只需更改 js 文件中的 jquery 选择器即可。（变更一）

[链接](https://stackoverflow.com/questions/8180890/drop-down-with-free-input)到实际问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:39:34.043

你试过`keyUp`吗？我们在工作中为职位做同样的事情，允许从自动完成中选择*或*输入他们喜欢的内容，然后将其保存到数据库中。这是我们的代码：

```
var jobs = new Array();

for (var i = 0; i < data.length; i++) { //data comes from AJAX call
    jobs[i] = { label: data[i].Value, text: data[i].Text };
}

$("#ContactJobTitleName").autocomplete({
    source: jobs,
    select: function (event, item) {
        $("#ContactJobTitleId").val(item.item.text);
    }
}); 
```

我们这样做是为了重置选定的职位，但您可以使用它来保存您的新项目：7

```
$("#ContactJobTitleName").keyup(function (e) {
    if (e.which == 8 && $(this).val().length == 0) {
        $("#ContactJobTitleId").val(0);
    }
}); 
```

# php - 根本无法运行 phing

> ID：10253187
> 
> 赞同：10
> 
> 时间：2012-04-20T20:33:36.360
> 
> 标签：php, phing

Max OS X 10.7 .. 运行时`phing -v`出现以下错误：

```
Warning: require_once(phing/Project.php): failed to open stream: No such file or directory in /usr/lib/php/pear/phing/Phing.php on line 22

Fatal error: require_once(): Failed opening required 'phing/Project.php' (include_path='.:') in /usr/lib/php/pear/phing/Phing.php on line 22 
```

### 以下是我使用的命令：

```
pear config-set auto_discover 1
pear install phing/phing 
```

### 这是我的 php.ini：

```
include_path = ".:/Applications/MAMP/bin/php/php5.3.6/lib/php" 
```

### 为 php、pear 和 phing 运行 whereis 会返回：

```
bash-3.2$ whereis php
/usr/bin/php

bash-3.2$ whereis pear
/usr/bin/pear

bash-3.2$ whereis phing
/usr/bin/phing 
```

### 运行 config-get 获取梨返回：

```
→ pear config-get php_dir
/usr/lib/php/pear 
```

检查此文件夹，`system.php`并且`phing.php`两者都存在于此路径中。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-20T21:40:46.650

好像`include_path`是莫名其妙坏了。

### 检查 PEAR 的目录：

```
pear config-get php_dir
/usr/lib/php 
```

无论返回什么目录，它都应该包含 PEAR 文件（`System.php`尤其`phing`是文件）

### 检查是否`php.ini`使用了正确的：

运行`php --ini`并查看正在加载的 INI 文件。然后确保这个 INI 文件中包含 PEAR 目录`include_path`

### 检查`include_path`：

运行`php -c /path/to/php.ini -r 'echo get_include_path() . "\n";'`。

* * *

**更新**

问题确实存在，`include_path`因为错误消息报告`(include_path='.:')`清楚地表明 PEAR 不在您的包含路径中。这意味着`php.ini`为 CLI PHP 加载了错误。要修复它，找到正确的`php.ini`文件（步骤 2）并添加

```
include_path = ".:/usr/lib/php/pear" 
```

给它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-06T21:20:52.820

我解决它很简单...

我正在配置我的 /etc/paths 以在我的路径环境中包含推进生成器。

然后我添加 /Application/XAMPP/bin 和 /Application/XAMPP/Propel/generator/bin

我得到了包含错误。Mac 系统预装了 php ......所以，propel generator 出现了错误的 php 安装。

我解决它很简单......我只是改变了 /etc/paths 文件夹的顺序......

如您所见，我的 /etc/paths 文件：

```
/Applications/XAMPP/bin
/usr/bin
/bin
/usr/sbin
/sbin
/usr/local/bin
/Applications/XAMPP/Propel/generator/bin 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T00:26:14.380

只是想为 mac LION 用户（通过 macport 安装东西的用户）添加一个更简单的解决方案，也可能适用于 leopard

1.  在任何地方下载这个脚本，不管它在哪里

    ```
    curl http://pear.php.net/go-pear.phar > go-pear.phar 
    ```

2.  运行这个命令

    ```
    sudo php -q go-pear.phar 
    ```

3.  它会询问您的路径，您不需要更改它，只需检查这些路径是否包含任何与梨相关的文件。

4.  它会询问您是否要使用这些包含路径 [Y] 为您更新 php.ini

你完成了！输入 phing 你应该询问你的 build.xml

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-20T21:14:56.640

或者，如果您无权访问服务器，则可以这样做：

`$root = $SERVER['DOCUMENT_ROOT'];`

它总是会引用您项目的根目录，然后您可以从中引用文件夹/文件。
如果这样做，您不必触摸服务器。

# jquery - 理解 Deferred.pipe()

> ID：10253192
> 
> 赞同：19
> 
> 时间：2012-04-20T20:34:10.310
> 
> 标签：jquery, jquery-deferred

我一直在阅读有关 jQuery 中的延迟和承诺，但我还没有使用它。

除了方法管道，我已经很好地理解了一切。我真的不明白它是什么。

有人可以帮助我了解它的作用以及可以在哪里使用吗？

*我知道有一个问题的标题与这个（[这里](https://stackoverflow.com/questions/5921283/understanding-jquery-deferred-pipe)）完全一样，但它不一样。我正在寻求帮助以理解它和一些例子。另一个问题的目的是了解为什么它在特定情况下不起作用。*

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-04-20T21:19:21.540

基本上，[Deferred.pipe()](http://api.jquery.com/deferred.pipe/)是异步的[$.map()](http://api.jquery.com/jQuery.map/)等价物。它从作为输入提供的其他值投射新值，但其目的是与延续一起使用。

让我们从一个只需要`$.each()`并发出返回简单对象的 AJAX 请求的示例开始。对于该对象的每个属性，我们希望其`id`属性为属性键的表单控件将其值设置为属性值。我们可以这样写：

```
$.ajax("your/url", {
    dataType: "json"
}).done(function(data) {
    $.each(data, function(key, value) {
        $("#" + key).val(value);
    });
}); 
```

现在假设我们想在更新表单控件之前对值应用一些函数。如果我们在本地这样做，我们只需要编写：

```
$.ajax("your/url", {
    dataType: "json"
}).done(function(data) {
    $.each(data, function(key, value) {
        // doSomethingWith() projects values synchronously, as map() does.
        $("#" + key).val(doSomethingWith(value));
    });
}); 
```

但是，如果`doSomethingWith()`不是在客户端实现，而是通过另一个 Web 服务在服务器端实现，会发生什么？在这种情况下，我们希望将控制流链接到第二个 AJAX 请求中，并且仅在第二个请求返回时更新表单控件。`Deferred.pipe()`让这很容易：

```
$.ajax("your/url", {
    dataType: "json"
}).pipe(function(theOriginalData) {
    return $.ajax("your/web/service/doSomethingWith", {
        data: theOriginalData,
        dataType: "json"
    });
}).done(function(theFinalData) {
    $.each(theFinalData, function(key, value) {
        $("#" + key).val(value);
    });
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-20T21:19:49.377

好的，我在这里的另一个答案中看到了很多参考资料，但是阅读有时不等于理解。

我发现最容易想到 Promise 和 .done() 对它的应用与 .pipe() 对它的应用。每个人的行为都不一样。如果我采用 promise.done(function (result) { ... }) 那么我可以在之后添加更多的 .done() 或 .fail()，因为每次调用 .done() 或 .fail( ) 返回完全相同的承诺。因此，每个函数都将与原始承诺相关联，以及它是否被解决或拒绝。

现在，将其与 .pipe() 进行对比。如果我接受 promise.pipe(function (result) { ...}) 那么 .pipe() 的结果就是一个全新的承诺！如果我随后将 .done() 或 .fail() 附加到该承诺，那么这些函数将获得 .pipe() 返回的结果的修改版本，而不是原始结果。

所以 .pipe() 根据我的经验，很少需要。它真正派上用场的唯一时间是，如果您需要在其他代码看到它之前修改从承诺返回的数据（例如，在任何其他客户端代码使用之前修改客户端 AJAX 调用的某些结果）它）或者如果您需要对事物进行排序。例如，在 Promise A 解决或拒绝之后，采取另一个行动，然后只有当这完成后，我们才希望其他代码最终触发。所有其他代码都附加到来自 .pipe() 调用的承诺 B。

这是一个最近的问题，另一个用户在使用 Promise 和 .pipe()/.done()/.when() 时遇到问题，我试图提供一些代码来澄清 jsFiddle 中每个用户的使用：[Do something when所有延期都已解决](https://stackoverflow.com/questions/10140206/do-something-when-all-deferreds-are-resolved)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T20:43:08.377

嗨，这就是你要找的东西:)

[很好读] [http://www.bennadel.com/blog/2255-Using-jQuery-s-Pipe-Method-To-Change-Deferred-Resolution.htm](http://www.bennadel.com/blog/2255-Using-jQuery-s-Pipe-Method-To-Change-Deferred-Resolution.htm)

**引用**

> pipe() 方法为（AJAX 请求的）成功和失败解决方案提供了一个过滤器。如果原始解析成功，则 pipe() 过滤器要么传递真正成功的响应；或者，它改变决议，返回一个新的被拒绝的承诺。然后，如果原始请求失败，这在我们的 API 中确实是出乎意料的，那么 pipe() 过滤器只会通过规范化的 API 响应结构......

**带有示例的堆栈链接** [了解 jQuery Deferred.pipe()](https://stackoverflow.com/questions/5921283/understanding-jquery-deferred-pipe)（其中包含 jsfiddle）

**了解延期和承诺？请看这里** [http://joseoncode.com/2011/09/26/a-walkthrough-jquery-deferred-and-promise/](http://joseoncode.com/2011/09/26/a-walkthrough-jquery-deferred-and-promise/)

**Jquery官方API页面** [http://api.jquery.com/deferred.pipe/](http://api.jquery.com/deferred.pipe/) （附示例）

> 描述：过滤和/或链接延迟的实用方法。
> 
> deferred.pipe() 方法返回一个新的 promise，它通过函数过滤 deferred 的状态和值。doneFilter 和 failFilter 函数过滤原始 deferred 的已解决/已拒绝状态和值。从 jQuery 1.7 开始，该方法还接受一个 progressFilter 函数来过滤对原始 deferred 的 notify 或 notifyWith 方法的任何调用。

# php - 警告：mysql_result()：提供的参数不是第 9 行 /home/a5751969/public_html/func/user.func.php 中的有效 MySQL 结果资源

> ID：10253195
> 
> 赞同：1
> 
> 时间：2012-04-20T20:34:28.750
> 
> 标签：php, mysql, html

我已经查看了很多次代码并重写了它，但仍然无法弄清楚如何修复错误。

有6-10行；

```
function login_check ($email, $password) {
$email = mysql_real_escape_string ($email);
$login_query = mysql_query("SELECT COUNT(`user_id`) as `count`,`user_id` FROM `users` WHERE `email`='$email' AND `password`='".md5($password)."'");
return (mysql_result($login_query, 0) == 1) ? mysql_result($login_query, 0, 'user_id') : false; 
```

}

重写代码；

```
function login_check ($email, $password) {
    $email = mysql_real_escape_string($email);
    $login_query = mysql_query("SELECT COUNT(`user_id`) as `count`, `user_id` FROM `users` WHERE `email`='$email' AND `password`='".md5($password)."'");
    return (mysql_result($login_query, 0) == 1) ? mysql_result($login_query, 0, 'user_id') : false; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:37:41.167

您的 SQL 语句需要一个 GROUP BY 子句。

```
"SELECT COUNT(`user_id`) as `count`,`user_id` 
    FROM `users` 
    WHERE `email`='$email' 
        AND `password`='".md5($password)."'
    GROUP BY `user_id`" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:40:14.193

由于传递的参数，这似乎是一个错误。我可以在这里想到几个解决方案。1\. 在将参数传递给查询之前回显参数。2\. 也可以在 MySQL 上尝试 SQL 查询，看看你是否得到了你想要的结果。

# django - SlugField 中的连字符

> ID：10253200
> 
> 赞同：0
> 
> 时间：2012-04-20T20:34:45.210
> 
> 标签：django, django-models, django-views, slug, hyphen

当我在 slug 中打开带有连字符的 URL 时出现一个奇怪的错误，尽管 SlugField 支持其中的连字符，如文档中所示。

所以，这是错误：

```
Page not found (404)
Request Method: GET
Request URL:    http://127.0.0.1:8003/dumpster-rental-prices
Using the URLconf defined in dumpster.urls, Django tried these URL patterns, in this order:
^admin/
^(?P<slug>\w+)/$
The current URL, dumpster-rental-prices, didn't match any of these. 
```

如果我将文章的 slug 更改为 dumpster_rental_prices - url 127.0.0.1:8003/dumpster_rental_prices 可以正常打开。

这是博客应用程序的models.py：

```
from django.db import models

class Post(models.Model):
    title = models.CharField(max_length = 100)
    body = models.TextField(max_length = 5000)
    slug = models.SlugField(max_length = 100)

    def __unicode__(self):
        return self.title 
```

这是博客目录中的 urls.py：

```
from django.conf.urls import patterns, include, url
from django.views.generic import DetailView, ListView
from blog.models import Post

from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    url(r'^(?P<slug>\w+)/$',
        DetailView.as_view(
            model=Post,
            template_name='detail.html')),    

) 
```

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T20:47:21.107

问题是您的正则表达式 -`\w`仅匹配字母数字字符和下划线。`r'^(?P<slug>[\w-]+)/$`如果您还想匹配连字符，则需要类似的东西。

# html - 从 DocumentCloud 开始为 JSON 搜索结果设置样式

> ID：10253208
> 
> 赞同：1
> 
> 时间：2012-04-20T20:35:41.530
> 
> 标签：html, css, json

我正在寻找一个系统来设置来自 DocumentCloud 的搜索结果的样式（并允许我链接到给定的文档）。

我知道我可以使用如下搜索字符串查询 DocumentCloud 并返回 JSON 结果：

[https://www.documentcloud.org/api/search.json?q=obama](https://www.documentcloud.org/api/search.json?q=obama)

我不知道如何：

1.  抓取搜索的输出并将其放在我自己的页面上
2.  一旦我在我的页面上设置了数据样式

我只是想知道如何开始使用它，我对 HTML 和 CSS 有经验，但我以前从未使用过 JSON。

这里有更多信息，但我只是不知道从哪里开始：[https ://www.documentcloud.org/help/api](https://www.documentcloud.org/help/api)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:15:17.437

听起来你对 JavaScript 不太熟悉，对吗？JSON 代表 JavaScript Ojbect Notation，因此要使用它，您必须深入研究一下。我强烈建议研究使用 JavaScript 框架/库，即 jQuery 来处理繁重的工作。（还有其他有价值的库，但 jQuery 是迄今为止最流行的，并且非常友好，使用类似 CSS 的选择器来操作文档对象模型）。

查看这个 jQuery 教程：[jQuery 的工作原理](http://docs.jquery.com/How_jQuery_Works)

这是使用 jQuery 的 jsonp 获取远程 rsult 并在页面中使用它们的入门：http: [//www.ibm.com/developerworks/library/wa-aj-jsonp1/](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/)

您最终可能会在 javascript 文件或脚本标记（在指向 jQuery 库的链接之后）中得到如下所示的代码：

```
$(document).ready(function () {

    $.getJSON('https://www.documentcloud.org/api/search.json?q=obama&callback=?', null, function (results) {
            // this would append whatever the json returns for 'total' 
            // inside an element on your page with an id of 'resultsCount':
            $('#restulsCount').append(data.total); 
          });   

}); 
```

因此，可以以您需要的任何形式/位置将额外的文本和标记添加到页面上已有的元素中，并且页面上链接的任何样式块或 CSS 文件中的常规 CSS 规则将适用于它们。

祝你好运。

# jquery - 使用 JQuery/Ajax 和 Spring 的 JSON 请求

> ID：10253209
> 
> 赞同：5
> 
> 时间：2012-04-20T20:35:43.117
> 
> 标签：jquery, ajax, json, spring-mvc

我对 JSON/Spring MVC 非常陌生，并且正在尝试获取一个简单的 AJAX 调用 Spring MVC 控制器示例 - 但我一直返回错误 400 - 错误请求。

在网上搜索后，我发现这通常是由于没有设置适当的内容类型造成的——但[我相信]我已经这样做了。

这是我的 AJAX 调用：

```
 //validate the object
    var urlString = "/ajax/add/";

    $.ajax({
        type:"POST",
        url: urlString,
        contentType: "application/json; charset=utf-8",
        dataType: "json", 
        data: {value1: 'apples', value2 : 'oranges'},
        success: function(result){
            alert("success");
        },
        error: function(jqXHR, textStatus, errorThrown){
            alert("error:" + textStatus + " exception:" + errorThrown);
        }

    }) ; 
```

我的控制器：

```
@Controller
itpublic class AddController {

private static Logger m_log = null;

@RequestMapping(value = "/ajax/add")
public String handle(@RequestBody String json){

    DummyClass dummyRequest;
    try {

        ObjectMapper mapper = new ObjectMapper();
        dummyRequest = mapper.readValue(json, DummyClass.class);
        m_log.info("Value1: " + dummyRequest.getValue1());
        m_log.info("Value2: " + dummyRequest.getValue2());
    }  catch (Exception e) {

    }
    finally{

    }
    return "called";
} 
```

谁能帮我吗？

*编辑*

这是我用来配置 Spring 的上下文：

```
 <?xml version="1.0" encoding="UTF-8"?>
 <beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:mvc="http://www.springframework.org/schema/mvc"
xmlns:p="http://www.springframework.org/schema/p" xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

<context:component-scan base-package="com.project.do" />

<!--<mvc:annotation-driven/> -->

<bean class="com.project.do.interceptors.handler.mapping.HandlerInterceptorAnnotationAwareHandlerMapping "/>

<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter" />

<bean class="com.project.do.viewresolver.ProjectViewResolver" >
    <property name="tilesResolver" ref="tilesResolver" />
    <property name="jspResolver" ref="jspResolver" />
</bean>

<bean id="tilesResolver" class ="org.springframework.web.servlet.view.UrlBasedViewResolver">
    <property name="viewClass" value="org.springframework.web.servlet.view.tiles2.TilesView" />
    <property name="order" value="2" />
</bean>

<bean id="jspResolver"
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/jsp/" />
    <property name="suffix" value=".jsp" />
    <property name="order" value="3" />
</bean>

<bean id ="tilesConfigurer" class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
    <property name="definitions" value="/WEB-INF/tiles/tiles.xml" />
    <property name="preparerFactoryClass" value="org.springframework.web.servlet.view.tiles2.SpringBeanPreparerFactory"/>
</bean>

<mvc:resources mapping="/css/**" location="/css/" />
<mvc:resources mapping="/js/**" location="/js/" />
<mvc:resources mapping="/images/**" location="/images/" />
<mvc:resources mapping="/javascript/**" location="/javascript/" />
<mvc:resources mapping="/scripts/**" location="/scripts/" />
<mvc:resources mapping="/styles/**" location="/styles/" />
<mvc:resources mapping="/help/**" location="/help/" />

<!-- <mvc:view-controller path="/" view-name="welcome"/> --> 
```

我应该注意到我在 com.project.do.working 包中有一个带有 Ajax 的工作控制器，但是带有 Ajax 和 JSON 的非工作控制器在同一个包 com.project.do.not.working 中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T23:27:02.900

我认为您的请求映射没有将 RequestMethod 作为 POST。我猜默认情况下它接受一个获取请求，但你的 AJAX 是一个 POST 请求。尝试如下更改

```
@RequestMapping(value = "/ajax/add", method = RequestMethod.POST)
public String handle(@RequestBody String json){
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T03:17:21.017

```
@Controller
@RequestMapping("/employee/add.htm")
public class EmployeeController {
    @RequestMapping(method = RequestMethod.POST)
    public @ResponseBody
    Employee add(HttpServletRequest request, HttpServletResponse response)
            throws Exception {

    }
} 
```

# c++ - c++部分专业化：我怎样才能专门化这个模板 到这个模板 ?

> ID：10253219
> 
> 赞同：3
> 
> 时间：2012-04-20T20:37:27.047
> 
> 标签：c++, templates, partial-specialization

```
#include <iostream>
using namespace std;

template <class T1, class T2>
class A {
public:
    void taunt() { cout << "A"; }
};

template <class T1>
class A<T1, T1> {
public:
    void taunt() { cout << "B"; }
};

class B {};

class C {};

int main (int argc, char * const argv[]) {

    A<B> a;

    return 0;
} 
```

如何将我的两个参数模板转换为一个参数模板？

上面的代码会在 'A a;' 上给出一个编译器错误 对于“错误数量的模板参数”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T20:45:38.807

模板专业化不能用于减少模板参数的数量，为此您应该为某些参数使用默认值。

因此，为了只允许使用一个参数，并使该用法符合您的专业，您需要第二个参数的默认值，这与第一个参数相同：

```
#include <iostream>
using namespace std;

template <class T1, class T2=T1>
class A {
public:
    void taunt() { cout << "A"; }
};

template <class T1>
class A<T1, T1> {
public:
    void taunt() { cout << "B"; }
};

class B {};

class C {};

int main (int argc, char * const argv[]) {

    A<B> a;
    a.taunt(); // Prints "B"

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:41:48.510

您可以为第二种实例化类型使用（合理的）默认值：

```
template <class T1, typename T2 = void>
class A {
public:
    void taunt() { cout << "A"; }
}; 
```

# c++ - 继承类中的c ++虚函数

> ID：10253224
> 
> 赞同：1
> 
> 时间：2012-04-20T20:37:55.740
> 
> 标签：c++

我知道当你想声明一个多态函数时，你必须声明基类函数 virtual。

```
class Base
{
public:
    virtual void f();
}; 
```

我的问题是您是否需要将继承类函数声明为虚拟，即使预期 Child 的行为就像它被“密封”一样？

```
class Child : public Base
{
public:
    void f();
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T20:38:48.757

不，您不需要重新声明虚拟功能。

基类中的`virtual`函数将自动将所有覆盖函数声明为虚拟函数：

```
struct A
{
   void foo();          //not virtual
};
struct B : A
{
   virtual void foo();  //virtual
}
struct C : B
{
   void foo();          //virtual
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:15:09.447

在 Child 中将 f() 声明为 virtual 有助于某些人阅读 Child 的定义。它作为文档很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:31:40.513

一旦基类覆盖被标记为`virtual`所有其他覆盖都隐含地如此。虽然您不需要标记该功能，因为`virtual`我倾向于出于文档目的这样做。

截至最后一部分：*即使预期 Child 表现得好像它被“密封”一样？*，如果你想*密封*类，你实际上可以在 C++11 中做到这一点（这在 C++03 中通常不能完全实现），方法是创建一个*密封*类，如下所示：

```
template <typename T>
class seal {
   seal() {}
   friend T;
}; 
```

然后从它继承你的密封类（CRTP）：

```
class Child : public Base, virtual seal<Child> {
// ...
}; 
```

诀窍在于，由于使用了虚拟继承，层次结构中最派生的类型必须调用虚拟基础构造函数（在这种情况下为 int `seal<Child>`），但该构造函数在模板类中是私有的，并且只能`Child`通过`friend`声明使用。

在 C++ 中，您必须为`seal`要密封的每个类创建一个类型，或者使用不能提供*完美*密封的通用方法（它可能被篡改）

# android - 从光标填充的 AlertDialog。从选定的项目中获取 ID

> ID：10253225
> 
> 赞同：0
> 
> 时间：2012-04-20T20:38:02.107
> 
> 标签：android, cursor, android-alertdialog

我正在为我正在制作的游戏制作设备屏幕。我让用户单击图像按钮。此按钮会弹出一个从库存数据库填充的 alertDialog。库存数据库具有字段（_id、Desc、Number、EquipSlot）。当用户单击我想要获取_id 的值的项目之一时，我就可以获取数字。从那里我将获取编号并交叉引用包含游戏中所有项目的数据库。这样我就可以弄清楚它附加了哪些统计数据，并更新了我的数据库，该数据库存储了角色信息以及当前佩戴的设备。我不知道如何让这个 _id 完成上述操作。以下是我到目前为止所拥有的。

```
 @Override
    protected Dialog onCreateDialog(final int id) {

      switch (id) {
      case DIALOG_MELEE_ID:
          buildDialog();
        break;
      case DIALOG_RANGE_ID:
          buildDialog();
        break;
     ...
      default:
          dialog = null;
              }
      return dialog;
    }

  @Override
    protected void onPrepareDialog(final int id, final Dialog dialog) {
      switch (id) {
      case DIALOG_MELEE_ID:
          pullInventoryCursor(1);
        break;
      case DIALOG_RANGE_ID:
          pullInventoryCursor(2);
        break;
     ...
      }
    }

    public void equipSlot1(View v){
        showDialog(DIALOG_MELEE_ID);
    }

    private void buildDialog(){
        int selectedItem = -1; //somehow get your previously selected choice
        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setTitle("Select Weapon").setCancelable(true);
        builder.setSingleChoiceItems(inventory, selectedItem, "Desc", new DialogInterface.OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int which)
            {
                //get _id and update dbs as needed.
                dialog.dismiss();

            }
        });

        dialog = builder.create();
    }

    private void pullInventoryCursor(int equipSlot){
        if (slot == 1){
        inventory = mydbhelper.getInventory1(equipSlot);}
        else if (slot == 2){
            // TODO setup database and dbhelper for character slot 2
            inventory = mydbhelper.getInventory1(equipSlot);
        }
        startManagingCursor(inventory);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:58:56.263

您可以从对话框中拉出列表视图，然后通过列表视图的适配器在给定位置检索项目的 ID

```
builder.setSingleChoiceItems(inventory, selectedItem, "Desc", new DialogInterface.OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int which)
            {
                ListView lv = dialog.getListView();
                long itemId = lv.getAdapter().getItemId(which);

                //do whatever you need with the ID in the DB

                dialog.dismiss();

            }
        }); 
```

注：显然

```
long itemId = lv.getItemIdAtPosition(which); 
```

将与

```
long itemId = lv.getAdapter().getItemId(which); 
```

# java - Oracle 中的批处理失败。找出批处理中的哪个语句导致它

> ID：10253226
> 
> 赞同：2
> 
> 时间：2012-04-20T20:38:08.427
> 
> 标签：java, database, oracle11g, relational-database, struts-1

我正在从 excel 表中提取数据并将它们插入到我的 oracle 表中。数据库的设置方式是，在执行批处理语句时，如果批处理中的任何插入语句失败，则批处理中的所有其他语句都不会执行。所以我的问题是如何找出是哪一行数据实际导致了它，所以我可以向用户发送一条消息，其中包含导致问题的数据的行号？

```
Connection con = null;
    PreparedStatement pstmt = null;
    Iterator iterator = list.iterator();
    int rowCount = list.size();
    int currentRow = 0;
    String sqlStatement = "INSERT INTO DMD_VOL_UPLOAD (ORIGIN, DESTINATION, DAY_OF_WEEK, VOLUME)";
    sqlStatement += " VALUES(?, ?, ?, ?)";
int batchSize==1000;
for(currentRow=1; currentRow<=rowCount; currentRow++){
            ForecastBatch forecastBatch = (ForecastBatch)      iterator.next();                                 
            pstmt.setString(1, forecastBatch.getOrigin());
            pstmt.setString(2, forecastBatch.getDestination());
            pstmt.setInt(3, forecastBatch.getDayOfWeek());                                          
            pstmt.setInt(4, forecastBatch.getVolumeSum());

            pstmt.addBatch();
        if(i % batchSize == 0){
                updateCounts = pstmt.executeBatch();
                con.commit();
                pstmt.clearBatch();
                session.flush();
                session.clear();
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:22:27.283

`executeBatch`返回一个整数数组，其中包含批处理中每个语句修改的所有行的计数。我认为负数用于表示错误。您应该能够使用此返回值找出哪些失败。

[http://docs.oracle.com/javase/1.3/docs/guide/jdbc/spec2/jdbc2.1.frame6.html](http://docs.oracle.com/javase/1.3/docs/guide/jdbc/spec2/jdbc2.1.frame6.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T22:16:42.950

java.sql.Statement 的 javadoc 说如果发送到数据库的命令之一未能正确执行或尝试返回结果集，则会 `executeBatch()`抛出（SQLException 的子类）。`BatchUpdateException`

“..检索在此异常发生之前成功执行的批量更新中每个更新语句的更新计数...” `getUpdateCount()`的 方法`java.sql.BatchUpdateException`

如果这些都不起作用，您可能不得不退回到单独执行和提交每个语句（在此特定批次中），直到遇到错误。

# javascript - Javascript - 具有未确定数量值的未确定数量选项的排列/组合

> ID：10253231
> 
> 赞同：1
> 
> 时间：2012-04-20T20:38:28.293
> 
> 标签：javascript, permutation, combinations

长期读者，第一次在这里作家。

我试图找出一组未确定的 javascript 数组的所有可能组合，但似乎找不到太多帮助。

因此，如果您可以想象下拉列表组（这是最终使用），其中可能存在用户定义的任意数量的下拉列表，并且每个下拉列表都有用户定义的任意数量的可能值。（每个选项一次只能选择一个值。）

所以举个例子...

```
var options = [
{
    label:"Colors", 
    values:["red", "green", "blue", "etc"]
},
{
    label:"Sizes",
    values:["small", "medium", "large", "xl", "etc"]
},
{
    label:"styles",
    values:["t-shirt", "v-neck", "hoodie", "vest", "etc"]
}
//and any number of options, with any numbers of values
]; 
```

现在从那里我需要生成所有可能的结果，从每个选项中选择一个值（如果解决方案可以有一个可选的选项，那么也许有时它可以设置为生成所有可能的组合，包括如果只有一个值被选中）。

所以我希望有一个解决方案

```
function combinations(options, option_optional){

} 
```

只有独特的组合，然后我可以建立一个像这样的列表

如果选项是可选的：

```
[
    ["red"],
    ["red", "large"],
    ["red", "large", "tshirt"],
    ["large"],
    ["large", "t-shirt"] 
```

ETC...

或者如果必须选择所有选项：

```
[
    ["red", "large", "t-shirt"],
    ["red", "medium", "t-shirt"], 
```

等等

我尝试查看其他解决方案，但只能找到能够返回所有可能组合的解决方案。

任何帮助表示赞赏，如果您更喜欢使用 jquery 的 $.each for 循环，那也很好。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T18:14:53.407

几个月后再次回到这个问题后，我在这里找到了我的问题的答案： [https ://stackoverflow.com/questions/4796678/javascript-golf-cartesian-product?lq=1](https://stackoverflow.com/questions/4796678/javascript-golf-cartesian-product?lq=1)

# algorithm - 确定是否可以通过插入字符将一个字符串更改为另一个的算法？

> ID：10253235
> 
> 赞同：1
> 
> 时间：2012-04-20T20:39:00.670
> 
> 标签：algorithm, insertion

假设我有一个长度为 N 的“目标字符串”（或列表，并不重要）。为简单起见，假设有两个且只有两个可能的字符，“A”和“B”。因此，例如，目标字符串可能是“ABBABB”。

然后给我一个长度为 <= N 的测试字符串（同样，两个可能的字符）。我想确定在唯一合法的转换是插入字符的约束下，测试字符串是否可以转换为目标字符串。

例如，再假设目标是 ABBABB，测试是 BBB。那么答案是肯定的，测试可以转化为目标；例如：BBB -> BBAB -> ABBAB -> ABBABB。

但是如果测试是 BABA，那么它就无法转换为目标，因为目标以 A 开头，测试不会，并且在测试中插入 A 将不起作用，因为这会导致它有更多的 A比目标有。

显然，我可以通过暴力破解所有可能的字符插入序列来做出这个是或否的决定。但是有没有更有效的方法？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T21:08:02.750

乍一看，简单的答案似乎是如果测试字符串顺序包含在目标字符串中，那么您的测试就通过了。

就像是：

```
int i = 0;
foreach (char c in target) {
    if (i == test.Length) return true; // Found all test chars
    if (test[i] == c) {
        i++; // found this test char; check for next
        if (i == test.Length) break;
    }
}
return i == test.Length; // Found all test chars 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:44:22.297

您可以使用动态编程来解决这个问题。令 X 为初始字符串，Y 为最终字符串。让我们解决相反的问题，即从 Y 中删除，看看我们是否可以得到 X。

```
F(Y,X) = (if X[0]=Y[0]: F(X[1:],Y[1:] ) or F(Y[1:],X) 
```

结束条件：`If X='', return True elsif Y='' return False`

请注意，与所有动态规划问题一样，您需要为 len(X)*len(Y) (i,j) 的不同组合计算并存储 F(X[i:],F[j:])。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:56:45.040

1) 将测试/目标字符串转换为数组，其中每个元素是一对描述连接的“A”和“B”的数量。

例如 ABBABB ==> { (1,2) (1,2) }; BBB ==> { (0,3) }; 巴巴 ==> { (0,1) (1,1) (1,0) }

2）定义元素级别包含：如果a>=c且b>=d，则P1（a，b）包含P2（c，d）

在两个元素 P1 (a,b) 和 P2 (c,d) 上定义两个操作

合并A(P1,P2) ==> (a+c,d);

合并B(P1,P2) ==> (a,b+d)

3）现在我们有一个抽象的问题：给定测试数组{T1，T2，...，Tn}和目标数组{A1，A2，...Am}，指示目标数组是否包含测试数组。这里“包含”可以递归定义。

如果 i，目标数组包含测试数组。目标数组具有与测试数组相同或更多的元素；ii. 对于 [1,m] 中的每个 i，Ai 都包含 Ti

或者

mergeA(A1,A2), A3, A4 ... 包含测试数组

或者

mergeB(A1,A2), A3, A4 ... 包含测试数组

4) 伪代码

```
bool ifContain(Pair[] target, Pair[] test) {
    if (test.length>target.length) return false;
    if (test.length()==1) 
        return (target.A>=test.A && target.B>=test.B);
    return   (ifContain(target[0], test[0]) && ifContain(targe(1,:),test(1,:)))
        || ifContain(Pair(target[0].a,target[0].b+target[1].b)+target(2,:),test)
        || ifContain(Pair(target[0].a+target[1].a+target[1].b)+target(2,:),test);
} 
```

# mysql - 如何计算 MySql 中引用外键的行数？

> ID：10253239
> 
> 赞同：5
> 
> 时间：2012-04-20T20:39:18.990
> 
> 标签：mysql, foreign-keys

假设一个像这样的表

```
CREATE TABLE `testdb`.`test` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

还有其他表可能有引用 test.id 列的外键。有趣的是我不知道什么表有这样的外键，也不知道表有多少行。

现在我想计算分散在具有 test.id 外键的表中的行数。是否可以？

我认为理论上是可以的，否则MySql不能做类似的操作`ON DELETE CASCADE`，`DELETE SET NULL`...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T20:57:29.037

**显示所有引用的表和行数**

```
SELECT rc.table_name, t.TABLE_ROWS
FROM `REFERENTIAL_CONSTRAINTS` rc
INNER JOIN `TABLES` t ON t.TABLE_NAME = rc.TABLE_NAME
WHERE rc.REFERENCED_TABLE_NAME = "test" 
```

**显示所有引用表行数的总和**

```
SELECT SUM(t.TABLE_ROWS) AS allReferencedTablesRowCount
FROM `REFERENTIAL_CONSTRAINTS` rc
INNER JOIN `TABLES` t ON t.TABLE_NAME = rc.TABLE_NAME
WHERE rc.REFERENCED_TABLE_NAME = "test" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:51:22.047

如果您定义了外键约束，您可以从数据库模式中读取它们，以查看哪些表中的哪些列链接到您的主键。

编辑：[检查这个](http://www.artfulsoftware.com/infotree/mysqlquerytree.php)（在左侧选择“数据库元数据”->“查找子表”）

# phpunit - 如何确定 PHPUnit 测试是否正在运行？

> ID：10253240
> 
> 赞同：34
> 
> 时间：2012-04-20T20:39:19.997
> 
> 标签：phpunit

我目前有一个问题，我必须在遗留代码中解决才能让我们与 PHP 扩展的交互正常工作（[单例测试问题](https://web.archive.org/web/20130305040907/http://stackoverflow.com/questions/10235283/phpunit-singleton-testing-or-skeleton-test-creation-fails-with-error)）。

因此，我不想在使用应用程序运行我们的正常生产代码时执行此代码。因此，如果正在执行的代码作为测试的一部分执行，我需要检查常规 PHP 代码。

关于如何确定这一点的任何建议？我考虑了一个与测试文件本身的存在相关的定义变量（我们不会将测试发送给客户），但我们的开发人员需要扩展才能正常工作，而 CI 服务器需要运行测试。

是否会推荐 PHPUnit.xml 文件中的全局集？其他想法？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-08-01T11:03:55.673

另一种方法是[在 phpunit.xml.* 的 PHP 部分设置一个常量](https://phpunit.de/manual/current/en/appendixes.configuration.html#appendixes.configuration.php-ini-constants-variables)：

```
<php>
   <const name="PHPUNIT_YOURAPPLICATION_TESTSUITE" value="true"/>
</php> 
```

在您的 PHP 应用程序中，您可以使用以下检查：

```
if (defined('PHPUNIT_YOURAPPLICATION_TESTSUITE') && PHPUNIT_YOURAPPLICATION_TESTSUITE)
{ 
    echo 'TestSuite running!';
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-04-20T21:27:09.657

在 PHPUnit`bootstrap.php`文件中定义一个常量。这是在加载或运行任何测试之前执行的。这不应该影响正常运行应用程序的开发人员——只是单元测试。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2018-09-29T02:49:38.710

如果你使用 Laravel 比使用`App::runningUnitTests()`

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-12-20T22:48:46.960

你可以检查`$argv`不同的方法。

```
if(PHP_SAPI == 'cli') {

    if(strpos($_SERVER['argv'][0], 'phpunit') !== FALSE) { ... }
    // or
    if($_SERVER['argv'][0] == '/usr/bin/phpunit') { ... }

} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-03-15T12:03:33.973

## 使用 PHPUnit 常量

您可以定义常量，但这需要您的工作，没有拼写错误并且它不是通用的。如何做得更好？

**PHPUnit 自己定义了 2 个常量：**

```
if (! defined('PHPUNIT_COMPOSER_INSTALL') && ! defined('__PHPUNIT_PHAR__')) {
    // is not PHPUnit run
    return;
}

// is PHPUnit 
```

# android - 碎片和旋转

> ID：10253245
> 
> 赞同：3
> 
> 时间：2012-04-20T20:39:38.547
> 
> 标签：android, orientation, android-fragments

在 Gmail 应用程序中，从左侧片段中选择一封电子邮件会正常打开右侧片段中的电子邮件。如您所料，将设备旋转为纵向仅显示选定的电子邮件，将设备旋转回横向将再次显示电子邮件列表和选定的电子邮件。这一切都在意料之中，而且效果很好。

但是，在 API 演示和我的基于 Fragments 示例的应用程序中，从左侧片段列表中选择一个项目并显示在右侧片段中后，设备旋转到纵向显示列表片段而不是所选项目Gmail 中的详细信息片段。返回横向显示在右侧片段中再次显示所选项目。

API Demos 示例代码：http: [//developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/app/FragmentLayout.html](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/app/FragmentLayout.html)

知道如何重新创建 Gmail 应用程序中显示的内容吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:00:27.247

我怀疑如果您查看纵向模式`/res/layout/fragment_layout.xml`（设置为`contentView`for the `Activity`），您会在`<fragment>`标签中找到对列表片段而不是细节片段的引用。

如果您将其切换为引用细节片段而不是列表片段，那么您将走在正确的轨道上。

考虑到我刚才提到的布局开关，您可能仍然需要深入研究代码以使逻辑完全按照您的要求运行，但这就是开始的地方。

你会遇到另一个问题（虽然我想将这个添加到我的答案中，因为我必须运行，但我还没有考虑过这个问题），那就是当你第一次在 Landscape 中启动 Activity 时，你可能需要并排放置两个片段；这将对应于纵向列表片段。在列表中选择一个项目需要将预期的纵向行为切换为显示另一个片段......所以也许保留一个布尔值`mIsItemSelected`并在您的构造函数中使用它`Activity`来决定您希望显示哪个纵向布局/片段对（列表或细节）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T23:19:03.087

Jon O 的回答把我推向了正确的方向。事实上，在纵向上，XML 只显示了列表片段：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent" android:layout_height="match_parent">
<fragment class="com.dixon.blah.Events$EventsListFragment"
        android:id="@+id/titles"
        android:layout_width="match_parent" android:layout_height="match_parent" />
</FrameLayout> 
```

如果我将其更改为详细信息片段，但是我会得到一个 FC，因为尚未选择列表中的任何项目。我通过将下面的代码放入我的 FragmentActivity onCreate 方法解决了这个问题：

```
if(detailsFrame != null) {
            Intent intent = new Intent();
            intent.setClass(this, EventDetailsActivity.class);
            intent.putExtra("index", mCurCheckPosition);
            intent.putExtra("id", mSelectedId);
            startActivity(intent);
} 
```

一旦选择了列表中的项目， detailsFrame 变量将指向片段的视图。因此，从细节片段中的纵向旋转到横向并再次返回，视图保持并正确显示。

# php - MVC PHP 资源

> ID：10253253
> 
> 赞同：0
> 
> 时间：2012-04-20T20:40:12.380
> 
> 标签：php, frameworks

我想学php。当谈到网络编程时，我是一个初学者。所以，我打算在开始时不使用任何框架，直到我合理地习惯了语言基础[我从 SO 的其他帖子中得到了这个建议]。另外，我在 SO 中找到了几篇文章，通过遵循 php.net 官方网站中的文档来学习 php。

但是，我看到一些帖子建议开发人员参考强调 mvc 和 php 的网站/书籍。那么，我是否朝着选择 php.net 开始 php 的正确方向前进？

[请不要以“未完全构建”的方式结束这个问题，因为我很难构建它，而且我计划从明天开始，所以这个回复非常重要:)]。

谢谢，帕万

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:49:34.567

语言始终是一个偏好问题，我的偏好是 asp.net mvc3（很快 4）远远超过 php。如果你学习 php，你可以开发 php。如果您使用 asp.net 学习 C#，您可以将其用于无数平台（带有 monotouch 的 iPhone 应用程序、带有 monodroid 的 Android 应用程序、Windows Phone 应用程序、桌面应用程序、带有 Mono 的跨平台应用程序、非常好的 Unity 3D 游戏，并且选项继续存在）。

php 的另一个论点是自其开源以来的大量免费贡献者，我认为微软使他们的工具令人惊叹，因为它是他们的主要生计之一。我从未见过可以接近 Visual Studio 2010 的 ide，甚至还没有见过（而且免费版本也非常好）。

最后，一直有大量免费视频发布。阅读很好，但这是 2012 年而不是 1992 年……我必须阅读才能学习，你不需要。投资一台便宜的第二台显示器，然后在一台显示器上观看演示，然后在第二台显示器上进行操作。使用 asp.net 和 www.asp.net，您将非常快速地开发令人惊叹的应用程序并学习一门语言，您可以在当今行业中实现几乎所有您想要的一切，所有这些都是免费的。

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:18:46.247

当有人问我，如何学习 PHP 时，我让他从[w3schools.com](http://www.w3schools.com)开始，因为这个网站包含教程来做一些事情。然后我建议你买一些好的 PHP 书籍/电子书。[如果您负担得起， Lynda](http://www.lynda.com/)视频讲座也是一个不错的起点。否则试试 wrox、packt 和 sams 的电子书是学习 PHP 的好地方。由于作者的目的是教你 PHP，所以他们会告诉你很多东西，而 php.net 之类的网站对那些已经知道如何工作但只是将其用作参考目的的人来说是有益的。

一旦你对 PHP 有良好或至少基本的了解，那么你应该学习一些 MVC 框架，如 Code Igniter 或 Yii 等

然而，目前 PHP 中有很多开发人员，他们有很多，就像他们知道很多框架一样，他们知道很多 CMS，所以我认为进入一些更具体的框架类型是明智的，比如 RubyOnRails，比如 Django 等但是仍然只是一个想法，如果您真的喜欢 PHP 并想学习它，那么我希望以上内容能让您对如何学习有一个很好的了解。

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:43:21.417

php.net 是一个参考站点，并不是真正学习 PHP 的地方。MVC 是不同的东西，它不是特定于 PHP 的，而且它有不同的风格。

我会买一本 APress 或 Wrox 的书，然后通读一遍。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-20T20:46:37.940

[http://php.net/](http://php.net/)只是 PHP 语言的参考，Model-View-Controller 有所不同。

如果您正在寻找 MVC 框架，我会推荐 CodeIgniter。

# c# - 解释委托调用c#的语法

> ID：10253255
> 
> 赞同：3
> 
> 时间：2012-04-20T20:40:34.817
> 
> 标签：c#, multithreading, delegates

在此链接的代码中：[http://c-sharp-programming.blogspot.com/2008/07/cross-thread-operation-not-valid.html](http://c-sharp-programming.blogspot.com/2008/07/cross-thread-operation-not-valid.html)，委托用于从工作人员更新文本框的值线。

我基本上可以看到发生了什么，但是这一行的语法特别：

```
label1.Invoke(del, new object[] { newText }); 
```

让我很困惑。有人可以解释一下吗？当只有一个参数时，为什么我们要为委托使用新的对象数组语法？

**完整代码：**

```
delegate void updateLabelTextDelegate(string newText);
private void updateLabelText(string newText)
{
 if (label1.InvokeRequired)
 {
     // this is worker thread
     updateLabelTextDelegate del = new updateLabelTextDelegate(updateLabelText);
     label1.Invoke(del, new object[] { newText });
 }
 else
 {
     // this is UI thread
     label1.Text = newText;
 }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T20:44:35.413

TL;博士：

`Control.Invoke`正在您的委托上调用[DynamicInvoke](http://msdn.microsoft.com/en-US/library/system.delegate.dynamicinvoke%28v=vs.80%29.aspx)，它采用参数对象数组来处理任何委托类型。

//

C# 中的关键字[delegate](http://msdn.microsoft.com/en-us/library/900fyy8e%28v=vs.71%29.aspx)类似于指定函数指针的类型。您可以使用该*类型*来传递特定签名的方法。在您的示例中，签名用于采用 1 个 arg（字符串）并且不返回任何内容（void）的方法。该方法`updateLabelText`与该信号匹配。该行：

```
updateLabelTextDelegate del = new updateLabelTextDelegate(updateLabelText); 
```

只是一种全文的说法：

```
updateLabelTextDelegate del = updateLabelText; 
```

然后，您可以传递您的变量`del`，它现在是指向方法的`updateLabelText`指针`Control.Invoke`。

```
label1.Invoke(del, new object[] { newText }); 
```

由于`params`在`Control.Invoke`签名中使用，您甚至不必明确地说它是`object[]`

```
label1.Invoke(del, newText); 
```

接受一个对象数组，`Invoke`它将用作给定委托的参数。（是的，您的更新方法需要一个字符串 arg，请继续阅读）使用您的变量`del`，您*可以*称`updateLabelText`自己为：

```
del(newText); 
```

这基本上与以下内容相同：

```
updateLabelText(newText); 
```

在内部`Control.Invoke`，他们正在调用您的`del`方法，但由于委托上的一些辅助方法，它不必**知道**需要多少个参数。你会发现这样的事情：

**编辑**我对科学做了一些深入的挖掘，内部的[调用](http://msdn.microsoft.com/en-US/library/system.delegate.dynamicinvoke%28v=vs.80%29.aspx)更像是：

```
del.DynamicInvoke(args); 
```

`args`一个在哪里`object[]`。有关可以使用委托变量（Delegate 类型）执行的操作的更多信息，请[在此处](http://msdn.microsoft.com/en-us/library/system.delegate%28v=vs.80%29.aspx)阅读更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T20:47:27.500

如果您查看[Control.Invoke](http://msdn.microsoft.com/en-us/library/a1hetckb.aspx)的方法签名，您会发现它需要`params Object[] args`. 您可以传递`object[] args`或单个参数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T20:46:07.030

对象数组被传递给委托的`Invoke`方法。在这种情况下`updateLabelTextDelegate`，采用单个`string`参数，因此是数组中的单个元素。

事实上，数组不需要显式创建，并且

```
label1.Invoke(del, newText) 
```

也是有效的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T20:46:57.100

首先，值得注意的是，这不是调用`Invoke`委托，而是`Invoke`调用*控件*。现在，如果您查看[`Control.Invoke`](http://msdn.microsoft.com/en-us/library/a1hetckb.aspx)此处使用的签名，是这样的：

```
public Object Invoke(
    Delegate method,
    params Object[] args
) 
```

如果该方法采用*一种特定*的委托类型，则它可以采用该委托的适当参数类型。在*您的*情况下，您的委托只接受一个参数，但假设我们想传入一个`Action<string, string, int>`- 使用上面非常通用的方法，我们可以这样做：

```
control.Invoke(someDelegate, new object[] { "foo", "bar", 10 }); 
```

所以答案是`object[]`提供通用性，因为委托类型也是通用的。这有点像`MethodInfo.Invoke`- 在编译时不知道有多少参数，类型的值`object[]`是允许各种情况的最佳方式。

# javascript - JavaScript 水平滑块

> ID：10253257
> 
> 赞同：0
> 
> 时间：2012-04-20T20:40:46.883
> 
> 标签：javascript, html, dom, scroll

我正在尝试为我正在为自己的练习/享受而做的项目编写一个没有 JQuery 的水平滑块。

以下是相关代码：

```
function moveit() {
    "use strict";
    document.getElementById("position").style.left = window.event.clientX + "px";
}

window.onload = function () {
    "use strict";
    findtime();
    document.getElementById("scrollbar").style.width = document.getElementById("thevideo").offsetWidth + "px";
    var mousemove;
    document.getElementById("scrollbar").onclick = function () {
            mousemove = window.setInterval("moveit()", 1000);
    };
    document.getElementById("scrollbar").mouseup = function () {
            window.clearInterval(mousemove);
    };
}; 
```

不用说我有问题。它不断在 Chrome、Firefox 等上生成错误：

```
Uncaught TypeError: Cannot read property 'clientX' of undefined 
```

现在，如果我运行以下代码，它可以工作，但是（但对于跟随鼠标位置没有用）：

```
document.getElementById("position").style.left = 12 + "px"; 
```

HTML如下：

```
<?php include("header.php"); ?>
            <div>
                    <video id="thevideo">
                            <source src="movie.ogv" type="video/ogg" />
                    </video>
            </div>
            <div>
                    <span id="currenttime" contenteditable="true">0:00</span> / <span id="totaltime"></span>
            </div>
            <div id="scrollbar">
                    <div id="position" draggable="true"></div>
            </div>
<?php include("footer.php"); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:01:10.407

你快到了 -`window.event`标准 JS 中没有对象。所以使用[DOM 事件接口](https://developer.mozilla.org/en/DOM/event#DOM_Event_interface)：

```
function moveit(e) {
    "use strict";
    document.getElementById("position").style.left = e.clientX + "px";
}

window.onload = function (e) {
    "use strict";
    findtime();
    document.getElementById("scrollbar").style.width = document.getElementById("thevideo").offsetWidth + "px";
    var mousemove;
    document.getElementById("scrollbar").onclick = function () {
            mousemove = window.setInterval(moveit, 1000);
    };
    document.getElementById("scrollbar").mouseup = function () {
            window.clearInterval(mousemove);
    };
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:58:26.223

这是我不久前做的，也许你可以根据你的程序调整它。

```
var scrollTimer;

function Timer(callback, delay) {
    var timerId, start, remaining = delay;
    this.pause = function() {
        window.clearTimeout(timerId);
        remaining -= new Date() - start;
    };
    this.resume = function() {
        start = new Date();
        timerId = window.setTimeout(callback, remaining);
    };
    this.resume();
}

function scroll(down) {
  var scrollframe = document.getElementById("contentframe");
  var curY = document.all?
    scrollframe.contentWindow.document.body.scrollTop
  : scrollframe.contentWindow.window.pageYOffset;
  var delta = 5;
  var newY = down? curY+delta : curY-delta;
  scrollframe.contentWindow.scrollTo(0,newY);
}

function autoscroll(down) {
  scroll(down);
  scrollTimer = new Timer(function() {
    autoscroll(down);
  }, 20);
}

function stopscroll() {
  scrollTimer.pause();
} 
```

`delta`函数 scroll(boolean down) 导致向上或向下滚动到 iframe的单个增量`contentframe`。计时器用于重复该操作，以下是您将如何使用它：

```
<a href=#>
<img src="scroller/arrowTop.png" title="Scroll Up"
    onMouseOver="autoscroll(false);" onMouseOut="stopscroll();"/>
</a> 
```

希望这可以帮助。

# matlab - 4-d 插值

> ID：10253259
> 
> 赞同：1
> 
> 时间：2012-04-20T20:40:48.037
> 
> 标签：matlab, interpolation

我有一个 500*4 矩阵，它报告了一个取决于其他三个值（t、x、g）的实验结果。像这样的东西：

```
t   x   g   result
1   2   3   3
2   2   4   2
2   2   1   3
... 
```

我需要创建一个函数，为每个给定的元组 (t,x,g) 返回“结果”，即使它不存在于矩阵中。我认为我需要一个 4-d 插值，但我不知道如何在 Matlab 中进行。有人可以建议一种方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T02:17:07.403

使用 TriScatteredInterp 或 griddata3。两者都将解决您在分散集中插入数据点的问题。如果这些点不在数据的凸包内，那么这些方法仍然无法外推，但没有一种方法是完美的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:43:15.017

我认为你实际上需要一个 3-d 插值，因为 3 个点被映射到一个（结果）。

话虽如此，看看[interpn](http://www.mathworks.com/help/techdoc/ref/interpn.html)。这当然是你需要的

# google-fusion-tables - 谷歌融合表查询：人口密度的颜色变化

> ID：10253260
> 
> 赞同：1
> 
> 时间：2012-04-20T20:40:48.810
> 
> 标签：google-fusion-tables

如何更改在融合表中创建的地图颜色以表示人口密度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-09T17:17:09.827

这是我对美国各州数据的处理方法，截至 2014 年 4 月：

[http://epiphron.tumblr.com/post/82205653723/how-to-make-colored-state-maps-with-google-tools](http://epiphron.tumblr.com/post/82205653723/how-to-make-colored-state-maps-with-google-tools)

简而言之，将数据导入 Google Fusion Tables，将其与包含每个州（或国家/地区，如果您喜欢的话）的形状信息的公开文件合并，然后将其直接映射到 Fusion Tables 中。

可以在 Fusion Tables 地图的 Feature Map 菜单下自定义颜色。您可以进行渐变映射，也可以按各种分组对颜色进行分段。后者可能对密度数据更有用，与标准梯度设置一样，大多数实体看起来都是相同的颜色，因为人口密度的分布往往是倾斜的，少数实体（例如 DC）具有非常高的值.

# hadoop - hadoop t-file和datablock的关系？

> ID：10253263
> 
> 赞同：0
> 
> 时间：2012-04-20T20:40:58.380
> 
> 标签：hadoop

我的理解是 Hadoop 需要一个大文件并将其保存在“数据块”块中。这些数据块是否存储在 T 文件中？数据块和T文件的关系是1-1吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:52:12.740

[HDFS](https://web.archive.org/web/20120513124017/http://hadoop.apache.org/common/docs/current/hdfs_design.html)将大文件存储为一系列数据块（通常为固定大小，如 64/128/256/512 MB）。假设您有一个 1GB 的文件，并且块大小为 256MB - HDFS 会将这个文件表示为 4 个块。Name 节点将跟踪哪些数据节点拥有这些块的副本（或副本）。

[T-Files](https://web.archive.org/web/20120717130530/http://hadoop.apache.org:80/common/docs/current/api/org/apache/hadoop/io/file/tfile/TFile.html)是一种文件格式，包含键/值对。Hadoop 将使用 HDFS 中的一个或多个数据块存储 T-File（取决于 T-File 的大小和定义的块大小 - 系统默认值或文件特定）。

总之，您可以在 HDFS 中存储任何文件格式，它只会被分成固定大小的块，在整个集群中分布和复制。

# javascript - 从 HTMLElement 获取 google.maps.Map 实例

> ID：10253265
> 
> 赞同：50
> 
> 时间：2012-04-20T20:41:05.020
> 
> 标签：javascript, google-maps, google-maps-api-3

我在页面上有一个现有的地图。我可以使用类似于 document.getElementById() 的内容来选择该元素，以获取 HTMLElement javascript 对象。是否可以获得在地图初始化时创建的 google.maps.Map 的实例，即它是 HTMLElement 对象的属性还是在其原型中？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-04-20T21:21:26.830

您无法从中获取`google.maps.Map`对象`DOM Element`，在该对象上构建了 Google Maps 对象。`google.maps.Map`只是一个包装器，用于控制`DOM Element`查看地图，并且该元素没有对其包装器的引用。

如果您的问题只是范围，请将其`map`作为`window`对象的属性，并且可以从页面中的任何位置访问它。您可以`'map'`使用以下方法之一将其设为全局：

```
 window.map = new google.maps.Map(..) 
```

或者

```
 map = new google.maps.Map(...) //AVOID 'var' 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-11-12T05:07:22.660

您可以通过一个小技巧`google.maps.Map`从 中获取对象。`DOM Element`

初始化地图对象时，需要将该对象存储在元素的数据属性中。

例子：

```
$.fn.googleMap = function (options) {
    var _this = this;

    var settings = $.extend({}, {
        zoom: 5,
        centerLat: 0,
        centerLon: 0
    }, options);

    this.initialize = function () {
        var mapOptions = {
            zoom: settings.zoom
        };

        var map = new google.maps.Map(_this.get(0), mapOptions);
        // do anything with your map object here,
        // eg: centering map, adding markers' events

        /********************************************
         * This is the trick!
         * set map object to element's data attribute
         ********************************************/
        _this.data('map', map);

        return _this;
    };
    // ... more methods

    return this;
}; 
```

定义地图元素后，例如：

```
var mapCanvas = $('#map-canvas');
var map = mapCanvas.googleMap({
    zoom: 5,
    centerLat: 0,
    centerLong: 0
});
// ... add some pre-load initiation here, eg: add some markers
// then initialize map
map.initialize(); 
```

然后，您可以稍后使用元素的 ID 获取地图对象，例如：

```
var mapCanvas = $('#map-canvas');
$('.location').on('click', function () {
    // google map takes time to load, so it's better to get
    // the data after map is rendered completely
    var map = mapCanvas.data("map");
    if (map) {
        map.panTo(new google.maps.LatLng(
            $(this).data('latitude'),
            $(this).data('longitude')
            ));
    }
}); 
```

通过使用这种方法，您可以在一个页面上拥有多个具有不同行为的地图。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-16T12:43:51.403

我有一个类似的问题。我想做的就是在创建地图后对其进行操作。我尝试了类似的方法（我认为它也会对您有所帮助）。我创建了函数（或多或少像这样）：

```
function load_map(el_id, lat, lng) {
  var point = new google.maps.LatLng(lat,lng);
  var myMapOptions = {
    scrollwheel:false,
    zoom: 15,
    center: point,
    mapTypeControl: true,
    mapTypeControlOptions: {
      style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,
      position: google.maps.ControlPosition.RIGHT_TOP
    },
    navigationControl: true,
    navigationControlOptions: {
      style: google.maps.NavigationControlStyle.SMALL,
      position: google.maps.ControlPosition.LEFT_CENTER
    },
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  var map = new google.maps.Map(document.getElementById(el_id),myMapOptions);
  var marker = new google.maps.Marker({
    draggable:true,
    map: map,
    position: point
  });
  return({
    container:map.getDiv(),
    marker:marker,
    mapa:map
  });
} 
```

该函数的作用是在调用它以在某个容器中创建地图之后。

```
var mapa = load_map('mapa_container', 53.779845, 20.485712); 
```

函数将返回包含制作地图时使用的一些数据的对象。在创建地图本身之后，我可以简单地操作，在我的情况下，使用`mapa`对象分别在每个地图上进行标记，例如：

```
mapa.marker.setPosition(new google.maps.LatLng(20,30));
mapa.mapa.setCenter(new google.maps.LatLng(20,30)); 
```

这会将标记位置和中心地图更改为相同的坐标。请注意，在调用创建地图的函数时，`lng`和值是不同的。`lat`

希望有帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-20T20:53:04.453

初始化地图时创建实例；

```
var map = new google.maps.Map(document.getElementById("map_element"), options); 
```

每当您想做诸如放置标记、更改位置等操作时都可以使用该实例。它不是 HTMLElement 对象。但是，它有一个`getDiv()`方法，可以为您提供它正在操作的 html 元素。

```
map.getDiv(); // in this case it returns the element with the id 'map_element' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-02T18:14:24.563

如果您使用 Polymer 项目中的 Google-map 组件，您可以像这样获取现有的地图 Dom：

```
var map = document.querySelector('google-map'); 
```

一旦你有了它，地图的当前实例可以通过以下方式访问：

```
var currentMapInstance = map.map; 
```

# ios - C4Shape，setFrame 不会改变形状的大小（C4Framework）

> ID：10253270
> 
> 赞同：3
> 
> 时间：2012-04-20T20:41:38.017
> 
> 标签：ios, c4

我正在玩 C4，似乎无法弄清楚为什么我的形状没有动画。如果我创建这样的形状：

```
self.theShape = [C4Shape ellipse:CGRectMake(100, 100, 2, 2)]; 
```

...然后打电话

```
[theShape setFrame:CGRectMake(200, 200, 50,50)]; 
```

形状不会改变大小。实施表明它应该，但我没有看到它。有什么我做错了吗？是因为我没有更新画布吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:54:24.250

在 C4 中，调用`setFrame:`C4Shape 对象不会对其进行缩放。

原因是改变 CAShapeLayer 视图的框架不会改变底层的贝塞尔形状本身......不像在图像上调用相同的东西。UIKit 将缩放图像和其他内容，但不会缩放贝塞尔曲线（据我所知）......

所以，如果它是一个矩形，调用：

```
[theShape rect:aNewFrame] 
```

或者如果它是一个椭圆，调用：

```
[theShape ellipse:aNewFrame] 
```

这种方法构造了一个新的形状，然后利用核心动画的能力来隐式地动画旧形状路径和新形状路径之间的过渡。

# iis - 有没有办法对 IIS 区域属性进行批量/全局更改？

> ID：10253273
> 
> 赞同：1
> 
> 时间：2012-04-20T20:41:43.270
> 
> 标签：iis

好的，这就是场景。我有一台服务器负责近一千个网站的 DNS，我需要在 IIS 中更改 DNS 正向查找区域设置。现在在每个域上，我必须右键单击，转到属性，转到名称服务器选项卡并添加一个域名，然后转到区域传输选项卡并选中“允许区域传输”并选择“仅适用于名称服务器选项卡中列出的服务器”。是的，这需要 30 到 45 秒才能完成，但是乘以 x 1000，然后您将花费 10 个小时进行所有这些编辑。

我希望有一种方法可以批处理或全局更改这些属性，有人有什么想法吗？

# c# - T4MVC - 不同的控制器冲突

> ID：10253278
> 
> 赞同：3
> 
> 时间：2012-04-20T20:42:05.953
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-routing, t4mvc

我有行动

```
public virtual ActionResult Show(string userId) 
```

和

```
public virtual ActionResult Show(int groupId) 
```

在 Global.asax 我有

```
routes.MapRoute(
                "Group_Default",
                "{controller}/{action}/{groupId}",
                MVC.Groups.Show()
            );

            routes.MapRoute(
                "UserProfile_Default",
                "{controller}/{action}/{userId}",
                MVC.Profile.Show()
            ); 
```

现在，当我要求`group/show/...`它工作正常时。但是当我调用`Profile/Show/...`参数为空时。但是，如果我删除`UserProfile_Default`，那么两者都有效，但配置文件 URL 包含参数的问号（我希望它像这样干净`.../profile/show/5678`）
它以某种方式阻止了另一条路线。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:47:54.290

试试这些：

```
routes.MapRoute(
    "Group_Default",
    "Group/{action}/{groupId}",
    new { controller = "Group" }
);

routes.MapRoute(
    "UserProfile_Default",
    "Profile/{action}/{userId}",
    new { controller = "Profile" }
); 
```

为了将来参考，路由调试器是一个非常好的工具，可以准确查看路由发生了什么以及哪些 URL 正在执行哪些操作：[http ://haacked.com/archive/2008/03/13/url-routing-debugger .aspx](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)

# python - twistd 可以像 django 一样自动重置服务器吗？

> ID：10253279
> 
> 赞同：1
> 
> 时间：2012-04-20T20:42:06.830
> 
> 标签：python, django, twisted

我真正喜欢 django 的一件事是在您编辑项目时服务器自动重置的方式。我最近开始在扭曲/旋风中进行一些开发。

是否有类似的方法可以在更改程序文件时自动重置twistd？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:54:05.750

您可以使用[inotify](http://linux.die.net/man/7/inotify) - 它可以监控文件系统事件，例如文件修改。还有python绑定：[pyinotify](http://pyinotify.sourceforge.net/) 那里有很多教程，我的建议是您实现一个包装器，该包装器启动扭曲的监视器您的源路径。当文件修改发生时，您重新启动扭曲。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T22:19:32.527

我使用自己的[Pyquitter](https://github.com/ludios/Pyquitter)，它轮询进程已导入的每个模块的源文件。查看自述文件中的“示例使用”，其中介绍了如何将其与 Twisted 一起使用。

# cross-platform - GLFW 切换窗口全屏模式

> ID：10253283
> 
> 赞同：7
> 
> 时间：2012-04-20T20:42:32.997
> 
> 标签：cross-platform, glfw

我正在使用 GLFW，我想知道如何切换全屏窗口模式。不改变分辨率，而是将窗口设置在顶部并且没有装饰。如果 GLFW 无法做到这一点，那么您建议使用什么跨平台库来实现这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-20T18:25:31.303

你可以告诉 glfw 全屏打开你的窗口。

```
glfwOpenWindow( width, height, 0, 0, 0, 0, 0, 0, GLFW_FULLSCREEN ) 
```

据我所知，您必须关闭并重新打开此窗口才能在窗口和全屏模式之间切换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-26T21:41:13.567

为避免 GLFW 更改屏幕分辨率，您可以使用 glfwGetDesktopMode 查询当前桌面分辨率和颜色深度，然后将它们传递给 glfwOpenWindow。

```
// get the current Desktop screen resolution and colour depth
GLFWvidmode desktop;
glfwGetDesktopMode( &desktop );

// open the window at the current Desktop resolution and colour depth
if ( !glfwOpenWindow(
    desktop.Width,
    desktop.Height,
    desktop.RedBits,
    desktop.GreenBits,
    desktop.BlueBits,
    8,          // alpha bits
    32,         // depth bits
    0,          // stencil bits
    GLFW_FULLSCREEN
) ) {
    // failed to open window: handle it here
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-27T21:10:15.257

从 3.2 版开始：

> 窗口模式窗口可以通过使用 glfwSetWindowMonitor 设置监视器来全屏，全屏窗口可以通过取消设置来设置窗口。

[http://www.glfw.org/docs/latest/window.html](http://www.glfw.org/docs/latest/window.html)

# f# - 如何在 F# 中定义 x++（其中 x: int ref）？

> ID：10253285
> 
> 赞同：12
> 
> 时间：2012-04-20T20:42:48.660
> 
> 标签：f#, operators

我目前使用这个功能

```
let inc (i : int ref) =
    let res = !i
    i := res + 1
    res 
```

写东西

```
let str = input.[inc index] 
```

如何定义增量运算符 ++，以便我可以编写

```
let str = input.[index++] 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-20T20:54:20.663

您不能在 F# 中定义后缀运算符 - 请参阅[4.4 运算符和优先级](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec.html#_Toc321997017)。如果您同意将其设为前缀，则可以定义，例如，

```
let (++) x = incr x; !x 
```

并使用它如下：

```
let y = ref 1
(++) y;;

val y : int ref = {contents = 2;} 
```

**更新**：正如[fpessoa](https://stackoverflow.com/users/1339358/fpessoa)指出的那样，确实`++` **不能**用作真正的前缀运算符（请参阅[此处](http://msdn.microsoft.com/en-us/library/dd233204%28VS.100%29.aspx)和[此处](https://stackoverflow.com/a/2304141/917053)了解包含有效 F# 前缀运算符的字符和字符序列的规则）。

有趣的是，`+`为了达到以下目的，可以重载一元：

```
let (~+) x = incr x; !x 
```

允许

```
let y = ref 1
+y;;

val y : int ref = {contents = 2;} 
```

尽管如此，值得一提的是，像下面这样迭代数组的想法

```
let v = [| 1..5 |] 
let i = ref -1 
v |> Seq.iter (fun _ -> printfn "%d" v.[+i]) 
```

与惯用的功能方式相比，为了“可读性”，至少看起来很奇怪

```
[|1..5|] |> Seq.iter (printfn "%d") 
```

一些人已经在对原始问题的评论中表达了这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T21:31:53.703

我试图按照建议将其编写为前缀运算符，但您不能将 (++) 定义为正确的前缀运算符，即，在没有 () 的情况下运行 ++y 之类的东西，例如 (!+ ):

```
let (!+) (i : int ref) = incr i; !i

let v = [| 1..5 |]
let i = ref -1
[1..5] |> Seq.iter (fun _ -> printfn "%d" v.[!+i]) 
```

对不起，但我想答案是实际上你甚至不能这样做。

# assembly - 汇编中的 jmp

> ID：10253286
> 
> 赞同：1
> 
> 时间：2012-04-20T20:42:59.050
> 
> 标签：assembly

如果有人可以向我解释“：”在 jmp 指令中的用途，我将不胜感激，下面是来自 wiki 的 wiki

```
JMP 0x89AB, I know that this one is to jump to that position 
JMP 0xACDC:0x5578 what is that? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:48:26.720

如果不参考 wiki，我只能猜测，但我敢说这与 8088/86/286/386 处理器和它们的“分段”地址空间有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:48:56.637

基于 x86 的处理器采用[分段内存架构](http://en.wikipedia.org/wiki/X86_memory_segmentation)工作。

基本上内存是使用两个部分来寻址的。段地址和偏移地址。':' 之前的部分是段地址，':' 之后的部分是偏移地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T20:54:02.583

0x1234:0x5678 样式地址是分段地址。它的意思是`0x1234 * 0x10 + 0x5678`。你给出的例子是`0xB2338`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-21T11:01:46.810

那是一个很大的跳跃。真实模式和保护模式的含义不同：

*   实模式 → 它有一个段和一个偏移量，跳转目标是`segment * 16 + offset`.
*   保护模式 → 它有一个选择器，指向 GDT（全局描述符表，用于整个系统）或 LDT（本地描述符表，每个进程）中的描述符。跳转目标取决于描述符类型（并且需要有足够的权限）：
    *   代码段：它跳转到`offset`所描述的段内。
    *   调用门、任务门、TSS：`offset`被忽略，并执行适当的操作（例如：任务切换）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T20:48:43.017

我猜 0xACDC 是代码段地址，而 0x5578 是代码内的偏移量。

# django - Django开发服务器断管错误

> ID：10253288
> 
> 赞同：14
> 
> 时间：2012-04-20T20:43:02.943
> 
> 标签：django

运行我的 django 项目时，我的开发服务器中出现了这个奇怪的错误：

```
Traceback (most recent call last):
  File "/home/sam/django-projects/datazone/local/lib/python2.7/site-packages/django/core/servers/basehttp.py", line 284, in run
    self.finish_response()
  File "/home/sam/django-projects/datazone/local/lib/python2.7/site-packages/django/core/servers/basehttp.py", line 324, in finish_response
    self.write(data)
  File "/home/sam/django-projects/datazone/local/lib/python2.7/site-packages/django/core/servers/basehttp.py", line 403, in write
    self.send_headers()
  File "/home/sam/django-projects/datazone/local/lib/python2.7/site-packages/django/core/servers/basehttp.py", line 467, in send_headers
    self.send_preamble()
  File "/home/sam/django-projects/datazone/local/lib/python2.7/site-packages/django/core/servers/basehttp.py", line 385, in send_preamble
    'Date: %s\r\n' % http_date()
  File "/usr/lib/python2.7/socket.py", line 324, in write
    self.flush()
  File "/usr/lib/python2.7/socket.py", line 303, in flush
    self._sock.sendall(view[write_offset:write_offset+buffer_size])
error: [Errno 32] Broken pipe 
```

有人可以为我解释一下吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-20T20:47:45.560

当客户端在服务器完成发送数据之前关闭连接时会发生这种情况。如果它只是偶尔发生并且不是持久性问题，请忽略它。

# excel - 字典循环和应用程序定义或对象定义的错误

> ID：10253293
> 
> 赞同：0
> 
> 时间：2012-04-20T20:43:14.983
> 
> 标签：excel, vba

当字典包含列地址时，我在遍历字典试图转到指定的单元格时遇到错误。这里有一点背景——

1.  循环浏览任何有评论的单元格（仅限顶行！！）
2.  将该列和注释文本存储在字典对象中
3.  循环遍历剩余的行，并且只转到与第一行的注释相同的列中的单元格。然后，此信息将发送到另一个工作表

例如，

```
|CELL1|CELL2（W 评论）|CELL3|

```

--存储`Cell2`列地址，即 2 和注释，选择列位置 2 处的下一个单元格。

我已经发布了我的整个课程，但是您需要注意的部分是在最底部带有注释的代码。我意识到代码可能有点庞大，所以如果您看到一些快捷方式，请告知！

```
Option Explicit
Public buildWs As Worksheet
Public targWs As Worksheet
Public CommentVal As Comment
Public FirstRow As Range
Public targLastrow As Range
Public firstRecordRow As Range
Public commRange As Range
Public commCell As Range
Public recordRow As Range
Public LastRow As Long
Public vertRange As Range
Public vertCell As Range

'//---------------------------------------
'//getter and setter methods of the class
Public Property Get ItemNum() As Comment
    ItemNum = CommentVal
End Property
Public Property Let ItemNum(Value As Comment)
    CommentVal = ItemNum
End Property

Public Property Get Start() As Range
    Start = FirstRow
End Property
Public Property Let Start(Value As Range)
    Set FirstRow = Value
End Property

Public Property Get affBuild() As Worksheet
    affBuild = buildWs
End Property
Public Property Let affBuild(Value As Worksheet)
    Set buildWs = Value
End Property

Public Property Get allinaBuid() As Worksheet
    allinaBuild = targWs
End Property
Public Property Let allinaBuild(Value As Worksheet)
    Set targWs = allinaBuild
End Property

Public Sub setId()
    Dim rowCount As Integer
    Dim element As Variant
    Dim n As Integer
    Dim z As Integer
    Dim keyValue As New Dictionary
    Dim col As String

    On Error Resume Next
    Set commRange = buildWs.Cells _
      .SpecialCells(xlCellTypeComments)
    On Error GoTo 0
    If commRange Is Nothing Then
        MsgBox "No Comments Found"
        Exit Sub
    End If
    buildWs.Activate
    For Each commCell In commRange
        commCell.Select
        '// do something here with the cell since it meets our criteria of having a comment
        keyValue.Add ActiveCell.Column, ActiveCell.Comment.Text
    Next commCell
    '// loop through the vertical range for the 1st column to get a count of rows
    '//--------------------------------------------------------------------------
    Set vertRange = Range("A:A")
    vertRange.Select
    For Each vertCell In vertRange
        If ActiveCell.Value = "" Then
            Exit For
        Else
            rowCount = rowCount + 1
            ActiveCell.Offset(1, 0).Select
        End If
    Next vertCell
    '// row count is off by one since we don't care about the first row
    rowCount = rowCount - 1

    '// select the first real row we care about as row1 is only header info
    FirstRow.Select
    For Each element In keyValue
        col = element
        MsgBox col '<-- this displays the correct dictionary information -->
        Cells("2", col).Select '<-- this fails and gives me an error! -->
    Next element
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T22:11:37.733

发生错误是因为您需要将整数传递给`Cells("2", col)`，而不是字符串。您应该传递`Variant`包含 a`Long`或 a 的 a `Long`。

```
Dim col As Variant 
```

或者

```
Dim col As Long 
```

然后

```
Cells(2, col).Select 
```

* * *

你这里也有错误

```
Public Property Let allinaBuild(Value As Worksheet)
    Set targWs = Value ' <== was   Set targWs = allinaBuild
End Property 
```

（我替换`allinaBuild`为`Value`）

同样的错误`Let ItemNum`

# javascript - Javascript 函数参数必须是字符串？

> ID：10253299
> 
> 赞同：3
> 
> 时间：2012-04-20T20:43:33.963
> 
> 标签：javascript

我是 javascript 新手，所以我不确定它为什么会这样。

我有一个时钟功能：

```
function updateClock()
{
var currentTime = new Date();

var currentHours = currentTime.getHours();
var currentMinutes = currentTime.getMinutes();
var currentSeconds = currentTime.getSeconds();
var currentMilliseconds = currentTime.getMilliseconds();

// Pad the minutes and seconds with leading zeros, if required
currentMinutes = ( currentMinutes < 10 ? "0" : "" ) + currentMinutes;
currentSeconds = ( currentSeconds < 10 ? "0" : "" ) + currentSeconds;

// Choose either "AM" or "PM" as appropriate
var timeOfDay = ( currentHours < 12 ) ? "AM" : "PM";

// Convert the hours component to 12-hour format if needed
currentHours = ( currentHours > 12 ) ? currentHours - 12 : currentHours;

// Convert an hours component of "0" to "12"
currentHours = ( currentHours == 0 ) ? 12 : currentHours;

// Update the time display
document.getElementById("clock").innerHTML = currentHours + ":" + currentMinutes + ":" + currentSeconds + " " + timeOfDay;
} 
```

这是在一个单独的`clock.js`文件中。我将该文件包含在头中。

我把它放在下面`clock div`：

```
<script type="text/javascript">
setInterval("updateClock()", 1000);
</script> 
```

它有效。但是，如果我将其更改为`setInterval(updateClock(), 1000);`，它将无法正常工作。我花了一段时间试图弄清楚为什么函数只执行一次，直到我发现我需要在函数调用周围加上引号。

来自不同的语言背景，我不知道你为什么需要在它周围加上引号？看起来我正在将字符串传递`"updateClock()"`给函数而不是另一个函数。我看到其他人的代码，他们只是将整个函数定义为参数，例如`setInterval(function(){ ... }, 1000)`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T20:45:21.510

`setInterval()`将其作为第一个参数

1.  要评估的代码字符串 ( `'updateClock()'`) - 这不是首选用途，因为它依赖于`eval()`. 该字符串被评估为 JavaScript 代码。
2.  指向函数的指针 ( `updateClock`) - 注意缺少括号。在 JavaScript 中，一个定义的函数可以被引用，*而不是被调用*，通过使用它的名字而不带`()`. 指针也可以是 中的匿名函数`setInterval(function(){stuff...}, time)`，这实际上与对已定义函数的引用相同——两者都指向函数在内存中的位置，无论它是否有名称。

因此，在您的情况下，首选用法是：

```
<script type="text/javascript">
  setInterval(updateClock, 1000);
</script> 
```

它的表弟也是如此`setTimeout()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:45:25.427

你有没有尝试过

```
setInterval( updateClock, 1000); 
```

# javascript - 检索所有具有 data-foo Javascript 的元素

> ID：10253305
> 
> 赞同：2
> 
> 时间：2012-04-20T20:44:33.883
> 
> 标签：javascript

有没有一种简单的方法可以通过`data-foo`（特定的数据属性名称）喜欢`getElementsByTagName`或`getElementsByClassName`谢谢来获取所有元素。

***注意**：我没有使用 JS 库。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T20:47:05.177

在兼容的浏览器中，您有一种方法，只要您事先知道要查找的属性的名称，例如`data-myatt`：

```
var dataElems = document.querySelectorAll('[data-myatt]'); 
```

[JS Fiddle 概念验证](http://jsfiddle.net/davidThomas/Knh3M/)。

参考：

*   [`document.querySelectorAll()`](https://developer.mozilla.org/en/DOM/Document.querySelectorAll).
*   [选择器级别 3 - 属性存在和值选择器](http://www.w3.org/TR/2009/PR-css3-selectors-20091215/#attribute-representation)

# javascript - 通过一串点表示法在对象文字中设置深度？

> ID：10253307
> 
> 赞同：3
> 
> 时间：2012-04-20T20:44:35.740
> 
> 标签：javascript

有很多解决方案可以检查/访问给出点符号字符串的对象文字，但我需要做的是基于点符号字符串设置对象文字。为什么我需要这样做是非常技术性的，如果不可行，我会想出一个不同的解决方案。

这是我想做的：

```
var obj = { 
   'a': 1, 
   'b': 2, 
    'c': { 
      'nest': true 
    } 
}; 
```

我想要一个可以像这样工作的函数：

```
setDepth(obj, 'c.nest', false); 
```

这会将 obj 更改为：

```
var obj = { 
   'a': 1, 
   'b': 2, 
    'c': { 
      'nest': false
    } 
}; 
```

我一直在尝试一个小时，但还没有想出一个好的解决方案。另一个帮助将非常感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T21:44:46.943

我的版本：

```
function setDepth(obj, path, value) {
    var tags = path.split("."), len = tags.length - 1;
    for (var i = 0; i < len; i++) {
        obj = obj[tags[i]];
    }
    obj[tags[len]] = value;
} 
```

工作演示：http: [//jsfiddle.net/jfriend00/Sxz2z/](http://jsfiddle.net/jfriend00/Sxz2z/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T20:58:15.653

这是一种方法：

```
function setDepth(obj, path, value) {
    var levels = path.split(".");
    var curLevel = obj;
    var i = 0;
    while (i < levels.length-1) {
        curLevel = curLevel[levels[i]];
        i++;
    }
    curLevel[levels[levels.length-1]] = value;
} 
```

[工作演示。](http://jsfiddle.net/HeyJavascript/ETyqq/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-11T16:04:30.507

我修改了 Elliot 的答案，如果它们不存在，让它添加新节点。

```
var settings = {};

function set(key, value) {
  /**
         * Dot notation loop: http://stackoverflow.com/a/10253459/607354
         */
  var levels = key.split(".");
  var curLevel = settings;
  var i = 0;
  while (i < levels.length-1) {
    if(typeof curLevel[levels[i]] === 'undefined') {
      curLevel[levels[i]] = {};
    }

    curLevel = curLevel[levels[i]];
    i++;
  }
  curLevel[levels[levels.length-1]] = value;

  return settings;
}

set('this.is.my.setting.key', true);
set('this.is.my.setting.key2', 'hello');
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-11T10:08:02.867

这样做：

```
new Function('_', 'val', '_.' + path + ' = val')(obj, value); 
```

在你的情况下：

```
var obj = { 
   'a': 1, 
   'b': 2, 
    'c': { 
      'nest': true 
    } 
};

new Function('_', 'val', '_.c.nest' + ' = val')(obj, false); 
```

# android - 如何避免按返回按钮/键返回登录布局？

> ID：10253308
> 
> 赞同：10
> 
> 时间：2012-04-20T20:44:42.120
> 
> 标签：android, session, login, back-button, activity-stack

我想为我的研究所创建一个应用程序。

问题是：我的应用程序将有两种布局（登录和仪表板）。

学生可以正确填写登录表单、进入仪表板、按下按钮以及填写其他字段。但如果用户随后按下后退按钮，它不应返回登录屏幕，而是留在仪表板中，否则，退出应用程序。

然后，如果学生重新打开应用程序并且它已经登录，他应该被自动重定向到仪表板，而不是登录屏幕，除非用户按下仪表板上的注销按钮，然后将他重定向回登录屏幕。

你怎么能做到这一点？

**编辑：** *我实现了 2 个意图和 2 个活动，我提出的新问题是，当我按下主页按钮并从任务管理器中打开应用程序时，在剩下的活动中打开，但如果从图标打开打开应用程序再次从第一个活动中打开，就像在最后一个活动中打开一样？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T21:07:01.400

我已经使用`SharedPreferences`. 我这样做了：

`LoginActivity`

```
SharedPreferences settings;
public void onCreate(Bundle b) {
    super.onCreate(b);
    settings = getSharedPreferences("mySharedPref", 0);
    if (settings.getBoolean("connected", false)) {
        /* The user has already login, so start the dashboard */
        startActivity(new Intent(getApplicationContext(), DashBoardActivity.class));
    }
    /* Put here the login UI */
 }
 ...
 public void doLogin() {
    /* ... check credentials and another stuff ... */
    SharedPreferences.Editor editor = settings.edit();
    editor.putBoolean("connected", true);
    editor.commit();
 } 
```

在您`DashBoardActivity`覆盖该`onBackPressed`方法。这会将您从`DashBoardActivity`主屏幕带到您的主屏幕。

```
@Override
public void onBackPressed() {
    Intent intent = new Intent(Intent.ACTION_MAIN);
    intent.addCategory(Intent.CATEGORY_HOME);
    startActivity(intent);
} 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T20:49:07.477

一种想法是首先启动仪表板，然后`Activity`如果您检测到用户未登录，则在新的仪表板中启动登录。然后您可以根据需要跳过登录对话框。如果您在清单中设置`noHistory="true"`登录`Activity`，它将被阻止在后按时重新出现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-20T23:17:52.863

将包含此活动的任务移到活动堆栈的后面。活动在任务中的顺序不变。

```
@Override
public void onBackPressed() {
    moveTaskToBack(true);
    super.onBackPressed();
} 
```

# jquery - 取消选中复选框时，jQuery .removeClass/.toggleClass 不起作用

> ID：10253312
> 
> 赞同：1
> 
> 时间：2012-04-20T20:45:15.723
> 
> 标签：jquery

我在名称和 id = selectArticle[] 的页面上有几个复选框。我需要的是，每当用户选中复选框时，某些元素应该附加 class="required" 并且当我取消选中同一个框时，应该删除 class="required"。

我已经尝试过 .addClass 和 .removeClass，但是每当我取消选中复选框时，.remove 效果就永远不会发生。但是，当我再次选中复选框时（在 .toggleClass 的情况下），该类会完美切换。似乎它仅适用于复选框“选中”事件而不是未选中。

通过警报，我已经检查过，检查/取消检查事件都被完美触发，但 .removeClass/.toggleClass 根本不起作用。

我该如何纠正这个问题。请帮帮我！！！

```
 $("input[name='selectArticle[]']:checkbox").live('change',function(){
          var n = $("input[name='selectArticle[]']:checked").length;
          var id=$(this).val();
          var v = $(this).is(':checked');
          //var vr= $("input[name='selectArticle[]']:unchecked").val();
          //var vr= $(this).val();
          alert(v);
          alert(id);
          //alert("url"+v);
          if($(this).is(':checked'))
          {

            alert('#url'+v);
            $("#title"+id).toggleClass('required');
            $("#id"+id).toggleClass('required');
            $("#url"+id).toggleClass('required url');
            $("#category"+id).toggleClass('required');
            $("#group"+id).toggleClass('required');
          }
          else
          {
            alert("balls"+id);
            ("#title"+id).toggleClass('required');
            $("#id"+id).toggleClass('required');
            $("#url"+id).toggleClass('required url');
            $("#category"+id).toggleClass('required');
            $("#group"+id).toggleClass('required');
          }
         // $("div").text(n + (n <= 1 ? " is" : " are") + " checked!" + " value :" + v);
    }); 
```

更新：下面的答案

```
 $("input[name='selectArticle[]']:checkbox").live('change',function(){
          var n = $("input[name='selectArticle[]']:checked").length;
          var id=$(this).val();
          var v = $(this).is(':checked');
          //var vr= $("input[name='selectArticle[]']:unchecked").val();
          //var vr= $(this).val();
          alert(v);
          alert(id);
          //alert("url"+v);
          if($(this).is(':checked'))
          {

            alert('#url'+v);
            $("#title"+id).addClass('required');
            $("#id"+id).addClass('required');
            $("#url"+id).addClass('required url');
            $("#category"+id).addClass('required');
            $("#group"+id).addClass('required');
          }

         if(!$(this).is(':checked'))
          {
            alert("balls"+id);
            $("#title"+id).removeClass('required');
            $("#id"+id).removeClass('required');
            $("#url"+id).removeClass('required url');
            $("#category"+id).removeClass('required');
            $("#group"+id).removeClass('required');
          }
         // $("div").text(n + (n <= 1 ? " is" : " are") + " checked!" + " value :" + v);
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T20:35:37.080

原始问题的问题在于您在 UPDATE 中有两个 IF 语句。如果它是 CHECKED，则第一个 UNCHECKED 框，但随后第二个 IF 语句将重新检查该框，因为它现在是 UNCHECKED。

如果您仍然有这种设置，那么任何事情都不会正常工作，因为您只是来回翻转状态。确保只有 IF-A-THEN-B-ELSE-C 而不是 IF-A-THEN B 后跟 IF-B-THEN-A。

希望这可以帮助。:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T20:52:09.760

因为`toggleClass`不工作尝试

```
if($(this).is(':checked'))
{
    $("#title"+id).removeClass('required');
    ...
}
else
{
    $("#title"+id).addClass('required');
    ...
} 
```

确保您`var id=$(this).val();`包含有效的内容`("#title"+id)`，因为`$("#id"+id)`和其他人使用相同的变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T20:49:12.237

嗯……

```
else if($(this).is(':unchecked')) 
```

`:unchecked`不是有效的 jQuery 选择器。尝试使用`else`或：

```
if(!$(this).is(':checked')) 
```

# iphone - 百分比图形表示为圆形

> ID：10253315
> 
> 赞同：3
> 
> 时间：2012-04-20T20:45:34.167
> 
> 标签：iphone, objective-c, ios

我计划使用圆圈进行百分比可视化，目前正在尝试找出要使用的框架/技术。

`corePlot`到目前为止，我已经使用过图表，并且一直想知道它是否可以选择

我的想法到目前为止：

```
1: use a Core Plot piechart and add a covering circle layer in the middle
2: try to use quartz 2d to do it somehow 
```

附件是一个样机，它应该是什么样子，所以你有一个想法：

![在此处输入图像描述](../Images/295c6d197cdc40f035f3c9e59b18f329.png)

您认为这里最好的方法是什么？我喜欢避免使用掩盖子视图等..

有没有我可能缺少的简单解决方案？

在此先感谢塞巴斯蒂安

（PS：我不希望这里有任何代码，只是一个`fingerpoint`正确的方向）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:55:34.567

作为比实际直接的 CorePlot 答案更多的选择，您可以在[UICircularProgressView](https://github.com/Zedenem/UICircularProgressView)控件的自定义版本中显示您的百分比，我可以亲自担保。

# c# - 使用 SlimDX 的奇怪渲染（脸上的洞）

> ID：10253316
> 
> 赞同：0
> 
> 时间：2012-04-20T20:45:36.147
> 
> 标签：c#, directx, slimdx, directx-11

我在使用 SlimDX (DirectX 11) 渲染一个简单的旋转立方体时遇到了问题。立方体正在旋转，这些是我得到的图像：

![渲染问题](../Images/7c220c24a9c831bd6dd9ec39d9b738b8.png)

我使用这个顶点着色器：

```
 float4x4 WorldViewProj : register(c0);
    float4 VShader(float4 position : POSITION) : SV_POSITION
    {
        return mul(float4(position.xyz, 1.0), WorldViewProj);
    } 
```

这就是我准备 WorldViewProj 的方式：

```
ProjectionMatrix = Matrix.PerspectiveFovLH((float)(Math.PI / 4.0), 1f, -1, 20);
ViewMatrix = Matrix.LookAtLH(new Vector3(0f, 0, ypos), new Vector3(0f, 0, 10), new Vector3(0f, 1f, 0f)); 

Matrix positionMatrix = Matrix.Translation(position);
Matrix rotationMatrix = Matrix.RotationYawPitchRoll(rotation.X, rotation.Y, rotation.Z);
Matrix scaleMatrix = Matrix.Scaling(scale);
Matrix worldMatrix = rotationMatrix * scaleMatrix * positionMatrix;
worldMatrix = Matrix.Transpose(worldMatrix);

Matrix WorldViewProj = ViewMatrix * ProjectionMatrix * worldMatrix; 
```

首先我看到了这个问题：[Incorrect Clipping and 3D Projection when using SlimDX](https://stackoverflow.com/questions/7739442/incorrect-clipping-and-3d-projection-when-using-slimdx)

而且，矩阵可能有问题（因为我既不转置视图也不转置投影，而是转置世界——在相反的情况下，没有渲染任何东西）。但即使我将视图矩阵和投影矩阵都设置为单位矩阵，“洞”仍然存在。

请提前帮助和感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T08:46:48.437

问题找到了。这只是索引缓冲区中顶点的错误顺序。真丢脸：）谢谢大家的帮助！

# java - 无法将 ID 保存到资源文件

> ID：10253319
> 
> 赞同：0
> 
> 时间：2012-04-20T20:45:56.810
> 
> 标签：java, android, xml, eclipse

我最近一直在做一个 Android 应用程序项目，我注意到我在 XML 文件中的一些代码 ID 不会在 R 文件中注册，并且我无法访问我的类中的 ID。XML 文件中的代码如下所示：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="match_parent"
android:layout_height="match_parent">

<ImageView android:layout_height="250dp"
android:layout_gravity="center"
android:src="@drawable/icon" 
android:id="@+id/ivReturnedPic" 
android:layout_width="250dp"></ImageView>

<ImageButton android:layout_height="wrap_content" 
android:src="@drawable/icon" 
android:id="@+id/ibTakePic" 
android:layout_width="125dp"
android:layout_gravity="center"></ImageButton>

<Button android:text="Set Wallpaper" 
android:id="@+id/bSetWall" 
android:layout_width="125dp" 
android:layout_height="wrap_content"
android:layout_gravity="center"></Button>

</LinearLayout> 
```

这些 ID 都不会在资源文件中注册。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:51:05.667

您的 xml 中有问题，这就是为什么没有自动生成 R

删除一个额外的`</LinearLayout>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:33:35.933

您必须确保图像“icon.png”或“icon.jpg”在您的 res/drawable 文件夹下。

```
android:src="@drawable/icon" 
```

# c# - rtf 到文本块

> ID：10253321
> 
> 赞同：1
> 
> 时间：2012-04-20T20:46:04.260
> 
> 标签：c#, wpf, xaml, document, rtf

当我尝试使用 rtf 设置文本块时，它会给出一个有趣的输出，如果有的话，有没有办法在文本块中显示 rtf？

```
private void button1_Click(object sender, RoutedEventArgs e)
{
    TextRange tr = new TextRange(richTextBox1.Document.ContentStart,
                     richTextBox1.Document.ContentEnd);
    MemoryStream ms = new MemoryStream();
    tr.Save(ms, DataFormats.Rtf); 
    string rtfText = ASCIIEncoding.Default.GetString(ms.ToArray());
    textBlock1.Text = rtfText; 
```

编辑更新：

我可以做这个：

```
 private void button1_Click(object sender, RoutedEventArgs e)
    {
        TextRange tr = new TextRange(richTextBox1.Document.ContentStart,
             richTextBox1.Document.ContentEnd);
        MemoryStream ms = new MemoryStream();
        tr.Save(ms, DataFormats.Rtf); // does not contain a definition
        string rtfText = ASCIIEncoding.Default.GetString(ms.ToArray());
        MemoryStream stream = new MemoryStream(ASCIIEncoding.Default.GetBytes(rtfText));
           this.richTextBox2.Selection.Load(stream, DataFormats.Rtf); 
```

但我真的很讨厌richtextbox 是不是没有其他控件可以保存富文本格式？或者有没有一种方法可以让某个控件显示 rtf？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:49:56.650

您不能使用 TextBlock 来显示 RTF 文本。但是，如果可以在[FlowDocumentScrollViewer](http://msdn.microsoft.com/en-us/library/ms610538.aspx)中显示文本，则可以这样复制：

```
public MainWindow()
{
    InitializeComponent();

    richTextBox.Document = new FlowDocument();
    flowDocumentScrollViewer.Document = new FlowDocument();
}

private void CopyDocument(FlowDocument source, FlowDocument target)
{
    TextRange sourceRange = new TextRange(source.ContentStart, source.ContentEnd);
    MemoryStream stream = new MemoryStream();
    XamlWriter.Save(sourceRange, stream);
    sourceRange.Save(stream, DataFormats.XamlPackage);
    TextRange targetRange = new TextRange(target.ContentStart, target.ContentEnd);
    targetRange.Load(stream, DataFormats.XamlPackage);
}

private void Button_Click(object sender, RoutedEventArgs e)
{
    CopyDocument(richTextBox.Document, flowDocumentScrollViewer.Document);
} 
```

[在此处](http://msdn.microsoft.com/en-us/library/aa970909.aspx)获取流程文档的概述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:47:29.637

这将为您提供整个 FlowDocument，但好消息是它确实包含标记。我想这就是你要找的

```
string textMarkUp = System.Windows.Markup.XamlWriter.Save(richTextBox1.Document);
Debug.WriteLine(textMarkUp); 
```

样本输出

```
<Paragraph>asdfas<Run FontWeight="Bold">adsfasd;lkasdf</Run><Run FontStyle="Italic" FontWeight="Bold">alskjfd</Run></Paragraph> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-14T10:12:18.440

我需要 Text Block，因为它可以扩展到内容，我们可以将 wrap 设置为 none。我将 rtf 字符串存储在数据库中。我将字符串添加到 RichTextBlock，然后使用它的文档来获取内联。

```
 Dim stream As New IO.MemoryStream(System.Text.ASCIIEncoding.[Default].GetBytes("{\rtf1\ansi\ansicpg1252\deff0\deflang1040{\fonttbl{\f0\fnil\fcharset0 Microsoft Sans Serif;}}{\colortbl ;\red255\green255\blue255;}\viewkind4\uc1\pard\cf1\f0\fs29 RIGO NOTIZIA 1 TESTO TESTO TESTO\fs17\par}"))
    Dim RichTextBox1 As New RichTextBox()
    RichTextBox1.Selection.Load(stream, DataFormats.Rtf)

    Dim pr As New System.Windows.Documents.Paragraph()
    pr = RichTextBox1.Document.Blocks(0)
    Dim tre As Int32 = pr.Inlines.Count
    TextBlock1.Inlines.Add(pr.Inlines(0)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-09T08:45:16.027

RichTextBox 仅用于转换，最终控制是 FlowDocumentScrollViewer，所以我最终得到了稍微简化的功能：

```
public static class FlowDocumentScrollViewerEx
{
    static public bool ReadFromFile(this FlowDocumentScrollViewer fDoc, String rtfFilePath)
    {
        RichTextBox retext = new RichTextBox();     // Just an intermediate class to perform conversion
        retext.Document = new FlowDocument();
        fDoc.Document = new FlowDocument();

        TextRange tr = new TextRange(retext.Document.ContentStart, retext.Document.ContentEnd);

        if (!File.Exists(rtfFilePath))
            return false;

        using (var fs = new FileStream(rtfFilePath, FileMode.OpenOrCreate))
        {
            tr.Load(fs, DataFormats.Rtf);
            fs.Close();
        }

        MemoryStream ms = new MemoryStream();
        System.Windows.Markup.XamlWriter.Save(retext, ms);
        tr.Save(ms, DataFormats.XamlPackage);
        TextRange flowDocRange = new TextRange(fDoc.Document.ContentStart, fDoc.Document.ContentEnd);
        flowDocRange.Load(ms, DataFormats.XamlPackage);
        return true;
    } //ReadFromFile
} //class FlowDocumentScrollViewerEx 
```

用法很简单：

```
flowDocument.ReadFromFile(@"license.rtf"); 
```

# linux - 从内核模块读取 x86 MSR

> ID：10253325
> 
> 赞同：1
> 
> 时间：2012-04-20T20:46:33.097
> 
> 标签：linux, linux-kernel, cpu-registers, msr

我的主要目标是在程序崩溃时获取由 LBR 寄存器维护的最后 16 个分支的地址值。到目前为止，我尝试了两种方法-

1) msr-tools 这允许我从命令行读取 msr 值。我从 C 程序本身对其进行系统调用并尝试读取这些值。但是寄存器值似乎与程序本身的地址无关。很可能寄存器被系统代码中的其他分支污染了。我尝试关闭环 0 和远跳中的分支记录。但这无济于事。仍然获得不相关的值。

2) 通过内核模块访问 好的，我编写了一个非常简单的模块（我以前从未这样做过）来直接访问 msr 寄存器并可能避免寄存器污染。

这就是我所拥有的 -

```
#define LBR 0x1d9 //IA32_DEBUGCTL MSR
                  //I first set this to some non 0 value using wrmsr (msr-tools)
static void __init do_rdmsr(unsigned msr, unsigned unused2)
{
    uint64_t msr_value;
    __asm__ __volatile__ ("                 rdmsr"
                    : "=A" (msr_value)
                    : "c" (msr)
                    );

    printk(KERN_EMERG "%lu \n",msr_value);
}
static int hello_init(void)
{
    printk(KERN_EMERG "Value is ");
    do_rdmsr (LBR,0);
    return 0;
}

static void hello_exit(void)
{
    printk(KERN_EMERG "End\n");
}

module_init(hello_init);
module_exit(hello_exit); 
```

但问题是每次我使用 dmesg 读取输出时，我得到的只是

```
Value is 0 
```

（我尝试过其他寄存器 - 它始终为 0）

我在这里忘记了什么吗？有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T07:08:26.390

使用以下内容：

```
unsigned long long x86_get_msr(int msr)
{
    unsigned long msrl = 0, msrh = 0;

    /* NOTE: rdmsr is always return EDX:EAX pair value */
    asm volatile ("rdmsr" : "=a"(msrl), "=d"(msrh) : "c"(msr));

    return ((unsigned long long)msrh << 32) | msrl;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-06T07:52:58.860

您可以使用 Ilya Matveychikov 的回答……或者……或者：

```
#include <asm/msr.h>
int err;
unsigned int msr, cpu;
unsigned long long val;
/* rdmsr without exception handling */
val = rdmsrl(msr);
/* rdmsr with exception handling */
err = rdmsrl_safe(msr, &val);
/* rdmsr on a given CPU (instead of current one) */
err = rdmsrl_safe_on_cpu(cpu, msr, &val); 
```

还有更多功能，例如：

*   `int msr_set_bit(u32 msr, u8 bit)`
*   `int msr_clear_bit(u32 msr, u8 bit)`
*   `void rdmsr_on_cpus(const struct cpumask *mask, u32 msr_no, struct msr *msrs)`
*   `int rdmsr_safe_regs_on_cpu(unsigned int cpu, u32 regs[8])`

看一下`/lib/modules/<uname -r>/build/arch/x86/include/asm/msr.h`

# java - 在 Eclipse 插件中实现处理程序

> ID：10253335
> 
> 赞同：1
> 
> 时间：2012-04-20T20:47:11.667
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-indigo

我在 Eclipse 插件（在 Indigo 上开发）中有一个处理程序，我希望每次保存（或打开，理想情况下）文本编辑器中的 Java 文件时运行它。据我所知，有两种方法可以实现这一点：

1.  通过`CommandService`API 以编程方式。
2.  使用中的配置`plugin.xml`

这两种我都试过了。方法1是这样的：

```
public class Activator extends AbstractUIPlugin {
    @Override
    public void start(final BundleContext context) throws Exception {
        super.start(context);
        ICommandService commandService = (ICommandService) PlatformUI
              .getWorkbench().getService(ICommandService.class);
        commandService.addExecutionListener(new MyListener());
        plugin = this;
    }
    ...
}

public class MyListener implements IExecutionListener {
    @Override
    public void postExecuteSuccess(final String commandId, final Object returnValue) {
        System.out.println("PostEventSuccess:" + commandId);
    }

    @Override
    public void preExecute(final String commandId, final ExecutionEvent event) {}

    @Override
    public void notHandled(String commandId, NotHandledException exception) {}

    @Override
    public void postExecuteFailure(String commandId, ExecutionException exception) {}
} 
```

和方法2。像这样：

```
<extension point="org.eclipse.ui.handlers">
    <handler 
        commandId="org.eclipse.ui.file.save"
        class="mypackage.MyHandler">
        <activeWhen>
            <with variable="activeWorkbenchWindow">
                <instanceof value="org.eclipse.ui.IWorkbenchWindow"/>
            </with>
        </activeWhen>
    </handler>
</extension> 
```

方法 1\. 根本不运行我的侦听器。方法 2\. 有效，因为处理程序被执行，但我的处理程序似乎替换了默认处理程序。当用户尝试保存文件时，我的处理程序运行但文件没有保存。处理程序本身似乎很好（我已经通过创建一个运行它的菜单项对其进行了测试）。

方法 1\. 现在已弃用还是我错误地实施了该服务？如何获得方法 2\. 保存文件？可以从我的处理程序运行默认处理程序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:24:22.053

这两者的区别不仅在于一个是程序性的，另一个是声明性的。我认为定义命令处理程序是错误的，因为它处理命令执行，而不是仅仅被通知命令已执行。您的第一种方法似乎很好，但是您的代码在插件被激活之前不会被执行，当您的包中的第一个类被加载时，这种情况会延迟发生。Eclipse 中有一个解决方法：贡献于`org.eclipse.ui.startup`扩展点。让例如你的`Activator`类实现`IStartup`，你可以使用一个空的实现——唯一的一点是让框架从你的包中加载*任何*类。

# c# - 对 Windows Phone 7.1 库进行单元测试

> ID：10253337
> 
> 赞同：3
> 
> 时间：2012-04-20T20:47:24.700
> 
> 标签：c#, windows-phone-7.1

我对 Windows Phone 开发非常陌生，并且我已经读过，例如[这里](http://www.windowsphonegeek.com/articles/Getting-Started-with-Unit-Testing-in-Silverlight-for-WP7)，没有用于 Windows Phone 应用程序的单元测试框架。

我觉得这很奇怪，因为例如，如果我有一个包含一堆执行操作的类的类库，我将创建一个单元测试项目，添加类库的引用并以与我一直相同的方式对每个类进行单元测试有。

因此，我创建了一个虚拟 Windows Phone 类库，其中包含一个带有 Add(int x, int y) 方法的 MyClass 类，并将其引用添加到常规测试项目中。

有趣的是，引用上有一个警告标志，但测试会相应地运行、通过和失败。

所以我的问题是：

单元测试 Windows Phone 代码的真正意义是什么？
为什么测试项目中引用Windows Phone类库会出现警告标志？

谢谢你的启发:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T21:10:01.547

我一直在 WP7 上进行一些测试驱动的开发。我将 NUnit 和 Moq for Silverlight 用于我的隔离框架。有一篇关于在 Windows Phone 7 上使用 NUnit 和 Moq 的精彩博客文章，其中包含处理一些奇怪问题的视频，[http ://toranbillups.com/blog/archive/2011/07/24/Test-Driving-My-Windows-电话 7 应用程序](http://toranbillups.com/blog/archive/2011/07/24/Test-Driving-My-Windows-Phone-7-App)。到目前为止，我所看到的大部分是更多的集成测试，并且对于大多数 WP7 应用程序都非常有效。

编码快乐！！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T20:51:00.660

您绝对可以对 Windows Phone 7 代码进行单元测试。我相信现在 NUnit 支持它，甚至在它还很新的时候，就有[Silverlight 单元测试框架](http://www.jeff.wilcox.name/2011/06/updated-ut-mango-bits/)。您可能会发现您通常使用的其他一些技术要么是有限的，要么是不存在的（例如，当我编写一个 WP7 应用程序时，我认为没有任何模拟库可以使用它），而且通常会更痛苦一些比使用完整框架进行单元测试，但这绝对是可行的。

哦，您可能会发现自己想要隐藏框架其余部分的一些抽象，例如`WebRequest`，以便您可以测试想要使用这些抽象的东西。我发现这很痛苦，但可行...

# database - Product、FrequenceOfUse 和 User 表的关系

> ID：10253346
> 
> 赞同：1
> 
> 时间：2012-04-20T20:47:57.763
> 
> 标签：database, data-modeling

我有 3 张桌子：

```
Product (shamppoo, toothpaste,..)
FrequenceOfUse (3 times/day, once/day,...)
User 
```

正如您可以想象的那样，我想在数据库中存储用户使用产品的数量。这些表之间应该是什么关系？

哈维

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T22:03:34.810

它将是和之间的多对多关系`User`和和之间`Product`的一对多关系（后者是关系本身）。`FrequenceOfUse``UserProduct`

请注意，关于关系是否可以独立存在关系没有达成共识。所以有些人更愿意将其建模为：

1.  实体**用户**
2.  实体**产品**
3.  实体**使用**
4.  实体使用**频率**
5.  `1-N`关系：**用户** *参与* **使用**
6.  `1-N`关系：**产品** *参与* **使用**
7.  `N-1`关系**使用** *以* **频率执行**

这两个模型都被关系建模为：

```
CREATE TABLE user (id INT NOT NULL PRIMARY KEY, name TEXT, ...)
CREATE TABLE product (id INT NOT NULL PRIMARY KEY, name TEXT, ...)
CREATE TABLE frequence (id NOT NULL, description TEXT, ...)
CREATE TABLE usage
        (
        user INT NOT NULL FOREIGN KEY REFERENCES (user),
        product INT NOT NULL FOREIGN KEY REFERENCES (product),
        frequence INT NOT NULL REFERENCES frequence,
        PRIMARY KEY (user, product)
        ) 
```

您可能会在我的博客中发现这篇文章很有用：

*   [**什么是实体关系模型？**](http://explainextended.com/2009/10/18/what-is-entity-relationship-model/)

# c# - 如何从 DataRow 内部绑定到 DataDrid 的 ItemsSource？

> ID：10253348
> 
> 赞同：1
> 
> 时间：2012-04-20T20:48:06.160
> 
> 标签：c#, wpf, xaml, data-binding, datagrid

我正在使用一个带有多个 DataGrid 的窗口，我想通过一个命令来处理删除事件。

为此，我需要将记录列表传递给该命令，必须从中删除记录。

这就是我的意思：

```
<DataGrid  Margin="0" HeadersVisibility="None" 
     ItemsSource="{Binding GroupExtednedDataList}" 
     ... >
        <DataGrid.Columns>
            <DataGridTemplateColumn>
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <Button Content="delete" 
           CommandParameter="{Binding::: 
          How do I bind from here to GroupExtednedDataList from ItemsSoruce?}" >
                        </Button>
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>

        </DataGrid.Columns>
    </DataGrid> 
```

如何从内部绑定`<Button Content="delete"`到 DataGrid 的 ItemsSource？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:50:54.497

就像是

```
{Binding ItemsSource, RelativeSource={RelativeSource AncestorType=DataGrid}} 
```

# javascript - ExtJS4 组合框加载/存储问题

> ID：10253349
> 
> 赞同：2
> 
> 时间：2012-04-20T20:48:12.130
> 
> 标签：javascript, extjs

我看到一个组合框存在问题，其中我有一个“更改”事件的侦听器。当事件触发时，它会运行一个函数来过滤存储，该存储为另一个组合框提供动力，以过滤第二个组合框中可用的值。

这个想法是，当您从第一个组合框中的短列表中进行选择时，它会减少第二个组合框中的选择。

当表单加载时，您可以单击第二个组合框并查看所有选项，效果很好。然后，当您在第一个组合框中选择某些内容，然后再次单击第二个组合框时，您会看到相应的缩短列表，但它是灰色的，并且“正在加载...”的东西只是旋转并且永远不会消失。

如果您加载表单并在第一个组合框中选择某些内容，然后单击第二个组合框，它将过滤并显示正常，但是如果您尝试更改第一个框中的选择并单击，则会遇到我上面描述的加载问题再次出现第二个组合框。

请看下面的代码，我有这个设置在另一个屏幕上工作，它似乎没有这个问题。

我创建了一个 ext 商店，如下所示：

```
var comboBreaker = Ext.create('Ext.data.Store', {
    autoLoad: false,
    remoteSort: true,
    remoteFilter: true,
    fields: [{
        name: 'id',
        mapping: 'item_id',
        type: 'int',
        useNull: false},
        'item_display_number','item_name', 'line_item_type_id', 'item_description'
    ],
    proxy:{
        type:'ajax',
        url: '/invoicer/data/getlineitems',
        reader: {
            type: 'json',
            successProperty: 'success',
            root: 'results',
            totalProperty: 'totalCount'
        },
        sorters:[{
            property:'item_display_number',
            direction:'ASC'
        }]
    }
}); 
```

这家商店为组合框提供动力，如下所示：

```
Ext.define('Writer.Form', {
    extend: 'Ext.form.Panel',
    alias: 'widget.writerform',

    requires: ['Ext.form.field.Text'],

    initComponent: function(){
        this.addEvents('create');
        Ext.apply(this, {
            activeRecord: null,
            frame: true,
            title: 'Line Item',
            id: 'writerform',
            fieldDefaults: {
                anchor: '100%',
                labelAlign: 'right'
            },
            items: [{
                xtype: 'combobox',
                fieldLabel: 'Item #',
                name: 'item_number',
                store: comboBreaker,
                displayField: 'item_display_number',
                valueField: 'id',
                allowBlank: false,
                forceSelection: true
            },{
                xtype: 'combobox',
                fieldLabel: 'Item Type',
                name: 'item_type',
                id: 'item_type',
                displayField: 'line_item_type',
                valueField: 'id',
                store: invoicer_lineItemTypeStore,
                forceSelection: true,
                labelWidth: 75,
                width: 200,
                listeners: {
                    change: {
                        fn: function() {
                            itemNumberFilter(comboBreaker);
                        }
                    }
                }
            }]
}); 
```

itemNumberFilter() 函数获取一个存储并对其进行过滤，代码如下：

```
function itemNumberFilter( store ) {
    var id = Ext.getCmp('item_type').getValue();
    store.remoteFilter = false;
    store.clearFilter();
    if ( id ) {

        store.filter('line_item_type_id', id);
    }
    store.remoteFilter = true;
    store.removeAll();
    store.load({
        scope: this,
        callback: function( records ) {
            console.log('Loaded records!');
            console.log(records);
        }
    });
} 
```

每次我在第一个组合框中更改我的选择时，我都会看到已注销的记录，并且我可以在第二个组合框中“看到”结果，但它们总是随着“正在加载..”GIF 显示而变灰。

编辑：视频示例：[http ://screencast.com/t/cUSHyFE6FIV](http://screencast.com/t/cUSHyFE6FIV)

编辑：我相信这是解决方案：

```
lastQuery: '',
listeners: {
                        beforequery: {
                            fn: function(query) {
                                delete this.lastQuery;
                            }
                        }
                    } 
```

将此添加到组合框配置中可解决此问题。

Edit2：我遇到了由此引入的第二个错误，通过添加以下内容进行了修复：

```
this.clearValue(); 
```

到 beforequery 函数（上面删除 this.lastQuery）。每次单击下拉箭头时，这都会清除组合框的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-17T14:17:53.110

您可以动态加载第二个组合框的存储，但请务必将第二个组合框设置为“本地”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T01:08:03.887

假设您选择了项目`x`，`combo_1`然后选择`a`了缩减列表中的项目`combo_2`。然后将 中的选择更改`combo_1`为`y`，然后再次更改 中的项目列表`combo_2`。在选择项目的结果中是否`a`可以在新列表中使用？当一个项目不再存在于组合可用的列表中时，可能是尝试保持选中该项目的问题。`combo_2``y``combo_1`

您是否尝试`combo_2`在应用过滤器之前清除选择？

# php - 为什么一个是对象，一个是数组？

> ID：10253351
> 
> 赞同：1
> 
> 时间：2012-04-20T20:48:14.803
> 
> 标签：php, arrays, object, doctrine, codeigniter-2

我有以下两个查询：

```
$query = $this->doctrine->em->createQuery("select u from ORM\Dynasties2\Characters u WHERE u.whichFamily = $whichfamily AND (u.deathDate = 0 OR u.deathDate IS NULL) "); 
```

和

```
$query = $this -> doctrine -> em -> createQuery ("SELECT a, b.msgText, b.fromUser, b.timeStamp, b.importance, b.msgType FROM ORM\Dynasties2\Maillinks a JOIN a.msgId b"); 
```

第一个查询返回一个对象。

```
array(9) { 
  [0]=> object(stdClass)#108 (18) {
    ["__CLASS__"]=> string(25) "ORM\Dynasties2\Characters" 
    ["id"]=> int(67) 
    (etc) 
```

第二个查询返回一个数组。

```
array(4) {
  [0]=> array(6) { 
    [0]=> string(24) "ORM\Dynasties2\Maillinks"
    ["msgText"]=> string(24) "asdfasdfasdfasdfasdfasdf"  
    (etc) 
```

为什么第二个返回一个数组？

有没有一种简单的方法可以将其转换为对象？

（使用教义2和codeigniter2）

编辑：

如果我像这样更改第二个查询：

```
$query = $this -> doctrine -> em -> createQuery ("SELECT a FROM ORM\Dynasties2\Maillinks a JOIN a.msgId b"); 
```

那么输出是一个对象。所以我已经部分回答了我的问题 - 但是，上面的代码没有返回我需要的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T22:09:50.343

试试这个（如果关系定义正确，它应该返回和对象）：

```
SELECT a, b FROM ORM\Dynasties2\Maillinks a JOIN a.msgId b 
```

# php - 在 PHP 中读取文件的部分以创建标签

> ID：10253353
> 
> 赞同：0
> 
> 时间：2012-04-20T20:48:34.607
> 
> 标签：php

我有一个从 MYSQL 数据库中提取数据以创建标签的文件。我在标签结束的地方添加了一个字符串“BREAK”。我的数据文件看起来像这样。

```
--------- 开始文件 -----

休息
订购：10000
名称：XYZ
电话：XXX-XXX-XXX

6 x ABC
6 x 主 ST
6 x 城市
6 x 状态
6 个国家

休息
订购：10001
名称：XYZ1
电话：XXX-XXX-XXX

BMC
乔丹街
城市
状态
国家

休息
订购：10002
名称：XYZ2
电话：XXX-XXX-XXX

BMC
乔丹街
城市
状态
国家

......更多订单..

--------- 结束文件 --------

```

除了读取 3 个或更多块并将它们分开打印之外，对于第一个块“6 x”，我想从块中删除“6 x”，而是将 6 作为值存储在要使用的变量中unix 上的 lpr/print 命令用于打印 6 个副本。这不是一个主要问题，我可能稍后会弄清楚，但是在 php 中读取这些块并从中创建 3 个或更多文件是我的要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:40:14.660

这个小脚本将您的订单解析为一个多维数组（见下面的输出）。从这个数组中，您可以生成任何其他格式，例如将其插入数据库、将其写入其他文件或其他任何内容。

**解析器**

```
$orders = explode("BREAK", $fileContents);
array_shift($orders); // only required if a "BREAK" is before the first order
$ordersData = array();
foreach($orders as $order) {

    if (preg_match("/Order: ([^\r\n]+)[\r\n]+NAME: ([^\r\n]+)[\r\n]+Phone: ([^\r\n]+)[\r\n]+(.+)/si", $order, $regs)) {

        $items = preg_split("/[\r\n]+/", $regs[4], null, PREG_SPLIT_NO_EMPTY);
        foreach ($items as &$item) {

            if (preg_match("/(\d+) *?x *?(.+)/", $item, $regs2)) {

                $item = array(
                    'count' => $regs2[1],
                    'item' => $regs2[2]
                );
            } else {

                $item = array(
                    'count' => 1,
                    'item' => $item
                );
            }
        }

        $orderData = array(
            'order_no' => $regs[1],
            'name' => $regs[2],
            'phone' => $regs[3],
            'items' => $items
        );

        $ordersData[] = $orderData;
    }
} 
```

**输出格式**

```
$ordersData = Array
(
    [0] => Array
        (
            [order_no] => 10000
            [name] => XYZ
            [phone] => XXX-XXX-XXX
            [items] => Array
                (
                    [0] => Array
                        (
                            [count] => 6
                            [item] =>  ABC
                        )

                    [1] => Array
                        (
                            [count] => 6
                            [item] =>  Main ST
                        )

                    [2] => Array
                        (
                            [count] => 6
                            [item] =>  CITY
                        )

                    [3] => Array
                        (
                            [count] => 6
                            [item] =>  STATE
                        )

                    [4] => Array
                        (
                            [count] => 6
                            [item] =>  COUNTRY
                        )

                )

        )

    [1] => Array
        (
            [order_no] => 10001
            [name] => XYZ1
            [phone] => XXX-XXX-XXX
            [items] => Array
                (
                    [0] => Array
                        (
                            [count] => 1
                            [item] => BMC
                        )

                    [1] => Array
                        (
                            [count] => 1
                            [item] => MJ ST
                        )

                    [2] => Array
                        (
                            [count] => 1
                            [item] => CITY
                        )

                    [3] => Array
                        (
                            [count] => 1
                            [item] => STATE
                        )

                    [4] => Array
                        (
                            [count] => 1
                            [item] => COUNTRY
                        )

                )

        )

    [2] => Array
        (
            [order_no] => 10002
            [name] => XYZ2
            [phone] => XXX-XXX-XXX
            [items] => Array
                (
                    [0] => Array
                        (
                            [count] => 1
                            [item] => BMC
                        )

                    [1] => Array
                        (
                            [count] => 1
                            [item] => MJ ST
                        )

                    [2] => Array
                        (
                            [count] => 1
                            [item] => CITY
                        )

                    [3] => Array
                        (
                            [count] => 1
                            [item] => STATE
                        )

                    [4] => Array
                        (
                            [count] => 1
                            [item] => COUNTRY
                        )

                )

        )

) 
```

# yii - Yii中文本框中的值相乘

> ID：10253354
> 
> 赞同：-1
> 
> 时间：2012-04-20T20:48:36.960
> 
> 标签：yii

我是[Yii](http://en.wikipedia.org/wiki/Yii)新手，我正在尝试从文本框中计算值。我希望计算代码与显示文本框的形式相同（因为产品也将显示在输入因子的相同形式的文本框中）。我试过这个猜测，但它没有用。我该如何解决这个问题？

```
<div class="row">
    <?php echo $form->labelEx($model,'Quantity_In_Pieces'); ?>
    <?php echo $form->textField($model,'Quantity_In_Pieces',array('Quantity_In_Pieces' => ('Quantity').val() * ('Hold').val());?>
    <?php echo $form->error($model,'Quantity_In_Pieces'); ?>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T22:50:45.157

似乎您正在尝试在应该有 php 代码的地方编写 jQuery。

```
<?php echo $form->textField($model,'Quantity_In_Pieces',array('Quantity_In_Pieces' => $model->quantity * $model->hold);?> 
```

# php - Gearman：根据一些输入参数限制工人选择工作

> ID：10253355
> 
> 赞同：2
> 
> 时间：2012-04-20T20:48:37.600
> 
> 标签：php, queue, jobs, gearman

我有一个 Gearman 队列，它通过多个工作人员处理一些用户特定的数据。我不希望特定用户一次占用多个工人。

假设我有一个名为 process_user_data() 的队列，我运行 4 个工人 W1、W2、W3、W4 当用户 ID 1 提交 10 个作业时，我只希望 W1 处理它。W2-W4 不应该选择工作。

这在齿轮人中可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T14:16:14.763

没有 Gearman 本身不支持这一点。我相信最简单的方法是为函数添加前缀/后缀以指示它们所属的用户。例如：用户 1 的工作应该提交给`process_data_1()`，并且工人 1 会连接到那个而不是通用的`process_data()`. 在内部，worker 仍然可以拥有相同的代码库，因为这只是与 Gearman 服务器挂钩的问题（您可以在通过命令行参数启动 worker 时对其进行管理）：

```
class Worker

public function __construct() {
 $this->user = argv[1];
 $this->worker = new GearmanWorker();
 $this->worker->addServer();
 $this->worker->addFunction("process_data_" . $this->user, array($this, 'process_data'));
}

public function process_data() {
 //work code
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T12:21:29.177

如果工作人员在不同的服务器上，这很容易 - 只是不要`GearmanClient->addServer()`在您的客户端中声明它们。如果在同一台服务器上，我想你可以在单台机器上运行多个 gearmand 实例，在一系列端口上。然后，您可以`addServer(host, port)`有选择地声明哪些“组”应该有机会获得您即将添加的工作/任务。

如果这对您来说太麻烦了，那么您可能需要选择不同的排队系统。我似乎记得读过 Gearman 不允许基于作业类型的过滤，但恐怕我没有参考。也许看看 RabbitMQ 或 BeanStalk？

# .htaccess - 301重定向，一个重写有效，另一个无效

> ID：10253357
> 
> 赞同：0
> 
> 时间：2012-04-20T20:48:46.707
> 
> 标签：.htaccess, mod-rewrite, redirect, http-status-code-301

抱歉标题太长了。我目前正在编写一些 301 重定向并使用 mod rewrite (Apache) 来处理它们。目前，我尝试过的两个 301 中只有一个在工作。这是代码：

```
#301 REDIRECTS
RewriteEngine On
RewriteRule ^Fox-and-Frank-home\.html$ http://www.mydomain.co.uk/contact_us.php [R=301]
RewriteRule ^about\.html$ http://www.domain.com/about/ [R=301,L] 
```

about.html 正确重定向，但 Fox-and-Frank-home.html 没有。我已经尝试过使用其他名称、其他 URL，但它不起作用。任何帮助将不胜感激。

**编辑**

我已经让它在一个完全裸露的 .htaccess 文件上工作。301 重定向是否需要排在最前面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T13:57:18.757

您的 Fox-and-Frank 重写中没有 L（最后一个）标志，因此可能会处理其他规则，并且肯定会在 a `.htaccess`（您需要使用该`END`标志的地方）中。

尝试将其更改为：

```
RewriteRule ^Fox-and-Frank-home\.html$ http://www.mydomain.co.uk/contact-us.php [NC,R=301,L] 
```

在哪里：

*   NC 使其成为不区分大小写的检查（因此 fox-and-frank-home 将重定向到）
*   R=301 是 301 重定向（尽管您可以只输入 R 并且假设 301 我总是亲自指定）
*   L 告诉 mod_rewrite 停止处理进一步的规则（但 `.htaccess.`您可能需要使用它`END`来代替 - 请参阅[http://httpd.apache.org/docs/current/rewrite/flags.html#flag_l](http://httpd.apache.org/docs/current/rewrite/flags.html#flag_l)）。

问候。

# javascript - jQuery 改变视频播放器的大小

> ID：10253358
> 
> 赞同：0
> 
> 时间：2012-04-20T20:48:48.313
> 
> 标签：javascript, jquery, video, width

詹姆斯在这里。我正在处理一个处理帖子的项目（实际上两个项目都需要相同的代码），除了内容始终是用户屏幕的 100%，并使用 jquery 来划分宽度以使相同数量的列没有不管屏幕分辨率是多少。但是，我在视频帖子方面遇到了麻烦。如果有人可以帮助我编写（或编写，那会更有帮助）一个强制默认 500px 视频到帖子宽度的脚本？我用来划分帖子的脚本如下。任何答案都会有所帮助。哦，我遇到了这个问题，因为它已经快一周了，我还没有收到工作脚本。

```
 var container = function(){
    var posts = $(document).width() - 40;
    var entry = (posts - 200) / 5;
    $("#posts").css("width", posts);
    $(".entry").css("width", entry);
    $("img.photo").css("width", entry - 22);
}

container(); 
```

我正在做这个的网站是[http://jamestestblog5.tumblr.com](http://jamestestblog5.tumblr.com) 感谢任何可以提供帮助的人，这真的很困扰我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:58:45.407

您好，请在此处查看**演示**：http : [//jsfiddle.net/ytcAk/](http://jsfiddle.net/ytcAk/)

单击“增长”按钮时，您可以阅读逻辑。

从旧解决方案分叉。:) （如果这是您要找的，请告诉我，如果不是，我将删除此帖子）

**jQuery代码**

```
function increaseVideoSize() {
    var columnWidth = 450; // width of your content column - any
    var defaultVideoWidth = 400; // theme tag width - 400,500
    var increaseRatio = columnWidth/defaultVideoWidth;
    $(".video-post").each(function() {
        var iframe = $("iframe", this);
        if(iframe.length>0) {
            var currHeight = iframe.height();
            var newHeight = currHeight * increaseRatio;
            iframe.height(newHeight).width(columnWidth);
        } else {
            var object = $("object", this);
            var embed = $("embed", object);
            var currHeight = object.attr('height');
            var newHeight = currHeight * increaseRatio;
            object.width(columnWidth).attr('height', newHeight);
            embed.width(columnWidth).attr('height', newHeight);
        };
    });
};​ 
```

# ruby-on-rails - 需要在 Rails 中返回 JSON 格式的 404 错误

> ID：10253366
> 
> 赞同：79
> 
> 时间：2012-04-20T20:49:43.030
> 
> 标签：ruby-on-rails

我的 Rails 应用程序中有一个普通的 HTML 前端和一个 JSON API。现在，如果有人调用`/api/not_existent_method.json`它，它将返回默认的 HTML 404 页面。有什么方法可以将其更改为类似的内容`{"error": "not_found"}`，同时保留 HTML 前端的原始 404 页面？

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2012-04-21T08:37:07.517

一位朋友向我指出了一个优雅的解决方案，它不仅可以处理 404 错误，还可以处理 500 个错误。事实上，它处理每一个错误。关键是，每个错误都会产生一个异常，该异常会通过机架中间件堆栈向上传播，直到由其中一个处理。如果您有兴趣了解更多信息，可以观看[此出色的截屏视频](http://railscasts.com/episodes/151-rack-middleware)。Rails 有自己的异常处理程序，但您可以通过较少记录的`exceptions_app`配置选项覆盖它们。现在，您可以编写自己的中间件，也可以将错误路由回 Rails，如下所示：

```
# In your config/application.rb
config.exceptions_app = self.routes 
```

然后你只需要在你的匹配这些路线`config/routes.rb`：

```
get "/404" => "errors#not_found"
get "/500" => "errors#exception" 
```

然后你只需创建一个控制器来处理它。

```
class ErrorsController < ActionController::Base
  def not_found
    if env["REQUEST_PATH"] =~ /^\/api/
      render :json => {:error => "not-found"}.to_json, :status => 404
    else
      render :text => "404 Not found", :status => 404 # You can render your own template here
    end
  end

  def exception
    if env["REQUEST_PATH"] =~ /^\/api/
      render :json => {:error => "internal-server-error"}.to_json, :status => 500
    else
      render :text => "500 Internal Server Error", :status => 500 # You can render your own template here
    end
  end
end 
```

最后要补充一点：在开发环境中，rails 通常不会渲染 404 或 500 页，而是打印回溯。如果您想`ErrorsController`在开发模式下查看您的实际操作，请禁用`config/enviroments/development.rb`文件中的回溯内容。

```
config.consider_all_requests_local = false 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-06-27T11:53:26.230

我喜欢创建一个单独的 API 控制器来设置格式（json）和特定于 api 的方法：

```
class ApiController < ApplicationController
  respond_to :json

  rescue_from ActiveRecord::RecordNotFound, with: :not_found
  # Use Mongoid::Errors::DocumentNotFound with mongoid

  def not_found
    respond_with '{"error": "not_found"}', status: :not_found
  end
end 
```

RSpec 测试：

```
 it 'should return 404' do
    get "/api/route/specific/to/your/app/", format: :json
    expect(response.status).to eq(404)
  end 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-20T21:32:27.123

当然，它看起来像这样：

```
class ApplicationController < ActionController::Base
  rescue_from NotFoundException, :with => :not_found
  ...

  def not_found
    respond_to do |format|
      format.html { render :file => File.join(Rails.root, 'public', '404.html') }
      format.json { render :text => '{"error": "not_found"}' }
    end
  end
end 
```

`NotFoundException`不是真名的例外*。*它会因 Rails 版本和您想要的确切行为而异。用谷歌搜索很容易找到。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-20T21:48:33.633

尝试放在你**的末尾**`routes.rb`：

```
match '*foo', :format => true, :constraints => {:format => :json}, :to => lambda {|env| [404, {}, ['{"error": "not_found"}']] } 
```

# c# - 请帮助我了解如何将我的代码转换为像这个线程一样工作

> ID：10253367
> 
> 赞同：2
> 
> 时间：2012-04-20T20:49:46.150
> 
> 标签：c#, asp.net, sql, sql-server, tsql

我不确定是否需要创建一个全新的类或什么，我对 asp.net 很陌生。

这是我的代码：

```
public static IEnumerable<DistInfo> GetGeneralInformation ( int ClientID )
{
    using ( var conn = new SqlConnection( GetConnectionString() ) )
    using ( var cmd = conn.CreateCommand() )
    {
        conn.Open();
        cmd.CommandText =
        @"SELECT i.GoLiveDate, i.FirstBonusRun, i.TechFName, i.TechLName, i.TechEmail, i.TechPhone, i.WebISPFName, i.WebISPLName, 
          i.WebISPEmail, i.WebISPPhone, i.FullFillFName, i.FullFillLName, i.FullFillEmail, i.FullFillPhone, d.FName,
          d.LName, d.HomePhone, d.Email
          FROM NC_Information i
          INNER JOIN Distributor d
            ON d.DistID = i.ClientID
          WHERE clientID = @value";
        cmd.Parameters.AddWithValue( "@value", ClientID );
        using ( var reader = cmd.ExecuteReader() )
        {
            while ( reader.Read() )
            {
                var distInfo = new DistInfo
                {
                    AnticipatedLaunchDate = reader.GetDateTime( reader.GetOrdinal( "GoLiveDate" ) )
                };
                yield return distInfo;
            }
        }
    }
} 
```

给出您是否缺少组装或参考。这是否意味着我需要创建一个 DistInfo 类来完成这项工作？

new DistInfo 给出与上述相同的错误。

抱歉，我对 asp.net 很陌生，不太了解如何让我的工作像这篇文章中那样：

[我不断收到此错误：“阅读器关闭时调用读取的尝试无效”](https://stackoverflow.com/questions/4912782/i-keep-getting-this-error-invalid-attempt-to-call-read-when-reader-is-closed/4912837#4912837)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:52:48.887

您实际上有一个名为 的课程`DistInfo`吗？代码是否编译？如果没有，您需要添加一个新的 DistInfo 类，该类至少具有`DateTime`. 就像是：

```
public class DistInfo
{
    public DateTime AnticipatedLaunchDate { get; set; }
} 
```

如果需要，您可以在其中添加更多属性:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:37:54.460

如果您只需要返回日期/时间信息，然后像这样定义您的方法

```
public static IEnumerable<DateTime> GetGeneralInformation(int ClientID) 
```

像这样简化你的阅读循环

```
int goLiveDateOrdinal = reader.GetOrdinal("GoLiveDate");
while (reader.Read()) {
    yield return reader.GetDateTime(goLiveDateOrdinal);
} 
```

仅当您必须返回多个值时才需要创建一个类。

# php - 如何让搜索引擎显示我们网站的结果？

> ID：10253368
> 
> 赞同：0
> 
> 时间：2012-04-20T20:49:46.953
> 
> 标签：php, search, indexing

我如何让搜索引擎在搜索结果中索引我的公共内容。我想做一些类似于 Yelp 的事情。例如，当您使用 yelp 搜索餐厅时，您会被带到该餐厅的公共页面。现在当你去谷歌并输入那个餐厅的名字时，你会看到 yelp 个人资料出现在搜索结果中（例如： [http](http://www.yelp.com/biz/udupi-palace-san-francisco) ://www.yelp.com/biz/udupi-palace-san-francisco ）

所以，假设我想为我的网站做同样的事情。我该怎么做？

请注意，我是新手，这可能很简单，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:53:24.707

来自专业网站管理员：

[提高您的网站在 Google 中的排名的最佳方法是什么？](http://What%20are%20the%20best%20ways%20to%20increase%20your%20site%27s%20position%20in%20Google?)
[SEO：如何区分事实与虚构？](https://webmasters.stackexchange.com/questions/12960/seo-how-to-separate-fact-from-fiction/13007#13007)

# php - MySql 用 ip 创建或更新行？

> ID：10253379
> 
> 赞同：1
> 
> 时间：2012-04-20T20:50:58.617
> 
> 标签：php, python, mysql, sql

我有一个带有 ips 的表和一个 ip 访问某个页面的次数的计数。如果 ip 存在一行，我想在计数中添加一个，否则使用 ip 创建一行并将计数设置为 1。

我试过

```
INSERT INTO mytable (ip,count) VALUES ('" + ip + "',1) ON DUPLICATE KEY UPDATE count=count+1; 
```

但是 ip 不是唯一的或主要的，所以它只是不断地创建具有相同 ip 的行。我尝试让 ip 独一无二，但它不会让我这样做。当我尝试创建一个文本列并使其独一无二时，phpmyadmin 说`BLOB/TEXT column 'test' used in key specification without a key length`。

我可以使用两个语句。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T20:54:56.683

更改`ip`为`UNSIGNED INT`，在其上创建一个`UNIQUE`约束并使用它：

```
INSERT
INTO    mytable (ip, count)
VALUES  (INET_ATON($ip), 1)
ON DUPLICATE KEY
UPDATE
        count = count + 1 
```

要以点十进制表示法（如`192.168.1.1`）检索 ip，请使用：

```
SELECT  INET_NTOA(ip)
FROM    mytable 
```

您还可以创建一个前缀索引：

```
CREATE UNIQUE INDEX ux_mytaable_ip ON mytable (ip(15)) 
```

但`INT`最好使用列来存储 ipv4 地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:59:54.840

您需要从选择开始。（一个伪 codish 的答案 - 您需要针对您的特定方言进行调整。）

所以做一个

```
select count(*) from mytable
where ip = $ip; 
```

如果返回的计数大于 0，则执行

```
update mytable
set count = count + 1
where ip = $ip 
```

别的

```
insert into mytable($ip, count, <other fields>...) values (ip, 1, <other values>...); 
```

# c# - 通过 VB.NET 和 TCPIP 进行数据加密

> ID：10253383
> 
> 赞同：0
> 
> 时间：2012-04-20T20:51:13.967
> 
> 标签：c#, .net, vb.net, security, encryption

我编写了一些代码，在服务器和客户端之间建立 TCPIP 连接，并设法将数据从客户端发送到服务器。现在我想使用 RSACryptoServiceProvider 加密数据，这将在两者之间发送，以便客户端加密数据，服务器对其进行解密以供进一步工作。不幸的是，我在互联网上找不到任何管理它的方法，尤其是在涉及到密钥时，因为它大部分运行在同一程序内的同一台机器上。有人可以帮我解决我在 vb.net 或 c# 中的情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T00:50:18.823

[我的数学老师给了我一些与此](http://www.math.cornell.edu/~mec/2003-2004/cryptography/diffiehellman/diffiehellman.html)非常相似的东西，但那是丹麦语，我认为让你玩谷歌翻译不是一个好主意。但这同样好:-)

请注意（从我的数学老师那里偷来的，我不确定链接是否告诉它）：

您使用的数字需要非常大才能使您的安全级别达到可接受的水平。实际上，为了安全起见，您至少需要 1024 位（最好是 2048），对应于 307 到 614 位小数。

希望有所帮助:-)

# java - 继承和多态冲突

> ID：10253386
> 
> 赞同：-1
> 
> 时间：2012-04-20T20:51:47.013
> 
> 标签：java, inheritance, polymorphism

如果一个`Fruit`类是超类，`Apple`并且`Orange`是 Fruit 的子类，`GoldenDelicious`并且`Macintosh`是 的子类`Apple`。

假设给出以下声明：

```
Fruit fruit = new GoldenDelicious();
Orange orange = new Orange(); 
```

用解释回答这个问题

假设方法`makeAppleCider`是在类中定义的`Apple`。可以 `fruit`调用这个方法吗？橙子可以调用这个方法？？？

我的回答是：水果可以调用这个方法吗？没有因为没有显式转换，必须对水果实例进行显式转换才能调用 Apple 类中定义的方法。这个答案是真的吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:22:17.737

这深入到变量的静态和动态类型。

```
Fruit fruit; 
```

这一行声明了一个`fruit`静态类型的变量`Fruit`。这种类型永远不会改变（毕竟它是静态的）并且是您通常会使用的。

```
fruit = new GoldenDelicious(); 
```

这一行是`GoldenDelicious`为该变量分配一个值的行。变量的动态类型确实会发生变化以反映这种变化。毕竟，变量实际上包含一个`GoldenDelicious`now。动态类型是您通常不会使用的东西，但是当您使用 (evil) 时会使用它`instanceof`（它确保在正确的位置调用被覆盖的函数）。

现在，你想这样做：

```
fruit.makeAppleCider(); 
```

这行不通。果不其然，我们基本上只知道静态类型，而静态类型`Fruit`对那个方法一无所知。（然而，在幕后，如果以不同`GoldenDelicious`的`Macintosh`方式实现函数，动态类型将确保调用正确的版本。）

正如您在回答中提到的那样，显式强制转换可用于更改您正在使用的静态类型，因此您可以使其以这种方式工作。不过，最好不要这样做，因为应该避免强制转换并且不是“正确的 OOP”。

总之，是的，你的答案是正确的。

（是的，我的描述有点技术性。我希望你能原谅我……）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:15:21.510

当然，另一种选择是使用“接口”——一种穷人的多重继承（但比完全多重继承更容易理解和实现）。

例如，您可以有一个类似的接口（未检查语法）：

```
public interface CiderFruit {
    public void makeCider();
} 
```

然后Apple可以实现接口：

```
public class Apple extends Fruit implements CiderFruit {
    ....
    public void makeCider() {
        doStuff();
    }
    ....
} 
```

如果你有一个 Quince 类，它可以实现相同的接口，并且可以采用 Apple 或 Quince，将其转换为 CiderFruit（如果不确定它是 Apple 还是 Quince），然后调用`makeCider()`. （也可以使用类型为 Apple 或 Quince 的引用直接调用。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:03:40.427

A`Fruit`没有该`makeAppleCider`方法的“知识”。`makeAppleCider`在子类中定义并且不是 的成员`Fruit`。一个类只能访问它或它的一个父类定义的方法。给定一个特定类型的类，您必须追溯类层次结构以查看您可以访问哪些方法。您可以将变量的类型视为返回类层次结构的起点。

如果您希望所有类都可以访问某个方法，请将其放在层次结构的根目录中。显然，使用该方法的逻辑应该是有意义的，否则使用您的代码的人会感到困惑。

# android - Android ADB shell 命令：挂载主机 PC 文件夹？

> ID：10253387
> 
> 赞同：1
> 
> 时间：2012-04-20T20:51:49.600
> 
> 标签：android, shell, adb, mount

希望这不是一个业余/白痴问题：我正在尝试用我自己的一些宠物声音替换大多数铃声和警报（Dell Streak 5（2.2.2 植根））。由于我不会打扰你的原因，我不能使用 SD 卡，所以我的 .ogg 替换需要直接从我的 PC 转移到 /system/media/audio/ 下它们各自的默认文件夹。

ADB 推送和拉取命令似乎不接受通配符（这很痛苦），但无论如何，尽管将系统文件夹设置为 rw，但当我繁琐地尝试逐个拉取或推送文件时，我得到了“权限被拒绝”。

但是我应该能够从 ADB 的 shell # 提示符交互地 rm 和 cp，使用简单的 Unix 命令在 /system/media/audio 文件夹和我的 Windows PC 之间传输文件组。但要做到这一点，我大概需要挂载我的 PC 源文件夹，我不知道该怎么做。

我将不胜感激任何信息或想法...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:57:42.327

您需要在手机上具有 root 访问权限。作为程序员，我的建议是

1）编写一个程序来做到这一点......

或者只是简单的方法哈哈。试试这个（你的设备必须植根）：

1.  adb shell 使用`$> adb shell`
2.  使用移动到本地文件夹`$> cd /data/local`
3.  现在为您的音调创建一个目录`$> mkdir my_tones`- 这不应该需要 su
4.  接下来，您必须将 .ogg 文件从计算机推送到 /data/local/my_tones 文件夹
5.  现在你可以成为 su 用户`$> su`
6.  现在您应该能够将文件从 /data/local/my_tones 目录复制到您想要的任何位置。

希望这可以帮助。

# gitolite - 拉不工作 - TortoiseGIT / Windows 7 / GIT on Debian + gitolite

> ID：10253395
> 
> 赞同：8
> 
> 时间：2012-04-20T20:52:33.283
> 
> 标签：gitolite, tortoisegit, git-pull

我有一个奇怪的问题。我使用 TortoiseGIT（Win7），我的存储库放置在虚拟服务器（Debian）上，我使用 gitolite 和 SSH 密钥。

我可以`clone`将存储库存储到我的 PC，我可以运行`Fetch`, `Push`, `Commit`, `Sync`.. 一切，但是当其他贡献者尝试`Pull`从服务器`Pushed`进行更改时，会出现以下错误：

```
git.exe pull -v --progress      "origin"
fatal: 'pull' appears to be a git command, but we were not
able to execute it. Maybe git-pull is broken?
git did not exit cleanly (exit code 128) 
```

我不明白，为什么只是`pull`命令不起作用..感谢您的帮助。

我可以使用贡献的更改来克隆存储库..但不能`Pull`对我的 PC 上创建的存储库进行更改。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-23T14:30:29.003

在将 git Bash 可执行文件 sh.exe 更改为始终以管理员身份运行（以解决另一个问题）后，我遇到了同样的问题。然后它让 git 在某些情况下无法访问它并导致各种“也许 git-* 坏了？” 错误。也许这可能会帮助某人......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:41:01.130

卸载旧 Git 并重新安装最新版本为我解决了这个问题。

这是安装程序的 [链接 获取安装程序的链接](http://code.google.com/p/msysgit/downloads/list?q=full%20installer%20official%20git "链接到 git 安装程序")

我的确切错误信息是

```
C:\Program Files (x86)\Git/libexec/git-core\git-pull: line 304: exec: git-merge: not found
fatal: 'pull' appears to be a git command, but we were not
able to execute it. Maybe git-pull is broken? 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T21:51:57.837

错误消息与 Git 密切相关，来自[`help.c`](https://github.com/git/git/blob/master/help.c#L286)：

```
static const char bad_interpreter_advice[] =
  N_("'%s' appears to be a git command, but we were not\n"
  "able to execute it. Maybe git-%s is broken?"); 
```

这类似于[issue 40](http://code.google.com/p/terminal-ide/issues/detail?id=40)（另一个 GUI，这里是[terminal-ide](http://code.google.com/p/terminal-ide/)）。

在那种情况下，这是由于远程Git安装**不完整**

（[第 19 期评论 3](http://code.google.com/p/terminal-ide/issues/detail?id=19#c3)）

> 安装中也缺少 git-merge，可以用

```
$> ln -s git git-merge 
```

> 在`system/bin/`

在您的情况下，分辨率可能不*完全相同*，但它可能与错误的 Git 安装有关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-22T19:22:37.560

我看到您可以运行“git fetch”。如果您还可以运行“git merge”，则运行“git fetch”后跟“git merge”的顺序将完成与“git pull”相同的事情。

来源： http: [//git-scm.com/docs/git-pull](http://git-scm.com/docs/git-pull)

# iphone - 如何在 iphone 中显示正在从外线转接来电的通知

> ID：10253398
> 
> 赞同：1
> 
> 时间：2012-04-20T20:52:39.613
> 
> 标签：iphone, ios, xcode4, notifications

我想创建一个 iPhone 应用程序，它将显示来电正在从外线转发到我的 iPhone 的通知。

目的是，我有 3 条独立的办公室固定电话，可以在下班后将电话转接到我的手机，我想知道它们来自哪里。

有什么可能的方法吗？请帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:10:39.983

在未越狱的电话上，您不能以任何方式干扰来电。

在越狱电话上，您执行此操作的能力取决于进行呼叫转移的电话系统。

# ruby-on-rails-3.1 - 如何通过 force_ssl 传递查询参数

> ID：10253399
> 
> 赞同：0
> 
> 时间：2012-04-20T20:52:46.167
> 
> 标签：ruby-on-rails-3.1

在 Rails 3.1 中，我在进行身份验证时使用 force_ssl。当我将重定向 uri 作为查询字符串附加时，这似乎会导致问题，因为它在 http -> https 协议开关中被剥离。如果我从 https 协议开始，查询字符串将保持不变，并且重定向会正常进行。

关于如何通过 force_ssl 协议开关保留查询字符串的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T14:05:51.827

最新版本的 rails 已修复[https://github.com/rmm5t/rails/commit/391e6a47dbd46fdce0a472819e8d27792cc91984](https://github.com/rmm5t/rails/commit/391e6a47dbd46fdce0a472819e8d27792cc91984)

如果您必须使用 Rails 3.1，则必须在过滤器之前创建自己的 force ssl

```
before_filter :check_ssl

def check_ssl
  redirect_to({:protocol => 'https'}.merge(params), :flash => flash) unless request.ssl?
end 
```

# objective-c - UITableView 自定义节标题消失

> ID：10253401
> 
> 赞同：2
> 
> 时间：2012-04-20T20:52:50.710
> 
> 标签：objective-c, xcode, uitableview

我有一个视图，我试图将其用作 UITableView 的标题部分。

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {
    UILabel *name= (UILabel *)[myView viewWithTag:200];
    name.text = @"title";

    myView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"row-bg-red.png"]];

    return myView;
} 
```

它加载正常，但是当我向下滚动并出现下一个标题时，前一个标题相反：它消失了。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T20:17:42.867

我猜你重用了一个视图。这是不可能的。每个视图（UIView 子类）只能在视图层次结构中出现一次。因此，在您的情况下可能发生的情况是，当您设置第二部分视图时，它会从您上次为第一部分放置的原始位置中删除。

您可以每次直接在`- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section`方法中创建一个新的节标题视图。

# sql - 使用 ElevateDB 插入记录时如何返回 ID 值

> ID：10253402
> 
> 赞同：2
> 
> 时间：2012-04-20T20:52:56.137
> 
> 标签：提升b, sql, delphi, elevatedb

使用 SQL 服务器，您可以简单地返回`@@Identity`以获取`ID`最后插入的值。

有没有办法使用[提升b](/questions/tagged/elevatedb "显示标记为“elevatedb”的问题")做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T13:20:38.073

ElevateDB 提供了一个[LASTIDENTITY](http://www.elevatesoft.com/manual?action=viewtopic&id=edb2sql&topic=LASTIDENTITY)函数，该函数返回分配给指定表中指定列的最后一个标识值。

```
SELECT LASTIDENTITY('Customer', 'CustNo') AS LastCustNo 
```

您还可以使用 INSERT 语句获取相同的信息。

```
EDBQuery1.SQL.Clear;
EDBQuery1.SQL.Add('INSERT INTO Table1 (ID, Text1)');
EDBQuery1.SQL.Add('VALUES(:ID, :Text1)');
EDBQuery1.Prepare;
EDBQuery1.ParamByName('Text1').AsString:='Some text';
EDBQuery1.ExecSQL;
ShowMessage(EDBQuery1.ParamByName('ID').AsString); 
```

> INSERT 语句自动将所有参数设置为 IN/OUT，以便在执行 INSERT 后可以通过相同的参数检索任何生成/计算的列值（包括 IDENTITY 列）。

上面的例子来自[支持论坛](http://www.elevatesoft.com/forums?action=view&category=edb&id=edb_sql&page=1&msg=4220#4220)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T06:04:14.803

ElevateDB 不支持标识或自动递增列类型。所以，没有像`@@Identity`.

# python - 来自 cStringIO 的 Python "\x00" 填充 / utf-32 字符串

> ID：10253405
> 
> 赞同：1
> 
> 时间：2012-04-20T20:53:11.680
> 
> 标签：python, unicode

通过另一个系统的cStringIO，我通过以下方式编写了一些unicode：

`u'content-length'.encode('utf-8')`

并在使用 , 阅读此内容时`unicode( stringio_fd.read(),'utf-8')`，我得到：

u'c\x00\x00\x00o\x00\x00\x00n\x00\x00\x00t\x00\x00\x00e\x00\x00\x00n\x00\x00\x00t\x00\x00\x00-\x00\x00 \x00l\x00\x00\x00e\x00\x00\x00n\x00\x00\x00g\x00\x00\x00t\x00\x00\x00h\x00\x00\x00'

在终端中打印上面的内容给了我正确的价值，但当然，我不能做任何有用的事情：

> 打印 unicode("c\x00\x00\x00o\x00\x00\x00n\x00\x00\x00t\x00\x00\x00e\x00\x00\x00n\x00\x00\x00t\x00\x00\x00-\x00 \x00\x00l\x00\x00\x00e\x00\x00\x00n\x00\x00\x00g\x00\x00\x00t\x00\x00\x00h\x00\x00\x00")
> 
> 内容长度
> 
> 打印 unicode("c\x00\x00\x00o\x00\x00\x00n\x00\x00\x00t\x00\x00\x00e\x00\x00\x00n\x00\x00\x00t\x00\x00\x00-\x00 \x00\x00l\x00\x00\x00e\x00\x00\x00n\x00\x00\x00g\x00\x00\x00t\x00\x00\x00h\x00\x00\x00") == u'内容长度'
> 
> 错误的

将此字符串转换为等效于的字符串的最快、最便宜的方法是`u'content-type'`什么？我不能从 cStringIO 改变

* * *

## 更新

虽然 philhag 的回答是正确的，但问题似乎是：

> StringIO.StringIO(u'content-type').getvalue().encode('utf-8')
> 
> '内容类型'
> 
> StringIO.StringIO(u'content-type').getvalue().encode('utf-8').decode('utf-8')
> 
> u'内容类型'
> 
> cStringIO.StringIO(u'content-type').getvalue().encode('utf-8').decode('utf-8')
> 
> u'c\x00\x00\x00o\x00\x00\x00n\x00\x00\x00t\x00\x00\x00e\x00\x00\x00n\x00\x00\x00t\x00\x00\x00-\x00\x00 \x00t\x00\x00\x00y\x00\x00\x00p\x00\x00\x00e\x00\x00\x00'
> 
> cStringIO.StringIO(u'content-type').getvalue().encode('utf-8').decode('utf-8').decode('utf-32')
> 
> u'内容类型'

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T20:57:09.370

一路走来，将您的值编码为 UTF-32。只需解码它们：

```
>>> b = u"c\x00\x00\x00o\x00\x00\x00n\x00\x00\x00t\x00\x00\x00e\x00\x00\x00\
... n\x00\x00\x00t\x00\x00\x00-\x00\x00\x00l\x00\x00\x00e\x00\x00\x00\
... n\x00\x00\x00g\x00\x00\x00t\x00\x00\x00h\x00\x00\x00"
>>> b.decode('utf-32')
u'content-length' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T23:57:26.923

根本原因是`cStringIO.StringIO(unicode_object)`产生了胡说八道。

docs.python.org 上的[当前 2.X 文档](http://docs.python.org/library/stringio.html#cStringIO.StringIO)说

> 与 StringIO 模块不同，该模块不能接受无法编码为纯 ASCII 字符串的 Unicode 字符串。

这是无用且不正确的；见下文。`chm`随 CPython 2.7.2 和 2.6.6 的 win32 安装程序提供的文档版本如下：

> 使用 Unicode 字符串参数调用 StringIO() 会使用 Unicode 字符串的缓冲区表示形式填充对象，而不是对字符串进行编码。

这是对行为的正确描述（见下文）。行为并不出色。我无法想象从网络文档中删除该句子的充分理由。

行为不端：

```
Python 2.7.2 (default, Jun 12 2011, 15:08:59) [MSC v.1500 32 bit (Intel)] on win32
>>> import StringIO, cStringIO, sys
>>> StringIO.StringIO(u"fubar").getvalue()
u'fubar' <<=== unicode object
>>> cStringIO.StringIO(u"fubar").getvalue()
'f\x00u\x00b\x00a\x00r\x00' <<=== str object
cStringIO.StringIO(u"\u0405\u0406").getvalue()
'\x05\x04\x06\x04' <<=== "accepts"
>>> sys.maxunicode
65535 # your sender presumably emits 1114111 (wide unicode)
>>> sys.byteorder
'little' 
```

所以一般来说，所有需要做的就是知道/猜测发送者 Python 的字节顺序和 unicode-width 并用`UTF-(16|32)-(B|L)E`.

在您的情况下，发件人相当拜占庭式；例如，与您开始使用`u'content-length'.encode('utf-8')`的`str`对象`'content-length'`具有显着相似性的对象。也会`foo.encode(utf8').decode('utf8')`产生一个`foo`或一个异常。

# django - 带有 TastyPie 的主干：DELETE 进行重定向

> ID：10253407
> 
> 赞同：1
> 
> 时间：2012-04-20T20:53:19.460
> 
> 标签：django, backbone.js, tastypie

我正在使用 django-tastypie 和骨干的组合。

我正在尝试做一个`DELETE`，但我得到了`301 Moved Permanently`回应。

这是来自 Firebug 的消息：

```
DELETE http://127.0.0.1:8000/api/1/grocery_item/2 301 Moved Permanently.
GET http://127.0.0.1:8000/api/1/grocery_item/ 
```

我的代码如下：

```
class GroceryListItemResource(ModelResource):

    grocery_list = fields.ForeignKey(GroceryListResource, 'grocery_list', full=True)
    grocery_item = fields.ForeignKey(GroceryItemResource, 'grocery_item', full=True)

    class Meta:
        queryset = GroceryListItem.objects.all()
        resource_name = 'list_items'
        allowed_methods = ['get', 'post', 'delete']
        include_resource_uri = False
        excludes = ['created_at', 'updated_at']
        filtering = {
            'grocery_list': ALL
        }
        authorization= Authorization() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T17:25:31.940

我错过了一个斜杠。127.0.0.1:8000/api/1/grocery_item/2/ 有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T04:01:03.910

查看删除代码，确实没有理由返回 302。当您通过 CURL 发出该请求时会发生什么？Firefox是否有可能以某种方式拦截和更改请求？您是否看到它作为该 URL 的 DELETE 请求通过您的服务器进程？

# java - 如何从文本区域逐行读取

> ID：10253409
> 
> 赞同：9
> 
> 时间：2012-04-20T20:53:53.903
> 
> 标签：java, file-io

我已经弄清楚了如何逐行读取并将文本文档的内容逐行显示到 jtextarea 中，并且我已经弄清楚了如何从字符串数组逐行写出到文本文档。我只是很难从 textarea 中获取每一行，只要我可以将每一行放入一个数组中，我就可以开始了。下面是我将用来将每一行写入文件的代码......

```
public class FileWrite {

    public static void FileClear(String FileName) throws IOException{
        FileWriter fstream = new FileWriter(FileName,true);
        BufferedWriter out = new BufferedWriter(fstream);
        out.write("");
    }

    public static void FileWriters(String FileName, String Content) throws IOException
    {   
        FileWriter fstream = new FileWriter(FileName,true);
        BufferedWriter out = new BufferedWriter(fstream);
        out.append(Content);
        out.newLine();

    }
} 
```

谢谢

C

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-20T20:59:41.067

你得到`TextArea`的只是一个字符串。在换行符处拆分它，你就得到了你的 String[]。

```
for (String line : textArea.getText().split("\\n")) doStuffWithLine(line); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-28T20:06:09.990

我尝试使用 JTextArea 类提供的方法来回答这个问题。

希望这对某人有所帮助，因为我在谷歌搜索时找不到答案。您现在需要做的就是实现方法 processLine(String lineStr)

```
 int lines = textArea.getLineCount();

        try{// Traverse the text in the JTextArea line by line
            for(int i = 0; i < lines; i ++){
                int start = textArea.getLineStartOffset(i);
                int end = texttArea.getLineEndOffset(i);
                // Implement method processLine
                processLine(textArea.getText(start, end-start));

            }
        }catch(BadLocationException e){
            // Handle exception as you see fit
        } 
```

在这里查看类的定义[JTextArea Java 1.7](https://docs.oracle.com/javase/7/docs/api/javax/swing/JTextArea.html)

快乐编码！！！

# c++ - Qt - 及时动态地绘制结果

> ID：10253414
> 
> 赞同：0
> 
> 时间：2012-04-20T20:54:03.797
> 
> 标签：c++, qt, plot, qwt

我编写了一个模拟程序，它解决了一些方程并将结果绘制在一个 OpenGL 窗口中。模拟随着时间不断发展。我想动态添加积分。我正在使用如下代码：

```
QwtPlot* plot = new...;
QwtPlotCurve* plotdata = new...;
QVector<QPoint> data = getData();
plotdata->setSamples(data); 
```

这得到了重置所有点的情节。我可以简单地加分吗？

感谢您的任何努力:-)

* * *

如果没有办法做到这一点，我很想听听。请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T23:21:16.133

使用[`QTimer`](http://qt-project.org/doc/qt-4.8/QTimer.html)带有可调间隔的 a[`QSpinBox`](http://qt-project.org/doc/qt-4.8/qspinbox.html)怎么样？

```
 QTimer *timer = new QTimer(this);
    connect(timer, SIGNAL(timeout()), this, SLOT(updatePlot()));
    timer->start(5000); //adjust from GUI with timer->setInterval(newValue)

    ...

    void updatePlot(){
        // QSettings initialized somewhere
        int maxSamples = settings.value("plot/maxSamples", 100).toInt();
        QVector<QPoint> data = getData(maxSamples);  // get this many samples
        plotdata->setSamples(data);

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T17:20:55.850

我得到了它。没有办法以那种抽象的方式做到这一点。但人们可以回忆起这种方法：

```
void QwtPlotCurve::setRawSamples(); 
```

使用 replot()，这将是最便宜的方法。它不涉及任何数据复制。

干杯:)

# ios - ios谷歌api问题

> ID：10253416
> 
> 赞同：1
> 
> 时间：2012-04-20T20:54:09.383
> 
> 标签：ios, google-maps, mkmapview

我需要在我正在开发的 iPhone 应用程序中添加一个非常常见的 Google 功能。这个想法是向用户呈现一个文本框，他可以在其中写一个地址（即：“Amsterdam av）”。问题是我想为他添加一些“帮助”，当他写下街道名称时，应用程序会向他显示部分匹配的列表，就像谷歌地图在这里所做的那样：

[示例 http://www.timotteo.com.ar/google.png](http://www.timotteo.com.ar/google.png)

我在 google API 中找不到确切的类。它不需要像谷歌自己的搜索那样快，也许用户可以写“amst”并按下搜索按钮，以显示部分匹配的列表。我正在寻找的 API 以某种方式显示返回一个具有可能性的列表。我现在能找到的所有方法都可以在你用特定地址喂它时为你提供纬度/经度。有人知道我应该使用什么方法/类的组合吗？也许是一些例子？

提前TXS！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:58:56.150

也许您正在寻找 Places API 的自动完成功能： [https ://developers.google.com/maps/documentation/javascript/places#places_autocomplete](https://developers.google.com/maps/documentation/javascript/places#places_autocomplete)

这不会针对所有地址或街道自动完成，而是针对企业、著名地标等。

如果您想自动完成街道地址，我认为这不能通过任何记录在案的 API 获得。这并不意味着不存在变通方法，但它们可能取决于有关您的用例的更多详细信息。（例如，如果您只关心一个狭窄的地理区域，则可以简单地在您自己的数据库中拥有所有街道的列表并自己处理 AJAX 调用。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T17:13:08.753

实际上我正在寻找的是这个：

[http://maps.google.com/maps/geo?q=amsterdam%201543&output=xml&oe=utf8&sensor=true&hl=es&gl=ar](http://maps.google.com/maps/geo?q=amsterdam%201543&output=xml&oe=utf8&sensor=true&hl=es&gl=ar)

该 URL 返回和 XML 以及所有自动完成选项。我所要做的就是解析那个 XML，瞧！我有我的清单。

# ios - 一个视图中的多个 TableViews - 数据源数组？

> ID：10253425
> 
> 赞同：0
> 
> 时间：2012-04-20T20:55:01.143
> 
> 标签：ios, xcode, uitableview

我正在尝试重新创建一个类似于 iPhone 上的“天气”应用程序的视图控制器。我有一个滚动视图，每页包含一个单独的表格视图，我正在努力寻找一种方法来为每个表格视图指定数据。

棘手的部分是每个 tableview 中的信息和 tableviews 本身会根据用户默认值发生变化。基本上，我有一个存储在用户默认值中的字典数组，并且该数组中的每个对象都有自己的表格视图。每个字典都包含一个标题、一个纬度和一个经度。创建表时，我还使用 lat 和 long 通过 api 调用和解析器从 Internet 获取一些数据。这是代码：

```
 - (void)setupScrollView
{
    scrollView.delegate = self;

    [self.scrollView setBackgroundColor:[UIColor clearColor]];
    [scrollView setCanCancelContentTouches:NO];

    scrollView.indicatorStyle = UIScrollViewIndicatorStyleWhite;
    scrollView.clipsToBounds = YES;
    scrollView.scrollEnabled = YES;
    scrollView.pagingEnabled = YES;
    scrollView.showsHorizontalScrollIndicator = NO;

    //this is an array of dictionaries that hold a location title, as well as a lat and lng.
    NSArray *arrayForLocations = [NSArray arrayWithArray:[appDelegate.defaults objectForKey:@"arrayOfLocationDicts"]];
    NSLog(@"Array of Location Dicts holds: %@",arrayForLocations);

    for (int i = 0; i < arrayForLocations.count; i++) {
        CGRect frame;
        frame.origin.x = self.scrollView.frame.size.width * i;
        frame.origin.y = 0;
        frame.size = self.scrollView.frame.size;

        UIView *subview = [[UIView alloc] initWithFrame:frame];
        [self.scrollView addSubview:subview];
        UITableView *tbView = [[UITableView alloc]initWithFrame:CGRectMake(0, 40, scrollView.frame.size.width, scrollView.frame.size.height - 40)];
        tbView.backgroundColor = [UIColor grayColor];
        tbView.tag = i;
        tbView.delegate = self;
        tbView.dataSource = self;
        [subview addSubview:tbView];

        UILabel *locationLabel = [[UILabel alloc]initWithFrame:CGRectMake(5, 5, 260, 40)];
        locationLabel.textColor = [UIColor blackColor];
        locationLabel.text = [[arrayForLocations objectAtIndex:i]objectForKey:@"location_address"];
        [subview addSubview:locationLabel];

        pageControl.numberOfPages = [arrayForLocations count];
        //get coordinate from dictionary
        CLLocationCoordinate2D eventCoordinate;
        eventCoordinate.latitude = [[[arrayForLocations objectAtIndex:i]objectForKey:@"location_latitude"]floatValue];
         eventCoordinate.longitude = [[[arrayForLocations objectAtIndex:i]objectForKey:@"location_longitude"]floatValue];
        //turn coordinate into data
        SDJConnection *connection = [[SDJConnection alloc]init];
        NSMutableArray *singleDataSource = [connection getEventInfoWithCoordinate:eventCoordinate];
        //store data in array
        [arrayOfDataSources addObject:singleDataSource];
        NSLog(@"array of Data Sources in the scrollsetup: %@",arrayOfDataSources);

    }

    self.scrollView.contentSize = CGSizeMake(self.scrollView.frame.size.width * arrayForLocations.count, self.scrollView.frame.size.height);
} 
```

所以现在我的问题是告诉这些表中的每一个要显示什么数据。我的第一个想法是设置表格的标签，就像我在上面做的那样，然后在 cellForRowAtIndexPath 中有这样的东西 -

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        static NSString *CellIdentifier = @"Cell";

        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
        }

         int i = tableView.tag;
        if (tableView.tag = i) {

            cell.textLabel.text = [[[arrayOfDataSources objectAtIndex:i]objectAtIndex:indexPath.row]eventTitle];
    } 
```

不幸的是，这并没有为我正确工作。有人对如何完成这项工作有任何想法吗？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:04:57.893

当然

```
if (tableView.tag = i) { 
```

应该

```
if (tableView.tag == i) { 
```

即便如此，这也是一个奇怪的结构——不确定你想要在那里实现什么。您将 i 设置为标签，然后检查标签是否为 i？真的没有意义——这就是我建议你仔细看看并重新考虑你的逻辑的地方。

# uml - 在 UML 中，如果一个类使用另一个类的静态方法，那么两个类之间存在什么样的关联？

> ID：10253426
> 
> 赞同：0
> 
> 时间：2012-04-20T20:55:01.143
> 
> 标签：uml, class-diagram

例如，假设我们有一个名为“Secretary”的类和另一个名为“Utils”的类

Utils 有一些函数可以做一般的事情，例如找到 3 个整数的最大值。

“秘书”需要调用其中一些函数，在此类中，这些函数使用以下表示法调用：

```
Utils.function() 
```

现在我的问题是，如果有的话，这两个类之间存在什么样的关联？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T22:36:45.090

最有可能的依赖。关联通常用于捕获在域中具有有意义语义的某些关系。例如，秘书“为”经理工作。您的示例不同：您没有捕获实例之间有意义的关系。因此依赖关系可能是最合适的。

更重要的是：你想说明什么？记住要像使用任何其他工具一样使用 UML——让它为你工作。因此，例如，如果 (a) 它可以帮助您和/或 (b) 它可以帮助您与其他团队成员沟通，则可以显示二进制关联。它不符合预期的 UML 用法这一事实并不重要——只要您发现它有用。

hth。

# java - 如何在打开 JFrame 的 Java Applet 中制作按钮？

> ID：10253428
> 
> 赞同：1
> 
> 时间：2012-04-20T20:55:08.793
> 
> 标签：java, swing, applet, jframe, japplet

我已经制作了一些 JFrame，我想从 JApplet 中调用它们。做这个的最好方式是什么？我可以在我的 init 方法中实例化我的 JFrame，然后在按下按钮时调用它们吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:13:24.017

> 如何在打开 JFrame 的 Java Applet 中制作按钮？

您可能不应该这样做，但是如果您想从 JApplet 打开另一个窗口，请创建并显示一个 JDialog。它们的创建和显示类似于 JFrame，但使用不同的构造函数。您需要为 JDialog 的“所有者”参数获取小程序的窗口，这可以通过以下方式获得：

```
Window w = (Window) SwingUtilities.getAncestorOfClass(Window.class, comp); 
```

其中 comp 是 JApplet 中的可见组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-10T09:44:32.277

您可以`JFrame`使用其默认构造函数创建，然后显示它：

```
JFrame frame = new JFrame();
JLabel label = new JLabel("Welcome");
frame.add(label);
frame.pack();
frame.setVisible(true); 
```

这段代码从小程序派生出来的方式与独立程序类似。无需任何特殊技巧。小程序本身只能包含诸如“按下以启动应用程序”之类的按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:02:35.100

好的，听起来您在初始化时初始化了一个 JFrame 并存储了它。您不需要从初始化中重新实例化 JFrame。相反，只需将其存储在 Applet 的一个字段中，并在按下按钮时使用它。

或者您可以使用单例和延迟初始化：

```
class JFrameToOpen extends JFrame {
    private static JFrame frame = null;
    private JFrameToOpen() {
        //init
    }
    public static GetJFrame() {
        if(frame==null) {
            frame=new JFrameToOpen();
        }
        return frame;
    }
} 
```

但是单例是丑陋的，很多人选择避免使用它们。

# wpf - 如何将本地布尔与视图模型布尔或绑定到可见性属性

> ID：10253431
> 
> 赞同：0
> 
> 时间：2012-04-20T20:55:38.133
> 
> 标签：wpf, binding, viewmodel

我在加载一系列仪表用户控件的用户控件中有以下 XAML：

```
<ItemsControl ItemsSource="{Binding InstanceViper.Gauges}" Grid.Row="7" Grid.ColumnSpan="4">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel Name="GaugePanel" VerticalAlignment="Bottom" HorizontalAlignment="Left" Orientation="Horizontal">
                    </WrapPanel>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <local:Gauge DataContext="{Binding}" AlwaysShowGauge="False"></local:Gauge>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl> 
```

我正在传递一个标志，该标志确定仪表是否应始终显示或仅在警报时显示。现在在仪表 xaml 中，我想做如下的事情来确定是否应该显示它：

```
<Border Name="MainBorder" Visibility="{Binding (ShowAlarm || AlwaysShowGauge) ,Converter={StaticResource BooleanToVisibilityConverter}}"> 
```

问题是 ShowAlarm 属性来自仪表视图模型，而 AlwaysShowGauge 是在数据模板中传入的本地属性。ShowAlarm 是动态的，但 AlwaysShowGauge 一旦设置就不会改变。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:05:06.540

很难说出你的边界来自哪里，以及其中一个绑定来自哪里。但是你可以控制绑定流，这不是问题。主要问题是你如何多重触发，下面只是一个开始。一旦您了解了如何进行多重触发，您就可以使用绑定，从一个视图模型或视图属性控制流程，或者使用来自不同来源的路径，要做到这一点，您可能必须放置以下示例在 DataTemplate 中并使用 SourceName 和 TargetName.. 但同样，很难分辨边界在哪里。

```
<converters:OrMultiConverter x:Key="Or" />

<Style x:Key="MainBorderStyle" TargetType="{x:Type Border}">
<Setter Property="Visibility" Value="Hidden" />
<Style.Triggers>
    MultiDataTrigger>
    <MultiDataTrigger.Conditions>
        <Condition Value="True">
            <Condition.Binding>
                <MultiBinding Converter="{StaticResource Or}">
                    <Binding Path="ShowAlarm"/>
                    <Binding Path="AlwaysShowGaug"/>
                </MultiBinding>
            </Condition.Binding>
        </Condition>
        </MultiDataTrigger.Conditions>
            <MultiDataTrigger.Setters>
                <Setter Property="Visibility" Value="Visible"/>
            </MultiDataTrigger.Setters>
        </MultiDataTrigger>
</Style.Triggers> 
```

```
public class OrMultiConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        if (values.Any(value => value == null || value == DependencyProperty.UnsetValue))
            return false;

        var boolValues = values.Cast<bool>();

        var result = boolValues.Any(b => b);

        return result;
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

# javascript - JavaScript 中的性能内存管理

> ID：10253434
> 
> 赞同：3
> 
> 时间：2012-04-20T20:55:55.590
> 
> 标签：javascript, performance, memory, memory-management

让我从问题开始，然后填写原因/背景。

问题：是否有任何用于 JavaScript 的内存分析工具？

问题：有人已经在 J​​avaScript 中测试过性能内存管理吗？

我想在 JavaScript 中试验性能内存管理。在 C/C++/Assembly 中，我能够在一个巨大的块中分配一个内存区域，然后将我的数据结构映射到该区域。这有几个性能优势，特别是对于数学繁重的应用程序。

我知道我无法在 JavaScript（或 Java）中分配内存和映射我自己的数据结构。但是，我可以使用一些预定数量的对象（例如 Vector 对象）创建堆栈/队列/堆。在处理数字时，我经常在任何时候都只需要几个这样的对象，但随着时间的推移会产生大量的数字。通过重用旧的向量对象，我可以避免创建/删除时间、不必要的垃圾收集时间以及等待垃圾收集时潜在的大内存占用。我还假设它们都将在内存中保持相当接近，因为它们是同时创建的并且经常被访问。

我想对此进行测试，但我缺少内存分析工具。我试过 FireBug，但它没有告诉你 JavaScript 引擎当前分配了多少内存。

我能够编写一个简单的 CPU 性能测试（见下文）。我将一个包含 10 个“矢量”对象的队列与每次使用 new/delete 进行了比较。为了确定我不只是使用空数据，我分配了 Vector 6 个浮点属性、一个三值数组（浮点数）和一个 18 个字符的字符串。每次我使用任何一种方法创建一个向量时，我都会将所有值设置为 0.0。

结果令人鼓舞。显式管理方法最初更快，但 javascript 引擎有一些缓存，并且在运行几次测试后就赶上了。最有趣的部分是当我尝试在 1000 万个对象上运行标准的 new/delete 时，FireBug 崩溃了，但对于我的队列方法来说工作得很好。

如果我能找到内存分析工具，我想在不同的结构（数组、堆、队列、堆栈）上进行测试。我还想在一个真实的应用程序上测试它，也许是一个超级简单的光线追踪器（快速编码，可以测试非常大的数据集，其中包含大量数学以获得良好的分析）。

是的，我在创建这个问题之前进行了搜索。我发现的所有内容要么是关于 JavaScript 内存泄漏的讨论，要么是关于 GC 与显式管理的讨论。

谢谢，JB

**标准方法**

```
function setBaseVectorValues(vector) {
    vector.x = 0.0;
    vector.y = 0.0;
    vector.z = 0.0;
    vector.theta = 0.0;
    vector.phi = 0.0;
    vector.magnitude = 0.0;
    vector.color = [0.0, 0.0, 0.0];
    vector.description = "a blank base vector";
}

function standardCreateObject() {
    var vector = new Object();
    setBaseVectorValues(vector);

    return vector;
}

function standardDeleteObject(obj) {
    delete obj;
}

function testStandardMM(count) {
    var start = new Date().getTime();
    for(i=0; i<count; i++) {
        obj = standardCreateObject();
        standardDeleteObject(obj);
    }
    var end = new Date().getTime();

    return "Time: " + (end - start)
} 
```

**托管方法**

[我使用了来自http://code.stephenmorley.org/javascript/queues/](http://code.stephenmorley.org/javascript/queues/)的 JavaScript 队列

```
function newCreateObject() {
    var vector = allocateVector();
    setBaseVectorValues(vector);

    return vector;
}

function newDeleteObject(obj) {
    queue.enqueue(obj);
}

function newInitObjects(bufferSize) {
    queue = new Queue()
    for(i=0; i<bufferSize; i++) {
        queue.enqueue(standardCreateObject());
    }
}

function allocateVector() {
    var vector
    if(queue.isEmpty()) {
        vector = new Object();
    }else {
        vector = queue.dequeue();
    }

    return vector;
}

function testNewMM(count) {
    start = new Date().getTime();
    newInitObjects(10);
    for(i=0; i<count; i++) {
        obj = newCreateObject();
        newDeleteObject(obj);
        obj = null;
    }
    end = new Date().getTime();

    return "Time: " + (end - start) + "Vectors Available: " + queue.getLength();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:08:27.420

chrome 检查器有一个不错的 javascript 分析工具。我会试试那个...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:09:04.097

我从未见过这样的工具，但实际上，javascript [几乎] 从未独立运行；它[几乎]总是托管在另一个应用程序（例如您的浏览器）中。与您的特定数据结构关联多少内存并不重要，重要的是主机应用程序的整体内存消耗如何受脚本影响。

我建议为您的操作系统找到一个通用的内存分析工具并将其指向您的浏览器。运行单个页面并分析触发代码前后浏览器内存消耗的变化。

我现在能想到的唯一例外是 node.js ...如果您使用的是 node，那么您可以使用[`process.memoryUsage()`](http://nodejs.org/api/process.html#process_process_memoryusage).

**编辑：噢……经过一番搜索，** [Chrome](http://zetafleet.com/blog/google-chromes-heap-profiler-and-memory-timeline) 似乎也有一些不错的工具。（[Michael Berkompas +1](https://stackoverflow.com/a/10253576/5628)）。我仍然坚持我最初的说法，实际上更重要的是查看浏览器进程本身的内存使用情况如何受到影响，但 Chrome 工具的优雅令人印象深刻。

# c# - JavaScriptSerializer 错误：数组的反序列化不支持“ResponseBody”

> ID：10253436
> 
> 赞同：1
> 
> 时间：2012-04-20T20:55:59.933
> 
> 标签：c#, asp.net, json, deserialization

我将 json 字符串作为 http 请求发送并在响应中接收 json 字符串。我创建了自己的类来序列化和反序列化。它们如下所示：

## 在请求方面 -

```
public class RequestHead
{        
    public string source {get; set;}        
    public string dest {get; set;}        
}

public class RequestBody
{
    private List<string> id {get; set;}        
    public bool direction {get; set;}

    public RequestBody()
    {
        this.id = new List<string>();
    }
}

public class RequestObj
{        
    public RequestHead head {get; set;}
    public RequestBody body {get; set;}
} 
```

## 在响应方面 -

```
public class ResponseHead
{        
    public bool result {get; set;}        
    public float time {get; set;}        
}

public class ResponseBody
{        
    public List<string> body{get; set;}
}

public class ResponseObj
{        
    public ResponseBody body {get; set;}        
    public ResponseHead head {get; set;}        
} 
```

## 在 .asmx 文件中

```
 RequestObj request_obj = new RequestObj();
            request_obj.head = head;
            request_obj.body = body;

            var httpWebRequest = (HttpWebRequest)WebRequest.Create("the url");
            httpWebRequest.ContentType = "text/json";
            httpWebRequest.Method = "POST";
            JavaScriptSerializer serializer = new JavaScriptSerializer();

            using (var streamWriter = new StreamWriter(httpWebRequest.GetRequestStream()))
            {
                string json = serializer.Serialize(request_obj);
                streamWriter.Write(json);
            }
            var httpResponse = (HttpWebResponse)httpWebRequest.GetResponse();
            using (var streamReader = new StreamReader(httpResponse.GetResponseStream()))
            {
                var responseText = streamReader.ReadToEnd();
                ResponseObj response_obj = new ResponseObj();
                response_obj = serializer.Deserialize<ResponseObj>(responseText);
                ResponseBody response_body = new ResponseBody();
                response_body = response_obj.body;
                ResponseHead response_head = new ResponseHead();
                response_head = response_obj.head;                    
            } 
```

我已经提到了这篇文章，这正是我所拥有的场景[-System.MissingMethodException：json数组反序列化时出错](https://stackoverflow.com/questions/9173811/system-missingmethodexception-error-while-deserialization-of-json-array) 但是这里提到的制作列表的解决方案对我不起作用，或者我做错了其他事情。

在请求端一切正常。在响应端，正文可以有 1 个字符串或字符串数​​组。无论我有一个还是一个数组，我仍然得到同样的错误。

### 我不想使用 JSON.NET

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T06:16:37.493

我认为问题在于您没有将`[Serializable]`标志设置为：

```
[Serializable]
public class ResponseHead
{        
    public bool result {get; set;}        
    public float time {get; set;}        
}

[Serializable]
public class ResponseBody
{        
    public List<string> body{get; set;}
}

[Serializable]
public class ResponseObj
{        
    public ResponseBody body {get; set;}        
    public ResponseHead head {get; set;}        
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T16:32:29.513

这对我有用 -

### 将 body 的类型更改为 string[] 而不是 List

并将代码更改为 -

```
 var rbody = serializer.Deserialize<ResponseBody>(responseText);                              
            response_obj.body = new ResponseBody();
            response_obj.body.body = rbody.body.ToArray(); 
```

# image - 显示上传的图片尺寸更小php

> ID：10253442
> 
> 赞同：0
> 
> 时间：2012-04-20T20:56:15.423
> 
> 标签：image, image-size

我有一个文件夹，我的所有图像都将在其中上传，我想创建一个 div，其中上传的图像以较小的尺寸显示。

我不想保存上传图片的较小版本，我只想以较小的尺寸显示它们。

上传的文件已经是 100x100 大小，所以我不必担心比例问题

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:59:08.300

HTML 路由（内联）：

```
<div class="normal image"><img src="images/imgsrc.jpg" width="100" /></div>
<div class="smaller image"><img src="images/imgsrc.jpg" width="75" /></div>
<div class="half image"><img src="images/imgsrc.jpg" width="50" /></div>
<div class="tiny" image><img src="images/imgsrc.jpg" width="25" /></div> 
```

CSS路线：

```
<div class="normal image"><img src="images/imgsrc.jpg" /></div>
<div class="smaller image"><img src="images/imgsrc.jpg" /></div>
<div class="half image"><img src="images/imgsrc.jpg" /></div>
<div class="tiny image"><img src="images/imgsrc.jpg" /></div>
<style type="text/css">
.image img{width:90px;}
.normal img{width:auto;}
.smaller img{width:75px;}
.half img{width:50px;}
.tiny img{width:25px;}
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:58:34.390

只需使用 css 设置您想要的大小：

```
div img {
  width: 50px;
  height: 50px;
} 
```

# java - 使用 BitmapFont 绘制字符串

> ID：10253448
> 
> 赞同：1
> 
> 时间：2012-04-20T20:56:47.667
> 
> 标签：java, libgdx

抱歉这个愚蠢的问题，但我是一个安静的菜鸟。我不知道如何在 Libgdx 中绘制位图字体。好吧，我已经使用 HIERO v2.0 工具制作 BitmapFont 文件。然后我在代码中初始化它：

```
BitmapFont font = new BitmapFont(Gdx.files.internal("data/fonts/Georgia.fnt"), Gdx.files.internal("data/fonts/Georgia.png"), false); 
```

但是当我尝试在屏幕上绘制它时：

```
game.batch.begin();    
font.draw(game.batch, "Text string", game.screenWidth * 0.5f, game.screenHeight * 0.5f);
game.batch.end(); 
```

我得到这个结果： http: [//imageshack.us/photo/my-images/696/bitmapfont.png/](http://imageshack.us/photo/my-images/696/bitmapfont.png/) 有人知道，我做错了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T16:06:50.940

当 Georgia.fnt 和 Georgia.png 不同步时，往往会发生这种情况。也就是说，它们来自不同的出口。

仔细检查您是否将两者都保存在 HIERO 中

# python - Python - 从 html 获取文本

> ID：10253450
> 
> 赞同：-2
> 
> 时间：2012-04-20T20:57:00.290
> 
> 标签：python, html, text

如何以一种不错的方式从此 html 代码中提取文本“ROYAL PYTHON”？我一直在寻找解决方案 4 小时，但我没有发现任何真正相关且有效的东西。

```
<div class="definicja"><a href="javascript: void(0);"
onclick="play('/mp3/1/81/c5ebfe33a08f776931d69857169f0442.mp3')"
class="ikona_sluchaj2"></a> <a href="/slownik/angielsko_polski/,royal+python">ROYAL
PYTHON</a></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:17:14.813

正如 Joel Cornett 提到的，像这样使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)：

```
from bs4 import BeautifulSoup

html = '''<div class="definicja"><a href="javascript: void(0);" onclick="play('/mp3/1/81/c5ebfe33a08f776931d69857169f0442.mp3')" class="ikona_sluchaj2"></a> <a href="/slownik/angielsko_polski/,royal+python">ROYAL PYTHON</a></div>'''

soup = BeautifulSoup(html)
print soup.getText() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:12:06.703

您可以使用 lxml 和 xpath：

```
from lxml.html.soupparser import fromstring

s = 'yourhtml'
h = fromstring(s)
print h.xpath('//div[@class="definicja"]/a[2]/text()')[0] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:21:48.650

还有标准模块 xml.etree.ElementTree

```
import xml.etree.ElementTree as ET

fragment = '''<pre>
<div class="definicja"><a href="javascript: void(0);"
  onclick="play('/mp3/1/81/c5ebfe33a08f776931d69857169f0442.mp3')"
  class="ikona_sluchaj2"><img src="/images/ikona_sluchaj2.gif" alt=""
  /></a> <a href="/slownik/angielsko_polski/,royal+python">ROYAL
  PYTHON</a></div>
</pre>'''

frg = ET.fromstring(fragment)
for a in frg.findall('div/a'):
    if a.text is not None:
        print a.text
        print '------'
        print ' '.join(a.text.split())  # all words to one line 
```

它打印在我的控制台上

```
ROYAL
  PYTHON
------
ROYAL PYTHON 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T21:14:34.393

假设这里有几件事：(1) HTML 片段将始终是有效的 XHTML，并且 (2) 您正在寻找片段中第二个锚标记内的文本

```
from xml.dom.minidom import parseString

htmlString = """<pre><div class="definicja"><a href="javascript: void(0);" onclick="play('/mp3/1/81/c5ebfe33a08f776931d69857169f0442.mp3')" class="ikona_sluchaj2"><img src="/images/ikona_sluchaj2.gif" alt=""/></a> <a href="/slownik/angielsko_polski/,royal+python">ROYAL PYTHON</a></div></pre>"""

xmlDoc = parseString(htmlString)
anchorNodes = xmlDoc.getElementsByTagName("a")
secondAnchorNode = anchorNodes[1]
textNode = secondAnchorNode.childNodes[0]

print textNode.nodeValue 
```

xml 包含在 Python 中，因此您不必担心安装任何包。

# jquery - jQuery拖放-droppable包含draggable

> ID：10253455
> 
> 赞同：2
> 
> 时间：2012-04-20T20:57:19.003
> 
> 标签：jquery, jquery-ui, drag-and-drop, jquery-ui-draggable

我对 JQuery 很陌生，但我设法自己做了一些事情。我有一个三个输入字段和三个选项。选项可以拖到输入字段中，但不能将两个可拖动项放入一个可放置项中。

如果您不将可拖动对象移动到可放置对象上，这将非常有效。但是，当您查看可放置的 JQuery 时，会执行“out”事件。我希望有一个“辍学”事件可以解决我的问题，但没有。

（“removeClass”函数也有问题，因为它不起作用。但这不是一个大问题......）。

```
$(function() {
    var textbox; 

    $( ".draggable" ).draggable({ 
        revert: function ( event, ui ) {
            $(this).data("draggable").originalPosition = {
                top: 0,
                left: 0
            };
            return !event;
        },
    });

    $( ".droppable" ).droppable({
        activeClass: "ui-state-hover",
        hoverClass: "ui-state-active",
        drop: function( event, ui ) {

            //check if droppabele contains draggable
            if ($(this).data("containsDrop") === 0 || $(this).data("containsDrop") === undefined) { //doesn't contain
                $(this).data("containsDrop", 1);

                ui.draggable.position( { of: $(this), my: 'left top', at: 'left top' } );
                textbox = this;

                $( this ).addClass( "ui-state-highlight" )

            } else { //contains --> go back to options
                ui.draggable.animate({ top: 0, left: 0 }, 'slow');
            }
        },
        out: function ( event, ui ) {
            $(this).data("containsDrop", 0);
            $(textbox).removeClass( "ui-state-highlight" );
        }
    });
}); 
```

我希望有人可以看看这个小提琴：http: [//jsfiddle.net/u7aJ7/10/](http://jsfiddle.net/u7aJ7/10/)

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T18:15:32.350

我花了几个小时在上面并制定了以下解决方案。

[您可以在http://jsfiddle.net/s5057285/yx3gW/](http://jsfiddle.net/s5057285/yx3gW/)上查看一个工作示例

```
if ($("div.draggable").length > 0) {
    $("div.draggable").draggable({
        //callback 
        revert: function(droppableObj) {
            if (droppableObj === false) {
                //revert to original position
                $(this).data("draggable").originalPosition = {
                    top: 0,
                    left: 0
                };
                var textbox = $(this).data("droppable");
                $(textbox).width(74);
                $(textbox).val('');
                $(this).removeClass("dropped");

                positionDraggables();

                return true;
            } else {

                positionDraggables();

                return false;
            }
        }
    });
}

if ($("div.draggable").length > 0) {
    $("input.droppable").droppable({
        drop: function(event, ui) {
            //postition of draggable is the same as droppable
            ui.draggable.position({
                of: $(this),
                my: 'left top',
                at: 'left top'
            });
            //text from draggable in textfield
            $(this).draggable("widget").val(ui.draggable.text());
            //store the droppable in the draggable
            ui.draggable.data("droppable", this);
            ui.draggable.addClass("dropped");
            //change width and height to size of draggable
            $(this).width(ui.draggable.width());
            $(this).height(ui.draggable.height());
        }
    });
}

function positionDraggables() {
    var selects = $('body').find('div.options');
    selects.each(function(index, el) {
        var children = el.children;
        for (var i = 0; i < children.length; i++) {
            var child = children[i];
            if ($(child).hasClass("dropped")) {
                var textbox = $(child).data("droppable");
                $(child).position({
                    of: $(textbox),
                    my: 'left top',
                    at: 'left top'
                });
            }
        }
    });
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:04:53.800

与其通过将 dropcount 存储在数据中来自己维护 dropcount，不如在 drop 事件中检查该 div 的内容。

```
drop: function( event, ui ) {
   if ( $(this).children('.draggable').length == 0 )
      ui.draggable.position( { of: $(this), my: 'left top', at: 'left top' } );
      var targetElem = $(this).attr("id");
      textbox = this;

      $( this ).addClass( "ui-state-highlight" );

   } else { //contains --> go back to options
      ui.draggable.animate({ top: 0, left: 0 }, 'slow');
   }
} 
```

# java - Java SMPP 实现接收短信

> ID：10253458
> 
> 赞同：5
> 
> 时间：2012-04-20T20:58:01.287
> 
> 标签：java, smpp

什么是 SMPP 协议的最佳 JAVA 实现，需要在 SMSC 上提供侦听器以接收消息“接收者接受 Deliver_SM”
最好我的意思是简单，文档，教程，论坛.. 感谢您的帮助
谢谢 :)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T18:11:44.183

这是一个迟到的答案，但对于任何跟进的人来说，也可能会发现 twitter SMPP 库非常有帮助。对窗口大小、易于遵循的示例和对高容量的支持有很好的支持。

[https://github.com/twitter/cloudhopper-smpp/](https://github.com/twitter/cloudhopper-smpp/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T21:14:59.000

我没有从事以下工作，但可能对您有所帮助：

*   [具有 Apache 许可证的 JSMPP](http://code.google.com/p/jsmpp/)，
*   [通过 Logica 打开 SMPP](http://opensmpp.logica.com/introhtml/menu.htm)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T18:09:18.160

我认为 jsmpp lib 是最好的选择，因为许多底层的事情发生在幕后，你可以专注于业务逻辑

我在我的许多项目中都使用过它并且效果很好

[JSMPP 主页](http://code.google.com/p/jsmpp/)
[SMPP 规范](http://majoron.com/documents/specifications/smpp/SMPP_v5_0.pdf%E2%80%8E)

# haskell - 什么 Haskell 类型系统魔法允许定义连接？

> ID：10253461
> 
> 赞同：6
> 
> 时间：2012-04-20T20:58:20.390
> 
> 标签：haskell

`join`效用函数定义为：

```
join :: (Monad m) => m (m a) -> m a
join x = x >>= id 
```

鉴于`>>=`is`Monad m => m a -> (a -> m b) -> m b`和`id`is的类型`a -> a`，该函数如何也`a -> m b`像上面定义中的那样被键入？在这种情况下`m`是什么？`b`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-20T21:05:42.277

和`a`类型中的s不一定是相同的 s，所以让我们重述一下类型：`>>=``id``a`

```
(>>=)    :: Monad m => m a     -> (a -> m b) -> m b
id       ::                        c -> c 
```

所以我们可以得出结论，毕竟`c` *是*一样的`a`，至少当`id`是`>>=`...的第二个参数时，也是`c`一样的`m b`。所以`a`是一样的`m b`。换句话说：

```
(>>= id) :: Monad m => m (m b) ->               m b 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-21T00:57:22.810

dave4420 打了它，但我认为下面的评论可能仍然有用。

您可以使用一些规则将类型有效地“重写”为与原始类型兼容的另一种类型。这些规则涉及用其他类型替换所有出现的类型变量：

*   如果有`id :: a -> a`，可以替换`a`为`c`并获取`id :: c -> c`。后一种类型也可以重写为原来的`id :: a -> a`，这意味着这两种类型是等价的。作为一般规则，如果您将类型变量的所有实例替换为原始中未出现的另一个类型变量，您将获得等效类型。
*   您可以将所有出现的类型变量替换为具体类型。即，如果您有`id :: a -> a`，您可以将其重写为`id :: Int -> Int`. 然而，后者不能被重写回原来的，所以在这种情况下，你要**专门**化类型。
*   与第二条规则相比，您可以将所有出现的类型变量替换为任何类型、具体或变量。因此，例如，如果您有`f :: a -> m b`，您可以替换所有出现的`a`with`m b`和 get `f :: m b -> m b`。由于这个也无法撤消，因此它也是一种专业化。

最后一个示例显示了如何`id`将其用作 的第二个参数`>>=`。所以你的问题的答案是我们可以重写和派生类型如下：

```
1\. (>>=)    :: m a -> (a -> m b) -> m b        (premise)
2\. id       :: a -> a                          (premise)
3\. (>>=)    :: m (m b) -> (m b -> m b) -> m b  (replace a with m b in #1)
4\. id       :: m b -> m b                      (replace a with m b in #2)
   .
   .
   .
n. (>>= id) :: m (m b) -> m b                  (indirectly from #3 and #4) 
```

# c# - 如何以编程方式取消选中 ToggleButton

> ID：10253463
> 
> 赞同：2
> 
> 时间：2012-04-20T20:58:25.543
> 
> 标签：c#, .net, wpf

这是我的代码

```
private void buttonClickone(object sender, RoutedEventArgs e) {
    if (WhichV == -1) {
        ShowMessage(PleaseSelectXXX);
        return;
    }

    ButtonClick(1);
    BeginOPHandler(Ep, null);
} 
```

我的逻辑是，如果满足 if 语句的条件，我想取消选中切换按钮但不执行`BeginOPHandler(Ep, null)`操作。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T21:05:09.617

```
 buttonName.IsChecked = false 
```

那应该取消选中该按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:08:53.973

`if`声明还有一个`else`案例

```
if (condition met) {
    uncheck the toggle button 
} else {
    ButtonClick(1);   
    BeginOPHandler(Ep, null);
} 
```

# batch-file - 批处理文件：运行匹配子字符串的程序

> ID：10253470
> 
> 赞同：0
> 
> 时间：2012-04-20T20:58:47.163
> 
> 标签：batch-file, cmd, exe

我正在编写一个静默安装程序的批处理脚本，我遇到的问题是每个安装程序的exe文件在文件名后面都有一个版本号，所以（7zip v9.20.exe）。

我需要编写一个批处理脚本，该脚本将在文件夹中搜索文件，而不管版本号如何，因此只匹配文件中的 7zip，然后执行该文件以运行静默安装。

我有静默安装的部分，只是我需要一种在文件夹中搜索 7zip 的方法，没有版本号，然后运行该 exe。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T16:26:30.843

如果“7zip *.exe”文件位于任何 %PATH% 文件夹中：

```
for %%f in ("7zip *.exe") do set filename="%%~$PATH:f"
rem To execute the filename:
%filename% parameters ... 
```

如果“7zip *.exe”文件不在 %PATH% 中：

```
set baseFolder=C:\path\of\base\folder\for\7zip
for /R %baseFolder% %%f in ("7zip *.exe") do set filename="%%~Ff" 
```

# java - 使用 Haskell 将函数注入 Java .class 文件

> ID：10253474
> 
> 赞同：7
> 
> 时间：2012-04-20T20:59:07.800
> 
> 标签：java, haskell, code-injection, bytecode

我使用 Haskell 编写了一个 Java 字节码解析器，它工作得很好。然而，下一步让我完全难住了。

我的 Haskell 程序需要修改 .class 文件，以便在执行时 Java 程序打印：

“ *Entering [method name here]* ” 在执行方法之前，以及

“ *Exiting [method name here]* ”在执行一个方法后。

我所知道的是，我们需要在常量池和方法表中附加对 的调用`System.out.println`，但我觉得我仍然缺少一些东西。

*   解决这个问题的最佳方法是什么？
*   你怎么知道如何调用`System.out.println`字节码？
*   您如何存储带有方法名称的字符串，以便稍后作为 的参数调用`System.out.println`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:03:41.247

可能最简单的方法是编写一个 Java 类，它有一个带有`System.out.println()`代码的方法，编译它`javac`并观察结果。

熟悉之后，一步一步来。

1.  `System.out.println()`在要检测的 java 文件中的某处添加调用。这会处理常量池。编写查找相关常量并注入字节码的 Haskell 代码。
2.  从 java 文件中删除“拐杖”调用并在 Haskell 中实现常量池操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:11:49.920

嗯，这就是各种字节码工程库给你的。ASM、BCEL 等。你的作业的细节是一个*方面*，而 AspectJ 正是这样做的。

听起来家庭作业是写一个 Haskell 字节码工程练习，所以你需要自己修改类文件。@biziclop 上面的建议是正确的。在类文件上做之前和之后，注意增量，并在 Haskell 中自己做同样的事情。

[ps：当然，上面的“捷径” :P 是如果您不想阅读 JVM 规范（如对您的 q 的评论中所指出的那样）并弄清楚如何去做，就像编写一个Java 编译器。您基本上通过使用各种字节码之一进行调用来调用方法——这里是接口方法调用——在此之前，您需要有接收者，例如 System 类之外的静态字段和堆栈上的方法名称。规格中的详细信息。]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T21:24:08.247

只需获取您的 Java 字节码列表并弹出一个简单的编译类，并调用 System.out.println() 并查看一下。为您需要的任何方法执行此操作。找出这一点的最佳方法是使用一些简单的代码文件进行一些调查，并在进行过程中进行逆向工程。您必须将所需的消息翻译成 unicode 并将其传递给您的函数。也不要忘记那部分。有各种程序可以帮助您征服字节码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T06:15:26.413

我认为解决这个问题的最好方法是使用`Javassist`库（[Java Programming Assistant](http://www.csg.ci.i.u-tokyo.ac.jp/~chiba/javassist/)）。 `Javassist.bytecode`类有一些可能有用的功能。

# api - 带有 /products 和 /myproducts 的 RESTful api

> ID：10253477
> 
> 赞同：1
> 
> 时间：2012-04-20T20:59:35.187
> 
> 标签：api, rest

我正在建立一个用户可以销售产品的网站。我从一个 RESTful api 开始，到目前为止我有：

```
/Product (Accepts, post)
/Product/[product_id] (Accepts, get, put, delete) 
```

我还想为所有用户列出所有产品，所以我正在考虑：

```
/Products (Accepts, get) 
```

这是我的问题，我也希望用户查看自己的产品，所以我也在考虑：

```
/MyProducts (Accepts, get) 
```

我只是认为拥有 /Products 和 /MyProducts 是一样的，除了它们是在用户身上过滤的，那么我应该使用什么方法来做到这一点？

我已经考虑过以下问题，但不知道这是否令人不悦：

```
/Products (Accepts, get) <- returns all products
/Products/[user_id] (Accepts, get) <- returns all products for a user id. 
```

非常欢迎任何帮助、指点或指导！

谢谢

克里斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T01:07:08.510

大大简化。您实际上只需要两种资源：

*   代表产品集合的东西，URI：`/products`
*   代表单个产品的东西，URI：`/products/{id}`

只需这两种资源即可满足您的所有需求：

*   要查看系统中的每个产品：`GET /products`
*   仅查看您自己的产品：`GET /products?showOnlyMine=true`
*   创建一个新产品：`POST /products`返回`Location`一个`/products/{id}`
*   查看单个产品：`GET /products/{id}`

当然，您可以随意使用与 不同的 URI 参数`showOnlyMine`。

# ios - 战舰游戏IOS概念设计

> ID：10253479
> 
> 赞同：3
> 
> 时间：2012-04-20T20:59:47.880
> 
> 标签：ios, conceptual

好的，这是第一次菜鸟问题，如果那是愚蠢的，对不起。

我只是想知道，对于战舰类型的游戏，为每个单元格（10X10 = 100）构建一组对象，位置（x，y）和状态（空，命中，未命中）是否会浪费内存特性？

我想知道是否最好只创建一个对象 Grid 并在必要时使用方法来计算单元格位置（例如，在使用触摸或绘图处理单元格选择时）..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:06:09.297

前者是有问题的，因为您可能拥有并排或端到端的船只，并且仅从您描述的数据结构中就很难知道何时完全摧毁了。并排的两次撞击可能是同一艘船的两次撞击，两艘不同的船的两次撞击，甚至是最小的船的沉没。

为了理智，选择后者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:07:01.460

如果我这样做，我会保持简单，有一个二维数组，那就是你的 10 x 10 网格。

当有人转弯时，计算位置；

如果未命中，则在该数组单元中插入 0 如果命中，则在该数组单元中插入 1

# android - ImageView 下的 TextView，文字减少

> ID：10253480
> 
> 赞同：-4
> 
> 时间：2012-04-20T20:59:50.737
> 
> 标签：android, textview, imageview

我可以用文字产生这种效果吗？

图片
文字

原文是：“图像描述”，我会想象“图像描述......”

有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:23:50.077

如果您为 TextView 设置[android:ellipsize="end"](http://developer.android.com/reference/android/widget/TextView.html#attr_android%3aellipsize)则 text longs 文本将在最后用点缩短。

“图像描述”->“图像描述...”

# mysql - “总锁数超过锁表大小”删除267条记录

> ID：10253482
> 
> 赞同：12
> 
> 时间：2012-04-20T20:59:56.007
> 
> 标签：mysql, locking, innodb, sql-delete

我正在尝试从大约 4000 万条记录中删除 267 条记录。查询如下所示：

```
delete from pricedata
where
pricedate > '20120413' 
```

pricedate 是一个`char(8)`字段。

我知道调整`innodb_buffer_pool_size`，但如果我能做到

```
select from pricedata
where
pricedate > '20120413' 
```

并获得 267 条记录（仅此而已），没有错误，为什么它会在删除时阻塞？

如果调整`innodb_buffer_pool_size`不起作用，我该怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T21:24:55.983

似乎您没有索引`pricedate`（或`MySQL`由于某种原因不使用此索引）。

使用`REPEATABLE READ`（默认事务隔离级别），`InnoDB`将共享锁放在查询读取和过滤掉的记录上，看起来您没有足够的空间用于`40M`锁。

要解决此问题，请使用以下任一解决方案：

1.  `pricedate`如果不存在则创建索引（可能需要时间）

2.  将您的查询分成更小的块：

    ```
    DELETE
    FROM    pricedata
    WHERE   pricedate > '20120413'
            AND id BETWEEN 1 AND 1000000

    DELETE
    FROM    pricedata
    WHERE   pricedate > '20120413'
            AND id BETWEEN 1000001 AND 2000000 
    ```

    等（根据需要更改`id`范围）。请注意，每个语句都应该在自己的事务中运行（如果关闭，不要忘记在每个语句之后提交`AUTOCOMMIT`）。

3.  使用事务隔离级别运行`DELETE`查询。`READ COMMITTED`读取记录后，它将`InnoDB`立即从记录中生成提升锁。如果您在语句模式下使用二进制日志并且不允许二进制日志不安全查询（这是默认设置），这将不起作用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-05-20T05:54:14.303

（一个迟到的答案，但是当人们在谷歌中发现这个问题时总是很高兴）

无需更改 innodb_buffer_pool_size 或创建索引的解决方案可以是限制要删除的行数。

因此，以您`DELETE from pricedata where pricedata > '20120413' limit 100;`为例。这将删除 100 行并留下 167 行。因此，您可以再次运行相同的查询并删除另外 100 个。对于最后的 67 个，这很棘手......当数据库中剩余的行数小于给定的限制时，您将再次出现关于数量的错误锁。可能是因为服务器会搜索更多匹配的行来填充到 100。在这种情况下，使用`limit 67`删除最后一部分。（当然你也可以`limit 267`在一开始就使用）

对于那些喜欢编写脚本的人......我在 bash 脚本中用来清理旧数据的一个很好的例子：

```
 # Count the number of rows left to be deleted
   QUERY="select count(*) from pricedata where pricedata > '20120413';"
   AMOUNT=`${MYSQL} -u ${MYSQL_USER} -p${MYSQL_PWD} -e "${QUERY}" ${DB} | tail -1`
   ERROR=0
   while [ ${AMOUNT} -gt 0 -a ${ERROR} -eq 0 ]
   do
      ${LOGGER} "   ${AMOUNT} rows left to delete"
      if [ ${AMOUNT} -lt 1000 ]
      then
         LIMIT=${AMOUNT}
      else
         LIMIT=1000
      fi
      QUERY="delete low_priority from pricedata where pricedata > '20120413' limit ${LIMIT};"
      ${MYSQL} -u ${MYSQL_USER} -p${MYSQL_PWD} -e "${QUERY}" ${DB}
      STATUS=$?
      if [ ${STATUS} -ne 0 ]
      then
         ${LOGGER} "Cleanup failed for ${TABLE}"
         ERROR=1
      fi
      QUERY="select count(*) from pricedata where pricedata > '20120413';"
      AMOUNT=`${MYSQL} -u ${MYSQL_USER} -p${MYSQL_PWD} -e "${QUERY}" ${DB} | tail -1`
   done 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-21T21:24:28.327

什么有效：将 innodb_buffer_pool_size 更改为 256M（参见 Quassnoi 原始评论下的评论）。

# ruby-on-rails - 无法通过公共 IP 访问 EC2 实例上的站点

> ID：10253484
> 
> 赞同：72
> 
> 时间：2012-04-20T21:00:25.290
> 
> 标签：ruby-on-rails, nginx, amazon-ec2

我已经用 EC2 进行了几天的试验，并且一直在努力抵抗甚至能够访问我托管的示例站点。堆栈是带有 Thin 和 Nginx 的 Rails 3.1.3。

我尝试了几种不同的配置，最后运行了 Nginx 自动安装脚本，当我执行 curl [http://ec2-107-20-143-179.compute-1.amazonaws.com/](http://ec2-107-20-143-179.compute-1.amazonaws.com/)时它会返回一个网页. 但是，当我将浏览器指向那里时，它会永远挂起，然后说找不到页面。

我已经分配了一个弹性 IP 地址，并且我已经通过端口 80 启用了 HTTP 访问。

我在系统管理员方面没有太多经验，在这一点上我基本上被难住了。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-04-20T21:07:02.660

您是否为所有 ip 启用了 http 端口？这将通过以下方式完成：

EC2 -> 安全组 -> 默认（或您的客户） -> 入站

然后为 HTTP 创建一个新规则，作为源，您应该分配：0.0.0.0/0

那应该这样做。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2014-12-03T13:21:41.933

认为 AWS UI 可能已经更新，但基于 Deleteman 的回答

*   登录 EC2 仪表板
*   实例 > 实例
*   操作下拉菜单 > 网络 > 更改安全组
*   您可能会看到您只允许启动向导 1 对我来说只允许端口 22 上的 SSH 访问

因此，正如 Deleteman 所提到的，您可能需要更改您的安全组......

*   登录 EC2 仪表板
*   网络和安全 > 安全组
*   删除可能在搜索框中的所有过滤器以显示所有组
*   我个人编辑了默认的 VPC 安全组，因为这对我来说是一个沙箱，我想你会想为你的项目创建一个安全组
*   选中安全组复选框，选择操作下拉菜单并单击“编辑入站规则”，我使用以下入站规则以确保一切正常

![规则](../Images/941fbc899da7c4b2067d29ba079ceefa.png)

*   当您重新访问 Instances > Instances > Description 时，您应该会看到安全组和规则

![在此处输入图像描述](../Images/9e165811fd0286a97733d8b29292a489.png)

*   一旦你对它的工作感到满意，我可能会用 HTTP 和 HTTPS 替换所有流量，如果这就是所有需要的话

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-07-20T00:16:07.640

我早些时候在这里寻找解决我遇到的类似问题的方法。在我的案例中，除了 EC2 安全组之外，EC2 实例还运行了自己的防火墙。命令'system-config-firewall'让我可以打开端口。默认情况下未打开端口 80 (HTTP) 和 3306 (MySQL)。22 (SSH) 已打开。我还必须执行“yum install system-config-firewall”。

总而言之，我的解决方案是：

```
> yum install system-config-firewall
> system-config-firewall 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2013-05-07T16:39:08.600

这个答案适用于不知道他们在用 ec2 实例做什么的新手。

我遇到了同样的问题，并尝试了所有安全组修复无济于事。

事实证明，我需要从命令行打开我的服务器。

```
sudo service httpd start 
```

有时它很黑，不是因为保险丝熔断，而是因为你没有轻按开关。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-04-13T10:58:42.763

我也在努力解决同样的问题，也创建了安全组，但没有应用于实例。只需为 http 创建新规则。并从右键单击实例应用并选择安全组并分配它。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2021-05-12T13:10:16.120

我在使用 ubuntu EC2 实例时多次遇到同样的问题，在这里我添加了所有帮助我在不同情况下解决问题的方法。

1.  确保您正在从浏览器访问“公共 IPv4 DNS”或“公共 IPv4 地址”或“弹性 IP 地址”。

[![Step1 截图](../Images/da6f8f9ed4160a6af5925a6904c52a4d.png)](https://i.stack.imgur.com/j4Dm1.png)

2.  检查80端口是否打开。 [![Step2 80端口未开放](../Images/a7aa45dc198054793cebbd5b1e625e37.png)](https://i.stack.imgur.com/NTBmA.png) 在这里可以看到**Inbound rules**中没有打开 80 端口。所以我们先打开80端口。为此，单击**安全**选项卡，您可以看到**安全组**打开这个新选项卡 [![安全组](../Images/a542c837d1dea9995b1ca15968715e58.png)](https://i.stack.imgur.com/QGDt7.png) 现在您必须编辑入站规则。 [![编辑入站规则](../Images/ab45635b5b93d9fd6ea7461ac3ed0aee.png)](https://i.stack.imgur.com/zmyhl.png) 单击**添加规则** 然后选择类型**HTTP**和源**AnyWhere**并保存。 [![在此处输入图像描述](../Images/a004a8572a4d660258177601f5b5eb6e.png)](https://i.stack.imgur.com/pUhPx.png) 同样，您也使用 HTTPS。

3.  如果 HTTPS 未启用，请检查浏览器 URL，如果我们尝试从浏览器默认访问，它可能是 HTTPS，如果是，请将其设为 HTTP 并重试。

4.  编辑网络 ACL。选择**网络**选项卡并在新窗口中 打开**子网 ID 。**[![网络选项卡和子网 ID](../Images/a6d8c6b36eae4e49a32650edd304f2b3.png)](https://i.stack.imgur.com/EQhq0.png)

[![打开的子网 ID](../Images/f6000e4eebf6aa72d7083941c1d99d45.png)](https://i.stack.imgur.com/E0SdJ.png) 从 Subent Id在新窗口中 打开**Network ACL现在编辑入站规则。**[![编辑入站规则 100](../Images/e1e93a912b5be424fbd80c1d6ef8bbe0.png)](https://i.stack.imgur.com/0yAEX.png) [![规则 100 应如下所示，即 type==](../Images/a2c08077306aecff93c491d06a5cb006.png)](https://i.stack.imgur.com/O5zG1.png)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2021-07-11T03:42:03.400

对我来说，这就像在我的浏览器上将url 从`https://my-site`更改为一样简单。`http://my-site`（此解决方案仅适用于仍然能够通过 SSH 连接到 ec2 实例但无法通过浏览器连接的人）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-11-27T04:16:01.097

Octopus 的答案对我来说是正确的，但 Windows 机器除外。我需要去 Windows 防火墙，如果它不匹配规则，它会阻止所有来自 VM 的流量。规则中没有启用端口 80，所以我只需要添加一个。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-12-08T16:29:11.447

Very stupid of me as I forgot to install **web server** (HTTP server) because of which my ec2 instance public IP was not working. Answering this question as this can also be one of the reason which one should not miss as I did.

You can install either,

**nginx:**

```
sudo apt-get install nginx 
```

**apache2:**

```
sudo apt-get install apache2 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-03-15T06:24:55.807

我的问题是浏览器。

铬作品；火狐不工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-01-08T13:57:15.277

最好的方法是编辑您的安全入站规则。请参考下面的快照。

[![在此处输入图像描述](../Images/f658cf2a06dafa4ad7dea1d75d6c3fc2.png)](https://i.stack.imgur.com/1Olps.png)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-21T10:34:05.717

以下是您可以遵循的步骤，当您检查这两个步骤时，它们很可能肯定会起作用。

1.  确保您在浏览器中使用 http:// 而不是在 IP 和亚马逊 IPV4 公共 DNS 上使用 https://（它以某种形式出现，例如`http://ec2-some-ip-address-here.region.compute.amazonaws.com`）

2.  单击`instance id`并向下滚动，

`go to the security tab`,

```
click on security group it will look like this [![enter image description here][1]][1]

Click on edit inbound rules 
```

添加这个

```
For type- choose HTTP
Source - choose anywhere or anywhere ipv4 
```

然后点击保存就完成了。

这两者的结合应该可以正常工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-06-25T18:31:13.600

我有同样的问题，因为我没有使用 Ubuntu 或 linux 的经验，所以我的大脑很糟糕。Parag 的回答修复了它。

我很愚蠢，因为我忘记安装 Web 服务器（HTTP 服务器），因为我的 ec2 实例公共 IP 无法正常工作。回答这个问题也可能是我不应该错过的原因之一。

你可以安装，

nginx：

```
sudo apt-get install nginx 
```

阿帕奇2：

```
sudo apt-get install apache2 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-05-19T16:53:24.773

我知道这是一个非常古老的线程，但最近在许多服务中都遇到了这个问题。当您在端口示例 3000 上运行任何应用程序服务器（如 Puma 或 Unicorn）时，没有负载均衡器或像 Nginx 前端这样的代理。您必须遵循两个步骤：

1.  将服务绑定到 0.0.0.0/3000 而不是 127.0.0.1/3000。（这将使您的服务保持开放并可供互联网上的任何人访问，即第 2 步出现）。
2.  如果您希望任何人通过 Internet 访问或添加 VPN 或您的网络 IP 以仅允许您和您的团队使用，则在 AWS 安全组中现在允许 0.0.0.0 的端口 3000。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-06-26T22:09:48.147

当我尝试在 EC2 上运行我的 go 应用程序时，我遇到了非常相似的情况。如果您在浏览器上看不到适当的消息或结果，即使您：

*   可以很好地使用`curl`,
*   完成正确配置安全组
    *   为世界或您的 IP 地址打开 80、443 的笔入站流量和
    *   开放入站流量 22；和
    *   打开您使用的端口的入站流量（如 8080、4343 等）），以及；
*   运行您的应用程序以接受来自外部的连接（`npm app.js`等`go run .`）

**确保您输入了`http://ec2-...`，而不是`https://ec2-...`在您的浏览器上。**`https://`即使您打开 443 端口，您也无法连接到服务器，除非您已经配置了 ssh 证书。输入带有协议的完整地址`http`，不要省略它，可能会解决问题。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2021-08-04T12:02:50.370

当我尝试从浏览器访问公共 IP 时，无法访问我的 Windows Ec2 实例。在检查完以上所有内容后，我不得不更新阻止传入流量的 Windows (Defender) 防火墙设置。

# asp.net - ActionLink 或 BeginForm Submit 中不弹出 AjaxOptions.confirm

> ID：10253487
> 
> 赞同：1
> 
> 时间：2012-04-20T21:00:34.780
> 
> 标签：asp.net, asp.net-mvc-3

对此新手，如果我在另一个答案的某个地方错过了这个，请耐心等待。我尝试在 Ajax.BeginForm 中使用 AjaxOptions 并且它没有弹出，所以我转而在 ActionLink 中对其进行测试，但仍然无法让它工作。对于 ajax.beginform 和 ajax.actionlink，它会转到正确的控制器并正常运行，但我没有收到确认消息。

我究竟做错了什么？

谢谢，克

从视图：

```
<script type="text/javascript" src="/Scripts/jquery.unobtrusive-ajax.min.js"></script>

@Ajax.ActionLink(
"Revoke Access to all Galleries Immediately", 
"ViewInvites", 
"Gallery", 
new AjaxOptions { 
    Confirm = "Are you sure you want to revoke access to all galleries? This cannot be undone.",
    HttpMethod = "Post"
}
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T21:34:06.343

确保脚本标签实际上指向正确的脚本。您可能需要指定相对路径。

```
 <script src="../Scripts/jquery.unobtrusive-ajax.min.js" type="text/javascript" ></script> 
```

Firebug 有助于发现这是否是问题所在。

# php - php zend gdata - 使用 oauth 获取 google 文档列表

> ID：10253490
> 
> 赞同：1
> 
> 时间：2012-04-20T21:01:16.573
> 
> 标签：php, zend-framework, oauth, google-api, gdata

我已经使用我以这种方式设置的有效令牌进行了会话：

```
$session_token = Zend_Gdata_AuthSub::getAuthSubSessionToken($_GET['token']);
// Store the session token in our session.
$_SESSION['cal_token'] = $session_token; 
```

然后我希望能够做到这一点：

```
$service = Zend_Gdata_Docs::AUTH_SERVICE_NAME;
$client = Zend_Gdata_ClientLogin::getHttpClient($user, $pass, $service);
$docs = new Zend_Gdata_Docs($client);
$feed = $docs->getDocumentListFeed(); 
```

但是使用令牌。而不是使用用户/通行证/服务进行身份验证

我已经看过一些例子，但我没有找到任何方法让它工作。

谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T18:26:06.967

```
 // Retrieve user's list of Google Docs
    $client = Zend_Gdata_AuthSub::getHttpClient($_SESSION['cal_token']);
    $docs = new Zend_Gdata_Docs($client);
    $feed = $docs->getDocumentListFeed();
    foreach ($feed->entries as $entry) {
      echo "$entry->title\n";
    } 
```

# android - 如何将会话 ID 返回给通过 JSON 进行身份验证的移动用户？

> ID：10253493
> 
> 赞同：0
> 
> 时间：2012-04-20T21:01:26.463
> 
> 标签：android, asp.net-mvc-3, asp.net-membership

应用宿主：MVC3 和 SQL Server 移动平台：Android

请告诉我这是否是完全错误的方法。我正在设想通过 HTTP Post 事件进行某种身份验证过程。结果（如果成功）是返回的会话 ID，因此用户可以调用其他安全方法。

注意：控制器、数据库和 JSON 响应今天已经以非安全方式工作。我只需要添加安全性。

如果已经有这方面的流程，请告诉我。我不想重新发明轮子。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:17:22.257

只需使用 AspNet FormsAuthentication。将提供一个加密的 cookie。与 HTTPS 一起使用的是可靠的安全基础身份验证。

# jquery - 咖啡脚本胖箭头访问不是父级'this'

> ID：10253494
> 
> 赞同：7
> 
> 时间：2012-04-20T21:01:31.623
> 
> 标签：jquery, coffeescript, arrow-functions

这很好用

```
 @nav.on 'click', ->
        _this.mover _this.nav.index $(@) 
```

但我想知道我是否可以像这样使用胖箭头

```
 @nav.on 'click', =>
        @mover @nav.index $(????) 
```

但是我会用什么代替`@`它，`this`而不是`_this`？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-20T21:38:36.410

jQuery 事件处理程序获取一个事件对象作为参数，并且该事件对象具有[`target`](http://api.jquery.com/event.target/)和[`currentTarget`](http://api.jquery.com/event.currentTarget/)属性：

```
@nav.on 'click', (ev) =>
    @mover @nav.index $(ev.currentTarget) 
```

根据您的具体情况，您可能需要[其他属性之一。`ev`](http://api.jquery.com/category/events/event-object/)

# javascript - 无法在 Liferay Portlet JSP 页面中包含 css 和 JS 文件

> ID：10253495
> 
> 赞同：7
> 
> 时间：2012-04-20T21:01:31.893
> 
> 标签：javascript, liferay, portlet

我已经下载了一个 Jquery Image Slider 源并想与我的 JSP 文件集成

这是我的文件夹结构

![在此处输入图像描述](../Images/ab5c893ca6032ffab1067d9a45f130a1.png)

这就是我包括他们的方式

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<link type="text/css" href="/css/jquery.ui.theme.css" rel="stylesheet" />
<link type="text/css" href="/css/jquery.ui.core.css" rel="stylesheet" />
<link type="text/css" href="/css/jquery.ui.slider.css" rel="stylesheet" />
<link rel="stylesheet" href="/css/style.css" type="text/css" media="screen"/> 
```

我在服务器控制台中得到这个 404

```
20:50:04,625 WARN [404_jsp:109] /css/jquery.ui.theme.css
20:50:04,640 WARN [404_jsp:109] /css/jquery.ui.core.css
20:50:04,640 WARN [404_jsp:109] /css/jquery.ui.slider.css
20:50:04,656 WARN [404_jsp:109] /css/style.css
20:50:04,671 WARN [404_jsp:109] /js/cufon-yui.js
20:50:04,671 WARN [404_jsp:109] /js/GreyscaleBasic.font.js
20:50:04,687 WARN [404_jsp:109] /js/jquery.easing.1.3.js 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-22T19:47:47.773

把链接放进去`liferay-portlet.xml`，让 Liferay 加载 css 和 javascript。这是更好的方法（例如，如果用户想要将两个 portlet 放在一个页面上）。

liferay-portlet.xml：

```
<header-portlet-css>/css/main.css</header-portlet-css>
<footer-portlet-javascript>/js/main.js</footer-portlet-javascript> 
```

奥拉夫是对的，您必须将 css- 和 js- 文件夹（以及图像）从一个文件夹移动`WEB-INF`到另一个文件`docroot`夹

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-21T07:38:57.183

几个问题：

*   如果我在您发布的缩略图中正确看到了这一点，那么您的 css 和 js 文件夹位于 WEB-INF 中：任何浏览器都无法请求 WEB-INF 中的任何内容，因此您永远无法获得它。
*   如果您创建 docroot/css 和 docroot/js，您仍然会得到 404，因为您无法在 /css/style.css 上找到文件，但在 /your-portlet/css/style.css 中 - 通用方式在jsps中解决它是

    ```
    < link rel="stylesheet" href="<%=request.getContextPath()%>/css/style.css"/> 
    ```

后期编辑：`request`在 portlet 的 JSP 上并不总是有效，因为根据 JSP 规范，它是一个 HttpServletRequest。在门户世界中，这通常与您的 portlet 的当前路径无关。因此，我建议使用 Mark 的答案而不是我的答案：liferay-portlet.xml 包含与当前 portlet 相关的文件。从 Liferay 7.0 开始，您可以使用与 liferay-portlet.xml 等效的 OSGi 组件。

# git - 怎么说这是我在 github

> ID：10253497
> 
> 赞同：5
> 
> 时间：2012-04-20T21:01:33.453
> 
> 标签：git, github

我在设置 GitHub 信息时犯了一个错误，所以当我推送到存储库 X 时，出现的名字不是我的名字。我该如何解决它并说那是我？有什么办法吗？

在 BitBucket 中，repo 管理页面中有一个名为“用户名别名”的选项。

注意：我是存储库 X 中的管理员。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T21:36:44.063

通常，表明您有一些使用错误电子邮件地址的提交并希望为将来查看历史记录的人更正的方法是使用该`.mailmap`文件。这记录在[`git shortlog`](http://schacon.github.com/git/git-shortlog.html)手册页中。为了使用它，每一行都应该以您的正确姓名和地址开头，然后继续使用您希望映射到该正确姓名和地址的历史记录中出现的任何姓名/地址组合。例如：

```
Mhd Aljobory <aljobory@example.com> Wrong Name <example@laptop.(none)> 
```

我不知道 GitHub 是否支持通过 mailmap 进行翻译，但这是各种 Git 工具用于解决此问题的标准方式。

# ruby-on-rails-3 - 在 Arel 中加入分组依据的子查询？

> ID：10253499
> 
> 赞同：0
> 
> 时间：2012-04-20T21:01:53.400
> 
> 标签：ruby-on-rails-3, activerecord, arel

我在这里搜索了很多，但找不到类似的主题：我需要在 Arel 中编写一个查询，因为我使用 will_paginate 来浏览结果，所以我在使用原始 SQL 实现时会感到很舒服。

这是我需要用 Arel 拼写的内容：

```
SELECT m.*
 FROM   messages m
 JOIN  (SELECT tmp.original_id as original_id,
               max(tmp.id) as id
        FROM   messages tmp
        WHERE  tmp.recipient_id = ?
        GROUP BY tmp.original_id) g ON (m.id = g.id)
 ORDER BY m.updated_at DESC; 
```

简而言之：子查询检索用户的所有消息。如果一条消息有较新的回复（在回复中，我将引用消息 id 保存为 original_id），旧的将被忽略。对于所有这些消息的结果，我希望 Rails 向我提供相应的对象。

我在 SQL 方面非常熟练，但不幸的是 Arel 不熟练。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T10:47:45.293

这样的事情怎么样？

```
class Message < ActiveRecord::Base
  scope :newer_messages lambda { |num_days=10| where("updated_at > #{Time.now} - #{num_days}.days") }
end 
```

然后，您可以为给定用户找到更新的消息，如下所示：

```
Message.find_by_user_id(user_id).newer_messages 
```

# c# - 如何在C#中弹出一个文本文件

> ID：10253500
> 
> 赞同：-2
> 
> 时间：2012-04-20T21:02:04.943
> 
> 标签：c#, winforms

这个小程序展示了如何打开硬盘上的 txt 文件，有没有一种方法可以让我有一个程序，当我单击一个按钮时会弹出一个 txt 文件，有人可以帮助我或者我可以如何去做。 ...

这是下面的过程

```
private void button1_Click(object sender, EventArgs e)
{
    OpenFileDialog of = new OpenFileDialog();
    of.ShowDialog();
    textBox1.Text = of.FileName;
} 
```

有人可以告诉我我能做什么或提供一些材料来阅读 C# 中的新内容

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T21:14:28.317

假设您喜欢打开记事本并显示文本文件，您可以使用：

```
System.Diagnostics.Process.Start(of.FileName); 
```

这将使用计算机的默认文本编辑器打开文件。

**编辑**

根据您的评论，您应该这样做：

```
private void button1_Click(object sender, EventArgs e)
{
    System.Diagnostics.Process.Start(@"C:\dir1\dir2\yourfile.txt");
} 
```

显然，您应该将其替换为特定文件的路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T21:04:29.233

尝试

```
MessageBox.Show(File.ReadAllText(of.FileName)); 
```

在它之后，尝试学习语句的每个组成部分，它的作用。

顺便提一句，

您还需要：

```
if (of.ShowDialog() == DialogResult.OK) 
```

在此之前，以避免在用户单击取消时显示消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T21:19:00.173

根据澄清，这非常简单。只需创建一个包含文本框（可能还有关闭按钮）的新表单类。您需要在表单上设置一个属性来设置文本框。您可以从按钮事件处理程序（您在示例中使用的那个）启动此表单，如下所示：

```
using(var myForm = new TextBoxForm()) {
    myForm.TextFileContents = <file contents>
    myForm.ShowDialog();
} 
```

至于读取文件内容，您需要`File.ReadAllText()`按照丹尼尔的回答中的描述使用。有关更多信息，请参阅 MSDN 文档。我将把剩下的细节留给读者作为练习。

# c# - 重定向后 Cookie 对服务器不可用

> ID：10253502
> 
> 赞同：1
> 
> 时间：2012-04-20T21:02:15.843
> 
> 标签：c#, javascript, cookies, web

我正在尝试在我的浏览器中设置一个 Cookie，只是为了确保我在此之后提醒 cookie 的值并且它确实有一个 cookie。之后，我将我的位置重定向到谷歌，谷歌通过身份验证后，控制权转到服务器。

现在服务器在这个特定请求中没有值。但奇怪的是，服务器在所有后续请求中都有一个 cookie 值。

这是一些客户端代码：

```
cookies.SetCookie('CampaignToken', data.CampaignToken, '12/06/2013 00:00:00', '/');
                    alert(cookies.GetCookie('CampaignToken').toString());
                    window.location = data.GoogleRequestURL; 
```

这是一些服务器代码，在控制权从谷歌返回后执行：

```
 if (Request.Cookies["CampaignToken"] != null)
            {
                var cookie = Request.Cookies["CampaignToken"].Value;
                Response.Cookies.Remove("CampaignToken");

                return Redirect(Request.Url + "/" + cookie);
            } 
```

这里需要注意的是 Request.Cookies["CampaignToken"] 第一次返回 null ，然后返回 cookie 的值。此外，当我在访问 Google 之前对客户端发出警报时，cookie 具有价值。

# objective-c - 这增加了保留计数：alloc 还是 init？

> ID：10253505
> 
> 赞同：4
> 
> 时间：2012-04-20T21:02:27.440
> 
> 标签：objective-c, init, retaincount, alloc

当我们需要创建一个对象并获得它的所有权时，我们编写

```
NSObject *someObject = [[NSObject alloc] init]; 
```

之后，`someObject`保留计数将等于 1。哪种方法会增加计数，`alloc`或者`init`，以及 Apple 文档中的何处描述了这种行为？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-20T22:18:11.827

> 之后 someObject 的 retainCounter 将等于 1。问题是哪种方法增加了 retainCounter alloc 或 init 并且在 Apple 文档中描述了这种行为？

“两者都不是”、“两者”或“一个或另一个”都是正确的答案。更好的答案是“这是一个实现细节，您需要关注一般的、非实现依赖的规则”。

首先，抛弃绝对保留计数的概念。这是一种无用的思考方式。

`+alloc`返回一个具有 +1 保留计数的对象。返回的任何东西都`+alloc`必须在`-release`某个地方。实际保留计数是否为 1 完全是一个实现细节，对于 Apple 的许多类而言，它通常*不是*1。

`-init`消耗消息对象的保留计数并产生保留计数 +1 的对象（不是 1，而是“加 1”）；返回的结果`init`必须是`release`d 才能正确管理。

通常情况下，`init`只是简单地调用`return self;`而不在内部操作保留计数。这保留了上述规则。

但有时它不会，这就是为什么你总是必须`self = [super init]`在你的初始化程序中有（当然是检查返回值），*以及*为什么你永远不应该做类似`Foo *f = [Foo alloc]; [f init];`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-20T21:05:53.397

该`alloc`方法执行实际分配，因此通常*会增加保留计数。`init`负责在分配后初始化对象。

*[在几个基础类以及第 3 方代码（例如类集群）中存在例外情况，但您始终负责在手动内存管理中调用`release`/`autorelease`之后调用`alloc`]

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-20T21:17:32.227

嗯，所以有点复杂。对于几乎所有情况，`+alloc`增加保留计数，并且对保留计数`-init`不做任何事情。

但偶尔，`-init`会希望返回一个预先存在的对象而不是初始化`alloc`传递给它的空白对象。（`NSNumber`例如，这样做。）在这种情况下，`-init`将 release `self`，然后返回一个具有 +1 保留计数的新对象。

在 ARC 文档中，他们说这`-init`是一种“消耗”其接收者并返回保留对象的方法。通常，这只是意味着 init 对保留计数没有任何作用。但有时，`-init`其实是在做一些保留。

## 如果这让您感到困惑，请不要担心。

正如我所说，`+alloc`是做保留的人。`-init`保证返回一个保留的对象，但在大多数情况下，它本身不做任何保留。

# android - ExpandableListView -UnsupportedOperationException：AdapterView 不支持 addView(View, LayoutParams)

> ID：10253506
> 
> 赞同：59
> 
> 时间：2012-04-20T21:02:33.403
> 
> 标签：android, expandablelistview, android-adapterview

我正在 android 中实现 Expandable List 视图，我得到了上述标题错误。请帮我。

主要活动是——

```
package com.expand;

import android.app.Activity;
import android.os.Bundle;
import android.util.DisplayMetrics;
import android.util.Log;
import android.view.View;
import android.widget.ExpandableListView;
import android.widget.Toast;

public class MyExpandableListViewActivity extends Activity {
    /** Called when the activity is first created. */

    static final String groupElements[]= {
           "India",
           "Australia",
           "England",
           "South Africa"
         };

    static final String[][] childElements=
    {
           {
          "Sachin Tendulkar",
          "Raina",
          "Dhoni",
          "Yuvi"
           },
           {
          "Ponting",
          "Adam Gilchrist",
          "Michael Clarke"
           },
           {
          "Andrew Strauss",
          "kevin Peterson",
          "Nasser Hussain"
           },
           {
          "Graeme Smith",
          "AB de villiers",
          "Jacques Kallis"
           }
            };

    DisplayMetrics metrics;
    int width;
    ExpandableListView expandList;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        expandList = (ExpandableListView)findViewById(R.id.expandList1);
        metrics = new DisplayMetrics();

        getWindowManager().getDefaultDisplay().getMetrics(metrics);
        width = metrics.widthPixels;

        //ExpAdapter adapter = new ExpAdapter(MyExpandableListViewActivity.this, groupElements, childElements);

        expandList.setAdapter(new ExpAdapter(MyExpandableListViewActivity.this, groupElements, childElements));
        expandList.setIndicatorBounds(width - GetDipsFromPixel(50), width - GetDipsFromPixel(10));

        expandList.setOnGroupExpandListener(new ExpandableListView.OnGroupExpandListener() {

            @Override
            public void onGroupExpand(int groupPosition) {
                // TODO Auto-generated method stub

                 Log.e("onGroupExpand", "OK");
            }
        });

        expandList.setOnGroupCollapseListener(new ExpandableListView.OnGroupCollapseListener() {

            @Override
            public void onGroupCollapse(int groupPosition) {
                // TODO Auto-generated method stub

                Log.e("onGroupCollapse", "OK");

            }
        });

        expandList.setOnChildClickListener(new ExpandableListView.OnChildClickListener() {

            @Override
            public boolean onChildClick(ExpandableListView parent, View v,
                    int groupPosition, int childPosition, long id) {

                //getting the item that is selected
                //String s = (String) expandList.getItemAtPosition((int) id);

                Toast.makeText(MyExpandableListViewActivity.this, "You have selected :"  , Toast.LENGTH_SHORT).show();

                return false;
            }
        });

    }

    public int GetDipsFromPixel(float pixels)
    {
        // Get the screen's density scale
        final float scale = getResources().getDisplayMetrics().density;
        // Convert the dps to pixels, based on density scale
        return (int) (pixels * scale + 0.5f);
    }

} 
```

ExpAdapter 类是 - 我已经在其他类中实现了适配器并在 mt 主要活动中调用了它

```
package com.expand;

import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseExpandableListAdapter;
import android.widget.TextView;

    public class ExpAdapter extends BaseExpandableListAdapter {

        public Context myContext;
        public String[][] childElements;
        TextView childValues;
        public String[] groupElements;

        public ExpAdapter(Context context, String[] group, String[][] childs)
        {

            this.myContext=context;
            this.groupElements = group;
            this.childElements = childs;

        }

        @Override
        public Object getChild(int groupPosition, int childPosition) {
            // TODO Auto-generated method stub
            return childElements[groupPosition][childPosition];
        }

        @Override
        public long getChildId(int groupPosition, int childPosition) {
            // TODO Auto-generated method stub

            return 0;
        }

        @Override
        public View getChildView(int groupPosition, int childPosition,
                boolean isLastChild, View convertView, ViewGroup parent) {
            // TODO Auto-generated method stub

            if(convertView==null){

                LayoutInflater inflator = (LayoutInflater)myContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                convertView  = inflator.inflate(R.layout.child_rows, parent);

            }
            childValues = (TextView)convertView.findViewById(R.id.rowValues);
            childValues.setText(childElements[groupPosition][childPosition]);

            return convertView;
        }

        @Override
        public int getChildrenCount(int groupPosition) {
            // TODO Auto-generated method stub
            return groupElements[groupPosition].length();
        }

        @Override
        public Object getGroup(int groupPosition) {
            // TODO Auto-generated method stub
            return groupElements[groupPosition];
        }

        @Override
        public int getGroupCount() {
            // TODO Auto-generated method stub
            return groupElements.length;
        }

        @Override
        public long getGroupId(int groupPosition) {
            // TODO Auto-generated method stub
            return 0;
        }

        @Override
        public View getGroupView(int groupPosition, boolean isExpanded,
                View convertView, ViewGroup parent) {
            // TODO Auto-generated method stub

            if(convertView==null){
                LayoutInflater inflator = (LayoutInflater)myContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                convertView = inflator.inflate(R.layout.group_rows, null);
            }
            TextView group = (TextView)convertView.findViewById(R.id.groupId);
            group.setText(groupElements[groupPosition]);

            return convertView;
        }

        @Override
        public boolean hasStableIds() {
            // TODO Auto-generated method stub
            return false;
        }

        @Override
        public boolean isChildSelectable(int groupPosition, int childPosition) {
            // TODO Auto-generated method stub
            return true;
        }

    } 
```

main.xml-

这是主要活动首先显示的 xnl

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

        <ExpandableListView 
            android:id="@+id/expandList1"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            >

                 <TextView 
                android:id="@+id/android:empty"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                >
            </TextView>

        </ExpandableListView>

    </LinearLayout> 
```

group_row.xml

这是组元素的 xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/gropu_name"
        android:layout_width="fill_parent"
        android:layout_height="40dp"
        android:orientation="vertical" >

        <TextView 
            android:id="@+id/groupId"
            android:layout_height="40dp"
            android:layout_width="wrap_content"
            android:paddingLeft="30dp"
            android:gravity="center_vertical"
            android:textSize="16dp"
            android:textStyle="bold"
            />

    </LinearLayout> 
```

child_row.xml 这是子元素的 xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="40dp"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/rowValues"
        android:layout_width="wrap_content"
        android:layout_height="30dp"
        android:gravity="center_vertical"
        android:paddingLeft="50dp"
        android:textSize="12dp" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2012-05-16T00:38:51.907

好像Adapterview不允许添加新视图，我遇到了同样的问题

通过替换以下行来解决它

```
convertView  = inflator.inflate(R.layout.child_rows, parent); 
```

到

```
convertView  = inflator.inflate(R.layout.child_rows, null); 
```

**更新**

而不是根本不使用父级，您应该简单地告诉 Inflater 不要将膨胀的视图附加到父级

```
convertView = inflator.inflate(R.layout.child_rows, parent, false); 
```

另请参阅此[答案](http://stackoverflow.com/a/6419586/484293)。

原因是适配器负责将视图附加到父级本身。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-03-28T14:45:10.007

请注意，当您的布局 xml 无效时，您也会收到此错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-01T06:51:52.267

如上所述，

> 而不是根本不使用父级，您应该简单地告诉 Inflater 不要将膨胀的视图附加到父级

```
 convertView = inflator.inflate(R.layout.child_rows, parent, false); 
```

另请参阅此[答案](http://stackoverflow.com/a/6419586/484293)。

原因是适配器负责将视图附加到父级本身。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-08T15:23:37.290

根据 Android Lint，您的子视图在膨胀时应始终提供对其父视图的引用。我的代码中有完全相同的错误。发生是因为 TextView 被放置在 ExpandableListView 内。当我重新排列我的 xml 布局时，错误停止出现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-29T05:55:30.057

**由于即时运行**功能，也可能导致此错误。我正在使用 listview 并且由于这个错误应用程序不断崩溃。卸载应用程序并再次运行解决了该错误。

# .htaccess - 共享主机上的 symfony2

> ID：10253510
> 
> 赞同：4
> 
> 时间：2012-04-20T21:03:01.403
> 
> 标签：.htaccess, mod-rewrite, symfony, shared-hosting

我已经为此工作了很长一段时间，但无济于事。我在共享的 Web 主机上安装了 symfony，在该主机上我零权限将 DocumentRoot 更改为 web/ 文件夹，所以这不是我的选择...

我已经写了我的 htaccess

```
RewriteEngine On
RewriteBase /
RewriteRule ^$ web/app.php [QSA]
RewriteRule ^(.*)$ web/app.php/$1 [QSA, L] 
```

我也试过这个，`RewriteBase web/`但`RewriteBase /web/`无济于事。

有了这个，symfony 正在工作..我可以登录，我可以做所有这些......唯一的问题是，没有任何资产正在显示...... Chrome 开发人员工具告诉我它正在找到一个正确的 404，因为它是没有将 /web/ 文件夹读取为 DocumentRoot..

那么，如何在不重写文件或其他任何内容的情况下解决此问题.. 必须有一种方法可以仅使用 .htaccess 来解决此问题...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-20T21:21:14.523

一种方法是`assets_base_urls`设置`app/config.yml`例如

```
framework:
    #..
    templating:      
        engines: ['twig']
        assets_base_urls: http://your.site.com/web/ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T19:45:29.753

或者，您可以在 DocumentRoot 文件夹中放置一个 .htaccess 文件，并将其中的所有内容相应地重写到您的 /web 文件夹中：

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ /web/$1 [QSA,L]
</IfModule> 
```

这样您就可以获得干净的 URL（省略“web”或“app.php”），并且无需在配置中使用 assets_base_urls 内容。

# android - android将如何传递MotionEvent ev)

> ID：10253511
> 
> 赞同：0
> 
> 时间：2012-04-20T21:03:07.543
> 
> 标签：android

在我的自定义视图中，我覆盖

```
public boolean onInterceptTouchEvent(MotionEvent ev); 
```

`false`在某个动作事件中返回，

但我想问另一个视图来处理它，我怎样才能将它转发`MotionEvent`给另一个视图？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:07:38.590

从 onInterceptTouch 事件返回 false 将触摸事件传递给 a`ViewGroup`的子级，返回 true 将其保留为`ViewGroup`自身。请参阅[文档](http://developer.android.com/reference/android/view/ViewGroup.html#onInterceptTouchEvent%28android.view.MotionEvent%29)，他们对此的解释非常详细。

# javascript - 检查是否选中了复选框（js/jquery）

> ID：10253512
> 
> 赞同：3
> 
> 时间：2012-04-20T21:03:10.833
> 
> 标签：javascript, jquery, html, checkbox

我想检查是否使用 JavaScript/jQuery 选中了某个复选框。

这是我尝试过的代码：

```
var a;
    if ($("#add_desc").checked == 1){
        a = "true";
    }else{
        a= "false";
    } 
```

我也试过：

```
var a;
    if ($("#add_desc").checked){
        a= "true";
    }else{
        a= "false";
    } 
```

一旦我警告变量，它总是返回 false `a`。

知道为什么它对我不起作用吗？我做错了吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T21:08:02.133

要获取`checked`复选框输入的属性值，请使用`.prop()`方法，或直接从 DOM 元素获取值。`[0]`返回第一个选定的 DOM 元素。

```
var a;
if ($("#add_desc")[0].checked){
    a= "true";
}else{
    a= "false";
} 
```

或者

```
var a;
if ($("#add_desc").prop("checked")){
    a= "true";
}else{
    a= "false";
} 
```

**编辑**
对于早于 1.6 的 jQuery 版本，`.prop`不存在，`.attr`用作直接替换。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-20T21:09:44.340

简单的，

```
var a = $('#element:checkbox').is(':checked'); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-20T21:06:42.710

“jQuery方式”将是使用`.is(":checked")`：

```
var a;
if ($("#add_desc").is(":checked")){ // box is checked
    a = "true";
} else{ // box is not checked
    a= "false";
} 
```

我在我的网络应用程序中经常使用它，它运行良好。

从[jQuery`.is`文档页面](http://api.jquery.com/is/)：

> 与其他过滤方法不同，.is() 不会创建新的 jQuery 对象。相反，它允许您在不修改的情况下测试 jQuery 对象的内容。这在回调（例如事件处理程序）中通常很有用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-20T21:05:48.373

javascript 中的[三元](http://javascript.about.com/od/byexample/a/ternary-example.htm)运算符结合 jQuery [.is()](http://api.jquery.com/is/)是最短的解决方案。

```
var a = ($("#add_desc").is(":checked")) ? "true" : "false"; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-20T21:06:42.560

尝试：

```
if ($('#add_desc').is(':checked')) {
  a = "true";
} else {
  b = "false";
} 
```

您可能也不想使用字符串，即使用`true`and`false`而不是`"true"`and`"false"`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-20T21:07:31.670

尝试

```
$get("#add_desc").checked == true 
```

还

```
$("#add_desc").prop("checked", true);
$("#add_desc").prop("checked", false); 
```

# ruby - Ruby正则表达式：替换不是空格字符的非单词字符

> ID：10253516
> 
> 赞同：19
> 
> 时间：2012-04-20T21:03:37.950
> 
> 标签：ruby, regex

如何替换所有非空格字符 (\s) 的非单词字符 (\W)？

这是所需的功能：

`"the (quick)! brown \n fox".gsub(regex, "#")`

=>

`"the #quick## brown \n fox"`

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-20T21:06:44.283

```
"the (quick)! brown \n fox".gsub(/[^\w\s]/, "#") 
```

通过使正则表达式替换不是单词字符或空格字符的任何内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-20T21:06:54.567

我认为你需要一个像这样的正则表达式：

```
/[^\w\s]/ 
```

当您将抑扬符添加`^`到字符集的开头时，它会否定表达式，以便匹配集中字符以外的任何内容。

# css - :last-of-type Pseudo-Class 未按预期运行

> ID：10253519
> 
> 赞同：2
> 
> 时间：2012-04-20T21:03:42.840
> 
> 标签：css, css-selectors, pseudo-class

我正在申请`:last-of-type`一个应该是这样的元素。[在http://www.elemovements.com](http://www.elemovements.com)上查看最终`div.info`（即每篇文章的底部信息）。为什么它不起作用？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-20T21:13:40.883

伪类`:nth-of-type()`家族只看元素的*类型*，即它的标签名。它们不会按您的类选择器或任何其他选择器进行过滤。

因此，您的陈述：

> 我正在申请`:last-of-type`一个显然是这样的元素。看看决赛`div.info`

是矛盾的。*在那*之后有一个`div.center`，使它成为最后一个，而不是你的。*`div``div.info`*

 *[你目前不能使用 CSS 选择器来找到你的最后一个`div.info`](https://stackoverflow.com/a/10230466/106224)；您将不得不求助于添加额外的类和/或使用 JavaScript。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:08:18.800

您对 CSS 有最常见的误解之一。**CSS 不是从左到右读的，而是从右到左读的！**

意思是，浏览器会寻找`div.info:last-of-type`，所以浏览器会按以下顺序过滤元素：

1.  每种类型的最后一个元素（标签名称）
2.  有类`info`
3.  是一个`div`。

您的元素不按该顺序满足这些条件。它可能是最后一个带有信息类的 div，但**没有最后一个元素有一个类`info`**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-30T14:32:01.467

这2个是一样的：

`div.info:last-of-type`

`div:last-of-type.info`

`:last-of-type`是击中，而`div`不是`.info`，并且`.info`将找到的结果限制为`0`。

另一个例子：

`.section.section-test:last-of-type`

实际上会像：`.section:last-of-type.section-test`*

# node.js - 使用几个小时后，Node.js 服务器 GET 到分离 API 失败

> ID：10253529
> 
> 赞同：1
> 
> 时间：2012-04-20T21:04:52.597
> 
> 标签：node.js, request, coffeescript, express

在我的节点站点中，我调用了一个使用标准 http get 构建的 RESTful API 服务。在成功进行了几个小时的通信后，我发现请求停止发送，它只是等待并最终超时。

被调用的 API 仍然可以很好地接收来自其他地方的请求，但是当从站点发送请求时，它不会到达 API。

我尝试过使用 stream.pipe、util.pump 并将文件写入文件系统。

我正在使用节点 0.6.15。我的站点和被调用的服务位于同一台服务器上，因此正在调用 localhost。内存使用率约为 25%，cpu 平均使用率约为 10%。

经过一段时间的问题，我开始使用[请求](https://github.com/mikeal/request)模块，但我得到了相同的行为。它在失败之前发出的调用次数似乎在 5 到 100 之间。最后我必须重新启动站点，而不是重新启动 api 才能使其再次工作。

网站中的代码大致如下所示：

```
var Request = require('request');
downloadPDF: function(req, res) {
  Project.findById(req.params.Project_id, function(err, project) {
    project.findDoc(req.params.doc_id ,function(err, doc) {
      var pdfileName;
      pdfileName = doc.name + ".pdf";
      res.contentType(pdfileName);
      res.header('Content-Disposition', "filename=" + pdfileName);
      Request("http://localhost:3001/" + project._id).pipe(res);
    });
  });
} 
```

我很了解可能发生的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T23:29:39.563

我不确定您的 Node 服务器有多忙，但可能是您的所有套接字都处于 TIME_WAIT 状态。

如果您运行此命令，您应该会看到有多少个套接字处于此状态：

```
netstat -an | awk '/tcp/ {print $6}' | sort | uniq -c 
```

当然，有一些是正常的。您只是不想最大化系统的可用套接字并让它们都在 TIME_WAIT 中。

如果是这种情况，您实际上希望*减少*agent.maxSockets 设置（与@user1372624 的建议相反），否则每个请求都只会收到一个新的套接字，即使它可以简单地重用最近的套接字。达到无响应状态只需要更长的时间。

我发现这个[Gist](https://gist.github.com/2346805)（http.Agent 的一个补丁）可能会对你有所帮助。

此服务器故障答案也可能有所帮助：[https ://serverfault.com/a/212127](https://serverfault.com/a/212127)

最后，更新 Node 也可能会有所帮助，因为他们可能已经解决了自您的版本以来的保活行为（您可以查看更改日志）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-03T17:43:28.630

您是否尝试增加 agent.maxSockets 或禁用 http.Agent 功能？默认情况下，最近的节点版本使用套接字池进行 HTTP 客户端连接，这可能是问题的根源 [http://nodejs.org/api/http.html#http_class_http_agent](http://nodejs.org/api/http.html#http_class_http_agent)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T22:44:45.193

您正在使用回调返回一个没有多大意义的值，因为您的 Project.findById() 立即返回，而无需等待提供的回调完成。

不过不要感觉不好，nodejs 使用的编程模型一开始有点难以理解。

在事件驱动编程 (EDP) 中，我们提供回调来完成结果，忽略它们的返回值，因为我们永远不知道何时实际调用回调。

这是一个简单的例子。

假设我们要将 HTTP 请求的结果写入文件。

在过程式（非 EDP）编程环境中，我们依赖仅在有返回值时才返回值的函数。

所以我们可能会写一些类似（伪代码）的东西：

```
 url = 'http://www.example.com'

    filepath = './example.txt'

    content = getContentFromURL(url)

    writeToFile(filepath,content)

    print "Done!" 
```

它假设我们的程序将***等待***直到 getContentFromURL() 联系远程服务器，发出请求，***等待***结果并将结果返回给程序。

writeToFile() 函数然后要求操作系统在某个文件路径上打开一个本地文件以进行写入，***等待***直到它被告知打开文件操作已完成（通常***等待***磁盘驱动程序报告它可以执行这样的操作。 )

writeToFile() 然后请求操作系统将内容写入新打开的文件，***等待***直到被告知操作系统用于写入文件的驱动程序告诉它它已经完成了这个目标，将结果返回给程序以便它可以告诉我们程序已经完成。

创建 nodejs 要解决的问题是更好地利用上面发生的所有***等待***所浪费的所有时间。

它通过使用函数（回调）来实现这一点，这些函数在诸如从远程 Web 请求检索结果或将文件写入文件系统等操作完成时调用。

为了在事件驱动的编程环境中完成上述相同的任务，我们需要编写相同的程序：

```
 getContentFromURL(url,onGetContentFromURLComplete)

    function onGetContentFromURLComplete(content,err){
        writeToFile(content,onWriteToFileComplete);
    }

    function onWriteToFileComplete(err){
        print "Done!";
    } 
```

在哪里

*   调用 getContentFromURL() 仅在获得 Web 请求的结果后调用 onGetContentFromURLComplete 回调，并且
*   调用 writeToFile() 仅在成功完成写入内容时调用其回调以显示成功消息。

***nodejs 的真正魔力在于，它可以在程序函数必须等待***大多数时间密集型操作（例如与输入和输出相关的操作）完成的惊人大量时间中完成各种其他事情。

（上面的例子忽略了所有通常被认为是***坏事的错误***。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T07:50:40.407

您是否在调用此函数时尝试记录您的参数？错误可能取决于 req.params.Project_id。您还应该在回调函数中提供错误处理。

如果您可以确定对某个参数集的失败请求（使它们可重现），您可以使用节点检查器轻松调试您的应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-21T04:30:14.123

使用内置函数时，我也遇到过间歇性错误。作为一种解决方法，我使用本机 wget。我做类似以下的事情

```
var exec = require('child_process').exec;
function fetchURL(url, callback) {
    var child;
    var command = 'wget -q -O - ' + url;
    child = exec(command, function (error, stdout, stderr) {
            callback(error, stdout, stderr);
        });
} 
```

通过一些小的调整，您可以使其满足您的需求。到目前为止，它对我来说是坚如磐石。

# java - 如何通过 Android 上的反射实例化成员类

> ID：10253533
> 
> 赞同：1
> 
> 时间：2012-04-20T21:05:00.693
> 
> 标签：java, android, reflection, inner-classes

我有一个应该保存任意对象图的保存/加载框架。这包括非静态嵌套类的实例。

嵌套类需要由创建它们的父类的实例拥有，并且嵌套类使用合成字段知道它属于哪个实例。

作为一个简单的例子，我介绍这个类：

```
public class Foo implements Savable {
  private class Bar implements Savable {
    public void saveState(Saver saver) {
      saver.putInt(3);
    }
  }
  private Bar myBar = new Bar();
  public void saveState(Saver saver) {
    saver.putSavable(myBar);
  }
} 
```

在“标准”编译器上，以下代码可以很好地接收一个对象 ( `myBar`)，找到它的父对象（ 的一个特定实例`Foo`），并与子对象保持对它的引用：

```
if (objectClass.isMemberClass()) {
  //We are a member class, which means we are a non-static inner class, and therefore must save our parent.
  Field[] fields = objectClass.getDeclaredFields();
  //We loop through each of our fields to find the synthetic field created by the compiler that points to our parent.
  for (Field f : fields) {
    String name = f.getName();
    //The synthetic field pointing to the parent is named something like "this$0".  At least, with the "standard" compiler it is.
    if (name.startsWith("this$")) {
      f.setAccessible(true);
      Savable parent = (Savable)f.get(objectClass);
      saver.putSavable("_parent", parent);
      break;
    }
  }
  if (!saver.containsKey("_parent")) {
    throw new RuntimeException("Could not find the owner of inner class: " + objectClass);
  }
} 
```

所以，就像我说的，这在“标准”编译器上工作得很好。然后在加载时，会发生类似的事情，除了我寻找一个构造函数，它接受父类的实例并实例化它，并传入父类。

但！

它不适用于 Android 虚拟机。没有合成字段，构造函数看起来都很正常，就像它们不接受父实例一样。

我在这里吗？这个虚拟机显然不喜欢我的方法。我可以在这里做些什么而不需要内部类知道他们需要保存对其父类实例的引用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T14:35:51.203

好吧，原来我叫错树了。我概述的方法在 Android 和其他任何地方都非常有效。问题是在这种情况下我试图实例化的类是一个*静态*内部类。因此，虽然它是一个*成员*类，但它没有对其外部类的引用。我只需要`if (!Modifier.isStatic(objectClass.getModifiers()))`在寻找合成构造函数/字段之前进行检查。

# ivy - 将 Buildr 与 Ivy 一起使用的示例？

> ID：10253535
> 
> 赞同：2
> 
> 时间：2012-04-20T21:05:09.227
> 
> 标签：ivy, buildr

我们正在考虑将我们的构建系统从 Ant+Ivy 迁移到其他东西，而 Buildr 就是其中一种可能性。但是，它似乎不支持开箱即用的 Ivy，我们不希望将我们内部的 Ivy 存储库和 ivy.xml 文件转换为 Maven 和 POM。

我看到有一个带有 Buildr 扩展的[ivy4r](https://github.com/klaas1979/ivy4r)项目，这似乎是整合两者的唯一方法。但是，该项目在相当长的一段时间内没有新的开发，并且没有可靠的示例或文档。

有没有人有 Buildr+Ivy 集成的示例或 ivy4r 的简单示例？我不是 Ruby 开发人员，所以语法对我来说是陌生的，如果没有一些示例代码，恐怕很难完成这项工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-16T08:33:35.233

以下是`buildr`与`ivy4r`. 评论应该清楚地说明会发生什么。

要记住的最重要的事情是，这些`post_resolve`块仅在构建已经运行时执行。如果您设置了导致常春藤解析的任务依赖关系，那就太晚了。

```
require 'buildr/ivy_extension'

repositories.remote << "http://repo1.maven.org/maven2"
THIS_VERSION = 1.0

define 'my-app', :version => THIS_VERSION do
  # Tell ivy4r to add task dependencies to the compile and test tasks.
  # These tasks will cause ivy to resolve the needed artefacts.
  ivy.compile :conf => 'default', :type => 'jar'
  ivy.test :conf => 'test', :type => 'jar'

  # Declare package tasks so that buildr sets up their dependencies.
  jar = package :jar
  zip = package :zip

  # During the build, at some point ivy will resolve because of the
  # task dependencies set up above.
  # After ivy has resolved, the post_resolve blocks will be run.
  ivy.post_resolve do |ivy|
    # Now that ivy has resolved, get a list of the jar artefacts.
    deps = ivy.deps :conf => 'default', :type => 'jar'

    # Do something interesting with the artefacts.
    # -> e.g. put them in the manifest of the main jar
    jar.with :manifest => manifest.merge({
        'Main-Class' => 'Main',
        'Class-Path' => deps.map { |f| "#{File.basename(f)}" }.join(', '),
    })
    # -> package the app as a zip, including also those artefacts
    # This results in a main.jar that specifies its own class path
    # and can be run by double-clicking or just java -jar main.jar
    zip.path("#{id}-#{version}").tap do |p|
      p.include jar, :as => 'main.jar'
      p.include deps
    end
  end
end 
```

# math - 功率曲线拟合 2 项

> ID：10253538
> 
> 赞同：1
> 
> 时间：2012-04-20T21:05:25.623
> 
> 标签：math, curve-fitting

如何将这个方程拟合到一组数据 (x,y)

```
 y = a x ^ b + c 
```

我尝试了最小二乘误差法（在 Maple 软件中）和电源低，但它不起作用！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T23:22:09.737

我解决了！

```
Y = a x ^ b  ; Y = y-c 
```

因此，如果已知“c”，则可以通过最小二乘法获得“a”和“b”。因此误差可以计算为“c”的函数。（只有 'c' 而不是 'a' 或 'b'）

不，我应该最小化平方误差，女巫是只有“c”的函数。
可以通过数值方法解决这个问题。

# powershell - 在 Sql Server 代理上运行 32 位 Powershell 脚本

> ID：10253543
> 
> 赞同：3
> 
> 时间：2012-04-20T21:05:47.913
> 
> 标签：powershell, 32bit-64bit, sql-server-agent

我有一个运行 32 位 com 对象的 powershell 脚本，所以当我在 Powershell 64x 中运行它时它失败但在 86x 中运行良好

当我在 Sql Server 代理作业中运行它时，它具有相同的 64 倍故障。

有没有解决的办法？喜欢 SSIS 包？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T03:06:04.103

通过WOW64路径调用可以直接调用32位版本的PowerShell：

```
%SystemRoot%\syswow64\WindowsPowerShell\v1.0\powershell.exe 
```

使用 -File 命令行参数，您可以传递要运行的脚本的名称。

# smarty - 我应该像 Yii 这样的 MVC 使用 smarty 模板引擎吗？

> ID：10253551
> 
> 赞同：9
> 
> 时间：2012-04-20T21:06:14.693
> 
> 标签：smarty, template-engine, yii

我过去曾在 Joomla 的 x-cart、jobberbase 和 jomestate 组件以及其他一些 Joomla 组件中使用 smarty。我看到 x-cart 中的事情非常紧密地耦合在一起，而且许多事情似乎比 jobberbase 中的事情要复杂得多，我的印象是这是因为 smarty。

现在我将在客户建议的项目中使用 Yii。而 Yii 本身就是 MVC 框架。那么我应该使用 smarty 吗？我想知道我应该使用 smarty 吗，我的意思是在 Yii 中使用 smarty 会有一些优点吗？或不？或者这只是一种开销，还是在其中使用 smarty 会有一些弊端？我对smarty有所了解。但我认为这有时会使事情变得更复杂。所以我想从你们那里知道，这只是由于糟糕的框架而导致的主导思想，或者其中存在一些现实，所以我应该使用 smarty 还是有比这更好的东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-21T21:16:16.147

作为在 Yii 之前使用 smarty 的人，我会说没有意义。

Smarty 很棒，因为它可以防止您在一个文件中混合逻辑和视图。MVC 架构定义了控制器（包含逻辑）和视图应该是分开的。我建议您像在 smarty 模板中一样编写视图，但只使用 php 语法。如果您使用的是好的 IDE（如 netbeans），它也会自动缩进您的代码[（请参阅 netbeans 中的代码格式）](http://netbeans.org/kb/docs/java/editor-codereference.html#formatting)。

另请查看[控制结构的替代语法](http://php.net/manual/en/control-structures.alternative-syntax.php)

**Yii 创作者的可能观点**

Yii 本身源自于强雪之前的项目[Prado 。](http://www.xisc.com/)Prado 有一种诱人的语言，而 Yii（开箱即用）我不认为这意味着 Qiang 认为模板语言是不必要的。

**智能开销**

Smarty 模板每次更改都符合 PHP 一次（如果启用了缓存），这意味着大部分开销只发生在第一个请求中，但我假设在额外的函数调用中仍然存在一些开销来检查编译的视图存在，这将影响每个请求。所以 smarty 有开销，但它可能可以忽略不计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-13T13:40:10.027

Smarty 就像任何模板语言一样，是一种昂贵的开销。

正如 Rasmus Lerdorf 所说，PHP 已经是一个模板引擎。是否有任何理由添加另一种具有其他控制结构的语言，您已经在 PHP 中拥有？

模板引擎之所以有用，是因为它们嵌入了缓存逻辑。如果您无法自己构建缓存逻辑，请学习它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T22:29:05.183

如果编译为 php，Smarty 将不会产生开销。

只有当开发人员和设计师的角色不同时（谁想使用 Smarty），我才会使用 Smarty

除此之外，它只是另一种要学习的语言。

# r - ggplot 图例显示数据中不存在的级别

> ID：10253552
> 
> 赞同：3
> 
> 时间：2012-04-20T21:06:15.713
> 
> 标签：r, ggplot2

我有一个图例，其图例应包含两个级别。Ggplot 显示了一个有六个级别的图例，其中四个级别没有出现在数据框中。问题的简单再现如下所示：

```
x <- seq(from=1, to=10, by=0.5)
y.2 <- x^2
y.3 <- x^3
exponent.2 <- 2
exponent.3 <- 3
data2 <- data.frame(x=x, y=y.2, exponent = exponent.2)
data3 <- data.frame(x=x, y=y.3, exponent = exponent.3)
data <- rbind(data2, data3)
p <- ggplot(data,aes(x,y,group=exponent, color=exponent)) + geom_line()
p 
```

我显然做错了什么，但需要帮助才能找到问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T21:19:48.970

ggplot2 将指数解释为连续变量；因此，它显示了许多与返回的类似的中断`pretty(c(2, 3))`。

您可以使用`colour = factor(exponent)`，或明确指定颜色中断。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T21:17:12.433

尝试

```
p <- ggplot(data,aes(x,y,group=factor(exponent), color=factor(exponent))) + geom_line() 
```

# c# - drools.net 读取 DRL 文件

> ID：10253562
> 
> 赞同：1
> 
> 时间：2012-04-20T21:07:10.667
> 
> 标签：c#, drools

我正在尝试运行一个使用 drool.net 的简单应用程序。每当我执行时，应用程序在`builder.AddPackageFromDrl("DroolsApp.Rules.drl", stream);`错误处崩溃，指出 NullReferenceException 未处理并且对象引用未设置对象的实例。我试图更改 drl 文件，但错误仍然存​​在。我错过了什么吗？还有没有任何网站提供使用 drools.net 的详细教程，我是否需要任何特定的程序来创建和编辑 drl 文件，因为我使用的是一个简单的记事本。

提前致谢

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using org.drools.dotnet.compiler;
using org.drools.dotnet.rule;
using org.drools.dotnet;
using System.IO;
using System.Reflection;

namespace DroolsApp
{
    class Program
    {   
        static void Main(string[] args)
        {            
            PackageBuilder builder = new PackageBuilder();
            Stream stream = Assembly.GetExecutingAssembly()
            .GetManifestResourceStream("DroolsApp.Rules.drl");
            builder.AddPackageFromDrl("DroolsApp.Rules.drl", stream);
            Package pkg = builder.GetPackage();
            RuleBase ruleBase = RuleBaseFactory.NewRuleBase();
            ruleBase.AddPackage(pkg);            
            executeRules(ruleBase, 5);
            executeRules(ruleBase, 6);
            executeRules(ruleBase, 7);
        }

        public static void executeRules(RuleBase ruleBase, int amount)
        {
            WorkingMemory workingMemory = ruleBase.NewWorkingMemory();
            Quest quest = new Quest();
            quest.Value = amount;
            workingMemory.assertObject(quest);
            workingMemory.fireAllRules();
        }
    }
}   

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace DroolsApp
{
    class Quest
    {
        public int Value { set; get; }
    }
}

DRL File:    

package DroolsApp

rule "NumberFive"
    when
        quest : Quest( Value == 5 )
    then
            Console.WriteLine("FIVE");
end 

rule "NumberSix"
    when
        quest : Quest( Value == 6 )
    then
            Console.WriteLine("SIX");
end 
```

堆栈跟踪：

```
System.NullReferenceException was unhandled
  Message=Object reference not set to an instance of an object.
  Source=drools.dotnet
  StackTrace:
       at org.drools.dotnet.semantics.DotnetClassTypeResolver.resolveType(String className)
       at org.drools.semantics.java.RuleBuilder.build(ColumnDescr columnDescr)
       at org.drools.semantics.java.RuleBuilder.build(RuleDescr ruleDescr)
       at org.drools.semantics.java.RuleBuilder.build(Package pkg, RuleDescr ruleDescr)
       at org.drools.compiler.PackageBuilder.addRule(RuleDescr ruleDescr)
       at org.drools.compiler.PackageBuilder.addPackage(PackageDescr packageDescr)
       at org.drools.compiler.PackageBuilder.addPackageFromDrl(String fileName, Reader reader)
       at org.drools.dotnet.compiler.PackageBuilder.AddPackageFromDrl(String fileName, Stream drlStream)
       at MinimalDroolsForm.Program.Main(String[] args) in C:\Users\Carl\Desktop\DroolsApp\Program.cs:line 19
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T09:47:31.213

这肯定是 drl 文件中的错误。尝试删除所有规则和导入，编译它们，然后添加单行并重复（它必须验证）。Drools.net 对带有 NullReferenceException 的编译错误或加载 CompiledRules0.dll 的错误做出反应（因为它没有生成）。添加一个 Pre-build Build Event 删除之前生成的 CompiledRules0.dll 也是一件好事（当 Drools.net 无法生成文件时，它使用前一个）。这是代码：

```
cd $(TargetDir)
del CompiledRules0.* 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T13:18:12.917

两个提示： 1) 在调用 GetManifestResourceStream 方法时，一定要传递命名空间和文件名作为参数。2）在Visual Studio（如果您正在使用它）中，规则文件属性，将构建操作设置为嵌入式资源。

# javascript - 文档加载后如何加载这个 javascript 函数？

> ID：10253570
> 
> 赞同：0
> 
> 时间：2012-04-20T21:07:47.607
> 
> 标签：javascript, jquery, animation, background

```
j = {largeSign: function(a) {
        var b = $(#identity .scorecard"), c = 43, d = 105 - c, e = 800;
        this.animation(b, d, c, e, a)
    },animation: function (a, b, c, d, e) {
        var f = this, g = 1e3, h, i = function() {
             $(".sign", a).each(function(a, f) {
                  h = parseInt(e + $(this).text()), a > 2 && (d += 30), a === 0 || a === 3 ? $(this).animate({backgroundPosition: "0px " + (b * h + c) + "px"}, d * 1.6) : a === 1 || a === 4 ? $(this).animate({backgroundPosition: "0px " + (b * h + c) + "px"}, d * 1.8) : (a === 2 || a === 5) && $(this).animate({backgroundPosition: "0px " + (b * h - b + c) + "px"}, d * 2, function() {
                      $(this).delay(200).animate({backgroundPosition: "0px " + (b * parseInt(e + $(this).text()) + c) + "px"}, 1e3)
                  })
             })
         };
         setTimeout(i, g)
    }} 
```

基本上我正在尝试为背景位置设置动画，并让它停在已在 div .sign 中解析的值上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:11:11.773

看起来你正在使用 jQuery，所以这里是 jQuery 解决方案：

```
$(function() {
    // your code here
}); 
```

这只是简写

```
$(document).ready(function() {
    // your code here
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:11:26.087

使用 .ready()

```
$(document).ready(function(){
  j.largeSign();
}); 
```

[http://api.jquery.com/ready/](http://api.jquery.com/ready/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:10:37.563

通过以下方式包装代码：

```
$(document).ready(function(){

  // the call goes here

}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T21:11:14.300

你可以用[`.ready()`](http://api.jquery.com/ready/)：

```
jQuery(document).ready(function($) {
  // Code using $ as usual goes here.
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T21:11:36.400

如果您希望它在文档加载后运行，请尝试以下操作：

```
$(function(){
//put your code here
j = {largeSign: function(a) {...
}); 
```

我发现使用 '$(function(){' 比 '$(document).ready' 更好，因为如果不推荐使用 '$(document).ready'，如果你已经在使用'$(function(){..'。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T21:15:47.940

```
$(function(){
  j.largeSign.apply(context, arguments);
}); 
```

在哪里..

`context`将是`this`它运行时在实际函数中引用的内容

和

`arguments`可以是单个值或函数可以作为参数接收的值/对象的数组（如果有）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-20T21:16:00.763

尝试

```
$(document).ready(function() {
   // put all your jQuery goodness in here.
 }); 
```

# python - 如何更改 QDockWidgetArea 中所有 QDockWidgets 的宽度/高度？

> ID：10253574
> 
> 赞同：1
> 
> 时间：2012-04-20T21:08:13.737
> 
> 标签：python, qt4, pyqt4

我有一个 PyQt 4 应用程序，它有一个 QMainWindow，在左侧和底部停靠区域中有停靠的 QDockWidgets。我目前有两个停靠在左侧和底部的 2 个小部件。我试图弄清楚如何以编程方式移动中央小部件和停靠区域之间的边界，有效地改变停靠区域的宽度（在左侧或右侧区域的情况下）或高度（对于顶部和底部停靠区域）。

我可以用鼠标手动完成；当我将光标移动到中央小部件和停靠区域之间的边界上时，我会得到一个调整大小的句柄，我可以使用它来拉伸停靠区域。我还没有找到一个接口来允许我从我的程序中做到这一点。我尝试手动调整 QDockWidget 对象本身的大小（文档建议不要这样做）和它们包装的小部件（应该可以工作），但这似乎不起作用。有任何想法吗？

具体来说，这种方法不起作用：

```
dock1.resize(QSize(width, height))
dock2.resize(QSize(width, height))
dock3.resize(QSize(width, height)) 
```

这也不是：

```
dock1.widget().resize(QSize(width, height))
dock2.widget().resize(QSize(width, height))
dock3.widget().resize(QSize(width, height)) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T23:28:25.630

我想我明白会发生什么。首先是文档中的一些注释。

首先[`QMainWindow`](http://doc.qt.nokia.com/4.7-snapshot/qmainwindow.html)：

> QMainWindow 有自己的布局，您可以在其中添加 QToolBars、QDockWidgets、QMenuBar 和 QStatusBar。布局有一个中心区域，可以被任何类型的小部件占据。

A`QMainWindow`有自己的布局管理器，这意味着它将管理其项目的布局。我在文档中找不到任何参考，但我猜布局管理器试图最大化`centralWidget`. 因此，所有其他元素都缩小到最低限度。

让我们看看[`QDockWidget`](http://doc.qt.nokia.com/4.7-snapshot/qdockwidget.html)：

> QDockWidget 充​​当其子部件的包装器，使用 setWidget() 设置。应在子小部件中实施自定义尺寸提示、最小和最大尺寸以及尺寸策略。QDockWidget 将尊重它们，调整自己的约束以包括框架和标题。大小约束不应该在 QDockWidget 本身上设置，因为它们会根据它是否停靠而改变；停靠的 QDockWidget 没有框架和较小的标题栏。

所以这意味着你应该改变`QDockWidget`. 当 a`QDockWidget`浮动时，它可以根据小部件的要求自由调整大小。但是停靠它将把它留给`QMainWindow`s 布局管理器，它会缩小。

可能最简单的解决方案是在`minimumSize`里面设置小部件，`QDockWidget`这样布局管理器`QMainWindow`就不会缩小它。或者，您可以为您的小部件子类化并重新实现`sizeHint`方法，以便布局管理器获得首选大小。

简而言之，这应该有效：

```
dock1.widget().setMinimumSize(QSize(width, height))
dock2.widget().setMinimumSize(QSize(width, height))
dock3.widget().setMinimumSize(QSize(width, height)) 
```

# ruby-on-rails - Ruby on Rails 从二维数组中按值获取键

> ID：10253582
> 
> 赞同：1
> 
> 时间：2012-04-20T21:09:06.827
> 
> 标签：ruby-on-rails, ruby

我有一个看起来像这样的二维数组：

```
TITLETYPE = [['Prof.', '4'],
  ['Dr.', '3'],
  ['Mrs.', '2'],
  ['Ms.', '1'],
  ['Mr.', '0']] 
```

例如，我需要获取值 1 的密钥（应该是“女士”）我应该怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T21:10:34.847

```
TITLETYPE.select{ |x| x[1] == '1' }.first.first 
```

* * *

## 这是如何工作的

您可以使用[`Array`](http://www.ruby-doc.org/core-1.9.3/Array.html)'[`select`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-select)方法找到您要查找的行。您的行 ar 数组每个都有两个元素（元素 0 和元素 1），因此您需要查找第二个元素（元素 1）等于您要查找的值（即字符串`"1"`）的行：

```
TITLETYPE.select{ |x| x[1] == "1" } 
```

这将返回一个只有一行的数组：

```
[["Ms.", "1"]] 
```

要从该数组中获取第一个也是唯一的值，请使用`Array`'s[`first`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-first)方法，该方法将返回：

```
["Ms.", "1"] 
```

然后，从那里，再次从这两个值中获得第一个值`first`：

```
"Ms." 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T20:37:43.313

实际上，听起来`Array#rassoc`很适合你。

```
TITLETYPE.rassoc('1')[0] # => 'Ms.' 
```

请参阅[Ruby-doc](http://www.ruby-doc.org/core-2.0/Array.html#method-i-rassoc)中的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:41:02.073

更自然地，您应该将此类信息保存为哈希。如果你经常想要 key-to-value，并且 key-to-value 是唯一的，那么创建一个哈希：

```
TYTLETYPEHASH = Hash[TYTLETYPE.map(&:reverse)] 
```

并访问它：

```
TYTLETYPEHASH['1'] # => 'Ms.' 
```

或创建一个像这样的哈希：

```
TYTLETYPEHASH = Hash[TYTLETYPE] 
```

并访问它：

```
TYTLEHASH.key('1') # => 'Ms.' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-04T05:11:50.663

我有一个类似的问题，并通过简单地使用这样的东西来解决它：

```
<% Array.each do |value| %> 
```

并使用访问每个元素`<%= value[:keyname] %>`

IE

一个看起来像这样的数组（使用 .inspect）

```
 [{:id=>1, :title=>"ABC"}, {:id=>2, :title=>"XYZ"}] 
```

可以成为一个 HTML 选择/下拉框：

```
 <select name="ClassName[TargetParameter]">
    <% Array.each do |value| %>
      <option value="<%= value[:id] %>"><%= value[:title] %></option>
    <% end %>
 </select> 
```

# php - URL 重写无法正常工作

> ID：10253584
> 
> 赞同：0
> 
> 时间：2012-04-20T21:09:11.990
> 
> 标签：php, .htaccess, url-rewriting

这是我的 URL 重写：

```
RewriteRule ^cars/$ cars.php    
RewriteRule ^cars/([a-z-]+)/$ /cars.php?model=$1 
```

这行得通，所以我的网址是这样的：

> example.com/cars/porche/

指

> car.php?model=porche

现在我制定了更多的搜索条件，所以我希望能够添加例如车型年份、汽车制造商等，如下所示：

> example.com/cars/porche/?model_year=xxx&car_manufactor=xxx

现在这不适用于当前的重写，但我不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:10:22.400

简单，只需添加`QSA`：

```
RewriteRule ^cars/([a-z-]+)/$ /cars.php?model=$1 [QSA] 
```

这告诉重写引擎也将任何其他查询参数附加到重写的 URL。

# c# - 尝试在共享目标应用程序中使用 Launcher.LaunchUriAsync 赢得 Win 8

> ID：10253588
> 
> 赞同：2
> 
> 时间：2012-04-20T21:10:04.823
> 
> 标签：c#, share, windows-8, microsoft-metro

我正在构建一个充当 URI 共享目标的应用程序；它需要 URI 然后 URL 用于调用浏览器到我们的网站进行共享。我有使用共享目标示例的代码，但是当我在调试器之外时，Launcher.LaunchUriAsync 总是失败。它不会抛出，所以我很难弄清楚错误可能是什么；也许一些安全上下文。

有任何想法吗？代码本身很短；我直接从 shell 运行并通过 Win-C/Share 调用成功 = false。我已经确保清单设置了所有三个网络声明。其他想法？

```
if (this.shareOperation.Data.Contains(StandardDataFormats.Uri))
{
    Uri uri = await this.shareOperation.Data.GetUriAsync();
    if (uri != null)
    {
        Uri tempUri;
        Uri.TryCreate("http://www.mysite.com/#/search?v=results&bk=1.0&q="+uri.ToString(), UriKind.Absolute, out tempUri);
        bool success = await Windows.System.Launcher.LaunchUriAsync(tempUri);
        if (success) {
            contentValue.Text += "Success invoking browser" + ":URL="+tempUri.ToString()+ Environment.NewLine;
        } else {
            contentValue.Text += "Fail invoking browser" + ":URL=" + tempUri.ToString() + Environment.NewLine;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T04:54:10.600

共享目标不应启动另一个应用程序。共享目标旨在托管在共享窗格中，并应为用户提供一种快速、上下文相关的方式来与您的应用程序或服务共享内容。

在您的情况下，也许您应该托管一个 WebView 并将其导航到您的服务的 URL？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-11T20:45:02.150

为了成功调用 LaunchUriAsync，需要满足几个条件。

正如[MSDN 上](https://msdn.microsoft.com/en-us/library/windows/apps/hh701480.aspx "在msdn这里")所见，您需要确保以下内容：

1.  调用 API 时，调用应用程序必须对用户可见。
2.  除非您从经典 Windows 应用程序调用此 API，否则必须从 ASTA 线程（也称为 UI 线程）中调用此 API。
3.  您必须在清单中指定 privateNetworkClientServer 功能才能启动 Intranet URI，例如指向网络位置的 file:/// URI。
4.  您不能使用此方法在本地区域中启动 URI。例如，应用程序不能使用 file:/// 协议访问本地计算机上的文件。相反，您必须使用存储 API 来访问文件。

我想前两个条件之一就是您的代码失败的原因。（至少那是我的问题）

# html - 与右浮动元素碰撞时如何清除左浮动元素？

> ID：10253590
> 
> 赞同：2
> 
> 时间：2012-04-20T21:10:13.770
> 
> 标签：html, css

如果有更好的设计方法，或者我可以用谷歌搜索的容易搜索的短语，请随时告诉我，我会很快把它记下来。不幸的是，我不认为我在谷歌上搜索正确的条款。

**要跳过解释，底部有一个指向小提琴的链接。**

* * *

我有一个必须始终靠在右侧的右侧柱子，并且永远不会向下推。

我的左侧元素应该是内联的，直到它们与右列发生冲突，然后它们应该清除到下一行。

* * *

我认为这可以通过将左侧元素浮动到左侧来完成，而我的右列浮动到右侧。我无法清除任何单个左侧元素，因为每个左侧元素的宽度都是可变的。

**HTML**

```
<div class='left-el'>
    <ul>
        <li>Variable width</li>
        <li>Variable height</li>
        <li>Left margin must always be against left-side</li>
    </ul>
</div>
<div class='left-el'>
    This column needs to move to the next<br/> 
    line since there is no room left. <br/>
    Instead, it pushes the right-floated div down<br/> 
    to make room.
</div>
<div id='right-col'>
    <ul>
        <li>Variable width</li>
        <li>100% height</li>
        <li>Right margin must always be against right-side</li>
    </ul>
</div>​ 
```

**CSS**

```
.left-el {
    background-color: orange;            
    float: left; 
    margin-right: 10px;
}

#right-col {
    background-color: green;
    float: right; 
    height: 100%;
}​ 
```

**条件**

*   右列必须始终向右对齐
*   右列必须是*可变宽度*
*   左元素必须是*可变宽度*
*   左元素不应该干扰右列

这就是我一直在使用的：http: [//jsfiddle.net/TmSuD/](http://jsfiddle.net/TmSuD/)（上面的标记）

***也许这里适合一张桌子？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:21:55.333

我相信，如果您将右列放在 html 中的左列上方，它会做您想要的。

# opengl - wglMakeCurrent 使用 DetourCreateProcessWithDll 失败

> ID：10253592
> 
> 赞同：0
> 
> 时间：2012-04-20T21:10:21.397
> 
> 标签：opengl, glut, detours, glutcreatewindow

我`DetourCreateProcesswithDLL`在 Visual Studio 2010 中使用并为 Opengl32.dll 、 glu32.dll 和 glut32.dll 提供替换 dll，同时从 glut 演示程序为 abgr.exe 演示应用程序创建进程。

这样我就拦截了 Opengl32、glu32、glut32 库。然后这些 api 从系统文件夹或通常的 dll 中调用相应的 api。

这些 dll 在其各自的库中定义了所有 api。

问题是`wglMakeCurrent`在 Win 7 x64 位的 NVidia GTX480 上使用 glut 演示应用程序（如 abgr.exe）返回 0 或失败。它也不适用于其他演示应用程序。

如果我更改正在调用的 abgr.exe 或 GLIntercept 可执行文件的兼容性，它确实有效`DetourCreateProcesswithDLL`。即右键单击exe -> 更改属性-> 兼容性-> 检查以256 色运行。

但是，这看起来像是一种解决方法，并且显示效果看起来并不那么好。我怎样才能使用而不必这样做。如何获得良好的价值`wglMakeCurrent`。 `wglMakeCurrent`从内部调用`glutCreateWindow`。

这在 AMD Fusion GPU 上不是问题。那里`wglMakeCurrent`并返回一个很好的价值。问题仅出现在 NVIDIA GTX 480 上。有人知道如何解决此问题吗？我已更新驱动程序并在 NVIDIA 控制面板 Help->About 上显示版本 4.3.790.0

wglCreateContext 返回 0x00010000

# java - 将糖果袋平均分给三个孩子

> ID：10253597
> 
> 赞同：2
> 
> 时间：2012-04-20T21:10:38.813
> 
> 标签：java, dynamic-programming

我有`n`一袋糖果，所以没有两个袋子里面有相同数量的糖果（即它是一组`A[] = {a0,a1,a2,...,ai,...,aj}`where `ai != aj`）。

我知道每个袋子里有多少糖果以及`M`我拥有的糖果总数。

我需要将袋子分配给三个孩子，以便尽可能公平地分配糖果（即每个孩子都尽可能靠近`M/3`）。

不用说，我可能不会撕开袋子来平衡计数——那么这个问题就变得微不足道了。

有没有人有任何想法如何解决这个问题 - 最好是在 Java 中？

编辑：

面试官希望我使用二维数组来解决问题：第一个孩子得到 x，第二个孩子得到 y，第三个得到其余的：`S[x][y]`.

这是在我尝试以下之后：

```
1] sort array n lg n
2] starting with largest remaining bag, give bag to kid with fewest candy. 
```

* * *

这是我划分为两个孩子的解决方案（这是正确答案）。也许这将有助于获得 3 路分区。

```
int evenlyForTwo(int[] A, int M) {
    boolean[] S = new boolean[M+1];
    S[0]=true;//empty set
    for(int i=0; i<A.length; i++)
        for(int x=M; x >= A[i]; x--)
            if(!S[x])
                S[x]=S[x-A[i]];
    int k = (int) M/2;
    while(!S[k])
        k--;
    return k;//one kid gets k the other the rest.
}// 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T22:03:26.417

您描述的问题被称为[3-Partition 问题](http://en.wikipedia.org/wiki/3-partition_problem)，并且被称为 NP-hard。[这个问题在MathOverflow](https://mathoverflow.net/questions/82332/seeking-a-solution-algorithm-to-the-3-partition-problem)上进行了一些讨论。您可能会在那里找到一些有价值的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:18:35.997

这是一个小解决方案，粗略但给出了正确的结果。你甚至可以改变孩子、包包等的数量。

```
public class BagOfCandies {

   static public void main(String...args) {
      int repeat = 10;
      int childCount = 3;
      int bagsCount = childCount + (int) (Math.random() * 10);

      for (int k=0; k<repeat; k++) {
         int candyCount = 0, n=0;
         int[] bags = new int[bagsCount];
         for (int i=0; i<bags.length; i++) {
            n += 1 + (int) (Math.random() * 2);
            bags[i] = n;
            candyCount += n;
         }
         shuffle(bags);   // completely optional! It works regardless

         boolean[][] dist = divideBags(bags, childCount);

         System.out.println("Bags of candy : " + Arrays.toString(bags) + " = " + bags.length);
         System.out.println("Total calculated candies is " + candyCount);
         int childCandySum = 0;
         for (int c=0; c<childCount; c++) {
            int childCandies = countSumBags(bags, dist[c]);
            System.out.println("Child " + (c+1) + " = " + childCandies + " --> " + Arrays.toString(dist[c]));
            childCandySum += childCandies;
         }
         System.out.println("For a total of " + childCandySum + " candies");
         System.out.println("----------------");
      }
   }

   static private void shuffle(int[] bags) {
      for (int i=0, len=bags.length; i<len; i++) {
         int a = (int)Math.floor(Math.random()*len);
         int b = (int)Math.floor(Math.random()*len);
         int v = bags[a];
         bags[a] = bags[b];
         bags[b] = v;
      }
   }

   static private boolean[][] divideBags(int[] bags, int childCount) {
      int bagCount = bags.length;

      boolean[][] dist = new boolean[childCount][bagCount];
      for (int c=0; c<childCount; c++) 
         Arrays.fill(dist[c], false);

      for (int i=0; i<bagCount; i+=childCount)
         for (int j=i, c=0; c<childCount && j<bagCount; j++, c++)
            dist[c][j] = true;

      if (childCount == 1) return dist;  // shortcut here

      int sumDiff = 1;
      int oldDiff = 0;

      while (sumDiff != oldDiff) {
         oldDiff = sumDiff;
         sumDiff = 0;

         // start comparing children in pair
         for (int child1=0; child1<childCount-1; child1++) {
            for (int child2=child1+1; child2<childCount; child2++) {

               int count1 = countSumBags(bags, dist[child1]);
               int count2 = countSumBags(bags, dist[child2]);
               int diff = Math.abs(count1 - count2);

               // a difference less than 2 is negligeable
               if (diff > 1) {
                  // find some bags with can swap to even their difference
                  int c1=-1, c2=-1, cdiff;
                  boolean swap = false;

                  for (int i=0; i<bagCount-1; i++) {
                     for (int j=i; j<bagCount; j++) {
                        if (dist[child1][i] && dist[child2][j]) {
                           cdiff = Math.abs((count1 - bags[i] + bags[j]) - (count2 + bags[i] - bags[j]));
                           if (cdiff < diff) {
                              c1 = i; c2 = j;
                              diff = cdiff;
                              swap = true;
                           }
                        }
                        if (dist[child1][j] && dist[child2][i]) {
                           cdiff = Math.abs((count1 - bags[j] + bags[i]) - (count2 + bags[j] - bags[i]));
                           if (cdiff < diff) {
                              c1 = j; c2 = i;
                              diff = cdiff;
                              swap = true;
                           }
                        }
                     }
                  }

                  if (swap) {
                     //System.out.println("Swaping " + c1 + " with " + c2);
                     dist[child1][c1] = false; dist[child1][c2] = true;
                     dist[child2][c1] = true;  dist[child2][c2] = false;
                  }
               }

               //System.out.println("Diff between " + child1 + "(" + countSumBags(bags, dist[child1]) + ") and " + child2 + "(" + countSumBags(bags, dist[child2]) + ") is " + diff);

               sumDiff += diff;
            }
         }

         //System.out.println("oldDiff="+oldDiff+", sumDiff="+sumDiff);
      }

      return dist;
   }

   static private int countSumBags(int[] bags, boolean[] t) {
      int count = 0;
      for (int i=0; i<t.length; i++) {
         if (t[i]) {
            count+=bags[i];
         }
      }
      return count;
   }

} 
```

我不知道这是否是您正在寻找的结果，但根据我对问题的理解，它似乎是。

# javascript - 在 JavaScript 中将大整数转换为 8 字节数组

> ID：10253601
> 
> 赞同：4
> 
> 时间：2012-04-20T21:10:56.920
> 
> 标签：javascript, bytearray

我正在尝试将一个大数字转换为 javascript 中的 8 字节数组。

这是我传入的 IMEI：45035997012373300

```
var bytes = new Array(7);
for(var k=0;k<8;k++) {
  bytes[k] = value & (255);
  value = value / 256;
} 
```

这最终给出了字节数组：48,47,7,44,0,0,160,0。转换回long，值为45035997012373296，比正确值小4。

知道为什么会这样以及如何修复它以序列化为正确的字节吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:52:46.080

由于您正在从十进制转换为字节，因此除以 256 是一个非常容易模拟的操作，可以通过将字符串中的数字分成几部分来模拟。我们可以利用两个数学规则。

1.  十进制数的最右边 n 位可以确定可被 2^n 整除。
2.  10^n 总是能被 2^n 整除。

因此，我们可以将这个数字从最右边的 8 位数字中分离出来以找到余数（即`& 255`），将右边的部分除以 256，然后将数字的左边部分分别除以 256。左边的余数可以通过公式 移到数字的右边（最右边的 8 位）`n*10^8 \ 256 = (q*256+r)*10^8 \ 256 = q*256*10^8\256 + r*10^8\256 = q*10^8 + r*5^8`，其中`\`是整数除法，`q`和`r`分别是商和余数`n \ 256`。这产生了以下方法，对长度不超过 23 位（15 正常 JS 精度 + 8 额外产生的此方法）的字符串进行整数除以 256：

```
function divide256(n)
{
    if (n.length <= 8)
    {
        return (Math.floor(parseInt(n) / 256)).toString();
    }
    else
    {
        var top = n.substring(0, n.length - 8);
        var bottom = n.substring(n.length - 8);
        var topVal = Math.floor(parseInt(top) / 256);
        var bottomVal = Math.floor(parseInt(bottom) / 256);
        var rem = (100000000 / 256) * (parseInt(top) % 256);
        bottomVal += rem;
        topVal += Math.floor(bottomVal / 100000000); // shift back possible carry
        bottomVal %= 100000000;
        if (topVal == 0) return bottomVal.toString();
        else return topVal.toString() + bottomVal.toString();
    }
} 
```

从技术上讲，这可以实现为将任意大小的整数除以 256，只需将数字递归地分成 8 位部分并使用相同的方法分别处理每个部分的除法。

`45035997012373300`这是一个为您的示例编号 ( )计算正确字节数组的工作实现：http: [//jsfiddle.net/kkX2U/](http://jsfiddle.net/kkX2U/)。

```
[52, 47, 7, 44, 0, 0, 160, 0] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:15:05.277

你的值和[最大的 JavaScript 整数](https://stackoverflow.com/questions/307179/what-is-javascripts-max-int-whats-the-highest-integer-value-a-number-can-go-t)比较：

```
45035997012373300  // Yours
 9007199254740992  // JavaScript's biggest integer 
```

JavaScript 不能将您的原始值完全表示为整数；这就是为什么你的脚本分解它会给你一个不精确的表示。

有关的：

```
var diff = 45035997012373300 - 45035997012373298;
// 0 (not 2) 
```

**编辑**：如果您可以将您的号码表示为十六进制字符串：

```
function bytesFromHex(str,pad){
  if (str.length%2) str="0"+str;
  var bytes = str.match(/../g).map(function(s){
    return parseInt(s,16);
  });
  if (pad) for (var i=bytes.length;i<pad;++i) bytes.unshift(0);
  return bytes;
}

var imei = "a000002c072f34";
var bytes = bytesFromHex(imei,8);
// [0,160,0,0,44,7,47,52] 
```

如果您需要从最不重要到最重要的字节排序，请`.reverse()`在结果上抛出 a。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:44:25.887

将imei存储为十六进制字符串（如果可以的话），然后以这种方式解析字符串，这样您可以在构建数组时保持精度。如果这个问题没有得到解答，当我回到家使用我的普通电脑时，我会带着 PoC 回来。

就像是：

```
function parseHexString(str){
   for (var i=0, j=0; i<str.length; i+=2, j++){
      array[j] = parseInt("0x"+str.substr(i, 2));
   }
} 
```

或接近那个...

# gcc - 带有 crosstool-NG 的 ARM 交叉编译器的正确选项是什么

> ID：10253603
> 
> 赞同：6
> 
> 时间：2012-04-20T21:11:08.537
> 
> 标签：gcc, arm, cross-compiling, toolchain, crosstool-ng

我正在尝试使用[crosstool-NG](http://crosstool-ng.org/)构建一个交叉编译器来定位在我的 NAS 盒上运行的处理器。

NAS盒子是[ZyXEL NSA210](http://zyxel.nas-central.org/wiki/Category%3aNSA-210)，有一个[例子dmesg输出](http://zyxel.nas-central.org/wiki/Dmesg_%28NSA-210%29)，`/proc/cpuinfo`就是：

```
Processor       : ARM926EJ-S rev 5 (v5l)
BogoMIPS        : 183.09
Features        : swp half thumb fastmult edsp java
CPU implementer : 0x41
CPU architecture: 5TEJ
CPU variant     : 0x0
CPU part        : 0x926
CPU revision    : 5
...
Hardware        : Oxsemi NAS
Revision        : 0000
Serial          : 00000d51caab2d00 
```

目标选项页面上的选项，()中的标志和我当前的设置：

*   目标架构（臂）
*   使用 MMU（是）
*   字节序（小字节序）
*   位数（32 位）
*   默认指令集模式（arm）
*   使用 EABI（是）
*   架构级别 --with-arch= ()
*   为 CPU 发出程序集 --with-cpu= ()
*   CPU调优()
*   使用特定的 FPU ()
*   浮点数（软件）
*   目标 CFLAGS ()
*   目标 LDFLAGS ()

我一直在尝试“架构级别”和“为 CPU 发射程序集”中的各种组合，例如`arm926ej-s`, `armv5l`, `armv5tej`，但我不知道哪个选项在哪里。

我已将目标操作系统设置为裸机，因为 crosstool-NG 没有盒子上使用的 Linux 版本。

此外，一旦构建了工具链，我是否需要再次将相同的选项传递给编译器。

到目前为止，通过尝试刚刚产生的`Illegal instruction`消息。

**编辑**

如果有人可以将我指向一篇关于设置 ARM GCC 工具链的文章，并明确参考如何找出正确的参数，那将回答我的问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T15:15:08.203

Try one of these

```
--with-arch=armv5te
--with-tune=arm926ej-s 
```

*or*

```
--with-cpu=arm926ej-s 
```

(there's no point in having both).

Otherwise your options look fine.

If it still doesn't work then you need to look at the libraries and headers. If you want to use dynamically linked libraries then you'll need to have ones that match those on the target, version wise and name wise. If you want to use static linking, or copy your own shared libraries onto the target (in a non-standard place, perhaps, which would need extra config), you should be fine.

Either way, you'll need your kernel headers to match. You can probably just download some contemporary kernel headers from kernel.org.

# mysql - 导入 CSV 以仅更新表中的一列

> ID：10253605
> 
> 赞同：44
> 
> 时间：2012-04-20T21:11:12.210
> 
> 标签：mysql, csv, import

我有一个看起来像这样的表：

```
products
--------
id, product, sku, department, quantity 
```

此表中大约有 800,000 个条目。我收到了一个新的 CSV 文件，其中更新了每种产品的所有数量，例如：

```
productA, 12
productB, 71
productC, 92 
```

因此大约有 750,000 次更新（50,000 种产品数量没有变化）。

我的问题是，如何导入此 CSV 以仅更新基于`product`(唯一) 的数量，但不理会`sku`、`department`和其他字段？我知道如何在 PHP 中通过循环遍历 CSV 并为每一行执行更新来做到这一点，但这似乎效率低下。

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2012-04-20T21:25:46.017

您可以使用[`LOAD DATA INFILE`](http://dev.mysql.com/doc/refman/5.5/en/load-data.html)将 800,000 行数据批量加载到临时表中，然后使用多表[`UPDATE`](http://dev.mysql.com/doc/refman/5.5/en/update.html)语法将现有表连接到临时表并更新数量值。

例如：

```
CREATE TEMPORARY TABLE your_temp_table LIKE your_table;

LOAD DATA INFILE '/tmp/your_file.csv'
INTO TABLE your_temp_table
FIELDS TERMINATED BY ','
(id, product, sku, department, quantity); 

UPDATE your_table
INNER JOIN your_temp_table on your_temp_table.id = your_table.id
SET your_table.quantity = your_temp_table.quantity;

DROP TEMPORARY TABLE your_temp_table; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-20T21:23:15.593

我会将更新数据加载到一个单独的表中`UPDATE_TABLE`，并使用以下方法在 MySQL 中执行更新：

```
UPDATE PRODUCTS P SET P.QUANTITY=(
    SELECT UPDATE_QUANTITY
    FROM UPDATE_TABLE
    WHERE UPDATE_PRODUCT=P.PRODUCT
) 
```

我现在手头没有 MySQL，所以我可以完美地检查语法，可能是你需要`LIMIT 0,1`在内部添加一个`SELECT`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-09-18T23:10:38.380

@ike-walker 的回答确实是正确的，但也要记得仔细检查你的 CSV 数据是否格式化。很多时候，例如 CSV 文件可以包含用双引号括起来的字符串字段，如果在 Windows 上工作，则`"`行以结尾。 默认情况下，假定不使用任何封闭字符并且行尾是. 更多信息和示例在这里[https://mariadb.com/kb/en/importing-data-into-mariadb/](https://mariadb.com/kb/en/importing-data-into-mariadb/)`\r\n`
`\n`

这可以通过使用附加选项来`FIELDS`解决`LINES`

```
CREATE TEMPORARY TABLE your_temp_table LIKE your_table;

LOAD DATA INFILE '/tmp/your_file.csv'
INTO TABLE your_temp_table
FIELDS 
   TERMINATED BY ','            
   OPTIONALLY ENCLOSED BY '"'    -- new option
LINES TERMINATED BY '\r\n'       -- new option

(id, product, sku, department, quantity); 

UPDATE your_table
INNER JOIN your_temp_table on your_temp_table.id = your_table.id
SET your_table.quantity = your_temp_table.quantity;

DROP TEMPORARY TABLE your_temp_table; 
```

# java - 图像未加载到 jar 文件中

> ID：10253613
> 
> 赞同：1
> 
> 时间：2012-04-20T21:11:59.057
> 
> 标签：java, jar, imageicon

我正在尝试解决这个问题。尝试不同的解决方案，但没有任何效果。我正在使用 NetBeans IDE。我创建了一个具有这种结构和文件的项目：

> E:\java\project\ecadpb\src\ecadpb
> 
> 图片文件在
> 
> E:\java\project\ecadpb\src\

我在 Netbeans 中为我的项目指定了工作文件夹`E:\java\project\ecadpb`

我已经创建了这样的图像图标

```
new ImageIcon("device21.png"); 
```

在我的源文件中，它在 Netbeans 中运行项目时运行良好，但是当我单独构建和运行我的 JAR 文件时，图像没有显示。但是图像文件在 JAR 中。

我也尝试过之前提出的相同问题的答案。

```
URL imageUrl=getClass().getResource("device21.png");
new ImageIcon(imageUrl); 
```

但它在我的情况下不起作用。我是第一次构建 JAR 文件。谁能帮我这个！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:51:36.513

一种简单的方法是将图像添加到您的类路径或类路径中的目录中`img`，如下所示：

```
E:\java\project\ecadpb\src\main\java\img\device21.png 
```

然后像这样从这个位置加载你的图像：

```
ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
URL resource = classLoader.getResource("img/device21.png");
ImageIcon icon = new ImageIcon(resource); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-01T03:37:07.533

创建一个名为 Images 的源文件夹（即，如果您使用的是 eclipse，请右键单击您的项目 -> 新建 ->sourceFolder）。随便你怎么称呼它，我叫我的图像。在里面放一些图片。

现在我有了 JLabels，我给了他们 ImageIcons。看下面的代码。

```
 ImageIcon BPawn;
    ImageIcon WPawn;
    JLabel Label = new JLabel[8][8] //2D array of labels that gives each spot a position.
    public void setPieces(){
        //set up pawns in their respective positions.
        BPawn = new ImageIcon("Images/BPawn.png", "BPawn");
        WPawn = new ImageIcon("Images/WPawn.png", "WPawn");
    for(int i=0;i<Label[0].length;i++){
        Label[1][i].setIcon(BPawn);
        Label[6][i].setIcon(WPawn);
    }//end for

    }//end setPieces. 
```

setPieces() 方法中还有更多内容，但这一瞥是当您创建可执行 jar 并希望显示图像时如何引用源文件夹中的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:24:32.117

我认为答案可能是这些建议[之一](https://stackoverflow.com/a/7802956/233306)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T21:34:43.463

我使用了类似的方法，

a) 指定图像文件名的包路径。

b) 确保您的构建脚本没有忽略映像文件，并且它存在于您的 jar 文件中。

# awk - awk：有什么方法可以访问匹配的组吗？

> ID：10253616
> 
> 赞同：7
> 
> 时间：2012-04-20T21:12:12.217
> 
> 标签：awk

我经常发现自己在动作中做与模式相同的匹配，以访问输入记录的某些部分，例如

```
/^Compiled from \"(.*)\"$/ {
    file_name = gensub("^Compiled from \"(.*)\"$", "\\1", "g");
    print file_name;
} 
```

所以正则表达式匹配进行了两次。有什么方法可以`\\1`在不匹配的情况下访问操作？

我正在尝试减少模式匹配和额外代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T23:25:46.523

不幸的是，GAWK 没有`sed`使用空`//`.

```
sed '/\(patt\)ern/ {s//new\1/}' inputfile 
```

但是，您可以高兴，因为最近发明了变量并且它们可以用于此目的！

```
BEGIN {
    pattern = "^Compiled from \"(.*)\"$"
}
$0 ~ pattern {
    file_name = gensub(pattern, "\\1", "");
    print file_name;
} 
```

# java - 使用正则表达式提取字符串

> ID：10253620
> 
> 赞同：0
> 
> 时间：2012-04-20T21:12:40.727
> 
> 标签：java, android, regex, string

我正在尝试从以下内容中提取值“app_name”和“这是一个很棒的应用程序”，但不知道我该怎么做。我无法弄清楚这个的正则表达式。

这是我的输入的样子：

```
<string name = "app_name"> This is a great app </string> 
```

这不是从 Strings.xml 读取值到 Android 中的 Java 代码的努力。这是一个完全不同的情况，我只想打印出这些值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:17:38.697

```
/<string name="([^"]+)">([^<]+)<\/string>/i 
```

名称属性 ( `app_name`) 将存储在反向引用 1 中，实际字符串值 ( `This is a great app`) 将存储在反向引用 2 中。

有了更多信息，可以修改此正则表达式以在更多情况下工作，但在提供的信息有限的情况下，它可以工作，但可能并非在所有情况下都有效。

# error-handling - 全局 asax 中的应用程序错误事件未因无扩展 404 错误而触发

> ID：10253621
> 
> 赞同：1
> 
> 时间：2012-04-20T21:12:47.443
> 
> 标签：error-handling, iis-6, http-status-code-404

我目前正在运行带有 IIS 6 的 asp.net webforms .net 3.5。

我尝试为所有类型的错误创建自定义错误页面，并根据错误类型和状态代码（如果存在）创建自定义处理程序。

现在，在 cassini 上，一切都在本地运行良好。但是，当我将它部署到运行 IIS6 的开发框时，404 错误**不会命中**global.asax 中的 application_error 事件。相反，它通过了我对错误处理的尝试，并直接进入 IIS 为 404 定义的自定义错误页面。

我目前有一个带有通配符的 IIS6 设置，可以通过 .NET dll 传递所有内容，就像设置了 cassini 一样。

我非常困惑为什么这不会像在本地一样发生在 dev 上。任何人都可以插话并提供帮助吗？提前致谢。

ps

这是我的网络配置。我没有使用内置的错误处理，除了打开/关闭我的处理，并捕获我的错误处理中的任何错误：

```
<customErrors mode="On" defaultRedirect="~/error.htm" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T10:44:25.477

将 IIS 中的 404 处理程序设置为指向**不存在**的 aspx 文件。这将触发所有 404 的 Application_Error。

# ajax - Yii importcsv 模块头疼

> ID：10253625
> 
> 赞同：1
> 
> 时间：2012-04-20T21:13:38.280
> 
> 标签：ajax, yii

我安装了 importcsv 模块，并且 importcsv 页面加载正常。当我加载[url - https://web/importcsv时出现文件上传按钮](https://web/importcsv)

我上传了一个文件，出现了 ajax“加载”文本，但是 ajax 响应结果是我网站的整个布局和默认的 importcsv 上传页面，而不是我假设应该加载到 importCsvFirstStepResult div （ “下一步”字段），在 download.js 中的 ajax 请求完成后

```
 ...
   onComplete : function(file, response) {
        this.enable();
        $("input#fileName").val(file);
        $("div#importCsvFirstStepResult").html(response);
    } 
```

/importcsv/default/upload ajax 响应显然包含错误的布局，未能检测到请求，或者 ???? 并将默认视图加载到响应 div、菜单和所有内容中。我对 Yii 很陌生，所以也许这很明显有人在那里。

感谢你的协助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T15:31:09.353

解决了我自己的问题。ajax 问题是由于我调整（破坏）了我的 urlManager 规则。我更改了原始规则以适应表上的非数字主键。例如，查看患者的 url 将是[https://web/patients/view/ABC_1234](https://web/patients/view/ABC_1234)而不是[https://web/patients/view/1234](https://web/patients/view/1234)

我倾向于尽可能使用现有的数据库架构，并且我的客户数据库架构现在设置的方式，他们使用的是非数字主键。由于某些原因，我想继续这样做，所以我不得不编辑 url 参数，因为 \d 只匹配数字。不幸的是，将其更改为 \w 也匹配了一些 ajax 请求并破坏了整个事情。

Yii 原始规则。工作正常，但不适用于字母数字主键：

```
 'rules'=>array(
                '<controller:\w+>/<id:\d+>'=>'<controller>/view',
                '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
                '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
            ), 
```

首先，我将其更改为以下内容，以处理字母数字外键，但这破坏了一些 ajax：

```
'rules'=>array(
                '<controller:\w+>/<action:\w+>/<id:\w+>'=>'<controller>/<action>',
                '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
                '/gii'=>'/gii/default/login',
        ), 
```

终于到了以下，它允许 ajax 模块正常运行，并处理我的非数字键：

```
'rules'=>array(
   '/libraries/<action:\w+>/<id:\w+>'=>'/libraries/<action>',
   '/patients/<action:\w+>/<id:\w+>'=>'/patients/<action>',
   '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
   '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
), 
```

我最终明确地为需要它的控制器设置了规则。他们中的大多数使用整数主键

希望这对其他人有帮助。我是 Yii 的新手，在更改规则时对 Yii 中的规则和 ajax 系统并不完全了解。

干杯

# c - TCP 客户端针对特定图像 (.bmp) 失败

> ID：10253630
> 
> 赞同：0
> 
> 时间：2012-04-20T21:14:25.987
> 
> 标签：c, sockets, tcp, wireshark, tcpdump

我有一个简单的 c 程序来使用 TCP 从服务器复制图像

问题是它总是无法处理某些图像，它只接收“x”字节然后超时。

该程序不是这里的问题，因为我已经尝试使用 TCP 使用不同的程序（C 和 python 使用更大的 recv 缓冲区），但它们仍然在第 x 个字节处失败。

```
server: vxworks 
client: linux 
```

如果我尝试使用相同的代码从 SUN 客户端连接，则接收图像没有问题。我做了一些数据包嗅探，发现我的客户端正在请求数据包“A”，其中包含“x”字节。服务器发送或重新发送它，但客户端永远不会确认它并最终超时。

**问题是为什么这张图片是特定的？并且只发生在linux客户端上？**

写入客户端的文件总是'x'字节长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:17:28.773

对我来说，这看起来像是网络问题。包的大小是多少？听起来很奇怪，但它不会是服务器和 linux 之间的 MTU 黑洞吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:52:47.090

我的朋友曾经遇到过同样的问题，结果证明他传输的二进制图像的有效负载在一路上触发了过滤路由器中的错误。当特定的字节序列通过时，该路由只会断开连接。离奇但真实。

# c++ - 通过#include将文件内容分配给char数组

> ID：10253636
> 
> 赞同：0
> 
> 时间：2012-04-20T21:14:47.193
> 
> 标签：c++, include, char, stringify

我想在 C++ 中执行以下操作：

```
static const char* data[] = { #include "mydata.hh" }; 
```

其中 mydata.hh 的内容应该作为 char 数组分配给数据。我已经通过#x 尝试了#include 的各种变体和（一级和二级）字符串化。到目前为止都没有工作。这实际上是可能的还是我错过了什么？

提前谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T21:21:42.230

你可以：

```
static const char* data[] = {  // <--- new line 
#include "mydata.hh" 
};   // <--- don't forget semi-colon 
```

但为什么？

这一切都假设`mydata.hh`包含与声明兼容的内容：

```
//mydata.hh
"bla", "goo", "foo" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:23:40.253

预处理器仅适用于以可选空格开头的语句，`#`因此您需要将 #include 放在单独的行上。

例子：

```
static const char* data[] = {
#include "mydata.hh"
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:26:26.790

在 include 指令周围换行。您所有的字符都必须在“标题”内用逗号分隔。然后您的代码将被成功编译。尽管我确信这种编程风格看起来很糟糕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T21:27:12.273

我认为重点是预处理器查找 # 代码然后执行指令，# 之间的点，您可以尝试将 #include "" 作为单独的行。考虑到，预处理只是一个文本解析器

```
static const char* data[] = { 
        #include "mydata.hh" 
} 
```

# iphone - 通过电子邮件发送使用 ImagePickerController 拍摄的照片？

> ID：10253638
> 
> 赞同：0
> 
> 时间：2012-04-20T21:14:57.063
> 
> 标签：iphone

在我的应用程序中，我想：a.）向用户展示相机以拍照 b.）创建电子邮件并附加拍摄的照片

我想好怎么拍照了。但是，我不知道如何将其附加到电子邮件中。在我看到的示例中，文件名是已知的。这是一个例子。

```
picker.mailComposeDelegate = self;
     [picker setSubject:@"I have a pencil for you"];

     UIImage *roboPic = [UIImage imageNamed:@"RobotWithPencil.jpg"];
     NSData *imageData = UIImageJPEGRepresentation(roboPic, 1);
     [picker addAttachmentData:imageData mimeType:@"image/jpg" fileName:@"RobotWithPencil.jpg"];

     NSString *emailBody = @"This is a cool image of a robot I found.  Check it out!";
     [picker setMessageBody:emailBody isHTML:YES];

     [self presentModalViewController:picker animated:YES]; 
```

我从回调方法获取图像，它确实存储在相机胶卷中。

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {

    // Access the uncropped image from info dictionary
    UIImage *image = [info objectForKey:@"UIImagePickerControllerOriginalImage"];
    [picker dismissModalViewControllerAnimated:TRUE];
    [picker release];
     } 
```

但是从那里开始，我不确定如何将图像附加到电子邮件中？主要是因为不知道使用UIImagePickerController相机源获取照片时，将照片添加到相机胶卷时的文件名是什么？

所以，我想我需要：a.）找到一种方法来获取图像文件的名称，一旦它被保存或 b.）另一种方法将 UIImage 数据作为电子邮件附件附加。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T01:54:07.923

也许我不明白您在 UI 方面尝试做什么，但为什么这不能从您的代码提供：

编辑：（更改代码以使用委托）

```
- (void)imagePickerController:(UIImagePickerController *)imagepicker didFinishPickingMediaWithInfo:(NSDictionary *)info {

// Access the uncropped image from info dictionary
UIImage *image = [info objectForKey:@"UIImagePickerControllerOriginalImage"];
if([delegate respondsToSelector:@selector(didSelectImage:)])
     [delegate didSelectImage:image];
 } 
```

这在你的头文件中（通常在你的类声明之上）：

```
@protocol PostHelperDelegate <NSObject>

@optional
- (void)DimissModal;
//image data for image selected
- (void)DidSelectImage:(UIImage*)image;
@end 
```

您还需要在您的班级中创建此属性

```
@property(nonatomic,assign)id<PostHelperDelegate>* delegate; //don't forgot to synthizie 
```

然后在实现委托的类中，您将为您的类分配委托：

```
 Poster = [[delegateclass alloc] init];
    Poster.delegate = self; 
```

然后只需添加委托功能：

```
 - (void)DidSelectImage:(UIImage*)image
 {
   //handle image here
 } 
```

我简化了很多，让我知道如果你有任何问题让它工作

[http://www.roostersoftstudios.com/2011/04/12/simple-delegate-tutorial-for-ios-development/](http://www.roostersoftstudios.com/2011/04/12/simple-delegate-tutorial-for-ios-development/)

更新前：

就我个人而言，我会使用代表来通知图像已被选中，然后启动邮件选择器，但那是另一回事。就 UIImage 而言，我不知道一种方法或从未找到一种方法来命名/或从 UIImagePicker 获取名称，因为我不相信它们被命名为任何有意义的东西。有关代表的任何问题或进一步的解释，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T09:56:25.450

使用下面的代码

```
 -(void)yourmethodname_clicked{
        UIImagePickerController * picker = [[UIImagePickerController alloc] init];
                picker.delegate = self;
        if([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera])  {
                 picker.sourceType = UIImagePickerControllerSourceTypeCamera;
                 [self presentModalViewController:picker animated:YES];
        }
        else{
                 UIAlertView *altnot=[[UIAlertView alloc]initWithTitle:@"Camera Not            Available" message:@"Camera Not Available" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];

                 [altnot show];
                 [altnot release];

        }
    }

- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {
[picker dismissModalViewControllerAnimated:YES];

MFMailComposeViewController *mailpicker = [[MFMailComposeViewController alloc] init];

    [mailpicker.navigationBar setTintColor:[UIColor blackColor]];
    mailpicker.mailComposeDelegate = self;

    [mailpicker setSubject:@"set your subject"]; 

    NSArray *toRecipients = [NSArray arrayWithObjects: nil];

    [mailpicker setToRecipients:toRecipients];

    UIImage *picture = [info objectForKey:@"UIImagePickerControllerOriginalImage"]];;

    NSData *imageData = UIImagePNGRepresentation(picture);
    [mailpicker addAttachmentData:imageData mimeType:@"image/png" fileName:@"set your file name"];

    NSString *emailBody = @"set your body string";
    [mailpicker setMessageBody:emailBody isHTML:YES];
    [mailpicker setSubject:@"set your subject"];
    mailpicker.title = @"Email";

    [self presentModalViewController:mailpicker animated:YES];
    [mailpicker release];
} 
```

这可以帮助你吗

# javascript - 检查表单输入的文本并更改其颜色

> ID：10253645
> 
> 赞同：3
> 
> 时间：2012-04-20T21:15:42.097
> 
> 标签：javascript, html, forms, validation

在这里，我有一个无法解决的问题。这是代码，我希望脚本在输入的文本更改时更改表单输入的颜色：

```
function checkName(name)
{
if (name.value == "value1" || name.value == "value2" || name.value == "value3" || name.value == "value4" || name.value == "value5" || name.value == "value6"){
 document.forms['un'].elements['name'].style.color='#ffbb00'
}
else {
 document.forms['un'].elements['name'].style.color='#000000'
}
} 
```

正如您所看到的，当输入的文本与提供的文本之一匹配时，它应该变成橙色，如果不匹配，它应该是黑色的。（我有一个用 onChange 切换这个函数的输入）我只是不能让它工作，所以我可以有多种选择何时改变颜色，并且当语句变得无效时也可以改变回来。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:23:27.163

试试这个：

```
function checkName(element) {
    if (element.value == ...) {
        element.className = "inputError";
    } else {
        element.className = "";
    }
} 
```

然后在你的 CSS 文件中：

```
.inputError {
    background-color: #FF0000;
    background-image: url(exclamation_mark.png);
    background-position: right 50%;
    background-repeat: no-repeat;
    background-size: contain;
    -moz-background-size: contain;
    -webkit-background-size: contain;
    -o-background-size: contain;
} 
```

现在您已经预定义了输入框的 CSS 样式，每次检查输入框时都可以将其设置为适当的 CSS 类名称。

现在你所要做的就是：

```
<input id="myTextBox" type="text" onkeyup="javascript: checkName(this);" /> 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:26:15.113

`I have an input toggling this function with an onChange thing` so your Input

```
<input type=text size=20 name='name' onchange="checkName(this)"> 
```

and function could be

```
function checkName(el)
{
    if (el.value == "value1" || el.value == "value2" || el.value == "value3" || el.value == "value4" || el.value == "value5" || el.value == "value6")
    {
        el.style.color='#ffbb00'
    }
    else
    {
        el.style.color='#000000'
    }
} 
```

[**An example.**](http://jsfiddle.net/heera/F3SQC/1/)

You may also try `onkeyup` like [**this example**](http://jsfiddle.net/heera/F3SQC/2/).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T21:24:56.853

您假设文本框中的值自动传递给函数 checkName。我相信这是你的错误。

您可以`checkName`使用引用函数内文本框中的值`event.srcElement.value`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T21:25:24.797

# apache-camel - 如何将 Apache Camel 同步请求/回复端点与异步子路由连接

> ID：10253656
> 
> 赞同：4
> 
> 时间：2012-04-20T21:17:04.273
> 
> 标签：apache-camel

我想将 web 服务请求路由到 jms 队列的 InOnly 端点。然后将从单独的 InOnly 端点接收到的响应 jms 消息路由回 Web 服务客户端作为响应。Web 服务请求/响应是同步的 InOut 模式，子路由是异步的。我有哪些选择可以使用 Camel 实现这一目标？

这里的骆驼路线是用来解释我的问题的：

```
String uri={webserice uri}
from(uri)    
    .process(new Processor() {
        public void process(Exchange exchange) throws Exception {
            ServcieRequest req =            
            exchange.getIn().getBody(ServcieRequest.class);                 
            // One option to me is to spawn another route here to route to jms queue...         
            ProducerTemplate template = exchange.getContext().createProducerTemplate();
            template.sendBodyAndHeaders("jms:queue:INQueue", req.getPayload(), headers);
            // then need to wait ...until received jms response from the route below        

   }});

from("jms:queue:OUTQueue")
   .process(new Processor() {
       public void process(Exchange exchange) throws Exception {
           // received jms response message
           // need to update the exchange data in the above route based on jms message
           // so the final response to the webservice cilent can receive the data ...
       }}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:35:04.327

我认为您应该依靠 Camel 中的请求回复机制来完成此任务。 [Camel Doc，专属固定回复队列](http://camel.apache.org/jms.html#JMS-RequestreplyoverJMSandusinganexclusivefixedreplyqueue)

所以我猜下面的 DSL 路由几乎可以满足您的需求（如果没有其他原因为什么您应该为 JMS 部分使用 InOnly 模式？）。如果需要，请确保调整 requestTimeout（因为它默认为 20 秒超时）。

```
from(webserviceURI)
  .inOut().to("jms:queue:INQueue?replyTo=OUTQueue?replyToType=Exclusive"); 
```

是的，另一件事。如果您在多个节点上运行此程序，则每个节点需要一个独占队列。

# iphone - 将 UISlider 用于离散值可能是滥用和被应用商店拒绝的原因吗？

> ID：10253657
> 
> 赞同：1
> 
> 时间：2012-04-20T21:17:10.067
> 
> 标签：iphone, interface-builder, app-store, appstore-approval

我正在使用 UISlider 从一组 12 个中选择不同的变体（香水给你一个想法）。滑块大约是屏幕宽的一半（在 iPhone 上）。与在精度不那么重要时选择连续值相比，我想用户可能难以选择特定的变体。我选择滑块是因为它更统一，而且选择器会占用太多空间。这可能是苹果商店拒绝应用程序的原因吗？（我还没有提交。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T23:00:56.607

几乎肯定没问题。选择是离散的还是连续的？沿着连续体的一组离散选择可能是滑块的一个很好的应用，但有几点需要注意：

1）如果选项真的是离散的，在拖动到最近的选项后调整滑动位置 - 就像滚动视图中的分页一样。

2) 左侧的蓝色填充表示数量增加。你的型号有吗？例如，假设菜单上有四种饮料尺寸，离散位置代表客户可以订购的尺寸，从最小到最大。这里的蓝色条告诉你杯子里有多少饮料（如果你将它旋转 90 度以填充到 y==0 会更冷）。但是如何选择季节：（春夏秋冬）？在连续体上肯定有一个离散的选择，但蓝色填充是什么意思？一年中的几天？并不真地。

在季节性选择实例中，我很想编写自己的滑块，就像 Apple 的一样，但没有蓝色填充。再说一次，一旦您决定自定义构建，您就可以减少受标准控件的影响。

这是我的轶事，不要列出 Apple 批准（大多数情况下不会）：不要崩溃，不要调用私有 api，不要进行演示 + 追加销售，不要侵犯版权，不要干扰苹果的商业目标——比如在商店外销售附加内容，做一些很酷很简单的事情。

但轻微的滑块滥用不在我的清单上。祝你好运。

# javascript - 在窗口外拖动时如何检测Firefox中的dragleave事件

> ID：10253663
> 
> 赞同：36
> 
> 时间：2012-04-20T21:17:28.150
> 
> 标签：javascript, jquery, html, drag-and-drop

Firefox 在窗口外拖动时没有正确触发 dragleave 事件：

[https://bugzilla.mozilla.org/show_bug.cgi?id=665704](https://bugzilla.mozilla.org/show_bug.cgi?id=665704)

[https://bugzilla.mozilla.org/show_bug.cgi?id=656164](https://bugzilla.mozilla.org/show_bug.cgi?id=656164)

我正在尝试为此开发一种解决方法（我知道这是可能的，因为 Gmail 正在这样做），但我唯一能想到的似乎真的很老套。

知道何时在窗口外拖动的一种方法是等待`dragover`事件停止触发（因为`dragover`在拖放操作期间会不断触发）。我是这样做的：

```
var timeout;

function dragleaveFunctionality() {
  // do stuff
}

function firefoxTimeoutHack() {
  clearTimeout(timeout);
  timeout = setTimeout(dragleaveFunctionality, 200);
}

$(document).on('dragover', firefoxTimeoutHack); 
```

这段代码本质上是一遍又一遍地创建和清除超时。`dragover`除非事件停止触发，否则不会达到 200 毫秒超时。

虽然这可行，但我不喜欢为此目的使用超时的想法。感觉不对。这也意味着在“dropzone”样式消失之前会有一点延迟。

我的另一个想法是检测鼠标何时离开窗口，但是在拖放操作期间，这样做的正常方法似乎不起作用。

有没有人有更好的方法来做到这一点？

**更新：**

这是我正在使用的代码：

```
 $(function() {
          var counter = 0;
          $(document).on('dragenter', function(e) {
            counter += 1;
            console.log(counter, e.target);
          });
          $(document).on('dragleave', function(e) {
            counter -= 1;
            console.log(counter, e.target);
          });
        });
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<p>Open up the console and look at what number is reporting when dragging files in and out of the window. The number should always be 0 when leaving the window, but in Firefox it's not.</p>
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-04-25T07:00:57.410

我找到了解决方案。问题不在于`dragleave`事件没有触发；相反，`dragenter`当第一次将文件拖到窗口中时（有时在拖动某些元素时），该事件会触发两次。我最初的解决方案是使用计数器来跟踪最终`dragleave`事件发生的时间，但是`dragenter`事件的双重触发会弄乱计数。（为什么我不能只听`dragleave`你问？嗯，因为它的`dragleave`功能非常相似`mouseout`，它不仅在离开元素时触发，而且在进入子元素时触发。因此，当`dragleave`触发时，你的鼠标很可能仍然在里面原始元素的边界。）

我想出的解决方案是跟踪哪些元素`dragenter`被`dragleave`触发了。由于事件向上传播到文档，因此侦听特定元素`dragenter`和`dragleave`在特定元素上不仅会捕获该元素上的事件，还会捕获其子元素上的事件。

因此，我创建了一个 jQuery 集合`$()`来跟踪在哪些元素上触发了哪些事件。`event.target`每当 dragenter 被触发时，我就将其添加到集合中，并且`event.target`每当 dragleave 发生时，我就从集合中删除。这个想法是，如果集合为空，则意味着我实际上已经离开了原始元素，因为如果我输入的是子元素，那么至少一个元素（子元素）仍会在 jQuery 集合中。最后，当事件被触发时，我想将集合重置为空，以便在下一个事件发生`drop`时准备就绪。`dragenter`

jQuery 还节省了大量额外的工作，因为它会自动进行重复检查，因此`event.target`不会被添加两次，即使 Firefox 错误地重复调用`dragenter`.

呼，无论如何，这是我最终使用的代码的基本版本。如果其他人有兴趣使用它，我已将其放入一个简单的 jQuery 插件中。基本上，您调用`.draghover`任何元素，并`draghoverstart`在第一次拖入元素时`draghoverend`触发，并在拖动实际离开它时触发。

```
// The plugin code
$.fn.draghover = function(options) {
  return this.each(function() {

    var collection = $(),
        self = $(this);

    self.on('dragenter', function(e) {
      if (collection.length === 0) {
        self.trigger('draghoverstart');
      }
      collection = collection.add(e.target);
    });

    self.on('dragleave drop', function(e) {
      collection = collection.not(e.target);
      if (collection.length === 0) {
        self.trigger('draghoverend');
      }
    });
  });
};

// Now that we have a plugin, we can listen for the new events 
$(window).draghover().on({
  'draghoverstart': function() {
    console.log('A file has been dragged into the window.');
  },
  'draghoverend': function() {
    console.log('A file has been dragged out of window.');
  }
}); 
```

**没有 jQuery**

要在没有 jQuery 的情况下处理此问题，您可以执行以下操作：

```
// I want to handle drag leaving on the document
let count = 0
onDragEnter = (event) => {
  if (event.currentTarget === document) {
    count += 1
  }
}

onDragLeave = (event) => {
  if (event.currentTarget === document) {
     count += 0
  }

  if (count === 0) {
    // Handle drag leave.
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T03:23:04.880

根据您希望完成的任务，您可以使用`:-moz-drag-over`仅在 Firefox 中可用的伪类来解决此问题，该伪类可让您对拖动到元素上的文件做出反应。

看看这个简单的演示[http://codepen.io/ryanseddon/pen/Ccsua](http://codepen.io/ryanseddon/pen/Ccsua)

```
.dragover {
    background: red;
    width: 500px;
    height: 300px;
}
.dragover:-moz-drag-over {
    background: green;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-22T20:58:42.307

受@PhilipWalton 代码的启发，我简化了 jQuery 插件代码。

```
$.fn.draghover = function(fnIn, fnOut) {
    return this.each(function() {
        var n = 0;
        $(this).on('dragenter', function(e) {
            (++n, n==1) && fnIn && fnIn.call(this, e);
        }).on('dragleave drop', function(e) {
            (--n, n==0) && fnOut && fnOut.call(this, e);
        });
    });
}; 
```

现在您可以使用 jquery 插件，如 jquery hover 方法：

```
// Testing code 1
$(window).draghover(function() {
    console.log('into window');
}, function() {
    console.log('out of window');
});

// Testing code 2
$('#d1').draghover(function() {
    console.log('into #d1');
}, function() {
    console.log('out of #d1');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-27T12:44:43.150

唯一对我有用并花了我一些时间的解决方案希望这对某人有所帮助！

克隆时请注意，您需要使用事件和数据进行深度克隆：

HTML：

```
<div class="dropbox"><p>Child element still works!</p></div>

<div class="dropbox"></div>

<div class="dropbox"></div> 
```

jQuery

```
$('.dropbox').each(function(idx, el){
    $(this).data("counter" , 0);
});

$('.dropbox').clone(true,true).appendTo($('body');

$('dropbox').on({
    dragenter : function(e){
        $(this).data().counter++;
        <!-- YOUR CODE HERE -->
    },
      dragleave: function(e){

        $(this).data().counter--;

         if($(this).data().counter === 0)
              <!-- THEN RUN YOUR CODE HERE -->
    }
}); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-23T00:34:37.990

```
addEvent(document, "mouseout", function(e) {
    e = e ? e : window.event;
    var from = e.relatedTarget || e.toElement;
    if (!from || from.nodeName == "HTML") {
        // stop your drag event here
        // for now we can just use an alert
        alert("left window");
    }
}); 
```

这是从[我如何检测鼠标何时离开窗口？](https://stackoverflow.com/questions/923299/how-can-i-detect-when-the-mouse-leaves-the-window). addEvent 只是跨浏览器 addEventListener。

# django - 新模型条目的关键字参数无效

> ID：10253668
> 
> 赞同：0
> 
> 时间：2012-04-20T21:17:55.747
> 
> 标签：django, django-models

我有以下模型：

```
class mark(models.Model):
    title=models.CharField(max_length=35)
    url=models.URLField(max_length=200)
    user=models.ManyToManyField(User,blank=True) 
```

然后我使用一个表单将一些数据保存到数据库中。我在保存数据的视图中的代码是：

```
new_mark= mark(url=request.POST['url'],
                           title=request.POST['title'],
                           user=request.user)
new_mark.save() 
```

当然，我有所有的数据验证、登录所需的验证等。当我运行它时，它会给我带来意想不到的结果

```
'user' is an invalid keyword argument for this function 
```

上`user=request.user)`线。有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:24:54.217

请提供整个回溯并确保您的视图没有名为“mark”等的函数（您可能还想更改`mark`为`Mark`遵循 Python 和 Django 样式指南。）在行`print type(mark)`前进行测试。`"new_mark = …"`

此外，我不是 100% 确定 ManyToMany 字段是否允许这样的设置数据，例如尝试：

```
new_mark= mark(url=request.POST['url'],
                       title=request.POST['title'])
new_mark.user.add(request.user)
new_mark.save() 
```

由于它是一个 m2m 字段，您可能希望将该字段重命名为用户。

# javascript - 如何获取用户上传的.PDF的页数？

> ID：10253669
> 
> 赞同：15
> 
> 时间：2012-04-20T21:18:02.337
> 
> 标签：javascript, jquery, pdf, jquery-plugins, adobe

我有一个文件输入，在“上传”之前，我需要在 JAVASCRIPT 中计算该 .pdf 的页数（例如 JQuery ...）

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2014-05-30T18:08:51.850

如果您使用 pdf.js，您可以参考[github 上的示例](https://github.com/mozilla/pdf.js/blob/master/examples/node/getinfo.js)（'.../examples/node/getinfo.js'），并使用以下代码打印 pdf 文件中的页数。

```
const pdfjsLib = require('pdfjs-dist');
...
pdfjsLib.getDocument(pdfPath).then(function (doc) {
    var numPages = doc.numPages;
    console.log('# Document Loaded');
    console.log('Number of Pages: ' + numPages);
}) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-08-30T08:41:33.107

和一个纯javascript解决方案：

```
var input = document.getElementById("files");
var reader = new FileReader();
reader.readAsBinaryString(input.files[0]);
reader.onloadend = function(){
    var count = reader.result.match(/\/Type[\s]*\/Page[^s]/g).length;
    console.log('Number of Pages:',count );
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T21:34:32.517

正如其他答案中所述，您正在寻找类似 pdf.js 的内容。我查看了 API，它确实包含一个 numPages() 函数来返回总页数。[从 Mozilla](http://mozilla.github.com/pdf.js/web/viewer.html)查看演示页面时，它似乎也为我计算页面。

这取决于您是否能够为您的解决方案使用现代浏览器和实验技术。pdf.js 非常令人印象深刻，但根据[github 页面](https://github.com/mozilla/pdf.js)，它仍然是实验性的。

如果您能够在上传后计算服务器上的页面，那么您应该查看[pdftools](http://manpages.ubuntu.com/manpages/jaunty/man1/pdftools.1.html)或类似的。

像`pdftools --countpages`你正在寻找的东西

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-23T21:21:09.817

你也可以使用`pdf-lib`.

您将需要从输入字段中读取文件，然后使用它`pdf-lib`来获取页数。代码将是这样的：

```
import { PDFDocument } from 'pdf-lib';

...

const readFile = (file) => {

  return new Promise((resolve, reject) => {

    const reader = new FileReader();

    reader.onload = () => resolve(reader.result);
    reader.onerror = error => reject(error);

    reader.readAsArrayBuffer(file);
  });
}

const getNumPages =async (file) => {

  const arrayBuffer = await readFile(file);

  const pdf = await PDFDocument.load(arrayBuffer);

  return pdf.getPages();
} 
```

然后只需获取附件的页数：

```
const numPages = await getNumPages(input.files[0]); 
```

是`input`存储对文件输入的 DOM 元素的引用的变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-07T04:26:37.100

我认为自从 Tracker1 发布答案以来，API 发生了一些变化。我尝试了 Tracker1 的代码并看到了这个错误：

```
Uncaught TypeError: pdfjsLib.getDocument(...).then is not a function 
```

一个小改动解决了它：

```
const pdfjsLib = require('pdfjs-dist');
...
pdfjsLib.getDocument(pdfPath).promise.then(function (doc) {
    var numPages = doc.numPages;
    console.log('# Document Loaded');
    console.log('Number of Pages: ' + numPages);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-29T13:25:12.030

在使用 Pdf-lib 的打字稿类中，我使用以下内容。

```
// getPAGE COUNT:
  async getPageCount(formUrl: any): Promise<number>{
    const LogPdfFields = [] as any[];
    const formPdfBytes = await fetch(formUrl).then((res) => res.arrayBuffer());
    const pdfDoc = await PDFDocument.load(formPdfBytes);
    const pageCount = pdfDoc.getPageCount();
    return pageCount;
  }
```

打电话作为承诺

# assembly - 为什么EAX的内容不同？

> ID：10253674
> 
> 赞同：0
> 
> 时间：2012-04-20T21:18:36.720
> 
> 标签：assembly, x86, masm

我有两种组装方法：

1.  `DWToHex PROTO:DWORD``DWORD`将作为输入参数内部传递的类型的二进制整数修改`EAX`为十六进制表示，指向在单个参数内部传递的指针。它是用于调试目的的功能，它工作正常。
2.  `ProcA PROTO:DWORD`- 除了破坏下面的内容之外什么都不做`EAX`是代码：（ **抱歉格式化 -c 似乎常规代码格式化在这里不起作用）**

; ################################################# #######################

```
`.386                       ; set processor type`
`.model flat, stdcall       ; memory model & calling convention`
`option casemap :none       ; case sensitive`

`.code` 
```

; ################################################# #######################

```
procA public addrSTD:DWORD

ret

ProcA   endp 
```

; ################################################# #######################

```
end 
```

**这是调试跟踪：**

```
.data

MsgBoxCaption4 db  "before calling", 0
MsgBoxCaption5 db  "after   calling", 0

.data?

N       DWORD   ?
NTXT        db 16 dup(?)

.code

mov eax, N
invoke  cx_DWToHex, addr NTXT
invoke  MessageBox, NULL, addr NTXT, addr MsgBoxCaption4, MB_OK ; show eax as hexadecimal

mov eax, N                      ;   ***** point A ****
invoke  ProcA, addr sdt         ;   ***** point B ****
;   mov eax, N
invoke  cx_DWToHex, addr NTXT
invoke  MessageBox, NULL, addr NTXT, addr MsgBoxCaption5, MB_OK ; show eax as hexadecimal 
```

..................................................... .........................................................

**问：** 为什么`EAX`in点A点和B点的内容不一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:35:25.340

`invoke`您用于调用的指令`ProcA`应该获取“sdt”的地址，并将其压入堆栈。很可能，它生成的代码类似于

```
lea eax, sdt
push eax
call ProcA 
```

这会破坏`eax`. 您可以通过查看生成的代码的反汇编来验证这一点。

# jquery - 使 CSS3 渐变背景旋转

> ID：10253675
> 
> 赞同：3
> 
> 时间：2012-04-20T21:18:38.993
> 
> 标签：jquery, animation, css, webkit, gradient

我在一个项目上设置了 CSS3 背景渐变，我想让它慢慢旋转。我只是从 CSS3 和 HTML5 开始（请注意，我使用 CSS 和 HTML 已经 15 年了，不过还有很多新东西）。是否可以只旋转背景，而不是实际元素？

**（删除页面链接，因为它不再存在）**它是背景渐变，即使它在文本的前景上，也必须喜欢背景剪辑）；我不希望文本旋转，但我确实希望背景旋转。此外，这仅适用于 webkit 浏览器。

我愿意使用任何脚本来完成它——HTML5 画布、CSS3 转换、Javascript/jQuery 等（尽管保持纯 CSS3 会很棒）。但是，我试图避免使用任何图像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:58:40.103

您可以通过使用 JavaScript 为 CSS 属性设置动画来做到这一点。这是一个使用一点 jQuery 来轻松更改 CSS 的示例：

演示：http: [//jsfiddle.net/HYDAj/2/](http://jsfiddle.net/HYDAj/2/)

基本上，我使用`setInterval`每 100 毫秒更改一次渐变角度。我无法让你的特定渐变工作，这个例子只适用于 WebKit 浏览器，但这会让你开始。

我还应该指出，WebKit 是唯一支持“背景剪辑：文本”的，所以这是它在 Firefox 或 IE 中不起作用的另一个原因。

如果您不想使用任何 jQuery，这里是纯 JavaScript 方式：

[http://jsfiddle.net/HYDAj/3/](http://jsfiddle.net/HYDAj/3/)

# php - 在多维数组中搜索特定键并输出它们的数据

> ID：10253682
> 
> 赞同：1
> 
> 时间：2012-04-20T21:19:04.743
> 
> 标签：php, arrays, loops, multidimensional-array, foreach

我有以下数组构造：`$array[$certain_key][some_text_value]`

在一个while循环中，我想打印数组中的数据，其中`$certain_key`是一个特定的值。

我知道如何循环遍历多维数组，这不是这个问题的完整解决方案：

```
foreach ($a as $v1) {
    foreach ($v1 as $v2) {
        echo "$v2\n";
    }
} 
```

我不想每次都循环整个数组，但只有在`$certain_key`匹配时才循环。

**编辑：**更准确地说，这就是我想要做的：

```
$array[$array_key][some_text];

while reading from db {

  //print array where a value returned from the db = $array_key

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:21:35.517

```
while ($row = fetch()) {
   if (isset($array[$row['db_id']])) {
      foreach ($array[$row['db_id']] as $some_text_value => $some_text_values_value) {
         echo ...
      }
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:21:56.113

```
foreach ($array as $certain_key => $value) {
    if($certain_key == $row['db_id']) {
        foreach ($value as $some_text_value) {
            echo "$v2\n";
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T21:22:21.450

你的意思是喜欢

```
foreach($array[$certain_key] as $k => $v)
{
     do_stuff();
} 
```

?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T21:21:23.307

也许你正在寻找[`array_key_exists`](http://php.net/array_key_exists)？它是这样工作的：

```
if(array_key_exists($certain_key, $array)) {
   // do something
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T21:23:38.570

```
<?php

foreach ($a as $idx => $value) {
    // replace [search_value] with whatever key you are looking for
    if ('[search_value]' == $idx) {
        // the key you are looking for is stored as $idx
        // the row you are looking for is stored as $value
    }
} 
```

# couchdb - 通过 api 在 couchdb 1.2 中更改密码？

> ID：10253685
> 
> 赞同：5
> 
> 时间：2012-04-20T21:19:23.273
> 
> 标签：couchdb

有谁知道我是否可以在 couchdb 1.2 中更改密码？要*创建*一个用户，我有一个获取用户信息的表单，然后像这样发布到 _users 数据库（下面的 url 中的“用户”是代理的）：

```
// Create a user
var userObj = {
     _id: "org.couchdb.user:test",
     type: "user",
     name: "test",
     roles: ["user"],
     emailAddress: "test@testy.com",
     firstName: "Test",
     lastName: "Test",
     password: "password"
};
$.ajax({
    url: "/users/org.couchdb.user:test",
    type: "PUT",
    dataType: "json",
    contentType:"application/json",
    data: JSON.stringify(userObj)
}); 
```

Couchdb 1.2 为我生成密码哈希和盐并存储用户。它工作得很好。要更新密码，我尝试检索用户，删除 password_sha 和 salt 字段，添加密码字段，然后重新发布文档。我希望 Couch 能为我重新计算 password_sha 和 salt 字段并更新文档，但事实并非如此。password_sha 和 salt 字段未更新。

```
// Update a user
$.get("/users/org.couchdb.user:test")
.done(function(userDoc){
  delete userDoc.password_sha;
  delete userDoc.salt
  userDoc.password = "test";
  $.ajax({
    url: "/users/org.couchdb.user:test",
    type: "PUT",
    dataType: "json",
    contentType:"application/json",
    data: userDoc
  });
}); 
```

我怀疑沙发只会在创建文档时生成 password_sha 和 salt 字段。如果是这种情况，我是否应该只生成自己的 password_sha 和 salt 字段并将它们发布在更新的文档中？我在这里错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T20:43:31.177

没关系。我试图更新一个 JSON 字符串……doh！只需要解析userDoc，添加密码，然后重新提交即可。

# svn - svn 发布者 jenkins 插件使用

> ID：10253687
> 
> 赞同：1
> 
> 时间：2012-04-20T21:19:40.657
> 
> 标签：svn, plugins, jenkins

我需要从 ci 服务器备份一些文件（apache 设置、jenkins 设置、tomcat 设置、作业 xml 文件）

我写了一个作业，将一堆文件复制到作业工作区

构建后我想将更改发布到 svn repo

我指定了 url、工作区目录，并且我想要所有文件夹/文件，所以我尝试使用 * * */* .* 作为正则表达式，但事情没有提交任何文件

帮助？

```
SVN Publisher: target: /SYSAPPS/ci/jenkinsjava/jobs/config-backup/workspace
SVN Publisher: Error: target Directory not accessable:  /SYSAPPS/ci/jenkinsjava/jobs/config-backup/workspace
Notifying upstream projects of job completion
Finished: SUCCESS 
```

# c# - 这个正则表达式是如何工作的？

> ID：10253695
> 
> 赞同：0
> 
> 时间：2012-04-20T21:20:01.287
> 
> 标签：c#, regex

```
string line = @"George\t15\tStudent\tAddress\tB:\temp\profilepic.png";

string[] results = Regex.Split( line, @"(?<![a-zA-Z]:)\\t" ) 
```

它产生这个列表：

```
George
15
Student
Address
B:\temp\profilepic.png 
```

但我无法理解它是如何工作的，尤其是我找不到有关“<”运算符的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:24:58.677

`<`在这种情况下，它本身不是运算符。它是 `(?<!)`构造的一部分，它执行[负面的lookbehind](http://www.regular-expressions.info/lookaround.html)。负向后看可能是一个棘手的概念，我个人认为它属于“高级正则表达式”的范畴。

`(?<!`开始组并`)`关闭它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T21:26:16.430

`?<!`是一个否定的后向断言。此表达式转换为“查找一个`\t`不紧跟在字母和冒号前面的字符”。

# ruby-on-rails - Rails 3.1+ 简单嵌套表单验证和 Twitter Bootstrap 控件状态

> ID：10253697
> 
> 赞同：0
> 
> 时间：2012-04-20T21:20:04.927
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, twitter-bootstrap, nested-attributes, simple-form

我需要一些帮助来正确处理 Twitter Bootstrap 的验证。验证工作正常，问题是 Twitter Bootstrap Flash 屏幕。这就是我的意思：

未填写任何字段并提交退货：http: [//i.stack.imgur.com/8pvUc.png](http://i.stack.imgur.com/8pvUc.png)

提交的 4 个必填字段中的 2 个返回：http: [//i.stack.imgur.com/J6lCi.png](http://i.stack.imgur.com/J6lCi.png) （注意它不会显示错误）

我有一个篮球应用程序，其中一个球员可以在许多名册上（用于球员名册存档目的），一个名册可以有很多名球员。

**名册.rb**

```
class Roster < ActiveRecord::Base
  belongs_to :team
  has_many :rosterizes
  has_many :players, :through => :rosterizes
  accepts_nested_attributes_for :players
  validates_presence_of :jersey_number, :class_year
  attr_accessible :jersey_number, :class_year, :players, :team_id, :players_attributes
end 
```

**Rosterizes.rb**（名字不好我知道......）

```
class Rosterize < ActiveRecord::Base
  belongs_to :player
  belongs_to :roster
  attr_accessible :player_id, :roster_id
end 
```

**播放器.rb**

```
class Player < ActiveRecord::Base
  has_many :rosterizes
  has_many :rosters, :through => :rosterizes
  validates_presence_of :first_name, :last_name
  attr_accessible :first_name, :last_name, :active
end 
```

**_add_player_form.html.erb** （嵌套形式）

```
<%= simple_nested_form_for @roster, :url =>player_added_team_path, :html => { :class => 'form-horizontal' } do |f| %>   
    <%= f.simple_fields_for :players, @roster.players.build do |x| %>
        <%= x.input :first_name %>
        <%= x.input :last_name %>
        <%= x.input :active, :as => :hidden, :input_html => {:value => true} %>
    <%end%>
    <%=f.input :class_year %>       
    <%=f.input :jersey_number %>
    <%=f.input :team_id, :as => :hidden, :input_html => {:value => params[:id]}%>

    <div class="well">
    <%= f.button :submit, :class => 'btn-primary icon-plus-sign btn-success', :value => "Add To Team" %>
    </div>
<%end%> 
```

我在这里先向您的帮助表示感谢！

**解决方案**

我的问题是每次加载视图时，它都会构建一个新表单，因此永远不会在回滚时恢复错误

我对为嵌套表单构建的控制器进行了更改

**控制器**

```
def add_player
     ...
     @new_player = @roster.players.build
end 
```

并根据视图进行相应的更改

**_add_player_form.html.erb**

```
<%= f.simple_fields_for :players, @new_player do |x| %>
     ...

<%end%> 
```

这成功了，谢谢莫伯！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T15:16:07.153

仅显示第一级验证而不显示关联的原因相当简单...您执行一个`<%= f.simple_fields_for :players, @roster.players.build do |x| %>`在站点呈现时建立关联总是新的关联。您想要的是仅在关联尚不存在时才建立关联...

```
<% @roster.players.build if !@roster.players %>
<%= f.simple_fields_for :player do |player_form| %>
...
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T16:12:19.520

Twitter Bootstrap 实际上并不验证任何东西，它只是为验证类（、、等）提供[样式。](http://twitter.github.com/bootstrap/components.html#alerts)`error``success`

现在，无论如何我都不是 Ruby 专家，但看起来您要提前结束表单：

```
 <%= f.simple_fields_for :players, @roster.players.build do |x| %>
        <%= x.input :first_name %>
        <%= x.input :last_name %>
        <%= x.input :active, :as => :hidden, :input_html => {:value => true} %>
    <%end%>   <---- here
    <%=f.input :class_year %>       
    <%=f.input :jersey_number %>
    <%=f.input :team_id, :as => :hidden, :input_html => {:value => params[:id]}%> 
```

应该是这个？

```
 <%= f.simple_fields_for :players, @roster.players.build do |x| %>
        <%= x.input :first_name %>
        <%= x.input :last_name %>
        <%= x.input :active, :as => :hidden, :input_html => {:value => true} %>        
        <%= f.input :class_year %>       
        <%= f.input :jersey_number %>
        <%= f.input :team_id, :as => :hidden, :input_html => {:value => params[:id]}%>
    <% end %> 
```

# python - Python：为什么打印语句和 subprocess.call() 输出不同步？

> ID：10253698
> 
> 赞同：5
> 
> 时间：2012-04-20T21:20:08.733
> 
> 标签：python, linux, subprocess

我正在运行以下代码（称为batch.py​​）

```
for config in keystoneConfig: 
    cmdlist = generate_cmd_list(config)
    print ' '.join(cmdlist)
    subprocess.call(cmdlist) 
```

并将 batch.py​​ 的输出重定向到另一个文件。IE

> ./batch.py​​ > 输出.txt

但我意识到所有输出`subprocess.call()`都在`print`语句之前。为什么输出不同步？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T21:21:50.323

Python 正在对自己的输出进行块缓冲，而不是在之前刷新它`subprocess.call()`，因为您将其输出重定向到文件而不是控制台；您需要强制行缓冲或禁用缓冲，或在子进程调用之前手动刷新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-04-01T19:43:07.783

`sys.stdout.flush()`在打印之后和进行子流程调用之前刷新。

# ruby-on-rails - 在 Rails 中向全局路由添加要求

> ID：10253702
> 
> 赞同：2
> 
> 时间：2012-04-20T21:20:21.130
> 
> 标签：ruby-on-rails, regex, routing, glob

我有一个关于 Rails 2.3 中全局路由上的正则表达式匹配的问题。这张票解释了我遇到的完全相同的问题： [Rails routes with wildcard and requirements](https://stackoverflow.com/questions/5326679/rails-routes-with-wildcard-and-requirements)

问题是我无法让 :property_types 的正则表达式匹配除属性类型的第一个实例之外的任何内容，并且以某种方式破坏了 :location_b 上的匹配。

因此，仅当删除了 property_types 要求时，以下内容才有效：

**/待售/美国/纽约/公寓/阁楼/布鲁克林/**

```
map.location ":transaction/:country_code/:location_a/*property_types/:location_b",
  :controller => "search",
  :action => "location",
  :transaction => /(for-sale|for-rent|auction|new_development)/i,
  :country_code => /\w\w/i,
  :location_a => /\w\w/i,
  :property_types => /(apartment|loft|home|condo|multi-home|town-house)/i 
```

希望有人能解释我如何让 property_types 的正则表达式工作，因为我不明白它应该如何在一个数组的 glob 床路由上工作。我链接到的票似乎表明可以在每种类型之间进行正则表达式匹配，但我无法使任何工作。

示例网址： [http://localhost:3000/for-sale/us/ny/apartment/loft/brooklyn](http://localhost:3000/for-sale/us/ny/apartment/loft/brooklyn)

# python - 鼠标控制没反应

> ID：10253707
> 
> 赞同：1
> 
> 时间：2012-04-20T21:20:36.613
> 
> 标签：python, pygame

我刚开始使用pygame。我已经创建了我的游戏，但它真的很不稳定并且崩溃（有问题退出）。

我创建了一个欢迎页面，但它创建了一个游戏控制错误（鼠标控制的角色已停止响应），我尝试了几种方法，但只会导致更多的游戏崩溃和错误。你能帮我调试一下你可能发现的任何东西吗？你从她那里下载游戏[http://dl.dropbox.com/u/47312995/Twerk.rar](http://dl.dropbox.com/u/47312995/Twerk.rar)

编码：

```
import pygame
from pygame import *
import random
import time
import os
import sys
from pygame.locals import *

black = (0,0,0)
white = (255,255,255)

pygame.init()

def game():

os.environ['SDL_VIDEO_CENTERED'] = '1'
mouse.set_visible(False)
screen = display.set_mode((800,500))
backdrop = pygame.image.load('bg.jpg').convert_alpha()
menu = pygame.image.load('green.jpg').convert_alpha()
ballpic = pygame.image.load('ball.gif').convert_alpha()
mouseball = pygame.image.load('mouseball.gif').convert_alpha()
display.set_caption('Twerk')
back = pygame.Surface(screen.get_size())

def text(text,x_pos,color,font2=28):
    tfont = pygame.font.Font(None, font2)

    text=tfont.render(text, True, color)
    textpos = text.get_rect(centerx=back.get_width()/2)
    textpos.top = x_pos
    screen.blit(text, textpos)

 start = False
 repeat = False
while start == False:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            start = True
            #falling = True
            #finish = True

        if event.type == pygame.KEYDOWN:
            if event.key == pygame.K_SPACE:
                start = True
    #game over screen
    screen.blit(menu,[0,0])
    pygame.display.set_caption("TWERK")

    #Text
    #"Welcome to Escape"
    #needs replacing with logo 
    text("Twerk",60,white,300)

    #"Instructions"
    text("Instructions",310,white)
    text("----------------------------------------------------------------------------------------",320,white)
    text("Avoid the the enemies",340,white)
    text("Last as long as you can!",360,white)
    text("Press space to start",420,white)
    pygame.display.flip()

while start == True:
positionx=[]
positiony=[]
positionxmove=[]
positionymove=[]
falling = False
finish = False
score=0
enemies=1
velocity=1

for i in range(enemies):
  positionx.append(random.randint(300,400)+random.randint(-300,200))
  positiony.append(random.randint(200,340)+random.randint(-200,100))
  positionxmove.append(random.randint(1,velocity))
  positionymove.append(random.randint(1,velocity))

font = pygame.font.Font(None, 28)
text = font.render('Starting Twerk... ', True, (100,100,100))
textRect = text.get_rect()
textRect.centerx = screen.get_rect().centerx
textRect.centery = screen.get_rect().centery

screen.blit(backdrop, (0,0))
screen.blit(text, textRect)
pygame.display.update()
game=time.localtime()

while start == True:
  end=time.localtime()
  score= (end[1]-game[1])*3600 + (end[4]-game[4])*60 + end[5]-game[5]
  if score > 1: break

first=True
strtTime=time.localtime()

while not finish or falling:
  screen.blit(backdrop, (0,0))
  for i in range(enemies):
    screen.blit(ballpic,(positionx[i],positiony[i]))
    (mousex,mousey)=mouse.get_pos()
    screen.blit(mouseball,(mousex,mousey))
    display.update()
    strt = time.localtime()

  if first:
    while True:
      end=time.localtime()
      score= (end[3]-strt[3])*3600 + (end[4]-strt[4])*60 + end[5]-strt[5]
      if score > 3: break
    first = False

  if falling:
    for i in range(enemies):
      positionymove[i]=1000
      positionxmove[i]=0

  for i in range(enemies): positionx[i]=positionx[i]+positionxmove[i]
  for i in range(enemies): positiony[i]=min(600,positiony[i]+positionymove[i])

  if falling:
    falling=False
    for posy in positiony:
      if posy<600: falling=True

  if not falling:
    for i in range(enemies):
      for j in range(i+1,enemies):
        if abs(positionx[i]-positionx[j])<20 and abs(positiony[i]-positiony[j])<20:
          temp=positionxmove[i]
          positionxmove[i]=positionxmove[j]
          positionxmove[j]=temp
          temp=positionymove[i]
          positionymove[i]=positionymove[j]
          positionymove[j]=temp

    for i in range(enemies):  
      if positionx[i]>600: positionxmove[i]*=-1
      if positionx[i]<0: positionxmove[i]*=-1
      if positiony[i]>440: positionymove[i]*=-1
      if positiony[i]<0: positionymove[i]*=-1

    for i in range(enemies):
      if abs(positionx[i]-mousex)<40 and abs(positiony[i]-mousey)<40:

        endTime=time.localtime()
        score= (endTime[3]-strtTime[3])*3600 + (endTime[4]-strtTime[4])*60 + endTime[5]-strtTime[5]
        falling = True
        finish = True
game() 
```

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T05:43:00.267

问题是您没有检查输入。每次通过你的游戏循环，你都应该调用 pygame.event.get()。例如，从我的模板代码：

```
def quit():
    pygame.quit(); sys.exit()
def GetInput():
    key = pygame.key.get_pressed()
    for event in pygame.event.get():
        if   event.type == QUIT: quit()
        elif event.type == KEYDOWN:
            if   event.key == K_ESCAPE: quit()
def Draw():
    pygame.display.flip()
def main():
    Clock = pygame.time.Clock()
    while True:
        GetInput()
        Draw()
        Clock.tick(60) 
```

# iphone - 如何使用 iOS 5 Twitter 框架发送直接消息？

> ID：10253709
> 
> 赞同：8
> 
> 时间：2012-04-20T21:21:09.430
> 
> 标签：iphone, ios5, twitter

我正在尝试使用[此](https://stackoverflow.com/questions/8034764/use-twrequest-to-send-an-image-with-a-text-to-twitter-in-ios5)代码和[这些说明](https://dev.twitter.com/docs/api/1/post/direct_messages/new)来发送直接消息。发布一条普通的推文效果很好，但是当我尝试发送直接消息时，我得到了 406。

这是完整的代码：

```
ACAccountStore *account = [[ACAccountStore alloc] init];
ACAccountType *accountType = [account accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierTwitter];

// Request access from the user to access their Twitter account
[account requestAccessToAccountsWithType:accountType withCompletionHandler:^(BOOL granted, NSError *error) {
    // Did user allow us access?
    if (granted == YES)
    {
        // Populate array with all available Twitter accounts
        NSArray *arrayOfAccounts = [account accountsWithAccountType:accountType];

        // Sanity check
        if ([arrayOfAccounts count] > 0) 
        {
            // Keep it simple, use the first account available
            ACAccount *acct = [arrayOfAccounts objectAtIndex:0];

            // Build a twitter request
            NSURL *url = [NSURL URLWithString:@"https://api.twitter.com/1/direct_messages/new.format"];
            NSDictionary *p = [NSDictionary dictionaryWithObjectsAndKeys:
                @"UserName",                    @"screen_name",
                @"Super awsome direct message", @"text",
                nil
            ];

            TWRequest *postRequest = [[TWRequest alloc]
                initWithURL:   url
                parameters:    p
                requestMethod: TWRequestMethodPOST
            ];

            // Post the request
            [postRequest setAccount:acct];

            // Block handler to manage the response
            [postRequest performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
                NSLog(@"Twitter response, HTTP response: %i", [urlResponse statusCode]);
                CCLOG(@"Response Data\n%@", responseData);
                if (!error)
                    CCLOG(@"%@", [error description]);
            }];
        }
    }
}]; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T22:25:33.003

尝试使用

[https://api.twitter.com/1/direct_messages/new.json](https://api.twitter.com/1/direct_messages/new.json)

代替

[https://api.twitter.com/1/direct_messages/new.format](https://api.twitter.com/1/direct_messages/new.format)

# c++ - gSOAP 分段错误

> ID：10253713
> 
> 赞同：0
> 
> 时间：2012-04-20T21:21:22.817
> 
> 标签：c++, ubuntu, gsoap

最近我有一个使用 gSOAP 构建的小型 C++ SOAP 客户端项目（ubuntu linux）。我正在使用 2 个 Web 服务类，我相信我已经根据文档正确创建了这些类。但是，我的代码有问题

```
 #include "envH.h"
    #include "betfairBFGlobalServiceProxy.h"
    #include "betfairBFExchangeServiceProxy.h"
    //#include "betfair.nsmap"
    #include <iostream>
    #include <string>
    // Following included to prevent ligsoap++ complaining of undefined references
    // to 'namespaces'
    SOAP_NMAC struct Namespace namespaces[] =  {};

    using namespace std;
    using namespace betfair;

    int main() 
    {
      BFGlobalServiceProxy bf;

      BFExchangeServiceProxy betfair2;  /* CRASH!! */
      return 0;
    } 
```

我想对这两个 Web 服务进行 API 调用，但我的程序在创建第二个服务代理对象时崩溃。在使用 C++ 命名空间创建多个客户端服务时，我使用了 wsdl2h -gbetfair 选项和 soapcpp2 -i -n 选项并创建了一个新的 env.h 文件，以避免链接到 libgsoap++ 时出现链接器错误。谁能看到我做错了什么？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T05:09:06.967

我无法重现这个问题，所以我不确定我的猜测。数组命名空间在 .nsmap 文件中定义。您的代码在 .nsmap 文件的#include 中有注释，如果此数组为空，gSOAP 可能不喜欢。您真的必须将#include“betfair.nsmap”注释掉吗？

# yii - Yii框架中文本框中的值相乘

> ID：10253715
> 
> 赞同：-1
> 
> 时间：2012-04-20T21:21:23.850
> 
> 标签：yii

我是 Yii 的新手，我正在尝试从文本框中计算值。我希望计算代码与显示文本框的形式相同（因为产品也将显示在输入因子的相同形式的文本框中）。我试过这个猜测，但它没有用。我该如何解决这个问题？

```
<div class="row">
    <?php echo $form->labelEx($model,'Quantity_In_Pieces'); ?>
    <?php echo $form->textField($model,'Quantity_In_Pieces',array('Quantity_In_Pieces' => ('Quantity').val() * ('Hold').val());?>
    <?php echo $form->error($model,'Quantity_In_Pieces'); ?>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T01:27:35.840

据我了解，您需要在 ActiveForm 上添加 textField 并设置从另外两个文本字段计算的值。在这种情况下，您应该使用值 = ($model->Quantity) * ($model->Hold) 的[Chtml::textfield(... )。](http://www.yiiframework.com/doc/api/1.1/CHtml#textField-detail)我的意思是

`echo Chtml::textField('Quantity_In_Pieces', ($model->Quantity) * ($model->Hold));`

# java - 安卓结束活动

> ID：10253719
> 
> 赞同：0
> 
> 时间：2012-04-20T21:21:35.963
> 
> 标签：java, android, android-activity

我经历了一些活动，当我想回到主窗口时，我使用 FLAG_ACTIVITY_CLEAR_TOP 但如果我按下后退按钮，那么我会回到我经历过的其他活动。

简而言之，我想进入主要活动，按下后退按钮后不会进入其他活动。

**已编辑** 此关闭所有活动用于完成注销过程，换句话说，它不应该让用户返回。我不能使用 BackPressed()，因为我使用的是 putExtra 和 getExtra。也许有人可以写小样本。因为我不懂标志系统。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:25:13.740

用于`FLAG_ACTIVITY_NO_HISTORY`您不想保存在堆栈中的活动。当用户按下时，`back`他/她将转到最后一个没有设置该标志的活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:28:12.980

您可以在您的活动中覆盖[onBackPressed](http://developer.android.com/reference/android/app/Activity.html#onBackPressed%28%29)并使用以下标志开始您想要的活动： `FLAG_ACTIVITY_CLEAR_TOP|FLAG_ACTIVITY_SINGLE_TOP`

# java - Java空指针错误

> ID：10253726
> 
> 赞同：0
> 
> 时间：2012-04-20T21:21:56.633
> 
> 标签：java, nullpointerexception, lwjgl

您好，感谢您阅读本文。我正在用 java/LWJGL 编码。我的问题是，如果我不包含这件事，我会不断收到一些代码的空指针错误。基本上有4个班

*   一个块类。
*   一个 blockGrid 类
*   块类型类
*   还有一个引导类。

引导类创建一个显示，并在游戏循环中运行 blockgrid 类中的 draw 方法。要设置块的位置，我会在 blockgrid 方法中使用 renderat(x,y) 方法。块类只是在某个 x,y 处创建一个四边形。

对不起，如果我解释得不好。这是我的代码：这是发生错误的地方，只需阅读我的评论以查看错误所在。

```
// BlockGrid.java
package minecraft2d;

import java.io.File;

public class BlockGrid {
    private Block[][] blocks = new Block[100][100];

    public BlockGrid() {
        for (int x = 0; x < 25 - 1; x++) {
            for (int y = 0; y < 16 - 1; y++) {
                blocks[x][y] = new Block(BlockType.AIR, -100, -100); //This is where my error happens! If I don't include this line i get a null pointer. Anything will help. I am really stuck and don't know whats happening
            }
        }
    }
    public void setAt(int x, int y, BlockType b) {
        blocks[x][y] = new Block(b, x * 32, y * 32);
    }

    public void draw() {
        for (int x = 0; x < 25 - 1; x++) {
            for (int y = 0; y < 16 - 1; y++) {
                blocks[x][y].draw();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:25:56.550

当你没有那条线时你得到一个 NullPointerException 的原因是`null`当 draw() 被调用时 blocks[x][y] 将适用于所有 x,y 。draw() 假设您有有效的 Block 对象，因为它正在调用 Block#draw。

# java - 在子类中调用 super.equals 和 super.hashCode？

> ID：10253727
> 
> 赞同：8
> 
> 时间：2012-04-20T21:21:57.230
> 
> 标签：java, equals, hashcode

如果我在父类和子类中都实现`equals()`，`hashCode()`是否有必要在子类中调用`super.equals()`，`equals()`例如

```
public boolean equals(Object obj) {

  if (obj.getClass() != ChildClass.class) {
    return false;
  }

  return super.equals() && this.var == ((ChildClass) obj).var;

} 
```

我假设父类不是 Object 并且给出了 equals 和 hashCode 的正确定义。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T21:26:59.557

不，这没有必要，而且可能是错误的。确实，您重写的部分原因`equal`是因为`super.equals`没有给出正确的行为（对吗？）。

或者换一种说法，如果`super.equals`给出正确的行为，你可能不需要去覆盖它的麻烦。

但是，如果您要覆盖`equals`，那么是的，您也需要覆盖`hashCode`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:24:54.960

如果您的超类没有实现 equals，那么调用 super.equals 将为您提供仅比较引用的 Object 实现，因此在您想要比较业务密钥的任何普通 equals 实现中，它实际上会导致很多误报。

也就是说，您上面的实现在语义上实际上与 Object 中的默认 equals 实现没有任何不同，因为您只是`==`用于比较。

至于 hashCode，如果你覆盖 equals 你真的应该覆盖 hashCode 以保持两者的合同。例如，如果您将业务密钥用于等于，您可能应该对哈希码使用相同的业务密钥，以便两个相等的对象生成相同的哈希码。

# jquery - jquery ui 手风琴的 jquery 问题

> ID：10253729
> 
> 赞同：0
> 
> 时间：2012-04-20T21:22:07.947
> 
> 标签：jquery, jquery-ui, jquery-ui-accordion

我的网站上有一个手风琴，我使用 jquery UI 手风琴功能。当我的代码看起来像这样之前它工作正常：

```
$ (function () {
   $( "#accordion" ) .accordion({
      collapsible: true
   });
}); 
```

现在我添加了一些代码来添加更多功能，手风琴停止工作。这就是它现在的样子：

```
$ (function () {
   $( "#accordion" ) .accordion({
      collapsible: true,
      change: function(event, ui) {
         if(ui.newHeader[0].id == "cars") {
            $("#homesearch").val('');
         } else {
            $("#carsearch").val('');
         }
      }
   });
}); 
```

关于我在这里做错了什么有什么建议吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:23:51.180

您在之后`collapsible: true`/之前缺少逗号`change:`

# python - 如何处理 AJAX 中的预期错误（包括向用户披露它们）

> ID：10253732
> 
> 赞同：4
> 
> 时间：2012-04-20T21:22:19.353
> 
> 标签：python, ajax, django, jquery

预期的错误是我在代码中预期甚至自己提出的来自服务器的错误。例如，当用户尝试执行他没有足够权限的操作时，我会使用描述错误的消息引发`PermissionError`（自定义）。`Exception`

我一直在寻找一种处理 AJAX 情况的预期错误的好方法。唯一的要求是能够向用户显示错误消息，因为我想让我的用户了解正在发生的事情。

我目前的方法是将错误消息打包成 JSON 对象并将其发送回客户端

```
var ajaxResponse = $.ajax({
    ....        
});

ajaxResponse.done(function(jsonObj) {
    if (jsonObj.success) {
        /* no error, do something */    
    }
    else {
        /* expected error returned, display jsonObj.error to user */
    }
});

ajaxResponse.fail(function(jqXHR, textStatus, errorThrown) {
    /* unexpected error returned */
}); 
```

我有另一种方法，我不确定。基本上，不是将预期错误消息打包到 JSON 对象中，而是在我的 django 代码中返回`HttpResponse(content="no sufficient privilege", status=403)`. 客户端 jQuery 将被修改如下：

```
ajaxResponse.done(function(response_data) {
    /* no error, do something */
});

ajaxResponse.fail(function(jqXHR, textStatus, errorThrown) {
    /* both expected and unexpected error would end up here.
     * It's an expected error when error code is 403 and 
     * jqXHR.responseText would give me the error message to 
     * display to the user.
     */
}); 
```

我喜欢第二种方法如何将所有预期或意外的错误集中在一个地方。但是，我有一种感觉，不应该这样使用http状态码。无论如何，我想知道哪一个是正确的方法。如果两者都不是，请分享你会做什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:39:45.617

有这样的全局配置 -

```
$.ajaxSetup({

     error: function(xhr){
         /* Do something with xhr.responseText */
         window.status='Your error message goes here';
     }

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:32:32.527

jqXHR 对象包含有关失败响应的所有信息。首先请允许我简化您提出请求的方式：

```
 $.ajax({
        url: '/the/posting/url',
        type: 'POST',
        data: { param: value, param_two: value_two},
        success: function(){
            alert('Everything went as is supposed to be.');
        },
        error: function(jqXHR, t, e){
            console.log(jqXHR.responseText);
        }
    }) 
```

因此，通过这种方式，您可以管理您想要执行的操作，无论请求是否良好。然后你看我写了类似的东西：

```
console.log(jqXHR.responseText); 
```

那是因为该属性会告诉您详细的错误（取决于您在出现问题时如何放置跟踪）。您可以在 Firebug (Firefox) 或开发者工具（Chrome 和 Safari）的控制台中阅读它。

无需将对象序列化为 json 即可知道出了什么问题，因为 django（我想）按原样发送错误，并且错误。所以当 jquery 知道有什么地方出错时，它会触发 ajax 对象的 error 属性，就是这样，你可以在控制台中读取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:29:34.713

我个人总是使用方法一，特别是因为错误条件比 http 错误代码多。如果您使用第二种方法，也可能存在您的 js 代码无法区分预期错误和意外错误的情况。

# iphone - 使用加速度计在 cocos2d 中旋转精灵

> ID：10253735
> 
> 赞同：0
> 
> 时间：2012-04-20T21:22:29.267
> 
> 标签：iphone, xcode, cocos2d-iphone, rotation, accelerometer

我在 cocos2d 上，我有一个精灵，我想用加速度计旋转。

我听说过 CMMotionManager。我想知道是否可以将其仅用于 2D 旋转，如果可以，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:58:19.240

把这个放在`onEnter`：

```
UIAccelerometer *accelerometer = [UIAccelerometer sharedAccelerometer];
accelerometer.updateInterval = 1.0/50.0; //update interval in sec...so 1/50= 20 ms
accelerometer.delegate = self; 
```

你需要遵守`UIAccelerometerDelegate`这样的：

```
@interface MyClass:CCLayer <UIAccelerometerDelegate> 
```

并在以下实施`MyClass.m`：

```
- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration    *)acceleration {
CCLOG(@"x = %f y = %f z = %f",acceleration.x,acceleration.y,acceleration.z);
mysprite.rotation=acceleration.x*20;
} 
```

编辑：差点忘了...`accelerometer.delegate = nil;`放入`onExit`

请注意，每次加速度计更改值时都会调用该方法。在所有 3 个向量中

桌子上的卡片..我没有使用加速度计...曾经..但它应该看起来像这样...检查文档中的旋转属性并使用它进行一些操作

希望能帮助到你

PS：喜欢“对不起我的英语，我是法国人”的部分......搞笑

编辑：这是我对该代码的测试..并进行了一些修改..它工作得相当顺利..如果你不喜欢它玩弄这些值。

```
#import "cocos2d.h"

// HelloWorldLayer
UIAccelerationValue accelerationX;
UIAccelerationValue accelerationY;
float currentRawReading;
float calibrationOffset;

@interface HelloWorldLayer : CCLayer <UIAccelerometerDelegate>
{
    CCLabelTTF *label;
}

// returns a CCScene that contains the HelloWorldLayer as the only child
+(CCScene *) scene;

@end

#import "HelloWorldLayer.h"

// HelloWorldLayer implementation
@implementation HelloWorldLayer

+(CCScene *) scene
{
    // 'scene' is an autorelease object.
    CCScene *scene = [CCScene node];

    // 'layer' is an autorelease object.
    HelloWorldLayer *layer = [HelloWorldLayer node];

    // add layer as a child to scene
    [scene addChild: layer];

    // return the scene
    return scene;
}

#define kFilteringFactor .05

CGFloat RadiansToDegrees(CGFloat radians) {return radians *180/M_PI;};

// on "init" you need to initialize your instance
-(id) init
{
    // always call "super" init
    // Apple recommends to re-assign "self" with the "super" return value
    if( (self=[super init])) {

        UIAccelerometer *accel= [UIAccelerometer sharedAccelerometer];
        accel.delegate=self;
        accel.updateInterval=1/60;

        // create and initialize a Label
        label = [CCLabelTTF labelWithString:@"Hello World" fontName:@"Marker Felt" fontSize:64];

        // ask director the the window size
        CGSize size = [[CCDirector sharedDirector] winSize];

        // position the label on the center of the screen
        label.position =  ccp( size.width /2 , size.height/2 );
        label.flipY=YES; //i have absolutly no idea why the label is fliped :/
        label.flipX=YES;
        label.rotation=0;
        // add the label as a child to this Layer
        [self addChild: label];
    }
    return self;
}

-(void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration{

    CCLOG(@"acc called");
    accelerationX=acceleration.x *kFilteringFactor +accelerationX *(1-kFilteringFactor);
    accelerationY=acceleration.y*kFilteringFactor +accelerationY *(1-kFilteringFactor);
    currentRawReading=atan2(accelerationY, accelerationX);

    label.rotation=-RadiansToDegrees(currentRawReading);

}

// on "dealloc" you need to release all your retained objects
- (void) dealloc
{
    // in case you have something to dealloc, do it in this method
    // in this particular example nothing needs to be released.
    // cocos2d will automatically release all the children (Label)

    // don't forget to call "super dealloc"

    [super dealloc];
}
@end 
```

# makefile - 在 makefile 中包含库路径

> ID：10253736
> 
> 赞同：1
> 
> 时间：2012-04-20T21:22:29.650
> 
> 标签：makefile

我的makefile如下

```
program_NAME := myprogram
program_C_SRCS := $(wildcard *.cc)
program_C_OBJS := ${program_C_SRCS:.cc=.o}
program_OBJS := $(program_C_OBJS) 
program_INCLUDE_DIRS := ../INCLUDE
program_LIBRARY_DIRS := 
program_LIBRARIES :=
CPPFLAGS += $(foreach includedir,$(program_INCLUDE_DIRS),-I$(includedir))
LDFLAGS += $(foreach librarydir,$(program_LIBRARY_DIRS),-L$(librarydir))
LDFLAGS += $(foreach library,$(program_LIBRARIES),-l$(library))

.PHONY: all clean distclean

all: $(program_NAME)

$(program_NAME): $(program_OBJS)
$(LINK.cc) $(program_OBJS) -o $(program_NAME)

clean:
    @- $(RM) $(program_NAME)
    @- $(RM) $(program_OBJS)

distclean: clean 
```

我`stack.a`在某个路径中创建了一个库`/home/Desktop/kk/stack`。我想将此库包含到我的 makefile 中，以便在链接期间应该从该路径中获取它。

我试图给：

```
program_LIBRARY_DIRS := /home/Desktop/kk/stack 
```

在链接步骤中我给出了：

```
$(LINK.cc) $(program_OBJS) stack.a -o $(program_NAME) 
```

但是 makefile 无法从提到的路径中获取库。

相反，如果我直接给出：

```
$(LINK.cc) $(program_OBJS) /home/Desktop/kk/stack/stack.a -o $(program_NAME) 
```

它完美地工作。

请帮助我如何包含这个库路径，这样我就不必在链接命令中给出库的位置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:26:11.380

对于某些字符串，`-L`链接选项仅适用于使用, 命名`libX.a`或链接的库。您需要在链接命令中将其重命名为.`libX.so``-lX``X``stack.a``libstack.a``-lstack`

（理想情况下，您还应该将其放在`program_LIBRARIES`定义中并`$(LINK.cc)`在行中使用。）

# android - 用于调用数据的理想数据库字段

> ID：10253748
> 
> 赞同：0
> 
> 时间：2012-04-20T21:23:44.657
> 
> 标签：android

你好，有人可以帮忙。

我设计了一个对话框，我希望在其中有一个字段框或某种类型，当该对话框被调用时，TYPE & AMOUNT（链接）框将显示每个项目的数据库中的数据。所以对于我所做的这个对话。用户将在对话框之前单击活动上的饮料按钮。一旦调用，数据将填充这些字段框。

我的问题是我可以为这个数据框调用者使用什么。

![在此处输入图像描述](../Images/2ee46c16c14e6d620521ce131e47c512.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:46:12.620

您可以使用 TextView 或 EditText 小部件（取决于您是否希望用户分别查看或编辑数据），您可以从 SQLite 数据库中提取数据。

# javascript - 检查文本是否包含图像 url (Regex)

> ID：10253751
> 
> 赞同：0
> 
> 时间：2012-04-20T21:23:51.870
> 
> 标签：javascript, html, regex, image, url

因此，假设有人在文本区域中输入内容。

像这样简单的事情：

```
<textarea id="posttext" style="height: 50px; width: 80%;"></textarea> 
```

我已经让 textarea 来检测文本区域的变化，但是，假设有人从另一个站点复制并粘贴图像，如下所示：[http ://celticevolution.com/images/test-201.gif](http://celticevolution.com/images/test-201.gif)

我将如何获得该图片网址？另外，假设它们是多张图像，以及如何让它显示多张图像。

这类似于 Facebook 的发帖系统的工作方式。

谢谢，克里斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:27:47.520

如果你想检查它是否是一个图像 url 并做出相应的反应，你可以在文本区域的 onchange 事件中使用正则表达式来查看它是否包含 gif、jpg 或 png

```
var result = text.match(/http:\/\/\S+(\.png|\.jpg|\.gif)/g); 
```

如果要遍历页面图像，可以在 ajax 调用中捕获页面，然后执行不同的正则表达式来匹配所有“结果”（如上匹配）并将它们添加到数组中，然后从界面......就像fb一样。

# objective-c - 使用警报确认删除 UITableViewController 中的一行

> ID：10253752
> 
> 赞同：1
> 
> 时间：2012-04-20T21:23:52.557
> 
> 标签：objective-c, ios

我有一个`UITableViewController`, 设置，以便用户可以删除行。这是我的删除操作处理程序的代码，以及以下的委托方法`UIAlertView`：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"t" message:@"del?" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"Delete", nil];
        [alert show];
    }
}

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    NSIndexPath *path = [self.tableView indexPathForSelectedRow];
    if (buttonIndex != [alertView cancelButtonIndex]) {
        //my code to delete from the data source is here. it works fine.
        [self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:path] withRowAnimation:UITableViewRowAnimationFade];
    }
} 
```

问题出在最后一行，它应该从`tableView`. 如果我把它（以及从数据源中删除的代码）放在第一个方法而不是`UIAlertView`东西中，它就可以正常工作。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:29:23.120

问题是该`UIIndexPath`方法中的对象是错误的！我猜这是因为在显示警报视图时没有选择行。所以，我在`UIAlertView`编写代码之前将它保存到视图控制器类的属性中，稍后在第二种方法中检索它，它工作正常。

# r - 传递给 .Fortran() 时找不到 C_kmns 对象

> ID：10253759
> 
> 赞同：5
> 
> 时间：2012-04-20T21:24:43.570
> 
> 标签：r, cluster-analysis, k-means

我正在尝试修改`stats::kmeans`函数以返回迭代次数（[请参见此处](http://tolstoy.newcastle.edu.au/R/e17/help/12/01/1049.html)）。当我将源代码复制到我自己的文件中，修改函数并运行它时，我`C_kmns`在尝试执行`do_one`函数时收到关于对象丢失的错误。这个对象被传递给一个`.Fortran`调用，并且没有在`kmeans`函数的任何地方创建。这个物体是从哪里来的？

我得到的错误是

```
Error in do_one(nmeth) : object 'C_kmns' not found 
```

这是“违规”调用的代码片段。

```
 do_one <- function(nmeth) {
      Z <-
               switch(nmeth,
                        { # 1
                           Z <- .Fortran(C_kmns, as.double(x), as.integer(m),
                                    as.integer(ncol(x)),
                                    ... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T21:45:46.833

C_kmns 是 stats 命名空间中的非导出对象。您可以通过使用 stats:::C_kmns 告诉 R 在哪里找到它来解决问题。在你的例子中：

```
Z <- .Fortran(stats:::C_kmns, as.double(x), as.integer(m),
                                    as.integer(ncol(x)),
                                    ... 
```

一般来说，当你得到一个找不到对象的错误时，你可以去寻找它`getAnywhere("C_kmns")`

# ruby - 使用从 YAML 文件加载我的数据库的 Rake，我可以设置环境吗？

> ID：10253760
> 
> 赞同：2
> 
> 时间：2012-04-20T21:24:45.347
> 
> 标签：ruby, rake

我的 database.yml 看起来像：

```
adapter: mysql
database: my_db
username: user1
password: '123'
host: localhost 
```

这是一个非 Rails 应用程序，只是使用 rake/ruby 进行一些脚本编写。

我可以在这个 yaml 文件中设置默认（开发）和生产，还是特定于 rails？

如果是，则在运行类似以下内容时：

耙用户：创建

如果它是生产环境，我如何传入并因此使用 yaml 文件中的生产数据库设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:31:22.810

您将 yaml 文件读入内存并解析它是放置逻辑以使用当前环境的好地方（如果没有设置，则为默认值）。一种简单的方法是依赖环境变量（如果不是 rails 应用程序，则不要使用 RAILS_ENV，如果不是机架应用程序，则不要使用 RACK_ENV）。

使用类似的东西：

```
my_env = ENV['MY_ENV_VARIABLE'] || 'development'
db_settings = YAML::load(File.open(yml_file))[my_env] 
```

然后你可以通过以下方式调用 rake：

```
MY_ENV_VARIABLE=production rake my_task 
```

或者，如果您想为任务本身添加一个参数，您可以将其设置为使用

```
rake my_task[production] 
```

（但这可能会变得混乱，具体取决于您是否必须引用整个内容，例如在 zsh 中）。

一些库使用的另一种方法（如 heroku_san）是有一个单独的任务来设置环境变量，并依赖于调用多个任务，所以你有一个`:production`设置环境变量的任务，然后可以调用

```
rake production my_task 
```

# c# - 在 MVC 中使用 ChildActionOnly

> ID：10253769
> 
> 赞同：174
> 
> 时间：2012-04-20T21:25:24.373
> 
> 标签：c#, asp.net-mvc

你什么时候使用这个属性`ChildActionOnly`？什么是 a`ChildAction`以及在什么情况下您希望使用此属性限制操作？

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2012-04-20T21:34:00.720

该[`ChildActionOnly`](https://msdn.microsoft.com/en-us/library/system.web.mvc.childactiononlyattribute(v=vs.118).aspx)属性确保动作方法只能作为视图中的子方法调用。动作方法不需要具有此属性才能用作子动作，但我们倾向于使用此属性来防止动作方法因用户请求而被调用。定义了动作方法后，我们需要创建在调用动作时将呈现的内容。子动作通常与部分视图相关联，尽管这不是强制性的。

1.  [ChildActionOnly] 允许通过 View 中的代码进行受限访问

2.  特定页面 URL 的状态信息实现。示例：支付页面 URL（只支付一次）剃刀语法允许有条件地调用特定操作

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2014-09-02T20:04:49.057

使用 注释的**[ChildActionOnly]**属性，动作方法只能作为视图中的子方法调用。这是**[ChildActionOnly] 的示例。**.

有两种操作方法：Index() 和 MyDateTime() 以及相应的视图：Index.cshtml 和 MyDateTime.cshtml。这是**HomeController.cs**

```
public class HomeController : Controller
 {
    public ActionResult Index()
    {
        ViewBag.Message = "This is from Index()";
        var model = DateTime.Now;
        return View(model);
    }

    [ChildActionOnly]
    public PartialViewResult MyDateTime()
    {
        ViewBag.Message = "This is from MyDateTime()";

        var model = DateTime.Now;
        return PartialView(model);
    } 
} 
```

这是**Index.cshtml**的视图。

```
@model DateTime
@{
    ViewBag.Title = "Index";
}
<h2>
    Index</h2>
<div>
    This is the index view for Home : @Model.ToLongTimeString()
</div>
<div>
    @Html.Action("MyDateTime")  // Calling the partial view: MyDateTime().
</div>

<div>
    @ViewBag.Message
</div> 
```

这是**MyDateTime.cshtml**部分视图。

```
@model DateTime

<p>
This is the child action result: @Model.ToLongTimeString()
<br />
@ViewBag.Message
</p> 
```

```
如果您运行应用程序并执行此请求 http://localhost:57803/home/mydatetime
 结果将是这样的服务器错误：
```

![在此处输入图像描述](../Images/a61858fd702b6787c5fdb55a944a3ba4.png)

这意味着您不能直接调用局部视图。但可以通过 Index() 视图调用它，就像在 Index.cshtml 中一样

```
     @Html.Action("MyDateTime") // 调用局部视图：MyDateTime()。

```

```
如果您删除[ChildActionOnly]并执行相同的请求 http://localhost:57803/home/mydatetime 它允许您获取 mydatetime 部分视图结果：
```

```
This is the child action result. 12:53:31 PM 
This is from MyDateTime() 
```

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2012-04-20T21:26:48.647

如果您`RenderAction`在任何视图中使用它，通常会使用它，通常用于渲染局部视图。

标记它的原因`[ChildActionOnly]`是您需要将控制器方法公开，以便您可以使用它来调用它，`RenderAction`但您不希望有人能够导航到 URL（例如 /Controller/SomeChildAction）并查看结果直接行动。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-02-14T21:53:05.667

仅供参考，[ChildActionOnly] 在 ASP.NET MVC Core 中不可用。[在这里](http://www.davepaquette.com/archive/2016/01/02/goodbye-child-actions-hello-view-components.aspx)查看一些信息

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-12-21T16:36:03.513

派对有点晚了，但是...

其他答案很好地解释了`[ChildActionOnly]`属性的影响。但是，在大多数示例中，我一直在问自己，当您可以直接在视图中进行渲染时，为什么要创建一个新的操作方法只是为了在另一个视图中渲染部分`@Html.Partial("_MyParialView")`视图。这似乎是一个不必要的层。但是，正如我调查的那样，我发现一个好处是子动作可以创建不同的模型并将其传递给局部视图。局部视图所需的模型在渲染局部视图的视图模型中可能不可用。您可以调用子动作并让动作方法负责创建局部视图所需的模型，而不是修改模型结构以获得必要的对象/属性。

这可以派上用场，例如，在`_Layout.cshtml`. 如果您有一些所有页面共有的属性，实现此目的的一种方法是使用基本视图模型并让所有其他视图模型从它继承。然后，`_Layout`可以使用基本视图模型和通用属性。不利的一面（这是主观的）是所有视图模型都必须从基本视图模型继承，以保证这些通用属性始终可用。`@Html.Action`另一种方法是在那些常见的地方进行渲染。action 方法将为所有页面共有的部分视图创建一个单独的模型，这不会影响“主”视图的模型。在这个替代方案中，`_Layout`页面不需要有模型。因此，所有其他视图模型不需要从任何基本视图模型继承。

我确定使用该`[ChildActionOnly]`属性还有其他原因，但这对我来说似乎是一个很好的原因，所以我想我会分享。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-06-21T18:11:05.567

```
 public class HomeController : Controller  
    {  
        public ActionResult Index()  
        {  
            ViewBag.TempValue = "Index Action called at HomeController";  
            return View();  
        }  

        [ChildActionOnly]  
        public ActionResult ChildAction(string param)  
        {  
            ViewBag.Message = "Child Action called. " + param;  
            return View();  
        }  
    }  

The code is initially invoking an Index action that in turn returns two Index views and at the View level it calls the ChildAction named “ChildAction”.

    @{
        ViewBag.Title = "Index";    
    }    
    <h2>    
        Index    
    </h2>  

    <!DOCTYPE html>    
    <html>    
    <head>    
        <title>Error</title>    
    </head>    
    <body>    
        <ul>  
            <li>    
                @ViewBag.TempValue    
            </li>    
            <li>@ViewBag.OnExceptionError</li>    
            @*<li>@{Html.RenderAction("ChildAction", new { param = "first" });}</li>@**@    
            @Html.Action("ChildAction", "Home", new { param = "first" })    
        </ul>    
    </body>    
    </html>  

      Copy and paste the code to see the result .thanks 
```

# ejb - Weblogic 找不到用于绑定的“正确”JNDI 名称的资源适配器

> ID：10253774
> 
> 赞同：5
> 
> 时间：2012-04-20T21:25:50.420
> 
> 标签：ejb, weblogic, adapter, jndi, jca

我正在尝试将我的消息驱动 bean 与 Weblogic 10.3.5 上的 Oracle JCA 文件适配器（包含在 SOA 套件中）绑定。这样当有任何 .txt 文件移动到特定目录时，我的 MDB 可以得到通知。

启动支持 SOA 功能的 Weblogic 域后，将自动部署文件适配器。在 Weblogic 控制台上我可以看到文件适配器部署为“资源适配器”，健康为“OK”，状态为“Active”，如下图所示：

![在 Weblogic 中部署文件适配器](../Images/0cf23a1c85d8191191d1cea9652f0c9f.png)

我还运行了文件适配器的测试，它们都通过了：

![在此处输入图像描述](../Images/22cfea5614adfc629aa8bc5ef9acf44e.png)

所以我认为文件适配器已正确部署并且应该可以正常工作。

然后我的消息驱动 bean 代码如下所示：

```
import java.util.logging.Logger;
import javax.ejb.MessageDriven;
import javax.resource.ResourceException;
import javax.resource.cci.MessageListener;
import javax.resource.cci.Record;

@MessageDriven
public class FileAdapterClientMDB implements MessageListener {

    private Logger logger = Logger.getLogger(FileAdapterClientMDB.class.getName());

    public FileAdapterClientMDB() {

    }

    @Override
    public Record onMessage(Record record) throws ResourceException {
        logger.info("Received record: " + record);
        return record;
    }
} 
```

这是我的**ejb-jar.xml**文件的内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<ejb-jar xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:ejb="http://java.sun.com/xml/ns/javaee/ejb-jar_3_0.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/ejb-jar_3_0.xsd" version="3.0">
  <display-name>MockEJB</display-name>
  <enterprise-beans>
    <message-driven>
      <description>EMessage Driven Bean as File Adapter Client</description>
      <display-name>FileAdapterClientMDB</display-name>
      <ejb-name>FileAdapterClientMDB</ejb-name>
      <ejb-class>com.test.FileAdapterClientMDB</ejb-class>
      <messaging-type>javax.resource.cci.MessageListener</messaging-type>
      <transaction-type>Container</transaction-type>
      <activation-config>
        <activation-config-property>
          <activation-config-property-name>physicalDirectory</activation-config-property-name>
          <activation-config-property-value>C:\dataDir</activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>deleteFile</activation-config-property-name>
          <activation-config-property-value>true</activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>pollingFrequency</activation-config-property-name>
          <activation-config-property-value>10</activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>includeFiles</activation-config-property-name>
          <activation-config-property-value>.*\.txt</activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>minimumAge</activation-config-property-name>
          <activation-config-property-value>0</activation-config-property-value>
        </activation-config-property>
      </activation-config>
    </message-driven>
  </enterprise-beans>
</ejb-jar> 
```

还有我的**weblogic-ejb-jar.xml**文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<wls:weblogic-ejb-jar xmlns:wls="http://www.bea.com/ns/weblogic/weblogic-ejb-jar" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/ejb-jar_3_0.xsd http://www.bea.com/ns/weblogic/weblogic-ejb-jar http://www.bea.com/ns/weblogic/weblogic-ejb-jar/1.0/weblogic-ejb-jar.xsd">
    <!--weblogic-version:10.3-->
    <wls:weblogic-enterprise-bean>
        <!--options:RESOURCE_ADAPTER_JNDI-->
        <wls:ejb-name>FileAdapterClientMDB</wls:ejb-name>
        <wls:message-driven-descriptor>
            <wls:resource-adapter-jndi-name>eis/FileAdapter</wls:resource-adapter-jndi-name>
        </wls:message-driven-descriptor>
        <wls:jndi-name>FileAdapterClientMDB</wls:jndi-name>
        <wls:local-jndi-name>FileAdapterClientMDB</wls:local-jndi-name>
    </wls:weblogic-enterprise-bean>
</wls:weblogic-ejb-jar> 
```

在部署 EAR 项目时，我收到以下消息：

```
<20.4.2012 22:42:11 CEST> <Warning> <EJB> <BEA-010221> <The Message-Driven EJB: 
FileAdapterClientMDB is unable to bind to the JCA resource adapter: eis/FileAdapter. 
The Error was: No deployed ResourceAdapter with adapter JNDI name = 'eis/FileAdapter' was found.> 
```

我不知道为什么 Weblogic 会抱怨这个，因为[适配器的官方用户指南中](http://docs.oracle.com/cd/E21764_01/integration.1111/e10231/toc.htm)提到了“eis/FileAdapter”JNDI 名称。我也可以在 Weblogic 的 JNDI 树中看到它：

![在此处输入图像描述](../Images/cdc9f9f94da5140db1e9887707a97d9e.png)

更重要的是，当我在测试 Web 服务中运行以下代码时：

```
try {
    final Context context = new InitialContext();
    final Object obj = context.lookup("eis/FileAdapter");
    System.out.println("eis/FileAdapter => " + obj);
} catch (NamingException e) {
    e.printStackTrace();
} 
```

它打印出“ **eis/FileAdapter => oracle.tip.adapter.file.FileConnectionFactory@ff51dc** ”，这意味着 JNDI 名称是正确的！

所以我的问题是，**为什么 Weblogic 找不到用于绑定的“正确”JNDI 名称的资源适配器？** 有人可以给我一些关于如何解决它的想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-29T14:23:12.020

只要您没有看到此警告重复出现，您就无需担心。它只是显示在部署 MDB 时的部署顺序中，它无法获取适配器。请注意，MDB 每 5 秒尝试连接一次，因此如果警告继续填满日志，则意味着 MDB 无法获取适配器，这意味着它无法正常工作，如果您只看到警告一次，您可以安全地忽略它或更改部署顺序并稍后推送 MDB。

# linux - 编译 Linux 内核 - hello world

> ID：10253775
> 
> 赞同：6
> 
> 时间：2012-04-20T21:25:50.893
> 
> 标签：linux, kernel

我正在尝试编译 Linux 内核： [http ://tldp.org/LDP/lkmpg/2.6/html/lkmpg.html](http://tldp.org/LDP/lkmpg/2.6/html/lkmpg.html)

我有一个简单的 hello world 程序 hello-1.cpp

```
#include <linux/module.h>
#include <linux/kernel.h>

int init_module(void)
{
    return 0;
}

void cleanup_module(void)
{
} 
```

但我正在尝试使用 Makefile 构建它：

```
obj-m += hello-1.o

all:
make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules

clean:
make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean 
```

我有几个错误。

```
make -C /home/pacman/linux-2.6.34.11/2.6.35.6-45.fc14.i686/build M=/home/pacman/p1 modules
make: *** /home/pacman/linux-2.6.34.11/2.6.35.6-45.fc14.i686/build: No such file or directory.  Stop. 
```

制作：*** [全部] 错误 2

我忘记定义什么了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T16:34:18.400

重命名 hello-1。**cpp**到 hello-1。**c**（模块必须用 C 编写）并添加以下行：

```
module_init(init_module);
module_exit(cleanup_module); 
```

# html - 网站今天在 IE9 中显示的差异与 IE8 不同

> ID：10253778
> 
> 赞同：0
> 
> 时间：2012-04-20T21:26:14.637
> 
> 标签：html, css

我在解决该网站的 IE8（工作正常）和 IE9 之间的显示差异时遇到问题： [http ://www.exploreolympics.com/](http://www.exploreolympics.com/)

似乎这个问题刚刚出现，两个浏览器在两天前都显示相同。在 IE9 中，右 2/3s（在标题下方）似乎不适合，并被放到左 1/3 面板下方。在我查看 CSS 时，似乎应该有足够的空间......但我一定遗漏了一些东西。CSS 文件在这里： [http ://www.exploreolympics.com/style...in_styles3.css](http://www.exploreolympics.com/style...in_styles3.css)

最好的祝愿

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:40:15.087

你在你的 div 上有浮动，id 为“l_third”，这不应该是 float:right 吗？

我已经在 ie9 上尝试过，但它不能解决问题。在这种情况下，我通常会在您的 html 中的左侧内容之前拥有正确的内容。尝试将 div#l_third 与 div#r_2thirds 交换。还要将 float:right 添加到 div#r_2thirds。

我已经复制了你的 html 来让你了解我的意思 - [http://jsfiddle.net/pjsSn/](http://jsfiddle.net/pjsSn/)

这个链接将很难阅读。我建议在记事本++中使用它来查看我是如何交换这两个部分的

# python - 使列表子类可散列

> ID：10253783
> 
> 赞同：0
> 
> 时间：2012-04-20T21:26:24.443
> 
> 标签：python, list, python-3.x, immutability, hashable

我想从中派生一个类`list`，向它添加一些实例属性，并使其可散列。什么是好的（快速而整洁的）方法？

更新：

我删除了一个用例的冗长解释。我还将一个相关但单独的问题移到了[另一个问题](https://stackoverflow.com/questions/10254594/when-makes-a-user-defined-class-unhashable)中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:32:39.380

这段代码很好。您正在制作列表的副本，这可能会有点慢。

```
def __hash__(self):
    return hash(tuple(self.list_attribute)) 
```

如果你想更快，你有几个选择。

*   存储`list_attribute`为元组，而不是列表（完全构造后）
*   **在初始化**时计算一次哈希并存储哈希值。你可以这样做，因为你的类是不可变的，所以哈希永远不会改变。
*   编写自己的哈希函数。这是[tuple 的哈希函数](http://effbot.org/zone/python-hash.htm#tuples)，做类似的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T22:01:16.627

您可以`tuple`申请`self`：

```
class State(list):
    def __hash__(self):
        return hash((self.some_attribute, tuple(self))) 
```

`tuple`-ing`self`大约需要整个散列过程的一半时间：

```
from timeit import timeit

setup = "from __main__ import State; s = State(range(1000)); s.some_attribute = 'foo'"
stmt = "hash(s)"
print(timeit(stmt=stmt, setup=setup, number=100000))

setup = "r = list(range(1000))"
stmt = "tuple(r)"
print(timeit(stmt=stmt, setup=setup, number=100000)) 
```

印刷

```
0.9382011891054844
0.3911763069244216 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T22:21:32.463

这更像是评论而不是答案，但是评论太长了。这是从内部访问实例属性的方式`__new__`：

```
class Data(tuple):
    def __new__(klass, arg):
        data_inst = tuple.__new__(klass, arg)
        data_inst.min = min(data_inst)
        data_inst.max = max(data_inst)
        return data_inst

>>> d = Data([1,2,3,4])
>>> d
(1, 2, 3, 4)
>>> d.min
1
>>> d.max
4
>>> d1 = Data([1,2,3,4,5,6])
>>> d1.max
6
>>> d.max
4 
```

# ruby - Ruby 将数据包发送到已知的 MAC 地址

> ID：10253785
> 
> 赞同：0
> 
> 时间：2012-04-20T21:26:41.823
> 
> 标签：ruby

我喜欢将数据包发送到仅关联 MAC 地址并连接到本地 LAN 的设备。

ruby / gem 库中有什么东西可以用来执行这样的任务吗？

我想做一些类似 tcpreplay 的事情，但是用 ruby​​ 代替。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:36:47.800

我想有几种方法。你没有说你是否想发送某种 IP 数据包，如果是，你没有说哪个 IP 协议。（我可以告诉你想发送一个以太网*帧*但是......什么封装协议？）

无论如何，您可以使用 Ruby 打开 SOCK_RAW，例如：

```
Socket.open(Socket::PF_INET, Socket::SOCK_RAW, Socket::IPPROTO_RAW) 
```

另一种方法可能是只选择一个链接本地 IP，然后在本地 ARP 缓存中建立一个 IP/MAC 映射，如下所示：

```
system "arp -s host hw_addr" 
```

然后，您可以使用链接本地 IP 地址使用更熟悉的套接字操作与它通信。

你需要成为所有这些事情的根源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T07:59:46.697

MAC 是 OSI 第 2 层上使用的地址，您在该层上使用的包类型是例如以太网帧。IP 套接字位于第 3/4 层，因此如果您使用 IP 套接字，则您正在发送 IP 数据包。

因此，如果您想向“MAC 地址”发送某些内容，则需要发送原始以太网帧，这些帧需要对方理解。鉴于这些东西的水平非常低，这很少是你真正想做的。

相反，您应该尝试使用广播/回复机制或多播（例如 Bonjour 使用）在本地网络（技术上是广播域）中获取远程设备的正确 IP 地址。这样，您始终可以使用更多受支持的 IP 层。为此，您的设备当然需要有一个 IP 地址。您可以使用 DHCP 或 IPv6 的地址自动配置等机制来建立它们。

至于您的问题，我不知道 Ruby 有任何库可以发送原始以太网帧。但是考虑到你无论如何都需要发明一个除了 IP 之外的新协议（这很难，真的很难），发送包可能是你最不关心的问题。

# osx-lion - XCode 4.3.1 安装

> ID：10253788
> 
> 赞同：0
> 
> 时间：2012-04-20T21:27:07.970
> 
> 标签：osx-lion, xcode4.3

我最近安装了从 developer.apple.com 网站下载的 XCode 4.3.1。以前，我通过命令行从 /Developer/Applications... 目录卸载了旧版本（XCode 4.1）。

现在，我现在找不到任何 XCode 目录，也找不到 /Applications 文件夹中的 XCode.app。

有人知道我在哪里可以找到 XCode 启动器、卸载程序或可以运行应用程序的目录吗？

我的操作系统：Mac OS X 10.7.3 (Lion)

任何帮助将不胜感激！

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:28:33.947

如果您正在运行 Lion，您可能应该从应用商店而不是 developer.apple.com 下载 xCode

# c# - 使用 T4MVC 时如何从 URL 中删除参数

> ID：10253790
> 
> 赞同：0
> 
> 时间：2012-04-20T21:27:09.940
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-routing, t4mvc

动作方法看起来像

```
public virtual ActionResult Show(int productId, bool isValid, bool getByStoreId = false) 
```

当我调用此操作时，我会得到类似的 url

```
.../Product/Show/221?isValid=True&getByStoreId=True 
```

但我只想显示

```
.../Product/Show/221 
```

T4MVC 对此有一些捷径吗？

```
routes.MapRoute(
                "ProductsShow_Default",
                "Product/{action}/{articleId}",
                MVC.Product.Show()
            ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:32:24.407

默认情况下，您`RouteValueDictionary`为链接输入的任何未包含在任何路由中的参数将默认添加到查询字符串中。不将它们放在查询字符串中的唯一方法是为它们映射路由，但它们仍将显示在 URL 中。

# jquery - 我的 jquery 选择器错了吗？

> ID：10253797
> 
> 赞同：0
> 
> 时间：2012-04-20T21:28:24.847
> 
> 标签：jquery, jquery-selectors, tooltip

我正在尝试创建一个带有列表的工具提示，这个列表应该是可选择的，所以我使用下一个 wbepage 中的代码：http: [//3nhanced.com/javascript/simple-tooltip-powered-by -jquery/](http://3nhanced.com/javascript/simple-tooltip-powered-by-jquery/) 创建我的工具提示，但是当我使用下一个代码创建可选择项时：

```
 $(document).ready(function() {

        $('.toolTip').hover(
            function() {
                this.tip = this.title;
                console.log($(this));
                $(this).append(
                    '<div class="toolTipWrapper">'
                        +'<div class="toolTipTop"></div>'
                        +'<div class="toolTipMid">'
                            +'<ul id="selectable">'
                                +'<li class="ui-widget-content">Item</li>'
                                +'<li class="ui-widget-content">Item</li>'
                            +'</ul>'                                            
                        +'</div>'
                        +'<div class="toolTipBtm"></div>'
                    +'</div>'
                );
                this.title = "";
                this.width = $(this).width();
                $(this).find('.toolTipWrapper').css({left:this.width-22})
                $('.toolTipWrapper').fadeIn(300);
            },
            function() {
                $('.toolTipWrapper').fadeOut(100);
                $(this).children().remove();
                this.title = this.tip;
            }
        );

        $("#selectable").selectable({
            stop: function() {
                var $item2 = $(this),
                $target = $(event.target);
                console.log($target);                   
                var result = $("#select-result").empty();
                $(".ui-selected", this).each(function() {
                    var index = $("#selectable li" ).index(this);
                    result.append(" #" + (index + 1));
                });
            }
        });         
}); 
```

有谁知道为什么它不起作用？每个人都可以看到；在使用可选功能之前首先完成工具提示创建。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:29:59.173

`$(function() {...});`当 DOM 准备好时，里面的代码就会运行。但是，您`<ul id="selectable">`稍后会使用该`.append()`函数插入您的元素，因此当您的第一段代码运行时该元素**不存在。**

插入额外的 HTML 后，您需要运行该代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:29:37.150

您必须`$("#selectable").selectable(...)`在元素实际存在时调用。换句话说，在您创建了工具提示之后。

# php - 分离 CodeIgniter 配置文件 Git 以公开发布

> ID：10253800
> 
> 赞同：5
> 
> 时间：2012-04-20T21:28:50.227
> 
> 标签：php, git, codeigniter, configuration, github

我即将开始一个基于 CodeIgniter 的项目，并计划使用 Git 作为我们的 DVCS。我将与其他一些开发人员一起工作，中央（原始）服务器是私人托管的。但是我也想把它开源，以后把代码发布到Github上。

我的问题是，有没有办法在 Git 中分离配置文件，以便配置文件中的私有信息不会发送到 Github 远程，而是发送到源和其他对等点。

另一个问题是我们是否可以使用类似的解决方案来拥有本地开发配置文件和用于生产的服务器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T16:57:42.280

创建每个开发人员都将使用的文件`config.php.sample`，`database.php.sample`其中包含密码和其他敏感信息的占位符。添加`config.php`和`database.php`到您的`.gitignore`

首次部署到生产站点时，您将创建`config.php`和`database.php`文件。后续推送不会覆盖`config.php`，`database.php`因为它们不包含在 git 存储库中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T01:21:42.760

Codeigniter 对环境（开发、生产等）有一些支持。参考官方文档，[CodeIgniter Environments](http://codeigniter.com/user_guide/general/environments.html)。

关于配置文件，您可以使用`.gitignore`

[http://progit.org/book/ch2-2.html](http://progit.org/book/ch2-2.html)

编辑：由于您`github`在问题中使用了标签；Github 现在有一个添加`.gitignore`文件的选项（他们也有一个 codeigniter 模板）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T22:51:11.460

在将应用程序部署到目标系统时，您应该使用部署工具来设置配置文件。

`capistrano`with`railsless-deploy`是个不错的选择

# iphone - UIScrollView 不出现在顶部，而是随机出现：在底部，在中间

> ID：10253802
> 
> 赞同：0
> 
> 时间：2012-04-20T21:29:01.980
> 
> 标签：iphone, ios, uiview, uiscrollview

我的 UIScrollView 有问题，我在界面生成器中创建了它，然后将它连接到我的视图，但是我有一个奇怪的问题，当我单击以滚动视图打开视图时，有时会出现在顶部，有些时间出现在底部滚动，有些时间出现在中间，例如，我希望它总是出现在顶部，我该怎么办？...如果我点击状态栏，uiscrollview 向上滚动它应该是，我也尝试添加这个：

```
[self.myScrollView scrollRectToVisible:CGRectMake(0, 0, 1, 1) animated:NO]; 
```

在我的视图中的配置视图中会出现，但不工作出现在每个位置随机滚动...有解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:43:41.010

您可以使用 scrollRectToVisible 让它始终出现在同一个位置。假设您有一个 UIScrollView，其帧大小为 (100,100)。您的内容大小为 (100,200)。如果您希望它出现在顶部，您可以调用：

```
[self.myScrollView scrollRectToVisible:CGRectMake(0, 0, 100, 100) animated:NO]; 
```

如果您想使内容居中，您可以这样做：

```
[self.myScrollView scrollRectToVisible:CGRectMake(0, 50, 100, 100) animated:NO]; 
```

如果这对您不起作用，那么您的滚动视图设置不正确，您需要提供有关如何设置它的更多详细信息。

# css - 'single-sprite-background-images' 的背景定位技术

> ID：10253806
> 
> 赞同：0
> 
> 时间：2012-04-20T21:29:27.973
> 
> 标签：css, background, background-image

什么是一个好的“图像精灵”工具，可以将单个图像变成一个具有不同背景位置的大精灵？

我知道[http://spriteme.org/](http://spriteme.org/)但它似乎没有产生像这样好的结果：

[goDaddy](https://img5.wsimg.com/pc/img/1/77635_hf_sprite.png)或[Behance 的](http://assets.behance.net/img/network/site/sprite.png?cb=95081662)

我一直在手动为小悬停和图标做这件事，但是做整个网站需要一段时间来手动编码所有背景位置属性。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T16:40:43.190

你可以试试[SASS/COMPASS](http://compass-style.org/)。即使您只使用[sprite 功能（称为 sprite mixin）](http://compass-style.org/help/tutorials/spriting/)，也值得使用它。有一些像[这样](http://www.youtube.com/watch?v=Tl6bceyTjFw)的不错的教程。

# salesforce - 请澄清这种父子关系的功能

> ID：10253811
> 
> 赞同：0
> 
> 时间：2012-04-20T21:29:52.330
> 
> 标签：salesforce

我有这个问题的答案，但不明白为什么会发生这种情况。有人可以详细解释这里发生了什么吗？

在父子模型中删除父记录时会发生什么情况，该模型在父子对象之间具有查找关系？

来源：[http ://www.allaboutsfdc.com/dev-401-quiz-part-1-q9.php](http://www.allaboutsfdc.com/dev-401-quiz-part-1-q9.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:18:13.800

对于 Salesforce，如果关系是主/详细信息，则删除父级时将删除子级。如果关系是查找关系，则删除父级时不会删除子级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:02:16.167

查找是一个对象对另一个对象的引用，尽管您可以将所引用的对象称为父对象并将一个对象称为子对象，但可以删除和更改关系。

主从关系是一种更严格的关系，其中子（详细记录）与父（主）相关联。他们不能被移动到另一个主人（但是 - 这很快就会出现）并且删除主人将删除它的所有孩子。

建立模式时最好的选择是始终首先创建关系作为查找，因为您可以在需要时将它们转换为主从关系，但您不能以其他方式返回。

因此要回答这个问题：由于问题是**Lookup** *而不是* **Master Detail**，因此不会删除子级，因此这里的答案是**D**。

# java - 添加或减去

> ID：10253814
> 
> 赞同：-2
> 
> 时间：2012-04-20T21:30:36.717
> 
> 标签：java

基本上我想做的是有一些库存（比如说它，100）和一个显示已售或已添加库存的库存清单。我如何对其进行编码以说明它是否是库存清单上的负数（例如-55）将其带走或者它是否为正数（即添加它而不是带走它的45）？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T21:32:37.473

加负数和减法一样，所以两种情况都加；您不需要对正数和负数进行任何特殊处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T21:32:50.100

像这样：

```
stocks += boughtOrSoldQuantity; 
```

如果`boughtOrSoldQuantity`为负数，`stocks`将减少该数量；否则会增加。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T21:33:54.027

数学`100 + -45`上是相同的，`100 - 45`所以在这两种情况下你都可以添加数字。

# ruby - '**/*.coffee' 是什么意思？

> ID：10253815
> 
> 赞同：1
> 
> 时间：2012-04-20T21:30:42.907
> 
> 标签：ruby, regex

正则表达式中的含义是什么`**`，我正在查看以下代码：

```
def coffee2js
  coffee_folder = self.config['coffeescript_folder'] || '**/*.coffee'
  compile_coffeescript(["*.coffee", coffee_folder], /\.coffee$/, '.js')
end 
```

说不`**/*.coffee`等于说`*/*.coffee`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T21:33:40.530

这不是正则表达式，这是[globbing](http://www.ruby-doc.org/core-1.9.3/Dir.html#method-c-glob)的语法。

这个表达

```
Dir.glob('/some/dir/**/*.coffee') 
```

递归查找所有`.coffee`目录下`/some/dir`的所有文件（而不是只查看`/some/dir`而不进入嵌套目录）。

# objective-c - NSSortdescriptor 对从 NSManagedContext 获取结果无效

> ID：10253817
> 
> 赞同：5
> 
> 时间：2012-04-20T21:31:00.017
> 
> 标签：objective-c, nsdate, nsfetchrequest, nssortdescriptor

我正在尝试使用 NSSortdescriptor 使用指向 NSDate 值的键对我的 NSFetchRequest 结果进行排序。我的获取结果完全随机出现，没有明确的原因。

我正在使用的 NSManagedObjectContext 更新为在 NSOperation 的子类上创建的嵌套子上下文中的保存。我知道这一切都已成功完成，因为我可以从父（主）上下文中获取所需的所有数据。从中获取只是不会按日期排序！

奇怪的是；用于在两个日期之间选择实体（称为“Tweet”）的谓词工作得很好！

这是一些代码来说明我的问题：

```
NSSortDescriptor* timeDescriptor = [NSSortDescriptor
                                        sortDescriptorWithKey:@"time"
                                        ascending:NO
                                        selector:@selector(compare:)];

NSFetchRequest* request = [NSFetchRequest fetchRequestWithEntityName:@"Tweet"];
[request setSortDescriptors:[NSArray arrayWithObjects:timeDescriptor, nil]];

NSPredicate* predicate = [NSPredicate predicateWithFormat:@"((time >= %@) AND (time <= %@))",startDate,endDate];
[request setPredicate:predicate];

NSManagedObjectContext* context = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
[context setParentContext:[[NSApp delegate] managedObjectContext]];
[context performBlock:^{
    NSError* error = nil;
    NSArray* results = nil;

    results = [context executeFetchRequest:request error:&error];
    // Results here are not ordered correctly

    // 2nd try sorting results using fetched array (works!)
    results = [results sortedArrayUsingDescriptors:[NSArray arrayWithObjects:timeDescriptor, nil]];

    // This works too but not needed anymore
    /*results = [results sortedArrayUsingComparator:^(id obj1, id obj2) {
        Tweet* tweet1 = (Tweet*)obj1;
        Tweet* tweet2 = (Tweet*)obj2;
        //return [tweet1.time compare:tweet2.time]; // ascending
        return [tweet2.time compare:tweet1.time]; // descending
    }];*/

    if ([results count] > 0) {
        for (uint i = 0; i < [results count]; i++) {
            Tweet* tweet = [results objectAtIndex:i];
            NSDate* date = Tweet.time;
            NSLog(@"tweet date: %@", date);
        }
    }
}]; 
```

谁能告诉我为什么 NSSortDescriptor 对我的提取不起作用？

谢谢！

- 更新 -

当我从主线程上的主（父） managedObjectContext 获取而不使用 performBlock 方法时，NSSortDescriptor 似乎工作正常。这仍然不能帮助我对 NSPrivateQueueConcurrencyType managedObjectContext 进行排序提取。在 performBlock 中创建 NSFetchRequest、NSSortDescriptor 和 NSPredicate 也不能解决问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T08:01:47.647

我也遇到了问题。我发现除非数据一直保存回持久存储，否则如果主上下文中的数据是脏的，即被修改，排序将不起作用。

例如，如果上下文是干净的，没有挂起的更改，则排序工作。如果我只更改父上下文中实体的一个属性，则私有队列子上下文中的排序不起作用。这是非常不幸的。我现在也使用数组方法进行排序，但它没有在 NSFetchRequest 中排序那么快，特别是因为我的数据已经被该键索引了。在 fetch 请求中对其进行排序会快得多。

我的猜测是，由于上下文中存在未保存的更改，并且 NSFetchRequest 转到 SQLite 数据库本身，其中更改尚不存在（未保存上下文），因此它根本无法在数据库级别进行排序。

但总的来说，它非常令人困惑，闻起来像个虫子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T23:50:11.073

我有完全相同的问题。我通过将 NSFetchRequest 实例中的 includesPendingChanges 属性设置为 NO 解决了这个问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-22T08:11:34.967

当使用默认的 compare: 选择器时，您可以简化描述符：

```
NSSortDescriptor* timeDescriptor = [NSSortDescriptor
                                        sortDescriptorWithKey:@"time"
                                        ascending:NO]; 
```

但这是一个问题。我认为关键是您正在从嵌套的子上下文进行更新。验证您的对象是否具有永久对象 ID；他们可能还没有收到它们，因此这可能是您获取的问题。如果是，则在保存嵌套子上下文之前尝试调用 objectPermanentIDsForObjects:。

# jquery - 如何使用jquery将文件传递到控制器

> ID：10253819
> 
> 赞同：1
> 
> 时间：2012-04-20T21:31:22.933
> 
> 标签：jquery, asp.net-mvc-3

我正在尝试使用 jquery 将文件传递给我的控制器，以便用户在上传后不必离开页面......

我似乎无法让它工作。一旦它传递给我的控制器，我就会不断获得“空引用”。这是我尝试过的：

控制器：

```
[HttpPost]
public ActionResult Upload(HttpPostedFileBase file)
{
var image = Path.GetFileName(file.FileName);

if (file != null && file.ContentLength > 0)
{
var fileName = Path.GetFileName(file.FileName);
var filePath = Path.Combine(Server.MapPath("~/Content/Images/UploadedImages/"), System.IO.Path.GetFileName(file.FileName));
file.SaveAs(filePath);

return Json(filePath.ToString());
}

else
{
return Json("Image failed to load");
}

} 
```

看法：

```
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm("Upload", "Home", FormMethod.Post, new { enctype = "multipart/form-data", id = "testupload", name = "testupload" }))
{

<div class="editor-field">
<input type="file" name="file" id="file" />
</div>

<input type="submit" value="Submit"/>
}

<input type="button" onclick="upload();" value="Upload" />

<input type="text" id="url"/> 
```

查询：

```
function upload() {

$.post("../../../Home/Upload", $("#testupload"), function (data) {
$("#url").val(data);
});
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:36:03.830

使用 ajax 无法做到这一点。

您需要创建一个隐藏`iframe`的，其中包含提交正确`form`的字段，并且您可以在表单返回时监视结果。`<input type="file" />``url`

这样一来，它就会显得无缝。

# c++ - 这是对虚拟继承的一种很好的利用吗？

> ID：10253821
> 
> 赞同：0
> 
> 时间：2012-04-20T21:31:40.343
> 
> 标签：c++, destructor, copy-constructor, assignment-operator, virtual-inheritance

我想跟踪一些选定类的对象的删除，类代码本身的变化很小。

我考虑过重载`delete`运算符（全局），但它要求我的重载`delete`存在于所有编译单元中，在我的情况下这可能很麻烦。此外，如果创建了跟踪对象的数组，我将不得不重载`delete[]`运算符，但不幸的是，在该重载代码中没有标准方法可以知道数组的长度以及正在销毁的对象数量。我也可以重载`new[]`运算符并跟踪分配及其长度，但它看起来不是一个干净的解决方案，并且遇到`delete[]`运算符的相同问题，即它必须在每个编译单元中都可以访问。

所以我接受了对目标类的轻微修改。我的想法是在目标类中“注入”监视类的析构函数，并带有“虚拟”（可能是多个）继承。当然，目标类可能是另一个的一个孩子，所以它看起来像是虚拟继承的工作。这是我到目前为止提出的。

```
class track_death{

protected:

    struct someusefulness{} info;

    track_death(){}

    explicit track_death(const track_death& o){
        copy_info(o);
    }

    track_death& operator=(const track_death& o){
        copy_info(o);
        return *this;
    }

    void copy_info(const track_death& o){
        //manage the copy of info, which is not trivial.
    }

    ~track_death(){
        //death has happened!
    }

};

struct anyclass: virtual track_death{
    //wathever 1...
};

struct anysubclass: public anyclass, virtual track_death{
    //wathever 2...

    anysubclass(){}

    anysubclass(const anysubclass& copythis){
        //initialization...

        //the user MUST append this last
        copy_info(copythis);
    }

};

struct anysubsubclass: public anysubclass, virtual track_death{
    //wathever 3...

    anysubsubclass& operator=(const anysubsubclass& copythis){
        //initialization...

        //the user MUST append this last
        copy_info(copythis);
        return *this;
    }

}; 
```

我有两个问题。

这是对虚拟继承的一种很好的用法吗？与[这个 parashift 建议](http://www.parashift.com/c++-faq-lite/multiple-inheritance.html#faq-25.9)`anysubsubclass`相反，使用 virtual 关键字（参见定义，它没有派生类）离开继承树中的最后一片叶子是否正确？关键是我想尽可能少地打扰我是否要在未来添加或删除，例如，在基类和最后一个派生类之间。`anysubsubclass``anysubclass`

第二。正如您在我的代码中看到的，如果其中一个目标类具有 或 的重载`operator=`，或者具有复制构造函数，则永远不会调用`operator=`或 的复制构造函数`track_death`，这是一个问题，因为`track_death`包含无法复制的字段使用其简单的复制构造函数。我的解决方案是告诉实现者`any*class`他必须调用`copy_info()`被复制的对象，这看起来很容易出错。有更好的解决方案吗？

# python - pytest 'ImportError: No module named YadaYadaYada' 的 PATH 问题

> ID：10253826
> 
> 赞同：313
> 
> 时间：2012-04-20T21:32:03.720
> 
> 标签：python, unit-testing, pytest

我使用 easy_install 在 Mac 上安装 pytest 并开始为具有如下文件结构的项目编写测试：

```
repo/
   |--app.py
   |--settings.py
   |--models.py
   |--tests/
          |--test_app.py 
```

在 repo 目录中运行`py.test`，一切都如你所料

但是当我在 linux 或 windows 上尝试同样的事情时（两者都有 pytest 2.2.3），每当它从我的应用程序路径中第一次导入某些东西时，它就会吠叫。比如说`from app import some_def_in_app`

我是否需要编辑我的 PATH 才能在这些系统上运行 py.test？有没有人经历过这个？

* * *

## 回答 #1

> 赞同：382
> 
> 时间：2015-12-07T18:21:06.537

我不确定为什么 py.test 没有在 PYTHONPATH 本身中添加当前目录，但这里有一个解决方法（从存储库的根目录执行）：

```
python -m pytest tests/ 
```

它之所以有效，是因为 Python 会为您在 PYTHONPATH 中添加当前目录。

* * *

## 回答 #2

> 赞同：271
> 
> 时间：2018-05-30T17:42:02.510

### `conftest`解决方案

`conftest.py`侵入性最小的解决方案是在目录中添加一个名为的空文件`repo/`：

```
$ touch repo/conftest.py 
```

就是这样。无需编写自定义代码来修改`sys.path`或记住拖动`PYTHONPATH`，或放入`__init__.py`不属于它的目录中（尽管按照[Apteryx](https://stackoverflow.com/users/2896799/apteryx)的[答案](https://stackoverflow.com/a/34140498/2650249)`python -m pytest`中的建议使用是一个很好的解决方案！）。

之后的项目目录：

```
repo
├── conftest.py
├── app.py
├── settings.py
├── models.py
└── tests
     └── test_app.py 
```

### 解释

`pytest`在测试集合上查找`conftest`模块以收集自定义钩子和固定装置，并且为了从中导入自定义对象，**`pytest`将 的父目录添加`conftest.py`到`sys.path`**（在本例中为`repo`目录）。

### 其他项目结构

如果您有其他项目结构，请将`conftest.py`放在包根目录中（包含包但本身不是包的目录，因此不**包含**）`__init__.py`，例如：

```
repo
├── conftest.py
├── spam
│   ├── __init__.py
│   ├── bacon.py
│   └── egg.py
├── eggs
│   ├── __init__.py
│   └── sausage.py
└── tests
     ├── test_bacon.py
     └── test_egg.py 
```

### `src`布局

虽然这种方法可以与`src`布局一起使用（放在`conftest.py`目录中`src`）：

```
repo
├── src
│   ├── conftest.py
│   ├── spam
│   │   ├── __init__.py
│   │   ├── bacon.py
│   │   └── egg.py
│   └── eggs 
│       ├── __init__.py
│       └── sausage.py
└── tests
     ├── test_bacon.py
     └── test_egg.py 
```

请注意，添加`src`to 会`PYTHONPATH`减轻`src`布局的意义和好处！您最终将测试来自存储库的代码，而不是已安装的包。如果你需要这样做，也许你根本不需要`src`目录。

### 从这往哪儿走

当然，`conftest`模块不仅仅是帮助源代码发现的一些文件；它是框架的所有特定于项目的增强`pytest`和测试套件的定制发生的地方。`pytest`有很多关于`conftest`分散在[他们文档](https://docs.pytest.org/)中的模块的信息；从[`conftest.py`：本地每个目录插件开始](https://docs.pytest.org/en/3.6.0/writing_plugins.html#conftest-py-plugins)

此外，SO 对`conftest`模块有一个很好的问题：[在 py.test 中，conftest.py 文件有什么用？](https://stackoverflow.com/q/34466027/2650249)

* * *

## 回答 #3

> 赞同：135
> 
> 时间：2013-09-24T01:20:44.237

我有同样的问题。我通过在我的目录中添加一个空`__init__.py`文件来修复它。`tests`

* * *

## 回答 #4

> 赞同：125
> 
> 时间：2012-04-20T21:39:12.060

`cd`是的，如果您访问测试目录，源文件夹不在 Python 的路径中。

您有 2 个选择：

1.  手动将路径添加到测试文件中，如下所示：

    ```
    import sys, os
    myPath = os.path.dirname(os.path.abspath(__file__))
    sys.path.insert(0, myPath + '/../') 
    ```

2.  使用 env var 运行测试`PYTHONPATH=../`。

* * *

## 回答 #5

> 赞同：56
> 
> 时间：2018-02-02T09:37:03.977

`pytest`将自身作为一个模块 运行：`python -m pytest tests`

* * *

## 回答 #6

> 赞同：38
> 
> 时间：2014-10-24T09:03:03.420

您可以在项目根目录中使用 PYTHONPATH 运行

```
PYTHONPATH=. py.test 
```

或者使用 pip install 作为可编辑的导入

```
pip install -e .   # install package using setup.py in editable mode 
```

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2016-07-15T13:46:39.053

我创建这个是为了回答你的问题和我自己的困惑。我希望它有所帮助。注意 py.test 命令行和 tox.ini 中的 PYTHONPATH。

[https://github.com/jeffmacdonald/pytest_test](https://github.com/jeffmacdonald/pytest_test)

具体来说：您必须告诉 py.test 和 tox 在哪里可以找到您所包含的模块。

使用 py.test 你可以这样做：

```
PYTHONPATH=. py.test 
```

使用 tox，将其添加到您的 tox.ini 中：

```
[testenv]
deps= -r{toxinidir}/requirements.txt
commands=py.test
setenv =
    PYTHONPATH = {toxinidir} 
```

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2020-03-10T07:41:03.477

我在 Flask 中遇到了同样的问题。

当我添加：

```
__init__.py 
```

到测试文件夹，问题消失了:)

可能应用程序无法将文件夹测试识别为模块

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2019-07-03T16:58:17.557

`__init__.py`我通过删除源的父文件夹中的顶级来修复它。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2017-08-14T16:44:07.427

`ConftestImportFailure: ImportError('No module named ...`当我不小心将`__init__.py`文件添加到我的 src 目录（不应该是 Python 包，只是所有源代码的容器）时，我开始遇到奇怪的错误。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2020-03-08T18:34:04.183

我在学习 Flask 教程时遇到了同样的问题，我在 Pytest 官方[文档](https://doc.pytest.org/en/latest/goodpractices.html)中找到了答案。 这与我（我认为许多其他人）习惯做事的方式有点不同。

您必须`setup.py`在项目的根目录中创建一个文件，其中至少包含以下两行：

```
from setuptools import setup, find_packages
setup(name="PACKAGENAME", packages=find_packages()) 
```

其中 PACKAGENAME 是您的应用程序的名称。然后你必须用 pip 安装它：

```
pip install -e . 
```

该`-e`标志告诉 pip 以可编辑或“开发”模式安装包。所以下次你运行`pytest`它应该在标准中找到你的应用程序`PYTHONPATH`。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-04-25T14:12:58.710

我有一个类似的问题。`pytest`无法识别安装在我工作环境中的模块。

我也通过安装`pytest`到相同的环境来解决它。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-12-17T21:22:57.187

此外，如果您在虚拟环境中运行`pytest`，请确保`pytest`模块已安装在您的虚拟环境中。激活您的虚拟环境并运行`pip install pytest`.

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-12-04T12:10:10.147

对我来说，问题是`tests.py`由 Django 和`tests`目录一起产生的。删除`tests.py`解决了问题。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-01-16T17:07:24.873

我收到了这个错误，因为我错误地使用了相对导入。在 OP 示例中，test_app.py 应该使用例如导入函数

```
from repo.app import * 
```

然而 __init__.py 文件散布在文件结构周围，这不起作用**并**创建了 ImportError 类型，除非文件和测试文件位于同一目录中。

```
from app import * 
```

这是我对我的一个项目所做的一个例子：

这是我的项目结构：

```
microbit/
microbit/activity_indicator/activity_indicator.py
microbit/tests/test_activity_indicator.py 
```

为了能够从 test_activity_indicator.py 访问 activity_indicator.py，我需要：

*   使用正确的相对导入启动 test_activity_indicatory.py：

```
 from microbit.activity_indicator.activity_indicator import * 
```

*   将 __init__.py 文件放在整个项目结构中：

```
 microbit/
    microbit/__init__.py
    microbit/activity_indicator/__init__.py
    microbit/activity_indicator/activity_indicator.py
    microbit/tests/__init__.py
    microbit/tests/test_activity_indicator.py 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2021-07-28T17:00:17.303

这是python中的一个问题有点遗憾......但只需添加这个环境变量是IMO最舒服的方式：

```
export PYTHONPATH=$PYTHONPATH:. 
```

您可以使用`direnv`它来自动发生:)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-08-28T02:56:21.097

由于更简单的事情（你甚至可以说微不足道），我得到了这个错误。我没有安装`pytest`模块。所以一个简单`apt install python-pytest`的为我解决了它。

'pytest' 将作为测试依赖项列在 setup.py 中。确保您也安装了测试要求。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-11-02T15:09:27.777

由于没有人建议，您还可以将路径传递给`pytest.init`文件中的测试：

```
[pytest]
...
testpaths = repo/tests 
```

请参阅文档：[https ://docs.pytest.org/en/6.2.x/customize.html#pytest-ini](https://docs.pytest.org/en/6.2.x/customize.html#pytest-ini)

VScode 的副作用：它应该在 UI 中进行单元测试。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-02-29T04:37:39.557

根据[Dirk Avery 在 Medium 上的一篇文章](https://medium.com/@dirk.avery/pytest-modulenotfounderror-no-module-named-requests-a770e6926ac5)（并得到我个人经验的支持），如果您在项目中使用虚拟环境，那么您不能使用系统范围的 pytest 安装；您必须在虚拟环境中安装它并使用该安装。

特别是，如果您在两个地方都安装了它，那么简单地运行该`pytest`命令将不起作用，因为它将使用系统安装。正如其他答案所描述的，一个简单的解决方案是运行`python -m pytest`而不是`pytest`; 这是有效的，因为它使用环境的 pytest 版本。或者，您可以只卸载系统版本的 pytest；重新激活虚拟环境后，该`pytest`命令应该可以工作。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-07-29T23:32:33.087

[正如Luiz Lezcano Arialdi](https://stackoverflow.com/users/1481623/luis-lezcano-airaldi)所指出的，正确的解决方案是将您的包安装为可编辑的包。

由于我使用的是 pipenv，我考虑在他的答案中逐步添加如何使用 pipenv 将当前路径安装为可食用的，从而允许运行 pytest 而无需任何修改代码或松散文件。

您将需要具有以下最小文件夹结构（[文档](https://packaging.python.org/tutorials/packaging-projects/)）：

```
package/
    package/
        __init__.py
        module.py
    tests/
        module_test.py
    setup.py 
```

setup.py 大多数具有以下最小代码（[文档](https://setuptools.readthedocs.io/en/latest/setuptools.html#new-and-changed-setup-keywords)）：

```
import setuptools

setuptools.setup(name='package', # Change to your package name
                 packages=setuptools.find_packages()) 
```

然后你只需要运行`pipenv install --dev -e .`，pipenv 就会将当前路径安装为一个可编辑的包（--dev 标志是可选的）（[文档](https://pipenv.pypa.io/en/latest/basics/#editable-dependencies-e-g-e)）。

现在你应该可以`pytest`毫无问题地运行了。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-09-05T06:53:45.257

我们通过添加以下环境变量解决了这个问题。

```
PYTHONPATH=${PYTHONPATH}:${PWD}/src:${PWD}/test 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2019-10-05T17:01:30.577

很多时候由于模块无法导入而中断测试，经过研究，我发现系统在错误的位置查看文件，我们可以通过复制包含模块的文件轻松解决问题，在与所述相同的文件夹，以便正确导入。另一个解决方案建议是更改导入的声明并向 MutPy 显示单元的正确路径。但是，由于多个单元可以具有这种依赖关系，这意味着我们还需要在它们的声明中提交更改，我们更愿意简单地将单元移动到文件夹中。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2020-05-21T07:11:47.473

我的解决方案：

在包含以下内容的目录中创建`conftest.py`文件`test`：

```
import os
import sys
sys.path.insert(0,os.path.dirname(os.path.realpath(__file__)) + "/relative/path/to/code/") 
```

这会将感兴趣的文件夹添加到 python 路径中**，而无需修改每个测试文件**、设置环境变量或弄乱绝对/相对路径。

# command-line - 使用 NodeJS 在 Windows 上编译 CoffeeScript

> ID：10253827
> 
> 赞同：0
> 
> 时间：2012-04-20T21:32:09.523
> 
> 标签：command-line, coffeescript

我已经安装了 nodejs，使用 npm 安装了 coffee 并注册了环境变量，现在我准备第一次将我的 CoffeeScript 编译成 JavaScript。

我正在运行以下命令`c:\MyCoffeeScriptProject\`

```
coffee --compile --output js/ 
```

接下来发生的是我得到了交互式窗口，而“js”文件夹中没有任何内容。

```
coffee> 
```

我期望所有`.coffee`文件都作为文件编译到“js”文件夹中`.js`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T21:38:59.203

您没有告诉它要编译哪些文件。

```
Usage: coffee [options] path/to/script.coffee [args] 
```

在当前目录的末尾附加一个句点。

```
coffee --compile --output js/ . 
```

如果你重新排列它，它会更容易阅读。

```
coffee --output js/ --compile . 
```

将所有咖啡文件编译`.`成`js/`

一个常见的使用模式是有一个`src`文件夹。

```
coffee --output js/ --compile src/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-30T20:38:57.463

```
c:/parent>coffee --output output  --compile src 
```

其中“输出”是空白文件夹，“src”文件夹包含咖啡文件。在 src 级别执行命令。

# c# - 无法克服此错误：对象引用未设置为对象的实例

> ID：10253829
> 
> 赞同：0
> 
> 时间：2012-04-20T21:32:13.837
> 
> 标签：c#, asp.net

这是我的代码：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (Session[ "DistID" ] != "" )
        {
            DistInfo distInfo = GeneralFunctions.GetGeneralInformation( ( int )Session[ "DistID" ] );
            launchDate.Text = distInfo.AnticipatedLaunchDate.ToShortDateString();
        }
    }

    public static DistInfo GetGeneralInformation ( int ClientID )
    {
        using ( var conn = new SqlConnection( GetConnectionString() ) )
        using ( var cmd = conn.CreateCommand() )
        {
            conn.Open();
            cmd.CommandText =
            @"SELECT i.GoLiveDate, i.FirstBonusRun, i.TechFName, i.TechLName, i.TechEmail, i.TechPhone, i.WebISPFName, i.WebISPLName, 
              i.WebISPEmail, i.WebISPPhone, i.FullFillFName, i.FullFillLName, i.FullFillEmail, i.FullFillPhone, d.FName,
              d.LName, d.HomePhone, d.Email
              FROM NC_Information i
              INNER JOIN Distributor d
                ON d.DistID = i.ClientID
              WHERE clientID = @value";
            cmd.Parameters.AddWithValue( "@value", ClientID );
            using ( var reader = cmd.ExecuteReader() )
            {
                while ( reader.Read() )
                {
                    var distInfo = new DistInfo
                    {
                        AnticipatedLaunchDate = reader.GetDateTime( reader.GetOrdinal( "GoLiveDate" ) )
                    };

                    return distInfo;
                }
            }
            return null;
        }
    }

public class DistInfo
{
    public DateTime AnticipatedLaunchDate { get; set; }
} 
```

这是错误：

```
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.

Source Error:

Line 14:         if (Session[ "DistID" ] != "" )
Line 15:         {
Line 16:             DistInfo distInfo = GeneralFunctions.GetGeneralInformation( ( int )Session[ "DistID" ] );
Line 17:             launchDate.Text = distInfo.AnticipatedLaunchDate.ToShortDateString();
Line 18:         }

Source File: c:\inetpub\wwwroot\Base\ClientAccessPortal\GeneralInformation.aspx.cs    Line: 16 
```

数据库可以从数据库返回 DateTime、空 DateTime 或 NULL 的 i.GoLiveDate（将是 AnticipatedLaunchDate）的值。我不确定如何克服这个错误。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:35:37.070

`Session["DistID"]`正在返回 null，您尝试将其转换为整数。

您检查空字符串，但空值将通过该检查 - 使用`IsNullOrEmpty`或如果 .Net 4.0`IsNullOrWhitespace`来检查两者。

```
string distId = Session[ "DistID" ];
if ( !string.IsNullOrWhiteSpace( distId ) )
{ ... } 
```

既然您知道您有一个非 null 非空字符串，请确保它是一个 int：

```
string distId = Session[ "DistID" ];    
int distIdValue;

if( !string.IsNullOrWhiteSpace( distId ) && integer.TryParse( distId, out distIdValue ) )
{
    DistInfo distInfo = GeneralFunctions.GetGeneralInformation( distIdValue );
    launchDate.Text = distInfo.AnticipatedLaunchDate.ToShortDateString();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:35:43.820

在第 16 行，如果 Session[ "DistID" ] 为空，则 (int) 的情况将失败。

因此，您需要将 Session["DistID"] 分配给一个临时变量，并在将其转换为整数之前对其进行非空测试。

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (Session[ "DistID" ] != "" )
        {
            var distId = Session[ "DistID" ];
            if (distId != null) {
              DistInfo distInfo = GeneralFunctions.GetGeneralInformation( ( int )Session[ "DistID" ] );
              launchDate.Text = distInfo.AnticipatedLaunchDate.ToShortDateString();
            } else {
              // default display value
            }
        }
    } 
```

# core-data - 多对多关系的核心数据删除规则

> ID：10253830
> 
> 赞同：2
> 
> 时间：2012-04-20T21:32:16.070
> 
> 标签：core-data, nspredicate, object-model

我有一个带有容器和项目实体的核心数据模型。一个容器中可以有零个或多个项目。一个项目必须至少属于一个容器（但它可以在多个容器中。）

关系如下所示：

```
Container:
  Relationship: items, Destination: Item, Inverse: itemContainers
  Optional, To-Many Relationship
  Delete Rule: Nullify

Item:
  Relationship: itemContainers, Destination: Container, Inverse: items
  Not-Optional, To-Many Relationship
  Delete Rule: Cascade 
```

删除容器时会出现问题。该容器中的 Item 对象已更新，但如果该项目仅存在于一个容器中，则 itemContainers 属性是一个没有对象的集合。保存对象图失败，因为该空集违反了 Item 的 itemContainers 的非可选设置。

当然，使用像“itemContainers.@count == 0”这样的NSPredicate很容易找到带有空itemContainers的Item对象，但似乎应该有一种方法来配置模型以自动执行此操作。

那么有没有更简单/更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T02:20:28.680

我在上面尝试了[Tony Arnold 的回答](https://stackoverflow.com/a/10254033/1858362)来解决类似的问题，但是在一次删除多个“容器”时发现了问题（这是在 OS X 10.8.2 上）。`[item itemContainers]`在保存托管对象上下文之前不会删除容器，因此`count`保持在 1 以上并且`item`永远不会被删除。

我想出了以下解决方案`-[NSManagedObject isDeleted]`，在`NSManagedObject`.

**文件`NSManagedObject+RJSNondeletedObjects.h`**

```
#import <CoreData/CoreData.h>

@interface NSManagedObject (RJSNondeletedObjects)

- (NSSet *)RJS_nondeletedObjectsForToManyKeyPath:(NSString *)keyPath;
- (BOOL)RJS_hasOtherNondeletedObjectsForToManyKeyPath:(NSString *)keyPath;

@end 
```

**文件`NSManagedObject+RJSNondeletedObjects.m`**

```
#import "NSManagedObject+RJSNondeletedObjects.h"

@implementation NSManagedObject (RJSNondeletedObjects)

- (NSSet *)RJS_nondeletedObjectsForToManyKeyPath:(NSString *)keyPath
{
    NSSet * result = nil;

    id allObjectsForKeyPath = [self valueForKeyPath:keyPath];

    if ( ![allObjectsForKeyPath isKindOfClass:[NSSet class]] ) return result;

    result = [(NSSet *)allObjectsForKeyPath objectsPassingTest:^BOOL(id obj, BOOL *stop)
    {
        BOOL testResult = ![obj isDeleted];
        return testResult;
    }];

    return result;
}

- (BOOL)RJS_hasOtherNondeletedObjectsForToManyKeyPath:(NSString *)keyPath
{
    BOOL result = NO;

    // self will be in the set of nondeleted objects, assuming it's not deleted. So we need to adjust the test threshold accordingly.
    NSUInteger threshold = [self isDeleted] ? 0 : 1;
    NSSet * nondeletedObjects = [self RJS_nondeletedObjectsForToManyKeyPath:keyPath];
    result = ( [nondeletedObjects count] > threshold );

    return result;
}

@end 
```

**`Container`班级**

```
...
#import "NSManagedObject+RJSNondeletedObjects.h"
...
- (void)prepareForDeletion
{
    NSSet *childItems = [self items];

    for (Item *item in childItems) {
        if ([item RJS_hasOtherNondeletedObjectsForToManyKeyPath:@"containers"]) {
            continue;
        }

        [managedObjectContext deleteObject:item];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:50:48.690

我知道它不像 Core Data 提供的配置选项那么干净，但是我已经部署了一些项目，其中对象在被删除时`Container`循环通过它的子实体，检查它们是否有 0 （在 'Container.m' 内）：`Item``itemContainers`

```
- (void)prepareForDeletion
{
    NSSet *childItems = [self items];

    for (Item *item in childItems) {
        if ([[item itemContainers] count] > 1) {
            continue;
        }

        [managedObjectContext deleteObject:item];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:52:52.283

在我的应用程序中，我将项目的容器关系设为可选，并通过“智能容器”授予对这些无容器项目的访问权限。

如果你不想这样，我怀疑你只需要处理保存失败，并删除违规对象。

我越来越多地将我对核心数据的处理方式转变为一种防御方式：假设验证将失败，并准备好处理它。当您集成 iCloud 同步时，它变得更加重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T14:12:12.527

我喜欢这样做：

```
- (void)didChangeValueForKey:(NSString *)inKey withSetMutation:(NSKeyValueSetMutationKind)inMutationKind usingObjects:(NSSet *)inObjects
{
    [super didChangeValueForKey:inKey withSetMutation:inMutationKind usingObjects:inObjects];

    if ([inKey isEqualToString:@"YOURRELATIONSHIP"] && self.YOURRELATIONSHIP.count == 0) {
        [self.managedObjectContext deleteObject:self];
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-22T06:31:35.953

我不认为你可以在你的模型中指定这种行为，但我不是进行那个获取，而是你可以验证`itemContainers`容器中的计数

```
 - (void)removeItemObject:(Item *)value
{...
if(![[value itemContainers]count])
  [context deleteObject:value];
...
} 
```

# php - 如何让 php 在新选项卡中打开 pdf 文件？

> ID：10253839
> 
> 赞同：0
> 
> 时间：2012-04-20T21:32:50.487
> 
> 标签：php, file, codeigniter, pdf, file-upload

我不明白我一直在阅读的文档。任何人都可以在这里解释如何做到这一点？

我有一个指向函数 showFile() 的 HTML 链接。有两个获取，一个 id，它是文件名，一个 ext，文件的扩展名。（只有扩展名将是 pdf、jpg 和 gif）我正在使用 codeigniter framwework btw。

我阅读了有关标题的内容，但是当我尝试它时，它只是下载了文件。任何帮助，将不胜感激。

功能至今---------

```
 public function showFile () {
    $fileId = $this->input->get('id');
    $fileExt = $this->input->get('ext');

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:34:49.827

在 HTML 中是这样的：

```
<a href="downloadfile.php?filesrc=blah.pdf" target=_new>
    Click here to download blah.pdf</a> 
```

当然，href 必须`echo`在 PHP 中编辑。

```
<a href="downloadfile.php?filesrc=<?php echo $filepath ?>" target=_new> ... </a> 
```

哦，downloadfile.php 将简单地`header('...');`重定向到该文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T00:12:44.417

```
class Files extends CI_Controller{

    public function show_file($id, $ext){
       $file_location = '';
       switch($ext){
           case 'pdf':
             $file_location = 'location-to_pdf_files'; // store as constant maybe inside index.php - PDF = 'uploads/pdf/';

             //must have PDF viewer installed in browser !
          $this->output
           ->set_content_type('application/pdf')
           ->set_output(file_get_contents($file_location . '/' . $id . '.pdf'));

           break;
           //jpg gif etc here...
       }

    }
} 
```

-

```
$route['view/(:any)/(:any)'] = 'files/show_file/$1/$2'; 
```

-

```
<a href="<?php echo site_url('view/picture/pdf');?>" rel="nofollow" target="_blank">Some_file<a/> 
```

# c# - C# 单元测试，使用 zip 文件中的 XML

> ID：10253841
> 
> 赞同：1
> 
> 时间：2012-04-20T21:33:23.137
> 
> 标签：c#, xml, unit-testing

我有一个类，它接受一个字符串作为 xml 文件的路径并输出一个对象。我想使用 NUnit 和一些预先生成的测试脚本来测试这个类。

我有一个 zip 文件中的脚本并包含在项目中。我想做这样的事情：

```
// Not sure how to do this
List<byte[]> scripts = GetTheScriptsSomehow();

foreach(var script in scripts )
{
  var parsedScript = ScriptParser.Parse(script);
  Assert.AreEqual(parsedScript.Blah, "BLAH");
} 
```

我最关心的部分是如何访问被压缩的脚本和项目的一部分。

谢谢！

编辑：为了解决一些评论，zip 文件是单元测试项目的一部分，而不是发布的代码库。它包含应该产生可测试的已知输出的测试脚本。它们被压缩是因为脚本相当大（每个 100mb）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:39:55.497

在资源（项目属性/资源/添加资源/添加现有文件）中添加这个zip文件，并使用SharpZipLib从zip中提取它，假设你的zip文件是

> 脚本.zip

在字符串中提取脚本的代码：

```
ZipInputStream zip = new ZipInputStream(new MemoryStream(Properties.Resources.scripts));
while (zip.GetNextEntry() != null)
{
  MemoryStream data = new MemoryStream();
  zip.CopyTo(data);
  data.Position = 0;
  string scriptContents = new StreamReader(data).ReadToEnd();
  /// do something with scriptContents variable
} 
```

以下是 SharpZipLib 使用的一些示例：

[http://wiki.sharpdevelop.net/SharpZipLib-Zip-Samples.ashx](http://wiki.sharpdevelop.net/SharpZipLib-Zip-Samples.ashx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:39:05.883

C# 本身没有办法管理 zip 文件。不过，您可以使用 J#。

[http://msdn.microsoft.com/en-us/magazine/cc164129.aspx](http://msdn.microsoft.com/en-us/magazine/cc164129.aspx)

或者你可以考虑通过命令行解压到一个临时目录。

[如何使用命令行解压缩文件？](https://stackoverflow.com/questions/1021557/how-to-unzip-a-file-using-the-command-line)

# c++ - c++：我可以将同一个对象放入一个集合中两次吗？

> ID：10253849
> 
> 赞同：0
> 
> 时间：2012-04-20T21:34:06.680
> 
> 标签：c++, collections, dynamic-memory-allocation

例如，我正在使用命令模式并将命令添加到队列中。队列中的条目是 CommandItems，它就像一个简单的结构，包含命令对象和执行命令的时间。

```
struct CommandItem
{
  time_t theTime;
  std::shared_ptr<Command> command;
  ...
  // comparison operator implemented
}

std::priority_queue<CommandItem> commandQueue_; 
```

如果我想在不同的时间两次执行相同的命令，这样队列中的命令会有两个 CommandItems，我是否需要构造两个单独的命令对象？或者我可以将相同的命令对象放入两次吗？优点缺点？

（注意使用shared_ptr命令对象，队列需要保存各种子类的命令对象）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:38:01.297

这就是 a 的全部意义`shared_ptr`，你可以有多个指向同一个对象的指针，当没有人需要它时，该对象将被自动删除。

由于您的 Command 类具有子类，因此请确保它具有虚拟析构函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:38:44.227

这取决于您的实现，但通常我建议为单独的操作实例创建单独的对象（即使它是相同的操作）。

由于它是一个指针，因此它将是集合中的一个不同实例（即使某些集合允许同一项目的多个实例）。

# java - PushbackReader 等价物

> ID：10253850
> 
> 赞同：1
> 
> 时间：2012-04-20T21:34:07.897
> 
> 标签：java, parsing, io, nio

一个有点模糊的问题，我提前道歉。

我正在借助 Building Parsers with Java 一书构建小型解析器的标记化部分。它使用 PushbackReader 和其中包含的字符串作为首先检测给定字符串的第一个字符的方法，然后将 PushbackReader 发送到适当的状态（然后该状态将令牌构建为包含字符串的单独对象）。

PushbackReader 似乎仅在流中未找到其他使用字符时才使用。然后它会取消读取最后一个字符。

是否可以用 CharBuffer 的追加来做同样的事情？最好是不需要预定义缓冲区的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T16:48:03.890

根据我所见，他选择 PushbackReader 有两个原因：

1.  他需要一个可以处理单个字符的阅读器。
2.  他需要在流中进行备份，因为在进行标记时，他需要提前查看一个或多个字符来确定当前字符是否是标记的一部分。

例如，使用 WhitespaceState.nextToken 方法，他正在跳过空白字符。他拉下一个角色并看着它。如果它是一个空白字符，他会拉下一个字符。当他最终拉出一个不是空格的字符时，他将其放回流中，因此查看流的下一个方法将查看正确的字符。

虽然你可以用只有两个方法 read() 和 unread() 的更简单的方法来替换它，但你必须记住，这样做你可能会

1.  读入整个输入，然后处理输入。因此，如果您有一个大文件，您将占用内存来存储它。
2.  将输入作为流读取一次，但将来自 unread() 的字符存储并在单独的结构中传递它们。

使用 PushbackReader，他通过输入读取和处理一次，他不必缓冲整个输入，也不必存储 unread() 字符并单独传递它们

# java - 在 Java 中，首先在类的主体中声明和初始化 java.util.(ex. list) 而不是仅导入的优点是什么？

> ID：10253853
> 
> 赞同：2
> 
> 时间：2012-04-20T21:34:19.630
> 
> 标签：java

例如，

```
public final static java.util.List VALUES = 
  Collections.unmodifiableList( 
    Arrays.asList( new Suit[] { CLUBS, DIAMONDS, HEARTS, SPADES } ) ); 
```

写它的方式让我很困惑。我已经习惯了看到 java.util 被导入。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T21:35:41.843

除非你有*另一个* `List`已经被导入的类，否则这样做没有任何好处。也许这里就是这种情况？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T21:35:54.917

如果您进行导入，您的代码将更具可读性，特别是当您多次使用同一个类时。

我认为**这**更具可读性：

```
import java.util.List;

class A {
    List l1;
    List l2;
} 
```

比**这个**：

```
class A {
    java.util.List l1;
    java.util.List l2;
} 
```

当您开始在某些声明上使用**泛型**时，事情会变得更加清晰。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:38:34.307

没有区别。某处可能有一个“最佳实践”，指出您应该导入而不是尽可能提供完全命名空间的类（或者可能相反）。

当您开始一起使用 3rd 方库时，使用完整的命名空间而不是仅仅进行导入会变得很有用。说，例如，您有一个库来解析 csv 和另一个库来构建 xml（将 csv 构建为 xml）。两个库都可能声明一个名为“Parser”的类。如果您同时导入它们，编译器将无法判断您指的是哪个“解析器”类，因此您可能希望使用完整的命名空间，而不是简单地导入。

# python - 复制与深度复制：语义

> ID：10253855
> 
> 赞同：6
> 
> 时间：2012-04-20T21:34:34.243
> 
> 标签：python, python-3.x, copy, deep-copy

我的班级代表各种系统的状态。每个实例都有两个属性：一个是同一系统所有状态之间共享的容器，另一个是每个实例唯一的容器。

状态的副本应重用“共享”属性，但创建“唯一”属性的深层副本。这实际上是唯一有意义的复制语义（状态的副本自然是同一系统的状态）。

我想为阅读和维护我的代码的人创造最小的惊喜。我应该覆盖`__deepcopy__`还是`__copy__`为了我的目的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T22:04:52.577

真的有必要使用 copy 模块来复制这个类的实例吗？我会争辩说，而不是重写`__copy__`，或者`__deepcopy__`您应该为您的类创建一个`copy`方法，该方法使用您定义的复制语义返回一个新对象。

如果出于某种一致性原因您确实需要使用复制模块，那么我认为`__deepcopy__`更合适。如果所有实例共享一个容器是类的定义行为，那么可以合理地假设实现`__deepcopy__`会尊重这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T22:08:36.453

这和你的情况相似吗？

```
import copy

class Foo(object):
    shared = [[]]
    def __init__(self):
        self.perinstance = [[]] 
```

如果是这样，那么您似乎不需要定义`__copy__`or `__deepcopy__`，因为`copy.deepcopy`共享类属性和 deepcopy 实例属性的默认行为：

```
x = Foo()
z = copy.deepcopy(x)
assert id(z.shared) == id(x.shared)
assert id(z.shared[0]) == id(x.shared[0])
assert id(z.perinstance) != id(x.perinstance)
assert id(z.perinstance[0]) != id(x.perinstance[0]) 
```

# html - 表格位置变化

> ID：10253858
> 
> 赞同：0
> 
> 时间：2012-04-20T21:34:48.863
> 
> 标签：html, css

我有一个表格，在页面右侧显示有关项目的信息。该表有一个 td 显示项目的描述。描述文本的数量会根据选择的项目而变化。在页面的左侧，我有一个表格。我希望放置此表单以使其不会移动。但是随着项目描述的变化，表单会重新定位。有人知道为什么吗？

请参阅下面的图片。第一个图像是我想要表单的位置。第二张图片显示了当描述较少时会发生什么。

![在此处输入图像描述](../Images/31cde1c05b3075cfc501b934b8b4539e.png) ![在此处输入图像描述](../Images/a36056db773808769438ddebd0203fbe.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:42:26.333

在我看来，您的代码可能设置得很奇怪。您想要一个 2 列布局。然后一列的内容不会影响另一列。

如果这不起作用，您始终可以使用 css 绝对定位表单，如下所示：

```
position:absolute;
top:20px;
left:20px; 
```

如果您可以发布您使用的代码，它将极大地帮助我的回答

# php - 从命令行运行自定义 MediaWiki php 脚本：php 脚本不执行任何操作并且不产生错误消息

> ID：10253862
> 
> 赞同：0
> 
> 时间：2012-04-20T21:35:02.967
> 
> 标签：php, mediawiki

我需要修改数据传输插件，以便可以从命令行导入 CSV（无需与 Web 界面交互）。

所以我研究并修改了 DT_ImportCSV.php 文件，所以它使用命令行参数来获取输入文件的名称。此外，我添加了一些可执行代码，使其不仅仅是类声明。

我将其保存为 DT_ImportCSV2.php 并将其作为“php DT_ImportCSV2.php myfile.csv”运行。没有任何反应，也没有显示错误消息。此外，我在我的程序中添加了一些 printf 调用，但它们都没有打印任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T03:05:39.033

您的 PHP 脚本在到达这些行之前中止。有上百万个可能的原因，首先按照此处的说明打开调试并检查日志：

[http://www.mediawiki.org/wiki/Manual:How_to_debug](http://www.mediawiki.org/wiki/Manual:How_to_debug)

# css - 是否有针对无法正确清除的浮动元素的 IE 7 解决方法？

> ID：10253863
> 
> 赞同：2
> 
> 时间：2012-04-20T21:35:03.470
> 
> 标签：css, internet-explorer-7, css-float

我看到很多针对其他 CSS 浮动问题的 IE 7 解决方法，但我还没有找到解决这个问题的方法：当一个元素同时具有`clear`和`float`属性时，清除无法正常工作。

[这个 jsFiddle 说明了这个问题](http://jsfiddle.net/9qwJX/)。我正在尝试解决一个非常基本的问题。我有一个带有标签/表单项对的表单。标签应该在左边，表单项应该在标签的右边。下一个标签应显示在下一行。使用这个简单的 HTML：

```
<fieldset>
  <label>Label 1:</label>
  <input type="text" />

  <label>Label 2:</label>
  <input type="text" />
</fieldset> 
```

这个 CSS 应该足够了：

```
label {
    width: 200px;
    text-align: right;
    clear: both;
    float: left;
}

input {
    float: left;
} 
```

然而，发生的事情是，虽然第二个标签清除了浮点数并呈现在下一行，但相邻的输入仍然显示在第一行。

除了添加更多标记之外，是否有任何解决此问题的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T22:10:48.530

如果将组括在单独的 div 中，问题就解决了。当然，那时您甚至根本不需要清除。

[http://jsfiddle.net/Qh87k/1/](http://jsfiddle.net/Qh87k/1/)

# java - Netbeans 无法构建签名的 Jar

> ID：10253865
> 
> 赞同：0
> 
> 时间：2012-04-20T21:35:08.443
> 
> 标签：java, netbeans-7.1

当我只是清理和构建时，我没有收到任何错误，我可以毫无问题地运行 *.java 文件。但是当我点击运行项目时（带有绿色三角形的按钮）。构建项目后，我在下面收到此错误消息。

```
init:
Deleting: /home/danny/NetBeansProjects/Home Security Survelliance Server/build/built-jar.properties
deps-jar:
Updating property file: /home/danny/NetBeansProjects/Home Security Survelliance Server/build/built-jar.properties
compile:
Copy libraries to /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/lib.
Building jar: /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/Home_Security_Survelliance_Server.jar
To run this application from the command line without Ant, try:
javaws "/home/danny/NetBeansProjects/Home Security Survelliance Server/dist/launch.jnlp"
jnlp:
sign-jars:
Signing JAR: /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/Home_Security_Survelliance_Server.jar to /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/Home_Security_Survelliance_Server.jar as selfsigned
Signing JAR: /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/lib/javacpp.jar to /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/lib/javacpp.jar as selfsigned
Signing JAR: /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/lib/javacv-linux-x86_64.jar to /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/lib/javacv-linux-x86_64.jar as selfsigned
Signing JAR: /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/lib/javacv.jar to /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/lib/javacv.jar as selfsigned
generate-jnlp:
Copying 1 file to /home/danny/NetBeansProjects/Home Security Survelliance Server/dist
Deleting: /home/danny/NetBeansProjects/Home Security Survelliance Server/dist/launch.jnlp_
generate-html-preview:
jar:
jws-run:
/home/danny/NetBeansProjects/Home Security Survelliance Server/nbproject/jnlp-impl.xml:355: Execute failed: 
java.io.IOException: Cannot run program "/usr/lib/jvm/java-7-openjdk-amd64/jre/bin/javaws" (in directory "/home/danny/NetBeansProjects/Home Security Survelliance Server"): error=2, No such file or directory
    at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)
    at java.lang.Runtime.exec(Runtime.java:615)
    at org.apache.tools.ant.taskdefs.Execute$Java13CommandLauncher.exec(Execute.java:862)
    at org.apache.tools.ant.taskdefs.Execute.launch(Execute.java:481)
    at org.apache.tools.ant.taskdefs.Execute.execute(Execute.java:495)
    at org.apache.tools.ant.taskdefs.ExecTask.runExecute(ExecTask.java:631)
    at org.apache.tools.ant.taskdefs.ExecTask.runExec(ExecTask.java:672)
    at org.apache.tools.ant.taskdefs.ExecTask.execute(ExecTask.java:498)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    at sun.reflect.GeneratedMethodAccessor125.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:390)
    at org.apache.tools.ant.Target.performTasks(Target.java:411)
    at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
    at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
    at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
    at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
    at org.apache.tools.ant.module.bridge.impl.BridgeImpl.run(BridgeImpl.java:285)
    at org.apache.tools.ant.module.run.TargetExecutor.run(TargetExecutor.java:539)
    at org.netbeans.core.execution.RunClassThread.run(RunClassThread.java:153)
Caused by: java.io.IOException: error=2, No such file or directory
    at java.lang.UNIXProcess.forkAndExec(Native Method)
    at java.lang.UNIXProcess.<init>(UNIXProcess.java:135)
    at java.lang.ProcessImpl.start(ProcessImpl.java:130)
    at java.lang.ProcessBuilder.start(ProcessBuilder.java:1021)
    ... 22 more
BUILD FAILED (total time: 10 seconds) 
```

我究竟做错了什么？我在罐子上签错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T22:33:37.713

我知道回答我自己的问题很愚蠢。但我通过取消选中 web start 解决了这个问题。我想我需要检查 web start 来签署我的 jar。但它没有它的迹象。

# android - 任何方式来判断布局中的任何按钮何时未按下

> ID：10253868
> 
> 赞同：0
> 
> 时间：2012-04-20T21:35:33.820
> 
> 标签：android

（Android 3.2）我有一个带有 9 个按钮的 TableLayout。我想知道它们中的任何一个何时未按下，即按下完成时，即 ACTION_UP。我不在乎哪个按钮，我只想知道任何被按下的按钮何时刚刚被释放。

我希望 XML 中有一个**Android::onTouch**，就像有一个 Android::onClick 一样，我可以将它们全部指向一个 onTouch 事件处理程序以查找 ACTION_UP。但是没有。我试图避免编写 9 个单独的 OnTouchListener。

有什么建议么？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:47:00.827

你为什么不从代码中添加onTouchListener，事实上，当你有ACTION_UP时做你想做的事，如此[处所示](http://developer.android.com/reference/android/view/View.OnTouchListener.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:50:43.390

为什么不只创建一个监听器：

```
OnTouchListener listener = new OnTouchListener() {
    @Override
    public boolean onTouch(View v, MotionEvent event) {
        Button b = (Button) v; // the button that just gets released
        if (event.getAction() == MotionEvent.ACTION_UP) {
            ...
        }
    }
}); 
```

并使用循环附加到所有按钮：

```
Button buttons[] = {...};
for (Button b : buttons) {
    b.setOnTouchListener(listener);
} 
```

或者：

```
int button_ids[] = {R.id.button1, R.id.button2, R.id.button3, ...};
for (int id : button_ids) {
    ((Button) findViewById(id)).setOnTouchListener(listener);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T21:51:54.780

您可以通过编程方式而不是在 XML 中将每个视图分配给单个 onTouch 侦听器。

做一个听众：

```
private View.OnTouchListener myListener = new View.OnTouchListener() {
    @Override
    public boolean onTouch(View view, MotionEvent motionEvent) {
        // Your logic            
        return false;
    }
}; 
```

然后将其添加到每个按钮。

```
findViewById(R.id.btn1).setOnTouchListner(myListener);
findViewById(R.id.btn2).setOnTouchListner(myListener); 
```

理想情况下，您可以以编程方式创建这些按钮，而不是从 xml 中引用它们，这样您就可以在循环中执行此操作，或者可能将它们放在一个 ViewGroup 中并迭代其子项并以这种方式添加侦听器。

# servlets - 登录后如何在重定向的 URL 中保留查询字符串？

> ID：10253872
> 
> 赞同：0
> 
> 时间：2012-04-20T21:35:44.417
> 
> 标签：servlets, redirect, login, query-string

我已经设置了一个登录页面`login.jsp`。每当我去`login.jsp`指定其他查询字符串时，例如

> login.jsp?你好

并单击登录，我被重定向到`index.jsp`并且`?hello`查询字符串被剥离。

有没有办法保留查询字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T03:28:48.560

如果您使用的是容器管理的身份验证，那么这是不可能的。*仅当查询字符串实际上位于最终用户首先显示登录页面的*受限 URL 中时，才会自动处理它。成功登录后，容器将**自动**重定向回受限制的 URL，并带有原始查询字符串。

如果您使用的是本地身份验证，则只需复制登录 URL 中的当前查询字符串。例如

```
<form action="login?${pageContext.request.queryString}" method="post">
    <input type="text" name="username" />
    <input type="password" name="password" />
    <input type="submit" value="login" />
</form> 
```

然后，在 servlet`doPost()`或您正在处理登录的任何地方，然后只需获取查询字符串`HttpServletRequest.getQueryString()`并在重定向时将其传递。例如

```
User user = userService.find(username, password);

if (user != null) {
    request.getSession().setAttribute("user", user); // Do whatever you need to represent a logged-in user.
    response.sendRedirect(request.getContextPath() + "/index.jsp?" + request.getQueryString());
}
else {
    // Show "unknown login" error?
} 
```

总而言之，我不确定在登录 URL 中包含查询字符串的功能要求在现实世界中是否有意义。如果该查询字符串是您需要首先登录的原始受限 URL 的一部分，这将更有意义，正如标准容器管理的身份验证机制所支持的那样。所以也许你需要重新考虑一个又一个。

# asp.net - UpdatePanel 中的自定义用户控件强制回发

> ID：10253873
> 
> 赞同：0
> 
> 时间：2012-04-20T21:35:49.643
> 
> 标签：asp.net

我有一个具有事件 (SelectedUserChanged) 的自定义用户控件。我在 UpdatePanel 中有这个控件，但是当控件执行事件时，整个页面都会进行回发，而不仅仅是更新面板。我到底在做什么？

我的用户控制：

```
public delegate void SelectedUserChangedHandler(object sender, WebUserBrowserEventArgs e);

public event SelectedUserChangedHandler SelectedUserChanged;

protected void Page_Load(object sender, EventArgs e)
{
    if (Request["__EventTarget"] != null && Request["__EventTarget"] == "UcWebUserBrowser" && Request["__EventArgument"] != null)
    {
        int webUserID = Int32.Parse(Request["__EventArgument"]);
        if(SelectedUserChanged != null)
            SelectedUserChanged(this, new WebUserBrowserEventArgs(webUserID));
        //
    }
} 
```

我的更新面板：

```
<asp:UpdatePanel ID="updatePanelOpportunityLeaderContainer" runat="server">
 <ContentTemplate>
  <custom:UcWebUserBrowser ID="ucWebUserBrowserOpportunityLeader" runat="server" />
 </ContentTemplate>
</asp:UpdatePanel> 
```

# html - 桌子上的 CSS 不起作用

> ID：10253876
> 
> 赞同：2
> 
> 时间：2012-04-20T21:36:00.517
> 
> 标签：html, css, html-table, border

我有这个 HTML 表：

```
<table width="1100" border="1" style="text-align:center;" class="invoice">

<tr><td>&nbsp;</td><td>&nbsp;</td><td>Amount Due</td><td>Amount Enc.</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>CAD <?php echo $key['remainingbalance']; ?></td><td>&nbsp;</td></tr>

</table> 
```

使用这个 CSS：

```
table.invoice, th.invoice, td.invoice{
    border: 1px solid black;
} 
```

但是它不是我的表格的样式，我希望表格的所有边框，td 和 tr 都是 1px 纯黑色，为什么这不起作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T21:41:30.237

示例中的边框*仅*适用于表格。1) table.invoice -- 这指的是带有“发票”类的表
2) th.invoice -- 这指的是带有“发票”类的标题单元格
3) td.invoice -- 这指的是普通的具有“发票”类的表格单元格

所以 2 & 3 不适用，因为你的表格单元格上没有那个类。

您可以像这样更改样式：

```
table.invoice, .invoice th, .invoice td{
    border: 1px solid black;
}
table.invoice{border-collapse:collapse;} /* update following asker's comment */ 
```

...然后边框将应用于标题单元格和普通单元格。

# javascript - 如何从 HTML 字符代码中获取字符？

> ID：10253880
> 
> 赞同：5
> 
> 时间：2012-04-20T21:36:13.813
> 
> 标签：javascript, special-characters, html-entities

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T21:40:20.483

An example would be: `alert(String.fromCharCode(8364));`

Where 8364 is the number of the HTML entity.

To replace a full body of text automatically then you will need to use this regular expression replacement example:

```
"The price of milk is now &#8364;100000.".replace(/&#(\d{0,4});/g, function(fullStr, str) { return String.fromCharCode(str); }); 
```

The magic happens here:

`replace(/&#(\d{1,4});/g, function(fullStr, code) { return String.fromCharCode(code); });`

The first argument to replace, `/&#(\d{1,4});/g`, specifies 1 to 4 digits surrounded by &# and ; respectively. The second parameter, `function(fullStr, code) [...]` does the replacement, where `code` is the digits.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T22:55:43.580

You could use the browser's built-in HTML parser via `innerHTML`, which will have the advantage of handling all HTML entities, not just numeric ones. Note that the following will not work if the string passed to the function contains HTML tags.

```
function convertEntities(html) {
    var el = document.createElement("div");
    el.innerHTML = html;
    return el.firstChild.data;
}

var html = "&#8364; &#9658; &#9824; &quot; &amp;";
var text = convertEntities(html); // € ► ♠ " & 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T21:38:26.040

```
document.getElementById("myElement").innerHTML = "&#8364".fromCharCode(); 
```

Actually, scratch that, the `fromCharCode()` function is only available on the String object, so it would look like what **Will Morgan** said:

```
document.getElementById("myElement").innerHTML = String.fromCharCode(8364) 
```

# ruby-on-rails - Heroku Paperclip S3 错误 => AWS::S3::Errors::SignatureDoesNotMatch

> ID：10253882
> 
> 赞同：2
> 
> 时间：2012-04-20T21:36:39.820
> 
> 标签：ruby-on-rails, heroku, amazon-s3, paperclip

Paperclip+S3 可以在本地机器上工作，但不能在 Heroku 上工作。它说**“AWS::S3::Errors::SignatureDoesNotMatch”**

> 2012-04-20T21:24:37+00:00 app[web.1]: 参数：{"utf8"=>"Γ£ô", "authenticit y_token"=>"MHt20N64y9L24Ga2y6gGj8hX06U+td17XIRdqMadcCQ=", "post" =>{"title"=>"test t", "organisation_id"=>"1", "content"=>"weeqw", "attachments_attributes"=>{"0"=> {"pic"=>#> }}}，“提交”=>“创建帖子”} 2012-04-20T21:24:41+00:00 app[web.1]：在 344 6 毫秒内完成 500 内部服务器错误 2012-04-20T21:24： 41+00:00 app[web.1]: 2012-04-20T21:24:41+00:00 app[web.1]: **AWS::S3::Errors::SignatureDoesNotMatch**（我们计算的请求签名确实与您提供的签名不匹配。请检查您的密钥和签名方法。）：

这是我的 attachment.rb 模型：

```
 has_attached_file :pic, :styles => { :medium => "500x280>",:slide => "180x260>", :thumb => "150x100#" },     
:storage => :s3,
             :bucket => 'sample_bucket',
             :s3_credentials => {
               :access_key_id => 'ASDDSAMPLEKEYDFSDF',
               :secret_access_key => 'Dfsdf887-sample-secret-key-dfdsasd',
             } 
```

这个错误的原因可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T16:05:30.887

我在 Heroku 遇到了一些类似的问题，发现了这个[https://rubygems.org/gems/paperclip-aws](https://rubygems.org/gems/paperclip-aws)。

这解决了我的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T00:44:50.693

我有回形针 2.4.5，这是模型内部的定义：

```
has_attached_file :logo,
                :path => "assets/:class/:attachment/:id/:style.:extension",
                :storage => :s3,
                :bucket => ENV['S3_BUCKET'],
                :s3_permissions => 'authenticated-read',
                :s3_protocol => "http",
                :s3_credentials => { :access_key_id => ENV['S3_KEY'],
                                     :secret_access_key => ENV['S3_SECRET'] },
                :styles => { :index => "72x72>",
                             :billboard => "120x120>" } 
```

# c# - 通过 VBA 宏与 COM 加载项交互

> ID：10253892
> 
> 赞同：1
> 
> 时间：2012-04-20T21:36:57.893
> 
> 标签：c#, vba, project-management, add-in, ms-project

我目前正在使用带有[Project 2010 Scrum Solution Starter](http://archive.msdn.microsoft.com/P2010Scrum)加载项的 Microsoft Project 2010。该插件非常好，因为它添加了许多自定义视图/任务类型/等。用于规划和管理 Scrum 项目。但是，它也有一些问题（比如必须手动编辑自定义字段以将任务移动到产品或冲刺积压，删除冲刺的问题，以及偶尔创建具有相同冲刺编号的重复冲刺），所以我一直在尝试使用VBA来解决这些缺点。

但是，我无法从加载项获取活动冲刺编号。查看加载项的 C# 源代码，它存储在名为的类变量中`sprintNumber`：

```
namespace Scrum
{
    public delegate void SprintAdded(object sender, EventArgs e);

    public partial class AddNewSprint : Form
    {
        public event SprintAdded onSprintAdded;

        private Microsoft.Office.Interop.MSProject.Application _application
            = null;
        private int sprintNumber = -1; 
```

功能区菜单中还有一个下拉列表显示此数字。但我不知道如何访问类变量或加载项创建的下拉列表。

这甚至可能吗，或者我将不得不购买 Visual Studio 并学习 C#，或者有没有更简单的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T12:31:10.777

宏无法访问插件中声明的私有变量。如果您有相应的 Visual Studio 版本，您将能够修改加载项，以便它提供一个返回该变量的公共属性/成员。但由于您拥有加载项的源代码，因此您知道显示该数字的 Ribbon 控件的类型和 ID。我想您可以使用 Accessibility 从该控件中检索该值，请参阅[http://www.wordarticles.com/Shorts/RibbonVBA/RibbonVBADemo.php](http://www.wordarticles.com/Shorts/RibbonVBA/RibbonVBADemo.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T09:57:38.767

AFAIK，您将无法使用 Express Editions 创建 COM 插件。您将必须购买完整版（最少 - 标准版）

如果您对加载项开发很认真，那么您可能希望使用 Visual Studio参加[Add-In Express 。](http://siddharthrout.wordpress.com/2012/04/18/add-in-express/)我强烈推荐它，因为我已经广泛使用它。它使您的生活更加轻松。如果您有任何问题，可以联系支持部门的[Andrei Smolin](http://www.add-in-express.com/creating-addins-blog/author/andrei-smolin/)。

# c# - C# 使用 Mono 获取 MAC 地址（适用于 Mac 平台）

> ID：10253893
> 
> 赞同：1
> 
> 时间：2012-04-20T21:37:03.890
> 
> 标签：c#, mono, monodevelop

我有这个 C# 函数可以正常工作，但不幸的是 mono 不支持`System.Net.NetworkInformation.NetworkInterface`Mac 平台的 Type。

```
System.Net.NetworkInformation.NetworkInterfaceType Type = 0;

string MacAddress = ModSupBase.EMPTY_STRING;

try
{
    System.Net.NetworkInformation.NetworkInterface[] theNetworkInterfaces = 
        System.Net.NetworkInformation.NetworkInterface.GetAllNetworkInterfaces();

    foreach (System.Net.NetworkInformation.NetworkInterface currentInterface in theNetworkInterfaces)
    {
        Type = currentInterface.NetworkInterfaceType;

        if (Type == System.Net.NetworkInformation.NetworkInterfaceType.Ethernet 
            || Type == System.Net.NetworkInformation.NetworkInterfaceType.GigabitEthernet 
            || Type == System.Net.NetworkInformation.NetworkInterfaceType.FastEthernetFx)
        {
            MacAddress = currentInterface.GetPhysicalAddress().ToString();

            break;
        }
    }

    return MacAddress;

}
catch (System.Exception ex)
{
    ModErrorHandle.Error_Handler(ex);

    return ModSupBase.EMPTY_STRING;
} 
```

我已使用 mono 迁移实用程序阅读了此信息（我认为这是真的）

还有另一种方法可以在 MAC 平台上获取带有单声道的 MAC 地址吗？

谢谢 ！

* * *

我不知道是否工作。我只下载了 mono 迁移实用程序的最新版本，在报告中我看到：

> NetworkInterface[] NetworkInterface.GetAllNetworkInterfaces() 仅适用于 Linux 和 Windows

我不知道这是否属实。你认为是误报吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T12:26:44.170

您指的是哪个版本的 Mono？查看 Mono 的主干[源代码](https://github.com/mono/mono/blob/master/mcs/class/System/System.Net.NetworkInformation/NetworkInterface.cs)，我很确定它现在已经实现。

# php - 如何在 PHP 中访问更深层次的 JSON 对象

> ID：10253896
> 
> 赞同：2
> 
> 时间：2012-04-20T21:37:30.750
> 
> 标签：php, json

使用下面这个作为 JSON 响应的示例，我将从使用 PHP 的 API 获得

```
[
   {
    "profile_background_tile": true,
    "listed_count": 82,
    "status":  {
      "created_at": "Fri Apr 20 20:06:12 +0000 2012",
      "place": null,
    },
    "default_profile": false,
    "created_at": "Tue Oct 25 00:03:17 +0000 2011"
  }
] 
```

我会用这样的东西......

```
$obj = json_decode($json);

foreach($obj as $index => $user) {
    echo $user->profile_background_tile;
    echo $user->listed_count;
    echo $user->status;    
    echo $user->default_profile;
    echo $user->created_at;
} 
```

现在我需要一些帮助的地方是在下面的 JSON 响应`status`中，`created_at`并且`place`

我不知道如何访问那些项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:39:06.520

您使用完全相同的逻辑，但更深一层：

```
echo $user->status->created_at;
echo $user->status->place; 
```

这就是为什么有效：您解码的 JSON 是对象数组。每个对象都有类似的属性 `profile_background_tile`。它们还有一个`status`属性，恰好是另一个对象，具有属性`created_at`和`place`. `$obj->prop`您可以使用语法访问对象属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:50:02.970

## 错误

你`JSON`的无效...

看着

```
"status":  {
  "created_at": "Fri Apr 20 20:06:12 0000 2012",
  "place": null,
}, 
```

有`,`之后`"place": null` 不应该有

尝试

```
$json = '[{"profile_background_tile": "true",
    "listed_count": 82,
    "status":  {
      "created_at": "Fri Apr 20 20:06:12 0000 2012",
      "place": null
    },
    "default_profile": false,
    "created_at": "Tue Oct 25 00:03:17 +0000 2011"
  }]';

echo "<pre>";
$obj = json_decode ( $json );
foreach ( $obj as $index => $user ) {
    echo $user->status->created_at , PHP_EOL;
    echo $user->status->place , PHP_EOL;

} 
```

输出

```
 Fri Apr 20 20:06:12 0000 2012 
```

# python - 在网站上记录 python 错误？

> ID：10253898
> 
> 赞同：0
> 
> 时间：2012-04-20T21:37:43.107
> 
> 标签：python, cgi

我是 cgi 和 python 的新手，所以我犯了很多错误。问题是，如果脚本出现问题，我只会在网页上收到 500 错误。我可以看到导致错误的唯一方法是通过 ssh 执行页面，但该页面涉及文件上传，所以我无法测试该部分。

有没有办法可以将 Python 错误输出到文件中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:48:31.507

有几个选项，按照指示使用日志模块，你可以跟踪服务器的错误日志，你可以启用 cgitb`import cgitb; cgitb.enable()`

根据错误发生的确切位置，错误将出现在不同的位置，因此检查所有三个，并使用打印语句和异常块有助于调试代码。

通过文件上传，我发现我必须`enctype="multipart/form-data"`在表单标签中明确声明，否则它会中断，通常是悄悄地。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:40:40.650

就在这里。Python 有一个日志模块，它允许你做你想做的事。[在这里](http://docs.python.org/library/logging.html)你可以阅读文档，它很容易理解。

# php - 将列表从 php 或 xmlhttp.responseText 传递到 javascript

> ID：10253900
> 
> 赞同：1
> 
> 时间：2012-04-20T21:37:55.027
> 
> 标签：php, javascript, arrays, list, xmlhttprequest

我在 javascript 中有一个列表，当用户单击链接或滑动条时，该列表将由数据库的内容进行更改。我目前使用 xmlhttp 请求来获取生成列表的 php 页面。我有一个以这种形式工作的静态列表：

```
var mark_list = [
{ "EntID" : 3, "x" : 100, "y" : 400},
]; 
```

我试图让 php 页面生成 { "EntID" : 3, "x" : 100, "y" : 400} 并将 mark_list 设置为 responseText 但我相信这只是一个字符串。我正在努力寻找一种方法将这个新列表放入变量中。

有没有人有任何建议或解决方案？您的帮助将不胜感激。

卡勒姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:43:02.380

通过包含此处的 json 脚本，确保浏览器具有 JSON 对象：[https ://github.com/douglascrockford/JSON-js/blob/master/json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)

如果可用，它将遵循本机浏览器 JSON 对象，如果不可用，将添加它，以便此功能在当前不支持它的浏览器中可用。

然后在您的代码中，在您收到 PHP 脚本的输出后，运行以下命令：

```
var mark_list = JSON.parse(responseText); 
```

根据 PHP 脚本的输出，您可能需要执行以下操作：

```
var stuff = JSON.parse(responseText);
var mark_list = [stuff]; 
```

这会将 PHP 返回的 JSON 字符串转换为实际的 javascript 对象。

在您的 PHP 代码中，您可以执行以下操作：

```
$output = array(
    array(
        'EntId' => 3,
        'x' => 100,
        'y' => 400,
    ),
);

echo json_encode($output); 
```

然后，您可以`var mark_list = JSON.parse(responseText);`在 JavaScript 中使用该选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:50:56.620

`responseText`确实只是一个由字符串表示的文本，所以你现在输出它的方式不会仅仅靠它自己来完成。基本上有两种方法可以做到这一点：

*   在您的 javascript 中，您解析服务器提供给您的输出。这可以在纯字符串上以您喜欢的任何方式完成。例如，您可以编写 javascript 来解析您使用花括号和基于冒号的语法给出的格式。或者，您可以使用另一种格式（如 XML），这会稍微减少工作量，但仍会将输出的解释留给您在 javascript 中完成。

*   您可以输出为用于描述对象和列表的格式。JSON 将是这种格式的一个很好的例子。如果您以 JSON 格式输出，您将得到类似于您在上面使用的格式（JSON 代表 Javascript Object Notation，它基于 javascript 的部分语法），您需要做的就是能够使用它获取您想要获取的数据。您可以`JSON.parse()`在大多数浏览器上使用它，但更广泛支持的替代方案是 jQuery `jQuery.parseJSON()`（您将使用 jQuery，在这种情况下您也应该提供）

# android - 使用公共/私有令牌的 REST API 安全性

> ID：10253906
> 
> 赞同：0
> 
> 时间：2012-04-20T21:38:36.220
> 
> 标签：android, .net, rest, authentication, authorization

我正在[从buzzmedia.com 阅读这篇](http://www.thebuzzmedia.com/designing-a-secure-rest-api-without-oauth-authentication/)关于使用公钥/私钥进行基于令牌的身份验证和授权的文章。我发现它提供了丰富的信息，但无法在我的 scrnario 中看到如何实现它。我有一个 WCF REST 服务，一个 android pp 将连接到该服务。在这种情况下，如何在客户端和服务器之间建立私钥？在这些场景中，是否在应用程序的每次登录或条目上都建立了私钥？这篇文章讨论了身份验证，但我也是从授权的角度询问，并通过令牌授权请求。

谢谢

# c++ - Visual Studio 2010 C++，无法打开包含文件：“afxwin.h”、“TCHAR.H”和“cassert”

> ID：10253908
> 
> 赞同：6
> 
> 时间：2012-04-20T21:38:41.017
> 
> 标签：c++, visual-studio, visual-studio-2010, visual-c++

我是 VS2010 的新手，并试图编译一个曾经在 VS2008 中工作过的项目。错误看起来很简单：

stdafx.h(43)：致命错误 C1083：无法打开包含文件：'afxwin.h'：没有这样的文件或目录 stdstring.h(619)：致命错误 C1083：无法打开包含文件：'TCHAR.H'：否这样的文件或目录threads.h（52）：致命错误C1083：无法打开包含文件：'cassert'：没有这样的文件或目录

我用谷歌搜索，这种类型的错误经常发生在 VS2010 Express 版本中，但我使用的是 VS2010 专业版。我已经检查过了，所有这些丢失的文件都在正确的位置。C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\atlmfc\include 和 C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\include

问题是，stdafx.h 中的其他头文件与 afxwin.h 位于同一目录中，但没有被投诉。

我还检查了属性管理器的 VC++ 目录，“包含目录”是“$(VCInstallDir)include;$(VCInstallDir)atlmfc\include;$(FrameworkSDKDir)\include;$(WindowsSdkDir)include”。

还有什么我忘了检查的吗？非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:23:31.810

属性资源管理器是您想要查看的地方。Afxwin.h 在 ..\atlmfc\include 中，tchar.h 和 cassert 在 ..\include 中，您认为这将是一个全局类型的属性，但事实证明它并不那么简单。这是我从 2008 年升级时遇到的最大问题。这不再是应用程序选项，而是用户属性。

在您开始更改之前，请查看属性资源管理器并阅读 MSBuild 文档，因为虽然新格式更强大、更灵活，但它并没有优雅地从旧格式升级。

# jquery - 防止 JQuery Mobile 可折叠集标头被截断

> ID：10253917
> 
> 赞同：2
> 
> 时间：2012-04-20T21:39:35.117
> 
> 标签：jquery, css, jquery-mobile

我正在使用 JQuery mobile 的可折叠集，当在移动设备上查看时，我的长标题被截断（并且变得不可读）。

例如这里定义的标头：

```
<div data-role="collapsible-set">
  <div data-role="collapsible">
    <h3>My header with lots of text that gets truncated when viewing on mobile device or small screen.</h3>
    <fieldset data-role="controlgroup">
    ... 
```

最终被截断为：我的标题有很多文字......

根据其他帖子的建议，我尝试了：

```
<style type="text/css">
  .ui-header .ui-title .ui-btn-text .ui-collapsible-heading {
    overflow: visible !important;
    white-space: normal !important;
  }
</style> 
```

……无济于事。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T22:05:29.570

这是使可折叠集的标题多行所需的 CSS：

```
.ui-mobile .ui-page .ui-content .ui-collapsible .ui-collapsible-heading .ui-btn-text {
    white-space : normal;
}​ 
```

请注意，我将作为`.ui-btn-text`元素后代的`.ui-collapsible-heading`元素作为目标来获得所需的效果。

这制定了一个非常具体的规则，它将覆盖默认的 jQuery Mobile 样式，而无需使用`!important`.

这是一个演示：http: [//jsfiddle.net/JaPdC/](http://jsfiddle.net/JaPdC/)

# objective-c - 如何在代码中将uiview的自定义子类作为子视图添加到uiview的另一个自定义子类中？

> ID：10253922
> 
> 赞同：0
> 
> 时间：2012-04-20T21:39:54.637
> 
> 标签：objective-c, ios

我是 ios 编程的绝对新手，所以请原谅我：

我有一个名为 PuzzlePiece 的 UIView 子类，我只想代表一个拼图块（显然）。我不想为此使用 nib 文件，而只想能够使用代码绘制一块并显示它。

我有一个视图控制器和相关的 nib 文件来保存整个拼图。nib 中的视图是 PuzzleView 类型，这是我定义为 UIView 的自定义子类的另一个类。我的 PuzzleView 工作正常，我可以在上面画画。我有一个 PuzzlePiece 类型的属性，我认为它可以引用我的拼图。

所以我想弄清楚如何做就是现在初始化我的视图，将其添加为子视图，然后将其绘制在屏幕上。听起来很简单，但我完全不知道如何完成这项工作。我完全相信我什至没有正确解决问题，所以如果是这样，请告诉我！

我以为我应该能够做类似的事情

```
piece = [[puzzlePiece alloc] initWithFrame: ... ];
[self addSubview:piece]; 
```

但是...... init 位不起作用......而且我似乎真的没有可用的 init 方法。

是的。如何在代码中将 uiview 的自定义子类作为子视图添加到 uiview 的另一个自定义子类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:48:44.723

你需要大写puzzlePiece吗？

```
PuzzlePiece *piece = [[PuzzlePiece alloc] initWithFrame:CGRect(0, 0, 100, 100)]; 
```

如果 PuzzlePiece 从 UIView 派生，那么您的代码看起来应该可以工作。

# javascript - 没有输入的jQuery日期选择器

> ID：10253924
> 
> 赞同：19
> 
> 时间：2012-04-20T21:40:01.237
> 
> 标签：javascript, jquery, jquery-ui, datepicker

我有一个相当复杂的网络应用程序，我想添加一些日期选择 UI。

我遇到的问题是我无法从文档中弄清楚如何真正控制日期选择器出现的方式和时间。不涉及任何表单元素（不，我不会添加一个秘密表单字段），所以简单的开箱即用方法根本行不通。

我希望有人可以提供一些关于允许我以编程方式调用日期选择器的模式的指导。我相信我知道如何使用 datepicker 的自定义事件来初始化和定位它，并在用户关闭它时恢复选择的值。我只是很难实例化一个日期选择器，因为我没有将它与一个元素配对。

这*是*不起作用的：

```
function doThing(sCurrent, event) { // sCurrent is the current value; event is an event I'm using for positioning information only
    var bIsDate = !isNaN( (new Date(sCurrent)).getTime() );

    jQuery.datepicker('dialog',
        (bIsDate ? new Date(sOriginal) : new Date()), // date
        function() { console.log('user picked a date'); }, // onSelect
        null, // settings (i haz none)
        event // position
    );

} 
```

原因是“jQuery.datepicker”不是一个函数。（我做错了。）

我并没有与“对话”方法结婚——这只是我在不参考表单元素的情况下调用一种方法的最佳猜测。

我正在使用 jQuery 1.4.3 和 jQueryUI 1.8.6

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-21T02:10:42.157

从插件页面：http: [//jqueryui.com/demos/datepicker/#inline](http://jqueryui.com/demos/datepicker/#inline)

```
<script>
    $(function() {
        $( "#datepicker" ).datepicker();
    });
</script>

<div class="demo">
    Date: <div id="datepicker"></div>
</div><!-- End demo --> 
```

> **显示嵌入页面而不是覆盖的日期选择器。只需在 div 上调用 .datepicker() 而不是输入。**

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-21T01:43:19.400

我通读了 datepicker 代码，看起来，正如所写，datepicker*必须*附加到 input、div 或 span 标签。

因此，如果您唯一的反对意见是使用表单元素，那么附加到 div 或 span 可能是您最好的选择，这里有一个如何做到这一点的示例：[https ://stackoverflow.com/a/1112135](https://stackoverflow.com/a/1112135)

如果您正在寻找其他方式来控制 datepicker，那么您可能必须扩展 datepicker 代码来做您想做的事情，如果您走这条路，那么我建议您先看看 _inlineDatepicker private datepicker 代码中的方法，它是将 datepicker 附加到 div 或 span 标签的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:42:57.940

您必须动态定义输入字段，然后将日期选择器附加到您新创建的类没有字段我不这么认为它会起作用。

```
<input type="hidden" id="yourField" /> 
```

并使用

```
$("#yourField").datepicker({
        buttonImage: '../yourImage.png',
        buttonImageOnly: true,
        changeMonth: true,
        changeYear: true,
        showOn: 'both',
     }); 
```

# java - 消息控制台 Java

> ID：10253933
> 
> 赞同：2
> 
> 时间：2012-04-20T21:40:40.997
> 
> 标签：java, swing, jtextcomponent, documentlistener

我在 java 中有这个开源消息控制台的代码，但它根本无法编译。任何人都可以使用他们的 IDE 查看它是否可以运行？

```
 import java.io.*;
  import java.awt.*;
  import javax.swing.*;
  import javax.swing.event.*;
  import javax.swing.text.*;

  /*
   *  Create a simple console to display text messages.
   *
   *  Messages can be directed here from different sources. Each source can
   *  have its messages displayed in a different color.
   *
   *  Messages can either be appended to the console or inserted as the first
   *  line of the console
   *
   *  You can limit the number of lines to hold in the Document.
   */
  public class MessageConsole
  {
   private JTextComponent textComponent;
   private Document document;
   private boolean isAppend;
   private DocumentListener limitLinesListener;

   public MessageConsole(JTextComponent textComponent)
   {
    this(textComponent, true);
   }

   /*
    * Use the text component specified as a simply console to display
          *  text messages.
    *
    *  The messages can either be appended to the end of the console or
    *  inserted as the first line of the console.
    */
   public MessageConsole(JTextComponent textComponent, boolean isAppend)
   {
    this.textComponent = textComponent;
    this.document = textComponent.getDocument();
    this.isAppend = isAppend;
    textComponent.setEditable( false );
   }

   /*
    *  Redirect the output from the standard output to the console
    *  using the default text color and null PrintStream
          */
   public void redirectOut()
   {
    redirectOut(null, null);
   }

   /*
    *  Redirect the output from the standard output to the console
    *  using the specified color and PrintStream. When a PrintStream
    *  is specified the message will be added to the Document before
    *  it is also written to the PrintStream.
          */
   public void redirectOut(Color textColor, PrintStream printStream)
   {
    ConsoleOutputStream cos = new ConsoleOutputStream(textColor, printStream);
    System.setOut( new PrintStream(cos, true) );
   }

   /*
    *  Redirect the output from the standard error to the console
    *  using the default text color and null PrintStream
    */
   public void redirectErr()
   {
    redirectErr(null, null);
   }

   /*
    *  Redirect the output from the standard error to the console
        *  using the specified color and PrintStream. When a PrintStream
    *  is specified the message will be added to the Document before
    *  it is also written to the PrintStream.
    */
   public void redirectErr(Color textColor, PrintStream printStream)
   {
          ConsoleOutputStream cos = new ConsoleOutputStream(textColor, printStream);
    System.setErr( new PrintStream(cos, true) );
   }

   /*
    *  To prevent memory from being used up you can control the number of
    *  lines to display in the console
          *
    *  This number can be dynamically changed, but the console will only
    *  be updated the next time the Document is updated.
    */
   public void setMessageLines(int lines)
   {
    if (limitLinesListener != null)
     document.removeDocumentListener( limitLinesListener );

    limitLinesListener = new LimitLinesDocumentListener(lines, isAppend);
    document.addDocumentListener( limitLinesListener );
   }

   /*
    * Class to intercept output from a PrintStream and add it to a Document.
    *  The output can optionally be redirected to a different PrintStream.
    *  The text displayed in the Document can be color coded to indicate
    *  the output source.
    */
   class ConsoleOutputStream extends ByteArrayOutputStream
   {
    private SimpleAttributeSet attributes;
    private PrintStream printStream;
    private StringBuffer buffer = new StringBuffer(80);
    private boolean isFirstLine;

    /*
     *  Specify the option text color and PrintStream
     */
    public ConsoleOutputStream(Color textColor, PrintStream printStream)
    {
     if (textColor != null)
     {
      attributes = new SimpleAttributeSet();
      StyleConstants.setForeground(attributes, textColor);
     }

     this.printStream = printStream;

     if (isAppend)
      isFirstLine = true;
    }

    /*
     *  Override this method to intercept the output text. Each line of text
     *  output will actually involve invoking this method twice:
     *
     *  a) for the actual text message
     *  b) for the newLine string
     *
     *  The message will be treated differently depending on whether the line
     *  will be appended or inserted into the Document
     */
    public void flush()
    {
     String message = toString();

     if (message.length() == 0) return;

     if (isAppend)
         handleAppend(message);
     else
         handleInsert(message);

     reset();
    }

    /*
     * We don't want to have blank lines in the Document. The first line
           *  added will simply be the message. For additional lines it will be:
     *
     *  newLine + message
     */
    private void handleAppend(String message)
    {
     if (message.endsWith("\r")
     ||  message.endsWith("\n"))
     {
      buffer.append(message);
           }
        else
       {
           buffer.append(message);
         clearBuffer();
        }
             }
       /*
        *  We don't want to merge the new message with the existing message
        *  so the line will be inserted as:
  *
  *  message + newLine
   */
 private void handleInsert(String message)
 {
  buffer.append(message);

  if (message.endsWith("\r")
  ||  message.endsWith("\n"))
  {
    clearBuffer();
     }
    }

/*
 *  The message and the newLine have been added to the buffer in the
  *  appropriate order so we can now update the Document and send the
  *  text to the optional PrintStream.
   */
  private void clearBuffer()
 {
  //  In case both the standard out and standard err are being redirected
  //  we need to insert a newline character for the first line only

   if (isFirstLine && document.getLength() != 0)
     {
      buffer.insert(0, "\n");
  }

  isFirstLine = false;
  String line = buffer.toString();

  try
  {
    if (isAppend)
    {
   int offset = document.getLength();
   document.insertString(offset, line, attributes);
   textComponent.setCaretPosition( document.getLength() );
  }
   else
  {
    document.insertString(0, line, attributes);
   textComponent.setCaretPosition( 0 );
  }
  }
 catch (BadLocationException ble) {}

 if (printStream != null)
  {
 printStream.print(line);
 }

 buffer.setLength(0);
 }
}
} 
```

编译后，我收到此错误：

错误：limitLinesDocumentListener 无法解析为类型

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T21:45:24.763

描述它的[博客文章说得很清楚，IMO：](http://tips4java.wordpress.com/2008/11/08/message-console/)

> 最后，您需要决定是否需要限制控制台中包含的行数。MessageConsole 将使用我在之前的博客条目中描述的 LimitLinesDocumentListener。

您可以`LimitLinesDocumentListener` [从较早的博客文章](http://tips4java.wordpress.com/2008/10/15/limit-lines-in-document/)中获得。

当您拥有这两个文件时，它们可以毫无问题地一起编译。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:46:47.090

导入问题。您必须具有可访问的类或接口（我想是类，因为您在分配上有一个简单的构造函数`limitLinesListener = new LimitLinesDocumentListener(lines, isAppend);`：） LimitLinesDocumentListener。只是程序找不到该类。你需要在这个文件的同一个包中，或者你需要导入那个类。

# javascript - jqGrid 没有 addJSONData 方法

> ID：10253938
> 
> 赞同：2
> 
> 时间：2012-04-20T21:41:00.080
> 
> 标签：javascript, jquery, json, jqgrid

我今天下午只是在玩 jqGrid，让它在本地数组数据源上运行得相当好。但是，现在我正试图让它加载本地 JSON 数据。

我的代码如下：

```
jQuery("#list4").jqGrid({
   datatype: "json", //<-- Also tried "local" here
   height: 'auto',
   autowidth: true,
   forceFit: true,
   colNames:['ID','Name'],
   colModel:[
      {name:'id',index:'id', width:60, sorttype:"int", jsonmap:"id"},
      {name:'name',index:'name', width:90, jsonmap: "name"}
   ],
   multiselect: false,
   caption: "Test"
}); 
```

然后我尝试使用以下内容加载 JSON 数据：

```
jQuery("#list4").jqGrid.addJSONData(json); 
```

问题是`jQuery("#list4").jqGrid.addJSONData`未定义。我也试过：

```
jQuery("#list4").jqGrid('addJSONData', json); 
```

这会引发一个异常，说明该方法`addJSONData`未定义。我可以在 上看到其他记录在案的方法`jQuery("#list4").jqGrid`，但不是这个。 `addXMLData`也不见了。但是，我可以验证这些方法是否在`jquery.jqGrid.min.js`源代码中。

我今天刚刚下载了 jqGrid，所以我知道我拥有所有东西的最新版本。

我一定是做错了什么，但我不确定它可能是什么。我把*整个*页面放在这里：

[http://pastie.org/3825067](http://pastie.org/3825067)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-21T12:06:38.767

这`addJSONData`是一种非常古老的方法，它仍然使用对网格（`<table>`元素）的 DOM 元素进行扩展。所以要`addJSONData`正确使用应该使用

```
jQuery("#list4")[0].addJSONData(json); 
```

请参阅[文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:methods)。更好的方法是**创建 jqGrid 并直接填充数据**。您可以使用

```
jQuery("#list4").jqGrid({
    datatype: "local",
    data: mydata,
    height: 'auto',
    autowidth: true,
    colNames: ['ID', 'Name'],
    colModel: [
        {name: 'id', index: 'id', width: 60, sorttype: "int", key: true},
        {name: 'name', index:'name', width: 90}
    ],
    caption: "Test",
    gridview: true // !!! improve the performance
}); 
```

的格式`mydata`可以是

```
var mydata = [
        {id: 10, name: "Oleg"},
        {id: 20, name: "Mike"}
    ]; 
```

它允许使用本地分页、过滤和数据排序。输入数据不需要*排序*。

或者，您可以使用`datatype: 'jsonstring'`和`datastr`。的值`datastr`可以是 JSON 字符串或已解析的对象。来自的数据`datastr` *必须正确排序*（如果您使用一些`sortname`和`sortorder`参数）并且具有与 for 相同的格式`datatype: 'json'`（请参阅[文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:retrieving_data#json_data)）。可以使用`jsonReader`and`jsonmap`来指定数据格式：

```
var mydata = {
        //total: 1,  // will be ignored
        //page: 1,   // will be ignored
        //records: 2 // will be ignored
        rows: [
            {id: 10, name: "Oleg"},
            {id: 20, name: "Mike"}
        ]
    ]; 
```

对我来说最奇怪的是*为什么*需要加载“本地 JSON 数据”？与“本地数组数据源”的区别在哪里？您可以使用[$.parseJSON](http://api.jquery.com/jQuery.parseJSON/)将输入数据转换为对象或`datatype: 'jsonstring'`直接使用。在大多数情况下，使用`addJSONData`是因为**每个 jQuery.ajax 手动从服务器加载数据，**这确实是一个很好的想法（请参阅我在 stackoverflow 上的第一篇文章中的一个[）](https://stackoverflow.com/q/2660226/315935)。jqGrid 有很多自定义选项和回调，例如`ajaxGridOptions`，`serializeGridData`和`beforeProcessing`，您可以使用`jsonReader`（参见[此处](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:retrieving_data#jsonreader_as_function)）和中的函数`jsonmap`，它允许您加载几乎*任何*格式的输入数据。使用[prmNames](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:options)和`serializeGridData`（`postData`参见[此处](https://stackoverflow.com/a/2928819/315935)）您几乎可以对发送到服务器的参数进行任何自定义。`addJSONData`因此，在极少数情况下确实需要使用低级。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-21T00:56:12.507

在大多数情况下，你很接近。我不认为 addJSONData 方法是要走的路。以下是我们处理本地 JSON 数据的方式：

网格：

```
$("#list4").jqGrid({
   datatype: "local", //<-- "local" tells jqGrid not to try and get the data itself
   height: 'auto',
   autowidth: true,
   forceFit: true,
   colNames:['ID','Name'],
   colModel:[
      {name:'id',index:'id', width:60, sorttype:"int", jsonmap:"id"},
      {name:'name',index:'name', width:90, jsonmap: "name"}
   ],
   multiselect: false,
   caption: "Test"
}); 
```

将数据提供给网格：

```
// Clear the grid if you only want the new data
$('#list4').clearGridData(true); 
// Set the data the tell the grid to refresh
$('#list4').setGridParam({ data: jsonData, rowNum: jsonData.length }).trigger('reloadGrid'); 
```

您还应该将 jsonData 更改为：

```
var jsonData = [
  {id: 1, name: 'Apple'},
  {id: 2, name: 'Banana'},
  {id: 3, name: 'Pear'},
  {id: 4, name: 'Orange'}
]; 
```

jqGrid 将寻找将指定的列与传递到数组中的对象匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:52:41.877

我正在使用版本 jqGrid 4.1.2 使用 JSONReader 初始化网格后`datatype:'jsonstring'`，添加 jsonstring 数据时，我必须包含`datatype:'jsonstring'`参数。

```
$('#list4').setGridParam({ datastr: jsonData, datatype:'jsonstring', rowNum: jsonData.length }).trigger('reloadGrid'); 
```

据我所知，这是因为初始化后数据类型：'jsonstring' 变成了数据类型：'local'，所以当添加 jsonstring 时，它会尝试从“data”参数而不是“datastr”加载数据，但因为是空的，没有数据已加载。

我希望为此做出贡献...

# javascript - 没有答案的 Javascript 表单计算器

> ID：10253945
> 
> 赞同：0
> 
> 时间：2012-04-20T21:41:30.263
> 
> 标签：javascript, forms, calculator

我对真正编写 javascript 非常陌生（借用和编辑，不是那么新）。因此，在 google 和 code guru 和 adobe cookbook 的帮助下，我想出了这个简单的表格，可以嵌入到 iPad 出版物中（这只是我的测试，不是最终产品）。如果调试控制台并且它似乎通过了 W3C 合规性，我已经做到了这一点，没有任何错误，但它也没有做任何事情！它不会生成答案？？？我希望有人可以帮助我或引导我朝着正确的方向前进。该页面的代码如下：在此先感谢...

```
 <body>
    <form id="form1" name="form1" method="post" action="">
      <table width="500" border="1">
        <tr>
          <th scope="col">Item</th>
  <th scope="col">Cost 1</th>
  <th scope="col">Cost 2</th>
</tr>
<tr>
  <th scope="row">Manikin</th>
  <td><input type="text" name="ManikinCost1" id="ManikinCost1" tabindex="1" /></td>
  <td><input type="text" name="ManikinCost2" id="ManikinCost2" tabindex="2" /></td>
</tr>
<tr>
  <th scope="row">Instructor</th>
  <td><input type="text" name="InstructorCost1" id="InstructorCost1" tabindex="3" /></td>
  <td><input type="text" name="InstructorCost2" id="InstructorCost2" tabindex="4" /></td>
</tr>
<tr>
  <th scope="row">Books</th>
  <td><input type="text" name="BooksCost1" id="BooksCost1" tabindex="5" /></td>
  <td><input type="text" name="BooksCost2" id="BooksCost2" tabindex="6" /></td>
</tr>
<tr>
  <th scope="row">Totals</th>
  <td><input type="text" name="TotalsCost1" id="TotalsCost1" tabindex="7" /><span id="TotalsCost1"></span></td>
  <td><input type="text" name="TotalsCost2" id="TotalsCost2" tabindex="8" /><span id="TotalsCost2"></span></td>
</tr>
<tr>
  <th scope="row">Savings</th>
  <td colspan="2"><input type="text" name="Savings" id="Savings" /><span id="Savings"></span></td>
</tr>
      </table>
      <p>
        <input type="button" name="calculate" id="calculate" value="Calculate" />
      </p>
      <p>&nbsp;</p>
      <p>&nbsp;</p>
    </form>

    <script type="text/javascript">
    var btn = document.getElementById('calculate');
    btn.onclick = function() {
//get the input values
var ManikinCost1 = parseInt(document.getElementById('ManikinCost1').value);
var ManikinCost2 = parseInt(document.getElementById('ManikinCost2').value);
var InstructorCost1 = parseInt(document.getElementById('InstructorCost1').value);
var InstructorCost2 = parseInt(document.getElementById('InstructorCost2').value);
var BooksCost1 = parseInt(document.getElementById('BooksCost1').value);
var BooksCost2 = parseInt(document.getElementById('BooksCost2').value);
// get the elements to hold the results
var TotalsCost1 = document.getElementById('TotalsCost1');
var TotalsCost2 = document.getElementById('TotalsCost2');
var Savings = document.getElementById('Savings');
// create an empty array to hold error messages
var msg = [];
// check each input value, and add an error message to the array if it's not a number
if (isNaN(ManikinCost2)) {
    msg.push('Manikin Cost 2 is not a number');
    // the value isn't a number
    }
if (isNaN(InstructorCost1)) {
    msg.push('Instructor Cost 1 is not a number');
    // the value isn't a number
        }
if (isNaN(InstructorCost2)) {
    msg.push('Instructor Cost 2 is not a number');
    // the value isn't a number
    }
if (isNaN(BooksCost1)) {
    msg.push('Book Cost 1 is not a number');
    // the value isn't a number
    }
if (isNaN(ManikinCost1)) {
    msg.push('Manikin Cost 1 is not a number');
    // the value isn't a number
    }
if (isNaN(BooksCost2)) {
    msg.push('Book Cost 2 is not a number');
    // the value isn't a number
    }
    // if the array contains any values, display an error message
    if (msg.length > 0)   {
        TotalsCost1.innerHTML = msg.join(', ');
    } else {
        TotalsCost1.innerHTML = + (ManikinCost1 + InstructorCost1 + BooksCost1);
        TotalsCost2.innerHTML = + (ManikinCost2 + InstructorCost2 + BooksCost2);
        Savings.innerHTML = + (TotalsCost1 - TotalsCost2);
    }
    };
    </script>
    </body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:43:56.633

```
btn.onclick = (function(){...})(); 
```

您需要将`onclick`事件放入自调用代码或所谓的闭包中。将你的整个`btn.onclick`函数移动到这段代码中：`(...)()`为了让它工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-24T01:33:45.023

很好的尝试，有一些小错误，但非常接近！

我在[这里](http://jsfiddle.net/GaryHarrower/8HgA6/3/)做了一些改变。

正如评论中提到的，我用括号 (function() {...}); 包裹了函数。

当我们更新文本输入时，我还将 innerHTML 更改为 value，您的储蓄计算应该是 input.value，我已经为您更新了。

让我知道你是怎么办的！

```
 <body>
<form id="form1" name="form1" method="post" action="">
      <table width="500" border="1">
        <tr>
          <th scope="col">Item</th>
  <th scope="col">Cost 1</th>
  <th scope="col">Cost 2</th>
</tr>
<tr>
  <th scope="row">Manikin</th>
  <td><input type="text" name="ManikinCost1" id="ManikinCost1" tabindex="1" /></td>
  <td><input type="text" name="ManikinCost2" id="ManikinCost2" tabindex="2" /></td>
</tr>
<tr>
  <th scope="row">Instructor</th>
  <td><input type="text" name="InstructorCost1" id="InstructorCost1" tabindex="3" /></td>
  <td><input type="text" name="InstructorCost2" id="InstructorCost2" tabindex="4" /></td>
</tr>
<tr>
  <th scope="row">Books</th>
  <td><input type="text" name="BooksCost1" id="BooksCost1" tabindex="5" /></td>
  <td><input type="text" name="BooksCost2" id="BooksCost2" tabindex="6" /></td>
</tr>
<tr>
  <th scope="row">Totals</th>
  <td><input type="text" name="TotalsCost1" id="TotalsCost1" tabindex="7" /><span id="TotalsCost1"></span></td>
  <td><input type="text" name="TotalsCost2" id="TotalsCost2" tabindex="8" /><span id="TotalsCost2"></span></td>
</tr>
<tr>
  <th scope="row">Savings</th>
  <td colspan="2"><input type="text" name="Savings" id="Savings" /><span id="Savings"></span></td>
</tr>
      </table>
      <p>
        <input type="button" name="calculate" id="calculate" value="Calculate" />
      </p>
      <p>&nbsp;</p>
      <p>&nbsp;</p>
    </form>

    <script type="text/javascript">
var btn = document.getElementById('calculate');
    btn.onclick = (function() {
//get the input values
var ManikinCost1 = parseInt(document.getElementById('ManikinCost1').value);
var ManikinCost2 = parseInt(document.getElementById('ManikinCost2').value);
var InstructorCost1 = parseInt(document.getElementById('InstructorCost1').value);
var InstructorCost2 = parseInt(document.getElementById('InstructorCost2').value);
var BooksCost1 = parseInt(document.getElementById('BooksCost1').value);
var BooksCost2 = parseInt(document.getElementById('BooksCost2').value);
// get the elements to hold the results
var TotalsCost1 = document.getElementById('TotalsCost1');
var TotalsCost2 = document.getElementById('TotalsCost2');
var Savings = document.getElementById('Savings');
// create an empty array to hold error messages
var msg = [];
// check each input value, and add an error message to the array if it's not a number
if (isNaN(ManikinCost2)) {
    msg.push('Manikin Cost 2 is not a number');
    // the value isn't a number
    }
if (isNaN(InstructorCost1)) {
    msg.push('Instructor Cost 1 is not a number');
    // the value isn't a number
        }
if (isNaN(InstructorCost2)) {
    msg.push('Instructor Cost 2 is not a number');
    // the value isn't a number
    }
if (isNaN(BooksCost1)) {
    msg.push('Book Cost 1 is not a number');
    // the value isn't a number
    }
if (isNaN(ManikinCost1)) {
    msg.push('Manikin Cost 1 is not a number');
    // the value isn't a number
    }
if (isNaN(BooksCost2)) {
    msg.push('Book Cost 2 is not a number');
    // the value isn't a number
    }
    // if the array contains any values, display an error message
    if (msg.length > 0)   {
        TotalsCost1.innerHTML = msg.join(', ');
    } else {

        TotalsCost1.value = + (ManikinCost1 + InstructorCost1 + BooksCost1);
        TotalsCost2.value = + (ManikinCost2 + InstructorCost2 + BooksCost2);
        Savings.value = + (TotalsCost1.value - TotalsCost2.value);
    }
    });

    </script>
    </body> 
```

# php - 如何从 php 数组创建 jQuery if 语句？

> ID：10253948
> 
> 赞同：1
> 
> 时间：2012-04-20T21:42:00.233
> 
> 标签：php, jquery

我有图像颜色和图像 id 值的数组。

我可以回显此信息，但我不知道如何将其放入 js 文件中。

我的js文件是这样的：

```
$(document).ready(function(){

    var colour = false;
    $('.options').click(function(){
        colour = $(this).val();
        console.log(colour);
        if(colour == 'White'){
            var imageid = 758;
        }
        else if(colour == 'Black') {
            var imageid = 752;
        }
        else if(colour == 'Light Oak') {
            var imageid = 755;
        }
        else if(colour == 'Rosewood') {
            var imageid = 757;
        }
        else if(colour == 'Green') {
            var imageid = 754;
        }
        else if(colour == 'Red') {
            var imageid = 756;
        }
        else if(colour == 'Blue') {
            var imageid = 753;
        }
        else {
            var imageid = colour;
        }

        $('.options-input').val(imageid);

        console.log(this);

        $.post("index.php", { image_id: imageid }, function(results) {
            $('body').html(results);
            console.log(results);

         });    
        console.log(url);
    }); 
}); 
```

我目前正在手动执行此操作，单击时我可以将图像发布到我的 index.php

```
$_POST['image_id']; 
```

从那里开始工作。

问题是我想根据新数组的值动态创建 js 语句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:47:41.603

您可以按照建议混合使用 jQuery 和 php，但我更愿意避免这样做。相反，您可以将一些元素添加到具有此数据的 DOM（甚至是其他元素的属性）并稍后获取它：

```
<?php echo '<span id="colour" hidden="hidden">Light Oak</span>'; ?>

if (colour == $("#colour").text()) {
   // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:59:06.047

请不要使用太多的 if 语句！例如，您可以使用以下内容：

```
// JavaScript / jQuery

var imageid,
  colorObj = {
    "White": 758,
    "Black": 752,
    "Light Oak": 755
  };

if (colorObj[colour] !== undefined) {
  imageid = colorObj[colour];
} 
```

就这么简单！使用 PHP，您可以创建您的脚本，例如：

```
<?php

echo '<script type="text/javascript">var imageid,colorObj={';
$count = count($image);
for ($i = 1; $i <= $count; ++$i) {
  echo '"' . $colour . '":' . $image[$i];
  if ($i < $count) {
    echo ',';
  }
}
echo '};if(colorObj[colour]!==undefined){imageid=colorObj[colour]}</script>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:48:14.033

**丑陋的方法**

```
<script>
<?php
    foreach ($images as $index => $imageid) {

        if ($index > 0) echo "else ";
        echo "if (colour == '$colour') {\n";
        echo "    var imageid = $imageid;\n";
        echo "}\n";
    }
?>
</script> 
```

**不那么丑陋的方法**

```
<?php

switch($color) {
    case 'White':
        $imageid = 758;
        break;
    case 'Black':
        $imageid = 752;
        break;
    case 'Light Oak':
        $imageid = 755;
        break;
}

echo "<script>var imageid = $imageid;</script>";
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-21T16:20:02.800

在您更改问题后，我想再次回答。您似乎想根据用户从页面中的元素中选择的颜色来传递图像。您还没有发布您的 PHP 脚本，但是让我告诉您，您现在正在做的事情最好通过 PHP 来完成。

```
$(document).ready(function () {
  $('.options').click(function () {
    var color = $(this).val();
    if (color !== undefined && color !== null && color !== '') {
      $.post('index.php', {color: color}, function (response) {
        $('body').html(response);
      });
    }
  });
}); 
```

在您的 PHP 文件中执行以下操作：

```
<?php

if (isset($_POST['color']) && !empty($_POST['color'])) {
  $colors = array(
    'White' => 1234,
    'Black' => 4321,
  );
  if (array_key_exists($_POST['color'], $colors)) {
    echo $colors[$_POST['color']];
  }
} 
```

# c# - 我应该使用静态类还是结构以外的东西？

> ID：10253950
> 
> 赞同：2
> 
> 时间：2012-04-20T21:42:16.050
> 
> 标签：c#, model-view-controller, static, filter, struct

我需要一种将过滤器添加到页面的方法，如下所示：

> 目录/尺寸-中/颜色-红色/

我有一定数量的过滤器，它们包含不太可能很快改变的属性。为了处理这些过滤器，我决定使用枚举，但这变得非常阴险，因为我需要合并空值、扩展方法和其他属性。

最后我遇到了这个建议使用结构的[Stackoverflow 答案。](https://stackoverflow.com/a/2907408/1347514)这是我合并的一个示例：

```
 public struct Color
{
    private int id;
    private bool isDef;

    private Color(int value) { id = value; isDef = true; }
    public bool Hasvalue { get { return isDef; } }
    public bool IsNull { get { return !isDef; } }

    public string Name
    {
        get
        {
            switch(id)
            {
                case 0: return "None";
                case 1: return "Black";
                case 2: return "Blue";
                case 3: return "Green";
                case 4: return "Orange";
                case 5: return "Pink";
                case 6: return "Brown";
                case 7: return "White";
                case 8: return "Yellow";
                case 9: return "Gray";
                case 10: return "Purple";
                case 11: return "Red";
                default: return null;
            }
        }
    }

    public string Abbreviation
    {
        get
        {
            switch(id)
            {
                case 1: return "BK";
                case 2: return "BL";
                case 3: return "GR";
                case 4: return "OR";
                case 5: return "PK";
                case 6: return "BN";
                case 7: return "WT";
                case 8: return "YL";
                case 9: return "GY";
                case 10: return "PR";
                case 11: return "RD";
                default: return null;
            }
        }
    }

    public static IEnumerable<Color> GetValues()
    {
        yield return Color.None;
        yield return Color.Black;
        yield return Color.Blue;
        yield return Color.Green;
        yield return Color.Orange;
        yield return Color.Pink;
        yield return Color.Brown;
        yield return Color.White;
        yield return Color.Yellow;
        yield return Color.Gray;
        yield return Color.Purple;
        yield return Color.Red;
    }

    public static Color Parse(string value)
    {
        if (String.IsNullOrEmpty(value))
            return Color.None;
        foreach (var c in GetValues())
        {
            if (String.Equals(c.Name, value, StringComparison.Ordinal))
                return c;
        }
        return Color.None;
    }

    public override bool Equals(object obj)
    {
        if(!(obj is Color))
            return false;
        Color color = (Color)obj;
        return color.Name.Equals(this.Name, StringComparison.Ordinal);
    }

    public static Color None = new Color(0);
    public static Color Black = new Color(1);
    public static Color Blue = new Color(2);
    public static Color Green = new Color(3);
    public static Color Orange = new Color(4);
    public static Color Pink = new Color(5);
    public static Color Brown = new Color(6);
    public static Color White = new Color(7);
    public static Color Yellow = new Color(8);
    public static Color Gray = new Color(9);
    public static Color Purple = new Color(10);
    public static Color Red = new Color(11);
} 
```

这些工作很好，但他们只是在某些方面感觉不正确。例如，我必须为每个结构编写相同的代码，这看起来像是很多代码。继承可重用代码并以某种方式将数据限制为接口会容易得多。

有没有更好的方法来做到这一点？我尝试过使用静态类，但不知道如何构建一个与我的结构具有相似功能的类。

抱歉，如果我在发帖时似乎没有希望，这是我的第一次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T22:28:53.283

**你需要一个颜色的枚举和一个 apprev-color 映射的字典**

**从正确的类导入开始：**

```
using System.Collections.Generic; 
```

**创建一个包含所有可能颜色的枚举：**

```
enum Colors : uint 
{
  Black =  0x00000000,
  Blue =   0x0000FF00,
  Green =  0x00FF0000,
  Orange = 0xFFA50000,
  Pink =   0xFFC0CB00,
  Brown =  0xA52A2A00,
  White =  0xFFFFFF00,
  Yellow = 0xFFFF0000,
  Gray =   0x80808000,
  Purple = 0x80008000,
  Red =    0xFF000000
}; 
```

*注意：这是假设 RGBA [rrggbbaa] 其中或 Red|Green|Blue|Alpha 可以是 00-FF (0-255) 之间的任何值。*

**然后使用字典来映射颜色值的一对多关系：**

```
private Dictionary<string, Colors> colorMap = new Dictionary<string, Colors>();
colorMap.Add("None", Colors.None);
colorMap.Add("Black", Colors.Black);
colorMap.Add("BK", Colors.Black);
colorMap.Add("Blue", Colors.Blue);
colorMap.Add("BL", Colors.Blue);
colorMap.Add("Green", Colors.Green);
colorMap.Add("GR", Colors.Green);
colorMap.Add("Orange", Colors.Orange);
colorMap.Add("OR", Colors.Orange);
colorMap.Add("Pink", Colors.Pink);
colorMap.Add("PK", Colors.Pink);
colorMap.Add("Brown", Colors.Brown);
colorMap.Add("BN", Colors.Brown);
colorMap.Add("White", Colors.White);
colorMap.Add("WT", Colors.White);
colorMap.Add("Yellow", Colors.Yellow);
colorMap.Add("YL", Colors.Yellow);
colorMap.Add("Gray", Colors.Gray);
colorMap.Add("Grey", Colors.Gray);
colorMap.Add("GY", Colors.Gray);
colorMap.Add("Purple", Colors.Purple);
colorMap.Add("PR", Colors.Purple);
colorMap.Add("Red", Colors.Red);
colorMap.Add("RD", Colors.Red); 
```

**以及映射的字典查找方法：**

```
public Color GetColor(string colorName)
{
  Color color = null;
  if (this.colormap.TryGetValue(colorName, out color));
  return color;
} 
```

*注意：不能使用属性，因为您的输入和输出类型不同。*

[TryGetValue()](http://msdn.microsoft.com/en-us/library/bb347013.aspx)进行字典查找。TryGetValue() 比 GetValue() 更受欢迎，因为如果它找不到密钥，它什么也不做（默认为您最初将“颜色”设置为的任何值。替代方法 (GetValue()) 会在失败时引发异常，需要被抓住。

**奖金：**

我在映射中添加了另一个值，看看你能不能找到它。映射值的好处是，它是可扩展的（易于添加）。你不会把自己锁在一个脆弱的结构中。

**免责声明：**

我在大约一年内没有写过一行 C#，所以这段代码可能不会像发布的那样工作。希望如果有任何错误，我在传达我的意思的要点方面做得很好。

**更新：**

我决定将 RGBA 值添加到枚举中。如果您还不知道，默认情况下，枚举的核心就像一个“字典”，其中 int 是自动生成的。通过更改它的类型并定义值，它可以转换为可用值（在本例中为“字典”）。

**从枚举值中获取颜色名称就像转换它一样简单：**

```
string colorName = "Gray";
Colors color = GetColor(colorName);
if(colorName != null)
{
  uint colorHex = (uint)color;
} 
```

*注意：我会打印 colorHex 但没有正确的格式它只会显示整数值（即不是十六进制值）。我不记得如何在头顶上进行文本格式化，所以我不会打扰。如果其他人想添加字符串格式，我不会反对。*

**更新 2：反向查找**

```
public string GetAbbrev(Colors color)
{
  Dictionary<string, Colors> abbrev = this.colorMap.First(abbrev => abbrev.Value == color);
  return abbrev.Key;
} 
```

我认为这种方法应该适用于反向查找。如果您不了解 LINQ 语法，它会查询所有字典条目并返回键与方法参数匹配的第一个条目。然后从该条目返回密钥。

# entity-framework - 使用 T4 DBContext 脚本编写显示名称属性

> ID：10253952
> 
> 赞同：1
> 
> 时间：2012-04-20T21:42:25.907
> 
> 标签：entity-framework, code-generation, t4, edmx

我的问题很简单：我写的代码是英文的，但界面是葡萄牙语的。没问题，因为我可以这样做：

```
[Display (Name = "Símbolo")]
public string Symbol { get; set; } 
```

这样，当我渲染我的屏幕时，它会以葡萄牙语出现：

```
@Html.LabelFor(model => model.Symbol) 
```

但...

当我在我的项目中使用 Model First EF 时，T4 DbContext 生成器会不断更改类。这样我就不能使用 Display 属性，因为它会被覆盖。

[这里](https://stackoverflow.com/questions/2489328/how-to-use-multiple-displayname-attribute-using-entity-framework-and-asp-net-mvc)给出的解决方案是扩展自动创建的部分类。对我来说有点笨拙。

所以我的想法是更改 T4 脚本以从 EDMX 模型中获取*Documentation.Summary*属性并将其添加为显示名称属性。

我发现[了一篇文章](http://social.msdn.microsoft.com/Forums/is/adodotnetentityframework/thread/7f16c10a-06c5-433a-bcb5-5f214099f53c)，其中有人解释了如何提取这些数据，但我没有成功使它在 DbContext Generator 上工作。

有人做过这个吗？你们有更好的想法吗？

谢谢！

# powershell - 我如何过滤使用 XPATH 检索的 Windows 事件，其中某个值是该值的子字符串？

> ID：10253954
> 
> 赞同：0
> 
> 时间：2012-04-20T21:42:32.203
> 
> 标签：powershell, xpath, event-log

Windows 事件可以通过 XPATH 进行过滤（这是一种快速搜索）。我已成功使用 PowerSHell Cmdlet Get-WinEvent 过滤，其中特定值是特定值，如下所示

```
$qry = "*[(EventData/Data[@Name='TaskName'] ='\Microsoft\Windows\Diagnosis\Scheduled') ]"                                   
Get-WinEvent -LogName Microsoft-Windows-TaskScheduler/Operational -FilterXPath         $qry -ErrorAction SilentlyContinue  -MaxEvents 3 
```

但是，我真的不想按特定任务名称过滤，而是按它的子字符串、包含的开头或其他内容进行过滤。例如，在上述场景中，我想做 "startswith" \Microsoft\Windows\Diagnosis 。然而，我尝试过的所有不同技术，似乎都是标准的 XPATH 1.0 语法，例如

```
$qry = "*[starts-with(EventData/Data[@Name='TaskName'] ,'\Microsoft\Windows\Diagnosis') ]" 
```

报错 *Get-WinEvent : 指定的查询无效*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:58:06.467

尝试包含功能：

```
$x = [xml] '<root><books><book title="Foo" /></books></root>'
$x.SelectSingleNode('//book[contains(@title, oo)]') 
```

xpath 字符串函数的参考：http: [//msdn.microsoft.com/en-us/library/ms256180.aspx](http://msdn.microsoft.com/en-us/library/ms256180.aspx)

你的可能看起来像：

```
"*[EventData[contains(Data,'\Microsoft\Windows\Diagnosis\Scheduled')]]" 
```

# php - jQuery AJAX 请求 Internet Explorer php 文件 -> NO / html 文件 -> YES

> ID：10253959
> 
> 赞同：0
> 
> 时间：2012-04-20T21:43:02.663
> 
> 标签：php, jquery, html, ajax, internet-explorer

我在 Internet Explorer 中有以下 jQuery 代码和一个令人心碎的问题，还有其他地方......

```
$.ajax({
    type: "POST",
    url: "test.php",
    //url: "test.html",
    dataType: "text",
    cache: false,
    error:function(xhr, status, errorThrown) {
        alert(errorThrown+" -- "+status+" -- "+xhr.statusText);
    },
    success:function(callback) {
        alert("Success, also in IE");
    },
    async: false
}).responseText; 
```

我的问题是 IE 不“接受” test.php 文件与 test.html 文件一样的测试内容！！！使用 html 文件，脚本可以工作，但我想使用 ajax 请求运行 php 脚本......有什么问题？

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T10:38:48.503

**上述问题的解决方法是：**

```
header('Content-Type: text/html; charset=utf-8');  
header('Cache-Control: must-revalidate, pre-check=0, no-store, no-cache, max-age=0, post-check=0'); 
```

对于 Internet Explorer，标头丢失或服务器未正确设置...

# javascript - JavaScript .. Image() 对象作为数组？

> ID：10253962
> 
> 赞同：0
> 
> 时间：2012-04-20T21:43:42.967
> 
> 标签：javascript, html

我正在构建一个简单的 2D Tile-map HTML5 ......并且我有图像要使用。有什么办法可以转弯

```
var imageObj = new Image(); 
```

成一个数组，所以我不必做手动变量？

编辑：我尝试做 Array 但我找不到`src`. 等等..我当时想..一个数组没有`src`..嗯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:45:39.687

你为什么不做一个数组

```
var images = []; 
```

并将所有图像推送到该数组？

```
images.push(new Image()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:49:17.680

做一个多维数组，像这样：

```
var map = [];

for(var x = 0; x<MAP_WIDTH; x++) {
    map[x] = [];
    for(var y = 0; y<MAP_HEIGHT; y++) {
        map[x][y] = new Image();
    }
} 
```

然后，您可以访问您的图像，`map[X][Y]`其中 X 和 Y 是您要访问的图块的坐标。

*小提示：Javascript 不支持真正的多维数组，但这已经足够接近了。它实际上是一个嵌套数组，但是是的……可能比您需要知道的要多。*

# c - 海耶斯 AT 命令：检测远程挂断？

> ID：10253965
> 
> 赞同：1
> 
> 时间：2012-04-20T21:44:09.190
> 
> 标签：c, modem, at-command

您应该如何以编程方式检测通话中的远程调制解调器何时挂断？我正在编写一个与 SoftModem 设备接口的 C 程序`/dev/ttySL0`Ubuntu linux 中的 SoftModem 设备接口的 C 程序。我能够使用 Hayes AT 命令配置调制解调器并与远程调制解调器通信。但是，我无法确定我应该如何检测到另一端已挂断电话。

我配置了调制解调器，以便当另一端挂断时，设备会打印`NO CARRIER`并切换到命令模式。但是，我无法使用`NO CARRIER`字符串，因为我不能保证调制解调器在数据模式下不会接收到该字符串。

你如何“听”远程挂断？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T23:29:48.273

这是调制解调器上的硬件信号，即载波检测 (CD) 线路。您需要对其进行监视才能知道连接已丢失。linux 的基础知识在[这个how-to](http://www.lafn.org/~dave/linux/Serial-Programming-HOWTO.txt)中进行了描述，您可以使用 ioctl() 使用 TIOCM_CAR 命令获取信号状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T14:15:48.423

测试`NO CARRIER`as text 是不够的。这段文字经常出现在网络上的网站上，甚至在问答网站上。

来自调制解调器，它应该包含在换行符中。

此外，在检测到该文本后，您可以尝试使用 切换到命令模式`+++`。如果可行，则您的连接仍然存在，您可以重新连接它并继续使用它。如果没有（因为您已经在那里并且`+++`是一个无效命令），则连接已经消失。

# html - 水平滚动添加不正确

> ID：10253967
> 
> 赞同：0
> 
> 时间：2012-04-20T21:44:24.527
> 
> 标签：html, css, wordpress

你知道是什么导致我的网页水平滚动吗？

[链接到网页](http://#)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:52:23.487

#logo 上有 20000px 的文本缩进

```
@media screen
    #logo {
    background-image: url('images/logo.png');
    width: 150px;
    height: 28px;
    text-indent: 20000px;   <--- here's the culprit!!!
} 
```

用户 Globin (http://stackoverflow.com/users/848053/globin) 指出 Facebook 按钮也存在错误：

`<dic>`应该`<div>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:50:53.333

我通过添加一个容器 div 来解决这个问题。您想包装整个页面（从 div 中的开始正文到结束正文标记。也许其他人可以评论为什么需要这样做？因为我不确定这一点。

```
<body class="home blog">
  <div id="wrapper">
    REST OF PAGE
  </div>

</body> 
```

CSS：

```
div#wrapper
  {
    overflow: hidden;
  } 
```

# android - 适用于 Android 的 Java 企业应用程序

> ID：10253970
> 
> 赞同：1
> 
> 时间：2012-04-20T21:44:45.630
> 
> 标签：android, jsp, jsf, jakarta-ee, enterprise

我想为使用 JEE6 的 Android 应用程序。是否可以制作一个在 Glassfish（或其他服务器）上运行但在 android 应用程序中查看的应用程序？是否有任何框架或某事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:46:47.820

是的，您需要在 JEE6 服务器中为您的应用程序创建一个 API。然后使用您想通过 TCP/IP 进行通信的任何协议（我强烈建议您为此使用 HTTP）。

# javascript - 如果我有一个 mongo 文档 id 作为字符串，我如何将它作为 _id 查询？

> ID：10253972
> 
> 赞同：13
> 
> 时间：2012-04-20T21:44:55.667
> 
> 标签：javascript, node.js, mongodb

如果我有一个 mongo 文档 id 作为字符串，我如何将它作为 _id 查询？

它会正常工作`.find({_id:'stringID'})`还是我需要先将其转换为 bson 对象？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-20T22:35:02.683

你的意思是你有一个ObjectId的24个十六进制数字字符串？

假设这就是您的意思，大多数驱动程序都有办法获取字符串并将其转换为 ObjectId。在 JavaScript 中是：

```
.find({_id:new ObjectId("4f91bfcfaa7c5687a0c686d4")}) 
```

**更新**后对节点原生驱动程序更有用（来自[https://github.com/christkv/node-mongodb-native](https://github.com/christkv/node-mongodb-native)的文档）：

```
// Get the objectID type
var ObjectID = require('mongodb').ObjectID;

var idString = '4e4e1638c85e808431000003';
collection.findOne({_id: new ObjectID(idString)}, console.log)  // ok
collection.findOne({_id: idString}, console.log)  // wrong! callback gets undefined 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T22:08:51.807

如果您的 _id 值是字符串，您可以像查询任何其他字段一样查询它们。（请记住，如果您为 _id 设置自定义值，它们必须保持唯一，否则您将收到重复键错误。）

这是 Mongo JS Shell 中的一个示例：

```
> db.test.insert({_id:"stringID1"})
> db.test.insert({_id:"stringID2"})
> db.test.insert({_id:"stringID3"})
> db.test.find({_id:"stringID1"})
{ "_id" : "stringID1" }
> 
```

这是你要找的吗？我希望我没有误解你的问题！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-08T16:09:37.817

Mongoose 使用时会自动将字符串转换`_id`为 ObjectId `findByID`，因此您可以使用字符串进行查询`_id`。

还请记住，任何输入到您的 API 的输入都来自`req.body`或`req.params`都将是类型字符串，因此您需要在需要时输入强制类型转换...，但如前所述，猫鼬会为您执行此操作，因此您可以保留`_id`它进来的字符串格式作为。

# javascript - Using JQuery with a string (instead of DOM)

> ID：10253973
> 
> 赞同：0
> 
> 时间：2012-04-20T21:45:06.717
> 
> 标签：javascript, jquery, html, ajax

I remember using a plugin in the past where I could use AJax to load a page and update only part of the DOM. The AJax request returns the entire HTML page, but only a small portion of it replaces part of the currently loaded DOM.

For example, SO can use this function to fetch `http://stackoverflow.com` and only update `#content`. SO would make an AJax request to fetch `http://stackoverflow.com`, fetch `#content` from the returned string, and update `#content` of the DOM.

Sorry if my question is confusing. How would I do this without a plugin?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:48:21.363

The [`.load()`](http://api.jquery.com/load/) function is designed to do this. Just include a selector for an element along with the URL, like so:

```
$('#content').load('http://stackoverflow.com #content', optionalCallbackFunction); 
```

That will replace the content of the element with ID `content` on the current page, with the contents of the element with ID `content` on the page returned by an AJAX request to `http://stackoverflow.com`, then run the function called `optionalCallbackFunction`. Assuming, of course, that the request was successful.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:55:47.403

Without the AJAX, you can parse a raw string like this:

```
var str = "<div><h1>Page Title</h1><div id='content'>This is new.</div></div>";
var text = $("#content",$(str)).html();
$('#content').html(text); 
```

# android - 如何在应用程序之间的 IPC 中强制执行权限？

> ID：10253977
> 
> 赞同：1
> 
> 时间：2012-04-20T21:45:22.823
> 
> 标签：android, permissions, ipc

我是 Android 新手，很难为以下有关权限和 IPC 的问题找到一个好的答案：

如果 App 1 有权限做某事（比如说读取联系人），但 App 2 没有这个权限，那么 App 2 可以通过 IPC 与 App 1 获取用户联系人吗？让我们假设 App 1 没有使用权限保护其任何活动/等，但它仍然具有 READ_CONTACTS 的使用权限。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T22:44:11.940

> 如果 App 1 有权限做某事（比如说读取联系人），但 App 2 没有这个权限，那么 App 2 可以通过 IPC 与 App 1 获取用户联系人吗？

如果 App 1 允许，是的。如果 App 1 不采取措施确保 App 2 具有适当的权限，这将是 App 1 中的安全漏洞。

# php - 使用 PHP 将数据插入两个单独的表中

> ID：10253981
> 
> 赞同：0
> 
> 时间：2012-04-20T21:45:38.693
> 
> 标签：php, mysql, sql, database, forms

我正在尝试将数据插入到同一数据库中的两个不同表中，如果我尝试将其插入到一个数据库中，它可以工作，但是，一旦我将第二个查询插入到我的代码（`$desc_query`）中，它就不会更新任何表。

这是我的代码：

```
 $name= strip_tags($_POST['name']);
    $l_name= strip_tags($_POST['last_name']);

    $c_id = strip_tags($_POST['company_id']);
    $a_d = strip_tags($_POST['add_description']);
    $d_t = strip_tags($_POST['desc_text']);

$connect = mysql_connect('localhost','id','pass') or die ("couldn't connect!"); 

mysql_select_db('database_db') or die('could not connect to database!');   

//inserting names

$job_query=mysql_query("INSERT INTO names VALUES ('', '$name', '$l_name')");

    //inserting a new description if needed. (this is the part that ruins everything)
if($a_d == 'true'){
    $desc_query=mysql_query("INSERT INTO descriptions VALUES ('','$c_id','$d_t')");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T22:10:01.487

您可能会遇到某些字符（例如 ' 和 "）正在破坏 SQL 查询的问题（更不用说打开您的应用程序以进行 SQL 注入攻击了）。

我建议清理所有用户提供的数据，如下所示：

```
$name = mysql_real_escape_string(strip_tags($_POST['name']), $connect);
$l_name = mysql_real_escape_string(strip_tags($_POST['last_name']), $connect);
...
$d_t = mysql_real_escape_string(strip_tags($_POST['desc_text']), $connect); 
```

始终假设用户将输入可能（或可能不会）破坏您的 SQL 的古怪或恶意内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T22:01:47.543

您是否尝试过回显查询，然后直接在数据库上运行它们？

如果没有关于数据库的更多信息，我们无法真正判断查询本身是否有效。

# sql - 2个父表的SQL外键问题

> ID：10253986
> 
> 赞同：0
> 
> 时间：2012-04-20T21:46:19.783
> 
> 标签：sql, database, database-design

我有 2 张桌子`User`和`Group`. 我有一个由用户和组`Attributes` *共享*的表，其中包含列：

*   `attributeName`.
*   `AttributeValue`.
*   `ObjectID`.

`ObjectID`指向用户的主键或组的主键。我添加了一个外部约束，`Cascade on Delete`以便在删除用户或组时自动删除属性。

现在的问题是当我为用户插入一个属性时，我有一个外键约束，因为该组不存在。

我应该如何进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T13:42:04.150

你基本上有3个选择：

1.  保留您当前的设计，但 `Attribute.ObjectID`用`UserID`and替换`GroupID`，将单独的 FK 附加到它们中的每一个（一个朝向`Group`，另一个朝向`User`）并允许其中一个为 NULL。您还需要一个 CHECK 约束来确保它们**都不**为 NULL。

    ![在此处输入图像描述](../Images/6bb763ff7af11245f0ac808758e7ceec.png)

2.  将表拆分`Attribute`为`UserAttribute`and `GroupAttribute`，从而将每个外键分成自己的表。

    ![在此处输入图像描述](../Images/4743116081a69eeaf68fecf15e166c26.png)

3.  使用继承，像这样：

    ![在此处输入图像描述](../Images/2f18febd666a9641d51442c5b1377253.png)

解决方案 (1) 高度依赖于您的 DBMS 如何处理 NULL 上的 UNIQUE，并且 (1) 和 (2) 都允许将相同`AttributeName`的属性用于两个不同的属性，一个用于用户，另一个用于组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T10:07:29.490

正如您所发现的，您不能将一列作为两个不同表的外键。当用户不存在具有相同 id 的组时，您不能为用户添加属性。而且您当然可以不知道该属性是针对用户还是针对组的。

从您还提到 am:m 用户和组之间的关系的评论中，我建议以下内容。

```
create table [User]
(
  UserID int identity primary key,
  Name varchar(50) not null
)

go

create table [Group]
(
  GroupID int identity primary key,
  Name varchar(50) not null
)

go

create table UserGroup
(
  UserID int not null references [User](UserID),
  GroupID int not null references [Group](GroupID),
  primary key (UserID, GroupID)
)

go

create table UserAttribute
(
  UserAttributeID int identity primary key,
  Name varchar(50) not null,
  Value varchar(50) not null,
  UserID int not null references [User](UserID) on delete cascade
)

go

create table GroupAttribute
(
  GroupAttributeID int identity primary key,
  Name varchar(50) not null,
  Value varchar(50) not null,
  GroupID int not null references [Group](GroupID) on delete cascade
) 
```

注意：属性表的使用应该是针对您事先不知道的属性。您所知道的所有属性都应该是实际表中的字段。为客户定义的属性保留属性的使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T21:50:57.620

我认为您应该允许此外`NULL`键字段的值`ObjectId`，以便您可以插入任何`ObjectId`不引用任何用户或组的 = null 行。

为了获得更好的设计，您应该删除此`ObjectId`列，`AttributeId`在两个表中添加一个新列，`User`然后`Group`.

# php - PHP - 获取图像大小

> ID：10253987
> 
> 赞同：1
> 
> 时间：2012-04-20T21:46:22.853
> 
> 标签：php

getimagesize有一个**非常**奇怪的错误。

代码非常简单：

```
 if(!$path || !file_exists($path))
        return true;
   list($w, $h, $type) = getimagesize($path); 
```

var_dump($path) 返回字符串“web/img/diaporama/diapo-call_1.jpg”

此代码触发：getimagesize(): 读取错误！

该文件存在，它是一个常规的 jpg 文件。

奇怪的是，如果我插入： $path = 'web/img/diaporama/diapo-call_1.jpg'; 在第 2 行和第 3 行之间，一切正常。

$path 和 'web/img/diaporama/diapo-call_1.jpg' 完全相同，所以这个语句应该没有任何区别。var_dump($path, 'web/img/diaporama/diapo-call_1.jpg') 返回两次相同的字符串..

我在另一台服务器上试过，它运行正常。

如果路径指向另一个文件，它也可以正常运行。

关于这里可能是什么问题的任何想法..？

# oracle - Oracle Forms Builder - 更改为另一种形式的窗口

> ID：10253988
> 
> 赞同：1
> 
> 时间：2012-04-20T21:46:46.627
> 
> 标签：oracle, oracle10g, oracleforms

到目前为止，我们有两个表单，需要使用按钮从from1（即登录屏幕）中的window1切换到formX中的windowX（触发代码如下）：

```
begin
  show_window('windowX');
  go_block('some_block_in_formX');
end; 
```

这给出了错误 FRM-41052：找不到窗口：无效 ID

所以问题是，我应该以某种方式将 formX 添加到 show_window 参数中还是有其他方法？谢谢你。

请注意，表格位于不同的文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T05:37:21.550

> 表格在不同的文件中。

如果表单是不同的文件，您需要使用[open form/call form/newform](http://www.orafaq.com/wiki/Forms_FAQ#What_is_the_difference_between_CALL_FORM.2C_NEW_FORM_and_OPEN_FORM.3F)调用另一个表单- 任何适合您的需要。

`show_window/go_block`仅当您移动到*相同*形式的不同窗口/块时才能使用序列 - 以及错误消息

> 错误 FRM-41052：找不到窗口：ID 无效

抱怨它不能去那个窗口，因为它的形式*不同*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T05:33:13.457

每个表单有效地为它的所有窗口、块、项目等提供了一个私有命名空间——并且您的代码始终在单个表单的上下文中运行。

要解决这个问题，您需要一个表单参数，以及其他形式的一些代码，例如：

1.  在formX中，添加一个参数ACTION
2.  在 form1 中，将值 'XYZ' 传递给 ACTION
3.  在 formX 中，在`WHEN-NEW-FORM-INSTANCE`触发器中检查 if `:PARAMETER.ACTION = 'XYZ'`，如果是，请执行 show_window 和 go_block。将相同的代码复制到您的`WHEN-WINDOW-ACTIVATED`触发器。

当然，您需要考虑参数的名称（例如 ACTION）和值（'XYZ'），这对于将来维护您的表单的人来说是有意义的。

# iphone - 使用 NSDateFormatter 时出现内存泄漏

> ID：10253993
> 
> 赞同：6
> 
> 时间：2012-04-20T21:47:13.910
> 
> 标签：iphone, objective-c, nsdateformatter

我在 NSDateFormatter 中看到了很多关于内存泄漏的问题/答案，但似乎没有一个可以帮助我确定是什么导致我的应用程序中的内存泄漏。这是我的代码：

```
- (id)init
{
    if ((self = [super init])) 
    {
        items = [[NSMutableArray alloc] init];
        events = [[NSMutableArray alloc] init];
        buffer = [[NSMutableData alloc] init];
        format = [[NSDateFormatter alloc] init];
        lastFromDate = @"";
    }
    return self;
}

- (void)presentingDatesFrom:(NSDate *)fromDate to:(NSDate *)toDate delegate:(id<KalDataSourceCallbacks>)delegate
{ 
    [format setTimeZone:[NSTimeZone systemTimeZone]];
    [format setDateFormat:@"MM/dd/yyyy"];
    NSString *stringFromDate = [NSString stringWithString:[format stringFromDate:fromDate]];
    NSString *stringToDate = [NSString stringWithString:[format stringFromDate:toDate]];

    NSLog(@"From date: %@, To date: %@", stringFromDate, stringToDate); 

    [self didDatesChange:stringFromDate];

    if (dataReady) {
        [callback loadedDataSource:self];
        return;
    }
    callback = delegate;
    [self retrieveEventData:stringFromDate to:stringToDate];
}

- (void)dealloc
{
    [items release];
    [events release];
    [buffer release];
    [lastFromDate release];
    [format release];
    [super dealloc];
} 
```

当我运行“配置文件”->“泄漏”时，每次在线调用函数时都会发生内存泄漏

```
NSString *stringFromDate = [NSString stringWithString:[format stringFromDate:fromDate]]; 
```

有人可以解释可能发生的事情吗？谢谢，迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T09:01:19.693

您只需使用以下方法从日期获取字符串即可正常工作......

```
-(NSString *)StringFromDate:(NSDate *)DateLocal{
    NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
    [dateFormat setDateFormat:@"MM/dd/yyyy"];
    NSString *dateString = [dateFormat stringFromDate:DateLocal];  
    NSLog(@"Date is HERE  =====>> %@",dateString);
    return dateString;
} 
```

当你想得到日期字符串之后，就像下面这样使用......

```
NSString *stringFromDate = [self stringFromDate:fromDate]];
[stringfromdate retain];
NSString *stringToDate = [self stringFromDate:toDate]];
[stringTodate retain]; 
```

及以上 -(NSString *)StringFromDate:(NSDate *)DateLocal 方法必须在您的 viewcontroller.m 文件中定义......它工作正常......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:57:26.013

仅供参考，您可以更改此设置：

```
 NSString *stringFromDate = [NSString stringWithString:[format stringFromDate:fromDate]]; 
```

对此：

```
 NSString *stringFromDate = [format stringFromDate:fromDate]; 
```

stringWithString 应该返回一个自动释放的 NSString ，所以我不相信这是你泄漏的来源。对我来说，您的代码似乎没有泄漏。

# vb6 - （解析主机）是什么意思？

> ID：10253994
> 
> 赞同：2
> 
> 时间：2012-04-20T21:47:15.663
> 
> 标签：vb6, winsock

很抱歉，如果这不是程序问题，我也可能会为此投下很多反对票，但我真的需要详细了解，(Resolving Host) 是什么意思？！

我正在尝试配置与托管朋友网站的网络服务器的连接，并且我正在开发一个 vb6.0 应用程序。使用 WinSock.OCX 工具，它的状态之一是（解析主机），所以我需要知道能够为它提供一些代码意味着什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T22:51:36.523

您不必处理该状态。这只是 WinSock.ocx 将 DNS 名称（比如说*www.dilbert.com*）转换为相应 IP（*184.106.169.31*）的阶段。这是由 WinSock 自动处理的，所以你只需要等待。

WinSock 可能会在这个阶段给你错误，因为它可能是

1.  提供的域名是/不再有效
2.  提供的域名无效（例如*92$!#d.com*）
3.  DNS 服务器不可用（例如，没有网络连接）

# ios - Monotouch内存视图控制器问题

> ID：10253995
> 
> 赞同：2
> 
> 时间：2012-04-20T21:47:17.013
> 
> 标签：ios, uiviewcontroller, uinavigationcontroller, xamarin.ios, instruments

我的应用程序的内存消耗有问题我希望你能帮我解决这个问题，我有一个导航控制器，可能有 10 个控制器可以向前或向后导航，我正在使用 Instruments 来检查内存分配（也使用了mtouch profiler），当我向前导航（第一次）时，应用程序消耗的内存显然增加了..但是当我点击导航控制器的标准后退按钮时，内存仍然是相同的数量，如果我继续前进，最糟糕的是内存再次增加更多（即：homeVC 10mb，VC1 = 10.5mb，回到 homeVC = 10.5 mb，转发到 VC1 = 11mb），是的，当我仍在浏览 VC 时，内存正在增加。在这种情况下，我有以下问题：

*   导航控制器的标准后退按钮上的应用程序的行为是什么（它执行 PopViewControllerAnimated？）。
*   PopViewControllerAnimated 和 navController 的其他 Pop 方法应该释放消失的 VC 消耗的内存吗？
*   如果 navcontrollers 的 Pop 方法没有释放应用程序的内存，我应该什么时候处理我消失的 VC 以避免消耗这么多内存？（我想知道在单点触控应用程序中管理内存的最佳工作，也许使用 DidReceiveMemoryWarning 方法？或者还有其他地方可以管理我的应用程序内存的释放）。

提前感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:56:40.243

这听起来与此错误非常相似：[https ://bugzilla.xamarin.com/show_bug.cgi?id=1889](https://bugzilla.xamarin.com/show_bug.cgi?id=1889)

您可以通过偶尔获取导航控制器的 ViewControllers 属性来解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T21:58:38.773

您可以发布您在分配和推送您的 VC 时使用的代码吗？

我猜正在发生的事情是你在分配它之后没有释放它，所以当 NavigationController 在你按下返回按钮时释放它时，保留计数仍然是 +1。

# jquery - 完成将鼠标悬停在文本链接到更改图像

> ID：10253997
> 
> 赞同：1
> 
> 时间：2012-04-20T21:47:24.487
> 
> 标签：jquery, wordpress, jquery-ui, jquery-events

当用户将鼠标悬停在我一直在这里查看的文本链接上并基于它的 jQuery 代码时，我试图让一个图像出现在另一个图像之上，但需要帮助让它工作 [悬停在文本链接上以更改图像](https://stackoverflow.com/questions/5590878/hover-on-text-link-to-change-image)

我也试过让它在这里工作 [http://jsfiddle.net/edgardo400/pDTvu/](http://jsfiddle.net/edgardo400/pDTvu/)

html

```
<div id="box1" class="box">
    <div style="height: 335px; width: 945px; border: 6px solid #d7c3a5;">
        <h1>
            Cat Poison Control
        </h1>
        <ul>
            <li style="list-style-position: outside; list-style-image: url('http://testdomain.edgardoroldanonline.com/wp-content/uploads/2012/04/35px-Black_Cat-icon.png');">
                <a class="hoverlink" href="http://www.catster.com/cat-health-care/cat-deshedding-tool" data-img="http://testdomain.edgardoroldanonline.com/wp-content/uploads/2012/04/desheddingtool493x335.jpg">
                    What Does a De-Shedding Tool Do?
                </a>
            </li>
            <li style="list-style-position: outside; list-style-image: url('http://testdomain.edgardoroldanonline.com/wp-content/uploads/2012/04/35px-Himalayan_Cat-icon.png');">
                <a href="http://www.catster.com/cat-health-care/cleaning-cat-ears">
                    Cleaning Cat Ears
                </a>
            </li>
            <li style="list-style-position: outside; list-style-image: url('http://testdomain.edgardoroldanonline.com/wp-content/uploads/2012/04/35px-Orange_Tabby-icon.png');">
                <a href="http://www.catster.com/cat-health-care/how-to-give-a-cat-a-bath">
                    How to Give a Cat a Bath (and Survive!)
                </a>
            </li>
            <li style="list-style-position: outside; list-style-image: url('http://testdomain.edgardoroldanonline.com/wp-content/uploads/2012/04/35px-White_Kitty-icon.png');">
                <a href="http://www.catster.com/cat-health-care/clipping-cat-claws">
                    How to Clip Your Cat's Nails
                </a>
            </li>
            <li style="list-style-position: outside; list-style-image: url('http://images2.wikia.nocookie.net/__cb20100110163009/farmville/images/thumb/b/bb/Black_Cat-icon.png/35px-Black_Cat-icon.png');">
                <a href="http://www.catster.com/cat-health-care/cat-grooming-tools">
                    The Five Essential Cat Grooming Tools
                </a>
            </li>
            <li style="list-style-position: outside; list-style-image: url('http://testdomain.edgardoroldanonline.com/wp-content/uploads/2012/04/40px-Andean_Cat-icon.png');">
                <a href="http://www.catster.com/cat-health-care/cat-grooming">
                    Cat Grooming: A Primer on Keeping Kitty Clean
                </a>
            </li>
        </ul>
        <div id="catslider">

            <img class="alignright size-full wp-image-34" style="position: relative;" title="aspca_poisoncontrol_hotline_feathered"
            src="http://anime.edgardoroldanonline.com/wp-content/uploads/2012/04/aspca_poisoncontrol_hotline_feathered.png" alt="aspca hotline"
            width="150" height="150" />
        </div>

    </div>
    <p>
        <button class="btn2">
            fade out
        </button>
    </p>
</div> 
```

和 jQuery

```
jQuery(function(){
var $catslider=jQuery('#catslider'); //we save the slider
var $defaultimage=jQuery('img', $catslider); //and the default image

//mouseenter for the link
jQuery('#projects .hoverlink').hover(function () {

        function complete() {
          jQuery('#slider');
        }
  var filename=jQuery(this).attr('data-img'); //we get the filename from data-img

  jQuery('<img id="hoverimage" src="'+filename+'" alt="" />')
    .appendTo($catslider).fadeIn(500); //append and fade in new image (#hoverimage)

  $defaultimage.fadeOut(500); //fade out default image
},
//mouseleave for the link
function () {
  jQuery('#hoverimage').fadeOut(500, function () { //fade out #hoverimage
    $(this).remove(); //when animation is done, remove it
  });

  $defaultimage.fadeIn(500); //meanwhile fade in original image
});

}); 
```

我感谢任何和所有的帮助：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T01:36:32.990

我不是 100% 确定您要做什么，但请尝试此代码。此示例将在用户第一次悬停缓存时添加图像，然后在每次悬停后显示隐藏图像。

工作示例：http: [//jsfiddle.net/leviputna/cQqGf/2/](http://jsfiddle.net/leviputna/cQqGf/2/)

```
<script>
jQuery(function(){
    $("#box1").delegate("a", "hover", function(event){
        var $img = $(this).parent("li").find('img');
        var image = $(this).attr('data-img');

        if( event.type === 'mouseenter' ) { 
            if($img.lenght){
                $img.show();
            }else{
                $(this).parent("li").append('<img id="theImg" src="' + image + '" />');
            }
        }else{
            if($img){
                $img.hide();
            } 
        }
    });
});​
</script> 
```

注意：如果您的悬停图像移动链接位置，您将获得疯狂的闪烁效果。您将需要添加一些 css 以确保这不是问题。

# ios - 创建子类 C4Shapes（C4 框架）时获取未声明的标识符

> ID：10253999
> 
> 赞同：3
> 
> 时间：2012-04-20T21:47:32.277
> 
> 标签：ios, subclass, c4

我正在用 C4 编写一个程序，该程序由三个单独的按钮组成，按下时它们的形状都会发生变化。当我像这样为每个按钮创建一堆方法时：

```
@implementation MyButton

-(void)methodA {
    C4Log(@"methodA");
    [button1 ellipse:CGRectMake(centerPos.x - buttonWidth/2.0f, 80, buttonWidth, buttonHeight)];
}

-(void)methodB {
    C4Log(@"methodB");
    [button2 ellipse:CGRectMake(centerPos.x - buttonWidth/2.0f, centerPos.y - buttonHeight/2.0f, buttonWidth, buttonHeight)];
}

-(void)methodC{
    C4Log(@"methodC");
    [button3 ellipse:CGRectMake(centerPos.x - buttonWidth/2.0f, canvasHeight - 280, buttonWidth, buttonHeight)];
}

@end 
```

...然后在画布上召唤他们...

```
[button1 listenFor:@"touchesBegan" fromObject:button1 andRunMethod:@"methodA"];
[button2 listenFor:@"touchesBegan" fromObject:button2 andRunMethod:@"methodB"];
[button3 listenFor:@"touchesBegan" fromObject:button3 andRunMethod:@"methodC"]; 
```

...我最终得到的只是一堆未声明的标识符错误。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:59:46.390

我需要查看您在 MyButton.h 文件中定义的变量的副本以确定，但据我所知，从您的错误和您的代码中可以看出，以下行正在调用 ivars：

```
[button1 ellipse:CGRectMake(centerPos.x - buttonWidth/2.0f, 80, buttonWidth, buttonHeight)]; 
```

需要在您的 .h 文件中定义 ivars centerPos、buttonWidth 和 buttonHeight，如果其中一个没有被声明，那么您将遇到这种错误。