# StackOverflow 问答 000190000-000190999

# c - 在线 C 参考手册

> ID：190006
> 
> 赞同：17
> 
> 时间：2008-10-10T03:21:36.437
> 
> 标签：c, reference-manual

几年前我在大学学习过 C 编程，当时开发了一些中等应用程序（没什么大不了的）。现在我必须开发一些更“高级”的 C 应用程序（涉及 POSIX 线程和 RPC），但现在即使有了基础，我也有点生疏了。

谁能推荐我好的在线 C 参考手册？这可以帮助我更快地调整节奏。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T03:28:49.183

对于最基本的，我发现[这张参考卡](http://users.ece.utexas.edu/~adnan/c-refcard.pdf)非常有用。对更高级的功能没有帮助，但它可以帮助去除锈迹。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-10T03:28:30.587

*   ~~[C 标准库参考（C89 和 C99）](http://members.aol.com/wantondeb/)~~
*   [C89 库参考指南](http://www.acm.uiuc.edu/webmonkeys/book/c_guide/)
*   [GNU C 教程](http://www.crasseux.com/books/ctutorial/)（不仅仅是一个教程，相当有用的参考）

我从之前关于 SO 的类似问题中得到了这些。我想归功于原始海报，但不幸的是似乎找不到那个问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-14T21:25:55.360

不要忘记手册页。如果您在任何 UNIX 衍生平台（Linux、BSD、Cygwin）上进行开发，您几乎总是可以执行类似的操作`man printf`或`info printf`获取任何库函数的文档。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T03:35:53.613

它不在网上，但最好的 C 参考文献是[Harbison & Steele](https://rads.stackoverflow.com/amzn/click/com/013089592X)（是的 - 它比 K&R 更好）。

你可以得到第 4 版的基本出货（我不知道第 5 版做了哪些改进。）：

[http://www.amazon.com/dp/0133262243](https://rads.stackoverflow.com/amzn/click/com/0133262243)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T03:29:16.640

迄今为止最好的 C 参考书是 Kernighan 和 Ritchie 的[“The C Programming Language”](https://rads.stackoverflow.com/amzn/click/com/0131103628)，采用的是死树形式。它紧凑而完整。

对于在线参考，您可以尝试 Brian Kernighan 的[Programming in C Tutorial](http://www.lysator.liu.se/c/bwk-tutor.html)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-10T03:31:05.043

手册

*   [http://www.gnu.org/software/libc/manual/](http://www.gnu.org/software/libc/manual/)
*   [http://msdn.microsoft.com/en-us/library/3bstk3k5.aspx](http://msdn.microsoft.com/en-us/library/3bstk3k5.aspx)

教程

*   [http://www.physics.drexel.edu/students/courses/Comp_Phys/General/C_basics/](http://www.physics.drexel.edu/students/courses/Comp_Phys/General/C_basics/)
*   [http://www.cprogramming.com/tutorial.html](http://www.cprogramming.com/tutorial.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T08:47:41.537

[C书](http://publications.gbdirect.co.uk/c_book/)可在线免费获得。它不是真正的参考手册，但仍然是一个很好的资源。从网站：

> 这是 The C Book 的在线版本，由 Mike Banahan、Declan Brady 和 Mark Doran 编写，最初由 Addison Wesley 于 1991 年出版。此版本免费提供。
> 
> 虽然这本书不再印刷，但它的内容在今天仍然非常重要。C 语言仍然很流行，特别是对于开源软件和嵌入式编程。我们希望这本书对使用 C 的人有用，或者至少是有趣的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-13T09:38:40.233

C 和 C++ 的最佳在线参考可能是 www.cplusplus.com

量子皮特

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-12T14:18:47.437

我建议至少阅读一次[comp.lang.c 常见问题解答，以帮助去除锈迹。](http://c-faq.com/)对于参考资料，您可能想要获取 C 标准的副本，包含 TC3 的 C99 的最新版本可在[此处](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)免费获得，对于 C89，最新的草稿版本以[文本文件](http://www.cpax.org.uk/prg/portable/c/ansi_c.zip)的形式提供，或者您可以获取The [Annotated ANSI C Standard](https://rads.stackoverflow.com/amzn/click/com/0078819520)只需几美元，并拥有实际标准的硬拷贝（只需忽略右侧页面上的“注释”）。由于您使用的是 POSIX，您可能希望更加熟悉包含标准 C 库以及 POSIX 函数的单一 Unix 规范，您可以在[Open Group阅读/下载 SUSv3](http://www.unix.org/online.html)（需要注册，但免费且快速）。

对于离线资源，我还推荐Harbison & Steele 的[C: A Reference Manual (5th Edition)](https://rads.stackoverflow.com/amzn/click/com/013089592X)，它彻底涵盖了 C 的每个语言特性和标准功能，并记录了各种标准版本之间的差异。

# java - 用于维护 Java 中的对象方法合同的自动单元测试？

> ID：190007
> 
> 赞同：10
> 
> 时间：2008-10-10T03:22:10.570
> 
> 标签：java, unit-testing, testing, junit

在开发 Java 应用程序时，我经常重写 Object 方法（通常是 equals 和 hashCode）。我想要一些方法来系统地检查我是否遵守我的每个类的 Object 方法的合同。例如，我想要断言对于相等的对象，哈希码也相等的测试。我正在使用 JUnit 测试框架，所以最好我想要一些 JUnit 解决方案，我可以在其中自动生成这些测试，或者一些可以以某种方式访问​​我的所有类并确保合同得到遵守的测试用例。

我正在使用 JDK6 和 JUnit 4.4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T12:08:58.700

```
    公共静态无效checkObjectIdentity（对象a1，对象a2，对象b1）{
        断言等于（a1，a2）；
        断言等于（a2，a1）；
        assertNotSame(a1, a2);
        assertEquals(a1.hashCode(), a2.hashCode());
        断言假（a1.equals（b1））；
        断言假（a2.equals（b1））；
        断言假（b1.equals（a1））；
        断言假（b1.equals（a2））；
    }

```

用法：

```
        checkObjectIdentity（新整数（3），新整数（3），新整数（4））；

```

想不出更好的了。发现错误时添加对 checkObjectIdentity 的新调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T04:18:15.183

只是对这个问题的一些初步想法（这可以解释为什么整整一个小时后仍然没有答案！？；）

在实施该问题的解决方案时，似乎有两个部分：

1/检索我自己的每一个类。很简单，你给一个 jar 名称，Junit 测试初始化​​方法会：

*   检查该 jar 是否在 JUnit 执行类路径中
*   读取并加载其中的每个类
*   只记住那些已经声明和重新定义了 equals() 和 hash() 的（通过反射）

2/ 测试每一个对象
......这就是问题所在：您必须**实例化**这些对象，即创建两个实例，并将它们用于 equals() 测试。

这意味着如果你的构造函数被接受参数，你必须考虑，

*   对于原始类型参数（int、boolean、float、...）或字符串，限制值的每个组合（对于字符串，"xxx"、""、null；fonr int、0、-x、+x、-Integer .MIN, +Integer.MAX, ... 等等）
*   对于非原始类型，构建要传递给要测试的对象的构造函数的实例（这意味着您必须递归地考虑该参数的构造函数参数：是否为原始类型）

最后，并非为这些构造函数自动创建的每个参数都以功能方式有意义，这意味着其中一些值将无法构建实例，因为必须检测到 Assert:。

然而这似乎是可能的（如果你愿意，你可以把它变成一个**[代码挑战](https://stackoverflow.com/questions/172184/are-you-elite-coder-enough-to-take-a-code-challenge)**），但我想首先让其他 StackOverflow 读者回应这个问题，因为他们可能会看到一个比我更简单的解决方案。

* * *

为了避免组合问题并使测试***相关***的测试值接近实际代码本身，我建议定义一个专用注释，其中一个字符串代表构造函数的有效值。将位于您的一个对象的 equals() 覆盖方法的正上方。

然后将读取这些注释值，并组合从这些注释值创建的实例以测试 equals()。这将使[组合的数量](http://en.wikipedia.org/wiki/Combination)保持足够低

侧节点：一个通用的 JUnit 测试用例当然会检查，对于每个 equals() 测试，有：

*   如上所述的一些注释（除非只有默认构造函数可用）
*   相应的 hash() 方法也被覆盖（如果没有，如果会抛出一个断言异常并在该类上失败）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T06:02:21.727

这个问题没有“简单”的解决方案，除非你对你的类施加了严格的限制。

例如，如果您为给定类使用多个构造函数，如何确保在 equals/hash 方法中充分考虑所有参数？默认值怎么样？不幸的是，这些东西不能盲目地自动化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T15:41:27.820

也许我误解了这个问题（并且过于 CS），但听起来你所描述的问题在一般情况下是不可判定的。

换句话说，单元测试可以确保覆盖方法在所有输入上的工作方式与覆盖方法相同的唯一方法是在所有输入上进行尝试。在 equals 的情况下，这将意味着所有对象状态。

我不确定当前的任何测试框架是否会自动为您缩减和抽象可能性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T05:59:57.223

一个老问题的新答案，但在 2011 年 5 月[Guava](https://code.google.com/p/guava-libraries/)（以前的 Google Collections）发布了一个删除了很多样板的类，称为[`EqualsTester`](https://code.google.com/p/guava-libraries/source/browse/guava-testlib/src/com/google/common/testing/EqualsTester.java). 您仍然必须创建自己的实例，但它负责将每个对象与自身、null、平等组中的每个对象、每个其他平等组中的每个对象以及不应匹配的秘密实例进行比较。它还检查所有这些组合的`a.equals(b)`含义。`a.hashCode() == b.hashCode()`

来自 Javadoc 的示例：

```
new EqualsTester()
   .addEqualityGroup("hello", "h" + "ello")
   .addEqualityGroup("world", "wor" + "ld")
   .addEqualityGroup(2, 1 + 1)
   .testEquals(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T14:55:51.170

[这里的社区帖子，不涉及业力；）]

这是另一个**[代码挑战](https://stackoverflow.com/questions/172184/are-you-elite-coder-enough-to-take-a-code-challenge)**：

***一个***java 类，实现了一个 JUnit 测试用例，具有一个能够自行启动 JUnit 的 main 方法！

该课程还将：

*   覆盖 hash() 和 equals()
*   定义一些属性（带有原始类型）
*   定义一个默认构造函数，但也定义了一些具有各种参数组合的构造函数
*   定义一个能够枚举“有趣”值以传递给那些构造函数的注释
*   用那些“有趣”的值注释 equals()

测试方法接受一个类名参数（这里：它将是它自己），检查具有该名称的类是否有一个带有“有趣值”注释的 equals() 覆盖方法。
如果是这样，它将根据注释构建（自身）适当的实例，并测试 equals()

这是一个自包含的测试类，它定义了一种机制，该机制能够推广到任何具有带注释的覆盖 equals() 函数的类。

请使用JDK6和JUnit4.4

该类应该被复制粘贴到一个空的java项目的适当包中......然后运行;）

* * *

为了增加一些想法，回应尼古拉斯（见评论）：

*   是的，测试所需的数据在要测试的类候选中（即，一个覆盖等于并帮助任何“自动测试器”构建适当实例的数据）
*   我不认为这*完全*是“测试逻辑”，而是对应该做的事情的有用评论（顺便说一下，作为上述测试人员要利用的数据；））

代表潜在测试数据的注释应该永远不会出现在课堂上吗？......嘿，这可能是一个很好的问题：）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-19T15:08:45.040

我有一个第一个粗略的实现，在这里只使用原始参数使用 Constructor 进行 equals 测试。只需将它复制粘贴到 test.MyClass.java 文件中并运行它。

警告：1720 行代码（findbugs 中的 0 个错误，“修改”检查样式中的 0 个错误，所有函数的圈复杂度低于 10）。

查看所有代码：[Auto-test for equals function in java classes through annotations](http://snippets.dzone.com/posts/show/6288)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T04:27:43.243

我认为 VonC 走在正确的轨道上，但我什至会满足于一些不太复杂的东西，例如接受 .class 对象（正在测试 Object 方法）的参数化测试，然后是可变数量的构造函数参数。然后，您必须使用反射来找到与传入参数的类型匹配的构造函数，并调用构造函数。此测试将假定传递给它的参数将创建对象的有效实例。

这个解决方案的缺点是你必须用这个测试类“注册”你想要测试的每个类，并且你必须确保向构造函数提供有效的输入，这并不总是容易的。有鉴于此，我对这是否比手动编写每个类的所有测试更多或更少的工作持怀疑态度。

如果您认为这可行，请投票...如果您希望我将其更多地刷新，请发表评论（如果事实证明这是一个可行的解决方案，我可能还是会这样做）

# python - 守护线程解释

> ID：190010
> 
> 赞同：273
> 
> 时间：2008-10-10T03:24:07.490
> 
> 标签：python, multithreading, daemon, python-multithreading

在[Python 文档](https://docs.python.org/2/library/threading.html#thread-objects) 中它说：

> 可以将线程标记为“守护线程”。这个标志的意义在于，当只剩下守护线程时，整个 Python 程序就退出了。初始值继承自创建线程。

有没有人对这意味着什么有更清晰的解释，或者有一个实际示例显示您将线程设置为的位置`daemonic`？

为我澄清一下：所以你不会将线程设置为的唯一情况`daemonic`是，当你希望它们在主线程退出后继续运行时？

* * *

## 回答 #1

> 赞同：509
> 
> 时间：2008-10-10T03:27:36.143

一些线程执行后台任务，例如发送保活数据包，或执行定期垃圾收集等。这些仅在主程序运行时才有用，一旦其他非守护程序线程退出，就可以将它们杀死。

如果没有守护线程，您必须跟踪它们并告诉它们退出，然后您的程序才能完全退出。通过将它们设置为守护线程，您可以让它们运行并忘记它们，并且当您的程序退出时，所有守护线程都会自动终止。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-10-10T03:36:16.703

假设您正在制作某种仪表板小部件。作为其中的一部分，您希望它在您的邮箱中显示未读邮件计数。所以你做了一个小线程，它将：

1.  连接到邮件服务器并询问您有多少未读邮件。
2.  用更新后的计数向 GUI 发出信号。
3.  睡一会儿。

当您的小部件启动时，它会创建此线程，将其指定为守护进程，然后启动它。因为它是一个守护进程，所以你不必考虑它；当您的小部件退出时，线程将自动停止。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-24T22:55:10.797

其他海报给出了一些使用守护线程的例子。但是，我的建议是永远不要使用它们。

这不是因为它们没有用，而是因为如果你使用它们，你会遇到一些不好的副作用。在 Python 运行时开始拆除主线程中的东西后，守护线程仍然可以执行，从而导致一些非常奇怪的异常。

更多信息在这里：

[https://joeshaw.org/python-daemon-threads-considered-harmful/](https://joeshaw.org/python-daemon-threads-considered-harmful/)

[https://mail.python.org/pipermail/python-list/2005-February/343697.html](https://mail.python.org/pipermail/python-list/2005-February/343699.html)

严格来说，您永远不需要它们，它只是在某些情况下使实施更容易。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-10-10T04:34:28.660

一种更简单的思考方式可能是：当 main 返回时，如果非守护线程仍在运行，您的进程将不会退出。

一点建议：当涉及线程和同步时，干净关闭很容易出错 - 如果可以避免，请这样做。尽可能使用守护线程。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-08-27T14:40:41.883

Chris 已经解释了守护线程是什么，那么让我们来谈谈实际使用。许多线程池实现为任务工作者使用守护线程。工作者是从任务队列执行任务的线程。

Worker 需要无限期地等待任务队列中的任务，因为他们不知道新任务何时会出现。分配任务的线程（比如主线程）只知道任务何时结束。主线程等待任务队列变空然后退出。如果工人是用户线程，即非守护程序，程序将不会终止。它将继续等待这些无限期运行的工人，即使工人没有做任何有用的事情。标记工人守护线程，主线程将在完成处理任务后立即杀死它们。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-08-12T18:14:15.263

引用 Chris：“......当你的程序退出时，任何守护线程都会自动终止。”。我想总结一下。使用它们时应该小心，因为它们会在主程序执行完成时突然终止。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2018-07-14T14:27:59.200

当您的第二个线程是非守护程序时，您的应用程序的主主线程无法退出，因为它的退出标准也与非守护程序线程的退出相关联。线程不能在 python 中被强行杀死，因此您的应用程序将不得不真正等待非守护线程退出。如果这种行为不是你想要的，那么将你的第二个线程设置为守护进程，这样它就不会阻止你的应用程序退出。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2021-07-28T07:36:26.467

我还将在这里添加我的一些内容，我认为守护线程让大多数人感到困惑的部分原因（至少对我来说是这样）并且不太清楚理解是这个词的含义`dameon`。

我的unix术语`daemon`是指在后台产生并保持运行的进程，用户可以通过前台进程继续处理其他内容。

在 Python 线程上下文中，创建时的每个线程都在后台运行，无论是`daemon`还是`non-daemon`，不同之处在于这些线程如何影响主线程。当你有一个`non-daemon`线程时，你的主线程将不会退出，直到所有这些`non-daemon`线程都完成了它们的执行，所以在某种程度上你的主线程被阻塞了。

对于`daemon`线程，它们仍然在后台运行，但有一个关键区别是它们不会阻塞主线程，并且一旦主线程完成并退出，所有`daemon`线程都将被回收。这使得它们对于您想要异步执行的操作很有用，但是一旦主应用程序退出，这些操作也应该退出。

需要注意的一点是，你应该知道你在`daemon`线程中到底在做什么，当主线程退出时它们退出的事实会给你带来意想不到的惊喜。

对线程感到困惑的另一件事`daemon`是 python 文档中的定义。

> 这个标志的意义在于当只剩下守护线程时整个Python程序退出

简而言之，这意味着如果您的程序同时具有线程`daemon`和`non-daemon`线程，则主程序将被阻塞并等待所有`non-daemon`线程退出，一旦它们退出，主线程也将退出。该语句还暗示但乍一看并不清楚的是，`daemon`一旦主线程退出，所有线程将自动退出。

# c# - 以编程方式将 IIS 主机标头添加到网站

> ID：190043
> 
> 赞同：5
> 
> 时间：2008-10-10T03:41:26.800
> 
> 标签：c#, asp.net, iis, hostheader

我想设置一个管理页面（ASP.NET/C#），可以将 IIS 主机头添加到托管管理页面的网站。这可能吗？

我不想添加 http 标头 - 我想模仿手动进入 IIS 的操作，调出网站的属性，在网站选项卡上单击高级，然后在高级网站识别屏幕和新的“身份”中使用主机头值、IP 地址和 tcp 端口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T06:09:53.053

[这是一个关于以编程方式向站点添加另一个身份](http://forums.iis.net/t/1147522.aspx)的论坛RSS

另外，这里有一篇关于如何[在 IIS 中通过代码附加主机标头](https://web.archive.org/web/20090210085202/http://www.gafvert.info/notes/csharp_add_host_header.htm)的文章：

> 以下示例将主机标头添加到 IIS 中的网站。这涉及更改 ServerBindings 属性。没有可用于将新的服务器绑定附加到此属性的 Append 方法，因此需要做的是读取整个属性，然后将其与新数据一起再次添加回来。这是在下面的代码中完成的。ServerBindings 属性的数据类型为 MULTISZ，字符串格式为 IP:Port:Hostname。
> 
> 请注意，此示例代码不进行任何错误检查。重要的是，每个 ServerBindings 条目都是唯一的，而您（程序员）负责检查这一点（这意味着您需要遍历所有条目并检查要添加的内容是否是唯一的）。

```
using System.DirectoryServices;
using System;

public class IISAdmin
{
    /// <summary>
    /// Adds a host header value to a specified website. WARNING: NO ERROR CHECKING IS PERFORMED IN THIS EXAMPLE. 
    /// YOU ARE RESPONSIBLE FOR THAT EVERY ENTRY IS UNIQUE
    /// </summary>
    /// <param name="hostHeader">The host header. Must be in the form IP:Port:Hostname </param>
    /// <param name="websiteID">The ID of the website the host header should be added to </param>
    public static void AddHostHeader(string hostHeader, string websiteID)
    {

        DirectoryEntry site = new DirectoryEntry("IIS://localhost/w3svc/" + websiteID );
        try
        {                        
            //Get everything currently in the serverbindings propery. 
            PropertyValueCollection serverBindings = site.Properties["ServerBindings"];

            //Add the new binding
            serverBindings.Add(hostHeader);

            //Create an object array and copy the content to this array
            Object [] newList = new Object[serverBindings.Count];
            serverBindings.CopyTo(newList, 0);

            //Write to metabase
            site.Properties["ServerBindings"].Value = newList;            

            //Commit the changes
            site.CommitChanges();

        }
        catch (Exception e)
        {
            Console.WriteLine(e);
        }

    }
}

public class TestApp
{
    public static void Main(string[] args)
    {
        IISAdmin.AddHostHeader(":80:test.com", "1");
    }
} 
```

但我不确定如何遍历标头值来进行提到的错误检查。

# c# - 在 C# 中用较小的数组复制/填充大数组的最佳方法是什么？

> ID：190045
> 
> 赞同：2
> 
> 时间：2008-10-10T03:42:52.603
> 
> 标签：c#, arrays, .net-2.0

我有一个大的 int[] 数组和一个小得多的 int[] 数组。我想用小数组中的值填充大数组，方法是重复将小数组复制到大数组中直到它填满（这样 large[0] = large[13] = large[26] ... =小[0]等）。我已经有一个简单的方法：

```
int iSource = 0;
for (int i = 0; i < destArray.Length; i++)
{
    if (iSource >= sourceArray.Length)
    {
        iSource = 0; // reset if at end of source
    }
    destArray[i] = sourceArray[iSource++];
} 
```

但我需要更优雅的东西，希望更快。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T03:46:09.960

`Array.Copy()`使用重载让您的循环工作，该重载允许您从一个数组复制到目标数组中的特定索引。

```
if (sourceArray.Length == 0) return; // don't get caught in infinite loop

int idx = 0;

while ((idx + sourceArray.Length) < destArray.Length) {
    Array.Copy( sourceArray, 0, destArray, idx, sourceArray.Length);

    idx += sourceArray.Length;
}

Array.Copy( sourceArray, 0, destArray, idx, destArray.Length - idx); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T03:48:44.773

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Temp
{
    class Program
    {
        static void Main(string[] args)
        {
            int[] array = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11};
            int[] array2 = new int[213];

            for (int i = 0; i < array2.Length; i += array.Length)
            {
                int length = array.Length;
                if ((i + array.Length) >= array2.Length)
                    length = array2.Length - i;
                Array.Copy(array, 0, array2, i, length);
            }

            int count = 0;
            foreach (int i in array2)
            {
                Console.Write(i.ToString() + " " + (count++).ToString() + "\n");
            }

            Console.Read();
        }
    }
} 
```

:)

*编辑* 发现错误，如果它们不能被彼此分割，它会崩溃。现在修复:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T14:51:27.970

有趣的是，使用提供的源数组，获胜的答案是最慢的！

我要提出的解决方案是

```
for (int i = 0; i < destArray.Length; i++)
{
    destArray[i] = sourceArray[i%sourceArray.Length];
} 
```

但是当我使用回答问题中的输入测试超过 100000 次迭代的性能时，它的性能比提问者循环差。

这是我的小测试应用程序的输出

```
数组复制 164 毫秒（Nelson LaQuet 的代码）
分配副本 77ms（MusiGenesis 代码）
分配 mod 副本 161ms（headsling 的代码）

```

# sql - 按唯一字段搜索时使用 LIMIT

> ID：190049
> 
> 赞同：2
> 
> 时间：2008-10-10T03:44:15.330
> 
> 标签：sql, indexing

给定这样的表结构：

```
CREATE TABLE `user` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `name` varchar(32) NOT NULL,
  `username` varchar(16) NOT NULL,
  `password` char(32) NOT NULL,
  PRIMARY KEY  (`id`),
  UNIQUE KEY `username` (`username`)
); 
```

通过用户名搜索时使用 LIMIT 关键字有什么用，还是数据库足够聪明，知道可能只有一个结果，因此一旦找到就停止搜索？

```
SELECT * FROM `user` WHERE `username` = 'nick';

-- vs --

SELECT * FROM `user` WHERE `username` = 'nick' LIMIT 1; 
```

* * *

*更新：*感谢您的回答，他们一直很有启发性。看起来，即使没有必要，`LIMIT 1`进行查询也不会受到伤害，并且可能会增加可读性（您不必查看数据库模式就知道只会返回一个）。特别为 JR 的回答大喊大叫——我什至不知道你可以用索引来做到这一点。

另外，我在[这里](https://stackoverflow.com/questions/34488/does-limiting-a-query-to-one-record-improve-performance)找到了一个类似的问题，这也可能有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T03:57:50.030

没有必要使用 LIMIT。

但是...如果您的表上有一个 HUGE HUGE HUGE 基数（并且您担心速度），您可能会考虑不在数据库中使用特殊的 UNIQUE 约束并从您的应用程序中对其进行管理。然后，您可以仅在用户名字段的前几个字符上指定一个索引。这将大大减少索引的大小，确保整个索引都适合 RAM，并可能加快查询速度。

所以，你可以试试：

```
CREATE TABLE `user` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `name` varchar(32) NOT NULL,
  `username` varchar(16) NOT NULL,
  `password` char(32) NOT NULL,
  PRIMARY KEY  (`id`),
  KEY `username` (`username`(4))
); 
```

如果您的第一次尝试太慢，作为替代方案。这意味着，当然，您必须在插入之前检查重复的用户名，但无论如何您可能都必须这样做以告诉用户他们必须选择另一个用户名。

根据您使用的数据库服务器和引擎，为所有字符串指定固定宽度字段也可能更快。而不是*varchar*，使用*char*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T03:55:25.137

我一直被告知并阅读过，`LIMIT`每次您只需要 1 个结果时，您都应该包括在内。这只是告诉数据库无论如何它都应该停止。在您的情况下，您可能是对的，这并没有什么不同，但我认为总是做总比总是在需要时决定并忽略它要好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T03:50:30.230

sql 查询优化器应该足够聪明来解决这个问题。

# ruby-on-rails - 如何根据控制器名称查询模型

> ID：190054
> 
> 赞同：1
> 
> 时间：2008-10-10T03:45:54.653
> 
> 标签：ruby-on-rails, ruby

我一直在重构我的模型和控制器，以消除代码重复，到目前为止，它似乎都是桃子般的奶油。目前我有一些我的两个控制器共有的代码，如下所示：

```
def process_filters
# Filter hash we're going to pass to the model
  filter_to_use = {}

  # To process filters, we first query the model to find out what filters
  # we should be looking for, as the model knows what we can filter.
  Iso.available_filters.each do |filter|
    # We should have our array with our filter listing.
    # Check the purchase order model for a description
    filter_name = filter[0][:filter_name]

    # Filters are stored in a session variable, this way filters survive
    # page reloads, etc.  First thing we do, is set the session if new filters
    # have been set for the filter.
    session_name = session_filter_name( filter_name )
    if params[session_name]
      if params[session_name] == 'All'
        session[session_name] = nil
      else
        session[session_name] = params[session_name]
        filter_to_use[filter_name] = params[session_name]
      end
    elsif session[session_name]
      # If params aren't read, we still need to filter based off the users
      # session
      filter_to_use[filter_name] = session[session_name]
    end
  end

  # Just using this variable for now until I can refactor the helper code
  # so that this is passed in.
  @current_filter_values = filter_to_use

  filter_to_use[:page] = @current_page

  @isos = Iso.find_filtered( filter_to_use )

  if @isos.out_of_bounds?
    filter_to_use[:page] = session[:previous_page] = @current_page = 1
    @isos = Iso.find_filtered( filter_to_use )
  end
end 
```

现在此代码与另一个控制器中的代码完全相同，除了模型引用（在本例中为 Iso）。有什么方法可以使该模型参考动态化吗？

基本上我想将 Iso 引用（包括 @iso 变量）替换为基于 controller.controller_name 或类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T04:20:53.413

您可以将此代码移动到模块中，将此模块混入您需要的所有控制器中，并在模块中使用 self.class 变量来确定具体的控制器名称。使用此名称，您可以使用标准字符串函数（例如大写）和 Kernel.const_get 函数通过名称获取类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T05:52:39.470

好的，这就是我的结果。我绝不是 Ruby/Rails 大师，但它对我有用，所以如果他们尝试类似的东西，希望它可以为某人指明正确的方向：

```
module Filtered
  module Controller
    module InstanceMethods
      def process_filters
        # Filter hash we're going to pass to the model
        filter_to_use = {}

        # To process filters, we first query the model to find out what filters
        # we should be looking for, as the model knows what we can filter.
        Kernel.const_get( 
          self.controller_name.singularize.camelize ).available_filters.each do |filter|
          # We should have our array with our filter listing.
          # Check the purchase order model for a description
          filter_name = filter[0][:filter_name]

          # Filters are stored in a session variable, this way filters survive
          # page reloads, etc.  First thing we do, is set the session if new filters
          # have been set for the filter.
          session_name = session_filter_name( filter_name )
          if params[session_name]
            if params[session_name] == 'All'
              session[session_name] = nil
            else
              session[session_name] = params[session_name]
              filter_to_use[filter_name] = params[session_name]
            end
          elsif session[session_name]
            # If params aren't read, we still need to filter based off the users
            # session
            filter_to_use[filter_name] = session[session_name]
          end
        end

        # Just using this variable for now until I can refactor the helper code
        # so that this is passed in.
        self.instance_variable_set( '@current_filter_values', filter_to_use )

        filter_to_use[:page] = self.instance_variable_get( '@current_page' )

        self.instance_variable_set( "@#{self.controller_name}",
          Kernel.const_get( self.controller_name.singularize.camelize ).find_filtered(
            filter_to_use ) )

        if self.instance_variable_get( "@#{self.controller_name}" ).out_of_bounds?
          filter_to_use[:page] = session[:previous_page] = 1
          self.instance_variable_set( "@#{self.controller_name}",
            Kernel.const_get( self.controller_name.singularize.camelize ).find_filtered(
              filter_to_use ) )
        end
      end

      private

      # Quick helper function for generating session variable names
      def session_filter_name( name )
        "#{self.controller_name}_#{name}_filter".to_sym
      end

    end
  end
end 
```

我通过一个插件将它包含在我的所有控制器中，init.rb 文件如下所示：

```
# Include hook for controllers
ActionController::Base.class_eval do
  include Filtered::Controller::InstanceMethods
end 
```

# c++ - 在没有运行时的情况下构建 Windows C++ 库？

> ID：190059
> 
> 赞同：4
> 
> 时间：2008-10-10T03:46:31.953
> 
> 标签：c++, visual-c++, runtime

我正在尝试创建一个用于 windows/MSVC 的 c++ 库。

我的问题是，似乎为了正确链接，我需要分发一堆不同的版本，链接到不同版本的 MSVC 的 c++ 运行时——单线程和多线程、调试和发布、不同的编译器版本、各种其他安全性和其他选项。

我很想分发两个，32 位和 64 位。

我的想法是为我的所有 STL 类型使用不同的 new 运算符（例如 mynew）和自定义分配器。创建库时，/nodefaultlib。然后，当从父项目链接时，要求他们将 mynew 转换为 new，并将我的 stl 分配器转换为标准分配器（或他们选择的一个）。我想我需要做删除和其他一些功能。当然，我会提供一个带有库的示例 thunking 实现，但这有望为每个人省去很多麻烦。

这可能吗？有没有人试过这个？是否有在 windows/MSVC 上创建/分发库的最佳实践？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T04:50:15.367

作为一般答案，您需要静态链接。

快速说明克里斯的回答（不想降低因为它大多是好的，但是......）：

不要链接到 msvcrt.dll（未版本化的）；这是特定于操作系统的版本 DLL，如果您链​​接到它，您的应用程序可能无法在其他版本的 Windows 上运行。据我所知，您应该始终链接到 msvcrt##.dll。DDK 可能包含它的库，但除非您真的知道自己在做什么，否则不要链接到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T04:43:16.380

静态链接到 C++ 运行时库：

1.  打开项目属性。
2.  转到配置属性 | C/C++ | 代码生成部分。
3.  将运行时库设置为多线程 (/MT)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T03:54:14.780

如果您使用 C++，则不需要使用自定义分配器，并且将所有分配包装起来`std::tr1::shared_ptr`（您可以在其中指定解除分配函数）。这确保了即使客户端释放了对共享指针的最后一个引用，当要释放对象时，它仍然是库（或库的 CRT）中的代码。

这是解决“DLL 边界地狱”的一种方法。希望能帮助到你！:-)

编辑：我想我误解了你问题的意图。与其因为担心 DLL 边界地狱而不希望对 CRT 有任何依赖，我想您只是想要一个可以在任何地方安装的 DLL 版本。在这种情况下，您可以将您的程序链接到`msvcrt.dll`. 这在任何 Windows 系统上都可用。

您没有听到我的消息，但显然在驱动程序开发工具包中您可以找到某种导入库，允许较新版本的 Visual Studio 链接到`msvcrt`.

# entity-framework - 在 ADO.Net 数据服务中使用 .SaveChanges() 方法的最佳方式是什么？

> ID：190066
> 
> 赞同：8
> 
> 时间：2008-10-10T03:49:53.273
> 
> 标签：entity-framework, wcf-data-services, savechanges

有人对 .SaveChanges() 方法的使用有一些好的信息吗？

尝试在我的数据上下文对象上使用 .SaveChanges() 方法时遇到了各种问题。我从现有数据源获取数据，创建适当的 EntityFramework/DataService 对象，用数据填充这些创建的对象，将这些对象添加到上下文中，然后通过调用 .SaveChanges 保存该数据。

我想出的场景（以及与之相关的问题）就是这样......在每个场景中，我都有一个 foreach 循环，它从 DataTable 中的行获取数据并生成对象，将它们附加到上下文中他们去。（注意：通过 SetLink 调用附加的三个对象一个“成员”和两个“地址”） - 基本上，这是一种转换工具，用于从一个数据存储中获取数据并将其按摩到数据服务公开的数据存储中。

*   在 foreach 循环结束时（即循环外）调用一次不带任何参数的 .SaveChanges()
    *   OutOfMemory 错误大约 1/3 的方式（90,000 次保存中的 30,000 次） - 不确定这是如何发生的，尽管每个保存项都是对数据库的单独 SQL 调用，内存不足是什么？
*   每个循环调用一次不带任何参数的 .SaveChanges()
    *   这有效，但绝对需要永远（90,000 次保存需要 8 小时）
*   在 foreach 循环结束时调用 .SaveChanges(SaveChangesOption.Batch) 一次
    *   同样的 OutOfMemory 错误，但没有任何保存到数据库
*   每个循环调用一次 .SaveChanges(SaveChangesOption.Batch)
    *   404 未找到错误
*   每 10 个循环调用一次 .SaveChanges(SaveChangesOption.Batch)
    *   400 Bad Request 错误（偶尔）
    *   多次迭代后 OutOfMemory
*   每次循环创建上下文一次的随机尝试次数，或者将其作为循环开始时的变量，或者将其作为可用的私有成员变量。
    *   不同的结果，无法量化，没有一个真的那么好

在进行这样的大数据加载时，从客户端对象调用 .SaveChanges() 的首选方法是什么？关于 .SaveChanges() 的工作原理，我有什么不明白的吗？谁能提供更多详细信息，说明应如何使用此功能以及通过数据服务保存数据的限制（如果有）是什么？.SaveChanges() 方法调用是否有任何最佳实践？.SaveChanges() 方法调用是否有任何特别好的文档？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T15:09:01.740

我没有使用 EntityFramework 的丰富经验（只是一些随机实验），您是否尝试过每 n 次迭代调用 .SaveChanges() ？

我的意思是这样的：

```
int i = 0;
foreach (var item in collection)
{
    // do something with your data
    if ((i++ % 10) == 0)
        context.SaveChanges();
}
context.SaveChanges(); 
```

我知道这很丑，但这是我想出的第一个可能的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T14:10:46.263

我也在一个小项目上使用 EntityFramework，所以我对这个问题也很感兴趣。两个快速的问题：您是否尝试过关闭数据上下文中的数据对象的缓存？您是否尝试关闭数据上下文并在循环期间创建一个新的以释放内存？

问候

肯尼斯

# c# - XML 数据绑定与命名空间

> ID：190102
> 
> 赞同：3
> 
> 时间：2008-10-10T04:15:50.540
> 
> 标签：c#, wpf, xml, data-binding, namespaces

我想使用 XML 文档的数据绑定来填充一个简单的表单，该表单显示有关人员列表的详细信息。我现在已经完成了所有设置和工作：

```
<Window x:Class="DataBindingSample.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1">
<Window.Resources>
    <XmlDataProvider x:Key="xmlProvider" XPath="People" Source="c:\someuri.xml"/>
</Window.Resources>
<Grid>        
    <ListBox Name="personList" ItemsSource="{Binding Source={StaticResource xmlProvider}, XPath=Person}">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding XPath=Name}" />
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>

    <GroupBox Header="GroupBox" Name="groupBox1" DataContext="{Binding ElementName=personList, Path=SelectedItem}">
        <Grid>
            <TextBox Name="nameText" Text="{Binding XPath=Name}"/>
            <ComboBox Name="genderCombo" Text="{Binding XPath=Gender}">
                <ComboBoxItem>Male</ComboBoxItem>
                <ComboBoxItem>Female</ComboBoxItem>
            </ComboBox>
        </Grid>
    </GroupBox>
</Grid>
</Window> 
```

（为清楚起见，所有位置/布局元素已被删除）

现在这很好用！如果我为它提供一些与提供的路径匹配的 XML，我会在列表框中获得一个名称列表，单击时在相应字段中显示名称和性别。当我开始尝试在我的 XML 源中使用命名空间时，问题就出现了。XAML 然后更改为如下所示：

```
<Window x:Class="DataBindingSample.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1">
<Window.Resources>
    <XmlNamespaceMappingCollection x:Key="namespaceMappings">
        <XmlNamespaceMapping Uri="http://www.mynamespace.com" Prefix="mns"/>
    </XmlNamespaceMappingCollection>
    <XmlDataProvider x:Key="xmlProvider" XmlNamespaceManager="{StaticResource namespaceMappings}" XPath="mns:People" Source="c:\someuriwithnamespaces.xml"/>
</Window.Resources>
<Grid>        
    <ListBox Name="personList" ItemsSource="{Binding Source={StaticResource xmlProvider}, XPath=mns:Person}">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding XPath=mns:Name}" />
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>

    <GroupBox Header="GroupBox" Name="groupBox1" DataContext="{Binding ElementName=personList, Path=SelectedItem}">
        <Grid>
            <TextBox Name="nameText" Text="{Binding XPath=mns:Name}"/>
            <ComboBox Name="genderCombo" Text="{Binding XPath=mns:Gender}">
                <ComboBoxItem>Male</ComboBoxItem>
                <ComboBoxItem>Female</ComboBoxItem>
            </ComboBox>
        </Grid>
    </GroupBox>
</Grid>
</Window> 
```

使用此代码（当然还有适当命名空间的 xml），列表框仍能正确显示名称，但单击这些名称不再更新名称和性别字段！我的怀疑是 xml 命名空间以某种方式对 groupbox 的 DataContext 做出了不利的反应，但我不确定为什么或如何。有谁知道如何在这种情况下使用 XML 命名空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T23:20:58.527

我还在MSDN WPF 表单上[问过这个问题。](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/cb6b22e7-3a48-425b-bbad-2575d2618968/)Marco Zhou 用这个回答了我，这最终是我想要的答案。我在这里复制了它，以使任何寻求相同答案的人受益：

> 这有效：
> 
> ```
>  <XmlDataProvider x:Key="dataProvider"
>                      XmlNamespaceManager="{StaticResource namespaceMappings}"
>                      XPath="p:players/p:player">
>         <x:XData>
>             <p:players xmlns:p="http://www.footballism.com/2005/SoccerPlayers">
>                 <p:player>
>                     <p:fullName>Sebastian Batistuta</p:fullName>
>                     <p:age>26</p:age>
>                 </p:player>
>                 <p:player>
>                     <p:fullName>Andriey Shevchenko</p:fullName>
>                     <p:age>30</p:age>
>                 </p:player>
>                 <p:player>
>                     <p:fullName>Paviel Nedved</p:fullName>
>                     <p:age>21</p:age>
>                 </p:player>
>                 <p:player>
>                     <p:fullName>David Beckham</p:fullName>
>                     <p:age>19</p:age>
>                 </p:player>
>             </p:players>
>         </x:XData>
>     </XmlDataProvider>
> </Page.Resources>
> <StackPanel>
>     <TextBlock
>         Text="{Binding XPath=p:fullName}"
>         FontWeight="Bold"
>         Binding.XmlNamespaceManager="{StaticResource namespaceMappings}"
>         DataContext="{Binding ElementName=listBox, Path=SelectedItem}"/>
>     <ListBox ItemsSource="{Binding Source={StaticResource dataProvider}}"
>              x:Name="listBox"
>              DisplayMemberPath="p:fullName">
>     </ListBox>
> </StackPanel> </Page> 
> ```
> 
> 我想在查看代码之后，您应该能够理解为什么在为 TextBlock 指定 Binding.XmlNamespaceManager 附加属性后它会起作用。
> 
> ListBox 是绑定到具有 xml 命名空间映射信息的数据提供程序的数据，但 TextBlock 上的绑定没有此信息，这就是它失败的原因。
> 
> 实际上，在做主从数据绑定时，更合适的做法是：
> 
> ```
>  <XmlDataProvider x:Key="dataProvider"
>                      XmlNamespaceManager="{StaticResource namespaceMappings}"
>                      XPath="p:players/p:player">
>         <x:XData>
>             <p:players xmlns:p="http://www.footballism.com/2005/SoccerPlayers">
>                 <p:player>
>                     <p:fullName>Sebastian Batistuta</p:fullName>
>                     <p:age>26</p:age>
>                 </p:player>
>                 <p:player>
>                     <p:fullName>Andriey Shevchenko</p:fullName>
>                     <p:age>30</p:age>
>                 </p:player>
>                 <p:player>
>                     <p:fullName>Paviel Nedved</p:fullName>
>                     <p:age>21</p:age>
>                 </p:player>
>                 <p:player>
>                     <p:fullName>David Beckham</p:fullName>
>                     <p:age>19</p:age>
>                 </p:player>
>             </p:players>
>         </x:XData>
>     </XmlDataProvider>
> </Page.Resources>
> <StackPanel DataContext="{Binding Source={StaticResource dataProvider}}">
>     <TextBlock
>         Text="{Binding XPath=p:fullName}"
>         FontWeight="Bold"/>
>     <ListBox ItemsSource="{Binding}"
>              x:Name="listBox"
>              DisplayMemberPath="p:fullName"
>              IsSynchronizedWithCurrentItem="True">
>     </ListBox>
> </StackPanel> </Page> 
> ```
> 
> 希望这能澄清一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T14:08:30.423

您可以在 XPath 查询中使用本地名称，如下所示：

```
 <TextBox Name="nameText">
    <TextBox.Text>
       <Binding XPath="*[local-name()='Name']" />
    </TextBox.Text>
 </TextBox> 
```

# php - 为什么不发布这些结果？

> ID：190108
> 
> 赞同：0
> 
> 时间：2008-10-10T04:17:37.743
> 
> 标签：php, mysql, html

处理后，我无法从表单中获取值。我需要你的帮助。

```
function updateUser($table, $id) {
    if($_POST) {
        processUpdate($table, $id);
    } else {
        updateForm($table, $id);
    }
}

function processUpdate($table, $id) {

    print $table; //testing
    print $id; //testing

    $email=addslashes($HTTP_POST_VARS['email']);
    $lname=addslashes($HTTP_POST_VARS['lname']);
    $fname=addslashes($HTTP_POST_VARS['fname']);

    print $lname;

    //which table do we update
    switch($table) {
        case "maillist":
            $result = mysql_query("UPDATE $table SET email='$email', lname='$lname', fname='$fname' WHERE id='$id'") 
            or die(mysql_error());
        break;
    }
} 
```

函数 updateForm($table, $id); 只输出表单，有 email、lname、fname 字段。当您处理表单时，操作是相同的，表格和 id 通过 URL 传递，因此它以这种方式获取 id 和表格，对于 lname、fname 和电子邮件，它应该通过 post 获取它.

编辑：这是 updateForm 函数的表单标签：`<form method="post" action="?mode=upd&id='.$id.'&table='.$table.'">`

但由于某种原因，它没有发布值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T04:25:18.740

表单的method属性是否设置为post？

```
<form method = "post" action = "..."> 
```

所有输入的名称属性设置正确吗？

您是否查看过 html 输出以确保没有语法错误？另外，尝试使用

`$_POST`

代替

`$HTTP_POST_VARS`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T06:37:12.267

请确保您使用最新版本的 PHP5 之一的最新教程。不是一些 PHP 3.x tut 充满了不推荐使用的功能 ;-)

这将使您（和我们）的生活更轻松：P

顺便说一句，还有一个技巧可以防止你在这个脚本中进行主要的 SQL 注入： **逃避你将要通过的每一个变量！**

你不要在这里逃避 ID，这是一个很好的删除数据库的大洞

# python - IDLE 不在 python 3.0 中启动

> ID：190115
> 
> 赞同：1
> 
> 时间：2008-10-10T04:19:19.160
> 
> 标签：python, python-3.x, python-idle

如果我没有连接到互联网，这是否意味着我无法启动**IDLE （** **python 3.0**附带）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T05:13:20.283

IDLE 显示有关防火墙程序的警告消息，因为它通过环回接口连接到解释器，但该接口始终是“连接的”并且不需要您在 Internet 上。

如果 IDLE 不适用于 Python 3.0，您可以参考[Python issue3628](http://bugs.python.org/issue3628)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T21:04:22.847

IDLE does not need to be connected to the internet.

Consult python support if you have problems: [Python help page](http://www.python.org/about/help/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-14T03:45:13.080

并不真地。您可以下载适用于您正在使用的任何操作系统的最新版本的 Python 3.x，并且您可以在没有任何互联网的情况下加载 IDLE。

# algorithm - 如何选择显示值的单位？

> ID：190122
> 
> 赞同：2
> 
> 时间：2008-10-10T04:27:22.060
> 
> 标签：algorithm, theory, heuristics, units-of-measurement

我有一个值，我知道它的单位是

> 米^(mn/md) * kg ^(kn/kd) * s ^(sn/sd) * K ^(Kn/Kd) * A ^(An/Ad)

注：指数为有理数，m ^(0.5)为单位有效

问题是如何选择如何将单位分解成更紧凑的东西

例如，如果

```
md=kd=sd=Kd=Ad=1
mn=Kn=An=0
kn=1
sn=-1 
```

我可以使用 N/m

我怀疑这是离散优化问题的某个子集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T04:58:17.223

将复杂度定义为符号的总数：1 的单位的复杂度为 1，任何其他整数幂为 2，分数幂为 3。尝试几个示例，看看感觉如何。也许您必须使用 1、2、3 以外的其他数字来表示复杂性。

尝试使用贪心算法进行优化：在每次迭代中，分解出尽可能简化的复合单元（可能是分数或负幂）（使目标函数尽可能小）。我有一种预感，贪婪会起作用，因为这些单位的设计是为了如果两个单位的乘积/比率比每个单位都简单，那么它将是一个独立的单位。

# c# - NHibernate 按问题排序

> ID：190125
> 
> 赞同：2
> 
> 时间：2008-10-10T04:29:19.403
> 
> 标签：c#, .net, sql, nhibernate

好的，所以我有一个返回对象的 nHibernate ICriteria。我想按单个属性排序，但不是 asc 或 desc 我希望该属性的某些值根据选择出现在转发器的顶部。就像我选择“视频”一样，我希望所有带有视频的记录都排在最前面。

现在，我可以在查询中执行此操作吗？还是中继器？标准？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T04:56:14.590

好吧......如果你不知道如何用 NHibernate 来做，你总是可以使用 linq-to-objects，然后将你的转发器绑定到它：

```
var bubbleVideos = from item in criteriaList
                   orderby (item.ItemType == "video" ? 0 : 1)
                   select item;
repeater.DataSource = bubbleVideos.ToList(); 
```

# windows - Windows XP 在哪里以及如何存储 wep/wpa 密钥？

> ID：190130
> 
> 赞同：1
> 
> 时间：2008-10-10T04:34:02.890
> 
> 标签：windows, windows-vista

就像标题所说的那样（即如果加密，使用什么方法）Windows XP 存储 WEP/WPA 密钥的位置和方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T04:48:24.733

我发现了这个：http: [//msdn.microsoft.com/en-us/library/ms706987](http://msdn.microsoft.com/en-us/library/ms706987(VS.85).aspx) (VS.85).aspx 。

# c++ - C++中的开源随机数生成算法？

> ID：190135
> 
> 赞同：6
> 
> 时间：2008-10-10T04:37:33.567
> 
> 标签：c++, algorithm, open-source, random

我需要在不重复的情况下连续生成 1 - 10000 范围内的随机数。有什么建议吗？

描述：我们正在为我们的应用程序构建一个新版本，它在 Sqlite DB 中维护记录。在我们应用程序的最后一个版本中，我们没有为每条记录设置唯一键。但是现在有了新的升级版本，我们需要支持从上一个版本的数据库中导入工具。所以我们所做的是，我们从旧数据库中读取每条记录，并为唯一键生成一个随机数并将其存储在新数据库中。在这里，我们很多人需要连续导入多达 10000 条记录。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T20:45:14.133

如果它确实必须在 1 到 10,0000 的范围内而不重复，但不是连续的，那么最好先创建一个包含 10000 个元素的顺序数组，然后对它们进行洗牌。

但是，我必须同意对原始问题的评论。我认为使它们不连续没有任何价值。

或者，在唯一和非连续很重要的情况下，1 到 10,000 的范围变得有问题。最好只使用 GUID。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T04:44:06.957

好吧，最终您将不得不停止生成它们，或者您将复制它们。

在计算机上，您的选择仅限于伪随机数生成器 (PRNG)，并且考虑到它们从不重复的限制，那么 PRNG 是您的最佳选择 - 真正的随机数据偶尔会重复一个数字。

在您的情况下，我会考虑使用大型 PRNG（32 位或更大）来洗牌您的 10,000 个数字，然后按洗牌顺序发送数字。

一旦它们用完，你就可以再次洗牌——因为 PRNG 太大了，你可以在复制一个序列之前多次遍历 10k 个数字。

向我们提供有关您在做什么的更多信息，我们可能会提出更好的答案。

-亚当

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T04:44:44.317

Mersenne Twister 是目前最好的（尽管我可能落后于任何真正的新发现几周）。[几乎所有语言的源代码都可以在某个地方获得，并且 MT 在 Boost here](http://www.boost.org/doc/libs/1_36_0/libs/random/index.html)中也提供

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T04:45:44.627

TR1 有很好的随机数支持——如果你的编译器支持的话。

否则[提升](http://www.boost.org/doc/libs/1_36_0/libs/random/index.html)

它基本上就是TR1。

至于不重复 - 你想要一个**shuffle**。这可能很简单，但如果你做得不对，就会有一些陷阱。杰夫阿特伍德不久前写了一篇不错的文章：

[http://www.codinghorror.com/blog/archives/001015.html](http://www.codinghorror.com/blog/archives/001015.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-10T05:05:14.667

Boost 可能会做一些保证没有重复数字的事情。但是为了一点乐趣，这是我的想法。

注意：我不会尝试在那个方向产生我的兰特，这就是疯狂。

```
#include <iostream>
#include <vector>
#include <algorithm>

class GaranteedNoRepeatRandom
{
    public:
        GaranteedNoRepeatRandom(int limit)
            :data(limit)
            ,index(0)
        {
            for(int loop=0;loop < limit;++loop)
            {   data[loop]  = loop;
            }
            // Note: random_shuffle optionally takes a third parameter
            // as the rand number generator.
            std::random_shuffle(&data[0],&data[0]+limit);
        }

        unsigned int rand()
        {
            unsigned int result = data[index];
            index   = (index+1) % data.size();

            // Add code to re-shuffle after index wraps around
            return result;
        }
    private:
        std::vector<unsigned int>               data;
        std::vector<unsigned int>::size_type    index;
};

int main()
{
    GaranteedNoRepeatRandom     gen(10000);

    for(int loop =0;loop < 10;++loop)
    {
        std::cout << gen.rand() << "\n";
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-10T17:17:20.073

生成大随机数。说 128 位。在一组 10000 中，两个这样的数字相同的几率非常小（大约为 n^2/2^b，其中 n = 所需数字的数量，b = 使用的位数）。给定足够的位，几率将变得小于你的 ram 被宇宙射线破坏的几率，这样你的算法无论如何都会失败。请注意，您从中提取随机数的空间确实具有您正在寻找的位数。很容易从 32 位池中错误地生成 128 位数字（即，即使您生成数字 1 到 2^128，也只有 2^32 种可能性）。boost 库中的随机数生成器可以为您正确执行此操作。顺便说一句：如果你不喜欢 128 位，然后使用 256 位或更多位，直到您确信不存在散列冲突的实际机会。如果您只需要这样做一次，那么只需使用前面答案中已经提到的 shuffle 方法。这将具有生成完美哈希的优势。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T12:01:14.017

随机数的生成太重要了，不能靠运气。-- Robert R. Coveyou，橡树岭国家实验室

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-10T04:44:47.297

[Boost.Random](http://www.boost.org/doc/libs/1_36_0/libs/random/index.html)是一个不错的选择，对我来说效果很好。但是，如果您不需要很多随机数生成器和分发版，您可能会寻找另一个库，而不是安装整个 Boost 包。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-10T04:45:01.913

随机性如何？显然有 rand()，还有特定于操作系统的东西（例如，Windows 在 CryptoAPI 中有一些东西）。你是在写东西（不推荐），还是只是在寻找一个预先存在的功能来使用？

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-10T04:46:10.977

[mtrand](http://www.bedaux.net/mtrand/)不错。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-10T05:13:13.980

是否可以质疑使用随机数作为数据库记录的唯一键的整个想法？我对 sqlite 不熟悉，但值得研究一下它是否在内部支持某种唯一列标识符。例如，SQL Server 有“identity”列，Oracle 有“sequences”，两者的目的相同。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-10T17:51:34.030

虽然您可能需要生成一系列不重复的值，但您不能将结果称为“随机”。真正的随机性与缺乏重复性的关系不如与序列中值的分布有关。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-10T17:20:08.540

[http://random.org/](http://random.org/)如果您需要真正的随机数

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-10T05:10:15.623

[C 中的数值食谱](http://btjunkie.org/torrent/eBook-Numerical-Recipes-in-C-1992-Math-pdf/43241d28de86e4e032a41841fd3508ca03cd9f8e2ce1)有一整章专门介绍随机数的生成。那里有一些实现。从简单直接到具有良好统计特性的复杂。

# vb.net - VB.NET 强类型集合

> ID：190138
> 
> 赞同：9
> 
> 时间：2008-10-10T04:39:25.577
> 
> 标签：vb.net, generics, class, collections

我想在 VB.NET 中创建一个集合，但我只希望它接受某种类型的对象。例如，我想创建一个名为“FooCollection”的类，它在各方面都像一个集合，但只接受“Foo”类型的对象。

我想我可以使用泛型来做到这一点，使用以下语法：

```
 Public Class FooCollection(Of type As Foo)
        Inherits CollectionBase

        ...

    End Class 
```

但是当我编译它时我得到一个错误，我“必须实现一个默认访问器”，所以很明显有一些东西丢失了。我不想在实例化时指定它接受的类型 - 我希望 FooCollection 本身具体说明它只接受 Foo 对象。我已经看到它在 C# 中使用强类型列表完成，所以也许我正在寻找的只是 VB.NET 语法。

谢谢你的帮助！

**编辑：感谢您的回答。可以，但是我想以某种方式命名类类型，实际上我使用以下代码完全实现了我正在寻找的内容：**

```
Public Class FooCollection
    Inherits List(Of Foo)

End Class 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-10T04:45:21.040

为什么不直接使用`List(Of Foo)`...它已经在 VB.NET 下`System.Collections.Generic`。要使用，只需声明如下：

```
Private myList As New List(Of Foo) 'Creates a Foo List'
Private myIntList As New List(Of Integer) 'Creates an Integer List' 
```

有关`[MSDN > List(T) Class (System.Collections.Generic)](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx "MSDN")`更多信息，请参阅。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-16T00:00:11.220

您需要为集合实现一个默认属性，如下所示：

```
Default Public Property Item(ByVal Index As Integer) As Foo
Get
  Return CType(List.Item(Index), Foo)
End Get
Set(ByVal Value As Foo)
  List.Item(Index) = Value
End Set 
```

结束属性

# eclipse - 处理 Eclipse 作业时是否有与 Thread.sleep 等效的方法？

> ID：190143
> 
> 赞同：1
> 
> 时间：2008-10-10T04:42:01.577
> 
> 标签：eclipse, scheduling, sleep

我正在编写 Eclipse 插件，其中有很多正在运行的作业。

在某些情况下，我希望作业在当前执行点“休眠”一段时间并从该位置继续（而不是重新安排作业并从头开始）。

我的理解是，在 Eclipse 作业中使用 Thread.sleep 已被弃用。

是否有可接受的替代方法来完成此任务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T05:23:23.443

我认为你最好的选择可能是重新安排工作并从你离开的地方继续。就像是：

```
class MyJob {
  int state;
  IStatus run(IProgressMonitor m) {
    if (state == 0) {
      phase1();
      schedule(1000);
    }
    else if (state == 1) {
      phase2();
    }
    return Status.OK;
  }
  void phase1() {
    state = 1;
  }
  void phase2() {
    state = 2;
  }
} 
```

# latex - 如何在 LaTeX 中插入表情符号？

> ID：190145
> 
> 赞同：40
> 
> 时间：2008-10-10T04:42:28.707
> 
> 标签：latex, emoticons

我知道这是一个很长的镜头，但是是否有一些包或方法可以将表情符号插入到 LaTeX 文档中？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-10T06:27:55.593

我至少知道两种部分方式：

第一的：

```
$\ddot\smile$ 
```

第二：

```
\usepackage{wasysym}
\smiley
\frownie 
```

或者您可以使用图像（如其他回复中所述）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-07T23:47:58.033

有什么反对简单的 {\tt :-)}？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2019-07-17T12:39:40.657

如果你使用`xelatex`or `lualatex`，那么

```
\documentclass{article}
\usepackage{fontspec}
\setmainfont{Symbola}
\begin{document}

\end{document} 
```

应该生成 Symbola 字体的黑白表情符号字母，可从[http://users.teilar.gr/%7Eg1951d/](http://users.teilar.gr/%7Eg1951d/) 或某些 Linux 发行版（例如 Ubuntu）中的标准软件包存储库获得。MS Windows 表情符号字体也可以用来`\fontspec{Segoe UI Emoji}[RawFeature={ccmp,dist}]` 代替`\fontspec{Symbola}`.

不幸的是，标准 lualatex 或 xelatex 不支持颜色（表情符号）字体。`harflatex`并且`luahblatex`可以使用排版颜色表情符号

```
\documentclass{minimal}
\usepackage{harfload}
\usepackage{fontspec}

\begin{document}
\noindent
\fontspec{Noto Color Emoji}[RawFeature={mode=harf}]
☃⛄‍‍‍\quad ‍❤️‍‍
\end{document} 
```

`harflatex`并且`luahblatex`可以在 2019 年 7 月从[https://contrib.texlive.info/的 TeXLive Contrib 安装。](https://contrib.texlive.info/)

以上内容是从[https://tex.stackexchange.com/questions/497403/how-to-use-noto-color-emoji-with-lualatex/500180](https://tex.stackexchange.com/questions/497403/how-to-use-noto-color-emoji-with-lualatex/500180)了解到的， 并进行了一些我自己的调查。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-10T05:15:19.373

Unicode 的“杂项符号”包括 3 个简单的表情符号：`0x2639`- `0x263B`。您也可以使用`0x2686`- `0x2689`。

要获得更多变化，您将需要使用图像并以某种方式包含它们。

我很好奇导致这个问题的情况:)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-11-29T13:40:56.117

到目前为止，还有`tikzsymbols`包含漂亮表情的包。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-09T13:46:59.510

一种解决方案是使用 bclogo 包。它包含两个笑脸（快乐和悲伤），以及许多其他小“标志”，如旗帜等。

# model-view-controller - 视图内的跨组件通信 (MVC)

> ID：190157
> 
> 赞同：5
> 
> 时间：2008-10-10T04:47:37.557
> 
> 标签：model-view-controller, design-patterns

有哪些最佳实践可以协调 View 中的复杂组件之间的交互？

我说的不是组合框或网格控件之类的简单小部件，而是由多个小部件组成的组件，它们可能值得单独进行单元测试。

你会：

1.  为每个组件定义抽象接口，~~让控制器~~通过依赖注入将它们连接起来，让它们通过方法调用直接相互通信？*因此，组件知道其他组件的接口。*
2.  定义每个组件可以触发的事件~~让控制器~~直接通过事件监听器将它们连接起来？*因此，组件具有附加到其他组件的事件接收器的事件处理程序。*
3.  为每个组件定义抽象接口，定义它们可以触发的事件和~~让控制器~~监听所有事件并在接口上执行方法调用？*因此，这些组件与其他组件完全无关。*
4.  观察者模式的经典应用？
5.  还要别的吗？

**更新：**我已经从 #1-3 中删除了“让控制器 ...”，因为在这些情况下，不一定是控制器必须执行路由/编排。它可能是视图本身。

我在最近的一个项目中采用了方法#3，我对组件的解耦和单独的可测试性感到满意。但是，我有一种感觉，我可以简化组件的布线。在我的例子中，主 View 对象必须在每个组件上添加多个事件侦听器，然后在有时进行一些本地处理（例如与模型交谈）之后调用适当组件上的方法。添加事件处理程序的代码看起来有点乱，我特别在寻找一种干净的方式来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T13:58:43.080

选项#3 听起来像中介者模式，当更新逻辑和对象之间的通信很复杂时，它通常是最好的方法。它还具有保持控制逻辑和初始化集中的额外优势，这往往使跟踪和调试这些类型的案例更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T05:37:01.233

听起来您有知识来回答自己的问题，但可能只是缺乏深入研究的信心。您只是在探索还是被困在某个地方？

我要补充一点，您可以做的另一件事是在所有对象之间放置一个组件管理器以促进通信。过去，当我做过类似的事情时，管理对象最终只是从每个组件中获取数据，将数据合并在一起，然后将其作为一个大请求传递给模型。我的每个组件都有一个他们会调用的委托并将数据传递到，当然该委托的实现在我的组件管理器上。

我还让该管理器对象充当网络的代理，我一直在等待复杂性变得更高，然后才遵守 SRP 并将该责任作为自己的类别。

基本上你说的一切听起来都不错。我建议只是潜入和探索。

# ruby-on-rails - 如何为旧数据库创建迁移？

> ID：190160
> 
> 赞同：1
> 
> 时间：2008-10-10T04:49:09.537
> 
> 标签：ruby-on-rails, migration

我目前正在使用在我意识到 Rails 存在之前设计的数据库开发 Rails 应用程序。
我目前已经创建了一些迁移来向现有表添加一些新表和新列。

我想进行迁移以重新创建完整的数据库。

我应该遵循哪些步骤？
我应该手动创建所有迁移吗？

编辑：我对数据库模式感兴趣，而不是对数据库内容感兴趣

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T21:37:55.510

当我们将 PHP 应用程序移植到 Rails 时，我们遇到了这个确切的问题。我们所做的与今天的建议类似。首先，我们将 rails 配置指向当前数据库。然后我们执行 rake db:schema:dump 并将 db/schema.rb 文件复制到类似 db/schema_base.rb 的文件中。然后，您进行第一次迁移，加载该架构。例如：

```
class CreateTables < ActiveRecord::Migration
  def self.up
    `cp #{Rails.root}/db/schema_base.rb #{Rails.root}/db/schema.rb`
    Rake::Task['db:schema:load'].invoke
  end

  def self.down
  end
end 
```

只需强制这是第一次迁移，您就可以上路了。然后您开始编写迁移以将数据库转换为更符合 Rails 方式。我们编写了迁移以正确重命名 id 列、外键关系、表名等。
请记住，如果使用外键约束和触发器，模式转储不支持它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T18:38:13.703

我认为这将需要一些手动工作。

`rake db:schema:dump`如果您的项目中没有该文件，您可以从运行开始`db/schema.rb`。`db/schema.rb`如果您一直在使用迁移，您可能已经有一个文件。该文件将包含您为开发配置的数据库的 ruby​​ 表示形式。要获得另一个数据库的 ruby​​ 表示，请将 RAILS_ENV 传递给 rake 命令（即`RAILS_ENV=production rake db:schema:dump`）

然后，您可以使用该`schema.rb`文件作为起点来创建重新创建预先存在的表的新迁移。创建新迁移文件时，请确保它的命名方式使其在其他迁移之前运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T04:54:04.033

简短的回答：是的

长答案：这取决于数据库的设置方式以及与当前数据库的差异。另外，因为我假设 ID 是动态生成的 - 如果您从一个表移动到另一个表，请确保您的所有外键都已正确更新。

编写一个脚本，从旧数据重新创建整个数据库。如果您发布了您的数据库方案和您的新数据库方案，我很乐意为您提供进一步的帮助 :)

# desktop-application - 您如何维护您的多语言应用程序？

> ID：190162
> 
> 赞同：1
> 
> 时间：2008-10-10T04:50:13.107
> 
> 标签：desktop-application, multilingual

您如何使程序中的口语字符串保持最新？有便宜的方法吗？随着时间的推移，您在哪里可以找到进行转换的人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T05:21:35.833

这摘自 Joel 的最佳软件写作 I： http: [//blogs.msdn.com/ericlippert/archive/2003/10/28/53298.aspx](http://blogs.msdn.com/ericlippert/archive/2003/10/28/53298.aspx)（换一个灯泡需要多少微软员工？），以及它在高层次上讨论了简单的更改如何产生巨大的影响。如果您认为 MS 有许多国际化的应用程序，这是他们用来确保他们的应用程序与一千个因素保持最新的过程，包括不会错过其他语言中的新/修改的字符串。

对于翻译需求（我对这个领域有一点了解！），我会推荐 OmniLingua Worldwide。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T05:02:16.950

有些公司会翻译标准格式的资源文件以收取费用；我认为这就是大多数大公司的做法。

[我最近在这里](https://stackoverflow.com/questions/185291/best-way-to-design-for-localization-of-strings)问了一个类似的问题，关于在项目中构造代码以支持这一点的最佳方法，我还希望在代码中保留可读的字符串。不过，这不是标准的……通常您会将所有字符串资源放入一个单独的文件中，并在代码中通过 ID 引用它们，然后翻译文件。

请参阅适用于 Windows C++ 的 .rc 文件、适用于 .NET 的 .resx 文件，不确定 Linux/Mac/其他存在什么，但我确信有等价物。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T05:16:40.337

我认为这取决于您希望语言的可访问性，这可能在很大程度上取决于项目首先是什么（专业、爱好等）

在我的业余工作中，我将特定于语言环境的字符串存储在一个简单的外部 JSON 文件中（XML 甚至一个简单的 INI 也可以工作，任何可以为您提供键值对的东西）。这具有跨平台、易于编辑的优点，并且（如果需要）允许任何有知识和决心的人将您的应用程序翻译成他们选择的语言。对于开源项目等来说，这可能是无价的。

对于您可能不想随意翻译的项目，嵌入式资源可能是一个更安全的选择，因为开发人员可以相当容易地更换它们，但至少给准翻译人员提供了一个微不足道的障碍。但是，即使在这种情况下，存储方法也不需要复杂。任何给定的文件类型或本机字符串表都可以。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T05:27:46.930

在我参与的项目中，我们根据项目的规模采取了两种不同的本地化方法。对于每个开发人员“拥有”一个组件的较小项目，开发人员有责任维护需要翻译的内容和翻译成哪种语言的列表。

对于较大的项目，我们用语言前缀标记了每个字符串。例如，“Yes”的德语字符串被标记为“[de] Yes”。本地化后，字符串被替换为“Ja”。这使您可以轻松找到遗漏的内容，因为您可以通过前缀进行搜索。

至于其他商业资源，我曾在多个方面与[Net-Translators](http://www.net-translators.com/safot/software_localization.asp)和[BMT](http://www.b-mt.de/us/technik/tms.html)合作过，后者是最近的一次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-21T07:07:09.817

我强烈建议查看西风[数据库资源提供程序](http://www.west-wind.com/presentations/wwdbresourceprovider/)。

我管理一个开源项目管理 Web 应用程序 ( [http://sharpforge.org/p/SharpForge.aspx](http://sharpforge.org/p/SharpForge.aspx) )，最初使用的是 resx 文件。这是我遇到的问题

*   我想访问那些从 BLL 层强类型化的资源。这简直是​​不可能的。
*   resx 文件也很难维护，添加/删除/更改资源键会产生各种问题。
*   最后，我遇到了巨大的问题，没有使用具有正确字符映射/编码的编辑器保存文件，这将删除所有翻译的文本。从翻译器获取资源到代码存储库的过程通常会导致对文本的修改。

我能够将数据库提供程序作为应用程序的一部分来实现。它带有一个编辑器，您可以让翻译人员访问它。他们的翻译直接进入应用程序，无需双重处理，并且在应用程序重新启动后立即可用。它还具有创建强类型对象以从任何层访问提供者的能力。

[安装后，我在getafreelancer](http://www.getafreelancer.com/projects/246088.html)上创建了一个翻译项目，并在大约 2 周内为我的应用程序完成了 25 次翻译。全部价格约为 50-100 美元。

如果您对如何实施它有任何疑问，请联系[Sharpforge 论坛。](https://sharpforge.org/Forums/ViewForums.aspx?ForumGroupId=1&ProjectCode=SharpForge)

# asp.net - asp.net 和 HTTP 压缩 - 共享主机

> ID：190164
> 
> 赞同：1
> 
> 时间：2008-10-10T04:52:01.947
> 
> 标签：asp.net, compression

在实现页面压缩时，我有什么选择是 asp.net。现在我有一个自定义的自制 httpmodule，它还不是很成熟。

~~谷歌将我链接到[MbCompression](http://www.codeplex.com/MbCompression)。该项目的浏览量和下载量很少，这让我有点沮丧。~~

编辑：我在共享主机下，这限制了我对 IIS 设置的访问

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T16:41:00.973

我在 IIS 6 上通过 ASP.NET MVC 应用程序使用[FastMVC](http://code.msdn.microsoft.com/fastmvc)进行了一些动态压缩。效果很好。我认为没有什么可以阻止它在常规 ASP.NET 应用程序中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T02:24:12.123

我讨厌这样做，但是谷歌搜索“HTTP Compression ASP.NET”之类的东西会产生许多带有代码的好资源。通常他们会有一种使用模块进行压缩的方法。找一个对你有意义的——我发现 CodeProject 项目通常对这样的东西很有用。

（请注意，您的主机稍后不会在 IIS 级别添加压缩。双重压缩会破坏站点。但是大多数现在还没有打开它的主机，以后不会再打开它，因为他们不聪明。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T05:01:22.367

IIS 7 内置了对 gzip 和 deflate 压缩的支持。IIS 6 也是如此，但它不适用于动态内容。

MbCompress 用于压缩资产，这与 HTTP 压缩不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-13T04:22:57.817

MbCompression 主要针对 http 压缩设计，主要目标是共享托管下的站点。它非常适合您的需求。检查最后一个代码（不是发布代码）

# windows - 通过 Ruby 持久化环境变量

> ID：190168
> 
> 赞同：9
> 
> 时间：2008-10-10T04:54:45.373
> 
> 标签：windows, ruby, environment-variables, dos

我正在尝试在 Ruby 中设置我的 DOS 环境变量，并在脚本退出后让它保持不变。例如，如果我想要一个 ruby​​ 脚本`set_abc_env.rb`将环境变量 'ABC' 设置为 'blah'，我希望运行以下命令：

```
C:> echo %ABC%
C:> set_abc_env.rb
C:> echo %ABC% blah 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-10T07:41:22.183

您可以通过 Ruby ENV 对象访问环境变量：

```
i = ENV['ABC']; # nil
ENV['ABC'] = '123';
i = ENV['ABC']; # '123' 
```

坏消息是，正如 MSDN[所说](http://msdn.microsoft.com/en-us/library/ms682009(VS.85).aspx)，一个进程永远不能直接更改不是该进程子进程的另一个进程的环境变量。因此，当脚本退出时，您会丢失它所做的所有更改。

好消息是 Microsoft Windows 将环境变量存储在注册表中，并且可以将环境变量[传播](http://support.microsoft.com/kb/104011)到系统。这是一种修改用户环境变量的方法：

```
require 'win32/registry.rb'

Win32::Registry::HKEY_CURRENT_USER.open('Environment', Win32::Registry::KEY_WRITE) do |reg|
  reg['ABC'] = '123'
end 
```

该文档还说您应该注销并重新登录或广播 WM_SETTINGCHANGE 消息以对应用程序进行更改。这是在 Ruby 中进行广播的方式：

```
require 'Win32API'  

SendMessageTimeout = Win32API.new('user32', 'SendMessageTimeout', 'LLLPLLP', 'L') 
HWND_BROADCAST = 0xffff
WM_SETTINGCHANGE = 0x001A
SMTO_ABORTIFHUNG = 2
result = 0
SendMessageTimeout.call(HWND_BROADCAST, WM_SETTINGCHANGE, 0, 'Environment', SMTO_ABORTIFHUNG, 5000, result) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-30T21:00:50.693

对于其他正在为此寻找解决方案并寻找更多不需要登录或退出的黑客的人来说，我想出了针对类似问题的解决方案：

**解决方法：**

我的工作依赖于 ruby​​ 和由 Vincent Fatica 开发的名为[SETENV.EXE的命令行实用程序的组合。](http://barnyard.syr.edu/~vefatica/#SETENV)此时它已有十多年的历史，但在 Windows XP 中运行良好（尚未在 Windows 7 下测试）。它比 MS 恕我直言的 setx 实用程序更好。至少是为了删除东西。确保 setenv 在命令行中可用。把它放在一些 c:\tools 中，然后把 c:\tools 放在你的 PATH 中。

这是使用它的方法的简短示例：

```
def switch_ruby_env
  if RUBY_VERSION.match("1.8.7").nil?  
    `setenv -m CUSTOM_PATH " "`
  else
    `setenv -m CUSTOM_PATH -delete`
  end
end 
```

# .net - 如何在.net中检测串口是否正在使用

> ID：190173
> 
> 赞同：1
> 
> 时间：2008-10-10T05:00:49.027
> 
> 标签：.net, windows, serial-port

我们有在 .NET 3.5 框架中开发的工业自动化应用程序。

我必须为我们的用户列出计算机中可用的串行端口。作为其中的一部分，如果任何串行端口已经打开，我必须显示“使用中”状态。我试过谷歌但没有运气。

有人能帮助我吗？

问候，

克里希吉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T05:30:36.847

尝试使用排他锁打开 com 端口，如果失败，将其标记为打开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T05:25:19.510

有未记录的 API 可以找到系统中打开的所有句柄，然后您可以检查哪些是对串行端口开放的。那是如果用户将始终是管理员并且您不关心使用 .Net 和记录的 API。

有记录的 API 可以找到所有存在的 COM 端口，然后您可以尝试打开所有这些端口。这听起来很粗糙和缓慢，但它比替代方案更不邪恶。

# c++ - execv() 和 const-ness

> ID：190184
> 
> 赞同：33
> 
> 时间：2008-10-10T05:06:55.460
> 
> 标签：c++, unix

我经常`execv()`在 C++ 中使用该函数，但如果某些参数在 C++ 字符串中，我会因为无法做到这一点而烦恼：

```
const char *args[4];

args[0] = "/usr/bin/whatever";
args[1] = filename.c_str();
args[2] = someparameter.c_str();
args[3] = 0;

execv(args[0], args); 
```

这不会编译，因为`execv()`take`char *const argv[]`与 不兼容`const char *`，所以我必须`std::string`使用 s 将我的 s 复制到字符数组`strdup()`，这很痛苦。

有谁知道这是什么原因？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-10T05:20:20.143

开放组基本规范解释了为什么会这样：为了与现有的 C 代码兼容。但是，指针和字符串内容本身都不打算更改。因此，在这种情况下，您可以`const_cast`对`c_str()`.

[引用：](http://pubs.opengroup.org/onlinepubs/9699919799/functions/exec.html)

> 包含关于`argv[]`和`envp[]`成为常量的声明是为了向未来的语言绑定编写者明确说明这些对象是完全常量。由于 ISO C 标准的限制，不可能在标准 C 中陈述这个想法。为 exec 函数和参数指定两个级别的`const`限定似乎是自然的选择，因为这些函数不修改指针数组或函数指向的字符，但这将不允许现有的正确代码。相反，只有指针数组被标记为常量。`argv[]``envp[]`

之后的表格和文字更有洞察力。但是，Stack Overflow 不允许插入表格，因此上面的引用应该足以让您在链接文档中搜索正确的位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T05:16:08.200

const 是 C++ 的东西 - execv 在 C++ 存在之前就采用了 char * 参数。

您可以使用 const_cast 而不是复制，因为 execv 实际上并没有修改它的参数。您可能会考虑编写一个包装器来节省自己的打字时间。

实际上，您的代码的一个更大问题是您声明了一个字符数组而不是字符串数组。

试试： const char* args[4];

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-07T21:46:08.877

这只是 C/C++ 风格的 const 不能很好地工作的情况。实际上，内核不会修改传递给 exec() 的参数。它只是在创建新进程时复制它们。但是类型系统的表现力不足以真正很好地处理这个问题。

这个页面上的很多人都建议让 exec 使用“char**”或“const char * const[]”。但这些都不适用于您的原始示例。“char**”意味着一切都是可变的（对于字符串常量“/usr/bin/whatever”来说肯定不是真的）。“const char *const[]”意味着没有什么是可变的。但是你不能为数组的元素分配任何值，因为数组本身就是 const。

你能做的最好的就是有一个像这样的编译时 C 常量：

```
const char * const args[] = {
  "/usr/bin/whatever",
  filename.c_str(),
  someparameter.c_str(),
  0}; 
```

这实际上适用于“const char *const[]”的建议类型签名。但是，如果您需要可变数量的参数怎么办？那么你不能有一个编译时常量，但你需要一个可变数组。所以你又开始捏造东西了。这就是 exec 的类型签名采用“const char **”作为参数的真正原因。

顺便说一下，C++ 中的问题是相同的。您不能将 std::vector < std::string > 传递给需要 std::vector < const std::string > 的函数。您必须对整个 std::vector 进行类型转换或复制。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-03-25T13:48:56.910

我通常用以下方法破解这个：

```
#define execve xexecve
#include <...>
#include <...>
#include <...>
#undef execve

// in case of c++
extern "C" {
    int execve(const char * filename, char ** argvs, char * const * envp);
} 
```

;/

# linq - Linq 和沉重的 blob

> ID：190188
> 
> 赞同：0
> 
> 时间：2008-10-10T05:09:51.990
> 
> 标签：linq

我有这个 Document 表，其中包含一些文档的元数据，以及作为 blob 的文档内容。

然后我使用 lucene.Net 来查询我的文档；作为回报，它为我提供了我的 Document 表的 Guid 列表以及两个包含突出显示的文档名称的 html 版本的字段，并在突出显示搜索关键字的情况下提取。

然后我使用 linq 将此结果与我的文档表字段连接起来，以获取要显示为搜索结果的列表。愚蠢的事情是 linq 尝试将 blob 加载到文档中，尽管它没有在连接中使用。

我正在考虑两种选择，我都不喜欢：

*   将我的 blob 移动到一个新表并将其 1-1 链接到文档表。我不喜欢，因为 linq 的限制迫使我改变我的数据库结构。
*   添加一个带有“LiteDocument”表的新 dbml，并从 dbml 中的文档表中删除 blob；我不喜欢，因为如果文档表发生变化，我有两个地方需要维护。

我想知道是否有更好的方法来做到这一点？以下是代码片段：

```
 public class LuceneSearchResult
    {
        public Guid DocumentID { get; set; }
        public string FormattedDocumentFileName { get; set; }
        public string FormattedDocumentExtract { get; set; }
    } 
```

和

```
 public IList Search(string searchPhrase, Guid? ProductId)
    {
        searchPhrase = PrepareSearchPhraseWithThesaurus(searchPhrase);
        var result = RunLuceneQuery(searchPhrase, ProductId);

        var dc = new ChinaHcpDataContext();
        var docs =
                from r in result
                join d in dc.Documents on r.DocumentID equals d.DocumentID
                select
                        new
                                {
                                    d.DocumentID,
                                    TradeNameEN = d.TradeProduct != null ? d.TradeProduct.TradeNameEN : "",
                                    TradeNameZH = d.TradeProduct != null ? d.TradeProduct.TradeNameZH : "",
                                    d.DocumentFileName,
                                    d.InsertedDateUtc,
                                    d.Size,
                                    DocumentDisplayText = r.FormattedDocumentFileName,
                                    DocumentSelectionReason = r.FormattedDocumentExtract
                                };

        return docs.ToList();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T10:23:24.583

您可以指定延迟加载字段。它是 DBML 设计器中表字段可用的属性之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-12T20:33:02.130

在您的数据库中创建一个排除 blob 的视图，然后从该视图生成您的 dbml 是否有帮助？它与您的第二个选项并没有太大的不同，但主要将更改保留在数据库本身中，而不需要对现有表结构进行任何更改。

# mysql - VB.Net中mysql数据库的数据库备份

> ID：190194
> 
> 赞同：3
> 
> 时间：2008-10-10T05:15:14.710
> 
> 标签：mysql, vb.net

如何在 VB.Net 中创建 mysql 数据库的数据库备份？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-23T07:27:47.040

您可以使用**MySqlBackup.NET**，它是 mysqldump 的替代品。

官网&文档 > [https://github.com/MySqlBackupNET/MySqlBackup.Net](https://github.com/MySqlBackupNET/MySqlBackup.Net)

例子：

**备份 MySql 数据库**

```
Dim conn As MySqlConnection = New MySqlConnection(constr)
Dim cmd As MySqlCommand = New MySqlCommand
cmd.Connection = conn
conn.Open
Dim mb As MySqlBackup = New MySqlBackup(cmd)
mb.ExportToFile("C:\backup.sql")
conn.Close 
```

**恢复 MySql 数据库**

```
Dim conn As MySqlConnection = New MySqlConnection(constr)
Dim cmd As MySqlCommand = New MySqlCommand
cmd.Connection = conn
conn.Open
Dim mb As MySqlBackup = New MySqlBackup(cmd)
mb.ImportFromFile("C:\backup.sql")
conn.Close 
```

我是这个项目的作者之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-17T16:52:03.940

使用此代码。这个对我有用。

我遇到了这样的问题，然后找到了这篇文章

“ [http://www.experts-exchange.com/Programming/Languages/.NET/Q_27155602.html](http://www.experts-exchange.com/Programming/Languages/.NET/Q_27155602.html) ”

示例在 C# 中。我手动将其转换为 vb.net 并添加转换为“utf8”。

```
Imports System.Text
Public Class Form1
    Dim OutputStream As System.IO.StreamWriter
    Sub OnDataReceived1(ByVal Sender As Object, ByVal e As    System.Diagnostics.DataReceivedEventArgs)
        If e.Data IsNot Nothing Then
            Dim text As String = e.Data
            Dim bytes As Byte() = Encoding.Default.GetBytes(text)
            text = Encoding.UTF8.GetString(bytes)
            OutputStream.WriteLine(text)
           End If
    End Sub

   Sub CreateBackup()
        Dim mysqldumpPath As String = "d:\mysqldump.exe"
        Dim host As String = "localhost"
        Dim user As String = "root"
        Dim pswd As String = "Yourpwd"
        Dim dbnm As String = "BaseName"
        Dim cmd As String = String.Format("-h{0} -u{1} -p{2} {3}", host, user, pswd, dbnm)
        Dim filePath As String = "d:\backup\fieName.sql"
        OutputStream = New System.IO.StreamWriter(filePath, False, System.Text.Encoding.UTF8)

        Dim startInfo As System.Diagnostics.ProcessStartInfo = New System.Diagnostics.ProcessStartInfo()
        startInfo.FileName = mysqldumpPath
        startInfo.Arguments = cmd

        startInfo.RedirectStandardError = True
        startInfo.RedirectStandardInput = False
        startInfo.RedirectStandardOutput = True 
        startInfo.UseShellExecute = False
        startInfo.CreateNoWindow = True
        startInfo.ErrorDialog = False

        Dim proc As System.Diagnostics.Process = New    System.Diagnostics.Process()
        proc.StartInfo = startInfo
        AddHandler proc.OutputDataReceived, AddressOf OnDataReceived1
        proc.Start()
        proc.BeginOutputReadLine()
        proc.WaitForExit()

       OutputStream.Flush()
       OutputStream.Close()
        proc.Close()
    End Sub

     Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As      System.EventArgs) Handles MyBase.Load

        CreateBackup()

     End Sub
   End Class 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T08:21:23.647

您可以调用 mysqldump，但您可能需要在 Mysql 服务器上运行 VB.NET。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-01T23:48:55.347

我发现最简单的方法是使用独立应用程序 mysqldump.exe。

```
mysqldump --host=[HOSTNAME] --user=[USER] --password=[PASSWORD] -R [DATABASE NAME] > [PATH TO BACKUP FILE] 
```

我们遇到了备份不保存数据库函数的问题，但 -R 开关对其进行了排序，因此如果您在数据库中使用存储过程或函数，建议您使用它。

要恢复创建的文件，请改用 mysql 命令。

```
mysql --host=[HOSTNAME] --user=[USER] --password=[PASSWORD] [DATABASE NAME] < [PATH TO BACKUP FILE] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T21:19:06.557

您可以读取每个表的数据并将其写入新数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T21:37:12.063

我会编写一个存储过程，因为 MySQL 5 支持它们，它可以处理所有“繁重”的数据工作。然后只需创建每个“晚上”调用该过程的计划任务。对于后一个组件，我强烈推荐 Powershell ......它很棒。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-19T12:20:43.720

这是我用来备份mysql数据的。我制作了 mysqldump.exe 和 mysql.exe 的副本并将其存储在我的 LIB_PATH 中，然后以下代码将备份您的数据。您可以指定您的 mysqldump.exe 目录并将其分配给 LIB_PATH，在参数下提供您的登录详细信息，然后指定您的输出目录，我的设置为 BACKUP_DIR，我使用预先格式化的 Now() 作为我的文件名。代码非常简单。祝你好运

```
 Using myProcess As New Process()
        Dim newfiledb As String = BACKUPDIR_PATH & Format(Now(), "MMM_dd_yyyy@h~mm_tt").ToString & "_local.sql"
        Try
            myProcess.StartInfo.FileName = "mysqldump.exe"
            myProcess.StartInfo.WorkingDirectory = LIB_PATH
            myProcess.StartInfo.Arguments = "--host=localhost --user=username --password=yourpassword yourdatabase -r " & newfiledb
            myProcess.StartInfo.WindowStyle = ProcessWindowStyle.Hidden
            myProcess.Start()
            myProcess.WaitForExit()
            MsgBox("Backup Created ... " & vbNewLine & newfiledb)
        Catch ex As Exception
            MsgBox(ex.Message, vbCritical + vbOKOnly, ex.Message)
        Finally
            myProcess.Close()
        End Try
    End Using 
```

# .net - 为什么我的 .net 计算的 MD5 哈希值不等于在网站上计算的哈希值？

> ID：190198
> 
> 赞同：5
> 
> 时间：2008-10-10T05:16:32.100
> 
> 标签：.net, security, hash, cryptography

我正在尝试在 JavaScript 和 .Net 中生成等效的 MD5 哈希。也没有这样做，我决定使用第三方计算 - 这个[网站](http://www.johnmaguire.us/tools/hashcalc/index.php?strtohash=password&mode=hash)的“密码”一词。我稍后会添加盐，但目前，我无法让 .net 版本与网站的哈希匹配：

```
5f4dcc3b5aa765d61d8327deb882cf99 
```

我猜这是一个编码问题，但我已经尝试了大约 8 种不同的方法来计算 .Net 中的 MD5 哈希，但没有一个与我在 JavaScript（或从网站）中获得的结果相匹配。这个[MSDN 示例](http://msdn.microsoft.com/en-us/library/system.security.cryptography.md5.aspx)是我尝试过的方法之一，它产生了我通常收到的这个哈希：

```
7c6a180b36896a0a8c02787eeafb0e4c 
```

编辑：可悲的是，我不小心为两种不同的实现提供了不同的源字符串。埃布萨克。:-/ 仍然有兴趣听听您对后续行动的回答。

额外的问题：哪种编码/格式最适合在数据库中存储散列值？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T05:28:22.390

从您引用的 MSDN 站点运行代码：

```
 // Hash an input string and return the hash as
    // a 32 character hexadecimal string.
    static string getMd5Hash(string input)
    {
            // Create a new instance of the MD5CryptoServiceProvider object.
            MD5 md5Hasher = MD5.Create();

            // Convert the input string to a byte array and compute the hash.
            byte[] data = md5Hasher.ComputeHash(Encoding.Default.GetBytes(input));

            // Create a new Stringbuilder to collect the bytes
            // and create a string.
            StringBuilder sBuilder = new StringBuilder();

            // Loop through each byte of the hashed data 
            // and format each one as a hexadecimal string.
            for (int i = 0; i < data.Length; i++)
            {
                sBuilder.Append(data[i].ToString("x2"));
            }

            // Return the hexadecimal string.
            return sBuilder.ToString();
        }

        static void Main(string[] args)
        {
            System.Console.WriteLine(getMd5Hash("password"));
        } 
```

返回：

```
5f4dcc3b5aa765d61d8327deb882cf99 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-08-30T00:13:36.780

This is happening because somehow you are hashing `password1` instead of `password`, or perhaps calculating the `password` incorrectly and it somehow mysteriously equals `password1`.

You can do a reverse lookup of the md5 hash you provided by googling

```
7c6a180b36896a0a8c02787eeafb0e4c 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T05:19:56.603

对于“密码”一词，我得到与该网站相同的值：

```
$ echo -n password | md5
5f4dcc3b5aa765d61d8327deb882cf99 
```

如果没有看到您实际使用的代码，很难判断可能出了什么问题。

至于在数据库中存储哈希，我将它们存储为十六进制字符串。尽管大多数数据库都可以处理二进制 blob，但将它们存储为二进制只能节省一半的空间，而且它们更难查询和操作。无论如何，您与散列一起存储的*其他*数据可能会更大。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T05:20:59.097

根据我自己的经验，这个 VB.Net 版本给出了与 MySQL 相同的结果：

```
Private Function MD5Hash(ByVal str As String) As String

    Dim md5 As MD5 = MD5CryptoServiceProvider.Create
    Dim hashed As Byte() = md5.ComputeHash(Encoding.Default.GetBytes(str))
    Dim sb As New StringBuilder

    For i As Integer = 0 To hashed.Length - 1
        sb.AppendFormat("{0:x2}", hashed(i))
    Next

    Return sb.ToString

End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T05:22:45.457

你有任何代码你试图做到这一点吗？

（回答第二个问题）我通常使用字符串字段并将其存储为 BASE64 编码。易于使用和进行比较。

```
/// <summary>
/// Gets the Base 64 encoded SHA1 hashed password
/// </summary>
/// <returns>A Base 64 encoded string representing the SHA1 Hash of the password</returns>
public string ToBase64SHA1String()
{
    return Convert.ToBase64String(this.GetSHA1HashCode());

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-02T05:05:19.380

还应该注意的是，可以使用彩虹表破解 MD5 和（互联网上有免费程序可以接受 MD5 和作为输入并输出明文 - 通常是密码）

SHA1 可能是更好的选择...

**编辑：**添加盐是防止您的哈希被反转的好方法
**编辑2：**如果我费心阅读您的帖子，我会注意到您已经提到您计划添加盐

# java - java.util.regexp 是否足够高效？

> ID：190204
> 
> 赞同：6
> 
> 时间：2008-10-10T05:18:41.520
> 
> 标签：java, regex

在用户更改源文件时，我需要对源文件中的某些模式进行大量搜索，因此我需要进行在时间和内存上高效的正则表达式匹配。模式会重复，所以应该编译一次，但我需要能够检索子部分（而不是仅仅确认匹配）

我正在考虑使用 java.util.regexp 或 Jakarta perl5util（如果它仍然存在，我使用它已经有几年了），或者可能是 Eclipse 搜索引擎，尽管我怀疑 ti 是否更聪明。

两者之间有显着的性能差异吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T05:33:51.007

我不确定在不同的正则表达式 Java 引擎方面是否存在巨大的性能差距。

但是在构建正则表达式时肯定存在性能问题（也就是说，如果数据足够大，如[Jeff Atwood 所述](http://blog.codinghorror.com/regex-performance/)）

唯一应该避免的是[灾难性的回溯](http://www.regular-expressions.info/catastrophic.html)，最好在使用[原子分组](http://www.regular-expressions.info/atomic.html)时避免。

因此，默认情况下，我会使用 java.utils.regexp 引擎，除非您有特定的符合 perl 的 regexp 源需要在程序中重用。

然后我会仔细构建我打算使用的正则表达式。

但是在选择一个或另一个引擎方面......正如在[许多](https://stackoverflow.com/questions/30754/performance-vs-readability#30789)[其他问题](https://stackoverflow.com/questions/2750/data-verifications-in-gettersetter-or-elsewhere#2761)[中](https://stackoverflow.com/questions/48732/what-are-your-top-design-consideration#48737) [所说](https://stackoverflow.com/questions/42383/java-object-allocation-overhead#42410)......：

*   “让它工作，让它快速 - 按这个顺序”
*   谨防“过早优化”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T06:58:39.897

正如 VonC 所说，您需要了解您的正则表达式。事先编译正则表达式并没有什么坏处，否则每次编译正则表达式的成本都会严重影响性能。

对于某些类别，有备用库：http: [//jint.sourceforge.net/jint.html](http://jint.sourceforge.net/jint.html)可能有更好的性能。再说一次，这取决于您使用的 java 版本。

JDK 1.6 展示了正则表达式引擎的成熟度，结合了良好的特性和性能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T13:23:35.100

总体而言，java.util.regex（不是“regexp”）包至少与任何其他 Java regex 库一样好，包括[Jakarta ORO](http://jakarta.apache.org/oro/index.html)（您的“Perl5Util”库）。此外，它支持原子组和所有格量词，我发现这两者对于编写极快的正则表达式非常有用。它还支持预编译的正则表达式和捕获组，但我认为所有库都是如此。

# java - JUnit 和 junit.framework.TestSuite - 没有可运行的方法

> ID：190224
> 
> 赞同：5
> 
> 时间：2008-10-10T05:28:07.663
> 
> 标签：java, unit-testing, junit

我做了一些单元测试（在测试类中）。我读过的教程说我应该为单元测试制作一个TestSuite。

奇怪的是，当我直接运行单元测试（选择测试类 - 作为 jUnit 测试运行）时，一切正常，尽管当我用测试套件尝试同样的事情时，总是有一个例外：java.lang。例外：没有可运行的方法。

这是测试套件的代码：

```
import junit.framework.Test;
import junit.framework.TestSuite;

public class AllTests {

public static Test suite() {
    TestSuite suite = new TestSuite("Test suite for com.xxx.yyyy.test");
    //$JUnit-BEGIN$
    suite.addTestSuite(TestCase.class);
    //$JUnit-END$
    return suite;
    }

} 
```

任何想法为什么这不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T06:51:08.073

我在 ant 方面没有经验 - 所以我现在没有用它来测试它。

在互联网上搜索似乎我正在混淆旧的 jUnit 3.8 和 jUnit 4.0 行为。现在尝试一种使用“新行为”的方法

编辑：
现在它可以工作了：

AllTest 更改为：

```
import org.junit.runner.RunWith;
import org.junit.runners.Suite;
import org.junit.runners.Suite.SuiteClasses;

@RunWith(value=Suite.class)
@SuiteClasses(value={TestCase.class})
public class AllTests {

} 
```

测试用例更改为：

```
import static org.junit.Assert.assertTrue;
import org.junit.Test;

public class TestCase  {
@Test
    public void test1 {
        assertTrue (tmp.getTermin().equals(soll));
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-03-03T20:20:18.560

使用 IDE 的代码完成添加导入时要小心`@Test`。例如，它必须是`import org.junit.Test`而**不是** `import org.testng.annotations.Test`。如果你错误地使用了第二个，你会得到“no runnable methods”错误。（我使用的是导入的 Intellij Idea 2017 `org.junit.jupiter.api.Test`！）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-12T09:32:29.093

我也花了一些时间才弄清楚，但我认为这可以解决您的问题：

你正在做一个suite.addTestSuite(TestCase.class)，而你应该做一个suite.addTest(TestCase.class)。

您还可以将测试套件添加到测试套件以创建整个测试套件层次结构。在这种情况下，您将不得不使用 suite.addTest()。但请注意，您随后使用 .suite() 而不是 .class：suite.addTest(MyTestSuite.suite **()** )！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T05:51:37.570

当然，它不会起作用，因为您没有告诉测试套件您的测试类是什么。

但是我想知道为什么您不使用“经典方式”来构建测试套件，这是使用 jUnit 的 ant 任务的 ant。

# c# - 以编程方式构建 LINQ 查询，而没有局部变量欺骗我

> ID：190227
> 
> 赞同：12
> 
> 时间：2008-10-10T05:28:32.390
> 
> 标签：c#, linq

假设我的对象处于完美的工作状态（即 TDD 让我认为它们工作正常）。

我有一个这样创建的列表（正确缩进除外）：

```
var result = from v in vendors
             from p in v.Products
             orderby p.Name
             select p; 
```

这行得通 - 我从所有供应商那里获得所有产品。

现在我有一个条件列表，由用户在运行时建立。让我们应用它们：

```
foreach (Attribute a in requiredAttributes)
{
    result = result.Where(p => p.Attributes.Contains(a));
} 
```

这可能是原始的，但我认为它会工作。但是，在此 foreach 循环完成后，当您枚举“结果”时，它将包含在其 Attributes 属性（也是一个集合）中具有 requiredAttributes 集合的 LAST 属性的所有产品。

对我来说，这闻起来就像“a”在每次通过循环时都会在某处被覆盖，并且只有最后一个适用。

没有以某种方式为 IEnumerable 编写一个名为 ContainsAll(IEnumerable) 的扩展方法或类似的东西，我怎样才能实现我想要的，这基本上是一个逻辑 AND，只给我那些具有所有必需属性的产品？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-10T05:41:27.963

（为清楚起见进行了编辑。）

问题在于 foreach 循环，以及“a”变量被捕获然后每次都更改的事实。这是一个有效的修改，通过为循环的每次迭代有效地引入一个“新”变量，并捕获该新变量。

```
foreach (Attribute a in requiredAttributes)
{
    Attribute copy = a;
    result = result.Where(p => p.Attributes.Contains(copy));
} 
```

如果您可以使用 Omer 的解决方案，它是一个更干净的解决方案，但如果您的真实代码实际上更复杂，这可能会有所帮助:)

[编辑：这篇闭包文章](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)中有更多关于这个问题的信息- 向下滚动到“比较捕获策略：复杂性与功率”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-10T05:31:22.493

```
var result = from v in vendors
             from p in v.Products
             where requiredAttributes.All(a => p.Attributes.Contains(a))
             orderby p.Name
             select p; 
```

HTH。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T05:43:52.857

我没有把它编码，但改变

```
foreach (Attribute a in requiredAttributes){    
    result = result.Where(p => p.Attributes.Contains(a));
} 
```

到

```
foreach (Attribute a in requiredAttributes){    
    Attribute b = a;
    result = result.Where(p => p.Attributes.Contains(b));
} 
```

我想也应该解决它。

# c - Linux中的itoa函数在哪里？

> ID：190229
> 
> 赞同：157
> 
> 时间：2008-10-10T05:29:51.280
> 
> 标签：c, linux

`itoa()`是一个非常方便的函数，可以将数字转换为字符串。Linux好像没有`itoa()`，有没有等价的功能还是要我用`sprintf(str, "%d", num)`？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2008-10-10T05:31:24.177

编辑：对不起，我应该记得这台机器绝对是非标准的，为了学术目的插入了各种非标准`libc`实现；-)

正如`itoa()`一些有用的评论者所提到的那样，它确实是非标准的，最好使用`sprintf(target_string,"%d",source_int)`or (更好，因为它可以防止缓冲区溢出) `snprintf(target_string, size_of_target_string_in_bytes, "%d", source_int)`。我知道它不如 简洁或酷`itoa()`，但至少你可以写一次，到处运行（tm）;-)

## 这是旧的（已编辑）答案

您说默认`gcc libc`不包括是正确的`itoa()`，就像其他几个平台一样，因为它在技术上不是标准的一部分。请参阅[此处](http://www.cplusplus.com/reference/clibrary/cstdlib/itoa.html)了解更多信息。请注意，您必须

```
#include <stdlib.h> 
```

当然你已经知道这一点，因为你想在另一个平台上*使用* `itoa()`它之后在 Linux 上使用它，但是......代码（从上面的链接中窃取）看起来像：

**例子**

```
/* itoa example */
#include <stdio.h>
#include <stdlib.h>

int main ()
{
  int i;
  char buffer [33];
  printf ("Enter a number: ");
  scanf ("%d",&i);
  itoa (i,buffer,10);
  printf ("decimal: %s\n",buffer);
  itoa (i,buffer,16);
  printf ("hexadecimal: %s\n",buffer);
  itoa (i,buffer,2);
  printf ("binary: %s\n",buffer);
  return 0;
} 
```

**输出：**

> ```
> Enter a number: 1750
> decimal: 1750
> hexadecimal: 6d6
> binary: 11011010110 
> ```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-04-09T16:49:23.187

[`itoa`](http://en.wikibooks.org/wiki/C_Programming/C_Reference/stdlib.h/itoa)不是标准的 C 函数。你可以实现你自己的。它出现在*Kernighan*和*Ritchie 的* **The C Programming Language**的第一版，第 60 页。The C Programming Language 的第二版（“K&R2”）包含以下实现`itoa`，第 64 页。这本书指出了这个实现的几个问题，包括**它不能正确处理最负数**的事实

 **```
 /* itoa:  convert n to characters in s */
 void itoa(int n, char s[])
 {
     int i, sign;

     if ((sign = n) < 0)  /* record sign */
         n = -n;          /* make n positive */
     i = 0;
     do {       /* generate digits in reverse order */
         s[i++] = n % 10 + '0';   /* get next digit */
     } while ((n /= 10) > 0);     /* delete it */
     if (sign < 0)
         s[i++] = '-';
     s[i] = '\0';
     reverse(s);
} 
```

上面使用的函数`reverse`是在前两页实现的：

```
 #include <string.h>

 /* reverse:  reverse string s in place */
 void reverse(char s[])
 {
     int i, j;
     char c;

     for (i = 0, j = strlen(s)-1; i<j; i++, j--) {
         c = s[i];
         s[i] = s[j];
         s[j] = c;
     }
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-10T19:14:37.780

如果您经常调用它，“只使用 snprintf”的建议可能会很烦人。所以这就是你可能想要的：

```
const char *my_itoa_buf(char *buf, size_t len, int num)
{
  static char loc_buf[sizeof(int) * CHAR_BITS]; /* not thread safe */

  if (!buf)
  {
    buf = loc_buf;
    len = sizeof(loc_buf);
  }

  if (snprintf(buf, len, "%d", num) == -1)
    return ""; /* or whatever */

  return buf;
}

const char *my_itoa(int num)
{ return my_itoa_buf(NULL, 0, num); } 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-11-14T21:56:46.023

**编辑：**我刚刚发现[`std::to_string`](http://en.cppreference.com/w/cpp/string/basic_string/to_string)在下面的操作中与我自己的功能相同。它是在 C++11 中引入的，并且在最新版本的 gcc 中可用，如果启用 c++0x 扩展，至少早在 4.5 版本中可用。

* * *

gcc不仅`itoa`缺少它，而且它不是最方便使用的功能，因为您需要为其提供缓冲区。我需要一些可以在表达式中使用的东西，所以我想出了这个：

```
std::string itos(int n)
{
   const int max_size = std::numeric_limits<int>::digits10 + 1 /*sign*/ + 1 /*0-terminator*/;
   char buffer[max_size] = {0};
   sprintf(buffer, "%d", n);
   return std::string(buffer);
} 
```

通常使用它会更安全`snprintf`，`sprintf`但缓冲区的大小经过精心设计以防止溢出。

看一个例子：http: [//ideone.com/mKmZVE](http://ideone.com/mKmZVE)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-10T05:39:45.923

正如马特 J 所写，有`itoa`，但不是标准的。如果您使用`snprintf`.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-11-13T12:51:57.430

`sprintf`以下函数分配刚好足够的内存来保存给定数字的字符串表示，然后使用标准方法将字符串表示写入该区域。

```
char *itoa(long n)
{
    int len = n==0 ? 1 : floor(log10l(labs(n)))+1;
    if (n<0) len++; // room for negative sign '-'

    char    *buf = calloc(sizeof(char), len+1); // +1 for null
    snprintf(buf, len+1, "%ld", n);
    return   buf;
} 
```

不要忘记在`free`不需要时增加分配的内存：

```
char *num_str = itoa(123456789L);
// ... 
free(num_str); 
```

注意 因为 snprintf 复制 n-1 个字节，我们必须调用 snprintf(buf, len+1, "%ld", n) （不仅仅是 snprintf(buf, len, "%ld", n)）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-04-03T21:09:56.417

阅读那些以此为生的人的代码会让你走得很远。

看看 MySQL 的人是如何做到的。该来源得到了很好的评论，并且将教给您的不仅仅是到处找到的破解解决方案。

[MySQL 对 int2str 的实现](https://github.com/mysql/mysql-server/blob/5.7/strings/int2str.c)

我在这里提供了提到的实现；该链接供参考，应用于阅读完整的实现。

```
char *
int2str(long int val, char *dst, int radix, 
        int upcase)
{
  char buffer[65];
  char *p;
  long int new_val;
  char *dig_vec= upcase ? _dig_vec_upper : _dig_vec_lower;
  ulong uval= (ulong) val;

  if (radix < 0)
  {
    if (radix < -36 || radix > -2)
      return NullS;
    if (val < 0)
    {
      *dst++ = '-';
      /* Avoid integer overflow in (-val) for LLONG_MIN (BUG#31799). */
      uval = (ulong)0 - uval;
    }
    radix = -radix;
  }
  else if (radix > 36 || radix < 2)
    return NullS;

  /*
    The slightly contorted code which follows is due to the fact that
    few machines directly support unsigned long / and %.  Certainly
    the VAX C compiler generates a subroutine call.  In the interests
    of efficiency (hollow laugh) I let this happen for the first digit
    only; after that "val" will be in range so that signed integer
    division will do.  Sorry 'bout that.  CHECK THE CODE PRODUCED BY
    YOUR C COMPILER.  The first % and / should be unsigned, the second
    % and / signed, but C compilers tend to be extraordinarily
    sensitive to minor details of style.  This works on a VAX, that's
    all I claim for it.
  */
  p = &buffer[sizeof(buffer)-1];
  *p = '\0';
  new_val= uval / (ulong) radix;
  *--p = dig_vec[(uchar) (uval- (ulong) new_val*(ulong) radix)];
  val = new_val;
  while (val != 0)
  {
    ldiv_t res;
    res=ldiv(val,radix);
    *--p = dig_vec[res.rem];
    val= res.quot;
  }
  while ((*dst++ = *p++) != 0) ;
  return dst-1;
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-10-13T14:21:05.203

> Linux中的itoa函数在哪里？

Linux 中没有这样的功能。我改用这段代码。

```
/*
=============
itoa

Convert integer to string

PARAMS:
- value     A 64-bit number to convert
- str       Destination buffer; should be 66 characters long for radix2, 24 - radix8, 22 - radix10, 18 - radix16.
- radix     Radix must be in range -36 .. 36\. Negative values used for signed numbers.
=============
*/

char* itoa (unsigned long long  value,  char str[],  int radix)
{
    char        buf [66];
    char*       dest = buf + sizeof(buf);
    boolean     sign = false;

    if (value == 0) {
        memcpy (str, "0", 2);
        return str;
    }

    if (radix < 0) {
        radix = -radix;
        if ( (long long) value < 0) {
            value = -value;
            sign = true;
        }
    }

    *--dest = '\0';

    switch (radix)
    {
    case 16:
        while (value) {
            * --dest = '0' + (value & 0xF);
            if (*dest > '9') *dest += 'A' - '9' - 1;
            value >>= 4;
        }
        break;
    case 10:
        while (value) {
            *--dest = '0' + (value % 10);
            value /= 10;
        }
        break;

    case 8:
        while (value) {
            *--dest = '0' + (value & 7);
            value >>= 3;
        }
        break;

    case 2:
        while (value) {
            *--dest = '0' + (value & 1);
            value >>= 1;
        }
        break;

    default:            // The slow version, but universal
        while (value) {
            *--dest = '0' + (value % radix);
            if (*dest > '9') *dest += 'A' - '9' - 1;
            value /= radix;
        }
        break;
    }

    if (sign) *--dest = '-';

    memcpy (str, dest, buf +sizeof(buf) - dest);
    return str;
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-04-19T01:13:57.623

我尝试了自己的 itoa() 实现，它似乎可以在二进制、八进制、十进制和十六进制中使用

```
#define INT_LEN (10)
#define HEX_LEN (8)
#define BIN_LEN (32)
#define OCT_LEN (11)

static char *  my_itoa ( int value, char * str, int base )
{
    int i,n =2,tmp;
    char buf[BIN_LEN+1];

    switch(base)
    {
        case 16:
            for(i = 0;i<HEX_LEN;++i)
            {
                if(value/base>0)
                {
                    n++;
                }
            }
            snprintf(str, n, "%x" ,value);
            break;
        case 10:
            for(i = 0;i<INT_LEN;++i)
            {
                if(value/base>0)
                {
                    n++;
                }
            }
            snprintf(str, n, "%d" ,value);
            break;
        case 8:
            for(i = 0;i<OCT_LEN;++i)
            {
                if(value/base>0)
                {
                    n++;
                }
            }
            snprintf(str, n, "%o" ,value);
            break;
        case 2:
            for(i = 0,tmp = value;i<BIN_LEN;++i)
            {
                if(tmp/base>0)
                {
                    n++;
                }
                tmp/=base;
            }
            for(i = 1 ,tmp = value; i<n;++i)
            {
                if(tmp%2 != 0)
                {
                    buf[n-i-1] ='1';
                }
                else
                {
                    buf[n-i-1] ='0';
                }
                tmp/=base;
            }
            buf[n-1] = '\0';
            strcpy(str,buf);
            break;
        default:
            return NULL;
    }
    return str;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-01-18T07:29:42.540

直接复制到缓冲区：64 位整数 itoa 十六进制：

```
 char* itoah(long num, char* s, int len)
    {
            long n, m = 16;
            int i = 16+2;
            int shift = 'a'- ('9'+1);

            if(!s || len < 1)
                    return 0;

            n = num < 0 ? -1 : 1;
            n = n * num;

            len = len > i ? i : len;
            i = len < i ? len : i;

            s[i-1] = 0;
            i--;

            if(!num)
            {
                    if(len < 2)
                            return &s[i];

                    s[i-1]='0';
                    return &s[i-1];
            }

            while(i && n)
            {
                    s[i-1] = n % m + '0';

                    if (s[i-1] > '9')
                            s[i-1] += shift ;

                    n = n/m;
                    i--;
            }

            if(num < 0)
            {
                    if(i)
                    {
                            s[i-1] = '-';
                            i--;
                    }
            }

            return &s[i];
    } 
```

注意：对于 32 位机器，将 long 更改为 long long。对于 32 位整数，long 为 int。m 是基数。减少基数时，增加字符数（变量 i）。增加基数时，减少字符数（更好）。在无符号数据类型的情况下，i 变为 16 + 1。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-04-16T16:49:09.890

这是 Archana 解决方案的改进版本。它适用于任何基数 1-16 和数字 <= 0，并且它不应该破坏内存。

```
static char _numberSystem[] = "0123456789ABCDEF";
static char _twosComp[] = "FEDCBA9876543210";

static void safestrrev(char *buffer, const int bufferSize, const int strlen)
{
    int len = strlen;
    if (len > bufferSize)
    {
        len = bufferSize;
    }
    for (int index = 0; index < (len / 2); index++)
    {
        char ch = buffer[index];
        buffer[index] = buffer[len - index - 1];
        buffer[len - index - 1] = ch;
    }
}

static int negateBuffer(char *buffer, const int bufferSize, const int strlen, const int radix)
{
    int len = strlen;
    if (len > bufferSize)
    {
        len = bufferSize;
    }
    if (radix == 10)
    {
        if (len < (bufferSize - 1))
        {
            buffer[len++] = '-';
            buffer[len] = '\0';
        }
    }
    else
    {
        int twosCompIndex = 0;
        for (int index = 0; index < len; index++)
        {
            if ((buffer[index] >= '0') && (buffer[index] <= '9'))
            {
                twosCompIndex = buffer[index] - '0';
            }
            else if ((buffer[index] >= 'A') && (buffer[index] <= 'F'))
            {
                twosCompIndex = buffer[index] - 'A' + 10;
            }
            else if ((buffer[index] >= 'a') && (buffer[index] <= 'f'))
            {
                twosCompIndex = buffer[index] - 'a' + 10;
            }
            twosCompIndex += (16 - radix);
            buffer[index] = _twosComp[twosCompIndex];
        }
        if (len < (bufferSize - 1))
        {
            buffer[len++] = _numberSystem[radix - 1];
            buffer[len] = 0;
        }
    }
    return len;
}

static int twosNegation(const int x, const int radix)
{
    int n = x;
    if (x < 0)
    {
        if (radix == 10)
        {
            n = -x;
        }
        else
        {
            n = ~x;
        }
    }
    return n;
}

static char *safeitoa(const int x, char *buffer, const int bufferSize, const int radix)
{
    int strlen = 0;
    int n = twosNegation(x, radix);
    int nuberSystemIndex = 0;

    if (radix <= 16)
    {
        do
        {
            if (strlen < (bufferSize - 1))
            {
                nuberSystemIndex = (n % radix);
                buffer[strlen++] = _numberSystem[nuberSystemIndex];
                buffer[strlen] = '\0';
                n = n / radix;
            }
            else
            {
                break;
            }
        } while (n != 0);
        if (x < 0)
        {
            strlen = negateBuffer(buffer, bufferSize, strlen, radix);
        }
        safestrrev(buffer, bufferSize, strlen);
        return buffer;
    }
    return NULL;
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-01-16T17:40:33.667

如果您只想打印它们：

```
void binary(unsigned int n)
{
    for(int shift=sizeof(int)*8-1;shift>=0;shift--)
    {
       if (n >> shift & 1)
         printf("1");
       else
         printf("0");

    }
    printf("\n");
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-04-09T17:11:07.823

> Linux中的itoa函数在哪里？

由于`itoa()`不是 C 中的标准，存在具有各种函数签名的各种版本。
`char *itoa(int value, char *str, int base);`在 *nix 中很常见。

如果 Linux 缺少它，或者如果代码不想限制可移植性，代码可以让它拥有。

下面是一个没有问题`INT_MIN`并处理问题缓冲区的版本：`NULL`或缓冲区不足返回`NULL`。

```
#include <stdlib.h>
#include <limits.h>
#include <string.h>

// Buffer sized for a decimal string of a `signed int`, 28/93 > log10(2)
#define SIGNED_PRINT_SIZE(object)  ((sizeof(object) * CHAR_BIT - 1)* 28 / 93 + 3)

char *itoa_x(int number, char *dest, size_t dest_size) {
  if (dest == NULL) {
    return NULL;
  }

  char buf[SIGNED_PRINT_SIZE(number)];
  char *p = &buf[sizeof buf - 1];

  // Work with negative absolute value
  int neg_num = number < 0 ? number : -number;

  // Form string
  *p = '\0';
  do {
    *--p = (char) ('0' - neg_num % 10);
    neg_num /= 10;
  } while (neg_num);
  if (number < 0) {
    *--p = '-';
  }

  // Copy string
  size_t src_size = (size_t) (&buf[sizeof buf] - p);
  if (src_size > dest_size) {
    // Not enough room
    return NULL;
  }
  return memcpy(dest, p, src_size);
} 
```

* * *

以下是处理任何基础 [2...36] 的 C99 或更高版本

```
char *itoa_x(int number, char *dest, size_t dest_size, int base) {
  if (dest == NULL || base < 2 || base > 36) {
    return NULL;
  }

  char buf[sizeof number * CHAR_BIT + 2]; // worst case: itoa(INT_MIN,,,2)
  char *p = &buf[sizeof buf - 1];

  // Work with negative absolute value to avoid UB of `abs(INT_MIN)`
  int neg_num = number < 0 ? number : -number;

  // Form string
  *p = '\0';
  do {
    *--p = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[-(neg_num % base)];
    neg_num /= base;
  } while (neg_num);
  if (number < 0) {
    *--p = '-';
  }

  // Copy string
  size_t src_size = (size_t) (&buf[sizeof buf] - p);
  if (src_size > dest_size) {
    // Not enough room
    return NULL;
  }
  return memcpy(dest, p, src_size);
} 
```

对于符合 C89 及更高版本的代码，将内部循环替换为

```
 div_t qr;
  do {
    qr = div(neg_num, base);
    *--p = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[-qr.rem];
    neg_num = qr.quot;
  } while (neg_num); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-09-01T11:58:56.160

**glibc 内部实现**

glibc 2.28 有一个内部实现：

*   [stdio-common/_itoa.c](https://sourceware.org/git/?p=glibc.git;a=blob;f=stdio-common/_itoa.c;h=3749ee97e320ceb62cbf76b6c93dd2beb38fe157;hb=3c03baca37fdcb52c3881e653ca392bba7a99c2b)
*   [sysdeps/generic/_itoa.h](https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/generic/_itoa.h;h=3749ee97e320ceb62cbf76b6c93dd2beb38fe157;hb=3c03baca37fdcb52c3881e653ca392bba7a99c2b)

它在内部的几个地方使用，但我找不到它是否可以暴露或如何暴露。

如果您愿意提取它，至少这应该是一个强大的实现。

这个问题问如何自己动手：[How to convert an int to string in C?](https://stackoverflow.com/questions/8257714/how-to-convert-an-int-to-string-in-c)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-08-12T06:02:04.527

我更喜欢这个：[https ://github.com/wsq003/itoa_for_linux](https://github.com/wsq003/itoa_for_linux)

它应该是有史以来最快的 itoa()。出于性能原因，我们使用 itoa() 而不是 sprintf()，因此具有有限功能的最快 itoa() 是合理且值得的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-04-14T09:56:13.267

用 snprintf 替换是不完整的！

它仅涵盖碱基：2、8、10、16，而 itoa 适用于 2 到 36 之间的碱基。

由于我正在寻找 base 32 的替代品，我想我必须自己编写代码！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-10T15:46:42.643

我在 RedHat 6 和 GCC 编译器上使用了 _itoa(...)。有用。

* * *

## 回答 #18

> 赞同：-5
> 
> 时间：2012-08-23T05:34:12.533

您可以使用此程序代替 sprintf。

```
void itochar(int x, char *buffer, int radix);

int main()
{
    char buffer[10];
    itochar(725, buffer, 10);
    printf ("\n %s \n", buffer);
    return 0;
}

void itochar(int x, char *buffer, int radix)
{
    int i = 0 , n,s;
    n = s;
    while (n > 0)
    {
        s = n%radix;
        n = n/radix;
        buffer[i++] = '0' + s;
    }
    buffer[i] = '\0';
    strrev(buffer);
} 
```

# c++ - 递归函数可以内联吗？

> ID：190232
> 
> 赞同：147
> 
> 时间：2008-10-10T05:30:44.460
> 
> 标签：c++, c, compiler-construction

```
inline int factorial(int n)
{
    if(!n) return 1;
    else return n*factorial(n-1);
} 
```

在阅读[本文](https://rads.stackoverflow.com/amzn/click/com/0201543303)时，发现如果编译器未正确处理上述代码，将导致“无限编译”。

编译器如何决定是否内联函数？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2008-10-10T05:47:13.117

首先，`inline`函数的规范只是一个提示。`inline`编译器可以（并且经常这样做）完全忽略限定符的存在或不存在。话虽如此，编译器*可以*内联递归函数，就像它可以展开无限循环一样。它只需对将“展开”该功能的级别设置一个限制。

优化编译器可能会转换此代码：

```
inline int factorial(int n)
{
    if (n <= 1)
    {
        return 1;
    }
    else
    {
        return n * factorial(n - 1);
    }
}

int f(int x)
{
    return factorial(x);
} 
```

进入这段代码：

```
int factorial(int n)
{
    if (n <= 1)
    {
        return 1;
    }
    else
    {
        return n * factorial(n - 1);
    }
}

int f(int x)
{
    if (x <= 1)
    {
        return 1;
    }
    else
    {
        int x2 = x - 1;
        if (x2 <= 1)
        {
            return x * 1;
        }
        else
        {
            int x3 = x2 - 1;
            if (x3 <= 1)
            {
                return x * x2 * 1;
            }
            else
            {
                return x * x2 * x3 * factorial(x3 - 1);
            }
        }
    }
} 
```

在这种情况下，我们基本上已经将函数内联了 3 次。一些编译器*确实*执行了这种优化。我记得 MSVC++ 有一个设置来调整将在递归函数上执行的内联级别（我相信最多 20 个）。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-10T05:42:29.803

事实上，如果你的编译器没有智能地行动，它可能会尝试`inline`递归地插入你的 d 函数的副本，从而创建无限大的代码。然而，大多数现代编译器都会认识到这一点。他们可以：

1.  根本没有内联函数
2.  将它内联到一定深度，如果到那时它还没有终止，请使用标准函数调用约定调用函数的单独实例。这可以以高性能的方式处理许多常见情况，同时为具有较大调用深度的罕见情况留下后备。这也意味着您保留了该函数代码的内联版本和单独版本。

对于情况 2，许多编译器都有`#pragma`s 您可以设置以指定应该执行此操作的最大深度。在*gcc*中，您也可以从命令行传入它（请参阅[此处](http://gcc.gnu.org/onlinedocs/gcc-4.0.4/gcc/Optimize-Options.html)`--max-inline-insns-recursive`的更多信息）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-10T05:56:47.793

如果可能的话，AFAIK GCC 将对递归函数进行尾调用消除。但是，您的函数不是尾递归的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-10T05:45:12.527

编译器创建一个调用图；当检测到循环调用自身时，函数在一定深度后不再内联（n = 1、10、100，无论编译器调整到什么）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-10T05:50:24.920

请参阅已经给出的答案，了解为什么这通常不起作用。

[作为“脚注”，您可以使用模板元编程](http://en.wikipedia.org/wiki/Template_metaprogramming#Compile-time_class_generation)实现您正在寻找的效果（至少对于您作为示例使用的阶乘）。从维基百科粘贴：

```
template <int N>
struct Factorial 
{
    enum { value = N * Factorial<N - 1>::value };
};

template <>
struct Factorial<0> 
{
    enum { value = 1 };
}; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-16T19:53:55.420

一些递归函数可以转换为循环，从而有效地无限内联它们。我相信 gcc 可以做到这一点，但我不知道其他编译器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T05:36:45.633

编译器将创建一个调用图来检测这些事情并阻止它们。所以它会看到函数调用自己而不是内联。

但主要是由 inline 关键字和编译器开关控制（例如，即使没有关键字，您也可以让它自动内联小函数。）重要的是要注意调试编译永远不应该内联，因为调用堆栈不会被保留到镜像您在代码中创建的调用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-10T05:50:15.230

“编译器如何决定是否内联函数？”

这取决于编译器、指定的选项、编译器的版本号、可能有多少可用内存等。

程序的源代码仍然必须遵守内联函数的规则。无论函数是否被内联，您都必须为它被内联的可能性做准备（一些未知的次数）。

递归宏通常是非法的 Wikipedia 声明看起来相当缺乏信息。C 和 C++ 防止递归调用，但翻译单元不会因为包含看起来像递归的宏代码而变得非法。在汇编器中，递归宏通常是合法的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T05:08:58.573

一些编译器（即 Borland C++）不会内联包含条件语句（if、case、while 等）的代码，因此您的示例中的递归函数不会被内联。

# c# - 如何在 .NET 中进行线程转储？（一个 JVM 线程转储）

> ID：190236
> 
> 赞同：28
> 
> 时间：2008-10-10T05:31:47.343
> 
> 标签：c#, .net

我发现无法在 .NET 中的所有线程上转储堆栈。既不是要发送到进程的信号，也不是对所有线程的编程访问。我只能通过 Thread.CurrentThread 访问当前线程。

有什么技巧吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-18T14:55:09.117

如果您在进程已经运行时尝试获取堆栈转储（a la jstack），则有两种方法，如下[所述](http://www.tomergabel.com/NETProductionDebugging101.aspx)：

### 使用托管堆栈资源管理器

有一个鲜为人知但有效的工具，称为[Managed Stack Explorer](http://www.tomergabel.com/ct.ashx?id=1db72c20-3c25-42ad-93c4-b0551a0fed4e&url=http%3a%2f%2fwww.microsoft.com%2fdownloads%2fdetails.aspx%3fFamilyID%3d80CF81F7-D710-47E3-8B95-5A6555A230C2%26displaylang%3den)。尽管它具有基本的 GUI，但如果添加到路径中，它可以有效地成为 jstack 的 .NET 等效项；那么这只是一个打字的问题：

```
mse /s /p *<pid>*
```

### 使用windbg

1.  下载并安装适用于您的体系结构 (x86/x64/Itanium) 的适用于 Windows 的调试工具
2.  如果您需要有关 Windows 函数调用的信息（例如，您想跟踪内核调用），请下载并安装相应的符号。如果您只想要自己代码的线程转储，这不是绝对必要的。
3.  如果您需要行号或任何其他详细信息，请确保将程序集的 PDB 文件放在调试器可以找到它们的位置（通常您只需将它们放在实际程序集旁边）。
4.  开始->程序->Windows [x64] 调试工具->windbg
5.  使用菜单将调试器附加到正在运行的进程
6.  使用 .NET 2.0 的“.loadby sos mscorwks”加载 SOS 扩展（.NET 1.0/1.1 的“.load sos”）
7.  使用“！eestack”进行线程转储
8.  使用“.detach”分离

我只是发现有必要进行生产线程转储，这对我有用。希望能帮助到你 ：-）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-05T16:04:03.313

Just to save anyone else the bother here's the port of the above to c#:

```
 static void WriteThreadInfo(StringBuilder sw, IEnumerable<Thread> threads)
    {
        foreach(Thread thread in threads)
        {
            if(!thread.IsAlive) continue;
            sw.Append(String.Concat("THREAD NAME: ", thread.Name));

            sw.Append(GetStackTrace(thread));
            sw.AppendLine();
            sw.AppendLine();
        }
    }

    static String GetStackTrace(Thread t)
    {
        t.Suspend();
        var trace1 = new StackTrace(t, true);
        t.Resume();

        String  text1 = System.Environment.NewLine;
        var builder1 = new StringBuilder(255);
        for (Int32 num1 = 0; (num1 < trace1.FrameCount); num1++)
        {
            StackFrame  frame1 = trace1.GetFrame(num1);
            builder1.Append("   at ");
            System.Reflection.MethodBase  base1 = frame1.GetMethod();
            Type  type1 = base1.DeclaringType;
            if (type1 != null)
            {
                String  text2 = type1.Namespace;
                if (text2 != null)
                {
                    builder1.Append(text2);
                    builder1.Append(".");                                                
                }
                builder1.Append(type1.Name);
                builder1.Append(".");
            }
            builder1.Append(base1.Name);
            builder1.Append("(");
            System.Reflection.ParameterInfo [] infoArray1 = base1.GetParameters();
            for (Int32 num2 = 0; (num2 < infoArray1.Length); num2++)
            {
                String text3 = "<UnknownType>";
                if (infoArray1[num2].ParameterType != null)
                {
                                text3 = infoArray1[num2].ParameterType.Name;
                }
                builder1.Append(String.Concat(((num2 != 0) ? ", " : ""), text3, " ", infoArray1[num2].Name));
            }
            builder1.Append(")");
            if (frame1.GetILOffset() != -1)
            {
                String text4 = null;
                try
                {
                    text4 = frame1.GetFileName();
                }
                catch (System.Security.SecurityException)
                {
                }
                if (text4 != null)
                {
                    builder1.Append(String.Concat(" in ", text4, ":line ", frame1.GetFileLineNumber().ToString()));
                }
            }
            if (num1 != (trace1.FrameCount - 1))
            {
                builder1.Append(text1);
            }
        }
        return builder1.ToString();
    } 
```

I've not found a way to get a list of all managed threads in C# (only ProcessThreads), so it does look like you need to maintain the list of threads your interested in yourself.

Also I found I couldn't call new Stacktrace(t,true) on a running thread, so have added pause and resumes. *Obviously you'll need to consider whether this could cause problems were you to thread dump your production app*.

btw, we've put this call on our apps wcf rest interface so it's easy to do.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-30T15:29:14.917

目前我看到的为 .NET CLR 生成线程转储的最佳工具是 DebugDiag。此工具将生成活动 CLR 线程的非常详细的报告（使用 Crash/Hang 分析器）以及建议。

我建议查看以下[.NET DebugDiag 教程](http://javaeesupportpatterns.blogspot.com/2011/10/net-framework-4-debugdiag-tutorial.html)，因为它显示了生产问题后的分析过程。步骤如下：

*   创建受影响的 w3wp 进程的转储文件
*   启动调试诊断工具，选择并启动崩溃/挂起分析器。
*   打开并分析报告分析概览。
*   最后，查看阻塞的线程摘要并执行更深入的潜水分析。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-22T12:24:19.690

如果您需要以编程方式执行此操作（也许您希望在 CI 过程中自动转储），您可以使用[此答案](https://stackoverflow.com/a/35558240/567000)中的信息来解决不同的问题。

[基本上，使用CLR MD](https://github.com/Microsoft/clrmd)附加到您自己的进程：

```
using Microsoft.Diagnostics.Runtime;

using (DataTarget target = DataTarget.AttachToProcess(
    Process.GetCurrentProcess().Id, 5000, AttachFlag.Passive))
{
    ClrRuntime runtime = target.ClrVersions.First().CreateRuntime();
    foreach (ClrThread thread in runtime.Threads)
    {
        IList<ClrStackFrame> stackFrames = thread.StackTrace;
        PrintStackTrace(stackFrames);            
    }
} 
```

这里 PrintStackTrace 留给读者作为练习。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T05:48:08.807

我为我过去从事的一个项目写了一个垃圾箱：

```
void CrashHandler::WriteThreadInfo(StringWriter* sw, ArrayList* threads, String* type)
{
    sw->WriteLine(type);

    IEnumerator* ie = threads->GetEnumerator();
    while(ie->MoveNext())
    {
        botNETThread* bnt = static_cast<botNETThread*>(ie->Current);
        if(!bnt->IsAlive) continue;
        sw->WriteLine(String::Concat(S"ORIGIN ASSEMBLY: ", bnt->Assembly->FullName));
        sw->WriteLine(String::Concat(S"THREAD NAME: ", (bnt->Name && bnt->Name->Length)?bnt->Name:S"Unnamed thread"));

        sw->Write(GetStackTrace(bnt->_thread));
        sw->WriteLine();
        sw->WriteLine();
    }
}

String* CrashHandler::GetStackTrace(Thread* t)
{

    System::Diagnostics::StackTrace __gc * trace1 = __gc new System::Diagnostics::StackTrace(t, true);

    System::String __gc * text1 = System::Environment::NewLine;
    System::Text::StringBuilder __gc * builder1 = __gc new System::Text::StringBuilder(255);
    for (System::Int32 num1 = 0; (num1 < trace1->FrameCount); num1++)
    {
            System::Diagnostics::StackFrame __gc * frame1 = trace1->GetFrame(num1);
            builder1->Append(S"   at ");
            System::Reflection::MethodBase __gc * base1 = frame1->GetMethod();
            System::Type __gc * type1 = base1->DeclaringType;
            if (type1 != 0)
            {
                System::String __gc * text2 = type1->Namespace;
                if (text2 != 0)
                {
                        builder1->Append(text2);
                        if (builder1 != 0)
                        {
                            builder1->Append(S".");
                        }
                }
                builder1->Append(type1->Name);
                builder1->Append(S".");
            }
            builder1->Append(base1->Name);
            builder1->Append(S"(");
            System::Reflection::ParameterInfo __gc * infoArray1 __gc [] = base1->GetParameters();
            for (System::Int32 num2 = 0; (num2 < infoArray1->Length); num2++)
            {
                System::String __gc * text3 = S"<UnknownType>";
                if (infoArray1[num2]->ParameterType != 0)
                {
                        text3 = infoArray1[num2]->ParameterType->Name;
                }
                builder1->Append(System::String::Concat(((num2 != 0) ? S", " : S""), text3, S" ", infoArray1[num2]->Name));
            }
            builder1->Append(S")");
            if (frame1->GetILOffset() != -1)
            {
                System::String __gc * text4 = 0;
                try
                {
                        text4 = frame1->GetFileName();
                }
                catch (System::Security::SecurityException*)
                {
                }
                if (text4 != 0)
                {
                        builder1->Append(System::String::Concat(S" in ", text4, S":line ", frame1->GetFileLineNumber().ToString()));
                }
            }
            if (num1 != (trace1->FrameCount - 1))
            {
                builder1->Append(text1);
            }
    }
    return builder1->ToString();

} 
```

您可以使用 Process.GetCurrentProcess().Threads 来获取线程

而且我知道我对托管 C++ 感到厌烦，但它很容易理解。我采用了一个线程数组列表，因为出于我的目的，我已经对我的线程进行了分类。是的，我使用了以前编写的堆栈帧代码，因为我当时是 MC++ 的新手 :)

整个文件在[这里](http://mattlant.com/CrashHandler.cpp)。这是我前段时间写的一个[暗黑破坏神II机器人引擎。](http://www.d2botnet.org)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T05:38:29.670

System.Diagnostics 中有各种方便的类可以帮助您调试和收集各种跟踪信息，即 StackTrace。

有一个不稳定的 Process 类可用于获取执行线程的数量，但细节很少。使用以下代码段：

```
Using  System.Diagnostics;

var threads = Process.GetCurrentProcess().Threads; 
```

好吧，在多看一点之后，似乎捕获所有当前堆栈的最简单方法是通过小型转储和[SOS](http://msdn.microsoft.com/en-us/magazine/cc163833.aspx)之类的工具，或者如果您正在运行 vista [this](http://www.nynaeve.net/?p=156.)。

祝你好运。

# version-control - 如何通过命令行从 CVS 获取新添加文件的特定版本？

> ID：190243
> 
> 赞同：8
> 
> 时间：2008-10-10T05:35:54.357
> 
> 标签：version-control, command-line, cvs

我们内部编写的工具之一提供了一个 cvs 提交跟踪，格式如下：

```
Checking in src/com/package/AFile.java;
    /home/cvs/src/com/package/AFile.java,v <-- Afile.java
    new revision: 1.1.2.56; previous revision: 1.1.2.55
    done 
```

`cvs update -r 1.1.2.56`然后，该工具通过在已经签出特定代码分支的工作目录中发出命令，从 cvs 获取文件。

如果工作目录中存在**AFile.java**的现有版本，则此命令可以正常工作。但是当我们在工作目录中找到一个没有版本的文件时，该命令无法获取该文件。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-10T06:21:19.397

目前尚不清楚您的最终目标是什么：使整个存储库进入所需状态（选择所选分支的修订版）或从存储库获取单个文件以进行进一步处理。我认为是后者。

然后，你需要这个命令：

```
cvs checkout -r <revision> -p filename.ext > ~/tmp/filename.ext 
```

这将转储到 stdout 指定文件（或文件）的指定修订版，可以将其重定向到临时位置并进行处理。

或者你可以使用：

```
cvs export -r <revision> -d ~/tmp module/filename.ext 
```

，它将（部分）存储库导出到指定的目标目录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-22T15:19:54.143

`cvs --help`

告诉您可以使用`-H`arg 来查看特定 CVS 命令的帮助，如下所示：

```
$ cvs -H checkout
Usage:
  cvs checkout [-ANPRcflnps] [-r rev] [-D date] [-d dir]
    [-j rev1] [-j rev2] [-k kopt] modules...
        -A      Reset any sticky tags/date/kopts.
        -N      Don't shorten module paths if -d specified.
        -P      Prune empty directories.
        -R      Process directories recursively.
        -c      "cat" the module database.
        -f      Force a head revision match if tag/date not found.
        -l      Local directory only, not recursive
        -n      Do not run module program (if any).
        -p      Check out files to standard output (avoids stickiness).
        -s      Like -c, but include module status.
        -r rev  Check out revision or tag. (implies -P) (is sticky)
        -D date Check out revisions as of date. (implies -P) (is sticky)
        -d dir  Check out into dir instead of module name.
        -k kopt Use RCS kopt -k option on checkout. (is sticky)
        -j rev  Merge in changes made between current revision and rev.
(Specify the --help global option for a list of other help options) 
```

...教一个人如何钓鱼... :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-03T09:58:54.437

我已经尝试如下方式

```
cvs checkout -r <revision> -p filename.ext > ~/tmp/filename.ext 
```

它给出了类似的错误

```
cvs checkout: cannot find module `filename.ext` -ignored. 
```

所以我按照以下方式完成了

```
cvs checkout -r <revision> -p Module_name/path_to_file/filename.ext > ~/tmp/filename.ext 
```

现在它工作得很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T06:07:18.833

一种解决方案是更改工具以发布文件的“cvs co”，指定修订版，就像现在的更新一样。checkout 命令必须从树的顶部完成，而不是在包含文件的目录中。我遇到过类似的情况，更新无法找到新文件，需要检查文件，正如我所描述的那样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-15T15:49:01.857

这是对我有用的唯一方法，因为 checkout 命令总是给出“找不到模块”错误：

```
cvs diff -r <revision> <file> > /tmp/patch
cp <file> /tmp
cd /tmp
patch -R < patch 
```

似乎 cvs 在这件事上丢了球。

# mysql - 您可以在 MySQL 中将一个别名除以另一个别名吗？

> ID：190251
> 
> 赞同：9
> 
> 时间：2008-10-10T05:40:38.760
> 
> 标签：mysql

我有一个多表查询，类似于这个（简化版）

```
SELECT columns, count(table2.rev_id) As rev_count, sum(table2.rev_rating) As sum_rev_rating 
FROM table1
LEFT JOIN table2
ON table1.dom_id = table2.rev_domain_from 
WHERE dom_lastreview != 0 AND rev_status = 1 
GROUP BY dom_url 
ORDER BY sum_rev_rating/rev_count DESC 
```

问题出在`ORDER BY`条款中。这会导致显示 MySQL 错误，如下所示：

> 不支持引用“sum_rev_rating”（引用组函数）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-10T06:36:23.967

您无法使用别名进行计算。这样做的一种方法是简单地创建另一个别名并按此排序。

```
SELECT columns, count(table2.rev_id) As rev_count, sum(table2.rev_rating) As sum_rev_rating, sum(table2.rev_rating)/count(table2.rev_id) as avg_rev_rating
FROM table1
LEFT JOIN table2
ON table1.dom_id = table2.rev_domain_from 
WHERE dom_lastreview != 0 AND rev_status = 1 
GROUP BY dom_url 
ORDER BY avg_rev_rating DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T06:23:48.830

我的 mysql 生锈了；你可以试试

```
SELECT columns, count(table2.rev_id) As rev_count, 
    sum(table2.rev_rating) As sum_rev_rating,
    sum(table2.rev_rating)/count(table2.rev_id) as rev_ratio
FROM table1
    LEFT JOIN table2ON table1.dom_id = table2.rev_domain_from 
WHERE dom_lastreview != 0 
AND rev_status = 1 
GROUP BY dom_url 
ORDER BY rev_Ratio DESC 
```

或者

```
SELECT * from (
    SELECT columns, count(table2.rev_id) As rev_count, 
        sum(table2.rev_rating) As sum_rev_rating 
    FROM table1
        LEFT JOIN table2ON table1.dom_id = table2.rev_domain_from 
    WHERE dom_lastreview != 0 
    AND rev_status = 1 
    GROUP BY dom_url 
) X
ORDER BY X.sum_rev_rating/X.rev_count DESC 
```

或者

```
SELECT * from (
    SELECT columns, count(table2.rev_id) As rev_count, 
        sum(table2.rev_rating) As sum_rev_rating,
        sum(table2.rev_rating)/count(table2.rev_id) as rev_ratio
    FROM table1
        LEFT JOIN table2ON table1.dom_id = table2.rev_domain_from 
    WHERE dom_lastreview != 0 
    AND rev_status = 1 
    GROUP BY dom_url 
) X
ORDER BY rev_Ratio DESC 
```

# javascript - jQuery 选择器正则表达式

> ID：190253
> 
> 赞同：622
> 
> 时间：2008-10-10T05:40:48.353
> 
> 标签：javascript, jquery, regex, jquery-selectors

我正在使用 jQuery 选择器使用通配符或正则表达式（不确定确切的术语）的文档。

我自己找过这个，但找不到有关语法和如何使用它的信息。有谁知道语法的文档在哪里？

编辑：属性过滤器允许您根据属性值的模式进行选择。

* * *

## 回答 #1

> 赞同：764
> 
> 时间：2008-10-11T07:06:22.460

您可以使用该[`filter`](http://docs.jquery.com/Traversing/filter#expr)功能应用更复杂的正则表达式匹配。

这是一个仅匹配前三个 div 的示例：

```
$('div')
  .filter(function() {
    return this.id.match(/abc+d/);
  })
  .html("Matched!");
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div id="abcd">Not matched</div>
<div id="abccd">Not matched</div>
<div id="abcccd">Not matched</div>
<div id="abd">Not matched</div>
```

* * *

## 回答 #2

> 赞同：355
> 
> 时间：2008-10-10T05:41:58.557

James Padolsey 创建了一个[很棒的过滤器](http://james.padolsey.com/javascript/regex-selector-for-jquery/)，允许使用正则表达式进行选择。

假设您有以下内容`div`：

```
<div class="asdf"> 
```

Padolsey 的`:regex`过滤器可以像这样选择它：

```
$("div:regex(class, .*sd.*)") 
```

另外，请查看[有关 selectors 的官方文档](http://docs.jquery.com/Selectors)。

## 更新：`:`语法弃用 JQuery 3.0

由于`jQuery.expr[':']`在 Padolsey 的实现中使用的已经被弃用并且会在最新版本的 jQuery 中呈现语法错误，这里是他的代码适应 jQuery 3+ 语法：

```
jQuery.expr.pseudos.regex = jQuery.expr.createPseudo(function (expression) {
    return function (elem) {
        var matchParams = expression.split(','),
            validLabels = /^(data|css):/,
            attr = {
                method: matchParams[0].match(validLabels) ?
                    matchParams[0].split(':')[0] : 'attr',
                property: matchParams.shift().replace(validLabels, '')
            },
            regexFlags = 'ig',
            regex = new RegExp(matchParams.join('').replace(/^\s+|\s+$/g, ''), regexFlags);
        return regex.test(jQuery(elem)[attr.method](attr.property));
    }
}); 
```

* * *

## 回答 #3

> 赞同：326
> 
> 时间：2014-07-14T15:59:04.623

这些可能会有所帮助。

如果你是通过**Contains**找到的，那么它会是这样的

```
 $("input[id*='DiscountType']").each(function (i, el) {
         //It'll be an array of elements
     }); 
```

如果你是通过**Starts With**找到的，那么它会是这样的

```
 $("input[id^='DiscountType']").each(function (i, el) {
         //It'll be an array of elements
     }); 
```

如果你是通过**Ends With**找到的，那么它会是这样的

```
 $("input[id$='DiscountType']").each(function (i, el) {
         //It'll be an array of elements
     }); 
```

如果要选择**id 不是给定字符串的元素**

```
 $("input[id!='DiscountType']").each(function (i, el) {
         //It'll be an array of elements
     }); 
```

如果要选择**名称包含给定单词的元素，以空格分隔**

```
 $("input[name~='DiscountType']").each(function (i, el) {
         //It'll be an array of elements
     }); 
```

如果要选择**id 等于给定字符串或以该字符串开头后跟连字符的元素**

```
 $("input[id|='DiscountType']").each(function (i, el) {
         //It'll be an array of elements
     }); 
```

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2013-11-05T11:43:56.540

如果您对正则表达式的使用仅限于测试属性是否以某个字符串开头，则可以使用`^`JQuery 选择器。

例如，如果您只想选择 id 以“abc”开头的 div，您可以使用：

```
$("div[id^='abc']") 
```

可以在这里找到很多非常有用的选择器来避免使用正则表达式：http: [//api.jquery.com/category/selectors/attribute-selectors/](http://api.jquery.com/category/selectors/attribute-selectors/)

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2012-03-29T14:22:44.557

```
var test = $('#id').attr('value').match(/[^a-z0-9 ]+/); 
```

干得好！

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2015-08-21T04:55:04.230

添加一个jQuery函数，

```
(function($){
    $.fn.regex = function(pattern, fn, fn_a){
        var fn = fn || $.fn.text;
        return this.filter(function() {
            return pattern.test(fn.apply($(this), fn_a));
        });
    };
})(jQuery); 
```

然后，

```
$('span').regex(/Sent/) 
```

将选择所有文本匹配 /Sent/ 的 span 元素。

```
$('span').regex(/tooltip.year/, $.fn.attr, ['class']) 
```

将选择所有类匹配 /tooltip.year/ 的 span 元素。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-04-28T14:47:44.040

ids 和 classes 仍然是属性，因此如果您相应地选择，您可以对它们应用正则表达式属性过滤器。在这里阅读更多： [http ://rosshawkins.net/archive/2011/10/14/jquery-wildcard-selectors-some-simple-examples.aspx](http://rosshawkins.net/archive/2011/10/14/jquery-wildcard-selectors-some-simple-examples.aspx)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-12-09T11:24:33.540

```
$("input[name='option[colour]'] :checked ") 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-02-18T04:27:27.650

我只是给出我的实时示例：

在本机 javascript 中，我使用以下代码段来查找 ID 以“select2-qownerName_select-result”开头的元素。

`document.querySelectorAll("[id^='select2-qownerName_select-result']");`

当我们从 javascript 转移到 jQuery 时，我们已将上面的代码段替换为以下代码，这涉及更少的代码更改而不会干扰逻辑。

`$("[id^='select2-qownerName_select-result']")`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-11-21T08:15:05.650

如果您只想选择包含给定字符串的元素，则可以使用以下选择器：

`$(':contains("search string")')`

# ruby-on-rails - 最佳基于角色的访问控制 (RBAC) 数据库模型

> ID：190257
> 
> 赞同：50
> 
> 时间：2008-10-10T05:42:48.927
> 
> 标签：ruby-on-rails, permissions, roles, access-control, rbac

跟踪 Web 应用程序基于角色的访问控制的最佳数据库模式是什么？

我正在使用 Rails，但是 Google 链接的 RBAC 插件看起来没有维护（只有 300 次提交到 SVN；最新的是差不多一年前）。

这个概念很简单，可以从头开始实施，但又足够复杂和重要，值得一试。

那么其他人如何构建和实现他们的 RBAC 模型呢？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-10-12T14:36:01.070

就我在该领域的基本知识而言，RBAC 的基本参与者是：

*   资源。
*   权限。
*   用户。
*   角色（即组）。

**资源**<-需要->（*一个或多个*）**权限**。

**角色**<- 是 ->（*一个或多个*）**权限**的集合。

**用户**<-可以拥有->（*一个或多个*）**角色**。

这种模型的表格将是：

*   允许
*   角色
*   用户
*   角色权限
*   用户角色

现在，如果您希望应用程序的用户能够配置资源所需的权限，您可能还希望在此处包含资源。但我从来不需要那个。希望有帮助。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-01-21T09:50:26.140

这是一个简单的图表来说明[Amr Mostafa 的出色答案](https://stackoverflow.com/a/195556/399759)

![在此处输入图像描述](https://i.stack.imgur.com/TXux1.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-12T17:44:10.690

我碰巧在他们那里工作时正在研究 RBAC 子系统……真是巧合。

我的模型基于系统中需要权限的不同**实体**的构建块，无论是查看/更新的属性还是要执行的操作。当然，系统中也有不同的**角色**（可以赋予用户），将整个事物结合在一起的粘合剂是**访问规则**，它将特定角色、特定需要权限的实体和**权限**连接起来的确。访问规则可能如下所示：

```
rule 14: guest role + page name + read permission
rule 46: approver role + add column + execute permission 
```

等等。我会将 ERD 作为练习留给读者；-) 如果您有任何问题，请发表评论。

尤瓦尔=8-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T08:49:54.480

您可以使用[Restful ACL Rails 插件](http://github.com/mdarby/restful_acl/wikis/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-12T21:55:56.213

我认为您的问题的答案与您希望的一样深。如果您碰巧考虑将角色放入组中，然后将组与用户相关联是不够的。最终，您需要在特定对象（论坛、视频等）上向用户授予特定权限。

我更接近 Yuval 的回答，我们需要的只是关联项目范围的对象 + 动作 + 用户。提供这个；基础对象（实体）非常有意义。任何从 Entity 继承的对象都可以通过这种方式轻松地与用户 + 操作相关联。

因为您也希望保持简单；我的建议是；

*   由于 rbac 限制，任何对象都应派生自基础实体。
*   应该有一个角色列表，这些角色与实体是一对一的。
*   应该有一个用户和角色之间的关系列表。

为了更进一步，我还推荐以下内容（对于自动 rbac）

*   我使用基于服务的访问我的对象。那是; 我创建对象的存储库（它为我执行 db-access）并通过服务函数访问存储库。
*   我在每个服务功能的开头使用自定义属性。这定义了访问该功能所需的角色。
*   我使用 User 参数来访问我的所有服务功能，每个服务功能在执行之前都会进行角色检查。反射帮助我了解我调用了哪个函数，以及它具有什么样的角色（通​​过自定义属性）
*   我还在我的应用程序启动时运行了一个初始化程序，它检查所有函数（及其属性）并查看我是否添加了新的必需角色。如果我刚刚添加了一个角色，但它似乎不在 db 上，它会在 db 上创建它。

但是，唉，这仅适用于 .NET，据我所知 Java 没有自定义属性，因此 Java 尚不可能使用。

我想提出一些代码示例，但我懒得这样做。如果您对我的 rbac 方式有疑问；你可以在这里问，我一定会回复的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-12T00:03:34.810

[Role Requirement](http://code.google.com/p/rolerequirement/)与 Restful Authentication 配合得很好，可以提供基于角色的身份验证功能，并且维护良好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-05T18:12:21.713

试试[https://github.com/ThoughtWorksStudios/piece](https://github.com/ThoughtWorksStudios/piece)，它是一个规则引擎，用于管理基于用户角色的访问控制：

1.  定义访问控制规则
2.  组合规则以构建新规则

您可以在此处找到完整的 Rails 应用程序示例：[https ://github.com/xli/piece-blog](https://github.com/xli/piece-blog)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-11T05:20:51.160

对于 .net 应用程序，您应该查看 Visual Guard [http://www.visual-guard.com/ 之](http://www.visual-guard.com/)类的内容，以避免必须从头开始处理权限和角色。

同样对于 .net，您可以通过配置处理成员资格和角色提供者以及授权。[http://www.odetocode.com/Articles/427.aspx](http://www.odetocode.com/Articles/427.aspx)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-12-21T09:09:43.153

我真的很喜欢这篇博文：[https ://content.pivotal.io/blog/access-control-permissions-in-rails](https://content.pivotal.io/blog/access-control-permissions-in-rails)

编辑：

似乎 railscasts 的 ryanb 沿着相同的思路思考并使用类似于 pivotollabs 帖子的基本技术创建了一个名为 cancan [https://github.com/ryanb/cancan的 gem。](https://github.com/ryanb/cancan)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-08-03T14:08:53.613

RBAC 简介 -

基于角色的访问控制系统是一种根据组织用户的角色限制对“某些源或应用程序或应用程序的某些功能”的访问的方法。

在这里，限制可以通过多个权限来实现，这些权限是由管理员创建来限制访问的，这些权限共同代表一个角色，将分配给用户。

如果我们稍微深入研究一下 RBAC，它基本上包含 3 个特性。

1) 身份验证 - 它确认用户的身份。通常它是通过用户帐户和密码或凭据完成的。

2) 授权 - 它定义了用户在应用程序中可以做什么和不能做什么。前任。允许“修改订单”，但不允许“创建新订单”。

3) 审核用户对应用程序的操作。- 它跟踪用户对应用程序的操作，以及谁授予了哪些用户访问权限？

这是 RBAC 系统非常基本的俯视图。

RBAC 系统的基本结构可以包含以下组件：用户、角色、权限或限制、资源。

*   权限或限制——权限代表对应用程序资源的访问。
*   角色 - 它包含权限的集合
*   用户 - 分配给用户的单个或多个角色，因此最终用户通过角色包含权限。

除此之外，如果您想支持复杂的场景，您还可以拥有一组用户 - 称为 - 组，并且可以将角色分配给组。所以，这是关于 RBAC 结构的非常基本的信息。

# c++ - 本地化测试，用 XXXXX 格式化所有字符串

> ID：190263
> 
> 赞同：2
> 
> 时间：2008-10-10T05:45:27.317
> 
> 标签：c++, mfc, localization

我们正在尝试优化我们的本地化测试。

我们的 QA 小组提出了一种特殊模式的建议，强制资源中的所有字符串完全包含在 X 中。我们已经 API 劫持了 LoadString，以及它的 MFC 实现，所以这样做应该不是主要障碍。

我的问题是如何解决格式问题？

```
Examples -

CString str ;
str . LoadString ( IDS_MYSTRING ) ;

where IDS_MYSTRING is "Hello World", should return "XXXXX XXXXX"
where IDS_MYSTRING is "Hello\nWorld", should return "XXXXX\nXXXXX"
where IDS_MYSTRING is "Hello%dWorld", should return "XXXXX%dXXXXX"
where IDS_MYSTRING is "Hello%.2fWorld", should return "XXXXX%.2fXXXXX"
where IDS_MYSTRING is "Hello%%World", should return "XXXXX%%XXXXX" 
```

因此，总而言之，如果在 printf 或 Format 语句中使用该字符串应该可以工作，它应该尊重转义字符。

所以这是一个纯代码问题，C++/MFC，

```
CString ConvertStringToXXXX ( const CString& aSource ) 
{
   CString lResult = aSource ;

   // Insert your code here

   return lResult ;
} 
```

我知道这可以使用 .RC 文件上的工具来完成，但我们想构建英语，然后像这样运行 -

应用程序-L10NTEST

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T07:01:38.347

如果这种方法是在应用程序中突出显示格式化字符串（或格式序列）（即所有文本都出现在 XXXX 之外），您可以找到转义序列（可能使用正则表达式）并在格式化（替换）值周围插入块引号，
例如一些\n文本 -> 一些[\n]文本

您可以获得可读性（所有字符串为 XXX 可能难以使用应用程序）并且还可以检测非资源（硬编码）字符串。

话虽如此，如果您要检测非资源加载的字符串（硬编码字符串），而不是替换 X，为什么不只是为字符串添加前缀呢？您将能够轻松地从硬编码字符串中区分资源加载字符串，
例如 Some\ntext -> [EN]Some\ntext

希望能帮助到你？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T10:45:33.513

[appTranslator](http://www.apptranslator.com)的伪本地化功能可以帮助您：它修改未翻译的字符串以使用变音符号、文本加宽或缩短等。到目前为止，你不感兴趣。有趣的是，它可以选择将这些字符串括在括号中。这个想法是为了让字符串是伪本地化的更加明显。您可以使用它来检测字符串实际上来自字符串表而不是代码。

当然，由于伪本地化程序必须正确运行，所以 appTranslator 会保留所有格式化程序（包括类似 printf 和类似 FormatMessage 的格式化程序）和特殊字符，例如 % 或 \n。这就是你要找的。

您甚至不必修改您的代码：只需创建一个“虚拟”翻译。我所说的“虚拟”是指您不打算将您的应用程序翻译成的语言。将您的应用程序的语言首选项设置为该语言。等等，更好的是：QA 的人可以完全靠自己完成。他们甚至不必打扰你！:-)

免责声明：我是 appTranslator 的作者。

编辑：回答您的评论：很高兴看到您已经在使用 appTranslator。为避免由于对话框或字符串不在 L10N DLL 中而导致的问题，您可以简单地重新构建 DLL（例如，在 VS 项目中使用链接后步骤）。该过程会自动重新扫描源 exe 并在构建的资源 dll 中合并新的和修改的文本（不影响 appTranslator 项目文件，而不是“更新源”）。这有助于确保您的资源 DLL 始终与您的 exe 同步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T06:20:57.667

[您可以在这里应用编译器理论并使用flex/bison](http://dinosaur.compilertools.net/)（lex/yacc 或任何工具）生成您的扫描仪和解析器。您可以将 \w+ 定义为单词，它可以匹配“Hello”和“World”等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T08:24:00.117

如果您的软件支持语言环境，我认为您需要的是 XXXX 语言环境。

你用英语开发它，然后切换到 XXXX 语言环境以确保所有内容都是可翻译的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T09:57:54.873

我的最终解决方案是为字符串添加前缀，例如“* [资源实例名称]原始字符串”。它工作得非常好，它显示了可能不适合说德语的字符串。

例子：

来自 appres.dll 的原始字符串“我的应用程序”

appres.dll 中的新字符串“*[appres]My Application”。

感谢所有的建议。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-20T05:08:41.603

我更喜欢我们在 Microsoft 时使用的伪本地化机制，其中包括在每个本地化资源周围放置大括号。例如，资源 => [-Resource-]。然后你总是可以告诉你有一个组合字符串，并且格式通常不会改变，除非换行规则。

我们通常还会进行一些字符串扩展（在原始字符串周围添加各种字符），以及一些基于字典或随机化的字符替换（将“o”转换为“ö”）。

一些团队还将文字资源标识符（名称）作为本地化资源的值，这对本地化人员比对测试人员更有用，因为他们可以看到资源在 UI 中实际使用的位置。

# .net - 搜索字节[]

> ID：190265
> 
> 赞同：5
> 
> 时间：2008-10-10T05:46:22.057
> 
> 标签：.net, search, binary

.NET 非常支持在字符串中搜索字符串，但是当您需要搜索的数据不是字符串时该怎么办？

我有通过 NetworkStream 以常规块形式到达的二进制数据。数据包是二进制的，但它们都以字节的签名序列开头。我将这些块累积到一个更大的缓冲区中并寻找数据包开始签名。

我真正要找的是方法的`byte[]`等价物`String.IndexOf(ss)`。我有一种讨厌的感觉，我将不得不自己用一个循环和一个状态机来实现它。

有什么建议么？交给你了！

* * *

正如建议的那样， Array.IndexOf(byte) 至少会为我节省一个显式循环。自发布以来，我想到找到第一个签名字节，然后提前探测最后一个签名字节应该在哪里的匹配，然后如果它们都匹配，则尝试对字符串的其余部分进行蛮力比较。这种方法的优点是可以廉价地拒绝错误匹配，并允许我在有部分签名等待另一个块时廉价地拒绝。

谷歌透露，上述绝妙方案是“KMP”或Knuth-Morris-Pratt算法的退化案例。从好的方面来说，如果 Knuth 把他的名字写在上面，那可能是闪电般的润滑，从不好的方面来说，为什么每当我有一个好主意时，Donald Knuth 会在 25 年前想到它？

由于我不能将积分奖励给 Donald Knuth，我猜他们会去 Nelson。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T05:50:58.630

您可以使用 Array.IndexOf 来查找单个字节。

但是，我会提醒您，一些有效数据可能会意外成为您的签名并完全退出您的应用程序。我认为更好的解决方案是始终发送一个包含数据包大小的四字节整数。然后读入那么多字节以清除该数据包的缓冲区。

如果您使用 TCP，如果客户端谎报数据包大小或请求愚蠢的内存量，则完全可以将其踢走：)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T09:09:48.557

我使用过的在字节数组和字符串中查找模式的最快算法是[Boyer-Moore](http://en.wikipedia.org/wiki/Boyer-Moore)和简单的 Boyer-Moore（当模式与正在搜索的文本显着不同时很有用）。我用它在 Java 中实现了一个快速的 mime 解析器。该[代码](http://buni.org/viewvc/panto/src/java/org/buni/panto/SimpleBoyerMoore.java?revision=1.1&view=markup)可以很容易地移植到 .Net（许可证是 LGPL）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T06:35:32.723

你可以使用非托管/不安全的代码吗？如果是这样，我可能会建议研究使用指针算法来搜索你的字节数组。这就是字符串有效的方式。你可以做类似的事情。

另一种解决方案可能是使用字典来存储您的数据包数据。让钥匙成为你的签名。然后它相当快速和容易找到它。将字节作为键的几种方法，例如 base64string、simepl 包装器（如果这样做，请使用 KeyedCollection）等。

# iis - 在 IIS 之后安装 ASP.Net 2.0

> ID：190270
> 
> 赞同：5
> 
> 时间：2008-10-10T05:48:03.193
> 
> 标签：iis, .net-2.0, installation

我刚从一家托管公司获得了一台专用服务器，由于某种原因，它没有安装 IIS。不过，它确实有 .Net 2.0。

所以我安装了 IIS，但现在我的 ASP.net 网站无法运行。我只是得到一个 404，没有事件日志条目，什么都没有......

我在可再发行包信息中注意到：“要访问 ASP.NET 的功能，必须在安装 .NET Framework 之前安装具有最新安全更新的 IIS”

我也无法卸载.Net，它不会让我...

有没有办法重新安装.Net 2.0，或者以某种方式对IIS 做任何事情以使其工作？

谢谢！丹尼尔

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T05:50:51.423

从命令行运行

```
aspnet_regiis -i 
```

您可能必须导航到安装它的文件夹。我的，默认是

```
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T10:57:54.783

确保您已在 IIS 中启用了 asp 和 aspx 的扩展。默认情况下它们被禁用。在您卸载更多组件之前，我会这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-28T13:31:07.823

同样的命令，您也可以从 Visual Studio 命令提示符运行它，然后您不需要导航到上述路径

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-24T17:09:23.180

在 Windows 10 中非常方便。

在控制面板，Windows 功能中，检查 ASP.NET 3.5，然后等待下载和安装。

[![在此处输入图像描述](https://i.stack.imgur.com/47xgm.png)](https://i.stack.imgur.com/47xgm.png)

# php - 使用需要发送标头的项目进行单元测试

> ID：190292
> 
> 赞同：47
> 
> 时间：2008-10-10T06:01:46.767
> 
> 标签：php, unit-testing, phpunit

我目前正在与 PHPUnit 一起尝试开发测试以及我正在编写的内容，但是，我目前正在编写会话管理器，并且在这样做时遇到了问题......

会话处理类的构造函数是

```
private function __construct()
{
    if (!headers_sent())
    {
        session_start();
        self::$session_id = session_id();
    }
} 
```

但是，由于 PHPUnit 在开始测试之前会发送文本，因此对该对象的任何测试都会返回失败的测试，因为 HTTP“标头”已经发送...

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-10T08:17:01.270

好吧，您的会话管理器基本上被设计破坏了。为了能够测试某些东西，必须能够将其与副作用隔离开来。不幸的是，PHP 的设计方式是鼓励自由使用全局状态（`echo`、`header`、`exit`等`session_start`）。

您可以做的最好的事情是隔离组件中的副作用，可以在运行时交换。这样，您的测试可以使用模拟对象，而实时代码使用具有真正副作用的适配器。您会发现这不适用于单例，我认为您正在使用单例。因此，您必须使用一些其他机制来将共享对象分发到您的代码中。您可以从静态注册表开始，但如果您不介意学习一点，还有更好的解决方案。

如果你不能这样做，你总是可以选择编写集成测试。例如。使用 PHPUnit 的[`WebTestCase`](http://www.simpletest.org/en/web_tester_documentation.html).

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-11-09T13:39:01.667

为 phpunit 创建一个引导文件，该文件调用：

```
session_start(); 
```

然后像这样启动phpunit：

```
phpunit --bootstrap pathToBootstrap.php --anotherSwitch /your/test/path/ 
```

引导文件在其他所有内容之前被调用，因此标题尚未发送，一切都应该正常工作。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-10-30T15:44:01.037

phpUnit 在测试运行时打印输出，从而导致 headers_sent() 即使在您的第一次测试中也返回 true。

要为整个测试套件克服这个问题，您只需在设置脚本中使用 ob_start()。

例如，假设您有一个名为 AllTests.php 的文件，它是 phpUnit 加载的第一个文件。该脚本可能如下所示：

```
<?php

ob_start();

require_once 'YourFramework/AllTests.php';

class AllTests {
    public static function suite() {
        $suite = new PHPUnit_Framework_TestSuite('YourFramework');
        $suite->addTest(YourFramework_AllTests::suite());
        return $suite;
    }
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-07-16T10:33:58.930

我遇到了同样的问题，我通过使用 --stderr 标志调用 phpunit 来解决它，就像这样：

```
phpunit --stderr /path/to/your/test 
```

希望它可以帮助某人！

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-12T00:01:40.543

我认为“正确”的解决方案是创建一个非常简单的类（简单到不需要测试），它是 PHP 会话相关函数的包装器，并使用它而不是`session_start()`直接调用等。

在测试中通过模拟对象而不是真正的有状态、不可测试的会话类。

```
private function __construct(SessionWrapper $wrapper)
{
   if (!$wrapper->headers_sent())
   {
      $wrapper->session_start();
      $this->session_id = $wrapper->session_id();
   }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-10-30T22:25:57.583

我想知道为什么没有人列出 XDebug 选项：

```
/**
 * @runInSeparateProcess
 * @requires extension xdebug
 */
public function testGivenHeaderIsIncludedIntoResponse()
{
    $customHeaderName = 'foo';
    $customHeaderValue = 'bar';

    // Here execute the code which is supposed to set headers
    // ...

    $expectedHeader = $customHeaderName . ': ' . $customHeaderValue;
    $headers = xdebug_get_headers();

    $this->assertContains($expectedHeader, $headers);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T06:12:22.923

你不能在开始测试之前使用输出缓冲吗？如果您缓冲所有输出的内容，则设置任何标头应该没有问题，因为此时尚未将任何输出发送到客户端。

即使 OB 在您的课程中的某处使用，它也是可堆叠的，并且 OB 不应该影响内部发生的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T07:40:33.543

据我所知，Zend Framework 对其 Zend_Session 包测试使用相同的输出缓冲。您可以查看他们的测试用例以帮助您入门。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-04T09:53:37.377

引导文件的创建，指出 4 个帖子回来似乎是解决这个问题的最干净的方法。

通常使用 PHP，我们必须维护，并尝试将某种工程学科添加到非常简单地组合在一起的遗留项目中。我们没有时间（或授权）来丢弃整堆垃圾并重新开始，因此 troelskn 的第一个答案并不总是可能的前进方向。（如果我们可以回到最初的设计，那么我们可以完全抛弃 PHP 并使用更现代的东西，例如 ruby​​ 或 python，而不是帮助延续 Web 开发世界的这种 COBOL。）

如果您尝试为在整个模块中使用 session_start 或 setcookie 的模块编写单元测试，那么在 boostrap 文件中启动会话会解决这些问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-10-19T13:39:17.077

因为我现在正在对我的引导程序进行单元测试（是的，我知道你们中的大多数人都不这样做），所以我遇到了同样的问题（header() 和 session_start()）。我找到的解决方案相当简单，在您的单元测试引导程序中定义一个常量并在发送标头或启动会话之前简单地检查它：

```
// phpunit_bootstrap.php
define('UNITTEST_RUNNING', true);

// bootstrap.php (application bootstrap)
defined('UNITTEST_RUNNING') || define('UNITTEST_RUNNING', false);
.....
if(UNITTEST_RUNNING===false){
    session_start();
} 
```

我同意这在设计上并不完美，但我正在对现有应用程序进行单元测试，不需要重写大部分。我还使用相同的逻辑来测试使用 __call() 和 __set() 魔术方法的私有方法。

```
public function __set($name, $value){
    if(UNITTEST_RUNNING===true){
       $name='_' . $name;
       $this->$name=$value;
    }
    throw new Exception('__set() can only be used when unittesting!');
 } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-01-08T10:51:16.483

看来您需要注入会话以便测试代码。我使用的最佳选项是 Aura.Auth 用于身份验证过程并使用 NullSession 和 NullSegment 进行测试。

[使用空会话进行 Aura 测试](https://github.com/auraphp/Aura.auth#working-without-sessions)

Aura 框架编写精美，您可以单独使用 Aura.Auth，而无需任何其他 Aura 框架依赖项。

# unit-testing - 测试抽象类

> ID：190295
> 
> 赞同：152
> 
> 时间：2008-10-10T06:03:07.513
> 
> 标签：unit-testing, phpunit, abstract-class

如何使用 PHPUnit 测试抽象类的具体方法？

我希望我必须创建某种对象作为测试的一部分。虽然，我不知道这个的最佳实践，或者 PHPUnit 是否允许这样做。

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2010-02-10T23:35:03.847

抽象类的单元测试并不一定意味着测试接口，因为抽象类可以有具体的方法，而这个具体的方法是可以测试的。

在编写一些库代码时，具有某些您希望在应用程序层中扩展的基类并不少见。而且，如果您想确保库代码经过测试，您需要使用 UT 抽象类的具体方法的方法。

就我个人而言，我使用 PHPUnit，它有所谓的存根和模拟对象来帮助您测试这类事情。

直接来自[PHPUnit 手册](https://phpunit.de/manual/current/en/test-doubles.html#test-doubles.stubs)：

```
abstract class AbstractClass
{
    public function concreteMethod()
    {
        return $this->abstractMethod();
    }

    public abstract function abstractMethod();
}

class AbstractClassTest extends PHPUnit_Framework_TestCase
{
    public function testConcreteMethod()
    {
        $stub = $this->getMockForAbstractClass('AbstractClass');
        $stub->expects($this->any())
             ->method('abstractMethod')
             ->will($this->returnValue(TRUE));

        $this->assertTrue($stub->concreteMethod());
    }
} 
```

模拟对象给你几件事：

*   你不需要有抽象类的具体实现，可以用存根代替
*   您可以调用具体方法并断言它们正确执行
*   如果具体方法依赖于未实现的（抽象）方法，您可以使用 will() PHPUnit 方法存根返回值

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2018-02-20T15:47:01.850

应该注意的是，从 PHP 7 开始，添加了对[匿名类](http://php.net/manual/en/language.oop5.anonymous.php)的支持。这为您为抽象类设置测试提供了另一种途径，它不依赖于 PHPUnit 特定的功能。

```
class AbstractClassTest extends \PHPUnit_Framework_TestCase
{
    /**
     * @var AbstractClass
     */
    private $testedClass;

    public function setUp()
    {
        $this->testedClass = new class extends AbstractClass {

            protected function abstractMethod()
            {
                // Put a barebones implementation here
            }
        };
    }

    // Put your tests here
} 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2011-02-13T23:46:54.910

这是个好问题。我也一直在找这个。
幸运的是，PHPUnit 已经有[`getMockForAbstractClass()`](https://phpunit.readthedocs.io/en/7.1/test-doubles.html#mocking-traits-and-abstract-classes)这种情况的方法，例如

```
protected function setUp()
{
    $stub = $this->getMockForAbstractClass('Some_Abstract_Class');
    $this->_object = $stub;
} 
```

### 重要的：

请注意，这需要 PHPUnit > 3.5.4。以前的版本中有[一个错误](https://github.com/sebastianbergmann/phpunit-mock-objects/pull/22)。

要升级到最新版本：

```
sudo pear channel-update pear.phpunit.de
sudo pear upgrade phpunit/PHPUnit 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T18:48:10.630

Eran，您的方法应该可以工作，但它违背了在实际代码之前编写测试的趋势。

我的建议是在所讨论的抽象类的非抽象子类的所需功能上编写测试，然后编写抽象类和实现子类，最后运行测试。

您的测试显然应该测试抽象类的定义方法，但总是通过子类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-23T15:19:58.793

尼尔森的回答是错误的。

抽象类并不要求它们的所有方法都是抽象的。

实现的方法是我们需要测试的。

您可以做的是在单元测试文件上创建一个假存根类，让它扩展抽象类并仅实现所需的功能，当然，并对其进行测试。

干杯。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T19:06:25.163

如果您不想子类化抽象类只是为了对已经在抽象类中实现的方法执行单元测试，您可以尝试查看您的框架是否允许您[模拟](http://en.wikipedia.org/wiki/Mock_object "模拟对象 - 维基百科，免费的百科全书")抽象类。

# .net - 您如何有效地对数据库中的继承进行建模？

> ID：190296
> 
> 赞同：158
> 
> 时间：2008-10-10T06:03:27.590
> 
> 标签：.net, sql-server, oop, inheritance, database-design

在数据库中建模继承的最佳实践是什么？

有哪些权衡（例如可查询性）？

（我对 SQL Server 和 .NET 最感兴趣，但我也想了解其他平台如何解决这个问题。）

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2008-10-10T06:11:28.853

有几种方法可以在数据库中对继承进行建模。您选择哪种取决于您的需求。这里有几个选项：

**每种类型的表 (TPT)**

每个班级都有自己的桌子。基类包含所有基类元素，从它派生的每个类都有自己的表，主键也是基类表的外键；派生表的类只包含不同的元素。

例如：

```
class Person {
    public int ID;
    public string FirstName;
    public string LastName;
}

class Employee : Person {
    public DateTime StartDate;
} 
```

会产生如下表格：

```
table Person
------------
int id (PK)
string firstname
string lastname

table Employee
--------------
int id (PK, FK)
datetime startdate 
```

**逐层表 (TPH)**

有一个表代表所有继承层次结构，这意味着其中的几列可能是稀疏的。添加了一个鉴别器列，它告诉系统这是什么类型的行。

给定上面的类，你最终得到这个表：

```
table Person
------------
int id (PK)
int rowtype (0 = "Person", 1 = "Employee")
string firstname
string lastname
datetime startdate 
```

对于行类型为 0（人）的任何行，开始日期将始终为空。

**每混凝土表 (TPC)**

每个类都有自己的完整表格，没有对任何其他表格的引用。

给定上面的类，你最终得到这些表：

```
table Person
------------
int id (PK)
string firstname
string lastname

table Employee
--------------
int id (PK)
string firstname
string lastname
datetime startdate 
```

* * *

## 回答 #2

> 赞同：162
> 
> 时间：2008-10-10T22:18:55.787

正确的数据库设计与正确的对象设计完全不同。

如果您打算将数据库用于除了简单地序列化您的对象（例如报告、查询、多应用程序使用、商业智能等）之外的任何事情，那么我不推荐任何类型的从对象到表的简单映射。

许多人将数据库表中的一行视为一个实体（我花了很多年的时间思考这些术语），但一行不是实体。这是一个提议。数据库关系（即表）表示关于世界的一些事实陈述。该行的存在表明事实是真实的（相反，它的缺失表明事实是错误的）。

通过这种理解，您可以看到面向对象程序中的单个类型可能跨十几个不同的关系存储。并且多种类型（通过继承、关联、聚合或完全不从属）可以部分存储在单个关系中。

最好问问自己，你想存储什么事实，你想回答什么问题，你想生成什么报告。

一旦创建了正确的数据库设计，那么创建允许您将对象序列化到这些关系的查询/视图就很简单了。

例子：

在酒店预订系统中，您可能需要存储 Jane Doe 在 Seaview Inn 预订 4 月 10 日至 12 日房间的事实。这是客户实体的属性吗？它是酒店实体的属性吗？它是一个预订实体，其属性包括客户和酒店吗？它可以是面向对象系统中的任何或所有这些东西。在数据库中，这些都不是。这只是一个赤裸裸的事实。

要查看差异，请考虑以下两个查询。(1) Jane Doe 明年有多少酒店预订？(2) 海景客栈4月10日订了多少房？

在面向对象的系统中，查询（1）是客户实体的属性，查询（2）是酒店实体的属性。这些对象会在其 API 中公开这些属性。（不过，显然获得这些值的内部机制可能涉及对其他对象的引用。）

在关系数据库系统中，两个查询都将检查预留关系以获取它们的数字，并且从概念上讲，不需要打扰任何其他“实体”。

因此，通过尝试存储有关世界的事实——而不是尝试存储具有属性的实体——来构建适当的关系数据库。一旦设计得当，就可以轻松构建在设计阶段没有想到的有用查询，因为完成这些查询所需的所有事实都在适当的位置。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-10T22:26:10.450

简短的回答：你没有。

如果您需要序列化您的对象，请使用 ORM，甚至更好的东西，如 activerecord 或 prevaylence。

如果您需要存储数据，请以关系方式存储它（注意存储的内容，并注意 Jeffrey L Whitledge 刚才所说的内容），而不是受对象设计的影响。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-08-22T17:37:17.167

正如 Brad Wilson 所提到的，TPT、TPH 和 TPC 模式是你要走的路。但有几点注意事项：

*   从基类继承的子类可以看作是数据库中基类定义的弱实体，这意味着它们依赖于它们的基类，没有它就不能存在。我已经多次看到，为每个子表存储唯一 ID，同时将 FK 保留到父表。一个 FK 就足够了，它甚至更好地为子表和基表之间的 FK 关系启用 on-delete 级联。

*   在 TPT 中，仅通过查看基表记录，您无法找到该记录所代表的子类。当您想要加载所有记录的列表时（无需 `select` 对每个子表执行操作），有时需要这样做。处理此问题的一种方法是使用一列表示子类的类型（类似于 TPH 中的 rowType 字段），因此以某种方式混合 TPT 和 TPH。

假设我们要设计一个包含以下形状类图的数据库：

```
public class Shape {
int id;
Color color;
Thickness thickness;
//other fields
}

public class Rectangle : Shape {
Point topLeft;
Point bottomRight;
}

public class Circle : Shape {
Point center;
int radius;
} 
```

上述类的数据库设计可以是这样的：

```
table Shape
-----------
int id; (PK)
int color;
int thichkness;
int rowType; (0 = Rectangle, 1 = Circle, 2 = ...)

table Rectangle
----------
int ShapeID; (FK on delete cascade)
int topLeftX;
int topLeftY;
int bottomRightX;
int bottomRightY;

table Circle
----------
int ShapeID; (FK on delete cascade)  
int centerX;
int center;
int radius; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-10T06:08:43.727

您可以在数据库中设置两种主要类型的继承，即每个实体的表和每个层次结构的表。

每个实体的表是您拥有一个基础实体表的地方，该表具有所有子类的共享属性。然后，每个子类都有另一个表，每个表只包含适用于该类的属性。他们通过 PK 以 1:1 的比例联系在一起

![替代文字](https://i.stack.imgur.com/wjwxu.jpg)

每个层次结构的表是所有类共享一个表的地方，可选属性可以为空。它们也是一个鉴别器字段，它是一个数字，表示记录当前持有的类型

![替代文字](https://i.stack.imgur.com/cdUe6.jpg) SessionTypeID 是鉴别器

每个层次结构的目标查询速度更快，因为您不需要连接（只有鉴别器值），而每个实体的目标您需要进行复杂的连接以检测某物是什么类型并检索其所有数据。

编辑：我在这里展示的图像是我正在处理的项目的屏幕截图。资产图像不完整，因此它是空的，但它主要是为了展示它的设置，而不是在你的表格中放置什么。那取决于你 ;）。会话表保存虚拟协作会话信息，并且根据所涉及的协作类型可以是多种类型的会话。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T06:06:01.860

您将对数据库进行规范化，这实际上会反映您的继承。它可能会降低性能，但这就是规范化的方式。您可能必须使用良好的常识来找到平衡点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T06:13:46.277

[重复类似的线程答案](https://stackoverflow.com/questions/5802/inheritance-in-database#86900)

在 OR 映射中，继承映射到父表，其中父表和子表使用相同的标识符

例如

```
create table Object (
    Id int NOT NULL --primary key, auto-increment
    Name varchar(32)
)
create table SubObject (
    Id int NOT NULL  --primary key and also foreign key to Object
    Description varchar(32)
) 
```

SubObject 与 Object 具有外键关系。创建 SubObject 行时，必须先创建一个 Object 行并在两行中​​使用 Id

编辑：如果您还想对行为进行建模，则需要一个列出表之间继承关系的类型表，并指定实现每个表行为的程序集和类名

看起来有点矫枉过正，但这一切都取决于你想用它做什么！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-10T08:28:53.867

使用 SQL ALchemy (Python ORM)，您可以进行两种类型的继承。

我有过的经验是使用单表，并有一个判别列。例如，绵羊数据库（不是开玩笑！）将所有绵羊存储在一个表中，而公羊和母羊使用该表中的性别列进行处理。

因此，您可以查询所有绵羊，并获取所有绵羊。或者你可以只通过 Ram 查询，它只会得到 Rams。你也可以做一些事情，比如有一个只能是一只公羊的关系（即，一只羊的父亲），等等。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-10T09:10:54.687

请注意，一些数据库引擎已经像[Postgres](http://www.postgres.org)一样提供了原生的继承机制。查看[文档](http://www.postgresql.org/docs/8.3/interactive/ddl-inherit.html)。

例如，您将查询上述响应中描述的人员/员工系统，如下所示：

```
  /* 这显示所有人员或员工的名字 */
  从人中选择名字；

  /* 这仅显示所有员工的开始日期 */
  从员工中选择开始日期；

```

那是你的数据库的选择，你不需要特别聪明！

# c# - 如何确定 POP3 邮件附件的文件大小

> ID：190299
> 
> 赞同：2
> 
> 时间：2008-10-10T06:05:59.070
> 
> 标签：c#, .net, file

我正在编写一个程序来读取 POP3 邮箱并将电子邮件信息上传到我的票务系统。然后我想把附件也上传。除了文件大小，我已经得到了我需要的所有信息。

有没有办法从邮件消息中确定文件大小？我正在获取附件，解码 base64 编码字符串并将其分解为字节数组以存储在数据库中。如果有另一种方法来确定文件大小，我也愿意尝试。

我正在使用 C# 和 .NET 3.5。

谢谢！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T06:13:09.413

base64 解码字节数组的大小是否适合您？如果是这样，您需要做的就是在不解码的情况下计算大小，对吗？

大小为 N 的字节数组将编码为 (N * 4)/3 字节，*总是向上取整*。您需要查看字符串的最后几个字符，以确定要删除多少以进行舍入。基本上它应该是这样的：

```
string x = GetBase64DataFromWherever();
int size = (x.Length *3)/4;
if (x.EndsWith("="))
{
    size--;
}
if (x.EndsWith("=="))
{
    size--; // 1 will already have been removed by the if statement above
} 
```

这是未经测试的，但大概你有很好的测试数据，你可以试试:)

# c++ - C++：找出修饰的名字

> ID：190326
> 
> 赞同：5
> 
> 时间：2008-10-10T06:35:59.960
> 
> 标签：c++, dll, export, name-mangling

如何找出将分配给每个方法名称的修饰名称？我试图找出修饰名称是什么，以便我可以在 DLL 中导出它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T21:06:26.180

## .DEF 文件*仍在*使用？

忘记 .DEF 文件。它们已成为过去。

通过 __declspec(dllimport/dllexport) 导出您的函数，无论是 C 函数还是 C++ 符号。

如果您确实需要未修饰的名称，请按照 Greg Hewgill 的建议使用 __declspec(dllimport/dllexport) 关键字，并结合 extern "C"，这将去除这些符号的修饰...

## 您确定要删除 C++ 装饰吗？

这有一些正当的理由：您想要导出 C 代码将使用的代码，或者您想要使用使用不同编译器编译的模块中的 DLL。

由于第二个原因，我会改为为每个编译器生成一个 DLL，并保留装饰。

除了这些原因，你为什么要移除装饰？

## C++ 装饰/名称修饰不是邪恶的

恰恰相反。

如果您正在使用一个编译器（*我想您这样做了，因为您想使用修饰名称，而不是 extern "C" 的*），然后保持 C++ 修饰/名称修饰。

通过这种方式，您将能够使用完整的 C++ 功能，即命名空间、类、函数/方法重载等。

尽管如此，手动使用符号装饰是一种灾难：使用 dllexport 导出符号，而无需处理另一个 (.DEF) 文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T06:39:32.433

这个问题非常相似：[Exporting DLL C++ Class ， question about .def file](https://stackoverflow.com/questions/186232/exporting-dll-c-class-question-about-def-file)。快速总结是您可能希望使用`__declspec(dllexport)`让编译器为您完成导出方法的工作。

Microsoft 在每个编译器版本中都改变了他们对函数名称进行修改（或称它们为“修饰名称”）的方式，因此如果您尝试手动导出修改后的名称，将来可能会遇到维护问题。如果您在 Google 上搜索“msvc 修饰名称”，则有一些链接可能会有所帮助，但不能保证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T06:50:56.543

由于 C++ 名称修改不是在不同编译器之间匹配的东西（正如[Greg Hewgill](https://stackoverflow.com/questions/190326/c-finding-out-decorated-names#190333)提到的，它甚至可以在同一供应商的编译器的版本之间更改）并且 C++ 没有标准的二进制接口，因此导出 C++ 通常不是一个好主意DLL 中的函数。如果 DLL 非常紧密地绑定到使用它的应用程序并对其进行版本控制，则例外情况。

另一种方法是将导出的函数声明为`extern "C"`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T19:32:59.173

通过在对象文件上使用**dumpbin ，您会发现对象中使用的所有方法。**这是它的使用方法

```
dumpbin /symbols File.obj 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T15:39:45.403

我认为您应该听取前面 2[位受访者 Greg Hewgill](https://stackoverflow.com/users/893/greg-hewgill)和[Mike B](https://stackoverflow.com/users/12711/mike-b)的建议，但是如果您使用的是 Microsoft 工具链并且您真的想知道修饰名称...

1.  *使用__declspec(dllexport)*创建您的 .lib 和 .dll 文件
**   使用 dumpbin /exports 检查 dll 导出的名称*   现在您可以删除*__declspec(dllexport)*并在*.def*文件中手动导出符号*

 ** * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T18:43:27.773

在 VS2005 中，有一个预处理器宏[**funcdname**](http://msdn.microsoft.com/en-us/library/b0084kay(VS.80).aspx)，当放置在函数中时，它返回一个带有修饰名称的字符串。然而，这是非标准的——C99 标准对此有[**func**](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2004/n1642.html)，我不能说你的编译器是否支持它。

（为什么下划线不能正确显示？？）

（编辑：）这显然是最近在[类似的讨论](https://stackoverflow.com/questions/733056/is-there-a-way-to-get-function-name-inside-a-c-function)中出现的。

# video-streaming - 用于构建视频会议应用程序的视频 API

> ID：190334
> 
> 赞同：1
> 
> 时间：2008-10-10T06:40:22.477
> 
> 标签：video-streaming, webcam, tapi, h.323

我将在接下来的六个月内构建一个应用程序，该应用程序将用作双向视频会议系统，并来回共享一些其他数据。我可能会使用某种相对昂贵的 USB 网络摄像头，并且知道 USB 视频类设备标准，这似乎是要走的路。

现在，我可以用什么来针对那个（或其他方向）进行编程？操作系统并不重要，因为它没有决定（将选择适应整体需求），语言也不是。网络将是 VPN，最坏情况 256kbps 对称。理想情况下，它也可以处理编码和压缩，但基本上我只是在寻找某种起点来开始研究（到目前为止刚刚发现 TAPI 和 H.323，不确定对它们进行编程的最佳方法）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T06:43:46.230

有了 gnome，你就有了[ekiga](http://ekiga.org)。你也可以为win32交叉编译它。它在下面使用 OPAL（开放电话抽象库）。也许工具本身会满足您的需求，否则您可以调整它（OSS）或者您只能保留低级 API

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T07:09:51.437

我同意普华永道。

*   OPAL 是一个绝佳的选择。
*   它支持音频和视频设备
*   它可以在 Windows、Linux 和其他一些平台上编译

另外 - 我推荐使用 SIP 协议（​​而不是 H323） - 你不需要使用 Ekiga。Ekiga 是 OPAL 的前端。您可以查看 OPAL 示例，并根据这些示例进行构建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-06T11:12:38.690

我完全不推荐使用 H.323 来构建新的应用程序，尤其是面向用户的应用程序。我推荐 SIP，因为它更简单、更清晰的信令/协商等

从另一个角度来看，如果您要构建的呼叫密度超过 5 个，我不建议使用 OPAL。这是因为那里放置了许多架构解决方案（具有一些竞争条件的线程管理，具有延迟复制的非常复杂的容器管理，这实际上使事情变得更加危险等等）。这是因为 OpenH323 遗留方法（实际上是用于 OpenH323 的 ptlib 库）。

也许从我对 OpenH323 和早期 Opal 头痛的日子开始有所改变，但我认为这不是基本的。

来看看[FreeSwitch](http://www.freeswitch.org/)平台怎么样？人们说它设计得更好。

# latex - 如何在 Latex 中正确调整表格的大小？

> ID：190335
> 
> 赞同：0
> 
> 时间：2008-10-10T06:40:52.320
> 
> 标签：latex

这是我的第一个 Latex 文档。使用 Latex8.sty 我试图包含一个 5 列的表。除了介绍和表格之外，我已经注释掉了所有内容。当我制作 pdf 时，它显示了介绍，但没有表格。有小费吗？

```
\begin{tabular}{|ll||l|c|r|rr}
 Mass&a1&a2&Fprime1&Fprime2\\
 \hline
 70g&0.988m/s^2&-2.79m/s^2&467.364N&424.02N\\
 80g&1.36m/s&-2.81m/s^2&3.84N&427.12N\\
 90g&1.70m/s^2&-2.74m/s^2&471.5N&416.48N\\
 100g&1.84m/s^2&-2.76m/s^2&491.12N&419.52N\\
 150g&3.11m/s^2&-2.88m/s^2&530.78N&437.76N\\\hline
\end{tabular} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T06:47:21.200

此示例呈现一个外观正确的表格。请注意“m/s^2”周围的“$”（如果没有这些，我根本不知道它是如何为您工作的）。

```
\documentclass[a4paper,openany]{book}
\begin{document}
\begin{tabular}{|ll||l|c|r|rr}
 Mass&a1&a2&Fprime1&Fprime2\\
 \hline
 70g&$0.988m/s^2$&$-2.79m/s^2$&467.364N&424.02N\\
 80g&$1.36m/s$&$-2.81m/s^2$&3.84N&427.12N\\
 150g&$3.11m/s^2$&$-2.88m/s^2$&530.78N&437.76N\\\hline
\end{tabular}
\end{document} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T07:46:14.217

为了改善表格的外观，您还可以查看[booktabs 包](http://ctan.org/tex-archive/macros/latex/contrib/booktabs/ "booktabs 包")。

要使用 booktabs 包生成表格，请使用相同的表格环境，但添加 \toprule、\midrule 和 \bottomrule 命令：

```
\documentclass[a4paper,openany]{book}
\usepackage{booktabs}% for prettier tables
\begin{document}
\begin{tabular}{|ll||l|c|r|rr}
\toprule
 Mass&a1&a2&Fprime1&Fprime2\\
\midrule
 70g&$0.988m/s^2$&$-2.79m/s^2$&467.364N&424.02N\\
 80g&$1.36m/s$&$-2.81m/s^2$&3.84N&427.12N\\
 150g&$3.11m/s^2$&$-2.88m/s^2$&530.78N&437.76N\\
\bottomrule
\end{tabular}
\end{document} 
```

通读[booktabs 文档](http://ctan.org/get/macros/latex/contrib/booktabs/booktabs.pdf)，简要讨论表格的外观（至少根据作者的说法）。

如果您想更加迂腐，您还可以查看用于排版单位的[单位包。](http://ctan.org/tex-archive/macros/latex/contrib/units/)您可以将表格的标题设置为：

```
Mass & $a_1$ & $a_2$ & $F'$ & $F''$ \\ 
```

除非您需要保持变量名的拼写。

# wpf - WPF 字体模糊问题 - 解决方案

> ID：190344
> 
> 赞同：155
> 
> 时间：2008-10-10T06:50:27.183
> 
> 标签：wpf, fonts

问题在以下链接中进行了描述和演示：

*   [Paul Stovell WPF：模糊文本渲染](https://web.archive.org/web/20081123055336/http://paulstovell.com/blog/wpf-why-is-my-text-so-blurry)
*   [www.gamedev.net 论坛](http://www.gamedev.net/community/forums/topic.asp?topic_id=445078)
*   [Microsoft Connect：WPF 文本渲染器在小字体上产生严重模糊的文本](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=380919&wa=wsignin1.0)

说明：[WPF 中的文本清晰度](http://windowsclient.net/wpf/white-papers/wpftextclarity.aspx)。这个链接有字体比较。

我想为这个问题收集所有可能的解决方案。Microsoft Expression Blend 使用 WPF，但字体看起来可读。

*   Microsoft Expression Blend 中的深色背景
*   增加字体大小并更改字体（Calibri ...）[[链接]](https://stackoverflow.com/questions/190344/wpf-blurry-fonts-problem#190521)
*   嵌入窗体[[链接]](https://stackoverflow.com/questions/190344/wpf-blurry-fonts-problem#190540)
*   使用 GDI+ 和/或 Windows 窗体 TextRenderer 类将文本呈现到位图，然后将该位图呈现为 WPF 控件。[[关联]](https://stackoverflow.com/questions/190344/wpf-blurry-fonts-problem#283216)

还有更多的解决方案吗？

[**这将在 VS2010（和 WPF4）beta 2 中修复**](https://stackoverflow.com/questions/190344/wpf-blurry-fonts-problem-solutions/1494126#1494126)

**看起来终于解决了！**

[**Scott Hanselman 的 ComputerZen.com：WPF 和文本模糊，现在完全清晰**](http://www.hanselman.com/blog/WPFAndTextBlurrinessNowWithCompleteClarity.aspx?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3A+ScottHanselman+%28Scott+Hanselman+-+ComputerZen.com%29&utm_content=Google+Reader)

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2011-03-02T11:05:59.250

.NET 4 终于有了解决 WPF 文本渲染质量差的办法，但是隐藏的很好。为每个窗口设置以下内容：

```
TextOptions.TextFormattingMode="Display" 
```

默认值为“理想”，这根本不是名称所暗示的。

TextOptions 中还有另外两个选项，即 TextHintingMode 和 TextRenderingMode，但它们都有合理的默认值。

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2008-10-10T08:31:38.650

### 技术背景

windowsclient.net 上的 WPF 文本程序管理器之一有一篇关于 WPF 文本呈现的深入文章：WPF 中的[文本清晰度](http://windowsclient.net/wpf/white-papers/wpftextclarity.aspx)。

问题归结为 WPF 需要一个线性缩放的字体渲染器来实现流畅的动画。另一方面，Pure ClearType 需要相当大的自由度来将垂直词干推入下一个像素。

如果比较经典的“级联”模式，差异就很明显了。左下角的WinForms，右上角的WPF：

![](https://club.black.co.at/david/pics/Fontcascade.png)

虽然我也不喜欢 WPF 的字体渲染特性，但我可以想象如果动画会像在 Winforms 级联中那样跳跃会引起喧嚣。

### 玩注册表

我特别感兴趣的是 MSDN 文章“ [ClearType Registry Settings](http://msdn.microsoft.com/en-us/library/aa970267.aspx) ”的链接，它解释了注册表中可能的用户端调整：

*   ClearType 级别：子像素提示的数量
*   伽玛级别
*   像素结构：显示像素中的色条是如何排列的
*   文本对比度级别：调整字形词干的宽度以使字体更重

使用这些设置并没有真正改善潜在问题，但可以通过减少敏感用户的颜色渗色效果来提供帮助。

### 另一种方法

Text Clarity 文章给出的最佳建议是增加字体大小和更改字体。Calibri 比标准的 Segoe UI 更适合我。由于它作为网络字体很受欢迎，我也尝试了 Verdana，但它的重量在 14pt 和 15pt 之间有一个令人讨厌的跳跃，这在为字体大小设置动画时非常明显。

### WPF 4.0

WPF 4 将改进对影响字体呈现的支持。WPF 文本博客上有[一篇文章](https://blogs.msdn.microsoft.com/text/2009/08/24/wpf-4-0-text-stack-improvements/)解释了这些更改。最突出的是，现在（至少）有三种不同类型的文本渲染：

![文字渲染对比](https://msdnshared.blob.core.windows.net/media/TNBlogsFS/BlogFileStorage/blogs_msdn/text/WindowsLiveWriter/WPF4.0TextStackImprovements_12DE7/CT%20vs%20Grayscale%20vs%20Aliased_4.png)

[<grumble>这对每个设计师来说应该足够了。</grumble>]

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-10-27T15:31:42.873

[前几天我在使用应用了DropShadowEffect](http://msdn.microsoft.com/en-us/library/system.windows.media.effects.dropshadoweffect.aspx)的边框时遇到了一个问题。结果是该边界内的所有文本都非常模糊。文本是在其他面板内还是直接在边框下方都没有关系 - 任何应用了[效果](http://msdn.microsoft.com/en-us/library/system.windows.uielement.effect.aspx)的父级子级文本块似乎都会受到影响。

这种特殊情况的解决方案是不要将东西放在有效果的边框内，而是使用网格（或任何其他支持将内容放在彼此顶部的东西）并将一个矩形放置在与文本相同的单元格中（即作为视觉树中的兄弟）并将效果放在上面。

像这样：

```
<!-- don't do this --->
<Border>
     <Border.Effect>
          <DropShadowEffect BlurRadius="25" ShadowDepth="0" Opacity="1"/>
     </Border.Effect>
     <TextBlock Text="This Text Will Be Blurry" />
</Border>

<!-- Do this instead -->
<Grid>
  <Rectangle>
     <Rectangle.Effect>
          <DropShadowEffect BlurRadius="25" ShadowDepth="0" Opacity="1"/>
     </Rectangle.Effect>
  </Rectangle>
  <TextBlock Text="This Text Will Be Crisp and Clear" />
</Grid> 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-09-29T18:17:14.910

这将在 VS2010（和 WPF4）beta 2 中修复：

[![](https://msdnshared.blob.core.windows.net/media/TNBlogsFS/BlogFileStorage/blogs_msdn/text/WindowsLiveWriter/WPF4.0TextStackImprovements_12DE7/Magna%20Carta%20Ideal%20vs%20Display%208pt%20annotated_4.png)](http://blogs.msdn.com/text/archive/2009/08/24/wpf-4-0-text-stack-improvements.aspx)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-04-20T15:12:17.453

我不认为它是一个错误，但默认配置确实很烦人。这是所有组合的比较

```
TextOptions.TextRenderingMode
TextOptions.TextFormattingMode
RenderOptions.ClearTypeHint 
```

`SnapToDevicePixels`在文本渲染中没有任何不同。

![http://i.stack.imgur.com/cS3S2.png](https://i.stack.imgur.com/cS3S2.png)

我更喜欢：

```
TextOptions.TextRenderingMode="Auto"
TextOptions.TextFormattingMode="Ideal"
RenderOptions.ClearTypeHint="Auto" 
```

垂直线永远不会模糊。

使用的字体是 Open Sans Light，如果使用得当，它会非常漂亮，就像在最新的 TeamViewer 中一样。

对于那些使用 Mahapps.Metro 的人来说，问题出在`TransitioningContentControl` [https://github.com/MahApps/MahApps.Metro/issues/889](https://github.com/MahApps/MahApps.Metro/issues/889)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-10T11:31:22.650

SnapToDevicePixels 仅适用于 WPF 形状（线条等），不适用于文本渲染器。

此问题没有已知的解决方法。根据微软的说法，这种行为是“设计使然”。

另请参阅Microsoft 论坛上讨论[这些](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/5289ee56-6d06-4f66-84f2-69865b6dc401/)问题的线程 - 它已从 MS 人员那里得到了一些答复，阐明了他们在该问题上的立场。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-12T07:04:41.597

从开发人员的角度来看，迄今为止唯一已知的“解决方法”是使用 GDI+ 和/或 Windows 窗体 TextRenderer 类将文本呈现为位图，然后将该位图呈现为 WPF 控件。除了明显的性能影响之外，这并不能缓解现有应用程序的问题。

我现在已经[为这个问题创建了一个 Microsoft Connect 票证](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=380919)（令我惊讶的是，尽管存在所有负面因素，但在指定的跟踪器中没有实际的错误报告）。

由于这是向 Microsoft 传达请求和问题的官方渠道之一，我建议您也通过它来获得更快的答案。至少，如果您希望以一种或另一种方式解决该问题，则在那里投票支持该票和/或验证该问题将有助于引起 Microsoft PM 和工程师对该问题的注意，并可能提高其感知的优先级。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-19T21:26:22.643

刚刚试用了 VS2010 测试版，这一切都是在 WPF 中完成的，它严重受到字体模糊问题的影响。特别是在工具提示上。

这似乎提供了一些证据表明 WPF4 实际上不会解决问题（如果看起来更糟的话）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-06-10T16:55:16.870

哇，我不敢相信我终于让我的 WPF 字体可读了。而且我也不敢相信没有选项对话框可以使这些更改变得容易，而默认值在我的显示器上很糟糕。

这些[注册表设置](http://msdn.microsoft.com/en-us/library/aa970267.aspx)（十进制）对我有用，并且最接近我的常规 cleartype 字体：

*   ClearTypeLevel：10（主要是灰度混叠）
*   GammaLevel：1300（更高的 gamma 使字体太细，我看到了锯齿中的颜色）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-10T07:04:28.607

他们说“SnapToDevicePixels = true”有效，但我从未见过任何好的结果。

我通过切换到不同的字体来对抗模糊的文本。

显然这不是问题的解决方案，但是这就是我解决它的方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-03-26T12:09:46.800

如果您更喜欢使用 C# 基类为您的应用程序自定义窗口（或者现在有理由这样做），您可以通过以下方式设置文本格式以使用吸引人的显示模式：

```
public class SnappyWindow : Window
{
    public SnappyWindow()
    {
        SetValue(TextOptions.TextFormattingModeProperty, TextFormattingMode.Display);
    }
} 
```

# c# - 显式多核 C# 应用程序

> ID：190349
> 
> 赞同：5
> 
> 时间：2008-10-10T06:52:10.410
> 
> 标签：c#, multicore, runtime-environment

是否有任何*简单*的方法可以显式地使已经线程化的应用程序利用多核环境？（如果有）。

第一个问题是如何确定我的运行时环境是否支持多核应用程序？

如果我确定我可以使用多核功能，我可以显式分配线程以在不同的内核上运行吗？如果是这样，线程通信是由操作系统/硬件处理还是我必须弄脏我的手？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T07:00:19.020

如果您的应用程序已经正确线程化，则您无需执行任何操作。线程上下文执行和处理为您完成。

现在谈到线程，您的应用程序是否以利用内核的方式进行线程化？您是否将处理器密集型任务拆分为单独的线程。如果没有，那么您将需要进行更改以将处理任务拆分为更多线程。您可以使用 Environment.ProcessorCount 获取核心计数，并在运行时为您的任务创建尽可能多的线程。

到目前为止，实际上没有任何方法可以利用所有处理器/内核将不正确的线程应用程序（单线程）变成线程应用程序，除非您期待未来的技术，例如[plinq](http://msdn.microsoft.com/en-us/magazine/cc163329.aspx)和[Parallel FX](http://en.wikipedia.org/wiki/Parallel_FX_Library)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T07:00:37.273

嗨，我知道有 2 个扩展名

[并行 C# 主页](http://www.parallelcsharp.com/)

[查看 MS June CTP 上的 Somasegars MSDN 博客，了解并行 3.5 扩展](http://blogs.msdn.com/somasegar/archive/2008/06/02/june-2008-ctp-parallel-extensions-to-the-net-fx.aspx)

MSDN

该库由以下组件组成：

*   任务并行库 (TPL)，它为命令式数据和任务并行提供支持。
*   并行 LINQ (PLINQ)，它提供对声明性数据并行性的支持。
*   协调数据结构 (CDS)，为工作协调和管理共享状态提供支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T07:00:55.680

Currently, you can set the available processors for a given **process** using [Process.ProcessorAffinity](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.processoraffinity.aspx), but assigning specific threads to specific processors is handled under the hood implicitly. This is actually a good thing most of the time, as an intelligent runtime using real-time performance and load balance information can usually do a better job than you can statically, at least for the few-core context mainstream multicore operates in.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T10:14:12.827

那就是问题所在。如何制作线程应用程序，如何转换现有代码。我想在 C# 中利用多核。但是，ParallelFX 仍处于测试阶段。我不会使用测试版进行开发。而且，我不想再次更改所有代码（我从 VB 6 翻译了我的应用程序）。今天，我收到了来自 Packt Publishing 的时事通讯，其中宣布了一本关于使用 C# 进行并行编程的新书。C# 2008 和 2005 线程编程。我认为它集中在我们到处写博客的事情上。如何在不等待新的奇迹语言的情况下思考和开发线程应用程序。看到完全专注于该主题的书籍很酷，因为我们有很多关于该主题的博客。链接是[http://www.packtpub.com/beginners-guide-for-C-sharp-2008-and-2005-threaded-programming/book](http://www.packtpub.com/beginners-guide-for-C-sharp-2008-and-2005-threaded-programming/book) 我认为它值得一个机会。当我购买它时，我会告诉你我的反馈。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T06:56:13.117

在不深入细节的情况下（我不确定有多少信息是公开的），.NET 框架的下一个版本将更有帮助。您可能不想或不需要考虑手动管理线程。我确信在 PDC（10 月底）之后会公开更多关于此的信息。

# windows - Windows 冗余交换？

> ID：190350
> 
> 赞同：3
> 
> 时间：2008-10-10T06:53:12.780
> 
> 标签：windows, memory, windows-vista, operating-system

这可能不是严格的编程相关，而是更多的操作系统结构相关。

在具有 3GB 内存的全新笔记本电脑上运行 Vista 32 位，运行空闲系统会消耗大约 40% 的内存。除了这本身就令人发指的事实之外，操作系统**应该能够将所有进程很好地放入内存中**，并且永远不需要交换到磁盘。
然而，查看任务管理器，我发现进程总是出现页面错误。不是很多，但仍然。例如 explorer.exe 大约每秒有一个。

这是为什么？为什么操作系统觉得有必要换出页面，尽管它有足够的物理内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T06:57:46.360

页面错误并不一定意味着某些内容被分页到磁盘。现代操作系统具有页面可能处于的多个状态级别，例如，Windows 可能会区分正在积极使用的内存页面和一段时间未触及且可以分页的内存页面如果需要，磁盘。（这使得分页器的工作更容易，因为它只需要查看第二种页面来找出它可以分页的页面。）现在，页面如何从第二种状态返回到第一种状态？内核在该页面上设置一个位，指示如果有任何访问它，则该页面将被标记为“活动”并移回第一个状态。这会导致页面错误。

其他可能导致页面错误的事情是内存映射文件之类的事情。应用程序请求将文件映射到内存，也就是说，只要应用程序想要从中读取文件，它*就会出现在内存中。*显然，将整个文件一次全部加载到内存中会非常昂贵，因此内核只是用“如果曾经访问过，请页面错误”位标记内存空间，并在应用程序触及时从磁盘读取页。

实际情况比上述情况复杂得多，但这应该让您大致了解可能发生的情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T07:25:55.960

当您查看任务管理器时，资源管理器每秒都有一个页面错误是完全合乎逻辑的。任务管理器每秒更新一次，这也会更新通知区域中的图表。管理通知区域和图标的是 explorer.exe。因此，每次任务管理器更新它的小图时，资源管理器都需要从 taskmgr.exe 加载相应的图标，这会导致页面错误。（阅读更多关于[Raymond Chen 的优秀博客](http://blogs.msdn.com/oldnewthing/archive/2008/08/21/8880075.aspx)）

我很确定 Raymond Chen 解释了其他几个与页面错误有关的“问题”，但我现在找不到文章。基本上，页面错误并不总是意味着必须从磁盘加载某些内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T07:22:13.517

> 系统空闲运行会消耗大约 40% 的内存。

每当我再听到这个，我就想知道为什么人们会抱怨软件占用了系统资源。作为用户，我更喜欢操作系统占用我 40% 的内存（假设它没有用于其他用途）来进行积极的预取和缓存；它使最终体验更好，因为系统将比其他情况下拥有更多的内存命中（和更少的页面错误）。

至于广泛的分页，我认为（但不确定）这是另一种激进的缓存策略。如果系统内存变满（如果使用几个大型应用程序，例如 Visual Studio，或者甚至在 4GB 上运行一两个虚拟机，这在 1 GB 上很容易），系统将不得不分页在它可以将页面从磁盘读取到内存之前，将一些内存块输出到磁盘。如果操作系统在空闲时间积极地将非活动内存分页到磁盘，它可以在另一个进程出现页面错误时保存该操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T07:15:50.910

当然，Vista 使用您的计算机必须启动和运行得更快的内存。当其他程序需要它时，它将释放/交换内存。

为什么不使用资源，如果它在那里并且可用并且可以稍后发布而不会出现问题？

关于页面错误，请参阅此说明，任务管理器会创建这些错误：http: [//blogs.msdn.com/oldnewthing/archive/2008/08/21/8880075.aspx](http://blogs.msdn.com/oldnewthing/archive/2008/08/21/8880075.aspx)

（简短的摘要，每次任务管理器更新系统托盘图标时都会出现一个页面错误。将任务管理器的更新速度设置为高，您会得到更多的页面错误。这些页面错误不会交换内存）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T07:47:05.917

是的，我注意到了同样的事情。Windows XP 也会发生这种情况。

基本上，Windows 似乎有一个关于交换的“快速分配”策略：*保持大量可用内存，以便在需要时可用*。在内存有限的计算机上，这是一种具有某种意义的策略。加载大型程序无论如何都会导致一些交换，因此系统会提前执行此操作。
当然，在具有大量内存的系统上，这没有任何意义。在我的一台计算机上，我有 3 GB RAM 的 XP。如果我只是关闭页面文件，计算机会更快！
此外，此策略对“外壳加载”时间有影响：外壳加载是指在您登录和实际能够使用计算机之间发生的任何事情。在加载大量驻留托盘图标程序的同时进行交换，导致磁盘的使用效率非常低。

在我安装了 Linux 的其他计算机上，它有不同的策略：*除非没有更多内存，否则永远不要使用交换*。由于 Linux 通常在内存消耗方面非常小（应用程序是真正的猪），这是一个很好的策略，它会导致更快的“shell 加载”时间。如果您有足够的内存，则交换文件基本上是关闭的，直到需要它为止。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T11:13:58.620

“空闲内存”是一个有问题的术语。在任何给定时刻，最好所有字节都在磁盘和 RAM 中。这样，如果任何程序突然变成 2GB，操作系统就可以在没有磁盘 I/O 的情况下满足该请求。只需将 RAM 清零即可。无论字节是逻辑上的“文件字节”（即 RAM 是缓存）还是“进程字节”（即磁盘字节被分页），这都是正确的。

显然，出于工程原因，您不能同时在磁盘和 RAM 中拥有所有字节。但是你当然不应该仅仅因为它们也在磁盘上就从 RAM 中抛出字节。如果你有一个旋转的磁盘和 RAM 页面在一分钟内没有改变，那么先发制人地写出字节是有意义的。您可能希望操作系统以较低的优先级执行此操作，但优先 I/O 在 Windows 上不太常见（Vista 的新功能，老实说，这是 1.0 实现）

# scala - 在 Scala 中在运行时获取类型的字符串表示

> ID：190368
> 
> 赞同：10
> 
> 时间：2008-10-10T07:04:13.367
> 
> 标签：scala, types

在 Scala 中，是否可以在运行时获取类型的字符串表示形式？我正在尝试按照以下方式做一些事情：

```
def printTheNameOfThisType[T]() = {
  println(T.toString)
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-07-02T17:42:55.117

在 Scala 2.10 及更高版本中，使用`TypeTag`，它包含完整的类型信息。您需要包含该`scala-reflect`库才能执行此操作：

```
import scala.reflect.runtime.universe._
def printTheNameOfThisType[T: TypeTag]() = {
  println(typeOf[T].toString)
} 
```

您将获得如下结果：

```
scala> printTheNameOfThisType[Int]
Int

scala> printTheNameOfThisType[String]
String

scala> printTheNameOfThisType[List[Int]]
scala.List[Int] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-10T08:53:43.723

# 注意：此答案已过时！

*请参阅使用 Scala 2.10 及更高版本的 TypeTag 的答案*

我可以在 freenode 上推荐#Scala

```
10:48 <seet_> http://stackoverflow.com/questions/190368/getting-the-string-representation-of-a-type-at-runtime-in-scala <-- isnt this posible?
10:48 <seet_> possible
10:48 <lambdabot> Title: Getting the string representation of a type at runtime in Scala - Stack Overflow,
                  http://tinyurl.com/53242l
10:49 <mapreduce> Types aren't objects.
10:49 <mapreduce> or values
10:49 <mapreduce> println(classOf[T]) should give you something, but probably not what you want. 
```

[classOf 的描述](http://www.scala-lang.org/node/109)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-24T23:30:25.307

Scala 中有一个新的、大部分未记录的特性，称为“清单”。它是这样工作的：

```
object Foo {
  def apply[T <: AnyRef](t: T)(implicit m: scala.reflect.Manifest[T]) = println("t was " + t.toString + " of class " + t.getClass.getName() + ", erased from " + m.erasure)
} 
```

AnyRef 绑定只是为了确保该值具有 .toString 方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-12T10:00:09.160

请注意，这并不是真正的“事情：”

```
object Test {
    def main (args : Array[String]) {
    println(classOf[List[String]])
    }
} 
```

给

```
$ scala Test                    
class scala.List 
```

我认为您可以将此归咎于擦除

====EDIT==== 我尝试过使用带有泛型类型参数的方法：

```
object TestSv {
  def main(args:Array[String]){
    narf[String]
  }
  def narf[T](){
    println(classOf[T])
  }
} 
```

并且编译器不会接受它。类型不是类是解释

# java - String.hashCode() 是否可以跨 VM、JDK 和操作系统移植？

> ID：190376
> 
> 赞同：7
> 
> 时间：2008-10-10T07:11:00.497
> 
> 标签：java, hashcode

最近出现了一个有趣的问题。我们遇到了一些`hashCode()`用作 MD5 加密的盐源的代码，但这提出了一个问题：`hashCode()`在不同的 VM、不同的 JDK 版本和操作系统上是否会为相同的对象返回相同的值？即使不能保证，到现在为止它有没有改变？

编辑：我的意思是`String.hashCode()`而不是更一般`Object.hashCode()`的，当然可以被覆盖。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T07:14:19.773

没有。来自[http://tecfa.unige.ch/guides/java/langspec-1.0/javalang.doc1.html](http://tecfa.unige.ch/guides/java/langspec-1.0/javalang.doc1.html)：

> hashCode 的一般合约如下：
> 
> *   每当在 Java 应用程序执行期间对同一对象多次调用它时，hashCode 必须始终返回相同的整数。整数可以是正数、负数或零。然而，这个整数不必从一个 Java 应用程序到另一个 Java 应用程序，或从一个应用程序的一次执行到同一应用程序的另一次执行保持一致。[...]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T08:02:33.873

这取决于类型：

*   如果你有一个没有覆盖 hashCode() 的类型，那么每次运行程序时它可能会返回不同的 hashCode()。
*   如果你有一个覆盖 hashCode() 的类型但没有记录它是如何计算的，那么对于具有相同数据的对象在每次运行时返回不同的哈希值是完全合法的，只要它为重复返回相同的哈希值在同一次运行中调用。
*   如果您有一个以记录方式覆盖 hashCode() 的类型，即算法是记录行为的一部分，那么您可能是安全的。（例如，java.lang.String 记录了这一点。）但是，我个人仍然避免在一般原则上*依赖它。*

只是来自 .NET 世界的一个警示故事：我已经看到至少有几个人因为使用 string.GetHashCode() 的结果作为他们在数据库中的密码散列而感到痛苦。该算法在 .NET 1.1 和 2.0 之间发生了变化，突然间所有的哈希值都“错误”了。（Jeffrey Richter 通过 C# 在 CLR 中记录了几乎相同的情况。）当*确实*需要存储哈希时，我希望它以*始终*保证稳定的方式计算 - 例如 MD5 或由您的类型具有稳定性的保证。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T15:24:23.500

根据[文档](http://java.sun.com/javase/6/docs/api/java/lang/String.html#hashCode())： String 对象的哈希码计算为

```
s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1] 
```

我不确定这是一个正式的规范还是只是 Sun 的实现。至少，在所有现有的 Sun VM 上，它应该是相同的，无论平台或操作系统如何。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T08:08:13.610

不可以。除非另有说明，否则不保证哈希算法。因此例如，哈希结构的反序列化需要重新计算哈希码，而这些值不应该以序列化的形式存储。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T07:38:31.020

我想补充一点，您可以覆盖 hashCode()（如果这样做，请不要忘记 equals()）以确保您的业务对象在任何地方都返回相同的 hashCode。然后，这些对象将至少具有可预测的 hashCode。

# java - 在链表中的单个索引处存储超过 1 个数据项？

> ID：190380
> 
> 赞同：2
> 
> 时间：2008-10-10T07:13:50.990
> 
> 标签：java, collections, linked-list

我试图在我的链表中的单个索引中存储超过 1 个数据项。我教科书中的所有示例似乎都说明了每个索引只添加一条数据。我假设可以添加更多？

例如，使用 Collections API 存储整数，我会执行以下操作：

```
LinkedList <Integer>linky = new LinkedList<Integer>();
int num1 = 2, num2 = 22, num3 = 25, num4 = 1337;
linky.add(num1); 
```

我将如何将 num2、num3 和 num4 添加到列表中的相同第一个索引？多谢你们。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-10T07:18:12.060

关于链表的工作方式似乎有点混乱。本质上，链表由节点组成，每个节点都包含一个数据（一个对象，准确地说，它本身可以包含多个成员变量），以及指向链表中下一个节点的链接（如果存在则为空指针）是没有这样的下一个节点）。您还可以有一个双向链表，其中每个节点还有一个指向列表中前一个节点的指针，以加速某些类型的访问模式。

将多个“数据片段”添加到单个节点听起来就像从一个节点添加多个链接，这会将您的链接列表变成 N-ary *tree*。

要将多条数据添加到列表的末尾，以最常与链表关联的方式，只需执行以下操作：

```
LinkedList <Integer>linky = new LinkedList<Integer>();
int num1 = 2, num2 = 22, num3 = 25, num4 = 1337;
linky.add(num1);
linky.add(num2);
linky.add(num3);
linky.add(num4); 
```

## 或者，如果您希望链表的每个节点都有几条数据

这些数据应该打包成一个**对象**（通过定义一个`class`将它们全部作为成员变量的对象）。例如：

```
class GroupOfFourInts
{
   int myInt1;
   int myInt2;
   int myInt3;
   int myInt4;

   public GroupOfFourInts(int a, int b, int c, int d)
   {
     myInt1 = a; myInt2 = b; myInt3 = c; myInt4 = d;
   }
}

class someOtherClass
{

  public static void main(String[] args)
  {
    LinkedList<GroupOfFourInts> linky = new LinkedList<GroupOfFourInts>();
    GroupOfFourInts group1 = new GroupOfFourInts(1,2,3,4);
    GroupOfFourInts group2 = new GroupOfFourInts(1337,7331,2345,6789);
    linky.add(group1);
    linky.add(group2);
  }
} 
```

现在，`linky`将有 2 个节点，每个节点将包含 4 个`int`，*myInt1*，*myInt2*，*myInt3*和*myInt4*。

## 笔记

以上都不是链表特有的。每当您想将一堆数据作为一个单元存储在一起时，都应该使用这种模式。您创建一个类，其中包含要存储在一起的每条数据的成员变量，然后创建该类型的任何 Java 集合类型（ArrayList、LinkedList、TreeList...）。

确保您要使用链表（因为在选择 ArrayList 或 TreeList 时不会因编程困难而受到惩罚）。这将取决于您的数据访问模式。链表提供 O(1) 添加和删除，但 O(n) 查找，而 ArrayList 提供 O(1) 查找，但 O(n) 任意添加和删除。TreeLists 提供 O(log n) 的插入、删除和查找。这些之间的权衡取决于您拥有的数据量以及您将如何修改和访问数据结构。

当然，如果您的列表中只有 <100 个元素，这些都不重要；-)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T07:17:04.293

使用结构。

例如：

```
private struct Node
{
    int Num1;
    int Num2;
    int Num3;
} 
```

...

```
LinkedList<Node> list = new LnkedList<Node>();

Node n = new Node();
n.Num1 = 10;
n.Num2 = 100;
n.Num3 = 1000;
list.Add(n); 
```

笔记; 我假设这是在 C# 中；如果我错了，请纠正我，我会修复代码；）

如果您还没有在书中讨论过 OOP - 那么我建议您尝试一下；它将帮助您解决此类问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T07:18:07.177

为什么不这样：

```
LinkedList<LinkedList<Integer>> linky = new LinkedList<LinkedList<Integer>>();
//...
linky.add(new LinkedList<Integer>().add( //... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T07:21:33.237

就像尼尔森说的那样，你需要另一个对象，在 Java 中虽然你需要使用一个类。如果您需要在您正在工作的类之外使用“节点”类，那么您需要将其设为公共类，并将其移动到它自己的文件中。

```
private Class Node
{
    //You might want to make these private, and make setters and getters
    public int Num1;
    public int Num2;
    puclic int Num3;
}

LinkedList<Node> list = new LinkedList<Node>();

Node n = new Node();
n.Num1 = 10;
n.Num2 = 100;
n.Num3 = 1000;
list.Add(n); 
```

向尼尔森道歉，因为他窃取了他的代码；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T07:28:44.347

这是一个完整的代码示例，展示了将结构添加到链表的用法：

```
import java.util.LinkedList;
class Node {
    int num1;
    int num2;
    int num3;
    int num4;
    public Node(int a, int b, int c, int d) {
        num1 = a; num2 = b; num3 = c; num4 = d;
    }
}
public class dummy {
    public static void main(String[] args) {
        LinkedList <Node>linky = new LinkedList<Node>();
        x myNode = new Node(2, 22, 25, 1337);
        linky.add(myNode);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T07:35:30.353

我不太了解您要实现的目标，因此我建议解决该问题的另一种阅读方式（在Java中）。

```
LinkedList <Integer>linky = new LinkedList<Integer>();
linky.add(num1);

// Lots of code possibly adding elements somewhere else in the list

if (linky.size() > 0) { // Always good to be sure; especially if this is in another methode
 int first = linky.get(0);
 linky.set(0, first + num2);// Value of linky.get(0) is num1 + num2 
}

// The same again
// Lots of code possibly adding elements somewhere else in the list

if (linky.size() > 0) { // Always good to be sure; especially if this is in another methode
 int first = linky.get(0);
 linky.set(0, first + num3); // Value of linky.get(0) is num1 + num2 + num3
} 
```

如果要添加的数字数量是恒定的（num1 .. num4），我个人碰巧最喜欢 Nelson 的解决方案，如果它不是恒定的，我更喜欢 Gregor 的解决方案（使用 List 而不是 Node）。如果你在 java 中使用 Node 方法，我建议：

```
// added static, Class to class
private static class Node
{
    //You might want to make these private, and make setters and getters
    public int Num1;
    public int Num2;
    puclic int Num3;
}

// Prefer interfaces if possible
List<Node> list = new LinkedList<Node>();

Node n = new Node();
n.Num1 = 10;
n.Num2 = 100;
n.Num3 = 1000;
list.add(n); // Add -> add 
```

很多吹毛求疵，但我认为如果可能的话，最好使用静态类而不是非静态私有类（通常应该是可能的）。

# c# - 如何在 C# 中以像素级别操作图像

> ID：190385
> 
> 赞同：46
> 
> 时间：2008-10-10T07:15:43.623
> 
> 标签：c#, image-processing, image-manipulation

如何在 C# 中处理像素级别的图像？

我需要能够分别读取/修改每个位图像素 RGB 值。

代码示例将不胜感激。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-10-10T07:19:05.583

如果你想要速度，那么[LockBits](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.lockbits.aspx)。~~请参阅此处了解 Bob Powell 的精彩演练~~。如果你只想编辑一些，那么[GetPixel](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.getpixel.aspx) / [SetPixel](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.setpixel.aspx)应该做你想做的。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-10T07:31:28.287

一个示例代码例程（我将其用于简单的合并和比较功能。它需要两张图像并生成第三张灰度图像，以灰度色调级别显示两幅图像之间的差异。它越暗，差异越大。）：

```
 public static Bitmap Diff(Bitmap src1, Bitmap src2, int x1, int y1, int x2, int y2, int width, int height)
{
    Bitmap diffBM = new Bitmap(width, height, PixelFormat.Format24bppRgb);

    for (int y = 0; y < height; y++)
    {
        for (int x = 0; x < width; x++)
        {
            //Get Both Colours at the pixel point
            Color col1 = src1.GetPixel(x1 + x, y1 + y);
            Color col2 = src2.GetPixel(x2 + x, y2 + y);

            // Get the difference RGB
            int r = 0, g = 0, b = 0;
            r = Math.Abs(col1.R - col2.R);
            g = Math.Abs(col1.G - col2.G);
            b = Math.Abs(col1.B - col2.B);

            // Invert the difference average
            int dif = 255 - ((r+g+b) / 3);

            // Create new grayscale RGB colour
            Color newcol = Color.FromArgb(dif, dif, dif);

            diffBM.SetPixel(x, y, newcol);

        }
    }

    return diffBM;
} 
```

[Marc 的帖子](https://stackoverflow.com/questions/190385/how-to-manipulate-images-at-pixel-level-in-c/190395#190395)记录了 LockBits 并使用它直接在内存中修改图像。如果性能是一个问题，我建议查看它而不是我发布的内容。谢谢马克！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T07:27:53.240

System.Drawing.Bitmap 有一个返回 System.Drawing.Color 结构的 GetPixel(int x, int y) 公共方法。该结构具有字节成员 R、G、B 和 A，您可以直接修改它们，然后再次在 Bitmap 上调用 SetPixel(Color)。
不幸的是，这会相对较慢，但这是在 C# 中最简单的方法。如果您经常使用单个像素并发现性能不足，并且您需要更快的东西，您可以使用 LockBits...不过它要复杂得多，因为您需要了解该颜色深度和类型的位结构, 并使用位图的步幅，什么不是......所以如果你发现它是必要的，请确保你找到一个好的教程！网上有几个，谷歌搜索“C# LockBits”

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T08:33:06.900

如果性能至关重要，LockBits 的另一种替代方法是托管 DirectX。

有关更多信息，请参阅前面的 Stack Overflow 问题*[Rendering graphics in C#](https://stackoverflow.com/questions/58230/rendering-graphics-in-c#58242)*。

与 Lockbits 一样，您将需要使用 unsafe 关键字/编译器开关，但您可以获得高性能的像素级访问。

与使用普通的 Bitmap 类和 PictureBox 控件相比，您还可以通过 DirectX 后缓冲获得更高性能的屏幕渲染。

# html - 使用 CSS 内容添加 HTML 实体

> ID：190396
> 
> 赞同：1092
> 
> 时间：2008-10-10T07:19:25.160
> 
> 标签：html, css, html-entities, css-content

如何使用**CSS** `content`属性添加**HTML**实体？

使用这样的东西只是打印`&nbsp;`到屏幕而不是不间断的空间：

```
.breadcrumbs a:before {
  content: '&nbsp;';
} 
```

* * *

## 回答 #1

> 赞同：1143
> 
> 时间：2008-10-10T07:27:52.243

您必须使用转义的 unicode ：

像

```
.breadcrumbs a:before {
  content: '\0000a0';
} 
```

更多信息：[http ://www.evotech.net/blog/2007/04/named-html-entities-in-numeric-order/](http://www.evotech.net/blog/2007/04/named-html-entities-in-numeric-order/)

* * *

## 回答 #2

> 赞同：190
> 
> 时间：2011-12-21T20:18:08.320

CSS 不是 HTML。 `&nbsp;`是 HTML 中的命名[字符引用](https://www.w3.org/TR/html52/syntax.html#character-references)；相当于十进制数字字符引用`&#160;`。160 是[Unicode](http://unicode.org/)（或[UCS-2](http://en.wikipedia.org/wiki/Universal_Character_Set)；请参阅[HTML 4.01 规范](https://www.w3.org/TR/1999/REC-html401-19991224/charset.html#h-5.1)）中字符的十进制*代码点。*该代码点的十六进制表示为 U+00A0 (160 = 10 × 16 ¹ + 0 × 16 ⁰ )。您会在 Unicode[代码图表](http://www.unicode.org/charts/)和[字符数据库](http://unicode.org/ucd)中找到它。`NO-BREAK SPACE`

在 CSS 中，您需要对此类字符使用 Unicode 转义序列，该转义序列基于字符代码点的十六进制值。所以你需要写

```
.breadcrumbs a:before {
  content: '\a0';
} 
```

只要转义序列在字符串值中最后出现，这就会起作用。如果字符跟随，有两种方法可以避免误解：

a）（其他人提到）使用恰好六个十六进制数字作为转义序列：

```
.breadcrumbs a:before {
  content: '\0000a0foo';
} 
```

b) 在转义序列后添加一个空白（例如空格）字符：

```
.breadcrumbs a:before {
  content: '\a0 foo';
} 
```

（因为`f`是十六进制数字，`\a0f`否则`GURMUKHI LETTER EE`在这里表示，或者如果您有合适的字体，则表示 ਏ。）

分隔空白将被忽略，这将被显示` foo`，此处显示的空格将是一个`NO-BREAK SPACE`字符。

空白方法 ( `'\a0 foo'`) 与六位数方法 ( `'\0000a0foo'`) 相比具有以下优点：

*   键入更**容易**，因为不需要前导零，也不需要计算数字；
*   它**更容易阅读**，因为转义序列和后面的文本之间有空格，并且不需要计算数字；
*   它**需要更少的空间**，因为不需要前导零；
*   它是**向上兼容的**，因为将来支持 U+10FFFF 之外的 Unicode 代码点需要修改 CSS 规范。

因此，要在转义字符后显示一个空格，请在样式表中使用*两个*空格 -</p>

```
.breadcrumbs a:before {
  content: '\a0  foo';
} 
```

– 或明确表示：

```
.breadcrumbs a:before {
  content: '\a0\20 foo';
} 
```

有关详细信息，请参阅[CSS 2.1，“4.1.3 字符和大小写”部分](http://www.w3.org/TR/CSS2/syndata.html#escaped-characters)。

* * *

## 回答 #3

> 赞同：84
> 
> 时间：2009-09-11T19:09:41.020

**更新**：PointedEars 提到，`&nbsp;`在所有 css 情况下，正确的代表将
`'\a0 '`暗示该空间是十六进制字符串的终止符，并被转义序列吸收。他进一步指出了这个[权威的描述](http://www.w3.org/TR/CSS2/syndata.html#escaped-characters)，这听起来像是对我在下面描述和修复的问题的一个很好的解决方案。

您需要做的是使用转义的 unicode。尽管有人告诉您，这并不是CSS`\00a0`中的完美替代品；`&nbsp;`所以试试：

```
content:'>\a0 ';          /* or */
content:'>\0000a0';       /* because you'll find: */
content:'No\a0 Break';    /* and */
content:'No\0000a0Break'; /* becomes No&nbsp;Break as opposed to below */ 
```

具体使用`\0000a0`as `&nbsp;`。如果您按照 mathieu 和 millikin 的建议尝试：

```
content:'No\00a0Break'   /* becomes No&#2571;reak */ 
```

它将 B 带入十六进制转义字符。0-9a-fA-F 也是如此。

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2011-12-15T16:55:07.757

在 CSS 中，您需要使用 Unicode 转义序列来代替 HTML 实体。这是基于字符的十六进制值。

我发现将符号转换为十六进制等价物的最简单方法是，例如从 ▾ ( `&#9662;`)`\25BE`到使用 Microsoft 计算器 =)

是的。启用程序员模式，打开十进制，输入`9662`，然后切换到十六进制，你会得到`25BE`. 然后只需在开头添加一个反斜杠`\`。

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2008-10-10T07:24:21.623

使用十六进制代码作为不间断空格。像这样的东西：

```
.breadcrumbs a:before {
  content: '>\00a0';
} 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-12-05T08:16:34.760

有一种方法可以粘贴一个`nbsp`打开的 CharMap 并复制**字符 160**。但是，在这种情况下，我可能会用填充将其隔开，如下所示：

```
.breadcrumbs a:before { content: '>'; padding-right: .5em; } 
```

不过，您可能需要设置面包屑`display:inline-block`或其他东西。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2015-05-07T15:35:02.837

例如 ：

[http://character-code.com/arrows-html-codes.php](http://character-code.com/arrows-html-codes.php)

示例：如果您想选择您的角色，我选择了“↬”“↬”（我们使用**HEX**值）

```
.breadcrumbs a:before {
  content: '\0021ac';
} 
```

结果：↬</p>

就是这样 ：）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-06T08:47:21.750

**这里有两种方法：**

*   在 HTML 中：

    `<div class="ics">&#9969;</div>`

这将导致⛱

*   在 CSS 中：

    `.ics::before {content: "\9969;"}`

带有 HTML 代码`<div class="ics"></div>`

这也导致⛱

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-11-04T06:36:48.150

我知道这是一篇很老的帖子，但如果间距是你所追求的，为什么不简单地：

```
.breadcrumbs a::before {
  content: '>';
  margin-left: 8px;
  margin-right: 8px;
} 
```

我以前用过这种方法。在我的测试中，它可以完美地包裹在其他行中，并带有“>”。

# visual-studio - 如何在 Visual Studio 中获得 Emacs 样式的键绑定？

> ID：190402
> 
> 赞同：34
> 
> 时间：2008-10-10T07:22:35.560
> 
> 标签：visual-studio, configuration, emacs, keyboard-shortcuts

如何在 Visual Studio 中获得 Emacs 样式的键绑定？它在设置中可用吗？我需要插件吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-10T07:25:47.067

您可以尝试 Emacs 键盘方案（**Tools->Options->Environment->Keyboard**）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-30T11:08:00.370

[Xkeymacs](http://www.cam.hi-ho.ne.jp/oishi/indexen.html)在这方面做得非常好。可以为桌面上运行的每个应用程序配置此工具。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T07:28:16.610

**使用设置：**

尝试环境选项上的 Emacs 键盘方案。

**插件：**

我只见过这个：[VisEmacs](http://sourceforge.net/projects/visemacs/)，它将 Emacs 集成为 Visual Studio 的默认文本编辑器。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-09-01T21:03:02.133

在发布 Emacs 键绑定/仿真将[不再](https://web.archive.org/web/20160314030416/https://connect.microsoft.com/VisualStudio/feedback/details/465750/emacs-keyboard-mapping-scheme-not-working-in-visual-studio-2010-beta-1)在 Visual Studio 2010 中可用之后，[Emacs Emulation 现在可作为 VS 2010 的免费扩展使用](https://devblogs.microsoft.com/visualstudio/emacs-emulation-extension-now-available/)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-03-20T17:31:42.230

对于 VS2019，它是社区编写的扩展。

（安装扩展）

1.  打开 Visual Studio 2019
2.  单击扩展 -> 管理扩展
3.  在左侧面板中选择“在线”。
4.  在搜索框中，输入“emacs”
5.  截至 2020 年 3 月，“Emacs Emulation 2”似乎已经成为现实。选择它并单击“下载”
6.  关闭窗口并关闭所有打开的 Visual Studio 副本。VSIX 安装程序将在您的许可下安装插件。

（开启 EMACS）

7.  打开 Visual Studio
8.  使用菜单工具 -> 自定义。单击底部的“键盘”按钮。
9.  在顶部的框中将有一个以前没有的 EMACS 方案。选择。单击确定。
10.  关闭并重新打开任何代码/文本编辑窗口。

按 Ctrl-A、Ctrl-E、Ctrl-F.. 在寒冷的日子里感觉就像一条温暖的毯子。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-21T02:15:46.660

我使用[VisEmacs](http://sourceforge.net/projects/visemacs/)是因为 emacs 键盘方案不如 emacs 本身那么好。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-02-06T06:17:49.993

不幸的是，VS 2010 的[Emacs 仿真扩展](http://visualstudiogallery.msdn.microsoft.com/09dc58c4-6f47-413a-9176-742be7463f92)并未正式支持 VS 2012。

但是，如果按照[此答案中概述的步骤获取有关在 VS2012 中获取 Emacs 键绑定的 SO 问题，则可以使用解决方法](https://stackoverflow.com/a/14087731/4872)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-30T14:49:01.127

我用了几天的 Emacs 键盘方案，但它很快就把我逼疯了——我无法像在 Emacs 中习惯的那样重新绑定键（或者找不到快速重新绑定的方法）。

我应该试试 XKeyMacs....

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-01-29T19:04:35.597

如果您使用的是 Visual Studio Express 2008 并且想要 Emacs 键绑定，那么您需要安装 VSE 2008 的 Visual C++ 版本。最初我只安装了 C# 版本，并且在**Tools->Options->Environment中没有自定义键绑定- >键盘**。一旦我安装了 C++ 版本，Emacs 键绑定就可以在两个产品中使用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-10T07:25:30.907

对“visual studio emacs”的快速实时搜索给出了[这个页面](http://msdn.microsoft.com/en-us/library/ms165509(VS.80).aspx)。我不确定它有多彻底（我自己从未使用过emacs）。

# php - 在 PHP 中获取调用者函数的名称？

> ID：190421
> 
> 赞同：148
> 
> 时间：2008-10-10T07:31:47.537
> 
> 标签：php

是否有一个 PHP 函数可以找出给定函数中调用者函数的名称？

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2008-10-10T07:37:32.457

请参阅[debug_backtrace](http://php.net/manual/en/function.debug-backtrace.php) - 这可以将您的调用堆栈一直跟踪到顶部。

以下是您获取来电者的方法：

```
$trace = debug_backtrace();
$caller = $trace[1];

echo "Called by {$caller['function']}";
if (isset($caller['class']))
    echo " in {$caller['class']}"; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-03-29T22:49:43.950

Xdebug 提供了一些不错的功能。

```
<?php
  Class MyClass
  {
    function __construct(){
        $this->callee();
    }
    function callee() {
        echo sprintf("callee() called @ %s: %s from %s::%s",
            xdebug_call_file(),
            xdebug_call_line(),
            xdebug_call_class(),
            xdebug_call_function()
        );
    }
  }
  $rollDebug = new MyClass();
?> 
```

将返回跟踪

```
callee() called @ /var/www/xd.php: 16 from MyClass::__construct 
```

在 ubuntu 上安装 Xdebug 最好的方法是

```
sudo aptitude install php5-xdebug 
```

您可能需要先安装 php5-dev

```
sudo aptitude install php5-dev 
```

[更多信息](http://xdebug.org/docs/install)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-10T07:37:20.147

[`debug_backtrace()`](http://www.php.net/debug_backtrace)提供当前调用堆栈中参数、函数/方法调用的详细信息。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-10-10T06:12:25.693

这已经很晚了，但我想分享一个函数，它将给出调用当前函数的函数的名称。

```
public function getCallingFunctionName($completeTrace=false)
    {
        $trace=debug_backtrace();
        if($completeTrace)
        {
            $str = '';
            foreach($trace as $caller)
            {
                $str .= " -- Called by {$caller['function']}";
                if (isset($caller['class']))
                    $str .= " From Class {$caller['class']}";
            }
        }
        else
        {
            $caller=$trace[2];
            $str = "Called by {$caller['function']}";
            if (isset($caller['class']))
                $str .= " From Class {$caller['class']}";
        }
        return $str;
    } 
```

我希望这会有用。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-08-28T09:42:49.850

```
echo debug_backtrace()[1]['function']; 
```

从[PHP 5.4](http://php.net/manual/en/migration54.new-features.php)开始工作。

或优化（例如对于非调试用例）：

```
echo debug_backtrace( DEBUG_BACKTRACE_IGNORE_ARGS, 2)[1]['function']; 
```

第一个参数防止填充未使用的函数参数，第二个将跟踪限制为两个级别（我们需要第二个）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-09-17T16:24:22.057

做了这个并自己使用

```
/**
 * Gets the caller of the function where this function is called from
 * @param string what to return? (Leave empty to get all, or specify: "class", "function", "line", "class", etc.) - options see: http://php.net/manual/en/function.debug-backtrace.php
 */
function getCaller($what = NULL)
{
    $trace = debug_backtrace();
    $previousCall = $trace[2]; // 0 is this call, 1 is call in previous function, 2 is caller of that function

    if(isset($what))
    {
        return $previousCall[$what];
    }
    else
    {
        return $previousCall;
    }   
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-03-04T08:40:55.600

我只是想说弗洛里的方式不能作为一个函数工作，因为它总是返回被调用的函数名而不是调用者，但我没有评论的声誉。我根据弗洛里的回答做了一个非常简单的函数，适用于我的情况：

```
class basicFunctions{

    public function getCallerFunction(){
        return debug_backtrace( DEBUG_BACKTRACE_IGNORE_ARGS, 3)[2]['function'];
    }

} 
```

## 例子：

```
function a($authorisedFunctionsList = array("b")){
    $ref = new basicFunctions;
    $caller = $ref->getCallerFunction();

    if(in_array($caller,$authorisedFunctionsList)):
        echo "Welcome!";
        return true;
    else:
        echo "Unauthorised caller!";
        return false; 
    endif;
}

function b(){
    $executionContinues = $this->a();
    $executionContinues or exit;

    //Do something else..
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-10T07:38:43.610

[您可以从debug_backtrace](http://uk3.php.net/debug_backtrace)返回的数组中提取此信息

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-11-21T21:09:58.863

这个最适合我：`var_dump(debug_backtrace());`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-06-06T09:28:41.683

实际上，我认为 debug_print_backtrace() 可以满足您的需求。 [http://php.net/manual/en/function.debug-print-backtrace.php](http://php.net/manual/en/function.debug-print-backtrace.php)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-02-26T18:08:53.170

这应该有效：

```
$caller = next(debug_backtrace())['function']; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-30T19:51:43.003

这会很好地做到这一点：

```
 // Outputs an easy to read call trace
// Credit: https://www.php.net/manual/en/function.debug-backtrace.php#112238
// Gist: https://gist.github.com/UVLabs/692e542d3b53e079d36bc53b4ea20a4b

Class MyClass{

public function generateCallTrace()
{
    $e = new Exception();
    $trace = explode("\n", $e->getTraceAsString());
    // reverse array to make steps line up chronologically
    $trace = array_reverse($trace);
    array_shift($trace); // remove {main}
    array_pop($trace); // remove call to this method
    $length = count($trace);
    $result = array();

    for ($i = 0; $i < $length; $i++)
    {
        $result[] = ($i + 1)  . ')' . substr($trace[$i], strpos($trace[$i], ' ')); // replace '#someNum' with '$i)', set the right ordering
    }

    return "\t" . implode("\n\t", $result);
}

}

// call function where needed to output call trace

/**
Example output:
1) /var/www/test/test.php(15): SomeClass->__construct()
2) /var/www/test/SomeClass.class.php(36): SomeClass->callSomething()
**/``` 
```

# svn - 合并 git 后的 git-svn dcommit 危险吗？

> ID：190431
> 
> 赞同：135
> 
> 时间：2008-10-10T07:38:52.157
> 
> 标签：svn, git, merge, branch, git-svn

我尝试 git-svn 的动机是轻松的合并和分支。然后我注意到 man git-svn(1) 说：

> 不建议在您计划从其提交的分支上运行 git-merge 或 git-pull。Subversion 不代表任何合理或有用的合并；因此使用 Subversion 的用户看不到您所做的任何合并。此外，如果您从作为 SVN 分支镜像的 git 分支合并或拉取，dcommit 可能会提交到错误的分支。

这是否意味着我不能从 svn/trunk（或一个分支）创建一个本地分支，破解，合并回 svn/trunk，然后 dcommit？我知道 svn 用户会看到与 svn pre 1.5.x 中合并的相同混乱，但还有其他缺点吗？最后一句话也让我担心。人们是否经常做这些事情？

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2010-11-21T15:05:31.930

`--no-ff`实际上，我在 git merge 上找到了一个更好的方法。不再需要我以前使用的所有这些壁球技术。

我的新工作流程现在如下：

*   我有一个“主”分支，它是我 dcommit 的唯一分支，它克隆了 SVN 存储库（`-s`假设您在存储库中有一个标准的 SVN 布局`trunk/`、、`branches/`和`tags/`）：

    ```
    git svn clone [-s] <svn-url> 
    ```

*   我在本地分支“工作”上工作（`-b`创建分支“工作”）

    ```
    git checkout -b work 
    ```

*   在本地提交到“工作”分支（`-s`以签署您的提交消息）。在续集中，我假设你做了 3 次本地提交

    ```
    ...
    (work)$> git commit -s -m "msg 1"
    ...
    (work)$> git commit -s -m "msg 2"
    ...
    (work)$> git commit -s -m "msg 3" 
    ```

## 现在你想提交到 SVN 服务器

*   [最终] 将你不想看到的修改存储在 SVN 服务器上（通常你在主文件中注释了一些代码只是因为你想加速编译并专注于给定的特性）

    ```
    (work)$> git stash 
    ```

*   使用 SVN 存储库 rebase 主分支（从 SVN 服务器更新）

    ```
    (work)$> git checkout master
    (master)$> git svn rebase 
    ```

*   回到工作分支并与 master 进行 rebase

    ```
    (master)$> git checkout work
    (work)$> git rebase master 
    ```

*   确保一切正常，例如：

    ```
    (work)$> git log --graph --oneline --decorate 
    ```

*   现在是时候使用这个美妙的`--no-ff`选项将所有三个提交从“工作”分支合并到“主”

    ```
    (work)$> git checkout master
    (master)$> git merge --no-ff work 
    ```

*   您可以注意到日志的状态：

    ```
    (master)$> git log --graph --oneline --decorate
    * 56a779b (work, master) Merge branch 'work'
    |\  
    | * af6f7ae msg 3
    | * 8750643 msg 2
    | * 08464ae msg 1
    |/  
    * 21e20fa (git-svn) last svn commit 
    ```

*   现在您可能想要编辑 ( `amend`) 您的 SVN 帅哥的最后一次提交（否则他们只会看到一个带有“Merge branch 'work'”消息的提交

    ```
    (master)$> git commit --amend 
    ```

*   最后在 SVN 服务器上提交

    ```
    (master)$> git svn dcommit 
    ```

*   回去工作并最终恢复您隐藏的文件：

    ```
    (master)$> git checkout work
    (work)$> git stash pop 
    ```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-10-10T07:47:13.373

使用 git-svn 绝对可以创建本地分支。只要您只是为自己使用本地分支，而不是尝试使用 git 在上游 svn 分支之间进行合并，就可以了。

我有一个用于跟踪 svn 服务器的“主”分支。这是我 dcommit 的唯一分支。如果我正在做一些工作，我会创建一个主题分支并着手处理它。当我想提交它时，我会执行以下操作：

1.  将所有内容提交到主题分支
2.  git svn rebase *(解决你的工作和svn之间的任何冲突)*
3.  git结账大师
4.  git svn rebase *（这使下一步成为快进合并，请参阅下面 Aaron 的评论）*
5.  git 合并主题分支
6.  解决任何合并冲突*（此时不应该有）*
7.  git svn dcommit

我还有另一种情况，我需要维护一些永远不应该推送到 svn 的本地更改（用于调试）。为此，我有上面的 master 分支，但也有一个名为“work”的分支，我通常在那里工作。主题分支从工作中分支出来。当我想在那里提交工作时，我签出 master 并使用cherry-pick 从我想要提交到 svn 的工作分支中挑选提交。这是因为我想避免提交三个本地更改提交。然后，我从 master 分支 dcommit 并重新设置所有内容。

值得`git svn dcommit -n`首先运行以确保您即将提交您打算提交的内容。与 git 不同，在 svn 中重写历史很困难！

我觉得必须有更好的方法来合并主题分支上的更改，同时跳过那些本地更改提交而不是使用cherry-pick，所以如果有人有任何想法，他们会受到欢迎。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2010-12-28T13:34:25.590

**简单的解决方案：合并后删除“工作”分支**

**简短回答：**您可以随意使用 git（请参阅下面的简单工作流程），包括合并。只需确保在每个“ **git merge work** ”后面加上“ **git branch -d work** ”即可删除临时工作分支。

**背景说明：** 合并/dcommit 问题是，每当您“git svn dcommit”一个分支时，该分支的合并历史就会“变平”：git 忘记了进入该分支的所有合并操作：只保留文件内容，但是该内容（部分）来自特定的其他分支的事实丢失了。请参阅：[为什么 git svn dcommit 会丢失本地分支的合并提交历史记录？](https://stackoverflow.com/questions/425766/why-does-git-svn-dcommit-lose-the-history-of-merge-commits-for-local-branches)

（注意：git-svn 对此无能为力：svn 根本无法理解更强大的 git 合并。因此，在 svn 存储库中，无法以任何方式表示此合并信息。）

但这是*整个*问题。如果您在将“工作”分支合并到“主分支”后删除它，那么您的 git 存储库是 100% 干净的，并且看起来与您的 svn 存储库完全一样。

**我的工作流程：** 当然，我首先将远程 svn 存储库克隆到本地 git 存储库（这可能需要一些时间）：

```
$> git svn clone <svn-repository-url> <local-directory> 
```

然后所有工作都发生在“本地目录”中。每当我需要从服务器获取更新（如“svn update”）时，我都会：

```
$> git checkout master
$> git svn rebase 
```

我在一个单独的分支“工作”中完成所有开发工作，该分支的创建方式如下：

```
$> git checkout -b work 
```

当然，您可以为您的工作创建任意数量的分支，并根据需要在它们之间合并和变基（只需在完成后删除它们 --- 如下所述）。在我的正常工作中，我经常提交：

```
$> git commit -am '-- finished a little piece of work' 
```

下一步 (git rebase -i) 是可选的 --- 它只是在将其归档到 svn 之前清理历史：一旦我达到了我想与他人分享的稳定里程碑，我会重写这个“工作”的历史分支并清理提交消息（其他开发人员不需要看到我在路上犯的所有小步骤和错误 --- 只是结果）。为此，我做

```
$> git log 
```

并复制 svn 存储库中最后一次提交的 sha-1 哈希（如 git-svn-id 所示）。然后我打电话

```
$> git rebase -i 74e4068360e34b2ccf0c5869703af458cde0cdcb 
```

只需粘贴我们上次 svn 提交的 sha-1 哈希值，而不是我的。您可能需要阅读带有 'git help rebase' 的文档以了解详细信息。简而言之：这个命令首先会打开一个编辑器来展示你的提交 ---- 只需将所有你想用以前的提交压缩的提交更改为 'pick' 为 'squash'。当然，第一行应该保留为“选择”。通过这种方式，您可以将您的许多小提交压缩成一个或多个有意义的单元。保存并退出编辑器。您将得到另一个编辑器，要求您重写提交日志消息。

简而言之：在我完成“代码黑客”之后，我会按摩我的“工作”分支，直到它看起来我想如何将它呈现给其他程序员（或者当我浏览历史记录时我想在几周内看到工作） .

为了将更改推送到 svn 存储库，我这样做：

```
$> git checkout master
$> git svn rebase 
```

现在我们回到旧的“master”分支，更新了 svn 存储库中同时发生的所有更改（您的新更改隐藏在“工作”分支中）。

如果有可能与您的新“工作”更改发生冲突的更改，您必须在本地解决它们，然后才能推送您的新工作（请参阅下面的详细信息）。然后，我们可以将我们的更改推送到 svn：

```
$> git checkout master
$> git merge work        # (1) merge your 'work' into 'master'
$> git branch -d work    # (2) remove the work branch immediately after merging
$> git svn dcommit       # (3) push your changes to the svn repository 
```

注意 1：命令 'git branch -d work' 非常安全：它只允许您删除不再需要的分支（因为它们已经合并到您当前的分支中）。如果在将工作与“主”分支合并之前错误地执行了此命令，则会收到错误消息。

*注意 2：确保在合并和 dcommit之间*使用 'git branch -d work' 删除您的分支：如果您尝试在 dcommit 之后删除分支，则会收到错误消息：当您执行 'git svn dcommit' 时，git 会忘记您的分支已与“master”合并。您必须使用不进行安全检查的“git branch -D work”将其删除。

现在，我立即创建一个新的“工作”分支，以避免意外入侵“主”分支：

```
$> git checkout -b work
$> git branch            # show my branches:
  master
* work 
```

**将您的“工作”与 svn 上的更改集成：** 当“git svn rebase”显示其他人在我的“工作”分支上工作时更改了 svn 存储库时，我会这样做：

```
$> git checkout master
$> git svn rebase              # 'svn pull' changes
$> git checkout work           # go to my work
$> git checkout -b integration # make a copy of the branch
$> git merge master            # integrate my changes with theirs
$> ... check/fix/debug ...
$> ... rewrite history with rebase -i if needed

$> git checkout master         # try again to push my changes
$> git svn rebase              # hopefully no further changes to merge
$> git merge integration       # (1) merge your work with theirs
$> git branch -d work          # (2) remove branches that are merged
$> git branch -d integration   # (2) remove branches that are merged
$> git svn dcommit             # (3) push your changes to the svn repository 
```

**存在更强大的解决方案：** 呈现的工作流程非常简单：它仅在每一轮“更新/黑客/dcommit”中使用 git 的功能 --- 但使长期项目历史与 svn 存储库一样线性。如果您只是想在遗留 svn 项目中的小第一步中开始使用 git 合并，这是可以的。

当您对 git 合并更加熟悉时，请随意探索其他工作流程：如果您知道自己在做什么，*可以*将 git merges 与 svn merges 混合使用（[使用 git-svn（或类似的）只是为了帮助 svn merge？](https://stackoverflow.com/questions/2945842/using-git-svn-or-similar-just-to-help-out-with-svn-merge)）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-12-16T11:49:33.077

Greg Hewgill 上面的回答是不安全的！如果在两个“git svn rebase”之间的主干上出现任何新的提交，合并将不会快进。

可以通过在 git-merge 中使用“--ff-only”标志来确保，但我通常不在分支中运行“git svn rebase”，只在其上运行“git rebase master”（假设它只是一个本地分支）。然后保证“git merge thebranch”快进。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-10-06T16:30:11.923

在 git 中合并 svn 分支的一种安全方法是使用 git merge --squash。这将创建一个提交并停止供您添加消息。

假设您有一个主题 svn 分支，称为 svn-branch。

```
git svn fetch
git checkout remotes/trunk -b big-merge
git merge --squash svn-branch 
```

此时，您已将 svn-branch 中的所有更改压缩为一个在索引中等待的提交

```
git commit 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-03-11T09:12:22.173

将本地 git 分支重新定位到主 git 分支，然后 dcommit ，这样看起来你按顺序完成了所有这些提交，因此 svn 人们可以按照他们习惯的方式线性地看到它。因此，假设您有一个名为 topic 的本地分支，您可以这样做

```
git rebase master topic 
```

然后它将在主分支上播放您的提交，准备好让您 dcommit

# wcf - 使用支持标准的绑定指定必须在 WCF 中签名和/或加密的标头部分

> ID：190440
> 
> 赞同：0
> 
> 时间：2008-10-10T07:41:55.240
> 
> 标签：wcf, wsdl, ws-security, ws-addressing

使用 Ws2007HttpBinding 并保护服务，生成的 WSDL 文件在策略部分显示所有 ws-addressing 标头和正文都将被签名，并且正文将被加密。

```
<sp:SignedParts>
  <sp:Body /> 
  <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing" /> 
  <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing" /> 
  <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing" /> 
  <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing" /> 
  <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing" /> 
  <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing" /> 
  <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing" /> 
</sp:SignedParts>
<sp:EncryptedParts>
  <sp:Body /> 
</sp:EncryptedParts> 
```

我们想指定必须对哪些标头进行签名和/或加密，就像在 Apache 壁垒中一样。对于自定义的 header 或 body 元素，可以在代码中使用注解，但是对于这些由绑定本身添加的元素，是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T13:56:11.303

没关系，几天后我在这里找到了答案：http: [//blogs.msdn.com/drnick/archive/2007/01/19/securing-custom-headers-version-2.aspx](http://blogs.msdn.com/drnick/archive/2007/01/19/securing-custom-headers-version-2.aspx)

# screen-scraping - Perl：从经过身份验证的网站中抓取 HTML

> ID：190445
> 
> 赞同：4
> 
> 时间：2008-10-10T07:46:52.017
> 
> 标签：screen-scraping

虽然从我所看到的情况来看，HTML 抓取有很好的文档记录，并且我理解它的概念和实现，但从隐藏在身份验证表单后面的内容中抓取的最佳方法是什么。我指的是从我合法有权访问的内容中抓取，因此我正在寻找一种自动提交登录数据的方法。

我能想到的只是设置一个代理，从手动登录中捕获吞吐量，然后设置一个脚本来欺骗该吞吐量，作为 HTML 抓取执行的一部分。就语言而言，它可能会在 Perl 中完成。

有没有人有这方面的经验，或者只是一般的想法？

**编辑** 这已经[回答过，](https://stackoverflow.com/questions/61217/getting-html-from-a-page-behind-a-login)但使用.NET。虽然它验证了我认为应该如何完成，但是否有人有 Perl 脚本来执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T08:06:36.283

查看 Perl [WWW::Mechanize](http://search.cpan.org/~petdance/WWW-Mechanize-1.34/lib/WWW/Mechanize.pm)库 - 它建立在 LWP 之上，提供工具来执行您所指的那种交互，并且它可以在您使用 cookie 时维护状态！

> WWW::Mechanize，或简称 Mech，可帮助您自动化与网站的交互。它支持执行一系列页面获取，包括以下链接和提交表单。解析每个获取的页面并提取其链接和表单。可以选择链接或表单，可以填写表单字段并获取下一页。Mech 还存储您访问过的 URL 的历史记录，可以查询和重新访问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T07:57:04.350

perl 中的[LWP 模块](http://search.cpan.org/~gaas/libwww-perl-5.800/lib/LWP.pm)应该为您提供所需的内容。

这里有一篇[很好的文章，](http://www.perl.com/pub/a/2002/08/20/perlandlwp.html?page=2)它讨论了启用 cookie 和其他身份验证方法以使您获得授权登录并允许您的屏幕抓取让您进入登录墙。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T07:58:03.303

有两种经常使用的身份验证类型。基于 HTTP 的身份验证和基于表单的身份验证。

对于使用基于 HTTP 的身份验证的站点，您基本上将用户名和密码作为您向服务器发出的每个 HTTP 请求的一部分发送。

对于进行基于表单的身份验证的站点，您通常需要访问登录页面，接受并存储 cookie，然后将 cookie 信息与您发出的任何 HTTP 请求一起提交。

当然，也有像 stackoverflow 这样的网站使用 openid 或 saml 等外部身份验证进行身份验证。这些对于报废处理更复杂。通常你想找一个库来处理它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T07:53:16.543

是的，如果不是 asp.net，您可以将其他库用于您自己的语言。

例如，在 Java 中，您可以使用[httpclient](http://hc.apache.org/httpclient-3.x/)或[httpunit](http://httpunit.sourceforge.net/index.html)（甚至可以处理一些基本的 Javascript）。

# perl - 如何在 Perl 哈希表中存储多个值？

> ID：190450
> 
> 赞同：24
> 
> 时间：2008-10-10T07:47:53.433
> 
> 标签：perl, hash, multiple-value, perl-data-structures

直到最近，我一直在使用相同的键将多个值存储到不同的哈希中，如下所示：

```
%boss = (
    "Allan"  => "George",
    "Bob"    => "George",
    "George" => "lisa" );

%status = (
    "Allan"  => "Contractor",
    "Bob"    => "Part-time",
    "George" => "Full-time" ); 
```

然后我可以参考`$boss("Bob")`，`$status("Bob")`但如果每个键都有很多属性，这会变得笨拙，我不得不担心保持哈希同步。

有没有更好的方法在哈希中存储多个值？我可以将值存储为

```
 "Bob" => "George:Part-time" 
```

然后用split拆解字符串，但一定有更优雅的方式。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-10T08:00:41.083

这是标准方式，根据[perldoc perldsc](http://perldoc.perl.org/perldsc.html "Perl 数据结构手册")。

```
~> more test.pl
%chums = ( "Allan" => {"Boss" => "George", "Status" => "Contractor"},
           "Bob" => {"Boss" => "Peter", "Status" => "Part-time"} );

print $chums{"Allan"}{"Boss"}."\n";
print $chums{"Bob"}{"Boss"}."\n";
print $chums{"Bob"}{"Status"}."\n";
$chums{"Bob"}{"Wife"} = "Pam";
print $chums{"Bob"}{"Wife"}."\n";

~> perl test.pl
George
Peter
Part-time
Pam 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-10T08:16:33.610

散列的散列是您明确要求的。Perl 文档中有一个教程风格的文档部分，其中包括：[Data Structure Cookbook](http://perldoc.perl.org/perldsc.html)但也许您应该考虑使用面向对象。这是面向对象编程教程的典型示例。

像这样的东西怎么样：

```
#!/usr/bin/perl
package Employee;
use Moose;
has 'name' => ( is => 'rw', isa => 'Str' );

# should really use a Status class
has 'status' => ( is => 'rw', isa => 'Str' );

has 'superior' => (
  is      => 'rw',
  isa     => 'Employee',
  default => undef,
);

###############
package main;
use strict;
use warnings;

my %employees; # maybe use a class for this, too

$employees{George} = Employee->new(
  name   => 'George',
  status => 'Boss',
);

$employees{Allan} = Employee->new(
  name     => 'Allan',
  status   => 'Contractor',
  superior => $employees{George},
);

print $employees{Allan}->superior->name, "\n"; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T08:03:13.730

散列可以包含其他散列或数组。如果您想按名称引用您的属性，请将它们存储为每个键的哈希值，否则将它们存储为每个键的数组。

有一个[语法参考](http://perldoc.perl.org/perlref.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T08:05:32.960

```
my %employees = (
    "Allan" => { "Boss" => "George", "Status" => "Contractor" },
);

print $employees{"Allan"}{"Boss"}, "\n"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-22T21:34:55.757

%chums = ( "Allan" => {"Boss" => "George", "Status" => "Contractor"}, "Bob" => {"Boss" => "Peter", "Status" => "兼职”} ）;

效果很好，但有没有更快的方法来输入数据？

我在想类似的东西

%chums = (qw, x)( Allan Boss George Status Contractor Bob Boss Peter Status Part-time)

其中 x = 主键之后的辅助键的数量，在这种情况下 x = 2，“老板”和“状态”

# svn - 从多个文件恢复 SVN 备份

> ID：190454
> 
> 赞同：2
> 
> 时间：2008-10-10T07:49:23.383
> 
> 标签：svn

我有一个非常大（~6GB）的 SVN 存储库，为此我编写了一个批处理文件脚本来每天进行增量备份。该脚本检查上次备份的运行时间，并仅转储此后的修订。

这些文件被命名为：`backup-{lower_revision}-{higher_revision}.svn`例如：`backup-156-162.svn`, `backup-163-170.svn`.

这意味着我有很多小转储文件，我想这很好（比很多 6GB 转储文件好），但我有点担心从这些备份中恢复需要做多少工作应该我需要。

为了减少文件的总数，我已经开始在每个月的第一天进行一次完全转储，但是，如果我需要在 30 日恢复，那将是 30 个转储文件，这可能需要一段时间。

我一直在考虑的是：

*   手动：
    `svnadmin load c:\myRepo < backup-1-10.svn`
    *等等*
    `svnadmin load c:\myRepo < backup-11-24.svn`
    *等等*
    ……
*   批处理文件使上述过程不那么繁琐
*   将每个文件附加在一起并进行一次加载（如果可能的话？）

如果我需要恢复，使用这些文件的最佳方法是什么？

*ps：操作系统是windows*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T13:18:05.410

您应该仅通过对日期 [01, 02,..31] 进行编号来重命名文件，这样您的文件就可以轻松排序 对于转储，知道里面有哪些修订并不重要。

我采用了不同的方法，因为像这样加载一个巨大的 Repo 需要一些时间，所以你应该考虑以下几点：
你可以使用**svnadmin hotcopy**每周/每月对存储库进行热复制。每天您都应该进行增量转储以获取最新版本以检索最新版本，您只需调用
**svnlook youngest [live_repo]** -> 为您提供实时存储库的最新版本

**svnlook youngest [copied_repo]** -> 为您提供每周 hotcopy 备份的最新版本

现在您可以使用两个修订号从您的实时存储库中运行转储。
好处：

*   更快地让您的备份存储库重新启动并运行（转储需要数小时！）
*   更少的转储文件
*   更少的脚本编写工作
*   可通过 post-commit-hook 扩展到“per-commit”-备份，因此您会担心失去任何修订

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T07:54:33.780

无论您提出何种解决方案，我都绝对建议您进行试用恢复。这样，您可以验证该过程是否符合您的真正要求，并且当您需要在愤怒中使用它时，您将能够成功完成它。

我会按照您现在的方式尝试您的流程，如果流程可以容忍，那么更简单更好，不要搞砸它。如果看起来工作量很大，那么一定要寻找优化机会。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T19:40:58.297

我建议每天运行一个转储命令，只保留最后 5 次转储。这对你来说是 30 场演出。

这是一个运行我使用的自动转储的脚本，但我确实手动删除了备份：

```
::此脚本备份 subversion 存储库。

::重置临时备份存储

rmdir /S /QC:\SVNBACKUP
mkdir C:\SVNBACKUP

::启动SVN备份。使用 svadmin 热拷贝
svnadmin 转储 /svn/myProj1 > /home/username/myProj1Bak

for /f "tokens=2-4 delims=/ " %%g in ('date /t') do (
  设置 mm=%%g
  设置 dd=%%h
  设置 yy=%%i
)

如果存在 "\\networkdrive\Clients\SVN\%mm%-%dd%-%yy%" (
  rd /S /Q "\\networkdrive\Clients\SVN\%mm%-%dd%-%yy%"
)

xcopy "/home/username/myProj1Bak" "\\networkdrive\Clients\SVN\%mm%-%dd%-%yy%" /s /i

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-23T07:06:05.303

彼得的命令实际上是：

```
svn look youngest [live_repo]
svn look youngest [copied_repo] 
```

# security - 一个简单、中等安全的登录协议？

> ID：190461
> 
> 赞同：2
> 
> 时间：2008-10-10T07:56:34.413
> 
> 标签：security, login, protocols

我[在这里](https://stackoverflow.com/questions/188043/security-crytography-stupid-challege-response-protocol)询问了我被要求实施的协议，以及它的安全性。因为从一开始就很明显它是狗屎。既然如此，我问：

你们能指点我一些非常简单的登录协议（我在密码系统中是空的）吗？我正在开发应用程序的服务器端和客户端，并且我有自己的消息传递系统，所以我有足够的自由度。

您的建议只有 2 个特殊特征。

1.  简单：这个应用程序要运行的网络并不是特别不安全，我只想避免以纯文本形式发送密码

2.  如果可能的话，不要交换太长的信息。越短越好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T08:14:21.883

查看[质询响应身份验证](http://en.wikipedia.org/wiki/Challenge-response_authentication)

*   服务器在登录表单中包含一个随机挑战字符串
*   当您登录时，javascript 对密码进行哈希处理，然后将其与质询进行哈希处理
*   然后服务器执行相同的检查（您的数据库应该存储散列密码，但是这种方法会阻止您有效地使用盐作为该散列，因为您必须广播它）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T08:14:32.070

[三通协议](http://en.wikipedia.org/wiki/Three-pass_protocol)会很方便。基本上，它归结为：

*   A 人加密他的密码，并将其发送给 B 人。
*   B 人对加密的密码进行加密，并将其发送回 A 人。
*   人 A 将其解密，然后将其发回。
*   人 B 解密它，并以明文形式获取密码。

这样，密码永远不会以明文形式发送，加密密钥也不会发送。它也是一个相对快速的协议，因为它（可能）依赖于非常快的对称加密。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-12T12:42:28.787

如果数据库内容落入未经授权的手中，将密码哈希存储在数据库中并不是最佳安全性。没有办法直接反转散列，但是有在线*字典*（如[这里](http://www.gdata.com)）用于反转散列（密码）单词。

在数据库中，您应该存储以下内容：

```
md5(login_name +  domain_or_appname_salt + password); 
```

中间的盐可以防止多种形式的字典攻击。

在客户端（在浏览器中），您将拥有一个带有用户名和密码的登录表单。一小段 javascript 将散列用户名 + app_salt_ 和密码，因此只有 login_name 和生成的散列被发送到服务器。

现在，明文密码永远不会以明文形式发送到服务器。所以你不应该在这里依赖 HTTPS。

在密码更新表单中可以使用相同的技术。因此服务器永远不知道明文密码。

我希望你能从这个和其他答案中得到一些启发。

快乐黑客！

惠伯特

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T08:10:50.500

如果你的协议在 TCP 上运行，你可以只用明文编写身份验证，然后用 SSL 包装通信。例如，如果您将端口 1234 用于您的协议，则可以关闭服务器上的该端口，并让客户端使用 SSH 对其进行隧道传输。这可以通过编程方式完成，这是一种非常常见的解决方案。

如果您的协议通过 HTTP 运行，您可以使用 HTTPS 以标准方式执行此操作。例如，基于 HTTPS 的基本身份验证对于您指定的需求来说是足够安全的。

另一方面，如果您不想在线发送密码，则需要进行质询响应身份验证。

1.  服务器发送随机字符串
2.  客户端发送随机字符串 + 密码的哈希
3.  服务器验证哈希。

这样做的缺点是密码将在服务器上可用（以纯文本形式加密）。如果您不想在服务器上存储密码，那么您需要回到我的第一个示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T09:00:39.793

[SASL](http://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer)是一种安全的身份验证机制。1.5+ 版本的 Java 标准库中提供了对 SASL 的支持。

# operating-system - 有多少操作系统可以用 Python 编写？

> ID：190464
> 
> 赞同：15
> 
> 时间：2008-10-10T07:58:24.457
> 
> 标签：operating-system

这是一个相当理论的问题，但是..

**有多少操作系统可以用 Python、Ruby、Perl 或 Lisp、Haskell 等语言编写？**

似乎很多像 init.d 这样的东西都可以用脚本语言轻松完成。防火墙设备操作系统之一（[m0n0wall](http://m0n0.ch/wall/)）使用 PHP 进行系统配置（包括启动时）。有人可能会争辩说“emacs 是一种操作系统，主要是用 Lisp 编写的”..

当然，有些位必须是汇编/C，但是有多少可以是常规的 .py/rb/.pl/.el/.hk 文件..？它可能没有最好的性能，但它会是迄今为止最容易修改的操作系统……

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-10T08:06:01.620

从技术上讲，如果您编写编译器来执行此操作，则任何一个都可能是。操作系统已经在 J​​ava (JNode)、.NET (MOSA、Singularity、SharpOS、Cosmos)、Haskell (HOUSE)、Python (Unununium) 等中完成。

编辑：我看到很多人都在谈论最底层是一个无法做到的领域；这不是真的。

没有理由不能扩展 X 语言的编译器来处理任何低级操作并将其暴露给该语言。所有功能都可以通过任何语言实现，只需为工作选择正确的工具即可。有时这是 Python，有时是 C，有时是汇编。

查看 Cosmos 和 SharpOS 等项目，了解纯粹的高级操作系统 Done Right (TM)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-11-05T04:37:47.450

我很惊讶没有人提到 Java 硬件。它应该是我们通过创建更高级别的处理器来进一步发展硬件的灵感。

我刚刚发现了另一个名为“ [Pycorn](https://launchpad.net/pycorn) ”的项目。

如果有一个 Python 字节码处理器，那么用 100% Python 制作一个快速的操作系统是可行的。处理器可以实现整个 CPython 字节码，或者任何与 Python 语言兼容的东西（但不是 C 模块！）。处理器必须处理引用计数、类和对象。dicts 的本机散列非常有用，Python 目前在软件中需要的所有复杂数据结构操作都应该完全在硬件中完成。不会有指针的概念，我认为这是构建这样一个处理器的主要动机，因为不可能破坏堆栈。

一切都将是对象！内核本身会调用内存对象上的方法，尽管您不需要太多接触它，因为无论如何硬件都会处理分配和垃圾收集。中断处理程序可以简单地设置为 python 方法。**MSR、高速缓存、调试寄存器和 I/O 端口都是对象。**

[这里](http://markmail.org/message/wyjgtnetf2hileg5)有一个关于在 FPGA 上实现 Python 的有趣讨论。

另一方面，（与非 Python 处理器上的 Python O/S 相关）对于声称您无法制作 Pythonic 内联汇编的人来说，仅从抽象中发出汇编非常简单，例如：

```
asm = MetaASM()
asm.r1 = 1234
asm.r2 = r1 + 5
asm.io.out(r1) 
```

您可以在必要时切换到特定于架构的程序集以满足性能需求或特定于架构的操作/寄存器：

```
asm = ASM("IA-32")
asm.xor(asm.eax, asm.eax)
asm.cr0 = asm.eax
asm.invtlb
asm.fs.0x00123456 = asm.eax
asm.al = 123
asm.dword.ptr.eax = 1234 # mov dword ptr [eax], 1234
asm.push(asm.eax) 
```

[CorePy](http://www.corepy.org/)对这个话题产生了兴趣。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T08:05:06.940

Python 本身并不提供直接与硬件对话的结构，例如内存映射 I/O 的原始指针和 C/ASM 提供的许多其他结构。然而，有证据表明操作系统中的大多数东西都可以用更抽象的语言编写。微软的[Singularity OS](http://research.microsoft.com/os/Singularity/)几乎完全是用 C# 的变体编写的。有极少量的 C/ASM 来执行中断处理程序等，但其他一切，包括我们大多数人认为的“内核”，基本上都可以用任何图灵完备的语言来完成。

应该注意的是，Singularity 选择在 C/ASM 中实现这些低级结构不应被解释为对高级语言的语法或其他方面的基本限制。人们当然可以制作一种 Python 变体，它可以发出并适当地处理必要的汇编代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T08:04:30.733

[House-Haskell 用户的操作系统和环境](http://programatica.cs.pdx.edu/House/)。它甚至可以在 VM 中启动，您可以使用它。

来源非常易读，IMO。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-10T08:06:06.877

除了内核（我的意思是内核、微内核风格）以及为每种动态语言编译运行时的东西之外，**如果**你正在构建自己的操作系统，几乎任何东西都可以是。只是不实用。`sh`哎呀，据我所知，init.d 主要是写在里面的。但是`sh`，虽然功能不强，但它非常轻巧，据我所知，它的功能非常高效。像 Python、Perl 等高级语言可以很好地处理它，但它会慢很多，并且会为解释器实例占用更多内存。

有可能，只是不实用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-10T08:11:07.460

Singularity 的一个有趣结果是，您不再需要 CPU 中的 MMU（内存管理单元），因为所有用户态代码都是“托管”的。我可以看到这在嵌入式场景中是有益的，使用非 MMU Linux 并在脚本应用程序之上。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-10T08:17:29.880

请参阅[Genera/OpenGenera](http://en.wikipedia.org/wiki/Genera_OS)以获取用 Lisp 编写的操作系统的示例，该示例实际上已在[LispMachines](http://en.wikipedia.org/wiki/Lisp_machine)上使用了一段时间。
Haskell 有[House](http://programatica.cs.pdx.edu/House/)。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-12T05:21:01.813

只要编程语言具有操作二进制文件的能力，您就可以用特定语言编写完整的操作系统。这并不是说它容易或实用。这是有道理的，如果您选择的语言可以操作二进制，那么您可以根据需要进行低级操作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-10T08:06:44.770

很难想象用（例如 Python）编写的内核/设备驱动程序等 - 内存管理会有点令人头疼。

另一方面，几乎所有的用户空间代码都可以。在 Linux 下，“init”不需要是本机机器代码二进制文件——它可以是 python 脚本或其他东西，没问题。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-21T21:03:00.793

> [“cleese”](http://code.google.com/p/cleese/) ——几乎完全用 Python 编写的操作系统

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-12T05:38:11.593

我会说这是不可能的。对这个问题的回答不断提到对语言的更改或使用该语言来生成低级（内核）代码。这只是使用一种语言编写另一种语言。虽然我同意这两者都允许您编写操作系统，但我认为它现在不是同一种语言。因此，操作系统可以用多种不同的语言编写，但并非每种语言（无需更改或绕过语言）都可用于编写操作系统。

原始问题的最终答案几乎是全部，但不是全部。唯一接受的是可以访问 CPU 级指令的语言。

# dll - 使用 JNI 从 Java 打开 CDialog

> ID：190468
> 
> 赞同：1
> 
> 时间：2008-10-10T08:01:11.753
> 
> 标签：dll, debugging, java-native-interface, cdialog

我有一个应用程序需要打开一个在 DLL 中编写的 CDialog。问题是当在 DLL 中调用 DoModal() 时，程序崩溃并显示：“Debug Assertion Failed!”。有谁知道我怎样才能打开 CDialog？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T08:43:59.280

在这一点上，您可能需要在 C++ 级别进行一些调试——这里没有足够的信息来说明可能出了什么问题。您需要查看的内容是调试断言失败的原因、当时的堆栈跟踪、它尝试执行的操作以及导致崩溃的原因。一个调试断言本身并不是崩溃，虽然它是一个很好的线索，而且断言失败的原因也可能是导致崩溃的原因。

# c# - 有没有办法在 LinqToSql 分组中按查询编写分组而不是标量值？

> ID：190476
> 
> 赞同：1
> 
> 时间：2008-10-10T08:04:54.053
> 
> 标签：c#, linq, linq-to-sql

我的存储库中有这些地图。

```
public IQueryable<AwType> GetAwTypes()
{
    return from awt in _db.AwTypes
           select new AwType
           {
               Id = awt.Id,
               Header = awt.Header,
               Description = awt.Description
           };
}

public IQueryable<Aw> GetAws()
{
    return from aw in _db.Aws
           select new Aw
           {
               Id = aw.Id,
               Bw = (from bw in GetBws()
                          where bw.Id == aw.Bw
                             select bw
                         ).SingleOrDefault(),
               AwType = (from awt in GetAwTypes()
                            where awt.Id == awAwType
                            select awt
                        ).SingleOrDefault(),
               AwAttribute = aw.AwAttribute
           };
} 
```

在服务中，我想将按 AwType 分组的 Bws 计数为`List<KeyValuePair<AwType, int>>`. 当我调用该 linq 查询时：

```
var awGroups = from aw in _repository.GetAws()
group aw by aw.AwType into newGroup
select newGroup;

List<KeyValuePair<AwType, int>> RetGroups = new List<KeyValuePair<AwType, int>>();
foreach (var group in awGroups)
{
    RetGroups.Add(new KeyValuePair<AwType, int>(group.Key, group.Count()));
}
return RetGroups; 
```

我收到一条错误消息，说我无法对必须按标量值（如 aw.AwType.Id）进行分组的对象进行分组。

有没有办法在一次通话中获得“AwType，int”对？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T17:59:01.720

AwType 是一个引用类型。对那个引用类型进行分组是个坏主意……该查询中的每个 AwType 都是唯一的引用，因此 n 个元素会产生 n 个组。

试试这个：

```
var awGroups = from aw in _repository.GetAws()
group aw by aw.AwType.ID into newGroup  //changed to group on ID
select newGroup;

List<KeyValuePair<AwType, int>> RetGroups = new List<KeyValuePair<AwType, int>>();
foreach (var group in awGroups)
{
    //changed to get the first element of the group and examine its AwType
    RetGroups.Add(new KeyValuePair<AwType, int>(group.First().AwType, group.Count()));
}
return RetGroups; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T08:09:54.387

您可以按匿名类型分组，例如 new { Foo, Bar }

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T18:26:11.073

根据我对 linq 的了解，您相当于尝试按表的每一列进行分组。这只能通过在 group 语句中列出表中的每个字段来完成，因此在您的情况下，您需要执行以下操作（我对 Linq 不是很了解）

```
var awGroups = from aw in _repository.GetAws()
group aw by aw.AwType.Id, aw.AwType.Header, aw.AwType.Description into newGroup
select newGroup; 
```

或者，如果这是您需要的唯一列，也许您可​​以按 Id 分组。

```
var awGroups = from aw in _repository.GetAws()
group aw by aw.AwType.Id into newGroup
select newGroup; 
```

# apache - Apache + mod_lisp + clisp

> ID：190480
> 
> 赞同：13
> 
> 时间：2008-10-10T08:05:43.523
> 
> 标签：apache, lisp, clisp

如何配置 apache + mod_lisp + clisp 并设置“Hello World！”？我找不到有关该主题的任何完整方法。谢谢。

编辑：Vebjorn 的解决方案有效，但我不知道如何编写“hello world！”。谁能告诉我如何进行？有类似 SWANKing clisp 的东西，然后用 SLIME 连接到它，但是当我启动 mod_lisp 的演示时，没有提供测试页面并且我的 slime 没有返回？

再次感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T08:50:36.303

1.  下载[http://www.fractalconcept.com:8000/public/open-source/mod_lisp/mod_lisp.c](http://www.fractalconcept.com:8000/public/open-source/mod_lisp/mod_lisp.c)
    *   编译并安装 Apache 模块`sudo apxs -i -c mod_lisp.c`
    *   将以下内容添加到您的`httpd.conf`:

        ```
        LoadModule lisp_module libexec/httpd/mod_lisp.so
        AddModule mod_lisp.c
        LispServer 127.0.0.1 3000 "foo"
        <位置 /foo>
        SetHandler lisp 处理程序
        </位置>

        ```

2.  重启apache`sudo apachectl restart`
    *   下载 CLISP 中的 Lisp 端处理示例：[http ://www.fractalconcept.com/fcweb/download/modlisp-clisp.lisp](http://www.fractalconcept.com/fcweb/download/modlisp-clisp.lisp)
3.  启动 CLISP 并评估：

    ```
    （加载“modlisp-clisp”）
    (modlisp:modlisp 服务器)

    ```

4.  将浏览器指向[http://localhost/foo](http://localhost/foo)。你应该看到：

> mod_lisp 2.0
> 
> 这是 mod_lisp 2.0 + CLISP + apache + Linux 发送的常量 html 字符串

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T08:41:33.607

你用的是什么后端？如果没有，我建议尝试[Hunchentoot](http://www.weitz.de/hunchentoot/#mod_lisp)，或者更好的是[UCW](http://trac.common-lisp.net/ucw/wiki/IntroInstallation)。

这两个链接都将带您进入安装说明，并以 Hello World 类型的页面结尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T08:40:10.303

[本文](http://www.newartisans.com/blog_files/common.lisp.with.apache.php)似乎是使用 mod_lisp2 在 Apache 上设置 Common Lisp 的相当详尽的“操作方法”指南。

> 如果一切都按计划进行，您现在应该有一个在 Apache 后面运行的 Common Lisp 应用服务器

# iphone - 将自定义控件添加到 MoviePlayer

> ID：190493
> 
> 赞同：14
> 
> 时间：2008-10-10T08:14:09.980
> 
> 标签：iphone, objective-c, cocoa-touch

我试图弄清楚如何向 iPhone MoviePlayer 添加自定义控件。有关我正在尝试执行的操作的示例，请参见下图。

![替代文字](https://i.stack.imgur.com/Zt5MG.jpg)

我正在尝试在基本电影控件的右侧和左侧添加类似控件。

我已经在 Open SDK 中通过向 playerview 添加子类来完成此操作，但现在在官方 SDK 和 Apple 移动到 MPMoviePlayerController 我不知道该怎么做。

同样使用我的旧 1.x 固件方式，它需要我自己捕获触摸事件并隐藏/显示控件。我希望有一种方法可以使用标准控件执行此操作，但如果没有，那很好。

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-11T21:08:04.257

我找到了最好的方法来做到这一点！

您像平常一样创建电影播放器​​，然后执行以下操作：

```
id vvController = [theMovie videoViewController];
[[vvController _overlayView] addSubview:mainView]; 
```

'mainView' 是您的自定义叠加层。这样做可以使您的自定义叠加层与普通叠加层一起显示和隐藏，因为它们现在是同一个！

*请注意，这仍然使用标准框架，但在框架中没有记录。所以它应该是 100% 应用商店安全的，但在以后的框架中“可能”在没有苹果通知的情况下发生变化。*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-10-24T01:17:57.063

这里的人们可能还在其他各种博客文章中看到了以下“获取电影播放器​​窗口”的方法——在 index = 1 处。虽然这种方法（见下面的片段）也可能有点“脆弱”，但它很可能是有点“更安全”，因为它不*使用*MPMoviePlayerController 中的任何未记录或非公共方法。

另请注意，您应该等到收到 MPMoviePlayerContentPreloadDidFinishNotification，这样电影播放器​​窗口 (idx=1) 才会确实存在 ;-)

请注意，我还在此处为 myOverlayView 分配了一个任意（整数值）视图“标签”——以便我可以在可能的情况下重新使用该视图，即检查它是否已添加到父播放器窗口中。

无论如何，这是相关的代码片段：

```
// use slight "hack" to get our (parent) movie-player window, should always (?) be the UIWindow at index = 1
//
UIWindow *moviePlayerWindow= [[[UIApplication sharedApplication] windows] objectAtIndex:1];

myOverlayView.center = CGPointMake(
                            moviePlayerWindow.bounds.size.width - (myOverlayView.bounds.size.height / 2) - myOverlayView.display_origin.y,
                            moviePlayerWindow.center.y
                                  ); // center our overlay-view

myOverlayView.hidden = NO; // and show it

if( [moviePlayerWindow viewWithTag: MY_OVERLAY_VIEW_TAG] == nil ) {
    // haven't added our overlay-view as a sub-view to the main MoviePlayer window yet... so do that now
    myOverlayView.tag = MY_OVERLAY_VIEW_TAG;
    [moviePlayerWindow addSubview: myOverlayView];
}
[moviePlayerWindow bringSubviewToFront: myOverlayView]; // in any case, bring it to the foreground 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-10T13:27:35.997

[Apple 提供的这个示例应用程序](http://developer.apple.com/iphone/library/samplecode/MoviePlayer_iPhone/index.html)应该会有所帮助。从描述：

> 演示如何使用媒体播放器框架全屏播放电影。该示例包含通过内置设置应用程序配置电影背景颜色、播放控件和缩放模式的代码。还展示了如何在播放期间在影片顶部绘制自定义叠加控件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T09:21:30.980

我推荐 VideoPlayerKit。支持流媒体、全屏、AirPlay。

[https://github.com/ign/VideoPlayerKit](https://github.com/ign/VideoPlayerKit)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-14T19:31:57.873

我还没有实现 ALMoviePlayerController 但它似乎为您的问题提供了一个简洁而充分的解决方案。

来自 git 仓库：

“MPMoviePlayerController 的插入式替代品，它公开了 UI 元素并允许最大程度的自定义”

[https://github.com/alobi/ALMoviePlayerController](https://github.com/alobi/ALMoviePlayerController)

# c# - 如何在 WordprocessingDocument 中获取页眉/页脚流

> ID：190499
> 
> 赞同：1
> 
> 时间：2008-10-10T08:17:05.183
> 
> 标签：c#, .net, xml, ms-office, openxml

我需要知道如何获取 WordprocessingDocument 的页眉和页脚流。我通过 WordprocessingDocument 的 MainDocumentPart 获得 MainDocument。你知道我是怎么得到标题的吗？我尝试使用 GetPartsOfType 方法，但它返回 null。

问候

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-10T09:21:37.037

获取页眉和页脚比获取文档部分要复杂一些。

正如这里所描述的（一个非常好的信息来源），文档中甚至在一个部分中可以有许多页眉和页脚。

因此，您要做的是打开该主文档部分，识别节 (w:sectPr) 元素内的 w:headerReference 元素。这个headerReference（当然是页脚）包含关于页眉类型的信息（第一页、奇数页、偶数页或一般页），以及一个参考ID（例如“rId6”）。根据参考 ID，您可以查找页眉/页脚引用 (GetRelationship())，然后您可以找到页眉/页脚部分。

注意：有趣的是页眉/页脚的关系类型是“ [http://schemas.openxmlformats.org/officeDocument/2006/relationships/header](http://schemas.openxmlformats.org/officeDocument/2006/relationships/header) ”而不是“ [http://schemas.openxmlformats.org/wordprocessingml/2006/header](http://schemas.openxmlformats.org/wordprocessingml/2006/header) ”这在规范中，但是由于您无论如何都应该通过引用 id 而不是引用类型来查找页眉/页脚，所以这实际上不是问题。

# xml - XML 文本格式

> ID：190503
> 
> 赞同：2
> 
> 时间：2008-10-10T08:20:45.537
> 
> 标签：xml, editor, text-formatting

有谁知道一个好的程序，我可以在其中粘贴 xml（从我的 java 类中的 System.out 获取它），它会格式化 xml，所以它不是很长的文本行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T08:40:53.687

我喜欢[XMLPad](http://www.wmhelp.com/)。它有一个很好的格式化程序和一堆可视化工具，例如树视图和网格视图。还有一个很好的交互式 XPath 查询工具，可能还有更多功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T09:27:54.060

Visual Studio 执行此操作（您可以免费下载 express 版本）。

如果没有，试试 Liquid XML——它是免费的，而且它还有一个非常方便的 xpath 可视化器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T08:21:52.413

你试过你最喜欢的浏览器了吗？您不能真正粘贴它，但您可以打开任何 XML 文件，IE 和 Firefox 都会显示一个漂亮的、可折叠的 XML 层次结构树视图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T08:32:18.947

如果您已经拥有它，请尝试使用 Visual Studio（否则可能下载太多 =））Visual Studio 非常好地格式化 xml，您可以对其进行编辑，并且您有一个可折叠的树视图。只需将其粘贴到 Visual Studio 中，然后按`Ctrl`++`K`即可`D`获得格式化的 xml 代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T10:46:59.937

如果您不想使用 XML 编辑器，请使用 Notepad++。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T08:24:32.643

如果您想更好地控制格式化文本的外观，可以尝试使用[XML 格式化程序](http://www.kitebird.com/software/xmlformat/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T09:10:17.840

您可以在 Eclipse 中使用 Source > Format 重新格式化 XML 文件

# delphi - 如何在 Delphi 中使用或解决可视化表单继承问题？

> ID：190504
> 
> 赞同：12
> 
> 时间：2008-10-10T08:20:55.940
> 
> 标签：delphi, inheritance

我一直在从事 Delphi 7 中的一个项目，我想让表单从其他表单继承组件。我能够得到这个工作，但遇到了以下问题（我将发布解决方案，希望将来能帮助其他人）：

1.  在表单的 .pas 文件中，我会将表单更改为从其他表单继承，但它不会从祖先表单中获取组件。
2.  对于某些后代表单，我在设计时打开表单时会收到以下错误消息：“创建表单时出错：找不到'TAncestorForm'的祖先。” 我必须先手动打开祖先表单，然后才能打开后代表单。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-10T08:21:26.003

首先，对于那些不知道如何直观地继承表单的人，您可以像往常一样创建祖先表单。然后转到文件>新建>其他。选择带有当前项目名称的选项卡，然后选择要继承的表单。如果要从不属于当前项目的表单继承，请打开该表单，右键单击它，然后选择 Add to Repository。然后您将能够转到文件 > 新建 > 其他并从相应的选项卡中选择该表单。

鉴于此，我遇到了一些问题，因为已经创建了一些后代表单，所以我无法遵循上述过程。此外，我对 Delphi 创建的标准代码中的表单进行了一些更改。我能够使用以下准则解决视觉表单继承的所有问题：

*   后代表单的 .pas 文件必须让表单的类继承自正确的祖先类，例如：
    `type TMyForm = class(TAncestorForm)`
*   后代形式的 .dfm 中的第一行必须包含单词`inherited`而不是`object`，例如：
    `inherited MyForm: TMyForm`
*   **编辑：仔细检查后，不需要以下内容：** *祖先形式的 .pas 文件必须具有 Delphi 创建的标准全局变量，例如：
    `var AncestorForm: TAncestorForm;`*
*   项目的 .dpr 文件的`uses`部分必须具有与单元文件名后的注释相同的全局变量，例如：
    `unAncestor in 'unAncestor.pas' {AncestorForm}`

注释/提示：

*   如果需要，允许非自动创建祖先表单和后代表单（在项目 > 选项 > 表单 > 自动创建表单中设置）。
*   要将后代表单上的属性恢复为祖先表单的值，请右键单击对象检查器中的属性，然后选择恢复为继承。
*   要将组件的所有属性值恢复为祖先的值，请右键单击该组件并选择恢复为继承。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-23T17:48:30.743

DPR 似乎比这更棘手。在我的例子中，我创建了一个从 TFrame 派生的祖先。然后我从 TAncestorFrame 派生了多个帧。我的 DPR 的 uses 子句看起来像：

```
uses
  Forms,
  ancestorFrame in 'ancestorFrame.pas' {AncestorFrame : TFrame},
  frame1Unit in 'frame1Unit.pas' {frame1:TFrame},
  frame2Unit in 'frame2Unit .pas' {frame2:TFrame}, 
```

DPROJ 文件应如下所示：

```
<DCCReference include="frame1Unit.pas">
  <Form>frame1</Form>
  <DesignClass>TFrame</DesignClass>
</DCCReference> 
```

派生帧应如下所示：

```
TFrame1 = class(TAncestorFrame) 
```

派生帧 .DFM 文件应该说：

```
inherited Frame1:TFrame1 
```

# c# - 从 Active Directory 获取所有直接报告

> ID：190516
> 
> 赞同：12
> 
> 时间：2008-10-10T08:28:37.657
> 
> 标签：c#, active-directory, ldap

我正在尝试以递归方式通过 Active Directory 获取用户的所有直接报告。因此，给定一个用户，我最终会得到一个列表，其中列出了所有将此人作为经理或将某人作为经理、将某人作为经理......最终将输入用户作为经理的所有用户的列表。

我目前的尝试相当缓慢：

```
private static Collection<string> GetDirectReportsInternal(string userDN, out long elapsedTime)
{
    Collection<string> result = new Collection<string>();
    Collection<string> reports = new Collection<string>();

    Stopwatch sw = new Stopwatch();
    sw.Start();

    long allSubElapsed = 0;
    string principalname = string.Empty;

    using (DirectoryEntry directoryEntry = new DirectoryEntry(string.Format("LDAP://{0}",userDN)))
    {
        using (DirectorySearcher ds = new DirectorySearcher(directoryEntry))
        {
            ds.SearchScope = SearchScope.Subtree;
            ds.PropertiesToLoad.Clear();
            ds.PropertiesToLoad.Add("directReports");
            ds.PropertiesToLoad.Add("userPrincipalName");
            ds.PageSize = 10;
            ds.ServerPageTimeLimit = TimeSpan.FromSeconds(2);
            SearchResult sr = ds.FindOne();
            if (sr != null)
            {
                principalname = (string)sr.Properties["userPrincipalName"][0];
                foreach (string s in sr.Properties["directReports"])
                {
                    reports.Add(s);
                }
            }
        }
    }

    if (!string.IsNullOrEmpty(principalname))
    {
        result.Add(principalname);
    }

    foreach (string s in reports)
    {
        long subElapsed = 0;
        Collection<string> subResult = GetDirectReportsInternal(s, out subElapsed);
        allSubElapsed += subElapsed;

        foreach (string s2 in subResult)
        {
        result.Add(s2);
        }
    }

    sw.Stop();
    elapsedTime = sw.ElapsedMilliseconds + allSubElapsed;
    return result;
} 
```

本质上，这个函数将一个可分辨的名称作为输入（CN=Michael Stum, OU=test, DC=sub, DC=domain, DC=com），因此对 ds.FindOne() 的调用很慢。

我发现搜索 userPrincipalName 要快得多。我的问题：sr.Properties["directReports"] 只是一个字符串列表，这就是 distinctName，搜索起来似乎很慢。

我想知道，有没有一种快速的方法可以在 distinctName 和 userPrincipalName 之间进行转换？或者，如果我只有 distinctName 可以使用，是否有更快的方法来搜索用户？

**编辑：**感谢答案！搜索经理字段将功能从 90 秒提高到 4 秒。这是新的和改进的代码，它更快，更易读（请注意，elapsedTime 功能中很可能存在错误，但该函数的实际核心工作）：

```
private static Collection<string> GetDirectReportsInternal(string ldapBase, string userDN, out long elapsedTime)
{
    Collection<string> result = new Collection<string>();

    Stopwatch sw = new Stopwatch();
    sw.Start();
    string principalname = string.Empty;

    using (DirectoryEntry directoryEntry = new DirectoryEntry(ldapBase))
    {
        using (DirectorySearcher ds = new DirectorySearcher(directoryEntry))
        {
            ds.SearchScope = SearchScope.Subtree;
            ds.PropertiesToLoad.Clear();
            ds.PropertiesToLoad.Add("userPrincipalName");
            ds.PropertiesToLoad.Add("distinguishedName");
            ds.PageSize = 10;
            ds.ServerPageTimeLimit = TimeSpan.FromSeconds(2);
            ds.Filter = string.Format("(&(objectCategory=user)(manager={0}))",userDN);

            using (SearchResultCollection src = ds.FindAll())
            {
                Collection<string> tmp = null;
                long subElapsed = 0;
                foreach (SearchResult sr in src)
                {
                    result.Add((string)sr.Properties["userPrincipalName"][0]);
                    tmp = GetDirectReportsInternal(ldapBase, (string)sr.Properties["distinguishedName"][0], out subElapsed);
                    foreach (string s in tmp)
                    {
                    result.Add(s);
                    }
                }
            }
          }
        }
    sw.Stop();
    elapsedTime = sw.ElapsedMilliseconds;
    return result;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-10T08:51:38.000

首先，当您已经拥有要查找的 DN 时，无需将 Scope 设置为“子树”。

另外，如何找到所有“manager”属性是您要查找的人的对象，然后对其进行迭代。这通常应该比其他方式更快。

```
(&(objectCategory=user)(manager=<user-dn-here>)) 
```

*编辑：以下内容很重要，但到目前为止仅在对此答案的评论中提到：*

如上所述构建过滤器字符串时，存在使用对 DN 有效但在过滤器中具有特殊含义的字符破坏它的风险。这些[必须被转义](https://msdn.microsoft.com/en-us/library/aa746475.aspx#Special_Characters)：

```
*   as  \2a
(   as  \28
)   as  \29
\   as  \5c
NUL as  \00
/   as  \2f

// Arbitrary binary data can be represented using the same scheme. 
```

编辑：将 设置`SearchRoot`为对象的 DN，并且也是`SearchScope`将`Base`单个对象拉出 AD 的快速方法。

# c# - 将 Linq-to-SQL 中的计算属性映射到实际的 SQL 语句

> ID：190524
> 
> 赞同：2
> 
> 时间：2008-10-10T08:32:46.933
> 
> 标签：c#, .net, linq, linq-to-sql

我在我的 Linq-to-SQL 类上创建了一些额外的功能，以便在我开发应用程序时更轻松。例如，我定义了一个从合同列表中检索活动合同的属性。但是，如果我尝试在 lambda 表达式或一般查询中使用此属性，它要么会引发异常，即没有与该属性匹配的 SQL 语句，要么会为每个项目生成一个查询（= 到服务器的大量往返）。

查询本身并不是过于复杂的 f.ex：

```
var activeContracts = customer.Contracts.Where(w => w.ContractEndDate == null); 
```

而我希望它读作：

```
var activeContracts = customer.ActiveContracts; 
```

我这样做的主要原因是因为它将最大限度地减少我的逻辑错误，如果我将来想要更改定义活动合约的内容，我不必重做大量代码。

有没有办法在属性上指定它应该生成什么 SQL。或者有没有办法确保它可以在下面的查询中使用？

```
var singleContractCustomers = db.Customers.Where(w => w.ActiveContracts.Count() == 1); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T09:42:29.490

当单独访问时，我怀疑有一个返回 IQueryable 的查询会起作用 - 但是，我希望当这是一个更大的表达式的一部分时，表达式解释器会抱怨（这看起来就像你所描述的那样）。

但是，我怀疑您可能可以将其分解一下。尝试添加（给客户）：

```
 public static Expression<Func<Customer, bool>> HasActiveContract
    {
        get { return cust => cust.Contracts.Count() == 1; }
    } 
```

然后你应该能够使用：

```
 var filtered = db.Customers.Where(Customer.HasActiveContract); 
```

显然，很难（从这里）运行它来查看它提出了什么 TSQL，但如果这样做往返，我会感到惊讶；我希望在 TSQL 中执行 COUNT() 。作为最顶层的查询，您还应该能够将其包装起来：

```
 public IQueryable<Customer> CustomersWithActiveContract
    {
        get { return Customers.Where(Customer.HasActiveContract); }
    } 
```

有任何工作吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T12:00:05.270

这就像一个魅力。**CustomersWithActiveContracts**生成的 SQL 语句对我来说看起来不错。

```
{SELECT [t0].[CustomerID], [t0].[cFirstName], [t0].[cLastName]
FROM [dbo].[Customers] AS [t0]
WHERE ((
    SELECT COUNT(*)
     FROM [dbo].[Contracts] AS [t1]
    WHERE (([t1].[ContractEndDate] > @p0) OR ([t1].[ContractEndDate] IS NULL)) AND ([t1].[cId] = [t0].[cId])
    )) > @p1
} 
```

这也应该意味着可以在此查询的基础上进行构建，而不会产生更多的数据库访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T15:07:48.923

另一种选择是使用[Microsoft.Linq.Translations](http://damieng.com/blog/2009/06/24/client-side-properties-and-any-remote-linq-provider)库。这将允许您定义您的属性，它的 Linq 翻译如下：

```
partial class Customer
{
    private static readonly CompiledExpression<Employee,IEnumerable<Contract>> activeContractsExpression
        = DefaultTranslationOf<Customer>
          .Property(c => c.ActiveContracts)
          .Is(c => c.Contracts.Where(x => x.ContractEndDate == null));

    public IEnumerable<Contract> ActiveContracts
    {
        get 
        { 
            // This is only called when you access your property outside a query
            return activeContractsExpression.Evaluate(this);
        }
    }
} 
```

然后你可以像这样查询它：

```
var singleContractCustomers = db.Customers.WithTranslations()
                              .Where(w => w.ActiveContracts.Count() == 1); 
```

注意对 的调用`WithTranslations()`。这会创建一个特殊的包装`IQueryable`，在将查询表达式传递给 Linq to SQL 之前，将所有对计算属性的引用替换为它的翻译。

此外，如果您包含`Microsoft.Linq.Translations.Auto`命名空间而不是`System.Linq`，那么您甚至不需要调用`WithTranslations()`!

# monitoring - 霍比特人监控 - 每次测试多个图表？

> ID：190525
> 
> 赞同：5
> 
> 时间：2008-10-10T08:33:06.760
> 
> 标签：monitoring, graph, hobbitmon

我不确定人们对霍比特人监控系统有多熟悉 - [http://hobbitmon.sourceforge.net/](http://hobbitmon.sourceforge.net/) - 但我有一个棘手的问题。

我有一个自定义测试，它返回两个 NCV 值。一个值通常返回约 300 毫秒，另一个返回 500 000 欧元。显然，这两个值不能很好地结合在一起。:)

问题是，霍比特人可以为这一测试显示两个图表吗？如果是这样，我该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T20:49:33.887

因为 hobbit 旨在为每页生成一个图形，所以您必须掌握一些 c 技能才能获得所需的内容……您可能必须更改变量解析器 lib/hobbitrrd.c 和 html 生成器 lib/ htmllog.c 。您可能还会考虑滚动您自己的解决方案来解析您的数据并将其放入[http://oss.oetiker.ch/rrdtool/](http://oss.oetiker.ch/rrdtool/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T20:57:42.403

最简单的方法是将它们添加到主机的“趋势”页面。这很容易，您只需在服务器上的 bb-hosts 中放置一个 TRENDS 部分。

第二种最简单的方法是将 HTML 放入以直接访问图形，这有点棘手。

# c - 如何在 Linux 中使用微状态记帐？

> ID：190528
> 
> 赞同：3
> 
> 时间：2008-10-10T08:35:07.677
> 
> 标签：c, linux, performance, operating-system

我想在 Linux 上以编程方式访问微状态记帐计时器。我想问题的第一部分是这些在哪里可用？哪些内核版本和发行版？哪些硬件平台？第二部分是如何实际访问计时器？什么是系统调用？

[这是一个描述微状态会计](http://www.gelato.unsw.edu.au/IA64wiki/MicroStateAccounting)的（有些旧的）页面，但我找不到那里描述的系统调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T14:30:19.407

补丁和用户空间程序可在[http://www.gelato.unsw.edu.au/patches/](http://www.gelato.unsw.edu.au/patches/)获得。由于补丁没有向上游迁移，[似乎是因为复杂性/开销太高](http://www.uwsg.iu.edu/hypermail/linux/kernel/0503.1/1190.html)，您必须推出自己的内核。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T19:30:02.570

在 google 上搜索 MSA_SELF 表明它是几年前最后一次讨论的，并且快速浏览上游表明它不在上游内核中。所以我认为说“这些数据不可用”是公平的。

您可能想查看 clock_getres() 等。

# c# - C#中的十六进制操作

> ID：190531
> 
> 赞同：0
> 
> 时间：2008-10-10T08:38:33.143
> 
> 标签：c#, hex

关于在 c# 中解析/转换/操作十六进制值的任何提示？

特别是我想将十进制整数转换为十六进制，然后输出为字符串......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T08:41:58.677

```
Int32 decValue = 42;
string hexValue = decValue.ToString("X");

Int32 decValue2 = Int32.Parse(hexValue, System.Globalization.NumberStyles.HexNumber); 
```

看到这个帖子：

[如何在 C# 中转换十六进制和十进制之间的数字？](https://stackoverflow.com/questions/74148/how-to-convert-numbers-between-hex-and-decimal-in-c)

# java - Java、Alfresco Web 服务 API 和 Unicode NamedValues

> ID：190542
> 
> 赞同：2
> 
> 时间：2008-10-10T08:42:30.860
> 
> 标签：java, web-services, unicode, alfresco

我正在使用 Java 访问 Alfresco 内容服务器，通过它的 Web 服务 API 将一些内容导入其中。内容应将一些 NamedValue 属性设置为 UTF-8（西里尔文）字符串。我不断收到 Sax 解析器异常：

```
org.xml.sax.SAXParseException: An invalid XML character (Unicode: 0x1b) was found in the element content of the document. 
```

代码看起来像这样：

```
NamedValue[] namedValueProperties = new NamedValue[2];

namedValueProperties[0] = Utils.createNamedValue(Constants.PROP_NAME, name );
namedValueProperties[1] = Utils.createNamedValue("{my.custom.model}myProperty", cyrillicString);

CMLCreate create = new CMLCreate("1", parentReference, null, null, null, documentType, namedValueProperties);
CML cml = new CML();
cml.setCreate(new CMLCreate[]{create});
UpdateResult[] results = null;

try {
   results = WebServiceFactory.getRepositoryService().update(cml);
} catch (...)
    Here comes the "org.xml.sax.SAXParseException"
} 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T09:18:36.700

问题是`alfresco-web-service-client.jar`我使用的库来自 2.9B 发行版（我正在访问 2.9B 社区内容服务器）和依赖库`bcprov-jdk15-136.jar`并且`xmlsec-1.4.0.jar`不够用（从 2.1 版本开始仍然是旧的）。我应该已经使用了`bcprov-jdk15-137.jar`，`xmlsec-1.4.1.jar`它们与 2.9B 分发版一起部署。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-12T23:37:54.797

解决它的最简单方法是我认为转义 cyrillicString，例如使用Jakarta Commons 的[escapeXml](http://commons.apache.org/lang/api-release/org/apache/commons/lang/StringEscapeUtils.html#escapeXml(java.lang.String))，或者如果还不够，则将整个字符串转换为 XML 实体。但从长远来看，Alfresco 应该是固定的，所以开票可能也是一个不错的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T04:13:53.727

如果没有看到您要保留的数据，很难判断这是否是 Alfresco 的错误。您使用的是哪个版本的 Alfresco？我在 Alfresco 的问题跟踪系统中发现了这个错误。具体来说，这是 2.1 社区，它似乎表明除了 UTF-8 之外的编码存在问题，因此它可能与您的问题有关，也可能与您的问题无关。

调试此问题可以做的一件事是使用 Alfresco 的嵌入式 Java（服务器端）API 编写一个小测试，尝试保留相同的数据，并查看是否仍然出现错误（如果您可能不会是 SAXParseException做）。如果您没有收到错误，您就知道 Alfresco 的 Web 服务 API 中可能存在错误（不幸的是，它的支持不如嵌入式 Java 或 REST API 好），您可能想添加评论我之前提到的错误报告，或者提交你自己的。如果嵌入式 API 仍然出现错误，那么问题仍然可能是您的代码或他们的代码。

希望这至少有点帮助！

# windows - 如何更改 Windows 控制台窗口的宽度？

> ID：190543
> 
> 赞同：28
> 
> 时间：2008-10-10T08:42:59.470
> 
> 标签：windows, windows-xp, console

是否可以通过编程或其他方式增加 Windows 控制台窗口的宽度？或者我是否需要创建一个外观和行为类似于控制台的包装程序？周围是否有任何程序可以做到这一点？我在开发中广泛使用 Cygwin，Windows 中的所有控制台窗口都受到宽度限制，这对我来说似乎有点荒谬。

如果这很重要，我正在运行 Windows XP。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-08T15:32:55.780

只需运行“mode cols,lines”即可更改当前控制台窗口的大小：

模式 120,60

将控制台窗口的大小调整为 120 列和 60 行

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-10T08:46:40.070

您可以通过右键单击托盘图标并进入选项对话框来手动增加它。

也有适用于 Windows 的第三方终端模拟器，例如[Console](http://sourceforge.net/projects/console/)：

[![控制台截图](https://i.stack.imgur.com/qHaXc.jpg)](https://i.stack.imgur.com/qHaXc.jpg)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-02-28T19:28:32.373

> ```
> system("mode 45, 20"); 
> ```

这是一个糟糕的解决方案，因为它禁用了垂直滚动。

这个更好：

```
system("mode CON: COLS=120"); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-21T18:35:43.907

有一个窗口的api函数来设置宽度。这是一个tutu。 [http://www.adrianxw.dk/SoftwareSite/Consoles/Consoles6.html](http://www.adrianxw.dk/SoftwareSite/Consoles/Consoles6.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-10T08:45:45.127

如果您右键单击命令窗口的标题栏并选择属性，您可以在布局选项卡中更改宽度

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-06-18T15:07:45.610

如果您正在编写 C#，这是一种对我有用的方法（来自[本页](http://www.dreamincode.net/forums/topic/104405-how-to-change-the-width-of-the-console/)底部）

```
static void setConsoleSize()
   {
       System.Console.SetWindowPosition(0,0);   // sets window position to upper left
       System.Console.SetBufferSize(200,300);   // make sure buffer is bigger than window
       System.Console.SetWindowSize(122,54);   //set window size to almost full screen 
       //width - maxSet(127,57) (width, height)

       //System.Console.ResetColor(); //resets fore and background colors to default

   }  // End  setConsoleSize() 
```

从帖子中引用：“我可以使用的最大控制台大小是 127 列和 57 行，因为这是我的屏幕分辨率所允许的全部。重置你的屏幕分辨率，这将会改变。

这只是您将不得不玩弄的那些事情之一，以便您可以随心所欲地显示它。"

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-01-13T10:20:00.993

这

```
mode 
```

和

```
system("mode... 
```

解决方案对我不起作用，我无法在没有访问错误的情况下设置布局。

修复是关闭 Cygwin，右键单击开始菜单中图标的属性并编辑布局 -> 窗口 -> 高度，然后选择允许管理员权限保存设置。（不以管理员身份运行）。

现在运行 Cygwin 时总是给我一个大窗口。

视窗 7 64 位。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-10T09:07:54.957

要获得特定大小的所有未来控制台窗口，您可以创建 cmd.exe 的快捷方式，然后在快捷方式属性的布局选项卡上设置大小。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-10T09:09:49.790

在布局选项卡的控制台属性中，您可以配置以下内容：

屏幕缓冲区大小宽度

窗口大小宽度

窗口大小宽度是每行可见的字符数。屏幕缓冲区大小是`size`行的。例如，如果将窗口大小宽度设置为 100，将屏幕缓冲区大小宽度设置为 200，则需要使用滚动条查看大小在 100 到 200 之间的行的全部内容。超过 200 个字符的行将出现在更多不止一条线。如果您有很长的行并且想要将它们复制到文本文件中，这将很有用。

同样的事情也适用于 Windows PowerShell

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-06-20T13:55:27.477

嘿，你们有没有想过从 Windows 命令提示符/控制台中启动和运行 Cygwin 的可能性？这就是我一直在做的事情。然后你可以对控制台的外观做任何你想做的事情，让它变得性感。

有时尝试从 cygwin 中获取 su 可能很困难，尤其是当您尝试使用提供的工具进行一些繁重的运算时。人们已经尝试过各种各样的事情，从 sudo SU for windows 到任何事情......当它可以像从你那里传递管理员凭据一样简单时，即使没有奇怪的 UAC 弹出窗口（如果你是管理员？） . 您可以通过一个简单的批处理脚本来执行此操作。下面是我的 Cygwin 外观的屏幕截图，它也是从 Cygwin 的便携式版本运行的！没有注册表项和任何垃圾！
批处理文件将凭据传递给 bash，然后 bash 更改目录（请注意，需要双引号将此变量传递给 Cygwin colsole 以使其工作）

```
@echo off
setlocal enabledelayedexpansion
REM Changing working folder back to current directory
%~d0
CD %~dp0
REM Folder changed
bash --login -i -c "cd {insert_directory_name_here} && exec ./execution-file-here"
cls
exit 1 
```

注意：上面示例中的 { } 等括号不包含在批处理脚本中。另请注意，Windows CMD 窗口正在将字符串传递给 cygwin 以解释为多个条件；cygwin 不会自己阅读引号，而是阅读它们之间的内容。&& 表示更改目录，当你到达那里时执行脚本 ./execution-file-here。

这是一个双重打击，您可以从 MS-Windows 窗口中启动 Cygwin 或类似 linux 的应用程序，甚至无需键入代码字母或打开控制台或任何东西。

我将此批处理文件保存在 /Cygwin/bin 目录中，并在桌面上创建一个 Windows 快捷方式链接。在快捷方式中，我可以对 cmd shell 窗口进行样式化。甚至达到透明度;-)

![在此处输入图像描述](https://i.stack.imgur.com/s2JcT.png)

![在此处输入图像描述](https://i.stack.imgur.com/tTbsN.jpg)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-10T08:46:51.833

单击控制台框架左上角的图标（看起来像“C:\”的图标），然后选择 Properties 。这使您可以自定义各种东西。“布局”选项卡具有窗口的宽度。

# algorithm - 最有效的字符计数算法？

> ID：190544
> 
> 赞同：6
> 
> 时间：2008-10-10T08:43:05.193
> 
> 标签：algorithm

假设您想计算某些文本中字符的出现次数。

我能想到的最快方法是使用数组`unsigned char charcounts[256]`，将其初始化为零，然后查看文本输入中的每个字符并执行`charcounts[c]++`. 然后使用两个 var 进行线性搜索`charcounts[]`，以跟踪最低（到目前为止）的 char 及其计数，当我们找到较低的 char/count 时将其替换为新的 char/count，直到我们到达最后。

所以“文本”将是 t=2，e=1，x=1。

有没有更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T09:04:13.500

**第一部分 - 计算字母频率** 需要指出的两个问题，假设这里的语言是 C 或 C++：

*   您的代码将无法处理出现> 255 次的字母（如果恰巧对 char 进行了签名，则为 127 次）。将“charcounts”设为整数数组可能根本不会对性能产生太大影响。
*   您的代码不适用于 unicode/国际字符

**第二部分——找到最不频繁的字母**

*   如果您正在处理短字符串（“text”、“fred”），那么扫描表中的所有 256 个条目是速率确定步骤。您最好在初始扫描循环中跟踪频率最低的字母。
*   但是，如果您确实想扫描所有 256 个条目，您可以在点击“一”值（或零，如果您的算法打算这样工作）后立即退出循环

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T09:10:03.783

算法的第一部分是计算字符数——这只是生成要排序的键。

如果您知道您只使用字母字符 [A-Za-z ]*，那么您可以通过减少使用的桶数来优化您的算法，但这只是一个小调整。

第二部分只是一个稳定的排序——有很多方法可以做到这一点——[关于排序的维基百科页面](http://en.wikipedia.org/wiki/Sorting_algorithm)给出了一个很好的总结。如果您只对出现最少的字符感兴趣，那么您描述的（“阶段 2”）方法可能是您能得到的最有效的方法。

我能想到的改善这一点的唯一其他方法是，如果您可以在字符范围内均匀地将字母分成固定数量的存储桶（例如 16 个），然后在每个存储桶上递归。任何没有字符的桶都可以扔掉，在扫描/分类阶段节省一些时间。同样，如果一个桶有一个字符，那么它就完成了。当您知道其中有多个不同的字符时，您还希望确保仅将一个桶拆分为 16 个以上。

以单词 test 为例（假设 4 个桶且只有小写字符：

1.  生成 4 个桶（AG、HM、NT、UZ）
2.  拆分单词测试：
    *   年龄，
    *   嗯：
    *   新台币：tst
    *   乌兹别克斯坦：
3.  递归到其他桶 - （AG 有一个字符 - 这必须是最少的，所以我们可以停止
4.  如果不是这样（至于“睾丸”这个词），我们可以看到 HM 和 UZ 是空的，所以我们只需要检查 NT（其中包含 tsts）。
    *   我们创建了 4 个桶（NO、PQ、RS 和 T）。
    *   拆分字母
    *   等等

这种方法的优点是我们不必扫描每个字母。如果字符范围大小相同，那么这两种方法最多为 O(n)，其中 n 是字符串的长度（这是不可避免的，因为我们总是要查看每个字符），尽管在我的例子可能会使算法像 O(n^2) 一样糟糕。然而，随着字符范围的增加，尤其是对于短字符串，使用子桶将大大提高性能。对于 unicode 字符串，您可以使用混合方法 - 例如在第一阶段分离所有非 ascii 字符，并使用更简单的方法处理 ascii 部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T08:48:15.543

您在这里描述了两个任务。第一个是计算每个 ASCII 字符在流中出现的次数，第二个是尝试找到频率最低的字符。

第一个算法似乎非常有效。在我的脑海中，我想不出更快的方法。

但是，我不太确定您的第二种算法。您没有明确说明为什么要查找频率最低的字符或输入数据是什么，但我可以想象很容易有多个字符的频率计数为零，那么您想如何区分它们？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T08:46:22.927

这听起来像是做你描述的最有效的方法之一。我不确定你想对第二部分做什么，听起来你想找到排序数据中出现次数最少的字符？

# c++ - func(int ¶m) 和 func(int *param) 有什么区别？

> ID：190553
> 
> 赞同：12
> 
> 时间：2008-10-10T08:46:36.810
> 
> 标签：c++, pointers, reference

在下面的代码中，两者`amp_swap()`似乎`star_swap()`都在做同样的事情。那么为什么有人会更喜欢使用其中一种呢？哪一个是首选符号，为什么？还是只是口味问题？

```
#include <iostream>

using namespace std;

void amp_swap(int &x, int &y)
{
    int temp = x;
    x = y;
    y = temp;
}

void star_swap(int *x, int *y)
{
    int temp = *x;
    *x = *y;
    *y = temp;
}

int main()
{
    int a = 10, b = 20;
    cout << "Using amp_swap(): " << endl;
    amp_swap(a, b);
    cout << "a = " << a << ", b = " << b << endl;
    cout << "Using star_swap(): " << endl;
    star_swap(&a, &b);
    cout << "a = " << a << ", b = " << b << endl;
    return 0;
} 
```

谢谢你的时间！

* * *

也可以看看

## [**C++中指针变量和引用变量的区别**](https://stackoverflow.com/questions/57483)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-10T08:50:17.880

一种是使用引用，一种是使用指针。

我会使用带有引用的那个，因为您不能传递 NULL 引用（而您可以传递 NULL 指针）。

所以如果你这样做：

```
star_swap(NULL, NULL); 
```

您的应用程序将崩溃。而如果你尝试：

```
amp_swap(NULL, NULL); // This won't compile 
```

除非您有充分的理由使用指针，否则请始终使用引用。

请参阅此链接：[http ://www.google.co.uk/search?q=references+vs+pointers](http://www.google.co.uk/search?q=references+vs+pointers)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T09:10:25.903

还可以提出一个论点，以使指针版本优于参考版本。事实上，从文档的角度来看，它是优越的，因为调用者知道输入参数将被修改。比较这两个调用：

```
swap(a, b);
swap(&a, &b); // This cries “will modify arguments” loud and clear. 
```

当然，就`swap`函数而言，这一点是没有实际意义的。每个人都知道它的论点将被修改。还有其他情况不太明显。`ref`正是出于这个原因，C# 才有了关键字。在 C# 中，上面的内容必须如下所示：

```
swap(ref a, ref b); 
```

当然，还有其他方法可以记录这种行为。使用指针是这样做的一种有效技术。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T08:50:40.297

引用不能为 NULL。因此，使用第一个版本会阻止调用者将 NULL 作为函数参数之一传递。

不能重新分配引用以指向其他内容。所以，你知道在 function中，`amp_swap()`that总是指同一个东西。在指针版本中，您可以（在更复杂的函数中）重新分配并指向其他内容，这可能会使逻辑不太清晰（是的，您可以声明参数以避免这种重新分配）。`x``y``x``y``int *const x`

参考版本的函数体看起来更干净，因为它没有那么多星星。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T08:56:51.267

这不是符号问题。

有 3 种方法可以将参数传递给函数：

1.  按价值
2.  引用
3.  通过指针

在`amp_swap`您通过引用传递实际参数。这仅在 C++ 中引入并有效。

在`star_swap`你使用指针传递参数。这是最初的 C-way。

基本上，如果您使用 C++，建议使用引用，因为它对变量更具可读性。如果您需要指针，请务必使用它们。

并且记住在使用`&`引用声明方法时使用符号，否则会产生错误。如果您没有在 中声明引用`amp_swap`，该函数将不会交换任何内容。因为这种方式您使用方法 1（仅传递参数值）并且在函数中将创建两个新的自动变量，它们仅存在于函数的范围内。这样就不会触及原始的外部变量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T09:03:20.787

如果你看[这里，](http://www.embedded.com/story/OEG20010311S0024)你可以找到指针与引用的描述，最有用的信息最初来自这个引用。

> C++ 不允许您声明“const 引用”，因为引用本质上是 > const。换句话说，一旦你绑定一个引用来引用一个对象，你就不能重新绑定它来引用另一个对象。声明引用后，没有重新绑定引用的符号。

以下绑定 ri 以引用 i。

`int &ri = i;`

然后是一个任务，例如：

`ri = j;`

不会将 ri 绑定到 j。它将j中的值赋给ri所引用的对象，即i。

希望这更清楚。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T08:50:05.993

`(int *param)`是较旧的 C 风格，使用直接内存指针。`(int &param)`是现代 C++ 风格，使用引用（原始指针的类型安全包装器）。如果您使用的是 C++，您可能应该使用参考。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T20:34:09.227

*   与指针一样，引用可以修改作为参数传递的数据
*   与指针一样，引用支持多态性
*   与指针不同，引用永远不会为 NULL（您仍然可以通过一些技巧来实现这一点，但是，这更像是破坏而不是编码......）
*   与指针不同，引用在 const 时启用类型提升（即，具有一个带有 std::string 参数的函数接受 char *）
*   与指针不同，引用不能被重新分配：没有办法在代码的某个点修改它，而指针可以在一个点指向 A，在另一个点指向 B，而在另一个点又指向 NULL。而且您不想将 ++ 错误地应用于您的指针...
*   与指针不同，引用使数据的操作与使用“int”或“bool”之类的原语一样容易，而无需一直使用 * 运算符

由于这些原因，在 C++ 中，引用使用通常是默认的，而指针是例外。

因此，为了保持一致性，在您建议的两个“交换”函数之间，我将使用 amp_swap 并从源代码中删除星号（只是为了确保没有人会使用它并在源代码中添加无用的指针代码）.. .

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T08:49:55.087

它们与计算机完全相同。但是，一个是引用 (&)，另一个是指针 (*)

[http://www.google.com/search?hl=en&q=pointers+vs+references&btnG=Google+Search&aq=1&oq=pointers+vs](http://www.google.com/search?hl=en&q=pointers+vs+references&btnG=Google+Search&aq=1&oq=pointers+vs)

我相信它们都有它们的用途——就像指针一样，您可以进行更多的低级内存操作，但引用的语法更容易。

:)

# java - Java：线程技术和概念

> ID：190559
> 
> 赞同：6
> 
> 时间：2008-10-10T08:48:41.253
> 
> 标签：java, multithreading, visualization

*使用线程时，我有时将它们想象为在空间上下文中将对象之间的 3 维或更多维互连编织在一起。这不是一般的用例场景，但对于我所做的事情来说，这是一种有用的思考方式。*

### 您是否使用任何 API 来帮助线程化？

### 您是否以不将线程概念化为进程的方式使用线程？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-10T09:39:54.940

**您是否使用任何 API 来帮助线程化？**

你是说 appart from `java.util.concurrent`? [FunctionalJava](http://www.functionaljava.org/)有一些有助于并发编程的结构，如从[此处](http://apocalisp.wordpress.com/2008/06/18/parallel-strategies-and-the-callable-monad/)开始的多部分教程中所述。

**您是否以不将线程概念化为进程的方式使用线程？**

是的，就线程根本没有概念化的程度而言。以异步任务运行器为例。它在封面下使用线程，但我看不到它们，我也不关心它们。它们完全由任务运行器管理。

在幕后，这一切都只是线程，但是当我们不再关心单个线程而只是将它们视为许多插槽时，您可以以某种方式将代码放入其中并让它运行一段时间，那么就是当我们开始达到更高层次的抽象。

Agents/Actors 是执行此操作的常用方法。一个 Actor 就像一个拥有大量状态的线程，然后您可以向它发送一些代码并说“当您有时间时对您的状态执行此操作”或类似的内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-01T11:30:11.593

## 首先

通常的免责声明：任何语言、使用任何抽象级别的并发编程都是**困难**和**复杂**的，并且有很多风险。考虑到：

*   并发编程使任何应用程序复杂化
*   单元测试关键部分很难，有时甚至是不可能的
*   重现源自并发代码的错误**非常困难**，并且很大程度上取决于架构、操作系统风格、版本等......

## Java 并发 API

Java 在使开发人员尽可能容易地进行并发编程方面已经走了很长一段路。在大多数情况下，您会看到它`java.util.concurrent`具有您需要的大部分抽象：

*   **`Runnable`****`Thread`**可以扩展的接口和对象。只需输入您的代码，您就有一个准备好运行的线程
*   一组不错的**`Executors`**：常量池、动态池、调度或其他。只需向它扔一个`Runnable`，它就会完成其余的工作。
*   **`Semaphore`s**和各种**锁**使您无需实现常见的锁定技术。
*   `wait()`适用于所有对象的内置`notify()`API。

## 用途

作为软件工程师，剩下的唯一事情就是确保您编写**正确**的代码。这意味着您应该意识到自己可能面临的危险情况：

*   **死锁**- 两个或多个线程正在等待无序资源的情况，呈现无限等待循环。
*   **活锁**- 两个或多个线程在共享资源上礼貌地尝试让位于另一个但最终不接受它（考虑走廊上的两个人走到彼此并不断地从一侧移动到另一侧）
*   **饥饿**- 单个线程占用大部分或全部单个共享资源，从而剥夺其他线程对其的访问。

# 要点（或，何时使用）

**仅当并发性将直接改善您的应用程序行为时才使用线程。**

如果您正在等待 IO/网络/硬件绑定资源，**请**在其上生成一个线程，以便您可以继续做其他事情。

如果您只是想优雅地拆分 CPU 密集型计算，请**不要**使用线程。你最终可能会恶化你的表现。

如果您确实使用线程，请确保您已彻底考虑过风险，并三重检查您没有错过任何异常情况。

## 有用的（在线）资源

最快的方法是学习[Sun 并发教程](http://java.sun.com/docs/books/tutorial/essential/concurrency/)。除此之外，买一本好书。

祝你好运 ：）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-01T07:41:17.247

并发是一个深刻而复杂的话题。[Java Concurrency in Practice](https://rads.stackoverflow.com/amzn/click/com/0321349601)等书籍可能会有所帮助。

有关线程的 API，请参阅[并发实用程序概述](http://java.sun.com/j2se/1.5.0/docs/guide/concurrency/overview.html)。[例如， BlockingQueue<E>](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/BlockingQueue.html)可能很有用。

> 一个队列，它还支持在检索元素时等待队列变为非空，并在存储元素时等待队列中的空间变为可用的操作。

见[倒计时锁存器](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/CountDownLatch.html)

> 一种同步辅助，允许一个或多个线程等待，直到在其他线程中执行的一组操作完成。

和[CyclicBarrier](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/CyclicBarrier.html)用于一些有趣的行为。

> 一种同步辅助工具，它允许一组线程相互等待以达到共同的障碍点。

**编辑**：我现在正在阅读 Java Concurrency in Practice。这很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T21:17:50.663

> 使用线程时，我有时将它们想象为在空间上下文中将对象之间的 3 维或更多维互连编织在一起。

听起来确实很复杂，例如，您将如何概念化 600 个线程？为什么不将它们视为显然同时运行的多个执行线程。

> 您是否使用任何 API 来帮助线程化？

我建议最简单和最直接的方法是你会找到的第一个匹配项。[http://www.google.co.uk/search?q=java+threads](http://www.google.co.uk/search?q=java+threads)

> 您是否以不将线程概念化为进程的方式使用线程？

由于线程不是进程，我不能说我曾经将线程视为进程。（旧版本的 Linux 除外）默认情况下，进程不共享内存/对象，它们完全独立运行（通常是不同的程序，可能用不同的语言编写）它们也使用不同的 API 以不同的方式启动。

有一种观点认为多线程很复杂。其实我想说的恰恰相反。多线程编程要求您使您的代码简单、易于理解和直接推理。虽然这需要经验，但您的目标是简单。

# javascript - jQuery 动画背景颜色

> ID：190560
> 
> 赞同：333
> 
> 时间：2008-10-10T08:49:28.303
> 
> 标签：javascript, jquery, colors, jquery-animate

我正在尝试在鼠标悬停时使用 jQuery 对 backgroundColor 的变化进行动画处理。

我已经检查了一些示例，并且似乎是正确的，它可以与其他属性（例如 fontSize）一起使用，但是使用 backgroundColor 时，我得到了“无效属性”js 错误。我正在使用的元素是一个 div。

```
$(".usercontent").mouseover(function() {
    $(this).animate({ backgroundColor: "olive" }, "slow");
}); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：335
> 
> 时间：2010-02-20T11:25:30.733

颜色插件仅比 UI 库便宜 4kb。当然，您会想要使用一个[不错](http://github.com/jquery/jquery-color)的插件版本，而不是一些无法处理 Safari 并在转换太快时崩溃的有问题的[旧东西。](http://plugins.jquery.com/project/color)由于没有提供缩小版本，您可能想测试各种压缩器并[制作自己的](http://compressorrater.thruhere.net/)最小版本。在这种情况下，YUI 获得了最好的压缩，只需要 2317 个字节，而且因为它很小 - 这里是：

```
(function (d) {
    d.each(["backgroundColor", "borderBottomColor", "borderLeftColor", "borderRightColor", "borderTopColor", "color", "outlineColor"], function (f, e) {
        d.fx.step[e] = function (g) {
            if (!g.colorInit) {
                g.start = c(g.elem, e);
                g.end = b(g.end);
                g.colorInit = true
            }
            g.elem.style[e] = "rgb(" + [Math.max(Math.min(parseInt((g.pos * (g.end[0] - g.start[0])) + g.start[0]), 255), 0), Math.max(Math.min(parseInt((g.pos * (g.end[1] - g.start[1])) + g.start[1]), 255), 0), Math.max(Math.min(parseInt((g.pos * (g.end[2] - g.start[2])) + g.start[2]), 255), 0)].join(",") + ")"
        }
    });

    function b(f) {
        var e;
        if (f && f.constructor == Array && f.length == 3) {
            return f
        }
        if (e = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(f)) {
            return [parseInt(e[1]), parseInt(e[2]), parseInt(e[3])]
        }
        if (e = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(f)) {
            return [parseFloat(e[1]) * 2.55, parseFloat(e[2]) * 2.55, parseFloat(e[3]) * 2.55]
        }
        if (e = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(f)) {
            return [parseInt(e[1], 16), parseInt(e[2], 16), parseInt(e[3], 16)]
        }
        if (e = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(f)) {
            return [parseInt(e[1] + e[1], 16), parseInt(e[2] + e[2], 16), parseInt(e[3] + e[3], 16)]
        }
        if (e = /rgba\(0, 0, 0, 0\)/.exec(f)) {
            return a.transparent
        }
        return a[d.trim(f).toLowerCase()]
    }
    function c(g, e) {
        var f;
        do {
            f = d.css(g, e);
            if (f != "" && f != "transparent" || d.nodeName(g, "body")) {
                break
            }
            e = "backgroundColor"
        } while (g = g.parentNode);
        return b(f)
    }
    var a = {
        aqua: [0, 255, 255],
        azure: [240, 255, 255],
        beige: [245, 245, 220],
        black: [0, 0, 0],
        blue: [0, 0, 255],
        brown: [165, 42, 42],
        cyan: [0, 255, 255],
        darkblue: [0, 0, 139],
        darkcyan: [0, 139, 139],
        darkgrey: [169, 169, 169],
        darkgreen: [0, 100, 0],
        darkkhaki: [189, 183, 107],
        darkmagenta: [139, 0, 139],
        darkolivegreen: [85, 107, 47],
        darkorange: [255, 140, 0],
        darkorchid: [153, 50, 204],
        darkred: [139, 0, 0],
        darksalmon: [233, 150, 122],
        darkviolet: [148, 0, 211],
        fuchsia: [255, 0, 255],
        gold: [255, 215, 0],
        green: [0, 128, 0],
        indigo: [75, 0, 130],
        khaki: [240, 230, 140],
        lightblue: [173, 216, 230],
        lightcyan: [224, 255, 255],
        lightgreen: [144, 238, 144],
        lightgrey: [211, 211, 211],
        lightpink: [255, 182, 193],
        lightyellow: [255, 255, 224],
        lime: [0, 255, 0],
        magenta: [255, 0, 255],
        maroon: [128, 0, 0],
        navy: [0, 0, 128],
        olive: [128, 128, 0],
        orange: [255, 165, 0],
        pink: [255, 192, 203],
        purple: [128, 0, 128],
        violet: [128, 0, 128],
        red: [255, 0, 0],
        silver: [192, 192, 192],
        white: [255, 255, 255],
        yellow: [255, 255, 0],
        transparent: [255, 255, 255]
    }
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2009-02-26T11:01:32.490

我遇到了同样的问题并通过包含 jQuery UI 来修复它。这是完整的脚本：

```
<!-- include Google's AJAX API loader -->
<script src="http://www.google.com/jsapi"></script>
<!-- load JQuery and UI from Google (need to use UI to animate colors) -->
<script type="text/javascript">
google.load("jqueryui", "1.5.2");
</script>

<script type="text/javascript">
$(document).ready(function() {
$('#menu ul li.item').hover(
    function() {
        $(this).stop().animate({backgroundColor:'#4E1402'}, 300);
        }, function () {
        $(this).stop().animate({backgroundColor:'#943D20'}, 100);
    });
});
</script> 
```

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2013-03-05T21:11:08.067

使用 CSS3-Transitions 来实现。支持很棒（所有现代浏览器，甚至 IE）。使用 Compass 和 SASS 可以快速完成：

```
#foo {background:red; @include transition(background 1s)}
#foo:hover {background:yellow} 
```

纯 CSS：

```
#foo {
background:red;
-webkit-transition:background 1s;
-moz-transition:background 1s;
-o-transition:background 1s;
transition:background 1s
}
#foo:hover {background:yellow} 
```

我写了一篇关于这个主题的德语文章：http: [//www.solife.cc/blog/animation-farben-css3-transition.html](http://www.solife.cc/blog/animation-farben-css3-transition.html)

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2011-01-29T10:44:11.697

Bitstorm 有我见过的最好的 jquery 颜色动画插件。这是对 jquery 颜色项目的改进。它还支持 rgba。

[http://www.bitstorm.org/jquery/color-animation/](http://www.bitstorm.org/jquery/color-animation/)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-08-09T08:00:21.263

您可以使用 jQuery UI 添加此功能。你可以抓住你需要的东西，所以如果你想为颜色设置动画，你只需要包含以下代码。我从最新的 jQuery UI（目前是 1.8.14）得到了 if

```
/******************************************************************************/
/****************************** COLOR ANIMATIONS ******************************/
/******************************************************************************/

// override the animation for color styles
$.each(['backgroundColor', 'borderBottomColor', 'borderLeftColor',
    'borderRightColor', 'borderTopColor', 'borderColor', 'color', 'outlineColor'],
function(i, attr) {
    $.fx.step[attr] = function(fx) {
        if (!fx.colorInit) {
            fx.start = getColor(fx.elem, attr);
            fx.end = getRGB(fx.end);
            fx.colorInit = true;
        }

        fx.elem.style[attr] = 'rgb(' +
            Math.max(Math.min(parseInt((fx.pos * (fx.end[0] - fx.start[0])) + fx.start[0], 10), 255), 0) + ',' +
            Math.max(Math.min(parseInt((fx.pos * (fx.end[1] - fx.start[1])) + fx.start[1], 10), 255), 0) + ',' +
            Math.max(Math.min(parseInt((fx.pos * (fx.end[2] - fx.start[2])) + fx.start[2], 10), 255), 0) + ')';
    };
});

// Color Conversion functions from highlightFade
// By Blair Mitchelmore
// http://jquery.offput.ca/highlightFade/

// Parse strings looking for color tuples [255,255,255]
function getRGB(color) {
        var result;

        // Check if we're already dealing with an array of colors
        if ( color && color.constructor == Array && color.length == 3 )
                return color;

        // Look for rgb(num,num,num)
        if (result = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(color))
                return [parseInt(result[1],10), parseInt(result[2],10), parseInt(result[3],10)];

        // Look for rgb(num%,num%,num%)
        if (result = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(color))
                return [parseFloat(result[1])*2.55, parseFloat(result[2])*2.55, parseFloat(result[3])*2.55];

        // Look for #a0b1c2
        if (result = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(color))
                return [parseInt(result[1],16), parseInt(result[2],16), parseInt(result[3],16)];

        // Look for #fff
        if (result = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(color))
                return [parseInt(result[1]+result[1],16), parseInt(result[2]+result[2],16), parseInt(result[3]+result[3],16)];

        // Look for rgba(0, 0, 0, 0) == transparent in Safari 3
        if (result = /rgba\(0, 0, 0, 0\)/.exec(color))
                return colors['transparent'];

        // Otherwise, we're most likely dealing with a named color
        return colors[$.trim(color).toLowerCase()];
}

function getColor(elem, attr) {
        var color;

        do {
                color = $.curCSS(elem, attr);

                // Keep going until we find an element that has color, or we hit the body
                if ( color != '' && color != 'transparent' || $.nodeName(elem, "body") )
                        break;

                attr = "backgroundColor";
        } while ( elem = elem.parentNode );

        return getRGB(color);
}; 
```

用 YUI 压缩后只有 1.43kb：

```
$.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(b,a){$.fx.step[a]=function(c){if(!c.colorInit){c.start=getColor(c.elem,a);c.end=getRGB(c.end);c.colorInit=true}c.elem.style[a]="rgb("+Math.max(Math.min(parseInt((c.pos*(c.end[0]-c.start[0]))+c.start[0],10),255),0)+","+Math.max(Math.min(parseInt((c.pos*(c.end[1]-c.start[1]))+c.start[1],10),255),0)+","+Math.max(Math.min(parseInt((c.pos*(c.end[2]-c.start[2]))+c.start[2],10),255),0)+")"}});function getRGB(b){var a;if(b&&b.constructor==Array&&b.length==3){return b}if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b)){return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10)]}if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b)){return[parseFloat(a[1])*2.55,parseFloat(a[2])*2.55,parseFloat(a[3])*2.55]}if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b)){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b)){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}if(a=/rgba\(0, 0, 0, 0\)/.exec(b)){return colors.transparent}return colors[$.trim(b).toLowerCase()]}function getColor(c,a){var b;do{b=$.curCSS(c,a);if(b!=""&&b!="transparent"||$.nodeName(c,"body")){break}a="backgroundColor"}while(c=c.parentNode);return getRGB(b)}; 
```

您还可以使用 CSS3 过渡设置颜色动画，但它仅受现代浏览器支持。

```
a.test {
  color: red;
  -moz-transition-property: color;  /* FF4+ */
  -moz-transition-duration: 1s;
  -webkit-transition-property: color;  /* Saf3.2+, Chrome */
  -webkit-transition-duration: 1s;
  -o-transition-property: color;  /* Opera 10.5+ */
  -o-transition-duration: 1s;
  -ms-transition-property: color;  /* IE10? */
  -ms-transition-duration: 1s;
  transition-property: color;  /* Standard */
  transition-duration: 1s;
  }

  a.test:hover {
  color: blue;
  } 
```

使用速记属性：

```
/* shorthand notation for transition properties */
/* transition: [transition-property] [transition-duration] [transition-timing-function] [transition-delay]; */

a.test {
  color: red;
  -moz-transition: color 1s;
  -webkit-transition: color 1s;
  -o-transition: color 1s;
  -ms-transition: color 1s;
  transition: color 1s;
  }

a.test {
  color: blue;
 } 
```

与常规的 javascript 过渡不同，CSS3 过渡是硬件加速的，因此更流畅。您可以使用 Modernizr 来确定浏览器是否支持 CSS3 过渡，如果不支持，则可以使用 jQuery 作为后备：

```
if ( !cssTransitions() ) {
    $(document).ready(function(){
        $(".test").hover(function () {
                $(this).stop().animate({ backgroundColor: "red" },500)
             }, function() {
                 $(this).stop().animate({ backgroundColor: "blue" },500)}    
             );
    }); 
} 
```

请记住在开始新动画之前使用 stop() 停止当前动画，否则当您过快地通过元素时，效果会持续闪烁一段时间。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-12-01T06:08:09.420

对于任何找到这个的人。最好使用 jQuery UI 版本，因为它适用于所有浏览器。颜色插件在 Safari 和 Chrome 中存在问题。它只是有时有效。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2010-10-09T02:16:20.867

您可以使用 2 个 div：

您可以在其上放置一个克隆，并在淡入克隆的同时淡出原件。

当淡入淡出完成后，用新的 bg 恢复原来的。

```
$(function(){
    var $mytd = $('#mytd'), $elie = $mytd.clone(), os = $mytd.offset();

      // Create clone w other bg and position it on original
    $elie.toggleClass("class1, class2").appendTo("body")
         .offset({top: os.top, left: os.left}).hide();

    $mytd.mouseover(function() {            
          // Fade original
        $mytd.fadeOut(3000, function() {
            $mytd.toggleClass("class1, class2").show();
            $elie.toggleClass("class1, class2").hide();            
        });
          // Show clone at same time
        $elie.fadeIn(3000);
    });
});​ 
```

## **[jsFiddle 示例](http://jsfiddle.net/cq2S8/)**

**[`.toggleClass()`](http://api.jquery.com/toggleClass/)**
**[`.offset()`](http://api.jquery.com/offset/)**
**[`.fadeIn()`](http://api.jquery.com/fadeIn/)**
**[`.fadeOut()`](http://api.jquery.com/fadeOut/)**

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2012-12-11T14:48:38.007

我将 CSS 转换与 JQuery 结合使用以获得所需的效果；显然，不支持 CSS 转换的浏览器不会设置动画，但它是一个轻量级的选项，适用于大多数浏览器，并且对于我的要求，降级是可以接受的。

**Jquery改变背景颜色：**

```
 $('.mylinkholder a').hover(
        function () {
            $(this).css({ backgroundColor: '#f0f0f0' }); 
        },
        function () {
            $(this).css({ backgroundColor: '#fff' });
        }
    ); 
```

**CSS使用过渡淡化背景颜色变化**

```
 .mylinkholder a
   {
   transition: background-color .5s ease-in-out;
   -moz-transition: background-color .5s ease-in-out;
   -webkit-transition: background-color .5s ease-in-out; 
  -o-transition: background-color .5s ease-in-out; 
   } 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-07-26T12:09:36.903

这些天 jQuery 颜色插件支持以下命名颜色：

```
aqua:[0,255,255],
azure:[240,255,255],
beige:[245,245,220],
black:[0,0,0],
blue:[0,0,255],
brown:[165,42,42],
cyan:[0,255,255],
darkblue:[0,0,139],
darkcyan:[0,139,139],
darkgrey:[169,169,169],
darkgreen:[0,100,0],
darkkhaki:[189,183,107],
darkmagenta:[139,0,139],
darkolivegreen:[85,107,47],
darkorange:[255,140,0],
darkorchid:[153,50,204],
darkred:[139,0,0],
darksalmon:[233,150,122],
darkviolet:[148,0,211],
fuchsia:[255,0,255],
gold:[255,215,0],
green:[0,128,0],
indigo:[75,0,130],
khaki:[240,230,140],
lightblue:[173,216,230],
lightcyan:[224,255,255],
lightgreen:[144,238,144],
lightgrey:[211,211,211],
lightpink:[255,182,193],
lightyellow:[255,255,224],
lime:[0,255,0],
magenta:[255,0,255],
maroon:[128,0,0],
navy:[0,0,128],
olive:[128,128,0],
orange:[255,165,0],
pink:[255,192,203],
purple:[128,0,128],
violet:[128,0,128],
red:[255,0,0],
silver:[192,192,192],
white:[255,255,255],
yellow:[255,255,0] 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-06-16T09:00:43.787

只需在您的 jquery 脚本下方添加以下代码段即可享受：

```
<script src="https://cdn.jsdelivr.net/jquery.color-animation/1/mainfile"></script> 
```

[看例子](https://codepen.io/darush/pen/WjqooB/)

[更多信息参考](https://bitstorm.org/jquery/color-animation/)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2010-11-03T14:11:30.167

我喜欢使用 delay() 来完成这项工作，这是一个示例：

```
jQuery(element).animate({ backgroundColor: "#FCFCD8" },1).delay(1000).animate({ backgroundColor: "#EFEAEA" }, 1500); 
```

这可以由函数调用，“元素”是元素类/名称/等。该元素将立即以#FCFCD8 背景出现，按住一秒钟，然后淡入#EFEAEA。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-01-13T16:18:47.793

试试这个：

```
(function($) {  

            var i = 0;  

            var someBackground = $(".someBackground");  
            var someColors = [ "yellow", "red", "blue", "pink" ];  

            someBackground.css('backgroundColor', someColors[0]);  

            window.setInterval(function() {  
                i = i == someColors.length ? 0 : i;  
                someBackground.animate({backgroundColor: someColors[i]}, 3000);  
                i++;  
            }, 30);  

})(jQuery); 
```

你可以在这里预览示例：http: [//jquerydemo.com/demo/jquery-animate-background-color.aspx](http://jquerydemo.com/demo/jquery-animate-background-color.aspx)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-10-15T13:40:28.097

我偶然发现这个页面有同样的问题，但有以下问题：

1.  我当前的设置不能包含额外的 jQuery 插件文件。
2.  我不习惯粘贴没有时间阅读和验证的大块代码。
3.  我无权访问CSS。
4.  我几乎没有时间实施（这只是对管理页面的视觉改进）

以上几乎排除了所有答案。考虑到我的褪色非常简单，我使用了以下快速破解方法：

```
element
  .css('color','#FF0000')
;
$('<div />')
  .css('width',0)
  .animate(
    {'width':100},
    {
      duration: 3000,
      step:function(now){
        var v = (255 - 255/100 * now).toString(16);
        v = (v.length < 2 ? '0' : '') + v.substr(0,2);
        element.css('color','#'+v+'0000');
      }
    }
  )
; 
```

上面创建了一个永远不会放在文档流中的临时 div。然后，我使用 jQuery 的内置动画为该元素的数字属性设置动画 - 在本例中`width`- 它可以表示百分比（0 到 100）。然后，使用 step 函数，我通过简单的十六进制计算将这个数字动画转换为文本颜色。

也可以使用. `setInterval`_`.stop()``easing``duration`

显然，它仅用于简单的颜色渐变，对于更复杂的颜色转换，您需要使用上述答案之一 - 或编写您自己的颜色渐变数学 :)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-01-06T01:38:07.613

ColorBlend 插件完全符合您的要求

[http://plugins.jquery.com/project/colorBlend](http://plugins.jquery.com/project/colorBlend)

这是我的突出显示代码

```
$("#container").colorBlend([{
    colorList:["white",  "yellow"], 
    param:"background-color",
    cycles: 1,
    duration: 500
}]); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-01-08T12:23:35.367

如果您不想仅使用核心 jQuery 功能为背景设置动画，请尝试以下操作：

```
jQuery(".usercontent").mouseover(function() {
      jQuery(".usercontent").animate({backgroundColor:'red'}, 'fast', 'linear', function() {
            jQuery(this).animate({
                backgroundColor: 'white'
            }, 'normal', 'linear', function() {
                jQuery(this).css({'background':'none', backgroundColor : ''});
            });
        }); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-02-23T03:22:21.360

试试这个：

```
jQuery(".usercontent").hover(function() {
    jQuery(this).animate({backgroundColor:"pink"}, "slow");
},function(){
    jQuery(this).animate({backgroundColor:"white"}, "slow");
}); 
```

修改方式与效果：

```
jQuery(".usercontent").hover(function() {

    jQuery(this).fadeout("slow",function(){
        jQuery(this).animate({"color","yellow"}, "slow");
    });
}); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-12-21T08:46:43.167

尝试使用它

```
-moz-transition: background .2s linear;
-webkit-transition: background .2s linear;
-o-transition: background .2s linear;
transition: background .2s linear; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-06-21T12:03:09.067

要在不使用 jQueryUI 的情况下使用动画效果更改背景颜色：

```
selector.css({
    backgroundColor: "#555",
    transition: "background-color 1.8s"
}); 
```

# ant - 如何从 TeamCity 中提取工件？

> ID：190587
> 
> 赞同：5
> 
> 时间：2008-10-10T09:02:53.890
> 
> 标签：ant, continuous-integration, nant, teamcity, html-agility-pack

我想从 teamcity 中提取工件。

我一直在尝试使用 c# 和 HtmlAgilityPack 来访问该网站并找到最新版本及其工件。我目前卡在登录状态，我想我只需要发送会话 Cookie 即可。

我是否朝着正确的方向前进，有其他人尝试过吗？

我意识到使用构建脚本推出文件很容易，但我想尽量减少对 Ant、NAnt 文件的更改，因为我正在考虑将其扩展到 100 个应用程序。

**编辑：**这个问题看起来很有前景[Getting HTML from a page behind a login](https://stackoverflow.com/questions/61217/getting-html-from-a-page-behind-a-login)

**编辑：**现在可以了，我只需要编写一些代码来解析它

```
WebClient ww = new WebClient();
ww.Credentials = CredentialCache.DefaultCredentials;
ww.DownloadString("http://yourteamcity.com/login.html");
ww.Headers.Add("Cookie",ww.ResponseHeaders["Set-Cookie"]);

NameValueCollection post = new NameValueCollection();
post.Add("username", "name");
post.Add("remember","true");
post.Add("submitLogin", "Login");
post.Add("publicKey","long thing to intercept with fiddler");
post.Add("encryptedPassword","not giving you this");
post.Add("_", "");
byte[] values = ww.UploadValues("http://yourteamcity.com/loginSubmit.html", "POST",post);
string s = ww.DownloadString("http://yourteamcity.com/overview.html"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T01:11:58.093

有更简单的解决方案，请阅读： http: [//www.jetbrains.net/confluence/display/TCD4/Patterns+For+Accessing+Build+Artifacts](http://www.jetbrains.net/confluence/display/TCD4/Patterns+For+Accessing+Build+Artifacts)

# ruby - Ruby 有内置的 do ... while 吗？

> ID：190590
> 
> 赞同：14
> 
> 时间：2008-10-10T09:03:46.323
> 
> 标签：ruby, conditional, keyword

Ruby 有丰富的条件结构，包括`if`/ `unless`，`while`/`until`等。

`while`来自 C的块：

```
while (condition) {
    ...
} 
```

可以直接翻译成Ruby：

```
while condition 
    ...
end 
```

但是，我似乎无法在 Ruby 中找到类似 C 的块的*内置*等效项`do ... while`，其中块内容至少执行一次：

```
do { 
    ... 
} while (condition); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-10T09:04:09.800

...我能想到的最好的方法是末尾`loop`带有 a 的构造：`break`

```
loop do
    ...
    break unless condition
end 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-10T13:51:04.017

你可以做

```
i=1
begin
  ...
  i+=1 
end until 10==x 
```

（您也可以在 begin..end 的末尾添加一个 while 子句）

请参阅 Flanagan/Matz Ruby Prog'g Lang 书的第 128 页：这可能会在 1.8 之后的版本中删除

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-11-02T02:27:06.887

```
number=3
begin
 puts  number
 number-=1
end while number>0 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-10-10T09:20:29.550

您可以使用

```
while condition
  ...
end 
```

# c# - 页面生命周期 - 使用 FindControl 引用在页面加载期间以编程方式创建的控件

> ID：190593
> 
> 赞同：2
> 
> 时间：2008-10-10T09:04:46.103
> 
> 标签：c#, asp.net, .net, controls

我正在以编程方式在表单上创建一些文本框，稍后我需要使用 FindControl 引用这些文本框。

我在创建它们的代码之后将 FindControl 指令放在页面加载方法中，但出现错误：

> **你调用的对象是空的。**

我认为这是因为文本框控件直到生命周期的后期才创建，因此无法从 Page_Load 中引用。

有人可以建议我需要在我的代码隐藏中放置 FindControl 指令的位置，以便它可以找到这些以编程方式创建的文本框吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T16:34:08.820

您是否将文本框控件放在另一个控件（例如面板或网格）中？如果是这样，您需要递归搜索页面上的所有控件。

这是递归 FindControl 实现的示例：[Recursive Page.FindControl](http://www.codinghorror.com/blog/2005/06/recursive-pagefindcontrol.html)。您可以通过谷歌搜索“recursive findcontrol”找到许多其他示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T09:20:55.743

如果您以编程方式创建文本框，则可以直接使用它来操作它们。不需要 FindControl（也会更慢）

```
TextBox txt = new TextBox();
...
txt.Text = "Text"; 
```

如果您需要以不同的方法访问，您可以将 txt 设置为该类的私有变量。

如果您确实需要使用 FindControl - 调用函数时是否在页面中添加了文本框（添加到页面的控件列表中）？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T11:06:13.190

在页面加载时，所有控件都应该设置好并准备好使用。控件在加载阶段之前的初始化阶段被初始化。

我建议您检查查找控件的代码，例如，如果控件嵌套在其他控件中，则需要递归搜索或从正确的容器控件中搜索。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T11:06:44.047

如果您在 CreateChildControls 中添加文本框，您可能必须在访问它们之前调用 EnsureChildControls。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-26T06:28:21.023

刚刚从Steele Price的[博客文章中发现了这个功能，它运行良好。](http://blog.steeleprice.net/archive/2007/04/23/1142.aspx)我试图在具有母版页的页面内引用用户控件，除此之外我没有尝试过任何工作。把它放在你的核心课程之一。阅读[斯蒂尔的博​​文](http://blog.steeleprice.net/archive/2007/04/23/1142.aspx)了解更多详情。

如果你把它放在一个类中，你将需要获取控件引用，例如：

```
Dim imgStep2PreviewIcon As Image = Eyespike.Utilities.FindControl(Of Control)(Page, "imgStep1PreviewIcon")
imgStep2PreviewIcon.Visible = False 
```

**VB.NET 代码**

```
Public Shadows Function FindControl(ByVal id As String) As Control
    Return FindControl(Of Control)(Page, id)
End Function

Public Shared Shadows Function FindControl(Of T As Control)(ByVal startingControl As Control, ByVal id As String) As T
    Dim found As Control = startingControl
    If (String.IsNullOrEmpty(id) OrElse (found Is Nothing)) Then Return CType(Nothing, T)
    If String.Compare(id, found.ID) = 0 Then Return found
    For Each ctl As Control In startingControl.Controls
        found = FindControl(Of Control)(ctl, id)
        If (found IsNot Nothing) Then Return found
    Next
    Return CType(Nothing, T)
End Function 
```

**C#** （未经测试，使用[converter.telerik.com](http://converter.telerik.com)生成）

```
public new Control FindControl(string id)
{
    return FindControl<Control>(Page, id);
}

public static new T FindControl<T>(Control startingControl, string id) where T : Control
{
    Control found = startingControl;
    if ((string.IsNullOrEmpty(id) || (found == null))) return (T)null; 
    if (string.Compare(id, found.ID) == 0) return found; 
    foreach (Control ctl in startingControl.Controls) {
        found = FindControl<Control>(ctl, id);
        if ((found != null)) return found; 
    }
    return (T)null;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T11:01:03.590

如果您在 OnInit 覆盖期间制作 TextBox 控件（我相信在调用 base.OnInit(e) 之前），它们将在 Page.OnLoad 和任何相关事件期间可用。您还可以将它们放入 ViewState 对象图中的正确位置，这对于处理回发特别是服务器端验证非常有用。

# ruby-on-rails - 将二进制 gem 部署到不同的平台

> ID：190594
> 
> 赞同：0
> 
> 时间：2008-10-10T09:05:12.077
> 
> 标签：ruby-on-rails, ruby, deployment, gem

我有一个需要部署的 Rails 应用程序。以下是事实：

*   该应用程序是在 Windows 上开发的，需要 Windows 二进制 gem
*   该应用程序将部署到 Open Solaris 共享服务器 (Joyent)
*   我无权在服务器上安装 gems
*   对于非二进制宝石，我可以简单地在`rake gems:unpack`本地做一个然后上传；这很好用。

所以我的问题是，如何将我需要的**二进制**gem 放到我的生产服务器上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-12T20:27:02.467

> *   该应用程序是在 Windows 上开发的，需要 Windows 二进制 gem
> *   该应用程序将部署到 Open Solaris 共享服务器 (Joyent)

您确实意识到您不能在打开的 solaris 上运行 Windows 二进制文件。Windows实际上与solaris完全不同......

如果 gem 来自第三方，您可以下载其他人制作的用于 solaris 的预打包二进制版本。然后，您可以将它们放在供应商目录中并从那里加载它们，而不是安装 gem。

如果您无法获得用于 solaris 的预打包二进制文件，则需要获得自己的 solaris 机器（使用 Virtual PC、VMWare、VirtualBox 等），使用它来编译 gem，然后将二进制文件提取出来。

如果您实际上只有可在 Windows 上运行的源代码（例如：您自己构建了它，或者提供 gem 的人仅将其设计为在 Windows 上运行），那么您就完蛋了。您将需要找到一个跨平台的替代品。

如果您能告诉我们您在谈论*哪些*宝石，这将有所帮助，这样人们就可以帮助找到更具体的解决方案，并准确解释发生了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T23:58:25.617

请求共享服务器管理员为您安装 gem。如果它们是来自知名域的“标准”gem，那真的应该没什么大不了的，我的共享服务器提供商一直都在这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T09:54:00.917

二进制宝石是真正的问题。对于所有其他 gem，您可以使用该`vendor/gems`目录（仅适用于 Rails 2.1+）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T11:56:11.020

[供应一切。](http://errtheblog.com/posts/50-vendor-everything)

这有两件事。它使您的应用程序可部署，而不依赖于系统安装的 gems，其次，它将特定版本的 gem 冻结到您的应用程序。因此，如果其他人从您的 SCM 工具中检查出来，他们就不会出现版本不匹配的问题，并且可以正常运行并正常运行。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T14:41:14.460

您可能必须使用交叉编译器来定位在 Windows 上运行的 Solaris。

构建交叉编译器通常是一个困难且容易出错的过程。我以前做过，复杂性不适合胆小的人。理想情况下，您会找到可以访问 Solaris 构建机器的人并让他们为您创建二进制文件。

如果您必须使用交叉编译器路线，我怀疑解决方案将是安装 cygwin 并使用其构建工具来创建 cygwin 托管的 solaris 交叉编译器。我建议查看[crosstool](http://www.kegel.com/crosstool/) 项目，该项目将为您提供为您处理一些细节的脚本。

# c - 在winapi中拖放

> ID：190596
> 
> 赞同：6
> 
> 时间：2008-10-10T09:06:46.053
> 
> 标签：c, windows, winapi, drag-and-drop

我有一个需要一些新功能的纯 Winapi 应用程序。其中之一最好实现为两个列表，您可以在列表之间拖放（多个）元素。新功能可以限制为单个对话框。

实现这一点的最快方法是什么？一些想法：

*   纯 Winapi（是 DetectDrag）
*   提供此对话框的单独 MFC 或 .NET DLL
*   嵌入 Microsoft WebBrowser 控件并使用 JQuery

应该避免这些选项中的任何一个吗？
有更好的想法吗？
什么是最快实施的？
关于如何开始的任何指示？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T12:19:32.093

我的建议是，如果应用程序是纯 winapi，请保持这种方式。

仅为一个带有可拖动项目的对话框启动 .NET 框架运行时与托管 WebBrowser 控件并使用 JQuery 来实现该功能一样糟糕 - 如果你问我，它至少值得 thedailywtf.com 使用（但话又说回来，你不是问我 ;） ）。

否则，您会将自己（以及可能的其他人）置于一些可维护性的噩梦中，而最快的方法将成为最有问题的方法。

*编辑：*也许[这](http://www.codeproject.com/KB/list/jianghong.aspx?display=Print) [两篇](http://www.codeproject.com/KB/list/dragdroplistviewreorder1.aspx?display=Print)文章将有助于实现拖放 - 它们是关于 ListViews 中的行重新排序，但可能有助于获得这个想法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T13:28:22.830

不久前，Raymond Chen 就这个话题写了一系列博文。[从这里](https://devblogs.microsoft.com/oldnewthing/20080311-00/?p=23153)开始。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-02T09:43:27.643

在 Win32 api 中实现后的一些注意事项：

ListBox 控件不支持拖放。它必须是 ListView 控件。

这篇[CodeProject 文章](http://www.codeproject.com/KB/list/jianghong.aspx?display=Print)非常好。（感谢 macbirdie）[ListViews](http://msdn.microsoft.com/en-us/library/bb774737(VS.85).aspx)
的 MSDN 部分当然非常有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T16:00:10.790

所有代码都在 MSDN 中 C 和 win32 api 只需复制粘贴即可。

并查看专业的 Win32 api ng 新闻：//194.177.96.26/comp.os.ms-windows.programmer.win32，所有这些都已经讨论了几十年......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-10T09:25:12.753

无论您最熟悉哪种方法都将是最快的。

当然，在 .NET Windows 窗体中很容易做到这一点。只需编写几行代码，您就可以轻松地在 ListBox 条目之间拖放项目。[在CodeProject 之](http://www.codeproject.com)类的地方查看示例。

# java - 如何用 final 方法模拟一个类？

> ID：190597
> 
> 赞同：6
> 
> 时间：2008-10-10T09:06:47.097
> 
> 标签：java, unit-testing, mocking, legacy-code

说我有A类

```
class A {
  final String foo() {
    // .. computing result, contacting database, whatever ..
    return "some computed value";
  }
  // ... and a bazillion other methods, some of them final.
} 
```

现在我有B级

```
class B {
  String methodIWantToTest(A a) {
      String output = a.foo();
      // ... whatever this method does, e.g.:
      output += "_suffix";
      return output;
  }
} 
```

我将如何对这种方法进行单元测试？原因`foo()`是最终的，因为我们不希望扩展 A 的类改变其功能。但是在真正对方法进行单元测试的同时，我不希望它伸出手来运行实际的`A.foo()`方法。

有没有办法，比如说，删除 final 关键字并添加注释`@finalUnlessTest`？你会推荐什么？将 A 重构为接口将非常非常困难，因为它是我们的中心类之一，并且不幸的~~是非常~~耦合。

**编辑#1**对不起，忘了提，我们说的是 Java。到目前为止，我们还没有使用模拟框架。

**回答**好，所以：哇。[JMockit](http://jmockit.org)简直令人难以置信，在我看来，它是测试遗留代码的杀手级应用。令人难以置信的有用，尤其是在我的情况下。非常感谢！您基本上会为我的伪示例执行以下操作：

```
class AMock {
   final String foo() {
     return "myTestValue";
   }
}
class Test extends TestCase {
   A mockedA;
   B b;
   protected void setUp() {
      Mockit.redefineMethods( A.class, AMock.class );  // this "pipes" all mocked methods from A to AMock
      mockedA = new A();    // NOT new AMock()!!!
      b = new B();
   }
   public void testB() {
      assertEquals("myTestValue",mockedA.foo());
      assertEquals("myTestValue_suffix",b.methodIWantToTest(mockedA));
   }
} 
```

这是他妈的酷还是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T09:15:02.573

你可以试试[JMockit](http://jmockit.org)模拟库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T09:11:00.957

我会删除“最终”并添加评论“不要覆盖此方法！！”。如果你不能相信同事不遵循简单的指示，那无论如何都是没有希望的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T09:05:38.350

以下代码也将允许您执行此操作。我并不是说这是一种好的做法，但它是匿名类的一个有趣的使用（滥用？）。

```
public class Jobber {

    public final String foo() {
        return fooFactory() ;
    }

    String fooFactory() {
        return "jobber" ;
    }

    public static void main(String[] args) {

        Jobber jobber = new Jobber() { String fooFactory() { return "prefix " + super.fooFactory() ;} } ;

        System.out.println(jobber.foo() );
    }
} 
```

# delphi - 有没有办法在 Delphi 2009 中查看一个字符是使用 1 个字节还是 2 个字节？

> ID：190598
> 
> 赞同：4
> 
> 时间：2008-10-10T09:07:04.100
> 
> 标签：delphi, unicode, delphi-2009, character-encoding

Delphi 2009 已将其字符串类型更改为使用 2 个字节来表示一个字符，这允许支持 unicode 字符集。现在当你得到 sizeof(string) 你得到 length(String) * sizeof(char) 。Sizeof(char) 当前为 2。

我感兴趣的是是否有人知道一种方法，它可以逐个字符地找出它是否适合单个字节，例如找出一个char是ascii还是Unicode。

我主要想知道的是，在我的字符串进入数据库（oracle、Documentum）之前，该字符串将使用多少字节。

我们需要能够预先实施限制，理想情况下（因为我们有一个庞大的安装基础），而无需更改数据库。如果字符串字段允许 12 个字节，则在 delphi 2009 中，长度为 7 的字符串将始终显示为使用 14 个字节，即使一旦它到达数据库，它只会使用 7（如果是 ascii）或 14（如果是双字节），或者介于两者之间的某个位置混合物。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T09:09:51.570

您可以检查字符的值：

```
if ord(c) < 128 then
    // is an ascii character 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T14:29:48.167

首先，请记住，您的数据库长度可能实际上是字符，而不是字节 - 您必须检查数据类型的文档。出于问题的目的，我将假设它确实是后者。

您的字符串将使用的字节数完全取决于将要存储的字符编码。如果它是 UTF-16，Delphi 中的默认字符串类型，那么它总是每个字符 2 个字节，不包括代理。

然而，假设数据库使用 Unicode 字符集，最可能的编码是 UTF-8。这是一种可变长度编码：字符可能需要 1 到 4 个字节，具体取决于字符。您可以在 Wikipedia 上查看范围如何映射的图表。

但是，如果您根本不更改数据库架构，那么这一定意味着以下三件事之一：

1.  您目前以二进制方式存储所有内容，而不是文本方式（通常不是一个好的选择）
2.  数据库已经存储了 Unicode 和计数字符，而不是字节（否则，你现在会遇到问题，在重音字母的情况下更是如此）
3.  数据库存储在单字节代码页中，例如 Windows-1252，从而完全阻止您存储 Unicode 数据（这不是问题，因为字符的存储方式与以前相同，尽管您无法使用Unicode)

我对 Oracle 不熟悉，但如果您查看 MSSQL，它们有两种不同的数据类型：varchar 和 nvarchar。Varchar 以字节计，而 nvarchar 以字符计，因此适用于 Unicode。另一方面，MySQL 只有 varchar，而且它总是以字符计（从 4.1 开始）。因此，您应该检查 Oracle 文档和您的数据库架构，以获得关于这是否是一个问题的决定性答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T09:21:09.457

如果不想在 Delphi 2009 中使用 Unicode，可以使用 AnsiString 类型。但是你为什么要。

一个繁琐但有效的测试可能是：

```
function IsAnsi(const AString: string): Boolean;
var
  tempansi : AnsiString;
  temp : string;
begin
  tempansi := AnsiString(AString);
  temp := tempansi;
  Result := temp = AString;
end; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-24T20:08:09.473

您可以使用**StringElementSize**函数来确定字符串是 Unicode 还是 ANSI。要检查字符是否为 ANSI，请使用Character.pas 单元中的**TCharacter.IsAnsi**类函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T14:51:49.800

您回答说您真的想知道您的字符串将占用多少字节。

如何转换为 UTF8String？Ansi 字符将占用 1 个字节。请记住，在 UTF-8 中，Unicode 字符可能占用超过 2 个字节。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T16:24:28.663

由于 AnsiString 1 char = 1 字节和 Unicode String 1 char = 2 字节，执行的简单测试是 IsAnsiString:= sizeof(aString)=length(aString);

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-10T09:10:57.743

一个 ASCII 字符总是适合一个字节。您不能对 unicode 字符说同样的话，因为这取决于它的编码方式。您无法从单个字节中看出它是 ASCII 还是 unicode 字符，或者根本就不是字符。那么你的问题又是什么？为什么你需要知道？我的猜测是你误解了 unicode 或者我误解了你的问题。

# asp.net - asp.net 网站加载估计指南？

> ID：190609
> 
> 赞同：1
> 
> 时间：2008-10-10T09:10:57.620
> 
> 标签：asp.net, iis, webserver, loading

我想知道系统管理员是否有任何好的指导来计算托管 ASP.NET 网站所需的资源？我想对所需的处理能力做一些估计，这样我就知道我需要获得什么样的 VPS/Cloud。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T10:31:06.520

负载测试将是您最好的解决方案。

应用程序的扩展方式因大量变量而异，包括解决问题的类型、解决方法和其他因素。

100 个并发用户消耗 10% 的 CPU 并不意味着 500 个并发用户占 50%，它可能是 20%，也可能是 100%。

您的瓶颈可能是处理器或内存或网络带宽。

如果没有实际将负载放在您的应用程序上，任何估计都只是猜测，很可能会被证明是不正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T13:07:43.833

完全取决于应用程序。

如果您正在查看特定应用程序的需求，则将其放在您拥有的任何看起来像服务器的硬件上，使用精选的计数器启动 perfmon 运行，然后运行一些自动化工具进行负载测试，针对应用程序执行一些常见任务. 查看它的性能，然后根据您拥有的硬件、您运行的负载以及它的测量方式进行猜测。

根据经验，我看到在网络服务器端出现 ASP.NET 应用程序的瓶颈通常是 RAM。

它是运行 ASP.NET 应用程序后端的数据库，您需要担心 :-) 我会说 9/10 次我已​​经看到 ASP.NET 应用程序的性能问题，数据库一直是瓶颈。

# sql-server - 在 MS SQL Server 中使用存储过程的输出初始化变量

> ID：190625
> 
> 赞同：1
> 
> 时间：2008-10-10T09:20:11.267
> 
> 标签：sql-server, sql-server-2005, tsql, stored-procedures

我创建了以下存储过程..

```
CREATE PROCEDURE [dbo].[UDSPRBHPRIMBUSTYPESTARTUP]
(
  @CODE CHAR(5)
  , @DESC VARCHAR(255) OUTPUT
)
AS
DECLARE @SERVERNAME nvarchar(30)
DECLARE @DBASE nvarchar(30)
DECLARE @SQL nvarchar(2000)

SET @SERVERNAME = 
  Convert(nvarchar,
  (SELECT spData FROM dbSpecificData WHERE spLookup = 'CMSSERVER'))
SET @DBASE = 
  Convert(nvarchar,
  (SELECT spData FROM dbSpecificData WHERE spLookup = 'CMSDBNAME'))

SET @SQL = 
  'SELECT clnt_cat_desc FROM ' + @SERVERNAME + 
  '.' + @DBASE + '.dbo.hbl_clnt_cat WHERE inactive = ''N''
  AND clnt_cat_code = ''' + @CODE + ''''

EXECUTE sp_executeSQL @SQL

RETURN 
```

此过程用于许多不同的数据库和许多不同的服务器，并被编写为动态 SQL 以简化维护。该过程还在与该过程指向的服务器不同的服务器上运行。

我想将此过程的输出用作表中的值...

```
DECLARE @clid BIGINT
DECLARE @fileid BIGINT
DECLARE @myCode CHAR(5)
DECLARE @myDesc VARCHAR(255)
DECLARE @@tempDesc VARCHAR(255)

SET @clid = 1831400022
SET @fileid = 2072551358
SET @myCode = 
  (SELECT _clientPrimBusinessType FROM udbhextclient WHERE clid = @clid)

SET @myDesc = 
  EXEC UDSPRBHPRIMBUSTYPESTARTUP @CODE = @myCode, @DESC = @@tempDesc OUTPUT
----------------------------------------------------------------------------
SELECT
  a.clid
  , b.fileid
  , c.usrfullname AS ClientPartner
  , e.usrfullname AS ClientFeeEarner
  , @myDesc AS ClientPrimaryBusinessType
FROM 
  dbclient a
    INNER JOIN
  dbFile b
    ON
  a.clid = b.clid
    INNER JOIN
  dbuser c
    ON 
  a.feeusrid = c.usrid
    INNER JOIN
  udbhextclient d
    ON
  a.clid = d.clid
    INNER JOIN
  dbuser e
    ON
  d._ClientFeeEarner = e.usrid
WHERE 
  a.clid = @clid
  AND b.fileid = @fileid 
```

我知道这是不正确的语法，但是您可以看到我正在尝试实现这一点而无需使用临时表，因为这意味着要在 30 台不同的服务器上进行维护，每台服务器上有 3 到 5 个数据库。

Smink - 尝试了您的解决方案并得到以下结果......

![运行 Smink 的解决方案](https://farm4.static.flickr.com/3029/2928268613_dd3c454f92.jpg)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T09:52:01.437

换行：

```
SET @myDesc = 
  EXEC UDSPRBHPRIMBUSTYPESTARTUP @CODE = @myCode, @DESC = @@tempDesc OUTPUT 
```

到

```
EXEC UDSPRBHPRIMBUSTYPESTARTUP @CODE = @myCode, @DESC = @tempDesc OUTPUT 
```

而且您错过`@DESC`了在存储过程中的分配。

```
SET @SQL = 
  'SELECT @DESC = clnt_cat_desc FROM ' + @SERVERNAME + 
  '.' + @DBASE + '.dbo.hbl_clnt_cat WHERE inactive = ''N''
  AND clnt_cat_code = ''' + @CODE + ''''

EXECUTE sp_executeSQL @SQL, N'@DESC varchar(255) output', @DESC output 
```

然后，您应该`@tempDesc`在下一个选择中使用：

```
SELECT
  a.clid
  , b.fileid
  , c.usrfullname AS ClientPartner
  , e.usrfullname AS ClientFeeEarner
  , @tempDesc AS ClientPrimaryBusinessType 
```

此外，您的存储过程允许 SQL 注入：

```
SET @SQL = 
  'SELECT clnt_cat_desc 
     FROM ' + QUOTENAME(@SERVERNAME) + '.' + QUOTENAME(@DBASE) + '.dbo.hbl_clnt_cat
    WHERE inactive = ''N''
      AND clnt_cat_code = @CODE'

EXECUTE sp_executeSQL @SQL, N'@CODE CHAR(5)', @CODE 
```

（更新：修复了 SQL 注入问题。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-19T14:11:11.867

Pheww，我对如何做到这一点感到很疯狂，我需要从当前查询的存储过程部分生成结果，而我做这件事最困难。我所做的是用函数包装过程，然后返回值，就是这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T09:38:10.280

您可以创建返回表的函数（而不是过程）。

```
CREATE FUNCTION [dbo].[my_function]
(
   @par2     UNIQUEIDENTIFIER, 
   @par2     UNIQUEIDENTIFIER,
   @par3     UNIQUEIDENTIFIER
)
RETURNS @returntable TABLE 
(
   col1 UNIQUEIDENTIFIER,
   col2 NVARCHAR(50),
   col3 NVARCHAR(50)
)
AS
BEGIN
...
END 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T09:47:33.817

如果您不想触及您的 PROCEDURE，您可以创建一个包装它的 FUNCTION 并在查询中使用该包装器函数。

# java - 在 Java 中解析 INI 文件的最简单方法是什么？

> ID：190629
> 
> 赞同：108
> 
> 时间：2008-10-10T09:20:55.820
> 
> 标签：java, parsing, ini

我正在为 Java 中的遗留应用程序编写一个替代品。要求之一是旧应用程序使用的 ini 文件必须按原样读取到新的 Java 应用程序中。这个ini文件的格式是常见的windows风格，有标题部分和key=value对，使用#作为注释字符。

我尝试使用 Java 中的 Properties 类，但是如果不同的标头之间存在名称冲突，那当然是行不通的。

所以问题是，读取这个 INI 文件并访问密钥的最简单方法是什么？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2008-10-10T09:22:12.433

我使用的库是[ini4j](http://ini4j.sourceforge.net/)。它是轻量级的，可以轻松解析 ini 文件。此外，它不使用对 10,000 个其他 jar 文件的深奥依赖，因为设计目标之一是仅使用标准 Java API

这是有关如何使用该库的示例：

```
Ini ini = new Ini(new File(filename));
java.util.prefs.Preferences prefs = new IniPreferences(ini);
System.out.println("grumpy/homePage: " + prefs.node("grumpy").get("homePage", null)); 
```

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2011-01-31T14:17:02.020

如前所述，[ini4j](https://stackoverflow.com/a/190633)可用于实现此目的[。](http://ini4j.sourceforge.net/index.html)让我再举一个例子。

如果我们有这样的 INI 文件：

```
[header]
key = value 
```

以下应显示`value`到 STDOUT：

```
Ini ini = new Ini(new File("/path/to/file"));
System.out.println(ini.get("header", "key")); 
```

查看[教程](http://ini4j.sourceforge.net/tutorial/)以获取更多示例。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-03-26T13:34:21.747

简单到 80 行：

```
package windows.prefs;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class IniFile {

   private Pattern  _section  = Pattern.compile( "\\s*\\[([^]]*)\\]\\s*" );
   private Pattern  _keyValue = Pattern.compile( "\\s*([^=]*)=(.*)" );
   private Map< String,
      Map< String,
         String >>  _entries  = new HashMap<>();

   public IniFile( String path ) throws IOException {
      load( path );
   }

   public void load( String path ) throws IOException {
      try( BufferedReader br = new BufferedReader( new FileReader( path ))) {
         String line;
         String section = null;
         while(( line = br.readLine()) != null ) {
            Matcher m = _section.matcher( line );
            if( m.matches()) {
               section = m.group( 1 ).trim();
            }
            else if( section != null ) {
               m = _keyValue.matcher( line );
               if( m.matches()) {
                  String key   = m.group( 1 ).trim();
                  String value = m.group( 2 ).trim();
                  Map< String, String > kv = _entries.get( section );
                  if( kv == null ) {
                     _entries.put( section, kv = new HashMap<>());   
                  }
                  kv.put( key, value );
               }
            }
         }
      }
   }

   public String getString( String section, String key, String defaultvalue ) {
      Map< String, String > kv = _entries.get( section );
      if( kv == null ) {
         return defaultvalue;
      }
      return kv.get( key );
   }

   public int getInt( String section, String key, int defaultvalue ) {
      Map< String, String > kv = _entries.get( section );
      if( kv == null ) {
         return defaultvalue;
      }
      return Integer.parseInt( kv.get( key ));
   }

   public float getFloat( String section, String key, float defaultvalue ) {
      Map< String, String > kv = _entries.get( section );
      if( kv == null ) {
         return defaultvalue;
      }
      return Float.parseFloat( kv.get( key ));
   }

   public double getDouble( String section, String key, double defaultvalue ) {
      Map< String, String > kv = _entries.get( section );
      if( kv == null ) {
         return defaultvalue;
      }
      return Double.parseDouble( kv.get( key ));
   }
} 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-01-28T07:57:43.150

这是一个简单但功能强大的示例，使用 apache 类[HierarchicalINIConfiguration](http://commons.apache.org/proper/commons-configuration/javadocs/v1.10/apidocs/index.html?org/apache/commons/configuration/HierarchicalINIConfiguration.html)：

```
HierarchicalINIConfiguration iniConfObj = new HierarchicalINIConfiguration(iniFile); 

// Get Section names in ini file     
Set setOfSections = iniConfObj.getSections();
Iterator sectionNames = setOfSections.iterator();

while(sectionNames.hasNext()){

 String sectionName = sectionNames.next().toString();

 SubnodeConfiguration sObj = iniObj.getSection(sectionName);
 Iterator it1 =   sObj.getKeys();

    while (it1.hasNext()) {
    // Get element
    Object key = it1.next();
    System.out.print("Key " + key.toString() +  " Value " +  
                     sObj.getString(key.toString()) + "\n");
} 
```

Commons Configuration 有许多[运行时依赖](http://commons.apache.org/configuration/dependencies.html)项。至少需要[commons-lang](http://commons.apache.org/lang/)和[commons-logging](http://commons.apache.org/logging/)。根据您使用它的目的，您可能需要其他库（有关详细信息，请参阅上一个链接）。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-10-13T08:41:40.253

或者使用标准 Java API，您可以使用[java.util.Properties](http://docs.oracle.com/javase/6/docs/api/java/util/Properties.html)：

```
Properties props = new Properties();
try (FileInputStream in = new FileInputStream(path)) {
    props.load(in);
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2016-12-11T08:59:52.607

在 18 行中，将`java.util.Properties`to parse 扩展为多个部分：

```
public static Map<String, Properties> parseINI(Reader reader) throws IOException {
    Map<String, Properties> result = new HashMap();
    new Properties() {

        private Properties section;

        @Override
        public Object put(Object key, Object value) {
            String header = (((String) key) + " " + value).trim();
            if (header.startsWith("[") && header.endsWith("]"))
                return result.put(header.substring(1, header.length() - 1), 
                        section = new Properties());
            else
                return section.put(key, value);
        }

    }.load(reader);
    return result;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-10T23:05:09.140

另一种选择是[Apache Commons Config](http://commons.apache.org/configuration/)也有一个用于从[INI 文件](http://commons.apache.org/configuration/apidocs/org/apache/commons/configuration/INIConfiguration.html)加载的类。它确实有一些[运行时依赖](http://commons.apache.org/configuration/dependencies.html)项，但对于 INI 文件，它应该只需要 Commons 集合、语言和日志记录。

我在项目中使用了 Commons Config 及其属性和 XML 配置。它非常易于使用并支持一些非常强大的功能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-01-08T10:35:02.010

你可以试试 JINIFile。是来自 Delphi 的 TINiFile 的翻译，但对于 java

[https://github.com/SubZane/JNiFile](https://github.com/SubZane/JIniFile)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-09-19T14:43:42.690

我个人更喜欢[孔子](http://github.com/ivanTrendafilov/Confucius)。

很好，因为它不需要任何外部依赖，它很小——只有 16K，并且在初始化时自动加载你的 ini 文件。例如

```
Configurable config = Configuration.getInstance();  
String host = config.getStringValue("host");   
int port = config.getIntValue("port"); 
new Connection(host, port); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-14T04:37:22.887

**hoat4**的解决方案非常优雅和简单。它适用于所有*健全*的ini 文件。但是，我看到很多在*key*中有未转义的空格字符。
为了解决这个问题，我下载并修改了`java.util.Properties`. 虽然这有点不正统，而且是短期的，但实际的模组只有几行而且非常简单。我将向 JDK 社区提出一项提案以包含这些更改。

通过添加一个内部类变量：

```
private boolean _spaceCharOn = false; 
```

我控制与扫描键/值分离点相关的处理。我用一个小的私有方法替换了空格字符搜索代码，该方法根据上述变量的状态返回一个布尔值。

```
private boolean isSpaceSeparator(char c) {
    if (_spaceCharOn) {
        return (c == ' ' || c == '\t' || c == '\f');
    } else {
        return (c == '\t' || c == '\f');
    }
} 
```

此方法在私有方法中的两个地方使用`load0(...)`。
还有一个公共方法可以打开它，但`Properties`如果空格分隔符对您的应用程序没有问题，最好使用原始版本。

如果有兴趣，我愿意将代码发布到我的`IniFile.java`文件中。它适用于任一版本的`Properties`.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-07-19T21:39:33.827

使用@Aerospace 的回答，我意识到 INI 文件包含没有任何键值的部分是合法的。在这种情况下，应该在找到任何键值之前添加顶级映射，例如（Java 8 的最低更新）：

```
 Path location = ...;
            try (BufferedReader br = new BufferedReader(new FileReader(location.toFile()))) {
                String line;
                String section = null;
                while ((line = br.readLine()) != null) {
                    Matcher m = this.section.matcher(line);
                    if (m.matches()) {
                        section = m.group(1).trim();
                        entries.computeIfAbsent(section, k -> new HashMap<>());
                    } else if (section != null) {
                        m = keyValue.matcher(line);
                        if (m.matches()) {
                            String key = m.group(1).trim();
                            String value = m.group(2).trim();
                            entries.get(section).put(key, value);
                        }
                    }
                }
            } catch (IOException ex) {
                System.err.println("Failed to read and parse INI file '" + location + "', " + ex.getMessage());
                ex.printStackTrace(System.err);
            } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-07-02T03:39:14.210

您可以使用[ini4j](http://ini4j.sourceforge.net/index.html)将 INI 转换为 Properties

```
 Properties properties = new Properties();
    Ini ini = new Ini(new File("path/to/file"));
    ini.forEach((header, map) -> {
      map.forEach((subKey, value) -> {
        StringBuilder key = new StringBuilder(header);
        key.append("." + subKey);
        properties.put(key.toString(), value);
      });
    }); 
```

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2019-02-12T11:30:57.077

就是这么简单......

```
//import java.io.FileInputStream;
//import java.io.FileInputStream;

Properties prop = new Properties();
//c:\\myapp\\config.ini is the location of the ini file
//ini file should look like host=localhost
prop.load(new FileInputStream("c:\\myapp\\config.ini"));
String host = prop.getProperty("host"); 
```

# javascript - 使用 Javascript 隐藏/禁用 TitleBar Mozilla FireFox

> ID：190641
> 
> 赞同：1
> 
> 时间：2008-10-10T09:34:15.607
> 
> 标签：javascript

如何禁用 FireFox 浏览器的最小化按钮或如何隐藏 FireFox 浏览器的标题栏。我正在使用 Window.Open 使用 javascript 在全屏模式下打开窗口

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T09:55:38.137

恐怕这是不可能的，这是正确的。如果网页尝试禁用浏览器的最小化按钮，我会非常恼火。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T10:25:18.890

实际上，似乎可以指定这些功能。摘自[window.open 参考](http://javascript.about.com/library/blpopup10.htm)：

*   **dialog**可以设置为 yes 或 no 以指示最大化和最小化按钮是否仅在 Firefox、Mozilla 和 Netscape 的标题栏中显示。
*   **minimizable**可以设置为 yes 或 no 以指示当 dialog=yes 仅在 Firefox、Mozilla 和 Netscape 中时是否在标题栏中显示最小化按钮。所以，只需使用这样的代码：

    var newWin = window.open(' [http://www.google.com/','google','dialog=yes,minimizable=no](http://www.google.com/) ');

不管怎样，不要过度使用这个特性——它的设计明确地考虑了对话框。IMO，将它与全屏结合起来有点脏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-22T17:22:08.423

试试这个 [http://www.ghacks.net/2008/11/19/setup-firefox-to-use-minimal-screen-estate/](http://www.ghacks.net/2008/11/19/setup-firefox-to-use-minimal-screen-estate/) 它会帮助你隐藏标题栏

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T05:36:43.423

尝试实验性附加组件“隐藏标题”

# php - PHP脚本崩溃IE6

> ID：190642
> 
> 赞同：0
> 
> 时间：2008-10-10T09:34:48.570
> 
> 标签：php, html, internet-explorer-6

下面的代码由于某种原因导致 IE6 崩溃。尽管 IE 很糟糕，但我以前从未见过这种情况。有没有人有任何想法？

```
<div id="edit">
<?php 

$a = $_POST['category'];
if ($a == "")
{
    $a = $_GET['category'];
}

$result = mysql_query("SELECT * FROM media WHERE related_page_id = $a && type= 'copy'");

?>

<table width="460px;">
    <tr>
        <td>Item</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Associated Images</td>
    </tr>
    <tr>
        <td colspan="5">&nbsp;</td>
    </tr>
<?php
while($row = mysql_fetch_array($result))
{
    echo "<tr style='vertical-align:top'><td>$row[title]</td>";
    echo "<td><a href='addimage.php?id=$row[id]&&category=$a'>Add image/file</a>";
    echo "<td><a href='change.php?id=$row[id]&&category=$a'>edit</a></td>";
    echo "<td><a href='delete.php?id=$row[id]&&category=$a'>delete</a></td>";
    echo "<td>";

    $id = $row['id'];
    $result1 = mysql_query("SELECT * FROM media WHERE assets = $id");
    while($row1 = mysql_fetch_array($result1))
    {
        echo "<a href='$row1[path]'>$row1[title]</a> | <a href='delete.php?id=$row1[id]&&category=$a'>remove?</a><br />";
    }
    echo "</td></tr>";
}
if($a == 1 || $a == 3 || $a == 5){
}else{
    echo "<tr><td colspan='5'>&nbsp;</td></tr>";
    echo "<tr><td colspan='5'><a href='change.php?id=0&&category=$a'>New Item</a></td></tr>";
}

?>
</div>
</div>
</div>
</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T09:47:01.477

我不知道这是否是崩溃的原因，但该`td`行中的标签

```
echo "<td><a href='addimage.php?id=$row[id]&&category=$a'>Add image/file</a>"; 
```

没有关闭。还：

```
</div>
</div>
</div>
</table> 
```

应该：

```
</table>
</div>
</div>
</div> 
```

此外 - 出于安全原因 -`$a`在下面的查询中使用它之前检查是否为数字。

```
$a = $_POST['category'];
if ($a == "")
{
        $a = $_GET['category'];
}

$result = mysql_query("SELECT * FROM media WHERE related_page_id = $a && type= 'copy'"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T09:44:34.913

生成的代码不会让我崩溃 IE6。它可能是您的样式表或 javascript 之一，也可能只是我的设置（IE6 在这里用作独立浏览器）。

另外，为什么你有那些双＆符号？您确定不想`&amp;`改用吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T09:46:54.380

这是生成的代码：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

        <script type="text/javascript" src="../javascript/tiny_mce/tiny_mce.js"></script>
    <script type="text/javascript">
        tinyMCE.init({
            mode : "textareas",
            theme : "advanced"
        });
    </script>

    <title>Chapman Corp Site - CMS</title>
    <link rel="stylesheet" href="../css/admin.css" type="text/css" media="screen" title="Chapman" charset="utf-8" />
        <!--[if lte IE 6]> 
<link rel="stylesheet" href="../css/ie6.css" type="text/css" media="screen" />
<script type="text/javascript" src="../javascript/unitpngfix.js"></script>
<![endif]-->

</head>
<body>
<div id="page">
<div id ="content">
<p><a href="index.php">Home</a></p><div id="edit">

<table width="460px;">
    <tr>
        <td>Item</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>

        <td>&nbsp;</td>
        <td>Associated Images</td>
    </tr>
    <tr>
        <td colspan="5">&nbsp;</td>
    </tr>
<tr style='vertical-align:top'><td>Home</td><td><a href='addimage.php?id=77&&category=1'>Add image/file</a><td><a href='change.php?id=77&&category=1'>edit</a></td><td><a href='delete.php?id=77&&category=1'>delete</a></td><td><a href='../uploads/footer.jpg'>footer.jpg</a> | <a href='delete.php?id=88&&category=1'>remove?</a><br /></td></tr></div>

</div>
</div>
</table>
</body>
</html> 
```

# sql-server - 有没有人使用（或考虑使用）Sql Server Compact Edition？

> ID：190643
> 
> 赞同：7
> 
> 时间：2008-10-10T09:35:33.000
> 
> 标签：sql-server, database, windows-mobile, sql-server-ce

我一直在准备发表关于 SQL Server Compact Edition 3.5（SP1 - 最近发布）的演示文稿，我想知道是否有人设计（或打算设计）一个带有 SQL Server CE 3.5（或更早版本）的系统？

特别是，有没有人想过（或经历过）使用 SQLCE 作为离线数据存储（作为连接系统设计的一部分）的解决方案？

与之前的版本相比，3.5 版看起来功能非常丰富，是否已准备好认真考虑（现在它支持 LINQ to SQL、标识列和各种重要的 T-SQL）？

如果您需要基于文件的轻量级、低占用空间的数据库（尤其是需要移动设备和桌面系统支持时），您会考虑使用它，还是有更好的选择？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T10:47:47.923

在工作中，我们最近不得不将一个专为 SQL Server Express 设计的项目迁移到 SQLCE。起初我认为这会很糟糕，主要是因为没有存储过程。但是，一旦我们开始深入研究它并看到它提供的功能，我们就确信这是正确的举动。它支持 LINQ，查询大量数据比我们想象的要快得多。插入和更新有点慢，但真的一点也不差。我们真正遇到的唯一问题是 A) Management Studio 2005 不支持它，虽然 2008 支持它，但它非常有限。不知道为什么，希望他们会在未来的版本中改变它，但它让我大吃一惊。B) 当试图将现有的 SQL Server 数据库迁移到 SQLCE 时，真的没有简单的方法可以从现有的数据库中创建模式，并移动所有数据。您可能必须推出自己的工具才能做到这一点（我们必须这样做）。

尽管如此，最终的结果还是很惊人的。由于用户不必安装 SQL Express，安装时间减少到三分之一，并且应用程序在内存较少的机器上运行更加流畅。总而言之，我对它的实际效果感到惊讶。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-10T09:42:24.060

我尝试了几个版本的 SQLCE，最后总是使用出色的 ADO.NET [SQLite 实现](http://sqlite.phxsoftware.com/)——它更轻、更快、更容易使用（至少对我来说是这样），而且它几乎可以跨所有平台进行移植。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T10:45:14.760

我目前在业务应用程序中将 SQL CE 与 NHibernate 一起使用，其中 SQL CE 数据库通过 WCF 与 Sync Framework 同步到 SQL 2008 服务器。奇迹般有效！特别是从 nhibernate 映射文件生成数据库真是太棒了。

但即使使用 linq2sql 也能正常工作！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T10:15:57.893

多次尝试 SQLCE。总是最终使用其他东西（Firebird（嵌入式）、SQLite、VistaDB）。IMO SQLCE 被限制在或多或少复杂的场景中有用。虽然我对最新版本（3.5）没有实际经验，但我怀疑它仍然很烂:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T10:40:10.683

我帮助开发和维护了一个使用 SQL Server CE 2.0 的 PDA 软件。我认为只要您知道限制在哪里就可以了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T10:45:26.710

我曾经使用过一次 SQLCE，作为我在工作面试中收到的练习，这已经足够了。现在，每当我需要这样的功能时，我都会使用 sqlite 或 firebird。

SQLCE 在该练习中的可用性非常好。它速度快，具有良好的可视化编辑器，并且很好地集成到 Visual Studio 中。

底线：如果您可以处理 SQLCE 的限制，并且您确信您不需要更多 - 使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T22:10:52.643

如果在移动设备上使用，则不能使用 Linq to SQL。

我们使用它，它很好，但是 Linq to Dataset 不如 Linq to SQL 好

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-18T22:56:35.070

一年或两年前，我们在一个项目中使用了 SQLCE（我相信是 3.0 版）。
我遇到的问题是它需要安装，不是 XCOpy 可部署的。表演也很糟糕。我们每秒进行大约 20 次插入，这可能超出了它的能力范围，但它肯定无法处理它。性能和部署问题让我相信还有更好的选择。我的下一个项目将使用 SQLite 或 VistaDB。

我在 Mac 上使用过 SQLite，在开发中使用过 iPhone，它在这两个平台上都表现得非常好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-22T05:17:18.913

如果将 SQLCE 3.5 SP1 与实体框架一起使用，则会出现问题。基本上在将一些参数传递给查询时会出现问题。解决方法是卸载 SQLCE 并安装作为修补程序发布的另一个版本。问题在于尝试将 SQLCE 包含在安装项目中时。有关该主题的更多信息，请参阅此主题：[http ://social.msdn.microsoft.com/Forums/en-US/sqlce/thread/b6bac277-cf66-4c74-a0b3-e48abedbd161](http://social.msdn.microsoft.com/Forums/en-US/sqlce/thread/b6bac277-cf66-4c74-a0b3-e48abedbd161)

另一个奇怪的问题是带有实体框架的 SQLCE 3.5 SP1 将无法在 64 位系统上运行，除非您将其构建为针对 x86（[http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/aa5850bb- 34fe-4064-82b0-4a7cac675c91/](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/aa5850bb-34fe-4064-82b0-4a7cac675c91/) )

# java - 我应该如何配置 Jetty 7 pre3 以使用 oracle JDBC 源？

> ID：190644
> 
> 赞同：1
> 
> 时间：2008-10-10T09:35:46.260
> 
> 标签：java, xml, jdbc, jetty, jndi

所有东西都在 Windows XP Pro SP2/32 位下运行。

我已经从 http://dist.codehaus.org/jetty/jetty-7.0.0-prereleases/jetty-7.0.0pre3/jetty-assembly-7.0.0pre3.zip>dist.codehaus.org 下载了 Jetty 7 pre3。
我已将码头提取到`C:\jetty-7.0.0pre3\`（所以我有 C:\jetty-7.0.0pre3\bin\ 和其他目录）
我已将我的 webapp 放入`C:\jetty-7.0.0pre3\webapps\`

我的 web.xml 中有资源引用：

```
<resource-ref>
  <description>dev datasource</description>
  <res-ref-name>jdbc/dev</res-ref-name>
  <res-type>javax.sql.DataSource</res-type>
  <res-auth>Container</res-auth>
</resource-ref> 
```

并在 jetty.xml 中进行了配置：

```
<Array id="plusConfig" type="java.lang.String">
  <Item>org.mortbay.jetty.webapp.WebInfConfiguration</Item>
  <Item>org.mortbay.jetty.plus.webapp.EnvConfiguration</Item>
  <Item>org.mortbay.jetty.plus.webapp.Configuration</Item>
  <Item>org.mortbay.jetty.webapp.JettyWebXmlConfiguration</Item>
  <Item>org.mortbay.jetty.webapp.TagLibConfiguration</Item>
</Array>

<New id="dev" class="org.mortbay.jetty.plus.naming.Resource">
  <Arg>jdbc/dev</Arg>
  <Arg>
    <New class="oracle.jdbc.pool.OracleConnectionPoolDataSource">
      <Set name="User">username</Set>
      <Set name="URL">jdbc:oracle:thin:@10.201.201.64:1521:DEV</Set>
      <Set name="Password">password</Set>
    </New>
  </Arg>
</New>

<Call name="addLifeCycle">
  <Arg>
    <New class="org.mortbay.jetty.deployer.WebAppDeployer">
      <Set name="contexts"><Ref id="Contexts"/></Set>
      <Set name="webAppDir"><SystemProperty name="jetty.home" default="."/>/webapps</Set>
      <Set name="parentLoaderPriority">false</Set>
         <Set name="extract">true</Set>
         <Set name="allowDuplicates">false</Set>
      <Set name="defaultsDescriptor"><SystemProperty name="jetty.home" default="."/>/etc/webdefault.xml</Set>
      <Set name="ConfigurationClasses"><Ref id="plusConfig"/></Set>
    </New>
  </Arg>
</Call> 
```

我正在运行`java -DOPTION=plus -jar start.jar`，`C:\jetty-7.0.0pre3\`我收到以下错误：

```
2008-10-14 12:12:49.163::INFO:  Logging to STDERR via org.mortbay.log.StdErrLog
2008-10-14 12:12:49.413::WARN:  Config error at <New id="dev" class="org.mortbay.jetty.plus.naming.Resource"><Arg>jdbc/dev</Arg><Arg>
    <New class="oracle.jdbc.pool.OracleConnectionPoolDataSource"><Set name="User">username</Set><Set name="URL">jdbc:oracle:thin:@10.201.201.64:1521:DEV</Set><Set name="Password">password</Set></New>
  </Arg></New>
2008-10-14 12:12:49.413::WARN:  EXCEPTION
java.lang.ClassNotFoundException: org.mortbay.jetty.plus.naming.Resource
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at org.mortbay.util.Loader.loadClass(Loader.java:91)
        at org.mortbay.xml.XmlConfiguration.nodeClass(XmlConfiguration.java:224)
        at org.mortbay.xml.XmlConfiguration.newObj(XmlConfiguration.java:572)
        at org.mortbay.xml.XmlConfiguration.configure(XmlConfiguration.java:256)
        at org.mortbay.xml.XmlConfiguration.configure(XmlConfiguration.java:214)
        at org.mortbay.xml.XmlConfiguration.main(XmlConfiguration.java:971)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.mortbay.start.Main.invokeMain(Main.java:218)
        at org.mortbay.start.Main.start(Main.java:564)
        at org.mortbay.start.Main.main(Main.java:136) 
```

`C:\jetty-7.0.0pre3\lib\plus\jetty-plus-7.0.0pre3.jar`在类路径上。在同一个控制台中：

```
C:\jetty-7.0.0pre3>set classpath
CLASSPATH=C:\Program Files\IBM\WebSphere MQ\Java\lib\providerutil.jar;C:\Program
 Files\IBM\WebSphere MQ\Java\lib\com.ibm.mqjms.jar;C:\Program Files\IBM\WebSpher
e MQ\Java\lib\ldap.jar;C:\Program Files\IBM\WebSphere MQ\Java\lib\jta.jar;C:\Pro
gram Files\IBM\WebSphere MQ\Java\lib\jndi.jar;C:\Program Files\IBM\WebSphere MQ\
Java\lib\jms.jar;C:\Program Files\IBM\WebSphere MQ\Java\lib\connector.jar;C:\Pro
gram Files\IBM\WebSphere MQ\Java\lib\fscontext.jar;C:\Program Files\IBM\WebSpher
e MQ\Java\lib\com.ibm.mq.jar;.;c:\Program Files\Java\jdk1.5.0_05\classes;C:\Prog
ram Files\Java\jre1.5.0_05\lib\ext\QTJava.zip;C:\Program Files\Java\jre1.5.0_05\
lib\spring.jar;c:\jetty-7.0.0pre3\lib\plus\jetty-plus-7.0.0pre3.jar 
```

怎么了？我应该如何添加`org.mortbay.jetty.plus.naming.Resource`到 start.jar 的可见性区域？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T10:50:18.840

The problem is that addLifeCycle does not take a `Resource` object; it takes `LifeCycle` implementations such as `WebAppContext`s or `WebAppDeployer`s.

Assuming you have a WebAppDeployer (or equivalent) set up in your jetty.xml, try this:

```
<Array id="plusConfig" type="java.lang.String">
  <Item>org.mortbay.jetty.webapp.WebInfConfiguration</Item>
  <Item>org.mortbay.jetty.plus.webapp.EnvConfiguration</Item>
  <Item>org.mortbay.jetty.plus.webapp.Configuration</Item>
  <Item>org.mortbay.jetty.webapp.JettyWebXmlConfiguration</Item>
  <Item>org.mortbay.jetty.webapp.TagLibConfiguration</Item>
</Array>

<Call name="addLifeCycle">
  <Arg>
    <New class="org.mortbay.jetty.deployer.WebAppDeployer">
      ....
      <Set name="ConfigurationClasses"><Ref id="plusConfig"/></Set>
      ....
    </New>
  </Arg>
</Call>

<New id="dev" class="org.mortbay.jetty.plus.naming.Resource">
  <Arg>jdbc/dev</Arg>
  <Arg>
    <New class="oracle.jdbc.pool.OracleConnectionPoolDataSource">
      <Set name="User">username</Set>
      <Set name="URL">jdbc:oracle:thin:@10.201.201.64:1521:DEV</Set>
      <Set name="Password">password</Set>
    </New>
  </Arg>
</New> 
```

If you want the datasource only for a particular webapp, then do a similar configuration within a jetty-env.xml file for that webapp.

Also, since you're using Jetty 7, you will need to load the (optional) `plus` libraries (if the exe isn't doing that for you already). You'll know they aren't being loaded, because you'll get a ClassNotFoundException on startup.

Starting up Jetty on Linux, I would do it like so:

```
java -DOPTIONS=plus -jar start.jar 
```

However, I am not familiar with Windows. Possibly

```
Jetty-Service.exe -DOPTIONS=plus 
```

would work? If not, then look for something which would set the system property "OPTIONS" to "plus" when you run jetty.

# api - 有没有人设法使用 LinkedIn API 构建任何应用程序？

> ID：190647
> 
> 赞同：18
> 
> 时间：2008-10-10T09:37:51.027
> 
> 标签：api, linkedin

LinkedIn 对使用其 API 的应用程序非常谨慎。我已经尝试过但未能访问它们。

有没有人真的用它们构建了任何真正的应用程序？如果是，您采用什么策略来访问他们的 API？

顺便说一句，我说的是LinkedIn之上的一流增值应用程序，而不仅仅是嵌入超链接。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-08T19:29:32.393

LinkedIn API 现已公开。

在此处获取访问权限：http: [//developer.linkedin.com](http://developer.linkedin.com)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-25T11:59:21.227

我们有。我们的社交招聘初创公司[matchFWD](http://matchfwd.com)应该会在接下来的几周内公开发布，我们会广泛使用 LinkedIn API。

我们为 API 分叉了一个 python 包装器，使其易于使用：[https ://github.com/PhilGo20/LinkedIn-Client-Library](https://github.com/PhilGo20/LinkedIn-Client-Library)

API 文档在字段选择上有点偏离，但他们在开发者论坛上的支持团队非常好。

总的来说，围绕他们的 API 进行开发非常容易，它为我们的产品带来了很多价值，这是肯定的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T18:44:29.133

我个人没有，但我知道这是可能的。在 Bobby Jack 提供的 LinkedIn 博客链接之后，他们提到（2008 年 7 月 25 日条目）[Xobni](http://www.xobni.com/)已与 LinkedIn 集成。

作为一个长期的 Xobni 用户，我可以说它确实与 LinkedIn 集成并且做得很好，所以是的，这是可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T17:31:40.927

我想知道同样的事情。我试图访问我网站的简历部分，该部分将被 LinkedIn 所谓的“开放”API 驱动。但我从来没有收到他们的任何回音。不酷。显然他们需要批准您对 API 的使用。我认为当他们决定提出这样的要求时，需要向他们阅读“开放”一词的定义！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-21T21:29:20.167

这是linkedin论坛上的一个例子，它开箱即用：http: [//developer.linkedin.com/message/2185](http://developer.linkedin.com/message/2185)使用[oauth库](http://oauth.googlecode.com/svn/code/csharp/OAuthBase.cs)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-11T21:55:50.213

您可以使用[Embedly](http://embed.ly)从 Linkedin 中提取一些数据。

# c# - LINQ to SQL 和并发问题

> ID：190666
> 
> 赞同：7
> 
> 时间：2008-10-10T09:52:46.770
> 
> 标签：c#, linq, linq-to-sql, concurrency, transactions

我们正在尝试建立一个大批量订单记录系统。有三个主表： 1\. Orders 2\. OrderDetails 3\. OrderShipment

Shipment 表包含每个订单的 n 条记录，并且在客户接受订单之前可以更改任何记录的发货条目，之后订单将被冻结。（业务需求）

尽管这在现实世界的场景中可能不会发生……在我们的负载测试期间，我们得到了 System.Data.Linq.ChangeConflictException 异常。在事务中结束提交也无济于事。我们不能强制 LINQ 在整个更新操作期间锁定行吗？

有没有其他方法可以克服这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T10:07:36.053

如果您对同一数据的并发更新确实存在问题，那么您可能会考虑在事务中执行整个操作 - 即获取数据*并*提交它。只要您将获取/更新/提交视为短暂的原子操作（即您不会在中间暂停用户输入），就应该没问题。

特别是，使用可序列化的隔离级别，没有人可以更新您有读锁的数据（即您查询的任何内容）。唯一的问题是，如果不同的查询以不同的顺序读取数据，这可能会导致死锁情况。AFAIK，没有办法让 LINQ-to-SQL 发出（UPDLOCK）提示，这是一种耻辱。

TransactionScope 或 SqlTransaction 都可以，只要将它们设置为可序列化隔离（这是 TransactionScope 的默认设置）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T10:08:00.733

您可能想查看将所有内容作为事务执行的[实体框架。](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)这里有两个关于 Entity Framework 的播客也很有趣。

DNRTV -[一部分 1](http://www.dnrtv.com/default.aspx?showNum=117) - [一部分 2](http://www.dnrtv.com/default.aspx?showNum=118)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T06:36:32.893

对于这种情况，即多个用户可能想要对同一记录/客户/订单/任何内容进行更改，最好在应用程序逻辑中构建“锁定”而不是使用数据库锁定。

使用 DB 锁来解决数据的逻辑锁定会给您带来一堆新问题。更好的解决方案是有列和/或表，您可以在其中指示订单/客户/等正在[由用户]编辑，直到它被锁定等。查询该表（或列）以检查客户是否/order/thing 在允许其他用户编辑之前可用于编辑。

请参阅： [http ://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3984968&SiteID=1](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3984968&SiteID=1)

# mfc - 只需要 CListCtrl 控件中的某些行具有复选框

> ID：190667
> 
> 赞同：2
> 
> 时间：2008-10-10T09:53:04.647
> 
> 标签：mfc

我正在使用 CListCtrl 控件在我的 MFC 应用程序中显示信息。目前，我在 SetExtendedStyle 中设置了 LVS_EX_CHECKBOXES，因此控件中的所有行旁边都有一个复选框。然而，我想要的是控件中只有一些行有复选框。这可能吗 ？如果是怎么做的？

谢谢

伊恩

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T10:23:04.540

对于每个不应该有复选框的项目：

```
LVITEM lvi;
lvi.stateMask = LVIS_STATEIMAGEMASK;
lvi.state = INDEXTOSTATEIMAGEMASK(0);
::SendMessage(m_hWnd, LVM_SETITEMSTATE, nItem, (LPARAM)&lvi); 
```

要“创建”项目的复选框：

```
SetCheck(Item, true/false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T10:03:05.300

是的。您需要做的是创建复选框的位图并将其包含在回调中。您的位图之一将是空白的。

或者，您可以进行一些所有者绘图并调用 DrawFrameControl 函数。

您还可以添加代码来测试鼠标点击并做出相应的响应。

# python - 使用 Python (GAE) 读取图像的颜色

> ID：190675
> 
> 赞同：1
> 
> 时间：2008-10-10T09:56:47.090
> 
> 标签：python, google-app-engine, image, analysis

如何使用谷歌应用引擎使用 python 读取图像的颜色？

**示例：**我喜欢构建一个函数来确定图像中最引人注目的颜色，从而为其设置谐波背景颜色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T11:02:47.113

[图片 API](http://code.google.com/appengine/docs/images/overview.html) （当前）不包含像素级函数。引用概述文件：

> 注意：为了在本地环境中使用图像 API，您必须首先下载并安装 Python 图像库 PIL。PIL 在 App Engine 上不可用；它仅用作本地环境中图像 API 的存根。App Engine 上仅提供图像 API 中提供的转换。

一段时间以来，社区一直在寻求[PIL](http://www.pythonware.com/products/pil/index.htm)的全面支持，但看起来我们必须等待。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T00:08:08.623

对于 PNG，您可以使用[PyPNG 模块](http://packages.python.org/pypng/)- 轻量级的纯 Python PNG 解码器/编码器。

```
import png

point = (10, 20) # coordinates of pixel to read

reader = png.Reader(filename='image.png') # streams are also accepted
w, h, pixels, metadata = reader.read()
pixel_byte_width = 4 if metadata['has_alpha'] else 3
pixel_position = point[0] + point[1] * w
print pixels[
  pixel_position * pixel_byte_width :
  (pixel_position + 1) * pixel_byte_width] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T11:55:46.730

如果您愿意将 Flash 或 Java 小程序放在页面上，您也许可以在客户端上完成。我不确定画布或 SVG 之类的东西是否支持像素级操作，但如果它们支持，您也许可以让它在某些带有 JavaScript 的浏览器中工作。

Flash 或 Java Applet 可以是不可见的和可选的——您可以使用 JavaScript 来检测用户是否拥有该插件，并且只有在他们拥有该插件时才支持此功能。

# c++ - 循环展开何时有效？

> ID：190681
> 
> 赞同：12
> 
> 时间：2008-10-10T09:59:55.710
> 
> 标签：c++, performance, algorithm, optimization

[循环展开](http://en.wikipedia.org/wiki/Loop_unwinding)是帮助编译器优化性能的常用方法。我想知道性能增益是否以及在多大程度上受循环主体中的内容的影响：

1.  语句数
2.  函数调用次数
3.  使用复杂的数据类型、虚拟方法等。
4.  动态（解除）内存分配

您使用什么规则（经验法则？）来决定是否展开性能关键循环？在这些情况下，您还考虑了哪些其他优化？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-10T10:10:41.883

一般来说，手动展开循环是不值得的。编译器更清楚目标架构是如何工作的，如果它是有益的，它将展开循环。

有些代码路径在为 Pentium-M 类型 CPU 展开时会受益，但对 Core2 没有好处。如果我手动展开，编译器将无法再做出决定，我最终可能会得到不是最优的代码。例如，我试图实现的恰恰相反。

在某些情况下，我会手动展开性能关键循环，但只有在我知道编译器将在手动展开之后 - 能够使用 SSE 或 MMX 指令等体系结构特定功能时，我才会这样做。然后，只有这样我才会这样做。

顺便说一句 - 现代 CPU 在执行可预测的分支方面非常有效。这正是循环。如今，循环开销是如此之小，以至于几乎没有什么不同。然而，由于代码大小的增加而可能发生的内存延迟效应会有所不同。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-10T10:09:09.170

这是一个优化问题，因此只有一个经验法则：测试性能，并*仅*在您的测试表明您需要时尝试循环展开优化。首先考虑破坏性较小的优化。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-10T10:10:51.040

以我的经验，循环展开，它所需要的工作在以下情况下是有效的：

*   循环中只有几个语句。
*   这些语句只涉及少量不同的变量，没有函数调用
*   您的操作在已分配的内存上工作（例如就地图像转换）

对于 80% 的收益，部分展开通常是更少的工作。因此，不是循环遍历 N × M 图像的所有像素（N *M 次迭代），其中 N 总是可以被 8 整除，而是*在每个 8 个像素块上循环 (N M/8) 次。如果您正在执行一些使用某些相邻像素的操作，这将特别有效。

我在手动优化 MMX 或 SSE 指令（一次 8 或 16 个像素）中的逐像素操作方面取得了非常好的结果，但我也花了几天时间手动优化某些东西，却发现编译器优化的版本运行快十倍。

顺便说一下，对于循环展开的最（美丽|显着）示例，请查看[Duffs 设备](http://en.wikipedia.org/wiki/Duff%27s_device)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-10T10:15:09.517

需要考虑的重要一点：在工作场所的生产代码中，代码的未来可读性远远超过循环展开的好处。硬件便宜，程序员的时间不便宜。如果这是解决已证明的性能问题的唯一方法（例如在低功率设备中），我只会担心循环展开。

其他想法：编译器的特性差异很大，在某些情况下，如 Java，由 HotspotJVM 即时做出决定，因此我反对在任何情况下展开循环。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T22:14:02.970

这些优化高度依赖于执行代码的 cpu，应该由编译器完成，但如果您正在编写这样的编译器，您可能需要查看英特尔文档[Intel(R) 64 和 IA-32架构优化参考手册](http://www3.intel.com/design/processor/manuals/248966.pdf)第 3.4.1.7 节：

*   展开小循环，直到分支和归纳变量的开销（通常）占循环执行时间的 10% 以下。

*   避免过度展开循环；这可能会破坏跟踪缓存或指令缓存。

*   展开经常执行且具有可预测迭代次数的循环，以将迭代次数减少到 16 次或更少。除非它增加代码大小以致工作集不再适合跟踪或指令缓存，否则请执行此操作。如果循环体包含多个条件分支，则展开以使迭代次数为 16/(# 个条件分支)。

您也可以[在这里](http://www.intel.com/design/literature.htm)免费订购硬拷贝。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T12:36:12.733

手动展开循环在较新的处理器上可能效率低下，但它们在 GPU 和轻型架构（如 ARM）上仍然有用，因为它们在预测方面不如当前一代 CPU 处理器，而且因为测试和跳转实际上浪费了这些处理器上的周期。

也就是说，它应该只在非常紧凑的循环和块中完成，因为通过展开你会显着膨胀代码大小，这会破坏小型设备上的缓存，你最终会遇到一个非常糟糕的问题。

不过需要注意的是，展开循环应该是优化时的最后手段。它会在一定程度上扭曲您的代码，使其无法维护，并且阅读它的人可能会在以后抢购并威胁您和您的家人。知道这一点，让它值得:)

使用宏可以极大地帮助使代码更具可读性，并且可以使展开故意。

例子：

```
for(int i=0; i<256; i++)
{
    a+=(ptr + i) << 8;
    a-=(ptr + i - k) << 8;
    // And possibly some more
} 
```

可以展开到：

```
#define UNROLL (i) \
    a+=(ptr[i]) << 8; \
    a-=(ptr[i-k]) << 8;

for(int i=0; i<32; i++)
{
    UNROLL(i);
    UNROLL(i+1);
    UNROLL(i+2);
    UNROLL(i+3);
    UNROLL(i+4);
    UNROLL(i+5);
    UNROLL(i+6);
    UNROLL(i+7);
} 
```

在不相关但仍然有些相关的注释中，如果您真的想在指令计数方面获胜，请确保所有常量在您的代码中统一为尽可能少的立即数，这样您就不会得到以下程序集：

```
// Bad
MOV r1, 4
//  ...
ADD r2, r2, 1
//  ...
ADD r2, r2, 4 
```

代替：

```
// Better
ADD r2, r2, 8 
```

通常，严肃的编译器会保护您免受此类事情的影响，但并非所有人都会这样做。保留那些 '#define'、'enum' 和 'static const' 方便，并非所有编译器都会优化本地 'const' 变量。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T20:38:12.667

基本上，展开是循环结构的有用成本，是循环体的重要部分。大多数循环（以及几乎所有可以展开的循环）的结构包括（a）递增一个整数，（b）将其与另一个整数进行比较，以及（c）跳跃——其中两个是最快的CPU 指令。因此，几乎在任何循环中，身体都会超过结构的重量，从而产生微不足道的增益。如果你的身体中甚至有一个函数调用，身体就会比结构慢一个数量级——你永远不会注意到这一点。

几乎唯一可以真正从展开中受益的是 memcpy()，其中循环体只是将一个字节从一个位置移动到另一个位置 --- 这就是为什么许多 C 和 C++ 编译器自动内联和展开 memcpy 的原因过去十年。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-12T15:57:06.803

手动循环展开通常仅对最微不足道的循环有用。

作为参考，g++ 中的 C++ 标准库在整个源代码中展开了两个循环，它们实现了带和不带谓词的“查找”函数，如下所示：

```
while(first != last && !(*first == val))
  ++first; 
```

我查看了这些和其他循环，并决定只为这种微不足道的循环是值得做的。

当然，最好的答案是只展开那些你的分析器显示它有用的循环！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-04T23:17:16.847

如果你已经做了所有可能的事情，这是你剩下的热点，并且循环内几乎没有任何东西，那么展开是有意义的。这些是很多“如果”。为了验证这是否是您的最后一个选择，[试试这个](http://www.wikihow.com/Optimize-Your-Program%27s-Performance)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-05T08:18:00.047

根据我的经验，循环展开可以在我的英特尔 i7 cpu 上不使用 SEE 的情况下带来 20% 到 50% 的性能。

对于单个操作的简单循环，循环中存在一次条件跳转和一次增量的开销。每次跳转和增量执行多个操作可能是有效的。有效循环展开的示例如下代码：

在下面没有展开的代码中，有一个比较 + 一个 jumb + 每个 sum 操作一个增量的开销。此外，所有操作都必须等待先前操作的结果。

```
template<class TData,class TSum>
inline TSum SumV(const TData* pVec, int nCount)
{
   const TData* pEndOfVec = pVec + nCount;
   TSum   nAccum = 0;

   while(pVec < pEndOfVec)
   {
       nAccum += (TSum)(*pVec++);
   }
   return nAccum;
} 
```

在展开的代码中，每四次求和运算有一个比较 + 一个 jumb + 一个增量的开销。另外还有很多操作不需要等待前一次操作的结果，可以更好的被编译器优化。

```
template<class TData,class TSum>
inline TSum SumV(const TData* pVec, int nCount)
{
  const TData* pEndOfVec = pVec + nCount;
  TSum   nAccum = 0;

  int nCount4 = nCount - nCount % 4;
  const TData* pEndOfVec4 = pVec + nCount4;
  while (pVec < pEndOfVec4)
  {
      TSum val1 = (TSum)(pVec[0]);
      TSum val2 = (TSum)(pVec[1]);
      TSum val3 = (TSum)(pVec[2]);
      TSum val4 = (TSum)(pVec[3]);
      nAccum += val1 + val2 + val3 + val4;
      pVec += 4;
  }      

  while(pVec < pEndOfVec)
  {
      nAccum += (TSum)(*pVec++);
  }
  return nAccum;
} 
```

# asp.net - 如何使用进程监视器来解决 UnauthorizedAccessException

> ID：190685
> 
> 赞同：0
> 
> 时间：2008-10-10T10:03:24.690
> 
> 标签：asp.net, debugging

我正在尝试从 IIS7 下的 ASP.NET 应用程序写入日志文件，但不断收到以下异常：

```
UnauthorizedAccessException "Access to the path 'C:\Users\Brady\Exports' is denied." 
```

有人建议我使用[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)来帮助解决这个问题，但它是一个相当复杂的工具，我真的没有时间花时间去探索它。请有人帮助我并建议如何使用 PM 来确定哪个用户正在尝试访问文件夹等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T11:09:29.953

当 PM 启动时，它会显示一个过滤器对话框。只需单击“重置”即可使用标准过滤。这将生成大量消息，而您只对其中的一小部分感兴趣。在*Process Name*下，选择包含您要监控的进程的行。Richtclick 它并选择*include*。这将报告的事件限制为您的应用程序的事件。在工具栏中，最右边的三个图标可让您过滤源：注册表访问、文件系统访问和进程/线程事件。取消选择注册表和进程/线程，因为您只想监视文件访问。在菜单中选择*选项 - 选择列*。在*进程管理*下，检查*用户名*。

现在尝试重现错误。如果您仍然收到太多事件，您可以限制路径（在*Path*列中单击鼠标右键并选择*exclude*）。您可以通过单击 Ctrl-L 来微调您的过滤，界面应该是不言自明的。（哦，当您想创建新的过滤规则时，请记住在单击*确定*之前单击*添加......我几乎总是陷入那个特定的陷阱 ;-)*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T10:39:04.947

不确定为什么要使用进程监视器来解决文件系统中的访问问题。

在文件 IO 调用时，检查该目录是否允许运行应用程序的用户访问该目录。如果您正在模拟，这将是网络服务帐户。如果您正在模拟，它将是模拟用户。

# database - 维持客户账户余额的最佳方式

> ID：190687
> 
> 赞同：7
> 
> 时间：2008-10-10T10:05:07.713
> 
> 标签：database, vb.net, currency

是在数据库中有一个字段来存储客户帐户余额还是使用视图和查询来生成信息更好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-10T10:07:02.997

对于性能，我会说两者。保留所有交易的日志（在单独的表中），但在客户记录中保留一个字段，该字段存储当前余额，当您添加更多交易时会刷新该余额。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-10T10:26:26.920

我从事的一个项目我们将当前余额存储在一个字段中，并将所有交易存储在另一个表中，但由于该项目对数据完美 100%（或更好）或时间的重要性，我们也将余额的哈希值存储在另一个字段中，每次调用时都会比较哈希值以确保完整性，如果不匹配，则从交易表中重新计算，重新哈希后发送给客户支持部门。供审查。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T23:01:49.753

“这取决于”。大多数情况下，您希望避免派生数据。但是，在某些情况下，得出的总数是合理的。

一个例子：

我在一个信用数据库应用程序上工作，其中余额由许多不同的事物组成，并且随着时间的推移不同的业务规则。例如，“余额”实际上是来自不同存储桶的不同余额的总和，例如本金、费用等。

随着交易的发布，它们根据业务规则被分配到不同的桶中。费用进入了费用桶。购买、贷方和借方进入本金桶。这些分配和规则会随着时间的推移而发生变化。

想象一下，面对不断变化的业务规则，动态查询 100,000 个客户余额。这是一个可靠的案例，其中派生值实际上是有意义的。我们维护了一组算法来“倒回”账户并按时间顺序重建余额以用于审计和验证目的，但对于大型集合，您不会想要这样做。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T10:10:34.643

我认为这取决于很多因素，您多久访问一次余额，每次需要时重新计算它的复杂程度。拥有视图等的开销是什么？

纯粹根据您提供的信息，我会存储该值，因为每次从头开始重新计算它可能会很痛苦。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T23:16:00.443

这里的每个人都是对的。它确实取决于。但是您可以通过使用视图来两全其美。听起来您可能有一个相当小的系统，动态计算余额将是最简单的事情。为了简单起见，我将定义一个视图，其中包含您想要的帐户数据（动态计算）。

如果你需要更多的性能，我会设置一个基于触发器的系统来更新主账户表的余额，然后在后台更新视图，这样你就不需要更改任何其他代码。只要确保您对任一查询都使用正确的数据库隔离模式，否则您将遇到麻烦！;-)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-10T10:11:12.380

如果视图和查询为您提供足够快的结果，则不要存储在单独的字段中。

如果速度不够快，则将其存储到单独的字段中。由于该字段将存储冗余信息，因此保持同步非常重要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T10:25:00.963

这取决于您需要多长时间访问此信息。如果它偶尔，那么我会说继续并重新计算它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T12:52:13.807

使用视图和查询——你会惊讶于它的运行速度。

# ruby - is_a? 和 dRuby 对象

> ID：190691
> 
> 赞同：3
> 
> 时间：2008-10-10T10:08:09.330
> 
> 标签：ruby, drb, druby

我正在使用 dRuby，基本上我正在调用一个返回对象的远程方法。

在客户端我有这个代码：

```
handle_error(response) if response.is_a?(Error) 
```

其中 response 是 DRbObject。（我在使用 dRuby 之前开发了这段代码，如果出现问题，我将返回一个 Error 对象）。问题是现在

```
response.is_a?(Error) 
```

返回“false”，因为该对象实际上是一个 DRbObject。关于如何检查应用程序对象的类的任何想法？

谢谢！罗伯托

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-12T15:42:33.307

虽然我不确定 DRb 如何管理远程对象，但我希望它能够修改 #kind_of? 将类层次结构保留在远程对象上，因此您可以执行以下操作：

```
response.kind_of?(Error) 
```

如果这不起作用，您可以随时询问它是否响应特定方法并从那里开始

```
response.respond_to?(some_method_on_your_errors) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-12T15:54:11.270

你不能通过使用[Duck Typing](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/78502)来解决这个问题吗？不是检查对象是否是错误，而是检查对象是否响应调用以获取错误信息。如果是，则根据该信息处理错误，否则处理（非错误）响应。

# oracle - Oracle - 事务、回滚段和 undo_retention 参数如何工作？

> ID：190693
> 
> 赞同：9
> 
> 时间：2008-10-10T10:09:30.857
> 
> 标签：oracle, transactions, ora-01555

我不是 DBA，我很难理解 Oracle 的事务管理流程。

根据我通过阅读互联网上一些看起来可靠的页面（最值得注意的是这个[AskTom 注释](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:275215756923)——但不要理会评论）所了解的情况，提交事务时，**尚未**在实际数据块上报告新数据，但保持记录在回滚段上。当有人对数据发出 SELECT，或者当 UNDO_RETENTION 秒过去时——无论这两个事件中的哪一个先发生——，然后（并且仅在那时）将新数据写入数据块。

但是我们公司的某个人，据说是知道的，最近告诉我相反：据他说，当一个事务提交时，新数据**立即**写入数据块，回滚段/撤消表空间保留旧数据以备不时之需。 UNDO_RETENTION 秒的持续时间。在此期间，这些旧数据保持可用，供交易前在 SCN 上启动的查询访问。

那么，Oracle 内部到底发生了什么，您能否提供参考来支持您的回复？

我们使用的是 Oracle 9.2.0.8。

提前致谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-10T12:46:28.313

这里有很多内容！贵公司的人基本上是对的，只是更改会在进行时写入*内存*中的数据块，甚至在提交之前；并且它们完全独立于您提交的时间写入磁盘（可能之前，可能之后，从不作为提交操作的一部分）。

1) UNDO_RETENTION 与您的更改何时写入数据块无关，无论是在内存中还是在磁盘上。UNDO_RETENTION 控制在您提交更改后撤消更改所需的数据保留多长时间。目的是在您提交之前开始的其他查询或可序列化事务可能仍需要该数据。参考：http: [//download.oracle.com/docs/cd/B19306_01/server.102/b14231/undo.htm#sthref1477](http://download.oracle.com/docs/cd/B19306_01/server.102/b14231/undo.htm#sthref1477)

2）当你进行更新时，内存中的数据块会被修改。它们可能会也可能不会写入磁盘（我相信甚至在您提交之前）；这是由后台进程完成的。此外，重做信息被写入重做日志缓冲区。撤消生成并存储在撤消段中。

3) 当您提交时，Oracle 确保您的重做信息写入磁盘，并将撤消数据标记为已提交。但它不会将内存中更改的数据块写入磁盘，也不会返回并将每个块标记为已提交。这是为了使提交尽可能快。参考：http: [//download.oracle.com/docs/cd/B19306_01/server.102/b14220/transact.htm#sthref628](http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/transact.htm#sthref628)

4) The data blocks in memory will be marked as committed either when they are written out to disk by the background process, or the next time they are used (by a SELECT or any other operation). That's what the AskTom note is discussing. This is not about whether your changes to data are written to the block; it is about whether they are marked as committed in the block itself.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T10:23:06.850

我的理解是（基本上）后者，[这个链接](http://download.oracle.com/docs/cd/B28359_01/server.111/b28318/transact.htm#i8072)有详细信息。

数据块不必写入，只需在缓冲区中更新，它们可能会或可能不会写入磁盘。在提交可以继续之前，重做必须写入磁盘。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T12:16:35.937

我还根据
此[链接](http://download.oracle.com/docs/cd/B19306_01/server.102/b14231/undo.htm)投票支持第二个版本（即 Oracle 10.2，但我认为它仍然适用于 9.2）。

它说：“提交事务后，回滚或事务恢复目的不再需要撤消数据。但是，为了一致的读取目的，长时间运行的查询可能需要这些旧的撤消信息来生成数据块的旧图像。”

和

“启用自动撤消管理后，当前的撤消保留期始终存在，这是 Oracle 数据库在覆盖旧撤消信息之前尝试保留它的最短时间。”

# c# - 创建自己的 Tinyurl 样式 uid

> ID：190701
> 
> 赞同：17
> 
> 时间：2008-10-10T10:11:43.283
> 
> 标签：c#, algorithm, probability

我正在写一篇关于 Guid/UID 的人类可读替代品的小文章，例如在 TinyURL 上用于 url 哈希的那些（通常印在杂志上，所以需要简短）。

我生成的简单 uid 是 - 6 个字符：小写字母 (az) 或 0-9。

“根据我的计算队长”，这是 6 个相互排斥的事件，虽然计算冲突的概率比 P(A 或 B) = P(A) + P(B) 更难，因为显然它包括数字和从在下面的代码中，您可以看到使用 50/50 是使用数字还是字母。

我对冲突率感兴趣，如果下面的代码是您从生成哈希中获得的预期冲突率的真实模拟。平均而言，我每百万次发生 40-50 次冲突，但请记住，uid 不会一次生成一百万次，但可能每分钟只有 10-1000 次左右。

每次发生冲突的概率是多少，有人能提出更好的方法吗？

```
static Random _random = new Random();

public static void main()
{
    // Size of the key, 6
    HashSet<string> set = new HashSet<string>();
    int clashes = 0;
    for (int n=0;n < 1000000;n++)
    {
        StringBuilder builder = new StringBuilder();

        for (int i =0;i < 7;i++)
        {
            if (_random.NextDouble() > 0.5)
            {
                builder.Append((char)_random.Next(97,123));
            }
            else
            {
                builder.Append(_random.Next(0,9).ToString());
            }
        }

        if (set.Contains(builder.ToString()))
        {
            clashes++;
            Console.WriteLine("clash: (" +n+ ")" +builder.ToString());
        }

        set.Add(builder.ToString());
        _random.Next();
        //Console.Write(builder.ToString());
    }

    Console.WriteLine("Clashes: " +clashes);
    Console.ReadLine();
} 
```

**更新：** 这是这个问题[的结果文章](http://www.yetanotherchris.me/home/2009/3/3/friendly-unique-id-generation-part-1.html)

我真的在这里问了两个问题，所以我在作弊。我所追求的答案是 rcar 的，但 Sklivvz 的也是第二部分的答案（另一种选择）。是否可以在数据库中创建一个自定义的唯一 ID 生成器，或者它是客户端（首先是 2 个可能的读取）？

我所追求的一般想法是在数据库或其他可以通过电话或印刷材料使用的商店中使用 ID，而不是巨大的 16 字节 guid。

**更新 2：**我将公式用于两个互斥事件而不是 2 个独立事件（因为第一次获得“a”并不意味着您第二次无法获得“a”）。应该是 P(A 和 B) = P(A) x P(B)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-10T10:20:18.773

为什么要使用随机函数？我一直认为 tinyurl 使用顺序 ID 的 base 62 (0-9A-Za-z) 表示。没有冲突，网址总是尽可能短。

你会有一个像这样的数据库表

```
Id  URL
 1  http://google.com
 2  ...
... ...
156 ...
... ... 
```

相应的 URL 将是：

```
http://example.com/1
http://example.com/2
...
http://example.com/2W
... 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-10T10:18:41.960

查找[生日悖论](http://en.wikipedia.org/wiki/Birthday_paradox)，这正是您遇到的问题。

问题是：你需要多少人聚在一个房间里，这样你就有 50% 的机会让任何两个人的生日相同？答案可能会让你大吃一惊。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T13:01:40.933

前段时间我正是这样做的，我遵循了 Sklivvz 提到的方式。整个逻辑是使用 SQL 服务器存储过程和几个 UDF（用户定义函数）开发的。步骤是：

*   说你想缩短这个网址：[Creating your own Tinyurl style uid](https://stackoverflow.com/questions/190701/creating-your-own-tinyurl-style-uid#191152)
*   在表格中插入 URL
*   获取最后插入的@@identity 值（一个数字id）
*   根据字母和数字的“域”将 id 转换为相应的字母数字值（我实际上使用了这个集合：“0123456789abcdefghijklmnopqrstuvwxyz”）
*   返回该值，例如'cc0'

转换是通过几个非常短的 UDF 实现的。

一个接一个调用的两个转换将返回“顺序”值，如下所示：

```
select dbo.FX_CONV (123456) -- returns "1f5n"

select dbo.FX_CONV (123457) -- returns "1f5o" 
```

如果您有兴趣，我可以分享 UDF 的代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-10T10:37:55.463

与一个特定 ID 发生冲突的概率为：

```
p = ( 0.5 * ( (0.5*1/10) + (0.5*1/26) ) )^6 
```

大约是 1.7×10^-9。

生成 n 个 ID 后发生冲突的概率为 1-p^n，因此在插入 100 万个 ID 后，每次新插入的冲突概率约为 0.17%，在插入 1000 万个 ID 后约为 1.7%，并且1亿后约16%。

1000 个 ID/分钟相当于每月 4300 万个，因此正如 Sklivvz 指出的那样，在这种情况下，使用一些递增的 ID 可能是一种更好的方法。

编辑：

为了解释数学，他基本上是在掷硬币，然后选择一个数字或字母 6 次。硬币翻转匹配的概率为 0.5，然后 50% 的时间有 1/10 的匹配机会和 50% 的匹配机会 1/26 的机会。这种情况独立发生了 6 次，因此您将这些概率相乘。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T10:18:52.427

为什么不只使用散列算法？并使用网址的哈希？

如果您使用随机数，您可能会因为不确定而发生冲突。

哈希值不能证明是唯一的，但字符串的哈希值很有可能是唯一的。

**更正**

实际上等一下，您希望它们具有人类可读性......如果您将它们放在十六进制中，它们在技术上是人类可读的。

或者您可以使用将哈希转换为人类可读字符串的算法。如果人类可读的字符串是散列的不同表示形式，它也应该与散列一样“唯一”，即原始散列的基数 36。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T10:27:54.483

我将生成一个代表您要散列的数据的随机值，然后对其进行散列并检查分类，而不是尝试使用随机手动生成的散列进行模拟。这会给你一个更好的指标。而且您将拥有更多的随机性，因为您将有更多的随机性（假设要散列的数据更大:)）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T10:32:59.653

如果您使用 6 个字符，az 和 0-9，则总共有 36 个字符。因此排列的数量是 36^6，即 2176782336.. 所以它应该只冲突 1/2176782336 次。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T10:34:56.140

来自[维基百科](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)：

> 当需要打印更少的字符时，有时会将 GUID 编码为 base64 或 Ascii85 字符串。Base64 编码的 GUID 由 22 到 24 个字符组成（取决于填充），例如：

```
7QDBkvCA1+B9K/U0vrQx1A
7QDBkvCA1+B9K/U0vrQx1A== 
```

> 而 Ascii85 编码只给出 20 个字符，例如：

```
5:$Hj:Pf\4RLB9%kU\Lj 
```

因此，如果您关心唯一性，base64 编码的 GUID 可以让您更接近您想要的，尽管它不是 6 个字符。

最好先以字节为单位，然后将这些字节转换为十六进制进行显示，而不是直接使用字符。

# sql - MySQL：选择 N 行，但在一列中只有唯一值

> ID：190702
> 
> 赞同：34
> 
> 时间：2008-10-10T10:11:46.983
> 
> 标签：sql, mysql, unique, aggregate-functions, min

给定这个数据集：

```
ID  Name            City            Birthyear
1   Egon Spengler   New York        1957
2   Mac Taylor      New York        1955
3   Sarah Connor    Los Angeles     1959
4   Jean-Luc Picard La Barre        2305
5   Ellen Ripley    Nostromo        2092
6   James T. Kirk   Riverside       2233
7   Henry Jones     Chicago         1899 
```

我需要找到 3 个最年长的人，但每个城市只有一个。

如果它只是三个最古老的，那将是......

*   亨利琼斯 / 芝加哥
*   麦克泰勒/纽约
*   埃贡斯宾格勒 / 纽约

然而，由于 Egon Spengler 和 Mac Taylor 都位于纽约，因此 Egon Spengler 将退出，而下一位（Sarah Connor / 洛杉矶）将进入。

任何优雅的解决方案？

**更新：**

目前，PConroy 的变体是最好/最快的解决方案：

```
SELECT P.*, COUNT(*) AS ct
   FROM people P
   JOIN (SELECT MIN(Birthyear) AS Birthyear
              FROM people 
              GROUP by City) P2 ON P2.Birthyear = P.Birthyear
   GROUP BY P.City
   ORDER BY P.Birthyear ASC 
   LIMIT 10; 
```

他使用“IN”的原始查询对于大数据集非常慢（5 分钟后中止），但是将子查询移动到 JOIN 会大大加快速度。大约需要 0.15 秒。我的测试环境中有 1 个 mio 行。我有一个关于“城市，生日”的索引，而第二个索引是关于“生日”的。

注意：这与...有关

*   [在一组两种可能性中选择唯一行](https://stackoverflow.com/questions/150610/selecting-unique-rows-in-a-set-of-two-possibilities)
*   [SQL查询获取最新价格](https://stackoverflow.com/questions/49404/sql-query-to-get-latest-price)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-10T10:39:20.420

可能不是最优雅的解决方案，并且`IN`在较大的表上性能可能会受到影响。

嵌套查询获取`Birthyear`每个城市的最小值。只有具有此属性的记录`Birthyear`才会在外部查询中匹配。按年龄排序，然后限制为 3 个结果，您可以获得 3 个最年长的人，他们也是他们所在城市中最年长的人（Egon Spengler 退出......）

```
SELECT Name, City, Birthyear, COUNT(*) AS ct
FROM table
WHERE Birthyear IN (SELECT MIN(Birthyear)
               FROM table
               GROUP by City)
GROUP BY City
ORDER BY Birthyear DESC LIMIT 3;

+-----------------+-------------+------+----+
| name            | city        | year | ct |
+-----------------+-------------+------+----+
| Henry Jones     | Chicago     | 1899 | 1  |
| Mac Taylor      | New York    | 1955 | 1  |
| Sarah Connor    | Los Angeles | 1959 | 1  |
+-----------------+-------------+------+----+ 
```

**编辑**- 添加`GROUP BY City`到外部查询，因为具有相同出生年份的人将返回多个值。对外部查询进行分组可确保每个城市仅返回一个结果，如果超过一个人具有该最小值`Birthyear`。该`ct`列将显示该城市中是否存在超过一个人`Birthyear`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T10:38:17.367

这可能不是最优雅和最快的解决方案，但它应该可以工作。我期待看到真正的数据库大师的解决方案。

```
select p.* from people p,
(select city, max(age) as mage from people group by city) t
where p.city = t.city and p.age = t.mage
order by p.age desc 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T10:26:02.180

类似的东西？

```
SELECT
  Id, Name, City, Birthyear
FROM
  TheTable
WHERE
  Id IN (SELECT TOP 1 Id FROM TheTable i WHERE i.City = TheTable.City ORDER BY Birthyear) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T11:22:08.307

不漂亮，但也应该与具有相同出生日期的多人一起使用：

测试数据：

```
select id, name, city, dob 
into people
from
(select 1 id,'Egon Spengler' name, 'New York' city , 1957 dob
union all select 2, 'Mac Taylor','New York', 1955
union all select 3, 'Sarah Connor','Los Angeles', 1959
union all select 4, 'Jean-Luc Picard','La Barre', 2305
union all select 5, 'Ellen Ripley','Nostromo', 2092
union all select 6, 'James T. Kirk','Riverside', 2233
union all select 7, 'Henry Jones','Chicago', 1899
union all select 8, 'Blah','New York', 1955) a 
```

询问：

```
select 
    * 
from 
    people p
    left join people p1
    ON 
        p.city = p1.city
        and (p.dob > p1.dob and p.id <> p1.id)
        or (p.dob = p1.dob and p.id > p1.id)
where
    p1.id is null
order by 
    p.dob 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-14T16:57:46.203

@布拉姆

**更新** 刚刚发现使用USING而不是ON很好。它将删除结果中的重复列。

```
SELECT P.*, COUNT(*) AS ct
   FROM people P
   JOIN (SELECT City, MIN(Birthyear) AS Birthyear
              FROM people 
              GROUP by City) P2 USING(Birthyear, City)
   GROUP BY P.City
   ORDER BY P.Birthyear ASC 
   LIMIT 10; 
```

**原帖**

嗨，我尝试使用您更新的查询，但我得到了错误的结果，直到我添加了额外的条件加入（也是加入选择的额外列）。转移到您的查询，我正在使用这个：

```
SELECT P.*, COUNT(*) AS ct
   FROM people P
   JOIN (SELECT City, MIN(Birthyear) AS Birthyear
              FROM people 
              GROUP by City) P2 ON P2.Birthyear = P.Birthyear AND P2.City = P.City
   GROUP BY P.City
   ORDER BY P.Birthyear ASC 
   LIMIT 10; 
```

理论上你不应该需要最后一个 GROUP BY P.City，但我现在把它留在那里，以防万一。稍后可能会删除它。

# java - 我需要担心字符串常量池吗？

> ID：190714
> 
> 赞同：2
> 
> 时间：2008-10-10T10:18:00.777
> 
> 标签：java, string

我有一个非常重字符串的 Java 应用程序——它需要大量不同的大字符串对象。

我需要担心字符串常量池的内存和性能吗？

有什么办法可以随时查看游泳池有多大？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T11:05:52.987

正如马里奥所说，常量池仅与 intern()ed Strings 以及 Java 代码中的常量 Strings 相关（这些是隐式实习的）。

但是还有一个可能适用于您的案例的警告：该方法将与原始字符串`substring()`共享底层。`char[]`所以图案

```
 String large = ...                  // read 10k string
  String small = large.substring(...) // extrakt a few chars
  large = null;  // large String object no longer reachable,
                 // but 10k char[] still alive, as long as small lives 
```

可能会导致意外的内存使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T10:37:03.903

据我所知，如果它是对象的提要，那么除非您调用 intern()，否则它们不会进入字符串常量池。实习字符串的内存消耗不是来自 Heap，而是来自 Perm Gen 内存空间，所以如果你实习了很多字符串，应用程序会因 OutOfMemory 崩溃，即使还有很多 Heap 剩余。

因此，除非您正在实习所有这些字符串，否则这不应该是一个问题。如果它成为一个问题，您可以拥有自己的 Map 实现来存储这些字符串，因此您不使用内部机制。

我检查了 intern() 方法的实现，它是本机的，因此测量内存消耗或查看池的内容似乎并不简单。

如果内存不足，可以使用此标志来增加 PermSize：

```
-XX:MaxPermSize=64m 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T10:21:13.313

我认为你应该分析你的申请，无论有没有实习。然后，您将确切地看到效果是什么。

我不相信有办法查看字符串常量池的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T11:22:32.690

不确切知道程序是什么，我只能建议您尝试将字符串用作流，而不是将字符串作为一个整体存储。也许您需要为您的应用程序进行更多抽象，并发明一种内存效率更高的中间表示？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-13T06:20:56.323

在 Java 1.7 substring() - 方法不再使用相同的 char[] 而是将子字符串复制到新数组中，即

```
public String substring(int beginIndex, int endIndex) {
        if (beginIndex < 0) {
            throw new StringIndexOutOfBoundsException(beginIndex);
        }
        if (endIndex > value.length) {
            throw new StringIndexOutOfBoundsException(endIndex);
        }
        int subLen = endIndex - beginIndex;
        if (subLen < 0) {
            throw new StringIndexOutOfBoundsException(subLen);
        }
        return ((beginIndex == 0) && (endIndex == value.length)) ? this
                : new String(value, beginIndex, subLen);
    } 
```

如果 beginIndex 不为零或 endIndex 不等于 char[] 数组的长度，这一切都交给 String 构造函数。

```
public String(char value[], int offset, int count) {
        if (offset < 0) {
            throw new StringIndexOutOfBoundsException(offset);
        }
        if (count < 0) {
            throw new StringIndexOutOfBoundsException(count);
        }
        // Note: offset or count might be near -1>>>1.
        if (offset > value.length - count) {
            throw new StringIndexOutOfBoundsException(offset + count);
        }
        this.value = Arrays.copyOfRange(value, offset, offset+count);
    } 
```

# c - 堆栈内存读取

> ID：190738
> 
> 赞同：1
> 
> 时间：2008-10-10T10:27:50.913
> 
> 标签：c, stack

使用以下代码：

```
typedef struct
{
    char    fileName[ 1024];
    time_t  deleteTime; 
} file_item_t;

....
....

setEntry(char *fileName)
{
    file_item_t     file;

    memset( &file, 0x00, sizeof( file_item_t ));

    memcpy( file.fileName, 
         fileName, 
         sizeof( file.fileName ) - 1 );
...
... 
```

调用该函数时，它在 SPARC 机器上运行正常，但在运行 Solaris 10 的 i386 上出现 段错误`fileName`。假设是一个以空字符结尾的字符串，大约 30 个字符。似乎尝试读取超出使用范围`fileName`会`memcpy()`触发某些系统上的分段错误。

它是遗留代码，易于纠正。但我想知道的是可能导致失败与否的潜在特征。它与堆栈上的读取冲突有关吗？一些跨界？它与内存分段有关，它是否只是偶然的情况（取决于内存管理和操作系统如何完成内存分段/分页。）它可能会失败。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T10:33:57.297

You already hit the nail on the head:

In your memcpy you're reading past the length of filename.

Also dirty that will often work if the memory behind the filename is readable. In most cases it is, but if you for example pass a string-literal as an argument, and the linker puts the string into the last kilobyte of the data-section you will get a segmentation fault because the CPU tries to read from a memory location that is not mapped into the address space of your process.

The obvious fix is to use strcpy or strncpy.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T10:31:01.263

您确定 所指向的字符串`fileName`的长度真的是 1024 字节吗？不知何故，我觉得你应该 strcpy 而不是 memcpy。

如果 fileName 更短，memcpy 会复制真实字符串数据后面的字节，并且可能会导致读取该内存的访问冲突。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T14:54:27.803

有了给定的信息，我们不知道参数`char *filename`指向的位置——堆栈、堆、数据部分或其他......

如果它在堆栈上，可能是因为 SPARC 上的默认堆栈大小比 x86 上的大得多，而且增长得更高。根据 SPARC ABI，堆栈帧始终有空间来备份所有 16 个寄存器，如果函数需要任何参数（即使它需要更少），还可以为六个参数加上空间。因此，SPARC 每次函数调用至少消耗 64 或 92 字节的堆栈，而 x86 每次函数调用只需 8 或 4 字节即可。

如果它在堆上或数据部分中，那么可能只是运行时（堆）或编译器（数据）碰巧将字符串放在 x86 上页面的末尾附近，因此运行结束会导致读取错误记忆。

# ruby - 将 ruby hash .default 设置为列表

> ID：190740
> 
> 赞同：41
> 
> 时间：2008-10-10T10:28:53.080
> 
> 标签：ruby, hashmap

我以为我了解默认方法对哈希的作用...

如果键不存在，则为其提供默认值：

```
irb(main):001:0> a = {}
=> {}
irb(main):002:0> a.default = 4
=> 4
irb(main):003:0> a[8]
=> 4
irb(main):004:0> a[9] += 1
=> 5
irb(main):005:0> a
=> {9=>5} 
```

都好。

但是，如果我将默认设置为空列表或空哈希，我根本不明白它的**行为**......

```
irb(main):001:0> a = {}
=> {}
irb(main):002:0> a.default = []
=> []
irb(main):003:0> a[8] << 9
=> [9]                          # great!
irb(main):004:0> a
=> {}                           # ?! would have expected {8=>[9]}
irb(main):005:0> a[8]
=> [9]                          # awesome!
irb(main):006:0> a[9]
=> [9]                          # unawesome! shouldn't this be [] ?? 
```

我希望/期待与使用 ||= 运算符时相同的行为...

```
irb(main):001:0> a = {}
=> {}
irb(main):002:0> a[8] ||= []
=> []
irb(main):003:0> a[8] << 9
=> [9]
irb(main):004:0> a
=> {8=>[9]}
irb(main):005:0> a[9]
=> nil 
```

谁能解释发生了什么？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-10-10T18:02:35.210

这是一个非常有用的成语：

```
(myhash[key] ||= []) << value 
```

它甚至可以嵌套：

```
((myhash[key1] ||= {})[key2] ||= []) << value 
```

另一种方法是：

```
myhash = Hash.new {|hash,key| hash[key] = []} 
```

但这有一个显着的副作用，即**询问**一个键会创建它，这会呈现 has_key? 相当没用，所以我避免使用这种方法。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-10-10T10:48:54.817

`Hash.default`用于设置查询不存在的键时**返回的默认值。**集合中的条目不是为您创建的，只是因为对其进行了查询。

此外，您设置的值`default`是对象的实例（在您的情况下为 Array），因此当返回 this 时，可以对其进行操作。

```
a = {}
a.default = []     # set default to a new empty Array
a[8] << 9          # a[8] doesn't exist, so the Array instance is returned, and 9 appended to it
a.default          # => [9]
a[9]               # a[9] doesn't exist, so default is returned 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-10-11T16:39:26.407

我认为这是您正在寻找的行为。这将自动将 Hash 中的任何新键初始化为数组：

```
irb(main):001:0> h = Hash.new{|h, k| h[k] = []}
=> {}
irb(main):002:0> h[1] << "ABC"
=> ["ABC"]
irb(main):003:0> h[3]
=> []
irb(main):004:0> h
=> {1=>["ABC"], 3=>[]} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-04-06T01:08:51.980

格伦麦当劳 说：

“另一种方法是：

myhash = Hash.new {|hash,key| 哈希[键] = []}

但这有一个显着的副作用，即询问一个键会创建它，这会呈现 has_key? 相当没用，所以我避免使用这种方法。”

事实上，这似乎不是真的。

```
irb(main):004:0> a = Hash.new {|hash,key| hash[key] = []}
=> {}
irb(main):005:0> a.has_key?(:key)
=> false
irb(main):006:0> a[:key]
=> []
irb(main):007:0> a.has_key?(:key)
=> true 
```

*正如我所料，*访问密钥将创建它。*只问has_key？才不是。*

 ** * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-11-23T01:03:05.130

如果你真的想要一个无限深的哈希：

```
endless = Hash.new { |h, k| h[k] = Hash.new(&h.default_proc) }
endless["deep"]["in"]["here"] = "hello" 
```

当然，正如格伦在上面指出的那样，如果你这样做，has_key? 失去了它的意义，因为它总是会返回真。感谢 jbarnette 这个。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-10T11:00:11.643

```
irb(main):002:0> a.default = []
=> []
irb(main):003:0> a[8] << 9
=> [9]                          # great! 
```

使用此语句，您已修改默认值；您尚未创建新数组并添加“9”。在这一点上，如果你这样做了，它是相同的：

```
irb(main):002:0> a.default = [9]
=> [9] 
```

因此，您现在得到这个也就不足为奇了：

```
irb(main):006:0> a[9]
=> [9]                          # unawesome! shouldn't this be [] ?? 
```

此外，“<<”将“9”添加到数组中；它没有将其添加到哈希中，这解释了这一点：

```
irb(main):004:0> a
=> {}                           # ?! would have expected {8=>[9]} 
```

而不是使用.default，你可能想要在你的程序中做的是这样的：

```
# Time to add a new entry to the hash table; this might be 
# the first entry for this key..
myhash[key] ||= []
myhash[key] << value 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-10-10T18:48:24.337

我不确定这是否是您想要的，但是您可以这样做以在查询缺少的哈希键时始终返回一个空数组。

```
h = Hash.new { [] }
h[:missing]
   => []

#But, you should never modify the empty array because it isn't stored anywhere
#A new, empty array is returned every time
h[:missing] << 'entry'
h[:missing]
   => [] 
```

# c++ - 为什么我不能在 while 循环的测试部分中放置变量声明？

> ID：190748
> 
> 赞同：20
> 
> 时间：2008-10-10T10:33:06.627
> 
> 标签：c++

显然，您可以将变量声明放在 for 循环中：

```
for (int i = 0; ... 
```

我注意到你也可以在 if 和 switch 语句中做同样的事情：

```
if ((int i = f()) != 0) ...

switch (int ch = stream.get()) ... 
```

但是当我尝试在 while 循环中做同样的事情时：

```
while ((int ch = stream.get()) != -1) ... 
```

编译器（VC++ 9.0）根本不喜欢它。

这是合规行为吗？有什么原因吗？

**编辑**：我发现我可以这样做：

```
while (int ch = stream.get() != -1) ... 
```

但由于优先规则，这被解释为：

```
while (int ch = (stream.get() != -1)) ... 
```

这不是我想要的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-10T15:29:24.240

'03 标准中条件的语法定义如下：

```
condition:
  expression
  type-specifier-seq declarator = assignment-expression 
```

因此，上述内容仅允许以下条件：

```
if ( i && j && k ) {}
if ( (i = j) ==0 ) {}
if ( int i = j ) {} 
```

该标准允许条件声明一个变量，但是，他们通过添加一个名为“条件”的新语法规则来实现这一点，该条件可以是表达式或带有初始化程序的声明符。结果是，仅仅因为您处于`if`, `for`, `while`, or的条件`switch`中并不意味着您可以在表达式中声明变量。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-10T21:14:51.420

问题是，标准允许您在括号内*声明。*您想要做的是将声明作为表达式的一部分，这是标准不允许您做的事情。

while() 可以有以下两种语法之一：while(<declaration>) 或 while(<expression>)。声明使用“=”，看起来像表达式，但它是一个不同的语法实体。

当你写

```
while(int i = 1) {
} 
```

，那完全没问题。“int i=1”是一个声明。然而，你想要的是

```
while ( (int i = 1) + 3) {
} 
```

这是一种非常不同的动物。您需要在 while() 中使用表达式，其中表达式的一项是声明。现在，声明是一个语句，因此不能成为表达式的一部分。这就是为什么你需要做的事情不能做。

（在写完整个咆哮之后，我注意到另外两个人写了同样的事情。哦，越多越好。）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-10T10:40:56.143

这似乎不是合规行为。标准第 6.5.1.2 部分规定：

> 当 while 语句的条件是声明时，声明的变量的范围从其声明点 (3.3.1) 延伸到 while 语句的末尾。表单的 while 语句
> 
> while (T t = x) 语句
> 
> 相当于

```
label:
{ //start of condition scope
    T t = x;
    if (t) {
        statement
        goto label;
    }
} 
```

因此，在您的示例中， ch 应该在循环范围内声明并正常工作（通过每次循环迭代重新创建它）。观察到行为的原因很可能是由于编译器没有正确确定变量的范围，然后多次声明它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T10:34:59.057

这可能是因为每个循环都会评估 while 子句的内容，因此它会尝试多次声明“ch”。

您给出的 if、switch 和 for 循环示例都将只定义一次“ch”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T14:22:29.180

您*可以*将变量声明放在 while 循环的测试表达式中。您*不能*做的是将声明语句放在其他表达式中。例如，在表达式 a+b+c 中，您不能将 b 替换为`int i = f()`。表达式也一样`(a)`；你不能插入`int i=f()`得到一个表达式`(int i=f())`。

因此，在 中`while (int i = foo())`，最外面的括号是 while 语句的一部分，而不是文本表达式的一部分，并且一切都是合法的。在`while ((int i = foo()))`中，最外面的括号仍然是 while 语句的一部分。test-expression 的格式`"(" expr ")"`为 ，最终会出现语法错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T14:59:59.697

~~试试~~ **这个不行**

```
while (int ch = stream.get(), ch != -1) ... 
```

~~我从未尝试过，但如果您编辑中的评论是正确的，这应该可以。~~
VS 2005 甚至不会编译它。

# .net - WPF UserControl 的初始化事件未触发

> ID：190749
> 
> 赞同：8
> 
> 时间：2008-10-10T10:33:25.160
> 
> 标签：.net, wpf, .net-3.5

我有一个非常简单的 WPF UserControl，如下所示：

```
namespace MyUserControl
{
  /// <summary>
  /// Interaction logic for UserControl1.xaml
  /// </summary>
  public partial class UserControl1 : UserControl
  {
    public UserControl1()
    {
      InitializeComponent();
    }

    protected override void OnRender(DrawingContext drawingContext)
    {
      Rect rect = new Rect(RenderSize);
      drawingContext.DrawRectangle(Brushes.AliceBlue, new Pen(Brushes.Red, 1), rect);
      base.OnRender(drawingContext);
    }
  }
} 
```

然后我在标准 WPF 窗口的 XAML 中使用它，如下所示：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="clr-namespace:MyUserControl;assembly=MyUserControl"
    Title="Window1" Height="351" Width="496">
    <Grid>
    <mc:UserControl1 Margin="0,0,0,0" Name="uControl1" Initialized="uControl1_Initialized"/>
  </Grid>
</Window> 
```

上面的 WPF 窗口后面的代码如下所示：

```
private void uControl1_Initialized(object sender, EventArgs e)
{
  MessageBox.Show("Hello!");
} 
```

不幸的是 Initialized 事件从未被触发。谁能告诉我为什么？

非常感谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-10T10:56:25.037

MSDN[文档](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.initialized.aspx)说

> 每当调用 EndInit 或 OnVisualParentChanged 方法时都会引发此事件。对任一方法的调用可能来自应用程序代码，或者在处理 XAML 页面时通过可扩展应用程序标记语言 (XAML) 处理器行为。

我可以在这里重现您的问题。我建议改用`Loaded`事件，它在控件布局和呈现后触发。如果您确实需要该`Initialized`事件，请遵循此[MSDN 论坛线程](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/e987a889-9eca-4205-9ed7-5251dc31bebf/)`UserControl`的建议，并在调用之前的构造函数中附加一个事件处理程序，`InitializeComponent()`如下所示：

```
public UserControl1()
{
    this.Initialized += delegate
    {
        MessageBox.Show("Hello!");
    };
    InitializeComponent();
} 
```

有关`Loaded`vs.的更详细说明`Initialized`，请参阅[此博客文章](https://docs.microsoft.com/en-us/archive/blogs/mikehillberg/the-loaded-event-and-the-initialized-event)。

# perl - 记录 Perl 代码的最佳方式是什么？

> ID：190755
> 
> 赞同：27
> 
> 时间：2008-10-10T10:37:07.257
> 
> 标签：perl, documentation, perl-pod

有什么建议可以记录我的 Perl 代码吗？您使用什么以及可以使用哪些工具来帮助我？

您使用哪个模块将 pod 转换为 html？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-10-10T11:29:35.077

查看几乎所有 Perl 模块，您会看到[普通旧文档 (POD)](http://perldoc.perl.org/perlpod.html)格式。在[CPAN Search](http://search.cpan.org)上，查看模块时，您可以选择查看原始源代码，这是查看原始 pod 的一种方式，但您也可以从命令行使用[perldoc 。](http://perldoc.perl.org/perldoc.html)`-m`开关显示文件

```
perldoc -m Foo::Bar 
```

或者，如果您想找到该文件以便在您喜欢的编辑器中查看它，请使用`-l`开关找到它：

```
perldoc -l Foo::Bar 
```

一旦你开始记录你的程序，你将 Pod 与代码一起放入文件中，要么与代码交织在一起，因此文档就在相关部分的旁边，或者在开头、中间或结尾处作为一大块。

Pod 可以通过 Perl 附带的翻译器（pod2latex、pod2ps、pod2html）轻松翻译成其他几种格式，例如 LaTeX、Postscript、HTML 等。我什至有一个用于 InDesign 的 pod 翻译器。[使用Pod::Simple](http://search.cpan.org/dist/Pod-Simple)编写自己的 Pod 翻译器很容易，所以如果你没有找到你最喜欢的最终形式的翻译器，那就自己做吧。

您还可以将几个工具添加到您的测试套件中以检查您的 Pod。[Test::Pod](http://search.cpan.org/dist/Test-Pod)模块检查格式错误，Test [::Pod::Coverage](http://search.cpan.org/dist/Test-Pod-Coverage)模块检查您记录的每个子例程，等等。您也可能对我的[Perl 文档文档](http://www.perlmonks.org/?node_id=408254)感兴趣。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-10T11:43:56.923

我绝对推荐[POD](http://en.wikipedia.org/wiki/Plain_Old_Documentation)。

POD 也可以与代码一起使用，但我更喜欢在 __END__ 之后放在程序的底部（正如 Damian Conway 在[Perl Best Practices](http://oreilly.com/catalog/9780596001735)中推荐的那样）。

查看[POD::Server](http://search.cpan.org/dist/Pod-Server/lib/Pod/Server.pm)和 [POD::Webserver](http://search.cpan.org/dist/Pod-Webserver/lib/Pod/Webserver.pm)，它为所有 POD 提供了 Web 前端。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-10T10:43:24.623

[Perl 吊舱](http://perldoc.perl.org/perlpod.html)。

这就是 Mozilla 记录他们的 Perl 的方式。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-10T11:28:48.183

不要过度翻转，但是记录 Perl 代码的最佳方式与记录任何其他语言的代码的方式相同。

至于具体的工具，我混合使用标准的内联注释，使用类似于**man**格式的较大文档块的 pod以及需要更自由格式的文档作为最终后备的 TeX。（而且，本着“与任何其他语言相同”的精神，是的，我也使用 pod 来记录非 Perl 代码。）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-17T18:39:35.660

> 您使用哪个模块将 pod 转换为 html？

查看[Pod::ProjectDocs](http://search.cpan.org/dist/Pod-ProjectDocs/) - 您将获得一个简单的命令行实用程序，它将把 Perl 项目中的所有 POD 转换为一组 HTML 页面，看起来就像您在[search.cpan.org](http://search.cpan.org/)上看到的一样。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-25T19:46:22.873

没有人提到[Smart::Comments](http://search.cpan.org/~dconway/Smart-Comments/lib/Smart/Comments.pm)？如果您需要更多的评论权力，这并不总是您想要的，但很好。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-21T16:02:44.323

您可能还想查看Damian Conway 的[Perl Best Practices](https://rads.stackoverflow.com/amzn/click/com/0596001738)。我使用了一些技巧来清理我继承的一个小型 Perl 代码库。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-11-12T17:30:42.463

单独的用户文档和编码器文档。可能将用户文档（tuts，faq，reference）放在目录（/doc）中，编码器与代码相同。不幸的是，它被约定所期望，对模块本身有概述。**这个你可以在END**之后做 POD 。您可以在评论中添加鬃毛编码文档。其他内容，例如编码风格或如何贡献代码库（根目录？）中的单独 .pod 文件

# php - PHP 可以检测它是从 cron 作业还是从命令行运行？

> ID：190759
> 
> 赞同：63
> 
> 时间：2008-10-10T10:37:45.930
> 
> 标签：php, cron

我正在寻找 PHP 的方法来检测脚本是从 shell 上的手动调用（我登录并运行它）运行的，还是从 crontab 条目运行的。

我有各种用 php 编写的维护类型脚本，已设置为在我的 crontab 中运行。有时，我需要提前手动运行它们，或者如果出现故障/损坏，我需要运行它们几次。

这样做的问题是，我在每次手动运行脚本时都不想发生的任务（发布到 Twitter、发送电子邮件等）中也设置了一些外部通知。

我正在使用 php5（如果重要的话），它是一个相当标准的 linux 服务器环境。

有任何想法吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-10-10T13:31:35.367

与其检测脚本何时从 crontab 运行，不如检测您何时手动运行它可能更容易。

当您从命令行运行脚本时，会设置很多环境变量（在 $_ENV 数组中）。这些将根据您的服务器设置和登录方式而有所不同。在我的环境中，以下环境变量在手动运行脚本时设置，而从 cron 运行时不存在：

*   学期
*   SSH_CLIENT
*   SSH_TTY
*   SSH_CONNECTION

还有其他人。因此，例如，如果您总是使用 SSH 访问该框，那么以下行将检测脚本是否从 cron 运行：

`$cron = !isset($_ENV['SSH_CLIENT']);`

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-03-19T05:46:58.337

```
if (php_sapi_name() == 'cli') {   
   if (isset($_SERVER['TERM'])) {   
      echo "The script was run from a manual invocation on a shell";   
   } else {   
      echo "The script was run from the crontab entry";   
   }   
} else { 
   echo "The script was run from a webserver, or something else";   
} 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-10-10T10:47:28.703

你可以设置一个额外的参数，或者在你的 crontab 中添加一行，也许：

```
CRON=running 
```

然后您可以检查“CRON”的环境变量。另外，请尝试检查 $SHELL 变量，我不确定 cron 是否/将其设置为什么。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2011-08-26T15:33:07.430

这是我用来发现脚本执行位置的方法。查看 php_sapi_name 函数以获取更多信息：[http ://www.php.net/manual/en/function.php-sapi-name.php](http://www.php.net/manual/en/function.php-sapi-name.php)

```
$sapi_type = php_sapi_name();
if(substr($sapi_type, 0, 3) == 'cli' || empty($_SERVER['REMOTE_ADDR'])) {
    echo "shell";
} else {
    echo "webserver";
} 
```

**编辑：** 如果`php_sapi_name()`不包括**cli**（可能是*cli*或*cli_server*），那么我们检查是否`$_SERVER['REMOTE_ADDR']`为空。从命令行调用时，这应该是空的。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2010-03-11T22:15:59.260

正确的方法是在例如 stdout 文件描述符上使用 posix_isatty() 函数，如下所示：

```
if (posix_isatty(STDOUT))
    /* do interactive terminal stuff here */ 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2011-10-23T19:46:09.277

我认为最通用的解决方案是在cron命令中添加一个环境变量，并在代码中查找。它适用于每个系统。

如果 cron 执行的命令是，例如：

```
"/usr/bin/php -q /var/www/vhosts/myuser/index.php" 
```

将其更改为

```
"CRON_MODE=1 /usr/bin/php -q /var/www/vhosts/myuser/index.php" 
```

然后你可以在代码上检查它：

```
if (!getenv('CRON_MODE'))
    print "Sorry, only CRON can access this script"; 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-10T11:10:44.553

我不具体了解 PHP，但您可以沿着进程树向上走，直到找到 init 或 cron。

假设 PHP 可以获取它自己的进程 ID 并运行外部命令，则应该执行`ps -ef | grep pid`pid**是**您自己的进程 ID 并从中提取父进程 ID (PPID) 的问题。

然后对该 PPID 执行相同的操作，直到您将 cron 作为父级或 init 作为父级。

例如，这是我的进程树，你可以看到所有权链，1 -> 6386 -> 6390 -> 6408。

```
UID     PID  PPID  C  STIME  TTY        TIME  CMD
root      1     0  0  16:21  ?      00:00:00  /sbin/init
allan  6386     1  0  19:04  ?      00:00:00  gnome-terminal --geom...
allan  6390  6386  0  19:04  pts/0  00:00:00  bash
allan  6408  6390  0  19:04  pts/0  00:00:00  ps -ef 
```

在 cron 下运行的相同进程如下所示：

```
UID     PID  PPID  C  STIME  TTY        TIME  CMD
root      1     0  0  16:21  ?      00:00:00  /sbin/init
root   5704     1  0  16:22  ?      00:00:00  /usr/sbin/cron
allan  6390  5704  0  19:04  pts/0  00:00:00  bash
allan  6408  6390  0  19:04  pts/0  00:00:00  ps -ef 
```

这种“走上进程树”解决方案意味着您不必担心引入人为参数来指示您是否在 cron 下运行 - 您可能会忘记在交互式会话中执行此操作并进行填充。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-04-15T05:03:43.903

爬行。尝试

```
if (!isset($_SERVER['HTTP_USER_AGENT'])) { 
```

反而。PHP客户端二进制不发送它。Term Type 只在 PHP 用作模块（即 apache）时有效，但是当通过 CGI 接口运行 php 时，使用上面的示例！

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-10T10:39:58.487

不是我知道的——可能最简单的解决方案是自己提供一个额外的参数来告诉脚本它是如何被调用的。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-10-10T10:43:53.953

我会调查`$_ENV`(var_dump() it) 并检查您在运行它时是否注意到与 cronjob 运行它时的差异。除此之外，我认为没有“官方”开关可以告诉您发生了什么。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-05-01T22:59:03.887

在我的环境中，我发现如果从命令行运行，`TERM`则设置为设置，但如果通过 Apache 作为 Web 请求运行，则未设置。`$_SERVER`我把它放在我可以从命令行运行的脚本的顶部，或者可以通过网络浏览器访问：

```
if (isset($_SERVER{'TERM'}))
{
    class::doStuffShell();
}
else
{
    class::doStuffWeb();
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-08-23T20:27:13.500

```
getenv('TERM') 
```

填充 SO 的 30 字符分钟。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-10T10:46:30.610

在 cron 命令中，添加`?source=cron`到脚本路径的末尾。然后，在您的脚本中，检查`$_GET['source']`.

编辑：抱歉，这是一个 shell 脚本，所以不能使用 qs。我认为，您可以在表单中传递参数，`php script.php arg1 arg2`然后使用`$argv`.

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-03-03T15:54:02.840

另一种选择是测试通过 web 调用 php 文件时设置的特定环境变量，如果由命令行运行则不设置。

在我的网络服务器上，我正在测试 APACHE_RUN_DIR 环境变量是否设置如下：

```
if (isset($_ENV["APACHE_RUN_DIR"])) {
  // I'm called by a web user
}
else {
  // I'm called by crontab
} 
```

为了确保它可以在您的 Web 服务器上运行，您可以使用以下语句在您的 Web 服务器上放置一个虚拟 php 文件：

```
<?php var_dump($_ENV);  ?> 
```

然后1）用你的网络浏览器加载它，2）像这样从命令行加载它

```
/usr/bin/php /var/www/yourpath/dummy.php 
```

比较差异并测试适当的变量。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-22T23:35:07.297

`$_SERVER['SESSIONNAME']`包含`Console`是否从 CLI 运行。也许这有帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-30T20:03:48.810

```
if(!$_SERVER['HTTP_HOST']) {
 blabla();
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-27T18:13:04.060

我认为最好在命令行中使用额外的选项运行 cron 命令，而您不会手动运行。

cron 会做：

```
command ext_updates=1 
```

手册会做：

```
command 
```

只需在脚本本身中添加一个选项，让 ext_updates 参数的默认值为 false。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-11-03T16:18:06.820

`posix_isatty(STDOUT) return FALSE`如果 cli 调用的输出被重定向（管道或文件）...

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-06-23T05:49:35.043

这很容易。Cron 守护进程总是导出`MAILTO`环境变量。检查它是否存在并且具有非空值 - 然后您从 cron 运行。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-03-06T19:33:50.237

在我的 Amazon Linux 服务器上，这对我有用：

$isCron = ( $_SERVER['HOME'] == '/' );

如果您只是运行它，主目录将设置为您的。如果您使用 sudo 运行它，则主目录设置为 /root。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-07-22T20:42:34.810

`(array) $argv`将在 cron 作业运行时设置。数组的第一个值将是您在创建 cron 作业时使用的 /path/to/file。以下值`$argv`将是 /path/to/file 后面的任何参数。

例如，如果您的 cron 作业命令如下所示：

`php /path/to/file.php first second third`

$argv 的值将是：`["/path/to/file.php", "first", "second", "third"]`

然后您可以：

`if (isset($argv) && is_array($argv) && in_array('first', $argv)) { /* do something */ }`

* * *

## 回答 #22

> 赞同：-4
> 
> 时间：2011-01-02T06:17:30.967

这对我来说很容易......只是`count($_SERVER['argc'])`如果你的结果高于零，它将耗尽服务器。您只需要添加到您`$_SERVER['argv']`的自定义变量中，例如`"CronJob"=true;`

# security - 通过 https 发送敏感数据的安全性如何？

> ID：190771
> 
> 赞同：24
> 
> 时间：2008-10-10T10:41:42.833
> 
> 标签：security, ssl, query-string

SSL 是否足够安全以在查询字符串中使用敏感数据（如密码）？是否有任何额外的选项可以实施？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-10T10:51:14.563

SSL 提供**安全的传输级安全性**。客户端和服务器之间的任何人都应该能够读取信息。

**但是**您应该**改变主意，不要在查询字符串中写入敏感数据**。它将显示在浏览器的历史记录中，并且在浏览器的地址栏中和服务器上的日志中可见。请参阅本文：[通过 HTTPS 查询字符串的安全性如何？](http://blog.httpwatch.com/2009/02/20/how-secure-are-query-strings-over-https/)

如果使用查询字符串是您唯一的选择（我对此表示怀疑），这里有一篇[关于保护查询字符串](http://www.4guysfromrolla.com/articles/083105-1.aspx)的有趣文章。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T11:04:29.683

SSL 是安全的，但请记住，如果有足够的时间和资源，任何加密都可能被破解。鉴于您不知道哪些数据包包含密码，哪些不包含密码，您必须解密所有加密流量才能找到正确的数据包。这在一般情况下是棘手的。

但是，登录表单需要一个 input[type=text] 才能输入。需要工作才能“解包”它并使用查询字符串将请求转换为 HTTP GET 请求，而不是使用表单参数中的数据进行 POST。我无法想象为什么有人会这样做。一旦用户提供了密码（并且用户已通过身份验证），请使用身份验证这一事实，而不是保留密码。如果您需要保留密码以进行模拟，例如，请将其保留在服务器端，最好保存在安全字符串中。如果您尝试进行单点登录（为许多站点输入我的 id/密码一次），则使用某种中央身份验证服务 (CAS) - OpenID、WindowsLive - 或实施您自己的。

密码通过网络的次数越少越好。

而且，总是要考虑浏览器位置栏，它会认为您需要对您放入查询字符串中的任何敏感数据进行加密和编码，如前所述。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T10:47:26.253

查询字符串中的敏感数据是个坏主意，不经意的路人可以看到查询字符串，并且会很想加入书签，这确实不安全。

SSL 非常安全，如果您使用网上银行并且您信任它，那么 SSL 对您来说也足够了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T10:53:18.647

同意 SSL 是安全的 *ish 和查询字符串问题

请记住，SSL 存在限制 -

确保证书是根认证的。

一些 Windows 2000 机器需要申请 128 位 ssl 的 sp 才能工作，如果它不存在，那么它会转到 40 位或不加载（如果我没记错的话）

一些软件防火墙，比如 ISA——你在其中发布安全站点和证书——就像中间人一样。

安全到 ISA，然后安全到 LAN。但这里的重要因素是“然后”，因为 ISA 将记录然后记录是一个问题，因为可以看到查询字符串和帖子上的密码 - 这意味着任何人（管理员）都可以看到......

因此，请使用您的语言寻找安全散列算法来简单地散列密码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T10:59:54.467

没有“足够安全”，安全性不是一个静态的东西，它的布尔属性要么为假要么为真。

SSL 很好，但这取决于服务器端的私钥有多安全、密钥有多少位、使用的算法、使用的证书的可信度等......

但是，如果您使用 SSL，至少您传输的所有数据都是加密的（目标 IP 除外，因为它用于路由您的包裹）。

您应该考虑的另一点是 - 如果您在浏览器中手动输入密码查询字符串，它可能最终会出现在您的本地浏览器缓存中（在一个完全未加密的本地文件中）。所以最好使用 POST 而不是 GET 传输机制。

如果您真的对安全性感兴趣，我建议您对该主题进行更多研究，因为通常算法不是安全性的最薄弱环节。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T10:46:00.283

是的，它足够安全。虽然我同意在查询字符串中包含诸如此类的内容通常不是一个好主意，但如果它不是将显示在地址栏中的查询字符串，则可以。如果它显示在地址栏中，您会因为明显的原因失去一定程度的安全性（路过的人等）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-23T08:41:37.693

ssl 检查器可以打开 ssl 流量 [http://www.ssl-inspector.com/files/file/SSL%20Inspector%20Appliance%20Product%20Brief%20(2-11).pdf](http://www.ssl-inspector.com/files/file/SSL%20Inspector%20Appliance%20Product%20Brief%20(2-11).pdf)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T10:44:06.870

你永远不应该使用查询字符串发送任何非常敏感的东西！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T10:46:38.987

不应该发送散列密码吗？- 没关系，如果我错了。

SSL 几乎是您可以获得的最高安全性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-13T11:10:53.797

自签名证书是由您自己创建和签名的 SSL 证书。这意味着您不需要第三方证书颁发机构 (CA) 来签署您的证书，*但这*意味着浏览器默认情况下会发出警告，因为自签名证书不能可靠（您的浏览器有一个列表受信任的 CA）验证证书的签名者是否正是证书所说的。

考虑一下您“代表”某个基于 Redmond 的软件公司创建 SSL 证书的情况。现在，如果您的 HTTP 服务器将您自签名的证书提供给客户端，用户代理将警告该证书实际上可能不是它所说的那个证书。证书颁发机构将验证 - 通过文书工作，真实的，实际的死树类型 - 请求签名的一方的身份，因此它是可信赖的。

希望这可以帮助。

# c# - Rebinding Report to new XML XSD

> ID：190772
> 
> 赞同：6
> 
> 时间：2008-10-10T10:42:21.820
> 
> 标签：c#, xml, crystal-reports, xsd, report

I cannot for the life of me find an example of what I need.

I have a report that is bound by **xsd**. How can I take this report in **c#**, and set the datasource to a new **xml** file? Every possible way that I've tried just throws me a nice logon screen. I know the files exists in the places that it is looking, and there is obviously no *username* and *password* to an **xml/xsd** file.

Anyone have any kind of advice on the subject? I dont understand why this isn't done more often and why no one can give me a straight answer. I can post some example code if anyone needs.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-03-21T17:04:20.737

基于 XSD 的报告仅用于设计目的。

它以这种方式设计，以便我们可以填充数据集并执行数据绑定 PUSH MODEL 方式。

XSD 不能有登录信息，因为它既不是数据源，也没有任何身份验证能力。

您可以发送到报告的内容仅受可以放入数据集中的内容的限制。您可以将 XML 中的数据填充到数据集中并将其绑定到报表。

# php - 产生真实单词的词干算法

> ID：190775
> 
> 赞同：36
> 
> 时间：2008-10-10T10:43:29.290
> 
> 标签：php, nlp, stemming, snowball, porter-stemmer

我需要提取一段文本并从中提取“标签”列表。其中大部分是非常直接的。但是，我现在需要一些帮助来阻止生成的单词列表以避免重复。示例：社区/社区

我使用了 Porter Stemmer 算法的实现（顺便说一下，我正在用 PHP 编写）：

[http://tartarus.org/~martin/PorterStemmer/php.txt](http://tartarus.org/~martin/PorterStemmer/php.txt)

这在一定程度上有效，但不会返回“真实”单词。上面的例子源于“commun”。

我试过“Snowball”（在另一个 Stack Overflow 线程中建议）。

[http://snowball.tartarus.org/demo.php](http://snowball.tartarus.org/demo.php)

对于我的示例（社区/社区），Snowball 源于“communiti”。

**问题**

有没有其他的词干算法可以做到这一点？有没有其他人解决过这个问题？

*我目前的想法是，我可以使用词干算法来避免重复，然后选择我遇到的最短单词作为要显示的实际单词。*

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-05T15:26:20.830

如果我理解正确，那么您需要的不是词干分析器，而是词形还原器。Lemmatizer 是一个了解诸如*-ies*、*-ed*等结尾以及诸如*written*等特殊词形的知识的工具。Lemmatizer 将输入词形映射到它的引理，这保证是一个“真实”的词。

英语有很多词形还原器，但我只使用过`morpha`。 *Morpha*只是一个大的 lex 文件，您可以将其编译成可执行文件。使用示例：

```
$ cat test.txt 
Community
Communities
$ cat test.txt | ./morpha -uc
Community
Community 
```

您可以从[http://www.informatics.sussex.ac.uk/research/groups/nlp/carroll/morph.html获得 morpha](http://www.informatics.sussex.ac.uk/research/groups/nlp/carroll/morph.html)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-10T11:22:12.283

这里的核心问题是词干算法完全基于语言的拼写规则在~~语音基础上运行，而没有真正理解它们正在使用的语言。~~要生成真实单词，您可能必须将词干分析器的输出与某种形式的查找函数合并，以将词干转换回真实单词。我基本上可以看到两种可能的方法：

1.  找到或创建一个大字典，将每个可能的词干映射回一个实际的单词。（例如，communiti -> 社区）
2.  创建一个函数，将每个词干与简化为该词干的单词列表进行比较，并尝试确定哪个最相似。（例如，将“communiti”与“community”和“communities”进行比较，以使“community”被认为是更相似的选项）

就个人而言，我认为我会做的方式是＃1的动态形式，通过记录检查的每个单词及其词干，然后假设最常见的单词是应该的单词来建立自定义词典数据库用过的。（例如，如果我的源文本主体使用“communities”比“community”更频繁，则映射communiti -> community。）基于字典的方法通常会更准确，并且基于词干输入构建它会提供结果根据您的文本定制，主要缺点是所需的空间，现在这通常不是问题。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-06-06T11:52:39.527

嘿，我不知道这是否为时已晚，但只有一个 PHP 词干提取脚本可以生成真实的单词：[http](http://phpmorphy.sourceforge.net/) ://phpmorphy.sourceforge.net/——我花了很长时间才找到它。所有其他词干分析器都必须进行编译，甚至在编译之后它们也只能根据 Porter 算法工作，该算法产生词干，而不是引理（即社区 = 社区）。PhpMorphy one 运行良好，易于安装和初始化，并具有英语、俄语、德语、乌克兰语和爱沙尼亚语词典。它还附带一个脚本，您可以使用它来编译其他字典。文档是俄文的，但是通过谷歌翻译，应该很容易。

# mysql - 如何在 MySQL 存储过程中使用动态 SQL

> ID：190776
> 
> 赞同：69
> 
> 时间：2008-10-10T10:43:32.627
> 
> 标签：mysql, dynamic

如何在 MySQL 存储过程中构建和使用动态 sql？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2011-04-20T09:25:54.017

5.0.13之后，在存储过程中，可以使用动态SQL：

```
delimiter // 
CREATE PROCEDURE dynamic(IN tbl CHAR(64), IN col CHAR(64))
BEGIN
    SET @s = CONCAT('SELECT ',col,' FROM ',tbl );
    PREPARE stmt FROM @s;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END
//
delimiter ; 
```

动态 SQL 在函数或触发器中不起作用。有关更多用途，请参阅[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-prepared-statements.html)。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-10-10T11:56:47.990

我不相信 MySQL 支持动态 sql。您可以执行类似但不同的“准备好的”语句。

这是一个例子：

```
mysql> PREPARE stmt FROM 
    -> 'select count(*) 
    -> from information_schema.schemata 
    -> where schema_name = ? or schema_name = ?'
;
Query OK, 0 rows affected (0.00 sec)
Statement prepared
mysql> EXECUTE stmt 
    -> USING @schema1,@schema2
+----------+
| count(*) |
+----------+
|        2 |
+----------+
1 row in set (0.00 sec)
mysql> DEALLOCATE PREPARE stmt; 
```

准备好的语句通常用于查看给定查询的执行计划。由于它们是使用**执行**命令执行的，并且**sql**可以分配给一个变量，因此您可以近似一些与动态 sql 相同的行为。

这是一个很好的[链接](http://rpbouman.blogspot.com/2005/11/mysql-5-prepared-statement-syntax-and.html)：

不要忘记`stmt`使用最后一行解除分配！

祝你好运！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-12-16T13:43:42.063

**您可以使用用户定义的变量在动态语句之外传递**

```
Server version: 5.6.25-log MySQL Community Server (GPL)

mysql> PREPARE stmt FROM 'select "AAAA" into @a';
Query OK, 0 rows affected (0.01 sec)
Statement prepared

mysql> EXECUTE stmt;
Query OK, 1 row affected (0.01 sec)

DEALLOCATE prepare stmt;
Query OK, 0 rows affected (0.01 sec)

mysql> select @a;
+------+
| @a   |
+------+
|AAAA  |
+------+
1 row in set (0.01 sec) 
```

# refactoring - make bad code good

> ID：190781
> 
> 赞同：1
> 
> 时间：2008-10-10T10:44:37.523
> 
> 标签：refactoring, coding-style

I got myself reading a article regarding changing the existing bad code into a good one. For reference, this is the link to the article [http://www.javaworld.com/jw-03-2001/jw-0323-badcode.html?page=1](http://www.javaworld.com/jw-03-2001/jw-0323-badcode.html?page=1)

It broadly talked about the following

*   Add comments

*   Re-Factoring Code

    *   Break large classes into smaller classes
    *   Break large functions into smaller functions
    *   Change code which is difficult to understand
*   Use Layered architecture

Seems good. Any addons to this list which you all may have come across ?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T10:46:49.843

Before doing any refactoring, ensure you have a suite of regression tests that you can run on the code. It's no good refactoring your code base if you then introduce thousands of regression bugs due to missing a slight nuance to what the original 'bad' code was actually doing (and missing it out in the refactoring).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T10:47:55.457

Regarding comments, it's good practise to use JavaDocs. It's like building documentation as you code.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T10:55:41.463

Martin Fowler wrote an excellent book on refactoring.

[Here is the catalog of refactorings from the book.](http://www.refactoring.com/catalog/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T02:38:28.303

确保您拥有一整套回归测试！

抓住 FindBugs、PMD 等，开始看看他们要说什么。我倾向于发现报告最多 Findbugs 错误的类有很多问题，并且是开始重构工作的好地方。

另一个值得一看的工具是 STAN4J，它会生成结构指标，向您展示代码设计真正可以改进的地方。它将检测脆弱的继承层次结构、糟糕的抽象等。这些肯定是任何重构工作的目标。

值得始终关注这些工具，如果您学会如何解释他们对您说的话，它们将极大地帮助您。

还要注意您的 IDE 的警告，它们的存在是有原因的。

*   我不隶属于任何这些工具提供商（即使它们是免费的），但是我确实经常使用它们并且对它们印象深刻！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T10:47:43.930

Read it and tinker with it, commenting as you go, so that you understand fully it before you permanently change any code.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T10:51:16.310

Most code can be refactored from the high-level interface (and creating one of these could be a good start for any refactoring project).

It's not worth reimplementing from scratch, because the old code might have lots of special cases or workaround or non-documented but necessary behaviour. Therefore always use the existing code as a basis for refactoring.

Document as you learn the existing codebase by adding in JavaDocs and comments. This can form the basis of your redesign later on as you understand what the code does.

It can be that simply refactoring and changing variable names can aid readability a lot. Always look to do simpler refactorings if possible, especially if the code works and is just a little hard to maintain due to these simple issues.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T21:20:02.003

问问自己为什么要重构代码。代码需要摸吗？通过改进它很容易破坏脆弱的代码。

如果您决定需要更改代码，那么正如其他人提到的那样，拥有一套测试将有很大帮助。

查看您正在修改的文件的修订历史记录，并查看是否已进行任何更改以修复错误，这样您就可以避免重新编写这些错误。

如果您出于性能原因重构代码，请留意算法改进。*如果您可以在代码的热门*部分将 O(n^2) 算法更改为 O(n log(n)) ，那么与其他任何数量的小更改相比，这可以为您的代码做更多的事情。

# asp.net - .net Framework 3.5 中新解释的概念

> ID：190803
> 
> 赞同：0
> 
> 时间：2008-10-10T10:50:16.623
> 
> 标签：asp.net, .net-3.5

我们在 .net Framework 2.0 中开发了我们的网站（业务用户网站），我们的客户将我们迁移到 .net Framework 3.5。我对在这两个框架中开发相同的东西不感兴趣。

请任何人告诉我一些新功能，例如.net framework 3.5 中的卡片空间、工作流程、演示基础概念以及我们将如何在实时环境中使用它。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T11:10:33.103

您可以将您的网站迁移到 .Net 3.5，而无需更改任何代码。根据您使用的语言，3.5 中有几个新功能可以大大简化您的代码。这不一定是全有或全无的命题。我建议您利用对新代码有意义的功能，但保留旧代码，直到有时间/金钱来转换它。一些新功能包括：

Linq（Linq to SQL 和 Linq to XML 是主要的变体）、自动实现的属性、隐式类型、对象初始化器、集合初始化器、匿名类型、lambda 表达式和扩展方法是主要的语言新特性。

# flash - 如何在 Flash 中实现开发人员的可扩展性和代码重用？

> ID：190805
> 
> 赞同：1
> 
> 时间：2008-10-10T10:50:35.173
> 
> 标签：flash, code-reuse

到目前为止，我已经涉足 Flash 做 1-man 节目很长一段时间，但从未用它做过任何大型项目，实际上源代码管理和代码重用是真正必要的。然而，我正在考虑将 Flash 用于一个新项目，但这次它不会是一个单人表演，那时我突然意识到我没有经验应该如何使用 Flash 做到这一点。

有哪些好的技巧或资源可以帮助我们找出一个好的工作流程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T14:06:26.153

*   良好的沟通
*   不要在 .fla 中工作。.as 文件中 100% 的代码
*   UML（至少讨论过）
*   每个人的不同任务
*   代码库提交中的注释
*   “管理您的代码，以便任何人都可以随时接管您的工作”
*   考虑[总线因素](http://en.wikipedia.org/wiki/Bus_factor)

对于初级开发人员来说，了解包结构等基本内容也很好，这样每个人都在同一个页面上。

我认为如果有人有点像项目的技术经理，监督开发人员正在做的事情，那也很好。它也可能是开发人员之一，但我认为拥有一个知道其他人在做什么的人很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-12T09:08:37.207

Antti 有很多优秀的代码，特别是外部化代码和任命领导者，我只想补充一点，当你为每个人选择不同的任务时，告诉人们将他们的作品编码为模块化类，提供你将要使用的功能需要 - 这将使代码在未来更可重用，并使集成更顺畅。

# cvs - "read lock failed" at cvs annotate

> ID：190809
> 
> 赞同：1
> 
> 时间：2008-10-10T10:51:40.100
> 
> 标签：cvs, locking, annotate

I am trying to use cvs annotate. This is the what I run:

```
cvs -d /mycvs/cvsroot/ annotate "projects/dg/SomeClass.java" 
```

However, I get the following error:

```
cvs annotate: failed to create lock directory for `/mycvs/cvsroot/projects/dg^M' (/mycvs/cvsroot/projects/dg^M/#cvs.lock): No such file or directory
cvs annotate: failed to obtain dir lock in repository `/mycvs/cvsroot/projects/dg^M'
cvs [annotate aborted]: read lock failed - giving up 
```

What does this mean? How can I overcome this problem? Could it be related to the ^M character I see at the error message?

When I use eclipse to do the annotation it works. I checked and the directory `/mycvs/cvsroot/projects/dg' exists. The error also occurs when I'm logged in as root, so probably it's not a permissions issue either.

I am using CentOS

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T10:55:33.010

From your description, I would guess that you've got it right with the stray ^M. What OS are you using? If Windows, are you using cygwin? I see you're using direct filesystem access to the repository. Might you consider setting up a server access mechanism like pserver to see if that helps?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T14:43:52.527

我也遇到了 cygwin 的这个问题。事实上，我可以使用 eclipse cvs 工具对 pserver 进行身份验证。但是，cygwin ......不是那么多。

以下是一些可能相关的帖子：http: [//www.sat-industry.net/forums/dreambox-development/19893-checkout-failed-create-lock-directory.html](http://www.sat-industry.net/forums/dreambox-development/19893-checkout-failed-create-lock-directory.html)

总结：添加环境变量：CVS_RSH=ssh

[http://www.mooreds.com/wordpress/archives/000234](http://www.mooreds.com/wordpress/archives/000234) 摘要：您可能对 CVS 服务器的权限有配置问题。

顺便说一句，这些都不适合我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-21T22:10:35.597

您似乎正在使用 CygWin 进行 CVS，但使用使用 Windows 行结束的文本编辑器触及了 CVS/Root 文件，或者使用使用 Windows 行结束的 CVS 客户端进行了初始签出。尽管您可以将客户端混合和匹配到同一个存储库，但有时将客户端（CygWin/WinCVS）与同一个工作副本混合和匹配是不好的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-29T20:25:43.767

您可能想尝试使用“本地”存储库：

cvs -d :local:/mycvs/cvsroot/ 注释“projects/dg/SomeClass.java”

看看是否能解决问题。

我经常使用 cygwin 和 cvs，虽然有时会收到以下错误消息：“cvs [checkout aborted]: cannot rename file CVS/Entries.Backup to CVS/Entries: Permission denied” 我只是重新运行结帐，看起来还不错. 我调查了这个错误，它与 Windows 中的文件系统争用有关（防病毒软件，IIRC）。

# dbunit - DBUnit Data Export

> ID：190813
> 
> 赞同：1
> 
> 时间：2008-10-10T10:52:51.580
> 
> 标签：dbunit

Does anyone know if dbunit has the power to export specific data from multiple tables at once based on a sql statement, as can be done by using dbunit's QueryDataSet class to export data from a single table based on a sql statement, [as can been seen here](http://www.dbunit.org/faq.html#extract).

James

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-17T18:58:31.260

[http://jailer.sourceforge.net/](http://jailer.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-26T12:45:34.610

是的，它可以。您只需调用 addTable(...) 方法将数据收集到 QueryDataSet 并通过 FlatXmlDataSet.write(...) 导出

```
QueryDataSet partialDataSet = new QueryDataSet(connection);
partialDataSet.addTable(tableName1, "select * from " + tableName1);
partialDataSet.addTable(tableName2, "select * from " + tableName2);
partialDataSet.addTable(tableName3, "select * from " + tableName3);

FileOutputStream fos = new FileOutputStream("Noname.dataset");
FlatXmlDataSet.write(ratingDataSet, fos); 
```

# asp.net - Getting the Bound Field Name at Run Time in ASP.NET

> ID：190816
> 
> 赞同：0
> 
> 时间：2008-10-10T10:53:34.260
> 
> 标签：asp.net, .net, data-binding

If I have a control, within a FormView, that is bound using a `<% #Bind(...)%>` expression. At run time, is there any way of retrieving the name of the field the control is bound to.

To be clear, if the expression is `<% #Bind("UserName") %>`

I want to return the string `"UserName"`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T11:13:42.537

在调试中大量搞乱之后，我发现这是可行的

```
((System.Web.UI.WebControls.AutoGeneratedField)((System.Web.UI.WebControls.DataControlFieldCell)(e.Row.Cells[0])).ContainingField).SortExpression 
```

在调试中使用 shift+F9 打开快速观察窗口痛苦并直观地探索您的事件参数

# cocoa - Why can I select aliases but not symbolic links in NSOpenPanel?

> ID：190818
> 
> 赞同：0
> 
> 时间：2008-10-10T10:54:14.277
> 
> 标签：cocoa, macos

I want to create an `NSOpenPanel` that can select any kind of file, so I do this

```
NSOpenPanel*    panel = [NSOpenPanel openPanel];

if([panel runModalForTypes:nil] == NSOKButton) {
    // process files here
} 
```

which lets me select all files *except* symbolic links.
They're simply not selectable and the obvious `setResolvesAliases`
does nothing.

What gives?

**Update 1:** I did some more testing and found that this strangeness
is present in Leopard (10.5.5) but not in Tiger (10.4.8).

**Update 2:** The code above can select mac aliases (persistent path
data that lives in the resource fork) but not symlinks (files created with ln -s).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T15:49:58.410

我无法重现这一点。我刚试了一下，效果很好。如果符号链接指向一个目录，它会在我选择符号链接时显示目录内容，如果符号链接指向一个文件，我也可以选择它。

当然如果符号链接指向一个目录，你只能在允许选择目录的情况下选择它

```
NSOpenPanel * panel = [NSOpenPanel openPanel];
[panel setCanChooseDirectories:YES];
if ([panel runModalForTypes:nil] == NSOKButton) {
    NSLog(@"%@", [panel filenames]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T23:20:06.613

您的代码示例也对我有用——如果重要的话，我使用的是 10.5.5 和 XCode 3.1。

如果别名指向目录，我无法选择别名，因为它解析为它指向的目录，而不是别名本身（面板似乎默认解析别名）。不过，我能够为文件选择别名。

# flash - Flash 标准库？

> ID：190819
> 
> 赞同：1
> 
> 时间：2008-10-10T10:54:50.827
> 
> 标签：flash, code-reuse, standard-library

对于一个使用 Flash 的新项目，我一直在寻找符合基本编程需求的标准库，以及 Python 或 Ruby 标准库。但我唯一发现的是 Sourceforge 上的一个死项目。

因此没有闪存的标准库吗？每个人每次都重新发明轮子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T11:05:24.440

基本库内[置于 flash](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/)中。然后最重要的是[flex](http://www.adobe.com/products/flex/)，它为您提供了一个完整的 RIA 框架。然后是[3d](http://blog.papervision3d.org/)的 3rd 方框架、[物理引擎](http://box2dflash.sourceforge.net/)、各种设计模式（[MVC](http://puremvc.org/component/option,com_wrapper/Itemid,160/)、[IoC](http://www.herrodius.com/blog/64)等）等等。

所以不，你不要每次都重新发明轮子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T11:08:36.617

假设我正确理解您的问题，[Flash Player API](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/)`flash.*`是 Fl​​ash 应用程序（包）的“标准库” 。

对于更多面向应用程序编程的库，有[Flex 标准库](http://livedocs.adobe.com/flex/3/langref/)（`mx.*`包）。

# c# - C# controls in a MFC Application

> ID：190830
> 
> 赞同：3
> 
> 时间：2008-10-10T10:59:44.560
> 
> 标签：c#, .net, c++, user-interface, interop

I am responsible for the User Interface of an application written completely in Visual C++ using MFC and some third-part controls. I would like to use C# (WinForms or even better WPF) to improve the application look&feel.

I would like some advices about how to do it. Links, articles, examples...

Right now the user interface is isolated in a single project and I don't want to compile the whole module with CLR. So how do I have to manage that from the architectural point of view?

I have already looked at the Internet for the subject and read MSDN information. I would like more detailed information...is it convinient? pros/cons? have you used this approach successfully in a "big" application? I don't want to compile the whole ui project with CLR...can I just have all the .NET code in a isolated project and call it from the ui project? what's the best way to do it?

Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T11:03:12.340

A good starting point is the [Win32 and WPF interop](http://msdn.microsoft.com/en-us/library/ms742522.aspx) page on MSDN.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T11:06:49.320

I found [this](http://www.codeproject.com/KB/miscctrl/mfcdialogwinforms.aspx) codeproject article gave a good introduction to the subject of mixing mfc / winforms code.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T13:39:57.720

当遇到同样的问题时，我用 C# 制作了一个 ActiveX 控件并在我的 MFC 应用程序中使用它。MS 的人员支持使用 .NET 构建 ActiveX 控件，但仍然可以使用具有自定义`[ComRegisterFunction()]`和`[ComUnregisterFunction]`.

尽管 MS 想告诉我们 /clr 标志将解决我们的问题，但它明显减慢了我的大型 MFC 应用程序的速度。

# java - 是否可以添加到请求的可用参数（HttpServletRequest）

> ID：190833
> 
> 赞同：10
> 
> 时间：2008-10-10T11:00:24.497
> 
> 标签：java, http, servlets

我想在过滤器/servlet 中拦截一个请求并添加一些参数。但是，该请求没有公开“setParameter”方法，并且在操作参数映射时会抛出一个错误，说明它已被锁定。有没有我可以尝试的替代方案？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-10T11:12:34.177

子类[`HttpServletRequestWrapper`](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/http/HttpServletRequestWrapper.html)化并覆盖`getParameter`方法。这个类的描述如下：

> 提供 HttpServletRequest 接口的便捷实现，希望将请求适应 Servlet 的开发人员可以将其子类化。

在过滤器中，将请求包装在子类的实例中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-10T11:10:08.673

我通常将原始 HttpServletRequest 包装到一个新的 CustomHttpServletRequest 中，它充当原始请求的代理，然后将这个新的 CustomHttpServletRequest 传递给过滤器链。

在此 CustomHttpServletRequest 中，您可以覆盖 getParameterNames、getParameter、getParameterMap 方法以返回您想要的任何参数。

这是过滤器的示例：

```
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
    HttpServletRequest httpRequest = (HttpServletRequest) request;
    HttpServletRequest customRequest = new CustomHttpServletRequest(httpRequest);
    customRequest.addParameter(xxx, "xxx");
    chain.doFilter(customRequest, response);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T11:08:33.513

首先，您应该收到请求并读取其所有参数。然后用原始参数+新参数构造另一个请求并再次发送。

HttpServletRequest 是不可变的，没有办法改变它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-12T17:11:45.617

您可以将 HttpServletRequest 包装到新的 HttpServletRequestWrapper 对象中并覆盖一些方法。

以下代码来自[http://www.ocpsoft.org/opensource/how-to-safely-add-modify-servlet-request-parameter-values/](http://www.ocpsoft.org/opensource/how-to-safely-add-modify-servlet-request-parameter-values/)。

在过滤器中添加参数：

```
public class MyFilter implements Filter {
...
@Override
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
    if (request instanceof HttpServletRequest) {
        HttpServletRequest httprequest = (HttpServletRequest) request;
        Map<String, String[]> extraParams = new HashMap<String, String[]>();
        extraParams.put("myparamname", String[] { "myparamvalue" });
        request = new WrappedRequestWithParameter(httprequest, extraParams);
    }
    chain.doFilter(request, response);
}
...

class WrappedRequestWithParameter extends HttpServletRequestWrapper {
    private final Map<String, String[]> modifiableParameters;
    private Map<String, String[]> allParameters = null;

    public WrappedRequestWithParameter(final HttpServletRequest request, final Map<String, String[]> additionalParams) {
        super(request);
        modifiableParameters = new TreeMap<String, String[]>();
        modifiableParameters.putAll(additionalParams);
    }

    @Override
    public String getParameter(final String name) {
        String[] strings = getParameterMap().get(name);
        if (strings != null) {
            return strings[0];
        }
        return super.getParameter(name);
    }

    @Override
    public Map<String, String[]> getParameterMap() {
        if (allParameters == null) {
            allParameters = new TreeMap<String, String[]>();
            allParameters.putAll(super.getParameterMap());
            allParameters.putAll(modifiableParameters);
        }
        // Return an unmodifiable collection because we need to uphold the interface contract.
        return Collections.unmodifiableMap(allParameters);
    }

    @Override
    public Enumeration<String> getParameterNames() {
        return Collections.enumeration(getParameterMap().keySet());
    }

    @Override
    public String[] getParameterValues(final String name) {
        return getParameterMap().get(name);
    }
}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-12T13:32:08.297

为什么不将变量存储为请求范围属性，而不是尝试将它们附加到请求参数？

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-10T12:48:22.397

否则，您可以使用强类型的 setAttribute() 方法。因此，可以使用 getAttribute() 方法...

# java - 您使用哪些 JDBC 工具来同步数据源？

> ID：190838
> 
> 赞同：13
> 
> 时间：2008-10-10T11:01:53.107
> 
> 标签：java, database, jdbc, synchronization

我希望找出人们用来在数据库之间同步数据的工具。我正在寻找可以用作命令行工具的 JDBC 解决方案。

曾经有一个名为 Sync4J 的工具使用 SyncML 框架，但这似乎已经被淘汰了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T11:23:12.860

听说 Db4O 提供的 Data Replication Service 非常好。它允许您使用 Hibernate 回到 RDBMS - 我认为它不支持 JDBC（[http://www.db4o.com/about/productinformation/drs/Default.aspx?AspxAutoDetectCookieSupport=1](http://www.db4o.com/about/productinformation/drs/Default.aspx?AspxAutoDetectCookieSupport=1)）

有一个开源项目叫Daffodil，但我完全没有研究过。( [https://daffodilreplicator.dev.java.net/](https://daffodilreplicator.dev.java.net/) )

我目前正在考虑使用的一个叫做 SymmetricDS ( [http://symmetricds.sourceforge.net/](http://symmetricds.sourceforge.net/) )

还有其他人，他们每个人的做法都略有不同。有些使用触发器，有些使用轮询，有些使用拦截 JDBC 驱动程序。您需要确定您所受的技术限制，以确定您真正想要使用的限制。

Wikipedia 很好地概述了不同的技术（[http://en.wikipedia.org/wiki/Multi-master_replication](http://en.wikipedia.org/wiki/Multi-master_replication)），还提供了另一个替代 DBReplicator 的链接（[http://dbreplicator.org/](http://dbreplicator.org/)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T11:43:35.210

如果您的代码库已经存在模型和 DAO 层，您可以创建自己的同步框架，这并不难。

复制数据很简单：

1.  从数据库 A 中读取一个对象
2.  删除数据库元数据（uuid 等）
3.  插入数据库 B

同步对已经同步的内容有一定程度的了解。您可以在运行时通过从 TableInA 和 TableInB 获取 uuid 列表并确定哪些条目是新条目来执行此操作，或者您可以拥有需要同步的项目表（在 TableInA 中插入/更新时使用触发器填充） ，并从中运行。您的工具可以是 TimerTask，以便数据库以您希望的时间粒度保持同步。

然而，可能有一些工具可以在没有任何这种实现的情况下完成这一切，而且每种实现都会根据业务需求而有所不同。此外，在数据库级别还会有复制工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-12T23:59:31.277

真正的同步需要一些我希望您的数据库架构拥有的数据（您可以阅读 SyncML 文档以了解它们是如何进行的）。Sync4J 对您帮助不大，它确实是高级且面向 XML 的。如果您没有预见到任何冲突（这意味着：非常容易同步），您可以尝试使用像[Enhydra Octopus](http://www.enhydra.org/tech/octopus/index.html)这样的轻量级 ETL 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T09:44:33.993

我目前主要使用 Oracle，我遇到的功能最全的路线是 Red Gate 的 Data Compare：

[http://www.red-gate.com/products/oracle-development/data-compare-for-oracle/](http://www.red-gate.com/products/oracle-development/data-compare-for-oracle/)

这个旧博客很好地总结了可用的解决方案路线：

[http://www.novell.com/coolsolutions/feature/17995.html](http://www.novell.com/coolsolutions/feature/17995.html)

我遇到的特定于 JDBC 的产品非常基础。如果您想沿着发布-订阅路线走下去，Aidos 提到的解决方案似乎功能最完整：

[http://symmetricds.codehaus.org/](http://symmetricds.codehaus.org/)

希望这可以帮助。

# php - 通过 AJAX 动态添加一些内容后，如何将当前页面转换为 pdf？

> ID：190840
> 
> 赞同：4
> 
> 时间：2008-10-10T11:02:14.320
> 
> 标签：php, ajax, pdf

我在 PHP 中找到了一些可以完成这项工作的库或 Web 服务。问题是当页面完全加载时转换完成，我想在 onload 事件中**通过 AJAX 动态添加一些内容后将****页面转换为 PDF 。**

 **非常感谢，奥马尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T11:23:25.777

您可以发回`document.getElementsByTagName('html')[0].innerHTML`服务器（可能使用 AJAX）并从中生成 PDF。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T11:04:44.240

当您使用 AJAX 添加内容时，这只发生在客户端机器上，因此服务器端 PHP 转换代码将无法使用它。如果您想在服务器上创建 PDF，您需要提供一种包含动态内容的服务器端方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T11:20:38.793

在添加动态内容后，您可以实现一个 AJAX 调用，将页面内容/状态发送回服务器端，在那里它可以呈现为 pdf。您可能不需要所有页面，具体取决于此“动态内容”的去向。

看起来有点乱，但在不了解项目的情况下，很难说是否有更清洁的方法来做你想做的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T11:08:57.473

由于 Ajax 的情况，这是客户端的要求。如果他们使用的是 Mac，他们可以简单地保存为 PDF，否则您几乎无法控制他们可以做什么。

但是，对于服务器端实现，您可以做的是记录页面及其自加载该页面以来的所有 AJAX 请求，并在请求时根据该记录在服务器上构造 HTML 和 PDF。当然，这不是一项简单的任务，而且相当矫枉过正。您最好使用不同的机制来创建页面的服务器端 PDF 报告，而不是将 HTML 转换为 PDF。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T11:26:38.860

如果您的页面可以仅在客户端上更新而无需访问服务器，则您必须重新发布到您的应用程序。这样，您将拥有所有内容并且不会进行重建，如果只有客户端交互，这是不可能的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T11:54:20.290

哇，谢谢大家，我不知道这是社区如此活跃。要回答有关该项目的 Beepcake：

当页面加载时，应用程序通过 AJAX 请求从 40 多个服务器检索生物信息，然后显示一个独特的视图，您可以在其中使用许多选项来操作图形。

因此，当用户制作自己的图形版本时，打印出来是一件很酷的事情。我认为最好的解决方案是使用*document.getElementsByTagName('html')[0].innerHTML*发布整个 HTML，正如 RoBorg 所说，然后使用 dompdf 等库生成*PDF*

# javascript - 如何使用 JavaScript 获取文件扩展名？

> ID：190852
> 
> 赞同：626
> 
> 时间：2008-10-10T11:08:05.090
> 
> 标签：javascript, file-extension

见代码：

```
var file1 = "50.xsl";
var file2 = "30.doc";
getFileExtension(file1); //returns xsl
getFileExtension(file2); //returns doc

function getFileExtension(filename) {
    /*TODO*/
} 
```

* * *

## 回答 #1

> 赞同：1028
> 
> 时间：2008-10-10T11:18:02.933

**较新的编辑：**自从这个问题最初发布以来，很多事情都发生了变化——在[wallacer 的修订答案](https://stackoverflow.com/a/1203361/23746)以及[VisioN 的优秀细分中有很多非常好的信息](https://stackoverflow.com/a/12900504/23746)

* * *

**编辑：**仅仅因为这是公认的答案；[华莱士的回答](https://stackoverflow.com/a/1203361/23746)确实要好得多：

```
return filename.split('.').pop(); 
```

* * *

我的旧答案：

```
return /[^.]+$/.exec(filename); 
```

应该这样做。

**编辑：**为了回应 PhiLho 的评论，请使用以下内容：

```
return (/[.]/.exec(filename)) ? /[^.]+$/.exec(filename) : undefined; 
```

* * *

## 回答 #2

> 赞同：997
> 
> 时间：2009-07-29T22:12:08.347

```
return filename.split('.').pop(); 
```

**编辑：**

这是我认为更有效的另一种非正则表达式解决方案：

```
return filename.substring(filename.lastIndexOf('.')+1, filename.length) || filename; 
```

[下面VisioN 的回答](https://stackoverflow.com/a/12900504/1249581)可以更好地处理一些极端情况，特别是没有扩展名的文件（`.htaccess`包括等）。

`""`它非常高效，并且可以通过在点之前没有点或没有字符串时返回而不是完整的字符串来以更好的方式处理极端情况。这是一个精心设计的解决方案，尽管很难阅读。把它放在你的助手库中，然后使用它。

**旧编辑：**

如果您要遇到没有扩展名的文件或没有扩展名的隐藏文件（请参阅上面的 VisioN 对 Tom 的回答的评论），那么更安全的实现将是这样的

```
var a = filename.split(".");
if( a.length === 1 || ( a[0] === "" && a.length === 2 ) ) {
    return "";
}
return a.pop();    // feel free to tack .toLowerCase() here if you want 
```

如果`a.length`是一个，它是一个没有扩展名的可见文件，即。*文件*

如果它是一个没有扩展名的隐藏文件，即`a[0] === ""`。*.htaccess*`a.length === 2`

 *这应该可以解决稍微复杂一些的问题。在性能方面，我认为这个解决方案在大多数浏览器中[都比正则表达式慢一点。](https://stackoverflow.com/a/12900504/1249581)然而，对于最常见的目的，这段代码应该是完全可用的。

* * *

## 回答 #3

> 赞同：349
> 
> 时间：2012-10-15T17:04:31.393

以下解决方案足够**快**且足够**短**，可用于批量操作并节省额外字节：

```
 return fname.slice((fname.lastIndexOf(".") - 1 >>> 0) + 2); 
```

这是另一种单行非正则表达式通用解决方案：

```
 return fname.slice((Math.max(0, fname.lastIndexOf(".")) || Infinity) + 1); 
```

两者都可以在没有扩展名的名称（例如*myfile*）或以`.`点开头（例如*.htaccess*）的情况下正常工作：

```
 ""                            -->   ""
 "name"                        -->   ""
 "name.txt"                    -->   "txt"
 ".htpasswd"                   -->   ""
 "name.with.many.dots.myext"   -->   "myext" 
```

如果您关心速度，您可以运行[**基准测试**](http://jsperf.com/extract-file-extension)并检查提供的解决方案是最快的，而短的解决方案非常快：

![速度比较](https://i.stack.imgur.com/ZL8Bn.png)

*短的如何工作：*

1.  [`String.lastIndexOf`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/lastIndexOf)方法返回`"."`给定字符串 (ie `fname`) 中子字符串 (ie ) 的最后位置。如果未找到子字符串，则方法返回`-1`。
2.  文件名中 dot 的“不可接受”位置是`-1`和`0`，它们分别指没有扩展名的名称（例如`"name"`）和以点开头的名称（例如`".htaccess"`）。
3.  [零填充右移运算符](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Unsigned_right_shift)( `>>>`) 如果与零一起使用会影响负数转换`-1`为`4294967295`和`-2`，`4294967294`这对于在边缘情况下保持文件名不变（这里有点技巧）很有用。
4.  [`String.prototype.slice`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/slice)从按照描述计算的位置提取文件名的一部分。如果位置编号大于字符串方法的长度，则返回`""`。

* * *

如果您想要以相同方式工作的更清晰的解决方案（加上对完整路径的额外支持），请检查以下扩展版本。此解决方案将比以前的单行方案*慢，但更容易理解。*

```
function getExtension(path) {
    var basename = path.split(/[\\/]/).pop(),  // extract file name from full path ...
                                               // (supports `\\` and `/` separators)
        pos = basename.lastIndexOf(".");       // get last position of `.`

    if (basename === "" || pos < 1)            // if file name is empty or ...
        return "";                             //  `.` not found (-1) or comes first (0)

    return basename.slice(pos + 1);            // extract extension ignoring `.`
}

console.log( getExtension("/path/to/file.ext") );
// >> "ext" 
```

所有三个变体都应该在客户端的任何 Web 浏览器中工作，并且也可以在服务器端 NodeJS 代码中使用。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2008-10-10T11:44:52.197

```
function getFileExtension(filename)
{
  var ext = /^.+\.([^.]+)$/.exec(filename);
  return ext == null ? "" : ext[1];
} 
```

经测试

```
"a.b"     (=> "b") 
"a"       (=> "") 
".hidden" (=> "") 
""        (=> "") 
null      (=> "") 
```

还

```
"a.b.c.d" (=> "d")
".a.b"    (=> "b")
"a..b"    (=> "b") 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2011-10-26T20:45:28.130

```
function getExt(filename)
{
    var ext = filename.split('.').pop();
    if(ext == filename) return "";
    return ext;
} 
```

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2018-10-10T10:32:38.590

模块中有一个标准库函数`path`：

```
import path from 'path';

console.log(path.extname('abc.txt')); 
```

输出：

> 。文本文件

所以，如果你只想要格式：

```
path.extname('abc.txt').slice(1) // 'txt' 
```

如果没有扩展名，则该函数将返回一个空字符串：

```
path.extname('abc') // '' 
```

如果您使用的是 Node，那么`path`是内置的。如果你的目标是浏览器，那么 Webpack 将为`path`你捆绑一个实现。如果你的目标浏览器没有 Webpack，那么你可以手动包含[path-](https://www.npmjs.com/package/path-browserify) browserify 。

没有理由进行字符串拆分或正则表达式。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2011-11-23T17:23:37.713

```
var extension = fileName.substring(fileName.lastIndexOf('.')+1); 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2017-12-09T23:44:13.807

如果您正在处理网页 url，您可以使用：

```
function getExt(filepath){
     return filepath.split("?")[0].split("#")[0].split('.').pop();
}

getExt("../js/logic.v2.min.js") // js
getExt("http://example.net/site/page.php?id=16548") // php
getExt("http://example.net/site/page.html#welcome.to.me") // html
getExt("c:\\logs\\yesterday.log"); // log 
```

演示：[https ://jsfiddle.net/squadjot/q5ard4fj/](https://jsfiddle.net/squadjot/q5ard4fj/)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-10-10T11:18:40.263

```
var parts = filename.split('.');
return parts[parts.length-1]; 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-10-10T13:53:57.287

```
function file_get_ext(filename)
    {
    return typeof filename != "undefined" ? filename.substring(filename.lastIndexOf(".")+1, filename.length).toLowerCase() : false;
    } 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2016-07-09T18:45:49.557

**代码**

```
/**
 * Extract file extension from URL.
 * @param {String} url
 * @returns {String} File extension or empty string if no extension is present.
 */
var getFileExtension = function (url) {
    "use strict";
    if (url === null) {
        return "";
    }
    var index = url.lastIndexOf("/");
    if (index !== -1) {
        url = url.substring(index + 1); // Keep path without its segments
    }
    index = url.indexOf("?");
    if (index !== -1) {
        url = url.substring(0, index); // Remove query
    }
    index = url.indexOf("#");
    if (index !== -1) {
        url = url.substring(0, index); // Remove fragment
    }
    index = url.lastIndexOf(".");
    return index !== -1
        ? url.substring(index + 1) // Only keep file extension
        : ""; // No extension found
}; 
```

**测试**

请注意，在没有查询的情况下，片段可能仍然存在。

```
"https://www.example.com:8080/segment1/segment2/page.html?foo=bar#fragment" --> "html"
"https://www.example.com:8080/segment1/segment2/page.html#fragment"         --> "html"
"https://www.example.com:8080/segment1/segment2/.htaccess?foo=bar#fragment" --> "htaccess"
"https://www.example.com:8080/segment1/segment2/page?foo=bar#fragment"      --> ""
"https://www.example.com:8080/segment1/segment2/?foo=bar#fragment"          --> ""
""                                                                          --> ""
null                                                                        --> ""
"a.b.c.d"                                                                   --> "d"
".a.b"                                                                      --> "b"
".a.b."                                                                     --> ""
"a...b"                                                                     --> "b"
"..."                                                                       --> "" 
```

**JSLint**

0 警告。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2013-09-30T04:51:46.137

快速且与路径一起正常工作

```
(filename.match(/[^\\\/]\.([^.\\\/]+)$/) || [null]).pop() 
```

一些边缘情况

```
/path/.htaccess => null
/dir.with.dot/file => null 
```

使用 split 的解决方案很慢，而使用 lastIndexOf 的解决方案不处理边缘情况。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2018-12-03T09:11:09.907

```
// 获取文件后缀名
function getFileExtension(file) {
  var regexp = /\.([0-9a-z]+)(?:[\?#]|$)/i;
  var extension = file.match(regexp);
  return extension && extension[1];
}

console.log(getFileExtension("https://www.example.com:8080/path/name/foo"));
console.log(getFileExtension("https://www.example.com:8080/path/name/foo.BAR"));
console.log(getFileExtension("https://www.example.com:8080/path/name/.quz/foo.bar?key=value#fragment"));
console.log(getFileExtension("https://www.example.com:8080/path/name/.quz.bar?key=value#fragment"));
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2013-10-04T16:08:09.530

我只是想分享这个。

```
fileName.slice(fileName.lastIndexOf('.')) 
```

尽管这有一个缺点，即没有扩展名的文件将返回最后一个字符串。但如果你这样做，这将解决所有问题：

```
 function getExtention(fileName){
     var i = fileName.lastIndexOf('.');
     if(i === -1 ) return false;
     return fileName.slice(i)
   } 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2017-11-28T03:18:34.520

我确信将来有人可以并且将会缩小和/或优化我的代码。但是，截至*目前*，我 200% 确信我的代码适用于每一种独特的情况（例如，仅使用*文件名*，使用*相对*、*根相对*和*绝对*URL，使用*片段* `#`标签，使用*查询* `?`字符串等等否则你可能会决定扔掉它），完美无瑕，并且非常精确。

如需证明，请访问：[https ://projects.jamesandersonjr.com/web/js_projects/get_file_extension_test.php](https://projects.jamesandersonjr.com/web/js_projects/get_file_extension_test.php)

这是 JSFiddle：[https ://jsfiddle.net/JamesAndersonJr/ffcdd5z3/](https://jsfiddle.net/JamesAndersonJr/ffcdd5z3/)

不要过分自信，也不要自吹自擂，但我还没有看到这个任务的*任何*代码块（在一系列不同的输入参数中找到*“正确的”*`function`文件扩展名）可以像这样工作。

**注意：**根据设计，如果给定的输入字符串不存在文件扩展名，它只会返回一个空白字符串`""`，而不是错误，也不是错误消息。

> **它需要两个参数：**
> 
> *   ***字符串：* fileNameOrURL** *（不言自明）*
>     
>     
> *   ***布尔值：* showUnixDotFiles**（是否显示以点“.”开头的文件）

**注意（2）：**如果您喜欢我的代码，请务必将其添加到您的 js 库和/或 repo 中，因为我努力完善它，浪费了会很可惜。所以，事不宜迟，这里是：

```
function getFileExtension(fileNameOrURL, showUnixDotFiles)
    {
        /* First, let's declare some preliminary variables we'll need later on. */
        var fileName;
        var fileExt;

        /* Now we'll create a hidden anchor ('a') element (Note: No need to append this element to the document). */
        var hiddenLink = document.createElement('a');

        /* Just for fun, we'll add a CSS attribute of [ style.display = "none" ]. Remember: You can never be too sure! */
        hiddenLink.style.display = "none";

        /* Set the 'href' attribute of the hidden link we just created, to the 'fileNameOrURL' argument received by this function. */
        hiddenLink.setAttribute('href', fileNameOrURL);

        /* Now, let's take advantage of the browser's built-in parser, to remove elements from the original 'fileNameOrURL' argument received by this function, without actually modifying our newly created hidden 'anchor' element.*/ 
        fileNameOrURL = fileNameOrURL.replace(hiddenLink.protocol, ""); /* First, let's strip out the protocol, if there is one. */
        fileNameOrURL = fileNameOrURL.replace(hiddenLink.hostname, ""); /* Now, we'll strip out the host-name (i.e. domain-name) if there is one. */
        fileNameOrURL = fileNameOrURL.replace(":" + hiddenLink.port, ""); /* Now finally, we'll strip out the port number, if there is one (Kinda overkill though ;-)). */  

        /* Now, we're ready to finish processing the 'fileNameOrURL' variable by removing unnecessary parts, to isolate the file name. */

        /* Operations for working with [relative, root-relative, and absolute] URL's ONLY [BEGIN] */ 

        /* Break the possible URL at the [ '?' ] and take first part, to shave of the entire query string ( everything after the '?'), if it exist. */
        fileNameOrURL = fileNameOrURL.split('?')[0];

        /* Sometimes URL's don't have query's, but DO have a fragment [ # ](i.e 'reference anchor'), so we should also do the same for the fragment tag [ # ]. */
        fileNameOrURL = fileNameOrURL.split('#')[0];

        /* Now that we have just the URL 'ALONE', Let's remove everything to the last slash in URL, to isolate the file name. */
        fileNameOrURL = fileNameOrURL.substr(1 + fileNameOrURL.lastIndexOf("/"));

        /* Operations for working with [relative, root-relative, and absolute] URL's ONLY [END] */ 

        /* Now, 'fileNameOrURL' should just be 'fileName' */
        fileName = fileNameOrURL;

        /* Now, we check if we should show UNIX dot-files, or not. This should be either 'true' or 'false'. */  
        if ( showUnixDotFiles == false )
            {
                /* If not ('false'), we should check if the filename starts with a period (indicating it's a UNIX dot-file). */
                if ( fileName.startsWith(".") )
                    {
                        /* If so, we return a blank string to the function caller. Our job here, is done! */
                        return "";
                    };
            };

        /* Now, let's get everything after the period in the filename (i.e. the correct 'file extension'). */
        fileExt = fileName.substr(1 + fileName.lastIndexOf("."));

        /* Now that we've discovered the correct file extension, let's return it to the function caller. */
        return fileExt;
    }; 
```

享受！你太客气了！：

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2018-10-29T14:51:19.167

“单线”使用[`reduce`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce)和[数组解构](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)获取文件名和扩展名：

```
var str = "filename.with_dot.png";
var [filename, extension] = str.split('.').reduce((acc, val, i, arr) => (i == arr.length - 1) ? [acc[0].substring(1), val] : [[acc[0], val].join('.')], [])

console.log({filename, extension});
```

具有更好的缩进：

```
var str = "filename.with_dot.png";
var [filename, extension] = str.split('.')
   .reduce((acc, val, i, arr) => (i == arr.length - 1) 
       ? [acc[0].substring(1), val] 
       : [[acc[0], val].join('.')], [])

console.log({filename, extension});

// {
//   "filename": "filename.with_dot",
//   "extension": "png"
// } 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2020-07-08T21:19:06.750

还有一种使用 ES6 解构的简单方法：

```
const path = 'hello.world.txt'
const [extension, ...nameParts] = path.split('.').reverse();
console.log('extension:', extension);
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2008-10-11T16:43:21.033

```
function extension(fname) {
  var pos = fname.lastIndexOf(".");
  var strlen = fname.length;
  if (pos != -1 && strlen != pos + 1) {
    var ext = fname.split(".");
    var len = ext.length;
    var extension = ext[len - 1].toLowerCase();
  } else {
    extension = "No extension found";
  }
  return extension;
} 
```

//用法

扩展名（'file.jpeg'）

总是返回扩展小写，所以你可以检查它的字段更改工作：

文件.JpEg

文件（无扩展名）

文件。（无扩展名）

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2011-05-12T04:01:50.817

试试这个：

```
function getFileExtension(filename) {
  var fileinput = document.getElementById(filename);
  if (!fileinput)
    return "";
  var filename = fileinput.value;
  if (filename.length == 0)
    return "";
  var dot = filename.lastIndexOf(".");
  if (dot == -1)
    return "";
  var extension = filename.substr(dot, filename.length);
  return extension;
} 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2014-08-25T10:23:11.897

如果您正在寻找特定的扩展名并知道其长度，则可以使用**substr**：

```
var file1 = "50.xsl";

if (file1.substr(-4) == '.xsl') {
  // do something
} 
```

**JavaScript 参考：** [https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/substr](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/substr)

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2017-08-28T18:08:44.627

# 这个简单的解决方案

```
function extension(filename) {
  var r = /.+\.(.+)$/.exec(filename);
  return r ? r[1] : null;
} 
```

# 测试

```
/* tests */
test('cat.gif', 'gif');
test('main.c', 'c');
test('file.with.multiple.dots.zip', 'zip');
test('.htaccess', null);
test('noextension.', null);
test('noextension', null);
test('', null);

// test utility function
function test(input, expect) {
  var result = extension(input);
  if (result === expect)
    console.log(result, input);
  else
    console.error(result, input);
}

function extension(filename) {
  var r = /.+\.(.+)$/.exec(filename);
  return r ? r[1] : null;
}
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2008-10-10T11:12:04.397

```
return filename.replace(/\.([a-zA-Z0-9]+)$/, "$1"); 
```

编辑：奇怪（或者可能不是）`$1`替换方法的第二个参数似乎不起作用......对不起。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2008-10-10T14:14:10.833

我刚刚意识到对 p4bl0 的回答发表评论是不够的，尽管汤姆的回答清楚地解决了这个问题：

```
return filename.replace(/^.*?\.([a-zA-Z0-9]+)$/, "$1"); 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2009-01-16T12:41:00.807

```
function func() {
  var val = document.frm.filename.value;
  var arr = val.split(".");
  alert(arr[arr.length - 1]);
  var arr1 = val.split("\\");
  alert(arr1[arr1.length - 2]);
  if (arr[1] == "gif" || arr[1] == "bmp" || arr[1] == "jpeg") {
    alert("this is an image file ");
  } else {
    alert("this is not an image file");
  }
} 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2011-04-07T16:18:35.173

对于大多数应用程序，一个简单的脚本，如

```
return /[^.]+$/.exec(filename); 
```

会工作得很好（由汤姆提供）。然而，这并不是万无一失的。如果提供了以下文件名，它将不起作用：

```
image.jpg?foo=bar 
```

这可能有点矫枉过正，但我​​建议使用这样的 url 解析器[来](http://phpjs.org/functions/parse_url)避免由于不可预测的文件名而导致的失败。

使用该特定函数，您可以获得如下文件名：

```
var trueFileName = parse_url('image.jpg?foo=bar').file; 
```

这将输出没有 url 变量的“image.jpg”。然后，您可以自由获取文件扩展名。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2015-07-04T18:19:50.563

我参加聚会晚了很多个月，但为了简单起见，我使用了这样的东西

```
var fileName = "I.Am.FileName.docx";
var nameLen = fileName.length;
var lastDotPos = fileName.lastIndexOf(".");
var fileNameSub = false;
if(lastDotPos === -1)
{
    fileNameSub = false;
}
else
{
    //Remove +1 if you want the "." left too
    fileNameSub = fileName.substr(lastDotPos + 1, nameLen);
}
document.getElementById("showInMe").innerHTML = fileNameSub;
```

```
<div id="showInMe"></div>
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2016-02-20T17:18:29.627

一种单行解决方案，它还将考虑查询参数和 url 中的任何字符。

```
string.match(/(.*)\??/i).shift().replace(/\?.*/, '').split('.').pop()

// Example
// some.url.com/with.in/&ot.s/files/file.jpg?spec=1&.ext=jpg
// jpg 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2018-03-27T07:21:01.667

```
fetchFileExtention(fileName) {
    return fileName.slice((fileName.lastIndexOf(".") - 1 >>> 0) + 2);
} 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2013-03-06T02:24:06.323

华莱士的回答很好，但需要再检查一次。

如果文件没有扩展名，它将使用文件名作为扩展名，这是不好的。

试试这个：

```
return ( filename.indexOf('.') > 0 ) ? filename.split('.').pop().toLowerCase() : 'undefined'; 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2013-05-13T09:32:20.003

不要忘记有些文件可以没有扩展名，所以：

```
var parts = filename.split('.');
return (parts.length > 1) ? parts.pop() : ''; 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2016-04-07T00:24:51.560

```
var file = "hello.txt";
var ext = (function(file, lio) { 
  return lio === -1 ? undefined : file.substring(lio+1); 
})(file, file.lastIndexOf("."));

// hello.txt -> txt
// hello.dolly.txt -> txt
// hello -> undefined
// .hello -> hello 
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2019-11-20T12:51:11.243

我知道这是一个老问题，但我用提取文件扩展名的测试编写了这个函数，她可以使用 NPM、Yarn、Bit。
也许它会帮助某人。
[https://bit.dev/joshk/jotils/get-file-extension](https://bit.dev/joshk/jotils/get-file-extension)

```
function getFileExtension(path: string): string {
    var regexp = /\.([0-9a-z]+)(?:[\?#]|$)/i
    var extension = path.match(regexp)
    return extension && extension[1]
} 
```

你可以看到我在[这里](https://bit.dev/joshk/jotils/get-file-extension/~code#test.ts)写的测试。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2020-05-07T19:37:13.100

获取文件名甚至多个点的简单方法

```
var filename = "my.filehere.txt";

file_name =  filename.replace('.'+filename.split('.').pop(),'');

console.log("Filename =>"+file_name); 
```

输出：my.filehere

```
extension = filename.split('.').pop();
console.log("Extension =>"+extension); 
```

输出：txt

**试试这是一行代码**

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2013-12-06T15:01:00.177

```
var filetypeArray = (file.type).split("/");
var filetype = filetypeArray[1]; 
```

这是一个更好的方法。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2015-07-27T09:40:14.830

在 node.js 中，这可以通过以下代码来实现：

```
var file1 ="50.xsl";
var path = require('path');
console.log(path.parse(file1).name); 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2018-06-12T22:21:27.217

我更喜欢在大多数事情上使用 lodash，所以这里有一个解决方案：

```
function getExtensionFromFilename(filename) {
    let extension = '';
    if (filename > '') {
        let parts = _.split(filename, '.');
        if (parts.length >= 2) {
        extension = _.last(parts);
    }
    return extension;
} 
```

# c++ - Good book/resource to learn "effective" template programming in C++?

> ID：190854
> 
> 赞同：3
> 
> 时间：2008-10-10T11:08:20.753
> 
> 标签：c++, templates

I saw Scott Meyers' ["Effective C++"](https://rads.stackoverflow.com/amzn/click/com/0321334876) third edition book having a small section on "Template Programming".

Any other book/links containing information on "effective" usage of templates ?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-10T11:18:48.703

我喜欢[Modern C++ Design: Generic Programming and Design Patterns Applied](https://rads.stackoverflow.com/amzn/click/com/0201704315)。我发现它写得很好，很清楚。包含一些高级主题。

[![替代文字](https://i.stack.imgur.com/Apkdl.jpg)](https://i.stack.imgur.com/Apkdl.jpg)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-10T11:31:48.473

Vandevoorde / Josuttis 'C++ Templates the Complete Guide' 非常易于访问。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T11:46:49.603

[C++ 模板 - 完整指南](http://www.josuttis.com/tmplbook/)。Alexandrescu 的 Modern C++ Design 非常好，但除非您已经熟悉模板，否则我不会推荐它。它也更适合 C++ 框架的创建者。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T11:10:46.927

我非常喜欢 Abrahams 和 Gurtovoy 的 C++ Template Metaprogramming。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T14:32:11.250

Scott Meyers 在[Effective STL](https://rads.stackoverflow.com/amzn/click/com/0201749629)中处理标准模板库。这可能与您有关。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T14:40:28.550

Stephen C. Dewhurst的[C++ Common Knowledge](https://rads.stackoverflow.com/amzn/click/com/0321321928)是一本很少被提及但很可靠的书。“在贝尔实验室 C++ 的第一批用户中”，Dewhurst 给这本书起了一个有点欺骗性的标题，因为他实际上涵盖了相当多的高级材料，特别是与模板有关的内容。

Dewhurst 的书的组织方式与 Meyers 的类似，有 63 个“项目”，您可以自行阅读这些项目。在模板上，您应该查看第 45-59 项（大约 70 页阅读）。

[![替代文字](https://i.stack.imgur.com/9J5Wy.jpg)](https://i.stack.imgur.com/9J5Wy.jpg)

# flash - 同一 DisplayObject 的多个视口

> ID：190867
> 
> 赞同：1
> 
> 时间：2008-10-10T11:12:39.107
> 
> 标签：flash, actionscript-3, viewport, displayobject, scrollrect

是否可以对同一个显示对象进行多个视图？（例如使用分屏的同机多人游戏）

失败的示例代码如下：

```
 var content: Sprite = new Sprite();
    var v1: Sprite = new Sprite();
    var v2: Sprite = new Sprite();

    with(content.graphics) {
        lineStyle(2, 0xff0000);
        drawCircle(100, 100, 80);

        lineStyle(5, 0x009999);
        drawRect(50, 80, 200, 30);
    }

    v1.addChild(content);
    v1.x = 0;
    v1.y = 0;
    v1.scrollRect = new Rectangle(0, 0, 100, 100);
    addChild(v1);

    v2.addChild(content);
    v2.x = 100;
    v2.y = 0;
    v2.scrollRect = new Rectangle(0, 0, 100, 100);
    addChild(v2); 
```

我认为这会使同一个对象 ( ) 的两个视口 (`v1`和)。但是当我检查文档时，DisplayObjectContaner/addChild 方法，它说，`v2``content`

“如果您添加一个已经具有不同显示对象容器的子对象作为父对象，则该对象将从另一个显示对象容器的子列表中删除。”

有解决方案吗？

* * *

得到的结果

![得到的结果](https://i.stack.imgur.com/aWKOO.png)

预期结果（模拟）

[预期结果（模拟）http://img337.imageshack.us/img337/7914/222mq4.png](http://img337.imageshack.us/img337/7914/222mq4.png)

* * *

按照 Antti 的建议渲染到位图是一个好主意，但是渲染的精灵将无法捕捉鼠标事件。有没有办法重定向位图上的鼠标点击以触发对原始精灵的点击？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T13:58:29.070

最简单的方法是使用原始显示对象的内容更新位图，例如：

```
var bitmap:Bitmap = new Bitmap(new BitmapData(1,1));
addChild（位图）；

addEventListener(Event.ENTER_FRAME,enterFrameHandler);

函数 enterFrameHandler（事件：事件）：无效 {
    bitmap.bitmapData.dispose();
    bitmap.bitmapData = new BitmapData(displayObject.width, displayObject.height, true, 0x00000000);
    bitmap.bitmapData.draw(displayObject);
}

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T09:52:37.240

您可以采用的一种方法是采用 MVC 模式，其中您有一个控制游戏逻辑等的模型，以及控制显示的单独视图类。这样，同一场景的多个视图更易于管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T02:46:27.163

如果将渲染放在精灵内部的位图上，则可以捕获鼠标点击。

麦克风

# qt - 在 DoubleSpinBox 或 ComboBox 等 Qt 小部件上，我如何拥有自定义右键菜单

> ID：190876
> 
> 赞同：3
> 
> 时间：2008-10-10T11:16:56.227
> 
> 标签：qt, right-click

我的 Qt Dialog 上有一些组合框和双旋转框。现在，当您右键单击小部件（旋转框或组合框）时，我需要一个菜单​​上的“ResetToDefault”项。

我怎么得到它。有什么方法可以让我在右键单击时出现自定义菜单，或者有没有一种方法可以将项目添加到右键单击时出现的菜单中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T11:27:05.707

首先，对于 Qt4，最简单的方法是创建一个动作来重置数据，并使用`addAction`方法（或使用设计器）将其添加到小部件中。然后，将`contextMenuPolicy`属性设置为`Qt::ActionsContextMenu`。将出现上下文菜单并触发操作。

代码示例：

```
QAction *reset_act = new QAction("Reset to default");
mywidget->addAction(reset_act);
mywidget->setContextMenuPolicy(Qt::ActionsContextMenu);
// here connect the 'triggered' signal to some slot 
```

对于 Qt3，您可能必须拦截上下文菜单事件，从而继承 QSpinBox 和其他。或者，也许您可​​以从主窗口拦截上下文菜单事件，检测它是否发生在应该具有上下文菜单的小部件上方（使用该`QWidget::childAt`方法）并将其显示在那里。但是你必须进行测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T13:20:03.207

对于 Qt4，您可以使用自己的 QLineEdit 为可编辑的 QComboBox 执行此操作。创建实现 contextMenuEvent 的派生 QLineEdit 类

```
class MyLineEdit : public QLineEdit
{
    Q_OBJECT
public:

    MyLineEdit(QWidget* parent = 0) : QLineEdit(parent){}

    void contextMenuEvent(QContextMenuEvent *event)
    {
        QPointer<QMenu> menu = createStandardContextMenu();
        //add your actions here
        menu->exec(event->globalPos());
        delete menu;
    }

}; 
```

然后，使用QComboBox的setLineEdit函数设置行编辑

```
MyLineEdit* edit = new MyLineEdit();
comboBox->setLineEdit(edit); 
```

组合框现在将使用您的行编辑类。createStandardContextMenu 函数创建正常的上下文菜单，您可以在显示之前在 contextMenuEvent 处理程序中添加您喜欢的任何新操作。

如果 QComboBox 不可编辑，则它没有默认上下文菜单，因此使用 Qt::ActionsContextMenu 方法要简单得多。

QAbstractSpinBox 也有一个 setLineEdit 函数，所以你可以使用类似的技术。虽然由于某种原因 setLineEdit 函数在 QAbstractSpinBox 上受到保护，但在 QLineEdit 上是公开的。

# html - 标签的顺序

> ID：190890
> 
> 赞同：48
> 
> 时间：2008-10-10T11:23:35.900
> 
> 标签：html, xhtml

`<link>`or `<script>`or`<meta>`标签在 中的顺序是否重要`<head></head>`？

（愚蠢的问题，但直到现在我从未考虑过的事情之一。）

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-10T11:28:26.373

**优化**

据雅虎的人说！您应该[将 CSS 放在顶部](http://developer.yahoo.com/performance/rules.html#css_top)，[将脚本放在底部](http://developer.yahoo.com/performance/rules.html#js_bottom)，因为脚本会阻止并行下载。但这主要是优化问题，对于实际工作的页面并不重要。[Joeri Sebrechts](https://stackoverflow.com/users/20980/joeri-sebrechts)指出，[Cuzillion](http://stevesouders.com/cuzillion/)是一种很好的测试方法，可以让您自己了解速度的提升。

**多个样式表**

如果您要链接多个样式表，它们链接的顺序可能会影响您的页面样式，具体取决于[您的选择器](http://www.stuffandnonsense.co.uk/archives/css_specificity_wars.html)的特殊性。换句话说，如果您有两个样式表以两种不同的方式定义相同的选择器，则后者将优先。例如：

样式表 1：

```
h1 { color: #f00; } 
```

样式表 2：

```
h1 { color: #00f; } 
```

在此示例中，`h1`元素将具有颜色`#00f`，因为它是最后定义的，具有相同的特性：

**多个脚本**

如果您使用多个脚本，如果其中一个脚本依赖于另一个脚本中的某些内容，那么它们的使用顺序可能很重要。在这种情况下，如果脚本以错误的顺序链接，您的某些脚本可能会抛出错误或无法按预期工作。但是，这在很大程度上取决于您使用的脚本。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-10T15:02:14.653

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-10T11:42:32.217

建议将字符编码的元标记放在尽可能高的位置。如果编码不包含在请求页面的响应标头中（或不同于），浏览器将不得不猜测编码是什么。只有当它找到这个元标记时，它才知道它正在处理什么，并且它必须再次读取它已经解析过的所有内容。

例如，参见[指示字符集的方法](http://www.webrichtlijnen.nl/english/manual/development/production/character-encoding/the-web/methods/)。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-10T11:51:43.400

需要注意的重要一点：如果您使用 Internet Explorer 元 X-UA-Compatible 标记来切换 IE 的呈现模式，它必须是 HEAD 中的第一件事：

```
<头部>
  <meta http-equiv="X-UA-Compatible" content="IE=7" />
  <title>页面标题</title>
  ...ETC
</head>

```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-10T11:27:29.590

元无关紧要，但链接（用于css）和脚本很重要。

脚本将阻止大多数浏览器呈现页面，直到加载脚本。因此，如果可能的话，不要把它们放在头上，而是放在身体上。

css 链接不会阻止页面呈现。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-10T11:29:20.180

通常建议将`<script>`标签尽可能放在页面下方（不是在头部，而是在正文中）。

`<head>`除此之外，我认为这没有太大区别，因为除非您完全加载了该部分，否则无法解析正文。而且，您希望您的`<link>`标签出现在头部，因为您希望您的样式在浏览器呈现您的页面时出现，而不是在那之后！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-10T11:35:36.580

如果您在元元素中声明字符集，则应在任何其他元素之前进行。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-10T11:41:59.393

根本不是一个愚蠢的问题。
CSS 上面的 Script 标签，原因已经提到。

CSS 是按照你放置标签的顺序应用的——样式表越具体，它应该的顺序就越低。

脚本也是如此 - 使用在其他文件中声明的函数的脚本应该在加载依赖项后加载。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-10T14:45:03.907

将声明字符集的元标记作为 head 中的第一个元素。到目前为止，浏览器只搜索标签。如果您在元元素之前有太多东西，则可能不会应用字符集。

如果您使用 BASE 元素，请将其放在任何加载 URI 的元素之前（如果需要）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-10T11:28:43.957

只有其中一个链接文件（CSS/Javascript）依赖于另一个文件才有意义。在这种情况下，必须首先加载所有依赖项。

例如，假设您正在加载一个 jQuery 插件，那么您需要首先加载 jQuery 本身。当您有一个带有一些规则扩展其他规则的 CSS 文件时也是如此。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-10T15:45:47.840

As already pointed out meta describing content charset should be the first otherwise it could actually be a security hole in a certain situation. (sorry i dont remember that situation well enought to describe here but it was demostrated to me at web security training course)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-11T05:57:52.287

I recently was having a problem with a draggable jquery ui element. It was behaving properly in Firefox, but not Safari. After a ton of trial and error, the fix was to move my css links above the javascript links in the head. Very odd, but will now become my standard practice.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-15T21:26:41.583

For the purposes of validation as XHTML, yes. Otherwise you're probably going to care about the optimization answers.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-10T11:28:02.257

不，没关系，除了 CSS 链接或包含，因为 CSS 继承以及它覆盖了已经样式化的事实（对不起我的英语，我认为我的句子不是很清楚:-/）。

# ios - 如何禁用 UITableView 选择？

> ID：190908
> 
> 赞同：1241
> 
> 时间：2008-10-10T11:32:27.833
> 
> 标签：ios, uitableview, cocoa-touch

当您点击 中的一行时`UITableView`，该行将突出显示并被选中。是否可以禁用此功能，因此点击一行什么也不做？

* * *

## 回答 #1

> 赞同：2004
> 
> 时间：2008-10-10T13:22:04.480

您所要做的就是`UITableViewCell`使用以下任一方法在实例上设置选择样式：

目标-C：

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

或者

```
[cell setSelectionStyle:UITableViewCellSelectionStyleNone]; 
```

斯威夫特 2：

```
cell.selectionStyle = UITableViewCellSelectionStyle.None 
```

斯威夫特 3 和 4.x：

```
cell.selectionStyle = .none 
```

此外，请确保您要么不在`-tableView:didSelectRowAtIndexPath:`表格视图委托中实现，要么明确排除您希望在实现时不采取任何行动的单元格。

[更多信息在这里](https://web.archive.org/web/20100825164330/http://developer.apple.com:80/iphone/library/documentation/uikit/reference/UITableViewCell_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableViewCell/selectionStyle)和[这里](https://web.archive.org/web/20100901120334/http://developer.apple.com:80/iphone/library/documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView:didSelectRowAtIndexPath:)

* * *

## 回答 #2

> 赞同：644
> 
> 时间：2009-07-22T16:56:19.283

对我来说，以下工作正常：

```
tableView.allowsSelection = false 
```

这意味着`didSelectRowAt#`根本行不通。也就是说，触摸表格的一行，这样，绝对不会做任何事情。（因此，很明显，永远不会有选定的动画。）

（请注意，如果在单元格上，您有`UIButton`或任何其他控件，当然这些控件仍然可以工作。您碰巧在表格单元格上拥有的任何控件都与 UITableView 允许您“选择一行”的能力完全无关使用`didSelectRowAt#`。）

`UITableView`还有一点需要注意的是：这在编辑模式下不起作用。要在编辑模式下限制单元格选择，请使用以下代码：

```
tableView.allowsSelectionDuringEditing = false 
```

* * *

## 回答 #3

> 赞同：360
> 
> 时间：2011-06-10T11:08:35.577

因为我最近阅读了这篇文章并且它对我有所帮助，所以我想发布另一个答案以整合所有答案（供后代使用）。

* * *

因此，根据您想要的逻辑和/或结果，实际上有 5 个不同的答案：

1.要禁用蓝色突出显示而不更改单元格的任何其他交互：

```
[cell setSelectionStyle:UITableViewCellSelectionStyleNone]; 
```

当我有一个 UIButton - 或其他一些控件 - 托管在 UITableViewCell 中并且我希望用户能够与控件交互而不是单元格本身时，我会使用它。

[***注意***：正如上面提到的 Tony Million，这并不能阻止`tableView:didSelectRowAtIndexPath:`. 我通过简单的“if”语句来解决这个问题，最常见的是测试该部分并避免对特定部分采取行动。]

我想到的另一种测试单元格敲击的方法是：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    // A case was selected, so push into the CaseDetailViewController
    UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    if (cell.selectionStyle != UITableViewCellSelectionStyleNone) {
        // Handle tap code here
    }
} 
```

2.要对整个表格执行此操作，您可以将上述解决方案应用于表格中的每个单元格，但您也可以这样做：

```
[tableView setAllowsSelection:NO]; 
```

[**在我的测试中，这仍然允许内部的控件`UITableViewCell`是交互式的。**]

3.要使单元格“只读”，您可以简单地执行以下操作：

```
[cell setUserInteractionEnabled:NO]; 
```

4.使整个表“只读”

```
[tableView setUserInteractionEnabled:NO]; 
```

5.要即时确定是否突出显示单元格（根据[此答案](https://stackoverflow.com/a/13167946/394484)隐含地包括选择），您可以实现以下`UITableViewDelegate`协议方法：

```
- (BOOL)tableView:(UITableView *)tableView 
   shouldHighlightRowAtIndexPath:(NSIndexPath *)indexPath 
```

* * *

## 回答 #4

> 赞同：88
> 
> 时间：2011-06-01T13:32:49.070

总结一下我认为基于我自己的实施经验的正确答案：

如果您只想禁用某些单元格的选择，请使用：

```
cell.userInteractionEnabled = NO; 
```

除了防止选择之外，这还停止了 tableView:didSelectRowAtIndexPath: 被设置为单元格的调用。（此答案归功于 Tony Million，谢谢！）

如果单元格中有需要单击的按钮，则需要：

```
[cell setSelectionStyle:UITableViewCellSelectionStyleNone]; 
```

并且您还需要忽略对`- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath`.

如果要禁用整个表的选择，请使用：

```
tableView.allowsSelection = NO; 
```

（感谢 Paulo De Barros，谢谢！）

* * *

## 回答 #5

> 赞同：58
> 
> 时间：2012-10-31T21:48:47.593

从 iOS 6.0 开始，`UITableViewDelegate`有`tableView:shouldHighlightRowAtIndexPath:`. （在 iOS[文档](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView:shouldHighlightRowAtIndexPath:)中了解它。）

此方法使您可以将特定行标记为不可突出显示（并且隐含地，不可选择），而无需更改单元格的选择样式，使用`userInteractionEnabled = NO`，或此处记录的任何其他技术弄乱单元格的事件处理。

* * *

## 回答 #6

> 赞同：51
> 
> 时间：2013-04-25T13:13:28.617

您还可以通过`NoSelection`从`selection`检查器窗格中的选项（UITableView 属性）中进行选择来禁用界面构建器本身的行选择，如下图所示

![UITableView 检查器](https://i.stack.imgur.com/Qw1bX.png)

* * *

## 回答 #7

> 赞同：47
> 
> 时间：2017-01-07T19:15:36.313

**SWIFT 3 的固定解决方案**

```
cell.selectionStyle = .none 
```

* * *

## 回答 #8

> 赞同：37
> 
> 时间：2016-10-05T07:49:18.870

在Attribute Inspector`UITableViewCell`的**XIB**`Selection`中将值设置为`None`。

[![在此处输入图像描述](https://i.stack.imgur.com/MHHe5.png)](https://i.stack.imgur.com/MHHe5.png)

* * *

## 回答 #9

> 赞同：36
> 
> 时间：2014-12-02T09:39:43.130

如果有人需要[Swift](https://developer.apple.com/swift/)的答案：

```
cell.selectionStyle = .None 
```

* * *

## 回答 #10

> 赞同：35
> 
> 时间：2012-11-13T15:07:34.103

如果你希望选择只闪烁，而不是保持在选中状态，你可以调用，在

```
didSelectRowAtIndexPath 
```

以下

```
[tableView deselectRowAtIndexPath:indexPath animated:YES]; 
```

所以它会闪烁选定的状态并恢复。

* * *

## 回答 #11

> 赞同：30
> 
> 时间：2015-03-30T10:31:58.313

这就是我在`cellForRowAtIndexPath`编写这段代码时使用的：

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

* * *

## 回答 #12

> 赞同：29
> 
> 时间：2009-06-30T10:01:20.427

从`UITableViewDelegate`协议中，您可以使用该方法`willSelectRowAtIndexPath` ，`return nil`如果您不想选择该行。

以同样的方式，您可以使用该`willDeselectRowAtIndexPath`方法，`return nil`如果您不想取消选择该行。

* * *

## 回答 #13

> 赞同：27
> 
> 时间：2015-03-30T06:10:18.293

1-您所要做的就是使用以下任一方法在实例上设置**选择样式：`UITableViewCell`**

**目标-C：**

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

或者

```
[cell setSelectionStyle:UITableViewCellSelectionStyleNone]; 
```

**斯威夫特 2：**

```
cell.selectionStyle = UITableViewCellSelectionStyle.None 
```

**斯威夫特 3：**

```
cell.selectionStyle = .none 
```

2 - 不要实施 -**`tableView:didSelectRowAtIndexPath:`**在您的表格视图中`delegate`或明确排除您希望在实施时不采取任何行动的单元格。

3 - 此外，您也可以从情节提要中进行。单击表格视图单元格，然后在表格视图单元格下的属性检查器中，将选择旁边的下拉列表更改为无。

**4 - 您可以使用 (iOS) Xcode 9、Swift 4.0** 中的以下代码禁用表格单元格突出显示

 **```
func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {

        let cell = tableView.dequeueReusableCell(withIdentifier: "OpenTbCell") as! OpenTbCell
        cell.selectionStyle = .none
        return cell

} 
```

* * *

## 回答 #14

> 赞同：20
> 
> 时间：2014-11-22T09:43:36.450

## 目标-C：

1.  下面的代码段禁用突出显示，但它也禁用对`didSelectRowAtIndexPath`. 因此，如果您没有实施，请`didSelectRowAtIndexPath`使用以下方法。这应该在您创建表时添加。不过，这将适用于按钮和`UITextField`单元格内部。

    ```
    self.tableView.allowsSelection = NO; 
    ```

2.  下面的代码段禁用突出显示，它不会禁用对`didSelectRowAtIndexPath`. 将单元格的选择样式设置为无`cellForRowAtIndexPath`

    ```
    cell.selectionStyle = UITableViewCellSelectionStyleNone; 
    ```

3.  下面的代码段禁用单元格上的所有内容。这将禁用与`buttons`,的交互`textfields`：

    ```
    self.tableView.userInteractionEnabled = false; 
    ```

## 迅速：

以下是`Swift`上述解决方案的等价物`Objective-C`：

1.  更换第一种溶液

    ```
    self.tableView.allowsSelection = false 
    ```

2.  更换第二个解决方案

    ```
    cell?.selectionStyle = UITableViewCellSelectionStyle.None 
    ```

3.  替换第三种解决方案

    ```
    self.tableView.userInteractionEnabled = false 
    ```

* * *

## 回答 #15

> 赞同：19
> 
> 时间：2011-05-27T15:37:39.243

尝试输入：

```
cell.selected = NO; 
```

它会在需要时取消选择您的行。

在 Swift3 ...

```
override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
    let r = indexPath.row
    print("clicked .. \(r)")
    tableView.cellForRow(at: indexPath)?.setSelected(false, animated: true)
} 
```

* * *

## 回答 #16

> 赞同：14
> 
> 时间：2013-01-03T21:08:48.237

我也一直在与这个问题作斗争，控制我`UITableViewCell`禁止使用的`userInteractionEnabled`财产。我有一个用于设置的 3 单元静态表，2 个带日期，1 个带开/关开关。在 Storyboard/IB 中玩过之后，我设法使底部的一个不可选择，但是当您点击它时，顶部行之一的选择消失了。这是我的设置 UITableView 的 WIP 图像：

![设置 UITableView](https://i.stack.imgur.com/6qV3g.png)

如果您点击第三行没有任何反应，则选择将保留在第二行。该功能实际上是 Apple 日历应用程序添加事件时间选择屏幕的副本。

该代码令人惊讶地兼容，一直到 IOS2 =/：

```
- (NSIndexPath *)tableView: (UITableView *)tableView willSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    if (indexPath.row == 2) {
        return nil;
    }
    return indexPath;
} 
```

这与将选择样式设置为无结合使用，因此单元格不会在触摸事件上闪烁

* * *

## 回答 #17

> 赞同：12
> 
> 时间：2020-08-10T07:44:29.617

**斯威夫特 3,4 和 5**

**更好**的实践，编写代码`UITableViewCell`

例如，你有`UITableViewCell`名字`MyCell`，在`awakeFromNib`里面只写`self.selectionStyle = .none`

完整示例：

```
class MyCell: UITableViewCell {

    override func awakeFromNib() {
        super.awakeFromNib()
        self.selectionStyle = .none
    }

} 
```

* * *

## 回答 #18

> 赞同：11
> 
> 时间：2012-03-24T13:21:09.660

我们可以编写如下代码

```
 cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

但是当我们在上面有**自定义单元格xib**时，当时**会发出警告**

**自定义单元格xib**

我们需要**从界面生成器中设置选择样式 None**

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2016-05-18T05:17:24.790

您只需将此代码放入 cellForRowAtIndexPath

禁用单元格的选择属性：（点击单元格时）。

```
cell.selectionStyle = UITableViewCellSelectionStyle.None 
```

* * *

## 回答 #20

> 赞同：10
> 
> 时间：2012-07-09T07:27:18.230

试试这个

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

和

```
[cell setSelectionStyle:UITableViewCellSelectionStyleNone]; 
```

您还可以使用 interfacebuilder 设置选择样式。

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2015-10-19T12:33:39.543

我正在使用这个，它对我有用。

```
cell?.selectionStyle = UITableViewCellSelectionStyle.None 
```

* * *

## 回答 #22

> 赞同：9
> 
> 时间：2020-01-15T08:04:42.360

从**UITableViewDataSource**协议，内部方法`cellForRowAt`添加：

```
let cell = tableView.dequeueReusableCell(withIdentifier: "YOUR_CELL_IDENTIFIER", for: indexPath)                
cell.selectionStyle = .none
return cell 
```

或者

您可以转到 Storyboard > Select Cell > Identity Inspector > Selection 并从下拉列表中选择无。

* * *

## 回答 #23

> 赞同：7
> 
> 时间：2013-08-20T21:25:24.857

虽然这是防止行在选择期间显示突出显示的最佳和最简单的解决方案

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

我还想建议偶尔简短地显示该行已被选中然后将其关闭是有用的。这会提醒用户确认他们打算选择的内容：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
     [tableView deselectRowAtIndexPath:indexPath animated:NO];
...
} 
```

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2018-04-13T21:33:56.790

直接禁用 TableViewCell 突出显示到情节提要中

[![在此处输入图像描述](https://i.stack.imgur.com/SfVKW.png)](https://i.stack.imgur.com/SfVKW.png)

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2013-01-18T00:51:00.160

禁用 UItableviewcell 的突出显示

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

并且不应允许用户与单元格进行交互。

```
cell.userInteractionEnabled = NO; 
```

* * *

## 回答 #26

> 赞同：6
> 
> 时间：2014-01-14T01:43:02.083

您也可以将背景颜色设置为 Clear 以达到与 相同的效果`UITableViewCellSelectionStyleNone`，以防您不想/不能使用`UITableViewCellSelectionStyleNone`。

您将使用如下代码：

```
UIView *backgroundColorView = [[UIView alloc] init];
backgroundColorView.backgroundColor = [UIColor clearColor];
backgroundColorView.layer.masksToBounds = YES;
[cell setSelectedBackgroundView: backgroundColorView]; 
```

**当您向每个单元格添加***额外*的彩色视图时，这可能会***降低***您的性能。

 **** * *

## 回答 #27

> 赞同：6
> 
> 时间：2014-07-12T09:06:08.803

**您可以使用 ：**

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

在 UITableView 的索引路径方法的行的单元格中。

**您也可以使用：**

```
[tableView deselectRowAtIndexPath:indexPath animated:NO]; 
```

在 tableview didselectrowatindexpath 方法中。

* * *

## 回答 #28

> 赞同：6
> 
> 时间：2014-12-04T05:12:56.677

您也可以从情节提要中执行此操作。单击表格视图单元格，然后在表格视图单元格下的属性检查器中，将选择旁边的下拉列表更改为无。

* * *

## 回答 #29

> 赞同：5
> 
> 时间：2013-05-10T09:44:26.553

你可以用这个

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

* * *

## 回答 #30

> 赞同：5
> 
> 时间：2013-08-25T13:24:40.017

最好的解决方案是**使选择样式无**

```
[cell setSelectionStyle:UITableViewCellSelectionStyleNone]; 
```

但是，在这里我们考虑的是没有用于选定状态的自定义图像这一事实。

* * *

## 回答 #31

> 赞同：5
> 
> 时间：2013-10-08T11:10:34.393

您可以使用 ....

```
[cell setSelectionStyle:UITableViewCellSelectionStyleNone]; 
```

* * *

## 回答 #32

> 赞同：5
> 
> 时间：2014-04-10T12:08:13.993

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

* * *

## 回答 #33

> 赞同：5
> 
> 时间：2014-07-31T12:53:24.953

```
UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
[cell setSelected:NO animated:NO];
[cell setHighlighted:NO animated:NO]; 
```

编码快乐！！！

* * *

## 回答 #34

> 赞同：5
> 
> 时间：2015-02-19T08:54:28.990

**带有自定义单元的快速解决方案：**

```
import Foundation

class CustomTableViewCell: UITableViewCell
{
  required init(coder aDecoder: NSCoder)
  {
    fatalError("init(coder:) has not been implemented")
  }

  override init(style: UITableViewCellStyle, reuseIdentifier: String?)
  {
    super.init(style: style, reuseIdentifier: reuseIdentifier)
    self.selectionStyle = UITableViewCellSelectionStyle.None
  } 
} 
```

* * *

## 回答 #35

> 赞同：5
> 
> 时间：2015-05-15T08:55:20.127

您可以使用UITableViewCell 的*selectionStyle属性*

```
 cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

或者

```
 [cell setSelectionStyle:UITableViewCellSelectionStyleNone]; 
```

另外，不要在委托下面实现

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath { ... } 
```

如果您已经创建了 Xib/Storyboard 文件，那么您可以通过取消选中它来将 tableview 的*setUserInteractionEnabled* 属性更改为*No。*这将使您的表格视图为只读。

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2018-09-14T09:16:47.347

**您可以使用 (iOS) Xcode 9、Swift 4.0 中的以下代码禁用表格单元格高亮**

```
 func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {

        let cell = tableView.dequeueReusableCell(withIdentifier: "OpenTbCell") as! OpenTbCell
        cell.selectionStyle = .none
        return cell

} 
```

* * *

## 回答 #37

> 赞同：3
> 
> 时间：2020-10-21T11:02:04.007

**禁用 UITableView 中所有 UITableViewCells 的选择**

```
tableView.allowsSelection = false 
```

**禁用特定 UITableViewCells 的选择**

```
cell.selectionStyle = UITableViewCell.SelectionStyle.none 
```

* * *

## 回答 #38

> 赞同：2
> 
> 时间：2012-12-17T07:36:11.000

更好的方法是：

```
cell.userInteractionEnabled = NO; 
```

这种方法不会调用`didSelectRowAtIndexPath:`方法。

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2013-04-25T12:33:27.327

至少从 iOS 6 开始，您可以覆盖自定义单元格中的方法以防止蓝色突出显示。没有其他交互被禁用或影响。这三个都必须被覆盖。

```
- (void) setHighlighted:(BOOL)highlighted
{
}

- (void) setHighlighted:(BOOL)highlighted animated:(BOOL)animated
{
}

- (void) setSelected:(BOOL)selected animated:(BOOL)animated
{
} 
```

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2019-07-25T07:42:42.570

***情景 - 1***

如果您不想选择**tableview上的某些特定单元格，您可以在****cellForRow**函数中为这些单元格设置选择样式。

**Objective-C**

```
cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

**斯威夫特 4.2**

```
cell.selectionStyle = .none 
```

***情景 - 2***

要禁用整个表视图上的选择：

**Objective-C**

```
self.tableView.allowsSelection = false; 
```

**斯威夫特 4.2**

```
self.tableView.allowsSelection = false 
```

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2019-07-30T07:35:00.823

很简单的东西。在返回 tableview Cell 之前，使用 table view cell 的 style 属性。

只需在返回表格视图单元格之前编写这行代码
`cell.selectionStyle = .none`

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2021-06-15T10:10:48.787

我已经完成了所有答案，对我的用例有用的是以下内容：

```
tableView.allowSelection = false 
```

```
public func tableView(_ tableView: UITableView, canFocusRowAt indexPath: IndexPath) -> Bool {
    true
} 
```

这样表格仍然可以聚焦，用户可以滚动其元素但无法“按下/选择”它们。

简单的设置`cell.selectionStyle = .none`将允许列表元素是可选的（只是不要留下灰色的选择标记）。只是设置`allowSelection = false`会导致我的桌子无法聚焦。用户将无法滚动浏览元素。

# asp.net - 每次使用母版页时如何生成 ASP.NET 页面？

> ID：190911
> 
> 赞同：1
> 
> 时间：2008-10-10T11:34:25.257
> 
> 标签：asp.net, master-pages

我正在将一个旧的 VBScript 网站移到 ASP.NET，所以我开始使用母版页而不是 #includeing 许多其他文件，其中包含服务器端 VBScript。

如何阻止页面（如基于母版页的页面）生成一次然后存储？如果我对母版页（或基于它们的任何页面）进行更改，这些更改将不可见，因为 Web 服务器仍在提供以前的版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T11:37:40.943

听起来您启用了[缓存](http://msdn.microsoft.com/en-us/library/aa478965.aspx)，因为没有缓存的正常行为是重新生成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T11:37:20.040

不应该是这种情况，您确定这不是缓存问题吗？

# bash - /etc/motd 在 Gentoo Linux 上打印两次

> ID：190912
> 
> 赞同：6
> 
> 时间：2008-10-10T11:34:39.840
> 
> 标签：bash, ssh, gentoo

我遇到了一个问题，我在 Gentoo Linux 上打印了两个 /etc/motd 文件。sshd 正在执行其中一个打印输出，我可以通过配置 /etc/ssh/sshd_config 来切换它，但我不知道是谁在打印第二个副本。由于审核要求，我无法禁用 sshd 打印 motd。我正在运行 bash shell，值得

谁在打印第二个副本有什么想法吗？我不认为它是 bash，因为当我将 /etc/passwd 更改为使用 /bin/ksh 作为我的 shell 时，我仍然会显示 motd。

这不是 /etc/issue，因为它包含字符串“This is \n (\s \m \r) (\l)”，仅当您坐在机器前时才会打印。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-10T12:44:11.890

看起来答案在 /etc/pam.d/login 和 /etc/pam.d/system-login 文件中。我不得不注释掉 pam_motd.so 行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T16:11:13.643

您是从 SSH 连接登录吗？？.. 如果是这样，也许您必须在 sshd_config 文件中启用并设置为 no 键“PrintMotd No”并重新启动服务...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T17:34:08.763

我也遇到了这个问题，令我困扰的不是双模，而是双“上次登录”行，第二行指的是它上面的登录事件。

我认为这可能表明某种形式的犯规行为，就好像我的登录被重定向或通过某些间谍软件或其他东西进行管道传输。

这是我的 /etc/pam.d/system-login 的底部 5 行的样子：

```
session         required        pam_env.so
#session        optional        pam_lastlog.so
session         include         system-auth
#session        optional        pam_motd.so motd=/etc/motd
session         optional        pam_mail.so 
```

注意注释掉的行。现在一切都按预期工作。谢谢，丹尼尔。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-09-08T08:29:55.583

我在 Ubuntu 15.04 和配置为使用 PAM 身份验证的 SSHD 上遇到了同样的问题。我的服务器正在发送两个 MOTD。通过让 SSHD 在每次登录时刷新 MOTD，我设法使其正常工作。这是通过编辑 /etc/pam.d/sshd 并删除/注释显示`noupdate`.

```
# Print the message of the day upon successful login.
# This includes a dynamically generated part from /run/motd.dynamic
# and a static (admin-editable) part from /etc/motd.
session    optional     pam_motd.so  motd=/run/motd.dynamic
#session    optional     pam_motd.so  noupdate 
```

缺点是如果刷新此消息的过程需要一段时间（或 CPU 时间），登录可能会浪费一些资源，看起来需要一段时间甚至超时。

但是，Ubuntu 15.04 中开箱即用的基本默认 MOTD 不会造成问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T11:47:20.210

另请查看 /etc/issue，有些系统会同时打印两者，它们可能只包含相同的文本。请注意，我不使用 gentoo，所以情况可能并非如此。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T01:01:52.513

除了注释掉 pam_motd.so 行之外，别忘了还要注释掉 /etc/pam.d/login 和 /etc/pam.d/system-login 中的以下行：

会话可选 pam_lastlog.so

像这样，“最后登录”行打印一次而不是两次。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-11-25T02:50:07.230

我认为确保打印 MOTD 的唯一组件是 PAM 会更有意义。这样，您可以在其他任何地方禁用它，并且仍然符合您的审核要求。

只是我的 0.02 美元。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-02T17:13:25.530

当我遇到这个问题时，我了解到这是系统发给我时活动设置的组合。该消息的第一个副本是在 SSH 身份验证发生之前打印的，这是由于在*sshd_config*`Banner`中设置了 SSH 的选项：

 *```
Banner /etc/motd 
```

滥用 MOTD 多于滥用`Banner`.

打印了该消息的第二个副本，因为在其默认配置中，SSH 在登录时打印 MOTD。我通过设置禁用它`PrintMotd`：

```
PrintMotd no 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T11:46:19.680

它可能是从外壳本身完成的。检查全局配置文件和 bashrc 以查看是否是这种情况。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-11T02:02:11.617

要仅允许 pam_motd.so 模块打印 motd，请将 /etc/login.defs 中的 MOTD 变量设置为空字符串。

MOTD_FILE ""

# .net - 如何根据单元格的值更改 DataGridView 中一行的背景色？

> ID：190914
> 
> 赞同：3
> 
> 时间：2008-10-10T11:34:59.293
> 
> 标签：.net, datagridview, backcolor

我有一个显示 DataTable 内容的 DataGridView。

我想根据该行中单元格的值设置行的背景色。

请注意，有问题的单元格位于 DataGridView 中未显示的列中 (Visible=False)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T11:44:38.950

如果您处理 RowDataBound 事件，您可以检查数据的值并修改单元格的属性或在该事件处理程序中应用不同的样式。

```
protected void Page_Load(object sender, EventArgs e)
{
    GridView g1 = new GridView();
    g1.RowDataBound += new GridViewRowEventHandler(g1_RowDataBound);
}

void g1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if(e.Row.RowType == DataControlRowType.DataRow)
    {
        // Check the Value
        if(e.Row.Cells[1].Text = someValue)
        {
            e.Row.Cells[1].CssClass = "colorCellRed";
        }

    }
} 
```

那应该给你你正在寻找的东西。如果您在 VB 而不是 C# 中需要它，请告诉我。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T11:49:39.907

RowDataBound，如前所述；您还可以检查数据对象的值，以及网格本身的文本：

```
void gridView_DataBound（对象发送者，GridViewEventArgs e）
{
  if (e.Row.RowType == DataControlRowType.DataRow)
  {
    var myObject = (myObject)e.DataItem;
    如果 (myObject.IsOverdue())
    {
      e.Row.CssClass = "过期";
    }
  }
}

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-14T14:03:41.997

另一种选择是使用 CellFormatting 事件。第一个选项显示访问绑定数据项，如果您没有为相关数据设置列，则该选项很有用。如果有列是否可见，则第二个选项有效。

```
 private void dataGridView_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
        {
            if (((MyDataObject)dataGridView.Rows[e.RowIndex].DataBoundItem).Condition == Value)
            {
                e.CellStyle.BackColor = System.Drawing.Color.Gold;

            }
        } 
```

// 选项二——可以使用 ColumnIndex 代替 ColumnName

```
 private void dataGridView_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
        {
            if (dataGridView["ColumnName", e.RowIndex].Value).Condition == TargetValue)
            {
                e.CellStyle.BackColor = System.Drawing.Color.Gold;

            }
        } 
```

# excel - 在 Excel 2007 中使用 UDF 中的表

> ID：190915
> 
> 赞同：1
> 
> 时间：2008-10-10T11:35:22.773
> 
> 标签：excel, user-defined-functions, vba

我正在为 Excel 2007 编写一个 UDF，我想将一个表传递给它，然后在 UDF 中引用该表的部分内容。因此，例如，我的名为“Stock”的表可能看起来像这样：

> 名称 库存成本项目
> 
> 泰迪熊 £10 10
> 
> 棒棒糖 20p 1000

我有一个 UDF，我想计算所有库存物品的总成本（实际的例子要复杂得多，如果没有非常复杂的公式就无法完成）

理想情况下，UDF 的语法看起来像

```
TOTALPRICE(Stock) 
```

据我所知，这意味着 UDF 将具有签名

```
Function TOTALPRICE(table As Range) As Variant 
```

我遇到的问题是如何引用表的列并遍历它们。理想情况下，我希望能够引用列标题（例如 table[Cost]）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T11:58:57.753

这是非常基本的（不是双关语），但它会按照您的描述进行。对于较大的表，它可能会变得很慢，因为它在宏函数和工作表之间来回移动，并且这种活动加起来。

它假定您有一行标题和一列名称（因此 For 循环变量从 2 开始）。

有各种各样的事情可能是必要的——我们可以把它们留到另一个问题或另一个问题上。

请注意，该函数返回一个“变体”，顺便说一句......

```
Public Function TotalPrice(table As Range) As Variant

Dim row As Long, col As Long
Dim total As Double

    For row = 2 To table.Rows.Count
        For col = 2 To table.Columns.Count
            TotalPrice = TotalPrice + table.Cells(row, col) * table.Cells(row, col + 1)
        Next
    Next

End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T17:12:53.640

注意：我没有 Excel 2007，我正在尝试使用 Web 上的 MSDN doc 编写此内容。
看起来该范围将具有 ListColumns 集合

因此，语法可以是 table.ListColumns("Cost")。
这行得通吗？

# c# - 'from/where/select' 关键字是如何在 LINQ 和 C# 的底层实现的？

> ID：190936
> 
> 赞同：7
> 
> 时间：2008-10-10T11:45:54.377
> 
> 标签：c#, .net, linq

当我在 import [System.Linq namespace](http://msdn.microsoft.com/en-us/library/system.linq.aspx)之后键入“from”（在[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)查询中）时，它被理解为关键字。这种魔法是如何发生的？

'from' 是某种类型的扩展方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T11:49:32.357

实际上，是的 - LINQ 关键字映射到扩展方法。但实际上，它更有趣；从字面上看，就好像编译器直接替换了一些关键方法，即

```
var qry = from cust in db.Customers
          where cust.IsActive
          select cust; 
```

变成：

```
var qry = db.Customers.Where(cust => cust.IsActive); 
```

（如果我们有一个重要的选择，它会添加 .Select(...some projection...)

不同的 LINQ 关键字映射到不同的方法 - 即有 OrderBy、GroupBy、ThenBy、OrderByDescending 等。

在`IEnumerable<T>`/的情况下`IQueryable<T>`，然后通过扩展方法解决这些问题（通常由`Enumerable`/提供`Queryable`）- 但是，如果您的可查询对象声明了自己的 Where/OrderBy/etc，那么这些将优先使用。

Jon Skeet 在[C#](http://www.manning.com/skeet/)的后半部分详细介绍了这一点。我还看到[了 Jon 的一个例子](http://msmvps.com/blogs/jon_skeet/archive/2008/02/29/odd-query-expressions.aspx)，他在其中讨论了一些非常奇怪的含义——比如在一个类型上调用静态方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T11:55:01.037

Marc Gravell 很好地[回答了这个问题](https://stackoverflow.com/questions/190936/how-is-fromwhereselect-keywords-impemented-under-the-hood-clinq#190948)，但我无法抗拒提及[查询表达式可以做的奇怪事情](http://msmvps.com/blogs/jon_skeet/archive/2008/02/29/odd-query-expressions.aspx)的诱惑。编译器真的不太关心它如何找到“Select”成员或“Where”等。

编译器在进行正常编译之前将代码翻译成“没有查询表达式的 C# 3.0”的方式非常漂亮——这是一种将新功能引入语言的绝妙方式，但只会对规范的一个孤立部分产生影响。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-10T11:48:25.997

“from”是一个语言关键字（就像“if”或“foreach”一样）。

您甚至不需要导入 System.Linq 即可使用“from”，但您需要使用 3.5 框架。

# wpf - WPF 或 Silverlight 中的屏幕闪烁效果

> ID：190937
> 
> 赞同：5
> 
> 时间：2008-10-10T11:46:19.243
> 
> 标签：wpf, silverlight, xaml

我正在寻找一种方法来为我正在开发的全屏 WPF 应用程序创建“看起来很酷”的效果 - 一种“屏幕闪烁”效果，可以在整个屏幕上进行动画处理或移动以提供闪亮的显示体验. 我正在考虑创建一个带有高亮渐变和透明背景的大矩形，可以在屏幕上设置动画。任何想法如何在 XAML 中有效地做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-20T12:53:08.620

我想出了一个看起来不错的解决方案。我在 Blend 2.0 SP1 中编写的一些示例 XAML 如下所示：

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Class="ScreenGlintApplication.Window1"
    x:Name="Window"
    Title="Window1"
    Width="500" Height="250" Background="#FF000000" Foreground="#FF3EE229" >

    <Grid x:Name="LayoutRoot">
        <TextBlock TextWrapping="Wrap" FontSize="40" >
        <Run Text="This is some sample text to have something to work with. Have a nice day! /Johan"/>
        </TextBlock>
        <Canvas Panel.ZIndex="99" >
        <Rectangle x:Name="ScreenGlintRect"  
            Width="{Binding Path=ActualWidth, ElementName=Window, Mode=Default}" 
            Height="{Binding Path=ActualHeight, ElementName=Window, Mode=Default}" 
            Opacity="0.4" >
            <Rectangle.Triggers> 
                <EventTrigger RoutedEvent="Rectangle.Loaded"> 
                  <BeginStoryboard> 
                    <Storyboard> 
                    <DoubleAnimation Storyboard.TargetName="ScreenGlintRect" 
                    Storyboard.TargetProperty="(Canvas.Left)"
                    From="-500" To="1000" Duration="0:0:2" />
                    </Storyboard> 
                  </BeginStoryboard> 
                </EventTrigger> 
          </Rectangle.Triggers> 

            <Rectangle.Fill>
                <LinearGradientBrush StartPoint="0,1" EndPoint="1,1">
                    <GradientStop Color="Transparent" Offset="0.0" />
                    <GradientStop x:Name="GlintColor" Color="LightGreen" Offset="0.50" />
                    <GradientStop Color="Transparent" Offset="1" />
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle>
        </Canvas>
    </Grid>
</Window> 
```

一个选项是在后面的代码中执行此操作，如果您想对动画进行精细控制，这非常简洁。例如：

```
 ScreenGlintRect.Width = Width;
    ScreenGlintRect.Height = Height;
    var animation = new DoubleAnimation
    {
        Duration = new Duration(TimeSpan.FromSeconds(2)),
        From = (-Width),
        To = Width * 2
    };
    ScreenGlintRect.BeginAnimation(Canvas.LeftProperty, animation); 
```

这是我正在使用的代码，它看起来对我来说已经足够好了。如果你有硬件加速，你可以尝试添加一些模糊。您可能需要调整代码并隐藏/显示矩形，但基本上就是这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T12:59:39.160

很容易将任何透明面板放置在主网格的“顶部”，并为放置在面板中的元素设置动画。要将面板放在“顶部”，只需将其放在 XAML 层次结构的末尾，在任何其他元素之后。或者，您可以使用“ZIndex”属性。

洛朗

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T14:43:46.203

您可以像 LBugnion 所说的那样在顶部放置一个透明面板，但不要忘记有很多方法可以做到这一点：

1.  将面板的可见性更改为隐藏。
2.  将不透明度更改为 0。
3.  将颜色的 Alpha 更改为 0。

如果您只更改 Alpha，即使您看不到颜色，它仍然是*可点击的。*

离题但是：尽量使效果微妙，也许有一个开/关选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T16:57:02.440

附加到[这篇](http://mattserbinski.com/blog/look-and-feel-progressbar)关于进度条的文章是示例代码，它有一个 Vista 风格的进度条，它有 Vista 风格的闪烁。它使用边框和画笔以及转换器来创建动画。我不能说我完全理解那里的所有内容，但效果很好。应该很容易复制到您的需要。

# .net - 构建服务器上缺少 T4 模板目录

> ID：190940
> 
> 赞同：2
> 
> 时间：2008-10-10T11:47:13.580
> 
> 标签：.net, build, t4

我刚刚使用 Windows 2008 .NET 3.5 SDK 设置了一个新的构建服务器，由于某种原因它没有安装 c:\Program Files\Common Files\Microsoft Shared\TextTemplating 所以我不能运行 t4 模板它。我查看了添加/删除程序中的安装选项，并检查了每个选项。

任何想法为什么它丢失？任何想法如何取回它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T19:40:44.837

我的理解是 T4 引擎是 Visual Studio 的一个特性，而不是 .NET Framework SDK。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T16:35:56.893

T4 模板引擎随 Visual Studio 2005 SDK 或任何安装的 Visual Studio 2008 一起提供。我没有尝试快速版本来查看 T4 是否存在，但我强烈建议您试一试。

您可以[在此处](http://www.microsoft.com/Express/Download/)下载 Visual Studio 2008 Express 。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-15T22:42:36.013

T4 仅与 Visual Studio 一起安装，而不是 .Net SDK。

但是，从 Visual Studio 2010 SP1 开始，您会发现设置构建服务器所需的所有部分都已获得许可，可以手动复制到您的构建机器上。

查看 VS 安装目录中的 buildserver.txt 文件。

# wysiwyg - 所见即所得编辑器的行业经验

> ID：190956
> 
> 赞同：1
> 
> 时间：2008-10-10T11:55:14.967
> 
> 标签：wysiwyg

只是想了解（网络）开发人员如何绕过（大多数）所见即所得编辑器的短暂失败，即编辑文本的用户并不总是具有足够的 HTML 素养来产生良好/出色的结果。

过去，我们已经辞职，要么锁定编辑器，要么干脆不提供编辑器。

其他人的经历是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T11:58:40.687

如果您有资源（正如问题所暗示的那样），您可以让用户提供他们所知道的内容（Powerpoint、Word、Fireworks 等）的副本和设计，并让能够正确实施的人（但可能无法写出体面的散文等）将其放入 HTML/CMS/magicthing。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T12:25:01.677

如果我正确理解您的问题，我的建议是在编辑器中允许基本的文本格式（粗体、斜体、下划线、分段符等）。除此之外的任何事情都应该由与相应模板对话的 CMS 系统中的自定义字段处理，或者直接由您的设计师/前端人员处理。您的文本编辑器中确实不应该进行任何设计。

此外，使用像[Markdown](http://daringfireball.net/projects/markdown/)这样的模板语言可能会帮助编辑者在格式化他们的页面时感觉更舒服。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T21:55:31.993

有时可以使用[WYMeditor](http://www.wymeditor.org/)之类的东西——它不是那么简单，但会产生干净的语义代码。另一种方法是使用一些类似 wiki 的代码——例如 Markdown。并且您可以通过使用[MarkItUp 编辑器](http://markitup.jaysalvat.com/home/)（它还支持原始 Wiki 和 Textile）等一些助手来简化编辑器的生活。

# asp.net - 使用 asp.net 的 Windows 身份验证问题

> ID：190961
> 
> 赞同：3
> 
> 时间：2008-10-10T11:56:39.253
> 
> 标签：asp.net, iis-6, windows-authentication

我有一个应该从两个 SQL Server 访问数据的 asp.net 应用程序。其中一个 SQL Server 与 IIS 位于同一台机器上（我们称之为 SQLSERVER1），而另一个 SQL Server 位于另一台机器上（SQLSERVER2）。

两个 SQL 服务器都信任连接字符串。在我的 web.config 文件中，模拟已设置为 true。我在 IIS 和 web.config 中都使用 Windows 身份验证。

当我尝试从 SQLSERVER2 访问数据时，我因 user(null) 错误而登录失败。我通过 Windows 登录的用户在 SQLSERVER2 中作为 SQL 服务器帐户存在。

可能的原因是什么？

**注意：** **这是一个新手问题恕我直言**。

**注意：使用的 IIS 是 6.0 (Windows 2003)。它未设置为 IIS 5.0 隔离模式。**

**编辑：被冒充的用户是域用户**

**添加：**

**我还想声明，当我作为运行 IIS 的服务器的客户端访问它时收到此错误消息。换句话说，假设我在机器 A 上工作，IIS 和 SQLSERVER1 在机器 B 上，SQLSERVER2 在机器 C 上。**

**当我在机器 B 上工作时，我没有收到此错误消息。这让我更加难过。**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T13:06:20.767

这绝对是一个**委托**问题。正如一位人士指出的那样，您需要确保正在使用[Kereberos身份验证。](http://en.wikipedia.org/wiki/Kerberos_(protocol))旧式[NTLM](http://en.wikipedia.org/wiki/NTLM)不会削减它。这里有更多关于[Kerberos 与 NTLM](http://blogs.msdn.com/sql_protocols/archive/2006/12/02/understanding-kerberos-and-ntlm-authentication-in-sql-server-connections.aspx)的信息。

简而言之，如果您有一个网络服务器和一个数据库，并且您希望网络服务器在发出数据库请求时模拟用户（以便您可以直接在每个用户或用户组的基础上设置数据库权限），那么您重新执行双跳。凭据必须首先从用户的计算机传递到网络服务器，然后再传递到数据库。可以想象，数据库必须信任网络服务器“不作恶”，否则这可能是一个极其危险的安全漏洞。因此，您必须设置 Windows Server 世界中所谓的**“委托”** ...

[微软在这里](http://msdn.microsoft.com/en-us/magazine/cc163740.aspx)有一篇关于这一切的好文章。[此外，您可以查看这样](http://www.databasejournal.com/features/mssql/article.php/3696506)的文章以了解如何设置它。我们经常遇到这种情况，一开始可能会很痛苦，尤其是因为作为开发人员，您可能无法直接控制服务器（尤其是生产服务器），并且您必须花费大量时间来处理楼下的服务员。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T12:13:37.300

您可能会遇到此问题，因为基于非 Kerberos 的模拟 (NTLM) 仅在本地计算机（网络服务器）上有效。如果您希望能够使用这些凭据访问另一台计算机，则需要确保您使用的是 Kerberos。

试试这个： http: [//support.microsoft.com/kb/810572](http://support.microsoft.com/kb/810572)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T12:35:01.940

您对网络服务器的身份验证不会传递到 sql 服务器。Web 服务器正在使用运行应用程序池的帐户向 SQL Server 进行身份验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T12:54:35.660

您应该检查 SQLSERVER1 的计算机帐户是否已启用委派信任。否则 SQLSERVER2 将不信任在 SQLSERVER1 上运行的模拟。这是除了确认首先使用 Kerberos 设置模拟之外的。这也假设服务器和用户都是同一个域的成员。

顺便说一句，你确定你想以这种方式做事，你最终会创建更多的连接，因为它们最终对用户来说是独一无二的吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T13:16:51.557

您是否尝试从 Server1 使用 SQL SErver 管理员访问 server2 上的数据库并成功连接？

如果不是，那么这可能是因为默认情况下 SQL Server 安装自身时默认关闭了 tcp。

您需要确保已为 server2 打开此功能以允许 server1 进行连接。server1 连接没有问题，因为它可以使用共享内存连接。

# iphone - 我可以访问 iPhone 上的钥匙串吗？

> ID：190963
> 
> 赞同：29
> 
> 时间：2008-10-10T11:57:44.400
> 
> 标签：iphone, objective-c, cocoa-touch, keychain

这个问题讨论了使用 crypt() 函数[在 iPhone 上加密数据。](https://stackoverflow.com/questions/189925/password-encryption-in-iphone-apps)作为替代方案，iPhone 上是否有钥匙串，如果有，我将使用什么代码来访问它以存储登录详细信息，然后在应用程序中为我们检索它们？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-10-15T03:41:55.257

另一件需要注意的事情：当使用 iPhone SDK 的旧版本（2.x、3.x）时，钥匙串 API 在模拟器中不起作用。这可以在测试时为您节省很多挫败感！

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-10-10T12:32:03.647

您可以使用一个钥匙串 - 对于代码，最好的办法是查看 Apple 的 GenericKeychain 示例应用程序：

[通用钥匙串示例](https://developer.apple.com/library/ios/DOCUMENTATION/Security/Conceptual/keychainServConcepts/iPhoneTasks/iPhoneTasks.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-19T21:05:49.413

我真的很喜欢[Buzz Anderson 的 Keychain 抽象层](http://github.com/ldandersen/scifihifi-iphone/tree/master)，我热切地等待[Jens Alfke 的 MYCrypto](http://mooseyard.com/projects/MYCrypto/)达到可用状态。后者在允许在 Mac OS X 和 iPhone 上使用相同的代码方面做得很好，尽管它的功能只是模仿钥匙串的一小部分。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-09-06T02:04:22.803

这是我用来在钥匙串中存储键/值对的方法。确保将 Security.framework 添加到您的项目中

```
#import <Security/Security.h>

// -------------------------------------------------------------------------
-(NSString *)getSecureValueForKey:(NSString *)key {
    /*

     Return a value from the keychain

     */

    // Retrieve a value from the keychain
    NSDictionary *result;
    NSArray *keys = [[[NSArray alloc] initWithObjects: (NSString *) kSecClass, kSecAttrAccount, kSecReturnAttributes, nil] autorelease];
    NSArray *objects = [[[NSArray alloc] initWithObjects: (NSString *) kSecClassGenericPassword, key, kCFBooleanTrue, nil] autorelease];
    NSDictionary *query = [[NSDictionary alloc] initWithObjects: objects forKeys: keys];

    // Check if the value was found
    OSStatus status = SecItemCopyMatching((CFDictionaryRef) query, (CFTypeRef *) &result);
    [query release];
    if (status != noErr) {
        // Value not found
        return nil;
    } else {
        // Value was found so return it
        NSString *value = (NSString *) [result objectForKey: (NSString *) kSecAttrGeneric];
        return value;
    }
}

// -------------------------------------------------------------------------
-(bool)storeSecureValue:(NSString *)value forKey:(NSString *)key {
    /*

     Store a value in the keychain

     */

    // Get the existing value for the key
    NSString *existingValue = [self getSecureValueForKey:key];

    // Check if a value already exists for this key
    OSStatus status;
    if (existingValue) {
        // Value already exists, so update it
        NSArray *keys = [[[NSArray alloc] initWithObjects: (NSString *) kSecClass, kSecAttrAccount, nil] autorelease];
        NSArray *objects = [[[NSArray alloc] initWithObjects: (NSString *) kSecClassGenericPassword, key, nil] autorelease];
        NSDictionary *query = [[[NSDictionary alloc] initWithObjects: objects forKeys: keys] autorelease];
        status = SecItemUpdate((CFDictionaryRef) query, (CFDictionaryRef) [NSDictionary dictionaryWithObject:value forKey: (NSString *) kSecAttrGeneric]);
    } else {
        // Value does not exist, so add it
        NSArray *keys = [[[NSArray alloc] initWithObjects: (NSString *) kSecClass, kSecAttrAccount, kSecAttrGeneric, nil] autorelease];
        NSArray *objects = [[[NSArray alloc] initWithObjects: (NSString *) kSecClassGenericPassword, key, value, nil] autorelease];
        NSDictionary *query = [[[NSDictionary alloc] initWithObjects: objects forKeys: keys] autorelease];
        status = SecItemAdd((CFDictionaryRef) query, NULL);
    }

    // Check if the value was stored
    if (status != noErr) {
        // Value was not stored
        return false;
    } else {
        // Value was stored
        return true;
    }
} 
```

值得注意的是，如果用户删除您的应用，这些键/值不会被删除。如果用户删除您的应用程序，然后重新安装它，键/值仍然可以访问。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-11T17:14:10.360

还要记住，在生成 AppID 时，如果希望多个应用程序访问相同的 Keychain 信息，则必须生成通配符 AppID (#####.com.prefix.*)...

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-08-16T19:44:04.760

借助 GenericKeychain 示例的最新版本 1.2，Apple 提供了一个钥匙串包装器，该包装器也可以在 iPhone 模拟器上运行。查看这篇文章了解详情：[http ://dev-metal.blogspot.com/2010/08/howto-use-keychain-in-iphone-sdk-to.html](http://dev-metal.blogspot.com/2010/08/howto-use-keychain-in-iphone-sdk-to.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-11T12:55:19.487

这是来自Mr.Granoff [https://github.com/granoff/Lockbox的另一个很好的包装类](https://github.com/granoff/Lockbox)

# python - 从已编译的 re 中获取模式？

> ID：190967
> 
> 赞同：21
> 
> 时间：2008-10-10T11:58:40.920
> 
> 标签：python, regex

假设我已经创建了一个编译的 re：

```
x = re.compile('^\d+$') 
```

有没有办法从 x 中提取模式字符串 (^\d+$)？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-10T12:01:41.273

你可以把它拿回来

```
x.pattern 
```

[来自关于正则表达式对象](https://docs.python.org/3/library/re.html#re.regex.pattern)的 Python文档

# encoding - 如何在经典 ASP 中使用 XMLHttp 对象为 POST 设置字符集？

> ID：190988
> 
> 赞同：5
> 
> 时间：2008-10-10T12:08:28.780
> 
> 标签：encoding, asp-classic, character-encoding, serverxmlhttp

我必须**在经典 ASP 中使用 XMLHttp 对象，**以便通过 HTTP 从服务器到服务器将一些数据发送到另一台服务器：

```
sURL = SOME_URL

Set oXHttp = Server.CreateObject("Msxml2.XMLHTTP")

oXHttp.open "POST", sURL, false 
oXHttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded;charset:ISO-8859-1;"

sPost = SOME_FORM_DATA

oXHttp.send(sPost) 
```

我被告知（消费服务器的维护者），根据我是使用 Windows Server 2000 (IIS 5) 还是 Windows Server 2003 (IIS 6) 中的代码，他会得到**Latin-1** (Windows 2000 Server)或**UTF-8** (Windows Server 2003) 编码的数据。

我没有找到任何属性或方法来设置我必须发送的数据字符集。它是否依赖于某些 Windows 配置或脚本 (asp) 设置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T12:16:36.920

您可以通过设置选项“SXH_OPTION_URL_CODEPAGE”来设置使用的代码页

[http://msdn.microsoft.com/en-us/library/ms763811(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms763811(VS.85).aspx)

您还应该使用“MSXML2.ServerXMLHTTP”对象而不是用于单线程客户端应用程序的“MSXML2.XMLHttp”对象。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-13T15:37:24.233

上面提到 SXH_OPTION_URL_CODEPAGE 的答案有点误导。该选项与我认为问题所在的请求正文的编码无关。

问题中代码示例的问题是在标题中使用“：”而不是“=”。它应该设置如下：

oXHttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded; charset=ISO-8859-1"

# c++ - 使用maven2构建基于autotools的C/C++包

> ID：190996
> 
> 赞同：3
> 
> 时间：2008-10-10T12:11:55.230
> 
> 标签：c++, maven-2, build-automation, autotools

我正在研究一个集合 MATLAB、Java 和 C/C++ 组件，它们都可以互操作，但编译/安装步骤截然不同。我们目前不为 MATLAB 编译任何东西，使用 maven2 进行 Java 构建和单元测试，并使用 autotools 进行 C/C++ 构建和单元测试。

我想使用 maven2 将所有内容移至单个构建和单元测试系统，但找不到一个插件，该插件将允许 C/C++ 代码流保持基于 autotools 并简单地将其包装在 maven 构建中。不得不取消 autotools 支持并在 maven 中重新创建所有依赖项很可能会破坏交易，所以我正在寻找一种让 maven 和 autotools 很好地协同工作的方法，而不是必须在两者之间进行选择。

这是可能的，甚至是可取的吗？有没有我忽略的资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T14:01:01.407

我真的不知道 autotools，但你不能使用[maven exec 插件](http://mojo.codehaus.org/exec-maven-plugin/)，它可以让你执行系统命令（或 Java 程序）吗？例如：

```
<build>
  <plugins>
    <plugin>
      <groupId>org.codehaus.mojo</groupId>
      <artifactId>exec-maven-plugin</artifactId>
      <executions>
        <execution>
          <id>exec-one</id>
          <phase>compile</phase>
          <configuration>
            <executable>autogen</executable>
            <arguments>
              <argument>-v</argument>
            </arguments>
          </configuration>
          <goals>
            <goal>exec</goal>
          </goals>
        </execution>

        <execution>
          <id>exec-two</id>
          <phase>compile</phase>
          <configuration>
            <executable>automake</executable>
            <arguments>
              <argument>-v</argument>
              <argument>[other arguments]</argument>
            </arguments>
          </configuration>
          <goals>
            <goal>exec</goal>
          </goals>
        </execution>
      </executions>
    </plugin>
  </plugins>
</build> 
```

我没有测试上面的 pom 片段，但它给了你一些关于如何继续的提示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T10:51:15.657

您确实忽略了 maven [cbuild 父](http://mojo.codehaus.org/cbuild-parent/index.html)套件。查看“make-maven-plugin”部分了解更多详细信息。

# css - 是否可以通过 CSS 将 SVG 图像添加到网页？

> ID：190999
> 
> 赞同：4
> 
> 时间：2008-10-10T12:14:22.697
> 
> 标签：css, svg, vector-graphics

我刚开始在网页中尝试使用 SVG，我发现只能使用`<object />`标签将 SVG 图像添加到 HTML 中，这`<img />`与我预期的不同。大多数时候，我通过 CSS 向网页添加图形，因为它们是网站展示的一部分，而不是内容。

我知道可以将 CSS*应用于*SVG，但是否可以使用纯 CSS 将矢量图像添加到 HTML 元素？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-25T09:09:52.603

`<img>`自 Opera 9 以来，CSS（列表图像、背景图像、内容）中和 CSS 中都支持SVG。Opera 10 更好。Webkit/Safari 也支持 svg `<img>`。

这里有一些[例子](https://web.archive.org/web/20080420175708/http://my.opera.com/SVGraphics/forums/topic.dml?id=203830)，还有一些例子在[dev.opera.com](https://web.archive.org/web/20071006010144/http://dev.opera.com/articles/view/new-development-techniques-using-opera-k/)和[annevankesteren.nl](http://annevankesteren.nl)

如果您正在寻找内联 svg 示例，请查看[Sam Ruby 的网站](http://intertwingly.net/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T12:20:13.607

您可以尝试使用 content 属性引用 SVG 文件，但我认为它不受支持。如果它受到支持，它将如下所示：

```
.putapicturehere:before {
  content: url(mysvgfile.svg);
} 
```

这绝对不能在 IE 中工作——它可能在最新的 Firefox 中工作。

对于 CSS 浏览器支持问题，我总是[参考 quirksmode.org 。](http://www.quirksmode.org/css/beforeafter.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T12:16:48.963

您可能需要编写一些 CSS-helper JavaScript 来从屏幕外的 img 中读取图像并将其放入您的对象标签中。这样您仍然可以使用 CSS 进行控制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-24T18:58:34.337

据我所知，Opera 9 和 WebKit（== Safari 和 Chrome）在 PC 上可以做到这一点，而且有传言说 FF3.5 也可以。

实际上，自从苹果在半年前就为 iPhone 的 Safari 添加了 SVG 支持以来，我不确定它是否有效，但值得一试。

干杯，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-12T20:55:17.247

上次我尝试，差不多一年前，它没有工作。但是，您可以混合使用 svg 和 xhtml 标记。唯一的问题是页面必须具有正确的 mime 类型（application-xml 或类似的东西），否则浏览器将忽略 svg。

如果您想要严格分离内容和表示，内联 svg 并不是一个完美的解决方案，但它似乎是最受支持的使用 svg 的方式。**************