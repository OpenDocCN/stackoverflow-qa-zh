# StackOverflow 问答 10289000-10289999

# eclipse - 是否有适用于 Eclipse 的 Launchy 或 Quicksilver？

> ID：10289006
> 
> 赞同：0
> 
> 时间：2012-04-23T22:07:58.617
> 
> 标签：eclipse, eclipse-plugin, keyboard-shortcuts

我正在使用 Eclipse/Windows，如果能够按下 alt-space、键入文件名的前几个字母并跳转到该文件，它会加快速度。我一直在谷歌搜索生产力工具，现在有六个新的 Eclipse 插件，但没有一个能做这件事。

是否存在这样的插件/工具，或者可以用来伪造它的宏组合？

到目前为止，我发现的最接近的是[InstaSearch](http://marketplace.eclipse.org/content/instasearch)。也许可以修改它以包含文件名。[Ctrl-Shift-R](https://rayfd.wordpress.com/2007/05/20/10-eclipse-navigation-shortcuts-every-java-programmer-should-know/)似乎也有帮助，尽管在开始进行通用搜索时必须输入 * 会阻碍聚会。[GoToFile](http://www.muermann.org/gotofile/)不会安装在 3.6 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:40:14.583

如果您只是想在项目中打开一个类，您可以使用 CTRL+Shift+T 并输入您的类名或使用驼峰式大小写。CTRL+SHIFT+R 将在您的工作区中查找其他文件。

# ios - iOS沙盒测试用户账号订阅管理

> ID：10289011
> 
> 赞同：44
> 
> 时间：2012-04-23T22:09:03.990
> 
> 标签：ios, testing, app-store, app-store-connect, storekit

我目前正在尝试将 IAP 添加到现有应用程序中。为此，我添加了一些产品并创建了一些测试用户。这些产品是定期订阅。我正在测试的设备是装有 iOS 5.1 的 iPhone 4S。

我可以成功地在商店中查询我的产品，并通过我的新测试用户成功购买它们。我遇到的问题是，如果我尝试从商店设置应用程序管理我的订阅，它会强制我通过告诉我“此帐户尚未用于在 AppStore 中购买任何东西，请检查您的帐户并继续”来查看我的帐户。” 如果我查看该帐户，它不会让我在不提供信用卡信息的情况下继续。

最终结果是我永远无法取消我的测试订阅。我删除了测试用户并创建了新用户，删除了应用程序并重新安装，终止了 StoreApp 和设置应用程序，重新启动设备，在购买前通过电子邮件验证了帐户，在购买前没有通过电子邮件验证帐户......所有排列似乎失败了。

有时我会购买两次相同的订阅，这会提示 StoreKit 要求我管理我的订阅设置。有时这会导致之前的“帐户审核”过程，有时会导致“无法连接到 iTunes Store”的警报。

我已经没有如何继续的想法了。

编辑 - 这是我创建的任何 iTunesConnect 测试用户的事件流

初始订阅
![初始订阅](../Images/1f15b5a7886f94c1ad7e86cec4986aec.png)

使用现有 ID
![使用现有 ID](../Images/ba01ecbc9fe2c71e8881a53422e501fa.png)

测试账户登录
![测试账户登录](../Images/19ccdcfa7199effa650e1b4939d38d66.png)

管理订阅
![管理订阅](../Images/ea44883b0f78aca73496ddd68ee9a33f.png)

应用商店登录
![应用商店登录](../Images/e7b0c29238227452a537ffeafdb31dbe.png)

无法连接到 AppStore
![无法连接](../Images/584adb0986cb2d75dd94cef65a824940.png)

查看您的帐户
![审查](../Images/d84f14a3d30623153e5472dac91798c4.png)

然后，审查过程迫使我输入信用卡信息，即使它的地址是“1 Infinite Loop Cupertino, CA”（即它知道这是一个测试帐户）。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-08-19T15:58:05.263

您无法真正在沙盒中管理订阅，但正如 Jean-Paul de Ville de Goyet 在[Apple Developer Forums](https://devforums.apple.com/thread/105350?tstart=0)上发现的那样：

> 1 个月的订阅每 5 分钟自动更新一次。到现在为止还挺好。它们会自动更新 5 次然后停止，因此 25 分钟后您将收到 21006 错误。但是，即使重新购买相同的订阅，它也不会在同一个测试帐户上再次自动续订，因为它已经自动续订了 5 次。因此，如果您想测试续订并且您一直在搞乱这些订阅，您需要创建一个新的 iTunes 连接测试用户。老实说，这很烦人，如果我们可以重置测试用户帐户的整个购买历史记录会容易得多。

我以同样的方式测试了我的订阅。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2017-03-08T11:28:18.333

苹果开发者有回应。（Rich Kubota）关于沙盒环境中的订阅测试。

> 这是应用内购买模拟过程中的一个漏洞。没有支持的方式来模拟取消过程或模拟用户 iTunes 应用程序的管理订阅过程。此限制也存在于应用程序的 TestFlight 版本中。当您将应用程序的 TestFlight 构建提交给用户并测试应用程序时，用户帐户实际上是在沙盒环境中运行的。您已经验证了这一点，因为 TestFlight 应用程序不会在 TestFlight 用户 iTunes 托管订阅部分中显示为托管应用程序。那是因为应用程序处于沙盒环境中，iTunes 应用程序对此一无所知。
> 
> 自从我在这个论坛上回复以来已经有一段时间了，但是，验证应用程序是否会处理自动续订过程的最佳方法是验证该应用程序是否也通过 transactionObserver 正确处理自动续订订阅续订的检测. 例如，如果您在沙盒环境中购买 1 个月订阅。然后kill app，等待6分钟，然后重启app，transactionObserver是否检测到有一个不完整的Transaction（压缩的1个月续订）需要处理。
> 
> 这与用户在 iTunes 订阅管理页面中重新启动订阅的情况非常相似。该交易由 iTunes 商店记录，并启用了用户帐户/应用程序包 ID 的不完整交易。当应用程序启动并激活 transactionObserver（通过调用 addTransactionObserver）时，检测到不完整的Transaction，并调用 updatedTransaction 的 delefgate 方法来处理更新。然后，应用程序可以验证 applicationReceipt 以验证现在是否存在自动续订订阅项的 in_app 数组项，该数组项的 expire_date 大于当前日期，并且知道自动续订订阅 product_id 处于活动状态。
> 
> 至于测试自动续订是否被取消，这又需要iTunes Store服务器支持来模拟。但是，收据验证过程每天都在工作，并且可以检测哪个 in_app 数组项对于自动续订订阅是最新的，然后检测是否设置了 cancel_date 会告诉应用订阅已被取消。请注意，仅检测到任何元素的 cancel_date 字段都可能导致误报。用户可能早些时候取消了自动续订订阅，然后认为它不再那么糟糕并重新购买了该商品。为此，逻辑需要确保在最新的 in_app 数组元素中设置了 cancel_date 字段，才能知道当前订阅实际上已被取消。我的一个问题 m 试图确定 - 取消的项目是否会将 expire_date 上移至 cancel_date，以便取消的订阅可以与过期的订阅显示相同。似乎是正确的举动 - 但此信息由 iTunes Store 服务器团队控制。
> 
> 如果您想在沙盒中寻求一种机制来模拟生产商店环境的这些功能，我建议您使用 Apple Developer Bug Report 网页提交增强请求。请为错误报告选择 iTunesConnect 产品，因为建议是由 iTunes Store 模拟的，而不是 iOS。

# jpa - JPA左外连接：为空或条件

> ID：10289012
> 
> 赞同：7
> 
> 时间：2012-04-23T22:09:12.830
> 
> 标签：jpa, spring-data-jpa

我正在使用 jpa 查询，我可以找到合适的解决方案。我希望你能帮助我。我将开始描述我的模型。我有一个属于一家公司的资源。公司下设多家分公司。该资源关联了几个资源所有权配置。资源所有权描述了哪些分支可以使用该资源以及此配置有效的时间段。但是，如果没有指定分支机构，则该资源可以被公司的所有分支机构使用。

这是模型。省略了 getter 和 setter

```
@Entity
public class Resource extends ActivableAbstractModel{

    /**
     * the serial version uid
     */
    private static final long serialVersionUID = -8568230011058859716L;

    public Resource() {
        this.ownerShipConfigurations = new ArrayList<>();
    }

    @Column(length=30)
    private String name;

    private String description;         

    @ManyToOne(cascade = {}, fetch = FetchType.LAZY, targetEntity=Company.class)
    @ForeignKey(name = "FK_company_resource")
    @JoinColumn(nullable = false)
    private Company company;

    @OneToMany(cascade={CascadeType.ALL}, orphanRemoval=true, mappedBy="resource")
    private List<ResourceOwnerShipConfiguration> ownerShipConfigurations;

} 
```

实体

```
@Entity
public class ResourceOwnerShipConfiguration extends AbstractModel{

    /**
     * the serial version uid
     */
    private static final long serialVersionUID = -4560593105136625002L;

    @Embedded
    private Period period;

    @ManyToOne(targetEntity=Company.class)
    private Company company;

    @ManyToMany(targetEntity=Branch.class)
    private List<Branch> branches;

    @ManyToOne
    private Resource resource;  
} 
```

分支模型和公司模型的重要之处在于两者都有一个 ID。

这是我的查询：

```
@Query("select R from Resource R join R.ownerShipConfigurations oc join oc.branches b  where R.active = true and R.company.id = :companyId and (oc.branches IS EMPTY or  b.id = :branchId)") 
```

我想做的事？我想要属于公司的所有资源（使用 companyId）并且可以由特定分支使用（使用 branchId）。但是，如果资源没有分支列表（在 ResourceOwnerShipConfiguration 中定义），则必须返回。

希望很清楚。

使用该查询我无法检索没有分支列表的资源。只是与特定分支相关联的那些。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T13:46:43.483

您需要使用 LEFT JOIN，

```
select R from Resource R join R.ownerShipConfigurations oc left join oc.branches b  where R.active = true and R.company.id = :companyId and (b.id is null or  b.id = :branchId) 
```

见， [http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/JPQL#LEFT_JOIN](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/JPQL#LEFT_JOIN)

# java - JTable 和迭代绑定的 ObservableList

> ID：10289013
> 
> 赞同：0
> 
> 时间：2012-04-23T22:09:19.063
> 
> 标签：java, swing, binding, jtable

我有一个绑定到 ObservableList 的 JTable。T 是从我的网络服务生成的 bean。

所以我的问题是，如何从表实例中迭代绑定列表。getModel() 是“org.jdesktop.swingbinding.JTableBinding$BindingTableModel”

这个想法是：

((ObservableList)table.getModel()).foreach(...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:12:42.337

一个 TableModel 是一个 TableModel 是一个 TableModel ，而不管扩展它的最终具体类是什么。与所有 TableModel 一样，您可以调用 、 和 的接口方法，`getRowCount()`以允许您遍历您的表并提取您的值。`getColumnCount()``getValueAt(...)`

这是[BindingTableModel 的 API的链接](http://www.jarvana.com/jarvana/view/net/java/dev/beansbinding/beansbinding/1.2.1/beansbinding-1.2.1.jar!/org/jdesktop/swingbinding/JTableBinding%24BindingTableModel.class?classDetails=ok)

它看起来实现了 TableModel，但没有扩展 AbstractTableModel 或 DefaultTableModel。

# ios - 应该对通过 scheduleTimerWithTimeInterval 分配给的 NSTimer 属性使用什么保留策略？

> ID：10289016
> 
> 赞同：2
> 
> 时间：2012-04-23T22:09:34.477
> 
> 标签：ios

我正要在我的一个类中添加一个 NSTimer 属性，以便可以在必要时/如果需要取消它。我将与 +scheduledTimerWithTimeInterval 一起使用它：

我应该使用 strong、assign、copy 或 unsafe_unretained 吗？（带弧）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:18:53.270

用于`strong`此。通常，您还需要像这样覆盖设置器：

```
- (void)setTimer:(NSTimer *)aTimer {
  if (aTimer != _timer) {
    [_timer invalidate];
    _timer = aTimer;
  }
} 
```

这样，当您更改或清除（nil）计时器时，旧计时器将自动失效（因此将来不会触发）。

如果`aTimer != _timer`您执行类似`self.timer = self.timer`. 虽然您可能永远不会直接这样做，但有时可能会间接发生。

# c++ - 如何在 C++ 中格式化日期和时间字符串

> ID：10289017
> 
> 赞同：28
> 
> 时间：2012-04-23T22:09:34.703
> 
> 标签：c++, datetime, mfc

假设我有 time_t 和 tm 结构。我不能使用 Boost 但 MFC。我怎样才能使它像下面这样的字符串？

```
Mon Apr 23 17:48:14 2012 
```

使用 sprintf 是唯一的方法吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-04-23T22:16:23.070

C 库[`strftime`](http://en.cppreference.com/w/c/chrono/strftime)专门用于格式化日期/时间。您要求的格式似乎对应于以下内容：

```
char buffer[256];

strftime(buffer, sizeof(buffer), "%a %b %d %H:%M:%S %Y", &your_tm); 
```

我相信[`std::put_time`](http://en.cppreference.com/w/cpp/io/manip/put_time)使用类似的格式字符串，尽管它确实使您不必显式处理缓冲区。如果您想将输出写入流，这非常方便，但是要将其转换为字符串并没有多大帮助——您必须执行以下操作：

```
std::stringstream buffer;

buffer << std::put_time(&your_tm, "%a %b %d %H:%M:%S %Y");

// now the result is in `buffer.str()`. 
```

`std::put_time`是 C++11 的新功能，但 C++03`time_put`在语言环境中有一个方面*可以*做同样的事情。如果没记错的话，我确实设法让它工作了一次，但在那之后觉得这不值得麻烦，从那以后我就再也没有做过了。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-23T22:14:04.173

我会试试`std::put_time`的。有关如何使用它的信息，请参阅[此处的链接。](http://en.cppreference.com/w/cpp/io/manip/put_time)它支持完整格式的字符串等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T19:51:39.347

如果您需要担心不同语言环境的格式设置，请不要忘记使用当前语言环境初始化 CRT。这也会影响 COleDateTime。

```
setlocale(LC_COLLATE,“.OCP”); // sets the sort order

setlocale(LC_MONETARY, “.OCP”); // sets the currency formatting rules

setlocale(LC_NUMERIC, “.OCP”); // sets the formatting of numerals

setlocale(LC_TIME, “.OCP”); // defines the date/time formatting 
```

请参阅与 MSDN 文章和其他来源相关的我的博客文章。 [http://gilesey.wordpress.com/2012/12/30/inittailizing-mfccrt-for-consumption-of-regional-settings-internationalizationc](http://gilesey.wordpress.com/2012/12/30/initailizing-mfccrt-for-consumption-of-regional-settings-internationalizationc)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-23T22:31:45.680

`ctime()`生成该格式的字符串。它需要一个指向 a 的指针`time_t`。
还有`asctime()`一个指针指向 a`struct tm`并做同样的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T02:46:23.503

```
CTime obj1(time_tObj);

CString s = obj1.Format( "%a %b %d %H:%M:%S %Y" ); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-23T22:17:36.640

MFC 有[`COleDateTime`](http://msdn.microsoft.com/en-us/library/38wh24td.aspx)which 有一个构造函数，它接受`time_t`（或`__time64_t`）并有一个[`Format`](http://msdn.microsoft.com/en-us/library/bab3feb1.aspx)方法。

# selenium-webdriver - 无法在 Selenium-2 中输入与号“&”

> ID：10289022
> 
> 赞同：5
> 
> 时间：2012-04-23T22:10:01.317
> 
> 标签：selenium-webdriver

我想用 selenium web-driver 在文本框中输入 & 键。但是 selenium-2 在键入 & 符号时会从 type-box 失去焦点。我的命令是 self.type("&", :update => true)

我知道在 selenium 中，密钥以 UTF_8 格式发送，并且我尝试发送与 & 符等效的内容，但行为仍然相同（如预期的那样）。我知道 XML 或 HTML 支持带有一些特殊转义字符的 & 符号。我想知道有没有办法在 send_keys 或 type_keys 命令中用一些转义序列（如（HTML 代码）“&”或“&”替换 & 符号？

或者有没有其他方法可以在 selenium-2 的文本框中键入 & 符号？

请让我知道你的建议。

谢谢， 斯里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T17:12:33.070

我花了好几天的时间在这上面，最终@Asaph 告诉我“暂时删除你所有的 javascript，看看这是否是导致 & 符号空白的原因。” 他是对的。现在`$searchBox->send_keys("bath & body");`工作正常。

我最终将其缩小到干扰的 Jquery-ui 自动完成的一部分。此属性： `source:function( request, response ) { //implementation removed }` 所有其他 javascript 都可以保留并正常工作。我现在想弄清楚为什么 Jquery-ui > Autocomplete > Source 与 WebDriver 冲突，看看是否有解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-26T12:10:52.760

我的要求是在文本字段中输入“R&d”，在下面的代码中尝试过，它起作用了。

```
textBox.sendKeys("R/&d")
textBox.sendKeys(Keys.LEFT);
textBox.sendKeys(Keys.LEFT);
textBox.sendKeys(Keys.BACK_SPACE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T19:18:15.047

正如[这里](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Predefined_entities_in_XML)所说，“ `&amp;`”是 & 符号的 HTML 实体。试试看。

但是，我能够毫无问题地通过 WebDriver 和 Java 放置一个 & 符号。在其他一些输入上尝试一下，看看它是否不是本地问题......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-05T15:25:24.733

我遇到了同样的问题，并通过执行 JavaScript 而不是使用 Selenium SendKeys 方法来解决它。

> IJavaScriptExecutor jsExec = (IJavaScriptExecutor)webDriver;
> jsExec.ExecuteScript("document.getElementById('your-input-id-here').value = " + JsonConvert.SerializeObject(yourValueHere));

JsonConvert.SerializeObject() 来自 JSON.NET，这是一种对要在 JavaScript 中使用的字符串值进行编码的便捷方法。但是您可以以任何在 JavaScript 中正确格式化的方式对您的字符串值进行编码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-10T05:38:46.710

嘿，我首先解决了它，从 Adroid Driver 使它成为 Appium 驱动程序

接下来我手动打开了手机中的谷歌键盘，它被设置为 appium 键盘后来我只是隐藏了键盘，它对我有用。

无论如何，谢谢你在那里。

# ruby-on-rails - 生成和发布基于 Ruby 的 REST API 文档

> ID：10289024
> 
> 赞同：20
> 
> 时间：2012-04-23T22:10:11.570
> 
> 标签：ruby-on-rails, ruby, api, rest, code-generation

现在很酷的孩子们使用什么来轻松解析/生成/发布 REST API？我看了一下[Swagger](http://swagger.wordnik.com/)，它看起来不错，但从我的角度来看，它不适合 Ruby。也许我错了，我错过了一些东西，我们将不胜感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-30T21:51:00.283

听起来你还没有 API？如果是这种情况，这是我推荐的方法。

*   使用[swagger-specification](https://github.com/wordnik/swagger-core/wiki)为 API创建一个*接口*。您可以在不使用服务器的情况下执行此操作，[请参见此处](https://github.com/wordnik/swagger-core/tree/master/samples/no-server)。

*   使用[swagger-ui](https://github.com/wordnik/swagger-ui/downloads)验证接口。这允许您查看您定义的所有端点（仍然没有编码，除了 json 文件！）

*   一旦你有了你想要的接口，使用[swagger-codegen](https://github.com/wordnik/swagger-codegen)来构建你的服务器的 stubbed-out 版本。目前有用于[nodejs](https://github.com/wordnik/swagger-codegen/tree/master/samples/server-generator/node)和[scalatra](https://github.com/wordnik/swagger-codegen/tree/master/samples/server-generator/scalatra)的模板，更多模板正在开发中。制作一个新的服务器生成器只需创建/修改一些 mustache 模板。

*   您还可以使用 swagger-codegen 生成您的客户端。

这样做的好处是您可以对 API 进行接口驱动的开发。建立接口并填空。管道为您完成。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-28T02:50:44.003

为此，我们刚刚开始使用[apipie](https://github.com/Pajk/apipie-rails)。到目前为止看起来很整洁。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-24T08:22:49.507

Swagger 可以与 ruby​​ 作为客户端一起使用，从兼容 Swagger 的服务器[https://github.com/wordnik/swagger-codegen自动生成客户端库](https://github.com/wordnik/swagger-codegen)

如果您使用 RoR，我认为您应该查看[https://github.com/elc/rapi_doc](https://github.com/elc/rapi_doc)，但它并不容易使用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-04-12T04:55:28.847

请查看 ApiDoco gem ( [https://github.com/72pulses/apidoco/](https://github.com/72pulses/apidoco/) ) 以获取文档。它非常易于设置并且具有良好的用户体验。

# visual-studio - PhoneGap 中的错误，Visual Project 2010：命令 CScript 以代码 1 退出

> ID：10289025
> 
> 赞同：2
> 
> 时间：2012-04-23T22:10:11.423
> 
> 标签：visual-studio, windows-phone-7, cordova

我正在尝试在 Visual Studio 2010 中使用框架 phonegap 为 windows phone 7 制作应用程序。但是当我尝试编译项目时出现错误。错误是：

> 错误 1
> ​​命令 "C:\Users\Alan\documents\visual studio 2010\Projects\PhoneGapStarter\PhoneGapStarter\BuildManifestProcessor.js" "C:\Users\Alan\documents\visual studio 2010\Projects\PhoneGapStarter\PhoneGapStarter\ PhoneGapStarter.csproj"" 以代码 1 退出。PhoneGapStarter

我正在使用*phonegap library 1.6.1 (cordova)*，但我看不出问题出在哪里。我尝试再次下载该库并将其添加到项目中，但这没有帮助。

我能做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T02:22:21.847

我遇到了这个问题，这是因为没有设置 CScript 的环境变量。

我通过直接引用 cscript.exe 来修复它。您可以通过在文本编辑器中打开 csproj 文件并更改此行来执行此操作

```
<PreBuildEvent>CScript "$(ProjectDir)/ManifestProcessor.js" "$(ProjectPath)"</PreBuildEvent> 
```

至

```
<PreBuildEvent>C:\windows\system32\cscript.exe "$(ProjectDir)/ManifestProcessor.js" "$(ProjectPath)"</PreBuildEvent> 
```

或者您可以添加一个新的环境变量

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T06:52:20.430

尝试查找 CordovaSourceDictionary.xml 并检查它是否是只读的。如果是这样，使其可写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T19:32:03.740

是的，实际上，这就是问题所在，错误是 js 脚本的 windows 环境。

所以，这个问题的解决方案是下一个：

1.  作为管理员，在命令行 (cmd) 中运行下一个脚本。
    -->`regsvr32 %systemroot%\system32\jscript.dll`

2.  脚本运行后，下载以下文件[(vista_js_fix.reg)](http://www.winhelponline.com/downloadattachment.php?aId=2c4993275fa7c5b7a1e243a62867858a&articleId=230%22%20%27=%22vista_js_fix.reg%22)并以管理员身份运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-08T09:30:02.947

有这个问题是因为`.js`文件与另一个应用程序相关联，在我的情况下是 PhpStorm，但在你的情况下可能是任何其他应用程序，例如 Notepad++

通过在命令提示符下运行以下命令（以管理员身份）进行整理：

```
regsvr32 %systemroot%\system32\jscript.dll

assoc .js=JSFile 
```

# c - 添加节点时链表的c实现的分段错误

> ID：10289026
> 
> 赞同：-1
> 
> 时间：2012-04-23T22:10:16.563
> 
> 标签：c, file-io, linked-list, segmentation-fault

我得到了这段代码的段错误：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/types.h>
#include <dirent.h>
#include <unistd.h>

typedef struct _node
{
    char *buffer;           
    struct _node *next;     
    int node_count;        
} node;

typedef struct _list
{
    node *head;
    node *tail;
} list;

list *node_list;

int list_node_lookup(list *l, char *buffer)
{
    node *temp = l->head;
    while(temp)
    {
        if (strcmp(temp->buffer, buffer) == 0)
        {
            /* We got it earlier */
            temp->node_count++;

            return 1;
        }
        else
        {
            temp = temp->next;
        }

    }

    return 0;
}

int adding_to_list(list *l, char *buffer)
{
    int ret;
    char *tmp = (char *)malloc(sizeof(char)*(strlen(buffer) + 1));
    node *new_node = (node *)malloc(sizeof(struct _node));

    /* Empty list */
    if (l->head == NULL)
    {
        strcpy(tmp, buffer);
        new_node->buffer = tmp;
        new_node->node_count = 0;
        l->head = l->tail = new_node;
        l->head->next = NULL;
    }
    else
    {
        /* The list is not empty */
        ret = list_node_lookup(l, buffer);
        if (ret == 1)
        {
            fprintf(stdout, "Got it before\n");
        }
        else
        {
            strcpy(tmp, buffer);
            new_node->buffer = tmp;
            new_node->node_count = 0;
            l->tail->next = new_node;
            l->tail = new_node;
            new_node->next = NULL;
            fprintf(stdout, "Adding this cust : %s\n", buffer);
        }
    }

    return 0;
}

int main(int argc, char **argv)
{
    FILE    *cust;
    char    buf[BUFSIZ];
    DIR* cust_dir;
    struct dirent* input;

    node_list = (list *) malloc(sizeof(struct _list));
    if (node_list == NULL)
    {
            return 1;
    }
    node_list->head = node_list->tail = NULL;

    if (NULL == (cust_dir = opendir("cust_dir"))) 
    {
        return 1;
    }
    while ((input = readdir(cust_dir))) 
    {
            if (!strcmp (input->d_name, "."))
                continue;
            if (!strcmp (input->d_name, ".."))  
                continue;

            cust = fopen(input->d_name, "r");

            while (fgets(buf, BUFSIZ, cust) != NULL)
            {
                adding_to_list(node_list, buf);
            }
                    fclose(cust);
    }

    return 0;
} 
```

当我使用包含这两个文件的目录（它们包含空行）测试我的代码时，我得到了奇怪的输出和段错误。

我在同一个目录中使用了这个文件两次（customers.txt 和 customers_copy.txt）：

```
1
2
3
4    Kristina   Chung   H   Kristina H. Chung   Chung, Kristina H.
5    Paige  Chen    H   Paige H. Chen   Chen, Paige H.
6    Sherri Melton  E   Sherri E. Melton    Melton, Sherri E.
7    Gretchen   Hill    I   Gretchen I. Hill    Hill, Gretchen I.
8    Karen  Puckett U   Karen U. Puckett    Puckett, Karen U.
9    Patrick    Song    O   Patrick O. Song Song, Patrick O.
10    Elsie Hamilton    A   Elsie A. Hamilton   Hamilton, Elsie A.
11   
12    Hazel Bender  E   Hazel E. Bender Bender, Hazel E.
13 
```

前三行是空的（当我使用一个文件时一切正常，但是这多个文件我得到了一个段错误）。

感谢您的帮助，以了解问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:30:58.050

当您将一个节点添加到列表（到列表的尾部）时，您不会`next`将该节点的指针设置为 NULL。这意味着下次您进行查找时，您将`strcmp`使用无效指针进行调用。这本身就可能导致分段错误。

简单的解决方案是在`next`分配节点后立即设置为 NULL。

此外，如果节点已经在列表中，则您分配`tmp`但从不使用它。那会泄漏内存。这类似于 Greg Brown 的评论 - 您还泄漏了文件描述符和文件句柄（您永远不会关闭`cust`）。

**[编辑]**

问题是您正在读取目录“cust_dir”，因此您正在获取目录中的文件名（例如“customers.txt”）。然后打开文件而不在文件名中添加“cust_dir/”。

因此，如果您不小心在当前目录中也有该文件，它可以工作。但除此之外，`cust`为 NULL（因为`input->d_name`是“cust_dir”内的文件名，而不是当前目录中的文件名），然后您尝试从 NULL 文件指针读取数据。这会导致分段错误。

# php - 验证错误后如何使先前输入的值出现在多步表单中

> ID：10289027
> 
> 赞同：-2
> 
> 时间：2012-04-23T22:10:34.720
> 
> 标签：php, drupal, drupal-6, drupal-forms

很明显，如果我把一个表格变成一个多步表格：

```
 if(!isset($form_state['storage']['step']))
    $form_state['storage']['step'] = 1; 
```

并做`form_set_error()`验证

当验证错误出现时，我之前输入的值就会消失......

所以如果我在多步表单中的文本框中输入一个值然后点击继续然后出现验证错误，文本框现在将为空而不是填充我之前输入的值，因为它会正常发生

有没有办法在不手动重新输入每个表单元素的默认值的情况下防止这种情况发生？

仅供参考我正在使用drupal 6

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T04:46:44.843

您可以将 textfield 的默认值设置为在 form_state 数组中提交的值，例如 $form_state['values']['textfield name']['#value']。然后提交的值出现在其中.您还可以从[http://drupal.org/project/examples获得更多帮助](http://drupal.org/project/examples)

# lexer - 构造非确定性有限自动机

> ID：10289030
> 
> 赞同：0
> 
> 时间：2012-04-23T22:10:43.933
> 
> 标签：lexer, finite-automata

我做手写词法分析器。我需要绘制一个非确定性有限自动机，其中包含三个先前制作的有限自动机。我为飞机、云、跑道等关键字制作了它们。我需要帮助，如何为这三个自动机构建通用自动机。我需要一些例子如何做到这一点？如果你知道请帮帮我？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T03:12:32.613

画出飞机、云和跑道自动机，在开始状态之前留出一些空间。现在，删除他们的第一个状态。在他们面前画一个新的、*单一的状态。*将其连接到具有“a”过渡/边缘、“r”边缘到“unway”以及“c”边缘到“loud”的“irplane”自动机。而已。完毕。

对于更一般的情况，它更复杂：首先，画出你的每个自动机（例如飞机、云和跑道），在它们开始的地方留下一些空白空间。接下来，在它们开始之前绘制一个状态，并通过自由边将其连接到飞机、云和跑道自动机的旧开始状态的开始。（自由边也称为 ε 边、ε 边、λ 边或 lambda 边）。

接下来，您对它们执行子集构造算法，您可以在 youtube 上找到视频教程。还有一个[在线子集构造算法工具](http://hackingoff.com/compilers/nfa-to-dfa-conversion)，可为您将非确定性有限自动机转换为确定性有限自动机 (DFA)。该过程称为确定性。

拥有 DFA 后，您可以使用它来构建驱动扫描仪的状态、操作和查找表。那是它自己的蠕虫罐头。人们通常使用 Lex 或 Flex 之类的扫描仪生成器来实现自动化。您可以在线使用的类似的、用户友好的工具是[Online Scanner Generator](http://hackingoff.com/compilers/scanner-generator)。您可以通过提供以下输入来使用它来制作图表：

```
airplane:airplane
cloud:cloud
runway:runway 
```

它会给你一个 DFA，就像这样：![http://i.stack.imgur.com/ngFWU.png](../Images/ca155e1bd06a199b0079dff76571af20.png)

# sql - sql/coldfusion 删除重复行

> ID：10289032
> 
> 赞同：0
> 
> 时间：2012-04-23T22:10:59.113
> 
> 标签：sql, coldfusion

这是我的桌子

```
显示          UPC
0 0553406259120
0 0753406259120
1 0753406259120
1 0453406259120

```

如果您注意到，第 2 行和第 3 行具有相同的 UPC。我想删除所有显示 = 0 并重复 upc 的行。所以在我的表中，我只想删除第 2 行。到目前为止，这是我的coldfusion代码不起作用。请指教。

```
<cfquery name="GetData" datasource="#Application.ds#" dbtype="ODBC" username="#Application.UserName#" password="#Application.Password#">
DELETE UPC
FROM products
WHERE DISPLAY = 0
GROUP BY UPC  
HAVING COUNT(*)>1
</cfquery> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:22:23.537

假设您要删除所有`UPC`相同但`Display`不同的行：

```
DELETE FROM Products as a
WHERE display = 0
AND EXISTS (SELECT '1'
            FROM Products as b
            WHERE b.display <> 0
            AND b.upc = a.upc) 
```

这应该适用于所有 RDBMS，并将删除所有`UPC`相同但`Display`代码不同的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:36:15.317

```
DELETE FROM Products
WHERE DISPLAY = 0 
AND UPC in (SELECT UPC
            FROM Products
            GROUP BY UPC
            HAVING COUNT(UPC)>1) 
```

# css - Chrome 浏览器 - 绝对定位和浮动问题

> ID：10289035
> 
> 赞同：2
> 
> 时间：2012-04-23T22:11:12.463
> 
> 标签：css, google-chrome, css-float

这是一个困扰我一整天的问题。我不完全确定如何描述它，除了我在`div`浮动容器上浮动时遇到问题，而且这似乎只是 Chrome 中的一个问题。

看看这个：http: [//jsfiddle.net/H8vVf/](http://jsfiddle.net/H8vVf/)。文本旁边应该有一条条纹，但在 Chrome 中，它看起来像一个删除线。

HTML：

```
<div class="wrapper">
    <div class="content">SOME GOOD TEXT</div>
    <div class="stripe"></div>
</div> 
```

CSS：

```
.wrapper::after {
     content: " ";
     display: block;
}
.content {
     float: left;
}
.stripe {
     background-color: black;
     width: 100%;
     display: inline;
     position: absolute;
     height: 1em;
}​ 
```

我已经找到了解决方法，但我只是想知道是否有人可以向我解释这里出了什么问题以及为什么。如果没有，我会继续我的快乐之路......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:32:17.083

**引用操作：**

> *我在`div`浮动容器上浮动时遇到问题...*

通常，当你[`float:`](http://www.w3.org/TR/CSS2/visuren.html#floats)做某事时，页面上的其他内容应该*围绕*它流动。

**引用操作：**

> *文本旁边应该有一条条纹，但在 Chrome 中，它看起来像一个删除线。*

我不确定您所说的“删除线”是什么意思，但是您已经将具有类的元素定义`.stripe`为 100% 宽，这意味着它将是其父元素的 100% 宽度。在这种情况下，其父级`.stripe`是具有 class 的元素`.wrapper`。由于`.wrapper`该类没有定义宽度，默认情况下，它将是其父窗口的 100% 宽度。因此，正如您定义的那样，条纹将 100% 与窗口一样宽。

**引用操作：**

> *我只是想知道是否有人可以向我解释这里出了什么问题以及为什么。*

关于你的代码...

```
.stripe {
     background-color: black;
     width: 100%;
     display: inline;
     position: absolute;
     height: 1em;
}​ 
```

[`display: inline`](http://www.w3.org/TR/CSS2/visuren.html#inline-formatting)是内容流中元素的属性。

但是，[`position: absolute`](http://www.w3.org/TR/CSS2/visuren.html#absolute-positioning)将元素从内容流中取出。

这种方式毫无意义。换句话说，它不能同时*在流中*和*流外*。

[这是 W3C 规范，它解释了 CSS2 视觉格式模型](http://www.w3.org/TR/CSS2/visuren.html)以及[正常流、浮动和绝对定位的详细比较](http://www.w3.org/TR/CSS2/visuren.html#comparison)。

# ruby-on-rails - 你如何存根特定模拟实例的所有方法

> ID：10289036
> 
> 赞同：5
> 
> 时间：2012-04-23T22:11:14.417
> 
> 标签：ruby-on-rails, rspec, mocking, stubbing

我有一个由第三方处理的特定模拟。我只想检查是否已返回相同的模拟。

但是，第三方调用了我的测试并不真正关心的数组方法和保存方法。有没有办法告诉我的模拟它期望/存根所有方法都与那个特定的模拟实例有关？

例如。

```
user = mock(User)
user.stub_all 
```

谢谢！

**编辑**

有关该问题的更多信息：

测试：

```
 it "creating an invitation should return invitation" do
    invitation = mock_model(Invitation)
    invitation.stub(:[]=)
    invitation.stub(:save)
    Invitation.stub(:create).and_return(invitation)
    @user.create_invitation
    @user.create_invitation.should == invitation        
  end 
```

正在测试的代码：

```
 def create_invitation
    invitation = Invitation.create
    self.invitations.push(invitation)
    return invitation
  end 
```

我需要模拟以下与我正在测试的内容没有直接关系的内容：

```
invitation.stub(:[]=)
invitation.stub(:save) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T22:19:11.957

答案是

```
user = mock(User).as_null_object 
```

但总的来说，这种方法意味着您的对象太大并且您的测试不够精细

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-29T22:02:48.777

我偶然遇到了这个 - 但是（现在）这样做的“有福”的方式是使用该`spy`方法，这基本上与上面的相同：

参考：[https ://thoughtbot.com/blog/a-closer-look-at-test-sies](https://thoughtbot.com/blog/a-closer-look-at-test-spies)

您不必删除该类已经实现的任何方法。

# cocoa - 我可以通过在将 CAAnimation 实例添加到图层后对其进行修改来重用它吗？

> ID：10289038
> 
> 赞同：4
> 
> 时间：2012-04-23T22:11:35.817
> 
> 标签：cocoa, core-animation

这很有趣......我认为这样做

```
CABasicAnimation* a = [CABasicAnimation animationWithKeyPath:@"opacity"];
    a.fromValue = [NSNumber numberWithFloat:0.];
    a.toValue = [NSNumber numberWithFloat:1.];
    a.duration = .4;
    a.fillMode = kCAFillModeBoth;
    a.removedOnCompletion = NO;

CGFloat timeOffset = 0;
for(CALayer* layer in layers)
{
    a.beginTime = [someCommonSuperView.layer convertTime:CACurrentMediaTime()fromLayer:nil] + timeOffset;
    [layer addAnimation:a forKey:nil];
    timeOffset += .4;
} 
```

我实际上总是在修改相同的 CABasicAnimation 的 beginTime 并且只是增加它的引用计数。这样我就不会让一系列图层一个接一个地淡入淡出，而是应该弄乱所有图层的开始时间，可能导致所有图层在最后一个图层的时候同时出现。但是上面的代码实际上似乎可以工作，因为图层是按顺序淡入的。

那么以这种方式重用动画有意义吗？以免在每次传递时都创建它的新实例？

addAnimation 实际上是在制作动画的深层副本而不是增加引用计数吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T01:10:54.297

According to [the docs](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CALayer_class/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004500-CH1-SW14):

> `- (void)addAnimation:(CAAnimation *)anim forKey:(NSString *)key`
> 
> Add an animation object to the receiver’s render tree for the specified key.
> 
> Parameter `anim`:
> 
> The animation to be added to the render tree. Note that the object is copied by the render tree, not referenced. Any subsequent modifications to the object will not be propagated into the render tree.

So I'd say it's safe to reuse the same `CAAnimation` object.

# java - 打开 GUI 时如何播放音乐

> ID：10289039
> 
> 赞同：0
> 
> 时间：2012-04-23T22:11:42.827
> 
> 标签：java, swing, audio, javasound

所以我想得到一个我正在制作的游戏，当我打开它时开始播放音乐。我以前从来没有做过这样的事情，所以我想知道一些建议。考虑到我是菜鸟，我在网上找不到任何可以理解的东西，所以如果你能做到这一点并很好地解释它，那就太棒了。谢谢！哦，我可以在程序上发布您需要的任何信息。

主类看起来像：

```
package com.game.main.window;

import javax.swing.ImageIcon;
import javax.swing.JFrame;
import java.awt.event.ActionListener;

public abstract class Main extends JFrame implements ActionListener {

public static JFrame frame = new JFrame();

public static void main(String[] args) {
    createWindow();
}

public static void createWindow() {
    ImagePanel panel = new ImagePanel(
            new ImageIcon(
                    "C:\\Users\\Austin\\Pictures\\My Pictures\\Le Parkour\\ABC0001.jpg")
                    .getImage());

    frame.getContentPane().add(panel);
    frame.setJMenuBar(MenuBar.menuBarCreator());
    frame.pack();
    frame.setTitle("*Game Title* Beta 0.0.1 ADMINISTRATOR VERSION");
    frame.setSize(ImagePanel.img.getWidth(null),
            ImagePanel.img.getHeight(null));
    frame.setLocation(100, 100);
    frame.setVisible(true);
    frame.setResizable(false);
    frame.setDefaultCloseOperation(EXIT_ON_CLOSE);
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:18:04.023

尝试研究[java 并发性](http://docs.oracle.com/javase/tutorial/essential/concurrency/)，特别[是 Swing](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)中的并发性。您可以在后台线程中运行音乐，但不要忘记在退出应用程序时停止它！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T22:46:35.277

请参阅 JavaSound 信息中的[播放`Clip`](https://stackoverflow.com/tags/javasound/info)代码。页。

获取嵌入在游戏 Jar 中的声音的 URL，使用类似：

```
URL urlToExplosion = this.getClass().getResource("/path/to/boom.wav "); 
```

## 编辑 1

```
frame.setSize(ImagePanel.img.getWidth(null),
        ImagePanel.img.getHeight(null)); 
```

糟糕，糟糕，糟糕。不考虑框架装饰。 `ImagePanel`应该设置一个`preferredSize()`等于图像的大小。由于它可能是`ImageObserver`,`this`可以用来代替`null`获取图像的宽度 x 高度。之后，只需将图像面板添加到框架并调用。

```
// set the frame to the smallest size needed to display the content
frame.pack(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T22:56:48.793

您应该查看[Java Media Framework](http://www.oracle.com/technetwork/java/javase/tech/index-jsp-140239.html)以播放音乐和此类媒体，但不太确定 MP3 的功能虽然我没有尝试过，但我相信周围有更多的开源替代方案，但这应该可以解决问题。

[您可以在此处](http://www.oracle.com/technetwork/java/javase/documentation/index-135173.html)下载它并[在此处](http://www.oracle.com/technetwork/java/javase/download-142937.html)查看文档。这是它当前支持[的格式列表，](http://www.oracle.com/technetwork/java/javase/formats-138492.html)以防链接最终浪费您的时间

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T22:58:49.153

最简单的解决方案可能如下所示：

```
public void playSound(final String file) {
    new Thread(new Runnable() {

        @Override
        public void run() {
            Applet.newAudioClip(getClass().getResource(file)).play();
        }
    }).start();
} 
```

在你的类旁边放置一个 wav 文件，或者在另一个包中并更改 getResource 方法，然后调用：

```
playSound("filename.wav"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T00:04:34.590

看看[这个](http://www.dreamincode.net/forums/topic/14083-incredibly-easy-way-to-play-sounds/)。
只要确保在单独的线程上运行它并在退出时停止歌曲，如上所述。
另外，只是一个提示：

```
ImagePanel panel = new ImagePanel(
        new ImageIcon(
                "C:\\Users\\Austin\\Pictures\\My Pictures\\Le Parkour\\ABC0001.jpg")
                .getImage()); 
```

你不应该这样做。如果您正在分发应用程序，将找不到路径并且不会显示图像图标。您应该创建一个包含资源的文件夹，然后像这样使用该路径：

```
ImagePanel panel = new ImagePanel(
    new ImageIcon("./resources/ABC0001.jpg").getImage()); 
```

这样应用程序就会知道在哪里寻找图像。

# cordova - 我需要帮助才能在 Phonegap (Android) 上拍照并将其发送到 php (SERVER)

> ID：10289040
> 
> 赞同：0
> 
> 时间：2012-04-23T22:11:48.877
> 
> 标签：cordova

我的问题是我需要拍照并将其发送到 php（服务器），但我尝试使用不同的代码，但我没有预期的响应

```
function startCamera() {

            navigator.camera.getPicture(onSuccess, onFail, { 
                quality: 50,    
                destinationType: navigator.camera.DestinationType.DATA_URL 
            }); 
            function onSuccess(imageData){    

                alert(imageData);
                var url = "http://www.trueware.mx/eduardo/mybiometrics_online/foto.php?callback=parseRequest&foto="+imageData;
                var script = document.createElement('script');
                script.setAttribute('src', url);
                document.getElementsByTagName('head')[0].appendChild(script);
            }
            function onFail(message) 
            {    
                alert('Failed because: ' + message);
            }
        }
        function parseRequest(response)
        {
            try
            {
                console.log(response);
                for (var i=0; i < response.length; i++) {
                        var dato = response[i].foto;
                        alert(dato);
                        var foto=Base64.decode(response[i].foto);
                         var imagen = document.createElement('img');
                         imagen.setAttribute('src',foto);
                         document.getElementById('cabezera').appendChild(imagen);
                }
            }
            catch(an_exception)
            {
                document.write("Error de Conexion");
            }
        } 
```

所以我需要帮助和一个例子。

javascript部分和php部分

如果有人可以帮助我，我将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T17:56:34.737

Zac Vineyard 有一篇很好的博客文章，完全符合您的要求：

[http://zacvineyard.com/blog/2011/03/25/upload-a-file-to-a-remote-server-with-phonegap/](http://zacvineyard.com/blog/2011/03/25/upload-a-file-to-a-remote-server-with-phonegap/)

# java - Hibernate (n+1) select with non-PK join

> ID：10289047
> 
> 赞同：0
> 
> 时间：2012-04-23T22:12:55.307
> 
> 标签：java, hibernate

(n+1) 选择我无法解决的问题。我正在加入具有非 PK 列的表。

我的架构

> 记录
> Record_Id (PK)
> Carrier_Number
> 
> Audit_Details
> AuditId(PK)
> Carrier_Number

Records 和 Audit_Details 之间存在一对多的关系。

我的记录.hbm.xml

```
<set lazy="true" name="auditDetails" sort="unsorted"
        table="AUDIT_DETAILS" inverse="true">
        <key column="Carrier_Number" not-null="true" property-ref="carrierRefNumber"/>
        <one-to-many 
            class="com.package.AuditDtls" />
    </set> 
```

我的 auditDetails.hbm.xml

```
<many-to-one
        class="com.package.Records" fetch="join"
        name="Records" column="Carrier_Number" not-null="true" property-ref="carrierNumber" lazy="false"/> 
```

这会产生一个类似的查询

```
select
    this_.CARRIER_NUMBER as CARRIER1_2_2_,
    abc1_.CARRIER_NUMBER as CARRIER8_3_0_,
    otm4_.CARRIER_NUMBER as CARRIER1_2_1_,
from
    RECORDS this_ 
inner join
    AUDIT_DETAILS abc1_ 
        on this_.CARRIER_NUMBER=abc_.CARRIER_NUMBER 
left outer join
    RECORDS otm4_ 
        on abc1_.CARRIER_NUMBER=otmp4_.CARRIER_NUMBER 
where
    this_.LOAD_ID=? 

select
    auditde0_.CARRIER_NUMBER as CARRIER8_1_        
from
    AUDIT_DTLS auditde0_ 
where
    auditde0_.CARRIER_NUMBER=? 
```

我尝试更改为 fetch="select" ，更改lazy="false" 和lazy="no-proxy" 但到目前为止没有任何效果。我不确定这个问题是否是因为加入了两个带有 nonPK 列的表。将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:25:24.577

问题在于我的标准而不是映射。通过设置以下我的标准解决了这个问题。

```
createAlias("auditDetails", "ad", CriteriaSpecification.LEFT_JOIN); 
```

此外，将 Hibernate 更新到 3.3 并移至注释和下面的设置解决了额外的选择问题。

```
@ManyToOne(fetch=FetchType.LAZY)
@JoinColumn(name = "CARRIER_NUMBER")
public Records getRecord() {
    return record;
} 
```

# mysql - 如果 id 匹配，则排除行

> ID：10289049
> 
> 赞同：0
> 
> 时间：2012-04-23T22:13:15.277
> 
> 标签：mysql

如何排除具有相同 ID 的行。我有一个成员活动表，其中成员 ID 在表中重复了很多次。我想获取所有成员 ID，但在这种情况下，如果我选择成员 ID，我将获取所有 ID，并且我只想要一个 ID 一次而不重复。

```
ID | OwnerID | Date               | GroupID
1    1        2012-04-23 19:25:04  1
2    1        2012-04-23 19:26:55  1
3    2        2012-04-23 19:26:56  1
4    1        2012-04-23 19:26:58  1
5    2        2012-04-23 19:27:14  1 
```

在这里，如果我选择 OwnerID，我将获得 1 三次，我希望它只返回 1 次。就像我只想拥有一个在此表中的用户列表，并且不希望他/她在此表中出现多少次。我希望这是有道理的。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:16:11.337

`SELECT DISTINCT(yourMemberIDField) FROM someWonkyTable`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:16:15.333

`SELECT DISTINCT (OwnerID) FROM Table`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T22:22:39.787

你可以这样做：

```
select OwnerID
from table_name
group by OwnerID 
```

这将按 OwnerID 对所有行进行分组，确保每行只返回一个。

# facebook - 将评论从网站评论框中拉到我的 Facebook 业务页面时间线

> ID：10289050
> 
> 赞同：1
> 
> 时间：2012-04-23T22:13:16.407
> 
> 标签：facebook, comments

我已将 facebook 评论框添加到我网站上的 php 页面。我正在尝试将帖子和评论从我的网站评论框（或[http://developers.facebook.com/tools/comments?id=](http://developers.facebook.com/tools/comments?id=)）导入我的 facebook 业务时间线。

我怎样才能做到这一点？请问有什么解决办法吗？

我尝试向 Canvas URL 添加几个不同的 url：在应用程序中查看我可以获取显示在命名空间 iframe 中的评论并从那里获取它，但没有成功。

# ios - 它是如何工作的：Park Guides NatGeo iOS 应用程序中的转换？

> ID：10289056
> 
> 赞同：1
> 
> 时间：2012-04-23T22:13:40.407
> 
> 标签：ios, animation, opengl-es

[链接到 iTune 商店](http://itunes.apple.com/us/app/national-parks-by-national/id518426085?mt=8)

当您点击右上角的“查找”按钮时，我很想知道他们是如何在视图之间进行转换的。我猜这涉及到一些OpenGL ES？我对这类动画特别感兴趣，如果有人能推荐一些资源来学习如何做这类事情，我将不胜感激。

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T04:24:29.770

[https://github.com/kentnguyen/KNSemiModalViewController](https://github.com/kentnguyen/KNSemiModalViewController)

这是使用 CAAnimation 和 CATransform3D 很好地实现此效果

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T23:20:55.053

您可能需要查看两个地方。

首先是[Core Animation Function Reference](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreAnimation_functions/Reference/reference.html)

这将允许您对视图应用旋转、缩放、平移等变换，所有这些都是 3D 的。看起来《国家地理》使用了它们的组合，让你感觉视野正在倒退。

第二个是[CAKeyframeAnimation](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CAKeyframeAnimation_class/Introduction/Introduction.html)

它将允许您将多个动画组合到一个时间轴中。通常，动画是从 A 点到 B 点，但使用 CAKeyframeAnimations，您可以在动画期间有多个点在不同点处被击中。

请记住，这些机器人的掌握相当复杂，因此如果您立即被卡住，请不要担心。你最终会弄清楚的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-17T10:18:31.927

试试这个。在 iOS 中受 NatGeo（国家地理的城市指南）启发的视图控制器转换。

[https://github.com/michaelhenry/MHNatGeoViewControllerTransition](https://github.com/michaelhenry/MHNatGeoViewControllerTransition)

谢谢， 凯尔

# asp.net - 带有 Microsoft.SharePoint.IdentityModel.Pages.FormsSignInPage 的“NullreferenceException：对象未设置为对象的实例”

> ID：10289062
> 
> 赞同：2
> 
> 时间：2012-04-23T22:14:08.917
> 
> 标签：asp.net, sharepoint

我正在尝试使用基于表单的身份验证为 Sharepoint 2010 制作登录页面。我遵循了一个教程，最后我的项目显示了上述错误（对象未设置为对象的实例）。

[NullReferenceException：对象引用未设置为对象的实例。] Microsoft.SharePoint.IdentityModel.Pages.FormsSignInPage.OnLoad(EventArgs e) +119 NDELogin.Layouts.NDELogin.Login.OnLoad(EventArgs e) +51 System.Web .UI.Control.LoadRecursive() +65 System.Web.UI.Page.ProcessRequestMain(布尔includeStagesBeforeAsyncPoint，布尔includeStagesAfterAsyncPoint) +2427

有人会看一下代码/ Aspx 并告诉我您是否发现任何问题。

```
using System;
using Microsoft.SharePoint;
using Microsoft.SharePoint.WebControls;
using Microsoft.SharePoint.IdentityModel.Pages;

namespace NDELogin.Layouts.NDELoginc
{
public partial class Login : FormsSignInPage
  {
    protected override void OnLoad(EventArgs e)
    {
        base.OnLoad(e);
    }
  }
}

    <%@ Assembly Name="$SharePoint.Project.AssemblyFullName$" %>
    <%@ Assembly Name="Microsoft.SharePoint, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
    <%@ Assembly Name="Microsoft.SharePoint.IdentityModel, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>

    <%@ Import Namespace="Microsoft.SharePoint" %>
    <%@ Import Namespace="Microsoft.SharePoint.WebControls" %>

    <%@ Register Tagprefix="SharePoint" 
        Namespace="Microsoft.SharePoint.WebControls" 
        Assembly="Microsoft.SharePoint, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
    <%@ Register Tagprefix="asp" Namespace="System.Web.UI" 
        Assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" %>

    <%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Login.aspx.cs" 
        Inherits=" NDELogin.Layouts.NDELogin.Login, NDELogin, Version=1.0.0.0, Culture=neutral, PublicKeyToken=5da7e3f4f8be720c" MasterPageFile="~/_layouts/NDELogin/PublicMaster.master" %>

    <asp:Content ID="Content4" ContentPlaceHolderID="ContentLogin"
        runat="server">
         <SharePoint:EncodedLiteral runat="server"
            EncodeMethod="HtmlEncode" ID="ClaimsFormsPageTitle"
            Visible="false" />
             <SharePoint:EncodedLiteral runat="server"
            EncodeMethod="HtmlEncode" ID="ClaimsFormsPageTitleInTitleArea"
            Visible="false" />

        <SharePoint:EncodedLiteral runat="server"
            EncodeMethod="HtmlEncode" ID="ClaimsFormsPageMessage"
            Visible="false" />
        <asp:Login ID="signInControl" FailureText="<%$Resources:wss,login_pageFailureText%>"
            runat="server" Width="100%" DisplayRememberMe="false" />
    </asp:Content> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T17:46:14.583

我刚刚回答了我自己的问题...在登录控件上设置 MembershipProvider="FBAMembershipProvider"

# sql-server-2008 - 非规范化实体以绑定到网格？

> ID：10289063
> 
> 赞同：1
> 
> 时间：2012-04-23T22:14:09.370
> 
> 标签：sql-server-2008, entity-framework, devexpress, poco

我在 SQL Server 中有两个表，比如 A 和 B。B 是文档列表，A 包含指示项目是否应该在 B 中包含一行的数据。

```
A
___________
AId int PK,
BId int,
Include bit

B
___________
BId int PK,
BDocNumber varchar(10),
BName varchar(128) 
```

我有 A 和 B 的 POCO，但最终我想要的是我可以绑定到包含来自两者的数据的 devExpress 网格（BDocNumber，BName，Include）

1.  我可以将 B 设置为导航属性，但我不知道如何将其展平为网格（DevExpress ASPxGridView，服务器模式）

2.  我也研究过实体拆分，但似乎这行不通，因为我想加入 BId 而不是 AId。

1 或 2 的解决方案是可以接受的，但了解两者都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:36:24.367

您拥有的是要在 DevExpress Grid 中访问的“has-a”关系或 A 到 B 中的一对一导航属性。您可以通过将 FieldName 属性设置为 NavigationProperty.FieldName 来执行此操作

假设 Persont 与 Address 的一对一关系，如下所示：

```
 public class Person
    {

      public int ID { get; set; }
      public string FirstName { get; set; }
      public string LastName { get; set; }
      public virtual Address Address { get; set; }
    }

    public class Address
    {
      public int ID { get; set; }
      public string StreetAddress { get; set; }
      public string City { get; set; }
      public string State { get; set; }
      public string Zip { get; set; }

     } 
```

您的 GridView 在您的 aspx 页面中包含 Address 导航属性的 Person 和 StreeAddress 属性，如下所示

```
 <dx:ASPxGridView ID="ASPxGridView1" runat="server">
        <Columns>
            <dx:GridViewDataTextColumn FieldName="FirstName" VisibleIndex="0">
            </dx:GridViewDataTextColumn>
            <dx:GridViewDataTextColumn FieldName="LastName" VisibleIndex="1">
            </dx:GridViewDataTextColumn>
            <dx:GridViewDataTextColumn FieldName="Address.StreetAddress" VisibleIndex="1">
            </dx:GridViewDataTextColumn>
        </Columns>
    </dx:ASPxGridView> 
```

在这种情况下，Person 是表 A，Address 是表 B。您将 gridview 绑定在 A 上，因此您将字段名称设置为 B.FieldToDisplay。

希望这可以帮助！

# math - 当源信号只是一个实数时对复数进行操作

> ID：10289065
> 
> 赞同：0
> 
> 时间：2012-04-23T22:14:14.427
> 
> 标签：math, fft, complex-numbers

我有一个实数序列，我想计算它的 FFT。FFT 函数需要复数。

那么我可以将虚数值设置为 0 并计算 FFT 吗？

下一个问题是当我得到结果值（频域值）时，它们是复杂格式的。

如果我对这些复数值进行 FFT 的逆运算，我可以丢弃虚部并只使用结果的实部吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:15:42.007

您将复数输入的实部设置为信号样本值，将虚部设置为零。或者，您可以使用实数到复数 FFT，它也可能比普通的复数 FFT 快一点。

至于逆 FFT - 只要您的频域复数值具有复共轭对称性（如果您的输入是纯实数，它们将具有），那么 IFFT 将再次为您提供纯实时域信号。如果您在 IFFT 之前修改频域值，请确保保持复共轭对称性。同样，您也可以考虑使用复数到实数的 IFFT，这可能更有效，并且可以减轻您保持对称性的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:40:05.137

对于这种类型的数学，实数只是一个（假设的或明确的）虚部等于零的复数。

如果您提供给 IFFT 计算的频率数据是共轭对称的，那么与实际值相比，结果中的虚数值会很小，主要是使用有限精度算术产生的数值噪声。如果您了解精度的有效数字，您会注意到对于任何合理或有用的精度，这些值都四舍五入为零。

# iphone - 在 UIViewController 之外设置委托？

> ID：10289066
> 
> 赞同：0
> 
> 时间：2012-04-23T22:14:23.427
> 
> 标签：iphone, objective-c, uiviewcontroller, delegates, iad

我正在尝试尽可能地将 iAd 初始化代码与主 UIViewController 隔离开来，以便将来轻松集成我的应用程序。我创建了 AdManager (NSObject) 类来处理 iAd 设置和初始化。但是，我不知道如何为实现这些委托类的 UIViewController 之外的对象设置委托。例如：

```
@interface AppViewController : UIViewController<ADBannerViewDelegate> 
```

我的 AdManager 会有这样的东西：

```
+(void)initAdBannersInView:(UIView*)view andViewController:(UIViewController*)vc{
  ADBannerView *iAdBannerView = [[ADBannerView alloc] initWithFrame:CGRectMake(0, -bannerSize.height, bannerSize.width, bannerSize.height)];
  iAdBannerView.delegate = vc;  
  [view addSubview:iAdBannerView]; 
```

错误（警告）消息是：从不兼容的类型“UIViewController”分配给“id”

我可能对代表的这种特殊情况不太好，所以请原谅我可能的误解，但是否有可能以类似的方式实现我所需要的？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:20:46.780

您将`vc`参数定义为`UIViewController *`. 这意味着您可以在其中传递任何旧视图控制器，不一定是符合`ADBannerViewDelegate`协议的视图控制器。您应该定义`vc`参数，以便您只能将符合该协议的视图控制器传递到：

```
+(void)initAdBannersInView:(UIView*)view andViewController:(UIViewController<ADBannerViewDelegate>*)vc{ 
```

# list - 列表中的 Haskell 列表

> ID：10289068
> 
> 赞同：2
> 
> 时间：2012-04-23T22:14:28.177
> 
> 标签：list, haskell

我有一个家庭作业问题，我必须定义一个函数，该函数以列表形式输入，其中包含较小的整数列表，并将每个最里面的列表中的数字相加，然后将结果和相乘。

我的代码如下，显然不起作用，任何帮助将不胜感激:)

```
sumI :: [Int] -> Int
sumI [] = 0
sumI (x:xs) = x + sumI xs

mapQ :: [[Int]] -> Int
mapQ [] = []
mapQ xs = [product (sumI x) | x <- xs] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T22:21:46.253

因为这是一个家庭作业问题 - 这里有一些提示。

1.  您可以使用 map 将函数应用于列表的每个成员。由于列表是由列表组成的，一个合适的函数可能是`sum`

2.  你想把一个列表变成一个数字。我的意思是，你有一个你需要的总和列表，你想把它们相乘得到一个数字。这是很常见的，并且由许多`fold`功能之一处理。

试试这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:19:15.580

我想你快到了。将最后一行替换为

```
mapQ xs = product [ sumI x | x <- xs] 
```

# sql - 更新到 SQL 时出现问号

> ID：10289069
> 
> 赞同：2
> 
> 时间：2012-04-23T22:14:29.957
> 
> 标签：sql, sql-server, sql-server-2008, encoding

什么时候从在线托管应用程序更新我的数据库..我进入更新行的整个单元格..问号'???' ..这与语言有冲突吗..因为我写成阿拉伯语并更新成阿拉伯语。但如果我写成英文更新成功..并通知。用阿拉伯语或英语插入是成功的 .. 但仅限于更新英语成功和阿拉伯语字母转换为 '?????' 问号和 iam 使用 Microsoft Visual Studio 2010 的 .. SQL Server 2008

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T22:30:25.517

要在 oracle 或 MSSQL 数据库中保留字符编码，请在文本值前使用“N”：

```
UPDATE yourTable SET yourcolumn = N'newtext'; 
```

:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T04:54:43.520

我认为您可以为表中的字段使用`char`或`varchar`数据类型。

在 MSSQL 中，字符数据类型 `char`和`nchar`. （还有两种不同的类型：`varchar`和`nvarchar`）

如果您有支持多种语言的网站，请考虑使用 Unicode 'nchar' 或 'nvarchar' 数据类型以尽量减少字符转换问题。

# c++ - 可以在同一个线程中并行调用一个槽吗？

> ID：10289070
> 
> 赞同：-1
> 
> 时间：2012-04-23T22:14:35.453
> 
> 标签：c++, qt, qnetworkaccessmanager

在弄清楚如何执行此操作时遇到一些问题。将尝试解释我首先要做什么。

首先，我有一个包含只读文件的类。这个类将使用另一个类（StorageProvider）来上传这个文件的块。该类包含一个 QNetworkAccessManager。上传文件块时，我会将块发送到 StorageProvider 类，然后使用它发送到 QNAM 的 REST 请求。当 QNetworkReply 完成时，StorageProvider 将向上传者发出信号（以便它知道该块已完成）。

Uploader -> StorageProvider -> QNetworkAccessManager -> Internet

到目前为止还不错吧？我可以在上传程序中放置一个插槽，以便在 StorageHandler 完成它在 QNAM 上发出的请求时进行监听。

但是，由于 QNAM 可以通过 HTTP 同时执行 6 个请求，因此我正在考虑这样做，以便当 StorageProvider 发出信号表示它已完成一个块时，并且唯一的 BlockId 连接到该信号，允许上传者知道哪个块完成了，而不仅仅是它完成了。

这意味着每当 StorageProvider 发出信号（blockId）时将调用的插槽必须存储已完成的 id，然后查找未上传的新 id（忘了提我有一个已经上传的 ID 列表，所以当它通过 ids (0...1000) 时，它还需要 1\. 将文件的索引向前推 4mb 2\. 如果是，请检查已经存在的块的列表在。

所以，我的问题是：如果我有一个插槽将“currentBlockId”增加一，直到它找到下一个可以上传的插槽+读取文件 4mb，直到我们位于位置“currentBlockId”* 4mb（索引文件中的文件将像索引一样被向前推，它不会是随机访问。当这个索引到达文件末尾时，我们就完成了）并且每当完成 5 个上传中的一个时都会调用这个插槽，我会有问题吗? 我问的原因是因为 QNAM 使它在不同的线程中调用，这可能会同时发出 2-5 个“finished()”信号，这将调用同时处理该信号的插槽? 就像，我不太确定那时会发生什么。请注意，我的代码都没有线程化，理论上信号应该排队吗？并且插槽会被调用5次，一个接一个？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:33:10.743

哇，我的眼睛。通读一遍，仍然不知道你想要什么……所以这是独家新闻。

默认情况下，在事件线程上调用插槽。默认情况下，只有一个事件线程。在这方面，你是对的。默认情况下，当一个槽正在使用事件线程时，调用会排队等待稍后。

但是，这并不意味着可以安全地假设您的所有 5 个调用都一定会按照您期望的顺序到达，或者甚至来自同一个线程。如果您想获得花哨的东西并并行处理东西（不能说，帖子太混乱了），那么使用[QtConcurrent::run()](http://doc.qt.nokia.com/4.7-snapshot/threads-qtconcurrent.html)作为如何启动新线程进行处理的一个示例。在这种方案下，所有插槽都会将您的数据推送到队列中（记得用互斥锁保护它）并触发 QtConrrent::run() 函数。

# javascript - JAX-RS ajax 问题

> ID：10289071
> 
> 赞同：0
> 
> 时间：2012-04-23T22:14:37.137
> 
> 标签：javascript, jquery, json, html, jax-rs

我正在尝试使用 jquery 使用 ajax 调用 JAX-RS webservice 我遇到了一个重要问题，即该方法的调用已经发生，但我无法获取数据

```
 $.getJSON("http://192.168.1.2:9080/TestJMSWeb/jaxrs/categories/",function(data){
alert("success"+data);
}); 
```

这段代码应该在电话上使用 phonegap

执行 webservice 正在返回 json 数组数据 我想知道为什么在调用发生时我无法获取该数据，并且我在控制台中看到了执行该方法的消息。你能告诉我我该怎么做才能解决我的问题吗？我很着急，提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:20:38.233

“通话进行时我无法获取该数据” - 我不确定是什么问题。也许您的问题与 AJAX 调用是异步的事实有关，因此您需要等待 AJAX 请求从服务器返回数据。在请求期间，您将看不到任何数据。

# ravendb - 在 RavenDb .NET 客户端 API 中为 Store 和 Load 指定集合名称

> ID：10289072
> 
> 赞同：0
> 
> 时间：2012-04-23T22:14:40.040
> 
> 标签：ravendb

在 .NET 客户端 API 中调用 RavenDb 的存储/加载命令时，如何指定要使用的集合的名称？它不能是约定俗成的。

# sql-server - 以某种原子方式写入数据库和 rfid 卡的优雅解决方案

> ID：10289073
> 
> 赞同：1
> 
> 时间：2012-04-23T22:14:53.083
> 
> 标签：sql-server, database, atomic, smartcard, rfid

假设您想将一些数据写入 RFID 卡并将一些数据写入数据库。从理论上讲，与数据库的连接可能随时中断，卡与读卡器之间的连接也可能随时中断。你的目标是以一种原子的方式设计它，你要么最终要么都写，要么都不写。

有什么优雅的方法可以解决这个问题吗？任何提示表示赞赏:)

（我正在使用 MS SQL Server 和 Windows 智能卡模块 (Winscard.dll)，以防有什么不同）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:17:25.130

在开始更新 RFID 卡之前插入一条记录，然后在完成后更新此记录。通过这种方式，您还可以发现半完成的更新，并采取相应的行动。

1.  向数据库中插入一条状态为“未完成”的记录。给它一个时间戳、一个唯一的 ID 以及您需要的任何其他相关信息，以唯一地描述 RFID 写入尝试
2.  写入 RFID 卡
3.  将步骤 1 中插入的记录更新为“已完成”或“失败”状态

然后有一个进程在超时时间过去后解决不完整的记录（通过重试，或者你想做的任何其他事情）。

与 RFID 卡通信时，请勿尝试保持打开数据库事务，因为这会：

1.  在数据库上给你不需要的（并且可能很长的）锁
2.  失败时回滚，这将删除您尝试对 RFID 卡做某事的任何证据

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T22:38:14.433

定义“有点”。真正的原子方式需要智能卡模块参与分布式事务，我不知道有任何智能卡 API 和/或提供者支持事务。

任何不那么原子的东西都不是原子的，你可以玩重试和状态游戏，直到奶牛回家，但除非智能卡写入是[幂等](http://en.wikipedia.org/wiki/Idempotence)的，否则在出现故障时你的正确率为零。如果智能卡写入是幂等的，那么只是重试和确认逻辑的问题：写入状态为“待定”的数据库，提交，然后写入智能卡，然后写入状态为“完成”的数据库。在崩溃时，您需要一个进程来扫描状态“待定”并重试。由于智能卡写入是幂等的，因此重试是安全的。是的，[使用表作为队列](http://rusanu.com/2010/03/26/using-tables-as-queues/)在这里是相关的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T22:29:23.307

您需要先更新数据库，然后在数据库更新成功时预测 RFID 更新。数据库更新应该包含在事务中，以使其也具有原子性。

当然，如果后续的 RFID 更新失败，您会想要回滚数据库更新。因此，我会考虑在数据库更新中包含事务审计。如果 RFID 更新失败，您可以通过为数据库更新调用回滚例程来返回到一致状态。

希望这可以帮助！

# c# - 根据条件动态更改 LINQ 2 SQL 数据库

> ID：10289074
> 
> 赞同：0
> 
> 时间：2012-04-23T22:15:04.520
> 
> 标签：c#, asp.net-mvc

我正在寻找一种方法来动态更改我的 LINQ 2 SQL 对象正在使用的数据库。我们要实现的一般概念是创建一个可用于许多客户端的 MVC 应用程序。URL 的第一个参数类似于“客户端”，因此请求和所有未来的请求都使用该客户端的特定数据库，而不是硬编码的数据库。我不完全确定这是否可行，但这是出于对混合来自不同客户的数据的恐惧而产生的概念。

我希望这不是一个太疯狂的问题。另外，我真的没有任何代码要显示，因为我不知道从哪里开始。:(

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:20:05.910

使用接收连接字符串的 DataContext 构造函数的重载。您可以从 appSettings.config 或 web.config 注入。

# linux - Linux fakeroot 混淆

> ID：10289076
> 
> 赞同：0
> 
> 时间：2012-04-23T22:15:09.137
> 
> 标签：linux, linux-kernel, sudo, fakeroot

我对 fakeroot 实用程序有很多困惑。我正在尝试将字符节点添加到 /dev 文件夹到两个 rootfs。rootfs_1 的所有者是我自己，而第二个的所有者是 root。

1.  rootfs_1 所有者是我。
    一种。如果我做 ls -l. 我将所有者视为“我我”
    b. 我尝试在 rootfs_1/dev 中使用 mknod 创建一个节点，但它失败了。
    C。$fakeroot 命令通过。
    d。ls -al。我将所有者视为 root （我知道这是假的）
    e。现在我可以使用 mknod 在 rootfs_1/dev 中创建一个节点。
    F。退出
    g。新创建的节点的所有者是我所期望的“我”。

2.  rootfs_2 所有者是 root
    a。ls -l。我将所有者视为“root root”
    b。我尝试在 rootfs_2/dev 中使用 mknod 创建一个节点，但它失败了。（预期）
    c。$fakeroot 命令通过。
    d。现在我尝试创建一个节点，但它失败了。

现在，我知道这种行为是预期的。但是我对 fakeroot 的工作原理以及系统调用通过 fakeroot 的流程感到困惑。我认为 fakeroot 做了 LD_PRELOAD 把戏。

任何人都可以详细解释为什么案例 1 有效而案例 2 失败。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T23:03:20.343

fakeroot 所做的只是跟踪处于活动状态时被修改的文件的“假”所有者。它不模拟任何其他文件系统操作，例如文件创建，因此即使它处于活动状态，您仍然无法在 root 拥有的目录中创建文件。

# django - 与装饰器和正常功能相同的条件？

> ID：10289078
> 
> 赞同：4
> 
> 时间：2012-04-23T22:15:23.833
> 
> 标签：django, function, decorator

我想根据正则表达式模式检查某个参数值，并且只有在它们匹配时才继续。这发生在我的应用程序中的许多地方，所以我决定让一个函数进行检查并在需要时调用该函数。现在，在大多数情况下，我需要在视图的开头执行该检查，因此我将其创建为如下所示的装饰器：

```
def validate(f):
    def _inner(request, argument=None):
        if argument is None:
            return HttpResponse(content="No argument given", status=400)
        elif not re.match('^SOME_REGEX$', argument):
            return HttpResponse(content="Invalid argument", status=400)
        else:
            return f(request, argument)
    return _inner 
```

但在其他情况下，我需要从函数中调用该检查器**，**作为嵌套条件的一部分。看来我不能直接调用它，例如`validate(argument)`. 有什么办法可以使用与装饰器和普通函数相同的代码？还是我必须输入两次？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:23:53.113

您当然不必键入两次，只需创建一个`validate`接受值并对其进行验证的函数：

```
def validate(argument):
    return re.match('^SOME_REGEX$', argument) 
```

然后编写一个装饰器，`validate`根据需要调用该函数：

```
def requires_valid(f):
    def _inner(request, argument=None):
        if argument is None:
            return HttpResponse(content="No argument given", status=400)
        elif not validate(argument):
            return HttpResponse(content="Invalid argument", status=400)
        else:
            return f(request, argument)
    return _inner 
```

显然，我不知道您的用例，因此您可能希望将检查移至其中，`None`但`validate`重点是，您不必重复相同的正则表达式两次。

如果你想深入研究更深层次的魔法并坚持使用相同的函数作为装饰器和验证器，你可以尝试这样的事情：

```
def validate(f):
    if callable(f):
        def _inner(request, argument=None):
            if argument is None:
                return HttpResponse(content="No argument given", status=400)
            elif not validate(argument):
                return HttpResponse(content="Invalid argument", status=400)
            else:
                return f(request, argument)
        return _inner
    else:
        return re.match('^SOME_REGEX$', f) 
```

但我建议不要这样做，因为你有一个函数可以做两件非常不同的事情，具体取决于参数的类型。这导致代码更难理解。（“你用这个函数装饰一个视图，它接受一个字符串并返回布尔值？！”）

# ejb - 部署在同一 WAS 实例中的 EJB 的 JNDI 查找

> ID：10289079
> 
> 赞同：0
> 
> 时间：2012-04-23T22:15:29.207
> 
> 标签：ejb, websphere, jndi

在我的 WAS 中，有两个 EAR。第一个 EAR 查找打包在第二个耳朵中的 ejb。我的问题是，既然两个 EAR 在同一个 WAS 中，我们还需要提供属性`java.naming.provider.url as 'iiop://localhost:9810'`还是服务器会自动定位 EJB？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:05:12.097

你不需要。

如果您未指定，它将查看运行两个 EAR 的本地命名服务器。

高温高压

芒鲁

# .htaccess - 带有 GET 变量的 Htaccess 重定向

> ID：10289080
> 
> 赞同：0
> 
> 时间：2012-04-23T22:15:37.513
> 
> 标签：.htaccess, redirect

我一直在寻找答案，并决定最好问一下。我正在尝试重定向以下内容：

```
redirect 301 /store/?p=3m_controltac http://www.designtoprint.com/3m-controltac 
```

我知道这与使用 GET 变量有关，但我尝试过的每个示例都以失败告终。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:33:34.127

您不能使用`Redirect`指令执行此操作，因为它不适用于 GET 变量。您最好的选择是使用**mod_rewrite**（或直接在您的网页（例如 php 文件）中实现它）：

```
RewriteEngine On

RewriteCond %{QUERY_STRING} =p=3m_controltac
RewriteRule ^store/$ http://www.designtoprint.com/3m-controltac? [R=301,L] 
```

这会将（使用 301 代码）从重定向`/store/?p=3m_controltac`到`http://www.designtoprint.com/3m-controltac`ONLY（不会影响其他 URL）。

# iphone - UIActivityBackground 与 blackBackground

> ID：10289081
> 
> 赞同：0
> 
> 时间：2012-04-23T22:15:37.920
> 
> 标签：iphone, objective-c, ios, ipad

我正在尝试将 UIActivityIndi​​catorView 放在黑色背景上，但是我看不到它在旋转。为什么是这样？这是我所拥有的：

```
 UIActivityIndicatorView *indicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
    [indicator setCenter:CGPointMake(0, 15)];
    [indicator setBackgroundColor:[UIColor blackColor]];
    [indicator startAnimating];
    [indicator hidesWhenStopped]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:27:45.440

您实际上是在某处将 ActivityIndi​​cator 添加为子视图吗？

如果不是，您应该将其添加到 viewDidLoad 或其他适当的地方，使用：

```
[self.view addSubview:indicator] 
```

另外我不确定 setBackgroundColor 是否会产生您想要的效果。我使用 UIImageView 和带有径向角的黑色图像来实现这一点。我还喜欢将黑色图像的 Alpha 值设置为 75% 左右。然后，每当我调用 startAnimating 时，我也会显示 imageView，而当我调用 stopAnimating 时，我会隐藏 imageview。

# jquery - 如何刷新选择/无线电输入（保存到本地数据库后）

> ID：10289086
> 
> 赞同：1
> 
> 时间：2012-04-23T22:15:51.340
> 
> 标签：jquery, html, jquery-mobile

我只想在执行我的一个数据库调用之后刷新我的选择/单选按钮。我执行它们并且选择菜单没有刷新，我不知道如何处理这种情况。（我知道 selectmenu.('refresh') 我在相同的代码中使用它只是不是在我的一个数据库调用之后）

**设想**

我正在为我公司的技术人员编写一个使用 JQuery 的 Web 应用程序。他们将能够填写表格并将其直接提交到我们的数据库。如果没有互联网连接，用户可以将他们的值保存到本地数据库中，这样当有互联网连接时，他们可以稍后发送。共有三个菜单，基本信息，照明时间表和关闭时间，以及一个本地数据库。

这是 JSFiddle [http://jsfiddle.net/QQUnx/6/](http://jsfiddle.net/QQUnx/6/)

**问题** 保存到本地数据库后（打开可折叠并推送创建，必须先填写所有基本信息），输入槽值设置为“”。但是这里的问题是选择菜单和标有 HVAC 的单选按钮没有刷新。他们的旧价值观仍然存在。我知道他们没有被刷新，我尝试了几种不同的方法来解决这个问题，但很难弄清楚这个......有什么想法吗？

**注意：**当前与数据库关联的唯一字段是“项目编号、站点名称、联系人姓名、技术名称、区域 #1 描述、HVAC #1 和星期一的工作时间”这些是唯一应该设置回的字段到现在为止为空。因此，出于测试目的，我们希望刷新**HVAC #1**和第一个时间选项，标记为**Monday ON**

现在试着让这两个令人耳目一新。一旦我让这些工作正常，我将向 Database.js 文件写入更多内容，以使其保存并刷新这些值。

**正确的解决方案**是在调用 onCreate 函数后在 HVAC 单选按钮和/或第一个选择菜单（标记为 Monday On）上执行刷新的 JSFiddle。选择菜单更重要。
**按下 Create 时，您可以看到 Monday on 的值已保存并附加到列表中。**

谢谢。

# ios - 在模拟器上更改测试用户的应用内购买

> ID：10289099
> 
> 赞同：1
> 
> 时间：2012-04-23T22:16:55.780
> 
> 标签：ios, testing, in-app-purchase

> **可能重复：**
> [在 iOS5 模拟器上从 AppStore 注销](https://stackoverflow.com/questions/8028472/logout-from-appstore-on-ios5-simulator)

我最近一直在开发这个具有应用内购买功能的应用。几周前我主要设置了 IAP 的东西，现在才回来完成它。当我第一次开始使用此代码时，我已将所有内容设置为连接到测试用户帐户并在沙盒模式下进行虚假购买。这一切都很好，即使在模拟器中（与我在这里看到的一些信息相反），但在试图弄清楚如何重新测试一些购买时，我删除了我一直在使用的测试用户。我的 iOS 模拟器仍在使用这个已删除的旧测试用户，我似乎无法弄清楚如何将模拟器中的设置更改为不同的帐户（假设有办法）。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T00:49:31.030

您是否尝试过以下方法：

1.  在从 Xcode 再次运行之前删除模拟器上的应用程序。
2.  在模拟器上，在 iOS Simulator 菜单下，选择 Reset Content and Settings...

# android - 在 Eclipse 中使用 JmDNS 进行服务发现：Wifistatemachine 错误

> ID：10289100
> 
> 赞同：1
> 
> 时间：2012-04-23T22:17:11.590
> 
> 标签：android, eclipse, jmdns

我的代码有效，但突然无法正常工作。代码如下。

```
public class AndroidDnssdDiscoveryTestActivity extends Activity {
/** Called when the activity is first created. */

android.net.wifi.WifiManager.MulticastLock lock;
android.os.Handler handler = new android.os.Handler();
final Context context = this;
AlertDialog alert=null;

public void onCreate(Bundle savedInstanceState) {

    /*
     * StrictMode.ThreadPolicy was introduced since API Level 9 and the default thread policy had been changed since API Level 11,
     * which in short, does not allow network operation (include HttpClient and HttpUrlConnection) get executed on UI thread. 
     * if you do this, you get NetworkOnMainThreadException. It needs to add the following 3 lines.
    */
     if (android.os.Build.VERSION.SDK_INT > 9) {
          StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
          StrictMode.setThreadPolicy(policy);
     }

     super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

        handler.postDelayed(new Runnable() {
            public void run() {
                setUp();
            }
            }, 1000);
}

private String type = "_http._tcp.local.";
private JmDNS jmdns = null;
private String Servername ="test._http._tcp.local.";
private boolean _findSECE = false;
private ServiceListener listener = null;
private HttpClient httpclient = new DefaultHttpClient();
private ServiceInfo serviceInfo;

//private ServiceInfo serviceInfo;

private void setUp() {

    android.net.wifi.WifiManager wifi = (android.net.wifi.WifiManager) getSystemService(android.content.Context.WIFI_SERVICE);

    lock = wifi.createMulticastLock("mylockthereturn");
    lock.setReferenceCounted(true);
    lock.acquire();

    try {
        jmdns = JmDNS.create();
        notifyUser("create");
        jmdns.addServiceListener(type, listener = new ServiceListener() {

            public void serviceResolved(ServiceEvent ev) {

                final String getName = ev.getInfo().getQualifiedName();
                final String getUrl = ev.getInfo().getURLs()[0];

                if(getName.equalsIgnoreCase(servername))
                {

                    Log.d("getName",getName);
                    Log.d("getUrl",getUrl);

                    // show alert
                    ((Activity) context).runOnUiThread(new Runnable() {

                        public void run() {
                            alertDialog(getName,getUrl);
                        }
                    });

                }else{

                        notifyUser("Name: " + getName+"\nURL: " + getUrl);
                        Log.d("getName",getName);
                        Log.d("getUrl",getUrl);

                }

            }

            public void serviceRemoved(ServiceEvent ev) {
                notifyUser("Service removed: " + ev.getName());
            }

            public void serviceAdded(ServiceEvent event) {
                // Required to force serviceResolved to be called again (after the first search)
                jmdns.requestServiceInfo(event.getType(), event.getName(), 1);
            }
        });

        serviceInfo = ServiceInfo.create("_http._tcp.local.", "AndroidTest", 0, "plain test service from android");
        jmdns.registerService(serviceInfo);

    } catch (IOException e) {
        e.printStackTrace();
        return;
    }

}

public void alertDialog(final String getName, final String getUrl){
    AlertDialog.Builder builder = new AlertDialog.Builder(context);
    builder.setMessage("SECE service found! Do you want to control the light?")
           .setCancelable(false)
           .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {

                   Log.d("ACTION","BUTTON Pressed");
                   SendHttpPost(getName,getUrl);

               }
           })
           .setNegativeButton("No", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                    dialog.cancel();
               }
           });
    alert = builder.create();
    alert.show();

}

private void SendHttpPost(String getName, String getUrl){

    HttpGet httpget = new HttpGet(getUrl);

    try {
        HttpResponse response = httpclient.execute(httpget);
                    HttpEntity entity = response.getEntity();
        byte buffer[] = new byte[1024] ;
        InputStream is = entity.getContent() ;
        int numBytes = is.read(buffer) ;
        is.close();
        String entityContents = new String(buffer,0,numBytes) ;
        Log.d("getName",getName);
        Log.d("getUrl",getUrl);
        Log.d("replay",entityContents);

    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

}

private void notifyUser(final String msg) {
    handler.postDelayed(new Runnable() {

        public void run() {
            TextView t = (TextView)findViewById(R.id.text);
            t.setText("\n===========\n"+t.getText());
            t.setText(msg+t.getText());
        }
        }, 1);

}

@Override
    protected void onStart() {
    super.onStart();

}

@Override
    protected void onStop() {
    if (jmdns != null) {
        if (listener != null) {
            jmdns.removeServiceListener(type, listener);
            listener = null;
        }
        jmdns.unregisterAllServices();
        try {
            jmdns.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        jmdns = null;
    }
    lock.release();
    super.onStop();
} 
```

}

我在下面遇到这样的错误“ 04-23 21:56:25.031: E/WifiService(94): Multicaster binderDied 04-23 21:56:25.041: E/WifiStateMachine(94): Error! unhandled message{ what=131156 when=-9ms } 04-23 21:56:34.562: E/WifiStateMachine(94): Error! unhandled message{ what=131157 when=-3ms } 04-23 21:56:53.952: A/NetworkStats(94):读取网络统计信息时出现问题 04-23 21:56:53.952: A/NetworkStats(94): java.lang.IllegalStateException: 解析 idx 1 .... 的问题

你有什么主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T16:55:37.383

您可以尝试仔细检查您的网络`permissions`没有消失/改变。

```
android.permission.ACCESS_NETWORK_STATE
android.permission.ACCESS_WIFI_STATE
android.permission.INTERNET
android.permission.CHANGE_WIFI_MULTICAST_STATE 
```

# mysql - 不知道为什么 django South 试图运行反向迁移

> ID：10289106
> 
> 赞同：2
> 
> 时间：2012-04-23T22:17:51.817
> 
> 标签：mysql, django, django-south

当我运行`python manage.py migrate api`它时，它会因“RuntimeError：无法逆转此迁移”而失败。

问题是，我不确定它为什么会尝试运行反向迁移？失败的文件是 0025，`south_migrationhistory`在 MySQL 数据库的表中没有提到。

任何想法为什么 South 会尝试使用此命令运行反向迁移？

谢谢！

编辑：

完整的堆栈跟踪是：

```
Running migrations for api:
 - Migrating forwards to 0026_auto.
 > api:0025_auto__chg_field_article_curator_response_comment__chg_field_article_cu
Traceback (most recent call last):
  File "manage.py", line 14, in <module> execute_manager(settings)
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/django/core/management/__init__.py", line 459, in execute_manager utility.execute()
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv self.execute(*args, **options.__dict__)
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/django/core/management/base.py", line 232, in execute output = self.handle(*args, **options)
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/south/management/commands/migrate.py", line 105, in handle ignore_ghosts = ignore_ghosts,
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/south/migration/__init__.py", line 191, in migrate_app success = migrator.migrate_many(target, workplan, database)
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/south/migration/migrators.py", line 221, in migrate_many result = migrator.__class__.migrate_many(migrator, target, migrations, database)
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/south/migration/migrators.py", line 292, in migrate_many result = self.migrate(migration, database)
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/south/migration/migrators.py", line 125, in migrate result = self.run(migration)
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/south/migration/migrators.py", line 99, in run return self.run_migration(migration)
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/south/migration/migrators.py", line 86, in run_migration print self.run_migration_error(migration)
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/south/migration/migrators.py", line 286, in run_migration_error (self.format_backwards(migration), extra_info))
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/south/migration/migrators.py", line 273, in format_backwards self.backwards(migration)()
  File "/home/ubuntu/fake-env/local/lib/python2.7/site-packages/south/migration/migrators.py", line 57, in <lambda> return (lambda: direction(orm))
  File "/home/ubuntu/fakeapi/fakeapi/../fakeapi/api/migrations/0025_auto__chg_field_article_curator_response_comment__chg_field_article_cu.py", line 42, in backwards raise RuntimeError("Cannot reverse this migration. 'Image.article' and its values cannot be restored.")
RuntimeError: Cannot reverse this migration. 'Image.article' and its values cannot be restored. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T03:58:15.857

它遇到了迁移错误，并尝试回滚它。您可以暂时清理向后迁移，看看真正的错误是什么。

# spring - 无法在 url rewrite tucky 中使用 spring security

> ID：10289109
> 
> 赞同：1
> 
> 时间：2012-04-23T22:18:00.187
> 
> 标签：spring, model-view-controller, spring-security, urlrewriter

我在 url rewrite tucky 中使用 Spring mvc 以减少扩展的 Urls。一切正常，但我最近在处理 /j_spring_security_check 帖子时遇到了问题。这是我的配置文件

urlrewrite.xml

```
<rule>
   <from>/$</from>
   <to type="forward">home</to>
</rule>
<rule>
   <from>/signup$</from>
   <to type="forward">/signup</to>
</rule>
<rule>
    <from>/j_spring_security_check(\?.*)</from>
    <to last="true">/j_spring_security_check$1</to>
</rule> 
<rule>
    <from>/logout(\?.*)</from>
    <to last="true">/logout$1</to>
</rule> 
<rule>
    <from>^([^?]*)/([^?/\.]+)(\?.*)?$</from>
    <to last="true">$1/$2.htm$3</to>
</rule>
<outbound-rule>
    <from>^(.*)\.htm(\?.*)?$</from>
    <to last="false">$1$2</to>
</outbound-rule> 
```

春季安全`

```
<!-- This is where we configure Spring-Security -->
<security:http auto-config="true" use-expressions="true" access-denied-page="/denied.htm">
    <security:intercept-url pattern="/**"  access="permitAll" />
    <security:intercept-url pattern="/admin/**"  access="hasRole('ROLE_ADMIN')" />
    <security:intercept-url pattern="/user" access="hasRole('ROLE_USER')" />
    <security:form-login login-page="/signup" authentication-failure-url="/signup?error=authenticate" default-target-url="/" />
    <security:logout invalidate-session="true" logout-success-url="/" logout-url="/logout" />
    <security:remember-me key="springRocks" user-service-ref="userDetailsService"/>
</security:http>

<!-- Declare an authentication-manager to use a custom userDetailsService -->
<security:authentication-manager>
    <security:authentication-provider user-service-ref="userDetailsService">
        <security:password-encoder ref="passwordEncoder" />
    </security:authentication-provider>
</security:authentication-manager>

<!-- Use a Md5 encoder since the user's passwords are stored as Md5 in the 
    database -->
<bean
    class="org.springframework.security.authentication.encoding.Md5PasswordEncoder" id="passwordEncoder" />

<bean id="userDaoService" class="com.dolo.dao.jdbc.JdbcUserDao">
    <property name="dataSource" ref="dataSource" />
</bean>

<bean id="userDetailsService" class="com.dolo.services.impl.UserServiceImpl">
</bean>

<bean id="userDetails" class="com.dolo.model.User">
</bean> 
```

`

web.xml

```
 <servlet>
<servlet-name>dolo</servlet-name>
<servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
<init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
        </param-value>
    </init-param>
<load-on-startup>1</load-on-startup> 
```

...

```
<servlet-mapping>
<servlet-name>dolo</servlet-name>
<url-pattern>*.htm</url-pattern> 
```

...

```
<filter>
    <filter-name>UrlRewriteFilter</filter-name>
    <filter-class>org.tuckey.web.filters.urlrewrite.UrlRewriteFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>UrlRewriteFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping> 
```

……

```
 <filter>
<filter-name>springSecurityFilterChain</filter-name>
<filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class> 
```

……

```
 <filter-mapping>
<filter-name>springSecurityFilterChain</filter-name>
<url-pattern>/*</url-pattern>
<dispatcher>REQUEST</dispatcher>
<dispatcher>FORWARD</dispatcher>
<dispatcher>INCLUDE</dispatcher>
<dispatcher>ERROR</dispatcher> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T06:20:01.520

两者可以毫无问题地一起工作

`<filter-mapping>`声明`springSecurityFilterChain`应该在`UrlRewriteFilter`一个之前完成。完成后，您不需要任何重写规则`j_spring_security_check`。

# c# - 通过socket和C#聊天

> ID：10289113
> 
> 赞同：0
> 
> 时间：2012-04-23T22:18:42.183
> 
> 标签：c#, sockets, tcpclient

我做了一个与套接字聊天的应用程序：服务器为服务器创建一个套接字连接并等待来自任何客户端的消息：

```
 using System;
           using System.Collections.Generic;
           using System.ComponentModel;
           using System.Data;
           using System.Drawing;
           using System.Linq;
           using System.Text;
           using System.Windows.Forms;
            using System.Xml;
           using System.Net.Sockets;
           using System.Net;
            using System.Threading;
            using System.IO;
          namespace server
        {
        public partial class Form1 : Form
{
    public static byte[] data;
    public static byte[] data1;
    public static Socket sock;
    public delegate void operation(string s);
    public delegate void operation2();
    public delegate bool verifier();
    public Form1()
    {
      InitializeComponent();
      sock = new Socket(AddressFamily.InterNetwork,SocketType.Stream,ProtocolType.Tcp);

        IPAddress adress = IPAddress.Parse("127.0.0.1");
        IPEndPoint iep = new IPEndPoint(adress, 4000);
        EndPoint ep = (EndPoint)iep;
        sock.Bind(iep);
        sock.Listen(10);
        sock = sock.Accept();
        data1 = new byte[1024];
        data = new byte[1024];
        Thread.Sleep(2000);
        this.Show();
        if (sock.Receive(data) > 0)
      {

          Thread t = new Thread(new ThreadStart(aller));
          t.Start();

      }

    }

    private void effectuer(String s)
    {
        textBox1.Text += "serveur:  " + s + "\r\n";

        message.Text  = "";
    }
    private void effectuer4(String s)
    {
        textBox1.Text += "Client:  " + s + "\r\n";

        message.Text = "";
    }

    private void aller() {

        String  s = ASCIIEncoding.ASCII.GetString(data);

        if (this.InvokeRequired) Invoke((operation)effectuer4, s);
        else effectuer4(s);
       //Thread.Sleep(2000);
        byte[] data2 = new byte[1024];

            if (sock.Receive(data2) > 0 && data2 != data)
            {
                data = data2;
                Thread t = new Thread(new ThreadStart(aller));
                t.Start();
            }

        }

    private void buttonDisconnect_Click(object sender, EventArgs e)
    {
        sock.Close();
        Application.Exit();
    }

    private void buttonSend_Click(object sender, EventArgs e)
    {

        String s = message.Text ;
        data1 = System.Text.Encoding.ASCII.GetBytes(s);

        sock.Send(data1);

        Invoke((operation)effectuer, s);

    }
    }

} 
```

对于客户端：他向服务器发送一个空消息并等待服务器的响应

```
 using System;
  using System.Collections.Generic;
  using System.ComponentModel;
  using System.Data;
  using System.Drawing;
  using System.Linq;
  using System.Text;
  using System.Windows.Forms;
  using System.Net.Sockets;
  using System.IO;
  using System.Diagnostics;
  using System.Threading;
  using System.Net;
  using System.Xml;

    namespace client
    {
      public partial class Form1 : Form
     {
    public static TcpClient SocketPourClient = null;
    public static string ClientMessage;
    public static string ServerMessage;
    Socket sock;
    public static byte[] data;
    public static byte[] data1;
    public delegate void operation(String s);
    public delegate void lancer();
    public delegate bool verifier();

    public Form1(string ip, int port)
    {
        InitializeComponent();
               IPAddress adress = IPAddress.Parse("127.0.0.1");
                IPEndPoint ipEnd = new IPEndPoint(adress, 4000);
              sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
                try
                {
                    sock.Connect(ipEnd);
                }
                catch (SocketException e)
                {
                    MessageBox.Show(e.ToString());
                    sock.Close();

                }
                 Thread t1 = new Thread(envoi);
                   t1.Start();
                    data = new byte[1024];
                    if (sock.Receive(data) > 0)
                {

                    Thread t=new Thread(new ThreadStart(aller));
                    t.Start();
                }

    }

    private void aller()
    {

        String s = ASCIIEncoding.ASCII.GetString(data);

           if(this.InvokeRequired) Invoke((operation)effectuer4, s);
        else effectuer4(s);
          //  Thread.Sleep(2000);
            byte[] data2 = new byte[1024];

                if (sock.Receive(data2) > 0 && data2 != data)
                {
                    data = data2;
                    Thread t = new Thread(new ThreadStart(aller));
                    t.Start();
                }
      }

    private void envoi()
    {
       String s = message.Text ;
        data1 = System.Text.Encoding.ASCII.GetBytes(s);
        sock.Send(data1);
        effectuer(s);

    }

private void effectuer(String s)
{
    textBox1.Text += "client:  " + s + "\r\n";

    message.Text = "";
}

 private void effectuer4(String s)
 {
     textBox1.Text += "Server:  " + s + "\r\n";

     message.Text = "";

 }

private void buttonDisconnect_Click(object sender, EventArgs e)
{
    sock.Close();
    Application.Exit();
}

private void buttonSend_Click_1(object sender, EventArgs e)
{
    String s = message.Text ;
    data1 = System.Text.Encoding.ASCII.GetBytes(s);
    sock.Send(data1);
    Invoke((operation)effectuer, s);

   }

} 
```

}

我的问题是：我不会说服务器或客户端没有义务初始化应用程序，但两次可以这样做+当我将服务器作为控制台应用程序进行时，它可以工作，但是当我将服务器更改为类似应用程序的 winforms 时被屏蔽了！！！！！！所以我需要帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:25:51.400

不要在 Form1 ctor 中运行监听/接受循环！

在单独的监听线程中运行监听/接受。

# oracle - 试图删除重复的行...请求语法帮助

> ID：10289118
> 
> 赞同：0
> 
> 时间：2012-04-23T22:18:54.897
> 
> 标签：oracle, oracle11g

```
DELETE FROM LIM_STAGE.RESULTS A 
WHERE ROWID > ( SELECT min(1) 
                FROM LIM_STAGE.RESULTS B
                WHERE A.result_number = B.result_number ); 
```

此代码返回错误错误 ORA-00932：不一致的数据类型：预期的 ROWID 得到了 NUMBER

而且我不确定如何更改它以获得所需的结果。

似乎我有数字 1 的地方应该是别的东西，但我无法弄清楚如何实际建立各个行号。

感谢帮助摆脱这些重复的行。这是一个包含许多索引和触发器的大表……讨厌重写所有内容。

感谢您的任何帮助..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:25:18.637

这应该有效：

```
delete from lim_stage.results
where rowid not in (
    select min(rowid)
    from lim_stage.results
    group by result_number
) 
```

# memory - Solr 内存不足

> ID：10289119
> 
> 赞同：0
> 
> 时间：2012-04-23T22:19:01.947
> 
> 标签：memory, solr, requirements

嗨，伙计们：我有一个海量索引，对一些与数据挖掘相关的任务很有用。SOLR 在大约占总索引大小 5% 的内存占用上运行时有多慢？一般来说，对于“什么”SOLR 需要它的内存，以及对于给定大小的索引我们通常应该有多少内存，是否有指导方针？

请注意，此索引是非分片的，对于超快速的实时性能不是必需的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T09:43:29.963

Lucene/Solr 提交者 Grant Ingersoll 发布了一个电子表格来计算 Solr 的磁盘和内存需求。请参阅[http://www.lucidimagination.com/blog/2011/09/14/estimating-memory-and-storage-for-lucenesolr/](http://www.lucidimagination.com/blog/2011/09/14/estimating-memory-and-storage-for-lucenesolr/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T03:39:53.957

看看下面的链接是否有用

[http://wiki.apache.org/solr/SolrPerformanceFactors](http://wiki.apache.org/solr/SolrPerformanceFactors)

# python - python Tkinter：将参数传递给函数

> ID：10289128
> 
> 赞同：3
> 
> 时间：2012-04-23T22:19:58.653
> 
> 标签：python, tkinter

可以请任何人帮助我解决我的问题。我是 python 新手，在以下情况下我无法了解如何将参数传递给函数： 在一个单独的文件 (sentiment_analysis) 中，我有一个字典和一个对象数组：

```
positiveSentiments = dict() // here are some words related to each of the object
objects = ['Google', 'Apple', 'Motorola'] 
```

我需要显示每个对象的积极情绪：

```
def onButtonPosObject(p):
for key in sentiment_analysis.positiveSentiments.keys():
    if key == p:
        text.insert(END, sentiment_analysis.positiveSentiments[key])

submenu = Menu(text, tearoff=0)
for p in sentiment_analysis.objects:
   submenu.add_command(label=p, command = lambda : onButtonPosObject(p), underline=0)
textmenu.add_cascade(label='Display positive sentiments', menu=submenu, underline=0) 
```

我想我必须将标签 (p) 的值作为 onButtonPosObject() 函数的参数传递，并且我需要从 positiveSentiments 字典中为每个对象获取单词列表，但我得到像 [] 这样的空值。我将非常感谢任何建议！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T00:13:17.327

您需要在 lambda 中捕获 p 的当前值：

```
submenu.add_command(label=p, command = lambda p=p: onButtonPosObject(p), underline=0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:46:13.940

我猜正在发生的事情是您的 positiveSentiments['Motorola'] 列表是空的。我会在那个“for p in evidence_analysis.objects”循环中添加一个打印语句，看看发生了什么。当您在这样的循环中使用 lambda 命令时，您最终会为每个菜单项设置命令，以便在它们调用 onButtonPosObject 时为 p 传递相同的值（它将是 p 的最终值）。

您需要将变量保存为每个 lambda 本地的名称，并将其作为参数传递（它看起来很乱，我知道）`lambda x=p: onButtonPosObject(x)`：试试看，看看你会得到什么。

# android - 设置 Android 日志级别

> ID：10289129
> 
> 赞同：10
> 
> 时间：2012-04-23T22:20:02.007
> 
> 标签：android

是否可以在未植根的设备上设置日志级别？所以我想以某种方式将设备日志级别更改为“调试”。这是可以做的吗？

由于它没有扎根，我认为 setprop 不会起作用。我也不能更改 local.prop 文件，因为我没有这样做的权限。

除了可能幸运并找到一个包含日志级别的隐藏菜单之外。有没有办法让我以其他方式提高日志级别？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-24T07:33:10.703

`setprop`：

*   在您重新启动设备之前是暂时的，即使在有根手机上也是如此。
*   如果您将属性写入`local.prop`只有在有根手机上才有可能写入，您可以通过重新启动来保留属性。
*   某些属性是只读的，只有在更改某些 init 文件时才能更改。这在有根手机上甚至是不可能的。
*   每个设备（或固件）都可以有一组不同的属性。有根电话不会自动更多。

日志级别：

*   如果打印日志的代码说，`Log.d()`那么它将处于“调试”级别，除非您更改代码并重新编译它，否则您无法更改它。如果您执行`Log.?`无论级别如何，都不会隐藏日志消息。
*   如果您有固件的发布版本，Android 框架会隐藏一些日志消息。要显示这些，您需要将固件重新编译为调试版本。也没有机会让那些显示在有根电话上。
*   一些消息由代码中的局部变量控制，例如`if (LOCAL_LOGV) Log.v(...`- 您需要在此处更改代码才能看到这些消息。
*   一些消息由`Config.LOGV`（=总是`false`）控制，请参见[Config](http://developer.android.com/reference/android/util/Config.html)。也没有办法改变这里的破坏行为。你需要重新编译。
*   在您启用某个属性之前，其他一些日志消息将被隐藏：

例子

```
public static final boolean DEBUG_SQL_CACHE =
Log.isLoggable("SQLiteCompiledSql", Log.VERBOSE); 

// somewhere in code
if (SQLiteDebug.DEBUG_SQL_CACHE) {
    Log.d(TAG, "secret message!");
} 
```

如果你这样做`adb shell setprop log.tag.SQLiteCompiledSql VERBOSE`，你应该会看到这些消息弹出。[日志#isLoggable()](http://developer.android.com/reference/android/util/Log.html#isLoggable%28java.lang.String,%20int%29)

我知道没有全局日志级别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-14T08:03:35.310

让我建议标准日志类的一个小替代品（我是作者）

[https://github.com/zserge/log](https://github.com/zserge/log)

它是向后兼容的，所以你只需要修改你的导入。然后，您可以通过`Log.level(Log.D)`or`Log.level(Log.W)`等​​设置应用程序的最低日志级别，或者您可以使用`Log.useLog(false)`. 无需修改现有的日志记录代码。

Despite of its small size this logger works with both, JVM and Android, allows you to skip the "tag" parameter, simplifies logging of multiple values separated by commas or using a format string. So it's really convenient, easy to migrate to, and only adds ~4 kilobytes to your APK size.

# apache - 找出在 Windows 中运行的 Apache 用户是什么？

> ID：10289133
> 
> 赞同：14
> 
> 时间：2012-04-23T22:20:28.010
> 
> 标签：apache

我是 Windows 新手，我正在尝试找出运行 Apache 的用户。在 Linux 中，我有一个简单的命令`ps aux | grep apache`。我如何在Windows中找到它？它在 httpd.conf 文件中的某个位置吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-10-25T21:07:30.040

您可以在 PHP 脚本中包含一行代码：

```
echo exec('whoami'); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-23T22:31:35.043

默认情况下，Apache 服务注册为系统用户（LocalSystem 帐户）运行。

下面的帮助文档中的“将 Apache 作为服务运行”部分可能会帮助您以您想要的方式配置 Apache。

[http://httpd.apache.org/docs/2.0/platform/windows.html](http://httpd.apache.org/docs/2.0/platform/windows.html)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-04-23T22:27:35.780

1.  按`Ctrl`+ `Shift`+调出任务管理器`Esc`。
2.  转到进程选项卡并按图像名称排序。在 Server 2012 中，转到详细信息选项卡并按名称排序。
3.  查找 apache.exe（或 httpd.exe）并检查用户名列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-10T10:24:54.027

在 Powershell 中，您可以查询注册表以获取运行服务的用户上下文：

```
(Get-ItemProperty HKLM:\system\CurrentControlSet\Services\Apache2.4).ObjectName 
```

# ruby-on-rails - 在 ActiveAdmin 索引视图列中显示子/嵌套属性

> ID：10289138
> 
> 赞同：1
> 
> 时间：2012-04-23T22:20:45.677
> 
> 标签：ruby-on-rails, activeadmin

我试图在 ActiveAdmin 中显示嵌套属性的值。

我的代码如下：

```
index do
  column :code
  column 'Sales Agent' do |client|
    client.sales_agent.agent_name
  end
end 
```

这给了我：

```
NoMethodError in Admin/client_branches#index

Showing /Users/constantlm/.rvm/gems/ruby-1.9.2-p290/gems/activeadmin-0.4.3/app/views/active_admin/resource/index.html.arb where line #1 raised:

undefined method `agent_name' for nil:NilClass 
```

我不明白为什么这不起作用，因为当我执行以下操作时：

```
index do
  column :code
  column 'Sales Agent' do |client|
    raise client.sales_agent.agent_name.inspect
  end
end 
```

它输出：

```
RuntimeError in Admin/client_branches#index

Showing /Users/constantlm/.rvm/gems/ruby-1.9.2-p290/gems/activeadmin-0.4.3/app/views/active_admin/resource/index.html.arb where line #1 raised:

"Peter John" 
```

这也是我希望第一个语句也能做到的（指的是“彼得约翰”），但事实并非如此。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T07:52:10.783

清除您的记录并从新记录开始。另外尝试添加

```
 client.sales_agent.agent_name if !client.sales_agent.nil? 
```

# android - 在 ClickListener 中动态添加视图

> ID：10289141
> 
> 赞同：0
> 
> 时间：2012-04-23T22:20:51.883
> 
> 标签：android

我正在尝试在我的 OnClickListener 中向 RelativeLayout 添加一个视图。

```
 montrolButton.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) {
// myParent is a relative layout
// newChild is an ImageView
                     myParent.addView(newChild);
                     requestLayout();
                 }
}); 
```

我查看了 HierarchyViewer，我没有看到我的新孩子正在添加。如果我想念什么，你能告诉我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T08:08:26.670

是否设置了新视图（图像视图）的布局属性？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:18:09.190

我只是尝试了相同的代码，它可以正常工作。您的变量可能存在问题，`myParent`这不是您期望的元素。

此外，我不必要求`requestLayout()`添加的视图出现在屏幕上。

可能尝试明确获取视图的另一部分并将其添加到那里以查看发生了什么。也只是为了尝试，你可以这样做：

```
 RelativeLayout rv = (RelativeLayout) this.findViewById(R.id.right3);
    ProgressBar iv = new ProgressBar(this);
    rv.addView(iv); 
```

查看您的图像视图而不是 myParent 是否有任何问题

无论如何，如果两个元素都正常，它就可以工作——在活动中没有其他事情可做。

# hook - 挂钩 IDirect3DDevice9::EndScene 方法以捕获游戏视频：无法摆脱录制视频中的文本覆盖

> ID：10289142
> 
> 赞同：1
> 
> 时间：2012-04-23T22:20:57.250
> 
> 标签：hook, directshow.net, direct3d9

事实上，它是多种技术的组合，但我的问题的答案（我认为）最接近 Direct3D 9。我正在连接任意 D3D9 应用程序，在大多数情况下它是一个游戏，并注入我自己的代码来修改EndScene 函数的行为。后缓冲区被复制到一个表面，该表面设置为指向推送源 DirectShow 过滤器中的位图。过滤器以 25 fps 的速度对位图进行采样，并将视频流式传输到 .avi 文件中。在游戏的屏幕上显示了一个文本叠加层，告诉用户应该停止游戏捕获的热键组合，但这个叠加层不应该出现在录制的视频中。除了一个令人讨厌的事实外，一切都运行得又快又漂亮。在随机的情况下，带有文本的帧过度进入录制的视频。这不是一个真正想要的人工制品，最终用户只想在视频中看到他的游戏玩法，而不是别的。我很想听听是否有人可以分享为什么会发生这种情况的想法。这是 EndScene 挂钩的源代码：

```
using System;
using SlimDX;
using SlimDX.Direct3D9;
using System.Diagnostics;
using DirectShowLib;
using System.Runtime.InteropServices;

[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
[System.Security.SuppressUnmanagedCodeSecurity]
[Guid("EA2829B9-F644-4341-B3CF-82FF92FD7C20")]

public interface IScene
{
    unsafe int PassMemoryPtr(void* ptr, bool noheaders);
    int SetBITMAPINFO([MarshalAs(UnmanagedType.LPArray, SizeParamIndex = 1)]byte[] ptr, bool noheaders);
}

public class Class1
{
    object _lockRenderTarget = new object();
    public string StatusMess { get; set; }
    Surface _renderTarget;
    //points to image bytes
    unsafe void* bytesptr;
    //used to store headers AND image bytes
    byte[] bytes;
    IFilterGraph2 ifg2;
    ICaptureGraphBuilder2 icgb2;
    IBaseFilter push;
    IBaseFilter compressor;
    IScene scene;
    IBaseFilter mux;
    IFileSinkFilter sink;
    IMediaControl media;
    bool NeedRunGraphInit = true;
    bool NeedRunGraphClean = true;
    DataStream s;
    DataRectangle dr;

    unsafe int   EndSceneHook(IntPtr devicePtr)
    {
        int hr;

        using (Device device = Device.FromPointer(devicePtr))
            {
           try
            {
                lock (_lockRenderTarget)
                {

                    bool TimeToGrabFrame = false;

                    //....
                    //logic based on elapsed milliseconds deciding if it is time to grab another frame

                    if (TimeToGrabFrame)
                    {

                        //First ensure we have a Surface to render target data into
                        //called only once
                        if (_renderTarget == null)
                        {

                            //Create offscreen surface to use as copy of render target data
                            using (SwapChain sc = device.GetSwapChain(0))
                            {

                                //Att: created in system memory, not in video memory
                                _renderTarget = Surface.CreateOffscreenPlain(device, sc.PresentParameters.BackBufferWidth, sc.PresentParameters.BackBufferHeight, sc.PresentParameters.BackBufferFormat, Pool.SystemMemory);

                            } //end using
                        } // end if

                        using (Surface backBuffer = device.GetBackBuffer(0, 0))
                        {
                            //The following line is where main action takes place:
                            //Direct3D 9 back buffer gets copied to Surface _renderTarget,
                            //which has been connected by references to DirectShow's
                            //bitmap capture filter
                            //Inside the filter ( code not shown in this listing) the bitmap is periodically
                            //scanned to create a streaming video.
                            device.GetRenderTargetData(backBuffer, _renderTarget);

                            if (NeedRunGraphInit) //ran only once
                            {
                                ifg2 = (IFilterGraph2)new FilterGraph();
                                icgb2 = (ICaptureGraphBuilder2)new CaptureGraphBuilder2();
                                icgb2.SetFiltergraph(ifg2);
                                push = (IBaseFilter) new PushSourceFilter();
                                scene = (IScene)push;

                                //this way we get bitmapfile and bitmapinfo headers
                                //ToStream is slow, but run it only once to get the headers
                                s = Surface.ToStream(_renderTarget, ImageFileFormat.Bmp);
                                bytes = new byte[s.Length];

                                s.Read(bytes, 0, (int)s.Length);
                                hr = scene.SetBITMAPINFO(bytes, false);

                                //we just supplied the header to the PushSource
                                //filter. Let's pass reference to
                                //just image bytes from LockRectangle

                                dr = _renderTarget.LockRectangle(LockFlags.None);
                                s = dr.Data;
                                Result r = _renderTarget.UnlockRectangle();
                                bytesptr = s.DataPointer.ToPointer();
                                hr = scene.PassMemoryPtr(bytesptr, true);

                                //continue building graph
                                ifg2.AddFilter(push, "MyPushSource");

                                icgb2.SetOutputFileName(MediaSubType.Avi, "C:\foo.avi", out mux, out sink);

                                icgb2.RenderStream(null, null, push, null, mux);

                                 media = (IMediaControl)ifg2;

                                 media.Run();

                                 NeedRunGraphInit = false;
                                 NeedRunGraphClean = true;

                                 StatusMess = "now capturing, press shift-F11 to stop";

                            } //end if

                        } // end using backbuffer
                    } //  end if Time to grab frame

                } //end lock
            } // end  try

            //It is usually thrown when the user makes game window inactive
            //or it is thrown deliberately when time is up, or the user pressed F11 and
            //it resulted in stopping a capture.
            //If it is thrown for another reason, it is still a good
            //idea to stop recording and free the graph
            catch (Exception ex) 
            {
               //..
               //stop the DirectShow graph and cleanup

            } // end catch

            //draw overlay
            using (SlimDX.Direct3D9.Font font = new SlimDX.Direct3D9.Font(device, new System.Drawing.Font("Times New Roman", 26.0f, FontStyle.Bold)))
            {
                font.DrawString(null, StatusMess, 20, 100, System.Drawing.Color.FromArgb(255, 255, 255, 255));
            }

            return device.EndScene().Code;

        } // end using device

    } //end EndSceneHook 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T05:25:39.690

有时会发生这种情况，如果有人感兴趣，我终于自己找到了这个问题的答案。事实证明，某些 Direct3D9 应用程序中的后缓冲区不一定会在每次调用挂钩的 EndScene 时刷新。因此，有时带有来自上一个 EndScene 钩子调用的文本覆盖的后缓冲区被传递给负责收集输入帧的 DirectShow 源过滤器。我开始用已知 RGB 值的微小 3 像素叠加来标记每一帧，并在将帧传递给 DirectShow 过滤器之前检查这个虚拟叠加是否仍然存在。如果覆盖层存在，则传递先前缓存的帧而不是当前帧。这种方法有效地从 DirectShow 图表中记录的视频中删除了文本覆盖。

# iphone - UISplitViewController 调整 iPad 大小

> ID：10289145
> 
> 赞同：1
> 
> 时间：2012-04-23T22:21:45.677
> 
> 标签：iphone

如何调整整个 SplitViewController 的大小？小于全屏表示。我想在 The Daily 报纸应用程序中进行注册等代表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:31:31.317

我相信您必须实现自己的 UISplitViewController 版本。一种流行的替代方法是[MGSplitViewController](https://github.com/mattgemmell/MGSplitViewController)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:28:39.483

UISplitViewController 必须是 RootViewController （有一个很好的解释为什么[这个问题](https://stackoverflow.com/a/5853298/459116)），我不认为你可以调整它的大小。您需要创建自己的类来实现您希望拥有模态类型 UISplitViewController 的功能，这就是我认为 The Daily 所做的。

# hyperlink - 悬停时选择的带有文本阴影擦除条的突出显示链接

> ID：10289152
> 
> 赞同：0
> 
> 时间：2012-04-23T22:22:18.620
> 
> 标签：hyperlink, webkit, css

当我将鼠标悬停在突出显示的链接上时，它似乎在选择中创建了一种栏。很奇怪。它低于下划线，所以我认为它与此无关。

![在此处输入图像描述](../Images/65ad36a7619089d47864609d06b4c1f5.png)

我将鼠标悬停在“consectetur”和“sapein interdum……”上。即使在老鼠离开后，酒吧也会留在那里。如果一条线的一端有链接，另一端有另一端，则悬停两者会使条形图连接并填充整条线。

有两件事可以解决这个问题：

*   去除文字阴影
*   悬停时不更改链接颜色

相关CSS：

```
#content {
    color: #444;
font-family: 'Armata', sans-serif;
text-shadow: 1px 1px 0 #fafafa;
    line-height: 50px; // make it way too big just to make sure you can see it
}

a { text-decoration: none; color: #069; }
a:hover { color: #08c; } 
```

发生在 Safari 和 Chrome (webkit) 上，不确定其他人。

# php - php从日期字符串中获取微时间

> ID：10289160
> 
> 赞同：16
> 
> 时间：2012-04-23T22:23:41.977
> 
> 标签：php, strtotime, microtime

我试图让两个日期时间字符串之间传递的时间（包括毫秒）

例子：

```
$pageTime = strtotime("2012-04-23T16:08:14.9-05:00");
$rowTime = strtotime("2012-04-23T16:08:16.1-05:00");
$timePassed = $rowTime - $pageTime;
echo $timePassed . "<br/><br/>"; 
```

我希望看到回显的是“1.2”，但`strtotime()`忽略了字符串的毫秒部分。另外，显然`microtime()`不允许你给它一个日期字符串......是否有计算这个的替代函数，或者我将不得不做一些字符串解析来提取秒和毫秒并减去？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-23T22:29:23.540

[改用DateTime](http://php.net/DateTime)试试。

这需要一些解决方法，因为`DateInterval`（由 返回`DateTime::diff()`）不计算微秒，因此您需要手动执行此操作

```
$pageTime = new DateTime("2012-04-23T16:08:14.1 - 5 hours");
$rowTime  = new DateTime("2012-04-23T16:08:16.9 - 5 hours");

// the difference through one million to get micro seconds
$uDiff = abs($pageTime->format('u')-$rowTime->format('u')) / (1000 * 1000);

$diff = $pageTime->diff($rowTime);

echo $diff->format('%s')-$uDiff; 
```

我总是推荐`DateTime`因为它的灵活性，你应该研究一下

**编辑**

为了向后兼容 PHP 5.2，它采用与毫秒相同的方法：

```
$pageTime = new DateTime("2012-04-23T16:08:14.1 - 5 hours");
$rowTime  = new DateTime("2012-04-23T16:08:16.9 - 5 hours");

// the difference through one million to get micro seconds
$uDiff = abs($pageTime->format('u')-$rowTime->format('u')) / (1000 * 1000);

$pageTimeSeconds = $pageTime->format('s');
$rowTimeSeconds  = $rowTime->format('s');

if ($pageTimeSeconds + $rowTimeSeconds > 60) {
  $sDiff = ($rowTimeSeconds + $pageTimeSeconds)-60;
} else {
  $sDiff = $pageTimeSeconds - $rowTimeSeconds;
}

if ($sDiff < 0) {
  echo abs($sDiff) + $uDiff;
} else {
  // for the edge(?) case if $dt2 was smaller than $dt
  echo abs($sDiff - $uDiff);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-12T20:04:19.640

基于 Dan Lee 的回答，这是一个通用的解决方案：

```
$pageTime = new DateTime("2012-04-23T16:08:14.9-05:00");
$rowTime  = new DateTime("2012-04-23T16:08:16.1-05:00");

$uDiff = ($rowTime->format('u') - $pageTime->format('u')) / (1000 * 1000);

$timePassed = $rowTime->getTimestamp() - $pageTime->getTimestamp() + $uDiff; 
```

完整解释：

*   我们将两个日期之间的有符号微秒差存储在中`$uDiff`，并将结果除以 1000 * 1000 以秒为单位进行转换
*   操作数的顺序`$uDiff`很重要，并且必须与 $timePassed 操作中的顺序相同。
*   我们计算两个日期之间的 Unix 时间戳（以整秒为单位）差异，并添加微秒差异以获得想要的结果
*   [`DateTime::getTimestamp()`](http://php.net/manual/en/datetime.gettimestamp.php)即使差异大于 60 秒，使用也会给出正确答案

# c# - 调用更改文本框值的方法

> ID：10289166
> 
> 赞同：0
> 
> 时间：2012-04-23T22:24:49.523
> 
> 标签：c#

我有一个名为 BuyShares() 的方法，它应该在文本框中获取一个值并向其中添加另一个用户输入值。我想使用一个消息框，通过用户单击确定来触发该方法。唯一的问题是我似乎无法调用该方法。这就是方法。

```
public void BuyShares(int anAmount)
    {
        int newShares;
        newShares = GetInvestmentShare() - anAmount;
        SetInvestmentShare(newShares);
    } 
```

这是我设置的消息框

```
 private void button1_Click(object sender, EventArgs e)
    {
        DialogResult result;
        result = MessageBox.Show("Your transaction is complete", "Success", MessageBoxButtons.OK);
        if(result==DialogResult.OK)
        {
            txtStockSharesTab3.Text=??????
    } 
```

这是一个 Windows 窗体应用程序，该程序有几个不同的类

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:36:11.600

没有给出答案，因为你可能想从中学到一些东西......

我猜您想从一个文本框中获取要购买的股票数量，然后调用`BuyShares`并最终更新`txtStockSharesTab3`为该值。

您的`BuyShares`方法返回`void`意味着它不会返回值。该方法中的某处是您要更新`txtStockSharesTab3`文本框的地方。是否需要该确切的方法签名`BuyShares`？

# ssrs-2008 - 预定轮询间隔选项

> ID：10289167
> 
> 赞同：2
> 
> 时间：2012-04-23T22:25:10.153
> 
> 标签：ssrs-2008, ssas

我对 SSAS 中的预定轮询间隔选项感到困惑。假设我希望每 10 分钟更新一次数据。在维度的存储选项对话框中，第一个选项卡显示：“定期更新缓存”并允许我指定每 10 分钟重建一次。在第二个选项卡上，它显示“计划轮询”，并允许我选择 10 分钟的轮询间隔。

每 10 分钟重建一次缓存和每 10 分钟计划轮询有什么区别？两者都需要指定吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T09:12:46.233

非常好的问题，如果可以的话，我会投票不止一次:)

基本上，第一个选项卡告诉您缓存将如何更新。根据选项，您需要在第二个选项卡上配置通知的处理方式。

所以，得到你的例子。如果您将“定期更新缓存”设置为 10 分钟，则意味着缓存将每 10 分钟完全重建一次，例如删除它并重新创建它。如果您考虑一下，SQL Server 不需要告诉 SSAS 执行任务，SSAS 知道它必须每 10 分钟到达 SQL Server 以获取新数据。因此，忽略第二个选项卡上的配置。

现在，假设您选择选项一“数据更改时更新缓存”。这意味着只有在 SQL Server 上的数据发生变化时才会更新缓存。为此，SSAS 需要某种通知来了解数据何时发生变化。

那时第二个选项卡就位，您可以在其中选择通知类型。在您的情况下，计划池意味着每隔 10 分钟，SSAS 将运行您在“池查询”中指定的查询以检查数据是否已更改，如果是，它将在“处理查询”中运行查询以实际执行更新数据。

仅供参考，作为通知模式，指定跟踪表要容易得多。您不需要编写查询，只需选择表。

# database - 为什么在数据库管理恢复中 Aries 在撤消之前执行重做？

> ID：10289170
> 
> 赞同：2
> 
> 时间：2012-04-23T22:25:21.850
> 
> 标签：database, recovery, aries

如果 Aries 算法已经知道在分析阶段之后要撤消哪些事务，为什么 Aries 算法会在撤消之前应用重做？

我知道（认为）它与 Lsn 编号和保持一致性有关，因为在磁盘上刷新的数据可能与在崩溃时撤消事务不同（由于脏），撤消事务页），但我找不到任何形式的“正式”回答这个问题（至少一个我能理解的）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T20:22:59.413

因为即使提交了事务，缓冲区上也可能存在未刷新的页面。ARIES在缓冲区管理器中使用**no-force 。**重做会将事务表和脏页表带到崩溃时的状态。因此，成功的交易可以反映到稳定的存储中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-12T03:36:43.457

## 简短的回答：

我们需要在重做过程中重复所有历史崩溃，以在执行撤消过程之前确保数据库的一致性。

## 长答案：

[恢复算法 ARIES](http://en.wikipedia.org/wiki/Algorithms_for_Recovery_and_Isolation_Exploiting_Semantics)，为了保证 DBMS 的原子性和持久性，执行 3 遍：

1.  **分析通行证**：看看需要做什么（播放日志转发）
2.  **Redo pass**：确保磁盘反映日志中但不在磁盘上的任何更新，包括属于最终将回滚的事务的更新。这样可以确保我们处于***一致的状态***，这将允许逻辑撤消。
3.  **Undo pass** : 删除任何丢失交易的动作

UNDO 数据日志是逻辑的，而 REDO 数据日志是物理的：

*   我们必须进行物理重做，因为我们不能保证数据库处于一致状态（例如，记录“INSERT VALUE X INTO TABLE Y”可能不是一个好主意，因为 X 可能会反映在索引中，但不是表格，反之亦然，以防插入时发生崩溃）
*   我们可以做逻辑UNDO，因为在REDO之后我们知道事情是一致的。事实上，我们必须进行逻辑 UNDO，因为我们只 UNDO 一些操作，并且物理记录形式的 UNDO，例如，“拆分索引 y 的页面 x”在索引管理或不变量方面可能不再是正确的做法维护。在重做期间我们不必担心这一点，因为我们重复历史并重播所有内容，这意味着上次对数据库所做的任何物理修改仍然是正确的。

[资源](http://db.csail.mit.edu/6.830/notes.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T22:30:03.627

不知道 aries 是什么，但假设它与其他数据库相同：

从一些基础备份开始应用重做日志，这基本上意味着在备份之后但在崩溃之前发生的所有数据更改语句都被应用。否则，您将丢失自上次备份以来发生的一切。

完成后，所有未完成的事务都会回滚，因为没有人可以拿起这些事务来完成它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-25T03:41:36.850

您可以考虑在重做和撤消期间真正做了什么。根据退出的日志，重做正在重复历史。相反，撤消是创建新的 CLR 日志记录。当系统崩溃时，日志中有关于未提交的 xact 的记录。如果不撤消它们，将不会有 CLR 日志记录，从而导致不一致。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T23:02:41.857

您希望在失败时返回状态，以便准确了解哪些事务需要撤消。想到的一个例子是连续的失败。从崩溃中恢复时的精确故障。在恢复期间，您将您的操作写入日志。如果您在恢复过程中失败，您将重做日志中的所有操作（甚至是上次尝试期间写入的 UNDO 操作！！）。

它提供了一个简单的算法，因为您不必处理特殊情况和特殊情况的特殊情况。可以保证，在恢复期间发生任何数量的崩溃后，我们将回到与恢复期间没有崩溃相同的状态。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-29T15:06:55.273

如果您不支持记录级锁定，那么您可以使用仅重做获胜者事务的选择性重做。否则，最好在撤消之前重复历史（全部重做）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-26T03:56:38.600

ARIES 的目标之一是简单。虽然重做之后的撤消可能不是必需的，但它使算法的正确性比在重做之前进行撤消的更复杂的方案更明显。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-14T20:35:29.977

除了确保数据库是一致的并且磁盘与崩溃发生之前完全相同（正如 Franck Dernoncourt 回答的那样），在撤消之前执行重做的另一个好处是：

在恢复过程中可能会发生故障。Redo推进了整个“增量恢复”的进程，即如果redo或undo过程中发生故障，如果redo在undo之前执行，则下一个恢复可以拾取上一个恢复（redo）剩下的部分继续进行。

一个极端的情况是，如果 undo 在 redo 之前执行，并且在 undo 过程中再次失败，那么所有的 undo 都将成为徒劳。

# python - 删除容器是否会破坏 GTK 内存中的小部件内部

> ID：10289171
> 
> 赞同：2
> 
> 时间：2012-04-23T22:25:23.910
> 
> 标签：python, gtk3

我正在使用 GTK3 在 python 中做一个程序。我需要根据用户需要更改 GUI 界面。如果我有一个添加了 Gtk.Box 的窗口，然后在框中放置标签和文本条目之类的内容，然后在需要更改界面时删除 Box，是否会删除标签和文本条目在记忆中？我对 Python 最感兴趣，但也想学习 C。C的答案是否不同？

如果它没有自动销毁 Gtk.Box，那么这意味着不断跟踪盒子中的每个小部件，并且需要为每个小部件调用一个 widget.destroy()。好像有点浪费。

谢谢，

纳尼

```
>>> import gtk
>>> win = gtk.Window()
>>> vbox = gtk.VBox()
>>> win.add(vbox)
>>> label = gtk.Label("Hello, everybody!")
>>> vbox.pack_start(label, True, True, 0)
>>> win.show_all()
>>> vbox.destroy() 
```

vbox.destroy() 是否也会破坏标签对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T20:16:51.080

当你销毁一个容器时，里面的小部件的引用计数会减少。如果一个小部件的引用计数下降到零，它就会被销毁。因此，如果您的代码中没有任何额外的引用，那么当您销毁容器时，小部件将被销毁。

在 C 中，你是否持有一个引用是毫无疑问的。如果您创建了小部件并且尚未将其添加到容器中，或者`g_object_ref()`在小部件上调用，那么您有一个参考。如果不是，则不是。

在 Python 中，事情要复杂得多。如果小部件绑定到 Python 解释器中的名称，则它可能添加了额外的引用。如果您在像 IPython 这样跟踪旧输入的解释器中以交互方式进行操作，那么可能有几个参考。但是在 Python 中你不需要担心这个；当对象不再可访问时，垃圾收集器将删除引用，即使在您销毁容器时它没有被销毁。

# c++ - COM TypeLib 中自动生成的 C++ 类在方法中不返回 SAFEARRAY

> ID：10289172
> 
> 赞同：1
> 
> 时间：2012-04-23T22:25:26.837
> 
> 标签：c++, com, typelib, safearray

让我首先声明，我不是 COM 开发人员。我知道标准的 C++、C# 和 Java。

我有一个将从托管 C++ 调用的 C# 库。我使用 Visual Studio 2010 -> TypeLib 中的 MFC 类添加了 C++ 类。自动生成的 C++ 类虽然不能编译。它显然缺少返回语句。我该如何解决？我非常感谢任何帮助。

**库中的 C# 类**

```
[Serializable]
[
       ClassInterface(ClassInterfaceType.AutoDual),
       ProgId("Response")
]
public class Response
{
    public static readonly int NUM_DATA = 6;

    public Response()
    {
        data = new Data[NUM_DATA];
        for (int i = 0; i < NUM_DATA; ++i)
        {
            data[i] = new Data();
        }
    }

    private Data[] data;
    public Data[] Data
    {
        [return: MarshalAs(UnmanagedType.SafeArray)]
        get
        {
            return data;
        }
    }
} 
```

**托管 C++ 生成的类**

```
class CResponse : public COleDispatchDriver
{
public:
    CResponse(){} // Calls COleDispatchDriver default constructor
    CResponse(LPDISPATCH pDispatch) : COleDispatchDriver(pDispatch) {}
    CResponse(const CResponse& dispatchSrc) : COleDispatchDriver(dispatchSrc) {}

    // _Response methods
public:
    SAFEARRAY * get_Data()
    {
        InvokeHelper(0x60020004, DISPATCH_PROPERTYGET, VT_EMPTY, NULL, NULL);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:06:00.430

这个问题似乎有三种常见的解决方案。第一种是将返回数组作为函数的参数。所以像这样：

```
CustomData[] getCustomDataArray();
void getCustomDataArray(out CustomData[]); 
```

第二种选择是编写一个访问数组的函数，而不是使用整个数组。

```
CustomData getCustomDataAt(int index);
void setCustomDataAt(int index, CustomData data); 
```

最后一个选项是更改 MarshalAs 属性。我将使用第一个选项，因为它似乎是最普遍接受的解决方案。希望这对其他人有帮助。

# c# - 使用 javascript 客户端将 div 内容保存为 .txt 或 PDF 文件

> ID：10289173
> 
> 赞同：0
> 
> 时间：2012-04-23T22:25:31.023
> 
> 标签：c#, javascript, asp.net-mvc-2

我使用 asp.net mvc 作为背后的技术。我如何将`JavaScript`div“bla bla”的内容保存为`Txt or PDF Document`on `Client-side`？像这样的东西？？如果是，我该怎么做？我的javascript不太强:(

```
<div id="Overview">bla bla</div>
<input type="button" id="SaveAsTxt" onclick="JavaScript:SavePartOfPageAsTxt('Overview');"/></div>

 <script type="text/javascript">
<!--
        function SavePartOfPageAsTxt(elementId) {
        }
// -->
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:36:01.473

您想将文本文件保存在客户端还是服务器上？

要保存到服务器，请使用 Javascript 将数据发送到服务器代码并使用您的服务器代码进行保存。

为了保存到客户端，您可能无法访问客户端的机器（这是正确的），但是，您可以使用 ActiveX 控件或 Flash（不理想）来完成，甚至将其保存为 cookie。

如果您想使用 jQuery，另一个选择是这个插件： [http](http://www.filamentgroup.com/lab/jquery_plugin_for_requesting_ajax_like_file_downloads/) ://www.filamentgroup.com/lab/jquery_plugin_for_requesting_ajax_like_file_downloads/ - 这将询问客户他们是否愿意保存文件。

[编辑：使用 jQuery 关闭对文件的读/写](https://stackoverflow.com/questions/582268/read-write-to-file-using-jquery)副本- 这同样适用于 Javascript/jQuery。

# c#-4.0 - 以编程方式配置 log4net

> ID：10289179
> 
> 赞同：1
> 
> 时间：2012-04-23T22:25:52.727
> 
> 标签：c#-4.0, log4net, fileappender

我在尝试正确配置 log4net 时遇到了最糟糕的情况。首先，我需要提供一些关于我到目前为止（并且成功地）使用它的背景。

我的应用程序有一个 log4net 配置文件，它定义了它应该记录所有数据的 FileAppender。我所有的程序集都有一个`ILog`成员变量，并将其设置为`LogManager.GetLogger( typeof( myclass))`，其中*myclass*是正在记录的类。

一切都像这样工作得很好。

现在我还有一个使用方式略有不同的程序集。它可以被实例化多次，要求是每个实例都记录到自己的文件中。我能够让它以编程方式工作，并放弃 logging.xml 文件。

```
 Hierarchy hierarchy = (Hierarchy)LogManager.GetRepository();
        hierarchy.Root.Level = log4net.Core.Level.All;            
        hierarchy.Configured = true;

        string module_path = MyCompany.Shared.Utils.FileSystem.GetModulePath();
        string folder = module_path + "\\logs\\";
        string path = String.Format("{0}{1}-log.txt", folder, name);

        _log = LogManager.GetLogger( name);

        var fa = new log4net.Appender.FileAppender() { Name = name, File = path, AppendToFile = true};
        var layout = new PatternLayout { ConversionPattern = "%date{{yyyy-MM-dd-HH_mm_ss.fff}} [%thread] %-5level %logger - %message%newline" };
        layout.ActivateOptions();
        fa.Layout = layout;
        fa.ActivateOptions();

        ((Logger)_log.Logger).AddAppender( fa); 
```

这也很好用。现在问题来了：上面的程序集使用了另一个也使用 log4net 的程序集。但是，该程序集预计已经配置了一个记录器以供使用，显然我以编程方式设置 log4net 的方式是阻止它工作。

我启用了内部 log4net 调试，并且我看到的错误消息非常明确地说明了该错误，但我不确定如何（最好）解决问题：

```
log4net: Logger: No appenders could be found for logger [test_logger] repository [log4net-default-repository]
log4net: Logger: Please initialize the log4net system properly.
log4net: Logger:    Current AppDomain context information: 
log4net: Logger:       BaseDirectory   : C:\Sample\bin\Debug\
log4net: Logger:       FriendlyName    : SampleTestApp.vshost.exe
log4net: Logger:       DynamicDirectory: 
log4net: Hierarchy: Shutdown called on Hierarchy [log4net-default-repository] 
```

我假设创建了记录器，因为即使我明确使用`LoggerFactory`创建“test_logger”记录器，我也会遇到相同的错误。因此，只需弄清楚如何为该记录器创建附加程序。我尝试使用以前的代码`FileAppender`为此记录器创建一个，但即使代码运行，我也会收到相同的错误。

任何人都可以为我建议一些事情来尝试让它发挥作用吗？

编辑——我应该澄清一下，我*真的*希望所有日志消息都进入由测试应用程序创建的 FileAppender。我想避免有单独的文件（每个程序集一个）。

# php - 使用 Wikipedia API 时出现 HTTP/1.0 403 禁止错误消息

> ID：10289180
> 
> 赞同：1
> 
> 时间：2012-04-23T22:26:14.320
> 
> 标签：php, wikipedia-api

我正在尝试使用 API 在维基百科中搜索填写表单的用户输入的单词。因此，如果他们在表单中输入“cat”，API 将在维基百科中搜索包含“cat”一词的条目”。我让它工作了，但现在我收到了这条消息：

```
Warning: file_get_contents(http://en.wikipedia.org/w/api.php?action=opensearch&search=parrott): failed to open stream: HTTP request failed! HTTP/1.0 403 Forbidden in /var/www/html/flam1-api.php on line 22 
```

我读到可能需要一个用户代理，但我不确定到底该怎么做。这是我的代码：

```
 echo "<h1>Which LOLcat are you? Results!</h1>";
    $visit_id = $_COOKIE['visit_id'];
    $all_my_variables = json_decode(file_get_contents("/var/www/html/data/$visit_id.json"));
    //var_dump($all_my_variables);
    $animal = $all_my_variables ->favoriteanimal;
    echo "When searching wikipedia entries on your favorite animal, which is a $animal, we got the results:<br>";
     $website = file_get_contents('http://en.wikipedia.org/w/api.php?action=opensearch&search='.urlencode($animal).'');

        echo $website[0]; 
```

我绝对感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:44:21.617

您需要设置一个用户代理（也许通过使用`curl`扩展而不是`file_get_contents`）。使用的默认用户代理`file_get_contents`被明确阻止，因为它通常与滥用行为相关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:45:46.567

某些站点使用 file_get_contents 阻止。我现在没有机会进行测试，但请尝试使用此函数而不是 file_get_contents。

```
function get_url_contents($url){
        $crl = curl_init();
        $timeout = 5;
        curl_setopt ($crl, CURLOPT_URL,$url);
        curl_setopt ($crl, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt ($crl, CURLOPT_CONNECTTIMEOUT, $timeout);
        $ret = curl_exec($crl);
        curl_close($crl);
        return $ret;
} 
```

# asp.net - ASP.NET MVC 更简单的代码

> ID：10289181
> 
> 赞同：0
> 
> 时间：2012-04-23T22:26:17.020
> 
> 标签：asp.net, asp.net-mvc-3

我有以下代码。

```
 <% if (Request.Path.ToLower().Contains("something"))
       {%>
          <%: Html.ActionLink("Something1", "Something1", "Home") %>
       <%}else{%>
           <%: Html.ActionLink("Something2", "Something2", "Home") %>
       <%}%> 
```

我真的需要所有那些打开 <% 和关闭 %> 吗？有没有更简单的方法来写同样的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:36:08.900

```
<% var s = Request.Path.ToLower().Contains("something") ? "Something1" : "Something2"; %>
<%: Html.ActionLink(s, s, "Home") %> 
```

或者，在 Razor 中：

```
@{ var s = Request.Path.ToLower().Contains("something") ? "Something1" : "Something2"; }
@Html.ActionLink(s, s, "Home") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:29:46.273

有*一种*更简单的方法：[Razor 语法](http://haacked.com/archive/2011/01/06/razor-syntax-quick-reference.aspx)。

```
@if (Request.Path.ToLower().Contains("something"))
{
    Html.ActionLink("Something1", "Something1", "Home");
}
else
{
    Html.ActionLink("Something2", "Something2", "Home");
} 
```

但是您可能需要升级。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T22:31:54.727

您可以查看 Razor 语法，尽管您可能需要安装一些升级。

这将产生如下代码：

```
@if (Request.Path.ToLower().Contains("something"))
{
    Html.ActionLink("Something1", "Something1", "Home");
}
else
{
    Html.ActionLink("Something2", "Something2", "Home");
} 
```

[http://weblogs.asp.net/scottgu/archive/2010/07/02/introducing-razor.aspx](http://weblogs.asp.net/scottgu/archive/2010/07/02/introducing-razor.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T22:32:03.400

好吧，您可以使用 Razor 视图/cshtml :)

```
@if(Request.Path.ToLower().Contains("something"))
{
    <div> @Html.ActionLink("Something1", "Something1", "Home") </div>
}else {
    <div> @Html.ActionLink("Something2", "Something2", "Home") </div>
} 
```

# javascript - 在哪里可以找到 javascript 原生函数源代码？

> ID：10289182
> 
> 赞同：15
> 
> 时间：2012-04-23T22:26:18.127
> 
> 标签：javascript, function, native-code

哪里可以找到原生js函数的源码，比如我想看`eval()`函数

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-23T22:35:35.420

Chrome 和 Firefox 都是开源的，您可以在这些产品的源代码中查看 javascript 引擎的任何部分的实现。其他浏览器有自己的实现（如 IE），公众无法查看。

Chrome v8 javascript 引擎代码在这里：[https ://github.com/v8/v8](https://github.com/v8/v8)

Firefox SpiderMonkey 引擎代码在这里： [https ://searchfox.org/mozilla-central/source/js/src](https://searchfox.org/mozilla-central/source/js/src)

警告，如果您还不熟悉这些产品及其工具，可能需要一段时间才能熟悉到足以找到您正在寻找的东西。

这些链接可能会随着时间的推移而变化，但如果它们移动，可以通过 Google 搜索轻松找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T22:39:50.130

Javascript 是一种脚本语言，在浏览器的代码库中实现。这意味着脚本语言可能有不同的实现，具有不同的质量水平，并且可能对所需内容有不同的解释。因此，许多 web 开发人员在处理不同的 web 浏览器时都会遇到挫折。

如果浏览器是开源版本，例如：Chrome、Firefox，您可以检查浏览器的 Javascript 实现，如列出的其他答案中给出的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-23T22:27:34.127

在 JavaScript 引擎的源代码中。

# yii - Yii引导网格：试图获取非对象的属性

> ID：10289194
> 
> 赞同：0
> 
> 时间：2012-04-23T22:28:02.240
> 
> 标签：yii, twitter-bootstrap

这个：

```
$gridDataProvider = new CArrayDataProvider(array(
    array('id'=>1, 'firstName'=>'Mark', 'lastName'=>'Otto', 'language'=>'CSS'),
    array('id'=>2, 'firstName'=>'Jacob', 'lastName'=>'Thornton', 'language'=>'JavaScript'),
    array('id'=>3, 'firstName'=>'Stu', 'lastName'=>'Dent', 'language'=>'HTML'),
));

 $this->widget('bootstrap.widgets.BootGridView', array(
    'type'=>'striped bordered condensed',
    'dataProvider'=>$gridDataProvider,
    'template'=>"{items}",
    'columns'=>array(
        array('name'=>'id', 'header'=>'#'),
        array('name'=>'firstName', 'header'=>'First name'),
        array('name'=>'lastName', 'header'=>'Last name'),
        array('name'=>'language', 'header'=>'Language'),
        array(
            'class'=>'bootstrap.widgets.BootButtonColumn',
            'htmlOptions'=>array('style'=>'width: 50px'),
        ),
    ),
)); 
```

正在返回：

## 试图获取非对象的属性

菜单、按钮（和其他一切）工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T22:45:48.737

这是因为该示例使用 CArrayDataProvider 来填充网格。当您进入 BootButton（生成此列的类）以查看通过它运行的内容时，您会看到它正在尝试从 dataprovider 获取 primaryKey 属性，但是没有这样的属性，因为数据是数组类型的。

如果您打算使用按钮，则必须为您的网格传递一个 CActiveDataProvider。

所以尝试像这样使用：

```
$this->widget('bootstrap.widgets.BootGridView', array(
        'type'=>'striped bordered condensed',
        'dataProvider'=>$model->search(),
        'template'=>"{items}{pager}",
        'filter'=>$model,... 
```

其中 $model 是控制器传递给视图的 CActiveRecord。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:23:46.803

我不知道你在这个类中得到的代码是什么—— bootstrap.widgets.BootButtonColumn 但不管它是什么，这都是导致问题的原因。确保您已定义每个按钮的完整操作，以避免此问题。

我的意思是，对于按钮列中的每个按钮，将 url 设置为 -

```
'$this->grid->controller->createUrl("action_name", array("param_name" => "param_value"))' 
```

这应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T04:41:46.580

是Button Column缺少变量引起的应该是

```
array(
        'class'=>'bootstrap.widgets.BootButtonColumn',
        'htmlOptions'=>array('style'=>'width: 50px'),
                            'viewButtonUrl'=>null,
                            'updateButtonUrl'=>null,
                            'deleteButtonUrl'=>null,
    ), 
```

//[从这里转发](http://www.yiiframework.com/forum/index.php/topic/23982-extension-bootstrap/page__st__140__p__138625#entry138625)

# javascript - 从 Phonegap 指南针获取 x、y、z 值

> ID：10289195
> 
> 赞同：2
> 
> 时间：2012-04-23T22:28:02.913
> 
> 标签：javascript, cordova, axis, compass-geolocation, heading

我正在与我的团队开发增强现实应用程序。我们决定选择 phonegap 作为将其开发为 webapp 的框架。我们使用 Three.js 框架将增强现实绘制到画布中。

我的问题是根据手机移动使相机旋转工作。我在互联网上搜索了几天，但无法得到它。实际的想法是使用 android SDK 中的 getRotationMatrix() 方法并将其重写为 javascript。但问题是从指南针获取 x、y、z 数据。phonegap 仅以度数 (0 .. 360) 提供相对于地理北极的航向，但 getRotationMatrix() 方法使用 x、y、z 值。

是否可以将轴值折射出航向值或直接获取它们？

你有其他想法来计算所有三个轴上的相机旋转吗？

非常感谢您的任何提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:00:26.290

指南针会给你一个方向，但加速度计会给你设备的 x、y、z 值。请参阅我们文档中的示例：

[http://docs.phonegap.com/en/1.6.1/cordova_accelerometer_accelerometer.md.html#accelerometer.getCurrentAcceleration](http://docs.phonegap.com/en/1.6.1/cordova_accelerometer_accelerometer.md.html#accelerometer.getCurrentAcceleration)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-11T12:09:35.830

您可以使用 html5 **deviceorientation**。效果很好

我添加了一个关于它的教程：http: [//html5rocks.com/en/tutorials/device/orientation](http://html5rocks.com/en/tutorials/device/orientation)

# .htaccess - Htaccess 文件和 url 重写

> ID：10289196
> 
> 赞同：1
> 
> 时间：2012-04-23T22:28:14.140
> 
> 标签：.htaccess, url-rewriting

*我有 2 个问题。*

我目前正在使用 wamp 服务器来服务我的网站。

主页是'localhost/prefix/index.php'

**问题一：**

一个。我想要它，所以我的主页是：

```
'localhost/prefix/' 
```

代替

```
'localhost/prefix/index.php 
```

湾。我想这样：

```
'localhost/prefix/admin/profile.php' 
```

是

```
'localhost/prefix/admin/profile' 
```

我该怎么做（我用谷歌搜索过，我对语法很困惑）？

**问题2**

如果我有一个像

```
'localhost/prefix/games?title=hi' 
```

我怎样才能做到这一点，所以网址是这样的：

```
'localhost/prefix/games/hi' 
```

提前致谢！！我真的迷路了。

已编辑：:///

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php [R] 
```

是我到目前为止所拥有的......它什么都不做......但每个人都说它应该！（htaccess 文件正在做某事，因为如果我随机做某事，它会引发错误）。

已编辑：:///

这似乎从 url 中删除了 .php 和 index.php ：

```
RewriteEngine On
RewriteBase /prefix/

# remove .php; use THE_REQUEST to prevent infinite loops
RewriteCond %{THE_REQUEST} ^GET\ (.*)\.php\ HTTP
RewriteRule (.*)\.php$ $1 [R=301]

# remove index
RewriteRule (.*)/index$ $1/ [R=301]

# remove slash if not directory
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} /$
RewriteRule (.*)/ $1 [R=301]

# add .php to access file, but don't redirect
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteCond %{REQUEST_URI} !/$
RewriteRule (.*) $1\.php [L] 
```

现在的问题是我的前缀基础不起作用所以它最终会

```
localhost/something/something 
```

而不是

```
localhost/prefix/something/something 
```

有任何想法吗？

已编辑：:///

如果我指向的页面位于子文件夹中，我已经发现上面的代码实际上可以完美运行。所以例如..这将起作用：

```
localhost/prefix/admin/dashboard 
```

但是这个（因为文件在根目录中，没有）

```
localhost/prefix/login.php 
```

它把我重定向到

```
localhost/login 
```

有任何想法吗？

编辑：：///

如果您在使其工作时遇到问题。关闭浏览器并重新启动...我遇到了缓存问题。

上面的代码将删除 .php 并删除 index.php。

# c - 如何在 C 中清空二维字符数组？

> ID：10289197
> 
> 赞同：0
> 
> 时间：2012-04-23T22:28:21.020
> 
> 标签：c, arrays, string

我还是 C 的新手，我正在尝试清空 2d 字符数组。这是声明：

```
char arg_array = (char**)calloc(strlen(buf), sizeof (char**));
for(i = 0; i<(strlen(buf)); i++)
{
    arg_array[i] = (char*) calloc (strlen(buf), sizeof(char*));
} 
```

这是我尝试清空它的地方：

```
void make_empty(char **arg_array)
{
     int i;
     for(i = 0; i <= BUFSIZ; i++)
     {
        arg_array[i][0] = '\0';
     }
     return;
} 
```

任何帮助表示赞赏

那么，我做对了吗，因为当我尝试再次将数据添加到数组然后打印它时，这似乎给了我段错误？

空就是让它空——我该如何解释更多？哈哈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:43:08.160

无需清空它。通常在 C 中，内存分配是通过`malloc`它简单地返回给您一个被视为由调用者拥有的内存块完成的。当`calloc`被调用时，以及返回一块内存，内存保证被初始化为 0。这意味着对于所有意图和目的，它已经是“空的”。

此外，我不太确定您的代码是否符合您的预期。让我解释一下它目前的作用：

```
char arg_array = (char**)calloc(strlen(buf), sizeof (char**)); 
```

这条线是完全错误的。在 C 中，不需要转换从返回的指针，`calloc`因为它们是 type `void *`，它被隐式地转换为任何其他指针类型。在这种情况下，您将其存储在`char`没有意义的类型中。如果你这样做：

```
char ** arg_array = calloc(strlen(buf), sizeof (char**)); 
```

`strlen(buf)`然后它分配一个长度指针数组。因此，如果`buf`是，`"hello"`那么您现在已经分配了一个可以存储 5 个指针的数组。

```
for(i = 0; i<(strlen(buf)); i++)
{
  arg_array[i] = calloc (strlen(buf), sizeof(char*));
} 
```

同样，我删除了多余的演员表。这样做是填充之前分配的数组。数组的每个索引现在都指向一个长度`char`字符串。**这可能不是你想要的。**`strlen(buf) * sizeof(char *)`

 *** * *

你的问题现在对我来说更清楚了。您似乎想在填充字符串后删除它们。你可以通过两种方式做到这一点：

*   每个`free`指针都像以前一样稍后分配更多空间
*   或者将每个字符串的第一个字符设置为空字符

释放指针：

```
for(i = 0; i<(strlen(buf)); i++)
{
  free(arg_array[i]);
} 
```

要将每个字符串的第一个字符设置为空字符：

```
for(i = 0; i<(strlen(buf)); i++)
{
  arg_array[i][0] = '\0';
} 
```

这与您最初拥有的代码相同，应该没问题。

* * *

作为证明，以下代码将运行而不会出错：

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main(void)
{
    char *  buf       = "hello";
    char ** arg_array = calloc(strlen(buf), sizeof (char**));
    unsigned int i;

    for(i = 0; i < strlen(buf); i++) {
        arg_array[i] = calloc(strlen(buf),
                sizeof(char *));
    }

    for(i = 0; i < strlen(buf); i++) {
        arg_array[i][0] = '\0';
    }

    for(i = 0; i < strlen(buf); i++) {
        free(arg_array[i]);
    }

    free(arg_array);
    return EXIT_SUCCESS;
} 
```

如果您的代码存在段错误，则问题来自其他地方。您是否覆盖了`arg_array`变量？你确定`BUFSIZE`等于`strlen(buf)`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:51:17.593

尝试这个：

```
void make_empty(char **arg_array, int rows, int cols)
    {
     int i,j;
     for(i = 0; i <rows; i++)
     {
       for(j=0; j<cols;j++)
       {
          arg_array[i][j] = '\0';
       }
     }
    return;
    } 
```

其中 rows 是行数，而 cols 是数组的列数。

PS 这个函数会清除整个数组，就像你应该做的那样。正如我之前评论的那样，将 '\0' 作为字符串中的第一个字符并不会清除整行，它只会使其余部分 ,, 对于 printf 等函数不可见。检查此链接以获取更多信息：[http ://cplusplus.com/reference/clibrary/cstdio/printf/](http://cplusplus.com/reference/clibrary/cstdio/printf/)**

# jboss - 可嵌入的 EJBContainer 和 JBoss 7.1.1.Final

> ID：10289200
> 
> 赞同：1
> 
> 时间：2012-04-23T22:28:34.367
> 
> 标签：jboss, junit, ejb, embeddable

有没有人能够让 EJBContainer.createEJBContainer() 与 JBoss 7.1.1.Final 一起工作？

将以下代码作为 JUnit 测试运行会导致 NullPointerException！

```
public class EJBContainerTest {

private static EJBContainer ejbContainer;
private static Context context;

@BeforeClass
public static void beforeClass() {
    System.setProperty("jboss.home", "/home/usr1/jboss-as-7.1.1.Final");
    ejbContainer = EJBContainer.createEJBContainer();
    context = ejbContainer.getContext();
}

@Test
public void test() {
    Assert.assertNotNull(context);
} 
```

}

堆栈跟踪：

```
java.lang.NullPointerException
    at org.jboss.modules.Module.forClassLoader(Module.java:365)
    at org.jboss.modules.Module.forClassLoader(Module.java:365)
    at org.jboss.modules.Module.forClassLoader(Module.java:365)
    at org.jboss.modules.Module.getContextModuleLoader(Module.java:421)
    at org.jboss.as.embedded.ejb3.JBossStandaloneEJBContainerProvider.createEJBContainer(JBossStandaloneEJBContainerProvider.java:86)
    at javax.ejb.embeddable.EJBContainer.createEJBContainer(EJBContainer.java:93)
    at javax.ejb.embeddable.EJBContainer.createEJBContainer(EJBContainer.java:75)
    at org.arquillian.example.EJBContainerTest.beforeClass(EJBContainerTest.java:18)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-23T10:34:52.777

你必须设置这些文件：default.persistence.properties、ejb3-interceptors-aop.xml、embedded-jboss-beans.xml、jboss-jms-beans.xml、jndi.properties、login-config.xml、security-beans .xml 如果您使用 testNG，您还可以在 src/test/resources 目录中添加 testng.xml

在您的班级中，您必须添加：

```
System.setProperty("org.jboss.as.embedded.ejb3.BARREN", "true");  
System.setProperty("jboss.home", "/home/usr1/jboss-as-7.1.1.Final");  
System.setProperty("jboss.home.dir", "/home/usr1/jboss-as-7.1.1.Final"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T00:07:26.077

在上面的代码中添加 System.setProperty("org.jboss.as.embedded.ejb3.BARREN", "true") 修复了 NPE 问题，嵌入式容器成功启动但无法部署类，并出现以下错误：

```
ERROR [org.jboss.msc.service.fail] (MSC service thread 1-2) MSC00001: Failed to start service jboss.deployment.unit.classes.STRUCTURE: org.jboss.msc.service.StartException in service jboss.deployment.unit.classes.STRUCTURE: Failed to process phase STRUCTURE of deployment "classes"
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:119)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_26]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_26]
    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_26]
Caused by: org.jboss.as.server.deployment.DeploymentUnitProcessingException: Failed to mount deployment content
    at org.jboss.as.server.deployment.module.DeploymentRootMountProcessor.deploy(DeploymentRootMountProcessor.java:91)
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113)
    ... 5 more
Caused by: java.util.zip.ZipException: invalid CEN header (bad signature)
    at java.util.zip.ZipFile.open(Native Method) [rt.jar:1.6.0_26]
    at java.util.zip.ZipFile.<init>(ZipFile.java:127) [rt.jar:1.6.0_26]
    at java.util.jar.JarFile.<init>(JarFile.java:135) [rt.jar:1.6.0_26]
    at java.util.jar.JarFile.<init>(JarFile.java:99) [rt.jar:1.6.0_26]
    at org.jboss.vfs.spi.JavaZipFileSystem.<init>(JavaZipFileSystem.java:97)
    at org.jboss.vfs.spi.JavaZipFileSystem.<init>(JavaZipFileSystem.java:83)
    at org.jboss.vfs.VFS.mountZip(VFS.java:408)
    at org.jboss.vfs.VFS.mountZip(VFS.java:434)
    at org.jboss.as.server.deployment.DeploymentMountProvider$Factory$ServerDeploymentRepositoryImpl.mountDeploymentContent(DeploymentMountProvider.java:95)
    at org.jboss.as.server.deployment.module.DeploymentRootMountProcessor.deploy(DeploymentRootMountProcessor.java:87)
    ... 6 more

16:49:12,128 INFO  [org.jboss.as.server] (pool-9-thread-1) JBAS015870: Deploy of deployment "classes" was rolled back with failure message {"JBAS014671: Failed services" => {"jboss.deployment.unit.classes.STRUCTURE" => "org.jboss.msc.service.StartException in service jboss.deployment.unit.classes.STRUCTURE: Failed to process phase STRUCTURE of deployment \"classes\""}}
16:49:12,129 INFO  [org.jboss.as.controller] (pool-9-thread-1) JBAS014774: Service status report
JBAS014777:   Services which failed to start:      service jboss.deployment.unit.classes.STRUCTURE: org.jboss.msc.service.StartException in service jboss.deployment.unit.classes.STRUCTURE: Failed to process phase STRUCTURE of deployment "classes" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-09T10:31:25.043

JBoss 类 org.jboss.vfs.VirtualJarFileInputStream 中有一个老错误。它不能写入 Zip 文件的有效本地文件头。因此，创建临时 zip 文件的类的部署无法在 JBoss 中工作。

# android - 文件被删除时 FileOutputStream 写入不会引发异常？

> ID：10289202
> 
> 赞同：1
> 
> 时间：2012-04-23T22:28:37.060
> 
> 标签：android, file-io

我用来`FileOutputStream fos`在单独的线程中创建/追加和写入调试文件：

```
 fos = new FileOutputStream(outputFile, true);
    if (!outputFile.exists()) {
    outputFile.createNewFile();
    }
    fos.write(string.getBytes()); 
```

此代码在循环中不断调用，而用户可以随时从另一个线程清除=删除文件以重新开始记录调试输出。

现在我真的很惊讶，当文件被删除时，这段代码会在没有引发任何异常的情况下运行，但没有任何反应。即文件没有被重新创建，也没有任何东西被写入。所有的“写入”都丢失了。

`fos.write`在每次调用之前，我是否真的必须一直手动检查文件是否已被自己删除？

如果异常会像预期的那样工作，即写入已删除的文件时，它会更容易和更清晰。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T22:30:53.833

这完全取决于操作系统。在 Windows 上，您将无法*删除*该文件；但在类 UNIX 系统上，这就是它的工作方式，与编程语言无关。鉴于一个文件可以有多个可以独立删除的链接，您应该理解为什么这种行为是有意义的。事实上，它会导致比删除文件时爆炸更容易和更清洁的行为。

# winforms - Ironpython windows窗体中的ActiveX控件

> ID：10289208
> 
> 赞同：2
> 
> 时间：2012-04-23T22:29:23.830
> 
> 标签：winforms, automation, activex, ironpython

我在使用一组用于实验室仪器自动化的 activeX 控件时遇到了困难。我让它们都可以在 VB 和表单应用程序中工作——因为它们不能在控制台应用程序中工作。我的公司主要使用 python，因此在 python 中编写我们的驱动程序将有很大的优势，主要用于 lims 集成。

因此，我尝试将我的 activeX 控件嵌入到 ironpython windows 窗体中。我尝试了两种不同的方式在表单中引入我的控件：

1) 在原始 ocx 上使用 AxImp 后，使用 clr 引用 Ax dll。然后我将我的控件实例添加为表单控件并尝试从那里运行它。它抛出 System.Windows.Forms.AxHost+InvalidActiveXStateException。

```
import clr
clr.AddReferenceToFileAndPath(r"C:\dlls\AxVCode3Lib.dll")
clr.AddReferenceByPartialName("System.Windows.Forms")

import System.Windows.Forms as Forms
import AxVCode3Lib

class activeXform(Forms.Form):
    def __init__(self):
        a = AxVCode3Lib.AxVCode3()
        self.Controls.Add(a)
        for i in self.Controls:
            r = i.Initialize("serial")
            print r

form = activeXform()
raw_input(">exit") 
```

2) 使用 SystemReflection 和 ProgID，它会抛出一个通用的“异常已被调用的目标抛出”。以下代码是在基本的 ironpython windows 窗体中引入的，但是我无法将这些对象添加为窗体控件。

```
import System.Type
import System.Reflection
import System.Array

oType = System.Type.GetTypeFromProgID("VCODE3.VCode3Ctrl.1")
o = System.Activator.CreateInstance(oType)
args = System.Array[str](['serial'])

try:
    r = oType.InvokeMember("Initialize", System.Reflection.BindingFlags.InvokeMethod, None, o, args)
    print r
except Exception as e:
    print e 
```

现在我怀疑这两个例子都失败了，因为我的表单中缺少一些属性。但是我无法弄清楚它是什么，特别是在实例 1 实际添加为控件时，我似乎非常接近。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:06:11.437

在创建本机句柄之前，您不能使用 ActiveX 控件的方法。换句话说，直到您调用表单的 Show() 方法之后。

确保您获得正确的 Winforms 应用程序的基本轮廓，查看示例 C# Winforms 应用程序的 Program.cs 源代码文件。Application.Run() 调用是必不可少的。使用窗体的 Load 事件（或覆盖 OnLoad）作为您可以实际开始使用控件的第一个事件。

# android - FragmentPagerAdapter - 防止自动创建下一个选项卡？

> ID：10289209
> 
> 赞同：0
> 
> 时间：2012-04-23T22:29:30.110
> 
> 标签：android

我正在使用带有选项卡式界面的 FragmentPagerAdapter。我的界面恰好有三个选项卡。我可以看到，一旦创建了我的应用程序，适配器就会要求立即创建标签一和标签二（我认为这样滑动到下一个标签对用户来说很流畅）。

有没有办法停止自动加载下一个选项卡？我的标签很重，在启动时加载两个需要大量时间，

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:41:57.100

> 有没有办法停止自动加载下一个选项卡？

抱歉，没有。这是由 驱动的`setOffscreenPageLimit()`，最小值为 1，这意味着`ViewPager`将始终尝试在每一侧创建并保留至少 1 个页面。

听起来您需要将更多逻辑移动到后台线程中。

# javascript - 需要从 iframe 中获取 height 属性值并设置父元素以包含它

> ID：10289211
> 
> 赞同：2
> 
> 时间：2012-04-23T22:29:48.577
> 
> 标签：javascript, jquery, iframe

我将在以后收到一些动态生成的 iframe 内容，并尝试创建一个无论高度如何都能舒适地适应 iframe 的模板。所以我想写一个 jquery 脚本来读取 iframe 中的 height 属性的值，这样我就可以将父元素设置为相应的大小。

我不确定如何访问 iframe 中的 height 属性......我假设最简单的方法是从父元素运行脚本以获取 iframe 高度，然后设置它自己的高度。我也希望 iframe 是同一个域，所以这不会是一个问题。

```
<div class="parent_element" style="">
<!-- .parent_element {height: } should be set to 400px -->
<iframe src="" height="400"></iframe>
</div 
```

谁能指出我正确的方向？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-09T14:51:35.377

当 iframe src 加载时，调整 iframe 高度以匹配文档（加上一点滚动条）。

```
$(document).ready( function () {
  $('iframe').load( function() {
    //console.log($(this).contents().height() + ' is the height');
    $(this).height($(this).contents().height() + 25); // add some to the height to allow for horizontal scroll bars
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:34:15.333

```
$("#parent_element").height($("iframe").height()); 
```

或者：

```
$("#parent_element").height($("iframe").attr("height")); 
```

# php - 将 php4 date() 转换为 php5 date_format()

> ID：10289214
> 
> 赞同：1
> 
> 时间：2012-04-23T22:30:03.477
> 
> 标签：php, date

我有以下代码：

```
$date = mktime(12, 0, 0, $month, 1, $year); // 1st day of month as unix stamp
for( $day = 1; $day <= date("t", $date); $day++ ) {
     //...
} 
```

执行时会产生以下通知：

> 注意：在第 53 行的 /home2/wordprh4/public_html/contenido/themes/bam/events/table-mini.php 中遇到了格式不正确的数值

我想`date();`使用 php5 date_format() 进行转换，但我遇到了一些问题......

这样做的正确方法是什么？

* * *

仅供参考，第 53 行是

```
for( $day = 1; $day <= date("t", $date); $day++ ) { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T23:40:14.937

我认为没有必要这样做，但是您可以像这样使用 date_format()

```
$date = date_create('2012-02-01'); //First you have to create the date
echo date_format($date, 'Y-m-d H:i:s'); //Next simply pass the needed format 
```

# c++ - 如何在 Windows 服务应用程序中启动系统时运行代码？

> ID：10289232
> 
> 赞同：0
> 
> 时间：2012-04-23T22:31:53.463
> 
> 标签：c++, winapi, service, boot

我有一个本地系统服务应用程序，用 C++/MFC 编写，旨在在 Windows 操作系统上运行。系统刚启动时，我需要在此服务中运行代码。我最初的想法是从 ServiceMain() 替代函数的开头运行它，该函数由对 StartServiceCtrlDispatcher() API 的调用定义，但问题是如果我停止然后重新启动该服务，它也会运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:31:24.110

听起来你不需要服务。您可以对计划任务执行相同的操作。您可以使用`taskschd.msc`触发器创建任务以在系统启动时或从命令行启动任务：

```
schtasks.exe /Create /SC ONSTART /TN MyTaskName /TR c:\Path_to_my_tool\my_executable.exe 
```

# ruby-on-rails - Rails + jQuery ajaxPrefilter

> ID：10289235
> 
> 赞同：2
> 
> 时间：2012-04-23T22:32:14.497
> 
> 标签：ruby-on-rails, ajax, jquery, ruby-on-rails-3.1

我有一个 Rails 3.1 应用程序

在我的宝石文件中：

```
gem 'jquery-rails', '>= 1.0.12' 
```

在我的 assets/application.js 中，我有：

```
//= require jquery
//= require jquery_ujs
//= require_tree . 
```

在我的 application.html 布局中，我包含了这些行

```
<%= javascript_include_tag "application" %>
<%= javascript_include_tag "jquery.min" %> 
```

我正在使用 jQuery v1.6.2。

问题是，当我尝试访问任何页面时，我不断在控制台中收到这些错误：

```
Uncaught TypeError: Object function (selector,context){return new jQuery.prototype.init(selector,context);} has no method 'ajaxPrefilter' (:3000/assets/jquery_ujs.js?body=1:290)

Uncaught TypeError: Cannot read property 'setOffset' of undefined (:3000/assets/jquery-ui-1.8.18.custom.min.js?body=1:37)

Uncaught TypeError: Object function (a,b){return new jQuery.prototype.init(a,b)} has no method 'ajaxPrefilter'  (application.js:12) 
```

什么是 ajaxPrefilter，如何修复这些错误？

我尝试在 application.js 之前加载 jquery.min.js 来重新排序 javascript，但运气不好，而且我不确定如何检查 js 文件本身中的这些错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T08:03:45.017

尝试这个：

```
<%= javascript_include_tag "application" %>
<%= javascript_include_tag "http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" %>
<%= javascript_include_tag "http://code.jquery.com/ui/1.8.19/jquery-ui.min.js" %> 
```

# c++ - 从 C++ 方法返回的对象分配新对象

> ID：10289239
> 
> 赞同：1
> 
> 时间：2012-04-23T22:32:53.650
> 
> 标签：c++, class, object, return, overloading

我已经重载了“+”运算符，所以当我制作 class1 + class1 = class2 时。唯一的问题是当我将它传递给另一个对象时。

“+”运算符已经重载，因此当您创建 class2 + class1 时，它会将 class1 对象添加到 class2 对象。

这是示例：

```
 #include<iostream.h>

class Figura {
    public: 
        int x, y, poz;
        int tip; //1 = punct ; 2 = dreapta; 3 = dreptunghi
        Figura() { };
        Figura(const Figura&) { };
};

class Grup {
    private:
        int nr_elemente;
        Figura **figuri;
    public:
        int i;
        Grup(int nr_el) {
            nr_elemente = nr_el;
            figuri = new Figura*[nr_elemente];
            i = 0;
        }
        Grup() {
            nr_elemente = 100;
            figuri = new Figura*[nr_elemente];
            i = 0;
        }

        ~Grup() { /*delete[] figuri;*/ };

        Grup(const Grup&) { };

        Grup& operator=(const Grup&) {
            return *this;
        }

        int _nr_elemente() {
            return i;
        }

        void afiseaza_elemente() {
            for(int j = 0; j < i; j++)
                cout<<"Figura nr:"<<j<<" tip :"<<figuri[j]->tip<<" x:"<<figuri[j]->x<<" y:"<<figuri[j]->y<<" poz:"<<figuri[j]->poz<<endl;
        }
    friend Grup operator+(const Figura& fig1, const Figura& fig2) {
        Grup grt;
        grt + fig1;
        grt + fig2;
        cout<<grt.i<<endl; // current number of elements begining with 0, so it should print 1 (fig1 and fig2)
        grt.afiseaza_elemente(); // prints the elements attributes
        return grt;
    };

    friend Grup operator+(const Grup& gr1, const Grup& gr2) {};
    void operator+(const Figura& fig);

};

void Grup::operator+(const Figura& fig) {
    Grup::figuri[Grup::i] = new Figura;
    Grup::figuri[Grup::i]->tip = fig.tip;
    Grup::figuri[Grup::i]->poz = fig.poz;
    if(fig.tip == 2) {
        Grup::figuri[Grup::i]->x = fig.x;
        Grup::figuri[Grup::i]->y = 0;
    } else if(fig.tip == 3) {
        Grup::figuri[Grup::i]->x = fig.x;
        Grup::figuri[Grup::i]->y = fig.y;
    }
    else {
        Grup::figuri[Grup::i]->x = 0;
        Grup::figuri[Grup::i]->y = 0;
    }
    Grup::i++;
}

class Punct : public Figura
{
    public: 
        Punct(int poz) {
            Punct::tip = 1;
            Punct::poz = poz;
        }
};

class Segment : public Figura
{
    public:
        Segment(int poz, int x) {
            Segment::tip = 2;
            Segment::poz = poz;
            Segment::x = x;
        }
};

class Dreptunghi : public Figura
{
    public:
        Dreptunghi(int poz, int x, int y) {
            Dreptunghi::tip = 3;
            Dreptunghi::poz = poz;
            Dreptunghi::x = x;
            Dreptunghi::y = y;
        }
};

void main(void) {

    Grup gr(10);
    Punct pct(1);
    Segment sgm(3, 5);

    gr + pct;
    gr + sgm;

    Grup gr2 = pct + sgm;
    cout<<"--------------------------"<<endl;
    cout<<gr2.i<<endl; // prints a weird number
    gr2.afiseaza_elemente(); // prints the elemenets atributes, but because gr2.i is negative shows nothing

} 
```

# iphone - 需要记录局部变量的存储类型

> ID：10289240
> 
> 赞同：0
> 
> 时间：2012-04-23T22:32:54.430
> 
> 标签：iphone, objective-c, ios, asihttprequest, objective-c-blocks

简而言之，我需要知道我是否能够记录变量的存储类型。

具体来说，我想记录一个变量是否`__block`应用了存储类型修饰符。

理想情况下，我正在寻找类似的东西：

```
NSLog(@"storage type: %@", [localVar storageType]); 
```

如果您想知道，我想我刚刚发现了过去几天一直在调试的内存泄漏，我想测试我的假设是否正确。

我将 ASIHttpRequest 与`setCompletionBlock`and一起使用`setFailedBlock`，但我将我的请求对象传递给一个方便的方法，该方法执行块的实际设置，如下所示：

```
- (void)getAllHighlights:success:(ASIBasicBlockWrapper)cb1 fail:(ASIBasicBlockWrapperFail)cb2{

    // blah blah blah

    __block ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
    [request setRequestMethod:@"GET"];
    [request setDelegate:self];

    [self executeAsynchronousRequest:request onSuccess:cb1 onFail:cb2];
} 
```

然后，`executeAsynchronousRequest`设置块并启动请求：

```
- (void) executeAsynchronousRequest:(ASIFormDataRequest *)request onSuccess:(ASIBasicBlockWrapper)cb1 onFail:(ASIBasicBlockWrapperFail)cb2
{
    [request setCompletionBlock:^{
        int statusCode = [safeRequest responseStatusCode];
        NSString *statusMessage = [self statusErrorMessage:statusCode];
        cb1([safeRequest responseString],statusMessage);
    }];
    [request setFailedBlock:^{
        cb2(safeRequest);
    }];

    [request startAsynchronous];    
} 
```

我的直觉告诉我，即使我将请求对象设置为`__block ASIFormDataRequest *request`，当它在 内使用时`executeAsynchronousRequest`，它也丢失了 __block 存储类型，因为它只被键入为`(ASIFormDataRequest *)request`.

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:51:08.620

你没有`request`在一个块中修改，所以`__block`不会为你做任何事情......如果你将请求传递给一个块，它不会被复制，它会在你传递它时保留本地范围的版本进入区块。

# python - 相互依赖的一对多关系 SQLAlchemy

> ID：10289242
> 
> 赞同：2
> 
> 时间：2012-04-23T22:33:08.560
> 
> 标签：python, database, database-design, sqlalchemy

我试图让以下模型一起工作。首先，场景如下：

1.  一个用户可以有多个邮箱，但每个邮箱只能关联一个用户；
2.  每个用户只能有一个*主电子邮件地址*（将其视为他们当前的电子邮件地址）。

电子邮件地址是用户的 ID，因此他们必须始终拥有一个，但是当他们更改它时，我想跟踪他们过去使用过的其他地址。到目前为止，设置是有一个帮助表`user_emails`，它在电子邮件和用户之间建立联系，我听说在使用声明性 SQLAlchemy 方法时不应该将其设置为一个类（尽管我不知道为什么）。另外，我是否正确地认为我需要使用`use_alter=True`，因为`users`表在插入之前不会知道外键`email_id`？

`models.py`看起来像这样：

```
"""models.py"""
user_emails = Table('user_emails', Base.metadata,
                Column('user_id', Integer, ForeignKey('users.id'),
                       primary_key=True),
                Column('email', String(50), ForeignKey('emails.address'),
                       primary_key=True))

class User(Base):
    __tablename__ = 'users'
    id = Column(Integer, Sequence('usr_id_seq', start=100, increment=1), 
                primary_key=True)
    email_id = Column(String(50),
                      ForeignKey('emails.address', use_alter=True, name='fk_email_id'),              
                      unique=True, nullable=False)
    first = Column(String(25), unique=True, nullable=False)
    last = Column(String(25), unique=True, nullable=False)

    def __init__(self, first, last):
        self.first = first
        self.last = last

class Email(Base):
    __tablename__ = 'emails'
    address = Column(String(50), unique=True, primary_key=True)
    user = relationship(User, secondary=user_emails, backref='emails')
    added = Column(DateTime, nullable=False)
    verified = Column(Boolean, nullable=False)

    def __init__(self, address, added, verified=False):
        self.address = address
        self.added = added
        self.verified = verified 
```

在我尝试提交数据库之前，一切似乎都很好：

```
>>> user = models.User("first", "last")
>>> addy = models.Email("example@example.com", datetime.datetime.utcnow())
>>> addy
<Email 'example@example.com' (verified: False)>
>>> user
>>> <User None (active: True)>
>>>
>>> user.email_id = addy
>>> user
>>> <User <Email 'example@example.com' (verified: False)> (active: True)>
>>> Session.add_all([user, addy])
>>> Session.commit()
>>> ...
>>> sqlalchemy.exc.ProgrammingError: (ProgrammingError) can't adapt type 'Email' "INSERT INTO users (id, email_id, first, last, active) VALUES (nextval('usr_id_seq'), %(email_id)s, %(first)s, %(last)s, %(active)s) RETURNING users.id" {'last': 'last', 'email_id': <Email 'example@example.com' (verified: False)>, 'active': True, 'first': 'first'} 
```

所以，我认为我做错了/愚蠢，但我是 SQLAlchemy 的新手，所以我不确定我需要做什么才能正确设置模型。

最后，假设我设置了正确的模型，是否可以添加关系，以便通过加载任意电子邮件对象，我将能够从电子邮件对象中的属性访问拥有它的用户？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T06:59:32.627

你已经有了一个很好的解决方案，一个小的修复将使你的代码工作。在下面找到有关您的代码的快速反馈：

*   **你需要`use_alter=True`吗？不**，你实际上不需要那个。如果表`primary_key`的`Email`是在数据库级别计算的（与`autoincrement`基于 - 的主键一样），那么当您有两个`foreign_keys`相互连接的表时可能需要它。在您的情况下，您甚至没有那个，因为您有第三个表，因此对于任何关系组合，`SA (sqlalchemy)`将通过插入新的电子邮件、然后是用户、然后是关系来解决。
*   **你的代码有什么问题？**：好吧，您正在分配一个实例，该实例`Email`应该`User.email_id`只获取该`email`值。有两种方法可以解决它：
    1.  直接分配电子邮件。所以将行更改`user.email_id = addy`为`user.email_id = addy.address`
    2.  创建一个`relationship`然后进行分配（参见下面的代码）。就个人而言，我更喜欢选项2。
*   `User.email_id`其他事情：您当前的模型不会检查`User.emails`. 这可能是设计使然，否则只需添加一个`ForeignKey`from`[users.id, users.email_id] to [user_emails.user_id, user_emails.email]`

版本 2 的示例代码：

```
""" models.py """
class User(Base):
    __tablename__ = 'users'
    # ...
    email_id = Column(String(50),
                      ForeignKey('emails.address', use_alter=True,
                                 name='fk_email_id'), unique=True,
                      nullable=False)
    default_email = relationship("Email", backref="default_for_user")

""" script """
# ... (all that you have below until next line)
# user.email_id = addy.address
user.default_email = addy 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T23:27:04.743

我对 Python/SQLAlchemy 不熟悉，但这里有一种方法可以在数据库中表示您想要的内容：

![在此处输入图像描述](../Images/cbf9c13835a8a5ba7ddbfc369ce08d5b.png)

您可以使用延迟约束（如果您的 DBMS 支持它们），或者让 USER.PRIMARY_EMAIL 为空（如上面的模型所示）来中断数据修改周期。

* * *

或者，您可以执行以下操作：

![在此处输入图像描述](../Images/a6902c3d8a6f5f0d0ce23b0a49972315.png)

属于同一用户的电子邮件是有序的（注意备用键：{USER_ID, ORDER}），并且在该排序之上的任何电子邮件都可以被认为是“主要的”。这种方法的好处是它完全避免了循环引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T15:52:58.107

[http://docs.sqlalchemy.org/en/latest/orm/tutorial.html](http://docs.sqlalchemy.org/en/latest/orm/tutorial.html)中的示例与您想要的很接近。除非我需要多对多关系，否则我从不使用像您的 user_emails 这样的中间连接表。用户到电子邮件应该是一对多的。

您需要跟踪旧的电子邮件地址吗？将“过时”布尔属性添加到您的电子邮件类并对其进行过滤以显示当前或旧电子邮件地址。

# javascript - 谷歌地图的表格

> ID：10289244
> 
> 赞同：0
> 
> 时间：2012-04-23T22:33:18.253
> 
> 标签：javascript, jquery, google-maps, map, google-maps-api-3

我正在尝试为我的表单添加谷歌地图，因此在他们输入地址后，他们可以查看地图，然后将地图纬度和经度提交到数据库。到目前为止，我无法实现它。我在 jsfiddle 上试了一下，效果很好。但是当我尝试添加到页面时它不起作用。 [http://jsfiddle.net/pborreli/pJgyu/](http://jsfiddle.net/pborreli/pJgyu/)

这是完整的页面。

```
<!DOCTYPE html>
<htmllang-"en">
<head>
<meta charset="utf-8">
<title>My First Guide</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">

<!-- Le styles -->
<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.min.css" rel="stylesheet">
<link href="css/prettify.css" rel="stylesheet">
<!--<link href="css/docs.css" rel="stylesheet">-->
<script src="js/bootstrap.min.js" type="text/javascript"></script>
<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }  
</style>

<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">
$("#address").change(function() {
      var geocoder = new google.maps.Geocoder();
        var add = $("#address").val();
        geocoder.geocode( { 'address': add}, function(results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
        var latitude = results[0].geometry.location.lat();
        var longitude = results[0].geometry.location.lng();
        var map;
        function initialize() {
            var myOptions = {
              zoom: 8,
              center: new google.maps.LatLng(latitude, longitude),
              mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById('map'),
                myOptions);
          }

          google.maps.event.addDomListener(window, 'load', initialize);
    }; 
    });​
</script>
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<body>
  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
        <a class="brand" href="#">My First Guide</a>
        <div class="nav-collapse">
          <ul class="nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">Write a review</a></li>
            <li><a href="#contact">Talk</a></li>
            <li><a href="#contact">Events</a></li>
            <li>
                <form class="navbar-search pull-left">
                    <!--You can put class="search-query" too.-->
                    <input type="text" class=".navbar-search" placeholder="Search">
                </form>
            </li> 
          </ul>
        </div><!--/.nav-collapse -->
      </div><!-- div container -->
    </div><!-- div navbar-inner -->
  </div><!-- navbar navbar-fixed-top -->

<div class="container">
    <form class="form-horizontal">
        <fieldset>
            <legend>Submit Business Place</legend>
            <div class="control-group">
                <label class="control-label" for="input01">Business Name</label>
                <div class="controls">
                    <input type="text" class="input-xlarge" id="input01">
                    <p class="help-block">Please specify the name of business.(May
                        be it is a brand name)</p><br />
                </div>

                <div class="control-group">
                    <label class="control-label" for="input01">Address</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="ad">
                        <p class="help-block">To use lines please specify
                            &lsaquo;br/&rsaquo; tag.</p><br/>
                            <div id="map"></div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for="textarea">Description</label>
                        <div class="controls">
                            <textarea class="input-xlarge" id="textarea" rows="10"></textarea>
                        </div>

                    </div>

                    <label class="control-label" for="input01">Categories</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="input01">
                        <p class="help-block">Use comma as a separator.</p><br />
                    </div>

        </fieldset>
    </form>

</div>

<script src="js/jquery.js"></script>
<script src="js/bootstrap-transition.js"></script>
<script src="js/bootstrap-alert.js"></script>
<script src="js/bootstrap-modal.js"></script>
<script src="js/bootstrap-dropdown.js"></script>
<script src="js/bootstrap-scrollspy.js"></script>
<script src="js/bootstrap-tab.js"></script>
<script src="js/bootstrap-tooltip.js"></script>
<script src="js/bootstrap-popover.js"></script>
<script src="js/bootstrap-button.js"></script>
<script src="js/bootstrap-collapse.js"></script>
<script src="js/bootstrap-carousel.js"></script>
<script src="js/bootstrap-typeahead.js"></script>

</body>
</html> 
```

但这里是 javascript 的东西。

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">    </script>
<script type="text/javascript">
$("#address").change(function() {
  var geocoder = new google.maps.Geocoder();
    var add = $("#address").val();
    geocoder.geocode( { 'address': add}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
    var latitude = results[0].geometry.location.lat();
    var longitude = results[0].geometry.location.lng();
    var map;
    function initialize() {
        var myOptions = {
          zoom: 8,
          center: new google.maps.LatLng(latitude, longitude),
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById('map'),
            myOptions);
      }

      google.maps.event.addDomListener(window, 'load', initialize);
}; 
});​
</script> 
```

这是我添加地图的 div。

```
<div class="control-group">
                    <label class="control-label" for="input01">Address</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="ad">
                        <p class="help-block">To use lines please specify
                            &lsaquo;br/&rsaquo; tag.</p><br/>
                            <div id="map"></div>
                    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T02:49:46.857

我已经快速扫描了您的代码，似乎存在一些基本的编码问题：

1.  您似乎是在初始化函数中创建地图，但您的初始化函数似乎嵌入在更大的 .change() 回调函数中；我看不到您的地图将如何显示。
2.  您的 JavaScript 代码专注于 jQuery 搜索具有 id: ***address***的元素，但在您的标记中似乎没有具有该 id 的元素。
3.  您定义的包含文本*Address*的标签表示它是一个标签：**input01**，但您的标记中有 2 个不同的元素被分配了 id: **input01**。
4.  有多个标签被标记为：**input01**的标签。
5.  您在文件底部定义的所有脚本标记都缺少**type**属性。

我认为您的基本编码错误太多，看起来您在提交审核过程中可能会出现乱码？很难说，但我希望我的反馈对您有所帮助，并能帮助您更接近您的目标。

# sql-server - 在 SQL Server 2008 中，如何通过 Telnet 连接创建和发送/接收数据？

> ID：10289246
> 
> 赞同：2
> 
> 时间：2012-04-23T22:33:30.703
> 
> 标签：sql-server, sql-server-2008, telnet

我有一个 Dataman 高速 ID 扫描仪，我需要与 SQL Server 2008 数据库进行通信。它有几种不同的通信方式，但唯一不是工业协议的方式是 Telnet。如何让数据库通过 Telnet 与扫描仪通信？

如果您对如何与它交流有任何其他建议，我也很想听听。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:37:53.000

您将需要编写一个使用 Telnet 与扫描仪对话的应用程序，然后可以相应地从数据库中读取/写入。

例如，您可以用 C# 编写一些东西（使用 Visual Studio）并使用以下库进行 Telnet 访问：

[http://www.codeproject.com/Articles/19071/Quick-tool-A-minimalistic-Telnet-library](http://www.codeproject.com/Articles/19071/Quick-tool-A-minimalistic-Telnet-library)

如果你真的，真的必须让数据库来执行代码，那么你可以用 C# 编写一些东西，然后使用SQL Server 2008 中的[CLR 集成](http://msdn.microsoft.com/en-us/library/ms254498.aspx)来获取这些东西。但我建议将你的应用程序与数据库分开（为了便于开发和测试目的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T17:58:21.167

[您可以在SQLCLR 存储过程](http://msdn.microsoft.com/en-us/library/ms190790%28v=SQL.105%29.aspx)中创建 telnet 客户端，然后从常规 TSQL 存储过程调用 CLR 过程。SQLCLR 不是很常用，但它比许多人想象的更健壮，而且我已经与在它方面取得成功的团队进行了交谈。

要记住的一件事是，如果您采用 SQLCLR 路线，您将编写与您决定采纳其他答案的建议并实施外部实用程序时所编写的相同的 .NET 代码将数据推送到 SQL 服务器。唯一的区别是使用 SQLCLR 存储过程可以主动触发 telnet 交互。

SQLCLR 存储过程需要一些特殊的技术，但是 Visual Studio 数据库项目可以很容易地创建一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T17:19:16.607

好吧，SQL Server 本身无法做到这一点，所以无论如何你都必须走出你的舒适区。另外，“在服务器上”是指在运行 SQL Server 的同一物理服务器上，还是指“在 SQL Server 实例内部”？

您当然可以从存储过程内部调用本地 PowerShell 脚本[`xp_cmdshell`](http://msdn.microsoft.com/en-us/library/ms175046.aspx)，或者如果您需要它是异步的（并且如果您没有运行没有代理的 Express Edition），则作为 SQL Server 代理作业步骤的一部分。这是一个 PowerShell 脚本，不需要最终掌握 PowerShell 即可适应您的需求：

[使用 PowerShell 自动化 Telnet](https://stackoverflow.com/questions/2634017/automating-telnet-with-powershell)

为了从存储过程中调用它，您首先需要确保它`xp_cmdshell`已启用：

```
EXEC sp_configure 'show advanced options', 1;
RECONFIGURE WITH OVERRIDE;
GO
EXEC sp_configure 'xp_cmdshell', 1;
EXEC sp_configure 'show advanced options', 0;
RECONFIGURE WITH OVERRIDE;
GO 
```

作为警告，很多人认为暴露`xp_cmdshell`是一种类似禽流感的流行病。对我来说，这一切都是关于控制对机器的访问，而不是控制机器可以做什么和不能做什么来满足您的业务需求。

以下是使用您发送到的任何内容的输出的快速示例`xp_cmdhsell`。这只是一个标准的命令行调用，因此您必须对其进行调整以调用 PowerShell 脚本，但它的工作原理应该大致相同：

```
CREATE TABLE #tmp(i INT IDENTITY(1,1), x VARCHAR(2048));
INSERT #tmp(x) EXEC master..xp_cmdshell 'dir C:\Users\';
SELECT x FROM #tmp ORDER BY i;
DROP TABLE #tmp; 
```

结果：

```
 Volume in drive C has no label.
 Volume Serial Number is 50D3-008B
NULL
 Directory of C:\Users
NULL
01/10/2012  09:20 AM    <DIR>          .
01/10/2012  09:20 AM    <DIR>          ..
01/19/2011  11:54 PM             1,444 SomeFile.txt
.... other files...
               3 File(s)       28,918,500 bytes
              18 Dir(s)    19,367,292,416 bytes free
NULL 
```

但是一旦你花了一个多小时搞砸它来让它工作，我认为你最好编写一个作为服务或间隔运行的应用程序，检查队列表以获取新的 telnet 处理以, 完成工作，然后将结果写入 SQL Server。您的 RDBMS 不应被视为批处理脚本主机恕我直言。

# php - mySQL - 增加页面浏览量的更快方法？

> ID：10289248
> 
> 赞同：1
> 
> 时间：2012-04-23T22:33:40.210
> 
> 标签：php, mysql, pdo

目前我使用`UPDATE pages SET hits = hits+1 WHERE id=:id`PDO 来增加页面点击量，但在分析脚本时，它平均需要 30 毫秒到 65 毫秒来更新。

是否有更快的增量方法，`hits`也是表中的一个索引：这是一个示例转储：

```
[queries] => Array
(
 [0] => Array
   (
    [sql] => SELECT * FROM `settings`
    [time] => 0.22602081298828
   )

 [1] => Array
    (
    [sql] => SELECT * FROM `menu_links` WHERE `active`="1" ORDER BY position ASC
    [time] => 0.2291202545166
    )

 [2] => Array
    (
    [sql] => SELECT * FROM `pages` WHERE `url`=:field AND active='1'
    [time] => 0.27203559875488
    )

 [3] => Array
   (
    [sql] => SELECT * FROM `pages` WHERE `menu_link`=:field AND active='1'
    [time] => 0.24008750915527
   )

 [4] => Array
  (
   [sql] => UPDATE pages SET hits = hits+1 WHERE id=:id
   [time] => 31.989107131958
  )
) 
```

**更新**

似乎使用 LIMIT 1 子句加快了 10-15 毫秒

```
[4] => Array
  (
   [sql] => UPDATE `pages` SET hits = hits+1 WHERE id=1 LIMIT 1
   [time] => Between 15 & 25ms
  ) 
```

使用 LOW_PRIORITY

```
[4] => Array
  (
   [sql] => UPDATE LOW_PRIORITY `pages` SET hits = hits+1 WHERE id=1 LIMIT 1
   [time] => Between 17 & 30ms
  ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:47:16.633

列上的索引实际上会使列**更新速度变慢**，因为索引也需要修改。

使用纯 MySQL，除了调整服务器设置外，您无能为力：在临时内存中保存更多操作，减少写入磁盘的频率。但是，服务器仍然需要将操作记录到一个日志文件中。ACID 并不便宜。

因此，大多数服务器使用另一种临时存储，例如 memcached 或其他东西。这样，这些值就存储在 RAM 中，只有当值达到某个阈值时，才会将其写入数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:36:35.420

这是最好的方法。

显然更新比选择花费更多时间，因为它意味着存储修改，而选择通常使用各种缓存和缓冲区。

如果速度对您非常重要 - 您可以设置任何队列软件并将递增任务添加到队列并由一些后台工作人员以批量方式刷新数据。此解决方案会更有效，但仅适用于您不需要立即提供更改的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T22:40:58.943

一般来说，更新比读取慢得多。鉴于它`id`已编入索引并且您正在使用的数据集很大，因此您无能为力。以下页面描述了可以提高性能或添加 LIMIT 子句的方法。

> 获得快速更新的另一种方法是延迟更新，然后在以后连续进行多次更新。如果锁定表，一起执行多个更新比一次执行一个要快得多。

[http://dev.mysql.com/doc/refman/5.0/en/update-speed.html](http://dev.mysql.com/doc/refman/5.0/en/update-speed.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T23:08:42.370

如果您只是在减少页面加载时间并且您的服务器使用 php-fpm/FastCGI 设置后，您可以调用 fastcgi_finish_request() ，然后更新命中计数器，请参阅[http://php-fpm.org/wiki/Features #fastcgi_finish_request.28.29](http://php-fpm.org/wiki/Features#fastcgi_finish_request.28.29)

基本上这会将输出刷新到客户端并关闭连接，然后继续执行 PHP 脚本，因此客户端不必等待计数器更新操作。但是，这不会减轻服务器的负担，只是减轻客户端的访问时间...

# javascript - 通过原型将计算的 observable 添加到构造函数

> ID：10289251
> 
> 赞同：7
> 
> 时间：2012-04-23T22:34:35.780
> 
> 标签：javascript, knockout.js

我正在使用 Knockout.js 2.0，我正在尝试通过添加计算的 observable 来扩展我创建的构造函数的原型，但它会抛出“self.IsSubDomain 不是函数”。我该如何解决这个错误？是否有另一种方法来扩展构造函数来解决这个问题？

[http://jsfiddle.net/StrandedPirate/J44S4/3/](http://jsfiddle.net/StrandedPirate/J44S4/3/)

注意：我知道我可以在构造函数的闭包中定义计算出的 observable，但是我正在为淘汰视图模型构建一个自动代码生成器，并且我需要能够通过原型属性扩展我的对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T02:22:02.017

我也在[论坛里回答了这个问题](http://groups.google.com/group/knockoutjs/msg/38d064334060b276)。

这是一种方法（[jsFiddle 示例](http://jsfiddle.net/mbest/J44S4/29/)）：

```
<div data-bind="text: fullDomainName">test</div>
<script>
function SiteModel(rootUrl, data) {
    var self = this;
    self.rootUrl = rootUrl;
    self.DomainName = ko.observable(data.DomainName);
    self.IsSubDomain = ko.observable(data.IsSubDomain);
    self.fullDomainName = ko.computed(self.fullDomainName, self);
}

SiteModel.prototype.fullDomainName = function () {
    if (this.IsSubDomain() && this.DomainName()) { // bombs out here with "self.IsSubDomain is not a function"
        return this.DomainName() + ".myCompanyWebsite.com";
    }
    else {
        return this.DomainName();
   }
}; 

var temp = new SiteModel("someurl", { DomainName: "extraCool" });

ko.applyBindings(temp);
</script> 
```

我已经在原型中定义了函数，并在构造函数中将其作为计算的 observable。

这是一种更通用的方法（[jsFiddle示例](http://jsfiddle.net/mbest/XEez7/)）：

```
<div data-bind="text: fullDomainName">test</div>
<script>
Function.prototype.computed = function() {
    this.isComputed = true;
    return this;
};
Object.prototype.makeComputeds = function() {
    for (var prop in this) {
        if (this[prop] && this[prop].isComputed) {
            this[prop] = ko.computed(this[prop], this, {deferEvaluation:true});
        }
    }
};

function SiteModel(rootUrl, data) {
    var self = this;
    self.rootUrl = rootUrl;
    self.DomainName = ko.observable(data.DomainName);
    self.IsSubDomain = ko.observable(data.IsSubDomain);
    self.makeComputeds();
}

SiteModel.prototype.fullDomainName = function () {
    if (this.IsSubDomain() && this.DomainName()) { // bombs out here with "self.IsSubDomain is not a function"
        return this.DomainName() + ".myCompanyWebsite.com";
    }
    else {
        return this.DomainName();
   }
}.computed();

var temp = new SiteModel("someurl", { DomainName: "extraCool" });

ko.applyBindings(temp);
</script> 
```

计算的底层读取函数*将*通过原型共享，尽管实际的计算属性不会。我想如果您创建了一些对象然后更改了原型中的函数，可能会造成混淆。新对象会使用新功能，但旧对象不会。

由于计算出的 observables 是属性，因此您不应该期望能够通过原型将它们添加到现有对象中。

# ipad - 缩放整个 div/站点以适应 webkit 的屏幕

> ID：10289252
> 
> 赞同：0
> 
> 时间：2012-04-23T22:34:44.830
> 
> 标签：ipad, css, mobile-safari, mobile-webkit

我有这种情况： http: [//jsfiddle.net/neko/CTA4C/7/](http://jsfiddle.net/neko/CTA4C/7/)（图片仅供参考）

HTML：

```
<div id="container">
    <div id="lady">
        <img src="http://a2.twimg.com/profile_images/1120515410/ladybird__1__normal.jpg">Click me!</img>
    </div>
    <div id="containerbg"><img id="BG" src="http://www.bigpicture.in/wp-content/uploads/2011/01/LandscapePhotographsOfBeautifulRoads4_004.jpg"></img></div>

</div> 
```

jQuery：

```
$("#lady").click(function(){
    $(this).addClass("animlady");
    }); 
```

CSS：

```
@-webkit-keyframes ladymove{
    0% {-webkit-transform: translate(0px, 0px);}
    50% {-webkit-transform: translate(100px, 40px);}
    100% {-webkit-transform: translate(300px, -20px);}
}
#BG{position:absolute}
#lady{
    position: absolute;    
    float:left;
    top:240px;
    margin-left: 250px;
    z-index:2;
    color:white        
}
.animlady{
    -webkit-animation-name: ladymove;
    -webkit-animation-duration: 3s;
    -webkit-animation-fill-mode: forwards    
}​ 
```

简而言之，我`<img>`在一个 div 内部作为背景固定在页面中，在它内部（div）另一个 div 带有一个`<img>`由 JQ 触发的移动。

所以问题是：我如何缩放整个页面/div 容器，使 img 适合屏幕高度，保持与移动的关系，移动`div`的起始位置值以 px 为单位？

我试过类似的东西，`-webkit-transform: scaleY()`但它只是一个缩放器，对吧？它不工作`-webkit-transform: scaleY(100%)`吗？

我的最终目标是拥有一个固定的像素“画布”，它可以通过适应设备的高度来伸展自己，同时让孩子们表现得像父亲一样。

ps 这仅适用于基于 webkit 的平板电脑，所以我只使用 webkit 专用代码没有问题。

# ruby-on-rails - 根据节假日显示内容

> ID：10289254
> 
> 赞同：0
> 
> 时间：2012-04-23T22:35:17.167
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, datetime

*   红宝石 1.9.2p290
*   导轨 3.1.1

我有这些模型：

```
class Recipe < ActiveRecord::Base
 belongs_to :festivity 
end

class Festivity < ActiveRecord::Base
 has_many :recipes 
end 
```

我在“食谱”表中有以下字段：

```
festivity_id 
```

以及“庆祝活动”表中的以下日期时间字段：

```
starts_at
ends_at 
```

如何根据庆祝日期显示内容？

我开始以这种静态方式思考：

```
class PagesController < ApplicationController
 def home
  @recipes_by_festivities = Recipe.where(:festivity_id => 4).all(:order => 'RAND()', :limit => 8)
 end
end 
```

例如：在圣诞节期间（大约整个 12 月），我想显示一个 festivity_id = 1 的食谱列表。在感恩节期间，我只想显示一个 festivity_id = 4 的食谱列表。

我清楚了吗？如果我没有，请告诉我。

**解决方案**

```
@current_festivity = Festivity.find(:last, :conditions => ["? between starts_at AND ends_at", Time.utc(0,Time.now.month,Time.now.day,0,0,0)])

@recipes_by_festivities = Recipe.where(:festivity_id => @current_festivity).all(:order => 'RAND()', :limit => 8) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:12:39.407

我要做的是在庆祝活动表中创建一个“名称”字段，然后使用[假期 gem](https://rubygems.org/gems/holidays)来确定特定日期是否有假期。

```
Holdays.on(Date.today) 
```

这将返回一个哈希列表：每个哈希都有一个名称键。然后您可以使用它来查找正确的 Festivity 对象`current_festival = Festivies.where(:name => Holdays.on(Date.today)[0][:name])`并从那里获取食谱：`current_festival.recipes`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T04:21:50.383

由于您想按庆祝活动查找食谱，您可以这样做：

```
def home
  festivity_today = some_custom_festivity_lookup(Time.now)
  if !festivity_today.nil?
    @recipes = Recipe.where(festivity_id: festivity_today.id).limit(8)
  else
    @recipes = Recipe.limit(8)
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T16:47:20.763

这假定`starts_at`并`ends_at`与同一年 (0) 一起保存，除非期间在两年中间（例如圣诞节时间）：在这种情况下，`ends_at`年份必须为 1。

```
Festivity.create(name: 'Christmas time', starts_at: Time.utc(0,12,25,0,0,0), ends_at: Time.utc(1,1,6,23,59,59))
Festivity.create(name: 'Ferragosto', starts_at: Time.utc(0,8,15,0,0,0), ends_at: Time.utc(0,8,15,23,59,59))

Recipe.create(festivity: Festivity.find_by_name('Periodo natalizio'))
Recipe.create(festivity: Festivity.find_by_name('Ferragosto'))

# Searching for festivities today
Recipe.includes(:festivity).where(['? BETWEEN festivities.starts_at AND festivities.ends_at', Time.utc(0,Time.now.month,Time.now.day,12,0,0)]).all
# Searching for festivities on 15 August (in Italy there is a festivity that is called Ferragosto)
Recipe.includes(:festivity).where(['? BETWEEN festivities.starts_at AND festivities.ends_at', Time.utc(0,8,15,12,0,0)]).all
# Searching for festivities on 28 December
Recipe.includes(:festivity).where(['? BETWEEN festivities.starts_at AND festivities.ends_at', Time.utc(0,12,28,12,0,0)]).all 
```

这是一个功能的可能实现：

```
def recipes_on(day, month)
  Recipe.includes(:festivity).where(['? BETWEEN festivities.starts_at AND festivities.ends_at', Time.utc(0,month,day,12,0,0)]).all
end 
```

# c# - 替换 xml 文件时出错 @C:\Windows\System32\WindowsPowerShell

> ID：10289256
> 
> 赞同：0
> 
> 时间：2012-04-23T22:35:28.507
> 
> 标签：c#, xml, c#-4.0, xpath, console-application

我正在编写一个控制台应用程序，我试图`xx.config`用其他 xml 文件（`xx.config`）替换一个 xml 文件（），该文件位于不同的文件夹中，具有不同的路径数据`C:\Windows\System32\WindowsPowerShell`。我收到以下错误

> 找不到路径的一部分`C:\Windows\System32\WindowsPowerShell\xx.config`

但是这个路径有文件。我试图加载这个文件，`XMLDocument`然后也发生了同样的错误。谁能告诉我我做错了什么。

> XDocument xmldoc = XDocument.Load(@"C:\test\xx.config");\加载好的 XDocument xmldoc = XDocument.Load(@"C:\Windows\System32\WindowsPowerShell\xx.config");\错误发生
> 
> File.Move(@"C:\test\xx.config", >@"C:\Windows\System32\WindowsPowerShell\xx.config");\错误发生

# php - 无法从 JQuery ajax 调用仅接收 JSON

> ID：10289259
> 
> 赞同：0
> 
> 时间：2012-04-23T22:35:37.370
> 
> 标签：php, javascript, jquery, ajax, json

这是我的js代码。

```
....
var arrayData = {"projectId": projectId, "stateId":stateId};
$.ajax({
              type: "GET",
              contentType: "application/json; charset=utf-8",
              url: "/bidboldly/projects/editproject/",                
              data: arrayData,
              success : function(response) {                            
                    alert(response);            
              },
              error: function(){
                    alert("error");
              }
            }) 
```

服务器端。

```
$city = $this->City->find('list',array('conditions' =>array('City.status'=>1, 'City.state_id'=>$this->params['url']['stateId']),'fields'=>array('City.id','City.city'),'order'=>array('City.city ASC')));
            echo json_encode($city); 
```

之后在客户端我收到了城市列表+ html。像这样的东西。

```
..."Young America" [20292]=> string(10) "Zanesville" } <html><head>...... 
```

为什么要传输 HTML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:49:38.907

这篇文章[http://book.cakephp.org/1.1/view/316/Helpers](http://book.cakephp.org/1.1/view/316/Helpers)说你应该使用 ajax 渲染布局：

```
$this->layout = "ajax"; 
```

另一个充满关于 ajax 和 cake php 的有用文章的页面是： [http ://ahsanity.wordpress.com/2007/02/23/get-started-with-ajax-in-cakephp/](http://ahsanity.wordpress.com/2007/02/23/get-started-with-ajax-in-cakephp/)

# ios - 为什么此视频无法在 iOS 设备上播放？

> ID：10289260
> 
> 赞同：-1
> 
> 时间：2012-04-23T22:35:53.013
> 
> 标签：ios, video, h.264

[http://films2.video.ru/preview/8/1/18356_oth1.mp4](http://films2.video.ru/preview/8/1/18356_oth1.mp4)

它在 mac 上运行良好，但在 iPad 和 iPhone 上不行。格式为 H.264，AAC，尺寸为 720 × 544 - 所以 iPhone 4 可以播放低于 720p。它也没有在移动 Safari 中播放，所以这不是我的应用程序问题。有什么问题？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T08:51:14.340

我发现在 iOS 设备上播放视频不仅仅与格式、大小和帧速率有关。还有一个“编码配置文件”，应该适用于 iPhone 4 至 3.1 级，适用于 iPhone 4S 至 4.1 级。我的视频有 5.1 级，所以这就是原因。

[您可以使用 VideoSpec http://www.macupdate.com/app/mac/25921/videospec](http://www.macupdate.com/app/mac/25921/videospec)找到视频的编码配置文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T07:35:51.350

一些视频需要有稍微不同的编码才能在 iOS 上播放。

有许多转换器可供尝试，包括一些免费转换器。

手刹： [http ://handbrake.fr/](http://handbrake.fr/)

MPEG Streamclip [http://www.squared5.com/](http://www.squared5.com/)

Quicktime Pro 还有一个导出>电影到 iPhone 设置。 [https://discussions.apple.com/thread/1311713](https://discussions.apple.com/thread/1311713)

# ios - 构建 iPhone 测验应用程序

> ID：10289261
> 
> 赞同：-2
> 
> 时间：2012-04-23T22:35:58.990
> 
> 标签：ios, cocoa-touch, random, plist

我正在尝试为 iPhone 制作一个测验应用程序。我不太清楚如何开始。会有数百个问题，所以我不想为每个问题构建一个单独的视图。我应该以什么格式将问题导入应用程序以阅读，然后将其设置为按随机顺序和类别（即一次所有问题，仅数学问题，仅英语问题等）做问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:48:28.533

> 会有数百个问题，所以我不想为每个问题构建一个单独的视图。

当然不是。将问题视为应用程序运行的数据。您可能希望每种问题格式都有一个视图，例如多项选择、简答等。

> 我应该以什么格式将问题导入应用程序进行阅读

That's totally up to you -- it's a design decision, so choose whatever works best for you. When faced with an arbitrary-seeming decision like this, it's often a good idea to stay flexible. For example, you might decide to put the questions in a text file for now, but design your code so that it's easy to plug code that reads a different format.

> and then set it up to do questions in random order, and by category (i.e. all questions at once, only math questions, only english questions, etc.)?

Sounds like you might want to consider storing the questions in some sort of database. You can then query the database with different criteria to get different sets of questions.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:44:55.807

您可以使用 CoreData 存储问题，然后在应用程序首次加载时从 JSON 文件或类似文件中读取它们。这也将允许您在将来通过 REST api 更新问题。

你可以看看[RestKit](http://github.com/RestKit/RestKit)它将为你处理很多解析。

在将所有问题加载到数据库中之后，剩下的就取决于您了，但是在 CoreDate 上构建视图非常容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T22:47:12.963

我建议您在数据库中组织您的问题，例如：

```
Questions Table
QuestionID | Question                          | Answer       | Category
1          | What is 2 + 2                     | 5            | math
2          | What is the capital of Argentina? | Buenos Aires | geography 
```

这样，使用单个视图并使用 SQL 访问问题会很简单。

# class - Cocos2D：使用类方法添加精灵时无法移除精灵

> ID：10289268
> 
> 赞同：0
> 
> 时间：2012-04-23T22:36:27.897
> 
> 标签：class, methods, cocos2d-iphone, sprite

在我的备用类中的方法声明中，我传递了一个 CCLayer 指针，其中添加了精灵以及一个精灵和精灵表指针：

```
+(void) toggleSeedSelectionScreen:(CCLayer*)layer 
                   withSeedSprite:(CCSprite*)seedSprite
              withSeedSpriteSheet:(CCSpriteBatchNode*)seedSpriteSheet; 
```

在我的 .m 中的 toggleSeedSelectionScreen 方法中，我添加了 spritesheet 和 sprite，如下所示：

```
[seedSpriteSheet addChild:seedSprite];
[layer addChild:seedSpriteSheet z:14]; 
```

这工作正常。看起来很奇怪的是，当在我的 CCLayer（层）中调用一个方法来删除 seedSpriteSheet 时，什么也没有发生。

```
[self removeChild:seedSpriteSheet cleanup:YES]; 
```

当类方法曾经是层中的方法时，它工作得很好。有什么明显的原因吗？

**似乎将其添加到图层后，通过键入po seedSprite**，它不知道它是控制台中的父对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T18:07:04.160

尝试 `[seedSpriteSheet removeFromParentAndCleanup:YES];`

编辑：您说当您将其更改为图层上的实例方法时它起作用了..所以为什么不做这样的事情：`[[[myobject alloc]init] <instance method> ];`。我知道它有效，因为我用过它

# c++ - 在由同一编译器编译的另一个进程提供的指针上使用 typeid 是否安全？

> ID：10289269
> 
> 赞同：1
> 
> 时间：2012-04-23T22:36:32.667
> 
> 标签：c++, typeid

根据标准，typeid 操作符是依赖于实现的，所以在不同编译器编译的其他进程创建的对象上使用它是无稽之谈。但是提供进程由同一个编译器编译是什么情况呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:46:58.753

它可能不起作用，因为外部对象将在其自己的进程空间中包含一个 vtable 指针，而不是检查进程的。如果您可以形成一个地址空间，其中两个可执行二进制映像都在适当的位置，就好像它们正在运行一样，那么也许可以。如果它是使用相同命令行标志的相同编译器的相同版本，或者如果您的平台 ABI 准确指定了`typeid`运行时的工作方式，那么您可能没问题。

但严格来说，C++ 对象模型不容纳共享内存。您需要在进程之间传输之前进行序列化，并且没有办法安全地序列化接收端可能不存在的 C++ 类型。

# objective-c - 如何禁用访问器返回类型警告？

> ID：10289271
> 
> 赞同：0
> 
> 时间：2012-04-23T22:36:46.980
> 
> 标签：objective-c, xcode, warnings, getter-setter, accessor

我有一个内部必须是不同类型的对象，但我总是想以字符串的形式返回。所以我将对象声明为“id”并编写了一个始终返回 NSString* 的 getter 方法。一切正常，XCode 按预期抱怨“属性类型'X'与访问器类型'setX:'不匹配”。既然我确实想要这种行为，那么有没有人知道如何告诉 XCode 我确实想要这种行为，并且不想一直看到这个警告？有点像未使用变量的“__unused”指令？

谢谢！最大限度

编辑：这是代码

**。H**

```
@property (strong,nonatomic) id wert;
- (void) setWert:(NSString *)value;
- (NSString *) wert; 
```

**.m**

```
 @synthesize wert;

- (void) setWert:(NSString *)value
{
        wert = value;
}

- (NSString *) wert
{
        return wert;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T12:39:18.097

问题在于以下几行：

```
@interface TestClass : NSObject

@property (strong, nonatomic) id wert;

- (void) setWert:(NSString *)value;
- (NSString *) wert;

@end 
```

本质上，该`@property`符号是声明访问器方法的简写（诚然，具有一些属性）。所以在这里先声明为`id`，然后声明为 NSString 是没有意义的。确定要为 wert 公开的类型，并将其用于属性声明。我建议：

```
@interface TestClass : NSObject

@property (strong, nonatomic) id wert;

@end 
```

此外，在 中`.m`，您首先 @synthesize 属性，然后覆盖 getter 和 setter。这意味着您从 @synthesize 获得的唯一东西是实例变量。

您也可以在 @implementation 块中声明实例变量。这将是您声明内部类型的好地方：

```
@implementation TestClass
{
    NSString *wert;
} 
```

但是如果你对其他类调用 setWert: 感到高兴，除了 NSString 之外，你不应该更改 setter 的类型声明。这样做会假设这`value`是一个 NSString。所以你的访问器应该是这样的：

```
- (void) setWert:(id)value
{
    // store wert as an NSString
}

- (id) wert
{
    // return wert as the original type
}

@end 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-23T22:47:37.170

设置`NSString *`to 和`id`typed 属性不会导致警告，但是将`id`typed var 设置为`NSString *`属性将...您可以使用 typecast 解决...

```
id someVar = @"string";
someObject.setStringProperty = (NSString *)someVar; 
```

# c# - 在 NHibernate 3.3 中使用 Fluent NHibernate

> ID：10289272
> 
> 赞同：3
> 
> 时间：2012-04-23T22:36:52.830
> 
> 标签：c#, nhibernate, orm, fluent-nhibernate

我刚刚看到 NHibernate 3.3 已经发布，我尝试在一个新项目中实现它。

与 3.2 版非常相似，我在使用 Fluent NHibernate 时遇到了问题，我添加了 Fluent NHibernate 1.3 版并收到以下错误消息。

```
Could not load file or assembly 'NHibernate, Version=3.2.0.4000, Culture=neutral, PublicKeyToken=aa95f207798dfdb4' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. 
```

我可以使用最新版本的 NHibernate 安全流畅地运行吗？我知道以前针对 NHibernate 构建 FluentNHibernate 源代码可以工作。这是推荐的还是在 3.3 中发生了足够大的变化以使问题变得可能？

我检查了 Fluent NHibernate 站点，但看不到最近的活动。有谁知道 James 是否计划继续支持 Fluent，我知道他有一些疑问。

[http://lostechies.com/jamesgregory/2011/04/13/me-on-nhibernate-3-2/](http://lostechies.com/jamesgregory/2011/04/13/me-on-nhibernate-3-2/)

真的希望支持继续下去，因为 NHibernate 的代码映射感觉不那么直观，而且那里仍然没有太多信息。

干杯

史蒂夫

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T07:15:45.193

只需获取[最新的源代码](https://github.com/jagregory/fluent-nhibernate)并针对最新的 NHibernate 进行编译。只要 NHibernate 不更改 XML 配置模式中的某些内容，这将始终有效。我已经以这种方式使用它而没有问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T10:36:07.037

您在这里有两个选择。

1.  放置[程序集重定向](http://msdn.microsoft.com/en-us/library/7wd6ex19%28v=vs.71%29.aspx)（您可以尝试使用 Nuget 命令[Add-BindingRedirect](http://docs.nuget.org/docs/reference/package-manager-console-powershell-reference)
2.  从源代码编译

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T14:28:29.857

要回答您问题的第二部分...

James 于 2012 年 1 月 27 日将其发布到 FNH Google Group：

> 嘿大家，
> 
> 我注意到这里的人们开始变得有些不安。我想你们都应该得到一点解释。
> 
> Fluent NHibernate 没有死；然而，它被严重忽视。稍后我会谈到原因，但我不打算让这个项目死掉；它可能只需要在被忽视的状态下保持一段时间。偶尔会处理拉取请求，但现在只有我在这里，我只是没有时间处理它。
> 
> 帮助将不胜感激，但我不希望它。如果有人愿意，请联系（james@jagregory.com）；我现在对项目管理帮助比对代码更感兴趣，因为我们在这方面仍然相当活跃（即贡献者）。
> 
> 由于缺乏活动，目前还没有真正的路线图；但我一直计划发布 1.3/4 版本，然后再推出更简洁的 2.0 版本；什么时候会发生是现在任何人的猜测。
> 
> 个人资料：如果您听够了，请随意跳过。所以所有这些懈怠的原因是我辞掉了在伦敦的工作，搬到了澳大利亚，并加入了悉尼的 ThoughtWorks（现在暂时在墨尔本）。这是一个很大的举动，几乎是在世界的一半。我不得不在这里重新建立自己，这是一个非常耗时的经历；新的国家、新的工作、新的城市、新的朋友等等…​​…我的优先事项已经完全从非必要的项目上转移了，一旦一天结束，我最不想做的就是启动虚拟机并制作一些代码。我讨厌让人们失望，也讨厌忽视 FNH，但我的优先事项已经（暂时）改变了。
> 
> 希望至少能澄清一些人的想法。随时提出任何问题，我会尽力实际回答。
> 
> 干杯，詹姆斯
> 
> PS 邮件列表消息 - 对此感到抱歉。Google Groups 显然决定停止通知我新消息。所有优秀的都被批准了。

我主动提出帮助一些管理工作，但在与他交换了几封电子邮件后，没有听到任何进一步的消息。

# java - 按下提交按钮后java jsp清除会话

> ID：10289273
> 
> 赞同：1
> 
> 时间：2012-04-23T22:37:19.943
> 
> 标签：java, jsp

这是我的代码

```
if(request.getParameter("btnlogOut") != null)
   {
    session.invalidate();
   } 
```

它不清楚会话....

谢谢

坦率

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T22:41:23.480

确实如此。

很可能您发送的是转发而不是重定向到结果页面。这样旧的会话变量仍然可以在 EL 范围内访问。确保您在失效后发送重定向。

```
session.invalidate();
response.sendRedirect(request.getContextPath() + "/index.jsp"); 
```

这样，将指示浏览器在没有会话 cookie 的情况下在给定 URL 上发送全新的 HTTP 请求，因此相关的 servlet 请求-响应将获得一个全新的`HttpSession`对象实例。

# c# - 将 HSV 圆圈代码从 Delphi 转换为 C#

> ID：10289279
> 
> 赞同：7
> 
> 时间：2012-04-23T22:37:38.530
> 
> 标签：c#, delphi, windows-phone-7, colors

我正在尝试将一个函数转换为从 Delphi 到 C# 创建 HSV Circle，但结果不正确。

我的目标是为 Windows Phone 7 做一个应用程序，我只使用 WP7.1 SDK 和`WriteableBitmapEx`库。

德尔福代码：

```
FUNCTION CreateHueSaturationCircle(CONST size: INTEGER; CONST ValueLevel: INTEGER; CONST BackgroundColor: TColor): TBitmap;
VAR
  dSquared: INTEGER;
  H,S,V: INTEGER;
  i: INTEGER;
  j: INTEGER;
  Radius: INTEGER;
  RadiusSquared: INTEGER;
  row: pRGBTripleArray;
  X: INTEGER;
  Y: INTEGER;
BEGIN
    RESULT := TBitmap.Create;
    RESULT.PixelFormat := pf24bit;
    RESULT.Width := size;
    RESULT.Height := size;

    // Fill with background color
    RESULT.Canvas.Brush.Color := BackGroundColor;
    RESULT.Canvas.FillRect(RESULT.Canvas.ClipRect);

    Radius := size DIV 2;
    RadiusSquared := Radius * Radius;

    V := ValueLevel;
    FOR j := 0 TO RESULT.Height - 1 DO
    BEGIN
        Y := Size - 1 - j - Radius;  {Center is Radius offset}
        row := RESULT.Scanline[Size - 1 - j];
        FOR i := 0 TO RESULT.Width - 1 DO
        BEGIN
            X := i - Radius;
            dSquared := X * X + Y * Y;
            IF dSquared <= RadiusSquared THEN
            BEGIN
                S := ROUND((255 * SQRT(dSquared)) / Radius);
                H := ROUND(180 * (1 + ArcTan2(X, Y) / PI));   // 0..360 degrees
                // Shift 90 degrees so H=0 (red) occurs along "X" axis
                H := H + 90;
                IF H > 360 THEN
                    H := H - 360;
                row[i] := HSVtoRGBTriple(H,S,V)
            END
        END;
    END;
END;

FUNCTION HSVtoRGBTriple(CONST H,S,V: INTEGER): TRGBTriple;
CONST
  divisor: INTEGER = 255 * 60;
VAR
  f: INTEGER;
  hTemp: INTEGER;
  p,q,t: INTEGER;
  VS: INTEGER;
BEGIN
    IF S = 0 THEN
        RESULT := RGBtoRGBTriple(V, V, V)  // achromatic:  shades of gray
    ELSE
    BEGIN                              // chromatic color
        IF H = 360 THEN
            hTemp := 0
        ELSE
            hTemp := H;
        f := hTemp MOD 60;     // f is IN [0, 59]
        hTemp := hTemp DIV 60;     // h is now IN [0,6)
        VS := V * S;
        p := V - VS DIV 255;                 // p = v * (1 - s)
        q := V - (VS*f) DIV divisor;         // q = v * (1 - s*f)
        t := V - (VS*(60 - f)) DIV divisor;  // t = v * (1 - s * (1 - f))
        CASE hTemp OF
            0:   RESULT := RGBtoRGBTriple(V, t, p);
            1:   RESULT := RGBtoRGBTriple(q, V, p);
            2:   RESULT := RGBtoRGBTriple(p, V, t);
            3:   RESULT := RGBtoRGBTriple(p, q, V);
            4:   RESULT := RGBtoRGBTriple(t, p, V);
            5:   RESULT := RGBtoRGBTriple(V, p, q);
        ELSE
            RESULT := RGBtoRGBTriple(0,0,0)  // should never happen;
                                          // avoid compiler warning
        END
    END
END 
```

Delphi代码的结果：

![德尔福图片](../Images/cf14e8dc76c1e2a0fade4c34fa205a0c.png)

我的 C# 代码：

```
 public struct HSV
    {
        public float h;
        public float s;
        public float v;
    }

    public void createHsvCircle()
    {
        int size = 300;

        wb = new WriteableBitmap(size, size);

        wb.Clear(GraphicsUtils.WhiteColor);

        int radius = size / 2;
        int radiusSquared = radius * radius;

        int x;
        int y;
        int dSquared;

        HSV hsv;
        hsv.v = 255F;

        for (int j = 0; j < size; j++)
        {
            y = size - 1 - j - radius;

            for (int i = 0; i < size; i++)
            {
                x = i - radius;
                dSquared = x * x + y * y;

                if (dSquared <= radiusSquared)
                {
                    hsv.s = (float) Math.Round((255 * Math.Sqrt(dSquared)) / radius);

                    hsv.h = (float) Math.Round(180 * (1 + Math.Atan2(y, x) / Math.PI));

                    hsv.h += 90;
                    if (hsv.h > 360)
                    {
                        hsv.h -= 360;
                    }

                    Color color = GraphicsUtils.HsvToRgb(hsv);

                    wb.SetPixel(i, j, color);
                }
            }
        }

        wb.Invalidate();

    }

    public static Color HsvToRgb(float h, float s, float v)
    {
        h = h / 360;
        if (s > 0)
        {
            if (h >= 1)
                h = 0;
            h = 6 * h;
            int hueFloor = (int)Math.Floor(h);
            byte a = (byte)Math.Round(RGB_MAX * v * (1.0 - s));
            byte b = (byte)Math.Round(RGB_MAX * v * (1.0 - (s * (h - hueFloor))));
            byte c = (byte)Math.Round(RGB_MAX * v * (1.0 - (s * (1.0 - (h - hueFloor)))));
            byte d = (byte)Math.Round(RGB_MAX * v);

            switch (hueFloor)
            {
                case 0: return Color.FromArgb(RGB_MAX, d, c, a);
                case 1: return Color.FromArgb(RGB_MAX, b, d, a);
                case 2: return Color.FromArgb(RGB_MAX, a, d, c);
                case 3: return Color.FromArgb(RGB_MAX, a, b, d);
                case 4: return Color.FromArgb(RGB_MAX, c, a, d);
                case 5: return Color.FromArgb(RGB_MAX, d, a, b);
                default: return Color.FromArgb(RGB_MAX, 0, 0, 0);
            }
        }
        else
        {
            byte d = (byte)(v * RGB_MAX);
            return Color.FromArgb(255, d, d, d);
        }
    }

    public static Color HsvToRgb(HSV hsv)
    {
        return HsvToRgb(hsv.h, hsv.s, hsv.v);
    } 
```

我的 C# 结果：

![夏普](../Images/ca68a03de8af7919589dafeb3dfc6185.png)

我做错了什么？

提前致谢。

**用解决方案编辑**

借助@Aybe 的出色回答，我可以从 HSV 地狱中制作一个工作版本。

这是 WP7 SDK 的工作代码：

```
 public const double PI = 3.14159265358979323846264338327950288d;

    public void createHsvCircle(double value = 1.0d)
    {
        if (value < 0.0d || value > 1.0d)
            throw new ArgumentOutOfRangeException("value");

        var size = 1024;

        wb = new WriteableBitmap(size, size);

        // fill with white.
        var white = Colors.White;
        for (int index = 0; index < wb.Pixels.Length; index++)
        {
            wb.Pixels[index] = 0xFF << 24 | white.R << 16 | white.G << 8 | white.B;
        }

        var cx = size / 2;
        var cy = size / 2;
        var radius = cx;
        var radiusSquared = radius * radius;
        for (int i = 0; i < size; i++)
        {
            for (int j = 0; j < size; j++)
            {
                var x = i - cx;
                var y = j - cy;
                var distance = (double)x * x + y * y;
                if (distance <= radiusSquared) // In circle
                {
                    var angle = 180.0d * (1 + Math.Atan2(x, y) / PI);

                    // shift 90 degrees so H=0 (red) occurs along "X" axis
                    angle += 90.0d;
                    if (angle > 360.0d)
                    {
                        angle -= 360.0d;
                    }

                    var hue = angle / 360.0d; // hue must be into 0 to 1.
                    var saturation = Math.Sqrt(distance) / radius; // saturation must be into 0 to 1.

                    var hsv = new HSV(hue, saturation, value);
                    var rgb = RGB.FromHsv(hsv.H, hsv.S, hsv.V);

                    wb.Pixels[j * size + i] = 0xFF << 24 | rgb.R << 16 | rgb.G << 8 | rgb.B;
                }
            }

        }
        wb.Invalidate();
    }

    public static RGB FromHsv(double hue, double saturation, double value)
    {
        if (hue < 0.0d || hue > 1.0d)
            throw new ArgumentOutOfRangeException("hue");
        if (saturation < 0.0d || saturation > 1.0d)
            throw new ArgumentOutOfRangeException("saturation");
        if (value < 0.0d || value > 1.0d)
            throw new ArgumentOutOfRangeException("value");

        if (saturation == 0.0d)
        {
            var b1 = (byte)(value * 255);
            return new RGB(b1, b1, b1);
        }

        double r;
        double g;
        double b;

        var h = hue * 6.0d;
        if (h == 6.0d)
        {
            h = 0.0d;
        }

        int i = (int)Math.Floor(h);

        var v1 = value * (1.0d - saturation);
        var v2 = value * (1.0d - saturation * (h - i));
        var v3 = value * (1.0d - saturation * (1.0d - (h - i)));

        switch (i)
        {
            case 0:
                r = value;
                g = v3;
                b = v1;
                break;
            case 1:
                r = v2;
                g = value;
                b = v1;
                break;
            case 2:
                r = v1;
                g = value;
                b = v3;
                break;
            case 3:
                r = v1;
                g = v2;
                b = value;
                break;
            case 4:
                r = v3;
                g = v1;
                b = value;
                break;
            default:
                r = value;
                g = v1;
                b = v2;
                break;
        }

        r = r * 255.0d;
        if (r > 255.0d)
        {
            r = 255.0d;
        }
        g = g * 255.0d;
        if (g > 255.0d)
        {
            g = 255.0d;
        }
        b = b * 255.0d;
        if (b > 255.0d)
        {
            b = 255.0d;
        }

        return new RGB((byte)r, (byte)g, (byte)b);
    } 
```

现在，新的结果：

![好的](../Images/e54e6975051ecacb2b8eb26f3c33d879.png)

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T19:51:50.683

花了一个小时左右，我在这个过程中学到了一些东西......

现在代码：（适用于任何尺寸）

这是 HSL，但我给了你有其他算法的 url。

![](../Images/6d9460ed476caa30737a75312222075c.png)

```
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Windows;
using System.Windows.Media;
using System.Windows.Media.Imaging;

namespace ColorWheel
{
    /// <summary>
    ///   Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void BuildWheel()
        {
            var width = 1024;
            var height = width;
            var cx = width/2;
            var cy = height/2;
            var colors = new int[width*height];
            var gray = Colors.Gray.ToBgr32();
            for (int index = 0; index < colors.Length; index++) colors[index] = gray;

            var radius = cx;
            var radiusSquared = radius*radius;
            for (int i = 0; i < height; i++)
            {
                for (int j = 0; j < width; j++)
                {
                    var x = j - cx;
                    var y = i - cy;
                    var distanceSquared = (double) x*x + y*y;
                    if (distanceSquared <= radiusSquared) // In circle
                    {
                        var h = Math.Atan2(x, y).ToDegrees() + 180.0d; // Angle
                        var s = 1.0d;
                        var l = (1.0d - ((1.0d/radiusSquared)*distanceSquared)); // 1 - (distance normalized)
                        var hsl = new HSL((float) h, (float) s, (float) l);
                        var rgb = RGB.FromHsl(hsl.H, hsl.S, hsl.L);
                        colors[i*width + j] = rgb.R << 16 | rgb.G << 8 | rgb.B;
                    }
                }
            }
            var bitmap = new WriteableBitmap(width, height, 96, 96, PixelFormats.Bgr32, null);
            bitmap.WritePixels(new Int32Rect(0, 0, width, height), colors, width*4, 0);
            image.Source = bitmap;
        }

        private void Window_Loaded(object sender, RoutedEventArgs e)
        {
            BuildWheel();
        }
    }

    public static class Helpers
    {
        public static double ToDegrees(this double radians)
        {
            return radians*57.2957795130823; // radians * (180.0d / Math.PI)
        }

        public static double ToRadians(this double degrees)
        {
            return degrees*0.0174532925199433; // degrees * (Math.PI / 180.0d)
        }
    }

    public static class ColorExtensions
    {
        public static Color FromBgr32(this Int32 color)
        {
            return Color.FromRgb((byte) ((color & 0xFF0000) >> 16), (byte) ((color & 0xFF00) >> 8), (byte) (color & 0xFF));
        }

        public static int ToBgr32(this Color color)
        {
            return color.R << 16 | color.G << 8 | color.B;
        }
    }

    /// <summary>
    ///   Represents a color in an HSL space.
    /// </summary>
    [StructLayout(LayoutKind.Sequential)]
    public struct HSL
    {
        [DebuggerBrowsable(DebuggerBrowsableState.Never)] private readonly double _h;

        [DebuggerBrowsable(DebuggerBrowsableState.Never)] private readonly double _s;

        [DebuggerBrowsable(DebuggerBrowsableState.Never)] private readonly double _l;

        /// <summary>
        ///   Returns the fully qualified type name of this instance.
        /// </summary>
        /// <returns> A <see cref="T:System.String" /> containing a fully qualified type name. </returns>
        /// <filterpriority>2</filterpriority>
        public override string ToString()
        {
            return string.Format("H: {0}, S: {1}, L: {2}", _h, _s, _l);
        }

        /// <summary>
        ///   Create a new instance of <see cref="HSL" /> .
        /// </summary>
        /// <param name="h"> Value of <see cref="H" /> component. </param>
        /// <param name="s"> Value of <see cref="S" /> component. </param>
        /// <param name="l"> Value of <see cref="L" /> component. </param>
        public HSL(double h, double s, double l)
        {
            _h = h;
            _s = s;
            _l = l;
        }

        /// <summary>
        ///   Gets the value of the hue component.
        /// </summary>
        public double H
        {
            get { return _h; }
        }

        /// <summary>
        ///   Gets the value of the saturation component.
        /// </summary>
        public double S
        {
            get { return _s; }
        }

        /// <summary>
        ///   Gets the value of the lightness component.
        /// </summary>
        public double L
        {
            get { return _l; }
        }

        public override bool Equals(object obj)
        {
            if (ReferenceEquals(null, obj)) return false;
            if (obj.GetType() != typeof (HSL)) return false;
            return Equals((HSL) obj);
        }

        public bool Equals(HSL other)
        {
            return other._h.Equals(_h) && other._l.Equals(_l) &&
                   other._s.Equals(_s);
        }

        /// <summary>
        ///   Create a new instance of <see cref="HSL" /> , from RGB values.
        /// </summary>
        /// <param name="red"> Value of the red component. </param>
        /// <param name="green"> Value of the green component. </param>
        /// <param name="blue"> Value of the blue component. </param>
        /// <returns> <see cref="HSL" /> instance created. </returns>
        public static HSL FromRGB(byte red, byte green, byte blue)
        {
            var r1 = red/255.0d;
            var g1 = green/255.0d;
            var b1 = blue/255.0d;

            var min = Math.Min(r1, Math.Min(g1, b1));
            var max = Math.Max(r1, Math.Max(g1, b1));

            var l = (max + min)/2.0d;

            var s = 0.0d;
            var h = 0.0d;
            if (min == max)
            {
                h = 0.0d;
                s = 0.0d;
            }
            else
            {
                if (l < 0.5d)
                {
                    s = (max - min)/(max + min);
                }
                else if (l >= 0.5d)
                {
                    s = (max - min)/(2.0d - max - min);
                }

                if (r1 == max)
                {
                    h = (g1 - b1)/(max - min);
                }
                else if (g1 == max)
                {
                    h = 2.0d + (b1 - r1)/(max - min);
                }
                else if (b1 == max)
                {
                    h = 4.0d + (r1 - g1)/(max - min);
                }
            }

            h *= 60.0d;

            if (h < 0.0d)
                h += 360.0d;

            return new HSL(h, s, l);
        }

        /// <summary>
        ///   Returns the hash code for this instance.
        /// </summary>
        /// <returns> A 32-bit signed integer that is the hash code for this instance. </returns>
        /// <filterpriority>2</filterpriority>
        public override int GetHashCode()
        {
            unchecked
            {
                var result = _h.GetHashCode();
                result = (result*397) ^ _l.GetHashCode();
                result = (result*397) ^ _s.GetHashCode();
                return result;
            }
        }

        public static BitmapSource GetHslPalette(int width = 360, int height = 100)
        {
            // Creates an HSL palette image like in Photoshop, etc ...
            var pixels = new int[width*height];
            const double saturation = 1.0d;
            for (var y = 0; y < height; y++)
            {
                for (var x = 0; x < width; x++)
                {
                    var hue = (1.0d/width)*x*360.0d;
                    var lightness = 1.0d - ((1.0f/height)*y);
                    var rgb = RGB.FromHsl(hue, saturation, lightness);
                    pixels[y*width + x] = 0xFF << 24 | rgb.R << 16 | rgb.G << 8 | rgb.B;
                }
            }
            return BitmapSource.Create(width, height, 96, 96, PixelFormats.Pbgra32, null, pixels, width*4);
        }

        public static bool operator ==(HSL left, HSL right)
        {
            return left.Equals(right);
        }

        public static bool operator !=(HSL left, HSL right)
        {
            return !left.Equals(right);
        }
    }

    /// <summary>
    ///   Represents a color in an RGB space.
    /// </summary>
    [StructLayout(LayoutKind.Sequential)]
    public struct RGB
    {
        [DebuggerBrowsable(DebuggerBrowsableState.Never)] private readonly byte _r;

        [DebuggerBrowsable(DebuggerBrowsableState.Never)] private readonly byte _g;

        [DebuggerBrowsable(DebuggerBrowsableState.Never)] private readonly byte _b;

        /// <summary>
        ///   Create a new instance of <see cref="RGB" /> .
        /// </summary>
        /// <param name="r"> Value of red component. </param>
        /// <param name="g"> Value of green component. </param>
        /// <param name="b"> Value of blue component. </param>
        public RGB(byte r, byte g, byte b)
        {
            _r = r;
            _g = g;
            _b = b;
        }

        /// <summary>
        ///   Returns the fully qualified type name of this instance.
        /// </summary>
        /// <returns> A <see cref="T:System.String" /> containing a fully qualified type name. </returns>
        /// <filterpriority>2</filterpriority>
        public override string ToString()
        {
            return string.Format("R: {0}, G: {1}, B: {2}", _r, _g, _b);
        }

        /// <summary>
        ///   Gets the value of the red component.
        /// </summary>
        public byte R
        {
            get { return _r; }
        }

        /// <summary>
        ///   Gets the value of the green component.
        /// </summary>
        public byte G
        {
            get { return _g; }
        }

        /// <summary>
        ///   Gets the value of the blue component.
        /// </summary>
        public byte B
        {
            get { return _b; }
        }

        public override bool Equals(object obj)
        {
            if (ReferenceEquals(null, obj)) return false;
            if (obj.GetType() != typeof (RGB)) return false;
            return Equals((RGB) obj);
        }

        public bool Equals(RGB other)
        {
            return other._b == _b && other._g == _g && other._r == _r;
        }

        /// <summary>
        ///   Create a new instance of <see cref="RGB" /> , from HSL values.
        /// </summary>
        /// <param name="hue"> Hue, from 0.0 to 360.0\. </param>
        /// <param name="saturation"> Saturation, from 0.0 to 1.0\. </param>
        /// <param name="lightness"> Lightness, from 0.0 to 1.0\. </param>
        /// <returns> <see cref="RGB" /> instance created. </returns>
        public static RGB FromHsl(double hue, double saturation, double lightness)
        {
            if (hue < 0.0d || hue > 360.0d) throw new ArgumentOutOfRangeException("hue");
            if (saturation < 0.0d || saturation > 1.0d) throw new ArgumentOutOfRangeException("saturation");
            if (lightness < 0.0d || lightness > 1.0d) throw new ArgumentOutOfRangeException("lightness");

            if (saturation == 0.0d)
            {
                var b1 = (byte) (lightness*255);
                return new RGB(b1, b1, b1);
            }

            var t2 = 0.0d;

            if (lightness < 0.5d)
                t2 = lightness*(1.0d + saturation);
            else if (lightness >= 0.5d)
                t2 = lightness + saturation - lightness*saturation;

            var t1 = 2.0d*lightness - t2;

            var h = hue/360.0d;

            var tr = h + 1.0d/3.0d;
            var tg = h;
            var tb = h - 1.0d/3.0d;

            tr = tr < 0.0d ? tr + 1.0d : tr > 1.0d ? tr - 1.0d : tr;
            tg = tg < 0.0d ? tg + 1.0d : tg > 1.0d ? tg - 1.0d : tg;
            tb = tb < 0.0d ? tb + 1.0d : tb > 1.0d ? tb - 1.0d : tb;

            double r;
            if (6.0d*tr < 1.0d)
                r = t1 + (t2 - t1)*6.0d*tr;
            else if (2.0d*tr < 1.0d)
                r = t2;
            else if (3.0d*tr < 2.0d)
                r = t1 + (t2 - t1)*((2.0d/3.0d) - tr)*6.0d;
            else
                r = t1;

            double g;
            if (6.0d*tg < 1.0d)
                g = t1 + (t2 - t1)*6.0d*tg;
            else if (2.0d*tg < 1.0d)
                g = t2;
            else if (3.0d*tg < 2.0d)
                g = t1 + (t2 - t1)*((2.0d/3.0d) - tg)*6.0d;
            else
                g = t1;

            double b;
            if (6.0d*tb < 1.0d)
                b = t1 + (t2 - t1)*6.0d*tb;
            else if (2.0d*tb < 1.0d)
                b = t2;
            else if (3.0d*tb < 2.0d)
                b = t1 + (t2 - t1)*((2.0d/3.0d) - tb)*6.0d;
            else
                b = t1;

            return new RGB((byte) (r*255), (byte) (g*255), (byte) (b*255));
        }

        /// <summary>
        ///   Returns the hash code for this instance.
        /// </summary>
        /// <returns> A 32-bit signed integer that is the hash code for this instance. </returns>
        /// <filterpriority>2</filterpriority>
        public override int GetHashCode()
        {
            unchecked
            {
                var result = _b.GetHashCode();
                result = (result*397) ^ _g.GetHashCode();
                result = (result*397) ^ _r.GetHashCode();
                return result;
            }
        }

        public static bool operator ==(RGB left, RGB right)
        {
            return left.Equals(right);
        }

        public static bool operator !=(RGB left, RGB right)
        {
            return !left.Equals(right);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T14:46:53.763

默认情况下，WP7 设备上的位深度不是 16 位吗？在我的 Omnia 7 上是这样。有一个注册表设置可以控制此参数，但它可能不适用于所有手机，您应该将颜色从 24 位抖动到 16 位，然后它将在所有手机上可用。我建议你看看[Microsoft.Xna.Framework.Graphics.PackedVector](http://msdn.microsoft.com/en-us/library/bb198361.aspx)，有像 BGR565 这样接受浮点数作为输入的构造函数。对于您所有的颜色转换需求：[http](http://www.easyrgb.com/index.php?X=MATH) ://www.easyrgb.com/ ，几乎所有的算法都可以在颜色空间之间进行转换。

# php - cURL -- cookie 和会话

> ID：10289281
> 
> 赞同：13
> 
> 时间：2012-04-23T22:37:56.847
> 
> 标签：php, curl

我想了解 cookie 的 cURL 的四个选项：

```
CURLOPT_COOKIESESSION  
CURLOPT_COOKIEFILE
CURLOPT_COOKIEJAR
CURLOPT_COOKIE 
```

我知道那`COOKIEJAR`是为了写 cookie，`COOKIEFILE`是为了阅读。那是`COOKIESESSION`为了什么？这`CURLOPT_COOKIE`是自定义的，但我可以用它来维护与服务器的会话吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-23T22:49:59.413

要了解`CURLOPT_COOKIESESSION`，您需要了解一些关于 cookie 的知识。Cookie 的到期日期由发出 Cookie 的网站设置。如果 cookie 的过期日期已过，浏览器/客户端将不会发送它，它会被客户端删除。如果 cookie 设置为没有过期日期，则浏览器应使用该 cookie，直到浏览器会话关闭，或者用户注销并且 cookie 未设置。

也就是说，这`CURLOPT_COOKIESESSION`是一种让 cURL 模拟关闭浏览器的方法。如果其中`COOKIEFILE`有一些会话 cookie（没有过期的 cookie），如果它们存在于文件中，它通常会发送这些。如果您设置`CURLOPT_COOKIESESSION`，则它不会发送任何没有过期日期的 cookie。

`CURLOPT_COOKIE`只是为您提供了一种设置将以原始格式发送到服务器的 cookie 数据的方法。例如，如果您有一个想要发送的原始 HTTP cookie，这将很有用。如果没有此选项，您将不得不将这些 cookie 放入，或使用您拥有的原始值`COOKIEFILE`设置自定义 HTTP 标头。`Cookie:`

# iphone - UIButton 背景图片制作工具？

> ID：10289284
> 
> 赞同：1
> 
> 时间：2012-04-23T22:38:13.803
> 
> 标签：iphone, objective-c, ios

我发现让 UIButton 看起来很好看太难了，并且设置背景图像很有效，但我不是最擅长制作渐变和吸吮。有谁知道专为 iPhone 和 iPad 按钮设计的按钮制造商？或者有没有人有任何提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:17:08.690

您可以尝试 Adob​​e Photoshop，但如果您想以编程方式进行操作，您可以尝试这个网站，该网站是一个使用 Core Animation 应用按钮的教程。

在这里：[有趣的 UIButtons 和核心动画层](http://www.cimgf.com/2010/01/28/fun-with-uibuttons-and-core-animation-layers/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T00:03:41.480

使用 Adob​​e Photoshop 创建按钮。这是一个很好的参考，有许多关于创建按钮的不同教程。（如果你没有 Photoshop，试试 Gimp，一个开源的免费替代品）

[http://naldzgraphics.net/tutorials/40-best-photoshop-tutorials-for-creating-buttons-and-badges/](http://naldzgraphics.net/tutorials/40-best-photoshop-tutorials-for-creating-buttons-and-badges/)

# sql - Django：多对多与直通 vs 2x 一对多

> ID：10289287
> 
> 赞同：1
> 
> 时间：2012-04-23T22:38:48.583
> 
> 标签：sql, django, orm, many-to-many, relational-database

阅读有关多对多关系的 Django 文档，当您需要在中间表上添加一个额外字段时，我不清楚通过将关系定义为多对多而不是仅使用中间的外键来获得什么在您的每个模型中创建模型。

例如，在此处的示例中：[https ://docs.djangoproject.com/en/dev/topics/db/models/#intermediary-manytomany](https://docs.djangoproject.com/en/dev/topics/db/models/#intermediary-manytomany)

为什么要打扰 ManyToManyField 行？它是否允许您以不同的方式提及这种关系？它会改变管理员中的某些内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:31:47.293

为什么要打扰`ManyToManyField line`：M2M 字段是 django `fields`，它对许多模型字段接口很有用，例如`ModelAdmin`or `ModelForm`（声明字段，不包括默认小部件）。它还生成辅助方法，例如易于访问 m2m 管理器和在管理员中自动保存 m2m。

这是该字段自动为管理面板执行的操作的一个快速示例：如果不先保存主对象，您将无法保存直通模型。`save_m2m`管理员在主对象自动保存后处理此行为。如果您不使用 m2m 字段，则必须自己编写这种逻辑。

我认为当您的项目使用 m2m 字段时您会使用此字段，但您只需要少量的附加信息。这样您的代码实际上与典型的 m2m 关系相同，但是当您需要它时，您可以查询额外的信息。

否则，仅添加“date_added”字段将需要编写管理小部件、save_model 挂钩、ModelForm 表示等。

您是对的，尽管使用 through 模型删除 m2m 行不会对数据库进行任何更改，并且您最终可以用默认的 ForeignKey 反向管理器替换 m2mfield 功能而不会造成太大伤害。

```
model.m2m_through_set.all() # this would work
model.m2m_through_set.create(target=target_instance) 
```

# c++ - 是否有充分的理由不在每个头文件中使用 #pragma 一次？

> ID：10289289
> 
> 赞同：2
> 
> 时间：2012-04-23T22:39:25.793
> 
> 标签：c++, header-files, pragma

我是 C++ 新手，开始像大多数人一样组织我的代码：在“头文件”和“源文件”中。

我`#pragma once`在所有包含内联函数的头文件中使用。但我想知道是否有理由反对在每个头文件中简单地使用它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T00:00:40.100

> 我在所有包含内联函数的头文件中使用了一次#pragma

这就是您不需要#pragma 一次的原因*之一*。对同一个内联函数有多个定义是正常和预期的。当多个翻译单元#include 相同的标题时，这是不可避免的，特别是对于模板函数。如果编译器实际上没有内联函数，链接器只会选择它找到的定义之一。您需要 #pragma once 以避免同一类型的多个定义。

# linux - 使用 gitosis 使 GIT 存储库对某些用户只读

> ID：10289298
> 
> 赞同：4
> 
> 时间：2012-04-23T22:40:32.003
> 
> 标签：linux, git, ubuntu, push, gitosis

我们正在使用 gitosis 运行一个 GIT 存储库，我们需要禁止向团队中的某些人推送。

所以我希望每个人都拥有对所有存储库的读取权限（获得 +10 个 repo 和 +20 个用户可以提交 pull 和 push 的机器）

我只需要限制推送，我希望用户可以继续进行拉取和克隆但不能推送，只有 2 个用户可以推送到主控。

那么有什么想法吗？也许在推送之前询问密码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T00:09:24.327

您可以在 gitosis.conf 文件中执行此操作。创建两组，一组用于可以写入 repo 的组，一组用于具有只读访问权限的组：

```
[repo my_repo]
description = Git repository for foobar
owner = user1

[group my-repo]
writable = my_repo
members = user1 user2

[group readonly]
readonly = my_repo
members = user3 user4 user5 
```

# android - Android Stock Calendar 或 android.content.ContentResolver.query() 忽略 selectionArgs

> ID：10289302
> 
> 赞同：1
> 
> 时间：2012-04-23T22:41:02.077
> 
> 标签：android, sql, android-cursor

我正在`Stock Google Calendar`使用旧设备上的非官方 API 获取事件。现在我正在重构要使用的代码，而`selection`不是仅手动绑定（它会生成有效的 SQL 并在我的测试设备 [2.2 和 2.3.3] 上运行而没有问题）。`selectionArgs``android.content.ContentResolver.query()``selection`

**问题：**如果我立即绑定参数（例如：）`deleted = 0`我的测试应用程序返回预期的事件，但是当 Android 绑定时（例如：`deleted = ?`没有`String[] { "0" }`返回事件。忽略的原因是什么`selectionArgs`？

LogCat 没有显示错误。

* * *

**示例（预期）**

```
STATIC: cursor=225
DYNAMIC: cursor=255 
```

返回 255 个事件，因为我的日历今年发生了 255 个事件。

**示例（测试用例）**

测试：摩托罗拉里程碑，CyanogenMod 7 (Android 2.3.3)。

```
STATIC: cursor=225
DYNAMIC: cursor=0 
```

我假设（但希望我做错了什么）Android 或日历应用程序无法绑定。我发现了一个类似问题的错误报告，但我不确定日历应用程序是否受到影响：[http ://code.google.com/p/android/issues/detail?id=4467](http://code.google.com/p/android/issues/detail?id=4467)

**代码**

```
package com.example;

import java.util.Calendar;

import android.app.Activity;
import android.database.Cursor;
import android.net.Uri;
import android.os.Build;
import android.os.Bundle;
import android.util.Log;

/**
 * Related bugs?
 *
 *   - http://code.google.com/p/android/issues/detail?id=4467
 */
public class CalendarCursorTestActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        Calendar begin = Calendar.getInstance();
        Calendar end = Calendar.getInstance();
                 end.add(Calendar.YEAR, 1);

        String uriPrefix = Build.VERSION.SDK_INT >= 8 ? "content://com.android.calendar" : "content://calendar";
        Uri uri = Uri.parse(uriPrefix + "/instances/when/" + begin.getTimeInMillis() + "/" + end.getTimeInMillis());

        String[] projection = null;
        String sortOrder = null;

        // test static - log() returns: STATIC: cursor=225 => 225 events found
        {
            String selection = "deleted = 0";
            String[] selectionArgs = null;

            log("STATIC: ", getBaseContext().getContentResolver().query(
                uri, projection, selection, selectionArgs, sortOrder));
        }

        // test dynamic - log() returns: DYNAMIC: cursor=0 => no events found (!)
        {
            String selection = "deleted = ?";
            String[] selectionArgs = new String[] { "0" };

            log("DYNAMIC: ", getBaseContext().getContentResolver().query(
                uri, projection, selection, selectionArgs, sortOrder));
        }
    }

    public void log (String title, Cursor c) {
        Log.d(getClass().getName(), String.format(
            "%s cursor=%s", title, c == null ? "null" : c.getCount()));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T17:23:24.753

CalendarProvider 似乎在这里有一个错误。

的实现`query`只是忽略用户提供的`selectionArgs`参数。

如果您比较[Android 2.3.3](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/2.3.3_r1/com/android/providers/calendar/CalendarProvider2.java#CalendarProvider2.handleInstanceQuery%28android.database.sqlite.SQLiteQueryBuilder%2Clong%2Clong%2Cjava.lang.String%5B%5D%2Cjava.lang.String%2Cjava.lang.String%2Cboolean%2Cboolean%2Cjava.lang.String%2Cboolean%29)和[Android 4.0.3](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/4.0.3_r1/com/android/providers/calendar/CalendarProvider2.java#1020)中的实现，您会注意到他们添加了`selectionArgs`as 参数并构建了`combine`自己的和用户提供的参数。

该错误已在此处修复：[支持 Calendar.java 的清理](https://github.com/android/platform_packages_providers_calendarprovider/commit/2ce7955da7dffec7819ed38be85e72df8a6f33dc)

# html - “a”标签被复制并应用于附近的文本——为什么？

> ID：10289303
> 
> 赞同：1
> 
> 时间：2012-04-23T22:41:18.533
> 
> 标签：html, css, confluence

我有一个带有以下 html 的页面：

```
<a name="CAPTION_fig1" rel="nofollow" /><p style="margin-top: -0.2em; font-size: 85%; margin-bottom: 0.9em;"><b>Figure 1: This a caption</b></p> 
```

这基本上归结为：

```
<anchor><p>Text</p> 
```

但是当我打开页面时它看起来不正确，所以我使用 Chrome 中的 Inspect Element 检查它。它报告：

```
<a name="CAPTION_fig1" rel="nofollow"></a>
<a name="CAPTION_fig1" rel="nofollow"><p style="margin-top: -0.2em; font-size: 85%; margin-bottom: 0.9em;"><b>Figure 1: This a caption</b></p></a> 
```

为什么会发生这种情况？当我查看源代码时，它仍然看起来像我期望的那样。我也尝试过 IE9，所以它似乎不是特定于浏览器的。

一些背景：我正在升级 Confluence，所以我怀疑它与正在使用的一些新 CSS 有关，但我不知道是什么或为什么。

顺便说一句，我在这里发现了一个类似的问题：[Anchor tags are duplicating](https://stackoverflow.com/questions/3187983/anchor-tags-are-duplicating)，但是他的网站和附图都不见了，加上答案只包括最终的css，而不是他改变的东西，所以它并没有给我太多继续.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T07:57:15.583

我不明白这个错误的确切原因，但是如果其他人在为 Confluence 开发时遇到这些问题，那么将 and 标签分开（不使用自结束标签）并在它们之间放置一个空格似乎会有所帮助。

我将冒险这是由 Confluence 将标签组合成一个自闭合标签（确保 xhtml 合规性或由于错误）引起的，但 Chrome 和 IE9 无法解析它，因为它不兼容 html4（根据 jmoerdyk，标签不能自动关闭）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T16:12:39.213

听起来这个问题已经解决了，但我只想提一下我遇到的类似问题。有一段时间，我在 confluence 上将旧的 html 页面转换为 wikimarkup，但每次我保存编辑器时都会添加很多不需要的换行符。

该问题显然是由将内容​​复制到富文本编辑器然后切换到 wiki 标记编辑器引起的。

# c# - 如何使用 c# 代码检查 sql 表中是否存在特定项目？

> ID：10289306
> 
> 赞同：-1
> 
> 时间：2012-04-23T22:41:43.930
> 
> 标签：c#, asp.net, sql-server

我想检查 CNIC 是否没有。已输入的 tat 用户在我的表中不存在，那么我不希望他继续进行注册过程...

这是代码，**其中一部分** 不起作用..我哪里错了？

```
con.Open();
        string cmdStr = "Select count(*) from Registration where UserName='" + TextBoxUN.Text + "'";
        string cmdCnic = "Select count(*) from List_CNIC where CNIC='" + TextBoxCNIC.Text + "'";
        SqlCommand userExist=new SqlCommand(cmdStr, con);
        SqlCommand cnicExist=new SqlCommand(cmdCnic,con);
        int temp=Convert.ToInt32(userExist.ExecuteScalar().ToString());
        int tempCnic = Convert.ToInt32(cnicExist.ExecuteScalar().ToString());
        con.Close();
        if (temp==1)
        {
            Session["name1"] = TextBoxFN.Text;
            Session["UserName"] = TextBoxUN.Text;
            Response.Redirect("Error.aspx");
        } 
       if (!(tempCnic==1))
        {
            Session["nameFull"] = TextBoxFN.Text;
            Session["CNIC"] = TextBoxCNIC.Text;
            Response.Redirect("Error_InvalidCNIC.aspx");

        } 
```

我正在检查用户名是否存在的代码部分工作正常，但检查**tempCnic**。即使用户没有输入任何内容 ，它也会自动重定向到页面**Error_InvalidCNIC.aspx 。**

代码有什么问题？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:52:03.160

我将创建一个存储过程，它根据插入成功返回不同的代码，并从您的 C# 代码中执行它。

```
CREATE PROC RegisterUser
    @UserName nvarchar(255),
    @CNIC nvarchar(255)
AS
BEGIN
    IF EXISTS (SELECT * FROM  Registration WHERE UserName = @UserName)
    BEGIN
        RETURN -1
    END
    ELSE
    BEGIN
        IF EXISTS (SELECT * FROM List_CNIC WHERE CNIC = @CNIC)
        BEGIN
            RETURN -2
        END
        ELSE
        BEGIN
            --Insert into relevant tables, ideally wrapped in a TRANSACTION with try/catch
            RETURN 1
        END
    END
END 
```

然后我将这个存储过程拖到一个 LINQ to SQL 数据上下文中，并像这样执行它：

```
var db = new DataContextDataClasses();
var result = db.RegisterUser(userName,CNIC);

switch (result) {
    case 1:
         //success
         break;
    case -1:
         //user exists
         break;
    case -2:
         //CNIC exists
         break
    default:
         throw new Exception("Unknown error occurred");
} 
```

但您显然也可以通过 ADO.NET 调用它...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T22:53:01.643

我没有看到这个问题。如果用户没有输入任何内容，那么

`Select count(*) from List_CNIC where CNIC=''`应设置 tempCnic=0

（除非存在 CNIC 为空字符串的行）

这个块被触发（如你所说）

```
if (!(tempCnic==1))
        {
            Session["nameFull"] = TextBoxFN.Text;
            Session["CNIC"] = TextBoxCNIC.Text;
            Response.Redirect("Error_InvalidCNIC.aspx");
    } 
```

因为 !(0==1) 产生真。

它正在做你要求它做的事情

顺便说一句：如果您将此检查写为`(tempCnic!=1)`

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-04-23T22:51:34.953

我进入实体框架，所以它可能不是你的答案，但是......你可能会感兴趣

```
var stuff = List_CNIC.Where(p => p.CNIC == TextBoxCNIC.Text);
if(stuff.Count() == 1) {
    //do your stuff
} 
```

# c - 合并 - 比较 - 输出 (C)

> ID：10289309
> 
> 赞同：0
> 
> 时间：2012-04-23T22:42:22.357
> 
> 标签：c, merge, compare, fgets, fputs

我正在创建一个程序，它采用两个 .txt（data1.txt，data2.txt）文件，其中包含按升序存储的整数，并将它们按升序合并到 output.txt（data3.txt）中。我正在使用 fgets 函数从 .txt 文件中读取每个 int，并使用 if 函数（根本不起作用）比较两个 input.txt 文件中的 fgets。所以我的问题是比较两个 fgets 函数以按升序对整数进行排序的正确方法是什么？

data1.txt 包含：5 15 25 35 45

data2.txt 包含：10 20 30 40 50

这是代码：

```
#include <stdio.h>
#include <stdlib.h>
#define LINE_LENGTH 80

int main()
{
FILE *in1, *in2, *out;
char buffer1[LINE_LENGTH+1], buffer2[LINE_LENGTH+1];
int ch1, ch2;

in1 = fopen("data1.txt", "r");
in2 = fopen("data2.txt", "r");
out = fopen("data3.txt", "w");

if(in1 == NULL || in2 == NULL)
{
    fprintf(stderr, "Cannot open input file - exiting!\n");
    exit(1);
}
if(out == NULL)
{
    fprintf(stderr, "Cannot open output file - exiting!\n");
    exit(1);
}

while( ! feof(in1) ) #Checking for end of file
{
    fscanf(in1, "%d", &ch1);
    fscanf(in1, "%d", &ch2);
    if (ch1 <=  ch2) fputs(ch1, out);
    else fputs(ch2, out);
}

while( ! feof(in2) ) #Checking for end of file
{
    fscanf(in1, "%d", &ch1);
    fscanf(in2, "%d", &ch2);
    if (ch2 <=  ch1) fputs(ch2, out);
    else fputs(ch1, out);
}

fclose(in1);
fclose(in2);
fclose(out);

return 0;

} 
```

希望我涵盖了所有内容，如果您需要更多信息，请告诉我

谢谢！

- - - - - - - 编辑 - - - - - -

我正在尝试使用 fscanf 实现 while 循环，但是 gcc 会抛出错误：“为包含 fputs 函数的每一行传递 'fputs' 的参数 1 使指针从整数而不进行强制转换”。我不应该将 fputs 与 fscanf 一起使用，还是 ch1/ch2 应该是不同的格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:46:25.103

我认为您并不真正了解 fgets 的作用。它读取一行（如果缓冲区足够大）并将其存储到缓冲区中。然后它返回一个指向同一个缓冲区的指针，比较没有意义。您需要读取每个整数并比较它们，您可能希望使用`fscanf(in1, "%d", &n);`将整数读入 n，这将忽略任何空格，并且如果您知道您的文件只包含数字，它将很好用。此外，您正在阅读超出文件末尾的内容`in1`，可能还有`in2`.

再想一想，因为您似乎并不真正了解发生了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:49:44.437

`fgets`用于从流中获取字符串。你最好`fscanf`是阅读整数的用户。我的建议是首先将这些文件读入两个单独的数组，然后对它们进行排序。如果文件变大，保持文件打开可能会导致错误。这是将文件读入整数数组的示例代码。

```
int* readFile(int *array, char *file) {
    FILE *fp = fopen(file, "r");
    int x;
    int i = 0;

    while (fscanf(fp, "%d", &x) == 1) {
        *(array+i) = x;
        i++;
    }
    fclose(fp);

    return array;
} 
```

# ios - 动画 UITableView 的页眉和页脚

> ID：10289317
> 
> 赞同：11
> 
> 时间：2012-04-23T22:43:38.737
> 
> 标签：ios, cocoa-touch, uitableview, animation, core-animation

我正在努力使用动画来动画删除 tableview 的页眉/页脚内容。我相信我可以在标题内容本身上调用 removeFromSuperview，或者只是将标题分配给 nil，但我不知道如何为它设置动画。一个简单的动画块不做任何事情 - 我如何淡入/淡出视图（在这种情况下为标签）？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-24T00:10:21.853

我写了一个如何使用动画块完全删除标题视图的示例。

```
[UIView beginAnimations:nil context:NULL];
[self.tableView setTableHeaderView:nil];
[UIView commitAnimations]; 
```

这当然假设这个动画是在你的 UITableViewController 类中被调用的。

简单地从超级视图中删除标题视图是行不通的，因为表格视图不知道调整自己的大小以填充以前的标题视图。标题视图的设置会导致表格视图自动刷新。

如果这不起作用，请检查 tableView 实例的分配。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-05T12:40:18.063

我最终得到了以下简单的解决方案。它以动画方式删除标题。

```
[self.tableView beginUpdates];
self.tableView.tableHeaderView = nil;
[self.tableView endUpdates]; 
```

我意识到 WINSergey 的回复中提到了这一点，但我发现他的解释有点令人困惑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T01:43:03.393

我发现以下两个选项都可以正常工作：

选项1

```
[UIView animateWithDuration:0.15
                      delay:0.0
        options: UIViewAnimationCurveEaseOut
                 animations:^{deleteLabel.alpha = 0;}
             completion:nil]; 
```

选项 2

```
[UIView beginAnimations:nil context:nil];
deleteLabel.alpha = 0.0;
[UIView commitAnimations]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-14T09:48:15.357

我有同样的问题，我想控制如何删除标题，这是我的方法：

在 ViewDidLoad ：

```
UIView *transView = [[UIView alloc] initWithFrame:CGRectMake(0.f, 0.f, 320.f, 200.f)];
transView.backgroundColor = [UIColor clearColor];
self.headerView = transView;
[transView release];

[self.tableView setTableHeaderView:self.headerView]; 
```

然后当您需要删除标头时：

```
[UIView animateWithDuration:.3f
                      delay:.0f
                    options: UIViewAnimationOptionBeginFromCurrentState
                 animations:^{
                     self.headerView.frame = CGRectMake(0.0f, 0.0f, 320.f, 0.0f);
                 }
                 completion:^(BOOL finished) {
                       [tableView scrollToRowAtIndexPath:[NSIndexPath indexPathForItem:0 inSection:section] atScrollPosition:UITableViewScrollPositionTop animated:YES];
                 }]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T08:46:33.270

这是“按原样”完美地工作，我不关心动画

```
 [myPrettyViewControllerInstance letUpdatePrettyViewNow];
    [[self tableView] beginUpdates];
    [[self tableView] setTableHeaderView:[myPrettyViewControllerInstance view]];
    [[self tableView] endUpdates]; 
```

但如果我们不再需要它

```
 [[self tableView] setTableHeaderView:nil]; 
```

**这就是我们所需要的**，真的（如果它不是淡出 - 检查条件

```
 [[self tableView] setTableHeaderView:nil]; 
```

**我们不需要**

```
 [UIView beginAnimations:nil context:NULL];
    [[self tableView] setTableHeaderView:nil];
    [UIView commitAnimations]; 
```

无

```
 [[self tableView] beginUpdates];
    [[self tableView] setTableHeaderView:nil];
    [[self tableView] endUpdates]; 
```

无

```
 [[self tableView] setTableHeaderView:nil];
    [[self tableView] reloadData]; 
```

不..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-15T04:45:44.557

我必须放 2 个动画才能让它工作。

```
 [UIView animateWithDuration:2.0f animations:^{
        mylbl.alpha = 0.1 ;
    } completion:^(BOOL finished) {
        [UIView animateWithDuration:2.0f animations:^{
            mylbl.alpha = 1.0 ;
        }];
    }]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-06T10:06:18.023

如果有人这样做，我必须混合所有答案才能使其在`UITableView`. 只是做`beginUpdates`而`endUpdates`不是为我添加动画。这允许删除页脚，并且单元格通过动画很好地下降，而不是立即通过混蛋。

```
private func updateFooter(view : UIView?, size : CGFloat){

    UIView.beginAnimations(nil, context: nil)
    mainTableView.beginUpdates()
    mainTableView.tableFooterView = view
    mainTableView.tableFooterView?.frame.size.height = size
    mainTableView.endUpdates()
    UIView.commitAnimations()
} 
```

# asp.net - 用于跟踪用户和点击的 Asp.net HttpModule

> ID：10289322
> 
> 赞同：0
> 
> 时间：2012-04-23T22:44:55.017
> 
> 标签：asp.net, asp.net-mvc-3

我需要记录用户点击和用户代理点击多个 Web 应用程序。我目前正在创建 http 模块来记录 request.servervariables（包括 user_agent）。

这当前记录来自站点的每个请求，即带有 css 的页面将被计为 2 。我可以修改的最佳方式是什么，以便我只为用户记录一次

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:48:52.790

添加cookie并在记录信息之前检查cookie是否存在

# php - PHP & Twig：无法访问模板中的变量

> ID：10289323
> 
> 赞同：5
> 
> 时间：2012-04-23T22:44:55.350
> 
> 标签：php, twig, slim, phpactiverecord

在我的控制器中，我设置了以下变量并将它们传递给 Twig 模板：

```
$data = $model::all(); // returns object [phpactiverecord]
$fields = getFields(); // returns associative array 
```

在我的模板中，我尝试像这样访问它们：

```
{% block rows %}
  {% for row in data %}
            <tr>
    {% for field in fields %}
              <td>{{ row[field.name] }}</td>
    {% endfor %}
            </tr>
  {% endfor %}
{% endblock %} 
```

在这种情况下，$fields 定义为：

```
Array
(
    [0] => Array
        (
            [name] => id
            [display] => Id
        )

    [1] => Array
        (
            [name] => name
            [display] => Name
        )

) 
```

$data 是一个 phpactiverecord 对象的数组。

* * *

如上所述，row[field.name] 没有任何输出。

以下是我更改 row[field.name] 时看到的结果：

```
row.name        -> outputs Value I would expect from row[field.name]
field.name      -> outputs "name"
row['name']     -> outputs nothing
row[field.name] -> outputs nothing 
```

* * *

根据[Twig 站点](http://twig.sensiolabs.org/doc/templates.html)：您可以使用点 (.) 来访问变量的属性（PHP 对象的方法或属性，或 PHP 数组的项），或者所谓的“下标”语法 ([]) ：

关于让它发挥作用的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T02:58:59.330

如果您使用的是 1.2 或更高版本，请尝试使用该[`attribute`](http://twig.sensiolabs.org/doc/functions/attribute.html)功能

```
{{ attribute(row, field.name) }} 
```

它甚至在[您链接到的页面](http://twig.sensiolabs.org/doc/templates.html#variables)上提到...

> 如果要获取变量的动态属性，请改用属性函数。

# java - 具有多个整数值的键的良好哈希码和等于实现

> ID：10289326
> 
> 赞同：3
> 
> 时间：2012-04-23T22:45:27.067
> 
> 标签：java, algorithm

我的哈希图具有这样的键：'2+4+5'、'653+65+1324+75'。（由 + 号分隔的整数值）

什么可能是一个好的哈希码和 equals 方法，以便像“2+4+5”、“5+4+2”、“4+5+2”这样的键......（2、4、5的所有排列）应该返回相同的哈希码值，equals 应该返回 true。

我打算取键中的整数值，对它们进行排序，将它们按升序放入一个字符串中，然后调用该字符串的 hashcode 和 equals 方法。假设如果我有“5+2+4”，那么我会将其更改为“245”并调用字符串 hashcode 和 equals 方法。但这将是一项昂贵的操作，因为每次我都必须进行排序。哈希图中的所有方法，如 put,get... 将再次变得昂贵

有没有其他方法可以在对数或线性时间内做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:49:49.657

一个好的哈希码算法应该为输入的细微差异返回非常不同的哈希值。在您的情况下，您还认为值的排列是“相等的”。

似乎一个好方法是解析组成整数然后对它们进行排序（一种简单的方法来确保比较顺序一致）然后：

如果两个值具有相同的排序成分数，则认为它们相等。

使用经过验证的哈希方法，例如

```
hash = value1 + 31 * value2 + 31 * 31 * value3 + 31 * 31 * 31 * value4 + etc. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:55:50.333

简单而有效：

```
public int hashcode(){
    int hash=5;
    for(int i:array)
       hash=hash*17+i;

    return hash;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T23:07:01.193

```
class Combination {
    final int[] parts;

    Combination(String str) {
        String[] strings = str.split("\\+");
        parts = new int[strings.length];
        for (int i = 0; i < parts.length; i++) {
            parts[i] = Integer.parseInt(strings[i]);
        }
        Arrays.sort(parts);
    }

    @Override public int hashCode() {
        return Arrays.hashCode(parts);
    }

    @Override public boolean equals(Object o) {
        return o instanceof Combination && Arrays.equals(parts, ((Combination) o).parts);
    }
} 
```

测试代码：

```
public static void main(String[] args) {
    Set<Combination> set = new HashSet<>();
    set.add(new Combination("1+2+3"));
    set.add(new Combination("1+2+4"));
    System.out.println(set.contains(new Combination("3+2+1"))); // prints "true"
    System.out.println(set.contains(new Combination("4+2+1"))); // prints "true"
    System.out.println(set.contains(new Combination("4+3+1"))); // prints "false"
} 
```

# c# - 我如何编组列表 ?

> ID：10289333
> 
> 赞同：3
> 
> 时间：2012-04-23T22:46:05.870
> 
> 标签：c#, c++, marshalling

我在 c++ 中有一个 dll，它返回列表，我想在我的 c# 应用程序中使用它作为列表

```
[DllImport("TaskLib.dll", SetLastError = true, CharSet = CharSet.Unicode, CallingConvention = CallingConvention.Cdecl)]
public static extern List<int> GetProcessesID();

public static List<int> GetID()
{
    List<int> processes = GetProcessesID();//It is impossible to pack a "return value": The basic types can not be packed
    //...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:50:02.543

根据贾里德·帕：

> 在任何互操作方案中通常不支持泛型。如果您尝试编组泛型类型或值，PInvoke 和 COM 互操作都将失败。因此，我希望 Marshal.SizeOf 在这种情况下未经测试或不受支持，因为它是 Marshal 特定的功能。

请参阅： [编组 .NET 泛型类型](https://stackoverflow.com/questions/1579559/marshalling-net-generic-types)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-27T22:29:22.113

一种可能的情况

c++端

```
 struct ArrayStruct
    {
        int myarray[2048];
        int length;
    };

    extern "C" __declspec(dllexport) void GetArray(ArrayStruct* a)
    {
        a->length = 10;
        for(int i=0; i<a->length; i++)
            a->myarray[i] = i;
    } 
```

时间：2019-04-10 标签：c#side

```
 [StructLayout(LayoutKind.Sequential, Pack = 1)]
    public struct ArrayStruct
    {
        [MarshalAs(UnmanagedType.ByValArray, SizeConst = 2048)]
        public int[] myarray;
        public int length;
    }

    [DllImport("TaskLib.dll", CallingConvention = CallingConvention.Cdecl)]
    public static extern void GetArray(ref ArrayStruct a);

    public void foo()
    {
        ArrayStruct a = new ArrayStruct();
        GetArray(ref a);
    } 
```

# expressionengine - 每个类别一个频道条目

> ID：10289334
> 
> 赞同：2
> 
> 时间：2012-04-23T22:46:12.317
> 
> 标签：expressionengine

有谁知道在频道：条目标签或自定义查询中显示每个类别一个条目的方法？这必须是动态的，以仅显示每个类别的最新条目，并且并非所有条目都有类别。例如，如果在一个条目列表中，两个或多个分配了相同的类别，则只会显示最新的。

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:45:57.007

简单：列出您的类别，并在每个类别中，从中获取一个条目。如果您有很多类别，请小心，因为查询的数量可能会失控：

```
{exp:channel:categories channel="my_channel" show_empty="no" cache="yes" refresh="60"}
    <h2>{category_name}</h2>
    {exp:channel:entries channel="my_channel" limit="1" category="{category_id}" disable="categories|pagination" cache="yes" refresh="60"}
    <p>{title}</p>
    {/exp:channel:entries}
{/exp:channel:categories} 
```

请注意，在此示例中，如果一个条目分配了多个类别，并且该条目也是每个类别的最新条目，*它将*显示在每个标题下。

# iphone - NSTimeZone 和 NSDate 不能正常工作

> ID：10289340
> 
> 赞同：0
> 
> 时间：2012-04-23T22:46:42.277
> 
> 标签：iphone, ios, nsdate, nstimezone

我不明白如何自动设置 iPhone 的时区，以检索正确的日期，我来自意大利，现在正是：

```
24 April 2012, 00:43 AM 
```

如果我执行 [NSDate date] 来检索 iPhone 上的日期，请给我：

```
23 Aprile 2012, 22:43 AM 
```

怎么可能不给我正确的日期？...我已经在模拟器和 iPhone 上尝试过，问题是一样的...给我两个小时的差异，所以我的问题是如何设置自动为 iPhone 用户所在的地方设置时区？

**编辑：**

我也试过这个：

```
 NSDate *now = [NSDate date];
 NSCalendar *calendar = [[[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar] autorelease];
 calendar.timeZone = [NSTimeZone timeZoneWithAbbreviation:@"GMT"]; 
 NSDateComponents *components = [calendar components:NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit fromDate:now];

  NSDate *today = [calendar dateFromComponents:components]; 
```

我尝试设置 GMT、LocalTimeZone、systemtimezone 和 defaultimezone 的时区，但日期没有改变……我能做什么？

# javascript - 尝试使用 google api v3 从地址获取位置

> ID：10289346
> 
> 赞同：2
> 
> 时间：2012-04-23T22:47:38.917
> 
> 标签：javascript, google-maps, google-maps-api-3, geocoding

我的 html 中有这个 javascript 我想要在这里做的是在给定位置的情况下获取地图表示

```
<script type="text/javascript">
var geocoder;
var map;
function getmaploc() {
    geocoder = new google.maps.Geocoder();
    var myOptions = {
        zoom: 8,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    geocoder.geocode( 'cairo', function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            map.setCenter(results[0].geometry.location);
            var marker = new google.maps.Marker({
                map: map,
                position: results[0].geometry.location
            });
        } else {
            alert("Geocode was not successful for the following reason: " + status);
        }
        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    });
}
</script>

<body onload="getmaploc()">
  <div id="map_canvas"  style="width: 320px; height: 480px;"></div>
</body> 
```

我无法弄清楚这有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T00:09:20.320

有多个错误，

*   省略的大括号
*   先初始化地图
*   geocode() 需要一个 GeocoderRequest 对象作为参数

* * *

固定代码：

```
var geocoder;
var map;
function getmaploc() {
    geocoder = new google.maps.Geocoder();
    var myOptions = {
        zoom : 8,
        mapTypeId : google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

    geocoder.geocode({
        address : 'cairo'
    }, function(results, status) {
        console.log(results);
        if(status == google.maps.GeocoderStatus.OK) {
            map.setCenter(results[0].geometry.location);
            new google.maps.Marker({
                map : map,
                position : results[0].geometry.location
            });
        } else {
            alert("Geocode was not successful for the following reason: " + status);
        }

    });
} 
```

# hadoop - hadoop HDFS blcok 大小注意事项

> ID：10289349
> 
> 赞同：-1
> 
> 时间：2012-04-23T22:48:30.910
> 
> 标签：hadoop

有人可以告诉我设置 HDFS 块大小，以下哪些考虑最不重要。

1.  名称节点上的内存量
2.  名称节点的数量。
3.  将存储在 HDFS 中的文件数
4.  将存储在 HDFS 中的典型文件的大小
5.  namenode 的磁盘容量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T05:00:12.793

我认为重要的是： 1\. namenode 上的内存量 - 更多内存意味着您可以允许更多块，使它们更小。
2\. 总是有一个namenode。辅助名称节点不影响可扩展性。
3.你想要存储的大文件越多，你需要的块就越大。
4\. 使块大小比典型文件大小大得多是没有意义的。换句话说 - 如果您的典型文件是几十 MB - 块大小并不重要。
5\. 通常没关系，因为 NameNode 将所有内容都存储在内存中，而且通常磁盘要大得多。

我会说在大多数情况下更大的块大小会更好，因为您获得了 NameNode 内存，您可以减少映射任务的数量，并且如果有足够的文件要处理 - 在任何情况下您都可以使用所有任务跟踪器。

# asp.net - 在 ASP.NET Web API 中映射 HTTP 路由

> ID：10289351
> 
> 赞同：1
> 
> 时间：2012-04-23T22:49:35.363
> 
> 标签：asp.net, asp.net-web-api

假设我有一个包含订单和订单详细信息的应用程序。我试图弄清楚如何最好地设置架构，以便我可以检索特定订单的所有订单详细信息。拥有这样的 URL 结构看起来既优雅又直观：

```
http://example.com/api/orders/{orderid}/orderdetails 
```

我可以在 global.asax 中注册一条路线：

```
System.Web.Routing.RouteTable.Routes.MapHttpRoute(
  name: "DefaultApi",
  routeTemplate: "api/orders/{orderid}/orderdetails",
  defaults: new { orderid = System.Web.Http.RouteParameter.Optional }
); 
```

但我无法弄清楚这映射到 OrdersController 类中的什么方法。上述路由在我的控制器类中期望什么方法签名？据我所知，这甚至无效，因此请随意推荐一种不同的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T15:12:00.653

我得到它与以下工作。

Global.asax Application_Start：

```
System.Web.Routing.RouteTable.Routes.MapHttpRoute(
 name: "DefaultApi",
 routeTemplate: "api/{controller}/{orderid}/{action}"
); 
```

控制器类：

```
[ActionName("OrderDetails")]
public IEnumerable<OrderDetail> GetOrderDetails(int orderId)
{
 // return data...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T10:24:17.910

看看下面的页面。这会很有帮助 [http://aspnetwebstack.codeplex.com/wikipage?title=Attribute%20routing%20in%20Web%20API](http://aspnetwebstack.codeplex.com/wikipage?title=Attribute%20routing%20in%20Web%20API)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T16:20:18.717

看看惊人的 AttributeRouting.WebAPI 包[http://www.strathweb.com/2012/05/attribute-based-routing-in-asp-net-web-api/](http://www.strathweb.com/2012/05/attribute-based-routing-in-asp-net-web-api/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-12T17:57:14.877

将 System.Web.Http.WebHost dll 引用添加到您的 Web 应用程序中。谢谢你。

# jquery - 无法更改 JQuery Datepicker 属性

> ID：10289355
> 
> 赞同：3
> 
> 时间：2012-04-23T22:49:49.367
> 
> 标签：jquery, asp.net-mvc, jquery-ui, jquery-ui-datepicker

我正在处理的应用程序有一个通用的日期选择器格式设置。所有页面都继承标题中的以下 javascript：

```
$(document).ready(function () {
   $(':input[data-datepicker]').datepicker({ dateFormat: 'mm-dd-yyyy' });
}); 
```

现在我有一个页面，我需要将自己的属性添加到 Datepicker，例如获取 MaxDate 属性设置：

```
Reference:
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.18.min.js")" type="text/javascript">\</script>
.
.
.
// Setting Datepicker properties. 
// ( I want today's date to be the max date a user can pick: )

$(function () {
   $('#addDate').datepicker({ maxDate: 0 });
});
.
.
. 
```

### 呈现的 HTML：

```
<input data-datepicker="True" id="addDate" name="Date" type="text" value="" /> 
```

现在，我没有添加到 $('#addDate').datepicker 的其他属性，例如 MaxDate 或 defaultDate 似乎正在生效。帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T20:42:30.130

奇怪的一个，但我解决了它。当我用一个函数覆盖它而不是使用选项时，它做到了：

```
$('#addDate').datepicker("option", "maxDate", '+0D'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:15:38.833

更改 $('#addDate').datepicker({ maxDate: 0 }); 到

$('#addPriorityDate').datepicker({ maxDate: 0 });

# c++ - 语句无法解析重载函数的地址

> ID：10289363
> 
> 赞同：0
> 
> 时间：2012-04-23T22:50:31.833
> 
> 标签：c++, overloading

我在以下函数中遇到了该错误。有谁知道这意味着什么？

```
template <class T>
void printAll(Array <T> &A){
    for(int i=0; i<31; i++){
        A.M[i].printObj; ///// ERROR
        std::cout<<std::endl;
    }
} 
```

该函数应该打印我所有的对象。`.printObj`有效，因为我在类打印功能中对其进行了测试。谢谢你，如果我可能忘记了更多细节，请询问。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T22:53:16.107

调用的参数丢失。可能，你的意思是

```
 A.M[i].printObj(); 
```

# android - 卸载应用程序时手机死机

> ID：10289366
> 
> 赞同：0
> 
> 时间：2012-04-23T22:51:00.253
> 
> 标签：android, memory

我正在开发一个使用后台服务的 android 应用程序。我对android应用程序开发没有太多经验，这是我的第一个应用程序。我一直在制作许多 alpha 版本，最近对代码进行了重大更改，并且在尝试卸载应用程序时遇到了冻结问题。这个问题在以前的版本中从未发生过，所以我怀疑我所做的更改导致了这个问题。版本更改后，我使用 sqlite 数据库来存储我的一些数据。该表不是那么大，最多只有大约 5 行，但大约有 5 或 6 列。我正在使用两个大小相似的数据库。在以前和当前版本中，我'

我在三款不同的手机上进行了测试；Nexus S、三星 Galaxy S II (I9100) 和三星 Galaxy Mini (S5570)。它在所有手机上运行良好，但是当我尝试在 Galaxy Mini 上卸载应用程序时，手机显示带有进度条的卸载屏幕，然后冻结。屏幕关闭并且不响应任何按钮。如果我稍等片刻，三星标志就会出现，就像它正在重新启动一样，但实际上并没有重新启动。我可以离开该屏幕的唯一方法是长按电源按钮强制关机，或者取出电池然后重新启动手机。

我怀疑这是内存或 CPU 问题，因为这个问题在其他手机上从未发生过。我试图通过观察 logcat 来诊断这个问题，但我没有看到任何致命的错误消息。我曾尝试在市场上安装其他大尺寸的知名应用程序并试图重现该问题，但它会在没有冻结的情况下卸载，所以我很确定是我的应用程序导致了冻结。

我非常感谢任何有关此的帮助或信息。我在我的应用程序中发现了一些内存泄漏，我正在删除它，但我不知道这会如何导致卸载期间冻结。当我检查手机内存时，内存中有 120MB+ 可用空间，我没有使用外部存储器。我注意到的一件事是 CPU 使用率。我使用 SystemPanel 应用程序监控 CPU 时钟和内存，并观察到 ​​Galaxy mini 的 CPU 时钟处于非常高的百分比。

*所以总结一下我的闲逛，*

**问题：**当我尝试卸载我的应用程序时，Galaxy Mini 手机死机。此问题仅发生在 Galaxy Mini（三部手机中）并且仅针对我的应用程序。

**我对原因的猜测：**

*   我的后台服务仍在运行并与卸载冲突（听起来很可能，但这在以前的版本中从未发生过）

*   删除应用程序文件需要很长时间，而且对 Galaxy Mini CPU 来说太费力了（听起来不太可能，因为我的应用程序的最大大小小于 5MB，我尝试卸载大小约为 25MB+ 的愤怒的小鸟）

*   我的应用程序内存泄漏太多，它耗尽了所有堆内存并一直触发 GC，并且由于 Galaxy Mini 是 Froyo，整个手机冻结并导致卡在某个地方（听起来很可能，但当应用程序实际上正在运行）

*   我的手机很糟糕并且讨厌我的应用程序（听起来不太可能但可能）

感谢您花时间阅读一篇相当长的帖子，我非常感谢您对可能的原因或此问题的可能解决方案提供任何意见或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:56:36.937

假设您的应用程序在 Galaxy Mini 上正常运行（例如，CPU 问题仅在卸载期间出现），那么您在 Galaxy Mini 中遇到了一些固件错误。由于您在卸载时无法获得控制权，因此此时您没有责任做任何事情。如果三星在卸载您的应用程序时遇到问题，那是三星的错，而不是您的错。

现在，如果您的应用程序在 Galaxy Mini 上的行为更普遍（例如，当您的应用程序运行时设备运行缓慢），*这*可能表明您的应用程序存在故障，卸载过程通常会加剧这种情况。

# jquery - jquery .hide 使用 {visibility:hidden;} 是否可以使用 {display:none;}

> ID：10289368
> 
> 赞同：-1
> 
> 时间：2012-04-23T22:51:15.957
> 
> 标签：jquery, css, show-hide

据我了解`.hide`在 jquery 中使用 (css)`{visibility:hidden;}`是否有替代使用`{display:none;}`？

一个`{visibility:hidden;}`项目是否仍不占用像素空间，而`{display:none;}`它隐藏该项目并且不占用屏幕上的任何空间

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T22:57:22.353

不，jQuery.hide() 将显示设置为无，这是[FIDDLE的证明](http://jsfiddle.net/adeneo/n3jWM/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:58:03.190

我只是仔细检查了 jquery 代码本身并确认它`.hide`严格使用`display`属性，将其设置为`none`. `Visibility`之后停留`visible`在元素上`.hide`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T22:59:24.563

$(el).hide() 使用 display:none

您还可以创建自己的“隐藏”css 类并使用 jquery .addClass('hide') 或 .toggleClass('hide') 添加/删除它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T22:57:48.303

不，*匹配的元素将立即隐藏，没有动画。这大致相当于调用 .css('display', 'none')，只是 display 属性的值保存在 jQuery 的数据缓存中，以便稍后可以将 display 恢复为其初始值。如果一个元素的显示值为 inline，然后被隐藏并显示，它将再次被显示为 inline。*

[http://api.jquery.com/hide/](http://api.jquery.com/hide/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T22:57:58.423

`.hide()`确实将元素的 CSS 设置为`display:none;`

# android - 是否有允许用户在两 个选项（左或右）之间进行选择的 UI 小部件？

> ID：10289371
> 
> 赞同：2
> 
> 时间：2012-04-23T22:51:24.670
> 
> 标签：android, android-ui

我需要实现一个 UI 元素，用户将使用它在两个选项（左和右）之间进行选择。

类似于 a `seekbar`，但是如果用户一直拖动到一侧或另一侧，它将根据选择的一侧触发一个动作。如果用户在不接触任何一侧的情况下放开，拇指旋钮将弹回中心。

~~我认为这是一个常见的 UI 元素，但我似乎想不出一个例子。~~

**编辑：**类似的元素是 iPhone 锁定屏幕上的滑块。在我的情况下，拇指旋钮将从中间开始，可以向任一方向拖动。

有人知道可能包含这个的库，还是我需要扩展搜索栏来实现它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T04:55:05.107

像这样实现你自己的段控制：

![在此处输入图像描述](../Images/3cf5c4215eadd2a6df74877c60f379b1.png)

该段控件的源代码在[https://github.com/makeramen/android-segmentedradiobutton](https://github.com/makeramen/android-segmentedradiobutton)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:15:50.010

我找不到包含此类 UI 元素的库。如前所述，在视觉上与您想要的最接近的是 a `Switch`，但我认为实现您想要的功能的常用方法是使用 a`RadioGroup`或 a `ListView`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T15:52:25.840

我会创建一个视图的子类，并使用 onTouchEvent() 和 onDraw() 来确定用户触摸的位置并相应地绘制屏幕。

# php - PHP foreach 每第五个项目循环一次

> ID：10289379
> 
> 赞同：-1
> 
> 时间：2012-04-23T22:52:00.810
> 
> 标签：php

我有一个简单的 foreach 循环，例如：

```
foreach ( $posts as $index => $posts ) 
```

还有一个计数器：

```
if( $index % 5 + 1 == 5 ) {
//do something 
} 
```

我每页有 15 个帖子，它应该每第五个项目做一次，但不是在最后一个，但我该怎么做？

所以它变成：

```
POST
POST
POST
POST
POST
DO SOMETHING
POST
POST
POST
POST
POST
DO SOMETHING
POST
POST
POST
POST
POST 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T22:54:48.947

```
if( $index % 5 + 1 == 5 && $index != 14) {
//do something 
} 
```

更改条件，使 $index 不等于数组中的最后一个索引。是 14 还是 15（取决于您是从 0 开始还是从 1 开始）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T22:57:03.687

如果您知道，您有 15 个帖子，并且需要每 5 个但不是最后一个……这意味着您需要用第 5 个和第 10 个“做点什么”，对吗？那么为什么不检查呢？

```
if($index == 4 || $index == 9) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T22:56:39.677

检查范围运算符..对于这种情况非常有用。

```
http://php.net/manual/en/function.range.php

foreach (range(0, $index, 5) as $number) {
    // do something with $posts[$number]
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T23:11:21.603

如果您不需要关联数组：

```
$posts=array(a,b,a,b,a,b,a,b,a,b,a,b,a,b,a);

for($i=0;$i<count($posts);$i++)
{
if($i % 5 + 1 == 5 && $i != count($posts) - 1)
{
echo $i." as ".$posts[$i];
}
} 
```

这将删除所有最后一个帖子，并且每五个帖子只回显一次。

# mysql - 在 sort_buffer_size 太小错误后 Myisam 表不可读

> ID：10289381
> 
> 赞同：0
> 
> 时间：2012-04-23T22:52:23.760
> 
> 标签：mysql, phpmyadmin, myisam, repair

我试图在大约 200GB 10 亿大的记录上运行 OPTIMIZE TABLE，但是在操作后几秒钟，我给出了一个 sort_buffer_size 太小的错误，现在表格在 phpmyadmin 中显示为 0 行，并且仍然有 200gb 的大小。我无法从中读出任何东西。尝试将 sort_buffer_size 提高到 1gb 并再次运行 OPTIMIZE，但操作在几秒钟内完成，但没有成功恢复......

现在我开始运行 REPAIR TABLE。由于这可能需要几天时间才能完成，所以我只是想确保自己朝着正确的方向前进，然后再浪费时间。在我看来，密钥文件已损坏？任何有类似经验可以提供帮助的人将不胜感激！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T19:15:02.030

回答我自己的问题，如果有人碰巧发生了像我这样的愚蠢事情。是的，修复表有效，为了快速使用修复表名称 QUICK 快速重建密钥，而无需触及表中的其他内容。3 亿条记录花了我 1 天时间完成。

# c# - MVC：向控制器返回多行数据

> ID：10289383
> 
> 赞同：2
> 
> 时间：2012-04-23T22:52:33.587
> 
> 标签：c#, asp.net-mvc, vb.net, razor, viewmodel

我有一个包含几行数据的表，我需要将这些数据返回给控制器。在我看来，我最初通过选择时间段并单击按钮来加载表格。该表加载了我所有的相关记录，但我的一个表单元格包含一个下拉列表。所以我应该能够在下拉菜单中进行选择，点击“更新”，我的控制器会保存更改。

所以一切正常，直到我尝试保存。发送到控制器的模型完全为空。我绑定到表格单元格的列表属性返回到控制器 null。

```
 @ModelType SuperViewModel
 //We need this a view model in order to store a List of the models in the table   

 @Using (Html.BeginForm())
 @For Each i in Model.CompleteList
    Dim currentItem = i //MVC auto-generated extra declarations. Seems redundant to me but it works.
 @<table>
 <tr>
 <td>@Html.DisplayFor(function(Model)currentItem.Name)</td>
 <td>@Html.DisplayFor(function(Model)currentItem.SampleTime)</td>
 <td>@Html.DropDownListFor(function(Model)currentItem.WorkTime, ViewBag.WorkTimeList)</td>
 </tr>
 Next
 </table>
 <input name="submit" type="submit" value="Update"/>
 End Using

 //Controller
 <HttpPost()>
 function Save(vmodel as SuperViewModel, submit as String) as ActionResult //NOTE: submit parameter is used because we have two submit buttons but its not relevant here
      if submit = "Update"
            db.Entry(vmodel.CompleteList).State = EntityState.Modified//Here the exception is throw because our list is null at this point even tho its tied to the model in the view.
            db.SaveChanges()
      end if
 End Function 
```

注意：这是用 VB.NET 编写的，但欢迎使用 C# 帮助。我熟悉 MVC 中的两种语言。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:15:56.900

您需要使用 for 迭代器并让视图使用 HTML 元素的索引元素。我不知道 VB.NET 语法，下面是 c# 示例。这允许模型绑定器正确确定视图模型中的元素，以便它可以在回发时重新填充视图模型。

```
<table>
 @For(var i = 0; i < Model.CompleteList.Count; i++) 
{
 <tr>
 <td>@Html.DisplayFor(Model.CompleteList[i].Name)</td>
 <td>@Html.DisplayFor(Model.CompleteList[i]..SampleTime)</td>
 <td>@Html.DropDownListFor(Model.CompleteList[i]..WorkTime, ViewBag.WorkTimeList)</td>
 </tr>
}
 </table> 
```

您的 post 方法应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:37:29.340

我需要查看由 生成的标记中的名称`DropDownListFor`，但我怀疑这是因为`currentItem`您正在绑定`CompleteList`类型，但您的控制器方法需要完整`SuperViewModel`类型。您显示的代码中没有任何地方表明您绑定到该`SuperViewModel`类型。

尝试将您的控制器方法更改为：

```
<HttpPost()>
 function Save(currentItem as CompleteList, submit as String) as ActionResult //NOTE: submit parameter is used because we have two submit buttons but its not relevant here
      if submit = "Update"
            db.Entry(vmodel).State = EntityState.Modified//Here the exception is throw because our list is null at this point even tho its tied to the model in the view.
            db.SaveChanges()
      end if
 End Function 
```

该`WorkTime`属性应使用 DropDownList 中的选定值填充。

**编辑：**更改参数名称以匹配绑定名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:22:24.383

由于参数名称中的某些冲突，它可能会返回 null（所使用的参数名称也必须在其他地方使用）。尝试这个

```
<input name="subButton" type="submit" value="Update"/> 
```

和改变

```
function Save(vm as SuperViewModel, subButton as String) as ActionResult 
```

# ruby-on-rails - 如何发送通知用户收到私人消息

> ID：10289384
> 
> 赞同：3
> 
> 时间：2012-04-23T22:52:42.307
> 
> 标签：ruby-on-rails, notifications, message

我创建了一个消息传递模型，用户可以在其中向另一个用户发送私人消息。但是我不确定如何通知用户他/她收到了新消息。有没有人有办法去做这件事？或者如果有一个简单的解决方案？

```
 def create
       @message = current_user.messages.build
       @message.to_id = params[:message][:to_id]
       @message.user_id = current_user.id
       @message.content = params[:message][:content]
       if @message.save
          flash[:success ] = "Private Message Sent"
       end
       redirect_to user_path(params[:message][:to_id])
    end 
```

我可以告诉发件人发送了一条私人消息，但我不确定如何通知接收者创建了一条新的私人消息。

帮助将不胜感激。谢谢=）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T23:31:06.727

首先，您可以像这样改进您的控制器：

```
def create
  @message = current_user.messages.new(params[:message])

  if @message.save
    flash[:message] = "Private Message Sent"
  end
  redirect_to user_path(@message.to_id)
end 
```

然后，在您的模型中：

```
# app/models/message.rb
class Message < ActiveRecord::Base
  belongs_to :user
  belongs_to :recipient, class_name: 'User', foreign_key: :to_id
  has_many :notifications, as: :event

  after_create :send_notification

private
  def send_notification(message)
    message.notifications.create(user: message.recipient)
  end
end

# app/models/user.rb
class User < ActiveRecord::Base
  has_many :messages
  has_many :messages_received, class_name: 'Message', foreign_key: :to_id
  has_many :notifications
end

# app/models/notification.rb
class Notification < ActiveRecord::Base
  belongs_to :user
  belongs_to :event, polymorphic: true
end 
```

此`Notification`模型允许您存储用户针对不同“事件”的通知。您甚至可以存储通知是否已被阅读，或设置`after_create`回调以便向通知用户发送电子邮件。

此模型的迁移`Notification`将是：

```
# db/migrate/create_notifications.rb
class CreateNotifications < ActiveRecord::Migration
  def self.up
    create_table :notifications do |t|
      t.integer :user_id
      t.string  :event_type
      t.string  :event_id
      t.boolean :read, default: false

      t.timestamps
    end
  end

  def self.down
    drop_table :notifications
  end
end 
```

[您可以在此处](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)阅读有关 Rails 关联选项的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:59:23.513

有多种方法可以通知收件人。您可以有一个发送电子邮件通知的工作进程，或者在您的站点上包含一个“收件箱”，以显示有人在等待多少消息。

您还可以向收件人显示“闪光”消息。例如，您可以通过在基本模板中包含一些代码来检查是否有任何尚未发送通知的未读消息；如果没有，则不会发生任何事情，如果有，则会显示通知，并记录显示通知的事实，以便不会再次显示。

# cmd - 使用包含引号和空格的命令行参数，例如 XML 字符串

> ID：10289385
> 
> 赞同：0
> 
> 时间：2012-04-23T22:52:44.160
> 
> 标签：cmd

我正在编写一个执行 XML 操作的命令行可执行文件。我希望能够在命令行中直接将 XML 字符串作为参数传递，但是我在处理 XML 属性中使用的双引号 (") 时遇到了困难。我尝试使用转义字符 (^")，但是这似乎不起作用。如何格式化参数以正确传递？

这是一个到目前为止不起作用的示例：

```
"<?xml version=^"1.0^" encoding=^"UTF-8^"?><sbml xmlns=^"http://www.sbml.org/sbml/level2/version4^" level=^"2^" version=^"4^"><model metaid=^"_case00001^" id=^"case00001^" name=^"case00001^"></model></sbml>"

<?xml version="1.0" encoding="UTF-8"?><sbml xmlns="http://www.sbml.org/sbml/level2/version4" level="2" version="4"><model metaid="_case00001" id="case00001" name="case00001"></model></sbml> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:00:50.983

通常反斜杠用于转义字符串的 dbl 引号，与解析 xml 不同，因此请尝试使用 \"，或者尽可能用单引号替换它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T15:23:38.783

尝试不使用 qoutes 而是使用 '<' 和 '>'：这适用于我在 cmd 命令行中的测试：

```
 somecommand.exe "^<?xml version="1.0" encoding="UTF-8"?^>^<sbml xmlns="http://www.sbml.org/sbml/level2/version4" level="2" version="4"^>^<model metaid="_case00001" id="case00001" name="case00001"^>^</model^>^</sbml^>" 
```

# macos - OS-X 上的 GNU 链接器-GAS

> ID：10289388
> 
> 赞同：4
> 
> 时间：2012-04-23T22:52:50.633
> 
> 标签：macos, gcc, linker, gnu-assembler, mach-o

我正在尝试编写一些“独立”（[没有操作系统直接运行的程序的名称是什么？](https://stackoverflow.com/questions/10274513/)）代码，并且看到 OS-X 链接器不支持链接器脚本或平面二进制输出，我假设它最好改用 GNU 链接器。

有没有办法在没有所有 GCC 的情况下只安装/编译 GNU 链接器？

编译的 GNU 链接器是否能够理解 OS-X 版本的 GAS 汇编器输出的目标文件？

如果我不能只编译链接器，那么编译 GCC 的最佳方法是什么？

*注意：我要编译，而不是使用包系统。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:27:04.380

为此，我在我的一个实验性宠物内核项目中使用 MacPorts的`cross/i386-elf-gcc`和端口，在我的:`cross/i386-elf-binutils``Makefile`

```
CC=             i386-elf-gcc-4.3.2
AS=             i386-elf-as
LD=             i386-elf-ld 
```

我什至没有尝试混合和匹配来自不同工具链的组件。 您可能能够以某种方式使其工作，但如果您可以安装一组“干净”的交叉编译工具并合理地确保它们可以很好地相互配合~~，那么它似乎不值得麻烦。~~

# c# - 使用序列化的成员类反序列化对象

> ID：10289390
> 
> 赞同：1
> 
> 时间：2012-04-23T22:53:13.470
> 
> 标签：c#, .net, serialization

我有以下课程：

```
[Serializable]
public class A : ISerializable
{

List<B> listOfBs = new List<B>();

public A()
      {
      // Create a bunch of B's and add them to listOfBs
      }

public A(SerializationInfo info, StreamingContext context)
      {
      listOfBs = (List<B>)info.GetValue("listOfBs",typeof(List<B>))
      listOfBs.Remove(x=>x.s==5)
      }

} 
```

和

```
[Serializable]
public class B : ISerializable
{
    public int s;
    public B(int t)
        {
             s=t;
            }

    public B(SerializationInfo info, StreamingContext context)
        {
        s = info.GetInt32("s");
        }

    public void GetObjectData(SerializationInfo info, StreamingContext context)
        {
        info.AddValue("s",s);
        }
} 
```

该问题`line listOfBs.Remove(x=>x.s==5)`引发异常，因为 B 的反序列化构造函数在 A 完成之前不会运行。当我单步执行代码时，A 的 listOfBs 只是一个 NULL 对象的条目，它与 listOfBs 中实际有多少 B 匹配

如何解决这个反序列化序列问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:04:17.013

实现[IDeserializationCallback](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.ideserializationcallback.aspx)。 `IDeserializationCallback.OnDeserialization`当整个对象图的反序列化完成时调用。

我相信 A 类将是实现它的最佳场所，您可以将问题代码`A.OnDeserialization`如下所示。

```
[Serializable]
public class A : ISerializable, IDeserializationCallback
{
  List<B> listOfBs = new List<B>();
  public A()
  {
  // Create a bunch of B's and add them to listOfBs
  }

  public void OnDeserialization()
  {
    listOfBs.Remove(x=>x.s==5)
  }
} 
```

# xslt - 作为键值的元素的 XSLT 转换

> ID：10289396
> 
> 赞同：1
> 
> 时间：2012-04-23T22:54:25.917
> 
> 标签：xslt

我有这个 XML：

```
<Year>
  <Movies>
    <Add>
        <Key>movie1</Key>
        <Value>black</Value>
    </Add>
    <Add>
        <Key>movie2</Key>
        <Value>white</Value>
    </Add>
  </Movies>
</Year> 
```

这需要转换成这个 XML，并以特殊的星号作为起始字符：

```
<Year>
    <MovieList>*movie1-black,movie2-white<MovieList>
</Year> 
```

我已经尝试了几种 xslt 转换的变体，而且我到处都是。这是我最新的 hack。现在在 XML 工具中摆弄这个...

```
<xsl:template match="b:Year">
 <xsl:copy>
   <xsl:for-each select="*">
      <xsl:element name="MovieList">
        <xsl:for-each select="./b:Movies/b:Add">
          <xsl:if test="position() = 1">*</xsl:if>
          <xsl:value-of select="./b:Key"/>-<xsl:value-of select="./b:Value"/>
          <xsl:if test="position() != last()">,</xsl:if>
        </xsl:for-each>
      </xsl:element>
   </xsl:for-each>
  <xsl:apply-templates select="node()"/>
 </xsl:copy>
</xsl:template> 
```

任何 xslt 专家对此有一些指导吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:04:28.033

以下是您可以使用 XSLT 1.0 执行的操作：

```
 <xsl:stylesheet version="1.0"
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
     <xsl:output omit-xml-declaration="yes" indent="yes"/>

     <xsl:template match="Year/Movies">
        <Year>
          <xsl:variable name="movielist">
            <xsl:for-each select="Add">
              <xsl:value-of select="concat(Key, '-', Value, ',')"/>
            </xsl:for-each>
          </xsl:variable>
          <MovieList>
              <xsl:value-of select="concat('*',substring($movielist, 0, string-length($movielist)))"/>
          </MovieList>
        </Year>
    </xsl:template>
</xsl:stylesheet> 
```

鉴于您的输入，它会产生：

```
<Year>
   <MovieList>*movie1-black,movie2-white</MovieList>
</Year> 
```

您可以更巧妙地利用 XSLT 2.0 的`separator`属性，`xsl:value-of`正如在类似示例中所解释的那样：Dimitre 的[concatenation two fields in xsl](https://stackoverflow.com/questions/10215605/concatenation-two-fields-in-xsl)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T02:42:42.730

**I. 这个简单高效的 XSLT 1.0 转换（无变量，无结果后处理）：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
    <Year>
     <xsl:apply-templates/>
    </Year>
 </xsl:template>

 <xsl:template match="Movies">
  <MovieList>
   <xsl:apply-templates/>
  </MovieList>
 </xsl:template>

 <xsl:template match="Add">
  <xsl:value-of select="substring('*,', 2 - (position()=1),1)"/>
  <xsl:value-of select="concat(Key, '-', Value)"/>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<Year>
    <Movies>
        <Add>
            <Key>movie1</Key>
            <Value>black</Value>
        </Add>
        <Add>
            <Key>movie2</Key>
            <Value>white</Value>
        </Add>
    </Movies>
</Year> 
```

**产生想要的正确结果：**

```
<Year>
   <MovieList>*movie1-black,movie2-white</MovieList>
</Year> 
```

* * *

**二、XSLT 2.0 解决方案：**

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
    <Year>
     <xsl:apply-templates/>
    </Year>
 </xsl:template>

 <xsl:template match="Movies">
  <MovieList>
   <xsl:sequence select="'*'[current()/Add]"/>
   <xsl:value-of select="Add/concat(Key, '-', Value)"
        separator=","/>
  </MovieList>
 </xsl:template>
</xsl:stylesheet> 
```

# php - XPATH - 选择节点范围

> ID：10289397
> 
> 赞同：5
> 
> 时间：2012-04-23T22:54:29.837
> 
> 标签：php, xpath

我有以下代码：

```
<div id="mydiv">
    <h1>Some title</h1>
    <p>don't select me</p>
    <p>select me 1</p>
    <p>select me 2</p>
    <p>select me 3</p>
    <p>don't select me</p>
</div> 
```

我需要通过 p[4] 选择 p[2]。

尝试使用此代码，但没有成功：

```
'.//*[@id="mydiv"]/p[preceding-sibling::p[4] and following-sibling::p[2]]' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-23T23:08:16.420

你可以试试：

```
'//*[@id='mydiv']/p[position()>1 and position()<5]' 
```

或者，您的初始代码可以更改为：

```
'//*[@id="mydiv"]/p[preceding-sibling::p and following-sibling::p]' 
```

这样所有`p`具有前面和后面的`p`节点都将被选中（即 p[2] 到 p[4]）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T13:05:53.073

XPATH 也可以写成以下格式：-

```
//p[position()>1 and position()<5] 
```

**或者**

```
//p[position()>=2 and position()<=4] 
```

## 结果：

```
select me 1
select me 2
select me 3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T10:14:16.250

**如果 «p» 的最大数量大于 5，您可能需要使用它：**

`//p[(position() idiv 2) eq 1]`--- 选择奇数节点（根据位置编号）

`//p[(position() idiv 2) eq 0]`--- 选择偶数节点（基于位置编号）

# css - 为什么这个 CSS “菜单”有时会垂直而不是水平呈现？

> ID：10289400
> 
> 赞同：2
> 
> 时间：2012-04-23T22:54:57.603
> 
> 标签：css, html, html-lists

所以，我正在处理的网站有一个水平导航菜单。这是相关的代码。

HTML：

```
<div class="nav">
<ul>
    <a href="index.html">
        <li>Home</li>
    </a>
    <a href="about.html">
        <li>About Us</li>
    </a>
    <a class="active" href="perspective.html">
        <li>Our Perspective</li>
    </a>
</ul> 
```

CSS：

```
.nav ul a li{
    padding: 5px 15px;
    list-style: none;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
    display: inline-block;
}

.nav ul a{
    color: #1d1d1d;
    text-decoration: none;
    font: bold .8em Georgia, "Times New Roman", Times, serif;
}

.nav ul a:hover li{
    background-color: rgba(0, 0, 0, 0.44);
    opacity: 1;
    -moz-box-shadow: -2px 0 2px rgba(0, 0, 0, 0.31), 2px 0 2px rgba(0, 0, 0, 0.31), 0 -2px 2px rgba(0, 0, 0, 0.31), 0 2px 2px rgba(0, 0, 0, 0.31);
    -webkit-box-shadow: -2px 0 2px rgba(0, 0, 0, 0.31), 2px 0 2px rgba(0, 0, 0, 0.31), 0 -2px 2px rgba(0, 0, 0, 0.31), 0 2px 2px rgba(0, 0, 0, 0.31);
    box-shadow: -2px 0 2px rgba(0, 0, 0, 0.31), 2px 0 2px rgba(0, 0, 0, 0.31), 0 -2px 2px rgba(0, 0, 0, 0.31), 0 2px 2px rgba(0, 0, 0, 0.31);
}

.nav ul a.active li{
    background-color: rgba(0, 0, 0, 0.44);
    opacity: 1;
    -moz-box-shadow: -2px 0 2px rgba(0, 0, 0, 0.31), 2px 0 2px rgba(0, 0, 0, 0.31), 0 -2px 2px rgba(0, 0, 0, 0.31), 0 2px 2px rgba(0, 0, 0, 0.31);
    -webkit-box-shadow: -2px 0 2px rgba(0, 0, 0, 0.31), 2px 0 2px rgba(0, 0, 0, 0.31), 0 -2px 2px rgba(0, 0, 0, 0.31), 0 2px 2px rgba(0, 0, 0, 0.31);
    box-shadow: -2px 0 2px rgba(0, 0, 0, 0.31), 2px 0 2px rgba(0, 0, 0, 0.31), 0 -2px 2px rgba(0, 0, 0, 0.31), 0 2px 2px rgba(0, 0, 0, 0.31);
} 
```

您可以在此处查看该网站：[pc.kraigh.com](http://pc.kraigh.com)

因此，出于某种原因，每隔一段时间，列表将垂直呈现，而不是水平呈现。此外，有时（但不总是）每个 li 上都会有项目符号，好像浏览器忽略了 list-style:none。

我的 CSS 选择器是否有问题导致此问题？为什么它只会每隔一段时间发生一次？

注意：要使错误重现，请尝试快速更改页面或刷新页面几次。这是一个（链接到a）屏幕截图，以证明它有时会发生！

[错误截图（Imgur 链接）](http://i.imgur.com/fbuU2.png)

**编辑：**好的，我现在明白它需要去`<ul><li><a>`，但是，我希望整个`<li>`区域都是可点击的——不仅仅是链接文本。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:01:01.983

`<li>`需要是 的直接子代`<ul>`：

这是对的：

```
<ul>
  <li><a href="index.html">Home</a></li>
  <li><a href="about.html">About Us</a></li>
  <li><a class="active" href="perspective.html">Our Perspective</a></li>
</ul> 
```

您可以分配一个`width`and`line-height`以`<li>`使其完全可点击。还有，`padding`有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:59:12.483

我怀疑这与您使用标签包装`<li>`元素的事实有关。`<a>`

应该`<ul><li><a>`

`<li>`标签应该只是持有者，标签应该是可`<a>`点击的部分。玩弄风格，也许像`display: block; padding: 10px;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:01:29.540

JSFiddle 示例：

[http://jsfiddle.net/ZCnbB/2/](http://jsfiddle.net/ZCnbB/2/)

```
<div class="nav">
<ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="about.html">About Us</a></li>
    <li><a class="active" href="perspective.html">Our Perspective</a></li>
</ul>
</div>​ 
```

我稍微修改了css：

```
.nav ul {
    display: block;
    text-align: center;
}

.nav ul li {
    display: inline-block;
} 
```

# c++ - MSVC 是否在 gcc 中提供类似 -Wmultichar 的功能？

> ID：10289401
> 
> 赞同：2
> 
> 时间：2012-04-23T22:55:16.047
> 
> 标签：c++, visual-c++, compiler-warnings

在 MSVC 中使用多字符常量时是否可能出现警告？（类似于`-Wmultichar`gcc 中的东西）。或者，如果有任何替代解决方案可以帮助查找如下代码，请告诉我。

在此代码上编译`W4`未能产生任何警告，而使用 gcc 我可以产生`-Wmultichar`和`-Wtype-limits`：

```
int main()
{
    std::string s = "hello";
    if (s[0] == 'he') {}
} 
```

（我知道，`Wall`但这会产生很多警告，我并没有理会它。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:14:53.513

仅在有限的上下文中——对于以下代码，有两个警告：

```
#include <iostream>

int main()
{
    char x = 'he';
    std::cout << x << '\n';
} 
```

> 警告 C4305：“正在初始化”：从截断`'int'`到`'char'`
> 警告 C4309：“正在初始化”：截断常量值

这些警告可以单独启用而无需启用`/W4`或`/Wall`。

但是，对于您问题中的代码，即使使用`/Wall`.

# iphone - 使用 UIImagePickerController 在照片库中检索选定的图像

> ID：10289403
> 
> 赞同：0
> 
> 时间：2012-04-23T22:55:35.770
> 
> 标签：iphone, objective-c, uiimagepickercontroller, photo

我在使用 UIImagePickerController 时遇到了一点问题......我想使用用户从 iPhone 库中选择的图像，并在实例化我的 viewController 时使用它：

首先，用户必须单击 StartWithImage 按钮：

```
-(IBAction)startWithImage:(UIButton *) sender
{
    self.imgPicker = [[UIImagePickerController alloc] init];
    self.imgPicker.delegate = self;
    self.imgPicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
    [self presentModalViewController:self.imgPicker animated:YES];
}

- (void)imagePickerController:(UIImagePickerController *)imagePicker didFinishPickingMediaWithInfo:(NSDictionary *)info 
{
    [self dismissModalViewControllerAnimated:YES];
    [imagePicker release];
    //UIImage *image = [info objectForKey:UIImagePickerControllerOriginalImage];
    photo =(UIImage *) [info objectForKey:UIImagePickerControllerOriginalImage];
    //code for starting game
} 
```

这就是我实例化我的 viewController 的方式：

```
imageSliderViewController = [[ImageSliderViewController alloc] initWithSize:colMax :rowMax:photo]; 
```

我的视图控制器在 viewDidLoad 中使用照片，如下所示：

```
CGImageRef cgImg = CGImageCreateWithImageInRect(photo.CGImage, CGRectMake(ox, oy, width-1, height-1));//-1 for block effect 
```

我收到 EXC_BAD_ACCESS 错误...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-06T13:24:49.570

好吧，EXC_BAD_ACCESS 通常发生在对象被释放并且我们在某个地方尝试访问该对象时。

尝试这个

```
- (void)imagePickerController:(UIImagePickerController *)imagePicker didFinishPickingMediaWithInfo:(NSDictionary *)info 
{

    //UIImage *image = [info objectForKey:UIImagePickerControllerOriginalImage];
    photo =(UIImage *) [info objectForKey:UIImagePickerControllerOriginalImage];
    //code for starting game

    // dismiss controller after working with it
    [self dismissModalViewControllerAnimated:YES];
    [imagePicker release];
} 
```

# java - 使用有界框进行碰撞检测

> ID：10289407
> 
> 赞同：4
> 
> 时间：2012-04-23T22:55:57.213
> 
> 标签：java, collision-detection, bounding-box

我正在为班级做一个编程项目。我们正在编写游戏爆发，它由一个球、一个桨、四个边缘和砖块组成。球从不同的物体上反弹，当检测到碰撞时，每个物体都会对自己执行不同的操作。下面是我目前不起作用的代码。我正在尝试使用对象的位置（其中心点）来构造一个有界框和每个边缘的值（上、下、左、右）来计算框是否命中。我在脑海中想到，可能存在两种类型的碰撞，一种是拐角碰撞，另一种是一个物体撞到另一个物体中间的某个地方。如果可以，请查看我的代码并提供帮助。我不知道是否有更好的方法来做我想做的事情，但我目前没有

这是代码的一部分，用于检查能够与所有其他可能发生碰撞的对象发生碰撞的每个对象。它还会移动每个对象并计时游戏的时钟。

```
/**
     * Tell the GameWorld that the "game clock" has ticked. A clock tick in the GameWorld has the 
     * following effects: (1) all movable objects are told to update their positions according to there 
     * current heading and speed, (2) the "elapsed game time" is incremented by one and (3) all Items are 
     * checked for a collision.
     */
    public void tickClock() {
        gameClock++;
        Iterator theElements0 = listOfGameObjects.getIterator();
        while (theElements0.hasNext()){
            GameObject gObj = (GameObject) theElements0.getNext();
            if ( gObj instanceof IMovable){
                IMovable mObj = (IMovable)gObj;
                mObj.move(gameClock);
            }
        }
        Iterator theElements1 = listOfGameObjects.getIterator();
        while (theElements1.hasNext()){
            GameObject gObj0 = theElements1.getNext();//get a collidable object.
            if(gObj0 instanceof ICollider){
                ICollider curObj = (ICollider) gObj0;
                //check if this object collides with any OTHER object.
                Iterator theElements2 = listOfGameObjects.getIterator();
                while(theElements2.hasNext()){
                    GameObject gObj1 = theElements2.getNext();
                    if(gObj1 != curObj && gObj1 instanceof ICollider) {
                        ICollider otherObj = (ICollider) gObj1;
                        if (curObj.collidesWith(otherObj)){
                            curObj.handleCollision(otherObj);
                        }
                    }
                }   
            }
        }
        setChanged();
        notifyObservers();
    } 
```

这是代码的一部分，用于确定一个对象是否与另一个对象发生碰撞，以及如果发生碰撞则要采取的适当措施。这段代码专门来自球对象，所以当它撞到砖块时执行的动作是 ySpeed 反转。

```
public boolean collidesWith(ICollider otherObj) {
        GameObject gObj = (GameObject) otherObj;
        //this collider
        int r1 = (int) (getX() + getWidth()/2);
        int l1 = (int) (getX() - getWidth()/2);
        int t1 = (int) (getY() + getHeight()/2);
        int b1 = (int) (getY() - getHeight()/2);

        //the other collider
        int r2 = (int) (gObj.getX() + gObj.getWidth()/2);
        int l2 = (int) (gObj.getX() - gObj.getWidth()/2);
        int t2 = (int) (gObj.getY() + gObj.getHeight()/2);
        int b2 = (int) (gObj.getY() - gObj.getHeight()/2);

        //corner collision check
        if(r1>l2 && t2>b1 && t1>t2 && b1>b2){
            System.out.println("Corner Collision check 1");
            return true;
        }
        if(r2>l1 && t2>b1 && t1>t2 && b1>b2){
            System.out.println("Corner Collision check 2");
            return true;
        }
        if(r2>l1 && t1>b2 && t2>t1 && b2>b1){
            System.out.println("Corner Collision check 3");
            return true;
        }
        if(r1>l2 && t1>b2 && t2>t1 && b2>b1){
            System.out.println("Corner Collision check 4");
            return true;
        }

        //middle collision check
        if(l1>l2 && r1<r2 && t1<t2 && b1<b2){
            System.out.println("middle collision check 1");
            return true;
        }
        if(l1>l2 && r1<r2 && t1>t2 && b1>b2){
            System.out.println("middle Collision check 2");
            return true;
        }
        if(l1<l2 && r1<r2 && t1<t2 && b1>b2){
            System.out.println("middle Collision check 3");
            return true;
        }
        if(l1>l2 && r1>r2 && t1<t2 && b1>b2){
            return true;
        }

        return false;
    }

    public void handleCollision(ICollider otherObject) {
        if(otherObject instanceof Brick){
            System.out.println("Brick Hit");
            ySpeed = -(ySpeed);
        }
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-23T23:14:18.473

您只需要检查边界框的*边缘*。一些伪代码可能看起来像。

```
if Rect1[RIGHT] < Rect2[LEFT] or
   Rect1[LEFT] > Rect2[RIGHT] or
   Rect1[TOP] < Rect2[BOTTOM] or
   Rect1[BOTTOM] > Rect2[TOP]
then return false
else return true 
```

这试图说明的是，如果沿着分隔框的 X 或 Y 坐标系存在任何可能的间隙，则不可能发生碰撞。这是[SAT（分离轴定理）的一个](http://www.codezealot.org/archives/55)*非常*简单的版本

这在视觉上看起来像一个小图像，同样的想法也适用于这里。

![SAT的可视化](../Images/5a260e4f5bba2cea57573c17892fbf03.png)

这应该意味着类似于以下内容的东西应该可以工作。请注意，我尚未对其进行测试，但可以引导您朝着正确的方向前进。

```
public boolean collidesWith(ICollider otherObj) {
    GameObject gObj = (GameObject) otherObj;
    //this collider
    int r1 = (int) (getX() + getWidth()/2);
    int l1 = (int) (getX() - getWidth()/2);
    int t1 = (int) (getY() + getHeight()/2);
    int b1 = (int) (getY() - getHeight()/2);

    //the other collider
    int r2 = (int) (gObj.getX() + gObj.getWidth()/2);
    int l2 = (int) (gObj.getX() - gObj.getWidth()/2);
    int t2 = (int) (gObj.getY() + gObj.getHeight()/2);
    int b2 = (int) (gObj.getY() - gObj.getHeight()/2);

    if (r1 < l2 || l1 > r2 || t1 < b2 || b1 > t2)
       return false;
    else
       return true;

    /* Or could be shortened down to
    return !(r1 < l2 || l1 > r2 || t1 < b2 || b1 > t2) */

} 
```

你不会说代码减少了很多；）

# facebook - 获取我的 Facebook 应用程序的访问令牌

> ID：10289412
> 
> 赞同：1
> 
> 时间：2012-04-23T22:57:11.080
> 
> 标签：facebook, api, access-token

我知道这似乎是以前已经回答过的问题，但我们真的被困在这里和困惑！（经过数小时的研究）

我们有一台服务器需要自动获取我们其中一个页面的洞察信息。我创建了一个 facebook 应用程序，并且作为相关页面管理员的用户已授予应用程序 manage_pages 和 read_insights 权限。

现在，如果我发布到下面的链接，我会得到一个访问令牌，但这不适用于更改见解：（访问令牌是一个相对较短的字符串）

[https://graph.facebook.com/oauth/access_token?grant_type=client_credentials&client_id=APP_ID_HERE&client_secret=APP_SECRET_HERE](https://graph.facebook.com/oauth/access_token?grant_type=client_credentials&client_id=APP_ID_HERE&client_secret=APP_SECRET_HERE)

现在，如果我在以页面管理员身份登录的浏览器中尝试此操作，我将获得正确的访问令牌：

https://graph.facebook.com/oauth/authorize?client_id=[APP_ID]&response_type=token&grant_type=client_credentials&redirect_uri=[REDIRECT]&scope=read_insights,manage_pages

然后，我使用以下方法获取 JSON：

[PAGE_ID]/insights/[METRIC]/lifetime?access_token=[ACCESS_TOKEN]

请帮忙，因为我是 facebook API 的新手，真的需要弄清楚这一点。

似乎所有信息都要求用户登录以获取访问令牌，但我们希望我们的服务器收集我们自己页面的见解。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T06:22:17.720

有两种类型的访问令牌，一种用于用户，另一种用于特定页面（使用页面访问令牌时您充当页面）。

获得具有 manage_pages 权限的用户访问令牌后，您可以使用它从 https://graph.facebook.com/me/accounts?access_token=[USER_ACCESS_TOKEN] 获取页面访问令牌然后使用该令牌您应该能够查询洞察数据。

没有办法保证令牌将继续无限期地工作（离线许可已被弃用，并且在实践中也不是真正无限期的）。当令牌停止工作时，您需要再次手动获取新令牌。

# android - Android : repo 同步 : 下载 >100%

> ID：10289413
> 
> 赞同：1
> 
> 时间：2012-04-23T22:57:21.067
> 
> 标签：android, sync, repository

我正在按照本指南下载 android 源代码树

[http://source.android.com/source/downloading.html](http://source.android.com/source/downloading.html)

现在在“回购同步”之后，它就一直在继续

我看到了这个::

```
Downloading device/samsung/tuna: 452% (556MB/123MB)  
Receiving objects:   7% (154/2030), 2.82 MiB | 120 KiB/s
.
.
.
Downloading device/samsung/tuna: 470% (579MB/123MB)  
Receiving objects:  80% (2783/3471), 13.56 MiB | 104 KiB/s 
```

我真的觉得有些不对劲：-/它怎么能下载到 470%？

我的连接不是很一致，有时会一直关闭（每小时一次），我已经做了很多小时以来的“repo sync -f”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T11:22:37.383

我有同样的问题，它卡在 frameworks/base @ 634% 上。

但是您可以根据以下方式在没有 repo 的情况下下载： [https ://stackoverflow.com/questions/9704844/downloading-the-android-source-not-via-git-repo](https://stackoverflow.com/questions/9704844/downloading-the-android-source-not-via-git-repo)

不完美，但我想对于一个你好世界的 rom 来说还可以。

# c# - 向 Visual Studio XML 文档添加不同的默认和自定义标签

> ID：10289416
> 
> 赞同：6
> 
> 时间：2012-04-23T22:57:36.277
> 
> 标签：c#, xml, documentation, xml-comments, xml-documentation

我只是在学习如何在 Visual Studio 和 C# 中使用 XML 文档功能。

文档中使用的默认 XML 标记是“summary”、“param name”和“returns”。

我想在默认标签中添加“备注”。我还想添加自定义标签。

我浏览了 MSDN、XML 文档教程和 stackoverflow，但还没有找到方法。任何建议都非常感谢，谢谢！

标记

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T02:08:31.873

[该线程](http://social.msdn.microsoft.com/Forums/en-US/xmlandnetfx/thread/96188fd3-957c-4526-a1de-cf3c2bc7be1d)描述了 VB 的解决方案，但表示它不适用于 C#。按照链接投票以将此功能包含在下一版本的 Visual Stuido 中。

# iphone - 从 init 方法调用方法？

> ID：10289417
> 
> 赞同：3
> 
> 时间：2012-04-23T22:57:36.593
> 
> 标签：iphone, objective-c, ios

假设我有两个这样定义的属性：

```
@property (nonatomic, strong) UITableView *parentTableView;
@property (nonatomic, strong) NSMutableArray *headersArray; 
```

和一个方法：

```
-(void)prepareTags; 
```

并说我有一个这样的 init 方法：

```
-(id)initWithParentTableView:(UITableView*)parentTable
{
    if(self = [super init])
    {
        //1
        NSMutableArray *array = [[NSMutableArray alloc] init];
        headersArray = array;
        //2
        self.parentTableView = parentTable;
        //3
        [self prepareTags];
    }
    return self;
} 
```

1.  这是在 init 方法中设置 headers 数组的正确方法吗？
2.  我可以`self.parentTableView`从 init 方法调用吗？
3.  我是否可以从 init 方法调用一个方法（在这种情况下，prepareTags 方法`self`也会调用。`self`即使 init 方法尚未返回，也可以使用了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T23:03:27.873

分别（我会使用列表格式，但我不能让它与块引用一起工作......！）：

### 这是在 init 方法中设置 headers 数组的正确方法吗？

是的，但是没有`array`变量没有意义，您不妨这样做：`headersArray = [[NSMutableArray alloc] init];`

### 我可以`self.parentTableView`从该`init`方法调用吗？

不，引用[有关实用内存管理的 Apple 文档](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html#//apple_ref/doc/uid/TP40004447-SW6)：

> 不要在初始化方法和 dealloc 中使用访问器方法

. 您应该直接访问 ivar（就像您使用 一样`headersArray`）

### 我是否允许从方法调用`init`方法（在这种情况下，`prepareTags`方法也调用`self`。`self`即使`init`方法尚未返回，也可以使用？

是的。请非常小心（您的对象可能尚未完全初始化，它不应该使用访问器方法以符合先前的限制等）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T23:05:03.360

这里不需要使用局部变量：

```
NSMutableArray *array = [[NSMutableArray alloc] init];
headersArray = array; 
```

只需直接分配给实例变量：

```
headersArray = [[NSMutableArray alloc] init]; 
```

> 我可以从 init 方法调用 self.parentTableView 吗？

是的，尽管有些人可能会认为这种设计很糟糕。考虑这样一个事实，即属性有时具有查看其他实例变量的非显而易见的复杂 setter 方法。当您的对象尚未完全初始化时，这样做是否明智？

> 我可以从 init 方法调用方法吗？

和上面一样。只要您不依赖尚未初始化的任何内容，就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:02:40.570

代码看起来很不错。只是几个注释...

```
-(id)initWithParentTableView:(UITableView*)parentTable
{
    // avoid compiler warning about the assignment and the condition in the same statement
    self = [super init];
    if(self)
    {
        //1
        // no need for the extra stack variable
        self.headersArray = [[NSMutableArray alloc] init];

        //2
        // this is all fine from here
        self.parentTableView = parentTable;
        //3
        [self prepareTags];
    }
    return self;
} 
```

# javascript - 如何将 iframe 加载与父页面加载同步

> ID：10289425
> 
> 赞同：2
> 
> 时间：2012-04-23T22:58:45.563
> 
> 标签：javascript, jquery, iframe

我有一个页面，其中有一个 iFrame 从第三方网站加载信用卡付款表格 [PCI 合规性缘故]。

我有两个要解决的问题。

1，页面和iframe以不同的速度加载导致页面闪烁。如何同步 iframe 加载和页面加载？

2，如果第 3 方站点出现故障，我想更换 iframe 或至少将其重定向到其他来源。如何确定 iframe 加载失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:02:35.110

@ #2：在将页面呈现给最终用户之前，使用服务器端技术轮询第 3 方页面 - 然后确定最佳操作方案（显示 iframe（呻吟）或显示“不可用”对话框）

@ #1 - 理想情况下，您可以像上面的（@ #2 解决方案）那样合并一个轮询过程，并在页面可用时简单地绘制页面，或者将其作为异步组件处理，并合并一个轮询过程 + 显示逻辑（如 fadein或动画 - 因为你有 jquery 标记）一旦可用。

# amazon-web-services - 如何使用 Chef 在 VPC 中启动亚马逊 ec2 实例？

> ID：10289439
> 
> 赞同：6
> 
> 时间：2012-04-23T22:59:39.873
> 
> 标签：amazon-web-services, chef-infra, server-administration, amazon-vpc

这是一个主要关于厨师的问题。在使用 Chef 查看 Amazon VPC 内的控制节点时，我遇到了一些困难，主要是 Chef 无法轻松访问没有外部 IP 地址的节点。

我浏览了场景 #2 [http://docs.amazonwebservices.com/AmazonVPC/latest/UserGuide/VPC_Scenario2.html#Case2_Launch_NAT的基本教程](http://docs.amazonwebservices.com/AmazonVPC/latest/UserGuide/VPC_Scenario2.html#Case2_Launch_NAT)

但是，这会超时：

```
knife ec2 server create -N app-server-1 -f m1.small -i rails-quick-start.pem -r "role[base]" -G WebServerSG -S rails-quick-start -x ubuntu -s subnet-580d7e30 -y -I ami-073ae46e -Z us-east-1d 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:26:44.810

为了让刀能够与服务器对话，您可能需要设置 VPN。如果您的 VPC 已经通过 VPN 连接到您的本地网络，那么它应该可以工作，但如果不是，您可能需要运行 OpenVPN 服务器或类似的东西。

您还可以通过其他两种方式设置服务器：

1.  创建一个 EC2 实例并让它启动。然后对它运行刀引导程序。
2.  使用正确的用户数据创建一个 EC2 实例并让 cloud-init 设置它（如果您运行的是包含 cloud-init 的 ubuntu）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T19:40:24.787

解决方案是设置一个隧道，并通过隧道将公共可见计算机的某个端口上的 ssh 连接到云中的所有其他计算机。因此，我的负载均衡器在套接字 80 上提供 http 流量，可通过套接字 22 访问，并使用套接字 2222、2223、2224 ... 将 ssh 隧道连接到非公共云实例。在负载均衡器（或任何公共实例）上运行：

```
ncat --sh-exec "ncat PRIVATE.SUBNET.IP 22" -l 2222 & 
```

例如：

```
ncat --sh-exec "ncat 10.0.1.1 22" -l 2222 & 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-15T01:21:33.573

需要有一种方法将弹性 IP 与实例相关联，以便获得公共 IP 以便于访问，然后通过 EIP 执行所有引导和 SSH 活动。

# svn - SVN Checkout 如何限制仅对用户的访问

> ID：10289440
> 
> 赞同：0
> 
> 时间：2012-04-23T22:59:47.167
> 
> 标签：svn

我在我的 SVN 中有一个项目 :)，这已经活跃了一段时间。

但是，我只希望我公司里的人可以结账。

它没有使用 apache，纯 svn+ssh。

现在只有我的用户可以提交，我取消了**conf/svnserve.conf**中的注释：

```
password-db = passwd 
```

**我在conf/passwd**文件中写了一个用户和密码列表

它适用于提交，因为它在用户提交时要求用户和密码。

我需要它为结帐做同样的事情。

我希望我能够以如此复杂的方式解释如此简单的问题！

非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:07:06.457

[http://svnbook.red-bean.com/en/1.0/ch06s03.html](http://svnbook.red-bean.com/en/1.0/ch06s03.html)

将此行添加到您的 svnserv.conf

匿名访问 = 无

如果您希望人们进行身份验证以结帐。

# jquery - 如何在 jQuery 中检测锚标记的内容是否包含字符串？

> ID：10289442
> 
> 赞同：3
> 
> 时间：2012-04-23T23:00:01.187
> 
> 标签：jquery

我怎样才能检查`<a href="#">sometext</a>`等于某事，试图达到这样的事情：

```
$('a').click(function() {
    if ($("a:contains('sometext')")) {
        alert('sometext');
    }
    else {
        alert('text');  
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T23:01:48.987

```
if (/some regex/.test($(this).text())) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:02:47.933

几乎....要么：

```
$('a:contains("something")').click(function(){
  // pass
}); 
```

仅绑定到具有指定文本的元素，或者：

```
$('a').click(function(){
  if ($(this).text().indexOf('something') !== -1){
    // pass
  }
}); 
```

在单击时进行检查。

# apache-flex - Flex/AIR ComboBox 扩展缓慢

> ID：10289445
> 
> 赞同：0
> 
> 时间：2012-04-23T23:00:22.083
> 
> 标签：apache-flex, air

我正在使用`mx.controls.ComboBox`包含 2-5 个值的 a 。单击 ComboBox 时，可能的选择会在其下方绘制。似乎有某种过渡会慢慢打开 ComboBox。使用 Flex（在浏览器中），打开需要 200-300 毫秒。使用 AIR，它似乎需要更长的时间，并且以生涩的方式打开。

Adobe 的某些人可能认为他们很可爱，但效果（尤其是在 AIR 中）看起来很糟糕。

有没有办法禁用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T02:35:35.680

mx`ComboBox`有两种控制[打开](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/controls/ComboBox.html#style%3aopenDuration)/[关闭](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/controls/ComboBox.html#style%3acloseDuration)持续时间的样式。

```
<mx:ComboBox openDuration="0" closeDuration="0" /> 
```

然而，这部动画表现如此糟糕的事实似乎很奇怪。除了您使用的 Flex SDK 版本之外，您还可以指定这是否是移动 AIR 应用程序。

# c# - 查找物理上存在于同一目录中的服务器上每个单独的网络共享的可用空间

> ID：10289446
> 
> 赞同：0
> 
> 时间：2012-04-23T23:00:43.513
> 
> 标签：c#

我们有一个服务器，它为我们组织中的每个用户提供一个网络共享，以将他们的文件备份到。所有共享都物理地位于同一文件夹中的服务器上。即 D:\UserArchives\user1$，d:\UserArchives\user2$。所有股票都以隐藏的美元符号为后缀。

我正在尝试使用 c# 提取每个用户在各自共享中可用的可用空间量。

我正在使用此处选择的答案枚举共享：[使用 C# 枚举网络共享](https://stackoverflow.com/questions/2091126/enumerating-network-shares-with-c-sharp)。

我一直在尝试使用 GetDiskFreeSpaceEx 从这里提取可用空间：http: [//social.msdn.microsoft.com/Forums/ar-SA/csharpgeneral/thread/b7db7ec7-34a5-4ca6-89e7-947190c4e043](http://social.msdn.microsoft.com/Forums/ar-SA/csharpgeneral/thread/b7db7ec7-34a5-4ca6-89e7-947190c4e043)

如果我以 user1 身份运行我的应用程序，它会为他们的共享提取适量的可用空间，并且我会遇到安全异常，因为他们无法访问 user2 的共享，反之亦然。这是意料之中的。当我将我的应用程序作为可以访问这两个共享的管理帐户运行时，我会取回 user1 + user2 的可用空间量。

这也很有意义，因为 GetDiskFreeSpaceEx 的文档指出：

```
 "Retrieves information about the amount of space that is available on a disk volume, which is the total amount of space, the total amount
 of free space, and the total amount of free space available to the
 user that is associated with the calling thread." 
```

我的问题是如何通过网络在 C# 中实现这一点。我不想要服务器本地的解决方案。

到目前为止我的代码：

```
 static void Main(string[] args)
        {
            string server = "filesvr1";
            try
            {
            //Impersonator is a class for impersonating a different windows account
                using (new Impersonator("UserName", "Domain", "Password"))
                {
                    GetUserShareInfo(server);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine("ERROR: " + ex.Message);
            }
        }
        static void GetUserShareInfo(string server) 
        {
            ShareCollection shi;
            if (server != null && server.Trim().Length > 0)
            {
                Console.WriteLine("\nShares on {0}:", server);
                shi = ShareCollection.GetShares(server);
                if (shi != null) 
                {
                    foreach(Share si in shi) 
                    {
                        // If you don't have permissions to the share you will get security exceptions.
                        if (si.IsFileSystem) 
                        {
                            string userName = si.NetName.Substring(0, si.NetName.Length - 1);
                            try
                            {
                                //Network Share Size
                                Console.WriteLine(FreeSpace("\\\\" + server + "\\" + si.Root.Name));
                            }
                            catch (Exception ex)
                            {
                                Console.WriteLine(userName + " - " + ex.Message);
                            }
                        }
                    }
                }
                else
                    Console.WriteLine("Unable to enumerate the shares on {0}.\n"
                        + "Make sure the machine exists, and that you have permission to access it.", server);
            }
        }

   public static long FreeSpace(string folderName)
        {
            if (string.IsNullOrEmpty(folderName))
            {
                throw new ArgumentNullException("folderName");
            }

            if (!folderName.EndsWith("\\"))
            {
                folderName += '\\';
            }

            long free = 0, dummy1 = 0, dummy2 = 0;

            if (GetDiskFreeSpaceEx(folderName, ref free, ref dummy1, ref dummy2))
            {
                return free;
            }
            else
            {
                return -1;
            }
        }

        [SuppressMessage("Microsoft.Security", "CA2118:ReviewSuppressUnmanagedCodeSecurityUsage"), SuppressUnmanagedCodeSecurity]
        [DllImport("Kernel32", SetLastError = true, CharSet = CharSet.Auto)]
        [return: MarshalAs(UnmanagedType.Bool)]
        private static extern bool GetDiskFreeSpaceEx
        (
            string lpszPath,                    // Must name a folder, must end with '\'.
            ref long lpFreeBytesAvailable,
            ref long lpTotalNumberOfBytes,
            ref long lpTotalNumberOfFreeBytes
        ); 
```

# c# - 请调试错误消息。DbArithmeticExpression 参数必须具有数字通用类型

> ID：10289455
> 
> 赞同：3
> 
> 时间：2012-04-23T23:01:41.250
> 
> 标签：c#, linq, entity-framework

我正在尝试删除表中所有超过 3 小时的项目，但出现以下错误...

DbArithmeticExpression 参数必须具有数字通用类型。

```
// Method to clean items in baskets table which are over 3 hours old.
public void CleanBasket()
{
    var expired = (from a in db.Baskets
                   where (DateTime.Now - a.DateCreated).TotalHours > 3  select a);
    foreach (Basket basket in expired) db.DeleteObject(expired);
    db.SaveChanges();
} 
```

我以前从未见过这个错误，有人可以帮我调试吗？

仅供参考，我也尝试过... var expired = (from a in db.Baskets where (DateTime.Now.Subtract(a.DateCreated).Hours > 3) select a);

但我收到错误消息“LINQ to Entities 无法识别方法 'System.TimeSpan Subtract(System.DateTime)' 方法，并且此方法无法转换为存储表达式。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:03:03.993

EF 不支持`DateTime - DateTime`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-12T02:41:41.607

您需要按照此答案 使用[System.Data.Entity.DbFunctions.DiffHours ：](http://msdn.microsoft.com/en-us/library/system.data.entity.dbfunctions%28v=vs.113%29.aspx)

[https://stackoverflow.com/a/9860858/345659](https://stackoverflow.com/a/9860858/345659)

```
var expired = (from a in db.Baskets
               where DbFunctions.DiffHours(DateTime.Now, a.DateCreated) > 3
               select a); 
```

# math - 我在哪里可以找到真正的 FFT 和 iFFT 实现？

> ID：10289458
> 
> 赞同：1
> 
> 时间：2012-04-23T23:01:55.390
> 
> 标签：math, audio, image-processing, fft, complex-numbers

我有一个复杂到复杂的 FFT，但我需要一个真实到真实的 FFT 实现......

这是因为我的噪声消除算法适用于频域中的实数，而不是复数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T01:12:15.763

唯一适用实数到实数 FFT 的情况是您的时域信号是对称的 ( `x(n) = x(N-n), n=1...N-1`)。这是 FFT 的实际输入导致实际输出的唯一情况。否则，实际输入仍会导致 FFT 的复数输出。

真实到真实的 FFT 非常罕见，通常不会专门实施。它们只是用实数到复数的 FFT 执行，丢弃了虚输出，因为它无论如何都是零。

您正在使用的期望真实频域数据的噪声消除算法是什么？它是否期望复杂样本的大小？我们需要更多地了解噪声消除算法在做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-06T14:26:36.927

FFTW3 库有一个真正的 FFT 2 实实现。`fftw_plan fftw_plan_r2r_1d()` [http://www.fftw.org/fftw3_doc/Real_002dto_002dReal-Transforms.html](http://www.fftw.org/fftw3_doc/Real_002dto_002dReal-Transforms.html)

# python - 在 Python 类中排序方法的好方法是什么？

> ID：10289461
> 
> 赞同：114
> 
> 时间：2012-04-23T23:02:09.523
> 
> 标签：python

我想对 Python 类中的方法进行排序，但我不知道正确的顺序是什么。

当我在[Eclipse](https://en.wikipedia.org/wiki/Eclipse_%28software%29)中使用[PyDev](https://en.wikipedia.org/wiki/PyDev)提取方法时，Eclipse 会将提取的方法放在修改后的方法之上。但这会将较低级别的细节放在较高级别的细节之前。根据[鲍勃叔叔](https://en.wikipedia.org/wiki/Robert_C._Martin)的说法，我应该做相反的事情，这样我的代码读起来就像报纸的头条新闻。当我用[Java](https://en.wikipedia.org/wiki/Java_%28programming_language%29)编程时，我只是听从他的建议。

Python的最佳实践是什么？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2016-05-01T14:17:35.983

正如其他人指出的那样，没有正确的方法来订购您的方法。也许 PEP 建议会很有用，但无论如何。让我尽量客观地回答你的问题。

*   **接口优先：**公共方法和 Python 魔术函数定义了类的接口。大多数时候，您和其他开发人员想要使用一个类而不是更改它。因此他们会对该类的接口感兴趣。将它放在源代码的首位可以避免滚动浏览您不关心的实现细节。

*   **属性、[魔术方法](https://rszalski.github.io/magicmethods/)、公共方法：**很难定义这三者之间的最佳顺序，它们都是类接口的一部分。正如[Ethan Furman 所说](https://stackoverflow.com/questions/10289461/what-is-a-good-way-to-order-methods-in-a-python-class/10289641#10289641)，在整个项目中坚持使用一个系统是最重要的。一般来说，人们期望`__init__()`在课堂上最好的第一个函数，所以我跟进下面的其他魔术方法。

*   **阅读顺序：**基本上，讲故事有两种方法：自下而上或自上而下。通过将高级函数放在首位，开发人员可以通过阅读前几行来粗略地了解该类。否则，必须阅读整个课程才能了解该课程，而大多数开发人员没有时间这样做。根据经验，将方法放在从其主体调用的所有方法之上。

*   **类方法和静态方法：**通常，上面解释的*阅读顺序*暗示了这一点。普通方法可以多次调用所有方法，因此优先。类方法只能调用类方法和静态方法，然后来。静态方法不能调用类的其他方法并排在最后。

顺便说一下，这些规则中的大多数都不是特定于 Python 的。我不知道强制方法顺序的语言。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-23T23:22:16.730

没有一个正确的顺序。选择一个系统并坚持下去。我使用的是：

```
class SomeClass(object):

    def __magic_methods__(self):
        "magic methods first, usually in alphabetical order"

    def _private_method(self):
        "worker methods next, also in alphabetical order"

    def a_method(self):
        "then normal methods, also in alphabetical order" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-23T23:28:31.537

我做的事情类似于我在 Django 的源代码中看到的[Ethan ，主要区别在于大的“############”块注释来分隔区域。](https://stackoverflow.com/questions/10289461/what-is-a-good-way-to-order-methods-in-a-python-class/10289641#10289641)

例如，

```
class SomeClass(object):

    #################
    # Magic Methods #
    #################
    def __magic_methods__(self):
        "magic methods first"

    ##################
    # Public Methods #
    ##################
    def a_method(self):
        "then normal methods, in order of importance"

    ###################
    # Private Methods #
    ###################
    def _private_method(self):
        "then worker methods, grouped by importance or related function" 
```

显然，这对于较小的班级不太有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-08-16T12:27:44.227

编码

```
class Bar(_Foo):
    pass

class _Foo:
    pass 
```

引发异常，因为`_Foo`必须在使用之前定义类。您也可以找到类似的函数异常引发示例：

```
def bar(f=_foo):
    pass

def _foo():
    pass 
```

鉴于这些示例，通常在公共类和函数之前定义私有类和函数是有意义的。**这就是为什么保持一致性并在公共方法之前**定义私有方法是有意义的。

# javascript - 富文本输入（不是 textarea）插件

> ID：10289463
> 
> 赞同：5
> 
> 时间：2012-04-23T23:02:21.253
> 
> 标签：javascript, jquery, richtext

有很多富文本编辑器，但我只想为单行文本输入添加一些粗体、斜体和下划线功能。是否有任何可用的插件？（最好是 jQuery，但任何工作）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T18:16:24.637

谷歌搜索给了我这些人：

*   一个轻量级的 RTE jQuery 插件： [http ://batiste.dosimple.ch/blog/posts/2007-09-11-1/rich-text-editor-jquery.html](http://batiste.dosimple.ch/blog/posts/2007-09-11-1/rich-text-editor-jquery.html)
*   标记！通用标记 jQuery 编辑器：http: [//markitup.jaysalvat.com/home/](http://markitup.jaysalvat.com/home/)
*   所见即所得的 jQuery 插件： [https ://github.com/akzhan/jwysiwyg](https://github.com/akzhan/jwysiwyg)

它们都非常基本但功能强大，您可以将其大小调整到几乎一行。

编辑：否则使用 j08691 所述的 bbcodes。

# c++ - 虚拟析构函数会是一件坏事吗？

> ID：10289465
> 
> 赞同：4
> 
> 时间：2012-04-23T23:02:37.963
> 
> 标签：c++

即使不需要，我也总是用虚拟析构函数标记我的类。除了可能对性能造成很小的影响之外，是否存在这样一种情况：当您不需要一个虚拟析构函数时会导致内存错误或一些可怕的事情？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-23T23:09:02.050

使所有类都可扩展是一个**基本缺陷。**大多数类根本*不适合*从中继承，**如果您不预先设计用于扩展的类，那么**促进这一点是没有意义的。

这只是在**误导**API 的用户，他们会将此作为类是有意义可继承的暗示。实际上，这种情况很少发生，不会带来任何好处，或者在最坏的情况下会破坏代码。

一旦你让一个类可以继承，你的余生就已经适应了它：你*不能改变它的 interface*，你*绝不能破坏它的（隐式！）语义*。本质上，这门课不再是你的了。

另一方面，无论如何，继承被高估了。除了用于公共接口（纯虚拟类）之外，您通常应该更喜欢组合而不是继承。

另一个不希望使用虚拟析构函数的更基本的情况是，当您拥有的代码**需要[POD](http://en.wikipedia.org/wiki/Plain_old_data)**才能工作时——例如在`union`.它们可以非常有效地复制）。[给安迪的帽子小费]

关于**性能开销**的一句话：在某些情况下会创建大量小对象，或者在紧密循环中创建对象。在这些情况下，虚拟析构函数的性能开销可能是一个严重的错误。

具有虚函数表的类也*比*没有虚函数表的类大，这也会导致不必要的性能影响。

**总而言之，没有令人信服的理由让析构函数虚拟化，也没有令人信服的理由不这样做。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T23:10:15.083

如果您不打算从该类继承（或者如果该类不打算从该类继承），则将其声明为虚拟是没有意义的。
另一方面，如果你想多态地访问这个类，那么是的，虚拟析构函数是一件好事。

但是要准确回答您的问题，它不会导致任何“可怕的内存错误”并且一直将其标记为虚拟并不会真正伤害您。

但我认为没有理由一直使用虚拟析构函数。由你决定。

此外， Herb 的[这篇](http://www.gotw.ca/publications/mill18.htm)文章也为这个问题带来了一些启示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:12:45.753

不，AFAIK。虚拟析构函数的行为方式与非虚拟析构函数完全相同（即虚拟和直接调用调用相同的函数），或者您得到未定义的行为。因此，您不能通过将非虚拟析构函数更改为虚拟析构函数来“做一些可怕的事情”。

但是，它可以暴露由代码的其他部分引起的错误，即。当您不小心覆盖了对象的虚拟表指针时。

# mongoid - 是否可以无条件地做 Model.first

> ID：10289467
> 
> 赞同：1
> 
> 时间：2012-04-23T23:02:40.730
> 
> 标签：mongoid

我想问我是否想在mongoid中获取表中的第一行，是否可以编写Model.first？不输入任何条件？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T23:14:51.327

是的，`Model.first`在 Mongoid 中按预期工作。

只是我运行的应用程序的一个简单示例：

```
Loading development environment (Rails 3.1.0)
1.9.2p290 :001 > Hotel.first
 => #<Hotel _id: 4e94e8ab7d1645d6be00003c, _type: nil, created_at: 2011-10-12 01:08:59 UTC, updated_at: 2011-12-01 00:40:59 UTC, deleted_at: nil, name: "A hotel", code: "0545"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T13:13:14.590

是的， `User.first` 肯定会奏效。有关查询中的更多选项，您可以[在此处参考文档](http://mongoid.org/en/mongoid/docs/querying.html#queries)

# android - android 3.0 及更高版本中的一个活动中的两个 ListView

> ID：10289473
> 
> 赞同：0
> 
> 时间：2012-04-23T23:02:53.797
> 
> 标签：android, android-listview

在Android中`2.1`，`2.3`它工作正常。但是for`3.0`及以上`findViewById`并没有找到第二个`ListView`。我已经尝试过清理项目，也尝试过不使用`ListActivity`，没有任何帮助。有任何想法吗？

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);
    setListAdapter(List1Adaptor);
    list1 = (ListView) findViewById(android.R.id.list);

    list2 = (ListView) findViewById(R.id.ListView2);
    list2.setAdapter(List2Adapter);//Null Pointer
} 
```

main.xml

```
<LinearLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
     android:id="@+id/linearLayout1"
     android:layout_width="fill_parent"
     android:layout_height="fill_parent"
     android:orientation="vertical" >
 <ListView
     android:id="@+id/ListView2"
     android:layout_height="wrap_content"
     android:layout_width="fill_parent" >
 </ListView>

</LinearLayout>
<RelativeLayout
android:id="@+id/listLayout_relativeLayout2"
android:layout_height="320dp"
android:layout_width="fill_parent" >

<ListView            
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >
</ListView>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T23:06:06.733

您的布局有`android:id="@+id/listView2"`（注意：小写“l”）并且您的 Java 代码正在请求`R.id.ListView2`（注意：大写“L”）。尝试在这两种情况下使用相同的案例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:47:16.597

您的 xml 文件缺少根视图。我很惊讶它适用于任何版本的 Android。你应该用线性布局或类似的东西包围一切。

# python - 强制使用 raw_input

> ID：10289477
> 
> 赞同：3
> 
> 时间：2012-04-23T23:03:10.023
> 
> 标签：python

我将如何实现以下内容：

```
title_selection = raw_input("Please type in the number of your title and press Enter.\n%s" % (raw_input_string))
if not title:
    # repeat raw_input 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-23T23:04:49.177

```
title_selection = ''
while not title_selection:
  title_selection = raw_input("Please type in the number of your title and press Enter.\n%s" % (raw_input_string)) 
```

有必要`title_selection`像`''`以前一样定义，这意味着空（也是False）。`not`意志使真`False`（否定）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-23T23:07:57.897

这通常通过中间带有 a 的“循环半”结构来`break`完成：

```
while True:
    title_selection = raw_input("Please type in the number of your title and press Enter.\n%s" % (raw_input_string))
    if title_selection:
        break
    print "Sorry, you have to enter something." 
```

此方法使您可以轻松打印一条消息，告诉用户程序期望什么。

# sqlite - Sqlite：不会显示多个结果

> ID：10289480
> 
> 赞同：0
> 
> 时间：2012-04-23T23:03:20.617
> 
> 标签：sqlite, select

我有两张表 1\. 大洲列表 2\. 属于 6 个大洲的国家。在我的应用程序中，我想在表格视图中显示大陆名称和属于该大陆的国家/地区。我目前的选择：

```
SELECT cont.continentID,cont.continentName,cont.continentImage,(select contr.countryName   from countries as contr where contr.relativeToContinent=cont.continentID) as 'hash'\
    FROM Continents as cont 
```

坦率地说，我期待看到完整的国家列表，因为从国家中选择 contr.countryName 作为 contr where contr.relativeToContinent=cont.continentID select，是的，检索完整列表，但是当所有选择组合在一起时，我是仅从列表中获取第一个国家/地区。如何解决这个问题呢？先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T20:14:53.910

给我们一个数据库示例（只需使用 导出所有数据库`sqlite3 db.sqlite .dump`）然后我们可以自己尝试一下。我认为这可以通过加入或其他方式来完成。

# node.js - Incr 似乎运行了两次——为什么？

> ID：10289484
> 
> 赞同：2
> 
> 时间：2012-04-23T23:04:21.507
> 
> 标签：node.js, redis

我很难让节点、redis 和异步来做我想做的事。我正在尝试非常基本的东西来掌握重定向控制流的模式。`key0 > key1`在这里，我持有一个计数器变量“成功”，如果比较为真，该变量会增加一。它们现在是静态的，所以它总是正确的；我唯一想改变的是增加`success`. 我刷新浏览器以重新运行比较并`success`再次递增。

**我的麻烦是：当页面刷新时，`success`跳转 2。**我尝试使用 回调`incr`，但看起来只有`get`-type 命令有回调。我的脚本中有一个`client.end();`，但它阻止我重新加载页面，所以我将其注释掉。我怀疑这是我问题的根源。如果有，`client.end`属于哪里？

```
var http = require("http");
var redis = require("redis");
var async = require("async");

client = redis.createClient();

http.createServer(function(request, response) {
        // key "success" set to 0 externally, through redis-cli;
        client.set("key0", "19");
        client.set("key1", "11");

        response.writeHead(200, {"Content-Type": "text/plain"});

        async.series([
              shortcut("key0"),
              shortcut("key1"),
              shortcut("success")
             ],

             function(err, results){
                 if (results[0] > results[1]) {
                     client.incr("success", function(err, reply) {
                             response.write("incr done");
                         });
                     response.write(results[0] + "\n\n");
                     response.write(results[1] + "\n\n");

                     response.write(results[2]);
                 }
                 response.end();
                 // client.quit();
         });
    }).listen(8000);

function shortcut(key) {
    return function(callback) { 
        client.get(key, function(err, reply) { 
                          callback(null, reply); 
                        }
                  ); 
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T23:08:12.877

您的浏览器最有可能请求`favicon.ico`并因此生成第二次运行您的代码的额外请求。

# haskell - Haskell 提前退出状态单子（守卫？）

> ID：10289486
> 
> 赞同：3
> 
> 时间：2012-04-23T23:04:25.827
> 
> 标签：haskell, monads, monad-transformers, alternative-functor

我有一个代表我的应用程序游戏状态的类型，对于这个问题，假设它很简单，例如：

```
Game { points :: Int } 
```

我用 State monad 定义我的游戏逻辑。

```
type GameState a = StateT Game a

addPoints :: Int -> GameState ()
addPoints num = do
    Game p <- get
    put $ Game (p+num) 
```

我希望能够简单地丢弃一些输入

```
evenResult num = do
    Game p <- get
    return $ even (p + num) 

addPoints num = do
    isEven <- evenResult num
    if isEven then return () else do
    Game n <- get
    put $ Game (n+num) 
```

我想要一个看起来像这样的语法

```
addPoints num = do
    guard evenResult
    ...

-- or this
addPoints num = do
    guardIsEvenResult
    ... 
```

**如果它击中守卫，我希望它独自离开状态，并且在 block 中什么也不做**。

我该怎么做？使用 MonadPlus似乎很*接近*可能，但我不确定我是否可以使用 mzero 来表示“返回你已经拥有的状态”。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T23:11:44.073

在. `Control.Monad.Trans.Maybe`_ [`MaybeT`](http://hackage.haskell.org/packages/archive/transformers/latest/doc/html/Control-Monad-Trans-Maybe.html)_ `StateT`然后，您可以使用[`mzero`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad.html#t:MonadPlus)中止计算，或者像 Kevin Ballard 所说的那样，如果is 则`[guard](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad.html#v:guard) condition`停止；您所要做的就是将每个块包含在. （请注意，您要么必须在 monad 上定义的每个选项，要么更改它们的类型以使用具有所需状态的任何 monad，例如。）`condition``False``runMaybeT``lift``StateT``operation :: (MonadState m Game) => ...`

请注意，即使您不直接使用它，您也可能拥有其中包含的`transformers`包；包含标准 monad 模块（如）`Control.Monad.Trans.Maybe`的包依赖于它。`mtl``Control.Monad.State`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:40:32.073

我*想*我是在充实养猪工人对这个问题的评论。

```
ensure :: GameState Bool -> GameState () -> GameState ()
ensure p k = do 
  t <- p 
  when t k

addPoints num = do
  ensure (evenResult num) $ do
  ... 
```

哪个足够接近。我确信 ehird 的答案更正确，但它似乎也比我想要的复杂得多。还有很多东西要学:)

# javascript - 如何像 Facebook 一样在新窗口中上传视频？

> ID：10289489
> 
> 赞同：0
> 
> 时间：2012-04-23T23:04:42.037
> 
> 标签：javascript, html, file-upload

当您将视频上传到 Facebook 时，它会弹出一个带有加载栏的新窗口，您可以继续正常使用该应用程序。我该怎么做类似的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:15:07.477

您应该在 Javascript 中使用 window.open 函数。或在 _blank 窗口中打开的表单 :) 这取决于您真正想要做什么 :)

这是一个小例子：

```
onsubmit="target_popup(this)" as a form attribute 
```

和 javascript 函数应如下所示：

```
function target_popup(form) {
    window.open('', 'formpopup', 'width=400,height=400,resizeable,scrollbars');
    form.target = 'formpopup';
} 
```

# c++ - 使用 boost 获取文件的所有者和组

> ID：10289491
> 
> 赞同：4
> 
> 时间：2012-04-23T23:04:51.590
> 
> 标签：c++, boost, boost-filesystem, fstat

我想使用 boost::filesystem 从文件中获取所有者和组，但从未找到任何方法。

我可以获得文件的权限，但由于我不知道文件的所有者，这并不意味着什么。

我找到了 posix fstat 函数，但我还是想使用 boost 或其他 C++ 库而不是 C 函数。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-23T23:10:58.873

你要求做的是一个 Unix 系统调用。但你不想叫它？为什么？boost可以提供什么可能的价值？这不是可移植性，因为 Unix 之外的任何东西都不会有有意义的 st_gid 字段。

# rest - Sugarcrm REST get_entry

> ID：10289493
> 
> 赞同：0
> 
> 时间：2012-04-23T23:05:00.463
> 
> 标签：rest, sugarcrm

有人可以看看我是如何设置这个 REST 调用的吗？我找不到这样的例子，我无法让它工作。

它可能是空白的 'link_name_to_fields_array' 参数。我已阅读文档并不太了解该参数。我不知道这是否导致了我的问题。

任何帮助将不胜感激。

```
//SET UP CURL
$curl = curl_init($url);
curl_setopt($curl, CURLOPT_POST, true);
curl_setopt($curl, CURLOPT_HEADER, false);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);

//parameters for get_entry call (I received a session id from a call to the login function.  Using it here)
//I manually got this user 'id' form the sugarcrm database
$parameters = array(
         'session'=>$result->id,
         'module_name' => 'users',
         'id' => '21a6a633-40de-9bf4-aa14-4f8753ea5aa2',
         'select_fields' => array('user_name'),
         'link_name_to_fields_array'=> array()
 );

$json = json_encode($parameters);
$postArgs='method=get_entry&input_type=JSON&response_type=JSON$rest_data=' . $json;
curl_setopt($curl,CURLOPT_POSTFIELDS, $postArgs);
$result2 = curl_exec( $curl );
echo("<pre>" . print_r($result2,true) . "</pre>"); 
```

输出为“ **Bad data pass in; Return to Home** ”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T07:01:32.533

您在 postArgs 行中有错误（替换`$rest_data`为`&rest_data`）。试试这个：

```
$postArgs='method=get_entry&input_type=JSON&response_type=JSON&rest_data=' . $json; 
```

# html - 为什么 colgroup/col 在 Chrome 中不起作用

> ID：10289494
> 
> 赞同：5
> 
> 时间：2012-04-23T23:05:01.033
> 
> 标签：html, internet-explorer, google-chrome, cross-browser

[我上一个问题](https://stackoverflow.com/questions/10255588/is-there-any-way-to-center-certain-columns-in-table)的答案之一是 colgroup/col 应该只在 IE 中工作。

我写了一个适用于 IE9 的示例（见下文）（将单元格内容集中在第 3 列），但不适用于最新版本的 Chrome。

我做错了什么？

HTML 示例：

```
<html>
<head><title>test table centerring</title></head>
<body>

    <table border="1">
        <colgroup>
            <col/>
            <col/>
            <col align="center">
        </colgroup>
        <thead>
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Value</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>Name 1</td>
                <td>Value 1</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Name 2, Name 2, Name 2, Name 2</td>
                <td>Value 2</td>
            </tr>
            <tr>
                <td>3</td>
                <td>Name 3</td>
                <td>Value 3</td>
            </tr>
            <tr>
                <td>4</td>
                <td>Name 4</td>
                <td>Value 4, Value 4, Value 4, Value 4</td>
            </tr>
        </tbody>
    </table>        

</body></html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T02:52:31.430

实际上，我很确定只有 IE 支持这一点，但对问题的答案之一感到困惑[是否有任何方法可以使表格中的某些列居中？](https://stackoverflow.com/questions/10255588/is-there-any-way-to-center-certain-columns-in-table). 答案的作者还指出了一些限制： [http ://www.quirksmode.org/css/columns.html](http://www.quirksmode.org/css/columns.html)

> 不幸的是，表列很难使用，因为如果你使用它们，你实际上有一个以两种方式细分的表：按行和按列。一般规则是在行上定义的任何样式都会覆盖在列上定义的任何样式。
> 
> 其次，W3C 规定只有少数声明可以用于列：边框、背景、宽度和可见性。例外：IE7 及更低版本允许所有声明。
> 
> 第三，列样式是应用于整个列还是应用于其中`<td>`包含的单个 s 存在一些混淆。边界声明似乎应用于整个列，但宽度应用于单个单元格。

这使得 colgroup/col 对居中几乎毫无用处。

# jquery - 使用 ASP.Net PageMethods 的 jquery 自动完成功能

> ID：10289497
> 
> 赞同：0
> 
> 时间：2012-04-23T23:05:41.097
> 
> 标签：jquery, asp.net, pagemethods

我试图让 JQueryUI 的自动完成功能与 AJAX 调用一起工作以填充源数组。

但是，我显然做事不正常。我该如何解决这个问题以使其正常工作？

（PageMethods 返回其 JSON 列表，但未绑定到选择）

```
<asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true" />
<script type="text/javascript" >     
$(".aaa").autocomplete({
     source: list,
      search: function(event, ui) {
        PageMethods.FilterDropdown($(this).attr("id"), $(this).val(), OnSucceeded); 
      }
});

function OnSucceeded(result) {
       list = result;
}
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T23:34:57.760

这似乎可以做到。我错过了将回调传递给源的直接方法：

```
<asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true" />
<script type="text/javascript" >

    $(document).ready(function() {

        $(".aaa").autocomplete({
            source: function(request, response) {

                    PageMethods.FilterDropdown("txname", $("#txname").val(), function(data) {
                    return response(data);
                });
            }
        });
    });

</script> 
```

# javascript - jQuery 中的并行 JSONP 请求不会触发多个“回调事件”？

> ID：10289501
> 
> 赞同：8
> 
> 时间：2012-04-23T23:06:16.327
> 
> 标签：javascript, ajax, jquery, jsonp

当我执行多个 jsonp 请求时，我在 jQuery 中遇到问题，所有请求都具有相同的 jsonpCallback 函数。似乎只有其中一个触发了回调函数。JSONP 请求是否以某种方式相互覆盖？

下面是对 github 进行 2 次 jsonp 请求的示例，即使两个 firebug 都显示它们都返回，但`getName`只为其中一个调用回调函数：

```
function getName(response){
    alert(response.data.name);
}

function userinfo(username){
    $.ajax({
        url: "https://api.github.com/users/" + username,
        jsonpCallback: 'getName',
        dataType: "jsonp"
    });        
}

users = ["torvalds", "twitter", "jquery"]
for(var i = 0; i < users.length; i++){
  userinfo(users[i]);
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-04T02:59:14.597

由于 jsonp 的工作方式，您的请求只触发了一次。

Jsonp 意味着从外部域向页面添加脚本标记，以绕过现代浏览器（以及截至 2011 年 4 月的 IE6 和 7）内置的跨站点脚本保护。为了让该脚本与页面上的其余脚本交互，正在加载的脚本需要调用页面上的函数。该函数必须存在于全局命名空间中，这意味着该名称只能有一个函数。换句话说，如果没有 JQuery，单个 jsonp 请求将如下所示：

```
<script>
function loadJson(json) {
    // Read the json
}
</script>
<script src="//outsidedomain.com/something.js"></script> 
```

something.js 看起来像这样：

```
loadJson({name:'Joe'}) 
```

在这种情况下，something.js 有一个硬编码的回调来加载它携带的 JSON，并且页面有一个硬编码的 loadJson 函数，等待像这样的脚本加载并调用它。

现在假设您希望能够从多个来源加载 json 并告知每个来源何时完成，或者甚至多次从同一来源加载 JSON，并且能够告知每个调用何时完成 - 即使一个调用被延迟这么长时间它完成在稍后的电话之后。这种硬编码方法不再适用，原因有两个：

1.  每次加载 something.js 都会调用相同的 loadJson() 回调——你无法知道哪个请求对应哪个回复。

2.  缓存——一旦你加载了 something.js，浏览器就不会再向服务器请求它——它只会从缓存中取回它，破坏你的计划。

您可以通过告诉服务器每次以不同方式包装 JSON 来解决这两个问题，简单的方法是将该信息传递到查询字符串参数中，例如`?callback=loadJson12345`. 就好像您的页面看起来像这样：

```
<script>
function loadJson1(json) {
    // Read the json
}
function loadJson2(json) {
    // Read the json
}
</script>
<script src="//outsidedomain.com/something.js?callback=loadJson1"></script>
<script src="//outsidedomain.com/somethingelse.js?callback=loadJson2"></script> 
```

使用 JQuery，这一切都被抽象为您看起来像对 $.ajax 的正常调用，这意味着您期望成功函数触发。为了确保每次 jsonp 加载都会触发正确的成功函数，JQuery 在全局命名空间中创建一个长的随机回调函数名称，如 JQuery1233432432432432，将其作为回调参数传递到查询字符串中，然后等待脚本加载。如果一切正常，加载的脚本会调用 JQuery 请求的回调函数，这反过来会从 $.ajax 调用中触发成功处理程序。

请注意，“正常工作”要求服务器端读取`?callback`查询字符串参数并将其包含在响应中，例如`?callback=joe`-> `joe({...`。如果它是静态文件或服务器不以这种方式播放，您可能需要将该文件视为可缓存的 - 见下文。

# 缓存

如果您希望您的 json 缓存，您可以通过设置 cache: true 并将 jsonpCallback 属性设置为硬编码到可缓存 json 文件中的字符串来让 JQuery 做一些更接近我的第一个示例的操作。例如这个静态 json：

```
loadJoe({name:'Joe'}) 
```

可以像这样在 JQuery 中加载和缓存：

```
$.ajax({
    url: '//outsidedomain.com/loadjoe.js',
    dataType: 'jsonp',
    cache: true,
    jsonpCallback: 'loadJoe',
    success: function(json) { ... }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T23:12:51.120

改用成功回调..

```
function userinfo(username){
    $.ajax({
        url: "https://api.github.com/users/" + username,
        success: getName,
        dataType: "jsonp"
    });        
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T23:28:41.620

```
$(function() {
    function userinfo(username){
      var XHR = $.ajax({
             url: "https://api.github.com/users/" + username,
             dataType: "jsonp"
         }).done(function(data) {
             console.log(data.data.name);
         });
    }

    users = ["torvalds", "twitter", "jquery"];
    for(var i = 0; i < users.length; i++){
       userinfo(users[i]);
    }
});  ​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T23:19:44.993

不确定，但我从调用 github API 得到的响应不包括`gravatar_id`.

这对我有用：

```
function getGravatar(response){
    var link = response.data.avatar_url;
    $('#list').append('<div><img src="' + link + '"></div>');
} 
```

# php - 拉标题？

> ID：10289503
> 
> 赞同：-2
> 
> 时间：2012-04-23T23:06:42.023
> 
> 标签：php, mysql

好的，首先让我从我的数据库（MySQL）中的内容开始：http: [//gyazo.com/6e94124bf9387bfead4acb84be7a6452](http://gyazo.com/6e94124bf9387bfead4acb84be7a6452)

到目前为止，我能做的是从我的数据库中提取内容。我还希望能够从数据库中提取标题，但不确定如何操作。

这是我的文件：

**users_list.php：**

```
<?php

include('CORE/init.inc.php');

$page = (isset($_GET['page'])) ? (int)$_GET['page'] : 1;

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Pagination Test</title>
</head>

<body>
<div>
    <?php
        foreach (fetch_users($page, 5) as $user) {
            echo "<p>{$user}</p>";
        }

        $total_pages = ceil(fetch_total_users() / 5);

        for ($i = 1; $i <= $total_pages; ++$i) {
            echo " <a href=\"?page={$i}\">{$i}</a> ";
        }
    ?>
</div>
</body>

</html> 
```

**初始化.inc.php：**

```
<?php

mysql_connect('localhost', 'root', '123456');
mysql_select_db('dbcontent');

$path = dirname(__FILE__);

include("{$path}/INC/users.inc.php");

?> 
```

**users.inc.php：**

```
<?php

function fetch_users($page, $per_page) {
$start = (int)($page - 1) * $per_page;
$per_page = (int)$per_page;

$query = mysql_query("SELECT `content` FROM `page` WHERE `user_id` = ".$page);

while(($row = mysql_fetch_assoc($query)) !== false) {
    $users[] = $row['content'];
}

return $users;

}

function fetch_total_users() {
$result = mysql_query("SELECT COUNT(`user_id`) FROM `page`"); 

return mysql_result($result, 0);
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T23:19:04.497

您可以更清楚您的目标，但我将假设“拉标题”意味着将标题从数据库中取出。你没有提到桌子叫什么，所以我就叫它`tablename`。

为此，sql是

```
select title from tablename
where user_id = something 
```

您必须在 where 子句中输入您想使用的任何标准来选择标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:18:15.860

```
$query = mysql_query("SELECT `content`,`title` FROM `page` WHERE `user_id` = ".$page); 
```

这样，当您获取 $query 时，您也会有一个“标题”键。从现在开始，您决定如何使用它。

例如

```
while(($row = mysql_fetch_assoc($query)) !== false) {
    $ret[] = array($row['title'],$row['content']);
}

return $ret; 
```

并在 user_list

```
foreach (fetch_users($page, 5) as $user) {
            echo "<h1>{$user[0]}</h1><p>{$user[1]}</p>";
        } 
```

# java - Java Socket 连接被我的公共 IP 拒绝

> ID：10289505
> 
> 赞同：3
> 
> 时间：2012-04-23T23:06:47.463
> 
> 标签：java, android, sockets, networking

我在android中有一个客户端服务器架构项目。我无法将我的公共 IP 连接到服务器。我关闭了防火墙，并为服务器进行了端口重定向。我的朋友可以从外部连接到我的服务器，但我不能，为什么？怎么可能？..谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:14:11.417

您在哪个操作系统运行您的客户端服务器代码。如果是 Windows，则查找 c:\Windows\System32\drivers\etc\hosts，如果是 linux，则转到 /etc/hosts/ 文件

使用 sudo 权限打开文件。

```
Format:
<IP> <HOSTNAME>.<DOMAIN> <ALIAS>

Example:
127.0.0.1 localhost.localdomain localhost 
```

在此处添加您的 IP 和域名。您的域名可以是任何名称，然后重试。你的问题也有点模糊。请添加更多详细信息，例如您的操作系统环境以及您到底想实现什么？

# java - 将 XML 文档写入 java 文件的最佳方法是什么？

> ID：10289507
> 
> 赞同：1
> 
> 时间：2012-04-23T23:06:58.090
> 
> 标签：java, xml, xml-serialization, transformation, xerces

我正在尝试编写一个 XML 文件。我能够使用以下代码创建文档。我想将此文档写入具有缩进支持的文件。目前我的代码看起来像这样。

这是解析 XMl 和写入文件的更好技术。

```
public void writeXmlToFile(Document dom) throws IOException {
    OutputFormat format = new OutputFormat(dom);
    format.setIndenting(true);

    XMLSerializer serializer = new XMLSerializer ( new FileOutputStream(
                                 new File("sample.xml")), format);
    serializer.serialize(dom);
} 
```

或者使用变压器是一种更好的方法。

```
public void writeXMLToFile(DOcument dom) throws TransformerException, IOException {
    TransformerFactory transFact = TransformerFactory.newInstance();
    Transformer        trans = transFact.newTransformer();

    trans.setOutputProperty(OutputKeys.ENCODING, "utf-8");
    trans.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "no");
    trans.setOutputProperty(OutputKeys.INDENT, "yes");
    trans.setOutputProeprty("{http://xml.apache.org/xslt}indent-amount", "2");

    StreamResult resut  = new StreamResult(new FileWriter(output));
    DOMSource source = new DOMSource(xmlDOC);

    trans.transform(source, result);
    writer.close();    
} 
```

这两种方法有什么区别？哪些技术可以提供更好的性能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:54:17.150

为了回答你的问题，我建议第三种方式，即 W3C 提出的 DOM Load and Save API。代码是不言自明的。

```
DOMImplementationLS ls = (DOMImplementationLS)
    DOMImplementationRegistry.newInstance().getDOMImplementation("LS");

// Gets a basic document from string.
LSInput input = ls.createLSInput();
String xml = "<bookstore city='shanghai'><a></a><b/></bookstore>";
InputStream istream = new ByteArrayInputStream(xml.getBytes("UTF-8"));
input.setByteStream(istream);
LSParser parser = ls.createLSParser(DOMImplementationLS.MODE_SYNCHRONOUS, null);
Document document = parser.parse(input);

// Creates a LSSerializer object and saves to file.
LSSerializer serializer = ls.createLSSerializer();
serializer.getDomConfig().setParameter("format-pretty-print", true);
LSOutput output = ls.createLSOutput();
OutputStream ostream = new FileOutputStream("c:\\temp\\foo.xml");
output.setByteStream(ostream);        
serializer.write(document, output); 
```

与 XmlSerializer 或多或少是一个预标准不同，这种方法是首选的，因为它受到所有兼容实现的支持。不过，性能在很大程度上取决于供应商的实施。

# sql - 需要帮助编写查询

> ID：10289509
> 
> 赞同：-3
> 
> 时间：2012-04-23T23:07:03.270
> 
> 标签：sql, sql-server

您好我正在尝试将以下每个查询的结果合并到一个查询中。我知道我可以做一个联合，但我想知道是否有更好的方法，因为每个表都有不同的列？谢谢

```
select distinct RESOURCE_ID from USER_ROLES where TEST_IND ='Y'

select distinct RESOURCE_ID from USER_PLATFORMS where TEST_IND ='Y'

select distinct RESOURCE_ID from USER_COMPETENCIES where TEST_IND ='Y'

select distinct RESOURCE_ID from USER_TECH_SKILLS where TEST_IND ='Y'

select distinct RESOURCE_ID from USER_MGR_SKILLS where TEST_IND ='Y'

select distinct RESOURCE_ID from USER_APPS where TEST_IND ='Y'

select distinct RESOURCE_ID from BUS_PROCS where TEST_IND ='Y' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:32:16.977

尽管您说您不想要 UNION 查询，但评论中描述的您的要求中没有任何内容排除它。只要您选择的列在所有表中都相同，则表具有不同的列是可以的。

**这就是你需要的**

```
select RESOURCE_ID from USER_ROLES where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_PLATFORMS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_COMPETENCIES where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_TECH_SKILLS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_MGR_SKILLS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_APPS where TEST_IND ='Y'
UNION
select RESOURCE_ID from BUS_PROCS where TEST_IND ='Y' 
```

**注意：**我取出了 distinct 子句， union 无论如何都会使结果变得不同，所以它是多余的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:35:34.900

`UNION`是您最好的选择，它会自动从结果集中删除重复项，如果您想保留重复项，您可以使用`UNION ALL`.

```
select RESOURCE_ID from USER_ROLES where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_PLATFORMS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_COMPETENCIES where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_TECH_SKILLS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_MGR_SKILLS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_APPS where TEST_IND ='Y'
UNION
select RESOURCE_ID from BUS_PROCS where TEST_IND ='Y' 
```

[联合 MSDN](http://msdn.microsoft.com/en-us/library/ms180026.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-23T23:47:06.977

除了已经提到的联合之外，您还可以使用多语句表值函数：定义一个表变量并从您的众多查询中选择 INTO，然后从 functionName() 中选择 *。但是，您仍然需要每个查询生成具有相同数据类型的相同列，因此您可能需要将圆形钉转换/转换为方形柱状孔。

# c++ - 返回类型对象方法

> ID：10289512
> 
> 赞同：1
> 
> 时间：2012-04-23T23:07:25.427
> 
> 标签：c++, class, methods, initialization

如果我有这个泛型方法，其中`Foo`使用派生的参数返回类型对象`string s`：

```
Foo createFoo(string s)
{
    int index, first, second, third, fourth, fifth;

    Foo fooName(int first, int second,int third,int fourth,int fifth);
    return fooName;
} 
```

然后主要是，我尝试做这样的事情：

```
Foo newFoo = createFoo(argv[2]); 
```

为什么编译器会给我这个错误？

```
file.cc:30:1：错误：'Foo' 没有命名类型 file.cc：在函数中
'int main（int，char**）'：file.cc：180：38：错误：'createFoo'不是
在此范围内声明

```

来自Java，做这样的事情通常不会给我带来任何问题，为什么这会成为C++的问题？我该如何解决这个问题？

编辑 1：一些建议询问了我的`Foo`类定义的位置。它位于`createFoo`方法之后，所以我将方法移到代码`createFoo`的`Foo`类定义段之后并尝试编译。现在出现一个新错误：

```
file.cc：在函数'Foo createFoo(std::string)'中：file.cc:153:9：
错误：从 'Foo (*)(int, int, int, int, int)' 转换为
请求的非标量类型“Foo”

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T01:39:22.517

该语句`return fooName;`正在返回函数`fooName`，我认为您打算返回函数调用的结果，它应该类似于`return fooName(first, second, third, fourth, fifth);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T17:13:40.013

Mert 对我的方法位置的质疑是正确的。方法代码块应该位于文件中的 Foo 类定义位置之后。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:12:27.733

您没有包含定义“Foo”的标头，或者您忘记添加 using 指令以将其从定义它的名称空间中拉入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T10:52:24.827

关于您的第二个错误，转换之一：

```
Foo fooName(int first, int second,int third,int fourth,int fifth); 
```

您打算创建新的对象实例，将一些参数传递给对象构造函数。但是你最终会声明一个新函数。从参数中删除类型名称（“int”）以解决此问题。

您还应该知道[最令人头疼的 parse](http://en.wikipedia.org/wiki/Most_vexing_parse)。

# android - Android活动未启动

> ID：10289518
> 
> 赞同：0
> 
> 时间：2012-04-23T23:08:47.073
> 
> 标签：android, android-intent, android-activity

当有人按下按钮时，我正在从我的应用程序的第一个屏幕开始一个新活动。

出于某种原因，当我尝试启动 StoryBoard 时，似乎 MainScreen 正在重新加载。

我的应用程序中的第一个活动称为 MainScreen。我正在尝试启动 StoryBoard，我做得对吗？

```
Intent myIntent = new Intent(MainScreen.this, StoryBoard.class);
        myIntent.putExtra("sportName", sportName);
        myIntent.putExtra("stories", storiesAsArray);
        myIntent.setClass(this, StoryBoard.class);
                startActivity(myIntent); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:14:47.460

尝试

```
Intent myIntent = new Intent(MainScreen.this, StoryBoard.class);
myIntent.putExtra("sportName", sportName);
myIntent.putExtra("stories", storiesAsArray);
MainScreen.this.startActivity(myIntent); 
```

# php - In_array 但具有更多值

> ID：10289519
> 
> 赞同：0
> 
> 时间：2012-04-23T23:08:56.390
> 
> 标签：php, arrays

例子：

$array = array('你好', '你好', '再见');

如何检查数组中是否存在两个或多个值中的至少一个？

像：

if(in_array('hi', $array) || in_array('hello', $array)) ...

但只需一张支票？可以吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T23:11:00.200

```
if(count(array_intersect(array('hi','hello','bye'), $array))) {
   ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:11:09.543

```
function in_array2($ary1,$ary2){
  return count(array_intersect($ary1,$ary2)) > 0;
} 
```

简单，利用[array_intersect](http://www.php.net/manual/en/function.array-intersect.php)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T23:13:43.533

看一下[preg_grep](http://www.php.net/manual/en/function.preg-grep.php)，它将返回与预定义模式匹配的数组中的条目（例如`'/^(hi|hello)$/`在您的示例中）。

例如

```
if (count(preg_grep('^/(hi|hello)$/',$array)))
{
  // your code
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T23:15:08.793

使用 array_intersect()... 即

```
$array = array('hi', 'hello', 'bye');
if(count(array_intersect($array, array('search', 'for', 'values')))>0) .... 
```

# ruby-on-rails - Rails：ActiveRecord 中的多个或条件

> ID：10289522
> 
> 赞同：20
> 
> 时间：2012-04-23T23:09:23.830
> 
> 标签：ruby-on-rails, activerecord

我有两张桌子：Lawyer 和 Phone。电话分为区号和号码。一位律师有很多电话。我想生成一个查询，从电话列表中搜索电话与电话匹配的律师。

如果我只有一部手机，我可以这样搜索：

```
Lawyer.join(:phones).where(:area_code => area_code, :number => number) 
```

问题是我有一个包含多个区号的列表。所以我真的很想做这样的事情：

```
lawyers = []
phones.each { |phone| lawyers += Lawyer.join(:phones).where(:area_code => phone[:area_code], :number => phone[:number]) } 
```

但是，我不想做很多查询。不能在单个查询语句中完成吗？

编辑：这就是我单独使用 SQL 做类似事情的方式（假设数字列表是 [{:area_code=>'555', :number=>'1234564'}, {:area_code=>'533', ：数字=>'12345678'}]）

```
select * from phones where (area_code, number) in (('555', '1234564'), ('533', '12345678')) 
```

如果有人能把它翻译成 ActiveRecord，那就太好了。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-23T23:43:34.363

如果您传递一个 area_codes 数组，AR 将构建一个 IN 条件。因此，您可以使用原始搜索并改用数组：

其中 area_codes 是 area_codes 数组， numbers 是数字数组：

```
 Lawyer.join(:phones).where(:area_code => area_codes, :number => numbers) 
```

或者：

```
 Lawyer.join(:phones).where("phones.area_code IN (?) AND phones.number IN (?)", area_codes, numbers) 
```

应该产生：

```
 SELECT * from lawyers JOIN phones ON phones.lawyer_id = lawyers.id WHERE phones.area_code IN (...) AND phones.number IN (...) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-07-21T21:31:41.287

```
Lawyer.join(:phones).where(
  "(phones.area_code, phones.number) IN ( ('555', '5555555'), ('444', '12345678') )"
) 
```

# android - findViewById 返回 null - Android - setContentView

> ID：10289525
> 
> 赞同：4
> 
> 时间：2012-04-23T23:09:34.207
> 
> 标签：android, layout, null, views, findviewbyid

我在构建布局时遇到问题。我的情况是这样的：

我有一个`Activity`可以运行并为普通和横向定义的布局，但它们是在运行时从`onCreate()`.

在`onCreate()`我进行调用时`setContentView(my_normal_layout)`，然后将其添加到使用大量`addView()`'s 等并且工作正常。但是，我也在尝试构建我的横向布局，但有一个问题，当我尝试并使用`findViewById()`来获取我的基本布局时，这是我存储在其中的布局文件的一部分，`res/layout-land`它返回`null`。

现在我已经研究了针对有空返回问题的人的解决方案，但人们建议`setContentView`必须首先执行。但是我不想将内容视图设置为我的横向布局，我只希望在屏幕旋转时发生这种情况（它会自动执行此操作吗？）。

那么有谁知道我如何解决使用`findViewById`和更改未设置为内容视图的视图的问题？

我可以发布任何需要的代码行，但我希望解释足够好。谢谢，

乔什

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T23:34:11.703

如果我理解正确，您在两个不同的布局文件中有不同的 UI 元素。

如果是这种情况，那么您仍然可以将布局文件命名为相同的（一个 in`/res/layout`和一个 in `/res/layout-land`）并用于`setContentView(...)`自动膨胀正确的文件。

之后，您只需要知道当前方向是什么（纵向或横向），以便知道要调用哪些代码`findViewById(...)`。

您可以使用...找到方向

```
getWindowManager().getDefaultDisplay().getOrientation(); 
```

如果您使用的是 API 8 (Android v2.2) 或更高版本，则上述内容已被弃用，您应该调用`getRotation()`而不是`getOrientation()`.

请参阅[Display.getOrientation()](http://developer.android.com/reference/android/view/Display.html#getOrientation%28%29)

# javascript - Javascript 多字段/表单验证

> ID：10289526
> 
> 赞同：3
> 
> 时间：2012-04-23T23:09:35.203
> 
> 标签：javascript, forms, validation

是的，我知道有关 Stacked 的许多问题涉及表单验证，但虽然有些问题与我想要完成的任务非常接近，但我认为这是独一无二的。

我有[这个](http://jsfiddle.net/hdcty/3/)JS 摆弄[这个](http://jsfiddle.net/hdcty/3/)我想使用的脚本，它将按名称返回所有尚未填写的字段。我觉得这是一种更好的方法，因为我在下面的代码中尝试通过多个字段验证来完成相同的结果：

```
function validate ( )
{
valid = true;

if ( document.contactinfo.Name.value == "" )
{
    alert ( "You need to fill the name field!" );
    valid = false;
}

  if ( document.contactinfo.email.value == "" )
{
    alert ( "You need to fill in your email!" );
    valid = false; //change variable valid to false
}
return valid;
} 
```

虽然上述方法有效并发出了多个警报框，但我必须手动多次提醒他们需要填写哪些字段。我宁愿发出一个警报，告诉他们他们一举丢失了哪些字段，并将焦点返回到这些字段。JS fiddle 脚本会这样做，但是，我不断收到以下错误：`ValidateRequiredFields is not defined` 而且我看不出问题出在哪里。我已经正确命名了所有内容，并且应该传递表单数据。

有什么想法吗？与往常一样，**如果需要，请要求澄清。**谢谢！

**注意：我不想使用 JQuery，因为我知道它们有非常简单的插件，可以让您设置所需的类！**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T23:50:29.773

我不知道小提琴错误，但关于你的脚本有几个改进：

您可以通过将所有消息收集到一个字符串中并执行单个警报来改进它

```
function validate ( ) {
  var valid = true;
  var msg="Incomplete form:\n";
  if ( document.contactinfo.Name.value == "" ) {
    msg+="You need to fill the name field!\n";
    valid = false;
  }
  if ( document.contactinfo.contact_email.value == "" ) {
    msg+="You need to fill in your email!\n";
    valid = false;
  }
  if (!valid) alert(msg);
  return valid;
} 
```

改进，将焦点返回到错误的第一个字段并更改有问题的字段的边框颜色：

```
function validate ( ) {
  var valid = true;
  var msg="Incomplete form:\n";
  if ( document.contactinfo.Name.value == "" ) {
    if (valid)//only receive focus if its the first error
      document.contactinfo.Name.focus();
    //change border to red on error (i would use a class change here...
    document.contactinfo.Name.style.border="solid 1px red";
    msg+="You need to fill the name field!\n";
    valid = false;
  }
  if ( document.contactinfo.contact_email.value == "" ) {
    if (valid)
      document.contactinfo.contact_email.focus();
    document.contactinfo.contact_email.style.border="solid 1px red";
    msg+="You need to fill in your email!\n";
    valid = false;
  }
  if (!valid) alert(msg);
  return valid;
} 
```

现在，上面的代码表示错误，将焦点返回到第一个错误并将红色边框放在有错误的字段上......我们仍然需要一些改进。首先，一旦字段有效，我们需要删除红色边框。这可以通过上面每个字段检查的 else 来完成...但是我假设每个字段只有一个错误条件，这可能不是案子。例如：电子邮件字段可以检查不为空和有效的电子邮件

做到这一点的一种方法是在开始时删除所有红色边框，然后开始验证。

style.border="..." 只是一种简单的方法，如果没有错误，我更喜欢更改类和删除类。

上面的糖是：

- 一旦字段有效，我们需要删除红色边框

- 制作所有字段的数组，包括名称、条件和消息

通过循环阵列来自动化该过程。这样我们就可以执行一个循环来清理边界，另一个循环来检查条件，以紧凑且可重用的代码结束。

# c++ - 调用“qsort”没有匹配的函数

> ID：10289527
> 
> 赞同：1
> 
> 时间：2012-04-23T23:09:45.440
> 
> 标签：c++, qsort

我似乎无法让 qsort 解决我的问题。我在网上环顾四周，我的代码应该是正确的。

```
int file::compare (const void * a, const void * b)
{
     fileinfo* fa = (fileinfo*)a;
     fileinfo* fb = (fileinfo*)b;
     return (*(int*)fa->inode - *(int*)fb->inode);
}

void file::print()
{
    qsort((void *)files, 100, sizeof(fileinfo), compare);
} 
```

`files`是一个文件信息数组。`struct fileinfo`是一个包含文件名和索引节点的结构。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T23:12:37.767

`file::compare`必须声明`static`用作 的参数`qsort`。

# javascript - Javascript动画图像调整大小

> ID：10289530
> 
> 赞同：1
> 
> 时间：2012-04-23T23:09:53.837
> 
> 标签：javascript, jquery, html

我正在尝试使图像动画并使其更大。我已经让它改变大小，但我现在正在努力做到这一点，所以周围的元素也不会被移动。我正在使用 jQuery 来制作动画，由于某种原因，它不会增加边距的每一步。它只有在完成后才会这样做。我以为我正确阅读了 jQuery 文档。到目前为止，这是我的代码：

```
$(document).ready(function(){
    $(".image").mouseenter(function(){
        $(this).animate({height: "176px", width: "250px"},
            {
            step: function(now, fx) {
                $(this).css("margin-left","-=0.076");
                $(this).css("margin-right","-=0.084");
                $(this).css("margin-bottom","-=0.152");
            }
        });
    });
    $(".image").mouseleave(function(){
        $(this).animate({height: "100px", width: "174px"},
            {
            step: function(now, fx) {
                $(this).css("margin-left","+=0.076");
                $(this).css("margin-right","+=0.084");
                $(this).css("margin-bottom","+=0.152");
            }
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:36:13.760

没有你的 html 很难说，但我认为你正在努力做到这一点。我建议您尽可能多地使用 css 和 html，然后再担心 javascript。如果您创建一个与图像大小相同的容器，那么您可以使用通常的方法将容器内的图片居中以使 css 中的内容居中，但您可以对其进行动画处理。我还将创建一个函数来处理这些动画，以便更易于使用。

在这里查看简单的演示：[jsfiddle](http://jsfiddle.net/elclanrs/XBmc9/)（包括可爱的小猫）

```
$('img').animate({
    width: 200,
    height: 150,
    top: 0,
    marginTop: '75px', // heigth / 2
    marginLeft: '100px' // width / 2
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:18:47.553

试试 CSS3 动画：

```
img{
-webkit-transform:scale(0.6); /*Webkit: Scale down image to 0.6x original size*/
-moz-transform:scale(0.6); /*Mozilla scale version*/
-o-transform:scale(0.6); /*Opera scale version*/
-webkit-transition-duration: 0.5s; /*Webkit: Animation duration*/
-moz-transition-duration: 0.5s; /*Mozilla duration version*/
-o-transition-duration: 0.5s; /*Opera duration version*/
}

.hovergallery img:hover{
-webkit-transform:scale(0.9); /*Webkit: Scale up image to most of the original size*/
-moz-transform:scale(0.9); /*Mozilla scale version*/
-o-transform:scale(0.9); /*Opera scale version*/
} 
```

以上将在悬停时缩放图像。

# iphone - 如何将图像或声音发送到另一部 iPhone/Android

> ID：10289532
> 
> 赞同：0
> 
> 时间：2012-04-23T23:10:10.917
> 
> 标签：iphone, objective-c, ios, audio, uiimage

我想知道像 Draw Something 这样的游戏是如何将图像发送到另一部 iPhone/Android 的？我希望能够将录制的声音/UIImage 发送到另一部手机，它们是如何发送和接收的？我对使用 iPhone 进行通信比较陌生。

我用谷歌搜索并搜索了stackoverflow，但找不到任何东西..也许我没有搜索正确的查询..

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:26:13.847

它们通过 TCP/IP 发送到中央服务器，或者更可能是一组服务器。这些服务器负责存储数据并生成推送通知，以便目标设备知道有新数据可用。目标设备从中央服务器下载它，而不是直接从其他设备下载。

在 iOS 上，您可以使用 NSURLConnection 类将数据推送到服务器或读回。服务器也是您负责的事情，尽管您可以使用一些第三方服务器（例如 Urban Airship）来帮助推送通知。

# objective-c - 当用户单击视图的背景时，如何使键盘消失？

> ID：10289533
> 
> 赞同：1
> 
> 时间：2012-04-23T23:10:12.687
> 
> 标签：objective-c, ios, xcode

我的 iOS 应用程序中有一个 UITextField。当用户输入文本并单击 Return 时，键盘会因为调用带有“resignFirstResponder”的 IBAction 而消失。

但是，XCode 不允许我将一条线从 UIView 本身拖到文件所有者。如何将触摸 UIView 的背景与使键盘消失的 IBAction 相关联？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T00:51:31.437

您可以使用 UITapGestureRecognizer。请参阅：[通过触摸 UITableView 的背景关闭键盘](https://stackoverflow.com/questions/2321038/dismiss-keyboard-by-touching-background-of-uitableview)

所以代替tableview，只需将其添加到您的视图中：

```
UITapGestureRecognizer *gestureRecognizer = [[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(hideKeyboard)] autorelease];
gestureRecognizer.cancelsTouchesInView = NO; //so that action such as clear text field button can be pressed
[self.view addGestureRecognizer:gestureRecognizer]; 
```

并有一种隐藏键盘的方法

```
- (void) hideKeyboard {
    [self.view endEditing:YES];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:04:31.340

您已经注意到，您无法从 UIView 拖动到文件的所有者以将操作与触摸相关联。

解决此问题的方法是将背景视图的类从 更改`UIView`为`UIControl`并将操作从那里连接到控制器中的方法以停止编辑。

这是因为 UIControl 可以响应触摸事件，而 UIView 不能，但 UIControl 是 UIView 的子类，因此它可以用来代替 UIView。

不久前我写了一个使用这种技术的[示例项目。](http://dl.dropbox.com/u/585261/DelegationExample.zip)看看`secondViewController`'s xib 文件，看看我是如何更改背景视图的类并将其连接到控制器中的一个动作以关闭键盘的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-15T13:35:33.697

使用 touchesBegan 和 Event 并在视图上结束编辑：

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

  [self.view endEditing:YES];

  } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-24T00:21:29.317

一种简单的方法是在视图后面创建一个大的透明 UIButton。

# java - 我们有多少种方法可以安全地将 k 车放在 nxn 棋盘上

> ID：10289535
> 
> 赞同：3
> 
> 时间：2012-04-23T23:10:24.277
> 
> 标签：java, recursion, dynamic-programming

给定`k`车和`n by n`棋盘，车可以以`W`不同的方式安全地放置在棋盘上，其中

```
W = k!(n C k)^2
written differently W = n!n!/(k!(n-k)!(n-k)!) 
```

问题陈述：

编写一个程序，该程序将在棋盘上运行，并计算可以安全地将车放在棋盘上的`n by n`所有方式。`k`

我的研究：

在网上搜索后，我终于在[Geekviewpoint](http://geekviewpoint.com/Numbers_functions_in_java/)`nQueensSolution`上找到了一个代码，我将其修改如下。但是，我的代码仅在. 有谁知道如何解决这个问题？`k = n``k<n`

这是我的代码：

```
static int kRooksPermutations(int[] Q, int col, int k, int kLimit) {
    int count = 0;
    for (int x = 0; x < Q.length && col < Q.length; x++)
        if (safeToAdd(Q, x, col)) {
            if (k == kLimit - 1) {
                count++;
                Q[col] = -1;
            } else {
                Q[col] = x;
                count += kRooksPermutations(Q, col + 1, k + 1, kLimit);
            }
        }
    return count;
}//

static boolean safeToAdd(int[] Q, int r, int c) {
    for (int y = 0; y < c; y++)
        if (Q[y] == r)
            return false;
    return true;
}// 
```

这是一个测试代码

```
public static void main(String... strings) {
    kRooksPermutations(8,5);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T01:18:03.233

Got it!

```
 // Empty
  static final int MT = -1;

  static int kRooksPermutations(int[] Q, int col, int rooksInHand) {
    // Are we at the last col?
    if (col >= Q.length) {
      // If we've placed K rooks then its a good'n.
      return rooksInHand == 0 ? 1 : 0;
    }

    // Count at this level starts at 0
    int count = 0;
    // Have we run out of rooks?
    if (rooksInHand > 0) {
      // No! Try putting one in each row in this column.
      for (int row = 0; row < Q.length; row++) {
        // Can a rook be placed here?
        if (safeToAdd(Q, row, col)) {
          // Mark this spot occupied.
          Q[col] = row;
          // Recurse to the next column with one less rook.
          count += kRooksPermutations(Q, col + 1, rooksInHand - 1);
          // No longer occupied.
          Q[col] = MT;
        }
      }
    }
    // Also try NOT putting a rook in this column.
    count += kRooksPermutations(Q, col + 1, rooksInHand);

    return count;
  }

  static boolean safeToAdd(int[] Q, int row, int col) {
    // Unoccupied!
    if (Q[col] != MT) {
      return false;
    }
    // Do any columns have a rook in this row?
    // Could probably stop at col here rather than Q.length
    for (int c = 0; c < Q.length; c++) {
      if (Q[c] == row) {
        // Yes!
        return false;
      }
    }
    // All clear.
    return true;
  }

  // Main entry - Build the array and start it all going.
  private static void kRooksPermutations(int N, int K) {
    // One for each column of the board.
    // Contains the row number in which a rook is placed or -1 (MT) if the column is empty.
    final int[] Q = new int[N];
    // Start all empty.
    Arrays.fill(Q, MT);
    // Start at column 0 with no rooks placed.
    int perms = kRooksPermutations(Q, 0, K);
    // Print it.
    System.out.println("Perms for N = " + N + " K = " + K + " = " + perms);
  }

  public static void main(String[] args) {
    kRooksPermutations(8, 1);
    kRooksPermutations(8, 2);
    kRooksPermutations(8, 3);
    kRooksPermutations(8, 4);
    kRooksPermutations(8, 5);
    kRooksPermutations(8, 6);
    kRooksPermutations(8, 7);
    kRooksPermutations(8, 8);
  } 
```

Prints:

```
Perms for N = 8 K = 1 = 64
Perms for N = 8 K = 2 = 1568
Perms for N = 8 K = 3 = 18816
Perms for N = 8 K = 4 = 117600
Perms for N = 8 K = 5 = 376320
Perms for N = 8 K = 6 = 564480
Perms for N = 8 K = 7 = 322560
Perms for N = 8 K = 8 = 40320 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:37:19.783

我可能会以不同的方式解决问题：

```
solutions = 0;
k = number_of_rooks;
recurse(0,k);
print solutions;
...

recurse(row, numberOfRooks) {
   if (numberOfRooks == 0) {
      ++solution;
      return;
      }
   for(i=row; i<n; i++) {
      for(j=0; j<n; j++) {
         if (rook_is_ok_at(i, j)) {
            place rook at i, j
            recurse(i+1, numberOfRooks-1)
            remove rook from i, j
         }
      }
   }
} 
```

这解决了一般情况下的问题。8个车，5个车，没关系。因为所有车都是独一无二的，所以请注意，当我们放置车时，我们不必从 (0,0) 重新开始

*编辑*这里是一些结果：

这是我得到的 1 到 8 只车的结果：

```
For 1 rooks, there are 64 unique positions
For 2 rooks, there are 1568 unique positions
For 3 rooks, there are 18816 unique positions
For 4 rooks, there are 117600 unique positions
For 5 rooks, there are 376320 unique positions
For 6 rooks, there are 564480 unique positions
For 7 rooks, there are 322560 unique positions
For 8 rooks, there are 40320 unique positions 
```

# iphone - 当 autoreleasepool 耗尽时，NSFileAttributes dealloc 中的 SIGSEGV SEGV_ACCERR 崩溃？

> ID：10289536
> 
> 赞同：0
> 
> 时间：2012-04-23T23:10:27.710
> 
> 标签：iphone, objective-c, ios, ios5

使用 NSFileManager 在后台线程中获取文件大小时，我遇到了奇怪的崩溃。

我有一个名为 localFileSize 的歌曲对象的属性：

```
- (unsigned long long)localFileSize
{
    return [[[NSFileManager defaultManager] attributesOfItemAtPath:self.currentPath error:NULL] fileSize];
} 
```

在我处理音频播放的类中（使用第 3 方音频库，而不是 AQS 或 Core Audio），有一个文件长度回调函数在音频库的播放线程中调用，所以不是主线程。

在该文件长度函数中，我正在读取我的歌曲对象的 localFileSize 属性，位于 @autoreleasepool 中。在函数结束时，当池被耗尽时，NSFileAttributes 对象的 dealloc 方法有时会出现崩溃。我自己无法重现它，但我有 14 个与此问题相关的崩溃日志。

以下是其中一个崩溃日志的相关部分：

```
Thread 8 Crashed:
0   libobjc.A.dylib                     0x3262c4e8 _ZN4objc8DenseMapIP11objc_objectmLb1ENS_12DenseMapInfoIS2_EENS3_ImEEE4growEj + 67
1   libobjc.A.dylib                     0x32638d81 _ZN4objc8DenseMapIP11objc_objectmLb1ENS_12DenseMapInfoIS2_EENS3_ImEEE16InsertIntoBucketERKS2_RKmPSt4pairIS2_mE + 56
2   libobjc.A.dylib                     0x3262b09d _ZN4objc8DenseMapIP11objc_objectmLb1ENS_12DenseMapInfoIS2_EENS3_ImEEE16FindAndConstructERKS2_ + 44
3   libobjc.A.dylib                     0x3262b139 _objc_rootReleaseWasZero + 92
4   libobjc.A.dylib                     0x3262b0ad _objc_rootRelease + 12
5   Foundation                          0x31fbab81 -[NSFileAttributes dealloc] + 60
6   libobjc.A.dylib                     0x3262b0c5 _objc_rootRelease + 36
7   libobjc.A.dylib                     0x3262cdb7 objc_release + 38
8   libobjc.A.dylib                     0x3262be0d _ZN12_GLOBAL__N_119AutoreleasePoolPage3popEPv + 224
9   libobjc.A.dylib                     0x3262bd29 _objc_autoreleasePoolPop + 12
10  CoreFoundation                      0x35b0ce8f _CFAutoreleasePoolPop + 18
11  Foundation                          0x31f8aaf1 -[NSAutoreleasePool drain] + 128
12  iSub                                0x000fb6cb MyFileLenProc (AudioEngine.m:320)
13  iSub                                0x001623d8 BASS_FX_TempoCreate + 5160
14  iSub                                0x0016261c BASS_FX_TempoCreate + 5740
15  iSub                                0x0017f42c BASS_ChannelIsActive + 27424
16  AudioToolbox                        0x364905d9 _ZN19AudioConverterChain19DirectCallInputProcEPmS0_P15AudioBufferListPPK28AudioStreamPacketDescription + 228
17  AudioToolbox                        0x36465ee3 _ZN14CodecConverter13CallInputProcERm + 266
18  AudioToolbox                        0x3646588d _ZN14CodecConverter17DecoderFillBufferERmR15AudioBufferListP28AudioStreamPacketDescription + 576
19  AudioToolbox                        0x36465649 _ZN14CodecConverter10FillBufferERmR15AudioBufferListP28AudioStreamPacketDescription + 28
20  AudioToolbox                        0x36452c99 _ZN19AudioConverterChain12RenderOutputEP12CABufferListmRmP28AudioStreamPacketDescription + 92
21  AudioToolbox                        0x36452b53 _ZN22BufferedAudioConverter10FillBufferERmR15AudioBufferListP28AudioStreamPacketDescription + 186
22  AudioToolbox                        0x36452929 AudioConverterFillComplexBuffer + 356
23  iSub                                0x0017d9f8 BASS_ChannelIsActive + 20716
24  iSub                                0x00184f70 BASS_ChannelSetPosition + 640
25  iSub                                0x00186eb4 BASS_ChannelGetData + 1032
26  iSub                                0x000fc787 __35-[AudioEngine keepRingBufferFilled]_block_invoke_0 (AudioEngine.m:752)
27  libdispatch.dylib                   0x35e3fd55 _dispatch_call_block_and_release + 12
28  libdispatch.dylib                   0x35e4b7a3 _dispatch_worker_thread2 + 262
29  libsystem_c.dylib                   0x30fbb1cf _pthread_wqthread + 294 
```

有什么想法可能导致这种情况吗？

此外，如果有任何不同，在报告这些崩溃时，该项目并未使用 ARC。我最近转换为 ARC，但尚未发布更新。无论如何，我认为在这种情况下不会有任何区别。

此外，值得注意的是，所有的崩溃报告都来自 iOS 5.0.1 和 5.1，即使我的应用程序支持 4.2 及更高版本。那么可能是某种 iOS 5 错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:12:40.567

我想知道这是什么时候改变的？我清楚地记得 [NSFileManager defaultManager] 不是线程安全的。而且，顺便说一句，我们也遇到了从多个线程调用 defaultManager 的相同问题。看起来其他人以同样的方式记住它：http: [//useyourloaf.com/blog/2011/06/12/nsfilemanager-defaultmanager-is-not-thread-safe.html](http://useyourloaf.com/blog/2011/06/12/nsfilemanager-defaultmanager-is-not-thread-safe.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:46:05.993

最终使用这样的东西来获取文件大小：

```
#include <sys/stat.h>

struct stat fileInfo;
off_t fileSize; // Can cast to long long

stat(filename, &fileInfo);
fileSize = fileInfo.st_size; 
```

或者您可以尝试创建新的 NSFileManager 对象，因为看起来文档可能并不完全真实地说明线程安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:29:53.760

~~不要使用`+defaultManager`来自后台线程。只需 alloc+init 一个实例，使用它，然后（如果不使用 ARC）释放它。~~那是错误的。

# css - 有没有办法从某张桌子上取下风格？

> ID：10289537
> 
> 赞同：0
> 
> 时间：2012-04-23T23:10:47.013
> 
> 标签：css, html-table

我有一个 CSS 文件来设置我的表格样式，尽管我有一个表格我想使用不同的样式，或者没有样式？有没有办法我可以做类似的事情`<table style="no-style">`然后它很简单并且忽略CSS？

我看过但我找不到任何相关的东西！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:13:41.337

在 CSS 文件中使用表属性的类定义。无论何时需要它们，都可以与类属性一起使用。

CSS

```
table.myClass {
...
} 
```

HTML

```
<table class="myClass">...</table>
<table class="anotherTableWithAnotherClass">...</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T05:17:13.617

不，你不能这样取消样式——CSS中没有办法说“不要在这个特定元素中应用我的任何样式”。您只能覆盖样式设置。例如，如果您`* { color: red }`在样式表中有类似的设置（只是一个愚蠢的示例），则不能添加会排除特定元素并使浏览器在其中应用其默认颜色的规则。但是您可以设置`table#foo * { color: black; }`使表格内的所有文本`id=foo`都具有黑色。

以这种方式覆盖表格内的整体样式设置并非易事，但肯定是可能的。你只需要明确你想要的风格；你不能说“使用浏览器默认设置”。</p>

然而，从某种意义上说，有一个间接的方式，虽然它很少是一个好主意：如果你把你的表格放在一个单独的文档中并通过一个`iframe`元素嵌入它，那么表格将根据为嵌入指定的 CSS 代码显示文档，完全独立于嵌入文档的样式表。在极端情况下，如果您没有为嵌入文档指定 CSS 代码，它将按照浏览器的默认值显示（尽管在子窗口内，一个内联框架，尺寸由嵌入文档设置）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:12:42.173

CSS 是级联样式表，它们只为元素设置样式。不能操纵任何东西。您将需要使用 JavaScript。

我所知道的最好的方法是对不同的样式使用**CSS 类**。并使用 javascript 切换或删除它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T23:14:55.783

您需要更深入地探索 CSS，而您可能会关注的一件事是类。您可以创建一个“类”样式，并将其应用于特定的 HTML 元素（如表格），而不会影响您想要保留为“普通”的另一个表格。

```
.foo {
    border : 1px solid black;
} 
```

然后将该类应用于您的 HTML 元素：

```
<table class="foo">
    ...
</table> 
```

另一种解决问题的方法是使用选择器。

# .net - IMetaDataImport 可以将 RVA 解析为指针吗？

> ID：10289546
> 
> 赞同：1
> 
> 时间：2012-04-23T23:11:48.367
> 
> 标签：.net, clr, portable-executable

我正在使用非托管 .NET API，并且已经到了想要获取方法的 CIL 字节码的地步。IMetaDataImport 接口可以为我提供方法实现的 RVA，但就我所见而言，不能提供实际的内存位置。

有没有一种无需自己解析 PE 标头即可获取信息的方法？我知道这并不难做到，但 IMetaDataImport 已经做到了，所以这将是重复工作。

如果我真的必须自己解析 PE 标头，我可以获取 IMetaDataImport 实例使用的 HMODULE 还是我必须自己对文件进行内存映射并调用 OpenScopeFromMemory 来创建我的 IMetaDataImport 实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:54:41.953

上次我使用此 API 时，没有将 RVA 映射到实际地址的内置功能。所以是的，您必须自己将文件映射到内存中并解析节表以找到您的 RVA 所在的节并从中读取基本偏移量。然后可以将该值添加到映射的图像指针，以获取代码在内存映射中的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T18:02:12.947

不知道你提到的API，但是如果你有方法体的RVA，从文件或内存中读取它很容易。

如果您知道文件或内存中的元数据头地址、其 RVA（来自 CLR 头的字段）和方法的 RVA（来自 #~ 流中的 MethodDef 表），则可以计算文件中的位置。

```
offsetFromMetadataHeader = RVAofMethod - MetadataRVA
positionInFile = offsetFromMetadataHeader - positionOfMetaDataHeader 
```

这在我的实现中有效。

默认情况下，元数据和字节码位于同一部分 - .data。

对于字节码读取的实现您可能希望在 github 上查看 Project Cecil（请记住，您必须首先处理方法头）。

# button - 在新选项卡/窗口中打开按钮

> ID：10289548
> 
> 赞同：4
> 
> 时间：2012-04-23T23:12:15.310
> 
> 标签：button, browser

从用户的角度来看，是否可以单击按钮并将结果加载到新选项卡/窗口中，**而不是自动**加载。

**就像您在某些浏览器中单击链接或右键单击 -> 在新选项卡/窗口中打开一样。** 你能用按钮做到这一点吗？或者你需要一个浏览器插件吗？

这是可能吗？我知道您可以制作自定义按钮等，但这更多是出于好奇。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:15:38.880

设置表单时，只需更改目标：

```
<form action="form_action.asp" method="get" target="_blank"></form> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-23T23:19:12.370

* * *

您可以只使用 HTML：

```
<a target="_blank" href="YourAmazingURL">Click here for Amazing URL</a> 
```

另一个例子：

```
<a target="_blank" href="http://www.google.com/">Google</a> 
```

这利用了目标属性。

关于目标属性的更多信息：http: [//www.w3schools.com/tags/att_a_target.asp](http://www.w3schools.com/tags/att_a_target.asp) 另外：[http ://www.w3schools.com/html/html_links.asp](http://www.w3schools.com/html/html_links.asp)

# XHTML：

对于 XHTML，只需这样做：

```
<a href="YourAmazingURL" onclick="window.open(this.href,'_blank');return false;">Click here for Amazing URL</a> 
```

或者，再次：

```
<a href="http://www.google.com/" onclick="window.open(this.href,'_blank');return false;">Google</a> 
```

* * *

# google-chrome-extension - 是否有 Firefox 或 Chrome 插件可以从客户端抓取/搜索关键字

> ID：10289549
> 
> 赞同：1
> 
> 时间：2012-04-23T23:12:17.630
> 
> 标签：google-chrome-extension, firefox-addon

我正在寻找一个仅限客户端的插件，它可以递归地搜索站点，在页面上或直接链接的文本文件（.txt、.java、.properties 等）中查找搜索字符串。该网站是一个内网网站，所以它受到限制（这就是我不能使用谷歌搜索的原因）。

一个轻量级的可下载程序也可以......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-11T14:27:51.830

我找到了一个名为 FoxySpider 的 FireFox 插件，它可以满足您的需求。

它具有“通用”搜索功能，可搜索特定类型的所有文件，以及更“特定”的搜索功能。

对于一般搜索：自定义要包含在设置面板（firefox 插件页面）中的文件类型。

对于特定搜索：鼠标中键单击 FireFox 中 url 栏旁边的图标，您可以指定确切的文件名。

你可以在这里找到插件：[https ://addons.mozilla.org/sv-se/firefox/addon/foxyspider/](https://addons.mozilla.org/sv-se/firefox/addon/foxyspider/)

兄弟，蒂姆

# wpf - 在 MVVM 中，谁负责显示其他视图，ViewModel 还是 View？

> ID：10289553
> 
> 赞同：0
> 
> 时间：2012-04-23T23:12:40.527
> 
> 标签：wpf, mvvm, separation-of-concerns

关于导航窗格的简单问题，例如 Outlook 使用的导航窗格。

在 MVVM 中，谁负责显示其他视图，ViewModel 还是 View？

当 View 事件可以处理调用其他视图时，将该代码放在 ViewModel 中似乎很愚蠢。ViewModel 会根据需要启用/禁用和显示/隐藏导航项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:52:43.517

ViewModel 负责视图状态。如果用户执行的任何操作恰好修改了视图状态，则该操作的代码属于视图模型。

由于数据绑定，我喜欢 MVVM 模式，但我喜欢数据绑定，因为它允许我以一种易于对我的大部分代码进行单元测试的方式来构建我的代码。该结构的很大一部分是将视图状态放在一组类中，将模型状态放在另一组中。

我认为很多时候人们试图实现 MVVM，他们实际上只是为了数据绑定而实现了模型-视图关系。这很好，因为如果抽象不能为您提供明显的好处，就没有理由维护它们。

所以，你的问题的答案是你想用你的视图模型实现什么？

数据绑定？将代码放在您喜欢的任何地方。

可测试性？提供关注点分离的抽象？一个纯粹且没有视觉包袱的模型？

然后把它放在视图模型中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:53:01.060

我倾向于为我拥有的每个视图都有一个 ViewModel，甚至可能还有一个模型。如果您将信息传递给其他视图，那么您确实需要通过 ViewModel 执行此操作，如果没有，那么您可以通过仅使用视图进行导航来获得一种方法。希望这可以帮助 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T06:59:36.757

您正在谈论使用 MVVM 进行导航。

[我发现观看此视频](http://dnrtv.com/dnrtvplayer/player.aspx?ShowNum=0182)非常有用

大约在 23:00 时，这里解释了一种如何使用 MVVM 进行优雅导航的方法

希望这可以帮助

# opengl - 将 OpenGL 中的网格渲染为一系列子组？

> ID：10289555
> 
> 赞同：2
> 
> 时间：2012-04-23T23:12:43.767
> 
> 标签：opengl, shader, .obj, wavefront

我正在完成一个波前对象解析器，我想用它来构造通用网格对象。我的引擎使用 OpenGL 4 和着色器来绘制引擎中的所有内容。

我的问题是关于如何确保渲染网格的最佳渲染效率。

波前[.obj 文件](http://en.wikipedia.org/wiki/Wavefront_.obj_file)通常指定了许多对象子组。

可能会为子组分配特定的材料（例如闪亮的红色）。

因此，网格可能是相当复杂的子组集合，每个子组都分配有自己的材质。

我的问题是——

问：我是否需要分别绘制每个子组，例如为每个子组调用 glDrawElements ？（因此，如果我有 4 个单独的子组，我将不得不进行 4 次 glDrawElements 调用，从而通过 4 次统一更改（对于材质/纹理）调用着色器 4 次）

```
glDrawElements( GL_TRIANGLES, nNumIndicesInGroup, GL_UNSIGNED_INT, ((char*)NULL)+ first-vertex-offset ); 
```

如果这是正确的，那么我将不得不计算：

每个子组中的索引（意味着每个子组有一个单独的索引数组和 VAO） 子组开始的顶点偏移量

这似乎非常低效，我是在吠叫错误的树吗？

此外，来自[Wavefront obj wiki 页面](http://en.wikipedia.org/wiki/Wavefront_.obj_file)：

```
Smooth shading across polygons is enabled by smoothing groups.
 s 1
 ...
  # Smooth shading can be disabled as well.
  s off
  ... 
```

谁能建议平滑着色值表示什么？例如 s1、s2、s4 等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T17:56:58.413

是的，您应该将每个子组与其他子组分开绘制。这是必需的，直到子组之间的状态不同。

但是你迈的太远了。

为避免多次绘制调用，您可以引入指示用于访问统一数组值（材质数组、纹理数组）的索引的顶点属性。这样一来，您只需要一次绘制调用，但您将承担一个附加属性及其相关管理的成本。

我会避免上述方法。如果一个子组有纹理而另一个没有呢？你如何区分是否纹理？引入其他属性？看起来很混乱。

第一点是缓冲区对象管理非常灵活。实际上，您可以拥有一个元素缓冲区对象和一个顶点缓冲区对象：使用偏移和交错可以满足每个级别的复杂性。然后，在现代硬件上，使用顶点数组对象可以最小化不同缓冲区绑定的成本。

第二点是您的软件可以将具有相同统一状态的不同子组分组，将多个绘图调用合并为一个。请记住，您可以使用*Multi* draw entry points 变体，并且还有可以帮助您的图元重启（在剥离图元的情况下）。

其他考虑没有用，因为无论如何你都必须画画，不管它是否复杂。随后，当您有正确的渲染时，您可以分析应用程序和渲染，切断热点。

* * *

平滑组是共享相同选项属性（法线、纹理坐标）的顶点的集合。这是元素索引顶点的情况。

要深入了解主题，请阅读通过谷歌搜索找到的[规范之一。](http://www.martinreddy.net/gfx/3d/OBJ.spec)

# node.js - 无法在亚马逊 AWS 上的 ubuntu 11 上运行 express 2.5.8

> ID：10289558
> 
> 赞同：0
> 
> 时间：2012-04-23T23:13:06.527
> 
> 标签：node.js, express

我在 ubuntu 11（亚马逊 AWS）上使用 express 2.5.8。我已经连接 1.7.2 和节点 0.6.15。我能够运行节点（例如在端口 3000 上监听） - 但是，当我使用 express 时，它似乎会引发以下错误：

有一个未捕获的错误：未捕获，未指定的“错误”事件

当时该端口上没有其他服务绑定 - 我已尝试重新安装 express 2.5.8 并连接 1.7.2（在本地机器上工作） - 任何更快地解决问题的见解将不胜感激。再一次，代码（使用 express 在本地机器上运行良好 - 在服务器上，我可以在同一端口上运行非 express 节点服务器（我在运行 express 服务器实例之前将其关闭）。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T19:31:09.100

Pilot 错误 - 问题出在 redis 连接密码（我必须在我的代码中修复它以匹配 redis.conf 中的密码才能解决问题）。增加了更好的处理（我应该从一开始就这样做）。

感谢 Wes 的评论 - 非常感谢。

# jquery - window.onbeforeunload 在 IE 中被触发以进行异步调用？

> ID：10289561
> 
> 赞同：0
> 
> 时间：2012-04-23T23:13:42.063
> 
> 标签：jquery, internet-explorer, asynchronous, onbeforeunload

```
window.onbeforeunload = function (e) {
    someFunction();
} 
```

显然，每当有页面刷新时 someFunction() 都会被调用。但是在 Internet Explorer 中，只有在部分页面加载时 someFunction() 才会被调用。我怎样才能防止这种情况发生？或者如何使用 jQuery 添加一个事件侦听器，该事件侦听器在进行异步调用时触发？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T23:21:18.510

在异步请求的生命周期中调用了许多方法。你可以绑定到任意数量的它们。有关列表，请参见[http://api.jquery.com/category/ajax/](http://api.jquery.com/category/ajax/)。这可以防止您像在此处那样遇到不同的浏览器实现。

例如，使用`$.ajaxSetup()`我可以设置一个函数在每个请求之前运行：

```
$.ajaxSetup({
  beforeSend: function() {
   console.log( 'New request going out.' ) 
  }
}); 
```

您可能还想在调用完成后运行您的逻辑，在这种情况下，您可以将函数应用于`complete`传递给的对象的成员`$.ajaxSetup()`：

```
$.ajaxSetup({
  complete: function() {
    console.log( 'Call completed.' );
  }
}); 
```

这些方法有几个参数，如果您正在执行需要知道具体提出了哪些请求的逻辑，您可能想要使用这些参数。例如，Complete 将传递 jQuery 使用的 XHR 对象，以及为调用返回的状态。

```
$.ajaxSetup({
  complete: function( jqHXR, status ) {
    console.log( 'Completed: ' + status );
  }
}); 
```

# xcode - 在 Git 中回滚合并

> ID：10289565
> 
> 赞同：1
> 
> 时间：2012-04-23T23:14:07.773
> 
> 标签：xcode, git

我的同事在一个分支上，我在另一个分支上。当她将她的分支与我的分支合并时，我的更改没有进入。源文件在 Xcode 中是“M”（修改）而不是“C”（冲突），所以我们认为没问题。我回到我的分支，我看到我更改的代码仍然存在，并且我的代码工作正常。然后我们想再次尝试合并，但从我的桌面在我的分支上。同样的事情出现在文件是“M”而没有文件是“C”的地方。

我的更改再次被覆盖。所以现在我正在尝试返回合并。我尝试使用从[http://mac.github.com/](http://mac.github.com/)下载的 Github 工具，方法是单击最近的提交，然后回滚到该提交，但我的更改似乎仍然消失了。我没有看到历史上的分支合并。是因为我合并后没有提交吗？

在合并之前如何回到我的分支？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:56:46.670

我没有使用过 Xcode 的版本控制 GUI 和 Github 工具。如果您知道进行更改的提交的 sha1，则可以在命令行中执行此操作：

```
git reset --hard <the sha1> 
```

这会将您当前的分支重置为您的提交。它还将重置工作树中的文件。当心。如果您有未提交的更改，它们将丢失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T08:36:50.457

您可以重置最后 n 个未推送的提交（已提交但未推送）。然后你需要使用的命令是

```
git reset HEAD  -- will omit the last commit
git reset HEAD^n  -- will omit the n number of last unpushed commits. 
```

# c++ - 防火墙/防病毒软件的安全模式

> ID：10289569
> 
> 赞同：0
> 
> 时间：2012-04-23T23:14:28.187
> 
> 标签：c++, c, security

我很好奇为什么有时我的防病毒软件会将我的程序视为对我计算机的威胁。我瘦套件与内存分配有关。- 有谁知道为什么以及如何避免这样的事情？-为什么会是其他原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:24:56.970

传统的病毒检测是基于指纹的。然而，随着多态和变态病毒以及新病毒的大量增加，反病毒供应商已开始转向基于行为的检测。您的程序可能会成为攻击目标，因为它表现出“类似病毒”的行为。例如，您的程序可能正在尝试从磁盘读取它可能无权访问的文件、修改系统上存在的其他可执行文件或重要系统设置、自动发送电子邮件或启动网络流量，或者更改异常卷中的系统启动操作。

不幸的是，如何绕过特定供应商的检测有点像黑匣子。我会检查您的 AV 产品是否具有白名单机制。

# ios - iOS - 将 NSDictionaries 嵌套到 NSArray

> ID：10289570
> 
> 赞同：0
> 
> 时间：2012-04-23T23:14:35.177
> 
> 标签：ios, nsarray, nsdictionary, sbjson

我的 Json 响应是

```
[{"id":"1", "x":"1", "y":"2"},{"id":2, "x":"2", "y":"4"}] 
```

我做到了

```
 NSString *response = [request responseString];
 SBJSON *parser = [[SBJSON alloc] init];
 NSArray *jsonObject = [parser objectWithString:response error:nil]; 
```

在这一点上，我相信 jsonObject 是一个有两个 NSDictionary 的数组。我怎样才能使 jsonObject 有两个 NSArray 而不是 NSDictionary？最好的方法是什么？我认为我需要将嵌套的 NSDictionary 转换为 NSArray？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:38:08.240

我现在会在 Foundation 框架中使用 NSJSONSerialization 类。

使用 JSONObjectWithData 方法，它将返回您希望将数据存储在顶层的容器类型。例如：

```
NSError *e;

NSArray *jsonObject = [NSJSONSerialization JSONObjectWithData:data options:0 error:&e]; 

for (NSDictionary *dict in jsonObject) {

    NSLog(@"json data:\n %@", dict); 

    // do stuff

} 
```

或者，您可以返回一个可变容器，例如：

```
NSMutableDictionary *json = [NSJSONSerialization JSONObjectWithData:data options:0 error:&e]; 
```

这是苹果文档：

[NSJSON序列化](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)

# c++ - 函数指针中的参数列表

> ID：10289572
> 
> 赞同：0
> 
> 时间：2012-04-23T23:14:40.323
> 
> 标签：c++, c, pointers, gcc, posix

我可以在我的函数 ptr * Os_printf * 中打印超过 2 个参数，但我的函数仅适用于 1 个参数。

例如 -->

```
Os_printf("Moon %d %d",55,5); 
```

出去：

> 月亮 55 5

```
#include <stdio.h>
#include <stdlib.h>
#include <stdarg.h>

char db[50];

void test_1(int (*debug)())
{
    debug("JOY %d %d \n",4,55);
}

volatile int (*ptr_fscreener)(char * __restrict, const char * __restrict, ...);

void Os_formater(int (*debug)() )
{
  ptr_fscreener=debug;
}

void Os_printf(const char  * __restrict out,void**d)
{
va_list args;
char db[50];
ptr_fscreener(db,out,d);
puts(db);
}

int main(void) {
    Os_formater(sprintf);
    Os_printf("Moon %d",55);
    test_1(printf);
    puts("!!!Hello World!!!"); /* prints !!!Hello World!!! */
    return EXIT_SUCCESS;
  }

/*******  OUTPUT For example  ******/
       Moon 55
       JOY 4 55
       !!!Hello World!!! 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T23:40:17.330

您需要使用`<stdarg.h>`并且可能`vsnprintf()`，在众多其他更改中：

```
#include <stdio.h>
#include <stdlib.h>
#include <stdarg.h>

void test_1(int (*debug)(const char *format, ...))
{
    debug("JOY %d %d\n",4,55);
}

static int (*ptr_fscreener)(char *, size_t, const char *, va_list);

void Os_formatter(int (*debug)(char *buffer, size_t buflen, const char *format, va_list args))
{
    ptr_fscreener = debug;
}

void Os_printf(const char *out, ...)
{
    va_list args;
    char db[50];
    va_start(args, out);
    ptr_fscreener(db, sizeof(db), out, args);
    va_end(args);
    puts(db);
}

int main(void)
{
    Os_formatter(vsnprintf);
    Os_printf("Moon %d",55);
    test_1(printf);
    puts("!!!Hello World!!!");
    return EXIT_SUCCESS;
} 
```

`vsnprintf()`只要你正确使用它，它就可以为你提供一些防止缓冲区溢出的保护。恢复使用是相当直接的`vsnprintf()`；我认为这是不可能使用`snprintf()`或`sprintf()`可靠的。

汇编：

```
gcc -O3 -g -std=c99 -Wall -Wextra va.c -o va 
```

结果：

```
Moon 55
JOY 4 55
!!!Hello World!!! 
```

# http - HTTP 请求包含粗俗字符

> ID：10289573
> 
> 赞同：0
> 
> 时间：2012-04-23T23:14:42.643
> 
> 标签：http

我有一个将数据发送到 RESTful API 的脚本。我正在对间歇性错误进行故障排除，但找不到任何语法问题。但是，查看退货请求会发现一些有趣的事情。

```
6914ðnicity=Hispanic%2FLatino
&discipline=director
&yearsTeaching=
&facultyType=Not+Applicable
°ree=Doctorate 
```

注意第一行和最后一行的开头很奇怪。第一行应该是`&Ethnicity`，第二行应该是`&Degree`。在脚本中，他们被简单地标记为“种族”和“学位”。非常简单，所以我不知道这些字符是如何或为什么被返回的。另一件事是我不确定这与我所追求的错误有关，因为异常显然发生在单独的代码行中。让我认为它相关的是接收数据的 API 不接受 Unicode 字符，例如`ð`和`°`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:52:47.620

原来这个调用不是来自我的服务器，而是我无法控制的网络服务。显然我混淆了一些输出日志。谢谢~~

# selenium - 如何使用 Selenium IDE 验证 Web 服务测试表单响应

> ID：10289576
> 
> 赞同：0
> 
> 时间：2012-04-23T23:14:51.233
> 
> 标签：selenium, selenium-ide

我有一个带有测试表格的网络服务：

![在此处输入图像描述](../Images/33315a943ae23b8920a04c0ebb8fc464.png)

我想测试 Web 服务并验证响应，但响应会在新窗口中打开。有没有办法使用 Selenium IDE 来检查新打开的窗口中的输出？

更新：webservice 测试表单使用**target="_blank"**进行 POST，这导致响应被加载到 Firefox 的新选项卡中。来自 web 服务的响应是一个 xml 文档，因此许多依赖于 HTML 文档的标准 Selenium IDE 命令将不起作用。我找到了[assertTextPresentXML](http://wiki.openqa.org/display/SEL/assertTextPresentXML)扩展，但我无法选择新打开的选项卡，因为它没有我可以访问的名称、ID 或标题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:33:20.357

您可以使用`selectWindow`命令并指定新打开窗口的标题（如果此标题与初始窗口不同）：

```
selectWindow | title=New window title 
```

可以从 html>head>title 检索标题。如果它不起作用，您可以尝试类似的方法：

```
getEval | selenium.browserbot.findElement('locator_of_invoke_button').target='my_window'
getEval | window.open("", "my_window")
click | locator_of_invoke_button
selectWindow | my_window
waitForElementPresent | locator_of_element_at_new_window 
```

# asp.net - CSS - 突出显示选定的选项卡

> ID：10289588
> 
> 赞同：2
> 
> 时间：2012-04-23T23:15:47.360
> 
> 标签：asp.net, css, navigation

我的母版页中有以下选项卡式导航设置。

```
 <nav class="grid_12">
            <ul>
                <li><a href="#" class="selected">Home</a></li>
                <li><a href="#">Portfolio</a></li>
                <li><a href="#">Blog</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </nav> 
```

例如，当我单击投资组合选项卡时，我希望投资组合选项卡在我进入投资组合页面时保持突出显示。完成此操作的推荐方法是什么？

我检查了其他一些帖子，但[其中最相关](https://stackoverflow.com/questions/2385035/jquery-selected-tab-problem)的是示例中的 div，而不是单独的页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T23:25:18.233

假设您拥有的“选定”类名具有您正在谈论的突出显示的样式。在用户单击其中一个链接后，您可以使用 jquery 将“选定”类添加到单击的锚标记。将其放在页面底部的结束正文标记之前或您的主要 JavaScript 文件中。

```
<script type="text/javascript">
    $(document).ready(function () {
        $(".grid_12 ul li a").click(function() {
            $(".grid_12 ul li a ").removeClass("selected");
            $(this).addClass("selected")
        })
    })
</script> 
```

上面的代码只有在没有页面刷新和只有内容刷新的情况下才有效，但是如果你的页面会刷新并转到一个新页面，我会做这样的事情：

```
<nav class="grid_12">
    <ul>
        <li><a href="#" class="nav_home">Home</a></li>
        <li><a href="#" class="nav_portfolio">Portfolio</a></li>
        <li><a href="#" class="nav_blog">Blog</a></li>
        <li><a href="#" class="nav_contact">Contact</a></li>
    </ul>
 </nav> 
```

并为特定页面添加样式。例如，当您在 www.mySite.com/portfolio 的 css for 投资组合中时，仅添加：

```
a.nav_portfolio{
    background-color:orage;
    ...
} 
```

这样，您甚至不必执行任何 javascript。

# c++ - 为什么我的字符串失去了它的价值？

> ID：10289590
> 
> 赞同：6
> 
> 时间：2012-04-23T23:15:50.493
> 
> 标签：c++, string, compare

出于某种原因，我的 toCheck 变量的值被删除了，我不知道为什么。有什么建议么？

```
bool
check(string toCheck){
    printf("toCheck: %s\n", toCheck.c_str());
    ifstream list;
    list.open("list.txt");
    string temp;
    while(list){
        getline(list,temp);
        printf("toCheck: '%s' temp: '%s'\n",toCheck.c_str(), temp.c_str());
        if(temp == toCheck){
            printf("Username exists\n");
            return false;
        }
    }
    printf("returning true\n");
    return true;
} 
```

这是它正在通过的内容：TestTrevor

这是输出：

> ```
> toCheck: TestTrevor  
> toCheck: '' temp: 'Trevor'  
> toCheck: '' temp: ''  
> 
> Username exists 
> ```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T07:17:11.547

从您的评论中：

> 调试起来真的很困难（这就是我使用 的原因`printf`），因为**我正在分叉**和使用进程（这是我正在处理的 VoIP 项目的服务器）并且当我尝试遵循时 gdb 不工作子进程。

强调我的。

`toCheck`如果动态分配的内存从未真正进入分叉进程，或者成功但以某种方式被丢弃/覆盖，我不会感到惊讶。

> 新信息：如果我将其注释掉，`getLine(list, temp);`那么它不会删除`toCheck`，有什么想法吗？

这是您的程序中第一次`std::allocator`需要实际分配内存。

* * *

STL 的开发从未考虑过分叉，因此它完全有可能在这个用例*中不起作用*。

您可以使用调试器检查发生了什么。查看分配内存的地址以及`toCheck`分配内存时会发生什么`temp`，但这是深度潜水。

由于您似乎对 gdb 有问题，您可以尝试先转储地址 ( `printf("%x", &toCheck[0]);`)。

# java - 指定要使用 ProGuard 混淆的类？

> ID：10289591
> 
> 赞同：1
> 
> 时间：2012-04-23T23:15:51.717
> 
> 标签：java, android, obfuscation, proguard

如何指定我希望 Proguard 混淆我包含在我的项目中的一组 jar 文件？我看过文档：

```
-injars class_path 指定程序 jars（或 wars、ears、zip 或目录）。
-outjars class_path 指定输出 jars（或 wars、ears、zip 或目录）的名称。
-libraryjars 类路径
```

但是我还是要问是哪一个指定了要混淆的jar文件？从文档中根本不清楚。

我知道这是一个基本问题，但是可以说我在 libs.jar 中有几个 jars 如何将它们指示为输入？它也应该是类路径还是我可以指定目录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:30:26.823

如果你在 Eclipse 中工作并且你的 .jar 文件被放在`lib/`文件夹中并包含在你的项目中，你不必担心它们，ProGuard 会自动使用它们来发挥它的魔力。

# c# - 你如何改变输入隐藏值？

> ID：10289592
> 
> 赞同：0
> 
> 时间：2012-04-23T23:16:02.377
> 
> 标签：c#, input, hidden, getelementbyid

我想更改输入标签的值。但它根本不起作用。我已经找到了一个可以更改 Select 标记值的工作代码，但是我还没有找到一个可以很好地更改下面输入标记值的代码。

```
 <div id="phmiddle_0_CheckoutShippingInfo1_selectAddressDiv" name="selectAddressDiv">
   <select class="selecta" name="selAddressBook" id="selAddressBook">
     <option value="-1">Create a new address</option>
     <option value="{adbd6ae0-abf8-40ea-a18a-998afaeb37ad}">AAA AAA</option>
     <option value="{0e0e26a0-c490-476f-9a00-d3d76d7d69cd}">BBB BBB</option>
     <option value="{84496563-8dcb-42e6-b728-60646faf81d0}">CCC CCC</option>
   </select>
   <input type="hidden" name="idOfShiptoDefaultedToOrSelected"
     id="idOfShiptoDefaultedToOrSelected"
     value='{adbd6ae0-abf8-40ea-a18a-998afaeb37ad}' />
 </div> 
```

这是我用来尝试更改隐藏输入值的代码。

```
private void button9_Click(object sender, EventArgs e)
{      webBrowser1.Document.GetElementById("idOfShiptoDefaultedToOrSelected").SetAttribute("value", "-1"); 
} 
```

它根本行不通。我在这里错过了选择或点击之类的东西吗？我已经试过了。

我也试过这个

```
webBrowser1.Document.GetElementById("selAddressBook").SetAttribute("value", "-1"); 
```

^ 该代码可以更改 seladdressbook 但不会更改输入隐藏值，即`idOfShiptoDefaultedToOrSelected.`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:05:52.920

为什么不在 JavaScript 中这样做：

```
$("#BUTTON_ID").click(function() {
$("idOfShiptoDefaultedToOrSelected").val("NEW_VALUE");
}); 
```

# javascript - 脚本标签之间的 JavaScript 函数范围

> ID：10289593
> 
> 赞同：6
> 
> 时间：2012-04-23T23:16:28.817
> 
> 标签：javascript, html, jsp

我有两个不同的 JSP，Java 后端将它们连接在一起并发送回同一个呈现的 HTML 页面。

每个 JSP 都有自己的`<script>`块并在该块内定义函数：

JSP #1：

```
<script type="text/javascript">
    function blah() { ... }
</script> 
```

JSP #2

```
<script type="text/javascript">
    function foo()
    {
        blah();
    }
</script> 
```

就像我说的，后端将这些添加到 HTTP 响应中，并在同一个请求期间将它们发送回浏览器。

当我在浏览器中运行此页面时，我可以立即知道在被调用`blah()`时没有执行。`foo()`我在 Firebug 中看到一个控制台错误，说明*`blah()`未定义*。我想知道是否`blah()`只有它自己的`<script>`标签内有范围，同样适用于`foo()`. **是这里的情况，还是有其他问题？**

当我查看页面源代码时，我看到了两个脚本块和两个函数。这告诉我一切都在服务器端正确生成/呈现，但也许我的方法本质上是错误的（在不同的脚本标签中定义函数）。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T23:21:16.640

它们都是全球性的。他们可以看到对方。问题是当他们被定义并互相调用时。

您应该按以下顺序定义和调用它们：

1.  酒吧
2.  富
3.  打电话给 foo
    *   foo 执行并调用 bar
    *   酒吧被执行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-02T07:52:47.293

你可以这样调用函数：

```
 (function($) {

     var namespace;
         namespace = {
                     something : function() {
                                             alert('hello there!');
                                            },
                      bodyInfo : function() {
                                             alert($('body').attr('id'));
                                            }
                     };
         window.ns = namespace;
    })(this.jQuery);

   $(function() {
              ns.something();
              ns.bodyInfo();
   }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:22:19.110

在 JavaScript 中唯一定义作用域的是一个函数，所以你的问题不是作用域问题。您很可能没有调用 foo()，而是在定义 blah() 之前调用它，或者在某处出现语法错误。也许您可以发布您的整个 HTML 页面，以便我们了解发生了什么。

# dependency-injection - 使用通用包装器类的依赖注入库不可知代码？

> ID：10289594
> 
> 赞同：0
> 
> 时间：2012-04-23T23:16:53.793
> 
> 标签：dependency-injection, wrapper

***有谁知道一组类来抽象出特定的依赖注入库（Spring、Castle、StructureMap、Ninject ......等）？***

我们都使用 DI 容器来抽象出我们代码的特定实现，但我们也可以使用相同的接口/策略模式来使用特定实现（例如 Castle.Windsor、Unity... 等）编写基于通用接口的 DI 容器。

一般来说，从容器中“获取和对象”的基本模式是非常普遍的。例如：

```
IService service = IocContainer.Get<IService>(); 
```

其中 IocContainer 是围绕特定库实现（例如 Castle.Windsor、Unity... 等）的通用包装类。

当然，除了编写可以“插入”的特定实现之外，当然，每个实现都有自己的配置文件格式。

有人对 DI 容器的现有经过良好测试的包装类有建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T23:39:49.860

所有这些包装器和容器抽象的问题在于它们将您限制在所有容器共享的功能的公共子集上。这就是为什么你不应该这样做。而是正确使用您选择的容器：

1.  在您的应用程序中只有一个“Get” - 在组合根中
2.  使用约定配置容器，而不是在一个一个一个的服务注册中使用。这使得配置很小。
3.  在应用程序初始组合之后必须创建实例并将它们作为容器配置的一部分实现的任何地方都使用工厂接口（某些容器会自动为您执行此实现）

使用这些简单的规则，您的容器仅在一个地方已知 - 组合根 - 这使得容器的任何抽象都过时了。这样您就可以使用容器的全部功能。

# php - php cookie 只设置 1 秒？

> ID：10289596
> 
> 赞同：-1
> 
> 时间：2012-04-23T23:17:08.310
> 
> 标签：php, cookies

也许有更好的方法来解决必须使用 cookie 的问题。但是我想在我的 php 中设置一些东西来告诉用户一个错误，但它只会出现一次，如果他们刷新页面，我不再想要它了。

```
$time = (1000);
setcookie("msgtype", $type, time() + ($time), '/');
setcookie("msg", $message, time() + ($time), '/');
print_r($_COOKIE); 
```

所以出于某种原因，如果我直接在 $_cookie 之后输出它仍然不会显示这个 cookie。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:18:16.460

您不需要为此使用 cookie，使用 SESSION 听起来很合理。

```
$_SESSION['error'] = 'soem message';
//Use it when you need and simply remove it afterwards
echo $_SESSION['error'];
unset($_SESSION['error']); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:22:18.423

相反，当显示错误时清除 cookie，而不是将其设置为 1 秒，以便下次刷新并检查 cookie 时它不会存在，因此不会显示任何错误。

`Or a better option would be using sessions.`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:21:26.927

在你的例子中，我将使用 SESSIONs

集合示例：

```
session_start()
$_SESSION['error'] = 1; 
```

当你将显示错误时使用这个:)

```
unset($_SESSION['error']; 
```

或者

```
$_SESSION['error'] = 0; 
```

这将取决于使用情况:)

# android - 更改 android ListView 项目前景色

> ID：10289602
> 
> 赞同：0
> 
> 时间：2012-04-23T23:17:56.910
> 
> 标签：android, listview, colors

我想根据变量更改我的 ListView 项目（使用 Async 类填充）的颜色。所以，我有这个

```
public class Search extends AsyncTask<Void, String, Void> {
    boolean blue = false;
    @Override
    protected Void doInBackground(Void... params) {
        Resources res = getResources();
        List<String> Items = Arrays.asList(res.getStringArray(R.array.Items));
        for (String it : Items) {
            if (it.contains("blue")) { blue = true; } else { blue = false; }    
            publishProgress(it);
        }
        return null;
    }

    @SuppressWarnings("unchecked")
    @Override
    protected void onProgressUpdate(String... item) {
        ((ArrayAdapter<String>)getListAdapter()).add(item[0]);
        // Change the color of the current item depending on "blue"
    }
} 
```

这可能吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T03:55:34.540

您需要`getView`在自定义适配器中覆盖，并提供您自己的自定义视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:45:44.573

当然，您可以将元素添加到您的数组适配器。但是有几个问题需要注意：

1.  传入一个 ArrayList 或其他任何你可以实际调用`add`的地方
2.  不要忘记调用 setNotifyOnChange(true);

所以总的来说应该这样做。但是，我不确定我是否理解您使用添加项目的 AsyncTask 的原因和操作...

为什么不在创建 ListView 时添加它们？有什么我错过的吗？

# performance - TCP 接收窗口

> ID：10289604
> 
> 赞同：4
> 
> 时间：2012-04-23T23:18:09.787
> 
> 标签：performance, networking, tcp, latency, throughput

我试图了解接收器窗口如何影响高延迟连接的吞吐量。

我在相距很远的两台机器上有一对简单的客户端-服务器应用程序，两者之间的连接为 250 毫秒延迟 RTT。我在 Windows (XP, 7) 和 Linux (Ubuntu 10.x) 上运行了这个测试，结果相同，所以为了简单起见，我们假设以下情况：客户端接收数据：WinXP Pro 服务器发送数据：Win7 Pro 再次，延迟为 250 毫秒 RTT。

我在不更改客户端上的接收器缓冲区大小（默认为 8Kb）的情况下运行 TCP 测试，并且在线上看到（使用 Wireshark）：

*   客户端向服务器发送 ACKS 并且 TCP 数据包包含 RWIN=65k
*   服务器发送数据并报告 RWIN=65k

查看跟踪，我看到了 3-4 个数据包的突发（有效负载为 1460 字节），紧随其后的是从客户端机器发送到服务器的 ACK，然后在大约 250 毫秒内什么都没有，然后是来自服务器的新数据包突发给客户。

因此，总而言之，服务器似乎在填满接收器窗口之前也没有发送新数据。

为了进行更多测试，这次我还运行了相同的测试，更改了客户端机器上的接收器缓冲区大小（在 Windows 上，更改接收器的缓冲区大小最终会影响机器通告的 RWIN）。我希望在阻塞 ACK 之前看到大量的数据包......并且至少有更高的吞吐量。

在这种情况下，我将 recv 缓冲区大小设置为 100,000,000。从客户端到服务器的数据包现在有一个 RWIN=99,999,744（嗯，这很好），但不幸的是，从服务器发送到客户端的数据模式仍然是相同的：短暂的突发，然后是长时间的等待。为了确认我在网络上看到的内容，我还测量了从服务器向客户端发送大量数据的时间。我没有看到使用大 RWIN 或使用默认值的任何变化。

谁能帮助我理解为什么更改 RWIN 并不会真正影响吞吐量？

几点注意事项： - 服务器使用 8Kb 块的 write() 尽可能快地发送数据 - 正如我之前所说，我在使用 Linux 时也看到了类似的效果。更改接收缓冲区大小会影响节点使用的 RWIN，但吞吐量保持不变。- 我在数百个数据包后分析跟踪，给​​ TCP 慢启动机制足够的时间来扩大 CWIN 大小。

* * *

正如建议的那样，我在这里添加了一个线迹的小快照

```
No.     Time        Source                Destination           Protocol Length Info
     21 2.005080    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=11681 Win=99999744 Len=0
     22 2.005109    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=19305 Ack=1 Win=65536 Len=1460
     23 2.005116    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=20765 Ack=1 Win=65536 Len=1460
     24 2.005121    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=22225 Ack=1 Win=65536 Len=1460
     25 2.005128    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      946    21500 > 57353 [PSH, ACK] Seq=23685 Ack=1 Win=65536 Len=892
     26 2.005154    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=14601 Win=99999744 Len=0
     27 2.007106    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=16385 Win=99999744 Len=0
     28 2.007398    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=24577 Ack=1 Win=65536 Len=1460
     29 2.007401    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=26037 Ack=1 Win=65536 Len=1460
     30 2.007403    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=27497 Ack=1 Win=65536 Len=1460
     31 2.007404    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=28957 Ack=1 Win=65536 Len=1460
     32 2.007406    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=30417 Ack=1 Win=65536 Len=1460
     33 2.007408    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      946    21500 > 57353 [PSH, ACK] Seq=31877 Ack=1 Win=65536 Len=892
     34 2.007883    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=19305 Win=99999744 Len=0
     35 2.257143    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=22225 Win=99999744 Len=0
     36 2.257160    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=24577 Win=99999744 Len=0
     37 2.257358    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=32769 Ack=1 Win=65536 Len=1460
     38 2.257362    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=34229 Ack=1 Win=65536 Len=1460
     39 2.257364    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=35689 Ack=1 Win=65536 Len=1460
     40 2.257365    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=37149 Ack=1 Win=65536 Len=1460 
```

如您所见，服务器在数据包 #33 处停止发送数据。

客户端在旧数据包的数据包 #34 处发送 ACK（seq=19305，在数据包 #20 上发送，此处未显示）。使用 100Mb 的 RWIN，我希望服务器不会阻塞一段时间。

在 20-30 个数据包之后，服务器端的拥塞窗口应该足够大，可以发送比我看到的更多的数据包……我假设拥塞窗口最终会增长到 RWIN……但是，即使在一百数据包的模式是相同的：数据数据然后阻塞 250 毫秒......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T02:26:26.947

我可以从您提供的样本中猜出两件事：

1.  服务器有一个大约 15k 的发送缓冲区。
2.  您提供的转储是在服务器端完成的。

要将 TCP 连接的窗口缩放到一定大小，发送方的发送缓冲区和接收方的接收缓冲区都必须足够大。

实际使用的窗口是接收者提供/请求的接收窗口和发送者的操作系统设置的发送缓冲区大小中的最小值。

长话短说，您需要在服务器上配置发送缓冲区大小。

为了清楚起见，让我们逐包分析您的示例数据包。

服务器发送另一组数据：

```
 22 2.005109    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=19305 Ack=1 Win=65536 Len=1460
 23 2.005116    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=20765 Ack=1 Win=65536 Len=1460
 24 2.005121    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=22225 Ack=1 Win=65536 Len=1460
 25 2.005128    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      946    21500 > 57353 [PSH, ACK] Seq=23685 Ack=1 Win=65536 Len=892 
```

注意`PSH`. 这是一个标志，指示其间的任何跃点已发送完整的数据块，请将其发送到另一端。（在这种情况下，“完整”块是您的 8kb）

当服务器仍在发送时，它会收到 2 个 ACK​​S：

```
 26 2.005154    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=14601 Win=99999744 Len=0
 27 2.007106    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=16385 Win=99999744 Len=0 
```

特别注意数字：`Ack=14601`和`Ack=16385`。这些数字是接收方正在确认的数据包的序列号。

Ack=14601 的意思是“我收到了 seq no 14601 之前的所有内容”。

另请注意，这些是较旧的数据，不在您提供的示例中。

所以服务器处理这些 ACK 并继续发送数据：

```
 28 2.007398    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=24577 Ack=1 Win=65536 Len=1460
 29 2.007401    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=26037 Ack=1 Win=65536 Len=1460
 30 2.007403    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=27497 Ack=1 Win=65536 Len=1460
 31 2.007404    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=28957 Ack=1 Win=65536 Len=1460
 32 2.007406    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=30417 Ack=1 Win=65536 Len=1460
 33 2.007408    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      946    21500 > 57353 [PSH, ACK] Seq=31877 Ack=1 Win=65536 Len=892 
```

这里我们有一个完整的数据块：1460*5+892 == 8192。

然后，在发送最后一个数据包后 0.443 毫秒，它又收到一个 ACK​​：

```
 34 2.007883    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=19305 Win=99999744 Len=0 
```

然后有一个几乎正好是 250 毫秒的延迟，在此期间服务器什么也不发送，然后才收到这些：

```
 35 2.257143    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=22225 Win=99999744 Len=0
 36 2.257160    CCC.CCC.CCC.CCC       sss.sss.sss.sss       TCP      60     57353 > 21500 [ACK] Seq=1 Ack=24577 Win=99999744 Len=0 
```

然后继续发送：

```
 37 2.257358    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=32769 Ack=1 Win=65536 Len=1460
 38 2.257362    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=34229 Ack=1 Win=65536 Len=1460
 39 2.257364    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=35689 Ack=1 Win=65536 Len=1460
 40 2.257365    sss.sss.sss.sss       CCC.CCC.CCC.CCC       TCP      1514   21500 > 57353 [ACK] Seq=37149 Ack=1 Win=65536 Len=1460 
```

这里有两件非常有趣的事情需要注意。
首先，服务器在没有等待 ACK 的情况下发送了多少字节。Te last ACK seq no 服务器在该延迟之前收到的`Ack=19305`，并且服务器在该点发送的最后一个数据包的 seq no 是`Seq=30417`。

因此，在暂停期间，服务器已发送 11112 个字节尚未被客户端确认。

其次，这是服务器在发送一堆数据后立即收到的一个 ACK​​，这并没有触发它发送更多数据。好像那个 ACK​​ 还不够好。

在此之前收到的 ACK 是`Ack=16385`30417-16385=14032 字节，当时服务器未确认这些字节。只有在收到 seq no 24577 的 ACK 后，将该计数减少到 30417-24577=5840，服务器才开始再次发送。

因此，与 16k 的有效窗口大小相比，8k 缓冲区大小的事实意味着吞吐量实际上有所降低，因为服务器不会发送任何 8k 块，直到有空间容纳所有块。

最后，对于那些想知道的人，有一个称为窗口缩放的 TCP 选项，它允许连接的一端声明窗口大小实际上是 TCP 标头中数字的倍数。参见[RFC 1323](https://www.rfc-editor.org/rfc/rfc1323)。该选项在 SYN 数据包中传递，因此它们在连接中不可见 - 仅提示窗口缩放有效，因为窗口大小 TCP 标头小于正在使用的窗口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:37:32.213

连接套接字后，您无法将接收缓冲区大小设置为 >= 64k。你必须先做。在服务器的情况下，这意味着在侦听套接字上设置接收缓冲区大小：接受的套接字从接受它们的套接字继承它。如果您不这样做，则无法协商 TCP 窗口缩放选项，因此对等方无法相互告知超过 64k 的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:24:30.340

在发送机器收到接收方的 ack 的那一刻，发送机器排队发送的数据有多少？因为 TCP 是基于流的协议，在数据流中没有数据包中断，所以 TCP 发送方无法知道何时应该发送部分数据包，以及何时应该等待更多数据到达。通常，如果 TCP 实现接收到一个数据包的 ACK，它将决定是否值得传输它所拥有的任何内容，直到传输缓冲区为空，但如果数据在此之后排队等待传输，它可能会等到它收到另一个 ACK​​ 后再发送另一个批。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T23:59:26.797

接收器窗口大小直接影响吞吐量。吞吐量 <= RWIN/RTT。

一些事情也会降低吞吐量。标头中的 ECN 位是否设置为 1？你知道两边是否有丢包吗？好像服务器超时了。能否在客户端打印传入数据包和传出 ACK 的序列号，并在服务器端打印类似信息。如果接收者的序列号是 5 并且接收到 6,7,8,9，它将 ACK 6,7,8,9。但是如果 6 丢失，它会在收到数据包 7、8、9 时 ACK 5。序列号可以揭示很多信息。

250 毫秒的暂停似乎是超时。

[慢启动](http://en.wikipedia.org/wiki/Slow-start "慢启动")

> 该算法从指数增长阶段开始，最初拥塞窗口大小 (cwnd) 为 1 或 2 个分段，并且对于每个收到的 ACK 将其增加 1 个分段大小 (SS)。由于接收器通常每两个段发送一个 ACK​​，因此这种行为有效地使网络每次往返的窗口大小加倍。这种行为一直持续到拥塞窗口大小 (cwnd) 达到接收方通告窗口的大小或发生丢失。

可能发生的情况是
服务器发送 1 个数据包，获得 1 个确认
服务器发送 2 个数据包，获得 2 个确认（2,3）
服务器发送 4 个数据包，获得 4 个确认（4,5,6,7）
服务器发送 8 个数据包，获得 4 个acks（在客户端收到之前丢弃的数据包）（8,9,10,11）（超时12）
服务器发送4个数据包，获得4个acks（12,13,14,15）
服务器发送5个数据包，获得4个acks（16， 17,18,19)(timeout 20)
服务器发送 3 个数据包，获得 3 个确认(20,21,22)
服务器发送 4 个数据包，获得 4 个确认(23,24,25,26)
服务器发送 5 个数据包，获得 4 个确认(27,28,29,30)(timeout 31)
服务器继续 3,4,5 循环

# objective-c - 在连接外接显示器的情况下关闭 MacBook 盖子时运行代码

> ID：10289612
> 
> 赞同：0
> 
> 时间：2012-04-23T23:18:58.357
> 
> 标签：objective-c, osx-lion

当我的 MacBook 的盖子关闭时，我想在连接外接显示器时收到通知。

插入外接显示器时，Lion 会阻止计算机进入睡眠状态，因此我无法收听睡眠通知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:59:21.850

您可以使用 Quartz Display Services 来观察显示配置的变化。见[`CGDisplayRegisterReconfigurationCallback()`](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/Quartz_Services_Ref/Reference/reference.html#//apple_ref/c/func/CGDisplayRegisterReconfigurationCallback)。

# opengl-es - 插值纹理坐标

> ID：10289616
> 
> 赞同：2
> 
> 时间：2012-04-23T23:19:21.607
> 
> 标签：opengl-es, grid, texture-mapping

我正在研究使用纹理贴图来保存网格值的 OpenGL ES[流体模拟。](http://www.dgp.toronto.edu/people/stam/reality/Research/pdf/GDC03.pdf)我需要遍历模仿以下循环的网格：

```
for (int r = 0; r < 128; r++)
   for (int c = 0; c < 128; c++)
      process grid element at (c,r) 
```

为了遍历网格，我只是填充了一个四边形，这会导致为每个片段调用我的片段程序。纹理坐标 (0,0), (1,0), (0,1), (1,1) 与顶点 (-1,-1), (+1,-1), (-1 ,+1), (+1,+1) 并将四边形（作为三角形条带）渲染为附加到 FBO 的 128x128 纹理贴图，如下所示：

```
glBindFramebuffer(GL_DRAW_FRAMEBUFFER, texFrameBuffer);
glViewport(0, 0, TEX_IMAGE_WIDTH, TEX_IMAGE_HEIGHT); // 128 x 128

glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer);
glEnableVertexAttribArray(positionAttr);
glVertexAttribPointer(positionAttr, 2, GL_FLOAT, GL_FALSE, 0, 0);

glBindBuffer(GL_ARRAY_BUFFER, texCoordBuffer);
glEnableVertexAttribArray(texCoordAttr);
glVertexAttribPointer(texCoordAttr, 2, GL_FLOAT, GL_FALSE, 0, 0);

glDrawArrays(GL_TRIANGLE_STRIP, 0, 4); 
```

顶点着色器仅通过未修改的位置和纹理坐标。为了了解正在生成什么纹理坐标，我决定将纹理坐标捕获到图像中。片段程序将其给定的 2D 纹理坐标分配给输出颜色的红色和绿色通道：

```
varying vec4 texCoord;
void main() {
  gl_FragColor = vec4(texCoord.st,0,1);
} 
```

然后我使用`glGetTexImage()`将纹理图像读回客户端空间。以下是图像中每个像素的生成纹理坐标 (s,t) 的示例：

```
(column, row) = [s, t] -> (128*s, 128*t)

(0,0) = [0.00392157, 0.00392157] -> (0,0)
(1,0) = [0.01176471, 0.00392157] -> (1,0)
(2,0) = [0.01960784, 0.00392157] -> (2,0)
(3,0) = [0.02745098, 0.00392157] -> (3,0)
(4,0) = [0.03529412, 0.00392157] -> (4,0)
(5,0) = [0.04313726, 0.00392157] -> (5,0)
(6,0) = [0.05098040, 0.00392157] -> (6,0)
(7,0) = [0.05882353, 0.00392157] -> (7,0)
(8,0) = [0.06666667, 0.00392157] -> (8,0)
(9,0) = [0.07450981, 0.00392157] -> (9,0)
(10,0) = [0.08235294, 0.00392157] -> (10,0)
<snip>
(125,0) = [0.98039222, 0.00392157] -> (125,0)
(126,0) = [0.98823535, 0.00392157] -> (126,0)
(127,0) = [0.99607849, 0.00392157] -> (127,0)
(0,1) = [0.00392157, 0.01176471] -> (0,1)
(1,1) = [0.01176471, 0.01176471] -> (1,1)
(2,1) = [0.01960784, 0.01176471] -> (2,1)
<snip>
(124,127) = [0.97254908, 0.99607849] -> (124,127)
(125,127) = [0.98039222, 0.99607849] -> (125,127)
(126,127) = [0.98823535, 0.99607849] -> (126,127)
(127,127) = [0.99607849, 0.99607849] -> (127,127) 
```

现在的问题。我试图理解这些生成的坐标。魔法值`0.00392157`是`(0.5 * 1/127.5)`。我了解 0.5 因子，它充当预先添加的舍入值，但为什么是 127.5？ `(0.5 * 1/128.0)`会更有意义吗？谁能解释一下这些坐标？我只想从纹理坐标生成整数网格坐标（`sampler2Drect` 在 OpenGL ES 中没有）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T03:00:20.833

我总是为此苦苦挣扎，所以让我们看看我是否能解释一下。

想象一下你的网格的一排。在下图中，我已为该行中的每个片段 (0-127) 编号。我也在像素下方放置了一些纹理坐标。请注意，最左边是 0.0，最右边是 1.0。

```
 +-----------+-----------+-----------+-----------+---    ---+-----------+
 |           |           |           |           |          |           |
 |           |           |           |           |          |           |
 |     0     |     1     |     2     |     3     |   . . .  |    127    |
 |           |           |           |           |          |           |
 |           |           |           |           |          |           |
 +-----------+-----------+-----------+-----------+---    ---+-----------+
 ^           ^           ^           ^                      ^           ^
 |           |           |           |                      |           |
 |           |           |           |                      |           |
0/128       1/128       2/128       3/128                127/128     128/128 
```

当渲染器想要对片段进行纹理处理时，它使用片段*中心*的纹理坐标——数字所在的位置。请注意，片段 0 的中心位于 0/128（又名 0）和 1/128（又名 .0078125）之间。那是 1/256（又名 0.00390625）。

所以，我认为公式会更好地表示为：

```
coordinate = (pixelId + 0.5) / 128 
```

这是一些得到与您*类似*的答案的python ：

```
for i in range(128):
   print (0.5 + i) / 128

0.00390625
0.01171875
0.01953125
0.02734375
0.03515625
0.04296875
...
0.97265625
0.98046875
0.98828125
0.99609375 
```

我怀疑我的结果和您的结果之间的差异与您的值被压缩到一个 [8 位] 颜色通道以从着色器返回它们的事实有关。

我希望这有帮助。

# clojure - clojure/ring/jetty：我正在使用 > lein ring 服务器。如何配置实例化的码头实例？

> ID：10289617
> 
> 赞同：10
> 
> 时间：2012-04-23T23:19:25.250
> 
> 标签：clojure, jetty, leiningen, ring

当我直接调用码头处理程序时，我能够像这样传递一个配置器：

```
(def header-buffer-size 8388608)
(defn start [port]
  (ring/run-jetty
   (var app)
   {:port port
    :join? false
    :host "127.0.0.1"
    :configurator
    (fn [jetty]
      (doseq [connector (.getConnectors jetty)]
        (.setHeaderBufferSize connector header-buffer-size)))})) 
```

我必须这样做，因为我在发布时不断收到 FULL HEAD 错误。现在我重构了直接使用 > lein ring server 的东西，它是从命令行调用的。

```
> lein ring server 
```

这使用了我的 project.clj 中指定的一些配置：

```
:ring {:handler caribou.api.core/app
       :servlet-name "caribou-api"
       :init caribou.api.core/init
       :port 33443} 
```

这很好用，但现在我又遇到了 FULL HEAD 问题。所以我尝试在那里添加一个配置器：

```
:ring {:handler caribou.api.core/app
       :servlet-name "caribou-api"
       :init caribou.api.core/init
       :configurator
       (fn [jetty]
         (doseq [connector (.getConnectors jetty)]
           (.setHeaderBufferSize connector 8388608)))
       :port 33443}) 
```

这个堆栈跟踪失败了：

```
Exception in thread "main" java.lang.ClassCastException: 
clojure.lang.PersistentList cannot be cast to clojure.lang.IFn
  at ring.adapter.jetty$run_jetty.invoke(jetty.clj:66)
  at ring.server.standalone$serve$fn__833.invoke(standalone.clj:78)
  at ring.server.standalone$try_port.invoke(standalone.clj:12)
  at ring.server.standalone$serve.doInvoke(standalone.clj:75)
  at clojure.lang.RestFn.invoke(RestFn.java:423)
  at ring.server.leiningen$serve.invoke(leiningen.clj:20) 
```

我认为这与将函数直接放在地图中有关，因此我在项目外部（在 caribou.api.core 中）定义了它，并尝试像在其他地方定义的其余函数一样引用它：

```
;; in caribou/api/core.clj
(def header-buffer-size 8388608)
(defn full-head-avoidance
  [jetty]
  (doseq [connector (.getConnectors jetty)]
    (.setHeaderBufferSize connector header-buffer-size)))

;; in project.clj
:ring {:handler caribou.api.core/app
       :servlet-name "caribou-api"
       :init caribou.api.core/init
       :configurator caribou.api.core/full-head-avoidance
       :port 33443}) 
```

这会启动应用程序，但我在发布时仍然收到 413: FULL HEAD 错误。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T00:34:43.733

`defproject`默认情况下不会评估写在表单中的内容，但您可以在需要时使用`~`(unquote) in ：`defproject`

```
(defproject foo "1.2.3"
  ...
  :some-fn-key ~(fn [& args] ...)) 
```

在这种特殊情况下，您将`fn`取消引用定义配置器函数的表单（没有取消引用被用作包含一堆符号的列表，而不是编译成函数）。

或者，您可以在`defproject`表单外部定义配置器并在内部引用其名称，`defproject`就像在您的第二种方法中一样，但是您需要取消引用内部名称`defproject`- 否则它将被视为符号。注意。在后一种情况下不会产生异常，因为符号实际上是可调用的并接受任意参数（但只有`nil`在使用映射或集合以外的东西调用时才会返回；使用映射或集合，它们会在参数中查找自己）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T03:50:12.970

答案是不要使用 ring server，直接用 ring/ring-jetty-adapter 启动 jetty。这样我仍然可以传入配置器，顺便说一句，它已更改为：

```
(defn full-head-avoidance
  [jetty]
  (doseq [connector (.getConnectors jetty)]
    (.setRequestHeaderSize connector header-buffer-size))) 
```

# java - 河内爪哇塔

> ID：10289618
> 
> 赞同：0
> 
> 时间：2012-04-23T23:19:27.953
> 
> 标签：java, towers-of-hanoi

这是我正在做的作业。我创建了 2 个类来玩河内塔。第一个基本上是运行实际游戏类的跑步者。

```
import java.util.Scanner;

class TowersRunner {

    public static void main(String[] args) {
        TowersOfHanoi towers = new TowersOfHanoi();
        towers.TowersOfHanoi()
    }
}

public class TowersOfHanoi {
    public static void main(String[] args) {

        System.out.println("Please enter the starting " + "number of discs to move:");
        Scanner scanner = new Scanner(System.in);
        int num_of_discs = scanner.nextInt();

        solve(num_of_discs, 'A', 'B', 'C');
    }

    public static void solve(int first_disc, char aTower, char bTower, char cTower) {
        if (first_disc == 1) {
            System.out.println("Disk 1 on tower " + aTower + " moving to tower " + cTower);
        } else {
            solve(first_disc - 1, aTower, cTower, bTower);
            System.out.println("Disk " + first_disc + " on tower " + aTower + " moving to tower " + cTower);
            solve(first_disc - 1, bTower, aTower, cTower);
        }
    }
} 
```

我需要帮助的是让`TowersOfHanoi`班级从我的`TowersRunner`班级开始。`TowersOfHanoi`我还需要实现一个计数器，显示游戏在我的课堂上完成之前运行了多少次。基本上我需要的线是`System.out.println("It took" + counter + "turns to finish.");`

我不知道如何正确实现计数器。此外，不能让 runner 类运行`TowersOfHanoi`. 课程本身运行良好，`TowersOfHanoi`但家庭作业的要求是我们至少需要 2 节课。

帮助将不胜感激！！！请我是Java和一般编程的新手，请不要对我太先进。:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:48:52.033

您不需要 TowersOfHanoi 类中的 main-Function。相反，将您的 TowersRunner main(String args[]) 方法替换为

```
public static void main(String[] args) {    
    System.out.println("Please enter the starting " + "number of discs to move:");
    Scanner scanner = new Scanner(System.in);
    int num_of_discs = scanner.nextInt();
    TowersOfHanoi.solve(num_of_discs, 'A', 'B', 'C');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:29:08.807

您可以在函数中传递计数器并使其递增。例如：

```
public static void solve(int first_disc, char aTower, char bTower, char cTower, int counter) {
    System.out.println("Currently on turn #" + counter);

    if (first_disc == 1) {
        System.out.println("Disk 1 on tower " + aTower + " moving to tower " + cTower);
    } else {
        solve(first_disc - 1, aTower, cTower, bTower, counter + 1);
        System.out.println("Disk " + first_disc + " on tower " + aTower + " moving to tower " + cTower);
        solve(first_disc - 1, bTower, aTower, cTower, counter + 1);
    }
} 
```

在第一次调用 时`solve`，您将传入 1。如您所见，每次`solve`递归调用时，计数器都会递增。

我会让你调整它以返回 counter 的最终值 :) 如果你只需要最终值，则根本不需要添加参数。只需让函数返回`int`，而不是`void`尝试弄清楚如何让它返回你想要的值。

# php - PHP在确切日期重定向

> ID：10289625
> 
> 赞同：0
> 
> 时间：2012-04-23T23:20:05.930
> 
> 标签：php, date, redirect

我正在使用此代码根据一天中的时间和星期几进行重定向。

这里是 ..

```
<?php

$hour = date('G');
$minute = date('i');
$day = date('w');
$m = $hour * 60 + $minute; // Minutes since midnight.

if (
  $day == 0    // Sunday...
  && $m >= 615 // ... after 10:15…
  && $m <= 700 // ... but before 11:40…
) {
  header("Location: open.php");
}
else
if (
  $day == 3     // Wednesday...
  && $m >= 1125 // ... after 18:45…
  && $m <= 1235 // ... but before 20:35…
) {
  header("Location: open.php");
}

?> 
```

我想知道是否有办法根据未来的确切日期（例如 4 月 25 日或 11 月 1 日）重定向到页面。

谢谢 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:27:38.940

这是一种简单的方法，不考虑年份：

```
// 25th april:
if (date('d') == '25' && date('m') == '4') {
  header('Location: open.php');
}
// 1st nov:
if (date('d') == '1' && date('m') == '11') {
  header('Location: open.php');
} 
```

查看[date() 文档](http://php.net/date)以获取更准确的详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:24:12.400

`strtotime()`使用or将重定向日期转换为时间戳`date()`，您可以轻松完成

```
if(strtotime("2012/5/3") <= time()) {
     header("location: toredirect.php");
     exit;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T23:24:40.150

当然。

```
$date = date();
$redirectDate = Date here;

if($date == $redirectDate) {
    header("Location: open.php");
} 
```

这将基于您的服务器日期/时间

# entity-framework - 在 ExecuteStoreQuery EF 中执行存储过程。这是 EF 中的错误吗？

> ID：10289626
> 
> 赞同：4
> 
> 时间：2012-04-23T23:20:11.397
> 
> 标签：entity-framework

尝试使用以下代码在 EF 中执行存储的过程：

```
var params = new object[] {new SqlParameter("@FirstName", "Bob")};
return this._repositoryContext.ObjectContext.ExecuteStoreQuery<ResultType>("GetByName", params); 
```

但不断收到此错误：

> 过程或函数“GetByName”需要未提供的参数“@FirstName”。

并来自 sql 探查器：

```
exec sp_executesql N'GetByName',N'@FirstName nvarchar(100),@FirstName=N'Bob' 
```

上面的 ExecuteStoreQuery 代码有什么问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-23T23:46:22.393

忽略这`params`是一个保留字的事实......

认为您的查询需要：

```
var params = new object[] {new SqlParameter("@FirstName", "Bob")};
return this._repositoryContext.ObjectContext.ExecuteStoreQuery<ResultType>("exec GetByName @FirstName", params); 
```

还应该说，如果该过程是您的数据库和数据模型的标准部分，那么您应该[将它导入您的 EDM](http://msdn.microsoft.com/en-us/library/bb896231.aspx)，以便它可以直接在您的上下文中使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T23:38:23.797

使用更适合“临时”查询的 ExecuteFunction 而不是 ExecuteStoreQuery。

```
var parameters = new ObjectParameter[] {new ObjectParameter("FirstName", "Bob")};
return this._repositoryContext.ObjectContext.ExecuteFunction<ResultType>("GetByName", parameters); 
```

存储过程也可以映射为上下文中的函数，因此可以用作类型化方法。看看[将存储过程与实体框架一起使用](http://weblogs.asp.net/dotnetstories/archive/2011/03/01/using-stored-procedures-with-entity-framework-in-an-asp-net-application.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-22T12:22:51.273

如果您有多个参数，这就是我在 EF 中使用 SP 所做的：-

```
 public virtual ObjectResult<GetEpisodeCountByPracticeId_Result> GetEpisodeCountByPracticeId(Nullable<int> practiceId, Nullable<System.DateTime> dat1)
    {

        SqlParameter practiceIdParameter = practiceId.HasValue ?
            new SqlParameter() { ParameterName = "practiceId", Value = practiceId, SqlDbType = SqlDbType.Int } :
            new SqlParameter() { ParameterName = "practiceId", SqlDbType = SqlDbType.Int }; 

        SqlParameter dat1Parameter = dat1.HasValue ?
            new SqlParameter() { ParameterName = "dat1", Value = dat1, SqlDbType = SqlDbType.DateTime }:
            new SqlParameter() { ParameterName = "dat1", SqlDbType = SqlDbType.DateTime }; 

        return ((IObjectContextAdapter)this).ObjectContext.ExecuteStoreQuery<GetEpisodeCountByPracticeId_Result>("exec GetEpisodeCountByPracticeId @practiceId, @dat1", practiceIdParameter, dat1Parameter);
    } 
```

如果您没有在 commandText 属性中添加参数（例如@practiceId），那么您会收到收到的错误

# html - 如何在 GET 请求中传递单选按钮？

> ID：10289627
> 
> 赞同：1
> 
> 时间：2012-04-23T23:20:28.020
> 
> 标签：html, ruby, radio-button, sinatra

单选按钮如何作为参数传递？我正在使用 Ruby Sinatra Web 服务器。如何获取服务器端所选单选按钮的值？

HTML

```
<form method="get" action="/register">
  <input type="radio" name="regRadio" value="1" />
  <input type="radio" name="regRadio" value="2" />
  <input type="radio" name="regRadio" value="3" />
  <input type="radio" name="regRadio" value="4" />
</form> 
```

红宝石

```
get '/register' do
  params[:regRadio]??
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T09:10:34.850

首先，方法应该是`post`代替`get`. 其余的似乎都很好。这对我有用：

```
require 'sinatra'

get '/' do
  <<-HTML
    <form method="post" action="/register">
      <input type="radio" name="regRadio" value="1" />
      <input type="radio" name="regRadio" value="2" />
      <input type="radio" name="regRadio" value="3" />
      <input type="radio" name="regRadio" value="4" />
      <input type="submit" value="Register"/>
    </form>
  HTML
end

post '/register' do
  "You selected #{params[:regRadio]}"
end 
```

当您选择第三项并点击“注册”时

![形式](../Images/08108ab075a9bcd049af51c7ed4a72e9.png)

你会得到以下结果：

![结果](../Images/044edae64ebe9d6534c09db3c846ebeb.png)

如果这对您不起作用，则问题出在其他地方。在这种情况下，请向我们展示您的实际代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:22:46.787

这只是一个通用的提示，因为它是http，在ruby中应该是一样的。

该值设置在名称上，即 regRadio。由于两个单选按钮的值都为 1，因此如果未设置，则值始终为 1 或没有。所以其中之一应该是例如2。

# jpanel - 如何使关闭 JPanel 触发方法

> ID：10289630
> 
> 赞同：2
> 
> 时间：2012-04-23T23:20:57.737
> 
> 标签：jpanel

我从 Oracle 教程中获得了一个 JPanel 示例，我看到它使用默认方法关闭窗口

```
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
```

我想要的是单击关闭按钮时关闭窗口的行为，以触发另一种方法。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-23T23:25:11.880

```
frame.addWindowListener(new WindowAdapter() {
  public void windowClosing(WindowEvent e) {
    //do something
  }
}); 
```

请参阅：[http ://docs.oracle.com/javase/7/docs/api/java/awt/event/WindowListener.html#windowClosing%28java.awt.event.WindowEvent%29](http://docs.oracle.com/javase/7/docs/api/java/awt/event/WindowListener.html#windowClosing%28java.awt.event.WindowEvent%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:22:30.390

当您尝试终止 Swing 或控制台程序时，将执行此代码。

```
Runtime.getRuntime().addShutdownHook(new Thread()
{
    @Override
    public void run()
    {
        //code goes here
    }
}); 
```

# ruby - 如何在使用 Nokogiri 构建的 HTML 文档中的链接中添加锚文本？

> ID：10289635
> 
> 赞同：0
> 
> 时间：2012-04-23T23:21:26.200
> 
> 标签：ruby, nokogiri

我想要做的就是创建一个 HTML 页面，其中包含与该文本关联的链接和名称/文本列表。

例如`<a href="www.google.com">Google</a>`

我可以在哪里更改`Google`为我想要的任何文本（包括来自变量的数据）。

我有这个：

```
builder = Nokogiri::HTML::Builder.new do |doc|
    doc.html {
        doc.body {
            contents.each do |i|
                doc.p {
                    doc.a(:href => list.first)
                    } 
            end         
            }           
        }
end 
```

这只是产生这个：

```
<html><body><p><a href="someurl.com"></a></p></body></html> 
```

我想要的是：

```
<html><body><p><a href="someurl.com">First Link</a></p></body></html> 
```

我如何在 Nokogiri 中做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:47:29.593

```
doc.a 'text_goes_here', :href => 'href_goes_here' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:29:08.430

其实……刚想通。

我所要做的就是添加`doc.text "First Link"`.

所以更新后的代码片段如下所示：

```
builder = Nokogiri::HTML::Builder.new do |doc|
    doc.html {
        doc.body {
            contents.each do |i|
                doc.p {
                    doc.a(:href => list.first) {
                          doc.text "First Link"
                        }
                    } 
            end         
            }           
        }
end 
```

奇迹般有效。

# ios - 无需 InAppPurchase 即可解锁内容

> ID：10289637
> 
> 赞同：1
> 
> 时间：2012-04-23T23:21:29.750
> 
> 标签：ios, app-store, in-app-purchase

我的需要是为购买有形产品的用户解锁内容，更具体地说，是一本书。

事实上，该应用程序将是互补的，而不是主要产品。第一个想法是在每本书中发送一个解锁代码。

知道 InAppPurchase 是在 iOS 应用程序中解锁内容的常用方法，并且知道 Apple 可以将此视为避免 InAppOurchase 的解决方法，我想问一下是否有人已经成功地做到了这一点，并且在 Apple 批准方面没有任何问题。

在没有 InAppPurchase 的情况下解锁内容是否符合 App Store 规则？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T05:26:44.793

我认为，根据 Apple 的指南，如果您决定制作这样的解锁功能，您的应用很可能会被拒绝

```
11.1 - Apps that unlock or enable additional features or functionality with mechanisms other than the App Store will be rejected 
```

所以，你最好不要尝试这样做。

# ssis - 如何使用 SSIS 将固定宽度的平面文件导入数据库？

> ID：10289640
> 
> 赞同：17
> 
> 时间：2012-04-23T23:22:11.310
> 
> 标签：ssis, flat-file

有没有人有关于如何使用 SSIS 包将固定宽度的平面文件导入数据库的教程？

我有一个包含不同长度列的平面文件。

```
Column name    Width
-----------    -----
First name        25
Last name         25
Id                 9
Date               8 
```

如何将平面文件转换为列？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-04-24T07:10:35.060

*这是一个使用SSIS 2008 R2*创建的示例包，它解释了如何将平面文件导入数据库表。

*   创建一个以数据命名的固定宽度平面文件`Fixed_Width_File.txt`，如屏幕截图所示。屏幕截图使用 Notepad++ 显示文件内容。它具有显示回车和换行等特殊字符的能力。**`CR LF`**表示行分隔符*回车*和*换行*。

![平面文件数据](../Images/a3258f979d477a7ce693bca055df0fc1.png)

*   在 SQL 服务器数据库中，使用*SQL 脚本*部分`dbo.FlatFile`下提供的创建脚本创建一个名为的表。

**   创建一个新的 SSIS 包并添加一个新的 OLE DB 连接管理器，该管理器将连接到 SQL Server 数据库。假设 OLE DB 连接管理器被命名为*SQLServer*。* 

 *![连接管理器](../Images/dcfc500aeb9c106c6cdf456c5a841f27.png)

*   在包的控制流选项卡上，放置一个*数据流任务*。

![数据流任务](../Images/181b96dad4e7d183ea5a08d1c089021b.png)

*   双击数据流任务，您将被带到数据流选项卡。在数据流选项卡上，放置一个*平面文件源*。双击平面文件源，将出现*平面文件源编辑器*。单击*新建*按钮打开*平面文件连接管理器编辑器*。

*   在*Flat File Source Editor的 General 部分，在**Connection manager name*中输入一个值（比如*Source*），然后浏览到平面文件位置并选择文件。此示例使用路径中的示例文件`C:\temp\Fixed_Width_File.txt`如果文件中有标题行，您可以在跳过标题行文本框中输入值 1 以跳过标题行。

![平面文件连接管理器编辑器常规](../Images/fe3f8c825209b91ef4904537a8f9635b.png)

*   单击*列*部分。根据您的选择更改字体我选择了 Courier New，这样我可以用更少的滚动来查看更多数据。在行宽文本框中输入值`69`。该值是所有列的宽度之和 + 2 的行分隔符。设置正确的行宽后，您应该可以在源数据列部分正确地看到固定宽度的文件数据。现在，您必须单击适当的位置来确定列限制。请注意第 4、5、6 节和下面的屏幕截图。

![平面文件连接管理器编辑器列](../Images/7bc4a125e9b8986a6a9b869ea923bf40.png)

*   单击*高级*部分。您会注意到根据我们在上一步中在“列”部分*设置的列限制自动为您创建了 5 列。*第五列是行分隔符。

![平面文件连接管理器编辑器高级](../Images/9fe28d63eab8e292eb85a13b10260a91.png)

*   将列名重命名为`FirstName`、`LastName`、`Id`和`Date``RowDelimiter`

![平面文件连接管理器编辑器高级重命名](../Images/8b588154c75cbd6f08a2973d2be0e4f1.png)

*   默认情况下，将使用 DataType 字符串 [DT_STR] 设置列。如果我们相当确定某个列将具有不同的数据类型，我们可以在“高级”部分对其进行配置。我们将`Id`列更改为数据类型`four-byte signed integer [DT_I4]`，将日期列更改为数据类型`date [DT_DATE]`

![平面文件连接管理器编辑器高级 ID 列](../Images/85319c8a33d60d93400f556c76266963.png)

![平面文件连接管理器编辑器高级日期列](../Images/34d940bee81cceb4ec747c147f56ab74.png)

*   单击*预览*部分。数据将根据列配置显示。

![平面文件连接管理器编辑器预览](../Images/5d661d9c00670e7064b5910b2f0d883c.png)

*   单击平面文件连接管理器编辑器上的*确定*，平面文件连接将分配给数据流任务中的平面文件源。

![平面文件编辑器连接](../Images/0cf14e446c0db26ec294d91ac99963e8.png)

*   在平面文件源编辑器上，单击列部分。您会注意到在平面文件连接管理器中配置的列。取消选中，`RowDelimiter`因为我们不需要它。

![平面文件编辑器列](../Images/7c969f0acdbcf465643a88f5756bb010.png)

*   在数据流任务上，放置一个`OLE DB Destination`. 将平面文件源的输出连接到 OLE DB 目标。

![数据流任务](../Images/44736a3e8a9efad9705bbfa82952a930.png)

*   在 OLE DB 目标编辑器上，选择名为的*OLE DB 连接管理器并将**表或视图*`SQLServer`的名称下拉设置为*`[dbo].[FlatFile]`*

 *![OLE DB 目标连接](../Images/746fb5bdb2d29f57f066bb1eb5f4ce9b.png)

*   在 OLE DB 目标编辑器上，单击映射部分。由于平面文件连接管理器中的列名与数据库中的列相同，映射将自动发生。如果名称不同，则必须手动映射列。单击确定。

![OLE DB 目标列](../Images/c2cd70d71a4043587099b3bd1a8240f7.png)

*   现在包裹已经准备好了。执行打包，将等宽平面文件数据加载到数据库中。

![包执行](../Images/ab15acb7f223238ef2cfae6e0f207e77.png)

*   如果您查询数据库中的表 dbo.FlatFile，您会注意到导入到数据库中的平面文件数据。

![数据导入表](../Images/1f558ff8601fdf4c4b8d5c03ea61df69.png)

此示例应该让您了解如何将固定宽度的平面文件导入数据库。它没有解释如何处理错误日志，但这应该可以帮助您入门并帮助您在使用包时发现其他与 SSIS 相关的功能。

希望有帮助。

**`SQL Scripts`**：

```
CREATE TABLE [dbo].[FlatFile](
    [Id] [int] NOT NULL,
    [FirstName] [varchar](25) NOT NULL,
    [LastName] [varchar](25) NOT NULL,
    [Date] [datetime] NOT NULL
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T10:00:25.723

在派生列转换中，您可以对每个列使用 SUBSTRING() 函数。 **例子：**

列派生列

FirstName SUBSTRING(数据, startFrom, 长度);

这里 FirstName 的宽度为 25，所以如果我们从第 0 个位置开始考虑，那么在派生列中，您应该通过给出 SUBSTRING(Data, 0, 25); 来指定它。

其他列也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T17:03:02.190

很好的解释，湿婆！您的教程和出色的插图指出了微软应该明确的内容

1.  固定长度行的宽度必须包括回车和换行 (CR & LF) 字符（我发现这是因为预览显示行没有正确排列）
2.  定义一个额外的列以包含那些 CR 和 LF 字符的所有重要步骤，即使它们不会被导入。我也想通了。在我开始之前找到你的答案会让我受益匪浅。

如果没有这两件事，尝试运行导入将给出以下错误消息： *列“列 x”的数据转换返回状态值 4 和状态文本“文本被截断或一个或多个字符在目标代码页中不匹配."。*

我已在此错误文本中添加，希望有人在搜索错误原因时会找到此页面。即使事后，您的教程也值得寻找！**

# python - Python：如果文件太大，则终止文件下载

> ID：10289645
> 
> 赞同：2
> 
> 时间：2012-04-23T23:22:27.767
> 
> 标签：python, urllib2

远程服务器上文件的大小通常由 content-length 标头报告，但它是不可靠的。有时它会丢失，有时它会被误报。我不想完全依赖此标头来确定我的代码是否应该下载 URL。

有没有办法在下载文件时监控文件的大小并在超过最大大小时终止下载？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T23:34:27.663

您可以做的是读取您想要的最大文件大小，然后通过再读取一次来检查是否有更多字节要读取。像这样：

```
resp = urllib2.urlopen('http://www.google.com')
file_read = resp.read(max_wanted_size)
if resp.read(1) != '':
    #file is bigger than expected code 
```

# python - appengine oauth2decorater 联系人 api serviceName

> ID：10289646
> 
> 赞同：0
> 
> 时间：2012-04-23T23:22:28.057
> 
> 标签：python, google-app-engine, oauth, google-api-python-client

我浏览了文档，但找不到 serviceName 来构建用于处理联系人 API 的服务对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T03:40:45.217

您是否尝试使用 Google 联系人 API：[https](https://developers.google.com/google-apps/contacts/v3/) ://developers.google.com/google-apps/contacts/v3/ ？如果是这样，请查看 python [http://code.google.com/p/gdata-python-client/source/browse/samples/contacts/contacts_example.py](http://code.google.com/p/gdata-python-client/source/browse/samples/contacts/contacts_example.py)的示例代码，其中显示了如何通过 Google API 客户端进行访问图书馆。因为这个 API 是一个 gdata API，所以它看起来与其他通常遵循

```
from apiclient.discovery import build
...
service = build("plus or some other service name here", "v1", http=http) 
```

模式，这听起来像是您正在寻找的。

希望这可以帮助！

# mod-wsgi - apache/mod_wsgi：如何生成特定数量的进程？

> ID：10289649
> 
> 赞同：1
> 
> 时间：2012-04-23T23:22:49.343
> 
> 标签：mod-wsgi, apache

将 mod_wsgi 与 WSGIDaemonProcess 设置一起使用时，如何在 Apache 中生成特定数量的进程？

我的 VirtualHost 设置如下（作为测试）：

```
WSGIDaemonProcess webserver user=webserver group=webserver processes=24 threads=8 display-name=%{GROUP} python-path=/var/virtualenv/lib/python2.6/site-packages 
```

虽然我的 httpd.conf 设置如下：

```
<IfModule prefork.c>
StartServers       8
MinSpareServers    1
MaxSpareServers    8
ServerLimit       24
MaxClients        24
MaxRequestsPerChild  4000
</IfModule> 
```

请注意，我正在运行一个非常受限的 256MB 服务器，同时安装了 PostgreSQL 数据库。

但是，系统显示的 apache 进程远远超过 24 个（超过 30 个）。我预计如果我将 ServerLimit 设置为与 WSGIDaemonProcess 中的进程相同，它将以常数 24 运行。但是，似乎有一堆空闲进程正在运行，原因不明？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T01:35:27.823

ServerLimit 指令与 mod_wsgi 守护程序模式无关。WSGIDaemonProcess 的“进程”选项指定 mod_wsgi 将创建多少个守护进程。它是静态数字而不是动态数字，因此只需将其设置为您需要的数量。对于每个进程的线程数，将其设置为超过 'processes=3' 开始是没有意义的，因为您在 Apache 子工作进程中被限制为 24 个并发请求，这些请求将请求代理到 mod_wsgi 守护进程，所以不是可以处理比这更多的请求。

一般来说，如果你在内存受限的环境中运行，那么你不应该使用 prefork MPM，而是使用 worker MPM。是否有必须的原因，例如还需要运行 PHP 代码？如果不是，请更改使用的 MPM。

您还可以如何配置事情实际上取决于您的代码、响应时间和请求吞吐量，这些只有您自己知道。

# ios - iOS IBAction 方法永远不会被调用

> ID：10289652
> 
> 赞同：1
> 
> 时间：2012-04-23T23:23:02.963
> 
> 标签：ios, segue, ibaction, cs193p

我正在学习 CS193p 斯坦福 iOS 课程，并且几乎完成了作业 3 - 在其中我也将图形计算器转换为适用于 iPad 的通用应用程序。当程序（例如“x + 3”）输入到计算器中，然后用户按下图形按钮时，应用程序会绘制图形。在 iPhone 上，当按下 Graph 按钮时，我只是简单地继续，但在 iPad 中，我有一个 UISplitViewController，我从 Graph 按钮设置了一个目标操作：

```
- (IBAction)ipadGraphPressed:(UIButton *)sender {
    if ([self splitViewGraphViewController]) {
        [[self.splitViewController.viewControllers lastObject] setProgram:self.brain.program];
    }
} 
```

这会调用`setProgram:`GraphViewController，然后调用`setNeedsDisplay:`GraphView 并绘制图形。

为了比较，这是适用于 iPhone 的 segue 方法：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    [segue.destinationViewController setProgram:self.brain.program];
} 
```

我非常确定按钮及其操作方法之间建立了连接，但是当我运行应用程序时，按下按钮时永远不会调用此操作方法。还有什么要检查的以确保调用该方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-03T06:36:45.643

我有同样的问题。我在 IBOutlets 和 IBActions 上正确连接了所有内容。导致问题的原因是按钮顶部的透明视图阻止了触摸。

在我调整视图大小以使其不会阻塞其下方的按钮后，它解决了我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:22:25.723

事实证明，我的代码本身没有任何问题。在摆弄故事板之后，我注意到即使我在主视图中添加了新按钮，它们也不会在应用程序启动时出现。我尝试将情节提要的名称从更改`iPad.storyboard`为`iPad_1.storyboard`，然后我的更改出现了，但我的轮换代码都没有生效。我对这整个混乱的解决方案是在我添加新故事板之前回溯到应用程序的先前版本。我重新添加了一个 iPad 故事板，并且能够建立所有正确的连接。

为了证实这一点，我的一个朋友在 Github 上查看了这个项目，并报告说虽然我无法调用 IBAction 方法，但对他来说它工作得很好。我相信我的本地故事板设置有问题，这导致应用程序无法正常工作。我从中得出的结论是要小心命名和重命名故事板文件，尤其是在处理版本控制时。

# java - 如何从 64 位 JVM 连接到 32 位 Access 数据库？

> ID：10289655
> 
> 赞同：4
> 
> 时间：2012-04-23T23:23:37.083
> 
> 标签：java, ms-access, 32bit-64bit, jdbc-odbc

到目前为止，当我必须连接到 32 位 Access 数据库时，我只是使用 32 位 JVM 执行应用程序。但是，我现在正在开发一个需要 64 位 JVM 的应用程序，但我仍然需要连接到 32 位 Access 数据库。当我尝试连接时，我得到了这个异常：

```
java.sql.SQLException: [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified
at sun.jdbc.odbc.JdbcOdbc.createSQLException(Unknown Source)
at sun.jdbc.odbc.JdbcOdbc.standardError(Unknown Source)
at sun.jdbc.odbc.JdbcOdbc.SQLDriverConnect(Unknown Source)
at sun.jdbc.odbc.JdbcOdbcConnection.initialize(Unknown Source)
at sun.jdbc.odbc.JdbcOdbcDriver.connect(Unknown Source)
at java.sql.DriverManager.getConnection(Unknown Source)
at java.sql.DriverManager.getConnection(Unknown Source) 
```

这是我的代码：

```
String s = "jdbc:odbc:Driver={Microsoft Access Driver (*.mdb)};DBQ=" + path;
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
conn = DriverManager.getConnection(s, user, password); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T00:34:29.310

根据我的经验

对于用户（或系统？）ODBC DSN，有单独的 32 位和 64 位定义。我认为您可能有 32 位定义，但 Java ODBC-Bridge 正在寻找 64 位定义。您不能从 64 位程序直接连接到 32 位 Access ODBC 驱动程序（如果您尝试，则会收到错误提示）。

虽然 Microsoft 随 Windows（32 位和 64 位）分发 32 位 ODBC Microsoft Access 驱动程序，但它不随 Windows 64 分发 64 位 MsAccess 驱动程序。Microsoft 提供了[64 位 Access ODBC 驱动程序](http://www.microsoft.com/download/en/details.aspx?id=13255) 。下载和安装 64 位 MsAccess 驱动程序存在一些问题

*   Java / 驱动程序仅在我使用 Java 6（64 位）测试时间歇性地工作；我还没有使用 Java 7 对其进行测试。对于 Java 6，如果 String 字段位于 SQL 选择语句的末尾，我认为你可能会没事。我发现有些 SQL 语句有效，有些则无效。
*   使用 32 位驱动程序，您可以确切地知道驱动程序的位置，使用 64 位驱动程序您不知道它会安装在哪里。这使得自动安装脚本难以编写。
*   您还需要创建单独的 64 位 ODBC 定义。

    ================================================

另一方面，可以运行一些在 32 位 java 中运行的数据库代理/池包（并通过 TCP/IP 连接？）。我从来没有尝试过。

Java 64 -->> 运行 32 位 Java DB 的 DB 代理 -->> Ms Access

数据库代理列表： http: [//www.manageability.org/blog/stuff/jdbc-proxy-drivers](http://www.manageability.org/blog/stuff/jdbc-proxy-drivers)

SSL-SQL-Proxy Server 之类的东西可能会起作用

祝你好运，希望有人可以为您提供解决方案

* * *

自原始答案以来，有 2 个 JDBC 驱动程序

**开源：** [http ://ucanaccess.sourceforge.net/site.html](http://ucanaccess.sourceforge.net/site.html)

**商业：** [http ://www.csv-jdbc.com/stels_mdb_jdbc.htm](http://www.csv-jdbc.com/stels_mdb_jdbc.htm)

我也没试过

* * *

编辑：2014 年 5 月 8 日

看起来是比较商业的驱动 [Easysoft Driver](http://www.easysoft.com/applications/microsoft-access/jdbc-odbc.html)和[HXTT Driver](http://www.hxtt.com/access.html)

这篇[文章](http://www.selikoff.net/2011/07/26/connecting-to-ms-access-file-via-jdbc-in-64-bit-java/)可能有用

* * *

编辑 2016 年 1 月 6 日

正如戈德汤普森所说；ODBC-Bridge 已从 Java 8 中删除。好消息是[UCanAccess](http://ucanaccess.sourceforge.net/site.html)正在积极开发中，并且它们似乎正在稳步推进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-02T10:55:37.177

既然 JDBC-ODBC 桥已从 Java 8 中删除，所有这些围绕 Access ODBC 的问题将越来越成为过去，并且将需要一个“真正的”JDBC 驱动程序。

正如前面的回答中提到的，[UCanAccess](http://ucanaccess.sourceforge.net/site.html)是一个免费的开源选项。它是一个完全不使用 ODBC 的纯 Java 实现，因此无论平台（Windows、Linux 等）或体系结构（32 位或 64 位）如何，它都可以工作。

有关使用 UCanAccess 的更多信息，请参阅[此处](https://stackoverflow.com/q/21955256/2144390)的相关问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-09-02T09:04:56.600

问题是你应该在 Java 32 位上运行尝试安装最新的 JDK，它会工作

我使用 JDK 版本**“jdk-7u67-windows-i586.exe”运行它**

# node.js - 从函数返回 mongojs 查询结果

> ID：10289656
> 
> 赞同：2
> 
> 时间：2012-04-23T23:23:38.673
> 
> 标签：node.js, mongodb, express, pug

我制作了下面的函数来从 id 获取用户名。它工作不正常。我可以写 console.log(result.first_name); 在查询功能中，用户名显示在我的终端中，而不是浏览器中。我尝试添加“return 'something';” 在函数的末尾，看看它是否出现在浏览器中——它确实出现了。如何编写函数以便返回查询结果？

函数（app.js 中的全局函数）

```
function usernameFromId(id, callback){
    db.users.findOne({ _id: ObjectId(id.toString()) }, function(err, result) {
        var first_name = result.first_name;
        console.log(first_name); // names show up in the console…
        callback(first_name);
    });
}; 
```

页面处理程序（在 app.js 中）

```
app.get('/books', function(req, res){
    function timeSince(dato){
        moment.lang('nb');
        return moment(dato).fromNow();
    };
    db.books.find().sort({ added:-1 }, function(err, docs) {
        var books = docs;
        db.activity.find().limit(9).sort({ time:-1 }, function(err, docs) {
            var activity = docs;
            res.render('books', {
                books: books,
                activity: activity,
                timeSince: timeSince,
                usernameFromId: usernameFromId
            })
        });
    });
}); 
```

模板（books.jade）

```
- each a in activity
    p=usernameFromId(a.user_id, function(name){return name;}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:23:04.277

不，因为 JavaScript 的异步特性。我在您的代码中添加了一些注释以指示实际的执行顺序。这就是您收到错误的原因。

```
function usernameFromId(id){
    var id = id.toString(); // 1
    db.users.findOne({ _id: ObjectId(id) }, function(err, result) {
        var first_name = result.first_name; // 3
    });
    return first_name; // 2
}; 
```

编辑：您可能想要以下内容

```
function usernameFromId(id, callback){
    var id = id.toString();
    db.users.findOne({ _id: ObjectId(id) }, function(err, result) {
        var first_name = result.first_name; 
        callback(first_name);
    });
}; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-25T13:15:10.137

好的，我找到了解决方案。不确定它是否有任何好处，但它有效。不需要函数。

页面处理程序（在 app.js 中）：

```
app.get('/books', function(req, res){
    db.activity.find().limit(9).sort({ time:-1 }, function(err, docs) {
        var activity = docs;
        db.users.find(function(err, docs) {
            var users = docs;
            res.render('books', {
                page_title:'books',
                activity: activity,
                users: users
            })
        });
    });
}); 
```

模板（books.jade）：

```
- each a in activity
    - for u in users
        - if (a.user_id == u._id.toString())
            | #{u.first_name} 
```

# java - 使用 BigInteger 覆盖 public int hashCode()

> ID：10289659
> 
> 赞同：4
> 
> 时间：2012-04-23T23:24:02.993
> 
> 标签：java, collections, hashcode

BigInteter 太大而无法转换为整数。但是我必须将具有 id (SHA 512) 的对象存储在 a 中`HashMap`，并且需要一个没有很多冲突的哈希函数。

我试过这个。但是，我不确定某处是否没有集群。

```
@Override
public boolean equals(Object obj) {
    if (this == obj) {
        return true;
    }
    if (obj == null) {
        return false;
    }
    if (getClass() != obj.getClass()) {
        return false;
    }
    Advertisement other = (Advertisement) obj;
    return this.getId().equals(other.getId());
}

@Override
public int hashCode() {
    return new BigInteger(getId(), 16).hashCode();
} 
```

转换为整数 (bi.intValue()) 会更有效吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T23:38:57.997

不要试图重新发明轮子 - 只需使用`getId().hashCode()`：

```
@Override
public int hashCode() {
    return getId().hashCode();
} 
```

[`String.hashCode()`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#hashCode%28%29)使用高效、高质量的哈希算法，因此是最佳选择。它使您的代码更简单，这总是一件好事。

# c++ - Strtol 第二个参数

> ID：10289661
> 
> 赞同：2
> 
> 时间：2012-04-23T23:24:28.010
> 
> 标签：c++, string, parsing, strtol

第二个论点如何`strtol`工作？

这是我尝试过的：

```
strtol(str, &ptr, 10) 
```

其中`ptr`是 a`char *`并且`str`是字符串。现在，如果我传入`str`as`'34EF'`和 print `*ptr`，它会正确地给我`E`，并且`*(ptr+1)`给我`F`，但是如果我 print `ptr`，它给我`EF!`不应该打印`ptr`只是导致像十六进制地址或其他东西的垃圾值吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T23:25:48.753

`ptr`是一个指向空终止字符串内部的指针。因此，假设`"34EF"`它最终指向字符`'E'`并且从该地址开始的字符串是`"EF"`.

一个像四个字符的 C 字符串`p = "34EF"`实际上包含五个字符串合二为一。字符串`p`是`"34EF"`. 字符串`p+1`是`"4EF"`; 字符串`p+2`是`"EF"`；`p+3`is`"F"`和`p+4`是空字符串`""`。在这种情况下`p+4`，指向 . 之后的空终止符字节`F`。

说到空字符串，如果输入`strtol`只包含构成数字标记的有效字符，那么`ptr`应该指向一个空字符串。

如果您想禁止尾随垃圾，您可以对此进行测试。也就是说，即使解析出一个有效数字，如果`*ptr`不是 0，那么输入有尾随垃圾。在某些情况下，最好拒绝：“尊敬的用户，10Zdf 不是数字；请输入一个数字！”

# python - 设计和更改 GTK 界面的最佳方法是什么？

> ID：10289667
> 
> 赞同：4
> 
> 时间：2012-04-23T23:25:09.297
> 
> 标签：python, user-interface, gtk, glade, gtk3

我正在使用 GTK3 和 Glade 设计一个 python 程序。它需要根据用户需要构建的内容更改界面。

第一个界面类似于：

```
____________________________________________________
| Label one | Text entry one |  Save object button |
| Label two | Text entry two |                     |
____________________________________________________ 
```

它位于 Gtk.Box() 内的顶层窗口中，设置为垂直，Gtk.Grid() 作为框一侧的标签和文本条目，以及框部分上的保存对象按钮。（实际上我的界面要复杂得多，因为表格中有更多的标签、文本条目、切换按钮、组合框等）。如果您想查看它，请访问[http://sourceforge.net/projects/createlauncher](http://sourceforge.net/projects/createlauncher)。

如果用户需要构建另一个对象，它看起来像：

```
________________________________________________________
| Label three | Text entry three |  Save object button |
| Label four  | Text entry four  |                     |
________________________________________________________ 
```

关于如何实施变更有什么建议？

我曾想过跟踪标签一二和条目一二，并隐藏它们并显示其他标签，但它与格式混淆。如果需要切换回来，我已经搞砸了删除每个小部件并重建。这是很多工作。由于我使用的是 Glade，因此很难创建一个单独的“区域”，因为我考虑删除 Gtk.Box() 并重新制作它以满足其他界面需求，但这似乎禁止使用 Glade。

我对任何和所有选择持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-09T19:40:13.927

如果您使用 Glade，我可以想到两种方法。

第一个是根据您的需要在python代码中动态更改 Gtk.Label 和 Gtk.Entry 的标签。

第二个是在 Glade 中创建一个不在主窗口内的单独的 Gtk.Box 并在需要时添加它（首先从窗口中删除另一个）。这看起来像这样：

![带单独盒子的空地](../Images/0abb3ca602a8aabc271bcc7999ed813a.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T20:03:21.740

复合自定义小部件？

```
class ObjectOneSettings(Gtk.Grid):
    def __init__(self):
        Gtk.Grid.__init__(self)
        self.label_one = Gtk.Label('Label One')
        self.label_two = Gtk.Label('Label Two')
        self.entry_one = Gtk.Entry()
        self.entry_two = Gtk.Entry()
        self.attach(self.label_one, 0, 0, 1, 1)
        self.attach(self.label_two, 0, 1, 1, 1)
        self.attach(self.entry_one, 1, 0, 1, 1)
        self.attach(self.entry_two, 1, 1, 1, 1) 
```

然后，您可以在需要更改窗口时销毁您的`ObjectOneSettings`小部件并用小部件替换它。`ObjectTwoSettings`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T03:02:00.843

也许有点小技巧，但您可以使用带有隐藏标签和边框的笔记本。

# objective-c - 将在线 GIF 图片加载到 NSImageView

> ID：10289668
> 
> 赞同：0
> 
> 时间：2012-04-23T23:25:11.557
> 
> 标签：objective-c, cocoa, nsimage, nsimageview

我似乎无法将在线 GIF 图像加载到 NSImageView 中。请在下面查看我的代码并提供一些评论来解决这个问题。

```
#import <Foundation/Foundation.h>

@interface ImageFromUrl : NSObject

@property (strong) NSString *urlString;
@property (strong) NSURL *url;
@property (strong) NSImage *radarGif;
@property (weak) IBOutlet NSImageView *radarGifView;

- (void)displayUrlImage:(id)sender;

@end 
```

和

```
#import "ImageFromUrl.h"

@implementation ImageFromUrl

@synthesize urlString, url, radarGif, radarGifView;

- (void)displayUrlImage:(id)sender {
    urlString = @"http://icons.wunderground.com/data/640x480/2xradarb5.gif";
    url = [NSURL URLWithString:urlString];

    radarGif = [[NSImage alloc] initWithContentsOfURL:url];
    [radarGifView setImage:radarGif];
}

@end 
```

当我运行应用程序并且 GIF 的图像没有显示在窗口中时，我没有收到任何错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T04:57:46.883

我将此代码放在一个项目中，它运行良好，因此代码有效。你是如何将出口连接到图像视图的（你在 IB 中有一个对象，它是这个类的一个实例）？您如何调用该方法（以及从哪里调用）？

# javascript - 我应该如何在我的项目中集成 jQueryUI 可拖动和可排序？

> ID：10289670
> 
> 赞同：0
> 
> 时间：2012-04-23T23:25:13.917
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-sortable, jquery-ui-draggable

我想在我的项目中集成 jQueryUI 可拖动和可排序，并使用 mousedown 的开始时间和第一个 mousemove 事件之间的时间差来区分它们。我的部分代码如下：

```
var deltaX = self.mouse.startX - event.pageX,
    deltaY = self.mouse.startY - event.pageY;
if (self.mouse.mousedownTime - self.mouse.mousemoveTime < 700){                   
                // Drag down
                if(Math.abs(deltaX) < Math.abs(deltaY) && deltaY < 0){
                    $(self.el).draggable({disabled: false});
                    $(self.el).sortable({disabled: true});
                    $(self.el).draggable({axis: 'y'});
                    $(self.el).draggable({revert: true});
 ....
}
// Sorting action
else {
            $(self.el).sortable({disabled: false});
            $(self.el).draggable({disabled: true}); // global dragging
            $(self.el).sortable({containment: $(self.el).closest('.content')});
        } 
```

但事情并不如我所料。每次我开始拖动元素时，firebug 中显示的 html 都有正确的可拖动/可排序类设置，但它对当前的拖动事件无效。例如，第一次拖动时，虽然 html 已经有相应的类设置，但该元素既不可拖动也不可排序。第二次拖动时，它将是可拖动或可排序的。而且，如果您为当前拖动事件设置了可拖动/可排序的元素，则它仅在您下次拖动时才起作用。

总之，您期望当前事件的可拖动/可排序事件只会对下一个事件有效。我想知道这是 jQueryUI 应该是什么，还是我的代码有问题。我应该如何解决它？我应该如何在我的项目中集成可拖动和可排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T23:29:48.093

这是一个预期的行为，要将插件挂接到元素上，它必须监听它何时会被拖放以及将被拖动到哪里。

通常这两个插件并排工作。所以我不认为有办法做到这一点，而不使元素只能拖动，因为无论如何都需要拖动 droppable。

# php - 根据开始日期和结束日期查询今天和从今天起一周内发生的多日事件列表

> ID：10289675
> 
> 赞同：0
> 
> 时间：2012-04-23T23:25:50.837
> 
> 标签：php, mysql

我有一个表格，其中包含一个包含开始日期和结束日期的事件列表。我可以通过以下方式成功获取今天发生的事件列表：

```
SELECT * FROM event WHERE CURDATE() BETWEEN start_date and end_date 
```

或从今天起正好一周发生的事件列表，其中包含以下内容：

```
SELECT * FROM event WHERE DATE_ADD(CURDATE() INTERVAL 1 WEEK) BETWEEN start_date and end_date 
```

但是，我想要一份从今天到今天（包括在内）一周之间任何时间发生的事件列表。请记住，每个事件都跨越多天，并且由开始日期和结束日期定义，而不是单日事件。

有没有一种简单的方法来查询这个，或者用上面的第一个查询在 PHP 中循环每一天会更容易（从今天到一周后的每一天替换 CURDATE）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:46:42.320

我喜欢想象这样的问题。据我了解您的问题，应该返回四种类型的事件：

```
 |-------------------- WEEK ---------------------|
          |                                               |
          |         |========== EVENT ==========|         |
     |========== EVENT ==========|                        |
          |                        |========== EVENT ==========|
     |========================= EVENT =========================|
          |                                               |
          |-----------------------------------------------| 
```

这意味着我们有：

*   在一周内开始和结束的事件；
*   在一周前开始并在一周内结束的事件；
*   在一周内开始并在一周后结束的事件；
*   在一周之前开始并在一周之后结束的事件。

将其翻译成 SQL 会得到以下结果：

```
SELECT *
FROM events
WHERE (start_date >= CURDATE() AND end_date <= CURDATE() + INTERVAL 1 WEEK)
   OR (start_date < CURDATE() AND end_date >= CURDATE() )
   OR (start_date <= CURDATE() + INTERVAL 1 WEEK 
      AND end_date > CURDATE() + INTERVAL 1 WEEK)
   OR (start_date < CURDATE() AND end_date > CURDATE() + INTERVAL 1 WEEK); 
```

我使用`>=`and`<=`表示一周内的日期。这样，我们可以确保在一周开始或结束时开始或结束的事件也包括在内。

* * *

假设`start_date <= end_date`所有行都是如此，更简单的方法是：

```
SELECT *
FROM events
WHERE start_date <= CURDATE() + INTERVAL 1 WEEK 
  AND CURDATE() <= end_date 
```

# java - Netbeans，空 DefaultListModel

> ID：10289678
> 
> 赞同：2
> 
> 时间：2012-04-23T23:26:21.957
> 
> 标签：java, swing, user-interface, netbeans, jlist

为什么 myList 是空的？

从输出中我可以看到 myList 的大小不正确，但消息却有。

输出：

```
Apr 23, 2012 4:28:42 PM net.bounceme.dur.nntp.MessagesJFrame <init>
INFO: messages 11
Apr 23, 2012 4:28:42 PM net.bounceme.dur.nntp.MessagesJFrame <init>
INFO: myList 0 
```

消息JFrame：

```
package net.bounceme.dur.nntp;

import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.mail.Message;
import javax.swing.DefaultListModel;

public class MessagesJFrame extends javax.swing.JFrame {

    private static final long serialVersionUID = 1L;
    private static final Logger LOG = Logger.getLogger(MessagesJFrame.class.getName());
    DefaultListModel<Message> myList = new DefaultListModel<Message>();

    public MessagesJFrame() {
        initComponents();
        EnumNNTP nntp = EnumNNTP.INSTANCE;
        List messages = null;
        try {
            messages = nntp.getMessages(false);
        } catch (Exception ex) {
            LOG.severe("didn't get messages");
        }
        myList.copyInto(messages.toArray());
        LOG.log(Level.INFO, "messages {0}", messages.size());
        LOG.log(Level.INFO, "myList {0}", myList.size());
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        jScrollPane2 = new javax.swing.JScrollPane();
        jList1 = new javax.swing.JList();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jList1.setModel(myList);
        jScrollPane2.setViewportView(jList1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap(13, Short.MAX_VALUE)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(129, 129, 129))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(158, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /*
         * Set the Nimbus look and feel
         */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /*
         * If Nimbus (introduced in Java SE 6) is not available, stay with the
         * default look and feel. For details see
         * http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
         */

        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(MessagesJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(MessagesJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(MessagesJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(MessagesJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /*
         * Create and display the form
         */
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                new MessagesJFrame().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify
    private javax.swing.JList jList1;
    private javax.swing.JScrollPane jScrollPane2;
    // End of variables declaration
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T23:32:35.853

您在哪里将模型添加到 JList？为了让 JList 能够使用和显示模型所保存的数据，必须通过 JList 的构造函数或其`setModel(...)`方法将模型添加到 JList。你[读过 JList 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html)吗？如果没有，那是您应该首先查看的地方，因为它将解释如何使用 JLists，然后是一些。

**编辑 1**
DefaultListModel`copyInto(...)`方法与您认为的相反。它将模型中的数据复制到数组中。

根据 API：

> 将此列表的组件复制到指定的数组中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:02:34.200

在最狭义的意义上，以下代码填充模型：

固定方法：

```
public MessagesJFrame() {
    initComponents();
    EnumNNTP nntp = EnumNNTP.INSTANCE;
    List<Message> messages = null;
    try {
        messages = nntp.getMessages(false);
    } catch (Exception ex) {
        LOG.severe("didn't get messages");
    }
    for (Message m : messages) {
        myList.addElement(m);
    }
    LOG.log(Level.INFO, "messages {0}", messages.size());
    LOG.log(Level.INFO, "myList {0}", myList.size());
} 
```

但是，有什么问题`myList.copyInto(messages.toArray());`呢？

上面的代码将消息和 myList 输出为相同大小。

# ios - AVAudioPlayer，很多声音

> ID：10289679
> 
> 赞同：0
> 
> 时间：2012-04-23T23:26:28.080
> 
> 标签：ios, memory-management, avaudioplayer

在我的应用程序中，我使用 AVAudioPlayer 播放一些 mp3。我的代码是：

```
- (void) play{
    NSString *path = [NSString stringWithFormat:@"%@/%@",
                      [[NSBundle mainBundle] resourcePath],
                      [arraysound objectAtIndex:appDelegate.indexSound]];
    NSURL *filePath = [NSURL fileURLWithPath:path isDirectory:NO];
    soundID = [[AVAudioPlayer alloc] initWithContentsOfURL:filePath error:nil];
    soundID.delegate = self;
    [soundID prepareToPlay]; 
    [soundID play];  
} 
```

但我有 40 种声音要播放；我每次使用 soundID 来播放我的声音

例如我有sound1.mp3、sound2.mp3、sound3.mp3……

如何释放我的 soundId？

当我的声音改变时，我调用“播放”方法，但是这个方法每次都分配一个新的 AVAudioPlayer

我知道

```
- (void) audioPlayerDidFinishPlaying: (AVAudioPlayer *) player
                    successfully: (BOOL) flag { 
```

但我不明白如何在这个委托方法中释放我的声音 id，因为如果我在 soundId 中释放我的应用程序在我使用我的应用程序几分钟后崩溃，我就会崩溃这条消息“shm_open failed:”Apple Audio Queue”

请帮助我...谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:06:55.750

你不想`soundID`在你的委托方法中释放。你想释放`player`。从你的代码来看，`soundID`是一个ivar。当委托被调用时，`soundID`可能已被设置为另一个值。但`player`参数将是`AVAudioPlayer`刚刚播放完的那个。

# caching - Symfony 特定的页面缓存设置

> ID：10289680
> 
> 赞同：0
> 
> 时间：2012-04-23T23:26:41.020
> 
> 标签：caching, symfony1, symfony-1.4

有没有办法只在 Symfony 中禁用特定页面的缓存设置？那将是什么代码。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:25:37.137

由于您使用的是 sf1.4，因此您可以使用它`cache.yml`来管理要放入缓存的内容。我建议您[阅读此文档](http://www.symfony-project.org/book/1_0/12-Caching)（关于 sf1.2，但对于 1.4 没问题）。

您将看到您可以启用禁用缓存，`apps/[app_name]/modules/[module_name]/config/cache.yml`如下所示：

```
mypage:
  enabled:    off 
```

# java - 如何复制hashset和hashmap，Java是否使用指针？

> ID：10289682
> 
> 赞同：2
> 
> 时间：2012-04-23T23:26:56.007
> 
> 标签：java, arrays, pointers, copy, hashset

我有两个问题：
首先：
我有一个返回 HashMap 的函数。为了读取返回值，我这样写：

```
 HashMap<Integer,String> hs=my_func2(); 
```

如果函数返回一个 HashSet，我也会这样做。

```
 HashSet<Integer> hs=my_func(); 
```

我想知道是否以这种方式将返回的值复制到hs中，或者我应该为它写一个深拷贝，或者我应该这样写：HashSet hs=new HashSet(my_func()); HashMap hm=new HashMap(my_func2());

第二个问题：
我通过调用 make_matrix_funciton 创建一个矩阵。矩阵woule 是一个二维数组，包含：
[0 1 1
0 0 0
0 0 0]
然后我将此矩阵提供给 sort_vec，并在此函数中更改矩阵的元素。我认为java不是基于指针的，所以当我从sort_vec出来时，矩阵应该是原来的样子。但是，变了！它是
[0 0 0
0 0 0
1 1 0]
，它显示了在 sort_vec 函数中对其应用的更改。这是否正常，如果是，我应该怎么做才能防止它。下面的代码是可编译的。

```
public static void main(String args[]) {
        int matrix[][]=new int[3][3];
        matrix=make_matrix("011000000");
        int indexes[]={2,1,0};
        int[][] mat=sort_vec(3,matrix,indexes);
    }

    private static int[][] sort_vec(int motifsize,int [][]mat,int[] indexes)
    {
        int[] main_index={0,1,2};

        int l=indexes.length;
        for (Integer i=0;i<l;i++)
            if(indexes[i]!=main_index[i])
            {
                int j=indexes[i];
                int k=main_index[i+1];
                for(;k<l;k++)
                    if(indexes[k]==main_index[i])
                        break;

                indexes[k]=j;
                mat=exchange(motifsize,mat,j,main_index[i]);
            }
        return mat;
    }
    private static int[][] exchange(int motifsize,int [][]matrix,int x,int y)
    {
        int temp;

        for(int i=0;i<motifsize;i++)
        {   
            temp=matrix[i][x];
            matrix[i][x]=matrix[i][y];
            matrix[i][y]=temp;
        }
        for(int i=0;i<motifsize;i++)
        {   
            temp=matrix[x][i];
            matrix[x][i]=matrix[y][i];
            matrix[y][i]=temp;
        }

        return matrix;
    }
    private static int[][] make_matrix(String id)
    {
        int matrix[][]=new int[3][3];
        int c=0;
        for(int x=0;x<3;x++)
            for(int y=0;y<3;y++)
            {
                if(id.charAt(c)=='1' || id.charAt(c)=='5')
                    matrix[x][y]=1;
                c++;
            }
        return matrix;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T23:32:53.773

Java 总是通过引用传递对象，因此如果您从函数返回 HashMap-Object，则该引用将传递给示例中的 hs 变量。将 HashSet 传递给新 HashSet 实例的构造函数将不起作用。它将创建一个新的 HashSet，其对象引用与原始对象引用相同。如果您修改其中一个对象，则更改也将出现在所有其他参考点上。

如果您想完全分离副本，您将需要自己的深度复制方法，因为在[clone() 方法的 JavaDoc 中](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html#clone%28%29)它说：

> 返回此 HashSet 实例的浅表副本：元素本身未被克隆。

数组也是如此。每个数组都是一个对象，所以如果你修改一个元素，它会被所有对该数组的引用修改。要创建延迟副本，请使用[System.arrayCopy](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/System.html#arraycopy%28java.lang.Object,%20int,%20java.lang.Object,%20int,%20int%29)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T23:35:19.393

您误解了 Java 的引用是如何工作的。

在第一部分中，您的对象将是对 HashMap 的引用 - 即，您从函数返回的任何对象

在第二部分中，您将传递对 int[][] 的引用，当它是基元数组时，它不是按值传递。因此，您的函数将修改数组。如果您想要一个不修改输入数组的函数，则需要复制传入函数的内容，或者在将数组传递给函数之前需要复制数组。

Java 排序例程中的行为是它们修改了原始数组。

总之，**没有办法在 Java 中“按值传递”对象或数组**。如果您想要这种行为，您必须手动克隆（例如，复制）对象或使用@user3001 的建议

弄清楚这一点后，您可能还想阅读以下内容：http: [//javadude.com/articles/passbyvalue.htm](http://javadude.com/articles/passbyvalue.htm)

# java - 仅限 HIbernate show_sql 开发

> ID：10289684
> 
> 赞同：4
> 
> 时间：2012-04-23T23:27:04.197
> 
> 标签：java, hibernate

使用休眠模式，我如何仅在开发模式下启用 show_sql？我希望将
`<property name="show_sql">true</property>`其禁用用于生产并启用用于开发环境。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T03:48:27.947

您应该将环境相关信息保存在单独的**属性**文件中。该文件应该从您的**hibernate.cfg.xml**或**applicationContext.xml**中读取。

这是示例文件

```
###########################################################
################DATABASE INFORMATION ######################
###########################################################
jdbc.driverClassName=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/appDB1
jdbc.username=root
jdbc.password=root

# Set Hibernate properties
hibernate.show_sql=true
hibernate.format_sql=false 
```

同样，您可以添加更多配置信息。这个文件在不同的环境中会有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T01:12:30.017

我从您的问题中假设“处于开发模式”是您的代码在运行时知道的东西，因为否则您只需更改配置文件中的标志。

在这种情况下，您可以在运行时以编程方式设置 show_sql 属性（或任何其他属性）：

```
Configuration config = new Configuration();
config.setProperty(Environment.SHOW_SQL, "true");
config.buildSessionFactory();
... 
```

那么你只需要根据你的状态选择真/假，这表明你是否处于开发模式。

# php - 在 PHP 中将 SVG 文件渲染为 PNG 或 JPEG

> ID：10289686
> 
> 赞同：14
> 
> 时间：2012-04-23T23:27:30.430
> 
> 标签：php, svg, gdlib

我已经尽可能多地搜索了，但我只找到了一个调用 Inkscape 来呈现 SVG 的 PHP 类，所以我在这里问：

我有一个以某种方式生成（或由客户端上传）的有效 SVG 文件。我需要仅使用 PHP 和/或 GDLib 将其渲染为 JPG 或 PNG，因为并非所有浏览器都支持 SVG。

我没有安装任何东西的选项，因此使用 GDLib 将 SVG 转换为 PNG 的类将是最理想的。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-23T23:34:30.460

检查是否安装了 ImageMagick（您可以使用 查找[`phpinfo`](http://php.net/manual/en/function.phpinfo.php)）。如果是，您可以使用以下代码覆盖到 PNG。

```
$image = new Imagick();
$image->readImageBlob(file_get_contents('image.svg'));
$image->setImageFormat("png24");
$image->resizeImage(1024, 768, imagick::FILTER_LANCZOS, 1); 
$image->writeImage('image.png'); 
```

有很多线程讨论这个问题。一个特别有用的是这个线程： [Convert SVG image to PNG with PHP](https://stackoverflow.com/questions/4809194/convert-svg-image-to-png-with-php)

# python - Mod_Python 每个文件都需要 Python 处理程序吗？

> ID：10289690
> 
> 赞同：0
> 
> 时间：2012-04-23T23:27:47.733
> 
> 标签：python, mod-python

使用**mod_python**我想知道为什么我必须创建一个**PythonHandler**才能获得解析 Python 代码的 URL。如果您在下面看到，如果我没有名为 jrpython.py 的文件，它将无法工作。

有没有办法让**我所有的 .py**文件只运行而不每次都添加？

```
<VirtualHost *:80>
   DocumentRoot /var/www/vhost/testsite.com
   ServerName www.testsite.com

  <Directory "/var/www/vhost/testsite.com">
        AddHandler mod_python .py
        PythonHandler jrpython
        PythonDebug On
        Options FollowSymLinks
        AllowOverride All
        Order Allow,Deny
        Allow From All
  </Directory>
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T02:30:18.343

当然，您可以让 mod_python 运行您的 .py 文件，而无需全部命名。您仍然需要指定一个 PythonHandler，但它可以是[Publisher 处理程序](http://www.modpython.org/live/current/doc-html/hand-pub.html)。

# ios - 将徽章图标添加到圆形矩形按钮？

> ID：10289694
> 
> 赞同：3
> 
> 时间：2012-04-23T23:28:01.527
> 
> 标签：ios, xcode, badge

有没有一种方便的方法来制作带有徽章的按钮？不在图标上...我想在应用程序中进行。程序选择的带有徽章的按钮或图像。还是我必须建立一个 Photoshop 图片库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:27:16.930

您需要在`resizableImageWithCapInsets`没有 Photoshop 图像库的情况下实现此目的。有一些很棒的线程（[这里](https://stackoverflow.com/questions/8879817/stretching-an-uiimage-while-preserving-the-corners)和[这里](https://stackoverflow.com/questions/8671315/using-resizableimagewithcapinsets-image-for-button-only-works-for-the-state-set)）解释了它的用途。

这是我刚刚为您提供一个想法的示例：

```
//Create a label (width/height not important at this stage)
UILabel *yourLabel = [[UILabel alloc]initWithFrame:CGRectMake(0, 0, 1, 1)];
yourLabel.text = @"7+";
[yourLabel sizeToFit];

CGRect labelFrame = yourLabel.frame;

//Here we create a UIImage that is resizable, but will not resize the areas concerned with the cap insets you've defined
UIImage *badgeImage = [[UIImage imageNamed:@"badge.png"]resizableImageWithCapInsets:UIEdgeInsetsMake(5, 5, 5, 5)];
UIImageView *badgeImageView = [[UIImageView alloc]initWithImage:badgeImage];

badgeImageView.contentMode = UIViewContentModeScaleToFill;
badgeImageView.backgroundColor = [UIColor clearColor];

labelFrame.size.width += 5; //This is the 'padding' on the right and left (added together)
//If your badge edges are completely circular then you don't want to change the height, but if they're not then go ahead in the same way with the width. If your badge has a static height, you'll need to make sure the font size doesn't exceed this height; better start off with a small font-size

badgeImageView.frame = labelFrame; //The badge is now the right width with padding taken into account

//Center the label on the badge image view
yourLabel.center = CGPointMake(badgeImageView.frame.size.width/2, badgeImageView.frame.size.height/2);

//Finally we add the label to the badge image view
[badgeImageView addSubview:yourLabel];
//Add your badge to the main view
[self.view addSubview:badgeImageView];

[badgeImageView release];
[yourLabel release]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-03T05:25:29.950

```
UILabel   *lbl_notification_count = [[UILabel alloc]initWithFrame:CGRectMake(5,0, 18, 18)];

        lbl_notification_count.textColor = [UIColor whiteColor];

        lbl_notification_count.textAlignment = NSTextAlignmentCenter;

        lbl_notification_count.text = [NSString stringWithFormat:@"%d",appDel.NotificationBadge];

        lbl_notification_count.adjustsFontSizeToFitWidth=YES;

        lbl_notification_count.layer.borderWidth = 1;

        lbl_notification_count.layer.cornerRadius = lbl_notification_count.layer.frame.size.height/2;

        lbl_notification_count.layer.masksToBounds = YES;

        lbl_notification_count.layer.borderColor =[[UIColor colorWithRed:241.0/255.0 green:84.0/255.0 blue:67.0/255.0 alpha:1.0] CGColor];

        lbl_notification_count.backgroundColor = [UIColor colorWithRed:241.0/255.0 green:84.0/255.0 blue:67.0/255.0 alpha:1.0];

        lbl_notification_count.font = CustomFontMediumWithSize(12);

        if (appDel.NotificationBadge >= 1) {

            [btnNotification addSubview:lbl_notification_count];

             [lbl_notification_count setHidden:NO];

        }else{

             [lbl_notification_count setHidden:YES];

        } 
```

# c# - Web 参考帮助：无法建立连接，因为目标机器主动拒绝它

> ID：10289699
> 
> 赞同：1
> 
> 时间：2012-04-23T23:28:51.417
> 
> 标签：c#, asp.net, iis

好的，所以我正在通过制作一个简单的程序来读取用户的 gmail 凭据并从他们的输入构造一封电子邮件到控制台来了解 ASP.NET，但是我遇到了一个昨天没有得到的新错误，并且我没有更改任何代码。错误在第 41 行，所以我提供了（其余代码只是将输入读取到字符串中）我禁用了我的防火墙无济于事，并且还尝试了“http://localhost/Service.asmx”，这也不起作用。我也尝试过重新启动 IIS。

我对这个主题完全陌生，但对我来说，错误表明程序正在与服务器通信，但被阻止的端口拒绝，但我已禁用防火墙并且错误仍然存​​在。有任何想法吗？提前致谢！

```
/*40*/  Communication_Service.Service CommServiceProxy = new Communication_Service.Service();
/*41*/  Result = CommServiceProxy.SendMail(GmailAccount, Password, To, Subject, Body); 
```

***[下载http://localhost:4932/Service.asmx](http://localhost:4932/Service.asmx)时出错。无法连接到删除服务器。无法建立连接，因为目标机器主动拒绝它 127.0.0.1:4492***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:40:50.443

听起来您正在运行 cassini（开发服务器）。需要启动位于[http://localhost:4932/的应用程序。](http://localhost:4932/)您可能有多个站点并且需要多个启动项目。右键单击您的解决方案，然后单击设置启动项目，选择多个，然后选择所有网站。在 VS goto debug 上，无需调试即可运行，它们都应该启动。

# php - 使用 Zend_Config_Writer 添加注释或格式化

> ID：10289700
> 
> 赞同：1
> 
> 时间：2012-04-23T23:28:52.953
> 
> 标签：php, zend-framework, zend-config

我一直在玩 Zend_Config_Writer，虽然我可以让它做我想做的事，但我发现缺少格式有点令人不安，因为：

```
[production : general]
;
; Production site configuration data.
;

locale                                          = sv_SE
... 
```

变成

```
[production : general]   
locale                                          = sv_SE
... 
```

我意识到“新”配置是根据 Zend_Config 对象中保存的值编写的，并且该对象不包含任何注释或平淡无奇的行，但这使得新配置非常难以阅读，尤其是对于我的同事而言。

这可以以某种方式解决吗？我想出的最好的方法是使用具有“级联”继承的不同部分，但这似乎是一个愚蠢的想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:21:05.517

正如您所说，`Zend_Config_Writer`不会呈现任何评论，因为它们不存储在`Zend_Config`对象中。根据您要渲染的ini文件的结构，您可能会使用“级联”，至少可以清除冗余（对我来说它看起来并不那么愚蠢，即使在标准`application.ini`配置文件中也可以完成......）。

当然，另一种解决方案可能是使用或创建其他东西来编写您的 ini 文件，但这可能是矫枉过正。

希望有帮助，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T08:31:10.803

经过一些试验，我通过以下方式解决了我的问题并成功测试了它。

1.  将配置拆分为多个文件。在我的情况下，我有 1 个大型 application.ini 包含几乎所有我的配置和 1 个小型 version.ini 包含一些特定于版本的数据
2.  单独创建所有（在我的情况下为 2） Zend_Config_ini 对象，但将 allowModification 设置为一个
3.  使用 Zend_Config_Ini->Merge() 功能合并所有配置，然后将其设置为只读
4.  要更新配置的任何部分，从那个特定的 ini 文件创建一个新的 Zend_Config_ini 对象并将其设置为允许修改和跳过范围
5.  更新配置并使用 Zend_Config_Writer_ini 写入更改

示例代码：

```
/* Load the config */    
//Get the application-config and set 'allowModifications' => true
$config = new Zend_Config_Ini('../application/configs/application.ini',$state, array('allowModifications' => true));

//Get the second config-file
$configVersion = new Zend_Config_Ini('../application/configs/version.ini');

//Merge both config-files and then set it to read-only
$config->merge($configVersion);
$config->setReadOnly();

/* Update a part of the config */
$configVersion = new Zend_Config_Ini(
        APPLICATION_PATH.'/configs/version.ini',
        null,
        array('skipExtends' => true, 'allowModifications' => true)
    );

//Change some data here
$configVersion->newData = "Some data";

//Write the updated ini
$writer = new Zend_Config_Writer_Ini(
        array('config' => $configVersion, 'filename' => 'Path_To_Config_files/version.ini')
    );
    try
    {
        $writer->write();
    }
    catch (Exception $e) {
        //Error handling
    } 
```

# c++ - 更新 std::map 对象数据

> ID：10289701
> 
> 赞同：0
> 
> 时间：2012-04-23T23:28:55.453
> 
> 标签：c++

我有一个 std::map 对象如下

```
typedef std::map<int,int> RoutingTable;
RoutingTable rtable; 
```

然后我在一个函数中初始化它

```
 for (int i=0; i<getNumNodes(); i++)
 {
   int gateIndex = parentModuleGate->getIndex();
    int address = topo->getNode(i)->getModule()->par("address");
    rtable[address] = gateIndex; 
  } 
```

现在我想在另一个函数中更改 rtable 中的值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:31:30.787

`rtable`通过引用传递：

```
void some_func(std::map<int, int>& a_rtable)
{
    // Either iterate over each entry in the map and
    // perform some modification to its values.
    for (std::map<int, int>::iterator i = a_rtable.begin();
         i != a_rtable.end();
         i++)
    {
        i->second = ...;
    }

    // Or just directly access the necessary values for
    // modification.
    a_rtable[0] = ...; // Note this would add entry for '0' if one
                       // did not exist so you could use
                       // std::map::find() (or similar) to avoid new
                       // entry creation.

    std::map<int, int>::iterator i = a_rtable.find(5);
    if (i != a_rtable.end())
    {
        i->second = ...;
    }
} 
```

# google-chrome - 我可以从浏览器更改查看页面源代码部分的大小或字体吗？

> ID：10289703
> 
> 赞同：5
> 
> 时间：2012-04-23T23:29:06.030
> 
> 标签：google-chrome, fonts

有一个小问题可能会不时让我烦恼（如果有其他人也有同样的感觉，那就别想了）。每次我从任何浏览器使用查看页面源时，文本总是变得又丑又小（我的电脑分辨率为 1920x1080，特别是 17 英寸，这使得字母非常小且难以看到）。有没有办法从任何浏览器更改查看页面源部分的字体和大小？（例如铬）

我知道我可以通过鼠标滚动或“ctrl”+“+”来放大页面，但这并不是我真正想要解决的方法。

谢谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-05T16:57:07.353

从 Chrome 32.0.1700.76 开始，custom.css 无法按如下所述工作。

请在此处查看更新的答案： [Custom.css has stop working in 32.0.1700.76 m Google Chrome update](https://stackoverflow.com/questions/21207474/custom-css-stop-to-work-in-32-0-1700-76-m-google-chrome-update)

旧方法如下：

转到以下目录：

```
%LOCALAPPDATA%\Google\Chrome\User Data\Default\User StyleSheets\ 
```

苹果电脑：

```
~/Library/Application Support/Google/Chrome/Default/User StyleSheets/Custom.css 
```

并打开`Custom.css`文件。如果不存在，则创建一个。

添加以下行：

```
body.platform-windows .monospace, 
body.platform-windows .source-code, 
td.webkit-line-content {
  font-size: 15px !important;
  font-family: Consolas, Lucida Console, monospace !important;
  tab-size: 2;
} 
```

您所做的只是自定义 Chrome 内部使用的类。这`.monospace`门课很不言自明。该类`.source-code`会影响开发人员工具 (F12) 中的项目。您正在寻找的是`td.webkit-line-content`，它是在您选择时将样式应用于订单项的一种`View page source`。

您还可以通过添加样式来`td.webkit-line-number`编辑行号，也可以通过调整样式来编辑行号背景`div.webkit-line-gutter-backdrop`。

干杯。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-26T15:11:03.430

正如 Jeff Johnson 所说 - 对于 Mac，样式表位于：

```
~/Library/Application\ Support/Google/Chrome/Default/User\ StyleSheets/Custom.css 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-12T08:08:16.797

在 linux 平台 (Ubuntu) 上，Custom.css 文件位于文件夹中：

```
~/.config/google-chrome/Profile #/User Stylesheets/Custom.css 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T23:42:50.573

您可以指定您喜欢的编辑器从 IE 和 FireFox 查看源代码。

[在您喜欢的文本编辑器中查看网页源代码 - Firefox](http://www.howtogeek.com/howto/2246/view-webpage-source-code-in-your-favorite-text-editor-firefox/)

[在 IE 中使用备用源查看器](http://www.pctools.com/guides/registry/detail/774/)

# php - Cocoa - 应用程序/强制下载和 NSURLConnection

> ID：10289705
> 
> 赞同：0
> 
> 时间：2012-04-23T23:29:08.790
> 
> 标签：php, cocoa, nsurlconnection, mime

在我的应用程序中，我不得不处理不幸的 MIME 类型，application/force-download。我确实知道如果给出直接链接（例如[http://blah.com/something.zip](http://blah.com/something.zip)），可以建立一个 NSURLConnection 来下载文件，但我在任何地方都找不到任何成功/关于 URL 之类的信息这样的[http://blah.com/download.php?id=123](http://blah.com/download.php?id=123)这将是一个 PHP 文件。Web 浏览器当然可以执行此功能，但使用 Cocoa 库怎么可能。任何建议/指南都将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:30:23.493

您需要为您的`NSURLConnection`对象实现一个委托，并在该委托中实现此方法：

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response; 
```

从`NSURLReponse`参数中，您可以获得 MIME 类型和建议的文件名：

```
NSString* type = [response MIMEType];
NSString* fileName = [response suggestedFilename]; 
```

然后由您来编写您的应用程序，以便对于 MIME 类型`application/download`，您`NSData`通过委托接收并使用适当的文件名将其保存到磁盘。

# iphone - iPhone 针对某些设备

> ID：10289707
> 
> 赞同：2
> 
> 时间：2012-04-23T23:29:08.827
> 
> 标签：iphone, objective-c, ios

我想针对 iPhone 4、iPhone 4S、iPod Touch（第 4 代）。我不想针对 iPhone 3G 和 iPhone 3GS。我看过一些帖子说这是不可能的。但是，我在 App Store 中注意到一些应用程序会这样做，如下图所示。

我将如何做到这一点？

![在此处输入图像描述](../Images/ee6a9ef3867b00ebfa0f1c0992f6260c.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T23:43:42.437

之所以出现这些要求，是因为开发人员已将`armv7`其作为条目放入密钥中。没有专门针对 iPhone 4 及更高版本的键，尽管您可以使用其他键之一消除 3GS。[`UIRequiredDeviceCapabilities`](https://developer.apple.com/library/ios/#documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW3) `Info.plist`

您为什么要阻止人们在旧设备上安装您的应用程序？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:36:41.630

我相信您想要设置[`UIRequiredDeviceCapabilities`](http://developer.apple.com/library/ios/#documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW3)以准确指定您的应用程序需要哪些功能。例如`camera-flash`，如果您需要，该密钥仅适用于 iPhone4 及更高版本。

还有一篇关于它的[问答文章](http://developer.apple.com/library/ios/#qa/qa1397/_index.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:46:07.833

除了使用 UIRequiredDeviceCapabilities 设置设备所需的功能外，您还可以指定需要安装的最低 iOS 版本。

请参阅此[Apple 技术说明，TN2250](https://developer.apple.com/legacy/library/technotes/tn2250/_index.html)。

# freebsd - PC-BSD 9 侏儒问题

> ID：10289712
> 
> 赞同：0
> 
> 时间：2012-04-23T23:29:51.917
> 
> 标签：freebsd, gnome

如果我通过端口安装任何程序，并且我的屏幕保护程序启动或进入睡眠模式，gnome 将突然停止正常运行。如果我移动鼠标/按键，屏幕将从黑色闪烁到墙纸（不显示图标面板）。如果我强制关闭并重新启动 gnome 不启动，我可以通过终端登录系统。我还收到以下错误消息，提示找不到 Libpcre.so.0。其他人有这个问题/知道如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T08:31:05.193

对于 libpcre 问题，我建议使用 libchk (sysutils/libchk)。它检查哪些程序链接到未解析的库。重新安装这些端口。

# javascript - event.preventDefault 不起作用。Ajax 调用导致这个？

> ID：10289716
> 
> 赞同：0
> 
> 时间：2012-04-23T23:30:10.837
> 
> 标签：javascript, jquery

我正在尝试使用 scrolltop 方法并且 event.preventDefault 无法正常工作。我遇到的是页面先向上滚动然后向下滚动。似乎 onclick 会导致页面重新提交或什么...（ajax post??）

我有以下代码

按钮（触发器）

```
 <a id="nextset" class='nextbtn' >Next Step</a> 
```

事件

```
jQuery('#nextset').click(function (event) {
                event.preventDefault();
                movenext('set');
                jQuery('html,body').animate({ scrollTop: $('#subtitles').offset().top }, 2000);
            }); 
```

职能

```
 function getfav(obj) {
            var myParams = "{ 'proattr':'" + obj + "'}";
            jQuery.ajax({
                type: "POST",
                url: "project.aspx/getproject",
                data: myParams,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                beforeSend: function () { jQuery('#wait').show(); },
                complete: function () { jQuery('#wait').hide(); },
                success: function (msg) {
                    GetProjectPic(msg.d, obj); //creates DOM and insert in div
                    Initbtns();// dynamic btns initialization
                }
            });
        }

  function movenext(obj) {
            //other codes to hide/show DOM
            getfav(nextobj); 
        } 
```

如果我添加返回错误；在 onclick 事件中，按钮不起作用。

知道是什么导致滚动到顶部吗？

**更新：**

它是由 movenext 函数内部的代码块引起的。

```
jQuery('[id^="favdiv"]').empty(); 
```

与 event.preventDefault 无关。

奇怪的是，屏幕滚动比隐藏的 div 高度（“favdiv”）要多得多，这会导致屏幕上下效果。我不知道如何防止它...

**更新2**

我搜索了 jquery 空方法并找到了这个。

[jquery "empty" 改变滚动条](https://stackoverflow.com/questions/9326757/jquery-empty-changes-the-scrollbar)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:39:03.290

您可以使用以下代码段避免默认行为：

```
<a id="nextset" class="nextbtn" href="javascript:void(0);">Next Step</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:31:39.697

您是否有任何机会尝试在点击事件结束时添加“return false”？

```
jQuery('#nextset').click(function (event) {
            movenext('set');
            jQuery('html,body').animate({ scrollTop: $('#subtitles').offset().top }, 2000);
            event.preventDefault();
            return false;
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T17:54:45.967

我最终写了这样的东西。它仍然上升了一点，但至少页面没有跳转

```
 jQuery('#favdiv' + obj).fadeOut('fast', function () { 
     jQuery('#favdiv' + obj).remove(); 
 });
 setTimeout(function () {
     jQuery('html,body').animate({ scrollTop: $('#subtitles').offset().top }, 1500);
 }, 500); 
```

# php - 如何使用 zend 导航向 ul 元素添加类？

> ID：10289717
> 
> 赞同：1
> 
> 时间：2012-04-23T23:30:11.350
> 
> 标签：php, zend-framework, class, zend-navigation

我有一个简单的导航菜单，如下所示：

```
$container = new Zend_Navigation();
$container->addPage(array(
    'label' => 'Page 1',
    'uri'   => 'page-1',
    'foo'   => 'bar',
    'pages' => array(
        array(
            'label' => 'Page 1.1',
            'uri'   => 'page-1.1',
            'foo'   => 'bar',
        ),
        array(
            'label' => 'Page 1.2',
            'uri'   => 'page-1.2',
            'class' => 'my-class',
        )
    ),
... 
```

这将产生：

```
ul
  li
  li 
```

我如何将类/ id 分配给 the`ul`或 the `li`？

有任何想法吗？

谢谢

编辑：我找到了一个不同的解决方案：

我用这个功能

```
public static function htmlify($container, $menu_name = null)
{
    $i = 0;
    $menu = '<ul class="'.$menu_name.'">';
    foreach($container as $page)
    {
        $menu .= '<li id="'.$page->htmlfyId.'"><a id="menu-'.$page->id.'" class="'.$page->class.'" href="'.$page->uri.'">'.$page->label.'</a>';
        $menu .= '<ul id="'.$page->htmlfyClass.'">';

        foreach($page as $pages)
        {
            $menu .= '<li id="li"><a class="'.$page->class.'" href="'.$pages->uri.'">'.$pages.'</a></li>';
        }
        $menu .= '</li>';
        $menu .= '</ul>';
    }
return $menu;
} 
```

然后在保存菜单的方法中添加：

```
 $view = Zend_Layout::getMvcInstance()->getView();

$menu = self::htmlify($container, 'navigation');

    $view->menu = $menu;
    return $menu; 
```

我的班级有静态方法，你必须`echo class::method`在视图中，否则只需使用常规`$this->menu`或其他方法。

然后你可以像这样使用它：

```
$container = new Zend_Navigation();
$container->addPage(array(
    'label' => 'Page 1',
    'uri'   => 'page-1',
    'foo'   => 'bar',

    'htmlfyId' => 'testing',
    'htmlfyClass' => 'test',

    'pages' => array(
        array(
            'label' => 'Page 1.1',
            'uri'   => 'page-1.1',
            'foo'   => 'bar',
        ),
        array(
            'label' => 'Page 1.2',
            'uri'   => 'page-1.2',
            'class' => 'my-class',
        )
    ),
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T04:29:52.913

要在 ul 上添加一个类，试试这个

```
$options['ulClass'] = 'foo';

<?php echo $this->menu($container)->renderMenu($container,$options); ?> 
```

其中 $container 是您的 Zend_Navigation 对象。

# java - 在画布中绘制一个简单的网格？

> ID：10289718
> 
> 赞同：0
> 
> 时间：2012-04-23T23:30:19.937
> 
> 标签：java, swing, canvas, grid, awt

我用 Java 编写了 Conway 的 Game Of Life，我想在浏览器中显示它。我想学习一些 Canvas，那么绘制 2D 网格并用颜色填充每个单元格的首选方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T18:58:33.857

这将形成一个网格。我认为这对于定位或确定元素或某物的坐标以及其他几个可能的方便用例很有用。

```
var grid = function() {
    for (var i = 0; i < canvasWidth || i < canvasHeight; i += 100) { // 100 represents the width in pixels between each line of the grid
        // draw horizontal lines
        ctx.moveTo(i, 0);
        ctx.lineTo(i, canvasHeight);
        // draw vertical lines
        ctx.moveTo(0, i);
        ctx.lineTo(canvasWidth, i);
    }
    ctx.save();
        ctx.strokeStyle = 'hsla(200, 0%, 20%, 0.8)';
        ctx.stroke();
    ctx.restore();
};

// Call the function
grid() 
```

希望这会有所帮助，这也是您正在尝试做的事情。:)

编辑：如果您希望用不同的颜色填充每个网格正方形，则此功能将不起作用，或者至少可以与另一个以与上述功能类似的方式创建和填充正方形但切割的功能结合使用宽度和高度关闭基于画布宽度和高度的尺寸。

# destructor - 分配新字符数组（c 字符串）时的内存泄漏

> ID：10289720
> 
> 赞同：0
> 
> 时间：2012-04-23T23:30:25.903
> 
> 标签：destructor, memory-leaks, valgrind, cstring, dynamic-memory-allocation

我正在编写一个使用字符数组/ c 字符串的程序。每当我运行程序时，valgrind 都会抛出一个“肯定丢失”的块警告：

```
==8011== [X] bytes in [Y] blocks are definitely lost in loss record 1 of [Z]
==8011==    at 0x4A065BA: operator new[](unsigned long) (vg_replace_malloc.c:264)
==8011==    by 0x403D45: File::File(stat*, char const*) (File.cpp:15)
... 
```

这是构造函数和析构函数的源代码（标头包含 id、isDir、lastModified 和 name 的定义（名称的类型为 const char*））：

```
10  File::File(struct stat *statdat, const char* strName)
11  {
12    id = statdat->st_ino;
13    isDir = S_ISDIR(statdat->st_mode);
14    lastModified = (statdat->st_mtime);
15    char* tempName = new char[strlen(strName)+1];
16    strcpy(tempName, strName);
17    name = tempName;
18    tempName = NULL;
19  }
20  
21  File::~File()
22  {
23    //delete [] name;
24  } 
```

我有几个问题。

a) 在编译和运行时尝试在析构函数中保留删除会由于指针无效而导致即时崩溃。为什么我不能在字符数组上调用 delete？

b）我认为我正在为数组分配适量的内存。分配新空间时导致内存泄漏的原因是什么？该错误发生在程序停止后（在 valgrind 的 HEAP SUMMERY 之后）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:15:27.230

我已经确定了这个问题。

我的问题是 /default/ 构造函数。由于它没有初始化“名称”，因此当在默认构造函数创建的对象上调用析构函数时，delete 关键字试图删除空指针。我修改了 File 的默认构造函数，以便将 name 初始化为 '\0'，这似乎解决了问题。

# jquery - Jquery 从下拉列表中获取 SelectedText

> ID：10289721
> 
> 赞同：29
> 
> 时间：2012-04-23T23:30:30.270
> 
> 标签：jquery, asp.net-mvc-3

我正在尝试使用 Jquery 从下拉列表中获取选定的文本。

```
<div>
    @Html.DropDownList("SelectedCountryId", Model.CountryList, "(Select one Country)")
</div> 
```

下面给出的是我正在使用的 Jquery。但这不起作用。我试过

```
var selectedText1 = $("#SelectedCountryId").val($(this).find(":selected").text()); 
```

并返回 [object object]。但是如何阅读选定的文本？

接下来我尝试了

```
var selectedText2 = $("#SelectedCountryId:selected").text(); 
```

然后它返回空。

我也试过

```
var selectedText2 = $("#SelectedCountryId option:selected").text(); 
```

这也返回空。

我可以使用返回 selectedID

```
var selectedID = $("#SelectedCountryId").val(); 
```

但为什么不是选定的文本？

我的 Jquery 有什么问题吗？请帮忙

```
<script src="@Url.Content("~/Scripts/jquery-1.5.1.js")" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#SelectedCountryId").change(function () {

                var selectedText1 = $("#SelectedCountryId").val($(this).find(":selected").text());
                var selectedText2 = $("#SelectedCountryId:selected").text();
                alert("You selected :" + selectedText1 + selectedText2 );

            }); 
```

这是我下面的下拉列表的 HTML

```
<select id="SelectedCountryId" name="SelectedCountryId"><option value="">(Select one Country)</option>
<option value="19">USA</option>
<option value="10">Germany</option>
<option value="12">Australia</option> </select> 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-04-23T23:34:04.480

我昨天遇到了同样的问题:-)

```
$("#SelectedCountryId option:selected").text() 
```

我还读到这很慢，如果您想经常使用它，您可能应该使用其他东西。

我不知道为什么你的不起作用，这个是给我的，也许其他人可以帮助......

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-08-27T15:55:24.107

没有下拉 ID：

```
$("#SelectedCountryId").change(function () {
    $('option:selected', $(this)).text();
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-25T09:16:29.950

今天，使用 jQuery，我这样做：

```
$("#foo").change(function(){    
    var foo = $("#foo option:selected").text();
}); 
```

`\#foo`是下拉框id。

阅读[更多](https://learn.jquery.com/using-jquery-core/faq/how-do-i-get-the-text-value-of-a-selected-option/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-23T23:36:16.827

问题可能出在这一行：

```
 var selectedText2 = $("#SelectedCountryId:selected").text(); 
```

它正在寻找 id`SelectedCountryId`被选中的项目，你真的想要在**下** `SelectedCountryId`选择的选项，所以试试：

```
$('#SelectedCountryId option:selected').text() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-27T13:50:05.127

首先像我在这里一样设置下拉列表的 id 属性，而不是使用该 id 在 jquery 或 javascrip 中获取值。

**下拉列表：**

```
 @Html.DropDownList("CompanyId", ViewBag.CompanyList as SelectList, "Select Company", new { @id="ddlCompany" }) 
```

**jQuery：**

```
var id = jQuery("#ddlCompany option:selected").val(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-27T07:07:09.583

```
//Code to Retrieve Text from the Dropdownlist 

$('#selectOptions').change(function()
{
     var selectOptions =$('#selectOptions option:selected');
     if(selectOptions.length >0)
     {
        var resultString = "";
        resultString = selectOptions.text();
     }
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-23T23:45:29.980

如果您使用`<select>`,事件`$(this).val()`内部`change()`返回当前选定选项的值。大多数时候使用`text()`是多余的，因为它通常与值相同，如果不同，您最终可能会在后端使用值而不是文本。所以你可以这样做：

[http://jsfiddle.net/elclanrs/DW5kF/](http://jsfiddle.net/elclanrs/DW5kF/)

```
var selectedText2 = $(this).val(); 
```

**编辑：**请注意，如果您的`value`属性为空，大多数浏览器都将内容用作值，因此无论哪种方式都可以。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-14T16:25:17.550

从多个下拉列表中获取文本

```
var texts = [];
$('#list :selected').each(function(){
    texts.push($(this).text());
}); 
```

texts 现在包含选定文本的列表

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-21T06:54:18.783

```
$("#SelectedCountryId_option_selected")[0].textContent 
```

这对我有用，在这里而不是`[0]`传递下拉列表的选定索引。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-14T11:51:21.880

请使用这个

```
 var listbox = document.getElementById("yourdropdownid");
    var selIndex = listbox.selectedIndex;
    var selValue = listbox.options[selIndex].value;
    var selText = listbox.options[selIndex].text; 
```

然后请提醒“selValue”和“selText”。你得到你选择的下拉值和文本

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-08-09T17:11:33.647

```
 <%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm1.aspx.cs" Inherits="WebApplication1.WebForm1" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script src="jquery-3.1.0.js"></script>
    <script>
        $(function () {
            $('#selectnumber').change(function(){
                alert('.val() = ' + $('#selectnumber').val() + '  AND  html() = ' + $('#selectnumber option:selected').html() + '  AND .text() = ' + $('#selectnumber option:selected').text());
            })
        });
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <select id="selectnumber">
            <option value="1">one</option>
            <option value="2">two</option>
            <option value="3">three</option>
            <option value="4">four</option>
        </select>

    </div>
    </form>
</body>
</html> 
```

[![点击查看输出画面](../Images/8b43bf0864b3d3ab95af3ae58a918687.png)](https://i.stack.imgur.com/oKLuR.png)

谢谢...：）

# php - PHP：上传前重命名文件

> ID：10289723
> 
> 赞同：0
> 
> 时间：2012-04-23T23:30:36.490
> 
> 标签：php, upload, amazon-s3, rename

我正在尝试在上传到 Amazon S3 之前重命名每个文件。

我正在尝试使用@Silvertiger 回答的这种确切方法：[PHP - 上传并覆盖文件（或上传并重命名它）？](https://stackoverflow.com/questions/8919804/php-upload-and-overwrite-a-file-or-upload-and-rename-it)

如果存在，请重命名为随机名称，尽管不知何故它不起作用。

这是来自 Amazon S3 类的上传帖子参数：

```
public static function getHttpUploadPostParams($bucket, $uriPrefix = '', $acl = self::ACL_PRIVATE, $lifetime = 3600,
    $maxFileSize = 5242880, $successRedirect = "201", $amzHeaders = array(), $headers = array(), $flashVars = false)
    {
        // Create policy object
        $policy = new stdClass;
        $policy->expiration = gmdate('Y-m-d\TH:i:s\Z', (time() + $lifetime));
        $policy->conditions = array();
        $obj = new stdClass; $obj->bucket = $bucket; array_push($policy->conditions, $obj);
        $obj = new stdClass; $obj->acl = $acl; array_push($policy->conditions, $obj);

        $obj = new stdClass; // 200 for non-redirect uploads
        if (is_numeric($successRedirect) && in_array((int)$successRedirect, array(200, 201)))
            $obj->success_action_status = (string)$successRedirect;
        else // URL
            $obj->success_action_redirect = $successRedirect;
        array_push($policy->conditions, $obj);

        if ($acl !== self::ACL_PUBLIC_READ)
            array_push($policy->conditions, array('eq', '$acl', $acl));

        array_push($policy->conditions, array('starts-with', '$key', $uriPrefix));
        if ($flashVars) array_push($policy->conditions, array('starts-with', '$Filename', ''));
        foreach (array_keys($headers) as $headerKey)
            array_push($policy->conditions, array('starts-with', '$'.$headerKey, ''));
        foreach ($amzHeaders as $headerKey => $headerVal)
        {
            $obj = new stdClass;
            $obj->{$headerKey} = (string)$headerVal;
            array_push($policy->conditions, $obj);
        }
        array_push($policy->conditions, array('content-length-range', 0, $maxFileSize));
        $policy = base64_encode(str_replace('\/', '/', json_encode($policy)));

        // Create parameters
        $params = new stdClass;
        $params->AWSAccessKeyId = self::$__accessKey;
        $params->key = $uriPrefix.'${filename}';
        $params->acl = $acl;
        $params->policy = $policy; unset($policy);
        $params->signature = self::__getHash($params->policy);
        if (is_numeric($successRedirect) && in_array((int)$successRedirect, array(200, 201)))
            $params->success_action_status = (string)$successRedirect;
        else
            $params->success_action_redirect = $successRedirect;
        foreach ($headers as $headerKey => $headerVal) $params->{$headerKey} = (string)$headerVal;
        foreach ($amzHeaders as $headerKey => $headerVal) $params->{$headerKey} = (string)$headerVal;
        return $params;
    } 
```

这是@Silvertiger 的方法：

```
// this assumes that the upload form calls the form file field "myupload"
$name  = $_FILES['myupload']['name'];
$type  = $_FILES['myupload']['type'];
$size  = $_FILES['myupload']['size'];
$tmp   = $_FILES['myupload']['tmp_name'];
$error = $_FILES['myupload']['error'];
$savepath = '/yourserverpath/';
$filelocation = $svaepath.$name;
// This won't upload if there was an error or if the file exists, hence the check
if (!file_exists($filelocation) && $error == 0) {
    // echo "The file $filename exists";
    // This will overwrite even if the file exists
    move_uploaded_file($tmp, $filelocation);
}
// OR just leave out the "file_exists()" and check for the error,
// an if statement either way 
```

这是我的上传表格：

```
 <form method="post" action="<?php echo $uploadURL; ?>" enctype="multipart/form-data">
<?php
    foreach ($params as $p => $v)
        echo "        <input type=\"hidden\" name=\"{$p}\" value=\"{$v}\" />\n";
?>
        <input type="file" name="file" />&#160;<input type="submit" value="Upload" />
    </form> 
```

**这是输入信息：**

```
public static function inputFile($file, $md5sum = true)
    {
        if (!file_exists($file) || !is_file($file) || !is_readable($file))
        {
            self::__triggerError('S3::inputFile(): Unable to open input file: '.$file, __FILE__, __LINE__);
            return false;
        }
        return array('file' => $file, 'size' => filesize($file), 'md5sum' => $md5sum !== false ?
        (is_string($md5sum) ? $md5sum : base64_encode(md5_file($file, true))) : '');
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T03:53:55.603

此时您可以在代码中进行重命名：

```
move_uploaded_file($tmp, $filelocation); 
```

`$filelocation`可以更改为您想要的任何内容，上传的文件将重命名为该路径。

**编辑**：该`S3::getHttpUploadPostParams`方法始终使用上传的文件名来创建 S3 资源。要更改它，您必须复制该方法但更改此行：

```
$params->key = $uriPrefix.'${filename}'; 
```

`'${filename}`必须更改为您选择的路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T17:40:33.063

替换这个：

```
// Create parameters
$params = new stdClass;
$params->AWSAccessKeyId = self::$__accessKey;
$params->key = $uriPrefix.'${filename}'; 
```

有了这个：

```
function rand_string( $length ) {
            $chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";  

            $size = strlen( $chars );
            for( $i = 0; $i < $length; $i++ ) {
                $str .= $chars[ rand( 0, $size - 1 ) ];
            }

            return $str;
        }       

        // Create parameters
        $params = new stdClass;
        $params->AWSAccessKeyId = self::$__accessKey;
        $params->key = $uriPrefix.rand_string(5).'${filename}'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-02T05:20:33.620

您可以轻松地输入此代码.. 100% 工作。

```
<?php
$file=$_FILES['file']['name'];
$path ="upload/".$file;
$ext=pathinfo($path,PATHINFO_EXTENSION);
$name=pathinfo($path,PATHINFO_FILENAME);
if(file_exists($path))
{
    echo "File alredy exists .So name is changed automatically & moved";
    $path1="upload/";
    $new_name=$path1.$name.rand(1,500).".".$ext;
    move_uploaded_file($_FILES['file']['tmp_name'],$new_name);
}
else
{
echo"uploaded Sucessfully without any change";
move_uploaded_file($_FILES['file']['tmp_name'],$path);
}
?> 
```

# build - 使用 Team City 编译 SSIS 项目

> ID：10289725
> 
> 赞同：1
> 
> 时间：2012-04-23T23:30:42.510
> 
> 标签：build, ssis, teamcity

有人做过吗？如果是这样，您使用了哪些工具/技术/方法？

是否可以安装 Visual Studio 的 SQL Business Studio 版本？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T14:09:19.263

就像 booyaa 说的 SSIS 项目不需要编译，但我所做的是使 .dtconfigs 可以通过构建/部署过程进行配置。

我这样做是为了可以在不同环境中运行部署包。因此构建将复制 dtconfig 文件的模板。这包含令牌 -`$(Servername) $(ConnectionString)` 然后我在部署时进行替换，然后通过将 dtexec 包装在命令中来执行。

不确定2012年。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T21:23:32.197

明白了各位...

1) 安装 MSBuild 扩展

2）像这样创建了一个Build.Xml文件......

```
<Project ToolsVersion="3.5" DefaultTargets="Default" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
<Import Project="$(MSBuildExtensionsPath)\ExtensionPack\MSBuild.ExtensionPack.tasks"/>
<Target Name="Default">
    <PropertyGroup>
        <OutputRoot>../../../build-artifacts</OutputRoot>
    </PropertyGroup>
    <ItemGroup>
        <SSISProjectFile Include="SSISProject.dtproj"/>
        <SSISProject Include="@(SSISProjectFile)">
            <OutputDirectory>$(OutputRoot)</OutputDirectory>
        </SSISProject>      
    </ItemGroup>
    <ItemGroup>
        <Namespaces Include="Mynamespace">
            <Prefix>DTS</Prefix>
            <Uri>www.microsoft.com/SqlServer/Dts</Uri>
        </Namespaces>
    </ItemGroup>

    <MSBuild.ExtensionPack.Xml.XmlFile 
        TaskAction="UpdateElement" 
        File="EnclarityDataImport.dtsx" 
        XPath="//DTS:Property[@DTS:Name='ConfigurationString']" 
        InnerText="$(MSBuildProjectDirectory)\EnclarityDataImport.dtsConfig"
        Namespaces="@(Namespaces)"/>
    <MSBuild.ExtensionPack.SqlServer.BuildDeploymentManifest InputProject="@(SSISProject)"/>
</Target> 
```

唯一的技巧是这里构建的最后一部分。默认情况下，Visual Studio 将绝对路径添加到 dtsx 包的配置和连接字符串文件。Team City 将结合使用这些与 MSBuild 扩展来构建包，因此本地路径将中断构建，因为 Team City 中构建目录的路径是自动生成的。因此，使用上面的代码和 $(MSBuildProjectDirectory)，您可以调整 dtsx 文件上的路径值，使其指向正在执行编译的路径。

# android - Android 模拟器：用于测试的假相机

> ID：10289732
> 
> 赞同：1
> 
> 时间：2012-04-23T23:31:44.150
> 
> 标签：android, android-camera

我想制作一个使用 android 相机的应用程序，但我想使用模拟器对其进行测试。我没有用于实时图像的网络摄像头，所以我想知道我是否可以（以某种方式）伪造静止图像，或者我需要在我的台式电脑上使用类似假摄像头的东西，然后制作它由安卓模拟器使用。

我搜索了一些解决方案，但它们看起来很旧。任何人都在使用类似的东西，并且可以指出一个“新鲜”的解决方案吗？

# linux - 初始化套接字时出错：端口 = 6000。地址已被使用

> ID：10289739
> 
> 赞同：0
> 
> 时间：2012-04-23T23:32:00.287
> 
> 标签：linux

当我想从 Linux 的进程列表中杀死这个进程并想再次运行它时，我在我的 Ubuntu 11 中使用 C++ 开发了一个模拟器程序，我遇到了这个错误：

> ```
> Error initializing sockets: port=6000\. Address already in use 
> ```

我使用 lsof 命令查找进程的 PID：

> ```
> saman@jack:~$ lsof -i:6000
> COMMAND    PID  USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
> rcssserve 8764 saman    3u  IPv4  81762      0t0  UDP *:x11 
> ```

之后我试图杀死 8764 的 PID。但它仍然有错误。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:50:04.843

我认为您遇到的问题是套接字如果没有正确关闭，那么它仍然被保留并等待内核关闭超时。

尝试做一个`netstat -nutap`，看看是否有这样的一行：

```
tcp        0      0 AAA.AAA.AAA.AAA:6000     XXX.XXX.XXX.XXX:YYYY       TIME_WAIT   - 
```

如果是这种情况，您只需要等到内核丢弃它（大约 30 秒），直到您可以在 6000 处打开套接字而不会发生冲突

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:37:57.800

看起来端口 6000 被 X 窗口系统（Linux 的 GUI 部分）使用，并且在您终止进程时可能刚刚重新启动......您需要在没有运行 X 窗口的情况下运行模拟，或者您进行调整使用不同端口的代码..

# postgresql - 在 PostgreSQL 中使用 XPath 选择根元素的名称

> ID：10289743
> 
> 赞同：2
> 
> 时间：2012-04-23T23:32:31.143
> 
> 标签：postgresql, xpath, document-root

我在 PostgreSQL 9.1.3 表中有一堆 XML 消息，其中有一列`content`类型为 XML）。它们并非都是相同的“类型”，所以我尝试使用这样的查询来提取根类型：

```
SELECT xpath('name(/*)', content) FROM message; 
```

正如[this answer](https://stackoverflow.com/a/369196/63991) to a similar SO question所建议的那样。

示例消息是：

```
<?xml version="1.0" encoding="UTF-8"?>
<WML version="6" xmlns="http://example.com/schemas/WML">...</WML> 
```

对于这种情况，我希望得到结果“{WML}”。不幸的是，它只返回一个空数组。将命名空间参数添加到`xpath`消息中或从消息中删除命名空间都没有帮助。

关于 PostgreSQL 邮件列表的讨论似乎将其[解释为](http://archives.postgresql.org/pgsql-bugs/2008-07/msg00058.php)PostgreSQL 中 XPath 处理中的一个错误。然而那是在 2008 年，查看 PostgreSQL 源代码显示，这段代码在 2009[年发生](http://git.postgresql.org/gitweb/?p=postgresql.git;a=commitdiff;h=c9cab106f6f8d0807f3f56db39826dc0030236b3;hp=1079564979dc2fecfadaddd6808ea2343a782ba6)了变化。我不是 PostgreSQL 开发人员，所以我不确定这个错误是不是我的情况的一个因素。

但我想知道是否有解决方法，例如可能有效的替代 XPath 表达式？我宁愿不必求助于正则表达式来解析 XML，但如果你能建议一个简短、有力、健壮的 RE，那么它总比没有好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T02:00:27.460

显然，截至 2011 年 6 月，这尚未解决。
我发现[这个线程`pgsql-hackers`](http://archives.postgresql.org/pgsql-hackers/2011-05/msg01521.php)准确地描述了您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:29:02.293

我不知道旧版本的解决方法，但这在 PostgreSQL 9.2 中已修复，所以很好。

（最可能的解决方法可能是编写一个函数来手动解析 XML，但我很高兴我现在不必求助于它！）

# spring - 导航到另一个页面时，@Viewscoped bean 不会被破坏

> ID：10289745
> 
> 赞同：3
> 
> 时间：2012-04-23T23:32:52.030
> 
> 标签：spring, jsf, backing-beans

我`@Viewscoped`在 JSF 2.1 项目中使用 bean。奇怪的是，当我第一次获得一个页面时，bean 显然已使用所有初始参数进行了初始化。但是当我导航到另一个页面时，即使我关闭了打开 te 应用程序的浏览器选项卡，bean 也不会死。当我返回使用该 bean 的页面时，值与在使用该页面期间修改的值相同。而且，如果我打开另一个浏览器，如 IE 或 Chrome，这些值仍然存在！！表现得像一个会话范围。或者某种永生豆，je。

bean 是这样注释的。

```
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;
import org.springframework.stereotype.Controller;

@Controller
@ManagedBean
@ViewScoped

public class MyBean {
  //the rest of the code.
} 
```

为什么会这样？springframework注释可能是问题的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T18:10:38.790

我找到了解决方案。问题是我在 bean 中的 spring 注释。我`@Controller`从 Spring Framework 中使用。这个注释创建了一个单例，所以我的支持 bean，即使它有`@ManagedBean`and `@ViewScoped`，也只创建了一次，并且从未在每个视图中重新创建过。我删除`@Controller`并替换`@Autowired`了`@ManagedProperty`注射，现在一切都按预期工作。

这个问题的答案[有助于](https://stackoverflow.com/questions/10483115/data-from-requestscoped-bean-is-cached)弄清楚

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-11-28T22:12:38.337

使用这个注解定义你的 Bean

```
@ViewScoped
public @Named class MyBean 
```

`@PreDestroy`效果很好。

# c++ - 网格表面的三角形的纵横比

> ID：10289752
> 
> 赞同：5
> 
> 时间：2012-04-23T23:33:26.047
> 
> 标签：c++, math, mesh

我需要计算三角形的纵横比。我有 3 个点，因此我有长度和中点。我正在尝试使用[本](https://www.sharcnet.ca/Software/Ansys/17.0/en-us/help/wb_fem/femod_aspect_triangle.html)教程（尽管在我看来它并不多），但它非常模糊并且没有提供太多信息。有人可以详细说明，特别是在矩形创建部分，甚至分享一些 C++ 代码来解决这个问题吗？

对于詹姆斯的解决方案：

```
double s = (a + b + c) / 2.0;
double AR = (a * b * c) / (8.0 * (s - a) * (s - b) * (s - c)); 
```

@詹姆士：

Cubit 报告如下：

```
Function Name  Average      Std Dev      Minimum     Maximum
-------------  ---------    ---------    ---------   ---------
Aspect Ratio   1.000e+00    7.371e-04    1.000e+00   1.010e+00
-------------------------------------------------------------- 
```

您的公式报告以下内容：

```
Function Name  Average    Minimum    Maximum
-------------  ---------  --------   -------
Aspect Ratio   1.00006    1.000000   1.00972
-------------------------------------------- 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T00:04:39.540

这些是我知道的三角形纵横比的定义：

三角形的纵横比是最长边与最短边的比率（因此等边三角形的纵横比为 1）。

三角形的纵横比是外接半径与其内半径的两倍之比，所以三角形的边长和 是`AR = abc/(8(s-a)(s-b)(s-c))`哪里。因此，如果，则纵横比为 1。`a,b,c``s = (a+b+c)/2``a=b=c`

这些比你给出的更容易计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-31T15:54:25.883

外接半径与内半径的两倍之比是正确的定义。有一个稍微简单的公式：AR = a *b* c/((b+ca) *(c+ab)* (a+bc))

# c# - 我使用什么控件来获取 C# 中的自定义选中列表框？

> ID：10289755
> 
> 赞同：1
> 
> 时间：2012-04-23T23:33:36.237
> 
> 标签：c#, winforms, listbox

![在此处输入图像描述](../Images/450211aec4e71c7b76cf66bd3abf0a6f.png)

我正在寻找一个控件，该控件将显示一个图层列表，其中包含一个用于切换其可见性的复选框和一个用于预览的缩略图。

我在 c# win 表单中使用什么控件？如何自定义渲染单个列表单元格？

在 java 中，我会使用 JTable 并根据每个单元格的类型渲染每个单元格。我如何在 C# 中做同样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T23:39:16.990

[ListView](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.aspx)应该做你需要的。

编辑：特别是在属性中启用“复选框”。您可以查看[Owner Drawing](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.ownerdraw.aspx)以获得更多渲染功能。

# python - Python / 字符串 / 辅音

> ID：10289761
> 
> 赞同：3
> 
> 时间：2012-04-23T23:34:28.133
> 
> 标签：python

我试图弄清楚如何在句子中获得辅音的表示。我刚刚使用的代码似乎没有完成这项工作：

```
vowels = ("aeiou")
count = 0
for x in text:
    if not x in vowels:
        count += 1 
```

在示例“hello world”作为输入中，我收到 8 个辅音。提前谢谢了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-23T23:44:48.240

你最好直接检查辅音，而不是“不是元音，不是空格，不是标点符号和......”

```
consonants = "bcdfghjklmnpqrstvwxyz"
count = 0
for x in text:
    if x in consonants:
        count += 1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T23:40:04.423

您正在计算所有字符，包括空格。此外，您还需要包含标点符号、空格和任何其他非辅音字符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-23T23:48:47.100

更直接

```
consonants = set("bcdfghjklmnpqrstvwxyz")
count = sum(1 for c in text if c in consonants) 
```

为辅音使用一组应该会使查找更快一点

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T23:48:39.843

```
import string

all_letters = string.ascii_letters

consonants = set(all_letters).difference(set(('a','e','i','o','u','A','E','I','O','U')))

my_sentence = 'Here is my Sentence'

sum_of_cons = sum(ele in consonants for ele in my_sentence) 
```

结果

```
>>> sum_of_cons
10 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T02:44:32.970

如果速度确实起作用，编译的正则表达式似乎是获得计数的最快方法。

**计时结果**

```
Found 8292 Consonants in 0.002978 seconds using compiled regex
Found 8292 Consonants in 0.009412 seconds using sets
Found 8292 Consonants in 0.024511 seconds by looking at each character 
```

**测试代码**

```
import re
import time
import os
string_length = 100000
random_string = os.urandom(string_length)

con_re = re.compile("[bcdfghjklmnpqrstvwxyz]")
start = time.clock()
re_results = con_re.findall(random_string)
print "Found %d Consonants in %f seconds using compiled regex" % (len(re_results), time.clock() - start)

consonants = set("bcdfghjklmnpqrstvwxyz")
start = time.clock()
count = sum(1 for c in random_string if c in consonants)
print "Found %d Consonants in %f seconds using sets" % (count, time.clock() - start)

cnt = 0
consonants = "bcdfghjklmnpqrstvwxyz"
start = time.clock()
for x in range(string_length):
    if random_string[x] in consonants:
        cnt += 1
print "Found %d Consonants in %f seconds by looking at each character" % (cnt, time.clock() - start) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-23T23:36:27.210

不要忘记考虑空格。

根据您的代码，8 看起来像是正确答案。

空格字符不在您的元音列表中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-23T23:46:49.143

也许您可以使用以下代码：

```
consonants = list("bcdfghjklmnpqrstvwxyz")
word=" hello world "
number_of_consonants = sum(word.count(c) for c in consonants) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-12-25T01:06:10.487

使用*非元音*条件、*字典理解*和*`Counter`*.

```
import collections as ct

text = "Hello world!"
vowels = ("aeiou")
letters = ct.Counter(text.lower()) 
```

对于前面显示的类似技术，不需要一长串辅音。`isalpha`您仍然可以使用and搜索不是元音的字母 `not in vowels`。 `isalpha`消除空格和标点符号：

```
# Option 1: Non-vowels

sum(1 for letter in text.lower() if letter.isalpha() and not letter in vowels)
 # 7 
```

对于更精细的细节，我们可以使用一个`Counter`对象来计算文本中的每个唯一字母，并使用字典理解来保留所有辅音：

```
# Option 2: Dictionary comprehension

comp = {k:v for k, v in letters.items() if letter.isalpha() and not letter in vowels}    
comp 
# {'d': 1, 'h': 1, 'l': 3, 'r': 1, 'w': 1}

sum(comp.values())
# 7 
```

此外，`Counter`对象具有有用的属性，例如`.most_common()`和`.elements()`。当然，您也可以轻松地汇总所有辅音。`Counter`在这里，我们将单独为辅音制作一个特殊的：

```
# Option 3: Consonants counter

consonants = letters.copy()
for k in letters:
    if k in vowels or not k.isalpha():
        consonants.pop(k)

consonants
# Counter({'d': 1, 'h': 1, 'l': 3, 'r': 1, 'w': 1})

consonants.most_common(3)
#[('l', 3), ('d', 1), ('h', 1)] 

list(consonants.elements())
# ['d', 'h', 'l', 'l', 'l', 'r', 'w']

sum(consonants.values())
# 7 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-02T06:44:58.073

```
def count_consonants(sample_string):
    spaces_removed = sample_string.replace(" ", "")
    count = 0
    vowels = ['a', 'e', 'i', 'o', 'u']
    for char in spaces_removed.lower():
        if char not in vowels:
            count = count + 1
    return count 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-02-28T13:42:02.313

```
def count_consonants(some_string):
    some_string=some_string.lower();
    consonants = list("bcdfghjklmnpqrstvwxyz")
    number_of_consonants = sum(some_string.count(c) for c in consonants)
    return number_of_consonants

test_str="Hercules was a hero"
result_str=count_consonants(test_str)
print(result_str) 
```

# java - 数独板的 JComponent 构建

> ID：10289763
> 
> 赞同：0
> 
> 时间：2012-04-23T23:34:32.083
> 
> 标签：java, swing, jframe, jcomponent, sudoku

我正在尝试建立一个数独板。现在我只是想让板子画出来，我试过画线，但被告知这样更好……我还没有让它工作。关于我做错了什么的任何提示

```
import java.awt.Component;
import java.awt.GridLayout;

import javax.swing.*;

public class SudokuView4 extends JPanel {
    int rows = 3;
    int col = 3;
    public JPanel container = new JPanel(new GridLayout(rows*col,rows*col));

    public SudokuView4(SudokuBase sb) {
        // TODO Auto-generated constructor stub

        for(int r = 0; r < rows; r++){
            for(int c = 0; c < col; c++){
                //container.add(Region(rows,col));
                //add(build);
                //build.setSize(50, 50)
                Region();
                container.setVisible(true);
            }
        }
    }

    //class Region extends JPanel {

    public void Region( ) {
        //setLayout(new GridLayout(3,3));
        //JPanel grid = new JPanel(new GridLayout(3,3));
        //grid.setSize(50, 50);

        for(int r1 = 0; r1 < rows; r1++){
            for(int c1 = 0; c1 < col; c1++){
                //JPanel grid = new JPanel();
                JButton build = new JButton();

                container.add(build);
                //container.setVisible(true);               
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T17:34:57.513

JPanel 容器需要放置在 JFrame 内，并在添加按钮后进行更新。这是如果您的目标是运行 Java 应用程序。

```
import java.awt.Component;
import java.awt.GridLayout;

import javax.swing.*;

public class SudokuView4 extends JPanel {
int rows = 3;
int col = 3;
public JPanel container = new JPanel(new GridLayout(rows*col,rows*col));

// added main for testing
public static void main(String [] args){
    SudokuView4 sudoku = new SudokuView4();
}

public SudokuView4(/*SudokuBase sb*/) {
    // TODO Auto-generated constructor stub
    JFrame frame = new JFrame();
    frame.add(container);

    for(int r = 0; r < rows; r++){
        for(int c = 0; c < col; c++){
            //container.add(Region(rows,col));
            //add(build);
            //build.setSize(50, 50)
            Region();
            container.setVisible(true);
        }
    }

    frame.setSize(300,300);
    frame.setVisible(true);
}

//class Region extends JPanel {

public void Region( ) {
    //setLayout(new GridLayout(3,3));
    //JPanel grid = new JPanel(new GridLayout(3,3));
    //grid.setSize(50, 50);

    for(int r1 = 0; r1 < rows; r1++){
        for(int c1 = 0; c1 < col; c1++){
            //JPanel grid = new JPanel();
            JButton build = new JButton();

            container.add(build);
            //container.setVisible(true);               
        }
    }
}
} 
```

# php - PHP，如何根据 url 变量为页面加载不同的内容？

> ID：10289764
> 
> 赞同：0
> 
> 时间：2012-04-23T23:34:35.447
> 
> 标签：php, variables

例如：

如果我只有 cite.php，它会默认为

如果是 cite.php?c=1，那么它会加载其他内容。

与 cite.php?c=2 ....etc 相同

我在使用 switch,case 语句之前做过，但我忘了怎么做:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T23:38:16.360

```
$f = $_GET["c"];

switch($f){
  case 1:
    /* content here*/
  break;

  case 2:
  /* content here*/
  break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:42:17.380

您可以使用以下代码：

```
 $c = isset($_GET['c'])?$_GET['c'] : ''; 
    switch ($c) {

    case 1:
        /* Do something related to 1 */
        break;
    case 2:
        /* Do something related to 2 */
        break;
    default:
      /* Do something related to default */
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:36:27.503

您可以使用 &_GET 变量：

```
<?php echo $_GET["c"]; ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T23:36:56.387

你会用`$_GET[]`

```
if isset($_GET['c']) {
    /* write code to show specific info *?
} else {
    /* show other info here */
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T00:26:45.973

你可以用 if 语句更简单地做到这一点

将此代码放在标题页中

```
<?php 

$page = $_GET['c'];

if(!isset($page)) {
    header('location:cite.php?c=1');
    exit;
}

?> 
```

然后使用它在页面上加载显示不同的元素（放置在`<body></body>`标签之间）

```
<? if ($page == "1") {?>

<h2>page 1</h2>

<? } else if ($page == "2") { ?>
<h2>page 2</h2>

<? } ?> 
```

链接看起来像这样

```
<a herf="cite.php?c=1">Link 1</a> <a herf="cite.php?c=2">Link 2</a> 
```

# c++ - std 命名空间中变量/类的前向声明

> ID：10289766
> 
> 赞同：16
> 
> 时间：2012-04-23T23:34:37.010
> 
> 标签：c++, class, std, forward-declaration

如果我有一个不需要在 .hpp 文件中完整定义的类，我通常主要使用前向声明

前任）

```
 //B.hpp

 namespace A_file {
   class A;
 }

 namespace B_file {

  class B {
   public:
        B();
   private:
        A *ptr_to_A;
  }
 }

 //B.cpp

 #include "A.hpp"
 using namespace A_file;

 namespace B_file {

   B(int value_) {
        *ptr_to_A = new A(value_);
   }

   int some_func() {
        ptr_to_A->some_func_in_A();
   }
 } 
```

我写这种代码。我认为，它将再次保存包括整个 hpp。（随意评论，如果你喜欢，这不健康）

有没有一种方法可以对 std 命名空间中的对象/类做同样的事情？如果有办法，是否可以或有副作用？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-24T00:27:25.933

您可以在头文件中转发声明自己的类以节省编译时间。但是你不能为命名空间 std 中的类。根据 C++11 标准，17.6.4.2.1：

> 如果 C++ 程序将声明或定义添加到命名空间 std 或命名空间 std 内的命名空间，则 C++ 程序的行为是未定义的，除非另有说明。

请注意，其中一些类是模板类的 typedef，因此简单的前向声明将不起作用。例如，您可以使用`#include<iosfwd>`代替`#include<iostream>`，但没有类似的标头仅具有 , 等的前向`string`声明`vector`。

有关详细信息，请参阅[GotW #34，前向声明](http://www.gotw.ca/gotw/034.htm)。

# c++ - C++ 构建错误 - '{' 标记之前的预期类名|

> ID：10289767
> 
> 赞同：1
> 
> 时间：2012-04-23T23:34:51.453
> 
> 标签：c++, oop

我有下面的类，它继承自 Collection 类，其中定义了我需要稍后在下面的派生类中实现的虚函数。除了派生类的构造函数之外，我还没有在 .cpp 文件中包含成员函数的定义。但是，当我构建我的项目时，我收到以下错误消息

**'{' token| 之前的预期类名**

我已经尝试了所有我知道的尝试，并且需要帮助来理解我的代码中的错误以及如何修复它。

```
 #ifndef VARIABLEARRAY_H
#define VARIABLEARRAY_H

#include "Collection.h"

using namespace std;

class VariableArray: public Collection{ 

        int* list[];// dynamic array that is resized on demand

    public:
        VariableArray();

};
#endif 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:41:16.823

你确定`Collection`你的翻译单位已经看到了这个符号吗？

您可能需要添加：

```
#include "Collection.h" 
```

（或任何正确的名称）在类定义之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:44:32.243

我认为您也可以转发声明 Collection：

```
class Collection;

class VariableArray : public Collection {
....
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:58:43.410

您如何确定`Collection`编译器是否可用？`class`声明是否显示`Collection`在文件的***预处理***输出中`VariableArray.cpp`，或者相应的源文件是什么？

查看预处理的输出可以帮助您确定：

*   如果命名空间污染是一个问题（例如`#define`与 碰撞`Collection`）
*   如果`Collection`声明在您的声明之前确实可用`VariableArray`。

如果这不是命名空间污染问题，我会检查您是否`#include`在多个头文件中使用相同的保护。

# javascript - JQuery / Canvas / Javascript ...我可以用什么来移动或旋转鼠标到一个div中的图像？

> ID：10289768
> 
> 赞同：2
> 
> 时间：2012-04-23T23:34:52.093
> 
> 标签：javascript, canvas, svg, rotation, move

我正在开发一个使用 PHP/Javascript/JQuery 的交互式网站。在页面上，我想建议访问者用鼠标移动和/或旋转图像，以创建新的构图（如下图所示）并将结果保存为 JPG...</p>

![将图像移动和旋转到 div](../Images/c8c364615d2612b9faab2c1c2e72296a.png)

……但我真的不知道该怎么做……你能帮帮我吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T03:01:19.423

对于这么简单的事情，我会使用 SVG 而不是 Canvas。

[Raphael](http://raphaeljs.com/)是 SVG 的优秀库之一。

可以做像这样简单的事情的画布库是[FabricJS](http://fabricjs.com/)和[KineticJS](http://www.kineticjs.com/)

通常我不提倡图书馆，但如果这就是应用程序要做的所有事情，那么它将为您节省大量时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T08:44:55.383

Another possibility is to make use of the [svg-edit](http://code.google.com/p/svg-edit/) project, possibly tweaking it to better suit your needs if all you want is basic transforms.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T03:14:31.733

所以让我明确**一点，这真的很难**。

如果您使用 Canvas，您可以使用小型服务器端脚本将其导出为 PNG。

还有其他人做过这样的事情，[Lucid Chart](http://www.lucidchart.com/)使用 DOM 元素来移动东西并用 Canvas 绘制它们。我不确定他们是如何出口的。

如果您将 Canvas 用于整个事情，这里有一点关于如何做到这一点。

在 PHP 方面：

```
// requires php5
define('UPLOAD_DIR', 'images/');
$img = $_POST['img'];
$img = str_replace('data:image/png;base64,', '', $img);
$img = str_replace(' ', '+', $img);
$data = base64_decode($img);
$file = UPLOAD_DIR . uniqid() . '.png';
$success = file_put_contents($file, $data);
print $success ? $file : 'Unable to save the file.'; 
```

在 JS 方面（使用 jQuery）：

```
var c  = document.getElementById("yourCanvas");
var png = canvas.toDataURL();
$.post("postimg.php", {img: png}, function() {
    console.log("saved your thing");
}); 
```

去年我写了一篇关于这个的博客文章，但只包括了 PHP 方面：

[http://j-query.blogspot.com/2011/02/save-base64-encoded-canvas-image-to-png.html](http://j-query.blogspot.com/2011/02/save-base64-encoded-canvas-image-to-png.html)

# javascript - Javascript多位索引

> ID：10289774
> 
> 赞同：1
> 
> 时间：2012-04-23T23:35:36.747
> 
> 标签：javascript, indexing

我在网上搜索过，解决方案一定很简单，没有人问过吗？我只是想使用`+ i +`返回 001、002、003 等的索引

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:39:59.063

怎么样

```
('000' + i).substr(-3); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:38:13.217

所以像这样的东西？

```
function number_pad(num,len) {
    num = ""+num;
    while(num.length < len) num = "0"+num;
    return num;
}
// Usage: number_pad(i,3); 
```

或者，扩展本机对象：

```
Number.prototype.pad(len) {
    var num = ""+this;
    while(num.length < len) num = "0"+num;
    return num;
}
// Usage: i.pad(3); 
```

为了将来参考，这称为 zerofill 或 zero-padding。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T23:38:39.783

```
function paddedNumber(n) {
  // A string containing the fully padded zero value.
  var zeroes = "000";
  // The number as a string.
  var numstr = "" + n;
  var nDigits = numstr.length;
  // Keep any sign at the front.
  var sign = "";
  if (/^[\+\-]/.test(numstr)) {
    sign = numstr.charAt(0);
    numstr = numstr.substring(1);
  }
  // Concatenates the number with just enough zeroes.
  // No padding if itoa is already longer than the pad.
  return sign + zeroes.substring(nDigits) + numstr;
} 
```

# .net - Roslyn 中的可扩展格式？

> ID：10289785
> 
> 赞同：7
> 
> 时间：2012-04-23T23:36:49.397
> 
> 标签：.net, code-formatting, roslyn

我发现 Roslyn CTP 中的代码格式非常缺乏。但达斯汀坎贝尔在[他的演讲](http://channel9.msdn.com/Events/Lang-NEXT/Lang-NEXT-2012/Roslyn)中（大约 42:00 分）提到：

> 实际的格式化引擎也是可扩展的。那里有一个规则引擎，因此您可以添加格式规则并根据需要进行自定义操作。

但是在查看实际代码时，我发现只有在`Format(SyntaxNode)`内部使用`internal`类的扩展方法`SyntaxFormatter`。

我的问题是：可扩展性在哪里？它是否存在于 Roslyn CTP 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T02:57:06.747

随着 Roslyn 2012 年 6 月 CTP 的发布，这种可扩展性现在可用。要调用格式化，请查看`Format`Roslyn.Services.dll 中的扩展方法（不要忘记添加`using Roslyn.Services;`.

要公开您自己的格式规则，请尝试实现该`Roslyn.Services.Formatting.IFormattingRule`接口。不幸的是，我们还没有这方面的样本，但请随时就您遇到的任何问题提出问题。

# javascript - 我不明白 JSONP 与 AJAX 有何不同

> ID：10289789
> 
> 赞同：10
> 
> 时间：2012-04-23T23:37:14.370
> 
> 标签：javascript, jsonp

1.  我看不出 JSONP 中的回调函数与 AJAX 中的成功回调函数有何不同。

2.  鉴于＃1，我看不出它从根本上更安全。

3.  那么唯一的区别是与 AJAX 的人工同域约束吗？

4.  为什么 AJAX 不能只允许跨域请求；如果这会导致安全漏洞，那么攻击不只是 XSS 一个 JSONP 请求吗？

困惑，马克斯

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-23T23:50:17.677

ajax 调用是从客户端直接到服务器的实际 HTTP 请求。Ajax 调用可以是同步的（阻塞直到它们完成）或异步的。由于同源安全保护，只能对网页来自的同一服务器进行 ajax 调用，除非目标服务器明确允许使用 CORS 的跨源请求。

JSONP 调用是一个有趣的 hack，带有`<script>`允许跨域通信的标签。在 JSONP 调用中，客户端创建一个脚本标记并在其上放置一个带有`callback=xxxx`查询参数的 URL。该脚本请求（通过脚本标签插入）由浏览器发送到外部服务器。浏览器只是认为它正在请求一些 javascript 代码。然后，服务器为此调用创建一些特殊的 javascript，并且在该 javascript 返回时将由浏览器执行，服务器对在`callback=xxxx`查询参数。通过定义变量或将数据传递给该函数，服务器可以将数据传回给客户端。对于 JSONP，客户端和服务器都必须在 JSONP 调用如何工作以及如何定义数据方面进行合作。客户端无法对不明确支持 JSONP 的服务器进行 JSONP 调用，因为必须由服务器构建正确类型的 JSONP 响应，否则它将无法工作。

因此，这两种通信方法的工作方式完全不同。只有 ajax 调用可以是同步的。根据`<script>`标签插入的性质，JSONP 调用始终是异步的。

在 Ajax 调用中，响应在 ajax 事件处理程序中返回。

在 JSONP 调用中，响应会在返回的 Javascript 调用您的函数时出现。

在某些方面，JSONP 是一个绕过跨域安全机制的安全漏洞。但是，您只能调用明确选择支持类似 JSONP 机制的服务器，因此如果服务器不希望您能够调用它跨域，它可以通过不支持 JSONP 来阻止它。您不能对这些其他服务器进行定期 ajax 调用。

浏览器制造商无法真正关闭这个漏洞，因为如果他们这样做了，无数的网页会破坏已经使用 JSONP 或从其他域加载脚本的网页。例如，Web 上使用 Google 或 Microsoft CDN 之外的 jQuery 的每个页面都会中断，因为不允许浏览器从跨域域下载 javascript。

JSONP 主要是作为一种变通方法而发明的，以便能够发出跨域请求。但是，由于 JSONP 需要明确的服务器支持才能工作，所以这并不是真正的安全问题，因为只能对明确决定允许这种类型的跨源调用的服务器进行 JSONP 调用。JSONP 现在的使用比以前少得多，因为 CORS 被发明为一种更优雅的方式来控制/允许它。CORS 代表[Cross Origin Resource Sharing](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS)，它为目标服务器提供了一种方法，可以准确地告诉 Web 浏览器允许哪些类型的跨源请求，甚至告诉它允许哪些网页域发出此类请求。它具有比 JSONP 更精细的控制功能，并且所有现代浏览器现在都支持 CORS。

这是一个跨域调用如何导致问题的示例。如果您可以从任何其他网页加载任意网页或进行任意 ajax 调用，那么想象您已经在其他浏览器窗口中登录到 Yahoo 上的 webmail 界面。这意味着您的 cookie 设置为允许来自浏览器的请求从雅虎获取数据。如果允许其他网页中的 javascript 向 Yahoo 发出 webmail 请求（这将自动附加您的 cookie），则它可以获取您所有的 webmail 数据并将其发送回它自己的站点。一个网站可以窃取任何其他网站的所有登录数据。所有的网络安全都会被破坏。

但是，按照我们今天的方式，只要 Yahoo 不支持使用相同 Web cookie 的 JSONP 接口，它就不会受到未经授权的 JSONP 请求的影响。

以下是关于跨域 ajax 的危险以及为什么必须防止它的其他一些很好的文章：

[为什么跨域 Ajax 是一个安全问题？](https://stackoverflow.com/questions/466737/why-is-cross-domain-ajax-a-security-concern)

[为什么不允许跨域 AJAX 调用？](https://stackoverflow.com/questions/5383045/why-cross-domain-ajax-call-is-not-allowed)

[为什么跨域 AJAX 请求被标记为“安全风险”？](https://stackoverflow.com/questions/9228150/why-are-cross-domain-ajax-requests-labelled-as-a-security-risk)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T00:05:00.713

JSONP 的回调*不是*实际的回调。相反，JSONP 通过*脚本注入*工作。例如，如果你想进行 JSONP 调用，你可以将这个脚本元素插入到 DOM 中：

```
<script src="http://example.com/ajaxendpoint?jsonp=parseResponse"></script> 
```

服务器的响应将是这样的：

```
parseResponse({"json":"value"}); 
```

它将在窗口的全局范围内进行*评估。*所以本质上 JSONP 就像一个远程`exec()`的，服务器被告知要创建什么字符串来执行。

这与 Ajax*非常不同*：使用 JSONP，响应*在脚本的全局范围内进行评估*；使用 XMLHttpRequest，响应作为字符串接收，而不是评估。（此外，JSONP 只能与 GET 一起使用，而 AJAX 允许任何 http 方法。）

因此，对于您的第二个问题，“我看不出它从根本上如何更安全。” 嗯，你是对的，JSONP 实际上是***非常不安全***的。服务器可以返回*任何它想要的脚本*，并对你的浏览器做*任何它想做的事情！*

跨域请求是不安全的，因为它们可用于将有关当前页面的信息透露给另一个域上的页面。

你是对的，任何 XSS 攻击都可以使用 JSONP。CORS 的目的不是防止 XSS（如果您的页面上运行了不受信任的脚本，那么您无论如何都会被淹没）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T23:53:20.133

根本区别在于，出于某种原因，加载位于其他域（通过 script 标签）的 javascript 文件是完全可以的，但默认情况下加载其他跨域资源是不行的。

我同意你，因为这种划分似乎相当武断。在`jQuery`中，当您执行 JSONP 调用时，实际上是在创建脚本标记、加载资源，然后 jQuery 库通过调用该 JSONP 结果中定义的函数来执行您的脚本。

在我看来，我想不出允许跨域 AJAX 引入的额外攻击向量，通过允许跨域脚本加载，它还没有扩大，这是到处使用的常见做法（googleCDN 的 jQuery，广告脚本，谷歌分析，和无数其他人）。

来自[维基百科](http://en.wikipedia.org/wiki/Same_origin_policy)

`In addition, many legacy cross-domain operations predating JavaScript are not subjected to same-origin checks; one such example is the ability to include scripts across domains, or submit POST forms.`

# javascript - 为什么 HTML 数据被剥离，只剩下纯文本？

> ID：10289791
> 
> 赞同：1
> 
> 时间：2012-04-23T23:37:20.693
> 
> 标签：javascript, html, xml, dom

我正在尝试使用 XSL 转换将转换后的 XML 数据放入 HTML 页面。这是我的 XML：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<?xml-stylesheet type="text/xsl" href="w3.xsl"?>
<catalog>
    <cd>
        <title>Empire Burlesque</title>
        <artist>Bob Dylan</artist>
        <country>USA</country>
        <company>Columbia</company>
        <price>10.90</price>
        <year>1985</year>
    </cd>
    <cd>
        <title>Hide your heart</title>
        <artist>Bonnie Tyler</artist>
        <country>UK</country>
        <company>CBS Records</company>
        <price>9.90</price>
        <year>1988</year>
    </cd>
    <cd>
        <title>Greatest Hits</title>
        <artist>Dolly Parton</artist>
        <country>USA</country>
        <company>RCA</company>
        <price>9.90</price>
        <year>1982</year>
    </cd>
</catalog> 
```

XSL 文件的内容：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output method="html" />
<xsl:template match="/">
  <html>
  <body>
  <h2>My CD Collection</h2>
    <table border="1">
      <tr bgcolor="#9acd32">
        <th>Title</th>
        <th>Artist</th>
      </tr>
      <xsl:for-each select="catalog/cd">
      <tr>
        <td><xsl:value-of select="title"/></td>
        <td><xsl:value-of select="artist"/></td>
      </tr>
      </xsl:for-each>
    </table>
  </body>
  </html>
</xsl:template>
</xsl:stylesheet> 
```

但是转换后的 XML 没有 HTML 属性；它看起来像这样：

![](../Images/be8def11f21ce394d2dd36d5c4876f57.png)

它应该如下所示：

![](../Images/c1180dd9e37d12d8ca0c1e6fd16cc124.png)

这是填充 DOM 的函数，这是问题的原因：

```
//Load the XML document and XSLT document into XML DOM objects
var xml = document.implementation.createDocument("", "", null);
var xslt = document.implementation.createDocument("", "", null);

//Set the async property on both documents to false so that they both completely load 
//before any further processing is attempted.
xml.async = false;
xslt.async = false;

//Load XML and XSLT documents into the XML DOM objects.
xml.load("w3.xml");
xslt.load("w3.xsl");

//Create a new XSLTProcessor object and use its importStylesheet() method to import the XSLT DOM object.
var processor = new XSLTProcessor();
processor.importStylesheet(xslt);

//Transform the XML to a new XML DOM object with the transformToDocument() method of the XSLTProcessor.
var XmlDom = processor.transformToDocument(xml)

//Create a new XMLSerializer and use it to serialize the new XML DOM object to a string.
var s = new XMLSerializer(); 
var output = s.serializeToString(XmlDom.documentElement);

//The result can then be output to the innerHTML property of any element on the page.
var outputDiv = document.getElementById("xmldata");
outputDiv.innerHTML = output; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T07:11:43.297

我认为您的“主机”HTML 页面必须具有将 HTML 标识为 HTML5 的 DOCTYPE。

然后，因为您正在尝试添加属性，例如在 HTML 5 中已过时的*bgcolor （请参阅*[W3C：HTML5 与 HTML4 的区别](http://www.w3.org/TR/html5-diff/)），它们会被忽略，因此不会添加到 DOM 中。

尝试改用样式属性 - 按照链接页面中的建议。

tr 元素的 XSLT 将如下所示：

```
 <xsl:template match="/">
 ...
  <tr style="background-color:#9acd32;"> 
    <th>Title</th> 
    <th>Artist</th> 
  </tr>
 ...
  </xsl:template> 
```

# powershell - Get-ChildItem 刷新/更新

> ID：10289795
> 
> 赞同：1
> 
> 时间：2012-04-23T23:37:47.317
> 
> 标签：powershell

Powershell 很新，希望有人能指出我正确的方向。我试图弄清楚是否有更清洁的方法来完成我下面的内容？一旦我对第一次 Get-ChildItem 调用期间返回的文件（存储在 $items 变量中）进行了一些更改，有没有办法刷新 Get-ChildItem 的内容？

在第一个 foreach 语句中，我为所有返回的文件创建了一个日志签名。一旦完成，我需要做的是；再次获取列表（因为路径中的项目已更改），第二个 Get-ChildItem 将包括在第一次 Get-ChildItem 调用期间找到的文件以及在第一个 foreach 语句调用时生成的所有日志文件生成日志文件功能。所以我的问题是，有没有一种方法可以更新列表而不必调用 get-chilItem 两次，以及使用两个 foreach 语句？

感谢所有的帮助！

--------------这是我根据推荐改代码的--------------

```
$dataStorePath = "C:\Process"

function print-All($file)
{
    Write-Host "PrintALL filename:"  $file.FullName #Only prints when print-All($item) is called 
}

function generate-LogFile($file)
{
    $logName = $file.FullName + ".log"
    $logFilehandle = New-Object System.IO.StreamWriter $logName
    $logFilehandle.Writeline($logName)
    $logFilehandle.Close()
    return $logName
}

$items = Get-ChildItem -Path $dataStorePath

foreach ($item in $items)
{
    $log = generate-LogFile($item) #Contains full path C:\Process\$fileName.log
    print-All($item) 
    print-All($log) #When this goes to the function, nothing prints when using $file.FullName in the print-All function
} 
```

- - - - -输出 - - - - - - -

为了测试，我在 C:\Process 中有两个文件：fileA.txt & fileB.txt

我将创建两个附加文件 fileA.txt.log 和 fileB.txt.log

最终我需要对所有四个文件做点什么。我创建了一个 print-All 函数，我将在其中处理所有四个文件。下面是当前的输出。可以看出，我只得到找到的两个原始文件的输出，而不是另外创建的两个（调用 print-All($log) 时得到空行）。我需要能够使用 Get-ChildItem 提供的完整路径属性，因此使用 FullName

```
PrintALL filename: fileA.txt
PrintALL filename:
PrintALL filename: fileB.txt
PrintALL filename: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:28:59.737

我不完全清楚你在问什么，可以`generate-LogFile`返回创建的日志文件，然后只调用`generateRequestData`你的文件和日志文件？像这样的东西：

```
$items = Get-ChildItem -Path $dataStorePath
foreach ($file in $items)
{
    $logFile = generate-LogFile $file 
    generateRequestData $file
    generateRequestData $logFile
} 
```

**编辑：**

在您添加的示例中，您从`generate-LogFile`. .NET 字符串没有`FullName`属性，因此不会在 .NET 中打印任何内容`print-All`。要获取所需的`FileInfo`对象，请使用`get-item`命令行开关：

```
return Get-Item $logName 
```

此外，在此示例中，您不需要使用 a`StreamWriter`来写入文件，您可以使用本机 powershell`Out-File`命令行开关：

```
function generate-LogFile($file)
{
    $logName = $file.FullName + ".log"
    $logName | Out-File $logName
    return Get-Item $logName
} 
```

# hadoop - 如何直接从映射器输出到 HDFS？

> ID：10289797
> 
> 赞同：4
> 
> 时间：2012-04-23T23:38:04.120
> 
> 标签：hadoop, mapreduce

在某些条件下，我们希望 mapper 完成所有工作并输出到 HDFS，我们不希望将数据传输到 reducer（将使用额外的带宽，如果有错误请纠正我）。

一个伪代码是：

```
def mapper(k,v_list):
  for v in v_list:
    if criteria:
      write to HDFS
    else:
      emit 
```

我发现这很难，因为我们唯一可以玩的是 OutputCollector。我想到的一件事是扩展 OutputCollector，覆盖 OutputCollector.collect 并做这些事情。有没有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:39:22.250

您可以使用 JobConf.setNumReduceTasks(0) 将 reduce 任务的数量设置为 0。这将使映射器的结果直接进入 HDFS。

来自 Map-Reduce 手册：[http ://hadoop.apache.org/docs/current/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html](http://hadoop.apache.org/docs/current/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html)

```
Reducer NONE
It is legal to set the number of reduce-tasks to zero if no reduction is desired.

In this case the outputs of the map-tasks go directly to the FileSystem, 
into the output path set by setOutputPath(Path). The framework does not sort 
the map-outputs before writing them out to the FileSystem. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T03:17:20.063

我假设您正在使用流媒体，在这种情况下，没有标准的方法可以做到这一点。

在 java Mapper 中这当然是可能的。对于流式传输，您需要修改 PipeMapper java 文件，或者像您说的编写自己的输出收集器 - 但如果您遇到这么多麻烦，您可能只需要编写一个 java 映射器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T14:31:37.877

如果您仍要将其写入 HDFS，则不向 Reducer 发送内容实际上可能不会节省带宽。HDFS 仍然被复制到其他节点并且复制将会发生。

不过，从映射器写入输出还有其他充分的理由。有一个关于这个的[常见问题解答](http://wiki.apache.org/hadoop/FAQ#Can_I_write_create.2BAC8-write-to_hdfs_files_directly_from_map.2BAC8-reduce_tasks.3F "常问问题")，但除了说你可以做到之外，它的细节有点短。

[我在这里](https://stackoverflow.com/q/1533330/5074 "这里")发现了另一个可能与您的问题重复的问题。如果您正在用 Java 编写 Mapper，那么该问题的答案会更有帮助。如果您尝试以流式方式执行此操作，则可以在脚本中使用 hadoop fs 命令来执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-19T18:26:29.770

事实上，我们可以将输出写入 HDFS 并同时将其传递给 Reducer。我知道您正在使用 Hadoop Streaming，我已经使用 Java MapReduce 实现了类似的东西。

我们可以使用 MultipleOutputs 从 Mapper 或 Reducer 生成命名输出文件。*因此，在您的 Mapper 实现中，在处理输入数据的所有业务逻辑之后，您可以使用multipleOutputs.write("NamedOutputFileName", Outputkey, OutputValue)*将输出写入 MultipleOutputs并且对于您想要传递给 reducer 的数据，您可以编写使用*context.write(OutputKey, OutputValue)到上下文*

我想如果你能找到一些东西来用你正在使用的语言（例如：Python）将数据从映射器写入一个命名的输出文件——这肯定会奏效。

我希望这有帮助。

# android - 无模式弹出窗口作为键盘

> ID：10289804
> 
> 赞同：0
> 
> 时间：2012-04-23T23:38:55.683
> 
> 标签：android, modal-dialog, modeless

我正在尝试为特定领域的输入模拟软件键盘。我正在使用 PopupWindow 来收集输入并将其传输到底层的 EditText。不幸的是，PopupWindow 是模态的，因此用户不能像使用通常的软件键盘那样从一个 EditText 切换到另一个 EditText。我已经研究过设置`FLAG_NOT_TOUCH_MODAL`标志，但我不确定应该何时或应用什么来获得我正在寻找的行为。

我启动 PopupWindow 的代码如下所示：

```
myEdit.setOnClickListener(new View.OnClickListener() {
   public void onClick(View v) {
      pw = myKeyboard.getPopupWindow((EditText) v);

      pw.showAtLocation(Main.this.findViewById(R.id.main), Gravity.BOTTOM, 0, 0);
   }
}); 
```

我尝试将其更改为以下内容，但这只会导致运行时异常：**java.lang.RuntimeException: view android.widget.LinearLayout@40526268 being added, but it already has a parent**

```
myEdit.setOnClickListener(new View.OnClickListener() {
   public void onClick(View v) {
      pw = myKeyboard.getPopupWindow((EditText) v);

      WindowManager.LayoutParams wlp = getWindow().getAttributes();
      wlp.gravity = Gravity.BOTTOM;
      wlp.flags = wlp.flags | WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL;
      getWindow().addContentView(pw.getContentView(), wlp);

      pw.showAtLocation(Main.this.findViewById(R.id.main), Gravity.BOTTOM, 0, 0);
  }
}); 
```

我也在研究 setOutsideTouchable，但到目前为止我还没有得到任何结果。

关于如何创建无模式 PopupWindow 的任何指示？我愿意使用其他一些无模式的小部件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T03:53:33.743

PopupWindow 对于您想要做的事情似乎有点沉重，并且当您发现您必须与它作斗争才能做您想做的事情时。为什么不将您的键盘实现为 a`View`并将其粘贴在您的布局中，然后隐藏/显示它？

# r - R下的openNLP错误

> ID：10289813
> 
> 赞同：2
> 
> 时间：2012-04-23T23:39:42.933
> 
> 标签：r, text-mining, opennlp

```
library(openNLP)
library(openNLPmodels.es)
sentence="Por lo menos los paquetes modelo de idioma en Inglés y en español, previamente"
tagPOS(sentence, language = "es")
Error in .jcall(tagger, "S", "tag", x) : 
  java.lang.ArrayIndexOutOfBoundsException: 0 
```

对于英语句子，一切正常。这个错误是什么意思，我怎么能骑它？

单个单词的相同错误：

```
tagPOS("menos", language = "openNLPmodels.se")
    Error in .jcall(tagger, "S", "tag", x) : 
      java.lang.ArrayIndexOutOfBoundsException: 0 
```

# vb.net - 如何在 VB.NET 中使用循环？

> ID：10289814
> 
> 赞同：0
> 
> 时间：2012-04-23T23:39:48.517
> 
> 标签：vb.net

编辑：我有一个 ItemList ： Dim ItemList As New List(Of String) 我想将 itemlist 中的每个元素附加到一个新列表中，每次 10 次，然后重新开始。当列表中仍有元素（每个 10 次）时，如何为每个元素创建一个循环？

我试过这个，但它不工作。这对我来说太复杂了，因为我是新手

```
 Private crt As Integer = 0
    Private limit As Integer = 0

    Private Function getline() As String
    Dim line As String = ""
        SyncLock addlines
            Do While limit < 10
                line = ItemList(crt)
                limit += 1
            Loop
            limit = 0
            crt += 1
        End SyncLock

    addlines.AppendText(Environment.NewLine & line & " limit:" & limit & " crt:" & crt)
    'Return line
End Function 
```

谢谢

我也试过这个：

```
 For Each I As Item In Items
   If I = x Then Continue For

   ' Do something
   Next 
```

但我不知道在哪里添加 10 次限制以及当前项目编号（crt）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:50:28.293

尽我所能解决这个问题，您似乎想将 ItemList 中的每一行（无论该对象是什么）附加 10 次。

这应该可以解决问题。

```
Dim limit as integer=10

For each line as string in ItemList
   For lineNum as integer = 1 to limit
      addlines.AppendText(string.format("{0}{1} Limit: {2} CRT:{3}", Environment.NewLine, line, limit, lineNum ))
   Next lineNum 
Next line 
```

**更新：**更新了关于 CRT 是什么的评论中解释的答案。

# postgresql - 我的 Postgres 日志给出了大量这些错误。而且我不确定发生了什么

> ID：10289820
> 
> 赞同：-1
> 
> 时间：2012-04-23T23:40:15.740
> 
> 标签：postgresql, postgresql-8.4

```
2012-04-23 16:35:07 PDTWARNING：在字符 117 处的字符串文字中非标准使用 \\
2012-04-23 16:35:07 PDTHINT：对反斜杠使用转义字符串语法，例如 E'\\'。

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:58:59.443

在最近的 PostgreSQL 中，字符串应该符合标准，这意味着默认情况下没有转义。有一些设置可以控制这一点：

*   `standard_conforming_strings`-- 自 9.1 起默认开启。
*   `escape_string_warning`-- 也默认开启。

这意味着像这样的字符串文字`'a\nb'`被解析为 4 个简单字符。如果您希望使用转义符对其进行解析，则可以使用一种语法`E'a\nb'`将其解析为 3 个预期字符。有关正确解释，请参阅[http://www.postgresql.org/docs/current/interactive/runtime-config-compatible.html](http://www.postgresql.org/docs/current/interactive/runtime-config-compatible.html)。

我怀疑（如果您运行的是 PostgreSQL 9.1 或更高版本），您可能`standard_conforming_strings = off`- 可能让使用转义编写的遗留查询正确运行。但是，该警告仍处于启用状态，因为它警告您正在使用已弃用的语法。

`E`如果您想摆脱警告，正确的解决方案是修复所有查询以使用前缀。当然假设转义是故意的——如果不是，那么设置`standard_conforming_strings = on`是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:46:44.047

您正在使用包含未转义反斜杠的值插入/更新，例如`abc\def`，当您应该像这样对其进行转义时`abc\\def`。

检查/调试您的输入数据以找到问题文本

# ruby-on-rails - 带有正则表达式的非键盘字符的自定义验证器

> ID：10289823
> 
> 赞同：0
> 
> 时间：2012-04-23T23:40:30.633
> 
> 标签：ruby-on-rails, ruby, regex, validation

我想编写自定义验证器，就像我在下面尝试一样

```
ActiveRecord::Base.class_eval do
  def self.validates_characters(*attr_names)
    validates_each(attr_names) do |record, attr_name, value|
      unless value.nil?
        regex = /^[[a-zA-Z\][0-9]\]]\\$@^`,|%;.~()\/{}:?\[=\]\+\-_#!<&\s]*$/
        record.errors.add(attr_name, 'invalid characters') unless regex.match(value)
      end
    end
  end
end 
```

`/^[[a-zA-Z\][0-9]\]]\\$@^`,|%;.~()\/{}:?\[=\]\+\-_#!<&\s]*$/`我在 rubular 中尝试了这个正则表达式 => ，但它有一些错误。

我只想允许这个字符：

```
ABCDEFGHIJKLMNOPQRSTUVWXYZ
1234567890
$@^`,|%;.~()/\{}:?[]=-+_#!<>& and spaces 
```

所以这个字符串无效=>`" © gfdgfd 0543"`

有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:10:55.153

如果你只想匹配这些字符，你可以使用这个：

```
[\$@\^`,\|%;\.~\(\)/\\\{\}:\?=\-\+_#!<>&\sA-Z0-9\[\]]+$ 
```

# c++ - 初始化 shared_ptr 成员变量，新 vs make_shared？

> ID：10289826
> 
> 赞同：11
> 
> 时间：2012-04-23T23:40:48.173
> 
> 标签：c++, c++11, shared-ptr, initializer, make-shared

初始化 shared_ptr 成员变量时：

```
// .h
class Customer
{
public:
  Customer();

private:
  std::shared_ptr<OtherClass> something_;
}

// .cpp
Customer():
  something_(new OtherClass())
{
} 
```

对比

```
Customer():
  something_(std::make_shared<OtherClass>())
{
} 
```

是否允许使用 make_shared 版本？我似乎总是看到第一个版本，哪个是首选？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-23T23:51:52.190

唯一*不允许*`make_shared`的时间是：

 *1.  如果您获得由其他人分配的裸指针并将其存储在`shared_ptr`. 与 C API 交互时通常会出现这种情况。
2.  如果您要调用的构造函数不是公共的（`make_shared`只能调用公共构造函数）。这可能发生在工厂函数中，您希望强制用户从工厂创建对象。

    但是，有一些方法可以解决这个问题。与其拥有私有构造函数，不如拥有一个公共构造函数。但是使构造函数采用只能由具有私有访问权限的类构造的类型。这样，唯一可以`make_shared`使用该对象类型调用的人是对类具有私有访问权限的人。

所以是的，你可以这样做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T10:26:11.767

在这种情况下，`make_shared`不仅允许使用，而且最好使用它。如果您使用 new，它会在某处为您的 Customer 分配内存，然后在其他地方为您的 shared_ptr 分配内存，同时存储强引用和弱引用（用于弱指针和共享指针）。如果您使用 ，`make_shared`您将在内存中只有一个位置，因此只有一个新位置。

我不确定我是否真的很清楚，这是[GotW #89](https://herbsutter.com/2013/05/29/gotw-89-solution-smart-pointers/)的目的，阅读它，那里有很好的解释。*

# c# - 如果 DateTime 字段早于 X 小时，则 Linq

> ID：10289829
> 
> 赞同：7
> 
> 时间：2012-04-23T23:41:07.033
> 
> 标签：c#, linq, linq-to-entities

我已经尝试了以下（显然没有//），但我无法工作，有人可以帮忙吗？

```
 public void CleanBasket()
    {
        //double validHours = 3;
        // var expired = (from a in db.Baskets where (DateTime.Now - a.DateCreated).TotalHours > validHours  select a);
        //var expired = (from a in db.Baskets where (DateTime.Now.Subtract(a.DateCreated).Hours > 3) select a);
        //var expired = (from a in db.Baskets where(a => a.DateCreated > DateTime.Now.AddHours(-1));
        //foreach (Basket basket in expired) db.DeleteObject(expired);
        db.SaveChanges();
    } 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-24T00:18:45.163

在这种情况下，您当然可以在调用 LINQ 之前简单地进行日期时间计算：

```
double validHours = 3;
var latest = DateTime.UtcNow.AddHours(-validHours);
var expired = (from a in db.Baskets where a.DateCreated < latest select a); 
```

对于您需要在数据库中执行且无法以这种方式执行的任何更复杂的 DateTime 操作，您可以使用[SqlFunctions](http://msdn.microsoft.com/en-us/library/system.data.objects.sqlclient.sqlfunctions.aspx)。

顺便说一句，您应该将时间存储在 Utc 而不是本地时间。`DateTime.Now`在夏令时更改期间使用的计算将是错误的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T00:06:35.500

我的猜测是 linq-to-entities 不知道如何使用 DateTime.Now 操作制定查询。为此，我将获取列表中的值，然后仅使用 linq 将它们过滤掉。

```
 public void CleanBasket()
    {
        var cutoff = DateTime.Now.Subtract(new TimeSpan(3, 0, 0));
        var baskets = db.Baskets.Where(a=>a.DateCreated<cutoff);
        db.DeleteObjects(baskets);  // You can combine this with the last line
        db.SaveChanges();
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T00:13:30.943

ORM 很可能无法翻译 TimeSpan 操作，检查这个问题可能会有所帮助：[Comparing dates in query using LINQ](https://stackoverflow.com/questions/10093359/comparing-dates-in-query-using-linq/10093655#10093655)

> 基本上您可以考虑，如果您使用的方法没有对 SQL 的直译，则很可能不支持它。

# php - 如何在 php 和 javascript 中解析 json

> ID：10289834
> 
> 赞同：-3
> 
> 时间：2012-04-23T23:41:45.680
> 
> 标签：php, javascript, json, youtube-api

`http://gdata.youtube.com/feeds/users/LadyGagaVEVO/uploads?alt=json&max-results=10&format=5`

我想从上面的 url 中使用 PHP 和 JavaScript 提取视频缩略图和视频链接，但我不知道该怎么做，这是我迄今为止的尝试：

```
$json = 'http://gdata.youtube.com/feeds/users/LadyGagaVEVO/uploads?alt=json&max-results=10&format=5';
$data = json_decode($json);
print_r($data); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:47:47.583

PHP：[`json_decode()`](http://php.net/json-decode)

JavaScript 几乎完全相同，只是`JSON.parse()`在数据之外没有特殊参数。

没有比文档更好的教程了；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:51:19.597

使用 PHP，就像你正在做的那样，使用 json_decode()。但使用它一个额外的参数

```
$data = json_decode($string, true); // the true in the last will change into associative array 
```

正如 Kolink 所说，对于 JavaScript，使用`JSON.parse()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:59:11.043

在 PHP 中

```
 $tmp = file_get_contents('http://gdata.youtube.com/feeds/users/LadyGagaVEVO/uploads?alt=json&max-results=10&format=5/');
  $data = json_decode($tmp,true); 
```

在带有 jquery 的 javascript 中

```
 $.get("http://gdata.youtube.com/feeds/users/LadyGagaVEVO/uploads?alt=json&max-results=10&format=5/", function(response) { 
       var data = $.parseJSON(response);
  }); 
```

关于非法字符，取决于在您的情况下什么是非法的，只需在遍历对象以查找要查找的缩略图和视频链接时进行一些字符串验证。

# ruby-on-rails - Rails 检查用户 ID 是否在数组中

> ID：10289836
> 
> 赞同：5
> 
> 时间：2012-04-23T23:41:48.850
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我正在尝试根据“用户”是否是“成员”来构建条件。基本上我需要一种方法来检查 current_user.id 是否与任何成员的任何 user_id 匹配。我现在拥有的非工作代码是：

```
<% if current_user = @page.members %>
  you can view this content.
<% end %> 
```

我正在寻找类似以下内容的内容：“如果 current_user.id 存在于任何成员的“user_id”中。”

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-23T23:50:07.823

像这样，根据您问题中的字段名称：

```
<% if @page.members.map(&:user_id).include? current_user.id %>
  You can view this content
<% end %> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-23T23:45:48.927

假设您的`@page.members`变量包含一个数组，您可以使用以下[`include?`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-include-3F)方法：

```
<% if @page.members.include? current_user %>
  you can view this content.
<% end %> 
```

如果您使用的是 id 数组，您当然需要稍微更改测试以查找当前用户的 id：

```
<% if @page.members.include? current_user.id %>
  you can view this content.
<% end %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T23:47:00.367

```
@member_ids = @page.members.map{|m| m.id()} 
```

然后检查以下情况

```
@memeber_ids.include? current_user.id() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T00:06:22.117

之前说过`include?`应该做的事情。

我只是想告诉你一个名为**[CanCan](https://github.com/ryanb/cancan)**的 gem ，它可以让你轻松访问授权“助手”。

为什么你应该使用**CanCan**而不是做你实际在做的事情？

1.  大多数时候不要重新发明轮毂，这是一种愚蠢的做法。
2.  您将业务逻辑放在视图上（不好的做法）。
3.  CanCan 很可能是在考虑安全性以及考虑所有最佳实践的基础上开发的。
4.  您节省了一些开发时间。

对不起，如果我重复了自己。

# css - 一个 div 相对于另一个 div 的动态高度增加

> ID：10289847
> 
> 赞同：1
> 
> 时间：2012-04-23T23:43:37.693
> 
> 标签：css, html

我有两个div。这两个 div 被定位为两个相邻的垂直列。我不想通过 css 预先确定 div 的高度，而是希望它随着我放入其中的内容而动态增长。这对于一个 div 来说足够简单，但我的问题是我希望左侧的 div 背景颜色为绿色，以增长到右侧 div 的相同高度。右边的内容总是比左边的多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:45:39.303

将这些 div 包含在父 div 中，并将它们的高度设置为 100%。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:47:31.953

假设元素在`body`. 100% 给身体，和所有的 div

```
body, #div1, #div2 { height: 100%; } 
```

如果不是，那么您必须再次将父级的高度或链`100%`高度一直固定到主体。

```
#parent { height: 800px; }
#div1,#div2 { height: 100%; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:47:34.510

您只需要一个三列 (X)HTML + CSS 布局。

它在[这里](http://matthewjamestaylor.com/blog/perfect-3-column.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-30T09:36:33.643

1.  让我们插入一个父 div（这两个相邻 div 的容器）
2.  添加一个属性'display：flex;' 到父 div

```
.parent{
  display: flex;
}

.child1, .child2{
  padding: 10px;
  border: 1px solid gray;
}
```

```
<body>
    <div class="parent">
        <div class="child1">
            CHILD 1 AREA<br />
            CHILD 1 AREA
        </div>
         <div class="child2">
             CHILD 2 AREA
        </div>
    </div>
</body>
```

# php - 我如何为 json 字符串回显 php？

> ID：10289849
> 
> 赞同：1
> 
> 时间：2012-04-23T23:43:56.153
> 
> 标签：php

我需要将 $account 回显到 $url 中，以便 url/path 是我从 $account 加上扩展 json 获得的任何内容。我无法用引号弄明白。我试过单引号和双引号，但没有运气。有任何想法吗？

```
<?php 
$account = $_POST['account'];
$url = 'echo $account.json'; //
$content = file_get_contents($url);
$json = json_decode($content, true);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:47:19.840

像这样？

```
<?php 
$account = $_POST['account'];
$url = $account. '.json'; //
$content = file_get_contents($url);
$json = json_decode($content, true);
?> 
```

`.`运算符用于 php 中的字符串连接。这意味着获取的值`$account`并将字符串附加`.json`到末尾，并将其存储在变量中`$url`。其余的代码从那里看起来没问题。还有其他一些方法可以用 php 中的字符串来做到这一点，但我发现这是最简单的一种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:55:16.270

你可以这样做

```
$account = $_POST['account'];
$content = file_get_contents($account.'.json');
$json = json_decode($content, true); 
```

需要我提醒您，您的代码容易被注入吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-23T23:52:43.213

上的文档[`strings`](http://php.net/manual/en/language.types.string.php)详细介绍了如何格式化字符串。您可能还想尝试在变量周围使用大括号 ( `{}`) 来描述标识符的结束位置。

```
$url = "{$account}.json" 
```

# java - JAVA 打印机从 8192 字节增加缓冲区大小

> ID：10289851
> 
> 赞同：1
> 
> 时间：2012-04-23T23:44:07.757
> 
> 标签：java, buffer, printwriter

我正在尝试创建一个文件，该文件映射某些语音标签的每个可能的二进制组合，并且由于某种原因，我编写的 java 程序在 8192 字节后停止。我假设这是最大缓冲区大小还是什么？我该如何改变呢？

我的代码：

```
 try {
        Scanner in = new Scanner(new FileInputStream(file.getPath()));
        PrintWriter out = new PrintWriter(new FileOutputStream("S2.gr"));
        createS2(in, out);
    } catch (Exception e) {
        System.out.println("There was an error trying to open the files: " + e.getMessage());
    }

private static void createS2(Scanner in, PrintWriter out) {
    String[] pos = in.useDelimiter("\\A").next().split("\\n");
    out.println("1\tS2");
    for (String x : pos) {
        out.println("1\tS2\t_" + x);    
    }
    for (String x : pos) {
        String temp = ("1\t_" + x + "\t" + x);
        out.println(temp);
        for (String y : pos) {
            out.println(temp + " _" + y);
        }
    }
    for (String x : pos) {
        System.out.println(x);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T03:28:37.653

尝试这个...

```
 Scanner in = null;
    PrintWriter out = null;
    try {
        in = new Scanner(new FileInputStream(file.getPath()));
        out = new PrintWriter(new FileOutputStream("S2.gr"));
        createS2(in, out);
    } catch (Exception e) {
        System.out.println("There was an error trying to open the files: " + e.getMessage());
    }
    finally {
        if(in != null) in.close();
        if(out != null) out.close();
    } 
```

注意：如果您使用的是 Java 7，则有一个新功能可以使这更容易。例如

```
 try (Scanner in = new Scanner(new FileInputStream(file.getPath()));
          PrintWriter out = new PrintWriter(new FileOutputStream("S2.gr")))
     {
        createS2(in, out);
     } catch (Exception e) {
        System.out.println("There was an error trying to open the files: " + e.getMessage());
     } 
```

注意：我目前没有可用的 JDK 7，因此第二个示例可能不是 100% 正确，但想法是新的语言功能可以为您管理关闭资源。

# asp.net-mvc-4 - 无法从区域中的 asp.NET WebAPI 获取响应

> ID：10289852
> 
> 赞同：1
> 
> 时间：2012-04-23T23:44:08.693
> 
> 标签：asp.net-mvc-4, asp.net-web-api

我正在尝试将 ASP.NET Web API（来自 MVC 4）添加到我的项目中.....但是我在从 Area/WebAPI/Controller 获得任何响应时遇到了一些麻烦（不太确定哪里出错了...)

我安装了路线调试器，如果我转到我的主页...我看到了路线...

```
Matches Current Request Url Defaults    Constraints DataTokens

    False   api/{controller}/{action}/{id}  action = Index, id = UrlParameter.Optional  (empty) Namespaces = OutpostBusinessWeb.Areas.api.*, area = api, UseNamespaceFallback = False
    False   {resource}.axd/{*pathInfo}  (null)  (empty) (null)
    True    {controller}/{action}/{id}  controller = Home, action = Index, id = UrlParameter.Optional   (empty) (empty)
    True    {*catchall} (null)  (null)  (null) 
```

所以似乎路线已设置

接下来我在“api”区域有一个PlansController，它只是“Add New”生成的默认apiController......

```
public class PlansController : ApiController
{
    // GET /api/<controller>
    public IEnumerable<string> Get()
    {
        return new string[] { "value1", "value2" };
    }

    // GET /api/<controller>/5
    public string Get(int id)
    {
        return "value";
    }

    // POST /api/<controller>
    public void Post(string value)
    {
    }

    // PUT /api/<controller>/5
    public void Put(int id, string value)
    {
    }

    // DELETE /api/<controller>/5
    public void Delete(int id)
    {
    }
} 
```

现在当我去`http://localhost:2307/api/Plans/1`

我明白了

```
Server Error in '/' Application.
The resource cannot be found.    
Description: HTTP 404\. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable.  Please review the following URL and make sure that it is spelled correctly. 
    Requested URL: /api/Plans/1 
```

任何想法为什么？有什么我需要配置的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T17:51:27.037

ASP.NET MVC 4 在开箱即用的区​​域不支持 WebApi。

Martin Devillers 提出了一个解决方案：[ASP.NET MVC 4 RC: Getting WebApi and Areas to play nicely](http://blogs.infosupport.com/asp-net-mvc-4-rc-getting-webapi-and-areas-to-play-nicely/)

您还可以在我对类似问题的回复中获得更多详细信息（特别是对于便携式区域的支持）： [ASP.Net WebAPI area support](https://stackoverflow.com/questions/11074117/asp-new-webapi-area-support/11527910#11527910)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T23:48:25.653

将其更改为：

```
 // GET /api/<controller>
    public IEnumerable<string> GetMultiple(int id)
    {
        return new string[] { "value1", "value2" };
    } 
```

调用它：

[http://localhost:2307/api/Plans/GetMultiple/1](http://localhost:2307/api/Plans/GetMultiple/1)

这是我的 Global.asax：

```
 routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{action}/{id}",
            defaults: new { id = RouteParameter.Optional }
        ); 
```

我的控制器：

```
 public class MyApiController : ApiController
   {
      public IQueryable<MyEntityDto> Lookup(string id) {

        ..
   } 
```

我这样称呼它：

```
 http://localhost/MyWebsite/api/MyApi/Lookup/hello 
```

完美运行。

# c++ - 我应该执行什么形式的测试？

> ID：10289857
> 
> 赞同：2
> 
> 时间：2012-04-23T23:45:00.287
> 
> 标签：c++, unit-testing, testing, tdd, automated-tests

我想用 C/C++ 或 Java 编写一个算法（一堆机器学习算法），可能是 Python。语言对我来说并不重要 - 我熟悉以上所有内容。

对我来说重要的是测试。我想使用训练数据训练我的模型。所以我有测试输入，我知道输出应该是什么，并将它与模型的输出进行比较。这是一个什么样的测试？是单元测试吗？我该如何解决这个问题？我可以看到我可以编写一些代码来检查我需要检查的内容，但我想将测试与主代码分开。测试是一个发展良好的领域，我以前见过这样做，但我不知道这种特殊测试的名称和类型，以便我可以阅读它而不会造成混乱。如果您能告诉我这种测试方法叫什么，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-14T11:42:43.633

它的单元测试。控制器经过测试，代码被签入和签出，而不会真正弄乱您的开发代码。此过程也称为测试驱动开发 (TDD)，您的每个开发周期都在进入下一个软件迭代或阶段之前进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:51:32.607

这听起来很像[测试驱动开发 (TDD)](https://stackoverflow.com/questions/2260/what-is-test-driven-development-tdd)，您可以在生产代码之前创建[*单元测试。*](https://stackoverflow.com/questions/652292/what-is-unit-testing-and-how-do-you-do-it)这个网站上有很多关于这两个主题的详细答案。我已经链接到几个相关的问题来帮助您入门。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:54:49.237

如果您的输入/输出位于完整程序的外部接口，那就是黑盒系统测试。如果您要进入程序内部以放大特定功能，例如搜索功能，直接向该功能提供输入并观察其行为，这就是单元测试。这可以在功能级别和/或模块级别完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T00:00:05.537

如果您正在编写机器学习项目，那么测试和培训过程并不是真正的测试驱动开发。你听说过协同进化吗？你的学习系统有一组谜题，它们本身也在不断发展。他们的适应性取决于他们对您的案件的混淆程度。

例如，我想发展一个排序网络。我的学习系统是产生网络的程序。我的协同进化系统生成难以分类的输入。排序网络因产生正确的排序而获得奖励，而协同进化系统因在排序网络中触发了多少失败而获得奖励。

我已经通过基因编程项目做到了这一点，而且效果很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T01:01:34.083

可能是*回测*，这意味着您有一些历史输入并在它们上运行算法以评估算法的性能。您自己使用的术语 -*训练数据*- 更笼统，您可以搜索它以找到一些有用的链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-24T01:05:41.443

你最好的选择是观看测试上帝的测试视频的心理[http://misko.hevery.com/](http://misko.hevery.com/)

Misko 视频链接：

[http://misko.hevery.com/presentations/](http://misko.hevery.com/presentations/)

并阅读此 Google 测试指南[http://misko.hevery.com/code-reviewers-guide/](http://misko.hevery.com/code-reviewers-guide/)

编辑：

任何人都可以编写测试，它们真的很简单，编写测试没有什么魔力，您可以简单地执行以下操作：

```
var sut = new MyObject();
var res = sut.IsValid();
if(res != true)
{
  throw new ApplicationException("message");
} 
```

当然，这就是理论，这些天我们有工具来简化测试，我们可以写这样的东西：

```
new MyObject().IsValid().Should().BeTrue(); 
```

**但是你应该做的是专注于编写可测试的代码，这就是神奇的关键**

只需按照 Misko 的测试视频心理即可开始

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-13T16:39:43.427

虽然这是一个非常古老的帖子，但我的 2 美分 :)

一旦您决定使用哪种算法方法（可以说是您的“评估协议”）并在单一边缘情况下测试了您的算法，您可能会对在多个数据集上运行算法并断言结果在上面的方法感兴趣某个阈值（单独或平均等）

本[教程](https://smarie.github.io/pytest-patterns/examples/data_science_benchmark/)解释了如何在`pytest`框架内进行，这是 python 中最流行的测试框架。它基于一个示例（比较多个数据集上的多项式拟合算法）。

（我是作者，欢迎在github页面提供反馈！）

# java - 在 Java 中，如何绘制两种不同颜色的矩形？

> ID：10289866
> 
> 赞同：1
> 
> 时间：2012-04-23T23:45:47.503
> 
> 标签：java, colors, jcomponent

我找了这个，但在任何地方都找不到。我有一个 RoundedRectangle2D 组件，它代表我在游戏中的健康条，当我调用减法健康方法时，我希望它按比例将矩形的一部分绘制成红色覆盖绿色，使其看起来像健康条失去健康。我以前有两个矩形，一个绿色一个红色一个，一个在另一个后面，但是我被告知我应该改变这个，我同意它会少一点内存使用，所以有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T23:57:48.913

您可以使用 GradientPaint 类。[http://www.roseindia.net/java/example/java/swing/graphics2D/gradient-paint.shtml](http://www.roseindia.net/java/example/java/swing/graphics2D/gradient-paint.shtml)

# java - 在服务器上如何访问 servlet？

> ID：10289868
> 
> 赞同：0
> 
> 时间：2012-04-23T23:45:49.347
> 
> 标签：java, jsp, servlets, web

上传文件时出现很多错误。但是，它们在我的本地主机上完美运行。

我有一个表单，它的动作是一个 servlet。我知道文件的结构迫使我将所有 .class 文件放在目录中`/WEB-INF/classes`。问题是当我将其作为表单操作编写时，`/WEB-INF/classes/myservlet`我收到以下消息：

> ```
> "You don't have permission to access /WEB-INF/classes/myservleton this server". 
> ```

我需要做什么来纠正这个问题？

更新：这是一部分`web.xml`

```
<servlet>
    <servlet-name>addservlet</servlet-name>
    <servlet-class>app.addservlet</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>addservlet</servlet-name>
    <url-pattern>/addservlet</url-pattern>
</servlet-mapping> 
```

这是我提交表单时请求的 URL：

`http://mydomain.com/addservlet`

我得到 Not Found 错误

`The requested URL /addservlet was not found on this server`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T23:55:32.770

您需要将 servlet 映射到 web.xml 文件中...参见[http://static.springsource.com/projects/tc-server/6.0/getstart/rgswebxml.html中的第一个示例](http://static.springsource.com/projects/tc-server/6.0/getstart/rgswebxml.html)

IE

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<web-app xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
    version="2.4">
      <servlet>
        <servlet-name>myservlet</servlet-name>
        <servlet-class>my.package.myservlet</servlet-class> (or what ever package you use)
    </servlet>

    <servlet-mapping>
        <servlet-name>myservlet</servlet-name>
        <url-pattern>/myservlet</url-pattern>
    </servlet-mapping>
</web-app> 
```

然后将操作指向 /myservlet

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:56:33.757

当正确的 url 发送到服务器时，servlet 运行一个 java 类。这是由您必须在 web.xml 中定义的“映射”属性完成的。WEB-INF 下的资源始终受到保护，无法通过 url 访问。

# iphone - XCode4：为什么我可以使用开发人员代码签名身份进行构建，但分发版本是灰色的？

> ID：10289876
> 
> 赞同：1
> 
> 时间：2012-04-23T23:46:33.873
> 
> 标签：iphone

我可以使用开发人员身份构建我的项目，但分发身份是灰色的，我不知道为什么？

我检查了 bundleID 匹配。

看起来很奇怪，一个会起作用，而另一个不起作用。嗯……

任何见解表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:57:09.157

您需要确保您已创建、下载并安装了您的分发供应配置文件（并且还完成了所有其他相关的证书工作）。分发配置文件与开发配置文件不同（因此，如果您没有配置配置文件设置，则无法使用您的分发 ID 进行构建）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T07:48:23.540

我解决了这个问题。这确实是一个命名问题。当我将门户分发配置文件的名称更改为 iPhone 分发时，事情变得更好了。我知道这样做是因为我在一些文档中读到 KeyChain Access 中证书上的名称必须与配置文件的名称匹配。因为，我无法更改证书名称，所以更改门户中的名称就可以了。在 KeyChain Access 中添加的证书是由 XCode 自动完成的。它把它命名为“iPhone Distribution:.”。

# list - 比较 Haskel 中的列表

> ID：10289878
> 
> 赞同：0
> 
> 时间：2012-04-23T23:46:42.330
> 
> 标签：list, haskell, reduce

我必须定义一个名为 zeros 的函数，它接受两个列表的输入并返回一个布尔值，如果数字 0 在每个列表中出现的次数相同，则返回 True，否则返回 false。

这是我作业中的最后一个问题，我已经设法解决了这个问题，让它发挥作用，但我想知道是否有人能找到减少代码量的方法，任何想法都会受到赞赏。到目前为止，我的代码如下：

```
x :: Int
x = 0 
instances::[Int]->Int
instances [] = 0
instances (y:ys)
    | x==y = 1+(instances ys)
    | otherwise = instances ys

zeros :: [Int] -> [Int] -> Bool
zeros [] [] = False
zeros x y
       | ((instances x) == (instances y)) = True
       | otherwise = False 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:26:39.303

无需过多放弃，因为这是家庭作业，这里有一些提示。

你知道列表推导吗？在这种情况下，它们会很有用。例如，您可以将它们与`if`表达式结合起来执行以下操作：

```
*Main> let starS s = [if c == 's' then '*' else ' ' | c <- s]
*Main> starS "schooners"
"*       *" 
```

您甚至可以使用它们进行过滤。例如：

```
*Main> let findFives xs = [x | x <- xs, x == 5]
*Main> findFives [3,7,5,6,3,4,5,7,5,5]
[5,5,5,5] 
```

这些都不是一个完整的答案，但不难看出如何使这些结构适应您的情况。

您还应该考虑一下您是否真的需要一个守卫！例如，这是一个使用与您的风格相同的守卫编写的函数：

```
lensMatch [] [] = True
lensMatch xs ys
             | ((length xs) == (length ys)) = True
             | otherwise = False 
```

这是一个做同样事情的函数！

```
lensMatch' xs ys = length xs == length ys 
```

您可以看到它们是相同的；测试第一个：

```
*Main> lensMatch [1..4] [1..4]
True
*Main> lensMatch [1..4] [1..5]
False
*Main> lensMatch [] [1..5]
False
*Main> lensMatch [] []
True 
```

并测试第二个：

```
*Main> lensMatch' [1..4] [1..4]
True
*Main> lensMatch' [1..4] [1..5]
False
*Main> lensMatch' [] [1..5]
False
*Main> lensMatch' [] []
True 
```

最后，我非常同意 sblom 的上述评论；`zeros [] []`应该是`True`！考虑以下语句：“对于集合 s 中的每个项目 x，x > 0”。如果 set s 为空，则该语句为真！这是真的，因为 s 中根本没有任何项目。在我看来，这就像一个类似的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T01:00:19.367

我不敢相信还没有人建议使用[`foldr`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v%3afoldr)。不是最短或最好的定义，但 IMO 最具教育意义：

```
instances :: Eq a => a -> [a] -> Int
instances n = foldr incrementIfEqual 0
    where incrementIfEqual x subtotal
              | x == n = subtotal + 1
              | otherwise = subtotal

zeros :: Num a => [a] -> [a] -> Bool
zeros xs ys = instances 0 xs == instances 0 ys 
```

虽然对于 的一个非常简短的定义`instances`，我想出的基本上与 Abizern 相同：

```
instances :: Eq a => a -> [a] -> Int
instances x = length . filter (==x) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T23:51:05.133

您是否想过通过过滤每个列表以仅获得零然后比较列表的长度以查看它们是否相等来一次性完成此操作？

```
zeroCompare xs ys = cZeroes xs == cZeroes ys
  where
    cZeroes as = length $ filter (== 0) as 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T08:33:45.600

代替`length`and `filter`，您可以获取 predicate 的结果`p`，将其转换为 0 或 1，然后对结果求和：

```
count p = sum . map (fromEnum.p)

--or

import Data.List
count p = foldl' (\x -> (x+).fromEnum.p) 0 
```

在你的情况下，`p`当然是`(==0)`. 转换`Bool`为`Int`使用`fromEnum`是一个非常有用的技巧。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T08:47:01.407

另一个想法是同时处理两个列表，这有点冗长，但易于理解：

```
zeros xs ys = cmp xs ys == 0 where
  cmp (0:xs) ys = cmp xs ys + 1
  cmp xs (0:ys) = cmp xs ys - 1
  cmp (_:xs) ys = cmp xs ys
  cmp xs (_:ys) = cmp xs ys
  cmp [] []     = 0 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-17T21:33:54.707

我会将问题分解为涉及辅助函数的较小问题。

这就是我将其分解的方式：

1.  比较两个计数的主要功能
2.  计数辅助函数

首先：您需要一种方法来计算列表中零的数量。例如，如果在整数列表中搜索 0 的数量，我将通过执行以下操作来解决此问题：

```
count :: [Int] -> Int
count xs = foldl (\count num -> if num == 0 then (count + 1) else count) 0 xs 
```

第二：您需要一种方法来比较两个列表的计数。本质上，您需要一个函数，该函数将两个列表作为参数，计算每个列表的计数，然后根据结果返回一个布尔值。例如，如果每个列表都是一个 int 列表，对应于我上面的计数示例：

```
 equalZeroes :: [Int] -> [Int] -> Bool
    equalZeroes x y = (count x) == (count y) 
```

您还可以在 equalZeroes 函数内的 where 关键字下定义 count ，如下所示：

```
equalZeroes :: [Int] -> [Int] -> Bool
equalZeroes x y = (count x) == (count y)
    where
        count :: [Int] -> Int
        count xs = foldl (\count num -> if num == 0 then (count + 1) else count) 0 xs 
```

运行此代码时，调用该函数将返回所需的布尔值：

```
equalZeroes [0,1,4,5,6] [1,4,5,0,0]
-> False

 equalZeroes [0,1,4,5,6] [1,4,5,0]
 -> True 
```

# objective-c - 如何纯粹用 C 编写 iOS 应用程序

> ID：10289890
> 
> 赞同：370
> 
> 时间：2012-04-23T23:48:25.200
> 
> 标签：objective-c, ios, c, cocoa-touch, objective-c-runtime

我在这里阅读了[在 Objective-C 之前学习 C？](https://stackoverflow.com/questions/180549/learn-c-first-before-learning-objective-c)

> 通常我然后用纯C代码替换一些Obj-C代码（毕竟你可以随意混合它们，一个Obj-C方法的内容可以完全是纯C代码）

这是真的？

是否可以纯粹用 C 编程语言构建 iPhone 应用程序？

* * *

## 回答 #1

> 赞同：797
> 
> 时间：2012-04-24T00:37:21.597

该死的，我花了一段时间，但我明白了：

**主.c：**

```
#include <CoreFoundation/CoreFoundation.h>

#include <objc/runtime.h>
#include <objc/message.h>

// This is a hack. Because we are writing in C, we cannot out and include 
// <UIKit/UIKit.h>, as that uses Objective-C constructs.
// however, neither can we give the full function declaration, like this:
// int UIApplicationMain (int argc, char *argv[], NSString *principalClassName, NSString *delegateClassName);
// So, we rely on the fact that for both the i386 & ARM architectures, 
// the registers for parameters passed in remain the same whether or not 
// you are using VA_ARGS. This is actually the basis of the objective-c 
// runtime (objc_msgSend), so we are probably fine here,  this would be
// the last thing I would expect to break.
extern int UIApplicationMain(int, ...);

// Entry point of the application. If you don't know what this is by now, 
// then you probably shouldn't be reading the rest of this post.
int main(int argc, char *argv[])
{
    // Create an @autoreleasepool, using the old-stye API. 
    // Note that while NSAutoreleasePool IS deprecated, it still exists 
    // in the APIs for a reason, and we leverage that here. In a perfect 
    // world we wouldn't have to worry about this, but, remember, this is C.
    id autoreleasePool = objc_msgSend(objc_msgSend(objc_getClass("NSAutoreleasePool"), sel_registerName("alloc")), sel_registerName("init"));

    // Notice the use of CFSTR here. We cannot use an objective-c string 
    // literal @"someStr", as that would be using objective-c, obviously.
    UIApplicationMain(argc, argv, nil, CFSTR("AppDelegate"));

    objc_msgSend(autoreleasePool, sel_registerName("drain"));
} 
```

**AppDelegate.c：**

```
#import <objc/runtime.h>
#import <objc/message.h>

// This is equivalent to creating a @class with one public variable named 'window'.
struct AppDel
{
    Class isa;

    id window;
};

// This is a strong reference to the class of the AppDelegate 
// (same as [AppDelegate class])
Class AppDelClass;

// this is the entry point of the application, same as -application:didFinishLaunchingWithOptions:
// note the fact that we use `void *` for the 'application' and 'options' fields, as we need no reference to them for this to work. A generic id would suffice here as well.
BOOL AppDel_didFinishLaunching(struct AppDel *self, SEL _cmd, void *application, void *options)
{
    // we +alloc and -initWithFrame: our window here, so that we can have it show on screen (eventually).
    // this entire method is the objc-runtime based version of the standard View-Based application's launch code, so nothing here really should surprise you.
    // one thing important to note, though is that we use `sel_getUid()` instead of @selector().
    // this is because @selector is an objc language construct, and the application would not have been created in C if I used @selector.
    self->window = objc_msgSend(objc_getClass("UIWindow"), sel_getUid("alloc"));
    self->window = objc_msgSend(self->window, sel_getUid("initWithFrame:"), (struct CGRect) { 0, 0, 320, 480 });

    // here, we are creating our view controller, and our view. note the use of objc_getClass, because we cannot reference UIViewController directly in C.
    id viewController = objc_msgSend(objc_msgSend(objc_getClass("UIViewController"), sel_getUid("alloc")), sel_getUid("init"));

    // creating our custom view class, there really isn't too much 
    // to say here other than we are hard-coding the screen's bounds, 
    // because returning a struct from a `objc_msgSend()` (via 
    // [[UIScreen mainScreen] bounds]) requires a different function call
    // and is finicky at best.
    id view = objc_msgSend(objc_msgSend(objc_getClass("View"), sel_getUid("alloc")), sel_getUid("initWithFrame:"), (struct CGRect) { 0, 0, 320, 480 });

    // here we simply add the view to the view controller, and add the viewController to the window.
    objc_msgSend(objc_msgSend(viewController, sel_getUid("view")), sel_getUid("addSubview:"), view);
    objc_msgSend(self->window, sel_getUid("setRootViewController:"), viewController);

    // finally, we display the window on-screen.
    objc_msgSend(self->window, sel_getUid("makeKeyAndVisible"));

    return YES;
}

// note the use of the gcc attribute extension (constructor). 
// Basically, this lets us run arbitrary code before program startup,
// for more information read here: http://stackoverflow.com/questions/2053029
__attribute__((constructor))
static void initAppDel()
{
    // This is objc-runtime gibberish at best. We are creating a class with the 
    // name "AppDelegate" that is a subclass of "UIResponder". Note we do not need
    // to register for the UIApplicationDelegate protocol, that really is simply for 
    // Xcode's autocomplete, we just need to implement the method and we are golden.
    AppDelClass = objc_allocateClassPair(objc_getClass("UIResponder"), "AppDelegate", 0);

    // Here, we tell the objc runtime that we have a variable named "window" of type 'id'
    class_addIvar(AppDelClass, "window", sizeof(id), 0, "@");

    // We tell the objc-runtime that we have an implementation for the method
    // -application:didFinishLaunchingWithOptions:, and link that to our custom 
    // function defined above. Notice the final parameter. This tells the runtime
    // the types of arguments received by the function.
    class_addMethod(AppDelClass, sel_getUid("application:didFinishLaunchingWithOptions:"), (IMP) AppDel_didFinishLaunching, "i@:@@");

    // Finally we tell the runtime that we have finished describing the class and 
    // we can let the rest of the application use it.
    objc_registerClassPair(AppDelClass);
} 
```

**查看.c**

```
#include <objc/runtime.h>

// This is a strong reference to the class of our custom view,
// In case we need it in the future.
Class ViewClass;

// This is a simple -drawRect implementation for our class. We could have 
// used a UILabel  or something of that sort instead, but I felt that this 
// stuck with the C-based mentality of the application.
void View_drawRect(id self, SEL _cmd, struct CGRect rect)
{
    // We are simply getting the graphics context of the current view, 
    // so we can draw to it
    CGContextRef context = UIGraphicsGetCurrentContext();

    // Then we set it's fill color to white so that we clear the background.
    // Note the cast to (CGFloat []). Otherwise, this would give a warning
    //  saying "invalid cast from type 'int' to 'CGFloat *', or 
    // 'extra elements in initializer'. Also note the assumption of RGBA.
    // If this wasn't a demo application, I would strongly recommend against this,
    // but for the most part you can be pretty sure that this is a safe move 
    // in an iOS application.
    CGContextSetFillColor(context, (CGFloat []){ 1, 1, 1, 1 });

    // here, we simply add and draw the rect to the screen
    CGContextAddRect(context, (struct CGRect) { 0, 0, 320, 480 });
    CGContextFillPath(context);

    // and we now set the drawing color to red, then add another rectangle
    // and draw to the screen
    CGContextSetFillColor(context, (CGFloat []) { 1, 0, 0, 1 });
    CGContextAddRect(context, (struct CGRect) { 10, 10, 20, 20 });
    CGContextFillPath(context);
}

// Once again we use the (constructor) attribute. generally speaking, 
// having many of these is a very bad idea, but in a small application 
// like this, it really shouldn't be that big of an issue.
__attribute__((constructor))
static void initView()
{
    // Once again, just like the app delegate, we tell the runtime to 
    // create a new class, this time a subclass of 'UIView' and named 'View'.
    ViewClass = objc_allocateClassPair(objc_getClass("UIView"), "View", 0);

    // and again, we tell the runtime to add a function called -drawRect: 
    // to our custom view. Note that there is an error in the type-specification
    // of this method, as I do not know the @encode sequence of 'CGRect' off 
    // of the top of my head. As a result, there is a chance that the rect 
    // parameter of the method may not get passed properly.
    class_addMethod(ViewClass, sel_getUid("drawRect:"), (IMP) View_drawRect, "v@:");

    // And again, we tell the runtime that this class is now valid to be used. 
    // At this point, the application should run and display the screenshot shown below.
    objc_registerClassPair(ViewClass);    
} 
```

这很丑陋，但它有效。

如果你想下载这个，~~你可以从我的保管箱[里得到它](http://dl.dropbox.com/u/25258177/personal/CBasediOSApp.zip)~~

您可以从我的 GitHub 存储库中获取[它](https://github.com/richardjrossiii/CBasediOSApp)：

![截屏](../Images/0589f6e49364dc91f9343deb05ebb21a.png)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-04-23T23:51:03.127

Objective-C 是 C 语言的超集，因此理论上可以完全用 C 编写程序，但是，除非您完全精通，否则您`OpenGL ES`至少需要做***一些***objC（~~即使 Rich 的示例也有const NSString*~~），否则您必须自己编写视图。

OK，以上完全错误。让我说，我很惊讶 Rich 实现了这个崇高的目标，所以我把它移植到了 mac（来源[在这里](https://github.com/CodaFi/C-Macs)）。下面的文件没有标题，没有链接到 Cocoa，项目也没有 nib：

**AppDelegate.m**

```
#include <objc/runtime.h>
#include <objc/message.h>

extern id NSApp;

struct AppDel
{
    Class isa;

    //Will be an NSWindow later, for now, it's id, because we cannot use pointers to ObjC classes
    id window;
};

// This is a strong reference to the class of the AppDelegate
// (same as [AppDelegate class])
Class AppDelClass;

BOOL AppDel_didFinishLaunching(struct AppDel *self, SEL _cmd, id notification) {
    //alloc NSWindow
    self->window = objc_msgSend(objc_getClass("NSWindow"),
                                sel_getUid("alloc"));
    //init NSWindow
    //Adjust frame.  Window would be about 50*50 px without this
    //specify window type.  We want a resizeable window that we can close.
    //use retained backing because this thing is small anyhow
    //return no because this is the main window, and should be shown immediately
    self->window = objc_msgSend(self->window,
                                sel_getUid("initWithContentRect:styleMask:backing:defer:"),(NSRect){0,0,1024,460}, (NSTitledWindowMask|NSClosableWindowMask|NSResizableWindowMask|NSMiniaturizableWindowMask),NSBackingStoreRetained,NO);

    //send alloc and init to our view class.  Love the nested objc_msgSends!
    id view = objc_msgSend(objc_msgSend(objc_getClass("View"), sel_getUid("alloc")), sel_getUid("initWithFrame:"), (struct CGRect) { 0, 0, 320, 480 });

    // here we simply add the view to the window.
    objc_msgSend(self->window, sel_getUid("setContentView:"), view);
    objc_msgSend(self->window, sel_getUid("becomeFirstResponder"));

    //makeKeyOrderFront: NSWindow to show in bottom left corner of the screen
    objc_msgSend(self->window,
                 sel_getUid("makeKeyAndOrderFront:"),
                 self);
    return YES;
}

static void initAppDel()
{
    //Our appDelegate should be NSObject, but if you want to go the hard route, make this a class pair of NSApplication and try initing those awful delegate methods!
    AppDelClass = objc_allocateClassPair((Class)
                                         objc_getClass("NSObject"), "AppDelegate", 0);
    //Change the implementation of applicationDidFinishLaunching: so we don't have to use ObjC when this is called by the system.
    class_addMethod(AppDelClass,
                    sel_getUid("applicationDidFinishLaunching:"),
                    (IMP) AppDel_didFinishLaunching, "i@:@");

    objc_registerClassPair(AppDelClass);
}

void init_app(void)
{
    objc_msgSend(
                 objc_getClass("NSApplication"),
                 sel_getUid("sharedApplication"));

    if (NSApp == NULL)
    {
        fprintf(stderr,"Failed to initialized NSApplication...  terminating...\n");
        return;
    }

    id appDelObj = objc_msgSend(
                                objc_getClass("AppDelegate"),
                                sel_getUid("alloc"));
    appDelObj = objc_msgSend(appDelObj, sel_getUid("init"));

    objc_msgSend(NSApp, sel_getUid("setDelegate:"), appDelObj);
    objc_msgSend(NSApp, sel_getUid("run"));
}

//there doesn't need to be a main.m because of this little beauty here.
int main(int argc, char** argv)
{
    //Initialize a valid app delegate object just like [NSApplication sharedApplication];
    initAppDel();
    //Initialize the run loop, just like [NSApp run];  this function NEVER returns until the app closes successfully.
    init_app();
    //We should close acceptably.
    return EXIT_SUCCESS;
} 
```

**查看.m**

```
#include <objc/runtime.h>
#include <objc/message.h>
#include <ApplicationServices/ApplicationServices.h>

// This is a strong reference to the class of our custom view,
// In case we need it in the future.
Class ViewClass;

// This is a simple -drawRect implementation for our class. We could have
// used a UILabel  or something of that sort instead, but I felt that this
// stuck with the C-based mentality of the application.
void View_drawRect(id self, SEL _cmd, CGRect rect)
{
    //make a red NSColor object with its convenience method
    id red  = objc_msgSend(objc_getClass("NSColor"), sel_getUid("redColor"));

    // fill target rect with red, because this is it!
    NSRect rect1 = NSMakeRect ( 21,21,210,210 );
    objc_msgSend(red, sel_getUid("set"));
    NSRectFill ( rect1 );
}

// Once again we use the (constructor) attribute. generally speaking,
// having many of these is a very bad idea, but in a small application
// like this, it really shouldn't be that big of an issue.
__attribute__((constructor))
static void initView()
{

    // Once again, just like the app delegate, we tell the runtime to
    // create a new class, this time a subclass of 'UIView' and named 'View'.
    ViewClass = objc_allocateClassPair((Class) objc_getClass("NSView"), "View", 0);

    // and again, we tell the runtime to add a function called -drawRect:
    // to our custom view. Note that there is an error in the type-specification
    // of this method, as I do not know the @encode sequence of 'CGRect' off
    // of the top of my head. As a result, there is a chance that the rect
    // parameter of the method may not get passed properly.
    class_addMethod(ViewClass, sel_getUid("drawRect:"), (IMP) View_drawRect, "v@:");

    // And again, we tell the runtime that this class is now valid to be used.
    // At this point, the application should run and display the screenshot shown below.
    objc_registerClassPair(ViewClass);
} 
```

**前缀.pch**

```
//
// Prefix header for all source files of the 'CBasedMacApp' target in the 'CBasedMacApp' project
//

#ifdef __OBJC__
#import <Foundation/Foundation.h>
#import <AppKit/AppKit.h>
#endif 
```

![在此处输入图像描述](../Images/fb84d2641c808f3e8353a0889ae1890b.png)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-04-24T20:55:14.257

> 我在这里阅读了[在 Objective-C 之前学习 C？](https://stackoverflow.com/questions/180549/learn-c-first-before-learning-objective-c)
> 
> > 通常我然后用纯C代码替换一些Obj-C代码（毕竟你可以随意混合它们，一个Obj-C方法的内容可以完全是纯C代码）
> 
> 这是真的？
> 
> 我可以纯粹用 C 编程语言构建一个 iPhone 应用程序吗？

引用的段落是正确的，但您的问题的答案是否定的。

为了说明另一个问题的回答者 Mecki 在谈论什么：

```
- (void) drawRect:(CGRect)dirtyRect { //Objective-C

    CGContextRef context = UIGraphicsGetCurrentContext();  //C
    CGContextSetRGBFillColor(context, 1.0, 0.0, 0.0, 1.0); //C
    CGContextFillRect(context, dirtyRect);                 //C

} //Objective-C (balances above “- (void) drawRect:…” line) 
```

*此方法中*只有纯 C 代码，但方法本身是 Objective-C 代码，包含此方法的类也是如此。

所以可以按照 Mecki 所说的去做，但是你不能（实际上——正如 Richard J. Ross III 所展示的那样，在技术上是可行的，但需要大量的打字）用纯 C 语言编写一个完整的 Cocoa Touch 程序。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2013-11-19T15:13:41.850

实际上，这里发布的一些代码虽然是用 C 编写的，但仍然调用了 Objective-C 代码:)。当他问到时，我不知道这是否真的符合原始海报中的场景

> 是否可以纯粹用 C 编程语言构建 iPhone 应用程序？

但我同意人们的说法，一般来说，对于带有 GUI 的应用程序，您需要在 OpenGL（即 C）中编写您的 GUI。

我认为这就是大多数游戏所做的，对吧？虽然我不确定是否可以使用 C 语言访问 iPhone 的 I/O（例如触摸屏）。

最后但并非最不重要的一点是，那些在岩石之上编写代码的人！:)

# sql - 将 Select 语句返回为格式化的 HTML

> ID：10289896
> 
> 赞同：-1
> 
> 时间：2012-04-23T23:48:52.523
> 
> 标签：sql, sql-server, sql-server-2008

我有一个看起来像这样的数据集：

```
 Gender | Age | Name
    Male  | 30  | Bill
  Female  | 27  | Jenny
  Female  | 27  | Debby 
   Male   | 44  | Frank 
```

我正在尝试将其显示为特殊格式的 HTML 代码：

```
 <ul>
      <li>Male
        <ul>
          <li>30
            <ul>
              <li>Bill</li>
            </ul>
          </li>
          <li>44
            <ul>
              <li>Frank</li>
            </ul>
          </li>
        </ul>  
      </li>
    </ul>

    <ul>
      <li>Female
        <ul>
          <li>27
            <ul>
              <li>Jenny</li>
              <li>Debby</li>
            </ul>
          </li>
        </ul>  
      </li>
    </ul> 
```

我尝试使用`FOR XML`，但这并没有给出我想要的结果。它没有删除返回的多个`Gender`和`Age`字段。正如您在此 HTML 中看到的那样，它将所有内容组合在一起，并且仅在结束节点处给出重复项。

在 SQL Server 中如何实现这样的功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T01:04:37.230

这是手动制定 HTML 的一种非常丑陋的方式。这不属于 SQL Server 是有充分理由的。我确信一些 XML 专家会出现并用一种更直接的方法让我感到尴尬（我使用过[Simon Sabin 的解决方案](http://sqlblogcasts.com/blogs/simons/archive/2008/10/26/Creating-an-HTML-table-from-SQL.aspx)，但无法将其转换为您的要求），但现在：

```
DECLARE @x TABLE(Gender VARCHAR(6), Age INT, Name VARCHAR(32));

INSERT @x VALUES  ('Male',   30, 'Bill'),  ('Female', 27, 'Jenny'),
                  ('Female', 27, 'Debby'), ('Male',   44, 'Frank');

DECLARE @html NVARCHAR(MAX) = N'';

;WITH x AS ( SELECT x.Age, x.Gender, x.Name,
    dr = DENSE_RANK() OVER (PARTITION BY x.Gender ORDER BY x.Age),
    gn = ROW_NUMBER() OVER (PARTITION BY x.Gender ORDER BY x.Age),
    rn = ROW_NUMBER() OVER (ORDER BY x.Gender DESC, x.Age)
  FROM @x AS x ) SELECT @html +=
    CHAR(13) + CHAR(10) + CASE WHEN c1.gn = 1 THEN 
        CASE WHEN c1.rn > 1 THEN '</li></ul></li></ul>' ELSE '' END + '<ul><li>' 
        + c1.Gender ELSE '' END + CHAR(13) + CHAR(10) + CHAR(9) 
        + CASE WHEN c1.gn = 1 OR c1.Age <> c3.Age THEN 
        CASE WHEN c1.gn > 1 THEN '</li>' ELSE '<ul>' END + '<li>' 
        + CONVERT(VARCHAR(32), c1.Age) ELSE '' END + CHAR(13) + CHAR(10) + CHAR(9) 
        + CHAR(9) + CASE WHEN (c1.gn = 1 OR c1.Age <> c3.Age) THEN '<ul>' ELSE '' END 
        + '<li>' + c1.Name + '</li>' + CASE WHEN c1.Age <> c2.Age OR c1.dr <> c2.dr 
        THEN '</ul>' ELSE '' END
FROM x AS c1 
LEFT OUTER JOIN x AS c2
ON c1.rn = c2.rn - 1
LEFT OUTER JOIN x AS c3
ON c1.rn = c3.rn + 1
ORDER BY c1.Gender DESC, c1.Age;

SELECT @html += '</ul></li></ul></li></ul>';

PRINT @html; -- note you will need to deal with this 
             -- in another way if the string is large 
```

结果 - 不是您在空白方面所要求的，而是相同的 HTML 渲染：

```
<ul><li>Male
    <ul><li>30
        <ul><li>Bill</li></ul>

    </li><li>44
        <ul><li>Frank</li></ul>
</li></ul></li></ul><ul><li>Female
    <ul><li>27
        <ul><li>Jenny</li>

        <li>Debby</li></ul></li></ul></li></ul> 
```

**编辑**对于更清洁的解决方案，以及大量的戏剧性和很好的演示为什么@ZeeTee 是 StackOverflow 上最烦人的用户，请参阅 Mikael 对后续问题的解决方案：

[将 Select 语句返回为格式化的 HTML (SQL 2005)](https://stackoverflow.com/questions/10300764/return-select-statement-as-formatted-html-sql-2005/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T06:34:11.440

**注意：**我已替换`for $g in ("Male", "Female")`为`for $g in distinct-values(//root /row/@Gender)` .

**注意：2**我已经删除了每个性别的重复年龄（[此处](https://data.stackexchange.com/stackoverflow/query/edit/67653)演示）。

此外，这可以使用 XQuery 来完成：

```
DECLARE @x XML = 
(
    SELECT  *
    FROM    @Test t
    FOR XML RAW, ROOT
);
SELECT @x AS [Source];
SELECT @x.query('
    for $g in distinct-values(//root/row/@Gender) (: or for $g in ("Male", "Female") :)
    return
    <ul>
        <li>
            {data($g)}
            <ul>
            {
                for $a in distinct-values(//root/row[@Gender=$g]/@Age)
                return <li>{data($a)}
                <ul>
                {
                    for $n in //root/row
                    where $n/@Gender=$g and $n/@Age = $a
                        return <li>{data($n/@Name)}</li>
                }</ul></li>
            }
            </ul> 
        </li>
    </ul>
') AS Result; 
```

结果：

```
Source
----------------------------------------------------
<root>
  <row Gender="Male" Age="30" Name="Bill" />
  <row Gender="Female" Age="27" Name="Jenny" />
  <row Gender="Female" Age="27" Name="Debby" />
  <row Gender="Male" Age="44" Name="Frank" />
</root>

Result
----------------------------------------------------
<ul><li>Female<ul><li>27<ul><li>Jenny</li><li>Debby</li></ul></li></ul></li></ul>
<ul><li>Male<ul><li>30<ul><li>Bill</li></ul></li><li>44<ul><li>Frank</li></ul></li></ul></li></ul> 
```

# clojure - 如何根据一系列值创建 Incanter 系列

> ID：10289897
> 
> 赞同：1
> 
> 时间：2012-04-23T23:48:55.583
> 
> 标签：clojure, incanter

我有一个包含 3 列的 Incanter 数据集：日期/时间戳、响应时间和消息大小。我想做的是创建一个散点图，其中 x 轴上的日期/时间戳和 y 轴上的响应时间。

这很容易，但我想根据消息大小列生成单独的一系列数据。Incanter 的`scatter-plot`函数有一个`:group-by`选项，但它似乎只处理离散值。我希望通过对消息大小列应用一些函数来生成系列。一些功能如：

```
(fn [n]
  (cond
    (< n 5000)                    "small"
    (and (>= n 5000) (< n 20000)) "medium"
    (>= n 20000)                  "large")) 
```

这是可能的还是有更好的方法来完成同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:45:20.627

您可以使用您的函数计算出的离散值来合成具有新列的数据集，就像这样......

```
(def dataset1 (dataset 
               [:x :y] 
               (for [x (range 10) y (range 10)] [x y])))
;=> #'user/dataset1

dataset1
[:x :y]
[0 0]
[0 1]
...
[9 8]
[9 9]

(def dataset2 (with-data dataset1 
  (conj-cols $data 
     (dataset [:size] ($map #(cond
                              (< % 3)   "small"
                              (<= 3 % 6) "medium"
                              (< 6 %)   "large") :x)))))
;=> #'user/dataset2

dataset2
[:x :y :size]
[0 0 "small"]
[0 1 "small"]
...
[9 8 "large"]
[9 9 "large"] 
```

添加然后`:group-by`在您生成的离散值上使用...

```
(with-data dataset2 
   (view 
      (scatter-plot 
       :x 
       :y 
       :group-by :size ))) 
```

给出这样的东西：

![咒语情节](../Images/a6af33674516fa60f4d09d8de5e6a4ae.png)

从两列生成分组依据的变体：

```
 (def dataset3 
  (with-data dataset1  
    (conj-cols 
      $data 
      (dataset [:size] ($map #(let [sum (+ % %2)] 
                               (cond
                                 (< sum 4 )    "small"
                                 (<= 4 sum 12) "medium"
                                 (> 12 sum )   "large")) [:x :y]))))) 
```

像这样的情节：

![和图](../Images/06845229fee3160a9b800a9b045cf21c.png)

# iphone - 使用 NSString drawInRect 绘制旋转文本

> ID：10289898
> 
> 赞同：19
> 
> 时间：2012-04-23T23:49:00.523
> 
> 标签：iphone, quartz-graphics

我找到了关于如何使用 NSString drawInRect 绘制旋转文本的答案：，但我不确定它是如何工作的，因为它只对我有用：[https ://discussions.apple.com/thread/1779814?start=0&tstart =0](https://discussions.apple.com/thread/1779814?start=0&tstart=0)

我的代码如下所示：

```
 CGContextSaveGState(context);
           CGContextDrawLinearGradient(context, gradient, CGPointMake(0, centY - halfWidth), CGPointMake(0, centY + halfWidth), 0);

            // Add text                
            CGContextSetFillColorWithColor(context, [UIColor whiteColor].CGColor); 
            NSString *str = @"some test string";

            CGAffineTransform transform1 = CGAffineTransformMakeRotation(M_PI/4);

            CGContextConcatCTM(context, transform1);
            CGContextTranslateCTM(context, 0, 0);
            UIFont *font = [UIFont systemFontOfSize:16.0];

            [str drawInRect:CGRectMake(0, 0, 200, 100) withFont:font lineBreakMode:UILineBreakModeWordWrap alignment:UIBaselineAdjustmentNone]; 
```

因此，当我使用它时，我看到在 x 轴下方 45 度处绘制文本。我想沿着我的线性渐变垂直绘制文本。所以我想我可以通过使用 M_PI/2 90 度来做到这一点。我没有看到我的文字。我尝试了不同的旋转变换，只有一些看起来像 M_PI/4 和 M_PI/8。我认为如果我使用 -M_PI/4 它将使文本在 x 轴上方 45 度，而 M_PI/2 将在 x 轴下方 90 度。但两者都一无所获。

有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-29T18:10:12.650

我用下一个方法解决这个问题。

1) 在 NSString 上声明类别

```
@interface NSString (NMSchemeItemDraw)
-(void)  drawWithBasePoint:(CGPoint)basePoint
                    andAngle:(CGFloat)angle
                     andFont:(UIFont*)font;
@end 
```

此类别将使用给定的中心点、一行和给定的字体和角度绘制文本。

2）这个类的实现是这样的：

```
@implementation NSString (NMSchemeItemDraw)

    -(void)  drawWithBasePoint:(CGPoint)basePoint
                     andAngle:(CGFloat)angle
                      andFont:(UIFont *)font{
    CGSize  textSize    =   [self   sizeWithFont:font];

    CGContextRef    context =   UIGraphicsGetCurrentContext();
    CGAffineTransform   t   =   CGAffineTransformMakeTranslation(basePoint.x, basePoint.y);
    CGAffineTransform   r   =   CGAffineTransformMakeRotation(angle);

    CGContextConcatCTM(context, t);
    CGContextConcatCTM(context, r);

    [self   drawAtPoint:CGPointMake(-1 * textSize.width / 2, -1 * textSize.height / 2)
               withFont:font];

    CGContextConcatCTM(context, CGAffineTransformInvert(r));
    CGContextConcatCTM(context, CGAffineTransformInvert(t));
    }
@end 
```

3）现在我可以在我的`[UIView drawRect:]`方法中使用它。例如，在下一个方式：

```
 -(void)drawRect:(CGRect)rect{
 NSString* example = @"Title";
 [example drawWithBasePoint:CGPointMake(0.0f, 0.0f)
                   andAngle:M_PI
                    andFont:[UIFont boldSystemFontOfSize:16.0]];
 } 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-24T07:18:54.883

我认为正在发生的事情是您将文本旋转到视图之外的位置，因为它通过旋转原点来旋转上下文。

旋转后，您需要进行翻译以将上下文移回视图中。在下面的示例中，我将上下文逆时针旋转 90 度。然后我将上下文的 tx 转换为高度的距离。

```
- (void)drawRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext(); 

    CGContextSaveGState(context);

    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

    // Create the gradient 
    CGColorRef startColor = [UIColor colorWithRed:1.0 green:1.0 blue:1.0 alpha:1.0].CGColor; 
    CGColorRef endColor = [UIColor colorWithRed:200.0/255.0 green:200.0/255.0 blue:200.0/255.0 alpha:1.0].CGColor;
    NSArray *colors = [NSArray arrayWithObjects:(id)startColor, (id)endColor, nil];
    CGFloat locations[] = { 0.0, 1.0 };
    CGGradientRef gradient = CGGradientCreateWithColors(colorSpace, (CFArrayRef) colors, locations);
    CGContextDrawLinearGradient(context, gradient, CGPointMake(rect.origin.x + rect.size.width / 2, rect.origin.y), CGPointMake(rect.origin.x + rect.size.width / 2, rect.origin.y + rect.size.height), 0);

    // Create text              
    CGContextSetFillColorWithColor(context, [UIColor blackColor].CGColor); 
    NSString *string = @"some test string";
    UIFont *font = [UIFont systemFontOfSize:16.0];

    // Rotate the context 90 degrees (convert to radians)
    CGAffineTransform transform1 = CGAffineTransformMakeRotation(-M_PI_2);
    CGContextConcatCTM(context, transform1); 

    // Move the context back into the view 
    CGContextTranslateCTM(context, -rect.size.height, 0);

    // Draw the string 
    [string drawInRect:rect withFont:font lineBreakMode:UILineBreakModeWordWrap alignment:UITextAlignmentLeft];

    // Clean up 
    CGGradientRelease(gradient);
    CGColorSpaceRelease(colorSpace);

    CGContextRestoreGState(context);
} 
```

请注意，您还可以获得字符串将如何呈现的大小，这有助于计算文本的对齐方式。

```
 CGSize stringSize = [string sizeWithFont:font]; 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-03-17T04:46:47.497

这是 KoNEW 答案的更新和简化版本。它保留了图形上下文的状态作为奖励。这也是一个简单的函数，而不是字符串扩展。

```
func drawRotatedText(_ text: String, at p: CGPoint, angle: CGFloat, font: UIFont, color: UIColor) {
  // Draw text centered on the point, rotated by an angle in degrees moving clockwise.
  let attrs = [NSFontAttributeName: font, NSForegroundColorAttributeName: color]
  let textSize = text.size(attributes: attrs)
  let c = UIGraphicsGetCurrentContext()!
  c.saveGState()
  // Translate the origin to the drawing location and rotate the coordinate system.
  c.translateBy(x: p.x, y: p.y)
  c.rotate(by: angle * .pi / 180)
  // Draw the text centered at the point.
  text.draw(at: CGPoint(x: -textSize.width / 2, y: -textSize.height / 2), withAttributes: attrs)
  // Restore the original coordinate system.
  c.restoreGState()
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-05-10T17:55:29.377

KoNew 在 Swift 中的解决方案：

```
extension NSString {

    func drawWithBasePoint(basePoint:CGPoint, angle:CGFloat, font:UIFont) {

        var attrs: NSDictionary = [
            NSFontAttributeName: font
        ]

        var textSize:CGSize = self.sizeWithAttributes(attrs as [NSObject : AnyObject])

        // sizeWithAttributes is only effective with single line NSString text 
        // use boundingRectWithSize for multi line text

        var context: CGContextRef =   UIGraphicsGetCurrentContext()

        var t:CGAffineTransform   =   CGAffineTransformMakeTranslation(basePoint.x, basePoint.y)
        var r:CGAffineTransform   =   CGAffineTransformMakeRotation(angle)

        CGContextConcatCTM(context, t)
        CGContextConcatCTM(context, r)

        self.drawAtPoint(CGPointMake(-1 * textSize.width / 2, -1 * textSize.height / 2), withAttributes: attrs as [NSObject : AnyObject])

        CGContextConcatCTM(context, CGAffineTransformInvert(r))
        CGContextConcatCTM(context, CGAffineTransformInvert(t))

    }

} 
```

要使用：

```
let fieldFont = UIFont(name: "Helvetica Neue", size: 14)

myNSString.drawWithBasePoint(CGPointMake(bounds.width/2, bounds.height/2), angle: CGFloat(-M_PI_2), font: fieldFont!) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-22T07:36:11.210

感谢这篇文章，以及[Chris 的回答](https://stackoverflow.com/a/10293425/419348)，以及[Arkadiusz 在另一篇文章](https://stackoverflow.com/a/19276322/419348)中的回答。

`UILabel`最后，我通过一个名为 的子类解决了这个问题`MyVerticalLabel`，并让它绘制垂直文本。

```
@implementation MyVerticalLabel

// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect {
    // Drawing code

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGAffineTransform transform = CGAffineTransformMakeRotation(-M_PI_2);
    CGContextConcatCTM(context, transform);
    CGContextTranslateCTM(context, -rect.size.height, 0);

    // The drawing rect should be applied with transform to.
    CGRect newRect = CGRectApplyAffineTransform(rect, transform);
    newRect.origin = CGPointZero;

    NSMutableParagraphStyle *textStyle = [[NSMutableParagraphStyle defaultParagraphStyle] mutableCopy];
    textStyle.lineBreakMode = self.lineBreakMode;
    textStyle.alignment = self.textAlignment;

    // Apply current label attributes for drawing function.
    NSDictionary *attributeDict =
    @{
      NSFontAttributeName : self.font,
      NSForegroundColorAttributeName : self.textColor,
      NSParagraphStyleAttributeName : textStyle,
      };
    [self.text drawInRect:newRect withAttributes:attributeDict];
}

@end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-25T23:53:07.833

我发现上面 Todd 的答案非常有帮助。但是，我经常想相对于文本的边缘之一（顶部、左侧等）定位和旋转文本。所以，我扩展了他的回答。此外，使用了属性文本，因此可以独立处理字体、颜色等。

```
enum StringOrigin: Int { case
    upperLeft, upperCenter, upperRight,
    centerLeft, centerCenter, centerRight,
    lowerLeft, lowerCenter, lowerRight }

func drawRotatedAttrString(_ s: NSAttributedString, p: CGPoint, angle: CGFloat, origin: StringOrigin) {
    let width = s.size().width
    let height = s.size().height

    let c = UIGraphicsGetCurrentContext()!
    c.saveGState()
    // Translate the origin to the drawing location and rotate the coordinate system.
    c.translateBy(x: p.x, y: p.y)
    c.rotate(by: angle * .pi / 180)
    // Draw the text offset to handle "origin" choice
    switch origin {
    case .upperLeft:
        s.draw(at: .zero)
    case .upperCenter:
        s.draw(at: CGPoint(x: -0.5 * width, y: 0))
    case .upperRight:
        s.draw(at: CGPoint(x: -width, y: 0))
    case .centerLeft:
        s.draw(at: CGPoint(x: 0, y: -0.5 * height))
    case .centerCenter:
        s.draw(at: CGPoint(x: -0.5 * width, y: -0.5 * height))
    case .centerRight:
        s.draw(at: CGPoint(x: -width, y: -0.5 * height))
    case .lowerLeft:
        s.draw(at: CGPoint(x: 0, y: -height))
    case .lowerCenter:
        s.draw(at: CGPoint(x: -0.5 * width, y: -height))
    case .lowerRight:
        s.draw(at: CGPoint(x: -width, y: -height))
    }
    // Restore the original coordinate system.
    c.restoreGState()
} 
```

# c - Pthreads 似乎没有使用多个处理器

> ID：10289900
> 
> 赞同：1
> 
> 时间：2012-04-23T23:49:33.287
> 
> 标签：c, linux, multithreading

我有一个生成多个子进程的应用程序，然后这些子进程继续生成多个线程。我可以控制产生的进程和线程的数量。线程对 NAS 执行特定的读/写操作，我记录了这需要多长时间。

奇怪的是，多线程执行读/写操作所需的*时间更长*。我在启动应用程序之前和完成后阅读了 /proc/stat 并得到了这个（经过一些数学运算）：

```
cpu0: 1.0050% usrtime, 2.5126% systime, 95.4774% idle, 0.5025% softirq
cpu1: 0.0000% usrtime, 0.0000% systime, 100.0000% idle, 0.0000% softirq 
```

我还检查了 sched_getaffinity，并且为子进程启用了两个 CPU。除了产生多个线程之外，我还必须做些什么来利用多个内核吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T23:53:09.317

你几乎没有使用你的 CPU。使用网络附加存储，您的瓶颈很可能是您的网络连接。您正在推送多少数据以及您的管道（和您的 NAS）可以容忍多少带宽？

# ios - 从斯坦福 iOS 课程中收到错误，但我的代码似乎相同

> ID：10289901
> 
> 赞同：1
> 
> 时间：2012-04-23T23:49:45.670
> 
> 标签：ios, objective-c

我相信我做了教练逐字逐句做的事情，但是如果我按下按钮，我的应用程序（它是一个简单的应用程序）将无法工作并且会出错。

我单击运行，它构建，但是当我单击 iOS 模拟器中的一个按钮时，应用程序崩溃并带我回到 Xcode 并出现错误。 ![在此处输入图像描述](../Images/0f5f413442d50e2c76f31a151cf58a9f.png)

我不知道我做错了什么。当我们在斯坦福指南中甚至没有处理它时，它把我带到了 main.m 文件（也许这与斯坦福指南使用 iOS 5.0 而我使用的是 5.1 的事实有关？）。

如果有人想花很多时间，这就是这个项目。我真的很困惑。

[http://cl.ly/212A3q3J1m1F1y3A041A](http://cl.ly/212A3q3J1m1F1y3A041A)

（另外，我是否只需要包含 xcodeproject 文件，或者我是否正确地将整个项目文件夹包含在一个 zip 文件中？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T23:59:36.300

看起来您的按钮已链接到名为 digitedPressed 的选择器：

它们似乎也正确链接到 digitPressed。只需删除对 digitedPressed 的引用。（右键单击故事板中的计算器视图控制器）

不要忘记检查 XCode 调试器！这是 XCode 调试器显示给我的错误：

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[CalculatorViewController digitedPressed:]: unrecognized selector sent to instance 0x9129cc0' 
```

# umbraco - 使用 Windows 身份验证自动登录 Umbraco

> ID：10289905
> 
> 赞同：2
> 
> 时间：2012-04-23T23:50:14.707
> 
> 标签：umbraco, windows-authentication

我正在从事 Umbraco 项目，目标是用户根据其域用户名自动登录到 Umbraco。这些是我到目前为止的步骤：

*   我在 IIS 7 上托管一个测试 Umbraco 站点
*   站点设置有windows Authentication，这意味着您必须登录到域才能访问该站点
*   我创建了一个宏，一旦有人访问该页面，就可以识别当前用户。如果用户没有匹配的 Umbraco 会员帐户，则会根据其域用户自动创建一个。

就目前而言，如果域中的某个人访问了 Umbraco 站点，那么他们将拥有一个具有匹配用户名的会员，如果该用户名不存在，则会在 Umbraco 中自动创建。这是被动完成的。

然而，最后一个阶段是我要求该用户成为注册的登录会员。我知道 Umbraco 会员是谁，我只需要让该会员自动登录到 Umbraco。

有谁知道我该怎么做？

我正在用 C# 编码，但任何形式的文档都会受到赞赏。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T15:30:19.810

Umbraco 会员部分使用 asp.net 会员系统，因此您只需调用 FormsAuthentication.SetAuthCookie() 方法来设置登录用户的详细信息。我认为您还需要告诉 Umbraco 缓存该成员。[our.umbraco.org 上的这篇文章](http://our.umbraco.org/forum/developers/api-questions/9595-Programmatically-login-user-with-MemberAddMemberToCache%28%29)有一些细节。

# ajax - 使用 AJAX 传递多个参数。值来自 DIV

> ID：10289907
> 
> 赞同：0
> 
> 时间：2012-04-23T23:50:16.303
> 
> 标签：ajax

我试图传递两个认为 ajax 的论点。我从中提取的变量位于 div 中，并且是即时完成的。我可以轻松传递 date_time 但我还需要能够传递变量“id”。日期位于正在加载和更改的数组中。此页面的 ID 不会更改。

这是javascript。下面是我的div。附加此内容的所有尝试均失败。有任何想法吗？

```
<div class='letter' width=600  date_time=\"$date_time\" id=\"$id\">
....doing stuff here.....
</div>

function OnScrollLetters () {  var div = document.getElementById ("userLetter");
   var info = document.getElementById ("info");
   if(div.scrollTop == (div.scrollHeight - div.clientHeight))
   {    
      $('div#loadMoreComments').show();
      $.ajax({
         url: "get_letters_for_profile_scroll.php?lastComment="+ $(".letter:last").attr('date_time'),
         success: function(html) {
            if(html){       
               $("#userLetter").append(html);
               $('div#loadMoreComments').hide();
            }else{
               $('div#loadMoreComments').replaceWith("<center><h1 style='color:red'>End of Letters</h1></center>");
            }
         }
      });
   }
} 
```

这是我的div。

```
<div class='letter' width=600  date_time=\"$date_time\" id=\"$id\">
....doing stuff here.....
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T01:48:02.583

尝试在参数名称和值之间放置一个“=”

```
..."&id="+$(".letter:last").attr('id') 
```

# c++ - 向量和队列 C++

> ID：10289912
> 
> 赞同：0
> 
> 时间：2012-04-23T23:50:41.293
> 
> 标签：c++, vector

这是前面关于如何压缩 switch 语句的问题的后续。我已经使用了之前提供的输入，但是我收到了关于如何将我的元素插入到向量中的错误，但我认为这就是你在 C++ 中插入向量的方式？

```
std::queue<myStruct > myQueue1, myQueue2, myQueue3, myQueue4, myQueue5

void change(float posx, float posy, int idNumber){  
    myStruct newDir;
    newDir.psX = posx;
    newDir.psY = posy;

    std::vector< std::queue<myStruct> > myVector (5);

    myVector.begin();
    myVector.insert (myQueue1);
    myVector.insert (myQueue2);
    myVector.insert (myQueue3);
    myVector.insert (myQueue4);
    myVector.insert (myQueue5);

    if (idNumber >= 1 && idNumber<= 5){
        myVector[idNumber-1].push (newDir);
        }

} 
```

TIA 任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T23:55:28.480

`vector::insert()`用于在特定位置插入新元素（因此需要位置参数）。您可能只想`push_back()`将新项目放在向量的末尾。为此，您不希望像这样做那样初始化向量（这会在向量上放置五个空队列）；只是默认初始化向量：

```
std::vector< std::queue<locaRef> > myVector; 
```

但是还有一个问题是你的向量有 type 的元素`std::queue<locaRef>`，但是你放在向量上的队列是`std::queue<MyStruct>`. 即使您修复了类型的差异，您也需要记住，放在向量上的是队列的副本，这可能是也可能不是您想要的。如果您不想要副本，您可能希望向量将某种指针或智能指针指向您的队列对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:54:15.600

如果您要将队列数硬编码为 5，则可以简单地使用数组而不是`vector`. 一般来说，为了方便起见，你会给你的结构一个简单的构造函数：

```
struct My_Struct
{
     My_Struct(float posx, float posy) : posx_(posx), posy_(posy) { }
     float posx_, posy_;
};

std::queue<My_Struct> my_queues[5];

void change(float posx, float posy, int id_number)
{
    if (id_number >= 1 && id_number <= 5)
        my_queues[id_number - 1].push(My_Struct(posx, posy));
    // else throw or assert so you'll see there's a problem...?
} 
```

# c# - 如何修复文件传输，收到的文件损坏？

> ID：10289916
> 
> 赞同：0
> 
> 时间：2012-04-23T23:51:18.980
> 
> 标签：c#, sockets, file-transfer, corrupt-data

我有使用 tcp 套接字的文件传输应用程序 [server-client]。

当我发送一个文件时，它成功，但是当我发送一个包含许多文件的文件夹时，接收到的文件被损坏，请注意，从客户端发送的文件和从服务器接收的文件都具有相同的大小（相同的字节数）。

![在此处输入图像描述](../Images/fa13365d2d782a1b1626632e7f74d774.png)

服务器：

```
private void ReceiveX(Socket client, string destPath, long size, int bufferSize)
    {
        using (Stream stream = File.Create(destPath))
        {
            byte[] buffer = new byte[bufferSize];
            long sum = 0;
            int count = 0;
            do
            {
                count = client.Receive(buffer, 0, buffer.Length, SocketFlags.None);
                stream.Write(buffer, 0, count);
                sum += count;
            } while (sum < size);
        }
    } 
```

客户 ：

```
private void SendX(Socket socket, string filePath, long size, int bufferSize, DoWorkEventArgs e)
    {
        using (Stream stream = File.OpenRead(filePath))
        {
            byte[] buffer = new byte[bufferSize];
            long sum = 0;
            int count = 0;
            do
            {
                if (worker.CancellationPending)
                {
                    e.Cancel = true;
                    return;
                }
                count = stream.Read(buffer, 0, buffer.Length);
                socket.Send(buffer, 0, count, SocketFlags.None);
                sum += count;
                worker.ReportProgress((int)((sum * 100) / size));
            } while (sum < size);
        }
    } 
```

客户端和服务器的bufferSize都是[4 * 1024]
**上面的代码有什么问题吗？**

客户端：在这里我循环文件夹以发送文件：

```
private void SendDir(string path, int bufferSize, DoWorkEventArgs e)
    {
        using (Socket listener = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp))
        {
            IPEndPoint endpoint = new IPEndPoint(IPAddress.Any, 0);
            listener.Bind(endpoint);
            listener.Listen(1);
            client.ReceiveFolder((IPEndPoint)listener.LocalEndPoint, fileList, Path.Combine(currAddress,Path.GetFileName(path)),bufferSize);
            Socket socket = listener.Accept();
            int count = 0;
    foreach (_File file in fileList)
            {
                if (worker.CancellationPending)
                {
                    e.Cancel = true;
                    return;
                }
                Console.WriteLine(++count);
                SendX(socket, file.Path, file.Size, bufferSize, e);
            }
            socket.Dispose();
    } 
```

服务器，遍历`list<_File>`之前从服务器接收到的文件，它包含客户端要发送的文件信息（名称、路径、大小）：

```
 private void ReceiveFolderTh(IPEndPoint endpoint, List<_File> Files, string destDir, int bufferSize)
    {
        Socket client = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        client.Connect(IPAddress.Parse("127.0.0.1"), endpoint.Port);
        foreach (_File file in Files)
        {
            Directory.CreateDirectory(destDir  + Path.GetDirectoryName(file.Name));
            ReceiveX(client, destDir + file.Name, file.Size, bufferSize);
        }
        client.Dispose();
    } 
```

那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T04:42:35.803

很可能问题是您的客户端在第一个文件上接收到太多数据，因为您在文件之间没有明确的分隔。您的接收代码是：

```
do
{
    count = client.Receive(buffer, 0, buffer.Length, SocketFlags.None);
    stream.Write(buffer, 0, count);
    sum += count;
} while (sum < size); 
```

您总是收到最多`buffer.Length`（您说是 4,096）字节。因此，如果第一个文件的长度为 100 字节，而下一个文件的长度为 5,000 字节，那么服务器很可能正在发送一个 4,096 字节的数据包，您的代码将尽职尽责地接收并存储在第一个文件中。

您需要更改调用中要接收的字节数`client.Receive`. 就像是：

```
int bytesToReceive = Math.Min(buffer.Length, size - sum);
count = client.Receive(buffer, 0, bytesToReceive, SocketFlags.None); 
```

这将阻止您从一个文件的末尾读取到下一个文件的开头。

# windows - Node.js Windows 安装程序

> ID：10289922
> 
> 赞同：1
> 
> 时间：2012-04-23T23:52:14.673
> 
> 标签：windows, node.js

我已经使用 node.js 站点中的 Windows 安装程序安装了 Nodejs，但无法在命令提示符下运行 node 命令。

另外我在 c:\Program Files\nodejs 中找不到文件夹

有没有我可以找到它的地方，以便我可以将其包含在我的系统路径中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:20:20.453

如果您运行的是 64 位版本的 Windows，您应该查看

```
C:\Program Files (x86)\nodejs 
```

# python - 在打开的 Mac 上 IDLE 崩溃

> ID：10289928
> 
> 赞同：2
> 
> 时间：2012-04-23T23:53:22.840
> 
> 标签：python, macos, osx-lion, python-idle

我在 Lion 10.7 上。我打开 IDLE，它会在底座中弹跳几秒钟然后消失。我无法运行任何模块并尝试重新安装它以及在 Python 3 上安装 Python 2.7。我还尝试安装最新的 ActiveTcl。

这是控制台日志： http: [//pastebin.com/yHNkRqYj](http://pastebin.com/yHNkRqYj)

# php - 在 PHP 中反向混淆纯文本字符串 url

> ID：10289932
> 
> 赞同：2
> 
> 时间：2012-04-23T23:54:43.133
> 
> 标签：php, deobfuscation, url-obsfucation

我试图找出一种方法来编写一个可以对纯文本 url 进行去混淆的函数。

像这样的东西：

```
<input type="hidden" value="kjgajkwe@#jktGAkjgWjkajskd" name="obsfucatedString" /> 
```

然后在处理该表格时，我想对其进行去模糊处理：

```
$url = deObfuscate($_POST['obsfucatedString']);
so $url would become something like:
$url = 'http://domain.com/filename.zip'; 
```

这样的事情可能吗？

我试图从普通程序员的视线中隐藏 url。

我想我需要写一些东西来混淆字符串

所以

```
$obsfucatedStringURL = obsfucate('http://domain.com/filename.zip'); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T23:57:52.493

[使用存储在服务器上的密码加密](http://www.php.net/manual/en/function.mcrypt-encrypt.php)URL（一个很好的算法是 AES），然后在需要获取值时对其进行[解密。](http://www.php.net/manual/en/function.mcrypt-decrypt.php)这样做的一个问题是加密的字符串不会由可打印的字符组成。要解决此问题，请使用[`base64_encode()`](http://php.net/base64_encode)将二进制编码字符串转换为可作为`<input>`字段值添加的可打印字符，然后用于[`base64_decode()`](http://php.net/base64_decode)在服务器上取回原始值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T23:58:16.830

有许多编码和反转纯文本字符串的方法。混淆字符串的一种简单方法是使用该[`str_rot13`](http://php.net/manual/en/function.str-rot13.php)函数一次编码并再次解码（**注意：这不会给您任何加密安全性**）。我建议使用 AES 加密，使用存储在服务器上的秘密进行加密和解密。以下线程的答案定义了您可以使用的加密/解密函数。

[PHP AES 加密/解密](https://stackoverflow.com/questions/3422759/php-aes-encrypt-decrypt)

与混淆相比，另一种可能值得考虑的方法是将 URL 服务器端存储为用户会话的一部分或保存在数据库中。然后，不要向下发送混淆字符串，而是使用执行查找的键来检索 URL。

# vb.net - 如何使用 Visual Basic 2010 将文本数组拆分为 3 个文本框？

> ID：10289934
> 
> 赞同：0
> 
> 时间：2012-04-23T23:54:51.553
> 
> 标签：vb.net

到目前为止，我已经在 Virtual Basic 2010 中创建了一个随机发生器，它：

1.  将用户在 form2 中输入的人名放入一个数组（以空格分隔）。
2.  随机化数组
3.  为每个估算的名称显示带有连续数字和句点的数组。

这是源代码：

```
 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim names() As String
    Dim i As Integer
    Dim j As Integer
    Dim tmp As String
    Dim txt As String

    ' Put the names in an array. SaveTitle is all the text saved in Form2
    names = Split(My.Settings.SaveTitle, " ")

    ' Randomize the array.
    Randomize()
    For i = LBound(names) To UBound(names) - 1
        ' Pick a random entry.
        j = Int((UBound(names) - i + 1) * Rnd() + i)

        ' Swap the names.
        tmp = names(i)
        names(i) = names(j)
        names(j) = tmp
    Next i

    ' Display the results.
    For i = LBound(names) To UBound(names)
        txt = txt & vbCrLf & i + 1 & ". " & names(i)
    Next i
    txt = Mid$(txt, Len(vbCrLf) + 1)

    RichTextBox1.Text = txt
End Sub 
```

注意最后一点。我想获取变量 txt 并将其拆分。然后我想取前 10 个名字并在 RichTextBox1 中显示，接下来的 10 个名字在 RichTextBox2 中显示，最后 10 个名字在 RichTextBox3 中显示。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T19:36:28.980

试试这个方法。

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

        Dim lstNames() As String
        Dim txt1, txt2, txt3 As String

        ' Put the names in an array. SaveTitle is all the text saved in Form2
        lstNames = Split(My.Settings.SaveTitle, " ")

        ' Randomize the array.
        Randomize()

        ' try this 
        For n As Integer = 0 To lstNames.Count - 1
            lstNames(n) = String.Format("{0}{1} ", lstNames(n), Rnd() + n)
        Next

        For n As Integer = 0 To lstNames.Count - 1
            If n < 10 Then
                txt1 += lstNames(n)
            End If

            If n > 9 And n < 20 Then
                txt2 += lstNames(n)
            End If

            If n > 19 And n < 30 Then
                txt2 += lstNames(n)
            End If

        Next
        RichTextBox1.Text = txt1
        RichTextBox2.Text = txt2
        RichTextBox3.Text = txt3

    End Sub 
```

# ruby - 为什么我需要 bundle exec 来要求这个 ruby gem？

> ID：10289936
> 
> 赞同：0
> 
> 时间：2012-04-23T23:55:18.200
> 
> 标签：ruby, rubygems, bundler

我有一个 Rails 应用程序，在“lib/services”下有一些不依赖于 Rails 的文件。其中一个文件使用[Domainatrix gem](https://github.com/dtuite/domainatrix)。

```
require "domainatrix"

class SuggestionParser
  # various suggestion parsing methods
end 
```

我在`spec/lib`.

```
require "services/suggestion_parser"

describe SuggestionParser do
end 
```

不幸的是，当我尝试在没有`bundle exec`遇到错误的情况下运行该规范时：

```
$: rspec spec/lib/services/suggestion_parser_spec.rb 
-> /Users/davidtuite/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require': cannot load such file -- domainatrix (LoadError) 
```

我项目中的所有其他规范和 gem 将在不使用`bundle exec`. 为什么我需要在这个前面加上前缀才能让它运行？

为方便起见，这里是[Domainatrix gemspec 的链接](https://github.com/dtuite/domainatrix/blob/master/domainatrix.gemspec)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T04:59:20.630

我的猜测是 domainatrix 是使用 Gemfile 中的`:path`or`:git`选项声明的，它们都没有以使 ruby​​gems 可以访问它的方式安装 gem。

如果您从 Gemfile 中发布 domainatrix 行，则可以确认这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T05:16:52.613

尝试运行以下命令：

```
$ rvm get head && rvm reload
$ chmod +x $rvm_path/hooks/after_cd_bundler
$ bundle install --without production --binstubs=./bundler_stubs 
```

这不会解决您的 gem 的特定问题，但是`bundle exec`如果您使用 rvm，它将消除每次运行测试时都输入的必要性。

# java - setFrameIcon 的动态 ImageIcon 缩减

> ID：10289940
> 
> 赞同：2
> 
> 时间：2012-04-23T23:56:08.160
> 
> 标签：java, swing, icons, jinternalframe, imageicon

我有一个 ImageIcon 用于打开此技能框架的按钮。此图像大小为 100x100 像素。正如您在屏幕截图中看到的那样，如果我只是把图像太大（这是预期的）。

我的问题是关于如何将图像缩放到 16x16（或任何默认尺寸），这样我就不需要手动创建更小尺寸的版本（出于多种原因）。

1.  以防他们将来把窗户做得更大
2.  多操作系统支持
3.  我确定我不需要继续命名...

    SkillsFrame = new JInternalFrame("技能", true, true, false, false);

    SkillFrame.setFrameIcon(new ImageIcon("images/gui/button_skills.png"));

现在对于图像...顶部的栏是单击以打开各种 JInternalFrames 的按钮。

![[IMG]http://img443.imageshack.us/img443/4310/67719353.png[/IMG]](../Images/dd89273ec9bbc3a3845c13d3771bf0da.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T05:41:25.393

> 如何将图像缩放到 16x16（或默认大小）

你看过[Image getScaledInstance(int width, int height, int hints)](http://docs.oracle.com/javase/7/docs/api/java/awt/Image.html#getScaledInstance%28int,%20int,%20int%29)

# django - django 从 DateTimeField 设置 DateField

> ID：10289941
> 
> 赞同：3
> 
> 时间：2012-04-23T23:56:17.433
> 
> 标签：django, django-models

很简单，这是我的问题：

```
class A(models.Model):
  x = DateTimeField(...)

class B(models.Model):
  x = DateField(...) 
```

给定 A 和 B 的实例，我如何简单地将 bx 设置为 ax？简单地将 bx 设置为 ax 会导致 bx 为无。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T23:59:21.137

用于`datetime.datetime.date()`获取`date`组件，如下所示：

```
a = A()
b = B()

# Stuff

b.x = a.x.date() 
```

有关详细信息，请参阅[http://docs.python.org/library/datetime.html#datetime-objects 。](http://docs.python.org/library/datetime.html#datetime-objects)

# proxy - Chef 中的引导代理是什么？

> ID：10289946
> 
> 赞同：2
> 
> 时间：2012-04-23T23:56:49.063
> 
> 标签：proxy, chef-infra, bootstrapping

我正在查看这个[http://tickets.opscode.com/browse/CHEF-2375](http://tickets.opscode.com/browse/CHEF-2375)，我对这个选项的用途有点困惑。我一般理解代理节点的想法，如下所述：[http ://en.wikipedia.org/wiki/Proxy_server](http://en.wikipedia.org/wiki/Proxy_server)

有人可以解释在 Chef 中使用引导代理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:09:47.707

基本上，引导代理允许您在设置服务器时指定 HTTP 代理服务器。

对于大多数人来说，这可能没什么大不了的，但是在某些情况下您需要/想要一个 HTTP 代理。

1.  某些网络设置为需要使用 HTTP 代理才能进行出站 HTTP 连接。这可以提供一些额外的安全性以及网络管理员方面的大量控制。如果没有 http 代理支持，knife bootstrap 命令将无法建立任何 HTTP 连接。

2.  添加 HTTP 代理作为缓存可以使 apt-get 等命令运行得更快，尤其是在连接速度较慢的情况下。本质上，您的代理可以缓存您下载的任何包，而第一台服务器不会有太大差异，任何后续服务器都将直接从缓存中下载包，这会更快。

# c++ - SDL_BlitSurface() 返回 -1 ... 为什么？

> ID：10289948
> 
> 赞同：1
> 
> 时间：2012-04-23T23:57:00.343
> 
> 标签：c++, sdl

SDL 文档说 SDL_BlitSurface() 在不成功时返回 -1，但我找不到它失败的原因。

这是我的源代码：

主文件

```
#include <iostream>
#include <string>
#include <SDL/SDL.h>
#include <SDL/SDL_image.h>
#include "window.cpp"
#include "player.cpp"

int init();
void quit();

int main(int argc,char *args[])
{
    if (init() == -1) 
    {
        std::cerr << "Error:init()" << std::endl;
        return -1;
    }
    window main_window("Juego","img/bg.png",800,600,32);
    player player1(500,500,0,0,5,5,"img/square.png");
    while (!main_window.close)
    {
        main_window.handle_events();
        if ( main_window.draw_background() != true)
        {
            std::cerr << "ERROR->main_window.draw_background()" << std::endl;
            main_window.close = true;
        }
        player1.update(main_window.screen);
        SDL_Flip(main_window.screen);
        SDL_Delay(60/1000);
    }
    quit();
    return 0;
}

int init()
{   
    if (SDL_Init(SDL_INIT_EVERYTHING) == -1)
    {   
        std::cerr << "Error while initialising SDL" << std::endl; 
        return -1;
    }
    return 0;
}

void quit()
{
    SDL_Quit();
} 
```

窗口.cpp

```
class window
{
    private:
        void load_image(std::string source,SDL_Surface *destination);
        SDL_Surface *window_bg;
        SDL_Event event_queue;
        SDL_Rect window_rect;
    public:
        window(std::string SCREEN_TITLE,std::string SCREEN_BG,int sw,int sh,int sbpp);
        void handle_events();
        bool draw_background();
        SDL_Surface *screen;
        bool close;
};

window::window(std::string SCREEN_TITLE,std::string SCREEN_BG,int sw,int sh,int sbpp)
{
    window_bg = NULL;
    screen = NULL;
    close = false;
    window_rect.x = 0;
    window_rect.y = 0;
    window_rect.w = sw;
    window_rect.h = sh;
    screen = SDL_SetVideoMode(sw,sh,sbpp,SDL_SWSURFACE);
    std::cout << "Screen created." << std::endl;
    SDL_WM_SetCaption(SCREEN_TITLE.c_str(),NULL);
    std::cout << "Window title: " << SCREEN_TITLE << std::endl;
    load_image(SCREEN_BG,window_bg);
}

void window::handle_events()
{
    while (SDL_PollEvent(&event_queue))
    {
        if (event_queue.type == SDL_QUIT)
        {    
            close = true;
        }
    }
}

void window::load_image(std::string source,SDL_Surface *destination)
{
    SDL_Surface *tmp_img = IMG_Load(source.c_str());
    if (tmp_img != NULL)
    {
        if ((destination = SDL_DisplayFormat(tmp_img)) == NULL)
        {
            std::cerr << "ERROR->SDL_DisplayFormat()" << std::endl;
        }
        std::cout << source << " Loaded." << std::endl;
        SDL_FreeSurface(tmp_img);
    }
    else
    {    
        std::cerr << "Could not load: " << source << std::endl;
    }
}

bool window::draw_background()
{
    int error_check = SDL_BlitSurface(window_bg,&window_rect,screen,NULL);
    if (error_check != 0)
    {
        std::cerr << "SDL_BlitSurface() == " << error_check << std::endl;
        return false;
    }
    return true;
} 
```

错误在 window.cpp 中（我认为）：

```
bool window::draw_background()
{
    int error_check = SDL_BlitSurface(window_bg,NULL,screen,NULL);
    if (error_check != 0)
    {
        std::cerr << "SDL_BlitSurface() == " << error_check << std::endl;
        return false;
    }
    return true;
} 
```

我的程序的输出是：

```
Screen created.
Window title: Juego
img/bg.png Loaded.
img/square.png Loaded
SDL_BlitSurface() == -1
ERROR->main_window.draw_background() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:03:04.987

任何事情都可能是造成这种情况的原因（我无法查看您的代码，请参阅[http://sscce.org/](http://sscce.org/)），您可以通过打印`SDL_GetError()`错误返回值来调试问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:35:31.100

`load_image(SCREEN_BG,window_bg);`在窗口构造函数中加载到一个临时的 SDL_Surface 并且从不填充`destination`，我假设它是一个输出参数。然后当`draw_background()`uses时`window_bg`，它仍然是 NULL。

# php - 如何使用不同的配置文件“zf create project ..”？REST/控制台/等

> ID：10289951
> 
> 赞同：0
> 
> 时间：2012-04-23T23:57:17.107
> 
> 标签：php, zend-framework, zend-tool

我想编写另一个 REST 服务，但这次使用 ZF 工具。我想知道周围是否已经有合适的项目配置文件？

**使用默认配置文件zf 工具**创建项目后说

```
Note: This command created a web project, for more information setting up your VHOST, please see docs/README 
```

显然假设存在配置文件机制并希望存在其他配置文件。

如果您遇到那些非普通配置文件（REST、控制台等），请告诉我。[每个人说的文档](http://framework.zend.com/manual/1.11/en/learning.quickstart.create-project.html)似乎对自定义分析有点沉默。**注意：**或者，欢迎提供有关开发您自己的自定义配置文件的教程。

PS 在 REST 的情况下，很明显可以按照与本[教程](http://akrabat.com/zend-framework-tutorial/)类似的步骤重用 vanilla web 配置文件。但是，如果有一个配置文件考虑到使用 REST 路由器的更好实践，就像[这里](http://framework.zend.com/manual/en/zend.controller.router.html#zend.controller.router.routes.rest)一样（因此是一种适当的非 RPC 方法），那就更好了。

**[编辑]**

*   问题的第一部分 - 使用 zf-tool 的项目配置文件是 [zf create project path name-of-profile file-of-profile的副本](https://stackoverflow.com/questions/4237765/zf-create-project-path-name-of-profile-file-of-profile)

*   问题的第二部分是为 REST 查找/创建此类配置文件（基于 ZF）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T04:37:13.713

代码和教程：[https ://github.com/codeinchaos/restful-zend-framework](https://github.com/codeinchaos/restful-zend-framework)

# android - 带有实时数据的 Android ListView 和 EditTexts

> ID：10289952
> 
> 赞同：2
> 
> 时间：2012-04-23T23:57:25.953
> 
> 标签：android, listview, android-edittext, android-arrayadapter

我有一个简单的 ListView，由我的 ArrayAdapter 支持，它每 5 秒左右更新一次新数据。每隔 5 秒，我会在 ArrayAdapter 上调用 notifyDataSetChanged，这会导致 ListView 被新数据重绘。所有这些工作正常，我每 5 秒看到一次新数据。

但是，在我的 ArrayAdapter 的 getView 方法中，我正在膨胀一个包含 EditText 的 LinearLayout。这是我要解决的问题：

1.  用户已在某些输入中的某一行和类型中选择了 EditText。
2.  用户在 EditText 上停留的时间超过 5 秒。
3.  notifyDataSetChanged 在新数据到达我的数组适配器时被调用。
4.  重绘后，用户失去了对 EditText 的关注。notifyDataSetChanged 似乎导致所有 ListView 元素被重绘。

让用户保持关注此 EditText 但确保数据始终是最新的最佳方式是什么？

谢谢，

肖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T08:04:42.023

这可能不是最好的方法，而是一种快速的方法。覆盖notifydatasetchanged，首先检查你是否有一个元素有焦点（或者当它获得焦点而不丢失它时存储它），存储输入，调用super.notifyDatasetChanged，写入旧值。

如果适配器的项目太多，这可能不是一个好的解决方案。

# jakarta-ee - 是否可以在 Jboss AS 7 启动时加载 Netty Socket 服务器？

> ID：10289953
> 
> 赞同：0
> 
> 时间：2012-04-23T23:57:29.500
> 
> 标签：jakarta-ee, netty, jboss7.x, serversocket

我们在 java 中有一个“独立”的 Socket 服务器，它接受来自我们网络周围客户端的许多请求（xml 字符串）。那工作得很好。问题是现在在服务器端，我们需要使用一些发布在不同服务器上的 WebServices。

据我了解，我们需要站在 WebServer 上才能使用这些 Web 服务（对吗？），所以我们安装 JBOSS AS 7.1 并生成客户端，现在我们可以使用这些 Web 服务了。

问题是：我们如何混合这两个部分？我的意思是在套接字中接收请求，然后使用接收到的信息调用 Web 服务，然后响应套接字客户端，无论 Web 服务结果是什么......

我的想法是实现 Netty 以在 JBOSS 启动时启动 Socket 服务器，并在处理程序上调用 web 服务，但我迷路了.. 关于如何配置 Jboss 以启动 Socket 服务器的任何建议？我也在看 JBOSS Remoting 但由于我使用 JBOSS AS 7 找不到 Remoting 3 的任何文档...。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T06:16:34.013

不，据我所知，在 Java EE 容器之外也应该可以使用 WebServices。您只需要确保包含所有依赖项。

您的“独立”套接字服务器是使用 HTTP 还是仅使用 TCP？

如果您想与 JBoss 集成，最简单的可能是编写一个 SAR。更多的工作，但给你更好的集成是编写一个自定义[子系统](https://docs.jboss.org/author/display/AS71/Extending+JBoss+AS+7)。这也允许您连接到 JBoss 配置。

JBoss 远程处理主要用于诸如 EJB 调用之类的事情。

# c# - 删除 Oracle 中不存在的记录是否被认为是不好的形式？

> ID：10289954
> 
> 赞同：1
> 
> 时间：2012-04-23T23:57:34.113
> 
> 标签：c#, sql, winforms, oracle

我看到我可以“删除”一个不存在而不受惩罚的记录；但这其中有什么隐患吗？

如果最好先检查记录是否存在，是否有一些超快速的方法可以做到这一点？

IOW，有没有办法快速执行这个伪SQL：

```
if recordExists(table, rowval[s])
  deleteRecord 
```

?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T00:00:28.500

一般来说，没有真正的理由在删除之前检查某些内容是否存在。SQL是一种基于集合的语言，删除一个空集合的元素是完全有效的

要检查是否存在某些内容需要查找，最坏的情况是，您必须再次执行相同的查找才能删除。唯一一种**好的**形式是，如果不满足条件，语句可能会导致错误（想到修改 DDL 的语句）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T00:00:10.963

不，没有理由不使用普通的 DELETE 语句来删除可能存在或不存在的行：

```
DELETE FROM Table WHERE Id = 234 
```

这将删除指定的行，或者不会。在前一种情况下，更新计数将为 1，而在后一种情况下，更新计数为 0。在记录确实存在的情况下，您可以使用它来执行任何其他逻辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T00:01:08.867

只要您愿意在记录存在时接受 DELETE 操作，您就可以自由删除 - 记录与否。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T20:37:10.467

补充一点，在“真实”查询之前执行存在性检查的另一个危险是，数据的可见版本可能会在查询之间发生变化，除非您采取了将读取一致性更改为可序列化的预防措施。

# java - java使用日历在静态方法中设置日期字段

> ID：10289962
> 
> 赞同：-1
> 
> 时间：2012-04-23T23:58:33.173
> 
> 标签：java, date, static, calendar

我想使用此方法将给定源日期的字段设置为给定目标日期。

```
private static void setFields(final Date source, 
    final Date target, 
    final int ... fields)
{
    final Calendar sourceCalendar = Calendar.getInstance();
    sourceCalendar.setTime(source);

    final Calendar targetCalendar = Calendar.getInstance();
    targetCalendar.setTime(target);

    for(int field : fields)
        targetCalendar.set(field, sourceCalendar.get(field));
} 
```

未设置目标日期的分钟。如果我不想通过使用来破坏参考，我应该如何设置它。

```
target = targetCalendar.getTime(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:03:32.010

要将`target`日期更改为 中的值`targetCalendar`，请使用：

```
target.setTime(targetCalendar.getTime().getTime()); 
```

假设这就是你要问的，你的问题有点不清楚。

# c# - 获取课堂数据

> ID：10289963
> 
> 赞同：0
> 
> 时间：2012-04-23T23:58:37.093
> 
> 标签：c#, class

我有班级学生：

```
public class Student
    {
        public string Name { get; set; }
        public string Age { get; set; }
        public Student()
        {
        }
        public List<Student> getData()
        {
            List<Student> st = new List<Student> 
            {
                new Student{Name="Pham Nguyen",Age = "22"},
                new Student{Name="Phi Diep",Age = "22"},
                new Student{Name="Khang Tran",Age = "28"},
                new Student{Name="Trong Khoa",Age = "28"},
                new Student{Name="Quan Huy",Age = "28"},
                new Student{Name="Huy Chau",Age = "28"},
                new Student{Name="Hien Nguyen",Age = "28"},
                new Student{Name="Minh Sang",Age = "28"},
            };
            return st;
        }        
    } 
```

我怎样才能在这个类中获取数据？（我的意思是 - 示例：我想显示 Name="Minh Sang",Age = "28"）。

对不起这个问题。但我不知道在哪里可以找到它。

谢谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T00:26:14.737

您可以使用 linq：

```
Student st = new Student();

var getStudent = from a in st.getData()
                      where a.Age == "28" & a.Name == "Minh Sang"
                      select a;

MessageBox.Show(getStudent.First().Age);
MessageBox.Show(getStudent.First().Name); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:11:16.147

查看 List.Find 方法：

[http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)

接下来尝试实现一个新方法：

```
public Student GetStudent(string name, int age) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T00:15:30.687

调用 getData() 以获取学生列表。

使用 foreach 循环遍历列表。

在循环中，打印出学生的姓名和年龄。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T00:31:26.623

也许您正在寻找[DebuggerDisplay](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerdisplayattribute.aspx)属性以在调试器中显示它？

```
[DebuggerDisplay("Name = {name}, Age={age}")]
public class Student {....} 
```

因此，当您将鼠标悬停在 Student 类型的项目上时，它将以您想要的方式显示...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T00:46:14.517

**编辑 1：** 将这些方法添加到您的课程中：

```
public Student getStudent(int age, string name)
{
    return this.getData().Find(s => Convert.ToInt32(s.Age) == age && s.Name.Equals(name));
}

public Student getByIndex(int index)
{
    Student s = null;
    // maxIndex will be: 7
    // your array goes from 0 to 7
    int maxIndex = this.getData().Count() - 1;
    // If your index does not exceed the elements of the array:
    if (index <= maxIndex)
        s  = this.getData()[index];
    return s;
} 
```

*   `int`如果您将来需要评估，我将年龄转换`>`为`<`.

**编辑2：** 然后调用这样的方法：

```
 Student st = new Student();
    // s1 and s2 will return null if no result found.
    Student s1 = st.getStudent(28, "Minh Sang");
    Student s2 = st.getByIndex(7);

    if (s1 != null)
        Console.WriteLine(s1.Age);
        Console.WriteLine(s1.Name);
    if (s2 != null)
        Console.WriteLine(s2.Age);
        Console.WriteLine(s2.Name); 
```

# linux - 将 10 分钟的 cron 作业添加到 Ubuntu 包

> ID：10289970
> 
> 赞同：10
> 
> 时间：2012-04-23T23:59:01.623
> 
> 标签：linux, ubuntu, cron, debian, crontab

我需要使用我的 Ubuntu 安装包安装一些 cron 作业。每天或每小时运行的那些很容易：我可以从`/etc/cron.daily`我的脚本创建一个符号链接。

但是，我也有一个脚本，我想每 10 分钟运行一次。没有这样的事情`/etc/cron.minutely`。此外，我不确定如何在不使用交互式编辑器 ( `crontab -e`) 的情况下编辑 crontab。解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-24T00:11:30.207

您的包可以简单地放入一个文件`/etc/cron.d/`

文本文件应该包含这样的内容，每 10 分钟运行一次命令：

```
*/10 * * * * root /path/to/command 
```

谷歌“cron 格式”以获取更多信息，是的，这属于 askubuntu 或超级用户。

您需要将用户名 (root) 添加到该行，如上所示。显然这对于​​ cron.d 中的文件是必要的，但我找不到确定的文档。**

cron 应该自动选择这个新工作。

# javascript - 简单的javascript检测用户设备

> ID：10289972
> 
> 赞同：0
> 
> 时间：2012-04-23T23:59:16.390
> 
> 标签：javascript, iphone

我想将 javascript 添加到我的模板中，以检测每次用户使用哪种设备（智能手机、平板电脑或 PC）查看我的网站时。

目前，我尝试用javascript来做，这里是：

```
var smartPhone = "smartphone";
var Ipod = "ipod";

var userDevice = navigator.userAgent.toLowerCase();

function DetectPhone()
{
   if (userDevice.search(smartPhone) > -1)
      return true;
   else
      windows.location = "/pageforphone.aspx";
}

function DetectIpod()
{
   if (userDevice.search(Ipod) > -1)
      return true;
   else
      windows.location = "/pageforpod.aspx";
} 
```

我写的代码对吗？老实说，没有iPhone...

当然，如果这些是用 Php 或 Asp.net 完成的会更好，但是人们总是在他们的掌上设备上关闭 javascript 是真的吗？另外，我认为 iphone 或 ipod 或任何其他平板电脑都非常相似，我可以为这些设备使用相同的 redev 页面吗？实际上，我不太了解它们之间的区别以及重新开发网页时应该注意什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:07:26.430

问题的前提是浏览器嗅探是可以接受的，这是错误的。你永远不应该参与浏览器嗅探，仅仅因为你不能自信地完成你打算完成的事情。用户代理字符串不是不可变的，并且经常被安装在客户端机器上的插件或客户端自己更改（并不罕见，因为糟糕的程序员可能会根据他们的 UA 字符串将它们锁定在站点之外）。

与其问用户是*什么*设备，不如问设备有*什么功能*。这会将您带到*特征检测*，您开始执行 X，测试以查看用户代理是否能够执行 X，然后继续执行或不执行 X。例如：

```
if ( !!document.createElement("video").canPlayType ) {
  console.log( "HTML5 Video Supported" );
} 
```

这比尝试查看用户是否使用 iPhone、iPad、Windows 平板电脑或支持 HTML5 的浏览器更可靠。您可以使用[Modernizr](http://modernizr.com)之类的工具为您执行大量此类测试 - 实际上超过 40 个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:30:30.753

市场上有许多移动设备+每个设备可以安装多个浏览器。我更喜欢使用一些库而不是在用户代理字符串中资助“iPhone”（我自己使用带有 Opera 浏览器的 Android 手机）

例如：

*   [http://detectmobilebrowsers.mobi/](http://detectmobilebrowsers.mobi/)
*   [http://wurfl.sourceforge.net/](http://wurfl.sourceforge.net/) - 服务器端，有一个支持设备和功能的大型数据库
*   [http://modernizr.com](http://modernizr.com) - 客户端大小的 JavaScript 库，检测浏览器上可用的 HTML5 功能（例如地理定位 API、视频、索引数据库、本地存储等）

它们都定期更新最新发布的移动设备，并为您提供给定设备支持哪些功能的信息

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-24T00:11:18.460

这就是我使用 javascript 检测 iOS 设备的方式

```
<script type="text/javascript">
    var agent = navigator.userAgent.toLowerCase();
    var isiPhone = ((agent.indexOf('iphone'))!=-1)

    if (((agent.indexOf('iphone'))!=-1) {
        document.location = "mobile.aspx?device=iphone";
    }

    if (((agent.indexOf('ipod'))!=-1) {
        document.location = "mobile.aspx?device=ipod";
    }

    if (((agent.indexOf('iPad'))!=-1) {
        document.location = "mobile.aspx?device=ipad";
    }
</script> 
```

# button - Foursquare 保存按钮不读取场地数据

> ID：10289975
> 
> 赞同：0
> 
> 时间：2012-04-23T23:59:23.413
> 
> 标签：button, save, foursquare

我试过几次，创建一个“保存到四方形按钮”，但是，也许脚本有问题。

我从站点场地的网站上尝试了这个有效的代码：

```
<div class="locInfo vcard" style="display: none;">
    <h4>
        <a class="fn" href="">Flying Star Cafe - Menaul</a>
    </h4>
    <p class="adr">
        <span class="street-address">8001 Menaul Blvd NE</span> <br> <span
            class="locality">Albuquerque</span>, <span class="region">NM</span>
        <span class="postal-code">87110-4607</span>
    </p>
</div>
<a href="https://foursquare.com/intent/venue.html"
    class="fourSq-widget">Save to foursquare</a>
<br />
<!-- Place this script somewhere after the anchor tag above. If you have multiple buttons, only include the script once. -->
<script type='text/javascript'>
    (function() {
        window.___fourSq = {
            "uid" : "5166539"
        };
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.src = 'http://platform.foursquare.com/js/widgets.js';
        s.async = true;
        var ph = document.getElementsByTagName('script')[0];
        ph.parentNode.insertBefore(s, ph);
    })();
</script> 
```

它工作得很好，但如果我在这个场地使用相同的结构：[https ://pt.foursquare.com/v/centro-drag%C3%A3o-do-mar-de-arte-e-cultura/4be5f4802468c92887d30043](https://pt.foursquare.com/v/centro-drag%C3%A3o-do-mar-de-arte-e-cultura/4be5f4802468c92887d30043)

出事了……

```
<div class="locInfo vcard" style="display: none;">
    <h4>
        <a class="fn" href="">Centro Dragão do Mar de Arte e Cultura</a>
    </h4>
    <p class="adr">
        <span class="street-address">Rua Dragão do Mar, 81</span> <br> <span
            class="locality">Fortaleza</span>, <span class="region">CE</span> <span class="postal-code">60060-390</span>
    </p>
</div>
<a href="https://foursquare.com/intent/venue.html"
    class="fourSq-widget">Save to foursquare</a>
<br />
<!-- Place this script somewhere after the anchor tag above. If you have multiple buttons, only include the script once. -->
<script type='text/javascript'>
    (function() {
        window.___fourSq = {
            "uid" : "5166539"
        };
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.src = 'http://platform.foursquare.com/js/widgets.js';
        s.async = true;
        var ph = document.getElementsByTagName('script')[0];
        ph.parentNode.insertBefore(s, ph);
    })();
</script> 
```

有什么线索吗？我不知道问题是否在于场地位置在美国以外......我应该为我的场地使用其他参数吗？

我正在使用 Google Chrome 18.0.1025.162 并在 Apache Tomcat 7.0.27 中运行代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T07:48:44.933

为了确定正确的场地，您应该尽可能多地提供场地的独特细节。在您的情况下，添加场地的电话号码就足够了：

```
<div class="locInfo vcard" style="display: none;">
    <h4>
        <a class="fn" href="">Centro Drag&#227;o do Mar de Arte e Cultura</a>
    </h4>
    <p class="adr">
        <span class="street-address">R. Drag&#227;o do Mar, 81</span> <br />
        <span class="locality">Fortaleza</span>, <span class="region">CE</span>
        <span class="postal-code">60060-390</span> <br />
        <span class="tel">+55 85 3488-8600</span>
    </p>
</div>
<a href="https://foursquare.com/intent/venue.html" class="fourSq-widget">Save to foursquare</a>
<br />
<script type='text/javascript'>
(function() {
    window.___fourSq = {
        "uid" : "5166539"
    };
    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.src = 'http://platform.foursquare.com/js/widgets.js';
    s.async = true;
    var ph = document.getElementsByTagName('script')[0];
    ph.parentNode.insertBefore(s, ph);
})();
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:58:32.257

我遇到了问题，因为我写了一个错误的位置（它与我在 FS 上写的不完全相同）。尝试消除该类并尝试一下...

# google-app-engine - 使用 Google App Engine 在本地保存 PNG 图像的 data:url

> ID：10289979
> 
> 赞同：0
> 
> 时间：2012-04-23T23:59:48.077
> 
> 标签：google-app-engine, content-type, savefiledialog, content-disposition, data-url

我正在使用 Google App Engine (python) 并且有一个数据：服务器上可用的 PNG 图像的 url。PNG 图像从未在文件中，因为它是使用 toDataUrl() 从一些画布代码生成的，并通过 ajax 处理到服务器。我想允许用户单击一个按钮并能够选择一个文件名并在本地保存 PNG 图像。Save As 对话框将提供一个默认的 filename.png。目标浏览器是 FireFox。我提供了不起作用的示例代码。stackoverflow 上有几个问题有点像这个，但每个问题都有点不同。

我将内容处置设置为带有建议文件名的附件。我将标头内容类型设置为 application/octet-stream。但我没有得到 SaveAs 对话框。我错过了什么？

app.yaml 文件是标准的

```
application: saveas
version: 1
runtime: python
api_version: 1

handlers:
- url: /.*
  script: main.py 
```

index.html 如下：

```
<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8"/>

<script>

function saveAsPng()
{
var alldata;
var httpRequest;
var response;
var myheaders;

httprequest = new XMLHttpRequest();

if ( !httprequest )
   {
   alert("In saveAsPng, XMLHttpRequest failed.");
   return;
   }

/* Make this a json string */
alldata = JSON.stringify("no data");

try
   {
   httprequest.open('POST', '/handlebitmap', true);
   httprequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
   httprequest.setRequestHeader("Content-length", alldata.length);
   httprequest.setRequestHeader("Connection", "close");
   httprequest.onreadystatechange = function() 
      {
      if ( httprequest.readyState == 4 )
         {
         if (httprequest.status == 200) 
            {
            /* a status of 200 is good. */
            response = null;
            try 
               {
               response = JSON.parse(httprequest.responseText); 
               } 
            catch (e) 
               {
               response = httprequest.responseText;
               }

            if ( response == "error" )
               {
               alert("In saveAsPng callback, response == error");
               return false;
               }
            else
               {
               /* This is the successful exit. */

               //alert("response = " +response);

               window.location.href = response;   

               return true;
               }
            }
         else
            {
            /* httprequest.status was not 200, so must be an error. */
            alert("saveAsPNG callback, status = " +httprequest.status);
            return false;
            }

         }   /* End of if where readyState was 4\. */

      }   /* End of the callback function */

   /* Make the actual request */
   httprequest.send(alldata);
   }
catch(e)
   {
   alert("In saveAsPng, Can't connect to the server");
   }

}   /* End of the saveAsPng function */ 
```

python代码如下：

```
# !/usr/bin/env python

import os
import base64

from google.appengine.ext import webapp
from google.appengine.ext.webapp import template
from google.appengine.ext.webapp import util

class MainPage(webapp.RequestHandler):
    """ Renders the main template."""
    def get(self):
        template_values = { 'title':'Test Save As PNG', }
        path = os.path.join(os.path.dirname(__file__), "index.html")
        self.response.out.write(template.render(path, template_values))

class BitmapHandler(webapp.RequestHandler):
    """ Shows the Save As with a default filename. """
    def post(self):
        origdata = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="
        urldata = "iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="
        decodeddata = base64.b64decode(urldata) 
        self.response.headers['Content-Type'] = 'application/octet-stream'
        self.response.headers['Content-Disposition'] = 'attachment; filename="untitled.png"'
        self.response.out.write(decodeddata)

def main():
    app = webapp.WSGIApplication([
        ('/', MainPage),
        ('/handlebitmap',BitmapHandler),
        ], debug=True)
    util.run_wsgi_app(app)

if __name__ == '__main__':
    main() 
```

{{标题}}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T06:29:25.483

也许您想将“def post”更改为“def get”？我刚刚尝试了您的示例，并且在更改后它似乎按预期工作（仅尝试了 /handlebitmap）

# powershell - 为什么在PowerShell中等于“-eq”而不仅仅是“=”？

> ID：10289980
> 
> 赞同：30
> 
> 时间：2012-04-23T23:59:53.083
> 
> 标签：powershell, syntax

构造`-ne`,`-eq`和`-gt`看起来至少很奇怪。

```
if ($true -eq $true){} 
```

但不是

```
if ($true = $true){} 
```

解释是什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-04-24T00:43:35.923

基本上，答案是 Unix 一直以来都是这样做的。果然，如果您编写了一些您将使用的 Bash 脚本，并且将您的 PowerShell 语法知识一对一地转移到 Bash 中，这实际上是一件好事。

Bruce Payette 的*Windows PowerShell in Action* , Second Edition (Kindle Location 3391) 对此进行了详细解答。

> 让我们谈谈 PowerShell 语言中最具争议的设计决策。
> 
> 赢家是：为什么我们不使用常规符号进行比较，如 >、>=、<、<=、== 和 !=？
> 
> 答案是 > 和 < 字符用于输出重定向。因为 PowerShell 是一个 shell，并且过去 30 年中的所有 shell 语言都使用 > 和 < 进行 I/O 重定向，所以人们期望 PowerShell 也应该这样做。在 PowerShell 的第一个公开测试版期间，该主题引发了持续数月的讨论。
> 
> 我们研究了多种替代方案，例如模态解析，其中有时 > 表示大于，有时表示重定向。我们查看了诸如 :> 或 -> 等运算符的替代字符序列，用于重定向或比较。我们进行了可用性测试并举行了焦点小组讨论，最后，我们确定了我们的开始。
> 
> 重定向运算符是 > 和 <，比较运算符取自 Unix test(1) 命令。我们预计，由于这些运算符拥有 30 年的血统，因此它们足以在 PowerShell 中使用。（我们还希望人们会继续抱怨这一决定，但希望不会再持续 30 年。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-24T00:05:05.547

因为`>`and`<`是大多数 shell 中的流重定向运算符。好吧，除了 PowerShell 不支持流输入重定向。`>`除此之外，在某些情况下解析/解释为重定向 stdout 和在其他情况下会更加困难`greater than`。此外，通过使用该`-<operator_name>`方法，您可以拥有比直观符号更多的运算符，例如 -contains、-notcontains、-is、-replace、-split、-match 等。执行`man about_operators`作为探索 PowerShell 支持的所有运算符的起点.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-30T08:26:33.540

运算符 = 已经是赋值运算符。为了不混淆比较和赋值运算符，他们选择了另一个运算符。在本例中为 -eq，因为它已在其他 (UNIX) 脚本语言中使用。

# c - 两个日期之间的 C 程序天数 - 输出有点太高？

> ID：10289982
> 
> 赞同：-1
> 
> 时间：2012-04-24T00:00:07.580
> 
> 标签：c

我的大学课程的这个 C 程序应该找到两个日期之间的天数。它在大多数情况下都有效，但是当月 1 和月 2 不同时，输出通常只是几天太高。此外，似乎无法识别具有 31 天的月份，导致在输入“31”作为日期时出现“无效的月份和日期组合”错误消息。我完全不确定为什么会出现这些问题。提前感谢您的帮助！

```
// Calculates the number of calendar days between any two dates in history (beginning with 1/1/1).

#include <stdio.h>
#include <stdlib.h>

void date(int *month1, int *day1, int *year1, int *month2, int *day2, int *year2);
void leap(int year1, int year2, int *leap1, int *leap2);

int main(void)
{
  int month1, day1, year1, month2, day2, year2, leap1, leap2;

  date(&month1, &day1, &year1, &month2, &day2, &year2);
  leap(year1, year2, &leap1, &leap2);

  if(year1 == year2)
  {
    int i, total = 0;

    if(month1 == month2)                            // Total days if month1 == month2
    {
      total = day2 - day1;
      printf("There are %d days between the two dates.", total);
    }
    else
    {
      if(month1 == 1||3||5||7||8||10)         // Days remaining in first month
        total = 31 - day1;
      else if(month1 == 4||6||9||11)
        total = 30 - day1;
      else
      {
        if(leap1 == 1)
          total = 29 - day1;
        else
          total = 28 - day1;
      }

      for(i = month1 + 1; i < month2; i++)    // Days remaining between dates (excluding last month)
      {
        if(i == 3||5||7||8||10)
          total += 31;
        else if(i == 4||6||9||11)
          total += 30;
        else
        {
          if(leap1 == 1)
            total += 29;
          else
            total += 28;
        }
      }

      total += day2;                          // Final sum of days between dates (including last month)

      printf("There are %d days between the two dates.", total);
    }
  }
  else                                                    // If year1 != year2 ...
  {
    int i, total, century1 = ((year1 / 100) + 1) * 100, falseleap = 0;

    if(month1 == 1||3||5||7||8||10||12)             // Days remaining in first month
      total = 31 - day1;
    else if(month1 == 4||6||9||11)
      total = 30 - day1;
    else
    {
      if(leap1 == 1)
        total = 29 - day1;
      else
        total = 28 - day1;
    }

    for(i = month1 + 1; i <= 12; i++)               // Day remaining in first year
    {
      if(i == 3||5||7||8||10||12)
        total += 31;
      else if(i == 4||6||9||11)
        total += 30;
      else
      {
        if(leap1 == 1)
          total += 29;
        else
          total += 28;
      }
    }

    for(i = 1; i < month2; i++)                     // Days remaining in final year (excluding last month)
    {
      if(i == 1||3||5||7||8||10)
        total += 31;
      else if(i == 4||6||9||11)
        total += 30;
      else
      {
        if(leap2 == 1)
          total += 29;
        else
          total += 28;
      }
    }

    int leapcount1 = year1 / 4;                     // Leap years prior to and including first year
    int leapcount2 = year2 / 4;                     // Leap years prior to and NOT including final year
    if(year2 % 4 == 0)
      leapcount2 -= 1;

    int leaptotal = leapcount2 - leapcount1;        // Leap years between dates

    for(i = century1; i < year2; i += 100)          // "False" leap years (divisible by 100 but not 400)
    {
      if((i % 400) != 0)
        falseleap += 1;
    }

    total += 365 * (year2 - year1 - 1) + day2 + leaptotal - falseleap;      // Final calculation
    printf("There are %d days between the two dates.", total);
  }
  return 0;
}

void date(int *month1, int *day1, int *year1, int *month2, int *day2, int *year2)
{
  for(;;)                                                         // Infinite loop (exited upon valid input)
  {
    int fail = 0;
    printf("Enter first date: ");
    scanf("%d/%d/%d", month1, day1, year1);
    if(*month1 < 1 || *month1 > 12)
    {
      printf("Invalid entry for month.\n");
      fail += 1;
    }
    if(*day1 < 1 || *day1 > 31)
    {
      printf("Invalid entry for day.\n");
      fail += 1;
    }
    if(*year1 < 1)
    {
      printf("Invalid entry for year.\n");
      fail += 1;
    }
    if((*month1 == 4||6||9||11) && *day1 > 30)
    {
      printf("Invalid month and day combination.\n");
      fail += 1;
    }
    if(*month1 == 2)
    {
      if(*year1 % 4 == 0)
      {
        if(*year1 % 100 == 0)
        {
          if(*year1 % 400 == 0 && *day1 > 29)
          {
            printf("Invalid month and day combination.\n");
            fail += 1;
          }
          if(*year1 % 400 != 0 && *day1 > 28)
          {
            printf("Invalid month and day combination.\n");
            fail += 1;
          }
        }
        if(*year1 % 100 != 0 && *day1 > 29)
        {
          printf("Invalid month and day combination.\n");
          fail += 1;
        }
      }
      if(*year1 % 4 != 0 && *day1 > 28)
      {
        printf("Invalid month and day combination.\n");
        fail += 1;
      }
    }
    if(fail > 0)
      continue;
    else
      break;
  }

  for(;;)
  {
    int fail = 0;
    printf("Enter second date: ");
    scanf("%d/%d/%d", month2, day2, year2);
    if(*month2 < 1 || *month2 > 12)
    {
      printf("Invalid entry for month.\n");
      fail += 1;
    }
    if(*day2 < 1 || *day2 > 31)
    {
      printf("Invalid entry for day.\n");
      fail += 1;
    }
    if(*year2 < 1)
    {
      printf("Invalid entry for year.\n");
      fail += 1;
    }
    if((*month2 == 4||6||9||11) && *day2 > 30)
    {
      printf("Invalid month and day combination.\n");
      fail += 1;
    }
    if(*month2 == 2)
    {
      if(*year2 % 4 == 0)
      {
        if(*year2 % 100 == 0)
        {
          if(*year2 % 400 == 0 && *day2 > 29)
          {
            printf("Invalid month and day combination.\n");
            fail += 1;
          }
          if(*year2 % 400 != 0 && *day2 > 28)
          {
            printf("Invalid month and day combination.\n");
            fail += 1;
          }
        }
        if(*year2 % 100 != 0 && *day2 > 29)
        {
          printf("Invalid month and day combination.\n");
          fail += 1;
        }
      }
      if(*year2 % 4 != 0 && *day2 > 28)
      {
        printf("Invalid month and day combination.\n");
        fail += 1;
      }
    }
    if(fail > 0)
      continue;
    else
      break;
  }
}

void leap(int year1, int year2, int *leap1, int *leap2)             // Determines if first and final years are leap years
{
  if(year1 % 4 == 0)
  {
    if(year1 % 100 == 0)
    {
      if(year1 % 400 == 0)
        *leap1 = 1;
      else
        *leap1 = 0;
    }
    else
      *leap1 = 1;
  }
  else
    *leap1 = 0;

  if(year2 % 4 == 0)
  {
    if(year2 % 100 == 0)
    {
      if(year2 % 400 == 0)
        *leap2 = 1;
      else
        *leap2 = 0;
    }
    else
      *leap2 = 1;
  }
  else
    *leap2 = 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:06:08.677

```
if(month1 == 1||3||5||7||8||10) 
```

总是计算为`true`，因为它已被解析

```
if ((month == 1) || 3 || 5 || 7 || 8 || 10) 
```

并且任何非零整数的计算结果为`true`。另外，你忘记了十二月。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:06:18.560

您的代码中有很多这样的构造：

```
value == 1||3||5||7||8||10||12 
```

这不像你认为它在 C 中所做的那样，你必须这样写：

```
value == 1 || value == 3 || value == 5 || etc... 
```

在您解决此问题并清理您的代码后，如果问题仍然存在（尽管提出一个新问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T00:08:16.903

```
i == 3||5||7||8||10||12 
```

此条件将始终评估为`true`因为`||`不能用于区分不同的情况。这是一个逻辑运算符，任何不等于 0 的值都将计算为`true`.

我建议您将天数存储在数组中：

```
int daysPerMonth[] = {31,28,31,30 .. }; 
```

这样您就可以在`daysPerMonth[i]`没有那么多复杂条件的情况下轻松知道一个月有多少天。它也会提高可读性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T00:11:36.167

这个：

```
if (month1 == 1||3||5||7||8||10||12) 
```

并没有完全按照你的想法去做。你的意思是：

```
if (month1 == 1 || month1 == 3 || month1 == 5 || 
     month1 == 7|| month1 == 8|| month1 == 10|| month1 == 12) 
```

您的声明所做的是评估`(month == 1) || 3`。为此，它需要转换`3`为布尔值，这意味着它变为`true`，因为它不是零。因此，比较的结果是正确的，这意味着整个 if 子句也是正确的（事实上，惰性意味着它在这一点上实现了这个权利（或者如果月份实际上是更早`1`）并且它考虑到其余月份的数字，甚至不计算任何东西。）

因此，整个 if 子句的计算结果为`true`。在你的代码中有一大堆这些，你的代码必然会做一些奇怪的事情。

# objective-c - CGPoint 的初始化程序无效

> ID：10289983
> 
> 赞同：0
> 
> 时间：2012-04-24T00:00:10.160
> 
> 标签：objective-c

嘿，我有一些代码不断返回错误消息，但我无法弄清楚问题是什么。我对 Objective-c 语法相当陌生，所以它可能相当简单，但我似乎找不到问题所在。方法是

```
-(void)setPlayerPosition:(CGPoint) position {
    CGPoint tileCoord = [self tileCoordForPosition:position];
    int tileGid = [metaLayer tileGIDAt:tileCoord];
    if (tileGid) {
        NSDictionary *properties = [tileMap propertiesForGID:tileGid];
        if (properties) {
            NSString *collision = [properties valueForKey:@"Collidable"];
            if (collision && [collision compare:@"True"] == NSOrderedSame) {
                return;
            }
            NSString *collectable = [properties valueForKey:@"Collectable"];
            if (collectable && [collectable compare:@"True"] == NSOrderedSame) {
                [metaLayer removeTileAt:tileCoord];
                [foreground removeTileAt:tileCoord];
            }
        }
    }
    player.position = position;
} 
```

它返回错误 Invalid initializer for the 2nd line 并且还说我的班级可能不会响应 'tileCoordForPosition:' 任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:09:07.927

我假设您正在关注[http://www.raywenderlich.com/1186/collisions-and-collectables-how-to-make-a-tile-based-game-with-cocos2d-part-2上的文章](http://www.raywenderlich.com/1186/collisions-and-collectables-how-to-make-a-tile-based-game-with-cocos2d-part-2)

因此，在我自己简要阅读之后，我的猜测是您要么缺少所需的方法，要么没有在课堂上正确声明它。

您应该声明并实现以下方法

```
- (CGPoint)tileCoordForPosition:(CGPoint)position 
```

它应该和你自己调用它的地方在同一个班级

```
[self tileCoordForPosition:position] 
```

如果您确实在您的类中实现了该方法，那么请确保您也正确声明了它。`.m`尝试像这样将它添加到文件的顶部

```
@interface YourControllerNameHere()

- (CGPoint)tileCoordForPosition:(CGPoint)position;

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:05:23.990

您需要`tileCoordForPosition:`在标头中声明，以便编译器知道它返回的类型（在本例中为 CGPoint）。

# c++ - 使用 boost::spirit 解析引用的字符串

> ID：10289985
> 
> 赞同：5
> 
> 时间：2012-04-24T00:00:20.873
> 
> 标签：c++, parsing, boost, boost-spirit, boost-spirit-qi

我想解析一个句子，其中一些字符串可能未引用、“引用”或“引用”。下面的代码几乎可以工作 - 但它无法匹配右引号。我猜这是因为qq参考。在代码中注释了修改，修改导致“引用”或“引用”也解析并有助于显示原始问题与结束引号有关。该代码还描述了确切的语法。

要完全清楚：不带引号的字符串解析。带引号的字符串 like`'hello'`将解析打开的引号`'`，所有字符 `hello`，但无法解析最终的引号`'`。

我又做了一次尝试，类似于[boost tutorials](http://www.boost.org/doc/libs/1_49_0/libs/spirit/doc/html/spirit/qi/tutorials/mini_xml___asts_.html)中的开始/结束标签匹配，但没有成功。

```
template <typename Iterator>
struct test_parser : qi::grammar<Iterator, dectest::Test(), ascii::space_type>
{
    test_parser()
        :
    test_parser::base_type(test, "test")
    {
        using qi::fail;
        using qi::on_error;
        using qi::lit;
        using qi::lexeme;
        using ascii::char_;
        using qi::repeat;
        using namespace qi::labels;
        using boost::phoenix::construct;
        using boost::phoenix::at_c;
        using boost::phoenix::push_back;
        using boost::phoenix::val;
        using boost::phoenix::ref;
        using qi::space;

        char qq;          

        arrow = lit("->");

        open_quote = (char_('\'') | char_('"')) [ref(qq) = _1];  // Remember what the opening quote was
        close_quote = lit(val(qq));  // Close must match the open
        // close_quote = (char_('\'') | char_('"')); // Enable this line to get code 'almost' working

        quoted_string = 
            open_quote
            >> +ascii::alnum        
            >> close_quote; 

        unquoted_string %= +ascii::alnum;
        any_string %= (quoted_string | unquoted_string);

        test = 
            unquoted_string             [at_c<0>(_val) = _1] 
            > unquoted_string           [at_c<1>(_val) = _1]   
            > repeat(1,3)[any_string]   [at_c<2>(_val) = _1]
            > arrow
            > any_string                [at_c<3>(_val) = _1] 
            ;

        // .. <snip>set rule names
        on_error<fail>(/* <snip> */);
        // debug rules
    }

    qi::rule<Iterator> arrow;
    qi::rule<Iterator> open_quote;
    qi::rule<Iterator> close_quote;

    qi::rule<Iterator, std::string()> quoted_string;
    qi::rule<Iterator, std::string()> unquoted_string;
    qi::rule<Iterator, std::string()> any_string;     // A quoted or unquoted string

    qi::rule<Iterator, dectest::Test(), ascii::space_type> test;

};

// main()
// This example should fail at the very end 
// (ie not parse "str3' because of the mismatched quote
// However, it fails to parse the closing quote of str1
typedef boost::tuple<string, string, vector<string>, string> DataT;
DataT data;
std::string str("addx001 add 'str1'   \"str2\"       ->  \"str3'");
std::string::const_iterator iter = str.begin();
const std::string::const_iterator end = str.end();
bool r = phrase_parse(iter, end, grammar, boost::spirit::ascii::space, data); 
```

对于奖励积分：避免使用本地数据成员（例如`char qq`上面的示例）的解决方案将是首选，但从实际的角度来看，我将使用任何可行的方法！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-24T08:46:10.703

离开构造函数后，对的引用`qq`变得悬空，所以这确实是一个问题。

**[`qi::locals`](http://www.boost.org/doc/libs/1_48_0/libs/spirit/doc/html/spirit/qi/reference/parser_concepts/nonterminal.html#spirit.qi.reference.parser_concepts.nonterminal.locals)**是将本地状态保留在解析器表达式中的*规范方法。*您的另一个选择是延长`qq`（例如，通过使其成为语法类的成员）的生命周期。最后，你可能也会感兴趣*`inherited attributes`*。这种机制为您提供了一种使用“参数”（传递本地状态）调用规则/语法的方法。

> ***注意**kleene 运算符的使用有一些注意事项`+`：它是贪婪的，如果字符串没有以预期的引号终止，则解析失败。*
> 
> 有关处理（可选/部分）引用字符串中任意内容的更完整示例，请参阅我编写的另一个答案，该示例允许在引用字符串中转义引号以及更多类似的内容：
> 
> *   [如何使我的拆分仅在一条真实行上工作并能够跳过字符串的引用部分？](https://stackoverflow.com/questions/7436481/how-to-make-my-split-work-only-on-one-real-line-and-be-capable-to-skeep-quoted-p/7462539#7462539)

我已将语法简化为相关位，并包含了一些测试用例：

```
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix.hpp>
#include <boost/fusion/adapted.hpp>

namespace qi = boost::spirit::qi;

template <typename Iterator>
struct test_parser : qi::grammar<Iterator, std::string(), qi::space_type, qi::locals<char> >
{
    test_parser() : test_parser::base_type(any_string, "test")
    {
        using namespace qi;

        quoted_string = 
               omit    [ char_("'\"") [_a =_1] ]             
            >> no_skip [ *(char_ - char_(_a))  ]
            >> lit(_a)
        ; 

        any_string = quoted_string | +qi::alnum;
    }

    qi::rule<Iterator, std::string(), qi::space_type, qi::locals<char> > quoted_string, any_string;
};

int main()
{
    test_parser<std::string::const_iterator> grammar;
    const char* strs[] = { "\"str1\"", 
                           "'str2'",
                           "'str3' trailing ok",
                           "'st\"r4' embedded also ok",
                           "str5",
                           "str6'",
                           NULL };

    for (const char** it = strs; *it; ++it)
    {
        const std::string str(*it);
        std::string::const_iterator iter = str.begin();
        std::string::const_iterator end  = str.end();

        std::string data;
        bool r = phrase_parse(iter, end, grammar, qi::space, data);

        if (r)
            std::cout << "Parsed:    " << str << " --> " << data << "\n";
        if (iter!=end)
            std::cout << "Remaining: " << std::string(iter,end) << "\n";
    }
} 
```

输出：

```
Parsed:    "str1" --> str1
Parsed:    'str2' --> str2
Parsed:    'str3' trailing ok --> str3
Remaining: trailing ok
Parsed:    'st"r4' embedded also ok --> st"r4
Remaining: embedded also ok
Parsed:    str5 --> str5
Parsed:    str6' --> str6
Remaining: ' 
```

# oop - 从中缀到前缀符号的转换

> ID：10289991
> 
> 赞同：9
> 
> 时间：2012-04-24T00:01:29.560
> 
> 标签：oop, clojure, prefix, infix-notation

我最近开始学习 Clojure。通常它看起来很有趣，但我不能习惯一些语法上的不便（与以前的 Ruby/C# 经验相比）。

嵌套表达式的前缀表示法。在 Ruby 中，我习惯于使用从左到右的链接/管道来编写复杂的表达式：`some_object.map { some_expression }.select { another_expression }`。当您逐步从输入值移动到结果时，这真的很方便，您可以专注于单个转换，而无需在键入时移动光标。相反，当我在 Clojure 中编写嵌套表达式时，我将代码从内部表达式编写到外部，并且必须不断移动光标。它减慢并分散注意力。我知道`->`and`->>`宏，但我注意到它不是惯用的。当您开始使用 Clojure/Haskell 等进行编码时，您是否遇到过同样的问题？你是怎么解决的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T01:42:00.493

最初我对 Lisps 也有同样的感觉，所以我能感受到你的痛苦 :-)

然而，好消息是您会发现，只要花一点时间并经常使用，您可能会开始喜欢前缀表示法。事实上，除了数学表达式，我现在更喜欢它而不是中缀样式。

喜欢前缀符号的原因：

*   **与函数的一致性**——大多数语言混合使用中缀（数学运算符）和前缀（函数调用）表示法。在 Lisps 中，如果您将数学运算符视为函数，那么这一切都是一致的，具有一定的优雅性
*   **宏**——如果函数调用总是在第一个位置，就会变得更加理智。
*   **Varargs** - 能够为几乎所有操作员提供可变数量的参数真是太好了。`(+ 1 2 3 4 5)`恕我直言，比`1 + 2 + 3 + 4 + 5`

然后一个技巧是在以这种方式构建代码具有逻辑意义时自由地使用`->`和自由。`->>`这在处理对象或集合的后续操作时通常很有用，例如

```
(->>
  "Hello World" 
  distinct 
  sort 
  (take 3))

==> (\space \H \W) 
```

我发现在使用前缀样式时非常有用的最后一个技巧是在构建更复杂的表达式时充分利用**缩进。**如果你缩进得当，那么你会发现前缀符号实际上很容易阅读：

```
(defn add-foobars [x y]
  (+
    (bar x y)
    (foo y)
    (foo x))) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T01:21:54.590

据我所知`->`，并且`->>`在 Clojure 中是惯用的。我一直在使用它们，在我看来，它们通常会导致代码可读性更高。

以下是这些宏在 Clojure“生态系统”周围的流行项目中使用的一些示例：

*   [环形cookie解析](https://github.com/mmcgrana/ring/blob/master/ring-core/src/ring/middleware/cookies.clj#L81)
*   [莱宁根内部](https://github.com/technomancy/leiningen/blob/master/src/leiningen/help.clj#L11)
*   [ClojureScript 编译器](https://github.com/clojure/clojurescript/blob/master/src/clj/cljs/compiler.clj#L1435)

举例证明:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T00:12:21.287

当我第一次开始使用 lisp 时，我确实看到了同样的障碍，这真的很烦人，直到我看到它使代码更简单、更清晰的方式，**一旦我了解了它的好处，烦恼就消失了**

```
initial + scale + offset 
```

变成了

```
(+ initial scale offset) 
```

然后尝试`(+)`前缀表示法允许函数指定自己的标识值

```
user> (*)
1
user> (+)
0 
```

还有很多例子，我的意思不是为前缀表示法辩护。我只是希望传达的是，随着积极的一面变得明显，学习曲线（在情感上）变得平坦。

当然，当您开始**编写宏时，前缀表示法就变成了必须具备的，**而不是方便。

* * *

为了解决您问题的第二部分，线程优先和线程最后的宏在使代码更清晰的任何时候都是惯用的：）它们比纯算术更常用于函数调用，尽管没有人会因为在他们制作时使用它们而责怪你方程更可口。

* * *

ps：`(.. object object2 object3)`-> `object().object2().object3()`；

```
(doto my-object
   (setX 4)
   (sety 5)` 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-24T20:12:23.827

如果您的表达式链很长，请使用`let`. 长的失控表达式或深度嵌套的表达式在任何语言中都不是特别可读的。这是不好的：

```
(do-something (map :id (filter #(> (:age %) 19) (fetch-data :people)))) 
```

这稍微好一点：

```
(do-something (map :id
                   (filter #(> (:age %) 19)
                           (fetch-data :people)))) 
```

但这也很糟糕：

```
fetch_data(:people).select{|x| x.age > 19}.map{|x| x.id}.do_something 
```

如果我们正在阅读本文，我们需要知道什么？我们正在`do_something`调用`people`. 这段代码很难阅读，因为第一个和最后一个之间的距离太远，以至于我们在它们之间旅行时忘记了我们在看什么。

在 Ruby 的情况下，`do_something`（或任何产生我们最终结果的东西）在行尾迷失了方向，所以很难说出我们在对我们的`people`. 在 Clojure 的例子中，我们正在做的事情是显而易见的`do-something`，但是如果不通读整个事情的内部，就很难知道我们在做什么。

任何比这个简单示例更复杂的代码都会变得非常痛苦。如果你所有的代码都像这样，你的脖子会累得在所有这些意大利面条上来回扫描。

我更喜欢这样的东西：

```
(let [people (fetch-data :people)
      adults (filter #(> (:age %) 19) people)
      ids    (map :id adults)]
  (do-something ids)) 
```

现在很明显：我从 开始`people`，我到处乱跑，然后我`do-something`对他们。

你可能会逃脱惩罚：

```
fetch_data(:people).select{|x|
  x.age > 19
}.map{|x|
  x.id
}.do_something 
```

但至少我可能更愿意这样做：

```
adults = fetch_data(:people).select{|x| x.age > 19}
do_something( adults.map{|x| x.id} ) 
```

`let`即使您的中间表达没有好名字，使用它也并非闻所未闻。（这种风格偶尔会用在 Clojure 自己的源代码中，例如 的源代码`defmacro`）

```
(let [x (complex-expr-1 x)
      x (complex-expr-2 x)
      x (complex-expr-3 x)
      ...
      x (complex-expr-n x)]
  (do-something x)) 
```

这对调试有很大帮助，因为您可以通过以下方式随时检查事物：

```
(let [x (complex-expr-1 x)
      x (complex-expr-2 x)
      _ (prn x)
      x (complex-expr-3 x)
      ...
      x (complex-expr-n x)]
  (do-something x)) 
```

# html - div的背景图片

> ID：10289993
> 
> 赞同：1
> 
> 时间：2012-04-24T00:01:36.220
> 
> 标签：html, css

我很难让带纹理的背景图像正确显示在 HTML5 标记中。具体来说，我正在尝试将低不透明度水彩涂抹的 .png 纹理添加到已经应用了跨浏览器渐变的标签。我可以让渐变显示得很好，但不能让背景图像正确显示。

有人告诉我，它的 CSS 命令是简写的：

```
background:url("filepath"); 
```

这与我使用的报价类型有关吗？单引号/双引号有关系吗？还是根本没有引号？我不确定引号对选择器做了什么，或者您是否无法应用背景图像和渐变？[您可以在http://www.zeldezine.info/demo/](http://www.zeldezine.info/demo/)在明显的页脚位置查看我要修改的空间。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T00:04:59.347

您不能将背景图像和渐变添加到同一元素。至于引号，它们是单引号、双引号还是根本没有引号都没有关系。只要确保图像路径正确。

如果你想要两者，你可以这样做：

[http://jsfiddle.net/vjEh7/](http://jsfiddle.net/vjEh7/)

CSS：

```
footer {
    background: rgb(169,3,41);
    background: -moz-linear-gradient(top,  rgba(169,3,41,1) 0%, rgba(143,2,34,1) 44%, rgba(109,0,25,1) 100%);
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(169,3,41,1)), color-stop(44%,rgba(143,2,34,1)), color-stop(100%,rgba(109,0,25,1)));
    background: -webkit-linear-gradient(top,  rgba(169,3,41,1) 0%,rgba(143,2,34,1) 44%,rgba(109,0,25,1) 100%);
    background: -o-linear-gradient(top,  rgba(169,3,41,1) 0%,rgba(143,2,34,1) 44%,rgba(109,0,25,1) 100%);
    background: -ms-linear-gradient(top,  rgba(169,3,41,1) 0%,rgba(143,2,34,1) 44%,rgba(109,0,25,1) 100%);
    background: linear-gradient(top,  rgba(169,3,41,1) 0%,rgba(143,2,34,1) 44%,rgba(109,0,25,1) 100%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#a90329', endColorstr='#6d0019',GradientType=0 );
}
div {
    width: 150px;
    height: 160px;
    background: url(http://www.zeldezine.info/demo/img/logo_bottom.png) no-repeat;
} 
```

HTML：

```
<footer>
    <div></div>
</footer> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:04:02.070

试试这个：

```
body
{
  background-image:url('images/image.jpg');
  background-repeat:repeat;
} 
```

# jquery - 目标ajax提交到弹窗

> ID：10289997
> 
> 赞同：1
> 
> 时间：2012-04-24T00:02:14.567
> 
> 标签：jquery, ajax, forms, popup

我有一个表单需要在提交之前进行验证，POST 到一个弹出窗口，然后表单需要在之后重置。

我知道`target="newWindowName"`and `onsubmit="window.open('','newWindowName','')"`form 属性有效，但这并不能让我在提交后做任何事情。

我知道我可以`$('form').ajaxSubmit()`用来指定提交后功能，但它似乎并没有让我打开一个新窗口。

我怎样才能一次完成所有这些事情？

这是我的表格：

```
<form id="myForm" target="newWindow" autocomplete="on" action="/myUrl" method="post"> 
```

这是我的 JavaScript：

```
$('#myForm').submit(function(e) { 
    e.preventDefault();
    if ($('#myForm').valid()) {
        var options = {
            target: '',
            beforeSubmit: function () {
                this.target = "newWindow"; 
                window.open("", "newWindow", "width=500,height=450");
            },
            success: function () {
                hideForm();
                $('#myForm').resetForm();
            }
        };

        $(this).ajaxSubmit(options);
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T18:10:13.943

这是我最终采用的解决方案，它更加优雅。

```
<form id="myForm" target="newWindow" autocomplete="on" action="/myUrl" method="post"> 
```

然后是JS：

```
$('#myForm').submit(function(e) {
    if ($(this).valid()) {
        var f = this;
        window.open("",$(this).attr("target"),"width=500,height=500"); 
        setTimeout(function () {  // delay resetting the form until after submit
            hideForm();
            f.reset();
        }, 0);
        return true;
    }
    else {
        e.preventDefault();  // only prevent default if the form is not valid
    } 
    return false;
}); 
```

这样，新窗口只有在表单有效时才会显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:10:49.653

您`target`在表单标签中使用属性的想法是正确的。这将自动将表单提交到名为“newWindow”的窗口。（要始终提交到*新*窗口，请使用`target="_blank"`。）

问题是您阻止表单提交到该新窗口，然后使用 JavaScript 进行 ajax 提交。如果您删除该额外代码，您将得到您想要的：

```
$('#myForm').submit(function(e) {
    if ($(this).valid()) {
        var f = this;
        setTimeout(function () {  // delay resetting the form until after submit
            hideForm();
            f.reset();
        }, 0);
    }
    else {
        e.preventDefault();  // only prevent default if the form is not valid
    } 
}); 
```

**工作演示：http:** [//jsfiddle.net/2x6wL/](http://jsfiddle.net/2x6wL/)